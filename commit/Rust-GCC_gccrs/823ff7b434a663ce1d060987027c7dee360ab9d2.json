{"sha": "823ff7b434a663ce1d060987027c7dee360ab9d2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODIzZmY3YjQzNGE2NjNjZTFkMDYwOTg3MDI3YzdkZWUzNjBhYjlkMg==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernds@codesourcery.com", "date": "2010-04-26T21:17:17Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2010-04-26T21:17:17Z"}, "message": "df-problems.c (df_simulate_initialize_forwards): Set, don't clear, bits for artificial defs at the top of the block.\n\n\t* df-problems.c (df_simulate_initialize_forwards): Set, don't clear,\n\tbits for artificial defs at the top of the block.\n\t* fwprop.c (single_def_use_enter_block): Don't call it.\n\nFrom-SVN: r158750", "tree": {"sha": "1c9584cc811e8ac51bda3af95fc87e52d368d92a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c9584cc811e8ac51bda3af95fc87e52d368d92a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/823ff7b434a663ce1d060987027c7dee360ab9d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/823ff7b434a663ce1d060987027c7dee360ab9d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/823ff7b434a663ce1d060987027c7dee360ab9d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/823ff7b434a663ce1d060987027c7dee360ab9d2/comments", "author": null, "committer": null, "parents": [{"sha": "1637c2e1ba572a859a9e99dd2ff16ddf88d8b3f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1637c2e1ba572a859a9e99dd2ff16ddf88d8b3f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1637c2e1ba572a859a9e99dd2ff16ddf88d8b3f7"}], "stats": {"total": 23, "additions": 14, "deletions": 9}, "files": [{"sha": "3612d90221f7ab28e7bd4c829cd88992bd2faa1a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/823ff7b434a663ce1d060987027c7dee360ab9d2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/823ff7b434a663ce1d060987027c7dee360ab9d2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=823ff7b434a663ce1d060987027c7dee360ab9d2", "patch": "@@ -1,3 +1,9 @@\n+2010-04-26  Bernd Schmidt  <bernds@codesourcery.com>\n+\n+\t* df-problems.c (df_simulate_initialize_forwards): Set, don't clear,\n+\tbits for artificial defs at the top of the block.\n+\t* fwprop.c (single_def_use_enter_block): Don't call it.\n+\n 2010-04-26  Jack Howarth <howarth@bromo.med.uc.edu>\n \n \tPR 43715"}, {"sha": "dbb469e1e2fa2a8a829e33196bf3fe76dbcab2e5", "filename": "gcc/df-problems.c", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/823ff7b434a663ce1d060987027c7dee360ab9d2/gcc%2Fdf-problems.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/823ff7b434a663ce1d060987027c7dee360ab9d2/gcc%2Fdf-problems.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdf-problems.c?ref=823ff7b434a663ce1d060987027c7dee360ab9d2", "patch": "@@ -3913,13 +3913,9 @@ df_simulate_finalize_backwards (basic_block bb, bitmap live)\n    the block, starting with the first one.\n    ----------------------------------------------------------------------------*/\n \n-/* Apply the artificial uses and defs at the top of BB in a forwards\n-   direction.  ??? This is wrong; defs mark the point where a pseudo\n-   becomes live when scanning forwards (unless a def is unused).  Since\n-   there are no REG_UNUSED notes for artificial defs, passes that\n-   require artificial defs probably should not call this function\n-   unless (as is the case for fwprop) they are correct when liveness\n-   bitmaps are *under*estimated.  */\n+/* Initialize the LIVE bitmap, which should be copied from DF_LIVE_IN or\n+   DF_LR_IN for basic block BB, for forward scanning by marking artificial\n+   defs live.  */\n \n void\n df_simulate_initialize_forwards (basic_block bb, bitmap live)\n@@ -3931,7 +3927,7 @@ df_simulate_initialize_forwards (basic_block bb, bitmap live)\n     {\n       df_ref def = *def_rec;\n       if (DF_REF_FLAGS (def) & DF_REF_AT_TOP)\n-\tbitmap_clear_bit (live, DF_REF_REGNO (def));\n+\tbitmap_set_bit (live, DF_REF_REGNO (def));\n     }\n }\n "}, {"sha": "6e65093859db8b232291ca3d6ec75ce14165ba42", "filename": "gcc/fwprop.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/823ff7b434a663ce1d060987027c7dee360ab9d2/gcc%2Ffwprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/823ff7b434a663ce1d060987027c7dee360ab9d2/gcc%2Ffwprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffwprop.c?ref=823ff7b434a663ce1d060987027c7dee360ab9d2", "patch": "@@ -228,7 +228,10 @@ single_def_use_enter_block (struct dom_walk_data *walk_data ATTRIBUTE_UNUSED,\n \n   process_uses (df_get_artificial_uses (bb_index), DF_REF_AT_TOP);\n   process_defs (df_get_artificial_defs (bb_index), DF_REF_AT_TOP);\n-  df_simulate_initialize_forwards (bb, local_lr);\n+\n+  /* We don't call df_simulate_initialize_forwards, as it may overestimate\n+     the live registers if there are unused artificial defs.  We prefer\n+     liveness to be underestimated.  */\n \n   FOR_BB_INSNS (bb, insn)\n     if (INSN_P (insn))"}]}