{"sha": "2297ab7d840966f62a70328244f4c8560d388e0a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjI5N2FiN2Q4NDA5NjZmNjJhNzAzMjgyNDRmNGM4NTYwZDM4OGUwYQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2012-01-31T17:41:24Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2012-01-31T17:41:24Z"}, "message": "re PR c++/52043 ([C++0x] ICE: SIGSEGV in tsubst_copy (pt.c:12081) with -Wreturn-type)\n\n\tPR c++/52043\n\t* cp-tree.h (PACK_EXPANSION_LOCAL_P): New.\n\t* pt.c (make_pack_expansion, tsubst_initializer_list): Set it.\n\t(tsubst_pack_expansion): Check it.\n\nFrom-SVN: r183768", "tree": {"sha": "9d4e6bb2fb6ca1073a2a491825302c6b14eca5d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9d4e6bb2fb6ca1073a2a491825302c6b14eca5d9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2297ab7d840966f62a70328244f4c8560d388e0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2297ab7d840966f62a70328244f4c8560d388e0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2297ab7d840966f62a70328244f4c8560d388e0a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2297ab7d840966f62a70328244f4c8560d388e0a/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4277cddae36313ebb549ea110c7ee3eb7e62a342", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4277cddae36313ebb549ea110c7ee3eb7e62a342", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4277cddae36313ebb549ea110c7ee3eb7e62a342"}], "stats": {"total": 43, "additions": 42, "deletions": 1}, "files": [{"sha": "8938ee22cb86d1d5c4d99b757d74c16cf23ecf41", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2297ab7d840966f62a70328244f4c8560d388e0a", "patch": "@@ -1,3 +1,10 @@\n+2012-01-31  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/52043\n+\t* cp-tree.h (PACK_EXPANSION_LOCAL_P): New.\n+\t* pt.c (make_pack_expansion, tsubst_initializer_list): Set it.\n+\t(tsubst_pack_expansion): Check it.\n+\n 2012-01-29  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/51327"}, {"sha": "d435dbdaa0a5ab7d7a2a98a58cb4d32b8296ec75", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=2297ab7d840966f62a70328244f4c8560d388e0a", "patch": "@@ -76,6 +76,7 @@ c-common.h, not after.\n       TRANSACTION_EXPR_IS_STMT (in TRANSACTION_EXPR)\n       CONVERT_EXPR_VBASE_PATH (in CONVERT_EXPR)\n       OVL_ARG_DEPENDENT (in OVERLOAD)\n+      PACK_EXPANSION_LOCAL_P (in *_PACK_EXPANSION)\n    1: IDENTIFIER_VIRTUAL_P (in IDENTIFIER_NODE)\n       TI_PENDING_TEMPLATE_FLAG.\n       TEMPLATE_PARMS_FOR_INLINE.\n@@ -2839,6 +2840,9 @@ extern void decl_shadowed_for_var_insert (tree, tree);\n     ? &TYPE_MAXVAL (NODE)\t\t\t\\\n     : &TREE_OPERAND ((NODE), 2))\n \n+/* True iff this pack expansion is within a function context.  */\n+#define PACK_EXPANSION_LOCAL_P(NODE) TREE_LANG_FLAG_0 (NODE)\n+\n /* Determine if this is an argument pack.  */\n #define ARGUMENT_PACK_P(NODE)                          \\\n   (TREE_CODE (NODE) == TYPE_ARGUMENT_PACK              \\"}, {"sha": "4c93b317432e7314d8bafba4822ecb18f544b1e2", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=2297ab7d840966f62a70328244f4c8560d388e0a", "patch": "@@ -3238,6 +3238,8 @@ make_pack_expansion (tree arg)\n     }\n   PACK_EXPANSION_PARAMETER_PACKS (result) = parameter_packs;\n \n+  PACK_EXPANSION_LOCAL_P (result) = at_function_scope_p ();\n+\n   return result;\n }\n \n@@ -9340,7 +9342,7 @@ tsubst_pack_expansion (tree t, tree args, tsubst_flags_t complain,\n        }\n       if (TREE_CODE (parm_pack) == PARM_DECL)\n \t{\n-\t  if (at_function_scope_p ())\n+\t  if (PACK_EXPANSION_LOCAL_P (t))\n \t    arg_pack = retrieve_local_specialization (parm_pack);\n \t  else\n \t    {\n@@ -18905,6 +18907,7 @@ tsubst_initializer_list (tree t, tree argvec)\n           /* Build a dummy EXPR_PACK_EXPANSION that will be used to\n              expand each argument in the TREE_VALUE of t.  */\n           expr = make_node (EXPR_PACK_EXPANSION);\n+\t  PACK_EXPANSION_LOCAL_P (expr) = true;\n           PACK_EXPANSION_PARAMETER_PACKS (expr) =\n             PACK_EXPANSION_PARAMETER_PACKS (TREE_PURPOSE (t));\n "}, {"sha": "820175c5d4824ca98fda92b3a1be54805c8fec0a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2297ab7d840966f62a70328244f4c8560d388e0a", "patch": "@@ -1,3 +1,8 @@\n+2012-01-31  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/52043\n+\t* g++.dg/cpp0x/variadic122.C: New.\n+\n 2012-01-31  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/52012"}, {"sha": "7f03c107c39301defa96592fb46f11a0fada8a31", "filename": "gcc/testsuite/g++.dg/cpp0x/variadic122.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic122.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2297ab7d840966f62a70328244f4c8560d388e0a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic122.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic122.C?ref=2297ab7d840966f62a70328244f4c8560d388e0a", "patch": "@@ -0,0 +1,22 @@\n+// PR c++/52043\n+// { dg-options \"-std=c++11 -Wreturn-type\" }\n+\n+template < class T > struct Container\n+{\n+  T f ();\n+};\n+\n+template < class T >\n+T deref (T)\n+{}\t\t\t\t// { dg-warning \"no return\" }\n+\n+template < class T, class ... Args >\n+auto deref (T u, int, Args ... args)->decltype (deref (u.f (), args ...))\n+{}\t\t\t\t// { dg-warning \"no return\" }\n+\n+void\n+foo ()\n+{\n+  Container < Container < int > > v;\n+  deref (v, 2);\n+}"}]}