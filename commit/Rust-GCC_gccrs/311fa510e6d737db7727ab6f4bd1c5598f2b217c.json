{"sha": "311fa510e6d737db7727ab6f4bd1c5598f2b217c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzExZmE1MTBlNmQ3MzdkYjc3MjdhYjZmNGJkMWM1NTk4ZjJiMjE3Yw==", "commit": {"author": {"name": "Le-Chun Wu", "email": "lcwu@gcc.gnu.org", "date": "2009-04-20T21:13:08Z"}, "committer": {"name": "Le-Chun Wu", "email": "lcwu@gcc.gnu.org", "date": "2009-04-20T21:13:08Z"}, "message": "re PR c++/39803 (Bogus 'unused value' warning on declarations of non-POD arrays)\n\n        PR c++/39803\n\t* gcc/cp/init.c (build_vec_init): Set TREE_NO_WARNING on the\n\tcompiler-generated INDIRECT_REF expression.\n\t* gcc/testsuite/g++.dg/warn/Wunused-14.C: New test.\n\nFrom-SVN: r146454", "tree": {"sha": "7d0125e6f6b8ac5da38604c980e416aa7193ee02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d0125e6f6b8ac5da38604c980e416aa7193ee02"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/311fa510e6d737db7727ab6f4bd1c5598f2b217c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/311fa510e6d737db7727ab6f4bd1c5598f2b217c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/311fa510e6d737db7727ab6f4bd1c5598f2b217c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/311fa510e6d737db7727ab6f4bd1c5598f2b217c/comments", "author": null, "committer": null, "parents": [{"sha": "6e0f0975e5368803451b2642fb4ecc598310a2e4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e0f0975e5368803451b2642fb4ecc598310a2e4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e0f0975e5368803451b2642fb4ecc598310a2e4"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "15f83d9fb88a122062fadd6351626c90edb81ffb", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=311fa510e6d737db7727ab6f4bd1c5598f2b217c", "patch": "@@ -1,3 +1,9 @@\n+2009-04-20  Le-Chun Wu  <lcwu@google.com>\n+\n+\tPR c++/39803\n+\t* init.c (build_vec_init): Set TREE_NO_WARNING on the\n+\tcompiler-generated INDIRECT_REF expression.\n+\n 2009-04-20  Ian Lance Taylor  <iant@google.com>\n \n \t* typeck.c (build_function_call_vec): New function.\n@@ -34,7 +40,7 @@\n \t* cp-tree.h (enum tsubst_flags): Rename from enum tsubst_flags_t.\n \t(tsubst_flags_t): Change typedef from enum type to int.\n \n-2009-04-16  Le-Chun Wu  <lcwu@google.com>\n+2009-04-16  Paolo Bonzini  <bonzini@gnu.org>\n \n \t* decl.c (check_initializer): Use TYPE_VECTOR_OPAQUE\n \tinstead of targetm.vector_opaque_p."}, {"sha": "d40a5e7e53fd344d274ce7602b36b3391b830a70", "filename": "gcc/cp/init.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=311fa510e6d737db7727ab6f4bd1c5598f2b217c", "patch": "@@ -2920,6 +2920,7 @@ build_vec_init (tree base, tree maxindex, tree init,\n       atype = build_pointer_type (atype);\n       stmt_expr = build1 (NOP_EXPR, atype, stmt_expr);\n       stmt_expr = cp_build_indirect_ref (stmt_expr, NULL, complain);\n+      TREE_NO_WARNING (stmt_expr) = 1;\n     }\n \n   current_stmt_tree ()->stmts_are_full_exprs_p = destroy_temps;"}, {"sha": "c58967338c159fa1e0f8a4a0426e740c3176c96d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=311fa510e6d737db7727ab6f4bd1c5598f2b217c", "patch": "@@ -1,3 +1,8 @@\n+2009-04-20  Le-Chun Wu  <lcwu@google.com>\n+\n+\tPR c++/39803\n+\t* g++.dg/warn/Wunused-14.C: New test.\n+\n 2009-04-20  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/specs/small_alignment.ads: New test."}, {"sha": "b325ccb71dd6911c999501a7b8dbc69661260e48", "filename": "gcc/testsuite/g++.dg/warn/Wunused-14.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-14.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/311fa510e6d737db7727ab6f4bd1c5598f2b217c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-14.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-14.C?ref=311fa510e6d737db7727ab6f4bd1c5598f2b217c", "patch": "@@ -0,0 +1,14 @@\n+// Test that -Wunused should not emit a warning on the initialization of\n+// non-POD arrays. See PR c++/39803.\n+// { dg-do compile }\n+// { dg-options \"-Wunused\" }\n+\n+#include <utility>\n+\n+using std::pair;\n+\n+int foo() {\n+  pair<int, const char*> components[3]; // { dg-bogus \"value computed is not used\" }\n+  components[0].first = 0;\n+  return 0;\n+}"}]}