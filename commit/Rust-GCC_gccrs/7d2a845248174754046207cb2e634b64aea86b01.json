{"sha": "7d2a845248174754046207cb2e634b64aea86b01", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2QyYTg0NTI0ODE3NDc1NDA0NjIwN2NiMmU2MzRiNjRhZWE4NmIwMQ==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2010-01-14T22:39:25Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-01-14T22:39:25Z"}, "message": "var-tracking.c (var_reg_delete): Don't delete the association between REGs and values or one-part variables if...\n\n\t* var-tracking.c (var_reg_delete): Don't delete the association\n\tbetween REGs and values or one-part variables if the register\n\tisn't clobbered.\n\nFrom-SVN: r155918", "tree": {"sha": "0fef3d11083df82ef7728ddeae8320963203acfc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0fef3d11083df82ef7728ddeae8320963203acfc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d2a845248174754046207cb2e634b64aea86b01", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d2a845248174754046207cb2e634b64aea86b01", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d2a845248174754046207cb2e634b64aea86b01", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d2a845248174754046207cb2e634b64aea86b01/comments", "author": null, "committer": null, "parents": [{"sha": "d17af1478964cba0792df8436a8ae839626bdb19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d17af1478964cba0792df8436a8ae839626bdb19", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d17af1478964cba0792df8436a8ae839626bdb19"}], "stats": {"total": 28, "additions": 20, "deletions": 8}, "files": [{"sha": "ce49f3683a6bda62eb36b7abc78f37f0d0032da9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d2a845248174754046207cb2e634b64aea86b01/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d2a845248174754046207cb2e634b64aea86b01/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7d2a845248174754046207cb2e634b64aea86b01", "patch": "@@ -1,3 +1,9 @@\n+2010-01-14  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* var-tracking.c (var_reg_delete): Don't delete the association\n+\tbetween REGs and values or one-part variables if the register\n+\tisn't clobbered.\n+\n 2010-01-14  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/42657"}, {"sha": "e5f95d97fcfbe0e39ed7e0768a51986648c7c554", "filename": "gcc/var-tracking.c", "status": "modified", "additions": 14, "deletions": 8, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d2a845248174754046207cb2e634b64aea86b01/gcc%2Fvar-tracking.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d2a845248174754046207cb2e634b64aea86b01/gcc%2Fvar-tracking.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvar-tracking.c?ref=7d2a845248174754046207cb2e634b64aea86b01", "patch": "@@ -1401,14 +1401,15 @@ var_reg_delete_and_set (dataflow_set *set, rtx loc, bool modify,\n   var_reg_set (set, loc, initialized, set_src);\n }\n \n-/* Delete current content of register LOC in dataflow set SET.  If\n-   CLOBBER is true, also delete any other live copies of the same\n-   variable part.  */\n+/* Delete the association of register LOC in dataflow set SET with any\n+   variables that aren't onepart.  If CLOBBER is true, also delete any\n+   other live copies of the same variable part, and delete the\n+   association with onepart dvs too.  */\n \n static void\n var_reg_delete (dataflow_set *set, rtx loc, bool clobber)\n {\n-  attrs *reg = &set->regs[REGNO (loc)];\n+  attrs *nextp = &set->regs[REGNO (loc)];\n   attrs node, next;\n \n   if (clobber)\n@@ -1421,13 +1422,18 @@ var_reg_delete (dataflow_set *set, rtx loc, bool clobber)\n       clobber_variable_part (set, NULL, dv_from_decl (decl), offset, NULL);\n     }\n \n-  for (node = *reg; node; node = next)\n+  for (node = *nextp; node; node = next)\n     {\n       next = node->next;\n-      delete_variable_part (set, node->loc, node->dv, node->offset);\n-      pool_free (attrs_pool, node);\n+      if (clobber || !dv_onepart_p (node->dv))\n+\t{\n+\t  delete_variable_part (set, node->loc, node->dv, node->offset);\n+\t  pool_free (attrs_pool, node);\n+\t  *nextp = next;\n+\t}\n+      else\n+\tnextp = &node->next;\n     }\n-  *reg = NULL;\n }\n \n /* Delete content of register with number REGNO in dataflow set SET.  */"}]}