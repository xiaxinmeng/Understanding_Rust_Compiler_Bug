{"sha": "81bec060e31b6ef2feeb3046c6f13a207c6f698a", "node_id": "C_kwDOANBUbNoAKDgxYmVjMDYwZTMxYjZlZjJmZWViMzA0NmM2ZjEzYTIwN2M2ZjY5OGE", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2022-07-07T14:12:04Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2022-07-07T15:56:09Z"}, "message": "c++: -Woverloaded-virtual and dtors [PR87729]\n\nMy earlier patch broke out of the loop over base members when we found a\nmatch, but that caused trouble for dtors, which can have multiple for which\nsame_signature_p is true.  But as the function comment says, we know this\ndoesn't apply to [cd]tors, so skip them.\n\n\tPR c++/87729\n\ngcc/cp/ChangeLog:\n\n\t* class.cc (warn_hidden): Ignore [cd]tors.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/warn/Woverloaded-virt3.C: New test.", "tree": {"sha": "b4ba8d61bf92cb0c9d49d5d3409b37722a97e9df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b4ba8d61bf92cb0c9d49d5d3409b37722a97e9df"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/81bec060e31b6ef2feeb3046c6f13a207c6f698a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81bec060e31b6ef2feeb3046c6f13a207c6f698a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81bec060e31b6ef2feeb3046c6f13a207c6f698a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81bec060e31b6ef2feeb3046c6f13a207c6f698a/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d89fa97ff318b1f892e2629c5a249313872a01b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d89fa97ff318b1f892e2629c5a249313872a01b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d89fa97ff318b1f892e2629c5a249313872a01b1"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "eb69e7f985cc84c834dd4bbb302cf2782b97ca25", "filename": "gcc/cp/class.cc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81bec060e31b6ef2feeb3046c6f13a207c6f698a/gcc%2Fcp%2Fclass.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81bec060e31b6ef2feeb3046c6f13a207c6f698a/gcc%2Fcp%2Fclass.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.cc?ref=81bec060e31b6ef2feeb3046c6f13a207c6f698a", "patch": "@@ -3020,6 +3020,9 @@ warn_hidden (tree t)\n \ttree binfo;\n \tunsigned j;\n \n+\tif (IDENTIFIER_CDTOR_P (name))\n+\t  continue;\n+\n \t/* Iterate through all of the base classes looking for possibly\n \t   hidden functions.  */\n \tfor (binfo = TYPE_BINFO (t), j = 0;"}, {"sha": "34214ba255778ecba17e0d780f0f0b8957126c11", "filename": "gcc/testsuite/g++.dg/warn/Woverloaded-virt3.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81bec060e31b6ef2feeb3046c6f13a207c6f698a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWoverloaded-virt3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81bec060e31b6ef2feeb3046c6f13a207c6f698a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWoverloaded-virt3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWoverloaded-virt3.C?ref=81bec060e31b6ef2feeb3046c6f13a207c6f698a", "patch": "@@ -0,0 +1,7 @@\n+// PR c++/87729\n+// { dg-additional-options -Woverloaded-virtual }\n+\n+struct S1 {};\n+struct S2: S1 { virtual ~S2(); };\n+struct S3 { virtual ~S3(); };\n+struct S4: S2, S3 { virtual ~S4(); };"}]}