{"sha": "79b7ab68bce24103adc388d184ff74755914cdda", "node_id": "C_kwDOANBUbNoAKDc5YjdhYjY4YmNlMjQxMDNhZGMzODhkMTg0ZmY3NDc1NTkxNGNkZGE", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2022-04-22T20:27:22Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2022-05-30T08:29:02Z"}, "message": "[Ada] Do not analyze expression functions for dispatch tables\n\nThere is no need to analyze expression functions that are primitives of a\ntagged type for its dispatch table because they will be analyzed at the end\nof the current scope.\n\ngcc/ada/\n\n\t* sem_attr.adb (Resolve_Attribute) <Attribute_Access>: Don't analyze\n\tthe body of an expression function in the case of a dispatch table.", "tree": {"sha": "f02eb4d6bde2d0e8a4528457ed223a0b984363c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f02eb4d6bde2d0e8a4528457ed223a0b984363c7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/79b7ab68bce24103adc388d184ff74755914cdda", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79b7ab68bce24103adc388d184ff74755914cdda", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79b7ab68bce24103adc388d184ff74755914cdda", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79b7ab68bce24103adc388d184ff74755914cdda/comments", "author": null, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "764169055b5b083f1f2167122c637ddc72c58095", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/764169055b5b083f1f2167122c637ddc72c58095", "html_url": "https://github.com/Rust-GCC/gccrs/commit/764169055b5b083f1f2167122c637ddc72c58095"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "e6e06f605fa9fa39e93ffce68f64d34012970c18", "filename": "gcc/ada/sem_attr.adb", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/79b7ab68bce24103adc388d184ff74755914cdda/gcc%2Fada%2Fsem_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/79b7ab68bce24103adc388d184ff74755914cdda/gcc%2Fada%2Fsem_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_attr.adb?ref=79b7ab68bce24103adc388d184ff74755914cdda", "patch": "@@ -12144,11 +12144,15 @@ package body Sem_Attr is\n                      elsif Scope (Subp_Id) /= Current_Scope then\n                         null;\n \n+                     --  Dispatch tables are not a freeze point either\n+\n+                     elsif Nkind (Parent (N)) = N_Unchecked_Type_Conversion\n+                       and then Is_Dispatch_Table_Entity (Etype (Parent (N)))\n+                     then\n+                        null;\n+\n                       --  Analyze the body of the expression function to freeze\n-                      --  the expression. This takes care of the case where the\n-                      --  'Access is part of dispatch table initialization and\n-                      --  the generated body of the expression function has not\n-                      --  been analyzed yet.\n+                      --  the expression.\n \n                      else\n                         Analyze (Subp_Body);"}]}