{"sha": "165d997d2ae172d9b084206a0c4566f3f2d31a55", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTY1ZDk5N2QyYWUxNzJkOWIwODQyMDZhMGM0NTY2ZjNmMmQzMWE1NQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2011-06-23T16:58:28Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2011-06-23T16:58:28Z"}, "message": "re PR c++/44625 (ICE after error: anonymous struct not inside named type)\n\n/cp\n2011-06-23  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/44625\n\t* decl2.c (build_anon_union_vars): Early return error_mark_node\n\tfor a nested anonymous struct.\n\n/testsuite\n2011-06-23  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/44625\n\t* g++.dg/template/crash107.C: New.\n\t* g++.dg/template/error17.C: Adjust.\n\nFrom-SVN: r175344", "tree": {"sha": "690df81dd299d80b4a402768cd92d32f65638a8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/690df81dd299d80b4a402768cd92d32f65638a8f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/165d997d2ae172d9b084206a0c4566f3f2d31a55", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/165d997d2ae172d9b084206a0c4566f3f2d31a55", "html_url": "https://github.com/Rust-GCC/gccrs/commit/165d997d2ae172d9b084206a0c4566f3f2d31a55", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/165d997d2ae172d9b084206a0c4566f3f2d31a55/comments", "author": null, "committer": null, "parents": [{"sha": "767de87d05afc6574bf1c5812391b2d865ee817f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/767de87d05afc6574bf1c5812391b2d865ee817f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/767de87d05afc6574bf1c5812391b2d865ee817f"}], "stats": {"total": 38, "additions": 36, "deletions": 2}, "files": [{"sha": "c7e39be0946b2f4c94dfc4ab5bbec32959797b4c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=165d997d2ae172d9b084206a0c4566f3f2d31a55", "patch": "@@ -1,3 +1,9 @@\n+2011-06-23  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/44625\n+\t* decl2.c (build_anon_union_vars): Early return error_mark_node\n+\tfor a nested anonymous struct.\n+\n 2011-06-23  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/49507"}, {"sha": "8cd51c28a2c652cd9a7c87ac84569bd4246cbb16", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=165d997d2ae172d9b084206a0c4566f3f2d31a55", "patch": "@@ -1327,7 +1327,10 @@ build_anon_union_vars (tree type, tree object)\n   /* Rather than write the code to handle the non-union case,\n      just give an error.  */\n   if (TREE_CODE (type) != UNION_TYPE)\n-    error (\"anonymous struct not inside named type\");\n+    {\n+      error (\"anonymous struct not inside named type\");\n+      return error_mark_node;\n+    }\n \n   for (field = TYPE_FIELDS (type);\n        field != NULL_TREE;"}, {"sha": "26f40f0c79bf12d00de9abe9ee70e04436784c1d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=165d997d2ae172d9b084206a0c4566f3f2d31a55", "patch": "@@ -1,3 +1,9 @@\n+2011-06-23  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/44625\n+\t* g++.dg/template/crash107.C: New.\n+\t* g++.dg/template/error17.C: Adjust.\n+\n 2011-06-23  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/49507"}, {"sha": "cd64c37d71f754b1e793f898a1fd8b3ebd6fcef3", "filename": "gcc/testsuite/g++.dg/template/crash107.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash107.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash107.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash107.C?ref=165d997d2ae172d9b084206a0c4566f3f2d31a55", "patch": "@@ -0,0 +1,20 @@\n+// PR c++/44625\n+// { dg-do compile }\n+// { dg-options \"\" }\n+\n+template<typename FP_> struct Vec { // { dg-message \"note\" }\n+    Vec& operator^=(Vec& rhs)     {\n+        union {\n+            struct {FP_ x,y,z;};\n+        }; // { dg-error \"anonymous struct\" }\n+        X = y*rhs.z() - z*rhs.y(); // { dg-error \"not declared|no member\" }\n+    }\n+    Vec& operator^(Vec& rhs) {\n+        return Vec(*this)^=rhs; // { dg-message \"required\" }\n+    }\n+};\n+Vec<double> v(3,4,12); // { dg-error \"no matching\" }\n+// { dg-message \"note\" { target *-*-* } 16 }\n+Vec<double> V(12,4,3);  // { dg-error \"no matching\" }\n+// { dg-message \"note\" { target *-*-* } 18 }\n+Vec<double> c = v^V;   // { dg-message \"required\" }"}, {"sha": "10c8b824ae5ac3e4843ce5c3c8221c7ef6f00277", "filename": "gcc/testsuite/g++.dg/template/error17.C", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror17.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/165d997d2ae172d9b084206a0c4566f3f2d31a55/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror17.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ferror17.C?ref=165d997d2ae172d9b084206a0c4566f3f2d31a55", "patch": "@@ -6,5 +6,4 @@ foo()\n {\n   union { struct { }; }; // { dg-error \"prohibits anonymous struct\" \"anon\" }\n   // { dg-error \"not inside\" \"not inside\" { target *-*-* } 7 }\n-  // { dg-warning \"no members\" \"no members\" { target *-*-* } 7 }\n }"}]}