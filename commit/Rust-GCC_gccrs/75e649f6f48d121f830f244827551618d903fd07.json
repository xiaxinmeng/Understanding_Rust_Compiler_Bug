{"sha": "75e649f6f48d121f830f244827551618d903fd07", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzVlNjQ5ZjZmNDhkMTIxZjgzMGYyNDQ4Mjc1NTE2MThkOTAzZmQwNw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2011-10-09T21:39:12Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2011-10-09T21:39:12Z"}, "message": "tree-ssa-forwprop.c (forward_propagate_into_comparison): Do not make the replacement if the conversion to the LHS type is not useless.\n\n\t* tree-ssa-forwprop.c (forward_propagate_into_comparison): Do not make\n\tthe replacement if the conversion to the LHS type is not useless.\n\nFrom-SVN: r179730", "tree": {"sha": "113c5588f603f68fb0d8f8a6cf5152e1f5b03392", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/113c5588f603f68fb0d8f8a6cf5152e1f5b03392"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75e649f6f48d121f830f244827551618d903fd07", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75e649f6f48d121f830f244827551618d903fd07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75e649f6f48d121f830f244827551618d903fd07", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75e649f6f48d121f830f244827551618d903fd07/comments", "author": null, "committer": null, "parents": [{"sha": "7de61dc6ac5ec699bffb6af49636db501f436004", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7de61dc6ac5ec699bffb6af49636db501f436004", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7de61dc6ac5ec699bffb6af49636db501f436004"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "3a3c9853a16eee31a086e734b79828bfad51dd91", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75e649f6f48d121f830f244827551618d903fd07/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75e649f6f48d121f830f244827551618d903fd07/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=75e649f6f48d121f830f244827551618d903fd07", "patch": "@@ -1,3 +1,8 @@\n+2011-10-09  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* tree-ssa-forwprop.c (forward_propagate_into_comparison): Do not make\n+\tthe replacement if the conversion to the LHS type is not useless.\n+\n 2011-10-09  Ira Rosen  <ira.rosen@linaro.org>\n \n \tPR tree-optimization/50635"}, {"sha": "de782c9be9f3f189123acb0991b3044ed9f56dbf", "filename": "gcc/tree-ssa-forwprop.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75e649f6f48d121f830f244827551618d903fd07/gcc%2Ftree-ssa-forwprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75e649f6f48d121f830f244827551618d903fd07/gcc%2Ftree-ssa-forwprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-forwprop.c?ref=75e649f6f48d121f830f244827551618d903fd07", "patch": "@@ -465,16 +465,15 @@ forward_propagate_into_comparison (gimple_stmt_iterator *gsi)\n   gimple stmt = gsi_stmt (*gsi);\n   tree tmp;\n   bool cfg_changed = false;\n+  tree type = TREE_TYPE (gimple_assign_lhs (stmt));\n   tree rhs1 = gimple_assign_rhs1 (stmt);\n   tree rhs2 = gimple_assign_rhs2 (stmt);\n \n   /* Combine the comparison with defining statements.  */\n   tmp = forward_propagate_into_comparison_1 (stmt,\n \t\t\t\t\t     gimple_assign_rhs_code (stmt),\n-\t\t\t\t\t     TREE_TYPE\n-\t\t\t\t\t       (gimple_assign_lhs (stmt)),\n-\t\t\t\t\t     rhs1, rhs2);\n-  if (tmp)\n+\t\t\t\t\t     type, rhs1, rhs2);\n+  if (tmp && useless_type_conversion_p (type, TREE_TYPE (tmp)))\n     {\n       gimple_assign_set_rhs_from_tree (gsi, tmp);\n       fold_stmt (gsi);"}]}