{"sha": "849ec6caae2fa53d3f552a1d58fd151a93a39edc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQ5ZWM2Y2FhZTJmYTUzZDNmNTUyYTFkNThmZDE1MWE5M2EzOWVkYw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-08-29T20:29:55Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-08-29T20:29:55Z"}, "message": "re PR c++/85265 ([concepts] ICE with missing identifier)\n\n/cp\n2018-08-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/85265\n\t* parser.c (cp_parser_introduction_list): If cp_parser_identifier\n\treturns error_mark_node early exit the loop.\n\t(cp_parser_template_introduction): Improve error-recovery, remove\n\terror call about empty introduction-list.\n\n/testsuite\n2018-08-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/85265\n\t* g++.dg/concepts/pr85265.C: New.\n\nFrom-SVN: r263966", "tree": {"sha": "d77f992637292e58d75092ef01c038e185996a64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d77f992637292e58d75092ef01c038e185996a64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/849ec6caae2fa53d3f552a1d58fd151a93a39edc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/849ec6caae2fa53d3f552a1d58fd151a93a39edc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/849ec6caae2fa53d3f552a1d58fd151a93a39edc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/849ec6caae2fa53d3f552a1d58fd151a93a39edc/comments", "author": null, "committer": null, "parents": [{"sha": "e84bf0ef66aa72228299dd92d342c4de3a37c55c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e84bf0ef66aa72228299dd92d342c4de3a37c55c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e84bf0ef66aa72228299dd92d342c4de3a37c55c"}], "stats": {"total": 35, "additions": 29, "deletions": 6}, "files": [{"sha": "6ed074eea1a88c170af5a8135712cfeacebf7c1d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=849ec6caae2fa53d3f552a1d58fd151a93a39edc", "patch": "@@ -1,3 +1,11 @@\n+2018-08-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/85265\n+\t* parser.c (cp_parser_introduction_list): If cp_parser_identifier\n+\treturns error_mark_node early exit the loop.\n+\t(cp_parser_template_introduction): Improve error-recovery, remove\n+\terror call about empty introduction-list.\n+\n 2018-08-29  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR c++/85110"}, {"sha": "92e6b40efb444f2b618d8bfba022442817420fa5", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=849ec6caae2fa53d3f552a1d58fd151a93a39edc", "patch": "@@ -15242,11 +15242,15 @@ cp_parser_introduction_list (cp_parser *parser)\n       if (is_pack)\n \tcp_lexer_consume_token (parser->lexer);\n \n+      tree identifier = cp_parser_identifier (parser);\n+      if (identifier == error_mark_node)\n+\tbreak;\n+\n       /* Build placeholder. */\n       tree parm = build_nt (WILDCARD_DECL);\n       DECL_SOURCE_LOCATION (parm)\n \t= cp_lexer_peek_token (parser->lexer)->location;\n-      DECL_NAME (parm) = cp_parser_identifier (parser);\n+      DECL_NAME (parm) = identifier;\n       WILDCARD_PACK_P (parm) = is_pack;\n       vec_safe_push (introduction_vec, parm);\n \n@@ -27178,18 +27182,18 @@ cp_parser_template_introduction (cp_parser* parser, bool member_p)\n      matching identifiers.  */\n   tree introduction_list = cp_parser_introduction_list (parser);\n \n+  /* Look for closing brace for introduction.  */\n+  if (!braces.require_close (parser))\n+    return true;\n+\n   /* The introduction-list shall not be empty.  */\n   int nargs = TREE_VEC_LENGTH (introduction_list);\n   if (nargs == 0)\n     {\n-      error (\"empty introduction-list\");\n+      /* In cp_parser_introduction_list we have already issued an error.  */\n       return true;\n     }\n \n-  /* Look for closing brace for introduction.  */\n-  if (!braces.require_close (parser))\n-    return true;\n-\n   if (tmpl_decl == error_mark_node)\n     {\n       cp_parser_name_lookup_error (parser, concept_name, tmpl_decl, NLE_NULL,"}, {"sha": "78bbd7f31e55146a9f14837f8e65cc840b7f5378", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=849ec6caae2fa53d3f552a1d58fd151a93a39edc", "patch": "@@ -1,3 +1,8 @@\n+2018-08-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/85265\n+\t* g++.dg/concepts/pr85265.C: New.\n+\n 2018-08-29  Martin Sebor  <msebor@redhat.com>\n \t    Bernd Edlinger  <bernd.edlinger@hotmail.de>\n "}, {"sha": "86124ceb712ac21d54880b660b7e835fa6585eaf", "filename": "gcc/testsuite/g++.dg/concepts/pr85265.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconcepts%2Fpr85265.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/849ec6caae2fa53d3f552a1d58fd151a93a39edc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconcepts%2Fpr85265.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconcepts%2Fpr85265.C?ref=849ec6caae2fa53d3f552a1d58fd151a93a39edc", "patch": "@@ -0,0 +1,6 @@\n+// { dg-do compile { target c++14 } }\n+// { dg-additional-options \"-fconcepts\" }\n+\n+template<typename> concept bool C = true;\n+\n+C{} void foo();  // { dg-error \"expected identifier\" }"}]}