{"sha": "85c05b5eec703f9dd26e05215f336a3518b475df", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVjMDViNWVlYzcwM2Y5ZGQyNmUwNTIxNWYzMzZhMzUxOGI0NzVkZg==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2017-05-15T13:47:40Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2017-05-15T13:47:40Z"}, "message": "Fix order and types of members in C++17 insert_return_type structs\n\n\tPR libstdc++/80761\n\t* include/bits/node_handle.h (_Node_insert_return): Reorder members.\n\t(tuple_size, tuple_element): Remove partial specializations.\n\t* include/bits/stl_tree.h (_Rb_tree::insert_return_type): Use\n\tconst_iterator for std::set.\n\t* testsuite/23_containers/map/modifiers/extract.cc: New.\n\t* testsuite/23_containers/set/modifiers/extract.cc: New.\n\t* testsuite/23_containers/unordered_map/modifiers/extract.cc: New.\n\t* testsuite/23_containers/unordered_set/modifiers/extract.cc: New.\n\nFrom-SVN: r248062", "tree": {"sha": "b9923cca1788e3adff2b0691135820d154b9c635", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b9923cca1788e3adff2b0691135820d154b9c635"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85c05b5eec703f9dd26e05215f336a3518b475df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85c05b5eec703f9dd26e05215f336a3518b475df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85c05b5eec703f9dd26e05215f336a3518b475df", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85c05b5eec703f9dd26e05215f336a3518b475df/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "511604823d33a79a88eaa12e881badd2170a0614", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/511604823d33a79a88eaa12e881badd2170a0614", "html_url": "https://github.com/Rust-GCC/gccrs/commit/511604823d33a79a88eaa12e881badd2170a0614"}], "stats": {"total": 78, "additions": 60, "deletions": 18}, "files": [{"sha": "4c6ca4b36beafe646cf3be8090e8514455f1fe58", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=85c05b5eec703f9dd26e05215f336a3518b475df", "patch": "@@ -1,3 +1,15 @@\n+2017-05-15  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/80761\n+\t* include/bits/node_handle.h (_Node_insert_return): Reorder members.\n+\t(tuple_size, tuple_element): Remove partial specializations.\n+\t* include/bits/stl_tree.h (_Rb_tree::insert_return_type): Use\n+\tconst_iterator for std::set.\n+\t* testsuite/23_containers/map/modifiers/extract.cc: New.\n+\t* testsuite/23_containers/set/modifiers/extract.cc: New.\n+\t* testsuite/23_containers/unordered_map/modifiers/extract.cc: New.\n+\t* testsuite/23_containers/unordered_set/modifiers/extract.cc: New.\n+\n 2017-05-12  Jonathan Wakely  <jwakely@redhat.com>\n \n \tPR libstdc++/78939"}, {"sha": "c7694a1e0ef70e5f84ed4380bcba96273d8634bf", "filename": "libstdc++-v3/include/bits/node_handle.h", "status": "modified", "additions": 1, "deletions": 17, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fnode_handle.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fnode_handle.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fnode_handle.h?ref=85c05b5eec703f9dd26e05215f336a3518b475df", "patch": "@@ -280,8 +280,8 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n   template<typename _Iterator, typename _NodeHandle>\n     struct _Node_insert_return\n     {\n-      bool\t\tinserted = false;\n       _Iterator\t\tposition = _Iterator();\n+      bool\t\tinserted = false;\n       _NodeHandle\tnode;\n \n       template<size_t _Idx>\n@@ -305,22 +305,6 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t}\n     };\n \n-  template<typename _Iterator, typename _NodeHandle>\n-    struct tuple_size<_Node_insert_return<_Iterator, _NodeHandle>>\n-    : integral_constant<size_t, 3> { };\n-\n-  template<typename _Iterator, typename _NodeHandle>\n-    struct tuple_element<0, _Node_insert_return<_Iterator, _NodeHandle>>\n-    { using type = bool; };\n-\n-  template<typename _Iterator, typename _NodeHandle>\n-    struct tuple_element<1, _Node_insert_return<_Iterator, _NodeHandle>>\n-    { using type = _Iterator; };\n-\n-  template<typename _Iterator, typename _NodeHandle>\n-    struct tuple_element<2, _Node_insert_return<_Iterator, _NodeHandle>>\n-    { using type = _NodeHandle; };\n-\n _GLIBCXX_END_NAMESPACE_VERSION\n } // namespace std\n "}, {"sha": "3f133b0dad0912ed96e564dee019b2db54d5e605", "filename": "libstdc++-v3/include/bits/stl_tree.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_tree.h?ref=85c05b5eec703f9dd26e05215f336a3518b475df", "patch": "@@ -812,7 +812,9 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n #if __cplusplus > 201402L\n       using node_type = _Node_handle<_Key, _Val, _Node_allocator>;\n-      using insert_return_type = _Node_insert_return<iterator, node_type>;\n+      using insert_return_type = _Node_insert_return<\n+\tconditional_t<is_same_v<_Key, _Val>, const_iterator, iterator>,\n+\tnode_type>;\n #endif\n \n       pair<_Base_ptr, _Base_ptr>"}, {"sha": "80eaf018a70bd384ae63b928214ba7eb25fa6b21", "filename": "libstdc++-v3/testsuite/23_containers/map/modifiers/extract.cc", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fmap%2Fmodifiers%2Fextract.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fmap%2Fmodifiers%2Fextract.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fmap%2Fmodifiers%2Fextract.cc?ref=85c05b5eec703f9dd26e05215f336a3518b475df", "patch": "@@ -135,6 +135,17 @@ test03()\n   static_assert( is_same_v<test_type::node_type, compat_type3::node_type> );\n }\n \n+void\n+test04()\n+{\n+  // Check order of members in insert_return_type\n+  auto [pos, ins, node] = test_type::insert_return_type{};\n+  using std::is_same_v;\n+  static_assert( is_same_v<test_type::iterator, decltype(pos)> );\n+  static_assert( is_same_v<bool, decltype(ins)> );\n+  static_assert( is_same_v<test_type::node_type, decltype(node)> );\n+}\n+\n int\n main()\n {"}, {"sha": "3fbc6b9a798baabd998c076d574a5a34985e372e", "filename": "libstdc++-v3/testsuite/23_containers/set/modifiers/extract.cc", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fset%2Fmodifiers%2Fextract.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fset%2Fmodifiers%2Fextract.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fset%2Fmodifiers%2Fextract.cc?ref=85c05b5eec703f9dd26e05215f336a3518b475df", "patch": "@@ -126,6 +126,17 @@ test03()\n   static_assert( is_same_v<test_type::node_type, compat_type3::node_type> );\n }\n \n+void\n+test04()\n+{\n+  // Check order of members in insert_return_type\n+  auto [pos, ins, node] = test_type::insert_return_type{};\n+  using std::is_same_v;\n+  static_assert( is_same_v<test_type::iterator, decltype(pos)> );\n+  static_assert( is_same_v<bool, decltype(ins)> );\n+  static_assert( is_same_v<test_type::node_type, decltype(node)> );\n+}\n+\n int\n main()\n {"}, {"sha": "ce50766b4968078aa41e7bd3502c8bdb80d85eee", "filename": "libstdc++-v3/testsuite/23_containers/unordered_map/modifiers/extract.cc", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_map%2Fmodifiers%2Fextract.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_map%2Fmodifiers%2Fextract.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_map%2Fmodifiers%2Fextract.cc?ref=85c05b5eec703f9dd26e05215f336a3518b475df", "patch": "@@ -136,6 +136,17 @@ test03()\n   static_assert( is_same_v<test_type::node_type, compat_type3::node_type> );\n }\n \n+void\n+test04()\n+{\n+  // Check order of members in insert_return_type\n+  auto [pos, ins, node] = test_type::insert_return_type{};\n+  using std::is_same_v;\n+  static_assert( is_same_v<test_type::iterator, decltype(pos)> );\n+  static_assert( is_same_v<bool, decltype(ins)> );\n+  static_assert( is_same_v<test_type::node_type, decltype(node)> );\n+}\n+\n int\n main()\n {"}, {"sha": "5be81951407eeeb3dd5450f034c6cfac095124bc", "filename": "libstdc++-v3/testsuite/23_containers/unordered_set/modifiers/extract.cc", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_set%2Fmodifiers%2Fextract.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c05b5eec703f9dd26e05215f336a3518b475df/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_set%2Fmodifiers%2Fextract.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_set%2Fmodifiers%2Fextract.cc?ref=85c05b5eec703f9dd26e05215f336a3518b475df", "patch": "@@ -128,6 +128,17 @@ test03()\n   static_assert( is_same_v<test_type::node_type, compat_type3::node_type> );\n }\n \n+void\n+test04()\n+{\n+  // Check order of members in insert_return_type\n+  auto [pos, ins, node] = test_type::insert_return_type{};\n+  using std::is_same_v;\n+  static_assert( is_same_v<test_type::iterator, decltype(pos)> );\n+  static_assert( is_same_v<bool, decltype(ins)> );\n+  static_assert( is_same_v<test_type::node_type, decltype(node)> );\n+}\n+\n int\n main()\n {"}]}