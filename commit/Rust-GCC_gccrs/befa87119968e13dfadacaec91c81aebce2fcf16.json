{"sha": "befa87119968e13dfadacaec91c81aebce2fcf16", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmVmYTg3MTE5OTY4ZTEzZGZhZGFjYWVjOTFjODFhZWJjZTJmY2YxNg==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2019-04-21T08:25:44Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2019-04-21T08:25:44Z"}, "message": "Fix test fails on powerpc-darwin.\n\nThe current implementation of \u201cspeculation_barrier\u201d\nand \u201cgroup_end_nop\u201d insns emit hard-wired register\nnames which causes tests using them to fail on Darwin,\nat least, which uses \u201crNN\u201d instead of \u201cNN\u201d.\n\nThe patch makes the register names for these insns use\nthe operand output mechanism to substitute the\nappropriate variant when needed.\n\ngcc/\n\n2019-04-21  Iain Sandoe  <iain@sandoe.co.uk>\n\n\t* config/rs6000/rs6000.md (group_end_nop): Emit insn register\n\tnames using operand format, rather than hard-wired.\n\t(speculation_barrier): Likewise.\n\nFrom-SVN: r270480", "tree": {"sha": "281da1a9d7aa83f57fb11f0d7a5c4006384bc1a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/281da1a9d7aa83f57fb11f0d7a5c4006384bc1a1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/befa87119968e13dfadacaec91c81aebce2fcf16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/befa87119968e13dfadacaec91c81aebce2fcf16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/befa87119968e13dfadacaec91c81aebce2fcf16", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/befa87119968e13dfadacaec91c81aebce2fcf16/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "375eb99a558e4e90ddba2cda1b3066d3cabf80bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/375eb99a558e4e90ddba2cda1b3066d3cabf80bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/375eb99a558e4e90ddba2cda1b3066d3cabf80bc"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "8b09eecfbfe725e2a60561d5083425457c6677c1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/befa87119968e13dfadacaec91c81aebce2fcf16/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/befa87119968e13dfadacaec91c81aebce2fcf16/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=befa87119968e13dfadacaec91c81aebce2fcf16", "patch": "@@ -1,3 +1,9 @@\n+2019-04-21  Iain Sandoe  <iain@sandoe.co.uk>\n+\n+\t* config/rs6000/rs6000.md (group_end_nop): Emit insn register\n+\tnames using operand format, rather than hard-wired.\n+\t(speculation_barrier): Likewise.\n+\n 2019-04-19  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \tPR tree-optimization/88055"}, {"sha": "ad80592765d047db68d61e64bb48a7ec0cf48ddd", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/befa87119968e13dfadacaec91c81aebce2fcf16/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/befa87119968e13dfadacaec91c81aebce2fcf16/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=befa87119968e13dfadacaec91c81aebce2fcf16", "patch": "@@ -12445,15 +12445,18 @@\n   [(unspec [(const_int 0)] UNSPEC_GRP_END_NOP)]\n   \"\"\n {\n-  if (rs6000_tune == PROCESSOR_POWER6)\n-    return \"ori 1,1,0\";\n-  return \"ori 2,2,0\";\n+  operands[0] = gen_rtx_REG (Pmode,\n+\t\t\t     rs6000_tune == PROCESSOR_POWER6 ? 1 : 2);\n+  return \"ori %0,%0,0\";\n })\n \n (define_insn \"speculation_barrier\"\n   [(unspec_volatile:BLK [(const_int 0)] UNSPECV_SPEC_BARRIER)]\n   \"\"\n-  \"ori 31,31,0\")\n+{\n+  operands[0] = gen_rtx_REG (Pmode, 31);\n+  return \"ori %0,%0,0\";\n+})\n \f\n ;; Define the subtract-one-and-jump insns, starting with the template\n ;; so loop.c knows what to generate."}]}