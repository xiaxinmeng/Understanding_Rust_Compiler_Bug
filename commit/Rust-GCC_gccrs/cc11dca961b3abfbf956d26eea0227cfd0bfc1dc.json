{"sha": "cc11dca961b3abfbf956d26eea0227cfd0bfc1dc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2MxMWRjYTk2MWIzYWJmYmY5NTZkMjZlZWEwMjI3Y2ZkMGJmYzFkYw==", "commit": {"author": {"name": "Fernando Nasser", "email": "fnasser@redhat.com", "date": "2004-01-13T02:56:18Z"}, "committer": {"name": "Fernando Nasser", "email": "fnasser@gcc.gnu.org", "date": "2004-01-13T02:56:18Z"}, "message": "Dialog.java (show): Enable blocking for all modal dialogs and run secondary dispatch thread to...\n\n        * java/awt/Dialog.java (show): Enable blocking for all modal dialogs\n        and run secondary dispatch thread to process event queue while this\n        thread is blocked.\n\nFrom-SVN: r75788", "tree": {"sha": "9e6e74eb87e7a8132ad1b698944f567961ef8d13", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9e6e74eb87e7a8132ad1b698944f567961ef8d13"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc/comments", "author": {"login": "fnasser", "id": 326533, "node_id": "MDQ6VXNlcjMyNjUzMw==", "avatar_url": "https://avatars.githubusercontent.com/u/326533?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fnasser", "html_url": "https://github.com/fnasser", "followers_url": "https://api.github.com/users/fnasser/followers", "following_url": "https://api.github.com/users/fnasser/following{/other_user}", "gists_url": "https://api.github.com/users/fnasser/gists{/gist_id}", "starred_url": "https://api.github.com/users/fnasser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fnasser/subscriptions", "organizations_url": "https://api.github.com/users/fnasser/orgs", "repos_url": "https://api.github.com/users/fnasser/repos", "events_url": "https://api.github.com/users/fnasser/events{/privacy}", "received_events_url": "https://api.github.com/users/fnasser/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bc298aa7113959bd1f2f119cfab18e1b94d39468", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc298aa7113959bd1f2f119cfab18e1b94d39468", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc298aa7113959bd1f2f119cfab18e1b94d39468"}], "stats": {"total": 37, "additions": 28, "deletions": 9}, "files": [{"sha": "6252810397be582fb5c15b0b703483d7f681abb7", "filename": "libjava/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=cc11dca961b3abfbf956d26eea0227cfd0bfc1dc", "patch": "@@ -1,3 +1,9 @@\n+2004-01-12  Fernando Nasser  <fnasser@redhat.com>\n+\n+\t* java/awt/Dialog.java (show): Enable blocking for all modal dialogs\n+\tand run secondary dispatch thread to process event queue while this\n+\tthread is blocked.\n+\n 2004-01-12  Graydon Hoare  <graydon@redhat.com>\n \n \t* gnu/java/awt/gtk/GdkGraphics2D.java"}, {"sha": "5516ff906d00e57ce51a41c89e7f3296d0ca0ecb", "filename": "libjava/java/awt/Dialog.java", "status": "modified", "additions": 22, "deletions": 9, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc/libjava%2Fjava%2Fawt%2FDialog.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc11dca961b3abfbf956d26eea0227cfd0bfc1dc/libjava%2Fjava%2Fawt%2FDialog.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Fawt%2FDialog.java?ref=cc11dca961b3abfbf956d26eea0227cfd0bfc1dc", "patch": "@@ -88,6 +88,12 @@ public class Dialog extends Window\n   */\n private boolean blocked = false;\n \n+/**\n+  * Secondary EventQueue to handle AWT events while\n+  * we are blocked for modality in show\n+  */\n+private EventQueue eq2 = null;\n+\n /*************************************************************************/\n \n /*\n@@ -394,20 +400,22 @@ public class Dialog extends Window\n show()\n {\n   super.show();\n+  \n   if (isModal())\n     {\n       // If already shown (and blocked) just return\n       if (blocked)\n \treturn;\n \n-      /* FIXME: Currently this thread may block forever if it called from\n-         the event dispatch thread, so we only do this for FileDialog which\n-         only depends on a signal which is delivered in the Gtk thread.\n-         Remove this test when we add code to start another event\n-         dispatch thread. */\n-      if ((Thread.currentThread () instanceof EventDispatchThread) &&\n-          !(this instanceof FileDialog))\n-        return;\n+      /* If show is called in the dispatch thread for a modal dialog it will\n+         block so we must run another thread so the events keep being\n+\t dispatched.*/\n+      if (EventQueue.isDispatchThread ())\n+        {\n+\t  EventQueue eq = Toolkit.getDefaultToolkit().getSystemEventQueue();\n+          eq2 = new EventQueue ();\n+\t  eq.push (eq2);\n+\t}\n       \n       try \n         {\n@@ -418,8 +426,13 @@ public class Dialog extends Window\n       catch (InterruptedException e)\n         {\n \t  blocked = false;\n-\t  return;\n         }\n+\t\n+      if (eq2 != null)\n+        {\n+\t  eq2.pop ();\n+\t  eq2 = null;\n+\t}\n     }  \n }\n "}]}