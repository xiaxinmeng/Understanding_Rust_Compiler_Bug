{"sha": "b3e401c25a949e00ea3a77a508d3a33142f139e2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjNlNDAxYzI1YTk0OWUwMGVhM2E3N2E1MDhkM2EzMzE0MmYxMzllMg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1998-04-03T12:17:58Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1998-04-03T12:17:58Z"}, "message": "* decl.c (cplus_expand_expr_stmt): Strip unused INDIRECT_REFs.\n\nFrom-SVN: r18974", "tree": {"sha": "3db835b5eec1bdb109338f53bf3dc77fd46eb6aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3db835b5eec1bdb109338f53bf3dc77fd46eb6aa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b3e401c25a949e00ea3a77a508d3a33142f139e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3e401c25a949e00ea3a77a508d3a33142f139e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b3e401c25a949e00ea3a77a508d3a33142f139e2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3e401c25a949e00ea3a77a508d3a33142f139e2/comments", "author": null, "committer": null, "parents": [{"sha": "9a71c18b28efc85365b4a221558d748ec6582794", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a71c18b28efc85365b4a221558d748ec6582794", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a71c18b28efc85365b4a221558d748ec6582794"}], "stats": {"total": 8, "additions": 8, "deletions": 0}, "files": [{"sha": "b02f2bb02b09e5281448b9a3f7e44d46db2fe1b9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3e401c25a949e00ea3a77a508d3a33142f139e2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3e401c25a949e00ea3a77a508d3a33142f139e2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=b3e401c25a949e00ea3a77a508d3a33142f139e2", "patch": "@@ -1,5 +1,7 @@\n Fri Apr  3 02:22:59 1998  Jason Merrill  <jason@yorick.cygnus.com>\n \n+\t* decl.c (cplus_expand_expr_stmt): Strip unused INDIRECT_REFs.\n+\n \tRe-implement allocation of base class subobjects.\n \t* tree.c (unshare_base_binfos): New fn.\n \t(layout_basetypes): Use it.  Now handles offsets of both virtual and"}, {"sha": "e8916133ed3ff7c9a5a8d66b6311f1a9da764358", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3e401c25a949e00ea3a77a508d3a33142f139e2/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3e401c25a949e00ea3a77a508d3a33142f139e2/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=b3e401c25a949e00ea3a77a508d3a33142f139e2", "patch": "@@ -12886,6 +12886,12 @@ cplus_expand_expr_stmt (exp)\n \t libg++ to miscompile, and tString to core dump.  */\n       exp = build1 (CLEANUP_POINT_EXPR, TREE_TYPE (exp), exp);\n #endif\n+\n+      /* Strip unused implicit INDIRECT_REFs of references.  */\n+      if (TREE_CODE (exp) == INDIRECT_REF\n+\t  && TREE_CODE (TREE_TYPE (TREE_OPERAND (exp, 0))) == REFERENCE_TYPE)\n+\texp = TREE_OPERAND (exp, 0);\n+\n       /* If we don't do this, we end up down inside expand_expr\n \t trying to do TYPE_MODE on the ERROR_MARK, and really\n \t go outside the bounds of the type.  */"}]}