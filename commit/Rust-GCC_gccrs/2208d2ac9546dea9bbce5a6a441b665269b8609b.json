{"sha": "2208d2ac9546dea9bbce5a6a441b665269b8609b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjIwOGQyYWM5NTQ2ZGVhOWJiY2U1YTZhNDQxYjY2NTI2OWI4NjA5Yg==", "commit": {"author": {"name": "Loren J. Rittle", "email": "ljrittle@acm.org", "date": "2009-09-22T16:28:26Z"}, "committer": {"name": "Loren J. Rittle", "email": "ljrittle@gcc.gnu.org", "date": "2009-09-22T16:28:26Z"}, "message": "unwind-dw2-fde-glibc.c: Define and use USE_PT_GNU_EH_FRAME.\n\n2009-09-22  Loren J. Rittle  <ljrittle@acm.org>\n\n\t* unwind-dw2-fde-glibc.c: Define and use USE_PT_GNU_EH_FRAME.\n\tEnable a new case for __FreeBSD__ >= 7.\n\t* crtstuff.c:  Define USE_PT_GNU_EH_FRAME for __FreeBSD__ >= 7.\n\t* config/t-freebsd: Define LIB2ADDEH and LIB2ADDEHDEP.\n\t* config/freebsd-spec.h: Conditionally define LINK_EH_SPEC\n\tand USE_LD_AS_NEEDED.\n\nFrom-SVN: r152027", "tree": {"sha": "015c1787a0666c3af733e84bc0f39d8a74838a08", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/015c1787a0666c3af733e84bc0f39d8a74838a08"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2208d2ac9546dea9bbce5a6a441b665269b8609b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2208d2ac9546dea9bbce5a6a441b665269b8609b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2208d2ac9546dea9bbce5a6a441b665269b8609b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2208d2ac9546dea9bbce5a6a441b665269b8609b/comments", "author": null, "committer": null, "parents": [{"sha": "5d0001f01521eb923c16cd69c807c655ae9acb54", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d0001f01521eb923c16cd69c807c655ae9acb54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d0001f01521eb923c16cd69c807c655ae9acb54"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "0221aead2e5c855511834bca2a2d087b803762e4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2208d2ac9546dea9bbce5a6a441b665269b8609b", "patch": "@@ -1,3 +1,12 @@\n+2009-09-22  Loren J. Rittle  <ljrittle@acm.org>\n+\n+\t* unwind-dw2-fde-glibc.c: Define and use USE_PT_GNU_EH_FRAME.\n+\tEnable a new case for __FreeBSD__ >= 7.\n+\t* crtstuff.c:  Define USE_PT_GNU_EH_FRAME for __FreeBSD__ >= 7.\n+\t* config/t-freebsd: Define LIB2ADDEH and LIB2ADDEHDEP.\n+\t* config/freebsd-spec.h: Conditionally define LINK_EH_SPEC\n+\tand USE_LD_AS_NEEDED.\n+\n 2009-09-22  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/41395"}, {"sha": "84d81278af868e5bd8143f32c3c39979c874da73", "filename": "gcc/config/freebsd-spec.h", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Fconfig%2Ffreebsd-spec.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Fconfig%2Ffreebsd-spec.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ffreebsd-spec.h?ref=2208d2ac9546dea9bbce5a6a441b665269b8609b", "patch": "@@ -148,3 +148,12 @@ is built with the --enable-threads configure-time option.}\t\t\\\n #else\n #define FBSD_DYNAMIC_LINKER \"/libexec/ld-elf.so.1\"\n #endif\n+\n+#if defined(HAVE_LD_EH_FRAME_HDR)\n+#define LINK_EH_SPEC \"%{!static:--eh-frame-hdr} \"\n+#endif\n+\n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif"}, {"sha": "c1b086ea116443c44c8f786d0cc6d019f2bd2095", "filename": "gcc/config/t-freebsd", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Fconfig%2Ft-freebsd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Fconfig%2Ft-freebsd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ft-freebsd?ref=2208d2ac9546dea9bbce5a6a441b665269b8609b", "patch": "@@ -3,3 +3,8 @@ CRTSTUFF_T_CFLAGS_S = $(CRTSTUFF_T_CFLAGS) -fPIC\n \n # Compile libgcc.a with pic.\n TARGET_LIBGCC2_CFLAGS += -fPIC\n+\n+# Use unwind-dw2-fde-glibc\n+LIB2ADDEH = $(srcdir)/unwind-dw2.c $(srcdir)/unwind-dw2-fde-glibc.c \\\n+  $(srcdir)/unwind-sjlj.c $(srcdir)/gthr-gnat.c $(srcdir)/unwind-c.c\n+LIB2ADDEHDEP = unwind.inc unwind-dw2-fde.h unwind-dw2-fde.c"}, {"sha": "2b6b779920949813a8876367dc86d4290c9336f7", "filename": "gcc/crtstuff.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Fcrtstuff.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Fcrtstuff.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcrtstuff.c?ref=2208d2ac9546dea9bbce5a6a441b665269b8609b", "patch": "@@ -79,6 +79,15 @@ call_ ## FUNC (void)\t\t\t\t\t\\\n }\n #endif\n \n+#if defined(OBJECT_FORMAT_ELF) \\\n+    && !defined(OBJECT_FORMAT_FLAT) \\\n+    && defined(HAVE_LD_EH_FRAME_HDR) \\\n+    && !defined(inhibit_libc) && !defined(CRTSTUFFT_O) \\\n+    && defined(__FreeBSD__) && __FreeBSD__ >= 7\n+#include <link.h>\n+# define USE_PT_GNU_EH_FRAME\n+#endif\n+\n #if defined(OBJECT_FORMAT_ELF) \\\n     && !defined(OBJECT_FORMAT_FLAT) \\\n     && defined(HAVE_LD_EH_FRAME_HDR) \\"}, {"sha": "ad6ecd50d593882a7bfc6400a11c73b81ebd7ff1", "filename": "gcc/unwind-dw2-fde-glibc.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Funwind-dw2-fde-glibc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2208d2ac9546dea9bbce5a6a441b665269b8609b/gcc%2Funwind-dw2-fde-glibc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Funwind-dw2-fde-glibc.c?ref=2208d2ac9546dea9bbce5a6a441b665269b8609b", "patch": "@@ -48,6 +48,16 @@\n #if !defined(inhibit_libc) && defined(HAVE_LD_EH_FRAME_HDR) \\\n     && (__GLIBC__ > 2 || (__GLIBC__ == 2 && __GLIBC_MINOR__ > 2) \\\n \t|| (__GLIBC__ == 2 && __GLIBC_MINOR__ == 2 && defined(DT_CONFIG)))\n+# define USE_PT_GNU_EH_FRAME\n+#endif\n+\n+#if !defined(inhibit_libc) && defined(HAVE_LD_EH_FRAME_HDR) \\\n+    && defined(__FreeBSD__) && __FreeBSD__ >= 7\n+# define ElfW __ElfN\n+# define USE_PT_GNU_EH_FRAME\n+#endif\n+\n+#if defined(USE_PT_GNU_EH_FRAME)\n \n #ifndef __RELOC_POINTER\n # define __RELOC_POINTER(ptr, base) ((ptr) + (base))"}]}