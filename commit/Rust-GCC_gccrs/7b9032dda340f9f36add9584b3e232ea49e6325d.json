{"sha": "7b9032dda340f9f36add9584b3e232ea49e6325d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2I5MDMyZGRhMzQwZjlmMzZhZGQ5NTg0YjNlMjMyZWE0OWU2MzI1ZA==", "commit": {"author": {"name": "Jason Merrill", "email": "merrill@gnu.org", "date": "1994-08-12T08:28:45Z"}, "committer": {"name": "Jason Merrill", "email": "merrill@gnu.org", "date": "1994-08-12T08:28:45Z"}, "message": "(expand_anon_union_decl): Fix up the alignment and mode\n        of the member VAR_DECLs.\n\nFrom-SVN: r7899", "tree": {"sha": "d5851b2216fcd993bf2acfb34c7ae3869b3b0081", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d5851b2216fcd993bf2acfb34c7ae3869b3b0081"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7b9032dda340f9f36add9584b3e232ea49e6325d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b9032dda340f9f36add9584b3e232ea49e6325d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b9032dda340f9f36add9584b3e232ea49e6325d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b9032dda340f9f36add9584b3e232ea49e6325d/comments", "author": null, "committer": null, "parents": [{"sha": "55e2b88efc7bb896ef7b6b164500c79e7ca727e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55e2b88efc7bb896ef7b6b164500c79e7ca727e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55e2b88efc7bb896ef7b6b164500c79e7ca727e6"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "01228734d692f451adb9bfc9afb5ee84d6317ab9", "filename": "gcc/stmt.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b9032dda340f9f36add9584b3e232ea49e6325d/gcc%2Fstmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b9032dda340f9f36add9584b3e232ea49e6325d/gcc%2Fstmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstmt.c?ref=7b9032dda340f9f36add9584b3e232ea49e6325d", "patch": "@@ -3510,6 +3510,17 @@ expand_anon_union_decl (decl, cleanup, decl_elts)\n       tree cleanup_elt = TREE_PURPOSE (decl_elts);\n       enum machine_mode mode = TYPE_MODE (TREE_TYPE (decl_elt));\n \n+      /* Propagate the union's alignment to the elements.  */\n+      DECL_ALIGN (decl_elt) = DECL_ALIGN (decl);\n+\n+      /* If the element has BLKmode and the union doesn't, the union is\n+         aligned such that the element doesn't need to have BLKmode, so\n+         change the element's mode to the appropriate one for its size.  */\n+      if (mode == BLKmode && DECL_MODE (decl) != BLKmode)\n+\tDECL_MODE (decl_elt) = mode\n+\t  = mode_for_size (TREE_INT_CST_LOW (DECL_SIZE (decl_elt)),\n+\t\t\t   MODE_INT, 1);\n+\n       /* (SUBREG (MEM ...)) at RTL generation time is invalid, so we\n          instead create a new MEM rtx with the proper mode.  */\n       if (GET_CODE (x) == MEM)"}]}