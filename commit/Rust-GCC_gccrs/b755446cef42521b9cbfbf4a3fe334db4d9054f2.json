{"sha": "b755446cef42521b9cbfbf4a3fe334db4d9054f2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjc1NTQ0NmNlZjQyNTIxYjljYmZiZjRhM2ZlMzM0ZGI0ZDkwNTRmMg==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2005-08-04T03:57:41Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2005-08-04T03:57:41Z"}, "message": "re PR middle-end/23221 (-fstack-protector does not protect tail call functions)\n\n        PR 23221\n        * function.c (stack_protect_epilogue): Export.\n        * tree.h (stack_protect_epilogue): Declare.\n        * calls.c (expand_call): Call it.\n\nFrom-SVN: r102731", "tree": {"sha": "389fa11256e277631e1679c27218e3f2f99cb718", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/389fa11256e277631e1679c27218e3f2f99cb718"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b755446cef42521b9cbfbf4a3fe334db4d9054f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b755446cef42521b9cbfbf4a3fe334db4d9054f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b755446cef42521b9cbfbf4a3fe334db4d9054f2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b755446cef42521b9cbfbf4a3fe334db4d9054f2/comments", "author": null, "committer": null, "parents": [{"sha": "a4f5cd4441e5e5a140ad6495eef56b88462ca807", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4f5cd4441e5e5a140ad6495eef56b88462ca807", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4f5cd4441e5e5a140ad6495eef56b88462ca807"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "2a7ffc77f518230e2e712cb86428b148e6e62179", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b755446cef42521b9cbfbf4a3fe334db4d9054f2", "patch": "@@ -1,3 +1,10 @@\n+2005-08-03  Richard Henderson  <rth@redhat.com>\n+\n+\tPR 23221\n+\t* function.c (stack_protect_epilogue): Export.\n+\t* tree.h (stack_protect_epilogue): Declare.\n+\t* calls.c (expand_call): Call it.\n+\n 2005-08-03  Eric Christopher  <echristo@apple.com>\n \n \t* gcc.c (LINK_SSP_SPEC): Add fstack-protector-all."}, {"sha": "84e0db78c7f1fe25c620ec0e6a61847b3667b801", "filename": "gcc/calls.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2Fcalls.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2Fcalls.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcalls.c?ref=b755446cef42521b9cbfbf4a3fe334db4d9054f2", "patch": "@@ -2247,6 +2247,9 @@ expand_call (tree exp, rtx target, int ignore)\n       if (pass && (flags & (ECF_LIBCALL_BLOCK | ECF_MALLOC)))\n \tstart_sequence ();\n \n+      if (pass == 0 && cfun->stack_protect_guard)\n+\tstack_protect_epilogue ();\n+\n       adjusted_args_size = args_size;\n       /* Compute the actual size of the argument block required.  The variable\n \t and constant sizes must be combined, the size may have to be rounded,"}, {"sha": "225c2a981179750c4cf4a9878dbbd3ccb6530209", "filename": "gcc/function.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=b755446cef42521b9cbfbf4a3fe334db4d9054f2", "patch": "@@ -4013,7 +4013,7 @@ stack_protect_prologue (void)\n # define gen_stack_protect_test(x, y, z)\t(gcc_unreachable (), NULL_RTX)\n #endif\n \n-static void\n+void\n stack_protect_epilogue (void)\n {\n   tree guard_decl = targetm.stack_protect_guard ();"}, {"sha": "b6b637af9d5a2d9020a64e2debaa676af5d82283", "filename": "gcc/tree.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2Ftree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b755446cef42521b9cbfbf4a3fe334db4d9054f2/gcc%2Ftree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.h?ref=b755446cef42521b9cbfbf4a3fe334db4d9054f2", "patch": "@@ -3908,6 +3908,7 @@ extern void dump_tree_statistics (void);\n extern void expand_function_end (void);\n extern void expand_function_start (tree);\n extern void stack_protect_prologue (void);\n+extern void stack_protect_epilogue (void);\n extern void recompute_tree_invarant_for_addr_expr (tree);\n extern bool is_global_var (tree t);\n extern bool needs_to_live_in_memory (tree);"}]}