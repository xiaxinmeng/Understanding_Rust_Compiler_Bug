{"sha": "90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTBiMmY4YjY0MDY2YmZlNmZkZjZkNjdlMTNkZGU2Mjg1NDhlODJmOA==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2006-01-09T19:36:35Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2006-01-09T19:36:35Z"}, "message": "re PR fortran/21977 (nested function returning array)\n\n2006-01-09  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR fortran/21977\n        * gfortran.dg/nesting_2.f90: New test.\n        * gfortran.dg/nesting_3.f90: New test.\n\n2006-01-09  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR fortran/21977\n        * trans-decl.c (gfc_generate_function_code): Move the NULLing of\n        current_fake_result_decl down to below generate_local_vars.\n\nFrom-SVN: r109503", "tree": {"sha": "2007556757caa082b13e896e38da28021cc823ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2007556757caa082b13e896e38da28021cc823ae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/comments", "author": null, "committer": null, "parents": [{"sha": "487bf3e6703d3dd2b092f79bf52da5904176f953", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/487bf3e6703d3dd2b092f79bf52da5904176f953", "html_url": "https://github.com/Rust-GCC/gccrs/commit/487bf3e6703d3dd2b092f79bf52da5904176f953"}], "stats": {"total": 48, "additions": 44, "deletions": 4}, "files": [{"sha": "9c92709abcb73469ff43ce867da8611f2c340d87", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "patch": "@@ -1,3 +1,9 @@\n+2006-01-09  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR fortran/21977\n+\t* trans-decl.c (gfc_generate_function_code): Move the NULLing of\n+\tcurrent_fake_result_decl down to below generate_local_vars.\n+\n 2006-01-09  Feng Wang  <fengwang@nudt.edu.cn>\n \n \tPR fortran/12456"}, {"sha": "a3b5d98b4462da283fc121e7a744055127c7ee20", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "patch": "@@ -2558,9 +2558,6 @@ gfc_generate_function_code (gfc_namespace * ns)\n \n   trans_function_start (sym);\n \n-  /* Will be created as needed.  */\n-  current_fake_result_decl = NULL_TREE;\n-\n   gfc_start_block (&block);\n \n   if (ns->entries && ns->proc_name->ts.type == BT_CHARACTER)\n@@ -2582,7 +2579,9 @@ gfc_generate_function_code (gfc_namespace * ns)\n   gfc_generate_contained_functions (ns);\n \n   generate_local_vars (ns);\n-\n+  \n+  /* Will be created as needed.  */\n+  current_fake_result_decl = NULL_TREE;\n   current_function_return_label = NULL;\n \n   /* Now generate the code for the body of this function.  */"}, {"sha": "92f7e0205e5de0519232f9f11b7a86e68fb64033", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "patch": "@@ -1,3 +1,9 @@\n+2006-01-09  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR fortran/21977\n+\t* gfortran.dg/nesting_2.f90: New test.\n+\t* gfortran.dg/nesting_3.f90: New test.\n+\n 2006-01-09  Hans-Peter Nilsson  <hp@axis.com>\n \n \t* gcc.dg/Wpadded.c: Gate alignment warning on ! default_packed."}, {"sha": "e3ec9c9958d9d37b03efde41cccf2e2f65e5602d", "filename": "gcc/testsuite/gfortran.dg/nesting_2.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ftestsuite%2Fgfortran.dg%2Fnesting_2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ftestsuite%2Fgfortran.dg%2Fnesting_2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fnesting_2.f90?ref=90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "patch": "@@ -0,0 +1,15 @@\n+! check to make the nested function dawsonseries_v gets the correct\n+! fake return decl and that the outer (dawson_v) has an assignment of\n+! just the fake return decl for real and not the inner's return decl.\n+FUNCTION dawson_v()\n+  IMPLICIT NONE\n+  REAL  :: dawson_v\n+  dawson_v = 1.0\n+\n+  CONTAINS\n+    FUNCTION dawsonseries_v()\n+      IMPLICIT NONE\n+      REAL, DIMENSION(1) :: dawsonseries_v\n+      dawsonseries_v=1.0\n+    END FUNCTION dawsonseries_v\n+END FUNCTION dawson_v"}, {"sha": "0a052da893e8c5398f43b595b7e8c8e93a2aa771", "filename": "gcc/testsuite/gfortran.dg/nesting_3.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ftestsuite%2Fgfortran.dg%2Fnesting_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b2f8b64066bfe6fdf6d67e13dde628548e82f8/gcc%2Ftestsuite%2Fgfortran.dg%2Fnesting_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fnesting_3.f90?ref=90b2f8b64066bfe6fdf6d67e13dde628548e82f8", "patch": "@@ -0,0 +1,14 @@\n+! check to make the nested function dawsonseries_v gets the correct\n+! fake return decl and that the outer (dawson_v) has an assignment of\n+! just the fake return decl for real and not the inner's return decl.\n+FUNCTION dawson_v()\n+  IMPLICIT NONE\n+  REAL,DIMENSION(1)  :: dawson_v\n+  dawson_v = 1.0\n+  CONTAINS\n+    FUNCTION dawsonseries_v()\n+      IMPLICIT NONE\n+      REAL, DIMENSION(1) :: dawsonseries_v\n+      dawsonseries_v=1.0\n+    END FUNCTION dawsonseries_v\n+END FUNCTION dawson_v"}]}