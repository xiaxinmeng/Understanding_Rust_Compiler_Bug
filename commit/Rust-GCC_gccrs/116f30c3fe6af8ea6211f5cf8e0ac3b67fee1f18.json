{"sha": "116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTE2ZjMwYzNmZTZhZjhlYTYyMTFmNWNmOGUwYWMzYjY3ZmVlMWYxOA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2010-09-24T13:21:30Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2010-09-24T13:21:30Z"}, "message": "c-decl.c (pop_scope): Always set file-scope DECL_CONTEXT.\n\n2010-09-24  Richard Guenther  <rguenther@suse.de>\n\n\t* c-decl.c (pop_scope): Always set file-scope DECL_CONTEXT.\n\tMake sure to not call set_type_context with error_mark_node.\n\t* langhooks.c (lhd_set_decl_assembler_name): Use DECL_FILE_SCOPE_P.\n\n\t* gcc.dg/lto/20091006-2_0.c: Prune warnings.\n\nFrom-SVN: r164591", "tree": {"sha": "900072c0be45209de4c62493ca2c3e567bc209d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/900072c0be45209de4c62493ca2c3e567bc209d5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "de6ba7aee152a0c20572bf6250426862c5caf323", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de6ba7aee152a0c20572bf6250426862c5caf323", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de6ba7aee152a0c20572bf6250426862c5caf323"}], "stats": {"total": 26, "additions": 18, "deletions": 8}, "files": [{"sha": "d8c5125c17cb3012e097b9f1e7f12549f599a7b2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "patch": "@@ -1,3 +1,9 @@\n+2010-09-24  Richard Guenther  <rguenther@suse.de>\n+\n+\t* c-decl.c (pop_scope): Always set file-scope DECL_CONTEXT.\n+\tMake sure to not call set_type_context with error_mark_node.\n+\t* langhooks.c (lhd_set_decl_assembler_name): Use DECL_FILE_SCOPE_P.\n+\n 2010-09-24  Richard Guenther  <rguenther@suse.de>\n \n \t* Makefile.in (OBJS-onestep): Remove."}, {"sha": "35f3d29664e08a18fef925c5cf4c32b71f0204f6", "filename": "gcc/c-decl.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "patch": "@@ -1203,15 +1203,14 @@ pop_scope (void)\n \t      DECL_CHAIN (extp) = BLOCK_VARS (block);\n \t      BLOCK_VARS (block) = extp;\n \t    }\n-\t  /* If this is the file scope, and we are processing more\n-\t     than one translation unit in this compilation, set\n-\t     DECL_CONTEXT of each decl to the TRANSLATION_UNIT_DECL.\n-\t     This makes same_translation_unit_p work, and causes\n-\t     static declarations to be given disambiguating suffixes.  */\n-\t  if (scope == file_scope && num_in_fnames > 1)\n+\t  /* If this is the file scope set DECL_CONTEXT of each decl to\n+\t     the TRANSLATION_UNIT_DECL.  This makes same_translation_unit_p\n+\t     work.  */\n+\t  if (scope == file_scope)\n \t    {\n \t      DECL_CONTEXT (p) = context;\n-\t      if (TREE_CODE (p) == TYPE_DECL)\n+\t      if (TREE_CODE (p) == TYPE_DECL\n+\t\t  && TREE_TYPE (p) != error_mark_node)\n \t\tset_type_context (TREE_TYPE (p), context);\n \t    }\n "}, {"sha": "ce7522b1585bb0aa88ffd58f7536c43f3685fe6c", "filename": "gcc/langhooks.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Flanghooks.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Flanghooks.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks.c?ref=116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "patch": "@@ -176,7 +176,7 @@ lhd_set_decl_assembler_name (tree decl)\n      is less than the whole compilation.  Concatenate a distinguishing\n      number - we use the DECL_UID.  */\n \n-  if (TREE_PUBLIC (decl) || DECL_CONTEXT (decl) == NULL_TREE)\n+  if (TREE_PUBLIC (decl) || DECL_FILE_SCOPE_P (decl))\n     id = targetm.mangle_decl_assembler_name (decl, DECL_NAME (decl));\n   else\n     {"}, {"sha": "ea031cc2571445c861ba015907b659b86955ba0a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "patch": "@@ -1,3 +1,7 @@\n+2010-09-24  Richard Guenther  <rguenther@suse.de>\n+\n+\t* gcc.dg/lto/20091006-2_0.c: Prune warnings.\n+\n 2010-09-24  Marcus Shawcroft  <marcus.shawcroft@arm.com>\n \n \t* g++.dg/debug/dwarf2/nested-2.C: Permit the ARM @ character"}, {"sha": "abe12c40c68cb804b36ce5af86001f5251858a51", "filename": "gcc/testsuite/gcc.dg/lto/20091006-2_0.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20091006-2_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20091006-2_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20091006-2_0.c?ref=116f30c3fe6af8ea6211f5cf8e0ac3b67fee1f18", "patch": "@@ -1,4 +1,5 @@\n /* { dg-lto-do link } */\n+/* { dg-extra-ld-options \"-w\" } */\n \n extern int a[10];\n int main() { return 0; }"}]}