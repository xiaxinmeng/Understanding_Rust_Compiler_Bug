{"sha": "34fb9ba554ab82c877dc0475d78deb166c745941", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzRmYjliYTU1NGFiODJjODc3ZGMwNDc1ZDc4ZGViMTY2Yzc0NTk0MQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2002-05-16T00:14:24Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2002-05-16T00:14:24Z"}, "message": "varasm.c (merge_weak): Remove special case for extern and common.\n\n        * varasm.c (merge_weak): Remove special case for extern and common.\n\n        * gcc.dg/weak-5.c (vfoo1c, vfoo1g): Warn here.\n\nFrom-SVN: r53498", "tree": {"sha": "894268a09d2e902af191bc2e452a1bcab3f8eaa1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/894268a09d2e902af191bc2e452a1bcab3f8eaa1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34fb9ba554ab82c877dc0475d78deb166c745941", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34fb9ba554ab82c877dc0475d78deb166c745941", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34fb9ba554ab82c877dc0475d78deb166c745941", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34fb9ba554ab82c877dc0475d78deb166c745941/comments", "author": null, "committer": null, "parents": [{"sha": "62e118f59f99d1066c4577d1321c90f5f7a5589d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62e118f59f99d1066c4577d1321c90f5f7a5589d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62e118f59f99d1066c4577d1321c90f5f7a5589d"}], "stats": {"total": 25, "additions": 12, "deletions": 13}, "files": [{"sha": "714b5fda51e4c6324144e82c46ede5df50f53d30", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=34fb9ba554ab82c877dc0475d78deb166c745941", "patch": "@@ -1,3 +1,7 @@\n+2002-05-15  Richard Henderson  <rth@redhat.com>\n+\n+\t* varasm.c (merge_weak): Remove special case for extern and common.\n+\n 2002-05-15  Matt Hiller  <hiller@redhat.com>\n \n \t* testsuite/gcc.c-torture/compile/20000804-1.x: Don't return 1 if"}, {"sha": "e2b5ff06f469a485cd2e61af3fecc5cd7b6f30d0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=34fb9ba554ab82c877dc0475d78deb166c745941", "patch": "@@ -1,3 +1,7 @@\n+2002-05-15  Richard Henderson  <rth@redhat.com>\n+\n+\t* gcc.dg/weak-5.c (vfoo1c, vfoo1g): Warn here.\n+\n 2002-05-15  Richard Henderson  <rth@redhat.com>\n \n \t* gcc.dg/weak-5.c (vfoo1c): No warning here."}, {"sha": "8576379d3fb733bc4e426129ad0a53bfd9d45b18", "filename": "gcc/testsuite/gcc.dg/weak-5.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2Ftestsuite%2Fgcc.dg%2Fweak-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2Ftestsuite%2Fgcc.dg%2Fweak-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fweak-5.c?ref=34fb9ba554ab82c877dc0475d78deb166c745941", "patch": "@@ -44,7 +44,7 @@ void * foo1c (void)\n {\n   return (void *)&vfoo1c;\n }\n-extern int vfoo1c __attribute__((weak));\n+extern int vfoo1c __attribute__((weak)); /* { dg-warning \"unspecified behavior\" } */\n \n \n extern int vfoo1d __attribute__((weak));\n@@ -68,15 +68,15 @@ void * foo1f (void)\n {\n   return (void *)&vfoo1f;\n }\n-extern int vfoo1f __attribute__((weak)); /* { dg-warning \"weak declaration\" \"weak declaration\" } */\n+extern int vfoo1f __attribute__((weak)); /* { dg-warning \"unspecified behavior\" } */\n \n \n extern int vfoo1g;\n void * foo1g (void)\n {\n   return (void *)&vfoo1g;\n }\n-int vfoo1g __attribute__((weak));\n+int vfoo1g __attribute__((weak)); /* { dg-warning \"unspecified behavior\" } */\n \n \n extern int vfoo1h __attribute__((weak));"}, {"sha": "4a8841230282ac85741ed60ebb70fd82eaed210c", "filename": "gcc/varasm.c", "status": "modified", "additions": 1, "deletions": 10, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34fb9ba554ab82c877dc0475d78deb166c745941/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=34fb9ba554ab82c877dc0475d78deb166c745941", "patch": "@@ -4848,16 +4848,7 @@ merge_weak (newdecl, olddecl)\n \t have done so in a way that will not function properly with\n \t a weak symbol.  */\n       else if (TREE_USED (olddecl)\n-\t       && TREE_SYMBOL_REFERENCED (DECL_ASSEMBLER_NAME (olddecl))\n-\t       /* ??? Not impossible that some platform may generate code\n-\t\t  that doesn't function *at all* with incorrect declaration\n-\t\t  before use.  However, all known at present will assume\n-\t\t  exteral and common symbols are not \"local\".  */\n-\t       /* ??? Probably these exceptions to the rule will just\n-\t\t  confuse users about the true nature of the problem and\n-\t\t  we should warn for *any* use before weakening.  */\n-\t       && ! (DECL_EXTERNAL (olddecl)\n-\t\t     || DECL_COMMON (olddecl)))\n+\t       && TREE_SYMBOL_REFERENCED (DECL_ASSEMBLER_NAME (olddecl)))\n \twarning_with_decl (newdecl, \"weak declaration of `%s' after first use results in unspecified behavior\");\n \n       if (SUPPORTS_WEAK)"}]}