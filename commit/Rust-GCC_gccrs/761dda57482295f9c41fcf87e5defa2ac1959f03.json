{"sha": "761dda57482295f9c41fcf87e5defa2ac1959f03", "node_id": "C_kwDOANBUbNoAKDc2MWRkYTU3NDgyMjk1ZjljNDFmY2Y4N2U1ZGVmYTJhYzE5NTlmMDM", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2022-04-22T20:52:38Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2022-04-22T20:52:38Z"}, "message": "fortran: Generate an array temporary reference [PR102043]\n\nThis avoids regressing on char_cast_1.f90 and char_cast_2.f90 later in\nthe patch series when the code generation for array references is\nchanged to use pointer arithmetic.\n\nThe regressing testcases match part of an array reference in the\ngenerated tree dump and it\u2019s not clear how the pattern should be\nrewritten to match the equivalent with pointer arithmetic.\n\nThis change uses a method specific to array temporaries to generate\narray-references, so that these array references are flagged as safe\nfor array indexing and will not be updated to use pointer arithmetic.\n\n\tPR fortran/102043\n\ngcc/fortran/ChangeLog:\n\t* trans-array.cc (gfc_conv_expr_descriptor): Use\n\tgfc_conv_tmp_array_ref.", "tree": {"sha": "2d904f79f3d57a2c164e221428866139b600acd3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2d904f79f3d57a2c164e221428866139b600acd3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/761dda57482295f9c41fcf87e5defa2ac1959f03", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/761dda57482295f9c41fcf87e5defa2ac1959f03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/761dda57482295f9c41fcf87e5defa2ac1959f03", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/761dda57482295f9c41fcf87e5defa2ac1959f03/comments", "author": null, "committer": null, "parents": [{"sha": "e72fbb6915c1dd1a52ecef55e10329e353cc3072", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e72fbb6915c1dd1a52ecef55e10329e353cc3072", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e72fbb6915c1dd1a52ecef55e10329e353cc3072"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "11e47c0c1cad144c438f5278569a6bc4d6a00302", "filename": "gcc/fortran/trans-array.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/761dda57482295f9c41fcf87e5defa2ac1959f03/gcc%2Ffortran%2Ftrans-array.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/761dda57482295f9c41fcf87e5defa2ac1959f03/gcc%2Ffortran%2Ftrans-array.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.cc?ref=761dda57482295f9c41fcf87e5defa2ac1959f03", "patch": "@@ -7723,7 +7723,7 @@ gfc_conv_expr_descriptor (gfc_se *se, gfc_expr *expr)\n       lse.ss = loop.temp_ss;\n       rse.ss = ss;\n \n-      gfc_conv_scalarized_array_ref (&lse, NULL);\n+      gfc_conv_tmp_array_ref (&lse);\n       if (expr->ts.type == BT_CHARACTER)\n \t{\n \t  gfc_conv_expr (&rse, expr);"}]}