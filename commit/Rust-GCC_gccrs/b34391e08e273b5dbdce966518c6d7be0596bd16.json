{"sha": "b34391e08e273b5dbdce966518c6d7be0596bd16", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjM0MzkxZTA4ZTI3M2I1ZGJkY2U5NjY1MThjNmQ3YmUwNTk2YmQxNg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2017-06-22T22:11:01Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2017-06-22T22:11:01Z"}, "message": "runtime: mark dropm and callees nowritebarrierrec\n    \n    The CgocallbackDone function calls dropm after it calls entersyscall,\n    which means that dropm must not have any write barriers. Mark it\n    accordingly.\n    \n    Reviewed-on: https://go-review.googlesource.com/46464\n\nFrom-SVN: r249577", "tree": {"sha": "a7c718ad2a1c12d1364d1ab18d4899f4fdbbe2e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a7c718ad2a1c12d1364d1ab18d4899f4fdbbe2e6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b34391e08e273b5dbdce966518c6d7be0596bd16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b34391e08e273b5dbdce966518c6d7be0596bd16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b34391e08e273b5dbdce966518c6d7be0596bd16", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b34391e08e273b5dbdce966518c6d7be0596bd16/comments", "author": null, "committer": null, "parents": [{"sha": "f384e12acc5b5b06d5fcc9a40ea6cffb8c0aa4c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f384e12acc5b5b06d5fcc9a40ea6cffb8c0aa4c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f384e12acc5b5b06d5fcc9a40ea6cffb8c0aa4c8"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "3f42df6305698f41426ee106317f70825bf6e6d3", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b34391e08e273b5dbdce966518c6d7be0596bd16/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b34391e08e273b5dbdce966518c6d7be0596bd16/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=b34391e08e273b5dbdce966518c6d7be0596bd16", "patch": "@@ -1,4 +1,4 @@\n-55b2b2dee55bd495a770347daaf858634057ecb0\n+c5aa42107d116c9121de447d214297c88dd9f5fa\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "db3ea48ef4850959174f21fdf42b380519b47a3e", "filename": "libgo/go/runtime/os_gccgo.go", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b34391e08e273b5dbdce966518c6d7be0596bd16/libgo%2Fgo%2Fruntime%2Fos_gccgo.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b34391e08e273b5dbdce966518c6d7be0596bd16/libgo%2Fgo%2Fruntime%2Fos_gccgo.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fruntime%2Fos_gccgo.go?ref=b34391e08e273b5dbdce966518c6d7be0596bd16", "patch": "@@ -32,6 +32,7 @@ func minit() {\n \n // Called from dropm to undo the effect of an minit.\n //go:nosplit\n+//go:nowritebarrierrec\n func unminit() {\n \tunminitSignals()\n }"}, {"sha": "77b624ba61216c31c764258bc4a3aacd44e0126f", "filename": "libgo/go/runtime/proc.go", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b34391e08e273b5dbdce966518c6d7be0596bd16/libgo%2Fgo%2Fruntime%2Fproc.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b34391e08e273b5dbdce966518c6d7be0596bd16/libgo%2Fgo%2Fruntime%2Fproc.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fruntime%2Fproc.go?ref=b34391e08e273b5dbdce966518c6d7be0596bd16", "patch": "@@ -1447,6 +1447,9 @@ func oneNewExtraM() {\n // in which dropm happens on each cgo call, is still correct too.\n // We may have to keep the current version on systems with cgo\n // but without pthreads, like Windows.\n+//\n+// CgocallBackDone calls this after releasing p, so no write barriers.\n+//go:nowritebarrierrec\n func dropm() {\n \t// Clear m and g, and return m to the extra list.\n \t// After the call to setg we can only call nosplit functions\n@@ -1492,6 +1495,7 @@ var extraMWaiters uint32\n // return a nil list head if that's what it finds. If nilokay is false,\n // lockextra will keep waiting until the list head is no longer nil.\n //go:nosplit\n+//go:nowritebarrierrec\n func lockextra(nilokay bool) *m {\n \tconst locked = 1\n \n@@ -1524,6 +1528,7 @@ func lockextra(nilokay bool) *m {\n }\n \n //go:nosplit\n+//go:nowritebarrierrec\n func unlockextra(mp *m) {\n \tatomic.Storeuintptr(&extram, uintptr(unsafe.Pointer(mp)))\n }"}, {"sha": "e2642ee25fc0ed00efc8060661125a317a30d7d4", "filename": "libgo/go/runtime/signal_unix.go", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b34391e08e273b5dbdce966518c6d7be0596bd16/libgo%2Fgo%2Fruntime%2Fsignal_unix.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b34391e08e273b5dbdce966518c6d7be0596bd16/libgo%2Fgo%2Fruntime%2Fsignal_unix.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fruntime%2Fsignal_unix.go?ref=b34391e08e273b5dbdce966518c6d7be0596bd16", "patch": "@@ -599,6 +599,7 @@ func minitSignalMask() {\n // unminitSignals is called from dropm, via unminit, to undo the\n // effect of calling minit on a non-Go thread.\n //go:nosplit\n+//go:nowritebarrierrec\n func unminitSignals() {\n \tif getg().m.newSigstack {\n \t\tsignalstack(nil, 0)"}]}