{"sha": "e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTRkNTAzMWNjODhkYjUzZmUzYWE5NzU5YjljOTc4MGMxNzliMjFiNQ==", "commit": {"author": {"name": "Rafael Espindola", "email": "espindola@gcc.gnu.org", "date": "2009-11-19T20:22:53Z"}, "committer": {"name": "Rafael Espindola", "email": "espindola@gcc.gnu.org", "date": "2009-11-19T20:22:53Z"}, "message": "[multiple changes]\n\n2009-11-19  Rafael Avila de Espindola  <espindola@google.com>\n\n\t* g++.dg/plugin/selfassign.c: Include plugin-version.h.\n\t(plugin_init): Pass correct version to plugin_default_version_check.\n\t* gcc.dg/plugin/ggcplug.c: Include plugin-version.h.\n\t(plugin_init): Pass correct version to plugin_default_version_check.\n\t* gcc.dg/plugin/selfassign.c: Include plugin-version.h.\n\t(plugin_init): Pass correct version to plugin_default_version_check.\n\n\n2009-11-19  Basile Starynkevitch  <basile@starynkevitch.net>\n            Rafael Avila de Espindola  <espindola@google.com>\n\n\t* doc/plugins.texi (Plugin initialization): Added advices for\n\tretrieving the version of GCC at plugin compilation and loading\n\ttimes.\n\nFrom-SVN: r154342", "tree": {"sha": "b395448ebbfaf7f0dd42352215cbda920c328003", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b395448ebbfaf7f0dd42352215cbda920c328003"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/comments", "author": null, "committer": null, "parents": [{"sha": "bf4967a1bd8c61fdf111a47f6ef87e24479299df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf4967a1bd8c61fdf111a47f6ef87e24479299df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf4967a1bd8c61fdf111a47f6ef87e24479299df"}], "stats": {"total": 45, "additions": 41, "deletions": 4}, "files": [{"sha": "8f6462414b1d1f6a20e7864b545b89ac03b02652", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "patch": "@@ -1,3 +1,10 @@\n+2009-11-19  Basile Starynkevitch  <basile@starynkevitch.net>\n+            Rafael Avila de Espindola  <espindola@google.com>\n+\n+\t* doc/plugins.texi (Plugin initialization): Added advices for\n+\tretrieving the version of GCC at plugin compilation and loading\n+\ttimes.\n+\n 2009-11-19  Basile Starynkevitch  <basile@starynkevitch.net>\n \n \t* plugin.c (FMT_FOR_PLUGIN_EVENT): added definition."}, {"sha": "eb1008e8f2cd2de6c8dc8e8bd1b4fe6eed92f117", "filename": "gcc/doc/plugins.texi", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Fdoc%2Fplugins.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Fdoc%2Fplugins.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fplugins.texi?ref=e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "patch": "@@ -105,6 +105,25 @@ The function @code{plugin_default_version_check} takes two pointers to\n such structure and compare them field by field. It can be used by the\n plugin's @code{plugin_init} function.\n \n+The version of GCC used to compile the plugin can be found in the symbol\n+@code{gcc_version} defined in the header @file{plugin-version.h}. The\n+recommended version check to perform looks like\n+\n+@smallexample\n+#include \"plugin-version.h\"\n+...\n+\n+int\n+plugin_init (struct plugin_name_args *plugin_info,\n+             struct plugin_gcc_version *version)\n+@{\n+  if (!plugin_default_version_check (version, &gcc_version))\n+    return 1;\n+\n+@}\n+@end smallexample\n+\n+but you can also check the individual fields if you want a less strict check.\n \n @subsection Plugin callbacks\n "}, {"sha": "c96876f6b925fa65d4573d102a750eadb159c126", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "patch": "@@ -1,3 +1,12 @@\n+2009-11-19  Rafael Avila de Espindola  <espindola@google.com>\n+\n+\t* g++.dg/plugin/selfassign.c: Include plugin-version.h.\n+\t(plugin_init): Pass correct version to plugin_default_version_check.\n+\t* gcc.dg/plugin/ggcplug.c: Include plugin-version.h.\n+\t(plugin_init): Pass correct version to plugin_default_version_check.\n+\t* gcc.dg/plugin/selfassign.c: Include plugin-version.h.\n+\t(plugin_init): Pass correct version to plugin_default_version_check.\n+\n 2009-11-19  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/561"}, {"sha": "8d76301d8155a24a5e91f9fa5176713a4558722a", "filename": "gcc/testsuite/g++.dg/plugin/selfassign.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fplugin%2Fselfassign.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fplugin%2Fselfassign.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fplugin%2Fselfassign.c?ref=e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "patch": "@@ -13,6 +13,7 @@\n #include \"tree.h\"\n #include \"tree-pass.h\"\n #include \"intl.h\"\n+#include \"plugin-version.h\"\n \n int plugin_is_GPL_compatible;\n \n@@ -305,7 +306,7 @@ plugin_init (struct plugin_name_args *plugin_info,\n   bool enabled = true;\n   int i;\n \n-  if (!plugin_default_version_check (version, version))\n+  if (!plugin_default_version_check (version, &gcc_version))\n     return 1;\n \n   /* Self-assign detection should happen after SSA is constructed.  */"}, {"sha": "03bd563b5adc2cf35341b83a6f420486c8a3116f", "filename": "gcc/testsuite/gcc.dg/plugin/ggcplug.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2Fgcc.dg%2Fplugin%2Fggcplug.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2Fgcc.dg%2Fplugin%2Fggcplug.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fplugin%2Fggcplug.c?ref=e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "patch": "@@ -12,6 +12,7 @@\n #include \"tree-pass.h\"\n #include \"intl.h\"\n #include \"gcc-plugin.h\"\n+#include \"plugin-version.h\"\n \n int plugin_is_GPL_compatible;\n \n@@ -43,7 +44,7 @@ plugin_init (struct plugin_name_args *plugin_info,\n   int argc = plugin_info->argc;\n   int i = 0;\n   struct plugin_argument *argv = plugin_info->argv;\n-  if (!plugin_default_version_check (version, version))\n+  if (!plugin_default_version_check (version, &gcc_version))\n     return 1;\n   /* Process the plugin arguments. This plugin takes the following arguments:\n      count-ggc-start count-ggc-end count-ggc-mark */"}, {"sha": "8d76301d8155a24a5e91f9fa5176713a4558722a", "filename": "gcc/testsuite/gcc.dg/plugin/selfassign.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2Fgcc.dg%2Fplugin%2Fselfassign.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4d5031cc88db53fe3aa9759b9c9780c179b21b5/gcc%2Ftestsuite%2Fgcc.dg%2Fplugin%2Fselfassign.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fplugin%2Fselfassign.c?ref=e4d5031cc88db53fe3aa9759b9c9780c179b21b5", "patch": "@@ -13,7 +13,7 @@\n #include \"tree.h\"\n #include \"tree-pass.h\"\n #include \"intl.h\"\n-\n+#include \"plugin-version.h\"\n \n int plugin_is_GPL_compatible;\n \n@@ -306,7 +306,7 @@ plugin_init (struct plugin_name_args *plugin_info,\n   bool enabled = true;\n   int i;\n \n-  if (!plugin_default_version_check (version, version))\n+  if (!plugin_default_version_check (version, &gcc_version))\n     return 1;\n \n   /* Self-assign detection should happen after SSA is constructed.  */"}]}