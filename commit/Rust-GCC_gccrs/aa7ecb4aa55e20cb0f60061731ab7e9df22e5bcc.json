{"sha": "aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWE3ZWNiNGFhNTVlMjBjYjBmNjAwNjE3MzFhYjdlOWRmMjJlNWJjYw==", "commit": {"author": {"name": "Gavin Romig-Koch", "email": "gavin@cygnus.com", "date": "1999-01-18T09:10:44Z"}, "committer": {"name": "Gavin Romig-Koch", "email": "gavin@gcc.gnu.org", "date": "1999-01-18T09:10:44Z"}, "message": "mips.md (div_trap): Split div_trap_mips16 from div_trap.\n\n\t* config/mips/mips.md (div_trap): Split div_trap_mips16\n\tfrom div_trap.\n\t(div_trap_normal,div_trap_mips16): Correct the length attributes.\n\nFrom-SVN: r24745", "tree": {"sha": "bd6f6f8c09a4157f93040420891147d946dc996d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bd6f6f8c09a4157f93040420891147d946dc996d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc/comments", "author": null, "committer": null, "parents": [{"sha": "08c259de900203c9ead1653d3a4a050d1dc5eca3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08c259de900203c9ead1653d3a4a050d1dc5eca3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08c259de900203c9ead1653d3a4a050d1dc5eca3"}], "stats": {"total": 58, "additions": 56, "deletions": 2}, "files": [{"sha": "57e2ad00a890b9bae487329c60fb220dbc696dec", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc", "patch": "@@ -1,3 +1,9 @@\n+Mon Jan 18 12:03:08 1999  Gavin Romig-Koch  <gavin@cygnus.com>\n+\n+\t* config/mips/mips.md (div_trap): Split div_trap_mips16\n+\tfrom div_trap.  \n+\t(div_trap_normal,div_trap_mips16): Correct the length attributes.\n+\n Mon Jan 18 11:48:28 1999  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* cpplib.c (special_symbol): Qualify a char* with the `const' keyword."}, {"sha": "1e64a05951428730b3979748acb975294d94d1f5", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 50, "deletions": 2, "changes": 52, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=aa7ecb4aa55e20cb0f60061731ab7e9df22e5bcc", "patch": "@@ -2412,11 +2412,25 @@\n \n ;; Division trap\n \n-(define_insn \"div_trap\"\n+(define_expand \"div_trap\"\n   [(trap_if (eq (match_operand 0 \"register_operand\" \"d\")\n \t\t(match_operand 1 \"reg_or_0_operand\" \"dJ\"))\n             (match_operand 2 \"immediate_operand\" \"\"))]\n   \"\"\n+  \"\n+{\n+  if (TARGET_MIPS16)\n+    emit_insn (gen_div_trap_mips16 (operands[0],operands[1],operands[2]));\n+  else\n+    emit_insn (gen_div_trap_normal (operands[0],operands[1],operands[2]));\n+  DONE;\n+}\")\n+\n+(define_insn \"div_trap_normal\"\n+  [(trap_if (eq (match_operand 0 \"register_operand\" \"d\")\n+\t\t(match_operand 1 \"reg_or_0_operand\" \"dJ\"))\n+            (match_operand 2 \"immediate_operand\" \"\"))]\n+  \"!TARGET_MIPS16\"\n   \"*\n {\n   rtx link;\n@@ -2450,7 +2464,41 @@\n   return \\\"\\\";\n }\"\n   [(set_attr \"type\" \"unknown\")\n-   (set_attr \"length\" \"2\")])\n+   (set_attr \"length\" \"3\")])\n+\n+\n+;; The mips16 bne insns is a macro which uses reg 24 as an intermediate.\n+\n+(define_insn \"div_trap_mips16\"\n+  [(trap_if (eq (match_operand 0 \"register_operand\" \"d\")\n+\t\t(match_operand 1 \"reg_or_0_operand\" \"dJ\"))\n+            (match_operand 2 \"immediate_operand\" \"\"))\n+   (clobber (reg:SI 24))]\n+  \"TARGET_MIPS16\"\n+  \"*\n+{\n+  rtx link;\n+  int have_dep_anti = 0;\n+\n+  /* For divmod if one division is not needed then we don't need an extra\n+     divide by zero trap, which is anti dependent on previous trap */\n+  for (link = LOG_LINKS (insn); link; link = XEXP (link, 1))\n+\n+    if ((int) REG_DEP_ANTI == (int) REG_NOTE_KIND (link)\n+        && GET_CODE (PATTERN (XEXP (link, 0))) == TRAP_IF\n+\t&& REGNO (operands[1]) == 0)\n+      have_dep_anti = 1;\n+  if (! have_dep_anti)\n+    {\n+      if (GET_CODE (operands[1]) == CONST_INT)\n+        return \\\"%(bnez\\\\t%0,1f\\\\n\\\\tnop\\\\n\\\\tbreak\\\\t%2\\\\n1:%)\\\";\n+      else\n+        return \\\"%(bne\\\\t%0,%1,1f\\\\n\\\\tnop\\\\n\\\\tbreak\\\\t%2\\\\n1:%)\\\";\n+    }\n+  return \\\"\\\";\n+}\"\n+  [(set_attr \"type\" \"unknown\")\n+   (set_attr \"length\" \"4\")])\n \n (define_expand \"divsi3\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=l\")"}]}