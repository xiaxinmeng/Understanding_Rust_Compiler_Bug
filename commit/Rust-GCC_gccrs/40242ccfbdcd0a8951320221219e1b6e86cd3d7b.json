{"sha": "40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDAyNDJjY2ZiZGNkMGE4OTUxMzIwMjIxMjE5ZTFiNmU4NmNkM2Q3Yg==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "1999-08-19T08:06:17Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "1999-08-19T08:06:17Z"}, "message": "cp-tree.def (PSEUDO_DTOR_EXPR): New tree code.\n\n\t* cp-tree.def (PSEUDO_DTOR_EXPR): New tree code.\n\t* decl2.c (build_expr_from_tree): Handle it.\n\t* error.c (dump_expr): Likewise.\n\t* pt.c (for_each_template_parm): Likewise.\n\t(tsubst_copy): Likewise.\n\t* tree.c (search_tree): Likewise.\n\t* semantics.c (finish_pseudo_destructor_call): Create it.\n\nFrom-SVN: r28760", "tree": {"sha": "d724306354e6410faeef1eded4ca3830ddf7a1de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d724306354e6410faeef1eded4ca3830ddf7a1de"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/comments", "author": null, "committer": null, "parents": [{"sha": "4c44366adbe43f18360fdf61ceb4586d0f3144fb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c44366adbe43f18360fdf61ceb4586d0f3144fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c44366adbe43f18360fdf61ceb4586d0f3144fb"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "443cdd5e9315d8c3a22cfca9d5e814b0dad5c192", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -1,3 +1,13 @@\n+1999-08-19  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* cp-tree.def (PSEUDO_DTOR_EXPR): New tree code.\n+\t* decl2.c (build_expr_from_tree): Handle it.\n+\t* error.c (dump_expr): Likewise.\n+\t* pt.c (for_each_template_parm): Likewise.\n+\t(tsubst_copy): Likewise.\n+\t* tree.c (search_tree): Likewise.\n+\t* semantics.c (finish_pseudo_destructor_call): Create it.\n+\t\n 1999-08-18  Mark Mitchell  <mark@codesourcery.com>\n \n \t* search.c (setup_class_bindings): Robustify."}, {"sha": "d31d33ea85e416448a16bf0e7946bf962aa6c099", "filename": "gcc/cp/cp-tree.def", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fcp-tree.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fcp-tree.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.def?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -214,6 +214,7 @@ DEFTREECODE (ALIGNOF_EXPR, \"alignof_expr\", '1', 1)\n DEFTREECODE (ARROW_EXPR, \"arrow_expr\", 'e', 1)\n DEFTREECODE (DOTSTAR_EXPR, \"dotstar_expr\", 'e', 2)\n DEFTREECODE (TYPEID_EXPR, \"typeid_expr\", 'e', 1)\n+DEFTREECODE (PSEUDO_DTOR_EXPR, \"pseudo_dtor_expr\", 'e', 3)\n \n DEFTREECODE (EXPR_STMT, \"expr_stmt\", 'e', 1)\n DEFTREECODE (COMPOUND_STMT, \"compound_stmt\", 'e', 1)"}, {"sha": "ecfdd61e695f8dcec77be82001adfe8b441e4061", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -3992,6 +3992,12 @@ build_expr_from_tree (t)\n \t build_expr_from_tree (TREE_OPERAND (t, 1)),\n \t build_expr_from_tree (TREE_OPERAND (t, 2)));\n \n+    case PSEUDO_DTOR_EXPR:\n+      return (finish_pseudo_destructor_call_expr \n+\t      (build_expr_from_tree (TREE_OPERAND (t, 0)),\n+\t       build_expr_from_tree (TREE_OPERAND (t, 1)),\n+\t       build_expr_from_tree (TREE_OPERAND (t, 2))));\n+\n     case TREE_LIST:\n       {\n \ttree purpose, value, chain;"}, {"sha": "b6598ff30a4bece6c0b8d5173681f85dea5fc362", "filename": "gcc/cp/error.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -1776,6 +1776,14 @@ dump_expr (t, nop)\n       dump_expr (TREE_OPERAND (t, 0), nop);\n       break;\n \n+    case PSEUDO_DTOR_EXPR:\n+      dump_expr (TREE_OPERAND (t, 2), nop);\n+      OB_PUTS (\".\");\n+      dump_type (TREE_OPERAND (t, 0), nop);\n+      OB_PUTS (\"::~\");\n+      dump_type (TREE_OPERAND (t, 1), nop);\n+      break;\n+\n     case TEMPLATE_ID_EXPR:\n       dump_decl (t, 0);\n       break;"}, {"sha": "e1e8ab435cc6b3e9a6852c2119ed959ea63312d2", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -4300,6 +4300,7 @@ for_each_template_parm (t, fn, data)\n     case DOTSTAR_EXPR:\n     case TYPEID_EXPR:\n     case LOOKUP_EXPR:\n+    case PSEUDO_DTOR_EXPR:\n       if (!fn)\n \treturn 1;\n       /* Fall through.  */\n@@ -7078,6 +7079,7 @@ tsubst_copy (t, args, complain, in_decl)\n \n     case COND_EXPR:\n     case MODOP_EXPR:\n+    case PSEUDO_DTOR_EXPR:\n       {\n \tr = build_nt\n \t  (code, tsubst_copy (TREE_OPERAND (t, 0), args, complain, in_decl),"}, {"sha": "def1276bffc489927ae05b062df8f67bca88106b", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -1229,6 +1229,9 @@ finish_pseudo_destructor_call_expr (object, scope, destructor)\n      tree scope;\n      tree destructor;\n {\n+  if (processing_template_decl)\n+    return build_min_nt (PSEUDO_DTOR_EXPR, object, scope, destructor);\n+\n   if (scope && scope != destructor)\n     cp_error (\"destructor specifier `%T::~%T()' must have matching names\", \n \t      scope, destructor);"}, {"sha": "8d367535ba06e67be42c8361c493094f4112fc11", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -1675,6 +1675,7 @@ search_tree (t, func)\n     case ARROW_EXPR:\n     case DOTSTAR_EXPR:\n     case TYPEID_EXPR:\n+    case PSEUDO_DTOR_EXPR:\n       break;\n \n     case COMPLEX_CST:"}, {"sha": "907360bf78e1a891ac2f53168fdb6c616d67e4f8", "filename": "gcc/testsuite/g++.old-deja/g++.pt/crash48.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash48.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40242ccfbdcd0a8951320221219e1b6e86cd3d7b/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash48.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash48.C?ref=40242ccfbdcd0a8951320221219e1b6e86cd3d7b", "patch": "@@ -0,0 +1,8 @@\n+// Build don't link:\n+// Origin: Jean-Francois Panisset <panisset@discreet.com>\n+\n+template<class T>\n+void foo(T *data)\n+{\n+  ((char *)data)->~T();\n+}"}]}