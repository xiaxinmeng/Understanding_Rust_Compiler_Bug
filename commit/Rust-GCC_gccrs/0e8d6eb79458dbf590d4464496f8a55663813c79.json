{"sha": "0e8d6eb79458dbf590d4464496f8a55663813c79", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGU4ZDZlYjc5NDU4ZGJmNTkwZDQ0NjQ0OTZmOGE1NTY2MzgxM2M3OQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2017-05-02T22:35:24Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2017-05-02T22:35:24Z"}, "message": "ipa-inline-analysis.c (estimate_node_size_and_time): Allow roundoff errors when comparing specialized and unspecialized times.\n\n\n\t* ipa-inline-analysis.c (estimate_node_size_and_time): Allow roundoff\n\terrors when comparing specialized and unspecialized times.\n\nFrom-SVN: r247528", "tree": {"sha": "63cf6af2b63764cce5dd29ebe5e6d982318d44eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/63cf6af2b63764cce5dd29ebe5e6d982318d44eb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0e8d6eb79458dbf590d4464496f8a55663813c79", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e8d6eb79458dbf590d4464496f8a55663813c79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e8d6eb79458dbf590d4464496f8a55663813c79", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e8d6eb79458dbf590d4464496f8a55663813c79/comments", "author": null, "committer": null, "parents": [{"sha": "c3b73151139abea8b5ee98e3f057138f53924c08", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3b73151139abea8b5ee98e3f057138f53924c08", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3b73151139abea8b5ee98e3f057138f53924c08"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "61a33210c0b49f8b160b47dac1edc0166cf8140c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e8d6eb79458dbf590d4464496f8a55663813c79/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e8d6eb79458dbf590d4464496f8a55663813c79/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0e8d6eb79458dbf590d4464496f8a55663813c79", "patch": "@@ -1,3 +1,8 @@\n+2017-05-02  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-inline-analysis.c (estimate_node_size_and_time): Allow roundoff\n+\terrors when comparing specialized and unspecialized times.\n+\n 2017-05-02  David Malcolm  <dmalcolm@redhat.com>\n \n \t* diagnostic-show-locus.c\n@@ -354,6 +359,11 @@\n \tif the only reason why modified_in_p returned true is that\n \taddr is SP based and set_insn is a push or pop.\n \n+2017-04-29  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-inline.c (compute_inlined_call_time): Remove now unnecesary\n+\toverflow check.\n+\n 2017-04-29  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR ipa/79224"}, {"sha": "929de8e9791a9b91d54096e134116e0be4f15d82", "filename": "gcc/ipa-inline-analysis.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e8d6eb79458dbf590d4464496f8a55663813c79/gcc%2Fipa-inline-analysis.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e8d6eb79458dbf590d4464496f8a55663813c79/gcc%2Fipa-inline-analysis.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-inline-analysis.c?ref=0e8d6eb79458dbf590d4464496f8a55663813c79", "patch": "@@ -3422,7 +3422,15 @@ estimate_node_size_and_time (struct cgraph_node *node,\n   min_size = (*info->entry)[0].size;\n   gcc_checking_assert (size >= 0);\n   gcc_checking_assert (time >= 0);\n-  gcc_checking_assert (nonspecialized_time >= time);\n+  /* nonspecialized_time should be always bigger than specialized time.\n+     Roundoff issues however may get into the way.  */\n+  gcc_checking_assert ((nonspecialized_time - time) >= -1);\n+\n+  /* Roundoff issues may make specialized time bigger than nonspecialized\n+     time.  We do not really want that to happen because some heurstics\n+     may get confused by seeing negative speedups.  */\n+  if (time > nonspecialized_time)\n+    time = nonspecialized_time;\n \n   if (info->loop_iterations\n       && !evaluate_predicate (info->loop_iterations, possible_truths))"}]}