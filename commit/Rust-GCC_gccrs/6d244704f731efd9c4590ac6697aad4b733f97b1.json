{"sha": "6d244704f731efd9c4590ac6697aad4b733f97b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQyNDQ3MDRmNzMxZWZkOWM0NTkwYWM2Njk3YWFkNGI3MzNmOTdiMQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-10-16T11:06:14Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-10-16T11:06:14Z"}, "message": "revert: ipa-icf-gimple.c (func_checker::compare_operand): Compare only empty constructors.\n\n\n\tRevert:\n\t* ipa-icf-gimple.c (func_checker::compare_operand): Compare only\n\tempty constructors.\n\t* gcc.c-torture/compile/icfmatch.c: Add testcase\n\nFrom-SVN: r228875", "tree": {"sha": "4f5c15c33de7664bca1119c3bf2def546cfdd1a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f5c15c33de7664bca1119c3bf2def546cfdd1a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d244704f731efd9c4590ac6697aad4b733f97b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d244704f731efd9c4590ac6697aad4b733f97b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d244704f731efd9c4590ac6697aad4b733f97b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d244704f731efd9c4590ac6697aad4b733f97b1/comments", "author": null, "committer": null, "parents": [{"sha": "535a86378ea5182125321ceede077e3781973f0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/535a86378ea5182125321ceede077e3781973f0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/535a86378ea5182125321ceede077e3781973f0a"}], "stats": {"total": 38, "additions": 35, "deletions": 3}, "files": [{"sha": "9c9cc65cb9874be92a45eba7ff89512f5b40ef91", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6d244704f731efd9c4590ac6697aad4b733f97b1", "patch": "@@ -1,3 +1,9 @@\n+2015-10-11  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tRevert:\n+\t* ipa-icf-gimple.c (func_checker::compare_operand): Compare only\n+\tempty constructors.\n+\n 2015-10-16  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* tree.c (recompute_tree_invariant_for_addr_expr): Assert that the"}, {"sha": "4696c803617b4ea81c6f26352553fae2b3bd2bbd", "filename": "gcc/ipa-icf-gimple.c", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2Fipa-icf-gimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2Fipa-icf-gimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-icf-gimple.c?ref=6d244704f731efd9c4590ac6697aad4b733f97b1", "patch": "@@ -415,9 +415,20 @@ func_checker::compare_operand (tree t1, tree t2)\n   switch (TREE_CODE (t1))\n     {\n     case CONSTRUCTOR:\n-      gcc_assert (!vec_safe_length (CONSTRUCTOR_ELTS (t1))\n-\t\t  && !vec_safe_length (CONSTRUCTOR_ELTS (t2)));\n-      return true;\n+      {\n+\tunsigned length1 = vec_safe_length (CONSTRUCTOR_ELTS (t1));\n+\tunsigned length2 = vec_safe_length (CONSTRUCTOR_ELTS (t2));\n+\n+\tif (length1 != length2)\n+\t  return return_false ();\n+\n+\tfor (unsigned i = 0; i < length1; i++)\n+\t  if (!compare_operand (CONSTRUCTOR_ELT (t1, i)->value,\n+\t\t\t\tCONSTRUCTOR_ELT (t2, i)->value))\n+\t    return return_false();\n+\n+\treturn true;\n+      }\n     case ARRAY_REF:\n     case ARRAY_RANGE_REF:\n       /* First argument is the array, second is the index.  */"}, {"sha": "3d5ad170ac93660f6745788cb6f5b98dc0b2038c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6d244704f731efd9c4590ac6697aad4b733f97b1", "patch": "@@ -1,3 +1,7 @@\n+2015-10-11  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* gcc.c-torture/compile/icfmatch.c: Add testcase\n+\n 2015-10-16  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/67926"}, {"sha": "13aad2e17abb89b0ab1170b186d2919e3ac9f4a6", "filename": "gcc/testsuite/gcc.c-torture/compile/icfmatch.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Ficfmatch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d244704f731efd9c4590ac6697aad4b733f97b1/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Ficfmatch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Ficfmatch.c?ref=6d244704f731efd9c4590ac6697aad4b733f97b1", "patch": "@@ -0,0 +1,11 @@\n+typedef char __attribute__ ((vector_size (4))) v4qi;\n+void retv (int a,int b,int c,int d, v4qi *ret)\n+{\n+  v4qi v = { a, b , c, d };\n+  *ret = v;\n+}\n+void retv2 (int a,int b,int c,int d, v4qi *ret)\n+{\n+  v4qi v = { a, b , c, d };\n+  *ret = v;\n+}"}]}