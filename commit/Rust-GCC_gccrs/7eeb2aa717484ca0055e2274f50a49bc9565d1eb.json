{"sha": "7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2VlYjJhYTcxNzQ4NGNhMDA1NWUyMjc0ZjUwYTQ5YmM5NTY1ZDFlYg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2012-01-21T14:58:33Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2012-01-21T14:58:33Z"}, "message": "re PR ada/46192 (wrong code for renaming of volatile packed array with address clause)\n\n\tPR ada/46192\n\t* gcc-interface/decl.c (gnat_to_gnu_entity) <object>: In the case of a\n\trenaming, preserve the volatileness through the indirection, if any.\n\nFrom-SVN: r183365", "tree": {"sha": "2ffb84bf4d4a6e8715c3955d4a047ef199311ac7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2ffb84bf4d4a6e8715c3955d4a047ef199311ac7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/comments", "author": null, "committer": null, "parents": [{"sha": "188229eb535a47b63c33dc12c71bf0575b44ce17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/188229eb535a47b63c33dc12c71bf0575b44ce17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/188229eb535a47b63c33dc12c71bf0575b44ce17"}], "stats": {"total": 53, "additions": 53, "deletions": 0}, "files": [{"sha": "a961439b0dff62a10443000632bbe02f156fddd6", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "patch": "@@ -1,3 +1,9 @@\n+2012-01-21  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\tPR ada/46192\n+\t* gcc-interface/decl.c (gnat_to_gnu_entity) <object>: In the case of a\n+\trenaming, preserve the volatileness through the indirection, if any.\n+\n 2012-01-14  Andreas Schwab  <schwab@linux-m68k.org>\n \n \t* gcc-interface/Makefile.in (OSCONS_EXTRACT): Add"}, {"sha": "9d81ade1fe1c63787390d4f17975b89122c61936", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "patch": "@@ -1051,6 +1051,14 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, int definition)\n \t\t   entity is always accessed indirectly through it.  */\n \t\telse\n \t\t  {\n+\t\t    /* We need to preserve the volatileness of the renamed\n+\t\t       object through the indirection.  */\n+\t\t    if (TREE_THIS_VOLATILE (gnu_expr)\n+\t\t\t&& !TYPE_VOLATILE (gnu_type))\n+\t\t      gnu_type\n+\t\t\t= build_qualified_type (gnu_type,\n+\t\t\t\t\t\t(TYPE_QUALS (gnu_type)\n+\t\t\t\t\t\t | TYPE_QUAL_VOLATILE));\n \t\t    gnu_type = build_reference_type (gnu_type);\n \t\t    inner_const_flag = TREE_READONLY (gnu_expr);\n \t\t    const_flag = true;"}, {"sha": "7d3d095905320b80be8d45641c1bf0af39d6ddc6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "patch": "@@ -1,3 +1,7 @@\n+2012-01-21  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/renaming5.ad[sb]: New test.\n+\n 2012-01-20  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/51919"}, {"sha": "25374fe895c9313d65cffcc3b6aac2da131575aa", "filename": "gcc/testsuite/gnat.dg/renaming5.adb", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Ftestsuite%2Fgnat.dg%2Frenaming5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Ftestsuite%2Fgnat.dg%2Frenaming5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Frenaming5.adb?ref=7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "patch": "@@ -0,0 +1,30 @@\n+-- PR ada/46192\n+-- Testcase by Rolf Ebert <rolf.ebert.gcc@gmx.de>\n+\n+-- { dg-do compile }\n+-- { dg-options \"-O2 -fdump-tree-optimized\" }\n+\n+with System; use System;\n+\n+package body Renaming5 is\n+\n+   type Bits_In_Byte is array (0 .. 7) of Boolean;\n+   pragma Pack (Bits_In_Byte);\n+\n+   A : Bits_In_Byte;\n+   for A'Address use System'To_Address(16#c0#);\n+   pragma Volatile (A);\n+\n+   B : Bits_In_Byte renames A;\n+\n+   procedure Proc is\n+   begin\n+      while B (0) = False loop\n+         null;\n+      end loop;\n+   end;\n+\n+end Renaming5;\n+\n+-- { dg-final { scan-tree-dump-times \"goto\" 2 \"optimized\" } }\n+-- { dg-final { cleanup-tree-dump \"optimized\" } }"}, {"sha": "2b39663ad42cd45b5afafb3b84ad0270bd254872", "filename": "gcc/testsuite/gnat.dg/renaming5.ads", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Ftestsuite%2Fgnat.dg%2Frenaming5.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7eeb2aa717484ca0055e2274f50a49bc9565d1eb/gcc%2Ftestsuite%2Fgnat.dg%2Frenaming5.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Frenaming5.ads?ref=7eeb2aa717484ca0055e2274f50a49bc9565d1eb", "patch": "@@ -0,0 +1,5 @@\n+package Renaming5 is\n+\n+   procedure Proc;\n+\n+end Renaming5;"}]}