{"sha": "af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWY3ODUxNGExOGNhNWM5YWFhMTA4MTNiYjRkYzYzOWQ3Y2NkZjBjYw==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2021-03-30T13:56:39Z"}, "committer": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2021-04-01T18:32:16Z"}, "message": "modules : Make sure we include <map> in system.h.\n\nIt appears that many targets include the map header transitively in\nother std headers included from system.h.  However there are some\neditions of clang/libc++ in Xcode that do not, which results in a\nbootstrap fail - since when resolver.h is included  there is then a\nconflict in declaring abort().\n\nThe fix is to ensure that map is pulled in by system.h and before\nresolver.h is included.  As a precautionary measure and to alert\nanyone perhaps adding another header to resolver.h this patch also\ngates the direct includes there on !IN_GCC.\n\nc++tools/ChangeLog:\n\n\t* resolver.h: Do not include std headers directly when\n\tbuilding in GCC.\n\ngcc/cp/ChangeLog:\n\n\t* mapper-client.cc (INCLUDE_MAP): New; require map to be\n\tincluded from system.h.\n\t* mapper-resolver.cc (INCLUDE_MAP): Likewise.", "tree": {"sha": "7bd4a70961432d96ca9aa4661fb70209d26f0229", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7bd4a70961432d96ca9aa4661fb70209d26f0229"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5f00df5925082c7b66da91270f2ed29bf4818c93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f00df5925082c7b66da91270f2ed29bf4818c93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f00df5925082c7b66da91270f2ed29bf4818c93"}], "stats": {"total": 4, "additions": 4, "deletions": 0}, "files": [{"sha": "a9547bf6994002351219f355534878a8360be5ef", "filename": "c++tools/resolver.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc/c%2B%2Btools%2Fresolver.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc/c%2B%2Btools%2Fresolver.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/c%2B%2Btools%2Fresolver.h?ref=af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc", "patch": "@@ -24,8 +24,10 @@ along with GCC; see the file COPYING3.  If not see\n // Mapper interface for client and server bits\n #include \"cody.hh\"\n // C++\n+#if !IN_GCC\n #include <string>\n #include <map>\n+#endif\n \n // This is a GCC class, so GCC coding conventions on new bits.  \n class module_resolver : public Cody::Resolver"}, {"sha": "b9e02168d550970054fbc54a94fc970196f6a78e", "filename": "gcc/cp/mapper-client.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc/gcc%2Fcp%2Fmapper-client.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc/gcc%2Fcp%2Fmapper-client.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmapper-client.cc?ref=af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc", "patch": "@@ -26,6 +26,7 @@ along with GCC; see the file COPYING3.  If not see\n #endif\n #define INCLUDE_STRING\n #define INCLUDE_VECTOR\n+#define INCLUDE_MAP\n #include \"system.h\"\n \n #include \"line-map.h\""}, {"sha": "db443fb4948c4c70adeb2bc1785d34fcf4ef975f", "filename": "gcc/cp/mapper-resolver.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc/gcc%2Fcp%2Fmapper-resolver.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc/gcc%2Fcp%2Fmapper-resolver.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmapper-resolver.cc?ref=af78514a18ca5c9aaa10813bb4dc639d7ccdf0cc", "patch": "@@ -24,6 +24,7 @@ along with GCC; see the file COPYING3.  If not see\n #define INCLUDE_STRING\n #define INCLUDE_VECTOR\n #define INCLUDE_ALGORITHM\n+#define INCLUDE_MAP\n #include \"system.h\"\n \n // We don't want or need to be aware of networking"}]}