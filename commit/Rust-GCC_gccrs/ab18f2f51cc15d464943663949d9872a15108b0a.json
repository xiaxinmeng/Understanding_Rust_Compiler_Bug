{"sha": "ab18f2f51cc15d464943663949d9872a15108b0a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWIxOGYyZjUxY2MxNWQ0NjQ5NDM2NjM5NDlkOTg3MmExNTEwOGIwYQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2014-04-02T20:27:29Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2014-04-02T20:27:29Z"}, "message": "libgomp: Fix default futex vs errno\n\n\t* config/linux/futex.h (futex_wait): Get error value from errno.\n\t(futex_wake): Likewise.\n\nFrom-SVN: r209035", "tree": {"sha": "47b819ab3c0e90f5bbb4ca4555eb28c8bbac83cb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/47b819ab3c0e90f5bbb4ca4555eb28c8bbac83cb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ab18f2f51cc15d464943663949d9872a15108b0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab18f2f51cc15d464943663949d9872a15108b0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab18f2f51cc15d464943663949d9872a15108b0a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab18f2f51cc15d464943663949d9872a15108b0a/comments", "author": null, "committer": null, "parents": [{"sha": "a19b0bfd981e19b07423c47d9cd014ddf8f1ff0b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a19b0bfd981e19b07423c47d9cd014ddf8f1ff0b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a19b0bfd981e19b07423c47d9cd014ddf8f1ff0b"}], "stats": {"total": 13, "additions": 9, "deletions": 4}, "files": [{"sha": "c0f093ff4581da792ead00b0f245e6d4765f55a3", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab18f2f51cc15d464943663949d9872a15108b0a/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab18f2f51cc15d464943663949d9872a15108b0a/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=ab18f2f51cc15d464943663949d9872a15108b0a", "patch": "@@ -1,3 +1,8 @@\n+2014-04-02  Richard Henderson  <rth@redhat.com>\n+\n+\t* config/linux/futex.h (futex_wait): Get error value from errno.\n+\t(futex_wake): Likewise.\n+\n 2014-03-25  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/60331"}, {"sha": "63334c7c916303022ba428b3d4f2b965d16cbd47", "filename": "libgomp/config/linux/futex.h", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab18f2f51cc15d464943663949d9872a15108b0a/libgomp%2Fconfig%2Flinux%2Ffutex.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab18f2f51cc15d464943663949d9872a15108b0a/libgomp%2Fconfig%2Flinux%2Ffutex.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfig%2Flinux%2Ffutex.h?ref=ab18f2f51cc15d464943663949d9872a15108b0a", "patch": "@@ -41,8 +41,8 @@\n static inline void\n futex_wait (int *addr, int val)\n {\n-  long err = syscall (SYS_futex, addr, gomp_futex_wait, val, NULL);\n-  if (__builtin_expect (err == -ENOSYS, 0))\n+  int err = syscall (SYS_futex, addr, gomp_futex_wait, val, NULL);\n+  if (__builtin_expect (err < 0 && errno == ENOSYS, 0))\n     {\n       gomp_futex_wait &= ~FUTEX_PRIVATE_FLAG;\n       gomp_futex_wake &= ~FUTEX_PRIVATE_FLAG;\n@@ -53,8 +53,8 @@ futex_wait (int *addr, int val)\n static inline void\n futex_wake (int *addr, int count)\n {\n-  long err = syscall (SYS_futex, addr, gomp_futex_wake, count);\n-  if (__builtin_expect (err == -ENOSYS, 0))\n+  int err = syscall (SYS_futex, addr, gomp_futex_wake, count);\n+  if (__builtin_expect (err < 0 && errno == ENOSYS, 0))\n     {\n       gomp_futex_wait &= ~FUTEX_PRIVATE_FLAG;\n       gomp_futex_wake &= ~FUTEX_PRIVATE_FLAG;"}]}