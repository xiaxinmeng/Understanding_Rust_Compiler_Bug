{"sha": "68df8e8c3438dda209c3ad9843933da640c9a71c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjhkZjhlOGMzNDM4ZGRhMjA5YzNhZDk4NDM5MzNkYTY0MGM5YTcxYw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-06-11T22:21:57Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-06-17T19:08:42Z"}, "message": "c++: Add test for C++20 NB comment CA107.\n\nWe already implemented this, but it's good to have a test.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/cpp2a/concepts-ca107.C: New test.", "tree": {"sha": "cb68b612d1c39c51ad4a15e858e662ecf8a2c07f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cb68b612d1c39c51ad4a15e858e662ecf8a2c07f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/68df8e8c3438dda209c3ad9843933da640c9a71c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68df8e8c3438dda209c3ad9843933da640c9a71c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68df8e8c3438dda209c3ad9843933da640c9a71c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68df8e8c3438dda209c3ad9843933da640c9a71c/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "14c831f5ef614aabb6a8c85712fb166600e6cc05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14c831f5ef614aabb6a8c85712fb166600e6cc05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14c831f5ef614aabb6a8c85712fb166600e6cc05"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "e18280a04bcd0325ab1cea5049675104d2f17419", "filename": "gcc/testsuite/g++.dg/cpp2a/concepts-ca107.C", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68df8e8c3438dda209c3ad9843933da640c9a71c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-ca107.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68df8e8c3438dda209c3ad9843933da640c9a71c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-ca107.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-ca107.C?ref=68df8e8c3438dda209c3ad9843933da640c9a71c", "patch": "@@ -0,0 +1,33 @@\n+// NB comments CA107/US117\n+// { dg-do compile { target concepts } }\n+\n+template <unsigned N> constexpr bool Atomic = true;\n+template <unsigned N> concept C = Atomic<N>;\n+template <unsigned N> concept Add1 = C<N + 1>;\n+template <unsigned N> concept AddOne = C<N + 1>;\n+template <unsigned M> void f()\n+  requires Add1<2 * M>;\n+template <unsigned M> int f()\n+  requires AddOne<2 * M> && true;\n+\n+int x = f<0>(); // OK, the atomic constraints from concept C in both fs are Atomic<N>\n+\t\t// with mapping similar to N -> 2 * M + 1\n+\n+template <unsigned N> struct WrapN;\n+template <unsigned N> using Add1Ty = WrapN<N + 1>;\n+template <unsigned N> using AddOneTy = WrapN<N + 1>;\n+template <unsigned M> void g(Add1Ty<2 * M> *);\n+template <unsigned M> void g(AddOneTy<2 * M> *);\n+\n+void h() {\n+  g<0>(nullptr); // OK, there is only one g\n+}\n+template <unsigned N> void f2()\n+  requires Add1<2 * N>;\n+template <unsigned N> int f2()\n+  requires Add1<N * 2> && true;\n+void h2() {\n+  f2<0>(); // { dg-error \"ambiguous\" } ill-formed, no diagnostic required:\n+\t   // required determination of subsumption between atomic constraints that are\n+\t   // functionally equivalent but not equivalent\n+}"}]}