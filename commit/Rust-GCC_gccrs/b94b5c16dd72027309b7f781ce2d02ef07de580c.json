{"sha": "b94b5c16dd72027309b7f781ce2d02ef07de580c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yjk0YjVjMTZkZDcyMDI3MzA5YjdmNzgxY2UyZDAyZWYwN2RlNTgwYw==", "commit": {"author": {"name": "Jeffrey A Law", "email": "law@cygnus.com", "date": "1998-02-25T22:39:34Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-02-25T22:39:34Z"}, "message": "i386.c (struct machine_function): Add new fields for PIC stuff.\n\n        * i386.c (struct machine_function): Add new fields for PIC stuff.\n        (save_386_machine_status): Fix argument to xmalloc.  Save pic_label_rtx\n        and pic_label_name.\n        (restore_386_machine_status): Corresponding changes.\n        (clear_386_stack_locals): Also clear pic_label_rtx and pic_label_name.\n\nFrom-SVN: r18237", "tree": {"sha": "68c9c31483dbdc53e668328608977cd9d912f18d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/68c9c31483dbdc53e668328608977cd9d912f18d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b94b5c16dd72027309b7f781ce2d02ef07de580c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b94b5c16dd72027309b7f781ce2d02ef07de580c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b94b5c16dd72027309b7f781ce2d02ef07de580c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b94b5c16dd72027309b7f781ce2d02ef07de580c/comments", "author": null, "committer": null, "parents": [{"sha": "9b899da08768c47b59bda184944eb2296515f719", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b899da08768c47b59bda184944eb2296515f719", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b899da08768c47b59bda184944eb2296515f719"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "435e37c24d984025928781845a7870a9689bc4f2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b94b5c16dd72027309b7f781ce2d02ef07de580c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b94b5c16dd72027309b7f781ce2d02ef07de580c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b94b5c16dd72027309b7f781ce2d02ef07de580c", "patch": "@@ -1,3 +1,11 @@\n+Wed Feb 25 23:40:54 1998  Jeffrey A Law  (law@cygnus.com)\n+\n+\t* i386.c (struct machine_function): Add new fields for PIC stuff.\n+\t(save_386_machine_status): Fix argument to xmalloc.  Save pic_label_rtx\n+\tand pic_label_name.\n+\t(restore_386_machine_status): Corresponding changes.\n+\t(clear_386_stack_locals): Also clear pic_label_rtx and pic_label_name.\n+\n Wed Feb 25 01:31:40 1998  Jeffrey A Law  (law@cygnus.com)\n \n \t* c-parse.y (undeclared variable error): Tweak error message"}, {"sha": "1ca072a4c886e042a260d5ad7e327efb2ee8c294", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b94b5c16dd72027309b7f781ce2d02ef07de580c/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b94b5c16dd72027309b7f781ce2d02ef07de580c/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=b94b5c16dd72027309b7f781ce2d02ef07de580c", "patch": "@@ -4185,6 +4185,8 @@ static rtx i386_stack_locals[(int) MAX_MACHINE_MODE][MAX_386_STACK_LOCALS];\n struct machine_function\n {\n   rtx i386_stack_locals[(int) MAX_MACHINE_MODE][MAX_386_STACK_LOCALS];\n+  rtx pic_label_rtx;\n+  char pic_label_name[256];\n };\n \n /* Functions to save and restore i386_stack_locals.\n@@ -4195,9 +4197,12 @@ void\n save_386_machine_status (p)\n      struct function *p;\n {\n-  p->machine = (struct machine_function *) xmalloc (sizeof i386_stack_locals);\n+  p->machine\n+    = (struct machine_function *) xmalloc (sizeof (struct machine_function));\n   bcopy ((char *) i386_stack_locals, (char *) p->machine->i386_stack_locals,\n \t sizeof i386_stack_locals);\n+  p->machine->pic_label_rtx = pic_label_rtx;\n+  bcopy (pic_label_name, p->machine->pic_label_name, 256);\n }\n \n void\n@@ -4206,7 +4211,10 @@ restore_386_machine_status (p)\n {\n   bcopy ((char *) p->machine->i386_stack_locals, (char *) i386_stack_locals,\n \t sizeof i386_stack_locals);\n+  pic_label_rtx = p->machine->pic_label_rtx;\n+  bcopy (p->machine->pic_label_name, pic_label_name, 256);\n   free (p->machine);\n+  p->machine = NULL;\n }\n \n /* Clear stack slot assignments remembered from previous functions.\n@@ -4224,6 +4232,8 @@ clear_386_stack_locals ()\n     for (n = 0; n < MAX_386_STACK_LOCALS; n++)\n       i386_stack_locals[(int) mode][n] = NULL_RTX;\n \n+  pic_label_rtx = NULL_RTX;\n+  bzero (pic_label_name, 256);\n   /* Arrange to save and restore i386_stack_locals around nested functions.  */\n   save_machine_status = save_386_machine_status;\n   restore_machine_status = restore_386_machine_status;"}]}