{"sha": "0f38b8114265421f93d37b835f1eb509c0f46247", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGYzOGI4MTE0MjY1NDIxZjkzZDM3YjgzNWYxZWI1MDljMGY0NjI0Nw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2001-06-08T22:33:46Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2001-06-08T22:33:46Z"}, "message": "c-decl.c (grokdeclarator): Make the TREE_TYPE for declarations accurately reflect its cv-qualification.\n\n\t* c-decl.c (grokdeclarator): Make the TREE_TYPE for declarations\n\taccurately reflect its cv-qualification.\n\t* c-typeck.c (type_lists_compatible_p): Ignore the top-levl\n\tcv-qualifiers on function types.\n\nFrom-SVN: r43056", "tree": {"sha": "d8ba494b63c0ae629f01eb15a7a2029026736c14", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8ba494b63c0ae629f01eb15a7a2029026736c14"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0f38b8114265421f93d37b835f1eb509c0f46247", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f38b8114265421f93d37b835f1eb509c0f46247", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f38b8114265421f93d37b835f1eb509c0f46247", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f38b8114265421f93d37b835f1eb509c0f46247/comments", "author": null, "committer": null, "parents": [{"sha": "e6be21fe8783be5abd5c15b74b9be457a3095ec9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e6be21fe8783be5abd5c15b74b9be457a3095ec9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e6be21fe8783be5abd5c15b74b9be457a3095ec9"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "7fcaca4e39c0e07d5b00cac549766ca73e99dd47", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0f38b8114265421f93d37b835f1eb509c0f46247", "patch": "@@ -1,3 +1,10 @@\n+2001-06-08  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* c-decl.c (grokdeclarator): Make the TREE_TYPE for declarations\n+\taccurately reflect its cv-qualification.\n+\t* c-typeck.c (type_lists_compatible_p): Ignore the top-levl\n+\tcv-qualifiers on function types.\n+\n 2001-06-08  Mark Mitchell  <mark@codesourcery.com>\n \n \t* basic-block.h: Improve comments."}, {"sha": "78c852e214f7de49bfdcbf8fb12be8410fe00091", "filename": "gcc/c-decl.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=0f38b8114265421f93d37b835f1eb509c0f46247", "patch": "@@ -4719,7 +4719,7 @@ grokdeclarator (declarator, declspecs, decl_context, initialized)\n \n     if (decl_context == PARM)\n       {\n-\ttree type_as_written = type;\n+\ttree type_as_written;\n \ttree promoted_type;\n \n \t/* A parameter declared as an array of T is really a pointer to T.\n@@ -4782,6 +4782,10 @@ grokdeclarator (declarator, declspecs, decl_context, initialized)\n \t    type = build_pointer_type (type);\n \t    type_quals = TYPE_UNQUALIFIED;\n \t  }\n+\telse if (type_quals)\n+\t  type = c_build_qualified_type (type, type_quals);\n+\t  \n+\ttype_as_written = type;\n \n \tdecl = build_decl (PARM_DECL, declarator, type);\n \tif (size_varies)\n@@ -4908,7 +4912,9 @@ grokdeclarator (declarator, declspecs, decl_context, initialized)\n \t    type_quals = TYPE_UNQUALIFIED;\n #endif\n \t  }\n-\n+\telse if (type_quals)\n+\t  type = c_build_qualified_type (type, type_quals);\n+\t  \n \tdecl = build_decl (VAR_DECL, declarator, type);\n \tif (size_varies)\n \t  C_DECL_VARIABLE_SIZE (decl) = 1;"}, {"sha": "5653ae59b68319a81ddc1479d6a185fa053c5b06", "filename": "gcc/c-typeck.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-typeck.c?ref=0f38b8114265421f93d37b835f1eb509c0f46247", "patch": "@@ -651,7 +651,8 @@ type_lists_compatible_p (args1, args2)\n \t  if (simple_type_promotes_to (TREE_VALUE (args1)) != NULL_TREE)\n \t    return 0;\n \t}\n-      else if (! (newval = comptypes (TREE_VALUE (args1), TREE_VALUE (args2))))\n+      else if (! (newval = comptypes (TYPE_MAIN_VARIANT (TREE_VALUE (args1)), \n+\t\t\t\t      TYPE_MAIN_VARIANT (TREE_VALUE (args2)))))\n \t{\n \t  /* Allow  wait (union {union wait *u; int *i} *)\n \t     and  wait (union wait *)  to be compatible.  */"}, {"sha": "de00be5af8865e311da0b3520a61bbc239526a19", "filename": "gcc/testsuite/gcc.c-torture/compile/920729-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F920729-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F920729-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F920729-1.c?ref=0f38b8114265421f93d37b835f1eb509c0f46247", "patch": "@@ -1,2 +1,2 @@\n-extern int i;extern volatile int i;\n+extern volatile int i;\n f(){int j;for(;;)j = i;}"}, {"sha": "01b6050bf3531933a866512f2f37812223c69754", "filename": "gcc/testsuite/gcc.c-torture/execute/931018-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F931018-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F931018-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F931018-1.c?ref=0f38b8114265421f93d37b835f1eb509c0f46247", "patch": "@@ -1,5 +1,5 @@\n unsigned int a[0x1000];\n-extern unsigned long v;\n+extern const unsigned long v;\n \n main ()\n {"}, {"sha": "f4db95013e2c1d8273cb6986071c9a08628351bd", "filename": "gcc/testsuite/gcc.dg/noncompile/redecl-1.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Ftestsuite%2Fgcc.dg%2Fnoncompile%2Fredecl-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f38b8114265421f93d37b835f1eb509c0f46247/gcc%2Ftestsuite%2Fgcc.dg%2Fnoncompile%2Fredecl-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fnoncompile%2Fredecl-1.c?ref=0f38b8114265421f93d37b835f1eb509c0f46247", "patch": "@@ -4,7 +4,7 @@\n int\n foo ()\n {\n-  int bar; /* { dg-error \"previously declared\" \"previously declared\" } */\n-  volatile int bar; /* { dg-error \"redeclaration\" \"redeclaration\" } */\n+  int bar; /* { dg-error \"previous.*decl\" \"previous.*decl\" } */\n+  volatile int bar; /* { dg-error \"conflicting types\" \"conflicting types\" } */\n }\n "}]}