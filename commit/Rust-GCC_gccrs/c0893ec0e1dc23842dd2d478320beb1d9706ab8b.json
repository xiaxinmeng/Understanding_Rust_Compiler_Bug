{"sha": "c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzA4OTNlYzBlMWRjMjM4NDJkZDJkNDc4MzIwYmViMWQ5NzA2YWI4Yg==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@gmail.com", "date": "2007-01-01T22:19:58Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2007-01-01T22:19:58Z"}, "message": "re PR middle-end/30253 (ICE with statement expression inside a conditional)\n\n2007-01-01  Andrew Pinski  <pinskia@gmail.com>\n\n        PR middle-end/30253\n        * gimplify (voidify_wrapper_expr): Update for\n        GIMPLIFY_MODIFY_STMT.\n\n2007-01-01  Andrew Pinski  <pinskia@gmail.com>\n\n        PR middle-end/30253\n        * gcc.c-torture/compile/statement-expression-1.c: New test.\n\nFrom-SVN: r120321", "tree": {"sha": "554942a234b954c8aa9774f91a3ce4a6b0964af4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/554942a234b954c8aa9774f91a3ce4a6b0964af4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/comments", "author": {"login": "pinskia", "id": 8496799, "node_id": "MDQ6VXNlcjg0OTY3OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8496799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pinskia", "html_url": "https://github.com/pinskia", "followers_url": "https://api.github.com/users/pinskia/followers", "following_url": "https://api.github.com/users/pinskia/following{/other_user}", "gists_url": "https://api.github.com/users/pinskia/gists{/gist_id}", "starred_url": "https://api.github.com/users/pinskia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pinskia/subscriptions", "organizations_url": "https://api.github.com/users/pinskia/orgs", "repos_url": "https://api.github.com/users/pinskia/repos", "events_url": "https://api.github.com/users/pinskia/events{/privacy}", "received_events_url": "https://api.github.com/users/pinskia/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ae1e2d4caa59a9e9f654d55dc59538c1056ee522", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae1e2d4caa59a9e9f654d55dc59538c1056ee522", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae1e2d4caa59a9e9f654d55dc59538c1056ee522"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "55ae03bf3a1f4b066efe9e4dafd3676afe5f1d5d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "patch": "@@ -1,3 +1,9 @@\n+2007-01-01  Andrew Pinski  <pinskia@gmail.com>\n+\n+\tPR middle-end/30253\n+\t* gimplify (voidify_wrapper_expr): Update for\n+\tGIMPLIFY_MODIFY_STMT.\n+\n 2007-01-01  Andreas Schwab  <schwab@suse.de>\n \n \tPR target/29166"}, {"sha": "01772bd5b02414ce42c6fe7ce7b73525853ad18d", "filename": "gcc/gimplify.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "patch": "@@ -1014,8 +1014,9 @@ voidify_wrapper_expr (tree wrapper, tree temp)\n \t  /* The wrapper is on the RHS of an assignment that we're pushing\n \t     down.  */\n \t  gcc_assert (TREE_CODE (temp) == INIT_EXPR\n+\t\t      || TREE_CODE (temp) == GIMPLIFY_MODIFY_STMT\n \t\t      || TREE_CODE (temp) == MODIFY_EXPR);\n-\t  TREE_OPERAND (temp, 1) = *p;\n+\t  GENERIC_TREE_OPERAND (temp, 1) = *p;\n \t  *p = temp;\n \t}\n       else"}, {"sha": "ea08e48e4921c080ec6d4c9c7d90e79c563c92cc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "patch": "@@ -1,3 +1,8 @@\n+2007-01-01  Andrew Pinski  <pinskia@gmail.com>\n+\n+\tPR middle-end/30253\n+\t* gcc.c-torture/compile/statement-expression-1.c: New test.\n+\n 2007-01-01  Andreas Schwab  <schwab@suse.de>\n \n \tPR target/29166"}, {"sha": "fb4860256ad92d36be29de8834dfdc1c7e8d2a1a", "filename": "gcc/testsuite/gcc.c-torture/compile/statement-expression-1.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fstatement-expression-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0893ec0e1dc23842dd2d478320beb1d9706ab8b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fstatement-expression-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fstatement-expression-1.c?ref=c0893ec0e1dc23842dd2d478320beb1d9706ab8b", "patch": "@@ -0,0 +1,10 @@\n+/* PR middle-end/30253, We would ICE with statement expressions\n+   in a conditional expression because we forgot to update the wrapper\n+   function for the gimple modify statement.  */\n+\n+#define f(x) ({ unsigned tmp=x; tmp; })\n+\n+unsigned foo(unsigned x) {\n+  return __builtin_constant_p(x) ? 0 : f(x);\n+}\n+"}]}