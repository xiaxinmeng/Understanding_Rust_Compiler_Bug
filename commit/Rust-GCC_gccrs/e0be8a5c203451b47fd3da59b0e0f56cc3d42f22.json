{"sha": "e0be8a5c203451b47fd3da59b0e0f56cc3d42f22", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTBiZThhNWMyMDM0NTFiNDdmZDNkYTU5YjBlMGY1NmNjM2Q0MmYyMg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-03-30T21:10:32Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-03-30T21:10:32Z"}, "message": "syscall: Convert errno to error after Exitsyscall.\n\nFrom-SVN: r186020", "tree": {"sha": "6b2c9662a2b212b86192a8ef1a2d7ac29c33eeb6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6b2c9662a2b212b86192a8ef1a2d7ac29c33eeb6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e0be8a5c203451b47fd3da59b0e0f56cc3d42f22", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0be8a5c203451b47fd3da59b0e0f56cc3d42f22", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0be8a5c203451b47fd3da59b0e0f56cc3d42f22", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0be8a5c203451b47fd3da59b0e0f56cc3d42f22/comments", "author": null, "committer": null, "parents": [{"sha": "a0d203b112059597603c9424e51f5cbb7b104009", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0d203b112059597603c9424e51f5cbb7b104009", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0d203b112059597603c9424e51f5cbb7b104009"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "b81796031ca01ae5f6cf9eea9910db25122b1582", "filename": "libgo/go/syscall/mksyscall.awk", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0be8a5c203451b47fd3da59b0e0f56cc3d42f22/libgo%2Fgo%2Fsyscall%2Fmksyscall.awk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0be8a5c203451b47fd3da59b0e0f56cc3d42f22/libgo%2Fgo%2Fsyscall%2Fmksyscall.awk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fsyscall%2Fmksyscall.awk?ref=e0be8a5c203451b47fd3da59b0e0f56cc3d42f22", "patch": "@@ -199,6 +199,7 @@ BEGIN {\n     }\n     printf(\"c_%s(%s)\\n\", cfnname, args)\n \n+    seterr = 0\n     if (gofnresults != \"\") {\n \tfields = split(gofnresults, goresults, \", *\")\n \tif (fields > 2) {\n@@ -218,13 +219,17 @@ BEGIN {\n \t    gotype = goparam[2]\n \n \t    if (goname == \"err\") {\n+\t\tprint \"\\tvar errno Errno\"\n+\t\tprint \"\\tsetErrno := false\"\n \t\tif (cfnresult ~ /^\\*/) {\n \t\t    print \"\\tif _r == nil {\"\n \t\t} else {\n \t\t    print \"\\tif _r < 0 {\"\n \t\t}\n-\t\tprint \"\\t\\terr = GetErrno()\"\n+\t\tprint \"\\t\\terrno = GetErrno()\"\n+\t\tprint \"\\t\\tsetErrno = true\"\n \t\tprint \"\\t}\"\n+\t\tseterr = 1\n \t    } else if (gotype == \"uintptr\" && cfnresult ~ /^\\*/) {\n \t\tprintf(\"\\t%s = (%s)(unsafe.Pointer(_r))\\n\", goname, gotype)\n \t    } else {\n@@ -243,6 +248,12 @@ BEGIN {\n \tprint \"\\tExitsyscall()\"\n     }\n \n+    if (seterr) {\n+\tprint \"\\tif setErrno {\"\n+\tprint \"\\t\\terr = errno\"\n+\tprint \"\\t}\"\n+    }\n+\n     if (gofnresults != \"\") {\n \tprint \"\\treturn\"\n     }"}]}