{"sha": "743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzQzZWU5ZDVmZTUxZWNhYjg4NjZjZGYxYmY2NzQyNDQ1N2FlZWEwYw==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2018-03-02T17:55:28Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2018-03-02T17:55:28Z"}, "message": "re PR c++/84664 (internal compiler error: in cp_perform_integral_promotions, at cp/typeck.c:2172)\n\n\tPR c++/84664\n\t* typeck.c (cp_perform_integral_promotions): Check the result of\n\tmark_rvalue_use.\n\n\t* g++.dg/cpp0x/lambda/lambda-ice28.C: New test.\n\nFrom-SVN: r258149", "tree": {"sha": "f0f14edfd5a86569d2157afb0d0aa8ce58c9c42e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f0f14edfd5a86569d2157afb0d0aa8ce58c9c42e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8c8f2ab7081d2e14b637c57583072392c3aeac88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c8f2ab7081d2e14b637c57583072392c3aeac88", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c8f2ab7081d2e14b637c57583072392c3aeac88"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "112e13a967264b8832d55c74811728bfceed57e5", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "patch": "@@ -3,6 +3,10 @@\n \tPR c++/84663\n \t* decl.c (cp_complete_array_type): Check error_mark_node.\n \n+\tPR c++/84664\n+\t* typeck.c (cp_perform_integral_promotions): Check the result of\n+\tmark_rvalue_use.\n+\n 2018-03-02  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/84662"}, {"sha": "f535902231d5ccdfa9dbb19674d6fbdf056e1430", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "patch": "@@ -2161,6 +2161,8 @@ cp_perform_integral_promotions (tree expr, tsubst_flags_t complain)\n   tree promoted_type;\n \n   expr = mark_rvalue_use (expr);\n+  if (error_operand_p (expr))\n+    return error_mark_node;\n \n   /* [conv.prom]\n "}, {"sha": "670d388b88459247f79411a5ce2eb5535eaaed4e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "patch": "@@ -6,6 +6,9 @@\n \tPR c++/84663\n \t* g++.dg/parse/array-size3.C: New test.\n \n+\tPR c++/84664\n+\t* g++.dg/cpp0x/lambda/lambda-ice28.C: New test.\n+\n 2018-03-02  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/84662"}, {"sha": "5fe3212974402ad0002fc0bd6c8c0125db0c1297", "filename": "gcc/testsuite/g++.dg/cpp0x/lambda/lambda-ice28.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice28.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/743ee9d5fe51ecab8866cdf1bf67424457aeea0c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice28.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice28.C?ref=743ee9d5fe51ecab8866cdf1bf67424457aeea0c", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/84664\n+// { dg-do compile { target c++11 } }\n+\n+void\n+foo ()\n+{\n+  auto &b = 1; // { dg-error \"cannot bind\" }\n+  [] { b > 0; }; // { dg-error \".b. is not captured\" }\n+}"}]}