{"sha": "088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDg4YzJjOGQzNzE3NTA1NGZkMGFmNWI1ODczNGExZmJmNmVjZWJkMQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2013-02-06T10:08:09Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2013-02-06T10:08:09Z"}, "message": "[multiple changes]\n\n2013-02-06  Robert Dewar  <dewar@adacore.com>\n\n\t* s-dim.ads, clean.adb: Minor reformatting.\n\n2013-02-06  Javier Miranda  <miranda@adacore.com>\n\n\t* sem_ch6.adb (Analyze_Subprogram_Body_Helper): Undo previous patch.\n\t(Can_Split_Unconstrained_Function): Only split the inlined function if\n\tthe compiler generates the code of its body.\n\nFrom-SVN: r195789", "tree": {"sha": "733480948945834a1fdc67db1c37ea5a489c0fd7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/733480948945834a1fdc67db1c37ea5a489c0fd7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/comments", "author": null, "committer": null, "parents": [{"sha": "3860d46902591cda6423d375dd44975dec8bc6ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3860d46902591cda6423d375dd44975dec8bc6ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3860d46902591cda6423d375dd44975dec8bc6ea"}], "stats": {"total": 34, "additions": 22, "deletions": 12}, "files": [{"sha": "309f7e7c4fb9d467a6df25c727cb7f406f3437bb", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "patch": "@@ -1,3 +1,13 @@\n+2013-02-06  Robert Dewar  <dewar@adacore.com>\n+\n+\t* s-dim.ads, clean.adb: Minor reformatting.\n+\n+2013-02-06  Javier Miranda  <miranda@adacore.com>\n+\n+\t* sem_ch6.adb (Analyze_Subprogram_Body_Helper): Undo previous patch.\n+\t(Can_Split_Unconstrained_Function): Only split the inlined function if\n+\tthe compiler generates the code of its body.\n+\n 2013-02-06  Robert Dewar  <dewar@adacore.com>\n \n \t* exp_prag.adb, sem_ch3.adb, exp_attr.adb, sem_prag.adb, sem_ch6.adb,"}, {"sha": "9d9c4d457df10f0ad71e57321b6ecd201ef67ee2", "filename": "gcc/ada/clean.adb", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2Fclean.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2Fclean.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fclean.adb?ref=088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "patch": "@@ -1261,10 +1261,8 @@ package body Clean is\n                     or else Host_Full_Name'Length = 0\n                   then\n                      Success := False;\n-\n                   else\n-                     Delete_File\n-                       (Host_Full_Name.all & \";*\", Success);\n+                     Delete_File (Host_Full_Name.all & \";*\", Success);\n                   end if;\n                end;\n "}, {"sha": "f4b10030a1f575a2a1daf672220bb797eeb2b797", "filename": "gcc/ada/s-dim.ads", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2Fs-dim.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2Fs-dim.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-dim.ads?ref=088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---             Copyright (C) 2012, Free Software Foundation, Inc.           --\n+--          Copyright (C) 2012-2013, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --"}, {"sha": "728e4a7a8d7bef3beb1cc49d02982aef404edbea", "filename": "gcc/ada/sem_ch6.adb", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2Fsem_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/088c2c8d37175054fd0af5b58734a1fbf6ecebd1/gcc%2Fada%2Fsem_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch6.adb?ref=088c2c8d37175054fd0af5b58734a1fbf6ecebd1", "patch": "@@ -2909,10 +2909,6 @@ package body Sem_Ch6 is\n         and then Serious_Errors_Detected = 0\n         and then Present (Spec_Id)\n         and then Has_Pragma_Inline (Spec_Id)\n-\n-        --  This test needs commenting ???\n-\n-        and then In_Extended_Main_Code_Unit (N)\n       then\n          Check_And_Build_Body_To_Inline (N, Spec_Id, Body_Id);\n       end if;\n@@ -4268,9 +4264,9 @@ package body Sem_Ch6 is\n       --  This body is subsequently used for inline expansions at call sites.\n \n       function Can_Split_Unconstrained_Function (N : Node_Id) return Boolean;\n-      --  Return true if the function body N has no local declarations and its\n-      --  unique statement is a single extended return statement with a handled\n-      --  statements sequence.\n+      --  Return true if we generate code for the function body N, the function\n+      --  body N has no local declarations and its unique statement is a single\n+      --  extended return statement with a handled statements sequence.\n \n       function Check_Body_To_Inline\n         (N    : Node_Id;\n@@ -5005,7 +5001,13 @@ package body Sem_Ch6 is\n             end loop;\n          end if;\n \n-         return Present (Ret_Node)\n+         --  We only split the inlined function when we are generating the code\n+         --  of its body; otherwise we leave duplicated split subprograms in\n+         --  the tree which (if referenced) generate wrong references at link\n+         --  time.\n+\n+         return In_Extended_Main_Code_Unit (N)\n+           and then Present (Ret_Node)\n            and then Nkind (Ret_Node) = N_Extended_Return_Statement\n            and then No (Next (Ret_Node))\n            and then Present (Handled_Statement_Sequence (Ret_Node));"}]}