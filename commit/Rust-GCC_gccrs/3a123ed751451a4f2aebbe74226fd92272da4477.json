{"sha": "3a123ed751451a4f2aebbe74226fd92272da4477", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2ExMjNlZDc1MTQ1MWE0ZjJhZWJiZTc0MjI2ZmQ5MjI3MmRhNDQ3Nw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-01-09T08:03:45Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-01-09T08:03:45Z"}, "message": "re PR target/83507 (ICE in internal_dfa_insn_code_* for powerpc targets)\n\n\tPR target/83507\n\t* modulo-sched.c (schedule_reg_moves): Punt if we'd need to move\n\thard registers.  Formatting fixes.\n\n\t* gcc.dg/sms-13.c: New test.\n\nFrom-SVN: r256368", "tree": {"sha": "48d8bdcdf51e28737bb09e301b3fc04ef341f348", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/48d8bdcdf51e28737bb09e301b3fc04ef341f348"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3a123ed751451a4f2aebbe74226fd92272da4477", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a123ed751451a4f2aebbe74226fd92272da4477", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a123ed751451a4f2aebbe74226fd92272da4477", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a123ed751451a4f2aebbe74226fd92272da4477/comments", "author": null, "committer": null, "parents": [{"sha": "5190f1f98d7c14c0a0bf4f003da0f3a38b31ad14", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5190f1f98d7c14c0a0bf4f003da0f3a38b31ad14", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5190f1f98d7c14c0a0bf4f003da0f3a38b31ad14"}], "stats": {"total": 52, "additions": 48, "deletions": 4}, "files": [{"sha": "084b0d7e7c81ffad0626b188bc22acc25496ea93", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3a123ed751451a4f2aebbe74226fd92272da4477", "patch": "@@ -1,5 +1,9 @@\n 2018-01-09  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR target/83507\n+\t* modulo-sched.c (schedule_reg_moves): Punt if we'd need to move\n+\thard registers.  Formatting fixes.\n+\n \tPR preprocessor/83722\n \t* gcc.c (try_generate_repro): Pass\n \t&temp_stderr_files[RETRY_ICE_ATTEMPTS - 1] rather than"}, {"sha": "9a27365bfbc4ee4934dd90e7ca86245c9b05bcfc", "filename": "gcc/modulo-sched.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2Fmodulo-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2Fmodulo-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmodulo-sched.c?ref=3a123ed751451a4f2aebbe74226fd92272da4477", "patch": "@@ -687,9 +687,9 @@ schedule_reg_moves (partial_schedule_ptr ps)\n       rtx set = single_set (u->insn);\n       \n       /* Skip instructions that do not set a register.  */\n-      if ((set && !REG_P (SET_DEST (set))))\n+      if (set && !REG_P (SET_DEST (set)))\n         continue;\n- \n+\n       /* Compute the number of reg_moves needed for u, by looking at life\n \t ranges started at u (excluding self-loops).  */\n       distances[0] = distances[1] = false;\n@@ -743,7 +743,10 @@ schedule_reg_moves (partial_schedule_ptr ps)\n       first_move += ps->g->num_nodes;\n \n       /* Generate each move.  */\n-      old_reg = prev_reg = SET_DEST (single_set (u->insn));\n+      old_reg = prev_reg = SET_DEST (set);\n+      if (HARD_REGISTER_P (old_reg))\n+\treturn false;\n+\n       for (i_reg_move = 0; i_reg_move < nreg_moves; i_reg_move++)\n \t{\n \t  ps_reg_move_info *move = ps_reg_move (ps, first_move + i_reg_move);"}, {"sha": "c73af5e087a71551f66ad2d1eb2c8660bca65371", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3a123ed751451a4f2aebbe74226fd92272da4477", "patch": "@@ -1,6 +1,11 @@\n+2018-01-09  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/83507\n+\t* gcc.dg/sms-13.c: New test.\n+\n 2018-01-08  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n-\tPR Fortran/83741\n+\tPR fortran/83741\n \t* gfortran.dg/allocate_assumed_charlen_3.f90: New test.\n \n 2018-01-08  Chih-Mao Chen <pkmx.tw@gmail.com>"}, {"sha": "cd7bb62006ce0424e8f94d19d1bee2cdf9eaaf5a", "filename": "gcc/testsuite/gcc.dg/sms-13.c", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2Ftestsuite%2Fgcc.dg%2Fsms-13.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a123ed751451a4f2aebbe74226fd92272da4477/gcc%2Ftestsuite%2Fgcc.dg%2Fsms-13.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fsms-13.c?ref=3a123ed751451a4f2aebbe74226fd92272da4477", "patch": "@@ -0,0 +1,32 @@\n+/* PR target/83507 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fmodulo-sched -fno-tree-ter -fno-tree-coalesce-vars\" } */\n+\n+void\n+foo (unsigned short int x, unsigned char y)\n+{\n+  unsigned char *a = &y;\n+  unsigned short int b;\n+  int c;\n+\n+  while (y < 3)\n+    {\n+      if (x != 0)\n+        ++y;\n+      ++y;\n+    }\n+\n+  for (c = 0; c < 5; ++c)\n+    {\n+      int d = 1;\n+      d += b > x;\n+      y &= d;\n+    }\n+\n+  do\n+    {\n+      c += y;\n+      x = c;\n+    }\n+  while (x != 0);\n+}"}]}