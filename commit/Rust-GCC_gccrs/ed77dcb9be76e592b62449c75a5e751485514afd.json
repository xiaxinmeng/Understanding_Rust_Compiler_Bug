{"sha": "ed77dcb9be76e592b62449c75a5e751485514afd", "node_id": "C_kwDOANBUbNoAKGVkNzdkY2I5YmU3NmU1OTJiNjI0NDljNzVhNWU3NTE0ODU1MTRhZmQ", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-11-21T11:52:34Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-11-21T17:46:42Z"}, "message": "libstdc++: Check static assertions earlier in chrono::duration\n\nThis ensures that we fail a static assertion before giving any other\nerrors. Instantiating chrono::duration<int, chrono::seconds> will now\nprint this before the other errors caused by it:\n\nerror: static assertion failed: period must be a specialization of ratio\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/bits/chrono.h (duration): Check preconditions on\n\ttemplate arguments before using them.", "tree": {"sha": "f3567c9e885b2c357173c2f3fc481eae0d70d5e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f3567c9e885b2c357173c2f3fc481eae0d70d5e2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ed77dcb9be76e592b62449c75a5e751485514afd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed77dcb9be76e592b62449c75a5e751485514afd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed77dcb9be76e592b62449c75a5e751485514afd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed77dcb9be76e592b62449c75a5e751485514afd/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94f7baf2194e2d20108c9d34d2766e6b14e25cef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94f7baf2194e2d20108c9d34d2766e6b14e25cef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94f7baf2194e2d20108c9d34d2766e6b14e25cef"}], "stats": {"total": 10, "additions": 5, "deletions": 5}, "files": [{"sha": "cabf61264d895d526dab7443c2b57ec1aa6b9096", "filename": "libstdc++-v3/include/bits/chrono.h", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed77dcb9be76e592b62449c75a5e751485514afd/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchrono.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed77dcb9be76e592b62449c75a5e751485514afd/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchrono.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchrono.h?ref=ed77dcb9be76e592b62449c75a5e751485514afd", "patch": "@@ -433,6 +433,11 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     template<typename _Rep, typename _Period>\n       struct duration\n       {\n+\tstatic_assert(!__is_duration<_Rep>::value, \"rep cannot be a duration\");\n+\tstatic_assert(__is_ratio<_Period>::value,\n+\t\t      \"period must be a specialization of ratio\");\n+\tstatic_assert(_Period::num > 0, \"period must be positive\");\n+\n       private:\n \ttemplate<typename _Rep2>\n \t  using __is_float = treat_as_floating_point<_Rep2>;\n@@ -478,11 +483,6 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \tusing rep = _Rep;\n \tusing period = typename _Period::type;\n \n-\tstatic_assert(!__is_duration<_Rep>::value, \"rep cannot be a duration\");\n-\tstatic_assert(__is_ratio<_Period>::value,\n-\t\t      \"period must be a specialization of ratio\");\n-\tstatic_assert(_Period::num > 0, \"period must be positive\");\n-\n \t// 20.11.5.1 construction / copy / destroy\n \tconstexpr duration() = default;\n "}]}