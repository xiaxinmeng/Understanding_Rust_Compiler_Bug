{"sha": "dfb15f6bbbe2264f8836c7cc9465784e3c3d1208", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGZiMTVmNmJiYmUyMjY0Zjg4MzZjN2NjOTQ2NTc4NGUzYzNkMTIwOA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2017-06-27T15:51:48Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2017-06-27T15:51:48Z"}, "message": "Show value of GOMP_OPENACC_DIM in libgomp nvptx plugin\n\n2017-06-27  Tom de Vries  <tom@codesourcery.com>\n\n\t* plugin/plugin-nvptx.c (notify_var): New function.\n\t(nvptx_exec): Use notify_var for GOMP_OPENACC_DIM.\n\nFrom-SVN: r249695", "tree": {"sha": "78c09041b2727762ad42dd004b9462aafd7c97f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/78c09041b2727762ad42dd004b9462aafd7c97f9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208/comments", "author": null, "committer": null, "parents": [{"sha": "22f1a03704bbb15cf766af822a17a41ac9f57121", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22f1a03704bbb15cf766af822a17a41ac9f57121", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22f1a03704bbb15cf766af822a17a41ac9f57121"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "0b5ee745dfb7bd4cbc9f979647fc74e496724b55", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=dfb15f6bbbe2264f8836c7cc9465784e3c3d1208", "patch": "@@ -1,3 +1,8 @@\n+2017-06-27  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* plugin/plugin-nvptx.c (notify_var): New function.\n+\t(nvptx_exec): Use notify_var for GOMP_OPENACC_DIM.\n+\n 2017-06-27  Tom de Vries  <tom@codesourcery.com>\n \n \t* env.c (parse_unsigned_long_1): Factor out of ..."}, {"sha": "71630b5735522d7f1c0f70cb1d70dd53ec174a87", "filename": "libgomp/plugin/plugin-nvptx.c", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208/libgomp%2Fplugin%2Fplugin-nvptx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb15f6bbbe2264f8836c7cc9465784e3c3d1208/libgomp%2Fplugin%2Fplugin-nvptx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fplugin%2Fplugin-nvptx.c?ref=dfb15f6bbbe2264f8836c7cc9465784e3c3d1208", "patch": "@@ -867,6 +867,14 @@ nvptx_get_num_devices (void)\n   return n;\n }\n \n+static void\n+notify_var (const char *var_name, const char *env_var)\n+{\n+  if (env_var == NULL)\n+    GOMP_PLUGIN_debug (0, \"%s: <Not defined>\\n\", var_name);\n+  else\n+    GOMP_PLUGIN_debug (0, \"%s: '%s'\\n\", var_name, env_var);\n+}\n \n static bool\n link_ptx (CUmodule *module, const struct targ_ptx_obj *ptx_objs,\n@@ -1089,10 +1097,12 @@ nvptx_exec (void (*fn), size_t mapnum, void **hostaddrs, void **devaddrs,\n       pthread_mutex_lock (&ptx_dev_lock);\n       if (!default_dims[0])\n \t{\n+\t  const char *var_name = \"GOMP_OPENACC_DIM\";\n \t  /* We only read the environment variable once.  You can't\n \t     change it in the middle of execution.  The syntax  is\n \t     the same as for the -fopenacc-dim compilation option.  */\n-\t  const char *env_var = getenv (\"GOMP_OPENACC_DIM\");\n+\t  const char *env_var = getenv (var_name);\n+\t  notify_var (var_name, env_var);\n \t  if (env_var)\n \t    {\n \t      const char *pos = env_var;"}]}