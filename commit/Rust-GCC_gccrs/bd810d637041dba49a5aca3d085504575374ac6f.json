{"sha": "bd810d637041dba49a5aca3d085504575374ac6f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQ4MTBkNjM3MDQxZGJhNDlhNWFjYTNkMDg1NTA0NTc1Mzc0YWM2Zg==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-12-16T14:32:46Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-12-16T14:32:46Z"}, "message": "PF fortran/88364\n\n2018-12-16  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPF fortran/88364\n\t* trans-expr.c (gfc_conv_expr_reference): Do not add clobber if\n\tthe expression contains a reference.\n\n2018-12-16  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/88363\n\t* intent_out_13.f90: New test.\n\nFrom-SVN: r267187", "tree": {"sha": "4868ee89550eb30c1ce252e1b8a88d610ba49a16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4868ee89550eb30c1ce252e1b8a88d610ba49a16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd810d637041dba49a5aca3d085504575374ac6f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd810d637041dba49a5aca3d085504575374ac6f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd810d637041dba49a5aca3d085504575374ac6f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd810d637041dba49a5aca3d085504575374ac6f/comments", "author": null, "committer": null, "parents": [{"sha": "57bfedaffecab6bef69de309fcf9516b78015de1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57bfedaffecab6bef69de309fcf9516b78015de1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57bfedaffecab6bef69de309fcf9516b78015de1"}], "stats": {"total": 37, "additions": 35, "deletions": 2}, "files": [{"sha": "7220c9cb5816973edf07270e4baf5734ac3c6dfc", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=bd810d637041dba49a5aca3d085504575374ac6f", "patch": "@@ -1,3 +1,9 @@\n+2018-12-16  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPF fortran/88364\n+\t* trans-expr.c (gfc_conv_expr_reference): Do not add clobber if\n+\tthe expression contains a reference.\n+\n 2018-12-15  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/87944\n@@ -9,7 +15,7 @@\n \tPR fortran/88138\n \t* decl.c (variable_decl): Check that a derived isn't being assigned\n \tan incompatible entity in an initialization.\n- \n+\n 2018-12-12  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR fortran/88463"}, {"sha": "16a713551f0a2e57a70f15dc23dea660ec0f030a", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=bd810d637041dba49a5aca3d085504575374ac6f", "patch": "@@ -8152,7 +8152,7 @@ gfc_conv_expr_reference (gfc_se * se, gfc_expr * expr, bool add_clobber)\n \t  gfc_add_block_to_block (&se->pre, &se->post);\n \t  se->expr = var;\n \t}\n-      else if (add_clobber)\n+      else if (add_clobber && expr->ref == NULL)\n \t{\n \t  tree clobber;\n \t  tree var;"}, {"sha": "f47385bb761bbda6aa88345b1ea6764460bb88ce", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bd810d637041dba49a5aca3d085504575374ac6f", "patch": "@@ -1,3 +1,8 @@\n+2018-12-16  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/88363\n+\t* intent_out_13.f90: New test.\n+\n 2018-12-15  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/88483"}, {"sha": "ebbc5b7e769eb941517ada5a28d0e7180dc86f15", "filename": "gcc/testsuite/gfortran.dg/intent_out_13.f90", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ftestsuite%2Fgfortran.dg%2Fintent_out_13.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd810d637041dba49a5aca3d085504575374ac6f/gcc%2Ftestsuite%2Fgfortran.dg%2Fintent_out_13.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fintent_out_13.f90?ref=bd810d637041dba49a5aca3d085504575374ac6f", "patch": "@@ -0,0 +1,22 @@\n+! { dg-do run }\n+! PR 88364 -- too much was clobbered on call.\n+module pr88364\n+  implicit none\n+  type t\n+    integer :: b = -1\n+    integer :: c = 2\n+  end type t\n+contains\n+  subroutine f1 (x)\n+    integer, intent(out) :: x\n+    x = 5\n+  end subroutine f1\n+  subroutine f2 ()\n+    type(t) :: x\n+    call f1 (x%b)\n+    if (x%b .ne. 5 .or. x%c .ne. 2) stop 1\n+  end subroutine f2\n+end module pr88364\n+  use pr88364\n+  call f2\n+end"}]}