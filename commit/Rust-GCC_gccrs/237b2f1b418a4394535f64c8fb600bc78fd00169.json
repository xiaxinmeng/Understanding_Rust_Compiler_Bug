{"sha": "237b2f1b418a4394535f64c8fb600bc78fd00169", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjM3YjJmMWI0MThhNDM5NDUzNWY2NGM4ZmI2MDBiYzc4ZmQwMDE2OQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-11-16T13:46:04Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-11-16T13:46:04Z"}, "message": "re PR fortran/33986 (ICE on allocatable function result)\n\n2007-11-16  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/33986\n\t* trans-array.c (gfc_conv_array_parameter ): Allow allocatable\n\tfunction results.\n\n2007-11-16  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/33986\n\t* gfortran.dg/allocatable_function_3.f90.\n\nFrom-SVN: r130228", "tree": {"sha": "563770a788519a9d38aa797dcf238ee78f9659cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/563770a788519a9d38aa797dcf238ee78f9659cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/237b2f1b418a4394535f64c8fb600bc78fd00169", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/237b2f1b418a4394535f64c8fb600bc78fd00169", "html_url": "https://github.com/Rust-GCC/gccrs/commit/237b2f1b418a4394535f64c8fb600bc78fd00169", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/237b2f1b418a4394535f64c8fb600bc78fd00169/comments", "author": null, "committer": null, "parents": [{"sha": "80941d6e88d6e48baf894859beba01bc9a572035", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80941d6e88d6e48baf894859beba01bc9a572035", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80941d6e88d6e48baf894859beba01bc9a572035"}], "stats": {"total": 40, "additions": 34, "deletions": 6}, "files": [{"sha": "776b6520212af25d8617976e60dd9b019da88f53", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=237b2f1b418a4394535f64c8fb600bc78fd00169", "patch": "@@ -1,9 +1,8 @@\n-2007-11-15  Tobias Burnus  <burnus@net-b.de>\n+2007-11-16  Paul Thomas  <pault@gcc.gnu.org>\n \n-\tPR fortran/33917\n-\t* decl.c (match_procedure_decl): Pre-resolve interface.\n-\t* resolve.c (resolve_symbol): Reject interfaces later\n-\tdeclared in procedure statements.\n+\tPR fortran/33986\n+\t* trans-array.c (gfc_conv_array_parameter ): Allow allocatable\n+\tfunction results.\n \n 2007-11-13  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n "}, {"sha": "c418ae2a61a5d55369a8e6c15da5fb0e013a5227", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=237b2f1b418a4394535f64c8fb600bc78fd00169", "patch": "@@ -5003,7 +5003,7 @@ gfc_conv_array_parameter (gfc_se * se, gfc_expr * expr, gfc_ss * ss, int g77)\n         }\n       if (sym->attr.allocatable)\n         {\n-\t  if (sym->attr.dummy)\n+\t  if (sym->attr.dummy || sym->attr.result)\n \t    {\n \t      gfc_conv_expr_descriptor (se, expr, ss);\n \t      se->expr = gfc_conv_array_data (se->expr);"}, {"sha": "49c708ce9e18d73a8f2a1a4945d20dc489165f78", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=237b2f1b418a4394535f64c8fb600bc78fd00169", "patch": "@@ -1,3 +1,8 @@\n+2007-11-16  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/33986\n+\t* gfortran.dg/allocatable_function_3.f90.\n+\n 2007-11-16  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/34113"}, {"sha": "538924f6719519571b276ffd1b0899f7136b2b1f", "filename": "gcc/testsuite/gfortran.dg/allocatable_function_3.f90", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ftestsuite%2Fgfortran.dg%2Fallocatable_function_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/237b2f1b418a4394535f64c8fb600bc78fd00169/gcc%2Ftestsuite%2Fgfortran.dg%2Fallocatable_function_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fallocatable_function_3.f90?ref=237b2f1b418a4394535f64c8fb600bc78fd00169", "patch": "@@ -0,0 +1,24 @@\n+! { dg-do run }\n+! Tests the fix for PR33986, in which the call to scram would call\n+! an ICE because allocatable result actuals had not been catered for.\n+!\n+!  Contributed by Damian Rouson <damian@rouson.net>\n+!\n+function transform_to_spectral_from() result(spectral)\n+  integer, allocatable :: spectral(:)\n+  allocate(spectral(2))\n+  call scram(spectral)\n+end function transform_to_spectral_from\n+\n+subroutine scram (x)\n+  integer x(2)\n+  x = (/1,2/)\n+end subroutine\n+\n+  interface\n+    function transform_to_spectral_from() result(spectral)\n+      integer, allocatable :: spectral(:)\n+    end function transform_to_spectral_from\n+  end interface\n+  if (any (transform_to_spectral_from () .ne. (/1,2/))) call abort ()\n+end"}]}