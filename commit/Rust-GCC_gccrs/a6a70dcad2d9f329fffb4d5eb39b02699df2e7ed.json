{"sha": "a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTZhNzBkY2FkMmQ5ZjMyOWZmZmI0ZDVlYjM5YjAyNjk5ZGYyZTdlZA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2017-01-21T19:36:01Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2017-01-21T19:36:01Z"}, "message": "re PR lto/78407 (LTO breaks separate overriding of symbol aliases)\n\n\tPR lto/78407\n\t* cfg.c (update_bb_profile_for_threading): Fix updating of probablity.\n\nFrom-SVN: r244749", "tree": {"sha": "620053cdd7b36b632d57e5685e05c239c76cf8ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/620053cdd7b36b632d57e5685e05c239c76cf8ec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed/comments", "author": null, "committer": null, "parents": [{"sha": "509912a611f9e86883cd1f3c1751e4a1b3cb7abf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/509912a611f9e86883cd1f3c1751e4a1b3cb7abf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/509912a611f9e86883cd1f3c1751e4a1b3cb7abf"}], "stats": {"total": 14, "additions": 10, "deletions": 4}, "files": [{"sha": "2980e46f4b8df23ddcb49b92903b90e2021e1370", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed", "patch": "@@ -1,3 +1,8 @@\n+2017-01-21  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR lto/78407\n+\t* cfg.c (update_bb_profile_for_threading): Fix updating of probablity.\n+\n 2017-01-21  Bernd Schmidt  <bschmidt@redhat.com>\n \n \trtl-optimization/79125"}, {"sha": "1bcf9b8227f8fa28f6886fe9d93e1e01a7ecac4e", "filename": "gcc/cfg.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed/gcc%2Fcfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed/gcc%2Fcfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfg.c?ref=a6a70dcad2d9f329fffb4d5eb39b02699df2e7ed", "patch": "@@ -869,6 +869,10 @@ update_bb_profile_for_threading (basic_block bb, int edge_frequency,\n       bb->count = 0;\n     }\n \n+  bb->frequency -= edge_frequency;\n+  if (bb->frequency < 0)\n+    bb->frequency = 0;\n+\n   /* Compute the probability of TAKEN_EDGE being reached via threaded edge.\n      Watch for overflows.  */\n   if (bb->frequency)\n@@ -882,15 +886,12 @@ update_bb_profile_for_threading (basic_block bb, int edge_frequency,\n \t\t \"%i->%i too small (it is %i, should be %i).\\n\",\n \t\t taken_edge->src->index, taken_edge->dest->index,\n \t\t taken_edge->probability, prob);\n-      prob = taken_edge->probability;\n+      prob = taken_edge->probability * 6 / 8;\n     }\n \n   /* Now rescale the probabilities.  */\n   taken_edge->probability -= prob;\n   prob = REG_BR_PROB_BASE - prob;\n-  bb->frequency -= edge_frequency;\n-  if (bb->frequency < 0)\n-    bb->frequency = 0;\n   if (prob <= 0)\n     {\n       if (dump_file)"}]}