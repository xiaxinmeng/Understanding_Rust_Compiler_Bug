{"sha": "00420f7430267c2df25b71edcb401e4df443ac01", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDA0MjBmNzQzMDI2N2MyZGYyNWI3MWVkY2I0MDFlNGRmNDQzYWMwMQ==", "commit": {"author": {"name": "Justin Squirek", "email": "squirek@adacore.com", "date": "2017-01-12T13:55:59Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-01-12T13:55:59Z"}, "message": "sem_prag.adb (Analyze_Pragma): Add appropriate calls to Resolve_Suppressible in the pragma Assertion_Policy case.\n\n2017-01-12  Justin Squirek  <squirek@adacore.com>\n\n\t* sem_prag.adb (Analyze_Pragma): Add appropriate calls to\n\tResolve_Suppressible in the pragma Assertion_Policy case.\n\t(Resolve_Suppressible): Created this function to factor out\n\tcommon code used to resolve Suppress to either Ignore or Check\n\t* snames.ads-tmpl: Add name for Suppressible.\n\nFrom-SVN: r244362", "tree": {"sha": "29adc3bf91d500fb8bdbe3f98a57710b40cb5187", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/29adc3bf91d500fb8bdbe3f98a57710b40cb5187"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/00420f7430267c2df25b71edcb401e4df443ac01", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00420f7430267c2df25b71edcb401e4df443ac01", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00420f7430267c2df25b71edcb401e4df443ac01", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00420f7430267c2df25b71edcb401e4df443ac01/comments", "author": {"login": "AdaDoom3", "id": 3445599, "node_id": "MDQ6VXNlcjM0NDU1OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/3445599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdaDoom3", "html_url": "https://github.com/AdaDoom3", "followers_url": "https://api.github.com/users/AdaDoom3/followers", "following_url": "https://api.github.com/users/AdaDoom3/following{/other_user}", "gists_url": "https://api.github.com/users/AdaDoom3/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdaDoom3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdaDoom3/subscriptions", "organizations_url": "https://api.github.com/users/AdaDoom3/orgs", "repos_url": "https://api.github.com/users/AdaDoom3/repos", "events_url": "https://api.github.com/users/AdaDoom3/events{/privacy}", "received_events_url": "https://api.github.com/users/AdaDoom3/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0691440320ef57149c7a4ac056696e558d215af4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0691440320ef57149c7a4ac056696e558d215af4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0691440320ef57149c7a4ac056696e558d215af4"}], "stats": {"total": 55, "additions": 50, "deletions": 5}, "files": [{"sha": "a7d230b094cfdf6575855561075bee93080bf7fe", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/00420f7430267c2df25b71edcb401e4df443ac01/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/00420f7430267c2df25b71edcb401e4df443ac01/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=00420f7430267c2df25b71edcb401e4df443ac01", "patch": "@@ -1,3 +1,11 @@\n+2017-01-12  Justin Squirek  <squirek@adacore.com>\n+\n+\t* sem_prag.adb (Analyze_Pragma): Add appropriate calls to\n+\tResolve_Suppressible in the pragma Assertion_Policy case.\n+\t(Resolve_Suppressible): Created this function to factor out\n+\tcommon code used to resolve Suppress to either Ignore or Check\n+\t* snames.ads-tmpl: Add name for Suppressible.\n+\n 2017-01-12  Gary Dismukes  <dismukes@adacore.com>\n \n \t* exp_ch9.adb, s-secsta.adb, snames.ads-tmpl, exp_ch3.adb: Minor"}, {"sha": "58dd3e8079a92108458a8712034499a7b62e1f45", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 41, "deletions": 5, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/00420f7430267c2df25b71edcb401e4df443ac01/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/00420f7430267c2df25b71edcb401e4df443ac01/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=00420f7430267c2df25b71edcb401e4df443ac01", "patch": "@@ -11812,7 +11812,7 @@ package body Sem_Prag is\n          --  identically named aspects and pragmas, depending on the specified\n          --  policy identifier:\n \n-         --  POLICY_IDENTIFIER ::= Check | Disable | Ignore\n+         --  POLICY_IDENTIFIER ::= Check | Disable | Ignore | Suppressible\n \n          --  Note: Check and Ignore are language-defined. Disable is a GNAT\n          --  implementation-defined addition that results in totally ignoring\n@@ -11828,6 +11828,38 @@ package body Sem_Prag is\n          --  processing is required here.\n \n          when Pragma_Assertion_Policy => Assertion_Policy : declare\n+\n+            procedure Resolve_Suppressible (Policy : Node_Id);\n+            --  Converts the assertion policy 'Suppressible' to either Check or\n+            --  ignore based on whether checks are suppressed via -gnatp or ???\n+\n+            --------------------------\n+            -- Resolve_Suppressible --\n+            --------------------------\n+\n+            procedure Resolve_Suppressible (Policy : Node_Id) is\n+               Nam : Name_Id;\n+               ARG : constant Node_Id := Get_Pragma_Arg (Policy);\n+\n+            begin\n+               if Chars (Expression (Policy)) = Name_Suppressible then\n+\n+                  --  Rewrite the policy argument node to either Ignore or\n+                  --  Check. This is done because the argument is referenced\n+                  --  directly later during analysis.\n+\n+                  if Suppress_Checks then\n+                     Nam := Name_Ignore;\n+                  else\n+                     Nam := Name_Check;\n+                  end if;\n+\n+                  Rewrite (ARG, Make_Identifier (Sloc (ARG), Nam));\n+               end if;\n+            end Resolve_Suppressible;\n+\n+            --  Local variables\n+\n             Arg    : Node_Id;\n             Kind   : Name_Id;\n             LocP   : Source_Ptr;\n@@ -11856,8 +11888,10 @@ package body Sem_Prag is\n               and then (Nkind (Arg1) /= N_Pragma_Argument_Association\n                          or else Chars (Arg1) = No_Name)\n             then\n-               Check_Arg_Is_One_Of\n-                 (Arg1, Name_Check, Name_Disable, Name_Ignore);\n+               Check_Arg_Is_One_Of (Arg1,\n+                 Name_Check, Name_Disable, Name_Ignore, Name_Suppressible);\n+\n+               Resolve_Suppressible (Arg1);\n \n                --  Treat one argument Assertion_Policy as equivalent to:\n \n@@ -11911,8 +11945,10 @@ package body Sem_Prag is\n                        (\"invalid assertion kind for pragma%\", Arg);\n                   end if;\n \n-                  Check_Arg_Is_One_Of\n-                    (Arg, Name_Check, Name_Disable, Name_Ignore);\n+                  Check_Arg_Is_One_Of (Arg,\n+                    Name_Check, Name_Disable, Name_Ignore, Name_Suppressible);\n+\n+                  Resolve_Suppressible (Arg);\n \n                   if Kind = Name_Ghost then\n "}, {"sha": "5941beb3317cf4d93f272ed5ead7baa0f10aa3a9", "filename": "gcc/ada/snames.ads-tmpl", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/00420f7430267c2df25b71edcb401e4df443ac01/gcc%2Fada%2Fsnames.ads-tmpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/00420f7430267c2df25b71edcb401e4df443ac01/gcc%2Fada%2Fsnames.ads-tmpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsnames.ads-tmpl?ref=00420f7430267c2df25b71edcb401e4df443ac01", "patch": "@@ -818,6 +818,7 @@ package Snames is\n    Name_Strict                         : constant Name_Id := N + $;\n    Name_Subunit_File_Name              : constant Name_Id := N + $;\n    Name_Suppressed                     : constant Name_Id := N + $;\n+   Name_Suppressible                   : constant Name_Id := N + $;\n    Name_Synchronous                    : constant Name_Id := N + $;\n    Name_Task_Stack_Size_Default        : constant Name_Id := N + $;\n    Name_Task_Type                      : constant Name_Id := N + $;"}]}