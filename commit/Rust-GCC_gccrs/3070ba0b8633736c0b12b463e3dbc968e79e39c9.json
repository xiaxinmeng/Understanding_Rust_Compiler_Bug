{"sha": "3070ba0b8633736c0b12b463e3dbc968e79e39c9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzA3MGJhMGI4NjMzNzM2YzBiMTJiNDYzZTNkYmM5NjhlNzllMzljOQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1998-06-06T18:13:12Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1998-06-06T18:13:12Z"}, "message": "* search.c (envelope_add_decl): Tweak for implicit typename.\n\nFrom-SVN: r20264", "tree": {"sha": "54bbe6f2051c407e03849b3256a564d6182f4be2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/54bbe6f2051c407e03849b3256a564d6182f4be2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3070ba0b8633736c0b12b463e3dbc968e79e39c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3070ba0b8633736c0b12b463e3dbc968e79e39c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3070ba0b8633736c0b12b463e3dbc968e79e39c9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3070ba0b8633736c0b12b463e3dbc968e79e39c9/comments", "author": null, "committer": null, "parents": [{"sha": "e37cda9b2c552b1bf1fe5f8431d749c94d2cdbf5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e37cda9b2c552b1bf1fe5f8431d749c94d2cdbf5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e37cda9b2c552b1bf1fe5f8431d749c94d2cdbf5"}], "stats": {"total": 13, "additions": 9, "deletions": 4}, "files": [{"sha": "cec9536bf72370fe319c046d5825db9e3afc2e2d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3070ba0b8633736c0b12b463e3dbc968e79e39c9/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3070ba0b8633736c0b12b463e3dbc968e79e39c9/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=3070ba0b8633736c0b12b463e3dbc968e79e39c9", "patch": "@@ -1,5 +1,7 @@\n 1998-06-05  Jason Merrill  <jason@yorick.cygnus.com>\n \n+\t* search.c (envelope_add_decl): Tweak for implicit typename.\n+\n \t* call.c (joust): Also warn about confusing conversion op/constructor\n \toverload resolution.\n "}, {"sha": "6d2a5309ff5991b5aec49e60f17782eec2ff67e2", "filename": "gcc/cp/search.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3070ba0b8633736c0b12b463e3dbc968e79e39c9/gcc%2Fcp%2Fsearch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3070ba0b8633736c0b12b463e3dbc968e79e39c9/gcc%2Fcp%2Fsearch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsearch.c?ref=3070ba0b8633736c0b12b463e3dbc968e79e39c9", "patch": "@@ -3333,6 +3333,12 @@ envelope_add_decl (type, decl, values)\n   tree name = DECL_NAME (decl);\n   int dont_add = 0;\n \n+  /* Yet Another Implicit Typename Kludge:  Since we don't tsubst\n+     the members for partial instantiations, DECL_CONTEXT (decl) is wrong.\n+     But pretend it's right for this function.  */\n+  if (processing_template_decl)\n+    type = DECL_REAL_CONTEXT (decl);\n+\n   /* virtual base names are always unique.  */\n   if (VBASE_NAME_P (name))\n     *values = NULL_TREE;\n@@ -3354,10 +3360,7 @@ envelope_add_decl (type, decl, values)\n \t  warning (\"in this context\");\n \t}\n \n-      context = (TREE_CODE (value) == FUNCTION_DECL\n-\t\t && DECL_VIRTUAL_P (value))\n-\t? DECL_CLASS_CONTEXT (value)\n-\t  : DECL_CONTEXT (value);\n+      context = DECL_REAL_CONTEXT (value);\n \n       if (context == type)\n \t{"}]}