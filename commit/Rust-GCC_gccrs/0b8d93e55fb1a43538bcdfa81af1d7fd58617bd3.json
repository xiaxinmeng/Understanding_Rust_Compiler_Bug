{"sha": "0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGI4ZDkzZTU1ZmIxYTQzNTM4YmNkZmE4MWFmMWQ3ZmQ1ODYxN2JkMw==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2015-12-08T18:21:15Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2015-12-08T18:21:15Z"}, "message": "sse4_1-round.h (do_round): Fix inline asm statements.\n\n\t* gcc.target/i386/sse4_1-round.h (do_round): Fix inline asm statements.\n\t* gcc.target/i386/sse4_1-roundsd-4.c (do_round): Ditto.\n\t* gcc.target/i386/sse4_1-roundss-4.c (do_round): Ditto.\n\nFrom-SVN: r231418", "tree": {"sha": "d9abdc6c964967dc877d7d4c82d39fe5ff65b62c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d9abdc6c964967dc877d7d4c82d39fe5ff65b62c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "315a541c457b2ad1a10cd04a4c20aed642a32678", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/315a541c457b2ad1a10cd04a4c20aed642a32678", "html_url": "https://github.com/Rust-GCC/gccrs/commit/315a541c457b2ad1a10cd04a4c20aed642a32678"}], "stats": {"total": 45, "additions": 24, "deletions": 21}, "files": [{"sha": "80f85c836e68939a860c28e5cb1f0ecb25a9fde9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "patch": "@@ -1,3 +1,9 @@\n+2015-12-08  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\t* gcc.target/i386/sse4_1-round.h (do_round): Fix inline asm statements.\n+\t* gcc.target/i386/sse4_1-roundsd-4.c (do_round): Ditto.\n+\t* gcc.target/i386/sse4_1-roundss-4.c (do_round): Ditto.\n+\n 2015-12-08  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc.dg/sso-9.c (foo): Robustify trick."}, {"sha": "dfb0b778cdcf6be1e26c293c577012a31479493e", "filename": "gcc/testsuite/gcc.target/i386/sse4_1-round.h", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-round.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-round.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-round.h?ref=0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "patch": "@@ -28,7 +28,7 @@ init_round (FP_T *src)\n static FP_T\n do_round (FP_T f, int type)\n {\n-  short saved_cw, new_cw, clr_mask;\n+  unsigned short saved_cw, new_cw, clr_mask;\n   FP_T ret;\n \n   if ((type & 4))\n@@ -42,16 +42,15 @@ do_round (FP_T f, int type)\n       clr_mask = ~0x0C3F;\n     }\n \n-  __asm__ (\"fld\" ASM_SUFFIX \" %0\" : : \"m\" (*&f));\n+  __asm__ (\"fnstcw %0\" : \"=m\" (saved_cw));\n \n-  __asm__ (\"fstcw %0\" : \"=m\" (*&saved_cw));\n   new_cw = saved_cw & clr_mask;\n   new_cw |= type;\n-  __asm__ (\"fldcw %0\" : : \"m\" (*&new_cw));\n \n-  __asm__ (\"frndint\\n\"\n-\t   \"fstp\" ASM_SUFFIX \" %0\\n\" : \"=m\" (*&ret));\n-  __asm__ (\"fldcw %0\" : : \"m\" (*&saved_cw));\n+  __asm__ (\"fldcw %2\\n\\t\"\n+\t   \"frndint\\n\\t\"\n+\t   \"fldcw %3\" : \"=t\" (ret)\n+\t\t      : \"0\" (f), \"m\" (new_cw), \"m\" (saved_cw));\n   return ret;\n }\n "}, {"sha": "ff8b09eeba62f771ab3d6802e986c7b9bd91e225", "filename": "gcc/testsuite/gcc.target/i386/sse4_1-roundsd-4.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-roundsd-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-roundsd-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-roundsd-4.c?ref=0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "patch": "@@ -36,7 +36,7 @@ init_round (double *src)\n static double\n do_round (double f, int type)\n {\n-  short saved_cw, new_cw, clr_mask;\n+  unsigned short saved_cw, new_cw, clr_mask;\n   double ret;\n \n   if ((type & 4))\n@@ -50,16 +50,15 @@ do_round (double f, int type)\n       clr_mask = ~0x0C3F;\n     }\n \n-  __asm__ (\"fldl %0\" : : \"m\" (*&f));\n+  __asm__ (\"fnstcw %0\" : \"=m\" (saved_cw));\n \n-  __asm__ (\"fstcw %0\" : \"=m\" (*&saved_cw));\n   new_cw = saved_cw & clr_mask;\n   new_cw |= type;\n-  __asm__ (\"fldcw %0\" : : \"m\" (*&new_cw));\n \n-  __asm__ (\"frndint\\n\"\n-\t   \"fstpl %0\\n\" : \"=m\" (*&ret));\n-  __asm__ (\"fldcw %0\" : : \"m\" (*&saved_cw));\n+  __asm__ (\"fldcw %2\\n\\t\"\n+\t   \"frndint\\n\\t\"\n+\t   \"fldcw %3\" : \"=t\" (ret)\n+\t\t      : \"0\" (f), \"m\" (new_cw), \"m\" (saved_cw));\n   return ret;\n }\n "}, {"sha": "95488908630181827898498216bb2ac0f9f59af7", "filename": "gcc/testsuite/gcc.target/i386/sse4_1-roundss-4.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-roundss-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-roundss-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fsse4_1-roundss-4.c?ref=0b8d93e55fb1a43538bcdfa81af1d7fd58617bd3", "patch": "@@ -36,7 +36,7 @@ init_round (float *src)\n static float\n do_round (float f, int type)\n {\n-  short saved_cw, new_cw, clr_mask;\n+  unsigned short saved_cw, new_cw, clr_mask;\n   float ret;\n \n   if ((type & 4))\n@@ -50,16 +50,15 @@ do_round (float f, int type)\n       clr_mask = ~0x0C3F;\n     }\n \n-  __asm__ (\"flds %0\" : : \"m\" (*&f));\n+  __asm__ (\"fnstcw %0\" : \"=m\" (saved_cw));\n \n-  __asm__ (\"fstcw %0\" : \"=m\" (*&saved_cw));\n   new_cw = saved_cw & clr_mask;\n   new_cw |= type;\n-  __asm__ (\"fldcw %0\" : : \"m\" (*&new_cw));\n \n-  __asm__ (\"frndint\\n\"\n-\t   \"fstps %0\\n\" : \"=m\" (*&ret));\n-  __asm__ (\"fldcw %0\" : : \"m\" (*&saved_cw));\n+  __asm__ (\"fldcw %2\\n\\t\"\n+\t   \"frndint\\n\\t\"\n+\t   \"fldcw %3\" : \"=t\" (ret)\n+\t\t      : \"0\" (f), \"m\" (new_cw), \"m\" (saved_cw));\n   return ret;\n }\n "}]}