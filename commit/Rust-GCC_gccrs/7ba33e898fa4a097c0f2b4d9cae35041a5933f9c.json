{"sha": "7ba33e898fa4a097c0f2b4d9cae35041a5933f9c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2JhMzNlODk4ZmE0YTA5N2MwZjJiNGQ5Y2FlMzUwNDFhNTkzM2Y5Yw==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@linux.ibm.com", "date": "2020-06-09T20:32:02Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@linux.ibm.com", "date": "2020-06-09T20:32:02Z"}, "message": "PowerPC: Add future hwcap2 bits\n\nThis patch adds support for the two new HWCAP2 fields used by the\n__builtin_cpu_supports function.  It adds support in the target_clones\nattribute for -mcpu=future.\n\nThe two new __builtin_cpu_supports tests are:\n\t__builtin_cpu_supports (\"isa_3_1\")\n\t__builtin_cpu_supports (\"mma\")\n\nThe bits used are the bits that the Linux kernel engineers will be using for\nthese new features.\n\ngcc/\n2020-06-05  Michael Meissner  <meissner@linux.ibm.com>\n\n\t* config/rs6000/ppc-auxv.h (PPC_PLATFORM_FUTURE): Allocate\n\t'future' PowerPC platform.\n\t(PPC_FEATURE2_ARCH_3_1): New HWCAP2 bit for ISA 3.1.\n\t(PPC_FEATURE2_MMA): New HWCAP2 bit for MMA.\n\t* config/rs6000/rs6000-call.c (cpu_supports_info): Add ISA 3.1 and\n\tMMA HWCAP2 bits.\n\t* config/rs6000/rs6000.c (CLONE_ISA_3_1): New clone support.\n\t(rs6000_clone_map): Add 'future' system target_clones support.", "tree": {"sha": "76af8e1581a516553b2c28d5476a26de11061cb2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/76af8e1581a516553b2c28d5476a26de11061cb2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c/comments", "author": null, "committer": null, "parents": [{"sha": "243e5bbfef7be74bfe22747c4e51136dd38c1245", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/243e5bbfef7be74bfe22747c4e51136dd38c1245", "html_url": "https://github.com/Rust-GCC/gccrs/commit/243e5bbfef7be74bfe22747c4e51136dd38c1245"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "e51d0393e5f93150818b46356b2e2ca3c8b2e855", "filename": "gcc/config/rs6000/ppc-auxv.h", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c/gcc%2Fconfig%2Frs6000%2Fppc-auxv.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c/gcc%2Fconfig%2Frs6000%2Fppc-auxv.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fppc-auxv.h?ref=7ba33e898fa4a097c0f2b4d9cae35041a5933f9c", "patch": "@@ -48,6 +48,9 @@\n #define PPC_PLATFORM_POWER8            13\n #define PPC_PLATFORM_POWER9            14\n \n+/* This is not yet official.  */\n+#define PPC_PLATFORM_FUTURE            15\n+\n /* AT_HWCAP bits.  These must match the values defined in the Linux kernel.  */\n #define PPC_FEATURE_32              0x80000000\n #define PPC_FEATURE_64              0x40000000\n@@ -93,6 +96,9 @@\n #define PPC_FEATURE2_SCV            0x00100000\n #define PPC_FEATURE2_HTM_NO_SUSPEND 0x00080000\n \n+/* These are not yet official.  */\n+#define PPC_FEATURE2_ARCH_3_1       0x00040000\n+#define PPC_FEATURE2_MMA            0x00020000\n \n /* Thread Control Block (TCB) offsets of the AT_PLATFORM, AT_HWCAP and\n    AT_HWCAP2 values.  These must match the values defined in GLIBC.  */"}, {"sha": "817a14c9c0d6ca35e125c86fa355856283cab48c", "filename": "gcc/config/rs6000/rs6000-call.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c/gcc%2Fconfig%2Frs6000%2Frs6000-call.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c/gcc%2Fconfig%2Frs6000%2Frs6000-call.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000-call.c?ref=7ba33e898fa4a097c0f2b4d9cae35041a5933f9c", "patch": "@@ -172,7 +172,9 @@ static const struct\n   { \"arch_3_00\",\tPPC_FEATURE2_ARCH_3_00,\t\t1 },\n   { \"ieee128\",\t\tPPC_FEATURE2_HAS_IEEE128,\t1 },\n   { \"darn\",\t\tPPC_FEATURE2_DARN,\t\t1 },\n-  { \"scv\",\t\tPPC_FEATURE2_SCV,\t\t1 }\n+  { \"scv\",\t\tPPC_FEATURE2_SCV,\t\t1 },\n+  { \"arch_3_1\",\t\tPPC_FEATURE2_ARCH_3_1,\t\t1 },\n+  { \"mma\",\t\tPPC_FEATURE2_MMA,\t\t1 },\n };\n \n static void altivec_init_builtins (void);"}, {"sha": "0bbd06ad1dede9227c19ed1f98fbcb29a2095d0f", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ba33e898fa4a097c0f2b4d9cae35041a5933f9c/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=7ba33e898fa4a097c0f2b4d9cae35041a5933f9c", "patch": "@@ -260,6 +260,7 @@ enum {\n   CLONE_ISA_2_06,\t\t\t/* ISA 2.06 (power7).  */\n   CLONE_ISA_2_07,\t\t\t/* ISA 2.07 (power8).  */\n   CLONE_ISA_3_00,\t\t\t/* ISA 3.00 (power9).  */\n+  CLONE_ISA_3_1,\t\t\t/* ISA 3.1 (future).  */\n   CLONE_MAX\n };\n \n@@ -275,6 +276,7 @@ static const struct clone_map rs6000_clone_map[CLONE_MAX] = {\n   { OPTION_MASK_POPCNTD,\t\"arch_2_06\" },\t/* ISA 2.06 (power7).  */\n   { OPTION_MASK_P8_VECTOR,\t\"arch_2_07\" },\t/* ISA 2.07 (power8).  */\n   { OPTION_MASK_P9_VECTOR,\t\"arch_3_00\" },\t/* ISA 3.00 (power9).  */\n+  { OPTION_MASK_FUTURE,\t\t\"arch_3_1\" },\t/* ISA 3.1 (future).  */\n };\n \n "}]}