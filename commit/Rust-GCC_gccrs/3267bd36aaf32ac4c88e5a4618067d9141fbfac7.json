{"sha": "3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzI2N2JkMzZhYWYzMmFjNGM4OGU1YTQ2MTgwNjdkOTE0MWZiZmFjNw==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2017-11-15T03:11:37Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2017-11-15T03:11:37Z"}, "message": "Use compare-debug for bootstrap-debug-lean to ignore != DW_AT_producer\n\nUnlike bootstrap-debug, bootstrap-debug-lean used to pass compare using\nthe traditional compare command, because it compiled both stage2 and\nstage3 with options that used to generate identical output\n(-fcompare-debug= in stage2 vs -fcompare-debug in stage3).\n\nSince we started adding relevant command-line flags to DW_AT_producer,\nthis is no longer the case, and stages 2 and 3 object files that differ\nin nothing but the DW_AT_producer strings.\n\n\n-fcompare-debug is short for -fcompare-debug=-gtoggle, so stage3\ncompiles twice, once with the normal options, once with toggled -g, to\nthen compare the temporary final dumps.  When enabled, both compilations\nget from the driver an additional -frandom-seed flag (if none is given\nexplicitly).\n\n-fcompare-debug= is short for -fno-compare-debug, disabling the second\ncompilation.\n\n\nThe difference between the DW_AT_producer lines are the different\n-fcompare-debug flags, and the presence of the -frandom-seed flag in the\nstage3 compilation.\n\nIt is easy and sensible enough to filter the -fcompare-debug flags out\nof the DW_AT_producer string.  This option should never affect the\ncompilation output, it just determines whether or not to perform an\nadditional compilation that should produce the same executable output.\n\nHowever, dropping -frandom-seed is not quite correct, in that it might\nhave other consequences on the compilation.  So, it makes little sense\nto make the effort to drop it when it's implicit; for those comparing\ncompiler output differences, it might even hint at what causes, and\ncould fix, difficult to explain differences, namely, explicitly\nsupplying -frandom-seed options.\n\nThey don't seem to matter for compiler bootstraps, though, at least\nfor now, so we can safely refrain from issuing -frandom-seed (or maybe\nwe already issue it where needed :-), and then, for\nbootstrap-debug-lean, use the compare-debug script, that strips out\ndebug information before comparing the object files.\n\n\nfor  config/ChangeLog\n\n\t* bootstrap-debug-lean.mk (do-compare): Use the\n\tcontrib/compare-debug script.\n\nfor  gcc/ChangeLog\n\n\t* dwarf2out.c (gen_producer_string): Discard\n\tOPT_fcompare_debug.\n\nFrom-SVN: r254750", "tree": {"sha": "5d4271af7bdbe2924a3d00fddbbe6990a298ced7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d4271af7bdbe2924a3d00fddbbe6990a298ced7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/comments", "author": null, "committer": null, "parents": [{"sha": "3ca0dc603213b2ad5ffbcf1a443a102bef96053a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ca0dc603213b2ad5ffbcf1a443a102bef96053a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3ca0dc603213b2ad5ffbcf1a443a102bef96053a"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "90e1af4779dd0b39c3ab66c06839044f1e993e8f", "filename": "config/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/config%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/config%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2FChangeLog?ref=3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "patch": "@@ -1,3 +1,8 @@\n+2017-11-15  Alexandre Oliva <aoliva@redhat.com>\n+\n+\t* bootstrap-debug-lean.mk (do-compare): Use the\n+\tcontrib/compare-debug script.\n+\n 2017-10-24  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* bootstrap-cet.mk: New file."}, {"sha": "5f2db80687fa0eae1255a1f8f2e1b57a38f1ff18", "filename": "config/bootstrap-debug-lean.mk", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/config%2Fbootstrap-debug-lean.mk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/config%2Fbootstrap-debug-lean.mk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Fbootstrap-debug-lean.mk?ref=3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "patch": "@@ -9,3 +9,4 @@\n \n STAGE2_CFLAGS += -fcompare-debug=\n STAGE3_CFLAGS += -fcompare-debug\n+do-compare = $(SHELL) $(srcdir)/contrib/compare-debug $$f1 $$f2"}, {"sha": "70ae417b3661825ef44a69a54a92d17157f82b0f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "patch": "@@ -1,3 +1,8 @@\n+2017-11-15  Alexandre Oliva <aoliva@redhat.com>\n+\n+\t* dwarf2out.c (gen_producer_string): Discard\n+\tOPT_fcompare_debug.\n+\n 2017-11-15  Joseph Myers  <joseph@codesourcery.com>\n \n \tPR c/81156"}, {"sha": "76a538f1ff97a69a0356feed2e8a9f3630b8971a", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3267bd36aaf32ac4c88e5a4618067d9141fbfac7/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=3267bd36aaf32ac4c88e5a4618067d9141fbfac7", "patch": "@@ -23408,6 +23408,7 @@ gen_producer_string (void)\n       case OPT_fltrans_output_list_:\n       case OPT_fresolution_:\n       case OPT_fdebug_prefix_map_:\n+      case OPT_fcompare_debug:\n \t/* Ignore these.  */\n \tcontinue;\n       default:"}]}