{"sha": "0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGEwZWM1M2QxMmI2YThiYTk0ZGMxOWRiNTE0Y2UxZDNlZjJhZjY2OQ==", "commit": {"author": {"name": "Aaron Conole", "email": "aconole@redhat.com", "date": "2016-06-06T15:24:24Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2016-06-06T15:24:24Z"}, "message": "re PR bootstrap/71400 (profiledbootstrap failed)\n\n\tPR libgcc/71400\n\t* libgcov-driver-system.c (__gcov_error_file): Disable if IN_GCOV_TOOL.\n\t(get_gcov_error_file): Check __gcov_error_file before trying to\n\tinitialize it.\n\t(gcov_error): Always use get_gcov_error_file.\n\nCo-Authored-By: Nathan Sidwell <nathan@acm.org>\n\nFrom-SVN: r237135", "tree": {"sha": "93fdd91271bc27e634bffdb53c15783f8bdb3b0e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/93fdd91271bc27e634bffdb53c15783f8bdb3b0e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669/comments", "author": {"login": "orgcandman", "id": 1092926, "node_id": "MDQ6VXNlcjEwOTI5MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1092926?v=4", "gravatar_id": "", "url": "https://api.github.com/users/orgcandman", "html_url": "https://github.com/orgcandman", "followers_url": "https://api.github.com/users/orgcandman/followers", "following_url": "https://api.github.com/users/orgcandman/following{/other_user}", "gists_url": "https://api.github.com/users/orgcandman/gists{/gist_id}", "starred_url": "https://api.github.com/users/orgcandman/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/orgcandman/subscriptions", "organizations_url": "https://api.github.com/users/orgcandman/orgs", "repos_url": "https://api.github.com/users/orgcandman/repos", "events_url": "https://api.github.com/users/orgcandman/events{/privacy}", "received_events_url": "https://api.github.com/users/orgcandman/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "93671519e202e3bc5ab592bb6318aa738e4ae58f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93671519e202e3bc5ab592bb6318aa738e4ae58f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93671519e202e3bc5ab592bb6318aa738e4ae58f"}], "stats": {"total": 35, "additions": 21, "deletions": 14}, "files": [{"sha": "544ea65f102f8ddfcc02af01fb2075c9242d06c7", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669", "patch": "@@ -1,3 +1,12 @@\n+2016-06-05  Aaron Conole  <aconole@redhat.com>\n+\t    Nathan Sidwell  <nathan@acm.org>\n+\n+\tPR libgcc/71400\n+\t* libgcov-driver-system.c (__gcov_error_file): Disable if IN_GCOV_TOOL.\n+\t(get_gcov_error_file): Check __gcov_error_file before trying to\n+\tinitialize it.\n+\t(gcov_error): Always use get_gcov_error_file.\n+\n 2016-06-02  Aaron Conole  <aconole@redhat.com>\n \n \t* libgcov-driver-system.c (__gcov_error_file): New."}, {"sha": "e617afabee16e6c168ef60215a9e5a45b9e1b30c", "filename": "libgcc/libgcov-driver-system.c", "status": "modified", "additions": 12, "deletions": 14, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669/libgcc%2Flibgcov-driver-system.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669/libgcc%2Flibgcov-driver-system.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov-driver-system.c?ref=0a0ec53d12b6a8ba94dc19db514ce1d3ef2af669", "patch": "@@ -23,31 +23,32 @@ a copy of the GCC Runtime Library Exception along with this program;\n see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n <http://www.gnu.org/licenses/>.  */\n \n+#if !IN_GCOV_TOOL\n /* Configured via the GCOV_ERROR_FILE environment variable;\n    it will either be stderr, or a file of the user's choosing.\n    Non-static to prevent multiple gcov-aware shared objects from\n    instantiating their own copies. */\n FILE *__gcov_error_file = NULL;\n+#endif\n \n /* A utility function to populate the __gcov_error_file pointer.\n    This should NOT be called outside of the gcov system driver code. */\n \n static FILE *\n-get_gcov_error_file(void)\n+get_gcov_error_file (void)\n {\n-#if !IN_GCOV_TOOL\n+#if IN_GCOV_TOOL\n   return stderr;\n #else\n-  char *gcov_error_filename = getenv (\"GCOV_ERROR_FILE\");\n-\n-  if (gcov_error_filename)\n+  if (!__gcov_error_file)\n     {\n-      FILE *openfile = fopen (gcov_error_filename, \"a\");\n-      if (openfile)\n-        __gcov_error_file = openfile;\n+      const char *gcov_error_filename = getenv (\"GCOV_ERROR_FILE\");\n+\n+      if (gcov_error_filename)\n+\t__gcov_error_file = fopen (gcov_error_filename, \"a\");\n+      if (!__gcov_error_file)\n+\t__gcov_error_file = stderr;\n     }\n-  if (!__gcov_error_file)\n-    __gcov_error_file = stderr;\n   return __gcov_error_file;\n #endif\n }\n@@ -60,11 +61,8 @@ gcov_error (const char *fmt, ...)\n   int ret;\n   va_list argp;\n \n-  if (!__gcov_error_file)\n-    __gcov_error_file = get_gcov_error_file ();\n-\n   va_start (argp, fmt);\n-  ret = vfprintf (__gcov_error_file, fmt, argp);\n+  ret = vfprintf (get_gcov_error_file (), fmt, argp);\n   va_end (argp);\n   return ret;\n }"}]}