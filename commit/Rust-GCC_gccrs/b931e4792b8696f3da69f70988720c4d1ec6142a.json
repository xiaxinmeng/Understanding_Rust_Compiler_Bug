{"sha": "b931e4792b8696f3da69f70988720c4d1ec6142a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjkzMWU0NzkyYjg2OTZmM2RhNjlmNzA5ODg3MjBjNGQxZWM2MTQyYQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2021-03-22T10:09:46Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2021-03-22T13:37:26Z"}, "message": "tree-optimization/99694 - fix value-numbering PHIs\n\nThis avoids endless cycling when a PHI node with unchanged backedge\nvalue (the PHI result appearing there) is subject to CSE since doing\nthat effectively alters the hash entry.  The way to avoid this is\nto ignore such edges when processing the PHI node.\n\n2021-03-22  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/99694\n\t* tree-ssa-sccvn.c (visit_phi): Ignore edges with the\n\tPHI result.\n\n\t* gcc.dg/torture/pr99694.c: New testcase.", "tree": {"sha": "a666bbbf3e9d9ea76035565ddb390247569e4354", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a666bbbf3e9d9ea76035565ddb390247569e4354"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b931e4792b8696f3da69f70988720c4d1ec6142a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b931e4792b8696f3da69f70988720c4d1ec6142a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b931e4792b8696f3da69f70988720c4d1ec6142a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b931e4792b8696f3da69f70988720c4d1ec6142a/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c4519fe3db366d781f342b7f04c4a09e4cc9fbd9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4519fe3db366d781f342b7f04c4a09e4cc9fbd9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4519fe3db366d781f342b7f04c4a09e4cc9fbd9"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "df3169616735e0b43756718573d347d2c6da78db", "filename": "gcc/testsuite/gcc.dg/torture/pr99694.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b931e4792b8696f3da69f70988720c4d1ec6142a/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr99694.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b931e4792b8696f3da69f70988720c4d1ec6142a/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr99694.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr99694.c?ref=b931e4792b8696f3da69f70988720c4d1ec6142a", "patch": "@@ -0,0 +1,27 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-w\" } */\n+\n+#include <stdint.h>\n+\n+int a, b, c;\n+void d() {\n+  uint16_t e;\n+  int32_t *f;\n+  int32_t *g;\n+  if (a) {\n+    int32_t *k;\n+    for (;; *k += 1) {\n+      int32_t **i = &f;\n+      int32_t **l = &g;\n+      for (e = 6; e; e++) {\n+        g = k = f;\n+      j:\n+        **l = 0;\n+      }\n+      *i = c;\n+    }\n+  }\n+  uint16_t i = &e;\n+  b = i / 0;\n+  goto j;\n+}"}, {"sha": "1c0500ce61e4014e7e6b04e10d265e9528cbefda", "filename": "gcc/tree-ssa-sccvn.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b931e4792b8696f3da69f70988720c4d1ec6142a/gcc%2Ftree-ssa-sccvn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b931e4792b8696f3da69f70988720c4d1ec6142a/gcc%2Ftree-ssa-sccvn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-sccvn.c?ref=b931e4792b8696f3da69f70988720c4d1ec6142a", "patch": "@@ -5199,6 +5199,8 @@ visit_phi (gimple *phi, bool *inserted, bool backedges_varying_p)\n       {\n \ttree def = PHI_ARG_DEF_FROM_EDGE (phi, e);\n \n+\tif (def == PHI_RESULT (phi))\n+\t  continue;\n \t++n_executable;\n \tif (TREE_CODE (def) == SSA_NAME)\n \t  {"}]}