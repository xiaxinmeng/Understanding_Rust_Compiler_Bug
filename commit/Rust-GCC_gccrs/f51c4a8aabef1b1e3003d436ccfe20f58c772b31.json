{"sha": "f51c4a8aabef1b1e3003d436ccfe20f58c772b31", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjUxYzRhOGFhYmVmMWIxZTMwMDNkNDM2Y2NmZTIwZjU4Yzc3MmIzMQ==", "commit": {"author": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2011-07-28T14:42:45Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2011-07-28T14:42:45Z"}, "message": "re PR target/47715 ([x32] TLS doesn't work)\n\n\tPR target/47715\n\t* config/i386/i386.md (*tls_global_dynamic_64): Remove mode from\n\ttls_symbolic_operand check.  Update code sequence for TARGET_X32.\n\t(tls_global_dynamic_64): Remove mode from tls_symbolic_operand check.\n\t(tls_dynamic_gnu2_64): Ditto.\n\t(*tls_dynamic_gnu2_lea_64): Ditto.\n\t(*tls_dynamic_gnu2_call_64): Ditto.\n\t(*tls_dynamic_gnu2_combine_64): Ditto.\n\nFrom-SVN: r176872", "tree": {"sha": "fc1072c649f7b69c243893ec8433cd820aac181b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc1072c649f7b69c243893ec8433cd820aac181b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f51c4a8aabef1b1e3003d436ccfe20f58c772b31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f51c4a8aabef1b1e3003d436ccfe20f58c772b31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f51c4a8aabef1b1e3003d436ccfe20f58c772b31", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f51c4a8aabef1b1e3003d436ccfe20f58c772b31/comments", "author": null, "committer": null, "parents": [{"sha": "5e9627caa4597431f0e366708a79e7ec48e7a006", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e9627caa4597431f0e366708a79e7ec48e7a006", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e9627caa4597431f0e366708a79e7ec48e7a006"}], "stats": {"total": 41, "additions": 26, "deletions": 15}, "files": [{"sha": "707bd26e518d8df43f0a3c57420b38396eacf915", "filename": "gcc/ChangeLog", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f51c4a8aabef1b1e3003d436ccfe20f58c772b31/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f51c4a8aabef1b1e3003d436ccfe20f58c772b31/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f51c4a8aabef1b1e3003d436ccfe20f58c772b31", "patch": "@@ -1,3 +1,14 @@\n+2011-07-28  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/47715\n+\t* config/i386/i386.md (*tls_global_dynamic_64): Remove mode from\n+\ttls_symbolic_operand check.  Update code sequence for TARGET_X32.\n+\t(tls_global_dynamic_64): Remove mode from tls_symbolic_operand check.\n+\t(tls_dynamic_gnu2_64): Ditto.\n+\t(*tls_dynamic_gnu2_lea_64): Ditto.\n+\t(*tls_dynamic_gnu2_call_64): Ditto.\n+\t(*tls_dynamic_gnu2_combine_64): Ditto.\n+\n 2011-07-28  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* config.gcc: Set need_64bit_hwint to yes for x86 targets.\n@@ -15,21 +26,20 @@\n \n 2011-07-28  Kai Tietz  <ktietz@redhat.com>\n \n-\t* tree-vrp.c (simplify_stmt_using_ranges): Remove\n-\tTRUTH_NOT_EXPR case.\n+\t* tree-vrp.c (simplify_stmt_using_ranges): Remove TRUTH_NOT_EXPR case.\n \t(simplify_truth_ops_using_ranges): Likewise.\n \t(build_assert_expr_for): Likewise.\n \t(build_assert_expr_for_1): Remove TRUTH_NOT_EXPR case\n \tand handle BIT_NOT_EXPR for truth-operation.\n \n 2011-07-28  Georg-Johann Lay  <avr@gjlay.de>\n-\t\n+\n \tPR target/49313\n \tUndo r176835 from trunk\n \t2011-07-27  Georg-Johann Lay\n \n 2011-07-28  Georg-Johann Lay  <avr@gjlay.de>\n-\t\n+\n \tPR target/49687\n \t* config/avr/t-avr (LIB1ASMFUNCS): Remove _xmulhisi3_exit.\n \tAdd _muluhisi3, _mulshisi3, _usmulhisi3."}, {"sha": "01e9a383feaa97134f71e44accba04c3357c7a4c", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f51c4a8aabef1b1e3003d436ccfe20f58c772b31/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f51c4a8aabef1b1e3003d436ccfe20f58c772b31/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=f51c4a8aabef1b1e3003d436ccfe20f58c772b31", "patch": "@@ -12327,11 +12327,12 @@\n \t(call:DI\n \t (mem:QI (match_operand:DI 2 \"constant_call_address_operand\" \"z\"))\n \t (match_operand:DI 3 \"\" \"\")))\n-   (unspec:DI [(match_operand:DI 1 \"tls_symbolic_operand\" \"\")]\n+   (unspec:DI [(match_operand 1 \"tls_symbolic_operand\" \"\")]\n \t      UNSPEC_TLS_GD)]\n   \"TARGET_64BIT\"\n {\n-  fputs (ASM_BYTE \"0x66\\n\", asm_out_file);\n+  if (!TARGET_X32)\n+    fputs (ASM_BYTE \"0x66\\n\", asm_out_file);\n   output_asm_insn\n     (\"lea{q}\\t{%a1@tlsgd(%%rip), %%rdi|rdi, %a1@tlsgd[rip]}\", operands);\n   fputs (ASM_SHORT \"0x6666\\n\", asm_out_file);\n@@ -12349,7 +12350,7 @@\n \t  (call:DI\n \t   (mem:QI (match_operand:DI 2 \"constant_call_address_operand\" \"\"))\n \t   (const_int 0)))\n-     (unspec:DI [(match_operand:DI 1 \"tls_symbolic_operand\" \"\")]\n+     (unspec:DI [(match_operand 1 \"tls_symbolic_operand\" \"\")]\n \t\tUNSPEC_TLS_GD)])])\n \n (define_insn \"*tls_local_dynamic_base_32_gnu\"\n@@ -12502,7 +12503,7 @@\n   ix86_tls_descriptor_calls_expanded_in_cfun = true;\n })\n \n-(define_insn \"*tls_dynamic_lea_32\"\n+(define_insn \"*tls_dynamic_gnu2_lea_32\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n \t(plus:SI (match_operand:SI 1 \"register_operand\" \"b\")\n \t\t (const:SI\n@@ -12515,7 +12516,7 @@\n    (set_attr \"length\" \"6\")\n    (set_attr \"length_address\" \"4\")])\n \n-(define_insn \"*tls_dynamic_call_32\"\n+(define_insn \"*tls_dynamic_gnu2_call_32\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=a\")\n \t(unspec:SI [(match_operand:SI 1 \"tls_symbolic_operand\" \"\")\n \t\t    (match_operand:SI 2 \"register_operand\" \"0\")\n@@ -12553,7 +12554,7 @@\n \n (define_expand \"tls_dynamic_gnu2_64\"\n   [(set (match_dup 2)\n-\t(unspec:DI [(match_operand:DI 1 \"tls_symbolic_operand\" \"\")]\n+\t(unspec:DI [(match_operand 1 \"tls_symbolic_operand\" \"\")]\n \t\t   UNSPEC_TLSDESC))\n    (parallel\n     [(set (match_operand:DI 0 \"register_operand\" \"\")\n@@ -12566,9 +12567,9 @@\n   ix86_tls_descriptor_calls_expanded_in_cfun = true;\n })\n \n-(define_insn \"*tls_dynamic_lea_64\"\n+(define_insn \"*tls_dynamic_gnu2_lea_64\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-\t(unspec:DI [(match_operand:DI 1 \"tls_symbolic_operand\" \"\")]\n+\t(unspec:DI [(match_operand 1 \"tls_symbolic_operand\" \"\")]\n \t\t   UNSPEC_TLSDESC))]\n   \"TARGET_64BIT && TARGET_GNU2_TLS\"\n   \"lea{q}\\t{%a1@TLSDESC(%%rip), %0|%0, %a1@TLSDESC[rip]}\"\n@@ -12577,9 +12578,9 @@\n    (set_attr \"length\" \"7\")\n    (set_attr \"length_address\" \"4\")])\n \n-(define_insn \"*tls_dynamic_call_64\"\n+(define_insn \"*tls_dynamic_gnu2_call_64\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=a\")\n-\t(unspec:DI [(match_operand:DI 1 \"tls_symbolic_operand\" \"\")\n+\t(unspec:DI [(match_operand 1 \"tls_symbolic_operand\" \"\")\n \t\t    (match_operand:DI 2 \"register_operand\" \"0\")\n \t\t    (reg:DI SP_REG)]\n \t\t   UNSPEC_TLSDESC))\n@@ -12598,7 +12599,7 @@\n \t\t     (reg:DI SP_REG)]\n \t\t    UNSPEC_TLSDESC)\n \t (const:DI (unspec:DI\n-\t\t    [(match_operand:DI 1 \"tls_symbolic_operand\" \"\")]\n+\t\t    [(match_operand 1 \"tls_symbolic_operand\" \"\")]\n \t\t    UNSPEC_DTPOFF))))\n    (clobber (reg:CC FLAGS_REG))]\n   \"TARGET_64BIT && TARGET_GNU2_TLS\""}]}