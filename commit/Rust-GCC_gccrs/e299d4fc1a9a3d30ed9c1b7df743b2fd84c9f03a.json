{"sha": "e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTI5OWQ0ZmMxYTlhM2QzMGVkOWMxYjdkZjc0M2IyZmQ4NGM5ZjAzYQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-03-21T21:19:03Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-03-21T21:19:03Z"}, "message": "re PR c++/84972 (ICE: tree check: expected class 'type', have 'exceptional' (error_mark) in extended_tree, at tree.h:5545)\n\n/cp\n2018-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/84972\n\t* decl.c (maybe_deduce_size_from_array_init): Set TREE_TYPE to\n\terror_mark_node when check_array_designated_initializer fails.\n\n/testsuite\n2018-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/84972\n\t* g++.dg/ext/desig10.C: New.\n\nFrom-SVN: r258746", "tree": {"sha": "885d9693effd9c18af41344bf508d50f4c512c59", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/885d9693effd9c18af41344bf508d50f4c512c59"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/comments", "author": null, "committer": null, "parents": [{"sha": "482768bd6b85a5e7b7cf8a208e8a9c50bda052e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/482768bd6b85a5e7b7cf8a208e8a9c50bda052e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/482768bd6b85a5e7b7cf8a208e8a9c50bda052e1"}], "stats": {"total": 21, "additions": 19, "deletions": 2}, "files": [{"sha": "aa8ba26959b9195811bd0cf473403a5759b3b51c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "patch": "@@ -1,3 +1,9 @@\n+2018-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/84972\n+\t* decl.c (maybe_deduce_size_from_array_init): Set TREE_TYPE to\n+\terror_mark_node when check_array_designated_initializer fails.\n+\n 2018-03-21  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/84961"}, {"sha": "0aa4ac20b53bbb76b181715e1e90b07a10204531", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "patch": "@@ -5467,7 +5467,9 @@ maybe_deduce_size_from_array_init (tree decl, tree init)\n \t      failure = 1;\n \t}\n \n-      if (!failure)\n+      if (failure)\n+\tTREE_TYPE (decl) = error_mark_node;\n+      else\n \t{\n \t  failure = cp_complete_array_type (&TREE_TYPE (decl), initializer,\n \t\t\t\t\t    do_default);"}, {"sha": "4c88b114fb371b516632dd08dc0b39882582824e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "patch": "@@ -1,5 +1,10 @@\n+2018-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/84972\n+\t* g++.dg/ext/desig10.C: New.\n+\n 2018-03-21  Thomas Koenig  <tkoenig@gcc.gnu.org>\n-\tHarald Anlauf  <anlauf@gmx.de>\n+\t    Harald Anlauf  <anlauf@gmx.de>\n \n \tPR fortran/84957\n \t* gfortran.dg/pr84957.f90: New test."}, {"sha": "24057dd0ad636ef1adad8c6dd9bd6caaeed4e192", "filename": "gcc/testsuite/g++.dg/ext/desig10.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdesig10.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdesig10.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdesig10.C?ref=e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "patch": "@@ -0,0 +1,4 @@\n+// PR c++/84972\n+// { dg-additional-options \"-w\" }\n+\n+char(a[])({.a = 0});  // { dg-error \"designated initializer\" }"}]}