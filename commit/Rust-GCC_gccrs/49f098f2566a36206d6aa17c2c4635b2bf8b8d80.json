{"sha": "49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDlmMDk4ZjI1NjZhMzYyMDZkNmFhMTdjMmM0NjM1YjJiZjhiOGQ4MA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-01-12T15:43:22Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-01-12T15:43:22Z"}, "message": "re PR c++/38794 (Function body accepted in typedef)\n\n\tPR c++/38794\n\t* decl.c (start_function): If grokdeclarator hasn't returned\n\tFUNCTION_DECL nor error_mark_node, issue diagnostics.\n\n\t* g++.dg/parse/typedef9.C: New test.\n\nFrom-SVN: r143292", "tree": {"sha": "63c40fa8e8187caa4b08c713f55fd24395af7701", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/63c40fa8e8187caa4b08c713f55fd24395af7701"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f56e675de51d00f2ddaede1933175374628f6952", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f56e675de51d00f2ddaede1933175374628f6952", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f56e675de51d00f2ddaede1933175374628f6952"}], "stats": {"total": 26, "additions": 24, "deletions": 2}, "files": [{"sha": "de7d1ab06846a401375155013eb531c69e3dcf99", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "patch": "@@ -1,3 +1,9 @@\n+2009-01-12  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/38794\n+\t* decl.c (start_function): If grokdeclarator hasn't returned\n+\tFUNCTION_DECL nor error_mark_node, issue diagnostics.\n+\n 2009-01-11  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/36254"}, {"sha": "c6ed22d6e7435f69df8faca9dc1ff78ae3368a3b", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "patch": "@@ -1,6 +1,6 @@\n /* Process declarations and variables for C++ compiler.\n    Copyright (C) 1988, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,\n-   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008\n+   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n    Free Software Foundation, Inc.\n    Contributed by Michael Tiemann (tiemann@cygnus.com)\n \n@@ -11774,10 +11774,15 @@ start_function (cp_decl_specifier_seq *declspecs,\n   tree decl1;\n \n   decl1 = grokdeclarator (declarator, declspecs, FUNCDEF, 1, &attrs);\n+  if (decl1 == error_mark_node)\n+    return 0;\n   /* If the declarator is not suitable for a function definition,\n      cause a syntax error.  */\n   if (decl1 == NULL_TREE || TREE_CODE (decl1) != FUNCTION_DECL)\n-    return 0;\n+    {\n+      error (\"invalid function declaration\");\n+      return 0;\n+    }\n \n   if (DECL_MAIN_P (decl1))\n     /* main must return int.  grokfndecl should have corrected it"}, {"sha": "28df5ac74e560d8eb31051474eca82533a088712", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "patch": "@@ -1,5 +1,8 @@\n 2009-01-12  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/38794\n+\t* g++.dg/parse/typedef9.C: New test.\n+\n \tPR tree-optimization/38807\n \t* gcc.c-torture/compile/pr38807.c: New test.\n "}, {"sha": "7788f781fb6bb7630461c8ff46de59ebc1660d05", "filename": "gcc/testsuite/g++.dg/parse/typedef9.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftypedef9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49f098f2566a36206d6aa17c2c4635b2bf8b8d80/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftypedef9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftypedef9.C?ref=49f098f2566a36206d6aa17c2c4635b2bf8b8d80", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/38794\n+// { dg-do compile }\n+\n+typedef void foo () {}\t// { dg-error \"invalid function declaration\" }\n+struct S\n+{\n+  typedef int bar (void) { return 0; } // { dg-error \"invalid member function declaration\" }\n+};"}]}