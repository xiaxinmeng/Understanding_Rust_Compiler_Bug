{"sha": "28b241764ff7466a8eacff6ebd766676ae998e9b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjhiMjQxNzY0ZmY3NDY2YThlYWNmZjZlYmQ3NjY2NzZhZTk5OGU5Yg==", "commit": {"author": {"name": "Kazu Hirata", "email": "kazu@cs.umass.edu", "date": "2004-01-28T05:27:12Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2004-01-28T05:27:12Z"}, "message": "c4x.c (TARGET_ASM_EXTERNAL_LIBCALL): New.\n\n\t* config/c4x/c4x.c (TARGET_ASM_EXTERNAL_LIBCALL): New.\n\t(TARGET_STRUCT_VALUE_RTX): Likewise.\n\t(c4x_external_libcall): Likewise.\n\t(c4x_struct_value_rtx): Likewise.\n\t* config/c4x/c4x.h: Remove.\n\t(STRUCT_VALUE_REGNUM): Likewise.\n\t(ASM_OUTPUT_EXTERNAL_LIBCALL): Likewise.\n\nFrom-SVN: r76779", "tree": {"sha": "f6c26b6e59e668c476ca9ee9e210d54f8373f7d2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f6c26b6e59e668c476ca9ee9e210d54f8373f7d2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/28b241764ff7466a8eacff6ebd766676ae998e9b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28b241764ff7466a8eacff6ebd766676ae998e9b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/28b241764ff7466a8eacff6ebd766676ae998e9b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28b241764ff7466a8eacff6ebd766676ae998e9b/comments", "author": null, "committer": null, "parents": [{"sha": "9184f8921b86b372e5dfef4097af21fa2f4ea26f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9184f8921b86b372e5dfef4097af21fa2f4ea26f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9184f8921b86b372e5dfef4097af21fa2f4ea26f"}], "stats": {"total": 48, "additions": 38, "deletions": 10}, "files": [{"sha": "ea276203497380cb1b1645213b51166036857368", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28b241764ff7466a8eacff6ebd766676ae998e9b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28b241764ff7466a8eacff6ebd766676ae998e9b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=28b241764ff7466a8eacff6ebd766676ae998e9b", "patch": "@@ -1,3 +1,13 @@\n+2004-01-28  Kazu Hirata  <kazu@cs.umass.edu>\n+\n+\t* config/c4x/c4x.c (TARGET_ASM_EXTERNAL_LIBCALL): New.\n+\t(TARGET_STRUCT_VALUE_RTX): Likewise.\n+\t(c4x_external_libcall): Likewise.\n+\t(c4x_struct_value_rtx): Likewise.\n+\t* config/c4x/c4x.h: Remove.\n+\t(STRUCT_VALUE_REGNUM): Likewise.\n+\t(ASM_OUTPUT_EXTERNAL_LIBCALL): Likewise.\n+\n 2004-01-28  Kazu Hirata  <kazu@cs.umass.edu>\n \n \t* config/i386/i386.c (TARGET_PROMOTE_PROTOTYPES): New."}, {"sha": "b389296f13b9aef8cee8aebfd9dc74fa8312c3b6", "filename": "gcc/config/c4x/c4x.c", "status": "modified", "additions": 27, "deletions": 1, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28b241764ff7466a8eacff6ebd766676ae998e9b/gcc%2Fconfig%2Fc4x%2Fc4x.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28b241764ff7466a8eacff6ebd766676ae998e9b/gcc%2Fconfig%2Fc4x%2Fc4x.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc4x%2Fc4x.c?ref=28b241764ff7466a8eacff6ebd766676ae998e9b", "patch": "@@ -1,5 +1,5 @@\n /* Subroutines for assembler code output on the TMS320C[34]x\n-   Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2003\n+   Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004\n    Free Software Foundation, Inc.\n \n    Contributed by Michael Hayes (m.hayes@elec.canterbury.ac.nz)\n@@ -200,6 +200,8 @@ static void c4x_globalize_label (FILE *, const char *);\n static bool c4x_rtx_costs (rtx, int, int, int *);\n static int c4x_address_cost (rtx);\n static void c4x_init_libfuncs (void);\n+static void c4x_external_libcall (rtx);\n+static rtx c4x_struct_value_rtx (tree, int);\n \f\n /* Initialize the GCC target structure.  */\n #undef TARGET_ASM_BYTE_OP\n@@ -215,6 +217,9 @@ static void c4x_init_libfuncs (void);\n #undef TARGET_ASM_FILE_END\n #define TARGET_ASM_FILE_END c4x_file_end\n \n+#undef TARGET_ASM_EXTERNAL_LIBCALL\n+#define TARGET_ASM_EXTERNAL_LIBCALL c4x_external_libcall\n+\n #undef TARGET_ATTRIBUTE_TABLE\n #define TARGET_ATTRIBUTE_TABLE c4x_attribute_table\n \n@@ -244,6 +249,9 @@ static void c4x_init_libfuncs (void);\n #undef TARGET_INIT_LIBFUNCS\n #define TARGET_INIT_LIBFUNCS c4x_init_libfuncs\n \n+#undef TARGET_STRUCT_VALUE_RTX\n+#define TARGET_STRUCT_VALUE_RTX c4x_struct_value_rtx\n+\n struct gcc_target targetm = TARGET_INITIALIZER;\n \f\n /* Override command line options.\n@@ -5017,3 +5025,21 @@ c4x_rtx_costs (rtx x, int code, int outer_code, int *total)\n       return false;\n     }\n }\n+\f\n+/* Worker function for TARGET_ASM_EXTERNAL_LIBCALL.  */\n+\n+static void\n+c4x_external_libcall (rtx fun)\n+{\n+  /* This is only needed to keep asm30 happy for ___divqf3 etc.  */\n+  c4x_external_ref (XSTR (fun, 0));\n+}\n+\n+/* Worker function for TARGET_STRUCT_VALUE_RTX.  */\n+\n+static rtx\n+c4x_struct_value_rtx (tree fntype ATTRIBUTE_UNUSED,\n+\t\t      int incoming ATTRIBUTE_UNUSED)\n+{\n+  return gen_rtx_REG (Pmode, AR0_REGNO);\n+}"}, {"sha": "66e5edf82a4b4dce26549f80020bbf3636cb93f8", "filename": "gcc/config/c4x/c4x.h", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28b241764ff7466a8eacff6ebd766676ae998e9b/gcc%2Fconfig%2Fc4x%2Fc4x.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28b241764ff7466a8eacff6ebd766676ae998e9b/gcc%2Fconfig%2Fc4x%2Fc4x.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc4x%2Fc4x.h?ref=28b241764ff7466a8eacff6ebd766676ae998e9b", "patch": "@@ -1,6 +1,6 @@\n /* Definitions of target machine for GNU compiler.  TMS320C[34]x\n    Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,\n-   2003 Free Software Foundation, Inc.\n+   2003, 2004 Free Software Foundation, Inc.\n \n    Contributed by Michael Hayes (m.hayes@elec.canterbury.ac.nz)\n               and Herman Ten Brugge (Haj.Ten.Brugge@net.HCC.nl).\n@@ -1161,7 +1161,6 @@ CUMULATIVE_ARGS;\n /* How Large Values Are Returned.  */\n \n #define DEFAULT_PCC_STRUCT_RETURN\t0\n-#define STRUCT_VALUE_REGNUM\t\tAR0_REGNO\t/* AR0.  */\n \n /* Varargs handling.  */\n \n@@ -1491,13 +1490,6 @@ fini_section ()\t\t\t\t\t\t\t\\\n #define ASM_OUTPUT_EXTERNAL(FILE, DECL, NAME) \\\n c4x_external_ref (NAME)\n \n-/* A C statement to output on FILE an assembler pseudo-op to\n-   declare a library function named external.\n-   (Only needed to keep asm30 happy for ___divqf3 etc.)  */\n-\n-#define ASM_OUTPUT_EXTERNAL_LIBCALL(FILE, FUN) \\\n-c4x_external_ref (XSTR (FUN, 0))\n-\n /* The prefix to add to user-visible assembler symbols.  */\n \n #define USER_LABEL_PREFIX \"_\""}]}