{"sha": "006fbbe9526698a7828023b6710acc478b845e18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDA2ZmJiZTk1MjY2OThhNzgyODAyM2I2NzEwYWNjNDc4Yjg0NWUxOA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-05-02T18:15:56Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-05-02T18:15:56Z"}, "message": "re PR c++/68374 (G++ -Wshadow doesn't warn about static member shadowing)\n\n/cp\n2018-05-02  Paolo Carlini  <paolo.carlini@oracle.com>\n\t    Jason Merrill  <jason@redhat.com>\n\n\tPR c++/68374\n\t* name-lookup.c (check_local_shadow): Don't handle static old\n\tdeclarations in the block handling locals shadowing locals.\n\n/testsuite\n2018-05-02  Paolo Carlini  <paolo.carlini@oracle.com>\n\t    Jason Merrill  <jason@redhat.com>\n\n\tPR c++/68374\n\t* g++.dg/warn/Wshadow-13.C: New.\n\t* g++.dg/warn/Wshadow-14.C: Likewise.\n\nCo-Authored-By: Jason Merrill <jason@redhat.com>\n\nFrom-SVN: r259853", "tree": {"sha": "d3e68caa1c7827bfd632233231decc845612dd17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d3e68caa1c7827bfd632233231decc845612dd17"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/006fbbe9526698a7828023b6710acc478b845e18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/006fbbe9526698a7828023b6710acc478b845e18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/006fbbe9526698a7828023b6710acc478b845e18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/006fbbe9526698a7828023b6710acc478b845e18/comments", "author": null, "committer": null, "parents": [{"sha": "ec00d3faf4e3d20906e8e6038299343f960dc49e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec00d3faf4e3d20906e8e6038299343f960dc49e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec00d3faf4e3d20906e8e6038299343f960dc49e"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "fadcea80a94f865dc03a565b1098de71fc1fcd9e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=006fbbe9526698a7828023b6710acc478b845e18", "patch": "@@ -1,3 +1,10 @@\n+2018-05-02  Paolo Carlini  <paolo.carlini@oracle.com>\n+\t    Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/68374\n+\t* name-lookup.c (check_local_shadow): Don't handle static old\n+\tdeclarations in the block handling locals shadowing locals.\n+\n 2018-05-01  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/85587 - error with scoped enum in template."}, {"sha": "08cabd68a848d8af65e52bb4190829ffa50e9753", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=006fbbe9526698a7828023b6710acc478b845e18", "patch": "@@ -2642,6 +2642,7 @@ check_local_shadow (tree decl)\n \t  || (TREE_CODE (old) == TYPE_DECL\n \t      && (!DECL_ARTIFICIAL (old)\n \t\t  || TREE_CODE (decl) == TYPE_DECL)))\n+      && DECL_FUNCTION_SCOPE_P (old)\n       && (!DECL_ARTIFICIAL (decl)\n \t  || DECL_IMPLICIT_TYPEDEF_P (decl)\n \t  || (VAR_P (decl) && DECL_ANON_UNION_VAR_P (decl))))"}, {"sha": "6ddb945c70e60c92eab1bd260d5784547855e20a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=006fbbe9526698a7828023b6710acc478b845e18", "patch": "@@ -1,3 +1,10 @@\n+2018-05-02  Paolo Carlini  <paolo.carlini@oracle.com>\n+\t    Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/68374\n+\t* g++.dg/warn/Wshadow-13.C: New.\n+\t* g++.dg/warn/Wshadow-14.C: Likewise.\n+\n 2018-05-02  Tom de Vries  <tom@codesourcery.com>\n \n \tPR libgomp/82428"}, {"sha": "d75560c8e9ed14ab16ac22e9499835453fef6741", "filename": "gcc/testsuite/g++.dg/warn/Wshadow-13.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWshadow-13.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWshadow-13.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWshadow-13.C?ref=006fbbe9526698a7828023b6710acc478b845e18", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/68374\n+// { dg-options \"-Wshadow\" }\n+\n+class f {\n+  static int mVar;  // { dg-message \"shadowed declaration\" }\n+  int g(int x) { int mVar=3; return x+mVar; }  // { dg-warning \"shadows a member of 'f'\" }\n+};\n+int f::mVar = 1;"}, {"sha": "e0e3d029291c33e0aabd4aed8354627cc2055a22", "filename": "gcc/testsuite/g++.dg/warn/Wshadow-14.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWshadow-14.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/006fbbe9526698a7828023b6710acc478b845e18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWshadow-14.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWshadow-14.C?ref=006fbbe9526698a7828023b6710acc478b845e18", "patch": "@@ -0,0 +1,10 @@\n+// PR c++/68374\n+// { dg-options \"-Wshadow\" }\n+\n+void foo ()\n+{\n+  static int i;  // { dg-message \"shadowed declaration\" }\n+  {\n+    int i;  // { dg-warning \"shadows a previous local\" }\n+  }\n+}"}]}