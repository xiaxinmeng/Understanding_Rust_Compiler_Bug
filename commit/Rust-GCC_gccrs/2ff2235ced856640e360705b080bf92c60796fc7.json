{"sha": "2ff2235ced856640e360705b080bf92c60796fc7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmZmMjIzNWNlZDg1NjY0MGUzNjA3MDViMDgwYmY5MmM2MDc5NmZjNw==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2009-05-06T21:31:56Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2009-05-06T21:31:56Z"}, "message": "re PR testsuite/40050 (plugin tests don't work with multilib)\n\n2009-05-06  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR testsuite/40050\n\t* lib/plugin-support.exp (plugin-test-execute): Use HOSTCC to\n\tbuild plugin.\n\nFrom-SVN: r147208", "tree": {"sha": "ab7fca9e06efa7e8ba3ab5e0e4c764fa6728fe6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab7fca9e06efa7e8ba3ab5e0e4c764fa6728fe6a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2ff2235ced856640e360705b080bf92c60796fc7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ff2235ced856640e360705b080bf92c60796fc7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ff2235ced856640e360705b080bf92c60796fc7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ff2235ced856640e360705b080bf92c60796fc7/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e84efdce90dc7025317e9646ec43638e0fd2c9ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e84efdce90dc7025317e9646ec43638e0fd2c9ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e84efdce90dc7025317e9646ec43638e0fd2c9ed"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "08c7a9a739067bac57ab16a8aefbd89c72808498", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2ff2235ced856640e360705b080bf92c60796fc7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2ff2235ced856640e360705b080bf92c60796fc7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2ff2235ced856640e360705b080bf92c60796fc7", "patch": "@@ -1,3 +1,9 @@\n+2009-05-06  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR testsuite/40050\n+\t* lib/plugin-support.exp (plugin-test-execute): Use HOSTCC to\n+\tbuild plugin.\n+\n 2009-05-06  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/39630"}, {"sha": "79ccc93ba7579e29248563e1a73a09c67563ef76", "filename": "gcc/testsuite/lib/plugin-support.exp", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2ff2235ced856640e360705b080bf92c60796fc7/gcc%2Ftestsuite%2Flib%2Fplugin-support.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2ff2235ced856640e360705b080bf92c60796fc7/gcc%2Ftestsuite%2Flib%2Fplugin-support.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fplugin-support.exp?ref=2ff2235ced856640e360705b080bf92c60796fc7", "patch": "@@ -63,6 +63,8 @@ proc plugin-test-execute { plugin_src plugin_tests } {\n     global srcdir objdir\n     global verbose\n     global GMPINC\n+    global HOSTCC\n+    global HOSTCFLAGS\n \n     set basename [file tail $plugin_src]\n     set base [file rootname $basename]\n@@ -86,8 +88,13 @@ proc plugin-test-execute { plugin_src plugin_tests } {\n \n     set optstr \"$includes $extra_flags -DIN_GCC -fPIC -shared\"\n \n-    set status [target_compile \"$optstr $plugin_src\" \"$plugin_lib\" executable \"\"]\n-    if { \"$status\" != \"\" } {\n+    # Temporarily switch to the environment for the host compiler.\n+    restore_ld_library_path_env_vars\n+    set status [remote_exec build \"$HOSTCC $HOSTCFLAGS $plugin_src $optstr -o $plugin_lib\"]\n+    set status [lindex $status 0]\n+    set_ld_library_path_env_vars\n+\n+    if { $status != 0 } then {\n  \tunresolved \"$basename compilation, $optstr\"\n  \treturn\n     }"}]}