{"sha": "bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee", "node_id": "C_kwDOANBUbNoAKGJkZDc4NGZjNDhhMjgzZDU0ZjVmMWUzY2MyYTA2NjhjMTRkZDNiZWU", "commit": {"author": {"name": "Steve Kargl", "email": "kargl@gcc.gnu.org", "date": "2022-11-16T21:46:55Z"}, "committer": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2022-11-16T21:50:51Z"}, "message": "Fortran: ICE on procedure arguments with non-integer length [PR107707]\n\ngcc/fortran/ChangeLog:\n\n\tPR fortran/107707\n\t* interface.cc (gfc_compare_actual_formal): Check that we actually\n\thave integer values before asking gmp_* to use them.\n\ngcc/testsuite/ChangeLog:\n\n\tPR fortran/107707\n\t* gfortran.dg/pr107707.f90: New test.", "tree": {"sha": "2486f15886151bd3db9467c34b8ab6f967b3347f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2486f15886151bd3db9467c34b8ab6f967b3347f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee/comments", "author": null, "committer": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c85f8dbb173f45053f6d8849d27adc98d9668769", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c85f8dbb173f45053f6d8849d27adc98d9668769", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c85f8dbb173f45053f6d8849d27adc98d9668769"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "616ae2b11973ad1db2a9fc9f089a253d3b14444d", "filename": "gcc/fortran/interface.cc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee/gcc%2Ffortran%2Finterface.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee/gcc%2Ffortran%2Finterface.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finterface.cc?ref=bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee", "patch": "@@ -3273,9 +3273,11 @@ gfc_compare_actual_formal (gfc_actual_arglist **ap, gfc_formal_arglist *formal,\n       if (a->expr->ts.type == BT_CHARACTER\n \t  && a->expr->ts.u.cl && a->expr->ts.u.cl->length\n \t  && a->expr->ts.u.cl->length->expr_type == EXPR_CONSTANT\n+\t  && a->expr->ts.u.cl->length->ts.type == BT_INTEGER\n \t  && f->sym->ts.type == BT_CHARACTER && f->sym->ts.u.cl\n \t  && f->sym->ts.u.cl->length\n \t  && f->sym->ts.u.cl->length->expr_type == EXPR_CONSTANT\n+\t  && f->sym->ts.u.cl->length->ts.type == BT_INTEGER\n \t  && (f->sym->attr.pointer || f->sym->attr.allocatable\n \t      || (f->sym->as && f->sym->as->type == AS_ASSUMED_SHAPE))\n \t  && (mpz_cmp (a->expr->ts.u.cl->length->value.integer,"}, {"sha": "a8be2b5b2992eb2252c1879b90dd998d32212067", "filename": "gcc/testsuite/gfortran.dg/pr107707.f90", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr107707.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr107707.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr107707.f90?ref=bdd784fc48a283d54f5f1e3cc2a0668c14dd3bee", "patch": "@@ -0,0 +1,13 @@\n+! { dg-do compile }\n+! PR fortran/107707 - ICE in gfc_compare_actual_formal\n+! Contributed by G.Steinmetz\n+\n+program p\n+  character(3), allocatable :: c\n+  c = 'abc'\n+  call s(c)\n+contains\n+  subroutine s(x)\n+    character(real(3)), allocatable :: x ! { dg-error \"must be of INTEGER type\" }\n+  end\n+end"}]}