{"sha": "663e6d7960199559ebd3107a28ea1cfda3e5be00", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjYzZTZkNzk2MDE5OTU1OWViZDMxMDdhMjhlYTFjZmRhM2U1YmUwMA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2021-02-21T17:27:25Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-06-16T08:42:59Z"}, "message": "[Ada] Use more straightforward implementation for Current_Entity_In_Scope\n\ngcc/ada/\n\n\t* sem_util.adb (Current_Entity_In_Scope): Reimplement.", "tree": {"sha": "adccdbdaf9d9dd4293ec53298b66a1240b6e4fb1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/adccdbdaf9d9dd4293ec53298b66a1240b6e4fb1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/663e6d7960199559ebd3107a28ea1cfda3e5be00", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/663e6d7960199559ebd3107a28ea1cfda3e5be00", "html_url": "https://github.com/Rust-GCC/gccrs/commit/663e6d7960199559ebd3107a28ea1cfda3e5be00", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/663e6d7960199559ebd3107a28ea1cfda3e5be00/comments", "author": null, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e07c2df705ca3e8be98c708773e450e0543480b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e07c2df705ca3e8be98c708773e450e0543480b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e07c2df705ca3e8be98c708773e450e0543480b"}], "stats": {"total": 27, "additions": 19, "deletions": 8}, "files": [{"sha": "9b2bf86e94e20af8223684f9019acf150bb2af21", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 19, "deletions": 8, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/663e6d7960199559ebd3107a28ea1cfda3e5be00/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/663e6d7960199559ebd3107a28ea1cfda3e5be00/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=663e6d7960199559ebd3107a28ea1cfda3e5be00", "patch": "@@ -6955,19 +6955,30 @@ package body Sem_Util is\n    -----------------------------\n \n    function Current_Entity_In_Scope (N : Name_Id) return Entity_Id is\n-      E  : Entity_Id;\n       CS : constant Entity_Id := Current_Scope;\n \n-      Transient_Case : constant Boolean := Scope_Is_Transient;\n+      E  : Entity_Id;\n \n    begin\n       E := Get_Name_Entity_Id (N);\n-      while Present (E)\n-        and then Scope (E) /= CS\n-        and then (not Transient_Case or else Scope (E) /= Scope (CS))\n-      loop\n-         E := Homonym (E);\n-      end loop;\n+\n+      if No (E) then\n+         null;\n+\n+      elsif Scope_Is_Transient then\n+         while Present (E) loop\n+            exit when Scope (E) = CS or else Scope (E) = Scope (CS);\n+\n+            E := Homonym (E);\n+         end loop;\n+\n+      else\n+         while Present (E) loop\n+            exit when Scope (E) = CS;\n+\n+            E := Homonym (E);\n+         end loop;\n+      end if;\n \n       return E;\n    end Current_Entity_In_Scope;"}]}