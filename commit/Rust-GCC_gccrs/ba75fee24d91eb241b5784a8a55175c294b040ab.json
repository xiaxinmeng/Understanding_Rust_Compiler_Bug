{"sha": "ba75fee24d91eb241b5784a8a55175c294b040ab", "node_id": "C_kwDOANBUbNoAKGJhNzVmZWUyNGQ5MWViMjQxYjU3ODRhOGE1NTE3NWMyOTRiMDQwYWI", "commit": {"author": {"name": "Gary Dismukes", "email": "dismukes@adacore.com", "date": "2022-03-04T22:19:18Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2022-05-13T08:04:46Z"}, "message": "[Ada] Storage_Model_Object fails to return object entity\n\nAfter a compilation unit containing a Designated_Storage_Model aspect\nwas processed by the compiler front end, the aspect's expression was\nseen as not having been analyzed. In some cases this can lead to the\nStorage_Model_Object function not returning the entity of the associated\nmodel object (such as when the model object is specified using an\nexpanded name). This was due to a second copy of the aspect's expression\nbeing made in Check_Aspect_At_Freeze_Point, and that copy wasn't\nanalyzed, even though the earlier version of the expression prior to\nthat copy had been. (The copy is needed for proper checking of Ada's\nrules for ensuring that certain aspect expressions resolve the same way\nat the freeze point and later at the end of the declarations.) This is\ncorrected by doing analysis of the new aspect expression within\nCheck_Aspect_At_Freeze_Point, as is already done in that procedure in\nthe case of several other aspects.\n\ngcc/ada/\n\n\t* sem_ch13.adb (Check_Aspect_At_Freeze_Point): Analyze the\n\texpression of the aspect at this point, like other aspects that\n\tdenote simple entities. Ensures that function\n\tStorage_Model_Object will have an entity to retrieve from the\n\taspect expression. Also, move comment about aspects that don't\n\trequire delay analysis in front of last alternative of the case\n\tstatement, where it's supposed to be.", "tree": {"sha": "21db74f5a2c04e6cb017b574c6ed529d1404ad1e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/21db74f5a2c04e6cb017b574c6ed529d1404ad1e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ba75fee24d91eb241b5784a8a55175c294b040ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba75fee24d91eb241b5784a8a55175c294b040ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba75fee24d91eb241b5784a8a55175c294b040ab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba75fee24d91eb241b5784a8a55175c294b040ab/comments", "author": {"login": "dismukes", "id": 50880541, "node_id": "MDQ6VXNlcjUwODgwNTQx", "avatar_url": "https://avatars.githubusercontent.com/u/50880541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dismukes", "html_url": "https://github.com/dismukes", "followers_url": "https://api.github.com/users/dismukes/followers", "following_url": "https://api.github.com/users/dismukes/following{/other_user}", "gists_url": "https://api.github.com/users/dismukes/gists{/gist_id}", "starred_url": "https://api.github.com/users/dismukes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dismukes/subscriptions", "organizations_url": "https://api.github.com/users/dismukes/orgs", "repos_url": "https://api.github.com/users/dismukes/repos", "events_url": "https://api.github.com/users/dismukes/events{/privacy}", "received_events_url": "https://api.github.com/users/dismukes/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d663778287d3bd908b5e059f640ca6a02bb0f487", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d663778287d3bd908b5e059f640ca6a02bb0f487", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d663778287d3bd908b5e059f640ca6a02bb0f487"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "61f7ba78a94e1dc8420487a5ffdb264e29bc49ee", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba75fee24d91eb241b5784a8a55175c294b040ab/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba75fee24d91eb241b5784a8a55175c294b040ab/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=ba75fee24d91eb241b5784a8a55175c294b040ab", "patch": "@@ -11359,9 +11359,11 @@ package body Sem_Ch13 is\n          when Aspect_Predicate_Failure =>\n             T := Standard_String;\n \n-         --  Here is the list of aspects that don't require delay analysis\n+         --  As for some other aspects above, the expression of this aspect is\n+         --  just an entity that does not need any resolution, so just analyze.\n \n          when Aspect_Designated_Storage_Model =>\n+            Analyze (Expression (ASN));\n             return;\n \n          when Aspect_Storage_Model_Type =>\n@@ -11389,6 +11391,8 @@ package body Sem_Ch13 is\n \n             return;\n \n+         --  Here is the list of aspects that don't require delay analysis\n+\n          when Aspect_Abstract_State\n             | Aspect_Annotate\n             | Aspect_Async_Readers"}]}