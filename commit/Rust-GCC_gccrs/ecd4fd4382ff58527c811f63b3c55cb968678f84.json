{"sha": "ecd4fd4382ff58527c811f63b3c55cb968678f84", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWNkNGZkNDM4MmZmNTg1MjdjODExZjYzYjNjNTVjYjk2ODY3OGY4NA==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2015-10-26T16:24:54Z"}, "committer": {"name": "Thomas Schwinge", "email": "tschwinge@gcc.gnu.org", "date": "2015-10-26T16:24:54Z"}, "message": "libgomp testsuite: Remove some explicit acc_device_nvidia usage.\n\n\tlibgomp/\n\t* testsuite/libgomp.oacc-c-c++-common/lib-1.c: Remove explicit\n\tacc_device_nvidia usage.\n\t* testsuite/libgomp.oacc-c-c++-common/lib-10.c: Likewise.\n\t* testsuite/libgomp.oacc-c-c++-common/lib-2.c: Likewise.\n\t* testsuite/libgomp.oacc-c-c++-common/lib-9.c: Likewise.\n\nFrom-SVN: r229381", "tree": {"sha": "dcd0a55afdd0ec52a1b1cb6bec90d6feba7b6ed2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dcd0a55afdd0ec52a1b1cb6bec90d6feba7b6ed2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ecd4fd4382ff58527c811f63b3c55cb968678f84", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ecd4fd4382ff58527c811f63b3c55cb968678f84", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ecd4fd4382ff58527c811f63b3c55cb968678f84", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ecd4fd4382ff58527c811f63b3c55cb968678f84/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "aa8b7d3051adfdd4ed6ef875de5e8bbebd0746d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa8b7d3051adfdd4ed6ef875de5e8bbebd0746d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa8b7d3051adfdd4ed6ef875de5e8bbebd0746d7"}], "stats": {"total": 60, "additions": 18, "deletions": 42}, "files": [{"sha": "fa9027b14288ccc7fd6158db5614921f5196c453", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=ecd4fd4382ff58527c811f63b3c55cb968678f84", "patch": "@@ -1,5 +1,11 @@\n 2015-10-26  Thomas Schwinge  <thomas@codesourcery.com>\n \n+\t* testsuite/libgomp.oacc-c-c++-common/lib-1.c: Remove explicit\n+\tacc_device_nvidia usage.\n+\t* testsuite/libgomp.oacc-c-c++-common/lib-10.c: Likewise.\n+\t* testsuite/libgomp.oacc-c-c++-common/lib-2.c: Likewise.\n+\t* testsuite/libgomp.oacc-c-c++-common/lib-9.c: Likewise.\n+\n \t* oacc-init.c (acc_shutdown): Call gomp_init_targets_once.\n \t* testsuite/libgomp.oacc-c-c++-common/lib-8.c: New file.\n "}, {"sha": "8ed743d18d3d3d795b36a40865663902dcd758dc", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/lib-1.c", "status": "modified", "additions": 2, "deletions": 12, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-1.c?ref=ecd4fd4382ff58527c811f63b3c55cb968678f84", "patch": "@@ -6,19 +6,9 @@\n int\n main (int argc, char **argv)\n {\n-  acc_device_t devtype = acc_device_host;\n-\n-#if ACC_DEVICE_TYPE_nvidia\n-  devtype = acc_device_nvidia;\n-\n-  if (acc_get_num_devices (devtype) == 0)\n-    return 0;\n-#endif\n-\n-  acc_init (devtype);\n-\n+  acc_init (acc_device_default);\n   fprintf (stderr, \"CheCKpOInT\\n\");\n-  acc_init (devtype);\n+  acc_init (acc_device_default);\n \n   return 0;\n }"}, {"sha": "55054c00296f1c682b4f1c192618706e7884ccba", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/lib-10.c", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-10.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-10.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-10.c?ref=ecd4fd4382ff58527c811f63b3c55cb968678f84", "patch": "@@ -7,14 +7,7 @@ int\n main (int argc, char **argv)\n {\n   void *d;\n-  acc_device_t devtype = acc_device_host;\n-\n-#if ACC_DEVICE_TYPE_nvidia\n-  devtype = acc_device_nvidia;\n-\n-  if (acc_get_num_devices (acc_device_nvidia) == 0)\n-    return 0;\n-#endif\n+  acc_device_t devtype = acc_device_default;\n \n   acc_init (devtype);\n "}, {"sha": "353cd1c4d3198f4b02155c7501e88fec4e43e69f", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/lib-2.c", "status": "modified", "additions": 3, "deletions": 14, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-2.c?ref=ecd4fd4382ff58527c811f63b3c55cb968678f84", "patch": "@@ -6,21 +6,10 @@\n int\n main (int argc, char **argv)\n {\n-  acc_device_t devtype = acc_device_host;\n-\n-#if ACC_DEVICE_TYPE_nvidia\n-  devtype = acc_device_nvidia;\n-\n-  if (acc_get_num_devices (acc_device_nvidia) == 0)\n-    return 0;\n-#endif\n-\n-  acc_init (devtype);\n-\n-  acc_shutdown (devtype);\n-\n+  acc_init (acc_device_default);\n+  acc_shutdown (acc_device_default);\n   fprintf (stderr, \"CheCKpOInT\\n\");\n-  acc_shutdown (devtype);\n+  acc_shutdown (acc_device_default);\n \n   return 0;\n }"}, {"sha": "5dce9b820880f12386b98535a2a9ae074623f781", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/lib-9.c", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ecd4fd4382ff58527c811f63b3c55cb968678f84/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Flib-9.c?ref=ecd4fd4382ff58527c811f63b3c55cb968678f84", "patch": "@@ -9,18 +9,17 @@ main (int argc, char **argv)\n   int i;\n   int num_devices;\n   int devnum;\n-  acc_device_t devtype = acc_device_host;\n-\n-#if ACC_DEVICE_TYPE_nvidia\n-  devtype = acc_device_nvidia;\n-#endif\n+  acc_device_t devtype = acc_device_default;\n \n   num_devices = acc_get_num_devices (devtype);\n   if (num_devices == 0)\n-    return 0;\n+    abort ();\n \n   acc_init (devtype);\n \n+  if (num_devices != acc_get_num_devices (devtype))\n+    abort ();\n+\n   for (i = 0; i < num_devices; i++)\n     {\n       acc_set_device_num (i, devtype);\n@@ -31,8 +30,7 @@ main (int argc, char **argv)\n \n   acc_shutdown (devtype);\n \n-  num_devices = acc_get_num_devices (devtype);\n-  if (num_devices == 0)\n+  if (num_devices != acc_get_num_devices (devtype))\n     abort ();\n \n   for (i = 0; i < num_devices; i++)"}]}