{"sha": "90b725f0b08694778e4a10c45008d244342998d2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTBiNzI1ZjBiMDg2OTQ3NzhlNGExMGM0NTAwOGQyNDQzNDI5OThkMg==", "commit": {"author": {"name": "Peter Bergner", "email": "bergner@vnet.ibm.com", "date": "2016-11-24T02:07:51Z"}, "committer": {"name": "Peter Bergner", "email": "bergner@gcc.gnu.org", "date": "2016-11-24T02:07:51Z"}, "message": "re PR target/78458 (LRA ICE building libgcc for powerpc-linux-gnuspe e500v2)\n\ngcc/\n\tPR target/78458\n\t* config/rs6000/rs6000.h (HARD_REGNO_CALLER_SAVE_MODE): Return MODE\n\tif it is at least NREGS wide.\n\ngcc/testsuite/\n\tPR target/78458\n\t* gcc.target/powerpc/pr78458.c: New.\n\nFrom-SVN: r242818", "tree": {"sha": "e991ad6bd801ab49453f588872d64804afbe08da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e991ad6bd801ab49453f588872d64804afbe08da"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/90b725f0b08694778e4a10c45008d244342998d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90b725f0b08694778e4a10c45008d244342998d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90b725f0b08694778e4a10c45008d244342998d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90b725f0b08694778e4a10c45008d244342998d2/comments", "author": {"login": "peter-bergner", "id": 17504345, "node_id": "MDQ6VXNlcjE3NTA0MzQ1", "avatar_url": "https://avatars.githubusercontent.com/u/17504345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peter-bergner", "html_url": "https://github.com/peter-bergner", "followers_url": "https://api.github.com/users/peter-bergner/followers", "following_url": "https://api.github.com/users/peter-bergner/following{/other_user}", "gists_url": "https://api.github.com/users/peter-bergner/gists{/gist_id}", "starred_url": "https://api.github.com/users/peter-bergner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peter-bergner/subscriptions", "organizations_url": "https://api.github.com/users/peter-bergner/orgs", "repos_url": "https://api.github.com/users/peter-bergner/repos", "events_url": "https://api.github.com/users/peter-bergner/events{/privacy}", "received_events_url": "https://api.github.com/users/peter-bergner/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "890a4eb0560520fe2093aef9b62067b7ee8816c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/890a4eb0560520fe2093aef9b62067b7ee8816c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/890a4eb0560520fe2093aef9b62067b7ee8816c7"}], "stats": {"total": 34, "additions": 31, "deletions": 3}, "files": [{"sha": "71ce3f6a8c2fdea944058d9c472e0061944ef7de", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b725f0b08694778e4a10c45008d244342998d2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b725f0b08694778e4a10c45008d244342998d2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=90b725f0b08694778e4a10c45008d244342998d2", "patch": "@@ -1,3 +1,9 @@\n+2016-11-23  Peter Bergner  <bergner@vnet.ibm.com>\n+\n+\tPR target/78458\n+\t* config/rs6000/rs6000.h (HARD_REGNO_CALLER_SAVE_MODE): Return MODE\n+\tif it is at least NREGS wide.\n+\n 2016-11-23  Joseph Myers  <joseph@codesourcery.com>\n \n \t* config/rs6000/rs6000.c (rs6000_legitimate_offset_address_p): For"}, {"sha": "d1e36d96003d35743d2a8fa36f0e9b4c930ca95d", "filename": "gcc/config/rs6000/rs6000.h", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b725f0b08694778e4a10c45008d244342998d2/gcc%2Fconfig%2Frs6000%2Frs6000.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b725f0b08694778e4a10c45008d244342998d2/gcc%2Fconfig%2Frs6000%2Frs6000.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.h?ref=90b725f0b08694778e4a10c45008d244342998d2", "patch": "@@ -1279,9 +1279,11 @@ enum data_align { align_abi, align_opt, align_both };\n    enough space to account for vectors in FP regs.  However, TFmode/TDmode\n    should not use VSX instructions to do a caller save. */\n #define HARD_REGNO_CALLER_SAVE_MODE(REGNO, NREGS, MODE)\t\t\t\\\n-  (TARGET_VSX\t\t\t\t\t\t\t\t\\\n-   && ((MODE) == VOIDmode || ALTIVEC_OR_VSX_VECTOR_MODE (MODE))\t\t\\\n-   && FP_REGNO_P (REGNO)\t\t\t\t\t\t\\\n+  ((NREGS) <= rs6000_hard_regno_nregs[MODE][REGNO]\t\t\t\\\n+   ? (MODE)\t\t\t\t\t\t\t\t\\\n+   : TARGET_VSX\t\t\t\t\t\t\t\t\\\n+     && ((MODE) == VOIDmode || ALTIVEC_OR_VSX_VECTOR_MODE (MODE))\t\\\n+     && FP_REGNO_P (REGNO)\t\t\t\t\t\t\\\n    ? V2DFmode\t\t\t\t\t\t\t\t\\\n    : TARGET_E500_DOUBLE && (MODE) == SImode\t\t\t\t\\\n    ? SImode\t\t\t\t\t\t\t\t\\"}, {"sha": "831ca5e4cedcd8f34072c1a051c50dd2c5640fef", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b725f0b08694778e4a10c45008d244342998d2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b725f0b08694778e4a10c45008d244342998d2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=90b725f0b08694778e4a10c45008d244342998d2", "patch": "@@ -1,3 +1,8 @@\n+2016-11-23  Peter Bergner  <bergner@vnet.ibm.com>\n+\n+\tPR target/78458\n+\t* gcc.target/powerpc/pr78458.c: New.\n+\n 2016-11-23  Joseph Myers  <joseph@codesourcery.com>\n \n \t* gcc.c-torture/compile/20161123-1.c: New test."}, {"sha": "777ac43bcadcf38df58a1584dc831bbd1266ea27", "filename": "gcc/testsuite/gcc.target/powerpc/pr78458.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90b725f0b08694778e4a10c45008d244342998d2/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr78458.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90b725f0b08694778e4a10c45008d244342998d2/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr78458.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr78458.c?ref=90b725f0b08694778e4a10c45008d244342998d2", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-mcpu=8548 -mspe -mabi=spe -mlra\" } */\n+/* { dg-skip-if \"not an SPE target\" { ! powerpc_spe_nocache } } */\n+\n+extern void bar (void);\n+long double\n+pr78458 (long double p1)\n+{\n+  bar ();\n+  asm volatile (\"# clobbers\" :::\n+\t\t\"r14\", \"r15\", \"r16\", \"r17\", \"r18\", \"r19\",\n+\t\t\"r20\", \"r21\", \"r22\", \"r23\", \"r24\", \"r25\",\n+\t\t\"r26\", \"r27\", \"r28\", \"r29\", \"r30\", \"r31\");\n+  return p1;\n+}"}]}