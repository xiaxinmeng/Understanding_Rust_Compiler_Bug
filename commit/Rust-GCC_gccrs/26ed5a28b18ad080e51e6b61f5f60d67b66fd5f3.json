{"sha": "26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjZlZDVhMjhiMThhZDA4MGU1MWU2YjYxZjVmNjBkNjdiNjZmZDVmMw==", "commit": {"author": {"name": "David Edelsohn", "email": "dje.gcc@gmail.com", "date": "2021-03-11T16:41:24Z"}, "committer": {"name": "David Edelsohn", "email": "dje.gcc@gmail.com", "date": "2021-03-11T21:57:24Z"}, "message": "aix: Use lcomm for TLS static data.\n\nGCC on AIX generates thread local uninitialized data in the common section,\nwhich could conflict with another module.\n\nThis patch changes the code generation to place static uninitialized\nthread local data into the local common section specified with .lcomm.\nThis change also removes the need to create a file-local name for the TBSS\ndata.\n\ngcc/ChangeLog:\n\n2021-03-11  David Edelsohn  <dje.gcc@gmail.com>\n\n\tPR target/99094\n\t* config/rs6000/rs6000.c (rs6000_xcoff_file_start): Don't create\n\txcoff_tbss_section_name.\n\t* config/rs6000/xcoff.h (ASM_OUTPUT_TLS_COMMON): Use .lcomm.\n\t* xcoffout.c (xcoff_tbss_section_name): Delete.\n\t* xcoffout.h (xcoff_tbss_section_name): Delete.", "tree": {"sha": "ab6a6446ec82563c42ec69cad070a80e2e4638db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab6a6446ec82563c42ec69cad070a80e2e4638db"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/comments", "author": {"login": "edelsohn", "id": 667700, "node_id": "MDQ6VXNlcjY2NzcwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/667700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edelsohn", "html_url": "https://github.com/edelsohn", "followers_url": "https://api.github.com/users/edelsohn/followers", "following_url": "https://api.github.com/users/edelsohn/following{/other_user}", "gists_url": "https://api.github.com/users/edelsohn/gists{/gist_id}", "starred_url": "https://api.github.com/users/edelsohn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edelsohn/subscriptions", "organizations_url": "https://api.github.com/users/edelsohn/orgs", "repos_url": "https://api.github.com/users/edelsohn/repos", "events_url": "https://api.github.com/users/edelsohn/events{/privacy}", "received_events_url": "https://api.github.com/users/edelsohn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "edelsohn", "id": 667700, "node_id": "MDQ6VXNlcjY2NzcwMA==", "avatar_url": "https://avatars.githubusercontent.com/u/667700?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edelsohn", "html_url": "https://github.com/edelsohn", "followers_url": "https://api.github.com/users/edelsohn/followers", "following_url": "https://api.github.com/users/edelsohn/following{/other_user}", "gists_url": "https://api.github.com/users/edelsohn/gists{/gist_id}", "starred_url": "https://api.github.com/users/edelsohn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edelsohn/subscriptions", "organizations_url": "https://api.github.com/users/edelsohn/orgs", "repos_url": "https://api.github.com/users/edelsohn/repos", "events_url": "https://api.github.com/users/edelsohn/events{/privacy}", "received_events_url": "https://api.github.com/users/edelsohn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5f27a9f90d4eadadf937f1a5d0bfccf39261f330", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f27a9f90d4eadadf937f1a5d0bfccf39261f330", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f27a9f90d4eadadf937f1a5d0bfccf39261f330"}], "stats": {"total": 14, "additions": 5, "deletions": 9}, "files": [{"sha": "46ddf49d34bebe526bba7ad621571fbb1d427da8", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "patch": "@@ -21261,8 +21261,6 @@ rs6000_xcoff_file_start (void)\n \t\t\t   main_input_filename, \".ro_\");\n   rs6000_gen_section_name (&xcoff_tls_data_section_name,\n \t\t\t   main_input_filename, \".tls_\");\n-  rs6000_gen_section_name (&xcoff_tbss_section_name,\n-\t\t\t   main_input_filename, \".tbss_[UL]\");\n \n   fputs (\"\\t.file\\t\", asm_out_file);\n   output_quoted_string (asm_out_file, main_input_filename);"}, {"sha": "cb9aae753b2b6ca1cf81d89c5129ec0e2bd8a102", "filename": "gcc/config/rs6000/xcoff.h", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fconfig%2Frs6000%2Fxcoff.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fconfig%2Frs6000%2Fxcoff.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fxcoff.h?ref=26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "patch": "@@ -255,11 +255,11 @@\n      } while (0)\n \n #ifdef HAVE_AS_TLS\n-#define ASM_OUTPUT_TLS_COMMON(FILE, DECL, NAME, SIZE)\t\\\n-  do { fputs (COMMON_ASM_OP, (FILE));\t\t\t\\\n-       RS6000_OUTPUT_BASENAME ((FILE), (NAME));\t\t\\\n-       fprintf ((FILE), \"[UL],\" HOST_WIDE_INT_PRINT_UNSIGNED\"\\n\", \\\n-       (SIZE));\t\t\t\t\t\t\\\n+#define ASM_OUTPUT_TLS_COMMON(FILE, DECL, NAME, SIZE)   \\\n+  do { fputs (LOCAL_COMMON_ASM_OP, (FILE));             \\\n+       fprintf ((FILE), \"%s,\" HOST_WIDE_INT_PRINT_UNSIGNED\",%s[UL],3\\n\", \\\n+\t\t(*targetm.strip_name_encoding) (NAME), (SIZE),\t\\\n+\t\t(*targetm.strip_name_encoding) (NAME));\t\\\n   } while (0)\n #endif\n "}, {"sha": "3dbea04ea5d21569ff6b3f609844fad4f6bab806", "filename": "gcc/xcoffout.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fxcoffout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fxcoffout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fxcoffout.c?ref=26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "patch": "@@ -66,7 +66,6 @@ char *xcoff_bss_section_name;\n char *xcoff_private_data_section_name;\n char *xcoff_private_rodata_section_name;\n char *xcoff_tls_data_section_name;\n-char *xcoff_tbss_section_name;\n char *xcoff_read_only_section_name;\n \n /* Last source file name mentioned in a NOTE insn.  */"}, {"sha": "ae6aee0af2abb24c18a706761854ac131518dcf3", "filename": "gcc/xcoffout.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fxcoffout.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3/gcc%2Fxcoffout.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fxcoffout.h?ref=26ed5a28b18ad080e51e6b61f5f60d67b66fd5f3", "patch": "@@ -129,7 +129,6 @@ extern char *xcoff_bss_section_name;\n extern char *xcoff_private_data_section_name;\n extern char *xcoff_private_rodata_section_name;\n extern char *xcoff_tls_data_section_name;\n-extern char *xcoff_tbss_section_name;\n extern char *xcoff_read_only_section_name;\n \n /* Last source file name mentioned in a NOTE insn.  */"}]}