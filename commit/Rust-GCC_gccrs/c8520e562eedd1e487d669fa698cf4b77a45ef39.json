{"sha": "c8520e562eedd1e487d669fa698cf4b77a45ef39", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzg1MjBlNTYyZWVkZDFlNDg3ZDY2OWZhNjk4Y2Y0Yjc3YTQ1ZWYzOQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2003-05-29T08:33:25Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2003-05-29T08:33:25Z"}, "message": "mips-protos.h (mips_output_load_label): Declare.\n\n\t* config/mips/mips-protos.h (mips_output_load_label): Declare.\n\t* config/mips/mips.c (mips_output_load_label): New function.\n\t(mips_output_conditional_branch): Use it.\n\t* config/mips/mips.md (jump): And here.\n\nFrom-SVN: r67220", "tree": {"sha": "f27432c7a64e8823b13fac7da771937ce39734ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f27432c7a64e8823b13fac7da771937ce39734ba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c8520e562eedd1e487d669fa698cf4b77a45ef39", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8520e562eedd1e487d669fa698cf4b77a45ef39", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8520e562eedd1e487d669fa698cf4b77a45ef39", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8520e562eedd1e487d669fa698cf4b77a45ef39/comments", "author": null, "committer": null, "parents": [{"sha": "39d85b61e34fb239650e78b2e276d234902274f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39d85b61e34fb239650e78b2e276d234902274f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39d85b61e34fb239650e78b2e276d234902274f5"}], "stats": {"total": 50, "additions": 43, "deletions": 7}, "files": [{"sha": "9e316929f6d67777d4260fe1b959a9dac4126f37", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c8520e562eedd1e487d669fa698cf4b77a45ef39", "patch": "@@ -1,3 +1,10 @@\n+2003-05-29  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config/mips/mips-protos.h (mips_output_load_label): Declare.\n+\t* config/mips/mips.c (mips_output_load_label): New function.\n+\t(mips_output_conditional_branch): Use it.\n+\t* config/mips/mips.md (jump): And here.\n+\n 2003-05-28  Bob Wilson  <bob.wilson@acm.org>\n \n \t* config/xtensa/xtensa-protos.h (smalloffset_double_mem_p): Delete."}, {"sha": "d74cfbc57468719e1a499f317b17e9d1ee22952e", "filename": "gcc/config/mips/mips-protos.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2Fconfig%2Fmips%2Fmips-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2Fconfig%2Fmips%2Fmips-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips-protos.h?ref=c8520e562eedd1e487d669fa698cf4b77a45ef39", "patch": "@@ -108,6 +108,7 @@ extern void\t\tprint_operand_address PARAMS ((FILE *, rtx));\n extern void\t\tprint_operand PARAMS ((FILE *, rtx, int));\n extern struct rtx_def *\tembedded_pic_offset PARAMS ((rtx));\n extern int\t\tbuild_mips16_call_stub PARAMS ((rtx, rtx, rtx, int));\n+extern const char\t*mips_output_load_label PARAMS ((void));\n extern const char       *mips_output_conditional_branch PARAMS ((rtx, rtx *,\n \t\t\t\t\t\t\t\t int, int, int,\n \t\t\t\t\t\t\t\t int));"}, {"sha": "e795a85dfa0d2e9c2cf0785913f72989d7e1d433", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 31, "deletions": 4, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=c8520e562eedd1e487d669fa698cf4b77a45ef39", "patch": "@@ -9932,6 +9932,35 @@ mips_adjust_insn_length (insn, length)\n   return length;\n }\n \n+\n+/* Return an asm sequence to start a noat block and load the address\n+   of a label into $1.  */\n+\n+const char *\n+mips_output_load_label ()\n+{\n+  if (TARGET_EXPLICIT_RELOCS)\n+    switch (mips_abi)\n+      {\n+      case ABI_N32:\n+\treturn \"%[lw\\t%@,%%got_page(%0)(%+)\\n\\taddiu\\t%@,%@,%%got_ofst(%0)\";\n+\n+      case ABI_64:\n+\treturn \"%[ld\\t%@,%%got_page(%0)(%+)\\n\\tdaddiu\\t%@,%@,%%got_ofst(%0)\";\n+\n+      default:\n+\treturn \"%[lw\\t%@,%%got(%0)(%+)\\n\\taddiu\\t%@,%@,%%lo(%0)\";\n+      }\n+  else\n+    {\n+      if (Pmode == DImode)\n+\treturn \"%[dla\\t%@,%0\";\n+      else\n+\treturn \"%[la\\t%@,%0\";\n+    }\n+}\n+\n+\n /* Output assembly instructions to peform a conditional branch.\n \n    INSN is the branch instruction.  OPERANDS[0] is the condition.\n@@ -10125,10 +10154,8 @@ mips_output_conditional_branch (insn,\n \t  output_asm_insn (\"j\\t%0\", &orig_target);\n \telse\n \t  {\n-\t    if (Pmode == DImode)\n-\t      output_asm_insn (\"%[dla\\t%@,%0\\n\\tjr\\t%@%]\", &orig_target);\n-\t    else\n-\t      output_asm_insn (\"%[la\\t%@,%0\\n\\tjr\\t%@%]\", &orig_target);\n+\t    output_asm_insn (mips_output_load_label (), &orig_target);\n+\t    output_asm_insn (\"jr\\t%@%]\", 0);\n \t  }\n \n         if (length != 16 && length != 28 && mips_branch_likely)"}, {"sha": "07b629c44ff8126510f840fd5fc9710d3d3826e4", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8520e562eedd1e487d669fa698cf4b77a45ef39/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=c8520e562eedd1e487d669fa698cf4b77a45ef39", "patch": "@@ -9350,10 +9350,11 @@ move\\\\t%0,%z4\\\\n\\\\\n     {\n       if (get_attr_length (insn) <= 8)\n \treturn \\\"%*b\\\\t%l0\\\";\n-      else if (Pmode == DImode)\n-\treturn \\\"%[dla\\\\t%@,%l0\\;%*jr\\\\t%@%]\\\";\n       else\n-\treturn \\\"%[la\\\\t%@,%l0\\;%*jr\\\\t%@%]\\\";\n+\t{\n+\t  output_asm_insn (mips_output_load_label (), operands);\n+\t  return \\\"%*jr\\\\t%@%]\\\";\n+\t}\n     }\n   else\n     return \\\"%*j\\\\t%l0\\\";"}]}