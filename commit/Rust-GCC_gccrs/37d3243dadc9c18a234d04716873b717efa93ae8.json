{"sha": "37d3243dadc9c18a234d04716873b717efa93ae8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzdkMzI0M2RhZGM5YzE4YTIzNGQwNDcxNjg3M2I3MTdlZmE5M2FlOA==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2005-11-26T22:18:04Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2005-11-26T22:18:04Z"}, "message": "re PR middle-end/23669 (fold does convert (-a)/10 into a/-10 with -fno-wrapv)\n\n2005-11-26  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR middle-end/23669\n        * fold-const.c (fold_binary): Convert -A/-B to A/B for signed types\n        when overflow is undefined.\n2005-11-26  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR middle-end/23669\n        * gcc.dg/tree-ssa/divide-1.c: New test.\n        * gcc.dg/tree-ssa/divide-2.c: New test.\n\nFrom-SVN: r107543", "tree": {"sha": "74cae8a39ab44003fc82853af062e2e770ed36f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74cae8a39ab44003fc82853af062e2e770ed36f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/37d3243dadc9c18a234d04716873b717efa93ae8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37d3243dadc9c18a234d04716873b717efa93ae8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37d3243dadc9c18a234d04716873b717efa93ae8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37d3243dadc9c18a234d04716873b717efa93ae8/comments", "author": null, "committer": null, "parents": [{"sha": "cd16503aa2153cf1e3d376eabe4ec88aacac968a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd16503aa2153cf1e3d376eabe4ec88aacac968a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd16503aa2153cf1e3d376eabe4ec88aacac968a"}], "stats": {"total": 53, "additions": 53, "deletions": 0}, "files": [{"sha": "cc7b153f1de95bb20aa33ed543a1e527fc83d4e1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=37d3243dadc9c18a234d04716873b717efa93ae8", "patch": "@@ -1,3 +1,9 @@\n+2005-11-26  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR middle-end/23669\n+\t* fold-const.c (fold_binary): Convert -A/-B to A/B for signed types\n+\twhen overflow is undefined.\n+\n 2005-11-26  Hans-Peter Nilsson  <hp@axis.com>\n \n \t* doc/md.texi (Insn Canonicalizations): Refer to the"}, {"sha": "63f12949ab71e3ed269c9a22a4a386d759724384", "filename": "gcc/fold-const.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=37d3243dadc9c18a234d04716873b717efa93ae8", "patch": "@@ -8440,6 +8440,19 @@ fold_binary (enum tree_code code, tree type, tree op0, tree op1)\n \t  && TREE_INT_CST_HIGH (arg1) == -1)\n \treturn fold_convert (type, negate_expr (arg0));\n \n+      /* Convert -A / -B to A / B when the type is signed and overflow is\n+\t undefined.  */\n+      if (!TYPE_UNSIGNED (type) && !flag_wrapv\n+\t  && TREE_CODE (arg0) == NEGATE_EXPR\n+\t  && negate_expr_p (arg1))\n+\treturn fold_build2 (code, type, TREE_OPERAND (arg0, 0),\n+\t\t\t    negate_expr (arg1));\n+      if (!TYPE_UNSIGNED (type) && !flag_wrapv\n+\t  && TREE_CODE (arg1) == NEGATE_EXPR\n+\t  && negate_expr_p (arg0))\n+\treturn fold_build2 (code, type, negate_expr (arg0),\n+\t\t\t    TREE_OPERAND (arg1, 0));\n+\n       /* If arg0 is a multiple of arg1, then rewrite to the fastest div\n \t operation, EXACT_DIV_EXPR.\n "}, {"sha": "2cbcd6deef5bfc409ab952f45074aa4673e163b3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=37d3243dadc9c18a234d04716873b717efa93ae8", "patch": "@@ -1,3 +1,9 @@\n+2005-11-26  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR middle-end/23669\n+\t* gcc.dg/tree-ssa/divide-1.c: New test.\n+\t* gcc.dg/tree-ssa/divide-2.c: New test.\n+\n 2005-11-26  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \tPR libgfortran/24945"}, {"sha": "90acd8b7abc37d1e975cd8318d1c6bc44cea4bde", "filename": "gcc/testsuite/gcc.dg/tree-ssa/divide-1.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-1.c?ref=37d3243dadc9c18a234d04716873b717efa93ae8", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -fdump-tree-optimized\" } */\n+\n+int f(int a)\n+{\n+  return (-a)/10;\n+}\n+\n+\n+/* { dg-final { scan-tree-dump-times \"-a / 10\" 0 \"optimized\"} } */\n+/* { dg-final { scan-tree-dump-times \"a / -10\" 1 \"optimized\"} } */\n+\n+/* { dg-final { cleanup-tree-dump \"optimized\" } } */\n+"}, {"sha": "5d719c025017bdedeb6dc8176ec4acaa0d892367", "filename": "gcc/testsuite/gcc.dg/tree-ssa/divide-2.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d3243dadc9c18a234d04716873b717efa93ae8/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-2.c?ref=37d3243dadc9c18a234d04716873b717efa93ae8", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -fdump-tree-optimized\" } */\n+\n+int f(int a)\n+{\n+  return 10/-a;\n+}\n+\n+\n+/* { dg-final { scan-tree-dump-times \"10 / -a\" 0 \"optimized\"} } */\n+/* { dg-final { scan-tree-dump-times \"-10 / a\" 1 \"optimized\"} } */\n+\n+/* { dg-final { cleanup-tree-dump \"optimized\" } } */\n+"}]}