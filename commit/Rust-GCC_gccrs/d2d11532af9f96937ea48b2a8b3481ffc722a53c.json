{"sha": "d2d11532af9f96937ea48b2a8b3481ffc722a53c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDJkMTE1MzJhZjlmOTY5MzdlYTQ4YjJhOGIzNDgxZmZjNzIyYTUzYw==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2014-04-24T08:55:05Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2014-04-24T08:55:05Z"}, "message": "expr.c (expand_expr_real_1): Avoid gimple_assign_rhs_to_tree during TER and instead use the sepops interface...\n\n2014-04-24  Richard Biener  <rguenther@suse.de>\n\n\t* expr.c (expand_expr_real_1): Avoid gimple_assign_rhs_to_tree\n\tduring TER and instead use the sepops interface for expanding\n\tnon-GIMPLE_SINGLE_RHS.\n\nFrom-SVN: r209741", "tree": {"sha": "9a4abfc96e33b6a2300a66dd509516259d20b4e4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9a4abfc96e33b6a2300a66dd509516259d20b4e4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d2d11532af9f96937ea48b2a8b3481ffc722a53c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2d11532af9f96937ea48b2a8b3481ffc722a53c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2d11532af9f96937ea48b2a8b3481ffc722a53c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2d11532af9f96937ea48b2a8b3481ffc722a53c/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8117ef9898d4a3d55e1fe64a1d4c0a6d0dfaa00c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8117ef9898d4a3d55e1fe64a1d4c0a6d0dfaa00c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8117ef9898d4a3d55e1fe64a1d4c0a6d0dfaa00c"}], "stats": {"total": 39, "additions": 33, "deletions": 6}, "files": [{"sha": "591179a50bb6afcec5353f7d8572b583cfbfd6e3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2d11532af9f96937ea48b2a8b3481ffc722a53c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2d11532af9f96937ea48b2a8b3481ffc722a53c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d2d11532af9f96937ea48b2a8b3481ffc722a53c", "patch": "@@ -1,3 +1,9 @@\n+2014-04-24  Richard Biener  <rguenther@suse.de>\n+\n+\t* expr.c (expand_expr_real_1): Avoid gimple_assign_rhs_to_tree\n+\tduring TER and instead use the sepops interface for expanding\n+\tnon-GIMPLE_SINGLE_RHS.\n+\n 2014-04-24  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* config/i386/sol2.h (ASM_PREFERRED_EH_DATA_FORMAT): Only redefine"}, {"sha": "825a244b09afe3de57106bae17619af5752b32b1", "filename": "gcc/expr.c", "status": "modified", "additions": 27, "deletions": 6, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2d11532af9f96937ea48b2a8b3481ffc722a53c/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2d11532af9f96937ea48b2a8b3481ffc722a53c/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=d2d11532af9f96937ea48b2a8b3481ffc722a53c", "patch": "@@ -9395,12 +9395,33 @@ expand_expr_real_1 (tree exp, rtx target, enum machine_mode tmode,\n       if (g)\n \t{\n \t  rtx r;\n-\t  location_t saved_loc = curr_insn_location ();\n-\n-\t  set_curr_insn_location (gimple_location (g));\n-\t  r = expand_expr_real (gimple_assign_rhs_to_tree (g), target,\n-\t\t\t\ttmode, modifier, NULL, inner_reference_p);\n-\t  set_curr_insn_location (saved_loc);\n+\t  ops.code = gimple_assign_rhs_code (g);\n+          switch (get_gimple_rhs_class (ops.code))\n+\t    {\n+\t    case GIMPLE_TERNARY_RHS:\n+\t      ops.op2 = gimple_assign_rhs3 (g);\n+\t      /* Fallthru */\n+\t    case GIMPLE_BINARY_RHS:\n+\t      ops.op1 = gimple_assign_rhs2 (g);\n+\t      /* Fallthru */\n+\t    case GIMPLE_UNARY_RHS:\n+\t      ops.op0 = gimple_assign_rhs1 (g);\n+\t      ops.type = TREE_TYPE (gimple_assign_lhs (g));\n+\t      ops.location = gimple_location (g);\n+\t      r = expand_expr_real_2 (&ops, target, tmode, modifier);\n+\t      break;\n+\t    case GIMPLE_SINGLE_RHS:\n+\t      {\n+\t\tlocation_t saved_loc = curr_insn_location ();\n+\t\tset_curr_insn_location (gimple_location (g));\n+\t\tr = expand_expr_real (gimple_assign_rhs1 (g), target,\n+\t\t\t\t      tmode, modifier, NULL, inner_reference_p);\n+\t\tset_curr_insn_location (saved_loc);\n+\t\tbreak;\n+\t      }\n+\t    default:\n+\t      gcc_unreachable ();\n+\t    }\n \t  if (REG_P (r) && !REG_EXPR (r))\n \t    set_reg_attrs_for_decl_rtl (SSA_NAME_VAR (exp), r);\n \t  return r;"}]}