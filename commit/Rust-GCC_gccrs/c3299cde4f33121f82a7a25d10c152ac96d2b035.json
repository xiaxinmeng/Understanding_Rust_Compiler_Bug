{"sha": "c3299cde4f33121f82a7a25d10c152ac96d2b035", "node_id": "C_kwDOANBUbNoAKGMzMjk5Y2RlNGYzMzEyMWY4MmE3YTI1ZDEwYzE1MmFjOTZkMmIwMzU", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2022-11-02T09:52:59Z"}, "committer": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2022-11-02T09:52:59Z"}, "message": "builtins: Guard builtins.cc against HUGE_VAL and NAN definitions\n\ntrunk bootstrap recently broke on Solaris like this:\n\n/vol/gcc/src/hg/master/local/gcc/builtins.cc:2104:8: error: pasting\n\"CFN_BUILT_IN_\" and \"(\" does not give a valid preprocessing token\n 2104 |   case CFN_BUILT_IN_##MATHFN:   \\\n      |        ^~~~~~~~~~~~~\n/vol/gcc/src/hg/master/local/gcc/builtins.cc:2112:3: note: in expansion of\nmacro 'CASE_MATHFN'\n 2112 |   CASE_MATHFN(MATHFN)    \\\n      |   ^~~~~~~~~~~\n/vol/gcc/src/hg/master/local/gcc/builtins.cc:1967:5: note: in expansion of macro 'CASE_MATHFN_FLOATN'\n 1967 |     CASE_MATHFN_FLOATN (HUGE_VAL)  \\\n\nand similarly for NAN.\n\nIt turns out this happens because <math.h> is included at some point,\nwhich (in <iso/math_c99.h>) defines\n\nWhile this only happpens on Solaris right now, the same issue would be\npresent on other targets when <math.h> gets included somehow.\n\nTo avoid this, this patch #undef's both macros.\n\nBootstrapped without regressions on i386-pc-solaris2.11 and\nsparc-sun-solaris2.11.\n\n2022-11-01  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n\n\tgcc:\n\t* builtins.cc (mathfn_built_in_2): #undef HUGE_VAL, NAN.", "tree": {"sha": "84d98049003a7f570675ae9b93e7f2ad678a4e89", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/84d98049003a7f570675ae9b93e7f2ad678a4e89"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c3299cde4f33121f82a7a25d10c152ac96d2b035", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3299cde4f33121f82a7a25d10c152ac96d2b035", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3299cde4f33121f82a7a25d10c152ac96d2b035", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3299cde4f33121f82a7a25d10c152ac96d2b035/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b65e391da94476fbc5c8947c81af61aa74941dc8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b65e391da94476fbc5c8947c81af61aa74941dc8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b65e391da94476fbc5c8947c81af61aa74941dc8"}], "stats": {"total": 5, "additions": 5, "deletions": 0}, "files": [{"sha": "4dc1ca672b23ce157e294cc16d3af3168f88720f", "filename": "gcc/builtins.cc", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c3299cde4f33121f82a7a25d10c152ac96d2b035/gcc%2Fbuiltins.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c3299cde4f33121f82a7a25d10c152ac96d2b035/gcc%2Fbuiltins.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.cc?ref=c3299cde4f33121f82a7a25d10c152ac96d2b035", "patch": "@@ -1931,6 +1931,11 @@ mathfn_built_in_2 (tree type, combined_fn fn)\n   built_in_function fcodef64x = END_BUILTINS;\n   built_in_function fcodef128x = END_BUILTINS;\n \n+  /* If <math.h> has been included somehow, HUGE_VAL and NAN definitions\n+     break the uses below.  */\n+#undef HUGE_VAL\n+#undef NAN\n+\n   switch (fn)\n     {\n #define SEQ_OF_CASE_MATHFN\t\t\t\\"}]}