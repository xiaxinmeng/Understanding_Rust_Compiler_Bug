{"sha": "4d53757da9f918b6f5a7c5d44e8810c3444d64b0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGQ1Mzc1N2RhOWY5MThiNmY1YTdjNWQ0NGU4ODEwYzM0NDRkNjRiMA==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1995-02-25T02:21:37Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1995-02-25T02:21:37Z"}, "message": "(pushdecl): When have a duplicate decl, and it is global,\n\ndelete lookup_name name in test for return.\n(redeclaration_error_message): When newdecl is a block level\ndeclaration, use lookup_name_current_level instead of DECL_CONTEXT.\n\nFrom-SVN: r9072", "tree": {"sha": "705ba92845fcbdc0b457a584c6d0a53cb3b35aee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/705ba92845fcbdc0b457a584c6d0a53cb3b35aee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4d53757da9f918b6f5a7c5d44e8810c3444d64b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d53757da9f918b6f5a7c5d44e8810c3444d64b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d53757da9f918b6f5a7c5d44e8810c3444d64b0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d53757da9f918b6f5a7c5d44e8810c3444d64b0/comments", "author": null, "committer": null, "parents": [{"sha": "9791111f79a3ef3b1d64f5f2305428eb368b4ccd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9791111f79a3ef3b1d64f5f2305428eb368b4ccd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9791111f79a3ef3b1d64f5f2305428eb368b4ccd"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "aa0fbe57892f3db8bfeded49b3e8789bf93e3b83", "filename": "gcc/c-decl.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4d53757da9f918b6f5a7c5d44e8810c3444d64b0/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4d53757da9f918b6f5a7c5d44e8810c3444d64b0/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=4d53757da9f918b6f5a7c5d44e8810c3444d64b0", "patch": "@@ -1939,11 +1939,11 @@ pushdecl (x)\n \t\t\t\t\t  IDENTIFIER_POINTER (name));\n \t    }\n \n-\t  /* If this is a global decl, and there exists a conflicting local\n-\t     decl in a parent block, then we can't return as yet, because we\n-\t     need to register this decl in the current binding block.  */\n-\t  if (! DECL_EXTERNAL (x) || ! TREE_PUBLIC (x)\n-\t      || lookup_name (name) == t)\n+\t  /* If this is a global decl, then we can't return as yet, because we\n+\t     need to register this decl in the current binding block.  This\n+\t     ensures that we get an error message if it is redeclared as a\n+\t     local variable later in the same block.  */\n+\t  if (! DECL_EXTERNAL (x) || ! TREE_PUBLIC (x))\n \t    return t;\n \t}\n \n@@ -2422,7 +2422,7 @@ redeclaration_error_message (newdecl, olddecl)\n \t external reference.  Otherwise, it is OK, because newdecl must\n \t be an extern reference to olddecl.  */\n       if (!(DECL_EXTERNAL (newdecl) && DECL_EXTERNAL (olddecl))\n-\t  && DECL_CONTEXT (newdecl) == DECL_CONTEXT (olddecl))\n+\t  && lookup_name_current_level (DECL_NAME (newdecl)) == olddecl)\n \treturn \"redeclaration of `%s'\";\n       return 0;\n     }"}]}