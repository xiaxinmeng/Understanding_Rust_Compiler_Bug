{"sha": "5989df83be8402add1f7cad75ee98e7a8ac2dbda", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTk4OWRmODNiZTg0MDJhZGQxZjdjYWQ3NWVlOThlN2E4YWMyZGJkYQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-01-06T22:00:00Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-01-06T22:00:00Z"}, "message": "re PR fortran/34545 (ICE when compiling Fortran 95 code)\n\n2008-01-06  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/34545\n\t* module.c (load_needed): If the namespace has no proc_name\n\tgive it the module symbol.\n\n2008-01-06  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/34545\n\t* gfortran.dg/use_12.f90: New test.\n\nFrom-SVN: r131364", "tree": {"sha": "90e6a3b9a4e806e921bd4b2e4e0dfd7151225906", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/90e6a3b9a4e806e921bd4b2e4e0dfd7151225906"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5989df83be8402add1f7cad75ee98e7a8ac2dbda", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5989df83be8402add1f7cad75ee98e7a8ac2dbda", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5989df83be8402add1f7cad75ee98e7a8ac2dbda", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5989df83be8402add1f7cad75ee98e7a8ac2dbda/comments", "author": null, "committer": null, "parents": [{"sha": "b8c9ec3da0d37a2b29715bb91b847b1e5dc188c5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8c9ec3da0d37a2b29715bb91b847b1e5dc188c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b8c9ec3da0d37a2b29715bb91b847b1e5dc188c5"}], "stats": {"total": 50, "additions": 46, "deletions": 4}, "files": [{"sha": "6659ab50f70e322f7ebd34abc6c194d2292296b2", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=5989df83be8402add1f7cad75ee98e7a8ac2dbda", "patch": "@@ -1,8 +1,8 @@\n-2008-01-06  Tobias Burnus  <burnus@net-b.de>\n+2008-01-06  Paul Thomas  <pault@gcc.gnu.org>\n \n-\tPR fortran/34689\n-\t* interface.c (compare_actual_formal): Fix intent(out) check for\n-\tfunction result variables.\n+\tPR fortran/34545\n+\t* module.c (load_needed): If the namespace has no proc_name\n+\tgive it the module symbol.\n \n 2008-01-06  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n "}, {"sha": "20528cbdc279b6b71fc77b63b0c2297bd468499c", "filename": "gcc/fortran/module.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ffortran%2Fmodule.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ffortran%2Fmodule.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmodule.c?ref=5989df83be8402add1f7cad75ee98e7a8ac2dbda", "patch": "@@ -3525,6 +3525,12 @@ load_needed (pointer_info *p)\n \t  associate_integer_pointer (q, ns);\n \t}\n \n+      /* Use the module sym as 'proc_name' so that gfc_get_symbol_decl\n+\t doesn't go pear-shaped if the symbol is used.  */\n+      if (!ns->proc_name)\n+\tgfc_find_symbol (p->u.rsym.module, gfc_current_ns,\n+\t\t\t\t 1, &ns->proc_name);\n+\n       sym = gfc_new_symbol (p->u.rsym.true_name, ns);\n       sym->module = gfc_get_string (p->u.rsym.module);\n       strcpy (sym->binding_label, p->u.rsym.binding_label);"}, {"sha": "d66912b2ac2aff2f2895c51eef6393cb55fe52d3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5989df83be8402add1f7cad75ee98e7a8ac2dbda", "patch": "@@ -1,3 +1,14 @@\n+2008-01-06  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/34545\n+\t* gfortran.dg/use_12.f90: New test.\n+\n+2008-01-06  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/34689\n+\t* interface.c (compare_actual_formal): Fix intent(out) check for\n+\tfunction result variables.\n+\n 2008-01-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/34690"}, {"sha": "82614b5142e3082c53dfbdd6fa4c0aff7fa21eda", "filename": "gcc/testsuite/gfortran.dg/use_12.f90", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_12.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5989df83be8402add1f7cad75ee98e7a8ac2dbda/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_12.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_12.f90?ref=5989df83be8402add1f7cad75ee98e7a8ac2dbda", "patch": "@@ -0,0 +1,25 @@\n+! { dg-do compile }\n+! Tests the fix of PR34545, in which the 'numclusters' that determines the size\n+! of fnres was not properly associated.\n+!\n+! Reported by Jon D. Richards <jon_d_r@msn.com>\n+!\n+module m1\n+  integer :: numclusters = 2\n+end module m1\n+\n+module m2\n+  contains\n+    function get_nfirst( ) result(fnres)\n+      use m1, only: numclusters\n+      real :: fnres(numclusters)   ! change to REAL and it works!!  \n+    end function get_nfirst\n+end module m2\n+\n+program kmeans_driver\n+   use m1\n+   use m2\n+   integer :: nfirst(3)\n+   nfirst(1:numclusters) = get_nfirst( )\n+end program kmeans_driver\n+! { dg-final { cleanup-modules \"m1 m2\" } }"}]}