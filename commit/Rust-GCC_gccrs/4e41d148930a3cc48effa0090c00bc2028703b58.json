{"sha": "4e41d148930a3cc48effa0090c00bc2028703b58", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGU0MWQxNDg5MzBhM2NjNDhlZmZhMDA5MGMwMGJjMjAyODcwM2I1OA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2001-12-13T04:19:36Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-12-13T04:19:36Z"}, "message": "prims.cc (_Jv_RunMain): Use `using' to simplify code.\n\n\t* prims.cc (_Jv_RunMain): Use `using' to simplify code.  Set\n\t_Jv_Jar_Class_Path early.\n\nFrom-SVN: r47965", "tree": {"sha": "5d2e8109a7eacc506074369d1f9dc3a8535b6b82", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d2e8109a7eacc506074369d1f9dc3a8535b6b82"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4e41d148930a3cc48effa0090c00bc2028703b58", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e41d148930a3cc48effa0090c00bc2028703b58", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e41d148930a3cc48effa0090c00bc2028703b58", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e41d148930a3cc48effa0090c00bc2028703b58/comments", "author": null, "committer": null, "parents": [{"sha": "a0de9d202503e7931ecb6f9fe068596f8631ff6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0de9d202503e7931ecb6f9fe068596f8631ff6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0de9d202503e7931ecb6f9fe068596f8631ff6b"}], "stats": {"total": 23, "additions": 11, "deletions": 12}, "files": [{"sha": "4116faedd4a2b41ba3e289d741cfdabcee32964d", "filename": "libjava/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e41d148930a3cc48effa0090c00bc2028703b58/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e41d148930a3cc48effa0090c00bc2028703b58/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=4e41d148930a3cc48effa0090c00bc2028703b58", "patch": "@@ -1,5 +1,8 @@\n 2001-12-12  Tom Tromey  <tromey@redhat.com>\n \n+\t* prims.cc (_Jv_RunMain): Use `using' to simplify code.  Set\n+\t_Jv_Jar_Class_Path early.\n+\n \t* jni.cc (call): Synchronize if required.\n \n \t* gij.cc (main): Clarify --help output."}, {"sha": "75204b876dd72b5dd3f4c3e9839ea0de2e1082ae", "filename": "libjava/prims.cc", "status": "modified", "additions": 8, "deletions": 12, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e41d148930a3cc48effa0090c00bc2028703b58/libjava%2Fprims.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e41d148930a3cc48effa0090c00bc2028703b58/libjava%2Fprims.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fprims.cc?ref=4e41d148930a3cc48effa0090c00bc2028703b58", "patch": "@@ -994,6 +994,10 @@ _Jv_RunMain (jclass klass, const char *name, int argc, const char **argv,\n \n   try\n     {\n+      // Set this very early so that it is seen when java.lang.System\n+      // is initialized.\n+      if (is_jar)\n+\t_Jv_Jar_Class_Path = strdup (name);\n       _Jv_CreateJavaVM (NULL);\n \n       // Get the Runtime here.  We want to initialize it before searching\n@@ -1002,20 +1006,12 @@ _Jv_RunMain (jclass klass, const char *name, int argc, const char **argv,\n \n       arg_vec = JvConvertArgv (argc - 1, argv + 1);\n \n+      using namespace gnu::gcj::runtime;\n       if (klass)\n-\tmain_thread = new gnu::gcj::runtime::FirstThread (klass, arg_vec);\n+\tmain_thread = new FirstThread (klass, arg_vec);\n       else\n-\tmain_thread = new gnu::gcj::runtime::FirstThread \n-\t\t\t(JvNewStringLatin1 (name), arg_vec, is_jar);\n-\n-      if (is_jar)\n-\t{\n-\t  // We need a new ClassLoader because the classpath must be the\n-\t  // jar file only.  The easiest way to do this is to lose our\n-\t  // reference to the previous classloader.\n-\t  _Jv_Jar_Class_Path = strdup (name);\n-\t  gnu::gcj::runtime::VMClassLoader::instance = NULL;\n-\t}\n+\tmain_thread = new FirstThread (JvNewStringLatin1 (name),\n+\t\t\t\t       arg_vec, is_jar);\n     }\n   catch (java::lang::Throwable *t)\n     {"}]}