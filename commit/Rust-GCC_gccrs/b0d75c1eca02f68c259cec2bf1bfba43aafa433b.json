{"sha": "b0d75c1eca02f68c259cec2bf1bfba43aafa433b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjBkNzVjMWVjYTAyZjY4YzI1OWNlYzJiZjFiZmJhNDNhYWZhNDMzYg==", "commit": {"author": {"name": "Brendan Kehoe", "email": "brendan@lisa.cygnus.com", "date": "1997-09-09T22:20:47Z"}, "committer": {"name": "Brendan Kehoe", "email": "brendan@gcc.gnu.org", "date": "1997-09-09T22:20:47Z"}, "message": "typeck.c (build_indirect_ref): Heed FLAG_VOLATILE similar to c-typeck.c.\n\n        * typeck.c (build_indirect_ref): Heed FLAG_VOLATILE similar to\n        c-typeck.c.\n\nFrom-SVN: r15197", "tree": {"sha": "db9f22a78f109f1504333e75445df99ce74d344c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db9f22a78f109f1504333e75445df99ce74d344c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b0d75c1eca02f68c259cec2bf1bfba43aafa433b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0d75c1eca02f68c259cec2bf1bfba43aafa433b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0d75c1eca02f68c259cec2bf1bfba43aafa433b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0d75c1eca02f68c259cec2bf1bfba43aafa433b/comments", "author": null, "committer": null, "parents": [{"sha": "ee89446f5b512c73ed8744627bd357a69c1591c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee89446f5b512c73ed8744627bd357a69c1591c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee89446f5b512c73ed8744627bd357a69c1591c8"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "ddadf86eb5a55a0af022e2e7dcb67ca5efc87ea1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0d75c1eca02f68c259cec2bf1bfba43aafa433b/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0d75c1eca02f68c259cec2bf1bfba43aafa433b/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=b0d75c1eca02f68c259cec2bf1bfba43aafa433b", "patch": "@@ -1,3 +1,8 @@\n+1997-09-09  Brendan Kehoe  <brendan@lisa.cygnus.com>\n+\n+\t* typeck.c (build_indirect_ref): Heed FLAG_VOLATILE similar to\n+\tc-typeck.c.\n+\n Mon Sep  8 02:33:20 1997  Jody Goldberg  <jodyg@idt.net>\n \n \t* decl.c (current_local_enum): Remove static."}, {"sha": "ecac505dc8b27b084f49e60169fe2004b9d174e3", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0d75c1eca02f68c259cec2bf1bfba43aafa433b/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0d75c1eca02f68c259cec2bf1bfba43aafa433b/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=b0d75c1eca02f68c259cec2bf1bfba43aafa433b", "patch": "@@ -2048,6 +2048,7 @@ build_indirect_ref (ptr, errorstring)\n   if (TREE_CODE (type) == POINTER_TYPE || TREE_CODE (type) == REFERENCE_TYPE)\n     {\n       if (TREE_CODE (pointer) == ADDR_EXPR\n+\t  && !flag_volatile\n \t  && (TYPE_MAIN_VARIANT (TREE_TYPE (TREE_OPERAND (pointer, 0)))\n \t      == TYPE_MAIN_VARIANT (TREE_TYPE (type)))\n \t  && (TREE_READONLY (TREE_OPERAND (pointer, 0))\n@@ -2061,10 +2062,13 @@ build_indirect_ref (ptr, errorstring)\n \t  register tree ref = build1 (INDIRECT_REF,\n \t\t\t\t      TYPE_MAIN_VARIANT (t), pointer);\n \n+\t  /* We *must* set TREE_READONLY when dereferencing a pointer to const,\n+\t     so that we get the proper error message if the result is used\n+\t     to assign to.  Also, &* is supposed to be a no-op.  */\n \t  TREE_READONLY (ref) = TYPE_READONLY (t);\n-\t  TREE_THIS_VOLATILE (ref) = TYPE_VOLATILE (t);\n \t  TREE_SIDE_EFFECTS (ref)\n-\t    = TYPE_VOLATILE (t) || TREE_SIDE_EFFECTS (pointer);\n+\t    = TYPE_VOLATILE (t) || TREE_SIDE_EFFECTS (pointer) || flag_volatile;\n+\t  TREE_THIS_VOLATILE (ref) = TYPE_VOLATILE (t);\n \t  return ref;\n \t}\n     }"}]}