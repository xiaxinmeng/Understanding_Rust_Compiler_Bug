{"sha": "06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDYyOThhYmRiNmQxZWRkOGZiY2Q4MDcxZTAzNTNlY2MyZTg1ZTNiOQ==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2000-09-06T13:59:29Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2000-09-06T13:59:29Z"}, "message": "ltconfig, [...]: Updated from libtool multi-language branch.\n\n* ltconfig, ltmain.sh, libtool.m4, ltcf-c.sh, ltcf-cxx.sh,\nltcf-gcj.sh: Updated from libtool multi-language branch.\n\nFrom-SVN: r36198", "tree": {"sha": "d2c11ae7c5b961d2ad3c22fa58daad1ae1236f8b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d2c11ae7c5b961d2ad3c22fa58daad1ae1236f8b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/comments", "author": null, "committer": null, "parents": [{"sha": "611bbf2af74de88302605b10cf935670089f0f1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/611bbf2af74de88302605b10cf935670089f0f1f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/611bbf2af74de88302605b10cf935670089f0f1f"}], "stats": {"total": 307, "additions": 197, "deletions": 110}, "files": [{"sha": "7bf2d30b737b68e39ff8e309505a23f9531278ad", "filename": "ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "patch": "@@ -1,3 +1,8 @@\n+2000-09-06  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* ltconfig, ltmain.sh, libtool.m4, ltcf-c.sh, ltcf-cxx.sh,\n+\tltcf-gcj.sh: Updated from libtool multi-language branch.\n+\n 2000-09-05  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* Makefile.in (all-bootstrap): Added all-texinfo and all-zlib."}, {"sha": "3a4edf1755db9e658b054404f0f6334dc940250e", "filename": "libtool.m4", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/libtool.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/libtool.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libtool.m4?ref=06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "patch": "@@ -532,8 +532,10 @@ freebsd* )\n   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then\n     case \"$host_cpu\" in\n     i*86 )\n+      # Not sure whether the presence of OpenBSD here was a mistake.\n+      # Let's accept both of them until this is cleared up.\n       changequote(,)dnl\n-      lt_cv_deplibs_check_method=='file_magic OpenBSD/i[3-9]86 demand paged shared library'\n+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[3-9]86 (compact )?demand paged shared library'\n       changequote([, ])dnl\n       lt_cv_file_magic_cmd=/usr/bin/file\n       lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`\n@@ -579,7 +581,7 @@ irix5* | irix6*)\n   ;;\n \n # This must be Linux ELF.\n-linux*)\n+linux-gnu*)\n   case \"$host_cpu\" in\n   alpha* | i*86 | powerpc* | sparc* | ia64* )\n     lt_cv_deplibs_check_method=pass_all ;;\n@@ -655,7 +657,8 @@ else\n       # Check to see if the nm accepts a BSD-compat flag.\n       # Adding the `sed 1q' prevents false positives on HP-UX, which says:\n       #   nm: unknown option \"B\" ignored\n-      if ($tmp_nm -B /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then\n+      # Tru64's nm complains that /dev/null is an invalid object file\n+      if ($tmp_nm -B /dev/null 2>&1 | sed '1q'; exit 0) | egrep '(/dev/null|Invalid file or object type)' >/dev/null; then\n \tac_cv_path_NM=\"$tmp_nm -B\"\n \tbreak\n       elif ($tmp_nm -p /dev/null 2>&1 | sed '1q'; exit 0) | egrep /dev/null >/dev/null; then\n@@ -822,3 +825,9 @@ AC_DEFUN(AM_PROG_NM, [indir([AC_PROG_NM])])dnl\n \n dnl This is just to silence aclocal about the macro not being used\n ifelse([AC_DISABLE_FAST_INSTALL])dnl\n+\n+AC_DEFUN([LT_AC_PROG_GCJ],[\n+  AC_CHECK_TOOL(GCJ, gcj, no)\n+  test \"x${GCJFLAGS+set}\" = xset || GCJFLAGS=\"-g -O2\"\n+  AC_SUBST(GCJFLAGS)\n+])"}, {"sha": "e57abb1cb2b243ee47c7d4b8b787d3ca36285dfd", "filename": "ltcf-c.sh", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltcf-c.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltcf-c.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-c.sh?ref=06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "patch": "@@ -1,7 +1,5 @@\n #### This script is meant to be sourced by ltconfig.\n \n-# $Id: ltcf-c.sh,v 1.1 2000/07/28 18:04:21 bkoz Exp $\n-\n # ltcf-c.sh - Create a C compiler specific configuration\n #\n # Copyright (C) 1996-2000 Free Software Foundation, Inc.\n@@ -92,7 +90,7 @@ EOF\n       allow_undefined_flag=unsupported\n       # Joseph Beckenbach <jrb3@best.com> says some releases of gcc\n       # support --undefined.  This deserves some investigation.  FIXME\n-      archive_cmds='$CC -nostart $libobjs $deplibs $linker_flags ${wl}-soname $wl$soname -o $lib'\n+      archive_cmds='$CC -nostart $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'\n     else\n       ld_shlibs=no\n     fi\n@@ -193,8 +191,8 @@ EOF\n \n EOF\n     elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then\n-      archive_cmds='$CC -shared $libobjs $deplibs $linker_flags ${wl}-soname $wl$soname -o $lib'\n-      archive_expsym_cmds='$CC -shared $libobjs $deplibs $linker_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n     else\n       ld_shlibs=no\n     fi\n@@ -219,8 +217,8 @@ EOF\n \n   if test \"$ld_shlibs\" = yes; then\n     runpath_var=LD_RUN_PATH\n-    hardcode_libdir_flag_spec=\"$wlarc\"'--rpath '\"$wlarc\"'$libdir'\n-    export_dynamic_flag_spec=\"$wlarc\"'--export-dynamic'\n+    hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'\n+    export_dynamic_flag_spec='${wl}--export-dynamic'\n     case $host_os in\n     cygwin* | mingw*)\n       # dlltool doesn't understand --whole-archive et. al.\n@@ -673,10 +671,12 @@ if test \"$enable_shared\" = yes && test \"$with_gcc\" = yes; then\n \tverstring=\n \toutput_objdir=.\n \tlibname=conftest\n+\tsave_allow_undefined_flag=$allow_undefined_flag\n \tallow_undefined_flag=\n \tif { (eval echo ltcf-c.sh:need_lc: \\\"$archive_cmds\\\") 1>&5; (eval $archive_cmds) 2>&1 | grep \" -lc \" 1>&5 ; }; then\n \t  need_lc=no\n \tfi\n+\tallow_undefined_flag=$save_allow_undefined_flag\n       else\n \tcat conftest.err 1>&5\n       fi"}, {"sha": "45f8f432068b73a69e33854bb57183b542ab13bf", "filename": "ltcf-cxx.sh", "status": "modified", "additions": 22, "deletions": 18, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltcf-cxx.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltcf-cxx.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-cxx.sh?ref=06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "patch": "@@ -1,13 +1,11 @@\n #### This script is meant to be sourced by ltconfig.\n \n-# $Id: ltcf-cxx.sh,v 1.1 2000/07/28 18:04:21 bkoz Exp $\n-\n # ltcf-cxx.sh - Create a C++ compiler specific configuration\n #\n # Copyright (C) 1996-1999,2000 Free Software Foundation, Inc.\n # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996\n #\n-# Original C++ support by:\n+# Original C++ support by:Gary V. Vaughan <gvv@techie.com>\n #    Alexandre Oliva <oliva@lsd.ic.unicamp.br>\n #    Ossama Othman <ossama@debian.org>\n #    Thomas Thanner <tanner@gmx.de>\n@@ -178,8 +176,8 @@ case \"$host_os\" in\n         ;;\n       aCC)\n \tcase \"$host_os\" in\n-\thpux9*) archive_cmds='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $linker_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;\n-\t*) archive_cmds='$CC -b ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags' ;;\n+\thpux9*) archive_cmds='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib' ;;\n+\t*) archive_cmds='$CC -b ${wl}+h ${wl}$soname ${wl}+b ${wl}$install_libdir -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags' ;;\n \tesac\n \thardcode_libdir_flag_spec='${wl}+b ${wl}$libdir'\n \thardcode_libdir_separator=:\n@@ -209,11 +207,17 @@ case \"$host_os\" in\n       CC)\n         # SGI C++\n         archive_cmds='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n-        ;;\n+\n+\t# Archives containing C++ object files must be created using\n+\t# \"CC -ar\", where \"CC\" is the IRIX C++ compiler.  This is\n+\t# necessary to make sure instantiated templates are included\n+\t# in the archive.\n+\told_archive_cmds='$CC -ar -WR,-u -o $oldlib $oldobjs'\n+\t;;\n       *)\n         if test \"$with_gcc\" = yes; then\n           if test \"$with_gnu_ld\" = no; then\n-            archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'\n+            archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'\n           else\n             archive_cmds='$LD -shared $predep_objects $libobjs $deplibs $postdep_objects $linker_flags -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -o $lib'\n           fi\n@@ -232,8 +236,8 @@ case \"$host_os\" in\n         # KCC will only create a shared library if the output file\n         # ends with \".so\" (or \".sl\" for HP-UX), so rename the library\n         # to its proper name (with version) after linking.\n-        archive_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $linker_flags --soname $soname -o \\$templib; mv \\$templib $lib'\n-        archive_expsym_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $linker_flags --soname $soname -o \\$templib ${wl}-retain-symbols-file,$export_symbols; mv \\$templib $lib'\n+        archive_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \\$templib; mv \\$templib $lib'\n+        archive_expsym_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \\$templib ${wl}-retain-symbols-file,$export_symbols; mv \\$templib $lib'\n \n         # Commands to make compiler produce verbose output that lists\n         # what \"hidden\" libraries, object files and flags are used when\n@@ -254,8 +258,8 @@ case \"$host_os\" in\n         ;;\n       cxx)\n         # Compaq C++\n-        archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-soname $wl$soname -o $lib'\n-        archive_expsym_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'\n+        archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+        archive_expsym_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'\n \n         runpath_var=LD_RUN_PATH\n         hardcode_libdir_flag_spec='-rpath $libdir'\n@@ -318,7 +322,7 @@ case \"$host_os\" in\n         # KCC will only create a shared library if the output file\n         # ends with \".so\" (or \".sl\" for HP-UX), so rename the library\n         # to its proper name (with version) after linking.\n-        archive_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $linker_flags --soname $soname -o \\$templib; mv \\$templib $lib'\n+        archive_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \\$templib; mv \\$templib $lib'\n \n         hardcode_libdir_flag_spec='${wl}-rpath,$libdir'\n         hardcode_libdir_separator=:\n@@ -335,7 +339,7 @@ case \"$host_os\" in\n         ;;\n       cxx)\n         allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\\*'\n-        archive_cmds='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-soname $soname `test -n \"$verstring\" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n+        archive_cmds='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n \"$verstring\" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n \n         hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n         hardcode_libdir_separator=:\n@@ -377,7 +381,7 @@ case \"$host_os\" in\n         # KCC will only create a shared library if the output file\n         # ends with \".so\" (or \".sl\" for HP-UX), so rename the library\n         # to its proper name (with version) after linking.\n-        archive_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $linker_flags --soname $soname -o \\$templib; mv \\$templib $lib'\n+        archive_cmds='templib=`echo $lib | sed -e \"s/\\.so\\..*/\\.so/\"`; $CC $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags --soname $soname -o \\$templib; mv \\$templib $lib'\n \n         hardcode_libdir_flag_spec='${wl}-rpath,$libdir'\n         hardcode_libdir_separator=:\n@@ -393,7 +397,7 @@ case \"$host_os\" in\n         ;;\n       cxx)\n         allow_undefined_flag=' ${wl}-expect_unresolved ${wl}\\*'\n-        archive_cmds='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-msym ${wl}-soname $soname `test -n \"$verstring\" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n+        archive_cmds='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname $soname `test -n \"$verstring\" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n         \n         hardcode_libdir_flag_spec='${wl}-rpath ${wl}$libdir'\n         hardcode_libdir_separator=:\n@@ -453,9 +457,9 @@ case \"$host_os\" in\n       CC)\n \t# Sun C++ 4.2, 5.x and Centerline C++\n         no_undefined_flag=' -ztext'\n-        archive_cmds='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags'\n+        archive_cmds='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'\n         archive_expsym_cmds='$echo \"{ global:\" > $lib.exp~cat $export_symbols | sed -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n-        $CC -G${allow_undefined_flag} -nolib ${wl}-M ${wl}$lib.exp -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $linker_flags~$rm $lib.exp'\n+        $CC -G${allow_undefined_flag} -nolib ${wl}-M ${wl}$lib.exp -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~$rm $lib.exp'\n \n         hardcode_libdir_flag_spec='-R$libdir'\n         hardcode_shlibpath_var=no\n@@ -489,7 +493,7 @@ case \"$host_os\" in\n         ;;\n       gcx)\n         # Green Hills C++ Compiler\n-        archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $linker_flags ${wl}-h $wl$soname -o $lib'\n+        archive_cmds='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'\n \n         # The C++ compiler must be used to create the archive.\n         old_archive_cmds='$CC $LDFLAGS -archive -o $oldlib $oldobjs'"}, {"sha": "acb30c0ace15aac641af77c837cfab99a8de6eda", "filename": "ltcf-gcj.sh", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltcf-gcj.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltcf-gcj.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltcf-gcj.sh?ref=06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "patch": "@@ -1,7 +1,5 @@\n #### This script is meant to be sourced by ltconfig.\n \n-# $Id: ltcf-gcj.sh,v 1.1.2.5 2000/07/20 02:29:15 oliva Exp $\n-\n # ltcf-gcj.sh - Create a GCJ compiler specific configuration\n #\n # Copyright (C) 1996-1999,2000 Free Software Foundation, Inc.\n@@ -95,7 +93,7 @@ EOF\n       allow_undefined_flag=unsupported\n       # Joseph Beckenbach <jrb3@best.com> says some releases of gcc\n       # support --undefined.  This deserves some investigation.  FIXME\n-      archive_cmds='$CC -nostart $libobjs $deplibs $linker_flags ${wl}-soname $wl$soname -o $lib'\n+      archive_cmds='$CC -nostart $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'\n     else\n       ld_shlibs=no\n     fi\n@@ -196,8 +194,8 @@ EOF\n \n EOF\n     elif $LD --help 2>&1 | egrep ': supported targets:.* elf' > /dev/null; then\n-      archive_cmds='$CC -shared $libobjs $deplibs $linker_flags ${wl}-soname $wl$soname -o $lib'\n-      archive_expsym_cmds='$CC -shared $libobjs $deplibs $linker_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n+      archive_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+      archive_expsym_cmds='$CC -shared $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n     else\n       ld_shlibs=no\n     fi\n@@ -222,8 +220,8 @@ EOF\n \n   if test \"$ld_shlibs\" = yes; then\n     runpath_var=LD_RUN_PATH\n-    hardcode_libdir_flag_spec=\"$wlarc\"'--rpath '\"$wlarc\"'$libdir'\n-    export_dynamic_flag_spec=\"$wlarc\"'--export-dynamic'\n+    hardcode_libdir_flag_spec='${wl}--rpath ${wl}$libdir'\n+    export_dynamic_flag_spec='${wl}--export-dynamic'\n     case $host_os in\n     cygwin* | mingw*)\n       # dlltool doesn't understand --whole-archive et. al."}, {"sha": "b7ea83e1556c65855edf07fe38017fb124beca17", "filename": "ltconfig", "status": "modified", "additions": 92, "deletions": 45, "changes": 137, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltconfig", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltconfig", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltconfig?ref=06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "patch": "@@ -181,7 +181,7 @@ progname=`$echo \"X$0\" | $Xsed -e 's%^.*/%%'`\n PROGRAM=ltconfig\n PACKAGE=libtool\n VERSION=1.4a\n-TIMESTAMP=\" (1.641.2.77 2000/08/01 04:25:15)\"\n+TIMESTAMP=\" (1.641.2.111 2000/09/05 10:29:18)\"\n ac_compile='${CC-cc} -c $CFLAGS $CPPFLAGS conftest.$ac_ext 1>&5'\n ac_link='${CC-cc} -o conftest $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS 1>&5'\n rm=\"rm -f\"\n@@ -483,7 +483,7 @@ exec 5>>./config.log\n if test \"X${LC_ALL+set}\" = Xset; then LC_ALL=C; export LC_ALL; fi\n if test \"X${LANG+set}\"   = Xset; then LANG=C;   export LANG;   fi\n \n-if test -n \"$cache_file\" && test -r \"$cache_file\"; then\n+if test -n \"$cache_file\" && test -r \"$cache_file\" && test -f \"$cache_file\"; then\n   echo \"loading cache $cache_file within ltconfig\"\n   . $cache_file\n fi\n@@ -620,6 +620,11 @@ old_archive_cmds='$AR $AR_FLAGS $oldlib$oldobjs$old_deplibs'\n old_postinstall_cmds='chmod 644 $oldlib'\n old_postuninstall_cmds=\n \n+if test -n \"$RANLIB\"; then\n+  old_archive_cmds=\"$old_archive_cmds~\\$RANLIB \\$oldlib\"\n+  old_postinstall_cmds=\"\\$RANLIB \\$oldlib~$old_postinstall_cmds\"\n+fi\n+\n # Source the script associated with the $tagname tag configuration.\n if test -n \"$tagname\"; then\n   . $ltmain\n@@ -667,7 +672,7 @@ compiler=\"$2\"\n # in isolation, and that seeing it set (from the cache) indicates that\n # the associated values are set (in the cache) correctly too.\n echo $ac_n \"checking for $compiler option to produce PIC... $ac_c\" 1>&6\n-echo \"$progname:670:checking for $compiler option to produce PIC\" 1>&5\n+echo \"$progname:675:checking for $compiler option to produce PIC\" 1>&5\n \n if test -z \"$ac_cv_prog_cc_pic\"; then\n   echo \"$ac_t\"none 1>&6\n@@ -676,7 +681,7 @@ else\n \n   # Check to make sure the pic_flag actually works.\n   echo $ac_n \"checking if $compiler PIC flag $ac_cv_prog_cc_pic works... $ac_c\" 1>&6\n-  echo \"$progname:679:checking that $compiler PIC flag $ac_cv_prog_cc_pic works.\" 1>&5\n+  echo \"$progname:684:checking that $compiler PIC flag $ac_cv_prog_cc_pic works.\" 1>&5\n   if test \"X${ac_cv_prog_cc_pic_works+set}\" = Xset && \\\n      test \"X${ac_cv_prog_cc_pic_works}\" != X; then\n     echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -686,7 +691,7 @@ else\n     echo $lt_simple_compile_test_code > conftest.$ac_ext\n     save_CFLAGS=\"$CFLAGS\"\n     CFLAGS=\"$CFLAGS $ac_cv_prog_cc_pic -DPIC\"\n-    if { (eval echo $progname:689: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n+    if { (eval echo $progname:694: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n       # Append any warnings to the config.log.\n       cat conftest.err 1>&5\n \n@@ -738,7 +743,7 @@ if test -n \"$ac_cv_prog_cc_shlib\"; then\n fi\n \n echo $ac_n \"checking if $compiler static flag $ac_cv_prog_cc_static works... $ac_c\" 1>&6\n-echo \"$progname:741: checking if $compiler static flag $ac_cv_prog_cc_static works\" >&5\n+echo \"$progname:746: checking if $compiler static flag $ac_cv_prog_cc_static works\" >&5\n if test \"X${ac_cv_prog_cc_static_works+set}\" = Xset && \\\n    test \"X${ac_cv_prog_cc_static_works}\" != X; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -747,7 +752,7 @@ else\n   echo $lt_simple_link_test_code > conftest.$ac_ext\n   save_LDFLAGS=\"$LDFLAGS\"\n   LDFLAGS=\"$LDFLAGS $ac_cv_prog_cc_static\"\n-  if { (eval echo $progname:750: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n+  if { (eval echo $progname:755: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n     ac_cv_prog_cc_static_works=yes\n   else\n     ac_cv_prog_cc_static_works=no\n@@ -784,8 +789,8 @@ mkdir out\n chmod -w .\n save_CFLAGS=\"$CFLAGS\"\n CFLAGS=\"$CFLAGS -o out/conftest2.$objext\"\n-echo \"$progname:787: checking if $compiler supports -c -o file.$objext\" >&5\n-if { (eval echo $progname:788: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>out/conftest.err; } && test -s out/conftest2.$objext; then\n+echo \"$progname:792: checking if $compiler supports -c -o file.$objext\" >&5\n+if { (eval echo $progname:793: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>out/conftest.err; } && test -s out/conftest2.$objext; then\n \n   # The compiler can only warn and ignore the option if not recognized\n   # So say no if there are warnings\n@@ -838,8 +843,8 @@ if test \"$with_gcc\" = yes; then\n   echo $lt_simple_compile_test_code > conftest.$ac_ext\n   save_CFLAGS=\"$CFLAGS\"\n   CFLAGS=\"$CFLAGS -fno-rtti -fno-exceptions -c conftest.$ac_ext\"\n-  echo \"$progname:841: checking if $compiler supports -fno-rtti -fno-exceptions\" >&5\n-  if { (eval echo $progname:842: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n+  echo \"$progname:846: checking if $compiler supports -fno-rtti -fno-exceptions\" >&5\n+  if { (eval echo $progname:847: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>conftest.err; } && test -s conftest.$objext; then\n \n     # The compiler can only warn and ignore the option if not recognized\n     # So say no if there are warnings\n@@ -1017,11 +1022,7 @@ freebsd*)\n   freebsd2*)\n     shlibpath_overrides_runpath=yes\n     ;;\n-  freebsd3.[01]* | freebsdelf3.[01]*)\n-    shlibpath_overrides_runpath=yes\n-    hardcode_into_libs=yes\n-    ;;\n-  *) # from 3.2 on\n+  *)\n     shlibpath_overrides_runpath=no\n     hardcode_into_libs=yes\n     ;;\n@@ -1306,11 +1307,11 @@ void nm_test_func(){}\n main(){nm_test_var='a';nm_test_func();return(0);}\n EOF\n \n-  echo \"$progname:1309: checking if global_symbol_pipe works\" >&5\n-  if { (eval echo $progname:1310: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; } && test -s conftest.$objext; then\n+  echo \"$progname:1310: checking if global_symbol_pipe works\" >&5\n+  if { (eval echo $progname:1311: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; } && test -s conftest.$objext; then\n     # Now try to grab the symbols.\n     nlist=conftest.nm\n-    if { echo \"$progname:1313: eval \\\"$NM conftest.$objext | $global_symbol_pipe > $nlist\\\"\" >&5; eval \"$NM conftest.$objext | $global_symbol_pipe > $nlist 2>&5\"; } && test -s \"$nlist\"; then\n+    if { echo \"$progname:1314: eval \\\"$NM conftest.$objext | $global_symbol_pipe > $nlist\\\"\" >&5; eval \"$NM conftest.$objext | $global_symbol_pipe > $nlist 2>&5\"; } && test -s \"$nlist\"; then\n \n       # Try sorting and uniquifying the output.\n       if sort \"$nlist\" | uniq > \"$nlist\"T; then\n@@ -1362,7 +1363,7 @@ EOF\n \t  save_CFLAGS=\"$CFLAGS\"\n \t  LIBS=\"conftstm.$objext\"\n \t  CFLAGS=\"$CFLAGS$no_builtin_flag\"\n-\t  if { (eval echo $progname:1365: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n+\t  if { (eval echo $progname:1366: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest; then\n \t    pipe_works=yes\n \t  else\n \t    echo \"$progname: failed program was:\" >&5\n@@ -1441,7 +1442,7 @@ test \"$enable_shared\" = yes || enable_static=yes\n \n echo \"checking whether to build static libraries... $enable_static\" 1>&6\n \n-if test \"$hardcode_action\" = relink || test \"$hardcode_into_libs\" = all; then\n+if test \"$hardcode_action\" = relink; then\n   # Fast installation is not supported\n   enable_fast_install=no\n elif test \"$shlibpath_overrides_runpath\" = yes ||\n@@ -1466,14 +1467,14 @@ else\n if test \"X${lt_cv_dlopen+set}\" != Xset; then\n   lt_cv_dlopen=no lt_cv_dlopen_libs=\n echo $ac_n \"checking for dlopen in -ldl\"\"... $ac_c\" 1>&6\n-echo \"$progname:1469: checking for dlopen in -ldl\" >&5\n+echo \"$progname:1470: checking for dlopen in -ldl\" >&5\n if test \"X${ac_cv_lib_dl_dlopen+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-ldl  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1476 \"ltconfig\"\n+#line 1477 \"ltconfig\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n     builtin and then its argument prototype would still apply.  */\n@@ -1486,7 +1487,7 @@ int main() {\n dlopen()\n ; return 0; }\n EOF\n-if { (eval echo $progname:1489: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1490: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_lib_dl_dlopen=yes\n else\n@@ -1505,12 +1506,12 @@ if test \"X$ac_cv_lib_dl_dlopen\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for dlopen\"\"... $ac_c\" 1>&6\n-echo \"$progname:1508: checking for dlopen\" >&5\n+echo \"$progname:1509: checking for dlopen\" >&5\n if test \"X${ac_cv_func_dlopen+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1513 \"ltconfig\"\n+#line 1514 \"ltconfig\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char dlopen(); below.  */\n #include <assert.h>\n@@ -1535,7 +1536,7 @@ dlopen();\n \n ; return 0; }\n EOF\n-if { (eval echo $progname:1538: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1539: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_func_dlopen=yes\n else\n@@ -1551,15 +1552,54 @@ if test \"X$ac_cv_func_dlopen\" = Xyes; then\n   lt_cv_dlopen=\"dlopen\"\n else\n   echo \"$ac_t\"\"no\" 1>&6\n+echo $ac_n \"checking for dlopen in -lsvld\"\"... $ac_c\" 1>&6\n+echo \"$progname:1556: checking for dlopen in -lsvld\" >&5\n+if test \"X${ac_cv_lib_svld_dlopen+set}\" = Xset; then\n+  echo $ac_n \"(cached) $ac_c\" 1>&6\n+else\n+  ac_save_LIBS=\"$LIBS\"\n+LIBS=\"-lsvld  $LIBS\"\n+cat > conftest.$ac_ext <<EOF\n+#line 1563 \"ltconfig\"\n+/* Override any gcc2 internal prototype to avoid an error.  */\n+/* We use char because int might match the return type of a gcc2\n+    builtin and then its argument prototype would still apply.  */\n+#ifdef __cplusplus\n+extern \"C\"\n+#endif\n+char dlopen();\n+\n+int main() {\n+dlopen()\n+; return 0; }\n+EOF\n+if { (eval echo $progname:1576: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+  rm -rf conftest*\n+  ac_cv_lib_svld_dlopen=yes\n+else\n+  echo \"$progname: failed program was:\" >&5\n+  cat conftest.$ac_ext >&5\n+  rm -rf conftest*\n+  ac_cv_lib_svld_dlopen=no\n+fi\n+rm -f conftest*\n+LIBS=\"$ac_save_LIBS\"\n+\n+fi\n+if test \"X$ac_cv_lib_svld_dlopen\" = Xyes; then\n+  echo \"$ac_t\"\"yes\" 1>&6\n+  lt_cv_dlopen=\"dlopen\" lt_cv_dlopen_libs=\"-lsvld\"\n+else\n+  echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for dld_link in -ldld\"\"... $ac_c\" 1>&6\n-echo \"$progname:1555: checking for dld_link in -ldld\" >&5\n+echo \"$progname:1595: checking for dld_link in -ldld\" >&5\n if test \"X${ac_cv_lib_dld_dld_link+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-ldld  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1562 \"ltconfig\"\n+#line 1602 \"ltconfig\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n     builtin and then its argument prototype would still apply.  */\n@@ -1572,7 +1612,7 @@ int main() {\n dld_link()\n ; return 0; }\n EOF\n-if { (eval echo $progname:1575: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1615: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_lib_dld_dld_link=yes\n else\n@@ -1591,12 +1631,12 @@ if test \"X$ac_cv_lib_dld_dld_link\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for shl_load\"\"... $ac_c\" 1>&6\n-echo \"$progname:1594: checking for shl_load\" >&5\n+echo \"$progname:1634: checking for shl_load\" >&5\n if test \"X${ac_cv_func_shl_load+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1599 \"ltconfig\"\n+#line 1639 \"ltconfig\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char shl_load(); below.  */\n #include <assert.h>\n@@ -1621,7 +1661,7 @@ shl_load();\n \n ; return 0; }\n EOF\n-if { (eval echo $progname:1624: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1664: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_func_shl_load=yes\n else\n@@ -1639,14 +1679,14 @@ if test \"X$ac_cv_func_shl_load\" = Xyes; then\n else\n   echo \"$ac_t\"\"no\" 1>&6\n echo $ac_n \"checking for shl_load in -ldld\"\"... $ac_c\" 1>&6\n-echo \"$progname:1642: checking for shl_load in -ldld\" >&5\n+echo \"$progname:1682: checking for shl_load in -ldld\" >&5\n if test \"X${ac_cv_lib_dld_shl_load+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-ldld  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1649 \"ltconfig\"\n+#line 1689 \"ltconfig\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -1660,7 +1700,7 @@ int main() {\n shl_load()\n ; return 0; }\n EOF\n-if { (eval echo $progname:1663: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo $progname:1703: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_lib_dld_shl_load=yes\n else\n@@ -1692,29 +1732,33 @@ fi\n \n fi\n \n+fi\n+\n fi\n \n   if test \"x$lt_cv_dlopen\" != xno; then\n     enable_dlopen=yes\n+  else\n+    enable_dlopen=no\n   fi\n \n   case \"$lt_cv_dlopen\" in\n   dlopen)\n for ac_hdr in dlfcn.h; do\n ac_safe=`echo \"$ac_hdr\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for $ac_hdr\"\"... $ac_c\" 1>&6\n-echo \"$progname:1706: checking for $ac_hdr\" >&5\n+echo \"$progname:1750: checking for $ac_hdr\" >&5\n if eval \"test \\\"`echo 'X$''{'ac_cv_header_$ac_safe'+set}'`\\\" = Xset\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1711 \"ltconfig\"\n+#line 1755 \"ltconfig\"\n #include <$ac_hdr>\n int fnord = 0;\n int main () { return(0); }\n EOF\n ac_try=\"$ac_compile >/dev/null 2>conftest.out\"\n-{ (eval echo $progname:1717: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo $progname:1761: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -1742,15 +1786,15 @@ done\n     LIBS=\"$lt_cv_dlopen_libs $LIBS\"\n \n   echo $ac_n \"checking whether a program can dlopen itself\"\"... $ac_c\" 1>&6\n-echo \"$progname:1745: checking whether a program can dlopen itself\" >&5\n+echo \"$progname:1789: checking whether a program can dlopen itself\" >&5\n if test \"X${lt_cv_dlopen_self+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     lt_cv_dlopen_self=cross\n   else\n     cat > conftest.c <<EOF\n-#line 1753 \"ltconfig\"\n+#line 1797 \"ltconfig\"\n \n #if HAVE_DLFCN_H\n #include <dlfcn.h>\n@@ -1796,7 +1840,7 @@ main() { void *self, *ptr1, *ptr2; self=dlopen(0,LTDL_GLOBAL|LTDL_LAZY_OR_NOW);\n                if(ptr1 || ptr2) { dlclose(self); exit(0); } } exit(1); }\n \n EOF\n-if { (eval echo $progname:1799: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n+if { (eval echo $progname:1843: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n then\n   lt_cv_dlopen_self=yes\n else\n@@ -1815,15 +1859,15 @@ echo \"$ac_t\"\"$lt_cv_dlopen_self\" 1>&6\n   if test \"$lt_cv_dlopen_self\" = yes; then\n     LDFLAGS=\"$LDFLAGS $link_static_flag\"\n   echo $ac_n \"checking whether a statically linked program can dlopen itself\"\"... $ac_c\" 1>&6\n-echo \"$progname:1818: checking whether a statically linked program can dlopen itself\" >&5\n+echo \"$progname:1862: checking whether a statically linked program can dlopen itself\" >&5\n if test \"X${lt_cv_dlopen_self_static+set}\" = Xset; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     lt_cv_dlopen_self_static=cross\n   else\n     cat > conftest.c <<EOF\n-#line 1826 \"ltconfig\"\n+#line 1870 \"ltconfig\"\n \n #if HAVE_DLFCN_H\n #include <dlfcn.h>\n@@ -1869,7 +1913,7 @@ main() { void *self, *ptr1, *ptr2; self=dlopen(0,LTDL_GLOBAL|LTDL_LAZY_OR_NOW);\n     if(ptr1 || ptr2) { dlclose(self); exit(0); } } exit(1); }\n \n EOF\n-if { (eval echo $progname:1872: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n+if { (eval echo $progname:1916: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest && (./conftest; exit) 2>/dev/null\n then\n   lt_cv_dlopen_self_static=yes\n else\n@@ -2090,6 +2134,9 @@ LTCC=$LTCC\n # A language-specific compiler.\n CC=$CC\n \n+# Is the compiler the GNU C compiler?\n+with_gcc=$with_gcc\n+\n # The linker used to build libraries.\n LD=$LD\n "}, {"sha": "1ce0a5d8e615c32a6a4a4b80846cf8b38971a5dc", "filename": "ltmain.sh", "status": "modified", "additions": 54, "deletions": 30, "changes": 84, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltmain.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9/ltmain.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ltmain.sh?ref=06298abdb6d1edd8fbcd8071e0353ecc2e85e3b9", "patch": "@@ -55,7 +55,7 @@ modename=\"$progname\"\n PROGRAM=ltmain.sh\n PACKAGE=libtool\n VERSION=1.4a\n-TIMESTAMP=\" (1.641.2.77 2000/08/01 04:25:15)\"\n+TIMESTAMP=\" (1.641.2.111 2000/09/05 10:29:18)\"\n \n default_mode=\n help=\"Try \\`$progname --help' for more information.\"\n@@ -483,7 +483,7 @@ if test -z \"$show_help\"; then\n       \"$CC \"*) ;;\n       # Blanks in the command may have been stripped by the calling shell,\n       # but not from the CC environment variable when ltconfig was run.\n-      \"`$echo X$CC | $Xsed` \"*) ;;\n+      \"`$echo $CC` \"*) ;;\n       *)\n         for z in $available_tags; do\n           if grep \"^### BEGIN LIBTOOL TAG CONFIG: $z$\" < \"$0\" > /dev/null; then\n@@ -497,7 +497,7 @@ if test -z \"$show_help\"; then\n               tagname=$z\n               break\n               ;;\n-\t    \"`$echo X$CC | $Xsed` \"*)\n+\t    \"`$echo $CC` \"*)\n \t      tagname=$z\n \t      break\n \t      ;;\n@@ -570,7 +570,7 @@ if test -z \"$show_help\"; then\n     # Lock this critical section if it is needed\n     # We use this script file to make the link, it avoids creating a new file\n     if test \"$need_locks\" = yes; then\n-      until ln \"$0\" \"$lockfile\" 2>/dev/null; do\n+      until $run ln \"$0\" \"$lockfile\" 2>/dev/null; do\n \t$show \"Waiting for $lockfile to be removed\"\n \tsleep 2\n       done\n@@ -768,7 +768,7 @@ EOF\n \n     # Unlock the critical section if it was locked\n     if test \"$need_locks\" != no; then\n-      $rm \"$lockfile\"\n+      $run $rm \"$lockfile\"\n     fi\n \n     exit 0\n@@ -1046,6 +1046,18 @@ EOF\n \tcontinue\n \t;;\n \n+      # The native IRIX linker understands -LANG:*, -LIST:* and -LNO:*\n+      # so, if we see these flags be careful not to treat them like -L\n+      -L[A-Z][A-Z]*:*)\n+\tcase $with_gcc/$host in\n+\tno/*-*-irix*)\n+\t  compile_command=\"$compile_command $arg\"\n+\t  finalize_command=\"$finalize_command $arg\"\n+\t  ;;\n+\tesac\n+\tcontinue\n+\t;;\n+       \n       -L*)\n \tdir=`$echo \"X$arg\" | $Xsed -e 's/^-L//'`\n \t# We need an absolute path.\n@@ -1168,11 +1180,11 @@ EOF\n \t;;\n \n       -static)\n-\t# If we have no pic_flag, then this is the same as -all-static.\n-\tif test -z \"$pic_flag\" && test -n \"$link_static_flag\"; then\n-\t  compile_command=\"$compile_command $link_static_flag\"\n-\t  finalize_command=\"$finalize_command $link_static_flag\"\n-\tfi\n+        # The effects of -static are defined in a previous loop.\n+\t# We used to do the same as -all-static on platforms that\n+\t# didn't have a PIC flag, but the assumption that the effects\n+\t# would be equivalent was wrong.  It would break on at least\n+\t# Digital Unix and AIX.\n \tcontinue\n \t;;\n \n@@ -1402,7 +1414,7 @@ EOF\n       \"$CC \"*) ;;\n       # Blanks in the command may have been stripped by the calling shell,\n       # but not from the CC environment variable when ltconfig was run.\n-      \"`$echo X$CC | $Xsed` \"*) ;;\n+      \"`$echo $CC` \"*) ;;\n       *)\n         for z in $available_tags; do\n           if grep \"^### BEGIN LIBTOOL TAG CONFIG: $z$\" < \"$0\" > /dev/null; then\n@@ -1416,7 +1428,7 @@ EOF\n               tagname=$z\n               break\n \t      ;;\n-\t    \"`$echo X$CC | $Xsed` \"*)\n+\t    \"`$echo $CC` \"*)\n \t      tagname=$z\n \t      break\n \t      ;;\n@@ -1809,6 +1821,9 @@ EOF\n \t  # are required to link).\n \t  if test -n \"$old_library\"; then\n \t    newdlprefiles=\"$newdlprefiles $dir/$old_library\"\n+\t  # Otherwise, use the dlname, so that lt_dlopen finds it.\n+\t  elif test -n \"$dlname\"; then\n+\t    newdlprefiles=\"$newdlprefiles $dir/$dlname\"\n \t  else\n \t    newdlprefiles=\"$newdlprefiles $dir/$linklib\"\n \t  fi\n@@ -1860,7 +1875,6 @@ EOF\n \n \tif test \"$linkmode,$pass\" = \"prog,link\"; then\n \t  if test -n \"$library_names\" &&\n-\t     { test \"$hardcode_into_libs\" != all || test \"$alldeplibs\" != yes; } &&\n \t     { test \"$prefer_static_libs\" = no || test -z \"$old_library\"; }; then\n \t    # We need to hardcode the library path\n \t    if test -n \"$shlibpath_var\"; then\n@@ -1913,7 +1927,8 @@ EOF\n \t    need_relink=yes\n \t  fi\n \t  # This is a shared library\n-\t  if test $linkmode = lib && test \"$hardcode_into_libs\" = all; then\n+\t  if test $linkmode = lib &&\n+\t     test $hardcode_into_libs = yes; then\n \t    # Hardcode the library path.\n \t    # Skip directories that are in the system default run-time\n \t    # search path.\n@@ -2113,7 +2128,7 @@ EOF\n \n \tif test $linkmode = lib; then\n \t  if test -n \"$dependency_libs\" &&\n-\t     { test \"$hardcode_into_libs\" = no || test $build_old_libs = yes ||\n+\t     { test $hardcode_into_libs != yes || test $build_old_libs = yes ||\n \t       test $link_static = yes; }; then\n \t    # Extract -R from dependency_libs\n \t    temp_deplibs=\n@@ -2556,7 +2571,7 @@ EOF\n \t  *) finalize_rpath=\"$finalize_rpath $libdir\" ;;\n \t  esac\n \tdone\n-\tif test \"$hardcode_into_libs\" = no || test $build_old_libs = yes; then\n+\tif test $hardcode_into_libs != yes || test $build_old_libs = yes; then\n \t  dependency_libs=\"$temp_xrpath $dependency_libs\"\n \tfi\n       fi\n@@ -2806,7 +2821,7 @@ EOF\n \n       # Test again, we may have decided not to build it any more\n       if test \"$build_libtool_libs\" = yes; then\n-\tif test \"$hardcode_into_libs\" != no; then\n+\tif test $hardcode_into_libs = yes; then\n \t  # Hardcode the library paths\n \t  hardcode_libdirs=\n \t  dep_rpath=\n@@ -2972,7 +2987,7 @@ EOF\n \tfi\n \n \t# Make a backup of the uninstalled library when relinking\n-\tif test \"$mode\" = relink && test \"$hardcode_into_libs\" = all; then\n+\tif test \"$mode\" = relink; then\n \t  $run eval '(cd $output_objdir && $rm ${realname}U && $mv $realname ${realname}U)' || exit $?\n \tfi\n \n@@ -2991,7 +3006,7 @@ EOF\n \tIFS=\"$save_ifs\"\n \n \t# Restore the uninstalled library and exit\n-\tif test \"$mode\" = relink && test \"$hardcode_into_libs\" = all; then\n+\tif test \"$mode\" = relink; then\n \t  $run eval '(cd $output_objdir && $rm ${realname}T && $mv $realname ${realname}T && $mv \"$realname\"U $realname)' || exit $?\n \t  exit 0\n \tfi\n@@ -3552,7 +3567,7 @@ static const void *lt_preloaded_setup() {\n \texit 0\n       fi\n \n-      if test \"$hardcode_action\" = relink || test \"$hardcode_into_libs\" = all; then\n+      if test \"$hardcode_action\" = relink; then\n \t# Fast installation is not supported\n \tlink_command=\"$compile_var$compile_command$compile_rpath\"\n \trelink_command=\"$finalize_var$finalize_command$finalize_rpath\"\n@@ -3590,9 +3605,14 @@ static const void *lt_preloaded_setup() {\n       if test -n \"$relink_command\"; then\n \t# Preserve any variables that may affect compiler behavior\n \tfor var in $variables_saved_for_relink; do\n-\t  eval var_value=\\$$var\n-\t  var_value=`$echo \"X$var_value\" | $Xsed -e \"$sed_quote_subst\"`\n-\t  relink_command=\"$var=\\\"$var_value\\\"; export $var; $relink_command\"\n+\t  if eval test -z \\\"\\${$var+set}\\\"; then\n+\t    relink_command=\"{ test -z \\\"\\${$var+set}\\\" || unset $var || { $var=; export $var; }; }; $relink_command\"\n+\t  elif eval var_value=\\$$var; test -z \"$var_value\"; then\n+\t    relink_command=\"$var=; export $var; $relink_command\"\n+\t  else\n+\t    var_value=`$echo \"X$var_value\" | $Xsed -e \"$sed_quote_subst\"`\n+\t    relink_command=\"$var=\\\"$var_value\\\"; export $var; $relink_command\"\n+\t  fi\n \tdone\n \trelink_command=\"cd `pwd`; $relink_command\"\n \trelink_command=`$echo \"X$relink_command\" | $Xsed -e \"$sed_quote_subst\"`\n@@ -3908,9 +3928,14 @@ fi\\\n \n       # Preserve any variables that may affect compiler behavior\n       for var in $variables_saved_for_relink; do\n-\teval var_value=\\$$var\n-\tvar_value=`$echo \"X$var_value\" | $Xsed -e \"$sed_quote_subst\"`\n-\trelink_command=\"$var=\\\"$var_value\\\"; export $var; $relink_command\"\n+\tif eval test -z \\\"\\${$var+set}\\\"; then\n+\t  relink_command=\"{ test -z \\\"\\${$var+set}\\\" || unset $var || { $var=; export $var; }; }; $relink_command\"\n+\telif eval var_value=\\$$var; test -z \"$var_value\"; then\n+\t  relink_command=\"$var=; export $var; $relink_command\"\n+\telse\n+\t  var_value=`$echo \"X$var_value\" | $Xsed -e \"$sed_quote_subst\"`\n+\t  relink_command=\"$var=\\\"$var_value\\\"; export $var; $relink_command\"\n+\tfi\n       done\n       # Quote the link command for shipping.\n       relink_command=\"cd `pwd`; $SHELL $0 --mode=relink $libtool_args\"\n@@ -3998,8 +4023,7 @@ dlpreopen='$dlprefiles'\n \n # Directory that this library needs to be installed in:\n libdir='$install_libdir'\"\n-\t  if test $hardcode_into_libs = all &&\n-\t     test \"$installed\" = no && test $need_relink = yes; then\n+\t  if test \"$installed\" = no && test $need_relink = yes; then\n \t    $echo >> $output \"\\\n relink_command=\\\"$relink_command\\\"\"\n \t  fi\n@@ -4209,7 +4233,7 @@ relink_command=\\\"$relink_command\\\"\"\n \ttest \"X$dir\" = \"X$file/\" && dir=\n \tdir=\"$dir$objdir\"\n \n-\tif test \"$hardcode_into_libs\" = all && test -n \"$relink_command\"; then\n+\tif test -n \"$relink_command\"; then\n \t  $echo \"$modename: warning: relinking \\`$file'\" 1>&2\n \t  $show \"$relink_command\"\n \t  if $run eval \"$relink_command\"; then :\n@@ -4227,7 +4251,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t  shift\n \n \t  srcname=\"$realname\"\n-\t  test \"$hardcode_into_libs\" = all && test -n \"$relink_command\" && srcname=\"$realname\"T\n+\t  test -n \"$relink_command\" && srcname=\"$realname\"T\n \n \t  # Install the shared library and build the symlinks.\n \t  $show \"$install_prog $dir/$srcname $destdir/$realname\""}]}