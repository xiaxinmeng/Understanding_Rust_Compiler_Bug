{"sha": "dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQ2ZjJjZjk4YzEzMmQ0OTNjOWJhN2M1NjAyZDJhZGUyZWZhOTdmNA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2016-01-20T08:36:32Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-01-20T08:36:32Z"}, "message": "re PR target/69345 (459.GemsFDTD regression)\n\n2016-01-20  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/69345\n\t* tree-ssa-sccvn.h (VN_INFO_RANGE_INFO): New inline function.\n\t(VN_INFO_PTR_INFO): Likewise.\n\t* tree-ssa-sccvn.c (set_ssa_val_to): Avoid clearing points-to\n\tinfo when it is equal between non-dominating SSA names.\n\t* tree-ssa-pre.c (eliminate_dom_walker::before_dom_children):\n\tMake sure to look at original SSA infos.\n\nFrom-SVN: r232603", "tree": {"sha": "25f916a4031cfa3e7564c20c520aa54e2b7d7499", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25f916a4031cfa3e7564c20c520aa54e2b7d7499"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bf0bb9703a83ddbe48d166d24ca2eeab22ad9886", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf0bb9703a83ddbe48d166d24ca2eeab22ad9886", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf0bb9703a83ddbe48d166d24ca2eeab22ad9886"}], "stats": {"total": 50, "additions": 42, "deletions": 8}, "files": [{"sha": "d67503867856bf9a9e33fefc01cdef99e113512a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "patch": "@@ -1,3 +1,13 @@\n+2016-01-20  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/69345\n+\t* tree-ssa-sccvn.h (VN_INFO_RANGE_INFO): New inline function.\n+\t(VN_INFO_PTR_INFO): Likewise.\n+\t* tree-ssa-sccvn.c (set_ssa_val_to): Avoid clearing points-to\n+\tinfo when it is equal between non-dominating SSA names.\n+\t* tree-ssa-pre.c (eliminate_dom_walker::before_dom_children):\n+\tMake sure to look at original SSA infos.\n+\n 2016-01-20  Jeff Law  <law@redhat.com>\n \n \tPR target/25114"}, {"sha": "311663d80a2392ab1044d7c07e66559fb7e9ccfd", "filename": "gcc/tree-ssa-pre.c", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2Ftree-ssa-pre.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2Ftree-ssa-pre.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-pre.c?ref=dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "patch": "@@ -4033,22 +4033,22 @@ eliminate_dom_walker::before_dom_children (basic_block b)\n \t    {\n \t      basic_block sprime_b = gimple_bb (SSA_NAME_DEF_STMT (sprime));\n \t      if (POINTER_TYPE_P (TREE_TYPE (lhs))\n-\t\t  && SSA_NAME_PTR_INFO (lhs)\n-\t\t  && !SSA_NAME_PTR_INFO (sprime))\n+\t\t  && VN_INFO_PTR_INFO (lhs)\n+\t\t  && ! VN_INFO_PTR_INFO (sprime))\n \t\t{\n \t\t  duplicate_ssa_name_ptr_info (sprime,\n-\t\t\t\t\t       SSA_NAME_PTR_INFO (lhs));\n+\t\t\t\t\t       VN_INFO_PTR_INFO (lhs));\n \t\t  if (b != sprime_b)\n \t\t    mark_ptr_info_alignment_unknown\n \t\t\t(SSA_NAME_PTR_INFO (sprime));\n \t\t}\n-\t      else if (!POINTER_TYPE_P (TREE_TYPE (lhs))\n-\t\t       && SSA_NAME_RANGE_INFO (lhs)\n-\t\t       && !SSA_NAME_RANGE_INFO (sprime)\n+\t      else if (INTEGRAL_TYPE_P (TREE_TYPE (lhs))\n+\t\t       && VN_INFO_RANGE_INFO (lhs)\n+\t\t       && ! VN_INFO_RANGE_INFO (sprime)\n \t\t       && b == sprime_b)\n \t\tduplicate_ssa_name_range_info (sprime,\n \t\t\t\t\t       SSA_NAME_RANGE_TYPE (lhs),\n-\t\t\t\t\t       SSA_NAME_RANGE_INFO (lhs));\n+\t\t\t\t\t       VN_INFO_RANGE_INFO (lhs));\n \t    }\n \n \t  /* Inhibit the use of an inserted PHI on a loop header when"}, {"sha": "e7bac420dbb1c1361bfc35ee56cb23dd63fe59e7", "filename": "gcc/tree-ssa-sccvn.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2Ftree-ssa-sccvn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2Ftree-ssa-sccvn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-sccvn.c?ref=dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "patch": "@@ -3092,7 +3092,11 @@ set_ssa_val_to (tree from, tree to)\n \t\t  /* Use that from the dominator.  */\n \t\t  SSA_NAME_PTR_INFO (to) = SSA_NAME_PTR_INFO (from);\n \t\t}\n-\t      else\n+\t      else if (! SSA_NAME_PTR_INFO (from)\n+\t\t       /* Handle the case of trivially equivalent info.  */\n+\t\t       || memcmp (SSA_NAME_PTR_INFO (to),\n+\t\t\t\t  SSA_NAME_PTR_INFO (from),\n+\t\t\t\t  sizeof (ptr_info_def)) != 0)\n \t\t{\n \t\t  /* Save old info.  */\n \t\t  if (! VN_INFO (to)->info.ptr_info)"}, {"sha": "14093ddca44f6218d9e5ef7682eabe0ed2b208ec", "filename": "gcc/tree-ssa-sccvn.h", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2Ftree-ssa-sccvn.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4/gcc%2Ftree-ssa-sccvn.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-sccvn.h?ref=dd6f2cf98c132d493c9ba7c5602d2ade2efa97f4", "patch": "@@ -243,4 +243,24 @@ vn_valueize (tree name)\n   return name;\n }\n \n+/* Get at the original range info for NAME.  */\n+\n+inline range_info_def *\n+VN_INFO_RANGE_INFO (tree name)\n+{\n+  return (VN_INFO (name)->info.range_info\n+\t  ? VN_INFO (name)->info.range_info\n+\t  : SSA_NAME_RANGE_INFO (name));\n+}\n+\n+/* Get at the original pointer info for NAME.  */\n+\n+inline ptr_info_def *\n+VN_INFO_PTR_INFO (tree name)\n+{\n+  return (VN_INFO (name)->info.ptr_info\n+\t  ? VN_INFO (name)->info.ptr_info\n+\t  : SSA_NAME_PTR_INFO (name));\n+}\n+\n #endif /* TREE_SSA_SCCVN_H  */"}]}