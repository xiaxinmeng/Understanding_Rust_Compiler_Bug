{"sha": "63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjNiZjlhOTA2YzRjOGZhNTk1MmZkNDk0ZThiN2Q0NTc1M2I4ODdiYg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2013-09-01T11:59:27Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2013-09-01T11:59:27Z"}, "message": "fork-instrumentation.c: New testcase.\n\n\n\t* gcc.dg/fork-instrumentation.c: New testcase.\n\t* builtins.c (expand_builtin): Do not exit early for gcov\n\tinstrumented functions.\n\nFrom-SVN: r202142", "tree": {"sha": "f5f01e673b1da6ea30dda2913878744df6918adb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f5f01e673b1da6ea30dda2913878744df6918adb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/comments", "author": null, "committer": null, "parents": [{"sha": "f5c7238f2ea0804ae11af08140695fca34ec3004", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5c7238f2ea0804ae11af08140695fca34ec3004", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5c7238f2ea0804ae11af08140695fca34ec3004"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "b141e613bc4bb344fc9444f4e3113239b1f64874", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "patch": "@@ -1,3 +1,8 @@\n+2013-08-31  Jan Hubicka  <jh@suse.cz>\n+\n+\t* bulitins.c (expand_builtin): Do not early exit for gcov\n+\tinstrumented functions.\n+\n 2013-08-31  Marek Polacek  <polacek@redhat.com>\n \n \t* ubsan.c: Include tm_p.h."}, {"sha": "581a05074257dc95cd30989ea776011ae243f1f5", "filename": "gcc/builtins.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "patch": "@@ -5851,6 +5851,13 @@ expand_builtin (tree exp, rtx target, rtx subtarget, enum machine_mode mode,\n      set of builtins.  */\n   if (!optimize\n       && !called_as_built_in (fndecl)\n+      && fcode != BUILT_IN_FORK\n+      && fcode != BUILT_IN_EXECL\n+      && fcode != BUILT_IN_EXECV\n+      && fcode != BUILT_IN_EXECLP\n+      && fcode != BUILT_IN_EXECLE\n+      && fcode != BUILT_IN_EXECVP\n+      && fcode != BUILT_IN_EXECVE\n       && fcode != BUILT_IN_ALLOCA\n       && fcode != BUILT_IN_ALLOCA_WITH_ALIGN\n       && fcode != BUILT_IN_FREE)"}, {"sha": "9cbc4276f568c4f9301201c162eeeb7f54ab7e6a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "patch": "@@ -1,3 +1,7 @@\n+2013-08-31  Jan Hubicka  <jh@suse.cz>\n+\n+\t* gcc.dg/fork-instrumentation.c: New testcase.\n+\n 2013-08-30  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* g++.dg/abi/mangle33.C (dg-final): Use match count in scan RE."}, {"sha": "bd9bf41cd2f46ae2e29608841acf459d07468f40", "filename": "gcc/testsuite/gcc.dg/fork-instrumentation.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2Ftestsuite%2Fgcc.dg%2Ffork-instrumentation.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63bf9a906c4c8fa5952fd494e8b7d45753b887bb/gcc%2Ftestsuite%2Fgcc.dg%2Ffork-instrumentation.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ffork-instrumentation.c?ref=63bf9a906c4c8fa5952fd494e8b7d45753b887bb", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O0 -fprofile-generate\" } */\n+int fork(void);\n+t()\n+{\n+  fork ();\n+}\n+/* { dg-final { scan-assembler \"gcov_fork\" } } */"}]}