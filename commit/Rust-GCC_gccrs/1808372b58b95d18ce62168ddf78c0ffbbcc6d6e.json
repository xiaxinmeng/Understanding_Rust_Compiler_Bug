{"sha": "1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTgwODM3MmI1OGI5NWQxOGNlNjIxNjhkZGY3OGMwZmZiYmNjNmQ2ZQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2001-12-14T21:56:29Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-12-14T21:56:29Z"}, "message": "For PR libgcj/5103:\n\n\t* libjava.jni/cxxtest.out: New file.\n\t* libjava.jni/cxxtest.cc: New file.\n\t* libjava.jni/cxxtest.java: New file.\n\t* libjava.jni/jni.exp (gcj_jni_test_one): If there is no .c file,\n\tassume there is a .cc file.\n\nFrom-SVN: r48012", "tree": {"sha": "5a220d504853a608283a932d2ac9a64d8df7490e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5a220d504853a608283a932d2ac9a64d8df7490e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/comments", "author": null, "committer": null, "parents": [{"sha": "27b2c32e31da807ee1c01e371447db238c7ad02c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27b2c32e31da807ee1c01e371447db238c7ad02c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27b2c32e31da807ee1c01e371447db238c7ad02c"}], "stats": {"total": 68, "additions": 67, "deletions": 1}, "files": [{"sha": "de7df24277f5b371941dd2ff24f12c81ebf9ad8d", "filename": "libjava/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2FChangeLog?ref=1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "patch": "@@ -1,3 +1,12 @@\n+2001-12-13  Tom Tromey  <tromey@redhat.com>\n+\n+\tFor PR libgcj/5103:\n+\t* libjava.jni/cxxtest.out: New file.\n+\t* libjava.jni/cxxtest.cc: New file.\n+\t* libjava.jni/cxxtest.java: New file.\n+\t* libjava.jni/jni.exp (gcj_jni_test_one): If there is no .c file,\n+\tassume there is a .cc file.\n+\n 2001-12-09  Bryce McKinlay  <bryce@waitaki.otago.ac.nz>\n \n \t* libjava.lang/PR3731.out: Adjust output to reflect that \"instanceof\""}, {"sha": "577273bb5a2e16a1acbf3dffba66ad20fcaaff8d", "filename": "libjava/testsuite/libjava.jni/cxxtest.cc", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.cc?ref=1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "patch": "@@ -0,0 +1,24 @@\n+#include <jni.h>\n+#include <cxxtest.h>\n+\n+jobjectArray\n+Java_cxxtest_fetch (JNIEnv *env, jobject _this)\n+{\n+  jclass cls;\n+  jfieldID fid;\n+  jobjectArray obj;\n+\n+  cls = env->GetObjectClass (_this);\n+  if (! cls)\n+    return 0;\n+\n+  fid = env->GetFieldID (cls, \"F\", \"[Ljava/lang/Object;\");\n+  if (! fid)\n+    return 0;\n+\n+  obj = reinterpret_cast<jobjectArray> (env->GetObjectField (_this, fid));\n+\n+  return obj;\n+}\n+\n+"}, {"sha": "b1c3bb945fa1285dcfbbe74f8f64647d89138938", "filename": "libjava/testsuite/libjava.jni/cxxtest.java", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.java?ref=1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "patch": "@@ -0,0 +1,25 @@\n+// Test for array field lookup.\n+\n+public class cxxtest\n+{\n+  // A field for us to look up.\n+  public Object[] F = new Object[7];\n+\n+  public native Object[] fetch ();\n+\n+  public void doit ()\n+  {\n+    System.out.println (F == fetch ());\n+  }\n+\n+  public static void main (String[] args)\n+  {\n+    cxxtest q = new cxxtest ();\n+    q.doit ();\n+  }\n+\n+  static\n+  {\n+    System.loadLibrary (\"cxxtest\");\n+  }\n+}"}, {"sha": "27ba77ddaf61532f217964734769a42cdabc17dc", "filename": "libjava/testsuite/libjava.jni/cxxtest.out", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.out", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.out", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jni%2Fcxxtest.out?ref=1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "patch": "@@ -0,0 +1 @@\n+true"}, {"sha": "ec599457ee567c5b475a56b44818121811c2ef00", "filename": "libjava/testsuite/libjava.jni/jni.exp", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fjni.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1808372b58b95d18ce62168ddf78c0ffbbcc6d6e/libjava%2Ftestsuite%2Flibjava.jni%2Fjni.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jni%2Fjni.exp?ref=1808372b58b95d18ce62168ddf78c0ffbbcc6d6e", "patch": "@@ -106,14 +106,21 @@ proc gcj_jni_test_one {file} {\n   }\n \n   set cfile [file rootname $file].c\n+  set cxxflags \"\"\n+  # If there is no `.c' file, assume there is a `.cc' file.\n+  if {! [file exists $cfile]} {\n+    set cfile [file rootname $file].cc\n+    set cxxflags \"-lstdc++\"\n+  }\n+\n   if {! [gcj_jni_compile_c_to_so $cfile]} {\n     # FIXME\n     return 0\n   }\n \n   # We use -l$main because the .so is named the same as the main\n   # program.\n-  set args [list \"additional_flags=-fjni -L. -l$main\"]\n+  set args [list \"additional_flags=-fjni -L. -l$main $cxxflags\"]\n   if {! [gcj_link $main $main $file $args]} {\n     # FIXME\n     return 0"}]}