{"sha": "128e09f93d6fa5fc367ad2be059c6dd674ef1049", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTI4ZTA5ZjkzZDZmYTVmYzM2N2FkMmJlMDU5YzZkZDY3NGVmMTA0OQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2011-04-04T20:22:21Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2011-04-04T20:22:21Z"}, "message": "re PR fortran/48412 (CP2K miscompiled due to some Fortran frontend pass)\n\n2011-04-04  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/48412\n\t* frontend-passes (cfe_expr_0):  Reverse the order of going\n\tthrough the loops.\n\n2011-04-04  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/48412\n\t* function_optimize_4.f90:  New test.\n\nFrom-SVN: r171952", "tree": {"sha": "58f550f5722fb6ab76045f077f43698d59c89d4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/58f550f5722fb6ab76045f077f43698d59c89d4c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/128e09f93d6fa5fc367ad2be059c6dd674ef1049", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/128e09f93d6fa5fc367ad2be059c6dd674ef1049", "html_url": "https://github.com/Rust-GCC/gccrs/commit/128e09f93d6fa5fc367ad2be059c6dd674ef1049", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/128e09f93d6fa5fc367ad2be059c6dd674ef1049/comments", "author": null, "committer": null, "parents": [{"sha": "e5b0e1cab42d2b6e364e856dcdade434b8241c17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5b0e1cab42d2b6e364e856dcdade434b8241c17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e5b0e1cab42d2b6e364e856dcdade434b8241c17"}], "stats": {"total": 39, "additions": 35, "deletions": 4}, "files": [{"sha": "bea09ffe3e4f3d110fa67d951c9ea9fd72421754", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=128e09f93d6fa5fc367ad2be059c6dd674ef1049", "patch": "@@ -1,3 +1,9 @@\n+2011-04-04  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/48412\n+\t* frontend-passes (cfe_expr_0):  Reverse the order of going\n+\tthrough the loops.\n+\n 2011-04-04  Tobias Burnus  <burnus@net-b.de>\n \t    Mikael Morin  <mikael.morin@sfr.fr>\n "}, {"sha": "c2f6bd5b0268e38206a7583bd3369eb409eff544", "filename": "gcc/fortran/frontend-passes.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ffortran%2Ffrontend-passes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ffortran%2Ffrontend-passes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ffrontend-passes.c?ref=128e09f93d6fa5fc367ad2be059c6dd674ef1049", "patch": "@@ -295,16 +295,16 @@ cfe_expr_0 (gfc_expr **e, int *walk_subtrees,\n \n   gfc_expr_walker (e, cfe_register_funcs, NULL);\n \n-  /* Walk backwards through all the functions to make sure we\n-     catch the leaf functions first.  */\n-  for (i=expr_count-1; i>=1; i--)\n+  /* Walk through all the functions.  */\n+\n+  for (i=1; i<expr_count; i++)\n     {\n       /* Skip if the function has been replaced by a variable already.  */\n       if ((*(expr_array[i]))->expr_type == EXPR_VARIABLE)\n \tcontinue;\n \n       newvar = NULL;\n-      for (j=i-1; j>=0; j--)\n+      for (j=0; j<i; j++)\n \t{\n \t  if (gfc_dep_compare_functions(*(expr_array[i]),\n \t\t\t\t\t*(expr_array[j]), true)\t== 0)"}, {"sha": "afef468e17b16e5a09bd39c856291a4334ac74d8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=128e09f93d6fa5fc367ad2be059c6dd674ef1049", "patch": "@@ -1,3 +1,8 @@\n+2011-04-04  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/48412\n+\t* function_optimize_4.f90:  New test.\n+\n 2011-04-04  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/18918"}, {"sha": "20fc46d3078b58931907e1bb9cc82f385101f372", "filename": "gcc/testsuite/gfortran.dg/function_optimize_4.f90", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ftestsuite%2Fgfortran.dg%2Ffunction_optimize_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/128e09f93d6fa5fc367ad2be059c6dd674ef1049/gcc%2Ftestsuite%2Fgfortran.dg%2Ffunction_optimize_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ffunction_optimize_4.f90?ref=128e09f93d6fa5fc367ad2be059c6dd674ef1049", "patch": "@@ -0,0 +1,20 @@\n+! { dg-do run }\n+! { dg-options \"-O\" }\n+! PR 48412 - function elimination got temporary varibles in the wrong order.\n+! Test case contributed by Joost VandeVondele.\n+\n+INTEGER FUNCTION S1(m,ma,lx)\n+INTEGER :: m,ma,lx\n+\n+IF (((m < 0).AND.(MODULO(ABS(ma-lx),2) == 1)).OR.&\n+    ((m > 0).AND.(MODULO(ABS(ma-lx),2) == 0))) THEN\n+   S1=1\n+ELSE\n+   S1=0\n+ENDIF\n+\n+END FUNCTION\n+\n+INTEGER :: s1\n+IF (S1(1,2,1).NE.0) CALL ABORT()\n+END"}]}