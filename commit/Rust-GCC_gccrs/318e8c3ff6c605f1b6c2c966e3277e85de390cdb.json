{"sha": "318e8c3ff6c605f1b6c2c966e3277e85de390cdb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzE4ZThjM2ZmNmM2MDVmMWI2YzJjOTY2ZTMyNzdlODVkZTM5MGNkYg==", "commit": {"author": {"name": "Ilie Garbacea", "email": "ilie@mips.com", "date": "2008-07-28T18:47:44Z"}, "committer": {"name": "Chao-ying Fu", "email": "chaoyingfu@gcc.gnu.org", "date": "2008-07-28T18:47:44Z"}, "message": "configure.tgt: Enable futex for MIPS.\n\n* configure.tgt: Enable futex for MIPS.\n* config/linux/mips/futex.h: New file.\n\nCo-Authored-By: Chao-ying Fu <fu@mips.com>\n\nFrom-SVN: r138214", "tree": {"sha": "7703480670fb09e172ea189f5f5299f55c5d4967", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7703480670fb09e172ea189f5f5299f55c5d4967"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/318e8c3ff6c605f1b6c2c966e3277e85de390cdb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/318e8c3ff6c605f1b6c2c966e3277e85de390cdb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/318e8c3ff6c605f1b6c2c966e3277e85de390cdb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/318e8c3ff6c605f1b6c2c966e3277e85de390cdb/comments", "author": null, "committer": null, "parents": [{"sha": "1961418e82984387246089d7254c766c9e7972aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1961418e82984387246089d7254c766c9e7972aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1961418e82984387246089d7254c766c9e7972aa"}], "stats": {"total": 85, "additions": 85, "deletions": 0}, "files": [{"sha": "72cee069a157be04e3cbb3c1ff5d40115e422163", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/318e8c3ff6c605f1b6c2c966e3277e85de390cdb/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/318e8c3ff6c605f1b6c2c966e3277e85de390cdb/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=318e8c3ff6c605f1b6c2c966e3277e85de390cdb", "patch": "@@ -1,3 +1,9 @@\n+2008-07-28  Ilie Garbacea  <ilie@mips.com>\n+\t    Chao-ying Fu  <fu@mips.com>\n+\n+\t* configure.tgt: Enable futex for MIPS.\n+\t* config/linux/mips/futex.h: New file.\n+\n 2008-07-16  Jakub Jelinek  <jakub@redhat.com>\n \n \t* team.c (gomp_team_end): Free team immediately if it has"}, {"sha": "9327cc84a49f78d7ad1b4be65d97bdfad113c67b", "filename": "libgomp/config/linux/mips/futex.h", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/318e8c3ff6c605f1b6c2c966e3277e85de390cdb/libgomp%2Fconfig%2Flinux%2Fmips%2Ffutex.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/318e8c3ff6c605f1b6c2c966e3277e85de390cdb/libgomp%2Fconfig%2Flinux%2Fmips%2Ffutex.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfig%2Flinux%2Fmips%2Ffutex.h?ref=318e8c3ff6c605f1b6c2c966e3277e85de390cdb", "patch": "@@ -0,0 +1,75 @@\n+/* Copyright (C) 2005, 2008 Free Software Foundation, Inc.\n+   Contributed by Ilie Garbacea <ilie@mips.com>, Chao-ying Fu <fu@mips.com>.\n+\n+   This file is part of the GNU OpenMP Library (libgomp).\n+\n+   Libgomp is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Lesser General Public License as published by\n+   the Free Software Foundation; either version 2.1 of the License, or\n+   (at your option) any later version.\n+\n+   Libgomp is distributed in the hope that it will be useful, but WITHOUT ANY\n+   WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n+   FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for\n+   more details.\n+\n+   You should have received a copy of the GNU Lesser General Public License \n+   along with libgomp; see the file COPYING.LIB.  If not, write to the\n+   Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,\n+   MA 02110-1301, USA.  */\n+\n+/* As a special exception, if you link this library with other files, some\n+   of which are compiled with GCC, to produce an executable, this library\n+   does not by itself cause the resulting executable to be covered by the\n+   GNU General Public License.  This exception does not however invalidate\n+   any other reasons why the executable file might be covered by the GNU\n+   General Public License.  */\n+\n+/* Provide target-specific access to the futex system call.  */\n+\n+#include <sys/syscall.h>\n+#define FUTEX_WAIT 0\n+#define FUTEX_WAKE 1\n+\n+static inline void\n+sys_futex0 (int *addr, int op, int val)\n+{\n+  register unsigned long __v0 asm(\"$2\") = (unsigned long) SYS_futex;\n+  register unsigned long __a0 asm(\"$4\") = (unsigned long) addr;\n+  register unsigned long __a1 asm(\"$5\") = (unsigned long) op;\n+  register unsigned long __a2 asm(\"$6\") = (unsigned long) val;\n+  register unsigned long __a3 asm(\"$7\") = 0;\n+\n+  __asm volatile (\"syscall\"\n+\t\t  /* returns $a3 (errno), $v0 (return value) */\n+\t\t  : \"=r\" (__v0), \"=r\" (__a3)\n+\t\t  /* arguments in v0 (syscall) a0-a3 */\n+\t\t  : \"r\" (__v0), \"r\" (__a0), \"r\" (__a1), \"r\" (__a2), \"r\" (__a3)\n+\t\t  /* clobbers at, v1, t0-t9, memory */\n+\t\t  : \"$1\", \"$3\", \"$8\", \"$9\", \"$10\", \"$11\", \"$12\", \"$13\", \"$14\",\n+\t\t    \"$15\", \"$24\", \"$25\", \"memory\");\n+}\n+\n+static inline void\n+futex_wait (int *addr, int val)\n+{\n+  sys_futex0 (addr, FUTEX_WAIT, val);\n+}\n+\n+static inline void\n+futex_wake (int *addr, int count)\n+{\n+  sys_futex0 (addr, FUTEX_WAKE, count);\n+}\n+\n+static inline void\n+cpu_relax (void)\n+{\n+  __asm volatile (\"\" : : : \"memory\");\n+}\n+\n+static inline void\n+atomic_write_barrier (void)\n+{\n+  __sync_synchronize ();\n+}"}, {"sha": "ef44a12a4bda3244f16093dd0ff1137d3ecb0a6e", "filename": "libgomp/configure.tgt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/318e8c3ff6c605f1b6c2c966e3277e85de390cdb/libgomp%2Fconfigure.tgt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/318e8c3ff6c605f1b6c2c966e3277e85de390cdb/libgomp%2Fconfigure.tgt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfigure.tgt?ref=318e8c3ff6c605f1b6c2c966e3277e85de390cdb", "patch": "@@ -35,6 +35,10 @@ if test $enable_linux_futex = yes; then\n \tconfig_path=\"linux/ia64 linux posix\"\n \t;;\n \n+    mips*-*-linux*)\n+\tconfig_path=\"linux/mips linux posix\"\n+\t;;\n+\n     powerpc*-*-linux*)\n \tconfig_path=\"linux/powerpc linux posix\"\n \t;;"}]}