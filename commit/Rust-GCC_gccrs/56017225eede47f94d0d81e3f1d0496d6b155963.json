{"sha": "56017225eede47f94d0d81e3f1d0496d6b155963", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTYwMTcyMjVlZWRlNDdmOTRkMGQ4MWUzZjFkMDQ5NmQ2YjE1NTk2Mw==", "commit": {"author": {"name": "Andreas Tobler", "email": "andreast@gcc.gnu.org", "date": "2020-01-21T21:16:02Z"}, "committer": {"name": "Andreas Tobler", "email": "andreast@gcc.gnu.org", "date": "2020-05-01T18:31:41Z"}, "message": "testsuite: Enable asan tests on FreeBSD x86_64\n\nEnable asan tests on FreeBSD x86_64.\n\ntestsuite:\n\n\t* gcc.dg/asan/pr87930.c: Enable on x86_64 FreeBSD.\n\t* c-c++-common/asan/asan-interface-1.c: Likewise.\n\t* c-c++-common/asan/clone-test-1.c: Likewise.\n\t* c-c++-common/asan/no-asan-stack.c: Likewise.\n\t* c-c++-common/asan/pr59063-1.c: Likewise.\n\t* c-c++-common/asan/pr59063-2.c: Likewise.\n\t* g++.dg/asan/asan_test.C: Likewise.\n\t* g++.dg/asan/asan_test_utils.h: Likewise.\n\t* g++.dg/asan/interception-failure-test-1.C: Likewise.\n\t* g++.dg/asan/interception-malloc-test-1.C: Likewise.", "tree": {"sha": "e989d438a7948f69aaae09def9d6e029c2bee0c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e989d438a7948f69aaae09def9d6e029c2bee0c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/56017225eede47f94d0d81e3f1d0496d6b155963", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56017225eede47f94d0d81e3f1d0496d6b155963", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56017225eede47f94d0d81e3f1d0496d6b155963", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56017225eede47f94d0d81e3f1d0496d6b155963/comments", "author": null, "committer": null, "parents": [{"sha": "82d5decef38b5562d97c49a70ca2636a08769dbc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82d5decef38b5562d97c49a70ca2636a08769dbc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82d5decef38b5562d97c49a70ca2636a08769dbc"}], "stats": {"total": 43, "additions": 30, "deletions": 13}, "files": [{"sha": "949b81a4392c93533acd98edb43fc6713df746db", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,3 +1,16 @@\n+2020-05-01  Andreas Tobler  <andreast@gcc.gnu.org>\n+\n+\t* gcc.dg/asan/pr87930.c: Enable on x86_64 FreeBSD.\n+\t* c-c++-common/asan/asan-interface-1.c: Likewise.\n+\t* c-c++-common/asan/clone-test-1.c: Likewise.\n+\t* c-c++-common/asan/no-asan-stack.c: Likewise.\n+\t* c-c++-common/asan/pr59063-1.c: Likewise.\n+\t* c-c++-common/asan/pr59063-2.c: Likewise.\n+\t* g++.dg/asan/asan_test.C: Likewise.\n+\t* g++.dg/asan/asan_test_utils.h: Likewise.\n+\t* g++.dg/asan/interception-failure-test-1.C: Likewise.\n+\t* g++.dg/asan/interception-malloc-test-1.C: Likewise.\n+\n 2020-04-30  Peter Bergner  <bergner@linux.ibm.com>\n \n \tPR rtl-optimization/94740"}, {"sha": "2bf1fae857fa6c333b369f80807e77691f76fb26", "filename": "gcc/testsuite/c-c++-common/asan/asan-interface-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fasan-interface-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fasan-interface-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fasan-interface-1.c?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,6 +1,6 @@\n /* Check that interface headers work. */\n \n-/* { dg-do run { target { *-*-linux* } } } */\n+/* { dg-do run { target { *-*-linux* *-*-freebsd* } } } */\n \n #include <sanitizer/asan_interface.h>\n "}, {"sha": "b95ec32f9ef986f75dddfb5da6e7314a7fda0d1f", "filename": "gcc/testsuite/c-c++-common/asan/clone-test-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fclone-test-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fclone-test-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fclone-test-1.c?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,7 +1,7 @@\n /* Regression test for:\n    http://code.google.com/p/address-sanitizer/issues/detail?id=37 */\n \n-/* { dg-do run { target { *-*-linux* } } } */\n+/* { dg-do run { target { *-*-linux* x86_64-*-freebsd* } } } */\n /* { dg-require-effective-target clone } */\n /* { dg-require-effective-target hw } */\n /* { dg-options \"-D_GNU_SOURCE\" } */"}, {"sha": "9d1d37cb6c4a359aa5d544cd67cf3ed80a6b0f2e", "filename": "gcc/testsuite/c-c++-common/asan/no-asan-stack.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fno-asan-stack.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fno-asan-stack.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fno-asan-stack.c?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do compile { target { { i?86-*-linux* x86_64-*-linux* } && lp64 } } } */\n+/* { dg-do compile { target { { i?86-*-linux* x86_64-*-linux* x86_64-*-freebsd* } && lp64 } } } */\n /* { dg-options \"--param asan-stack=0\" } */\n #include <string.h>\n "}, {"sha": "1cc7f6f942863e433acbfa59d0e94c9e18287e22", "filename": "gcc/testsuite/c-c++-common/asan/pr59063-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fpr59063-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fpr59063-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fpr59063-1.c?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do run { target { *-*-linux* } } } */\n+/* { dg-do run { target { *-*-linux* *-*-freebsd* } } } */\n \n #include <time.h>\n static int weak_gettime (clockid_t clk_id, struct timespec *tp)"}, {"sha": "63a547f033f255204452d5f49c91e4a3d5b33068", "filename": "gcc/testsuite/c-c++-common/asan/pr59063-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fpr59063-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fpr59063-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fasan%2Fpr59063-2.c?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do run { target { *-*-linux* } } } */\n+/* { dg-do run { target { *-*-linux* *-*-freebsd* } } } */\n /* { dg-options \"-static-libasan\" } */\n \n #include <time.h>"}, {"sha": "ca989a36bbd88e4fc8a24014012becd61d9578e0", "filename": "gcc/testsuite/g++.dg/asan/asan_test.C", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Fasan_test.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Fasan_test.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Fasan_test.C?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,12 +1,13 @@\n-// { dg-do run { target { { *-*-linux* } && { { ! { i?86-*-linux* x86_64-*-linux* } } || sse2_runtime } } } }\n+// { dg-do run { target { { *-*-linux* i?86-*-freebsd* x86_64-*-freebsd* } && { { ! { i?86-*-linux* x86_64-*-linux* i?86-*-freebsd* x86_64-*-freebsd* } } || sse2_runtime } } } }\n // { dg-skip-if \"\" { *-*-* } { \"*\" } { \"-O2\" } }\n // { dg-skip-if \"\" { *-*-* } { \"-flto\" } { \"\" } }\n // { dg-additional-sources \"asan_globals_test-wrapper.cc\" }\n-// { dg-options \"-std=c++11 -fsanitize=address -fno-builtin -Wall -Werror -Wno-alloc-size-larger-than -g -DASAN_UAR=0 -DASAN_HAS_EXCEPTIONS=1 -DASAN_HAS_BLACKLIST=0 -DSANITIZER_USE_DEJAGNU_GTEST=1 -lasan -lpthread -ldl\" }\n+// { dg-options \"-std=c++11 -fsanitize=address -fno-builtin -Wall -Werror -Wno-alloc-size-larger-than -g -DASAN_UAR=0 -DASAN_HAS_EXCEPTIONS=1 -DASAN_HAS_BLACKLIST=0 -DSANITIZER_USE_DEJAGNU_GTEST=1 -lasan -lpthread\" }\n+// { dg-additional-options \"-ldl\" { target { ! *-*-freebsd* } } }\n // { dg-additional-options \"-DASAN_NEEDS_SEGV=1\" { target { ! arm*-*-* } } }\n // { dg-additional-options \"-DASAN_LOW_MEMORY=1 -DASAN_NEEDS_SEGV=0\" { target arm*-*-* } }\n // { dg-additional-options \"-DASAN_AVOID_EXPENSIVE_TESTS=1\" { target { ! run_expensive_tests } } }\n-// { dg-additional-options \"-msse2\" { target { i?86-*-linux* x86_64-*-linux* } } }\n+// { dg-additional-options \"-msse2\" { target { i?86-*-linux* x86_64-*-linux* i?86-*-freebsd* x86_64-*-freebsd*} } }\n // { dg-additional-options \"-D__NO_INLINE__\" { target { *-*-linux-gnu } } }\n // { dg-set-target-env-var ASAN_OPTIONS \"handle_segv=2\" }\n // { dg-final { asan-gtest } }"}, {"sha": "ecde254166d94f362b804aed7b82f99c7ee295d3", "filename": "gcc/testsuite/g++.dg/asan/asan_test_utils.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Fasan_test_utils.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Fasan_test_utils.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Fasan_test_utils.h?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -40,6 +40,9 @@\n # include <sys/types.h>\n # include <sys/stat.h>\n # include <fcntl.h>\n+#endif\n+\n+#if defined(__linux__) || defined(__FreeBSD__)\n #include <unistd.h>\n #endif\n "}, {"sha": "8802870f70ca989c29c28cfa964f8d4ae733ffef", "filename": "gcc/testsuite/g++.dg/asan/interception-failure-test-1.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-failure-test-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-failure-test-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-failure-test-1.C?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -3,7 +3,7 @@\n \n // { dg-do run }\n // { dg-options \"-fno-builtin-malloc -fno-builtin-free\" }\n-// { dg-additional-options \"-D__NO_INLINE__\" { target { *-*-linux-gnu } } }\n+// { dg-additional-options \"-D__NO_INLINE__\" { target { *-*-linux-gnu *-*-freebsd* } } }\n \n #include <stdlib.h>\n #include <stdio.h>"}, {"sha": "0798c39c50def6fbf13e9187ffaaecd7e7119529", "filename": "gcc/testsuite/g++.dg/asan/interception-malloc-test-1.C", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-malloc-test-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-malloc-test-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-malloc-test-1.C?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,8 +1,8 @@\n // ASan interceptor can be accessed with __interceptor_ prefix.\n \n-// { dg-do run { target *-*-linux* } }\n+// { dg-do run { target *-*-linux* *-*-freebsd* } }\n // { dg-options \"-fno-builtin-free\" }\n-// { dg-additional-options \"-D__NO_INLINE__\" { target { *-*-linux-gnu } } }\n+// { dg-additional-options \"-D__NO_INLINE__\" { target { *-*-linux-gnu *-*-freebsd* } } }\n // { dg-shouldfail \"asan\" }\n \n #include <stdlib.h>"}, {"sha": "69fa5a3e33f928a2e6f14798998aa814edd0d493", "filename": "gcc/testsuite/g++.dg/asan/interception-test-1.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-test-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-test-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fasan%2Finterception-test-1.C?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -2,7 +2,7 @@\n \n // { dg-do run }\n // { dg-options \"-fno-builtin-malloc -fno-builtin-free\" }\n-// { dg-additional-options \"-D__NO_INLINE__\" { target { *-*-linux-gnu } } }\n+// { dg-additional-options \"-D__NO_INLINE__\" { target { *-*-linux-gnu *-*-freebsd* } } }\n // { dg-shouldfail \"asan\" }\n // { dg-skip-if \"Darwin uses mac function interposition\" { *-*-darwin* } }\n "}, {"sha": "caf9208e1b0c84a309f561d63ed1a1578ee6cd70", "filename": "gcc/testsuite/gcc.dg/asan/pr87930.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fgcc.dg%2Fasan%2Fpr87930.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56017225eede47f94d0d81e3f1d0496d6b155963/gcc%2Ftestsuite%2Fgcc.dg%2Fasan%2Fpr87930.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fasan%2Fpr87930.c?ref=56017225eede47f94d0d81e3f1d0496d6b155963", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do compile { target { { i?86-*-linux* i?86-*-gnu* x86_64-*-linux* } && lp64 } } } */\n+/* { dg-do compile { target { { i?86-*-linux* i?86-*-gnu* x86_64-*-linux* x86_64-*-freebsd* } && lp64 } } } */\n /* { dg-options \"-fsanitize=address -mabi=ms\" } */\n \n int i;"}]}