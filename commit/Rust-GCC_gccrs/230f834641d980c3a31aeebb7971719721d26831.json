{"sha": "230f834641d980c3a31aeebb7971719721d26831", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjMwZjgzNDY0MWQ5ODBjM2EzMWFlZWJiNzk3MTcxOTcyMWQyNjgzMQ==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2011-12-06T10:06:49Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2011-12-06T10:06:49Z"}, "message": "PR c++/51427 - Better diagnostic when union/struct tags conflicts\n\ngcc/cp/\n\n\tPR c++/51427\n\t* parser.c (cp_parser_check_class_key): Add note about earlier\n\tdeclaration.\n\ngcc/testsuite/\n\n\tPR c++/51427\n\t* g++.dg/diagnostic/wrong-tag-1.C\n\nFrom-SVN: r182043", "tree": {"sha": "08a64bf90ae9d91a94103ca9eb7af6b9e28efa0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/08a64bf90ae9d91a94103ca9eb7af6b9e28efa0a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/230f834641d980c3a31aeebb7971719721d26831", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/230f834641d980c3a31aeebb7971719721d26831", "html_url": "https://github.com/Rust-GCC/gccrs/commit/230f834641d980c3a31aeebb7971719721d26831", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/230f834641d980c3a31aeebb7971719721d26831/comments", "author": null, "committer": null, "parents": [{"sha": "aa383ddaea7adb6800953a89ec3eb201da320613", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa383ddaea7adb6800953a89ec3eb201da320613", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa383ddaea7adb6800953a89ec3eb201da320613"}], "stats": {"total": 27, "additions": 23, "deletions": 4}, "files": [{"sha": "4391a478e9ada4ba4f1bfcbd3ae5ae97b80ee4c5", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/230f834641d980c3a31aeebb7971719721d26831/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/230f834641d980c3a31aeebb7971719721d26831/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=230f834641d980c3a31aeebb7971719721d26831", "patch": "@@ -1,3 +1,9 @@\n+2011-12-06  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/51427\n+\t* parser.c (cp_parser_check_class_key): Add note about earlier\n+\tdeclaration.\n+\n 2011-12-05  Fabien Ch\u00eane  <fabien@gcc.gnu.org>\n \n \tPR c++/51319"}, {"sha": "daf2ded45dc26976306f1e337b6d9f0501323b85", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/230f834641d980c3a31aeebb7971719721d26831/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/230f834641d980c3a31aeebb7971719721d26831/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=230f834641d980c3a31aeebb7971719721d26831", "patch": "@@ -22544,10 +22544,14 @@ static void\n cp_parser_check_class_key (enum tag_types class_key, tree type)\n {\n   if ((TREE_CODE (type) == UNION_TYPE) != (class_key == union_type))\n-    permerror (input_location, \"%qs tag used in naming %q#T\",\n-\t    class_key == union_type ? \"union\"\n-\t     : class_key == record_type ? \"struct\" : \"class\",\n-\t     type);\n+    {\n+      permerror (input_location, \"%qs tag used in naming %q#T\",\n+\t\t class_key == union_type ? \"union\"\n+\t\t : class_key == record_type ? \"struct\" : \"class\",\n+\t\t type);\n+      inform (DECL_SOURCE_LOCATION (TYPE_NAME (type)),\n+\t      \"%q#T was previously declared here\", type);\n+    }\n }\n \n /* Issue an error message if DECL is redeclared with different"}, {"sha": "e920bf7e27591de7884f6edd8384fb5e7b9a5d7f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/230f834641d980c3a31aeebb7971719721d26831/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/230f834641d980c3a31aeebb7971719721d26831/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=230f834641d980c3a31aeebb7971719721d26831", "patch": "@@ -1,3 +1,8 @@\n+2011-12-06  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/51427\n+\t* g++.dg/diagnostic/wrong-tag-1.C\n+\n 2011-12-05  Fabien Ch\u00eane  <fabien@gcc.gnu.org>\n \n \tPR c++/51319"}, {"sha": "2cf75f8bd7a4ab23d486a306f25accb0cce2be1e", "filename": "gcc/testsuite/g++.dg/diagnostic/wrong-tag-1.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/230f834641d980c3a31aeebb7971719721d26831/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fwrong-tag-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/230f834641d980c3a31aeebb7971719721d26831/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fwrong-tag-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fwrong-tag-1.C?ref=230f834641d980c3a31aeebb7971719721d26831", "patch": "@@ -0,0 +1,4 @@\n+// Origin PR c++/51427\n+\n+typedef struct _GMutex GMutex; // { dg-message \"previously declared here\"}\n+typedef union _GMutex GMutex; // { dg-error \"tag used in naming\" }"}]}