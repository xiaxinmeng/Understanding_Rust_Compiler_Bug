{"sha": "e2bb53e59a21c042db3e0b605752e683d62618cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTJiYjUzZTU5YTIxYzA0MmRiM2UwYjYwNTc1MmU2ODNkNjI2MThjYw==", "commit": {"author": {"name": "Roger Sayle", "email": "roger@eyesopen.com", "date": "2004-05-15T18:17:20Z"}, "committer": {"name": "Roger Sayle", "email": "sayle@gcc.gnu.org", "date": "2004-05-15T18:17:20Z"}, "message": "builtins.c (simplify_builtin_strcpy): Avoid use of chainon...\n\n\n\t* builtins.c (simplify_builtin_strcpy): Avoid use of chainon, so\n\tthat simplify_builtin doesn't destructively modify its argument.\n\nFrom-SVN: r81893", "tree": {"sha": "3f4276db50354c8cf57f35b53b0efa95e76477f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3f4276db50354c8cf57f35b53b0efa95e76477f7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e2bb53e59a21c042db3e0b605752e683d62618cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2bb53e59a21c042db3e0b605752e683d62618cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2bb53e59a21c042db3e0b605752e683d62618cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2bb53e59a21c042db3e0b605752e683d62618cc/comments", "author": null, "committer": null, "parents": [{"sha": "feb357a3360f03fa3439b437c0d255be0c14e54b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/feb357a3360f03fa3439b437c0d255be0c14e54b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/feb357a3360f03fa3439b437c0d255be0c14e54b"}], "stats": {"total": 20, "additions": 14, "deletions": 6}, "files": [{"sha": "2b1ef2c483acfcbbcd3d99571a3c91c5d55993aa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e2bb53e59a21c042db3e0b605752e683d62618cc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e2bb53e59a21c042db3e0b605752e683d62618cc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e2bb53e59a21c042db3e0b605752e683d62618cc", "patch": "@@ -1,3 +1,8 @@\n+2004-05-15  Roger Sayle  <roger@eyesopen.com>\n+\n+\t* builtins.c (simplify_builtin_strcpy): Avoid use of chainon, so\n+\tthat simplify_builtin doesn't destructively modify its argument.\n+\n 2004-05-15  Richard Earnshaw  <reanrsha@arm.com>\n \n \t* arm/lib1funcs.asm (_lshrdi3, _ashrdi3, _ashldi3): Add ASM "}, {"sha": "7643b2dd38319e2ba4ea37bf75e8768b084502ec", "filename": "gcc/builtins.c", "status": "modified", "additions": 9, "deletions": 6, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e2bb53e59a21c042db3e0b605752e683d62618cc/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e2bb53e59a21c042db3e0b605752e683d62618cc/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=e2bb53e59a21c042db3e0b605752e683d62618cc", "patch": "@@ -8298,7 +8298,7 @@ simplify_builtin_strpbrk (tree arglist)\n tree\n simplify_builtin_strcpy (tree arglist, tree len)\n {\n-  tree fn;\n+  tree fn, src, dst;\n \n   if (!validate_arglist (arglist, POINTER_TYPE, POINTER_TYPE, VOID_TYPE))\n     return 0;\n@@ -8307,17 +8307,20 @@ simplify_builtin_strcpy (tree arglist, tree len)\n   if (!fn)\n     return 0;\n \n+  src = TREE_VALUE (TREE_CHAIN (arglist));\n+  dst = TREE_VALUE (arglist);\n+\n   if (!len)\n     {\n-      len = c_strlen (TREE_VALUE (TREE_CHAIN (arglist)), 1);\n-      if (!len)\n-\treturn 0;\n-      if (TREE_SIDE_EFFECTS (len))\n+      len = c_strlen (src, 1);\n+      if (!len || TREE_SIDE_EFFECTS (len))\n \treturn 0;\n     }\n \n   len = size_binop (PLUS_EXPR, len, ssize_int (1));\n-  chainon (arglist, build_tree_list (NULL_TREE, len));\n+  arglist = build_tree_list (NULL_TREE, len);\n+  arglist = tree_cons (NULL_TREE, src, arglist);\n+  arglist = tree_cons (NULL_TREE, dst, arglist);\n   return build_function_call_expr (fn, arglist);\n }\n "}]}