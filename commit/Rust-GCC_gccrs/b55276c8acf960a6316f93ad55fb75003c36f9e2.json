{"sha": "b55276c8acf960a6316f93ad55fb75003c36f9e2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjU1Mjc2YzhhY2Y5NjBhNjMxNmY5M2FkNTVmYjc1MDAzYzM2ZjllMg==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2008-11-19T22:26:56Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2008-11-19T22:26:56Z"}, "message": "re PR c++/35405 (Internal compiler error)\n\ngcc/cp/ChangeLog:\n2008-11-19  Dodji Seketeli  <dodji@redhat.com>\n\n\tPR c++/35405\n\t* pt.c (lookup_template_class): Check pointers before dereferencing\n\t  Them.\n\t* error.c (dump_template_decl): Likewise.\n\ngcc/testsuite/ChangeLog:\n2008-11-19  Dodji Seketeli  <dodji@redhat.com>\n\n\tPR c++/35405\n\t* g++.dg/template/crash84.C: New test.\n\nFrom-SVN: r142022", "tree": {"sha": "f13393d9af28c6cde577eb6c5d6137b0b1dca471", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f13393d9af28c6cde577eb6c5d6137b0b1dca471"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b55276c8acf960a6316f93ad55fb75003c36f9e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b55276c8acf960a6316f93ad55fb75003c36f9e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b55276c8acf960a6316f93ad55fb75003c36f9e2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b55276c8acf960a6316f93ad55fb75003c36f9e2/comments", "author": null, "committer": null, "parents": [{"sha": "ff367ac90266005ff0f6a471483ffa2a5f542e9f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff367ac90266005ff0f6a471483ffa2a5f542e9f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff367ac90266005ff0f6a471483ffa2a5f542e9f"}], "stats": {"total": 38, "additions": 36, "deletions": 2}, "files": [{"sha": "73e07d73f9d887cef0a6ce08c0cf5b89a0a648dd", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=b55276c8acf960a6316f93ad55fb75003c36f9e2", "patch": "@@ -1,3 +1,10 @@\n+2008-11-19  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/35405\n+\t* pt.c (lookup_template_class): Check pointers before dereferencing\n+\t  Them.\n+\t* error.c (dump_template_decl): Likewise.\n+\n 2008-11-19  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/36410"}, {"sha": "a2db1575fe70c2d694cb5c0e3a6745c0b3613316", "filename": "gcc/cp/error.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=b55276c8acf960a6316f93ad55fb75003c36f9e2", "patch": "@@ -1044,11 +1044,13 @@ dump_template_decl (tree t, int flags)\n \t}\n     }\n \n-  if (TREE_CODE (DECL_TEMPLATE_RESULT (t)) == TYPE_DECL)\n+  if (DECL_TEMPLATE_RESULT (t)\n+      && TREE_CODE (DECL_TEMPLATE_RESULT (t)) == TYPE_DECL)\n     dump_type (TREE_TYPE (t),\n \t       ((flags & ~TFF_CLASS_KEY_OR_ENUM) | TFF_TEMPLATE_NAME\n \t\t| (flags & TFF_DECL_SPECIFIERS ? TFF_CLASS_KEY_OR_ENUM : 0)));\n-  else if (TREE_CODE (DECL_TEMPLATE_RESULT (t)) == VAR_DECL)\n+  else if (DECL_TEMPLATE_RESULT (t)\n+           && TREE_CODE (DECL_TEMPLATE_RESULT (t)) == VAR_DECL)\n     dump_decl (DECL_TEMPLATE_RESULT (t), flags | TFF_TEMPLATE_NAME);\n   else\n     {"}, {"sha": "96c510f3d4c8d36b0f5d55ed1947c716216c0374", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=b55276c8acf960a6316f93ad55fb75003c36f9e2", "patch": "@@ -5585,6 +5585,7 @@ lookup_template_class (tree d1,\n       d1 = DECL_NAME (templ);\n     }\n   else if (TREE_CODE (d1) == TEMPLATE_DECL\n+           && DECL_TEMPLATE_RESULT (d1)\n \t   && TREE_CODE (DECL_TEMPLATE_RESULT (d1)) == TYPE_DECL)\n     {\n       templ = d1;"}, {"sha": "85f9f279faf49d1a943513383eeaf0154856952d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b55276c8acf960a6316f93ad55fb75003c36f9e2", "patch": "@@ -1,3 +1,8 @@\n+2008-11-19  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/35405\n+\t* g++.dg/template/crash84.C: New test.\n+\n 2008-11-19  Jakub Jelinek  <jakub@redhat.com>\n \n \t* gcc.c-torture/compile/pr11832.c: XFAIL even on s390*-*-*."}, {"sha": "f622aaa5e1055ae2a85a12d9a36d2b3858e4ed0e", "filename": "gcc/testsuite/g++.dg/template/crash84.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash84.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b55276c8acf960a6316f93ad55fb75003c36f9e2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash84.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash84.C?ref=b55276c8acf960a6316f93ad55fb75003c36f9e2", "patch": "@@ -0,0 +1,19 @@\n+// Contributed by Dodji Seketeli <dodji@redhat.com>\n+// Origin PR c++/35405\n+// { dg-do compile }\n+\n+template<typename T> struct a\n+{\n+    template <template <typename> class C, typename X, C<X>* =0>\n+    struct b // { dg-error \"class C' is not a template|is not a valid type\" }\n+    {\n+    };\n+};\n+\n+void\n+foo ()\n+{\n+    a<int> v; // { dg-message \"instantiated from here\" }\n+}\n+\n+"}]}