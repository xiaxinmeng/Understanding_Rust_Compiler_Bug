{"sha": "6c0347f607f3bdc49498df45a2fbace20bfa5a92", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmMwMzQ3ZjYwN2YzYmRjNDk0OThkZjQ1YTJmYmFjZTIwYmZhNWE5Mg==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2016-10-16T16:29:46Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2016-10-16T16:29:46Z"}, "message": "re PR fortran/48298 ([F03] User-Defined Derived-Type IO (DTIO))\n\n2016-10-16  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR fortran/48298\n\t* trans-io.c (transfer_expr): Ignore dtio procedures for inquire\n\twith iolength.\n\n\t* gfortran.dg/dtio_16.f90: New test.\n\nFrom-SVN: r241216", "tree": {"sha": "9e24a080624fbcc8061c1e7ffdc2a66c6818e031", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9e24a080624fbcc8061c1e7ffdc2a66c6818e031"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6c0347f607f3bdc49498df45a2fbace20bfa5a92", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c0347f607f3bdc49498df45a2fbace20bfa5a92", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c0347f607f3bdc49498df45a2fbace20bfa5a92", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c0347f607f3bdc49498df45a2fbace20bfa5a92/comments", "author": null, "committer": null, "parents": [{"sha": "01c0b7cf89dafc68f61b7097bd0f3550a3c5cee2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01c0b7cf89dafc68f61b7097bd0f3550a3c5cee2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01c0b7cf89dafc68f61b7097bd0f3550a3c5cee2"}], "stats": {"total": 85, "additions": 84, "deletions": 1}, "files": [{"sha": "848b4bde1d8479d08bd3e0b6a004b2081e42e808", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=6c0347f607f3bdc49498df45a2fbace20bfa5a92", "patch": "@@ -1,3 +1,9 @@\n+2016-10-16  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR fortran/48298\n+\t* trans-io.c (transfer_expr): Ignore dtio procedures for inquire\n+\twith iolength.\n+\n 2016-10-15  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/77972"}, {"sha": "216317ad3d356ab14066817a8c62f1192cfe27c3", "filename": "gcc/fortran/trans-io.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ffortran%2Ftrans-io.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ffortran%2Ftrans-io.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-io.c?ref=6c0347f607f3bdc49498df45a2fbace20bfa5a92", "patch": "@@ -2325,7 +2325,7 @@ transfer_expr (gfc_se * se, gfc_typespec * ts, tree addr_expr,\n \t  if (derived->attr.has_dtio_procs)\n \t    arg2 = get_dtio_proc (ts, code, &dtio_sub);\n \n-\t  if (dtio_sub != NULL)\n+\t  if ((dtio_sub != NULL) && (last_dt != IOLENGTH))\n \t    {\n \t      tree decl;\n \t      decl = build_fold_indirect_ref_loc (input_location,"}, {"sha": "01fa6a78c9b86c8c55de16d5ac3f15de16cfbcc1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6c0347f607f3bdc49498df45a2fbace20bfa5a92", "patch": "@@ -1,3 +1,7 @@\n+2016-10-16  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\t* gfortran.dg/dtio_16.f90: New test.\n+\n 2016-10-15  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc.target/sparc/bmaskbshuf.c: Rename to..."}, {"sha": "0f462d5c46350cc2cc54e16de0ab22fbf2553bdf", "filename": "gcc/testsuite/gfortran.dg/dtio_16.f90", "status": "added", "additions": 73, "deletions": 0, "changes": 73, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ftestsuite%2Fgfortran.dg%2Fdtio_16.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c0347f607f3bdc49498df45a2fbace20bfa5a92/gcc%2Ftestsuite%2Fgfortran.dg%2Fdtio_16.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdtio_16.f90?ref=6c0347f607f3bdc49498df45a2fbace20bfa5a92", "patch": "@@ -0,0 +1,73 @@\n+! { dg-do run }\n+! Tests that inquire(iolength=) treats derived types as if they do not\n+! have User Defined procedures. Fortran Draft F2016 Standard, 9.10.3\n+MODULE p\n+  TYPE :: person\n+    CHARACTER (LEN=20) :: name\n+    INTEGER(4) :: age\n+  END TYPE person\n+  INTERFACE WRITE(FORMATTED)\n+     MODULE procedure pwf\n+  END INTERFACE\n+  INTERFACE WRITE(UNFORMATTED)\n+     MODULE procedure pwuf\n+  END INTERFACE\n+  INTERFACE read(FORMATTED)\n+     MODULE procedure prf\n+  END INTERFACE\n+  INTERFACE read(UNFORMATTED)\n+     MODULE procedure pruf\n+  END INTERFACE\n+CONTAINS\n+  SUBROUTINE pwf (dtv,unit,iotype,vlist,iostat,iomsg)\n+    CLASS(person), INTENT(IN) :: dtv\n+    INTEGER, INTENT(IN) :: unit\n+    CHARACTER (LEN=*), INTENT(IN) :: iotype\n+    INTEGER, INTENT(IN) :: vlist(:)\n+    INTEGER, INTENT(OUT) :: iostat\n+    CHARACTER (LEN=*), INTENT(INOUT) :: iomsg\n+    WRITE(unit, FMT = *, IOSTAT=iostat) dtv%name, dtv%age\n+  END SUBROUTINE pwf\n+\n+  SUBROUTINE prf (dtv,unit,iotype,vlist,iostat,iomsg)\n+    CLASS(person), INTENT(INOUT) :: dtv\n+    INTEGER, INTENT(IN) :: unit\n+    CHARACTER (LEN=*), INTENT(IN) :: iotype\n+    INTEGER, INTENT(IN) :: vlist(:)\n+    INTEGER, INTENT(OUT) :: iostat\n+    CHARACTER (LEN=*), INTENT(INOUT) :: iomsg\n+    READ (UNIT = UNIT, FMT = *) dtv%name, dtv%age\n+  END SUBROUTINE prf\n+\n+  SUBROUTINE pwuf (dtv,unit,iostat,iomsg)\n+    CLASS(person), INTENT(IN) :: dtv\n+    INTEGER, INTENT(IN) :: unit\n+    INTEGER, INTENT(OUT) :: iostat\n+    CHARACTER (LEN=*), INTENT(INOUT) :: iomsg\n+    print *, \"in pwuf\"\n+    WRITE (UNIT=UNIT, FMT = *) DTV%name, DTV%age\n+  END SUBROUTINE pwuf\n+\n+  SUBROUTINE pruf (dtv,unit,iostat,iomsg)\n+    CLASS(person), INTENT(INOUT) :: dtv\n+    INTEGER, INTENT(IN) :: unit\n+    INTEGER, INTENT(OUT) :: iostat\n+    CHARACTER (LEN=*), INTENT(INOUT) :: iomsg\n+    print *, \"in pruf\"\n+    READ (UNIT = UNIT, FMT = *) dtv%name, dtv%age\n+  END SUBROUTINE pruf\n+\n+END MODULE p\n+\n+PROGRAM test\n+  USE p\n+  IMPLICIT NONE\n+  TYPE (person) :: chairman\n+  integer(4) :: rl, tl, kl\n+\n+  chairman%name=\"Charlie\"\n+  chairman%age=62\n+\n+  inquire(iolength=rl) rl, kl, chairman, rl, chairman, tl\n+  if (rl.ne.64) call abort\n+END PROGRAM test"}]}