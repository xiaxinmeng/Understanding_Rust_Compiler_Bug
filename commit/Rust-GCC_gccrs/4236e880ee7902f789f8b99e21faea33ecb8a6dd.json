{"sha": "4236e880ee7902f789f8b99e21faea33ecb8a6dd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDIzNmU4ODBlZTc5MDJmNzg5ZjhiOTllMjFmYWVhMzNlY2I4YTZkZA==", "commit": {"author": {"name": "Mihailo Stojanovic", "email": "mistojanovic@wavecomp.com", "date": "2019-10-14T21:07:56Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2019-10-14T21:07:56Z"}, "message": "mips.c (mips_cannot_force_const_mem): Reject vector constants.\n\n\t* config/mips/mips.c (mips_cannot_force_const_mem): Reject\n\tvector constants.\n\n\t* gcc.target/mips/constant-spill.c: New test.\n\nFrom-SVN: r276969", "tree": {"sha": "25e3511ed0b713647b3ec1d9f580dc30656c0597", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25e3511ed0b713647b3ec1d9f580dc30656c0597"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4236e880ee7902f789f8b99e21faea33ecb8a6dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4236e880ee7902f789f8b99e21faea33ecb8a6dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4236e880ee7902f789f8b99e21faea33ecb8a6dd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4236e880ee7902f789f8b99e21faea33ecb8a6dd/comments", "author": null, "committer": null, "parents": [{"sha": "ac308262f344153d472b16c85cc1c3036ce43308", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac308262f344153d472b16c85cc1c3036ce43308", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac308262f344153d472b16c85cc1c3036ce43308"}], "stats": {"total": 43, "additions": 42, "deletions": 1}, "files": [{"sha": "516e9c181387c9b973ff8a63d2522364857b2b48", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4236e880ee7902f789f8b99e21faea33ecb8a6dd", "patch": "@@ -1,3 +1,8 @@\n+2019-10-14  Mihailo Stojanovic  <mistojanovic@wavecomp.com>\n+\n+\t* config/mips/mips.c (mips_cannot_force_const_mem): Reject\n+\tvector constants.\n+\n 2019-10-14  Iain Sandoe  <iain@sandoe.co.uk>\n \n \t* config/darwin.c: Use unsigned ints for the picbase label"}, {"sha": "7f6a0db46fd31a7f05e5c08f71cef60383bf6860", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=4236e880ee7902f789f8b99e21faea33ecb8a6dd", "patch": "@@ -2409,7 +2409,8 @@ mips_cannot_force_const_mem (machine_mode mode, rtx x)\n      references, reload will consider forcing C into memory and using\n      one of the instruction's memory alternatives.  Returning false\n      here will force it to use an input reload instead.  */\n-  if (CONST_INT_P (x) && mips_legitimate_constant_p (mode, x))\n+  if ((CONST_INT_P (x) || GET_CODE (x) == CONST_VECTOR)\n+      && mips_legitimate_constant_p (mode, x))\n     return true;\n \n   split_const (x, &base, &offset);"}, {"sha": "08d4a79867d5c48fef7f8a1aaa8774b40edf86ee", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4236e880ee7902f789f8b99e21faea33ecb8a6dd", "patch": "@@ -1,3 +1,7 @@\n+2019-10-14  Mihailo Stojanovic  <mistojanovic@wavecomp.com>\n+\n+\t* gcc.target/mips/constant-spill.c: New test.\n+\n 2019-10-14  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/92069"}, {"sha": "1494705338b59591a9a70c0ae8f3c961d1d5eec8", "filename": "gcc/testsuite/gcc.target/mips/constant-spill.c", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fconstant-spill.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4236e880ee7902f789f8b99e21faea33ecb8a6dd/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fconstant-spill.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fconstant-spill.c?ref=4236e880ee7902f789f8b99e21faea33ecb8a6dd", "patch": "@@ -0,0 +1,31 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-mfp64 -mhard-float -mmsa\" } */\n+/* { dg-skip-if \"code quality test\" { *-*-* } { \"-Os\" \"-O0\" \"-O1\" \"-O2\" } { \"\" } } */\n+\n+void foo (void);\n+\n+void bar (void)\n+{\n+  int x[4];\n+  int y[4];\n+  int i;\n+\n+  while (1)\n+    {\n+      foo ();\n+\n+      for (i = 0; i < 4; i++)\n+        {\n+          x[i] = 0;\n+          y[i] = 0;\n+        }\n+\n+      asm volatile (\"\"\n+                    :\n+                    :\"m\"(x), \"m\"(y)\n+                    :\"memory\");\n+    }\n+}\n+\n+/* { dg-final { scan-assembler-not \"ld.w\" } } */\n+/* { dg-final { scan-assembler-times \"st.w\" 2 } } */"}]}