{"sha": "94236928129c40f6b9e98e3846beb105cf801045", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQyMzY5MjgxMjljNDBmNmI5ZTk4ZTM4NDZiZWIxMDVjZjgwMTA0NQ==", "commit": {"author": {"name": "Georg-Johann Lay", "email": "avr@gjlay.de", "date": "2012-03-22T13:17:16Z"}, "committer": {"name": "Georg-Johann Lay", "email": "gjl@gcc.gnu.org", "date": "2012-03-22T13:17:16Z"}, "message": "re PR target/52496 (avr-specific built-ins missing memory barrier)\n\n\tPR target/52496\n\t* config/avr/avr.md (unspec): Remove UNSPEC_MEMORY_BARRIER.\n\t(unspecv): Add UNSPECV_MEMORY_BARRIER.\n\t(cli_sei): Use unspec_volatile instead of unspec for memory barrier.\n\t(delay_cycles_1, delay_cycles_2): Ditto.\n\t(delay_cycles_3, delay_cycles_4): Ditto.\n\t(nopv, *nopv): Ditto.\n\t(sleep, *sleep): Ditto.\n\t(wdr, *wdr): Ditto.\n\nFrom-SVN: r185692", "tree": {"sha": "e10aee21504e2ade08ba2aa7ba776199086cec6d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e10aee21504e2ade08ba2aa7ba776199086cec6d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/94236928129c40f6b9e98e3846beb105cf801045", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94236928129c40f6b9e98e3846beb105cf801045", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94236928129c40f6b9e98e3846beb105cf801045", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94236928129c40f6b9e98e3846beb105cf801045/comments", "author": null, "committer": {"login": "sprintersb", "id": 8905355, "node_id": "MDQ6VXNlcjg5MDUzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/8905355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sprintersb", "html_url": "https://github.com/sprintersb", "followers_url": "https://api.github.com/users/sprintersb/followers", "following_url": "https://api.github.com/users/sprintersb/following{/other_user}", "gists_url": "https://api.github.com/users/sprintersb/gists{/gist_id}", "starred_url": "https://api.github.com/users/sprintersb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sprintersb/subscriptions", "organizations_url": "https://api.github.com/users/sprintersb/orgs", "repos_url": "https://api.github.com/users/sprintersb/repos", "events_url": "https://api.github.com/users/sprintersb/events{/privacy}", "received_events_url": "https://api.github.com/users/sprintersb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd32bb90f4f3bf158c2b7e22749660ce85e8f619", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd32bb90f4f3bf158c2b7e22749660ce85e8f619", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd32bb90f4f3bf158c2b7e22749660ce85e8f619"}], "stats": {"total": 39, "additions": 27, "deletions": 12}, "files": [{"sha": "f2da615e3322d84249ae1c1d63a98ea4066019c8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94236928129c40f6b9e98e3846beb105cf801045/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94236928129c40f6b9e98e3846beb105cf801045/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=94236928129c40f6b9e98e3846beb105cf801045", "patch": "@@ -1,3 +1,15 @@\n+2012-03-22  Georg-Johann Lay  <avr@gjlay.de>\n+\n+\tPR target/52496\n+\t* config/avr/avr.md (unspec): Remove UNSPEC_MEMORY_BARRIER.\n+\t(unspecv): Add UNSPECV_MEMORY_BARRIER.\n+\t(cli_sei): Use unspec_volatile instead of unspec for memory barrier.\n+\t(delay_cycles_1, delay_cycles_2): Ditto.\n+\t(delay_cycles_3, delay_cycles_4): Ditto.\n+\t(nopv, *nopv): Ditto.\n+\t(sleep, *sleep): Ditto.\n+\t(wdr, *wdr): Ditto.\n+\n 2012-03-22  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/52548"}, {"sha": "3fe06da661c2ea383657a1c3fc44dd58609dd4cf", "filename": "gcc/config/avr/avr.md", "status": "modified", "additions": 15, "deletions": 12, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94236928129c40f6b9e98e3846beb105cf801045/gcc%2Fconfig%2Favr%2Favr.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94236928129c40f6b9e98e3846beb105cf801045/gcc%2Fconfig%2Favr%2Favr.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.md?ref=94236928129c40f6b9e98e3846beb105cf801045", "patch": "@@ -70,7 +70,6 @@\n    UNSPEC_COPYSIGN\n    UNSPEC_IDENTITY\n    UNSPEC_INSERT_BITS\n-   UNSPEC_MEMORY_BARRIER\n    ])\n \n (define_c_enum \"unspecv\"\n@@ -79,6 +78,7 @@\n    UNSPECV_WRITE_SP\n    UNSPECV_GOTO_RECEIVER\n    UNSPECV_ENABLE_IRQS\n+   UNSPECV_MEMORY_BARRIER\n    UNSPECV_NOP\n    UNSPECV_SLEEP\n    UNSPECV_WDR\n@@ -5291,7 +5291,7 @@\n   [(unspec_volatile [(match_operand:QI 0 \"const_int_operand\" \"L,P\")]\n                     UNSPECV_ENABLE_IRQS)\n    (set (match_operand:BLK 1 \"\" \"\")\n-\t(unspec:BLK [(match_dup 1)] UNSPEC_MEMORY_BARRIER))]\n+\t(unspec_volatile:BLK [(match_dup 1)] UNSPECV_MEMORY_BARRIER))]\n   \"\"\n   \"@\n \tcli\n@@ -5403,7 +5403,7 @@\n                      (const_int 1)]\n                     UNSPECV_DELAY_CYCLES)\n    (set (match_operand:BLK 1 \"\" \"\")\n-\t(unspec:BLK [(match_dup 1)] UNSPEC_MEMORY_BARRIER))\n+\t(unspec_volatile:BLK [(match_dup 1)] UNSPECV_MEMORY_BARRIER))\n    (clobber (match_scratch:QI 2 \"=&d\"))]\n   \"\"\n   \"ldi %2,lo8(%0)\n@@ -5417,7 +5417,7 @@\n                      (const_int 2)]\n                     UNSPECV_DELAY_CYCLES)\n    (set (match_operand:BLK 1 \"\" \"\")\n-\t(unspec:BLK [(match_dup 1)] UNSPEC_MEMORY_BARRIER))\n+\t(unspec_volatile:BLK [(match_dup 1)] UNSPECV_MEMORY_BARRIER))\n    (clobber (match_scratch:HI 2 \"=&w\"))]\n   \"\"\n   \"ldi %A2,lo8(%0)\n@@ -5432,7 +5432,7 @@\n                      (const_int 3)]\n                     UNSPECV_DELAY_CYCLES)\n    (set (match_operand:BLK 1 \"\" \"\")\n-\t(unspec:BLK [(match_dup 1)] UNSPEC_MEMORY_BARRIER))\n+\t(unspec_volatile:BLK [(match_dup 1)] UNSPECV_MEMORY_BARRIER))\n    (clobber (match_scratch:QI 2 \"=&d\"))\n    (clobber (match_scratch:QI 3 \"=&d\"))\n    (clobber (match_scratch:QI 4 \"=&d\"))]\n@@ -5452,7 +5452,7 @@\n                      (const_int 4)]\n                     UNSPECV_DELAY_CYCLES)\n    (set (match_operand:BLK 1 \"\" \"\")\n-\t(unspec:BLK [(match_dup 1)] UNSPEC_MEMORY_BARRIER))\n+\t(unspec_volatile:BLK [(match_dup 1)] UNSPECV_MEMORY_BARRIER))\n    (clobber (match_scratch:QI 2 \"=&d\"))\n    (clobber (match_scratch:QI 3 \"=&d\"))\n    (clobber (match_scratch:QI 4 \"=&d\"))\n@@ -5855,7 +5855,8 @@\n   [(parallel [(unspec_volatile [(match_operand:SI 0 \"const_int_operand\" \"\")] \n                                UNSPECV_NOP)\n               (set (match_dup 1)\n-                   (unspec:BLK [(match_dup 1)] UNSPEC_MEMORY_BARRIER))])]\n+                   (unspec_volatile:BLK [(match_dup 1)]\n+                                        UNSPECV_MEMORY_BARRIER))])]\n   \"\"\n   {\n     operands[1] = gen_rtx_MEM (BLKmode, gen_rtx_SCRATCH (Pmode));\n@@ -5866,7 +5867,7 @@\n   [(unspec_volatile [(match_operand:SI 0 \"const_int_operand\" \"P,K\")] \n                     UNSPECV_NOP)\n    (set (match_operand:BLK 1 \"\" \"\")\n-\t(unspec:BLK [(match_dup 1)] UNSPEC_MEMORY_BARRIER))]\n+\t(unspec_volatile:BLK [(match_dup 1)] UNSPECV_MEMORY_BARRIER))]\n   \"\"\n   \"@\n \tnop\n@@ -5878,7 +5879,8 @@\n (define_expand \"sleep\"\n   [(parallel [(unspec_volatile [(const_int 0)] UNSPECV_SLEEP)\n               (set (match_dup 0)\n-                   (unspec:BLK [(match_dup 0)] UNSPEC_MEMORY_BARRIER))])]\n+                   (unspec_volatile:BLK [(match_dup 0)]\n+                                        UNSPECV_MEMORY_BARRIER))])]\n   \"\"\n   {\n     operands[0] = gen_rtx_MEM (BLKmode, gen_rtx_SCRATCH (Pmode));\n@@ -5888,7 +5890,7 @@\n (define_insn \"*sleep\"\n   [(unspec_volatile [(const_int 0)] UNSPECV_SLEEP)\n    (set (match_operand:BLK 0 \"\" \"\")\n-\t(unspec:BLK [(match_dup 0)] UNSPEC_MEMORY_BARRIER))]\n+\t(unspec_volatile:BLK [(match_dup 0)] UNSPECV_MEMORY_BARRIER))]\n   \"\"\n   \"sleep\"\n   [(set_attr \"length\" \"1\")\n@@ -5898,7 +5900,8 @@\n (define_expand \"wdr\"\n   [(parallel [(unspec_volatile [(const_int 0)] UNSPECV_WDR)\n               (set (match_dup 0)\n-                   (unspec:BLK [(match_dup 0)] UNSPEC_MEMORY_BARRIER))])]\n+                   (unspec_volatile:BLK [(match_dup 0)]\n+                                        UNSPECV_MEMORY_BARRIER))])]\n   \"\"\n   {\n     operands[0] = gen_rtx_MEM (BLKmode, gen_rtx_SCRATCH (Pmode));\n@@ -5908,7 +5911,7 @@\n (define_insn \"*wdr\"\n   [(unspec_volatile [(const_int 0)] UNSPECV_WDR)\n    (set (match_operand:BLK 0 \"\" \"\")\n-\t(unspec:BLK [(match_dup 0)] UNSPEC_MEMORY_BARRIER))]\n+\t(unspec_volatile:BLK [(match_dup 0)] UNSPECV_MEMORY_BARRIER))]\n   \"\"\n   \"wdr\"\n   [(set_attr \"length\" \"1\")"}]}