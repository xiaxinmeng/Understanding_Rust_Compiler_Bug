{"sha": "47f647e44f933272c7d0c2a707ff537369b30ca0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDdmNjQ3ZTQ0ZjkzMzI3MmM3ZDBjMmE3MDdmZjUzNzM2OWIzMGNhMA==", "commit": {"author": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2010-11-22T16:14:27Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2010-11-22T16:14:27Z"}, "message": "re PR middle-end/43057 ([LTO] fold check: original tree changed by fold)\n\n\tPR middle-end/43057\n\t* fold-const.c (pedantic_non_lvalue_loc): Unshare x before\n\tsetting location.\n\nFrom-SVN: r167037", "tree": {"sha": "9b6fed6eed75bad4de1e07fba839f3ddeeb0be58", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9b6fed6eed75bad4de1e07fba839f3ddeeb0be58"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/47f647e44f933272c7d0c2a707ff537369b30ca0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47f647e44f933272c7d0c2a707ff537369b30ca0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47f647e44f933272c7d0c2a707ff537369b30ca0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47f647e44f933272c7d0c2a707ff537369b30ca0/comments", "author": null, "committer": null, "parents": [{"sha": "3dbcee5bb833512fc8225ae83724ba0891328476", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dbcee5bb833512fc8225ae83724ba0891328476", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3dbcee5bb833512fc8225ae83724ba0891328476"}], "stats": {"total": 24, "additions": 19, "deletions": 5}, "files": [{"sha": "7a42a0191196870671c93e0fb21fd4156f45a9b6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47f647e44f933272c7d0c2a707ff537369b30ca0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47f647e44f933272c7d0c2a707ff537369b30ca0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=47f647e44f933272c7d0c2a707ff537369b30ca0", "patch": "@@ -1,3 +1,9 @@\n+2010-11-21  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR middle-end/43057\n+\t* fold-const.c (pedantic_non_lvalue_loc): Unshare x before\n+\tsetting location.\n+\n 2010-11-22  Richard Guenther  <rguenther@suse.de>\n \n \t* gimple-fold.c (maybe_fold_reference): When canonicalizing\n@@ -31,8 +37,8 @@\n \t(get_output_file_with_visibility): Updated comments and rewritten\n \tto use the new files_rules machinery.\n \n-        * Makefile.in (XREGEX_H): Added variable.\n-        (build/gengtype.o): Added dependencies for xregex.h and obstack.h\n+\t* Makefile.in (XREGEX_H): Added variable.\n+\t(build/gengtype.o): Added dependencies for xregex.h and obstack.h\n \n 2010-11-21  Nathan Froyd  <froydnj@codesourcery.com>\n \n@@ -204,8 +210,7 @@\n \n \t* doc/tm.texi.in (HANDLE_SYSV_PRAGMA,\n \tHANDLE_PRAGMA_PACK_PUSH_POP): Remove.\n-\t(HANDLE_PRAGMA_PACK_WITH_EXPANSION): Don't refer to\n-\tHANDLE_SYSV_PRAGMA.\n+\t(HANDLE_PRAGMA_PACK_WITH_EXPANSION): Don't refer to HANDLE_SYSV_PRAGMA.\n \t* doc/tm.texi: Regenerate.\n \t* system.h (HANDLE_PRAGMA_PACK_PUSH_POP, HANDLE_SYSV_PRAGMA,\n \tHANDLE_PRAGMA_WEAK): Poison."}, {"sha": "7306863ff97dbf0d7025fef685b74ccbbb114a60", "filename": "gcc/fold-const.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47f647e44f933272c7d0c2a707ff537369b30ca0/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47f647e44f933272c7d0c2a707ff537369b30ca0/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=47f647e44f933272c7d0c2a707ff537369b30ca0", "patch": "@@ -2097,7 +2097,16 @@ pedantic_non_lvalue_loc (location_t loc, tree x)\n {\n   if (pedantic_lvalues)\n     return non_lvalue_loc (loc, x);\n-  protected_set_expr_location (x, loc);\n+\n+  if (CAN_HAVE_LOCATION_P (x)\n+      && EXPR_LOCATION (x) != loc\n+      && !(TREE_CODE (x) == SAVE_EXPR\n+\t   || TREE_CODE (x) == TARGET_EXPR\n+\t   || TREE_CODE (x) == BIND_EXPR))\n+    {\n+      x = copy_node (x);\n+      SET_EXPR_LOCATION (x, loc);\n+    }\n   return x;\n }\n \f"}]}