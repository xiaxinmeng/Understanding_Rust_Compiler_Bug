{"sha": "0cfbc62b0b8697c3e248295cd076e91cd890926c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGNmYmM2MmIwYjg2OTdjM2UyNDgyOTVjZDA3NmU5MWNkODkwOTI2Yw==", "commit": {"author": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2006-11-29T12:49:06Z"}, "committer": {"name": "Joseph Myers", "email": "jsm28@gcc.gnu.org", "date": "2006-11-29T12:49:06Z"}, "message": "rs6000.c (rs6000_gimplify_va_arg): If STRICT_ALIGNMENT and the type is more aligned than the saved registers...\n\n\t* config/rs6000/rs6000.c (rs6000_gimplify_va_arg): If\n\tSTRICT_ALIGNMENT and the type is more aligned than the saved\n\tregisters, copy via a temporary.\n\nFrom-SVN: r119307", "tree": {"sha": "e3922f13fa1650a768e0fee5da12de4852a58708", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e3922f13fa1650a768e0fee5da12de4852a58708"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0cfbc62b0b8697c3e248295cd076e91cd890926c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0cfbc62b0b8697c3e248295cd076e91cd890926c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0cfbc62b0b8697c3e248295cd076e91cd890926c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0cfbc62b0b8697c3e248295cd076e91cd890926c/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e969dbde29bfd396259357aa54a54f38f09ff593", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e969dbde29bfd396259357aa54a54f38f09ff593", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e969dbde29bfd396259357aa54a54f38f09ff593"}], "stats": {"total": 27, "additions": 27, "deletions": 0}, "files": [{"sha": "0c02f8bede58b2b0b3a104c51fb198170db2dd29", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0cfbc62b0b8697c3e248295cd076e91cd890926c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0cfbc62b0b8697c3e248295cd076e91cd890926c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0cfbc62b0b8697c3e248295cd076e91cd890926c", "patch": "@@ -1,3 +1,9 @@\n+2006-11-29  Joseph Myers  <joseph@codesourcery.com>\n+\n+\t* config/rs6000/rs6000.c (rs6000_gimplify_va_arg): If\n+\tSTRICT_ALIGNMENT and the type is more aligned than the saved\n+\tregisters, copy via a temporary.\n+\n 2006-11-28  Andrew Pinski  <pinskia@gmail.com>\n \n \tPR tree-opt/29984"}, {"sha": "675af68fe9a37f08e832d0d2eb4b8971fea1f80f", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0cfbc62b0b8697c3e248295cd076e91cd890926c/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0cfbc62b0b8697c3e248295cd076e91cd890926c/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=0cfbc62b0b8697c3e248295cd076e91cd890926c", "patch": "@@ -6222,6 +6222,27 @@ rs6000_gimplify_va_arg (tree valist, tree type, tree *pre_p, tree *post_p)\n       append_to_statement_list (t, pre_p);\n     }\n \n+  if (STRICT_ALIGNMENT\n+      && (TYPE_ALIGN (type)\n+\t  > (unsigned) BITS_PER_UNIT * (align < 4 ? 4 : align)))\n+    {\n+      /* The value (of type complex double, for example) may not be\n+\t aligned in memory in the saved registers, so copy via a\n+\t temporary.  (This is the same code as used for SPARC.)  */\n+      tree tmp = create_tmp_var (type, \"va_arg_tmp\");\n+      tree dest_addr = build_fold_addr_expr (tmp);\n+\n+      tree copy = build_function_call_expr\n+\t(implicit_built_in_decls[BUILT_IN_MEMCPY],\n+\t tree_cons (NULL_TREE, dest_addr,\n+\t\t    tree_cons (NULL_TREE, addr,\n+\t\t\t       tree_cons (NULL_TREE, size_int (rsize * 4),\n+\t\t\t\t\t  NULL_TREE))));\n+\n+      gimplify_and_add (copy, pre_p);\n+      addr = dest_addr;\n+    }\n+\n   addr = fold_convert (ptrtype, addr);\n   return build_va_arg_indirect_ref (addr);\n }"}]}