{"sha": "584bafb66df106ddbc5ef6749462ca2375fa0086", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTg0YmFmYjY2ZGYxMDZkZGJjNWVmNjc0OTQ2MmNhMjM3NWZhMDA4Ng==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2017-07-20T14:27:41Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2017-07-20T14:27:41Z"}, "message": "bb-reorder.c (connect_traces): Allow copying of blocks within single partition.\n\n\t* bb-reorder.c (connect_traces): Allow copying of blocks within\n\tsingle partition.\n\nFrom-SVN: r250390", "tree": {"sha": "347eff4c6f1ad37ce7f28425bb6dba62cb103266", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/347eff4c6f1ad37ce7f28425bb6dba62cb103266"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/584bafb66df106ddbc5ef6749462ca2375fa0086", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/584bafb66df106ddbc5ef6749462ca2375fa0086", "html_url": "https://github.com/Rust-GCC/gccrs/commit/584bafb66df106ddbc5ef6749462ca2375fa0086", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/584bafb66df106ddbc5ef6749462ca2375fa0086/comments", "author": null, "committer": null, "parents": [{"sha": "0574d9aeacfbac33ab161fcb4962133a54abef31", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0574d9aeacfbac33ab161fcb4962133a54abef31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0574d9aeacfbac33ab161fcb4962133a54abef31"}], "stats": {"total": 12, "additions": 8, "deletions": 4}, "files": [{"sha": "d489138e2c20c6788f08c78c4bf69292387554c8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/584bafb66df106ddbc5ef6749462ca2375fa0086/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/584bafb66df106ddbc5ef6749462ca2375fa0086/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=584bafb66df106ddbc5ef6749462ca2375fa0086", "patch": "@@ -1,3 +1,8 @@\n+2017-07-18  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* bb-reorder.c (connect_traces): Allow copying of blocks within\n+\tsingle partition.\n+\n 2017-07-20  Richard Biener  <rguenther@suse.de>\n \n \t* gimple.h (gimple_phi_result): Add gphi * overload."}, {"sha": "3b7278f2be1243ba35c477601915105e75c3e64d", "filename": "gcc/bb-reorder.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/584bafb66df106ddbc5ef6749462ca2375fa0086/gcc%2Fbb-reorder.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/584bafb66df106ddbc5ef6749462ca2375fa0086/gcc%2Fbb-reorder.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbb-reorder.c?ref=584bafb66df106ddbc5ef6749462ca2375fa0086", "patch": "@@ -1302,16 +1302,15 @@ connect_traces (int n_traces, struct trace *traces)\n \t\t      }\n \t\t  }\n \n-\t      if (crtl->has_bb_partition)\n-\t\ttry_copy = false;\n-\n \t      /* Copy tiny blocks always; copy larger blocks only when the\n \t\t edge is traversed frequently enough.  */\n \t      if (try_copy\n+\t\t  && BB_PARTITION (best->src) == BB_PARTITION (best->dest)\n \t\t  && copy_bb_p (best->dest,\n \t\t\t\toptimize_edge_for_speed_p (best)\n \t\t\t\t&& EDGE_FREQUENCY (best) >= freq_threshold\n-\t\t\t\t&& best->count >= count_threshold))\n+\t\t\t\t&& (!best->count.initialized_p ()\n+\t\t\t\t    || best->count >= count_threshold)))\n \t\t{\n \t\t  basic_block new_bb;\n "}]}