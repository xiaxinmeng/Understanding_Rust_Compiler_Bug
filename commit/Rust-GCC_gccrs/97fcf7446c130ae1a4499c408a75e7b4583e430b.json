{"sha": "97fcf7446c130ae1a4499c408a75e7b4583e430b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTdmY2Y3NDQ2YzEzMGFlMWE0NDk5YzQwOGE3NWU3YjQ1ODNlNDMwYg==", "commit": {"author": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2017-02-17T23:04:14Z"}, "committer": {"name": "Joseph Myers", "email": "jsm28@gcc.gnu.org", "date": "2017-02-17T23:04:14Z"}, "message": "Restore DECIMAL_DIG macro to C99/C11 value.\n\nBy extending the set of floating types, TS 18661-3 thereby affected\nthe definition of DECIMAL_DIG, which is defined in terms of the\n\"widest supported floating type\".  This is not conditional on whether\n__STDC_WANT_IEC_60559_TYPES_EXT__ is defined when <float.h> is\nincluded.\n\nI raised this possible incompatibility with C11 (an implementation\nshould be able to conform simultaneously with C11, and with C11 + TS\n18661) in DR#501.  This is not yet resolved, but the latest proposal\n<http://www.open-std.org/jtc1/sc22/wg14/www/docs/n2108.pdf> would\nobsolete DECIMAL_DIG with the intention of limiting it to the C11\ntypes (so making it equivalent to LDBL_DECIMAL_DIG).  (This proposal\nis intended to go along with a corresponding change to TS 18661-3 to\navoid the new types and non-arithmetic interchange encodings affecting\nthe value of DECIMAL_DIG.)\n\nTo avoid releasing GCC 7 with a wider-than-C11 value of DECIMAL_DIG\nand possibly reverting back to a C11 value in a future release, this\npatch reverts back to the C11 value now.  If the proposed resolution\nto DR#501 changes again so that DECIMAL_DIG *should* have a\nwider-than-C11 value, we can move back to a wider-than-C11 value in\nGCC 8.\n\nBootstrapped with no regressions on x86_64-pc-linux-gnu.\n\ngcc/c-family:\n\t* c-cppbuiltin.c (builtin_define_float_constants): Define\n\t__DECIMAL_DIG__ to the value for long double.\n\ngcc/testsuite:\n\t* gcc.dg/c11-float-2.c: New test.\n\t* gcc.dg/torture/float128-floath.c,\n\tgcc.dg/torture/float128x-floath.c,\n\tgcc.dg/torture/float16-floath.c, gcc.dg/torture/float32-floath.c,\n\tgcc.dg/torture/float32x-floath.c, gcc.dg/torture/float64-floath.c,\n\tgcc.dg/torture/float64x-floath.c: Do not test comparison of\n\t*_DECIMAL_DIG macros with DECIMAL_DIG.\n\nFrom-SVN: r245555", "tree": {"sha": "c9b3100beead8c8d74719d87c2f0b073c052b266", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c9b3100beead8c8d74719d87c2f0b073c052b266"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/97fcf7446c130ae1a4499c408a75e7b4583e430b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97fcf7446c130ae1a4499c408a75e7b4583e430b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97fcf7446c130ae1a4499c408a75e7b4583e430b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97fcf7446c130ae1a4499c408a75e7b4583e430b/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cb94c7007c6375f7e6752e0426a5ea0e3f046c47", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb94c7007c6375f7e6752e0426a5ea0e3f046c47", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb94c7007c6375f7e6752e0426a5ea0e3f046c47"}], "stats": {"total": 59, "additions": 27, "deletions": 32}, "files": [{"sha": "4bdd4747a89b7ec8da43a6de9db752bf2c6720e7", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -1,3 +1,8 @@\n+2017-02-17  Joseph Myers  <joseph@codesourcery.com>\n+\n+\t* c-cppbuiltin.c (builtin_define_float_constants): Define\n+\t__DECIMAL_DIG__ to the value for long double.\n+\n 2017-02-15  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/79515"}, {"sha": "083d5fdf4cfec15ab1b7aeb9a5787956c3a6f6f3", "filename": "gcc/c-family/c-cppbuiltin.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Fc-family%2Fc-cppbuiltin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Fc-family%2Fc-cppbuiltin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-cppbuiltin.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -245,11 +245,10 @@ builtin_define_float_constants (const char *name_prefix,\n     if (type_decimal_dig < type_d_decimal_dig)\n       type_decimal_dig++;\n   }\n-  /* Arbitrarily, define __DECIMAL_DIG__ when defining macros for long\n-     double, although it may be greater than the value for long\n-     double.  */\n+  /* Define __DECIMAL_DIG__ to the value for long double to be\n+     compatible with C99 and C11; see DR#501 and N2108.  */\n   if (type == long_double_type_node)\n-    builtin_define_with_int_value (\"__DECIMAL_DIG__\", decimal_dig);\n+    builtin_define_with_int_value (\"__DECIMAL_DIG__\", type_decimal_dig);\n   sprintf (name, \"__%s_DECIMAL_DIG__\", name_prefix);\n   builtin_define_with_int_value (name, type_decimal_dig);\n "}, {"sha": "035cf4739c2cc400d18ddbd8e269e50e7256674e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -1,3 +1,13 @@\n+2017-02-17  Joseph Myers  <joseph@codesourcery.com>\n+\n+\t* gcc.dg/c11-float-2.c: New test.\n+\t* gcc.dg/torture/float128-floath.c,\n+\tgcc.dg/torture/float128x-floath.c,\n+\tgcc.dg/torture/float16-floath.c, gcc.dg/torture/float32-floath.c,\n+\tgcc.dg/torture/float32x-floath.c, gcc.dg/torture/float64-floath.c,\n+\tgcc.dg/torture/float64x-floath.c: Do not test comparison of\n+\t*_DECIMAL_DIG macros with DECIMAL_DIG.\n+\n 2017-02-17  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n \tPR target/79261"}, {"sha": "345c2d349b9b285186ee343d0b740ef7dc13202f", "filename": "gcc/testsuite/gcc.dg/c11-float-2.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-float-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-float-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-float-2.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -0,0 +1,9 @@\n+/* Test DECIMAL_DIG equals LDBL_DECIMAL_DIG; see DR#501 and N2108.  */\n+/* { dg-do preprocess } */\n+/* { dg-options \"-std=c11 -pedantic-errors\" } */\n+\n+#include <float.h>\n+\n+#if DECIMAL_DIG != LDBL_DECIMAL_DIG\n+# error \"DECIMAL_DIG != LDBL_DECIMAL_DIG\"\n+#endif"}, {"sha": "6015903381db2b9a041c103042518cb4eac8c30f", "filename": "gcc/testsuite/gcc.dg/torture/float128-floath.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat128-floath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat128-floath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat128-floath.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -53,10 +53,6 @@\n # error \"FLT128_TRUE_MIN undefined\"\n #endif\n \n-#if FLT128_DECIMAL_DIG > DECIMAL_DIG\n-# error \"FLT128_DECIMAL_DIG > DECIMAL_DIG\"\n-#endif\n-\n #if FLT128_MANT_DIG != 113 || FLT128_MAX_EXP != 16384 || FLT128_MIN_EXP != -16381\n # error \"_Float128 bad format\"\n #endif"}, {"sha": "5c0d94f0600f955c080c212d49b270b0b1a7285b", "filename": "gcc/testsuite/gcc.dg/torture/float128x-floath.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat128x-floath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat128x-floath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat128x-floath.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -53,10 +53,6 @@\n # error \"FLT128X_TRUE_MIN undefined\"\n #endif\n \n-#if FLT128X_DECIMAL_DIG > DECIMAL_DIG\n-# error \"FLT128X_DECIMAL_DIG > DECIMAL_DIG\"\n-#endif\n-\n #if FLT128X_MANT_DIG < 128 || FLT128X_MAX_EXP < 65536 || FLT128X_MIN_EXP + FLT128X_MAX_EXP != 3\n # error \"_Float128x bad format\"\n #endif"}, {"sha": "91c84e7a55136eeb0316f3d552e37ca9e12719b8", "filename": "gcc/testsuite/gcc.dg/torture/float16-floath.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat16-floath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat16-floath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat16-floath.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -53,10 +53,6 @@\n # error \"FLT16_TRUE_MIN undefined\"\n #endif\n \n-#if FLT16_DECIMAL_DIG > DECIMAL_DIG\n-# error \"FLT16_DECIMAL_DIG > DECIMAL_DIG\"\n-#endif\n-\n #if FLT16_MANT_DIG != 11 || FLT16_MAX_EXP != 16 || FLT16_MIN_EXP != -13\n # error \"_Float16 bad format\"\n #endif"}, {"sha": "cada00af1794054f338cabe4881a6485cebe93ca", "filename": "gcc/testsuite/gcc.dg/torture/float32-floath.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat32-floath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat32-floath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat32-floath.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -53,10 +53,6 @@\n # error \"FLT32_TRUE_MIN undefined\"\n #endif\n \n-#if FLT32_DECIMAL_DIG > DECIMAL_DIG\n-# error \"FLT32_DECIMAL_DIG > DECIMAL_DIG\"\n-#endif\n-\n #if FLT32_MANT_DIG != 24 || FLT32_MAX_EXP != 128 || FLT32_MIN_EXP != -125\n # error \"_Float32 bad format\"\n #endif"}, {"sha": "6baabf3d0d27c75d9a44ddab2a9c3e9ef412694e", "filename": "gcc/testsuite/gcc.dg/torture/float32x-floath.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat32x-floath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat32x-floath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat32x-floath.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -53,10 +53,6 @@\n # error \"FLT32X_TRUE_MIN undefined\"\n #endif\n \n-#if FLT32X_DECIMAL_DIG > DECIMAL_DIG\n-# error \"FLT32X_DECIMAL_DIG > DECIMAL_DIG\"\n-#endif\n-\n #if FLT32X_MANT_DIG < 32 || FLT32X_MAX_EXP < 1024 || FLT32X_MIN_EXP + FLT32X_MAX_EXP != 3\n # error \"_Float32x bad format\"\n #endif"}, {"sha": "f10e58e26ca58b1aa8f00184553f0ea9f1ca55c0", "filename": "gcc/testsuite/gcc.dg/torture/float64-floath.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat64-floath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat64-floath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat64-floath.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -53,10 +53,6 @@\n # error \"FLT64_TRUE_MIN undefined\"\n #endif\n \n-#if FLT64_DECIMAL_DIG > DECIMAL_DIG\n-# error \"FLT64_DECIMAL_DIG > DECIMAL_DIG\"\n-#endif\n-\n #if FLT64_MANT_DIG != 53 || FLT64_MAX_EXP != 1024 || FLT64_MIN_EXP != -1021\n # error \"_Float64 bad format\"\n #endif"}, {"sha": "00c36f4dbfd4f51fe10bc2f46015e3bce3d2a54b", "filename": "gcc/testsuite/gcc.dg/torture/float64x-floath.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat64x-floath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97fcf7446c130ae1a4499c408a75e7b4583e430b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat64x-floath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Ffloat64x-floath.c?ref=97fcf7446c130ae1a4499c408a75e7b4583e430b", "patch": "@@ -53,10 +53,6 @@\n # error \"FLT64X_TRUE_MIN undefined\"\n #endif\n \n-#if FLT64X_DECIMAL_DIG > DECIMAL_DIG\n-# error \"FLT64X_DECIMAL_DIG > DECIMAL_DIG\"\n-#endif\n-\n #if FLT64X_MANT_DIG < 64 || FLT64X_MAX_EXP < 16384 || FLT64X_MIN_EXP + FLT64X_MAX_EXP != 3\n # error \"_Float64x bad format\"\n #endif"}]}