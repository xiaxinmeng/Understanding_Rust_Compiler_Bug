{"sha": "44d952b36a61120729dfeef4787a2fffe2ed9f53", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDRkOTUyYjM2YTYxMTIwNzI5ZGZlZWY0Nzg3YTJmZmZlMmVkOWY1Mw==", "commit": {"author": {"name": "Gerald Pfeifer", "email": "pfeifer@dbai.tuwien.ac.at", "date": "2003-06-17T09:02:45Z"}, "committer": {"name": "Gerald Pfeifer", "email": "gerald@gcc.gnu.org", "date": "2003-06-17T09:02:45Z"}, "message": "gcc_release (build_tarfile): Build .bz2 files instead of .gz files.\n\n\t* gcc_release (build_tarfile): Build .bz2 files instead of .gz files.\n\t(build_bz2): Rename to build_gzip and create .gz files from .bz2\n\tfiles instead of the other way around.\n\t(build_gzip): New function.\n\t(build_diffs): Build .bz2 files instead of .gz files.\n\t(build_diff): Use .bz2 files instead of .gz files.\n\tMake an error message independent of the compression format.\n\t(MODE_BZIP2): Rename to MODE_GZIP.  Related changes to the\n\tinvocation of this script.\n\t(MODE_GZIP): New variable.\n\t(OLD_TARS): Use .bz2 archive of the previous snapshot.\n\nFrom-SVN: r68074", "tree": {"sha": "73596c5b4eabf16d03dff6b0287f26a0f4288eec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/73596c5b4eabf16d03dff6b0287f26a0f4288eec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/44d952b36a61120729dfeef4787a2fffe2ed9f53", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44d952b36a61120729dfeef4787a2fffe2ed9f53", "html_url": "https://github.com/Rust-GCC/gccrs/commit/44d952b36a61120729dfeef4787a2fffe2ed9f53", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44d952b36a61120729dfeef4787a2fffe2ed9f53/comments", "author": null, "committer": null, "parents": [{"sha": "97587cfaa3de90d59f1889a86f85488e6d9319c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97587cfaa3de90d59f1889a86f85488e6d9319c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97587cfaa3de90d59f1889a86f85488e6d9319c0"}], "stats": {"total": 58, "additions": 36, "deletions": 22}, "files": [{"sha": "793057a71a9d087482afbd1c37a0bc9f9a53464f", "filename": "maintainer-scripts/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44d952b36a61120729dfeef4787a2fffe2ed9f53/maintainer-scripts%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44d952b36a61120729dfeef4787a2fffe2ed9f53/maintainer-scripts%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2FChangeLog?ref=44d952b36a61120729dfeef4787a2fffe2ed9f53", "patch": "@@ -1,3 +1,17 @@\n+2003-06-17  Gerald Pfeifer  <pfeifer@dbai.tuwien.ac.at>\n+\n+\t* gcc_release (build_tarfile): Build .bz2 files instead of .gz files.\n+\t(build_bz2): Rename to build_gzip and create .gz files from .bz2\n+\tfiles instead of the other way around.\n+\t(build_gzip): New function.\n+\t(build_diffs): Build .bz2 files instead of .gz files.\n+\t(build_diff): Use .bz2 files instead of .gz files.\n+\tMake an error message independent of the compression format.\n+\t(MODE_BZIP2): Rename to MODE_GZIP.  Related changes to the\n+\tinvocation of this script.\n+\t(MODE_GZIP): New variable.\n+\t(OLD_TARS): Use .bz2 archive of the previous snapshot.\n+\n 2003-06-14  Gerald Pfeifer  <pfeifer@dbai.tuwien.ac.at>\n \n \t* snapshot-README: Use GCC instead of gcc, C++ front end instead of "}, {"sha": "1483441d72a0ab5b144ad828a1fa3796ecc413e6", "filename": "maintainer-scripts/gcc_release", "status": "modified", "additions": 22, "deletions": 22, "changes": 44, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/44d952b36a61120729dfeef4787a2fffe2ed9f53/maintainer-scripts%2Fgcc_release", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/44d952b36a61120729dfeef4787a2fffe2ed9f53/maintainer-scripts%2Fgcc_release", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2Fgcc_release?ref=44d952b36a61120729dfeef4787a2fffe2ed9f53", "patch": "@@ -245,11 +245,11 @@ EOF\n \n build_tarfile() {\n   # Get the name of the destination tar file.\n-  TARFILE=\"$1.tar.gz\"\n+  TARFILE=\"$1.tar.bz2\"\n   shift\n \n   # Build the tar file itself.\n-  (${TAR} cf - \"$@\" | ${GZIP} > ${TARFILE}) || \\\n+  (${TAR} cf - \"$@\" | ${BZIP2} > ${TARFILE}) || \\\n     error \"Could not build tarfile\"\n   FILE_LIST=\"${FILE_LIST} ${TARFILE}\"\n }\n@@ -288,31 +288,31 @@ build_tarfiles() {\n     `basename ${SOURCE_DIRECTORY}`\n }\n \n-# Build .bz2 files.\n-build_bzip2() {\n+# Build .gz files.\n+build_gzip() {\n   for f in ${FILE_LIST}; do\n-    bzfile=${f%.gz}.bz2\n-    (zcat $f | ${BZIP2} > ${bzfile}) || error \"Could not create ${bzfile}\"\n+    target=${f%.bz2}.gz\n+    (${BZIP2} -d -c $f | ${GZIP} > ${target}) || error \"Could not create ${target}\"\n   done\n }\n \n # Build diffs against an old release.\n build_diffs() {\n   old_dir=${1%/*}\n   old_file=${1##*/}\n-  old_vers=${old_file%.tar.gz}\n+  old_vers=${old_file%.tar.bz2}\n   old_vers=${old_vers#gcc-}\n   inform \"Building diffs against version $old_vers\"\n   for f in gcc gcc-ada gcc-g++ gcc-g77 gcc-java gcc-objc gcc-testsuite gcc-core; do\n-    old_tar=${old_dir}/${f}-${old_vers}.tar.gz\n-    new_tar=${WORKING_DIRECTORY}/${f}-${RELEASE}.tar.gz\n+    old_tar=${old_dir}/${f}-${old_vers}.tar.bz2\n+    new_tar=${WORKING_DIRECTORY}/${f}-${RELEASE}.tar.bz2\n     if [ ! -e $old_tar ]; then\n       inform \"$old_tar not found; not generating diff file\"\n     elif [ ! -e $new_tar ]; then\n       inform \"$new_tar not found; not generating diff file\"\n     else\n       build_diff $old_tar gcc-${old_vers} $new_tar gcc-${RELEASE} \\\n-        ${f}-${old_vers}-${RELEASE}.diff.gz\n+        ${f}-${old_vers}-${RELEASE}.diff.bz2\n     fi\n   done\n }\n@@ -323,13 +323,13 @@ build_diff() {\n   tmpdir=gccdiff.$$\n   mkdir $tmpdir || error \"Could not create directory $tmpdir\"\n   changedir $tmpdir\n-  ${TAR} xfz $1 || error \"Could not unpack $1 for diffs\"\n-  ${TAR} xfz $3 || error \"Could not unpack $3 for diffs\"\n-  ${DIFF} $2 $4 > ../${5%.gz}\n+  (${BZIP2} -d -c $1 | ${TAR} xf - ) || error \"Could not unpack $1 for diffs\"\n+  (${BZIP2} -d -c $3 | ${TAR} xf - ) || error \"Could not unpack $3 for diffs\"\n+  ${DIFF} $2 $4 > ../${5%.bz2}\n   if [ $? -eq 2 ]; then\n     error \"Trouble making diffs from $1 to $3\"\n   fi\n-  ${GZIP} ../${5%.gz} || error \"Could not gzip ../${5%.gz}\"\n+  ${BZIP2} ../${5%.bz2} || error \"Could not generate ../$5\"\n   changedir ..\n   rm -rf $tmpdir\n   FILE_LIST=\"${FILE_LIST} $5\"\n@@ -446,13 +446,13 @@ SNAPSHOT=0\n LOCAL=0\n \n # Major operation modes.\n-MODE_BZIP2=0\n+MODE_GZIP=0\n MODE_DIFFS=0\n MODE_SOURCES=0\n MODE_TARFILES=0\n MODE_UPLOAD=0\n \n-# .gz files generated to create .bz2 files from.\n+# List of archive files generated; used to create .gz files from .bz2.\n FILE_LIST=\"\"\n \n # Programs we use.\n@@ -546,7 +546,7 @@ else\n     LAST_DATE=`cat ~/.snapshot_date`\n     LAST_LONG_DATE=`date --date=$LAST_DATE +%Y-%m-%d`\n     LAST_DIR=~ftp/pub/gcc/snapshots/${LAST_LONG_DATE}\n-    OLD_TARS=${LAST_DIR}/gcc-${LAST_DATE}.tar.gz\n+    OLD_TARS=${LAST_DIR}/gcc-${LAST_DATE}.tar.bz2\n   fi\n fi\n \n@@ -583,12 +583,12 @@ export TZ\n # Handle the major modes.\n while [ $# -ne 0 ]; do\n     case $1 in\n-    bzip2)    MODE_BZIP2=1;;\n     diffs)    MODE_DIFFS=1;;\n+    gzip)     MODE_GZIP=1;;\n     sources)  MODE_SOURCES=1;;\n     tarfiles) MODE_TARFILES=1;;\n     upload)   MODE_UPLOAD=1;;\n-    all)      MODE_SOURCES=1; MODE_TARFILES=1; MODE_DIFFS=1; MODE_BZIP2=1; MODE_UPLOAD=1;;\n+    all)      MODE_SOURCES=1; MODE_TARFILES=1; MODE_DIFFS=1; MODE_GZIP=1; MODE_UPLOAD=1;;\n     *)        error \"Unknown mode $1\";;\n     esac\n     shift\n@@ -617,9 +617,9 @@ if [ $MODE_DIFFS -ne 0 ]; then\n   fi\n fi\n \n-# Build bzip2 files\n-if [ $MODE_BZIP2 -ne 0 ]; then\n-  build_bzip2\n+# Build gzip files\n+if [ $MODE_GZIP -ne 0 ]; then\n+  build_gzip\n fi\n \n # Upload them to the FTP server."}]}