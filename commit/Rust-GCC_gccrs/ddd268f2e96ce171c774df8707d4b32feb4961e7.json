{"sha": "ddd268f2e96ce171c774df8707d4b32feb4961e7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGRkMjY4ZjJlOTZjZTE3MWM3NzRkZjg3MDdkNGIzMmZlYjQ5NjFlNw==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2011-01-20T10:33:15Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2011-01-20T10:33:15Z"}, "message": "re PR other/47167 (Performance regression in numerical code)\n\n2011-01-20  Richard Guenther  <rguenther@suse.de>\n\n\tPR tree-optimization/47167\n\t* tree-ssa-copyrename.c (copy_rename_partition_coalesce):\n\tRevert previous change, only avoid enumeral type changes.\n\nFrom-SVN: r169050", "tree": {"sha": "8941373d666fd609a025decd10e84016c5d9462c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8941373d666fd609a025decd10e84016c5d9462c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ddd268f2e96ce171c774df8707d4b32feb4961e7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ddd268f2e96ce171c774df8707d4b32feb4961e7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ddd268f2e96ce171c774df8707d4b32feb4961e7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ddd268f2e96ce171c774df8707d4b32feb4961e7/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "525d13b031ea53d127623316d6c7751ca89cb591", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/525d13b031ea53d127623316d6c7751ca89cb591", "html_url": "https://github.com/Rust-GCC/gccrs/commit/525d13b031ea53d127623316d6c7751ca89cb591"}], "stats": {"total": 17, "additions": 14, "deletions": 3}, "files": [{"sha": "ff8645e610601a79bdde519ad95b62e77c878390", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ddd268f2e96ce171c774df8707d4b32feb4961e7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ddd268f2e96ce171c774df8707d4b32feb4961e7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ddd268f2e96ce171c774df8707d4b32feb4961e7", "patch": "@@ -1,3 +1,9 @@\n+2011-01-20  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR tree-optimization/47167\n+\t* tree-ssa-copyrename.c (copy_rename_partition_coalesce):\n+\tRevert previous change, only avoid enumeral type changes.\n+\n 2011-01-19  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/47291"}, {"sha": "9c51d118384c657cffbf3d91a591531bd739662b", "filename": "gcc/tree-ssa-copyrename.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ddd268f2e96ce171c774df8707d4b32feb4961e7/gcc%2Ftree-ssa-copyrename.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ddd268f2e96ce171c774df8707d4b32feb4961e7/gcc%2Ftree-ssa-copyrename.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-copyrename.c?ref=ddd268f2e96ce171c774df8707d4b32feb4961e7", "patch": "@@ -226,11 +226,16 @@ copy_rename_partition_coalesce (var_map map, tree var1, tree var2, FILE *debug)\n       ign2 = false;\n     }\n \n-  /* Don't coalesce if the two variables are not of the same type.  */\n-  if (TREE_TYPE (root1) != TREE_TYPE (root2))\n+  /* Don't coalesce if the two variables aren't type compatible .  */\n+  if (!types_compatible_p (TREE_TYPE (root1), TREE_TYPE (root2))\n+      /* There is a disconnect between the middle-end type-system and\n+         VRP, avoid coalescing enum types with different bounds.  */\n+      || ((TREE_CODE (TREE_TYPE (root1)) == ENUMERAL_TYPE\n+\t   || TREE_CODE (TREE_TYPE (root2)) == ENUMERAL_TYPE)\n+\t  && TREE_TYPE (root1) != TREE_TYPE (root2)))\n     {\n       if (debug)\n-\tfprintf (debug, \" : Different types.  No coalesce.\\n\");\n+\tfprintf (debug, \" : Incompatible types.  No coalesce.\\n\");\n       return false;\n     }\n "}]}