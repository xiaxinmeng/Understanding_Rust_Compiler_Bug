{"sha": "00d600138536a4978f40b25233c2f37c0fc426d4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDBkNjAwMTM4NTM2YTQ5NzhmNDBiMjUyMzNjMmYzN2MwZmM0MjZkNA==", "commit": {"author": {"name": "Wilco Dijkstra", "email": "wdijkstr@arm.com", "date": "2017-05-18T15:58:33Z"}, "committer": {"name": "Wilco Dijkstra", "email": "wilco@gcc.gnu.org", "date": "2017-05-18T15:58:33Z"}, "message": "Add an assert to leaf_function_p to ensure it is not called from a prolog or...\n\nAdd an assert to leaf_function_p to ensure it is not called from a\nprolog or epilog sequence (which would incorrectly return true in a\nnon-leaf function).  There are several targets which still call\nleaf_function_p, and while most appear safe or appear aware of the\nissue, it is likely not all such calls are safe.  This check enables\nany such latent bugs to be found.\n\n    gcc/\n\t* final.c (leaf_function_p): Check we are not in a sequence.\n\nFrom-SVN: r248240", "tree": {"sha": "8f1c7987efcffcb6c2d403a3ea483a1fdd783b71", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8f1c7987efcffcb6c2d403a3ea483a1fdd783b71"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/00d600138536a4978f40b25233c2f37c0fc426d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00d600138536a4978f40b25233c2f37c0fc426d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00d600138536a4978f40b25233c2f37c0fc426d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00d600138536a4978f40b25233c2f37c0fc426d4/comments", "author": null, "committer": null, "parents": [{"sha": "2063b07f4de76afe602730fb51acd8aebbf5c1bd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2063b07f4de76afe602730fb51acd8aebbf5c1bd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2063b07f4de76afe602730fb51acd8aebbf5c1bd"}], "stats": {"total": 7, "additions": 7, "deletions": 0}, "files": [{"sha": "a9a861eb5e8c63baea551ccc8a6d051faf008bcf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/00d600138536a4978f40b25233c2f37c0fc426d4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/00d600138536a4978f40b25233c2f37c0fc426d4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=00d600138536a4978f40b25233c2f37c0fc426d4", "patch": "@@ -1,3 +1,7 @@\n+2017-05-18  Wilco Dijkstra  <wdijkstr@arm.com>\n+\n+\t* final.c (leaf_function_p): Check we are not in a sequence.\n+\n 2017-05-18  Martin Liska  <mliska@suse.cz>\n \n \t* cfgrtl.c (rtl_verify_edges): Remove usage of TDF_RTL."}, {"sha": "e61b78b0a915df748fcf3d73cd46db855cf7a1c6", "filename": "gcc/final.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/00d600138536a4978f40b25233c2f37c0fc426d4/gcc%2Ffinal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/00d600138536a4978f40b25233c2f37c0fc426d4/gcc%2Ffinal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffinal.c?ref=00d600138536a4978f40b25233c2f37c0fc426d4", "patch": "@@ -4309,6 +4309,9 @@ leaf_function_p (void)\n {\n   rtx_insn *insn;\n \n+  /* Ensure we walk the entire function body.  */\n+  gcc_assert (!in_sequence_p ());\n+\n   /* Some back-ends (e.g. s390) want leaf functions to stay leaf\n      functions even if they call mcount.  */\n   if (crtl->profile && !targetm.keep_leaf_when_profiled ())"}]}