{"sha": "9ed929017c682714d2a81f840fbe97a8a56fbe96", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWVkOTI5MDE3YzY4MjcxNGQyYTgxZjg0MGZiZTk3YThhNTZmYmU5Ng==", "commit": {"author": {"name": "Adrian Straetling", "email": "straetling@de.ibm.com", "date": "2005-07-07T10:21:05Z"}, "committer": {"name": "Ulrich Weigand", "email": "uweigand@gcc.gnu.org", "date": "2005-07-07T10:21:05Z"}, "message": "expr.c: (set_storage_via_setmem): Convert opchar to mode defined by back-end.\n\n2005-07-07  Adrian Straetling  <straetling@de.ibm.com>\n\n\t* expr.c: (set_storage_via_setmem): Convert opchar to mode\n\tdefined by back-end.\n\nFrom-SVN: r101703", "tree": {"sha": "4ae6d3184c3aa9f403df202e9e611d95966d8385", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4ae6d3184c3aa9f403df202e9e611d95966d8385"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ed929017c682714d2a81f840fbe97a8a56fbe96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ed929017c682714d2a81f840fbe97a8a56fbe96", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ed929017c682714d2a81f840fbe97a8a56fbe96", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ed929017c682714d2a81f840fbe97a8a56fbe96/comments", "author": null, "committer": null, "parents": [{"sha": "1a9cb483e692b788e45ec39c4eba6bdadd1f7433", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a9cb483e692b788e45ec39c4eba6bdadd1f7433", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a9cb483e692b788e45ec39c4eba6bdadd1f7433"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "c54bf1b254b128dfe339b628eb4745270d94af9b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ed929017c682714d2a81f840fbe97a8a56fbe96/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ed929017c682714d2a81f840fbe97a8a56fbe96/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9ed929017c682714d2a81f840fbe97a8a56fbe96", "patch": "@@ -1,3 +1,8 @@\n+2005-07-07  Adrian Straetling  <straetling@de.ibm.com>\n+\n+\t* expr.c: (set_storage_via_setmem): Convert opchar to mode\n+\tdefined by back-end.\n+\n 2005-07-07  Jakub Jelinek  <jakub@redhat.com>\n \n \t* config/sparc/sparc.md (stack_protect_testsi): Put clobbers after"}, {"sha": "d778b59c95d7004e97b880120eb448d03a795512", "filename": "gcc/expr.c", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ed929017c682714d2a81f840fbe97a8a56fbe96/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ed929017c682714d2a81f840fbe97a8a56fbe96/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=9ed929017c682714d2a81f840fbe97a8a56fbe96", "patch": "@@ -2608,7 +2608,8 @@ set_storage_via_setmem (rtx object, rtx size, rtx val, unsigned int align)\n \t  && ((pred = insn_data[(int) code].operand[3].predicate) == 0\n \t      || (*pred) (opalign, VOIDmode)))\n \t{\n-\t  rtx opsize,opchar;\n+\t  rtx opsize, opchar;\n+\t  enum machine_mode char_mode;\n \t  rtx last = get_last_insn ();\n \t  rtx pat;\n \n@@ -2617,10 +2618,15 @@ set_storage_via_setmem (rtx object, rtx size, rtx val, unsigned int align)\n \t  if (pred != 0 && ! (*pred) (opsize, mode))\n \t    opsize = copy_to_mode_reg (mode, opsize);\n \t  \n-\t  opchar = convert_to_mode (mode, val, 1);\n-\t  pred = insn_data[(int) code].operand[2].predicate;\n-\t  if (pred != 0 && ! (*pred) (opchar, mode))\n-\t    opchar = copy_to_mode_reg (mode, opchar);\n+\t  opchar = val;\n+\t  char_mode = insn_data[(int) code].operand[2].mode;\n+\t  if (char_mode != VOIDmode)\n+\t    {\n+\t      opchar = convert_to_mode (char_mode, opchar, 1);\n+\t      pred = insn_data[(int) code].operand[2].predicate;\n+\t      if (pred != 0 && ! (*pred) (opchar, char_mode))\n+\t\topchar = copy_to_mode_reg (char_mode, opchar);\n+\t    }\n \n \t  pat = GEN_FCN ((int) code) (object, opsize, opchar, opalign);\n \t  if (pat)"}]}