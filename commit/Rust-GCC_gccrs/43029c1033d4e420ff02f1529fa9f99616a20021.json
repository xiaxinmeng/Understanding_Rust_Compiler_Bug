{"sha": "43029c1033d4e420ff02f1529fa9f99616a20021", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDMwMjljMTAzM2Q0ZTQyMGZmMDJmMTUyOWZhOWY5OTYxNmEyMDAyMQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@nildram.co.uk", "date": "2007-10-21T09:24:16Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2007-10-21T09:24:16Z"}, "message": "mips.c (mips_cannot_change_mode_class): Don't check for modes smaller than 4 bytes.\n\ngcc/\n\t* config/mips/mips.c (mips_cannot_change_mode_class): Don't check\n\tfor modes smaller than 4 bytes.\n\t* config/mips/mips.md (*movhi_internal, *movqi_internal): Remove\n\tFPR alternatives.\n\nFrom-SVN: r129528", "tree": {"sha": "2895d588fc9d854946a9ab6594851b5908872620", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2895d588fc9d854946a9ab6594851b5908872620"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/43029c1033d4e420ff02f1529fa9f99616a20021", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43029c1033d4e420ff02f1529fa9f99616a20021", "html_url": "https://github.com/Rust-GCC/gccrs/commit/43029c1033d4e420ff02f1529fa9f99616a20021", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43029c1033d4e420ff02f1529fa9f99616a20021/comments", "author": null, "committer": null, "parents": [{"sha": "7c6794f4843066ea2657691a94db06e5487e0097", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c6794f4843066ea2657691a94db06e5487e0097", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7c6794f4843066ea2657691a94db06e5487e0097"}], "stats": {"total": 37, "additions": 17, "deletions": 20}, "files": [{"sha": "ab5dc76b9c51e38ae9d4434f101a5f3c37964693", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43029c1033d4e420ff02f1529fa9f99616a20021/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43029c1033d4e420ff02f1529fa9f99616a20021/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=43029c1033d4e420ff02f1529fa9f99616a20021", "patch": "@@ -1,3 +1,10 @@\n+2007-10-21  Richard Sandiford  <rsandifo@nildram.co.uk>\n+\n+\t* config/mips/mips.c (mips_cannot_change_mode_class): Don't check\n+\tfor modes smaller than 4 bytes.\n+\t* config/mips/mips.md (*movhi_internal, *movqi_internal): Remove\n+\tFPR alternatives.\n+\n 2007-10-21  Richard Sandiford  <rsandifo@nildram.co.uk>\n \n \t* config/mips/mips-protos.h (mips_output_aligned_bss): Delete."}, {"sha": "92d85afdafb445e3f6a72d0cdcf6bd86c6b4e358", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43029c1033d4e420ff02f1529fa9f99616a20021/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43029c1033d4e420ff02f1529fa9f99616a20021/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=43029c1033d4e420ff02f1529fa9f99616a20021", "patch": "@@ -8843,14 +8843,8 @@ mips_cannot_change_mode_class (enum machine_mode from ATTRIBUTE_UNUSED,\n      - If the FPU has already interpreted a value in one format, we must\n        not ask it to treat the value as having a different format.\n \n-     We therefore only allow changes between 4-byte and smaller integer\n-     values, all of which have the \"W\" format as far as the FPU is\n-     concerned.  */\n-  return (reg_classes_intersect_p (FP_REGS, class)\n-\t  && (GET_MODE_CLASS (from) != MODE_INT\n-\t      || GET_MODE_CLASS (to) != MODE_INT\n-\t      || GET_MODE_SIZE (from) > 4\n-\t      || GET_MODE_SIZE (to) > 4));\n+     We therefore disallow all mode changes involving FPRs.  */\n+  return reg_classes_intersect_p (FP_REGS, class);\n }\n \n /* Return true if moves in mode MODE can use the FPU's mov.fmt instruction.  */"}, {"sha": "ebf8104fda68c453db4ac72c607593e67858d4d9", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 8, "deletions": 12, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43029c1033d4e420ff02f1529fa9f99616a20021/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43029c1033d4e420ff02f1529fa9f99616a20021/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=43029c1033d4e420ff02f1529fa9f99616a20021", "patch": "@@ -3757,8 +3757,8 @@\n })\n \n (define_insn \"*movhi_internal\"\n-  [(set (match_operand:HI 0 \"nonimmediate_operand\" \"=d,d,d,m,*d,*f,*x\")\n-\t(match_operand:HI 1 \"move_operand\"         \"d,I,m,dJ,*f,*d,*d\"))]\n+  [(set (match_operand:HI 0 \"nonimmediate_operand\" \"=d,d,d,m,*x\")\n+\t(match_operand:HI 1 \"move_operand\"         \"d,I,m,dJ,*d\"))]\n   \"!TARGET_MIPS16\n    && (register_operand (operands[0], HImode)\n        || reg_or_0_operand (operands[1], HImode))\"\n@@ -3767,12 +3767,10 @@\n     li\\t%0,%1\n     lhu\\t%0,%1\n     sh\\t%z1,%0\n-    mfc1\\t%0,%1\n-    mtc1\\t%1,%0\n     mt%0\\t%1\"\n-  [(set_attr \"type\"\t\"move,arith,load,store,mfc,mtc,mthilo\")\n+  [(set_attr \"type\"\t\"move,arith,load,store,mthilo\")\n    (set_attr \"mode\"\t\"HI\")\n-   (set_attr \"length\"\t\"4,4,*,*,4,4,4\")])\n+   (set_attr \"length\"\t\"4,4,*,*,4\")])\n \n (define_insn \"*movhi_mips16\"\n   [(set (match_operand:HI 0 \"nonimmediate_operand\" \"=d,y,d,d,d,d,m\")\n@@ -3863,8 +3861,8 @@\n })\n \n (define_insn \"*movqi_internal\"\n-  [(set (match_operand:QI 0 \"nonimmediate_operand\" \"=d,d,d,m,*d,*f,*x\")\n-\t(match_operand:QI 1 \"move_operand\"         \"d,I,m,dJ,*f,*d,*d\"))]\n+  [(set (match_operand:QI 0 \"nonimmediate_operand\" \"=d,d,d,m,*x\")\n+\t(match_operand:QI 1 \"move_operand\"         \"d,I,m,dJ,*d\"))]\n   \"!TARGET_MIPS16\n    && (register_operand (operands[0], QImode)\n        || reg_or_0_operand (operands[1], QImode))\"\n@@ -3873,12 +3871,10 @@\n     li\\t%0,%1\n     lbu\\t%0,%1\n     sb\\t%z1,%0\n-    mfc1\\t%0,%1\n-    mtc1\\t%1,%0\n     mt%0\\t%1\"\n-  [(set_attr \"type\"\t\"move,arith,load,store,mfc,mtc,mthilo\")\n+  [(set_attr \"type\"\t\"move,arith,load,store,mthilo\")\n    (set_attr \"mode\"\t\"QI\")\n-   (set_attr \"length\"\t\"4,4,*,*,4,4,4\")])\n+   (set_attr \"length\"\t\"4,4,*,*,4\")])\n \n (define_insn \"*movqi_mips16\"\n   [(set (match_operand:QI 0 \"nonimmediate_operand\" \"=d,y,d,d,d,d,m\")"}]}