{"sha": "4e568a151c146de62c58f35cd4620145600e4bf2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGU1NjhhMTUxYzE0NmRlNjJjNThmMzVjZDQ2MjAxNDU2MDBlNGJmMg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2012-11-09T11:07:30Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2012-11-09T11:07:30Z"}, "message": "trans.c (gnat_to_gnu): Deal with a missing library unit instead of calling gnat_to_gnu on Emtpy.\n\n\t* gcc-interface/trans.c (gnat_to_gnu) <N_Subprogram_Body_Stub>: Deal\n\twith a missing library unit instead of calling gnat_to_gnu on Emtpy.\n\tRemove last bits of support for SCIL nodes.  Add cases for nodes that\n\tshould only be present when annotating types.  Add default abort.\n\nFrom-SVN: r193357", "tree": {"sha": "416759c1516f6513f952d4883ad51ceb994c8e4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/416759c1516f6513f952d4883ad51ceb994c8e4e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4e568a151c146de62c58f35cd4620145600e4bf2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e568a151c146de62c58f35cd4620145600e4bf2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e568a151c146de62c58f35cd4620145600e4bf2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e568a151c146de62c58f35cd4620145600e4bf2/comments", "author": null, "committer": null, "parents": [{"sha": "4993465992b6711d8bda90247122135d01ed6f3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4993465992b6711d8bda90247122135d01ed6f3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4993465992b6711d8bda90247122135d01ed6f3d"}], "stats": {"total": 32, "additions": 27, "deletions": 5}, "files": [{"sha": "68715760e835cb9ea90aa97c198fa498e760cb47", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e568a151c146de62c58f35cd4620145600e4bf2/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e568a151c146de62c58f35cd4620145600e4bf2/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=4e568a151c146de62c58f35cd4620145600e4bf2", "patch": "@@ -1,3 +1,10 @@\n+2012-11-09  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/trans.c (gnat_to_gnu) <N_Subprogram_Body_Stub>: Deal\n+\twith a missing library unit instead of calling gnat_to_gnu on Emtpy.\n+\tRemove last bits of support for SCIL nodes.  Add cases for nodes that\n+\tshould only be present when annotating types.  Add default abort.\n+\n 2012-11-06  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/Makefile.in: Revert most changes."}, {"sha": "dbc4689a1d58fb362199ba96404b1e3fc8940d98", "filename": "gcc/ada/gcc-interface/trans.c", "status": "modified", "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e568a151c146de62c58f35cd4620145600e4bf2/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e568a151c146de62c58f35cd4620145600e4bf2/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Ftrans.c?ref=4e568a151c146de62c58f35cd4620145600e4bf2", "patch": "@@ -6493,7 +6493,13 @@ gnat_to_gnu (Node_Id gnat_node)\n     case N_Protected_Body_Stub:\n     case N_Task_Body_Stub:\n       /* Simply process whatever unit is being inserted.  */\n-      gnu_result = gnat_to_gnu (Unit (Library_Unit (gnat_node)));\n+      if (Present (Library_Unit (gnat_node)))\n+\tgnu_result = gnat_to_gnu (Unit (Library_Unit (gnat_node)));\n+      else\n+\t{\n+\t  gcc_assert (type_annotate_only);\n+\t  gnu_result = alloc_stmt_list ();\n+\t}\n       break;\n \n     case N_Subunit:\n@@ -6855,11 +6861,20 @@ gnat_to_gnu (Node_Id gnat_node)\n       gnu_result = alloc_stmt_list ();\n       break;\n \n-    default:\n-      /* SCIL nodes require no processing for GCC.  Other nodes should only\n-\t be present when annotating types.  */\n-      gcc_assert (IN (kind, N_SCIL_Node) || type_annotate_only);\n+    case N_Function_Specification:\n+    case N_Procedure_Specification:\n+    case N_Op_Concat:\n+    case N_Component_Association:\n+    case N_Protected_Body:\n+    case N_Task_Body:\n+      /* These nodes should only be present when annotating types.  */\n+      gcc_assert (type_annotate_only);\n       gnu_result = alloc_stmt_list ();\n+      break;\n+\n+    default:\n+      /* Other nodes are not supposed to reach here.  */\n+      gcc_unreachable ();\n     }\n \n   /* If we pushed the processing of the elaboration routine, pop it back.  */"}]}