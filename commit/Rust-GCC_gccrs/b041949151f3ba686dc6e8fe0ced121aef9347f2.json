{"sha": "b041949151f3ba686dc6e8fe0ced121aef9347f2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjA0MTk0OTE1MWYzYmE2ODZkYzZlOGZlMGNlZDEyMWFlZjkzNDdmMg==", "commit": {"author": {"name": "Terry Guo", "email": "terry.guo@arm.com", "date": "2014-04-24T06:40:24Z"}, "committer": {"name": "Xuepeng Guo", "email": "xguo@gcc.gnu.org", "date": "2014-04-24T06:40:24Z"}, "message": "arm.h (machine_function): Define variable after_arm_reorg here.\n\n2014-04-24  Terry Guo  <terry.guo@arm.com>\n\n\t* config/arm/arm.h (machine_function): Define variable\n\tafter_arm_reorg here.\n\t* config/arm/arm.c (after_arm_reorg): Remove the definition.\n\t(arm_split_constant): Update the way to access variable\n\tafter_arm_reorg.\n\t(arm_reorg): Ditto.\n\t(arm_output_function_epilogue): Remove the reset of after_arm_reorg.\n\nFrom-SVN: r209735", "tree": {"sha": "4f2ffdc8f2df7eb9f9f1e9f3ed3267a6d4b1e088", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f2ffdc8f2df7eb9f9f1e9f3ed3267a6d4b1e088"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b041949151f3ba686dc6e8fe0ced121aef9347f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b041949151f3ba686dc6e8fe0ced121aef9347f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b041949151f3ba686dc6e8fe0ced121aef9347f2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b041949151f3ba686dc6e8fe0ced121aef9347f2/comments", "author": null, "committer": null, "parents": [{"sha": "080c6230de51a4fb0316ef51b86ead129b03f0b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/080c6230de51a4fb0316ef51b86ead129b03f0b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/080c6230de51a4fb0316ef51b86ead129b03f0b1"}], "stats": {"total": 23, "additions": 14, "deletions": 9}, "files": [{"sha": "db6d73f925d85e64cbfbfeeb8ae445b342c01069", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b041949151f3ba686dc6e8fe0ced121aef9347f2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b041949151f3ba686dc6e8fe0ced121aef9347f2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b041949151f3ba686dc6e8fe0ced121aef9347f2", "patch": "@@ -1,3 +1,13 @@\n+2014-04-24  Terry Guo  <terry.guo@arm.com>\n+\n+\t* config/arm/arm.h (machine_function): Define variable\n+\tafter_arm_reorg here.\n+\t* config/arm/arm.c (after_arm_reorg): Remove the definition.\n+\t(arm_split_constant): Update the way to access variable\n+\tafter_arm_reorg.\n+\t(arm_reorg): Ditto.\n+\t(arm_output_function_epilogue): Remove the reset of after_arm_reorg.\n+\n 2014-04-23  Tom de Vries  <tom@codesourcery.com>\n \n \t* target-hooks-macros.h: Fix DEFHOOKPOD argument order in comment."}, {"sha": "09b5c520d6659fe4ce79aee9e5d126cf454f8252", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b041949151f3ba686dc6e8fe0ced121aef9347f2/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b041949151f3ba686dc6e8fe0ced121aef9347f2/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=b041949151f3ba686dc6e8fe0ced121aef9347f2", "patch": "@@ -884,10 +884,6 @@ enum machine_mode output_memory_reference_mode;\n /* The register number to be used for the PIC offset register.  */\n unsigned arm_pic_register = INVALID_REGNUM;\n \n-/* Set to 1 after arm_reorg has started.  Reset to start at the start of\n-   the next function.  */\n-static int after_arm_reorg = 0;\n-\n enum arm_pcs arm_pcs_default;\n \n /* For an explanation of these variables, see final_prescan_insn below.  */\n@@ -3516,7 +3512,7 @@ arm_split_constant (enum rtx_code code, enum machine_mode mode, rtx insn,\n \n \t Ref: gcc -O1 -mcpu=strongarm gcc.c-torture/compile/980506-2.c\n       */\n-      if (!after_arm_reorg\n+      if (!cfun->machine->after_arm_reorg\n \t  && !cond\n \t  && (arm_gen_constant (code, mode, NULL_RTX, val, target, source,\n \t\t\t\t1, 0)\n@@ -17378,7 +17374,7 @@ arm_reorg (void)\n   /* From now on we must synthesize any constants that we can't handle\n      directly.  This can happen if the RTL gets split during final\n      instruction generation.  */\n-  after_arm_reorg = 1;\n+  cfun->machine->after_arm_reorg = 1;\n \n   /* Free the minipool memory.  */\n   obstack_free (&minipool_obstack, minipool_startobj);\n@@ -19527,9 +19523,6 @@ arm_output_function_epilogue (FILE *file ATTRIBUTE_UNUSED,\n \t\t  || (cfun->machine->return_used_this_function != 0)\n \t\t  || offsets->saved_regs == offsets->outgoing_args\n \t\t  || frame_pointer_needed);\n-\n-      /* Reset the ARM-specific per-function variables.  */\n-      after_arm_reorg = 0;\n     }\n }\n "}, {"sha": "3a9e3ebbb3e55588c5f42118d7d839eddae7289e", "filename": "gcc/config/arm/arm.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b041949151f3ba686dc6e8fe0ced121aef9347f2/gcc%2Fconfig%2Farm%2Farm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b041949151f3ba686dc6e8fe0ced121aef9347f2/gcc%2Fconfig%2Farm%2Farm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.h?ref=b041949151f3ba686dc6e8fe0ced121aef9347f2", "patch": "@@ -1543,6 +1543,8 @@ typedef struct GTY(()) machine_function\n   rtx thumb1_cc_op1;\n   /* Also record the CC mode that is supported.  */\n   enum machine_mode thumb1_cc_mode;\n+  /* Set to 1 after arm_reorg has started.  */\n+  int after_arm_reorg;\n }\n machine_function;\n #endif"}]}