{"sha": "c336eda750d4e7a0827fedf995da955d6d88d5ca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzMzNmVkYTc1MGQ0ZTdhMDgyN2ZlZGY5OTVkYTk1NWQ2ZDg4ZDVjYQ==", "commit": {"author": {"name": "Mark Eggleston", "email": "markeggleston@gcc.gnu.org", "date": "2020-08-21T05:39:30Z"}, "committer": {"name": "Mark Eggleston", "email": "markeggleston@gcc.gnu.org", "date": "2020-08-27T14:12:10Z"}, "message": "Fortran  : ICE for division by zero in declaration PR95882\n\nA length expression containing a divide by zero in a character\ndeclaration will result in an ICE if the constant is anymore\ncomplicated that a contant divided by a constant.\n\nThe cause was that char_len_param_value can return MATCH_YES\neven if a divide by zero was seen.  Prior to returning check\nwhether a divide by zero was seen and if so set it to MATCH_ERROR.\n\n2020-08-27  Mark Eggleston  <markeggleston@gcc.gnu.org>\n\ngcc/fortran\n\n\tPR fortran/95882\n\t* decl.c (char_len_param_value): Check gfc_seen_div0 and\n\tif it is set return MATCH_ERROR.\n\n2020-08-27  Mark Eggleston  <markeggleston@gcc.gnu.org>\n\ngcc/testsuite/\n\n\tPR fortran/95882\n\t* gfortran.dg/pr95882_1.f90: New test.\n\t* gfortran.dg/pr95882_2.f90: New test.\n\t* gfortran.dg/pr95882_3.f90: New test.\n\t* gfortran.dg/pr95882_4.f90: New test.\n\t* gfortran.dg/pr95882_5.f90: New test.", "tree": {"sha": "885de20dcd69f4de23eb0ae46cd8c675ea2cf481", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/885de20dcd69f4de23eb0ae46cd8c675ea2cf481"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c336eda750d4e7a0827fedf995da955d6d88d5ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c336eda750d4e7a0827fedf995da955d6d88d5ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c336eda750d4e7a0827fedf995da955d6d88d5ca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c336eda750d4e7a0827fedf995da955d6d88d5ca/comments", "author": null, "committer": null, "parents": [{"sha": "eb68d9d828f94d28afa5900fbf3072bbcd64ba8a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb68d9d828f94d28afa5900fbf3072bbcd64ba8a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb68d9d828f94d28afa5900fbf3072bbcd64ba8a"}], "stats": {"total": 36, "additions": 36, "deletions": 0}, "files": [{"sha": "c612b492f3e51989048372b1d6867938c33450e0", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=c336eda750d4e7a0827fedf995da955d6d88d5ca", "patch": "@@ -1146,6 +1146,9 @@ char_len_param_value (gfc_expr **expr, bool *deferred)\n       gfc_free_expr (e);\n     }\n \n+  if (gfc_seen_div0)\n+    m = MATCH_ERROR;\n+\n   return m;\n \n syntax:"}, {"sha": "c254bddf49452dc55ee82a4c0a8a2236d5dc0468", "filename": "gcc/testsuite/gfortran.dg/pr95882_1.f90", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_1.f90?ref=c336eda750d4e7a0827fedf995da955d6d88d5ca", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+\n+module m\n+   type t\n+      character(((0)/0)) :: c  ! { dg-error \"Division by zero\" }\n+   end type\n+end\n+"}, {"sha": "d308f0c3181edb0a95033cde83ede13e2e518249", "filename": "gcc/testsuite/gfortran.dg/pr95882_2.f90", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_2.f90?ref=c336eda750d4e7a0827fedf995da955d6d88d5ca", "patch": "@@ -0,0 +1,6 @@\n+! { dg-do compile }\n+\n+module m\n+   character(0/(0)) :: c = '123456789'  ! { dg-error \"Division by zero\" }\n+end\n+"}, {"sha": "bd8491354804721bb6a680bad1c082dead59e813", "filename": "gcc/testsuite/gfortran.dg/pr95882_3.f90", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_3.f90?ref=c336eda750d4e7a0827fedf995da955d6d88d5ca", "patch": "@@ -0,0 +1,6 @@\n+! { dg-do compile }\n+\n+subroutine s(c)\n+   character(((0)/0)) :: c  ! { dg-error \"Division by zero\" }\n+end\n+"}, {"sha": "52892d32b8baae17daab80163b00b554df32a469", "filename": "gcc/testsuite/gfortran.dg/pr95882_4.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_4.f90?ref=c336eda750d4e7a0827fedf995da955d6d88d5ca", "patch": "@@ -0,0 +1,7 @@\n+! { dg-do compile }\n+\n+program p\n+   character(((0)/0)) :: c  ! { dg-error \"Division by zero\" }\n+   common /x/ c\n+end\n+"}, {"sha": "dcdf53040529e2b584018491f1871a6f237c45eb", "filename": "gcc/testsuite/gfortran.dg/pr95882_5.f90", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_5.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c336eda750d4e7a0827fedf995da955d6d88d5ca/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_5.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr95882_5.f90?ref=c336eda750d4e7a0827fedf995da955d6d88d5ca", "patch": "@@ -0,0 +1,6 @@\n+! { dg-do compile }\n+\n+program p\n+   character(0/(0)) :: c = '123456789'  ! { dg-error \"Division by zero\" }\n+   common c\n+end"}]}