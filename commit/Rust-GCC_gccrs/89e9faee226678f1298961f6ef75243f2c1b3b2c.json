{"sha": "89e9faee226678f1298961f6ef75243f2c1b3b2c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODllOWZhZWUyMjY2NzhmMTI5ODk2MWY2ZWY3NTI0M2YyYzFiM2IyYw==", "commit": {"author": {"name": "Geoffrey Keating", "email": "geoffk@apple.com", "date": "2003-07-17T21:50:38Z"}, "committer": {"name": "Geoffrey Keating", "email": "geoffk@gcc.gnu.org", "date": "2003-07-17T21:50:38Z"}, "message": "c-opts.c (this_input_filename): New.\n\n\t* c-opts.c (this_input_filename): New.\n\t(finish_options): Take new parameter, name of file being compiled.\n\tUpdate callers.  Set this_input_filename.\n\t(push_command_line_include): Use this_input_filename not\n\tmain_input_filename.\n\nFrom-SVN: r69526", "tree": {"sha": "9da859c524037ff60011baf56048d01576d05ffc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9da859c524037ff60011baf56048d01576d05ffc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/89e9faee226678f1298961f6ef75243f2c1b3b2c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89e9faee226678f1298961f6ef75243f2c1b3b2c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/89e9faee226678f1298961f6ef75243f2c1b3b2c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89e9faee226678f1298961f6ef75243f2c1b3b2c/comments", "author": {"login": "geoffk01", "id": 31905243, "node_id": "MDQ6VXNlcjMxOTA1MjQz", "avatar_url": "https://avatars.githubusercontent.com/u/31905243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/geoffk01", "html_url": "https://github.com/geoffk01", "followers_url": "https://api.github.com/users/geoffk01/followers", "following_url": "https://api.github.com/users/geoffk01/following{/other_user}", "gists_url": "https://api.github.com/users/geoffk01/gists{/gist_id}", "starred_url": "https://api.github.com/users/geoffk01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/geoffk01/subscriptions", "organizations_url": "https://api.github.com/users/geoffk01/orgs", "repos_url": "https://api.github.com/users/geoffk01/repos", "events_url": "https://api.github.com/users/geoffk01/events{/privacy}", "received_events_url": "https://api.github.com/users/geoffk01/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "36c6d174b370a10550ae749d624e62e9b43d0066", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36c6d174b370a10550ae749d624e62e9b43d0066", "html_url": "https://github.com/Rust-GCC/gccrs/commit/36c6d174b370a10550ae749d624e62e9b43d0066"}], "stats": {"total": 24, "additions": 18, "deletions": 6}, "files": [{"sha": "2ad26e382950d617bed3745eb453d74af7212892", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89e9faee226678f1298961f6ef75243f2c1b3b2c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89e9faee226678f1298961f6ef75243f2c1b3b2c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=89e9faee226678f1298961f6ef75243f2c1b3b2c", "patch": "@@ -1,3 +1,11 @@\n+2003-07-17  Geoffrey Keating  <geoffk@apple.com>\n+\n+\t* c-opts.c (this_input_filename): New.\n+\t(finish_options): Take new parameter, name of file being compiled.\n+\tUpdate callers.  Set this_input_filename.\n+\t(push_command_line_include): Use this_input_filename not\n+\tmain_input_filename.\n+\n 2003-07-17  Neil Booth  <neil@daikokuya.co.uk>\n \n \t* Makefile.in: Depend .pot generation on options.c."}, {"sha": "1beb651fe915b0168b02e577dc4197bf53fe2ae1", "filename": "gcc/c-opts.c", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89e9faee226678f1298961f6ef75243f2c1b3b2c/gcc%2Fc-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89e9faee226678f1298961f6ef75243f2c1b3b2c/gcc%2Fc-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-opts.c?ref=89e9faee226678f1298961f6ef75243f2c1b3b2c", "patch": "@@ -54,6 +54,7 @@ static cpp_options *cpp_opts;\n /* Input filename.  */\n static const char **in_fnames;\n static unsigned num_in_fnames;\n+static const char *this_input_filename;\n \n /* Filename and stream for preprocessed output.  */\n static const char *out_fname;\n@@ -109,7 +110,7 @@ static void sanitize_cpp_opts (void);\n static void add_prefixed_path (const char *, size_t);\n static void push_command_line_include (void);\n static void cb_file_change (cpp_reader *, const struct line_map *);\n-static void finish_options (void);\n+static void finish_options (const char *);\n \n #ifndef STDC_0_IN_SYSTEM_HEADERS\n #define STDC_0_IN_SYSTEM_HEADERS 0\n@@ -1167,7 +1168,7 @@ c_common_init (void)\n \n   if (flag_preprocess_only)\n     {\n-      finish_options ();\n+      finish_options (in_fnames[0]);\n       preprocess_file (parse_in);\n       return false;\n     }\n@@ -1205,7 +1206,7 @@ c_common_parse_file (int set_yydebug ATTRIBUTE_UNUSED)\n \t  cpp_read_next_file (parse_in, in_fnames[file_index]);\n \t}\n \n-      finish_options();\n+      finish_options(in_fnames[file_index]);\n       if (file_index == 0)\n \tpch_init();\n       c_parse_file ();\n@@ -1361,9 +1362,11 @@ add_prefixed_path (const char *suffix, size_t chain)\n   add_path (path, chain, 0);\n }\n \n-/* Handle -D, -U, -A, -imacros, and the first -include.  */\n+/* Handle -D, -U, -A, -imacros, and the first -include.  \n+   TIF is the input file to which we will return after processing all\n+   the includes.  */\n static void\n-finish_options (void)\n+finish_options (const char *tif)\n {\n   if (!cpp_opts->preprocessed)\n     {\n@@ -1414,6 +1417,7 @@ finish_options (void)\n     }\n \n   include_cursor = 0;\n+  this_input_filename = tif;\n   push_command_line_include ();\n }\n \n@@ -1435,7 +1439,7 @@ push_command_line_include (void)\n   if (include_cursor == deferred_count)\n     {\n       /* Restore the line map from <command line>.  */\n-      cpp_change_file (parse_in, LC_RENAME, main_input_filename);\n+      cpp_change_file (parse_in, LC_RENAME, this_input_filename);\n       /* -Wunused-macros should only warn about macros defined hereafter.  */\n       cpp_opts->warn_unused_macros = warn_unused_macros;\n       include_cursor++;"}]}