{"sha": "c98f255154798847bdd1fc6ce33266c1a1ddc13a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk4ZjI1NTE1NDc5ODg0N2JkZDFmYzZjZTMzMjY2YzFhMWRkYzEzYQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2019-01-28T23:58:57Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2019-01-28T23:58:57Z"}, "message": "PR libstdc++/68737 Do not use vsnprintf on HPUX\n\nIt doesn't conform to the spec, so use vsprintf with a large buffer\ninstead.\n\n\tPR libstdc++/68737\n\t* config/locale/generic/c_locale.h (__convert_from_v)\n\t[_GLIBCXX_USE_C99_STDIO]: Also check _GLIBCXX_HAVE_BROKEN_VSNPRINTF.\n\t* config/os/hpux/os_defines.h: Define _GLIBCXX_HAVE_BROKEN_VSNPRINTF.\n\t* include/bits/locale_facets.tcc (num_put::_M_insert_float)\n\t[_GLIBCXX_USE_C99_STDIO]: Also check _GLIBCXX_HAVE_BROKEN_VSNPRINTF.\n\nFrom-SVN: r268350", "tree": {"sha": "50629732a762e2e1fbf837659328b807a224d806", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50629732a762e2e1fbf837659328b807a224d806"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c98f255154798847bdd1fc6ce33266c1a1ddc13a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c98f255154798847bdd1fc6ce33266c1a1ddc13a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c98f255154798847bdd1fc6ce33266c1a1ddc13a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c98f255154798847bdd1fc6ce33266c1a1ddc13a/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f4b7e754cc9db79e4239ffcdf56acc780543ed05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4b7e754cc9db79e4239ffcdf56acc780543ed05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4b7e754cc9db79e4239ffcdf56acc780543ed05"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "89b94a88ccefd758a8856a09e2359cc4a8e3fa26", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=c98f255154798847bdd1fc6ce33266c1a1ddc13a", "patch": "@@ -1,3 +1,12 @@\n+2019-01-28  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/68737\n+\t* config/locale/generic/c_locale.h (__convert_from_v)\n+\t[_GLIBCXX_USE_C99_STDIO]: Also check _GLIBCXX_HAVE_BROKEN_VSNPRINTF.\n+\t* config/os/hpux/os_defines.h: Define _GLIBCXX_HAVE_BROKEN_VSNPRINTF.\n+\t* include/bits/locale_facets.tcc (num_put::_M_insert_float)\n+\t[_GLIBCXX_USE_C99_STDIO]: Also check _GLIBCXX_HAVE_BROKEN_VSNPRINTF.\n+\n 2019-01-24  Jonathan Wakely  <jwakely@redhat.com>\n \n \tPR libstdc++/88840"}, {"sha": "625a61c8bb2f4dc1451a634d1c7cbe262c3a2080", "filename": "libstdc++-v3/config/locale/generic/c_locale.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgeneric%2Fc_locale.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgeneric%2Fc_locale.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgeneric%2Fc_locale.h?ref=c98f255154798847bdd1fc6ce33266c1a1ddc13a", "patch": "@@ -70,7 +70,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     __builtin_va_list __args;\n     __builtin_va_start(__args, __fmt);\n \n-#if _GLIBCXX_USE_C99_STDIO\n+#if _GLIBCXX_USE_C99_STDIO && !_GLIBCXX_HAVE_BROKEN_VSNPRINTF\n     const int __ret = __builtin_vsnprintf(__out, __size, __fmt, __args);\n #else\n     const int __ret = __builtin_vsprintf(__out, __fmt, __args);"}, {"sha": "20a8b3ed30b28aee1c9e0391408ba156b557cc8c", "filename": "libstdc++-v3/config/os/hpux/os_defines.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fhpux%2Fos_defines.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fhpux%2Fos_defines.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Fos%2Fhpux%2Fos_defines.h?ref=c98f255154798847bdd1fc6ce33266c1a1ddc13a", "patch": "@@ -109,4 +109,9 @@ typedef long int __padding_type;\n #if defined (__hppa__)\n #define _GLIBCXX_HAVE_BROKEN_STRTOLD 1\n #endif\n+\n+// The vnsprintf function returns -1 when the buffer is too small.\n+// See PR libstdc++/68737.\n+#define _GLIBCXX_HAVE_BROKEN_VSNPRINTF 1\n+\n #endif"}, {"sha": "2eb8167db9a1f8978e9d928ca27d87acbcbf317f", "filename": "libstdc++-v3/include/bits/locale_facets.tcc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c98f255154798847bdd1fc6ce33266c1a1ddc13a/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc?ref=c98f255154798847bdd1fc6ce33266c1a1ddc13a", "patch": "@@ -992,7 +992,7 @@ _GLIBCXX_BEGIN_NAMESPACE_LDBL\n \tchar __fbuf[16];\n \t__num_base::_S_format_float(__io, __fbuf, __mod);\n \n-#if _GLIBCXX_USE_C99_STDIO\n+#if _GLIBCXX_USE_C99_STDIO && !_GLIBCXX_HAVE_BROKEN_VSNPRINTF\n \t// Precision is always used except for hexfloat format.\n \tconst bool __use_prec =\n \t  (__io.flags() & ios_base::floatfield) != ios_base::floatfield;"}]}