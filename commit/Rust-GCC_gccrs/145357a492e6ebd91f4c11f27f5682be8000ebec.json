{"sha": "145357a492e6ebd91f4c11f27f5682be8000ebec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTQ1MzU3YTQ5MmU2ZWJkOTFmNGMxMWYyN2Y1NjgyYmU4MDAwZWJlYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2005-06-07T21:45:07Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2005-06-07T21:45:07Z"}, "message": "re PR middle-end/21850 (misscompiling comparision from vector to integer)\n\n\tPR middle-end/21850\n\t* tree.c (get_unwidened): Stop at NOP_EXPR/CONVERT_EXPR that convert\n\tfrom vector types.\n\n\t* gcc.c-torture/execute/20050607-1.c: New test.\n\nFrom-SVN: r100725", "tree": {"sha": "289feaa6967e1edfb56b045c346f8586a45ab2ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/289feaa6967e1edfb56b045c346f8586a45ab2ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/145357a492e6ebd91f4c11f27f5682be8000ebec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/145357a492e6ebd91f4c11f27f5682be8000ebec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/145357a492e6ebd91f4c11f27f5682be8000ebec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/145357a492e6ebd91f4c11f27f5682be8000ebec/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "75829da2a941c239cb2ba258ea2b58700fd39264", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75829da2a941c239cb2ba258ea2b58700fd39264", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75829da2a941c239cb2ba258ea2b58700fd39264"}], "stats": {"total": 40, "additions": 37, "deletions": 3}, "files": [{"sha": "56573ec013d45a20caa1a1ebc03f322234fd848c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=145357a492e6ebd91f4c11f27f5682be8000ebec", "patch": "@@ -1,3 +1,9 @@\n+2005-06-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/21850\n+\t* tree.c (get_unwidened): Stop at NOP_EXPR/CONVERT_EXPR that convert\n+\tfrom vector types.\n+\n 2005-06-07  Diego Novillo  <dnovillo@redhat.com>\n \n \t* tree-ssa-threadupdate.c (struct thread_stats_d): Declare."}, {"sha": "5411467e053cdf0894fae2c0f34c9d355eebc3dd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=145357a492e6ebd91f4c11f27f5682be8000ebec", "patch": "@@ -1,3 +1,8 @@\n+2005-06-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/21850\n+\t* gcc.c-torture/execute/20050607-1.c: New test.\n+\n 2005-06-07  Thomas Koenig  <Thomas.Koenig@online.de>\n \n \tPR libfortran/21926"}, {"sha": "41579bbba5efcd6a78f3720b15dfa84903af2833", "filename": "gcc/testsuite/gcc.c-torture/execute/20050607-1.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20050607-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20050607-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20050607-1.c?ref=145357a492e6ebd91f4c11f27f5682be8000ebec", "patch": "@@ -0,0 +1,16 @@\n+/* PR middle-end/21850 */\n+\n+extern void abort (void);\n+\n+typedef int V2SI __attribute__ ((vector_size (8)));\n+\n+int\n+main (void)\n+{\n+#if (__INT_MAX__ == 2147483647) \\\n+    && (__LONG_LONG_MAX__ == 9223372036854775807LL)\n+  if (((int)(long long)(V2SI){ 2, 2 }) != 2)\n+    abort ();\n+#endif\n+  return 0;\n+}"}, {"sha": "2f5f924cdbefc3bf6190d560cf68531f2d2b4826", "filename": "gcc/tree.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/145357a492e6ebd91f4c11f27f5682be8000ebec/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=145357a492e6ebd91f4c11f27f5682be8000ebec", "patch": "@@ -4937,9 +4937,16 @@ get_unwidened (tree op, tree for_type)\n   while (TREE_CODE (op) == NOP_EXPR\n \t || TREE_CODE (op) == CONVERT_EXPR)\n     {\n-      int bitschange\n-\t= TYPE_PRECISION (TREE_TYPE (op))\n-\t  - TYPE_PRECISION (TREE_TYPE (TREE_OPERAND (op, 0)));\n+      int bitschange;\n+\n+      /* TYPE_PRECISION on vector types has different meaning\n+\t (TYPE_VECTOR_SUBPARTS) and casts from vectors are view conversions,\n+\t so avoid them here.  */\n+      if (TREE_CODE (TREE_TYPE (TREE_OPERAND (op, 0))) == VECTOR_TYPE)\n+\tbreak;\n+\n+      bitschange = TYPE_PRECISION (TREE_TYPE (op))\n+\t\t   - TYPE_PRECISION (TREE_TYPE (TREE_OPERAND (op, 0)));\n \n       /* Truncations are many-one so cannot be removed.\n \t Unless we are later going to truncate down even farther.  */"}]}