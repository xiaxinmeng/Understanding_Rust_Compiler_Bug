{"sha": "2b151cb23b672323fea91892fcb1d2f41c410e78", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmIxNTFjYjIzYjY3MjMyM2ZlYTkxODkyZmNiMWQyZjQxYzQxMGU3OA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2005-07-15T09:46:17Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2005-07-15T09:46:17Z"}, "message": "cfg.c (update_bb_profile_for_threading): More diagnostic.\n\n\t* cfg.c (update_bb_profile_for_threading): More diagnostic.\n\t* tree-ssa-threadupdate.c (redirect_edges): Update profile of dup_block.\n\nFrom-SVN: r102053", "tree": {"sha": "e18b6fa79ab9456ec92957369f1b704294631166", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e18b6fa79ab9456ec92957369f1b704294631166"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2b151cb23b672323fea91892fcb1d2f41c410e78", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b151cb23b672323fea91892fcb1d2f41c410e78", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b151cb23b672323fea91892fcb1d2f41c410e78", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b151cb23b672323fea91892fcb1d2f41c410e78/comments", "author": null, "committer": null, "parents": [{"sha": "0691d1d4a31ff0a426d2ba07c64acbac5df6b8ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0691d1d4a31ff0a426d2ba07c64acbac5df6b8ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0691d1d4a31ff0a426d2ba07c64acbac5df6b8ae"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "525ad008bb203951c3c23c100ddb39377e21e3c2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b151cb23b672323fea91892fcb1d2f41c410e78/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b151cb23b672323fea91892fcb1d2f41c410e78/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2b151cb23b672323fea91892fcb1d2f41c410e78", "patch": "@@ -1,3 +1,8 @@\n+2005-07-15  Jan Hubicka  <jh@suse.cz>\n+\n+\t* cfg.c (update_bb_profile_for_threading): More diagnostic.\n+\t* tree-ssa-threadupdate.c (redirect_edges): Update profile of dup_block.\n+\n 2005-07-15  Richard Guenther  <rguenther@suse.de>\n \n \t* c-common.c (handle_flatten_attribute): New function."}, {"sha": "6aeb79417f992b323725ceacafd45b2294b70a79", "filename": "gcc/cfg.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b151cb23b672323fea91892fcb1d2f41c410e78/gcc%2Fcfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b151cb23b672323fea91892fcb1d2f41c410e78/gcc%2Fcfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfg.c?ref=2b151cb23b672323fea91892fcb1d2f41c410e78", "patch": "@@ -850,7 +850,12 @@ update_bb_profile_for_threading (basic_block bb, int edge_frequency,\n \n   bb->count -= count;\n   if (bb->count < 0)\n-    bb->count = 0;\n+    {\n+      if (dump_file)\n+\tfprintf (dump_file, \"bb %i count became negative after threading\",\n+\t\t bb->index);\n+      bb->count = 0;\n+    }\n \n   /* Compute the probability of TAKEN_EDGE being reached via threaded edge.\n      Watch for overflows.  */\n@@ -897,7 +902,12 @@ update_bb_profile_for_threading (basic_block bb, int edge_frequency,\n   gcc_assert (bb == taken_edge->src);\n   taken_edge->count -= count;\n   if (taken_edge->count < 0)\n-    taken_edge->count = 0;\n+    {\n+      if (dump_file)\n+\tfprintf (dump_file, \"edge %i->%i count became negative after threading\",\n+\t\t taken_edge->src->index, taken_edge->dest->index);\n+      taken_edge->count = 0;\n+    }\n }\n \n /* Multiply all frequencies of basic blocks in array BBS of length NBBS"}, {"sha": "6181b27978d65a4dd31a3fb3191c0c1e0f765bda", "filename": "gcc/tree-ssa-threadupdate.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b151cb23b672323fea91892fcb1d2f41c410e78/gcc%2Ftree-ssa-threadupdate.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b151cb23b672323fea91892fcb1d2f41c410e78/gcc%2Ftree-ssa-threadupdate.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-threadupdate.c?ref=2b151cb23b672323fea91892fcb1d2f41c410e78", "patch": "@@ -609,6 +609,9 @@ redirect_edges (void **slot, void *data)\n \t    fprintf (dump_file, \"  Threaded jump %d --> %d to %d\\n\",\n \t\t     e->src->index, e->dest->index, rd->dup_block->index);\n \n+\t  rd->dup_block->count += e->count;\n+\t  rd->dup_block->frequency += EDGE_FREQUENCY (e);\n+\t  EDGE_SUCC (rd->dup_block, 0)->count += e->count;\n \t  /* Redirect the incoming edge to the appropriate duplicate\n \t     block.  */\n \t  e2 = redirect_edge_and_branch (e, rd->dup_block);"}]}