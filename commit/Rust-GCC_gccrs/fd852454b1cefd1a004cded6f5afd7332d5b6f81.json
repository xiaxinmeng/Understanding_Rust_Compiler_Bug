{"sha": "fd852454b1cefd1a004cded6f5afd7332d5b6f81", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmQ4NTI0NTRiMWNlZmQxYTAwNGNkZWQ2ZjVhZmQ3MzMyZDViNmY4MQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2002-06-17T00:26:56Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2002-06-17T00:26:56Z"}, "message": "tree.c (cp_cannot_inline_tree_fn): Don't short-circuit test after template instantiation.\n\n        * tree.c (cp_cannot_inline_tree_fn): Don't short-circuit test\n        after template instantiation.\n\t* g++.dg/opt/inline3.C: New.\n\nFrom-SVN: r54687", "tree": {"sha": "1c5ffe3dd3729a28523054a576d21e351f49d116", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c5ffe3dd3729a28523054a576d21e351f49d116"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fd852454b1cefd1a004cded6f5afd7332d5b6f81", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd852454b1cefd1a004cded6f5afd7332d5b6f81", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fd852454b1cefd1a004cded6f5afd7332d5b6f81", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd852454b1cefd1a004cded6f5afd7332d5b6f81/comments", "author": null, "committer": null, "parents": [{"sha": "9d321f6caade85a66c564aa35213fa2739370f54", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d321f6caade85a66c564aa35213fa2739370f54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9d321f6caade85a66c564aa35213fa2739370f54"}], "stats": {"total": 49, "additions": 48, "deletions": 1}, "files": [{"sha": "4da4bd4b779dea52ff4bab915ff2551c470ded7e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd852454b1cefd1a004cded6f5afd7332d5b6f81/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd852454b1cefd1a004cded6f5afd7332d5b6f81/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=fd852454b1cefd1a004cded6f5afd7332d5b6f81", "patch": "@@ -1,3 +1,9 @@\n+2002-06-16  Richard Henderson  <rth@redhat.com>\n+\n+\tPR opt/6793\n+\t* tree.c (cp_cannot_inline_tree_fn): Don't short-circuit test\n+\tafter template instantiation.\n+\n 2002-06-16  Richard Henderson  <rth@redhat.com>\n \n \t* cp-tree.h, decl2.c (flag_ms_extensions): Move to c-common."}, {"sha": "9c146960b0811949fba8797ee04c393f40711733", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd852454b1cefd1a004cded6f5afd7332d5b6f81/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd852454b1cefd1a004cded6f5afd7332d5b6f81/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=fd852454b1cefd1a004cded6f5afd7332d5b6f81", "patch": "@@ -2162,7 +2162,8 @@ cp_cannot_inline_tree_fn (fnp)\n       && TI_PENDING_TEMPLATE_FLAG (DECL_TEMPLATE_INFO (fn)))\n     {\n       fn = *fnp = instantiate_decl (fn, /*defer_ok=*/0);\n-      return TI_PENDING_TEMPLATE_FLAG (DECL_TEMPLATE_INFO (fn));\n+      if (TI_PENDING_TEMPLATE_FLAG (DECL_TEMPLATE_INFO (fn)))\n+\treturn 1;\n     }\n \n   if (varargs_function_p (fn))"}, {"sha": "7199de09c0ab96a30bfac469765918501166d773", "filename": "gcc/testsuite/g++.dg/opt/inline3.C", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd852454b1cefd1a004cded6f5afd7332d5b6f81/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Finline3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd852454b1cefd1a004cded6f5afd7332d5b6f81/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Finline3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Finline3.C?ref=fd852454b1cefd1a004cded6f5afd7332d5b6f81", "patch": "@@ -0,0 +1,40 @@\n+// PR opt/6793\n+// We failed to supress inlining of a varargs function when it's a template.\n+// { dg-do compile }\n+// { dg-options \"-O3\" }\n+\n+#include <stdarg.h>\n+\n+typedef __SIZE_TYPE__ size_t;\n+\n+template < class Type > class VectorNd\n+{\n+  size_t size;\n+  Type *data;\n+ public:\n+\n+  VectorNd (size_t _size, size_t count, ...)\n+\t: size (_size)\n+  {\n+    data = new Type[size];\n+\n+    va_list ap;\n+\n+    va_start (ap, count);\n+\n+    for (size_t i = 0; i < count; i++)\n+      data[i] = va_arg (ap, Type);\n+\n+    va_end (ap);\n+  }\n+\n+  ~VectorNd ()\n+  {\n+    delete [] data;\n+  }\n+};\n+\n+int main ()\n+{\n+  VectorNd <double> vector (3, 3, 1.0, 2.0, 3.0);\n+}"}]}