{"sha": "e08835fd3a4a6559b79c26db9b18df0e838d943e", "node_id": "C_kwDOANBUbNoAKGUwODgzNWZkM2E0YTY1NTliNzljMjZkYjliMThkZjBlODM4ZDk0M2U", "commit": {"author": {"name": "YunQiang Su", "email": "yunqiang.su@cipunited.com", "date": "2023-01-06T10:28:22Z"}, "committer": {"name": "YunQiang Su", "email": "yunqiang.su@cipunited.com", "date": "2023-01-31T02:00:44Z"}, "message": "libsanitizer/mips: always build with largefile support\n\n-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 is always used for mips\nwhen build libsanitizer in LLVM. Thus\n   FIRST_32_SECOND_64((_MIPS_SIM == _ABIN32) ? 176 : 160, 216);\ninstead of\n   FIRST_32_SECOND_64((_MIPS_SIM == _ABIN32) ? 160 : 144, 216);\nin sanitizer_platform_limits_posix.h.\n\nTo keep sync with LLVM and to make the code simple, we use the\nlargefile options always.\n\nlibsanitizer/\n\t* configure.ac: set -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64\n\talways for mips*.\n\t* configure: Regenerate.", "tree": {"sha": "6aa1d97920f72ea689acf6cf9cbd3c32df0bc950", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6aa1d97920f72ea689acf6cf9cbd3c32df0bc950"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e08835fd3a4a6559b79c26db9b18df0e838d943e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e08835fd3a4a6559b79c26db9b18df0e838d943e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e08835fd3a4a6559b79c26db9b18df0e838d943e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e08835fd3a4a6559b79c26db9b18df0e838d943e/comments", "author": null, "committer": null, "parents": [{"sha": "897a0502056e6cc6613f26e0b22d1c1e06b1490f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/897a0502056e6cc6613f26e0b22d1c1e06b1490f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/897a0502056e6cc6613f26e0b22d1c1e06b1490f"}], "stats": {"total": 25, "additions": 20, "deletions": 5}, "files": [{"sha": "d4ee0fac3e767a7f25be749262387c67eac21f6c", "filename": "libsanitizer/configure", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e08835fd3a4a6559b79c26db9b18df0e838d943e/libsanitizer%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e08835fd3a4a6559b79c26db9b18df0e838d943e/libsanitizer%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2Fconfigure?ref=e08835fd3a4a6559b79c26db9b18df0e838d943e", "patch": "@@ -17045,9 +17045,16 @@ else\n $as_echo \"no\" >&6; }\n fi\n \n-EXTRA_CFLAGS=\"$EXTRA_CFLAGS $CET_FLAGS\"\n-EXTRA_CXXFLAGS=\"$EXTRA_CXXFLAGS $CET_FLAGS\"\n-EXTRA_ASFLAGS=$CET_FLAGS\n+# Always set -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 to sync with LLVM,\n+# and keep struct *stat* have the same size.\n+case \"${host}\" in\n+  mips*-*) FILE64_FLAGS=\"-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64\" ;;\n+  *) FILE64_FLAGS=\"\" ;;\n+esac\n+\n+EXTRA_CFLAGS=\"$EXTRA_CFLAGS $CET_FLAGS $FILE64_FLAGS\"\n+EXTRA_CXXFLAGS=\"$EXTRA_CXXFLAGS $CET_FLAGS $FILE64_FLAGS\"\n+EXTRA_ASFLAGS=\"$CET_FLAGS $FILE64_FLAGS\"\n \n \n "}, {"sha": "04cd8910ed654a751c276963a3ca3657ea4b3f92", "filename": "libsanitizer/configure.ac", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e08835fd3a4a6559b79c26db9b18df0e838d943e/libsanitizer%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e08835fd3a4a6559b79c26db9b18df0e838d943e/libsanitizer%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2Fconfigure.ac?ref=e08835fd3a4a6559b79c26db9b18df0e838d943e", "patch": "@@ -416,8 +416,16 @@ GCC_BASE_VER\n \n # Add CET specific flags if Intel CET is enabled.\n GCC_CET_FLAGS(CET_FLAGS)\n-EXTRA_CFLAGS=\"$EXTRA_CFLAGS $CET_FLAGS\"\n-EXTRA_CXXFLAGS=\"$EXTRA_CXXFLAGS $CET_FLAGS\"\n+\n+# Always set -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 to sync with LLVM,\n+# and keep struct *stat* have the same size.\n+case \"${host}\" in\n+  mips*-*) FILE64_FLAGS=\"-D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64\" ;;\n+  *) FILE64_FLAGS=\"\" ;;\n+esac\n+\n+EXTRA_CFLAGS=\"$EXTRA_CFLAGS $CET_FLAGS $FILE64_FLAGS\"\n+EXTRA_CXXFLAGS=\"$EXTRA_CXXFLAGS $CET_FLAGS $FILE64_FLAGS\"\n EXTRA_ASFLAGS=$CET_FLAGS\n AC_SUBST(EXTRA_ASFLAGS)\n AC_SUBST(EXTRA_CFLAGS)"}]}