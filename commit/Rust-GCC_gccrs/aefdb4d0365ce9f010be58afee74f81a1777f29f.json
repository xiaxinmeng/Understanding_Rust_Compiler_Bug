{"sha": "aefdb4d0365ce9f010be58afee74f81a1777f29f", "node_id": "C_kwDOANBUbNoAKGFlZmRiNGQwMzY1Y2U5ZjAxMGJlNThhZmVlNzRmODFhMTc3N2YyOWY", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2021-10-25T13:26:21Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2021-10-25T13:26:21Z"}, "message": "Merge #767\n\n767: gccrs: StructExprStructFields: remove `iterate` method r=philberty a=mathstuf\n\nThis provides a getter for the set of fields in a struct expression\r\nrather than a visitor with a callback which is more complicated for\r\ncallers, especially static analysis.\r\n\r\nSigned-off-by: Ben Boeckel <mathstuf@gmail.com>\r\n\r\nFixes: #721\r\n\n\nCo-authored-by: Ben Boeckel <mathstuf@gmail.com>", "tree": {"sha": "2559822b214026dff3e706f80bec551bfde33e6c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2559822b214026dff3e706f80bec551bfde33e6c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aefdb4d0365ce9f010be58afee74f81a1777f29f", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJhdrB9CRBK7hj4Ov3rIwAAjmAIADjle4+iimdKhHrEEeQPxp2k\nKAXm1wT5u/+ff+U9qL/nVTwoWf/w6ZxEEpknhyRQbt7MQi8IpRfESkhP04libN2Y\nkCY21E0H0F9RGkQFMtOAXS3V2/Qbq8n1g0alNjn+6GfJxPPZt+aBE3b4a2HIqIy9\n+5IIBrTdADI8AgTlrNYtz4LDlSL+dKeNBkQVjGedvxdRMEzZ62dLHnHF9THnrSsF\nZblrHRwu8dQBtQhvUXXLtGJwRyFim6E+aYyoEznpALVUJxns4IJhANh5m/KSblAs\ncDugUE+Ds+3V8BUURBj4B1YGeLYWJUg8bLJYgtLxiTRAgtalmhMIXRc7tM8h8Cc=\n=/OKQ\n-----END PGP SIGNATURE-----\n", "payload": "tree 2559822b214026dff3e706f80bec551bfde33e6c\nparent 868d3125d326a6800376411fb6699d984cfa7101\nparent 1d3a36276a07a7472ed39499a2c9ddce37146d93\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1635168381 +0000\ncommitter GitHub <noreply@github.com> 1635168381 +0000\n\nMerge #767\n\n767: gccrs: StructExprStructFields: remove `iterate` method r=philberty a=mathstuf\n\nThis provides a getter for the set of fields in a struct expression\r\nrather than a visitor with a callback which is more complicated for\r\ncallers, especially static analysis.\r\n\r\nSigned-off-by: Ben Boeckel <mathstuf@gmail.com>\r\n\r\nFixes: #721\r\n\n\nCo-authored-by: Ben Boeckel <mathstuf@gmail.com>\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aefdb4d0365ce9f010be58afee74f81a1777f29f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aefdb4d0365ce9f010be58afee74f81a1777f29f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aefdb4d0365ce9f010be58afee74f81a1777f29f/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "868d3125d326a6800376411fb6699d984cfa7101", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/868d3125d326a6800376411fb6699d984cfa7101", "html_url": "https://github.com/Rust-GCC/gccrs/commit/868d3125d326a6800376411fb6699d984cfa7101"}, {"sha": "1d3a36276a07a7472ed39499a2c9ddce37146d93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d3a36276a07a7472ed39499a2c9ddce37146d93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d3a36276a07a7472ed39499a2c9ddce37146d93"}], "stats": {"total": 33, "additions": 13, "deletions": 20}, "files": [{"sha": "0d3c50e25ab8e7b711e3eaf542763e9a1731edf8", "filename": "gcc/rust/ast/rust-expr.h", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aefdb4d0365ce9f010be58afee74f81a1777f29f/gcc%2Frust%2Fast%2Frust-expr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aefdb4d0365ce9f010be58afee74f81a1777f29f/gcc%2Frust%2Fast%2Frust-expr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fast%2Frust-expr.h?ref=aefdb4d0365ce9f010be58afee74f81a1777f29f", "patch": "@@ -1799,15 +1799,6 @@ class StructExprStructFields : public StructExprStruct\n     return fields;\n   }\n \n-  void iterate (std::function<bool (StructExprField *)> cb)\n-  {\n-    for (auto &field : fields)\n-      {\n-\tif (!cb (field.get ()))\n-\t  return;\n-      }\n-  }\n-\n   StructBase &get_struct_base () { return struct_base; }\n   const StructBase &get_struct_base () const { return struct_base; }\n "}, {"sha": "782045d41dc560f80893c6e1eaf642a0c5d540f8", "filename": "gcc/rust/hir/rust-ast-lower-expr.h", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aefdb4d0365ce9f010be58afee74f81a1777f29f/gcc%2Frust%2Fhir%2Frust-ast-lower-expr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aefdb4d0365ce9f010be58afee74f81a1777f29f/gcc%2Frust%2Fhir%2Frust-ast-lower-expr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fhir%2Frust-ast-lower-expr.h?ref=aefdb4d0365ce9f010be58afee74f81a1777f29f", "patch": "@@ -546,13 +546,14 @@ class ASTLoweringExpr : public ASTLoweringBase\n \t  = new HIR::StructBase (std::unique_ptr<HIR::Expr> (translated_base));\n       }\n \n+    auto const &in_fields = struct_expr.get_fields ();\n     std::vector<std::unique_ptr<HIR::StructExprField> > fields;\n-    struct_expr.iterate ([&] (AST::StructExprField *field) mutable -> bool {\n-      HIR::StructExprField *translated\n-\t= ASTLowerStructExprField::translate (field);\n-      fields.push_back (std::unique_ptr<HIR::StructExprField> (translated));\n-      return true;\n-    });\n+    for (auto &field : in_fields)\n+      {\n+\tHIR::StructExprField *translated\n+\t  = ASTLowerStructExprField::translate (field.get ());\n+\tfields.push_back (std::unique_ptr<HIR::StructExprField> (translated));\n+      }\n \n     auto crate_num = mappings->get_current_crate ();\n     Analysis::NodeMapping mapping (crate_num, struct_expr.get_node_id (),"}, {"sha": "48906f5dbe19d160eb8dfd8329d7a0955a6e2fd9", "filename": "gcc/rust/resolve/rust-ast-resolve-expr.h", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aefdb4d0365ce9f010be58afee74f81a1777f29f/gcc%2Frust%2Fresolve%2Frust-ast-resolve-expr.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aefdb4d0365ce9f010be58afee74f81a1777f29f/gcc%2Frust%2Fresolve%2Frust-ast-resolve-expr.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fresolve%2Frust-ast-resolve-expr.h?ref=aefdb4d0365ce9f010be58afee74f81a1777f29f", "patch": "@@ -269,11 +269,12 @@ class ResolveExpr : public ResolverBase\n \t\t\t struct_expr.get_node_id ());\n       }\n \n-    struct_expr.iterate (\n-      [&] (AST::StructExprField *struct_field) mutable -> bool {\n-\tResolveStructExprField::go (struct_field, struct_expr.get_node_id ());\n-\treturn true;\n-      });\n+    auto const &struct_fields = struct_expr.get_fields ();\n+    for (auto &struct_field : struct_fields)\n+      {\n+\tResolveStructExprField::go (struct_field.get (),\n+\t\t\t\t    struct_expr.get_node_id ());\n+      }\n   }\n \n   void visit (AST::GroupedExpr &expr) override"}]}