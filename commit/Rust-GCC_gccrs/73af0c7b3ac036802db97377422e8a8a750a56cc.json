{"sha": "73af0c7b3ac036802db97377422e8a8a750a56cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzNhZjBjN2IzYWMwMzY4MDJkYjk3Mzc3NDIyZThhOGE3NTBhNTZjYw==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2019-11-24T22:14:59Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2019-11-24T22:14:59Z"}, "message": "re PR libfortran/92100 (Formatted stream IO irreproducible read with binary data in file)\n\n2019-11-24  Jerry DeLisle  <jvdelisle@gcc.ngu.org>\n\n\tPR fortran/92100\n\tio/transfer.c (data_transfer_init_worker): Use fbuf_reset\n\tinstead of fbuf_flush before the seek. Note that fbuf_reset\n\tcalls fbuf_flush and adjusts fbuf pointers.\n\nFrom-SVN: r278660", "tree": {"sha": "743a8c4630626b7b2f49c2bd5ad523adf2c83550", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/743a8c4630626b7b2f49c2bd5ad523adf2c83550"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73af0c7b3ac036802db97377422e8a8a750a56cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73af0c7b3ac036802db97377422e8a8a750a56cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73af0c7b3ac036802db97377422e8a8a750a56cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73af0c7b3ac036802db97377422e8a8a750a56cc/comments", "author": null, "committer": null, "parents": [{"sha": "859174c82493971bd1e408231e24a7724953042f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/859174c82493971bd1e408231e24a7724953042f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/859174c82493971bd1e408231e24a7724953042f"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "91768c0a00f16f72b8b5a68a7e08633f3d7c7e0b", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73af0c7b3ac036802db97377422e8a8a750a56cc/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73af0c7b3ac036802db97377422e8a8a750a56cc/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=73af0c7b3ac036802db97377422e8a8a750a56cc", "patch": "@@ -1,3 +1,10 @@\n+2019-11-24  Jerry DeLisle  <jvdelisle@gcc.ngu.org>\n+\n+\tPR fortran/92100\n+\tio/transfer.c (data_transfer_init_worker): Use fbuf_reset\n+\tinstead of fbuf_flush before the seek. Note that fbuf_reset\n+\tcalls fbuf_flush and adjusts fbuf pointers.\n+\n 2019-11-23  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \tHarald Anlauf <anlauf@gmx.de>\n "}, {"sha": "43b22bf5f8da5440833e1780160b3d5ec659d2a8", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73af0c7b3ac036802db97377422e8a8a750a56cc/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73af0c7b3ac036802db97377422e8a8a750a56cc/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=73af0c7b3ac036802db97377422e8a8a750a56cc", "patch": "@@ -3309,8 +3309,9 @@ data_transfer_init_worker (st_parameter_dt *dtp, int read_flag)\n \n           if (dtp->pos != dtp->u.p.current_unit->strm_pos)\n             {\n-              fbuf_flush (dtp->u.p.current_unit, dtp->u.p.mode);\n-              if (sseek (dtp->u.p.current_unit->s, dtp->pos - 1, SEEK_SET) < 0)\n+\t      fbuf_reset (dtp->u.p.current_unit);\n+\t      if (sseek (dtp->u.p.current_unit->s, dtp->pos - 1,\n+\t\t\t SEEK_SET) < 0)\n                 {\n                   generate_error (&dtp->common, LIBERROR_OS, NULL);\n                   return;"}]}