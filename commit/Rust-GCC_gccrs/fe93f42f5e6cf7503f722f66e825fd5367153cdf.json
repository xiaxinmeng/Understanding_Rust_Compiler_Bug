{"sha": "fe93f42f5e6cf7503f722f66e825fd5367153cdf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmU5M2Y0MmY1ZTZjZjc1MDNmNzIyZjY2ZTgyNWZkNTM2NzE1M2NkZg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2005-06-16T08:21:00Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2005-06-16T08:21:00Z"}, "message": "rtti.c (get_tinfo_decl): Avoid caching tinfo_descs when it might change.\n\ncp:\n\t* rtti.c (get_tinfo_decl): Avoid caching tinfo_descs when it might\n\tchange.\n\t(create_pseudo_type_info): First parameter is an int.\ntestsuite:\n\t* g++.dg/rtti/crash2.C: New.\n\nFrom-SVN: r101011", "tree": {"sha": "45ac8abe456ab808e94f317301eb28db35d93232", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/45ac8abe456ab808e94f317301eb28db35d93232"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fe93f42f5e6cf7503f722f66e825fd5367153cdf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe93f42f5e6cf7503f722f66e825fd5367153cdf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe93f42f5e6cf7503f722f66e825fd5367153cdf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe93f42f5e6cf7503f722f66e825fd5367153cdf/comments", "author": null, "committer": null, "parents": [{"sha": "3d5a109a9cf5479d273c81b632d2041950ef0f1b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d5a109a9cf5479d273c81b632d2041950ef0f1b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d5a109a9cf5479d273c81b632d2041950ef0f1b"}], "stats": {"total": 27, "additions": 23, "deletions": 4}, "files": [{"sha": "af04741fc44ce41d2f802cdb9a7998770f1f3fb3", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=fe93f42f5e6cf7503f722f66e825fd5367153cdf", "patch": "@@ -1,3 +1,9 @@\n+2005-06-16  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* rtti.c (get_tinfo_decl): Avoid caching tinfo_descs when it might\n+\tchange.\n+\t(create_pseudo_type_info): First parameter is an int.\n+\n 2005-06-15  Aldy Hernandez  <aldyh@redhat.com>\n \n \t* typeck.c (build_binary_op): Same."}, {"sha": "c9f3d38f6c8676ea96e165d2a94a42695491a929", "filename": "gcc/cp/rtti.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Fcp%2Frtti.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Fcp%2Frtti.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Frtti.c?ref=fe93f42f5e6cf7503f722f66e825fd5367153cdf", "patch": "@@ -117,7 +117,7 @@ static tree generic_initializer (tinfo_s *, tree);\n static tree ptr_initializer (tinfo_s *, tree);\n static tree ptm_initializer (tinfo_s *, tree);\n static tree class_initializer (tinfo_s *, tree, tree);\n-static void create_pseudo_type_info (tinfo_kind, const char *, ...);\n+static void create_pseudo_type_info (int, const char *, ...);\n static tree get_pseudo_ti_init (tree, unsigned);\n static unsigned get_pseudo_ti_index (tree);\n static void create_tinfo_types (void);\n@@ -369,8 +369,8 @@ get_tinfo_decl (tree type)\n   d = IDENTIFIER_GLOBAL_VALUE (name);\n   if (!d)\n     {\n-      tinfo_s *ti = VEC_index (tinfo_s, tinfo_descs,\n-\t\t\t       get_pseudo_ti_index (type));\n+      int ix = get_pseudo_ti_index (type);\n+      tinfo_s *ti = VEC_index (tinfo_s, tinfo_descs, ix);\n \n       d = build_lang_decl (VAR_DECL, name, ti->type);\n       SET_DECL_ASSEMBLER_NAME (d, name);\n@@ -1100,7 +1100,7 @@ get_pseudo_ti_init (tree type, unsigned tk_index)\n    NULL.  */\n \n static void\n-create_pseudo_type_info (tinfo_kind tk, const char *real_name, ...)\n+create_pseudo_type_info (int tk, const char *real_name, ...)\n {\n   tinfo_s *ti;\n   tree pseudo_type;"}, {"sha": "34f4fe50d3704ea7a9a19f286b36bd91b29c2949", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fe93f42f5e6cf7503f722f66e825fd5367153cdf", "patch": "@@ -1,3 +1,7 @@\n+2005-06-16  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.dg/rtti/crash2.C: New.\n+\n 2005-06-15  Joseph S. Myers  <joseph@codesourcery.com>\n \n \t* gcc.dg/noncompile/20040203-3.c: Update expected message."}, {"sha": "9646dfdc1c97f01f3b132ebfc772ada388ec3b8f", "filename": "gcc/testsuite/g++.dg/rtti/crash2.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fcrash2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe93f42f5e6cf7503f722f66e825fd5367153cdf/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fcrash2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fcrash2.C?ref=fe93f42f5e6cf7503f722f66e825fd5367153cdf", "patch": "@@ -0,0 +1,9 @@\n+// Copyright (C) 2005 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 16 Jun 2005 <nathan@codesourcery.com>\n+\n+// Crash when compiler is optimized\n+// Origin:  Andrew Pinski pinskia@gcc.gnu.org\n+\n+struct facet { virtual ~facet(); };\n+struct ctype_base {};\n+struct ctype : facet, ctype_base {};"}]}