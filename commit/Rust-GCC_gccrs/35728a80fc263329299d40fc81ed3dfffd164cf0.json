{"sha": "35728a80fc263329299d40fc81ed3dfffd164cf0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzU3MjhhODBmYzI2MzMyOTI5OWQ0MGZjODFlZDNkZmZmZDE2NGNmMA==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2000-11-17T10:24:05Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2000-11-17T10:24:05Z"}, "message": "pt.c (tsubst_expr, DECL_STMT): Instantiate decl's type.\n\ncp:\n\t* pt.c (tsubst_expr, DECL_STMT): Instantiate decl's type.\n\ntestsuite:\n\t* g++.old-deja/g++.pt/instantiate8.C: New test.\n\nFrom-SVN: r37518", "tree": {"sha": "4855606a5930e0061f5125564877ab956b83e0a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4855606a5930e0061f5125564877ab956b83e0a8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35728a80fc263329299d40fc81ed3dfffd164cf0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35728a80fc263329299d40fc81ed3dfffd164cf0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35728a80fc263329299d40fc81ed3dfffd164cf0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35728a80fc263329299d40fc81ed3dfffd164cf0/comments", "author": null, "committer": null, "parents": [{"sha": "5cce22b6c2bfebd556b36a9c89d1bdf3eee900ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5cce22b6c2bfebd556b36a9c89d1bdf3eee900ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5cce22b6c2bfebd556b36a9c89d1bdf3eee900ae"}], "stats": {"total": 51, "additions": 51, "deletions": 0}, "files": [{"sha": "63f97f4219900c990ad91a8a2e8aebf31e1bd841", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=35728a80fc263329299d40fc81ed3dfffd164cf0", "patch": "@@ -1,3 +1,7 @@\n+2000-11-17  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* pt.c (tsubst_expr, DECL_STMT): Instantiate decl's type.\n+\n 2000-11-17  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* cp-tree.h (PARMLIST_ELLIPSIS_P): New macro."}, {"sha": "c281636286f51df78785b97faf6689102c0002c1", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=35728a80fc263329299d40fc81ed3dfffd164cf0", "patch": "@@ -7150,6 +7150,9 @@ tsubst_expr (t, args, complain, in_decl)\n \t    init = tsubst_expr (init, args, complain, in_decl);\n \t    if (decl != error_mark_node)\n \t      {\n+                if (TREE_CODE (decl) != TYPE_DECL)\n+                  /* Make sure the type is instantiated now. */\n+                  complete_type (type);\n \t        if (init)\n \t          DECL_INITIAL (decl) = error_mark_node;\n \t        /* By marking the declaration as instantiated, we avoid"}, {"sha": "382b5196762bb07044b0eb2eec9c4fe1da4ea16e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=35728a80fc263329299d40fc81ed3dfffd164cf0", "patch": "@@ -1,3 +1,7 @@\n+2000-11-17  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.old-deja/g++.pt/instantiate8.C: New test.\n+\n 2000-11-17  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* g++.old-deja/g++.other/incomplete.C: Add more tests."}, {"sha": "beffa02477fe6b3e2080b4a8c7df94a694eecd1c", "filename": "gcc/testsuite/g++.old-deja/g++.pt/instantiate8.C", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finstantiate8.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35728a80fc263329299d40fc81ed3dfffd164cf0/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finstantiate8.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finstantiate8.C?ref=35728a80fc263329299d40fc81ed3dfffd164cf0", "patch": "@@ -0,0 +1,40 @@\n+// Build don't link:\n+// Copyright (C) 2000 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 14 Nov 2000 <nathan@codesourcery.com>\n+\n+// bug 616. We failed to complete the type of decls in templates, leading to\n+// bogus errors.\n+\n+struct Z;\n+struct Y\n+{\n+  Y (int i = 1);\n+};\n+void g ()\n+{\n+  const Y y;\n+  Z z;          // ERROR - incomplete\n+}\n+\n+template <int dim>\n+struct X\n+{\n+  X (int i=1);\n+};\n+\n+void h ()\n+{\n+  const X<2> z;\n+  Z z1;         // ERROR - incomplete\n+}\n+\n+template <int dim>\n+void f()\n+{\n+  const X<dim> x;\n+  const X<dim+1> y[3];\n+  Z z2;           // ERROR - incomplete\n+  typedef Z z3;   // ok\n+};\n+\n+template void f<3> ();"}]}