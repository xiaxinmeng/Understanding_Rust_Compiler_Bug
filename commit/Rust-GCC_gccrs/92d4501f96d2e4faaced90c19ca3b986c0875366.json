{"sha": "92d4501f96d2e4faaced90c19ca3b986c0875366", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTJkNDUwMWY5NmQyZTRmYWFjZWQ5MGMxOWNhM2I5ODZjMDg3NTM2Ng==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1998-05-13T14:04:15Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1998-05-13T14:04:15Z"}, "message": "Patch to fix g++.other/local1.C.\n\n\t* varasm.c (make_decl_rtl): Revert April 1 change.\n\t* alpha/alpha.h, alpha/win-nt.h, arm/arm.h, i386/unix.h, i960/i960.h,\n\tm68k/linux.h, pa/pa.h, sparc/sparc.h, vax/vax.h (ASM_OUTPUT_MI_THUNK):\n\tGet function name from the SYMBOL_REF in the DECL_RTL, not from\n\tDECL_ASSEMBLER_NAME.\n\t* i386/winnt.c (gen_stdcall_suffix): Comment for questionable use of\n\tDECL_ASSEMBLER_NAME.\n\nFrom-SVN: r19723", "tree": {"sha": "840abe7eaa9ab57ad418f30aac580be8cbd04489", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/840abe7eaa9ab57ad418f30aac580be8cbd04489"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/92d4501f96d2e4faaced90c19ca3b986c0875366", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92d4501f96d2e4faaced90c19ca3b986c0875366", "html_url": "https://github.com/Rust-GCC/gccrs/commit/92d4501f96d2e4faaced90c19ca3b986c0875366", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92d4501f96d2e4faaced90c19ca3b986c0875366/comments", "author": null, "committer": null, "parents": [{"sha": "d6cc54f65926f5b8464efad260be16eddec94315", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6cc54f65926f5b8464efad260be16eddec94315", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6cc54f65926f5b8464efad260be16eddec94315"}], "stats": {"total": 61, "additions": 26, "deletions": 35}, "files": [{"sha": "8c5120380313a3896ff06578dbc3cea75597f474", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -1,3 +1,13 @@\n+1998-05-13  Jim Wilson  <wilson@cygnus.com>\n+\n+\t* varasm.c (make_decl_rtl): Revert April 1 change.\n+\t* alpha/alpha.h, alpha/win-nt.h, arm/arm.h, i386/unix.h, i960/i960.h,\n+\tm68k/linux.h, pa/pa.h, sparc/sparc.h, vax/vax.h (ASM_OUTPUT_MI_THUNK):\n+\tGet function name from the SYMBOL_REF in the DECL_RTL, not from\n+\tDECL_ASSEMBLER_NAME.\n+\t* i386/winnt.c (gen_stdcall_suffix): Comment for questionable use of\n+\tDECL_ASSEMBLER_NAME.\n+\n Wed May 13 13:09:19 1998  Jim Wilson  <wilson@cygnus.com>\n \n \t* i386.c (notice_update_cc, output_float_compare): Disable"}, {"sha": "b9a44d20a99680b42c485d424cdada34c059d28b", "filename": "gcc/config/alpha/alpha.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Falpha%2Falpha.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Falpha%2Falpha.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Falpha%2Falpha.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -2121,7 +2121,7 @@ literal_section ()\t\t\t\t\t\t\\\n \n #define ASM_OUTPUT_MI_THUNK(FILE, THUNK_FNDECL, DELTA, FUNCTION)\t\\\n do {\t\t\t\t\t\t\t\t\t\\\n-  char *fn_name = IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION));\t\\\n+  char *fn_name = XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0);\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n   fprintf (FILE, \"\\t.ent \");\t\t\t\t\t\t\\\n   assemble_name (FILE, alpha_function_name);\t\t\t\t\\"}, {"sha": "ca35925c0585a377e0f2c5fc884183840e00d07f", "filename": "gcc/config/alpha/win-nt.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Falpha%2Fwin-nt.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Falpha%2Fwin-nt.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Falpha%2Fwin-nt.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -139,7 +139,7 @@ Boston, MA 02111-1307, USA.  */\n #undef ASM_OUTPUT_MI_THUNK\n #define ASM_OUTPUT_MI_THUNK(FILE, THUNK_FNDECL, DELTA, FUNCTION)\t\\\n do {\t\t\t\t\t\t\t\t\t\\\n-  char *fn_name = IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION));\t\\\n+  char *fn_name = XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0);\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n   fprintf (FILE, \"\\t.ent \");\t\t\t\t\t\t\\\n   assemble_name (FILE, alpha_function_name);\t\t\t\t\\"}, {"sha": "8f4cb2021adae9c17a2dffd545c47405d18f609b", "filename": "gcc/config/arm/arm.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Farm%2Farm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Farm%2Farm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -1982,8 +1982,7 @@ do {\t\t\t\t\t\t\t\t\t\\\n \t}\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   fputs (\"\\tb\\t\", FILE);\t\t\t\t\t\t\\\n-  assemble_name (FILE,\t\t\t\t\t\t\t\\\n-\t\t IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+  assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n   fputc ('\\n', FILE);\t\t\t\t\t\t\t\\\n } while (0)\n "}, {"sha": "47440ddd943df4aea685a7915218517d0c27b1ac", "filename": "gcc/config/i386/unix.h", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fi386%2Funix.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fi386%2Funix.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Funix.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -179,15 +179,13 @@ do {\t\t\t\t\t\t\t\t\t      \\\n       output_asm_insn (AS1 (pop%L0,%0), xops);\t\t\t\t      \\\n       output_asm_insn (\"addl $_GLOBAL_OFFSET_TABLE_+[.-%P1],%0\", xops);\t      \\\n       fprintf (FILE, \"\\tmovl \");\t\t\t\t\t      \\\n-      assemble_name\t\t\t\t\t\t\t      \\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t      \\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t      \\\n       fprintf (FILE, \"@GOT(%%ebx),%%ecx\\n\\tpopl %%ebx\\n\\tjmp *%%ecx\\n\");      \\\n     }\t\t\t\t\t\t\t\t\t      \\\n   else\t\t\t\t\t\t\t\t\t      \\\n     {\t\t\t\t\t\t\t\t\t      \\\n       fprintf (FILE, \"\\tjmp \");\t\t\t\t\t\t      \\\n-      assemble_name\t\t\t\t\t\t\t      \\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t      \\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t      \\\n       fprintf (FILE, \"\\n\");\t\t\t\t\t\t      \\\n     }\t\t\t\t\t\t\t\t\t      \\\n } while (0)"}, {"sha": "bb663cec6c7f779f759aa052c50e496ee35f783e", "filename": "gcc/config/i386/winnt.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fi386%2Fwinnt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fi386%2Fwinnt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fwinnt.c?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -37,6 +37,8 @@ gen_stdcall_suffix (decl)\n   tree decl;\n {\n   int total = 0;\n+  /* ??? This probably should use XSTR (XEXP (DECL_RTL (decl), 0), 0) instead\n+     of DECL_ASSEMBLER_NAME.  */\n   char *asmname = IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (decl));\n   char *newsym;\n "}, {"sha": "27967f09a6505d1d18916cb473636d4b94d09bc3", "filename": "gcc/config/i960/i960.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fi960%2Fi960.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fi960%2Fi960.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi960%2Fi960.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -1568,7 +1568,6 @@ do {\t\t\t\t\t\t\t\t\t\\\n       fprintf (FILE, \"\\taddo r5,g0,g0\\n\");\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   fprintf (FILE, \"\\tbx \");\t\t\t\t\t\t\\\n-  assemble_name\t\t\t\t\t\t\t\t\\\n-    (FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+  assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n   fprintf (FILE, \"\\n\");\t\t\t\t\t\t\t\\\n } while (0);"}, {"sha": "0df0bd8e575493738b63e0d9f1504dd130178c69", "filename": "gcc/config/m68k/linux.h", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fm68k%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fm68k%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Flinux.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -375,15 +375,13 @@ do {\t\t\t\t\t\t\t\t\t\\\n   if (flag_pic)\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       fprintf (FILE, \"\\tbra.l \");\t\t\t\t\t\\\n-      assemble_name\t\t\t\t\t\t\t\\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n       fprintf (FILE, \"@PLTPC\\n\");\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       fprintf (FILE, \"\\tjmp \");\t\t\t\t\t\t\\\n-      assemble_name\t\t\t\t\t\t\t\\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n       fprintf (FILE, \"\\n\");\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n } while (0)"}, {"sha": "6f9c9be86b16fd7dff7285e75feffcfe93f2b903", "filename": "gcc/config/pa/pa.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fpa%2Fpa.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fpa%2Fpa.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -1126,8 +1126,7 @@ extern enum cmp_type hppa_branch_type;\n #endif\n \n #define ASM_OUTPUT_MI_THUNK(FILE, THUNK_FNDECL, DELTA, FUNCTION) \\\n-{ char *my_name = IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (THUNK_FNDECL)); \\\n-  char *target_name = IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)); \\\n+{ char *target_name = XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0); \\\n   output_function_prologue (FILE, 0); \\\n   if (VAL_14_BITS_P (DELTA)) \\\n     fprintf (FILE, \"\\tb %s\\n\\tldo %d(%%r26),%%r26\\n\", target_name, DELTA); \\"}, {"sha": "fea8e9205f1f0adb91c677ec9fada965286ffd3e", "filename": "gcc/config/sparc/sparc.h", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fsparc%2Fsparc.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fsparc%2Fsparc.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -3075,25 +3075,21 @@ do {\t\t\t\t\t\t\t\t\t\\\n \tfprintf (FILE, \"\\tadd %%o0,%d,%%o0\\n\", DELTA);\t\t\t\\\n       fprintf (FILE, \"\\tmov %%o7,%%g1\\n\");\t\t\t\t\\\n       fprintf (FILE, \"\\tcall \");\t\t\t\t\t\\\n-      assemble_name\t\t\t\t\t\t\t\\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n       fprintf (FILE, \",0\\n\");\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   else if (TARGET_CM_EMBMEDANY)\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       fprintf (FILE, \"\\tsetx \");\t\t\t\t\t\\\n-      assemble_name\t\t\t\t\t\t\t\\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n       fprintf (FILE, \",%%g5,%%g1\\n\\tjmp %%g1\\n\");\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       fprintf (FILE, \"\\tsethi %%hi(\");\t\t\t\t\t\\\n-      assemble_name\t\t\t\t\t\t\t\\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n       fprintf (FILE, \"),%%g1\\n\\tjmp %%g1+%%lo(\");\t\t\t\\\n-      assemble_name\t\t\t\t\t\t\t\\\n-\t(FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION)));\t\\\n+      assemble_name (FILE, XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0));\t\\\n       fprintf (FILE, \")\\n\");\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   if (!TARGET_CM_EMBMEDANY || flag_pic)\t\t\t\t\t\\"}, {"sha": "3b4c54999cce8dea8a357aaad9df193d37715188", "filename": "gcc/config/vax/vax.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fvax%2Fvax.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fconfig%2Fvax%2Fvax.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fvax%2Fvax.h?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -1225,7 +1225,7 @@ do {\t\t\t\t\t\t\\\n   fprintf (FILE, \"\\t.word 0x0ffc\\n\");\t\t\\\n   fprintf (FILE, \"\\taddl2 $%d,4(ap)\\n\", DELTA);\t\\\n   fprintf (FILE, \"\\tjmp \");\t\t\t\\\n-  assemble_name (FILE, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (FUNCTION))); \\\n+  assemble_name (FILE,  XSTR (XEXP (DECL_RTL (FUNCTION), 0), 0)); \\\n   fprintf (FILE, \"+2\\n\");\t\t\t\\\n } while (0)\n "}, {"sha": "867ae1f17131efa3698f96b4aa9fe133b8b21431", "filename": "gcc/varasm.c", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92d4501f96d2e4faaced90c19ca3b986c0875366/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=92d4501f96d2e4faaced90c19ca3b986c0875366", "patch": "@@ -741,16 +741,6 @@ make_decl_rtl (decl, asmspec, top_level)\n \t      ASM_FORMAT_PRIVATE_NAME (label, name, var_labelno);\n \t      name = obstack_copy0 (saveable_obstack, label, strlen (label));\n \t      var_labelno++;\n-\n-#if 0\n-\t      /* ??? This results in incorrect stabs debug info for static\n-\t\t local variables.  */\n-\t      /* We've changed the name by which this entity is\n-\t\t known.  In order that we can generate \n-\t\t correct references to it, we update its\n-\t\t DECL_ASSEMBLER_NAME.  */\n-\t      DECL_ASSEMBLER_NAME (decl) = get_identifier (name);\n-#endif\n \t    }\n \n \t  if (name == 0)"}]}