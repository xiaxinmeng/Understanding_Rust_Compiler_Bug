{"sha": "e8b073c1bd1c589eb6c92da2db2ce00e932d04d4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZThiMDczYzFiZDFjNTg5ZWI2YzkyZGEyZGIyY2UwMGU5MzJkMDRkNA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2001-05-14T19:57:52Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2001-05-14T19:57:52Z"}, "message": "* gcc_update (touch_files): Use a Makefile to touch files.\n\nFrom-SVN: r42088", "tree": {"sha": "6bf2a0f372c6b5799de834b1a6afd7c460f1fd7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6bf2a0f372c6b5799de834b1a6afd7c460f1fd7b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4/comments", "author": null, "committer": null, "parents": [{"sha": "f327ea3ebe7002f966b19720d33c7b026b53143a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f327ea3ebe7002f966b19720d33c7b026b53143a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f327ea3ebe7002f966b19720d33c7b026b53143a"}], "stats": {"total": 41, "additions": 21, "deletions": 20}, "files": [{"sha": "edd26aaaae587144855367a198443687556a5bea", "filename": "contrib/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=e8b073c1bd1c589eb6c92da2db2ce00e932d04d4", "patch": "@@ -1,3 +1,7 @@\n+2001-05-14  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* gcc_update (touch_files): Use a Makefile to touch files.\n+\n 2001-05-03  Joseph S. Myers  <jsm28@cam.ac.uk>\n \n \t* texi2pod.pl: Add copyright and GPL notices."}, {"sha": "5960e37394489323e05f693f1b9babf4a1a7d49a", "filename": "contrib/gcc_update", "status": "modified", "additions": 17, "deletions": 20, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4/contrib%2Fgcc_update", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8b073c1bd1c589eb6c92da2db2ce00e932d04d4/contrib%2Fgcc_update", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc_update?ref=e8b073c1bd1c589eb6c92da2db2ce00e932d04d4", "patch": "@@ -98,31 +98,28 @@ EOF\n }\n \n \n-# This function checks whether its first argument is newer than all\n-# the other arguments.  It returns success (0) otherwise.\n-is_out_of_date () {\n-  test `ls -1dt ${1+\"$@\"} | sed 1q` != \"$1\"\n-}\n-\n-\n # This function touches generated files such that the ``end'' user does\n # not have to rebuild them.\n touch_files () {\n-    files_and_dependencies | while read f deps; do\n-\tif test -f $f && is_out_of_date \"$f\" $deps; then\n-\t    echo Touching \"$f\"...\n-\t    touch $f\n-\t    if is_out_of_date \"$f\" $deps; then\n-\t\t# Hmm, it may have got the same timestamp as one of\n-\t\t# its touched dependencies.  Wait a second and retry.\n-\t\tsleep 1\n-\t\techo Touching \"$f\" once more...\n-\t\ttouch $f\n-\t    fi\n-\tfi\n-    done\n+    rm -f Makefile.$$\n+    echo 'all: \\' > Makefile.$$\n+    files_and_dependencies | sed 's, .*, \\\\,' >> Makefile.$$\n+    echo '; @true' >> Makefile.$$\n+    files_and_dependencies | sed 's, ,: ,' >> Makefile.$$\n+    files_and_dependencies | sed 's, .*, \\\\,' >> Makefile.$$\n+    echo ':' >> Makefile.$$\n+    echo '\t@for f in $?; do test ! -f $$f && exit 0; done; \\' >> Makefile.$$\n+    echo '\techo Touching $@...; \\' >> Makefile.$$\n+    echo '\techo Touching $@... 1>&2; \\' >> Makefile.$$\n+    echo '\ttouch $@' >> Makefile.$$\n+    files_and_dependencies | sed 's,[^ ]* ,,;s,$, :,' >> Makefile.$$\n+    while ${MAKE-make} -f Makefile.$$ all | grep . > /dev/null; do\n+      sleep 1\n+    done 2>&1\n+    rm -f Makefile.$$\n }\n \n+\n # Whenever we update the tree or install a patch, we may be modifying\n # this script.  By re-execing it, we ensure that the appropriate\n # dependencies and rules will be used."}]}