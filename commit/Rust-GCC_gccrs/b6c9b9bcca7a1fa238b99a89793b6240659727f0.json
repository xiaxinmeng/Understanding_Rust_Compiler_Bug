{"sha": "b6c9b9bcca7a1fa238b99a89793b6240659727f0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjZjOWI5YmNjYTdhMWZhMjM4Yjk5YTg5NzkzYjYyNDA2NTk3MjdmMA==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "dvorakz@suse.cz", "date": "2006-02-16T15:59:00Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2006-02-16T15:59:00Z"}, "message": "loop-invariant.c (invariant_for_use, [...]): Fail for read-write uses.\n\n\t* loop-invariant.c (invariant_for_use, check_dependencies): Fail for\n\tread-write uses.\n\nFrom-SVN: r111141", "tree": {"sha": "68ac94b6770936c2d7b4abd15dcacaf03f67bf4d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/68ac94b6770936c2d7b4abd15dcacaf03f67bf4d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b6c9b9bcca7a1fa238b99a89793b6240659727f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6c9b9bcca7a1fa238b99a89793b6240659727f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6c9b9bcca7a1fa238b99a89793b6240659727f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6c9b9bcca7a1fa238b99a89793b6240659727f0/comments", "author": null, "committer": null, "parents": [{"sha": "28749cfbf33ee0561cb8711ba786d5de6f6fd69f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28749cfbf33ee0561cb8711ba786d5de6f6fd69f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/28749cfbf33ee0561cb8711ba786d5de6f6fd69f"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "953abf6cadd5bb89805f8f0ed34f0a1ee8431cfb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6c9b9bcca7a1fa238b99a89793b6240659727f0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6c9b9bcca7a1fa238b99a89793b6240659727f0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b6c9b9bcca7a1fa238b99a89793b6240659727f0", "patch": "@@ -1,3 +1,8 @@\n+2006-02-16  Zdenek Dvorak <dvorakz@suse.cz>\n+\n+\t* loop-invariant.c (invariant_for_use, check_dependencies): Fail for\n+\tread-write uses.\n+\n 2006-02-16  Zdenek Dvorak <dvorakz@suse.cz>\n \n \tPR rtl-optimization/26296"}, {"sha": "04531a0e05fcc95afe97ac646d66aed7e059a76e", "filename": "gcc/loop-invariant.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6c9b9bcca7a1fa238b99a89793b6240659727f0/gcc%2Floop-invariant.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6c9b9bcca7a1fa238b99a89793b6240659727f0/gcc%2Floop-invariant.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop-invariant.c?ref=b6c9b9bcca7a1fa238b99a89793b6240659727f0", "patch": "@@ -233,6 +233,9 @@ invariant_for_use (struct df_ref *use)\n   struct df_ref *def;\n   basic_block bb = BLOCK_FOR_INSN (use->insn), def_bb;\n \n+  if (use->flags & DF_REF_READ_WRITE)\n+    return NULL;\n+\n   defs = DF_REF_CHAIN (use);\n   if (!defs || defs->next)\n     return NULL;\n@@ -682,7 +685,8 @@ record_use (struct def *def, rtx *use, rtx insn)\n }\n \n /* Finds the invariants INSN depends on and store them to the DEPENDS_ON\n-   bitmap.  */\n+   bitmap.  Returns true if all dependencies of INSN are known to be\n+   loop invariants, false otherwise.  */\n \n static bool\n check_dependencies (rtx insn, bitmap depends_on)\n@@ -695,6 +699,9 @@ check_dependencies (rtx insn, bitmap depends_on)\n \n   for (use = DF_INSN_GET (df, insn)->uses; use; use = use->next_ref)\n     {\n+      if (use->flags & DF_REF_READ_WRITE)\n+\treturn false;\n+\n       defs = DF_REF_CHAIN (use);\n       if (!defs)\n \tcontinue;"}]}