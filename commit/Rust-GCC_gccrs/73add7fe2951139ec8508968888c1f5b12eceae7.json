{"sha": "73add7fe2951139ec8508968888c1f5b12eceae7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzNhZGQ3ZmUyOTUxMTM5ZWM4NTA4OTY4ODg4YzFmNWIxMmVjZWFlNw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-06-01T21:55:49Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-06-01T21:55:49Z"}, "message": "ipa-pure-const.c (local_pure_const): Do NORETURN discovery.\n\n\t* ipa-pure-const.c (local_pure_const): Do NORETURN discovery.\n\n\t* testsuite/gcc.dg/noreturn-8.c: New testcase.\n\nFrom-SVN: r160124", "tree": {"sha": "9b44105d588d9c7a44fc7884f12ec8614194f420", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9b44105d588d9c7a44fc7884f12ec8614194f420"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73add7fe2951139ec8508968888c1f5b12eceae7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73add7fe2951139ec8508968888c1f5b12eceae7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73add7fe2951139ec8508968888c1f5b12eceae7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73add7fe2951139ec8508968888c1f5b12eceae7/comments", "author": null, "committer": null, "parents": [{"sha": "a669ca47cbc34571d9e6d590a4083cddfce3c744", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a669ca47cbc34571d9e6d590a4083cddfce3c744", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a669ca47cbc34571d9e6d590a4083cddfce3c744"}], "stats": {"total": 45, "additions": 45, "deletions": 0}, "files": [{"sha": "a87a41da66abfa49d827becbc5f6899cd6021164", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=73add7fe2951139ec8508968888c1f5b12eceae7", "patch": "@@ -1,3 +1,7 @@\n+2010-06-01  Jan Hubicka  <jh@suse.cz>\n+\n+\t* ipa-pure-const.c (local_pure_const): Do NORETURN discovery.\n+\n 2010-06-01  Jan Hubicka  <jh@suse.cz>\n \n \t* tree-cfgcleanup.c (fixup_noreturn_call): Break out from ...;"}, {"sha": "d785389191a8d37f7d6df225717c53b51cfa711f", "filename": "gcc/ipa-pure-const.c", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2Fipa-pure-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2Fipa-pure-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-pure-const.c?ref=73add7fe2951139ec8508968888c1f5b12eceae7", "patch": "@@ -1362,6 +1362,27 @@ local_pure_const (void)\n       && !warn_suggest_attribute_pure\n       && skip)\n     return 0;\n+\n+  /* First do NORETURN discovery.  */\n+  if (!skip && !TREE_THIS_VOLATILE (current_function_decl)\n+      && EDGE_COUNT (EXIT_BLOCK_PTR->preds) == 0)\n+    {\n+      if (warn_missing_noreturn\n+\t  && !lang_hooks.missing_noreturn_ok_p (cfun->decl))\n+\twarning_at (DECL_SOURCE_LOCATION (cfun->decl), OPT_Wmissing_noreturn,\n+\t\t    \"function might be possible candidate \"\n+\t\t    \"for attribute %<noreturn%>\");\n+      if (dump_file)\n+        fprintf (dump_file, \"Function found to be noreturn: %s\\n\",\n+\t         lang_hooks.decl_printable_name (current_function_decl, 2));\n+\n+      /* Update declaration and reduce profile to executed once.  */\n+      TREE_THIS_VOLATILE (current_function_decl) = 1;\n+      if (node->frequency > NODE_FREQUENCY_EXECUTED_ONCE)\n+        node->frequency = NODE_FREQUENCY_EXECUTED_ONCE;\n+\n+      changed = true;\n+    }\n   l = analyze_function (node, false);\n \n   switch (l->pure_const_state)"}, {"sha": "cd4fdc359fc3a06baa343d7ede626104de02f2be", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=73add7fe2951139ec8508968888c1f5b12eceae7", "patch": "@@ -1,3 +1,7 @@\n+2010-05-31 Jan Hubicka  <jh@suse.cz>\n+\n+\t* testsuite/gcc.dg/noreturn-8.c: New testcase.\n+\n 2010-05-31 Jan Hubicka  <jh@suse.cz>\n \n \t* testsuite/gcc.dg/lto/noreturn-1_1.c: Remove dg-do annotations."}, {"sha": "50765da37ef45d3fac1f7078755822185186e475", "filename": "gcc/testsuite/gcc.dg/noreturn-8.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2Ftestsuite%2Fgcc.dg%2Fnoreturn-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73add7fe2951139ec8508968888c1f5b12eceae7/gcc%2Ftestsuite%2Fgcc.dg%2Fnoreturn-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fnoreturn-8.c?ref=73add7fe2951139ec8508968888c1f5b12eceae7", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O2\" } */\n+void exit (int);\n+void noreturn_autodetection_failed ();\n+__attribute__ ((noinline))\n+detect_noreturn ()\n+{\n+  exit (0);\n+}\n+int\n+main (void)\n+{\n+  detect_noreturn ();\n+  noreturn_autodetection_failed ();\n+  return 0;\n+}"}]}