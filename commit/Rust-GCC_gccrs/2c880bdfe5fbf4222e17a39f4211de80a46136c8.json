{"sha": "2c880bdfe5fbf4222e17a39f4211de80a46136c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmM4ODBiZGZlNWZiZjQyMjJlMTdhMzlmNDIxMWRlODBhNDYxMzZjOA==", "commit": {"author": {"name": "Ed Falis", "email": "falis@adacore.com", "date": "2009-04-10T15:18:04Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-04-10T15:18:04Z"}, "message": "init.c: Change VxWorks 6 stack overflow checking for kernel apps.\n\n2009-04-10  Ed Falis  <falis@adacore.com>\n\n\t* init.c: Change VxWorks 6 stack overflow checking for kernel apps.\n\n\t* system-vxworks-ppc.ads, system-vxworks-x86.ads: Update header.\n\nFrom-SVN: r145920", "tree": {"sha": "05fd380e3fc547f939e935ce82b6f54804bf487a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/05fd380e3fc547f939e935ce82b6f54804bf487a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2c880bdfe5fbf4222e17a39f4211de80a46136c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c880bdfe5fbf4222e17a39f4211de80a46136c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2c880bdfe5fbf4222e17a39f4211de80a46136c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c880bdfe5fbf4222e17a39f4211de80a46136c8/comments", "author": null, "committer": null, "parents": [{"sha": "d8221f45584159193e29130db4628f7d0b2b42c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8221f45584159193e29130db4628f7d0b2b42c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d8221f45584159193e29130db4628f7d0b2b42c7"}], "stats": {"total": 35, "additions": 27, "deletions": 8}, "files": [{"sha": "05f268a3515974c8945f304d616596aa90baba1c", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=2c880bdfe5fbf4222e17a39f4211de80a46136c8", "patch": "@@ -1,3 +1,9 @@\n+2009-04-10  Ed Falis  <falis@adacore.com>\n+\n+\t* init.c: Change VxWorks 6 stack overflow checking for kernel apps.\n+\n+\t* system-vxworks-ppc.ads, system-vxworks-x86.ads: Update header.\n+\n 2009-04-10  Thomas Quinot  <quinot@adacore.com>\n \n \t* sem_ch6.ads (Check_Subtype_Conformant): Add ??? comment for"}, {"sha": "78c55b83572c5e1838b0465f231a37e9df6b3755", "filename": "gcc/ada/init.c", "status": "modified", "additions": 19, "deletions": 6, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Finit.c?ref=2c880bdfe5fbf4222e17a39f4211de80a46136c8", "patch": "@@ -1782,8 +1782,9 @@ getpid (void)\n }\n #endif\n \n-/* VxWorks expects the field excCnt to be zeroed when a signal is handled.\n-   The VxWorks version of longjmp does this; GCC's builtin_longjmp doesn't.  */\n+/* VxWorks 653 vThreads expects the field excCnt to be zeroed when a signal is.\n+   handled. The VxWorks version of longjmp does this; GCC's builtin_longjmp\n+   doesn't.  */\n void\n __gnat_clear_exception_count (void)\n {\n@@ -1822,19 +1823,31 @@ __gnat_map_signal (int sig)\n       msg = \"SIGBUS: possible stack overflow\";\n       break;\n #else\n-#ifdef __RTP__\n-    /* In RTP mode a SIGSEGV is most likely due to a stack overflow,\n-       since stack checking uses the probing mechanism.  */\n+#if (_WRS_VXWORKS_MAJOR = 6)\n     case SIGILL:\n       exception = &constraint_error;\n       msg = \"SIGILL\";\n       break;\n+#ifdef __RTP__\n+    /* In RTP mode a SIGSEGV is most likely due to a stack overflow,\n+       since stack checking uses the probing mechanism.  */\n     case SIGSEGV:\n       exception = &storage_error;\n       msg = \"SIGSEGV: possible stack overflow\";\n       break;\n #else\n-    /* In kernel mode a SIGILL is most likely due to a stack overflow,\n+      /* VxWorks 6 kernel mode with probing. SIGBUS for guard page hit */\n+    case SIGSEGV:\n+      exception = &program_error;\n+      msg = \"SIGSEGV\";\n+      break;\n+    case SIGBUS:\n+      exception = &storage_error;\n+      msg = \"SIGBUS: possible stack overflow\";\n+      break;\n+#endif\n+#else\n+    /* VxWorks 5: a SIGILL is most likely due to a stack overflow,\n        since stack checking uses the stack limit mechanism.  */\n     case SIGILL:\n       exception = &storage_error;"}, {"sha": "8681e28b44dd345da2ea81b0f8e7d0ca3b906507", "filename": "gcc/ada/system-vxworks-ppc.ads", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2Fsystem-vxworks-ppc.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2Fsystem-vxworks-ppc.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsystem-vxworks-ppc.ads?ref=2c880bdfe5fbf4222e17a39f4211de80a46136c8", "patch": "@@ -5,7 +5,7 @@\n --                               S Y S T E M                                --\n --                                                                          --\n --                                 S p e c                                  --\n---                          (VxWorks Version PPC)                           --\n+--                         (VxWorks 5 Version PPC)                          --\n --                                                                          --\n --          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n --                                                                          --"}, {"sha": "a16fde29fee4d88d49d5e793d0b665bd916a9b87", "filename": "gcc/ada/system-vxworks-x86.ads", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2Fsystem-vxworks-x86.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c880bdfe5fbf4222e17a39f4211de80a46136c8/gcc%2Fada%2Fsystem-vxworks-x86.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsystem-vxworks-x86.ads?ref=2c880bdfe5fbf4222e17a39f4211de80a46136c8", "patch": "@@ -5,7 +5,7 @@\n --                               S Y S T E M                                --\n --                                                                          --\n --                                 S p e c                                  --\n---                         (VxWorks Version x86)                            --\n+--                         (VxWorks 5 Version x86)                          --\n --                                                                          --\n --          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n --                                                                          --"}]}