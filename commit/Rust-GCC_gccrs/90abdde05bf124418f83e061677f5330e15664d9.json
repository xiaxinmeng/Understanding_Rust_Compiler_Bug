{"sha": "90abdde05bf124418f83e061677f5330e15664d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTBhYmRkZTA1YmYxMjQ0MThmODNlMDYxNjc3ZjUzMzBlMTU2NjRkOQ==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2018-03-01T19:15:42Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2018-03-01T19:15:42Z"}, "message": "re PR c++/84639 (gcc/c-family/c-attribs.c:1822:27: runtime error: shift exponent -1 is negative)\n\n\tPR c++/84639\n\t* c-attribs.c (common_handle_aligned_attribute): Don't use invalid\n\talignment in computation.\n\nFrom-SVN: r258109", "tree": {"sha": "aed8d219134c3c1c3be02bca744ad9396920e841", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aed8d219134c3c1c3be02bca744ad9396920e841"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/90abdde05bf124418f83e061677f5330e15664d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90abdde05bf124418f83e061677f5330e15664d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90abdde05bf124418f83e061677f5330e15664d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90abdde05bf124418f83e061677f5330e15664d9/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4c9ce243e9f594fd22a9081ba72f50e0d1cdd508", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c9ce243e9f594fd22a9081ba72f50e0d1cdd508", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c9ce243e9f594fd22a9081ba72f50e0d1cdd508"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "c10b7bff31db810df486ec08f6d9efb09a47307d", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90abdde05bf124418f83e061677f5330e15664d9/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90abdde05bf124418f83e061677f5330e15664d9/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=90abdde05bf124418f83e061677f5330e15664d9", "patch": "@@ -1,3 +1,9 @@\n+2018-03-01  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/84639\n+\t* c-attribs.c (common_handle_aligned_attribute): Don't use invalid\n+\talignment in computation.\n+\n 2018-02-28  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* c-ada-spec.c (dump_ada_node) <NULLPTR_TYPE>: New case."}, {"sha": "3ebb2d6000cc481cbc226e780dcfc7b3bc20d80b", "filename": "gcc/c-family/c-attribs.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90abdde05bf124418f83e061677f5330e15664d9/gcc%2Fc-family%2Fc-attribs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90abdde05bf124418f83e061677f5330e15664d9/gcc%2Fc-family%2Fc-attribs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-attribs.c?ref=90abdde05bf124418f83e061677f5330e15664d9", "patch": "@@ -1817,6 +1817,12 @@ common_handle_aligned_attribute (tree *node, tree name, tree args, int flags,\n \n   /* Log2 of specified alignment.  */\n   int pow2align = check_user_alignment (align_expr, true);\n+  if (pow2align == -1\n+      || !check_cxx_fundamental_alignment_constraints (*node, pow2align, flags))\n+    {\n+      *no_add_attrs = true;\n+      return NULL_TREE;\n+    }\n \n   /* The alignment in bits corresponding to the specified alignment.  */\n   unsigned bitalign = (1U << pow2align) * BITS_PER_UNIT;\n@@ -1826,10 +1832,7 @@ common_handle_aligned_attribute (tree *node, tree name, tree args, int flags,\n   unsigned curalign = 0;\n   unsigned lastalign = 0;\n \n-  if (pow2align == -1\n-      || !check_cxx_fundamental_alignment_constraints (*node, pow2align, flags))\n-    *no_add_attrs = true;\n-  else if (is_type)\n+  if (is_type)\n     {\n       if ((flags & (int) ATTR_FLAG_TYPE_IN_PLACE))\n \t/* OK, modify the type in place.  */;"}]}