{"sha": "43c1b5d29955cfc2c5c8343f4a5d2a8af818b542", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDNjMWI1ZDI5OTU1Y2ZjMmM1YzgzNDNmNGE1ZDJhOGFmODE4YjU0Mg==", "commit": {"author": {"name": "Bruce Korb", "email": "bkorb@gnu.org", "date": "2004-11-17T04:20:36Z"}, "committer": {"name": "Bruce Korb", "email": "korbb@gcc.gnu.org", "date": "2004-11-17T04:20:36Z"}, "message": "correct misuse of variables\n\nFrom-SVN: r90789", "tree": {"sha": "b28c41db6ddb85cdbf9ff9376e5e0b2ba6795937", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b28c41db6ddb85cdbf9ff9376e5e0b2ba6795937"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542", "html_url": "https://github.com/Rust-GCC/gccrs/commit/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542/comments", "author": {"login": "brkorb", "id": 1242936, "node_id": "MDQ6VXNlcjEyNDI5MzY=", "avatar_url": "https://avatars.githubusercontent.com/u/1242936?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brkorb", "html_url": "https://github.com/brkorb", "followers_url": "https://api.github.com/users/brkorb/followers", "following_url": "https://api.github.com/users/brkorb/following{/other_user}", "gists_url": "https://api.github.com/users/brkorb/gists{/gist_id}", "starred_url": "https://api.github.com/users/brkorb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brkorb/subscriptions", "organizations_url": "https://api.github.com/users/brkorb/orgs", "repos_url": "https://api.github.com/users/brkorb/repos", "events_url": "https://api.github.com/users/brkorb/events{/privacy}", "received_events_url": "https://api.github.com/users/brkorb/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "13cf683781930f8de94b751c62d7f0c4f50bbecc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13cf683781930f8de94b751c62d7f0c4f50bbecc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/13cf683781930f8de94b751c62d7f0c4f50bbecc"}], "stats": {"total": 73, "additions": 40, "deletions": 33}, "files": [{"sha": "9794c668f7b851d34d7eecb88b3c5d47d6ec98d9", "filename": "fixincludes/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542/fixincludes%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542/fixincludes%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2FChangeLog?ref=43c1b5d29955cfc2c5c8343f4a5d2a8af818b542", "patch": "@@ -1,3 +1,8 @@\n+2004-11-15  Bruce Korb  <bkorb@gnu.org>\n+\n+\t* fixincl.c(fix_with_system): correct misuse of variables and\n+\tincorrect application of \"sizeof()\".\n+\n 2004-11-13  Joseph S. Myers  <joseph@codesourcery.com>\n \n \t* inclhack.def (hpux_maxint, limits_ifndefs, math_huge_val_ifndef,"}, {"sha": "b361146ebd528848728033ea4ac4466979672997", "filename": "fixincludes/fixincl.c", "status": "modified", "additions": 35, "deletions": 33, "changes": 68, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542/fixincludes%2Ffixincl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43c1b5d29955cfc2c5c8343f4a5d2a8af818b542/fixincludes%2Ffixincl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Ffixincl.c?ref=43c1b5d29955cfc2c5c8343f4a5d2a8af818b542", "patch": "@@ -851,41 +851,43 @@ fix_with_system (tFixDesc* p_fixd,\n   char*  pz_cmd;\n   char*  pz_scan;\n   size_t argsize;\n-  int i;\n-  tSCC *z_applyfix_prog[2] = {\n-    \"/../fixincludes/applyfix\" EXE_EXT,\n-    \"/../../fixincludes/applyfix\" EXE_EXT };\n \n   if (p_fixd->fd_flags & FD_SUBROUTINE)\n-    for (i = 0; i < 2; i++)\n-      { \n-\tstruct stat buf;\n-\n-        argsize = 32\n-                + strlen( pz_orig_dir )\n-                + sizeof( z_applyfix_prog )\n-                + strlen( pz_fix_file )\n-                + strlen( pz_file_source )\n-                + strlen( pz_temp_file );\n-\n-        pz_cmd = xmalloc (argsize);\n-\n-        strcpy( pz_cmd, pz_orig_dir );\n-        pz_scan = pz_cmd + strlen( pz_orig_dir );\n-        strcpy( pz_scan, z_applyfix_prog );\n-        pz_scan += sizeof( z_applyfix_prog ) - 1;\n-\n-\tif (stat (pz_scan, &buf) != -1)\n-\t  {\n-            *(pz_scan++) = ' ';\n-            /*\n-             *  Now add the fix number and file names that may be needed\n-             */\n-            sprintf (pz_scan, \"%ld \\'%s\\' \\'%s\\' \\'%s\\'\", p_fixd - fixDescList,\n-\t             pz_fix_file, pz_file_source, pz_temp_file);\n-\t    break;\n-\t  }\n-      }\n+    {\n+      static const char z_applyfix_prog[] =\n+\t\"/../fixincludes/applyfix\" EXE_EXT;\n+\n+      struct stat buf;\n+      argsize = 32\n+              + strlen (pz_orig_dir)\n+              + sizeof (z_applyfix_prog)\n+              + strlen (pz_fix_file)\n+              + strlen (pz_file_source)\n+              + strlen (pz_temp_file);\n+\n+      /* Allocate something sure to be big enough for our purposes */\n+      pz_cmd = xmalloc (argsize);\n+      strcpy (pz_cmd, pz_orig_dir);\n+      pz_scan = pz_cmd + strlen (pz_orig_dir);\n+\n+      strcpy (pz_scan, z_applyfix_prog);\n+\n+      /* IF we can't find the \"applyfix\" executable file at the first guess,\n+\t try one level higher up  */\n+      if (stat (pz_cmd, &buf) == -1)\n+\t{\n+\t  strcpy (pz_scan, \"/..\");\n+\t  strcpy (pz_scan+3, z_applyfix_prog);\n+\t}\n+\n+      pz_scan += strlen (pz_scan);\n+\n+      /*\n+       *  Now add the fix number and file names that may be needed\n+       */\n+      sprintf (pz_scan, \" %ld \\'%s\\' \\'%s\\' \\'%s\\'\", p_fixd - fixDescList,\n+\t       pz_fix_file, pz_file_source, pz_temp_file);\n+    }\n   else /* NOT an \"internal\" fix: */\n     {\n       size_t parg_size;"}]}