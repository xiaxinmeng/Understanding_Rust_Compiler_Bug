{"sha": "2f11ca2a3a3bea38a7c5bd63e777620a4887e649", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmYxMWNhMmEzYTNiZWEzOGE3YzViZDYzZTc3NzYyMGE0ODg3ZTY0OQ==", "commit": {"author": {"name": "Cooper Qu", "email": "cooper.qu@linux.alibaba.com", "date": "2021-07-16T08:05:39Z"}, "committer": {"name": "Xianmiao Qu", "email": "xianmiao_qu@c-sky.com", "date": "2021-07-16T08:48:06Z"}, "message": "C-SKY: Use the common way to define MULTILIB_DIRNAMES.\n\nC-SKY previously used a forked print-sysroot-suffix.sh and define\nCSKY_MULTILIB_DIRNAMES to specify OS multilib directories. This\npatch delete the forked print-sysroot-suffix.sh and define\nMULTILIB_DIRNAMES to generate same directories.\n\ngcc/\n\t* config.gcc: Don't use forked print-sysroot-suffix.sh and\n\tt-sysroot-suffix for C-SKY.\n\t* config/csky/print-sysroot-suffix.sh: Delete.\n\t* config/csky/t-csky-linux: Delete.\n\t* config/csky/t-sysroot-suffix: Define MULTILIB_DIRNAMES\n\tinstead of CSKY_MULTILIB_DIRNAMES.", "tree": {"sha": "b83d80736995d3f0aed335677095c8974972a8bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b83d80736995d3f0aed335677095c8974972a8bb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f11ca2a3a3bea38a7c5bd63e777620a4887e649", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f11ca2a3a3bea38a7c5bd63e777620a4887e649", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f11ca2a3a3bea38a7c5bd63e777620a4887e649", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f11ca2a3a3bea38a7c5bd63e777620a4887e649/comments", "author": {"login": "Cooper-Qu", "id": 68842787, "node_id": "MDQ6VXNlcjY4ODQyNzg3", "avatar_url": "https://avatars.githubusercontent.com/u/68842787?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Cooper-Qu", "html_url": "https://github.com/Cooper-Qu", "followers_url": "https://api.github.com/users/Cooper-Qu/followers", "following_url": "https://api.github.com/users/Cooper-Qu/following{/other_user}", "gists_url": "https://api.github.com/users/Cooper-Qu/gists{/gist_id}", "starred_url": "https://api.github.com/users/Cooper-Qu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Cooper-Qu/subscriptions", "organizations_url": "https://api.github.com/users/Cooper-Qu/orgs", "repos_url": "https://api.github.com/users/Cooper-Qu/repos", "events_url": "https://api.github.com/users/Cooper-Qu/events{/privacy}", "received_events_url": "https://api.github.com/users/Cooper-Qu/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d6aa28bb93c6fc9042ee87ff7addac60647dbddb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6aa28bb93c6fc9042ee87ff7addac60647dbddb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6aa28bb93c6fc9042ee87ff7addac60647dbddb"}], "stats": {"total": 182, "additions": 1, "deletions": 181}, "files": [{"sha": "93e2b3219b99dc54434c461089f1d23b19e2fb6c", "filename": "gcc/config.gcc", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f11ca2a3a3bea38a7c5bd63e777620a4887e649/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f11ca2a3a3bea38a7c5bd63e777620a4887e649/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=2f11ca2a3a3bea38a7c5bd63e777620a4887e649", "patch": "@@ -1568,11 +1568,6 @@ csky-*-*)\n \t\ttm_file=\"dbxelf.h elfos.h gnu-user.h linux.h glibc-stdint.h ${tm_file} csky/csky-linux-elf.h\"\n \t\ttmake_file=\"${tmake_file} csky/t-csky csky/t-csky-linux\"\n \n-\t\tif test \"x${enable_multilib}\" = xyes ; then\n-\t\t    tm_file=\"$tm_file ./sysroot-suffix.h\"\n-\t\t    tmake_file=\"${tmake_file} csky/t-sysroot-suffix\"\n-\t\tfi\n-\n \t\tcase ${target} in\n \t\t    csky-*-linux-gnu*)\n \t\t\ttm_defines=\"$tm_defines DEFAULT_LIBC=LIBC_GLIBC\""}, {"sha": "4840bc67d0799af5214a76a0c3d27aac2c4317c0", "filename": "gcc/config/csky/print-sysroot-suffix.sh", "status": "removed", "additions": 0, "deletions": 147, "changes": 147, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6aa28bb93c6fc9042ee87ff7addac60647dbddb/gcc%2Fconfig%2Fcsky%2Fprint-sysroot-suffix.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6aa28bb93c6fc9042ee87ff7addac60647dbddb/gcc%2Fconfig%2Fcsky%2Fprint-sysroot-suffix.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcsky%2Fprint-sysroot-suffix.sh?ref=d6aa28bb93c6fc9042ee87ff7addac60647dbddb", "patch": "@@ -1,147 +0,0 @@\n-#! /bin/sh\n-# Script to generate SYSROOT_SUFFIX_SPEC equivalent to MULTILIB_OSDIRNAMES\n-# Arguments are MULTILIB_OSDIRNAMES, MULTILIB_OPTIONS and MULTILIB_MATCHES.\n-\n-# Copyright (C) 2018-2021 Free Software Foundation, Inc.\n-# Contributed by C-SKY Microsystems and Mentor Graphics.\n-\n-# This file is part of GCC.\n-\n-# GCC is free software; you can redistribute it and/or modify it under\n-# the terms of the GNU General Public License as published by the Free\n-# Software Foundation; either version 3, or (at your option) any later\n-# version.\n-\n-# GCC is distributed in the hope that it will be useful, but WITHOUT\n-# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n-# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n-# for more details.\n-\n-# You should have received a copy of the GNU General Public License\n-# along with GCC; see the file COPYING3.  If not see\n-# <http://www.gnu.org/licenses/>.\n-\n-# This shell script produces a header file fragment that defines\n-# SYSROOT_SUFFIX_SPEC.  It assumes that the sysroots will have the same\n-# structure and names used by the multilibs.\n-\n-# Invocation:\n-#   print-sysroot-suffix.sh \\\n-#          MULTILIB_OSDIRNAMES \\\n-#          MULTILIB_OPTIONS \\\n-#          MULTILIB_MATCHES \\\n-#      > t-sysroot-suffix.h\n-\n-# The three options exactly correspond to the variables of the same\n-# names defined in the tmake_file fragments.\n-\n-# Example:\n-#   sh ./gcc/config/print-sysroot-suffix.sh \"a=A\" \"a b/c/d\" \"\"\n-# =>\n-#   #undef SYSROOT_SUFFIX_SPEC\n-#   #define SYSROOT_SUFFIX_SPEC \"\" \\\n-#   \"%{a:\" \\\n-#     \"%{b:A/b/;\" \\\n-#     \"c:A/c/;\" \\\n-#     \"d:A/d/;\" \\\n-#     \":A/};\" \\\n-#   \":}\"\n-\n-# The script uses temporary subscripts in order to permit a recursive\n-# algorithm without the use of functions.\n-\n-set -e\n-\n-dirnames=\"$1\"\n-options=\"$2\"\n-matches=\"$3\"\n-\n-cat > print-sysroot-suffix3.sh <<\\EOF\n-#! /bin/sh\n-# Print all the multilib matches for this option\n-result=\"$1\"\n-EOF\n-for x in $matches; do\n-  l=`echo $x | sed -e 's/=.*$//' -e 's/?/=/g'`\n-  r=`echo $x | sed -e 's/^.*=//' -e 's/?/=/g'`\n-  echo \"[ \\\"\\$1\\\" = \\\"$l\\\" ] && result=\\\"\\$result|$r\\\"\" >> print-sysroot-suffix3.sh\n-done\n-echo 'echo $result' >> print-sysroot-suffix3.sh\n-chmod +x print-sysroot-suffix3.sh\n-\n-cat > print-sysroot-suffix2.sh <<\\EOF\n-#! /bin/sh\n-# Recursive script to enumerate all multilib combinations, match against\n-# multilib directories and output a spec string of the result.\n-# Will fold identical trees.\n-\n-padding=\"$1\"\n-optstring=\"$2\"\n-shift 2\n-n=\"\\\" \\\\\n-$padding\\\"\"\n-if [ $# = 0 ]; then\n-EOF\n-\n-pat=\n-for x in $dirnames; do\n-#  p=`echo $x | sed -e 's,=!,/$=/,'`\n-  p=`echo $x | sed -e 's/=//g'`\n-#  pat=\"$pat -e 's=^//$p='\"\n-   pat=\"$pat -e 's/$p/g'\"\n-done\n-echo '  optstring=`echo \"/$optstring\" | sed '\"$pat\\`\" >> print-sysroot-suffix2.sh\n-cat >> print-sysroot-suffix2.sh <<\\EOF\n-  case $optstring in\n-  //*)\n-    ;;\n-  *)\n-    echo \"$optstring\"\n-    ;;\n-  esac\n-else\n-  thisopt=\"$1\"\n-  shift\n-  bit=\n-  lastcond=\n-  result=\n-  for x in `echo \"$thisopt\" | sed -e 's,/, ,g'`; do\n-    case $x in\n-EOF\n-for x in `echo \"$options\" | sed -e 's,/, ,g'`; do\n-  match=`./print-sysroot-suffix3.sh \"$x\"`\n-  echo \"$x) optmatch=\\\"$match\\\" ;;\" >> print-sysroot-suffix2.sh\n-done\n-cat >> print-sysroot-suffix2.sh <<\\EOF\n-    esac\n-    bit=`\"$0\" \"$padding  \" \"$optstring$x/\" \"$@\"`\n-    if [ -z \"$lastopt\" ]; then\n-      lastopt=\"$optmatch\"\n-    else\n-      if [ \"$lastbit\" = \"$bit\" ]; then\n-\tlastopt=\"$lastopt|$optmatch\"\n-      else\n-\tresult=\"$result$lastopt:$lastbit;$n\"\n-\tlastopt=\"$optmatch\"\n-      fi\n-    fi\n-    lastbit=\"$bit\"\n-  done\n-  bit=`\"$0\" \"$padding  \" \"$optstring\" \"$@\"`\n-  if [ \"$bit\" = \"$lastbit\" ]; then\n-    if [ -z \"$result\" ]; then\n-      echo \"$bit\"\n-    else\n-      echo \"$n%{$result:$bit}\"\n-    fi\n-  else\n-    echo \"$n%{$result$lastopt:$lastbit;$n:$bit}\"\n-  fi\n-fi\n-EOF\n-chmod +x ./print-sysroot-suffix2.sh\n-result=`./print-sysroot-suffix2.sh \\\"\\\" \\\"\\\" $options`\n-echo \"#undef SYSROOT_SUFFIX_SPEC\"\n-echo \"#define SYSROOT_SUFFIX_SPEC \\\"$result\\\"\"\n-rm print-sysroot-suffix2.sh\n-rm print-sysroot-suffix3.sh"}, {"sha": "9139040d31b385ca41c789ec7a79e8dd24a02b62", "filename": "gcc/config/csky/t-csky-linux", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f11ca2a3a3bea38a7c5bd63e777620a4887e649/gcc%2Fconfig%2Fcsky%2Ft-csky-linux", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f11ca2a3a3bea38a7c5bd63e777620a4887e649/gcc%2Fconfig%2Fcsky%2Ft-csky-linux", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcsky%2Ft-csky-linux?ref=2f11ca2a3a3bea38a7c5bd63e777620a4887e649", "patch": "@@ -21,7 +21,7 @@\n \n \n MULTILIB_EXCEPTIONS  =\n-CSKY_MULTILIB_OSDIRNAMES = mfloat-abi.softfp=/soft-fp mfloat-abi.hard=/hard-fp mfloat-abi.soft=/. mcpu.ck810f=/. mcpu.ck807f=/ck807 mcpu.ck860f=/ck860\n+MULTILIB_OSDIRNAMES = ./ ./ck807 ./ck860 ./ ./soft-fp ./hard-fp\n \n # Arch variants.\n MULTILIB_OPTIONS     += mcpu=ck810f/mcpu=ck807f/mcpu=ck860f"}, {"sha": "d891f699c80248bb065baf08c21f0f37f6d00403", "filename": "gcc/config/csky/t-sysroot-suffix", "status": "removed", "additions": 0, "deletions": 28, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6aa28bb93c6fc9042ee87ff7addac60647dbddb/gcc%2Fconfig%2Fcsky%2Ft-sysroot-suffix", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6aa28bb93c6fc9042ee87ff7addac60647dbddb/gcc%2Fconfig%2Fcsky%2Ft-sysroot-suffix", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcsky%2Ft-sysroot-suffix?ref=d6aa28bb93c6fc9042ee87ff7addac60647dbddb", "patch": "@@ -1,28 +0,0 @@\n-# Makefile fragment for C-SKY sysroot suffix.\n-#\n-# Copyright (C) 2018-2021 Free Software Foundation, Inc.\n-# Contributed by C-SKY Microsystems and Mentor Graphics.\n-#\n-# This file is part of GCC.\n-#\n-# GCC is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 3, or (at your option)\n-# any later version.\n-#\n-# GCC is distributed in the hope that it will be useful,\n-# but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n-#\n-# You should have received a copy of the GNU General Public License\n-# along with GCC; see the file COPYING3.  If not see\n-# <http://www.gnu.org/licenses/>.\n-\n-# Generate SYSROOT_SUFFIX_SPEC from MULTILIB_OSDIRNAMES.\n-\n-sysroot-suffix.h: $(srcdir)/config/csky/print-sysroot-suffix.sh\n-\t$(SHELL) $(srcdir)/config/csky/print-sysroot-suffix.sh \\\n-\t  \"$(CSKY_MULTILIB_OSDIRNAMES)\" \"$(MULTILIB_OPTIONS)\" \\\n-\t  \"$(MULTILIB_MATCHES)\" > tmp-sysroot-suffix.h\n-\tmv tmp-sysroot-suffix.h $@"}]}