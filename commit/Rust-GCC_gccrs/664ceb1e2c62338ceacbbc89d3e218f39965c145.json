{"sha": "664ceb1e2c62338ceacbbc89d3e218f39965c145", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjY0Y2ViMWUyYzYyMzM4Y2VhY2JiYzg5ZDNlMjE4ZjM5OTY1YzE0NQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2014-01-17T20:55:42Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2014-01-17T20:55:42Z"}, "message": "re PR fortran/59706 (ICE with do concurrent and internal subprogram)\n\n\tPR middle-end/59706\n\t* gimplify.c (gimplify_expr): Use create_tmp_var\n\tinstead of create_tmp_var_raw.  If cond doesn't have\n\tintegral type, don't add the IFN_ANNOTATE builtin at all.\n\n\t* gfortran.dg/pr59706.f90: New test.\n\t* g++.dg/ext/pr59706.C: New test.\n\nFrom-SVN: r206732", "tree": {"sha": "0175ffcfd1d2d531d5e03b3bdd4bb83bded36f60", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0175ffcfd1d2d531d5e03b3bdd4bb83bded36f60"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/664ceb1e2c62338ceacbbc89d3e218f39965c145", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/664ceb1e2c62338ceacbbc89d3e218f39965c145", "html_url": "https://github.com/Rust-GCC/gccrs/commit/664ceb1e2c62338ceacbbc89d3e218f39965c145", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/664ceb1e2c62338ceacbbc89d3e218f39965c145/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a95aef3c126b193ad4f7cf6bed6c40534236bc0b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a95aef3c126b193ad4f7cf6bed6c40534236bc0b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a95aef3c126b193ad4f7cf6bed6c40534236bc0b"}], "stats": {"total": 53, "additions": 52, "deletions": 1}, "files": [{"sha": "0240d7eb03f1f587518e6242de1bd30163bf89c6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=664ceb1e2c62338ceacbbc89d3e218f39965c145", "patch": "@@ -1,3 +1,10 @@\n+2014-01-17  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/59706\n+\t* gimplify.c (gimplify_expr): Use create_tmp_var\n+\tinstead of create_tmp_var_raw.  If cond doesn't have\n+\tintegral type, don't add the IFN_ANNOTATE builtin at all.\n+\n 2014-01-17  Martin Jambor  <mjambor@suse.cz>\n \n \tPR ipa/59736"}, {"sha": "9c9998dd1939ae8869a3861bec379a6861ad3b55", "filename": "gcc/gimplify.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=664ceb1e2c62338ceacbbc89d3e218f39965c145", "patch": "@@ -7491,7 +7491,14 @@ gimplify_expr (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \t  {\n \t    tree cond = TREE_OPERAND (*expr_p, 0);\n \t    tree id = TREE_OPERAND (*expr_p, 1);\n-\t    tree tmp = create_tmp_var_raw (TREE_TYPE(cond), NULL);\n+\t    tree type = TREE_TYPE (cond);\n+\t    if (!INTEGRAL_TYPE_P (type))\n+\t      {\n+\t\t*expr_p = cond;\n+\t\tret = GS_OK;\n+\t\tbreak;\n+\t      }\n+\t    tree tmp = create_tmp_var (type, NULL);\n \t    gimplify_arg (&cond, pre_p, EXPR_LOCATION (*expr_p));\n \t    gimple call = gimple_build_call_internal (IFN_ANNOTATE, 2,\n \t\t\t\t\t\t      cond, id);"}, {"sha": "be4aa901eca3377cc3a7ca1331525232e0294ae5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=664ceb1e2c62338ceacbbc89d3e218f39965c145", "patch": "@@ -1,3 +1,9 @@\n+2014-01-17  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/59706\n+\t* gfortran.dg/pr59706.f90: New test.\n+\t* g++.dg/ext/pr59706.C: New test.\n+\n 2014-01-17  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/59270"}, {"sha": "b82b45e2d4cc3a878993bba8d9ff94a9d66ce060", "filename": "gcc/testsuite/g++.dg/ext/pr59706.C", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fpr59706.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fpr59706.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fpr59706.C?ref=664ceb1e2c62338ceacbbc89d3e218f39965c145", "patch": "@@ -0,0 +1,21 @@\n+// PR middle-end/59706\n+// { dg-do compile }\n+\n+extern struct S s;\n+struct T { T (); ~T (); int t; } t;\n+\n+void\n+foo ()\n+{\n+  #pragma GCC ivdep\n+  while (s)\t// { dg-error \"could not convert\" }\n+    ;\n+}\n+\n+void\n+bar ()\n+{\n+  #pragma GCC ivdep\n+  while (t)\t// { dg-error \"could not convert\" }\n+    ;\n+}"}, {"sha": "64a7de5d965c079492fc1d54b481dc388d8b1381", "filename": "gcc/testsuite/gfortran.dg/pr59706.f90", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr59706.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/664ceb1e2c62338ceacbbc89d3e218f39965c145/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr59706.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr59706.f90?ref=664ceb1e2c62338ceacbbc89d3e218f39965c145", "patch": "@@ -0,0 +1,10 @@\n+! PR middle-end/59706\n+! { dg-do compile }\n+\n+  integer i\n+  do concurrent (i=1:2)\n+  end do\n+contains\n+  subroutine foo\n+  end \n+end"}]}