{"sha": "e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTg1ZGY5MmU3ZDNkYTAzYjNmODkzZDM3OGM1YzY0Y2VlZTFkZTdlMQ==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2011-04-21T08:29:41Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2011-04-21T08:29:41Z"}, "message": "re PR fortran/18918 (Eventually support Fortran 2008's coarrays [co-arrays])\n\n2011-04-21  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/18918\n        * array.c (gfc_match_array_spec): Fix maximal rank(+corank) check.\n\n2011-04-21  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/18918\n        * gfortran.dg/coarray_18.f90: New.\n\nFrom-SVN: r172812", "tree": {"sha": "b514a69d9477f0713ee2f0a57c3fb1fac297f08f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b514a69d9477f0713ee2f0a57c3fb1fac297f08f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "470f5b53a29f5310b0e3782a06f18430de836fd2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/470f5b53a29f5310b0e3782a06f18430de836fd2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/470f5b53a29f5310b0e3782a06f18430de836fd2"}], "stats": {"total": 58, "additions": 57, "deletions": 1}, "files": [{"sha": "25ef329b75a96467ad8eb07848b34a61261a8870", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "patch": "@@ -1,3 +1,8 @@\n+2011-04-21  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/18918\n+\t* array.c (gfc_match_array_spec): Fix maximal rank(+corank) check.\n+\n 2011-04-20  Jim Meyering  <meyering@redhat.com>\n \n \t* expr.c (free_expr0): Remove useless if-before-free."}, {"sha": "1394e17baf0c870fdbb970d28898c4bd09f4aac5", "filename": "gcc/fortran/array.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ffortran%2Farray.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ffortran%2Farray.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Farray.c?ref=e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "patch": "@@ -576,6 +576,13 @@ gfc_match_array_spec (gfc_array_spec **asp, bool match_dim, bool match_codim)\n       goto cleanup;\n     }\n \n+  if (as->rank >= GFC_MAX_DIMENSIONS)\n+    {\n+      gfc_error (\"Array specification at %C has more than %d \"\n+\t\t \"dimensions\", GFC_MAX_DIMENSIONS);\n+      goto cleanup;\n+    }\n+\n   for (;;)\n     {\n       as->corank++;\n@@ -644,7 +651,7 @@ gfc_match_array_spec (gfc_array_spec **asp, bool match_dim, bool match_codim)\n \t  goto cleanup;\n \t}\n \n-      if (as->corank >= GFC_MAX_DIMENSIONS)\n+      if (as->rank + as->corank >= GFC_MAX_DIMENSIONS)\n \t{\n \t  gfc_error (\"Array specification at %C has more than %d \"\n \t\t     \"dimensions\", GFC_MAX_DIMENSIONS);"}, {"sha": "ae5daf2af530798a0b9d7cda5b49b70a732d3153", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "patch": "@@ -1,3 +1,8 @@\n+2011-04-21  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/18918\n+\t* gfortran.dg/coarray_18.f90: New.\n+\n 2011-04-20  Jason Merrill  <jason@redhat.com>\n \n \t* g++.dg/cpp0x/initlist47.C: New."}, {"sha": "474e9391edb19a02238037c1086ba2bf94724cb2", "filename": "gcc/testsuite/gfortran.dg/coarray_18.f90", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_18.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85df92e7d3da03b3f893d378c5c64ceee1de7e1/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_18.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_18.f90?ref=e85df92e7d3da03b3f893d378c5c64ceee1de7e1", "patch": "@@ -0,0 +1,39 @@\n+! { dg-do compile }\n+! { dg-options \"-fcoarray=single\" }\n+!\n+! Prevent ICE when exceeding the maximal number of allowed\n+! dimensions (normal + codimensions).\n+!\n+! Fortran 2008 allows (co)arrays with 15 ranks\n+! Currently, gfortran only supports 7, cf. PR 37577\n+! Thus, the program is valid Fortran 2008 ...\n+!\n+! See also general coarray PR 18918\n+!\n+! Test case taken from Leibniz-Rechenzentrum (LRZ)'s\n+! fortran_tests with thanks to Reinhold Bader.\n+!\n+\n+program ar\n+  implicit none\n+  integer :: ic(2)[*]\n+  integer :: id(2,2)[2,*]\n+  integer :: ie(2,2,2)[2,2,*]\n+  integer :: ig(2,2,2,2)[2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+  integer :: ih(2,2,2,2,2)[2,2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+  integer :: ij(2,2,2,2,2,2)[2,2,2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+  integer :: ik(2,2,2,2,2,2,2)[2,2,2,2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+  integer :: il[2,2,2,2,2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+  integer :: im[2,2,2,2,2,2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+  integer :: in[2,2,2,2,2,2,2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+  integer :: io[2,2,2,2,2,2,2,2,2,2,*] ! { dg-error \"has more than 7 dimensions\" }\n+   real :: x2(2,2,4)[2,*]\n+   complex :: c2(4,2)[2,*]\n+   double precision :: d2(1,5,9)[2,*]\n+   character(len=1) :: ch2(2)[2,*]\n+   character(len=2) :: ch22(-5:4)[2,*]\n+   logical :: l2(17)[2,*]\n+   if (this_image() == 1) then\n+      write(*,*) 'OK'\n+   end if\n+end program"}]}