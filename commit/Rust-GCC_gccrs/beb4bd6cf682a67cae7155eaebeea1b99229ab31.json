{"sha": "beb4bd6cf682a67cae7155eaebeea1b99229ab31", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmViNGJkNmNmNjgyYTY3Y2FlNzE1NWVhZWJlZWExYjk5MjI5YWIzMQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2008-08-14T21:15:59Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2008-08-14T21:15:59Z"}, "message": "re PR fortran/36705 (Procedure pointers with attributes statements)\n\n2008-08-14  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/36705\n\t* symbol.c (check_conflict): Move conflict checks for (procedure,save)\n\tand (procedure,intent) to resolve_fl_procedure.\n\t* resolve.c (resolve_fl_procedure): Ditto.\n\n\n2008-08-14  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/36705\n\t* gfortran.dg/argument_checking_7.f90: Modified.\n\t* gfortran.dg/conflicts.f90: Modified.\n\t* gfortran.dg/proc_decl_1.f90: Modified.\n\t* gfortran.dg/proc_ptr_9.f90: New.\n\nFrom-SVN: r139116", "tree": {"sha": "aa78450fe0cbc47d0224c6648e10b150996475c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aa78450fe0cbc47d0224c6648e10b150996475c1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/beb4bd6cf682a67cae7155eaebeea1b99229ab31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/beb4bd6cf682a67cae7155eaebeea1b99229ab31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/beb4bd6cf682a67cae7155eaebeea1b99229ab31", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/beb4bd6cf682a67cae7155eaebeea1b99229ab31/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "157b0647a507b589d7651b80fe55275df54cead4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/157b0647a507b589d7651b80fe55275df54cead4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/157b0647a507b589d7651b80fe55275df54cead4"}], "stats": {"total": 73, "additions": 58, "deletions": 15}, "files": [{"sha": "3ea6c32005cf907a3d8d642f05d5228028452c20", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -1,3 +1,10 @@\n+2008-08-14  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/36705\n+\t* symbol.c (check_conflict): Move conflict checks for (procedure,save)\n+\tand (procedure,intent) to resolve_fl_procedure.\n+\t* resolve.c (resolve_fl_procedure): Ditto.\n+\n 2008-08-09  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n \n \tPR 36901"}, {"sha": "994cb71151a547493261ca544943c3b7ad19cb88", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -7443,6 +7443,20 @@ resolve_fl_procedure (gfc_symbol *sym, int mp_flag)\n \t}\n     }\n   \n+  if (sym->attr.save == SAVE_EXPLICIT && !sym->attr.proc_pointer)\n+    {\n+      gfc_error (\"PROCEDURE attribute conflicts with SAVE attribute \"\n+\t\t \"in '%s' at %L\", sym->name, &sym->declared_at);\n+      return FAILURE;\n+    }\n+\n+  if (sym->attr.intent && !sym->attr.proc_pointer)\n+    {\n+      gfc_error (\"PROCEDURE attribute conflicts with INTENT attribute \"\n+\t\t \"in '%s' at %L\", sym->name, &sym->declared_at);\n+      return FAILURE;\n+    }\n+\n   return SUCCESS;\n }\n "}, {"sha": "d564dd7782f1ad1e9020db7573fc79cf9a4a184f", "filename": "gcc/fortran/symbol.c", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ffortran%2Fsymbol.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ffortran%2Fsymbol.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsymbol.c?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -417,12 +417,8 @@ check_conflict (symbol_attribute *attr, const char *name, locus *where)\n \t    goto conflict;\n \n \t  case FL_PROCEDURE:\n-\t    if (attr->proc_pointer)\n-\t      break;\n-\t    a1 = gfc_code2string (flavors, attr->flavor);\n-\t    a2 = save;\n-\t    goto conflict;\n-\n+\t    /* Conflicts between SAVE and PROCEDURE will be checked at\n+\t       resolution stage, see \"resolve_fl_procedure\".  */\n \t  case FL_VARIABLE:\n \t  case FL_NAMELIST:\n \t  default:\n@@ -618,8 +614,8 @@ check_conflict (symbol_attribute *attr, const char *name, locus *where)\n       break;\n \n     case FL_PROCEDURE:\n-      if (!attr->proc_pointer)\n-        conf2 (intent);\n+      /* Conflicts with INTENT will be checked at resolution stage,\n+\t see \"resolve_fl_procedure\".  */\n \n       if (attr->subroutine)\n \t{"}, {"sha": "94bde48263502fdbefe544548c32fe3acd60ffbc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -1,3 +1,11 @@\n+2008-08-14  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/36705\n+\t* gfortran.dg/argument_checking_7.f90: Modified.\n+\t* gfortran.dg/conflicts.f90: Modified.\n+\t* gfortran.dg/proc_decl_1.f90: Modified.\n+\t* gfortran.dg/proc_ptr_9.f90: New.\n+\n 2008-08-14  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/34485"}, {"sha": "1c74fc58fd93d4a9e4fe4d66a516ff87ca9b75f2", "filename": "gcc/testsuite/gfortran.dg/argument_checking_7.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_7.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_7.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_7.f90?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -12,7 +12,7 @@ function ouch(x,y) ! { dg-error \"has no IMPLICIT type\" }\n       character(len(y)-1) ouch\n       integer i\n       do i = 1, len(ouch)\n-        ouch(i:i) = achar(ieor(iachar(x(i:i)),iachar(y(i:i)))) ! { dg-error \" PROCEDURE attribute conflicts\" }\n+        ouch(i:i) = achar(ieor(iachar(x(i:i)),iachar(y(i:i)))) ! { dg-error \"Syntax error in argument list\" }\n       end do\n       end function ouch\n end module cyclic"}, {"sha": "1f10a65ceedaf50a3596d654f58a8b1bde030c35", "filename": "gcc/testsuite/gfortran.dg/conflicts.f90", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fconflicts.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fconflicts.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fconflicts.f90?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -2,16 +2,16 @@\n ! Check for conflicts\n ! PR fortran/29657\n \n-function f1() ! { dg-error \"has no IMPLICIT type\" }\n+function f1() ! { dg-error \"PROCEDURE attribute conflicts with SAVE attribute\" }\n   implicit none\n-  real, save :: f1 ! { dg-error \"PROCEDURE attribute conflicts with SAVE attribute\" }\n+  real, save :: f1\n   f1 = 1.0\n end function f1\n \n-function f2()\n+function f2() ! { dg-error \"PROCEDURE attribute conflicts with SAVE attribute\" }\n   implicit none\n   real :: f2\n-  save f2 ! { dg-error \"PROCEDURE attribute conflicts with SAVE attribute\" }\n+  save f2\n   f2 = 1.0\n end function f2\n "}, {"sha": "219722f7a2daef14b82636110997be0a24d4a1f6", "filename": "gcc/testsuite/gfortran.dg/proc_decl_1.f90", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_decl_1.f90?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -53,13 +53,13 @@ subroutine z2(a)\n \n contains\n \n-  subroutine foo(a,c)\n+  subroutine foo(a,c)  ! { dg-error \"PROCEDURE attribute conflicts with INTENT attribute\" }\n     abstract interface\n       subroutine b() bind(C)\n       end subroutine b\n     end interface\n     procedure(b), bind(c,name=\"hjj\") :: a  ! { dg-error \"may not have BIND.C. attribute with NAME\" }\n-    procedure(c),intent(in):: c  ! { dg-error \"PROCEDURE attribute conflicts with INTENT attribute\" }\n+    procedure(b),intent(in):: c\n   end subroutine foo \n \n end program"}, {"sha": "22708b8f1a845bf53305669140ef6ca9e409d50f", "filename": "gcc/testsuite/gfortran.dg/proc_ptr_9.f90", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_9.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/beb4bd6cf682a67cae7155eaebeea1b99229ab31/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_9.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_9.f90?ref=beb4bd6cf682a67cae7155eaebeea1b99229ab31", "patch": "@@ -0,0 +1,18 @@\n+! { dg-do compile }\n+!\n+! PR fortran/36705\n+!\n+! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n+\n+save :: p\n+procedure() :: p\n+pointer :: p\n+\n+contains\n+\n+subroutine bar(x)\n+  procedure(), intent(in) :: x\n+  pointer :: x\n+end subroutine bar \n+\n+end"}]}