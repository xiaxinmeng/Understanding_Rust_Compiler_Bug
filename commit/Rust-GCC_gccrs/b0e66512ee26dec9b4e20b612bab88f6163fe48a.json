{"sha": "b0e66512ee26dec9b4e20b612bab88f6163fe48a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjBlNjY1MTJlZTI2ZGVjOWI0ZTIwYjYxMmJhYjg4ZjYxNjNmZTQ4YQ==", "commit": {"author": {"name": "Dehao Chen", "email": "dehao@google.com", "date": "2014-05-16T20:40:29Z"}, "committer": {"name": "Dehao Chen", "email": "dehao@gcc.gnu.org", "date": "2014-05-16T20:40:29Z"}, "message": "cfghooks.c (make_forwarder_block): Use direct computation to get fall-through edge's count and frequency.\n\n2014-05-16  Dehao Chen  <dehao@google.com>\n\n\t* cfghooks.c (make_forwarder_block): Use direct computation to\n\tget fall-through edge's count and frequency.\n\nFrom-SVN: r210528", "tree": {"sha": "59a5a32e9cc23f9622626883d23a53b71387ac68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/59a5a32e9cc23f9622626883d23a53b71387ac68"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b0e66512ee26dec9b4e20b612bab88f6163fe48a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0e66512ee26dec9b4e20b612bab88f6163fe48a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0e66512ee26dec9b4e20b612bab88f6163fe48a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0e66512ee26dec9b4e20b612bab88f6163fe48a/comments", "author": {"login": "danielcdh", "id": 694263, "node_id": "MDQ6VXNlcjY5NDI2Mw==", "avatar_url": "https://avatars.githubusercontent.com/u/694263?v=4", "gravatar_id": "", "url": "https://api.github.com/users/danielcdh", "html_url": "https://github.com/danielcdh", "followers_url": "https://api.github.com/users/danielcdh/followers", "following_url": "https://api.github.com/users/danielcdh/following{/other_user}", "gists_url": "https://api.github.com/users/danielcdh/gists{/gist_id}", "starred_url": "https://api.github.com/users/danielcdh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/danielcdh/subscriptions", "organizations_url": "https://api.github.com/users/danielcdh/orgs", "repos_url": "https://api.github.com/users/danielcdh/repos", "events_url": "https://api.github.com/users/danielcdh/events{/privacy}", "received_events_url": "https://api.github.com/users/danielcdh/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "870c7fa03a0d97a77092fab5ab397b25ef1f6d6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/870c7fa03a0d97a77092fab5ab397b25ef1f6d6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/870c7fa03a0d97a77092fab5ab397b25ef1f6d6b"}], "stats": {"total": 21, "additions": 11, "deletions": 10}, "files": [{"sha": "be8026a779d8639020011fbd43521e6807647bd0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0e66512ee26dec9b4e20b612bab88f6163fe48a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0e66512ee26dec9b4e20b612bab88f6163fe48a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b0e66512ee26dec9b4e20b612bab88f6163fe48a", "patch": "@@ -1,3 +1,8 @@\n+2014-05-16  Dehao Chen  <dehao@google.com>\n+\n+\t* cfghooks.c (make_forwarder_block): Use direct computation to\n+\tget fall-through edge's count and frequency.\n+\n 2014-02-07  Benno Schulenberg  <bensberg@justemail.net>\n \n \t* config/arc/arc.c (arc_init): Fix typo in error message."}, {"sha": "66313df85acc349a641572af9770fdc64e41b83b", "filename": "gcc/cfghooks.c", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b0e66512ee26dec9b4e20b612bab88f6163fe48a/gcc%2Fcfghooks.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b0e66512ee26dec9b4e20b612bab88f6163fe48a/gcc%2Fcfghooks.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfghooks.c?ref=b0e66512ee26dec9b4e20b612bab88f6163fe48a", "patch": "@@ -833,6 +833,9 @@ make_forwarder_block (basic_block bb, bool (*redirect_edge_p) (edge),\n \n   fallthru = split_block_after_labels (bb);\n   dummy = fallthru->src;\n+  dummy->count = 0;\n+  dummy->frequency = 0;\n+  fallthru->count = 0;\n   bb = fallthru->dest;\n \n   /* Redirect back edges we want to keep.  */\n@@ -842,20 +845,13 @@ make_forwarder_block (basic_block bb, bool (*redirect_edge_p) (edge),\n \n       if (redirect_edge_p (e))\n \t{\n+\t  dummy->frequency += EDGE_FREQUENCY (e);\n+\t  dummy->count += e->count;\n+\t  fallthru->count += e->count;\n \t  ei_next (&ei);\n \t  continue;\n \t}\n \n-      dummy->frequency -= EDGE_FREQUENCY (e);\n-      dummy->count -= e->count;\n-      if (dummy->frequency < 0)\n-\tdummy->frequency = 0;\n-      if (dummy->count < 0)\n-\tdummy->count = 0;\n-      fallthru->count -= e->count;\n-      if (fallthru->count < 0)\n-\tfallthru->count = 0;\n-\n       e_src = e->src;\n       jump = redirect_edge_and_branch_force (e, bb);\n       if (jump != NULL)"}]}