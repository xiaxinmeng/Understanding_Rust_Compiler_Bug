{"sha": "80297f897758f59071968ddff2a04a8d11481117", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODAyOTdmODk3NzU4ZjU5MDcxOTY4ZGRmZjJhMDRhOGQxMTQ4MTExNw==", "commit": {"author": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2020-09-14T08:03:08Z"}, "committer": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2020-09-15T10:25:09Z"}, "message": "arm: Fix testisms introduced with fix for pr target/95646\n\nThis patch changes the test to use the effective-target machinery disables the\nerror message \"ARMv8-M Security Extensions incompatible with selected FPU\" when\n-mfloat-abi=soft.\nFurther changes 'asm' to '__asm__' to avoid failures with '-std=' options.\n\ngcc/ChangeLog:\n2020-07-06  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\t* config/arm/arm.c (arm_options_perform_arch_sanity_checks): Do not\n\tcheck +D32 for CMSE if -mfloat-abi=soft\n\ngcc/testsuite/ChangeLog:\n2020-07-06  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\t* gcc.target/arm/pr95646.c: Fix testism.", "tree": {"sha": "985ae7b5d0f9d7aaa8ea76a34b4fecc943d957d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/985ae7b5d0f9d7aaa8ea76a34b4fecc943d957d6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/80297f897758f59071968ddff2a04a8d11481117", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80297f897758f59071968ddff2a04a8d11481117", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80297f897758f59071968ddff2a04a8d11481117", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80297f897758f59071968ddff2a04a8d11481117/comments", "author": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ecc3135a4a264b66c163ef32e815a99746b81800", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ecc3135a4a264b66c163ef32e815a99746b81800", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ecc3135a4a264b66c163ef32e815a99746b81800"}], "stats": {"total": 13, "additions": 5, "deletions": 8}, "files": [{"sha": "7d9503c9f86a04773bec2ee38b478f3037be34cd", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/80297f897758f59071968ddff2a04a8d11481117/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/80297f897758f59071968ddff2a04a8d11481117/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=80297f897758f59071968ddff2a04a8d11481117", "patch": "@@ -3820,7 +3820,7 @@ arm_options_perform_arch_sanity_checks (void)\n \n   /* We don't clear D16-D31 VFP registers for cmse_nonsecure_call functions\n      and ARMv8-M Baseline and Mainline do not allow such configuration.  */\n-  if (use_cmse && LAST_VFP_REGNUM > LAST_LO_VFP_REGNUM)\n+  if (use_cmse && TARGET_HARD_FLOAT && LAST_VFP_REGNUM > LAST_LO_VFP_REGNUM)\n     error (\"ARMv8-M Security Extensions incompatible with selected FPU\");\n \n "}, {"sha": "cde1b2d9d36a4e39cd916fdcc9eef424a22bd589", "filename": "gcc/testsuite/gcc.target/arm/pr95646.c", "status": "modified", "additions": 4, "deletions": 7, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/80297f897758f59071968ddff2a04a8d11481117/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr95646.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/80297f897758f59071968ddff2a04a8d11481117/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr95646.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fpr95646.c?ref=80297f897758f59071968ddff2a04a8d11481117", "patch": "@@ -1,10 +1,7 @@\n /* { dg-do compile } */\n-/* { dg-skip-if \"avoid conflicting multilib options\" { *-*-* } { \"-march=*\" } { \"-march=armv8-m.base\" } } */\n-/* { dg-skip-if \"avoid conflicting multilib options\" { *-*-* } { \"-mcpu=*\" } { \"-mcpu=cortex-m23\" } } */\n-/* { dg-skip-if \"avoid conflicting multilib options\" { *-*-* } { \"-mfpu=*\" } { } } */\n-/* { dg-skip-if \"avoid conflicting multilib options\" { *-*-* } { \"-mfloat-abi=*\" } { \"-mfloat-abi=soft\" } } */\n-/* { dg-options \"-mcpu=cortex-m23 -mcmse\" } */\n-/* { dg-additional-options \"-Os\" } */\n+/* { dg-require-effective-target arm_arch_v8m_base_ok } */\n+/* { dg-add-options arm_arch_v8m_base } */\n+/* { dg-additional-options \"-mcmse -Os\" } */\n /* { dg-final { check-function-bodies \"**\" \"\" } } */\n \n int __attribute__ ((cmse_nonsecure_entry))\n@@ -27,6 +24,6 @@ foo (void)\n int __attribute__ ((cmse_nonsecure_entry))\n bar (void)\n {\n-  asm (\"\": : : \"r9\");\n+  __asm__ (\"\" : : : \"r9\");\n   return 1;\n }"}]}