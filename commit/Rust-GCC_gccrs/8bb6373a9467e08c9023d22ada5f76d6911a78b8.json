{"sha": "8bb6373a9467e08c9023d22ada5f76d6911a78b8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGJiNjM3M2E5NDY3ZTA4YzkwMjNkMjJhZGE1Zjc2ZDY5MTFhNzhiOA==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2015-06-01T12:43:47Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2015-06-01T12:43:47Z"}, "message": "Change use to type-based pool allocator in\n\n\t* sel-sched-ir.c (alloc_sched_pools): Use new type-based pool allocator.\n\t(free_sched_pools): Likewise.\n\t* sel-sched-ir.h (_list_alloc): Likewise.\n\t(_list_remove): Likewise.\n\nFrom-SVN: r223959", "tree": {"sha": "fd9185fa35ea5f4a73d5b9a619abba6cc642136f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fd9185fa35ea5f4a73d5b9a619abba6cc642136f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8bb6373a9467e08c9023d22ada5f76d6911a78b8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8bb6373a9467e08c9023d22ada5f76d6911a78b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8bb6373a9467e08c9023d22ada5f76d6911a78b8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8bb6373a9467e08c9023d22ada5f76d6911a78b8/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5f8446975976236285093df11f5c6318b3cea58c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f8446975976236285093df11f5c6318b3cea58c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f8446975976236285093df11f5c6318b3cea58c"}], "stats": {"total": 20, "additions": 12, "deletions": 8}, "files": [{"sha": "42b567081debb77a28373a42cfac8d6c1f9de5ec", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8bb6373a9467e08c9023d22ada5f76d6911a78b8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8bb6373a9467e08c9023d22ada5f76d6911a78b8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8bb6373a9467e08c9023d22ada5f76d6911a78b8", "patch": "@@ -1,3 +1,10 @@\n+2015-06-01  Martin Liska  <mliska@suse.cz>\n+\n+\t* sel-sched-ir.c (alloc_sched_pools): Use new type-based pool allocator.\n+\t(free_sched_pools): Likewise.\n+\t* sel-sched-ir.h (_list_alloc): Likewise.\n+\t(_list_remove): Likewise.\n+\n 2015-06-01  Martin Liska  <mliska@suse.cz>\n \n \t* stmt.c (add_case_node): Use new type-based pool allocator."}, {"sha": "ffaba56de00296338f0555e62bdc66928547909a", "filename": "gcc/sel-sched-ir.c", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8bb6373a9467e08c9023d22ada5f76d6911a78b8/gcc%2Fsel-sched-ir.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8bb6373a9467e08c9023d22ada5f76d6911a78b8/gcc%2Fsel-sched-ir.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched-ir.c?ref=8bb6373a9467e08c9023d22ada5f76d6911a78b8", "patch": "@@ -70,7 +70,7 @@ vec<sel_region_bb_info_def>\n     sel_region_bb_info = vNULL;\n \n /* A pool for allocating all lists.  */\n-alloc_pool sched_lists_pool;\n+pool_allocator<_list_node> sched_lists_pool (\"sel-sched-lists\", 500);\n \n /* This contains information about successors for compute_av_set.  */\n struct succs_info current_succs;\n@@ -5030,9 +5030,6 @@ alloc_sched_pools (void)\n   succs_info_pool.size = succs_size;\n   succs_info_pool.top = -1;\n   succs_info_pool.max_top = -1;\n-\n-  sched_lists_pool = create_alloc_pool (\"sel-sched-lists\",\n-                                        sizeof (struct _list_node), 500);\n }\n \n /* Free the pools.  */\n@@ -5041,7 +5038,7 @@ free_sched_pools (void)\n {\n   int i;\n \n-  free_alloc_pool (sched_lists_pool);\n+  sched_lists_pool.release ();\n   gcc_assert (succs_info_pool.top == -1);\n   for (i = 0; i <= succs_info_pool.max_top; i++)\n     {"}, {"sha": "3707a87c216d87b7ae7cc1c150465d73f10f34c0", "filename": "gcc/sel-sched-ir.h", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8bb6373a9467e08c9023d22ada5f76d6911a78b8/gcc%2Fsel-sched-ir.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8bb6373a9467e08c9023d22ada5f76d6911a78b8/gcc%2Fsel-sched-ir.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched-ir.h?ref=8bb6373a9467e08c9023d22ada5f76d6911a78b8", "patch": "@@ -364,12 +364,12 @@ struct _list_node\n /* _list_t functions.\n    All of _*list_* functions are used through accessor macros, thus\n    we can't move them in sel-sched-ir.c.  */\n-extern alloc_pool sched_lists_pool;\n+extern pool_allocator<_list_node> sched_lists_pool;\n \n static inline _list_t\n _list_alloc (void)\n {\n-  return (_list_t) pool_alloc (sched_lists_pool);\n+  return sched_lists_pool.allocate ();\n }\n \n static inline void\n@@ -395,7 +395,7 @@ _list_remove (_list_t *lp)\n   _list_t n = *lp;\n \n   *lp = _LIST_NEXT (n);\n-  pool_free (sched_lists_pool, n);\n+  sched_lists_pool.remove (n);\n }\n \n static inline void"}]}