{"sha": "06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZlMWJhY2U5NWNlY2U0ZTZjZDg5Y2U3ZWZiYTdlMzdiN2JmY2YyYg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-11-05T16:15:04Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-11-05T16:15:04Z"}, "message": "(mulsidi3-1, mulsidi3, umulsidi3-1, umulsidi3): Enable.\n\n(smulsi3_highpart-1, smulsi3_highpart): New patterns.\n(umulsi3_highpart-1, umulsi3_highpart): Likewise.\n(movdi-1): Add r/x constraint.\n\nFrom-SVN: r10559", "tree": {"sha": "2538b6afc2b2ea0e1c89073f793f0fb51e286b53", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2538b6afc2b2ea0e1c89073f793f0fb51e286b53"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b/comments", "author": null, "committer": null, "parents": [{"sha": "68958847e778f6881d7c3d02de0a5c1bdaa742cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68958847e778f6881d7c3d02de0a5c1bdaa742cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68958847e778f6881d7c3d02de0a5c1bdaa742cf"}], "stats": {"total": 68, "additions": 53, "deletions": 15}, "files": [{"sha": "cfe968e9e33dfafa8f31a632ca6e6b7312437dd3", "filename": "gcc/config/sh/sh.md", "status": "modified", "additions": 53, "deletions": 15, "changes": 68, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b/gcc%2Fconfig%2Fsh%2Fsh.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b/gcc%2Fconfig%2Fsh%2Fsh.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.md?ref=06e1bace95cece4e6cd89ce7efba7e37b7bfcf2b", "patch": "@@ -506,46 +506,84 @@\n     }\n }\")\n \n-;; ??? Why is this disabled?\n-\n (define_insn \"\"\n   [(set (reg:DI 20)\n \t(mult:DI (sign_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"r\"))\n \t\t (sign_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"r\"))))]\n-  \"(TARGET_SH2) && 0\"\n+  \"TARGET_SH2\"\n   \"dmuls.l\t%2,%1\"\n   [(set_attr \"type\" \"dmpy\")])\n \n-;; ??? Why is this disabled?\n-\n (define_expand \"mulsidi3\"\n   [(set (reg:DI 20)\n \t(mult:DI (sign_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"\"))\n \t\t (sign_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"\"))))\n    (set (match_operand:DI 0 \"arith_reg_operand\" \"\")\n \t(reg:DI 20))]\n-  \"(TARGET_SH2) && 0\"\n+  \"TARGET_SH2\"\n   \"\")\n \n-;; ??? Why is this disabled?\n-\n (define_insn \"\"\n   [(set (reg:DI 20)\n \t(mult:DI (zero_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"r\"))\n \t\t (zero_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"r\"))))]\n-  \"(TARGET_SH2) && 0\"\n+  \"TARGET_SH2\"\n   \"dmulu.l\t%2,%1\"\n   [(set_attr \"type\" \"dmpy\")])\n \n-;; ??? Why is this disabled?\n-\n (define_expand \"umulsidi3\"\n   [(set (reg:DI 20)\n \t(mult:DI (zero_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"\"))\n \t\t (zero_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"\"))))\n    (set (match_operand:DI 0 \"arith_reg_operand\" \"\")\n \t(reg:DI 20))]\n-  \"(TARGET_SH2) && 0\"\n+  \"TARGET_SH2\"\n+  \"\")\n+\n+(define_insn \"\"\n+  [(set (reg:SI 20)\n+\t(truncate:SI\n+\t (lshiftrt:DI (mult:DI (sign_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"r\"))\n+\t\t\t       (sign_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"r\")))\n+\t\t      (const_int 32))))\n+   (clobber (reg:SI 21))]\n+  \"TARGET_SH2\"\n+  \"dmuls.l\t%2,%1\"\n+  [(set_attr \"type\" \"dmpy\")])\n+\n+(define_expand \"smulsi3_highpart\"\n+  [(parallel [(set (reg:SI 20)\n+\t\t   (truncate:SI\n+\t\t    (lshiftrt:DI (mult:DI (sign_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"\"))\n+\t\t\t\t\t  (sign_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"\")))\n+\t\t\t\t (const_int 32))))\n+\t      (clobber (reg:SI 21))])\n+   (set (match_operand:SI 0 \"arith_reg_operand\" \"\")\n+\t(reg:SI 20))]\n+  \"TARGET_SH2\"\n+  \"\")\n+\n+(define_insn \"\"\n+  [(set (reg:SI 20)\n+\t(truncate:SI\n+\t (lshiftrt:DI (mult:DI (zero_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"r\"))\n+\t\t\t       (zero_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"r\")))\n+\t\t      (const_int 32))))\n+   (clobber (reg:SI 21))]\n+  \"TARGET_SH2\"\n+  \"dmulu.l\t%2,%1\"\n+  [(set_attr \"type\" \"dmpy\")])\n+\n+(define_expand \"umulsi3_highpart\"\n+  [(parallel [(set (reg:SI 20)\n+\t\t   (truncate:SI\n+\t\t    (lshiftrt:DI (mult:DI (zero_extend:DI (match_operand:SI 1 \"arith_reg_operand\" \"\"))\n+\t\t\t\t\t  (zero_extend:DI (match_operand:SI 2 \"arith_reg_operand\" \"\")))\n+\t\t\t\t (const_int 32))))\n+\t      (clobber (reg:SI 21))])\n+   (set (match_operand:SI 0 \"arith_reg_operand\" \"\")\n+\t(reg:SI 20))]\n+  \"TARGET_SH2\"\n   \"\")\n \f\n ;; -------------------------------------------------------------------------\n@@ -1160,13 +1198,13 @@\n ;; ??? This should be a define expand.\n \n (define_insn \"\"\n-  [(set (match_operand:DI 0 \"general_movdst_operand\" \"=r,r,r,m,r\")\n-\t(match_operand:DI 1 \"general_movsrc_operand\" \"Q,r,m,r,i\"))]\n+  [(set (match_operand:DI 0 \"general_movdst_operand\" \"=r,r,r,m,r,r\")\n+\t(match_operand:DI 1 \"general_movsrc_operand\" \"Q,r,m,r,i,x\"))]\n   \"arith_reg_operand (operands[0], DImode)\n    || arith_reg_operand (operands[1], DImode)\"\n   \"* return output_movedouble (insn, operands, DImode);\"\n   [(set_attr \"length\" \"4\")\n-   (set_attr \"type\" \"pcload,move,load,store,move\")])\n+   (set_attr \"type\" \"pcload,move,load,store,move,move\")])\n \n ;; If the output is a register and the input is memory or a register, we have\n ;; to be careful and see which word needs to be loaded first.  "}]}