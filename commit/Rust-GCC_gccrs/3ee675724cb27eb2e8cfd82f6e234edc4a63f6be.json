{"sha": "3ee675724cb27eb2e8cfd82f6e234edc4a63f6be", "node_id": "C_kwDOANBUbNoAKDNlZTY3NTcyNGNiMjdlYjJlOGNmZDgyZjZlMjM0ZWRjNGE2M2Y2YmU", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-10-25T08:04:56Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-10-25T09:15:25Z"}, "message": "Move NOP stripping in SCEV analysis\n\nThe following moves a pair of STRIP_USELESS_TYPE_CONVERSIONS to\nwhere it belongs and adds a comment on why we handle GENERIC\nthere at all.\n\n\t* tree-scalar-evolution.cc (follow_ssa_edge_expr): Move\n\tSTRIP_USELESS_TYPE_CONVERSIONS to where it matters.", "tree": {"sha": "d37923c459c58f4e436d9922a2761c6c44b71657", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d37923c459c58f4e436d9922a2761c6c44b71657"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d93171509aa7ca23148508b96f1c1f70b941d808", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d93171509aa7ca23148508b96f1c1f70b941d808", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d93171509aa7ca23148508b96f1c1f70b941d808"}], "stats": {"total": 6, "additions": 4, "deletions": 2}, "files": [{"sha": "8b92709432412da08ead9297a99de0a6184b5361", "filename": "gcc/tree-scalar-evolution.cc", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be/gcc%2Ftree-scalar-evolution.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ee675724cb27eb2e8cfd82f6e234edc4a63f6be/gcc%2Ftree-scalar-evolution.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-scalar-evolution.cc?ref=3ee675724cb27eb2e8cfd82f6e234edc4a63f6be", "patch": "@@ -1214,6 +1214,8 @@ follow_ssa_edge_expr (class loop *loop, gimple *at_stmt, tree expr,\n     {\n       code = TREE_CODE (expr);\n       type = TREE_TYPE (expr);\n+      /* Via follow_ssa_edge_inner_loop_phi we arrive here with the\n+\t GENERIC scalar evolution of the inner loop.  */\n       switch (code)\n \t{\n \tCASE_CONVERT:\n@@ -1224,6 +1226,8 @@ follow_ssa_edge_expr (class loop *loop, gimple *at_stmt, tree expr,\n \tcase MINUS_EXPR:\n \t  rhs0 = TREE_OPERAND (expr, 0);\n \t  rhs1 = TREE_OPERAND (expr, 1);\n+\t  STRIP_USELESS_TYPE_CONVERSION (rhs0);\n+\t  STRIP_USELESS_TYPE_CONVERSION (rhs1);\n \t  break;\n \tdefault:\n \t  rhs0 = expr;\n@@ -1260,8 +1264,6 @@ follow_ssa_edge_expr (class loop *loop, gimple *at_stmt, tree expr,\n     case PLUS_EXPR:\n     case MINUS_EXPR:\n       /* This case is under the form \"rhs0 +- rhs1\".  */\n-      STRIP_USELESS_TYPE_CONVERSION (rhs0);\n-      STRIP_USELESS_TYPE_CONVERSION (rhs1);\n       if (TREE_CODE (rhs0) == SSA_NAME\n \t  && (TREE_CODE (rhs1) != SSA_NAME || code == MINUS_EXPR))\n \t{"}]}