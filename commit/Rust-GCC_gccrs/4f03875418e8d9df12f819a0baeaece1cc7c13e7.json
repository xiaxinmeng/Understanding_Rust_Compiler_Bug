{"sha": "4f03875418e8d9df12f819a0baeaece1cc7c13e7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGYwMzg3NTQxOGU4ZDlkZjEyZjgxOWEwYmFlYWVjZTFjYzdjMTNlNw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-09-13T18:32:42Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-09-13T18:32:42Z"}, "message": "re PR libstdc++/58415 (__sso_string_base move constructor does not null terminate local data when moving from empty string)\n\n2013-09-13  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR libstdc++/58415\n\t* include/ext/sso_string_base.h (__sso_string_base<>::\n\t__sso_string_base(__sso_string_base&&)): Fix thinkos about\n\t_M_length vs _M_set_length.\n\t* testsuite/ext/vstring/cons/58415-1.cc: New.\n\t* testsuite/ext/vstring/cons/58415-2.cc: Likewise.\n\nFrom-SVN: r202574", "tree": {"sha": "cb71b780b49ea920aefd6402f91037c07f8a7678", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cb71b780b49ea920aefd6402f91037c07f8a7678"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4f03875418e8d9df12f819a0baeaece1cc7c13e7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f03875418e8d9df12f819a0baeaece1cc7c13e7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f03875418e8d9df12f819a0baeaece1cc7c13e7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f03875418e8d9df12f819a0baeaece1cc7c13e7/comments", "author": null, "committer": null, "parents": [{"sha": "88b0e79e45b76cece89ee1ac4a2feca4524a9b55", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88b0e79e45b76cece89ee1ac4a2feca4524a9b55", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88b0e79e45b76cece89ee1ac4a2feca4524a9b55"}], "stats": {"total": 92, "additions": 90, "deletions": 2}, "files": [{"sha": "8e0bfb70f8c9ca448aaf8568ffe9257ba2275671", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=4f03875418e8d9df12f819a0baeaece1cc7c13e7", "patch": "@@ -1,3 +1,12 @@\n+2013-09-13  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR libstdc++/58415\n+\t* include/ext/sso_string_base.h (__sso_string_base<>::\n+\t__sso_string_base(__sso_string_base&&)): Fix thinkos about\n+\t_M_length vs _M_set_length.\n+\t* testsuite/ext/vstring/cons/58415-1.cc: New.\n+\t* testsuite/ext/vstring/cons/58415-2.cc: Likewise.\n+\n 2013-09-12  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR libstdc++/58403"}, {"sha": "6cb4302b6880c8aefc5322d19ed44a8d8ce108d7", "filename": "libstdc++-v3/include/ext/sso_string_base.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2Finclude%2Fext%2Fsso_string_base.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2Finclude%2Fext%2Fsso_string_base.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fext%2Fsso_string_base.h?ref=4f03875418e8d9df12f819a0baeaece1cc7c13e7", "patch": "@@ -361,9 +361,9 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t  _M_capacity(__rcs._M_allocated_capacity);\n \t}\n \n-      _M_length(__rcs._M_length());\n-      __rcs._M_length(0);\n+      _M_set_length(__rcs._M_length());\n       __rcs._M_data(__rcs._M_local_data);\n+      __rcs._M_set_length(0);\n     }\n #endif\n "}, {"sha": "cfcb8938e26a00fbda218839d3ebd438783d736e", "filename": "libstdc++-v3/testsuite/ext/vstring/cons/58415-1.cc", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Fcons%2F58415-1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Fcons%2F58415-1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Fcons%2F58415-1.cc?ref=4f03875418e8d9df12f819a0baeaece1cc7c13e7", "patch": "@@ -0,0 +1,41 @@\n+// { dg-options \"-std=gnu++11\" }\n+// { dg-require-string-conversions \"\" }\n+\n+// Copyright (C) 2013 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+#include <ext/vstring.h>\n+#include <testsuite_hooks.h>\n+\n+typedef __gnu_cxx::__versa_string<char> string;\n+\n+void test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  string s1(\"string\");\n+  string s2(\"\");\n+  std::swap(s1, s2);\n+\n+  VERIFY( s1.c_str()[0] == '\\0' );\n+}\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}, {"sha": "9ba192ab228c547bff2eaf36f53aeeef9793527d", "filename": "libstdc++-v3/testsuite/ext/vstring/cons/58415-2.cc", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Fcons%2F58415-2.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f03875418e8d9df12f819a0baeaece1cc7c13e7/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Fcons%2F58415-2.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Fcons%2F58415-2.cc?ref=4f03875418e8d9df12f819a0baeaece1cc7c13e7", "patch": "@@ -0,0 +1,38 @@\n+// { dg-options \"-std=gnu++11\" }\n+// { dg-require-string-conversions \"\" }\n+\n+// Copyright (C) 2013 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+#include <ext/vstring.h>\n+#include <testsuite_hooks.h>\n+\n+typedef __gnu_cxx::__versa_string<char> string;\n+\n+void test01()\n+{\n+  string s1;\n+  string s2 = std::move(s1);\n+\n+  VERIFY( s2.c_str()[0] == '\\0' );\n+}\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}]}