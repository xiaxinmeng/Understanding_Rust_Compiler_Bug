{"sha": "41c3713a005950571de21c5755ae060e8b62c1aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDFjMzcxM2EwMDU5NTA1NzFkZTIxYzU3NTVhZTA2MGU4YjYyYzFhYQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@acm.org", "date": "2015-09-09T14:07:01Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2015-09-09T14:07:01Z"}, "message": "nvptx.md (atomic_compare_and_swap<mode>): Use sel_truesi, not andsi.\n\n\t* config/nvptx/nvptx.md (atomic_compare_and_swap<mode>): Use\n\tsel_truesi, not andsi.\n\nFrom-SVN: r227587", "tree": {"sha": "26dfbcf9ccb9b9cd028ed36114887e9cce217ced", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26dfbcf9ccb9b9cd028ed36114887e9cce217ced"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/41c3713a005950571de21c5755ae060e8b62c1aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41c3713a005950571de21c5755ae060e8b62c1aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41c3713a005950571de21c5755ae060e8b62c1aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41c3713a005950571de21c5755ae060e8b62c1aa/comments", "author": {"login": "urnathan", "id": 13103001, "node_id": "MDQ6VXNlcjEzMTAzMDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13103001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urnathan", "html_url": "https://github.com/urnathan", "followers_url": "https://api.github.com/users/urnathan/followers", "following_url": "https://api.github.com/users/urnathan/following{/other_user}", "gists_url": "https://api.github.com/users/urnathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/urnathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urnathan/subscriptions", "organizations_url": "https://api.github.com/users/urnathan/orgs", "repos_url": "https://api.github.com/users/urnathan/repos", "events_url": "https://api.github.com/users/urnathan/events{/privacy}", "received_events_url": "https://api.github.com/users/urnathan/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "956db28eb5782cc4f86f146d9250ca5f0f16e3ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/956db28eb5782cc4f86f146d9250ca5f0f16e3ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/956db28eb5782cc4f86f146d9250ca5f0f16e3ce"}], "stats": {"total": 19, "additions": 11, "deletions": 8}, "files": [{"sha": "ed788ff4d344f4b0803fa4b21f6025d81b8368d7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41c3713a005950571de21c5755ae060e8b62c1aa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41c3713a005950571de21c5755ae060e8b62c1aa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=41c3713a005950571de21c5755ae060e8b62c1aa", "patch": "@@ -1,3 +1,8 @@\n+2015-09-09  Nathan Sidwell  <nathan@acm.org>\n+\n+\t* config/nvptx/nvptx.md (atomic_compare_and_swap<mode>): Use\n+\tsel_truesi, not andsi.\n+\n 2015-09-09  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* config/arm/arm.md (*subsi3_compare0): Rename to..."}, {"sha": "f2ec3e4b0bf7490a66debaa67a907fe0ec7d97f2", "filename": "gcc/config/nvptx/nvptx.md", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41c3713a005950571de21c5755ae060e8b62c1aa/gcc%2Fconfig%2Fnvptx%2Fnvptx.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41c3713a005950571de21c5755ae060e8b62c1aa/gcc%2Fconfig%2Fnvptx%2Fnvptx.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnvptx%2Fnvptx.md?ref=41c3713a005950571de21c5755ae060e8b62c1aa", "patch": "@@ -1351,14 +1351,12 @@\n    (match_operand:SI 7 \"const_int_operand\")]\t\t;; failure model\n   \"\"\n {\n-  emit_insn (gen_atomic_compare_and_swap<mode>_1 (operands[1], operands[2], operands[3],\n-\t\t\t\t\t          operands[4], operands[6]));\n-\n-  rtx tmp = gen_reg_rtx (GET_MODE (operands[0]));\n-  emit_insn (gen_cstore<mode>4 (tmp,\n-\t\t\t\tgen_rtx_EQ (SImode, operands[1], operands[3]),\n-\t\t\t\toperands[1], operands[3]));\n-  emit_insn (gen_andsi3 (operands[0], tmp, GEN_INT (1)));\n+  emit_insn (gen_atomic_compare_and_swap<mode>_1\n+    (operands[1], operands[2], operands[3], operands[4], operands[6]));\n+\n+  rtx cond = gen_reg_rtx (BImode);\n+  emit_move_insn (cond, gen_rtx_EQ (BImode, operands[1], operands[3]));\n+  emit_insn (gen_sel_truesi (operands[0], cond, GEN_INT (1), GEN_INT (0)));\n   DONE;\n })\n "}]}