{"sha": "40ddf499b7eecc106fc17552e09b807dacb14ccd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDBkZGY0OTliN2VlY2MxMDZmYzE3NTUyZTA5YjgwN2RhY2IxNGNjZA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-02-13T11:50:49Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-02-13T11:50:49Z"}, "message": "(do_include, is_system_include, open_include_file): Handle\nDIR_SEPARATOR.\n\nFrom-SVN: r8917", "tree": {"sha": "13dd90483c041eafb0bc3e30024031265ff332f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/13dd90483c041eafb0bc3e30024031265ff332f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40ddf499b7eecc106fc17552e09b807dacb14ccd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40ddf499b7eecc106fc17552e09b807dacb14ccd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40ddf499b7eecc106fc17552e09b807dacb14ccd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40ddf499b7eecc106fc17552e09b807dacb14ccd/comments", "author": null, "committer": null, "parents": [{"sha": "128373acacc776a33747e3edf41297a701dc0e98", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/128373acacc776a33747e3edf41297a701dc0e98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/128373acacc776a33747e3edf41297a701dc0e98"}], "stats": {"total": 38, "additions": 30, "deletions": 8}, "files": [{"sha": "3fcde0903523f8afc56699c11f8813afc421dcc4", "filename": "gcc/cccp.c", "status": "modified", "additions": 30, "deletions": 8, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40ddf499b7eecc106fc17552e09b807dacb14ccd/gcc%2Fcccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40ddf499b7eecc106fc17552e09b807dacb14ccd/gcc%2Fcccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcccp.c?ref=40ddf499b7eecc106fc17552e09b807dacb14ccd", "patch": "@@ -4140,6 +4140,13 @@ do_include (buf, limit, op, keyword)\n \t    search_start = dsp;\n #ifndef VMS\n \t    ep = rindex (nam, '/');\n+#ifdef DIR_SEPARATOR\n+\t    if (ep == NULL) ep = rindex (nam, DIR_SEPARATOR);\n+\t    else {\n+\t      char *tmp = rindex (nam, DIR_SEPARATOR);\n+\t      if (tmp != NULL && tmp > ep) ep = tmp;\n+\t    }\n+#endif\n #else\t\t\t\t/* VMS */\n \t    ep = rindex (nam, ']');\n \t    if (ep == NULL) ep = rindex (nam, '>');\n@@ -4266,7 +4273,11 @@ do_include (buf, limit, op, keyword)\n \n   /* If specified file name is absolute, just open it.  */\n \n-  if (*fbeg == '/') {\n+  if (*fbeg == '/'\n+#ifdef DIR_SEPARATOR\n+      || *fbeg == DIR_SEPARATOR\n+#endif\n+      ) {\n     strncpy (fname, fbeg, flen);\n     fname[flen] = 0;\n     if (redundant_include_p (fname))\n@@ -4520,13 +4531,17 @@ is_system_include (filename)\n       register char *sys_dir = searchptr->fname;\n       register unsigned length = strlen (sys_dir);\n \n-      if (! strncmp (sys_dir, filename, length) && filename[length] == '/')\n-\t{\n-\t  if (searchptr->c_system_include_path)\n-\t    return 2;\n-\t  else\n-\t    return 1;\n-\t}\n+      if (! strncmp (sys_dir, filename, length)\n+\t  && (filename[length] == '/'\n+#ifdef DIR_SEPARATOR\n+\t      || filename[length] == DIR_SEPARATOR\n+#endif\n+\t      )) {\n+\tif (searchptr->c_system_include_path)\n+\t  return 2;\n+\telse\n+\t  return 1;\n+      }\n     }\n   return 0;\n }\n@@ -4708,6 +4723,13 @@ open_include_file (filename, searchptr)\n      in /usr/include/header.gcc and look up types.h in\n      /usr/include/sys/header.gcc.  */\n   p = rindex (filename, '/');\n+#ifdef DIR_SEPARATOR\n+  if (! p) p = rindex (filename, DIR_SEPARATOR);\n+  else {\n+    char *tmp = rindex (filename, DIR_SEPARATOR);\n+    if (tmp != NULL && tmp > p) p = tmp;\n+  }\n+#endif\n   if (! p)\n     p = filename;\n   if (searchptr"}]}