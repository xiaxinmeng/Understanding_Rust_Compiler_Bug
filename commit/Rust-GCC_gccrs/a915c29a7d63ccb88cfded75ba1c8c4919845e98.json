{"sha": "a915c29a7d63ccb88cfded75ba1c8c4919845e98", "node_id": "C_kwDOANBUbNoAKGE5MTVjMjlhN2Q2M2NjYjg4Y2ZkZWQ3NWJhMWM4YzQ5MTk4NDVlOTg", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2023-03-09T22:01:48Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2023-03-10T18:49:45Z"}, "message": "c++: constrained lambda error-recovery [PR108972]\n\nBetter not to ICE after various valid errors.\n\n\tPR c++/108972\n\ngcc/cp/ChangeLog:\n\n\t* lambda.cc (compare_lambda_template_head): Check more\n\tfor error_mark_node.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/cpp2a/concepts-lambda3.C: Run at lower std levels,\n\tbut expect errors.", "tree": {"sha": "20cb58c518a09c09063a761cfcb542a59234853c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/20cb58c518a09c09063a761cfcb542a59234853c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a915c29a7d63ccb88cfded75ba1c8c4919845e98", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a915c29a7d63ccb88cfded75ba1c8c4919845e98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a915c29a7d63ccb88cfded75ba1c8c4919845e98", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a915c29a7d63ccb88cfded75ba1c8c4919845e98/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4d0baeae315ebe7d0ec7682ea3e7c0516027c2b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d0baeae315ebe7d0ec7682ea3e7c0516027c2b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d0baeae315ebe7d0ec7682ea3e7c0516027c2b8"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "212990a21bf7fa3a1c37f85474e8b9bbf3185d3a", "filename": "gcc/cp/lambda.cc", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a915c29a7d63ccb88cfded75ba1c8c4919845e98/gcc%2Fcp%2Flambda.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a915c29a7d63ccb88cfded75ba1c8c4919845e98/gcc%2Fcp%2Flambda.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flambda.cc?ref=a915c29a7d63ccb88cfded75ba1c8c4919845e98", "patch": "@@ -1537,6 +1537,8 @@ compare_lambda_template_head (tree tmpl_a, tree tmpl_b)\n \t  if (parm_a == error_mark_node)\n \t    return false;\n \t  parm_a = TREE_VALUE (parm_a);\n+\t  if (parm_a == error_mark_node)\n+\t    return false;\n \t  if (DECL_VIRTUAL_P (parm_a))\n \t    parm_a = NULL_TREE;\n \t}\n@@ -1548,6 +1550,8 @@ compare_lambda_template_head (tree tmpl_a, tree tmpl_b)\n \t  if (parm_b == error_mark_node)\n \t    return false;\n \t  parm_b = TREE_VALUE (parm_b);\n+\t  if (parm_b == error_mark_node)\n+\t    return false;\n \t  if (DECL_VIRTUAL_P (parm_b))\n \t    parm_b = NULL_TREE;\n \t}"}, {"sha": "b18e6b62aa4312d9b4a2707bf9cf945db7122dc4", "filename": "gcc/testsuite/g++.dg/cpp2a/concepts-lambda3.C", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a915c29a7d63ccb88cfded75ba1c8c4919845e98/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-lambda3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a915c29a7d63ccb88cfded75ba1c8c4919845e98/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-lambda3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Fconcepts-lambda3.C?ref=a915c29a7d63ccb88cfded75ba1c8c4919845e98", "patch": "@@ -1,4 +1,5 @@\n-// { dg-do run { target c++20 } }\n+// { dg-do run }\n+// { dg-excess-errors \"\" { target { ! concepts } } } (PR108972)\n \n template<typename T>\n concept C1 = __is_same_as(T, int)\n@@ -61,4 +62,3 @@ int main(int, char**)\n \n   return 0;\n }\n-"}]}