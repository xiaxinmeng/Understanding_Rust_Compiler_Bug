{"sha": "93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTNmMWRiYzdjZGNjNGIzMWVhNDA2MWVmYjRjMmFjZjJkNGY4MWViOA==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2021-08-11T21:11:19Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2021-08-11T22:39:34Z"}, "message": "libstdc++: Fix test that fails randomly [PR101866]\n\nThis test assumes that the same sequence of three values cannot occur,\nwhich is incorect. It's unlikely, but not impossible.\n\nPerform the check in a loop, so that in the unlikely event of an\nidentical sequence, we retry. If the library code is buggy it will keep\nproducing the same sequence and the test will time out. If the code is\nworking correctly then we will usually break out of the loop after one\niteration, or very rarely after two or three.\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/101866\n\t* testsuite/experimental/random/randint.cc: Loop and retry if\n\treseed() produces the same sequence.", "tree": {"sha": "9d6b82308d1dc545c306af1fe79dbcde90f0a0fc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9d6b82308d1dc545c306af1fe79dbcde90f0a0fc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "873273449a944d7796d08ce6fae06eabcab7bf65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/873273449a944d7796d08ce6fae06eabcab7bf65", "html_url": "https://github.com/Rust-GCC/gccrs/commit/873273449a944d7796d08ce6fae06eabcab7bf65"}], "stats": {"total": 18, "additions": 9, "deletions": 9}, "files": [{"sha": "e05151e5ea09cf8fc18c80b8557d8c75771a8eb4", "filename": "libstdc++-v3/testsuite/experimental/random/randint.cc", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Frandom%2Frandint.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Frandom%2Frandint.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Frandom%2Frandint.cc?ref=93f1dbc7cdcc4b31ea4061efb4c2acf2d4f81eb8", "patch": "@@ -34,15 +34,15 @@ test01()\n   }\n \n   std::experimental::reseed(99u);\n-  const long n1[] = {\n+  const int n1[] = {\n     std::experimental::randint(0, 100),\n     std::experimental::randint(0, 100),\n     std::experimental::randint(0, 100),\n     std::experimental::randint(0, 100),\n     std::experimental::randint(0, 100)\n   };\n   std::experimental::reseed(99u);\n-  const long n2[] = {\n+  const int n2[] = {\n     std::experimental::randint(0, 100),\n     std::experimental::randint(0, 100),\n     std::experimental::randint(0, 100),\n@@ -52,13 +52,13 @@ test01()\n   for (int i = 0; i < 5; ++i)\n     VERIFY( n1[i] == n2[i] );\n \n-  std::experimental::reseed();\n-  const long n3[] = {\n-    std::experimental::randint(0, 100),\n-    std::experimental::randint(0, 100),\n-    std::experimental::randint(0, 100)\n-  };\n-  VERIFY( !(n3[0] == n1[0] && n3[1] == n1[1] && n3[2] == n1[2]) );\n+  do\n+  {\n+    std::experimental::reseed();\n+  }\n+  while (std::experimental::randint(0, 100) == n1[0]\n+      && std::experimental::randint(0, 100) == n1[1]\n+      && std::experimental::randint(0, 100) == n1[2]);\n }\n \n void"}]}