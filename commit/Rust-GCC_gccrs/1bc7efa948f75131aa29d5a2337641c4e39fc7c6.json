{"sha": "1bc7efa948f75131aa29d5a2337641c4e39fc7c6", "node_id": "C_kwDOANBUbNoAKDFiYzdlZmE5NDhmNzUxMzFhYTI5ZDVhMjMzNzY0MWM0ZTM5ZmM3YzY", "commit": {"author": {"name": "Tamar Christina", "email": "tamar.christina@arm.com", "date": "2022-11-17T08:14:44Z"}, "committer": {"name": "Tamar Christina", "email": "tamar.christina@arm.com", "date": "2022-11-17T08:14:44Z"}, "message": "middle-end: replace GET_MODE_WIDER_MODE with GET_MODE_NEXT_MODE\n\nAfter the fix to the addsub patch yesterday for bootstrap I had only regtested on x86.\nWhile looking today it seemed the new tests were failing, this was caused\nby a change in the behavior of the GET_MODE_WIDER_MODE macro on trunk.\n\ngcc/ChangeLog:\n\n\t* match.pd: Replace GET_MODE_WIDER_MODE with\n\tcustom code.", "tree": {"sha": "4598b09bba6e389886337b01c379e1ebac74b6c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4598b09bba6e389886337b01c379e1ebac74b6c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1bc7efa948f75131aa29d5a2337641c4e39fc7c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1bc7efa948f75131aa29d5a2337641c4e39fc7c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1bc7efa948f75131aa29d5a2337641c4e39fc7c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1bc7efa948f75131aa29d5a2337641c4e39fc7c6/comments", "author": {"login": "TamarChristinaArm", "id": 48126768, "node_id": "MDQ6VXNlcjQ4MTI2NzY4", "avatar_url": "https://avatars.githubusercontent.com/u/48126768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TamarChristinaArm", "html_url": "https://github.com/TamarChristinaArm", "followers_url": "https://api.github.com/users/TamarChristinaArm/followers", "following_url": "https://api.github.com/users/TamarChristinaArm/following{/other_user}", "gists_url": "https://api.github.com/users/TamarChristinaArm/gists{/gist_id}", "starred_url": "https://api.github.com/users/TamarChristinaArm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TamarChristinaArm/subscriptions", "organizations_url": "https://api.github.com/users/TamarChristinaArm/orgs", "repos_url": "https://api.github.com/users/TamarChristinaArm/repos", "events_url": "https://api.github.com/users/TamarChristinaArm/events{/privacy}", "received_events_url": "https://api.github.com/users/TamarChristinaArm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TamarChristinaArm", "id": 48126768, "node_id": "MDQ6VXNlcjQ4MTI2NzY4", "avatar_url": "https://avatars.githubusercontent.com/u/48126768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TamarChristinaArm", "html_url": "https://github.com/TamarChristinaArm", "followers_url": "https://api.github.com/users/TamarChristinaArm/followers", "following_url": "https://api.github.com/users/TamarChristinaArm/following{/other_user}", "gists_url": "https://api.github.com/users/TamarChristinaArm/gists{/gist_id}", "starred_url": "https://api.github.com/users/TamarChristinaArm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TamarChristinaArm/subscriptions", "organizations_url": "https://api.github.com/users/TamarChristinaArm/orgs", "repos_url": "https://api.github.com/users/TamarChristinaArm/repos", "events_url": "https://api.github.com/users/TamarChristinaArm/events{/privacy}", "received_events_url": "https://api.github.com/users/TamarChristinaArm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2b2f2ee49a33419f9d19f548e6a8ce520818a5d2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b2f2ee49a33419f9d19f548e6a8ce520818a5d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b2f2ee49a33419f9d19f548e6a8ce520818a5d2"}], "stats": {"total": 11, "additions": 7, "deletions": 4}, "files": [{"sha": "fe1178cf0d5038dbab3e3144937b8b8f4d734fc2", "filename": "gcc/match.pd", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1bc7efa948f75131aa29d5a2337641c4e39fc7c6/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1bc7efa948f75131aa29d5a2337641c4e39fc7c6/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=1bc7efa948f75131aa29d5a2337641c4e39fc7c6", "patch": "@@ -7940,12 +7940,15 @@ and,\n        vec_perm_indices sel (builder, 2, nelts);\n        machine_mode vec_mode = TYPE_MODE (type);\n        machine_mode wide_mode;\n+       scalar_mode wide_elt_mode;\n+       poly_uint64 wide_nunits;\n+       scalar_mode inner_mode = GET_MODE_INNER (vec_mode);\n      }\n      (if (sel.series_p (0, 2, 0, 2)\n-          && GET_MODE_WIDER_MODE (vec_mode).exists (&wide_mode)\n-\t  && VECTOR_MODE_P (wide_mode)\n-\t  && (GET_MODE_UNIT_BITSIZE (vec_mode) * 2\n-\t      == GET_MODE_UNIT_BITSIZE (wide_mode)))\n+\t  && GET_MODE_2XWIDER_MODE (inner_mode).exists (&wide_elt_mode)\n+\t  && multiple_p (GET_MODE_NUNITS (vec_mode), 2, &wide_nunits)\n+\t  && related_vector_mode (vec_mode, wide_elt_mode,\n+\t\t\t\t  wide_nunits).exists (&wide_mode))\n \t(with\n \t {\n \t   tree stype"}]}