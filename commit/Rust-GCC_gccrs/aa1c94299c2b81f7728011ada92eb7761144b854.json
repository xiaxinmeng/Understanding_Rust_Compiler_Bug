{"sha": "aa1c94299c2b81f7728011ada92eb7761144b854", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWExYzk0Mjk5YzJiODFmNzcyODAxMWFkYTkyZWI3NzYxMTQ0Yjg1NA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2018-03-21T21:48:47Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-03-21T21:48:47Z"}, "message": "re PR c/84999 (ICE in make_vector_type, at tree.c:9561)\n\n\tPR c/84999\n\t* c-typeck.c (build_binary_op): If c_common_type_for_size fails when\n\tbuilding vector comparison, diagnose it and return error_mark_node.\n\n\t* c-c++-common/pr84999.c: New test.\n\nFrom-SVN: r258747", "tree": {"sha": "adb31ecef06999c3280ce6a8428edd5a4a32d542", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/adb31ecef06999c3280ce6a8428edd5a4a32d542"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aa1c94299c2b81f7728011ada92eb7761144b854", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa1c94299c2b81f7728011ada92eb7761144b854", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa1c94299c2b81f7728011ada92eb7761144b854", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa1c94299c2b81f7728011ada92eb7761144b854/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e299d4fc1a9a3d30ed9c1b7df743b2fd84c9f03a"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "c1e204d1e1b0dd118183f700232ec9ace65261df", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=aa1c94299c2b81f7728011ada92eb7761144b854", "patch": "@@ -1,3 +1,9 @@\n+2018-03-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/84999\n+\t* c-typeck.c (build_binary_op): If c_common_type_for_size fails when\n+\tbuilding vector comparison, diagnose it and return error_mark_node.\n+\n 2018-03-15  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/84853"}, {"sha": "ffd06447f1b555ca84e00b40bce0d00ad0433bb1", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=aa1c94299c2b81f7728011ada92eb7761144b854", "patch": "@@ -11504,6 +11504,13 @@ build_binary_op (location_t location, enum tree_code code,\n           intt = c_common_type_for_size (GET_MODE_BITSIZE\n \t\t\t\t\t (SCALAR_TYPE_MODE\n \t\t\t\t\t  (TREE_TYPE (type0))), 0);\n+\t  if (!intt)\n+\t    {\n+\t      error_at (location, \"could not find an integer type \"\n+\t\t\t\t  \"of the same size as %qT\",\n+\t\t\tTREE_TYPE (type0));\n+\t      return error_mark_node;\n+\t    }\n           result_type = build_opaque_vector_type (intt,\n \t\t\t\t\t\t  TYPE_VECTOR_SUBPARTS (type0));\n           converted = 1;\n@@ -11665,6 +11672,13 @@ build_binary_op (location_t location, enum tree_code code,\n           intt = c_common_type_for_size (GET_MODE_BITSIZE\n \t\t\t\t\t (SCALAR_TYPE_MODE\n \t\t\t\t\t  (TREE_TYPE (type0))), 0);\n+\t  if (!intt)\n+\t    {\n+\t      error_at (location, \"could not find an integer type \"\n+\t\t\t\t  \"of the same size as %qT\",\n+\t\t\tTREE_TYPE (type0));\n+\t      return error_mark_node;\n+\t    }\n           result_type = build_opaque_vector_type (intt,\n \t\t\t\t\t\t  TYPE_VECTOR_SUBPARTS (type0));\n           converted = 1;"}, {"sha": "93dc7a28c681ec33ce8f59eefa68e86594153d7c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=aa1c94299c2b81f7728011ada92eb7761144b854", "patch": "@@ -1,3 +1,8 @@\n+2018-03-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/84999\n+\t* c-c++-common/pr84999.c: New test.\n+\n 2018-03-21  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/84972"}, {"sha": "42d53769a3b9ec2141dc3769d06c5914b9543494", "filename": "gcc/testsuite/c-c++-common/pr84999.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr84999.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa1c94299c2b81f7728011ada92eb7761144b854/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr84999.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr84999.c?ref=aa1c94299c2b81f7728011ada92eb7761144b854", "patch": "@@ -0,0 +1,12 @@\n+/* PR c/84999 */\n+/* { dg-do compile { target { i?86-*-* x86_64-*-* } } } */\n+/* { dg-options \"\" } */\n+\n+typedef __float128 V __attribute__ ((__vector_size__ (2 * sizeof (__float128))));\n+V a;\n+typeof (a != 0) b;\t/* { dg-error \"could not find an integer type of the same size as\" \"\" { target ia32 } } */\n+typeof (a == 0) c;\t/* { dg-error \"could not find an integer type of the same size as\" \"\" { target ia32 } } */\n+typeof (a < 0) d;\t/* { dg-error \"could not find an integer type of the same size as\" \"\" { target ia32 } } */\n+typeof (a <= 0) e;\t/* { dg-error \"could not find an integer type of the same size as\" \"\" { target ia32 } } */\n+typeof (a > 0) f;\t/* { dg-error \"could not find an integer type of the same size as\" \"\" { target ia32 } } */\n+typeof (a >= 0) g;\t/* { dg-error \"could not find an integer type of the same size as\" \"\" { target ia32 } } */"}]}