{"sha": "5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWM3MzY1NDE1ZjRlMmNhMzViOWRkZDA1ZDA1ODg4MjEwY2Q1NWQ0Yg==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@gnat.com", "date": "2001-10-08T16:15:06Z"}, "committer": {"name": "Geert Bosch", "email": "bosch@gcc.gnu.org", "date": "2001-10-08T16:15:06Z"}, "message": "atree.adb: Set Error_Posted in Error node, helps error recovery.\n\n\t* atree.adb: Set Error_Posted in Error node, helps error recovery.\n\n\t* par-endh.adb (Output_End_Expected): We should also not test\n\tError_Posted on the Error node, since now it is always set.\n\n\t* cstand.adb (Create_Standard): Set Etype of Error to Any_Type\n\tto help error recovery. Part of general work on 9407-004.\n\n\t* par.adb: Add ??? for misuse of error\n\n\t* sem_res.adb:\n\t(Resolve): Defend against Error, fixes 9407-003.\n\t(Resolve_Discrete_Subtype_Indication): Defend against Error.\n\n\t* sinfo.ads (N_Error): Now has Etype field (which will be set\n\tto Any_Type to help error recovery).\n\nFrom-SVN: r46077", "tree": {"sha": "4fa6043235cf58bee6726c72dce924b1b6e8327f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4fa6043235cf58bee6726c72dce924b1b6e8327f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/comments", "author": null, "committer": null, "parents": [{"sha": "a153ae15978eb73d04afcf141aaac12b7c6e9356", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a153ae15978eb73d04afcf141aaac12b7c6e9356", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a153ae15978eb73d04afcf141aaac12b7c6e9356"}], "stats": {"total": 71, "additions": 57, "deletions": 14}, "files": [{"sha": "8801866187327d9071d30cbe13784512f923f5f4", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "patch": "@@ -1,3 +1,22 @@\n+2001-10-08  Robert Dewar <dewar@gnat.com>\n+\n+\t* atree.adb: Set Error_Posted in Error node, helps error recovery.\n+\t\n+\t* par-endh.adb (Output_End_Expected): We should also not test \n+\tError_Posted on the Error node, since now it is always set.\n+\t\n+\t* cstand.adb (Create_Standard): Set Etype of Error to Any_Type \n+\tto help error recovery. Part of general work on 9407-004.\n+\t\n+\t* par.adb: Add ??? for misuse of error\n+\t\n+\t* sem_res.adb:\n+\t(Resolve): Defend against Error, fixes 9407-003.\n+\t(Resolve_Discrete_Subtype_Indication): Defend against Error.\n+\t\n+\t* sinfo.ads (N_Error): Now has Etype field (which will be set \n+\tto Any_Type to help error recovery).\n+\n 2001-10-08  Richard Kenner (kenner@gnat.com)\n \n \t* misc.c (gnat_expand_expr, case UNCHECKED_CONVERT_EXPR):"}, {"sha": "7bfff100a56e1e6aee662ed900201cfcf297daad", "filename": "gcc/ada/atree.adb", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fatree.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fatree.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fatree.adb?ref=5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                            $Revision: 1.205 $\n+--                            $Revision$\n --                                                                          --\n --          Copyright (C) 1992-2001, Free Software Foundation, Inc.         --\n --                                                                          --\n@@ -842,13 +842,17 @@ package body Atree is\n       Dummy : Node_Id;\n \n    begin\n-      --  Allocate Empty and Error nodes\n+      --  Allocate Empty node\n \n       Dummy := New_Node (N_Empty, No_Location);\n       Set_Name1 (Empty, No_Name);\n+\n+      --  Allocate Error node, and set Error_Posted, since we certainly\n+      --  only generate an Error node if we do post some kind of error!\n+\n       Dummy := New_Node (N_Error, No_Location);\n       Set_Name1 (Error, Error_Name);\n-\n+      Set_Error_Posted (Error, True);\n    end Initialize;\n \n    --------------------------"}, {"sha": "5ca383d543baea3e32c478082dc8ca6a34e644bd", "filename": "gcc/ada/cstand.adb", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fcstand.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fcstand.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fcstand.adb?ref=5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                            $Revision: 1.213 $\n+--                            $Revision$\n --                                                                          --\n --          Copyright (C) 1992-2001 Free Software Foundation, Inc.          --\n --                                                                          --\n@@ -1216,6 +1216,9 @@ package body CStand is\n       Last_Standard_Node_Id := Last_Node_Id;\n       Last_Standard_List_Id := Last_List_Id;\n \n+      --  The Error node has an Etype of Any_Type to help error recovery\n+\n+      Set_Etype (Error, Any_Type);\n    end Create_Standard;\n \n    ------------------------------------"}, {"sha": "dfbe46cc9b14ab7ee8d1e117f30dadd80c1d4cef", "filename": "gcc/ada/par-endh.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fpar-endh.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fpar-endh.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-endh.adb?ref=5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                            $Revision: 1.61 $\n+--                            $Revision$\n --                                                                          --\n --          Copyright (C) 1992-2001, Free Software Foundation, Inc.         --\n --                                                                          --\n@@ -791,7 +791,7 @@ package body Endh is\n \n       --  Suppress message if error was posted on opening label\n \n-      if Present (Error_Msg_Node_1)\n+      if Error_Msg_Node_1 > Empty_Or_Error\n         and then Error_Posted (Error_Msg_Node_1)\n       then\n          return;"}, {"sha": "958a8a7d0af1fabdfd898b435ce8e3203ef46990", "filename": "gcc/ada/par.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fpar.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fpar.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar.adb?ref=5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                            $Revision: 1.126 $\n+--                            $Revision$\n --                                                                          --\n --          Copyright (C) 1992-2001 Free Software Foundation, Inc.          --\n --                                                                          --\n@@ -396,6 +396,7 @@ function Par (Configuration_Pragmas : Boolean) return List_Id is\n       --  field references an N_Defining_Program_Unit_Name node for the name.\n       --  For cases other than LOOP or BEGIN, the Label field is set to Error,\n       --  indicating that it is an error to have a label on the end line.\n+      --  (this is really a misuse of Error since there is no Error ???)\n \n       Decl : List_Id;\n       --  Points to the list of declarations (i.e. the declarative part)"}, {"sha": "ae2b97cb6928b0cea6dc0fc8d0d7090c86c8b45c", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                            $Revision: 1.717 $\n+--                            $Revision$\n --                                                                          --\n --          Copyright (C) 1992-2001, Free Software Foundation, Inc.         --\n --                                                                          --\n@@ -1327,6 +1327,10 @@ package body Sem_Res is\n    --  Start of processing for Resolve\n \n    begin\n+      if N = Error then\n+         return;\n+      end if;\n+\n       --  Access attribute on remote subprogram cannot be used for\n       --  a non-remote access-to-subprogram type.\n \n@@ -3496,6 +3500,11 @@ package body Sem_Res is\n \n       else\n          R := Range_Expression (Constraint (N));\n+\n+         if R = Error then\n+            return;\n+         end if;\n+\n          Analyze (R);\n \n          if Base_Type (S) /= Base_Type (Typ) then"}, {"sha": "d6eca70bd30b07e886c128593dd14d94013edb23", "filename": "gcc/ada/sinfo.ads", "status": "modified", "additions": 13, "deletions": 6, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fsinfo.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c7365415f4e2ca35b9ddd05d05888210cd55d4b/gcc%2Fada%2Fsinfo.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsinfo.ads?ref=5c7365415f4e2ca35b9ddd05d05888210cd55d4b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---                            $Revision: 1.430 $\n+--                            $Revision: 1.1 $\n --                                                                          --\n --          Copyright (C) 1992-2001, Free Software Foundation, Inc.         --\n --                                                                          --\n@@ -6210,18 +6210,23 @@ package Sinfo is\n    -- Empty --\n    -----------\n \n-   --  N_Empty\n-   --  Chars (Name1) is set to No_Name\n    --  Used as the contents of the Nkind field of the dummy Empty node\n    --  and in some other situations to indicate an uninitialized value.\n \n+   --  N_Empty\n+   --  Chars (Name1) is set to No_Name\n+\n    -----------\n    -- Error --\n    -----------\n \n+   --  Used as the contents of the Nkind field of the dummy Error node.\n+   --  Has an Etype field, which gets set to Any_Type later on, to help\n+   --  error recovery (Error_Posted is also set in the Error node).\n+\n    --  N_Error\n    --  Chars (Name1) is set to Error_Name\n-   --  Used as the contents of the Nkind field of the dummy Error node\n+   --  Etype (Node5-Sem)\n \n    --------------------------\n    -- Node Type Definition --\n@@ -6248,10 +6253,12 @@ package Sinfo is\n \n       --  N_Has_Chars\n       N_Empty,\n-      N_Error,\n       N_Pragma,\n       N_Pragma_Argument_Association,\n \n+      --  N_Has_Etype\n+      N_Error,\n+\n       --  N_Entity, N_Has_Etype, N_Has_Chars\n       N_Defining_Character_Literal,\n       N_Defining_Identifier,\n@@ -6587,7 +6594,7 @@ package Sinfo is\n    --  Warning: DOES NOT INCLUDE N_Freeze_Entity!\n \n    subtype N_Has_Etype is Node_Kind range\n-     N_Defining_Character_Literal ..\n+     N_Error ..\n      N_Subtype_Indication;\n \n    subtype N_Later_Decl_Item is Node_Kind range"}]}