{"sha": "8d5f60ac742d669e2029e9f944fb565990b524ae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGQ1ZjYwYWM3NDJkNjY5ZTIwMjllOWY5NDRmYjU2NTk5MGI1MjRhZQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2008-08-27T17:08:40Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2008-08-27T17:08:40Z"}, "message": "re PR c++/35321 (ICE with invalid use of __builtin_offsetof)\n\n2008-08-27  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/35321\n\t* c-common.c (fold_offsetof_1): Handle TARGET_EXPR like CALL_EXPR.\n\n/testsuite\n2008-08-27  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/35321\n\t* g++.dg/parse/offsetof8.C: New.\n\nFrom-SVN: r139628", "tree": {"sha": "019920d62bf906c52e01471a464fe94a1664b0dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/019920d62bf906c52e01471a464fe94a1664b0dd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d5f60ac742d669e2029e9f944fb565990b524ae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d5f60ac742d669e2029e9f944fb565990b524ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d5f60ac742d669e2029e9f944fb565990b524ae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d5f60ac742d669e2029e9f944fb565990b524ae/comments", "author": null, "committer": null, "parents": [{"sha": "a82214400104d662519445e65c0ac9fb5f9866d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a82214400104d662519445e65c0ac9fb5f9866d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a82214400104d662519445e65c0ac9fb5f9866d6"}], "stats": {"total": 27, "additions": 27, "deletions": 0}, "files": [{"sha": "4b237afb5ec51848d55fd090f29a7bc065d9f0cb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8d5f60ac742d669e2029e9f944fb565990b524ae", "patch": "@@ -1,3 +1,8 @@\n+2008-08-27  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/35321\n+\t* c-common.c (fold_offsetof_1): Handle TARGET_EXPR like CALL_EXPR.\n+\n 2008-08-27  Paul Brook  <paul@codesourcery.com>\n \n \t* config.gcc: Loosen checks for arm uclinux eabi targets."}, {"sha": "d06c96940f41cccb51801951a58426f22468e1a5", "filename": "gcc/c-common.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=8d5f60ac742d669e2029e9f944fb565990b524ae", "patch": "@@ -7685,6 +7685,7 @@ fold_offsetof_1 (tree expr, tree stop_ref)\n       return error_mark_node;\n \n     case CALL_EXPR:\n+    case TARGET_EXPR:\n       error (\"cannot apply %<offsetof%> when %<operator[]%> is overloaded\");\n       return error_mark_node;\n "}, {"sha": "fb2a21a5f06484e8e2af995b17a8ae89e2d0990d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8d5f60ac742d669e2029e9f944fb565990b524ae", "patch": "@@ -1,3 +1,8 @@\n+2008-08-27  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/35321\n+\t* g++.dg/parse/offsetof8.C: New.\n+\n 2008-08-27  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n \n \tPR c++/17880"}, {"sha": "9add91e3768e79abbc7f929db4771879009cd98e", "filename": "gcc/testsuite/g++.dg/parse/offsetof8.C", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Foffsetof8.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d5f60ac742d669e2029e9f944fb565990b524ae/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Foffsetof8.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Foffsetof8.C?ref=8d5f60ac742d669e2029e9f944fb565990b524ae", "patch": "@@ -0,0 +1,16 @@\n+// PR c++/35321\n+\n+struct A\n+{\n+  A operator[] (int);\n+};\n+\n+struct B\n+{\n+  A a;\n+};\n+\n+void foo()\n+{\n+  __builtin_offsetof(B, a[0]); /* { dg-error \"error: cannot apply 'offsetof' when 'operator\\\\\\[\\\\\\]' is overloaded\" } */\n+}"}]}