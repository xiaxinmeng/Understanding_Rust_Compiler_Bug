{"sha": "1a122a71eeb0671f92037ccdf5d2dc0b307af620", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWExMjJhNzFlZWIwNjcxZjkyMDM3Y2NkZjVkMmRjMGIzMDdhZjYyMA==", "commit": {"author": {"name": "Iain Buclaw", "email": "ibuclaw@gdcproject.org", "date": "2017-05-27T11:29:38Z"}, "committer": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2017-05-27T11:29:38Z"}, "message": "d-demangle.c (dlang_parse_real): Remove stack buffer, write the demangled hexadecimal directly to string.\n\nlibiberty/ChangeLog:\n\n\t* d-demangle.c (dlang_parse_real): Remove stack buffer, write\n\tthe demangled hexadecimal directly to string.\n\t* testsuite/d-demangle-expected: Add tests.\n\nFrom-SVN: r248537", "tree": {"sha": "7c2326e9819d6a312467e85088f3319e5c20ec15", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7c2326e9819d6a312467e85088f3319e5c20ec15"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a122a71eeb0671f92037ccdf5d2dc0b307af620", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a122a71eeb0671f92037ccdf5d2dc0b307af620", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a122a71eeb0671f92037ccdf5d2dc0b307af620", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a122a71eeb0671f92037ccdf5d2dc0b307af620/comments", "author": {"login": "ibuclaw", "id": 397929, "node_id": "MDQ6VXNlcjM5NzkyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/397929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ibuclaw", "html_url": "https://github.com/ibuclaw", "followers_url": "https://api.github.com/users/ibuclaw/followers", "following_url": "https://api.github.com/users/ibuclaw/following{/other_user}", "gists_url": "https://api.github.com/users/ibuclaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/ibuclaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ibuclaw/subscriptions", "organizations_url": "https://api.github.com/users/ibuclaw/orgs", "repos_url": "https://api.github.com/users/ibuclaw/repos", "events_url": "https://api.github.com/users/ibuclaw/events{/privacy}", "received_events_url": "https://api.github.com/users/ibuclaw/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b9396a495ca3667289091480bb653e47d85c30e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9396a495ca3667289091480bb653e47d85c30e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9396a495ca3667289091480bb653e47d85c30e9"}], "stats": {"total": 35, "additions": 18, "deletions": 17}, "files": [{"sha": "83f6d215ccc25b467f4c16020c116007422766c6", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a122a71eeb0671f92037ccdf5d2dc0b307af620/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a122a71eeb0671f92037ccdf5d2dc0b307af620/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=1a122a71eeb0671f92037ccdf5d2dc0b307af620", "patch": "@@ -1,3 +1,9 @@\n+2017-05-27  Iain Buclaw  <ibuclaw@gdcproject.org>\n+\n+\t* d-demangle.c (dlang_parse_real): Remove stack buffer, write\n+\tthe demangled hexadecimal directly to string.\n+\t* testsuite/d-demangle-expected: Add tests.\n+\n 2017-05-24  Eli Zaretskii  <eliz@gnu.org>\n \n \t* waitpid.c (wait) [__MINGW32__]: Define as a macro"}, {"sha": "030cab3333fb5824a2640765cf623d57506f7f63", "filename": "libiberty/d-demangle.c", "status": "modified", "additions": 8, "deletions": 17, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a122a71eeb0671f92037ccdf5d2dc0b307af620/libiberty%2Fd-demangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a122a71eeb0671f92037ccdf5d2dc0b307af620/libiberty%2Fd-demangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fd-demangle.c?ref=1a122a71eeb0671f92037ccdf5d2dc0b307af620", "patch": "@@ -1025,9 +1025,6 @@ dlang_parse_integer (string *decl, const char *mangled, char type)\n static const char *\n dlang_parse_real (string *decl, const char *mangled)\n {\n-  char buffer[64];\n-  int len = 0;\n-\n   /* Handle NAN and +-INF.  */\n   if (strncmp (mangled, \"NAN\", 3) == 0)\n     {\n@@ -1051,50 +1048,44 @@ dlang_parse_real (string *decl, const char *mangled)\n   /* Hexadecimal prefix and leading bit.  */\n   if (*mangled == 'N')\n     {\n-      buffer[len++] = '-';\n+      string_append (decl, \"-\");\n       mangled++;\n     }\n \n   if (!ISXDIGIT (*mangled))\n     return NULL;\n \n-  buffer[len++] = '0';\n-  buffer[len++] = 'x';\n-  buffer[len++] = *mangled;\n-  buffer[len++] = '.';\n+  string_append (decl, \"0x\");\n+  string_appendn (decl, mangled, 1);\n+  string_append (decl, \".\");\n   mangled++;\n \n   /* Significand.  */\n   while (ISXDIGIT (*mangled))\n     {\n-      buffer[len++] = *mangled;\n+      string_appendn (decl, mangled, 1);\n       mangled++;\n     }\n \n   /* Exponent.  */\n   if (*mangled != 'P')\n     return NULL;\n \n-  buffer[len++] = 'p';\n+  string_append (decl, \"p\");\n   mangled++;\n \n   if (*mangled == 'N')\n     {\n-      buffer[len++] = '-';\n+      string_append (decl, \"-\");\n       mangled++;\n     }\n \n   while (ISDIGIT (*mangled))\n     {\n-      buffer[len++] = *mangled;\n+      string_appendn (decl, mangled, 1);\n       mangled++;\n     }\n \n-  /* Write out the demangled hexadecimal, rather than trying to\n-     convert the buffer into a floating-point value.  */\n-  buffer[len] = '\\0';\n-  len = strlen (buffer);\n-  string_appendn (decl, buffer, len);\n   return mangled;\n }\n "}, {"sha": "950d4955d8f12e7e2dde385c80e694fe27190bf1", "filename": "libiberty/testsuite/d-demangle-expected", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a122a71eeb0671f92037ccdf5d2dc0b307af620/libiberty%2Ftestsuite%2Fd-demangle-expected", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a122a71eeb0671f92037ccdf5d2dc0b307af620/libiberty%2Ftestsuite%2Fd-demangle-expected", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Ftestsuite%2Fd-demangle-expected?ref=1a122a71eeb0671f92037ccdf5d2dc0b307af620", "patch": "@@ -838,6 +838,10 @@ _D8demangle52__T4testVrcN0C4CCCCCCCCCCCCCDP4c0B666666666666666P6Zv\n demangle.test!(-0x0.C4CCCCCCCCCCCCCDp4+0x0.B666666666666666p6i)\n #\n --format=dlang\n+_D8demangle91__T4testVde000111222333444555666777888999AAABBBCCCDDDEEEFFFP000111222333444555666777888999Zv\n+demangle.test!(0x0.00111222333444555666777888999AAABBBCCCDDDEEEFFFp000111222333444555666777888999)\n+#\n+--format=dlang\n _D8demangle22__T4testVG3ua3_616263Zv\n demangle.test!(\"abc\")\n #"}]}