{"sha": "eb4a91451a293020a497e5dc1d41667af8b16eea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWI0YTkxNDUxYTI5MzAyMGE0OTdlNWRjMWQ0MTY2N2FmOGIxNmVlYQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2019-01-08T10:46:04Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2019-01-08T10:46:04Z"}, "message": "re PR fortran/88611 (ICE in eliminate_stmt, at tree-ssa-sccvn.c:5011)\n\n2019-01-08  Richard Biener  <rguenther@suse.de>\n\n\tPR fortran/88611\n\t* trans-expr.c (gfc_conv_initializer): For ISOCBINDING_NULL_*\n\tdirectly build the expected GENERIC tree.\n\n\t* gfortran.dg/pr88611.f90: New testcase.\n\nFrom-SVN: r267721", "tree": {"sha": "13540aebaea57a6ef2d80b80ec6487d5c1e17986", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/13540aebaea57a6ef2d80b80ec6487d5c1e17986"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eb4a91451a293020a497e5dc1d41667af8b16eea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb4a91451a293020a497e5dc1d41667af8b16eea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb4a91451a293020a497e5dc1d41667af8b16eea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb4a91451a293020a497e5dc1d41667af8b16eea/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "efac62a3d17d534e8fec39a53031689efb0dc724", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/efac62a3d17d534e8fec39a53031689efb0dc724", "html_url": "https://github.com/Rust-GCC/gccrs/commit/efac62a3d17d534e8fec39a53031689efb0dc724"}], "stats": {"total": 45, "additions": 32, "deletions": 13}, "files": [{"sha": "73d47da983267a1f95d81cb25242cbb37fc67d0f", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=eb4a91451a293020a497e5dc1d41667af8b16eea", "patch": "@@ -1,3 +1,9 @@\n+2019-01-08  Richard Biener  <rguenther@suse.de>\n+\n+\tPR fortran/88611\n+\t* trans-expr.c (gfc_conv_initializer): For ISOCBINDING_NULL_*\n+\tdirectly build the expected GENERIC tree.\n+\n 2019-01-07  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \tHarald Anlauf <anlauf@gmx.de>\n \tTobias Burnus <burnus@gcc.gnu.org>"}, {"sha": "c45752e516a14c0cd49fbb90834ec92bd1d3e61f", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 6, "deletions": 13, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=eb4a91451a293020a497e5dc1d41667af8b16eea", "patch": "@@ -7086,19 +7086,12 @@ gfc_conv_initializer (gfc_expr * expr, gfc_typespec * ts, tree type,\n   if (expr != NULL && expr->ts.type == BT_DERIVED\n       && expr->ts.is_iso_c && expr->ts.u.derived)\n     {\n-      gfc_symbol *derived = expr->ts.u.derived;\n-\n-      /* The derived symbol has already been converted to a (void *).  Use\n-\t its kind.  */\n-      if (derived->ts.kind == 0)\n-\tderived->ts.kind = gfc_default_integer_kind;\n-      expr = gfc_get_int_expr (derived->ts.kind, NULL, 0);\n-      expr->ts.f90_type = derived->ts.f90_type;\n-\n-      gfc_init_se (&se, NULL);\n-      gfc_conv_constant (&se, expr);\n-      gcc_assert (TREE_CODE (se.expr) != CONSTRUCTOR);\n-      return se.expr;\n+      if (TREE_CODE (type) == ARRAY_TYPE)\n+\treturn build_constructor (type, NULL);\n+      else if (POINTER_TYPE_P (type))\n+\treturn build_int_cst (type, 0);\n+      else\n+\tgcc_unreachable ();\n     }\n \n   if (array && !procptr)"}, {"sha": "ff3e09dd9ad7f20527566787e49db24b2073ea04", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=eb4a91451a293020a497e5dc1d41667af8b16eea", "patch": "@@ -1,3 +1,9 @@\n+2019-01-08  Richard Biener  <rguenther@suse.de>\n+\n+\tPR fortran/88611\n+\t* trans-expr.c (gfc_conv_initializer): For ISOCBINDING_NULL_*\n+\tdirectly build the expected GENERIC tree.\n+\n 2019-01-08  Sam Tebbs  <sam.tebbs@arm.com>\n \n \t* gcc.target/aarch64/(return_address_sign_1.c,"}, {"sha": "9847bc3c8972245b4ae1ccdf969d74bb51e2a519", "filename": "gcc/testsuite/gfortran.dg/pr88611.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr88611.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eb4a91451a293020a497e5dc1d41667af8b16eea/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr88611.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr88611.f90?ref=eb4a91451a293020a497e5dc1d41667af8b16eea", "patch": "@@ -0,0 +1,14 @@\n+! { dg-do run }\n+! { dg-options \"-fdefault-integer-8 -fno-tree-forwprop -O3 -fno-tree-ccp\" }\n+! PR 82869\n+! A temp variable of type logical was incorrectly transferred\n+! to the I/O library as a logical type of a different kind.\n+program pr82869_8\n+  use, intrinsic :: iso_c_binding\n+  type(c_ptr) :: p = c_null_ptr\n+  character(len=4) :: s\n+  write (s, *) c_associated(p), c_associated(c_null_ptr)\n+  if (s /= ' F F') then\n+     STOP 1\n+  end if\n+end program pr82869_8"}]}