{"sha": "d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDljMTk0Y2I5ZWY0YzFhOTI2M2FmNmMyODI2NzEwNGY0Y2UzNjI4ZQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2008-12-08T10:36:01Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-12-08T10:36:01Z"}, "message": "re PR middle-end/36802 (pop_gimplify_context ICE using openmp task construct)\n\n\tPR middle-end/36802\n\t* omp-low.c (use_pointer_for_field): Only call maybe_lookup_decl\n\ton parallel and task contexts.\n\n\t* testsuite/libgomp.c/pr36802-1.c: New test.\n\t* testsuite/libgomp.c/pr36802-2.c: New test.\n\t* testsuite/libgomp.c/pr36802-3.c: New test.\n\nFrom-SVN: r142546", "tree": {"sha": "afeb602ff89a718fac03904e6d621cdacaf590a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/afeb602ff89a718fac03904e6d621cdacaf590a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4e1e3eda6b83b091b227dad1c029d18ab6501f91", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e1e3eda6b83b091b227dad1c029d18ab6501f91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e1e3eda6b83b091b227dad1c029d18ab6501f91"}], "stats": {"total": 143, "additions": 141, "deletions": 2}, "files": [{"sha": "ed541f12220cc13fd899642a46fca916fcbc4ac5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "patch": "@@ -1,3 +1,9 @@\n+2008-12-08  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/36802\n+\t* omp-low.c (use_pointer_for_field): Only call maybe_lookup_decl\n+\ton parallel and task contexts.\n+\n 2008-12-07  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gimple.c (recalculate_side_effects) <tcc_constant>: New case."}, {"sha": "b7885e6cf3c12a841fda77a1003278a0214a90ad", "filename": "gcc/omp-low.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/gcc%2Fomp-low.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/gcc%2Fomp-low.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-low.c?ref=d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "patch": "@@ -760,10 +760,10 @@ use_pointer_for_field (tree decl, omp_context *shared_ctx)\n \t  omp_context *up;\n \n \t  for (up = shared_ctx->outer; up; up = up->outer)\n-\t    if (maybe_lookup_decl (decl, up))\n+\t    if (is_taskreg_ctx (up) && maybe_lookup_decl (decl, up))\n \t      break;\n \n-\t  if (up && is_taskreg_ctx (up))\n+\t  if (up)\n \t    {\n \t      tree c;\n "}, {"sha": "98a307314a9c0a52749ed7e1b0bfbca1a9dfc0d6", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "patch": "@@ -1,3 +1,10 @@\n+2008-12-08  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/36802\n+\t* testsuite/libgomp.c/pr36802-1.c: New test.\n+\t* testsuite/libgomp.c/pr36802-2.c: New test.\n+\t* testsuite/libgomp.c/pr36802-3.c: New test.\n+\n 2008-12-01  Janis Johnson  <janis187@us.ibm.com>\n \n \tPR libgomp/38270"}, {"sha": "4ed5e12769b14980c171c5ccf874f4350ea7ec5a", "filename": "libgomp/testsuite/libgomp.c/pr36802-1.c", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-1.c?ref=d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "patch": "@@ -0,0 +1,34 @@\n+/* PR middle-end/36802 */\n+\n+extern void abort (void);\n+\n+int\n+foo (int k)\n+{\n+  int i = 0;\n+#pragma omp parallel\n+  #pragma omp single\n+    {\n+      if (!k)\n+\t{\n+\t  int j;\n+\t  for (j = 0; j < 10; j++)\n+\t  #pragma omp task\n+\t    if (j == 4)  \n+\t      i++;\n+\t}\n+      else\n+\ti++;\n+    }\n+  return i;\n+}\n+\n+int\n+main (void)\n+{\n+  if (foo (0) != 1)\n+    abort ();\n+  if (foo (1) != 1)\n+    abort ();\n+  return 0;\n+}"}, {"sha": "06e792f0f14da3ec63ba37d91338f9cc8bc80d62", "filename": "libgomp/testsuite/libgomp.c/pr36802-2.c", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-2.c?ref=d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "patch": "@@ -0,0 +1,46 @@\n+/* PR middle-end/36802 */\n+\n+extern void abort (void);\n+\n+int q;\n+\n+int\n+foo (int k)\n+{\n+  int i = 6, n = 0;\n+  omp_set_dynamic (0);\n+  omp_set_nested (1);\n+#pragma omp parallel shared (i) num_threads (3)\n+  {\n+    int l;\n+\n+    if (omp_get_num_threads () != 3)\n+    #pragma omp atomic\n+      n += 1;\n+    else\n+    #pragma omp for\n+      for (l = 0; l < 3; l++)\n+\tif (k)\n+\t#pragma omp atomic\n+\t  q += i;\n+\telse\n+\t#pragma omp parallel shared (i) num_threads (4)\n+\t  {\n+\t    if (omp_get_num_threads () != 4)\n+\t    #pragma omp atomic\n+\t      n += 1;\n+\t    #pragma omp critical\n+\t      i += 1;\n+\t  }\n+  }\n+  if (n == 0 && i != 6 + 3 * 4)\n+    abort ();\n+  return 0;\n+}\n+\n+int\n+main (void)\n+{\n+  foo (0);\n+  return 0;\n+}"}, {"sha": "f11baa09f57c791950e564baad387520e13d6f64", "filename": "libgomp/testsuite/libgomp.c/pr36802-3.c", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9c194cb9ef4c1a9263af6c28267104f4ce3628e/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fpr36802-3.c?ref=d9c194cb9ef4c1a9263af6c28267104f4ce3628e", "patch": "@@ -0,0 +1,46 @@\n+/* PR middle-end/36802 */\n+\n+extern void abort (void);\n+\n+int q;\n+\n+int\n+foo (int k)\n+{\n+  int i = 6, n = 0;\n+  omp_set_dynamic (0);\n+  omp_set_nested (1);\n+#pragma omp parallel shared (i) num_threads (3)\n+  {\n+    int l;\n+\n+    if (omp_get_num_threads () != 3)\n+    #pragma omp atomic\n+      n += 1;\n+    else\n+    #pragma omp for\n+      for (l = 0; l < 3; l++)\n+\tif (!k)\n+\t#pragma omp parallel shared (i) num_threads (4)\n+\t  {\n+\t    if (omp_get_num_threads () != 4)\n+\t    #pragma omp atomic\n+\t      n += 1;\n+\t    #pragma omp critical\n+\t      i += 1;\n+\t  }\n+\telse\n+\t#pragma omp atomic\n+\t  q += i;\n+  }\n+  if (n == 0 && i != 6 + 3 * 4)\n+    abort ();\n+  return 0;\n+}\n+\n+int\n+main (void)\n+{\n+  foo (0);\n+  return 0;\n+}"}]}