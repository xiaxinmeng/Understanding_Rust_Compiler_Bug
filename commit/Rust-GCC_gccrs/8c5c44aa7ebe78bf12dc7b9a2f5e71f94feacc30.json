{"sha": "8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGM1YzQ0YWE3ZWJlNzhiZjEyZGM3YjlhMmY1ZTcxZjk0ZmVhY2MzMA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2015-02-06T05:03:22Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2015-02-06T05:03:22Z"}, "message": "runtime:  Add memprofilerate to GODEBUG\n\nAdd memprofilerate as a value recognized\nin the GODEBUG env var.  The value provided\nis used as the new setting for\nruntime.MemProfileRate, allowing the user\nto adjust memory profiling.\n\nFrom-SVN: r220470", "tree": {"sha": "fb946aefe6bb8d802e6fb91e82ee3439ce470d9f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fb946aefe6bb8d802e6fb91e82ee3439ce470d9f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30/comments", "author": null, "committer": null, "parents": [{"sha": "c4feb478a6c0063b1f4b86d2a5d47b1a6a7f09f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4feb478a6c0063b1f4b86d2a5d47b1a6a7f09f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4feb478a6c0063b1f4b86d2a5d47b1a6a7f09f4"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "3c3e427a05a9259be59a417354f769add395cc43", "filename": "libgo/go/runtime/extern.go", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30/libgo%2Fgo%2Fruntime%2Fextern.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30/libgo%2Fgo%2Fruntime%2Fextern.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fruntime%2Fextern.go?ref=8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30", "patch": "@@ -39,6 +39,10 @@ a comma-separated list of name=val pairs. Supported names are:\n \tgcdead: setting gcdead=1 causes the garbage collector to clobber all stack slots\n \tthat it thinks are dead.\n \n+\tmemprofilerate:  setting memprofilerate=X changes the setting for\n+\truntime.MemProfileRate.  Refer to the description of this variable for how\n+\tit is used and its default value.\n+\n \tscheddetail: setting schedtrace=X and scheddetail=1 causes the scheduler to emit\n \tdetailed multiline info every X milliseconds, describing state of the scheduler,\n \tprocessors, threads and goroutines."}, {"sha": "e3320356c47c142f962082c4c6d37b056382fbe7", "filename": "libgo/runtime/runtime.c", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30/libgo%2Fruntime%2Fruntime.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30/libgo%2Fruntime%2Fruntime.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fruntime%2Fruntime.c?ref=8c5c44aa7ebe78bf12dc7b9a2f5e71f94feacc30", "patch": "@@ -22,6 +22,10 @@ enum {\n // gotraceback value.\n static uint32 traceback_cache = ~(uint32)0;\n \n+extern volatile intgo runtime_MemProfileRate\n+  __asm__ (GOSYM_PREFIX \"runtime.MemProfileRate\");\n+\n+\n // The GOTRACEBACK environment variable controls the\n // behavior of a Go program that is crashing and exiting.\n //\tGOTRACEBACK=0   suppress all tracebacks\n@@ -315,6 +319,11 @@ runtime_signalstack(byte *p, int32 n)\n \n DebugVars\truntime_debug;\n \n+// Holds variables parsed from GODEBUG env var,\n+// except for \"memprofilerate\" since there is an\n+// existing var for that value which is int\n+// instead of in32 and might have an\n+// initial value.\n static struct {\n \tconst char* name;\n \tint32*\tvalue;\n@@ -349,7 +358,12 @@ runtime_parsedebugvars(void)\n \tfor(;;) {\n \t\tfor(i=0; i<(intgo)nelem(dbgvar); i++) {\n \t\t\tn = runtime_findnull((const byte*)dbgvar[i].name);\n-\t\t\tif(runtime_mcmp(p, dbgvar[i].name, n) == 0 && p[n] == '=')\n+\t\t\tif(runtime_mcmp(p, \"memprofilerate\", n) == 0 && p[n] == '=')\n+\t\t\t\t// Set the MemProfileRate directly since it\n+\t\t\t\t// is an int, not int32, and should only lbe\n+\t\t\t\t// set here if specified by GODEBUG\n+\t\t\t\truntime_MemProfileRate = runtime_atoi(p+n+1);\n+\t\t\telse if(runtime_mcmp(p, dbgvar[i].name, n) == 0 && p[n] == '=')\n \t\t\t\t*dbgvar[i].value = runtime_atoi(p+n+1);\n \t\t}\n \t\tp = (const byte *)runtime_strstr((const char *)p, \",\");"}]}