{"sha": "25feb37fc665e0c46ee2deec9f47f5ffd4cdd702", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjVmZWIzN2ZjNjY1ZTBjNDZlZTJkZWVjOWY0N2Y1ZmZkNGNkZDcwMg==", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2019-07-01T13:35:32Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-01T13:35:32Z"}, "message": "[Ada] Revert \"Global => null\" on calendar routines that use timezones\n\nSome routines from the Ada.Calendar package, i.e. Year, Month, Day,\nSplit and Time_Off, rely on OS-specific timezone databases that are kept\nin files (e.g. /etc/localtime on Linux). In SPARK we want to model this\nas a potential side-effect, so those routines can't have \"Global =>\nnull\".\n\n2019-07-01  Piotr Trojanek  <trojanek@adacore.com>\n\ngcc/ada/\n\n\t* libgnat/a-calend.ads: Revert \"Global => null\" contracts on\n\tnon-pure routines.\n\nFrom-SVN: r272865", "tree": {"sha": "2e980af8e7ff3f1d5c5a43d9036339fe2187cfbd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2e980af8e7ff3f1d5c5a43d9036339fe2187cfbd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702", "html_url": "https://github.com/Rust-GCC/gccrs/commit/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b108c2ed65e8fe89acf0845358658a2e0ed07971", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b108c2ed65e8fe89acf0845358658a2e0ed07971", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b108c2ed65e8fe89acf0845358658a2e0ed07971"}], "stats": {"total": 24, "additions": 14, "deletions": 10}, "files": [{"sha": "68a682818bf3d6d03712e9b0b41f20eef5cf7e40", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=25feb37fc665e0c46ee2deec9f47f5ffd4cdd702", "patch": "@@ -1,3 +1,8 @@\n+2019-07-01  Piotr Trojanek  <trojanek@adacore.com>\n+\n+\t* libgnat/a-calend.ads: Revert \"Global => null\" contracts on\n+\tnon-pure routines.\n+\n 2019-07-01  Piotr Trojanek  <trojanek@adacore.com>\n \n \t* exp_attr.adb, libgnat/g-graphs.ads: Fix typos in comments:"}, {"sha": "1b782f0f67b2cdaab20769731bcd92cc61645845", "filename": "gcc/ada/libgnat/a-calend.ads", "status": "modified", "additions": 9, "deletions": 10, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702/gcc%2Fada%2Flibgnat%2Fa-calend.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25feb37fc665e0c46ee2deec9f47f5ffd4cdd702/gcc%2Fada%2Flibgnat%2Fa-calend.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-calend.ads?ref=25feb37fc665e0c46ee2deec9f47f5ffd4cdd702", "patch": "@@ -61,19 +61,20 @@ is\n    --  the result will contain all elapsed leap seconds since the start of\n    --  Ada time until now.\n \n-   function Year    (Date : Time) return Year_Number  with Global => null;\n-   function Month   (Date : Time) return Month_Number with Global => null;\n-   function Day     (Date : Time) return Day_Number   with Global => null;\n-   function Seconds (Date : Time) return Day_Duration with Global => null;\n+   function Year    (Date : Time) return Year_Number;\n+   function Month   (Date : Time) return Month_Number;\n+   function Day     (Date : Time) return Day_Number;\n+   function Seconds (Date : Time) return Day_Duration;\n+   --  SPARK Note: These routines, just like Split and Time_Of below, might use\n+   --  the OS-specific timezone database that is typically stored in a file.\n+   --  This side effect needs to be modeled, so there is no Global => null.\n \n    procedure Split\n      (Date    : Time;\n       Year    : out Year_Number;\n       Month   : out Month_Number;\n       Day     : out Day_Number;\n-      Seconds : out Day_Duration)\n-   with\n-     Global => null;\n+      Seconds : out Day_Duration);\n    --  Break down a time value into its date components set in the current\n    --  time zone. If Split is called on a time value created using Ada 2005\n    --  Time_Of in some arbitrary time zone, the input value will always be\n@@ -83,9 +84,7 @@ is\n      (Year    : Year_Number;\n       Month   : Month_Number;\n       Day     : Day_Number;\n-      Seconds : Day_Duration := 0.0) return Time\n-   with\n-     Global => null;\n+      Seconds : Day_Duration := 0.0) return Time;\n    --  GNAT Note: Normally when procedure Split is called on a Time value\n    --  result of a call to function Time_Of, the out parameters of procedure\n    --  Split are identical to the in parameters of function Time_Of. However,"}]}