{"sha": "492b73bda96d446cb62113559f1f705c1da365f3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDkyYjczYmRhOTZkNDQ2Y2I2MjExMzU1OWYxZjcwNWMxZGEzNjVmMw==", "commit": {"author": {"name": "Lee Millward", "email": "lee.millward@gmail.com", "date": "2006-07-18T17:22:39Z"}, "committer": {"name": "Lee Millward", "email": "lmillward@gcc.gnu.org", "date": "2006-07-18T17:22:39Z"}, "message": "re PR c++/28258 (ICE with invalid constructor)\n\n\tPR c++/28258\n\t* method.c (locate_copy): Check for non_reference\n\treturning error_mark_node.\n\n        PR c++/28260\n\t* decl.c (duplicate_decls): Return error_mark_node\n\ton ambiguous declaration.\n\n\tPR c++/28258\n\t* g++/dg/other/error13.C: New test.\n\n\tPR c++/28260\n\t* g++.dg/template/friend44.C: New test.\n\nFrom-SVN: r115561", "tree": {"sha": "47341d836482d990d2715e53e3a1fe393fea0c52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/47341d836482d990d2715e53e3a1fe393fea0c52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/492b73bda96d446cb62113559f1f705c1da365f3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/492b73bda96d446cb62113559f1f705c1da365f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/492b73bda96d446cb62113559f1f705c1da365f3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/492b73bda96d446cb62113559f1f705c1da365f3/comments", "author": {"login": "lee-m", "id": 1028098, "node_id": "MDQ6VXNlcjEwMjgwOTg=", "avatar_url": "https://avatars.githubusercontent.com/u/1028098?v=4", "gravatar_id": "", "url": "https://api.github.com/users/lee-m", "html_url": "https://github.com/lee-m", "followers_url": "https://api.github.com/users/lee-m/followers", "following_url": "https://api.github.com/users/lee-m/following{/other_user}", "gists_url": "https://api.github.com/users/lee-m/gists{/gist_id}", "starred_url": "https://api.github.com/users/lee-m/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/lee-m/subscriptions", "organizations_url": "https://api.github.com/users/lee-m/orgs", "repos_url": "https://api.github.com/users/lee-m/repos", "events_url": "https://api.github.com/users/lee-m/events{/privacy}", "received_events_url": "https://api.github.com/users/lee-m/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1e76e76b47437c53cf1eea76519edfbfed84c950", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e76e76b47437c53cf1eea76519edfbfed84c950", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e76e76b47437c53cf1eea76519edfbfed84c950"}], "stats": {"total": 41, "additions": 41, "deletions": 0}, "files": [{"sha": "cf7a062bd615c142ac5f58875f755d07d0f4dc89", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=492b73bda96d446cb62113559f1f705c1da365f3", "patch": "@@ -1,3 +1,13 @@\n+2006-07-18  Lee Millward  <lee.millward@gmail.com>\n+\n+\tPR c++/28258\n+\t* method.c (locate_copy): Check for non_reference\n+\treturning error_mark_node.\n+\n+        PR c++/28260\n+\t* decl.c (duplicate_decls): Return error_mark_node\n+\ton ambiguous declaration.\n+\t\n 2006-07-18  Steve Ellcey  <sje@cup.hp.com>\n \n \tPR c++/27495"}, {"sha": "6165a2fb4fe8fb4285e6f9a96872a90d6c5f3daf", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=492b73bda96d446cb62113559f1f705c1da365f3", "patch": "@@ -1371,6 +1371,7 @@ duplicate_decls (tree newdecl, tree olddecl, bool newdecl_is_friend)\n \t    {\n \t      error (\"new declaration %q#D\", newdecl);\n \t      error (\"ambiguates old declaration %q+#D\", olddecl);\n+              return error_mark_node;\n \t    }\n \t  else\n \t    return NULL_TREE;"}, {"sha": "312e3a9c04a174860ce90dba59a3f83491ddfbf0", "filename": "gcc/cp/method.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Fcp%2Fmethod.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Fcp%2Fmethod.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmethod.c?ref=492b73bda96d446cb62113559f1f705c1da365f3", "patch": "@@ -946,6 +946,10 @@ locate_copy (tree type, void *client_)\n       if (!parms)\n \tcontinue;\n       src_type = non_reference (TREE_VALUE (parms));\n+\n+      if (src_type == error_mark_node)\n+        return NULL_TREE;\n+\n       if (!same_type_ignoring_top_level_qualifiers_p (src_type, type))\n \tcontinue;\n       if (!sufficient_parms_p (TREE_CHAIN (parms)))"}, {"sha": "2025aadbacc2cf1cadcddc75d005fe2f96b92119", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=492b73bda96d446cb62113559f1f705c1da365f3", "patch": "@@ -1,3 +1,11 @@\n+2006-07-18  Lee Millward  <lee.millward@gmail.com>\n+\n+\tPR c++/28258\n+\t* g++/dg/other/error13.C: New test.\n+\n+\tPR c++/28260\n+\t* g++.dg/template/friend44.C: New test.\n+\t\n 2006-07-18  Steve Ellcey  <sje@cup.hp.com>\n \n \tPR c++/27495"}, {"sha": "037e28866e1064374d68e286f376f5c8487dc072", "filename": "gcc/testsuite/g++.dg/other/error13.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror13.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror13.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror13.C?ref=492b73bda96d446cb62113559f1f705c1da365f3", "patch": "@@ -0,0 +1,10 @@\n+//PR c++/28258\n+\n+struct A \n+{            // { dg-error \"\" }\n+  A(void x); // { dg-error \"invalid use|incomplete type|candidates\" }\n+};\n+\n+struct B : A {}; // { dg-error \"no matching function for call\" }\n+ \n+B b; // { dg-error \"synthesized method\" }"}, {"sha": "a0f63c866ae4fd67841efa00e8cccc4f8fccff15", "filename": "gcc/testsuite/g++.dg/template/friend44.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend44.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492b73bda96d446cb62113559f1f705c1da365f3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend44.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend44.C?ref=492b73bda96d446cb62113559f1f705c1da365f3", "patch": "@@ -0,0 +1,8 @@\n+//PR c++/28260\n+\n+template<int> struct A\n+{\n+  friend int foo(); // { dg-error \"new declaration\" }\n+};\n+\n+void foo() { A<0> a; } // { dg-error \"ambiguates old declaration\" } "}]}