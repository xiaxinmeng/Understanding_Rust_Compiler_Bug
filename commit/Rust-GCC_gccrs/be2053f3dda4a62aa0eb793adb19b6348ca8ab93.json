{"sha": "be2053f3dda4a62aa0eb793adb19b6348ca8ab93", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmUyMDUzZjNkZGE0YTYyYWEwZWI3OTNhZGIxOWI2MzQ4Y2E4YWI5Mw==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@cygnus.com", "date": "1997-11-03T06:24:36Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-11-03T06:24:36Z"}, "message": "combine.c (try_combine): Don't elim_i1 when it is used in i2src.\n\n        * combine.c (try_combine): Don't elim_i1 when it is used in i2src.\n\n        * combine.c (try_combine): When setting elim_i2, check whether newi2pat\n        sets i2dest.  When calling distribute_notes for i3dest_killed, pass\n        elim_i2 and elim_i1.\n\nCo-Authored-By: Jim Wilson <wilson@cygnus.com>\n\nFrom-SVN: r16296", "tree": {"sha": "046b01787ef740c898b1a3ea886c4f3a94d3a101", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/046b01787ef740c898b1a3ea886c4f3a94d3a101"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/be2053f3dda4a62aa0eb793adb19b6348ca8ab93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be2053f3dda4a62aa0eb793adb19b6348ca8ab93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be2053f3dda4a62aa0eb793adb19b6348ca8ab93", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be2053f3dda4a62aa0eb793adb19b6348ca8ab93/comments", "author": null, "committer": null, "parents": [{"sha": "0ae231b2281a84173bb75c5d8649f788511733dc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ae231b2281a84173bb75c5d8649f788511733dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ae231b2281a84173bb75c5d8649f788511733dc"}], "stats": {"total": 21, "additions": 17, "deletions": 4}, "files": [{"sha": "95110d5fdddc170313965caba8679646a80ecca3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be2053f3dda4a62aa0eb793adb19b6348ca8ab93/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be2053f3dda4a62aa0eb793adb19b6348ca8ab93/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=be2053f3dda4a62aa0eb793adb19b6348ca8ab93", "patch": "@@ -1,3 +1,12 @@\n+Sun Nov  2 23:21:36 1997  Richard Henderson  <rth@cygnus.com>\n+                          Jim Wilson  <wilson@cygnus.com>\n+\n+        * combine.c (try_combine): Don't elim_i1 when it is used in i2src.\n+\n+        * combine.c (try_combine): When setting elim_i2, check whether newi2pat\n+        sets i2dest.  When calling distribute_notes for i3dest_killed, pass\n+        elim_i2 and elim_i1.\n+\n Sun Nov  2 19:44:00 1997  Robert Lipe (robertl@dgii.com)\n \n \t* i386/sco5.h: enable -gstabs once again."}, {"sha": "80fac52e28e9fe3f7d4f22315f242c896dbddc82", "filename": "gcc/combine.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be2053f3dda4a62aa0eb793adb19b6348ca8ab93/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be2053f3dda4a62aa0eb793adb19b6348ca8ab93/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=be2053f3dda4a62aa0eb793adb19b6348ca8ab93", "patch": "@@ -1240,6 +1240,7 @@ try_combine (i3, i2, i1)\n   rtx i2pat;\n   /* Indicates if I2DEST or I1DEST is in I2SRC or I1_SRC.  */\n   int i2dest_in_i2src = 0, i1dest_in_i1src = 0, i2dest_in_i1src = 0;\n+  int i1dest_in_i2src = 0;\n   int i1_feeds_i3 = 0;\n   /* Notes that must be added to REG_NOTES in I3 and I2.  */\n   rtx new_i3_notes, new_i2_notes;\n@@ -1423,6 +1424,7 @@ try_combine (i3, i2, i1)\n   i2dest_in_i2src = reg_overlap_mentioned_p (i2dest, i2src);\n   i1dest_in_i1src = i1 && reg_overlap_mentioned_p (i1dest, i1src);\n   i2dest_in_i1src = i1 && reg_overlap_mentioned_p (i2dest, i1src);\n+  i1dest_in_i2src = i1 && reg_overlap_mentioned_p (i1dest, i2src);\n \n   /* See if I1 directly feeds into I3.  It does if I1DEST is not used\n      in I2SRC.  */\n@@ -2146,10 +2148,12 @@ try_combine (i3, i2, i1)\n     rtx i3links, i2links, i1links = 0;\n     rtx midnotes = 0;\n     register int regno;\n-    /* Compute which registers we expect to eliminate.  */\n-    rtx elim_i2 = (newi2pat || i2dest_in_i2src || i2dest_in_i1src\n+    /* Compute which registers we expect to eliminate.  newi2pat may be setting\n+       either i3dest or i2dest, so we must check it.  */\n+    rtx elim_i2 = ((newi2pat && reg_set_p (i2dest, newi2pat))\n+\t\t   || i2dest_in_i2src || i2dest_in_i1src\n \t\t   ? 0 : i2dest);\n-    rtx elim_i1 = i1 == 0 || i1dest_in_i1src ? 0 : i1dest;\n+    rtx elim_i1 = i1 == 0 || i1dest_in_i1src || i1dest_in_i2src ? 0 : i1dest;\n \n     /* Get the old REG_NOTES and LOG_LINKS from all our insns and\n        clear them.  */\n@@ -2317,7 +2321,7 @@ try_combine (i3, i2, i1)\n \t  distribute_notes (gen_rtx (EXPR_LIST, REG_DEAD, i3dest_killed,\n \t\t\t\t     NULL_RTX),\n \t\t\t    NULL_RTX, i3, newi2pat ? i2 : NULL_RTX,\n-\t\t\t    NULL_RTX, NULL_RTX);\n+\t\t\t    elim_i2, elim_i1);\n       }\n \n     if (i2dest_in_i2src)"}]}