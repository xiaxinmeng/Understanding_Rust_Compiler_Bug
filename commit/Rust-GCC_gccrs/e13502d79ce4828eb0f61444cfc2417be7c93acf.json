{"sha": "e13502d79ce4828eb0f61444cfc2417be7c93acf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTEzNTAyZDc5Y2U0ODI4ZWIwZjYxNDQ0Y2ZjMjQxN2JlN2M5M2FjZg==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-01-26T23:29:45Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-01-26T23:29:45Z"}, "message": "Change all uses of EX to SED.\n\nFrom-SVN: r3355", "tree": {"sha": "0372288705ba61f12be2bcf28256df840c967cb4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0372288705ba61f12be2bcf28256df840c967cb4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e13502d79ce4828eb0f61444cfc2417be7c93acf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e13502d79ce4828eb0f61444cfc2417be7c93acf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e13502d79ce4828eb0f61444cfc2417be7c93acf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e13502d79ce4828eb0f61444cfc2417be7c93acf/comments", "author": null, "committer": null, "parents": [{"sha": "d58913603fcb8c9c2ccf2e4569b0115a967e46b0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d58913603fcb8c9c2ccf2e4569b0115a967e46b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d58913603fcb8c9c2ccf2e4569b0115a967e46b0"}], "stats": {"total": 349, "additions": 151, "deletions": 198}, "files": [{"sha": "ad94d81178c0ce6a2a0f88e3cc2e2e0ae5f4ea5d", "filename": "gcc/fixinc.svr4", "status": "modified", "additions": 151, "deletions": 198, "changes": 349, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e13502d79ce4828eb0f61444cfc2417be7c93acf/gcc%2Ffixinc.svr4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e13502d79ce4828eb0f61444cfc2417be7c93acf/gcc%2Ffixinc.svr4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc.svr4?ref=e13502d79ce4828eb0f61444cfc2417be7c93acf", "patch": "@@ -63,15 +63,6 @@ case $LIB in\n \t;;\n esac\n \n-# This prevents /bin/ex from failing if the current terminal type is\n-# unrecognizable.\n-TERM=dumb\n-export TERM\n-# This prevents /bin/ex from failing if the EXINIT environment variable\n-# was set to something invalid.\n-EXINIT=\"\"\n-export EXINIT\n-\n echo 'Building fixincludes in ' ${LIB}\n \n # Determine whether this filesystem has symbolic links.\n@@ -279,28 +270,24 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n   chmod a+r /tmp/$base\n-  ex /tmp/$base <<EOF\n-  /^#define[ \t]*NULL[ \t]*0$/c\n-#ifndef NULL\n-#ifdef __cplusplus\n-#define __NULL_TYPE\n-#else /* !defined(__cplusplus) */\n-#define __NULL_TYPE (void *)\n-#endif /* !defined(__cplusplus) */\n-#define NULL (__NULL_TYPE 0)\n-#endif /* !defined(NULL) */\n-.\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e '/^#define[ \t]*NULL[ \t]*0$/c\\\n+#ifndef NULL\\\n+#ifdef __cplusplus\\\n+#define __NULL_TYPE\\\n+#else /* !defined(__cplusplus) */\\\n+#define __NULL_TYPE (void *)\\\n+#endif /* !defined(__cplusplus) */\\\n+#define NULL (__NULL_TYPE 0)\\\n+#endif /* !defined(NULL) */' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Likewise fix the definition of NULL in <stdio.h> so that it is conditional\n@@ -321,26 +308,22 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-  /^#define[ \t]*NULL[ \t]*0$/c\n-#ifdef __cplusplus\n-#define __NULL_TYPE\n-#else /* !defined(__cplusplus) */\n-#define __NULL_TYPE (void *)\n-#endif /* !defined(__cplusplus) */\n-#define NULL (__NULL_TYPE 0)\n-.\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e '/^#define[ \t]*NULL[ \t]*0$/c\\\n+#ifdef __cplusplus\\\n+#define __NULL_TYPE\\\n+#else /* !defined(__cplusplus) */\\\n+#define __NULL_TYPE (void *)\\\n+#endif /* !defined(__cplusplus) */\\\n+#define NULL (__NULL_TYPE 0)' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Likewise fix the definition of NULL in <dbm.h> so that it is conditional\n@@ -361,28 +344,24 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-  /^#define[ \t]*NULL[ \t]*((char \\*) 0)$/c\n-#ifndef NULL\n-#ifdef __cplusplus\n-#define __NULL_TYPE\n-#else /* !defined(__cplusplus) */\n-#define __NULL_TYPE (void *)\n-#endif /* !defined(__cplusplus) */\n-#define NULL (__NULL_TYPE 0)\n-#endif /* !defined(NULL) */\n-.\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e '/^#define[ \t]*NULL[ \t]*((char \\*) 0)$/c\\\n+#ifndef NULL\\\n+#ifdef __cplusplus\\\n+#define __NULL_TYPE\\\n+#else /* !defined(__cplusplus) */\\\n+#define __NULL_TYPE (void *)\\\n+#endif /* !defined(__cplusplus) */\\\n+#define NULL (__NULL_TYPE 0)\\\n+#endif /* !defined(NULL) */' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Add a prototyped declaration of mmap to <sys/mman.h>.\n@@ -402,26 +381,22 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-  /^extern caddr_t mmap();$/c\n-#ifdef __STDC__\n-extern caddr_t mmap (caddr_t addr, size_t len, int prot, int flags,\n-                     int fd, off_t off);\n-#else /* !defined(__STDC__) */\n-extern caddr_t mmap ();\n-#endif /* !defined(__STDC__) */\n-.\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e '/^extern caddr_t mmap();$/c\\\n+#ifdef __STDC__\\\n+extern caddr_t mmap (caddr_t addr, size_t len, int prot, int flags,\\\n+                     int fd, off_t off);\\\n+#else /* !defined(__STDC__) */\\\n+extern caddr_t mmap ();\\\n+#endif /* !defined(__STDC__) */' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Fix declarations of `ftw' and `nftw' in <ftw.h>.\n@@ -441,48 +416,42 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-  /^extern int ftw(const/c\n-#if !defined(_STYPES)\n-static\n-#else\n-extern\n-#endif\n-  int ftw(const char *, int (*)(const char *, const struct stat *, int), int);\n-.\n-  /^extern int nftw/c\n-#if defined(_STYPES)\n-static\n-#else\n-extern\n-#endif\n-  int nftw(const char *, int (*)(const char *, const struct stat *, int, struct FTW *),int, int);\n-.\n-  /^extern int ftw(),/c\n-#if !defined(_STYPES)\n-static\n-#else\n-extern\n-#endif\n-  int ftw();\n-#if defined(_STYPES)\n-static\n-#else\n-extern\n-#endif\n-  int nftw();\n-.\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e '/^extern int ftw(const/c\\\n+#if !defined(_STYPES)\\\n+static\\\n+#else\\\n+extern\\\n+#endif\\\n+  int ftw(const char *, int (*)(const char *, const struct stat *, int), int);' \\\n+  -e '/^extern int nftw/c\\\n+#if defined(_STYPES)\\\n+static\\\n+#else\\\n+extern\\\n+#endif\\\n+  int nftw(const char *, int (*)(const char *, const struct stat *, int, struct FTW *),int, int);' \\\n+  -e '/^extern int ftw(),/c\\\n+#if !defined(_STYPES)\\\n+static\\\n+#else\\\n+extern\\\n+#endif\\\n+  int ftw();\\\n+#if defined(_STYPES)\\\n+static\\\n+#else\\\n+extern\\\n+#endif\\\n+  int nftw();' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Add a `static' declaration of `getrnge' into <regexp.h>.\n@@ -509,24 +478,20 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   else\n     cp $file_to_fix /tmp/$base\n     chmod +w /tmp/$base\n-    ex /tmp/$base <<EOF\n-    /^static int[ \t]*size;/c\n-static int\tsize ;\n-\n-static int getrnge ();\n-.\n-    wq\n-EOF\n-    if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+    sed -e '/^static int[ \t]*size;/c\\\n+static int\tsize ;\\\n+\\\n+static int getrnge ();' /tmp/$base > /tmp/$base.sed\n+    if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n       true\n     else\n       echo Fixed $file_to_fix\n       rm -f ${LIB}/$file\n-      cp /tmp/$base ${LIB}/$file\n+      cp /tmp/$base.sed ${LIB}/$file\n       chmod a+r ${LIB}/$file\n     fi\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Disable apparent native compiler optimization cruft in SVR4.2 <string.h>\n@@ -548,19 +513,16 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-  g/#define.*__std_hdr_/d\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e 'g/#define.*__std_hdr_/d' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Add a #define of _SIGACTION_ into <sys/signal.h>.\n@@ -581,23 +543,19 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-  /^struct sigaction {/c\n-#define _SIGACTION_\n-struct  sigaction  {\n-.\n-  1,\\$s/(void *(\\*)())/(void (*)(int))/\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e '/^struct sigaction {/c\\\n+#define _SIGACTION_\\\n+struct  sigaction  {' \\\n+  -e '1,$s/(void *(\\*)())/(void (*)(int))/' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Fix declarations of `makedev', `major', and `minor' in <sys/mkdev.h>.\n@@ -617,36 +575,27 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-  /^dev_t makedev(const/c\n-static dev_t makedev(const major_t, const minor_t);\n-.\n-  /^dev_t makedev()/c\n-static dev_t makedev();\n-.\n-  /^major_t major(const/c\n-static major_t major(const dev_t);\n-.\n-  /^major_t major()/c\n-static major_t major();\n-.\n-  /^minor_t minor(const/c\n-static minor_t minor(const dev_t);\n-.\n-  /^minor_t minor()/c\n-static minor_t minor();\n-.\n-  wq\n-EOF\n-  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+  sed -e '/^dev_t makedev(const/c\\\n+static dev_t makedev(const major_t, const minor_t);' \\\n+  -e '/^dev_t makedev()/c\\\n+static dev_t makedev();' \\\n+  -e '/^major_t major(const/c\\\n+static major_t major(const dev_t);' \\\n+  -e '/^major_t major()/c\\\n+static major_t major();' \\\n+  -e '/^minor_t minor(const/c\\\n+static minor_t minor(const dev_t);' \\\n+  -e '/^minor_t minor()/c\\\n+static minor_t minor();' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n     true\n   else\n     echo Fixed $file_to_fix\n     rm -f ${LIB}/$file\n-    cp /tmp/$base ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n     chmod a+r ${LIB}/$file\n   fi\n-  rm -f /tmp/$base\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Fix reference to NMSZ in <sys/adv.h>.\n@@ -1126,46 +1075,50 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   echo Checking $file_to_fix\n   cp $file_to_fix /tmp/$base\n   chmod +w /tmp/$base\n-  ex /tmp/$base <<EOF\n-/^stat(/\n-s/(.*$/(/\n-j\n-s/;/,/\n-j\n-s/;/)/\n-/^lstat(/\n-s/(.*$/(/\n-j\n-s/;/,/\n-j\n-s/;/)/\n-/^fstat(/\n-s/(.*$/(/\n-j\n-s/;/,/\n-j\n-s/;/)/\n-/^mknod(/\n-s/(.*$/(/\n-j\n-s/;/,/\n-j\n-s/;/,/\n-j\n-s/;/)/\n-1,\\$s/\\([^A-Za-z]\\)path\\([^A-Za-z]\\)/\\1__path\\2/g\n-1,\\$s/\\([^A-Za-z]\\)buf\\([^A-Za-z]\\)/\\1__buf\\2/g\n-1,\\$s/\\([^A-Za-z]\\)fd\\([^A-Za-z]\\)/\\1__fd\\2/g\n-1,\\$s/ret\\([^u]\\)/__ret\\1/g\n-1,\\$s/\\([^_]\\)mode\\([^_]\\)/\\1__mode\\2/g\n-1,\\$s/\\([^_r]\\)dev\\([^_]\\)/\\1__dev\\2/g\n-wq\n-EOF\n-  echo Fixed $file_to_fix\n-  rm -f ${LIB}/$file\n-  cp /tmp/$base ${LIB}/$file\n-  chmod a+r ${LIB}/$file\n-  rm -f /tmp/$base\n+  sed -e '/^stat(/{\n+N\n+N\n+s/(.*)\\n/( /\n+s/;\\n/, /\n+s/;$/)/\n+}' \\\n+  -e '/^lstat(/{\n+N\n+N\n+s/(.*)\\n/( /\n+s/;\\n/, /\n+s/;$/)/\n+}' \\\n+  -e '/^fstat(/{\n+N\n+N\n+s/(.*)\\n/( /\n+s/;\\n/, /\n+s/;$/)/\n+}' \\\n+  -e '/^mknod(/{\n+N\n+N\n+N\n+s/(.*)\\n/( /\n+s/;\\n/, /g\n+s/;$/)/\n+}' \\\n+  -e '1,$s/\\([^A-Za-z]\\)path\\([^A-Za-z]\\)/\\1__path\\2/g' \\\n+  -e '1,$s/\\([^A-Za-z]\\)buf\\([^A-Za-z]\\)/\\1__buf\\2/g' \\\n+  -e '1,$s/\\([^A-Za-z]\\)fd\\([^A-Za-z]\\)/\\1__fd\\2/g' \\\n+  -e '1,$s/ret\\([^u]\\)/__ret\\1/g' \\\n+  -e '1,$s/\\([^_]\\)mode\\([^_]\\)/\\1__mode\\2/g' \\\n+  -e '1,$s/\\([^_r]\\)dev\\([^_]\\)/\\1__dev\\2/g' /tmp/$base > /tmp/$base.sed\n+  if cmp $file_to_fix /tmp/$base.sed >/dev/null 2>&1; then \\\n+    true\n+  else\n+    echo Fixed $file_to_fix\n+    rm -f ${LIB}/$file\n+    cp /tmp/$base.sed ${LIB}/$file\n+    chmod a+r ${LIB}/$file\n+  fi\n+  rm -f /tmp/$base /tmp/$base.sed\n fi\n \n # Sony NEWSOS 5.0 does not support the complete ANSI C standard."}]}