{"sha": "aee7846e9060634b4aa75155423a5dffcc616db8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWVlNzg0NmU5MDYwNjM0YjRhYTc1MTU1NDIzYTVkZmZjYzYxNmRiOA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2005-05-01T20:30:40Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2005-05-01T20:30:40Z"}, "message": "c-cppbuiltin.c (c_cpp_builtins): Do not define __GXX_WEAK__ to 1 if !flag_weak.\n\n\t* c-cppbuiltin.c (c_cpp_builtins): Do not define __GXX_WEAK__ to 1\n\tif !flag_weak.\n\t* doc/cpp.texi (__DEPRECATED): Document.\n\t(__EXCEPTIONS): Likewise.\n\t(__GXX_WEAK__): Likewise.\n\n\t* g++.dg/cpp/weak.C: New test.\n\nFrom-SVN: r99080", "tree": {"sha": "b79d0c9275e02095576cbc327005a01a02258d58", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b79d0c9275e02095576cbc327005a01a02258d58"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aee7846e9060634b4aa75155423a5dffcc616db8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aee7846e9060634b4aa75155423a5dffcc616db8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aee7846e9060634b4aa75155423a5dffcc616db8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aee7846e9060634b4aa75155423a5dffcc616db8/comments", "author": null, "committer": null, "parents": [{"sha": "3a57c6cb0c7e1ac5b177646328dbfa37e77bd364", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a57c6cb0c7e1ac5b177646328dbfa37e77bd364", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a57c6cb0c7e1ac5b177646328dbfa37e77bd364"}], "stats": {"total": 37, "additions": 36, "deletions": 1}, "files": [{"sha": "4f48773d438bfedd1c37cb627f3bfd4801bf4f60", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=aee7846e9060634b4aa75155423a5dffcc616db8", "patch": "@@ -1,5 +1,11 @@\n 2005-05-01  Mark Mitchell  <mark@codesourcery.com>\n \n+\t* c-cppbuiltin.c (c_cpp_builtins): Do not define __GXX_WEAK__ to 1\n+\tif !flag_weak.\n+\t* doc/cpp.texi (__DEPRECATED): Document.\n+\t(__EXCEPTIONS): Likewise.\n+\t(__GXX_WEAK__): Likewise.\n+\n \t* function.c (INVOKE__main): Do not define.\n \t(expand_main_function): Check HAS_INIT_SECTION when determining\n \twhether or not to call __main."}, {"sha": "bb656f46b0504bc7d5d5435fc50e7e12dec3aca7", "filename": "gcc/c-cppbuiltin.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Fc-cppbuiltin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Fc-cppbuiltin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-cppbuiltin.c?ref=aee7846e9060634b4aa75155423a5dffcc616db8", "patch": "@@ -328,7 +328,7 @@ c_cpp_builtins (cpp_reader *pfile)\n \n   if (c_dialect_cxx ())\n     {\n-      if (SUPPORTS_ONE_ONLY)\n+      if (flag_weak && SUPPORTS_ONE_ONLY) \n \tcpp_define (pfile, \"__GXX_WEAK__=1\");\n       else\n \tcpp_define (pfile, \"__GXX_WEAK__=0\");"}, {"sha": "71bd4ee26772d5d9cc65d72caa4fbd61c501550a", "filename": "gcc/doc/cpp.texi", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Fdoc%2Fcpp.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Fdoc%2Fcpp.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fcpp.texi?ref=aee7846e9060634b4aa75155423a5dffcc616db8", "patch": "@@ -2081,11 +2081,31 @@ respectively.  They exist to make the standard header given numerical limits\n work correctly.  You should not use these macros directly; instead, include\n the appropriate headers.\n \n+@item __DEPRECATED\n+This macro is defined, with value 1, when compiling a C++ source file\n+with warnings about deprecated constructs enabled.  These warnings are\n+enabled by default, but can be disabled with @option{-Wno-deprecated}.\n+\n+@item __EXCEPTIONS\n+This macro is defined, with value 1, when compiling a C++ source file\n+with exceptions enabled.  If @option{-fno-exceptions} was used when\n+compiling the file, then this macro will not be defined.\n+\n @item __USING_SJLJ_EXCEPTIONS__\n This macro is defined, with value 1, if the compiler uses the old\n mechanism based on @code{setjmp} and @code{longjmp} for exception\n handling.\n \n+@item __GXX_WEAK__\n+This macro is defined when compiling a C++ source file.  It has the\n+value 1 if the compiler will use weak symbols, COMDAT sections, or\n+other similar techniques to collapse symbols with ``vague linkage''\n+that are defined in multiple translation units.  If the compiler will\n+not collapse such symbols, this macro is defined with value 0.  In\n+general, user code should not need to make use of this macro; the\n+purpose of this macro is to ease implementation of the C++ runtime\n+library provided with G++.\n+\n @item __NEXT_RUNTIME__\n This macro is defined, with value 1, if (and only if) the NeXT runtime\n (as in @option{-fnext-runtime}) is in use for Objective-C@.  If the GNU"}, {"sha": "33dca447a1eb2bb359b32af1c533558f6154998f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=aee7846e9060634b4aa75155423a5dffcc616db8", "patch": "@@ -1,3 +1,7 @@\n+2005-05-01  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* g++.dg/cpp/weak.C: New test.\n+\n 2005-05-01  Zdenek Dvorak  <dvorakz@suse.cz>\n \n \t* gcc.dg/tree-ssa/loop-8.c: New test."}, {"sha": "6c51e1985aa868968eaa73ecb7212db69a38fcd6", "filename": "gcc/testsuite/g++.dg/cpp/weak.C", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp%2Fweak.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aee7846e9060634b4aa75155423a5dffcc616db8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp%2Fweak.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp%2Fweak.C?ref=aee7846e9060634b4aa75155423a5dffcc616db8", "patch": "@@ -0,0 +1,5 @@\n+// { dg-options \"-fno-weak\" }\n+\n+#if __GXX_WEAK__\n+#error \"__GXX_WEAK__ defined when -fno-weak in use\"\n+#endif"}]}