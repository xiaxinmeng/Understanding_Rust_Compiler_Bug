{"sha": "8d2547f23f5ffbcc884ad0218def1ff3b9fc516b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGQyNTQ3ZjIzZjVmZmJjYzg4NGFkMDIxOGRlZjFmZjNiOWZjNTE2Yg==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@gmail.com", "date": "2010-06-22T10:44:11Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2010-06-22T10:44:11Z"}, "message": "re PR target/44364 (Wrong code with e500 double floating point)\n\n\tPR target/44364\n\t* config/rs6000/e500.h (HARD_REGNO_CALLER_SAVE_MODE): Define.\n\t* caller-save.c (insert_restore, insert_save): Use non-validate\n\tform of adjust_address.\n\nFrom-SVN: r161163", "tree": {"sha": "9301d636aeb8282a23bfd34356ae6754e571e6de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9301d636aeb8282a23bfd34356ae6754e571e6de"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b/comments", "author": {"login": "amodra", "id": 6006325, "node_id": "MDQ6VXNlcjYwMDYzMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6006325?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amodra", "html_url": "https://github.com/amodra", "followers_url": "https://api.github.com/users/amodra/followers", "following_url": "https://api.github.com/users/amodra/following{/other_user}", "gists_url": "https://api.github.com/users/amodra/gists{/gist_id}", "starred_url": "https://api.github.com/users/amodra/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amodra/subscriptions", "organizations_url": "https://api.github.com/users/amodra/orgs", "repos_url": "https://api.github.com/users/amodra/repos", "events_url": "https://api.github.com/users/amodra/events{/privacy}", "received_events_url": "https://api.github.com/users/amodra/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3a4ec5cc08d808313a7e0d820193a9c405a313c5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a4ec5cc08d808313a7e0d820193a9c405a313c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a4ec5cc08d808313a7e0d820193a9c405a313c5"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "79e0bf8b3c468375388dae3b7cee654c634892c8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8d2547f23f5ffbcc884ad0218def1ff3b9fc516b", "patch": "@@ -1,3 +1,10 @@\n+2010-06-22  Alan Modra  <amodra@gmail.com>\n+\n+\tPR target/44364\n+\t* config/rs6000/e500.h (HARD_REGNO_CALLER_SAVE_MODE): Define.\n+\t* caller-save.c (insert_restore, insert_save): Use non-validate\n+\tform of adjust_address.\n+\n 2010-06-21  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n \n \tPR target/39690"}, {"sha": "78b508cc535e652b5e96b17209ccc39535cf4032", "filename": "gcc/caller-save.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b/gcc%2Fcaller-save.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b/gcc%2Fcaller-save.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcaller-save.c?ref=8d2547f23f5ffbcc884ad0218def1ff3b9fc516b", "patch": "@@ -1212,7 +1212,7 @@ insert_restore (struct insn_chain *chain, int before_p, int regno,\n       /* Check that insn to restore REGNO in save_mode[regno] is\n \t correct.  */\n       && reg_save_code (regno, save_mode[regno]) >= 0)\n-    mem = adjust_address (mem, save_mode[regno], 0);\n+    mem = adjust_address_nv (mem, save_mode[regno], 0);\n   else\n     mem = copy_rtx (mem);\n \n@@ -1293,7 +1293,7 @@ insert_save (struct insn_chain *chain, int before_p, int regno,\n       /* Check that insn to save REGNO in save_mode[regno] is\n \t correct.  */\n       && reg_save_code (regno, save_mode[regno]) >= 0)\n-    mem = adjust_address (mem, save_mode[regno], 0);\n+    mem = adjust_address_nv (mem, save_mode[regno], 0);\n   else\n     mem = copy_rtx (mem);\n "}, {"sha": "744f4de4c58045e428f3e4ac1e32364d7b54c30c", "filename": "gcc/config/rs6000/e500.h", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b/gcc%2Fconfig%2Frs6000%2Fe500.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d2547f23f5ffbcc884ad0218def1ff3b9fc516b/gcc%2Fconfig%2Frs6000%2Fe500.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fe500.h?ref=8d2547f23f5ffbcc884ad0218def1ff3b9fc516b", "patch": "@@ -1,5 +1,5 @@\n /* Enable E500 support.\n-   Copyright (C) 2003, 2004, 2006, 2007, 2008, 2009 Free Software\n+   Copyright (C) 2003, 2004, 2006, 2007, 2008, 2009, 2010 Free Software\n    Foundation, Inc.\n    This file is part of GCC.\n \n@@ -46,3 +46,10 @@\n \t  error (\"E500 and FPRs not supported\");\t\t\t\\\n       }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n+\n+/* When setting up caller-save slots (MODE == VOIDmode) ensure we\n+   allocate space for DFmode.  Save gprs in the correct mode too.  */\n+#define HARD_REGNO_CALLER_SAVE_MODE(REGNO, NREGS, MODE) \\\n+  (TARGET_E500_DOUBLE && ((MODE) == VOIDmode || (MODE) == DFmode)\t\\\n+   ? DFmode\t\t\t\t\t\t\t\t\\\n+   : choose_hard_reg_mode ((REGNO), (NREGS), false))"}]}