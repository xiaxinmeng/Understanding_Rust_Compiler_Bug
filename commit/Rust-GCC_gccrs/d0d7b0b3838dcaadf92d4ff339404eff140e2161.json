{"sha": "d0d7b0b3838dcaadf92d4ff339404eff140e2161", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDBkN2IwYjM4MzhkY2FhZGY5MmQ0ZmYzMzk0MDRlZmYxNDBlMjE2MQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-01-24T06:26:46Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-01-24T06:26:46Z"}, "message": "i386.opt (prefetch_sse): New targetsave.\n\n\n\t* i386.opt (prefetch_sse): New targetsave.\n\t* i386.c (ix86_function_specific_save): Save prefetch_sse.\n\t(ix86_function_specific_restore): Restore prefetch_sse and initialize\n\tix86_cost/ix86_tune_cost.\n\nFrom-SVN: r220077", "tree": {"sha": "0c9918199a04f76f7fd39ec6177c30a5696f3d22", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c9918199a04f76f7fd39ec6177c30a5696f3d22"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d0d7b0b3838dcaadf92d4ff339404eff140e2161", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0d7b0b3838dcaadf92d4ff339404eff140e2161", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d0d7b0b3838dcaadf92d4ff339404eff140e2161", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0d7b0b3838dcaadf92d4ff339404eff140e2161/comments", "author": null, "committer": null, "parents": [{"sha": "405a6b1c936fa1f5f77a06e9ba27fcae0b7d6752", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/405a6b1c936fa1f5f77a06e9ba27fcae0b7d6752", "html_url": "https://github.com/Rust-GCC/gccrs/commit/405a6b1c936fa1f5f77a06e9ba27fcae0b7d6752"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "77791a2a2fe74da14208703e2b1d1983fe968458", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0d7b0b3838dcaadf92d4ff339404eff140e2161/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0d7b0b3838dcaadf92d4ff339404eff140e2161/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d0d7b0b3838dcaadf92d4ff339404eff140e2161", "patch": "@@ -1,3 +1,10 @@\n+2015-01-23  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* i386.opt (prefetch_sse): New targetsave.\n+\t* i386.c (ix86_function_specific_save): Save prefetch_sse.\n+\t(ix86_function_specific_restore): Restore prefetch_sse and initialize\n+\tix86_cost/ix86_tune_cost.\n+\n 2015-01-23  David Malcolm  <dmalcolm@redhat.com>\n \n \t* config/rs6000/rs6000.c (rs6000_output_function_epilogue):"}, {"sha": "82fc4c56588acfdc4a0134a04342d0150476430e", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0d7b0b3838dcaadf92d4ff339404eff140e2161/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0d7b0b3838dcaadf92d4ff339404eff140e2161/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=d0d7b0b3838dcaadf92d4ff339404eff140e2161", "patch": "@@ -4466,6 +4466,7 @@ ix86_function_specific_save (struct cl_target_option *ptr,\n {\n   ptr->arch = ix86_arch;\n   ptr->schedule = ix86_schedule;\n+  ptr->prefetch_sse = x86_prefetch_sse;\n   ptr->tune = ix86_tune;\n   ptr->branch_cost = ix86_branch_cost;\n   ptr->tune_defaulted = ix86_tune_defaulted;\n@@ -4523,6 +4524,7 @@ ix86_function_specific_restore (struct gcc_options *opts,\n   ix86_arch = (enum processor_type) ptr->arch;\n   ix86_schedule = (enum attr_cpu) ptr->schedule;\n   ix86_tune = (enum processor_type) ptr->tune;\n+  x86_prefetch_sse = ptr->prefetch_sse;\n   opts->x_ix86_branch_cost = ptr->branch_cost;\n   ix86_tune_defaulted = ptr->tune_defaulted;\n   ix86_arch_specified = ptr->arch_specified;\n@@ -4553,6 +4555,13 @@ ix86_function_specific_restore (struct gcc_options *opts,\n   opts->x_ix86_tune_memset_strategy = ptr->x_ix86_tune_memset_strategy;\n   opts->x_ix86_tune_no_default = ptr->x_ix86_tune_no_default;\n   opts->x_ix86_veclibabi_type = ptr->x_ix86_veclibabi_type;\n+  ix86_tune_cost = processor_target_table[ix86_tune].cost;\n+  /* TODO: ix86_cost should be chosen at instruction or function granuality\n+     so for cold code we use size_cost even in !optimize_size compilation.  */\n+  if (opts->x_optimize_size)\n+    ix86_cost = &ix86_size_cost;\n+  else\n+    ix86_cost = ix86_tune_cost;\n \n   /* Recreate the arch feature tests if the arch changed */\n   if (old_arch != ix86_arch)"}, {"sha": "301430c2380e29aaa7c3a366dc9ab0f3fe587a08", "filename": "gcc/config/i386/i386.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d0d7b0b3838dcaadf92d4ff339404eff140e2161/gcc%2Fconfig%2Fi386%2Fi386.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d0d7b0b3838dcaadf92d4ff339404eff140e2161/gcc%2Fconfig%2Fi386%2Fi386.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.opt?ref=d0d7b0b3838dcaadf92d4ff339404eff140e2161", "patch": "@@ -60,6 +60,10 @@ const char *x_ix86_tune_string\n TargetSave\n unsigned char schedule\n \n+;; True if processor has SSE prefetch instruction.\n+TargetSave\n+unsigned char prefetch_sse\n+\n ;; branch cost\n TargetSave\n unsigned char branch_cost"}]}