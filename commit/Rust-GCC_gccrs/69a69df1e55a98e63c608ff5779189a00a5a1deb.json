{"sha": "69a69df1e55a98e63c608ff5779189a00a5a1deb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjlhNjlkZjFlNTVhOThlNjNjNjA4ZmY1Nzc5MTg5YTAwYTVhMWRlYg==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2018-11-22T20:26:21Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-11-22T20:26:21Z"}, "message": "odr-2_0.C: Drop dg-lto-options.\n\n\n\t* g++.dg/lto/odr-2_0.C: Drop dg-lto-options.\n\t* g++.dg/lto/odr-3_0.C: Likewise; harden for optimizing compilatoin.\n\nFrom-SVN: r266388", "tree": {"sha": "edb2a9f39a4ed5fa22b0b20df4b82012ce76ecc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/edb2a9f39a4ed5fa22b0b20df4b82012ce76ecc5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/69a69df1e55a98e63c608ff5779189a00a5a1deb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69a69df1e55a98e63c608ff5779189a00a5a1deb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69a69df1e55a98e63c608ff5779189a00a5a1deb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69a69df1e55a98e63c608ff5779189a00a5a1deb/comments", "author": null, "committer": null, "parents": [{"sha": "b9207e90c010284d91771501024a23fe259c3925", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9207e90c010284d91771501024a23fe259c3925", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9207e90c010284d91771501024a23fe259c3925"}], "stats": {"total": 53, "additions": 42, "deletions": 11}, "files": [{"sha": "6ebb5924fdb1a7a68e4aed981bf680c60038168f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=69a69df1e55a98e63c608ff5779189a00a5a1deb", "patch": "@@ -1,3 +1,8 @@\n+2018-11-22  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* g++.dg/lto/odr-2_0.C: Drop dg-lto-options.\n+\t* g++.dg/lto/odr-3_0.C: Likewise; harden for optimizing compilatoin.\n+\n 2018-11-22  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/85794"}, {"sha": "09fcff52bd4e11e14075de6ad3980bbbbd26eeb4", "filename": "gcc/testsuite/g++.dg/lto/odr-2_0.C", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_0.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_0.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_0.C?ref=69a69df1e55a98e63c608ff5779189a00a5a1deb", "patch": "@@ -1,5 +1,4 @@\n // { dg-lto-do link }\n-// { dg-lto-options { -O0 -flto } }\n enum a {} b; // { dg-lto-warning \"6: type 'a' violates the C\\\\+\\\\+ One Definition Rule\" }\n int\n main(void)"}, {"sha": "9e0c25dd36eec8e3e9c463490c9765482f815844", "filename": "gcc/testsuite/g++.dg/lto/odr-3_0.C", "status": "modified", "additions": 25, "deletions": 5, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_0.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_0.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_0.C?ref=69a69df1e55a98e63c608ff5779189a00a5a1deb", "patch": "@@ -1,12 +1,32 @@\n // { dg-lto-do link }\n-// { dg-lto-options { -O0 -flto }  } \n \n typedef struct {\n   int a; // { dg-lto-message \"the first difference of corresponding definitions is field 'a'\" }\n-} YYSTYPE; // { dg-lto-warning \"3: warning: type \u2018struct YYSTYPE\u2019 violates the C\\\\+\\\\+ One Definition Rule\" }\n-union yyalloc { // { dg-lto-warning \"7: type \u2018union yyalloc\u2019 violates the C\\\\+\\\\+ One Definition Rule\" }\n+} YYSTYPE; // { dg-lto-message \"violates the C\\\\+\\\\+ One Definition Rule\" 2 } \n+  // Here we get warning and a note:\n+  // warning: type 'struct YYSTYPE' violates the C++ One Definition Rule\n+  // note: type 'struct YYSTYPE' itself violates the C++ One Definition Rule\n+union yyalloc { // { dg-lto-warning \"7: type 'union yyalloc' violates the C\\\\+\\\\+ One Definition Rule\" }\n   short yyss;\n-  YYSTYPE yyvs; // { dg-lto-message \"the first difference of corresponding definitions is field \u2018yyvs\u2019\" }\n+  YYSTYPE yyvs; // { dg-lto-message \"the first difference of corresponding definitions is field 'yyvs'\" }\n };\n-void b() { yyalloc c; }\n+extern yyalloc a; // { dg-lto-warning \"16: 'a' violates the C\\\\+\\\\+ One Definition Rule\" }\n+int\n+main (void) {return a.yyss;}\n \n+/* Match warnings as follows:\n+  odr-3_0.C:5:3: warning: type 'struct YYSTYPE' violates the C++ One Definition Rule [-Wodr]\n+  odr-3_1.C:1:16: note: a different type is defined in another translation unit^\n+  odr-3_0.C:4:7: note: the first difference of corresponding definitions is field 'a'\n+  odr-3_1.C:1:16: note: a type with different number of fields is defined in another translation unit\n+  odr-3_0.C:9:7: warning: type 'union yyalloc' violates the C++ One Definition Rule [-Wodr]\n+  odr-3_1.C:6:7: note: a different type is defined in another translation unit\n+  odr-3_0.C:11:11: note: the first difference of corresponding definitions is field 'yyvs'\n+  odr-3_1.C:11:11: note: a field of same name but different type is defined in another translation unit\n+  odr-3_0.C:5:3: note: type 'struct YYSTYPE' itself violates the C++ One Definition Rule\n+  odr-3_0.C:13:16: warning: 'a' violates the C++ One Definition Rule [-Wodr]\n+  odr-3_1.C:6:7: note: type 'union yyalloc' itself violates the C++ One Definition Rule\n+  odr-3_0.C:9:7: note: the incompatible type is defined here\n+  odr-3_1.C:15:9: note: 'a' was previously declared here\n+  odr-3_1.C:15:9: note: code may be misoptimized unless -fno-strict-aliasing is used\n+*/"}, {"sha": "99d7bac5fe14cee6c150cab3667df621fb7c6af1", "filename": "gcc/testsuite/g++.dg/lto/odr-3_1.C", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/69a69df1e55a98e63c608ff5779189a00a5a1deb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_1.C?ref=69a69df1e55a98e63c608ff5779189a00a5a1deb", "patch": "@@ -1,9 +1,16 @@\n-typedef struct YYSTYPE { // { dg-lto-message \":16 a different type is defined in another translation unit\" }\n+typedef struct YYSTYPE { // { dg-lto-message \"type\" 2 }\n+   // We get two notes here:\n+   // note: a different type is defined in another translation unit\n+   // note: a type with different number of fields is defined in another translation unit\n } YYSTYPE;\n-union yyalloc { \n+union yyalloc { // { dg-lto-message \"type\" 2 }\n+   // We get here three notes:\n+   // note: a different type is defined in another translation unit\n+   // note: type 'union yyalloc' itself violates the C++ One Definition Rule\n   short yyss;\n-  YYSTYPE yyvs; // { dg-lto-message \"the first difference of corresponding definitions is field \u2018yyvs\u2019\" }\n+  YYSTYPE yyvs; // { dg-lto-message \"field of same name but different type is defined in another translation unit\" }\n \n-};\n-void a() { yyalloc b; }\n+}; \n+\n+yyalloc a;  // { dg-lto-message \"'a' was previously declared here\" }\n "}]}