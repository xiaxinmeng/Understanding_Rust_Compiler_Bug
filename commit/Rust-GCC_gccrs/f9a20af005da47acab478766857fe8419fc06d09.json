{"sha": "f9a20af005da47acab478766857fe8419fc06d09", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjlhMjBhZjAwNWRhNDdhY2FiNDc4NzY2ODU3ZmU4NDE5ZmMwNmQwOQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2014-10-27T18:41:02Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2014-10-27T18:41:02Z"}, "message": "alpha.c (alpha_set_memflags_1): Delete.\n\ngcc/\n\t* config/alpha/alpha.c (alpha_set_memflags_1): Delete.\n\t(alpha_set_memflags): Use FOR_EACH_SUBRTX_VAR.\n\nFrom-SVN: r216755", "tree": {"sha": "1874b37645bea7f78c072c072fa2446cf2f94763", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1874b37645bea7f78c072c072fa2446cf2f94763"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f9a20af005da47acab478766857fe8419fc06d09", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f9a20af005da47acab478766857fe8419fc06d09", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f9a20af005da47acab478766857fe8419fc06d09", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f9a20af005da47acab478766857fe8419fc06d09/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "572e01c7f631d9abba9071a4f646fa043b6700ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/572e01c7f631d9abba9071a4f646fa043b6700ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/572e01c7f631d9abba9071a4f646fa043b6700ff"}], "stats": {"total": 48, "additions": 23, "deletions": 25}, "files": [{"sha": "bee2fba71478751850f1ef854db59c30d4ac1e62", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f9a20af005da47acab478766857fe8419fc06d09/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f9a20af005da47acab478766857fe8419fc06d09/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f9a20af005da47acab478766857fe8419fc06d09", "patch": "@@ -1,3 +1,8 @@\n+2014-10-27  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* config/alpha/alpha.c (alpha_set_memflags_1): Delete.\n+\t(alpha_set_memflags): Use FOR_EACH_SUBRTX_VAR.\n+\n 2014-10-27  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* config/alpha/alpha.c: Include rtl-iter.h."}, {"sha": "09ab4ba16cbf1b279e1f4c06c8098600d7ece692", "filename": "gcc/config/alpha/alpha.c", "status": "modified", "additions": 18, "deletions": 25, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f9a20af005da47acab478766857fe8419fc06d09/gcc%2Fconfig%2Falpha%2Falpha.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f9a20af005da47acab478766857fe8419fc06d09/gcc%2Fconfig%2Falpha%2Falpha.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Falpha%2Falpha.c?ref=f9a20af005da47acab478766857fe8419fc06d09", "patch": "@@ -1676,30 +1676,6 @@ alpha_secondary_reload (bool in_p, rtx x, reg_class_t rclass_i,\n   return NO_REGS;\n }\n \f\n-/* Subfunction of the following function.  Update the flags of any MEM\n-   found in part of X.  */\n-\n-static int\n-alpha_set_memflags_1 (rtx *xp, void *data)\n-{\n-  rtx x = *xp, orig = (rtx) data;\n-\n-  if (!MEM_P (x))\n-    return 0;\n-\n-  MEM_VOLATILE_P (x) = MEM_VOLATILE_P (orig);\n-  MEM_NOTRAP_P (x) = MEM_NOTRAP_P (orig);\n-  MEM_READONLY_P (x) = MEM_READONLY_P (orig);\n-\n-  /* Sadly, we cannot use alias sets because the extra aliasing\n-     produced by the AND interferes.  Given that two-byte quantities\n-     are the only thing we would be able to differentiate anyway,\n-     there does not seem to be any point in convoluting the early\n-     out of the alias check.  */\n-\n-  return -1;\n-}\n-\n /* Given SEQ, which is an INSN list, look for any MEMs in either\n    a SET_DEST or a SET_SRC and copy the in-struct, unchanging, and\n    volatile flags from REF into each of the MEMs found.  If REF is not\n@@ -1721,9 +1697,26 @@ alpha_set_memflags (rtx seq, rtx ref)\n       && !MEM_READONLY_P (ref))\n     return;\n \n+  subrtx_var_iterator::array_type array;\n   for (insn = as_a <rtx_insn *> (seq); insn; insn = NEXT_INSN (insn))\n     if (INSN_P (insn))\n-      for_each_rtx (&PATTERN (insn), alpha_set_memflags_1, (void *) ref);\n+      FOR_EACH_SUBRTX_VAR (iter, array, PATTERN (insn), NONCONST)\n+\t{\n+\t  rtx x = *iter;\n+\t  if (MEM_P (x))\n+\t    {\n+\t      MEM_VOLATILE_P (x) = MEM_VOLATILE_P (ref);\n+\t      MEM_NOTRAP_P (x) = MEM_NOTRAP_P (ref);\n+\t      MEM_READONLY_P (x) = MEM_READONLY_P (ref);\n+\t      /* Sadly, we cannot use alias sets because the extra\n+\t\t aliasing produced by the AND interferes.  Given that\n+\t\t two-byte quantities are the only thing we would be\n+\t\t able to differentiate anyway, there does not seem to\n+\t\t be any point in convoluting the early out of the\n+\t\t alias check.  */\n+\t      iter.skip_subrtxes ();\n+\t    }\n+\t}\n     else\n       gcc_unreachable ();\n }"}]}