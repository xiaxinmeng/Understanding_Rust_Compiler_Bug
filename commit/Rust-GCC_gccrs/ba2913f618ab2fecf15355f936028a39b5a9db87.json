{"sha": "ba2913f618ab2fecf15355f936028a39b5a9db87", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmEyOTEzZjYxOGFiMmZlY2YxNTM1NWY5MzYwMjhhMzliNWE5ZGI4Nw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2021-04-09T12:43:14Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2021-04-09T12:43:14Z"}, "message": "aarch64: Use x30 as temporary in SVE TLSDESC patterns\n\ngcc.dg/torture/tls/tls-reload-1.c started ICEing for SVE some time\nduring the GCC 11 cycle (not sure when).  The problem is that we\nhad an output reload on a call_insn, which isn't a supported\ncombination.\n\nThis patch uses LR_REGNUM instead.  The resulting \"blr x30\"\nmight not perform as well on some CPUs, but in this context\nthe difference shouldn't be noticeable.\n\ngcc/\n\t* config/aarch64/aarch64.md (tlsdesc_small_sve_<mode>): Use X30\n\tas the temporary register.", "tree": {"sha": "4b67b0eb8f9cfdbaa0333ca0fe5b347fb6dc9b69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b67b0eb8f9cfdbaa0333ca0fe5b347fb6dc9b69"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ba2913f618ab2fecf15355f936028a39b5a9db87", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba2913f618ab2fecf15355f936028a39b5a9db87", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba2913f618ab2fecf15355f936028a39b5a9db87", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba2913f618ab2fecf15355f936028a39b5a9db87/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "40ccb47b505b528244ee305923681c0ae3b6f4d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40ccb47b505b528244ee305923681c0ae3b6f4d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40ccb47b505b528244ee305923681c0ae3b6f4d5"}], "stats": {"total": 5, "additions": 2, "deletions": 3}, "files": [{"sha": "a149748045f836e3914379610a3a8cf42275c634", "filename": "gcc/config/aarch64/aarch64.md", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba2913f618ab2fecf15355f936028a39b5a9db87/gcc%2Fconfig%2Faarch64%2Faarch64.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba2913f618ab2fecf15355f936028a39b5a9db87/gcc%2Fconfig%2Faarch64%2Faarch64.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.md?ref=ba2913f618ab2fecf15355f936028a39b5a9db87", "patch": "@@ -6818,10 +6818,9 @@\n \t\t\tUNSPEC_TLSDESC))\n \t      (const_int 0)))\n    (unspec:DI [(match_operand:DI 1 \"const_int_operand\")] UNSPEC_CALLEE_ABI)\n-   (clobber (reg:DI LR_REGNUM))\n-   (clobber (match_scratch:DI 2 \"=r\"))]\n+   (clobber (reg:DI LR_REGNUM))]\n   \"TARGET_TLS_DESC && TARGET_SVE\"\n-  \"adrp\\\\tx0, %A0\\;ldr\\\\t%<w>2, [x0, #%L0]\\;add\\\\t<w>0, <w>0, %L0\\;.tlsdesccall\\\\t%0\\;blr\\\\t%2\"\n+  \"adrp\\\\tx0, %A0\\;ldr\\\\t<w>30, [x0, #%L0]\\;add\\\\t<w>0, <w>0, %L0\\;.tlsdesccall\\\\t%0\\;blr\\\\tx30\"\n   [(set_attr \"type\" \"call\")\n    (set_attr \"length\" \"16\")])\n "}]}