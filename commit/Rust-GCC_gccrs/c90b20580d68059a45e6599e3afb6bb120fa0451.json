{"sha": "c90b20580d68059a45e6599e3afb6bb120fa0451", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzkwYjIwNTgwZDY4MDU5YTQ1ZTY1OTllM2FmYjZiYjEyMGZhMDQ1MQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-09-09T12:31:35Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-09-09T12:31:35Z"}, "message": "[multiple changes]\n\n2010-09-09  Thomas Quinot  <quinot@adacore.com>\n\n\t* s-strxdr.adb, gnat_rm.texi, s-stratt-xdr.adb, s-stratt.ads: Rename\n\ts-strxdr.adb to s-stratt-xdr.adb\n\n2010-09-09  Robert Dewar  <dewar@adacore.com>\n\n\t* ali-util.adb (Obsolescent_Check): Removed.\n\t* gprep.adb (Obsolescent_Check): Removed.\n\tRemove Obsolescent_Check parameter in Scng instantiation\n\t* prj-err.adb (Obsolescent_Check): Removed.\n\t* prj-err.ads (Obsolescent_Check): Removed.\n\tRemove Obsolescent_Check parameter in Scng instantiation\n\t* scans.ads (Based_Literal_Uses_Colon): New flag\n\t* scn.adb (Obsolscent_Check_Flag): Removed\n\t(Obsolscent_Check): Removed\n\t(Set_Obsolescent_Check): Removed\n\t(Post_Scan): Add handling for obsolescent features\n\t* scn.ads (Obsolscent_Check): Removed\n\t(Set_Obsolescent_Check): Removed\n\t(Post_Scan): Can no longer be inlined\n\tRemove Obsolescent_Check from instantiation of Scng\n\t* scng.adb (Nlit): Set Based_Literal_Uses_Colon\n\t(Nlit): Remove handling of obsolescent check\n\t(Scan, case '%'): Remove handling of obsolescent check\n\t(Scan, case '|'): Call Post_Scan\n\t(Scan, case '!'): Remove handling of obsolescent check, call Post_Scan\n\t* scng.ads Remove Obsolescent_Check argument from Scng generic\n\t(Post_Scan): Now called for Tok_Vertical_Bar\n\t* sinput-l.adb: Remove calls to Set_Obsolescent_Check\n\nFrom-SVN: r164081", "tree": {"sha": "9bcd2dc0363cc5444998418b53a4a6358f45d5df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9bcd2dc0363cc5444998418b53a4a6358f45d5df"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c90b20580d68059a45e6599e3afb6bb120fa0451", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c90b20580d68059a45e6599e3afb6bb120fa0451", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c90b20580d68059a45e6599e3afb6bb120fa0451", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c90b20580d68059a45e6599e3afb6bb120fa0451/comments", "author": null, "committer": null, "parents": [{"sha": "48a54da312290227901800f0124e5fb9e4374bd7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48a54da312290227901800f0124e5fb9e4374bd7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48a54da312290227901800f0124e5fb9e4374bd7"}], "stats": {"total": 329, "additions": 164, "deletions": 165}, "files": [{"sha": "0d2bd8e137ba9691de6de73860d65ef8f86d32a4", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -1,3 +1,34 @@\n+2010-09-09  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* s-strxdr.adb, gnat_rm.texi, s-stratt-xdr.adb, s-stratt.ads: Rename\n+\ts-strxdr.adb to s-stratt-xdr.adb\n+\n+2010-09-09  Robert Dewar  <dewar@adacore.com>\n+\n+\t* ali-util.adb (Obsolescent_Check): Removed.\n+\t* gprep.adb (Obsolescent_Check): Removed.\n+\tRemove Obsolescent_Check parameter in Scng instantiation\n+\t* prj-err.adb (Obsolescent_Check): Removed.\n+\t* prj-err.ads (Obsolescent_Check): Removed.\n+\tRemove Obsolescent_Check parameter in Scng instantiation\n+\t* scans.ads (Based_Literal_Uses_Colon): New flag\n+\t* scn.adb (Obsolscent_Check_Flag): Removed\n+\t(Obsolscent_Check): Removed\n+\t(Set_Obsolescent_Check): Removed\n+\t(Post_Scan): Add handling for obsolescent features\n+\t* scn.ads (Obsolscent_Check): Removed\n+\t(Set_Obsolescent_Check): Removed\n+\t(Post_Scan): Can no longer be inlined\n+\tRemove Obsolescent_Check from instantiation of Scng\n+\t* scng.adb (Nlit): Set Based_Literal_Uses_Colon\n+\t(Nlit): Remove handling of obsolescent check\n+\t(Scan, case '%'): Remove handling of obsolescent check\n+\t(Scan, case '|'): Call Post_Scan\n+\t(Scan, case '!'): Remove handling of obsolescent check, call Post_Scan\n+\t* scng.ads Remove Obsolescent_Check argument from Scng generic\n+\t(Post_Scan): Now called for Tok_Vertical_Bar\n+\t* sinput-l.adb: Remove calls to Set_Obsolescent_Check\n+\n 2010-09-09  Doug Rupp  <rupp@adacore.com>\n \n \t* gnatlbr.adb: Removed."}, {"sha": "8c837b4177d3161b7cc20633835eb5958fb78faa", "filename": "gcc/ada/ali-util.adb", "status": "modified", "additions": 1, "deletions": 14, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fali-util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fali-util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fali-util.adb?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -50,8 +50,6 @@ package body ALI.Util is\n \n    procedure Error_Msg_SP (Msg : String);\n \n-   procedure Obsolescent_Check (S : Source_Ptr);\n-\n    --  Instantiation of Styleg, needed to instantiate Scng\n \n    package Style is new Styleg\n@@ -61,8 +59,7 @@ package body ALI.Util is\n    --  Get_File_Checksum).\n \n    package Scanner is new Scng\n-     (Post_Scan, Error_Msg, Error_Msg_S, Error_Msg_SC, Error_Msg_SP,\n-      Obsolescent_Check, Style);\n+     (Post_Scan, Error_Msg, Error_Msg_S, Error_Msg_SC, Error_Msg_SP, Style);\n \n    type Header_Num is range 0 .. 1_000;\n \n@@ -201,16 +198,6 @@ package body ALI.Util is\n       Interfaces.Reset;\n    end Initialize_ALI_Source;\n \n-   -----------------------\n-   -- Obsolescent_Check --\n-   -----------------------\n-\n-   procedure Obsolescent_Check (S : Source_Ptr) is\n-      pragma Warnings (Off, S);\n-   begin\n-      null;\n-   end Obsolescent_Check;\n-\n    ---------------\n    -- Post_Scan --\n    ---------------"}, {"sha": "0905f1c9a3e14bfa95318b297be5436ec34a175c", "filename": "gcc/ada/gnat_rm.texi", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fgnat_rm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fgnat_rm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_rm.texi?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -7182,16 +7182,16 @@ for scalar types.\n @cindex Stream oriented attributes\n The XDR implementation is provided as an alternative body of the\n @code{System.Stream_Attributes} package, in the file\n-@file{s-strxdr.adb} in the GNAT library.\n-There is no @file{s-strxdr.ads} file.\n+@file{s-stratt-xdr.adb} in the GNAT library.\n+There is no @file{s-stratt-xdr.ads} file.\n In order to install the XDR implementation, do the following:\n @enumerate\n @item Replace the default implementation of the\n @code{System.Stream_Attributes} package with the XDR implementation.\n For example on a Unix platform issue the commands:\n @smallexample\n-$ mv s-stratt.adb s-strold.adb\n-$ mv s-strxdr.adb s-stratt.adb\n+$ mv s-stratt.adb s-stratt-default.adb\n+$ mv s-stratt-xdr.adb s-stratt.adb\n @end smallexample\n \n @item"}, {"sha": "88710d6206cfa967fd12e858fe11f620eeb9763a", "filename": "gcc/ada/gprep.adb", "status": "modified", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fgprep.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fgprep.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgprep.adb?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -91,9 +91,6 @@ package body GPrep is\n    procedure Display_Copyright;\n    --  Display the copyright notice\n \n-   procedure Obsolescent_Check (S : Source_Ptr);\n-   --  Null procedure, needed by instantiation of Scng below\n-\n    procedure Post_Scan;\n    --  Null procedure, needed by instantiation of Scng below\n \n@@ -103,7 +100,6 @@ package body GPrep is\n       Errutil.Error_Msg_S,\n       Errutil.Error_Msg_SC,\n       Errutil.Error_Msg_SP,\n-      Obsolescent_Check,\n       Errutil.Style);\n    --  The scanner for the preprocessor\n \n@@ -311,16 +307,6 @@ package body GPrep is\n       New_Line (Outfile.all);\n    end New_EOL_To_Outfile;\n \n-   -----------------------\n-   -- Obsolescent_Check --\n-   -----------------------\n-\n-   procedure Obsolescent_Check (S : Source_Ptr) is\n-      pragma Warnings (Off, S);\n-   begin\n-      null;\n-   end Obsolescent_Check;\n-\n    ---------------\n    -- Post_Scan --\n    ---------------"}, {"sha": "f0e10f891f752a57c4a78b545f97fdb189f0953e", "filename": "gcc/ada/prj-err.adb", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fprj-err.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fprj-err.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-err.adb?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2002-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2002-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -29,16 +29,6 @@ with Stringt;  use Stringt;\n \n package body Prj.Err is\n \n-   -----------------------\n-   -- Obsolescent_Check --\n-   -----------------------\n-\n-   procedure Obsolescent_Check (S : Source_Ptr) is\n-      pragma Warnings (Off, S);\n-   begin\n-      null;\n-   end Obsolescent_Check;\n-\n    ---------------\n    -- Post_Scan --\n    ---------------"}, {"sha": "3f6b684130cd0badc525c7305307ffe9cb713d77", "filename": "gcc/ada/prj-err.ads", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fprj-err.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fprj-err.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-err.ads?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2002-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2002-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -82,20 +82,16 @@ package Prj.Err is\n    -- Scanner --\n    -------------\n \n-   procedure Obsolescent_Check (S : Source_Ptr);\n-   --  Dummy null procedure for Scng instantiation\n-\n    procedure Post_Scan;\n    --  Convert an Ada operator symbol into a standard string\n \n    package Scanner is new Scng\n-     (Post_Scan         => Post_Scan,\n-      Error_Msg         => Errutil.Error_Msg,\n-      Error_Msg_S       => Errutil.Error_Msg_S,\n-      Error_Msg_SC      => Errutil.Error_Msg_SC,\n-      Error_Msg_SP      => Errutil.Error_Msg_SP,\n-      Obsolescent_Check => Obsolescent_Check,\n-      Style             => Errutil.Style);\n+     (Post_Scan    => Post_Scan,\n+      Error_Msg    => Errutil.Error_Msg,\n+      Error_Msg_S  => Errutil.Error_Msg_S,\n+      Error_Msg_SC => Errutil.Error_Msg_SC,\n+      Error_Msg_SP => Errutil.Error_Msg_SP,\n+      Style        => Errutil.Style);\n    --  Instantiation of the generic scanner\n \n end Prj.Err;"}, {"sha": "86e190a98b5e14c04261e0f571c929c73ffce903", "filename": "gcc/ada/s-stratt-xdr.adb", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fs-stratt-xdr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fs-stratt-xdr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-stratt-xdr.adb?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "previous_filename": "gcc/ada/s-strxdr.adb"}, {"sha": "498700e06b5f048cf11a8826f6eccfdfbfefcaa6", "filename": "gcc/ada/s-stratt.ads", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fs-stratt.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fs-stratt.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-stratt.ads?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -157,10 +157,10 @@ package System.Stream_Attributes is\n \n    function Block_IO_OK return Boolean;\n    --  Package System.Stream_Attributes has several bodies - the default one\n-   --  distributed with GNAT, s-strxdr.adb which is based on the XDR standard\n-   --  and s-stratt.adb for Garlic. All three bodies share the same spec. The\n-   --  role of this function is to determine whether the current version of\n-   --  System.Stream_Attributes is able to support block IO.\n+   --  distributed with GNAT, and s-stratt-xdr.adb, which is based on the XDR\n+   --  standard. Both bodies share the same spec. The role of this function is\n+   --  to indicate whether the current version of System.Stream_Attributes\n+   --  supports block IO.\n \n private\n    pragma Inline (I_AD);"}, {"sha": "0532862cced2ee6ed1f468a4a5bdc36d7108202c", "filename": "gcc/ada/scans.ads", "status": "modified", "additions": 18, "deletions": 11, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscans.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscans.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscans.ads?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -415,27 +415,34 @@ package Scans is\n    --  We do things this way to minimize the impact on comment scanning.\n \n    Character_Code : Char_Code;\n-   --  Valid only when Token is Tok_Char_Literal\n+   --  Valid only when Token is Tok_Char_Literal. Contains the value of the\n+   --  scanned literal.\n \n    Real_Literal_Value : Ureal;\n-   --  Valid only when Token is Tok_Real_Literal\n+   --  Valid only when Token is Tok_Real_Literal, contains the value of the\n+   --  scanned literal.\n \n    Int_Literal_Value : Uint;\n-   --  Valid only when Token = Tok_Integer_Literal;\n+   --  Valid only when Token = Tok_Integer_Literal, contains the value of the\n+   --  scanned literal.\n+\n+   Based_Literal_Uses_Colon : Boolean;\n+   --  Valid only when Token = Tok_Integer_Literal or Tok_Real_Literal. Set\n+   --  True only for the case of a based literal using ':' instead of '#'.\n \n    String_Literal_Id : String_Id;\n-   --  Id for currently scanned string value.\n    --  Valid only when Token = Tok_String_Literal or Tok_Operator_Symbol.\n+   --  Contains the Id for currently scanned string value.\n \n    Wide_Character_Found : Boolean := False;\n-   --  Set True if wide character found (i.e. a character that does not fit\n-   --  in Character, but fits in Wide_Wide_Character).\n-   --  Valid only when Token = Tok_String_Literal.\n+   --  Valid only when Token = Tok_String_Literal. Set True if wide character\n+   --  found (i.e. a character that does not fit in Character, but fits in\n+   --  Wide_Wide_Character).\n \n    Wide_Wide_Character_Found : Boolean := False;\n-   --  Set True if wide wide character found (i.e. a character that does\n-   --  not fit in Character or Wide_Character).\n-   --  Valid only when Token = Tok_String_Literal.\n+   --  Valid only when Token = Tok_String_Literal. Set True if wide wide\n+   --  character found (i.e. a character that does not fit in Character or\n+   --  Wide_Character).\n \n    Special_Character : Character;\n    --  Valid only when Token = Tok_Special. Returns one of the characters"}, {"sha": "eb6a97810d0ab42ce67a152fa09a212a77e3d851", "filename": "gcc/ada/scn.adb", "status": "modified", "additions": 74, "deletions": 31, "changes": 105, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscn.adb?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -44,10 +44,6 @@ package body Scn is\n \n    use ASCII;\n \n-   Obsolescent_Check_Flag : Boolean := True;\n-   --  Obsolescent check activation. Set to False during integrated\n-   --  preprocessing.\n-\n    Used_As_Identifier : array (Token_Type) of Boolean;\n    --  Flags set True if a given keyword is used as an identifier (used to\n    --  make sure that we only post an error message for incorrect use of a\n@@ -340,28 +336,61 @@ package body Scn is\n       end loop;\n    end Initialize_Scanner;\n \n-   -----------------------\n-   -- Obsolescent_Check --\n-   -----------------------\n-\n-   procedure Obsolescent_Check (S : Source_Ptr) is\n-   begin\n-      if Obsolescent_Check_Flag then\n-         --  This is a pain in the neck case, since we normally need a node to\n-         --  call Check_Restrictions, and all we have is a source pointer. The\n-         --  easiest thing is to construct a dummy node. A bit kludgy, but this\n-         --  is a marginal case. It's not worth trying to do things more\n-         --  cleanly.\n-\n-         Check_Restriction (No_Obsolescent_Features, New_Node (N_Empty, S));\n-      end if;\n-   end Obsolescent_Check;\n-\n    ---------------\n    -- Post_Scan --\n    ---------------\n \n    procedure Post_Scan is\n+      procedure Check_Obsolescent_Features_Restriction (S : Source_Ptr);\n+      --  This checks for Obsolescent_Features restriction being active, and\n+      --  if so, flags the restriction as occurring at the given scan location.\n+\n+      procedure Check_Obsolete_Base_Char;\n+      --  Check for numeric literal using ':' instead of '#' for based case\n+\n+      --------------------------------------------\n+      -- Check_Obsolescent_Features_Restriction --\n+      --------------------------------------------\n+\n+      procedure Check_Obsolescent_Features_Restriction (S : Source_Ptr) is\n+      begin\n+         --  Normally we have a node handy for posting restrictions. We don't\n+         --  have such a node here, so construct a dummy one with the right\n+         --  scan pointer. This is only used to get the Sloc value anyway.\n+\n+         Check_Restriction (No_Obsolescent_Features, New_Node (N_Empty, S));\n+      end Check_Obsolescent_Features_Restriction;\n+\n+      ------------------------------\n+      -- Check_Obsolete_Base_Char --\n+      ------------------------------\n+\n+      procedure Check_Obsolete_Base_Char is\n+         S : Source_Ptr;\n+\n+      begin\n+         if Based_Literal_Uses_Colon then\n+\n+            --  Find the : for the restriction or warning message\n+\n+            S := Token_Ptr;\n+            while Source (S) /= ':' loop\n+               S := S + 1;\n+            end loop;\n+\n+            Check_Obsolescent_Features_Restriction (S);\n+\n+            if Warn_On_Obsolescent_Feature then\n+               Error_Msg\n+                 (\"use of \"\":\"\" is an obsolescent feature (RM J.2(3))?\", S);\n+               Error_Msg\n+                 (\"\\use \"\"'#\"\" instead?\", S);\n+            end if;\n+         end if;\n+      end Check_Obsolete_Base_Char;\n+\n+   --  Start of processing for Post_Scan\n+\n    begin\n       case Token is\n          when Tok_Char_Literal =>\n@@ -376,10 +405,12 @@ package body Scn is\n          when Tok_Real_Literal =>\n             Token_Node := New_Node (N_Real_Literal, Token_Ptr);\n             Set_Realval (Token_Node, Real_Literal_Value);\n+            Check_Obsolete_Base_Char;\n \n          when Tok_Integer_Literal =>\n             Token_Node := New_Node (N_Integer_Literal, Token_Ptr);\n             Set_Intval (Token_Node, Int_Literal_Value);\n+            Check_Obsolete_Base_Char;\n \n          when Tok_String_Literal =>\n             Token_Node := New_Node (N_String_Literal, Token_Ptr);\n@@ -389,11 +420,32 @@ package body Scn is\n               (Token_Node, Wide_Wide_Character_Found);\n             Set_Strval (Token_Node, String_Literal_Id);\n \n+            if Source (Token_Ptr) = '%' then\n+               Check_Obsolescent_Features_Restriction (Token_Ptr);\n+\n+               if Warn_On_Obsolescent_Feature then\n+                  Error_Msg_SC\n+                    (\"use of \"\"'%\"\" is an obsolescent feature (RM J.2(4))?\");\n+                  Error_Msg_SC (\"\\use \"\"\"\"\"\" instead?\");\n+               end if;\n+            end if;\n+\n          when Tok_Operator_Symbol =>\n             Token_Node := New_Node (N_Operator_Symbol, Token_Ptr);\n             Set_Chars (Token_Node, Token_Name);\n             Set_Strval (Token_Node, String_Literal_Id);\n \n+         when Tok_Vertical_Bar =>\n+            if Source (Token_Ptr) = '!' then\n+               Check_Obsolescent_Features_Restriction (Token_Ptr);\n+\n+               if Warn_On_Obsolescent_Feature then\n+                  Error_Msg_SC\n+                    (\"use of \"\"'!\"\" is an obsolescent feature (RM J.2(2))?\");\n+                  Error_Msg_SC (\"\\use \"\"'|\"\" instead?\");\n+               end if;\n+            end if;\n+\n          when others =>\n             null;\n       end case;\n@@ -430,13 +482,4 @@ package body Scn is\n       Set_Chars (Token_Node, Token_Name);\n    end Scan_Reserved_Identifier;\n \n-   ---------------------------\n-   -- Set_Obsolescent_Check --\n-   ---------------------------\n-\n-   procedure Set_Obsolescent_Check (Value : Boolean) is\n-   begin\n-      Obsolescent_Check_Flag := Value;\n-   end Set_Obsolescent_Check;\n-\n end Scn;"}, {"sha": "ea7b22be9f164372d9ca2746756669aabdf3d4c1", "filename": "gcc/ada/scn.ads", "status": "modified", "additions": 7, "deletions": 16, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscn.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscn.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscn.ads?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -47,15 +47,7 @@ package Scn is\n    --  Determines the casing style of the current token, which is\n    --  either a keyword or an identifier. See also package Casing.\n \n-   procedure Obsolescent_Check (S : Source_Ptr);\n-   --  Called to handle pragma restrictions check for usage of obsolescent\n-   --  character replacements during the scan.\n-\n-   procedure Set_Obsolescent_Check (Value : Boolean);\n-   --  Activate or not obsolescent check\n-\n    procedure Post_Scan;\n-   pragma Inline (Post_Scan);\n    --  Create nodes for tokens: Char_Literal, Identifier, Real_Literal,\n    --  Integer_Literal, String_Literal and Operator_Symbol.\n \n@@ -75,13 +67,12 @@ package Scn is\n    --  generic package Scng with routines appropriate to the compiler\n \n    package Scanner is new Scng\n-     (Post_Scan         => Post_Scan,\n-      Error_Msg         => Error_Msg,\n-      Error_Msg_S       => Error_Msg_S,\n-      Error_Msg_SC      => Error_Msg_SC,\n-      Error_Msg_SP      => Error_Msg_SP,\n-      Obsolescent_Check => Obsolescent_Check,\n-      Style             => Style.Style_Inst);\n+     (Post_Scan    => Post_Scan,\n+      Error_Msg    => Error_Msg,\n+      Error_Msg_S  => Error_Msg_S,\n+      Error_Msg_SC => Error_Msg_SC,\n+      Error_Msg_SP => Error_Msg_SP,\n+      Style        => Style.Style_Inst);\n \n    procedure Scan renames Scanner.Scan;\n    --  Scan scans out the next token, and advances the scan state accordingly"}, {"sha": "bc34eab49edb44955bef8aa725af960c11b46fd7", "filename": "gcc/ada/scng.adb", "status": "modified", "additions": 9, "deletions": 35, "changes": 44, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscng.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscng.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscng.adb?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -516,6 +516,7 @@ package body Scng is\n          Base := 10;\n          UI_Base := Uint_10;\n          UI_Int_Value := Uint_0;\n+         Based_Literal_Uses_Colon := False;\n          Scale := 0;\n          Scan_Integer;\n          Point_Scanned := False;\n@@ -568,20 +569,14 @@ package body Scng is\n                          or else\n                        Source (Scan_Ptr + 1) in 'a' .. 'z'))\n          then\n-            if C = ':' then\n-               Obsolescent_Check (Scan_Ptr);\n-\n-               if Warn_On_Obsolescent_Feature then\n-                  Error_Msg_S\n-                    (\"use of \"\":\"\" is an obsolescent feature (RM J.2(3))?\");\n-                  Error_Msg_S (\"\\use \"\"'#\"\" instead?\");\n-               end if;\n-            end if;\n-\n             Accumulate_Checksum (C);\n             Base_Char := C;\n             UI_Base := UI_Int_Value;\n \n+            if Base_Char = ':' then\n+               Based_Literal_Uses_Colon := True;\n+            end if;\n+\n             if UI_Base < 2 or else UI_Base > 16 then\n                Error_Msg_SC (\"base not 2-16\");\n                UI_Base := Uint_16;\n@@ -753,7 +748,6 @@ package body Scng is\n          end if;\n \n          Accumulate_Token_Checksum;\n-\n          return;\n       end Nlit;\n \n@@ -1579,24 +1573,9 @@ package body Scng is\n             end if;\n          end Minus_Case;\n \n-         --  Double quote starting a string literal\n-\n-         when '\"' =>\n-            Slit;\n-            Post_Scan;\n-            return;\n-\n-         --  Percent starting a string literal\n-\n-         when '%' =>\n-            Obsolescent_Check (Token_Ptr);\n-\n-            if Warn_On_Obsolescent_Feature then\n-               Error_Msg_S\n-                 (\"use of \"\"'%\"\" is an obsolescent feature (RM J.2(4))?\");\n-               Error_Msg_S (\"\\use \"\"\"\"\"\" instead?\");\n-            end if;\n+         --  Double quote or percent starting a string literal\n \n+         when '\"' | '%' =>\n             Slit;\n             Post_Scan;\n             return;\n@@ -1808,6 +1787,7 @@ package body Scng is\n                   Style.Check_Vertical_Bar;\n                end if;\n \n+               Post_Scan;\n                return;\n             end if;\n          end Vertical_Bar_Case;\n@@ -1816,13 +1796,6 @@ package body Scng is\n \n          when '!' => Exclamation_Case : begin\n             Accumulate_Checksum ('!');\n-            Obsolescent_Check (Token_Ptr);\n-\n-            if Warn_On_Obsolescent_Feature then\n-               Error_Msg_S\n-                 (\"use of \"\"'!\"\" is an obsolescent feature (RM J.2(2))?\");\n-               Error_Msg_S (\"\\use \"\"'|\"\" instead?\");\n-            end if;\n \n             if Source (Scan_Ptr + 1) = '=' then\n                Error_Msg_S -- CODEFIX\n@@ -1834,6 +1807,7 @@ package body Scng is\n             else\n                Scan_Ptr := Scan_Ptr + 1;\n                Token := Tok_Vertical_Bar;\n+               Post_Scan;\n                return;\n             end if;\n          end Exclamation_Case;"}, {"sha": "d9035119f4bffe0df3077ba3d7cdf8997b0db49b", "filename": "gcc/ada/scng.ads", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscng.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fscng.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscng.ads?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -33,9 +33,10 @@ with Types;  use Types;\n \n generic\n    with procedure Post_Scan;\n-   --  Procedure called by Scan for the following tokens:\n-   --  Tok_Char_Literal, Tok_Identifier, Tok_Real_Literal, Tok_Real_Literal,\n-   --  Tok_Integer_Literal, Tok_String_Literal, Tok_Operator_Symbol.\n+   --  Procedure called by Scan for the following tokens: Tok_Char_Literal,\n+   --  Tok_Identifier, Tok_Real_Literal, Tok_Real_Literal, Tok_Integer_Literal,\n+   --  Tok_String_Literal, Tok_Operator_Symbol, and Tok_Vertical_Bar. Used to\n+   --  build Token_Node and also check for obsolescent features.\n \n    with procedure Error_Msg (Msg : String; Flag_Location : Source_Ptr);\n    --  Output a message at specified location\n@@ -49,10 +50,6 @@ generic\n    with procedure Error_Msg_SP (Msg : String);\n    --  Output a message at the start of the previous token\n \n-   with procedure Obsolescent_Check (S : Source_Ptr);\n-   --  Called when one of the obsolescent character replacements is\n-   --  used with S pointing to the character in question.\n-\n    with package Style is new Styleg\n      (Error_Msg, Error_Msg_S, Error_Msg_SC, Error_Msg_SP);\n    --  Instantiation of Styleg with the same error reporting routines"}, {"sha": "d29659755ff0c775d2b06ea8d86d6acc0db2fc35", "filename": "gcc/ada/sinput-l.adb", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fsinput-l.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c90b20580d68059a45e6599e3afb6bb120fa0451/gcc%2Fada%2Fsinput-l.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsinput-l.adb?ref=c90b20580d68059a45e6599e3afb6bb120fa0451", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -530,12 +530,9 @@ package body Sinput.L is\n                Save_Style_Check := Opt.Style_Check;\n                Opt.Style_Check := False;\n \n-               --  Make sure that there will be no check of pragma Restrictions\n-               --  for obsolescent features while preprocessing the source.\n+               --  The actual preprocessing step\n \n-               Scn.Set_Obsolescent_Check (False);\n                Preprocess (Modified);\n-               Scn.Set_Obsolescent_Check (True);\n \n                --  Reset the scanner to its standard behavior, and restore the\n                --  Style_Checks flag."}]}