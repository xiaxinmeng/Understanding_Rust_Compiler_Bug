{"sha": "9803e573d33bafe67be2b0733c87f8515e5416c1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTgwM2U1NzNkMzNiYWZlNjdiZTJiMDczM2M4N2Y4NTE1ZTU0MTZjMQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2014-06-05T14:27:20Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2014-06-05T14:27:20Z"}, "message": "re PR fortran/61418 (HDF5 build failure with -flto: libgfortran.spec: attempt to rename spec 'lib' to already defined spec 'liborig')\n\n2014-06-05  Richard Biener  <rguenther@suse.de>\n\n\tPR fortran/61418\n\t* gfortranspec.c (spec_file): Remove.\n\t(find_spec_file): Likewise.\n\t(lang_specific_driver): Do not look for specs file in -L\n\tor append -specs command line argument.\n\t(lang_specific_pre_link): Always %:include libgfortran.spec.\n\nFrom-SVN: r211280", "tree": {"sha": "c4c338d1cdb6931932b11cb1a99f41c29d9875ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c4c338d1cdb6931932b11cb1a99f41c29d9875ed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9803e573d33bafe67be2b0733c87f8515e5416c1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9803e573d33bafe67be2b0733c87f8515e5416c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9803e573d33bafe67be2b0733c87f8515e5416c1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9803e573d33bafe67be2b0733c87f8515e5416c1/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1c960e02e70a5dce595b909867d888206da010a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c960e02e70a5dce595b909867d888206da010a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c960e02e70a5dce595b909867d888206da010a5"}], "stats": {"total": 47, "additions": 10, "deletions": 37}, "files": [{"sha": "9b3e2d8f462cb6882757ac06c248e01a011aac26", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9803e573d33bafe67be2b0733c87f8515e5416c1/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9803e573d33bafe67be2b0733c87f8515e5416c1/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=9803e573d33bafe67be2b0733c87f8515e5416c1", "patch": "@@ -1,3 +1,12 @@\n+2014-06-05  Richard Biener  <rguenther@suse.de>\n+\n+\tPR fortran/61418\n+\t* gfortranspec.c (spec_file): Remove.\n+\t(find_spec_file): Likewise.\n+\t(lang_specific_driver): Do not look for specs file in -L\n+\tor append -specs command line argument.\n+\t(lang_specific_pre_link): Always %:include libgfortran.spec.\n+\n 2014-06-02  Andrew MacLeod  <amacleod@redhat.com>\n \n \t* fortran/trans.c (trans_runtime_error_vararg): Call"}, {"sha": "cceee6d2d39281ab0732c26939869d7253cf342e", "filename": "gcc/fortran/gfortranspec.c", "status": "modified", "additions": 1, "deletions": 37, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9803e573d33bafe67be2b0733c87f8515e5416c1/gcc%2Ffortran%2Fgfortranspec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9803e573d33bafe67be2b0733c87f8515e5416c1/gcc%2Ffortran%2Fgfortranspec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fgfortranspec.c?ref=9803e573d33bafe67be2b0733c87f8515e5416c1", "patch": "@@ -73,34 +73,11 @@ static void append_arg (const struct cl_decoded_option *);\n static unsigned int g77_newargc;\n static struct cl_decoded_option *g77_new_decoded_options;\n \n-/* The path to the spec file.  */\n-static char *spec_file = NULL;\n-\n /* This will be NULL if we encounter a situation where we should not\n    link in the fortran libraries.  */\n static const char *library = NULL;\n \n \n-/* Return full path name of spec file if it is in DIR, or NULL if\n-   not.  */\n-static char *\n-find_spec_file (const char *dir)\n-{\n-  const char dirsep_string[] = { DIR_SEPARATOR, '\\0' };\n-  char *spec;\n-  struct stat sb;\n-\n-  spec = XNEWVEC (char, strlen (dir) + sizeof (SPEC_FILE) + 4);\n-  strcpy (spec, dir);\n-  strcat (spec, dirsep_string);\n-  strcat (spec, SPEC_FILE);\n-  if (!stat (spec, &sb))\n-    return spec;\n-  free (spec);\n-  return NULL;\n-}\n-\n-\n /* Return whether strings S1 and S2 are both NULL or both the same\n    string.  */\n \n@@ -313,12 +290,6 @@ For more information about these matters, see the file named COPYING\\n\\n\"));\n \t     cool facility for handling --help and --verbose --help.  */\n \t  return;\n \n-\tcase OPT_L:\n-\t  if (!spec_file)\n-\t    spec_file = find_spec_file (decoded_options[i].arg);\n-\t  break;\n-\n-\n \tdefault:\n \t  break;\n \t}\n@@ -449,12 +420,6 @@ For more information about these matters, see the file named COPYING\\n\\n\"));\n \n #endif\n \n-  /* Read the specs file corresponding to libgfortran.\n-     If we didn't find the spec file on the -L path, we load it\n-     via lang_specific_pre_link.  */\n-  if (spec_file)\n-    append_option (OPT_specs_, spec_file, 1);\n-\n   if (verbose && g77_new_decoded_options != g77_x_decoded_options)\n     {\n       fprintf (stderr, _(\"Driving:\"));\n@@ -473,8 +438,7 @@ For more information about these matters, see the file named COPYING\\n\\n\"));\n int\n lang_specific_pre_link (void)\n {\n-  free (spec_file);\n-  if (spec_file == NULL && library)\n+  if (library)\n     do_spec (\"%:include(libgfortran.spec)\");\n \n   return 0;"}]}