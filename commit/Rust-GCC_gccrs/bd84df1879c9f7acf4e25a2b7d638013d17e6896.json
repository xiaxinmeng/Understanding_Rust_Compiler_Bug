{"sha": "bd84df1879c9f7acf4e25a2b7d638013d17e6896", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQ4NGRmMTg3OWM5ZjdhY2Y0ZTI1YTJiN2Q2MzgwMTNkMTdlNjg5Ng==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2015-01-08T09:20:24Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2015-01-08T09:20:24Z"}, "message": "re PR sanitizer/64336 (Template functions are not instrumented at -O0 and -Og)\n\n\tPR sanitizer/64336\n\t* tree.c (build2_stat): Fix up initialization of TREE_READONLY\n\tand TREE_THIS_VOLATILE for MEM_REFs.\n\t(build5_stat): Fix up initialization of TREE_READONLY and\n\tTREE_THIS_VOLATILE for TARGET_MEM_REFs.\n\nFrom-SVN: r219339", "tree": {"sha": "921d6d769d91040d99d552f697691471aae5e957", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/921d6d769d91040d99d552f697691471aae5e957"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd84df1879c9f7acf4e25a2b7d638013d17e6896", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd84df1879c9f7acf4e25a2b7d638013d17e6896", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd84df1879c9f7acf4e25a2b7d638013d17e6896", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd84df1879c9f7acf4e25a2b7d638013d17e6896/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85"}], "stats": {"total": 46, "additions": 38, "deletions": 8}, "files": [{"sha": "26615505ec8091a04e12713a920536090364ea4a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd84df1879c9f7acf4e25a2b7d638013d17e6896/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd84df1879c9f7acf4e25a2b7d638013d17e6896/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bd84df1879c9f7acf4e25a2b7d638013d17e6896", "patch": "@@ -1,3 +1,11 @@\n+2015-01-08  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR sanitizer/64336\n+\t* tree.c (build2_stat): Fix up initialization of TREE_READONLY\n+\tand TREE_THIS_VOLATILE for MEM_REFs.\n+\t(build5_stat): Fix up initialization of TREE_READONLY and\n+\tTREE_THIS_VOLATILE for TARGET_MEM_REFs.\n+\n 2015-01-08  Kaz Kojima  <kkojima@gcc.gnu.org>\n \n \tPR target/64533"}, {"sha": "a3dd6cdae6d5e7ef6b5d7dc2abbde7c86e0b3b50", "filename": "gcc/tree.c", "status": "modified", "additions": 30, "deletions": 8, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd84df1879c9f7acf4e25a2b7d638013d17e6896/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd84df1879c9f7acf4e25a2b7d638013d17e6896/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=bd84df1879c9f7acf4e25a2b7d638013d17e6896", "patch": "@@ -4358,12 +4358,24 @@ build2_stat (enum tree_code code, tree tt, tree arg0, tree arg1 MEM_STAT_DECL)\n   PROCESS_ARG (0);\n   PROCESS_ARG (1);\n \n-  TREE_READONLY (t) = read_only;\n-  TREE_CONSTANT (t) = constant;\n   TREE_SIDE_EFFECTS (t) = side_effects;\n-  TREE_THIS_VOLATILE (t)\n-    = (TREE_CODE_CLASS (code) == tcc_reference\n-       && arg0 && TREE_THIS_VOLATILE (arg0));\n+  if (code == MEM_REF)\n+    {\n+      if (arg0 && TREE_CODE (arg0) == ADDR_EXPR)\n+\t{\n+\t  tree o = TREE_OPERAND (arg0, 0);\n+\t  TREE_READONLY (t) = TREE_READONLY (o);\n+\t  TREE_THIS_VOLATILE (t) = TREE_THIS_VOLATILE (o);\n+\t}\n+    }\n+  else\n+    {\n+      TREE_READONLY (t) = read_only;\n+      TREE_CONSTANT (t) = constant;\n+      TREE_THIS_VOLATILE (t)\n+\t= (TREE_CODE_CLASS (code) == tcc_reference\n+\t   && arg0 && TREE_THIS_VOLATILE (arg0));\n+    }\n \n   return t;\n }\n@@ -4458,9 +4470,19 @@ build5_stat (enum tree_code code, tree tt, tree arg0, tree arg1,\n   PROCESS_ARG (4);\n \n   TREE_SIDE_EFFECTS (t) = side_effects;\n-  TREE_THIS_VOLATILE (t)\n-    = (TREE_CODE_CLASS (code) == tcc_reference\n-       && arg0 && TREE_THIS_VOLATILE (arg0));\n+  if (code == TARGET_MEM_REF)\n+    {\n+      if (arg0 && TREE_CODE (arg0) == ADDR_EXPR)\n+\t{\n+\t  tree o = TREE_OPERAND (arg0, 0);\n+\t  TREE_READONLY (t) = TREE_READONLY (o);\n+\t  TREE_THIS_VOLATILE (t) = TREE_THIS_VOLATILE (o);\n+\t}\n+    }\n+  else\n+    TREE_THIS_VOLATILE (t)\n+      = (TREE_CODE_CLASS (code) == tcc_reference\n+\t && arg0 && TREE_THIS_VOLATILE (arg0));\n \n   return t;\n }"}]}