{"sha": "739745618a4202f3bf515494175eacae6ff05d2d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzM5NzQ1NjE4YTQyMDJmM2JmNTE1NDk0MTc1ZWFjYWU2ZmYwNWQyZA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-02-08T18:54:39Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-02-08T18:54:39Z"}, "message": "re PR c++/83806 (Spurious -Wunused-but-set-parameter with nullptr)\n\n/cp\n2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/83806\n\t* typeck.c (decay_conversion): Use mark_rvalue_use for the special\n\tcase of nullptr too.\n\n/testsuite\n2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/83806\n\t* g++.dg/warn/Wunused-parm-11.C: New.\n\nFrom-SVN: r257502", "tree": {"sha": "ee74a0c7ce2eacceafb4337723bb831769dc7ce6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee74a0c7ce2eacceafb4337723bb831769dc7ce6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/739745618a4202f3bf515494175eacae6ff05d2d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/739745618a4202f3bf515494175eacae6ff05d2d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/739745618a4202f3bf515494175eacae6ff05d2d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/739745618a4202f3bf515494175eacae6ff05d2d/comments", "author": null, "committer": null, "parents": [{"sha": "b00dcb136ea594997c35108903782142849d6ac8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b00dcb136ea594997c35108903782142849d6ac8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b00dcb136ea594997c35108903782142849d6ac8"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "c68b590a295d875b315f11602db9cf7ffe4e77d0", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=739745618a4202f3bf515494175eacae6ff05d2d", "patch": "@@ -1,3 +1,9 @@\n+2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/83806\n+\t* typeck.c (decay_conversion): Use mark_rvalue_use for the special\n+\tcase of nullptr too.\n+\n 2018-02-08  Nathan Sidwell  <nathan@acm.org>\n \n \t* class.c (finish_struct): Fix std:initializer_list diagnostic"}, {"sha": "fe18ea9d16ab010ee523d6f39c20673a7ad6ce90", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=739745618a4202f3bf515494175eacae6ff05d2d", "patch": "@@ -2009,7 +2009,10 @@ decay_conversion (tree exp,\n     return error_mark_node;\n \n   if (NULLPTR_TYPE_P (type) && !TREE_SIDE_EFFECTS (exp))\n-    return nullptr_node;\n+    {\n+      mark_rvalue_use (exp, loc, reject_builtin);\n+      return nullptr_node;\n+    }\n \n   /* build_c_cast puts on a NOP_EXPR to make the result not an lvalue.\n      Leave such NOP_EXPRs, since RHS is being used in non-lvalue context.  */"}, {"sha": "c51d2dd912e3a59e214610036fb0f68ce32dba05", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=739745618a4202f3bf515494175eacae6ff05d2d", "patch": "@@ -1,3 +1,8 @@\n+2018-02-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/83806\n+\t* g++.dg/warn/Wunused-parm-11.C: New.\n+\n 2018-02-08  Marek Polacek  <polacek@redhat.com>\n \n \tPR tree-optimization/84238"}, {"sha": "35896df93bb65548d4ec1419d6cc82f9422e1135", "filename": "gcc/testsuite/g++.dg/warn/Wunused-parm-11.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-parm-11.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/739745618a4202f3bf515494175eacae6ff05d2d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-parm-11.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWunused-parm-11.C?ref=739745618a4202f3bf515494175eacae6ff05d2d", "patch": "@@ -0,0 +1,13 @@\n+// PR c++/83806\n+// { dg-do compile { target c++11 } }\n+// { dg-options \"-Wunused-but-set-parameter\" }\n+\n+template <class X, class Y>\n+bool equals(X x, Y y) {\n+    return (x == y); \n+}\n+\n+int main() {\n+    const char* p = nullptr;\n+    equals(p, nullptr);\n+}"}]}