{"sha": "cb27986c9b5f270f880089d0bda74d10e76e8a3d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2IyNzk4NmM5YjVmMjcwZjg4MDA4OWQwYmRhNzRkMTBlNzZlOGEzZA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2014-04-14T13:33:23Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2014-04-14T13:33:23Z"}, "message": "stor-layout.c (place_field): Finalize non-constant offset for the field, if any.\n\n\t* stor-layout.c (place_field): Finalize non-constant offset for the\n\tfield, if any.\nada/\n\t* gcc-interface/decl.c (create_field_decl_from): Finalize non-constant\n\toffset for the field, if any.\n\nFrom-SVN: r209369", "tree": {"sha": "c5328aef0529b219ce30c1e05f39197286ba85c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c5328aef0529b219ce30c1e05f39197286ba85c8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cb27986c9b5f270f880089d0bda74d10e76e8a3d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb27986c9b5f270f880089d0bda74d10e76e8a3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb27986c9b5f270f880089d0bda74d10e76e8a3d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb27986c9b5f270f880089d0bda74d10e76e8a3d/comments", "author": null, "committer": null, "parents": [{"sha": "069fdd05da4e7abd6d6bd9415186f21b3cf14816", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/069fdd05da4e7abd6d6bd9415186f21b3cf14816", "html_url": "https://github.com/Rust-GCC/gccrs/commit/069fdd05da4e7abd6d6bd9415186f21b3cf14816"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "0bec304d1f7dce523b5fc8e051f950f847567109", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cb27986c9b5f270f880089d0bda74d10e76e8a3d", "patch": "@@ -1,3 +1,8 @@\n+2014-04-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* stor-layout.c (place_field): Finalize non-constant offset for the\n+\tfield, if any.\n+\n 2014-04-14  Richard Biener  <rguenther@suse.de>\n \n \t* tree-switch-conversion.c (lshift_cheap_p): Get speed_p"}, {"sha": "a77998872e21378e6d080e2644657d3b340b9404", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=cb27986c9b5f270f880089d0bda74d10e76e8a3d", "patch": "@@ -1,3 +1,8 @@\n+2014-04-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/decl.c (create_field_decl_from): Finalize non-constant\n+\toffset for the field, if any.\n+\n 2014-04-09  Eric Botcazou  <ebotcazou@adacore.com>\n \t    Svante Signell <svante.signell@gmail.com>\n "}, {"sha": "1e07693591e8afdc8e073afbbe9b02614c77543e", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=cb27986c9b5f270f880089d0bda74d10e76e8a3d", "patch": "@@ -8443,7 +8443,8 @@ create_field_decl_from (tree old_field, tree field_type, tree record_type,\n   if (!new_pos)\n     {\n       normalize_offset (&pos, &bitpos, offset_align);\n-      DECL_FIELD_OFFSET (new_field) = pos;\n+      /* Finalize the position.  */\n+      DECL_FIELD_OFFSET (new_field) = variable_size (pos);\n       DECL_FIELD_BIT_OFFSET (new_field) = bitpos;\n       SET_DECL_OFFSET_ALIGN (new_field, offset_align);\n       DECL_SIZE (new_field) = size;"}, {"sha": "e3f8406626bef14b7beac592cabfb9540425e5e0", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb27986c9b5f270f880089d0bda74d10e76e8a3d/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=cb27986c9b5f270f880089d0bda74d10e76e8a3d", "patch": "@@ -1417,6 +1417,10 @@ place_field (record_layout_info rli, tree field)\n   DECL_FIELD_BIT_OFFSET (field) = rli->bitpos;\n   SET_DECL_OFFSET_ALIGN (field, rli->offset_align);\n \n+  /* Evaluate nonconstant offsets only once, either now or as soon as safe.  */\n+  if (TREE_CODE (DECL_FIELD_OFFSET (field)) != INTEGER_CST)\n+    DECL_FIELD_OFFSET (field) = variable_size (DECL_FIELD_OFFSET (field));\n+\n   /* If this field ended up more aligned than we thought it would be (we\n      approximate this by seeing if its position changed), lay out the field\n      again; perhaps we can use an integral mode for it now.  */"}]}