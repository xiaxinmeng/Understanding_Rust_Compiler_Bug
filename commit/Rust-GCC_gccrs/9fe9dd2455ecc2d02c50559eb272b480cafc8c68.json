{"sha": "9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "node_id": "C_kwDOANBUbNoAKDlmZTlkZDI0NTVlY2MyZDAyYzUwNTU5ZWIyNzJiNDgwY2FmYzhjNjg", "commit": {"author": {"name": "Dimitar Dimitrov", "email": "dimitar@dinux.eu", "date": "2022-11-18T19:59:42Z"}, "committer": {"name": "Dimitar Dimitrov", "email": "dimitar@dinux.eu", "date": "2022-11-21T16:13:53Z"}, "message": "testsuite: Add filter for target socket support\n\nThe new analyzer tests for sockets are failing on embedded targets.\nThe newlib and avr-libc C libraries do not support sockets.\n\nTesting done:\n  - No changes in gcc.sum for x86_64-pc-linux-gnu, with or without this\n    patch.\n  - Filtered cases are now UNSUPPORTED instead of failing on AVR and PRU\n    backends.\n\ngcc/ChangeLog:\n\n\t* doc/sourcebuild.texi (sockets): Document new check.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.dg/analyzer/fd-accept.c: Require sockets.\n\t* gcc.dg/analyzer/fd-bind.c: Ditto.\n\t* gcc.dg/analyzer/fd-connect.c: Ditto.\n\t* gcc.dg/analyzer/fd-datagram-socket.c: Ditto.\n\t* gcc.dg/analyzer/fd-glibc-byte-stream-connection-server.c:\n\tDitto.\n\t* gcc.dg/analyzer/fd-glibc-byte-stream-socket.c: Ditto.\n\t* gcc.dg/analyzer/fd-glibc-datagram-client.c: Ditto.\n\t* gcc.dg/analyzer/fd-glibc-datagram-socket.c: Ditto.\n\t* gcc.dg/analyzer/fd-listen.c: Ditto.\n\t* gcc.dg/analyzer/fd-manpage-getaddrinfo-client.c: Ditto.\n\t* gcc.dg/analyzer/fd-mappage-getaddrinfo-server.c: Ditto.\n\t* gcc.dg/analyzer/fd-socket-meaning.c: Ditto.\n\t* gcc.dg/analyzer/fd-socket-misuse.c: Ditto.\n\t* gcc.dg/analyzer/fd-stream-socket-active-open.c: Ditto.\n\t* gcc.dg/analyzer/fd-stream-socket-passive-open.c: Ditto.\n\t* gcc.dg/analyzer/fd-stream-socket.c: Ditto.\n\t* gcc.dg/analyzer/fd-symbolic-socket.c: Ditto.\n\t* lib/target-supports.exp (check_effective_target_sockets): New\n\tcheck.\n\nSigned-off-by: Dimitar Dimitrov <dimitar@dinux.eu>", "tree": {"sha": "fe412c4539bcd47fd6efbe2959faee41824f8bcc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fe412c4539bcd47fd6efbe2959faee41824f8bcc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/comments", "author": null, "committer": null, "parents": [{"sha": "f80bfdcc84707583a66526fb1fb428eb66389359", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f80bfdcc84707583a66526fb1fb428eb66389359", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f80bfdcc84707583a66526fb1fb428eb66389359"}], "stats": {"total": 45, "additions": 45, "deletions": 0}, "files": [{"sha": "ffe69d6fcb9c46cf97ba570e85b56e586a0c9b99", "filename": "gcc/doc/sourcebuild.texi", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Fdoc%2Fsourcebuild.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Fdoc%2Fsourcebuild.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fsourcebuild.texi?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -2666,6 +2666,9 @@ Target can compile using @code{pthread.h} with no errors or warnings.\n @item pthread_h\n Target has @code{pthread.h}.\n \n+@item sockets\n+Target can compile using @code{sys/socket.h} with no errors or warnings.\n+\n @item run_expensive_tests\n Expensive testcases (usually those that consume excessive amounts of CPU\n time) should be run on this target.  This can be enabled by setting the"}, {"sha": "5426063f31d7d827ba4c5231016465550f1847cf", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-accept.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-accept.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-accept.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-accept.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "c34803f138008caf20c6e473529f7151d3306896", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-bind.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-bind.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-bind.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-bind.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "7bf687e2570966262b6bc6a490686e2a69178b93", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-connect.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-connect.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-connect.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-connect.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "58508570a25be90f3b640b27e3057dd1de7ec3d2", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-datagram-socket.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-datagram-socket.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-datagram-socket.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-datagram-socket.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "5a1a6f5f14fb90d7dd8585d0e9968acfd9ebb39d", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-glibc-byte-stream-connection-server.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-byte-stream-connection-server.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-byte-stream-connection-server.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-byte-stream-connection-server.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,4 +1,5 @@\n /* Example from glibc manual (16.9.7).  */\n+/* { dg-require-effective-target sockets } */\n /* { dg-additional-options \"-Wno-analyzer-too-complex\" } */\n \n #include <stdio.h>"}, {"sha": "806bb24d9ebcbec48dcf97a50ec7fa56b2ed4b6f", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-glibc-byte-stream-socket.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-byte-stream-socket.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-byte-stream-socket.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-byte-stream-socket.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,4 +1,5 @@\n /* Example from glibc manual (16.9.6).  */\n+/* { dg-require-effective-target sockets } */\n \n #include <stdio.h>\n #include <string.h>"}, {"sha": "072ac4cd0d394cba6a0bfd5cd238c200b8acb25b", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-glibc-datagram-client.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-datagram-client.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-datagram-client.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-datagram-client.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,4 +1,5 @@\n /* Example from the glibc manual (16.10.4).  */\n+/* { dg-require-effective-target sockets } */\n \n #include <stdio.h>\n #include <errno.h>"}, {"sha": "d417828f6ee41b762d366c317174240adf9fff99", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-glibc-datagram-socket.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-datagram-socket.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-datagram-socket.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-glibc-datagram-socket.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,4 +1,5 @@\n /* Example from glibc manual (16.10.3).  */\n+/* { dg-require-effective-target sockets } */\n \n #include <stdio.h>\n #include <errno.h>"}, {"sha": "becf469029368c7a609637b7a2b555a46d65e6eb", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-listen.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-listen.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-listen.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-listen.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "ee627de964306ab803beed69b42734d9fe4bcccb", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-manpage-getaddrinfo-client.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-manpage-getaddrinfo-client.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-manpage-getaddrinfo-client.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-manpage-getaddrinfo-client.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -26,6 +26,7 @@ Formatted or processed versions of this manual, if unaccompanied by\n the source, must acknowledge the copyright and authors of this work.\n */\n \n+/* { dg-require-effective-target sockets } */\n /* { dg-additional-options \"-Wno-analyzer-too-complex\" } */\n \n #include <sys/types.h>"}, {"sha": "d2e39eb697621b773949d10df971f51c7064f324", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-mappage-getaddrinfo-server.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-mappage-getaddrinfo-server.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-mappage-getaddrinfo-server.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-mappage-getaddrinfo-server.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -26,6 +26,8 @@ Formatted or processed versions of this manual, if unaccompanied by\n the source, must acknowledge the copyright and authors of this work.\n */\n \n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/types.h>\n #include <stdio.h>\n #include <stdlib.h>"}, {"sha": "82a199f83b06ebb1bcd9fd88f8e8201812453e51", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-socket-meaning.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-socket-meaning.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-socket-meaning.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-socket-meaning.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,4 @@\n+/* { dg-require-effective-target sockets } */\n /* { dg-additional-options \"-fanalyzer-verbose-state-changes\" } */\n \n #include <sys/socket.h>"}, {"sha": "628f5e4a65ce5b04d1b815449689323ee186a6f4", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-socket-misuse.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-socket-misuse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-socket-misuse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-socket-misuse.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,5 +1,7 @@\n /* Various operations done on sockets in the wrong phase.  */\n \n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/types.h>\n #include <sys/stat.h>\n #include <fcntl.h>"}, {"sha": "841894cc1bd2525e21da485a753ca251948ed5b6", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-stream-socket-active-open.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket-active-open.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket-active-open.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket-active-open.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "a61091101edefbd737c15bf227f642a8b4e293f8", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-stream-socket-passive-open.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket-passive-open.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket-passive-open.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket-passive-open.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -2,6 +2,8 @@\n    either from scratch, or when various phases are assumed to already\n    be done.  */\n \n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "e51f0f08c34728fca6316edbdcaaf41b5c441b63", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-stream-socket.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-stream-socket.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "ad1f989cf09f46ddc3879ca30d877fb41e98ed68", "filename": "gcc/testsuite/gcc.dg/analyzer/fd-symbolic-socket.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-symbolic-socket.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-symbolic-socket.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffd-symbolic-socket.c?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-require-effective-target sockets } */\n+\n #include <sys/socket.h>\n #include <sys/un.h>\n #include <unistd.h>"}, {"sha": "65ba33b9d94c2464257c4142599e99a08f4ed9a3", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fe9dd2455ecc2d02c50559eb272b480cafc8c68/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=9fe9dd2455ecc2d02c50559eb272b480cafc8c68", "patch": "@@ -1176,6 +1176,20 @@ proc check_effective_target_pthread {} {\n     } \"-pthread\"]\n }\n \n+# Return 1 if the target supports both Unix and internet sockets, 0 otherwise.\n+proc check_effective_target_sockets {} {\n+    return [check_no_compiler_messages socket executable {\n+#include <sys/socket.h>\n+#include <sys/un.h>\n+#include <netinet/in.h>\n+int main (void) {\n+    socket(AF_UNIX, SOCK_STREAM, 0);\n+    socket(AF_INET, SOCK_DGRAM, 0);\n+    return 0;\n+}\n+    } \"\"]\n+}\n+\n # Return 1 if compilation with -mpe-aligned-commons is error-free\n # for trivial code, 0 otherwise.\n "}]}