{"sha": "37ea263afa8f68bc7a6fcda19a47eb645624ecb7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzdlYTI2M2FmYThmNjhiYzdhNmZjZGExOWE0N2ViNjQ1NjI0ZWNiNw==", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2013-06-13T14:26:47Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2013-06-13T14:26:47Z"}, "message": "re PR fortran/49074 ([OOP] Defined assignment w/ CLASS arrays: Incomplete error message)\n\nfortran/\n\tPR fortran/49074\n\t* trans-expr.c (gfc_conv_variable): Don't walk the reference chain.\n\tHandle NULL array references.\n\t(gfc_conv_procedure_call): Remove code handling NULL array references.\n\ntestsuite/\n\tPR fortran/49074\n\t* gfortran.dg/typebound_assignment_5.f03: New.\n\nFrom-SVN: r200069", "tree": {"sha": "72e6325d1a51b2eab4943e585e211866a24869c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/72e6325d1a51b2eab4943e585e211866a24869c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/37ea263afa8f68bc7a6fcda19a47eb645624ecb7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37ea263afa8f68bc7a6fcda19a47eb645624ecb7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37ea263afa8f68bc7a6fcda19a47eb645624ecb7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37ea263afa8f68bc7a6fcda19a47eb645624ecb7/comments", "author": null, "committer": null, "parents": [{"sha": "e5b962d0ccb213b6ad1f2ba4d6a0b84c9e94b046", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5b962d0ccb213b6ad1f2ba4d6a0b84c9e94b046", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e5b962d0ccb213b6ad1f2ba4d6a0b84c9e94b046"}], "stats": {"total": 43, "additions": 23, "deletions": 20}, "files": [{"sha": "cd491a09499f196713b3e7579d83019ecd4f19d9", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37ea263afa8f68bc7a6fcda19a47eb645624ecb7/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37ea263afa8f68bc7a6fcda19a47eb645624ecb7/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=37ea263afa8f68bc7a6fcda19a47eb645624ecb7", "patch": "@@ -1,3 +1,10 @@\n+2013-06-13  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\tPR fortran/49074\n+\t* trans-expr.c (gfc_conv_variable): Don't walk the reference chain.\n+\tHandle NULL array references.\n+\t(gfc_conv_procedure_call): Remove code handling NULL array references.\n+\n 2013-06-11  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/57535"}, {"sha": "bd8886cdf5508a7b7d2b2e2d6bded5ada3742b04", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 11, "deletions": 20, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37ea263afa8f68bc7a6fcda19a47eb645624ecb7/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37ea263afa8f68bc7a6fcda19a47eb645624ecb7/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=37ea263afa8f68bc7a6fcda19a47eb645624ecb7", "patch": "@@ -1761,9 +1761,12 @@ gfc_conv_variable (gfc_se * se, gfc_expr * expr)\n       /* A scalarized term.  We already know the descriptor.  */\n       se->expr = ss_info->data.array.descriptor;\n       se->string_length = ss_info->string_length;\n-      for (ref = ss_info->data.array.ref; ref; ref = ref->next)\n-\tif (ref->type == REF_ARRAY && ref->u.ar.type != AR_ELEMENT)\n-\t  break;\n+      ref = ss_info->data.array.ref;\n+      if (ref)\n+\tgcc_assert (ref->type == REF_ARRAY\n+\t\t    && ref->u.ar.type != AR_ELEMENT);\n+      else\n+\tgfc_conv_tmp_array_ref (se);\n     }\n   else\n     {\n@@ -4041,23 +4044,11 @@ gfc_conv_procedure_call (gfc_se * se, gfc_symbol * sym,\n \t  gfc_init_se (&parmse, se);\n \t  parm_kind = ELEMENTAL;\n \n-\t  if (ss->dimen > 0 && e->expr_type == EXPR_VARIABLE\n-\t      && ss->info->data.array.ref == NULL)\n-\t    {\n-\t      gfc_conv_tmp_array_ref (&parmse);\n-\t      if (e->ts.type == BT_CHARACTER)\n-\t\tgfc_conv_string_parameter (&parmse);\n-\t      else\n-\t\tparmse.expr = gfc_build_addr_expr (NULL_TREE, parmse.expr);\n-\t    }\n-\t  else\n-\t    {\n-\t      gfc_conv_expr_reference (&parmse, e);\n-\t      if (e->ts.type == BT_CHARACTER && !e->rank\n-\t\t  && e->expr_type == EXPR_FUNCTION)\n-\t\tparmse.expr = build_fold_indirect_ref_loc (input_location,\n-\t\t\t\t\t\t\t   parmse.expr);\n-\t    }\n+\t  gfc_conv_expr_reference (&parmse, e);\n+\t  if (e->ts.type == BT_CHARACTER && !e->rank\n+\t      && e->expr_type == EXPR_FUNCTION)\n+\t    parmse.expr = build_fold_indirect_ref_loc (input_location,\n+\t\t\t\t\t\t       parmse.expr);\n \n \t  if (fsym && fsym->ts.type == BT_DERIVED\n \t      && gfc_is_class_container_ref (e))"}, {"sha": "912fe61f7e20516b8bab8542b2757c99a1b80238", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37ea263afa8f68bc7a6fcda19a47eb645624ecb7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37ea263afa8f68bc7a6fcda19a47eb645624ecb7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=37ea263afa8f68bc7a6fcda19a47eb645624ecb7", "patch": "@@ -1,3 +1,8 @@\n+2013-06-13  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\tPR fortran/49074\n+\t* gfortran.dg/typebound_assignment_5.f03: New.\n+\n 2013-06-13  Marc Glisse  <marc.glisse@inria.fr>\n \n \t* gcc.dg/tree-ssa/forwprop-27.c: New testcase."}]}