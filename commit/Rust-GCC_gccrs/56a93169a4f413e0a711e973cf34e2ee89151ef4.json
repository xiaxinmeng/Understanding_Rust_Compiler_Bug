{"sha": "56a93169a4f413e0a711e973cf34e2ee89151ef4", "node_id": "C_kwDOANBUbNoAKDU2YTkzMTY5YTRmNDEzZTBhNzExZTk3M2NmMzRlMmVlODkxNTFlZjQ", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2022-10-03T14:45:49Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "poulhies@adacore.com", "date": "2022-10-06T09:22:49Z"}, "message": "ada: Cleanup related to lock-free protected subprograms\n\nCleanup code and documentation; semantics is unaffected.\n\ngcc/ada/\n\n\t* doc/gnat_rm/implementation_defined_pragmas.rst\n\t(Lock_Free): Remove inconsistent periods that end item\n\tdescriptions.\n\t* sem_ch9.adb\n\t(Allows_Lock_Free_Implementation): Remove unnecessary guard\n\tagainst an empty list of parameters; replace low-level entity kind\n\tmembership test with a high-level query; refill error message.\n\t* gnat_rm.texi: Regenerate.", "tree": {"sha": "c07274ce447257bc043192adb73ea3c4a7e60480", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c07274ce447257bc043192adb73ea3c4a7e60480"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/56a93169a4f413e0a711e973cf34e2ee89151ef4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56a93169a4f413e0a711e973cf34e2ee89151ef4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56a93169a4f413e0a711e973cf34e2ee89151ef4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56a93169a4f413e0a711e973cf34e2ee89151ef4/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a93fd547bacd1bab37290f9f3c44ef3ddf334287", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a93fd547bacd1bab37290f9f3c44ef3ddf334287", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a93fd547bacd1bab37290f9f3c44ef3ddf334287"}], "stats": {"total": 20, "additions": 9, "deletions": 11}, "files": [{"sha": "6752d48d15948ae9d95cf0c45dedfdff8f7aaaa3", "filename": "gcc/ada/doc/gnat_rm/implementation_defined_pragmas.rst", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a93169a4f413e0a711e973cf34e2ee89151ef4/gcc%2Fada%2Fdoc%2Fgnat_rm%2Fimplementation_defined_pragmas.rst", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a93169a4f413e0a711e973cf34e2ee89151ef4/gcc%2Fada%2Fdoc%2Fgnat_rm%2Fimplementation_defined_pragmas.rst", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fgnat_rm%2Fimplementation_defined_pragmas.rst?ref=56a93169a4f413e0a711e973cf34e2ee89151ef4", "patch": "@@ -3744,10 +3744,10 @@ In addition, each protected subprogram body must satisfy:\n \n * May reference only one protected component\n * May not reference nonconstant entities outside the protected subprogram\n-  scope.\n+  scope\n * May not contain address representation items, allocators, or quantified\n-  expressions.\n-* May not contain delay, goto, loop, or procedure-call statements.\n+  expressions\n+* May not contain delay, goto, loop, or procedure-call statements\n * May not contain exported and imported entities\n * May not dereferenced access values\n * Function calls and attribute references must be static"}, {"sha": "e79cdeeacfea6920cbe193991adc784b85957e91", "filename": "gcc/ada/gnat_rm.texi", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a93169a4f413e0a711e973cf34e2ee89151ef4/gcc%2Fada%2Fgnat_rm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a93169a4f413e0a711e973cf34e2ee89151ef4/gcc%2Fada%2Fgnat_rm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_rm.texi?ref=56a93169a4f413e0a711e973cf34e2ee89151ef4", "patch": "@@ -5243,14 +5243,14 @@ May reference only one protected component\n \n @item \n May not reference nonconstant entities outside the protected subprogram\n-scope.\n+scope\n \n @item \n May not contain address representation items, allocators, or quantified\n-expressions.\n+expressions\n \n @item \n-May not contain delay, goto, loop, or procedure-call statements.\n+May not contain delay, goto, loop, or procedure-call statements\n \n @item \n May not contain exported and imported entities"}, {"sha": "6506358a02b778d0a2bf59cfe733e9e166beb4cb", "filename": "gcc/ada/sem_ch9.adb", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a93169a4f413e0a711e973cf34e2ee89151ef4/gcc%2Fada%2Fsem_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a93169a4f413e0a711e973cf34e2ee89151ef4/gcc%2Fada%2Fsem_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch9.adb?ref=56a93169a4f413e0a711e973cf34e2ee89151ef4", "patch": "@@ -178,8 +178,6 @@ package body Sem_Ch9 is\n                elsif Nkind (Decl) = N_Subprogram_Declaration\n                  and then\n                    Nkind (Specification (Decl)) = N_Procedure_Specification\n-                 and then\n-                   Present (Parameter_Specifications (Specification (Decl)))\n                then\n                   declare\n                      Par_Specs : constant List_Id   :=\n@@ -477,7 +475,7 @@ package body Sem_Ch9 is\n                         --  Prohibit references to non-constant entities\n                         --  outside the protected subprogram scope.\n \n-                        if Ekind (Id) in Assignable_Kind\n+                        if Is_Assignable (Id)\n                           and then not\n                             Scope_Within_Or_Same (Scope (Id), Sub_Id)\n                           and then not\n@@ -487,8 +485,8 @@ package body Sem_Ch9 is\n                         then\n                            if Lock_Free_Given then\n                               Error_Msg_NE\n-                                (\"reference to global variable& not \" &\n-                                 \"allowed\", N, Id);\n+                                (\"reference to global variable& not allowed\",\n+                                 N, Id);\n                               return Skip;\n                            end if;\n "}]}