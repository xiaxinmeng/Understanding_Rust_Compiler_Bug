{"sha": "bc6ce33429e1ab0818366de28189d7b17900d46a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmM2Y2UzMzQyOWUxYWIwODE4MzY2ZGUyODE4OWQ3YjE3OTAwZDQ2YQ==", "commit": {"author": {"name": "Andreas Krebbel", "email": "Andreas.Krebbel@de.ibm.com", "date": "2011-03-04T20:47:11Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2011-03-04T20:47:11Z"}, "message": "s390.c (s390_decompose_address): Reject non-literal pool references in UNSPEC_LTREL_OFFSET.\n\n2011-03-04  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n\n\t* config/s390/s390.c (s390_decompose_address): Reject non-literal\n\tpool references in UNSPEC_LTREL_OFFSET.\n\nFrom-SVN: r170685", "tree": {"sha": "071f3c965c7ee30a7905be74fa3ae7c2ce82face", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/071f3c965c7ee30a7905be74fa3ae7c2ce82face"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc6ce33429e1ab0818366de28189d7b17900d46a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc6ce33429e1ab0818366de28189d7b17900d46a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc6ce33429e1ab0818366de28189d7b17900d46a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc6ce33429e1ab0818366de28189d7b17900d46a/comments", "author": null, "committer": null, "parents": [{"sha": "78a8b16bad41d3d358ea1fe9e5c44d9270a377bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78a8b16bad41d3d358ea1fe9e5c44d9270a377bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/78a8b16bad41d3d358ea1fe9e5c44d9270a377bf"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "76a2bd2b8e9fa7fc8e39cd269983f09612e07448", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc6ce33429e1ab0818366de28189d7b17900d46a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc6ce33429e1ab0818366de28189d7b17900d46a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bc6ce33429e1ab0818366de28189d7b17900d46a", "patch": "@@ -1,3 +1,8 @@\n+2011-03-04  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n+\n+\t* config/s390/s390.c (s390_decompose_address): Reject non-literal\n+\tpool references in UNSPEC_LTREL_OFFSET.\n+\n 2011-03-04  Jan Hubicka  <jh@suse.cz>\n \n \tPR lto/47497"}, {"sha": "3e6edb76b475e56eeb9fb5f489c4825f3d1b5584", "filename": "gcc/config/s390/s390.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc6ce33429e1ab0818366de28189d7b17900d46a/gcc%2Fconfig%2Fs390%2Fs390.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc6ce33429e1ab0818366de28189d7b17900d46a/gcc%2Fconfig%2Fs390%2Fs390.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390.c?ref=bc6ce33429e1ab0818366de28189d7b17900d46a", "patch": "@@ -2065,6 +2065,16 @@ s390_decompose_address (rtx addr, struct s390_address *out)\n       else if (GET_CODE (disp) == UNSPEC\n \t       && XINT (disp, 1) == UNSPEC_LTREL_OFFSET)\n         {\n+\t  /* In case CSE pulled a non literal pool reference out of\n+\t     the pool we have to reject the address.  This is\n+\t     especially important when loading the GOT pointer on non\n+\t     zarch CPUs.  In this case the literal pool contains an lt\n+\t     relative offset to the _GLOBAL_OFFSET_TABLE_ label which\n+\t     will most likely exceed the displacement.  */\n+\t  if (GET_CODE (XVECEXP (disp, 0, 0)) != SYMBOL_REF\n+\t      || !CONSTANT_POOL_ADDRESS_P (XVECEXP (disp, 0, 0)))\n+\t    return false;\n+\n \t  orig_disp = gen_rtx_CONST (Pmode, disp);\n \t  if (offset)\n \t    {"}]}