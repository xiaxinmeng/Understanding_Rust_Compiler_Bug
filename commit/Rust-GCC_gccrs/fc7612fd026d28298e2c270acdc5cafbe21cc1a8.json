{"sha": "fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmM3NjEyZmQwMjZkMjgyOThlMmMyNzBhY2RjNWNhZmJlMjFjYzFhOA==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@acm.org", "date": "2017-01-23T20:24:32Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2017-01-23T20:24:32Z"}, "message": "PR c++/71710 - template using directive of field\n\n\tPR c++/71710 - template using directive of field\n\t* pt.c (tsubst_copy_and_build [COMPONENT_REF]): Move FIELD_DECL\n\tcheck earlier.\n\n\tPR C++/71710\n\t* g++.dg/template/pr71710.C: New.\n\nFrom-SVN: r244833", "tree": {"sha": "022252886d4a452b2871f31e850d84421695283e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/022252886d4a452b2871f31e850d84421695283e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/comments", "author": {"login": "urnathan", "id": 13103001, "node_id": "MDQ6VXNlcjEzMTAzMDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13103001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urnathan", "html_url": "https://github.com/urnathan", "followers_url": "https://api.github.com/users/urnathan/followers", "following_url": "https://api.github.com/users/urnathan/following{/other_user}", "gists_url": "https://api.github.com/users/urnathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/urnathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urnathan/subscriptions", "organizations_url": "https://api.github.com/users/urnathan/orgs", "repos_url": "https://api.github.com/users/urnathan/repos", "events_url": "https://api.github.com/users/urnathan/events{/privacy}", "received_events_url": "https://api.github.com/users/urnathan/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e6b8075ccec830041e8c85fc50d9eee6364263f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e6b8075ccec830041e8c85fc50d9eee6364263f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e6b8075ccec830041e8c85fc50d9eee6364263f7"}], "stats": {"total": 33, "additions": 25, "deletions": 8}, "files": [{"sha": "66151e9b0a4c71cf489cd1fe05aa15747e161d8a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "patch": "@@ -1,5 +1,9 @@\n 2017-01-23  Nathan Sidwell  <nathan@acm.org>\n \n+\tPR c++/71710 - template using directive of field\n+\t* pt.c (tsubst_copy_and_build [COMPONENT_REF]): Move FIELD_DECL\n+\tcheck earlier.\n+\n \tPR c++/71406 - ICE with scope-ref'd template id exprs\n \tPR c++/77508\n \t* typeck.c (finish_class_member_access_expr): Break up SCOPE_REF"}, {"sha": "537d1073fa0ce24964694ba3adde9bf3f2211d70", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "patch": "@@ -17470,7 +17470,14 @@ tsubst_copy_and_build (tree t,\n \tif (member == error_mark_node)\n \t  RETURN (error_mark_node);\n \n-\tif (type_dependent_expression_p (object))\n+\tif (TREE_CODE (member) == FIELD_DECL)\n+\t  {\n+\t    r = finish_non_static_data_member (member, object, NULL_TREE);\n+\t    if (TREE_CODE (r) == COMPONENT_REF)\n+\t      REF_PARENTHESIZED_P (r) = REF_PARENTHESIZED_P (t);\n+\t    RETURN (r);\n+\t  }\n+\telse if (type_dependent_expression_p (object))\n \t  /* We can't do much here.  */;\n \telse if (!CLASS_TYPE_P (object_type))\n \t  {\n@@ -17535,13 +17542,6 @@ tsubst_copy_and_build (tree t,\n \t      }\n \t    RETURN (error_mark_node);\n \t  }\n-\telse if (TREE_CODE (member) == FIELD_DECL)\n-\t  {\n-\t    r = finish_non_static_data_member (member, object, NULL_TREE);\n-\t    if (TREE_CODE (r) == COMPONENT_REF)\n-\t      REF_PARENTHESIZED_P (r) = REF_PARENTHESIZED_P (t);\n-\t    RETURN (r);\n-\t  }\n \n \tr = finish_class_member_access_expr (object, member,\n \t\t\t\t\t     /*template_p=*/false,"}, {"sha": "ee1f19ce99316aa604af60560fc425c89513811f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "patch": "@@ -1,5 +1,8 @@\n 2017-01-23  Nathan Sidwell  <nathan@acm.org>\n \n+\tPR C++/71710\n+\t* g++.dg/template/pr71710.C: New.\n+\n \tPR c++/71406\n \tPR c++/77508\n \t* g++.dg/template/pr71406.C: New."}, {"sha": "7c394e793b7d8f6cb7d2266155dba6e64b705623", "filename": "gcc/testsuite/g++.dg/template/pr71710.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fpr71710.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc7612fd026d28298e2c270acdc5cafbe21cc1a8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fpr71710.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fpr71710.C?ref=fc7612fd026d28298e2c270acdc5cafbe21cc1a8", "patch": "@@ -0,0 +1,10 @@\n+// { dg-do compile { target c++11 } }\n+// PR C++/71710 ICE with decltype & using\n+\n+template < typename > struct A\n+{\n+  A a;\n+  template < int > using B = decltype (a);\n+  B < 0 > b;\n+  template < int C > B < C > foo ();\n+};"}]}