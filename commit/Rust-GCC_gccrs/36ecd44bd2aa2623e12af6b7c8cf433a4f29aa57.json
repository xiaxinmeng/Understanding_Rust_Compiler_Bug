{"sha": "36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzZlY2Q0NGJkMmFhMjYyM2UxMmFmNmI3YzhjZjQzM2E0ZjI5YWE1Nw==", "commit": {"author": {"name": "prathamesh.kulkarni", "email": "prathamesh.kulkarni@linaro.org", "date": "2021-05-14T10:33:43Z"}, "committer": {"name": "prathamesh.kulkarni", "email": "prathamesh.kulkarni@linaro.org", "date": "2021-05-14T10:34:36Z"}, "message": "arm/PR66791: Replace calls to vtst builtin with it's boolean logic equivalent.\n\ngcc/ChangeLog:\n\n2021-05-14  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n\n\tPR target/66791\n\t* config/arm/arm_neon.h (vtst_s8): Replace call to vtst builtin with it's\n\tboolean logic equivalent.\n\t(vtst_s16): Likewise.\n\t(vtst_s32): Likewise.\n\t(vtst_u8): Likewise.\n\t(vtst_u16): Likewise.\n\t(vtst_u32): Likewise.\n\t(vtst_p8): Likewise.\n\t(vtst_p16): Likewise.\n\t(vtstq_s8): Likewise.\n\t(vtstq_s16): Likewise.\n\t(vtstq_s32): Likewise.\n\t(vtstq_u8): Likewise.\n\t(vtstq_u16): Likewise.\n\t(vtstq_u32): Likewise.\n\t(vtstq_p8): Likewise.\n\t(vtstq_p16): Likewise.\n\n\t* config/arm/arm_neon_builtins.def: Remove entry for vtst.\n\t* config/arm/neon.md (neon_vtst<mode>): Remove pattern.", "tree": {"sha": "51f2c73f96e6425d9769629ff5bfe9c5aa5fb947", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/51f2c73f96e6425d9769629ff5bfe9c5aa5fb947"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57", "html_url": "https://github.com/Rust-GCC/gccrs/commit/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57/comments", "author": null, "committer": null, "parents": [{"sha": "4d0385dfe0b9b86d71895f72f936ab3638ba6b3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d0385dfe0b9b86d71895f72f936ab3638ba6b3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d0385dfe0b9b86d71895f72f936ab3638ba6b3b"}], "stats": {"total": 43, "additions": 16, "deletions": 27}, "files": [{"sha": "dcd533fd00391e1eac9e5730a203119503bdb487", "filename": "gcc/config/arm/arm_neon.h", "status": "modified", "additions": 16, "deletions": 16, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57/gcc%2Fconfig%2Farm%2Farm_neon.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57/gcc%2Fconfig%2Farm%2Farm_neon.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm_neon.h?ref=36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57", "patch": "@@ -2919,112 +2919,112 @@ __extension__ extern __inline uint8x8_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_s8 (int8x8_t __a, int8x8_t __b)\n {\n-  return (uint8x8_t)__builtin_neon_vtstv8qi (__a, __b);\n+  return (uint8x8_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint16x4_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_s16 (int16x4_t __a, int16x4_t __b)\n {\n-  return (uint16x4_t)__builtin_neon_vtstv4hi (__a, __b);\n+  return (uint16x4_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint32x2_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_s32 (int32x2_t __a, int32x2_t __b)\n {\n-  return (uint32x2_t)__builtin_neon_vtstv2si (__a, __b);\n+  return (uint32x2_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint8x8_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_u8 (uint8x8_t __a, uint8x8_t __b)\n {\n-  return (uint8x8_t)__builtin_neon_vtstv8qi ((int8x8_t) __a, (int8x8_t) __b);\n+  return (uint8x8_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint16x4_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_u16 (uint16x4_t __a, uint16x4_t __b)\n {\n-  return (uint16x4_t)__builtin_neon_vtstv4hi ((int16x4_t) __a, (int16x4_t) __b);\n+  return (uint16x4_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint32x2_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_u32 (uint32x2_t __a, uint32x2_t __b)\n {\n-  return (uint32x2_t)__builtin_neon_vtstv2si ((int32x2_t) __a, (int32x2_t) __b);\n+  return (uint32x2_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint8x8_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_p8 (poly8x8_t __a, poly8x8_t __b)\n {\n-  return (uint8x8_t)__builtin_neon_vtstv8qi ((int8x8_t) __a, (int8x8_t) __b);\n+  return (uint8x8_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint16x4_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtst_p16 (poly16x4_t __a, poly16x4_t __b)\n {\n-  return (uint16x4_t)__builtin_neon_vtstv4hi ((int16x4_t) __a, (int16x4_t) __b);\n+  return (uint16x4_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint8x16_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_s8 (int8x16_t __a, int8x16_t __b)\n {\n-  return (uint8x16_t)__builtin_neon_vtstv16qi (__a, __b);\n+  return (uint8x16_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint16x8_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_s16 (int16x8_t __a, int16x8_t __b)\n {\n-  return (uint16x8_t)__builtin_neon_vtstv8hi (__a, __b);\n+  return (uint16x8_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint32x4_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_s32 (int32x4_t __a, int32x4_t __b)\n {\n-  return (uint32x4_t)__builtin_neon_vtstv4si (__a, __b);\n+  return (uint32x4_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint8x16_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_u8 (uint8x16_t __a, uint8x16_t __b)\n {\n-  return (uint8x16_t)__builtin_neon_vtstv16qi ((int8x16_t) __a, (int8x16_t) __b);\n+  return (uint8x16_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint16x8_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_u16 (uint16x8_t __a, uint16x8_t __b)\n {\n-  return (uint16x8_t)__builtin_neon_vtstv8hi ((int16x8_t) __a, (int16x8_t) __b);\n+  return (uint16x8_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint32x4_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_u32 (uint32x4_t __a, uint32x4_t __b)\n {\n-  return (uint32x4_t)__builtin_neon_vtstv4si ((int32x4_t) __a, (int32x4_t) __b);\n+  return (uint32x4_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint8x16_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_p8 (poly8x16_t __a, poly8x16_t __b)\n {\n-  return (uint8x16_t)__builtin_neon_vtstv16qi ((int8x16_t) __a, (int8x16_t) __b);\n+  return (uint8x16_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline uint16x8_t\n __attribute__  ((__always_inline__, __gnu_inline__, __artificial__))\n vtstq_p16 (poly16x8_t __a, poly16x8_t __b)\n {\n-  return (uint16x8_t)__builtin_neon_vtstv8hi ((int16x8_t) __a, (int16x8_t) __b);\n+  return (uint16x8_t) ((__a & __b) != 0);\n }\n \n __extension__ extern __inline int8x8_t"}, {"sha": "70438ac184832dfec23b0433b2d0b72a515fd955", "filename": "gcc/config/arm/arm_neon_builtins.def", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57/gcc%2Fconfig%2Farm%2Farm_neon_builtins.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57/gcc%2Fconfig%2Farm%2Farm_neon_builtins.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm_neon_builtins.def?ref=36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57", "patch": "@@ -142,7 +142,6 @@ VAR2 (UNOP, vcgez, v4hf, v8hf)\n VAR2 (UNOP, vcgtz, v4hf, v8hf)\n VAR2 (UNOP, vclez, v4hf, v8hf)\n VAR2 (UNOP, vcltz, v4hf, v8hf)\n-VAR6 (BINOP, vtst, v8qi, v4hi, v2si, v16qi, v8hi, v4si)\n VAR6 (BINOP, vabds, v8qi, v4hi, v2si, v16qi, v8hi, v4si)\n VAR6 (BINOP, vabdu, v8qi, v4hi, v2si, v16qi, v8hi, v4si)\n VAR2 (BINOP, vabdf, v2sf, v4sf)"}, {"sha": "641d26fed47b6c95f9114f752ec5bed9967c4c43", "filename": "gcc/config/arm/neon.md", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57/gcc%2Fconfig%2Farm%2Fneon.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57/gcc%2Fconfig%2Farm%2Fneon.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fneon.md?ref=36ecd44bd2aa2623e12af6b7c8cf433a4f29aa57", "patch": "@@ -2578,16 +2578,6 @@\n   DONE;\n })\n \n-(define_insn \"neon_vtst<mode>\"\n-  [(set (match_operand:VDQIW 0 \"s_register_operand\" \"=w\")\n-        (unspec:VDQIW [(match_operand:VDQIW 1 \"s_register_operand\" \"w\")\n-\t\t       (match_operand:VDQIW 2 \"s_register_operand\" \"w\")]\n-\t\t      UNSPEC_VTST))]\n-  \"TARGET_NEON\"\n-  \"vtst.<V_sz_elem>\\t%<V_reg>0, %<V_reg>1, %<V_reg>2\"\n-  [(set_attr \"type\" \"neon_tst<q>\")]\n-)\n-\n (define_insn \"neon_vtst_combine<mode>\"\n   [(set (match_operand:VDQIW 0 \"s_register_operand\" \"=w\")\n         (plus:VDQIW"}]}