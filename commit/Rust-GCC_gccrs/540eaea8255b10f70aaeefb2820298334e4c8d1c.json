{"sha": "540eaea8255b10f70aaeefb2820298334e4c8d1c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTQwZWFlYTgyNTViMTBmNzBhYWVlZmIyODIwMjk4MzM0ZTRjOGQxYw==", "commit": {"author": {"name": "Bob Wilson", "email": "bob.wilson@acm.org", "date": "2002-06-05T18:55:19Z"}, "committer": {"name": "Bob Wilson", "email": "bwilson@gcc.gnu.org", "date": "2002-06-05T18:55:19Z"}, "message": "xtensa.c (xtensa_build_va_list): Use lang_hooks.types.make_type instead of make_node; set up __va_list_tag type decl.\n\n        * config/xtensa/xtensa.c (xtensa_build_va_list): Use\n        lang_hooks.types.make_type instead of make_node; set up\n        __va_list_tag type decl.\n        (xtensa_builtin_saveregs): Remove broken use of\n        RTX_UNCHANGING_P and unnecessary use of MEM_IN_STRUCT_P\n        for saved registers; add varargs alias set.\n\nFrom-SVN: r54288", "tree": {"sha": "27a5eb835513422788b52b90130eff4f2270185b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/27a5eb835513422788b52b90130eff4f2270185b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/540eaea8255b10f70aaeefb2820298334e4c8d1c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/540eaea8255b10f70aaeefb2820298334e4c8d1c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/540eaea8255b10f70aaeefb2820298334e4c8d1c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/540eaea8255b10f70aaeefb2820298334e4c8d1c/comments", "author": null, "committer": null, "parents": [{"sha": "d89e380b10d10865878d347354c10f916ecdf9a6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d89e380b10d10865878d347354c10f916ecdf9a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d89e380b10d10865878d347354c10f916ecdf9a6"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "d7aa706f311e14f751496bcd38844e1bb4f99cbf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/540eaea8255b10f70aaeefb2820298334e4c8d1c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/540eaea8255b10f70aaeefb2820298334e4c8d1c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=540eaea8255b10f70aaeefb2820298334e4c8d1c", "patch": "@@ -1,3 +1,12 @@\n+2002-06-05  Bob Wilson  <bob.wilson@acm.org>\n+\n+\t* config/xtensa/xtensa.c (xtensa_build_va_list): Use\n+\tlang_hooks.types.make_type instead of make_node; set up\n+\t__va_list_tag type decl.\n+\t(xtensa_builtin_saveregs): Remove broken use of\n+\tRTX_UNCHANGING_P and unnecessary use of MEM_IN_STRUCT_P\n+\tfor saved registers; add varargs alias set.\n+\n 2002-06-05  Neil Booth  <neil@daikokuya.demon.co.uk>\n \n config:"}, {"sha": "f2cb700e1ba1015d24a06fdaee4ff40627255312", "filename": "gcc/config/xtensa/xtensa.c", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/540eaea8255b10f70aaeefb2820298334e4c8d1c/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/540eaea8255b10f70aaeefb2820298334e4c8d1c/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.c?ref=540eaea8255b10f70aaeefb2820298334e4c8d1c", "patch": "@@ -47,6 +47,7 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n #include \"ggc.h\"\n #include \"target.h\"\n #include \"target-def.h\"\n+#include \"langhooks.h\"\n \n /* Enumeration for all of the relational tests, so that we can build\n    arrays indexed by the test type, and not worry about the order\n@@ -2303,9 +2304,10 @@ xtensa_function_epilogue (file, size)\n tree\n xtensa_build_va_list (void)\n {\n-  tree f_stk, f_reg, f_ndx, record;\n+  tree f_stk, f_reg, f_ndx, record, type_decl;\n \n-  record = make_node (RECORD_TYPE);\n+  record = (*lang_hooks.types.make_type) (RECORD_TYPE);\n+  type_decl = build_decl (TYPE_DECL, get_identifier (\"__va_list_tag\"), record);\n \n   f_stk = build_decl (FIELD_DECL, get_identifier (\"__va_stk\"),\n \t\t      ptr_type_node);\n@@ -2318,6 +2320,8 @@ xtensa_build_va_list (void)\n   DECL_FIELD_CONTEXT (f_reg) = record;\n   DECL_FIELD_CONTEXT (f_ndx) = record;\n \n+  TREE_CHAIN (record) = type_decl;\n+  TYPE_NAME (record) = type_decl;\n   TYPE_FIELDS (record) = f_stk;\n   TREE_CHAIN (f_stk) = f_reg;\n   TREE_CHAIN (f_reg) = f_ndx;\n@@ -2344,9 +2348,7 @@ xtensa_builtin_saveregs ()\n   /* allocate the general-purpose register space */\n   gp_regs = assign_stack_local\n     (BLKmode, MAX_ARGS_IN_REGISTERS * UNITS_PER_WORD, -1);\n-  MEM_IN_STRUCT_P (gp_regs) = 1;\n-  RTX_UNCHANGING_P (gp_regs) = 1;\n-  RTX_UNCHANGING_P (XEXP (gp_regs, 0)) = 1;\n+  set_mem_alias_set (gp_regs, get_varargs_alias_set ());\n \n   /* Now store the incoming registers.  */\n   dest = change_address (gp_regs, SImode,"}]}