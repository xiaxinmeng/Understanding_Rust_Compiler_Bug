{"sha": "412381d963f02ce3c6dd00d7c4daac4676a02818", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDEyMzgxZDk2M2YwMmNlM2M2ZGQwMGQ3YzRkYWFjNDY3NmEwMjgxOA==", "commit": {"author": {"name": "Torbjorn Granlund", "email": "tege@gnu.org", "date": "1994-07-13T20:55:07Z"}, "committer": {"name": "Torbjorn Granlund", "email": "tege@gnu.org", "date": "1994-07-13T20:55:07Z"}, "message": "(expand_divmod, case CEIL_DIV_EXPR): Handle emit_store_flag returning 0.\n\nFrom-SVN: r7768", "tree": {"sha": "2e8041a690962c31a68ac4ccefc2635f504b42f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2e8041a690962c31a68ac4ccefc2635f504b42f9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/412381d963f02ce3c6dd00d7c4daac4676a02818", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/412381d963f02ce3c6dd00d7c4daac4676a02818", "html_url": "https://github.com/Rust-GCC/gccrs/commit/412381d963f02ce3c6dd00d7c4daac4676a02818", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/412381d963f02ce3c6dd00d7c4daac4676a02818/comments", "author": null, "committer": null, "parents": [{"sha": "24a13950ca6786c0bb338b760d5e6a0dcdaeebcf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24a13950ca6786c0bb338b760d5e6a0dcdaeebcf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24a13950ca6786c0bb338b760d5e6a0dcdaeebcf"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "e2cba0dc46f8d7b0376e470601cd2ce9c6fbf53f", "filename": "gcc/expmed.c", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/412381d963f02ce3c6dd00d7c4daac4676a02818/gcc%2Fexpmed.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/412381d963f02ce3c6dd00d7c4daac4676a02818/gcc%2Fexpmed.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpmed.c?ref=412381d963f02ce3c6dd00d7c4daac4676a02818", "patch": "@@ -3132,16 +3132,28 @@ expand_divmod (rem_flag, code, mode, op0, op1, target, unsignedp)\n \t\tunsigned HOST_WIDE_INT d = INTVAL (op1);\n \t\tt1 = expand_shift (RSHIFT_EXPR, compute_mode, op0,\n \t\t\t\t   build_int_2 (floor_log2 (d), 0),\n-\t\t\t\t   NULL_RTX, 1);\n+\t\t\t\t   tquotient, 1);\n \t\tt2 = expand_binop (compute_mode, and_optab, op0,\n \t\t\t\t   GEN_INT (d - 1),\n \t\t\t\t   NULL_RTX, 1, OPTAB_LIB_WIDEN);\n \t\tt3 = gen_reg_rtx (compute_mode);\n \t\tt3 = emit_store_flag (t3, NE, t2, const0_rtx,\n \t\t\t\t      compute_mode, 1, 1);\n-\t\tquotient = force_operand (gen_rtx (PLUS, compute_mode,\n-\t\t\t\t\t\t   t1, t3),\n-\t\t\t\t\t  tquotient);\n+\t\tif (t3 == 0)\n+\t\t  {\n+\t\t    rtx lab;\n+\t\t    lab = gen_label_rtx ();\n+\t\t    emit_cmp_insn (t2, const0_rtx, EQ, NULL_RTX,\n+\t\t\t\t   compute_mode, 0, 0);\n+\t\t    emit_jump_insn (gen_beq (lab));\n+\t\t    expand_inc (t1, const1_rtx);\n+\t\t    emit_label (lab);\n+\t\t    quotient = t1;\n+\t\t  }\n+\t\telse\n+\t\t  quotient = force_operand (gen_rtx (PLUS, compute_mode,\n+\t\t\t\t\t\t     t1, t3),\n+\t\t\t\t\t    tquotient);\n \t\tbreak;\n \t      }\n "}]}