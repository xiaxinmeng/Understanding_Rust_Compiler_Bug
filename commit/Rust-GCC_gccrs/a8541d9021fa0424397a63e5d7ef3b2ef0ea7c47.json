{"sha": "a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTg1NDFkOTAyMWZhMDQyNDM5N2E2M2U1ZDdlZjNiMmVmMGVhN2M0Nw==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2017-11-24T00:00:46Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2017-11-24T00:00:46Z"}, "message": "Add [[nodiscard]] attribute to std::launder\n\n\t* libsupc++/new (launder): Add nodiscard attribute.\n\t* testsuite/18_support/launder/nodiscard.cc: New test.\n\nFrom-SVN: r255127", "tree": {"sha": "869e4a4b94ada09249de3fa75a23531b682ea3cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/869e4a4b94ada09249de3fa75a23531b682ea3cc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "117e6b50b6879c11589bc8287199652a626594d1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/117e6b50b6879c11589bc8287199652a626594d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/117e6b50b6879c11589bc8287199652a626594d1"}], "stats": {"total": 36, "additions": 34, "deletions": 2}, "files": [{"sha": "d098ccc74165e589d9c368ed90390f36c7dbf79d", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47", "patch": "@@ -1,5 +1,8 @@\n 2017-11-23  Jonathan Wakely  <jwakely@redhat.com>\n \n+\t* libsupc++/new (launder): Add nodiscard attribute.\n+\t* testsuite/18_support/launder/nodiscard.cc: New test.\n+\n \t* include/bits/fs_path.h (path::empty): Add nodiscard attribute.\n \t* include/bits/range_access.h (empty): Likewise.\n \t* include/std/string_view (basic_string_view::empty): Likewise."}, {"sha": "0e408b1019cd3166cdcdad5cc3cae93430193d39", "filename": "libstdc++-v3/libsupc++/new", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fnew", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fnew", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fnew?ref=a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47", "patch": "@@ -176,7 +176,7 @@ inline void operator delete[](void*, void*) _GLIBCXX_USE_NOEXCEPT { }\n //@}\n } // extern \"C++\"\n \n-#if __cplusplus > 201402L\n+#if __cplusplus >= 201703L\n #if __GNUC__ >= 7\n #  define _GLIBCXX_HAVE_BUILTIN_LAUNDER 1\n #elif defined __has_builtin\n@@ -192,7 +192,7 @@ namespace std\n #define __cpp_lib_launder 201606\n   /// Pointer optimization barrier [ptr.launder]\n   template<typename _Tp>\n-    constexpr _Tp*\n+    [[nodiscard]] constexpr _Tp*\n     launder(_Tp* __p) noexcept\n     { return __builtin_launder(__p); }\n "}, {"sha": "1741465abedb79cdf630d687e4534922fa871663", "filename": "libstdc++-v3/testsuite/18_support/launder/nodiscard.cc", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2Flaunder%2Fnodiscard.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2Flaunder%2Fnodiscard.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2Flaunder%2Fnodiscard.cc?ref=a8541d9021fa0424397a63e5d7ef3b2ef0ea7c47", "patch": "@@ -0,0 +1,29 @@\n+// Copyright (C) 2017 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-std=gnu++17\" }\n+// { dg-do compile { target c++17 } }\n+\n+#include <new>\n+\n+struct A { const int i; };\n+\n+void\n+test01(A* a)\n+{\n+  std::launder(a); // { dg-warning \"ignoring return value\" }\n+}"}]}