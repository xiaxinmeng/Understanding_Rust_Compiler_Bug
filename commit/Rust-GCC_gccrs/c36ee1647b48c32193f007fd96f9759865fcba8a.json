{"sha": "c36ee1647b48c32193f007fd96f9759865fcba8a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzM2ZWUxNjQ3YjQ4YzMyMTkzZjAwN2ZkOTZmOTc1OTg2NWZjYmE4YQ==", "commit": {"author": {"name": "Neil Booth", "email": "neil@daikokuya.demon.co.uk", "date": "2000-12-13T19:47:11Z"}, "committer": {"name": "Neil Booth", "email": "neil@gcc.gnu.org", "date": "2000-12-13T19:47:11Z"}, "message": "tradcpp.c (special_symbol): Improve test for definedness, though it is still not perfect.\n\n       * tradcpp.c (special_symbol): Improve test for definedness,\n        though it is still not perfect.\n        (do_define): Don't define illegal macro names.\n\nFrom-SVN: r38230", "tree": {"sha": "c232468f6550ec38fdf339bcbb7744f1b1d8f0b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c232468f6550ec38fdf339bcbb7744f1b1d8f0b8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c36ee1647b48c32193f007fd96f9759865fcba8a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c36ee1647b48c32193f007fd96f9759865fcba8a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c36ee1647b48c32193f007fd96f9759865fcba8a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c36ee1647b48c32193f007fd96f9759865fcba8a/comments", "author": null, "committer": null, "parents": [{"sha": "04fd40b9d15b6374d3508259c86ed88d773bd988", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04fd40b9d15b6374d3508259c86ed88d773bd988", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04fd40b9d15b6374d3508259c86ed88d773bd988"}], "stats": {"total": 25, "additions": 21, "deletions": 4}, "files": [{"sha": "637029bb2f74c48fba6b68753d7c75d3487fcf8b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c36ee1647b48c32193f007fd96f9759865fcba8a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c36ee1647b48c32193f007fd96f9759865fcba8a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c36ee1647b48c32193f007fd96f9759865fcba8a", "patch": "@@ -1,3 +1,9 @@\n+2000-12-13  Neil Booth  <neil@daikokuya.demon.co.uk>\n+\n+        * tradcpp.c (special_symbol): Improve test for definedness,\n+        though it is still not perfect.\n+        (do_define): Don't define illegal macro names.\n+\t\n 2000-12-07  Aldy Hernandez  <aldyh@redhat.com>\n \n         * config/mips/elf.h (ASM_OUTPUT_SECTION_NAME): emit @nobits"}, {"sha": "a0a55b8167d501c228ce12b02dbb09049ae5c715", "filename": "gcc/tradcpp.c", "status": "modified", "additions": 15, "deletions": 4, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c36ee1647b48c32193f007fd96f9759865fcba8a/gcc%2Ftradcpp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c36ee1647b48c32193f007fd96f9759865fcba8a/gcc%2Ftradcpp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftradcpp.c?ref=c36ee1647b48c32193f007fd96f9759865fcba8a", "patch": "@@ -2160,8 +2160,12 @@ special_symbol (hp, op)\n \n     if (!is_idstart (*ip->bufp))\n       goto oops;\n-    if (lookup (ip->bufp, -1, -1))\n-      buf = \" 1 \";\n+    {\n+      HASHNODE *hp = lookup (ip->bufp, -1, -1);\n+\n+      if (hp && hp->type != T_UNUSED && hp->type != T_SPEC_DEFINED)\n+\tbuf = \" 1 \";\n+    }\n     while (is_idchar (*ip->bufp))\n       ++ip->bufp;\n     SKIP_WHITE_SPACE (ip->bufp);\n@@ -2509,16 +2513,23 @@ do_define (buf, limit, op)\n   }\n   sym_length = bp - symname;\n   if (sym_length == 0)\n-    error (\"invalid macro name\");\n+    {\n+      error (\"invalid macro name\");\n+      return;\n+    }\n   else if (!is_idstart (*symname)) {\n     U_CHAR *msg;\t\t\t/* what pain... */\n     msg = (U_CHAR *) alloca (sym_length + 1);\n     memcpy (msg, symname, sym_length);\n     msg[sym_length] = 0;\n     error (\"invalid macro name `%s'\", msg);\n+    return;\n   } else {\n     if (! strncmp ((const char *)symname, \"defined\", 7) && sym_length == 7)\n-      error (\"defining `defined' as a macro\");\n+      {\n+\terror (\"\\\"defined\\\" cannot be used as a macro name\");\n+\treturn;\n+      }\n   }\n \n   /* lossage will occur if identifiers or control keywords are broken"}]}