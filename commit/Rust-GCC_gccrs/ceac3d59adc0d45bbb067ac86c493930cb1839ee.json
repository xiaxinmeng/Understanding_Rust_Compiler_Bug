{"sha": "ceac3d59adc0d45bbb067ac86c493930cb1839ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2VhYzNkNTlhZGMwZDQ1YmJiMDY3YWM4NmM0OTM5MzBjYjE4MzllZQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2007-12-27T12:33:52Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2007-12-27T12:33:52Z"}, "message": "re PR fortran/34594 (On error and END, no jump to ERR=<label>)\n\n2007-12-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/34594\n\t* runtime/error.c: If there was a previous error, don't\n\tmask it with another error mesage, EOF or EOR condition.\n\n2007-12-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/34594\n\t* gfortran.dg/direct_io_8.f90:  New test case.\n\nFrom-SVN: r131199", "tree": {"sha": "b4645f03a52732367009cbd99e723a955e047126", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b4645f03a52732367009cbd99e723a955e047126"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ceac3d59adc0d45bbb067ac86c493930cb1839ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ceac3d59adc0d45bbb067ac86c493930cb1839ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ceac3d59adc0d45bbb067ac86c493930cb1839ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ceac3d59adc0d45bbb067ac86c493930cb1839ee/comments", "author": null, "committer": null, "parents": [{"sha": "edbf8b16980a483c70cce6fc94401ec6936a9789", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/edbf8b16980a483c70cce6fc94401ec6936a9789", "html_url": "https://github.com/Rust-GCC/gccrs/commit/edbf8b16980a483c70cce6fc94401ec6936a9789"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "dd87ad99b7e6337b454378ba3268b877ced7f0ac", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ceac3d59adc0d45bbb067ac86c493930cb1839ee/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ceac3d59adc0d45bbb067ac86c493930cb1839ee/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ceac3d59adc0d45bbb067ac86c493930cb1839ee", "patch": "@@ -1,3 +1,8 @@\n+2007-12-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/34594\n+\t* gfortran.dg/direct_io_8.f90:  New test case.\n+\n 2007-12-27  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/34281"}, {"sha": "5e384a1cfa327e86d0b2be9a13aab143cf291cee", "filename": "gcc/testsuite/gfortran.dg/direct_io_8.f90", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ceac3d59adc0d45bbb067ac86c493930cb1839ee/gcc%2Ftestsuite%2Fgfortran.dg%2Fdirect_io_8.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ceac3d59adc0d45bbb067ac86c493930cb1839ee/gcc%2Ftestsuite%2Fgfortran.dg%2Fdirect_io_8.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdirect_io_8.f90?ref=ceac3d59adc0d45bbb067ac86c493930cb1839ee", "patch": "@@ -0,0 +1,25 @@\n+! { dg-do run }\n+! PR 34594 - this used to give runtime errors due to an\n+! end condition.\n+program main\n+  implicit none\n+  integer :: iou, i, ir, TEMP_CHANGES\n+  i=44\n+  ir = -42\n+\n+  open(11,file=\"foo.dat\")\n+  ! Try a direct access read on a formatted sequential rile\n+  READ (11, REC = I, ERR = 99) TEMP_CHANGES\n+  call abort\n+99 continue\n+  ! Variant 2: ir is ok, but does not jump to 99\n+  READ (11, REC = I, IOSTAT = IR, ERR = 98) TEMP_CHANGES\n+  call abort\n+\n+98 continue\n+  if(ir == 0) then\n+     call abort\n+  end if\n+  close(11,status=\"delete\")\n+end program main\n+"}, {"sha": "f7d260dd7c6027b41e83c8093a71a870c3a7e70c", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ceac3d59adc0d45bbb067ac86c493930cb1839ee/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ceac3d59adc0d45bbb067ac86c493930cb1839ee/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=ceac3d59adc0d45bbb067ac86c493930cb1839ee", "patch": "@@ -1,3 +1,9 @@\n+2007-12-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/34594\n+\t* runtime/error.c: If there was a previous error, don't\n+\tmask it with another error mesage, EOF or EOR condition.\n+\n 2007-12-25  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libfortran/34560"}, {"sha": "f0a4ff2291dc6476ba8f977de6bf75624de6f7ea", "filename": "libgfortran/runtime/error.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ceac3d59adc0d45bbb067ac86c493930cb1839ee/libgfortran%2Fruntime%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ceac3d59adc0d45bbb067ac86c493930cb1839ee/libgfortran%2Fruntime%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fruntime%2Ferror.c?ref=ceac3d59adc0d45bbb067ac86c493930cb1839ee", "patch": "@@ -410,6 +410,13 @@ translate_error (int code)\n void\n generate_error (st_parameter_common *cmp, int family, const char *message)\n {\n+\n+  /* If there was a previous error, don't mask it with another\n+     error message, EOF or EOR condition.  */\n+\n+  if ((cmp->flags & IOPARM_LIBRETURN_MASK) == IOPARM_LIBRETURN_ERROR)\n+    return;\n+\n   /* Set the error status.  */\n   if ((cmp->flags & IOPARM_HAS_IOSTAT))\n     *cmp->iostat = (family == LIBERROR_OS) ? errno : family;"}]}