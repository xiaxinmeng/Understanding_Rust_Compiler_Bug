{"sha": "4075fc70242c293fa46eef78af924ed5cc3f6647", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDA3NWZjNzAyNDJjMjkzZmE0NmVlZjc4YWY5MjRlZDVjYzNmNjY0Nw==", "commit": {"author": {"name": "Mateusz B", "email": "mateuszb@poczta.onet.pl", "date": "2019-01-07T07:31:19Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2019-01-07T07:31:19Z"}, "message": "re PR target/88521 (GCC from r266355 miscompiles x265 for mingw-w64 target)\n\nPR target/88521\n\t* config/i386/i386.c (function_value_ms_64): Return small sturct in\n\tAX_REG and float/double in FIRST_SSE_REG for 4 or 8 byte modes.\n\nFrom-SVN: r267622", "tree": {"sha": "c8320a287aca1c152f99000b1ea6c10dc1620452", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c8320a287aca1c152f99000b1ea6c10dc1620452"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4075fc70242c293fa46eef78af924ed5cc3f6647", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4075fc70242c293fa46eef78af924ed5cc3f6647", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4075fc70242c293fa46eef78af924ed5cc3f6647", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4075fc70242c293fa46eef78af924ed5cc3f6647/comments", "author": null, "committer": null, "parents": [{"sha": "0aa6ee36708f0c70b2e98905480ca035a6f56689", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0aa6ee36708f0c70b2e98905480ca035a6f56689", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0aa6ee36708f0c70b2e98905480ca035a6f56689"}], "stats": {"total": 48, "additions": 48, "deletions": 0}, "files": [{"sha": "9a0151684f5f606ef6bc517cb9d51f27ee5b2f05", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4075fc70242c293fa46eef78af924ed5cc3f6647", "patch": "@@ -1,3 +1,9 @@\n+2018-12-26  Mateusz B  <mateuszb@poczta.onet.pl>\n+\n+\tPR target/88521\n+\t* config/i386/i386.c (function_value_ms_64): Return small sturct in\n+\tAX_REG and float/double in FIRST_SSE_REG for 4 or 8 byte modes.\n+\n 2019-01-05  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR tree-opt/86020"}, {"sha": "d01278d866f66b263f1ba76bd59e2e5f32686af7", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=4075fc70242c293fa46eef78af924ed5cc3f6647", "patch": "@@ -9063,6 +9063,13 @@ function_value_ms_64 (machine_mode orig_mode, machine_mode mode,\n \t      && !COMPLEX_MODE_P (mode))\n \t    regno = FIRST_SSE_REG;\n \t  break;\n+\tcase 8:\n+\tcase 4:\n+\t  if (valtype != NULL_TREE && AGGREGATE_TYPE_P (valtype))\n+\t    break;\n+\t  if (mode == SFmode || mode == DFmode)\n+\t    regno = FIRST_SSE_REG;\n+\t  break;\n \tdefault:\n \t  break;\n         }"}, {"sha": "c0bb2817873914b416abb0bcc97bb678a1c80a17", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4075fc70242c293fa46eef78af924ed5cc3f6647", "patch": "@@ -1,3 +1,8 @@\n+2018-12-26  Mateusz B  <mateuszb@poczta.onet.pl>\n+\n+\tPR target/88521\n+\t* gcc.target/i386/pr88521.c: New testcase.\n+\n 2019-01-06  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/88658"}, {"sha": "f42703add64955e4edc679898fd9637b7d1d0e6f", "filename": "gcc/testsuite/gcc.target/i386/pr88521.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr88521.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4075fc70242c293fa46eef78af924ed5cc3f6647/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr88521.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr88521.c?ref=4075fc70242c293fa46eef78af924ed5cc3f6647", "patch": "@@ -0,0 +1,30 @@\n+/* { dg-do compile { target lp64 } } */\n+/* { dg-options \"-O2\" } */\n+/* { dg-final { scan-assembler-times \"movl\\[^\\n\\r]*, %eax|mov\\[ \\t]*eax,\" 1 } } */\n+/* { dg-final { scan-assembler-times \"movss\\[^\\n\\r]*, %xmm\" 1 } } */\n+/* { dg-final { scan-assembler-times \"movsd\\[^\\n\\r]*, %xmm\" 1 } } */\n+typedef struct\n+{\n+  float x;\n+} Float;\n+\n+Float  __attribute__((ms_abi)) fn1()\n+{\n+  Float v;\n+  v.x = 3.145F;\n+  return v;\n+}\n+\n+float  __attribute__((ms_abi))  fn2 ()\n+{\n+  float v;\n+  v = 3.145F;\n+  return v;\n+}\n+\n+double  __attribute__((ms_abi))  fn3 ()\n+{\n+  double v;\n+  v = 3.145;\n+  return v;\n+}"}]}