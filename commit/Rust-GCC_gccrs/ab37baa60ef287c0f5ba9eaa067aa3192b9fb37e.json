{"sha": "ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWIzN2JhYTYwZWYyODdjMGY1YmE5ZWFhMDY3YWEzMTkyYjlmYjM3ZQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-04-17T15:19:12Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-05-05T14:04:32Z"}, "message": "gcov: print total_lines summary for all files.\n\ngcc/ChangeLog:\n\n2020-04-17  Martin Liska  <mliska@suse.cz>\n\n\tPR gcov-profile/94636\n\t* gcov.c (main): Print total lines summary at the end.\n\t(generate_results): Expect file_name always being non-null.\n\tPrint newline after intermediate file is printed in order to align with\n\twhat we do for normal files.", "tree": {"sha": "d1f2fcb03f2022155c3e740849d9c43950cac8b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d1f2fcb03f2022155c3e740849d9c43950cac8b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e", "comment_count": 0, "verification": {"verified": false, "reason": "unknown_key", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQEzBAABCAAdFiEE6I4wzqqylQBfXaRhTcGC3A+nN4UFAl6xcnAACgkQTcGC3A+n\nN4XYoAgArI2bf3MfZNxZqUkERunIQfUwySwXggRhm+PphAY/MlQ/w/wKunYsvXIz\nGJ0Pk5UMRWRhsbKa7tQmH9FzZxXBOXG/ITQiucuOIzjhFhDaFBznTKiec7LqBgwA\nCujfDdYfC7wEJwEjlGvIXC3eZUsVWTk4IB5DyPbvBSksSJ3s79nN7lv67njLtZ44\ncHSjztsNxbMP/nlMu+4hC6tI0k8iWDfKcLm1eToDSZyPNzolqE+ZqDquPnbwSoeE\n7Wg+tREZalitHHdB6H0r6aJCxGWTSSNJ+htTZcfYD8Z4V+9rLC7Tg8N7BcaJQvZM\nKqC3lj+rE/0Ebp1NLgRPNEKbW+/lkQ==\n=uSkL\n-----END PGP SIGNATURE-----", "payload": "tree d1f2fcb03f2022155c3e740849d9c43950cac8b5\nparent 48c041033ec07b22fda380daa208ab754ec52b68\nauthor Martin Liska <mliska@suse.cz> 1587136752 +0200\ncommitter Martin Liska <mliska@suse.cz> 1588687472 +0200\n\ngcov: print total_lines summary for all files.\n\ngcc/ChangeLog:\n\n2020-04-17  Martin Liska  <mliska@suse.cz>\n\n\tPR gcov-profile/94636\n\t* gcov.c (main): Print total lines summary at the end.\n\t(generate_results): Expect file_name always being non-null.\n\tPrint newline after intermediate file is printed in order to align with\n\twhat we do for normal files.\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "48c041033ec07b22fda380daa208ab754ec52b68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48c041033ec07b22fda380daa208ab754ec52b68", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48c041033ec07b22fda380daa208ab754ec52b68"}], "stats": {"total": 30, "additions": 15, "deletions": 15}, "files": [{"sha": "488847231c242b29cbec2c65fd62e8c843ae83ad", "filename": "gcc/gcov.c", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e/gcc%2Fgcov.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e/gcc%2Fgcov.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov.c?ref=ab37baa60ef287c0f5ba9eaa067aa3192b9fb37e", "patch": "@@ -874,6 +874,9 @@ main (int argc, char **argv)\n \t}\n     }\n \n+  if (!flag_use_stdout)\n+    executed_summary (total_lines, total_executed);\n+\n   return 0;\n }\n \f\n@@ -1410,17 +1413,13 @@ generate_results (const char *file_name)\n     }\n \n   name_map needle;\n-\n-  if (file_name)\n-    {\n-      needle.name = file_name;\n-      vector<name_map>::iterator it = std::find (names.begin (), names.end (),\n-\t\t\t\t\t\t needle);\n-      if (it != names.end ())\n-\tfile_name = sources[it->src].coverage.name;\n-      else\n-\tfile_name = canonicalize_name (file_name);\n-    }\n+  needle.name = file_name;\n+  vector<name_map>::iterator it\n+    = std::find (names.begin (), names.end (), needle);\n+  if (it != names.end ())\n+    file_name = sources[it->src].coverage.name;\n+  else\n+    file_name = canonicalize_name (file_name);\n \n   gcov_intermediate_filename = get_gcov_intermediate_filename (file_name);\n \n@@ -1462,7 +1461,11 @@ generate_results (const char *file_name)\n       if (flag_gcov_file)\n \t{\n \t  if (flag_json_format)\n-\t    output_json_intermediate_file (json_files, src);\n+\t    {\n+\t      output_json_intermediate_file (json_files, src);\n+\t      if (!flag_use_stdout)\n+\t\tfnotice (stdout, \"\\n\");\n+\t    }\n \t  else\n \t    {\n \t      if (flag_use_stdout)\n@@ -1509,9 +1512,6 @@ generate_results (const char *file_name)\n \t    }\n \t}\n     }\n-\n-  if (!file_name)\n-    executed_summary (total_lines, total_executed);\n }\n \n /* Release all memory used.  */"}]}