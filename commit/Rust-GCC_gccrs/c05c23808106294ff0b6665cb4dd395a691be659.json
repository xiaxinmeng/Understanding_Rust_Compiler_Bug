{"sha": "c05c23808106294ff0b6665cb4dd395a691be659", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzA1YzIzODA4MTA2Mjk0ZmYwYjY2NjVjYjRkZDM5NWE2OTFiZTY1OQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-03-16T16:27:08Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-03-16T16:27:08Z"}, "message": "re PR fortran/79886 (ICE in pp_format, at pretty-print.c:681)\n\n\tPR fortran/79886\n\t* tree-diagnostic.c (default_tree_printer): No longer static.\n\t* tree-diagnostic.h (default_tree_printer): New prototype.\nfortran/\n\t* error.c (gfc_format_decoder): Rename plus argument to set_locus,\n\tremove ATTRIBUTE_UNUSED from all arguments, call default_tree_printer\n\tif not a Fortran specific spec.\n\t* trans-io.c: Include options.h.\n\t(gfc_build_st_parameter): Temporarily disable -Wpadded around layout\n\tof artificial IO data structures.\ntestsuite/\n\t* gfortran.dg/pr79886.f90: New test.\n\nFrom-SVN: r246203", "tree": {"sha": "c7210819be4333f611c44f059178af13c9f25c8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c7210819be4333f611c44f059178af13c9f25c8d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c05c23808106294ff0b6665cb4dd395a691be659", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c05c23808106294ff0b6665cb4dd395a691be659", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c05c23808106294ff0b6665cb4dd395a691be659", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c05c23808106294ff0b6665cb4dd395a691be659/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a4c687d64b5e1144ef7f61b6daf7efb209f83d35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4c687d64b5e1144ef7f61b6daf7efb209f83d35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4c687d64b5e1144ef7f61b6daf7efb209f83d35"}], "stats": {"total": 61, "additions": 55, "deletions": 6}, "files": [{"sha": "ee94c4f97eb3b32c954fe1be36e8551803427fc6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -1,3 +1,9 @@\n+2017-03-16  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/79886\n+\t* tree-diagnostic.c (default_tree_printer): No longer static.\n+\t* tree-diagnostic.h (default_tree_printer): New prototype.\n+\n 2017-03-16  Tamar Christina  <tamar.christina@arm.com>\n \n \t* config/aarch64/aarch64-simd.md (*aarch64_simd_mov<mode>)"}, {"sha": "b617d45ca86b775061b39150950576af9972d846", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -1,3 +1,13 @@\n+2017-03-16  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/79886\n+\t* error.c (gfc_format_decoder): Rename plus argument to set_locus,\n+\tremove ATTRIBUTE_UNUSED from all arguments, call default_tree_printer\n+\tif not a Fortran specific spec.\n+\t* trans-io.c: Include options.h.\n+\t(gfc_build_st_parameter): Temporarily disable -Wpadded around layout\n+\tof artificial IO data structures.\n+\n 2017-03-15  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR fortran/79860"}, {"sha": "0312499f324ecbbc68c3d5945a43010d6264c01b", "filename": "gcc/fortran/error.c", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ffortran%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ffortran%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ferror.c?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -916,10 +916,8 @@ gfc_notify_std (int std, const char *gmsgid, ...)\n    %L  Takes locus argument\n */\n static bool\n-gfc_format_decoder (pretty_printer *pp,\n-\t\t    text_info *text, const char *spec,\n-\t\t    int precision ATTRIBUTE_UNUSED, bool wide ATTRIBUTE_UNUSED,\n-\t\t    bool plus ATTRIBUTE_UNUSED, bool hash ATTRIBUTE_UNUSED)\n+gfc_format_decoder (pretty_printer *pp, text_info *text, const char *spec,\n+\t\t    int precision, bool wide, bool set_locus, bool hash)\n {\n   switch (*spec)\n     {\n@@ -946,7 +944,11 @@ gfc_format_decoder (pretty_printer *pp,\n \treturn true;\n       }\n     default:\n-      return false;\n+      /* Fall through info the middle-end decoder, as e.g. stor-layout.c\n+\t etc. diagnostics can use the FE printer while the FE is still\n+\t active.  */\n+      return default_tree_printer (pp, text, spec, precision, wide,\n+\t\t\t\t   set_locus, hash);\n     }\n }\n "}, {"sha": "36e84be83c1ba869acd07cc8fd6da75a869db5e5", "filename": "gcc/fortran/trans-io.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ffortran%2Ftrans-io.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ffortran%2Ftrans-io.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-io.c?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -32,6 +32,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"trans-array.h\"\n #include \"trans-types.h\"\n #include \"trans-const.h\"\n+#include \"options.h\"\n \n /* Members of the ioparm structure.  */\n \n@@ -219,7 +220,12 @@ gfc_build_st_parameter (enum ioparam_type ptype, tree *types)\n \t  gcc_unreachable ();\n \t}\n \n+  /* -Wpadded warnings on these artificially created structures are not\n+     helpful; suppress them. */\n+  int save_warn_padded = warn_padded;\n+  warn_padded = 0;\n   gfc_finish_type (t);\n+  warn_padded = save_warn_padded;\n   st_parameter[ptype].type = t;\n }\n "}, {"sha": "2fbdeb581ad122bf1746dc0ccc6cbfd9cb75511a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -1,3 +1,8 @@\n+2017-03-16  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/79886\n+\t* gfortran.dg/pr79886.f90: New test.\n+\n 2017-03-15  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/79038"}, {"sha": "a62cd1889c7ebcdf4698e04d3d6c4d6f529d7da6", "filename": "gcc/testsuite/gfortran.dg/pr79886.f90", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr79886.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr79886.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr79886.f90?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -0,0 +1,17 @@\n+! PR fortran/79886\n+! { dg-do compile }\n+! { dg-options \"-Wpadded\" }\n+\n+subroutine pr79886\n+  type :: foo\n+    integer (kind=1) :: a\n+    integer (kind=8) :: b\t! { dg-warning \"padding struct to align\" }\n+    integer (kind=1) :: c\n+    integer (kind=8) :: d\t! { dg-warning \"padding struct to align\" }\n+  end type\n+  type (foo) :: f\n+  f%a = 1\n+  f%b = 2\n+  f%c = 3\n+  f%d = 4\n+end subroutine"}, {"sha": "4f211ed42b3565701ca74055f4c6c54e6878922f", "filename": "gcc/tree-diagnostic.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftree-diagnostic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftree-diagnostic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-diagnostic.c?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -243,7 +243,7 @@ virt_loc_aware_diagnostic_finalizer (diagnostic_context *context,\n }\n \n /* Default tree printer.   Handles declarations only.  */\n-static bool\n+bool\n default_tree_printer (pretty_printer *pp, text_info *text, const char *spec,\n \t\t      int precision, bool wide, bool set_locus, bool hash)\n {"}, {"sha": "e95183f92f7e260a401047b04e2a06111bbcad84", "filename": "gcc/tree-diagnostic.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftree-diagnostic.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c05c23808106294ff0b6665cb4dd395a691be659/gcc%2Ftree-diagnostic.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-diagnostic.h?ref=c05c23808106294ff0b6665cb4dd395a691be659", "patch": "@@ -54,4 +54,7 @@ void virt_loc_aware_diagnostic_finalizer (diagnostic_context *,\n \t\t\t\t\t  diagnostic_info *);\n \n void tree_diagnostics_defaults (diagnostic_context *context);\n+bool default_tree_printer (pretty_printer *, text_info *, const char *,\n+\t\t\t   int, bool, bool, bool);\n+\n #endif /* ! GCC_TREE_DIAGNOSTIC_H */"}]}