{"sha": "3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2RkNWY0MmU5MGZhNmUyOTZkMjMzYjBmMDVjM2E3NjBhNDVkMTMxMw==", "commit": {"author": {"name": "Ilya Enkovich", "email": "enkovich.gnu@gmail.com", "date": "2016-01-18T10:35:56Z"}, "committer": {"name": "Ilya Enkovich", "email": "ienkovich@gcc.gnu.org", "date": "2016-01-18T10:35:56Z"}, "message": "i386.c (scalar_to_vector_candidate_p): Support andnot instruction.\n\ngcc/\n\n\t* config/i386/i386.c (scalar_to_vector_candidate_p): Support\n\tandnot instruction.\n\t(scalar_chain::convert_op): Likewise.\n\t* config/i386/i386.md (*andndi3_doubleword): New.\n\ngcc/testsuite/\n\n\t* gcc.target/i386/pr65105-5.c: Adjust to andn generation.\n\nFrom-SVN: r232500", "tree": {"sha": "cc8cc97b2e96f6eb8cdb733c094748674ddca8c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cc8cc97b2e96f6eb8cdb733c094748674ddca8c2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/comments", "author": null, "committer": null, "parents": [{"sha": "ae5a77fa960564c8a5b2a00c22b38d954aecddb8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae5a77fa960564c8a5b2a00c22b38d954aecddb8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae5a77fa960564c8a5b2a00c22b38d954aecddb8"}], "stats": {"total": 43, "additions": 40, "deletions": 3}, "files": [{"sha": "b2522c17ce3e6c5a4ae684d62515a87e4aecbe52", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "patch": "@@ -1,3 +1,10 @@\n+2016-01-18  Ilya Enkovich  <enkovich.gnu@gmail.com>\n+\n+\t* config/i386/i386.c (scalar_to_vector_candidate_p): Support\n+\tandnot instruction.\n+\t(scalar_chain::convert_op): Likewise.\n+\t* config/i386/i386.md (*andndi3_doubleword): New.\n+\n 2016-01-18  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/69170"}, {"sha": "92d8ee1a88fbce9c8527e1541688513f0211190c", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "patch": "@@ -2815,7 +2815,11 @@ scalar_to_vector_candidate_p (rtx_insn *insn)\n       return false;\n     }\n \n-  if (!REG_P (XEXP (src, 0)) && !MEM_P (XEXP (src, 0)))\n+  if (!REG_P (XEXP (src, 0)) && !MEM_P (XEXP (src, 0))\n+      /* Check for andnot case.  */\n+      && (GET_CODE (src) != AND\n+\t  || GET_CODE (XEXP (src, 0)) != NOT\n+\t  || !REG_P (XEXP (XEXP (src, 0), 0))))\n       return false;\n \n   if (!REG_P (XEXP (src, 1)) && !MEM_P (XEXP (src, 1)))\n@@ -3383,7 +3387,12 @@ scalar_chain::convert_op (rtx *op, rtx_insn *insn)\n {\n   *op = copy_rtx_if_shared (*op);\n \n-  if (MEM_P (*op))\n+  if (GET_CODE (*op) == NOT)\n+    {\n+      convert_op (&XEXP (*op, 0), insn);\n+      PUT_MODE (*op, V2DImode);\n+    }\n+  else if (MEM_P (*op))\n     {\n       rtx tmp = gen_reg_rtx (DImode);\n "}, {"sha": "f16b42ab884a9a6f137bcc242b4fae0da9bdda69", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "patch": "@@ -8645,6 +8645,23 @@\n \t      (clobber (reg:CC FLAGS_REG))])]\n   \"split_double_mode (DImode, &operands[0], 3, &operands[0], &operands[3]);\")\n \n+(define_insn_and_split \"*andndi3_doubleword\"\n+  [(set (match_operand:DI 0 \"register_operand\" \"=r,r\")\n+\t(and:DI\n+\t  (not:DI (match_operand:DI 1 \"register_operand\" \"r,r\"))\n+\t  (match_operand:DI 2 \"nonimmediate_operand\" \"r,m\")))\n+   (clobber (reg:CC FLAGS_REG))]\n+  \"TARGET_BMI && !TARGET_64BIT && TARGET_STV && TARGET_SSE\"\n+  \"#\"\n+  \"&& reload_completed\"\n+  [(parallel [(set (match_dup 0)\n+\t\t   (and:SI (not:SI (match_dup 1)) (match_dup 2)))\n+\t      (clobber (reg:CC FLAGS_REG))])\n+   (parallel [(set (match_dup 3)\n+\t\t   (and:SI (not:SI (match_dup 4)) (match_dup 5)))\n+\t      (clobber (reg:CC FLAGS_REG))])]\n+  \"split_double_mode (DImode, &operands[0], 3, &operands[0], &operands[3]);\")\n+\n (define_insn \"*<code>hi_1\"\n   [(set (match_operand:HI 0 \"nonimmediate_operand\" \"=r,rm,!k\")\n \t(any_or:HI"}, {"sha": "498632d64eb2c143cbccf28dbf9c60a89be0cb58", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "patch": "@@ -1,3 +1,7 @@\n+2016-01-18  Ilya Enkovich  <enkovich.gnu@gmail.com>\n+\n+\t* gcc.target/i386/pr65105-5.c: Adjust to andn generation.\n+\n 2016-01-18  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/inline12.adb: New test."}, {"sha": "639bbe1eb141e592bf3ca1a4631967a409afd116", "filename": "gcc/testsuite/gcc.target/i386/pr65105-5.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr65105-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dd5f42e90fa6e296d233b0f05c3a760a45d1313/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr65105-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr65105-5.c?ref=3dd5f42e90fa6e296d233b0f05c3a760a45d1313", "patch": "@@ -1,7 +1,7 @@\n /* PR target/pr65105 */\n /* { dg-do compile { target { ia32 } } } */\n /* { dg-options \"-O2 -march=core-avx2\" } */\n-/* { dg-final { scan-assembler \"pand\" } } */\n+/* { dg-final { scan-assembler \"pandn\" } } */\n /* { dg-final { scan-assembler \"pxor\" } } */\n /* { dg-final { scan-assembler \"ptest\" } } */\n "}]}