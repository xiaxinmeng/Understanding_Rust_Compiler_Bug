{"sha": "4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGMxYTRkY2RhMTgyMWZmNDBjZmJiMDMyNDdlNmEzOTFlYmY0N2YzZQ==", "commit": {"author": {"name": "Gary Benson", "email": "gbenson@redhat.com", "date": "2006-08-29T08:15:29Z"}, "committer": {"name": "Gary Benson", "email": "gary@gcc.gnu.org", "date": "2006-08-29T08:15:29Z"}, "message": "2006-08-29  Gary Benson  <gbenson@redhat.com>\n\n\t* java/net/SocketPermission.java\n\t(maybeBracketIPv6Address): New method.\n\t(<init>): Pass the hostport argument through the above.\n\n\t* java/net/NetworkInterface.java (getInetAddresses):\n\tRevert the previous change.\n\nFrom-SVN: r116557", "tree": {"sha": "53e7c80e941e421f65a1991199d5d89539682c2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/53e7c80e941e421f65a1991199d5d89539682c2a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e/comments", "author": null, "committer": null, "parents": [{"sha": "e883464cc4aab3cfd80edf72b793173b797344b4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e883464cc4aab3cfd80edf72b793173b797344b4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e883464cc4aab3cfd80edf72b793173b797344b4"}], "stats": {"total": 62, "additions": 56, "deletions": 6}, "files": [{"sha": "adac6b7f02bfdf92f6006f0c42f913791db5e0f3", "filename": "libjava/classpath/ChangeLog.gcj", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e/libjava%2Fclasspath%2FChangeLog.gcj", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e/libjava%2Fclasspath%2FChangeLog.gcj", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2FChangeLog.gcj?ref=4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e", "patch": "@@ -1,3 +1,12 @@\n+2006-08-29  Gary Benson  <gbenson@redhat.com>\n+\n+\t* java/net/SocketPermission.java\n+\t(maybeBracketIPv6Address): New method.\n+\t(<init>): Pass the hostport argument through the above.\n+\n+\t* java/net/NetworkInterface.java (getInetAddresses):\n+\tRevert the previous change.\n+\n 2006-08-24  Gary Benson  <gbenson@redhat.com>\n \n \t* java/net/NetworkInterface.java (getInetAddresses): Bracket IPv6"}, {"sha": "47b1c67cae7812234099902229f201c502c23ce7", "filename": "libjava/classpath/java/net/NetworkInterface.java", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e/libjava%2Fclasspath%2Fjava%2Fnet%2FNetworkInterface.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e/libjava%2Fclasspath%2Fjava%2Fnet%2FNetworkInterface.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Fjava%2Fnet%2FNetworkInterface.java?ref=4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e", "patch": "@@ -112,10 +112,7 @@ public Enumeration getInetAddresses()\n \tInetAddress addr = (InetAddress) addresses.nextElement();\n \ttry\n \t  {\n-\t    String hostAddress = addr.getHostAddress();\n-\t    if (addr instanceof Inet6Address)\n-\t      hostAddress = \"[\" + hostAddress + \"]\";\n-\t    s.checkConnect(hostAddress, 58000);\n+\t    s.checkConnect(addr.getHostAddress(), 58000);\n \t    tmpInetAddresses.add(addr);\n \t  }\n \tcatch (SecurityException e)"}, {"sha": "a722fcad4e5f65666bc316b94dcf892aeea83e8d", "filename": "libjava/classpath/java/net/SocketPermission.java", "status": "modified", "additions": 46, "deletions": 2, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e/libjava%2Fclasspath%2Fjava%2Fnet%2FSocketPermission.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e/libjava%2Fclasspath%2Fjava%2Fnet%2FSocketPermission.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Fjava%2Fnet%2FSocketPermission.java?ref=4c1a4dcda1821ff40cfbb03247e6a391ebf47f3e", "patch": "@@ -164,12 +164,56 @@ public final class SocketPermission extends Permission implements Serializable\n    */\n   public SocketPermission(String hostport, String actions)\n   {\n-    super(hostport);\n+    super(maybeBracketIPv6Address(hostport));\n \n-    setHostPort(hostport);\n+    setHostPort(getName());\n     setActions(actions);\n   }\n \n+  /**\n+   * IPv6 addresses in the hostport must either be enclosed by\n+   * \"[\" and \"]\" or be specified in the full uncompressed form.\n+   * In the latter case proprietary JVMs will quote the address\n+   * with \"[\" and \"]\", so we do to.\n+   */\n+  private static String maybeBracketIPv6Address(String hostport)\n+  {\n+    if (hostport.length() == 0 || hostport.charAt(0) == '[')\n+      return hostport;\n+\n+    int colons = 0, last_colon = 0;\n+    for (int i = 0; i < hostport.length(); i++)\n+      {\n+\tif (hostport.charAt(i) == ':')\n+\t  {\n+\t    if (i - last_colon == 1)\n+\t      throw new IllegalArgumentException(\"Ambiguous hostport part\");\n+\t    colons++;\n+\t    last_colon = i;\n+\t  }\n+      }\n+\n+    switch (colons)\n+      {\n+      case 0:\n+      case 1:\n+\t// a hostname or IPv4 address\n+\treturn hostport;\n+\t\n+      case 7:\n+\t// an IPv6 address with no ports\n+\treturn \"[\" + hostport + \"]\";\n+\n+      case 8:\n+\t// an IPv6 address with ports\n+\treturn \"[\" + hostport.substring(0, last_colon) + \"]\"\n+\t  + hostport.substring(last_colon);\n+\n+      default:\n+\tthrow new IllegalArgumentException(\"Ambiguous hostport part\");\n+      }\n+  }\n+  \n   /**\n    * Parse the hostport argument to the constructor.\n    */"}]}