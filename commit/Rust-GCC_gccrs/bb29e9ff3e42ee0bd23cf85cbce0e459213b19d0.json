{"sha": "bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmIyOWU5ZmYzZTQyZWUwYmQyM2NmODVjYmNlMGU0NTkyMTNiMTlkMA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2013-08-13T17:13:47Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2013-08-13T17:13:47Z"}, "message": "trans.c (Call_to_gnu): Deal with specific conditional expressions for misaligned actual parameters.\n\n\t* gcc-interface/trans.c (Call_to_gnu): Deal with specific conditional\n\texpressions for misaligned actual parameters.\n\nFrom-SVN: r201700", "tree": {"sha": "6f864ed6b97c9671f21543ea0f182b047174097a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6f864ed6b97c9671f21543ea0f182b047174097a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/comments", "author": null, "committer": null, "parents": [{"sha": "761a8eb70ae4108515bd7d756832744350b4ff7a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/761a8eb70ae4108515bd7d756832744350b4ff7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/761a8eb70ae4108515bd7d756832744350b4ff7a"}], "stats": {"total": 51, "additions": 49, "deletions": 2}, "files": [{"sha": "5db69aaa680a5b4b7e19c9e1de3550e8c0673b4c", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "patch": "@@ -1,3 +1,8 @@\n+2013-08-13  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/trans.c (Call_to_gnu): Deal with specific conditional\n+\texpressions for misaligned actual parameters.\n+\n 2013-08-13  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/trans.c (can_equal_min_or_max_val_p): Be prepared for"}, {"sha": "5c1038ab80a590fc3faebcb6e7b9dda63fb9a97f", "filename": "gcc/ada/gcc-interface/trans.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Ftrans.c?ref=bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "patch": "@@ -4022,9 +4022,19 @@ Call_to_gnu (Node_Id gnat_node, tree *gnu_result_type_p, tree gnu_target,\n \t  /* Set up to move the copy back to the original if needed.  */\n \t  if (!in_param)\n \t    {\n-\t      gnu_stmt = build_binary_op (MODIFY_EXPR, NULL_TREE, gnu_orig,\n-\t\t\t\t\t  gnu_temp);\n+\t      /* If the original is a COND_EXPR whose first arm isn't meant to\n+\t\t be further used, just deal with the second arm.  This is very\n+\t\t likely the conditional expression built for a check.  */\n+\t      if (TREE_CODE (gnu_orig) == COND_EXPR\n+\t\t  && TREE_CODE (TREE_OPERAND (gnu_orig, 1)) == COMPOUND_EXPR\n+\t\t  && integer_zerop\n+\t\t     (TREE_OPERAND (TREE_OPERAND (gnu_orig, 1), 1)))\n+\t\tgnu_orig = TREE_OPERAND (gnu_orig, 2);\n+\n+\t      gnu_stmt\n+\t\t= build_binary_op (MODIFY_EXPR, NULL_TREE, gnu_orig, gnu_temp);\n \t      set_expr_location_from_node (gnu_stmt, gnat_node);\n+\n \t      append_to_statement_list (gnu_stmt, &gnu_after_list);\n \t    }\n \t}"}, {"sha": "d1079e6cea035066a4239100fc5b2ee71297ef9b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "patch": "@@ -1,3 +1,8 @@\n+2013-08-13  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/valued_proc.adb: New test.\n+\t* gnat.dg/valued_proc_pkg.ads: New helper.\n+\n 2013-08-13  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/57661"}, {"sha": "7030b43c45fe79026cc1e4ad7bf6535c03a23d5b", "filename": "gcc/testsuite/gnat.dg/valued_proc.adb", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Ftestsuite%2Fgnat.dg%2Fvalued_proc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Ftestsuite%2Fgnat.dg%2Fvalued_proc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fvalued_proc.adb?ref=bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "patch": "@@ -0,0 +1,12 @@\n+-- { dg-do compile }\n+-- { dg-options \"-gnatdm -gnatws\" }\n+\n+with Valued_Proc_Pkg; use Valued_Proc_Pkg;\n+with System; use System;\n+\n+procedure Valued_Proc is\n+   Status : UNSIGNED_LONGWORD;\n+   Length : POSITIVE;\n+begin\n+   GetMsg (Status, UNSIGNED_WORD(Length));\n+end;"}, {"sha": "d5197abf4d486679c8a3325ea1a896d06bb97ce2", "filename": "gcc/testsuite/gnat.dg/valued_proc_pkg.ads", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Ftestsuite%2Fgnat.dg%2Fvalued_proc_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0/gcc%2Ftestsuite%2Fgnat.dg%2Fvalued_proc_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fvalued_proc_pkg.ads?ref=bb29e9ff3e42ee0bd23cf85cbce0e459213b19d0", "patch": "@@ -0,0 +1,15 @@\n+pragma Extend_System (Aux_DEC);\n+with System; use System;\n+\n+package Valued_Proc_Pkg is\n+\n+    procedure GETMSG (STATUS : out UNSIGNED_LONGWORD;\n+                      MSGLEN : out UNSIGNED_WORD);\n+\n+    pragma Interface (EXTERNAL, GETMSG);\n+\n+    pragma IMPORT_VALUED_PROCEDURE (GETMSG, \"SYS$GETMSG\",\n+                                    (UNSIGNED_LONGWORD, UNSIGNED_WORD),\n+                                    (VALUE, REFERENCE));\n+\n+end Valued_Proc_Pkg;"}]}