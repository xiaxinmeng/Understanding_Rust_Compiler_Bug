{"sha": "7f40ac326a1f347a826636bc392a4db185b78b95", "node_id": "C_kwDOANBUbNoAKDdmNDBhYzMyNmExZjM0N2E4MjY2MzZiYzM5MmE0ZGIxODViNzhiOTU", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-12T19:46:55Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-13T19:40:05Z"}, "message": "libstdc++: Make std::thread::_State private\n\n\t* include/bits/std_thread.h (thread::_State, thread::_State_ptr):\n\tDeclare as private unless _GLIBCXX_THREAD_IMPL is defined.\n\t* src/c++11/thread.cc (_GLIBCXX_THREAD_IMPL): Define.", "tree": {"sha": "70b98c6be22de0b26c81b6dd8ab32138724dacfe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/70b98c6be22de0b26c81b6dd8ab32138724dacfe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7f40ac326a1f347a826636bc392a4db185b78b95", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f40ac326a1f347a826636bc392a4db185b78b95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f40ac326a1f347a826636bc392a4db185b78b95", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f40ac326a1f347a826636bc392a4db185b78b95/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8659bcd6b7e692a9a516cd57bb19303a2efe78ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8659bcd6b7e692a9a516cd57bb19303a2efe78ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8659bcd6b7e692a9a516cd57bb19303a2efe78ba"}], "stats": {"total": 22, "additions": 13, "deletions": 9}, "files": [{"sha": "d7fc0123564ad46cfed5daf253213d485c0af5cc", "filename": "libstdc++-v3/include/bits/std_thread.h", "status": "modified", "additions": 12, "deletions": 9, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f40ac326a1f347a826636bc392a4db185b78b95/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstd_thread.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f40ac326a1f347a826636bc392a4db185b78b95/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstd_thread.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstd_thread.h?ref=7f40ac326a1f347a826636bc392a4db185b78b95", "patch": "@@ -79,15 +79,6 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n   {\n   public:\n #ifdef _GLIBCXX_HAS_GTHREADS\n-    // Abstract base class for types that wrap arbitrary functors to be\n-    // invoked in the new thread of execution.\n-    struct _State\n-    {\n-      virtual ~_State();\n-      virtual void _M_run() = 0;\n-    };\n-    using _State_ptr = unique_ptr<_State>;\n-\n     using native_handle_type = __gthread_t;\n #else\n     using native_handle_type = int;\n@@ -216,6 +207,18 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     hardware_concurrency() noexcept;\n \n #ifdef _GLIBCXX_HAS_GTHREADS\n+#ifndef _GLIBCXX_THREAD_IMPL\n+  private:\n+#endif\n+    // Abstract base class for types that wrap arbitrary functors to be\n+    // invoked in the new thread of execution.\n+    struct _State\n+    {\n+      virtual ~_State();\n+      virtual void _M_run() = 0;\n+    };\n+    using _State_ptr = unique_ptr<_State>;\n+\n   private:\n     template<typename _Callable>\n       struct _State_impl : public _State"}, {"sha": "707a4ad415b935d27aac5b5dcbe10622d7e85932", "filename": "libstdc++-v3/src/c++11/thread.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f40ac326a1f347a826636bc392a4db185b78b95/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Fthread.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f40ac326a1f347a826636bc392a4db185b78b95/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Fthread.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Fthread.cc?ref=7f40ac326a1f347a826636bc392a4db185b78b95", "patch": "@@ -24,6 +24,7 @@\n \n \n #define _GLIBCXX_THREAD_ABI_COMPAT 1\n+#define _GLIBCXX_THREAD_IMPL 1\n #include <memory> // include this first so <thread> can use shared_ptr\n #include <thread>\n #include <system_error>"}]}