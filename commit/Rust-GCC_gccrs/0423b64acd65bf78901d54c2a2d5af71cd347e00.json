{"sha": "0423b64acd65bf78901d54c2a2d5af71cd347e00", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDQyM2I2NGFjZDY1YmY3ODkwMWQ1NGMyYTJkNWFmNzFjZDM0N2UwMA==", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2012-09-07T20:37:41Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2012-09-07T20:37:41Z"}, "message": "re PR fortran/54208 (compilation error for ubound construct in PARAMETER statements)\n\nfortran/\n\tPR fortran/54208\n\t* simplify.c (simplify_bound_dim): Resolve array spec before\n\tproceeding with simplification.\n\ntestsuite/\n\tPR fortran/54208\n\t* gfortran.dg/bound_simplification_3.f90: New test.\n\nFrom-SVN: r191083", "tree": {"sha": "6215a61a9e3f6e1cc54f488c9e8ea2d2443d31c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6215a61a9e3f6e1cc54f488c9e8ea2d2443d31c8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0423b64acd65bf78901d54c2a2d5af71cd347e00", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0423b64acd65bf78901d54c2a2d5af71cd347e00", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0423b64acd65bf78901d54c2a2d5af71cd347e00", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0423b64acd65bf78901d54c2a2d5af71cd347e00/comments", "author": null, "committer": null, "parents": [{"sha": "e4394af56897939d2f47827330f75838fe038b23", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4394af56897939d2f47827330f75838fe038b23", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4394af56897939d2f47827330f75838fe038b23"}], "stats": {"total": 37, "additions": 37, "deletions": 0}, "files": [{"sha": "f0e6cad64650c047535c2eab88b1240408fb360b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=0423b64acd65bf78901d54c2a2d5af71cd347e00", "patch": "@@ -1,3 +1,9 @@\n+2012-09-07  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\tPR fortran/54208\n+\t* simplify.c (simplify_bound_dim): Resolve array spec before\n+\tproceeding with simplification.\n+\n 2012-09-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/54463"}, {"sha": "07aeee88e157380d0ed912b003c9063775cd436f", "filename": "gcc/fortran/simplify.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ffortran%2Fsimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ffortran%2Fsimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsimplify.c?ref=0423b64acd65bf78901d54c2a2d5af71cd347e00", "patch": "@@ -3255,6 +3255,9 @@ simplify_bound_dim (gfc_expr *array, gfc_expr *kind, int d, int upper,\n   gcc_assert (array->expr_type == EXPR_VARIABLE);\n   gcc_assert (as);\n \n+  if (gfc_resolve_array_spec (as, 0) == FAILURE)\n+    return NULL;\n+\n   /* The last dimension of an assumed-size array is special.  */\n   if ((!coarray && d == as->rank && as->type == AS_ASSUMED_SIZE && !upper)\n       || (coarray && d == as->rank + as->corank"}, {"sha": "c977af8f3aa2b7ca3781172c723dbe0e8c52a2b5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0423b64acd65bf78901d54c2a2d5af71cd347e00", "patch": "@@ -1,3 +1,8 @@\n+2012-09-07  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\tPR fortran/54208\n+\t* gfortran.dg/bound_simplification_3.f90: New test.\n+\n 2012-09-07  Aldy Hernandez  <aldyh@redhat.com>\n \n \tPR testsuite/54184"}, {"sha": "de3a3dc8a94b497e803b6aed2e1cfd751eaab600", "filename": "gcc/testsuite/gfortran.dg/bound_simplification_3.f90", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ftestsuite%2Fgfortran.dg%2Fbound_simplification_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0423b64acd65bf78901d54c2a2d5af71cd347e00/gcc%2Ftestsuite%2Fgfortran.dg%2Fbound_simplification_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbound_simplification_3.f90?ref=0423b64acd65bf78901d54c2a2d5af71cd347e00", "patch": "@@ -0,0 +1,23 @@\n+! { dg-do compile }\n+! { dg-options \"-fdump-tree-original\" }\n+!\n+! PR fortran/54208\n+! The I and J definitions used to raise an error because ARR's array spec\n+! was resolved to late for the LBOUND and UBOUND calls to be simplified to\n+! a constant.\n+!\n+! Contributed by Carlos A. Cruz <carlos.a.cruz@nasa.gov>\n+\n+program testit\n+  integer, parameter :: n=2\n+  integer, dimension(1-min(n,2)/2:n) :: arr\n+  integer, parameter :: i=lbound(arr,1)\n+  integer, parameter :: j=ubound(arr,1)\n+  ! write(6,*) i, j\n+  if (i /= 0) call abort\n+  if (j /= 2) call abort\n+end program testit\n+\n+! { dg-final { scan-tree-dump-times \"bound\" 0 \"original\" } }\n+! { dg-final { scan-tree-dump-times \"abort\" 0 \"original\" } }\n+! { dg-final { cleanup-tree-dump \"original\" } }"}]}