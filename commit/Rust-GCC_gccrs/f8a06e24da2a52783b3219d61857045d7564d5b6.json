{"sha": "f8a06e24da2a52783b3219d61857045d7564d5b6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjhhMDZlMjRkYTJhNTI3ODNiMzIxOWQ2MTg1NzA0NWQ3NTY0ZDViNg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2016-06-25T17:23:02Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2016-06-25T17:23:02Z"}, "message": "re PR tree-optimization/71643 (internal compiler error: in redirect_eh_edge_1, at tree-eh.c:2318 after r237427)\n\n\tPR tree-optimization/71643\n\t* tree-ssa-tail-merge.c (find_clusters_1): Ignore basic blocks with\n\tEH preds.\n\n\t* tree-ssa-tail-merge.c (deps_ok_for_redirect_from_bb_to_bb): Don't\n\tleak a bitmap if dep_bb is NULL.\n\n\t* g++.dg/opt/pr71643.C: New test.\n\nFrom-SVN: r237783", "tree": {"sha": "d4c0505a2e27d3da1b7ef6ccd3ede3e18f45d636", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d4c0505a2e27d3da1b7ef6ccd3ede3e18f45d636"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f8a06e24da2a52783b3219d61857045d7564d5b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8a06e24da2a52783b3219d61857045d7564d5b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f8a06e24da2a52783b3219d61857045d7564d5b6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8a06e24da2a52783b3219d61857045d7564d5b6/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2a65e70bcfb000b229a2cbf54b06956108443598", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a65e70bcfb000b229a2cbf54b06956108443598", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a65e70bcfb000b229a2cbf54b06956108443598"}], "stats": {"total": 36, "additions": 33, "deletions": 3}, "files": [{"sha": "a3a0b64781b04b77c2a3d5a5b167923137a11a43", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f8a06e24da2a52783b3219d61857045d7564d5b6", "patch": "@@ -1,5 +1,12 @@\n 2016-06-25  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR tree-optimization/71643\n+\t* tree-ssa-tail-merge.c (find_clusters_1): Ignore basic blocks with\n+\tEH preds.\n+\n+\t* tree-ssa-tail-merge.c (deps_ok_for_redirect_from_bb_to_bb): Don't\n+\tleak a bitmap if dep_bb is NULL.\n+\n \tPR tree-optimization/71631\n \t* tree-ssa-reassoc.c (reassociate_bb): Pass true as last argument\n \tto rewrite_expr_tree even if negate_result, move new_lhs var"}, {"sha": "ca690a40c0dcec67b5e077aa7418faa068dbd33a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f8a06e24da2a52783b3219d61857045d7564d5b6", "patch": "@@ -1,5 +1,8 @@\n 2016-06-25  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR tree-optimization/71643\n+\t* g++.dg/opt/pr71643.C: New test.\n+\n \tPR tree-optimization/71631\n \t* gcc.c-torture/execute/pr71631.c: New test.\n "}, {"sha": "8369c6862ab9dcba652d169ba874ad568fc63c6c", "filename": "gcc/testsuite/g++.dg/opt/pr71643.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr71643.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr71643.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr71643.C?ref=f8a06e24da2a52783b3219d61857045d7564d5b6", "patch": "@@ -0,0 +1,20 @@\n+// PR tree-optimization/71643\n+// { dg-do compile }\n+// { dg-options \"-O2\" }\n+\n+struct A\n+{\n+  void *operator new (__SIZE_TYPE__, double);\n+  void operator delete (void *, double) { __builtin_unreachable (); }\n+  A (int x);\n+  static A *bar (int x) { return new (3.0) A (x); }\n+};\n+void baz (A *, A *);\n+\n+void\n+foo (int a, int b)\n+{\n+  A *p = A::bar (a);\n+  A *q = A::bar (b);\n+  baz (p, q);\n+}"}, {"sha": "5e815ec582abeadfbc51e576f0c6545799a8000c", "filename": "gcc/tree-ssa-tail-merge.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2Ftree-ssa-tail-merge.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f8a06e24da2a52783b3219d61857045d7564d5b6/gcc%2Ftree-ssa-tail-merge.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-tail-merge.c?ref=f8a06e24da2a52783b3219d61857045d7564d5b6", "patch": "@@ -1398,11 +1398,11 @@ deps_ok_for_redirect_from_bb_to_bb (basic_block from, basic_block to)\n   basic_block cd, dep_bb = BB_DEP_BB (to);\n   edge_iterator ei;\n   edge e;\n-  bitmap from_preds = BITMAP_ALLOC (NULL);\n \n   if (dep_bb == NULL)\n     return true;\n \n+  bitmap from_preds = BITMAP_ALLOC (NULL);\n   FOR_EACH_EDGE (e, ei, from->preds)\n     bitmap_set_bit (from_preds, e->src->index);\n   cd = nearest_common_dominator_for_set (CDI_DOMINATORS, from_preds);\n@@ -1446,15 +1446,15 @@ find_clusters_1 (same_succ *same_succ)\n       /* TODO: handle blocks with phi-nodes.  We'll have to find corresponding\n \t phi-nodes in bb1 and bb2, with the same alternatives for the same\n \t preds.  */\n-      if (bb_has_non_vop_phi (bb1))\n+      if (bb_has_non_vop_phi (bb1) || bb_has_eh_pred (bb1))\n \tcontinue;\n \n       nr_comparisons = 0;\n       EXECUTE_IF_SET_IN_BITMAP (same_succ->bbs, i + 1, j, bj)\n \t{\n \t  bb2 = BASIC_BLOCK_FOR_FN (cfun, j);\n \n-\t  if (bb_has_non_vop_phi (bb2))\n+\t  if (bb_has_non_vop_phi (bb2) || bb_has_eh_pred (bb2))\n \t    continue;\n \n \t  if (BB_CLUSTER (bb1) != NULL && BB_CLUSTER (bb1) == BB_CLUSTER (bb2))"}]}