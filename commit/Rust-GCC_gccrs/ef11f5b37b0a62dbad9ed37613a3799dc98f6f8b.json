{"sha": "ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWYxMWY1YjM3YjBhNjJkYmFkOWVkMzc2MTNhMzc5OWRjOThmNmY4Yg==", "commit": {"author": {"name": "Christophe Lyon", "email": "christophe.lyon@linaro.org", "date": "2020-09-07T14:53:38Z"}, "committer": {"name": "Christophe Lyon", "email": "christophe.lyon@linaro.org", "date": "2020-09-30T14:55:45Z"}, "message": "arm: [testsuite] Skip thumb2-cond-cmp tests on Cortex-M [PR94595]\n\nSince r204778 (g571880a0a4c512195aa7d41929ba6795190887b2), we favor\nbranches over IT blocks on Cortex-M. As a result, instead of\ngenerating two nested IT blocks in thumb2-cond-cmp-[1234].c, we\ngenerate either a single IT block, or use branches depending on\nconditions tested by the program.\n\nSince this was a deliberate change and the tests still pass as\nexpected on Cortex-A, this patch skips them when targetting\nCortex-M. The avoids the failures on Cortex M3, M4, and M33.  This\npatch makes the testcases unsupported on Cortex-M7 although they pass\nin this case because this CPU has different branch costs.\n\nI tried to relax the scan-assembler directives using eg. cmpne|subne\nor cmpgt|ble but that seemed fragile.\n\n2020-09-07  Christophe Lyon  <christophe.lyon@linaro.org>\n\n\tgcc/testsuite/\n\tPR target/94595\n\t* gcc.target/arm/thumb2-cond-cmp-1.c: Skip if arm_cortex_m.\n\t* gcc.target/arm/thumb2-cond-cmp-2.c: Skip if arm_cortex_m.\n\t* gcc.target/arm/thumb2-cond-cmp-3.c: Skip if arm_cortex_m.\n\t* gcc.target/arm/thumb2-cond-cmp-4.c: Skip if arm_cortex_m.", "tree": {"sha": "cd6f702d697954354ea3ea10a418f89795b6ebd1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cd6f702d697954354ea3ea10a418f89795b6ebd1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/comments", "author": null, "committer": null, "parents": [{"sha": "9ff2bcd9df8f189dcc94e3bef33f7f282dcaa780", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ff2bcd9df8f189dcc94e3bef33f7f282dcaa780", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ff2bcd9df8f189dcc94e3bef33f7f282dcaa780"}], "stats": {"total": 8, "additions": 4, "deletions": 4}, "files": [{"sha": "36204f4bf513182db26f2cedc142752a59ffb812", "filename": "gcc/testsuite/gcc.target/arm/thumb2-cond-cmp-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-1.c?ref=ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "patch": "@@ -1,6 +1,6 @@\n /* Use conditional compare */\n /* { dg-options \"-O2\" } */\n-/* { dg-skip-if \"\" { arm_thumb1_ok } } */\n+/* { dg-skip-if \"\" { arm_thumb1_ok || arm_cortex_m } } */\n /* { dg-final { scan-assembler \"cmpne\" } } */\n \n int f(int i, int j) "}, {"sha": "108d1c3ed699e6c034594ebb3a8b83c00b5a34dd", "filename": "gcc/testsuite/gcc.target/arm/thumb2-cond-cmp-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-2.c?ref=ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "patch": "@@ -1,6 +1,6 @@\n /* Use conditional compare */                                                                                         \n /* { dg-options \"-O2\" } */\n-/* { dg-skip-if \"\" { arm_thumb1_ok } } */\n+/* { dg-skip-if \"\" { arm_thumb1_ok || arm_cortex_m } } */\n /* { dg-final { scan-assembler \"cmpeq\" } } */\n \n int f(int i, int j) "}, {"sha": "ca7fd9f928f5dd33a3d756c18999db43cf0fc564", "filename": "gcc/testsuite/gcc.target/arm/thumb2-cond-cmp-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-3.c?ref=ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "patch": "@@ -1,6 +1,6 @@\n /* Use conditional compare */                                                                                         \n /* { dg-options \"-O2\" } */\n-/* { dg-skip-if \"\" { arm_thumb1_ok } } */\n+/* { dg-skip-if \"\" { arm_thumb1_ok || arm_cortex_m } } */\n /* { dg-final { scan-assembler \"cmpgt\" } } */\n \n int f(int i, int j)"}, {"sha": "91cc8f408effc1dca78a753c2088ebe017c66539", "filename": "gcc/testsuite/gcc.target/arm/thumb2-cond-cmp-4.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb2-cond-cmp-4.c?ref=ef11f5b37b0a62dbad9ed37613a3799dc98f6f8b", "patch": "@@ -1,6 +1,6 @@\n /* Use conditional compare */                                                                                         \n /* { dg-options \"-O2\" } */\n-/* { dg-skip-if \"\" { arm_thumb1_ok } } */\n+/* { dg-skip-if \"\" { arm_thumb1_ok || arm_cortex_m } } */\n /* { dg-final { scan-assembler \"cmpgt\" } } */\n \n int f(int i, int j)"}]}