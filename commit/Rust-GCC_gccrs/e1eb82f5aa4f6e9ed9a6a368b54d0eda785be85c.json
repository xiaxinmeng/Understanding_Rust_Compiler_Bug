{"sha": "e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTFlYjgyZjVhYTRmNmU5ZWQ5YTZhMzY4YjU0ZDBlZGE3ODViZTg1Yw==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2019-07-23T09:38:49Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2019-07-23T09:38:49Z"}, "message": "i386-common.c: Use PROCESSOR_ZNVER2 scheduler for znver2.\n\n\t* i386-common.c: Use PROCESSOR_ZNVER2 scheduler for znver2.\n\t* config/i386/znver1.md: Enable patterns for znver2 and add store\n\tvariants which use extra AGU unit.\n\nFrom-SVN: r273731", "tree": {"sha": "f6abf4008a2c2041dd1273951cee8a2e8ce4435f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f6abf4008a2c2041dd1273951cee8a2e8ce4435f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c/comments", "author": null, "committer": null, "parents": [{"sha": "105c2795b0d63b2cc5cb224ba066fa8b9a0ad0ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/105c2795b0d63b2cc5cb224ba066fa8b9a0ad0ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/105c2795b0d63b2cc5cb224ba066fa8b9a0ad0ff"}], "stats": {"total": 587, "additions": 411, "deletions": 176}, "files": [{"sha": "fb9b0ff8db262e4d2d0b42c7142f87eac6064c86", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c", "patch": "@@ -1,3 +1,9 @@\n+2019-07-23  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* i386-common.c: Use PROCESSOR_ZNVER2 scheduler for znver2.\n+\t* config/i386/znver1.md: Enable patterns for znver2 and add store\n+\tvariants which use extra AGU unit.\n+\n 2019-07-23  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* config/i386/i386-options.c (ix86_option_override_internal): Default"}, {"sha": "1f77f7d14be197c35b13d55bd56edbe4363c613e", "filename": "gcc/common/config/i386/i386-common.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c/gcc%2Fcommon%2Fconfig%2Fi386%2Fi386-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c/gcc%2Fcommon%2Fconfig%2Fi386%2Fi386-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Fi386%2Fi386-common.c?ref=e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c", "patch": "@@ -1760,7 +1760,7 @@ const pta processor_alias_table[] =\n       | PTA_RDRND | PTA_MOVBE | PTA_MWAITX | PTA_ADX | PTA_RDSEED\n       | PTA_CLZERO | PTA_CLFLUSHOPT | PTA_XSAVEC | PTA_XSAVES\n       | PTA_SHA | PTA_LZCNT | PTA_POPCNT},\n-  {\"znver2\", PROCESSOR_ZNVER2, CPU_ZNVER1,\n+  {\"znver2\", PROCESSOR_ZNVER2, CPU_ZNVER2,\n     PTA_64BIT | PTA_MMX | PTA_SSE | PTA_SSE2 | PTA_SSE3\n       | PTA_SSE4A | PTA_CX16 | PTA_ABM | PTA_SSSE3 | PTA_SSE4_1\n       | PTA_SSE4_2 | PTA_AES | PTA_PCLMUL | PTA_AVX | PTA_AVX2"}, {"sha": "7e3efa8d831305b5be489f3f4cbf1e2c2401495c", "filename": "gcc/config/i386/znver1.md", "status": "modified", "additions": 404, "deletions": 175, "changes": 579, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c/gcc%2Fconfig%2Fi386%2Fznver1.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c/gcc%2Fconfig%2Fi386%2Fznver1.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fznver1.md?ref=e1eb82f5aa4f6e9ed9a6a368b54d0eda785be85c", "patch": "@@ -17,10 +17,11 @@\n ;; <http://www.gnu.org/licenses/>.\n ;;\n \n+\n (define_attr \"znver1_decode\" \"direct,vector,double\"\n   (const_string \"direct\"))\n \n-;; AMD znver1 Scheduling\n+;; AMD znver1 and znver2 Scheduling\n ;; Modeling automatons for zen decoders, integer execution pipes,\n ;; AGU pipes and floating point execution units.\n (define_automaton \"znver1, znver1_ieu, znver1_fp, znver1_agu\")\n@@ -51,20 +52,31 @@\n (define_cpu_unit \"znver1-ieu3\" \"znver1_ieu\")\n (define_reservation \"znver1-ieu\" \"znver1-ieu0|znver1-ieu1|znver1-ieu2|znver1-ieu3\")\n \n-;; 2 AGU pipes.\n+;; 2 AGU pipes in znver1 and 3 AGU pipes in znver2\n+;; According to CPU diagram last AGU unit is used only for stores.\n (define_cpu_unit \"znver1-agu0\" \"znver1_agu\")\n (define_cpu_unit \"znver1-agu1\" \"znver1_agu\")\n+(define_cpu_unit \"znver2-agu2\" \"znver1_agu\")\n (define_reservation \"znver1-agu-reserve\" \"znver1-agu0|znver1-agu1\")\n+(define_reservation \"znver2-store-agu-reserve\" \"znver1-agu0|znver1-agu1|znver2-agu2\")\n \n+;; Load is 4 cycles. We do not model reservation of load unit.\n+;;(define_reservation \"znver1-load\" \"znver1-agu-reserve, nothing, nothing, nothing\")\n (define_reservation \"znver1-load\" \"znver1-agu-reserve\")\n+;; Store operations differs between znver1 and znver2 because extra AGU\n+;; was added.\n (define_reservation \"znver1-store\" \"znver1-agu-reserve\")\n+(define_reservation \"znver2-store\" \"znver2-store-agu-reserve\")\n \n ;; vectorpath (microcoded) instructions are single issue instructions.\n ;; So, they occupy all the integer units.\n (define_reservation \"znver1-ivector\" \"znver1-ieu0+znver1-ieu1\n \t\t\t\t      +znver1-ieu2+znver1-ieu3\n \t\t\t\t      +znver1-agu0+znver1-agu1\")\n \n+(define_reservation \"znver2-ivector\" \"znver1-ieu0+znver1-ieu1\n+\t\t\t\t      +znver1-ieu2+znver1-ieu3\n+\t\t\t\t      +znver1-agu0+znver1-agu1+znver2-agu2\")\n ;; Floating point unit 4 FP pipes.\n (define_cpu_unit \"znver1-fp0\" \"znver1_fp\")\n (define_cpu_unit \"znver1-fp1\" \"znver1_fp\")\n@@ -76,34 +88,46 @@\n (define_reservation \"znver1-fvector\" \"znver1-fp0+znver1-fp1\n \t\t\t\t      +znver1-fp2+znver1-fp3\n \t\t\t\t      +znver1-agu0+znver1-agu1\")\n+(define_reservation \"znver2-fvector\" \"znver1-fp0+znver1-fp1\n+\t\t\t\t      +znver1-fp2+znver1-fp3\n+\t\t\t\t      +znver1-agu0+znver1-agu1+znver2-agu2\")\n \n ;; Call instruction\n (define_insn_reservation \"znver1_call\" 1\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (eq_attr \"type\" \"call,callv\"))\n \t\t\t \"znver1-double,znver1-store,znver1-ieu0|znver1-ieu3\")\n \n+(define_insn_reservation \"znver2_call\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (eq_attr \"type\" \"call,callv\"))\n+\t\t\t \"znver1-double,znver2-store,znver1-ieu0|znver1-ieu3\")\n+\n ;; General instructions\n (define_insn_reservation \"znver1_push\" 1\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"type\" \"push\")\n-\t\t\t\t   (eq_attr \"memory\" \"none,unknown\")))\n+\t\t\t\t   (eq_attr \"memory\" \"store\")))\n \t\t\t \"znver1-direct,znver1-store\")\n-\n-(define_insn_reservation \"znver1_push_store\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+(define_insn_reservation \"znver2_push\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n \t\t\t      (and (eq_attr \"type\" \"push\")\n \t\t\t\t   (eq_attr \"memory\" \"store\")))\n \t\t\t \"znver1-direct,znver1-store\")\n \n-(define_insn_reservation \"znver1_push_both\" 5\n+(define_insn_reservation \"znver1_push_load\" 4\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"type\" \"push\")\n \t\t\t\t   (eq_attr \"memory\" \"both\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-store\")\n+(define_insn_reservation \"znver2_push_load\" 4\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"push\")\n+\t\t\t\t   (eq_attr \"memory\" \"both\")))\n+\t\t\t \"znver1-direct,znver1-load,znver2-store\")\n \n (define_insn_reservation \"znver1_pop\" 4\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"pop\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load\")\n@@ -113,82 +137,91 @@\n \t\t\t      (and (eq_attr \"type\" \"pop\")\n \t\t\t\t   (eq_attr \"memory\" \"both\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-store\")\n+(define_insn_reservation \"znver2_pop_mem\" 4\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"pop\")\n+\t\t\t\t   (eq_attr \"memory\" \"both\")))\n+\t\t\t \"znver1-direct,znver1-load,znver2-store\")\n \n ;; Leave\n (define_insn_reservation \"znver1_leave\" 1\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (eq_attr \"type\" \"leave\"))\n \t\t\t \"znver1-double,znver1-ieu, znver1-store\")\n+(define_insn_reservation \"znver2_leave\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (eq_attr \"type\" \"leave\"))\n+\t\t\t \"znver1-double,znver1-ieu, znver2-store\")\n \n ;; Integer Instructions or General instructions\n ;; Multiplications\n ;; Reg operands\n (define_insn_reservation \"znver1_imul\" 3\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"imul\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-ieu1\")\n \n (define_insn_reservation \"znver1_imul_mem\" 7\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"imul\")\n \t\t\t\t   (eq_attr \"memory\" \"!none\")))\n \t\t\t \"znver1-direct,znver1-load, znver1-ieu1\")\n \n ;; Divisions\n ;; Reg operands\n (define_insn_reservation \"znver1_idiv_DI\" 41\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"DI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,znver1-ieu2*41\")\n \n (define_insn_reservation \"znver1_idiv_SI\" 25\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"SI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,znver1-ieu2*25\")\n \n (define_insn_reservation \"znver1_idiv_HI\" 17\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"HI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,znver1-ieu2*17\")\n \n (define_insn_reservation \"znver1_idiv_QI\" 12\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"QI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-direct,znver1-ieu2*12\")\n \n ;; Mem operands\n (define_insn_reservation \"znver1_idiv_mem_DI\" 45\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"DI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,znver1-load,znver1-ieu2*41\")\n \n (define_insn_reservation \"znver1_idiv_mem_SI\" 29\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"SI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,znver1-load,znver1-ieu2*25\")\n \n (define_insn_reservation \"znver1_idiv_mem_HI\" 21\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"HI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,znver1-load,znver1-ieu2*17\")\n \n (define_insn_reservation \"znver1_idiv_mem_QI\" 16\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"idiv\")\n \t\t\t\t   (and (eq_attr \"mode\" \"QI\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n@@ -201,16 +234,34 @@\n \t\t\t      (and (eq_attr \"type\" \"str,ishift\")\n \t\t\t\t   (eq_attr \"memory\" \"both,store\")))\n \t\t\t \"znver1-vector,znver1-ivector\")\n+\n+(define_insn_reservation \"znver2_str_ishift\" 3\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"ishift\")\n+\t\t\t\t   (eq_attr \"memory\" \"both,store\")))\n+\t\t\t \"znver1-vector,znver1-ivector\")\n+(define_insn_reservation \"znver2_str_istr\" 19\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"str\")\n+\t\t\t\t   (eq_attr \"memory\" \"both,store\")))\n+\t\t\t \"znver1-vector,znver1-ivector\")\n ;; MOV - integer moves\n (define_insn_reservation \"znver1_load_imov_double\" 2\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n \t\t\t\t   (and (eq_attr \"type\" \"imovx\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n-\t\t\t \"znver1-double,znver1-ieu\")\n+\t\t\t \"znver1-double,znver1-ieu|znver1-ieu\")\n+\n+(define_insn_reservation \"znver2_load_imov_double\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n+\t\t\t\t   (and (eq_attr \"type\" \"imovx\")\n+\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t \"znver1-double,znver1-ieu|znver1-ieu\")\n \n (define_insn_reservation \"znver1_load_imov_direct\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"imov,imovx\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-ieu\")\n@@ -220,37 +271,57 @@\n \t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n \t\t\t\t   (and (eq_attr \"type\" \"imovx\")\n \t\t\t\t\t(eq_attr \"memory\" \"store\"))))\n-\t\t\t \"znver1-double,znver1-ieu,znver1-store\")\n+\t\t\t \"znver1-double,znver1-ieu|znver1-ieu,znver1-store\")\n+\n+(define_insn_reservation \"znver2_load_imov_double_store\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n+\t\t\t\t   (and (eq_attr \"type\" \"imovx\")\n+\t\t\t\t\t(eq_attr \"memory\" \"store\"))))\n+\t\t\t \"znver1-double,znver1-ieu|znver1-ieu,znver2-store\")\n \n (define_insn_reservation \"znver1_load_imov_direct_store\" 1\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"type\" \"imov,imovx\")\n \t\t\t\t   (eq_attr \"memory\" \"store\")))\n \t\t\t\t   \"znver1-direct,znver1-ieu,znver1-store\")\n \n+(define_insn_reservation \"znver2_load_imov_direct_store\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"imov,imovx\")\n+\t\t\t\t   (eq_attr \"memory\" \"store\")))\n+\t\t\t\t   \"znver1-direct,znver1-ieu,znver2-store\")\n+\n (define_insn_reservation \"znver1_load_imov_double_load\" 5\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n \t\t\t\t   (and (eq_attr \"type\" \"imovx\")\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n-\t\t\t \"znver1-double,znver1-load\")\n+\t\t\t \"znver1-double,znver1-load,znver1-ieu|znver1-ieu\")\n+\n+(define_insn_reservation \"znver2_load_imov_double_load\" 4\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n+\t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n+\t\t\t\t   (and (eq_attr \"type\" \"imovx\")\n+\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t \"znver1-double,znver1-load,znver1-ieu|znver1-ieu\")\n \n (define_insn_reservation \"znver1_load_imov_direct_load\" 4\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"imov,imovx\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load\")\n \n ;; INTEGER/GENERAL instructions\n ;; register/imm operands only: ALU, ICMP, NEG, NOT, ROTATE, ISHIFT, TEST\n (define_insn_reservation \"znver1_insn\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"alu,icmp,negnot,rotate,rotate1,ishift,ishift1,test,setcc,incdec,icmov\")\n \t\t\t\t   (eq_attr \"memory\" \"none,unknown\")))\n \t\t\t \"znver1-direct,znver1-ieu\")\n \n (define_insn_reservation \"znver1_insn_load\" 5\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"alu,icmp,negnot,rotate,rotate1,ishift,ishift1,test,setcc,incdec,icmov\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-ieu\")\n@@ -261,18 +332,35 @@\n \t\t\t\t   (eq_attr \"memory\" \"store\")))\n \t\t\t \"znver1-direct,znver1-ieu,znver1-store\")\n \n+(define_insn_reservation \"znver2_insn_store\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"alu,icmp,negnot,rotate,rotate1,ishift1,test,setcc,incdec\")\n+\t\t\t\t   (eq_attr \"memory\" \"store\")))\n+\t\t\t \"znver1-direct,znver1-ieu,znver2-store\")\n+\n (define_insn_reservation \"znver1_insn_both\" 5\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"type\" \"alu,icmp,negnot,rotate,rotate1,ishift1,test,setcc,incdec\")\n \t\t\t\t   (eq_attr \"memory\" \"both\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-ieu,znver1-store\")\n \n+(define_insn_reservation \"znver2_insn_both\" 5\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"alu,icmp,negnot,rotate,rotate1,ishift1,test,setcc,incdec\")\n+\t\t\t\t   (eq_attr \"memory\" \"both\")))\n+\t\t\t \"znver1-direct,znver1-load,znver1-ieu,znver2-store\")\n+\n ;; Fix me: Other vector type insns keeping latency 6 as of now.\n (define_insn_reservation \"znver1_ieu_vector\" 6\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (eq_attr \"type\" \"other,str,multi\"))\n \t\t\t \"znver1-vector,znver1-ivector\")\n \n+(define_insn_reservation \"znver2_ieu_vector\" 5\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (eq_attr \"type\" \"other,str,multi\"))\n+\t\t\t \"znver1-vector,znver2-ivector\")\n+\n ;; ALU1 register operands.\n (define_insn_reservation \"znver1_alu1_vector\" 3\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n@@ -281,23 +369,30 @@\n \t\t\t\t\t(eq_attr \"memory\" \"none,unknown\"))))\n \t\t\t \"znver1-vector,znver1-ivector\")\n \n+(define_insn_reservation \"znver2_alu1_vector\" 3\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"znver1_decode\" \"vector\")\n+\t\t\t\t   (and (eq_attr \"type\" \"alu1\")\n+\t\t\t\t\t(eq_attr \"memory\" \"none,unknown\"))))\n+\t\t\t \"znver1-vector,znver2-ivector\")\n+\n (define_insn_reservation \"znver1_alu1_double\" 2\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n \t\t\t\t   (and (eq_attr \"type\" \"alu1\")\n \t\t\t\t\t(eq_attr \"memory\" \"none,unknown\"))))\n \t\t\t \"znver1-double,znver1-ieu\")\n \n (define_insn_reservation \"znver1_alu1_direct\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"znver1_decode\" \"direct\")\n \t\t\t\t   (and (eq_attr \"type\" \"alu1\")\n \t\t\t\t\t(eq_attr \"memory\" \"none,unknown\"))))\n \t\t\t \"znver1-direct,znver1-ieu\")\n \n ;; Branches : Fix me need to model conditional branches.\n (define_insn_reservation \"znver1_branch\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"ibr\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t  \"znver1-direct\")\n@@ -309,27 +404,33 @@\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-vector,znver1-ivector\")\n \n+(define_insn_reservation \"znver2_indirect_branch_mem\" 6\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"ibr\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n+\t\t\t \"znver1-vector,znver2-ivector\")\n+\n ;; LEA executes in ALU units with 1 cycle latency.\n (define_insn_reservation \"znver1_lea\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (eq_attr \"type\" \"lea\"))\n \t\t\t \"znver1-direct,znver1-ieu\")\n \n ;; Other integer instrucions\n (define_insn_reservation \"znver1_idirect\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"unit\" \"integer,unknown\")\n \t\t\t\t   (eq_attr \"memory\" \"none,unknown\")))\n \t\t\t \"znver1-direct,znver1-ieu\")\n \n ;;  Floating point\n (define_insn_reservation \"znver1_fp_cmov\" 6\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (eq_attr \"type\" \"fcmov\"))\n \t\t\t \"znver1-vector,znver1-fvector\")\n \n (define_insn_reservation \"znver1_fp_mov_direct_load\" 8 \n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"znver1_decode\" \"direct\")\n \t\t\t\t   (and (eq_attr \"type\" \"fmov\")\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n@@ -341,9 +442,15 @@\n \t\t\t\t   (and (eq_attr \"type\" \"fmov\")\n \t\t\t\t\t(eq_attr \"memory\" \"store\"))))\n \t\t\t \"znver1-direct,znver1-fp2|znver1-fp3,znver1-store\")\n+(define_insn_reservation \"znver2_fp_mov_direct_store\" 5\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"znver1_decode\" \"direct\")\n+\t\t\t\t   (and (eq_attr \"type\" \"fmov\")\n+\t\t\t\t\t(eq_attr \"memory\" \"store\"))))\n+\t\t\t \"znver1-direct,znver1-fp2|znver1-fp3,znver2-store\")\n \n (define_insn_reservation \"znver1_fp_mov_double\" 4\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n \t\t\t\t   (and (eq_attr \"type\" \"fmov\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n@@ -356,13 +463,21 @@\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t \"znver1-double,znver1-load,znver1-fp3\")\n \n+(define_insn_reservation \"znver2_fp_mov_double_load\" 12\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"znver1_decode\" \"double\")\n+\t\t\t\t   (and (eq_attr \"type\" \"fmov\")\n+\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t \"znver1-double,znver1-load,znver1-fp3\")\n+\n (define_insn_reservation \"znver1_fp_mov_direct\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (eq_attr \"type\" \"fmov\"))\n \t\t\t \"znver1-direct,znver1-fp3\")\n \n+;; TODO: AGU?\n (define_insn_reservation \"znver1_fp_spc_direct\" 5\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"fpspc\")\n \t\t\t\t   (eq_attr \"memory\" \"store\")))\n \t\t\t \"znver1-direct,znver1-fp3,znver1-fp2\")\n@@ -372,55 +487,60 @@\n \t\t\t      (and (eq_attr \"znver1_decode\" \"vector\")\n \t\t\t\t   (eq_attr \"type\" \"fpspc,mmxcvt,sselog1,ssemul,ssemov\")))\n \t\t\t \"znver1-vector,znver1-fvector\")\n+(define_insn_reservation \"znver2_fp_insn_vector\" 6\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"znver1_decode\" \"vector\")\n+\t\t\t\t   (eq_attr \"type\" \"fpspc,mmxcvt,sselog1,ssemul,ssemov\")))\n+\t\t\t \"znver1-vector,znver2-fvector\")\n \n ;; FABS\n (define_insn_reservation \"znver1_fp_fsgn\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (eq_attr \"type\" \"fsgn\"))\n \t\t\t \"znver1-direct,znver1-fp3\")\n \n (define_insn_reservation \"znver1_fp_fcmp\" 2\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"memory\" \"none\")\n \t\t\t\t   (and (eq_attr \"znver1_decode\" \"double\")\n \t\t\t\t\t(eq_attr \"type\" \"fcmp\"))))\n \t\t\t \"znver1-double,znver1-fp0,znver1-fp2\")\n \n (define_insn_reservation \"znver1_fp_fcmp_load\" 9\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"memory\" \"none\")\n \t\t\t\t   (and (eq_attr \"znver1_decode\" \"double\")\n \t\t\t\t\t(eq_attr \"type\" \"fcmp\"))))\n \t\t\t \"znver1-double,znver1-load, znver1-fp0,znver1-fp2\")\n \n ;;FADD FSUB FMUL\n (define_insn_reservation \"znver1_fp_op_mul\" 5\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"fop,fmul\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0*5\")\n \n (define_insn_reservation \"znver1_fp_op_mul_load\" 12 \n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"fop,fmul\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0*5\")\n \n (define_insn_reservation \"znver1_fp_op_imul_load\" 16\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"fop,fmul\")\n \t\t\t\t   (and (eq_attr \"fp_int_src\" \"true\")\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t\"znver1-double,znver1-load,znver1-fp3,znver1-fp0\")\n \n (define_insn_reservation \"znver1_fp_op_div\" 15\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"fdiv\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp3*15\")\n \n (define_insn_reservation \"znver1_fp_op_div_load\" 22\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"fdiv\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp3*15\")\n@@ -432,56 +552,63 @@\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t \"znver1-double,znver1-load,znver1-fp3*19\")\n \n+(define_insn_reservation \"znver2_fp_op_idiv_load\" 26\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"fdiv\")\n+\t\t\t\t   (and (eq_attr \"fp_int_src\" \"true\")\n+\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t \"znver1-double,znver1-load,znver1-fp3*19\")\n+\n ;; MMX, SSE, SSEn.n, AVX, AVX2 instructions\n (define_insn_reservation \"znver1_fp_insn\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (eq_attr \"type\" \"mmx\"))\n \t\t\t \"znver1-direct,znver1-fpu\")\n \n (define_insn_reservation \"znver1_mmx_add\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxadd\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0|znver1-fp1|znver1-fp3\")\n \n (define_insn_reservation \"znver1_mmx_add_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxadd\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0|znver1-fp1|znver1-fp3\")\n \n (define_insn_reservation \"znver1_mmx_cmp\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxcmp\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0|znver1-fp3\")\n \n (define_insn_reservation \"znver1_mmx_cmp_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxcmp\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0|znver1-fp3\")\n \n (define_insn_reservation \"znver1_mmx_cvt_pck_shuf\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxcvt,sseshuf,sseshuf1\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp1|znver1-fp2\")\n \n (define_insn_reservation \"znver1_mmx_cvt_pck_shuf_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxcvt,sseshuf,sseshuf1\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp1|znver1-fp2\")\n \n (define_insn_reservation \"znver1_mmx_shift_move\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxshft,mmxmov\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n  \t\t\t \"znver1-direct,znver1-fp2\")\n \n (define_insn_reservation \"znver1_mmx_shift_move_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxshft,mmxmov\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp2\")\n@@ -491,19 +618,25 @@\n \t\t\t      (and (eq_attr \"type\" \"mmxshft,mmxmov\")\n \t\t\t\t   (eq_attr \"memory\" \"store,both\")))\n \t\t\t  \"znver1-direct,znver1-fp2,znver1-store\")\n+(define_insn_reservation \"znver2_mmx_move_store\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t      (and (eq_attr \"type\" \"mmxshft,mmxmov\")\n+\t\t\t\t   (eq_attr \"memory\" \"store,both\")))\n+\t\t\t  \"znver1-direct,znver1-fp2,znver2-store\")\n \n (define_insn_reservation \"znver1_mmx_mul\" 3\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxmul\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t  \"znver1-direct,znver1-fp0*3\")\n \n (define_insn_reservation \"znver1_mmx_load\" 10\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"mmxmul\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0*3\")\n \n+;; TODO\n (define_insn_reservation \"znver1_avx256_log\" 1\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"mode\" \"V8SF,V4DF,OI\")\n@@ -519,13 +652,13 @@\n \t\t\t \"znver1-double,znver1-load,znver1-fpu\")\n \n (define_insn_reservation \"znver1_sse_log\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"sselog\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fpu\")\n \n (define_insn_reservation \"znver1_sse_log_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"sselog\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fpu\")\n@@ -545,13 +678,13 @@\n \t\t\t \"znver1-double,znver1-load,znver1-fp1|znver1-fp2\")\n \n (define_insn_reservation \"znver1_sse_log1\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"sselog1\")\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp1|znver1-fp2\")\n \n (define_insn_reservation \"znver1_sse_log1_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"type\" \"sselog1\")\n \t\t\t\t   (eq_attr \"memory\" \"!none\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp1|znver1-fp2\")\n@@ -566,46 +699,50 @@\n \t\t\t \"znver1-direct,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sse_comi_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\")\n-\t\t\t\t   (and (eq_attr \"prefix\" \"!vex\")\n-\t\t\t\t\t(and (eq_attr \"prefix_extra\" \"0\")\n-\t\t\t\t\t     (and (eq_attr \"type\" \"ssecomi\")\n-\t\t\t\t\t\t  (eq_attr \"memory\" \"load\"))))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"prefix_extra\" \"0\")\n+\t\t\t\t   (and (eq_attr \"type\" \"ssecomi\")\n+\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sse_comi_double\" 2\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"prefix\" \"vex\")\n-\t\t\t\t\t(and (eq_attr \"prefix_extra\" \"0\")\n-\t\t\t\t\t     (and (eq_attr \"type\" \"ssecomi\")\n-\t\t\t\t\t\t  (eq_attr \"memory\" \"none\"))))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"prefix\" \"vex\")\n+\t\t\t\t   (and (eq_attr \"prefix_extra\" \"0\")\n+\t\t\t\t\t(and (eq_attr \"type\" \"ssecomi\")\n+\t\t\t\t\t     (eq_attr \"memory\" \"none\")))))\n \t\t\t \"znver1-double,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sse_comi_double_load\" 10\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"prefix\" \"vex\")\n-\t\t\t\t\t(and (eq_attr \"prefix_extra\" \"0\")\n-\t\t\t\t\t     (and (eq_attr \"type\" \"ssecomi\")\n-\t\t\t\t\t\t  (eq_attr \"memory\" \"load\"))))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"prefix\" \"vex\")\n+\t\t\t\t   (and (eq_attr \"prefix_extra\" \"0\")\n+\t\t\t\t\t(and (eq_attr \"type\" \"ssecomi\")\n+\t\t\t\t\t     (eq_attr \"memory\" \"load\")))))\n \t\t\t \"znver1-double,znver1-load,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sse_test\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"prefix_extra\" \"1\")\n-\t\t\t\t\t(and (eq_attr \"type\" \"ssecomi\")\n-\t\t\t\t\t     (eq_attr \"memory\" \"none\")))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"prefix_extra\" \"1\")\n+\t\t\t\t   (and (eq_attr \"type\" \"ssecomi\")\n+\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-direct,znver1-fp1|znver1-fp2\")\n \n (define_insn_reservation \"znver1_sse_test_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"prefix_extra\" \"1\")\n-\t\t\t\t\t(and (eq_attr \"type\" \"ssecomi\")\n-\t\t\t\t\t     (eq_attr \"memory\" \"load\")))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"prefix_extra\" \"1\")\n+\t\t\t\t   (and (eq_attr \"type\" \"ssecomi\")\n+\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp1|znver1-fp2\")\n \n ;; SSE moves\n@@ -619,6 +756,14 @@\n \t\t\t\t\t     (eq_attr \"memory\" \"none\")))))\n \t\t\t \"znver1-direct,znver1-ieu0\")\n \n+(define_insn_reservation \"znver2_sse_mov\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"mode\" \"SI\")\n+\t\t\t\t   (and (eq_attr \"isa\" \"avx\")\n+\t\t\t\t\t(and (eq_attr \"type\" \"ssemov\")\n+\t\t\t\t\t     (eq_attr \"memory\" \"none\")))))\n+\t\t\t \"znver1-direct,znver1-ieu0\")\n+\n (define_insn_reservation \"znver1_avx_mov\" 2\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"mode\" \"TI\")\n@@ -628,11 +773,21 @@\n \t\t\t\t\t\t  (eq_attr \"memory\" \"none\"))))))\n \t\t\t \"znver1-direct,znver1-ieu2\")\n \n+(define_insn_reservation \"znver2_avx_mov\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"mode\" \"TI\")\n+\t\t\t\t   (and (eq_attr \"isa\" \"avx\")\n+\t\t\t\t\t(and (eq_attr \"type\" \"ssemov\")\n+\t\t\t\t\t     (and (match_operand:SI 1 \"register_operand\")\n+\t\t\t\t\t\t  (eq_attr \"memory\" \"none\"))))))\n+\t\t\t \"znver1-direct,znver1-ieu2\")\n+\n (define_insn_reservation \"znver1_sseavx_mov\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssemov\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"type\" \"ssemov\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fpu\")\n \n (define_insn_reservation \"znver1_sseavx_mov_store\" 1\n@@ -641,12 +796,18 @@\n \t\t\t\t   (and (eq_attr \"type\" \"ssemov\")\n \t\t\t\t\t(eq_attr \"memory\" \"store\"))))\n \t\t\t\"znver1-direct,znver1-fpu,znver1-store\")\n+(define_insn_reservation \"znver2_sseavx_mov_store\" 1\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"ssemov\")\n+\t\t\t\t   (eq_attr \"memory\" \"store\")))\n+\t\t\t\"znver1-direct,znver1-fpu,znver2-store\")\n \n (define_insn_reservation \"znver1_sseavx_mov_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssemov\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t       (and (eq_attr \"type\" \"ssemov\")\n+\t\t\t\t    (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fpu\")\n \n (define_insn_reservation \"znver1_avx256_mov\" 1\n@@ -672,17 +833,19 @@\n \n ;; SSE add\n (define_insn_reservation \"znver1_sseavx_add\" 3\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"sseadd\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"type\" \"sseadd\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp2|znver1-fp3\")\n \n (define_insn_reservation \"znver1_sseavx_add_load\" 10\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"sseadd\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"type\" \"sseadd\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp2|znver1-fp3\")\n \n (define_insn_reservation \"znver1_avx256_add\" 3\n@@ -700,17 +863,19 @@\n \t\t\t \"znver1-double,znver1-load,znver1-fp2|znver1-fp3\")\n \n (define_insn_reservation \"znver1_sseavx_fma\" 5\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssemuladd\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"type\" \"ssemuladd\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sseavx_fma_load\" 12\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssemuladd\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"type\" \"ssemuladd\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t\"znver1-direct,znver1-load,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_avx256_fma\" 5\n@@ -728,17 +893,19 @@\n \t\t\t \"znver1-double,znver1-load,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sseavx_iadd\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"DI,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"sseiadd\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"DI,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"type\" \"sseiadd\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0|znver1-fp1|znver1-fp3\")\n \n (define_insn_reservation \"znver1_sseavx_iadd_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"DI,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"sseiadd\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"DI,TI\"))\n+\t\t\t\t   (eq_attr \"cpu\" \"znver2\"))\n+\t\t\t      (and (eq_attr \"type\" \"sseiadd\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0|znver1-fp1|znver1-fp3\")\n \n (define_insn_reservation \"znver1_avx256_iadd\" 1\n@@ -757,7 +924,7 @@\n \n ;; SSE conversions.\n (define_insn_reservation \"znver1_ssecvtsf_si_load\" 12\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"mode\" \"SI\")\n \t\t\t\t   (and (eq_attr \"type\" \"sseicvt\")\n \t\t\t\t\t(and (match_operand:SF 1 \"memory_operand\")\n@@ -771,6 +938,13 @@\n \t\t\t\t\t(and (eq_attr \"type\" \"sseicvt\")\n \t\t\t\t\t     (eq_attr \"memory\" \"none\")))))\n \t\t\t \"znver1-double,znver1-fp3,znver1-ieu0\")\n+(define_insn_reservation \"znver2_ssecvtdf_si\" 4\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"mode\" \"SI\")\n+\t\t\t\t   (and (match_operand:DF 1 \"register_operand\")\n+\t\t\t\t\t(and (eq_attr \"type\" \"sseicvt\")\n+\t\t\t\t\t     (eq_attr \"memory\" \"none\")))))\n+\t\t\t \"znver1-double,znver1-fp3,znver1-ieu0\")\n \n (define_insn_reservation \"znver1_ssecvtdf_si_load\" 12\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n@@ -780,6 +954,14 @@\n \t\t\t\t\t     (eq_attr \"memory\" \"load\")))))\n \t\t\t \"znver1-double,znver1-load,znver1-fp3,znver1-ieu0\")\n \n+(define_insn_reservation \"znver2_ssecvtdf_si_load\" 11\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"mode\" \"SI\")\n+\t\t\t\t   (and (eq_attr \"type\" \"sseicvt\")\n+\t\t\t\t\t(and (match_operand:DF 1 \"memory_operand\")\n+\t\t\t\t\t     (eq_attr \"memory\" \"load\")))))\n+\t\t\t \"znver1-double,znver1-load,znver1-fp3,znver1-ieu0\")\n+\n ;; All other used ssecvt fp3 pipes\n ;; Check: Need to revisit this again.\n ;; Some SSE converts may use different pipe combinations.\n@@ -789,39 +971,59 @@\n \t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp3\")\n \n+(define_insn_reservation \"znver2_ssecvt\" 3\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"ssecvt\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n+\t\t\t \"znver1-direct,znver1-fp3\")\n+\n (define_insn_reservation \"znver1_ssecvt_load\" 11\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"type\" \"ssecvt\")\n \t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp3\")\n \n+(define_insn_reservation \"znver2_ssecvt_load\" 11\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"ssecvt\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n+\t\t\t \"znver1-direct,znver1-load,znver1-fp3\")\n+\n ;; SSE div\n (define_insn_reservation \"znver1_ssediv_ss_ps\" 10\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V4SF,SF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssediv\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V4SF,SF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"V8SF,V4SF,SF\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssediv\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp3*10\")\n \n (define_insn_reservation \"znver1_ssediv_ss_ps_load\" 17\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V4SF,SF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssediv\")\n-\t\t\t \t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V4SF,SF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"V8SF,V4SF,SF\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssediv\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp3*10\")\n \n (define_insn_reservation \"znver1_ssediv_sd_pd\" 13\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V2DF,DF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssediv\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V2DF,DF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"V4DF,V2DF,DF\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssediv\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp3*13\")\n \n (define_insn_reservation \"znver1_ssediv_sd_pd_load\" 20\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V2DF,DF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssediv\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V2DF,DF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"V4DF,V2DF,DF\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssediv\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp3*13\")\n \n (define_insn_reservation \"znver1_ssediv_avx256_ps\" 12\n@@ -853,17 +1055,21 @@\n \t\t\t \"znver1-double,znver1-load,znver1-fp3*15\")\n ;; SSE MUL\n (define_insn_reservation \"znver1_ssemul_ss_ps\" 3\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V4SF,SF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssemul\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V4SF,SF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"V8SF,V4SF,SF,V4DF,V2DF,DF\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssemul\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,(znver1-fp0|znver1-fp1)*3\")\n \n (define_insn_reservation \"znver1_ssemul_ss_ps_load\" 10 \n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"V4SF,SF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssemul\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"V4SF,SF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"V8SF,V4SF,SF\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssemul\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,(znver1-fp0|znver1-fp1)*3\")\n \n (define_insn_reservation \"znver1_ssemul_avx256_ps\" 3\n@@ -894,12 +1100,23 @@\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t \"znver1-direct,znver1-load,(znver1-fp0|znver1-fp1)*4\")\n \n+(define_insn_reservation \"znver2_ssemul_sd_pd\" 3\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"ssemul\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n+\t\t\t \"znver1-direct,(znver1-fp0|znver1-fp1)*3\")\n+\n+(define_insn_reservation \"znver2_ssemul_sd_pd_load\" 10\n+\t\t\t (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t      (and (eq_attr \"type\" \"ssemul\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n+\t\t\t \"znver1-direct,znver1-load,(znver1-fp0|znver1-fp1)*3\")\n+\n (define_insn_reservation \"znver1_ssemul_avx256_pd\" 5\n \t\t\t (and (eq_attr \"cpu\" \"znver1\")\n \t\t\t      (and (eq_attr \"mode\" \"V4DF\")\n-\t\t\t\t   (and (eq_attr \"mode\" \"V4DF\")\n-\t\t\t\t\t(and (eq_attr \"type\" \"ssemul\")\n-\t\t\t\t\t     (eq_attr \"memory\" \"none\")))))\n+\t\t\t\t   (and (eq_attr \"type\" \"ssemul\")\n+\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,(znver1-fp0|znver1-fp1)*4\")\n \n (define_insn_reservation \"znver1_ssemul_avx256_pd_load\" 12\n@@ -911,60 +1128,68 @@\n \n ;;SSE imul\n (define_insn_reservation \"znver1_sseimul\" 3\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"sseimul\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"TI\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"TI,OI\")))\n+\t\t\t      (and (eq_attr \"type\" \"sseimul\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0*3\")\n \n (define_insn_reservation \"znver1_sseimul_avx256\" 4\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"mode\" \"OI\")\n \t\t\t\t   (and (eq_attr \"type\" \"sseimul\")\n \t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n \t\t\t \"znver1-double,znver1-fp0*4\")\n \n (define_insn_reservation \"znver1_sseimul_load\" 10\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"sseimul\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"TI\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"TI,OI\")))\n+\t\t\t      (and (eq_attr \"type\" \"sseimul\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0*3\")\n \n (define_insn_reservation \"znver1_sseimul_avx256_load\" 11\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"mode\" \"OI\")\n \t\t\t\t   (and (eq_attr \"type\" \"sseimul\")\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t \"znver1-double,znver1-load,znver1-fp0*4\")\n \n (define_insn_reservation \"znver1_sseimul_di\" 3 \n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"mode\" \"DI\")\n \t\t\t\t   (and (eq_attr \"memory\" \"none\")\n \t\t\t\t\t(eq_attr \"type\" \"sseimul\"))))\n \t\t\t \"znver1-direct,znver1-fp0*3\")\n \n (define_insn_reservation \"znver1_sseimul_load_di\" 10 \n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t (and (eq_attr \"cpu\" \"znver1,znver2\")\n \t\t\t      (and (eq_attr \"mode\" \"DI\")\n \t\t\t\t   (and (eq_attr \"type\" \"sseimul\")\n \t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0*3\")\n \n ;; SSE compares\n (define_insn_reservation \"znver1_sse_cmp\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssecmp\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,V8SF,V4DF\")))\n+\t\t\t       (and (eq_attr \"type\" \"ssecmp\")\n+\t\t\t\t    (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sse_cmp_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssecmp\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"SF,DF,V4SF,V2DF,V8SF,V4DF\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssecmp\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sse_cmp_avx256\" 1\n@@ -982,17 +1207,21 @@\n \t\t\t \"znver1-double,znver1-load,znver1-fp0|znver1-fp1\")\n \n (define_insn_reservation \"znver1_sse_icmp\" 1\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"QI,HI,SI,DI,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssecmp\")\n-\t\t\t\t\t(eq_attr \"memory\" \"none\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"QI,HI,SI,DI,TI\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"QI,HI,SI,DI,TI,OI\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssecmp\")\n+\t\t\t\t   (eq_attr \"memory\" \"none\")))\n \t\t\t \"znver1-direct,znver1-fp0|znver1-fp3\")\n \n (define_insn_reservation \"znver1_sse_icmp_load\" 8\n-\t\t\t (and (eq_attr \"cpu\" \"znver1\")\n-\t\t\t      (and (eq_attr \"mode\" \"QI,HI,SI,DI,TI\")\n-\t\t\t\t   (and (eq_attr \"type\" \"ssecmp\")\n-\t\t\t\t\t(eq_attr \"memory\" \"load\"))))\n+\t\t\t (and (ior (and (eq_attr \"cpu\" \"znver1\")\n+\t\t\t                (eq_attr \"mode\" \"QI,HI,SI,DI,TI\"))\n+\t\t\t\t   (and (eq_attr \"cpu\" \"znver2\")\n+\t\t\t                (eq_attr \"mode\" \"QI,HI,SI,DI,TI,OI\")))\n+\t\t\t      (and (eq_attr \"type\" \"ssecmp\")\n+\t\t\t\t   (eq_attr \"memory\" \"load\")))\n \t\t\t \"znver1-direct,znver1-load,znver1-fp0|znver1-fp3\")\n \n (define_insn_reservation \"znver1_sse_icmp_avx256\" 1"}]}