{"sha": "2b0cbc5d554671be494017c349cb50ceadac407a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmIwY2JjNWQ1NTQ2NzFiZTQ5NDAxN2MzNDljYjUwY2VhZGFjNDA3YQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2001-05-18T15:00:29Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2001-05-18T15:00:29Z"}, "message": "re PR c++/2526 (internal compiler error (version 2.95.3 and 3.0))\n\ncp:\n\tPR c++/2526\n\t* decl.c (pushdecl): Adjust error string.\n\t(xref_tag): Adjust friend class injection warning. Remove the\n\tinherited name from the class shadowed scope.\ntestsuite:\n\t* g++.old-deja/g++.pt/inherit2.C: Remove XFAIL.\n\t* g++.old-deja/g++.pt/crash67.C: New test.\n\nFrom-SVN: r42265", "tree": {"sha": "dc7bbc9a1a18237b1f75c2012559e6a9f93a2cdf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dc7bbc9a1a18237b1f75c2012559e6a9f93a2cdf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2b0cbc5d554671be494017c349cb50ceadac407a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b0cbc5d554671be494017c349cb50ceadac407a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b0cbc5d554671be494017c349cb50ceadac407a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b0cbc5d554671be494017c349cb50ceadac407a/comments", "author": null, "committer": null, "parents": [{"sha": "9e71c818a14947f016ffff94dd0de4706fc8b886", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e71c818a14947f016ffff94dd0de4706fc8b886", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9e71c818a14947f016ffff94dd0de4706fc8b886"}], "stats": {"total": 68, "additions": 55, "deletions": 13}, "files": [{"sha": "0b59a1e1d5584628c4f403667268707647bfa54a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2b0cbc5d554671be494017c349cb50ceadac407a", "patch": "@@ -1,3 +1,9 @@\n+2001-05-18  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* decl.c (pushdecl): Adjust error string.\n+\t(xref_tag): Adjust friend class injection warning. Remove the\n+\tinherited name from the class shadowed scope.\n+\n 2001-05-17  Mark Mitchell  <mark@codesourcery.com>\n \n \t* except.c (cp_protect_cleanup_actions): New function."}, {"sha": "760440125a08c7f57653989e5c33b789b11f2afa", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 22, "deletions": 11, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=2b0cbc5d554671be494017c349cb50ceadac407a", "patch": "@@ -3938,7 +3938,8 @@ pushdecl (x)\n \t  else if (t == wchar_decl_node)\n \t    {\n \t      if (pedantic && ! DECL_IN_SYSTEM_HEADER (x))\n-\t\tcp_pedwarn (\"redeclaration of wchar_t as `%T'\", TREE_TYPE (x));\n+\t\tcp_pedwarn (\"redeclaration of `wchar_t' as `%T'\",\n+\t\t\t    TREE_TYPE (x));\n \n \t      /* Throw away the redeclaration.  */\n \t      return t;\n@@ -12535,16 +12536,26 @@ xref_tag (code_type_node, name, globalize)\n   if (t && globalize && TREE_CODE (t) == TYPENAME_TYPE)\n     {\n       static int explained;\n-\n-      cp_warning (\"`%s %T' declares a new type at namespace scope;\\n\\\n-to refer to the inherited type, say `%s %T::%T'%s\",\n-\t\t  tag_name (tag_code), name, tag_name (tag_code),\n-\t\t  constructor_name (current_class_type), TYPE_IDENTIFIER (t),\n-\t\t  (!explained ? \"\\n\\\n-(names from dependent base classes are not visible to unqualified name lookup)\"\n-\t\t   : \"\"));\n-\n-      explained = 1;\n+      tree shadowed;\n+\n+      cp_warning (\"`%s %T' declares a new type at namespace scope\",\n+\t\t  tag_name (tag_code), name);\n+      if (!explained++)\n+\tcp_warning (\"  names from dependent base classes are not visible to unqualified name lookup - to refer to the inherited type, say `%s %T::%T'%s\",\n+\t\t    tag_name (tag_code),\n+\t\t    constructor_name (current_class_type),\n+\t\t    TYPE_IDENTIFIER (t));\n+\n+      /* We need to remove the class scope binding for the\n+         TYPENAME_TYPE as otherwise poplevel_class gets confused. */\n+      for (shadowed = b->class_shadowed;\n+\t   shadowed;\n+\t   shadowed = TREE_CHAIN (shadowed))\n+\tif (TREE_TYPE (shadowed) == TYPE_NAME (t))\n+\t  {\n+\t    TREE_PURPOSE (shadowed) = NULL_TREE;\n+\t    break;\n+\t  }\n     }\n \n   if (t && TREE_CODE (t) != code && TREE_CODE (t) != TEMPLATE_TYPE_PARM"}, {"sha": "cdfd501c68c64b77fd77abdb0b91210e47603b19", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2b0cbc5d554671be494017c349cb50ceadac407a", "patch": "@@ -1,3 +1,8 @@\n+2001-05-18  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.old-deja/g++.pt/inherit2.C: Remove XFAIL.\n+\t* g++.old-deja/g++.pt/crash67.C: New test.\n+\n 2001-05-17  Jeffrey D. Oldham  <oldham@codesourcery.com>\n \n \t* g++.old-deja/g++.other/debug9.C: New test."}, {"sha": "e8fc2145ae57140e74287389a399124f27837f77", "filename": "gcc/testsuite/g++.old-deja/g++.pt/crash67.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash67.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash67.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash67.C?ref=2b0cbc5d554671be494017c349cb50ceadac407a", "patch": "@@ -0,0 +1,20 @@\n+// Build don't link:\n+// Special g++ Options: \n+// \n+// Copyright (C) 2001 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 6 May 2001 <nathan@codesourcery.com>\n+\n+// Bug 2526. We ICE'd after diagnosing dependant name confusion in\n+// friendliness when not being pedantic.\n+\n+template<typename T>\n+struct B\n+{\n+  typedef B<T> Mother;\n+};\n+\n+template<typename T>\n+struct D : B<T>\n+{\n+  friend class Mother; // WARNING - defines namespace class\n+};"}, {"sha": "5198a6436e2bb8469cede67aab4e92d68063bebf", "filename": "gcc/testsuite/g++.old-deja/g++.pt/inherit2.C", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finherit2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b0cbc5d554671be494017c349cb50ceadac407a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finherit2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Finherit2.C?ref=2b0cbc5d554671be494017c349cb50ceadac407a", "patch": "@@ -1,7 +1,7 @@\n // Test that we warn about unqualified references to implicit typenames.\n-// Bug: g++ is confused by the binding for ::AN and crashes.\n+\n // Special g++ Options:\n-// excess errors test - XFAIL *-*-*\n+// Build don't link:\n \n template <class T> struct A {\n   struct AA { };"}]}