{"sha": "df0b360e3e82962e7b5e805c130a38593b646a80", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGYwYjM2MGUzZTgyOTYyZTdiNWU4MDVjMTMwYTM4NTkzYjY0NmE4MA==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2012-12-16T14:36:54Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2012-12-16T14:36:54Z"}, "message": "re PR fortran/55197 (Use statement for omp_lib causes ICE)\n\n2012-12-16  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/55197\n        * module.c (gfc_use_module): Free rename list only for\n        internally generated intrinsic modules.\n\n2012-12-16  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/55197\n        * gfortran.dg/gomp/use_intrinsic_1.f90: New.\n\nFrom-SVN: r194537", "tree": {"sha": "567b287d9b44e73b0b57dda1f6e71b362c29a562", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/567b287d9b44e73b0b57dda1f6e71b362c29a562"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/df0b360e3e82962e7b5e805c130a38593b646a80", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df0b360e3e82962e7b5e805c130a38593b646a80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df0b360e3e82962e7b5e805c130a38593b646a80", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df0b360e3e82962e7b5e805c130a38593b646a80/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f6c28ef193ad29a9eccb01db78efd5aca26ae787", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6c28ef193ad29a9eccb01db78efd5aca26ae787", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6c28ef193ad29a9eccb01db78efd5aca26ae787"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "7202632cb7044b75087d2c961622217ca1b667bb", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=df0b360e3e82962e7b5e805c130a38593b646a80", "patch": "@@ -1,3 +1,9 @@\n+2012-12-16  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/55197\n+\t* module.c (gfc_use_module): Free rename list only for\n+\tinternally generated intrinsic modules.\n+\n 2012-12-16  Tobias Burnus  <burnus@net-b.de>\n \n \t* trans-intrinsic.c (conv_intrinsic_move_alloc): Set dynamic"}, {"sha": "cde57390c37b47cadca960f49925213c8260bc03", "filename": "gcc/fortran/module.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ffortran%2Fmodule.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ffortran%2Fmodule.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmodule.c?ref=df0b360e3e82962e7b5e805c130a38593b646a80", "patch": "@@ -6157,6 +6157,8 @@ gfc_use_module (gfc_use_list *module)\n \t\t\t     \"intrinsic module at %C\") != FAILURE)\n        {\n \t use_iso_fortran_env_module ();\n+\t free_rename (module->rename);\n+\t module->rename = NULL;\n \t gfc_current_locus = old_locus;\n \t module->intrinsic = true;\n \t return;\n@@ -6167,6 +6169,8 @@ gfc_use_module (gfc_use_list *module)\n \t\t\t     \"ISO_C_BINDING module at %C\") != FAILURE)\n \t{\n \t  import_iso_c_binding_module();\n+\t  free_rename (module->rename);\n+\t  module->rename = NULL;\n \t  gfc_current_locus = old_locus;\n \t  module->intrinsic = true;\n \t  return;\n@@ -6359,8 +6363,6 @@ gfc_use_modules (void)\n       next = module_list->next;\n       rename_list_remove_duplicate (module_list->rename);\n       gfc_use_module (module_list);\n-      if (module_list->intrinsic)\n-\tfree_rename (module_list->rename);\n       free (module_list);\n     }\n   gfc_rename_list = NULL;"}, {"sha": "5276ca7d25e430694994d6f1931a7b67fc00f563", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=df0b360e3e82962e7b5e805c130a38593b646a80", "patch": "@@ -1,3 +1,8 @@\n+2012-12-16  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/55197\n+\t* gfortran.dg/gomp/use_intrinsic_1.f90: New.\n+\n 2012-12-16  Tobias Burnus  <burnus@net-b.de>\n \n \t* gfortran.dg/move_alloc_14.f90: New."}, {"sha": "5996350301b5fd5eb3826a7207f80e2a21e8b727", "filename": "gcc/testsuite/gfortran.dg/gomp/use_intrinsic_1.f90", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fuse_intrinsic_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df0b360e3e82962e7b5e805c130a38593b646a80/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fuse_intrinsic_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fuse_intrinsic_1.f90?ref=df0b360e3e82962e7b5e805c130a38593b646a80", "patch": "@@ -0,0 +1,11 @@\n+! { dg-do compile }\n+!\n+! PR fortran/55197\n+!\n+! Contributed by Erik Toussaint\n+!\n+\n+use, intrinsic :: omp_lib, only: omp_get_num_threads\n+use, intrinsic :: omp_lib_kinds , foo => omp_lock_kind\n+print *, foo\n+end"}]}