{"sha": "3a546d4d9bea0eef0b2871663fb00c76ab9bb7da", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2E1NDZkNGQ5YmVhMGVlZjBiMjg3MTY2M2ZiMDBjNzZhYjliYjdkYQ==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2009-05-20T00:16:38Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2009-05-20T00:16:38Z"}, "message": "re PR libfortran/37754 (READ I/O Performance regression from 4.3 to 4.4/4.5)\n\n2009-05-19  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libfortran/37754\n\t* io/write_float.def: Simplify format calculation.\n\nFrom-SVN: r147725", "tree": {"sha": "147a1da531e050168dc543615b8d712ddb441320", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/147a1da531e050168dc543615b8d712ddb441320"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da/comments", "author": null, "committer": null, "parents": [{"sha": "5cfd5d9b8f7885b1010c829e1062dd2ff0fecdf1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5cfd5d9b8f7885b1010c829e1062dd2ff0fecdf1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5cfd5d9b8f7885b1010c829e1062dd2ff0fecdf1"}], "stats": {"total": 14, "additions": 9, "deletions": 5}, "files": [{"sha": "e9acb8b5c89959bb1e1fa4c2ddcc15a69c1e506f", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=3a546d4d9bea0eef0b2871663fb00c76ab9bb7da", "patch": "@@ -1,3 +1,8 @@\n+2009-05-19  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libfortran/37754\n+\t* io/write_float.def: Simplify format calculation.\n+\t\n 2009-05-07  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/22423"}, {"sha": "9804d7b9ab1caa226f7d705b5ac993e1440ab7d4", "filename": "libgfortran/io/write_float.def", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da/libgfortran%2Fio%2Fwrite_float.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a546d4d9bea0eef0b2871663fb00c76ab9bb7da/libgfortran%2Fio%2Fwrite_float.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Fwrite_float.def?ref=3a546d4d9bea0eef0b2871663fb00c76ab9bb7da", "patch": "@@ -603,7 +603,7 @@ output_float_FMT_G_ ## x (st_parameter_dt *dtp, const fnode *f, \\\n   int d = f->u.real.d;\\\n   int w = f->u.real.w;\\\n   fnode *newf;\\\n-  GFC_REAL_ ## x exp_d;\\\n+  GFC_REAL_ ## x rexp_d;\\\n   int low, high, mid;\\\n   int ubound, lbound;\\\n   char *p;\\\n@@ -612,8 +612,8 @@ output_float_FMT_G_ ## x (st_parameter_dt *dtp, const fnode *f, \\\n   save_scale_factor = dtp->u.p.scale_factor;\\\n   newf = (fnode *) get_mem (sizeof (fnode));\\\n \\\n-  exp_d = calculate_exp_ ## x (d);\\\n-  if ((m > 0.0 && m < 0.1 - 0.05 / exp_d) || (m >= exp_d - 0.5 ) ||\\\n+  rexp_d = calculate_exp_ ## x (-d);\\\n+  if ((m > 0.0 && m < 0.1 - 0.05 * rexp_d) || (rexp_d * (m + 0.5) >= 1.0) ||\\\n       ((m == 0.0) && !(compile_options.allow_std & GFC_STD_F2003)))\\\n     { \\\n       newf->format = FMT_E;\\\n@@ -635,8 +635,7 @@ output_float_FMT_G_ ## x (st_parameter_dt *dtp, const fnode *f, \\\n       GFC_REAL_ ## x temp;\\\n       mid = (low + high) / 2;\\\n \\\n-      temp = (calculate_exp_ ## x (mid) - \\\n-\t      5 * calculate_exp_ ## x (mid - d - 1)) / 10;\\\n+      temp = (calculate_exp_ ## x (mid - 1) * (1 - 0.5 * rexp_d));\\\n \\\n       if (m < temp)\\\n         { \\"}]}