{"sha": "1d0804d4b6a66182a23ea9df876fb33da0b7d702", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWQwODA0ZDRiNmE2NjE4MmEyM2VhOWRmODc2ZmIzM2RhMGI3ZDcwMg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-09-24T16:24:45Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-09-24T16:24:45Z"}, "message": "re PR middle-end/45738 (ICE: tree check: expected var_decl, have debug_expr_decl in const_value_known_p, at varpool.c:375)\n\n\n\tPR tree-optimization/45738\n\tPR tree-optimization/45741\n\t* expr.c (string_constant): Allow CONST_DECL too;\n\tcheck that DECL_INITIAL is set.\n\t* varpool.c (const_value_known_p): Only look into VAR_DECL\n\tand CONST_DECL.\n\n\t* gcc.c-torture/compile/pr45741.c: New.\n\t* gfortran.fortran-torture/compile/pr45738.f90: New.\n\nFrom-SVN: r164602", "tree": {"sha": "a6a227dfae75d1896089bedcef4875d6a83e133d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a6a227dfae75d1896089bedcef4875d6a83e133d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1d0804d4b6a66182a23ea9df876fb33da0b7d702", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d0804d4b6a66182a23ea9df876fb33da0b7d702", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d0804d4b6a66182a23ea9df876fb33da0b7d702", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d0804d4b6a66182a23ea9df876fb33da0b7d702/comments", "author": null, "committer": null, "parents": [{"sha": "5642f5d5d5e3f6867cbe4b7b6fb1588365514c9c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5642f5d5d5e3f6867cbe4b7b6fb1588365514c9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5642f5d5d5e3f6867cbe4b7b6fb1588365514c9c"}], "stats": {"total": 42, "additions": 39, "deletions": 3}, "files": [{"sha": "ce8050f64059e88cb67f729ffe3373f2dd49b1d5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1d0804d4b6a66182a23ea9df876fb33da0b7d702", "patch": "@@ -1,3 +1,12 @@\n+2010-09-24  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR tree-optimization/45738\n+\tPR tree-optimization/45741\n+\t* expr.c (string_constant): Allow CONST_DECL too;\n+\tcheck that DECL_INITIAL is set.\n+\t* varpool.c (const_value_known_p): Only look into VAR_DECL\n+\tand CONST_DECL.\n+\n 2010-09-24  Joseph Myers  <joseph@codesourcery.com>\n \n \t* common.opt (undef): New."}, {"sha": "7bc1575decaf4d04b2fcd61e188ec4a742350c92", "filename": "gcc/expr.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=1d0804d4b6a66182a23ea9df876fb33da0b7d702", "patch": "@@ -9854,12 +9854,14 @@ string_constant (tree arg, tree *ptr_offset)\n       *ptr_offset = fold_convert (sizetype, offset);\n       return array;\n     }\n-  else if (TREE_CODE (array) == VAR_DECL)\n+  else if (TREE_CODE (array) == VAR_DECL\n+\t   || TREE_CODE (array) == CONST_DECL)\n     {\n       int length;\n \n       /* Variables initialized to string literals can be handled too.  */\n       if (!const_value_known_p (array)\n+\t  || !DECL_INITIAL (array)\n \t  || TREE_CODE (DECL_INITIAL (array)) != STRING_CST)\n \treturn 0;\n "}, {"sha": "e1cd3a14eef8e191fac6becf4a308708e5acd4b3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1d0804d4b6a66182a23ea9df876fb33da0b7d702", "patch": "@@ -1,3 +1,10 @@\n+2010-09-24  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR tree-optimization/45738\n+\tPR tree-optimization/45741\n+\t* gcc.c-torture/compile/pr45741.c: New.\n+\t* gfortran.fortran-torture/compile/pr45738.f90: New.\n+\n 2010-09-24  Joseph Myers  <joseph@codesourcery.com>\n \n \t* gcc.dg/cpp/undef-opt-1.c: New test."}, {"sha": "2bd96eccc5a236fb555c629485bf4be4debca361", "filename": "gcc/testsuite/gcc.c-torture/compile/pr45771.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr45771.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr45771.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr45771.c?ref=1d0804d4b6a66182a23ea9df876fb33da0b7d702", "patch": "@@ -0,0 +1,7 @@\n+static const int data[2048];\n+\n+void foo (void *ptr)\n+{\n+  __builtin_memcmp (data, ptr, 1);\n+}\n+"}, {"sha": "b0541e357722385752155811fe94151ec6a5dc65", "filename": "gcc/testsuite/gfortran.fortran-torture/compile/pr45738.f90", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fpr45738.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fpr45738.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fpr45738.f90?ref=1d0804d4b6a66182a23ea9df876fb33da0b7d702", "patch": "@@ -0,0 +1,11 @@\n+PROGRAM TestInfinite\n+  integer(8) :: bit_pattern_NegInf_i8 = -4503599627370496_8\n+\n+  integer(8) :: i\n+  real(8)    :: r\n+\n+  r = transfer(bit_pattern_NegInf_i8_p,r)\n+  i = transfer(r,i)\n+\n+END PROGRAM TestInfinite\n+"}, {"sha": "673905d5a76d761c1fa9654948c9bf84d1f48202", "filename": "gcc/varpool.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Fvarpool.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d0804d4b6a66182a23ea9df876fb33da0b7d702/gcc%2Fvarpool.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarpool.c?ref=1d0804d4b6a66182a23ea9df876fb33da0b7d702", "patch": "@@ -367,8 +367,8 @@ const_value_known_p (tree decl)\n {\n   struct varpool_node *vnode;\n \n-  if (TREE_CODE (decl) == PARM_DECL\n-      || TREE_CODE (decl) == RESULT_DECL)\n+  if (TREE_CODE (decl) != VAR_DECL\n+      &&TREE_CODE (decl) != CONST_DECL)\n     return false;\n \n   if (TREE_CODE (decl) == CONST_DECL"}]}