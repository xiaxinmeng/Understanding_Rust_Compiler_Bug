{"sha": "ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "node_id": "C_kwDOANBUbNoAKGFkOTY0ZjdlYWVmOWMwM2NlNjhhMDFjZmRkN2ZkZTlkNTY1MjQ4Njg", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-12-21T16:43:55Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-12-29T11:44:25Z"}, "message": "Support ld.mold linker.\n\ngcc/ChangeLog:\n\n\t* collect2.c (main): Add ld.mold.\n\t* common.opt: Add -fuse-ld=mold.\n\t* doc/invoke.texi: Document it.\n\t* gcc.c (driver_handle_option): Handle -fuse-ld=mold.\n\t* opts.c (common_handle_option): Likewise.", "tree": {"sha": "3b282a6fb99d06a4e8a2a4b8dbd970329452f843", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3b282a6fb99d06a4e8a2a4b8dbd970329452f843"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "52a6b06c26346cfb6972252ef547720b431844e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/52a6b06c26346cfb6972252ef547720b431844e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/52a6b06c26346cfb6972252ef547720b431844e6"}], "stats": {"total": 23, "additions": 20, "deletions": 3}, "files": [{"sha": "b322527847c701f3b543032d58308fc9cf76e8dd", "filename": "gcc/collect2.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fcollect2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fcollect2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcollect2.c?ref=ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "patch": "@@ -776,6 +776,7 @@ main (int argc, char **argv)\n       USE_GOLD_LD,\n       USE_BFD_LD,\n       USE_LLD_LD,\n+      USE_MOLD_LD,\n       USE_LD_MAX\n     } selected_linker = USE_DEFAULT_LD;\n   static const char *const ld_suffixes[USE_LD_MAX] =\n@@ -784,7 +785,8 @@ main (int argc, char **argv)\n       PLUGIN_LD_SUFFIX,\n       \"ld.gold\",\n       \"ld.bfd\",\n-      \"ld.lld\"\n+      \"ld.lld\",\n+      \"ld.mold\"\n     };\n   static const char *const real_ld_suffix = \"real-ld\";\n   static const char *const collect_ld_suffix = \"collect-ld\";\n@@ -957,6 +959,8 @@ main (int argc, char **argv)\n \t  selected_linker = USE_GOLD_LD;\n \telse if (strcmp (argv[i], \"-fuse-ld=lld\") == 0)\n \t  selected_linker = USE_LLD_LD;\n+\telse if (strcmp (argv[i], \"-fuse-ld=mold\") == 0)\n+\t  selected_linker = USE_MOLD_LD;\n \telse if (startswith (argv[i], \"-o\"))\n \t  {\n \t    /* Parse the output filename if it's given so that we can make\n@@ -1048,7 +1052,7 @@ main (int argc, char **argv)\n   ld_file_name = 0;\n #ifdef DEFAULT_LINKER\n   if (selected_linker == USE_BFD_LD || selected_linker == USE_GOLD_LD ||\n-      selected_linker == USE_LLD_LD)\n+      selected_linker == USE_LLD_LD || selected_linker == USE_MOLD_LD)\n     {\n       char *linker_name;\n # ifdef HOST_EXECUTABLE_SUFFIX\n@@ -1283,7 +1287,7 @@ main (int argc, char **argv)\n \t      else if (!use_collect_ld\n \t\t       && startswith (arg, \"-fuse-ld=\"))\n \t\t{\n-\t\t  /* Do not pass -fuse-ld={bfd|gold|lld} to the linker. */\n+\t\t  /* Do not pass -fuse-ld={bfd|gold|lld|mold} to the linker. */\n \t\t  ld1--;\n \t\t  ld2--;\n \t\t}"}, {"sha": "dba3fa886f9c629da496c24ef0c5d55f1fdf2202", "filename": "gcc/common.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fcommon.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fcommon.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon.opt?ref=ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "patch": "@@ -3046,6 +3046,10 @@ fuse-ld=lld\n Common Driver Negative(fuse-ld=lld)\n Use the lld LLVM linker instead of the default linker.\n \n+fuse-ld=mold\n+Common Driver Negative(fuse-ld=mold)\n+Use the Modern linker (MOLD) linker instead of the default linker.\n+\n fuse-linker-plugin\n Common Undocumented Var(flag_use_linker_plugin)\n "}, {"sha": "54fa75ba138ea9a4a1c40a89262eedaa999e2823", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "patch": "@@ -16266,6 +16266,10 @@ Use the @command{gold} linker instead of the default linker.\n @opindex fuse-ld=lld\n Use the LLVM @command{lld} linker instead of the default linker.\n \n+@item -fuse-ld=mold\n+@opindex fuse-ld=mold\n+Use the Modern Linker (@command{mold}) instead of the default linker.\n+\n @cindex Libraries\n @item -l@var{library}\n @itemx -l @var{library}"}, {"sha": "06e18a75b52ccb57ba68134b4ca8b8f84ad547f7", "filename": "gcc/gcc.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "patch": "@@ -4282,6 +4282,10 @@ driver_handle_option (struct gcc_options *opts,\n        use_ld = \".gold\";\n        break;\n \n+    case OPT_fuse_ld_mold:\n+       use_ld = \".mold\";\n+       break;\n+\n     case OPT_fcompare_debug_second:\n       compare_debug_second = 1;\n       break;"}, {"sha": "f820052307c367b54d6cf1ba72eabb3002b11775", "filename": "gcc/opts.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad964f7eaef9c03ce68a01cfdd7fde9d56524868/gcc%2Fopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fopts.c?ref=ad964f7eaef9c03ce68a01cfdd7fde9d56524868", "patch": "@@ -3105,6 +3105,7 @@ common_handle_option (struct gcc_options *opts,\n     case OPT_fuse_ld_bfd:\n     case OPT_fuse_ld_gold:\n     case OPT_fuse_ld_lld:\n+    case OPT_fuse_ld_mold:\n     case OPT_fuse_linker_plugin:\n       /* No-op. Used by the driver and passed to us because it starts with f.*/\n       break;"}]}