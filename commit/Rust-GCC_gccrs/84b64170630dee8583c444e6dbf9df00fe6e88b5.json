{"sha": "84b64170630dee8583c444e6dbf9df00fe6e88b5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODRiNjQxNzA2MzBkZWU4NTgzYzQ0NGU2ZGJmOWRmMDBmZTZlODhiNQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2014-07-09T21:23:06Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2014-07-09T21:23:06Z"}, "message": "DR 1584 PR c++/57466\n\n/cp\n2014-07-09  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tDR 1584\n\tPR c++/57466\n\t* pt.c (check_cv_quals_for_unify): Implement resolution, disregard\n\tcv-qualifiers of function types.\n\n/testsuite\n2014-07-09  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tDR 1584\n\tPR c++/57466\n\t* g++.dg/template/pr57466.C: New.\n\t* g++.dg/cpp0x/pr57466.C: Likewise.\n\t* g++.dg/template/unify6.C: Update.\n\nFrom-SVN: r212410", "tree": {"sha": "9059ca11989c432e928aef7188811026c0257196", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9059ca11989c432e928aef7188811026c0257196"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84b64170630dee8583c444e6dbf9df00fe6e88b5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84b64170630dee8583c444e6dbf9df00fe6e88b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84b64170630dee8583c444e6dbf9df00fe6e88b5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84b64170630dee8583c444e6dbf9df00fe6e88b5/comments", "author": null, "committer": null, "parents": [{"sha": "26e288bab56e529b3249c580ad31da4f0e77d76f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26e288bab56e529b3249c580ad31da4f0e77d76f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26e288bab56e529b3249c580ad31da4f0e77d76f"}], "stats": {"total": 57, "additions": 51, "deletions": 6}, "files": [{"sha": "6174193cb89577312d4845722bd1f88f5c56277c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=84b64170630dee8583c444e6dbf9df00fe6e88b5", "patch": "@@ -1,3 +1,10 @@\n+2014-07-09  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tDR 1584\n+\tPR c++/57466\n+\t* pt.c (check_cv_quals_for_unify): Implement resolution, disregard\n+\tcv-qualifiers of function types.\n+\n 2014-07-09  Andrew Sutton  <andrew.n.sutton@gmail.com>\n \t    Paolo Carlini  <paolo.carlini@oracle.com>\n "}, {"sha": "7b79280da1ab8c1be516007a8f4213ee744fc885", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=84b64170630dee8583c444e6dbf9df00fe6e88b5", "patch": "@@ -17189,6 +17189,11 @@ check_cv_quals_for_unify (int strict, tree arg, tree parm)\n   int arg_quals = cp_type_quals (arg);\n   int parm_quals = cp_type_quals (parm);\n \n+  /* DR 1584: cv-qualification of a deduced function type is\n+     ignored; see 8.3.5 [dcl.fct].  */\n+  if (TREE_CODE (arg) == FUNCTION_TYPE)\n+    return 1;\n+\n   if (TREE_CODE (parm) == TEMPLATE_TYPE_PARM\n       && !(strict & UNIFY_ALLOW_OUTER_MORE_CV_QUAL))\n     {"}, {"sha": "675e3431b10b69d85465ee4e1a250585fad82b47", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=84b64170630dee8583c444e6dbf9df00fe6e88b5", "patch": "@@ -1,3 +1,11 @@\n+2014-07-09  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tDR 1584\n+\tPR c++/57466\n+\t* g++.dg/template/pr57466.C: New.\n+\t* g++.dg/cpp0x/pr57466.C: Likewise.\n+\t* g++.dg/template/unify6.C: Update.\n+\n 2014-07-09  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \t* gfortran.dg/ieee/underflow_1.f90: New file."}, {"sha": "792a3cb9afb499a6c28d5eb7c27806332029294d", "filename": "gcc/testsuite/g++.dg/cpp0x/pr57466.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr57466.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr57466.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr57466.C?ref=84b64170630dee8583c444e6dbf9df00fe6e88b5", "patch": "@@ -0,0 +1,18 @@\n+// PR c++/57466\n+// { dg-do compile { target c++11 } }\n+\n+template<typename T>\n+  constexpr bool\n+  is_pointer(const T*)\n+  { return true; }\n+\n+template<typename T>\n+  constexpr bool\n+  is_pointer(const T&)\n+  { return false; }\n+\n+using F = void();\n+\n+constexpr F* f = nullptr;\n+\n+static_assert( is_pointer(f), \"function pointer is a pointer\" );"}, {"sha": "6dd37102ef63e0d4aaa1a83cc2122f21dca474cd", "filename": "gcc/testsuite/g++.dg/template/pr57466.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fpr57466.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fpr57466.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fpr57466.C?ref=84b64170630dee8583c444e6dbf9df00fe6e88b5", "patch": "@@ -0,0 +1,8 @@\n+// DR 1584, PR c++/57466\n+\n+template<class T> void f2(const T*);\n+void g2();\n+\n+void m() {\n+  f2(g2);    // OK: cv-qualification of deduced function type ignored\n+}"}, {"sha": "374bb91c216f51a95eaa77dd75c1e76d93d563df", "filename": "gcc/testsuite/g++.dg/template/unify6.C", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Funify6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84b64170630dee8583c444e6dbf9df00fe6e88b5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Funify6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Funify6.C?ref=84b64170630dee8583c444e6dbf9df00fe6e88b5", "patch": "@@ -3,21 +3,20 @@\n \n void Baz ();\n \n-template <typename T> void Foo1 (T *); // #1\n-template <typename T> void Foo1 (T const *a) {a (1);} // #2\n+template <typename T> void Foo1 (T *);\n+template <typename T> void Foo1 (T const *a) {a (1);} // { dg-error \"too many arguments\" }\n \n template <typename T> T const *Foo2 (T *);\n \n-template <typename T> void Foo3 (T *, T const * = 0); // { dg-message \"note\" }\n+template <typename T> void Foo3 (T *, T const * = 0);\n \n void Bar ()\n {\n-  Foo1 (&Baz); // #1\n+  Foo1 (&Baz); // { dg-message \"required from here\" }\n \n   Foo2 (&Baz);\n \n   Foo3 (&Baz);\n \n-  Foo3 (&Baz, &Baz); // { dg-error \"no matching function\" \"\" }\n-  // { dg-message \"(candidate|incompatible cv-qualifiers)\" \"candidate note\" { target *-*-* } 21 }\n+  Foo3 (&Baz, &Baz);\n }"}]}