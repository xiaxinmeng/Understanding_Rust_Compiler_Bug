{"sha": "1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWVkM2RmZDU1ZGE2Y2ZhMDlhOTM5NTg4MWU3MzQwNWIzN2M4M2M4Yg==", "commit": {"author": {"name": "Giovanni Bajo", "email": "giovannibajo@gcc.gnu.org", "date": "2004-10-16T11:04:58Z"}, "committer": {"name": "Giovanni Bajo", "email": "giovannibajo@gcc.gnu.org", "date": "2004-10-16T11:04:58Z"}, "message": "re PR c++/10479 (alignof and sizeof (and other expressions) in attributes does not compile inside template classes)\n\n\tPR c++/10479\n\t* parser.c (cp_parser_parenthesized_expression_list): Fold\n\tnon-dependent expressions in attribute lists.\n\n\tPR c++/10479\n\t* g++.dg/ext/attrib16.C: New test.\n\nFrom-SVN: r89135", "tree": {"sha": "031cfbaf9dfc1186c679877f5ea90e7084d444fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/031cfbaf9dfc1186c679877f5ea90e7084d444fe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/comments", "author": {"login": "rasky", "id": 1014109, "node_id": "MDQ6VXNlcjEwMTQxMDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1014109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rasky", "html_url": "https://github.com/rasky", "followers_url": "https://api.github.com/users/rasky/followers", "following_url": "https://api.github.com/users/rasky/following{/other_user}", "gists_url": "https://api.github.com/users/rasky/gists{/gist_id}", "starred_url": "https://api.github.com/users/rasky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rasky/subscriptions", "organizations_url": "https://api.github.com/users/rasky/orgs", "repos_url": "https://api.github.com/users/rasky/repos", "events_url": "https://api.github.com/users/rasky/events{/privacy}", "received_events_url": "https://api.github.com/users/rasky/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rasky", "id": 1014109, "node_id": "MDQ6VXNlcjEwMTQxMDk=", "avatar_url": "https://avatars.githubusercontent.com/u/1014109?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rasky", "html_url": "https://github.com/rasky", "followers_url": "https://api.github.com/users/rasky/followers", "following_url": "https://api.github.com/users/rasky/following{/other_user}", "gists_url": "https://api.github.com/users/rasky/gists{/gist_id}", "starred_url": "https://api.github.com/users/rasky/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rasky/subscriptions", "organizations_url": "https://api.github.com/users/rasky/orgs", "repos_url": "https://api.github.com/users/rasky/repos", "events_url": "https://api.github.com/users/rasky/events{/privacy}", "received_events_url": "https://api.github.com/users/rasky/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "29c431a17d8d826426cb35bad2cc3a33aa83df18", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29c431a17d8d826426cb35bad2cc3a33aa83df18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29c431a17d8d826426cb35bad2cc3a33aa83df18"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "ebd8705f674c09dbb429bb8d7c00315a2d4efc8c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "patch": "@@ -1,3 +1,9 @@\n+2004-10-16  Giovanni Bajo  <giovannibajo@gcc.gnu.org>\n+\n+\tPR c++/10479\n+\t* parser.c (cp_parser_parenthesized_expression_list): Fold\n+\tnon-dependent expressions in attribute lists.\n+\n 2004-10-15  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/17042"}, {"sha": "76738262e7c16464563eba8803beee7945a72cea", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "patch": "@@ -4420,6 +4420,7 @@ cp_parser_parenthesized_expression_list (cp_parser* parser,\n \t\t\t\t\t bool *non_constant_p)\n {\n   tree expression_list = NULL_TREE;\n+  bool fold_expr_p = is_attribute_list;\n   tree identifier = NULL_TREE;\n \n   /* Assume all the expressions will be constant.  */\n@@ -4462,6 +4463,9 @@ cp_parser_parenthesized_expression_list (cp_parser* parser,\n \t    else\n \t      expr = cp_parser_assignment_expression (parser);\n \n+\t    if (fold_expr_p)\n+\t      expr = fold_non_dependent_expr (expr);\n+\n \t     /* Add it to the list.  We add error_mark_node\n \t\texpressions to the list, so that we can still tell if\n \t\tthe correct form for a parenthesized expression-list"}, {"sha": "0ca8452357faba113b6326af7f5a097f243cf0cb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "patch": "@@ -1,3 +1,8 @@\n+2004-10-16  Giovanni Bajo  <giovannibajo@gcc.gnu.org>\n+\n+\tPR c++/10479\n+\t* g++.dg/ext/attrib16.C: New test.\n+\n 2004-10-15  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/17042"}, {"sha": "2e73fca70ba347d674639e7369fc68900085b0f6", "filename": "gcc/testsuite/g++.dg/ext/attrib16.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fattrib16.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ed3dfd55da6cfa09a9395881e73405b37c83c8b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fattrib16.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fattrib16.C?ref=1ed3dfd55da6cfa09a9395881e73405b37c83c8b", "patch": "@@ -0,0 +1,8 @@\n+// { dg-do compile }\n+// Origin: <rguenth at tat dot physik dot uni-tuebingen dot de>\n+// PR c++/10479: use of non dependent expressions in attributes in templates\n+\n+template <int i>\n+struct foo2 {\n+  float bar __attribute__((aligned(__alignof__(double))));\n+};"}]}