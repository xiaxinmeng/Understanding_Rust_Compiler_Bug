{"sha": "28a6085042290266bb682a39cbef0a9c195d5838", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjhhNjA4NTA0MjI5MDI2NmJiNjgyYTM5Y2JlZjBhOWMxOTVkNTgzOA==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2003-10-02T12:26:39Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2003-10-02T12:26:39Z"}, "message": "frv.c (frv_issue_rate): New function.\n\n\t* config/frv/frv.c (frv_issue_rate): New function.\n\t(frv_pack_insns): Use it.\n\t(TARGET_SCHED_ISSUE_RATE): Define.\n\nFrom-SVN: r72026", "tree": {"sha": "0ee41a45e93679c869e833e8ce5f4092ec9d9bcd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0ee41a45e93679c869e833e8ce5f4092ec9d9bcd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/28a6085042290266bb682a39cbef0a9c195d5838", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28a6085042290266bb682a39cbef0a9c195d5838", "html_url": "https://github.com/Rust-GCC/gccrs/commit/28a6085042290266bb682a39cbef0a9c195d5838", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28a6085042290266bb682a39cbef0a9c195d5838/comments", "author": null, "committer": null, "parents": [{"sha": "be4cee68205a016feaab7f3730261f2f64c62b42", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be4cee68205a016feaab7f3730261f2f64c62b42", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be4cee68205a016feaab7f3730261f2f64c62b42"}], "stats": {"total": 54, "additions": 39, "deletions": 15}, "files": [{"sha": "396a3b9ff07c21debe4a935c6eafa0c4e899e73f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28a6085042290266bb682a39cbef0a9c195d5838/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28a6085042290266bb682a39cbef0a9c195d5838/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=28a6085042290266bb682a39cbef0a9c195d5838", "patch": "@@ -1,3 +1,9 @@\n+2003-10-02  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config/frv/frv.c (frv_issue_rate): New function.\n+\t(frv_pack_insns): Use it.\n+\t(TARGET_SCHED_ISSUE_RATE): Define.\n+\n 2003-10-02  Steven Bosscher <s.bosscher@student.tudelft.nl>\n \n \t* config/mcore/mcore.c: Convert to ISO C90 function declarations"}, {"sha": "0d8398283eedea8c5dd8804cf488a268d3e581cb", "filename": "gcc/config/frv/frv.c", "status": "modified", "additions": 33, "deletions": 15, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28a6085042290266bb682a39cbef0a9c195d5838/gcc%2Fconfig%2Ffrv%2Ffrv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28a6085042290266bb682a39cbef0a9c195d5838/gcc%2Fconfig%2Ffrv%2Ffrv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ffrv%2Ffrv.c?ref=28a6085042290266bb682a39cbef0a9c195d5838", "patch": "@@ -272,6 +272,7 @@ static int frv_registers_used_p\t\t\tPARAMS ((rtx, unsigned char [],\n \t\t\t\t\t\t\t int));\n static int frv_registers_set_p\t\t\tPARAMS ((rtx, unsigned char [],\n \t\t\t\t\t\t\t int));\n+static int frv_issue_rate\t\t\tPARAMS ((void));\n static int frv_use_dfa_pipeline_interface\tPARAMS ((void));\n static void frv_pack_insns\t\t\tPARAMS ((void));\n static void frv_function_prologue\t\tPARAMS ((FILE *, HOST_WIDE_INT));\n@@ -314,6 +315,8 @@ static void frv_asm_out_destructor\t\tPARAMS ((rtx, int));\n #undef TARGET_ASM_CAN_OUTPUT_MI_THUNK\n #define TARGET_ASM_CAN_OUTPUT_MI_THUNK default_can_output_mi_thunk_no_vcall\n \n+#undef  TARGET_SCHED_ISSUE_RATE\n+#define TARGET_SCHED_ISSUE_RATE frv_issue_rate\n #undef  TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE\n #define TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE frv_use_dfa_pipeline_interface\n \n@@ -8195,6 +8198,32 @@ frv_init_machine_status ()\n   return ggc_alloc_cleared (sizeof (struct machine_function));\n }\n \f\n+/* Implement TARGET_SCHED_ISSUE_RATE.  */\n+\n+static int\n+frv_issue_rate (void)\n+{\n+  if (!TARGET_PACK)\n+    return 1;\n+\n+  switch (frv_cpu_type)\n+    {\n+    default:\n+    case FRV_CPU_FR300:\n+    case FRV_CPU_SIMPLE:\n+      return 1;\n+\n+    case FRV_CPU_FR400:\n+      return 2;\n+\n+    case FRV_CPU_GENERIC:\n+    case FRV_CPU_FR500:\n+    case FRV_CPU_TOMCAT:\n+      return 4;\n+    }\n+}\n+\n+\n /* Implement TARGET_SCHED_USE_DFA_PIPELINE_INTERFACE.  */\n \n static int\n@@ -8645,23 +8674,12 @@ frv_pack_insns ()\n   unsigned char reg_state[FIRST_PSEUDO_REGISTER];\n \n   /* If we weren't going to pack the insns, don't bother with this pass.  */\n-  if (!optimize || !flag_schedule_insns_after_reload || TARGET_NO_VLIW_BRANCH)\n+  if (!optimize\n+      || !flag_schedule_insns_after_reload\n+      || TARGET_NO_VLIW_BRANCH\n+      || frv_issue_rate () == 1)\n     return;\n \n-  switch (frv_cpu_type)\n-    {\n-    default:\n-    case FRV_CPU_FR300:\t\t/* FR300/simple are single issue */\n-    case FRV_CPU_SIMPLE:\n-      return;\n-\n-    case FRV_CPU_GENERIC:\t/* FR-V and FR500 are multi-issue */\n-    case FRV_CPU_FR400:\n-    case FRV_CPU_FR500:\n-    case FRV_CPU_TOMCAT:\n-      break;\n-    }\n-\n   /* Set up the instruction and register states.  */\n   dfa_start ();\n   frv_state = (state_t) xmalloc (state_size ());"}]}