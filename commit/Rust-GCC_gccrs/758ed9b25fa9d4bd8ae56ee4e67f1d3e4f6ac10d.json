{"sha": "758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzU4ZWQ5YjI1ZmE5ZDRiZDhhZTU2ZWU0ZTY3ZjFkM2U0ZjZhYzEwZA==", "commit": {"author": {"name": "Paul Brook", "email": "paul@codesourcery.com", "date": "2006-09-19T13:19:24Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2006-09-19T13:19:24Z"}, "message": "re PR target/28516 (arm_unwind_emit_set, at config/arm/arm.c:15419 with -fexceptions)\n\n2006-09-19  Paul Brook  <paul@codesourcery.com>\n\n\tPR target/28516\n\tgcc/\n\t* config/arm/arm.c (arm_unwind_emit_set): Handle reg = sp + const.\n\n\tgcc/testsuite/\n\t* gcc.dg/nested-func-5.c: New test.\n\nFrom-SVN: r117056", "tree": {"sha": "b1f2569dbeec472f3edfbd1809d421e207699234", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1f2569dbeec472f3edfbd1809d421e207699234"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/comments", "author": null, "committer": null, "parents": [{"sha": "dc6c77143217f9856b334ca80dfaeccae99ed790", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc6c77143217f9856b334ca80dfaeccae99ed790", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc6c77143217f9856b334ca80dfaeccae99ed790"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "030f172173d9bd35b02eff37337a724f09f59958", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "patch": "@@ -1,3 +1,8 @@\n+2006-09-19  Paul Brook  <paul@codesourcery.com>\n+\n+\tPR target/28516\n+\t* config/arm/arm.c (arm_unwind_emit_set): Handle reg = sp + const.\n+\n 2006-09-17  Zdenek Dvorak <dvorakz@suse.cz>\n \n \tPR tree-optimization/28887"}, {"sha": "ff5831f4325e75bf28f5f714ac9956d8f42c6038", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "patch": "@@ -15415,6 +15415,15 @@ arm_unwind_emit_set (FILE * asm_out_file, rtx p)\n \t  /* Move from sp to reg.  */\n \t  asm_fprintf (asm_out_file, \"\\t.movsp %r\\n\", REGNO (e0));\n \t}\n+     else if (GET_CODE (e1) == PLUS\n+\t      && GET_CODE (XEXP (e1, 0)) == REG\n+\t      && REGNO (XEXP (e1, 0)) == SP_REGNUM\n+\t      && GET_CODE (XEXP (e1, 1)) == CONST_INT)\n+\t{\n+\t  /* Set reg to offset from sp.  */\n+\t  asm_fprintf (asm_out_file, \"\\t.movsp %r, #%d\\n\",\n+\t\t       REGNO (e0), (int)INTVAL(XEXP (e1, 1)));\n+\t}\n       else\n \tabort ();\n       break;"}, {"sha": "e643d1d500108fbc4f83392958d3c45b9770ee28", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "patch": "@@ -1,3 +1,8 @@\n+2006-09-19  Paul Brook  <paul@codesourcery.com>\n+\n+\tPR target/28516\n+\t* gcc.dg/nested-func-5.c: New test.\n+\n 2006-09-19  Ben Elliston  <bje@au.ibm.com>\n \n \t* lib/target-supports.exp (check_effective_target_tls): Compile"}, {"sha": "5076dbd50497a72bf1cc8bfa90bee73bcf97205d", "filename": "gcc/testsuite/gcc.dg/nested-func-5.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2Ftestsuite%2Fgcc.dg%2Fnested-func-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d/gcc%2Ftestsuite%2Fgcc.dg%2Fnested-func-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fnested-func-5.c?ref=758ed9b25fa9d4bd8ae56ee4e67f1d3e4f6ac10d", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fexceptions\" } */\n+/* PR28516: ICE generating ARM unwind directives for nested functions.  */\n+\n+void ex(int (*)(void));\n+void foo(int i)\n+{\n+  int bar(void)\n+  {\n+    return i;\n+  }\n+  ex(bar);\n+}"}]}