{"sha": "954c9235297f2e63acacefd448bc5dabe039ea7c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTU0YzkyMzUyOTdmMmU2M2FjYWNlZmQ0NDhiYzVkYWJlMDM5ZWE3Yw==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2021-06-15T13:29:23Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2021-06-15T13:29:23Z"}, "message": "analyzer testsuite: add explode-2a.c [PR101068]\n\nDue to a bug (PR analyzer/101068), the analyzer only explores a limited\nsubset of the possible paths through gcc.dg/analyzer/explode-2.c,\nand this artifically helps stop this testcase from exploding.\nI intend to fix this at some point, but for now, this patch adds a\nrevised test case which captures the effective CFG due to the bug, so\nthat we explicitly have test coverage for that CFG.\n\ngcc/testsuite/ChangeLog:\n\tPR analyzer/101068\n\t* gcc.dg/analyzer/explode-2a.c: New test.\n\nSigned-off-by: David Malcolm <dmalcolm@redhat.com>", "tree": {"sha": "dc7705e9dca9ef58579c04948a660921c924f32f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dc7705e9dca9ef58579c04948a660921c924f32f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/954c9235297f2e63acacefd448bc5dabe039ea7c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/954c9235297f2e63acacefd448bc5dabe039ea7c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/954c9235297f2e63acacefd448bc5dabe039ea7c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/954c9235297f2e63acacefd448bc5dabe039ea7c/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ba998f6407ba006a8f8055171ee8e8510f0bc46b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba998f6407ba006a8f8055171ee8e8510f0bc46b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba998f6407ba006a8f8055171ee8e8510f0bc46b"}], "stats": {"total": 51, "additions": 51, "deletions": 0}, "files": [{"sha": "126407f3dd7928fb6b6a795cd2c28ac212256d61", "filename": "gcc/testsuite/gcc.dg/analyzer/explode-2a.c", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/954c9235297f2e63acacefd448bc5dabe039ea7c/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fexplode-2a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/954c9235297f2e63acacefd448bc5dabe039ea7c/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fexplode-2a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fexplode-2a.c?ref=954c9235297f2e63acacefd448bc5dabe039ea7c", "patch": "@@ -0,0 +1,51 @@\n+/* PR analyzer/101068.  */\n+\n+/* { dg-additional-options \"--param analyzer-max-enodes-per-program-point=200 --param analyzer-bb-explosion-factor=50\" } */\n+\n+#include <stdlib.h>\n+\n+extern int get (void);\n+\n+void test (void)\n+{\n+  void *p0, *p1, *p2, *p3;\n+  /* Due to not purging constraints on SSA names within loops\n+     (PR analyzer/101068), the analyzer effectively treats the original\n+     explode-2.c as this code.  */\n+  int a = get ();\n+  int b = get ();\n+  while (a)\n+    {\n+      switch (b)\n+\t{\n+\tdefault:\n+\tcase 0:\n+\t  p0 = malloc (16); /* { dg-warning \"leak\" } */\n+\t  break;\n+\tcase 1:\n+\t  free (p0); /* { dg-warning \"double-'free' of 'p0'\" \"\" { xfail *-*-* } } */\n+\t  break;\n+\n+\tcase 2:\n+\t  p1 = malloc (16); /* { dg-warning \"leak\" } */\n+\t  break;\n+\tcase 3:\n+\t  free (p1); /* { dg-warning \"double-'free' of 'p1'\" \"\" { xfail *-*-* } } */\n+\t  break;\n+\n+\tcase 4:\n+\t  p2 = malloc (16); /* { dg-warning \"leak\" } */\n+\t  break;\n+\tcase 5:\n+\t  free (p2); /* { dg-warning \"double-'free' of 'p2'\" \"\" { xfail *-*-* } } */\n+\t  break;\n+\n+\tcase 6:\n+\t  p3 = malloc (16); /* { dg-warning \"leak\" } */\n+\t  break;\n+\tcase 7:\n+\t  free (p3); /* { dg-warning \"double-'free' of 'p3'\" \"\" { xfail *-*-* } } */\n+\t  break;\n+\t}\n+    }\n+}"}]}