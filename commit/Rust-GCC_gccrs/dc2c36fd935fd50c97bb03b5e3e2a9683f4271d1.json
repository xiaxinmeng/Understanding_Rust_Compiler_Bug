{"sha": "dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGMyYzM2ZmQ5MzVmZDUwYzk3YmIwM2I1ZTNlMmE5NjgzZjQyNzFkMQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2014-08-21T18:52:58Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2014-08-21T18:52:58Z"}, "message": "re PR fortran/62214 (Problem with spread plus concatenation for characters)\n\n2014-08-21  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/62214\n\t* frontend-passes.c (optimize_binop_array_assignment):\n\tDo not try to optimize the array assignment for string\n\tconcatenation.\n\n2014-08-21  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/62214\n\t* gfortran.dg/array_assignment_5.f90:  New test.\n\nFrom-SVN: r214281", "tree": {"sha": "d2feca75137109dcc3c7499ef05fa489724d21c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d2feca75137109dcc3c7499ef05fa489724d21c9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/comments", "author": null, "committer": null, "parents": [{"sha": "4e502930574c9980ae53fd204090c9e39b0265bd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e502930574c9980ae53fd204090c9e39b0265bd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e502930574c9980ae53fd204090c9e39b0265bd"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "fcb4a7bb6980506c91969156fff3956fc422da8b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "patch": "@@ -1,3 +1,10 @@\n+2014-08-21  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/62214\n+\t* frontend-passes.c (optimize_binop_array_assignment):\n+\tDo not try to optimize the array assignment for string\n+\tconcatenation.\n+\n 2014-08-21  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n \n \tPR fortran/44054"}, {"sha": "23a8ece17ee8b99240343caac5b4e3f523c56e14", "filename": "gcc/fortran/frontend-passes.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ffortran%2Ffrontend-passes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ffortran%2Ffrontend-passes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ffrontend-passes.c?ref=dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "patch": "@@ -903,6 +903,10 @@ optimize_binop_array_assignment (gfc_code *c, gfc_expr **rhs, bool seen_op)\n \t    return true;\n \t  break;\n \n+\tcase INTRINSIC_CONCAT:\n+\t  /* Do not do string concatenations.  */\n+\t  break;\n+\n \tdefault:\n \t  /* Binary operators.  */\n \t  if (optimize_binop_array_assignment (c, &e->value.op.op1, true))"}, {"sha": "53fed571851c698be7ed52476936e9ff401c5c7d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "patch": "@@ -1,3 +1,8 @@\n+2014-08-21  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/62214\n+\t* gfortran.dg/array_assignment_5.f90:  New test.\n+\n 2014-08-21  Sandra Loosemore  <sandra@codesourcery.com>\n \n \t* lib/target-supports.exp\n@@ -9,7 +14,7 @@\n \t* gcc.dg/tree-ssa/interposition.c: Require fpic effective target\n \tfor test using -fPIC.\n \t* gcc.dg/lto/pr61526_0.c: Likewise.\n-\t\n+\n 2014-08-21  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR tree-optimization/62091"}, {"sha": "6d585270ceac1a48a77748be801df76ffc81f0a9", "filename": "gcc/testsuite/gfortran.dg/array_assignment_5.f90", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ftestsuite%2Fgfortran.dg%2Farray_assignment_5.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1/gcc%2Ftestsuite%2Fgfortran.dg%2Farray_assignment_5.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Farray_assignment_5.f90?ref=dc2c36fd935fd50c97bb03b5e3e2a9683f4271d1", "patch": "@@ -0,0 +1,16 @@\n+! { dg-do run }\n+! { dg-options \"-ffrontend-optimize\" }\n+! PR 62214 - this used to give the wrong result.\n+! Original test case by Oliver Fuhrer\n+PROGRAM test\n+  IMPLICIT NONE\n+  CHARACTER(LEN=20)   :: fullNames(2)\n+  CHARACTER(LEN=255)  :: pathName\n+  CHARACTER(LEN=5)    :: fileNames(2)\n+  \n+  pathName = \"/dir1/dir2/\"\n+  fileNames = (/ \"file1\", \"file2\" /)\n+  fullNames = SPREAD(TRIM(pathName),1,2) // fileNames\n+  if (fullNames(1) /= '/dir1/dir2/file1' .or. &\n+       & fullnames(2) /= '/dir1/dir2/file2') call abort\n+END PROGRAM test"}]}