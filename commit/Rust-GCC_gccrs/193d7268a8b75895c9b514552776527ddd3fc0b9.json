{"sha": "193d7268a8b75895c9b514552776527ddd3fc0b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTkzZDcyNjhhOGI3NTg5NWM5YjUxNDU1Mjc3NjUyN2RkZDNmYzBiOQ==", "commit": {"author": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2004-10-18T23:56:18Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2004-10-18T23:56:18Z"}, "message": "sbitmap.h (EXECUTE_IF_SET_IN_SBITMAP): Speed up by shifting the currently visited word to right.\n\n\t* sbitmap.h (EXECUTE_IF_SET_IN_SBITMAP): Speed up by shifting\n\tthe currently visited word to right.\n\nFrom-SVN: r89259", "tree": {"sha": "df439e236caf978e52207ade9766b30f9adaddab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/df439e236caf978e52207ade9766b30f9adaddab"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/193d7268a8b75895c9b514552776527ddd3fc0b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/193d7268a8b75895c9b514552776527ddd3fc0b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/193d7268a8b75895c9b514552776527ddd3fc0b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/193d7268a8b75895c9b514552776527ddd3fc0b9/comments", "author": null, "committer": null, "parents": [{"sha": "00268eb38766fd4c114f5fc53b43217eb06d7862", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00268eb38766fd4c114f5fc53b43217eb06d7862", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00268eb38766fd4c114f5fc53b43217eb06d7862"}], "stats": {"total": 32, "additions": 13, "deletions": 19}, "files": [{"sha": "e75e3b66df3069cf5d10a8517a1b092119463423", "filename": "gcc/sbitmap.h", "status": "modified", "additions": 13, "deletions": 19, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/193d7268a8b75895c9b514552776527ddd3fc0b9/gcc%2Fsbitmap.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/193d7268a8b75895c9b514552776527ddd3fc0b9/gcc%2Fsbitmap.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsbitmap.h?ref=193d7268a8b75895c9b514552776527ddd3fc0b9", "patch": "@@ -58,30 +58,24 @@ typedef SBITMAP_ELT_TYPE *sbitmap_ptr;\n /* Loop over all elements of SBITSET, starting with MIN.  */\n #define EXECUTE_IF_SET_IN_SBITMAP(SBITMAP, MIN, N, CODE)\t\t\\\n do {\t\t\t\t\t\t\t\t\t\\\n-  unsigned int word_num_;\t\t\t\t\t\t\\\n+  unsigned int word_num_ = (MIN) / (unsigned int) SBITMAP_ELT_BITS;\t\\\n   unsigned int bit_num_ = (MIN) % (unsigned int) SBITMAP_ELT_BITS;\t\\\n   unsigned int size_ = (SBITMAP)->size;\t\t\t\t\t\\\n   SBITMAP_ELT_TYPE *ptr_ = (SBITMAP)->elms;\t\t\t\t\\\n+  SBITMAP_ELT_TYPE word_ = ptr_[word_num_] >> bit_num_;\t\t\t\\\n \t\t\t\t\t\t\t\t\t\\\n-  for (word_num_ = (MIN) / (unsigned int) SBITMAP_ELT_BITS;\t\t\\\n-       word_num_ < size_; word_num_++, bit_num_ = 0)\t\t\t\\\n+  for (;\t\t\t\t\t\t\t\t\\\n+       word_num_ < size_;\t\t\t\t\t\t\\\n+       word_num_++, bit_num_ = 0, word_ = ptr_[word_num_])\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n-      SBITMAP_ELT_TYPE word_ = ptr_[word_num_];\t\t\t\t\\\n-\t\t\t\t\t\t\t\t\t\\\n-      if (word_ != 0)\t\t\t\t\t\t\t\\\n-\tfor (; bit_num_ < SBITMAP_ELT_BITS; bit_num_++)\t\t\t\\\n-\t  {\t\t\t\t\t\t\t\t\\\n-\t    SBITMAP_ELT_TYPE _mask = (SBITMAP_ELT_TYPE) 1 << bit_num_;\t\\\n-\t\t\t\t\t\t\t\t\t\\\n-\t    if ((word_ & _mask) != 0)\t\t\t\t\t\\\n-\t      {\t\t\t\t\t\t\t\t\\\n-\t\tword_ &= ~ _mask;\t\t\t\t\t\\\n-\t\t(N) = word_num_ * SBITMAP_ELT_BITS + bit_num_;\t\t\\\n-\t\tCODE;\t\t\t\t\t\t\t\\\n-\t\tif (word_ == 0)\t\t\t\t\t\t\\\n-\t\t  break;\t\t\t\t\t\t\\\n-\t      }\t\t\t\t\t\t\t\t\\\n-\t  }\t\t\t\t\t\t\t\t\\\n+      for (; word_ != 0; word_ >>= 1, bit_num_++)\t\t\t\\\n+\t{\t\t\t\t\t\t\t\t\\\n+\t  if ((word_ & 1) != 0)\t\t\t\t\t\t\\\n+\t    {\t\t\t\t\t\t\t\t\\\n+\t      (N) = word_num_ * SBITMAP_ELT_BITS + bit_num_;\t\t\\\n+\t      CODE;\t\t\t\t\t\t\t\\\n+\t    }\t\t\t\t\t\t\t\t\\\n+\t}\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n } while (0)\n "}]}