{"sha": "e52af9cac7fa7409c78c9f336dc1da57750c9766", "node_id": "C_kwDOANBUbNoAKGU1MmFmOWNhYzdmYTc0MDljNzhjOWYzMzZkYzFkYTU3NzUwYzk3NjY", "commit": {"author": {"name": "Roger Sayle", "email": "roger@nextmovesoftware.com", "date": "2022-03-08T23:33:46Z"}, "committer": {"name": "Roger Sayle", "email": "roger@nextmovesoftware.com", "date": "2022-03-08T23:33:46Z"}, "message": "PR c++/96440: ICE-on-invalid-code error recovery.\n\nThis patch fixes PR c++/96440 which is an ICE-on-invalid-code regression\naffecting mainline.\n\n2022-03-08  Roger Sayle  <roger@nextmovesoftware.com>\n\ngcc/cp/ChangeLog\n\tPR c++/96440\n\t* decl.cc (start_decl): Defend against prefix_attributes being\n\terror_mark_node.\n\ngcc/testsuite/ChangeLog\n\tPR c++/96440\n\t* g++.dg/cpp0x/pr96440.C: New test case.", "tree": {"sha": "56d5925c66c05c2491deaa2a98dc66a9ac43f9e3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/56d5925c66c05c2491deaa2a98dc66a9ac43f9e3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e52af9cac7fa7409c78c9f336dc1da57750c9766", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e52af9cac7fa7409c78c9f336dc1da57750c9766", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e52af9cac7fa7409c78c9f336dc1da57750c9766", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e52af9cac7fa7409c78c9f336dc1da57750c9766/comments", "author": {"login": "rogersayle", "id": 13512313, "node_id": "MDQ6VXNlcjEzNTEyMzEz", "avatar_url": "https://avatars.githubusercontent.com/u/13512313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rogersayle", "html_url": "https://github.com/rogersayle", "followers_url": "https://api.github.com/users/rogersayle/followers", "following_url": "https://api.github.com/users/rogersayle/following{/other_user}", "gists_url": "https://api.github.com/users/rogersayle/gists{/gist_id}", "starred_url": "https://api.github.com/users/rogersayle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rogersayle/subscriptions", "organizations_url": "https://api.github.com/users/rogersayle/orgs", "repos_url": "https://api.github.com/users/rogersayle/repos", "events_url": "https://api.github.com/users/rogersayle/events{/privacy}", "received_events_url": "https://api.github.com/users/rogersayle/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rogersayle", "id": 13512313, "node_id": "MDQ6VXNlcjEzNTEyMzEz", "avatar_url": "https://avatars.githubusercontent.com/u/13512313?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rogersayle", "html_url": "https://github.com/rogersayle", "followers_url": "https://api.github.com/users/rogersayle/followers", "following_url": "https://api.github.com/users/rogersayle/following{/other_user}", "gists_url": "https://api.github.com/users/rogersayle/gists{/gist_id}", "starred_url": "https://api.github.com/users/rogersayle/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rogersayle/subscriptions", "organizations_url": "https://api.github.com/users/rogersayle/orgs", "repos_url": "https://api.github.com/users/rogersayle/repos", "events_url": "https://api.github.com/users/rogersayle/events{/privacy}", "received_events_url": "https://api.github.com/users/rogersayle/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "48777d982add74cef14ec6704a622fce4d4a2609", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48777d982add74cef14ec6704a622fce4d4a2609", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48777d982add74cef14ec6704a622fce4d4a2609"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "de41b4de5ede41158e2f946c481b09a5eeb000e5", "filename": "gcc/cp/decl.cc", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52af9cac7fa7409c78c9f336dc1da57750c9766/gcc%2Fcp%2Fdecl.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52af9cac7fa7409c78c9f336dc1da57750c9766/gcc%2Fcp%2Fdecl.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.cc?ref=e52af9cac7fa7409c78c9f336dc1da57750c9766", "patch": "@@ -5483,13 +5483,15 @@ start_decl (const cp_declarator *declarator,\n \n   *pushed_scope_p = NULL_TREE;\n \n-  attributes = chainon (attributes, prefix_attributes);\n+  if (prefix_attributes != error_mark_node)\n+    attributes = chainon (attributes, prefix_attributes);\n \n   decl = grokdeclarator (declarator, declspecs, NORMAL, initialized,\n \t\t\t &attributes);\n \n   if (decl == NULL_TREE || VOID_TYPE_P (decl)\n-      || decl == error_mark_node)\n+      || decl == error_mark_node\n+      || prefix_attributes == error_mark_node)\n     return error_mark_node;\n \n   context = CP_DECL_CONTEXT (decl);"}, {"sha": "000caf3197dbac2fd64ac60cc0020f888f387cdc", "filename": "gcc/testsuite/g++.dg/cpp0x/pr96440.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e52af9cac7fa7409c78c9f336dc1da57750c9766/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr96440.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e52af9cac7fa7409c78c9f336dc1da57750c9766/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr96440.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr96440.C?ref=e52af9cac7fa7409c78c9f336dc1da57750c9766", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-excess-errors \"\" } */\n+\n+auto alignas a [[]] [[const]] ();"}]}