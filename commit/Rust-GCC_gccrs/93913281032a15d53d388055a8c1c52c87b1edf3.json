{"sha": "93913281032a15d53d388055a8c1c52c87b1edf3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTM5MTMyODEwMzJhMTVkNTNkMzg4MDU1YThjMWM1MmM4N2IxZWRmMw==", "commit": {"author": {"name": "Stan Shebs", "email": "shebs@apple.com", "date": "2001-09-04T20:58:19Z"}, "committer": {"name": "Stan Shebs", "email": "shebs@gcc.gnu.org", "date": "2001-09-04T20:58:19Z"}, "message": "darwin.h (ASM_DECLARE_FUNCTION_NAME): Define.\n\n        * config/darwin.h (ASM_DECLARE_FUNCTION_NAME): Define.\n        * config/darwin.c (machopic_stub_name): Account for internally\n        generated lib calls such as memcpy.\n\nFrom-SVN: r45385", "tree": {"sha": "17cebf8a784d26dc867f2cc1eecac92a4975cb9e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/17cebf8a784d26dc867f2cc1eecac92a4975cb9e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/93913281032a15d53d388055a8c1c52c87b1edf3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93913281032a15d53d388055a8c1c52c87b1edf3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93913281032a15d53d388055a8c1c52c87b1edf3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93913281032a15d53d388055a8c1c52c87b1edf3/comments", "author": null, "committer": null, "parents": [{"sha": "4c21ef03d15ae990db29e3ffb6a4be17cd458a59", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c21ef03d15ae990db29e3ffb6a4be17cd458a59", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c21ef03d15ae990db29e3ffb6a4be17cd458a59"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "9e6913c08d6c887714b6ccbe3326e4e52d3b042d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93913281032a15d53d388055a8c1c52c87b1edf3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93913281032a15d53d388055a8c1c52c87b1edf3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=93913281032a15d53d388055a8c1c52c87b1edf3", "patch": "@@ -1,3 +1,9 @@\n+2001-09-04  Stan Shebs  <shebs@apple.com>\n+\n+\t* config/darwin.h (ASM_DECLARE_FUNCTION_NAME): Define.\n+\t* config/darwin.c (machopic_stub_name): Account for internally\n+\tgenerated lib calls such as memcpy.\n+\n 2001-09-04  Richard Henderson  <rth@redhat.com>\n \n \t* unwind.h (_UA_END_OF_STACK): New flag."}, {"sha": "a46d46b7d5fff8addfd29d1eb7a4c5c7fbf003c4", "filename": "gcc/config/darwin.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93913281032a15d53d388055a8c1c52c87b1edf3/gcc%2Fconfig%2Fdarwin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93913281032a15d53d388055a8c1c52c87b1edf3/gcc%2Fconfig%2Fdarwin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.c?ref=93913281032a15d53d388055a8c1c52c87b1edf3", "patch": "@@ -324,14 +324,22 @@ machopic_stub_name (name)\n      const char *name;\n {\n   tree temp, ident = get_identifier (name);\n-  \n+  const char *tname;\n+\n   for (temp = machopic_stubs;\n        temp != NULL_TREE; \n        temp = TREE_CHAIN (temp))\n     {\n       if (ident == TREE_VALUE (temp))\n \treturn IDENTIFIER_POINTER (TREE_PURPOSE (temp));\n-      if (strcmp (name, IDENTIFIER_POINTER (TREE_VALUE (temp))) == 0)\n+      tname = IDENTIFIER_POINTER (TREE_VALUE (temp));\n+      if (strcmp (name, tname) == 0)\n+\treturn IDENTIFIER_POINTER (TREE_PURPOSE (temp));\n+      /* A library call name might not be section-encoded yet, so try\n+\t it against a stripped name.  */\n+      if (name[0] != '!'\n+\t  && tname[0] == '!'\n+\t  && strcmp (name, tname + 4) == 0)\n \treturn IDENTIFIER_POINTER (TREE_PURPOSE (temp));\n     }\n "}, {"sha": "9124307755c46012127ba2dbb0ae563d0f2827e3", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93913281032a15d53d388055a8c1c52c87b1edf3/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93913281032a15d53d388055a8c1c52c87b1edf3/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=93913281032a15d53d388055a8c1c52c87b1edf3", "patch": "@@ -215,6 +215,22 @@ do { text_section ();\t\t\t\t\t\t\t\\\n     ASM_OUTPUT_LABEL (FILE, xname);                                     \\\n   } while (0)\n \n+#define ASM_DECLARE_FUNCTION_NAME(FILE, NAME, DECL)                     \\\n+  do {\t\t\t\t\t\t\t\t\t\\\n+    char *xname = NAME;                                                 \\\n+    if (GET_CODE (XEXP (DECL_RTL (DECL), 0)) != SYMBOL_REF)             \\\n+      xname = IDENTIFIER_POINTER (DECL_NAME (DECL));                    \\\n+    if ((TREE_STATIC (DECL)                                             \\\n+\t && (!DECL_COMMON (DECL) || !TREE_PUBLIC (DECL)))               \\\n+        || DECL_INITIAL (DECL))                                         \\\n+      machopic_define_name (xname);                                     \\\n+    if ((TREE_STATIC (DECL)                                             \\\n+\t && (!DECL_COMMON (DECL) || !TREE_PUBLIC (DECL)))               \\\n+        || DECL_INITIAL (DECL))                                         \\\n+      ENCODE_SECTION_INFO (DECL);\t\t\t\t\t\\\n+    ASM_OUTPUT_LABEL (FILE, xname);                                     \\\n+  } while (0)\n+\n /* Wrap new method names in quotes so the assembler doesn't gag.\n    Make Objective-C internal symbols local.  */\n "}]}