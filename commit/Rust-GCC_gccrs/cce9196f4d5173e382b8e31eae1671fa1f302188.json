{"sha": "cce9196f4d5173e382b8e31eae1671fa1f302188", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2NlOTE5NmY0ZDUxNzNlMzgyYjhlMzFlYWUxNjcxZmExZjMwMjE4OA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-11-17T19:22:43Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-11-17T19:22:43Z"}, "message": "re PR c++/59123 ([c++11] can't forward-declare an object later defined constexpr)\n\n/cp\n2013-11-17  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/59123\n\t* decl.c (validate_constexpr_redeclaration): Redeclarations of\n\tvariables can differ in constexpr.\n\n/testsuite\n2013-11-17  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/59123\n\t* g++.dg/cpp0x/constexpr-redeclaration1.C: New.\n\t* g++.dg/cpp0x/constexpr-decl.C: Adjust.\n\nFrom-SVN: r204923", "tree": {"sha": "483fcf1dc18945fe85a739b84937042cd4f208c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/483fcf1dc18945fe85a739b84937042cd4f208c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cce9196f4d5173e382b8e31eae1671fa1f302188", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cce9196f4d5173e382b8e31eae1671fa1f302188", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cce9196f4d5173e382b8e31eae1671fa1f302188", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cce9196f4d5173e382b8e31eae1671fa1f302188/comments", "author": null, "committer": null, "parents": [{"sha": "a788747592b6d2d80ce20d8b1f1f3582ac80d4b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a788747592b6d2d80ce20d8b1f1f3582ac80d4b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a788747592b6d2d80ce20d8b1f1f3582ac80d4b7"}], "stats": {"total": 33, "additions": 28, "deletions": 5}, "files": [{"sha": "2729ec31f5d82fd5c62efb11e416aeaffd52b615", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=cce9196f4d5173e382b8e31eae1671fa1f302188", "patch": "@@ -1,3 +1,9 @@\n+2013-11-17  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/59123\n+\t* decl.c (validate_constexpr_redeclaration): Redeclarations of\n+\tvariables can differ in constexpr.\n+\n 2013-11-16  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/29143"}, {"sha": "34d73be3e78cad1cc0c4374b2c56241bfdafbb44", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=cce9196f4d5173e382b8e31eae1671fa1f302188", "patch": "@@ -1216,10 +1216,12 @@ validate_constexpr_redeclaration (tree old_decl, tree new_decl)\n       if (! DECL_TEMPLATE_SPECIALIZATION (old_decl)\n \t  && DECL_TEMPLATE_SPECIALIZATION (new_decl))\n \treturn true;\n+\n+      error (\"redeclaration %qD differs in %<constexpr%>\", new_decl);\n+      error (\"from previous declaration %q+D\", old_decl);\n+      return false;\n     }\n-  error (\"redeclaration %qD differs in %<constexpr%>\", new_decl);\n-  error (\"from previous declaration %q+D\", old_decl);\n-  return false;\n+  return true;\n }\n \n #define GNU_INLINE_P(fn) (DECL_DECLARED_INLINE_P (fn)\t\t\t\\"}, {"sha": "c58adf9e0dcc16ce320192881703876d4e56ec5b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cce9196f4d5173e382b8e31eae1671fa1f302188", "patch": "@@ -1,3 +1,9 @@\n+2013-11-17  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/59123\n+\t* g++.dg/cpp0x/constexpr-redeclaration1.C: New.\n+\t* g++.dg/cpp0x/constexpr-decl.C: Adjust.\n+\n 2013-11-16  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/29143"}, {"sha": "f16f12c0f19bb300bc0fcd5a1f192ebc71fd70b4", "filename": "gcc/testsuite/g++.dg/cpp0x/constexpr-decl.C", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-decl.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-decl.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-decl.C?ref=cce9196f4d5173e382b8e31eae1671fa1f302188", "patch": "@@ -3,8 +3,7 @@\n \n struct S {\n   static constexpr int size;\t// { dg-error \"must have an initializer\" \"must have\" }\n-  // { dg-error \"previous declaration\" \"previous\" { target *-*-* } 5 }\n };\n \n const int limit = 2 * S::size;\n-constexpr int S::size = 256;\t// { dg-error \"\" }\n+constexpr int S::size = 256;"}, {"sha": "6010b207555a03da730b4e637adf143f14f1a7bc", "filename": "gcc/testsuite/g++.dg/cpp0x/constexpr-redeclaration1.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-redeclaration1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cce9196f4d5173e382b8e31eae1671fa1f302188/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-redeclaration1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-redeclaration1.C?ref=cce9196f4d5173e382b8e31eae1671fa1f302188", "patch": "@@ -0,0 +1,10 @@\n+// PR c++/59123\n+// { dg-do compile { target c++11 } }\n+\n+// Fwd-declarations\n+struct S;\n+extern const S s;\n+\n+// (... later) definitions\n+struct S {};\n+constexpr S s {};"}]}