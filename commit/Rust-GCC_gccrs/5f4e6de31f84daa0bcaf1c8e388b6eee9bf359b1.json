{"sha": "5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWY0ZTZkZTMxZjg0ZGFhMGJjYWYxYzhlMzg4YjZlZWU5YmYzNTliMQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2013-01-08T08:33:43Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2013-01-08T08:33:43Z"}, "message": "re PR middle-end/54120 (FAIL: gfortran.fortran-torture/execute/random_2.f90 execution)\n\n\tPR tree-optimization/54120\n\t* tree-vrp.c (range_fits_type_p): Don't allow\n\tsrc_precision < precision from signed vr to unsigned_p\n\tif vr->min or vr->max is negative.\n\t(simplify_float_conversion_using_ranges): Test can_float_p\n\tagainst CODE_FOR_nothing.\n\nFrom-SVN: r195007", "tree": {"sha": "f190aae31de304afb5679e09bf3ee921fb35dab5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f190aae31de304afb5679e09bf3ee921fb35dab5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f3ef18ffa0d5facc961caab9c0244b6390e66096", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f3ef18ffa0d5facc961caab9c0244b6390e66096", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f3ef18ffa0d5facc961caab9c0244b6390e66096"}], "stats": {"total": 19, "additions": 15, "deletions": 4}, "files": [{"sha": "379de4d78d42ae6119739611832086030f235f29", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1", "patch": "@@ -1,3 +1,12 @@\n+2013-01-08  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/54120\n+\t* tree-vrp.c (range_fits_type_p): Don't allow\n+\tsrc_precision < precision from signed vr to unsigned_p\n+\tif vr->min or vr->max is negative.\n+\t(simplify_float_conversion_using_ranges): Test can_float_p\n+\tagainst CODE_FOR_nothing.\n+\n 2013-01-08  Jakub Jelinek  <jakub@redhat.com>\n \t    Richard Biener  <rguenther@suse.de>\n "}, {"sha": "f6b1517ed89fb613d8c96c07fd065b8c6ba0dc9f", "filename": "gcc/tree-vrp.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1/gcc%2Ftree-vrp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1/gcc%2Ftree-vrp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vrp.c?ref=5f4e6de31f84daa0bcaf1c8e388b6eee9bf359b1", "patch": "@@ -1,5 +1,5 @@\n /* Support routines for Value Range Propagation (VRP).\n-   Copyright (C) 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012\n+   Copyright (C) 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013\n    Free Software Foundation, Inc.\n    Contributed by Diego Novillo <dnovillo@redhat.com>.\n \n@@ -8753,9 +8753,11 @@ range_fits_type_p (value_range_t *vr, unsigned precision, bool unsigned_p)\n       && !POINTER_TYPE_P (src_type))\n     return false;\n \n-  /* An extension is always fine, so is an identity transform.  */\n+  /* An extension is fine unless VR is signed and unsigned_p,\n+     and so is an identity transform.  */\n   src_precision = TYPE_PRECISION (TREE_TYPE (vr->min));\n-  if (src_precision < precision\n+  if ((src_precision < precision\n+       && !(unsigned_p && !TYPE_UNSIGNED (src_type)))\n       || (src_precision == precision\n \t  && TYPE_UNSIGNED (src_type) == unsigned_p))\n     return true;\n@@ -8813,7 +8815,7 @@ simplify_float_conversion_using_ranges (gimple_stmt_iterator *gsi, gimple stmt)\n     mode = TYPE_MODE (TREE_TYPE (rhs1));\n   /* If we can do the conversion in the current input mode do nothing.  */\n   else if (can_float_p (fltmode, TYPE_MODE (TREE_TYPE (rhs1)),\n-\t\t\tTYPE_UNSIGNED (TREE_TYPE (rhs1))))\n+\t\t\tTYPE_UNSIGNED (TREE_TYPE (rhs1))) != CODE_FOR_nothing)\n     return false;\n   /* Otherwise search for a mode we can use, starting from the narrowest\n      integer mode available.  */"}]}