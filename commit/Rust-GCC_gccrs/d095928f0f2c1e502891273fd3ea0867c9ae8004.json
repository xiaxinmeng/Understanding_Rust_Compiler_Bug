{"sha": "d095928f0f2c1e502891273fd3ea0867c9ae8004", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDA5NTkyOGYwZjJjMWU1MDI4OTEyNzNmZDNlYTA4NjdjOWFlODAwNA==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2004-02-27T02:14:41Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@gcc.gnu.org", "date": "2004-02-27T02:14:41Z"}, "message": "rs6000.md: Add fixuns_truncsfsi2 and fix_truncsfsi2.\n\n2004-02-26  Aldy Hernandez  <aldyh@redhat.com>\n\n\t* config/rs6000/rs6000.md: Add fixuns_truncsfsi2 and\n\tfix_truncsfsi2.\n\n\t* config/rs6000/spe.md: Delete spe_efsctuiz.\n\tAdd spe_fixuns_truncsfsi2.\n\tAdd spe_fix_truncsfsi2.\n\n[[Split portion of a mixed commit.]]\n\nFrom-SVN: r78549.2", "tree": {"sha": "c5ec520ef1d511be31d24c23cc0f5253106b27c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c5ec520ef1d511be31d24c23cc0f5253106b27c9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d095928f0f2c1e502891273fd3ea0867c9ae8004", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d095928f0f2c1e502891273fd3ea0867c9ae8004", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d095928f0f2c1e502891273fd3ea0867c9ae8004", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d095928f0f2c1e502891273fd3ea0867c9ae8004/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2152660651dd8d705e788e30dc9e6baa68706ab3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2152660651dd8d705e788e30dc9e6baa68706ab3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2152660651dd8d705e788e30dc9e6baa68706ab3"}], "stats": {"total": 48, "additions": 31, "deletions": 17}, "files": [{"sha": "cb4c1fc188b0d8c6b3818a9e76b5a847ee5db264", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d095928f0f2c1e502891273fd3ea0867c9ae8004/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d095928f0f2c1e502891273fd3ea0867c9ae8004/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d095928f0f2c1e502891273fd3ea0867c9ae8004", "patch": "@@ -1,3 +1,12 @@\n+2004-02-26  Aldy Hernandez  <aldyh@redhat.com>\n+\n+\t* config/rs6000/rs6000.md: Add fixuns_truncsfsi2 and\n+\tfix_truncsfsi2.\n+\n+\t* config/rs6000/spe.md: Delete spe_efsctuiz.\n+\tAdd spe_fixuns_truncsfsi2.\n+\tAdd spe_fix_truncsfsi2.\n+ \n 2004-02-26  Eric Christopher  <echristo@redhat.com>\n \n \t* c-lex.c (c_lex_string_translate): New variable."}, {"sha": "af0d781d148bf882c35772da32c95fcfc26365e1", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d095928f0f2c1e502891273fd3ea0867c9ae8004/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d095928f0f2c1e502891273fd3ea0867c9ae8004/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=d095928f0f2c1e502891273fd3ea0867c9ae8004", "patch": "@@ -4959,6 +4959,20 @@\n   \"fsel %0,%1,%2,%3\"\n   [(set_attr \"type\" \"fp\")])\n \f\n+;; Conversions to and from floating-point.\n+\n+(define_expand \"fixuns_truncsfsi2\"\n+  [(set (match_operand:SI 0 \"gpc_reg_operand\" \"\")\n+\t(unsigned_fix:SI (match_operand:SF 1 \"gpc_reg_operand\" \"\")))]\n+  \"TARGET_HARD_FLOAT && !TARGET_FPRS\"\n+  \"\")\n+\n+(define_expand \"fix_truncsfsi2\"\n+  [(set (match_operand:SI 0 \"gpc_reg_operand\" \"\")\n+\t(fix:SI (match_operand:SF 1 \"gpc_reg_operand\" \"\")))]\n+  \"TARGET_HARD_FLOAT && !TARGET_FPRS\"\n+  \"\")\n+\n ; For each of these conversions, there is a define_expand, a define_insn\n ; with a '#' template, and a define_split (with C code).  The idea is\n ; to allow constant folding with the template of the define_insn,"}, {"sha": "cd4771f6096d76ca6190efe3968ccb0b58c9e9de", "filename": "gcc/config/rs6000/spe.md", "status": "modified", "additions": 8, "deletions": 17, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d095928f0f2c1e502891273fd3ea0867c9ae8004/gcc%2Fconfig%2Frs6000%2Fspe.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d095928f0f2c1e502891273fd3ea0867c9ae8004/gcc%2Fconfig%2Frs6000%2Fspe.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fspe.md?ref=d095928f0f2c1e502891273fd3ea0867c9ae8004", "patch": "@@ -76,28 +76,19 @@\n   \"efsdiv %0,%1,%2\"\n   [(set_attr \"type\" \"vecfdiv\")])\n \n-(define_insn \"spe_efsctuiz\"\n+(define_insn \"spe_fixuns_truncsfsi2\"\n   [(set (match_operand:SI 0 \"gpc_reg_operand\" \"=r\")\n-        (unspec:SI [(match_operand:SF 1 \"gpc_reg_operand\" \"r\")] 700))]\n+\t(unsigned_fix:SI (match_operand:SF 1 \"gpc_reg_operand\" \"r\")))]\n   \"TARGET_HARD_FLOAT && !TARGET_FPRS\"\n   \"efsctuiz %0,%1\"\n   [(set_attr \"type\" \"fp\")])\n \n-; These instructions aren't IEEE compliant.  They get some corner cases\n-; wrong.  Don't enable them!\n-;(define_insn \"spe_fixuns_truncsfsi2\"\n-;  [(set (match_operand:SI 0 \"gpc_reg_operand\" \"=r\")\n-;\t(unsigned_fix:SI (match_operand:SF 1 \"gpc_reg_operand\" \"r\")))]\n-;  \"TARGET_HARD_FLOAT && !TARGET_FPRS\"\n-;  \"efsctui %0,%1\"\n-;  [(set_attr \"type\" \"fp\")])\n-;\n-;(define_insn \"spe_fix_truncsfsi2\"\n-;  [(set (match_operand:SI 0 \"gpc_reg_operand\" \"=r\")\n-;\t(fix:SI (match_operand:SF 1 \"gpc_reg_operand\" \"r\")))]\n-;  \"TARGET_HARD_FLOAT && !TARGET_FPRS\"\n-;  \"efsctsi %0,%1\"\n-;  [(set_attr \"type\" \"fp\")])\n+(define_insn \"spe_fix_truncsfsi2\"\n+  [(set (match_operand:SI 0 \"gpc_reg_operand\" \"=r\")\n+\t(fix:SI (match_operand:SF 1 \"gpc_reg_operand\" \"r\")))]\n+  \"TARGET_HARD_FLOAT && !TARGET_FPRS\"\n+  \"efsctsiz %0,%1\"\n+  [(set_attr \"type\" \"fp\")])\n \n (define_insn \"spe_floatunssisf2\"\n   [(set (match_operand:SF 0 \"gpc_reg_operand\" \"=r\")"}]}