{"sha": "0d667716cb63716aefc44dce80607afad25ad28c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGQ2Njc3MTZjYjYzNzE2YWVmYzQ0ZGNlODA2MDdhZmFkMjVhZDI4Yw==", "commit": {"author": {"name": "Kaveh R. Ghazi", "email": "ghazi@caip.rutgers.edu", "date": "2005-04-11T21:46:59Z"}, "committer": {"name": "Kaveh Ghazi", "email": "ghazi@gcc.gnu.org", "date": "2005-04-11T21:46:59Z"}, "message": "configure.ac (fixincludes_UNLOCKED_FUNCS): New.\n\nfixincludes:\n\t* configure.ac (fixincludes_UNLOCKED_FUNCS): New.\n\t(AC_CHECK_FUNCS, AC_CHECK_DECLS): Check for fixincludes_UNLOCKED_FUNCS.\n\t* system.h (putchar, getc, getchar, clearerr, feof, fileno,\n\tfflush, fgetc, fgets, ferror, fread): Redefine to the associated\n\t_unlocked function.\n\t(fwrite_unlocked): Fix prototype.\n\n\t* configure, config.h.in: Regenerate.\n\ngcc:\n\tPR/17092\n\t* configure.ac (gcc_UNLOCKED_FUNCS): New.\n\t(AC_CHECK_FUNCS, AC_CHECK_DECLS): Check for gcc_UNLOCKED_FUNCS.\n\t* system.h (putchar, getc, getchar, clearerr, feof, fileno,\n\tfflush, fgetc, fgets, ferror, fread): Redefine to the associated\n\t_unlocked function.\n\t(fwrite_unlocked): Fix prototype.\n\n\t* configure, config.in: Regenerate.\n\nlibcpp:\n\t* configure.ac (libcpp_UNLOCKED_FUNCS): New.\n\t(AC_CHECK_FUNCS, AC_CHECK_DECLS): Check for libcpp_UNLOCKED_FUNCS.\n\t* system.h (putchar, getc, getchar, clearerr, feof, fileno,\n\tfflush, fgetc, fgets, ferror, fread): Redefine to the associated\n\t_unlocked function.\n\t(fwrite_unlocked): Fix prototype.\n\n\t* configure, config.in: Regenerate.\n\nFrom-SVN: r97986", "tree": {"sha": "bcbd909493a495297ca2b985d2ff663a494ec0d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bcbd909493a495297ca2b985d2ff663a494ec0d9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0d667716cb63716aefc44dce80607afad25ad28c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d667716cb63716aefc44dce80607afad25ad28c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d667716cb63716aefc44dce80607afad25ad28c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d667716cb63716aefc44dce80607afad25ad28c/comments", "author": null, "committer": null, "parents": [{"sha": "37cca405546085f77cff5a0bacc334c77422587f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37cca405546085f77cff5a0bacc334c77422587f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37cca405546085f77cff5a0bacc334c77422587f"}], "stats": {"total": 2320, "additions": 2193, "deletions": 127}, "files": [{"sha": "d6129d6a8ec26a6f7696fa39ff47ab7df0b0d8cb", "filename": "fixincludes/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2FChangeLog?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -1,3 +1,14 @@\n+2005-04-11  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\t* configure.ac (fixincludes_UNLOCKED_FUNCS): New.\n+\t(AC_CHECK_FUNCS, AC_CHECK_DECLS): Check for fixincludes_UNLOCKED_FUNCS.\n+\t* system.h (putchar, getc, getchar, clearerr, feof, fileno,\n+\tfflush, fgetc, fgets, ferror, fread): Redefine to the associated\n+\t_unlocked function.\n+\t(fwrite_unlocked): Fix prototype.\n+\t\n+\t* configure, config.h.in: Regenerate.\n+\n 2005-03-21  Zack Weinberg  <zack@codesourcery.com>\n \n \t* Makefile.in: Set gcc_version directly, not via substitution."}, {"sha": "a067b8dbdfab0b18998456c10ac1d76eb9df0baa", "filename": "fixincludes/config.h.in", "status": "modified", "additions": 77, "deletions": 0, "changes": 77, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Fconfig.h.in?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -3,14 +3,45 @@\n /* Defined to the executable file extension on the host system */\n #undef EXE_EXT\n \n+/* Define to 1 if you have the `clearerr_unlocked' function. */\n+#undef HAVE_CLEARERR_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `abort', and to 0 if you don't.\n    */\n #undef HAVE_DECL_ABORT\n \n+/* Define to 1 if you have the declaration of `clearerr_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_CLEARERR_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `errno', and to 0 if you don't.\n    */\n #undef HAVE_DECL_ERRNO\n \n+/* Define to 1 if you have the declaration of `feof_unlocked', and to 0 if you\n+   don't. */\n+#undef HAVE_DECL_FEOF_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `ferror_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FERROR_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fflush_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FFLUSH_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fgetc_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FGETC_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fgets_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FGETS_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fileno_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FILENO_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `fprintf_unlocked', and to 0 if\n    you don't. */\n #undef HAVE_DECL_FPRINTF_UNLOCKED\n@@ -23,17 +54,51 @@\n    you don't. */\n #undef HAVE_DECL_FPUTS_UNLOCKED\n \n+/* Define to 1 if you have the declaration of `fread_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FREAD_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `fwrite_unlocked', and to 0 if\n    you don't. */\n #undef HAVE_DECL_FWRITE_UNLOCKED\n \n+/* Define to 1 if you have the declaration of `getchar_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_GETCHAR_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `getc_unlocked', and to 0 if you\n+   don't. */\n+#undef HAVE_DECL_GETC_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `putchar_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_PUTCHAR_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `putc_unlocked', and to 0 if you\n    don't. */\n #undef HAVE_DECL_PUTC_UNLOCKED\n \n /* Define to 1 if you have the <fcntl.h> header file. */\n #undef HAVE_FCNTL_H\n \n+/* Define to 1 if you have the `feof_unlocked' function. */\n+#undef HAVE_FEOF_UNLOCKED\n+\n+/* Define to 1 if you have the `ferror_unlocked' function. */\n+#undef HAVE_FERROR_UNLOCKED\n+\n+/* Define to 1 if you have the `fflush_unlocked' function. */\n+#undef HAVE_FFLUSH_UNLOCKED\n+\n+/* Define to 1 if you have the `fgetc_unlocked' function. */\n+#undef HAVE_FGETC_UNLOCKED\n+\n+/* Define to 1 if you have the `fgets_unlocked' function. */\n+#undef HAVE_FGETS_UNLOCKED\n+\n+/* Define to 1 if you have the `fileno_unlocked' function. */\n+#undef HAVE_FILENO_UNLOCKED\n+\n /* Define to 1 if you have the `fprintf_unlocked' function. */\n #undef HAVE_FPRINTF_UNLOCKED\n \n@@ -43,9 +108,18 @@\n /* Define to 1 if you have the `fputs_unlocked' function. */\n #undef HAVE_FPUTS_UNLOCKED\n \n+/* Define to 1 if you have the `fread_unlocked' function. */\n+#undef HAVE_FREAD_UNLOCKED\n+\n /* Define to 1 if you have the `fwrite_unlocked' function. */\n #undef HAVE_FWRITE_UNLOCKED\n \n+/* Define to 1 if you have the `getchar_unlocked' function. */\n+#undef HAVE_GETCHAR_UNLOCKED\n+\n+/* Define to 1 if you have the `getc_unlocked' function. */\n+#undef HAVE_GETC_UNLOCKED\n+\n /* Define to 1 if you have the <inttypes.h> header file. */\n #undef HAVE_INTTYPES_H\n \n@@ -61,6 +135,9 @@\n /* Define if read-only mmap of a plain file works. */\n #undef HAVE_MMAP_FILE\n \n+/* Define to 1 if you have the `putchar_unlocked' function. */\n+#undef HAVE_PUTCHAR_UNLOCKED\n+\n /* Define to 1 if you have the `putc_unlocked' function. */\n #undef HAVE_PUTC_UNLOCKED\n "}, {"sha": "c4b2494f43b3d0b7049930e5c38d9277e8bdd2ef", "filename": "fixincludes/configure", "status": "modified", "additions": 831, "deletions": 50, "changes": 881, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Fconfigure?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -3098,8 +3098,19 @@ done\n \n \n \n-for ac_func in putc_unlocked fputc_unlocked fputs_unlocked \\\n-        fwrite_unlocked fprintf_unlocked\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+for ac_func in clearerr_unlocked feof_unlocked   ferror_unlocked fflush_unlocked fgetc_unlocked fgets_unlocked   fileno_unlocked fprintf_unlocked fputc_unlocked fputs_unlocked   fread_unlocked fwrite_unlocked getchar_unlocked getc_unlocked   putchar_unlocked putc_unlocked\n do\n as_ac_var=`echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n echo \"$as_me:$LINENO: checking for $ac_func\" >&5\n@@ -3340,9 +3351,9 @@ _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether putc_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether putc_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_putc_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether clearerr_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether clearerr_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_clearerr_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -3355,8 +3366,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef putc_unlocked\n-  char *p = (char *) putc_unlocked;\n+#ifndef clearerr_unlocked\n+  char *p = (char *) clearerr_unlocked;\n #endif\n \n   ;\n@@ -3385,34 +3396,34 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_putc_unlocked=yes\n+  ac_cv_have_decl_clearerr_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_putc_unlocked=no\n+ac_cv_have_decl_clearerr_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_putc_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_putc_unlocked\" >&6\n-if test $ac_cv_have_decl_putc_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_clearerr_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_clearerr_unlocked\" >&6\n+if test $ac_cv_have_decl_clearerr_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_PUTC_UNLOCKED 1\n+#define HAVE_DECL_CLEARERR_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_PUTC_UNLOCKED 0\n+#define HAVE_DECL_CLEARERR_UNLOCKED 0\n _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether fputc_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether fputc_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_fputc_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether feof_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether feof_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_feof_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -3425,8 +3436,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef fputc_unlocked\n-  char *p = (char *) fputc_unlocked;\n+#ifndef feof_unlocked\n+  char *p = (char *) feof_unlocked;\n #endif\n \n   ;\n@@ -3455,34 +3466,34 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_fputc_unlocked=yes\n+  ac_cv_have_decl_feof_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_fputc_unlocked=no\n+ac_cv_have_decl_feof_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputc_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_fputc_unlocked\" >&6\n-if test $ac_cv_have_decl_fputc_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_feof_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_feof_unlocked\" >&6\n+if test $ac_cv_have_decl_feof_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTC_UNLOCKED 1\n+#define HAVE_DECL_FEOF_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTC_UNLOCKED 0\n+#define HAVE_DECL_FEOF_UNLOCKED 0\n _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether fputs_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether fputs_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_fputs_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether ferror_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether ferror_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_ferror_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -3495,8 +3506,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef fputs_unlocked\n-  char *p = (char *) fputs_unlocked;\n+#ifndef ferror_unlocked\n+  char *p = (char *) ferror_unlocked;\n #endif\n \n   ;\n@@ -3525,34 +3536,34 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_fputs_unlocked=yes\n+  ac_cv_have_decl_ferror_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_fputs_unlocked=no\n+ac_cv_have_decl_ferror_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputs_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_fputs_unlocked\" >&6\n-if test $ac_cv_have_decl_fputs_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_ferror_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_ferror_unlocked\" >&6\n+if test $ac_cv_have_decl_ferror_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTS_UNLOCKED 1\n+#define HAVE_DECL_FERROR_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTS_UNLOCKED 0\n+#define HAVE_DECL_FERROR_UNLOCKED 0\n _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether fwrite_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether fwrite_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_fwrite_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether fflush_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fflush_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fflush_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -3565,8 +3576,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef fwrite_unlocked\n-  char *p = (char *) fwrite_unlocked;\n+#ifndef fflush_unlocked\n+  char *p = (char *) fflush_unlocked;\n #endif\n \n   ;\n@@ -3595,27 +3606,237 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_fwrite_unlocked=yes\n+  ac_cv_have_decl_fflush_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_fwrite_unlocked=no\n+ac_cv_have_decl_fflush_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fwrite_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_fwrite_unlocked\" >&6\n-if test $ac_cv_have_decl_fwrite_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fflush_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fflush_unlocked\" >&6\n+if test $ac_cv_have_decl_fflush_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FWRITE_UNLOCKED 1\n+#define HAVE_DECL_FFLUSH_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FWRITE_UNLOCKED 0\n+#define HAVE_DECL_FFLUSH_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fgetc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fgetc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fgetc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fgetc_unlocked\n+  char *p = (char *) fgetc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fgetc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fgetc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fgetc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fgetc_unlocked\" >&6\n+if test $ac_cv_have_decl_fgetc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETC_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fgets_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fgets_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fgets_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fgets_unlocked\n+  char *p = (char *) fgets_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fgets_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fgets_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fgets_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fgets_unlocked\" >&6\n+if test $ac_cv_have_decl_fgets_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETS_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETS_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fileno_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fileno_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fileno_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fileno_unlocked\n+  char *p = (char *) fileno_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fileno_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fileno_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fileno_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fileno_unlocked\" >&6\n+if test $ac_cv_have_decl_fileno_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FILENO_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FILENO_UNLOCKED 0\n _ACEOF\n \n \n@@ -3689,6 +3910,566 @@ else\n _ACEOF\n \n \n+fi\n+echo \"$as_me:$LINENO: checking whether fputc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fputc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fputc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fputc_unlocked\n+  char *p = (char *) fputc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fputc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fputc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fputc_unlocked\" >&6\n+if test $ac_cv_have_decl_fputc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTC_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fputs_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fputs_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fputs_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fputs_unlocked\n+  char *p = (char *) fputs_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fputs_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fputs_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputs_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fputs_unlocked\" >&6\n+if test $ac_cv_have_decl_fputs_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTS_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTS_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fread_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fread_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fread_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fread_unlocked\n+  char *p = (char *) fread_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fread_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fread_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fread_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fread_unlocked\" >&6\n+if test $ac_cv_have_decl_fread_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FREAD_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FREAD_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fwrite_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fwrite_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fwrite_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fwrite_unlocked\n+  char *p = (char *) fwrite_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fwrite_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fwrite_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fwrite_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fwrite_unlocked\" >&6\n+if test $ac_cv_have_decl_fwrite_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FWRITE_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FWRITE_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether getchar_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether getchar_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_getchar_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef getchar_unlocked\n+  char *p = (char *) getchar_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_getchar_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_getchar_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_getchar_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_getchar_unlocked\" >&6\n+if test $ac_cv_have_decl_getchar_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETCHAR_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETCHAR_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether getc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether getc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_getc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef getc_unlocked\n+  char *p = (char *) getc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_getc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_getc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_getc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_getc_unlocked\" >&6\n+if test $ac_cv_have_decl_getc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETC_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether putchar_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether putchar_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_putchar_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef putchar_unlocked\n+  char *p = (char *) putchar_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_putchar_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_putchar_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_putchar_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_putchar_unlocked\" >&6\n+if test $ac_cv_have_decl_putchar_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTCHAR_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTCHAR_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether putc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether putc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_putc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef putc_unlocked\n+  char *p = (char *) putc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_putc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_putc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_putc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_putc_unlocked\" >&6\n+if test $ac_cv_have_decl_putc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTC_UNLOCKED 0\n+_ACEOF\n+\n+\n fi\n \n "}, {"sha": "46296049f3153c40fed7498814a0fb566e0f2ca5", "filename": "fixincludes/configure.ac", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Fconfigure.ac?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -66,10 +66,13 @@ AC_DEFINE_UNQUOTED([EXE_EXT], \"$ac_exeext\",\n AC_HEADER_STDC\n AC_CHECK_HEADERS([stddef.h stdlib.h strings.h unistd.h fcntl.h sys/file.h \\\n \tsys/stat.h])\n-AC_CHECK_FUNCS(putc_unlocked fputc_unlocked fputs_unlocked \\\n-        fwrite_unlocked fprintf_unlocked)\n-AC_CHECK_DECLS([abort, errno, putc_unlocked, fputc_unlocked,\n-        fputs_unlocked, fwrite_unlocked, fprintf_unlocked])\n+define(fixincludes_UNLOCKED_FUNCS, clearerr_unlocked feof_unlocked dnl\n+  ferror_unlocked fflush_unlocked fgetc_unlocked fgets_unlocked dnl\n+  fileno_unlocked fprintf_unlocked fputc_unlocked fputs_unlocked dnl\n+  fread_unlocked fwrite_unlocked getchar_unlocked getc_unlocked dnl\n+  putchar_unlocked putc_unlocked)\n+AC_CHECK_FUNCS(fixincludes_UNLOCKED_FUNCS)\n+AC_CHECK_DECLS(m4_split(m4_normalize(abort errno fixincludes_UNLOCKED_FUNCS)))\n \n # Checks for typedefs, structures, and compiler characteristics.\n AC_C_CONST"}, {"sha": "4873d091cd6883003cab9adf8d9e88879f72dca6", "filename": "fixincludes/system.h", "status": "modified", "additions": 69, "deletions": 1, "changes": 70, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fsystem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/fixincludes%2Fsystem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Fsystem.h?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -57,23 +57,91 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n #  undef putc\n #  define putc(C, Stream) putc_unlocked (C, Stream)\n # endif\n+# ifdef HAVE_PUTCHAR_UNLOCKED\n+#  undef putchar\n+#  define putchar(C) putchar_unlocked (C)\n+# endif\n+# ifdef HAVE_GETC_UNLOCKED\n+#  undef getc\n+#  define getc(Stream) getc_unlocked (Stream)\n+# endif\n+# ifdef HAVE_GETCHAR_UNLOCKED\n+#  undef getchar\n+#  define getchar() getchar_unlocked ()\n+# endif\n # ifdef HAVE_FPUTC_UNLOCKED\n #  undef fputc\n #  define fputc(C, Stream) fputc_unlocked (C, Stream)\n # endif\n \n+# ifdef HAVE_CLEARERR_UNLOCKED\n+#  undef clearerr\n+#  define clearerr(Stream) clearerr_unlocked (Stream)\n+#  if defined (HAVE_DECL_CLEARERR_UNLOCKED) && !HAVE_DECL_CLEARERR_UNLOCKED\n+extern void clearerr_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FEOF_UNLOCKED\n+#  undef feof\n+#  define feof(Stream) feof_unlocked (Stream)\n+#  if defined (HAVE_DECL_FEOF_UNLOCKED) && !HAVE_DECL_FEOF_UNLOCKED\n+extern int feof_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FILENO_UNLOCKED\n+#  undef fileno\n+#  define fileno(Stream) fileno_unlocked (Stream)\n+#  if defined (HAVE_DECL_FILENO_UNLOCKED) && !HAVE_DECL_FILENO_UNLOCKED\n+extern int fileno_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FFLUSH_UNLOCKED\n+#  undef fflush\n+#  define fflush(Stream) fflush_unlocked (Stream)\n+#  if defined (HAVE_DECL_FFLUSH_UNLOCKED) && !HAVE_DECL_FFLUSH_UNLOCKED\n+extern int fflush_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FGETC_UNLOCKED\n+#  undef fgetc\n+#  define fgetc(Stream) fgetc_unlocked (Stream)\n+#  if defined (HAVE_DECL_FGETC_UNLOCKED) && !HAVE_DECL_FGETC_UNLOCKED\n+extern int fgetc_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FGETS_UNLOCKED\n+#  undef fgets\n+#  define fgets(S, n, Stream) fgets_unlocked (S, n, Stream)\n+#  if defined (HAVE_DECL_FGETS_UNLOCKED) && !HAVE_DECL_FGETS_UNLOCKED\n+extern char *fgets_unlocked (char *, int, FILE *);\n+#  endif\n+# endif\n # ifdef HAVE_FPUTS_UNLOCKED\n #  undef fputs\n #  define fputs(String, Stream) fputs_unlocked (String, Stream)\n #  if defined (HAVE_DECL_FPUTS_UNLOCKED) && !HAVE_DECL_FPUTS_UNLOCKED\n extern int fputs_unlocked (const char *, FILE *);\n #  endif\n # endif\n+# ifdef HAVE_FERROR_UNLOCKED\n+#  undef ferror\n+#  define ferror(Stream) ferror_unlocked (Stream)\n+#  if defined (HAVE_DECL_FERROR_UNLOCKED) && !HAVE_DECL_FERROR_UNLOCKED\n+extern int ferror_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FREAD_UNLOCKED\n+#  undef fread\n+#  define fread(Ptr, Size, N, Stream) fread_unlocked (Ptr, Size, N, Stream)\n+#  if defined (HAVE_DECL_FREAD_UNLOCKED) && !HAVE_DECL_FREAD_UNLOCKED\n+extern size_t fread_unlocked (void *, size_t, size_t, FILE *);\n+#  endif\n+# endif\n # ifdef HAVE_FWRITE_UNLOCKED\n #  undef fwrite\n #  define fwrite(Ptr, Size, N, Stream) fwrite_unlocked (Ptr, Size, N, Stream)\n #  if defined (HAVE_DECL_FWRITE_UNLOCKED) && !HAVE_DECL_FWRITE_UNLOCKED\n-extern int fwrite_unlocked (const void *, size_t, size_t, FILE *);\n+extern size_t fwrite_unlocked (const void *, size_t, size_t, FILE *);\n #  endif\n # endif\n # ifdef HAVE_FPRINTF_UNLOCKED"}, {"sha": "0c7d095d8886ae451ab64a7dd3c86b741ccb326e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -1,3 +1,15 @@\n+2005-04-11  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\tPR/17092\n+\t* configure.ac (gcc_UNLOCKED_FUNCS): New.\n+\t(AC_CHECK_FUNCS, AC_CHECK_DECLS): Check for gcc_UNLOCKED_FUNCS.\n+\t* system.h (putchar, getc, getchar, clearerr, feof, fileno,\n+\tfflush, fgetc, fgets, ferror, fread): Redefine to the associated\n+\t_unlocked function.\n+\t(fwrite_unlocked): Fix prototype.\n+\t\n+\t* configure, config.in: Regenerate.\n+\n 2005-04-11  David Edelsohn  <edelsohn@gnu.org>\n \n \t* tree-ssa-loop-im.c: Include real.h."}, {"sha": "996c2f8ff3b3e07965ecbf5cd0b153f527acfae5", "filename": "gcc/config.in", "status": "modified", "additions": 81, "deletions": 0, "changes": 81, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -145,6 +145,9 @@\n /* Define to 1 if you have the `atoq' function. */\n #undef HAVE_ATOQ\n \n+/* Define to 1 if you have the `clearerr_unlocked' function. */\n+#undef HAVE_CLEARERR_UNLOCKED\n+\n /* Define to 1 if you have the `clock' function. */\n #undef HAVE_CLOCK\n \n@@ -169,6 +172,10 @@\n    */\n #undef HAVE_DECL_CALLOC\n \n+/* Define to 1 if we found a declaration for 'clearerr_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_CLEARERR_UNLOCKED\n+\n /* Define to 1 if we found a declaration for 'clock', otherwise define to 0.\n    */\n #undef HAVE_DECL_CLOCK\n@@ -177,25 +184,65 @@\n    */\n #undef HAVE_DECL_ERRNO\n \n+/* Define to 1 if we found a declaration for 'feof_unlocked', otherwise define\n+   to 0. */\n+#undef HAVE_DECL_FEOF_UNLOCKED\n+\n+/* Define to 1 if we found a declaration for 'ferror_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_FERROR_UNLOCKED\n+\n+/* Define to 1 if we found a declaration for 'fflush_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_FFLUSH_UNLOCKED\n+\n+/* Define to 1 if we found a declaration for 'fgetc_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_FGETC_UNLOCKED\n+\n+/* Define to 1 if we found a declaration for 'fgets_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_FGETS_UNLOCKED\n+\n+/* Define to 1 if we found a declaration for 'fileno_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_FILENO_UNLOCKED\n+\n /* Define to 1 if we found a declaration for 'fprintf_unlocked', otherwise\n    define to 0. */\n #undef HAVE_DECL_FPRINTF_UNLOCKED\n \n+/* Define to 1 if we found a declaration for 'fputc_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_FPUTC_UNLOCKED\n+\n /* Define to 1 if we found a declaration for 'fputs_unlocked', otherwise\n    define to 0. */\n #undef HAVE_DECL_FPUTS_UNLOCKED\n \n+/* Define to 1 if we found a declaration for 'fread_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_FREAD_UNLOCKED\n+\n /* Define to 1 if we found a declaration for 'free', otherwise define to 0. */\n #undef HAVE_DECL_FREE\n \n /* Define to 1 if we found a declaration for 'fwrite_unlocked', otherwise\n    define to 0. */\n #undef HAVE_DECL_FWRITE_UNLOCKED\n \n+/* Define to 1 if we found a declaration for 'getchar_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_GETCHAR_UNLOCKED\n+\n /* Define to 1 if we found a declaration for 'getcwd', otherwise define to 0.\n    */\n #undef HAVE_DECL_GETCWD\n \n+/* Define to 1 if we found a declaration for 'getc_unlocked', otherwise define\n+   to 0. */\n+#undef HAVE_DECL_GETC_UNLOCKED\n+\n /* Define to 1 if we found a declaration for 'getenv', otherwise define to 0.\n    */\n #undef HAVE_DECL_GETENV\n@@ -228,6 +275,10 @@\n    */\n #undef HAVE_DECL_MALLOC\n \n+/* Define to 1 if we found a declaration for 'putchar_unlocked', otherwise\n+   define to 0. */\n+#undef HAVE_DECL_PUTCHAR_UNLOCKED\n+\n /* Define to 1 if we found a declaration for 'putc_unlocked', otherwise define\n    to 0. */\n #undef HAVE_DECL_PUTC_UNLOCKED\n@@ -272,6 +323,24 @@\n /* Define to 1 if you have the <fcntl.h> header file. */\n #undef HAVE_FCNTL_H\n \n+/* Define to 1 if you have the `feof_unlocked' function. */\n+#undef HAVE_FEOF_UNLOCKED\n+\n+/* Define to 1 if you have the `ferror_unlocked' function. */\n+#undef HAVE_FERROR_UNLOCKED\n+\n+/* Define to 1 if you have the `fflush_unlocked' function. */\n+#undef HAVE_FFLUSH_UNLOCKED\n+\n+/* Define to 1 if you have the `fgetc_unlocked' function. */\n+#undef HAVE_FGETC_UNLOCKED\n+\n+/* Define to 1 if you have the `fgets_unlocked' function. */\n+#undef HAVE_FGETS_UNLOCKED\n+\n+/* Define to 1 if you have the `fileno_unlocked' function. */\n+#undef HAVE_FILENO_UNLOCKED\n+\n /* Define to 1 if you have the `fork' function. */\n #undef HAVE_FORK\n \n@@ -284,6 +353,9 @@\n /* Define to 1 if you have the `fputs_unlocked' function. */\n #undef HAVE_FPUTS_UNLOCKED\n \n+/* Define to 1 if you have the `fread_unlocked' function. */\n+#undef HAVE_FREAD_UNLOCKED\n+\n /* Define to 1 if you have the `fwrite_unlocked' function. */\n #undef HAVE_FWRITE_UNLOCKED\n \n@@ -321,6 +393,12 @@\n /* Define if your assembler supports .weak. */\n #undef HAVE_GAS_WEAK\n \n+/* Define to 1 if you have the `getchar_unlocked' function. */\n+#undef HAVE_GETCHAR_UNLOCKED\n+\n+/* Define to 1 if you have the `getc_unlocked' function. */\n+#undef HAVE_GETC_UNLOCKED\n+\n /* Define to 1 if you have the `getrlimit' function. */\n #undef HAVE_GETRLIMIT\n \n@@ -421,6 +499,9 @@\n /* Define if printf supports \"%p\". */\n #undef HAVE_PRINTF_PTR\n \n+/* Define to 1 if you have the `putchar_unlocked' function. */\n+#undef HAVE_PUTCHAR_UNLOCKED\n+\n /* Define to 1 if you have the `putc_unlocked' function. */\n #undef HAVE_PUTC_UNLOCKED\n "}, {"sha": "1d96694c3ab6952ba980a500eaf6b96507acf8be", "filename": "gcc/configure", "status": "modified", "additions": 30, "deletions": 8, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -9002,6 +9002,18 @@ fi\n \n \n \n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n \n \n \n@@ -9012,10 +9024,9 @@ fi\n \n \n for ac_func in times clock dup2 kill getrlimit setrlimit atoll atoq \\\n-\tsysconf strsignal putc_unlocked fputc_unlocked fputs_unlocked \\\n-\tfwrite_unlocked fprintf_unlocked getrusage nl_langinfo \\\n-        scandir alphasort gettimeofday mbstowcs wcswidth mmap mincore \\\n-        setlocale\n+\tsysconf strsignal getrusage nl_langinfo scandir alphasort \\\n+\tgettimeofday mbstowcs wcswidth mmap mincore setlocale \\\n+\tclearerr_unlocked feof_unlocked   ferror_unlocked fflush_unlocked fgetc_unlocked fgets_unlocked   fileno_unlocked fprintf_unlocked fputc_unlocked fputs_unlocked   fread_unlocked fwrite_unlocked getchar_unlocked getc_unlocked   putchar_unlocked putc_unlocked\n do\n as_ac_var=`echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n echo \"$as_me:$LINENO: checking for $ac_func\" >&5\n@@ -11158,10 +11169,21 @@ CFLAGS=\"$CFLAGS -I${srcdir} -I${srcdir}/../include\"\n \n \n \n-for ac_func in getenv atol sbrk abort atof getcwd getwd \\\n-\tstrsignal putc_unlocked fputs_unlocked fwrite_unlocked \\\n-        fprintf_unlocked strstr errno snprintf vasprintf \\\n-\tmalloc realloc calloc free basename getopt clock getpagesize\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+for ac_func in getenv atol sbrk abort atof getcwd getwd strsignal \\\n+\tstrstr errno snprintf vasprintf malloc realloc calloc free \\\n+\tbasename getopt clock getpagesize clearerr_unlocked feof_unlocked   ferror_unlocked fflush_unlocked fgetc_unlocked fgets_unlocked   fileno_unlocked fprintf_unlocked fputc_unlocked fputs_unlocked   fread_unlocked fwrite_unlocked getchar_unlocked getc_unlocked   putchar_unlocked putc_unlocked\n do\n   ac_tr_decl=`echo \"HAVE_DECL_$ac_func\" | $as_tr_cpp`\n echo \"$as_me:$LINENO: checking whether $ac_func is declared\" >&5"}, {"sha": "a2239a5819e9e75421043d21deb7b3eae97cc9d0", "filename": "gcc/configure.ac", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -977,11 +977,15 @@ fi\n dnl Disabled until we have a complete test for buggy enum bitfields.\n dnl gcc_AC_C_ENUM_BF_UNSIGNED\n \n+define(gcc_UNLOCKED_FUNCS, clearerr_unlocked feof_unlocked dnl\n+  ferror_unlocked fflush_unlocked fgetc_unlocked fgets_unlocked dnl\n+  fileno_unlocked fprintf_unlocked fputc_unlocked fputs_unlocked dnl\n+  fread_unlocked fwrite_unlocked getchar_unlocked getc_unlocked dnl\n+  putchar_unlocked putc_unlocked)\n AC_CHECK_FUNCS(times clock dup2 kill getrlimit setrlimit atoll atoq \\\n-\tsysconf strsignal putc_unlocked fputc_unlocked fputs_unlocked \\\n-\tfwrite_unlocked fprintf_unlocked getrusage nl_langinfo \\\n-        scandir alphasort gettimeofday mbstowcs wcswidth mmap mincore \\\n-        setlocale)\n+\tsysconf strsignal getrusage nl_langinfo scandir alphasort \\\n+\tgettimeofday mbstowcs wcswidth mmap mincore setlocale \\\n+\tgcc_UNLOCKED_FUNCS)\n \n if test x$ac_cv_func_mbstowcs = xyes; then\n   AC_CACHE_CHECK(whether mbstowcs works, gcc_cv_func_mbstowcs_works,\n@@ -1048,10 +1052,9 @@ AM_LANGINFO_CODESET\n # We will need to find libiberty.h and ansidecl.h\n saved_CFLAGS=\"$CFLAGS\"\n CFLAGS=\"$CFLAGS -I${srcdir} -I${srcdir}/../include\"\n-gcc_AC_CHECK_DECLS(getenv atol sbrk abort atof getcwd getwd \\\n-\tstrsignal putc_unlocked fputs_unlocked fwrite_unlocked \\\n-        fprintf_unlocked strstr errno snprintf vasprintf \\\n-\tmalloc realloc calloc free basename getopt clock getpagesize, , ,[\n+gcc_AC_CHECK_DECLS(getenv atol sbrk abort atof getcwd getwd strsignal \\\n+\tstrstr errno snprintf vasprintf malloc realloc calloc free \\\n+\tbasename getopt clock getpagesize gcc_UNLOCKED_FUNCS, , ,[\n #include \"ansidecl.h\"\n #include \"system.h\"])\n "}, {"sha": "35581a097cc91ed41f1deed48ddcab693f69d4ad", "filename": "gcc/system.h", "status": "modified", "additions": 69, "deletions": 1, "changes": 70, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fsystem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/gcc%2Fsystem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsystem.h?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -65,23 +65,91 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n #  undef putc\n #  define putc(C, Stream) putc_unlocked (C, Stream)\n # endif\n+# ifdef HAVE_PUTCHAR_UNLOCKED\n+#  undef putchar\n+#  define putchar(C) putchar_unlocked (C)\n+# endif\n+# ifdef HAVE_GETC_UNLOCKED\n+#  undef getc\n+#  define getc(Stream) getc_unlocked (Stream)\n+# endif\n+# ifdef HAVE_GETCHAR_UNLOCKED\n+#  undef getchar\n+#  define getchar() getchar_unlocked ()\n+# endif\n # ifdef HAVE_FPUTC_UNLOCKED\n #  undef fputc\n #  define fputc(C, Stream) fputc_unlocked (C, Stream)\n # endif\n \n+# ifdef HAVE_CLEARERR_UNLOCKED\n+#  undef clearerr\n+#  define clearerr(Stream) clearerr_unlocked (Stream)\n+#  if defined (HAVE_DECL_CLEARERR_UNLOCKED) && !HAVE_DECL_CLEARERR_UNLOCKED\n+extern void clearerr_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FEOF_UNLOCKED\n+#  undef feof\n+#  define feof(Stream) feof_unlocked (Stream)\n+#  if defined (HAVE_DECL_FEOF_UNLOCKED) && !HAVE_DECL_FEOF_UNLOCKED\n+extern int feof_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FILENO_UNLOCKED\n+#  undef fileno\n+#  define fileno(Stream) fileno_unlocked (Stream)\n+#  if defined (HAVE_DECL_FILENO_UNLOCKED) && !HAVE_DECL_FILENO_UNLOCKED\n+extern int fileno_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FFLUSH_UNLOCKED\n+#  undef fflush\n+#  define fflush(Stream) fflush_unlocked (Stream)\n+#  if defined (HAVE_DECL_FFLUSH_UNLOCKED) && !HAVE_DECL_FFLUSH_UNLOCKED\n+extern int fflush_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FGETC_UNLOCKED\n+#  undef fgetc\n+#  define fgetc(Stream) fgetc_unlocked (Stream)\n+#  if defined (HAVE_DECL_FGETC_UNLOCKED) && !HAVE_DECL_FGETC_UNLOCKED\n+extern int fgetc_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FGETS_UNLOCKED\n+#  undef fgets\n+#  define fgets(S, n, Stream) fgets_unlocked (S, n, Stream)\n+#  if defined (HAVE_DECL_FGETS_UNLOCKED) && !HAVE_DECL_FGETS_UNLOCKED\n+extern char *fgets_unlocked (char *, int, FILE *);\n+#  endif\n+# endif\n # ifdef HAVE_FPUTS_UNLOCKED\n #  undef fputs\n #  define fputs(String, Stream) fputs_unlocked (String, Stream)\n #  if defined (HAVE_DECL_FPUTS_UNLOCKED) && !HAVE_DECL_FPUTS_UNLOCKED\n extern int fputs_unlocked (const char *, FILE *);\n #  endif\n # endif\n+# ifdef HAVE_FERROR_UNLOCKED\n+#  undef ferror\n+#  define ferror(Stream) ferror_unlocked (Stream)\n+#  if defined (HAVE_DECL_FERROR_UNLOCKED) && !HAVE_DECL_FERROR_UNLOCKED\n+extern int ferror_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FREAD_UNLOCKED\n+#  undef fread\n+#  define fread(Ptr, Size, N, Stream) fread_unlocked (Ptr, Size, N, Stream)\n+#  if defined (HAVE_DECL_FREAD_UNLOCKED) && !HAVE_DECL_FREAD_UNLOCKED\n+extern size_t fread_unlocked (void *, size_t, size_t, FILE *);\n+#  endif\n+# endif\n # ifdef HAVE_FWRITE_UNLOCKED\n #  undef fwrite\n #  define fwrite(Ptr, Size, N, Stream) fwrite_unlocked (Ptr, Size, N, Stream)\n #  if defined (HAVE_DECL_FWRITE_UNLOCKED) && !HAVE_DECL_FWRITE_UNLOCKED\n-extern int fwrite_unlocked (const void *, size_t, size_t, FILE *);\n+extern size_t fwrite_unlocked (const void *, size_t, size_t, FILE *);\n #  endif\n # endif\n # ifdef HAVE_FPRINTF_UNLOCKED"}, {"sha": "615118634c1aa9fb14c042f1e9222a8800b28a27", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -1,3 +1,14 @@\n+2005-04-11  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\t* configure.ac (libcpp_UNLOCKED_FUNCS): New.\n+\t(AC_CHECK_FUNCS, AC_CHECK_DECLS): Check for libcpp_UNLOCKED_FUNCS.\n+\t* system.h (putchar, getc, getchar, clearerr, feof, fileno,\n+\tfflush, fgetc, fgets, ferror, fread): Redefine to the associated\n+\t_unlocked function.\n+\t(fwrite_unlocked): Fix prototype.\n+\t\n+\t* configure, config.in: Regenerate.\n+\n 2005-04-05  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR preprocessor/19475"}, {"sha": "a302492406b9c06f98f4030d62dd3e32c4c62487", "filename": "libcpp/config.in", "status": "modified", "additions": 77, "deletions": 0, "changes": 77, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fconfig.in?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -22,6 +22,9 @@\n    */\n #undef HAVE_ALLOCA_H\n \n+/* Define to 1 if you have the `clearerr_unlocked' function. */\n+#undef HAVE_CLEARERR_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `abort', and to 0 if you don't.\n    */\n #undef HAVE_DECL_ABORT\n@@ -30,10 +33,38 @@\n    don't. */\n #undef HAVE_DECL_BASENAME\n \n+/* Define to 1 if you have the declaration of `clearerr_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_CLEARERR_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `errno', and to 0 if you don't.\n    */\n #undef HAVE_DECL_ERRNO\n \n+/* Define to 1 if you have the declaration of `feof_unlocked', and to 0 if you\n+   don't. */\n+#undef HAVE_DECL_FEOF_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `ferror_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FERROR_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fflush_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FFLUSH_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fgetc_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FGETC_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fgets_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FGETS_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `fileno_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FILENO_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `fprintf_unlocked', and to 0 if\n    you don't. */\n #undef HAVE_DECL_FPRINTF_UNLOCKED\n@@ -46,21 +77,55 @@\n    you don't. */\n #undef HAVE_DECL_FPUTS_UNLOCKED\n \n+/* Define to 1 if you have the declaration of `fread_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_FREAD_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `fwrite_unlocked', and to 0 if\n    you don't. */\n #undef HAVE_DECL_FWRITE_UNLOCKED\n \n+/* Define to 1 if you have the declaration of `getchar_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_GETCHAR_UNLOCKED\n+\n+/* Define to 1 if you have the declaration of `getc_unlocked', and to 0 if you\n+   don't. */\n+#undef HAVE_DECL_GETC_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `getopt', and to 0 if you don't.\n    */\n #undef HAVE_DECL_GETOPT\n \n+/* Define to 1 if you have the declaration of `putchar_unlocked', and to 0 if\n+   you don't. */\n+#undef HAVE_DECL_PUTCHAR_UNLOCKED\n+\n /* Define to 1 if you have the declaration of `putc_unlocked', and to 0 if you\n    don't. */\n #undef HAVE_DECL_PUTC_UNLOCKED\n \n /* Define to 1 if you have the <fcntl.h> header file. */\n #undef HAVE_FCNTL_H\n \n+/* Define to 1 if you have the `feof_unlocked' function. */\n+#undef HAVE_FEOF_UNLOCKED\n+\n+/* Define to 1 if you have the `ferror_unlocked' function. */\n+#undef HAVE_FERROR_UNLOCKED\n+\n+/* Define to 1 if you have the `fflush_unlocked' function. */\n+#undef HAVE_FFLUSH_UNLOCKED\n+\n+/* Define to 1 if you have the `fgetc_unlocked' function. */\n+#undef HAVE_FGETC_UNLOCKED\n+\n+/* Define to 1 if you have the `fgets_unlocked' function. */\n+#undef HAVE_FGETS_UNLOCKED\n+\n+/* Define to 1 if you have the `fileno_unlocked' function. */\n+#undef HAVE_FILENO_UNLOCKED\n+\n /* Define to 1 if you have the `fprintf_unlocked' function. */\n #undef HAVE_FPRINTF_UNLOCKED\n \n@@ -70,9 +135,18 @@\n /* Define to 1 if you have the `fputs_unlocked' function. */\n #undef HAVE_FPUTS_UNLOCKED\n \n+/* Define to 1 if you have the `fread_unlocked' function. */\n+#undef HAVE_FREAD_UNLOCKED\n+\n /* Define to 1 if you have the `fwrite_unlocked' function. */\n #undef HAVE_FWRITE_UNLOCKED\n \n+/* Define to 1 if you have the `getchar_unlocked' function. */\n+#undef HAVE_GETCHAR_UNLOCKED\n+\n+/* Define to 1 if you have the `getc_unlocked' function. */\n+#undef HAVE_GETC_UNLOCKED\n+\n /* Define if you have the iconv() function. */\n #undef HAVE_ICONV\n \n@@ -97,6 +171,9 @@\n /* Define to 1 if libc includes obstacks. */\n #undef HAVE_OBSTACK\n \n+/* Define to 1 if you have the `putchar_unlocked' function. */\n+#undef HAVE_PUTCHAR_UNLOCKED\n+\n /* Define to 1 if you have the `putc_unlocked' function. */\n #undef HAVE_PUTC_UNLOCKED\n "}, {"sha": "915b4cb77e02cfccffa2f1f0bf2cb10541885d5a", "filename": "libcpp/configure", "status": "modified", "additions": 831, "deletions": 50, "changes": 881, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fconfigure?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -4894,8 +4894,19 @@ _ACEOF\n \n \n \n-for ac_func in putc_unlocked fputc_unlocked fputs_unlocked \\\n-        fwrite_unlocked fprintf_unlocked\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+for ac_func in clearerr_unlocked feof_unlocked   ferror_unlocked fflush_unlocked fgetc_unlocked fgets_unlocked   fileno_unlocked fprintf_unlocked fputc_unlocked fputs_unlocked   fread_unlocked fwrite_unlocked getchar_unlocked getc_unlocked   putchar_unlocked putc_unlocked\n do\n as_ac_var=`echo \"ac_cv_func_$ac_func\" | $as_tr_sh`\n echo \"$as_me:$LINENO: checking for $ac_func\" >&5\n@@ -5276,9 +5287,9 @@ _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether putc_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether putc_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_putc_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether clearerr_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether clearerr_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_clearerr_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -5291,8 +5302,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef putc_unlocked\n-  char *p = (char *) putc_unlocked;\n+#ifndef clearerr_unlocked\n+  char *p = (char *) clearerr_unlocked;\n #endif\n \n   ;\n@@ -5321,34 +5332,34 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_putc_unlocked=yes\n+  ac_cv_have_decl_clearerr_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_putc_unlocked=no\n+ac_cv_have_decl_clearerr_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_putc_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_putc_unlocked\" >&6\n-if test $ac_cv_have_decl_putc_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_clearerr_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_clearerr_unlocked\" >&6\n+if test $ac_cv_have_decl_clearerr_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_PUTC_UNLOCKED 1\n+#define HAVE_DECL_CLEARERR_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_PUTC_UNLOCKED 0\n+#define HAVE_DECL_CLEARERR_UNLOCKED 0\n _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether fputc_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether fputc_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_fputc_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether feof_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether feof_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_feof_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -5361,8 +5372,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef fputc_unlocked\n-  char *p = (char *) fputc_unlocked;\n+#ifndef feof_unlocked\n+  char *p = (char *) feof_unlocked;\n #endif\n \n   ;\n@@ -5391,34 +5402,34 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_fputc_unlocked=yes\n+  ac_cv_have_decl_feof_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_fputc_unlocked=no\n+ac_cv_have_decl_feof_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputc_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_fputc_unlocked\" >&6\n-if test $ac_cv_have_decl_fputc_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_feof_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_feof_unlocked\" >&6\n+if test $ac_cv_have_decl_feof_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTC_UNLOCKED 1\n+#define HAVE_DECL_FEOF_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTC_UNLOCKED 0\n+#define HAVE_DECL_FEOF_UNLOCKED 0\n _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether fputs_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether fputs_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_fputs_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether ferror_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether ferror_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_ferror_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -5431,8 +5442,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef fputs_unlocked\n-  char *p = (char *) fputs_unlocked;\n+#ifndef ferror_unlocked\n+  char *p = (char *) ferror_unlocked;\n #endif\n \n   ;\n@@ -5461,34 +5472,34 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_fputs_unlocked=yes\n+  ac_cv_have_decl_ferror_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_fputs_unlocked=no\n+ac_cv_have_decl_ferror_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputs_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_fputs_unlocked\" >&6\n-if test $ac_cv_have_decl_fputs_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_ferror_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_ferror_unlocked\" >&6\n+if test $ac_cv_have_decl_ferror_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTS_UNLOCKED 1\n+#define HAVE_DECL_FERROR_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FPUTS_UNLOCKED 0\n+#define HAVE_DECL_FERROR_UNLOCKED 0\n _ACEOF\n \n \n fi\n-echo \"$as_me:$LINENO: checking whether fwrite_unlocked is declared\" >&5\n-echo $ECHO_N \"checking whether fwrite_unlocked is declared... $ECHO_C\" >&6\n-if test \"${ac_cv_have_decl_fwrite_unlocked+set}\" = set; then\n+echo \"$as_me:$LINENO: checking whether fflush_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fflush_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fflush_unlocked+set}\" = set; then\n   echo $ECHO_N \"(cached) $ECHO_C\" >&6\n else\n   cat >conftest.$ac_ext <<_ACEOF\n@@ -5501,8 +5512,8 @@ $ac_includes_default\n int\n main ()\n {\n-#ifndef fwrite_unlocked\n-  char *p = (char *) fwrite_unlocked;\n+#ifndef fflush_unlocked\n+  char *p = (char *) fflush_unlocked;\n #endif\n \n   ;\n@@ -5531,27 +5542,237 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   ac_status=$?\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); }; }; then\n-  ac_cv_have_decl_fwrite_unlocked=yes\n+  ac_cv_have_decl_fflush_unlocked=yes\n else\n   echo \"$as_me: failed program was:\" >&5\n sed 's/^/| /' conftest.$ac_ext >&5\n \n-ac_cv_have_decl_fwrite_unlocked=no\n+ac_cv_have_decl_fflush_unlocked=no\n fi\n rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n fi\n-echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fwrite_unlocked\" >&5\n-echo \"${ECHO_T}$ac_cv_have_decl_fwrite_unlocked\" >&6\n-if test $ac_cv_have_decl_fwrite_unlocked = yes; then\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fflush_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fflush_unlocked\" >&6\n+if test $ac_cv_have_decl_fflush_unlocked = yes; then\n \n cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FWRITE_UNLOCKED 1\n+#define HAVE_DECL_FFLUSH_UNLOCKED 1\n _ACEOF\n \n \n else\n   cat >>confdefs.h <<_ACEOF\n-#define HAVE_DECL_FWRITE_UNLOCKED 0\n+#define HAVE_DECL_FFLUSH_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fgetc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fgetc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fgetc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fgetc_unlocked\n+  char *p = (char *) fgetc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fgetc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fgetc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fgetc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fgetc_unlocked\" >&6\n+if test $ac_cv_have_decl_fgetc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETC_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fgets_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fgets_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fgets_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fgets_unlocked\n+  char *p = (char *) fgets_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fgets_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fgets_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fgets_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fgets_unlocked\" >&6\n+if test $ac_cv_have_decl_fgets_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETS_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FGETS_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fileno_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fileno_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fileno_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fileno_unlocked\n+  char *p = (char *) fileno_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fileno_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fileno_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fileno_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fileno_unlocked\" >&6\n+if test $ac_cv_have_decl_fileno_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FILENO_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FILENO_UNLOCKED 0\n _ACEOF\n \n \n@@ -5625,6 +5846,566 @@ else\n _ACEOF\n \n \n+fi\n+echo \"$as_me:$LINENO: checking whether fputc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fputc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fputc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fputc_unlocked\n+  char *p = (char *) fputc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fputc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fputc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fputc_unlocked\" >&6\n+if test $ac_cv_have_decl_fputc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTC_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fputs_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fputs_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fputs_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fputs_unlocked\n+  char *p = (char *) fputs_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fputs_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fputs_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fputs_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fputs_unlocked\" >&6\n+if test $ac_cv_have_decl_fputs_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTS_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FPUTS_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fread_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fread_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fread_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fread_unlocked\n+  char *p = (char *) fread_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fread_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fread_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fread_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fread_unlocked\" >&6\n+if test $ac_cv_have_decl_fread_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FREAD_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FREAD_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether fwrite_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether fwrite_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_fwrite_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef fwrite_unlocked\n+  char *p = (char *) fwrite_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_fwrite_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_fwrite_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_fwrite_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_fwrite_unlocked\" >&6\n+if test $ac_cv_have_decl_fwrite_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FWRITE_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_FWRITE_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether getchar_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether getchar_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_getchar_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef getchar_unlocked\n+  char *p = (char *) getchar_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_getchar_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_getchar_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_getchar_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_getchar_unlocked\" >&6\n+if test $ac_cv_have_decl_getchar_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETCHAR_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETCHAR_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether getc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether getc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_getc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef getc_unlocked\n+  char *p = (char *) getc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_getc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_getc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_getc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_getc_unlocked\" >&6\n+if test $ac_cv_have_decl_getc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_GETC_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether putchar_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether putchar_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_putchar_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef putchar_unlocked\n+  char *p = (char *) putchar_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_putchar_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_putchar_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_putchar_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_putchar_unlocked\" >&6\n+if test $ac_cv_have_decl_putchar_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTCHAR_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTCHAR_UNLOCKED 0\n+_ACEOF\n+\n+\n+fi\n+echo \"$as_me:$LINENO: checking whether putc_unlocked is declared\" >&5\n+echo $ECHO_N \"checking whether putc_unlocked is declared... $ECHO_C\" >&6\n+if test \"${ac_cv_have_decl_putc_unlocked+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+$ac_includes_default\n+int\n+main ()\n+{\n+#ifndef putc_unlocked\n+  char *p = (char *) putc_unlocked;\n+#endif\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_cv_have_decl_putc_unlocked=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_cv_have_decl_putc_unlocked=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+echo \"$as_me:$LINENO: result: $ac_cv_have_decl_putc_unlocked\" >&5\n+echo \"${ECHO_T}$ac_cv_have_decl_putc_unlocked\" >&6\n+if test $ac_cv_have_decl_putc_unlocked = yes; then\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTC_UNLOCKED 1\n+_ACEOF\n+\n+\n+else\n+  cat >>confdefs.h <<_ACEOF\n+#define HAVE_DECL_PUTC_UNLOCKED 0\n+_ACEOF\n+\n+\n fi\n \n "}, {"sha": "b56a7443619038093d3cb36fd414011b460f59a5", "filename": "libcpp/configure.ac", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fconfigure.ac?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -44,10 +44,13 @@ AC_TYPE_SIZE_T\n AC_STRUCT_TM\n AC_CHECK_SIZEOF(int)\n AC_CHECK_SIZEOF(long)\n-AC_CHECK_FUNCS(putc_unlocked fputc_unlocked fputs_unlocked \\\n-        fwrite_unlocked fprintf_unlocked)\n-AC_CHECK_DECLS([abort, basename, errno, getopt, putc_unlocked, fputc_unlocked,\n-        fputs_unlocked, fwrite_unlocked, fprintf_unlocked])\n+define(libcpp_UNLOCKED_FUNCS, clearerr_unlocked feof_unlocked dnl\n+  ferror_unlocked fflush_unlocked fgetc_unlocked fgets_unlocked dnl\n+  fileno_unlocked fprintf_unlocked fputc_unlocked fputs_unlocked dnl\n+  fread_unlocked fwrite_unlocked getchar_unlocked getc_unlocked dnl\n+  putchar_unlocked putc_unlocked)\n+AC_CHECK_FUNCS(libcpp_UNLOCKED_FUNCS)\n+AC_CHECK_DECLS(m4_split(m4_normalize(abort basename errno getopt libcpp_UNLOCKED_FUNCS)))\n \n # Checks for library functions.\n AC_FUNC_ALLOCA"}, {"sha": "560fa18406ba9f7ec4ef1ceee67e35a58617c418", "filename": "libcpp/system.h", "status": "modified", "additions": 69, "deletions": 1, "changes": 70, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fsystem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d667716cb63716aefc44dce80607afad25ad28c/libcpp%2Fsystem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fsystem.h?ref=0d667716cb63716aefc44dce80607afad25ad28c", "patch": "@@ -57,23 +57,91 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n #  undef putc\n #  define putc(C, Stream) putc_unlocked (C, Stream)\n # endif\n+# ifdef HAVE_PUTCHAR_UNLOCKED\n+#  undef putchar\n+#  define putchar(C) putchar_unlocked (C)\n+# endif\n+# ifdef HAVE_GETC_UNLOCKED\n+#  undef getc\n+#  define getc(Stream) getc_unlocked (Stream)\n+# endif\n+# ifdef HAVE_GETCHAR_UNLOCKED\n+#  undef getchar\n+#  define getchar() getchar_unlocked ()\n+# endif\n # ifdef HAVE_FPUTC_UNLOCKED\n #  undef fputc\n #  define fputc(C, Stream) fputc_unlocked (C, Stream)\n # endif\n \n+# ifdef HAVE_CLEARERR_UNLOCKED\n+#  undef clearerr\n+#  define clearerr(Stream) clearerr_unlocked (Stream)\n+#  if defined (HAVE_DECL_CLEARERR_UNLOCKED) && !HAVE_DECL_CLEARERR_UNLOCKED\n+extern void clearerr_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FEOF_UNLOCKED\n+#  undef feof\n+#  define feof(Stream) feof_unlocked (Stream)\n+#  if defined (HAVE_DECL_FEOF_UNLOCKED) && !HAVE_DECL_FEOF_UNLOCKED\n+extern int feof_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FILENO_UNLOCKED\n+#  undef fileno\n+#  define fileno(Stream) fileno_unlocked (Stream)\n+#  if defined (HAVE_DECL_FILENO_UNLOCKED) && !HAVE_DECL_FILENO_UNLOCKED\n+extern int fileno_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FFLUSH_UNLOCKED\n+#  undef fflush\n+#  define fflush(Stream) fflush_unlocked (Stream)\n+#  if defined (HAVE_DECL_FFLUSH_UNLOCKED) && !HAVE_DECL_FFLUSH_UNLOCKED\n+extern int fflush_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FGETC_UNLOCKED\n+#  undef fgetc\n+#  define fgetc(Stream) fgetc_unlocked (Stream)\n+#  if defined (HAVE_DECL_FGETC_UNLOCKED) && !HAVE_DECL_FGETC_UNLOCKED\n+extern int fgetc_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FGETS_UNLOCKED\n+#  undef fgets\n+#  define fgets(S, n, Stream) fgets_unlocked (S, n, Stream)\n+#  if defined (HAVE_DECL_FGETS_UNLOCKED) && !HAVE_DECL_FGETS_UNLOCKED\n+extern char *fgets_unlocked (char *, int, FILE *);\n+#  endif\n+# endif\n # ifdef HAVE_FPUTS_UNLOCKED\n #  undef fputs\n #  define fputs(String, Stream) fputs_unlocked (String, Stream)\n #  if defined (HAVE_DECL_FPUTS_UNLOCKED) && !HAVE_DECL_FPUTS_UNLOCKED\n extern int fputs_unlocked (const char *, FILE *);\n #  endif\n # endif\n+# ifdef HAVE_FERROR_UNLOCKED\n+#  undef ferror\n+#  define ferror(Stream) ferror_unlocked (Stream)\n+#  if defined (HAVE_DECL_FERROR_UNLOCKED) && !HAVE_DECL_FERROR_UNLOCKED\n+extern int ferror_unlocked (FILE *);\n+#  endif\n+# endif\n+# ifdef HAVE_FREAD_UNLOCKED\n+#  undef fread\n+#  define fread(Ptr, Size, N, Stream) fread_unlocked (Ptr, Size, N, Stream)\n+#  if defined (HAVE_DECL_FREAD_UNLOCKED) && !HAVE_DECL_FREAD_UNLOCKED\n+extern size_t fread_unlocked (void *, size_t, size_t, FILE *);\n+#  endif\n+# endif\n # ifdef HAVE_FWRITE_UNLOCKED\n #  undef fwrite\n #  define fwrite(Ptr, Size, N, Stream) fwrite_unlocked (Ptr, Size, N, Stream)\n #  if defined (HAVE_DECL_FWRITE_UNLOCKED) && !HAVE_DECL_FWRITE_UNLOCKED\n-extern int fwrite_unlocked (const void *, size_t, size_t, FILE *);\n+extern size_t fwrite_unlocked (const void *, size_t, size_t, FILE *);\n #  endif\n # endif\n # ifdef HAVE_FPRINTF_UNLOCKED"}]}