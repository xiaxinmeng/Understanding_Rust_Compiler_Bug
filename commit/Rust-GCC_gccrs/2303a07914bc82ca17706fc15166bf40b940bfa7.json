{"sha": "2303a07914bc82ca17706fc15166bf40b940bfa7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjMwM2EwNzkxNGJjODJjYTE3NzA2ZmMxNTE2NmJmNDBiOTQwYmZhNw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2002-10-17T00:17:59Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2002-10-17T00:17:59Z"}, "message": "re PR c++/7478 (internal compiler error on static_cast inside template)\n\n\tPR c++/7478\n\t* cvt.c (convert_to_reference): Allow references as the incoming\n\ttype.\n\n\tPR c++/7478\n\t* g++.dg/template/ref1.C: New test.\n\nFrom-SVN: r58230", "tree": {"sha": "c40ac826896b3368eb3837dde85eb3dabae7beaf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c40ac826896b3368eb3837dde85eb3dabae7beaf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2303a07914bc82ca17706fc15166bf40b940bfa7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2303a07914bc82ca17706fc15166bf40b940bfa7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2303a07914bc82ca17706fc15166bf40b940bfa7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2303a07914bc82ca17706fc15166bf40b940bfa7/comments", "author": null, "committer": null, "parents": [{"sha": "f9dd72da28d0932c200fb1885f350e9908186582", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f9dd72da28d0932c200fb1885f350e9908186582", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f9dd72da28d0932c200fb1885f350e9908186582"}], "stats": {"total": 24, "additions": 22, "deletions": 2}, "files": [{"sha": "80132effe86ddc3e8f0276e0d4af9bbb57ee045c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2303a07914bc82ca17706fc15166bf40b940bfa7", "patch": "@@ -1,3 +1,9 @@\n+2002-10-16  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/7478\n+\t* cvt.c (convert_to_reference): Allow references as the incoming\n+\ttype.\n+\n 2002-10-16  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/7524"}, {"sha": "7e31045a4854cf6cbd737a44ba6b79429aae1e8a", "filename": "gcc/cp/cvt.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Fcp%2Fcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Fcp%2Fcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcvt.c?ref=2303a07914bc82ca17706fc15166bf40b940bfa7", "patch": "@@ -473,12 +473,13 @@ convert_to_reference (reftype, expr, convtype, flags, decl)\n      tree decl;\n {\n   register tree type = TYPE_MAIN_VARIANT (TREE_TYPE (reftype));\n-  register tree intype = TREE_TYPE (expr);\n+  register tree intype;\n   tree rval = NULL_TREE;\n   tree rval_as_conversion = NULL_TREE;\n   int i;\n \n-  if (TREE_CODE (type) == FUNCTION_TYPE && intype == unknown_type_node)\n+  if (TREE_CODE (type) == FUNCTION_TYPE \n+      && TREE_TYPE (expr) == unknown_type_node)\n     {\n       expr = instantiate_type (type, expr, \n \t\t\t       (flags & LOOKUP_COMPLAIN)\n@@ -488,6 +489,11 @@ convert_to_reference (reftype, expr, convtype, flags, decl)\n \n       intype = TREE_TYPE (expr);\n     }\n+  else\n+    {\n+      expr = convert_from_reference (expr);\n+      intype = TREE_TYPE (expr);\n+    }\n \n   my_friendly_assert (TREE_CODE (intype) != REFERENCE_TYPE, 364);\n "}, {"sha": "3f3cee43c787f3bd0bf10f6b789c15fee23d7e77", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2303a07914bc82ca17706fc15166bf40b940bfa7", "patch": "@@ -1,3 +1,8 @@\n+2002-10-16  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/7478\n+\t* g++.dg/template/ref1.C: New test.\n+\n 2002-10-16  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.c-torture/execute/20020720-1.x: Don't XFAIL for mips."}, {"sha": "3f133d488f5d1f8f2164568e7e8c086f419ba649", "filename": "gcc/testsuite/g++.dg/template/ref1.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fref1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2303a07914bc82ca17706fc15166bf40b940bfa7/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fref1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fref1.C?ref=2303a07914bc82ca17706fc15166bf40b940bfa7", "patch": "@@ -0,0 +1,3 @@\n+class a {} a1;\n+template <a & p> class b { public: b() { static_cast <a &> (p); }; };\n+int main() { b <a1> b1; };"}]}