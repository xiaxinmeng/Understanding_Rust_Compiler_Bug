{"sha": "c77935ee29336399ab6318e912baa174e243654a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzc3OTM1ZWUyOTMzNjM5OWFiNjMxOGU5MTJiYWExNzRlMjQzNjU0YQ==", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2014-08-19T14:14:15Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2014-08-19T14:14:15Z"}, "message": "re PR c/45584 (typeof with casting from const to non-const does not work properly)\n\n2014-08-19  Patrick Palka  <ppalka@gcc.gnu.org>\n\n\tPR c/45584\n\t* c-typeck.c (build_c_cast): Do a conversion even when the\n\tTYPE_MAIN_VARIANTs are the same.\n\n2014-08-19  Patrick Palka  <ppalka@gcc.gnu.org>\n\n\tPR c/45584\n\t* gcc.dg/pr13519-1.c: Adjust.\n\nFrom-SVN: r214151", "tree": {"sha": "aa8358e5df2689d3a6cc449f8540ceb1d095a0c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aa8358e5df2689d3a6cc449f8540ceb1d095a0c6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c77935ee29336399ab6318e912baa174e243654a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c77935ee29336399ab6318e912baa174e243654a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c77935ee29336399ab6318e912baa174e243654a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c77935ee29336399ab6318e912baa174e243654a/comments", "author": null, "committer": null, "parents": [{"sha": "d20770308827d407c4fc2b25413bbf5e716971f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d20770308827d407c4fc2b25413bbf5e716971f9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d20770308827d407c4fc2b25413bbf5e716971f9"}], "stats": {"total": 22, "additions": 18, "deletions": 4}, "files": [{"sha": "391cfeda95ea756139c05625d96b217ecb5c6235", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77935ee29336399ab6318e912baa174e243654a/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77935ee29336399ab6318e912baa174e243654a/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=c77935ee29336399ab6318e912baa174e243654a", "patch": "@@ -1,3 +1,9 @@\n+2014-08-19  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\tPR c/45584\n+\t* c-typeck.c (build_c_cast): Do a conversion even when the\n+\tTYPE_MAIN_VARIANTs are the same.\n+\n 2014-08-19  Marek Polacek  <polacek@redhat.com>\n \n \t* c-decl.c (diagnose_mismatched_decls): Unconditionally call"}, {"sha": "3210f1ab4f7dacea7196a447a2eada490bfe6ba4", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77935ee29336399ab6318e912baa174e243654a/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77935ee29336399ab6318e912baa174e243654a/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=c77935ee29336399ab6318e912baa174e243654a", "patch": "@@ -4947,6 +4947,9 @@ build_c_cast (location_t loc, tree type, tree expr)\n \t  || TREE_CODE (type) == UNION_TYPE)\n \tpedwarn (loc, OPT_Wpedantic,\n \t\t \"ISO C forbids casting nonscalar to the same type\");\n+\n+      /* Convert to remove any qualifiers from VALUE's type.  */\n+      value = convert (type, value);\n     }\n   else if (TREE_CODE (type) == UNION_TYPE)\n     {"}, {"sha": "a783217fe7d28973870d5a9b746ceafc353a4e0f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77935ee29336399ab6318e912baa174e243654a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77935ee29336399ab6318e912baa174e243654a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c77935ee29336399ab6318e912baa174e243654a", "patch": "@@ -1,3 +1,8 @@\n+2014-08-19  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\tPR c/45584\n+\t* gcc.dg/pr13519-1.c: Adjust.\n+\n 2014-08-19  Mark Wielaard  <mjw@redhat.com>\n \n \t* gcc.dg/guality/const-volatile.c: Add `used' attribute to pi.\n@@ -7,7 +12,7 @@\n \tPR debug/59051\n \t* gcc.dg/guality/restrict.c: New test.\n \n-2014-07-03  Mark Wielaard  <mjw@redhat.com>\n+2014-08-19  Mark Wielaard  <mjw@redhat.com>\n \n \t* lib/gcc-gdb-test.exp (gdb-test): Handle type:var for gdb ptype\n \tmatching. Catch '<unknown type in ' to recognize older gdb versions."}, {"sha": "1117a0e16cddd723f9f40477a2a1a12c8f4d74e5", "filename": "gcc/testsuite/gcc.dg/pr13519-1.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c77935ee29336399ab6318e912baa174e243654a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr13519-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c77935ee29336399ab6318e912baa174e243654a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr13519-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr13519-1.c?ref=c77935ee29336399ab6318e912baa174e243654a", "patch": "@@ -14,9 +14,9 @@ void fn(void)\n   { __typeof__(n) a1; a1=0; }\n   { __typeof__(c) a2; a2=0; } /* { dg-error \"read-only\" \"correct error\" } */\n   { __typeof__((int)n) a3; a3=0; }\n-  { __typeof__((int)c) a4; a4=0; } /* { dg-bogus \"read-only\" \"bogus error\" { xfail *-*-* } } */\n-  { __typeof__((const int)n) a5; a5=0; } /* { dg-error \"read-only\" \"correct error\" { xfail *-*-* } } */\n-  { __typeof__((const int)c) a6; a6=0; } /* { dg-error \"read-only\" \"correct error\" } */\n+  { __typeof__((int)c) a4; a4=0; } /* { dg-bogus \"read-only\" \"bogus error\" } */\n+  { __typeof__((const int)n) a5; a5=0; }\n+  { __typeof__((const int)c) a6; a6=0; }\n   { __typeof__(0) a7; a7=0; }\n   { __typeof__(1) a8; a8=0; }\n "}]}