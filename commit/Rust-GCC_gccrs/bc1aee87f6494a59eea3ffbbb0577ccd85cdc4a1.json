{"sha": "bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmMxYWVlODdmNjQ5NGE1OWVlYTNmZmJiYjA1NzdjY2Q4NWNkYzRhMQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2016-05-02T19:09:30Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2016-05-02T19:09:30Z"}, "message": "PR c++/62314: C++: add fixit hint to misspelled member names\n\nWhen we emit a hint about a misspelled member name, it will slightly\naid readability if we use a fixit-hint to show the proposed\nname in context within the source code (and in the future this\nmight support some kind of auto-apply in an IDE).\n\nThis patch adds such a hint to the C++ frontend, taking us from:\n\ntest.cc:10:15: error: 'struct foo' has no member named 'colour'; did you mean 'color'?\n   return ptr->colour;\n               ^~~~~~\n\nto:\n\ntest.cc:10:15: error: 'struct foo' has no member named 'colour'; did you mean 'color'?\n   return ptr->colour;\n               ^~~~~~\n               color\n\ngcc/cp/ChangeLog:\n\tPR c++/62314\n\t* typeck.c (finish_class_member_access_expr): When\n\tgiving a hint about a possibly-misspelled member name,\n\tadd a fix-it replacement hint.\n\ngcc/testsuite/ChangeLog:\n\tPR c++/62314\n\t* g++.dg/spellcheck-fields-2.C: New test case.\n\nFrom-SVN: r235785", "tree": {"sha": "026c49c2d8eadd08c56f75e225d4cb516a351820", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/026c49c2d8eadd08c56f75e225d4cb516a351820"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7caed520694ee532199e889eba09a900ecce1866", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7caed520694ee532199e889eba09a900ecce1866", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7caed520694ee532199e889eba09a900ecce1866"}], "stats": {"total": 49, "additions": 46, "deletions": 3}, "files": [{"sha": "990ba0fb719fad746f3af60ebc8c125e47d0ff0d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "patch": "@@ -1,3 +1,10 @@\n+2016-05-02  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR c++/62314\n+\t* typeck.c (finish_class_member_access_expr): When\n+\tgiving a hint about a possibly-misspelled member name,\n+\tadd a fix-it replacement hint.\n+\n 2016-05-02  Cesar Philippidis  <cesar@codesourcery.com>\n \n \t* cp-tree.h (finish_omp_clauses): Update prototype."}, {"sha": "95c777d7721ceca690f10d167563ca51de97fe7e", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "patch": "@@ -2817,9 +2817,21 @@ finish_class_member_access_expr (cp_expr object, tree name, bool template_p,\n \t\t  tree guessed_id = lookup_member_fuzzy (access_path, name,\n \t\t\t\t\t\t\t /*want_type=*/false);\n \t\t  if (guessed_id)\n-\t\t    error (\"%q#T has no member named %qE; did you mean %qE?\",\n-\t\t\t   TREE_CODE (access_path) == TREE_BINFO\n-\t\t\t   ? TREE_TYPE (access_path) : object_type, name, guessed_id);\n+\t\t    {\n+\t\t      location_t bogus_component_loc = input_location;\n+\t\t      rich_location rich_loc (line_table, bogus_component_loc);\n+\t\t      source_range bogus_component_range =\n+\t\t\tget_range_from_loc (line_table, bogus_component_loc);\n+\t\t      rich_loc.add_fixit_replace\n+\t\t\t(bogus_component_range,\n+\t\t\t IDENTIFIER_POINTER (guessed_id));\n+\t\t      error_at_rich_loc\n+\t\t\t(&rich_loc,\n+\t\t\t \"%q#T has no member named %qE; did you mean %qE?\",\n+\t\t\t TREE_CODE (access_path) == TREE_BINFO\n+\t\t\t ? TREE_TYPE (access_path) : object_type, name,\n+\t\t\t guessed_id);\n+\t\t    }\n \t\t  else\n \t\t    error (\"%q#T has no member named %qE\",\n \t\t\t   TREE_CODE (access_path) == TREE_BINFO"}, {"sha": "4bd9f88af496000eb729ebc9dc116399b248cecc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "patch": "@@ -1,3 +1,8 @@\n+2016-05-02  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR c++/62314\n+\t* g++.dg/spellcheck-fields-2.C: New test case.\n+\n 2016-05-02  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR c++/62314"}, {"sha": "eb10b44e59e05fdda2ee3cb55d885f396e3424c7", "filename": "gcc/testsuite/g++.dg/spellcheck-fields-2.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fspellcheck-fields-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fspellcheck-fields-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fspellcheck-fields-2.C?ref=bc1aee87f6494a59eea3ffbbb0577ccd85cdc4a1", "patch": "@@ -0,0 +1,19 @@\n+// { dg-options \"-fdiagnostics-show-caret\" }\n+\n+union u\n+{\n+  int color;\n+  int shape;\n+};\n+\n+int test (union u *ptr)\n+{\n+  return ptr->colour; // { dg-error \"did you mean .color.?\" }\n+}\n+\n+// Verify that we get an underline and a fixit hint.\n+/* { dg-begin-multiline-output \"\" }\n+   return ptr->colour;\n+               ^~~~~~\n+               color\n+   { dg-end-multiline-output \"\" } */"}]}