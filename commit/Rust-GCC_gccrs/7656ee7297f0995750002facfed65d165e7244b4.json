{"sha": "7656ee7297f0995750002facfed65d165e7244b4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzY1NmVlNzI5N2YwOTk1NzUwMDAyZmFjZmVkNjVkMTY1ZTcyNDRiNA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2013-12-17T16:08:42Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2013-12-17T16:08:42Z"}, "message": "ipa-devirt.c (get_polymorphic_call_info): Fix offset calculatoin in contains_type_p query.\n\n\n\t* ipa-devirt.c (get_polymorphic_call_info): Fix offset calculatoin\n\tin contains_type_p query.\n\nFrom-SVN: r206061", "tree": {"sha": "092d782a52277bb61cfb07c5b18347a2efe2f22d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/092d782a52277bb61cfb07c5b18347a2efe2f22d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7656ee7297f0995750002facfed65d165e7244b4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7656ee7297f0995750002facfed65d165e7244b4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7656ee7297f0995750002facfed65d165e7244b4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7656ee7297f0995750002facfed65d165e7244b4/comments", "author": null, "committer": null, "parents": [{"sha": "18aacdca292bb1bd54aa8b6121ce819ee308a24e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18aacdca292bb1bd54aa8b6121ce819ee308a24e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18aacdca292bb1bd54aa8b6121ce819ee308a24e"}], "stats": {"total": 16, "additions": 10, "deletions": 6}, "files": [{"sha": "3c7b0d57ac9b615fcdb54a703972c0f72e5994fa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7656ee7297f0995750002facfed65d165e7244b4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7656ee7297f0995750002facfed65d165e7244b4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7656ee7297f0995750002facfed65d165e7244b4", "patch": "@@ -1,3 +1,8 @@\n+2013-12-17  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-devirt.c (get_polymorphic_call_info): Fix offset calculatoin\n+\tin contains_type_p query.\n+\n 2013-12-17  Thomas Schwinge  <thomas@codesourcery.com>\n \n \t* omp-low.c (tmp_ompfn_id_num): Remove leftover variable"}, {"sha": "a3f2ad674e1850ba5645690c4e4e2d1014fbbf3b", "filename": "gcc/ipa-devirt.c", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7656ee7297f0995750002facfed65d165e7244b4/gcc%2Fipa-devirt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7656ee7297f0995750002facfed65d165e7244b4/gcc%2Fipa-devirt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-devirt.c?ref=7656ee7297f0995750002facfed65d165e7244b4", "patch": "@@ -982,23 +982,22 @@ get_polymorphic_call_info (tree fndecl,\n \t\t is known.  */\n \t      else if (DECL_P (base))\n \t\t{\n-\t\t  context->outer_type = TREE_TYPE (base);\n-\t\t  gcc_assert (!POINTER_TYPE_P (context->outer_type));\n+\t\t  gcc_assert (!POINTER_TYPE_P (TREE_TYPE (base)));\n \n \t\t  /* Only type inconsistent programs can have otr_type that is\n \t\t     not part of outer type.  */\n-\t\t  if (!contains_type_p (context->outer_type,\n-\t\t\t\t\tcontext->offset, *otr_type))\n+\t\t  if (!contains_type_p (TREE_TYPE (base),\n+\t\t\t\t\tcontext->offset + offset2, *otr_type))\n \t\t    return base_pointer;\n+\t\t  context->outer_type = TREE_TYPE (base);\n \t\t  context->offset += offset2;\n-\t\t  base_pointer = NULL;\n \t\t  /* Make very conservative assumption that all objects\n \t\t     may be in construction. \n \t\t     TODO: ipa-prop already contains code to tell better. \n \t\t     merge it later.  */\n \t\t  context->maybe_in_construction = true;\n \t\t  context->maybe_derived_type = false;\n-\t\t  return base_pointer;\n+\t\t  return NULL;\n \t\t}\n \t      else\n \t\tbreak;"}]}