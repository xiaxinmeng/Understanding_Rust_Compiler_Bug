{"sha": "c5ce98cbb8db8d33774c50e229daedf99a71bb5a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzVjZTk4Y2JiOGRiOGQzMzc3NGM1MGUyMjlkYWVkZjk5YTcxYmI1YQ==", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-07-05T15:36:08Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-07-10T20:25:38Z"}, "message": "ImplBlocks can contain TypeAlias's\n\nThis lowers TypeAliases into ImplItem for HIR::ImplBlocks.", "tree": {"sha": "c0da5d775494cc63b6bdfd8f26ff8fb300896a60", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c0da5d775494cc63b6bdfd8f26ff8fb300896a60"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c5ce98cbb8db8d33774c50e229daedf99a71bb5a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5ce98cbb8db8d33774c50e229daedf99a71bb5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c5ce98cbb8db8d33774c50e229daedf99a71bb5a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5ce98cbb8db8d33774c50e229daedf99a71bb5a/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "30ca36242090e5b1dcb8094a7a11574949f36d1a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30ca36242090e5b1dcb8094a7a11574949f36d1a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30ca36242090e5b1dcb8094a7a11574949f36d1a"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "b08a1667e2711ede311eb9ce2baf099f832aebfd", "filename": "gcc/rust/hir/rust-ast-lower-implitem.h", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c5ce98cbb8db8d33774c50e229daedf99a71bb5a/gcc%2Frust%2Fhir%2Frust-ast-lower-implitem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c5ce98cbb8db8d33774c50e229daedf99a71bb5a/gcc%2Frust%2Fhir%2Frust-ast-lower-implitem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fhir%2Frust-ast-lower-implitem.h?ref=c5ce98cbb8db8d33774c50e229daedf99a71bb5a", "patch": "@@ -52,6 +52,38 @@ class ASTLowerImplItem : public ASTLoweringBase\n     return resolver.translated;\n   }\n \n+  void visit (AST::TypeAlias &alias) override\n+  {\n+    std::vector<std::unique_ptr<HIR::WhereClauseItem> > where_clause_items;\n+    HIR::WhereClause where_clause (std::move (where_clause_items));\n+    HIR::Visibility vis = HIR::Visibility::create_public ();\n+\n+    std::vector<std::unique_ptr<HIR::GenericParam> > generic_params;\n+    if (alias.has_generics ())\n+      generic_params = lower_generic_params (alias.get_generic_params ());\n+\n+    HIR::Type *existing_type\n+      = ASTLoweringType::translate (alias.get_type_aliased ().get ());\n+\n+    auto crate_num = mappings->get_current_crate ();\n+    Analysis::NodeMapping mapping (crate_num, alias.get_node_id (),\n+\t\t\t\t   mappings->get_next_hir_id (crate_num),\n+\t\t\t\t   mappings->get_next_localdef_id (crate_num));\n+\n+    translated = new HIR::TypeAlias (mapping, alias.get_new_type_name (),\n+\t\t\t\t     std::move (generic_params),\n+\t\t\t\t     std::move (where_clause),\n+\t\t\t\t     std::unique_ptr<HIR::Type> (existing_type),\n+\t\t\t\t     std::move (vis), alias.get_outer_attrs (),\n+\t\t\t\t     alias.get_locus ());\n+\n+    mappings->insert_hir_implitem (mapping.get_crate_num (),\n+\t\t\t\t   mapping.get_hirid (), parent_impl_id,\n+\t\t\t\t   translated);\n+    mappings->insert_location (crate_num, mapping.get_hirid (),\n+\t\t\t       alias.get_locus ());\n+  }\n+\n   void visit (AST::ConstantItem &constant) override\n   {\n     HIR::Visibility vis = HIR::Visibility::create_public ();"}]}