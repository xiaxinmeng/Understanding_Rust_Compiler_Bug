{"sha": "7e3af3746e4d4a93f833ee8311ef2ffba1996c5e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2UzYWYzNzQ2ZTRkNGE5M2Y4MzNlZTgzMTFlZjJmZmJhMTk5NmM1ZQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1997-09-01T21:01:30Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1997-09-01T21:01:30Z"}, "message": "call.c (build_new_op): Strip leading REF_BIND from first operand to builtin operator.\n\n\t* call.c (build_new_op): Strip leading REF_BIND from first operand\n\tto builtin operator.\n\n\t* decl2.c (mark_vtable_entries): Mark abort_fndecl as used when we\n\tuse its RTL.\n\nFrom-SVN: r15023", "tree": {"sha": "4461dd0f20cc90fb2a7d90ff092f0d221d2c5077", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4461dd0f20cc90fb2a7d90ff092f0d221d2c5077"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e/comments", "author": null, "committer": null, "parents": [{"sha": "8e69329a82c45a31e84ef3698ad3e7cbfca1c3a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e69329a82c45a31e84ef3698ad3e7cbfca1c3a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e69329a82c45a31e84ef3698ad3e7cbfca1c3a9"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "46ede9667c4b8e608d9e5fb49a5426c1e1379fde", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7e3af3746e4d4a93f833ee8311ef2ffba1996c5e", "patch": "@@ -1,3 +1,11 @@\n+Mon Sep  1 13:19:04 1997  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* call.c (build_new_op): Strip leading REF_BIND from first operand\n+\tto builtin operator.\n+\n+\t* decl2.c (mark_vtable_entries): Mark abort_fndecl as used when we\n+\tuse its RTL.\n+\n Thu Aug 28 09:45:23 1997  Jason Merrill  <jason@yorick.cygnus.com>\n \n \t* call.c (null_ptr_cst_p): Remove support for (void*)0."}, {"sha": "c6b28846db86c1d6c5bd6f1c5fe80332bd8494a0", "filename": "gcc/cp/call.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=7e3af3746e4d4a93f833ee8311ef2ffba1996c5e", "patch": "@@ -4579,6 +4579,7 @@ build_new_op (code, flags, arg1, arg2, arg3)\n   tree fns, mem_arglist, arglist, fnname;\n   enum tree_code code2 = NOP_EXPR;\n   tree templates = NULL_TREE;\n+  tree conv;\n \n   if (arg1 == error_mark_node\n       || arg2 == error_mark_node\n@@ -4860,8 +4861,13 @@ build_new_op (code, flags, arg1, arg2, arg3)\n \t}\n     }\n \n-  arg1 = convert_from_reference\n-    (convert_like (TREE_VEC_ELT (cand->convs, 0), arg1));\n+  /* We need to strip any leading REF_BIND so that bitfields don't cause\n+     errors.  This should not remove any important conversions, because\n+     builtins don't apply to class objects directly.  */\n+  conv = TREE_VEC_ELT (cand->convs, 0);\n+  if (TREE_CODE (conv) == REF_BIND)\n+    conv = TREE_OPERAND (conv, 0);\n+  arg1 = convert_like (conv, arg1);\n   if (arg2)\n     arg2 = convert_like (TREE_VEC_ELT (cand->convs, 1), arg2);\n   if (arg3)"}, {"sha": "a8975ecd4d4f0bcf2c0b480b30318a9626d2fdfb", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e3af3746e4d4a93f833ee8311ef2ffba1996c5e/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=7e3af3746e4d4a93f833ee8311ef2ffba1996c5e", "patch": "@@ -2343,6 +2343,7 @@ mark_vtable_entries (decl)\n \t{\n \t  TREE_OPERAND (fnaddr, 0) = fn = copy_node (fn);\n \t  DECL_RTL (fn) = DECL_RTL (abort_fndecl);\n+\t  mark_used (abort_fndecl);\n \t}\n       if (TREE_CODE (fn) == THUNK_DECL && DECL_EXTERNAL (fn))\n \t{"}]}