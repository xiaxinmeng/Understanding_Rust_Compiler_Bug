{"sha": "34769baf7d9d8e5545c478d85db3261c6dda3c89", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzQ3NjliYWY3ZDlkOGU1NTQ1YzQ3OGQ4NWRiMzI2MWM2ZGRhM2M4OQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2017-04-28T12:49:26Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2017-04-28T12:49:26Z"}, "message": "gcno file: do not stream block flags (PR gcov-profile/80031).\n\n2017-04-28  Martin Liska  <mliska@suse.cz>\n\n\tPR gcov-profile/80031\n\t* gcov-dump.c (tag_blocks): Just print number of basic blocks.\n\t* gcov-io.h (GCOV_TAG_BLOCKS_NUM): Remove unused macro.\n\t* gcov.c (read_graph_file): Read just number of blocks.\n\t* profile.c (branch_prob): Do not stream 0 flags per a basic\n\tblock.\n\nFrom-SVN: r247370", "tree": {"sha": "e7a12c6660305c53dab971f3347996185cd2e9af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e7a12c6660305c53dab971f3347996185cd2e9af"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34769baf7d9d8e5545c478d85db3261c6dda3c89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34769baf7d9d8e5545c478d85db3261c6dda3c89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34769baf7d9d8e5545c478d85db3261c6dda3c89", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34769baf7d9d8e5545c478d85db3261c6dda3c89/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5c5059bcf87715daa965eec3c04731f447fcbb0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c5059bcf87715daa965eec3c04731f447fcbb0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c5059bcf87715daa965eec3c04731f447fcbb0a"}], "stats": {"total": 42, "additions": 13, "deletions": 29}, "files": [{"sha": "8e21c35c97901a9f3522baf96be17d5acec4f762", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=34769baf7d9d8e5545c478d85db3261c6dda3c89", "patch": "@@ -1,3 +1,12 @@\n+2017-04-28  Martin Liska  <mliska@suse.cz>\n+\n+\tPR gcov-profile/80031\n+\t* gcov-dump.c (tag_blocks): Just print number of basic blocks.\n+\t* gcov-io.h (GCOV_TAG_BLOCKS_NUM): Remove unused macro.\n+\t* gcov.c (read_graph_file): Read just number of blocks.\n+\t* profile.c (branch_prob): Do not stream 0 flags per a basic\n+\tblock.\n+\n 2017-04-28  Martin Liska  <mliska@suse.cz>\n \n \t* gcov-dump.c (tag_*): Add new argument to declarations."}, {"sha": "f2522577e9d4f032e2996ed741fc89accaf7fe07", "filename": "gcc/gcov-dump.c", "status": "modified", "additions": 2, "deletions": 20, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fgcov-dump.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fgcov-dump.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov-dump.c?ref=34769baf7d9d8e5545c478d85db3261c6dda3c89", "patch": "@@ -318,27 +318,9 @@ tag_function (const char *filename ATTRIBUTE_UNUSED,\n static void\n tag_blocks (const char *filename ATTRIBUTE_UNUSED,\n \t    unsigned tag ATTRIBUTE_UNUSED, unsigned length ATTRIBUTE_UNUSED,\n-\t    unsigned depth)\n+\t    unsigned depth ATTRIBUTE_UNUSED)\n {\n-  unsigned n_blocks = GCOV_TAG_BLOCKS_NUM (length);\n-\n-  printf (\" %u blocks\", n_blocks);\n-\n-  if (flag_dump_contents)\n-    {\n-      unsigned ix;\n-\n-      for (ix = 0; ix != n_blocks; ix++)\n-\t{\n-\t  if (!(ix & 7))\n-\t    {\n-\t      printf (\"\\n\");\n-\t      print_prefix (filename, depth, gcov_position ());\n-\t      printf (VALUE_PADDING_PREFIX VALUE_PREFIX, ix);\n-\t    }\n-\t  printf (\"%04x \", gcov_read_unsigned ());\n-\t}\n-    }\n+  printf (\" %u blocks\", gcov_read_unsigned ());\n }\n \n static void"}, {"sha": "1c8ee8f9a2aff55afa1d63f238039540b6f1125e", "filename": "gcc/gcov-io.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fgcov-io.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fgcov-io.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov-io.h?ref=34769baf7d9d8e5545c478d85db3261c6dda3c89", "patch": "@@ -230,7 +230,6 @@ typedef uint64_t gcov_type_unsigned;\n #define GCOV_TAG_FUNCTION_LENGTH (3)\n #define GCOV_TAG_BLOCKS\t\t ((gcov_unsigned_t)0x01410000)\n #define GCOV_TAG_BLOCKS_LENGTH(NUM) (NUM)\n-#define GCOV_TAG_BLOCKS_NUM(LENGTH) (LENGTH)\n #define GCOV_TAG_ARCS\t\t ((gcov_unsigned_t)0x01430000)\n #define GCOV_TAG_ARCS_LENGTH(NUM)  (1 + (NUM) * 2)\n #define GCOV_TAG_ARCS_NUM(LENGTH)  (((LENGTH) - 1) / 2)"}, {"sha": "63f6a75f1af2069b92a4a18d493dc031f2bbac16", "filename": "gcc/gcov.c", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fgcov.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fgcov.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov.c?ref=34769baf7d9d8e5545c478d85db3261c6dda3c89", "patch": "@@ -129,7 +129,6 @@ typedef struct block_info\n \n   /* Block execution count.  */\n   gcov_type count;\n-  unsigned flags : 12;\n   unsigned count_valid : 1;\n   unsigned valid_chain : 1;\n   unsigned invalid_chain : 1;\n@@ -1374,12 +1373,8 @@ read_graph_file (void)\n \t\t     bbg_file_name, fn->name);\n \t  else\n \t    {\n-\t      unsigned ix, num_blocks = GCOV_TAG_BLOCKS_NUM (length);\n-\t      fn->num_blocks = num_blocks;\n-\n+\t      fn->num_blocks = gcov_read_unsigned ();\n \t      fn->blocks = XCNEWVEC (block_t, fn->num_blocks);\n-\t      for (ix = 0; ix != num_blocks; ix++)\n-\t\tfn->blocks[ix].flags = gcov_read_unsigned ();\n \t    }\n \t}\n       else if (fn && tag == GCOV_TAG_ARCS)"}, {"sha": "c7eed0e3dfddf5811628a2032c208653245b96c3", "filename": "gcc/profile.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fprofile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34769baf7d9d8e5545c478d85db3261c6dda3c89/gcc%2Fprofile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fprofile.c?ref=34769baf7d9d8e5545c478d85db3261c6dda3c89", "patch": "@@ -1195,8 +1195,7 @@ branch_prob (void)\n \n       /* Basic block flags */\n       offset = gcov_write_tag (GCOV_TAG_BLOCKS);\n-      for (i = 0; i != (unsigned) (n_basic_blocks_for_fn (cfun)); i++)\n-\tgcov_write_unsigned (0);\n+      gcov_write_unsigned (n_basic_blocks_for_fn (cfun));\n       gcov_write_length (offset);\n \n       /* Arcs */"}]}