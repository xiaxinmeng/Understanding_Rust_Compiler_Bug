{"sha": "85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVjMmY5NmMxY2QzZDFjYmRiZDIwYWQyNmY3ZDI2ZGFmYmNhMDg3Yw==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-10-26T17:50:10Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-10-26T17:50:10Z"}, "message": "syscall: fix creds_test to reliably close os.File\n\nUncovered by Uros Bizjak.\n\nBefore this patch the test would close the file descriptor but\nnot the os.File.  When the os.File was GC'ed, the finalizer\nwould close the file descriptor again.  That would cause\nproblems if the same file descriptor were returned by a later\ncall to open in another test.\n\nOn my system:\n\n> GOGC=30 go test\n--- FAIL: TestPassFD (0.04 seconds)\npassfd_test.go:62: \tFileConn: dup: bad file descriptor\nFAIL\n\nFrom-SVN: r192854", "tree": {"sha": "de04d5291829d3f364a180607a01c072cc985bb6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/de04d5291829d3f364a180607a01c072cc985bb6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c/comments", "author": null, "committer": null, "parents": [{"sha": "385710cf27e9a75c314993c21f44ed5ca50d4a6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/385710cf27e9a75c314993c21f44ed5ca50d4a6a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/385710cf27e9a75c314993c21f44ed5ca50d4a6a"}], "stats": {"total": 8, "additions": 6, "deletions": 2}, "files": [{"sha": "b1894c66b07150252809682ec30478451760ed0e", "filename": "libgo/go/syscall/creds_test.go", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c/libgo%2Fgo%2Fsyscall%2Fcreds_test.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c/libgo%2Fgo%2Fsyscall%2Fcreds_test.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fsyscall%2Fcreds_test.go?ref=85c2f96c1cd3d1cbdbd20ad26f7d26dafbca087c", "patch": "@@ -31,14 +31,18 @@ func TestSCMCredentials(t *testing.T) {\n \t\tt.Fatalf(\"SetsockoptInt: %v\", err)\n \t}\n \n-\tsrv, err := net.FileConn(os.NewFile(uintptr(fds[0]), \"\"))\n+\tsrvFile := os.NewFile(uintptr(fds[0]), \"server\")\n+\tdefer srvFile.Close()\n+\tsrv, err := net.FileConn(srvFile)\n \tif err != nil {\n \t\tt.Errorf(\"FileConn: %v\", err)\n \t\treturn\n \t}\n \tdefer srv.Close()\n \n-\tcli, err := net.FileConn(os.NewFile(uintptr(fds[1]), \"\"))\n+\tcliFile := os.NewFile(uintptr(fds[1]), \"client\")\n+\tdefer cliFile.Close()\n+\tcli, err := net.FileConn(cliFile)\n \tif err != nil {\n \t\tt.Errorf(\"FileConn: %v\", err)\n \t\treturn"}]}