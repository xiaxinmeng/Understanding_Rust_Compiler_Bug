{"sha": "a4223abb3deb24e8104bbfec6f0f21579c1889e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQyMjNhYmIzZGViMjRlODEwNGJiZmVjNmYwZjIxNTc5YzE4ODllMw==", "commit": {"author": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2020-10-28T18:57:02Z"}, "committer": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2020-10-28T18:58:43Z"}, "message": "c: Allow omitted parameter names for C2x\n\nC2x allows parameter names to be omitted in function definitions, as\nin C++; add support for this feature.  As with other features that\nonly result in previously rejected code being accepted, this feature\nis now accepted as an extension for previous standard versions, with a\npedwarn-if-pedantic that is disabled by -Wno-c11-c2x-compat.  The\nlogic for avoiding unused-parameter warnings for unnamed parameters is\nin code shared between C and C++, so no changes are needed there.\n\nBootstrapped with no regressions for x86_64-pc-linux-gnu.\n\ngcc/c/\n2020-10-28  Joseph Myers  <joseph@codesourcery.com>\n\n\t* c-decl.c (store_parm_decls_newstyle): Use pedwarn_c11 not\n\terror_at for omitted parameter name.\n\ngcc/testsuite/\n2020-10-28  Joseph Myers  <joseph@codesourcery.com>\n\n\t* gcc.dg/c11-parm-omit-1.c, gcc.dg/c11-parm-omit-2.c,\n\tgcc.dg/c11-parm-omit-3.c, gcc.dg/c11-parm-omit-4.c,\n\tgcc.dg/c2x-parm-omit-1.c, gcc.dg/c2x-parm-omit-2.c,\n\tgcc.dg/c2x-parm-omit-3.c, gcc.dg/c2x-parm-omit-4.c: New tests.\n\t* gcc.dg/noncompile/pr79758.c: Do not expect error for omitted\n\tparameter name.", "tree": {"sha": "a9faf863b7f5795bb9f45e505fe7eaa342d435ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a9faf863b7f5795bb9f45e505fe7eaa342d435ec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a4223abb3deb24e8104bbfec6f0f21579c1889e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4223abb3deb24e8104bbfec6f0f21579c1889e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4223abb3deb24e8104bbfec6f0f21579c1889e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4223abb3deb24e8104bbfec6f0f21579c1889e3/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a0e4d7b44c544c84cffc7ff9c64b6f1af14fb08d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0e4d7b44c544c84cffc7ff9c64b6f1af14fb08d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0e4d7b44c544c84cffc7ff9c64b6f1af14fb08d"}], "stats": {"total": 70, "additions": 68, "deletions": 2}, "files": [{"sha": "a5d0b158a26967878f51fac1dcbcea3b0f70ee3e", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -9630,7 +9630,9 @@ store_parm_decls_newstyle (tree fndecl, const struct c_arg_info *arg_info)\n \t    warn_if_shadowing (decl);\n \t}\n       else\n-\terror_at (DECL_SOURCE_LOCATION (decl), \"parameter name omitted\");\n+\tpedwarn_c11 (DECL_SOURCE_LOCATION (decl), OPT_Wpedantic,\n+\t\t     \"ISO C does not support omitting parameter names in \"\n+\t\t     \"function definitions before C2X\");\n     }\n \n   /* Record the parameter list in the function declaration.  */"}, {"sha": "83d1b5082869c3ca206c6e93c47a23dce2a397cf", "filename": "gcc/testsuite/gcc.dg/c11-parm-omit-1.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-1.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,5 @@\n+/* Test omitted parameter names not in C11: -pedantic-errors.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c11 -pedantic-errors\" } */\n+\n+void f (int) { } /* { dg-error \"omitting parameter names\" } */"}, {"sha": "2efd4505db3ce9adbe0f472f6ee8fe09f56fb9e4", "filename": "gcc/testsuite/gcc.dg/c11-parm-omit-2.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-2.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,5 @@\n+/* Test omitted parameter names not in C11: -pedantic.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c11 -pedantic\" } */\n+\n+void f (int) { } /* { dg-warning \"omitting parameter names\" } */"}, {"sha": "5bf27a03aff2404f9711c0805012312c84d83cf0", "filename": "gcc/testsuite/gcc.dg/c11-parm-omit-3.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-3.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,5 @@\n+/* Test omitted parameter names not in C11: -pedantic -Wno-c11-c2x-compat.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c11 -pedantic -Wno-c11-c2x-compat\" } */\n+\n+void f (int) { }"}, {"sha": "ea4cbfa9928d5bc9ed42e190770caa65360c5d5b", "filename": "gcc/testsuite/gcc.dg/c11-parm-omit-4.c", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc11-parm-omit-4.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,6 @@\n+/* Test omitted parameter names not in C11: accepted by default in the\n+   absence of -pedantic.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c11\" } */\n+\n+void f (int) { }"}, {"sha": "0dc89bb02701f91444b9fb2169d83ca7e437e6c1", "filename": "gcc/testsuite/gcc.dg/c2x-parm-omit-1.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-1.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,5 @@\n+/* Test omitted parameter names in C2x.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c2x -pedantic-errors\" } */\n+\n+void f (int) { }"}, {"sha": "7d689332813114775b9f9e07cbc6116166642238", "filename": "gcc/testsuite/gcc.dg/c2x-parm-omit-2.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-2.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,10 @@\n+/* Test omitted parameter names in C2x.  Warning test: there should be\n+   no warning for an unnamed parameter being unused.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c2x -pedantic-errors -Wall -Wextra\" } */\n+\n+int\n+f (int a, int, int c, int d) /* { dg-warning \"unused parameter 'd'\" } */\n+{\n+  return a + c;\n+}"}, {"sha": "dac258b0fb87e0b0d80b5fa4510247f636c5b454", "filename": "gcc/testsuite/gcc.dg/c2x-parm-omit-3.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-3.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,23 @@\n+/* Test omitted parameter names in C2x.  Execution test.  */\n+/* { dg-do run } */\n+/* { dg-options \"-std=c2x -pedantic-errors\" } */\n+\n+extern void abort (void);\n+extern void exit (int);\n+\n+void\n+f (int a, int [++a], int b)\n+{\n+  /* Verify array size expression of unnamed parameter is processed as\n+     expected.  */\n+  if (a != 2 || b != 3)\n+    abort ();\n+}\n+\n+int\n+main (void)\n+{\n+  int t[2];\n+  f (1, t, 3);\n+  exit (0);\n+}"}, {"sha": "a4b0deb7abcddf69636161a73ed50ba0e00b5eb8", "filename": "gcc/testsuite/gcc.dg/c2x-parm-omit-4.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fc2x-parm-omit-4.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -0,0 +1,5 @@\n+/* Test omitted parameter names in C2x: diagnosed with -Wc11-c2x-compat.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c2x -pedantic-errors -Wc11-c2x-compat\" } */\n+\n+void f (int) { } /* { dg-warning \"omitting parameter names\" } */"}, {"sha": "a31216068f002378cf6e120890695f143863088b", "filename": "gcc/testsuite/gcc.dg/noncompile/pr79758.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fnoncompile%2Fpr79758.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4223abb3deb24e8104bbfec6f0f21579c1889e3/gcc%2Ftestsuite%2Fgcc.dg%2Fnoncompile%2Fpr79758.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fnoncompile%2Fpr79758.c?ref=a4223abb3deb24e8104bbfec6f0f21579c1889e3", "patch": "@@ -1,6 +1,6 @@\n /* PR c/79758 */\n /* { dg-do compile } */\n \n-void fn1 (int[a]) { }; /* { dg-error \"undeclared here|parameter name omitted\" } */\n+void fn1 (int[a]) { }; /* { dg-error \"undeclared here\" } */\n void fn1 (b) { }; /* { dg-error \"redefinition\" } */\n /* { dg-warning \"defaults to 'int'\" \"\" { target *-*-* } .-1 } */"}]}