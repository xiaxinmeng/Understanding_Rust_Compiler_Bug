{"sha": "942926ad9aaed64e1fd18ca1a44ab04de79e632d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQyOTI2YWQ5YWFlZDY0ZTFmZDE4Y2ExYTQ0YWIwNGRlNzllNjMyZA==", "commit": {"author": {"name": "Geoffrey Keating", "email": "geoffk@apple.com", "date": "2005-01-04T02:13:56Z"}, "committer": {"name": "Geoffrey Keating", "email": "geoffk@gcc.gnu.org", "date": "2005-01-04T02:13:56Z"}, "message": "Index: libcpp/ChangeLog\n2005-01-03  Geoffrey Keating  <geoffk@apple.com>\n\n\t* files.c (_cpp_find_file): Add files found by search_path_exhausted\n\tto the list of all files.\n\nIndex: gcc/testsuite/ChangeLog\n2005-01-03  Geoffrey Keating  <geoffk@apple.com>\n\t    Robert Bowdidge <bowdidge@apple.com>\n\n\t* gcc.dg/cpp/subframework1.c: New.\n\t* gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/A.h: New.\n\t* gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/B.h: New.\n\t* gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/C.h: New.\n\t* gcc.dg/cpp/frame/one.framework/Headers/one-includeSubs.h: New.\n\nCo-Authored-By: Robert Bowdidge <bowdidge@apple.com>\n\nFrom-SVN: r92883", "tree": {"sha": "52c88aedd7f1c8d991064ad1952bd3983c447b8a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/52c88aedd7f1c8d991064ad1952bd3983c447b8a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/942926ad9aaed64e1fd18ca1a44ab04de79e632d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/942926ad9aaed64e1fd18ca1a44ab04de79e632d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/942926ad9aaed64e1fd18ca1a44ab04de79e632d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/942926ad9aaed64e1fd18ca1a44ab04de79e632d/comments", "author": {"login": "geoffk01", "id": 31905243, "node_id": "MDQ6VXNlcjMxOTA1MjQz", "avatar_url": "https://avatars.githubusercontent.com/u/31905243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/geoffk01", "html_url": "https://github.com/geoffk01", "followers_url": "https://api.github.com/users/geoffk01/followers", "following_url": "https://api.github.com/users/geoffk01/following{/other_user}", "gists_url": "https://api.github.com/users/geoffk01/gists{/gist_id}", "starred_url": "https://api.github.com/users/geoffk01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/geoffk01/subscriptions", "organizations_url": "https://api.github.com/users/geoffk01/orgs", "repos_url": "https://api.github.com/users/geoffk01/repos", "events_url": "https://api.github.com/users/geoffk01/events{/privacy}", "received_events_url": "https://api.github.com/users/geoffk01/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1eb3331e96ce4c7652004ef02da7ca9e72539555", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1eb3331e96ce4c7652004ef02da7ca9e72539555", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1eb3331e96ce4c7652004ef02da7ca9e72539555"}], "stats": {"total": 47, "additions": 46, "deletions": 1}, "files": [{"sha": "a55eb0249eed58e4d0af1693f3b4021fc83796c5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -1,3 +1,12 @@\n+2005-01-03  Geoffrey Keating  <geoffk@apple.com>\n+\t    Robert Bowdidge <bowdidge@apple.com>\n+\n+\t* gcc.dg/cpp/subframework1.c: New.\n+\t* gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/A.h: New.\n+\t* gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/B.h: New.\n+\t* gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/C.h: New.\n+\t* gcc.dg/cpp/frame/one.framework/Headers/one-includeSubs.h: New.\n+\n 2005-01-03  Geoffrey Keating  <geoffk@apple.com>\n \n \t* gcc.dg/darwin-weakimport-1.c: Remove check for variables"}, {"sha": "5573729516d4a316e96bb0adad61f854b674db4d", "filename": "gcc/testsuite/gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/A.h", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FA.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FA.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FA.h?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -0,0 +1 @@\n+#import <OneSub/C.h>"}, {"sha": "5573729516d4a316e96bb0adad61f854b674db4d", "filename": "gcc/testsuite/gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/B.h", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FB.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FB.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FB.h?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -0,0 +1 @@\n+#import <OneSub/C.h>"}, {"sha": "5afd8050cfb1df41bc5fa12282b56d0839638340", "filename": "gcc/testsuite/gcc.dg/cpp/frame/one.framework/Frameworks/OneSub.framework/Headers/C.h", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FC.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FC.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FFrameworks%2FOneSub.framework%2FHeaders%2FC.h?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -0,0 +1,4 @@\n+#ifdef ONESUB_C_INCLUDED\n+#error should only be imported once\n+#endif\n+#define ONESUB_C_INCLUDED 1"}, {"sha": "adaeb95ad8fe97ade6126f1e2d2e5bb28ed51d53", "filename": "gcc/testsuite/gcc.dg/cpp/frame/one.framework/Headers/one-includeSubs.h", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FHeaders%2Fone-includeSubs.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FHeaders%2Fone-includeSubs.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fframe%2Fone.framework%2FHeaders%2Fone-includeSubs.h?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -0,0 +1,2 @@\n+#import <OneSub/A.h>\n+#import <OneSub/B.h>"}, {"sha": "fd560faad4c29cdc56a19921b0c2489777adc98f", "filename": "gcc/testsuite/gcc.dg/cpp/subframework1.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fsubframework1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fsubframework1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fsubframework1.c?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -0,0 +1,15 @@\n+/* Copyright (C) 2004 Free Software Foundation, Inc.  */\n+\n+/* { dg-do preprocess } */\n+/* { dg-options \"-F$srcdir/gcc.dg/cpp/frame\" } */\n+\n+/* Contributed by Robert Bowdidge <bowdidge@apple.com>  */\n+/* include a file from a subframework that will import two files that\n+   both look at the same file.  Make sure we only include that file once;\n+   if so, the program will compile fine.  If not, we'll get redefinition\n+   errors */\n+\n+#include <one/one-includeSubs.h>\n+#ifndef ONESUB_C_INCLUDED\n+#error C.h not included\n+#endif"}, {"sha": "fb3e92843418fcf3bd56ef577c2b6db9c4146824", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -1,3 +1,8 @@\n+2005-01-03  Geoffrey Keating  <geoffk@apple.com>\n+\n+\t* files.c (_cpp_find_file): Add files found by search_path_exhausted\n+\tto the list of all files.\n+\n 2005-01-01  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n \n \t* internal.h: Update references to Cpp lib filenames."}, {"sha": "df5d9d7c9727434eef5fbc132790e67f59fc5142", "filename": "libcpp/files.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/942926ad9aaed64e1fd18ca1a44ab04de79e632d/libcpp%2Ffiles.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/942926ad9aaed64e1fd18ca1a44ab04de79e632d/libcpp%2Ffiles.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Ffiles.c?ref=942926ad9aaed64e1fd18ca1a44ab04de79e632d", "patch": "@@ -438,7 +438,15 @@ _cpp_find_file (cpp_reader *pfile, const char *fname, cpp_dir *start_dir, bool f\n       if (file->dir == NULL)\n \t{\n \t  if (search_path_exhausted (pfile, fname, file))\n-\t    return file;\n+\t    {\n+\t      /* Although this file must not go in the cache, because\n+\t\t the file found might depend on things (like the current file)\n+\t\t that aren't represented in the cache, it still has to go in\n+\t\t the list of all files so that #import works.  */\n+\t      file->next_file = pfile->all_files;\n+\t      pfile->all_files = file;\n+\t      return file;\n+\t    }\n \n \t  open_file_failed (pfile, file);\n \t  if (invalid_pch)"}]}