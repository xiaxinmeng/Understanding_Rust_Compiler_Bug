{"sha": "189cd5056db36dc477e1673f75f2eccf3be4056b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTg5Y2Q1MDU2ZGIzNmRjNDc3ZTE2NzNmNzVmMmVjY2YzYmU0MDU2Yg==", "commit": {"author": {"name": "Howard Hinnant", "email": "hhinnant@apple.com", "date": "2006-03-12T10:34:36Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2006-03-12T10:34:36Z"}, "message": "10097.cc: Fix race condition.\n\n2006-03-12  Howard Hinnant  <hhinnant@apple.com>\n\n\t* testsuite/27_io/basic_filebuf/underflow/char/10097.cc:\n\tFix race condition.\n\t* testsuite/27_io/objects/char/9661-1.cc: Likewise.\n\t* testsuite/27_io/objects/wchar_t/9661-1.cc: Likewise.\n\nFrom-SVN: r111978", "tree": {"sha": "a26d322b0d0b77604198fbfe41d3ae4fc5ae3f6d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a26d322b0d0b77604198fbfe41d3ae4fc5ae3f6d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/189cd5056db36dc477e1673f75f2eccf3be4056b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/189cd5056db36dc477e1673f75f2eccf3be4056b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/189cd5056db36dc477e1673f75f2eccf3be4056b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/189cd5056db36dc477e1673f75f2eccf3be4056b/comments", "author": null, "committer": null, "parents": [{"sha": "163659ade16ce76819d692335f5a058f87e6a035", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/163659ade16ce76819d692335f5a058f87e6a035", "html_url": "https://github.com/Rust-GCC/gccrs/commit/163659ade16ce76819d692335f5a058f87e6a035"}], "stats": {"total": 48, "additions": 31, "deletions": 17}, "files": [{"sha": "d29909ad00fd23c929ac2532d94ef940e364eb55", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=189cd5056db36dc477e1673f75f2eccf3be4056b", "patch": "@@ -1,3 +1,10 @@\n+2006-03-12  Howard Hinnant  <hhinnant@apple.com>\n+\n+\t* testsuite/27_io/basic_filebuf/underflow/char/10097.cc:\n+\tFix race condition.\n+\t* testsuite/27_io/objects/char/9661-1.cc: Likewise.\n+\t* testsuite/27_io/objects/wchar_t/9661-1.cc: Likewise.\n+\n 2006-03-10  Paolo Carlini  <pcarlini@suse.de>\n \n \t* include/tr1/cmath: Add atan2 and pow bits; add using declarations.\t"}, {"sha": "345a6642556c1c4c449da0135f9427ea44659e50", "filename": "libstdc++-v3/testsuite/27_io/basic_filebuf/underflow/char/10097.cc", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_filebuf%2Funderflow%2Fchar%2F10097.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_filebuf%2Funderflow%2Fchar%2F10097.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_filebuf%2Funderflow%2Fchar%2F10097.cc?ref=189cd5056db36dc477e1673f75f2eccf3be4056b", "patch": "@@ -3,7 +3,8 @@\n \n // 2001-05-21 Benjamin Kosnik  <bkoz@redhat.com>\n \n-// Copyright (C) 2001, 2002, 2003, 2005 Free Software Foundation, Inc.\n+// Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006\n+// Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -61,7 +62,7 @@ void test16()\n       VERIFY( false );\n     }\n   \n-  semaphore s1;\n+  semaphore s1, s2;\n   int fval = fork();\n   if (fval == -1)\n     {\n@@ -72,11 +73,12 @@ void test16()\n     {\n       filebuf fbout;\n       fbout.open(name, ios_base::in|ios_base::out);\n-      VERIFY ( fbout.is_open() );\n+      VERIFY( fbout.is_open() );\n       fbout.sputn(\"0123456789\", 10);\n       fbout.pubsync();\n-      s1.wait ();\n+      s1.wait();\n       fbout.close();\n+      s2.signal();\n       exit(0);\n     }\n \n@@ -97,7 +99,8 @@ void test16()\n     }\n \n   fb.close();\n-  s1.signal ();\n+  s1.signal();\n+  s2.wait();\n }\n \n int main() "}, {"sha": "6497f62a03a4061c1fa0152d7fcb81bce7f622a6", "filename": "libstdc++-v3/testsuite/27_io/objects/char/9661-1.cc", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fobjects%2Fchar%2F9661-1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fobjects%2Fchar%2F9661-1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fobjects%2Fchar%2F9661-1.cc?ref=189cd5056db36dc477e1673f75f2eccf3be4056b", "patch": "@@ -3,7 +3,7 @@\n \n // 2003-04-30  Petur Runolfsson <peturr02@ru.is>\n \n-// Copyright (C) 2003, 2005 Free Software Foundation, Inc.\n+// Copyright (C) 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -57,14 +57,15 @@ void test01()\n       VERIFY (file != NULL);\n       fputs(\"Whatever\\n\", file);\n       fflush(file);\n-      s1.signal ();\n-      s2.wait ();\n+      s1.signal();\n+      s2.wait();\n       fclose(file);\n+      s1.signal();\n       exit(0);\n     }\n-  \n+\n   freopen(name, \"r\", stdin);\n-  s1.wait ();\n+  s1.wait();\n \n   int c1 = fgetc(stdin);\n   VERIFY( c1 != EOF );\n@@ -82,7 +83,8 @@ void test01()\n   int c5 = cin.rdbuf()->sgetc();\n   VERIFY( c5 != EOF );\n   VERIFY( c5 == c4 );\n-  s2.signal ();\n+  s2.signal();\n+  s1.wait();\n }\n \n int main()"}, {"sha": "5b3c231e2e5f1179d3c3cd8de67169ad1e2ae6ff", "filename": "libstdc++-v3/testsuite/27_io/objects/wchar_t/9661-1.cc", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fobjects%2Fwchar_t%2F9661-1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/189cd5056db36dc477e1673f75f2eccf3be4056b/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fobjects%2Fwchar_t%2F9661-1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fobjects%2Fwchar_t%2F9661-1.cc?ref=189cd5056db36dc477e1673f75f2eccf3be4056b", "patch": "@@ -3,7 +3,7 @@\n \n // 2003-04-30  Petur Runolfsson <peturr02@ru.is>\n \n-// Copyright (C) 2003, 2005 Free Software Foundation, Inc.\n+// Copyright (C) 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -56,14 +56,15 @@ void test01()\n       FILE* file = fopen(name, \"w\");\n       fputs(\"Whatever\\n\", file);\n       fflush(file);\n-      s1.signal ();\n-      s2.wait ();\n+      s1.signal();\n+      s2.wait();\n       fclose(file);\n+      s1.signal();\n       exit(0);\n     }\n-  \n+\n   freopen(name, \"r\", stdin);\n-  s1.wait ();\n+  s1.wait();\n \n   wint_t c1 = fgetwc(stdin);\n   VERIFY( c1 != WEOF );\n@@ -81,7 +82,8 @@ void test01()\n   wint_t c5 = wcin.rdbuf()->sgetc();\n   VERIFY( c5 != WEOF );\n   VERIFY( c5 == c4 );\n-  s2.signal ();\n+  s2.signal();\n+  s1.wait(); \n }\n \n int main()"}]}