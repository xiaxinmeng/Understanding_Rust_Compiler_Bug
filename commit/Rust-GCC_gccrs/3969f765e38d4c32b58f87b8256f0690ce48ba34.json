{"sha": "3969f765e38d4c32b58f87b8256f0690ce48ba34", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mzk2OWY3NjVlMzhkNGMzMmI1OGY4N2I4MjU2ZjA2OTBjZTQ4YmEzNA==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-02-05T11:16:33Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-02-05T11:16:33Z"}, "message": "re PR fortran/32315 (DATA with implied-do: Bounds checks missing [regression vs. g77])\n\n2008-02-05  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/32315\n\t* data.c (gfc_assign_data_value): Add bounds check for array\n\treferences.\n\n2008-02-05  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/32315\n\t* gfortran.dg/data_bounds_1.f90: New test.\n\nFrom-SVN: r132113", "tree": {"sha": "76d03a98e8e40b4bc08cfd374a29a641ed449b26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/76d03a98e8e40b4bc08cfd374a29a641ed449b26"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3969f765e38d4c32b58f87b8256f0690ce48ba34", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3969f765e38d4c32b58f87b8256f0690ce48ba34", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3969f765e38d4c32b58f87b8256f0690ce48ba34", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3969f765e38d4c32b58f87b8256f0690ce48ba34/comments", "author": null, "committer": null, "parents": [{"sha": "3467b230ffd4f43407c6643d8990f545e06aa32f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3467b230ffd4f43407c6643d8990f545e06aa32f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3467b230ffd4f43407c6643d8990f545e06aa32f"}], "stats": {"total": 49, "additions": 49, "deletions": 0}, "files": [{"sha": "97a1a179f2d5a92f2616c6d0e5821d9ec6393f04", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=3969f765e38d4c32b58f87b8256f0690ce48ba34", "patch": "@@ -1,3 +1,9 @@\n+2008-02-05  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/32315\n+\t* data.c (gfc_assign_data_value): Add bounds check for array\n+\treferences.\n+\n 2008-02-04  Daniel Franke  <franke.daniel@gmail.com>\n \n \t* resolve.c (resolve_where): Fix typo."}, {"sha": "10fcd48676e4af274dd980495dfdb2cd455c22e6", "filename": "gcc/fortran/data.c", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ffortran%2Fdata.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ffortran%2Fdata.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdata.c?ref=3969f765e38d4c32b58f87b8256f0690ce48ba34", "patch": "@@ -311,6 +311,27 @@ gfc_assign_data_value (gfc_expr *lvalue, gfc_expr *rvalue, mpz_t index)\n \t  else\n \t    mpz_set (offset, index);\n \n+\t  /* Check the bounds.  */\n+\t  if (mpz_cmp_si (offset, 0) < 0)\n+\t    {\n+\t      gfc_error (\"Data element below array lower bound at %L\",\n+\t\t\t &lvalue->where);\n+\t      return FAILURE;\n+\t    }\n+\t  else\n+\t    {\n+\t      mpz_t size;\n+\t      if (spec_size (ref->u.ar.as, &size) == SUCCESS\n+\t\t   && mpz_cmp (offset, size) >= 0)\n+\t\t{\n+\t\t  mpz_clear (size);\n+\t\t  gfc_error (\"Data element above array upper bound at %L\",\n+\t\t\t     &lvalue->where);\n+\t\t  return FAILURE;\n+\t\t}\n+\t      mpz_clear (size);\n+\t    }\n+\n \t  /* Splay tree containing offset and gfc_constructor.  */\n \t  spt = expr->con_by_offset;\n "}, {"sha": "4c1b912ab935baece88ab745ae8c661d253a9711", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3969f765e38d4c32b58f87b8256f0690ce48ba34", "patch": "@@ -1,3 +1,8 @@\n+2008-02-05  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/32315\n+\t* gfortran.dg/data_bounds_1.f90: New test.\n+\n 2008-02-04  Diego Novillo  <dnovillo@google.com>\n \n \thttp://gcc.gnu.org/ml/gcc-patches/2008-02/msg00110.html"}, {"sha": "b20aa415b8a2bce5f981f74a16f16f8aceb3aa09", "filename": "gcc/testsuite/gfortran.dg/data_bounds_1.f90", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_bounds_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3969f765e38d4c32b58f87b8256f0690ce48ba34/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_bounds_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_bounds_1.f90?ref=3969f765e38d4c32b58f87b8256f0690ce48ba34", "patch": "@@ -0,0 +1,17 @@\n+! { dg-do compile }\n+! Checks the fix for PR32315, in which the bounds checks below were not being done.\n+!\n+! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n+!\n+program chkdata\n+    character(len=20), dimension(4) :: string\n+    character(len=20), dimension(0:1,3:4) :: string2\n+\n+    data (string(i) ,i = 4, 5) /'D', 'E'/ ! { dg-error \"above array upper bound\" }\n+    data (string(i) ,i = 0, 1) /'A', 'B'/ ! { dg-error \"below array lower bound\" }\n+    data (string(i) ,i = 1, 4) /'A', 'B', 'C', 'D'/\n+\n+    data ((string2(i, j) ,i = 1, 2), j = 3, 4) /'A', 'B', 'C', 'D'/ ! { dg-error \"above array upper bound\" }\n+    data ((string2(i, j) ,i = 0, 1), j = 2, 3) /'A', 'B', 'C', 'D'/ ! { dg-error \"below array lower bound\" }\n+    data ((string2(i, j) ,i = 0, 1), j = 3, 4) /'A', 'B', 'C', 'D'/\n+end program chkdata"}]}