{"sha": "cbc1994b2f3fee67209b7476f62ea698902e39f3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2JjMTk5NGIyZjNmZWU2NzIwOWI3NDc2ZjYyZWE2OTg5MDJlMzlmMw==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2011-07-26T18:48:08Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2011-07-26T18:48:08Z"}, "message": "Fix PR47653: do not handle loops using wrapping semantics in graphite\n\n2011-07-26  Sebastian Pop  <sebastian.pop@amd.com>\n\n\tPR middle-end/47653\n\t* graphite-scop-detection.c (graphite_can_represent_loop): Discard\n\tloops using wrapping semantics.\n\n\t* gcc.dg/graphite/run-id-pr47653.c: New.\n\t* gcc.dg/graphite/interchange-3.c: Do not use unsigned types for\n\tinduction variables.\n\t* gcc.dg/graphite/scop-16.c: Same.\n\t* gcc.dg/graphite/scop-17.c: Same.\n\t* gcc.dg/graphite/scop-21.c: Same.\n\nFrom-SVN: r176802", "tree": {"sha": "717f3710390fd5f55896b7b7ad3148282cc98438", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/717f3710390fd5f55896b7b7ad3148282cc98438"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cbc1994b2f3fee67209b7476f62ea698902e39f3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbc1994b2f3fee67209b7476f62ea698902e39f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cbc1994b2f3fee67209b7476f62ea698902e39f3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbc1994b2f3fee67209b7476f62ea698902e39f3/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4c7d675552917db06371e5316b6a170b246a0653", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c7d675552917db06371e5316b6a170b246a0653", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c7d675552917db06371e5316b6a170b246a0653"}], "stats": {"total": 61, "additions": 47, "deletions": 14}, "files": [{"sha": "92ca45b4dbc12ad863572bd9801124a8eed8f322", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -1,3 +1,9 @@\n+2011-07-26  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\tPR middle-end/47653\n+\t* graphite-scop-detection.c (graphite_can_represent_loop): Discard\n+\tloops using wrapping semantics.\n+\n 2011-07-26  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR middle-end/48805"}, {"sha": "346056899d31466379f89ed213ea49de898ec9b9", "filename": "gcc/graphite-scop-detection.c", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Fgraphite-scop-detection.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Fgraphite-scop-detection.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-scop-detection.c?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -378,17 +378,17 @@ harmful_stmt_in_bb (basic_block scop_entry, loop_p outer_loop, basic_block bb)\n static bool\n graphite_can_represent_loop (basic_block scop_entry, loop_p loop)\n {\n-  tree niter = number_of_latch_executions (loop);\n+  tree niter;\n+  struct tree_niter_desc niter_desc;\n \n-  /* Number of iterations unknown.  */\n-  if (chrec_contains_undetermined (niter))\n-    return false;\n-\n-  /* Number of iterations not affine.  */\n-  if (!graphite_can_represent_expr (scop_entry, loop, niter))\n-    return false;\n+  /* FIXME: For the moment, graphite cannot be used on loops that\n+     iterate using induction variables that wrap.  */\n \n-  return true;\n+  return number_of_iterations_exit (loop, single_exit (loop), &niter_desc, false)\n+    && niter_desc.control.no_overflow\n+    && (niter = number_of_latch_executions (loop))\n+    && !chrec_contains_undetermined (niter)\n+    && graphite_can_represent_expr (scop_entry, loop, niter);\n }\n \n /* Store information needed by scopdet_* functions.  */"}, {"sha": "4efc523376b8963f3662b76e783e86141a71ddab", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -1,3 +1,13 @@\n+2011-07-26  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\tPR middle-end/47653\n+\t* gcc.dg/graphite/run-id-pr47653.c: New.\n+\t* gcc.dg/graphite/interchange-3.c: Do not use unsigned types for\n+\tinduction variables.\n+\t* gcc.dg/graphite/scop-16.c: Same.\n+\t* gcc.dg/graphite/scop-17.c: Same.\n+\t* gcc.dg/graphite/scop-21.c: Same.\n+\n 2011-07-26  Sebastian Pop  <sebastian.pop@amd.com>\n \n \tPR middle-end/48805"}, {"sha": "1419749243a965cbb684203cfc563b9bc34c5ad4", "filename": "gcc/testsuite/gcc.dg/graphite/interchange-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Finterchange-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Finterchange-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Finterchange-3.c?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -12,7 +12,7 @@ double u[1782225];\n static void __attribute__((noinline))\n foo (int N, int *res)\n {\n-  unsigned int i, j;\n+  int i, j;\n   double sum = 0;\n   for (i = 0; i < N; i++)\n     {"}, {"sha": "b62b891d99634ab0ede86d6188b7340ae90c5be3", "filename": "gcc/testsuite/gcc.dg/graphite/run-id-pr47653.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Frun-id-pr47653.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Frun-id-pr47653.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Frun-id-pr47653.c?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-options \"-O -fstack-check=generic -ftree-pre -fgraphite-identity\" } */\n+\n+int main ()\n+{\n+  int i, j;\n+  int x[8][8];\n+  for (i = 0; i < 8; i++)\n+    for (j = i; j < 8; j++)\n+      x[i][j] = 4;\n+\n+  for (i = 0; i < 8; i++)\n+    for (j = i; j < 8; j++)\n+      if (x[i][j] != 4)\n+\t__builtin_abort ();\n+\n+  return 0;\n+}"}, {"sha": "83cbb9698668fd759a7511ad534c72ab55b6697d", "filename": "gcc/testsuite/gcc.dg/graphite/scop-16.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-16.c?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -6,7 +6,7 @@ int test ()\n {\n   int a[N][N];\n   int b[N][N];\n-  unsigned i, j;\n+  int i, j;\n \n   for (i = 0; i < N; i++) \n     for (j = 0; j < N; j++)"}, {"sha": "a7dff5f6c02ab3a51e192c4eff353071cba3990e", "filename": "gcc/testsuite/gcc.dg/graphite/scop-17.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-17.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-17.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-17.c?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -5,7 +5,7 @@ void foo (int);\n int test ()\n {\n   int a[N][N];\n-  unsigned i, j;\n+  int i, j;\n \n   for (i = 0; i < N; i++) \n     for (j = 0; j < N; j++)"}, {"sha": "1cbad5d8cd15efaca8afb84d801b7b37d48d01bc", "filename": "gcc/testsuite/gcc.dg/graphite/scop-21.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-21.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-21.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fscop-21.c?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -3,7 +3,7 @@ void foo (int);\n int test ()\n {\n   int a[N+6];\n-  unsigned i;\n+  int i;\n \n   for (i = 0; i < N; i++)\n     {"}, {"sha": "71ed3324307f7b8d43beb819d8ae8223c392255b", "filename": "libgomp/testsuite/libgomp.graphite/force-parallel-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cbc1994b2f3fee67209b7476f62ea698902e39f3/libgomp%2Ftestsuite%2Flibgomp.graphite%2Fforce-parallel-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cbc1994b2f3fee67209b7476f62ea698902e39f3/libgomp%2Ftestsuite%2Flibgomp.graphite%2Fforce-parallel-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.graphite%2Fforce-parallel-1.c?ref=cbc1994b2f3fee67209b7476f62ea698902e39f3", "patch": "@@ -23,7 +23,7 @@ int main(void)\n }\n \n /* Check that parallel code generation part make the right answer.  */\n-/* { dg-final { scan-tree-dump-times \"1 loops carried no dependency\" 2 \"graphite\" } } */\n+/* { dg-final { scan-tree-dump-times \"1 loops carried no dependency\" 2 \"graphite\" { xfail *-*-* } } } */\n /* { dg-final { cleanup-tree-dump \"graphite\" } } */\n /* { dg-final { scan-tree-dump-times \"loopfn\" 5 \"optimized\" } } */\n /* { dg-final { cleanup-tree-dump \"parloops\" } } */"}]}