{"sha": "410bd69891071449226b009b3e53d7fe82bc06f1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDEwYmQ2OTg5MTA3MTQ0OTIyNmIwMDliM2U1M2Q3ZmU4MmJjMDZmMQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1996-09-22T15:12:06Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1996-09-22T15:12:06Z"}, "message": "(combine_givs): Improve combining DEST_REG giv with its only use.\n\nFrom-SVN: r12769", "tree": {"sha": "95b6498cfbec1c71e9004ec509e0394bf612c806", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/95b6498cfbec1c71e9004ec509e0394bf612c806"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/410bd69891071449226b009b3e53d7fe82bc06f1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/410bd69891071449226b009b3e53d7fe82bc06f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/410bd69891071449226b009b3e53d7fe82bc06f1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/410bd69891071449226b009b3e53d7fe82bc06f1/comments", "author": null, "committer": null, "parents": [{"sha": "039f5fb1a88e320122a4120946f639fd0300d726", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/039f5fb1a88e320122a4120946f639fd0300d726", "html_url": "https://github.com/Rust-GCC/gccrs/commit/039f5fb1a88e320122a4120946f639fd0300d726"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "b3c49a4dd03ceed62c6419d47e908f7e58024269", "filename": "gcc/loop.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/410bd69891071449226b009b3e53d7fe82bc06f1/gcc%2Floop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/410bd69891071449226b009b3e53d7fe82bc06f1/gcc%2Floop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop.c?ref=410bd69891071449226b009b3e53d7fe82bc06f1", "patch": "@@ -1,5 +1,5 @@\n /* Perform various loop optimizations, including strength reduction.\n-   Copyright (C) 1987, 88, 89, 91-4, 1995 Free Software Foundation, Inc.\n+   Copyright (C) 1987, 88, 89, 91-5, 1996 Free Software Foundation, Inc.\n \n This file is part of GNU CC.\n \n@@ -5672,14 +5672,26 @@ combine_givs (bl)\n \t\t/* g2->new_reg set by `combine_givs_p'  */\n \t\tg2->same = g1;\n \t\tg1->combined_with = 1;\n-\t\tg1->benefit += g2->benefit;\n+\n+\t\t/* If one of these givs is a DEST_REG that was only used\n+\t\t   once, by the other giv, this is actually a single use.  */\n+\t\tif ((g1->giv_type != DEST_REG\n+\t\t     || n_times_used[REGNO (g1->dest_reg)] != 1\n+\t\t     || ! reg_mentioned_p (g1->dest_reg, PATTERN (g2->insn)))\n+\t\t    && (g2->giv_type != DEST_REG\n+\t\t\t|| n_times_used[REGNO (g2->dest_reg)] != 1\n+\t\t\t|| ! reg_mentioned_p (g2->dest_reg,\n+\t\t\t\t\t      PATTERN (g1->insn))))\n+\t\t  {\n+\t\t    g1->benefit += g2->benefit;\n+\t\t    g1->times_used += g2->times_used;\n+\t\t  }\n \t\t/* ??? The new final_[bg]iv_value code does a much better job\n \t\t   of finding replaceable giv's, and hence this code may no\n \t\t   longer be necessary.  */\n \t\tif (! g2->replaceable && REG_USERVAR_P (g2->dest_reg))\n \t\t  g1->benefit -= copy_cost;\n \t\tg1->lifetime += g2->lifetime;\n-\t\tg1->times_used += g2->times_used;\n \t\t\n \t\tif (loop_dump_stream)\n \t\t  fprintf (loop_dump_stream, \"giv at %d combined with giv at %d\\n\","}]}