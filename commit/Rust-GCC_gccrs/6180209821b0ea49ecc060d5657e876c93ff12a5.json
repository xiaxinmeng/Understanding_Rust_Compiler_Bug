{"sha": "6180209821b0ea49ecc060d5657e876c93ff12a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjE4MDIwOTgyMWIwZWE0OWVjYzA2MGQ1NjU3ZTg3NmM5M2ZmMTJhNQ==", "commit": {"author": {"name": "John David Anglin", "email": "dave.anglin@nrc-cnrc.gc.ca", "date": "2012-12-16T17:34:58Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2012-12-16T17:34:58Z"}, "message": "re PR middle-end/55709 (Infinite loop in pointer_set_insert compiling cp/pt.c)\n\n\tPR middle-end/55709\n\tForward port from 4.7 branch:\n\t2012-04-10  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n\n\tPR middle-end/52894\n\t* varasm.c (process_pending_assemble_externals): Set\n\tpending_assemble_externals_processed true.\n\t(assemble_external): Call assemble_external_real if the pending\n\tassemble externals have been processed.\n\nFrom-SVN: r194538", "tree": {"sha": "8ca040f2f18e62eaa90b69da9d175142cbab6232", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ca040f2f18e62eaa90b69da9d175142cbab6232"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6180209821b0ea49ecc060d5657e876c93ff12a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6180209821b0ea49ecc060d5657e876c93ff12a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6180209821b0ea49ecc060d5657e876c93ff12a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6180209821b0ea49ecc060d5657e876c93ff12a5/comments", "author": null, "committer": null, "parents": [{"sha": "df0b360e3e82962e7b5e805c130a38593b646a80", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df0b360e3e82962e7b5e805c130a38593b646a80", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df0b360e3e82962e7b5e805c130a38593b646a80"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "a64aaec921116098808652efc1d9b9b4d83792f7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6180209821b0ea49ecc060d5657e876c93ff12a5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6180209821b0ea49ecc060d5657e876c93ff12a5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6180209821b0ea49ecc060d5657e876c93ff12a5", "patch": "@@ -1,3 +1,15 @@\n+2012-12-16  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n+\n+\tPR middle-end/55709\n+\tForward port from 4.7 branch:\n+\t2012-04-10  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n+\n+\tPR middle-end/52894\n+\t* varasm.c (process_pending_assemble_externals): Set\n+\tpending_assemble_externals_processed true.\n+\t(assemble_external): Call assemble_external_real if the pending\n+\tassemble externals have been processed.\n+\n 2012-12-16  Eric Botcazou  <ebotcazou@adacore.com>\n \t    Tomash Brechko  <tomash.brechko@gmail.com>\n "}, {"sha": "daeb6e2a829716684b84f9f343f8ad4fbdbcc623", "filename": "gcc/varasm.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6180209821b0ea49ecc060d5657e876c93ff12a5/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6180209821b0ea49ecc060d5657e876c93ff12a5/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=6180209821b0ea49ecc060d5657e876c93ff12a5", "patch": "@@ -2088,6 +2088,11 @@ contains_pointers_p (tree type)\n    it all the way to final.  See PR 17982 for further discussion.  */\n static GTY(()) tree pending_assemble_externals;\n \n+/* Some targets delay some output to final using TARGET_ASM_FILE_END.\n+   As a result, assemble_external can be called after the list of externals\n+   is processed and the pointer set destroyed.  */\n+static bool pending_assemble_externals_processed;\n+\n #ifdef ASM_OUTPUT_EXTERNAL\n /* Avoid O(external_decls**2) lookups in the pending_assemble_externals\n    TREE_LIST in assemble_external.  */\n@@ -2144,6 +2149,7 @@ process_pending_assemble_externals (void)\n     assemble_external_real (TREE_VALUE (list));\n \n   pending_assemble_externals = 0;\n+  pending_assemble_externals_processed = true;\n   pointer_set_destroy (pending_assemble_externals_set);\n #endif\n }\n@@ -2196,6 +2202,12 @@ assemble_external (tree decl ATTRIBUTE_UNUSED)\n     weak_decls = tree_cons (NULL, decl, weak_decls);\n \n #ifdef ASM_OUTPUT_EXTERNAL\n+  if (pending_assemble_externals_processed)\n+    {\n+      assemble_external_real (decl);\n+      return;\n+    }\n+\n   if (! pointer_set_insert (pending_assemble_externals_set, decl))\n     pending_assemble_externals = tree_cons (NULL, decl,\n \t\t\t\t\t    pending_assemble_externals);"}]}