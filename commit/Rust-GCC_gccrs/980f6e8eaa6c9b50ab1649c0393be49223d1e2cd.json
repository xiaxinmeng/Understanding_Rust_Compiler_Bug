{"sha": "980f6e8eaa6c9b50ab1649c0393be49223d1e2cd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTgwZjZlOGVhYTZjOWI1MGFiMTY0OWMwMzkzYmU0OTIyM2QxZTJjZA==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@bigpond.net.au", "date": "2003-08-06T03:26:17Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2003-08-06T03:26:17Z"}, "message": "calls.c (load_register_parameters): Arrange for call_fusage to report the whole register as used when...\n\n\t* calls.c (load_register_parameters): Arrange for call_fusage to\n\treport the whole register as used when shifting to the msb.\n\nFrom-SVN: r70201", "tree": {"sha": "0aa64ae9fcc6a0d1c0d433ffd189dbcf5f2c30cb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0aa64ae9fcc6a0d1c0d433ffd189dbcf5f2c30cb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd/comments", "author": null, "committer": null, "parents": [{"sha": "e7cca7f486e436239d55228fd2ff26ee96871a07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7cca7f486e436239d55228fd2ff26ee96871a07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e7cca7f486e436239d55228fd2ff26ee96871a07"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "e3774ae70fa053e0bf629cbb99eedb5fdc574c96", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=980f6e8eaa6c9b50ab1649c0393be49223d1e2cd", "patch": "@@ -1,3 +1,8 @@\n+2003-08-06  Alan Modra  <amodra@bigpond.net.au>\n+\n+\t* calls.c (load_register_parameters): Arrange for call_fusage to\n+\treport the whole register as used when shifting to the msb.\n+\n 2003-08-05  Roger Sayle  <roger@eyesopen.com>\n \n \t* builtins.c (expand_builtin): When not optimizing, call the library"}, {"sha": "bdb4288100f752bb1d7baa16aefde6dfd36eca9f", "filename": "gcc/calls.c", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd/gcc%2Fcalls.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/980f6e8eaa6c9b50ab1649c0393be49223d1e2cd/gcc%2Fcalls.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcalls.c?ref=980f6e8eaa6c9b50ab1649c0393be49223d1e2cd", "patch": "@@ -1633,13 +1633,18 @@ load_register_parameters (struct arg_data *args, int num_actuals,\n \t\t  && (args[i].locate.where_pad\n \t\t      == (BYTES_BIG_ENDIAN ? upward : downward)))\n \t\t{\n-\t\t  rtx ri = gen_rtx_REG (word_mode, REGNO (reg));\n \t\t  rtx x;\n \t\t  int shift = (UNITS_PER_WORD - size) * BITS_PER_UNIT;\n-\t\t  x = expand_binop (word_mode, ashl_optab, ri,\n-\t\t\t\t    GEN_INT (shift), ri, 1, OPTAB_WIDEN);\n-\t\t  if (x != ri)\n-\t\t    emit_move_insn (ri, x);\n+\n+\t\t  /* Assigning REG here rather than a temp makes CALL_FUSAGE\n+\t\t     report the whole reg as used.  Strictly speaking, the\n+\t\t     call only uses SIZE bytes at the msb end, but it doesn't\n+\t\t     seem worth generating rtl to say that.  */\n+\t\t  reg = gen_rtx_REG (word_mode, REGNO (reg));\n+\t\t  x = expand_binop (word_mode, ashl_optab, reg,\n+\t\t\t\t    GEN_INT (shift), reg, 1, OPTAB_WIDEN);\n+\t\t  if (x != reg)\n+\t\t    emit_move_insn (reg, x);\n \t\t}\n #endif\n \t    }"}]}