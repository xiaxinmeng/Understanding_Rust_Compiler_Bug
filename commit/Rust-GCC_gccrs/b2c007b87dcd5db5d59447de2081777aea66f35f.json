{"sha": "b2c007b87dcd5db5d59447de2081777aea66f35f", "node_id": "C_kwDOANBUbNoAKGIyYzAwN2I4N2RjZDVkYjVkNTk0NDdkZTIwODE3NzdhZWE2NmYzNWY", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-04-12T16:17:20Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-04-12T21:38:31Z"}, "message": "libstdc++: shrink-to-fit in std::basic_stacktrace::current(skip, max)\n\nIf a large stacktrace is reduced to a max depth that is less than half\nthe capacity it will now be reallocated to remove the unused capacity.\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/std/stacktrace (basic_stacktrace::current): Reallocate\n\ta smaller container if the unused capacity is larger than the\n\tused size.", "tree": {"sha": "285fac827988c1854b25808b40f2dfea0c5429a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/285fac827988c1854b25808b40f2dfea0c5429a0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b2c007b87dcd5db5d59447de2081777aea66f35f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2c007b87dcd5db5d59447de2081777aea66f35f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2c007b87dcd5db5d59447de2081777aea66f35f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2c007b87dcd5db5d59447de2081777aea66f35f/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7cf88759957a7006e1e1d0a82a1a4de3c4db109e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7cf88759957a7006e1e1d0a82a1a4de3c4db109e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7cf88759957a7006e1e1d0a82a1a4de3c4db109e"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "98ce92311501515f2cf799ae2dd48a055882aaf3", "filename": "libstdc++-v3/include/std/stacktrace", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2c007b87dcd5db5d59447de2081777aea66f35f/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstacktrace", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2c007b87dcd5db5d59447de2081777aea66f35f/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstacktrace", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fstacktrace?ref=b2c007b87dcd5db5d59447de2081777aea66f35f", "patch": "@@ -289,7 +289,20 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t    if (__err < 0)\n \t      __ret._M_clear();\n \t    else if (__ret.size() > __max_depth)\n-\t      __ret._M_impl._M_resize(__max_depth, __ret._M_alloc);\n+\t      {\n+\t\t__ret._M_impl._M_resize(__max_depth, __ret._M_alloc);\n+\n+\t\tif (__ret._M_impl._M_capacity / 2 >= __max_depth)\n+\t\t  {\n+\t\t    // shrink to fit\n+\t\t    _Impl __tmp = __ret._M_impl._M_clone(__ret._M_alloc);\n+\t\t    if (__tmp._M_capacity)\n+\t\t      {\n+\t\t\t__ret._M_clear();\n+\t\t\t__ret._M_impl = __tmp;\n+\t\t      }\n+\t\t  }\n+\t      }\n \t  }\n \treturn __ret;\n       }"}]}