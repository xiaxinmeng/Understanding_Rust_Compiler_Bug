{"sha": "bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmZiMTE0N2NhODk2Zjk4NWEyMjY4YjdiNmEwYmE0YjM2Mzk0ZjhjYw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2018-11-14T11:41:53Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-11-14T11:41:53Z"}, "message": "[Ada] Fix assertion failure on pragma Compile_Time_Error in generic unit\n\nThere is no point in validating 'Alignment or 'Size of an entity\ndeclared in a generic unit after the back-end has been run, since such\nan entity is not passed to the back-end, and this can even lead to an\nassertion failure.\n\n2018-11-14  Eric Botcazou  <ebotcazou@adacore.com>\n\ngcc/ada/\n\n\t* sem_prag.adb (Process_Compile_Time_Warning_Or_Error): Don't\n\tregister a compile-time warning or error for 'Alignment or 'Size\n\tof an entity declared in a generic unit.\n\ngcc/testsuite/\n\n\t* gnat.dg/compile_time_error1.adb,\n\tgnat.dg/compile_time_error1.ads,\n\tgnat.dg/compile_time_error1_pkg.ads: New testcase.\n\nFrom-SVN: r266127", "tree": {"sha": "805a003dcb59ae73a5739f8dce05a6af228c0cac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/805a003dcb59ae73a5739f8dce05a6af228c0cac"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/comments", "author": null, "committer": null, "parents": [{"sha": "b7c34dff67750bf38d8b8d89ea44c01d8c7c5870", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7c34dff67750bf38d8b8d89ea44c01d8c7c5870", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7c34dff67750bf38d8b8d89ea44c01d8c7c5870"}], "stats": {"total": 44, "additions": 44, "deletions": 0}, "files": [{"sha": "82329ac9a2398ea6f9e1acf87e797ed846ea0381", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "patch": "@@ -1,3 +1,9 @@\n+2018-11-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* sem_prag.adb (Process_Compile_Time_Warning_Or_Error): Don't\n+\tregister a compile-time warning or error for 'Alignment or 'Size\n+\tof an entity declared in a generic unit.\n+\n 2018-11-14  Justin Squirek  <squirek@adacore.com>\n \n \t* sem_ch8.adb (Use_One_Package): Add test for out-of-scope"}, {"sha": "cda8629de68c6b04d4ee99f6d811b2011d6d5715", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "patch": "@@ -7545,6 +7545,7 @@ package body Sem_Prag is\n          begin\n             if Nkind (N) = N_Attribute_Reference\n               and then Is_Entity_Name (Prefix (N))\n+              and then not Is_Generic_Unit (Scope (Entity (Prefix (N))))\n             then\n                declare\n                   Attr_Id : constant Attribute_Id :="}, {"sha": "00ad237ac25608fd9ff2f89a758d981406c2f2bb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "patch": "@@ -1,3 +1,9 @@\n+2018-11-14  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/compile_time_error1.adb,\n+\tgnat.dg/compile_time_error1.ads,\n+\tgnat.dg/compile_time_error1_pkg.ads: New testcase.\n+\n 2018-11-14  Justin Squirek  <squirek@adacore.com>\n \n \t* gnat.dg/generic_pkg.adb: New testcase."}, {"sha": "db55f587a2f616350efe5e0887eaad252fcf25c6", "filename": "gcc/testsuite/gnat.dg/compile_time_error1.adb", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1.adb?ref=bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "patch": "@@ -0,0 +1,7 @@\n+--  { dg-do compile }\n+\n+package body Compile_Time_Error1 is\n+\n+  procedure Dummy is null;\n+\n+end Compile_Time_Error1;"}, {"sha": "f4f83338b2f4b207c4e6ea85e4e17ab765397d32", "filename": "gcc/testsuite/gnat.dg/compile_time_error1.ads", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1.ads?ref=bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "patch": "@@ -0,0 +1,13 @@\n+with Compile_Time_Error1_Pkg;\n+\n+package Compile_Time_Error1 is\n+\n+  type Rec is record\n+    I : Integer;\n+  end record;\n+\n+  package Inst is new Compile_Time_Error1_Pkg (Rec);\n+\n+  procedure Dummy;\n+\n+end Compile_Time_Error1;"}, {"sha": "92238577246f02e44bf8719ec4e83af4f3831120", "filename": "gcc/testsuite/gnat.dg/compile_time_error1_pkg.ads", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfb1147ca896f985a2268b7b6a0ba4b36394f8cc/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fcompile_time_error1_pkg.ads?ref=bfb1147ca896f985a2268b7b6a0ba4b36394f8cc", "patch": "@@ -0,0 +1,11 @@\n+generic\n+\n+  type T is private;\n+\n+package Compile_Time_Error1_Pkg is\n+\n+  pragma Compile_Time_Error (T'Size not in 8 | 16 | 32, \"type too large\");\n+\n+  Data : T;\n+\n+end Compile_Time_Error1_Pkg;"}]}