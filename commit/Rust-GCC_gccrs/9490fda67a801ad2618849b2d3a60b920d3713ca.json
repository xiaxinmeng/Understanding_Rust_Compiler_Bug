{"sha": "9490fda67a801ad2618849b2d3a60b920d3713ca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQ5MGZkYTY3YTgwMWFkMjYxODg0OWIyZDNhNjBiOTIwZDM3MTNjYQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2014-07-02T14:23:45Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2014-07-02T14:23:45Z"}, "message": "re PR go/61620 (FAIL: go.test/test/fixedbugs/bug242.go execution,  -O2 -g)\n\n\tPR go/61620\n\nruntime: Don't free tiny blocks in map deletion.\n\nThe memory allocator now has a special case for tiny blocks\n(smaller than 16 bytes) and they can not be explicitly freed.\n\nFrom-SVN: r212233", "tree": {"sha": "b1f7f5b6fb32131dd3b18b057a6e9ac979581aca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1f7f5b6fb32131dd3b18b057a6e9ac979581aca"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9490fda67a801ad2618849b2d3a60b920d3713ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9490fda67a801ad2618849b2d3a60b920d3713ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9490fda67a801ad2618849b2d3a60b920d3713ca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9490fda67a801ad2618849b2d3a60b920d3713ca/comments", "author": null, "committer": null, "parents": [{"sha": "513c5c74ce490ee5fb4ca88585808f44065ec57a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/513c5c74ce490ee5fb4ca88585808f44065ec57a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/513c5c74ce490ee5fb4ca88585808f44065ec57a"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "de8b0469deaf394e0e1648ce91d73e710d0e9379", "filename": "libgo/runtime/go-map-delete.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9490fda67a801ad2618849b2d3a60b920d3713ca/libgo%2Fruntime%2Fgo-map-delete.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9490fda67a801ad2618849b2d3a60b920d3713ca/libgo%2Fruntime%2Fgo-map-delete.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fruntime%2Fgo-map-delete.c?ref=9490fda67a801ad2618849b2d3a60b920d3713ca", "patch": "@@ -8,6 +8,7 @@\n #include <stdlib.h>\n \n #include \"runtime.h\"\n+#include \"malloc.h\"\n #include \"go-alloc.h\"\n #include \"go-assert.h\"\n #include \"map.h\"\n@@ -47,7 +48,8 @@ __go_map_delete (struct __go_map *map, const void *key)\n       if (equalfn (key, entry + key_offset, key_size))\n \t{\n \t  *pentry = *(void **) entry;\n-\t  __go_free (entry);\n+\t  if (descriptor->__entry_size >= TinySize)\n+\t    __go_free (entry);\n \t  map->__element_count -= 1;\n \t  break;\n \t}"}]}