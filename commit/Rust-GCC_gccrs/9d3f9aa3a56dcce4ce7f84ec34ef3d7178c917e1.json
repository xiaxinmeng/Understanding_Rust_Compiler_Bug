{"sha": "9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWQzZjlhYTNhNTZkY2NlNGNlN2Y4NGVjMzRlZjNkNzE3OGM5MTdlMQ==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernd.schmidt@analog.com", "date": "2007-04-12T13:21:01Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2007-04-12T13:21:01Z"}, "message": "bfin.opt (msim): New option.\n\n\t2007-02-11  Jie Zhang  <jie.zhang@analog.com>\n\t* config/bfin/bfin.opt (msim): New option.\n\t(mcpu=): New option.\n\t* config/bfin/bfin-protos.h (enum bfin_cpu): New.\n\t(bfin_cpu_t): Typedef of enum bfin_cpu.\n\t(bfin_cpu_type): New declaration.\n\t* config/bfin/elf.h (STARTFILE_SPEC): Add support for\n\t-msim and -mcpu= options.\n\t(LIB_SPEC): Likewise.\n\t* config/bfin/bfin.c (bfin_cpu_type): Define.\n\t(bfin_handle_option): Handle -mcpu= option.\n\t* config/bfin/bfin.h (DEFAULT_CPU_TYPE): Define as BFIN_CPU_BF532.\n\t(TARGET_CPU_CPP_BUILTINS): Define __ADSPBF531__, __ADSPBF532__,\n\t__ADSPBF533__ or __ADSPBF537__ according to the cpu type.\n\nFrom-SVN: r123747", "tree": {"sha": "c8f490573c094eb6c948bef883c9b43fa01c835b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c8f490573c094eb6c948bef883c9b43fa01c835b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/comments", "author": null, "committer": null, "parents": [{"sha": "c18b8a1c11ff33953f197ace1d1f81d3a5d4c005", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c18b8a1c11ff33953f197ace1d1f81d3a5d4c005", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c18b8a1c11ff33953f197ace1d1f81d3a5d4c005"}], "stats": {"total": 87, "additions": 86, "deletions": 1}, "files": [{"sha": "07f8a5b64201b1801f2b0c127fbb21c3b207006c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "patch": "@@ -17,6 +17,21 @@\n \t(flag_macinit1hi): Tighten constraints.\n \t(flag_mul_macv2hi_parts_acconly): New pattern.\n \n+\t2007-02-11  Jie Zhang  <jie.zhang@analog.com>\n+\t* config/bfin/bfin.opt (msim): New option.\n+\t(mcpu=): New option.\n+\t* config/bfin/bfin-protos.h (enum bfin_cpu): New.\n+\t(bfin_cpu_t): Typedef of enum bfin_cpu.\n+\t(bfin_cpu_type): New declaration.\n+\t* config/bfin/elf.h (STARTFILE_SPEC): Add support for\n+\t-msim and -mcpu= options.\n+\t(LIB_SPEC): Likewise.\n+\t* config/bfin/bfin.c (bfin_cpu_type): Define.\n+\t(bfin_handle_option): Handle -mcpu= option.\n+\t* config/bfin/bfin.h (DEFAULT_CPU_TYPE): Define as BFIN_CPU_BF532.\n+\t(TARGET_CPU_CPP_BUILTINS): Define __ADSPBF531__, __ADSPBF532__,\n+\t__ADSPBF533__ or __ADSPBF537__ according to the cpu type.\n+\n 2007-04-12  Richard Sandiford  <richard@codesourcery.com>\n \n \t* config.gcc (*-*-vxworks*): Don't add to tm_files in this stanza."}, {"sha": "99151fa9bfd1329254607f07cbbda4320896e407", "filename": "gcc/config/bfin/bfin-protos.h", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin-protos.h?ref=9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "patch": "@@ -23,6 +23,18 @@\n #ifndef GCC_BFIN_PROTOS_H\n #define GCC_BFIN_PROTOS_H\n \n+/* CPU type.  */\n+typedef enum bfin_cpu\n+{\n+  BFIN_CPU_BF531,\n+  BFIN_CPU_BF532,\n+  BFIN_CPU_BF533,\n+  BFIN_CPU_BF537\n+} bfin_cpu_t;\n+\n+/* Value of -mcpu= */\n+extern bfin_cpu_t bfin_cpu_type;\n+\n #define Mmode enum machine_mode\n \n extern rtx function_arg (CUMULATIVE_ARGS *, Mmode, tree, int);"}, {"sha": "16b40968523e7bda2bab47f348607125b3c80411", "filename": "gcc/config/bfin/bfin.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin.c?ref=9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "patch": "@@ -92,6 +92,9 @@ static int bfin_flag_schedule_insns2;\n    reorganization.  */\n static int bfin_flag_var_tracking;\n \n+/* -mcpu support */\n+bfin_cpu_t bfin_cpu_type = DEFAULT_CPU_TYPE;\n+\n int splitting_for_sched;\n \n static void\n@@ -2058,6 +2061,19 @@ bfin_handle_option (size_t code, const char *arg, int value)\n       bfin_lib_id_given = 1;\n       return true;\n \n+    case OPT_mcpu_:\n+      if (strcmp (arg, \"bf531\") == 0)\n+\tbfin_cpu_type = BFIN_CPU_BF531;\n+      else if (strcmp (arg, \"bf532\") == 0)\n+\tbfin_cpu_type = BFIN_CPU_BF532;\n+      else if (strcmp (arg, \"bf533\") == 0)\n+\tbfin_cpu_type = BFIN_CPU_BF533;\n+      else if (strcmp (arg, \"bf537\") == 0)\n+\tbfin_cpu_type = BFIN_CPU_BF537;\n+      else\n+\treturn false;\n+      return true;\n+\n     default:\n       return true;\n     }"}, {"sha": "3c7f0125e064b63a7dd67a51834d10240cffb3af", "filename": "gcc/config/bfin/bfin.h", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin.h?ref=9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "patch": "@@ -34,6 +34,10 @@\n \n extern int target_flags;\n \n+#ifndef DEFAULT_CPU_TYPE\n+#define DEFAULT_CPU_TYPE BFIN_CPU_BF532\n+#endif\n+\n /* Predefinition in the preprocessor for this target machine */\n #ifndef TARGET_CPU_CPP_BUILTINS\n #define TARGET_CPU_CPP_BUILTINS()               \\\n@@ -42,6 +46,24 @@ extern int target_flags;\n       builtin_define_std (\"bfin\");              \\\n       builtin_define_std (\"BFIN\");              \\\n       builtin_define (\"__ADSPBLACKFIN__\");\t\\\n+      builtin_define (\"__ADSPLPBLACKFIN__\");\t\\\n+\t\t\t\t\t\t\\\n+      switch (bfin_cpu_type)\t\t\t\\\n+\t{\t\t\t\t\t\\\n+\tcase BFIN_CPU_BF531:\t\t\t\\\n+\t  builtin_define (\"__ADSPBF531__\");\t\\\n+\t  break;\t\t\t\t\\\n+\tcase BFIN_CPU_BF532:\t\t\t\\\n+\t  builtin_define (\"__ADSPBF532__\");\t\\\n+\t  break;\t\t\t\t\\\n+\tcase BFIN_CPU_BF533:\t\t\t\\\n+\t  builtin_define (\"__ADSPBF533__\");\t\\\n+\t  break;\t\t\t\t\\\n+\tcase BFIN_CPU_BF537:\t\t\t\\\n+\t  builtin_define (\"__ADSPBF537__\");\t\\\n+\t  break;\t\t\t\t\\\n+\t}\t\t\t\t\t\\\n+\t\t\t\t\t\t\\\n       if (TARGET_FDPIC)\t\t\t\t\\\n \tbuiltin_define (\"__BFIN_FDPIC__\");\t\\\n       if (TARGET_ID_SHARED_LIBRARY)\t\t\\"}, {"sha": "f30f3e6ca8f3199ade126bf212cbd87c798054fb", "filename": "gcc/config/bfin/bfin.opt", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Fbfin.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin.opt?ref=9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "patch": "@@ -19,6 +19,14 @@\n ; Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA\n ; 02110-1301, USA.\n \n+msim\n+Target RejectNegative\n+Use simulator runtime\n+\n+mcpu=\n+Target RejectNegative Joined\n+Specify the name of the target CPU\n+\n momit-leaf-frame-pointer\n Target Report Mask(OMIT_LEAF_FRAME_POINTER)\n Omit frame pointer for leaf functions"}, {"sha": "5148c3095e9f27ed8cafb7816a8f55bcea4c423a", "filename": "gcc/config/bfin/elf.h", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Felf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1/gcc%2Fconfig%2Fbfin%2Felf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Felf.h?ref=9d3f9aa3a56dcce4ce7f84ec34ef3d7178c917e1", "patch": "@@ -7,11 +7,23 @@\n      sprintf (LABEL, \"*%s%s$%d\", LOCAL_LABEL_PREFIX, PREFIX, (int) NUM)\n \n #undef  STARTFILE_SPEC\n-#define STARTFILE_SPEC\t\"%{!shared: crt0%O%s} crti%O%s crtbegin%O%s crtlibid%O%s\"\n+#define STARTFILE_SPEC \"\\\n+%{msim:%{!shared:crt0%O%s}} \\\n+%{!msim:%{mcpu=bf531|mcpu=bf532|mcpu=bf533 \\\n+\t  |mcpu=bf534|mcpu=bf536|mcpu=bf537:crt532%O%s} \\\n+\t%{!mcpu=*:crt532%O%s}} \\\n+crti%O%s crtbegin%O%s crtlibid%O%s\"\n \n #undef  ENDFILE_SPEC\n #define ENDFILE_SPEC\t\"crtend%O%s crtn%O%s\"\n \n+#undef  LIB_SPEC\n+#define LIB_SPEC \"--start-group -lc %{msim:-lsim}%{!msim:-lnosys} --end-group \\\n+%{!T*:%{!msim:%{mcpu=bf531:-Tbf531.ld}%{mcpu=bf532:-Tbf532.ld} \\\n+\t      %{mcpu=bf533:-Tbf533.ld}%{mcpu=bf534:-Tbf534.ld} \\\n+\t      %{mcpu=bf536:-Tbf536.ld}%{mcpu=bf537:-Tbf537.ld} \\\n+\t      %{!mcpu=*:-Tbf532.ld}}}\"\n+\n #undef USER_LABEL_PREFIX\n #define USER_LABEL_PREFIX \"_\"\n "}]}