{"sha": "a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTFlZmNmM2M0MDVmM2FlNGI3NmE0Nzc4YmJiNjMyNmY0YmI4M2M1MA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-05T23:00:56Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-05T23:00:56Z"}, "message": "(cmpdi): Rewrite to avoid bogus matching constraints.\n\nFrom-SVN: r9880", "tree": {"sha": "3d24ed44544526fa370569aa1e242dfa916edbed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3d24ed44544526fa370569aa1e242dfa916edbed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50/comments", "author": null, "committer": null, "parents": [{"sha": "7f49c33119611c0ec226b3497a60520a4d79fac9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f49c33119611c0ec226b3497a60520a4d79fac9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f49c33119611c0ec226b3497a60520a4d79fac9"}], "stats": {"total": 34, "additions": 22, "deletions": 12}, "files": [{"sha": "e16004e48e16d1696130e1a0af03d45677205413", "filename": "gcc/config/m68k/m68k.md", "status": "modified", "additions": 22, "deletions": 12, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50/gcc%2Fconfig%2Fm68k%2Fm68k.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50/gcc%2Fconfig%2Fm68k%2Fm68k.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Fm68k.md?ref=a1efcf3c405f3ae4b76a4778bbb6326f4bb83c50", "patch": "@@ -411,23 +411,33 @@\n \f\n ;; compare instructions.\n \n-(define_insn \"cmpdi\"\n+(define_expand \"cmpdi\"\n+  [(parallel\n+    [(set (cc0)\n+\t  (compare (match_operand:DI 0 \"nonimmediate_operand\" \"\")\n+\t\t   (match_operand:DI 1 \"general_operand\" \"\")))\n+     (clobber (match_dup 2))])]\n+  \"\"\n+  \"\n+{\n+  operands[2] = gen_reg_rtx (DImode);\n+}\")\n+\n+(define_insn \"\"\n   [(set (cc0)\n-;;\t(compare (match_operand:DI 0 \"general_operand\" \"=&d*a\")\n-;;\t(compare (match_operand:DI 0 \"general_operand\" \"+&d*a\")\n-;;\t(compare (match_operand:DI 0 \"general_operand\" \"+d*a\")\n-\t(compare (match_operand:DI 0 \"general_operand\" \"d*a\")\n-\t\t (match_operand:DI 1 \"general_operand\" \"d\")))\n-   (clobber (match_scratch:DI 2 \"=0\"))]\n+\t(compare (match_operand:DI 1 \"nonimmediate_operand\" \"0,d\")\n+\t\t (match_operand:DI 2 \"general_operand\" \"d,0\")))\n+   (clobber (match_operand:DI 0 \"register_operand\" \"=d,d\"))]\n   \"\"\n   \"*\n {\n-  operands[2] = gen_rtx (REG, SImode, REGNO (operands[0]) + 1);\n-  operands[3] = gen_rtx (REG, SImode, REGNO (operands[1]) + 1);\n-  if (DATA_REG_P (operands[0]))\n-    return \\\"sub%.l %3,%2\\;subx%.l %1,%0\\\";\n+  if (rtx_equal_p (operands[0], operands[1]))\n+    return \\\"sub%.l %R2,%R0\\;subx%.l %2,%0\\\";\n   else\n-    return \\\"exg %/d0,%2\\;sub%.l %3,%/d0\\;exg %/d0,%0\\;subx%.l %1,%/d0\\;exg %/d0,%2\\\";\n+    {\n+      return \\\"sub%.l %R1,%R0\\;subx%.l %1,%0\\\";\n+      cc_status.flags |= CC_REVERSED;\n+    }\n }\")\n \n ;; This is the second \"hook\" for PIC code (in addition to movsi). See"}]}