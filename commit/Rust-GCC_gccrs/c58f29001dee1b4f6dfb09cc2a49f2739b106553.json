{"sha": "c58f29001dee1b4f6dfb09cc2a49f2739b106553", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzU4ZjI5MDAxZGVlMWI0ZjZkZmIwOWNjMmE0OWYyNzM5YjEwNjU1Mw==", "commit": {"author": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2004-08-12T16:20:11Z"}, "committer": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2004-08-12T16:20:11Z"}, "message": "re PR libgcj/11801 (Problems with Process.waitFor() and exitValue())\n\n2004-08-12  David Daney  <ddaney@avtrex.com>\n\n\tPR libgcj/11801\n\t* java/lang/PosixProcess.java: Rewrote.\n\t* java/lang/natPosixProcess.cc: Rewrote.\n\t* java/lang/Runtime.java (execInternal): Declare throws IOException.\n\t* gcj/javaprims.h (ConcreteProcess$ProcessManager): Declare.\n\t* posix-threads.cc (block_sigchld) New function.\n\t(_Jv_ThreadRegister) Use it.\n\t(_Jv_ThreadStart) Use it.\n\t* configure.in (PLATFORM_INNER_NAT_HDRS): New AC_SUBST() used in...\n\t* Makefile.am: ... to specify extra native headers.\n\t* configure: Regenerated.\n\t* include/config.h: Regenerated.\n\t* Makefile.in: Regenerated.\n\t* gcj/Makefile.in: Regenerated.\n\t* include/Makefile.in: Regenerated.\n\t* testsuite/Makefile.in: Regenerated.\n\nFrom-SVN: r85880", "tree": {"sha": "d4c32b005acd50085c465f85fda29e5885955ec5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d4c32b005acd50085c465f85fda29e5885955ec5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c58f29001dee1b4f6dfb09cc2a49f2739b106553", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c58f29001dee1b4f6dfb09cc2a49f2739b106553", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c58f29001dee1b4f6dfb09cc2a49f2739b106553", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c58f29001dee1b4f6dfb09cc2a49f2739b106553/comments", "author": null, "committer": null, "parents": [{"sha": "db151e9d837b9a27d2de105869186e2f9b7ca353", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db151e9d837b9a27d2de105869186e2f9b7ca353", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db151e9d837b9a27d2de105869186e2f9b7ca353"}], "stats": {"total": 1606, "additions": 1098, "deletions": 508}, "files": [{"sha": "83124461472808399f0f001b074e2028b9971266", "filename": "libjava/Makefile.am", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FMakefile.am?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -532,7 +532,8 @@ inner_nat_headers = java/io/ObjectOutputStream$$PutField.h \\\n \tgnu/java/net/PlainSocketImpl$$SocketInputStream.h \\\n \tgnu/java/net/PlainSocketImpl$$SocketOutputStream.h \\\n \tgnu/java/nio/PipeImpl$$SinkChannelImpl.h \\\n-\tgnu/java/nio/PipeImpl$$SourceChannelImpl.h\n+\tgnu/java/nio/PipeImpl$$SourceChannelImpl.h \\\n+\t$(PLATFORM_INNER_NAT_HDRS)\n \n nat_headers = $(ordinary_nat_headers) $(inner_nat_headers)\n nat_headers_install = $(ordinary_nat_headers)\n@@ -642,6 +643,11 @@ gnu/java/nio/PipeImpl$$SourceChannelImpl.h: gnu/java/nio/PipeImpl.class\n \t$(GCJH) -classpath '' -bootclasspath $(top_builddir) \\\n \t'gnu/java/nio/PipeImpl$$SourceChannelImpl'\n \n+## Only used by PosixProcess.java\n+java/lang/ConcreteProcess$$ProcessManager.h: java/lang/ConcreteProcess.class\n+\t$(GCJH) -classpath '' -bootclasspath $(top_builddir) \\\n+\t'java/lang/ConcreteProcess$$ProcessManager'\n+\n ## Headers we maintain by hand and which we want to install.\n extra_headers = java/lang/Object.h java/lang/Class.h\n "}, {"sha": "6dcc6d74289f8b653bdebb7e5a5f6902d2400bd8", "filename": "libjava/Makefile.in", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FMakefile.in?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -125,6 +125,7 @@ PANGOFT2_LIBS = @PANGOFT2_LIBS@\n PERL = @PERL@\n PKG_CONFIG = @PKG_CONFIG@\n PLATFORMOBJS = @PLATFORMOBJS@\n+PLATFORM_INNER_NAT_HDRS = @PLATFORM_INNER_NAT_HDRS@\n RANLIB = @RANLIB@\n STRIP = @STRIP@\n SYSDEP_SOURCES = @SYSDEP_SOURCES@\n@@ -506,7 +507,8 @@ inner_nat_headers = java/io/ObjectOutputStream$$PutField.h \\\n \tgnu/java/net/PlainSocketImpl$$SocketInputStream.h \\\n \tgnu/java/net/PlainSocketImpl$$SocketOutputStream.h \\\n \tgnu/java/nio/PipeImpl$$SinkChannelImpl.h \\\n-\tgnu/java/nio/PipeImpl$$SourceChannelImpl.h\n+\tgnu/java/nio/PipeImpl$$SourceChannelImpl.h \\\n+\t$(PLATFORM_INNER_NAT_HDRS)\n \n \n nat_headers = $(ordinary_nat_headers) $(inner_nat_headers)\n@@ -5662,6 +5664,10 @@ gnu/java/nio/PipeImpl$$SourceChannelImpl.h: gnu/java/nio/PipeImpl.class\n \t$(GCJH) -classpath '' -bootclasspath $(top_builddir) \\\n \t'gnu/java/nio/PipeImpl$$SourceChannelImpl'\n \n+java/lang/ConcreteProcess$$ProcessManager.h: java/lang/ConcreteProcess.class\n+\t$(GCJH) -classpath '' -bootclasspath $(top_builddir) \\\n+\t'java/lang/ConcreteProcess$$ProcessManager'\n+\n $(extra_headers) $(srcdir)/java/lang/Object.h $(srcdir)/java/lang/Class.h:\n \t@:\n "}, {"sha": "9aab57a2d9a3e0d68e10711b4a53389a0f5446ce", "filename": "libjava/configure", "status": "modified", "additions": 200, "deletions": 114, "changes": 314, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -310,7 +310,7 @@ ac_includes_default=\"\\\n # include <unistd.h>\n #endif\"\n \n-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS libgcj_basedir build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os target_noncanonical LN_S mkinstalldirs CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LDFLAGS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO SET_MAKE AS ac_ct_AS AR ac_ct_AR RANLIB ac_ct_RANLIB MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT LIBGCJ_CFLAGS LIBGCJ_CXXFLAGS LIBGCJ_JAVAFLAGS INCLTDL LIBLTDL DIRLTDL STRIP ac_ct_STRIP LIBTOOL CXXCPP CPPFLAGS subdirs COMPPATH TESTSUBDIR_TRUE TESTSUBDIR_FALSE ONESTEP_TRUE ONESTEP_FALSE LIBGCJDEBUG INTERPRETER LIBFFI LIBFFIINCS EXTRA_CC_FILES PLATFORMOBJS CPP EGREP SYSTEMSPEC LIBGCJTESTSPEC ZLIBSPEC ZLIBTESTSPEC X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS TOOLKIT XLIB_AWT_TRUE XLIB_AWT_FALSE GTK_AWT_TRUE GTK_AWT_FALSE GTK_CAIRO_TRUE GTK_CAIRO_FALSE PKG_CONFIG CAIRO_CFLAGS CAIRO_LIBS PANGOFT2_CFLAGS PANGOFT2_LIBS GCLIBS GCINCS GCDEPS GCOBJS GCSPEC JC1GCSPEC GCTESTSPEC THREADLIBS THREADINCS THREADDEPS THREADOBJS THREADSPEC THREADLDFLAGS THREADCXXFLAGS HASH_SYNC_SPEC USING_GCC_TRUE USING_GCC_FALSE tool_include_dir gcc_version LIBICONV GTK_CFLAGS GTK_LIBS GLIB_CFLAGS GLIB_LIBS LIBART_CFLAGS LIBART_LIBS GCJH ZIP GCJ ac_ct_GCJ GCJFLAGS ZLIBS SYS_ZLIBS ZINCS DIVIDESPEC CHECKREFSPEC EXCEPTIONSPEC IEEESPEC NATIVE_TRUE NATIVE_FALSE NEEDS_DATA_START_TRUE NEEDS_DATA_START_FALSE GCC_UNWIND_INCLUDE toolexecdir toolexecmainlibdir toolexeclibdir GCJVERSION ALLOCA PERL BACKTRACESPEC SYSDEP_SOURCES here LIBOBJS LTLIBOBJS'\n+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS libgcj_basedir build build_cpu build_vendor build_os host host_cpu host_vendor host_os target target_cpu target_vendor target_os target_noncanonical LN_S mkinstalldirs CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LDFLAGS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO SET_MAKE AS ac_ct_AS AR ac_ct_AR RANLIB ac_ct_RANLIB MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT LIBGCJ_CFLAGS LIBGCJ_CXXFLAGS LIBGCJ_JAVAFLAGS INCLTDL LIBLTDL DIRLTDL STRIP ac_ct_STRIP LIBTOOL CXXCPP CPPFLAGS subdirs COMPPATH TESTSUBDIR_TRUE TESTSUBDIR_FALSE ONESTEP_TRUE ONESTEP_FALSE LIBGCJDEBUG INTERPRETER LIBFFI LIBFFIINCS EXTRA_CC_FILES PLATFORMOBJS PLATFORM_INNER_NAT_HDRS CPP EGREP SYSTEMSPEC LIBGCJTESTSPEC ZLIBSPEC ZLIBTESTSPEC X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS TOOLKIT XLIB_AWT_TRUE XLIB_AWT_FALSE GTK_AWT_TRUE GTK_AWT_FALSE GTK_CAIRO_TRUE GTK_CAIRO_FALSE PKG_CONFIG CAIRO_CFLAGS CAIRO_LIBS PANGOFT2_CFLAGS PANGOFT2_LIBS GCLIBS GCINCS GCDEPS GCOBJS GCSPEC JC1GCSPEC GCTESTSPEC THREADLIBS THREADINCS THREADDEPS THREADOBJS THREADSPEC THREADLDFLAGS THREADCXXFLAGS HASH_SYNC_SPEC USING_GCC_TRUE USING_GCC_FALSE tool_include_dir gcc_version LIBICONV GTK_CFLAGS GTK_LIBS GLIB_CFLAGS GLIB_LIBS LIBART_CFLAGS LIBART_LIBS GCJH ZIP GCJ ac_ct_GCJ GCJFLAGS ZLIBS SYS_ZLIBS ZINCS DIVIDESPEC CHECKREFSPEC EXCEPTIONSPEC IEEESPEC NATIVE_TRUE NATIVE_FALSE NEEDS_DATA_START_TRUE NEEDS_DATA_START_FALSE GCC_UNWIND_INCLUDE toolexecdir toolexecmainlibdir toolexeclibdir GCJVERSION ALLOCA PERL BACKTRACESPEC SYSDEP_SOURCES here LIBOBJS LTLIBOBJS'\n ac_subst_files=''\n \n # Initialize some variables set by options.\n@@ -994,7 +994,7 @@ esac\n     else\n       echo \"$as_me: WARNING: no configuration information is in $ac_dir\" >&2\n     fi\n-    cd \"$ac_popdir\"\n+    cd $ac_popdir\n   done\n fi\n \n@@ -2215,7 +2215,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2273,7 +2274,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2389,7 +2391,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2443,7 +2446,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2488,7 +2492,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2532,7 +2537,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2716,7 +2722,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_cxx_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_cxx_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2774,7 +2781,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_cxx_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_cxx_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2845,7 +2853,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_cxx_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_cxx_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2889,7 +2898,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_cxx_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_cxx_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4324,7 +4334,7 @@ test x\"$pic_mode\" = xno && libtool_flags=\"$libtool_flags --prefer-non-pic\"\n case $host in\n *-*-irix6*)\n   # Find out which ABI we are using.\n-  echo '#line 4327 \"configure\"' > conftest.$ac_ext\n+  echo '#line 4337 \"configure\"' > conftest.$ac_ext\n   if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   (eval $ac_compile) 2>&5\n   ac_status=$?\n@@ -4471,7 +4481,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5053,7 +5064,7 @@ if test \"${enable_sjlj_exceptions+set}\" = set; then\n   :\n else\n   cat > conftest.$ac_ext << EOF\n-#line 5056 \"configure\"\n+#line 5067 \"configure\"\n struct S { ~S(); };\n void bar();\n void foo()\n@@ -5187,6 +5198,7 @@ EXTRA_CC_FILES=\n \n \n PLATFORMOBJS=\n+PLATFORM_INNER_NAT_HDRS=\n case \"$TARGET_ECOS\" in\n    no) case \"$host\" in\n       *mingw*)\n@@ -5228,6 +5240,7 @@ fi\n \t    PLATFORMNET=Posix\n             PLATFORMOBJS=posix.lo\n \t    PLATFORMH=posix.h\n+\t    PLATFORM_INNER_NAT_HDRS='java/lang/ConcreteProcess$$ProcessManager.h'\n       ;;\n       esac\n       ;;\n@@ -5244,6 +5257,7 @@ _ACEOF\n       ;;\n esac\n \n+\n           ac_config_links=\"$ac_config_links include/platform.h:include/$PLATFORMH\"\n \n \n@@ -5683,12 +5697,9 @@ ZLIBSPEC=\n ZLIBTESTSPEC=\n \n \n-\n-if test \"x$ac_path_x_has_been_run\" != xyes; then\n-  echo \"$as_me:$LINENO: checking for X\" >&5\n+echo \"$as_me:$LINENO: checking for X\" >&5\n echo $ECHO_N \"checking for X... $ECHO_C\" >&6\n \n-ac_path_x_has_been_run=yes\n \n # Check whether --with-x or --without-x was given.\n if test \"${with_x+set}\" = set; then\n@@ -5781,7 +5792,7 @@ ac_x_header_dirs='\n /usr/openwin/share/include'\n \n if test \"$ac_x_includes\" = no; then\n-  # Guess where to find include files, by looking for a specified header file.\n+  # Guess where to find include files, by looking for Intrinsic.h.\n   # First, try using that file with no special directory specified.\n   cat >conftest.$ac_ext <<_ACEOF\n /* confdefs.h.  */\n@@ -5860,7 +5871,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5920,15 +5932,10 @@ else\n   # Update the cache value to reflect the command line values.\n   ac_cv_have_x=\"have_x=yes \\\n \t\tac_x_includes=$x_includes ac_x_libraries=$x_libraries\"\n-  # It might be that x_includes is empty (headers are found in the\n-  # standard search path. Then output the corresponding message\n-  ac_out_x_includes=$x_includes\n-  test \"x$x_includes\" = x && ac_out_x_includes=\"in standard search path\"\n-  echo \"$as_me:$LINENO: result: libraries $x_libraries, headers $ac_out_x_includes\" >&5\n-echo \"${ECHO_T}libraries $x_libraries, headers $ac_out_x_includes\" >&6\n+  echo \"$as_me:$LINENO: result: libraries $x_libraries, headers $x_includes\" >&5\n+echo \"${ECHO_T}libraries $x_libraries, headers $x_includes\" >&6\n fi\n \n-fi\n if test \"$no_x\" = yes; then\n   # Not all programs may use this symbol, but it does not hurt to define it.\n \n@@ -5981,7 +5988,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6037,7 +6045,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6118,7 +6127,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6178,7 +6188,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6251,7 +6262,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6364,7 +6376,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6433,7 +6446,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6506,7 +6520,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6615,7 +6630,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6684,7 +6700,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6786,7 +6803,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6855,7 +6873,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6957,7 +6976,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7026,7 +7046,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7110,7 +7131,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7803,7 +7825,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7913,7 +7936,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8027,7 +8051,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8134,7 +8159,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8241,7 +8267,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8349,7 +8376,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8459,7 +8487,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8524,7 +8553,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8694,7 +8724,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8763,7 +8794,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8948,7 +8980,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9056,7 +9089,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9195,7 +9229,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9250,7 +9285,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9325,7 +9361,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9399,7 +9436,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9549,7 +9587,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9612,7 +9651,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9677,7 +9717,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9723,7 +9764,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9802,7 +9844,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9911,7 +9954,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10009,7 +10053,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_cxx_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_cxx_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10052,7 +10097,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_cxx_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_cxx_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10129,7 +10175,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10255,7 +10302,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10393,7 +10441,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10525,7 +10574,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10660,7 +10710,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10769,7 +10820,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10843,7 +10895,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10921,7 +10974,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -10991,7 +11045,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11039,7 +11094,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11144,7 +11200,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11256,7 +11313,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11365,7 +11423,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11446,7 +11505,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11578,7 +11638,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11647,7 +11708,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11753,7 +11815,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11858,7 +11921,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -11922,7 +11986,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -12005,7 +12070,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -12384,7 +12450,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -12662,7 +12729,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -12838,7 +12906,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -12989,7 +13058,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13138,7 +13208,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13303,7 +13374,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13367,7 +13439,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13434,7 +13507,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13488,7 +13562,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13542,7 +13617,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13596,7 +13672,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13652,7 +13729,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13706,7 +13784,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13757,7 +13836,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13808,7 +13888,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13876,7 +13957,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -13962,7 +14044,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -14108,7 +14191,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -14252,7 +14336,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -14441,7 +14526,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -15516,6 +15602,7 @@ s,@LIBFFI@,$LIBFFI,;t t\n s,@LIBFFIINCS@,$LIBFFIINCS,;t t\n s,@EXTRA_CC_FILES@,$EXTRA_CC_FILES,;t t\n s,@PLATFORMOBJS@,$PLATFORMOBJS,;t t\n+s,@PLATFORM_INNER_NAT_HDRS@,$PLATFORM_INNER_NAT_HDRS,;t t\n s,@CPP@,$CPP,;t t\n s,@EGREP@,$EGREP,;t t\n s,@SYSTEMSPEC@,$SYSTEMSPEC,;t t\n@@ -15758,6 +15845,11 @@ esac\n   *) ac_INSTALL=$ac_top_builddir$INSTALL ;;\n   esac\n \n+  if test x\"$ac_file\" != x-; then\n+    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n+echo \"$as_me: creating $ac_file\" >&6;}\n+    rm -f \"$ac_file\"\n+  fi\n   # Let's still pretend it is `configure' which instantiates (i.e., don't\n   # use $as_me), people would be surprised to read:\n   #    /* config.h.  Generated by config.status.  */\n@@ -15796,12 +15888,6 @@ echo \"$as_me: error: cannot find input file: $f\" >&2;}\n \t fi;;\n       esac\n     done` || { (exit 1); exit 1; }\n-\n-  if test x\"$ac_file\" != x-; then\n-    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n-echo \"$as_me: creating $ac_file\" >&6;}\n-    rm -f \"$ac_file\"\n-  fi\n _ACEOF\n cat >>$CONFIG_STATUS <<_ACEOF\n   sed \"$ac_vpsub\n@@ -16548,7 +16634,7 @@ echo \"$as_me: error: $ac_sub_configure failed for $ac_dir\" >&2;}\n    { (exit 1); exit 1; }; }\n     fi\n \n-    cd \"$ac_popdir\"\n+    cd $ac_popdir\n   done\n fi\n "}, {"sha": "427e21e3d6e63d7267609c73ded749c402bb5649", "filename": "libjava/configure.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure.in?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -386,6 +386,7 @@ EXTRA_CC_FILES=\n AC_SUBST(EXTRA_CC_FILES)\n \n PLATFORMOBJS=\n+PLATFORM_INNER_NAT_HDRS=\n case \"$TARGET_ECOS\" in\n    no) case \"$host\" in\n       *mingw*)\n@@ -400,6 +401,7 @@ case \"$TARGET_ECOS\" in\n \t    PLATFORMNET=Posix\n             PLATFORMOBJS=posix.lo\n \t    PLATFORMH=posix.h\n+\t    PLATFORM_INNER_NAT_HDRS='java/lang/ConcreteProcess$$ProcessManager.h'\n       ;;\n       esac\n       ;;\n@@ -412,6 +414,7 @@ case \"$TARGET_ECOS\" in\n       ;;\n esac\n AC_SUBST(PLATFORMOBJS)\n+AC_SUBST(PLATFORM_INNER_NAT_HDRS)\n AC_CONFIG_LINKS(include/platform.h:include/$PLATFORMH)\n \n AC_EGREP_HEADER(uint32_t, stdint.h, AC_DEFINE(HAVE_INT32_DEFINED, 1,"}, {"sha": "ffabae091a64b933300305ff28ebb96500625660", "filename": "libjava/gcj/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fgcj%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fgcj%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgcj%2FMakefile.in?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -128,6 +128,7 @@ PANGOFT2_LIBS = @PANGOFT2_LIBS@\n PERL = @PERL@\n PKG_CONFIG = @PKG_CONFIG@\n PLATFORMOBJS = @PLATFORMOBJS@\n+PLATFORM_INNER_NAT_HDRS = @PLATFORM_INNER_NAT_HDRS@\n RANLIB = @RANLIB@\n STRIP = @STRIP@\n SYSDEP_SOURCES = @SYSDEP_SOURCES@"}, {"sha": "8b2b090b95c33d81e339fbd4b8603f89da0e600c", "filename": "libjava/gcj/javaprims.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fgcj%2Fjavaprims.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fgcj%2Fjavaprims.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgcj%2Fjavaprims.h?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -1,6 +1,7 @@\n // javaprims.h - Main external header file for libgcj.  -*- c++ -*-\n \n-/* Copyright (C) 1998, 1999, 2000, 2001, 2002, 2003  Free Software Foundation\n+/* Copyright (C) 1998, 1999, 2000, 2001, 2002, 2003, 2004\n+   Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -150,6 +151,7 @@ extern \"Java\"\n       class Comparable;\n       class Compiler;\n       class ConcreteProcess;\n+      class ConcreteProcess$ProcessManager;\n       class Double;\n       class Error;\n       class Exception;"}, {"sha": "b20d6d8b40ec8532f7e7acccc3aa46ce58cfa35e", "filename": "libjava/include/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Finclude%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Finclude%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2FMakefile.in?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -128,6 +128,7 @@ PANGOFT2_LIBS = @PANGOFT2_LIBS@\n PERL = @PERL@\n PKG_CONFIG = @PKG_CONFIG@\n PLATFORMOBJS = @PLATFORMOBJS@\n+PLATFORM_INNER_NAT_HDRS = @PLATFORM_INNER_NAT_HDRS@\n RANLIB = @RANLIB@\n STRIP = @STRIP@\n SYSDEP_SOURCES = @SYSDEP_SOURCES@"}, {"sha": "62007e5152846727d9cfaafa03950f7668ded929", "filename": "libjava/include/config.h.in", "status": "modified", "additions": 275, "deletions": 293, "changes": 568, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Finclude%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Finclude%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2Fconfig.h.in?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -1,466 +1,448 @@\n-/* include/config.h.in.  Generated automatically from configure.in by autoheader.  */\n+/* include/config.h.in.  Generated from configure.in by autoheader.  */\n \n-/* Define if using alloca.c.  */\n+/* Define to one of `_getb67', `GETB67', `getb67' for Cray-2 and Cray-YMP\n+   systems. This function is required for `alloca.c' support on those systems.\n+   */\n+#undef CRAY_STACKSEG_END\n+\n+/* Define to 1 if using `alloca.c'. */\n #undef C_ALLOCA\n \n-/* Define to one of _getb67, GETB67, getb67 for Cray-2 and Cray-YMP systems.\n-   This function is required for alloca.c support on those systems.  */\n-#undef CRAY_STACKSEG_END\n+/* Define this if you want runtime debugging enabled. */\n+#undef DEBUG\n+\n+/* Define if system properties shouldn't be read from\n+   getenv(\"GCJ_PROPERTIES\"). */\n+#undef DISABLE_GETENV_PROPERTIES\n+\n+/* Define if java.net native functions should be stubbed out. */\n+#undef DISABLE_JAVA_NET\n \n-/* Define if you have alloca, as a function or macro.  */\n+/* Define if we should ignore arguments to main(). */\n+#undef DISABLE_MAIN_ARGS\n+\n+/* Define if you're running eCos. */\n+#undef ECOS\n+\n+/* Define if you are using JVMPI. */\n+#undef ENABLE_JVMPI\n+\n+/* Short GCJ version ID */\n+#undef GCJVERSION\n+\n+/* Define if gethostbyaddr_r returns 'int'. */\n+#undef GETHOSTBYADDR_R_RETURNS_INT\n+\n+/* Define if gethostbyname_r returns 'int'. */\n+#undef GETHOSTBYNAME_R_RETURNS_INT\n+\n+/* Define to 1 if you have the `access' function. */\n+#undef HAVE_ACCESS\n+\n+/* Define to 1 if you have `alloca', as a function or macro. */\n #undef HAVE_ALLOCA\n \n-/* Define if you have <alloca.h> and it should be used (not on Ultrix).  */\n+/* Define to 1 if you have <alloca.h> and it should be used (not on Ultrix).\n+   */\n #undef HAVE_ALLOCA_H\n \n-/* Define if you have a working `mmap' system call.  */\n-#undef HAVE_MMAP\n+/* Define to 1 if you have the <arpa/inet.h> header file. */\n+#undef HAVE_ARPA_INET_H\n \n-/* Define if you have <sys/wait.h> that is POSIX.1 compatible.  */\n-#undef HAVE_SYS_WAIT_H\n+/* Define if your platform has a working backtrace() function. */\n+#undef HAVE_BACKTRACE\n \n-/* Define if your struct tm has tm_zone.  */\n-#undef HAVE_TM_ZONE\n+/* Define if Boehm GC in use. */\n+#undef HAVE_BOEHM_GC\n \n-/* Define if you don't have tm_zone but do have the external array\n-   tzname.  */\n-#undef HAVE_TZNAME\n+/* Define if you have u_int32_t */\n+#undef HAVE_BSD_INT32_DEFINED\n \n-/* If using the C implementation of alloca, define if you know the\n-   direction of stack growth for your system; otherwise it will be\n-   automatically deduced at run-time.\n- STACK_DIRECTION > 0 => grows toward higher addresses\n- STACK_DIRECTION < 0 => grows toward lower addresses\n- STACK_DIRECTION = 0 => direction of growth unknown\n- */\n-#undef STACK_DIRECTION\n+/* Define to 1 if you have the <bstring.h> header file. */\n+#undef HAVE_BSTRING_H\n \n-/* Define if you have the ANSI C header files.  */\n-#undef STDC_HEADERS\n+/* Define to 1 if you have the `chmod' function. */\n+#undef HAVE_CHMOD\n \n-/* Define if your <sys/time.h> declares struct tm.  */\n-#undef TM_IN_SYS_TIME\n+/* Define to 1 if you have the <dirent.h> header file. */\n+#undef HAVE_DIRENT_H\n \n-/* Define if the X Window System is missing or not being used.  */\n-#undef X_DISPLAY_MISSING\n+/* Define if you have dladdr() */\n+#undef HAVE_DLADDR\n \n-/* Define to `int' if `ssize_t' is not defined.  */\n-#undef ssize_t\n+/* Define to 1 if you have the <dlfcn.h> header file. */\n+#undef HAVE_DLFCN_H\n \n-/* Define if you have the access function.  */\n-#undef HAVE_ACCESS\n+/* Define if dlopen is available */\n+#undef HAVE_DLOPEN\n \n-/* Define if you have the chmod function.  */\n-#undef HAVE_CHMOD\n+/* Define to 1 if you have the <execinfo.h> header file. */\n+#undef HAVE_EXECINFO_H\n \n-/* Define if you have the execvp function.  */\n+/* Define to 1 if you have the `execvp' function. */\n #undef HAVE_EXECVP\n \n-/* Define if you have the fork function.  */\n+/* Define to 1 if you have the <fcntl.h> header file. */\n+#undef HAVE_FCNTL_H\n+\n+/* Define to 1 if you have the `fork' function. */\n #undef HAVE_FORK\n \n-/* Define if you have the fstat function.  */\n+/* Define to 1 if you have the `fstat' function. */\n #undef HAVE_FSTAT\n \n-/* Define if you have the fsync function.  */\n+/* Define to 1 if you have the `fsync' function. */\n #undef HAVE_FSYNC\n \n-/* Define if you have the ftime function.  */\n+/* Define to 1 if you have the `ftime' function. */\n #undef HAVE_FTIME\n \n-/* Define if you have the ftruncate function.  */\n+/* Define to 1 if you have the `ftruncate' function. */\n #undef HAVE_FTRUNCATE\n \n-/* Define if you have the getcwd function.  */\n+/* Define to 1 if you have the `getcwd' function. */\n #undef HAVE_GETCWD\n \n-/* Define if you have the gethostbyaddr_r function.  */\n+/* Define if you have the 'gethostbyaddr_r' function. */\n #undef HAVE_GETHOSTBYADDR_R\n \n-/* Define if you have the gethostbyname_r function.  */\n+/* Define if you have the 'gethostbyname_r' function. */\n #undef HAVE_GETHOSTBYNAME_R\n \n-/* Define if you have the gethostname function.  */\n+/* Define if you have the 'gethostname' function. */\n #undef HAVE_GETHOSTNAME\n \n-/* Define if you have the getpagesize function.  */\n+/* Define if gethostname is declared in <unistd.h>. */\n+#undef HAVE_GETHOSTNAME_DECL\n+\n+/* Define to 1 if you have the `getpagesize' function. */\n #undef HAVE_GETPAGESIZE\n \n-/* Define if you have the getpwuid_r function.  */\n+/* Define to 1 if you have the `getpwuid_r' function. */\n #undef HAVE_GETPWUID_R\n \n-/* Define if you have the gettimeofday function.  */\n+/* Define to 1 if you have the `gettimeofday' function. */\n #undef HAVE_GETTIMEOFDAY\n \n-/* Define if you have the gmtime_r function.  */\n+/* Define to 1 if you have the `gmtime_r' function. */\n #undef HAVE_GMTIME_R\n \n-/* Define if you have the inet_addr function.  */\n+/* Define if you have the iconv() function. */\n+#undef HAVE_ICONV\n+\n+/* Define if inet6 structures are defined in netinet/in.h. */\n+#undef HAVE_INET6\n+\n+/* Define to 1 if you have the `inet_addr' function. */\n #undef HAVE_INET_ADDR\n \n-/* Define if you have the inet_aton function.  */\n+/* Define to 1 if you have the `inet_aton' function. */\n #undef HAVE_INET_ATON\n \n-/* Define if you have the inet_ntoa function.  */\n+/* Define to 1 if you have the `inet_ntoa' function. */\n #undef HAVE_INET_NTOA\n \n-/* Define if you have the inet_pton function.  */\n+/* Define to 1 if you have the `inet_pton' function. */\n #undef HAVE_INET_PTON\n \n-/* Define if you have the ioctl function.  */\n+/* Define if you have int32_t and uint32_t. */\n+#undef HAVE_INT32_DEFINED\n+\n+/* Define if <inttypes.h> is available */\n+#undef HAVE_INTTYPES_H\n+\n+/* Define to 1 if 'in_addr_t' is defined in sys/types.h or netinet/in.h. */\n+#undef HAVE_IN_ADDR_T\n+\n+/* Define to 1 if you have the `ioctl' function. */\n #undef HAVE_IOCTL\n \n-/* Define if you have the localtime_r function.  */\n+/* Define to 1 if you have the <langinfo.h> header file. */\n+#undef HAVE_LANGINFO_H\n+\n+/* Define if your <locale.h> file defines LC_MESSAGES. */\n+#undef HAVE_LC_MESSAGES\n+\n+/* Define to 1 if you have the <locale.h> header file. */\n+#undef HAVE_LOCALE_H\n+\n+/* Define is you have 'localtime' in <time.h> */\n+#undef HAVE_LOCALTIME\n+\n+/* Define to 1 if you have the `localtime_r' function. */\n #undef HAVE_LOCALTIME_R\n \n-/* Define if you have the memcpy function.  */\n+/* Define to 1 if you have the `memcpy' function. */\n #undef HAVE_MEMCPY\n \n-/* Define if you have the memmove function.  */\n+/* Define to 1 if you have the `memmove' function. */\n #undef HAVE_MEMMOVE\n \n-/* Define if you have the mkdir function.  */\n+/* Define to 1 if you have the <memory.h> header file. */\n+#undef HAVE_MEMORY_H\n+\n+/* Define to 1 if you have the `mkdir' function. */\n #undef HAVE_MKDIR\n \n-/* Define if you have the nl_langinfo function.  */\n+/* Define is you have 'mktime' in <time.h> */\n+#undef HAVE_MKTIME\n+\n+/* Define to 1 if you have a working `mmap' system call. */\n+#undef HAVE_MMAP\n+\n+/* Define to 1 if you have the <netdb.h> header file. */\n+#undef HAVE_NETDB_H\n+\n+/* Define to 1 if you have the <netinet/in.h> header file. */\n+#undef HAVE_NETINET_IN_H\n+\n+/* Define to 1 if you have the <net/if.h> header file. */\n+#undef HAVE_NET_IF_H\n+\n+/* Define to 1 if you have the `nl_langinfo' function. */\n #undef HAVE_NL_LANGINFO\n \n-/* Define if you have the open function.  */\n+/* Define to 1 if you have the `open' function. */\n #undef HAVE_OPEN\n \n-/* Define if you have the opendir function.  */\n+/* Define to 1 if you have the `opendir' function. */\n #undef HAVE_OPENDIR\n \n-/* Define if you have the pipe function.  */\n+/* Define to 1 if you have the `pipe' function. */\n #undef HAVE_PIPE\n \n-/* Define if you have the pthread_mutexattr_setkind_np function.  */\n+/* Define if you have /proc/self/exe */\n+#undef HAVE_PROC_SELF_EXE\n+\n+/* Define if using POSIX threads that have the mutexattr functions. */\n+#undef HAVE_PTHREAD_MUTEXATTR_INIT\n+\n+/* Define to 1 if you have the `pthread_mutexattr_setkind_np' function. */\n #undef HAVE_PTHREAD_MUTEXATTR_SETKIND_NP\n \n-/* Define if you have the pthread_mutexattr_settype function.  */\n+/* Define to 1 if you have the `pthread_mutexattr_settype' function. */\n #undef HAVE_PTHREAD_MUTEXATTR_SETTYPE\n \n-/* Define if you have the readdir_r function.  */\n+/* Define to 1 if you have the <pwd.h> header file. */\n+#undef HAVE_PWD_H\n+\n+/* Define to 1 if you have the `readdir_r' function. */\n #undef HAVE_READDIR_R\n \n-/* Define if you have the realpath function.  */\n+/* Define to 1 if you have the `realpath' function. */\n #undef HAVE_REALPATH\n \n-/* Define if you have the rename function.  */\n+/* Define to 1 if you have the `rename' function. */\n #undef HAVE_RENAME\n \n-/* Define if you have the rmdir function.  */\n+/* Define to 1 if you have the `rmdir' function. */\n #undef HAVE_RMDIR\n \n-/* Define if you have the sched_yield function.  */\n+/* Define to 1 if you have the `sched_yield' function. */\n #undef HAVE_SCHED_YIELD\n \n-/* Define if you have the select function.  */\n+/* Define to 1 if you have the `select' function. */\n #undef HAVE_SELECT\n \n-/* Define if you have the setlocale function.  */\n+/* Define to 1 if you have the `setlocale' function. */\n #undef HAVE_SETLOCALE\n \n-/* Define if you have the sigaction function.  */\n+/* Define to 1 if you have the `sigaction' function. */\n #undef HAVE_SIGACTION\n \n-/* Define if you have the sleep function.  */\n+/* Define to 1 if you have the `sleep' function. */\n #undef HAVE_SLEEP\n \n-/* Define if you have the stat function.  */\n-#undef HAVE_STAT\n-\n-/* Define if you have the strerror function.  */\n-#undef HAVE_STRERROR\n-\n-/* Define if you have the time function.  */\n-#undef HAVE_TIME\n-\n-/* Define if you have the uname function.  */\n-#undef HAVE_UNAME\n-\n-/* Define if you have the unlink function.  */\n-#undef HAVE_UNLINK\n-\n-/* Define if you have the usleep function.  */\n-#undef HAVE_USLEEP\n-\n-/* Define if you have the utime function.  */\n-#undef HAVE_UTIME\n-\n-/* Define if you have the <arpa/inet.h> header file.  */\n-#undef HAVE_ARPA_INET_H\n-\n-/* Define if you have the <bstring.h> header file.  */\n-#undef HAVE_BSTRING_H\n-\n-/* Define if you have the <dirent.h> header file.  */\n-#undef HAVE_DIRENT_H\n-\n-/* Define if you have the <dlfcn.h> header file.  */\n-#undef HAVE_DLFCN_H\n+/* Define it socklen_t typedef is in sys/socket.h. */\n+#undef HAVE_SOCKLEN_T\n \n-/* Define if you have the <execinfo.h> header file.  */\n-#undef HAVE_EXECINFO_H\n+/* Define to 1 if you have the `stat' function. */\n+#undef HAVE_STAT\n \n-/* Define if you have the <fcntl.h> header file.  */\n-#undef HAVE_FCNTL_H\n+/* Define to 1 if you have the <stdint.h> header file. */\n+#undef HAVE_STDINT_H\n \n-/* Define if you have the <inttypes.h> header file.  */\n-#undef HAVE_INTTYPES_H\n+/* Define to 1 if you have the <stdlib.h> header file. */\n+#undef HAVE_STDLIB_H\n \n-/* Define if you have the <langinfo.h> header file.  */\n-#undef HAVE_LANGINFO_H\n+/* Define to 1 if you have the `strerror' function. */\n+#undef HAVE_STRERROR\n \n-/* Define if you have the <locale.h> header file.  */\n-#undef HAVE_LOCALE_H\n+/* Define to 1 if you have the <strings.h> header file. */\n+#undef HAVE_STRINGS_H\n \n-/* Define if you have the <net/if.h> header file.  */\n-#undef HAVE_NET_IF_H\n+/* Define to 1 if you have the <string.h> header file. */\n+#undef HAVE_STRING_H\n \n-/* Define if you have the <netdb.h> header file.  */\n-#undef HAVE_NETDB_H\n+/* Define if struct hostent_data is defined in netdb.h */\n+#undef HAVE_STRUCT_HOSTENT_DATA\n \n-/* Define if you have the <netinet/in.h> header file.  */\n-#undef HAVE_NETINET_IN_H\n+/* Define if struct ipv6_mreq is defined in netinet/in.h. */\n+#undef HAVE_STRUCT_IPV6_MREQ\n \n-/* Define if you have the <pwd.h> header file.  */\n-#undef HAVE_PWD_H\n+/* Define if struct ip_mreq is defined in netinet/in.h. */\n+#undef HAVE_STRUCT_IP_MREQ\n \n-/* Define if you have the <stdint.h> header file.  */\n-#undef HAVE_STDINT_H\n+/* Define to 1 if `tm_zone' is member of `struct tm'. */\n+#undef HAVE_STRUCT_TM_TM_ZONE\n \n-/* Define if you have the <sys/config.h> header file.  */\n+/* Define to 1 if you have the <sys/config.h> header file. */\n #undef HAVE_SYS_CONFIG_H\n \n-/* Define if you have the <sys/filio.h> header file.  */\n+/* Define to 1 if you have the <sys/filio.h> header file. */\n #undef HAVE_SYS_FILIO_H\n \n-/* Define if you have the <sys/ioctl.h> header file.  */\n+/* Define to 1 if you have the <sys/ioctl.h> header file. */\n #undef HAVE_SYS_IOCTL_H\n \n-/* Define if you have the <sys/select.h> header file.  */\n+/* Define to 1 if you have the <sys/select.h> header file. */\n #undef HAVE_SYS_SELECT_H\n \n-/* Define if you have the <sys/socket.h> header file.  */\n+/* Define to 1 if you have the <sys/socket.h> header file. */\n #undef HAVE_SYS_SOCKET_H\n \n-/* Define if you have the <sys/stat.h> header file.  */\n+/* Define to 1 if you have the <sys/stat.h> header file. */\n #undef HAVE_SYS_STAT_H\n \n-/* Define if you have the <sys/time.h> header file.  */\n+/* Define to 1 if you have the <sys/time.h> header file. */\n #undef HAVE_SYS_TIME_H\n \n-/* Define if you have the <sys/types.h> header file.  */\n+/* Define to 1 if you have the <sys/types.h> header file. */\n #undef HAVE_SYS_TYPES_H\n \n-/* Define if you have the <unistd.h> header file.  */\n-#undef HAVE_UNISTD_H\n-\n-/* Name of package */\n-#undef PACKAGE\n-\n-/* Version number of package */\n-#undef VERSION\n-\n-/* Define if libltdl is in use. */\n-#undef USE_LTDL\n-\n-/* Define if system properties shouldn't be read from getenv(GCJ_PROPERTIES). */\n-#undef DISABLE_GETENV_PROPERTIES\n-\n-/* Define if we should ignore arguments to main(). */\n-#undef DISABLE_MAIN_ARGS\n-\n-/* Define if MinGW libgcj uses the Windows UNICODE OS API. */\n-#undef MINGW_LIBGCJ_UNICODE\n-\n-/* Define if if the synchronization code should try to avoid pthread_self calls by caching thread IDs in a hashtable. */\n-#undef SLOW_PTHREAD_SELF\n-\n-/* Define this if you want runtime debugging enabled. */\n-#undef DEBUG\n-\n-/* Define if you want a bytecode interpreter. */\n-#undef INTERPRETER\n-\n-/* Define if the compiler is configured for setjmp/longjmp exceptions. */\n-#undef SJLJ_EXCEPTIONS\n-\n-/* Define if java.net native functions should be stubbed out. */\n-#undef DISABLE_JAVA_NET\n-\n-/* Define if we're to use libffi. */\n-#undef USE_LIBFFI\n+/* Define to 1 if you have <sys/wait.h> that is POSIX.1 compatible. */\n+#undef HAVE_SYS_WAIT_H\n \n-/* Define if you are using JVMPI. */\n-#undef ENABLE_JVMPI\n+/* Define to 1 if you have the `time' function. */\n+#undef HAVE_TIME\n \n-/* Indicate that linker is not able to 8-byte align static data */\n-#undef JV_LINKER_CANNOT_8BYTE_ALIGN_STATICS\n+/* Define if global 'timezone' exists. */\n+#undef HAVE_TIMEZONE\n \n-/* Define if you're running eCos. */\n-#undef ECOS\n+/* Define to 1 if your `struct tm' has `tm_zone'. Deprecated, use\n+   `HAVE_STRUCT_TM_TM_ZONE' instead. */\n+#undef HAVE_TM_ZONE\n \n-/* Define if you have int32_t and uint32_t. */\n-#undef HAVE_INT32_DEFINED\n+/* Define to 1 if you don't have `tm_zone' but do have the external array\n+   `tzname'. */\n+#undef HAVE_TZNAME\n \n-/* Define if you have int32_t and uint32_t. */\n-#undef HAVE_INT32_DEFINED\n+/* Define to 1 if you have the `uname' function. */\n+#undef HAVE_UNAME\n \n-/* Define if you have u_int32_t */\n-#undef HAVE_BSD_INT32_DEFINED\n+/* Define if your platform has the global _timezone variable. */\n+#undef HAVE_UNDERSCORE_TIMEZONE\n \n-/* Define if you have u_int32_t */\n-#undef HAVE_BSD_INT32_DEFINED\n+/* Define to 1 if you have the <unistd.h> header file. */\n+#undef HAVE_UNISTD_H\n \n-/* Define is you have 'mktime' in <time.h> */\n-#undef HAVE_MKTIME\n+/* Define to 1 if you have the `unlink' function. */\n+#undef HAVE_UNLINK\n \n-/* Define is you have 'localtime' in <time.h> */\n-#undef HAVE_LOCALTIME\n+/* Define to 1 if you have the `usleep' function. */\n+#undef HAVE_USLEEP\n \n-/* Define if Boehm GC in use. */\n-#undef HAVE_BOEHM_GC\n+/* Define if usleep is declared in <unistd.h>. */\n+#undef HAVE_USLEEP_DECL\n \n-/* Define if using POSIX threads on Linux. */\n-#undef LINUX_THREADS\n+/* Define to 1 if you have the `utime' function. */\n+#undef HAVE_UTIME\n \n-/* Define if using POSIX threads that have the mutexattr functions. */\n-#undef HAVE_PTHREAD_MUTEXATTR_INIT\n+/* Define to 1 if you have the file `AC_File'. */\n+#undef HAVE__PROC_SELF_EXE\n \n-/* Required define if using POSIX threads */\n-#undef _REENTRANT\n+/* Define as const if the declaration of iconv() needs const. */\n+#undef ICONV_CONST\n \n-/* Required define if using POSIX threads */\n-#undef _POSIX_PTHREAD_SEMANTICS\n+/* Define if you want a bytecode interpreter. */\n+#undef INTERPRETER\n \n /* Define if hash synchronization is in use */\n #undef JV_HASH_SYNCHRONIZATION\n \n-/* Define if you have memmove. */\n-#undef HAVE_MEMMOVE\n-\n-/* Define if you have memcpy. */\n-#undef HAVE_MEMCPY\n-\n-/* Define if you have strerror. */\n-#undef HAVE_STRERROR\n-\n-/* Define if you have time. */\n-#undef HAVE_TIME\n-\n-/* Define if you have the 'gmtime_r' function */\n-#undef HAVE_GMTIME_R\n+/* Define if <inttypes.h> is available */\n+#undef JV_HAVE_INTTYPES_H\n \n-/* Define if you have the 'localtime_r' function. */\n-#undef HAVE_LOCALTIME_R\n+/* Indicate that linker is not able to 8-byte align static data */\n+#undef JV_LINKER_CANNOT_8BYTE_ALIGN_STATICS\n \n-/* Define if usleep is declared in <unistd.h>. */\n-#undef HAVE_USLEEP_DECL\n+/* Define if using POSIX threads on Linux. */\n+#undef LINUX_THREADS\n \n-/* Define if using POSIX threads that have the mutexattr functions. */\n-#undef HAVE_PTHREAD_MUTEXATTR_INIT\n+/* Define if MinGW libgcj uses the Windows UNICODE OS API. */\n+#undef MINGW_LIBGCJ_UNICODE\n \n /* Define if getuid() and friends are missing. */\n #undef NO_GETUID\n \n-/* Define if your platform has a working backtrace() function. */\n-#undef HAVE_BACKTRACE\n-\n-/* Define if your platform has a working backtrace() function. */\n-#undef HAVE_BACKTRACE\n-\n-/* Define if your platform has a working backtrace() function. */\n-#undef HAVE_BACKTRACE\n-\n-/* Define if you have dladdr() */\n-#undef HAVE_DLADDR\n-\n-/* Define if you have /proc/self/exe */\n-#undef HAVE_PROC_SELF_EXE\n-\n-/* Define if you have /proc/self/exe */\n-#undef HAVE_PROC_SELF_EXE\n-\n-/* Define if you have the iconv() function. */\n-#undef HAVE_ICONV\n-\n-/* Define as const if the declaration of iconv() needs const. */\n-#undef ICONV_CONST\n-\n-/* Define if your <locale.h> file defines LC_MESSAGES. */\n-#undef HAVE_LC_MESSAGES\n-\n-/* Define if you have the 'gethostbyname_r' function. */\n-#undef HAVE_GETHOSTBYNAME_R\n-\n-/* Define if gethostbyname_r returns 'int'. */\n-#undef GETHOSTBYNAME_R_RETURNS_INT\n-\n-/* Required define if using POSIX threads */\n-#undef _REENTRANT\n-\n-/* Define if struct hostent_data is defined in netdb.h */\n-#undef HAVE_STRUCT_HOSTENT_DATA\n+/* Name of package */\n+#undef PACKAGE\n \n-/* Define if you have the 'gethostbyaddr_r' function. */\n-#undef HAVE_GETHOSTBYADDR_R\n+/* Define to the address where bug reports for this package should be sent. */\n+#undef PACKAGE_BUGREPORT\n \n-/* Define if gethostbyaddr_r returns 'int'. */\n-#undef GETHOSTBYADDR_R_RETURNS_INT\n+/* Define to the full name of this package. */\n+#undef PACKAGE_NAME\n \n-/* Define if you have the 'gethostname' function. */\n-#undef HAVE_GETHOSTNAME\n+/* Define to the full name and version of this package. */\n+#undef PACKAGE_STRING\n \n-/* Define if gethostname is declared in <unistd.h>. */\n-#undef HAVE_GETHOSTNAME_DECL\n+/* Define to the one symbol short name of this package. */\n+#undef PACKAGE_TARNAME\n \n-/* Define if usleep is declared in <unistd.h>. */\n-#undef HAVE_USLEEP_DECL\n+/* Define to the version of this package. */\n+#undef PACKAGE_VERSION\n \n /* Define if pthread_mutex_t has m_count member. */\n #undef PTHREAD_MUTEX_HAVE_M_COUNT\n \n /* Define if pthread_mutex_t has __m_count member. */\n #undef PTHREAD_MUTEX_HAVE___M_COUNT\n \n-/* Define if dlopen is available */\n-#undef HAVE_DLOPEN\n-\n /* The number of bytes in type void * */\n #undef SIZEOF_VOID_P\n \n-/* Short GCJ version ID */\n-#undef GCJVERSION\n+/* Define if the compiler is configured for setjmp/longjmp exceptions. */\n+#undef SJLJ_EXCEPTIONS\n \n-/* Define if <inttypes.h> is available */\n-#undef HAVE_INTTYPES_H\n+/* Define if if the synchronization code should try to avoid pthread_self\n+   calls by caching thread IDs in a hashtable. */\n+#undef SLOW_PTHREAD_SELF\n \n-/* Define if <inttypes.h> is available */\n-#undef JV_HAVE_INTTYPES_H\n+/* If using the C implementation of alloca, define if you know the\n+   direction of stack growth for your system; otherwise it will be\n+   automatically deduced at run-time.\n+\tSTACK_DIRECTION > 0 => grows toward higher addresses\n+\tSTACK_DIRECTION < 0 => grows toward lower addresses\n+\tSTACK_DIRECTION = 0 => direction of growth unknown */\n+#undef STACK_DIRECTION\n \n-/* Define to 1 if 'in_addr_t' is defined in sys/types.h or netinet/in.h. */\n-#undef HAVE_IN_ADDR_T\n+/* Define to 1 if you have the ANSI C header files. */\n+#undef STDC_HEADERS\n \n-/* Define if struct ip_mreq is defined in netinet/in.h. */\n-#undef HAVE_STRUCT_IP_MREQ\n+/* Define if struct tm has tm_gmtoff field. */\n+#undef STRUCT_TM_HAS_GMTOFF\n \n-/* Define if struct ipv6_mreq is defined in netinet/in.h. */\n-#undef HAVE_STRUCT_IPV6_MREQ\n+/* Define to 1 if your <sys/time.h> declares `struct tm'. */\n+#undef TM_IN_SYS_TIME\n \n-/* Define if inet6 structures are defined in netinet/in.h. */\n-#undef HAVE_INET6\n+/* Define if we're to use libffi. */\n+#undef USE_LIBFFI\n \n-/* Define it socklen_t typedef is in sys/socket.h. */\n-#undef HAVE_SOCKLEN_T\n+/* Define if libltdl is in use. */\n+#undef USE_LTDL\n \n-/* Define if struct tm has tm_gmtoff field. */\n-#undef STRUCT_TM_HAS_GMTOFF\n+/* Version number of package */\n+#undef VERSION\n \n-/* Define if global 'timezone' exists. */\n-#undef HAVE_TIMEZONE\n+/* Define to 1 if the X Window System is missing or not being used. */\n+#undef X_DISPLAY_MISSING\n \n-/* Define if your platform has the global _timezone variable. */\n-#undef HAVE_UNDERSCORE_TIMEZONE\n+/* Required define if using POSIX threads */\n+#undef _POSIX_PTHREAD_SEMANTICS\n \n+/* Required define if using POSIX threads */\n+#undef _REENTRANT\n+\n+/* Define to `int' if <sys/types.h> does not define. */\n+#undef ssize_t"}, {"sha": "fbd6c4c8a4908f1267fd9988fa954c5b06d5b40b", "filename": "libjava/java/lang/PosixProcess.java", "status": "modified", "additions": 420, "deletions": 31, "changes": 451, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fjava%2Flang%2FPosixProcess.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fjava%2Flang%2FPosixProcess.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FPosixProcess.java?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -1,6 +1,5 @@\n // PosixProcess.java - Subclass of Process for POSIX systems.\n-\n-/* Copyright (C) 1998, 1999  Free Software Foundation\n+/* Copyright (C) 1998, 1999, 2004  Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -11,76 +10,466 @@\n package java.lang;\n \n import java.io.File;\n+import java.io.IOException;\n import java.io.InputStream;\n import java.io.OutputStream;\n-import java.io.IOException;\n+import java.util.HashMap;\n+import java.util.LinkedList;\n+import java.util.List;\n+import java.util.Map;\n+\n \n /**\n  * @author Tom Tromey <tromey@cygnus.com>\n  * @date May 3, 1999\n+ * @author David Daney <ddaney@avtrex.com> Rewrote using\n+ * ProcessManager\n  */\n \n // This is entirely internal to our implementation.\n-\n // This file is copied to `ConcreteProcess.java' before compilation.\n // Hence the class name apparently does not match the file name.\n final class ConcreteProcess extends Process\n {\n-  public native void destroy ();\n+  static class ProcessManager extends Thread\n+  {\n+    /**\n+     * A list of {@link ConcreteProcess ConcreteProcesses} to be\n+     * started.  The queueLock object is used as the lock Object\n+     * for all process related operations. To avoid dead lock\n+     * ensure queueLock is obtained before ConcreteProcess.\n+     */\n+    List queue = new LinkedList();\n+    private Map pidToProcess = new HashMap();\n+    private boolean ready = false;\n+    private long reaperPID;\n+\n+    ProcessManager()\n+    {\n+      super(\"ProcessManager\");\n+      // Don't keep the (main) process from exiting on our account.\n+      this.setDaemon(true);\n+    }\n+\n+    /**\n+     * Get the ConcreteProcess object with the given pid and\n+     * remove it from the map.  This method is called from the\n+     * native code for {@link #reap()).  The mapping is removed so\n+     * the ConcreteProcesses can be GCed after they terminate.\n+     *\n+     * @param p The pid of the process.\n+     */\n+    private ConcreteProcess removeProcessFromMap(long p)\n+    {\n+      return (ConcreteProcess) pidToProcess.remove(new Long(p));\n+    }\n+\n+    /**\n+     * Put the given ConcreteProcess in the map using the Long\n+     * value of its pid as the key.\n+     *\n+     * @param p The ConcreteProcess.\n+     */\n+    void addProcessToMap(ConcreteProcess p)\n+    {\n+      pidToProcess.put(new Long(p.pid), p);\n+    }\n+\n+    /**\n+     * Queue up the ConcreteProcess and awake the ProcessManager.\n+     * The ProcessManager will start the ConcreteProcess from its\n+     * thread so it can be reaped when it terminates.\n+     *\n+     * @param p The ConcreteProcess.\n+     */\n+    void startExecuting(ConcreteProcess p)\n+    {\n+      synchronized (queueLock)\n+        {\n+\t  queue.add(p);\n+\t  signalReaper(); // If blocked in waitForSignal().\n+\t  queueLock.notifyAll(); // If blocked in wait();\n+        }\n+    }\n+\n+    /**\n+     * Block until the ProcessManager thread is ready to accept\n+     * commands.\n+     */\n+    void waitUntilReady()\n+    {\n+      synchronized (this)\n+        {\n+\t  try\n+\t    {\n+\t      while (! ready)\n+\t\twait();\n+\t    }\n+\t  catch (InterruptedException ie)\n+\t    {\n+\t      // Ignore.\n+\t    }\n+        }\n+    }\n+\n+    /**\n+     * Main Process starting/reaping loop.\n+     */\n+    public void run()\n+    {\n+      init();\n+      // Now ready to accept requests.\n+      synchronized (this)\n+        {\n+\t  ready = true;\n+\t  this.notifyAll();\n+        }\n+\n+      for (;;)\n+        {\n+\t  try\n+\t    {\n+\t      synchronized (queueLock)\n+\t        {\n+\t\t  boolean haveMoreChildren = reap();\n+\t\t  if (! haveMoreChildren && queue.size() == 0)\n+\t\t    {\n+\t\t      // This reaper thread could exit, but we\n+\t\t      // keep it alive for a while in case\n+\t\t      // someone wants to start more Processes.\n+\t\t      try\n+\t\t        {\n+\t\t\t  queueLock.wait(1000L);\n+\t\t\t  if (queue.size() == 0)\n+\t\t\t    {\n+\t\t\t      processManager = null;\n+\t\t\t      return; // Timed out.\n+\t\t\t    }\n+\t\t        }\n+\t\t      catch (InterruptedException ie)\n+\t\t        {\n+\t\t\t  // Ignore and exit the thread.\n+\t\t\t  return;\n+\t\t        }\n+\t\t    }\n+\t\t  while (queue.size() > 0)\n+\t\t    {\n+\t\t      ConcreteProcess p = (ConcreteProcess) queue.remove(0);\n+\t\t      p.spawn(this);\n+\t\t    }\n+\t        }\n \n-  public int exitValue ()\n+\t      // Wait for a SIGCHLD from either an exiting\n+\t      // process or the startExecuting() method.  This\n+\t      // is done outside of the synchronized block to\n+\t      // allow other threads to enter and submit more\n+\t      // jobs.\n+\t      waitForSignal();\n+\t    }\n+\t  catch (Exception ex)\n+\t    {\n+\t      ex.printStackTrace(System.err);\n+\t    }\n+        }\n+    }\n+\n+    /**\n+     * Setup native signal handlers and other housekeeping things.\n+     *\n+     */\n+    private native void init();\n+\n+    /**\n+     * Block waiting for SIGCHLD.\n+     *\n+     */\n+    private native void waitForSignal();\n+\n+    /**\n+     * Try to reap as many children as possible without blocking.\n+     *\n+     * @return true if more live children exist.\n+     *\n+     */\n+    private native boolean reap();\n+\n+    /**\n+     * Send SIGCHLD to the reaper thread.\n+     */\n+    private native void signalReaper();\n+  }\n+\n+  public void destroy()\n   {\n-    if (! hasExited)\n-      throw new IllegalThreadStateException(\"Process has not exited\");\n+    // Synchronized on the queueLock.  This ensures that the reaper\n+    // thread cannot be doing a wait() on the child.\n+    // Otherwise there would be a race where the OS could\n+    // create a process with the same pid between the wait()\n+    // and the update of the state which would cause a kill to\n+    // the wrong process.\n+    synchronized (queueLock)\n+      {\n+\tsynchronized (this)\n+\t  {\n+\t    // If there is no ProcessManager we cannot kill.\n+\t    if (state != STATE_TERMINATED)\n+\t      {\n+\t\tif (processManager == null)\n+\t\t  throw new InternalError();\n+\t\tnativeDestroy();\n+\t      }\n+\t  }\n+      }\n+  }\n+\n+  private native void nativeDestroy();\n+\n+  public int exitValue()\n+  {\n+    synchronized (this)\n+      {\n+\tif (state != STATE_TERMINATED)\n+\t  throw new IllegalThreadStateException(\"Process has not exited\");\n+      }\n     return status;\n   }\n \n-  public InputStream getErrorStream ()\n+  /**\n+   * Called by native code when process exits.\n+   *\n+   * Already synchronized (this).  Close any streams that we can to\n+   * conserve file descriptors.\n+   *\n+   * The outputStream can be closed as any future writes will\n+   * generate an IOException due to EPIPE.\n+   *\n+   * The inputStream and errorStream can only be closed if the user\n+   * has not obtained a reference to them AND they have no bytes\n+   * available.  Since the process has terminated they will never have\n+   * any more data available and can safely be replaced by\n+   * EOFInputStreams.\n+   */\n+  void processTerminationCleanup()\n+  {\n+    try\n+      {\n+        outputStream.close();\n+      }\n+    catch (IOException ioe)\n+      {\n+        // Ignore.\n+      }\n+    try\n+      {\n+        if (returnedErrorStream == null && errorStream.available() == 0)\n+          {\n+            errorStream.close();\n+            errorStream = null;\n+          }\n+      }\n+    catch (IOException ioe)\n+      {\n+        // Ignore.\n+      }\n+    try\n+      {\n+        if (returnedInputStream == null && inputStream.available() == 0)\n+          {\n+            inputStream.close();\n+            inputStream = null;\n+          }\n+      }\n+    catch (IOException ioe)\n+      {\n+        // Ignore.\n+      }\n+  }\n+\n+  public synchronized InputStream getErrorStream()\n   {\n-    return errorStream;\n+    if (returnedErrorStream != null)\n+      return returnedErrorStream;\n+\n+    if (errorStream == null)\n+      returnedErrorStream = EOFInputStream.instance;\n+    else\n+      returnedErrorStream = errorStream;\n+            \n+    return returnedErrorStream;\n   }\n \n-  public InputStream getInputStream ()\n+  public synchronized InputStream getInputStream()\n   {\n-    return inputStream;\n+    if (returnedInputStream != null)\n+      return returnedInputStream;\n+\n+    if (inputStream == null)\n+      returnedInputStream = EOFInputStream.instance;\n+    else\n+      returnedInputStream = inputStream;\n+            \n+    return returnedInputStream;\n   }\n \n-  public OutputStream getOutputStream ()\n+  public OutputStream getOutputStream()\n   {\n     return outputStream;\n   }\n \n-  public native int waitFor () throws InterruptedException;\n+  public int waitFor() throws InterruptedException\n+  {\n+    synchronized (this)\n+      {\n+\twhile (state != STATE_TERMINATED)\n+\t  wait();\n+      }\n+    return status;\n+  }\n \n-  // This is used for actual initialization, as we can't write a\n-  // native constructor.\n-  public native void startProcess (String[] progarray,\n-                                   String[] envp,\n-                                   File dir)\n-    throws IOException;\n+  /**\n+   * Start this process running.  This should only be called by the\n+   * ProcessManager.\n+   *\n+   * @param pm The ProcessManager that made the call.\n+   */\n+  void spawn(ProcessManager pm)\n+  {\n+    synchronized (this)\n+      {\n+\t// Do the fork/exec magic.\n+\tnativeSpawn();\n+\t// There is no race with reap() in the pidToProcess map\n+\t// because this is always called from the same thread\n+\t// doing the reaping.\n+\tpm.addProcessToMap(this);\n+\tstate = STATE_RUNNING;\n+\t// Notify anybody waiting on state change.\n+\tthis.notifyAll();\n+      }\n+  }\n+\n+  /**\n+   * Do the fork and exec.\n+   */\n+  private native void nativeSpawn();\n \n   // This file is copied to `ConcreteProcess.java' before\n   // compilation.  Hence the constructor name apparently does not\n   // match the file name.\n-  public ConcreteProcess (String[] progarray,\n-                          String[] envp,\n-                          File dir)\n-    throws IOException\n+  ConcreteProcess(String[] progarray, String[] envp, File dir)\n+           throws IOException\n   {\n-    startProcess (progarray, envp, dir);\n+    // Check to ensure there is something to run, and avoid\n+    // dereferencing null pointers in native code.\n+    if (progarray[0] == null)\n+      throw new NullPointerException();\n+\n+    this.progarray = progarray;\n+    this.envp = envp;\n+    this.dir = dir;\n+\n+    // Start a ProcessManager if there is not one already running.\n+    synchronized (queueLock)\n+      {\n+\tif (processManager == null)\n+\t  {\n+\t    processManager = new ProcessManager();\n+\t    processManager.start();\n+\t    processManager.waitUntilReady();\n+\t  }\n+\n+\t// Queue this ConcreteProcess for starting by the ProcessManager.\n+\tprocessManager.startExecuting(this);\n+      }\n+\n+    // Wait until ProcessManager has started us.\n+    synchronized (this)\n+      {\n+\twhile (state == STATE_WAITING_TO_START)\n+\t  {\n+\t    try\n+\t      {\n+\t\twait();\n+\t      }\n+\t    catch (InterruptedException ie)\n+\t      {\n+\t\t// FIXME: What to do when interrupted while blocking in a constructor?\n+\t\t// Ignore.\n+\t      }\n+\t  }\n+      }\n+\n+    // If there was a problem, re-throw it.\n+    if (exception != null)\n+      {\n+\tif (exception instanceof IOException)\n+\t  {\n+\t    IOException ioe = new IOException(exception.toString());\n+\t    ioe.initCause(exception);\n+\t    throw ioe;\n+\t  }\n+\n+\t// Not an IOException.  Something bad happened.\n+\tInternalError ie = new InternalError(exception.toString());\n+\tie.initCause(exception);\n+\tthrow ie;\n+      }\n+\n+    // If we get here, all is well, the Process has started.\n   }\n \n-  // The process id.  This is cast to a pid_t on the native side.\n+  private String[] progarray;\n+  private String[] envp;\n+  private File dir;\n+\n+  /** Set by the ProcessManager on problems starting. */\n+  private Throwable exception;\n+\n+  /** The process id.  This is cast to a pid_t on the native side. */\n   private long pid;\n \n-  // True when child has exited.\n-  private boolean hasExited;\n+  // FIXME: Why doesn't the friend declaration in ConcreteProcess.h\n+  // allow ConcreteProcess$ProcessManager native code access these\n+  // when they are private?\n+\n+  /** Before the process is forked. */\n+  static final int STATE_WAITING_TO_START = 0;\n+\n+  /** After the fork. */\n+  static final int STATE_RUNNING = 1;\n+\n+  /** After exit code has been collected. */\n+  static final int STATE_TERMINATED = 2;\n \n-  // The exit status, if the child has exited.\n-  private int status;\n+  /** One of STATE_WAITING_TO_START, STATE_RUNNING, STATE_TERMINATED. */\n+  int state;\n \n-  // The streams.\n+  /** The exit status, if the child has exited. */\n+  int status;\n+\n+  /** The streams. */\n   private InputStream errorStream;\n   private InputStream inputStream;\n   private OutputStream outputStream;\n+\n+  /** InputStreams obtained by the user.  Not null indicates that the\n+   *  user has obtained the stream.\n+   */\n+  private InputStream returnedErrorStream;\n+  private InputStream returnedInputStream;\n+\n+  /**\n+   * Lock Object for all processManager related locking.\n+   */\n+  private static Object queueLock = new Object();\n+  private static ProcessManager processManager;\n+\n+  static class EOFInputStream extends InputStream\n+  {\n+    static EOFInputStream instance = new EOFInputStream();\n+    public int read()\n+    {\n+      return -1;\n+    }\n+  }\n }"}, {"sha": "b6b8c4f171aa227767ed7691360367b58b8ce0b3", "filename": "libjava/java/lang/Runtime.java", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fjava%2Flang%2FRuntime.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fjava%2Flang%2FRuntime.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FRuntime.java?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -1,5 +1,5 @@\n /* Runtime.java -- access to the VM process\n-   Copyright (C) 1998, 2002, 2003 Free Software Foundation\n+   Copyright (C) 1998, 2002, 2003, 2004 Free Software Foundation\n \n This file is part of GNU Classpath.\n \n@@ -734,8 +734,11 @@ public OutputStream getLocalizedOutputStream(OutputStream out)\n    * @param dir the directory to use, may be null\n    * @return the newly created process\n    * @throws NullPointerException if cmd or env have null elements\n+   * @throws IOException if the exec fails\n    */\n-  native Process execInternal(String[] cmd, String[] env, File dir);\n+  native Process execInternal(String[] cmd, String[] env, File dir)\n+    throws IOException;\n+    \n \n   /**\n    * Get the system properties. This is done here, instead of in System,"}, {"sha": "f6b6f67baf57854e97ad55043ae1484e3371f8e5", "filename": "libjava/java/lang/natPosixProcess.cc", "status": "modified", "additions": 156, "deletions": 64, "changes": 220, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fjava%2Flang%2FnatPosixProcess.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fjava%2Flang%2FnatPosixProcess.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatPosixProcess.cc?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -21,12 +21,16 @@ details.  */\n #include <string.h>\n #include <stdlib.h>\n #include <stdio.h>\n+#include <unistd.h>\n+#include <pthread.h>\n \n #include <gcj/cni.h>\n #include <jvm.h>\n \n+#include <java/lang/ConcreteProcess$ProcessManager.h>\n #include <java/lang/ConcreteProcess.h>\n #include <java/lang/IllegalThreadStateException.h>\n+#include <java/lang/InternalError.h>\n #include <java/lang/InterruptedException.h>\n #include <java/lang/NullPointerException.h>\n #include <java/lang/Thread.h>\n@@ -42,44 +46,6 @@ using gnu::java::nio::channels::FileChannelImpl;\n \n extern char **environ;\n \n-void\n-java::lang::ConcreteProcess::destroy (void)\n-{\n-  if (! hasExited)\n-    {\n-      // Really kill it.\n-      kill ((pid_t) pid, SIGKILL);\n-    }\n-}\n-\n-jint\n-java::lang::ConcreteProcess::waitFor (void)\n-{\n-  if (! hasExited)\n-    {\n-      int wstat;\n-      int r = waitpid ((pid_t) pid, &wstat, 0);\n-\n-      if (r == -1)\n-        {\n-\t  if (java::lang::Thread::interrupted())\n-\t    throw new InterruptedException (JvNewStringLatin1 (strerror\n-\t      (errno)));\n-\t}\n-      else\n-\t{\n-\t  hasExited = true;\n-\n-\t  if (WIFEXITED (wstat))\n-\t    status = WEXITSTATUS (wstat);\n-\t  else\n-\t    status = -1;\n-\t}\n-    }\n-\n-  return status;\n-}\n-\n static char *\n new_string (jstring string)\n {\n@@ -120,14 +86,134 @@ myclose (int &fd)\n   fd = -1;\n }\n \n+// There has to be a signal handler in order to be able to\n+// sigwait() on SIGCHLD.  The information passed is ignored as it\n+// will be recovered by the waitpid() call.\n+static void\n+sigchld_handler (int)\n+{\n+  // Ignore.\n+}\n+\n+\n+// Get ready to enter the main reaper thread loop.\n void\n-java::lang::ConcreteProcess::startProcess (jstringArray progarray,\n-\t\t\t\t\t   jstringArray envp,\n-\t\t\t\t\t   java::io::File *dir)\n+java::lang::ConcreteProcess$ProcessManager::init ()\n {\n-  using namespace java::io;\n+  using namespace java::lang;\n+  // Remenber our PID so other threads can kill us.\n+  reaperPID = (jlong) pthread_self ();\n+\n+  // SIGCHLD is blocked in all threads in posix-threads.cc.\n+  // Setup the SIGCHLD handler.\n+  struct sigaction sa;\n+  memset (&sa, 0, sizeof (sa));\n+\n+  sa.sa_handler = sigchld_handler;\n+  // We only want signals when the things exit.\n+  sa.sa_flags = SA_NOCLDSTOP;\n+\n+  if (-1 == sigaction (SIGCHLD, &sa, NULL))\n+    goto error;\n+\n+  // All OK.\n+  return;\n+\n+error:\n+  throw new InternalError (JvNewStringUTF (strerror (errno)));\n+}\n+\n+void\n+java::lang::ConcreteProcess$ProcessManager::waitForSignal ()\n+{\n+  using namespace java::lang;\n+\n+  sigset_t mask;\n+  // Wait for SIGCHLD\n+  sigemptyset (&mask);\n+  sigaddset (&mask, SIGCHLD);\n+\n+  int sig;\n+  int c = sigwait (&mask, &sig);\n+\n+  if (c != 0)\n+    goto error;\n \n-  hasExited = false;\n+  // All OK.\n+  return;\n+\n+error:\n+  throw new InternalError (JvNewStringUTF (strerror (c)));\n+}\n+\n+jboolean java::lang::ConcreteProcess$ProcessManager::reap ()\n+{\n+  using namespace java::lang;\n+\n+  pid_t pid;\n+\n+  for (;;)\n+    {\n+      // Get the return code from a dead child process.\n+      int status;\n+      pid = waitpid ((pid_t) - 1, &status, WNOHANG);\n+      if (pid == -1)\n+\t{\n+\t  if (errno == ECHILD)\n+\t    return false;\n+\t  else\n+\t    goto error;\n+\t}\n+\n+      if (pid == 0)\n+        return true;   // No children to wait for.\n+\n+      // Look up the process in our pid map.\n+      ConcreteProcess * process = removeProcessFromMap ((jlong) pid);\n+\n+      if (process)\n+\t{\n+\t  JvSynchronize sync (process);\n+\t  process->status = WIFEXITED (status) ? WEXITSTATUS (status) : -1;\n+\t  process->state = ConcreteProcess::STATE_TERMINATED;\n+          process->processTerminationCleanup();\n+\t  process->notifyAll ();\n+\t}\n+      else\n+\t{\n+\t  // Unknown child.  How did this happen?\n+\t  fprintf (stderr, \"Reaped unknown child pid = %ld\\n\", (long) pid);\n+\t}\n+    }\n+\n+error:\n+  throw new InternalError (JvNewStringUTF (strerror (errno)));\n+}\n+\n+void\n+java::lang::ConcreteProcess$ProcessManager::signalReaper ()\n+{\n+  int c = pthread_kill ((pthread_t) reaperPID, SIGCHLD);\n+  if (c == 0)\n+    return;\n+  // pthread_kill() failed.\n+  throw new InternalError (JvNewStringUTF (strerror (c)));\n+}\n+\n+void\n+java::lang::ConcreteProcess::nativeDestroy ()\n+{\n+  int c = kill ((pid_t) pid, SIGKILL);\n+  if (c == 0)\n+    return;\n+  // kill() failed.\n+  throw new InternalError (JvNewStringUTF (strerror (errno)));\n+}\n+\n+void\n+java::lang::ConcreteProcess::nativeSpawn ()\n+{\n+  using namespace java::io;\n \n   // Initialize all locals here to make cleanup simpler.\n   char **args = NULL;\n@@ -142,16 +228,14 @@ java::lang::ConcreteProcess::startProcess (jstringArray progarray,\n   errp[1] = -1;\n   msgp[0] = -1;\n   msgp[1] = -1;\n-  java::lang::Throwable *exc = NULL;\n   errorStream = NULL;\n   inputStream = NULL;\n   outputStream = NULL;\n \n   try\n     {\n       // Transform arrays to native form.\n-      args = (char **) _Jv_Malloc ((progarray->length + 1)\n-\t\t\t\t   * sizeof (char *));\n+    args = (char **) _Jv_Malloc ((progarray->length + 1) * sizeof (char *));\n \n       // Initialize so we can gracefully recover.\n       jstring *elts = elements (progarray);\n@@ -185,24 +269,32 @@ java::lang::ConcreteProcess::startProcess (jstringArray progarray,\n       // status.\n       if (pipe (inp) || pipe (outp) || pipe (errp) || pipe (msgp)\n \t  || fcntl (msgp[1], F_SETFD, FD_CLOEXEC))\n-\tthrow new IOException (JvNewStringLatin1 (strerror (errno)));\n+      throw new IOException (JvNewStringUTF (strerror (errno)));\n \n       // We create the streams before forking.  Otherwise if we had an\n       // error while creating the streams we would have run the child\n       // with no way to communicate with it.\n-      errorStream = new FileInputStream (new FileChannelImpl(errp[0], FileChannelImpl::READ));\n-      inputStream = new FileInputStream (new FileChannelImpl(inp[0], FileChannelImpl::READ));\n-      outputStream = new FileOutputStream (new FileChannelImpl(outp[1], FileChannelImpl::WRITE));\n+    errorStream =\n+      new FileInputStream (new\n+                           FileChannelImpl (errp[0], FileChannelImpl::READ));\n+    inputStream =\n+      new FileInputStream (new\n+                           FileChannelImpl (inp[0], FileChannelImpl::READ));\n+    outputStream =\n+      new FileOutputStream (new FileChannelImpl (outp[1],\n+                                             FileChannelImpl::WRITE));\n \n       // We don't use vfork() because that would cause the local\n       // environment to be set by the child.\n-      if ((pid = (jlong) fork ()) == -1)\n-\tthrow new IOException (JvNewStringLatin1 (strerror (errno)));\n \n-      if (pid == 0)\n+    // Use temporary for fork result to avoid dirtying an extra page.\n+    pid_t pid_tmp;\n+    if ((pid_tmp = fork ()) == -1)\n+      throw new IOException (JvNewStringUTF (strerror (errno)));\n+\n+    if (pid_tmp == 0)\n \t{\n \t  // Child process, so remap descriptors, chdir and exec.\n-\n \t  if (envp)\n \t    {\n \t      // Preserve PATH and LD_LIBRARY_PATH unless specified\n@@ -212,16 +304,16 @@ java::lang::ConcreteProcess::startProcess (jstringArray progarray,\n \t      environ = env;\n \t      if (path_val && getenv (\"PATH\") == NULL)\n \t\t{\n-\t\t  char *path_env = (char *) _Jv_Malloc (strlen (path_val)\n-\t\t\t\t\t\t\t+ 5 + 1);\n+\t\tchar *path_env =\n+                  (char *) _Jv_Malloc (strlen (path_val) + 5 + 1);\n \t\t  strcpy (path_env, \"PATH=\");\n \t\t  strcat (path_env, path_val);\n \t\t  putenv (path_env);\n \t\t}\n \t      if (ld_path_val && getenv (\"LD_LIBRARY_PATH\") == NULL)\n \t\t{\n-\t\t  char *ld_path_env\n-\t\t    = (char *) _Jv_Malloc (strlen (ld_path_val) + 16 + 1);\n+\t\tchar *ld_path_env =\n+                  (char *) _Jv_Malloc (strlen (ld_path_val) + 16 + 1);\n \t\t  strcpy (ld_path_env, \"LD_LIBRARY_PATH=\");\n \t\t  strcat (ld_path_env, ld_path_val);\n \t\t  putenv (ld_path_env);\n@@ -264,6 +356,8 @@ java::lang::ConcreteProcess::startProcess (jstringArray progarray,\n \n       // Parent.  Close extra file descriptors and mark ours as\n       // close-on-exec.\n+      pid = (jlong) pid_tmp;\n+\n       myclose (outp[0]);\n       myclose (inp[1]);\n       myclose (errp[1]);\n@@ -272,9 +366,9 @@ java::lang::ConcreteProcess::startProcess (jstringArray progarray,\n       char c;\n       int r = read (msgp[0], &c, 1);\n       if (r == -1)\n-\tthrow new IOException (JvNewStringLatin1 (strerror (errno)));\n+      throw new IOException (JvNewStringUTF (strerror (errno)));\n       else if (r != 0)\n-\tthrow new IOException (JvNewStringLatin1 (strerror (c)));\n+      throw new IOException (JvNewStringUTF (strerror (c)));\n     }\n   catch (java::lang::Throwable *thrown)\n     {\n@@ -324,15 +418,13 @@ java::lang::ConcreteProcess::startProcess (jstringArray progarray,\n       myclose (errp[1]);\n       myclose (msgp[1]);\n \n-      exc = thrown;\n+    exception = thrown;\n     }\n \n   myclose (msgp[0]);\n   cleanup (args, env, path);\n \n-  if (exc != NULL)\n-    throw exc;\n-  else\n+  if (exception == NULL)\n     {\n       fcntl (outp[1], F_SETFD, FD_CLOEXEC);\n       fcntl (inp[0], F_SETFD, FD_CLOEXEC);"}, {"sha": "0643c1a5c7b86053055652661f3c4bb808b99440", "filename": "libjava/posix-threads.cc", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fposix-threads.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Fposix-threads.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fposix-threads.cc?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -1,6 +1,6 @@\n // posix-threads.cc - interface between libjava and POSIX threads.\n \n-/* Copyright (C) 1998, 1999, 2000, 2001  Free Software Foundation\n+/* Copyright (C) 1998, 1999, 2000, 2001, 2004  Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -34,6 +34,7 @@ details.  */\n #include <java/lang/System.h>\n #include <java/lang/Long.h>\n #include <java/lang/OutOfMemoryError.h>\n+#include <java/lang/InternalError.h>\n \n // This is used to implement thread startup.\n struct starter\n@@ -332,6 +333,17 @@ _Jv_ThreadSetPriority (_Jv_Thread_t *data, jint prio)\n #endif\n }\n \n+static void\n+block_sigchld()\n+{\n+  sigset_t mask;\n+  sigemptyset (&mask);\n+  sigaddset (&mask, SIGCHLD);\n+  int c = pthread_sigmask (SIG_BLOCK, &mask, NULL);\n+  if (c != 0)\n+    throw new java::lang::InternalError (JvNewStringUTF (strerror (c)));\n+}\n+\n void\n _Jv_ThreadRegister (_Jv_Thread_t *data)\n {\n@@ -358,6 +370,8 @@ _Jv_ThreadRegister (_Jv_Thread_t *data)\n \t_Jv_self_cache[current_index].high_sp_bits = BAD_HIGH_SP_VALUE;\n       }\n # endif\n+  // Block SIGCHLD which is used in natPosixProcess.cc.\n+  block_sigchld();\n }\n \n void\n@@ -403,6 +417,10 @@ _Jv_ThreadStart (java::lang::Thread *thread, _Jv_Thread_t *data,\n     return;\n   data->flags |= FLAG_START;\n \n+  // Block SIGCHLD which is used in natPosixProcess.cc.\n+  // The current mask is inherited by the child thread.\n+  block_sigchld();\n+\n   param.sched_priority = thread->getPriority();\n \n   pthread_attr_init (&attr);"}, {"sha": "c7f88f2ba1612fcfe120b9d9faa6436de10c5980", "filename": "libjava/testsuite/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Ftestsuite%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c58f29001dee1b4f6dfb09cc2a49f2739b106553/libjava%2Ftestsuite%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2FMakefile.in?ref=c58f29001dee1b4f6dfb09cc2a49f2739b106553", "patch": "@@ -128,6 +128,7 @@ PANGOFT2_LIBS = @PANGOFT2_LIBS@\n PERL = @PERL@\n PKG_CONFIG = @PKG_CONFIG@\n PLATFORMOBJS = @PLATFORMOBJS@\n+PLATFORM_INNER_NAT_HDRS = @PLATFORM_INNER_NAT_HDRS@\n RANLIB = @RANLIB@\n STRIP = @STRIP@\n SYSDEP_SOURCES = @SYSDEP_SOURCES@"}]}