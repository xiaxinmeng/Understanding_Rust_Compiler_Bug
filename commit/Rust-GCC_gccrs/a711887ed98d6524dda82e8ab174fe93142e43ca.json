{"sha": "a711887ed98d6524dda82e8ab174fe93142e43ca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTcxMTg4N2VkOThkNjUyNGRkYTgyZThhYjE3NGZlOTMxNDJlNDNjYQ==", "commit": {"author": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2017-01-18T19:24:30Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2017-01-18T19:24:30Z"}, "message": "re PR rtl-optimization/78952 (Combine does not convert 8-bit sign-extract to a zero-extract for QImode operations)\n\n\tPR rtl-optimization/78952\n\t* config/i386/i386.md (any_extract): New code iterator.\n\t(*insvqi_2): Use any_extract for source operand.\n\t(*insvqi_3): Use any_shiftrt for source operand.\n\ntestsuite/ChangeLog:\n\n\tPR rtl-optimization/78952\n\t* gcc.target/i386/pr78952-1.c: New test.\n\t* gcc.target/i386/pr78952-2.c: Ditto.\n\nFrom-SVN: r244591", "tree": {"sha": "fd04f8865bce5099513d075f47e73fbf346586ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fd04f8865bce5099513d075f47e73fbf346586ea"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a711887ed98d6524dda82e8ab174fe93142e43ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a711887ed98d6524dda82e8ab174fe93142e43ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a711887ed98d6524dda82e8ab174fe93142e43ca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a711887ed98d6524dda82e8ab174fe93142e43ca/comments", "author": null, "committer": null, "parents": [{"sha": "525a5e33b5c7baafd44ce91b4064148e99b4e97e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/525a5e33b5c7baafd44ce91b4064148e99b4e97e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/525a5e33b5c7baafd44ce91b4064148e99b4e97e"}], "stats": {"total": 87, "additions": 72, "deletions": 15}, "files": [{"sha": "73945d7ff1a226f9ad141215a8def6916db25e90", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a711887ed98d6524dda82e8ab174fe93142e43ca", "patch": "@@ -1,3 +1,10 @@\n+2017-01-18  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR rtl-optimization/78952\n+\t* config/i386/i386.md (any_extract): New code iterator.\n+\t(*insvqi_2): Use any_extract for source operand.\n+\t(*insvqi_3): Use any_shiftrt for source operand.\n+\n 2017-01-18  Wilco Dijkstra  <wdijkstr@arm.com>\n \n \t* config/aarch64/aarch64.c (aarch64_sched_adjust_priority)\n@@ -15,7 +22,7 @@\n \n 2017-01-18  Matthias Klose  <doko@ubuntu.com>\n \n-       * doc/install.texi: Allow default for --with-target-bdw-gc-include.\n+\t* doc/install.texi: Allow default for --with-target-bdw-gc-include.\n \n 2016-01-18  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n@@ -41,12 +48,6 @@\n \t(s390_valid_target_attribute_inner_p): Likewise.\n \t* config/s390/s390.md (\"tabort\"): Likewise.\n \n-2017-01-18  Jakub Jelinek  <jakub@redhat.com>\n-\n-\t* gcc.target/s390/target-attribute/tattr-2.c: Add -fno-ipa-icf\n-\tto dg-options.\n-\t(p0): Add missing dg-error.\n-\n 2017-01-18  Toma Tabacu  <toma.tabacu@imgtec.com>\n \n \t* config/mips/mips.h (ISA_HAS_DIV3): Remove unused macro."}, {"sha": "3af1ffc5dac1a7dd3762d808c1c0d84b1bec4adb", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=a711887ed98d6524dda82e8ab174fe93142e43ca", "patch": "@@ -2960,13 +2960,15 @@\n \t   (subreg:SI (match_dup 1) 0))\n       (unspec [(const_int 0)] UNSPEC_NOREX_MEM)])])\n \n+(define_code_iterator any_extract [sign_extract zero_extract])\n+\n (define_insn \"*insvqi_2\"\n   [(set (zero_extract:SI (match_operand 0 \"ext_register_operand\" \"+Q\")\n \t\t\t (const_int 8)\n \t\t\t (const_int 8))\n-\t(zero_extract:SI (match_operand 1 \"ext_register_operand\" \"Q\")\n-\t\t\t (const_int 8)\n-\t\t\t (const_int 8)))]\n+\t(any_extract:SI (match_operand 1 \"ext_register_operand\" \"Q\")\n+\t\t\t(const_int 8)\n+\t\t\t(const_int 8)))]\n   \"\"\n   \"mov{b}\\t{%h1, %h0|%h0, %h1}\"\n   [(set_attr \"type\" \"imov\")\n@@ -2976,8 +2978,8 @@\n   [(set (zero_extract:SI (match_operand 0 \"ext_register_operand\" \"+Q\")\n \t\t\t (const_int 8)\n \t\t\t (const_int 8))\n-\t(lshiftrt:SI (match_operand:SI 1 \"register_operand\" \"Q\")\n-\t\t     (const_int 8)))]\n+\t(any_shiftrt:SI (match_operand:SI 1 \"register_operand\" \"Q\")\n+\t\t\t(const_int 8)))]\n   \"\"\n   \"mov{b}\\t{%h1, %h0|%h0, %h1}\"\n   [(set_attr \"type\" \"imov\")"}, {"sha": "538e08effe20a594c292c03b581de0d861923932", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a711887ed98d6524dda82e8ab174fe93142e43ca", "patch": "@@ -1,3 +1,9 @@\n+2017-01-18  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR rtl-optimization/78952\n+\t* gcc.target/i386/pr78952-1.c: New test.\n+\t* gcc.target/i386/pr78952-2.c: Ditto.\n+\n 2017-01-18  Andre Vehreschild  <vehre@gcc.gnu.org>\n \n \t* gfortran.dg/coarray_alloc_with_implicit_sync_2.f90: New test.\n@@ -46,6 +52,12 @@\n \tPR c++/79091\n \t* g++.dg/pr79091.C: New.\n \n+2017-01-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* gcc.target/s390/target-attribute/tattr-2.c: Add -fno-ipa-icf\n+\tto dg-options.\n+\t(p0): Add missing dg-error.\n+\n 2017-01-17  Joe Seymour  <joe.s@somniumtech.com>\n \n \t* gcc.target/msp430/mul_f5_muldef.c: New test.\n@@ -177,7 +189,7 @@\n 2017-01-16  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tRevert:\n-        2017-01-16  Paolo Carlini  <paolo.carlini@oracle.com>\n+\t2017-01-16  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/71737\n \t* g++.dg/cpp0x/pr71737.C: New.\n@@ -198,8 +210,8 @@\n \n 2017-01-14  Bernd Schmidt  <bschmidt@redhat.com>\n \n-        PR rtl-optimization/78626\n-        PR rtl-optimization/78727\n+\tPR rtl-optimization/78626\n+\tPR rtl-optimization/78727\n \t* gcc.dg/torture/pr78626.c: New test.\n \t* gcc.dg/torture/pr78727.c: New test.\n "}, {"sha": "2d2746dfa8df3eb3c2a78ebc1c18426cd64a15e4", "filename": "gcc/testsuite/gcc.target/i386/pr78952-1.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78952-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78952-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78952-1.c?ref=a711887ed98d6524dda82e8ab174fe93142e43ca", "patch": "@@ -0,0 +1,21 @@\n+/* PR target/78952 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -masm=att\" } */\n+/* { dg-additional-options \"-mregparm=3\" { target ia32 } } */\n+/* { dg-final { scan-assembler-not \"movsbl\" } } */\n+\n+struct S1\n+{\n+  char pad1;\n+  char val;\n+  short pad2;\n+};\n+\n+struct S1 foo (struct S1 a, struct S1 b)\n+{\n+  a.val = b.val;\n+\n+  return a;\n+}\n+\n+/* { dg-final { scan-assembler \"\\[ \\t\\]movb\\[ \\t\\]+%.h, %.h\" } } */"}, {"sha": "18230f140e2d288349a7ca97ecf50419cf0c0705", "filename": "gcc/testsuite/gcc.target/i386/pr78952-2.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78952-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a711887ed98d6524dda82e8ab174fe93142e43ca/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78952-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78952-2.c?ref=a711887ed98d6524dda82e8ab174fe93142e43ca", "patch": "@@ -0,0 +1,21 @@\n+/* PR target/78952 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -masm=att\" } */\n+/* { dg-additional-options \"-mregparm=3\" { target ia32 } } */\n+/* { dg-final { scan-assembler-not \"sarl\" } } */\n+\n+struct S1\n+{\n+  char pad1;\n+  char val;\n+  short pad2;\n+};\n+\n+struct S1 foo (struct S1 a, int b)\n+{\n+  a.val = b >> 8;\n+\n+  return a;\n+}\n+\n+/* { dg-final { scan-assembler \"\\[ \\t\\]movb\\[ \\t\\]+%.h, %.h\" } } */"}]}