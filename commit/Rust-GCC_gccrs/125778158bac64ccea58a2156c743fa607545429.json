{"sha": "125778158bac64ccea58a2156c743fa607545429", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTI1Nzc4MTU4YmFjNjRjY2VhNThhMjE1NmM3NDNmYTYwNzU0NTQyOQ==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2010-06-22T09:36:25Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-22T09:36:25Z"}, "message": "sem_res.adb (Make_Call_Into_Operator): Use First_Subtype for better error reporting with generic types.\n\n2010-06-22  Thomas Quinot  <quinot@adacore.com>\n\n\t* sem_res.adb (Make_Call_Into_Operator): Use First_Subtype for better\n\terror reporting with generic types.\n\n2010-06-22  Thomas Quinot  <quinot@adacore.com>\n\n\t* bindgen.adb, bindusg.adb, gnatbind.adb, gnat_ugn.texi, opt.ads,\n\tosint-b.adb, osint-b.ads, output.adb, output.ads, switch-b.adb,\n\tvms_data.ads: Add a new command line switch -A to gnatbind to output\n\tthe list of all ALI files for the partition.\n\nFrom-SVN: r161153", "tree": {"sha": "9f819b958fa5cdcdd7d140ae5149fc01169432de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9f819b958fa5cdcdd7d140ae5149fc01169432de"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/125778158bac64ccea58a2156c743fa607545429", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/125778158bac64ccea58a2156c743fa607545429", "html_url": "https://github.com/Rust-GCC/gccrs/commit/125778158bac64ccea58a2156c743fa607545429", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/125778158bac64ccea58a2156c743fa607545429/comments", "author": null, "committer": null, "parents": [{"sha": "a3da92f99d722d52c0117015f26c5c8640b12511", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a3da92f99d722d52c0117015f26c5c8640b12511", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a3da92f99d722d52c0117015f26c5c8640b12511"}], "stats": {"total": 215, "additions": 182, "deletions": 33}, "files": [{"sha": "c255ccf509d0afc9222bf6a0a479ead94f7ad5f0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -1,3 +1,15 @@\n+2010-06-22  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* sem_res.adb (Make_Call_Into_Operator): Use First_Subtype for better\n+\terror reporting with generic types.\n+\n+2010-06-22  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* bindgen.adb, bindusg.adb, gnatbind.adb, gnat_ugn.texi, opt.ads,\n+\tosint-b.adb, osint-b.ads, output.adb, output.ads, switch-b.adb,\n+\tvms_data.ads: Add a new command line switch -A to gnatbind to output\n+\tthe list of all ALI files for the partition.\n+\n 2010-06-22  Arnaud Charlet  <charlet@adacore.com>\n \n \t* s-osinte-vxworks.ads: Fix casing."}, {"sha": "21118984fbdd8ed51a9e9b01bee66306130c5d6e", "filename": "gcc/ada/bindgen.adb", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fbindgen.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fbindgen.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindgen.adb?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -1936,6 +1936,10 @@ package body Bindgen is\n       WBI (\"\");\n       Write_Info_Ada_C (\"-- \", \"/* \", \" BEGIN Object file/option list\");\n \n+      if Object_List_Filename /= null then\n+         Set_List_File (Object_List_Filename.all);\n+      end if;\n+\n       for E in Elab_Order.First .. Elab_Order.Last loop\n \n          --  If not spec that has an associated body, then generate a\n@@ -1985,6 +1989,10 @@ package body Bindgen is\n          end if;\n       end loop;\n \n+      if Object_List_Filename /= null then\n+         Close_List_File;\n+      end if;\n+\n       --  Add a \"-Ldir\" for each directory in the object path\n \n       for J in 1 .. Nb_Dir_In_Obj_Search_Path loop"}, {"sha": "4702d82095ba95abe29ec3c08dde54e25b2dcded", "filename": "gcc/ada/bindusg.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fbindusg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fbindusg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindusg.adb?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                B o d y                                   --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -73,6 +73,10 @@ package body Bindusg is\n       Write_Line (\"  -a        Automatically initialize elaboration \" &\n                   \"procedure\");\n \n+      --  Line for -A switch\n+\n+      Write_Line (\"  -A        Give list of ALI files in partition\");\n+\n       --  Line for -b switch\n \n       Write_Line (\"  -b        Generate brief messages to stderr \" &"}, {"sha": "cf83af32290aeec37c126aee6fb172c5d4d59185", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -8028,6 +8028,10 @@ Specify directory to be searched for ALI files.\n @cindex @option{^-aI^/SOURCE_SEARCH^} (@command{gnatbind})\n Specify directory to be searched for source file.\n \n+@item ^-A^/ALI_LIST^@r{[=}@var{filename}@r{]}\n+@cindex @option{^-A^/ALI_LIST^} (@command{gnatbind})\n+Output ALI list (to standard output or to the named file).\n+\n @item ^-b^/REPORT_ERRORS=BRIEF^\n @cindex @option{^-b^/REPORT_ERRORS=BRIEF^} (@command{gnatbind})\n Generate brief messages to @file{stderr} even if verbose mode set.\n@@ -8180,9 +8184,9 @@ Name the output file @var{file} (default is @file{b~@var{xxx}.adb}).\n Note that if this option is used, then linking must be done manually,\n gnatlink cannot be used.\n \n-@item ^-O^/OBJECT_LIST^\n+@item ^-O^/OBJECT_LIST^@r{[=}@var{filename}@r{]}\n @cindex @option{^-O^/OBJECT_LIST^} (@command{gnatbind})\n-Output object list.\n+Output object list (to standard output or to the named file).\n \n @item ^-p^/PESSIMISTIC_ELABORATION^\n @cindex @option{^-p^/PESSIMISTIC_ELABORATION^} (@command{gnatbind})"}, {"sha": "c09f79557978d6890fac02416858ac55d7f55c76", "filename": "gcc/ada/gnatbind.adb", "status": "modified", "additions": 27, "deletions": 1, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fgnatbind.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fgnatbind.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatbind.adb?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -738,7 +738,7 @@ begin\n          Free (Text);\n       end if;\n \n-      --  Acquire all information in ALI files that have been read in\n+      --  Load ALIs for all dependent units\n \n       for Index in ALIs.First .. ALIs.Last loop\n          Read_Withed_ALIs (Index);\n@@ -750,6 +750,32 @@ begin\n          raise Unrecoverable_Error;\n       end if;\n \n+      --  Output list of ALI files in closure\n+\n+      if Output_ALI_List then\n+         declare\n+            FD : File_Descriptor;\n+         begin\n+            if ALI_List_Filename /= null then\n+               Set_List_File (ALI_List_Filename.all);\n+            end if;\n+\n+            for Index in ALIs.First .. ALIs.Last loop\n+               declare\n+                  Full_Afile : constant File_Name_Type :=\n+                                 Find_File (ALIs.Table (Index).Afile, Library);\n+               begin\n+                  Write_Name (Full_Afile);\n+                  Write_Eol;\n+               end;\n+            end loop;\n+\n+            if ALI_List_Filename /= null then\n+               Close_List_File;\n+            end if;\n+         end;\n+      end if;\n+\n       --  Build source file table from the ALI files we have read in\n \n       Set_Source_Table;"}, {"sha": "626947b086081e3fc66bc83446bdf1adad57329b", "filename": "gcc/ada/opt.ads", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fopt.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fopt.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fopt.ads?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -951,9 +951,17 @@ package Opt is\n    --  GNATBIND\n    --  True if output of list of linker options is requested (-K switch set)\n \n-   Output_Object_List : Boolean := False;\n+   Output_ALI_List   : Boolean := False;\n+   ALI_List_Filename : String_Ptr;\n    --  GNATBIND\n-   --  True if output of list of objects is requested (-O switch set)\n+   --  True if output of list of ALIs is requested (-A switch set). List is\n+   --  output under the given filename, or standard output if not specified.\n+\n+   Output_Object_List   : Boolean := False;\n+   Object_List_Filename : String_Ptr;\n+   --  GNATBIND\n+   --  True if output of list of objects is requested (-O switch set). List is\n+   --  output under the given filename, or standard output if not specified.\n \n    Overflow_Checks_Unsuppressed : Boolean := False;\n    --  GNAT"}, {"sha": "a3062f42ddbec42b6a23cc3d24e99c2609027f44", "filename": "gcc/ada/osint-b.adb", "status": "modified", "additions": 32, "deletions": 3, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fosint-b.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fosint-b.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fosint-b.adb?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -24,10 +24,13 @@\n ------------------------------------------------------------------------------\n \n with Opt;      use Opt;\n+with Output;   use Output;\n with Targparm; use Targparm;\n \n package body Osint.B is\n \n+   Current_List_File : File_Descriptor := Invalid_FD;\n+\n    -------------------------\n    -- Close_Binder_Output --\n    -------------------------\n@@ -45,6 +48,19 @@ package body Osint.B is\n \n    end Close_Binder_Output;\n \n+   ---------------------\n+   -- Close_List_File --\n+   ---------------------\n+\n+   procedure Close_List_File is\n+   begin\n+      if Current_List_File /= Invalid_FD then\n+         Close (Current_List_File);\n+         Current_List_File := Invalid_FD;\n+         Set_Standard_Output;\n+      end if;\n+   end Close_List_File;\n+\n    --------------------------\n    -- Create_Binder_Output --\n    --------------------------\n@@ -65,8 +81,8 @@ package body Osint.B is\n \n    begin\n       if Output_File_Name /= \"\" then\n-         Name_Buffer (Output_File_Name'Range) := Output_File_Name;\n-         Name_Buffer (Output_File_Name'Last + 1) := ASCII.NUL;\n+         Name_Buffer (1 .. Output_File_Name'Length) := Output_File_Name;\n+         Name_Buffer (Output_File_Name'Length + 1)  := ASCII.NUL;\n \n          if Typ = 's' then\n             Name_Buffer (Output_File_Name'Last) := 's';\n@@ -176,6 +192,19 @@ package body Osint.B is\n       Current_File_Name_Index := To;\n    end Set_Current_File_Name_Index;\n \n+   procedure Set_List_File (Filename : String) is\n+   begin\n+      pragma Assert (Current_List_File = Invalid_FD);\n+      Current_List_File := Create_File (Filename, Text);\n+\n+      if Current_List_File = Invalid_FD then\n+         Fail (\"cannot create list file: \" & Filename);\n+\n+      else\n+         Set_Output (Current_List_File);\n+      end if;\n+   end Set_List_File;\n+\n    -----------------------\n    -- Write_Binder_Info --\n    -----------------------"}, {"sha": "d24ec91ee2192b16f3b940cfbc1c6e1e727320e3", "filename": "gcc/ada/osint-b.ads", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fosint-b.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fosint-b.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fosint-b.ads?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2001-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -44,9 +44,9 @@ package Osint.B is\n    -- Binder Output --\n    -------------------\n \n-   --  These routines are used by the binder to generate the C source file\n-   --  containing the binder output. The format of this file is described\n-   --  in the package Bindfmt.\n+   --  These routines are used by the binder to generate the C or Ada source\n+   --  files containing the binder output. The format of these files is\n+   --  described in package Bindgen.\n \n    procedure Create_Binder_Output\n      (Output_File_Name : String;\n@@ -81,4 +81,16 @@ package Osint.B is\n    procedure Set_Current_File_Name_Index (To : Int);\n    --  Set value of Current_File_Name_Index (in private part of Osint) to To\n \n+   ----------------------------------\n+   -- Other binder-generated files --\n+   ----------------------------------\n+\n+   procedure Set_List_File (Filename : String);\n+   --  Create Filename as a text output file and set it as the current output\n+   --  (see Output.Set_Output).\n+\n+   procedure Close_List_File;\n+   --  If a specific output file was created by Set_List_File, close it and\n+   --  reset the current output file to standard output.\n+\n end Osint.B;"}, {"sha": "8210d3f258fa0b4110645bac50357bf1ee9e2a93", "filename": "gcc/ada/output.adb", "status": "modified", "additions": 16, "deletions": 13, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Foutput.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Foutput.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Foutput.adb?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -29,8 +29,6 @@\n --                                                                          --\n ------------------------------------------------------------------------------\n \n-with System.OS_Lib; use System.OS_Lib;\n-\n package body Output is\n \n    Current_FD : File_Descriptor := Standout;\n@@ -228,17 +226,26 @@ package body Output is\n       Special_Output_Proc := P;\n    end Set_Special_Output;\n \n-   ------------------------\n-   -- Set_Standard_Error --\n-   ------------------------\n+   ----------------\n+   -- Set_Output --\n+   ----------------\n \n-   procedure Set_Standard_Error is\n+   procedure Set_Output (FD : File_Descriptor) is\n    begin\n       if Special_Output_Proc = null then\n          Flush_Buffer;\n       end if;\n \n-      Current_FD := Standerr;\n+      Current_FD := FD;\n+   end Set_Output;\n+\n+   ------------------------\n+   -- Set_Standard_Error --\n+   ------------------------\n+\n+   procedure Set_Standard_Error is\n+   begin\n+      Set_Output (Standerr);\n    end Set_Standard_Error;\n \n    -------------------------\n@@ -247,11 +254,7 @@ package body Output is\n \n    procedure Set_Standard_Output is\n    begin\n-      if Special_Output_Proc = null then\n-         Flush_Buffer;\n-      end if;\n-\n-      Current_FD := Standout;\n+      Set_Output (Standout);\n    end Set_Standard_Output;\n \n    -------"}, {"sha": "d88272c05a6cbfb2d4221b57265402982999b8e5", "filename": "gcc/ada/output.ads", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Foutput.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Foutput.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Foutput.ads?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -33,6 +33,8 @@\n --  writing error messages and informational output. It is also used by the\n --  debug source file output routines (see Sprint.Print_Debug_Line).\n \n+with System.OS_Lib; use System.OS_Lib;\n+\n with Hostparm; use Hostparm;\n with Types;    use Types;\n \n@@ -85,6 +87,12 @@ package Output is\n    --  has been cancelled. Output to standard output is the default mode\n    --  before any call to either of the Set procedures.\n \n+   procedure Set_Output (FD : File_Descriptor);\n+   --  Sets subsequent output to appear on the given file descriptor when no\n+   --  special output is in effect. When a special output is in effect,\n+   --  the output will appear on the given file descriptor only after special\n+   --  output has been cancelled.\n+\n    procedure Indent;\n    --  Increases the current indentation level. Whenever a line is written\n    --  (triggered by Eol), an appropriate amount of whitespace is added to the"}, {"sha": "a75768387591452f2ac7ef46a0f675f2bef583f7", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -1313,7 +1313,7 @@ package body Sem_Res is\n          elsif In_Instance then\n             null;\n \n-         elsif (Op_Name =  Name_Op_Multiply or else Op_Name = Name_Op_Divide)\n+         elsif (Op_Name = Name_Op_Multiply or else Op_Name = Name_Op_Divide)\n            and then Is_Fixed_Point_Type (Etype (Left_Opnd  (Op_Node)))\n            and then Is_Fixed_Point_Type (Etype (Right_Opnd (Op_Node)))\n          then\n@@ -1445,7 +1445,7 @@ package body Sem_Res is\n                null;\n \n             else\n-               Error_Msg_NE (\"expect type&\", N, Typ);\n+               Error_Msg_NE (\"expect type&\", N, First_Subtype (Typ));\n             end if;\n          end if;\n       end if;"}, {"sha": "32140c97cba4a3da804d8793cf1121e9fbb25ed4", "filename": "gcc/ada/switch-b.adb", "status": "modified", "additions": 28, "deletions": 2, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fswitch-b.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fswitch-b.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-b.adb?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -41,10 +41,35 @@ package body Switch.B is\n       Ptr : Integer          := Switch_Chars'First;\n       C   : Character        := ' ';\n \n+      function Get_Optional_Filename return String_Ptr;\n+      --  If current character is '=', return a newly allocated string\n+      --  containing the remainder of the current switch (after the '='), else\n+      --  return null.\n+\n       function Get_Stack_Size (S : Character) return Int;\n       --  Used for -d and -D to scan stack size including handling k/m.\n       --  S is set to 'd' or 'D' to indicate the switch being scanned.\n \n+      ---------------------------\n+      -- Get_Optional_Filename --\n+      ---------------------------\n+\n+      function Get_Optional_Filename return String_Ptr is\n+         Result : String_Ptr;\n+      begin\n+         if Ptr <= Max and then Switch_Chars (Ptr) = '=' then\n+            if Ptr = Max then\n+               Bad_Switch (Switch_Chars);\n+            else\n+               Result := new String'(Switch_Chars (Ptr + 1 .. Max));\n+               Ptr := Max + 1;\n+               return Result;\n+            end if;\n+         else\n+            return null;\n+         end if;\n+      end Get_Optional_Filename;\n+\n       --------------------\n       -- Get_Stack_Size --\n       --------------------\n@@ -125,7 +150,8 @@ package body Switch.B is\n \n          when 'A' =>\n             Ptr := Ptr + 1;\n-            Ada_Bind_File := True;\n+            Output_ALI_List := True;\n+            ALI_List_Filename := Get_Optional_Filename;\n \n          --  Processing for b switch\n \n@@ -144,7 +170,6 @@ package body Switch.B is\n \n          when 'C' =>\n             Ptr := Ptr + 1;\n-\n             Ada_Bind_File := False;\n \n             Write_Line (\"warning: gnatbind switch -C is obsolescent\");\n@@ -318,6 +343,7 @@ package body Switch.B is\n          when 'O' =>\n             Ptr := Ptr + 1;\n             Output_Object_List := True;\n+            Object_List_Filename := Get_Optional_Filename;\n \n          --  Processing for p switch\n "}, {"sha": "ed2f8ad4fd97a5e729681ae9c5b6bcd9a6fe40f6", "filename": "gcc/ada/vms_data.ads", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fvms_data.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/125778158bac64ccea58a2156c743fa607545429/gcc%2Fada%2Fvms_data.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fvms_data.ads?ref=125778158bac64ccea58a2156c743fa607545429", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1996-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1996-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -196,6 +196,14 @@ package VMS_Data is\n    --\n    --   Add directories to the project search path.\n \n+   S_Bind_ALI     : aliased constant S := \"/ALI_LIST \"                     &\n+                                            \"-A\";\n+   --        /NOALI_LIST (D)\n+   --        /ALI_LIST\n+   --\n+   --    Output full names of all the ALI files in the partition. The output is\n+   --    written to SYS$OUTPUT.\n+\n    S_Bind_Bind    : aliased constant S := \"/BIND_FILE=\"                    &\n                                             \"ADA \"                         &\n                                                \"-A \"                       &\n@@ -385,7 +393,7 @@ package VMS_Data is\n    --        /NOOBJECT_LIST (D)\n    --        /OBJECT_LIST\n    --\n-   --    Output full names of all the object files that must be linker to\n+   --    Output full names of all the object files that must be linked to\n    --    provide the Ada component of the program. The output is written to\n    --    SYS$OUTPUT.\n \n@@ -669,6 +677,7 @@ package VMS_Data is\n \n    Bind_Switches : aliased constant Switches :=\n                      (S_Bind_Add     'Access,\n+                      S_Bind_ALI     'Access,\n                       S_Bind_Bind    'Access,\n                       S_Bind_Build   'Access,\n                       S_Bind_Current 'Access,"}]}