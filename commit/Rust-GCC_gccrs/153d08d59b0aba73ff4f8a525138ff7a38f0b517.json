{"sha": "153d08d59b0aba73ff4f8a525138ff7a38f0b517", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTUzZDA4ZDU5YjBhYmE3M2ZmNGY4YTUyNTEzOGZmN2EzOGYwYjUxNw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2006-05-26T15:41:46Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2006-05-26T15:41:46Z"}, "message": "expr.c (java_push_constant_from_pool): Handle 'ldc class'.\n\n\t* expr.c (java_push_constant_from_pool): Handle 'ldc class'.\n\t* verify-glue.c (vfy_class_type): New function.\n\t* verify-impl.c (check_constant): Allow 'ldc class'.\n\t* verify.h (vfy_class_type): Declare.\n\nFrom-SVN: r114135", "tree": {"sha": "88690a510261c7f1c3fc40c4ca51027140d15d66", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/88690a510261c7f1c3fc40c4ca51027140d15d66"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/153d08d59b0aba73ff4f8a525138ff7a38f0b517", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/153d08d59b0aba73ff4f8a525138ff7a38f0b517", "html_url": "https://github.com/Rust-GCC/gccrs/commit/153d08d59b0aba73ff4f8a525138ff7a38f0b517", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/153d08d59b0aba73ff4f8a525138ff7a38f0b517/comments", "author": null, "committer": null, "parents": [{"sha": "7541c31ba2afb0b9e5c7893117d8f63a1a7b0e41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7541c31ba2afb0b9e5c7893117d8f63a1a7b0e41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7541c31ba2afb0b9e5c7893117d8f63a1a7b0e41"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "edcde22c8e1e713f4ae0a7c328ea95e027c0ce6d", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=153d08d59b0aba73ff4f8a525138ff7a38f0b517", "patch": "@@ -1,3 +1,10 @@\n+2006-05-26  Tom Tromey  <tromey@redhat.com>\n+\n+\t* expr.c (java_push_constant_from_pool): Handle 'ldc class'.\n+\t* verify-glue.c (vfy_class_type): New function.\n+\t* verify-impl.c (check_constant): Allow 'ldc class'.\n+\t* verify.h (vfy_class_type): Declare.\n+\n 2006-05-25  Andrew Haley  <aph@redhat.com>\n \n \tPR java/27756"}, {"sha": "94f76fdd8c1dead3def9c14d6af058320fb0b7c4", "filename": "gcc/java/expr.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fexpr.c?ref=153d08d59b0aba73ff4f8a525138ff7a38f0b517", "patch": "@@ -3117,6 +3117,12 @@ java_push_constant_from_pool (JCF *jcf, int index)\n       c = build_ref_from_constant_pool (index);\n       c = convert (promote_type (string_type_node), c);\n     }\n+  else if (JPOOL_TAG (jcf, index) == CONSTANT_Class\n+\t   || JPOOL_TAG (jcf, index) == CONSTANT_ResolvedClass)\n+    {\n+      tree record = get_class_constant (jcf, index);\n+      c = build_class_ref (record);\n+    }\n   else\n     c = get_constant (jcf, index);\n   push_value (c);"}, {"sha": "23fcaba3d4045965d96da8783d54d07cc2afc51d", "filename": "gcc/java/verify-glue.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fverify-glue.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fverify-glue.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fverify-glue.c?ref=153d08d59b0aba73ff4f8a525138ff7a38f0b517", "patch": "@@ -1,5 +1,5 @@\n /* Glue to interface gcj with bytecode verifier.\n-   Copyright (C) 2003, 2004, 2005 Free Software Foundation, Inc.\n+   Copyright (C) 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -328,6 +328,12 @@ vfy_object_type (void)\n   return k;\n }\n \n+vfy_jclass\n+vfy_class_type (void)\n+{\n+  return class_type_node;\n+}\n+\n vfy_jclass\n vfy_string_type (void)\n {"}, {"sha": "886dfe7d66c257b8224b84a1147f318fc28e197b", "filename": "gcc/java/verify-impl.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fverify-impl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fverify-impl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fverify-impl.c?ref=153d08d59b0aba73ff4f8a525138ff7a38f0b517", "patch": "@@ -1975,6 +1975,10 @@ check_constant (int index)\n     init_type_from_tag (&t, int_type);\n   else if (vfy_tag (pool, index) == JV_CONSTANT_Float)\n     init_type_from_tag (&t, float_type);\n+  else if (vfy_tag (pool, index) == JV_CONSTANT_Class\n+\t   || vfy_tag (pool, index) == JV_CONSTANT_ResolvedClass)\n+    /* FIXME: should only allow this for 1.5 bytecode.  */\n+    init_type_from_class (&t, vfy_class_type ());\n   else\n     verify_fail_pc (\"String, int, or float constant expected\", vfr->start_PC);\n   return t;"}, {"sha": "b85176ea85dbf2471d80c3c204d89de52fdef1cc", "filename": "gcc/java/verify.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fverify.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/153d08d59b0aba73ff4f8a525138ff7a38f0b517/gcc%2Fjava%2Fverify.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fverify.h?ref=153d08d59b0aba73ff4f8a525138ff7a38f0b517", "patch": "@@ -1,5 +1,5 @@\n /* Declarations to interface gcj with bytecode verifier.\n-   Copyright (C) 2003, 2004, 2005 Free Software Foundation, Inc.\n+   Copyright (C) 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -112,6 +112,7 @@ vfy_jclass vfy_get_component_type (vfy_jclass klass);\n bool vfy_is_abstract (vfy_jclass klass);\n vfy_jclass vfy_find_class (vfy_jclass klass, vfy_string name);\n vfy_jclass vfy_object_type (void);\n+vfy_jclass vfy_class_type (void);\n vfy_jclass vfy_string_type (void);\n vfy_jclass vfy_throwable_type (void);\n vfy_jclass vfy_unsuitable_type (void);"}]}