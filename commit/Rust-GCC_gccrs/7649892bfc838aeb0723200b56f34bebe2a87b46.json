{"sha": "7649892bfc838aeb0723200b56f34bebe2a87b46", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzY0OTg5MmJmYzgzOGFlYjA3MjMyMDBiNTZmMzRiZWJlMmE4N2I0Ng==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@adacore.com", "date": "2020-09-15T12:56:31Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2020-10-26T08:59:05Z"}, "message": "[Ada] Suppress warnings on unreferenced parameters of dispatching ops\n\ngcc/ada/\n\n\t* sem_warn.adb (Warn_On_Unreferenced_Entity): Suppress warning\n\ton formal parameters of all dispatching operations.\n\ngcc/testsuite/\n\n\t* gnat.dg/warn14.adb: Update expectations.", "tree": {"sha": "dd21e3a106e126d28173c0a1d2dff25fcd974ffd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dd21e3a106e126d28173c0a1d2dff25fcd974ffd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7649892bfc838aeb0723200b56f34bebe2a87b46", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7649892bfc838aeb0723200b56f34bebe2a87b46", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7649892bfc838aeb0723200b56f34bebe2a87b46", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7649892bfc838aeb0723200b56f34bebe2a87b46/comments", "author": {"login": "ArnaudCharlet", "id": 30291825, "node_id": "MDQ6VXNlcjMwMjkxODI1", "avatar_url": "https://avatars.githubusercontent.com/u/30291825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArnaudCharlet", "html_url": "https://github.com/ArnaudCharlet", "followers_url": "https://api.github.com/users/ArnaudCharlet/followers", "following_url": "https://api.github.com/users/ArnaudCharlet/following{/other_user}", "gists_url": "https://api.github.com/users/ArnaudCharlet/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArnaudCharlet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArnaudCharlet/subscriptions", "organizations_url": "https://api.github.com/users/ArnaudCharlet/orgs", "repos_url": "https://api.github.com/users/ArnaudCharlet/repos", "events_url": "https://api.github.com/users/ArnaudCharlet/events{/privacy}", "received_events_url": "https://api.github.com/users/ArnaudCharlet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f69ecf3bbad025688ec79e0090665774f254b761", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f69ecf3bbad025688ec79e0090665774f254b761", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f69ecf3bbad025688ec79e0090665774f254b761"}], "stats": {"total": 31, "additions": 19, "deletions": 12}, "files": [{"sha": "7289ea78e4594bc63eeb615b349a1280bd035d1a", "filename": "gcc/ada/sem_warn.adb", "status": "modified", "additions": 18, "deletions": 11, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7649892bfc838aeb0723200b56f34bebe2a87b46/gcc%2Fada%2Fsem_warn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7649892bfc838aeb0723200b56f34bebe2a87b46/gcc%2Fada%2Fsem_warn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_warn.adb?ref=7649892bfc838aeb0723200b56f34bebe2a87b46", "patch": "@@ -4421,23 +4421,30 @@ package body Sem_Warn is\n                      end if;\n \n                      declare\n-                        B : constant Node_Id := Parent (Parent (Scope (E)));\n-                        S : Entity_Id := Empty;\n+                        S : Node_Id := Scope (E);\n                      begin\n-                        if Nkind (B) in\n-                             N_Expression_Function |\n-                             N_Subprogram_Body     |\n-                             N_Subprogram_Renaming_Declaration\n-                        then\n-                           S := Corresponding_Spec (B);\n+                        if Ekind (S) = E_Subprogram_Body then\n+                           S := Parent (S);\n+\n+                           while Nkind (S) not in\n+                             N_Expression_Function             |\n+                             N_Subprogram_Body                 |\n+                             N_Subprogram_Renaming_Declaration |\n+                             N_Empty\n+                           loop\n+                              S := Parent (S);\n+                           end loop;\n+\n+                           if Present (S) then\n+                              S := Corresponding_Spec (S);\n+                           end if;\n                         end if;\n \n                         --  Do not warn for dispatching operations, because\n                         --  that causes too much noise. Also do not warn for\n-                        --  trivial subprograms.\n+                        --  trivial subprograms (e.g. stubs).\n \n-                        if (not Present (S)\n-                            or else not Is_Dispatching_Operation (S))\n+                        if (No (S) or else not Is_Dispatching_Operation (S))\n                           and then not Is_Trivial_Subprogram (Scope (E))\n                         then\n                            Error_Msg_NE -- CODEFIX"}, {"sha": "f9d03d1fb04b56afec847b51bf178ae535e9d35d", "filename": "gcc/testsuite/gnat.dg/warn14.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7649892bfc838aeb0723200b56f34bebe2a87b46/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn14.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7649892bfc838aeb0723200b56f34bebe2a87b46/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn14.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn14.adb?ref=7649892bfc838aeb0723200b56f34bebe2a87b46", "patch": "@@ -23,7 +23,7 @@ procedure Warn14 is\n   package YY is\n     type XX is tagged null record;\n \n-    function F4 (Y : XX; U : Boolean) return Natural is (1); --  { dg-warning \"formal parameter \\\"U\\\" is not referenced\" }\n+    function F4 (Y : XX; U : Boolean) return Natural is (1);\n   end YY;\n \n   XXX : YY.XX;"}]}