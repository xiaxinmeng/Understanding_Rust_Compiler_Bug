{"sha": "611b1df48abe697566b141bf52ab35818332e75a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjExYjFkZjQ4YWJlNjk3NTY2YjE0MWJmNTJhYjM1ODE4MzMyZTc1YQ==", "commit": {"author": {"name": "Kaveh R. Ghazi", "email": "ghazi@teal.rutgers.edu", "date": "2000-12-04T01:07:47Z"}, "committer": {"name": "Kaveh Ghazi", "email": "ghazi@gcc.gnu.org", "date": "2000-12-04T01:07:47Z"}, "message": "builtins.c (expand_builtin_strspn, [...]): Handle another transformation.\n\n\t* builtins.c (expand_builtin_strspn, expand_builtin_strcspn):\n\tHandle another transformation.\n\ntestsuite:\n\t* gcc.c-torture/execute/string-opt-11.c: Add more strspn checks.\n\t* gcc.c-torture/execute/string-opt-12.c: Add more strcspn checks.\n\nFrom-SVN: r37986", "tree": {"sha": "a0367c1abc81e13e90391c1db721b347f739984f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a0367c1abc81e13e90391c1db721b347f739984f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/611b1df48abe697566b141bf52ab35818332e75a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/611b1df48abe697566b141bf52ab35818332e75a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/611b1df48abe697566b141bf52ab35818332e75a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/611b1df48abe697566b141bf52ab35818332e75a/comments", "author": null, "committer": null, "parents": [{"sha": "55deb0468d6e165470261c04aa299e7df01e73cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55deb0468d6e165470261c04aa299e7df01e73cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55deb0468d6e165470261c04aa299e7df01e73cc"}], "stats": {"total": 48, "additions": 45, "deletions": 3}, "files": [{"sha": "d38d2d9f03c6d98eb5ec6bba1c488fff0a68609e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/611b1df48abe697566b141bf52ab35818332e75a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/611b1df48abe697566b141bf52ab35818332e75a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=611b1df48abe697566b141bf52ab35818332e75a", "patch": "@@ -1,3 +1,8 @@\n+2000-12-03  Kaveh R. Ghazi  <ghazi@teal.rutgers.edu>\n+\n+\t* builtins.c (expand_builtin_strspn, expand_builtin_strcspn):\n+\tHandle another transformation.\n+\n 2000-12-03  Nick Clifton  <nickc@redhat.com>\n \n \t* config.gcc: Add support for StrongARM targets."}, {"sha": "d6fa5bb1f0b1ec6c4105c4faa9088c84276fff2a", "filename": "gcc/builtins.c", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=611b1df48abe697566b141bf52ab35818332e75a", "patch": "@@ -2594,12 +2594,13 @@ expand_builtin_strspn (arglist, target, mode)\n \t  return expand_expr (size_int (r), target, mode, EXPAND_NORMAL);\n \t}\n       \n-      /* If the second argument is \"\", return 0.  */\n-      if (p2 && *p2 == '\\0')\n+      /* If either argument is \"\", return 0.  */\n+      if ((p1 && *p1 == '\\0') || (p2 && *p2 == '\\0'))\n         {\n-\t  /* Evaluate and ignore argument s1 in case it has\n+\t  /* Evaluate and ignore both arguments in case either one has\n \t     side-effects.  */\n \t  expand_expr (s1, const0_rtx, VOIDmode, EXPAND_NORMAL);\n+\t  expand_expr (s2, const0_rtx, VOIDmode, EXPAND_NORMAL);\n \t  return const0_rtx;\n \t}\n       return 0;\n@@ -2638,6 +2639,15 @@ expand_builtin_strcspn (arglist, target, mode)\n \t  return expand_expr (size_int (r), target, mode, EXPAND_NORMAL);\n \t}\n       \n+      /* If the first argument is \"\", return 0.  */\n+      if (p1 && *p1 == '\\0')\n+        {\n+\t  /* Evaluate and ignore argument s2 in case it has\n+\t     side-effects.  */\n+\t  expand_expr (s2, const0_rtx, VOIDmode, EXPAND_NORMAL);\n+\t  return const0_rtx;\n+\t}\n+\n       /* If the second argument is \"\", return __builtin_strlen(s1).  */\n       if (p2 && *p2 == '\\0')\n         {"}, {"sha": "4ec9d5a3f37305b9c5d7760605a50699bd7a37c1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=611b1df48abe697566b141bf52ab35818332e75a", "patch": "@@ -1,3 +1,8 @@\n+2000-12-03  Kaveh R. Ghazi  <ghazi@teal.rutgers.edu>\n+\n+\t* gcc.c-torture/execute/string-opt-11.c: Add more strspn checks.\n+\t* gcc.c-torture/execute/string-opt-12.c: Add more strcspn checks.\n+\n 2000-12-03  Joseph S. Myers  <jsm28@cam.ac.uk>\n \n \t* gcc.c-torture/execute/20001203-1.c: New test."}, {"sha": "b17e4c1027f1896d8292f698dc50cbb387dc1233", "filename": "gcc/testsuite/gcc.c-torture/execute/string-opt-11.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fstring-opt-11.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fstring-opt-11.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fstring-opt-11.c?ref=611b1df48abe697566b141bf52ab35818332e75a", "patch": "@@ -34,6 +34,17 @@ int main ()\n   strcpy (dst, s1); d2 = dst;\n   if (strspn (++d2+5, \"\") != 0 || d2 != dst+1)\n     abort();\n+  if (strspn (\"\", s1) != 0)\n+    abort();\n+  strcpy (dst, s1);\n+  if (strspn (\"\", dst) != 0)\n+    abort();\n+  strcpy (dst, s1); d2 = dst;\n+  if (strspn (\"\", ++d2) != 0 || d2 != dst+1)\n+    abort();\n+  strcpy (dst, s1); d2 = dst;\n+  if (strspn (\"\", ++d2+5) != 0 || d2 != dst+1)\n+    abort();\n \n   return 0;\n }"}, {"sha": "ebe47e5b0e3a72c811eb0e69d49ab514bd05d418", "filename": "gcc/testsuite/gcc.c-torture/execute/string-opt-12.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fstring-opt-12.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/611b1df48abe697566b141bf52ab35818332e75a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fstring-opt-12.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fstring-opt-12.c?ref=611b1df48abe697566b141bf52ab35818332e75a", "patch": "@@ -34,6 +34,17 @@ int main ()\n   strcpy (dst, s1); d2 = dst;\n   if (strcspn (++d2+5, \"\") != 5 || d2 != dst+1)\n     abort();\n+  if (strcspn (\"\", s1) != 0)\n+    abort();\n+  strcpy (dst, s1);\n+  if (strcspn (\"\", dst) != 0)\n+    abort();\n+  strcpy (dst, s1); d2 = dst;\n+  if (strcspn (\"\", ++d2) != 0 || d2 != dst+1)\n+    abort();\n+  strcpy (dst, s1); d2 = dst;\n+  if (strcspn (\"\", ++d2+5) != 0 || d2 != dst+1)\n+    abort();\n \n   return 0;\n }"}]}