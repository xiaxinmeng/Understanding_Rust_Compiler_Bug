{"sha": "806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODA2YWE5MDE0YjhjZTVjM2Q4OTZmZjhjZGU2ZWY1MDIxYmQ3MzA0Mw==", "commit": {"author": {"name": "Kazu Hirata", "email": "kazu@cs.umass.edu", "date": "2005-05-02T18:36:24Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2005-05-02T18:36:24Z"}, "message": "class.c (local_classes, [...]): Use VEC instead of VARRAY.\n\n\t* class.c (local_classes, init_class_processing): Use VEC\n\tinstead of VARRAY.\n\t* cp-tree.h (local_classes): Likewise.\n\t* mangle.c (discriminator_for_local_entity): Likewise.\n\t* name-lookup.c (pushtag): Likewise.\n\nFrom-SVN: r99115", "tree": {"sha": "fe84fa00e06e1b8c8289fa2592d1384c032ce778", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fe84fa00e06e1b8c8289fa2592d1384c032ce778"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "html_url": "https://github.com/Rust-GCC/gccrs/commit/806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/comments", "author": null, "committer": null, "parents": [{"sha": "a6e4d85b506e3424a02c752661b47e35efe1ee05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6e4d85b506e3424a02c752661b47e35efe1ee05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a6e4d85b506e3424a02c752661b47e35efe1ee05"}], "stats": {"total": 18, "additions": 13, "deletions": 5}, "files": [{"sha": "b0f06967db243c449051d4bb90e6a9409b0f6587", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "patch": "@@ -1,3 +1,11 @@\n+2005-05-02  Kazu Hirata  <kazu@cs.umass.edu>\n+\n+\t* class.c (local_classes, init_class_processing): Use VEC\n+\tinstead of VARRAY.\n+\t* cp-tree.h (local_classes): Likewise.\n+\t* mangle.c (discriminator_for_local_entity): Likewise.\n+\t* name-lookup.c (pushtag): Likewise.\n+\n 2005-05-02  Paolo Bonzini  <bonzini@gnu.org>\n \n         * semantics.c (finish_call_expr): Call resolve_overloaded_builtin"}, {"sha": "89ae74ff91cf16886ccef7ffb238db9e9b7b4ff3", "filename": "gcc/cp/class.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "patch": "@@ -104,7 +104,7 @@ static class_stack_node_t current_class_stack;\n \n /* An array of all local classes present in this translation unit, in\n    declaration order.  */\n-varray_type local_classes;\n+VEC(tree,gc) *local_classes;\n \n static tree get_vfield_name (tree);\n static void finish_struct_anon (tree);\n@@ -5324,7 +5324,7 @@ init_class_processing (void)\n   current_class_stack_size = 10;\n   current_class_stack \n     = xmalloc (current_class_stack_size * sizeof (struct class_stack_node));\n-  VARRAY_TREE_INIT (local_classes, 8, \"local_classes\");\n+  local_classes = VEC_alloc (tree, gc, 8);\n \n   ridpointers[(int) RID_PUBLIC] = access_public_node;\n   ridpointers[(int) RID_PRIVATE] = access_private_node;"}, {"sha": "53f19f27c9a36828499af2ad99a6ec5dcc3cd75f", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "patch": "@@ -3132,7 +3132,7 @@ extern int current_class_depth;\n \n /* An array of all local classes present in this translation unit, in\n    declaration order.  */\n-extern GTY(()) varray_type local_classes;\n+extern GTY(()) VEC(tree,gc) *local_classes;\n \f\n /* Here's where we control how name mangling takes place.  */\n "}, {"sha": "15a42b1a897327e90084292858d93a7657810e86", "filename": "gcc/cp/mangle.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fmangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fmangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmangle.c?ref=806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "patch": "@@ -1436,7 +1436,7 @@ discriminator_for_local_entity (tree entity)\n     {\n       /* Scan the list of local classes.  */\n       entity = TREE_TYPE (entity);\n-      for (type = &VARRAY_TREE (local_classes, 0); *type != entity; ++type)\n+      for (type = VEC_address (tree, local_classes); *type != entity; ++type)\n         if (TYPE_IDENTIFIER (*type) == TYPE_IDENTIFIER (entity)\n             && TYPE_CONTEXT (*type) == TYPE_CONTEXT (entity))\n \t  ++discriminator;"}, {"sha": "67288d7c27780c5321a8422c4fff560c312d334d", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/806aa9014b8ce5c3d896ff8cde6ef5021bd73043/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=806aa9014b8ce5c3d896ff8cde6ef5021bd73043", "patch": "@@ -4701,7 +4701,7 @@ pushtag (tree name, tree type, tag_scope scope)\n \t  if (TYPE_CONTEXT (type)\n \t      && TREE_CODE (TYPE_CONTEXT (type)) == FUNCTION_DECL\n \t      && !processing_template_decl)\n-\t    VARRAY_PUSH_TREE (local_classes, type);\n+\t    VEC_safe_push (tree, gc, local_classes, type);\n         }\n       if (b->kind == sk_class\n \t  && !COMPLETE_TYPE_P (current_class_type))"}]}