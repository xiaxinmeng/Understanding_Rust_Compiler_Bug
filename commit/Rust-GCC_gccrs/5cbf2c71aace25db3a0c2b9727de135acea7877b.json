{"sha": "5cbf2c71aace25db3a0c2b9727de135acea7877b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWNiZjJjNzFhYWNlMjVkYjNhMGMyYjk3MjdkZTEzNWFjZWE3ODc3Yg==", "commit": {"author": {"name": "Cesar Philippidis", "email": "cesar@codesourcery.com", "date": "2014-03-14T09:33:15Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2014-03-14T09:33:15Z"}, "message": "save-temps_0.c: New file.\n\n2014-03-14  Cesar Philippidis  <cesar@codesourcery.com>\n\n\tgcc/testsuite/\n\t* gcc.dg/lto/save-temps_0.c: New file.\n\t* lib/gcc-dg.exp (cleanup-saved-temps): Handle LTO temporaries.\n\t* lib/lto.exp (lto-execute): Cleanup LTO temporaries.\n\nFrom-SVN: r208563", "tree": {"sha": "ee9869dc6ff3a56d9650f8efe841a3313c475843", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee9869dc6ff3a56d9650f8efe841a3313c475843"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5cbf2c71aace25db3a0c2b9727de135acea7877b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5cbf2c71aace25db3a0c2b9727de135acea7877b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5cbf2c71aace25db3a0c2b9727de135acea7877b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5cbf2c71aace25db3a0c2b9727de135acea7877b/comments", "author": {"login": "cesarjp", "id": 4576177, "node_id": "MDQ6VXNlcjQ1NzYxNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/4576177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cesarjp", "html_url": "https://github.com/cesarjp", "followers_url": "https://api.github.com/users/cesarjp/followers", "following_url": "https://api.github.com/users/cesarjp/following{/other_user}", "gists_url": "https://api.github.com/users/cesarjp/gists{/gist_id}", "starred_url": "https://api.github.com/users/cesarjp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cesarjp/subscriptions", "organizations_url": "https://api.github.com/users/cesarjp/orgs", "repos_url": "https://api.github.com/users/cesarjp/repos", "events_url": "https://api.github.com/users/cesarjp/events{/privacy}", "received_events_url": "https://api.github.com/users/cesarjp/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2832dc2203a311e070b3fa962d8536e5031a53b4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2832dc2203a311e070b3fa962d8536e5031a53b4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2832dc2203a311e070b3fa962d8536e5031a53b4"}], "stats": {"total": 41, "additions": 39, "deletions": 2}, "files": [{"sha": "0268eb697106d14c7d6c4477eb3a2defe3152fa9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5cbf2c71aace25db3a0c2b9727de135acea7877b", "patch": "@@ -1,3 +1,9 @@\n+2014-03-14  Cesar Philippidis  <cesar@codesourcery.com>\n+\n+\t* lib/gcc-dg.exp (cleanup-saved-temps): Handle LTO temporaries.\n+\t* lib/lto.exp (lto-execute): Cleanup LTO temporaries.\n+\t* gcc.dg/lto/save-temps_0.c: New testcase.\n+\n 2014-03-13  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/36282"}, {"sha": "8af1619581c01a88fbf040d59642c8cb690da937", "filename": "gcc/testsuite/gcc.dg/lto/save-temps_0.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fsave-temps_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fsave-temps_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fsave-temps_0.c?ref=5cbf2c71aace25db3a0c2b9727de135acea7877b", "patch": "@@ -0,0 +1,9 @@\n+/* { dg-lto-options {{ -O -flto -save-temps}} } */\n+/* { dg-lto-do link } */\n+\n+int\n+main (void)\n+{\n+  return 0;\n+}\n+"}, {"sha": "59d394c340902ae8b99d2729aa4b4b930e510466", "filename": "gcc/testsuite/lib/gcc-dg.exp", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp?ref=5cbf2c71aace25db3a0c2b9727de135acea7877b", "patch": "@@ -600,7 +600,7 @@ proc cleanup-saved-temps { args } {\n     set suffixes {}\n \n     # add the to-be-kept suffixes\n-    foreach suffix {\".mii\" \".ii\" \".i\" \".s\" \".o\" \".gkd\"} {\n+    foreach suffix {\".mii\" \".ii\" \".i\" \".s\" \".o\" \".gkd\" \".res\" \".ltrans.out\"} {\n \tif {[lsearch $args $suffix] < 0} {\n \t    lappend suffixes $suffix\n \t}\n@@ -611,6 +611,8 @@ proc cleanup-saved-temps { args } {\n     set testcase [lindex $testcase 0]\n     foreach suffix $suffixes {\n \tremove-build-file \"[file rootname [file tail $testcase]]$suffix\"\n+\tremove-build-file \"[file rootname [file tail $testcase]].exe$suffix\"\n+\tremove-build-file \"[file rootname [file tail $testcase]].exe.ltrans\\[0-9\\]*$suffix\"\n \t# -fcompare-debug dumps\n \tremove-build-file \"[file rootname [file tail $testcase]].gk$suffix\"\n     }\n@@ -620,6 +622,9 @@ proc cleanup-saved-temps { args } {\n \tforeach srcfile $additional_sources {\n \t    foreach suffix $suffixes {\n \t\tremove-build-file \"[file rootname [file tail $srcfile]]$suffix\"\n+\t\tremove-build-file \"[file rootname [file tail $srcfile]].exe$suffix\"\n+\t\tremove-build-file \"[file rootname [file tail $srcfile]].exe.ltrans\\[0-9\\]*$suffix\"\n+\n \t\t# -fcompare-debug dumps\n \t\tremove-build-file \"[file rootname [file tail $srcfile]].gk$suffix\"\n \t    }"}, {"sha": "997d5a38d109b65129ae0eb9bccacd3cb1b6c54e", "filename": "gcc/testsuite/lib/lto.exp", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2Flib%2Flto.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5cbf2c71aace25db3a0c2b9727de135acea7877b/gcc%2Ftestsuite%2Flib%2Flto.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Flto.exp?ref=5cbf2c71aace25db3a0c2b9727de135acea7877b", "patch": "@@ -413,7 +413,8 @@ proc lto-execute { src1 sid } {\n     global dg-suppress-ld-options\n     global LTO_OPTIONS\n     global dg-final-code\n-\n+    global testname_with_flags\n+    \n     # Get extra flags for this test from the primary source file, and\n     # process other dg-* options that this suite supports.  Warn about\n     # unsupported flags.\n@@ -577,6 +578,22 @@ proc lto-execute { src1 sid } {\n \t    }\n \t}\n \n+\t# Clean up after -save-temps.  The LTO tests don't use dg-test, so\n+\t# testname-for-summary needs to be defined explicitly for each\n+\t# file that needs to be removed.\n+\tset testname_with_flags $execname\n+\n+\teval \"cleanup-saved-temps\"\n+\n+\tfor {set i 0} {$i < $num_srcs} {incr i} {\n+\t    set testname_with_flags \"${base}_${i}\"\n+\t    eval \"cleanup-saved-temps\"\n+\t    set testname_with_flags \"${sid}_${base}_${i}\"\n+\t    eval \"cleanup-saved-temps\"\n+\t}\n+\t\n+\tunset testname_with_flags\n+\t\n \tif { ![string compare \"run\" $compile_type] \\\n \t     || ![string compare \"link\" $compile_type] } {\n \t    file_on_host delete $execname"}]}