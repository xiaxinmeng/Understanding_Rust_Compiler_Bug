{"sha": "6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmM1ZWQzZjE4Y2UzMWU3MWRjMTA4OWU4Mjk4YzcwZmQyYTBhMDhjMg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2015-01-21T21:51:43Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2015-01-21T21:51:43Z"}, "message": "re PR rtl-optimization/62078 (ICE: verify_flow_info failed: missing REG_EH_REGION note at the end of bb 2 with -fdelete-dead-exceptions)\n\n\tPR rtl-optimization/62078\n\t* dse.c: Include cfgcleanup.h.\n\t(rest_of_handle_dse): For -fnon-call-exceptions, if DSE removed\n\tanything call purge_all_dead_edges and cleanup_cfg at the end\n\tof the pass.\n\n\t* g++.dg/opt/pr62078.C: New test.\n\nFrom-SVN: r219970", "tree": {"sha": "12c988528c2bd3478ee358c3b7dbeff55a67e4da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/12c988528c2bd3478ee358c3b7dbeff55a67e4da"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "31be63ab8c4def775c9ece0b6fa8d0fedc11bae4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31be63ab8c4def775c9ece0b6fa8d0fedc11bae4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31be63ab8c4def775c9ece0b6fa8d0fedc11bae4"}], "stats": {"total": 56, "additions": 56, "deletions": 0}, "files": [{"sha": "af86a4d79939d5aca830b435462e9daa9cfef73e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "patch": "@@ -1,3 +1,11 @@\n+2015-01-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/62078\n+\t* dse.c: Include cfgcleanup.h.\n+\t(rest_of_handle_dse): For -fnon-call-exceptions, if DSE removed\n+\tanything call purge_all_dead_edges and cleanup_cfg at the end\n+\tof the pass.\n+\n 2015-01-21  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* ipa-utils.c (ipa_merge_profiles): Avoid ICE on mismatch in indirect"}, {"sha": "ea6f24585c532abe24944f75023d4f7ac975275e", "filename": "gcc/dse.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2Fdse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2Fdse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdse.c?ref=6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "patch": "@@ -81,6 +81,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"gimple.h\"\n #include \"gimple-ssa.h\"\n #include \"rtl-iter.h\"\n+#include \"cfgcleanup.h\"\n \n /* This file contains three techniques for performing Dead Store\n    Elimination (dse).\n@@ -3746,6 +3747,14 @@ rest_of_handle_dse (void)\n   if (dump_file)\n     fprintf (dump_file, \"dse: local deletions = %d, global deletions = %d, spill deletions = %d\\n\",\n \t     locally_deleted, globally_deleted, spill_deleted);\n+\n+  /* DSE can eliminate potentially-trapping MEMs.\n+     Remove any EH edges associated with them.  */\n+  if ((locally_deleted || globally_deleted)\n+      && cfun->can_throw_non_call_exceptions\n+      && purge_all_dead_edges ())\n+    cleanup_cfg (0);\n+\n   return 0;\n }\n "}, {"sha": "057f0ca297d294b924e18e67ce740ab850116d5e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "patch": "@@ -1,5 +1,8 @@\n 2015-01-21  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR rtl-optimization/62078\n+\t* g++.dg/opt/pr62078.C: New test.\n+\n \tPR c/63307\n \t* c-c++-common/cilk-plus/CK/pr63307.c: New test.\n "}, {"sha": "8730432d3b39090863f76f27b9b067b65a3b1362", "filename": "gcc/testsuite/g++.dg/opt/pr62078.C", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr62078.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr62078.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr62078.C?ref=6c5ed3f18ce31e71dc1089e8298c70fd2a0a08c2", "patch": "@@ -0,0 +1,36 @@\n+/* PR rtl-optimization/62078 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Og -fdelete-dead-exceptions -fnon-call-exceptions\" } */\n+\n+struct A { virtual ~A (); };\n+struct B : A {};\n+struct C : B {};\n+struct D : C {};\n+struct E : D {};\n+struct F : E {};\n+struct G : F {};\n+struct H : G {};\n+struct I : H {};\n+struct J : I {};\n+struct K : J {};\n+struct L : K {};\n+struct M : L {};\n+struct N : M {};\n+struct O : N {};\n+struct P : O {};\n+struct Q : P {};\n+struct R : Q {};\n+struct S : R {};\n+struct T : S {};\n+struct U : T {};\n+struct V : U {};\n+struct W : V {};\n+struct X : W {};\n+struct Y : X {};\n+struct Z : Y {};\n+\n+void\n+foo ()\n+{\n+  Z z;\n+}"}]}