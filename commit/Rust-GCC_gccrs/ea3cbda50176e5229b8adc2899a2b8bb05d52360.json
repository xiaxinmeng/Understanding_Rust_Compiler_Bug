{"sha": "ea3cbda50176e5229b8adc2899a2b8bb05d52360", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWEzY2JkYTUwMTc2ZTUyMjliOGFkYzI4OTlhMmI4YmIwNWQ1MjM2MA==", "commit": {"author": {"name": "J\"orn Rennecke", "email": "amylaar@cygnus.co.uk", "date": "1999-04-27T12:23:20Z"}, "committer": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "1999-04-27T12:23:20Z"}, "message": "sh.md (insv): Use copy_addr_to_reg.\n\n\t* sh.md (insv): Use copy_addr_to_reg.\n\t* final.c (insn_lengths_max_uid) New variable.\n\t(init_insn_lengths, shorten_branches): Set it.\n\t(get_attr_lengths): Test insn uid against insn_lengths_max_uid.\n\nFrom-SVN: r26676", "tree": {"sha": "00b7b76b2a03c741cb1bf3f9cf3632c615db6b65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/00b7b76b2a03c741cb1bf3f9cf3632c615db6b65"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ea3cbda50176e5229b8adc2899a2b8bb05d52360", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea3cbda50176e5229b8adc2899a2b8bb05d52360", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea3cbda50176e5229b8adc2899a2b8bb05d52360", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea3cbda50176e5229b8adc2899a2b8bb05d52360/comments", "author": null, "committer": null, "parents": [{"sha": "f915e937d9428193c15fb01d0d337d8eaeaecf1a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f915e937d9428193c15fb01d0d337d8eaeaecf1a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f915e937d9428193c15fb01d0d337d8eaeaecf1a"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "d7ad46e154bb3a3e7256ad69e2d3e4b819d5a3b6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea3cbda50176e5229b8adc2899a2b8bb05d52360/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea3cbda50176e5229b8adc2899a2b8bb05d52360/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ea3cbda50176e5229b8adc2899a2b8bb05d52360", "patch": "@@ -1,3 +1,11 @@\n+Tue Apr 27 20:19:47 1999  J\"orn Rennecke <amylaar@cygnus.co.uk>\n+\n+\t* sh.md (insv): Use copy_addr_to_reg.\n+\n+\t* final.c (insn_lengths_max_uid) New variable.\n+\t(init_insn_lengths, shorten_branches): Set it.\n+\t(get_attr_lengths): Test insn uid against insn_lengths_max_uid.\n+\n 1999-04-27 08:32 -0400  Zack Weinberg  <zack@rabi.columbia.edu>\n \n \t* expr.c (emit_move_insn_1): Abort if MODE argument is invalid. "}, {"sha": "04992a18773e0f6b86b8a4d9284881fcebfebafc", "filename": "gcc/config/sh/sh.md", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea3cbda50176e5229b8adc2899a2b8bb05d52360/gcc%2Fconfig%2Fsh%2Fsh.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea3cbda50176e5229b8adc2899a2b8bb05d52360/gcc%2Fconfig%2Fsh%2Fsh.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.md?ref=ea3cbda50176e5229b8adc2899a2b8bb05d52360", "patch": "@@ -4414,10 +4414,9 @@\n \n   size /= 8;\n   orig_address = XEXP (operands[0], 0);\n-  addr_target = gen_reg_rtx (SImode);\n   shift_reg = gen_reg_rtx (SImode);\n   emit_insn (gen_movsi (shift_reg, operands[3]));\n-  emit_insn (gen_addsi3 (addr_target, orig_address, GEN_INT (size - 1)));\n+  addr_target = copy_addr_to_reg (plus_constant (orig_address, size - 1));\n \n   operands[0] = change_address (operands[0], QImode, addr_target);\n   emit_insn (gen_movqi (operands[0], gen_rtx (SUBREG, QImode, shift_reg, 0)));"}, {"sha": "4695590dc5e9eb41ac353b8c8fbe9bc44511f2aa", "filename": "gcc/final.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ea3cbda50176e5229b8adc2899a2b8bb05d52360/gcc%2Ffinal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ea3cbda50176e5229b8adc2899a2b8bb05d52360/gcc%2Ffinal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffinal.c?ref=ea3cbda50176e5229b8adc2899a2b8bb05d52360", "patch": "@@ -627,6 +627,9 @@ dbr_sequence_length ()\n static short *insn_lengths;\n int *insn_addresses;\n \n+/* Max uid for which the above arrays are valid.  */\n+static int insn_lengths_max_uid;\n+\n /* Address of insn being processed.  Used by `insn_current_length'.  */\n int insn_current_address;\n \n@@ -673,6 +676,7 @@ init_insn_lengths ()\n     {\n       free (insn_lengths);\n       insn_lengths = 0;\n+      insn_lengths_max_uid = 0;\n     }\n   if (insn_addresses)\n     {\n@@ -698,7 +702,7 @@ get_attr_length (insn)\n   int i;\n   int length = 0;\n \n-  if (insn_lengths)\n+  if (insn_lengths_max_uid > INSN_UID (insn))\n     return insn_lengths[INSN_UID (insn)];\n   else\n     switch (GET_CODE (insn))\n@@ -1128,6 +1132,7 @@ shorten_branches (first)\n   /* Allocate the rest of the arrays.  */\n   insn_lengths = (short *) xmalloc (max_uid * sizeof (short));\n   insn_addresses = (int *) xmalloc (max_uid * sizeof (int));\n+  insn_lengths_max_uid = max_uid;\n   /* Syntax errors can lead to labels being outside of the main insn stream.\n      Initialize insn_addresses, so that we get reproducible results.  */\n   bzero ((char *)insn_addresses, max_uid * sizeof *insn_addresses);"}]}