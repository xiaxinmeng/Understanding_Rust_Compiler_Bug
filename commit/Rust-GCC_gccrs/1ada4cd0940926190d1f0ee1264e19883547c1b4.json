{"sha": "1ada4cd0940926190d1f0ee1264e19883547c1b4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWFkYTRjZDA5NDA5MjYxOTBkMWYwZWUxMjY0ZTE5ODgzNTQ3YzFiNA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2001-02-07T22:04:10Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2001-02-07T22:04:10Z"}, "message": "c-decl.c (finish_enum): Revert part of 2000-01-05 change.\n\n\t* c-decl.c (finish_enum): Revert part of 2000-01-05 change.\n\n\t* gcc.dg/20010202-1.c: New test.\n\t* gcc.dg/991209-1.c: Compile on whole ia32 family, not just i386.\n\nFrom-SVN: r39527", "tree": {"sha": "f9dbb0d3520859fd2b4ba6efc1d1401d1ac5b421", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f9dbb0d3520859fd2b4ba6efc1d1401d1ac5b421"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1ada4cd0940926190d1f0ee1264e19883547c1b4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ada4cd0940926190d1f0ee1264e19883547c1b4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ada4cd0940926190d1f0ee1264e19883547c1b4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ada4cd0940926190d1f0ee1264e19883547c1b4/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0c952af328e6048ddbc5087225197b4851a57f5e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c952af328e6048ddbc5087225197b4851a57f5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0c952af328e6048ddbc5087225197b4851a57f5e"}], "stats": {"total": 51, "additions": 45, "deletions": 6}, "files": [{"sha": "f7ad29eff90328dfac3fcb405396387796bc7e50", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1ada4cd0940926190d1f0ee1264e19883547c1b4", "patch": "@@ -1,3 +1,7 @@\n+2001-02-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* c-decl.c (finish_enum): Revert part of 2000-01-05 change.\n+\n 2001-02-07  Mark Mitchell  <mark@codesourcery.com>\n \n \t* config/rs6000/aix43.h (CPLUSCPLUS_CPP_SPEC): Define it."}, {"sha": "ef5bb38f1915c62fd579de06603aeaf6362f33c4", "filename": "gcc/c-decl.c", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=1ada4cd0940926190d1f0ee1264e19883547c1b4", "patch": "@@ -5610,13 +5610,19 @@ finish_enum (enumtype, values, attributes)\n   unsign = (tree_int_cst_sgn (minnode) >= 0);\n   precision = MAX (min_precision (minnode, unsign),\n \t\t   min_precision (maxnode, unsign));\n-  if (!TYPE_PACKED (enumtype))\n-    precision = MAX (precision, TYPE_PRECISION (integer_type_node));\n-  if (type_for_size (precision, unsign) == 0)\n+  if (TYPE_PACKED (enumtype) || precision > TYPE_PRECISION (integer_type_node))\n     {\n-      warning (\"enumeration values exceed range of largest integer\");\n-      precision = TYPE_PRECISION (long_long_integer_type_node);\n+      tree narrowest = type_for_size (precision, unsign);\n+      if (narrowest == 0)\n+\t{\n+\t  warning (\"enumeration values exceed range of largest integer\");\n+\t  narrowest = long_long_integer_type_node;\n+\t}\n+\n+      precision = TYPE_PRECISION (narrowest);\n     }\n+  else\n+    precision = TYPE_PRECISION (integer_type_node);\n \n   if (precision == TYPE_PRECISION (integer_type_node))\n     enum_value_type = type_for_size (precision, 0);"}, {"sha": "78bae3b630584a8959f53ee24e7d005b7310ed83", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1ada4cd0940926190d1f0ee1264e19883547c1b4", "patch": "@@ -1,3 +1,8 @@\n+2001-02-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* gcc.dg/20010202-1.c: New test.\n+\t* gcc.dg/991209-1.c: Compile on whole ia32 family, not just i386.\n+\n 2001-02-07  Zack Weinberg  <zack@wolery.stanford.edu>\n \n \t* g++.dg/stdbool-if.C: New test."}, {"sha": "e4eaae0b246de5c419b4346ce51659feacaf7ad8", "filename": "gcc/testsuite/gcc.dg/20010202-1.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Ftestsuite%2Fgcc.dg%2F20010202-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Ftestsuite%2Fgcc.dg%2F20010202-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F20010202-1.c?ref=1ada4cd0940926190d1f0ee1264e19883547c1b4", "patch": "@@ -0,0 +1,24 @@\n+/* { dg-do compile { target i?86-*-* sparc*-*-* } } */\n+/* { dg-options \"-O2\" } */\n+\n+typedef enum { false, true } __attribute__ ((packed)) boolean;\n+typedef struct {\n+  enum {\n+    A0 = 0, A1 = 1, A2 = 2\n+  } __attribute__((packed)) A:3;\n+  enum {\n+    B0 = 0, B1 = 1, B2 = 2\n+  } __attribute__((packed)) B:3;\n+  boolean C:1;\n+  boolean D:1;\n+  unsigned char :8;\n+} foo;\n+foo x = { A2, B1, false, true };\n+\n+int main(void)\n+{\n+  if (sizeof (foo) != 2 || __alignof__ (foo) != 1)\n+    abort ();\n+\n+  exit (0);\n+}"}, {"sha": "b3a47285158e315de44ab4f0a1802098f39c119d", "filename": "gcc/testsuite/gcc.dg/991209-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Ftestsuite%2Fgcc.dg%2F991209-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ada4cd0940926190d1f0ee1264e19883547c1b4/gcc%2Ftestsuite%2Fgcc.dg%2F991209-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F991209-1.c?ref=1ada4cd0940926190d1f0ee1264e19883547c1b4", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-do compile { target i386-*-* } } */\n+/* { dg-do compile { target i?86-*-* } } */\n \n int foo ()\n {"}]}