{"sha": "1e8878861c684fa8695bd09bf585c44ed59c3801", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWU4ODc4ODYxYzY4NGZhODY5NWJkMDliZjU4NWM0NGVkNTljMzgwMQ==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2008-05-27T09:20:48Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-05-27T09:20:48Z"}, "message": "2008-05-27  Vincent Celier  <celier@adacore.com>\n\n\t* makeutl.ads, makeutl.adb:\n\t(Set_Location): New procedure\n\t(Get_Location): New function\n\t(Update_Main): New procedure\n\nFrom-SVN: r135993", "tree": {"sha": "3286f3d46f1e7b1e3c1193c922a2d0214a182218", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3286f3d46f1e7b1e3c1193c922a2d0214a182218"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e8878861c684fa8695bd09bf585c44ed59c3801", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e8878861c684fa8695bd09bf585c44ed59c3801", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e8878861c684fa8695bd09bf585c44ed59c3801", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e8878861c684fa8695bd09bf585c44ed59c3801/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fceeaab66b35f55d325e4b07b7e96b5a7d9a1656", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fceeaab66b35f55d325e4b07b7e96b5a7d9a1656", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fceeaab66b35f55d325e4b07b7e96b5a7d9a1656"}], "stats": {"total": 58, "additions": 55, "deletions": 3}, "files": [{"sha": "71e207a55f8d0e70a621871c80167bc516f6c1d7", "filename": "gcc/ada/makeutl.adb", "status": "modified", "additions": 45, "deletions": 3, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e8878861c684fa8695bd09bf585c44ed59c3801/gcc%2Fada%2Fmakeutl.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e8878861c684fa8695bd09bf585c44ed59c3801/gcc%2Fada%2Fmakeutl.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakeutl.adb?ref=1e8878861c684fa8695bd09bf585c44ed59c3801", "patch": "@@ -481,8 +481,13 @@ package body Makeutl is\n \n    package body Mains is\n \n+      type File_And_Loc is record\n+         File_Name : File_Name_Type;\n+         Location  : Source_Ptr := No_Location;\n+      end record;\n+\n       package Names is new Table.Table\n-        (Table_Component_Type => File_Name_Type,\n+        (Table_Component_Type => File_And_Loc,\n          Table_Index_Type     => Integer,\n          Table_Low_Bound      => 1,\n          Table_Initial        => 10,\n@@ -502,7 +507,7 @@ package body Makeutl is\n          Name_Len := 0;\n          Add_Str_To_Name_Buffer (Name);\n          Names.Increment_Last;\n-         Names.Table (Names.Last) := Name_Find;\n+         Names.Table (Names.Last) := (Name_Find, No_Location);\n       end Add_Main;\n \n       ------------\n@@ -515,6 +520,20 @@ package body Makeutl is\n          Mains.Reset;\n       end Delete;\n \n+      ------------------\n+      -- Get_Location --\n+      ------------------\n+\n+      function Get_Location return Source_Ptr is\n+      begin\n+         if Current < Names.First or else Current > Names.Last then\n+            return No_Location;\n+\n+         else\n+            return Names.Table (Current).Location;\n+         end if;\n+      end Get_Location;\n+\n       ---------------\n       -- Next_Main --\n       ---------------\n@@ -526,7 +545,7 @@ package body Makeutl is\n \n          else\n             Current := Current + 1;\n-            return Get_Name_String (Names.Table (Current));\n+            return Get_Name_String (Names.Table (Current).File_Name);\n          end if;\n       end Next_Main;\n \n@@ -548,6 +567,29 @@ package body Makeutl is\n          Current := 0;\n       end Reset;\n \n+      ------------------\n+      -- Set_Location --\n+      ------------------\n+\n+      procedure Set_Location (Location : Source_Ptr) is\n+      begin\n+         if Names.Last > 0 then\n+            Names.Table (Names.Last).Location := Location;\n+         end if;\n+      end Set_Location;\n+\n+      -----------------\n+      -- Update_Main --\n+      -----------------\n+\n+      procedure Update_Main (Name : String) is\n+      begin\n+         if Current >= Names.First and then Current <= Names.Last then\n+            Name_Len := 0;\n+            Add_Str_To_Name_Buffer (Name);\n+            Names.Table (Current).File_Name := Name_Find;\n+         end if;\n+      end Update_Main;\n    end Mains;\n \n    ----------"}, {"sha": "b6483f3e520bb357d2ac50e8422e5ed56d8b7c42", "filename": "gcc/ada/makeutl.ads", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e8878861c684fa8695bd09bf585c44ed59c3801/gcc%2Fada%2Fmakeutl.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e8878861c684fa8695bd09bf585c44ed59c3801/gcc%2Fada%2Fmakeutl.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakeutl.ads?ref=1e8878861c684fa8695bd09bf585c44ed59c3801", "patch": "@@ -103,6 +103,10 @@ package Makeutl is\n       procedure Add_Main (Name : String);\n       --  Add one main to the table\n \n+      procedure Set_Location (Location : Source_Ptr);\n+      --  Set the location of the last main added. By default, the location is\n+      --  No_Location.\n+\n       procedure Delete;\n       --  Empty the table\n \n@@ -113,6 +117,12 @@ package Makeutl is\n       --  Increase the index and return the next main.\n       --  If table is exhausted, return an empty string.\n \n+      function Get_Location return Source_Ptr;\n+      --  Get the location of the current main\n+\n+      procedure Update_Main (Name : String);\n+      --  Update the file name of the current main\n+\n       function Number_Of_Mains return Natural;\n       --  Returns the number of mains added with Add_Main since the last call\n       --  to Delete."}]}