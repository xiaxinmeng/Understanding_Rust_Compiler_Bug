{"sha": "61536478879ebd0c491fdd2aaa8677e82a151873", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjE1MzY0Nzg4NzllYmQwYzQ5MWZkZDJhYWE4Njc3ZTgyYTE1MTg3Mw==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-04-04T13:32:42Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-04-04T13:32:42Z"}, "message": "* Check in merge from gcc2.  See ChangeLog.11 and ChangeLog.12\n        for details.\n\n        * haifa-sched.c: Mirror recent changes from gcc2.\n\nFrom-SVN: r18986", "tree": {"sha": "3253b0bdf098db666a9d372875384484a4e0e89a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3253b0bdf098db666a9d372875384484a4e0e89a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/61536478879ebd0c491fdd2aaa8677e82a151873", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61536478879ebd0c491fdd2aaa8677e82a151873", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61536478879ebd0c491fdd2aaa8677e82a151873", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61536478879ebd0c491fdd2aaa8677e82a151873/comments", "author": null, "committer": null, "parents": [{"sha": "f6cb0e630f8909a86b334f64150db7ca6fce1968", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6cb0e630f8909a86b334f64150db7ca6fce1968", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6cb0e630f8909a86b334f64150db7ca6fce1968"}], "stats": {"total": 429, "additions": 264, "deletions": 165}, "files": [{"sha": "a968e2f25daf4244562f4c6b98b6dda9ad266531", "filename": "gcc/configure.in", "status": "modified", "additions": 264, "deletions": 165, "changes": 429, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61536478879ebd0c491fdd2aaa8677e82a151873/gcc%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61536478879ebd0c491fdd2aaa8677e82a151873/gcc%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.in?ref=61536478879ebd0c491fdd2aaa8677e82a151873", "patch": "@@ -174,7 +174,7 @@ AC_CACHE_VAL(gcc_cv_header_inttypes_h,\n AC_MSG_RESULT($gcc_cv_header_inttypes_h)\n \n AC_CHECK_FUNCS(strtoul bsearch strerror putenv popen vprintf bcopy bzero bcmp \\\n-\tindex rindex kill getrlimit setrlimit atoll atoq)\n+\tindex rindex kill getrlimit setrlimit atoll atoq sysconf)\n \n GCC_FUNC_PRINTF_PTR\n \n@@ -190,9 +190,11 @@ AC_SUBST(manext)\n AC_SUBST(objext)\n \n build_xm_file=\n+build_xm_defines=\n build_install_headers_dir=install-headers-tar\n build_exeext=\n host_xm_file=\n+host_xm_defines=\n host_xmake_file=\n host_truncate_target=\n host_exeext=\n@@ -213,6 +215,7 @@ for machine in $build $host $target; do\n \textra_objs=\n \textra_host_objs=\n \textra_gcc_objs=\n+\txm_defines=\n \tfloat_format=\n \t# Set this to force installation and use of collect2.\n \tuse_collect2=\n@@ -248,7 +251,7 @@ for machine in $build $host $target; do\n \tc*-convex-*)\n \t\tcpu_type=convex\n \t\t;;\n-\ti[[3456]]86-*-*)\n+\ti[[34567]]86-*-*)\n \t\tcpu_type=i386\n \t\t;;\n \thppa*-*-*)\n@@ -274,6 +277,13 @@ for machine in $build $host $target; do\n \ttm_file=${cpu_type}/${cpu_type}.h\n \txm_file=${cpu_type}/xm-${cpu_type}.h\n \t\n+\t# Set the default macros to define for GNU/Linux systems.\n+\tcase $machine in\n+\t*-*-linux-gnu*)\n+\t\txm_defines=\"HAVE_ATEXIT POSIX NO_STAB_H BSTRING\"\n+\t\t;;\n+\tesac\n+\n \tcase $machine in\n \t# Support site-specific machine types.\n \t*local*)\n@@ -294,7 +304,7 @@ for machine in $build $host $target; do\n \t\t;;\n \ta29k-*-bsd* | a29k-*-sym1*)\n \t\ttm_file=\"${tm_file} a29k/unix.h\"\n-\t\txm_file=a29k/xm-unix.h\n+\t\txm_defines=USG\n \t\txmake_file=a29k/x-unix\n \t\tuse_collect2=yes\n \t\t;;\n@@ -312,16 +322,18 @@ for machine in $build $host $target; do\n \t\tuse_collect2=yes\n \t\t;;\n \talpha*-*-linux-gnuecoff*)\n-\t\ttm_file=\"${tm_file} alpha/linux-ecoff.h alpha/linux.h\"\n-\t\txm_file=\"${xm_file} alpha/xm-linux.h\"\n+\t\ttm_file=\"${tm_file} alpha/linux.h\"\n+\t\txm_defines=USE_BFD\n+\t\ttarget_cpu_default=\"MASK_GAS\"\n \t\tgas=no\n \t\txmake_file=none\n \t\tgas=yes gnu_ld=yes\n \t\t;;\n \talpha*-*-linux-gnulibc1*)\n-\t\ttm_file=\"${tm_file} alpha/elf.h alpha/linux-elf.h alpha/linux.h\"\n-\t\txm_file=\"${xm_file} alpha/xm-linux.h\"\n-\t\ttmake_file=\"t-linux t-linux-gnulibc1\"\n+\t\ttm_file=\"${tm_file} alpha/linux.h alpha/elf.h\"\n+\t\txm_defines=USE_BFD\n+\t\ttarget_cpu_default=\"MASK_GAS\"\n+\t\ttmake_file=\"t-linux t-linux-gnulibc1 alpha/t-linux\"\n \t\txmake_file=none\n \t\tgas=yes gnu_ld=yes\n  \t\tif [[ x$enable_threads = xyes ]]; then\n@@ -331,7 +343,10 @@ for machine in $build $host $target; do\n \talpha*-*-linux-gnu*)\n \t\ttm_file=\"${tm_file} alpha/elf.h alpha/linux-elf.h alpha/linux.h\"\n \t\txm_file=\"${xm_file} alpha/xm-linux.h\"\n-\t\ttmake_file=\"t-linux\"\n+\t\txm_defines=USE_BFD\n+\t\ttarget_cpu_default=\"MASK_GAS\"\n+\t\ttmake_file=\"t-linux alpha/t-linux\"\n+\t\textra_parts=\"crtbegin.o crtbeginS.o crtend.o crtendS.o\"\n \t\txmake_file=none\n \t\tfixincludes=Makefile.in\n \t\tgas=yes gnu_ld=yes\n@@ -428,14 +443,13 @@ for machine in $build $host $target; do\n \t\t;;\n \tarm-*-netbsd*)\n \t\ttm_file=arm/netbsd.h\n-\t\txm_file=arm/xm-netbsd.h\n+\t\txm_file=\"xm-siglist.h ${xm_file}\"\n \t\ttmake_file=\"t-netbsd arm/t-netbsd\"\n \t\t# On NetBSD, the headers are already okay, except for math.h.\n \t\tfixincludes=fixinc.math\n \t\t;;\n \tarm-*-linux-gnuaout*)\t\t# ARM GNU/Linux\n \t\tcpu_type=arm\n-\t\txm_file=arm/xm-linux.h\n \t\txmake_file=x-linux\n \t\ttm_file=arm/linux-gas.h\n \t\ttmake_file=arm/t-linux\n@@ -672,7 +686,7 @@ for machine in $build $host $target; do\n \t\t;;\n \ti370-*-mvs*)\n \t\t;;\n-\ti[[3456]]86-ibm-aix*)\t\t# IBM PS/2 running AIX\n+\ti[[34567]]86-ibm-aix*)\t\t# IBM PS/2 running AIX\n                 if [[ x$gas = xyes ]]\n \t\tthen\n \t\t\ttm_file=i386/aix386.h\n@@ -682,11 +696,13 @@ for machine in $build $host $target; do\n \t\t\ttm_file=i386/aix386ng.h\n \t\t\tuse_collect2=yes\n \t\tfi\n-\t\txm_file=i386/xm-aix.h\n+\t\txm_file=\"xm-alloca.h i386/xm-aix.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\txmake_file=i386/x-aix\n \t\t;;\n-\ti[[456]]86-ncr-sysv4*)\t\t# NCR 3000 - ix86 running system V.4\n-\t\txm_file=i386/xm-sysv4.h\n+\ti[[34567]]86-ncr-sysv4*)\t# NCR 3000 - ix86 running system V.4\n+\t\txm_file=\"xm-siglist.h xm-alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG POSIX SMALL_ARG_MAX\"\n \t\txmake_file=i386/x-ncr3000\n \t\tif [[ x$stabs = xyes -a x$gas = xyes ]]\n \t\tthen\n@@ -697,7 +713,7 @@ for machine in $build $host $target; do\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\ttmake_file=i386/t-crtpic\n \t\t;;\n-\ti[[3456]]86-next-*)\n+\ti[[34567]]86-next-*)\n \t\ttm_file=i386/next.h\n \t\txm_file=i386/xm-next.h\n \t\ttmake_file=i386/t-next\n@@ -707,7 +723,7 @@ for machine in $build $host $target; do\n \t\t\tthread_file='mach'\n \t\tfi\n \t\t;;\n-\ti[[3456]]86-sequent-bsd*) \t\t# 80386 from Sequent\n+\ti[[34567]]86-sequent-bsd*) \t\t# 80386 from Sequent\n \t\tuse_collect2=yes\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -716,26 +732,27 @@ for machine in $build $host $target; do\n \t\t\ttm_file=i386/sequent.h\n \t\tfi\n \t\t;;\n-\ti[[3456]]86-sequent-ptx1*)\n-\t\txm_file=i386/xm-sysv3.h\n+\ti[[34567]]86-sequent-ptx1*)\n+\t\txm_defines=\"USG SVR3\"\n \t\txmake_file=i386/x-sysv3\n \t\ttm_file=i386/seq-sysv3.h\n \t\ttmake_file=i386/t-crtstuff\n \t\tfixincludes=fixinc.ptx\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\tinstall_headers_dir=install-headers-cpio\n \t\t;;\n-\ti[[3456]]86-sequent-ptx2* | i[[3456]]86-sequent-sysv3*)\n-\t\txm_file=i386/xm-sysv3.h\n+\ti[[34567]]86-sequent-ptx2* | i[[34567]]86-sequent-sysv3*)\n+\t\txm_defines=\"USG SVR3\"\n \t\txmake_file=i386/x-sysv3\n \t\ttm_file=i386/seq2-sysv3.h\n \t\ttmake_file=i386/t-crtstuff\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\tfixincludes=fixinc.ptx\n \t\tinstall_headers_dir=install-headers-cpio\n \t\t;;\n-\ti[[3456]]86-sequent-ptx4* | i[[3456]]86-sequent-sysv4*)\n-\t\txm_file=i386/xm-sysv4.h\n+\ti[[34567]]86-sequent-ptx4* | i[[34567]]86-sequent-sysv4*)\n+\t\txm_file=\"xm-siglist.h xm-alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG POSIX SMALL_ARG_MAX\"\n \t\txmake_file=x-svr4\n \t\ttm_file=i386/ptx4-i.h\n \t\ttmake_file=t-svr4\n@@ -744,31 +761,29 @@ for machine in $build $host $target; do\n \t\tinstall_headers_dir=install-headers-cpio\n \t\t;;\n \ti386-sun-sunos*)\t\t# Sun i386 roadrunner\n-\t\txm_file=i386/xm-sun.h\n+\t\txm_defines=USG\n \t\ttm_file=i386/sun.h\n \t\tuse_collect2=yes\n \t\t;;\n \ti[[3456]]86-wrs-vxworks*)\n \t\ttm_file=i386/vxi386.h\n \t\ttmake_file=i386/t-i386bare\n \t\t;;\n-\ti[[3456]]86-*-aout*)\n+\ti[[34567]]86-*-aout*)\n \t\ttm_file=i386/i386-aout.h\n \t\ttmake_file=i386/t-i386bare\n \t\t;;\n-\ti[[3456]]86-*-bsdi* | i[[345]]86-*-bsd386*)\n+\ti[[34567]]86-*-bsdi* | i[[34567]]86-*-bsd386*)\n \t\ttm_file=i386/bsd386.h\n-\t\txm_file=i386/xm-bsd386.h\n #\t\ttmake_file=t-libc-ok\n \t\t;;\n-\ti[[3456]]86-*-bsd*)\n+\ti[[34567]]86-*-bsd*)\n \t\ttm_file=i386/386bsd.h\n-\t\txm_file=i386/xm-bsd386.h\n #\t\ttmake_file=t-libc-ok\n # Next line turned off because both 386BSD and BSD/386 use GNU ld.\n #\t\tuse_collect2=yes\n \t\t;;\n-\ti[[3456]]86-*-freebsdelf*)\n+\ti[[34567]]86-*-freebsdelf*)\n \t\ttm_file=\"i386/i386.h i386/att.h linux.h i386/freebsd-elf.h i386/perform.h\"\n \t\t# On FreeBSD, the headers are already ok, except for math.h.\n \t\tfixincludes=fixinc.math\n@@ -777,26 +792,27 @@ for machine in $build $host $target; do\n \t\tgnu_ld=yes\n \t\tstabs=yes\n \t\t;;\n-\ti[[3456]]86-*-freebsd*)\n+\ti[[34567]]86-*-freebsd*)\n \t\ttm_file=i386/freebsd.h\n \t\t# On FreeBSD, the headers are already ok, except for math.h.\n \t\tfixincludes=fixinc.math\n \t\ttmake_file=i386/t-freebsd\n \t\t;;\n-\ti[[3456]]86-*-netbsd*)\n+\ti[[34567]]86-*-netbsd*)\n \t\ttm_file=i386/netbsd.h\n \t\t# On NetBSD, the headers are already okay, except for math.h.\n \t\tfixincludes=fixinc.math\n \t\ttmake_file=t-netbsd\n \t\t;;\n-\ti[[3456]]86-*-coff*)\n+\ti[[34567]]86-*-coff*)\n \t\ttm_file=i386/i386-coff.h\n \t\ttmake_file=i386/t-i386bare\n \t\t;;\n-\ti[[3456]]86-*-isc*)\t\t# 80386 running ISC system\n-\t\txm_file=i386/xm-isc.h\n+\ti[[34567]]86-*-isc*)\t\t# 80386 running ISC system\n+\t\txm_file=\"${xm_file} i386/xm-isc.h\"\n+\t\txm_defines=\"USG SVR3\"\n \t\tcase $machine in\n-\t\t  i[[345]]86-*-isc[[34]]*)\n+\t\t  i[[34567]]86-*-isc[[34]]*)\n \t\t    xmake_file=i386/x-isc3\n \t\t    ;;\n \t\t  *)\n@@ -815,26 +831,28 @@ for machine in $build $host $target; do\n \t\tfi\n \t\tinstall_headers_dir=install-headers-cpio\n \t\t;;\n-\ti[[3456]]86-*-linux-gnuoldld*)\t# Intel 80386's running GNU/Linux\n-\t\txm_file=i386/xm-linux.h # with a.out format using pre BFD linkers\n+\ti[[34567]]86-*-linux-gnuoldld*)\t# Intel 80386's running GNU/Linux\n+\t\t\t\t\t# with a.out format using\n+\t\t\t\t\t# pre BFD linkers\n \t\txmake_file=x-linux-aout\n \t\ttmake_file=\"t-linux-aout i386/t-crtstuff\"\n \t\ttm_file=i386/linux-oldld.h\n \t\tfixincludes=Makefile.in #On Linux, the headers are ok already.\n \t\tgnu_ld=yes\n \t\t;;\n-\ti[[3456]]86-*-linux-gnuaout*)\t# Intel 80386's running GNU/Linux\n-\t\txm_file=i386/xm-linux.h\t\t# with a.out format\n+\ti[[34567]]86-*-linux-gnuaout*)\t# Intel 80386's running GNU/Linux\n+\t\t\t\t\t# with a.out format\n \t\txmake_file=x-linux-aout\n \t\ttmake_file=\"t-linux-aout i386/t-crtstuff\"\n \t\ttm_file=i386/linux-aout.h\n \t\tfixincludes=Makefile.in #On Linux, the headers are ok already.\n \t\tgnu_ld=yes\n \t\t;;\n-\ti[[3456]]86-*-linux-gnulibc1)\n-\t\txm_file=i386/xm-linux.h\t# Intel 80386's running GNU/Linux\n-\t\txmake_file=x-linux\t# with ELF format using the\n-\t\ttm_file=i386/linux.h\t# GNU/Linux C library 5\n+\ti[[34567]]86-*-linux-gnulibc1)\t# Intel 80386's running GNU/Linux\n+\t\t\t\t\t# with ELF format using the\n+\t\t\t\t\t# GNU/Linux C library 5\n+\t\txmake_file=x-linux\t\n+\t\ttm_file=i386/linux.h\t\n \t\ttmake_file=\"t-linux t-linux-gnulibc1 i386/t-crtstuff\"\n \t\textra_parts=\"crtbegin.o crtbeginS.o crtend.o crtendS.o\"\n \t\tfixincludes=Makefile.in #On Linux, the headers are ok already.\n@@ -843,9 +861,10 @@ for machine in $build $host $target; do\n  \t\t\tthread_file='single'\n  \t\tfi\n \t\t;;\n-\ti[[3456]]86-*-linux-gnu*)\t# Intel 80386's running GNU/Linux\n-\t\txm_file=i386/xm-linux.h # with ELF format using glibc 2\n-\t\txmake_file=x-linux\t# aka GNU/Linux C library 6\n+\ti[[34567]]86-*-linux-gnu*)\t# Intel 80386's running GNU/Linux\n+\t\t\t\t\t# with ELF format using glibc 2\n+\t\t\t\t\t# aka GNU/Linux C library 6\n+\t\txmake_file=x-linux\n \t\ttm_file=i386/linux.h\n \t\ttmake_file=\"t-linux i386/t-crtstuff\"\n \t\textra_parts=\"crtbegin.o crtbeginS.o crtend.o crtendS.o\"\n@@ -855,21 +874,28 @@ for machine in $build $host $target; do\n  \t\t\tthread_file='posix'\n  \t\tfi\n \t\t;;\n-\ti[[3456]]86-*-gnu*)\n+\ti[[34567]]86-*-gnu*)\n+\t\t;;\n+\ti[[34567]]86-go32-msdos | i[[34567]]86-*-go32*)\n+\t\txm_file=i386/xm-go32.h\n+\t\ttm_file=i386/go32.h\n+\t\ttmake_file=i386/t-go32\n \t\t;;\n-\ti[[3456]]86-go32-msdos | i[[3456]]86-*-go32* | i[[3456]]86-*-msdosdjgpp*)\n+\ti[[34567]]86-pc-msdosdjgpp*)\n \t\txm_file=i386/xm-go32.h\n \t\ttm_file=i386/go32.h\n \t\ttmake_file=i386/t-go32\n+\t\tgnu_ld=yes\n+\t\tgas=yes\n \t\t;;\n-\ti[[3456]]86-moss-msdos* | i[[3456]]86-*-moss*)\n+\ti[[34567]]86-moss-msdos* | i[[34567]]86-*-moss*)\n \t\ttm_file=i386/moss.h\n \t\ttmake_file=t-libc-ok\n \t\tfixincludes=Makefile.in\n \t\tgnu_ld=yes\n \t\tgas=yes\n \t\t;;\n-\ti[[3456]]86-*-lynxos*)\n+\ti[[34567]]86-*-lynxos*)\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\ttm_file=i386/lynx.h\n@@ -880,12 +906,12 @@ for machine in $build $host $target; do\n \t\ttmake_file=i386/t-i386bare\n \t\txmake_file=x-lynx\n \t\t;;\n-\ti[[3456]]86-*-mach*)\n+\ti[[34567]]86-*-mach*)\n \t\ttm_file=i386/mach.h\n #\t\ttmake_file=t-libc-ok\n \t\tuse_collect2=yes\n \t\t;;\n-\ti[[3456]]86-*-osfrose*)\t\t# 386 using OSF/rose\n+\ti[[34567]]86-*-osfrose*)\t\t# 386 using OSF/rose\n                 if [[ x$elf = xyes ]]\n \t\tthen\n \t\t\ttm_file=i386/osfelf.h\n@@ -894,33 +920,35 @@ for machine in $build $host $target; do\n \t\t\ttm_file=i386/osfrose.h\n \t\t\tuse_collect2=yes\n \t\tfi\n-\t\txm_file=i386/xm-osf.h\n+\t\txm_file=\"i386/xm-osf.h ${xm_file}\"\n \t\txmake_file=i386/x-osfrose\n \t\ttmake_file=i386/t-osf\n \t\textra_objs=halfpic.o\n \t\t;;\n-\ti[[345]]86-go32-rtems*)\n+\ti[[34567]]86-go32-rtems*)\n \t\tcpu_type=i386\n \t\txm_file=i386/xm-go32.h\n \t\ttm_file=i386/go32-rtems.h\n \t\ttmake_file=\"i386/t-go32 t-rtems\"\n \t\t;;\n-\ti[[345]]86-*-rtems*)\n+\ti[[34567]]86-*-rtems*)\n \t\tcpu_type=i386\n \t\ttm_file=i386/rtems.h\n \t\ttmake_file=\"i386/t-i386bare t-rtems\"\n \t\t;;\n-\ti[[3456]]86-*-sco3.2v5*)\t\t# 80386 running SCO Open Server 5\n-\t\txm_file=i386/xm-sco5.h\n+\ti[[34567]]86-*-sco3.2v5*)\t# 80386 running SCO Open Server 5\n+\t\txm_file=\"xm-siglist.h xm-alloca.h ${xm_file} i386/xm-sco5.h\"\n+\t\txm_defines=\"USG SVR3\"\n \t\txmake_file=i386/x-sco5\n \t\tfixincludes=fixinc.sco\n \t\tinstall_headers_dir=install-headers-cpio\n \t\ttm_file=i386/sco5.h\n \t\ttmake_file=i386/t-sco5\n \t\textra_parts=\"crtbegin.o crtend.o crtbeginS.o crtendS.o\"\n \t\t;;\n-\ti[[3456]]86-*-sco3.2v4*)\t \t# 80386 running SCO 3.2v4 system\n-\t\txm_file=i386/xm-sco.h\n+\ti[[34567]]86-*-sco3.2v4*) \t# 80386 running SCO 3.2v4 system\n+\t\txm_file=\"${xm_file} i386/xm-sco.h\"\n+\t\txm_defines=\"USG SVR3 BROKEN_LDEXP SMALL_ARG_MAX NO_SYS_SIGLIST\"\n \t\txmake_file=i386/x-sco4\n \t\tfixincludes=fixinc.sco\n \t\tinstall_headers_dir=install-headers-cpio\n@@ -936,7 +964,7 @@ for machine in $build $host $target; do\n \t\tfi\n \t\ttruncate_target=yes\n \t\t;;\n-\ti[[3456]]86-*-sco*)\t \t# 80386 running SCO system\n+\ti[[34567]]86-*-sco*)\t \t# 80386 running SCO system\n \t\txm_file=i386/xm-sco.h\n \t\txmake_file=i386/x-sco\n \t\tinstall_headers_dir=install-headers-cpio\n@@ -952,24 +980,29 @@ for machine in $build $host $target; do\n \t\tfi\n \t\ttruncate_target=yes\n \t\t;;\n-\ti[[3456]]86-*-solaris2*)\n-\t\txm_file=i386/xm-sysv4.h\n+\ti[[34567]]86-*-solaris2*)\n+\t\txm_file=\"xm-siglist.h xm-alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG POSIX SMALL_ARG_MAX\"\n \t\tif [[ x$stabs = xyes ]]\n \t\tthen\n \t\t\ttm_file=i386/sol2dbg.h\n \t\telse\n \t\t\ttm_file=i386/sol2.h\n \t\tfi\n \t\ttmake_file=i386/t-sol2\n-\t\textra_parts=\"crt1.o crti.o crtn.o crtbegin.o crtend.o\"\n+\t\textra_parts=\"crt1.o crti.o crtn.o gcrt1.o gmon.o crtbegin.o crtend.o\"\n \t\txmake_file=x-svr4\n-\t\tfixincludes=fixinc.svr4\n-\t\tbroken_install=yes\n+\t\tcase $machine in\n+\t\t*-*-solaris2.[[0-4]])\n+\t\t\tfixincludes=fixinc.svr4;;\n+\t\t*)\n+\t\t\tfixincludes=fixinc.math;;\n+\t\tesac\n  \t\tif [[ x$enable_threads = xyes ]]; then\n \t\t\tthread_file='solaris'\n \t\tfi\n \t\t;;\n-       i[[3456]]86-*-sysv5*)           # Intel x86 on System V Release 5\n+       i[[34567]]86-*-sysv5*)           # Intel x86 on System V Release 5\n                xm_file=i386/xm-sysv4.h\n                tm_file=i386/sysv4.h\n                if [[ x$stabs = xyes ]]\n@@ -981,8 +1014,9 @@ for machine in $build $host $target; do\n                extra_parts=\"crtbegin.o crtend.o\"\n                fixincludes=Makefile.in # The headers are just fine, thank you.\n                ;;\n-\ti[[3456]]86-*-sysv4*)\t\t# Intel 80386's running system V.4\n-\t\txm_file=i386/xm-sysv4.h\n+\ti[[34567]]86-*-sysv4*)\t\t# Intel 80386's running system V.4\n+\t\txm_file=\"xm-siglist.h xm-alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG POSIX SMALL_ARG_MAX\"\n \t\ttm_file=i386/sysv4.h\n \t\tif [[ x$stabs = xyes ]]\n \t\tthen\n@@ -992,8 +1026,8 @@ for machine in $build $host $target; do\n \t\txmake_file=x-svr4\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\t;;\n-\ti[[3456]]86-*-sysv*)\t\t# Intel 80386's running system V\n-\t\txm_file=i386/xm-sysv3.h\n+\ti[[34567]]86-*-sysv*)\t\t# Intel 80386's running system V\n+\t\txm_defines=\"USG SVR3\"\n \t\txmake_file=i386/x-sysv3\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1019,7 +1053,7 @@ for machine in $build $host $target; do\n \t\ttmake_file=i386/t-vsta\n \t\txmake_file=i386/x-vsta\n \t\t;;\n-\ti[[3456]]86-*-pe | i[[3456]]86-*-cygwin32)\n+\ti[[34567]]86-*-pe | i[[34567]]86-*-cygwin32)\n \t\txm_file=\"${xm_file} i386/xm-cygwin32.h\"\n \t\ttmake_file=i386/t-cygwin32\n \t\ttm_file=i386/cygwin32.h\n@@ -1031,7 +1065,7 @@ for machine in $build $host $target; do\n \t\tfi\n \t\texeext=.exe\n \t\t;;\n-\ti[[3456]]86-*-mingw32)\n+\ti[[34567]]86-*-mingw32*)\n \t\ttm_file=i386/mingw32.h\n \t\txm_file=\"${xm_file} i386/xm-mingw32.h\"\n \t\ttmake_file=i386/t-cygwin32\n@@ -1042,11 +1076,18 @@ for machine in $build $host $target; do\n \t\t\tthread_file='win32'\n \t\tfi\n \t\texeext=.exe\n+\t\tcase $machine in\n+\t\t\t*mingw32msv*)\n+\t\t\t\t;;\n+\t\t\t*minwg32crt* | *mingw32*)\n+\t\t\t\ttm_file=\"${tm_file} i386/crtdll.h\"\n+\t\t\t\t;;\n+\t\tesac\n \t\t;;\n-\ti[[3456]]86-*-winnt*)\n+\ti[[34567]]86-*-winnt3*)\n \t\ttm_file=i386/win-nt.h\n \t\tout_file=i386/i386.c\n-\t\txm_file=i386/xm-winnt.h\n+\t\txm_file=\"xm-winnt.h ${xm_file}\"\n \t\txmake_file=winnt/x-winnt\n \t\ttmake_file=i386/t-winnt\n \t\textra_host_objs=\"winnt.o oldnames.o\"\n@@ -1060,13 +1101,14 @@ for machine in $build $host $target; do\n \t\t\tthread_file='win32'\n \t\tfi\n \t\t;;\n-\ti[[3456]]86-dg-dgux)\n-\t\txm_file=i386/xm-dgux.h\n+\ti[[34567]]86-dg-dgux*)\n+\t\txm_file=\"xm-alloca.h xm-siglist.h ${xm_file}\"\n+\t\txm_defines=\"USG POSIX\"\n \t\tout_file=i386/dgux.c\n \t\ttm_file=i386/dgux.h\n \t\ttmake_file=i386/t-dgux\n \t\txmake_file=i386/x-dgux\n-\t\tfixincludes=fixinc.dgux\n+\t\tfixincludes=Makefile.in # There is nothing to fix\n \t\tinstall_headers_dir=install-headers-cpio\n               ;;\n \ti860-alliant-*)\t\t# Alliant FX/2800\n@@ -1090,18 +1132,18 @@ for machine in $build $host $target; do\n \t\t;;\n \ti860-*-osf*)\t\t\t# Intel Paragon XP/S, OSF/1AD\n \t\ttm_file=\"${tm_file} svr3.h i860/paragon.h\"\n-\t\txm_file=\"${xm_file} xm-svr3.h\"\n+\t\txm_defines=\"USG SVR3\"\n \t\ttmake_file=t-osf\n \t\t;;\n \ti860-*-sysv3*)\n \t\ttm_file=\"${tm_file} svr3.h i860/sysv3.h\"\n-\t\txm_file=\"${tm_file} xm-svr3.h\"\n+\t\txm_defines=\"USG SVR3\"\n \t\txmake_file=i860/x-sysv3\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\t;;\n \ti860-*-sysv4*)\n \t\ttm_file=\"${tm_file} svr4.h i860/sysv4.h\"\n-\t\txm_file=\"${xm_file} xm-svr3.h\"\n+\t\txm_defines=\"USG SVR3\"\n \t\txmake_file=i860/x-sysv4\n \t\ttmake_file=t-svr4\n \t\textra_parts=\"crtbegin.o crtend.o\"\n@@ -1142,7 +1184,8 @@ for machine in $build $host $target; do\n \t\t;;\n \tm68000-convergent-sysv*)\n \t\ttm_file=m68k/ctix.h\n-\t\txm_file=m68k/xm-3b1.h\n+\t\txm_file=\"m68k/xm-3b1.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\tuse_collect2=yes\n \t\textra_headers=math-68881.h\n \t\t;;\n@@ -1153,7 +1196,8 @@ for machine in $build $host $target; do\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68000-hp-hpux*)\t\t# HP 9000 series 300\n-\t\txm_file=m68k/xm-hp320.h\n+\t\txm_file=\"xm_alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG NO_SYS_SIGLIST\"\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\txmake_file=m68k/x-hp320g\n@@ -1177,7 +1221,8 @@ for machine in $build $host $target; do\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68000-att-sysv*)\n-\t\txm_file=m68k/xm-3b1.h\n+\t\txm_file=\"m68k/xm-3b1.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\ttm_file=m68k/3b1g.h\n@@ -1188,7 +1233,7 @@ for machine in $build $host $target; do\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-apple-aux*)\t\t# Apple Macintosh running A/UX\n-\t\txm_file=m68k/xm-aux.h\n+\t\txm_defines=\"USG AUX\"\n \t\ttmake_file=m68k/t-aux\n \t\tinstall_headers_dir=install-headers-cpio\n \t\textra_headers=math-68881.h\n@@ -1218,7 +1263,7 @@ for machine in $build $host $target; do\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t        tm_file=m68k/altos3068.h\n-\t\t        xm_file=m68k/xm-altos3068.h\n+\t\t\txm_defines=USG\n \t\telse\n \t\t\techo \"The Altos is supported only with the GNU assembler\" 1>&2\n \t\t\texit 1\n@@ -1237,21 +1282,24 @@ for machine in $build $host $target; do\n \t\telse\n \t\t\ttm_file=m68k/dpx2.h\n \t\tfi\n-\t\txm_file=m68k/xm-m68kv.h\n+\t\txm_file=\"xm-alloca.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\txmake_file=m68k/x-dpx2\n \t\tuse_collect2=yes\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-atari-sysv4*)              # Atari variant of V.4.\n \t\ttm_file=m68k/atari.h\n-\t\txm_file=m68k/xm-atari.h\n+\t\txm_file=\"xm-alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG FULL_PROTOTYPES\"\n \t\ttmake_file=t-svr4\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-motorola-sysv*)\n \t\ttm_file=m68k/mot3300.h\n-\t\txm_file=m68k/xm-mot3300.h\n+\t\txm_file=\"xm-alloca.h m68k/xm-mot3300.h ${xm_file}\"\n+\t\txm_defines=NO_SYS_SIGLIST\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\txmake_file=m68k/x-mot3300-gas\n@@ -1278,32 +1326,36 @@ for machine in $build $host $target; do\n \t\t;;\n \tm68k-ncr-sysv*)\t\t\t# NCR Tower 32 SVR3\n \t\ttm_file=m68k/tower-as.h\n-\t\txm_file=\"${xm_file} xm-svr3.h\"\n+\t\txm_defines=\"USG SVR3\"\n \t\txmake_file=m68k/x-tower\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\textra_headers=math-68881.h\n \t\t;;\n         m68k-plexus-sysv*)\n \t\ttm_file=m68k/plexus.h\n-\t\txm_file=m68k/xm-plexus.h\n+\t\txm_file=\"xm-alloca.h m68k/xm-plexus.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\tuse_collect2=yes\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-tti-*)\n \t\ttm_file=m68k/pbb.h\n-\t\txm_file=m68k/xm-m68kv.h\n+\t\txm_file=\"xm-alloca.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-crds-unos*)\n-\t\txm_file=m68k/xm-crds.h\n+\t\txm_file=\"xm-alloca.h m68k/xm-crds.h ${xm_file}\"\n+\t\txm_defines=\"USG unos\"\n \t\txmake_file=m68k/x-crds\n \t\ttm_file=m68k/crds.h\n \t\tuse_collect2=yes\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-cbm-sysv4*)\t\t# Commodore variant of V.4.\n \t\ttm_file=m68k/amix.h\n-\t\txm_file=m68k/xm-amix.h\n+\t\txm_file=\"xm-alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG FULL_PROTOTYPES\"\n \t\txmake_file=m68k/x-amix\n \t\ttmake_file=t-svr4\n \t\textra_parts=\"crtbegin.o crtend.o\"\n@@ -1337,7 +1389,8 @@ for machine in $build $host $target; do\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-hp-hpux7*)\t# HP 9000 series 300 running HPUX version 7.\n-\t\txm_file=m68k/xm-hp320.h\n+\t\txm_file=\"xm_alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG NO_SYS_SIGLIST\"\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\txmake_file=m68k/x-hp320g\n@@ -1351,7 +1404,8 @@ for machine in $build $host $target; do\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-hp-hpux*)\t# HP 9000 series 300\n-\t\txm_file=m68k/xm-hp320.h\n+\t\txm_file=\"xm_alloca.h ${xm_file}\"\n+\t\txm_defines=\"USG NO_SYS_SIGLIST\"\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\txmake_file=m68k/x-hp320g\n@@ -1391,7 +1445,7 @@ for machine in $build $host $target; do\n \t\t;;\n \tm68k-next-nextstep2*)\n \t\ttm_file=m68k/next21.h\n-\t\txm_file=m68k/xm-next.h\n+\t\txm_file=\"m68k/xm-next.h ${xm_file}\"\n \t\ttmake_file=m68k/t-next\n \t\txmake_file=m68k/x-next\n \t\textra_objs=nextstep.o\n@@ -1400,7 +1454,7 @@ for machine in $build $host $target; do\n                 ;;\n \tm68k-next-nextstep3*)\n \t\ttm_file=m68k/next.h\n-\t\txm_file=m68k/xm-next.h\n+\t\txm_file=\"m68k/xm-next.h ${xm_file}\"\n \t\ttmake_file=m68k/t-next\n \t\txmake_file=m68k/x-next\n \t\textra_objs=nextstep.o\n@@ -1464,20 +1518,22 @@ for machine in $build $host $target; do\n \t\ttmake_file=t-netbsd\n \t\t;;\n \tm68k-*-sysv3*)\t\t\t# Motorola m68k's running system V.3\n-\t\txm_file=m68k/xm-m68kv.h\n+\t\txm_file=\"xm-alloca.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\txmake_file=m68k/x-m68kv\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-*-sysv4*)\t\t\t# Motorola m68k's running system V.4\n \t\ttm_file=m68k/m68kv4.h\n-\t\txm_file=m68k/xm-m68kv.h\n+\t\txm_file=\"xm-alloca.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\ttmake_file=t-svr4\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\textra_headers=math-68881.h\n \t\t;;\n \tm68k-*-linux-gnuaout*)\t\t# Motorola m68k's running GNU/Linux\n-\t\txm_file=m68k/xm-linux.h\t# with a.out format\n+\t\t\t\t\t# with a.out format\n \t\txmake_file=x-linux\n \t\ttm_file=m68k/linux-aout.h\n \t\ttmake_file=\"t-linux-aout m68k/t-linux-aout\"\n@@ -1486,8 +1542,9 @@ for machine in $build $host $target; do\n \t\tgnu_ld=yes\n \t\t;;\n \tm68k-*-linux-gnulibc1)\t\t# Motorola m68k's running GNU/Linux\n-\t\txm_file=m68k/xm-linux.h\t# with ELF format using the\n-\t\txmake_file=x-linux\t# GNU/Linux C library 5\n+\t\t\t\t\t# with ELF format using the\n+\t\t\t\t\t# GNU/Linux C library 5\n+\t\txmake_file=x-linux\n \t\ttm_file=m68k/linux.h\n \t\ttmake_file=\"t-linux t-linux-gnulibc1 m68k/t-linux\"\n \t\textra_parts=\"crtbegin.o crtbeginS.o crtend.o crtendS.o\"\n@@ -1496,8 +1553,9 @@ for machine in $build $host $target; do\n \t\tgnu_ld=yes\n \t\t;;\n \tm68k-*-linux-gnu*)\t\t# Motorola m68k's running GNU/Linux\n-\t\txm_file=m68k/xm-linux.h\t# with ELF format using glibc 2\n-\t\txmake_file=x-linux\t# aka the GNU/Linux C library 6.\n+\t\t\t\t\t# with ELF format using glibc 2\n+\t\t\t\t\t# aka the GNU/Linux C library 6.\n+\t\txmake_file=x-linux\n \t\ttm_file=m68k/linux.h\n \t\ttmake_file=\"t-linux m68k/t-linux\"\n \t\textra_parts=\"crtbegin.o crtbeginS.o crtend.o crtendS.o\"\n@@ -1541,7 +1599,7 @@ for machine in $build $host $target; do\n \tm88k-dolphin-sysv3*)\n \t\ttm_file=m88k/dolph.h\n \t\textra_parts=\"crtbegin.o crtend.o\"\n-\t\txm_file=m88k/xm-sysv3.h\n+\t\txm_file=\"m88k/xm-sysv3.h ${xm_file}\"\n \t\txmake_file=m88k/x-dolph\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1551,7 +1609,7 @@ for machine in $build $host $target; do\n \tm88k-tektronix-sysv3)\n \t\ttm_file=m88k/tekXD88.h\n \t\textra_parts=\"crtbegin.o crtend.o\"\n-\t\txm_file=m88k/xm-sysv3.h\n+\t\txm_file=\"m88k/xm-sysv3.h ${xm_file}\"\n \t\txmake_file=m88k/x-tekXD88\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1578,7 +1636,7 @@ for machine in $build $host $target; do\n \tm88k-*-sysv3*)\n \t\ttm_file=m88k/sysv3.h\n \t\textra_parts=\"crtbegin.o crtend.o\"\n-\t\txm_file=m88k/xm-sysv3.h\n+\t\txm_file=\"m88k/xm-sysv3.h ${xm_file}\"\n \t\txmake_file=m88k/x-sysv3\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1602,8 +1660,8 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-sgi-irix5cross64)\t\t# Irix5 host, Irix 6 target, cross64\n-\t\ttm_file=mips/cross64.h\n-\t\txm_file=mips/xm-iris5.h\n+\t\ttm_file=\"mips/iris6.h mips/cross64.h\"\n+\t\txm_defines=\"USG HAVE_INTTYPES_H\"\n \t\tfixincludes=Makefile.in\n \t\txmake_file=mips/x-iris\n \t\ttmake_file=mips/t-cross64\n@@ -1620,12 +1678,12 @@ for machine in $build $host $target; do\n \t\t\tthen\n \t\t\t\ttm_file=mips/iris5gdb.h\n \t\t\telse\n-\t\t\t\ttm_file=mips/sni-gas.h\n+\t\t\t\ttm_file=\"mips/sni-svr4.h mips/sni-gas.h\"\n \t\t\tfi\n \t\telse\n \t\t\ttm_file=mips/sni-svr4.h\n \t\tfi\n-                xm_file=mips/xm-sysv.h\n+\t\txm_defines=USG\n                 xmake_file=mips/x-sni-svr4\n                 tmake_file=mips/t-mips-gas\n                 if [[ x$gnu_ld != xyes ]]\n@@ -1636,15 +1694,15 @@ for machine in $build $host $target; do\n \tmips-sgi-irix5*)\t\t# SGI System V.4., IRIX 5\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n-\t\t\ttm_file=mips/iris5gas.h\n+\t\t\ttm_file=\"mips/iris5.h mips/iris5gas.h\"\n \t\t\tif [[ x$stabs = xyes ]]\n \t\t\tthen\n \t\t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\t\tfi\n \t\telse\n \t\t\ttm_file=mips/iris5.h\n \t\tfi\n-\t\txm_file=mips/xm-iris5.h\n+\t\txm_defines=\"USG HAVE_INTTYPES_H\"\n \t\tfixincludes=fixinc.irix\n \t\txmake_file=mips/x-iris\n \t\t# mips-tfile doesn't work yet\n@@ -1656,11 +1714,11 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-sgi-irix4loser*)\t\t# Mostly like a MIPS.\n-\t\ttm_file=mips/iris4loser.h\n+\t\ttm_file=\"mips/iris4loser.h mips/iris3.h ${tm_file} mips/iris4.h\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-iris4.h\n+\t\txm_defines=USG\n \t\txmake_file=mips/x-iris\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1677,11 +1735,11 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-sgi-irix4*)\t\t# Mostly like a MIPS.\n-\t\ttm_file=mips/iris4.h\n+\t\ttm_file=\"mips/iris3.h ${tm_file} mips/iris4.h\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-iris4.h\n+\t\txm_defines=USG\n \t\txmake_file=mips/x-iris\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1698,11 +1756,11 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-sgi-*)\t\t\t# Mostly like a MIPS.\n-\t\ttm_file=mips/iris3.h\n+\t\ttm_file=\"mips/iris3.h ${tm_file}\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-iris3.h\n+\t\txm_defines=USG\n \t\txmake_file=mips/x-iris3\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1716,7 +1774,7 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-dec-osfrose*)\t\t# Decstation running OSF/1 reference port with OSF/rose.\n-\t\ttm_file=mips/osfrose.h\n+\t\ttm_file=\"mips/osfrose.h ${tm_file}\"\n \t\txmake_file=mips/x-osfrose\n \t\ttmake_file=mips/t-osfrose\n \t\textra_objs=halfpic.o\n@@ -1762,7 +1820,7 @@ for machine in $build $host $target; do\n \t\ttmake_file=t-netbsd\n \t\t;;\n \tmips-sony-bsd* | mips-sony-newsos*)\t# Sony NEWS 3600 or risc/news.\n-\t\ttm_file=mips/news4.h\n+\t\ttm_file=\"mips/news4.h ${tm_file}\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n@@ -1781,11 +1839,12 @@ for machine in $build $host $target; do\n \tmips-sony-sysv*)\t\t# Sony NEWS 3800 with NEWSOS5.0.\n \t\t\t\t\t# That is based on svr4.\n \t\t# t-svr4 is not right because this system doesn't use ELF.\n-\t\ttm_file=mips/news5.h\n+\t\ttm_file=\"mips/news5.h ${tm_file}\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-news.h\n+\t\txm_file=\"xm-siglist.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\ttmake_file=mips/t-mips-gas\n@@ -1798,11 +1857,12 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-tandem-sysv4*)\t\t# Tandem S2 running NonStop UX\n-\t\ttm_file=mips/svr4-t.h\n+\t\ttm_file=\"mips/svr4-5.h mips/svr4-t.h\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\txmake_file=mips/x-sysv\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1818,7 +1878,7 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-*-ultrix* | mips-dec-mach3)\t# Decstation.\n-\t\ttm_file=mips/ultrix.h\n+\t\ttm_file=\"mips/ultrix.h ${tm_file}\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n@@ -1853,7 +1913,7 @@ for machine in $build $host $target; do\n \t\tfi\n \t        ;;\n \tmips-*-bsd* | mips-*-riscosbsd* | mips-*-riscos[[1234]]bsd*)\n-\t\ttm_file=mips/bsd-4.h\t# MIPS BSD 4.3, RISC-OS 4.0\n+\t\ttm_file=\"mips/bsd-4.h ${tm_file}\" # MIPS BSD 4.3, RISC-OS 4.0\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n@@ -1874,7 +1934,7 @@ for machine in $build $host $target; do\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h ${xm_file}\"\n \t\txmake_file=mips/x-sysv\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1889,11 +1949,11 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-*-sysv4* | mips-*-riscos[[1234]]sysv4* | mips-*-riscossysv4*)\n-\t\ttm_file=mips/svr4-4.h\t# MIPS System V.4. RISC-OS 4.0\n+\t\ttm_file=\"mips/svr4-4.h ${tm_file}\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-sysv.h\n+\t\txm_defines=USG\n \t\txmake_file=mips/x-sysv\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1912,7 +1972,7 @@ for machine in $build $host $target; do\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-sysv.h\n+\t\txm_defines=USG\n \t\txmake_file=mips/x-sysv\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1927,11 +1987,11 @@ for machine in $build $host $target; do\n \t\tfi\n \t\t;;\n \tmips-*-sysv* | mips-*-riscos*sysv*)\n-\t\ttm_file=mips/svr3-4.h\t# MIPS System V.3, RISC-OS 4.0\n+\t\ttm_file=\"mips/svr3-4.h ${tm_file}\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n-\t\txm_file=mips/xm-sysv.h\n+\t\txm_defines=USG\n \t\txmake_file=mips/x-sysv\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -1971,7 +2031,7 @@ for machine in $build $host $target; do\n \t\ttmake_file=mips/t-ecoff\n \t\t;;\n \tmips-*-ecoff*)\n-\t\ttm_file=mips/ecoff.h\n+\t\ttm_file=\"${tm_file} gofast.h mips/ecoff.h\"\n \t\tif [[ x$stabs = xyes ]]; then\n \t\t\ttm_file=\"${tm_file} dbx.h\"\n \t\tfi\n@@ -1990,19 +2050,19 @@ for machine in $build $host $target; do\n \t\ttmake_file=mips/t-ecoff\n \t\t;;\n \tmips64orionel-*-elf*)\n-\t\ttm_file=\"mips/elflorion.h libgloss.h\"\n+\t\ttm_file=\"mips/elforion.h mips/elfl64.h libgloss.h\"\n \t\ttmake_file=mips/t-ecoff\n \t\t;;\n \tmips64-*-elf*)\n \t\ttm_file=\"mips/elf64.h libgloss.h\"\n \t\ttmake_file=mips/t-ecoff\n \t\t;;\n \tmips64orion-*-elf*)\n-\t\ttm_file=\"mips/elforion.h libgloss.h\"\n+\t\ttm_file=\"mips/elforion.h mips/elf64.h libgloss.h\"\n \t\ttmake_file=mips/t-ecoff\n \t\t;;\n \tmips64orion-*-rtems*)\n-\t\ttm_file=mips/rtems64.h\n+\t\ttm_file=\"mips/elforion.h mips/elfl64.h mips/rtems64.h\"\n \t\ttmake_file=\"mips/t-ecoff t-rtems\"\n \t\t;;\n \tmipstx39el-*-elf*)\n@@ -2064,7 +2124,7 @@ for machine in $build $host $target; do\n \t\t;;\n # This has not been updated to GCC 2.\n #\tns32k-ns-genix*)\n-#\t\txm_file=ns32k/xm-genix.h\n+#\t\txm_defines=USG\n #\t\txmake_file=ns32k/x-genix\n #\t\ttm_file=ns32k/genix.h\n #\t\tuse_collect2=yes\n@@ -2079,7 +2139,8 @@ for machine in $build $host $target; do\n \t\t;;\n \tns32k-pc532-minix*)\n \t\ttm_file=ns32k/pc532-min.h\n-\t\txm_file=ns32k/xm-pc532-min.h\n+\t\txm_file=\"ns32k/xm-pc532-min.h ${xm-file}\"\n+\t\txm_defines=USG\n \t\tuse_collect2=yes\n \t\t;;\n \tns32k-pc532-netbsd*)\n@@ -2114,7 +2175,8 @@ for machine in $build $host $target; do\n \t\t;;\n \tpowerpc-*-sysv* | powerpc-*-elf*)\n \t\ttm_file=rs6000/sysv4.h\n-\t\txm_file=rs6000/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h rs6000/xm-sysv4.h\"\n+\t\txm_defines=\"USG POSIX\"\n \t\textra_headers=ppc-asm.h\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -2178,7 +2240,8 @@ for machine in $build $host $target; do\n \t\t;;\n \tpowerpc-*-linux-gnu*)\n \t\ttm_file=rs6000/linux.h\n-\t\txm_file=rs6000/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h rs6000/xm-sysv4.h\"\n+\t\txm_defines=\"USG ${xm_defines}\"\n \t\tout_file=rs6000/rs6000.c\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n@@ -2196,15 +2259,17 @@ for machine in $build $host $target; do\n \t\t;;\n         powerpc-wrs-vxworks*)\n                 cpu_type=rs6000\n-                xm_file=rs6000/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h rs6000/xm-sysv4.h\"\n+\t\txm_defines=\"USG POSIX\"\n                 tm_file=rs6000/vxppc.h\n                 tmake_file=\"rs6000/t-ppcgas rs6000/t-ppccomm\"\n \t\textra_headers=ppc-asm.h\n \t\tthread_file='vxworks'\n                 ;;\n \tpowerpcle-*-sysv* | powerpcle-*-elf*)\n \t\ttm_file=rs6000/sysv4le.h\n-\t\txm_file=rs6000/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h rs6000/xm-sysv4.h\"\n+\t\txm_defines=\"USG POSIX\"\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\ttmake_file=\"rs6000/t-ppcos rs6000/t-ppccomm\"\n@@ -2243,7 +2308,8 @@ for machine in $build $host $target; do\n \t\t;;\n \tpowerpcle-*-pe | powerpcle-*-cygwin32)\n \t\ttm_file=rs6000/cygwin32.h\n-\t\txm_file=rs6000/xm-cygwin32.h\n+\t\txm_file=\"rs6000/xm-cygwin32.h ${xm_file}\"\n+\t\txm_defines=NO_STAB_H\n \t\ttmake_file=rs6000/t-winnt\n \t\txmake_file=rs6000/x-cygwin32\n #\t\textra_objs=pe.o\n@@ -2256,15 +2322,21 @@ for machine in $build $host $target; do\n \t\t;;\n \tpowerpcle-*-solaris2*)\n \t\ttm_file=rs6000/sol2.h\n-\t\txm_file=rs6000/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h rs6000/xm-sysv4.h\"\n+\t\txm_defines=\"USG POSIX\"\n \t\tif [[ x$gas = xyes ]]\n \t\tthen\n \t\t\ttmake_file=\"rs6000/t-ppcos rs6000/t-ppccomm\"\n \t\telse\n \t\t\ttmake_file=\"rs6000/t-ppc rs6000/t-ppccomm\"\n \t\tfi\n \t\txmake_file=rs6000/x-sysv4\n-\t\tfixincludes=fixinc.math\n+\t\tcase $machine in\n+\t\t*-*-solaris2.[[0-4]])\n+\t\t\tfixincludes=fixinc.svr4;;\n+\t\t*)\n+\t\t\tfixincludes=fixinc.math;;\n+\t\tesac\n \t\textra_headers=ppc-asm.h\n \t\t;;\n \trs6000-ibm-aix3.[[01]]*)\n@@ -2301,7 +2373,7 @@ for machine in $build $host $target; do\n \t\t;;\n \trs6000-*-mach*)\n \t\ttm_file=rs6000/mach.h\n-\t\txm_file=rs6000/xm-mach.h\n+\t\txm_file=\"${xm_file} rs6000/xm-mach.h\"\n \t\txmake_file=rs6000/x-mach\n \t\tuse_collect2=yes\n \t\t;;\n@@ -2326,7 +2398,8 @@ for machine in $build $host $target; do\n \t\t;;\n \tsparc-tti-*)\n \t\ttm_file=sparc/pbd.h\n-\t\txm_file=sparc/xm-pbd.h\n+\t\txm_file=\"xm-alloca.h ${xm_file}\"\n+\t\txm_defines=USG\n \t\t;;\n \tsparc-wrs-vxworks* | sparclite-wrs-vxworks*)\n \t\ttm_file=sparc/vxsparc.h\n@@ -2355,14 +2428,14 @@ for machine in $build $host $target; do\n \t\tfloat_format=i64\n \t\t;;\n \tsparc-*-linux-gnuaout*)\t\t# Sparc's running GNU/Linux, a.out\n-\t\txm_file=\"sparc/xm-sparc.h sparc/xm-linux.h\"\n+\t\txm_file=\"${xm_file} sparc/xm-linux.h\"\n \t\ttm_file=sparc/linux-aout.h\n \t\txmake_file=x-linux\n \t\tfixincludes=Makefile.in #On Linux, the headers are ok already.\n \t\tgnu_ld=yes\n \t\t;;\n \tsparc-*-linux-gnulibc1*)\t# Sparc's running GNU/Linux, libc5\n-\t\txm_file=\"sparc/xm-sparc.h sparc/xm-linux.h\"\n+\t\txm_file=\"${xm_file} sparc/xm-linux.h\"\n \t\txmake_file=x-linux\n \t\ttm_file=sparc/linux.h\n \t\ttmake_file=\"t-linux t-linux-gnulibc1\"\n@@ -2371,7 +2444,7 @@ for machine in $build $host $target; do\n \t\tgnu_ld=yes\n \t\t;;\n \tsparc-*-linux-gnu*)\t\t# Sparc's running GNU/Linux, libc6\n-\t\txm_file=\"sparc/xm-sparc.h sparc/xm-linux.h\"\n+\t\txm_file=\"${xm_file} sparc/xm-linux.h\"\n \t\txmake_file=x-linux\n \t\ttm_file=sparc/linux.h\n \t\ttmake_file=\"t-linux\"\n@@ -2404,13 +2477,17 @@ for machine in $build $host $target; do\n \t\telse\n \t\t\ttm_file=sparc/sol2-sld.h\n \t\tfi\n-\t\txm_file=sparc/xm-sol2.h\n+\t\txm_file=\"sparc/xm-sysv4.h sparc/xm-sol2.h\"\n \t\ttmake_file=sparc/t-sol2\n \t\txmake_file=sparc/x-sysv4\n \t\textra_parts=\"crt1.o crti.o crtn.o gcrt1.o gmon.o crtbegin.o crtend.o\"\n-\t\tfixincludes=fixinc.svr4\n+\t\tcase $machine in\n+\t\t*-*-solaris2.[[0-4]])\n+\t\t\tfixincludes=fixinc.svr4;;\n+\t\t*)\n+\t\t\tfixincludes=fixinc.math;;\n+\t\tesac\n \t\tfloat_format=i128\n-\t\tbroken_install=yes\n \t\tif [[ x${enable_threads} = x ]]; then\n \t\t    enable_threads=$have_pthread_h\n \t\t    if [[ x${enable_threads} = x ]]; then\n@@ -2444,13 +2521,14 @@ for machine in $build $host $target; do\n \t\t;;\n \tsparc-*-sysv4*)\n \t\ttm_file=sparc/sysv4.h\n-\t\txm_file=sparc/xm-sysv4.h\n+\t\txm_file=\"xm-siglist.h sparc/xm-sysv4.h\"\n+\t\txm_defines=\"USG POSIX\"\n \t\ttmake_file=t-svr4\n \t\txmake_file=sparc/x-sysv4\n \t\textra_parts=\"crtbegin.o crtend.o\"\n \t\t;;\n \tsparc-*-vxsim*)\n-\t\txm_file=sparc/xm-sol2.h\n+\t\txm_file=\"sparc/xm-sysv4.h sparc/xm-sol2.h\"\n \t\ttm_file=sparc/vxsim.h\n \t\ttmake_file=sparc/t-vxsparc\n \t\txmake_file=sparc/x-sysv4\n@@ -2518,7 +2596,7 @@ for machine in $build $host $target; do\n \t\t;;\n \tvax-*-sysv*)\t\t\t# vaxen running system V\n \t\ttm_file=\"${tm_file} vax/vaxv.h\"\n-\t\txm_file=\"${xm_file} vax/xm-vaxv.h\"\n+\t\txm_defines=USG\n \t\tfloat_format=vax\n \t\t;;\n \tvax-*-netbsd*)\n@@ -2553,12 +2631,12 @@ for machine in $build $host $target; do\n \n \tcase $machine in\n \t*-*-linux-gnu*)\n-\t        ;; # Existing Linux/GNU systems do not use the GNU setup.\n+\t        ;; # Existing GNU/Linux systems do not use the GNU setup.\n \t*-*-gnu*)\n \t\t# On the GNU system, the setup is just about the same on\n \t\t# each different CPU.  The specific machines that GNU\n \t\t# supports are matched above and just set $cpu_type.\n-\t\txm_file=${cpu_type}/xm-gnu.h\n+\t\txm_file=\"xm-gnu.h ${xm_file}\"\n \t\ttm_file=${cpu_type}/gnu.h\n \t\textra_parts=\"crtbegin.o crtend.o crtbeginS.o crtendS.o\"\n \t\t# GNU always uses ELF.\n@@ -2581,7 +2659,7 @@ for machine in $build $host $target; do\n \t\t;;\n \tesac\n \n-\t# Distinguish i[3456]86\n+\t# Distinguish i[34567]86\n \t# Also, do not run mips-tfile on MIPS if using gas.\n \t# Process --with-cpu= for PowerPC/rs6000\n \ttarget_cpu_default2=\n@@ -2592,7 +2670,7 @@ for machine in $build $host $target; do\n \ti586-*-*)\n \t\ttarget_cpu_default2=2\n \t\t;;\n-\ti686-*-*)\n+\ti686-*-* | i786-*-*)\n \t\ttarget_cpu_default2=3\n \t\t;;\n \talpha*-*-*)\n@@ -2739,6 +2817,7 @@ for machine in $build $host $target; do\n \t\tthen build_xm_file=$cpu_type/xm-$cpu_type.h\n \t\telse build_xm_file=$xm_file\n \t\tfi\n+\t\tbuild_xm_defines=$xm_defines\n \t\tbuild_install_headers_dir=$install_headers_dir\n \t\tbuild_exeext=$exeext\n \t\tpass1done=yes\n@@ -2749,6 +2828,7 @@ for machine in $build $host $target; do\n \t\t\tthen host_xm_file=$cpu_type/xm-$cpu_type.h\n \t\t\telse host_xm_file=$xm_file\n \t\t\tfi\n+\t\t\thost_xm_defines=$xm_defines\n \t\t\tif [[ x\"$xmake_file\" = x ]]\n \t\t\tthen xmake_file=$cpu_type/x-$cpu_type\n \t\t\tfi\n@@ -2854,6 +2934,7 @@ fi\n # $vars is the list of shell variables with file names to include.\n # auto-conf.h is the file containing items generated by autoconf and is\n # the first file included by config.h.\n+null_defines=\n host_xm_file=\"auto-config.h ${host_xm_file}\"\n \n # If host=build, it is correct to have hconfig include auto-conf.h\n@@ -2866,16 +2947,17 @@ fi\n \n vars=\"host_xm_file tm_file xm_file build_xm_file\"\n links=\"config.h tm.h tconfig.h hconfig.h\"\n+defines=\"host_xm_defines null_defines xm_defines build_xm_defines\"\n \n rm -f config.bak\n if [[ -f config.status ]]; then mv -f config.status config.bak; fi\n \n # Make the links.\n while [[ -n \"$vars\" ]]\n do\n-\t# set file to car of files, files to cdr of files\n \tset $vars; var=$1; shift; vars=$*\n \tset $links; link=$1; shift; links=$*\n+\tset $defines; define=$1; shift; defines=$*\n \n \trm -f $link\n \n@@ -2889,6 +2971,12 @@ do\n \tfor file in `eval echo '$'$var`; do\n \t\techo \"#include \\\"$file\\\"\" >>$link\n \tdone\n+\n+\tfor def in `eval echo '$'$define`; do\n+\t\techo \"#ifndef $def\" >>$link\n+\t\techo \"#define $def\" >>$link\n+\t\techo \"#endif\" >>$link\n+\tdone\n done\n \n # Truncate the target if necessary\n@@ -2935,12 +3023,18 @@ done\n # FLAGS_TO_PASS so CC=\"stage1/xgcc -Bstage1/\" works.\n # Otherwise, we can use \"CC=$(CC)\".\n rm -f symtest.tem\n-if $symbolic_link symtest1.tem symtest.tem 2>/dev/null\n+if $symbolic_link $srcdir/gcc.c symtest.tem 2>/dev/null\n then\n \tcc_set_by_configure=\"\\$(CC)\"\n \tstage_prefix_set_by_configure=\"\\$(STAGE_PREFIX)\"\n else\n-\tsymbolic_link=\"cp -p\"\n+\trm -f symtest.tem\n+\tif cp -p $srcdir/gcc.c symtest.tem 2>/dev/null\n+\tthen\n+\t\tsymbolic_link=\"cp -p\"\n+\telse\n+\t\tsymbolic_link=\"cp\"\n+\tfi\n \tcc_set_by_configure=\"\\`case '\\$(CC)' in stage*) echo '\\$(CC)' | sed -e 's|stage|../stage|g';; *) echo '\\$(CC)';; esac\\`\"\n \tstage_prefix_set_by_configure=\"\\`case '\\$(STAGE_PREFIX)' in stage*) echo '\\$(STAGE_PREFIX)' | sed -e 's|stage|../stage|g';; *) echo '\\$(STAGE_PREFIX)';; esac\\`\"\n fi\n@@ -3298,6 +3392,11 @@ then\n \techo \" ${str2}${str3}.\" 1>&2\n fi\n \n+# Truncate the target if necessary\n+if [[ x$host_truncate_target != x ]]; then\n+\ttarget=`echo $target | sed -e 's/\\(..............\\).*/\\1/'`\n+fi\n+\n # Configure the subdirectories\n # AC_CONFIG_SUBDIRS($subdirs)\n "}]}