{"sha": "146135d6db182282472ae6bf16b051128c0db85b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTQ2MTM1ZDZkYjE4MjI4MjQ3MmFlNmJmMTZiMDUxMTI4YzBkYjg1Yg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-09T22:05:54Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-09T22:05:54Z"}, "message": "(cse_basic_block): Fix test for whether block ends with a barrier.\n\nReturn next insn, not 0, if block ends in a barrier.\n\nFrom-SVN: r9916", "tree": {"sha": "6f75a911763f98b0bd355f08d8888663e6a65f1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6f75a911763f98b0bd355f08d8888663e6a65f1c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/146135d6db182282472ae6bf16b051128c0db85b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/146135d6db182282472ae6bf16b051128c0db85b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/146135d6db182282472ae6bf16b051128c0db85b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/146135d6db182282472ae6bf16b051128c0db85b/comments", "author": null, "committer": null, "parents": [{"sha": "138c94ea17d7d83587a3cac9978124967ba1b5b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/138c94ea17d7d83587a3cac9978124967ba1b5b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/138c94ea17d7d83587a3cac9978124967ba1b5b7"}], "stats": {"total": 21, "additions": 12, "deletions": 9}, "files": [{"sha": "7f610cea7c5556f67b1fe923cadb724319280a6c", "filename": "gcc/cse.c", "status": "modified", "additions": 12, "deletions": 9, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/146135d6db182282472ae6bf16b051128c0db85b/gcc%2Fcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/146135d6db182282472ae6bf16b051128c0db85b/gcc%2Fcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcse.c?ref=146135d6db182282472ae6bf16b051128c0db85b", "patch": "@@ -8429,22 +8429,25 @@ cse_basic_block (from, to, next_branch, around_loop)\n \t  && GET_CODE (to) == CODE_LABEL && --LABEL_NUSES (to) == to_usage)\n \t{\n \t  struct cse_basic_block_data val;\n+\t  rtx prev;\n \n \t  insn = NEXT_INSN (to);\n \n \t  if (LABEL_NUSES (to) == 0)\n-\t    delete_insn (to);\n+\t    insn = delete_insn (to);\n \n-\t  /* Find the end of the following block.  Note that we won't be\n-\t     following branches in this case.  If TO was the last insn\n-\t     in the function, we are done.  Similarly, if we deleted the\n-\t     insn after TO, it must have been because it was preceded by\n-\t     a BARRIER.  In that case, we are done with this block because it\n-\t     has no continuation.  */\n-\n-\t  if (insn == 0 || INSN_DELETED_P (insn))\n+\t  /* If TO was the last insn in the function, we are done.  */\n+\t  if (insn == 0)\n \t    return 0;\n \n+\t  /* If TO was preceded by a BARRIER we are done with this block\n+\t     because it has no continuation.  */\n+\t  prev = prev_nonnote_insn (to);\n+\t  if (prev && GET_CODE (prev) == BARRIER)\n+\t    return insn;\n+\n+\t  /* Find the end of the following block.  Note that we won't be\n+\t     following branches in this case.  */\n \t  to_usage = 0;\n \t  val.path_size = 0;\n \t  cse_end_of_basic_block (insn, &val, 0, 0, 0);"}]}