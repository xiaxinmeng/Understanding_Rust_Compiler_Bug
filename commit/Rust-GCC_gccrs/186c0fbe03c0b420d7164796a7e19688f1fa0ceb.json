{"sha": "186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTg2YzBmYmUwM2MwYjQyMGQ3MTY0Nzk2YTdlMTk2ODhmMWZhMGNlYg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2001-01-09T11:37:07Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2001-01-09T11:37:07Z"}, "message": "class.c (handle_using_decl): Reject using of constructor name of sourcing class.\n\ncp:\n\t* class.c (handle_using_decl): Reject using of constructor name\n\tof sourcing class. Allow injecting of a method with same name as\n\tnested class. Fixup error messages.\ntestsuite:\n\t* g++.old_deja/g++.pt/using8.C: New test.\n\nFrom-SVN: r38831", "tree": {"sha": "e130c908745dc3ab0bc23e553a26fbe7056fcfea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e130c908745dc3ab0bc23e553a26fbe7056fcfea"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/comments", "author": null, "committer": null, "parents": [{"sha": "10a855c7f4b3347a55198395ff12f8847f0c33c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/10a855c7f4b3347a55198395ff12f8847f0c33c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/10a855c7f4b3347a55198395ff12f8847f0c33c6"}], "stats": {"total": 69, "additions": 64, "deletions": 5}, "files": [{"sha": "fe4ee2032c001cb336300537c0ca016ea361cfdb", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "patch": "@@ -1,3 +1,9 @@\n+2001-01-09  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* class.c (handle_using_decl): Reject using of constructor name\n+\tof sourcing class. Allow injecting of a method with same name as\n+\tnested class. Fixup error messages.\n+\n 2001-01-09  Joseph S. Myers  <jsm28@cam.ac.uk>\n \n \t* decl2.c (lang_decode_option): Handle -Wformat=2."}, {"sha": "ada9779ec93f3e26aeef7c6bb02b663d52eb0d4e", "filename": "gcc/cp/class.c", "status": "modified", "additions": 11, "deletions": 5, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "patch": "@@ -1527,7 +1527,13 @@ handle_using_decl (using_decl, t)\n   if (name == constructor_name (ctype)\n       || name == constructor_name_full (ctype))\n     {\n-      cp_error_at (\"using-declaration for constructor\", using_decl);\n+      cp_error_at (\"`%D' names constructor\", using_decl);\n+      return;\n+    }\n+  if (name == constructor_name (t)\n+      || name == constructor_name_full (t))\n+    {\n+      cp_error_at (\"`%D' invalid in `%T'\", using_decl, t);\n       return;\n     }\n \n@@ -1567,16 +1573,16 @@ handle_using_decl (using_decl, t)\n \t   the same name already present in the current class.  */;\n       else\n \t{\n-\t  cp_error (\"`%D' invalid in `%#T'\", using_decl, t);\n+\t  cp_error_at (\"`%D' invalid in `%#T'\", using_decl, t);\n \t  cp_error_at (\"  because of local method `%#D' with same name\",\n \t\t       OVL_CURRENT (old_value));\n \t  return;\n \t}\n     }\n-  else\n+  else if (!DECL_ARTIFICIAL (old_value))\n     {\n-      cp_error (\"`%D' invalid in `%#T'\", using_decl, t);\n-      cp_error_at (\"  because of local field `%#D' with same name\", old_value);\n+      cp_error_at (\"`%D' invalid in `%#T'\", using_decl, t);\n+      cp_error_at (\"  because of local member `%#D' with same name\", old_value);\n       return;\n     }\n   "}, {"sha": "c47778d31f9e5ca4e37f6286fca021d6ddf92e86", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "patch": "@@ -1,3 +1,7 @@\n+2001-01-09  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.old_deja/g++.pt/using8.C: New test.\n+\n 2001-01-09  Joseph S. Myers  <jsm28@cam.ac.uk>\n \n \t* gcc.dg/format/attr-2.c, gcc.dg/format/attr-3.c: New tests."}, {"sha": "1dc29de1cb033619d301069ae5cbdba0639b9af7", "filename": "gcc/testsuite/g++.old-deja/g++.other/using8.C", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fusing8.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/186c0fbe03c0b420d7164796a7e19688f1fa0ceb/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fusing8.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fusing8.C?ref=186c0fbe03c0b420d7164796a7e19688f1fa0ceb", "patch": "@@ -0,0 +1,43 @@\n+// Build don't link:\n+\n+// Copyright (C) 2000 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 14 Nov 2000 <nathan@codesourcery.com>\n+\n+// We rejected using decls bringing in functions from a base which would hide a\n+// nested class of the same name, but only if we had no functions by that name\n+// already. Also, we failed to find that using declaration during lookup. Also\n+// we failed to reject using declarations which matched the constructor name.\n+\n+struct A\n+{\n+  int f ();\n+  void D ();\n+};\n+\n+struct A2 {\n+  typedef int f;\n+};\n+\n+struct B : A \n+{\n+  using A::f;\n+  struct f {};\n+};\n+\n+struct C : A \n+{\n+  using A::f;\n+  int f (int);\n+  struct f {};\n+};\n+\n+void foo (B *bp, C* cp)\n+{\n+  bp->f ();\n+  cp->f ();\n+}\n+\n+struct D : A\n+{\n+  using A::D;   // ERROR - names constructor\n+};"}]}