{"sha": "5f395580078d31f52b920a46a723da54c080a04e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWYzOTU1ODAwNzhkMzFmNTJiOTIwYTQ2YTcyM2RhNTRjMDgwYTA0ZQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2016-11-09T09:22:52Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2016-11-09T09:22:52Z"}, "message": "re PR fortran/71894 ([OOP] ICE in gfc_add_component_ref, at fortran/class.c:227)\n\n2016-11-09  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/71894\n\t* class.c (gfc_add_component_ref): Add safety checks to avoid ICE.\n\n2016-11-09  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/71894\n\t* gfortran.dg/class_59.f90: New test.\n\nFrom-SVN: r241993", "tree": {"sha": "330b6280c13ed8c8598700f1b8fc0611247f2631", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/330b6280c13ed8c8598700f1b8fc0611247f2631"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5f395580078d31f52b920a46a723da54c080a04e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f395580078d31f52b920a46a723da54c080a04e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f395580078d31f52b920a46a723da54c080a04e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f395580078d31f52b920a46a723da54c080a04e/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "37b141851078b5119156780c2d897639d483625b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37b141851078b5119156780c2d897639d483625b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37b141851078b5119156780c2d897639d483625b"}], "stats": {"total": 38, "additions": 37, "deletions": 1}, "files": [{"sha": "6c39866487f8f614ff4c87face3ff0377607e8f4", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=5f395580078d31f52b920a46a723da54c080a04e", "patch": "@@ -1,3 +1,8 @@\n+2016-11-09  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/71894\n+\t* class.c (gfc_add_component_ref): Add safety checks to avoid ICE.\n+\n 2016-11-08  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/68440"}, {"sha": "b7f68d2f19a5240ebab4a2b5d935b64e59b2e3c7", "filename": "gcc/fortran/class.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ffortran%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ffortran%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fclass.c?ref=5f395580078d31f52b920a46a723da54c080a04e", "patch": "@@ -224,7 +224,8 @@ gfc_add_component_ref (gfc_expr *e, const char *name)\n \tbreak;\n       tail = &((*tail)->next);\n     }\n-  if (derived->components->next->ts.type == BT_DERIVED &&\n+  if (derived->components && derived->components->next &&\n+      derived->components->next->ts.type == BT_DERIVED &&\n       derived->components->next->ts.u.derived == NULL)\n     {\n       /* Fix up missing vtype.  */"}, {"sha": "43586a91430829ce733398d6efb8a7fe88755991", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5f395580078d31f52b920a46a723da54c080a04e", "patch": "@@ -1,3 +1,8 @@\n+2016-11-09  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/71894\n+\t* gfortran.dg/class_59.f90: New test.\n+\n 2016-11-09  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/78007"}, {"sha": "e077ef8dc302e49a40b19109634ea3fd2584729d", "filename": "gcc/testsuite/gfortran.dg/class_59.f90", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_59.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f395580078d31f52b920a46a723da54c080a04e/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_59.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_59.f90?ref=5f395580078d31f52b920a46a723da54c080a04e", "patch": "@@ -0,0 +1,25 @@\n+! { dg-do compile }\n+!\n+! PR 71894: [OOP] ICE in gfc_add_component_ref, at fortran/class.c:227\n+!\n+! Contributed by Gerhard Steinmetz <gerhard.steinmetz.fortran@t-online.de>\n+\n+subroutine s1\n+  type t\n+    integer :: n\n+  end type\n+  type(t) :: x\n+  class(t) :: y  ! { dg-error \"must be dummy, allocatable or pointer\" }\n+  x = y\n+end\n+\n+subroutine s2\n+  type t\n+  end type\n+  class(t) :: x    ! { dg-error \"must be dummy, allocatable or pointer\" }\n+  class(t), allocatable :: y\n+  select type (y)\n+  type is (t)\n+    y = x\n+  end select\n+end"}]}