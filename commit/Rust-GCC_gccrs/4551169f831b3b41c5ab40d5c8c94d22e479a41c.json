{"sha": "4551169f831b3b41c5ab40d5c8c94d22e479a41c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDU1MTE2OWY4MzFiM2I0MWM1YWI0MGQ1YzhjOTRkMjJlNDc5YTQxYw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard@codesourcery.com", "date": "2006-10-29T11:13:14Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2006-10-29T11:13:14Z"}, "message": "configure.ac (HAVE_AS_NO_SHARED): New AC_DEFINE.\n\ngcc/\n\t* configure.ac (HAVE_AS_NO_SHARED): New AC_DEFINE.  Test for the\n\t-mno-shared assembler option on mips targets.\n\t* configure, config.in: Regenerate.\n\t* config/mips/linux.h (NO_SHARED_SPECS): New macro.\n\t(DRIVER_SELF_SPECS): Define to NO_SHARED_SPECS if non-empty.\n\t* config/mips/linux64.h (DRIVER_SELF_SPECS): Include NO_SHARED_SPECS.\n\nFrom-SVN: r118138", "tree": {"sha": "bf8f66085211cfd059a02f06010d2a8b21c8d8da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bf8f66085211cfd059a02f06010d2a8b21c8d8da"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4551169f831b3b41c5ab40d5c8c94d22e479a41c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4551169f831b3b41c5ab40d5c8c94d22e479a41c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4551169f831b3b41c5ab40d5c8c94d22e479a41c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4551169f831b3b41c5ab40d5c8c94d22e479a41c/comments", "author": null, "committer": null, "parents": [{"sha": "5f687d19e06bbdeccc7a0b6d831ae884d177b522", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f687d19e06bbdeccc7a0b6d831ae884d177b522", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f687d19e06bbdeccc7a0b6d831ae884d177b522"}], "stats": {"total": 66, "additions": 66, "deletions": 0}, "files": [{"sha": "ce69fe704c5e8d74ddf9ebb54086a58ec80878a6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4551169f831b3b41c5ab40d5c8c94d22e479a41c", "patch": "@@ -1,3 +1,12 @@\n+2006-10-29  Richard Sandiford  <richard@codesourcery.com>\n+\n+\t* configure.ac (HAVE_AS_NO_SHARED): New AC_DEFINE.  Test for the\n+\t-mno-shared assembler option on mips targets.\n+\t* configure, config.in: Regenerate.\n+\t* config/mips/linux.h (NO_SHARED_SPECS): New macro.\n+\t(DRIVER_SELF_SPECS): Define to NO_SHARED_SPECS if non-empty.\n+\t* config/mips/linux64.h (DRIVER_SELF_SPECS): Include NO_SHARED_SPECS.\n+\n 2006-10-29  Richard Sandiford  <richard@codesourcery.com>\n \n \t* config/mips/mips.c (mips_classify_symbol): Test DECL_WEAK as well"}, {"sha": "2fc11775ddece115f4ecd3a6a11a7043229ff58e", "filename": "gcc/config.in", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=4551169f831b3b41c5ab40d5c8c94d22e479a41c", "patch": "@@ -239,6 +239,12 @@\n #endif\n \n \n+/* Define if the assembler understands -mno-shared. */\n+#ifndef USED_FOR_TARGET\n+#undef HAVE_AS_NO_SHARED\n+#endif\n+\n+\n /* Define if your assembler supports offsetable %lo(). */\n #ifndef USED_FOR_TARGET\n #undef HAVE_AS_OFFSETABLE_LO10"}, {"sha": "f84867a1cf3be3cd6894d0e2d57545f3e27a463f", "filename": "gcc/config/mips/linux.h", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfig%2Fmips%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfig%2Fmips%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Flinux.h?ref=4551169f831b3b41c5ab40d5c8c94d22e479a41c", "patch": "@@ -179,3 +179,12 @@ Boston, MA 02110-1301, USA.  */\n   %{profile:-lc_p} %{!profile: -lc}}\"\n \n #define MD_UNWIND_SUPPORT \"config/mips/linux-unwind.h\"\n+\n+#ifdef HAVE_AS_NO_SHARED\n+/* Default to -mno-shared for non-PIC.  */\n+#define NO_SHARED_SPECS \\\n+  \"%{mshared|mno-shared|fpic|fPIC|fpie|fPIE:;:-mno-shared}\",\n+#define DRIVER_SELF_SPECS NO_SHARED_SPECS\n+#else\n+#define NO_SHARED_SPECS\n+#endif"}, {"sha": "8c189ffa9cbefcb25446a080bec2ac4bcaa01e36", "filename": "gcc/config/mips/linux64.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfig%2Fmips%2Flinux64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfig%2Fmips%2Flinux64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Flinux64.h?ref=4551169f831b3b41c5ab40d5c8c94d22e479a41c", "patch": "@@ -21,7 +21,9 @@ Boston, MA 02110-1301, USA.  */\n \n /* Force the default endianness and ABI flags onto the command line\n    in order to make the other specs easier to write.  */\n+#undef DRIVER_SELF_SPECS\n #define DRIVER_SELF_SPECS \\\n+NO_SHARED_SPECS \\\n \"%{!EB:%{!EL:%(endian_spec)}}\", \\\n \"%{!mabi=*: -mabi=n32}\"\n "}, {"sha": "cbf94b59f806613e3d5bb532acee78c767ccbb69", "filename": "gcc/configure", "status": "modified", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=4551169f831b3b41c5ab40d5c8c94d22e479a41c", "patch": "@@ -15589,6 +15589,42 @@ if test $gcc_cv_as_mips_explicit_relocs = yes; then\n        then target_cpu_default=MASK_EXPLICIT_RELOCS\n        else target_cpu_default=\"($target_cpu_default)|MASK_EXPLICIT_RELOCS\"\n        fi\n+fi\n+    echo \"$as_me:$LINENO: checking assembler for -mno-shared support\" >&5\n+echo $ECHO_N \"checking assembler for -mno-shared support... $ECHO_C\" >&6\n+if test \"${gcc_cv_as_mips_no_shared+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  gcc_cv_as_mips_no_shared=no\n+    if test $in_tree_gas = yes; then\n+    if test $gcc_cv_gas_vers -ge `expr \\( \\( 2 \\* 1000 \\) + 16 \\) \\* 1000 + 0`\n+  then gcc_cv_as_mips_no_shared=yes\n+fi\n+  elif test x$gcc_cv_as != x; then\n+    echo 'nop' > conftest.s\n+    if { ac_try='$gcc_cv_as -mno-shared -o conftest.o conftest.s >&5'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }\n+    then\n+\tgcc_cv_as_mips_no_shared=yes\n+    else\n+      echo \"configure: failed program was\" >&5\n+      cat conftest.s >&5\n+    fi\n+    rm -f conftest.o conftest.s\n+  fi\n+fi\n+echo \"$as_me:$LINENO: result: $gcc_cv_as_mips_no_shared\" >&5\n+echo \"${ECHO_T}$gcc_cv_as_mips_no_shared\" >&6\n+if test $gcc_cv_as_mips_no_shared = yes; then\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define HAVE_AS_NO_SHARED 1\n+_ACEOF\n+\n fi\n     ;;\n esac"}, {"sha": "0b42531ff6d5f751279231bb5e7a95456fa586e2", "filename": "gcc/configure.ac", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4551169f831b3b41c5ab40d5c8c94d22e479a41c/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=4551169f831b3b41c5ab40d5c8c94d22e479a41c", "patch": "@@ -2952,6 +2952,10 @@ LCF0:\n        then target_cpu_default=MASK_EXPLICIT_RELOCS\n        else target_cpu_default=\"($target_cpu_default)|MASK_EXPLICIT_RELOCS\"\n        fi])\n+    gcc_GAS_CHECK_FEATURE([-mno-shared support],\n+      gcc_cv_as_mips_no_shared, [2,16,0], [-mno-shared], [nop],,\n+      [AC_DEFINE(HAVE_AS_NO_SHARED, 1,\n+\t\t [Define if the assembler understands -mno-shared.])])\n     ;;\n esac\n "}]}