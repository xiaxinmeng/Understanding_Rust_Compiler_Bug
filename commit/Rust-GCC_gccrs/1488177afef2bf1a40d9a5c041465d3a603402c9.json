{"sha": "1488177afef2bf1a40d9a5c041465d3a603402c9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTQ4ODE3N2FmZWYyYmYxYTQwZDlhNWMwNDE0NjVkM2E2MDM0MDJjOQ==", "commit": {"author": {"name": "Mike Stump", "email": "mrs@apple.com", "date": "2005-03-24T00:45:38Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2005-03-24T00:45:38Z"}, "message": "darwin.S: Update for -m64 multilib.\n\n        * src/powerpc/darwin.S: Update for -m64 multilib.\n        * src/powerpc/darwin_closure.S: Likewise.\n\nFrom-SVN: r96967", "tree": {"sha": "352417f09bb9c6a25eaefac030604021a423f2fa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/352417f09bb9c6a25eaefac030604021a423f2fa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1488177afef2bf1a40d9a5c041465d3a603402c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1488177afef2bf1a40d9a5c041465d3a603402c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1488177afef2bf1a40d9a5c041465d3a603402c9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1488177afef2bf1a40d9a5c041465d3a603402c9/comments", "author": null, "committer": null, "parents": [{"sha": "acdf61e19b2cafd54d86ebee519ada2663a388bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/acdf61e19b2cafd54d86ebee519ada2663a388bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/acdf61e19b2cafd54d86ebee519ada2663a388bf"}], "stats": {"total": 68, "additions": 48, "deletions": 20}, "files": [{"sha": "fa801d1539cd8d58cc0e670e92d57c5c0819fc7a", "filename": "libffi/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1488177afef2bf1a40d9a5c041465d3a603402c9/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1488177afef2bf1a40d9a5c041465d3a603402c9/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=1488177afef2bf1a40d9a5c041465d3a603402c9", "patch": "@@ -1,3 +1,8 @@\n+2005-03-23  Mike Stump  <mrs@apple.com>\n+\n+\t* src/powerpc/darwin.S: Update for -m64 multilib.\n+\t* src/powerpc/darwin_closure.S: Likewise.\n+\n 2005-03-21  Zack Weinberg  <zack@codesourcery.com>\n \n \t* configure.ac: Do not invoke TL_AC_GCC_VERSION."}, {"sha": "d8a1df5fe98622783b2cf92d105691e59f97b040", "filename": "libffi/src/powerpc/darwin.S", "status": "modified", "additions": 16, "deletions": 6, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1488177afef2bf1a40d9a5c041465d3a603402c9/libffi%2Fsrc%2Fpowerpc%2Fdarwin.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1488177afef2bf1a40d9a5c041465d3a603402c9/libffi%2Fsrc%2Fpowerpc%2Fdarwin.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fpowerpc%2Fdarwin.S?ref=1488177afef2bf1a40d9a5c041465d3a603402c9", "patch": "@@ -24,6 +24,16 @@\n    OTHER DEALINGS IN THE SOFTWARE.\n    ----------------------------------------------------------------------- */\n \n+#if defined(__ppc64__)\n+#define MODE_CHOICE(x, y) y\n+#else\n+#define MODE_CHOICE(x, y) x\n+#endif\n+\n+#define g_long  MODE_CHOICE(long, quad)         /* usage is \".g_long\" */\n+\n+#define LOG2_GPR_BYTES  MODE_CHOICE(2,3)        /* log2(GPR_BYTES) */\n+\n #define LIBFFI_ASM\n #include <fficonfig.h>\n #include <ffi.h>\n@@ -190,7 +200,7 @@ LSCIE1:\n \t.byte\t0xc\t; DW_CFA_def_cfa\n \t.byte\t0x1\t; uleb128 0x1\n \t.byte\t0x0\t; uleb128 0x0\n-\t.align\t2\n+\t.align\tLOG2_GPR_BYTES\n LECIE1:\n .globl _ffi_call_DARWIN.eh\n _ffi_call_DARWIN.eh:\n@@ -199,9 +209,9 @@ LSFDE1:\n \t.long\tL$set$1\t; FDE Length\n LASFDE1:\n \t.long\tLASFDE1-EH_frame1 ; FDE CIE offset\n-\t.long\tLLFB0$non_lazy_ptr-.\t; FDE initial location\n+\t.g_long\tLLFB0$non_lazy_ptr-.\t; FDE initial location\n \t.set\tL$set$3,LFE1-LFB0\n-\t.long\tL$set$3\t; FDE address range\n+\t.g_long\tL$set$3\t; FDE address range\n \t.byte   0x0     ; uleb128 0x0; Augmentation size\n \t.byte\t0x4\t; DW_CFA_advance_loc4\n \t.set\tL$set$4,LCFI0-LFB1\n@@ -227,9 +237,9 @@ LASFDE1:\n \t.long\tL$set$6\n \t.byte\t0xd\t; DW_CFA_def_cfa_register\n \t.byte\t0x1c\t; uleb128 0x1c\n-\t.align 2\n+\t.align LOG2_GPR_BYTES\n LEFDE1:\n .data\n-\t.align 2\n+\t.align LOG2_GPR_BYTES\n LLFB0$non_lazy_ptr:\n-\t.long   LFB0\n+\t.g_long LFB0"}, {"sha": "7959838e95bd154dff8d0be330cc1f4efdcc962f", "filename": "libffi/src/powerpc/darwin_closure.S", "status": "modified", "additions": 27, "deletions": 14, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1488177afef2bf1a40d9a5c041465d3a603402c9/libffi%2Fsrc%2Fpowerpc%2Fdarwin_closure.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1488177afef2bf1a40d9a5c041465d3a603402c9/libffi%2Fsrc%2Fpowerpc%2Fdarwin_closure.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fpowerpc%2Fdarwin_closure.S?ref=1488177afef2bf1a40d9a5c041465d3a603402c9", "patch": "@@ -27,13 +27,25 @@\n #define LIBFFI_ASM\n #define L(x) x\n \n+#if defined(__ppc64__)\n+#define MODE_CHOICE(x, y) y\n+#else\n+#define MODE_CHOICE(x, y) x\n+#endif\n+\n+#define lgu     MODE_CHOICE(lwzu, ldu)\n+\n+#define g_long  MODE_CHOICE(long, quad)         /* usage is \".g_long\" */\n+\n+#define LOG2_GPR_BYTES  MODE_CHOICE(2,3)        /* log2(GPR_BYTES) */\n+\n \t.file\t\"darwin_closure.S\"\n .text\n-\t.align 2\n+\t.align LOG2_GPR_BYTES\n .globl _ffi_closure_ASM\n \n .text\n-\t.align 2\n+\t.align LOG2_GPR_BYTES\n _ffi_closure_ASM:\n LFB1:\n \tmflr\tr0\t\t/* extract return address  */\n@@ -234,7 +246,7 @@ Lfinish:\n /* END(ffi_closure_ASM)  */\n \n .data\n-.section __TEXT,__eh_frame,coalesced,no_toc+strip_static_syms\n+.section __TEXT,__eh_frame,coalesced,no_toc+strip_static_syms+live_support\n EH_frame1:\n \t.set\tL$set$0,LECIE1-LSCIE1\n \t.long\tL$set$0\t; Length of Common Information Entry\n@@ -250,7 +262,7 @@ LSCIE1:\n \t.byte\t0xc\t; DW_CFA_def_cfa\n \t.byte\t0x1\t; uleb128 0x1\n \t.byte\t0x0\t; uleb128 0x0\n-\t.align\t2\n+\t.align\tLOG2_GPR_BYTES\n LECIE1:\n .globl _ffi_closure_ASM.eh\n _ffi_closure_ASM.eh:\n@@ -260,9 +272,9 @@ LSFDE1:\n \n LASFDE1:\n \t.long\tLASFDE1-EH_frame1\t; FDE CIE offset\n-\t.long\tLLFB1$non_lazy_ptr-.\t; FDE initial location\n+\t.g_long\tLLFB1$non_lazy_ptr-.\t; FDE initial location\n \t.set\tL$set$3,LFE1-LFB1\n-\t.long\tL$set$3\t; FDE address range\n+\t.g_long\tL$set$3\t; FDE address range\n \t.byte   0x0     ; uleb128 0x0; Augmentation size\n \t.byte\t0x4\t; DW_CFA_advance_loc4\n \t.set\tL$set$3,LCFI1-LCFI0\n@@ -275,30 +287,31 @@ LASFDE1:\n \t.byte   0x11    ; DW_CFA_offset_extended_sf\n \t.byte\t0x41\t; uleb128 0x41\n \t.byte   0x7e    ; sleb128 -2\n-\t.align\t2\n+\t.align\tLOG2_GPR_BYTES\n LEFDE1:\n .data\n-\t.align\t2\n+\t.align\tLOG2_GPR_BYTES\n LDFCM0:\n .section __TEXT,__picsymbolstub1,symbol_stubs,pure_instructions,32\n-\t.align\t2\n+\t.align\tLOG2_GPR_BYTES\n Lffi_closure_helper_DARWIN$stub:\n+#if 1\n \t.indirect_symbol _ffi_closure_helper_DARWIN\n \tmflr\tr0\n \tbcl\t20,31,LO$ffi_closure_helper_DARWIN\n LO$ffi_closure_helper_DARWIN:\n \tmflr\tr11\n \taddis\tr11,r11,ha16(L_ffi_closure_helper_DARWIN$lazy_ptr - LO$ffi_closure_helper_DARWIN)\n \tmtlr\tr0\n-\tlwzu\tr12,lo16(L_ffi_closure_helper_DARWIN$lazy_ptr - LO$ffi_closure_helper_DARWIN)(r11)\n+\tlgu\tr12,lo16(L_ffi_closure_helper_DARWIN$lazy_ptr - LO$ffi_closure_helper_DARWIN)(r11)\n \tmtctr\tr12\n \tbctr\n-.data\n .lazy_symbol_pointer\n L_ffi_closure_helper_DARWIN$lazy_ptr:\n \t.indirect_symbol _ffi_closure_helper_DARWIN\n-\t.long   dyld_stub_binding_helper\n+\t.g_long dyld_stub_binding_helper\n+#endif\n .data\n-\t.align 2\n+\t.align LOG2_GPR_BYTES\n LLFB1$non_lazy_ptr:\n-\t.long LFB1\n+\t.g_long LFB1"}]}