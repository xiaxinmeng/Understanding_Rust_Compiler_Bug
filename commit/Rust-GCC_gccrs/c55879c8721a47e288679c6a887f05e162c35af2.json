{"sha": "c55879c8721a47e288679c6a887f05e162c35af2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzU1ODc5Yzg3MjFhNDdlMjg4Njc5YzZhODg3ZjA1ZTE2MmMzNWFmMg==", "commit": {"author": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2016-01-23T23:32:13Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2016-01-23T23:32:13Z"}, "message": "re PR libfortran/68744 (FAIL: gfortran.dg/backtrace_1.f90   -O0  execution test)\n\n\tPR libfortran/68744\n\t* runtime/backtrace.c: Include gthr.h.\n\t(show_backtrace): Use __gthread_active_p() to determine whether threads\n\tare active.  Return if lbstate is NULL.\n\nFrom-SVN: r232770", "tree": {"sha": "b44087841eaf6762c6bc6a3cf8ad284c54367930", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b44087841eaf6762c6bc6a3cf8ad284c54367930"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c55879c8721a47e288679c6a887f05e162c35af2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c55879c8721a47e288679c6a887f05e162c35af2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c55879c8721a47e288679c6a887f05e162c35af2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c55879c8721a47e288679c6a887f05e162c35af2/comments", "author": null, "committer": null, "parents": [{"sha": "3676c0871fa9cb1df58a32f78efd01d2c95d5038", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3676c0871fa9cb1df58a32f78efd01d2c95d5038", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3676c0871fa9cb1df58a32f78efd01d2c95d5038"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "4c7befa2128c99cea165b5cdabda7cbb470dcb59", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c55879c8721a47e288679c6a887f05e162c35af2/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c55879c8721a47e288679c6a887f05e162c35af2/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=c55879c8721a47e288679c6a887f05e162c35af2", "patch": "@@ -1,3 +1,10 @@\n+2016-01-23  John David Anglin  <danglin@gcc.gnu.org>\n+\n+\tPR libfortran/68744\n+\t* runtime/backtrace.c: Include gthr.h.\n+\t(show_backtrace): Use __gthread_active_p() to determine whether threads\n+\tare active.  Return if lbstate is NULL.\n+\n 2016-01-15  Jakub Jelinek  <jakub@redhat.com>\n \n \t* intrinsics/execute_command_line.c (set_cmdstat): Use \"%s\", msg"}, {"sha": "5b8735d53f43554beda91ca0531ba7fa7314000f", "filename": "libgfortran/runtime/backtrace.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c55879c8721a47e288679c6a887f05e162c35af2/libgfortran%2Fruntime%2Fbacktrace.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c55879c8721a47e288679c6a887f05e162c35af2/libgfortran%2Fruntime%2Fbacktrace.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fruntime%2Fbacktrace.c?ref=c55879c8721a47e288679c6a887f05e162c35af2", "patch": "@@ -24,6 +24,8 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n \n #include \"libgfortran.h\"\n \n+#include <gthr.h>\n+\n #include <string.h>\n #include <stdlib.h>\n #include <errno.h>\n@@ -137,7 +139,11 @@ show_backtrace (bool in_signal_handler)\n   struct backtrace_state *lbstate;\n   struct mystate state = { 0, false, in_signal_handler };\n  \n-  lbstate = backtrace_create_state (NULL, 1, error_callback, NULL);\n+  lbstate = backtrace_create_state (NULL, __gthread_active_p (),\n+\t\t\t\t    error_callback, NULL);\n+\n+  if (lbstate == NULL)\n+    return;\n \n   if (!BACKTRACE_SUPPORTED || (in_signal_handler && BACKTRACE_USES_MALLOC))\n     {"}]}