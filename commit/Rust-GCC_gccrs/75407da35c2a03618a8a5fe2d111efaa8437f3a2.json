{"sha": "75407da35c2a03618a8a5fe2d111efaa8437f3a2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzU0MDdkYTM1YzJhMDM2MThhOGE1ZmUyZDExMWVmYWE4NDM3ZjNhMg==", "commit": {"author": {"name": "Seongbae Park", "email": "seongbae.park@gmail.com", "date": "2007-08-16T17:36:01Z"}, "committer": {"name": "Seongbae Park", "email": "spark@gcc.gnu.org", "date": "2007-08-16T17:36:01Z"}, "message": "gcov-5.C: New test.\n\ngcc/testsuite/ChangeLog:\n\n2007-08-16  Seongbae Park <seongbae.park@gmail.com>\n\n        * g++.dg/gcov/gcov-5.C: New test.\n\n\ngcc/cp/ChangeLog:\n\n2007-08-16  Seongbae Park <seongbae.park@gmail.com>\n\n        * pt.c (instantiate_decl): Set input_location\n        for the function end.\n\nFrom-SVN: r127563", "tree": {"sha": "5ad9f2fc9f72f8a25f8dea691fe9dfe93d66f804", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ad9f2fc9f72f8a25f8dea691fe9dfe93d66f804"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75407da35c2a03618a8a5fe2d111efaa8437f3a2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75407da35c2a03618a8a5fe2d111efaa8437f3a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75407da35c2a03618a8a5fe2d111efaa8437f3a2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75407da35c2a03618a8a5fe2d111efaa8437f3a2/comments", "author": null, "committer": null, "parents": [{"sha": "d407ad672934d4cdca932d108fddde8f4a75af97", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d407ad672934d4cdca932d108fddde8f4a75af97", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d407ad672934d4cdca932d108fddde8f4a75af97"}], "stats": {"total": 63, "additions": 63, "deletions": 0}, "files": [{"sha": "89172af26d7846518e557410a84b38bceb782f75", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=75407da35c2a03618a8a5fe2d111efaa8437f3a2", "patch": "@@ -1,3 +1,8 @@\n+2007-08-16  Seongbae Park  <seongbae.park@gmail.com>\n+\n+        * pt.c (instantiate_decl): Set input_location\n+        for the function end.\n+\n 2007-08-16  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* cp-objcp-common.c (cxx_warn_unused_global_decl, cp_expr_size):"}, {"sha": "76d35186f1e04f4e420eb183902f83845a85e693", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=75407da35c2a03618a8a5fe2d111efaa8437f3a2", "patch": "@@ -14440,6 +14440,10 @@ instantiate_decl (tree d, int defer_ok,\n \t\t   tf_warning_or_error, tmpl,\n \t\t   /*integral_constant_expression_p=*/false);\n \n+      /* Set the current input_location to the end of the function\n+         so that finish_function knows where we are.  */\n+      input_location = DECL_STRUCT_FUNCTION (code_pattern)->function_end_locus;\n+\n       /* We don't need the local specializations any more.  */\n       htab_delete (local_specializations);\n       local_specializations = saved_local_specializations;"}, {"sha": "2e4dfb357aa34b3f59f33c9ef8fe9b22c4ca454d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=75407da35c2a03618a8a5fe2d111efaa8437f3a2", "patch": "@@ -1,3 +1,7 @@\n+2007-08-16  Seongbae Park <seongbae.park@gmail.com>\n+\n+        * g++.dg/gcov/gcov-5.C: New test.\n+\n 2007-08-16  Seongbae Park  <seongbae.park@gmail.com>\n \n \t* g++.dg/gcov/gcov-4.C: New test."}, {"sha": "9ada41802caa18381b7c90cb384b2d3cfcd3f5bb", "filename": "gcc/testsuite/g++.dg/gcov/gcov-5.C", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgcov%2Fgcov-5.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75407da35c2a03618a8a5fe2d111efaa8437f3a2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgcov%2Fgcov-5.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgcov%2Fgcov-5.C?ref=75407da35c2a03618a8a5fe2d111efaa8437f3a2", "patch": "@@ -0,0 +1,50 @@\n+/* Check that execution counts for template functions\n+   are reported correctly by gcov. */\n+\n+#include <stdio.h>\n+#include <stdlib.h>\n+\n+/* { dg-options \"-fprofile-arcs -ftest-coverage -fno-inline\" } */\n+/* { dg-do run { target native } } */\n+\n+class A {\n+  int count;\n+ public:\n+  A(int c) { count = c; }\n+  void func(void) { printf(\"func\\n\"); }\n+  bool done(void) { \n+    return (count == 0) ? true : (count-- != 0);\n+  }\n+  void run(void) { abort(); }\n+};\n+\n+//typedef A T;\n+template<class T>\n+void WithoutBrace(T *a) {\n+  while (!a->done())   \n+    a->run();           /* count(#####) */\n+}                       /* count(1) */\n+\n+template<class T>\n+void WithBrace(T *a)\n+{\n+  while (!a->done())   \n+    { \n+      a->run();         /* count(#####) */\n+    }\n+}                       /* count(1) */\n+\n+A *func(A *a)\n+{\n+  WithoutBrace(a);\n+  WithBrace(a);\n+  return a;\n+}\n+\n+int main() {\n+  A a(0);\n+  func(&a);\n+  return 0;\n+}\n+\n+/* { dg-final { run-gcov gcov-5.C } } */"}]}