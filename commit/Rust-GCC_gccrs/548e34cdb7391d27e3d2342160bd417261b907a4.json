{"sha": "548e34cdb7391d27e3d2342160bd417261b907a4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTQ4ZTM0Y2RiNzM5MWQyN2UzZDIzNDIxNjBiZDQxNzI2MWI5MDdhNA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenth@gcc.gnu.org", "date": "2005-06-03T15:15:46Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2005-06-03T15:15:46Z"}, "message": "re PR middle-end/21858 (ICE in compare_values, at tree-vrp.c:301)\n\n2005-06-03  Richard Guenther  <rguenth@gcc.gnu.org>\n\n\tPR middle-end/21858\n\t* fold-const.c (fold_binary): Fix type mismatches in folding\n\tof comparisons.\n\n\t* gcc.dg/pr21858.c: New testcase.\n\nFrom-SVN: r100539", "tree": {"sha": "09add2482e2b513aadcdf21508f776a89347e306", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/09add2482e2b513aadcdf21508f776a89347e306"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/548e34cdb7391d27e3d2342160bd417261b907a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/548e34cdb7391d27e3d2342160bd417261b907a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/548e34cdb7391d27e3d2342160bd417261b907a4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/548e34cdb7391d27e3d2342160bd417261b907a4/comments", "author": null, "committer": null, "parents": [{"sha": "ff5c4582e0aef13b6b0908db7a8819eba87c2115", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff5c4582e0aef13b6b0908db7a8819eba87c2115", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff5c4582e0aef13b6b0908db7a8819eba87c2115"}], "stats": {"total": 38, "additions": 34, "deletions": 4}, "files": [{"sha": "97461baff5a74e4afd2cb79742164e6243005143", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=548e34cdb7391d27e3d2342160bd417261b907a4", "patch": "@@ -1,3 +1,9 @@\n+2005-06-03  Richard Guenther  <rguenth@gcc.gnu.org>\n+\n+\tPR middle-end/21858\n+\t* fold-const.c (fold_binary): Fix type mismatches in folding\n+\tof comparisons.\n+\n 2005-06-03  Kazu Hirata  <kazu@codesourcery.com>\n \n \t* cgraph.c, cgraphunit.c, config/mips/mips.c: Fix comment"}, {"sha": "21a5b1a66987654b691b2fe66f7c521af60d024c", "filename": "gcc/fold-const.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=548e34cdb7391d27e3d2342160bd417261b907a4", "patch": "@@ -9303,12 +9303,16 @@ fold_binary (enum tree_code code, tree type, tree op0, tree op1)\n \t  switch (code)\n \t    {\n \t    case GE_EXPR:\n-\t      arg1 = const_binop (MINUS_EXPR, arg1, integer_one_node, 0);\n-\t      return fold_build2 (GT_EXPR, type, arg0, arg1);\n+\t      arg1 = const_binop (MINUS_EXPR, arg1,\n+\t\t\t          build_int_cst (TREE_TYPE (arg1), 1), 0);\n+\t      return fold_build2 (GT_EXPR, type, arg0,\n+\t\t\t\t  fold_convert (TREE_TYPE (arg0), arg1));\n \n \t    case LT_EXPR:\n-\t      arg1 = const_binop (MINUS_EXPR, arg1, integer_one_node, 0);\n-\t      return fold_build2 (LE_EXPR, type, arg0, arg1);\n+\t      arg1 = const_binop (MINUS_EXPR, arg1,\n+\t\t\t          build_int_cst (TREE_TYPE (arg1), 1), 0);\n+\t      return fold_build2 (LE_EXPR, type, arg0,\n+\t\t\t\t  fold_convert (TREE_TYPE (arg0), arg1));\n \n \t    default:\n \t      break;"}, {"sha": "4129b3f672cbf7fe14845d27cfc8c6550238a2a0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=548e34cdb7391d27e3d2342160bd417261b907a4", "patch": "@@ -1,3 +1,8 @@\n+2005-06-03  Richard Guenther  <rguenth@gcc.gnu.org>\n+\n+\tPR middle-end/21858\n+\t* gcc.dg/pr21858.c: New testcase.\n+\n 2005-06-03  Paolo Bonzini  <bonzini@gnu.org>\n \n \tPR tree-optimization/21292"}, {"sha": "41cd240c8cce9848bbaedbf58c93983ea0c7d982", "filename": "gcc/testsuite/gcc.dg/pr21858.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2Ftestsuite%2Fgcc.dg%2Fpr21858.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/548e34cdb7391d27e3d2342160bd417261b907a4/gcc%2Ftestsuite%2Fgcc.dg%2Fpr21858.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr21858.c?ref=548e34cdb7391d27e3d2342160bd417261b907a4", "patch": "@@ -0,0 +1,15 @@\n+/* Fold used to create a GT_EXPR of pointer vs. integer types,\n+   which caused us to ICE in VRP.  */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-Os -w\" } */\n+\n+unsigned int dsdblm_GetBlockAddress();\n+void error_LocalAssert(void);\n+int dsdblm_CreateBlock(unsigned int address)\n+{\n+   address = dsdblm_GetBlockAddress();\n+   if (address >= (void*)0x00020000)\n+     error_LocalAssert();\n+   return address;\n+}"}]}