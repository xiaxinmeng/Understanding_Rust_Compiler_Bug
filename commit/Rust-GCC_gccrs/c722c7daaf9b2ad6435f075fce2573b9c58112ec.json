{"sha": "c722c7daaf9b2ad6435f075fce2573b9c58112ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzcyMmM3ZGFhZjliMmFkNjQzNWYwNzVmY2UyNTczYjljNTgxMTJlYw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard@codesourcery.com", "date": "2007-09-03T15:35:52Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2007-09-03T15:35:52Z"}, "message": "re PR middle-end/33290 (gcc.c-torture/execute/930921-1.c fails at -O1 and above now)\n\ngcc/\n\tPR middle-end/33290\n\t* optabs.c (avoid_expensive_constant): Canonicalize CONST_INTs\n\tbefore forcing them into a register.\n\nFrom-SVN: r128048", "tree": {"sha": "e5fef72222c55492804f063aeaff14e113ce5a35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e5fef72222c55492804f063aeaff14e113ce5a35"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c722c7daaf9b2ad6435f075fce2573b9c58112ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c722c7daaf9b2ad6435f075fce2573b9c58112ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c722c7daaf9b2ad6435f075fce2573b9c58112ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c722c7daaf9b2ad6435f075fce2573b9c58112ec/comments", "author": null, "committer": null, "parents": [{"sha": "171cb6996f0607925d63878cb74209d67cf09fb0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/171cb6996f0607925d63878cb74209d67cf09fb0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/171cb6996f0607925d63878cb74209d67cf09fb0"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "3526e61feae74ee0861e32dd4cf93be6a19419d6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c722c7daaf9b2ad6435f075fce2573b9c58112ec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c722c7daaf9b2ad6435f075fce2573b9c58112ec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c722c7daaf9b2ad6435f075fce2573b9c58112ec", "patch": "@@ -1,3 +1,9 @@\n+2007-09-03  Richard Sandiford  <richard@codesourcery.com>\n+\n+\tPR middle-end/33290\n+\t* optabs.c (avoid_expensive_constant): Canonicalize CONST_INTs\n+\tbefore forcing them into a register.\n+\n 2007-09-03  Richard Sandiford  <richard@codesourcery.com>\n \n \t* config/mips/mips.md (fetchop_bit): Use define_code_iterator"}, {"sha": "8d0139e8fca98b6444b3f6bfb3c7476b810aa4f8", "filename": "gcc/optabs.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c722c7daaf9b2ad6435f075fce2573b9c58112ec/gcc%2Foptabs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c722c7daaf9b2ad6435f075fce2573b9c58112ec/gcc%2Foptabs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Foptabs.c?ref=c722c7daaf9b2ad6435f075fce2573b9c58112ec", "patch": "@@ -1290,7 +1290,13 @@ avoid_expensive_constant (enum machine_mode mode, optab binoptab,\n       && CONSTANT_P (x)\n       && rtx_cost (x, binoptab->code) > COSTS_N_INSNS (1))\n     {\n-      if (GET_MODE (x) != VOIDmode)\n+      if (GET_CODE (x) == CONST_INT)\n+\t{\n+\t  HOST_WIDE_INT intval = trunc_int_for_mode (INTVAL (x), mode);\n+\t  if (intval != INTVAL (x))\n+\t    x = GEN_INT (intval);\n+\t}\n+      else\n \tx = convert_modes (mode, VOIDmode, x, unsignedp);\n       x = force_reg (mode, x);\n     }"}]}