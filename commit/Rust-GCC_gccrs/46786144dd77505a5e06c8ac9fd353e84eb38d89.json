{"sha": "46786144dd77505a5e06c8ac9fd353e84eb38d89", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDY3ODYxNDRkZDc3NTA1YTVlMDZjOGFjOWZkMzUzZTg0ZWIzOGQ4OQ==", "commit": {"author": {"name": "Segher Boessenkool", "email": "segher@gcc.gnu.org", "date": "2019-04-17T18:49:50Z"}, "committer": {"name": "Segher Boessenkool", "email": "segher@gcc.gnu.org", "date": "2019-04-17T18:49:50Z"}, "message": "auto-inc-dec: Set alignment properly\n\nWhen auto-inc-dec creates a new mem to compute the cost of doing some\ntransform, it forgets to copy over the alignment of the original mem.\nThis gives wrong costs, for example, for rs6000 a floating point load\nor store is hugely expensive if unaligned.  This patch fixes it.\n\n\n\t* auto-inc-dec.c (attempt_change): Set the alignment of the\n\ttemporary memory to that of the original.\n\nFrom-SVN: r270419", "tree": {"sha": "a9135598ac7b19904ab741739d69e18de52a9832", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a9135598ac7b19904ab741739d69e18de52a9832"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/46786144dd77505a5e06c8ac9fd353e84eb38d89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46786144dd77505a5e06c8ac9fd353e84eb38d89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46786144dd77505a5e06c8ac9fd353e84eb38d89", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46786144dd77505a5e06c8ac9fd353e84eb38d89/comments", "author": null, "committer": null, "parents": [{"sha": "f64e89775fc23fc57b1631f0c0e80a96150e3cd8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f64e89775fc23fc57b1631f0c0e80a96150e3cd8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f64e89775fc23fc57b1631f0c0e80a96150e3cd8"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "2138006a8b5b2b0dec779de0384807892c9dd38b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46786144dd77505a5e06c8ac9fd353e84eb38d89/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46786144dd77505a5e06c8ac9fd353e84eb38d89/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=46786144dd77505a5e06c8ac9fd353e84eb38d89", "patch": "@@ -1,12 +1,17 @@\n-2019-04-10  Joao Moreira  <jmoreira@suse.de>\n+2019-04-17  Segher Boessenkool  <segher@kernel.crashing.org>\n+\n+\t* auto-inc-dec.c (attempt_change): Set the alignment of the\n+\ttemporary memory to that of the original.\n+\n+2019-04-17  Joao Moreira  <jmoreira@suse.de>\n \n \t* targhooks.c (default_print_patchable_function_entry): Emit\n \t__patchable_function_entries section with writable flags to allow\n \trelocation resolution.\n \n 2019-04-17  Jonny Grant  <jg@jguk.org>\n \n-        * collect2.c (main): Change gcc.gnu.org URL to HTTPS.\n+\t* collect2.c (main): Change gcc.gnu.org URL to HTTPS.\n \n 2019-04-17  Jakub Jelinek  <jakub@redhat.com>\n "}, {"sha": "bdb6efab5202710910c14c0897616f3ead531169", "filename": "gcc/auto-inc-dec.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46786144dd77505a5e06c8ac9fd353e84eb38d89/gcc%2Fauto-inc-dec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46786144dd77505a5e06c8ac9fd353e84eb38d89/gcc%2Fauto-inc-dec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fauto-inc-dec.c?ref=46786144dd77505a5e06c8ac9fd353e84eb38d89", "patch": "@@ -471,13 +471,15 @@ attempt_change (rtx new_addr, rtx inc_reg)\n   int regno;\n   rtx mem = *mem_insn.mem_loc;\n   machine_mode mode = GET_MODE (mem);\n+  int align = MEM_ALIGN (mem);\n   rtx new_mem;\n   int old_cost = 0;\n   int new_cost = 0;\n   bool speed = optimize_bb_for_speed_p (bb);\n \n   PUT_MODE (mem_tmp, mode);\n   XEXP (mem_tmp, 0) = new_addr;\n+  set_mem_align (mem_tmp, align);\n \n   old_cost = (set_src_cost (mem, mode, speed)\n \t      + set_rtx_cost (PATTERN (inc_insn.insn), speed));"}]}