{"sha": "ed1fd9999c8162d201ac41dd25cb8bbd26798fdf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWQxZmQ5OTk5YzgxNjJkMjAxYWM0MWRkMjVjYjhiYmQyNjc5OGZkZg==", "commit": {"author": {"name": "Pat Haugen", "email": "pthaugen@us.ibm.com", "date": "2013-07-18T20:24:34Z"}, "committer": {"name": "Pat Haugen", "email": "pthaugen@gcc.gnu.org", "date": "2013-07-18T20:24:34Z"}, "message": "rs6000.c (rs6000_option_override_internal): Adjust flag interaction for new Power8 flags and VSX.\n\n\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Adjust flag\n\tinteraction for new Power8 flags and VSX.\n\nFrom-SVN: r201041", "tree": {"sha": "b7dd5103aa94f188bea73d436ea8af58de425452", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b7dd5103aa94f188bea73d436ea8af58de425452"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf/comments", "author": null, "committer": null, "parents": [{"sha": "ec87a337f38641cfca278846e1f1c13e0f603a60", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec87a337f38641cfca278846e1f1c13e0f603a60", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec87a337f38641cfca278846e1f1c13e0f603a60"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "99788662229546e56f3caf74221c3ceeda3bc271", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ed1fd9999c8162d201ac41dd25cb8bbd26798fdf", "patch": "@@ -1,3 +1,8 @@\n+2013-07-18  Pat Haugen <pthaugen@us.ibm.com>\n+\n+\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Adjust flag\n+\tinteraction for new Power8 flags and VSX.\n+\n 2013-07-18  Sriraman Tallam  <tmsriram@google.com>\n \n \tPR middle-end/57698"}, {"sha": "2616e6cacc8dc3076786b7411619f6a1af86347d", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed1fd9999c8162d201ac41dd25cb8bbd26798fdf/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=ed1fd9999c8162d201ac41dd25cb8bbd26798fdf", "patch": "@@ -2966,7 +2966,10 @@ rs6000_option_override_internal (bool global_init_p)\n \t  if (rs6000_isa_flags_explicit & OPTION_MASK_VSX)\n \t    msg = N_(\"-mvsx requires hardware floating point\");\n \t  else\n-\t    rs6000_isa_flags &= ~ OPTION_MASK_VSX;\n+\t    {\n+\t      rs6000_isa_flags &= ~ OPTION_MASK_VSX;\n+\t      rs6000_isa_flags_explicit |= OPTION_MASK_VSX;\n+\t    }\n \t}\n       else if (TARGET_PAIRED_FLOAT)\n \tmsg = N_(\"-mvsx and -mpaired are incompatible\");\n@@ -2994,6 +2997,16 @@ rs6000_option_override_internal (bool global_init_p)\n \t}\n     }\n \n+  /* If hard-float/altivec/vsx were explicitly turned off then don't allow\n+     the -mcpu setting to enable options that conflict. */\n+  if ((!TARGET_HARD_FLOAT || !TARGET_ALTIVEC || !TARGET_VSX)\n+      && (rs6000_isa_flags_explicit & (OPTION_MASK_SOFT_FLOAT\n+\t\t\t\t       | OPTION_MASK_ALTIVEC\n+\t\t\t\t       | OPTION_MASK_VSX)) != 0)\n+    rs6000_isa_flags &= ~((OPTION_MASK_P8_VECTOR | OPTION_MASK_CRYPTO\n+\t\t\t   | OPTION_MASK_DIRECT_MOVE)\n+\t\t         & ~rs6000_isa_flags_explicit);\n+\n   if (TARGET_DEBUG_REG || TARGET_DEBUG_TARGET)\n     rs6000_print_isa_options (stderr, 0, \"before defaults\", rs6000_isa_flags);\n "}]}