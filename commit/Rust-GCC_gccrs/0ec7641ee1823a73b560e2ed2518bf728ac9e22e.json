{"sha": "0ec7641ee1823a73b560e2ed2518bf728ac9e22e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGVjNzY0MWVlMTgyM2E3M2I1NjBlMmVkMjUxOGJmNzI4YWM5ZTIyZQ==", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2021-03-18T06:22:59Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2021-03-22T02:27:23Z"}, "message": "rs6000: Fix some unexpected empty split conditions\n\nThis patch is to fix empty split-conditions of some\ndefine_insn_and_split definitions where their conditions for\ndefine_insn part aren't empty.  As Segher and Mike pointed\nout, they can sometimes lead to unexpected consequences.\n\nBootstrapped/regtested on powerpc64le-linux-gnu P9 and\npowerpc64-linux-gnu P8.\n\ngcc/ChangeLog:\n\n\t* config/rs6000/rs6000.md (*rotldi3_insert_sf,\n\t*mov<SFDF:mode><SFDF2:mode>cc_p9, floatsi<mode>2_lfiwax,\n\tfloatsi<mode>2_lfiwax_mem, floatunssi<mode>2_lfiwzx,\n\tfloatunssi<mode>2_lfiwzx_mem, *floatsidf2_internal,\n\t*floatunssidf2_internal, fix_trunc<mode>si2_stfiwx,\n\tfix_trunc<mode>si2_internal, fixuns_trunc<mode>si2_stfiwx,\n\t*round32<mode>2_fprs, *roundu32<mode>2_fprs,\n\t*fix_trunc<mode>si2_internal): Fix empty split condition.\n\t* config/rs6000/vsx.md (*vsx_le_undo_permute_<mode>,\n\tvsx_reduc_<VEC_reduc_name>_v2df, vsx_reduc_<VEC_reduc_name>_v4sf,\n\t*vsx_reduc_<VEC_reduc_name>_v2df_scalar,\n\t*vsx_reduc_<VEC_reduc_name>_v4sf_scalar): Likewise.", "tree": {"sha": "c3ba5f49325cf5890639127a9f01cd3e87d736f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c3ba5f49325cf5890639127a9f01cd3e87d736f6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ec7641ee1823a73b560e2ed2518bf728ac9e22e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ec7641ee1823a73b560e2ed2518bf728ac9e22e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ec7641ee1823a73b560e2ed2518bf728ac9e22e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ec7641ee1823a73b560e2ed2518bf728ac9e22e/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d0a5e8e1a84bdd6ce915c3be65da8af2552cd49e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0a5e8e1a84bdd6ce915c3be65da8af2552cd49e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d0a5e8e1a84bdd6ce915c3be65da8af2552cd49e"}], "stats": {"total": 38, "additions": 19, "deletions": 19}, "files": [{"sha": "c71d343554303c9b990b780355fcd52023dd7865", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 14, "deletions": 14, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ec7641ee1823a73b560e2ed2518bf728ac9e22e/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ec7641ee1823a73b560e2ed2518bf728ac9e22e/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=0ec7641ee1823a73b560e2ed2518bf728ac9e22e", "patch": "@@ -4286,7 +4286,7 @@\n   (clobber (match_scratch:V4SF 4))]\n   \"TARGET_POWERPC64 && INTVAL (operands[2]) == <bits>\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(parallel [(set (match_dup 5)\n       (zero_extend:DI (unspec:QHSI [(match_dup 3)] UNSPEC_SI_FROM_SF)))\n     (clobber (match_dup 4))])\n@@ -5332,7 +5332,7 @@\n    (clobber (match_scratch:V2DI 6 \"=0,&wa\"))]\n   \"TARGET_P9_MINMAX\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(set (match_dup 6)\n \t(if_then_else:V2DI (match_dup 1)\n \t\t\t   (match_dup 7)\n@@ -5441,7 +5441,7 @@\n   \"TARGET_HARD_FLOAT && TARGET_LFIWAX\n    && <SI_CONVERT_FP> && can_create_pseudo_p ()\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx dest = operands[0];\n@@ -5481,7 +5481,7 @@\n    (clobber (match_scratch:DI 2 \"=d,wa\"))]\n   \"TARGET_HARD_FLOAT && TARGET_LFIWAX && <SI_CONVERT_FP>\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   operands[1] = rs6000_force_indexed_or_indirect_mem (operands[1]);\n@@ -5516,7 +5516,7 @@\n    (clobber (match_scratch:DI 2 \"=d,wa\"))]\n   \"TARGET_HARD_FLOAT && TARGET_LFIWZX && <SI_CONVERT_FP>\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx dest = operands[0];\n@@ -5556,7 +5556,7 @@\n    (clobber (match_scratch:DI 2 \"=d,wa\"))]\n   \"TARGET_HARD_FLOAT && TARGET_LFIWZX && <SI_CONVERT_FP>\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   operands[1] = rs6000_force_indexed_or_indirect_mem (operands[1]);\n@@ -5621,7 +5621,7 @@\n    (clobber (match_operand:SI 6 \"gpc_reg_operand\" \"=&r\"))]\n   \"!TARGET_FCFID && TARGET_HARD_FLOAT\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx lowword, highword;\n@@ -5711,7 +5711,7 @@\n   \"!TARGET_FCFIDU && TARGET_HARD_FLOAT\n    && !(TARGET_FCFID && TARGET_POWERPC64)\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx lowword, highword;\n@@ -5867,7 +5867,7 @@\n   \"TARGET_HARD_FLOAT && TARGET_STFIWX && can_create_pseudo_p ()\n    && !(TARGET_P8_VECTOR && TARGET_DIRECT_MOVE)\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx dest = operands[0];\n@@ -5909,7 +5909,7 @@\n   \"TARGET_HARD_FLOAT\n    && !(TARGET_P8_VECTOR && TARGET_DIRECT_MOVE)\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx lowword;\n@@ -6015,7 +6015,7 @@\n    && TARGET_STFIWX && can_create_pseudo_p ()\n    && !TARGET_P8_VECTOR\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx dest = operands[0];\n@@ -6235,7 +6235,7 @@\n    && <SI_CONVERT_FP> && TARGET_LFIWAX && TARGET_STFIWX && TARGET_FCFID\n    && !TARGET_DIRECT_MOVE && can_create_pseudo_p ()\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx dest = operands[0];\n@@ -6268,7 +6268,7 @@\n    && TARGET_LFIWZX && TARGET_STFIWX && TARGET_FCFIDU && !TARGET_DIRECT_MOVE\n    && can_create_pseudo_p ()\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx dest = operands[0];\n@@ -8251,7 +8251,7 @@\n    (clobber (match_operand:DI 5 \"offsettable_mem_operand\" \"=o\"))]\n   \"TARGET_HARD_FLOAT && TARGET_LONG_DOUBLE_128\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(pc)]\n {\n   rtx lowword;"}, {"sha": "4404407d330f0132afb5cef24511d09b51cab5e1", "filename": "gcc/config/rs6000/vsx.md", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ec7641ee1823a73b560e2ed2518bf728ac9e22e/gcc%2Fconfig%2Frs6000%2Fvsx.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ec7641ee1823a73b560e2ed2518bf728ac9e22e/gcc%2Fconfig%2Frs6000%2Fvsx.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fvsx.md?ref=0ec7641ee1823a73b560e2ed2518bf728ac9e22e", "patch": "@@ -972,7 +972,7 @@\n   \"@\n    #\n    xxlor %x0,%x1\"\n-  \"\"\n+  \"&& 1\"\n   [(set (match_dup 0) (match_dup 1))]\n {\n   if (reload_completed && REGNO (operands[0]) == REGNO (operands[1]))\n@@ -4656,7 +4656,7 @@\n    (clobber (match_scratch:V2DF 2 \"=0,&wa\"))]\n   \"VECTOR_UNIT_VSX_P (V2DFmode)\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(const_int 0)]\n {\n   rtx tmp = (GET_CODE (operands[2]) == SCRATCH)\n@@ -4678,7 +4678,7 @@\n    (clobber (match_scratch:V4SF 3 \"=&wa\"))]\n   \"VECTOR_UNIT_VSX_P (V4SFmode)\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(const_int 0)]\n {\n   rtx op0 = operands[0];\n@@ -4726,7 +4726,7 @@\n    (clobber (match_scratch:DF 2 \"=0,&wa\"))]\n   \"BYTES_BIG_ENDIAN && VECTOR_UNIT_VSX_P (V2DFmode)\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(const_int 0)]\n {\n   rtx hi = gen_highpart (DFmode, operands[1]);\n@@ -4753,7 +4753,7 @@\n    (clobber (match_scratch:V4SF 4 \"=0\"))]\n   \"BYTES_BIG_ENDIAN && VECTOR_UNIT_VSX_P (V4SFmode)\"\n   \"#\"\n-  \"\"\n+  \"&& 1\"\n   [(const_int 0)]\n {\n   rtx op0 = operands[0];"}]}