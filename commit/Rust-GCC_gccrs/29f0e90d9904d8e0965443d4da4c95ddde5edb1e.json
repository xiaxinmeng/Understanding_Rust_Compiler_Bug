{"sha": "29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjlmMGU5MGQ5OTA0ZDhlMDk2NTQ0M2Q0ZGE0Yzk1ZGRkZTVlZGIxZQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-05-15T21:59:49Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-05-15T21:59:49Z"}, "message": "c++: Enable coroutines with -std=c++20.\n\nNow that GCC 10 is out it seems time.  People can still choose to disable\ncoroutines with -fno-coroutines.\n\nThis also switches the coroutines testsuite to run in C++20 mode.  The\nchange to coro.h is only necessary for co-await-11-forwarding.C; we could\nalternatively #include <utility> just in that file.\n\ngcc/c-family/ChangeLog\n2020-05-15  Jason Merrill  <jason@redhat.com>\n\n\t* c-opts.c (set_std_cxx20): Set flag_coroutines.\n\ngcc/testsuite/ChangeLog\n2020-05-15  Jason Merrill  <jason@redhat.com>\n\n\t* g++.dg/coroutines/coro.h: Always #include <utility>.\n\t* g++.dg/coroutines/coroutines.exp (DEFAULT_COROFLAGS): Use\n\t-std=c++20.", "tree": {"sha": "bfa05c25f3204db05cd5eb7e94c5814cf284f204", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bfa05c25f3204db05cd5eb7e94c5814cf284f204"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "16485ea97b3d9856a9387d858ca455889e97bf30", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/16485ea97b3d9856a9387d858ca455889e97bf30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/16485ea97b3d9856a9387d858ca455889e97bf30"}], "stats": {"total": 29, "additions": 17, "deletions": 12}, "files": [{"sha": "da4be414b6cbc37083390f0790cbd7c50010adaf", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "patch": "@@ -1,3 +1,7 @@\n+2020-05-15  Jason Merrill  <jason@redhat.com>\n+\n+\t* c-opts.c (set_std_cxx20): Set flag_coroutines.\n+\n 2020-05-13  Jason Merrill  <jason@redhat.com>\n \n \t* c.opt (std=c++20): Make c++2a the alias."}, {"sha": "7695e88c13015a57fa806a68b1b9634dac178fb1", "filename": "gcc/c-family/c-opts.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Fc-family%2Fc-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Fc-family%2Fc-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-opts.c?ref=29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "patch": "@@ -1722,7 +1722,7 @@ set_std_cxx17 (int iso)\n   lang_hooks.name = \"GNU C++17\";\n }\n \n-/* Set the C++ 202a draft standard (without GNU extensions if ISO).  */\n+/* Set the C++ 2020 standard (without GNU extensions if ISO).  */\n static void\n set_std_cxx20 (int iso)\n {\n@@ -1734,9 +1734,10 @@ set_std_cxx20 (int iso)\n   flag_isoc94 = 1;\n   flag_isoc99 = 1;\n   flag_isoc11 = 1;\n-  /* C++20 includes concepts. */\n+  /* C++20 includes coroutines. */\n+  flag_coroutines = true;\n   cxx_dialect = cxx20;\n-  lang_hooks.name = \"GNU C++17\"; /* Pretend C++17 until standardization.  */\n+  lang_hooks.name = \"GNU C++20\";\n }\n \n /* Args to -d specify what to dump.  Silently ignore"}, {"sha": "875ac82fb3407c494fdcf5edfe445b3f134b8b07", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "patch": "@@ -1,3 +1,9 @@\n+2020-05-15  Jason Merrill  <jason@redhat.com>\n+\n+\t* g++.dg/coroutines/coro.h: Always #include <utility>.\n+\t* g++.dg/coroutines/coroutines.exp (DEFAULT_COROFLAGS): Use\n+\t-std=c++20.\n+\n 2020-05-15  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* gcc.target/powerpc/vec-gnb-0.c: Use int128 effective target."}, {"sha": "02d26602727324072dc607bcb178b1e16d85983b", "filename": "gcc/testsuite/g++.dg/coroutines/coro.h", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fcoro.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fcoro.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fcoro.h?ref=29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "patch": "@@ -2,20 +2,12 @@\n \n #include <coroutine>\n \n-#  if __clang__\n-#    include <utility>\n-#  endif\n-\n namespace coro = std;\n \n #elif __has_include(<experimental/coroutine>)\n \n #include <experimental/coroutine>\n \n-#  if __clang__\n-#    include <utility>\n-#  endif\n-\n namespace coro = std::experimental;\n \n #else\n@@ -143,6 +135,8 @@ extern \"C\" int printf (const char *, ...);\n \n #include <cstdlib> /* for abort () */\n \n+#include <utility> /* for std::forward */\n+\n #ifndef OUTPUT\n #  define PRINT(X)\n #  define PRINTF (void)"}, {"sha": "1bef98ae54d5494c6afb504380bdefb1cbbc2e92", "filename": "gcc/testsuite/g++.dg/coroutines/coroutines.exp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fcoroutines.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/29f0e90d9904d8e0965443d4da4c95ddde5edb1e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fcoroutines.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcoroutines%2Fcoroutines.exp?ref=29f0e90d9904d8e0965443d4da4c95ddde5edb1e", "patch": "@@ -29,7 +29,7 @@ if ![info exists DEFAULT_CXXFLAGS] then {\n }\n \n set DEFAULT_COROFLAGS $DEFAULT_CXXFLAGS\n-lappend DEFAULT_COROFLAGS \"-std=c++17\" \"-fcoroutines\"\n+lappend DEFAULT_COROFLAGS \"-std=c++20\"\n \n dg-init\n "}]}