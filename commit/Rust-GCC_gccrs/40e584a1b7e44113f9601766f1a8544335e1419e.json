{"sha": "40e584a1b7e44113f9601766f1a8544335e1419e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDBlNTg0YTFiN2U0NDExM2Y5NjAxNzY2ZjFhODU0NDMzNWUxNDE5ZQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-12-04T22:00:12Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-12-04T22:00:12Z"}, "message": "Makefile.in (LTO_STREAMER_H): Add GCOV_IO_H.\n\n\t* Makefile.in (LTO_STREAMER_H): Add GCOV_IO_H.\n\t* lto-cgraph.c (merge_profile_summaries): Fix thinko.\n\nFrom-SVN: r167459", "tree": {"sha": "d569fd073d1e7730591579ceaca5c7d83ebd6ea5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d569fd073d1e7730591579ceaca5c7d83ebd6ea5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40e584a1b7e44113f9601766f1a8544335e1419e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40e584a1b7e44113f9601766f1a8544335e1419e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40e584a1b7e44113f9601766f1a8544335e1419e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40e584a1b7e44113f9601766f1a8544335e1419e/comments", "author": null, "committer": null, "parents": [{"sha": "db0bf14f6b2ae9e3a1581522a9c4b90ac5453a06", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db0bf14f6b2ae9e3a1581522a9c4b90ac5453a06", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db0bf14f6b2ae9e3a1581522a9c4b90ac5453a06"}], "stats": {"total": 22, "additions": 13, "deletions": 9}, "files": [{"sha": "f56b07015f0cacd03292d7e7ab5523db29948fc9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40e584a1b7e44113f9601766f1a8544335e1419e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40e584a1b7e44113f9601766f1a8544335e1419e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=40e584a1b7e44113f9601766f1a8544335e1419e", "patch": "@@ -1,3 +1,8 @@\n+2010-12-03  Jan Hubicka  <jh@suse.cz>\n+\n+\t* Makefile.in (LTO_STREAMER_H): Add GCOV_IO_H.\n+\t* lto-cgraph.c (merge_profile_summaries): Fix thinko.\n+\n 2010-12-03  Jan Hubicka  <jh@suse.cz>\n \n \tPR tree-optimization/46760"}, {"sha": "949262b58c3c79ddb8d9b2e766de66f531a6dc59", "filename": "gcc/Makefile.in", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40e584a1b7e44113f9601766f1a8544335e1419e/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40e584a1b7e44113f9601766f1a8544335e1419e/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=40e584a1b7e44113f9601766f1a8544335e1419e", "patch": "@@ -975,7 +975,8 @@ IRA_INT_H = ira.h ira-int.h $(CFGLOOP_H) alloc-pool.h\n DBGCNT_H = dbgcnt.h dbgcnt.def\n EBITMAP_H = ebitmap.h sbitmap.h\n LTO_STREAMER_H = lto-streamer.h $(LINKER_PLUGIN_API_H) $(TARGET_H) \\\n-\t\t$(CGRAPH_H) $(VEC_H) vecprim.h $(TREE_H) $(GIMPLE_H)\n+\t\t$(CGRAPH_H) $(VEC_H) vecprim.h $(TREE_H) $(GIMPLE_H) \\\n+\t\t$(GCOV_IO_H)\n TREE_VECTORIZER_H = tree-vectorizer.h $(TREE_DATA_REF_H)\n IPA_PROP_H = ipa-prop.h $(TREE_H) $(VEC_H) $(CGRAPH_H) $(GIMPLE_H)\n GSTAB_H = gstab.h stab.def"}, {"sha": "76597a000ee868837ec4677ec4ab55aee3aaad7c", "filename": "gcc/lto-cgraph.c", "status": "modified", "additions": 6, "deletions": 8, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40e584a1b7e44113f9601766f1a8544335e1419e/gcc%2Flto-cgraph.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40e584a1b7e44113f9601766f1a8544335e1419e/gcc%2Flto-cgraph.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-cgraph.c?ref=40e584a1b7e44113f9601766f1a8544335e1419e", "patch": "@@ -1504,16 +1504,14 @@ merge_profile_summaries (struct lto_file_decl_data **file_data_vec)\n      During LTRANS we already have values of count_materialization_scale\n      computed, so just update them.  */\n   for (node = cgraph_nodes; node; node = node->next)\n-    if (node->local.lto_file_data->profile_info.run_max)\n+    if (node->local.lto_file_data->profile_info.runs)\n       {\n \tint scale;\n-\tif (node->local.lto_file_data->profile_info.runs)\n-\t  scale =\n-\t     ((node->count_materialization_scale * max_runs\n-\t       + node->local.lto_file_data->profile_info.run_max / 2)\n-\t      / node->local.lto_file_data->profile_info.run_max);\n-\telse\n-\t  scale = node->count_materialization_scale;\n+\n+\tscale =\n+\t   ((node->count_materialization_scale * max_runs\n+\t     + node->local.lto_file_data->profile_info.runs / 2)\n+\t    / node->local.lto_file_data->profile_info.runs);\n \tnode->count_materialization_scale = scale;\n \tif (scale < 0)\n \t  fatal_error (\"Profile information in %s corrupted\","}]}