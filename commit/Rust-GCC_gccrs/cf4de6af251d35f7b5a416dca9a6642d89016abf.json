{"sha": "cf4de6af251d35f7b5a416dca9a6642d89016abf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2Y0ZGU2YWYyNTFkMzVmN2I1YTQxNmRjYTlhNjY0MmQ4OTAxNmFiZg==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2016-01-12T00:30:30Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2016-01-12T00:30:30Z"}, "message": "Set FLT_EVAL_METHOD to 2 only if 387 FPU is used\n\nWhen 387 FPU isn't used, there is no excess precision.  We should set\nFLT_EVAL_METHOD to 2 only if 387 FPU is used.\n\ngcc/\n\n\tPR target/69225\n\t* config/i386/i386.h (TARGET_FLT_EVAL_METHOD): Set to 2 only if\n\tTARGET_80387 is true.\n\ngcc/testsuite\n\n\tPR target/69225\n\t* gcc.target/i386/pr69225-1.c: New test.\n\t* gcc.target/i386/pr69225-2.c: Likewise.\n\t* gcc.target/i386/pr69225-3.c: Likewise.\n\t* gcc.target/i386/pr69225-4.c: Likewise.\n\t* gcc.target/i386/pr69225-5.c: Likewise.\n\t* gcc.target/i386/pr69225-6.c: Likewise.\n\nFrom-SVN: r232249", "tree": {"sha": "cede8edeb57c09a0f2b04b27a70929bb4f3d117c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cede8edeb57c09a0f2b04b27a70929bb4f3d117c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cf4de6af251d35f7b5a416dca9a6642d89016abf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf4de6af251d35f7b5a416dca9a6642d89016abf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cf4de6af251d35f7b5a416dca9a6642d89016abf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf4de6af251d35f7b5a416dca9a6642d89016abf/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0f474f11b16c8c0bd8c1e9a9c0bcbaa358f59a8a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f474f11b16c8c0bd8c1e9a9c0bcbaa358f59a8a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f474f11b16c8c0bd8c1e9a9c0bcbaa358f59a8a"}], "stats": {"total": 66, "additions": 65, "deletions": 1}, "files": [{"sha": "24763e296f494e96b3e9bc98039786dcea80b2de", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -1,3 +1,9 @@\n+2016-01-11  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/69225\n+\t* config/i386/i386.h (TARGET_FLT_EVAL_METHOD): Set to 2 only if\n+\tTARGET_80387 is true.\n+\n 2016-01-11  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/69071"}, {"sha": "6c63871e7f24e8082f303e54ff5112cccfb785d4", "filename": "gcc/config/i386/i386.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Fconfig%2Fi386%2Fi386.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Fconfig%2Fi386%2Fi386.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.h?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -694,7 +694,7 @@ extern const char *host_detect_local_cpu (int argc, const char **argv);\n    the rounding precision is indeterminate, since either may be chosen\n    apparently at random.  */\n #define TARGET_FLT_EVAL_METHOD \\\n-  (TARGET_MIX_SSE_I387 ? -1 : TARGET_SSE_MATH ? 0 : 2)\n+  (TARGET_MIX_SSE_I387 ? -1 : (TARGET_80387 && !TARGET_SSE_MATH) ? 2 : 0)\n \n /* Whether to allow x87 floating-point arithmetic on MODE (one of\n    SFmode, DFmode and XFmode) in the current excess precision"}, {"sha": "f789ea6d12a91ad06e813b20cf5dddd340103b44", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -1,3 +1,13 @@\n+2016-01-11  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/69225\n+\t* gcc.target/i386/pr69225-1.c: New test.\n+\t* gcc.target/i386/pr69225-2.c: Likewise.\n+\t* gcc.target/i386/pr69225-3.c: Likewise.\n+\t* gcc.target/i386/pr69225-4.c: Likewise.\n+\t* gcc.target/i386/pr69225-5.c: Likewise.\n+\t* gcc.target/i386/pr69225-6.c: Likewise.\n+\n 2016-01-11  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/67462"}, {"sha": "cc5b782326ca69928bf3897832cfeef3d95f0e0e", "filename": "gcc/testsuite/gcc.target/i386/pr69225-1.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-1.c?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile} */\n+/* { dg-options \"-msse2 -mfpmath=sse\" } */\n+\n+#include <float.h>\n+\n+#if FLT_EVAL_METHOD != 0\n+# error FLT_EVAL_METHOD != 0\n+#endif"}, {"sha": "cd0a6260cf606b9f2df48c3cb9d245dc91a4f0e8", "filename": "gcc/testsuite/gcc.target/i386/pr69225-2.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-2.c?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile} */\n+/* { dg-options \"-mno-sse -mno-80387\" } */\n+\n+#include <float.h>\n+\n+#if FLT_EVAL_METHOD != 0\n+# error FLT_EVAL_METHOD != 0\n+#endif"}, {"sha": "1440b7463d9df0c7ede9c3af105bfecead353248", "filename": "gcc/testsuite/gcc.target/i386/pr69225-3.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-3.c?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile} */\n+/* { dg-options \"-m80387 -mfpmath=387\" } */\n+\n+#include <float.h>\n+\n+#if FLT_EVAL_METHOD != 2\n+# error FLT_EVAL_METHOD != 2\n+#endif"}, {"sha": "b032a5f2bdfab4440247f5822cd1ceb99051a921", "filename": "gcc/testsuite/gcc.target/i386/pr69225-4.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-4.c?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile} */\n+/* { dg-options \"-msse2 -mfancy-math-387 -mfpmath=sse\" } */\n+\n+#include <float.h>\n+\n+#if FLT_EVAL_METHOD != 0\n+# error FLT_EVAL_METHOD != 0\n+#endif"}, {"sha": "4162f7790f120e8a0465bd60dfb6100755acf7ee", "filename": "gcc/testsuite/gcc.target/i386/pr69225-5.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-5.c?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile} */\n+/* { dg-options \"-msse2 -m80387 -mfpmath=sse,387\" } */\n+\n+#include <float.h>\n+\n+#if FLT_EVAL_METHOD != -1\n+# error FLT_EVAL_METHOD != -1\n+#endif"}, {"sha": "cd5f41946d6a3c99fbfb5ae04af5762914134f23", "filename": "gcc/testsuite/gcc.target/i386/pr69225-6.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf4de6af251d35f7b5a416dca9a6642d89016abf/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr69225-6.c?ref=cf4de6af251d35f7b5a416dca9a6642d89016abf", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile} */\n+/* { dg-options \"-mno-80387\" } */\n+\n+#include <float.h>\n+\n+#if FLT_EVAL_METHOD != 0\n+# error FLT_EVAL_METHOD != 0\n+#endif"}]}