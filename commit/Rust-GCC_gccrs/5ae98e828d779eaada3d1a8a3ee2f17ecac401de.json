{"sha": "5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWFlOThlODI4ZDc3OWVhYWRhM2QxYThhM2VlMmYxN2VjYWM0MDFkZQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2014-06-05T12:42:29Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2014-06-05T12:42:29Z"}, "message": "re PR c++/61004 (Spurious warning: dereferencing type-punned pointer)\n\n2014-06-05  Richard Biener  <rguenther@suse.de>\n\n\tPR c++/61004\n\t* typeck.c (cp_build_indirect_ref): Do not emit strict-aliasing\n\twarnings for accessing empty classes.\n\n\t* g++.dg/diagnostic/pr61004.C: New testcase.\n\nFrom-SVN: r211272", "tree": {"sha": "25a0f2d0c609d6fea9e87e7d55c8f9fb91015a7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25a0f2d0c609d6fea9e87e7d55c8f9fb91015a7c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "97826595b521a73a5557d110c366e3df78c57f69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97826595b521a73a5557d110c366e3df78c57f69", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97826595b521a73a5557d110c366e3df78c57f69"}], "stats": {"total": 27, "additions": 25, "deletions": 2}, "files": [{"sha": "fd51940758313b7246bf1ec2f49368823ea1dbf6", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "patch": "@@ -1,3 +1,9 @@\n+2014-06-05  Richard Biener  <rguenther@suse.de>\n+\n+\tPR c++/61004\n+\t* typeck.c (cp_build_indirect_ref): Do not emit strict-aliasing\n+\twarnings for accessing empty classes.\n+\n 2014-06-05  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/49706"}, {"sha": "fa9047513258ae9ea9c5d835ba04cabff607da66", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "patch": "@@ -2935,8 +2935,9 @@ cp_build_indirect_ref (tree ptr, ref_operator errorstring,\n \t of  the  result  is  \"T.\"  */\n       tree t = TREE_TYPE (type);\n \n-      if (CONVERT_EXPR_P (ptr)\n-          || TREE_CODE (ptr) == VIEW_CONVERT_EXPR)\n+      if ((CONVERT_EXPR_P (ptr)\n+\t   || TREE_CODE (ptr) == VIEW_CONVERT_EXPR)\n+\t  && (!CLASS_TYPE_P (t) || !CLASSTYPE_EMPTY_P (t)))\n \t{\n \t  /* If a warning is issued, mark it to avoid duplicates from\n \t     the backend.  This only needs to be done at"}, {"sha": "5073054e4aa5b6d94cdbff4272a534fc8c53e787", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "patch": "@@ -1,3 +1,8 @@\n+2014-06-05  Richard Biener  <rguenther@suse.de>\n+\n+\tPR c++/61004\n+\t* g++.dg/diagnostic/pr61004.C: New testcase.\n+\n 2014-06-05  Yuri Rumyantsev  <ysrumyan@gmail.com>\n \n \t* gcc.dg/torture/pr61319.c: New test."}, {"sha": "3bf66bed7a46bd9e32f642ca7a47434fff048044", "filename": "gcc/testsuite/g++.dg/diagnostic/pr61004.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fpr61004.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ae98e828d779eaada3d1a8a3ee2f17ecac401de/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fpr61004.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fpr61004.C?ref=5ae98e828d779eaada3d1a8a3ee2f17ecac401de", "patch": "@@ -0,0 +1,11 @@\n+// { dg-do compile }\n+// { dg-options \"-O2 -Wall\" }\n+\n+struct A{ };\n+struct B:A{};\n+void f(A const&);\n+int main()\n+{\n+  B b;\n+  f(b); // { dg-bogus \"strict-aliasing\" }\n+}"}]}