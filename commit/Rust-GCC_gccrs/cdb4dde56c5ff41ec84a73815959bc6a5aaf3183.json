{"sha": "cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2RiNGRkZTU2YzVmZjQxZWM4NGE3MzgxNTk1OWJjNmE1YWFmMzE4Mw==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2009-09-14T09:38:55Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2009-09-14T09:38:55Z"}, "message": "re PR bootstrap/41350 (FreeBSD bootstrap failure: unimplemented: Multiple EH personalities are supported only with assemblers supporting .cfi.personality directive)\n\n2009-09-14  Richard Guenther  <rguenther@suse.de>\n\n\tPR middle-end/41350\n\t* dwarf2out.c (dwarf2out_begin_prologue): Adjust non-CFI asm\n\tEH personality path.\n\n\t* g++.dg/debug/dwarf-eh-personality-1.C: New testcase.\n\nFrom-SVN: r151681", "tree": {"sha": "525f98d8c0de2ba74d603a0588f367064d2b046a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/525f98d8c0de2ba74d603a0588f367064d2b046a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5c2dbba68d8540043e37f43d681ce136bf4eb0ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c2dbba68d8540043e37f43d681ce136bf4eb0ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c2dbba68d8540043e37f43d681ce136bf4eb0ce"}], "stats": {"total": 40, "additions": 36, "deletions": 4}, "files": [{"sha": "930b5563ff6784d0e7d74e5cfbd87822a749f8c2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "patch": "@@ -1,3 +1,9 @@\n+2009-09-14  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/41350\n+\t* dwarf2out.c (dwarf2out_begin_prologue): Adjust non-CFI asm\n+\tEH personality path.\n+\n 2009-09-13  Richard Guenther  <rguenther@suse.de>\n \tRafael Avila de Espindola  <espindola@google.com>\n "}, {"sha": "14836d539e811aaad3a4ead00c150b6afdc0589d", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "patch": "@@ -3881,7 +3881,6 @@ dwarf2out_begin_prologue (unsigned int line ATTRIBUTE_UNUSED,\n   char label[MAX_ARTIFICIAL_LABEL_BYTES];\n   char * dup_label;\n   dw_fde_ref fde;\n-  rtx personality;\n   section *fnsec;\n \n   current_function_func_begin_label = NULL;\n@@ -3976,14 +3975,19 @@ dwarf2out_begin_prologue (unsigned int line ATTRIBUTE_UNUSED,\n     dwarf2out_source_line (line, file, 0, true);\n #endif\n \n-  personality = get_personality_function (current_function_decl);\n   if (dwarf2out_do_cfi_asm ())\n     dwarf2out_do_cfi_startproc (false);\n   else\n     {\n-      if (!current_unit_personality || current_unit_personality == personality)\n+      rtx personality = get_personality_function (current_function_decl);\n+      if (!current_unit_personality)\n         current_unit_personality = personality;\n-      else\n+\n+      /* We cannot keep a current personality per function as without CFI\n+\t asm at the point where we emit the CFI data there is no current\n+\t function anymore.  */\n+      if (personality\n+\t  && current_unit_personality != personality)\n \tsorry (\"Multiple EH personalities are supported only with assemblers \"\n \t       \"supporting .cfi.personality directive.\");\n     }"}, {"sha": "b0b2adc3e9c5715c3b5a0dc56db3d2dba0d46f23", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "patch": "@@ -1,3 +1,8 @@\n+2009-09-14  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/41350\n+\t* g++.dg/debug/dwarf-eh-personality-1.C: New testcase.\n+\n 2009-09-12  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libgfortran/41328"}, {"sha": "5c72588e5135044e03fcda0eb15e0f4eba97cd55", "filename": "gcc/testsuite/g++.dg/debug/dwarf-eh-personality-1.C", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf-eh-personality-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb4dde56c5ff41ec84a73815959bc6a5aaf3183/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf-eh-personality-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf-eh-personality-1.C?ref=cdb4dde56c5ff41ec84a73815959bc6a5aaf3183", "patch": "@@ -0,0 +1,17 @@\n+// { dg-options \"-fno-dwarf2-cfi-asm\" }\n+\n+extern void bar (void);\n+int foo (void)\n+{\n+  try {\n+      bar();\n+  } catch (...) {\n+      return 1;\n+  }\n+  return 0;\n+}\n+\n+int foobar (void)\n+{\n+}\n+"}]}