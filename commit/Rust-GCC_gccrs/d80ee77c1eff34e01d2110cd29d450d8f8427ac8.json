{"sha": "d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDgwZWU3N2MxZWZmMzRlMDFkMjExMGNkMjlkNDUwZDhmODQyN2FjOA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-12T13:19:36Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-12T13:19:36Z"}, "message": "[multiple changes]\n\n2010-10-12  Thomas Quinot  <quinot@adacore.com>\n\n\t* rtsfind.ads, exp_dist.adb, exp_dist.ads (Build_General_Calling_Stubs,\n\tPolyORB case): Request is now a controlled type: we can declare the\n\trequest on the stack, and we do not need explicit cleanup actions\n\tanymore.\n\n2010-10-12  Bob Duff  <duff@adacore.com>\n\n\t* s-rident.ads (Profile_Info): This variable is now constant.\n\nFrom-SVN: r165376", "tree": {"sha": "252c8bc803669133b00449bcd7a159b5bf5e2a18", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/252c8bc803669133b00449bcd7a159b5bf5e2a18"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/comments", "author": null, "committer": null, "parents": [{"sha": "81eb625cc8f9f4d0b032c920cd217591fec2e171", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81eb625cc8f9f4d0b032c920cd217591fec2e171", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81eb625cc8f9f4d0b032c920cd217591fec2e171"}], "stats": {"total": 71, "additions": 40, "deletions": 31}, "files": [{"sha": "efc18bdde1046e894d226384185911f65800cc82", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "patch": "@@ -1,3 +1,14 @@\n+2010-10-12  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* rtsfind.ads, exp_dist.adb, exp_dist.ads (Build_General_Calling_Stubs,\n+\tPolyORB case): Request is now a controlled type: we can declare the\n+\trequest on the stack, and we do not need explicit cleanup actions\n+\tanymore.\n+\n+2010-10-12  Bob Duff  <duff@adacore.com>\n+\n+\t* s-rident.ads (Profile_Info): This variable is now constant.\n+\n 2010-10-12  Emmanuel Briot  <briot@adacore.com>\n \n \t* g-comlin.adb, g-comlin.ads (Define_Switch): Put back (unused)"}, {"sha": "b8feb097b16c56b5b128bb1c5643dfd6d541964e", "filename": "gcc/ada/exp_dist.adb", "status": "modified", "additions": 18, "deletions": 20, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Fexp_dist.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Fexp_dist.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_dist.adb?ref=d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "patch": "@@ -7103,7 +7103,7 @@ package body Exp_Dist is\n            (RE      : RE_Id;\n             Actuals : List_Id := New_List) return Node_Id;\n          --  Generate a procedure call statement calling RE with the given\n-         --  actuals. Request is appended to the list.\n+         --  actuals. Request'Access is appended to the list.\n \n          ---------------------------\n          -- Make_Request_RTE_Call --\n@@ -7114,7 +7114,10 @@ package body Exp_Dist is\n             Actuals : List_Id := New_List) return Node_Id\n          is\n          begin\n-            Append_To (Actuals, New_Occurrence_Of (Request, Loc));\n+            Append_To (Actuals,\n+              Make_Attribute_Reference (Loc,\n+                Prefix         => New_Occurrence_Of (Request, Loc),\n+                Attribute_Name => Name_Access));\n             return Make_Procedure_Call_Statement (Loc,\n                      Name                   =>\n                        New_Occurrence_Of (RTE (RE), Loc),\n@@ -7174,9 +7177,9 @@ package body Exp_Dist is\n          Append_To (Decls,\n            Make_Object_Declaration (Loc,\n              Defining_Identifier => Request,\n-             Aliased_Present     => False,\n+             Aliased_Present     => True,\n              Object_Definition   =>\n-                 New_Occurrence_Of (RTE (RE_Request_Access), Loc)));\n+               New_Occurrence_Of (RTE (RE_Request), Loc)));\n \n          Result := Make_Temporary (Loc, 'R');\n \n@@ -7410,13 +7413,16 @@ package body Exp_Dist is\n          Append_List_To (Statements, Extra_Formal_Statements);\n \n          Append_To (Statements,\n-           Make_Request_RTE_Call (RE_Request_Create, New_List (\n-                                    Target_Object,\n-                                    Subprogram_Id,\n-                                    New_Occurrence_Of (Arguments, Loc),\n-                                    New_Occurrence_Of (Result, Loc),\n-                                    New_Occurrence_Of\n-                                      (RTE (RE_Nil_Exc_List), Loc))));\n+           Make_Procedure_Call_Statement (Loc,\n+             Name =>\n+               New_Occurrence_Of (RTE (RE_Request_Setup), Loc),\n+             Parameter_Associations => New_List (\n+               New_Occurrence_Of (Request, Loc),\n+               Target_Object,\n+               Subprogram_Id,\n+               New_Occurrence_Of (Arguments, Loc),\n+               New_Occurrence_Of (Result, Loc),\n+               New_Occurrence_Of (RTE (RE_Nil_Exc_List), Loc))));\n \n          pragma Assert\n            (not (Is_Known_Non_Asynchronous and Is_Known_Asynchronous));\n@@ -7447,8 +7453,7 @@ package body Exp_Dist is\n          --  Asynchronous case\n \n          if not Is_Known_Non_Asynchronous then\n-            Asynchronous_Statements :=\n-              New_List (Make_Request_RTE_Call (RE_Request_Destroy));\n+            Asynchronous_Statements := New_List (Make_Null_Statement (Loc));\n          end if;\n \n          --  Non-asynchronous case\n@@ -7465,10 +7470,6 @@ package body Exp_Dist is\n                   New_Occurrence_Of (Request, Loc))));\n \n             if Is_Function then\n-\n-               Append_To (Non_Asynchronous_Statements,\n-                 Make_Request_RTE_Call (RE_Request_Destroy));\n-\n                --  If this is a function call, read the value and return it\n \n                Append_To (Non_Asynchronous_Statements,\n@@ -7486,9 +7487,6 @@ package body Exp_Dist is\n                --  Case of a procedure: deal with IN OUT and OUT formals\n \n                Append_List_To (Non_Asynchronous_Statements, After_Statements);\n-\n-               Append_To (Non_Asynchronous_Statements,\n-                 Make_Request_RTE_Call (RE_Request_Destroy));\n             end if;\n          end if;\n "}, {"sha": "382f77a02cb503e853e72e6c9c50e58e4d2d52a6", "filename": "gcc/ada/exp_dist.ads", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Fexp_dist.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Fexp_dist.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_dist.ads?ref=d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -35,7 +35,7 @@ package Exp_Dist is\n    PCS_Version_Number : constant array (PCS_Names) of Int :=\n                           (Name_No_DSA      => 1,\n                            Name_GARLIC_DSA  => 1,\n-                           Name_PolyORB_DSA => 3);\n+                           Name_PolyORB_DSA => 4);\n    --  PCS interface version. This is used to check for consistency between the\n    --  compiler used to generate distribution stubs and the PCS implementation.\n    --  It must be incremented whenever a change is made to the generated code"}, {"sha": "959a580b08f0ab722a6f3df60b8eb9f370599e36", "filename": "gcc/ada/rtsfind.ads", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Frtsfind.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Frtsfind.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frtsfind.ads?ref=d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "patch": "@@ -1135,6 +1135,7 @@ package Rtsfind is\n      RE_Raise_Program_Error_Unknown_Tag, -- System.Partition_Interface\n      RE_Register_Passive_Package,        -- System.Partition_Interface\n      RE_Register_Receiving_Stub,         -- System.Partition_Interface\n+     RE_Request,                         -- System.Partition_Interface\n      RE_Request_Access,                  -- System.Partition_Interface\n      RE_RCI_Locator,                     -- System.Partition_Interface\n      RE_RCI_Subp_Info,                   -- System.Partition_Interface\n@@ -1174,12 +1175,11 @@ package Rtsfind is\n      RE_NVList_Ref,                      -- System.Partition_Interface\n      RE_NVList_Create,                   -- System.Partition_Interface\n      RE_NVList_Add_Item,                 -- System.Partition_Interface\n-     RE_Request_Create,                  -- System.Partition_Interface\n-     RE_Request_Invoke,                  -- System.Partition_Interface\n      RE_Request_Arguments,               -- System.Partition_Interface\n-     RE_Request_Set_Out,                 -- System.Partition_Interface\n+     RE_Request_Invoke,                  -- System.Partition_Interface\n      RE_Request_Raise_Occurrence,        -- System.Partition_Interface\n-     RE_Request_Destroy,                 -- System.Partition_Interface\n+     RE_Request_Set_Out,                 -- System.Partition_Interface\n+     RE_Request_Setup,                   -- System.Partition_Interface\n      RE_Nil_Exc_List,                    -- System.Partition_Interface\n      RE_Servant,                         -- System.Partition_Interface\n      RE_Move_Any_Value,                  -- System.Partition_Interface\n@@ -2308,6 +2308,7 @@ package Rtsfind is\n      RE_Raise_Program_Error_Unknown_Tag  => System_Partition_Interface,\n      RE_Register_Passive_Package         => System_Partition_Interface,\n      RE_Register_Receiving_Stub          => System_Partition_Interface,\n+     RE_Request                          => System_Partition_Interface,\n      RE_Request_Access                   => System_Partition_Interface,\n      RE_RCI_Locator                      => System_Partition_Interface,\n      RE_RCI_Subp_Info                    => System_Partition_Interface,\n@@ -2338,12 +2339,11 @@ package Rtsfind is\n      RE_NVList_Ref                       => System_Partition_Interface,\n      RE_NVList_Create                    => System_Partition_Interface,\n      RE_NVList_Add_Item                  => System_Partition_Interface,\n-     RE_Request_Create                   => System_Partition_Interface,\n-     RE_Request_Invoke                   => System_Partition_Interface,\n      RE_Request_Arguments                => System_Partition_Interface,\n-     RE_Request_Set_Out                  => System_Partition_Interface,\n+     RE_Request_Invoke                   => System_Partition_Interface,\n      RE_Request_Raise_Occurrence         => System_Partition_Interface,\n-     RE_Request_Destroy                  => System_Partition_Interface,\n+     RE_Request_Set_Out                  => System_Partition_Interface,\n+     RE_Request_Setup                    => System_Partition_Interface,\n      RE_Nil_Exc_List                     => System_Partition_Interface,\n      RE_Servant                          => System_Partition_Interface,\n      RE_Move_Any_Value                   => System_Partition_Interface,"}, {"sha": "da8868e3417069907ed3e248566d0d3b5902f4bc", "filename": "gcc/ada/s-rident.ads", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Fs-rident.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d80ee77c1eff34e01d2110cd29d450d8f8427ac8/gcc%2Fada%2Fs-rident.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-rident.ads?ref=d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "patch": "@@ -329,7 +329,7 @@ package System.Rident is\n       --  value of the parameter permitted by the profile.\n    end record;\n \n-   Profile_Info : array (Profile_Name_Actual) of Profile_Data :=\n+   Profile_Info : constant array (Profile_Name_Actual) of Profile_Data :=\n \n                      --  Restricted Profile\n "}]}