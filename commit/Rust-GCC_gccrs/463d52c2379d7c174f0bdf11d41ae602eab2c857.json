{"sha": "463d52c2379d7c174f0bdf11d41ae602eab2c857", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDYzZDUyYzIzNzlkN2MxNzRmMGJkZjExZDQxYWU2MDJlYWIyYzg1Nw==", "commit": {"author": {"name": "Oleg Endo", "email": "olegendo@gcc.gnu.org", "date": "2014-12-21T23:37:42Z"}, "committer": {"name": "Oleg Endo", "email": "olegendo@gcc.gnu.org", "date": "2014-12-21T23:37:42Z"}, "message": "re PR target/55212 ([SH] Switch to LRA)\n\ngcc/\n\tPR target/55212\n\t* config/sh/sh.md (*addsi3_compact): Add parentheses around &&\n\tcondition.  Add comments.\n\nFrom-SVN: r218999", "tree": {"sha": "fce65b4bb96d390704dbae75266024bce5d75639", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fce65b4bb96d390704dbae75266024bce5d75639"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/463d52c2379d7c174f0bdf11d41ae602eab2c857", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/463d52c2379d7c174f0bdf11d41ae602eab2c857", "html_url": "https://github.com/Rust-GCC/gccrs/commit/463d52c2379d7c174f0bdf11d41ae602eab2c857", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/463d52c2379d7c174f0bdf11d41ae602eab2c857/comments", "author": null, "committer": null, "parents": [{"sha": "9b09bfac867d563cbd2ec6fdffc7b7e4239b51ad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b09bfac867d563cbd2ec6fdffc7b7e4239b51ad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b09bfac867d563cbd2ec6fdffc7b7e4239b51ad"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "e5d16f9d01e2eee35315f996f346f9d9240c6304", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/463d52c2379d7c174f0bdf11d41ae602eab2c857/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/463d52c2379d7c174f0bdf11d41ae602eab2c857/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=463d52c2379d7c174f0bdf11d41ae602eab2c857", "patch": "@@ -1,3 +1,9 @@\n+2014-12-17  Oleg Endo  <olegendo@gcc.gnu.org>\n+\n+\tPR target/55212\n+\t* config/sh/sh.md (*addsi3_compact): Add parentheses around &&\n+\tcondition.  Add comments.\n+\n 2014-12-20  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \tPR target/64358"}, {"sha": "7b68aa1b912ff584c2fde01d025cc0fc97172509", "filename": "gcc/config/sh/sh.md", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/463d52c2379d7c174f0bdf11d41ae602eab2c857/gcc%2Fconfig%2Fsh%2Fsh.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/463d52c2379d7c174f0bdf11d41ae602eab2c857/gcc%2Fconfig%2Fsh%2Fsh.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.md?ref=463d52c2379d7c174f0bdf11d41ae602eab2c857", "patch": "@@ -2056,14 +2056,20 @@\n   [(set_attr \"type\" \"arith_media\")\n    (set_attr \"highpart\" \"ignore\")])\n \n+;; The *addsi3_compact is made an insn_and_split and accepts actually\n+;; impossible constraints to make LRA's register elimination work well on SH.\n+;; The problem is that LRA expects something like\n+;;    (set rA (plus rB (const_int N)))\n+;; to work.  We can do that, but we have to split out an additional reg-reg\n+;; copy before the actual add insn.\n (define_insn_and_split \"*addsi3_compact\"\n   [(set (match_operand:SI 0 \"arith_reg_dest\" \"=r,&r\")\n \t(plus:SI (match_operand:SI 1 \"arith_operand\" \"%0,r\")\n \t\t (match_operand:SI 2 \"arith_or_int_operand\" \"rI08,rn\")))]\n   \"TARGET_SH1\n-   && (rtx_equal_p (operands[0], operands[1])\n-       && arith_operand (operands[2], SImode))\n-      || ! reg_overlap_mentioned_p (operands[0], operands[1])\"\n+   && ((rtx_equal_p (operands[0], operands[1])\n+        && arith_operand (operands[2], SImode))\n+       || ! reg_overlap_mentioned_p (operands[0], operands[1]))\"\n   \"@\n \tadd\t%2,%0\n \t#\""}]}