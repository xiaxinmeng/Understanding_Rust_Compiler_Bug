{"sha": "abcde0a658e17dbbabcb396eaae5a3612e07d401", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWJjZGUwYTY1OGUxN2RiYmFiY2IzOTZlYWFlNWEzNjEyZTA3ZDQwMQ==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2020-06-23T06:14:51Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2020-06-23T06:14:51Z"}, "message": "Handle AR_FULL vs. AR_FULL in dependency checking.\n\nPreviously, handling of full vs. full references failed to take\nAR_FULL vs. AR_FULL into account.  A change in dependency\nchecking in gcc 10 created a code path that could lead there;\nwith this patch, this is now correctly handled.\n\ngcc/fortran/ChangeLog:\n\n2020-06-23  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/95812\n\t* dependency.c (ref_same_as_full_array): Handle case of AR_FULL\n\tvs. AR_FULL.\n\ngcc/testsuite/ChangeLog:\n\n2020-06-23  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/95812\n\t* gfortran.dg/dependency_59.f90: New test.", "tree": {"sha": "4019dff4c6c8d2fd1db057987848b4bb69ea816e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4019dff4c6c8d2fd1db057987848b4bb69ea816e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/abcde0a658e17dbbabcb396eaae5a3612e07d401", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abcde0a658e17dbbabcb396eaae5a3612e07d401", "html_url": "https://github.com/Rust-GCC/gccrs/commit/abcde0a658e17dbbabcb396eaae5a3612e07d401", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abcde0a658e17dbbabcb396eaae5a3612e07d401/comments", "author": null, "committer": null, "parents": [{"sha": "384aa890255dc01ba6d6529b127975c2c9a49a3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/384aa890255dc01ba6d6529b127975c2c9a49a3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/384aa890255dc01ba6d6529b127975c2c9a49a3c"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "7edd5d9010d6eb02f2170c80505925ba2d4cdc60", "filename": "gcc/fortran/dependency.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abcde0a658e17dbbabcb396eaae5a3612e07d401/gcc%2Ffortran%2Fdependency.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abcde0a658e17dbbabcb396eaae5a3612e07d401/gcc%2Ffortran%2Fdependency.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdependency.c?ref=abcde0a658e17dbbabcb396eaae5a3612e07d401", "patch": "@@ -2033,6 +2033,8 @@ ref_same_as_full_array (gfc_ref *full_ref, gfc_ref *ref)\n     return false;\n   if (ref->type != REF_ARRAY)\n     return false;\n+  if (ref->u.ar.type == AR_FULL)\n+    return true;\n   if (ref->u.ar.type != AR_SECTION)\n     return false;\n "}, {"sha": "90c6532392c58d11dca4d0509cd2df4a7cb547b0", "filename": "gcc/testsuite/gfortran.dg/dependency_59.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abcde0a658e17dbbabcb396eaae5a3612e07d401/gcc%2Ftestsuite%2Fgfortran.dg%2Fdependency_59.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abcde0a658e17dbbabcb396eaae5a3612e07d401/gcc%2Ftestsuite%2Fgfortran.dg%2Fdependency_59.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdependency_59.f90?ref=abcde0a658e17dbbabcb396eaae5a3612e07d401", "patch": "@@ -0,0 +1,15 @@\n+! { dg-do compile }\n+! PR 95812 - this caused an ICE.\n+! Test case by Jakub Jelinek.\n+\n+module test\n+contains\n+  subroutine foo()\n+    integer :: a(3)\n+    a = 1\n+    print *, matmul(1*reshape(a,(/3,1/)), reshape((/1,1,1/),(/1,3/)))\n+  end subroutine foo\n+  subroutine bar()\n+    call foo()\n+  end subroutine bar\n+end module test"}]}