{"sha": "58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NThkYTE5MmU3YTM1ZWQxNmUyM2Q1YTMzMjQ2ZDY4ZmFlM2QxYTFkYw==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-04-24T23:17:29Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-04-24T23:17:29Z"}, "message": "re PR fortran/85520 (Out of memory when declaring a character with len << 0)\n\n2018-04-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/85520\n\t* decl.c (gfc_match_char_spec): Check for negative length and set to 0.\n\n2018-04-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/85520\n\t* gfortran.dg/pr85520.f90: New test.\n\nFrom-SVN: r259623", "tree": {"sha": "5fc084040ddbfbf1950f194b1e97005353888bae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5fc084040ddbfbf1950f194b1e97005353888bae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/comments", "author": null, "committer": null, "parents": [{"sha": "08417efa3ad973ba7b1be5b6a530e0b186e3c294", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08417efa3ad973ba7b1be5b6a530e0b186e3c294", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08417efa3ad973ba7b1be5b6a530e0b186e3c294"}], "stats": {"total": 23, "additions": 22, "deletions": 1}, "files": [{"sha": "46c234fdab9cb1dd77ff3c2c3281fdd0a93c7c79", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "patch": "@@ -1,3 +1,8 @@\n+2018-04-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/85520\n+\t* decl.c (gfc_match_char_spec): Check for negative length and set to 0.\n+\n 2018-04-14  Andre Vehreschild  <vehre@gcc.gnu.org>\n \n \tPR fortran/81773"}, {"sha": "d1b75ccd54c750f0fbf7f9bdd3ade01deaca56eb", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "patch": "@@ -3235,7 +3235,11 @@ gfc_match_char_spec (gfc_typespec *ts)\n \t  e = gfc_copy_expr (len);\n \t  gfc_reduce_init_expr (e);\n \t  if (e->expr_type == EXPR_CONSTANT)\n-\t    gfc_replace_expr (len, e);\n+\t    {\n+\t      gfc_replace_expr (len, e);\n+\t      if (mpz_cmp_si (len->value.integer, 0) < 0)\n+\t\tmpz_set_ui (len->value.integer, 0);\n+\t    }\n \t  else\n \t    gfc_free_expr (e);\n \t  cl->length = len;"}, {"sha": "6ba8fede06b111d709cdbd4e26626c3d3a3a5e1f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "patch": "@@ -1,3 +1,8 @@\n+2018-04-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/85520\n+\t* gfortran.dg/pr85520.f90: New test.\n+\n 2018-04-24  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \tPR target/85512"}, {"sha": "3e66a9020f8de016e50534be6929a6b5f805735c", "filename": "gcc/testsuite/gfortran.dg/pr85520.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr85520.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58da192e7a35ed16e23d5a33246d68fae3d1a1dc/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr85520.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr85520.f90?ref=58da192e7a35ed16e23d5a33246d68fae3d1a1dc", "patch": "@@ -0,0 +1,7 @@\n+! { dg-do run }\n+! PR fortran/85520\n+! Original code from Gerhard Steinmetz <gscfq at t-online dot de>\n+program p\n+   character(-huge(1)) :: c = ' '\n+    if (len(c) /= 0) stop 1\n+end"}]}