{"sha": "85fff2f3a06fd68f79ed0117d538fe6fc265bac6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVmZmYyZjNhMDZmZDY4Zjc5ZWQwMTE3ZDUzOGZlNmZjMjY1YmFjNg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-06-28T09:34:30Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-06-28T09:34:30Z"}, "message": "(movsf): Emit frsp if storing to memory and not PowerPC.\n\n(movsf matcher): Remove explicit frsp.\n(store sf with update): Likewise.\n\nFrom-SVN: r7578", "tree": {"sha": "41af52eb27bd2e0b0201ad71b841fe4853712181", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41af52eb27bd2e0b0201ad71b841fe4853712181"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85fff2f3a06fd68f79ed0117d538fe6fc265bac6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85fff2f3a06fd68f79ed0117d538fe6fc265bac6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85fff2f3a06fd68f79ed0117d538fe6fc265bac6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85fff2f3a06fd68f79ed0117d538fe6fc265bac6/comments", "author": null, "committer": null, "parents": [{"sha": "ab4a5fc941f08f7db76538aba22f91bc15fe7a17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab4a5fc941f08f7db76538aba22f91bc15fe7a17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab4a5fc941f08f7db76538aba22f91bc15fe7a17"}], "stats": {"total": 21, "additions": 17, "deletions": 4}, "files": [{"sha": "0c4846f4e162e5882efcbc9e240d6b520a2f57d6", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 17, "deletions": 4, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85fff2f3a06fd68f79ed0117d538fe6fc265bac6/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85fff2f3a06fd68f79ed0117d538fe6fc265bac6/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=85fff2f3a06fd68f79ed0117d538fe6fc265bac6", "patch": "@@ -3788,7 +3788,20 @@\n     }\n \n   if (GET_CODE (operands[0]) == MEM)\n-    operands[1] = force_reg (SFmode, operands[1]);\n+    {\n+      operands[1] = force_reg (SFmode, operands[1]);\n+      if (! TARGET_POWERPC)\n+\tif (reload_in_progress || reload_completed)\n+\t  emit_insn (gen_truncdfsf2 (operands[1],\n+\t\t\t\t     gen_rtx (SUBREG, DFmode, operands[1], 0)));\n+\telse\n+\t  {\n+\t    rtx newreg = gen_reg_rtx (SFmode);\n+\t    emit_insn (gen_truncdfsf2 (newreg,\n+                                       gen_rtx (SUBREG, DFmode, operands[1], 0)));\n+\t    operands[1] = newreg;\n+          }\n+    }\n \n   if (GET_CODE (operands[0]) == REG && REGNO (operands[0]) < 32)\n     {\n@@ -3842,7 +3855,7 @@\n   \"@\n    fmr %0,%1\n    lfs%U1%X1 %0,%1\n-   frsp %1,%1\\;stfs%U0%X0 %1,%0\"\n+   stfs%U0%X0 %1,%0\"\n   [(set_attr \"type\" \"fp,fpload,*\")\n    (set_attr \"length\" \"*,*,8\")])\n \f\n@@ -4439,8 +4452,8 @@\n \t(plus:SI (match_dup 1) (match_dup 2)))]\n   \"\"\n   \"@\n-   frsp %3,%3\\;stfsux %3,%0,%2\n-   frsp %3,%3\\;stfsu %3,%2(%0)\")\n+   stfsux %3,%0,%2\n+   stfsu %3,%2(%0)\")\n \n (define_insn \"\"\n   [(set (match_operand:DF 3 \"gpc_reg_operand\" \"=f,f\")"}]}