{"sha": "a00084346a299e8154ede732c6d4d3ae56d1f66f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTAwMDg0MzQ2YTI5OWU4MTU0ZWRlNzMyYzZkNGQzYWU1NmQxZjY2Zg==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2016-08-04T07:47:50Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2016-08-04T07:47:50Z"}, "message": "re PR c++/70229 (error: constexpr constructor does not have empty body)\n\n\tPR c++/70229\n\t* constexpr.c (check_constexpr_ctor_body_1): Allow typedef\n\tdeclarations.\n\n\t* g++.dg/cpp0x/constexpr-ctor19.C: New test.\n\nFrom-SVN: r239115", "tree": {"sha": "d15afcd494f4ffb17686aa081db652476c463186", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d15afcd494f4ffb17686aa081db652476c463186"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a00084346a299e8154ede732c6d4d3ae56d1f66f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a00084346a299e8154ede732c6d4d3ae56d1f66f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a00084346a299e8154ede732c6d4d3ae56d1f66f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a00084346a299e8154ede732c6d4d3ae56d1f66f/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fb46286e8d34e8bffdc9d04ec4cf4b10698a7e20", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb46286e8d34e8bffdc9d04ec4cf4b10698a7e20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb46286e8d34e8bffdc9d04ec4cf4b10698a7e20"}], "stats": {"total": 56, "additions": 55, "deletions": 1}, "files": [{"sha": "2a993701fd684035a121904ca73aa9ffc4cecb0b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a00084346a299e8154ede732c6d4d3ae56d1f66f", "patch": "@@ -1,3 +1,9 @@\n+2016-08-04  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/70229\n+\t* constexpr.c (check_constexpr_ctor_body_1): Allow typedef\n+\tdeclarations.\n+\n 2016-08-01  Jason Merrill  <jason@redhat.com>\n \n \t* mangle.c (mangle_decl): Warn about mangled name change even if"}, {"sha": "41665c5a36e1828e8a069bf0ccba55e46c6de177", "filename": "gcc/cp/constexpr.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Fcp%2Fconstexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Fcp%2Fconstexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fconstexpr.c?ref=a00084346a299e8154ede732c6d4d3ae56d1f66f", "patch": "@@ -425,7 +425,8 @@ check_constexpr_ctor_body_1 (tree last, tree list)\n   switch (TREE_CODE (list))\n     {\n     case DECL_EXPR:\n-      if (TREE_CODE (DECL_EXPR_DECL (list)) == USING_DECL)\n+      if (TREE_CODE (DECL_EXPR_DECL (list)) == USING_DECL\n+\t  || TREE_CODE (DECL_EXPR_DECL (list)) == TYPE_DECL)\n \treturn true;\n       return false;\n "}, {"sha": "b5d8ee5dc33c09395bcaa395f5dd86490d24a3a1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a00084346a299e8154ede732c6d4d3ae56d1f66f", "patch": "@@ -1,3 +1,8 @@\n+2016-08-04  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/70229\n+\t* g++.dg/cpp0x/constexpr-ctor19.C: New test.\n+\n 2016-08-04  Richard Biener  <rguenther@suse.de>\n \n \tPR middle-end/71984"}, {"sha": "f5ef053e0c44b5c89a10ae0dfc555f6302c2105d", "filename": "gcc/testsuite/g++.dg/cpp0x/constexpr-ctor19.C", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-ctor19.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a00084346a299e8154ede732c6d4d3ae56d1f66f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-ctor19.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fconstexpr-ctor19.C?ref=a00084346a299e8154ede732c6d4d3ae56d1f66f", "patch": "@@ -0,0 +1,42 @@\n+// PR c++/70229\n+// { dg-do compile { target c++11 } }\n+\n+template <class>\n+class S {\n+  constexpr S (void) {\n+    typedef int T;\n+  }\n+};\n+\n+template <class>\n+class S2 {\n+  constexpr S2 (void) {\n+    ;\n+  }\n+};\n+\n+template <class>\n+class S3 {\n+  constexpr S3 (void) {\n+    typedef enum { X } E;\n+  } // { dg-error \"does not have empty body\" \"\" { target c++11_only } }\n+};\n+\n+template <class>\n+class S4 {\n+  constexpr S4 (void) {\n+    typedef struct { int j; } U;\n+  } // { dg-error \"does not have empty body\" \"\" { target c++11_only } }\n+};\n+\n+struct V\n+{\n+  int i;\n+};\n+\n+template <class>\n+class S5 {\n+  constexpr S5 (void) {\n+    typedef V W;\n+  }\n+};"}]}