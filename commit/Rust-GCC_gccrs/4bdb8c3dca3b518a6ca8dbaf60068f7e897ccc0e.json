{"sha": "4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGJkYjhjM2RjYTNiNTE4YTZjYThkYmFmNjAwNjhmN2U4OTdjY2MwZQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2019-10-02T13:11:45Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2019-10-02T13:11:45Z"}, "message": "Fix MIPS call-clobbered-*.c tests\n\nJeff pointed out that gcc.target/mips/call-clobbered-4.c started\nfailing after the function-abi series.  This is because IRA used\nto treat partly call-clobbered registers as hard conflicts and\nso wouldn't consider them for -fcaller-saves.  Now that we treat\ncall clobbers the same way regardless of where they come from,\nwe can use $f21 as a caller-save register.  This in turn means\nthat -Os is no longer a special case in call-clobbered-3.c.\n\n(The new code is the same size as the old code.)\n\n2019-10-02  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/testsuite/\n\t* gcc.target/mips/call-clobbered-3.c: Remove skip for -Os.\n\t* gcc.target/mips/call-clobbered-4.c: Delete.\n\nFrom-SVN: r276456", "tree": {"sha": "a80c46e65cb113c23411ef8d25a925fbb7fe6cc8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a80c46e65cb113c23411ef8d25a925fbb7fe6cc8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3187c8a5010f4245ff008a0fc2fb746a8bce4a00", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3187c8a5010f4245ff008a0fc2fb746a8bce4a00", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3187c8a5010f4245ff008a0fc2fb746a8bce4a00"}], "stats": {"total": 30, "additions": 5, "deletions": 25}, "files": [{"sha": "9ca45cb9b878c735dc86697b37352ae8fb6bff66", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e", "patch": "@@ -1,3 +1,8 @@\n+2019-10-02  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* gcc.target/mips/call-clobbered-3.c: Remove skip for -Os.\n+\t* gcc.target/mips/call-clobbered-4.c: Delete.\n+\n 2019-10-02  Tobias Burnus  <tobias@codesourcery.com>\n \n \t* gfortran.dg/gomp/is_device_ptr-1.f90: New."}, {"sha": "3a9e8d883fc7a72d32b153b906353abe6bfbe17a", "filename": "gcc/testsuite/gcc.target/mips/call-clobbered-3.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-clobbered-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-clobbered-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-clobbered-3.c?ref=4bdb8c3dca3b518a6ca8dbaf60068f7e897ccc0e", "patch": "@@ -1,7 +1,5 @@\n /* Check that we handle call-clobbered FPRs correctly.  */\n /* { dg-skip-if \"code quality test\" { *-*-* } { \"-O0\" } { \"\" } } */\n-/* Refer to call-clobbered-4.c to see the expected output from -Os builds.  */\n-/* { dg-skip-if \"uses callee-saved GPR\" { *-*-* } { \"-Os\" } { \"\" } } */\n /* { dg-options \"-mabi=32 -modd-spreg -mfpxx -ffixed-f0 -ffixed-f1 -ffixed-f2 -ffixed-f3 -ffixed-f4 -ffixed-f5 -ffixed-f6 -ffixed-f7 -ffixed-f8 -ffixed-f9 -ffixed-f10 -ffixed-f11 -ffixed-f12 -ffixed-f13 -ffixed-f14 -ffixed-f15 -ffixed-f16 -ffixed-f17 -ffixed-f18 -ffixed-f19 -ffixed-f20 -ffixed-f22 -ffixed-f24 -ffixed-f26 -ffixed-f28 -ffixed-f30\" } */\n \n void bar (void);"}, {"sha": "51498b8fa283aa96b333ef42dd1f88306f165b32", "filename": "gcc/testsuite/gcc.target/mips/call-clobbered-4.c", "status": "removed", "additions": 0, "deletions": 23, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3187c8a5010f4245ff008a0fc2fb746a8bce4a00/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-clobbered-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3187c8a5010f4245ff008a0fc2fb746a8bce4a00/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-clobbered-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-clobbered-4.c?ref=3187c8a5010f4245ff008a0fc2fb746a8bce4a00", "patch": "@@ -1,23 +0,0 @@\n-/* Check that we handle call-clobbered FPRs correctly.\n-   This test differs from call-clobbered-3.c because when optimising for size\n-   a callee-saved GPR is used for 'b' to cross the call.  */\n-/* { dg-skip-if \"code quality test\" { *-*-* } { \"*\" } { \"-Os\" } } */\n-/* { dg-options \"-mabi=32 -modd-spreg -mfpxx -ffixed-f0 -ffixed-f1 -ffixed-f2 -ffixed-f3 -ffixed-f4 -ffixed-f5 -ffixed-f6 -ffixed-f7 -ffixed-f8 -ffixed-f9 -ffixed-f10 -ffixed-f11 -ffixed-f12 -ffixed-f13 -ffixed-f14 -ffixed-f15 -ffixed-f16 -ffixed-f17 -ffixed-f18 -ffixed-f19 -ffixed-f20 -ffixed-f22 -ffixed-f24 -ffixed-f26 -ffixed-f28 -ffixed-f30\" } */\n-\n-void bar (void);\n-float a;\n-float\n-foo ()\n-{\n-  float b = a + 1.0f;\n-  bar();\n-  return b;\n-}\n-/* { dg-final { scan-assembler-times \"lwc1\" 4 } } */\n-/* { dg-final { scan-assembler-times \"swc1\" 2 } } */\n-/* { dg-final { scan-assembler-times \"mtc\" 1 } } */\n-/* { dg-final { scan-assembler-times \"mfc\" 1 } } */\n-/* { dg-final { scan-assembler-not \"mthc\" } } */\n-/* { dg-final { scan-assembler-not \"mfhc\" } } */\n-/* { dg-final { scan-assembler-not \"ldc1\" } } */\n-/* { dg-final { scan-assembler-not \"sdc1\" } } */"}]}