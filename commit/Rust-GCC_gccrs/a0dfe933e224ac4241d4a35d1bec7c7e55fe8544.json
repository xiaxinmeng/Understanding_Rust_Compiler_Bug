{"sha": "a0dfe933e224ac4241d4a35d1bec7c7e55fe8544", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTBkZmU5MzNlMjI0YWM0MjQxZDRhMzVkMWJlYzdjN2U1NWZlODU0NA==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-02-25T23:10:36Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-02-25T23:10:36Z"}, "message": "choose-temp.c: Fix handling of sys/file.h to work in libiberty.\n\n8\n        * choose-temp.c: Fix handling of sys/file.h to work in libiberty.\n\nFrom-SVN: r18242", "tree": {"sha": "7ff7e49e9952b57607996b458d8a5b199453fcdb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7ff7e49e9952b57607996b458d8a5b199453fcdb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a0dfe933e224ac4241d4a35d1bec7c7e55fe8544", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0dfe933e224ac4241d4a35d1bec7c7e55fe8544", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0dfe933e224ac4241d4a35d1bec7c7e55fe8544", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0dfe933e224ac4241d4a35d1bec7c7e55fe8544/comments", "author": null, "committer": null, "parents": [{"sha": "c3cf395b61d4df4fea1e155295ff15641589bff9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3cf395b61d4df4fea1e155295ff15641589bff9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3cf395b61d4df4fea1e155295ff15641589bff9"}], "stats": {"total": 22, "additions": 13, "deletions": 9}, "files": [{"sha": "5668f745207bb178653c4e7cb92895c44c50a20d", "filename": "gcc/choose-temp.c", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0dfe933e224ac4241d4a35d1bec7c7e55fe8544/gcc%2Fchoose-temp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0dfe933e224ac4241d4a35d1bec7c7e55fe8544/gcc%2Fchoose-temp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fchoose-temp.c?ref=a0dfe933e224ac4241d4a35d1bec7c7e55fe8544", "patch": "@@ -1,5 +1,5 @@\n /* Utility to pick a temporary filename prefix.\n-   Copyright (C) 1996 Free Software Foundation, Inc.\n+   Copyright (C) 1996, 1997, 1998 Free Software Foundation, Inc.\n \n This file is part of the libiberty library.\n Libiberty is free software; you can redistribute it and/or\n@@ -22,7 +22,16 @@ Boston, MA 02111-1307, USA.  */\n /* This file lives in at least two places: libiberty and gcc.\n    Don't change one without the other.  */\n \n-#ifndef NO_SYS_FILE_H\n+#if defined (IN_GCC) || defined (HAVE_CONFIG_H)\n+#include \"config.h\"\n+#endif\n+\n+/* If we are in gcc, or we have a config.h, we assume that\n+   HAVE_SYS_FILE_H tells us whether to include sys/file.h.  However,\n+   libiberty does not have a config.h, and instead arranges to define\n+   NO_SYS_FILE_H on the command line when there is no sys/file.h.  */\n+\n+#if (defined (IN_GCC) || defined (HAVE_CONFIG_H)) ? defined (HAVE_SYS_FILE_H) : ! defined (NO_SYS_FILE_H)\n #include <sys/types.h>\n #include <sys/file.h>   /* May get R_OK, etc. on some systems.  */\n #endif\n@@ -36,7 +45,6 @@ Boston, MA 02111-1307, USA.  */\n #include <stdio.h>\t/* May get P_tmpdir.  */\n \n #ifdef IN_GCC\n-#include \"config.h\"\n #include \"gansidecl.h\"\n extern char *xmalloc ();\n #else\n@@ -54,7 +62,7 @@ extern char *xmalloc ();\n /* On MSDOS, write temp files in current dir\n    because there's no place else we can expect to use.  */\n /* ??? Although the current directory is tried as a last resort,\n-   this is left in so that on MSDOS it is prefered to /tmp on the\n+   this is left in so that on MSDOS it is preferred to /tmp on the\n    off chance that someone requires this, since that was the previous\n    behaviour.  */\n #ifdef __MSDOS__\n@@ -68,7 +76,7 @@ extern char *xmalloc ();\n #define TEMP_FILE \"ccXXXXXX\"\n \n /* Subroutine of choose_temp_base.\n-   If BASE is non-NULL, returh it.\n+   If BASE is non-NULL, return it.\n    Otherwise it checks if DIR is a usable directory.\n    If success, DIR is returned.\n    Otherwise NULL is returned.  */\n@@ -114,11 +122,7 @@ choose_temp_base ()\n  \n   /* If all else fails, use the current directory!  */\n   if (base == 0)\n-#ifdef VMS\n-    base = \"[\";\n-#else\n     base = \".\";\n-#endif\n \n #else /* MPW */\n   base = \":\";"}]}