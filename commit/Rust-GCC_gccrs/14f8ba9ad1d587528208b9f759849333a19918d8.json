{"sha": "14f8ba9ad1d587528208b9f759849333a19918d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTRmOGJhOWFkMWQ1ODc1MjgyMDhiOWY3NTk4NDkzMzNhMTk5MThkOA==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2018-05-29T09:41:45Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-05-29T09:41:45Z"}, "message": "[Ada] Unnesting: exclude selected components whose prefix carry no type\n\n2018-05-29  Ed Schonberg  <schonberg@adacore.com>\n\ngcc/ada/\n\n\t* exp_unst.adb (Visit_Node): Exclude selected components whose prefix\n\tcarry no type. Such selected components appear in unit names that are\n\tchild units, both in the specification and possibly in an end label for\n\tthe unit, and they do not contain any relevant uplevel references.\n\nFrom-SVN: r260879", "tree": {"sha": "224aab2a85d5aeddcdae97d5e089f985a92fd5a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/224aab2a85d5aeddcdae97d5e089f985a92fd5a0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/14f8ba9ad1d587528208b9f759849333a19918d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14f8ba9ad1d587528208b9f759849333a19918d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14f8ba9ad1d587528208b9f759849333a19918d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14f8ba9ad1d587528208b9f759849333a19918d8/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ec3b72c55d064424cd9ed3b92b1bd7be5b501ecd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec3b72c55d064424cd9ed3b92b1bd7be5b501ecd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec3b72c55d064424cd9ed3b92b1bd7be5b501ecd"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "4eb12c5fa8756e610a2206faf2f6bddf9bb5d845", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14f8ba9ad1d587528208b9f759849333a19918d8/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14f8ba9ad1d587528208b9f759849333a19918d8/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=14f8ba9ad1d587528208b9f759849333a19918d8", "patch": "@@ -1,3 +1,10 @@\n+2018-05-29  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* exp_unst.adb (Visit_Node): Exclude selected components whose prefix\n+\tcarry no type. Such selected components appear in unit names that are\n+\tchild units, both in the specification and possibly in an end label for\n+\tthe unit, and they do not contain any relevant uplevel references.\n+\n 2018-05-29  Arnaud Charlet  <charlet@adacore.com>\n \n \t* libgnat/a-calend.ads, libgnat/a-calend.adb (Epoch_Offset): Make it a"}, {"sha": "b1383f9546c221022c21ce9af65068dbe27e7ff3", "filename": "gcc/ada/exp_unst.adb", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14f8ba9ad1d587528208b9f759849333a19918d8/gcc%2Fada%2Fexp_unst.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14f8ba9ad1d587528208b9f759849333a19918d8/gcc%2Fada%2Fexp_unst.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_unst.adb?ref=14f8ba9ad1d587528208b9f759849333a19918d8", "patch": "@@ -753,7 +753,13 @@ package body Exp_Unst is\n             --  simplify the processing here by examining all components\n             --  of the record.\n \n-            elsif Nkind (N) = N_Selected_Component then\n+            --  Selected components appear as unit names and end labels for\n+            --  child units. The prefixes of these nodes denote parent\n+            --  units and carry no type information so they are skipped.\n+\n+            elsif Nkind (N) = N_Selected_Component\n+              and then Present (Etype (Prefix (N)))\n+            then\n                declare\n                   DT : Boolean := False;\n                begin"}]}