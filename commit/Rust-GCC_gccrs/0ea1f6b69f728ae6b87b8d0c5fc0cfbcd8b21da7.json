{"sha": "0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGVhMWY2YjY5ZjcyOGFlNmI4N2I4ZDBjNWZjMGNmYmNkOGIyMWRhNw==", "commit": {"author": {"name": "Michael Hayes", "email": "m.hayes@elec.canterbury.ac.nz", "date": "2000-07-30T08:12:12Z"}, "committer": {"name": "Michael Hayes", "email": "m.hayes@gcc.gnu.org", "date": "2000-07-30T08:12:12Z"}, "message": "* config/c4x/libgcc.S: (divqf3): Improve accuracy.\n\nFrom-SVN: r35335", "tree": {"sha": "6948737ff40bd44eec2ac057bff6c63e386db935", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6948737ff40bd44eec2ac057bff6c63e386db935"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7/comments", "author": null, "committer": null, "parents": [{"sha": "00c9e663546bf07c2886e99b4c691727ea08020a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00c9e663546bf07c2886e99b4c691727ea08020a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00c9e663546bf07c2886e99b4c691727ea08020a"}], "stats": {"total": 29, "additions": 19, "deletions": 10}, "files": [{"sha": "a061e29db78f7f1c8070915a15e59ea6c13391bf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7", "patch": "@@ -1,3 +1,7 @@\n+2000-07-30  Michael Hayes  <m.hayes@elec.canterbury.ac.nz>\n+\n+\t* config/c4x/libgcc.S: (divqf3): Improve accuracy.\n+\n 2000-07-27  Mark Mitchell  <mark@codesourcery.com>\n \n \tPut phi nodes after NOTE_INSN_BASIC_BLOCK."}, {"sha": "06b1a756aba3e12b4b35a951c6a09b309ca3481c", "filename": "gcc/config/c4x/libgcc.S", "status": "modified", "additions": 15, "deletions": 10, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7/gcc%2Fconfig%2Fc4x%2Flibgcc.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7/gcc%2Fconfig%2Fc4x%2Flibgcc.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc4x%2Flibgcc.S?ref=0ea1f6b69f728ae6b87b8d0c5fc0cfbcd8b21da7", "patch": "@@ -133,24 +133,29 @@ ___divqf3:\n \tmpyf\tr1, r0\t\t; r0 = r[2] * (2.0 - r[2] * v) = r[3]\n ; End of 3rd iteration\n \n-\tor\t080h, r0\t; add 1 lsb to result. needed when complemeting\n-\t\t\t\t; 1.0 / 2.0\n-\trnd\tr0\n+\trnd\tr0\t\t; Minimize error in x[3]'s LSBs\n \n ; Use modified last iteration\n ; r[4] = (r[3] * (1.0 - (v * r[3]))) + r[3]\n \tmpyf3\tr0, r3, r1\t; r1 = r[3] * v\n \tsubrf\t1.0, r1\t\t; r1 = 1.0 - r[3] * v\n \tmpyf\tr0, r1\t\t; r1 = r[3] * (1.0 - r[3] * v)\n+\taddf\tr1, r0\t\t; r0 = r[3] * (1.0 - r[3] * v) + r[3] = r[4]\n+\n+        rnd     r0              ; Minimize error in x[4]'s LSBs\n \n \tbud\tar1\t\t; Delayed branch\n-\taddf\tr1, r0\t\t; r0 = r[3] * (1.0 - r[3] * v) + r[3] = r[4]\n-\t.if .REGPARM == 0\n-\tmpyf\t*-ar0(1), r0\t; Multiply by the dividend\n-\t.else\n-\tmpyf\tr2, r0\t\t; Multiply by the dividend\n-\t.endif\n-\trnd\tr0\n+\n+        .if .REGPARM == 0\n+        ldfu    *-ar0(1), r2    ; Dividend in mem has only 24 bits significance\n+        .else\n+        rnd     r2              ; Minimize error in reg dividend's LSBs\n+\t\t\t\t; since this may have 32 bit significance\n+        .endif\n+\n+        mpyf    r2, r0          ; Multiply by the dividend\n+        rnd     r0              ; Round result to 32 bits\n+\n \t; Branch occurs here\n #endif\n "}]}