{"sha": "3dbecef9bc52c4e9437c7bae83199c78ad90ae2c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2RiZWNlZjliYzUyYzRlOTQzN2M3YmFlODMxOTljNzhhZDkwYWUyYw==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1999-06-22T14:39:07Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1999-06-22T14:39:07Z"}, "message": "Fix for abort when PROMOTE_MODES defined but PROMOTE_FUNCTION_{ARG,RETURN} not.\n\n\t* expr.c (store_expr): When target is a promoted subreg, return a\n\tpromoted subreg as a result.\n\nFrom-SVN: r27705", "tree": {"sha": "6011c8b16e4d56911d95a559544e24c62cdd6a48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6011c8b16e4d56911d95a559544e24c62cdd6a48"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c/comments", "author": null, "committer": null, "parents": [{"sha": "2618f9559828916859242ab2fc2748d5e1ac670c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2618f9559828916859242ab2fc2748d5e1ac670c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2618f9559828916859242ab2fc2748d5e1ac670c"}], "stats": {"total": 19, "additions": 19, "deletions": 0}, "files": [{"sha": "b83b411a8d3c6a62443c4cc6bf4723d59279697f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3dbecef9bc52c4e9437c7bae83199c78ad90ae2c", "patch": "@@ -1,3 +1,8 @@\n+1999-06-22  Jim Wilson  <wilson@cygnus.com>\n+\n+\t* expr.c (store_expr): When target is a promoted subreg, return a\n+\tpromoted subreg as a result.\n+\n Tue Jun 22 17:14:58 1999  Michael Meissner  <meissner@cygnus.com>\n \n \t* dwarf2out.c (dwarf2out_frame_debug_expr): Reformat to match GNU"}, {"sha": "dc9bca518ea0684f1728bbac2f865a37a3de2ac9", "filename": "gcc/expr.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dbecef9bc52c4e9437c7bae83199c78ad90ae2c/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=3dbecef9bc52c4e9437c7bae83199c78ad90ae2c", "patch": "@@ -3652,6 +3652,20 @@ store_expr (exp, target, want_value)\n \n       convert_move (SUBREG_REG (target), temp,\n \t\t    SUBREG_PROMOTED_UNSIGNED_P (target));\n+\n+      /* If we promoted a constant, change the mode back down to match\n+\t target.  Otherwise, the caller might get confused by a result whose\n+\t mode is larger than expected.  */\n+\n+      if (want_value && GET_MODE (temp) != GET_MODE (target)\n+\t  && GET_MODE (temp) != VOIDmode)\n+\t{\n+\t  temp = gen_rtx_SUBREG (GET_MODE (target), temp, 0);\n+\t  SUBREG_PROMOTED_VAR_P (temp) = 1;\n+\t  SUBREG_PROMOTED_UNSIGNED_P (temp)\n+\t    = SUBREG_PROMOTED_UNSIGNED_P (target);\n+\t}\n+\n       return want_value ? temp : NULL_RTX;\n     }\n   else"}]}