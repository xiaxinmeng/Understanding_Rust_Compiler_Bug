{"sha": "367c82866e7c439004f283bb45fdbe09479c0d7f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzY3YzgyODY2ZTdjNDM5MDA0ZjI4M2JiNDVmZGJlMDk0NzljMGQ3Zg==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2014-01-28T15:03:19Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2014-01-28T15:03:19Z"}, "message": "PR preprocessor/59935 - caret diagnostics crashes on non-file locations\n\ngcc/ChangeLog\n\n\t* input.c (location_get_source_line): Bail out on when line number\n\tis zero, and test the return value of\n\tlookup_or_add_file_to_cache_tab.\n\ngcc/testsuite/ChangeLog\n\n\t* c-c++-common/cpp/warning-zero-location.c: New test.\n\t* c-c++-common/cpp/warning-zero-location-2.c: Likewise.\n\nSigned-off-by: Dodji Seketeli <dodji@seketeli.org>\n\nFrom-SVN: r207195", "tree": {"sha": "fbc9e0ef5ef690d21749ed8b474f18cbf615fb05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fbc9e0ef5ef690d21749ed8b474f18cbf615fb05"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/367c82866e7c439004f283bb45fdbe09479c0d7f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/367c82866e7c439004f283bb45fdbe09479c0d7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/367c82866e7c439004f283bb45fdbe09479c0d7f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/367c82866e7c439004f283bb45fdbe09479c0d7f/comments", "author": null, "committer": null, "parents": [{"sha": "07ec81f958b765032f234d08623b9a23c374a09e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07ec81f958b765032f234d08623b9a23c374a09e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07ec81f958b765032f234d08623b9a23c374a09e"}], "stats": {"total": 39, "additions": 38, "deletions": 1}, "files": [{"sha": "e802cba16194f07e1347cfa7195edd20100365d6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=367c82866e7c439004f283bb45fdbe09479c0d7f", "patch": "@@ -1,3 +1,10 @@\n+2014-01-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR preprocessor/59935\n+\t* input.c (location_get_source_line): Bail out on when line number\n+\tis zero, and test the return value of\n+\tlookup_or_add_file_to_cache_tab.\n+\n 2014-01-28  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/58742"}, {"sha": "63cd062ec5b276afc25e4239721285f56e29f11a", "filename": "gcc/input.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Finput.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Finput.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Finput.c?ref=367c82866e7c439004f283bb45fdbe09479c0d7f", "patch": "@@ -698,7 +698,13 @@ location_get_source_line (expanded_location xloc,\n   static char *buffer;\n   static ssize_t len;\n \n-  fcache * c = lookup_or_add_file_to_cache_tab (xloc.file);\n+  if (xloc.line == 0)\n+    return NULL;\n+\n+  fcache *c = lookup_or_add_file_to_cache_tab (xloc.file);\n+  if (c == NULL)\n+    return NULL;\n+\n   bool read = read_line_num (c, xloc.line, &buffer, &len);\n \n   if (read && line_len)"}, {"sha": "30cbfa6ab9a2da389f39356eb10da86b7d2526c2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=367c82866e7c439004f283bb45fdbe09479c0d7f", "patch": "@@ -1,3 +1,9 @@\n+2014-01-28  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR preprocessor/59935\n+\t* c-c++-common/cpp/warning-zero-location.c: New test.\n+\t* c-c++-common/cpp/warning-zero-location-2.c: Likewise.\n+\n 2014-01-27  Steve Ellcey  <sellcey@mips.com>\n \n \t* gcc.target/mips/pr52125.c: Add -mno-optgp option."}, {"sha": "c0e0bf75fdfbf9dc38b2240363279b950388b2f9", "filename": "gcc/testsuite/c-c++-common/cpp/warning-zero-location-2.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcpp%2Fwarning-zero-location-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcpp%2Fwarning-zero-location-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcpp%2Fwarning-zero-location-2.c?ref=367c82866e7c439004f283bb45fdbe09479c0d7f", "patch": "@@ -0,0 +1,10 @@\n+/*\n+   { dg-options \"-D _GNU_SOURCE -fdiagnostics-show-caret\" }\n+   { dg-do compile }\n+ */\n+\n+#line 4636 \"configure\"\n+#include <xxxxxxxxxxxx.h>\n+int main() { return 0; }\n+\n+/* { dg-error \"No such file or directory\" { target *-*-* } 4636 } */"}, {"sha": "ca2e102bba01b2e15f37be471302d2c351996ec2", "filename": "gcc/testsuite/c-c++-common/cpp/warning-zero-location.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcpp%2Fwarning-zero-location.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/367c82866e7c439004f283bb45fdbe09479c0d7f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcpp%2Fwarning-zero-location.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcpp%2Fwarning-zero-location.c?ref=367c82866e7c439004f283bb45fdbe09479c0d7f", "patch": "@@ -0,0 +1,8 @@\n+/*\n+   { dg-options \"-D _GNU_SOURCE -fdiagnostics-show-caret\" }\n+   { dg-do compile }\n+ */\n+\n+#define _GNU_SOURCE \t/* { dg-warning \"redefined\" } */\n+\n+/* { dg-message \"\" \"#define _GNU_SOURCE\" {target *-*-* } 0 }"}]}