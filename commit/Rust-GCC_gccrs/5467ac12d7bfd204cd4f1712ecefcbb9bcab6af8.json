{"sha": "5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTQ2N2FjMTJkN2JmZDIwNGNkNGYxNzEyZWNlZmNiYjliY2FiNmFmOA==", "commit": {"author": {"name": "Mark Wielaard", "email": "mark@klomp.org", "date": "2021-05-21T21:36:36Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "dkm@kataplop.net", "date": "2021-05-23T14:21:05Z"}, "message": "Fix raw identifier parsing.\n\nLexer::parse_raw_identifier added the first character twice.\n\nAdds tests for a simple raw identifier, a keyword as raw identifier and\nxfail tests for a single underscore and forbidden keyword (crate) as raw\nidentifier.\n\nTo help error diagnostics continue after parse_raw_identifier failed in\nLexer::build_token.\n\nFixes: https://github.com/Rust-GCC/gccrs/issues/426", "tree": {"sha": "59a6832709427ef6a721c212051cd26cb8eaec5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/59a6832709427ef6a721c212051cd26cb8eaec5a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/comments", "author": null, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "99b73780e6e30f962c01532d3ec189ceeecf7f93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99b73780e6e30f962c01532d3ec189ceeecf7f93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99b73780e6e30f962c01532d3ec189ceeecf7f93"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "16fb1ade220d355ac9a52e308890998db724b255", "filename": "gcc/rust/lex/rust-lex.cc", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Frust%2Flex%2Frust-lex.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Frust%2Flex%2Frust-lex.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Flex%2Frust-lex.cc?ref=5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "patch": "@@ -743,6 +743,9 @@ Lexer::build_token ()\n \t      TokenPtr raw_ident_ptr = parse_raw_identifier (loc);\n \t      if (raw_ident_ptr != nullptr)\n \t\treturn raw_ident_ptr;\n+\t      else\n+\t\tcontinue; /* input got parsed, it just wasn't valid. An error\n+\t\t\t     was produced. */\n \t    }\n \t  else\n \t    {\n@@ -1523,11 +1526,9 @@ Lexer::parse_raw_identifier (Location loc)\n \n   current_column += 2;\n \n-  str += current_char;\n-\n   bool first_is_underscore = current_char == '_';\n \n-  int length = 1;\n+  int length = 0;\n   current_char = peek_input ();\n   // loop through entire name\n   while (ISALPHA (current_char) || ISDIGIT (current_char)"}, {"sha": "8746f337048627adf25c2068303a1b1758fd28c7", "filename": "gcc/testsuite/rust.test/compile/raw_identifiers.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fcompile%2Fraw_identifiers.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fcompile%2Fraw_identifiers.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust.test%2Fcompile%2Fraw_identifiers.rs?ref=5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "patch": "@@ -0,0 +1,3 @@\n+pub fn square(num: i32) -> i32 { /* { dg-warning \"used\" } */\n+    r#num * num\n+}\n\\ No newline at end of file"}, {"sha": "c9aa3cf49386b50a87a5566891058888f58f9981", "filename": "gcc/testsuite/rust.test/compile/raw_identifiers_keywords.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fcompile%2Fraw_identifiers_keywords.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fcompile%2Fraw_identifiers_keywords.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust.test%2Fcompile%2Fraw_identifiers_keywords.rs?ref=5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "patch": "@@ -0,0 +1,3 @@\n+pub fn plus(r#break: i32, r#unsafe: i32) -> i32 { /* { dg-warning \"used\" } */\n+    r#break + r#unsafe\n+}\n\\ No newline at end of file"}, {"sha": "854d7e6edee1d28a7999fc4dba318f02175b31f5", "filename": "gcc/testsuite/rust.test/xfail_compile/raw_identifiers_bad_keywords.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fxfail_compile%2Fraw_identifiers_bad_keywords.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fxfail_compile%2Fraw_identifiers_bad_keywords.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust.test%2Fxfail_compile%2Fraw_identifiers_bad_keywords.rs?ref=5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "patch": "@@ -0,0 +1,3 @@\n+pub fn plus(n: i32, m: i32) -> i32 {\n+    r#crate /* { dg-error \"forbidden raw identifier\" } */\n+}"}, {"sha": "86e9013a50bf027e399462b1591b2fc7f2d5be64", "filename": "gcc/testsuite/rust.test/xfail_compile/raw_identifiers_underscore.rs", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fxfail_compile%2Fraw_identifiers_underscore.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8/gcc%2Ftestsuite%2Frust.test%2Fxfail_compile%2Fraw_identifiers_underscore.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust.test%2Fxfail_compile%2Fraw_identifiers_underscore.rs?ref=5467ac12d7bfd204cd4f1712ecefcbb9bcab6af8", "patch": "@@ -0,0 +1,3 @@\n+pub fn s(num: i32) -> i32 {\n+    r#_ * num /* { dg-error \"not a valid raw identifier\" } */\n+}"}]}