{"sha": "a4f9129458103e618d0f021a9975db06a9b7abf9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTRmOTEyOTQ1ODEwM2U2MThkMGYwMjFhOTk3NWRiMDZhOWI3YWJmOQ==", "commit": {"author": {"name": "Diego Novillo", "email": "dnovillo@redhat.com", "date": "2005-07-01T03:55:28Z"}, "committer": {"name": "Diego Novillo", "email": "dnovillo@gcc.gnu.org", "date": "2005-07-01T03:55:28Z"}, "message": "re PR tree-optimization/21584 (ICE: verify_flow_sensitive_alias_info failed.)\n\n\n\tPR 21584\n\tPR 22219\n\t* tree-ssa-alias.c (create_name_tags): Also process\n\tnon-dereferenced pointers.\n\tRemove argument 'ai'.  Update all callers.\n\ntestsuite/ChangeLog\n\n\tPR 21584\n\tPR 22219\n\t* g++.dg/tree-ssa/pr21584-1.C: New test.\n\t* g++.dg/tree-ssa/pr21584-2.C: New test.\n\nFrom-SVN: r101498", "tree": {"sha": "8ffa65c8288eee005ef263ef8b23ad166acfef7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ffa65c8288eee005ef263ef8b23ad166acfef7b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a4f9129458103e618d0f021a9975db06a9b7abf9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4f9129458103e618d0f021a9975db06a9b7abf9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4f9129458103e618d0f021a9975db06a9b7abf9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4f9129458103e618d0f021a9975db06a9b7abf9/comments", "author": null, "committer": null, "parents": [{"sha": "8ce2456a6da65df38f6538109004bf5fc520eb24", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ce2456a6da65df38f6538109004bf5fc520eb24", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ce2456a6da65df38f6538109004bf5fc520eb24"}], "stats": {"total": 104, "additions": 96, "deletions": 8}, "files": [{"sha": "89f189c7042e236c5e28524c9297426cd286cef2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a4f9129458103e618d0f021a9975db06a9b7abf9", "patch": "@@ -1,3 +1,11 @@\n+2005-06-30  Diego Novillo  <dnovillo@redhat.com>\n+\n+\tPR 21584\n+\tPR 22219\n+\t* tree-ssa-alias.c (create_name_tags): Also process\n+\tnon-dereferenced pointers.\n+\tRemove argument 'ai'.  Update all callers.\n+\n 2005-06-30  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \t* config/rs6000/darwin.h (STARTING_FRAME_OFFSET):"}, {"sha": "47001d30381168199a21824cd35a6d6587c8a718", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a4f9129458103e618d0f021a9975db06a9b7abf9", "patch": "@@ -1,3 +1,10 @@\n+2005-06-30  Diego Novillo  <dnovillo@redhat.com>\n+\n+\tPR 21584\n+\tPR 22219\n+\t* g++.dg/tree-ssa/pr21584-1.C: New test.\n+\t* g++.dg/tree-ssa/pr21584-2.C: New test.\n+\n 2005-06-30  Ziemowit Laski  <zlaski@apple.com>\n \n \t* obj-c++.dg/try-catch-11.mm: New."}, {"sha": "2c96d1027d76c32ca4e188f0b3b519fa280acce2", "filename": "gcc/testsuite/g++.dg/tree-ssa/pr21584-1.C", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr21584-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr21584-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr21584-1.C?ref=a4f9129458103e618d0f021a9975db06a9b7abf9", "patch": "@@ -0,0 +1,38 @@\n+extern \"C\" {\n+\n+extern char *strcpy (char *__restrict __dest, __const char *__restrict __src)\n+     throw () __attribute__ ((__nonnull__ (1, 2)));\n+\n+extern char *foo (char *__restrict __s) throw ();\n+}\n+\n+class cset {\n+public:\n+  cset();\n+  int operator()(unsigned char) const;\n+private:\n+  char v[(127 * 2 + 1)+1];\n+};\n+\n+inline int cset::operator()(unsigned char c) const\n+{\n+  return v[c];\n+}\n+\n+extern cset csspace;\n+\n+void baz()\n+{\n+  char *vec;\n+  char buf[512];\n+\n+  char *p = buf;\n+  while (csspace(*p))\n+    p++;\n+\n+  if (*p != '#' && (p = foo(buf)) != 0) {\n+    vec = new char[10+ 1];\n+    strcpy(vec, p);\n+  }\n+}\n+"}, {"sha": "6246e8d4cbb364cd442bb8e8205805feb534575c", "filename": "gcc/testsuite/g++.dg/tree-ssa/pr21584-2.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr21584-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr21584-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftree-ssa%2Fpr21584-2.C?ref=a4f9129458103e618d0f021a9975db06a9b7abf9", "patch": "@@ -0,0 +1,22 @@\n+extern char *strcpy (char *__restrict __dest, __const char *__restrict __src);\n+\n+extern char *foo (void);\n+extern void *malloc(__SIZE_TYPE__) __attribute__((malloc));\n+\n+char v[100];\n+\n+void baz()\n+{\n+  char *vec;\n+  char buf[512];\n+\n+  char *p = buf;\n+  while (v[(*p)])\n+    p++;\n+\n+  if (*p != '#' && (p = foo()) != 0) {\n+    strcpy ((char*)malloc(10), p);\n+  }\n+}\n+\n+"}, {"sha": "39d9fdecab88a33d556dba768244dad3ae5d37d8", "filename": "gcc/tree-ssa-alias.c", "status": "modified", "additions": 21, "deletions": 8, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftree-ssa-alias.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a4f9129458103e618d0f021a9975db06a9b7abf9/gcc%2Ftree-ssa-alias.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-alias.c?ref=a4f9129458103e618d0f021a9975db06a9b7abf9", "patch": "@@ -791,14 +791,21 @@ compute_points_to_and_addr_escape (struct alias_info *ai)\n    are assigned the same name tag.  */\n \n static void\n-create_name_tags (struct alias_info *ai)\n+create_name_tags (void)\n {\n   size_t i;\n \n-  for (i = 0; i < VARRAY_ACTIVE_SIZE (ai->processed_ptrs); i++)\n+  for (i = 1; i < num_ssa_names; i++)\n     {\n-      tree ptr = VARRAY_TREE (ai->processed_ptrs, i);\n-      struct ptr_info_def *pi = SSA_NAME_PTR_INFO (ptr);\n+      tree ptr = ssa_name (i);\n+      struct ptr_info_def *pi;\n+\n+      if (!ptr\n+\t  || !POINTER_TYPE_P (TREE_TYPE (ptr))\n+\t  || !SSA_NAME_PTR_INFO (ptr))\n+\tcontinue;\n+\n+      pi = SSA_NAME_PTR_INFO (ptr);\n \n       if (pi->pt_anything || !pi->is_dereferenced)\n \t{\n@@ -824,10 +831,15 @@ create_name_tags (struct alias_info *ai)\n \t     problems if they both had different name tags because\n \t     they would have different SSA version numbers (which\n \t     would force us to take the name tags in and out of SSA).  */\n-\t  for (j = 0; j < i; j++)\n+\t  for (j = 1; j < i; j++)\n \t    {\n-\t      tree q = VARRAY_TREE (ai->processed_ptrs, j);\n-\t      struct ptr_info_def *qi = SSA_NAME_PTR_INFO (q);\n+\t      tree q = ssa_name (j);\n+\t      struct ptr_info_def *qi;\n+\n+\t      if (!q || !POINTER_TYPE_P (TREE_TYPE (q)))\n+\t\tcontinue;\n+\n+\t      qi = SSA_NAME_PTR_INFO (q);\n \n \t      if (qi\n \t\t  && qi->pt_vars\n@@ -896,7 +908,8 @@ compute_flow_sensitive_aliasing (struct alias_info *ai)\n \t  find_what_p_points_to (ptr);\n \t}\n     }\n-  create_name_tags (ai);\n+\n+  create_name_tags ();\n \n   for (i = 0; i < VARRAY_ACTIVE_SIZE (ai->processed_ptrs); i++)\n     {"}]}