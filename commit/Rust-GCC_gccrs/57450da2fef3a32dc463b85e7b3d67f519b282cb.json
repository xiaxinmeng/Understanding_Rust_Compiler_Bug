{"sha": "57450da2fef3a32dc463b85e7b3d67f519b282cb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTc0NTBkYTJmZWYzYTMyZGM0NjNiODVlN2IzZDY3ZjUxOWIyODJjYg==", "commit": {"author": {"name": "Alexandre Oliva", "email": "oliva@gnu.org", "date": "2021-01-01T00:37:24Z"}, "committer": {"name": "Alexandre Oliva", "email": "oliva@gnu.org", "date": "2021-01-09T03:09:02Z"}, "message": "final: accept markers at line 0\n\nBack when I introduced debug markers, I seem to have been under the\nimpression that location line 0 would only ever occur for unknown and\nbuiltin locations.\n\nThough line 0 never comes up in normal processing of source files, and\ndebug info formats often cannot represent them, I suppose there's no\nneed to preemptively discard them during final.\n\n\nfor  gcc/ChangeLog\n\n\tPR debug/97714\n\t* final.c (notice_source_line): Narrow down the condition to\n\tskip a line-0 marker.\n\nfor  gcc/testsuite/ChangeLog\n\n\tPR debug/97714\n\t* gcc.dg/debug/pr97714.c: New.", "tree": {"sha": "74308fefb6983b3a41a08405724cf6ad919d87f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74308fefb6983b3a41a08405724cf6ad919d87f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57450da2fef3a32dc463b85e7b3d67f519b282cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57450da2fef3a32dc463b85e7b3d67f519b282cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57450da2fef3a32dc463b85e7b3d67f519b282cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57450da2fef3a32dc463b85e7b3d67f519b282cb/comments", "author": null, "committer": null, "parents": [{"sha": "bf5cbb9edffc90eefba5c683dda0f1915e125018", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf5cbb9edffc90eefba5c683dda0f1915e125018", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf5cbb9edffc90eefba5c683dda0f1915e125018"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "b037e07fca031587f964ca9acd5844e2551fb7f2", "filename": "gcc/final.c", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57450da2fef3a32dc463b85e7b3d67f519b282cb/gcc%2Ffinal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57450da2fef3a32dc463b85e7b3d67f519b282cb/gcc%2Ffinal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffinal.c?ref=57450da2fef3a32dc463b85e7b3d67f519b282cb", "patch": "@@ -3250,12 +3250,11 @@ notice_source_line (rtx_insn *insn, bool *is_stmt)\n     {\n       location_t loc = NOTE_MARKER_LOCATION (insn);\n       expanded_location xloc = expand_location (loc);\n-      if (xloc.line == 0)\n-\t{\n-\t  gcc_checking_assert (LOCATION_LOCUS (loc) == UNKNOWN_LOCATION\n-\t\t\t       || LOCATION_LOCUS (loc) == BUILTINS_LOCATION);\n-\t  return false;\n-\t}\n+      if (xloc.line == 0\n+\t  && (LOCATION_LOCUS (loc) == UNKNOWN_LOCATION\n+\t      || LOCATION_LOCUS (loc) == BUILTINS_LOCATION))\n+\treturn false;\n+\n       filename = xloc.file;\n       linenum = xloc.line;\n       columnnum = xloc.column;"}, {"sha": "dba17831d6943a334bc42091bad9b94fa8c7b248", "filename": "gcc/testsuite/gcc.dg/debug/pr97714.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57450da2fef3a32dc463b85e7b3d67f519b282cb/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fpr97714.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57450da2fef3a32dc463b85e7b3d67f519b282cb/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fpr97714.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fpr97714.c?ref=57450da2fef3a32dc463b85e7b3d67f519b282cb", "patch": "@@ -0,0 +1,11 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -g\" } */\n+\n+void\n+function ()\n+{\n+  if (0)\n+    {\n+#line 0 \"whatever\"\n+    }\n+}"}]}