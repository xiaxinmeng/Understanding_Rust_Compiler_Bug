{"sha": "e0f8b6a0a070b748cf1666bc6eec6701453d8e2f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTBmOGI2YTBhMDcwYjc0OGNmMTY2NmJjNmVlYzY3MDE0NTNkOGUyZg==", "commit": {"author": {"name": "Sofiane Naci", "email": "sofiane.naci@arm.com", "date": "2013-01-15T15:49:13Z"}, "committer": {"name": "Sofiane Naci", "email": "sofiane@gcc.gnu.org", "date": "2013-01-15T15:49:13Z"}, "message": "[AARCH64] Fix __clear_cache.\n\nFrom-SVN: r195203", "tree": {"sha": "3b8cdebc20d73d8521ee1a2d1c8850712ca88a08", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3b8cdebc20d73d8521ee1a2d1c8850712ca88a08"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f/comments", "author": null, "committer": null, "parents": [{"sha": "93aea671e273bb1a5166b51d307c656d81e00fe5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93aea671e273bb1a5166b51d307c656d81e00fe5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93aea671e273bb1a5166b51d307c656d81e00fe5"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "775044944776676c2850e2fef52e8b4dbc327b64", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=e0f8b6a0a070b748cf1666bc6eec6701453d8e2f", "patch": "@@ -1,3 +1,8 @@\n+2013-01-15  Sofiane Naci  <sofiane.naci@arm.com>\n+\n+\t* config/aarch64/sync-cache.c (__aarch64_sync_cache_range): Update\n+\tloop start address for cache clearing.\n+\n 2013-01-14  Georg-Johann Lay  <avr@gjlay.de>\n \n \t* config/avr/lib1funcs.S: Remove trailing blanks."}, {"sha": "2512cb8e87ed07a39c3c2a1d8c5e68704dc926da", "filename": "libgcc/config/aarch64/sync-cache.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f/libgcc%2Fconfig%2Faarch64%2Fsync-cache.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0f8b6a0a070b748cf1666bc6eec6701453d8e2f/libgcc%2Fconfig%2Faarch64%2Fsync-cache.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Faarch64%2Fsync-cache.c?ref=e0f8b6a0a070b748cf1666bc6eec6701453d8e2f", "patch": "@@ -39,15 +39,21 @@ __aarch64_sync_cache_range (const void *base, const void *end)\n      instruction cache fetches the updated data.  'end' is exclusive,\n      as per the GNU definition of __clear_cache.  */\n \n-  for (address = base; address < (const char *) end; address += dcache_lsize)\n+  /* Make the start address of the loop cache aligned.  */\n+  address = (const char*) ((unsigned long) base & ~ (dcache_lsize - 1));\n+\n+  for (address; address < (const char *) end; address += dcache_lsize)\n     asm volatile (\"dc\\tcvau, %0\"\n \t\t  :\n \t\t  : \"r\" (address)\n \t\t  : \"memory\");\n \n   asm volatile (\"dsb\\tish\" : : : \"memory\");\n \n-  for (address = base; address < (const char *) end; address += icache_lsize)\n+  /* Make the start address of the loop cache aligned.  */\n+  address = (const char*) ((unsigned long) base & ~ (icache_lsize - 1));\n+\n+  for (address; address < (const char *) end; address += icache_lsize)\n     asm volatile (\"ic\\tivau, %0\"\n \t\t  :\n \t\t  : \"r\" (address)"}]}