{"sha": "45eb3e4944ba93b1d4e9070c703068cfa7aaace4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDVlYjNlNDk0NGJhOTNiMWQ0ZTkwNzBjNzAzMDY4Y2ZhN2FhYWNlNA==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-01-30T20:21:28Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-01-31T13:23:28Z"}, "message": "analyzer: further fixes for comparisons between uncomparable types (PR 93450)\n\ngcc/analyzer/ChangeLog:\n\tPR analyzer/93450\n\t* constraint-manager.cc\n\t(constraint_manager::get_or_add_equiv_class): Only compare constants\n\tif their types are compatible.\n\t* region-model.cc (constant_svalue::eval_condition): Replace check\n\tfor identical types with call to types_compatible_p.", "tree": {"sha": "3a633a04934802f54a2d671f38c2ef4d065702cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3a633a04934802f54a2d671f38c2ef4d065702cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/45eb3e4944ba93b1d4e9070c703068cfa7aaace4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45eb3e4944ba93b1d4e9070c703068cfa7aaace4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/45eb3e4944ba93b1d4e9070c703068cfa7aaace4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45eb3e4944ba93b1d4e9070c703068cfa7aaace4/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "95607c12363712c39345e1d97f2c1aee8025e188", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95607c12363712c39345e1d97f2c1aee8025e188", "html_url": "https://github.com/Rust-GCC/gccrs/commit/95607c12363712c39345e1d97f2c1aee8025e188"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "7ca6c2217e31a476b1e024d52422d65954db5903", "filename": "gcc/analyzer/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45eb3e4944ba93b1d4e9070c703068cfa7aaace4/gcc%2Fanalyzer%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45eb3e4944ba93b1d4e9070c703068cfa7aaace4/gcc%2Fanalyzer%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2FChangeLog?ref=45eb3e4944ba93b1d4e9070c703068cfa7aaace4", "patch": "@@ -1,3 +1,12 @@\n+2020-01-31  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR analyzer/93450\n+\t* constraint-manager.cc\n+\t(constraint_manager::get_or_add_equiv_class): Only compare constants\n+\tif their types are compatible.\n+\t* region-model.cc (constant_svalue::eval_condition): Replace check\n+\tfor identical types with call to types_compatible_p.\n+\n 2020-01-30  David Malcolm  <dmalcolm@redhat.com>\n \n \t* program-state.cc (extrinsic_state::dump_to_pp): New."}, {"sha": "f3e31ee083071de68c8393bdac1f4d3ce792a3f4", "filename": "gcc/analyzer/constraint-manager.cc", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45eb3e4944ba93b1d4e9070c703068cfa7aaace4/gcc%2Fanalyzer%2Fconstraint-manager.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45eb3e4944ba93b1d4e9070c703068cfa7aaace4/gcc%2Fanalyzer%2Fconstraint-manager.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fconstraint-manager.cc?ref=45eb3e4944ba93b1d4e9070c703068cfa7aaace4", "patch": "@@ -958,7 +958,9 @@ constraint_manager::get_or_add_equiv_class (svalue_id sid)\n \t   other_id.m_idx++)\n \t{\n \t  const equiv_class &other_ec = other_id.get_obj (*this);\n-\t  if (other_ec.m_constant)\n+\t  if (other_ec.m_constant\n+\t      && types_compatible_p (TREE_TYPE (new_ec->m_constant),\n+\t\t\t\t     TREE_TYPE (other_ec.m_constant)))\n \t    {\n \t      /* If we have two ECs, both with constants, the constants must be\n \t\t non-equal (or they would be in the same EC)."}, {"sha": "b546114bfd5b7947afd44a20c3bc2b26ab4909f5", "filename": "gcc/analyzer/region-model.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45eb3e4944ba93b1d4e9070c703068cfa7aaace4/gcc%2Fanalyzer%2Fregion-model.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45eb3e4944ba93b1d4e9070c703068cfa7aaace4/gcc%2Fanalyzer%2Fregion-model.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fregion-model.cc?ref=45eb3e4944ba93b1d4e9070c703068cfa7aaace4", "patch": "@@ -667,7 +667,7 @@ constant_svalue::eval_condition (constant_svalue *lhs,\n   gcc_assert (CONSTANT_CLASS_P (rhs_const));\n \n   /* Check for comparable types.  */\n-  if (TREE_TYPE (lhs_const) == TREE_TYPE (rhs_const))\n+  if (types_compatible_p (TREE_TYPE (lhs_const), TREE_TYPE (rhs_const)))\n     {\n       tree comparison\n \t= fold_build2 (op, boolean_type_node, lhs_const, rhs_const);"}]}