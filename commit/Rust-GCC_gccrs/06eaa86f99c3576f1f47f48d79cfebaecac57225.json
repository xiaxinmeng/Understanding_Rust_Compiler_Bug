{"sha": "06eaa86f99c3576f1f47f48d79cfebaecac57225", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZlYWE4NmY5OWMzNTc2ZjFmNDdmNDhkNzljZmViYWVjYWM1NzIyNQ==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1998-05-04T19:16:35Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1998-05-04T19:16:35Z"}, "message": "Fix bug where storing into const string gives core dump, from Kamil Iskra.\n\n\t* expr.c (expand_expr, case INDIRECT_REF): Don't optimize string\n\treference if this is a store.\n\nFrom-SVN: r19531", "tree": {"sha": "f0914b034e218ac7b59f25135a52b9429d5e9eea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f0914b034e218ac7b59f25135a52b9429d5e9eea"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06eaa86f99c3576f1f47f48d79cfebaecac57225", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06eaa86f99c3576f1f47f48d79cfebaecac57225", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06eaa86f99c3576f1f47f48d79cfebaecac57225", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06eaa86f99c3576f1f47f48d79cfebaecac57225/comments", "author": null, "committer": null, "parents": [{"sha": "9ed5dc544a13f979a4ab8931a016cb8ff69fd590", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ed5dc544a13f979a4ab8931a016cb8ff69fd590", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ed5dc544a13f979a4ab8931a016cb8ff69fd590"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "2c7d23c06a31b8718a6e5616cd57e56cacdf2921", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06eaa86f99c3576f1f47f48d79cfebaecac57225/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06eaa86f99c3576f1f47f48d79cfebaecac57225/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=06eaa86f99c3576f1f47f48d79cfebaecac57225", "patch": "@@ -1,3 +1,8 @@\n+Mon May  4 19:15:29 1998  Jim Wilson  <wilson@cygnus.com>\n+\n+\t* expr.c (expand_expr, case INDIRECT_REF): Don't optimize string\n+\treference if this is a store.\n+\n Mon May  4 17:25:17 1998  Richard Henderson  <rth@cygnus.com>\n \n \t* sparc.c (output_move_quad): Fix typo in mov_by_64 argument."}, {"sha": "8b8e5133b6a52e0983480d92578091c99aaafd1d", "filename": "gcc/expr.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06eaa86f99c3576f1f47f48d79cfebaecac57225/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06eaa86f99c3576f1f47f48d79cfebaecac57225/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=06eaa86f99c3576f1f47f48d79cfebaecac57225", "patch": "@@ -5484,13 +5484,15 @@ expand_expr (exp, target, tmode, modifier)\n  \ttree string = string_constant (exp1, &index);\n  \tint i;\n  \n+\t/* Try to optimize reads from const strings.  */\n  \tif (string\n  \t    && TREE_CODE (string) == STRING_CST\n  \t    && TREE_CODE (index) == INTEGER_CST\n  \t    && !TREE_INT_CST_HIGH (index)\n  \t    && (i = TREE_INT_CST_LOW (index)) < TREE_STRING_LENGTH (string)\n  \t    && GET_MODE_CLASS (mode) == MODE_INT\n- \t    && GET_MODE_SIZE (mode) == 1)\n+ \t    && GET_MODE_SIZE (mode) == 1\n+\t    && modifier != EXPAND_MEMORY_USE_WO)\n  \t  return GEN_INT (TREE_STRING_POINTER (string)[i]);\n \n \top0 = expand_expr (exp1, NULL_RTX, VOIDmode, EXPAND_SUM);"}]}