{"sha": "9696b2257cfc61d3e04045f05cc37580e461d0ef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTY5NmIyMjU3Y2ZjNjFkM2UwNDA0NWYwNWNjMzc1ODBlNDYxZDBlZg==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2006-01-06T01:39:34Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2006-01-06T01:39:34Z"}, "message": "re PR libfortran/25598 (gfortran - Fortran runtime error: Invalid argument)\n\n2006-01-05  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libgfortran/25598\n\t* io/file_pos.c (unformatted_backspace): Assure the new file position\n\tto seek is not less than zero.\n\t(st_backspace): Set unit bytes_left to zero.\n\t* io/transfer.c (next_record_r): Fix line lengths, no functional change.\n\nFrom-SVN: r109405", "tree": {"sha": "1b49be523e21bb74b123b6ac069be07266b1e925", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b49be523e21bb74b123b6ac069be07266b1e925"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9696b2257cfc61d3e04045f05cc37580e461d0ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9696b2257cfc61d3e04045f05cc37580e461d0ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9696b2257cfc61d3e04045f05cc37580e461d0ef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9696b2257cfc61d3e04045f05cc37580e461d0ef/comments", "author": null, "committer": null, "parents": [{"sha": "5c1fac10027111f60694aca0dd7f1103b09ae865", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c1fac10027111f60694aca0dd7f1103b09ae865", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c1fac10027111f60694aca0dd7f1103b09ae865"}], "stats": {"total": 25, "additions": 22, "deletions": 3}, "files": [{"sha": "ab6c766f8b27fa9d1cedb957569069d34e723ee2", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9696b2257cfc61d3e04045f05cc37580e461d0ef/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9696b2257cfc61d3e04045f05cc37580e461d0ef/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=9696b2257cfc61d3e04045f05cc37580e461d0ef", "patch": "@@ -1,4 +1,17 @@\n+<<<<<<< .mine\n+2006-01-03  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libgfortran/25598\n+\t* io/file_pos.c (unformatted_backspace): Assure the new file position\n+\tto seek is not less than zero.\n+\t(st_backspace): Set unit bytes_left to zero.\n+\t* io/transfer.c (next_record_r): Fix line lengths, no functional change.\n+\ta null value (default). Revert patch of 25419 on 2005-12-28.  \n+\n+2005-12-31  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+=======\n 2006-01-02  Paolo Bonzini  <bonzini@gnu.org>\n+>>>>>>> .r109401\n \n         PR target/25259\n         * configure.ac: Use GCC_HEADER_STDINT."}, {"sha": "ba8f63172214dadc589e436fc98064d7f7ba4bb3", "filename": "libgfortran/io/file_pos.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9696b2257cfc61d3e04045f05cc37580e461d0ef/libgfortran%2Fio%2Ffile_pos.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9696b2257cfc61d3e04045f05cc37580e461d0ef/libgfortran%2Fio%2Ffile_pos.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ffile_pos.c?ref=9696b2257cfc61d3e04045f05cc37580e461d0ef", "patch": "@@ -120,7 +120,9 @@ unformatted_backspace (st_parameter_filepos *fpp, gfc_unit *u)\n   else\n     reverse_memcpy (&m, p, sizeof (gfc_offset));\n \n-  new = file_position (u->s) - m - 2*length;\n+  if ((new = file_position (u->s) - m - 2*length) < 0)\n+    new = 0;\n+\n   if (sseek (u->s, new) == FAILURE)\n     goto io_error;\n \n@@ -179,6 +181,7 @@ st_backspace (st_parameter_filepos *fpp)\n \n       u->endfile = NO_ENDFILE;\n       u->current_record = 0;\n+      u->bytes_left = 0;\n     }\n \n  done:"}, {"sha": "049ebb24771981fcd14e1f30c28da60c8e0b89e5", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9696b2257cfc61d3e04045f05cc37580e461d0ef/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9696b2257cfc61d3e04045f05cc37580e461d0ef/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=9696b2257cfc61d3e04045f05cc37580e461d0ef", "patch": "@@ -1645,8 +1645,10 @@ next_record_r (st_parameter_dt *dtp)\n   switch (current_mode (dtp))\n     {\n     case UNFORMATTED_SEQUENTIAL:\n-      dtp->u.p.current_unit->bytes_left += sizeof (gfc_offset);\t/* Skip over tail */\n \n+      /* Skip over tail */\n+      dtp->u.p.current_unit->bytes_left += sizeof (gfc_offset);\n+      \n       /* Fall through...  */\n \n     case FORMATTED_DIRECT:\n@@ -1656,7 +1658,8 @@ next_record_r (st_parameter_dt *dtp)\n \n       if (is_seekable (dtp->u.p.current_unit->s))\n \t{\n-\t  new = file_position (dtp->u.p.current_unit->s) + dtp->u.p.current_unit->bytes_left;\n+\t  new = file_position (dtp->u.p.current_unit->s)\n+\t\t+ dtp->u.p.current_unit->bytes_left;\n \n \t  /* Direct access files do not generate END conditions,\n \t     only I/O errors.  */"}]}