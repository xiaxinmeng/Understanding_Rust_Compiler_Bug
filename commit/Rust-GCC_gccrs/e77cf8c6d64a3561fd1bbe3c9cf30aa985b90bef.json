{"sha": "e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTc3Y2Y4YzZkNjRhMzU2MWZkMWJiZTNjOWNmMzBhYTk4NWI5MGJlZg==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2016-10-24T11:23:36Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2016-10-24T11:23:36Z"}, "message": "[check_GNU_style.sh] More aggressively ignore dg-xxx directives\n\n\t* check_GNU_style.sh (remove_testsuite): New function.\n\tUse it to remove testsuite from the diff.\n\nFrom-SVN: r241471", "tree": {"sha": "37b3798ca462a682fdc315b8fb19cc2aebb3fcae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/37b3798ca462a682fdc315b8fb19cc2aebb3fcae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "40f683e88d5aeef52425f719a7197da4d1d524a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40f683e88d5aeef52425f719a7197da4d1d524a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40f683e88d5aeef52425f719a7197da4d1d524a7"}], "stats": {"total": 23, "additions": 19, "deletions": 4}, "files": [{"sha": "1b6939ad030d3b50ab394553f25d8f0e4b97b740", "filename": "contrib/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef", "patch": "@@ -1,3 +1,8 @@\n+2016-10-24  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\t* check_GNU_style.sh (remove_testsuite): New function.\n+\tUse it to remove testsuite from the diff.\n+\n 2016-09-23  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* dg-extract-results.sh: Revert bogus change."}, {"sha": "fb7494661ee8ff4d4e58ed05137bb69aab7c46a7", "filename": "contrib/check_GNU_style.sh", "status": "modified", "additions": 14, "deletions": 4, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef/contrib%2Fcheck_GNU_style.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef/contrib%2Fcheck_GNU_style.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fcheck_GNU_style.sh?ref=e77cf8c6d64a3561fd1bbe3c9cf30aa985b90bef", "patch": "@@ -81,7 +81,17 @@ if [ $nfiles -eq 1 ]; then\n else\n     format=\"-nH\"\n fi\n+\n+# Remove the testsuite part of the diff.  We don't care about GNU style\n+# in testcases and the dg-* directives give too many false positives.\n+remove_testsuite ()\n+{\n+  awk 'BEGIN{testsuite=0} /^(.*:)?([1-9][0-9]*:)?\\+\\+\\+ / && ! /testsuite\\//{testsuite=0} \\\n+       {if (!testsuite) print} /^(.*:)?([1-9][0-9]*:)?\\+\\+\\+ (.*\\/)?testsuite\\//{testsuite=1}'\n+}\n+\n grep $format '^+' $files \\\n+    | remove_testsuite \\\n     | grep -v ':+++' \\\n     > $inp\n \n@@ -160,8 +170,9 @@ col (){\n \tfi\n \n \t# Don't reuse $inp, which may be generated using -H and thus contain a\n-\t# file prefix.\n-\tgrep -n '^+' $f \\\n+\t# file prefix.  Re-remove the testsuite since we're not using $inp.\n+\tcat $f | remove_testsuite \\\n+\t    | grep -n '^+' \\\n \t    | grep -v ':+++' \\\n \t    > $tmp\n \n@@ -174,11 +185,10 @@ col (){\n \t# Expand tabs to spaces according to tab positions.\n \t# Keep long lines, make short lines empty.  Print the part past 80 chars\n \t# in red.\n-        # Don't complain about dg-xxx directives in tests.\n \tcat \"$tmp\" \\\n \t    | sed 's/^[0-9]*:+//' \\\n \t    | expand \\\n-\t    | awk '$0 !~ /{[[:space:]]*dg-(error|warning|message)[[:space:]]/ { \\\n+\t    | awk '{ \\\n \t\t     if (length($0) > 80) \\\n \t\t       printf \"%s\\033[1;31m%s\\033[0m\\n\", \\\n \t\t\t      substr($0,1,80), \\"}]}