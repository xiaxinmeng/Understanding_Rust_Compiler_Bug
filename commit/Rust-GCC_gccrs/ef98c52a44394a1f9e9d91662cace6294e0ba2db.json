{"sha": "ef98c52a44394a1f9e9d91662cace6294e0ba2db", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWY5OGM1MmE0NDM5NGExZjllOWQ5MTY2MmNhY2U2Mjk0ZTBiYTJkYg==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargls@comcast.net", "date": "2005-12-17T17:30:26Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2005-12-17T17:30:26Z"}, "message": "re PR fortran/25458 ([4.1] Kind of constants in generic intrinsics)\n\n\tPR fortran/25458\n\t* simplify.c (gfc_simplify_ibset, gfc_simplify_not): Add call to\n\ttwos_complement.\n\n\t* gfortran.dg/chkbits.f90: New test.\n\n\nCo-Authored-By: Tobias Schl\u00fcter <tobias.schlueter@physik.uni-muenchen.de>\n\nFrom-SVN: r108720", "tree": {"sha": "34700f2c118f9dc255183f0bbb29babc379f826b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/34700f2c118f9dc255183f0bbb29babc379f826b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef98c52a44394a1f9e9d91662cace6294e0ba2db", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef98c52a44394a1f9e9d91662cace6294e0ba2db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef98c52a44394a1f9e9d91662cace6294e0ba2db", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef98c52a44394a1f9e9d91662cace6294e0ba2db/comments", "author": null, "committer": null, "parents": [{"sha": "573b07c7514cc57f64be4d3c3e33c27c8bbbd938", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/573b07c7514cc57f64be4d3c3e33c27c8bbbd938", "html_url": "https://github.com/Rust-GCC/gccrs/commit/573b07c7514cc57f64be4d3c3e33c27c8bbbd938"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "98e624a830ec5fc2907dbd4d479de5541971b4b9", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=ef98c52a44394a1f9e9d91662cace6294e0ba2db", "patch": "@@ -1,3 +1,10 @@\n+2005-12-17  Steven G. Kargl  <kargls@comcast.net>\n+\t    Tobias Schlueter <tobias.schlueter@physik.uni-muenchen.de>\n+\n+\tPR fortran/25458\n+\t* simplify.c (gfc_simplify_ibset, gfc_simplify_not): Add call to\n+\ttwos_complement.\n+\n 2005-12-17  Steven G. Kargl  <kargls@comcast.net>\n \n \t* decl.c (gfc_match_old_kind_spec,match_type_spec): Use gfc_std_notify"}, {"sha": "5b47e930db63f97a7a932307839c3f2f312ede5b", "filename": "gcc/fortran/simplify.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ffortran%2Fsimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ffortran%2Fsimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsimplify.c?ref=ef98c52a44394a1f9e9d91662cace6294e0ba2db", "patch": "@@ -1348,6 +1348,9 @@ gfc_simplify_ibset (gfc_expr * x, gfc_expr * y)\n   result = gfc_copy_expr (x);\n \n   mpz_setbit (result->value.integer, pos);\n+\n+  twos_complement (result->value.integer, gfc_integer_kinds[k].bit_size);\n+\n   return range_check (result, \"IBSET\");\n }\n \n@@ -2514,6 +2517,8 @@ gfc_simplify_not (gfc_expr * e)\n   mpz_and (result->value.integer, result->value.integer,\n \t   gfc_integer_kinds[i].max_int);\n \n+  twos_complement (result->value.integer, gfc_integer_kinds[i].bit_size);\n+\n   return range_check (result, \"NOT\");\n }\n "}, {"sha": "b7e00b9046a7b170986a5a36d78cbcb9027a6abe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ef98c52a44394a1f9e9d91662cace6294e0ba2db", "patch": "@@ -1,3 +1,8 @@\n+2005-12-17  Steven G. Kargl  <kargls@comcast.net>\n+\n+\t* PR fortran/25458\n+\t* gfortran.dg/chkbits.f90: New test.\n+\n 2005-12-17  Steven G. Kargl  <kargls@comcast.net>\n \n \t*gfortran.dg/enum_5.f:  Revert to previous version."}, {"sha": "19ab5c722c6e4eb02f8198e82148aa197057f240", "filename": "gcc/testsuite/gfortran.dg/chkbits.f90", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ftestsuite%2Fgfortran.dg%2Fchkbits.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef98c52a44394a1f9e9d91662cace6294e0ba2db/gcc%2Ftestsuite%2Fgfortran.dg%2Fchkbits.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fchkbits.f90?ref=ef98c52a44394a1f9e9d91662cace6294e0ba2db", "patch": "@@ -0,0 +1,26 @@\n+! { dg-do run }\n+! NOT() was not return the two's complement value as reported by\n+! PR fortran/25458.  In checking other bit manipulation intrinsics,\n+! IBSET was found to be in error.\n+program chkbits\n+\n+  implicit none\n+\n+  integer(kind=1) i1\n+  integer(kind=2) i2\n+  integer(kind=4) i4\n+  integer(kind=8) i8\n+\n+  i1 = ibset(2147483647,bit_size(i4)-1)\n+  i2 = ibset(2147483647,bit_size(i4)-1)\n+  i4 = ibset(2147483647,bit_size(i4)-1)\n+  i8 = ibset(2147483647,bit_size(i4)-1)\n+  if (i1 /= -1 .or. i2 /= -1 .or. i4 /= -1 .or. i8 /= -1) call abort\n+\n+  i1 = not(0)\n+  i2 = not(0)\n+  i4 = not(0)\n+  i8 = not(0)\n+  if (i1 /= -1 .or. i2 /= -1 .or. i4 /= -1 .or. i8 /= -1) call abort\n+\n+end program chkbits"}]}