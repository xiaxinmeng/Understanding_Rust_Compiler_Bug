{"sha": "aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWE1ZjNiYWQzYTFhODMzZDM4MzQ4OWMzYzRkYTJjMGQ2ZDI0ODY4MA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mmitchell@usa.net", "date": "1997-09-06T20:10:05Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1997-09-06T20:10:05Z"}, "message": "decl.c (replace_defag): Undo previous change.\n\nSat Sep  6 10:20:27 1997  Mark Mitchell  <mmitchell@usa.net>\n\n\t* decl.c (replace_defag): Undo previous change.\n\t* lex.c (do_pending_defargs): Deal with member templates.\n\n\t* pt.c (is_member_template): Avoid crashing when passed a\n\tnon-function argument.\n\nFrom-SVN: r15131", "tree": {"sha": "f865afaaa550653569b0d7ac063bd7f7dc9c4bc8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f865afaaa550653569b0d7ac063bd7f7dc9c4bc8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/comments", "author": null, "committer": null, "parents": [{"sha": "98c1c668807d74ad4dfab8c0413499b31f638258", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98c1c668807d74ad4dfab8c0413499b31f638258", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98c1c668807d74ad4dfab8c0413499b31f638258"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "f446a4f59475a9bfec382f80e10a40fc780431bc", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "patch": "@@ -1,3 +1,11 @@\n+Sat Sep  6 10:20:27 1997  Mark Mitchell  <mmitchell@usa.net>\n+\n+\t* decl.c (replace_defag): Undo previous change.\n+\t* lex.c (do_pending_defargs): Deal with member templates.\n+\t\n+\t* pt.c (is_member_template): Avoid crashing when passed a\n+\tnon-function argument.\n+\n Fri Sep  5 17:27:38 1997  Jason Merrill  <jason@yorick.cygnus.com>\n \n \t* class.c (grow_method): Remove check for redeclaration."}, {"sha": "1e5a56f40dea4f9386770114a573b47aa803da23", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "patch": "@@ -10070,7 +10070,7 @@ void\n replace_defarg (arg, init)\n      tree arg, init;\n {\n-  if (! processing_template_decl && ! uses_template_parms (TREE_VALUE (arg))\n+  if (! processing_template_decl\n       && ! can_convert_arg (TREE_VALUE (arg), TREE_TYPE (init), init))\n     cp_pedwarn (\"invalid type `%T' for default argument to `%T'\",\n \t\tTREE_TYPE (init), TREE_VALUE (arg));"}, {"sha": "471033faf9e8eb8641611d53187582c3e2fbe4c4", "filename": "gcc/cp/lex.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2Flex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2Flex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flex.c?ref=aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "patch": "@@ -1873,6 +1873,8 @@ do_pending_defargs ()\n \n \t  push_nested_class (TREE_PURPOSE (defarg_fns), 1);\n \t  pushlevel (0);\n+\t  if (is_member_template (defarg_fn))\n+\t    begin_member_template_processing (DECL_TI_ARGS (defarg_fn));\n \n \t  if (TREE_CODE (defarg_fn) == FUNCTION_DECL)\n \t    {\n@@ -1899,6 +1901,8 @@ do_pending_defargs ()\n \t    return;\n \t  }\n \n+      if (is_member_template (defarg_fn))\n+\tend_member_template_processing ();\n       poplevel (0, 0, 0);\n       pop_nested_class (1);\n     }"}, {"sha": "a0154e173eff0046ea562f91709b3ea49e4dd20b", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa5f3bad3a1a833d383489c3c4da2c0d6d248680/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=aa5f3bad3a1a833d383489c3c4da2c0d6d248680", "patch": "@@ -132,6 +132,12 @@ is_member_template (t)\n {\n   int r = 0;\n \n+  if (TREE_CODE (t) != FUNCTION_DECL\n+      && !DECL_FUNCTION_TEMPLATE_P (t))\n+    /* Anything that isn't a template or a template functon is\n+       certainly not a member template.  */\n+    return 0;\n+\n   if (DECL_FUNCTION_MEMBER_P (t) ||\n       (TREE_CODE (t) == TEMPLATE_DECL && \n        DECL_FUNCTION_MEMBER_P (DECL_TEMPLATE_RESULT (t))))"}]}