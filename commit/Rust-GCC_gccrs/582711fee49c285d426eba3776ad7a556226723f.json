{"sha": "582711fee49c285d426eba3776ad7a556226723f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTgyNzExZmVlNDljMjg1ZDQyNmViYTM3NzZhZDdhNTU2MjI2NzIzZg==", "commit": {"author": {"name": "Bob Wilson", "email": "bob.wilson@acm.org", "date": "2007-06-08T16:49:23Z"}, "committer": {"name": "Bob Wilson", "email": "bwilson@gcc.gnu.org", "date": "2007-06-08T16:49:23Z"}, "message": "lib1funcs.asm (__udivsi3): Use hardware divide instructions if they are supported.\n\n\t* config/xtensa/lib1funcs.asm (__udivsi3): Use hardware divide\n\tinstructions if they are supported.\n\t(__divsi3, __umodsi3, __modsi3): Likewise.\n\t(__ashldi3, __ashrdi3, __lshrdi3): New.\n\t* config/xtensa/t-xtensa (LIB1ASMFUNCS): Add DImode shift functions.\n\nFrom-SVN: r125577", "tree": {"sha": "288596f7a015a406316f720f87298b9f15ce7cdd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/288596f7a015a406316f720f87298b9f15ce7cdd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/582711fee49c285d426eba3776ad7a556226723f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/582711fee49c285d426eba3776ad7a556226723f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/582711fee49c285d426eba3776ad7a556226723f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/582711fee49c285d426eba3776ad7a556226723f/comments", "author": null, "committer": null, "parents": [{"sha": "792ed98bb712d700adcbde5549704b74cca59eb2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/792ed98bb712d700adcbde5549704b74cca59eb2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/792ed98bb712d700adcbde5549704b74cca59eb2"}], "stats": {"total": 98, "additions": 98, "deletions": 0}, "files": [{"sha": "83dfcc3e73b39b3a5b2fc560b2e5defbfa81f54b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/582711fee49c285d426eba3776ad7a556226723f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/582711fee49c285d426eba3776ad7a556226723f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=582711fee49c285d426eba3776ad7a556226723f", "patch": "@@ -1,3 +1,11 @@\n+2007-06-08  Bob Wilson  <bob.wilson@acm.org>\n+\n+\t* config/xtensa/lib1funcs.asm (__udivsi3): Use hardware divide\n+\tinstructions if they are supported.\n+\t(__divsi3, __umodsi3, __modsi3): Likewise.\n+\t(__ashldi3, __ashrdi3, __lshrdi3): New.\n+\t* config/xtensa/t-xtensa (LIB1ASMFUNCS): Add DImode shift functions.\n+\t\n 2007-06-08  Harsha Jagasia <harsha.jagasia@amd.com>\n             Tony Linthicum <tony.linthicum@amd.com>\n "}, {"sha": "27b67c43d6fbf996bbd30fd06e4a8a284dd063f0", "filename": "gcc/config/xtensa/lib1funcs.asm", "status": "modified", "additions": 89, "deletions": 0, "changes": 89, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/582711fee49c285d426eba3776ad7a556226723f/gcc%2Fconfig%2Fxtensa%2Flib1funcs.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/582711fee49c285d426eba3776ad7a556226723f/gcc%2Fconfig%2Fxtensa%2Flib1funcs.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Flib1funcs.asm?ref=582711fee49c285d426eba3776ad7a556226723f", "patch": "@@ -486,6 +486,9 @@ __ffssi2:\n \t.type\t__udivsi3, @function\n __udivsi3:\n \tleaf_entry sp, 16\n+#if XCHAL_HAVE_DIV32\n+\tquou\ta2, a2, a3\n+#else\n \tbltui\ta3, 2, .Lle_one\t/* check if the divisor <= 1 */\n \n \tmov\ta6, a2\t\t/* keep dividend in a6 */\n@@ -539,6 +542,7 @@ __udivsi3:\n \n .Lreturn0:\n \tmovi\ta2, 0\n+#endif /* XCHAL_HAVE_DIV32 */\n \tleaf_return\n \t.size\t__udivsi3, . - __udivsi3\n \n@@ -551,6 +555,9 @@ __udivsi3:\n \t.type\t__divsi3, @function\n __divsi3:\n \tleaf_entry sp, 16\n+#if XCHAL_HAVE_DIV32\n+\tquos\ta2, a2, a3\n+#else\n \txor\ta7, a2, a3\t/* sign = dividend ^ divisor */\n \tdo_abs\ta6, a2, a4\t/* udividend = abs (dividend) */\n \tdo_abs\ta3, a3, a4\t/* udivisor = abs (divisor) */\n@@ -610,6 +617,7 @@ __divsi3:\n \n .Lreturn0:\n \tmovi\ta2, 0\n+#endif /* XCHAL_HAVE_DIV32 */\n \tleaf_return\n \t.size\t__divsi3, . - __divsi3\n \n@@ -622,6 +630,9 @@ __divsi3:\n \t.type\t__umodsi3, @function\n __umodsi3:\n \tleaf_entry sp, 16\n+#if XCHAL_HAVE_DIV32\n+\tremu\ta2, a2, a3\n+#else\n \tbltui\ta3, 2, .Lle_one\t/* check if the divisor is <= 1 */\n \n \tdo_nsau\ta5, a2, a6, a7\t/* dividend_shift = nsau (dividend) */\n@@ -664,6 +675,7 @@ __umodsi3:\n \n .Lreturn0:\n \tmovi\ta2, 0\n+#endif /* XCHAL_HAVE_DIV32 */\n \tleaf_return\n \t.size\t__umodsi3, . - __umodsi3\n \n@@ -676,6 +688,9 @@ __umodsi3:\n \t.type\t__modsi3, @function\n __modsi3:\n \tleaf_entry sp, 16\n+#if XCHAL_HAVE_DIV32\n+\trems\ta2, a2, a3\n+#else\n \tmov\ta7, a2\t\t/* save original (signed) dividend */\n \tdo_abs\ta2, a2, a4\t/* udividend = abs (dividend) */\n \tdo_abs\ta3, a3, a4\t/* udivisor = abs (divisor) */\n@@ -723,10 +738,84 @@ __modsi3:\n \n .Lreturn0:\n \tmovi\ta2, 0\n+#endif /* XCHAL_HAVE_DIV32 */\n \tleaf_return\n \t.size\t__modsi3, . - __modsi3\n \n #endif /* L_modsi3 */\n \n+\n+#ifdef __XTENSA_EB__\n+#define uh a2\n+#define ul a3\n+#else\n+#define uh a3\n+#define ul a2\n+#endif /* __XTENSA_EB__ */\n+\n+\n+#ifdef L_ashldi3\n+\t.align\t4\n+\t.global\t__ashldi3\n+\t.type\t__ashldi3, @function\n+__ashldi3:\n+\tleaf_entry sp, 16\n+\tssl\ta4\n+\tbgei\ta4, 32, .Llow_only\n+\tsrc\tuh, uh, ul\n+\tsll\tul, ul\n+\tleaf_return\n+\n+.Llow_only:\n+\tsll\tuh, ul\n+\tmovi\tul, 0\n+\tleaf_return\n+\t.size\t__ashldi3, . - __ashldi3\n+\n+#endif /* L_ashldi3 */\n+\n+\n+#ifdef L_ashrdi3\n+\t.align\t4\n+\t.global\t__ashrdi3\n+\t.type\t__ashrdi3, @function\n+__ashrdi3:\n+\tleaf_entry sp, 16\n+\tssr\ta4\n+\tbgei\ta4, 32, .Lhigh_only\n+\tsrc\tul, uh, ul\n+\tsra\tuh, uh\n+\tleaf_return\n+\n+.Lhigh_only:\n+\tsra\tul, uh\n+\tsrai\tuh, uh, 31\n+\tleaf_return\n+\t.size\t__ashrdi3, . - __ashrdi3\n+\n+#endif /* L_ashrdi3 */\n+\n+\n+#ifdef L_lshrdi3\n+\t.align\t4\n+\t.global\t__lshrdi3\n+\t.type\t__lshrdi3, @function\n+__lshrdi3:\n+\tleaf_entry sp, 16\n+\tssr\ta4\n+\tbgei\ta4, 32, .Lhigh_only1\n+\tsrc\tul, uh, ul\n+\tsrl\tuh, uh\n+\tleaf_return\n+\n+.Lhigh_only1:\n+\tsrl\tul, uh\n+\tmovi\tuh, 0\n+\tleaf_return\n+\t.size\t__lshrdi3, . - __lshrdi3\n+\n+#endif /* L_lshrdi3 */\n+\n+\n #include \"ieee754-df.S\"\n #include \"ieee754-sf.S\""}, {"sha": "5db4f7c66ce2c101194f2bdbd6054302ee51e483", "filename": "gcc/config/xtensa/t-xtensa", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/582711fee49c285d426eba3776ad7a556226723f/gcc%2Fconfig%2Fxtensa%2Ft-xtensa", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/582711fee49c285d426eba3776ad7a556226723f/gcc%2Fconfig%2Fxtensa%2Ft-xtensa", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Ft-xtensa?ref=582711fee49c285d426eba3776ad7a556226723f", "patch": "@@ -1,6 +1,7 @@\n LIB1ASMSRC = xtensa/lib1funcs.asm\n LIB1ASMFUNCS = _mulsi3 _divsi3 _modsi3 _udivsi3 _umodsi3 \\\n \t_umulsidi3 _clz _clzsi2 _ctzsi2 _ffssi2 \\\n+\t_ashldi3 _ashrdi3 _lshrdi3 \\\n \t_negsf2 _addsubsf3 _mulsf3 _divsf3 _cmpsf2 _fixsfsi _fixsfdi \\\n \t_fixunssfsi _fixunssfdi _floatsisf _floatunsisf \\\n \t_floatdisf _floatundisf \\"}]}