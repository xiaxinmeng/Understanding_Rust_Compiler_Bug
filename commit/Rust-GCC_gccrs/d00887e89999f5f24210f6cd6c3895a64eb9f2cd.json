{"sha": "d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDAwODg3ZTg5OTk5ZjVmMjQyMTBmNmNkNmMzODk1YTY0ZWI5ZjJjZA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2014-05-01T07:16:10Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2014-05-01T07:16:10Z"}, "message": "re PR c/43245 (add option to control \"discarding qualifiers\" warnings)\n\n\tPR c/43245\n\t* doc/invoke.texi: Document -Wdiscarded-qualifiers.\nc-family/\n\t* c.opt (Wdiscarded-qualifiers): Add.\nc/\n\t* c-typeck.c (convert_for_assignment): Pass OPT_Wdiscarded_qualifiers\n\tinstead of 0 to WARN_FOR_QUALIFIERS.\ntestsuite/\n\t* gcc.dg/pr43245.c: New test.\n\nFrom-SVN: r209970", "tree": {"sha": "0e3a810a247c23366f355169db0d3d71078a67f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0e3a810a247c23366f355169db0d3d71078a67f9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5436fa2e87fd7df010144347bd3e1fcc0a48d901", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5436fa2e87fd7df010144347bd3e1fcc0a48d901", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5436fa2e87fd7df010144347bd3e1fcc0a48d901"}], "stats": {"total": 61, "additions": 57, "deletions": 4}, "files": [{"sha": "2d2b7878c4c7856585a68648de12a98c56773956", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -1,3 +1,8 @@\n+2014-05-01  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/43245\n+\t* doc/invoke.texi: Document -Wdiscarded-qualifiers.\n+\n 2014-04-30  Alan Lawrence  <alan.lawrence@arm.com>\n \n \t* config/aarch64/arm_neon.h (vuzp1_f32, vuzp1_p8, vuzp1_p16, vuzp1_s8,"}, {"sha": "fddfcd8c2f04af69010c38dedb3e68b2bf9fb155", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -1,3 +1,8 @@\n+2014-05-01  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/43245\n+\t* c.opt (Wdiscarded-qualifiers): Add.\n+\n 2014-04-30  Marek Polacek  <polacek@redhat.com>\n \n \t* c-ubsan.c (ubsan_instrument_division): Handle REAL_TYPEs.  Perform"}, {"sha": "1bbb81c8425b3bde4b0f617a55bce0d2c4cb839a", "filename": "gcc/c-family/c.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc-family%2Fc.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc-family%2Fc.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc.opt?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -355,6 +355,10 @@ Wdeprecated\n C C++ ObjC ObjC++ Var(warn_deprecated) Init(1) Warning\n Warn if a deprecated compiler feature, class, method, or field is used\n \n+Wdiscarded-qualifiers\n+C ObjC Var(warn_discarded_qualifiers) Init(1) Warning\n+Warn if type qualifiers on pointers are discarded\n+\n Wdiv-by-zero\n C ObjC C++ ObjC++ Var(warn_div_by_zero) Init(1) Warning\n Warn about compile-time integer division by zero"}, {"sha": "b10f6f7da9f873242e4d1dc0144334e036f5155d", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -1,3 +1,9 @@\n+2014-05-01  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/43245\n+\t* c-typeck.c (convert_for_assignment): Pass OPT_Wdiscarded_qualifiers\n+\tinstead of 0 to WARN_FOR_QUALIFIERS.\n+\n 2014-05-01  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/56989"}, {"sha": "e25a25ca48e823a952cfbbf67c07b48083d75d87", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -5852,7 +5852,7 @@ convert_for_assignment (location_t location, location_t expr_loc, tree type,\n \t\t     vice-versa.  */\n \t\t  if (TYPE_QUALS_NO_ADDR_SPACE (ttl)\n \t\t      & ~TYPE_QUALS_NO_ADDR_SPACE (ttr))\n-\t\t    WARN_FOR_QUALIFIERS (location, 0,\n+\t\t    WARN_FOR_QUALIFIERS (location, OPT_Wdiscarded_qualifiers,\n \t\t\t\t\t G_(\"passing argument %d of %qE \"\n \t\t\t\t\t    \"makes %q#v qualified function \"\n \t\t\t\t\t    \"pointer from unqualified\"),\n@@ -5868,7 +5868,7 @@ convert_for_assignment (location_t location, location_t expr_loc, tree type,\n \t\t}\n \t      else if (TYPE_QUALS_NO_ADDR_SPACE (ttr)\n \t\t       & ~TYPE_QUALS_NO_ADDR_SPACE (ttl))\n-\t\tWARN_FOR_QUALIFIERS (location, 0,\n+\t\tWARN_FOR_QUALIFIERS (location, OPT_Wdiscarded_qualifiers,\n \t\t\t\t     G_(\"passing argument %d of %qE discards \"\n \t\t\t\t\t\"%qv qualifier from pointer target type\"),\n \t\t\t\t     G_(\"assignment discards %qv qualifier \"\n@@ -6049,7 +6049,7 @@ convert_for_assignment (location_t location, location_t expr_loc, tree type,\n \t      if (TYPE_QUALS_NO_ADDR_SPACE_NO_ATOMIC (ttr)\n \t\t  & ~TYPE_QUALS_NO_ADDR_SPACE_NO_ATOMIC (ttl))\n \t\t{\n-\t\t  WARN_FOR_QUALIFIERS (location, 0,\n+\t\t  WARN_FOR_QUALIFIERS (location, OPT_Wdiscarded_qualifiers,\n \t\t\t\t       G_(\"passing argument %d of %qE discards \"\n \t\t\t\t\t  \"%qv qualifier from pointer target type\"),\n \t\t\t\t       G_(\"assignment discards %qv qualifier \"\n@@ -6086,7 +6086,7 @@ convert_for_assignment (location_t location, location_t expr_loc, tree type,\n \t\t where an ordinary one is wanted, but not vice-versa.  */\n \t      if (TYPE_QUALS_NO_ADDR_SPACE (ttl)\n \t\t  & ~TYPE_QUALS_NO_ADDR_SPACE (ttr))\n-\t\tWARN_FOR_QUALIFIERS (location, 0,\n+\t\tWARN_FOR_QUALIFIERS (location, OPT_Wdiscarded_qualifiers,\n \t\t\t\t     G_(\"passing argument %d of %qE makes \"\n \t\t\t\t\t\"%q#v qualified function pointer \"\n \t\t\t\t\t\"from unqualified\"),"}, {"sha": "0eba1e0a162caf9abd8372300ad700d614bb2c39", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -242,6 +242,7 @@ Objective-C and Objective-C++ Dialects}.\n -Wchar-subscripts -Wclobbered  -Wcomment -Wconditionally-supported  @gol\n -Wconversion -Wcoverage-mismatch -Wdate-time -Wdelete-incomplete -Wno-cpp  @gol\n -Wno-deprecated -Wno-deprecated-declarations -Wdisabled-optimization  @gol\n+-Wno-discarded-qualifiers @gol\n -Wno-div-by-zero -Wdouble-promotion -Wempty-body  -Wenum-compare @gol\n -Wno-endif-labels -Werror  -Werror=* @gol\n -Wfatal-errors  -Wfloat-equal  -Wformat  -Wformat=2 @gol\n@@ -4182,6 +4183,15 @@ This option is only active when @option{-ftree-vrp} is active\n (default for @option{-O2} and above). It warns about subscripts to arrays\n that are always out of bounds. This warning is enabled by @option{-Wall}.\n \n+@item -Wno-discarded-qualifiers\n+@opindex Wno-discarded-qualifiers\n+@opindex Wdiscarded-qualifiers\n+Do not warn if type qualifiers on pointers are being discarded.\n+Typically, the compiler will warn if a @code{const char *} variable is\n+passed to a function that takes @code{char *} parameter.  This option\n+can be used to suppress such a warning.  This warning is only supported\n+for C.\n+\n @item -Wno-div-by-zero\n @opindex Wno-div-by-zero\n @opindex Wdiv-by-zero"}, {"sha": "619049730bd947097263dd0b5481feb310203a1a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -1,3 +1,8 @@\n+2014-05-01  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/43245\n+\t* gcc.dg/pr43245.c: New test.\n+\n 2014-05-01  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/56989"}, {"sha": "85490ffaa82cfb40e9ffd3c37c478bbf6d1bf045", "filename": "gcc/testsuite/gcc.dg/pr43245.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43245.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d00887e89999f5f24210f6cd6c3895a64eb9f2cd/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43245.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr43245.c?ref=d00887e89999f5f24210f6cd6c3895a64eb9f2cd", "patch": "@@ -0,0 +1,18 @@\n+/* PR c/43245 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wno-discarded-qualifiers\" } */\n+\n+void\n+foo (char *p)\n+{\n+}\n+\n+char *\n+bar (void)\n+{\n+  const char *s = \"foo\";\n+  char *s1 = s;\n+  s1 = s;\n+  foo (s);\n+  return s;\n+}"}]}