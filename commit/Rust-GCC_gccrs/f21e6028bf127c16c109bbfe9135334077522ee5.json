{"sha": "f21e6028bf127c16c109bbfe9135334077522ee5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjIxZTYwMjhiZjEyN2MxNmMxMDliYmZlOTEzNTMzNDA3NzUyMmVlNQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2003-08-01T09:10:29Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2003-08-01T09:10:29Z"}, "message": "re PR c++/11525 (ICE/segfault on C++ code)\n\ncp:\n\tPR c++/11525\n\t* parser.c (cp_parser_primary_expression): Do not set\n\tnon-constant-p merely because it is a dependent scope.\ntestsuite:\n\tPR c++/11525\n\t* g++.dg/parse/constant4.C: New test.\n\nFrom-SVN: r70041", "tree": {"sha": "d54995de86d2bed6da9b874ebae55c3a69e5f7e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d54995de86d2bed6da9b874ebae55c3a69e5f7e8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f21e6028bf127c16c109bbfe9135334077522ee5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f21e6028bf127c16c109bbfe9135334077522ee5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f21e6028bf127c16c109bbfe9135334077522ee5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f21e6028bf127c16c109bbfe9135334077522ee5/comments", "author": null, "committer": null, "parents": [{"sha": "2fdd01a09a1376515255cfb8a568f682dce80fbc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2fdd01a09a1376515255cfb8a568f682dce80fbc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2fdd01a09a1376515255cfb8a568f682dce80fbc"}], "stats": {"total": 52, "additions": 47, "deletions": 5}, "files": [{"sha": "1bc4fed5a5a73dd09be3d10ac3dbac3089e02b7c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f21e6028bf127c16c109bbfe9135334077522ee5", "patch": "@@ -1,5 +1,9 @@\n 2003-08-01  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\tPR c++/11525\n+\t* parser.c (cp_parser_primary_expression): Do not set\n+\tnon-constant-p merely because it is a dependent scope.\n+\n \tPR c++/9447\n \t* decl2.c (do_class_using_decl): Set type to NULL_TREE.\n \t* semantics.c (finish_expr_stmt): Do not convert to void in a"}, {"sha": "c4b40b20d0403d363b8a036068b5608151f08ea0", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=f21e6028bf127c16c109bbfe9135334077522ee5", "patch": "@@ -2394,11 +2394,6 @@ cp_parser_primary_expression (cp_parser *parser,\n \t      {\n \t\tif (TYPE_P (TREE_OPERAND (decl, 0)))\n \t\t  *qualifying_class = TREE_OPERAND (decl, 0);\n-\t\t/* Since this name was dependent, the expression isn't\n-\t\t   constant -- yet.  No error is issued because it\n-\t\t   might be constant when things are instantiated.  */\n-\t\tif (parser->constant_expression_p)\n-\t\t  parser->non_constant_expression_p = true;\n \t\treturn decl;\n \t      }\n \t    /* Check to see if DECL is a local variable in a context"}, {"sha": "f78f24ecb7de0144186515c9301f7e506cdbe2b3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f21e6028bf127c16c109bbfe9135334077522ee5", "patch": "@@ -1,5 +1,8 @@\n 2003-08-01  Nathan Sidwell  <nathan@codesourcery.com>\n \n+\tPR c++/11525\n+\t* g++.dg/parse/constant4.C: New test.\n+\n \tPR c++/9447\n \t* g++.dg/template/using5.C: New test.\n "}, {"sha": "65c84d94a13c72643ffb6c4274e306b4105d11a9", "filename": "gcc/testsuite/g++.dg/parse/constant4.C", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fconstant4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f21e6028bf127c16c109bbfe9135334077522ee5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fconstant4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fconstant4.C?ref=f21e6028bf127c16c109bbfe9135334077522ee5", "patch": "@@ -0,0 +1,40 @@\n+// { dg-do compile }\n+\n+// Copyright (C) 2003 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 31 Jul 2003 <nathan@codesourcery.com>\n+\n+// PR c++/11525 incorrect error about non-constant initalizer\n+\n+template<typename> class X;\n+template<unsigned> class Y {};\n+\n+\n+template<typename T>\n+void Foo ()\n+{\n+  static const unsigned I = X<T>::I;\n+  \n+  Y<I> i;\n+  \n+  static const unsigned J = X<T>::J;\n+  \n+  Y<J> j; // { dg-error \"non-constant\" \"\" }\n+}\n+\n+struct A \n+{\n+  operator unsigned () const;\n+};\n+\n+template <typename> struct X \n+{\n+  enum {I};\n+  static A const J;\n+};\n+\n+void Baz ()\n+{\n+  Foo<int> (); // { dg-error \"instantiated\" \"\" }\n+}\n+\n+  "}]}