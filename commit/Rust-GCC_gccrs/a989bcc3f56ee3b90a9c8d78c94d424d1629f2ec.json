{"sha": "a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTk4OWJjYzNmNTZlZTNiOTBhOWM4ZDc4Yzk0ZDQyNGQxNjI5ZjJlYw==", "commit": {"author": {"name": "Ilya Enkovich", "email": "enkovich.gnu@gmail.com", "date": "2015-11-12T12:59:05Z"}, "committer": {"name": "Ilya Enkovich", "email": "ienkovich@gcc.gnu.org", "date": "2015-11-12T12:59:05Z"}, "message": "re PR tree-optimization/68305 (ICE on valid code at -O3 on x86_64-linux-gnu: tree check: expected class \u2018expression\u2019, have \u2018exceptional\u2019 (ssa_name) in tree_operand_check, at tree.h:3436)\n\ngcc/\n\n\tPR tree-optimization/68305\n\t* tree-vect-slp.c (vect_get_constant_vectors): Support\n\tCOND_EXPR with SSA_NAME as a condition.\n\ngcc/testsuite/\n\n\tPR tree-optimization/68305\n\t* gcc.dg/vect/pr68305.c: New test.\n\nFrom-SVN: r230252", "tree": {"sha": "48e0f9ed7a313456cf68d43eef0adfe2dc339df9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/48e0f9ed7a313456cf68d43eef0adfe2dc339df9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/comments", "author": null, "committer": null, "parents": [{"sha": "02215d8f13b9c1d827057f1fddc9355ec3158e84", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02215d8f13b9c1d827057f1fddc9355ec3158e84", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02215d8f13b9c1d827057f1fddc9355ec3158e84"}], "stats": {"total": 48, "additions": 37, "deletions": 11}, "files": [{"sha": "b7c3df7830c55d7b99d6a319a36311d50b531528", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "patch": "@@ -1,3 +1,9 @@\n+2015-11-12  Ilya Enkovich  <enkovich.gnu@gmail.com>\n+\n+\tPR tree-optimization/68305\n+\t* tree-vect-slp.c (vect_get_constant_vectors): Support\n+\tCOND_EXPR with SSA_NAME as a condition.\n+\n 2015-11-12  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* config/visium/visium-protos.h (notice_update_cc): Delete."}, {"sha": "c71b979c4c15facd8cf3681a444c06f9cfaa6990", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "patch": "@@ -1,3 +1,8 @@\n+2015-11-12  Ilya Enkovich  <enkovich.gnu@gmail.com>\n+\n+\tPR tree-optimization/68305\n+\t* gcc.dg/vect/pr68305.c: New test.\n+\n 2015-11-12  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc.target/i386/pr67265-2.c: New test."}, {"sha": "fde3db723cc7a8d594e6847fa396a0bc6f8900b0", "filename": "gcc/testsuite/gcc.dg/vect/pr68305.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr68305.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr68305.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr68305.c?ref=a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-O3\" } */\n+/* { dg-additional-options \"-mavx2\" { target avx_runtime } } */\n+\n+int a, b;\n+\n+void\n+fn1 ()\n+{\n+  int c, d;\n+  for (; b; b++)\n+    a = a ^ !c ^ !d;\n+}"}, {"sha": "ab1d40eb5758b766dcaed4021a7283de475f0bf7", "filename": "gcc/tree-vect-slp.c", "status": "modified", "additions": 13, "deletions": 11, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2Ftree-vect-slp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec/gcc%2Ftree-vect-slp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-slp.c?ref=a989bcc3f56ee3b90a9c8d78c94d424d1629f2ec", "patch": "@@ -2740,18 +2740,20 @@ vect_get_constant_vectors (tree op, slp_tree slp_node,\n \t      switch (code)\n \t\t{\n \t\t  case COND_EXPR:\n-\t\t    if (op_num == 0 || op_num == 1)\n-\t\t      {\n-\t\t\ttree cond = gimple_assign_rhs1 (stmt);\n+\t\t    {\n+\t\t      tree cond = gimple_assign_rhs1 (stmt);\n+\t\t      if (TREE_CODE (cond) == SSA_NAME)\n+\t\t\top = gimple_op (stmt, op_num + 1);\n+\t\t      else if (op_num == 0 || op_num == 1)\n \t\t\top = TREE_OPERAND (cond, op_num);\n-\t\t      }\n-\t\t    else\n-\t\t      {\n-\t\t\tif (op_num == 2)\n-\t\t\t  op = gimple_assign_rhs2 (stmt);\n-\t\t\telse\n-\t\t\t  op = gimple_assign_rhs3 (stmt);\n-\t\t      }\n+\t\t      else\n+\t\t\t{\n+\t\t\t  if (op_num == 2)\n+\t\t\t    op = gimple_assign_rhs2 (stmt);\n+\t\t\t  else\n+\t\t\t    op = gimple_assign_rhs3 (stmt);\n+\t\t\t}\n+\t\t    }\n \t\t    break;\n \n \t\t  case CALL_EXPR:"}]}