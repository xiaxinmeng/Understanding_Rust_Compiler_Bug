{"sha": "41cbcf53dc60b7434b9ee059b3a734a47f5bf212", "node_id": "C_kwDOANBUbNoAKDQxY2JjZjUzZGM2MGI3NDM0YjllZTA1OWIzYTczNGE0N2Y1YmYyMTI", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-02-24T21:33:44Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-02-24T23:42:41Z"}, "message": "libstdc++: Fix cast in source_location::current() [PR104602]\n\nThis fixes a problem for Clang, which is going to return a non-void\npointer from __builtin_source_location(). The current definition of\nstd::source_location::current() converts that to void* and then has to\ncast it back again in the body (which makes it invalid in a constant\nexpression). By using the actual type of the returned pointer, we avoid\nthe problematic cast for Clang.\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/104602\n\t* include/std/source_location (source_location::current): Use\n\tdeduced type of __builtin_source_location().", "tree": {"sha": "264dc4687c317ad327f33b0f0b6c556eee8be5a4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/264dc4687c317ad327f33b0f0b6c556eee8be5a4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/41cbcf53dc60b7434b9ee059b3a734a47f5bf212", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41cbcf53dc60b7434b9ee059b3a734a47f5bf212", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41cbcf53dc60b7434b9ee059b3a734a47f5bf212", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41cbcf53dc60b7434b9ee059b3a734a47f5bf212/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ae3c4e521dd0b66db712639298cd08331d62f315", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae3c4e521dd0b66db712639298cd08331d62f315", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae3c4e521dd0b66db712639298cd08331d62f315"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "7b091bb91b72d06e38451fffc5b83da963d60030", "filename": "libstdc++-v3/include/std/source_location", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41cbcf53dc60b7434b9ee059b3a734a47f5bf212/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fsource_location", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41cbcf53dc60b7434b9ee059b3a734a47f5bf212/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fsource_location", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fsource_location?ref=41cbcf53dc60b7434b9ee059b3a734a47f5bf212", "patch": "@@ -43,12 +43,13 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n   {\n   private:\n     using uint_least32_t = __UINT_LEAST32_TYPE__;\n+    using __builtin_ret_type = decltype(__builtin_source_location());\n \n   public:\n \n     // [support.srcloc.cons], creation\n     static consteval source_location\n-    current(const void* __p = __builtin_source_location()) noexcept\n+    current(__builtin_ret_type __p = __builtin_source_location()) noexcept\n     {\n       source_location __ret;\n       __ret._M_impl = static_cast <const __impl*>(__p);"}]}