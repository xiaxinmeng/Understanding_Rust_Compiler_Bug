{"sha": "f49e3d28be44179f07b8a06159139ce77096dda7", "node_id": "C_kwDOANBUbNoAKGY0OWUzZDI4YmU0NDE3OWYwN2I4YTA2MTU5MTM5Y2U3NzA5NmRkYTc", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@golang.org", "date": "2021-10-08T03:22:25Z"}, "committer": {"name": "Ian Lance Taylor", "email": "iant@golang.org", "date": "2021-10-08T03:24:43Z"}, "message": "libgcc: use .init_stack for constructors if available\n\n\t* config/i386/morestack.S: Use .init_array for constructor if\n\tavailable.\n\t* config/rs6000/morestack.S: Likewise.\n\t* config/s390/morestack.S: Likewise.", "tree": {"sha": "b356bae5bf3ddb81fc9d80d60ec7290c47529d88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b356bae5bf3ddb81fc9d80d60ec7290c47529d88"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f49e3d28be44179f07b8a06159139ce77096dda7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f49e3d28be44179f07b8a06159139ce77096dda7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f49e3d28be44179f07b8a06159139ce77096dda7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f49e3d28be44179f07b8a06159139ce77096dda7/comments", "author": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "613196462a62a28de8414b9023ec2be9a29ac3dc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/613196462a62a28de8414b9023ec2be9a29ac3dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/613196462a62a28de8414b9023ec2be9a29ac3dc"}], "stats": {"total": 25, "additions": 21, "deletions": 4}, "files": [{"sha": "2e748eda8a7911b2e5d06cc1cb2e7ca9cf705798", "filename": "libgcc/config/i386/morestack.S", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f49e3d28be44179f07b8a06159139ce77096dda7/libgcc%2Fconfig%2Fi386%2Fmorestack.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f49e3d28be44179f07b8a06159139ce77096dda7/libgcc%2Fconfig%2Fi386%2Fmorestack.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Fi386%2Fmorestack.S?ref=f49e3d28be44179f07b8a06159139ce77096dda7", "patch": "@@ -23,6 +23,7 @@\n # see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n # <http://www.gnu.org/licenses/>.\n \n+#include \"auto-host.h\"\n \n # Support for allocating more stack space when using -fsplit-stack.\n # When a function discovers that it needs more stack space, it will\n@@ -75,7 +76,7 @@\n # The amount of extra space we ask for.  In general this has to be\n # enough for the dynamic loader to find a symbol and for a signal\n # handler to run.\n-\t\n+\n #ifndef __x86_64__\n #define BACKOFF (1024)\n #else\n@@ -160,7 +161,7 @@ __morestack_non_split:\n \tcmpb\t$0x55,1(%eax)\n \tje\t2f\n \n-3:\t\n+3:\n \tmovl\t%eax,4(%esp)\t\t# Update return address.\n \n \tpopl\t%eax\t\t\t# Restore %eax and stack.\n@@ -426,7 +427,7 @@ __morestack:\n \n # This is the cleanup code called by the stack unwinder when unwinding\n # through the code between .LEHB0 and .LEHE0 above.\n-\t\n+\n .L1:\n \t.cfi_restore_state\n \tsubl\t$16,%esp\t\t# Maintain 16 byte alignment.\n@@ -600,7 +601,7 @@ __morestack:\n \n # This is the cleanup code called by the stack unwinder when unwinding\n # through the code between .LEHB0 and .LEHE0 above.\n-\t\n+\n .L1:\n \t.cfi_restore_state\n \tsubq\t$16,%rsp\t\t# Maintain 16 byte alignment.\n@@ -848,7 +849,11 @@ __morestack_make_guard:\n # Make __stack_split_initialize a high priority constructor.  FIXME:\n # This is ELF specific.\n \n+#if HAVE_INITFINI_ARRAY_SUPPORT\n+\t.section\t.init_array.00000,\"aw\",@progbits\n+#else\n \t.section\t.ctors.65535,\"aw\",@progbits\n+#endif\n \n #ifndef __LP64__\n \t.align\t4"}, {"sha": "509e506a6dee71e6df6f2342c0e74c68e4cfc5be", "filename": "libgcc/config/rs6000/morestack.S", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f49e3d28be44179f07b8a06159139ce77096dda7/libgcc%2Fconfig%2Frs6000%2Fmorestack.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f49e3d28be44179f07b8a06159139ce77096dda7/libgcc%2Fconfig%2Frs6000%2Fmorestack.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Frs6000%2Fmorestack.S?ref=f49e3d28be44179f07b8a06159139ce77096dda7", "patch": "@@ -24,6 +24,8 @@\n # see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n # <http://www.gnu.org/licenses/>.\n \n+#include <auto-host.h>\n+\n #if _CALL_ELF == 2\n \t.abiversion 2\n #define PARAMS 32\n@@ -396,7 +398,11 @@ ENTRY0(__morestack_make_guard)\n \n \n # Make __stack_split_initialize a high priority constructor.\n+#if HAVE_INITFINI_ARRAY_SUPPORT\n+\t.section .init_array.00000,\"aw\",@progbits\n+#else\n \t.section .ctors.65535,\"aw\",@progbits\n+#endif\n \t.p2align 3\n \t.quad __stack_split_initialize\n \t.quad __morestack_load_mmap"}, {"sha": "d873de90d12526e678e7546878811cc221132379", "filename": "libgcc/config/s390/morestack.S", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f49e3d28be44179f07b8a06159139ce77096dda7/libgcc%2Fconfig%2Fs390%2Fmorestack.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f49e3d28be44179f07b8a06159139ce77096dda7/libgcc%2Fconfig%2Fs390%2Fmorestack.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Fs390%2Fmorestack.S?ref=f49e3d28be44179f07b8a06159139ce77096dda7", "patch": "@@ -28,6 +28,8 @@\n # also cover signal frame size.\n #define BACKOFF 0x1000\n \n+#include <auto-host.h>\n+\n # The __morestack function.\n \n \t.global\t__morestack\n@@ -594,7 +596,11 @@ __morestack_make_guard:\n \n # Make __stack_split_initialize a high priority constructor.\n \n+#if HAVE_INITFINI_ARRAY_SUPPORT\n+\t.section .init_array.00000,\"aw\",@progbits\n+#else\n \t.section .ctors.65535,\"aw\",@progbits\n+#endif\n \n #ifndef __LP64__\n \t.align\t4"}]}