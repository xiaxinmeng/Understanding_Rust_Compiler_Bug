{"sha": "f4d0971224c2218b6e954db26627933f3f2a49da", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjRkMDk3MTIyNGMyMjE4YjZlOTU0ZGIyNjYyNzkzM2YzZjJhNDlkYQ==", "commit": {"author": {"name": "Kirill Yukhin", "email": "kirill.yukhin@intel.com", "date": "2016-01-19T14:37:23Z"}, "committer": {"name": "Kirill Yukhin", "email": "kyukhin@gcc.gnu.org", "date": "2016-01-19T14:37:23Z"}, "message": "Fix ICE in vectorizable_store ().\n\ngcc/\n\t* tree-vect-stmts.c (vectorizable_store): Check\n\trhs vectype.\n\nFrom-SVN: r232568", "tree": {"sha": "f2b8207b977bf0f161cbd4afa5df0ad82bf3cd4f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f2b8207b977bf0f161cbd4afa5df0ad82bf3cd4f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f4d0971224c2218b6e954db26627933f3f2a49da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4d0971224c2218b6e954db26627933f3f2a49da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4d0971224c2218b6e954db26627933f3f2a49da", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4d0971224c2218b6e954db26627933f3f2a49da/comments", "author": null, "committer": null, "parents": [{"sha": "d6874f56624074a067b5f42bbacae030201e4520", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6874f56624074a067b5f42bbacae030201e4520", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6874f56624074a067b5f42bbacae030201e4520"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "9687f3f014e5c7c58b8cb97368b2105f459b49eb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4d0971224c2218b6e954db26627933f3f2a49da/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4d0971224c2218b6e954db26627933f3f2a49da/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f4d0971224c2218b6e954db26627933f3f2a49da", "patch": "@@ -1,3 +1,8 @@\n+2016-01-19  Kirill Yukhin  <kirill.yukhin@intel.com>\n+\n+\t* tree-vect-stmts.c (vectorizable_store): Check\n+\trhs vectype.\n+\n 2016-01-19  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR jit/68446"}, {"sha": "6be3c97d4592e21396817aa8bafa9f2b2a4f77fc", "filename": "gcc/tree-vect-stmts.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4d0971224c2218b6e954db26627933f3f2a49da/gcc%2Ftree-vect-stmts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4d0971224c2218b6e954db26627933f3f2a49da/gcc%2Ftree-vect-stmts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-stmts.c?ref=f4d0971224c2218b6e954db26627933f3f2a49da", "patch": "@@ -5282,7 +5282,7 @@ vectorizable_store (gimple *stmt, gimple_stmt_iterator *gsi, gimple **vec_stmt,\n \n   gcc_assert (gimple_assign_single_p (stmt));\n \n-  tree vectype = STMT_VINFO_VECTYPE (stmt_info);\n+  tree vectype = STMT_VINFO_VECTYPE (stmt_info), rhs_vectype = NULL_TREE;\n   unsigned int nunits = TYPE_VECTOR_SUBPARTS (vectype);\n \n   if (loop_vinfo)\n@@ -5308,14 +5308,18 @@ vectorizable_store (gimple *stmt, gimple_stmt_iterator *gsi, gimple **vec_stmt,\n     }\n \n   op = gimple_assign_rhs1 (stmt);\n-  if (!vect_is_simple_use (op, vinfo, &def_stmt, &dt))\n+\n+  if (!vect_is_simple_use (op, vinfo, &def_stmt, &dt, &rhs_vectype))\n     {\n       if (dump_enabled_p ())\n         dump_printf_loc (MSG_MISSED_OPTIMIZATION, vect_location,\n                          \"use not simple.\\n\");\n       return false;\n     }\n \n+  if (rhs_vectype && !useless_type_conversion_p (vectype, rhs_vectype))\n+    return false;\n+\n   elem_type = TREE_TYPE (vectype);\n   vec_mode = TYPE_MODE (vectype);\n "}]}