{"sha": "0984ba100b02d848788de3e60f0800f076704288", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDk4NGJhMTAwYjAyZDg0ODc4OGRlM2U2MGYwODAwZjA3NjcwNDI4OA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2004-06-30T11:44:50Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2004-06-30T11:44:50Z"}, "message": "struct-by-value-22_main.c: New test.\n\n\t* gcc.dg/compat/struct-by-value-22_main.c: New test.\n\t* gcc.dg/compat/struct-by-value-22_x.c: New.\n\t* gcc.dg/compat/struct-by-value-22_y.c: New.\n\nFrom-SVN: r83903", "tree": {"sha": "c31e514e1630a21bca337dae60d50a4a71403179", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c31e514e1630a21bca337dae60d50a4a71403179"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0984ba100b02d848788de3e60f0800f076704288", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0984ba100b02d848788de3e60f0800f076704288", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0984ba100b02d848788de3e60f0800f076704288", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0984ba100b02d848788de3e60f0800f076704288/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bddeccfe5d319972ef8dbf23b97870969654e8b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bddeccfe5d319972ef8dbf23b97870969654e8b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bddeccfe5d319972ef8dbf23b97870969654e8b1"}], "stats": {"total": 138, "additions": 138, "deletions": 0}, "files": [{"sha": "b37a2009fd5c9b5026bb6eadeb50deb58da816e1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0984ba100b02d848788de3e60f0800f076704288", "patch": "@@ -1,5 +1,9 @@\n 2004-06-30  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* gcc.dg/compat/struct-by-value-22_main.c: New test.\n+\t* gcc.dg/compat/struct-by-value-22_x.c: New.\n+\t* gcc.dg/compat/struct-by-value-22_y.c: New.\n+\n \t* gcc.c-torture/execute/20040629-1.c: New test.\n \n 2004-06-29  Jakub Jelinek  <jakub@redhat.com>"}, {"sha": "7f005ef0d885a646af20fc6eeff59415101953f5", "filename": "gcc/testsuite/gcc.dg/compat/struct-by-value-22_main.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_main.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_main.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_main.c?ref=0984ba100b02d848788de3e60f0800f076704288", "patch": "@@ -0,0 +1,16 @@\n+/* Test variable sized function argument passing.\n+   GCC 3.2 and earlier is incompatible with GCC 3.3+ on x86-64,\n+   the latter passes variable sized arguments by reference while\n+   the former doesn't.\n+   See http://gcc.gnu.org/ml/gcc-patches/2003-01/msg01830.html */\n+\n+extern void struct_by_value_22_x (void);\n+extern void exit (int);\n+int fails;\n+\n+int\n+main ()\n+{\n+  struct_by_value_22_x ();\n+  exit (0);\n+}"}, {"sha": "fa71a9edd3c2c588146dca2087d15530f70770bb", "filename": "gcc/testsuite/gcc.dg/compat/struct-by-value-22_x.c", "status": "added", "additions": 79, "deletions": 0, "changes": 79, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_x.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_x.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_x.c?ref=0984ba100b02d848788de3e60f0800f076704288", "patch": "@@ -0,0 +1,79 @@\n+#ifndef T\n+#include \"compat-common.h\"\n+#include \"mixed-struct-defs.h\"\n+#include \"mixed-struct-init.h\"\n+\n+#define T(NAME, FIELDS, TYPE, FIELDINIT, FIELDTEST)\t\t\t\\\n+extern void testva##NAME (int n, ...);\t\t\t\t\t\\\n+\t\t\t\t\t\t\t\t\t\\\n+void\t\t\t\t\t\t\t\t\t\\\n+testit##NAME (int n)\t\t\t\t\t\t\t\\\n+{\t\t\t\t\t\t\t\t\t\\\n+  struct S { FIELDS TYPE a[n]; } s;\t\t\t\t\t\\\n+  int i;\t\t\t\t\t\t\t\t\\\n+  FIELDINIT;\t\t\t\t\t\t\t\t\\\n+  for (i = 0; i < n; ++i)\t\t\t\t\t\t\\\n+    s.a[i] = 12 + n - i;\t\t\t\t\t\t\\\n+  testva##NAME (n, s, n, s);\t\t\t\t\t\t\\\n+}\n+\n+#include \"struct-by-value-22_x.c\"\n+\n+#undef T\n+\n+void\n+struct_by_value_22_x ()\n+{\n+  int n;\n+DEBUG_INIT\n+\n+#define T(NAME, FIELDS, TYPE, FIELDINIT, FIELDTEST) testit##NAME (n);\n+\n+  for (n = 0; n < 16; ++n)\n+    {\n+#include \"struct-by-value-22_x.c\"\n+      DEBUG_NL;\n+    }\n+  for (; n < 110; n += 13)\n+    {\n+#include \"struct-by-value-22_x.c\"\n+      DEBUG_NL;\n+    }\n+\n+DEBUG_FINI\n+\n+if (fails != 0)\n+  abort ();\n+}\n+\n+#else\n+\n+#define S(NAME, FIELDS, FIELDINIT, FIELDTEST)\t\t\t\t\\\n+  T(c##NAME, FIELDS, char, FIELDINIT, FIELDTEST)\t\t\t\\\n+  T(s##NAME, FIELDS, short, FIELDINIT, FIELDTEST)\t\t\t\\\n+  T(u##NAME, FIELDS, unsigned, FIELDINIT, FIELDTEST)\t\t\t\\\n+  T(d##NAME, FIELDS, double, FIELDINIT, FIELDTEST)\n+S(E, , do {} while (0), DEBUG_DOT)\n+S(n, int n;, s.n = n, if (s.n != n) DEBUG_CHECK)\n+#define U(TYPE)\t\t\t\t\t\t\t\t\\\n+S(TYPE, TYPE s;, init##TYPE (&s.s, n), check##TYPE (s.s, n))\n+U(Scd)\n+U(Scdc)\n+U(Sd)\n+U(Sdi)\n+U(Scsds)\n+U(Scsdsc)\n+U(Scsdis)\n+U(Scsdisc)\n+U(Ssds)\n+U(Ssdsc)\n+U(Scssdss)\n+U(Scssdssc)\n+U(Sfi)\n+U(Sfii)\n+U(Sfifi)\n+U(Sfiifii)\n+#undef S\n+#undef U\n+\n+#endif"}, {"sha": "079e40e5f897a920bd37e5c1074f4cd7e383b215", "filename": "gcc/testsuite/gcc.dg/compat/struct-by-value-22_y.c", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_y.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0984ba100b02d848788de3e60f0800f076704288/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_y.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcompat%2Fstruct-by-value-22_y.c?ref=0984ba100b02d848788de3e60f0800f076704288", "patch": "@@ -0,0 +1,39 @@\n+#include <stdarg.h>\n+#include \"compat-common.h\"\n+#include \"mixed-struct-defs.h\"\n+#include \"mixed-struct-check.h\"\n+\n+#ifdef SKIP_VA\n+const int test_va = 0;\n+#else\n+const int test_va = 1;\n+#endif\n+\n+#define T(NAME, FIELDS, TYPE, FIELDINIT, FIELDTEST)\t\t\t\\\n+void\t\t\t\t\t\t\t\t\t\\\n+testva##NAME (int n, ...)\t\t\t\t\t\t\\\n+{\t\t\t\t\t\t\t\t\t\\\n+  va_list ap;\t\t\t\t\t\t\t\t\\\n+  if (test_va)\t\t\t\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\t\\\n+      struct S { FIELDS TYPE a[n]; } s;\t\t\t\t\t\\\n+      int fail = 0, i, j;\t\t\t\t\t\t\\\n+\t\t\t\t\t\t\t\t\t\\\n+      va_start (ap, n);\t\t\t\t\t\t\t\\\n+      for (j = 0; j < 2; ++j)\t\t\t\t\t\t\\\n+        {\t\t\t\t\t\t\t\t\\\n+\t  s = va_arg (ap, struct S);\t\t\t\t\t\\\n+\t  for (i = 0; i < n; ++i)\t\t\t\t\t\\\n+\t    if (s.a[i] != 12 + n - i)\t\t\t\t\t\\\n+\t      ++fail;\t\t\t\t\t\t\t\\\n+\t  if (fail)\t\t\t\t\t\t\t\\\n+\t    { DEBUG_FAIL; }\t\t\t\t\t\t\\\n+\t  if (!j && va_arg (ap, int) != n)\t\t\t\t\\\n+\t    { DEBUG_FAIL; }\t\t\t\t\t\t\\\n+\t  FIELDTEST;\t\t\t\t\t\t\t\\\n+\t}\t\t\t\t\t\t\t\t\\\n+      va_end (ap);\t\t\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\t\t\t\\\n+}\n+\n+#include \"struct-by-value-22_x.c\""}]}