{"sha": "e85b4fa7b56003e26a98c54247d79365b740bb6d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTg1YjRmYTdiNTYwMDNlMjZhOThjNTQyNDdkNzkzNjViNzQwYmI2ZA==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2007-10-28T16:03:06Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2007-10-28T16:03:06Z"}, "message": "stl_uninitialized.h (uninitialized_copy): Use ::new and value_type per the letter of the standard.\n\n2007-10-28  Paolo Carlini  <pcarlini@suse.de>\n\n\t* include/bits/stl_uninitialized.h (uninitialized_copy): Use\n\t::new and value_type per the letter of the standard.\n\t* testsuite/20_util/specialized_algorithms/uninitialized_copy/\n\tmove_iterators/1.cc: New.\n\n\t* testsuite/20_util/specialized_algorithms/16505.cc: Move to...\n\t* testsuite/20_util/specialized_algorithms/uninitialized_fill_n/\n\t16505.cc: ... here.\n\t* testsuite/20_util/specialized_algorithms/32158.cc: Move to...\n\t* testsuite/20_util/specialized_algorithms/uninitialized_fill/\n\t32158.cc: ... here.\n\n\t* include/bits/stl_construct.h (_Construct(_T1*)): Remove, unused.\n\nFrom-SVN: r129698", "tree": {"sha": "69db8b00599e34a5b4a85a68a770c02be23d4e53", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/69db8b00599e34a5b4a85a68a770c02be23d4e53"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e85b4fa7b56003e26a98c54247d79365b740bb6d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e85b4fa7b56003e26a98c54247d79365b740bb6d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e85b4fa7b56003e26a98c54247d79365b740bb6d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e85b4fa7b56003e26a98c54247d79365b740bb6d/comments", "author": null, "committer": null, "parents": [{"sha": "77bd31de7ef25e0e7cce86d26d882815f9536d6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/77bd31de7ef25e0e7cce86d26d882815f9536d6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/77bd31de7ef25e0e7cce86d26d882815f9536d6b"}], "stats": {"total": 101, "additions": 85, "deletions": 16}, "files": [{"sha": "aa276488e2aa0ac82404fcf5b60d3e58ce2ac934", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=e85b4fa7b56003e26a98c54247d79365b740bb6d", "patch": "@@ -1,3 +1,19 @@\n+2007-10-28  Paolo Carlini  <pcarlini@suse.de>\n+\n+\t* include/bits/stl_uninitialized.h (uninitialized_copy): Use\n+\t::new and value_type per the letter of the standard.\n+\t* testsuite/20_util/specialized_algorithms/uninitialized_copy/\n+\tmove_iterators/1.cc: New.\n+\n+\t* testsuite/20_util/specialized_algorithms/16505.cc: Move to...\n+\t* testsuite/20_util/specialized_algorithms/uninitialized_fill_n/\n+\t16505.cc: ... here.\n+\t* testsuite/20_util/specialized_algorithms/32158.cc: Move to...\n+\t* testsuite/20_util/specialized_algorithms/uninitialized_fill/\n+\t32158.cc: ... here.\n+\n+\t* include/bits/stl_construct.h (_Construct(_T1*)): Remove, unused.\n+\n 2007-10-27  Paolo Carlini  <pcarlini@suse.de>\n \n \t* include/bits/stl_algobase.h (struct __miter_base): Add."}, {"sha": "460383424a6046319169d3048e893e7b94b9ff1b", "filename": "libstdc++-v3/include/bits/stl_construct.h", "status": "modified", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_construct.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_construct.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_construct.h?ref=e85b4fa7b56003e26a98c54247d79365b740bb6d", "patch": "@@ -81,21 +81,6 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n       ::new(static_cast<void*>(__p)) _T1(__value);\n     }\n \n-  /**\n-   * @if maint\n-   * Constructs an object in existing memory by invoking an allocated\n-   * object's default constructor (no initializers).\n-   * @endif\n-   */\n-  template<typename _T1>\n-    inline void\n-    _Construct(_T1* __p)\n-    {\n-      // _GLIBCXX_RESOLVE_LIB_DEFECTS\n-      // 402. wrong new expression in [some_]allocator::construct\n-      ::new(static_cast<void*>(__p)) _T1();\n-    }\n-\n   /**\n    * @if maint\n    * Destroy the object pointed to by a pointer type."}, {"sha": "d3e7a2c8c3f64663c9e0fa93dead05be95e0e510", "filename": "libstdc++-v3/include/bits/stl_uninitialized.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_uninitialized.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_uninitialized.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_uninitialized.h?ref=e85b4fa7b56003e26a98c54247d79365b740bb6d", "patch": "@@ -76,7 +76,8 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n \t  try\n \t    {\n \t      for (; __first != __last; ++__first, ++__cur)\n-\t\tstd::_Construct(&*__cur, *__first);\n+\t\t::new(static_cast<void*>(&*__cur)) typename\n+\t\t    iterator_traits<_ForwardIterator>::value_type(*__first);\n \t      return __cur;\n \t    }\n \t  catch(...)"}, {"sha": "11e07a76aeab9722b3d4a27e5075b3e17ae23836", "filename": "libstdc++-v3/testsuite/20_util/specialized_algorithms/uninitialized_copy/move_iterators/1.cc", "status": "added", "additions": 67, "deletions": 0, "changes": 67, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_copy%2Fmove_iterators%2F1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_copy%2Fmove_iterators%2F1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_copy%2Fmove_iterators%2F1.cc?ref=e85b4fa7b56003e26a98c54247d79365b740bb6d", "patch": "@@ -0,0 +1,67 @@\n+// { dg-options \"-std=gnu++0x\" }\n+\n+// Copyright (C) 2007 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 2, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without Pred the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING.  If not, write to the Free\n+// Software Foundation, 59 Temple Place - Suite 330, Boston, MA 02111-1307,\n+// USA.\n+\n+#undef _GLIBCXX_CONCEPT_CHECKS\n+#define  _GLIBCXX_TESTSUITE_ALLOW_RVALREF_ALIASING\n+\n+#include <algorithm>\n+#include <iterator>\n+#include <testsuite_hooks.h>\n+#include <testsuite_iterators.h>\n+#include <testsuite_rvalref.h>\n+\n+using __gnu_test::test_container;\n+using __gnu_test::input_iterator_wrapper;\n+using __gnu_test::forward_iterator_wrapper;\n+using __gnu_test::rvalstruct;\n+using std::uninitialized_copy;\n+\n+typedef test_container<rvalstruct, input_iterator_wrapper> container_in;\n+typedef test_container<rvalstruct, forward_iterator_wrapper> container_out;\n+\n+void test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  int inarray[] = { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 };\n+  const int size = sizeof(inarray) / sizeof(int);\n+\n+  rvalstruct in[size], out[size];\n+  std::copy(inarray, inarray + size, in);\n+\n+  container_in incon(in, in + size);\n+  container_out outcon(out, out + size);\n+\n+  uninitialized_copy(std::move_iterator<input_iterator_wrapper<rvalstruct> >(incon.begin()),\n+\t\t     std::move_iterator<input_iterator_wrapper<rvalstruct> >(incon.end()),\n+\t\t     outcon.begin());\n+  VERIFY( std::equal(out, out + size, inarray) );\n+  for (int z = 0; z < size; ++z)\n+    VERIFY( out[z].valid );\n+  for (int z = 0; z < size; ++z)\n+    VERIFY( !in[z].valid );\n+}\n+\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}, {"sha": "1f9867e01b2874ca7f7f5a05000208366e5f87b4", "filename": "libstdc++-v3/testsuite/20_util/specialized_algorithms/uninitialized_fill/32158.cc", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_fill%2F32158.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_fill%2F32158.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_fill%2F32158.cc?ref=e85b4fa7b56003e26a98c54247d79365b740bb6d", "previous_filename": "libstdc++-v3/testsuite/20_util/specialized_algorithms/32158.cc"}, {"sha": "b20c0496ee8aaafc5da97f91b6f7a8ad0177bb2e", "filename": "libstdc++-v3/testsuite/20_util/specialized_algorithms/uninitialized_fill_n/16505.cc", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_fill_n%2F16505.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e85b4fa7b56003e26a98c54247d79365b740bb6d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_fill_n%2F16505.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fspecialized_algorithms%2Funinitialized_fill_n%2F16505.cc?ref=e85b4fa7b56003e26a98c54247d79365b740bb6d", "previous_filename": "libstdc++-v3/testsuite/20_util/specialized_algorithms/16505.cc"}]}