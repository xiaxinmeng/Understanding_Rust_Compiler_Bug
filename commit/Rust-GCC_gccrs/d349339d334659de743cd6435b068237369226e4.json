{"sha": "d349339d334659de743cd6435b068237369226e4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDM0OTMzOWQzMzQ2NTlkZTc0M2NkNjQzNWIwNjgyMzczNjkyMjZlNA==", "commit": {"author": {"name": "Fariborz Jahanian", "email": "fjahanian@apple.com", "date": "2006-03-02T17:45:30Z"}, "committer": {"name": "Fariborz Jahanian", "email": "fjahanian@gcc.gnu.org", "date": "2006-03-02T17:45:30Z"}, "message": "Fixed a couple of objctective-c bugs.\n\nOked by Mike Stump.\n\nFrom-SVN: r111642", "tree": {"sha": "7b41557e4343556c0a977c36d08811644aeff119", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7b41557e4343556c0a977c36d08811644aeff119"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d349339d334659de743cd6435b068237369226e4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d349339d334659de743cd6435b068237369226e4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d349339d334659de743cd6435b068237369226e4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d349339d334659de743cd6435b068237369226e4/comments", "author": null, "committer": null, "parents": [{"sha": "21a8ffa15869feadc72ea700ba33bee99554834d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21a8ffa15869feadc72ea700ba33bee99554834d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21a8ffa15869feadc72ea700ba33bee99554834d"}], "stats": {"total": 72, "additions": 69, "deletions": 3}, "files": [{"sha": "67ccd3be55e3ffc6f30dce9b9bcc73954240f25a", "filename": "gcc/objc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d349339d334659de743cd6435b068237369226e4/gcc%2Fobjc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d349339d334659de743cd6435b068237369226e4/gcc%2Fobjc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2FChangeLog?ref=d349339d334659de743cd6435b068237369226e4", "patch": "@@ -1,3 +1,9 @@\n+2006-03-02 Fariborz Jahanian <fjahanian@apple.com>\n+\n+\t* objc-act.c (init_module_descriptor): Remove file name from\n+\tmodule descriptor.\n+\t(gen_type_name_0): Fix ICE when issuing warning.\n+\n 2006-02-20 Rafael \ufffdvila de Esp\ufffdndola <rafael.espindola@gmail.com>\n \t* Make-lang.in (OBJC): Remove\n \t(OBJECTIVE-C): Remove"}, {"sha": "a90c0614b5e8cec53484c350a6f0b1d6a8caaee5", "filename": "gcc/objc/objc-act.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d349339d334659de743cd6435b068237369226e4/gcc%2Fobjc%2Fobjc-act.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d349339d334659de743cd6435b068237369226e4/gcc%2Fobjc%2Fobjc-act.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2Fobjc-act.c?ref=d349339d334659de743cd6435b068237369226e4", "patch": "@@ -2254,9 +2254,10 @@ init_module_descriptor (tree type)\n \t\t  size_in_bytes (objc_module_template));\n   initlist = tree_cons (NULL_TREE, expr, initlist);\n \n-  /* name = { ..., \"foo.m\", ... } */\n+  /* Don't provide any file name for security reasons. */\n+  /* name = { ..., \"\", ... } */\n \n-  expr = add_objc_string (get_identifier (input_filename), class_names);\n+  expr = add_objc_string (get_identifier (\"\"), class_names);\n   initlist = tree_cons (NULL_TREE, expr, initlist);\n \n   /* symtab = { ..., _OBJC_SYMBOLS, ... } */\n@@ -8883,7 +8884,9 @@ gen_type_name_0 (tree type)\n   if (TREE_CODE (type) == TYPE_DECL && DECL_NAME (type))\n     type = DECL_NAME (type);\n \n-  strcat (errbuf, IDENTIFIER_POINTER (type));\n+  strcat (errbuf, TREE_CODE (type) == IDENTIFIER_NODE\n+\t  \t  ? IDENTIFIER_POINTER (type)\n+\t\t  : \"\");\n \n   /* For 'id' and 'Class', adopted protocols are stored in the pointee.  */\n   if (objc_is_id (orig))"}, {"sha": "e94df364083e6246f75f267ec358b47f51efeab6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d349339d334659de743cd6435b068237369226e4", "patch": "@@ -1,3 +1,9 @@\n+2006-03-02  Fariborz Jahanian <fjahanian@apple.com>\n+\n+\t* objc.dg/objc-nofilename-1.m: New test.\n+\t* objc.dg/bad-receiver-type.m: New test.\n+\t* obj-c++.dg/bad-receiver-type.mm: New test.\n+\n 2006-03-02  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \t* gcc.dg/single-precision-constant.c: Tweak for non-C99 runtimes."}, {"sha": "1d6699f99c5846a1a6d60bd9b5edd2fc3b7d93c0", "filename": "gcc/testsuite/obj-c++.dg/bad-receiver-type.mm", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fbad-receiver-type.mm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fbad-receiver-type.mm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fbad-receiver-type.mm?ref=d349339d334659de743cd6435b068237369226e4", "patch": "@@ -0,0 +1,15 @@\n+// { dg-do compile } \n+// { dg-options \"\" }\n+\n+@interface A\n+\n+- (void)test; \n+\n+@end\n+\n+extern int foo();\n+\n+void baz()\n+{\n+    [foo test];\t/* { dg-warning \"invalid receiver type\" } */\n+}"}, {"sha": "58a5bb89cc1328f111c52bebc0acdcdb89a5c76c", "filename": "gcc/testsuite/objc.dg/bad-receiver-type.m", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2Fobjc.dg%2Fbad-receiver-type.m", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2Fobjc.dg%2Fbad-receiver-type.m", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fobjc.dg%2Fbad-receiver-type.m?ref=d349339d334659de743cd6435b068237369226e4", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile } */\n+\n+@interface A\n+\n+- (void)test; \n+\n+@end\n+\n+extern int foo();\n+\n+void baz()\n+{\n+    [foo test];\t/* { dg-warning \"invalid receiver type\" } */ \n+\t\t/* { dg-warning \"cannot convert to a pointer type\" \"\" { target *-*-* } 13} */\n+}"}, {"sha": "0bd49ff6d7fd7c957c158aba494a419765e4da2b", "filename": "gcc/testsuite/objc.dg/objc-nofilename-1.m", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2Fobjc.dg%2Fobjc-nofilename-1.m", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d349339d334659de743cd6435b068237369226e4/gcc%2Ftestsuite%2Fobjc.dg%2Fobjc-nofilename-1.m", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fobjc.dg%2Fobjc-nofilename-1.m?ref=d349339d334659de743cd6435b068237369226e4", "patch": "@@ -0,0 +1,21 @@\n+/* Test to make sure that file name does not appear in the binary. */\n+/* { dg-do compile } */\n+#include <objc/objc.h>\n+\n+@interface Foo { Class isa; } @end\n+@implementation Foo @end\n+\n+@interface Bar : Foo { Class Barisa; } @end\n+\n+@implementation Bar : Foo @end;\n+\n+@interface FINAL : Bar { Class FINALisa; } @end\n+\n+@implementation FINAL : Bar @end;\n+\n+int main(int argc, char **argv)\n+{\n+     return 0;\n+}\n+\n+/* { dg-final { scan-assembler-not \"objc-nofilename-1.m\" } } */"}]}