{"sha": "a7e94dc09a4470fde623197382e8dea4553e2d6b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTdlOTRkYzA5YTQ0NzBmZGU2MjMxOTczODJlOGRlYTQ1NTNlMmQ2Yg==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@linux.ibm.com", "date": "2018-08-20T23:46:37Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "2018-08-20T23:46:37Z"}, "message": "re PR target/87033 (The compiler does not generate the LWAX instruction)\n\n[gcc]\n2018-08-20  Michael Meissner  <meissner@linux.ibm.com>\n\n\tPR target/87033\n\t* config/rs6000/rs6000.md (extendsi<mode>2): Change constraints\n\tfrom 'Y' to 'YZ' to enable the LWAX instruction to be generated\n\tfor indexed loads.\n\n[gcc/testsuite]\n2018-08-20  Michael Meissner  <meissner@linux.ibm.com>\n\n\tPR target/87033\n\t* gcc.target/powerpc/pr87033.c: New test.\n\nFrom-SVN: r263678", "tree": {"sha": "7f70c04abface4896f049270e05a115098eb2556", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7f70c04abface4896f049270e05a115098eb2556"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7e94dc09a4470fde623197382e8dea4553e2d6b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7e94dc09a4470fde623197382e8dea4553e2d6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7e94dc09a4470fde623197382e8dea4553e2d6b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7e94dc09a4470fde623197382e8dea4553e2d6b/comments", "author": null, "committer": null, "parents": [{"sha": "fe7a679e8c4ce1a50afad508e094377bab365ea4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe7a679e8c4ce1a50afad508e094377bab365ea4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe7a679e8c4ce1a50afad508e094377bab365ea4"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "cb9f5528e4b6db85722b2626611150ac3977ed9f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a7e94dc09a4470fde623197382e8dea4553e2d6b", "patch": "@@ -1,3 +1,10 @@\n+2018-08-20  Michael Meissner  <meissner@linux.ibm.com>\n+\n+\tPR target/87033\n+\t* config/rs6000/rs6000.md (extendsi<mode>2): Change constraints\n+\tfrom 'Y' to 'YZ' to enable the LWAX instruction to be generated\n+\tfor indexed loads.\n+\n 2018-08-20  Nathan Sidwell  <nathan@acm.org>\n \t    Jeff Law <law@redhat.com>\n "}, {"sha": "49e209072a61798aba034dab9cbb351809950a45", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=a7e94dc09a4470fde623197382e8dea4553e2d6b", "patch": "@@ -988,7 +988,7 @@\n \t\t     \"=r, r,   wl,    wu,    wj,    wK,     wH,    wr\")\n \n \t(sign_extend:EXTSI (match_operand:SI 1 \"lwa_operand\"\n-\t\t     \"Y,  r,   Z,     Z,     r,     wK,     wH,    ?wIwH\")))]\n+\t\t     \"YZ, r,   Z,     Z,     r,     wK,     wH,    ?wIwH\")))]\n   \"\"\n   \"@\n    lwa%U1%X1 %0,%1"}, {"sha": "af8615607fbebdc0f69605d37677380e36740835", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a7e94dc09a4470fde623197382e8dea4553e2d6b", "patch": "@@ -1,3 +1,8 @@\n+2018-08-20  Michael Meissner  <meissner@linux.ibm.com>\n+\n+\tPR target/87033\n+\t* gcc.target/powerpc/pr87033.c: New test.\n+\n 2018-08-20  Martin Sebor  <msebor@redhat.com>\n \n \tPR tree-optimization/87034"}, {"sha": "9d62ce73d321d0e69dbba3040b6e0460dbe5a7e0", "filename": "gcc/testsuite/gcc.target/powerpc/pr87033.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87033.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7e94dc09a4470fde623197382e8dea4553e2d6b/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87033.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87033.c?ref=a7e94dc09a4470fde623197382e8dea4553e2d6b", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile { target { powerpc*-*-* && lp64 } } } */\n+/* { dg-options \"-O2\" } */\n+\n+/* Insure that a LWAX is generated instead of ADD + LWA.  LP64 is needed\n+   because the LWA and LWAX instructions are only available in 64-bit mode.  */\n+long func (int *p, unsigned long n)\n+{\n+  return p[n];\n+}\n+\n+/* { dg-final { scan-assembler     {\\mlwax\\M} } } */\n+/* { dg-final { scan-assembler-not {\\mlwa\\M}  } } */"}]}