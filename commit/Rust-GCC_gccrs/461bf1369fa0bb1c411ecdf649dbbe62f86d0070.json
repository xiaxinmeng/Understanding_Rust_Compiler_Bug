{"sha": "461bf1369fa0bb1c411ecdf649dbbe62f86d0070", "node_id": "C_kwDOANBUbNoAKDQ2MWJmMTM2OWZhMGJiMWM0MTFlY2RmNjQ5ZGJiZTYyZjg2ZDAwNzA", "commit": {"author": {"name": "liushuyu", "email": "liushuyu011@gmail.com", "date": "2022-04-22T22:34:20Z"}, "committer": {"name": "liushuyu", "email": "liushuyu011@gmail.com", "date": "2022-04-25T22:08:24Z"}, "message": "CI: catch malformed test cases\n\nSigned-off-by: Zixing Liu <liushuyu011@gmail.com>", "tree": {"sha": "4b64331b2a827658d1c487a60b21f36caea5672f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b64331b2a827658d1c487a60b21f36caea5672f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/461bf1369fa0bb1c411ecdf649dbbe62f86d0070", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE6x/rcKrl3aOwzUVJI9HORTRBlDcFAmJnG98ACgkQI9HORTRB\nlDetTg/9GDQp3GTR71Lraw/rDTqOCo3hyj/Xse/d5DJHAQDDMVl9nf0IqwKPL8Rc\nyzTXxnCvglWkI7ymcp4RI5XsQXmosAOpqO6xyObCBSUQGQFDNI1Xjs5foDxP5PEH\nHHBcn8Uf2wp24iPfS3TaITmNwqV20HTWoCtR204DAMZJ7/FDsz87tDWSJYO42n8X\nXf7RH/IX7NXTl6/11VX5Zj8dxuTecVnX9mGCKHA8GZRh0TW2u1wIikzO00uNHjRb\n3JcMwNf1KryXJ4A+Tz98UbFsfmfOH2cusUmc576aAoFv7gGkB/s069/4HOxDQ9of\nqa0VaAhoN4VADfzzoIai8XaebuSTMk1NLlHQTsRatrISK3dFNsEQzwNXkGadbJam\nwepOf90O8xF8p4dMO+Q0xBgi6EK/5UExYHDuO/mVv/RUq5lsvm2VQeEyMdW+GwQp\n8F41IBNb5wcuM49nkluf88ekYzUI2dc9x72fLDw3sGLaslbWrvP38WrdyLibxTIe\nzSHMfQBykpcNdwGkMIvdO+gGMIA7XY69ZWF4dZy2eskDrKNC1WSYaXM3hFMOBssX\n5RBuei813EbQxmmAtCz3n5c3oWBg/6JHSdZVXbsUpX8Mv9HpBf3k7ChcqN1FVn9B\n0qfTNSt2WxZUWzw3uXE7v3r0BPfKuKdDP6ldiE+yJA8kN+UZncA=\n=xfmu\n-----END PGP SIGNATURE-----", "payload": "tree 4b64331b2a827658d1c487a60b21f36caea5672f\nparent b74044fb6278e373da607a8f1f5df2193ce27d65\nauthor liushuyu <liushuyu011@gmail.com> 1650666860 -0600\ncommitter liushuyu <liushuyu011@gmail.com> 1650924504 -0600\n\nCI: catch malformed test cases\n\nSigned-off-by: Zixing Liu <liushuyu011@gmail.com>\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/461bf1369fa0bb1c411ecdf649dbbe62f86d0070", "html_url": "https://github.com/Rust-GCC/gccrs/commit/461bf1369fa0bb1c411ecdf649dbbe62f86d0070", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/461bf1369fa0bb1c411ecdf649dbbe62f86d0070/comments", "author": {"login": "liushuyu", "id": 6829345, "node_id": "MDQ6VXNlcjY4MjkzNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/6829345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liushuyu", "html_url": "https://github.com/liushuyu", "followers_url": "https://api.github.com/users/liushuyu/followers", "following_url": "https://api.github.com/users/liushuyu/following{/other_user}", "gists_url": "https://api.github.com/users/liushuyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/liushuyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liushuyu/subscriptions", "organizations_url": "https://api.github.com/users/liushuyu/orgs", "repos_url": "https://api.github.com/users/liushuyu/repos", "events_url": "https://api.github.com/users/liushuyu/events{/privacy}", "received_events_url": "https://api.github.com/users/liushuyu/received_events", "type": "User", "site_admin": false}, "committer": {"login": "liushuyu", "id": 6829345, "node_id": "MDQ6VXNlcjY4MjkzNDU=", "avatar_url": "https://avatars.githubusercontent.com/u/6829345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/liushuyu", "html_url": "https://github.com/liushuyu", "followers_url": "https://api.github.com/users/liushuyu/followers", "following_url": "https://api.github.com/users/liushuyu/following{/other_user}", "gists_url": "https://api.github.com/users/liushuyu/gists{/gist_id}", "starred_url": "https://api.github.com/users/liushuyu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/liushuyu/subscriptions", "organizations_url": "https://api.github.com/users/liushuyu/orgs", "repos_url": "https://api.github.com/users/liushuyu/repos", "events_url": "https://api.github.com/users/liushuyu/events{/privacy}", "received_events_url": "https://api.github.com/users/liushuyu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b74044fb6278e373da607a8f1f5df2193ce27d65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b74044fb6278e373da607a8f1f5df2193ce27d65", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b74044fb6278e373da607a8f1f5df2193ce27d65"}], "stats": {"total": 38, "additions": 32, "deletions": 6}, "files": [{"sha": "cf8c3ad8042e049f40b2f8d600f81ecc9726af14", "filename": ".github/emit_test_errors.pl", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/461bf1369fa0bb1c411ecdf649dbbe62f86d0070/.github%2Femit_test_errors.pl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/461bf1369fa0bb1c411ecdf649dbbe62f86d0070/.github%2Femit_test_errors.pl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/.github%2Femit_test_errors.pl?ref=461bf1369fa0bb1c411ecdf649dbbe62f86d0070", "patch": "@@ -0,0 +1,25 @@\n+#!/bin/perl -n\n+\n+sub analyze_errors() {\n+    /^(FAIL|ERROR|XPASS):\\s([^:\\s]+):?\\s+(.+)/;\n+\n+    my $type     = $1;\n+    my $filename = $2;\n+    my $message  = $3;\n+    my $line;\n+\n+    if ( !$type ) { return; }\n+\n+    if ( $message =~ /(at line (\\d+))?.+(test for \\w+, line (\\d+))/g ) {\n+        $line = $2 || $4;\n+    }\n+\n+    my $command = \"::error file=gcc/testsuite/$filename\";\n+    if ($line) {\n+        $command = \"$command,line=$line\";\n+    }\n+\n+    print \"$command,title=Test failure ($type)::$message\\n\";\n+}\n+\n+analyze_errors();"}, {"sha": "6fdfd9748b8e76f56abeb246de30a3cc9390f997", "filename": ".github/workflows/ccpp.yml", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/461bf1369fa0bb1c411ecdf649dbbe62f86d0070/.github%2Fworkflows%2Fccpp.yml", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/461bf1369fa0bb1c411ecdf649dbbe62f86d0070/.github%2Fworkflows%2Fccpp.yml", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/.github%2Fworkflows%2Fccpp.yml?ref=461bf1369fa0bb1c411ecdf649dbbe62f86d0070", "patch": "@@ -77,9 +77,10 @@ jobs:\n     - name: Check regressions\n       run: |\n            cd gccrs-build; \\\n-           if grep -e \"unexpected\" -e \"unresolved\" gcc/testsuite/rust/rust.sum;\\\n+           if grep -e \"unexpected\" -e \"unresolved\" -e \"ERROR:\" gcc/testsuite/rust/rust.sum;\\\n            then \\\n-              echo \"some tests are not correct\"; \\\n+              echo \"::error title=Regression test failed::some tests are not correct\"; \\\n+              perl -n ../.github/emit_test_errors.pl < gcc/testsuite/rust/rust.sum; \\\n               exit 1; \\\n             else \\\n               exit 0; \\\n@@ -142,9 +143,9 @@ jobs:\n     - name: Check regressions\n       run: |\n            cd gccrs-build; \\\n-           if grep -e \"unexpected\" -e \"unresolved\" gcc/testsuite/rust/rust.sum;\\\n+           if grep -e \"unexpected\" -e \"unresolved\" -e \"ERROR:\" gcc/testsuite/rust/rust.sum;\\\n            then \\\n-              echo \"some tests are not correct\"; \\\n+              echo \"::error title=Regression test failed::some tests are not correct\"; \\\n               exit 1; \\\n             else \\\n               exit 0; \\\n@@ -196,9 +197,9 @@ jobs:\n     - name: Check regressions\n       run: |\n            cd gccrs-build; \\\n-           if grep -e \"unexpected\" -e \"unresolved\" gcc/testsuite/rust/rust.sum;\\\n+           if grep -e \"unexpected\" -e \"unresolved\" -e \"ERROR:\" gcc/testsuite/rust/rust.sum;\\\n            then \\\n-              echo \"some tests are not correct\"; \\\n+              echo \"::error title=Regression test failed::some tests are not correct\"; \\\n               exit 1; \\\n             else \\\n               exit 0; \\"}]}