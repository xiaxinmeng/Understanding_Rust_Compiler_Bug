{"sha": "678e7c65045fdf63464adaa74de3a43e03c76ef5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Njc4ZTdjNjUwNDVmZGY2MzQ2NGFkYWE3NGRlM2E0M2UwM2M3NmVmNQ==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2008-08-01T14:42:42Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2008-08-01T14:42:42Z"}, "message": "tree-ssa-pre.c (fini_pre): Take in_fre parameter.\n\n2008-08-01  Richard Guenther  <rguenther@suse.de>\n\n\t* tree-ssa-pre.c (fini_pre): Take in_fre parameter.  Free\n\tloop information only if we initialized it.\n\t(execute_pre): Call fini_pre with in_fre.\n\t* tree-ssa-loop-ivcanon (try_unroll_loop_completely): Dump\n\tif we do not unroll because we hit max-completely-peeled-insns.\n\tUse our estimation for consistency, do allow shrinking.\n\nFrom-SVN: r138522", "tree": {"sha": "a943f2f3ae810f1ce3d69eb444965504fc297e63", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a943f2f3ae810f1ce3d69eb444965504fc297e63"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/678e7c65045fdf63464adaa74de3a43e03c76ef5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/678e7c65045fdf63464adaa74de3a43e03c76ef5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/678e7c65045fdf63464adaa74de3a43e03c76ef5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/678e7c65045fdf63464adaa74de3a43e03c76ef5/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "769b26a6bd8c203097c0f79ecca9956e2c02ac69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/769b26a6bd8c203097c0f79ecca9956e2c02ac69", "html_url": "https://github.com/Rust-GCC/gccrs/commit/769b26a6bd8c203097c0f79ecca9956e2c02ac69"}], "stats": {"total": 30, "additions": 23, "deletions": 7}, "files": [{"sha": "7b8f8bd66512832b3b7c8308dbe7dd73e50a6f83", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/678e7c65045fdf63464adaa74de3a43e03c76ef5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/678e7c65045fdf63464adaa74de3a43e03c76ef5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=678e7c65045fdf63464adaa74de3a43e03c76ef5", "patch": "@@ -1,3 +1,12 @@\n+2008-08-01  Richard Guenther  <rguenther@suse.de>\n+\n+\t* tree-ssa-pre.c (fini_pre): Take in_fre parameter.  Free\n+\tloop information only if we initialized it.\n+\t(execute_pre): Call fini_pre with in_fre.\n+\t* tree-ssa-loop-ivcanon (try_unroll_loop_completely): Dump\n+\tif we do not unroll because we hit max-completely-peeled-insns.\n+\tUse our estimation for consistency, do allow shrinking.\n+\n 2008-08-01  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/36997"}, {"sha": "0096546534291fed580cf413a1b12dd9aa97af01", "filename": "gcc/tree-ssa-loop-ivcanon.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/678e7c65045fdf63464adaa74de3a43e03c76ef5/gcc%2Ftree-ssa-loop-ivcanon.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/678e7c65045fdf63464adaa74de3a43e03c76ef5/gcc%2Ftree-ssa-loop-ivcanon.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivcanon.c?ref=678e7c65045fdf63464adaa74de3a43e03c76ef5", "patch": "@@ -184,10 +184,6 @@ try_unroll_loop_completely (struct loop *loop,\n \n       ninsns = tree_num_loop_insns (loop, &eni_size_weights);\n \n-      if (n_unroll * ninsns\n-\t  > (unsigned) PARAM_VALUE (PARAM_MAX_COMPLETELY_PEELED_INSNS))\n-\treturn false;\n-\n       unr_insns = estimated_unrolled_size (ninsns, n_unroll);\n       if (dump_file && (dump_flags & TDF_DETAILS))\n \t{\n@@ -196,6 +192,17 @@ try_unroll_loop_completely (struct loop *loop,\n \t\t   (int) unr_insns);\n \t}\n \n+      if (unr_insns > ninsns\n+\t  && (unr_insns\n+\t      > (unsigned) PARAM_VALUE (PARAM_MAX_COMPLETELY_PEELED_INSNS)))\n+\t{\n+\t  if (dump_file && (dump_flags & TDF_DETAILS))\n+\t    fprintf (dump_file, \"Not unrolling loop %d \"\n+\t\t     \"(--param max-completely-peeled-insns limit reached).\\n\",\n+\t\t     loop->num);\n+\t  return false;\n+\t}\n+\n       if (ul == UL_NO_GROWTH\n \t  && unr_insns > ninsns)\n \t{"}, {"sha": "336c54ec7004cd68006ed70f85bbefdd1b5f9ef0", "filename": "gcc/tree-ssa-pre.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/678e7c65045fdf63464adaa74de3a43e03c76ef5/gcc%2Ftree-ssa-pre.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/678e7c65045fdf63464adaa74de3a43e03c76ef5/gcc%2Ftree-ssa-pre.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-pre.c?ref=678e7c65045fdf63464adaa74de3a43e03c76ef5", "patch": "@@ -4086,7 +4086,7 @@ init_pre (bool do_fre)\n /* Deallocate data structures used by PRE.  */\n \n static void\n-fini_pre (void)\n+fini_pre (bool do_fre)\n {\n   basic_block bb;\n \n@@ -4117,7 +4117,7 @@ fini_pre (void)\n \n   BITMAP_FREE (need_eh_cleanup);\n \n-  if (current_loops != NULL)\n+  if (!do_fre)\n     loop_optimizer_finalize ();\n }\n \n@@ -4192,7 +4192,7 @@ execute_pre (bool do_fre ATTRIBUTE_UNUSED)\n   if (!do_fre)\n     remove_dead_inserted_code ();\n \n-  fini_pre ();\n+  fini_pre (do_fre);\n \n   return todo;\n }"}]}