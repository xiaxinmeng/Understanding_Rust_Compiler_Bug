{"sha": "ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWY4YTNkOWVmMGFjZTU0NzlkNDJmN2E1MzgyMzkzYjVhMWE3OWQ5Ng==", "commit": {"author": {"name": "Doug Rupp", "email": "rupp@adacore.com", "date": "2019-07-10T09:01:17Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-10T09:01:17Z"}, "message": "[Ada] Vxworks7r2 SR0610 coalesced some macro values\n\nSR0600 and SR0610 cannot be differentiated by macro testing (arguably an\noversight in header file version.h) so: The case statement testing for\n\"file not found\" is reformulated into an if/else series of statements to\navoid a problem where two cases have identical values in SR0610, but\ndifferent values in SR0600.\n\n2019-07-10  Doug Rupp  <rupp@adacore.com>\n\ngcc/ada/\n\n\t* sysdep.c (__gnat_is_file_not_found_error): Reformulate to also\n\twork for vxworks7r2 SR0610.\n\nFrom-SVN: r273333", "tree": {"sha": "99c069795e020880662bb48894cb6ccbe5cea01d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/99c069795e020880662bb48894cb6ccbe5cea01d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96/comments", "author": {"login": "Cementitious", "id": 115579865, "node_id": "U_kgDOBuOb2Q", "avatar_url": "https://avatars.githubusercontent.com/u/115579865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Cementitious", "html_url": "https://github.com/Cementitious", "followers_url": "https://api.github.com/users/Cementitious/followers", "following_url": "https://api.github.com/users/Cementitious/following{/other_user}", "gists_url": "https://api.github.com/users/Cementitious/gists{/gist_id}", "starred_url": "https://api.github.com/users/Cementitious/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Cementitious/subscriptions", "organizations_url": "https://api.github.com/users/Cementitious/orgs", "repos_url": "https://api.github.com/users/Cementitious/repos", "events_url": "https://api.github.com/users/Cementitious/events{/privacy}", "received_events_url": "https://api.github.com/users/Cementitious/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "32e0627f99f4212695ec13b6d50ca48d1c29ded3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32e0627f99f4212695ec13b6d50ca48d1c29ded3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32e0627f99f4212695ec13b6d50ca48d1c29ded3"}], "stats": {"total": 43, "additions": 26, "deletions": 17}, "files": [{"sha": "2c069ab125d5a16c8b5f6de7afba18d0828f056a", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96", "patch": "@@ -1,3 +1,8 @@\n+2019-07-10  Doug Rupp  <rupp@adacore.com>\n+\n+\t* sysdep.c (__gnat_is_file_not_found_error): Reformulate to also\n+\twork for vxworks7r2 SR0610.\n+\n 2019-07-10  Doug Rupp  <rupp@adacore.com>\n \n \t* env.c (__gnat_environ): Reformulate to also work for"}, {"sha": "a5f325d90f334f20eb02217899c9eb3f8144e465", "filename": "gcc/ada/sysdep.c", "status": "modified", "additions": 21, "deletions": 17, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96/gcc%2Fada%2Fsysdep.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96/gcc%2Fada%2Fsysdep.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsysdep.c?ref=ef8a3d9ef0ace5479d42f7a5382393b5a1a79d96", "patch": "@@ -300,7 +300,7 @@ __gnat_set_mode (int handle ATTRIBUTE_UNUSED, int mode ATTRIBUTE_UNUSED)\n }\n \n char *\n-__gnat_ttyname (int filedes)\n+__gnat_ttyname (int filedes ATTRIBUTE_UNUSED)\n {\n #if defined (__vxworks)\n   return \"\";\n@@ -896,30 +896,34 @@ __gnat_get_task_options (void)\n #endif\n \n int\n-__gnat_is_file_not_found_error (int errno_val) {\n-   switch (errno_val) {\n-      case ENOENT:\n+__gnat_is_file_not_found_error (int errno_val)\n+ {\n+    /* WARNING: Do not rewrite this as a switch/case statement.\n+     * Some of the \"cases\" are duplicated in some versions of\n+     * Vxworks, notably VxWorks7r2 SR0610.  */\n+    if (errno_val == ENOENT)\n+      return 1;\n #ifdef __vxworks\n-      /* In the case of VxWorks, we also have to take into account various\n-       * filesystem-specific variants of this error.\n-       */\n+    /* In the case of VxWorks, we also have to take into account various\n+     * filesystem-specific variants of this error.\n+     */\n #if ! defined (VTHREADS) && (_WRS_VXWORKS_MAJOR < 7)\n-      case S_dosFsLib_FILE_NOT_FOUND:\n+    else if (errno_val == S_dosFsLib_FILE_NOT_FOUND)\n+      return 1;\n #endif\n #if ! defined (__RTP__) && (! defined (VTHREADS) || defined (__VXWORKSMILS__))\n-      case S_nfsLib_NFSERR_NOENT:\n+    else if (errno_val ==  S_nfsLib_NFSERR_NOENT)\n+      return 1;\n #endif\n #if defined (__RTP__)\n-\t/* An RTP can return an NFS file not found, and the NFS bits must\n-\t   first be masked on to check the errno.  */\n-      case M_nfsStat | ENOENT:\n+    /* An RTP can return an NFS file not found, and the NFS bits must\n+       first be masked on to check the errno.  */\n+    else if (errno_val == (M_nfsStat | ENOENT))\n+      return 1;\n #endif\n #endif\n-         return 1;\n-\n-      default:\n-        return 0;\n-   }\n+    else\n+      return 0;\n }\n \n #if defined (__linux__)"}]}