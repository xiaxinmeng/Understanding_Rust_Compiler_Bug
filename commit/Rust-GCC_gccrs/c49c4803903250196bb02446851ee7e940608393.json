{"sha": "c49c4803903250196bb02446851ee7e940608393", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzQ5YzQ4MDM5MDMyNTAxOTZiYjAyNDQ2ODUxZWU3ZTk0MDYwODM5Mw==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "1993-04-09T19:12:20Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "1993-04-09T19:12:20Z"}, "message": "Don't put #ifndefs in limits.h if they are already there\n\nFrom-SVN: r4053", "tree": {"sha": "529717ea347645387e415e01d18f499591fcf48e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/529717ea347645387e415e01d18f499591fcf48e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c49c4803903250196bb02446851ee7e940608393", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c49c4803903250196bb02446851ee7e940608393", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c49c4803903250196bb02446851ee7e940608393", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c49c4803903250196bb02446851ee7e940608393/comments", "author": null, "committer": null, "parents": [{"sha": "1717563d61f35d5fa87aea7aaccea1ef2864514f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1717563d61f35d5fa87aea7aaccea1ef2864514f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1717563d61f35d5fa87aea7aaccea1ef2864514f"}], "stats": {"total": 39, "additions": 24, "deletions": 15}, "files": [{"sha": "8de7a60b5428e7db6a2903bd4be25273359caacf", "filename": "gcc/fixincludes", "status": "modified", "additions": 24, "deletions": 15, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c49c4803903250196bb02446851ee7e940608393/gcc%2Ffixincludes", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c49c4803903250196bb02446851ee7e940608393/gcc%2Ffixincludes", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixincludes?ref=c49c4803903250196bb02446851ee7e940608393", "patch": "@@ -959,6 +959,11 @@ fi\n \n # In limits.h, put #ifndefs around things that are supposed to be defined\n # in float.h to avoid redefinition errors if float.h is included first.\n+# On HP/UX this patch does not work, because on HP/UX limits.h uses\n+# multi line comments and the inserted #endif winds up inside the\n+# comment.  Fortunately, HP/UX already uses #ifndefs in limits.h; if\n+# we find a #ifndef FLT_MIN we assume that all the required #ifndefs\n+# are there, and we do not add them ourselves.\n file=limits.h\n if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n   cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n@@ -967,33 +972,37 @@ if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n fi\n \n if [ -r ${LIB}/$file ]; then\n-  echo Fixing $file\n-  sed -e '/[ \t]FLT_MIN[ \t]/i\\\n+  if egrep 'ifndef[ \t]+FLT_MIN' ${LIB}/$file >/dev/null; then\n+    true\n+  else\n+    echo Fixing $file\n+    sed -e '/[ \t]FLT_MIN[ \t]/i\\\n #ifndef FLT_MIN'\\\n-      -e '/[ \t]FLT_MIN[ \t]/a\\\n+        -e '/[ \t]FLT_MIN[ \t]/a\\\n #endif'\\\n-      -e '/[ \t]FLT_MAX[ \t]/i\\\n+        -e '/[ \t]FLT_MAX[ \t]/i\\\n #ifndef FLT_MAX'\\\n-      -e '/[ \t]FLT_MAX[ \t]/a\\\n+        -e '/[ \t]FLT_MAX[ \t]/a\\\n #endif'\\\n-      -e '/[ \t]FLT_DIG[ \t]/i\\\n+        -e '/[ \t]FLT_DIG[ \t]/i\\\n #ifndef FLT_DIG'\\\n-      -e '/[ \t]FLT_DIG[ \t]/a\\\n+        -e '/[ \t]FLT_DIG[ \t]/a\\\n #endif'\\\n-      -e '/[ \t]DBL_MIN[ \t]/i\\\n+        -e '/[ \t]DBL_MIN[ \t]/i\\\n #ifndef DBL_MIN'\\\n-      -e '/[ \t]DBL_MIN[ \t]/a\\\n+        -e '/[ \t]DBL_MIN[ \t]/a\\\n #endif'\\\n-      -e '/[ \t]DBL_MAX[ \t]/i\\\n+        -e '/[ \t]DBL_MAX[ \t]/i\\\n #ifndef DBL_MAX'\\\n-      -e '/[ \t]DBL_MAX[ \t]/a\\\n+        -e '/[ \t]DBL_MAX[ \t]/a\\\n #endif'\\\n-      -e '/[ \t]DBL_DIG[ \t]/i\\\n+        -e '/[ \t]DBL_DIG[ \t]/i\\\n #ifndef DBL_DIG'\\\n-      -e '/[ \t]DBL_DIG[ \t]/a\\\n+        -e '/[ \t]DBL_DIG[ \t]/a\\\n #endif'\\\n-    ${LIB}/$file > ${LIB}/${file}.sed\n-  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+      ${LIB}/$file > ${LIB}/${file}.sed\n+    rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  fi\n   if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n     echo Deleting ${LIB}/$file\\; no fixes were needed.\n     rm -f ${LIB}/$file"}]}