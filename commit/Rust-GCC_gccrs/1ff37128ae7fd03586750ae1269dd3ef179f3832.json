{"sha": "1ff37128ae7fd03586750ae1269dd3ef179f3832", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWZmMzcxMjhhZTdmZDAzNTg2NzUwYWUxMjY5ZGQzZWYxNzlmMzgzMg==", "commit": {"author": {"name": "Roger Sayle", "email": "roger@eyesopen.com", "date": "2001-10-24T22:11:40Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2001-10-24T22:11:40Z"}, "message": "stmt.c (expand_end_case): Index jumptables from zero for suitably small values of minval.\n\n        * stmt.c (expand_end_case): Index jumptables from zero for\n        suitably small values of minval.\n\nFrom-SVN: r46478", "tree": {"sha": "9e551549baa1abd0812c74a8619b5f316aec7e28", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9e551549baa1abd0812c74a8619b5f316aec7e28"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1ff37128ae7fd03586750ae1269dd3ef179f3832", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ff37128ae7fd03586750ae1269dd3ef179f3832", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ff37128ae7fd03586750ae1269dd3ef179f3832", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ff37128ae7fd03586750ae1269dd3ef179f3832/comments", "author": null, "committer": null, "parents": [{"sha": "d76b2527779c3a822586c5b1543f5d7d9d22d49c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d76b2527779c3a822586c5b1543f5d7d9d22d49c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d76b2527779c3a822586c5b1543f5d7d9d22d49c"}], "stats": {"total": 18, "additions": 17, "deletions": 1}, "files": [{"sha": "1dfc93937bf7985983363bdb834a6a870611e8be", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ff37128ae7fd03586750ae1269dd3ef179f3832/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ff37128ae7fd03586750ae1269dd3ef179f3832/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1ff37128ae7fd03586750ae1269dd3ef179f3832", "patch": "@@ -1,3 +1,8 @@\n+2001-10-24  Roger Sayle <roger@eyesopen.com>\n+ \n+\t* stmt.c (expand_end_case): Index jumptables from zero for\n+\tsuitably small values of minval.\n+\n 2001-10-24  Jakub Jelinek  <jakub@redhat.com>\n \n \t* stor-layout.c (place_union_field): If any field was aligned with"}, {"sha": "76fa4393ee5b88fff3ef1d1a71fa628af5032a3d", "filename": "gcc/stmt.c", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ff37128ae7fd03586750ae1269dd3ef179f3832/gcc%2Fstmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ff37128ae7fd03586750ae1269dd3ef179f3832/gcc%2Fstmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstmt.c?ref=1ff37128ae7fd03586750ae1269dd3ef179f3832", "patch": "@@ -5534,14 +5534,25 @@ expand_end_case (orig_index)\n \t\t\t    table_label, default_label))\n \t    {\n \t      index_type = thiscase->data.case_stmt.nominal_type;\n+\n+              /* Index jumptables from zero for suitable values of\n+                 minval to avoid a subtraction.  */\n+              if (! optimize_size\n+                  && compare_tree_int (minval, 0) > 0\n+                  && compare_tree_int (minval, 3) < 0)\n+                {\n+                  minval = integer_zero_node;\n+                  range = maxval;\n+                }\n+\n \t      if (! try_tablejump (index_type, index_expr, minval, range,\n \t\t\t\t   table_label, default_label))\n \t\tabort ();\n \t    }\n \t  \n \t  /* Get table of labels to jump to, in order of case index.  */\n \n-\t  ncases = TREE_INT_CST_LOW (range) + 1;\n+\t  ncases = tree_low_cst (range, 0) + 1;\n \t  labelvec = (rtx *) alloca (ncases * sizeof (rtx));\n \t  memset ((char *) labelvec, 0, ncases * sizeof (rtx));\n "}]}