{"sha": "cba16cca6232ab9295cfd4ac247b874163712099", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2JhMTZjY2E2MjMyYWI5Mjk1Y2ZkNGFjMjQ3Yjg3NDE2MzcxMjA5OQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2015-05-27T20:53:06Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2015-05-27T20:53:06Z"}, "message": "decl.c (check_redeclaration_exception_specification): Depend on -Wsystem-headers rather than -pedantic.\n\n\t* decl.c (check_redeclaration_exception_specification): Depend on\n\t-Wsystem-headers rather than -pedantic.\n\nFrom-SVN: r223778", "tree": {"sha": "90cfa3f618c708e590d867e4133f36f75823ff48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/90cfa3f618c708e590d867e4133f36f75823ff48"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cba16cca6232ab9295cfd4ac247b874163712099", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cba16cca6232ab9295cfd4ac247b874163712099", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cba16cca6232ab9295cfd4ac247b874163712099", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cba16cca6232ab9295cfd4ac247b874163712099/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f425298902b6a36fef278c01610afb58dceaec89", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f425298902b6a36fef278c01610afb58dceaec89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f425298902b6a36fef278c01610afb58dceaec89"}], "stats": {"total": 27, "additions": 22, "deletions": 5}, "files": [{"sha": "774c36e53792897ec048757711470cf9eec29397", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=cba16cca6232ab9295cfd4ac247b874163712099", "patch": "@@ -1,5 +1,8 @@\n 2015-05-27  Jason Merrill  <jason@redhat.com>\n \n+\t* decl.c (check_redeclaration_exception_specification): Depend on\n+\t-Wsystem-headers rather than -pedantic.\n+\n \t* decl.c (warn_extern_redeclared_static): Use the location of\n \tnewdecl in diagnostics, not input_location.\n \t(validate_constexpr_redeclaration): Likewise."}, {"sha": "a8cb358965e829db7bc416f86672d72651165f9c", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=cba16cca6232ab9295cfd4ac247b874163712099", "patch": "@@ -1213,14 +1213,19 @@ check_redeclaration_exception_specification (tree new_decl,\n      all declarations, including the definition and an explicit\n      specialization, of that function shall have an\n      exception-specification with the same set of type-ids.  */\n-  if ((pedantic || ! DECL_IN_SYSTEM_HEADER (old_decl))\n-      && ! DECL_IS_BUILTIN (old_decl)\n+  if (! DECL_IS_BUILTIN (old_decl)\n       && flag_exceptions\n       && !comp_except_specs (new_exceptions, old_exceptions, ce_normal))\n     {\n-      error (\"declaration of %q+F has a different exception specifier\",\n-\t     new_decl);\n-      inform (0, \"from previous declaration %q+F\", old_decl);\n+      const char *msg\n+\t= \"declaration of %q+F has a different exception specifier\";\n+      bool complained = true;\n+      if (! DECL_IN_SYSTEM_HEADER (old_decl))\n+\terror (msg, new_decl);\n+      else\n+\tcomplained = pedwarn (0, OPT_Wsystem_headers, msg, new_decl);\n+      if (complained)\n+\tinform (0, \"from previous declaration %q+F\", old_decl);\n     }\n }\n "}, {"sha": "ac5c30d3dbc6c20f7d2fa54a355fb3f34fbd20ed", "filename": "gcc/testsuite/g++.dg/warn/Wsystem-headers1.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsystem-headers1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsystem-headers1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsystem-headers1.C?ref=cba16cca6232ab9295cfd4ac247b874163712099", "patch": "@@ -0,0 +1,3 @@\n+#include <stdlib.h>\n+\n+extern double atof (const char *);"}, {"sha": "68f6ea15f8d621f90c9ba651859e5463af211d2d", "filename": "gcc/testsuite/g++.dg/warn/Wsystem-headers1a.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsystem-headers1a.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cba16cca6232ab9295cfd4ac247b874163712099/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsystem-headers1a.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWsystem-headers1a.C?ref=cba16cca6232ab9295cfd4ac247b874163712099", "patch": "@@ -0,0 +1,6 @@\n+// { dg-do compile { target *-*-*gnu } }\n+// { dg-options \"-Wsystem-headers\" }\n+\n+#include <stdlib.h>\n+\n+extern double atof (const char *); // { dg-warning \"different exception spec\" }"}]}