{"sha": "b1c02fdc550e83ba4dbb907cce1808fac2f0ecef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjFjMDJmZGM1NTBlODNiYTRkYmI5MDdjY2UxODA4ZmFjMmYwZWNlZg==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2012-02-05T09:46:20Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2012-02-05T09:46:20Z"}, "message": "re PR fortran/51972 ([OOP] Wrong code as _copy does not honor CLASS components)\n\n2012-02-05  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/51972\n        * gfortran.dg/class_48.f90: Add some further checks.\n\nFrom-SVN: r183904", "tree": {"sha": "7090cefc27bd9ce3b4fe04581f1232ffd9d1000e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7090cefc27bd9ce3b4fe04581f1232ffd9d1000e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "24ee13842edcacff46a4f06d3b469d0bdc6d0a73", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24ee13842edcacff46a4f06d3b469d0bdc6d0a73", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24ee13842edcacff46a4f06d3b469d0bdc6d0a73"}], "stats": {"total": 52, "additions": 45, "deletions": 7}, "files": [{"sha": "92d7759fd02e5b019182ec34b8443d72559e42e5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b1c02fdc550e83ba4dbb907cce1808fac2f0ecef", "patch": "@@ -1,3 +1,8 @@\n+2012-02-05  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/51972\n+\t* gfortran.dg/class_48.f90: Add some further checks.\n+\n 2012-02-05  Ira Rosen  <irar@il.ibm.com>\n \n \tPR tree-optimization/52091"}, {"sha": "c1bab8ef0d59dd8d099a1c08df8777f5bb334c99", "filename": "gcc/testsuite/gfortran.dg/class_48.f90", "status": "modified", "additions": 40, "deletions": 7, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_48.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b1c02fdc550e83ba4dbb907cce1808fac2f0ecef/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_48.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_48.f90?ref=b1c02fdc550e83ba4dbb907cce1808fac2f0ecef", "patch": "@@ -70,13 +70,15 @@ subroutine test3 ()\n \n   type(t2) :: one, two\n \n-  one = two\n+  allocate (two%a(2))\n+  two%a(1)%x = 4\n+  two%a(2)%x = 6\n   if (allocated (one%a)) call abort ()\n-\n-  allocate (two%a(2), source=[t(4), t(6)])\n   one = two\n   if (.not.allocated (one%a)) call abort ()\n-! FIXME: Check value\n+\n+  if ((one%a(1)%x /= 4)) call abort ()\n+  if ((one%a(2)%x /= 6)) call abort ()\n \n   deallocate (two%a)\n   one = two\n@@ -94,12 +96,43 @@ subroutine test4 ()\n \n   type(t2) :: one, two\n \n-  one = two\n   if (allocated (one%a)) call abort ()\n-\n-!  allocate (two%a(2)) ! ICE: SEGFAULT\n+  if (allocated (two%a)) call abort ()\n+!\n+! FIXME: Fails due to PR 51754\n+!\n+! NOTE: Might be only visible with MALLOC_PERTURB_ or with valgrind\n+!\n+!  allocate (two%a(2))\n+!  if (allocated (two%a(1)%x)) call abort ()\n+!  if (allocated (two%a(2)%x)) call abort ()\n+!  allocate (two%a(1)%x(3), source=[1,2,3])\n+!  allocate (two%a(2)%x(5), source=[5,6,7,8,9])\n !  one = two\n !  if (.not. allocated (one%a)) call abort ()\n+!  if (.not. allocated (one%a(1)%x)) call abort ()\n+!  if (.not. allocated (one%a(2)%x)) call abort ()\n+!\n+!  if (size(one%a) /= 2) call abort()\n+!  if (size(one%a(1)%x) /= 3) call abort()\n+!  if (size(one%a(2)%x) /= 5) call abort()\n+!  if (any (one%a(1)%x /= [1,2,3])) call abort ()\n+!  if (any (one%a(2)%x /= [5,6,7,8,9])) call abort ()\n+!\n+!  deallocate (two%a(1)%x)\n+!  one = two\n+!  if (.not. allocated (one%a)) call abort ()\n+!  if (allocated (one%a(1)%x)) call abort ()\n+!  if (.not. allocated (one%a(2)%x)) call abort ()\n+!\n+!  if (size(one%a) /= 2) call abort()\n+!  if (size(one%a(2)%x) /= 5) call abort()\n+!  if (any (one%a(2)%x /= [5,6,7,8,9])) call abort ()\n+!\n+!  deallocate (two%a)\n+  one = two\n+  if (allocated (one%a)) call abort ()\n+  if (allocated (two%a)) call abort ()\n end subroutine test4\n \n "}]}