{"sha": "22d17b1c681199b6bd0380010c56cddbb6b8d96b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjJkMTdiMWM2ODExOTliNmJkMDM4MDAxMGM1NmNkZGJiNmI4ZDk2Yg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-03-29T20:25:27Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-03-29T20:25:27Z"}, "message": "re PR preprocessor/48248 (Wrong error message location when compiling preprocessed code)\n\n\tPR preprocessor/48248\n\t* c-ppoutput.c (print): Add src_file field.\n\t(init_pp_output): Initialize it.\n\t(maybe_print_line): Don't optimize by adding up to 8 newlines\n\tif map->to_file and print.src_file are different file.\n\t(print_line): Update print.src_file.\n\nFrom-SVN: r171693", "tree": {"sha": "694aa89b38234a2bb9ee479d1fa7c3bde396a87e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/694aa89b38234a2bb9ee479d1fa7c3bde396a87e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/22d17b1c681199b6bd0380010c56cddbb6b8d96b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22d17b1c681199b6bd0380010c56cddbb6b8d96b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22d17b1c681199b6bd0380010c56cddbb6b8d96b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22d17b1c681199b6bd0380010c56cddbb6b8d96b/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5d9cd5d0a712de44cb61dd809a525b7d16359ec7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d9cd5d0a712de44cb61dd809a525b7d16359ec7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d9cd5d0a712de44cb61dd809a525b7d16359ec7"}], "stats": {"total": 16, "additions": 15, "deletions": 1}, "files": [{"sha": "612af358589d1b68c31b4ac2f31a1a93804e4585", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22d17b1c681199b6bd0380010c56cddbb6b8d96b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22d17b1c681199b6bd0380010c56cddbb6b8d96b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=22d17b1c681199b6bd0380010c56cddbb6b8d96b", "patch": "@@ -1,3 +1,12 @@\n+2011-03-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR preprocessor/48248\n+\t* c-ppoutput.c (print): Add src_file field.\n+\t(init_pp_output): Initialize it.\n+\t(maybe_print_line): Don't optimize by adding up to 8 newlines\n+\tif map->to_file and print.src_file are different file.\n+\t(print_line): Update print.src_file.\n+\n 2011-03-29  Vladimir Makarov  <vmakarov@redhat.com>\n \n \t* ira-conflicts.c (build_object_conflicts): Add unused attribute"}, {"sha": "9ebac42316469d987d206917e220461b4f9219fb", "filename": "gcc/c-family/c-ppoutput.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22d17b1c681199b6bd0380010c56cddbb6b8d96b/gcc%2Fc-family%2Fc-ppoutput.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22d17b1c681199b6bd0380010c56cddbb6b8d96b/gcc%2Fc-family%2Fc-ppoutput.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-ppoutput.c?ref=22d17b1c681199b6bd0380010c56cddbb6b8d96b", "patch": "@@ -36,6 +36,7 @@ static struct\n   int src_line;\t\t\t/* Line number currently being written.  */\n   unsigned char printed;\t/* Nonzero if something output at line.  */\n   bool first_time;\t\t/* pp_file_change hasn't been called yet.  */\n+  const char *src_file;\t\t/* Current source file.  */\n } print;\n \n /* Defined and undefined macros being queued for output with -dU at\n@@ -153,6 +154,7 @@ init_pp_output (FILE *out_stream)\n   print.prev = 0;\n   print.outf = out_stream;\n   print.first_time = 1;\n+  print.src_file = \"\";\n }\n \n /* Writes out the preprocessed file, handling spacing and paste\n@@ -312,7 +314,9 @@ maybe_print_line (source_location src_loc)\n       print.printed = 0;\n     }\n \n-  if (src_line >= print.src_line && src_line < print.src_line + 8)\n+  if (src_line >= print.src_line\n+      && src_line < print.src_line + 8\n+      && strcmp (map->to_file, print.src_file) == 0)\n     {\n       while (src_line > print.src_line)\n \t{\n@@ -344,6 +348,7 @@ print_line (source_location src_loc, const char *special_flags)\n       unsigned char *p;\n \n       print.src_line = SOURCE_LINE (map, src_loc);\n+      print.src_file = map->to_file;\n \n       /* cpp_quote_string does not nul-terminate, so we have to do it\n \t ourselves.  */"}]}