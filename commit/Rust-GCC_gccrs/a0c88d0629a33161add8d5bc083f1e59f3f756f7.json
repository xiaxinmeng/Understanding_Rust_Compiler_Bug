{"sha": "a0c88d0629a33161add8d5bc083f1e59f3f756f7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTBjODhkMDYyOWEzMzE2MWFkZDhkNWJjMDgzZjFlNTlmM2Y3NTZmNw==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2015-01-23T12:54:16Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2015-01-23T12:54:16Z"}, "message": "Make fopenacc an LTO option\n\n2015-01-23  Tom de Vries  <tom@codesourcery.com>\n\n\tPR libgomp/64672\n\t* lto-opts.c (lto_write_options): Output non-explicit conservative\n\t-fno-openacc.\n\t* lto-wrapper.c (merge_and_complain): Handle merging -fopenacc.\n\t(append_compiler_options): Pass -fopenacc through.\n\n\t* c.opt (fopenacc): Mark as LTO option.\n\n\t* lang.opt (fopenacc): Mark as LTO option.\n\n\t* testsuite/libgomp.oacc-c-c++-common/abort-5.c: New test.\n\nFrom-SVN: r220038", "tree": {"sha": "667a67b3067e4f24e4c52912641a221fd52bf2d2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/667a67b3067e4f24e4c52912641a221fd52bf2d2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a0c88d0629a33161add8d5bc083f1e59f3f756f7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0c88d0629a33161add8d5bc083f1e59f3f756f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0c88d0629a33161add8d5bc083f1e59f3f756f7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0c88d0629a33161add8d5bc083f1e59f3f756f7/comments", "author": null, "committer": null, "parents": [{"sha": "1506ae0e1e865fb7a42fc37a47f1799b71f21c53", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1506ae0e1e865fb7a42fc37a47f1799b71f21c53", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1506ae0e1e865fb7a42fc37a47f1799b71f21c53"}], "stats": {"total": 51, "additions": 49, "deletions": 2}, "files": [{"sha": "b5beaf62153fb804188a566d2e9ed615a1bbe3c4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -1,3 +1,11 @@\n+2015-01-23  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR libgomp/64672\n+\t* lto-opts.c (lto_write_options): Output non-explicit conservative\n+\t-fno-openacc.\n+\t* lto-wrapper.c (merge_and_complain): Handle merging -fopenacc.\n+\t(append_compiler_options): Pass -fopenacc through.\n+\n 2015-01-23  Tom de Vries  <tom@codesourcery.com>\n \n \tPR libgomp/64707"}, {"sha": "851e664503fc5432a182059c1e97016cd57b8a91", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -1,3 +1,8 @@\n+2015-01-23  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR libgomp/64672\n+\t* c.opt (fopenacc): Mark as LTO option.\n+\n 2015-01-23  Tom de Vries  <tom@codesourcery.com>\n \n \tPR libgomp/64707"}, {"sha": "fd004072515280e80cfa7653eb983793a38af616", "filename": "gcc/c-family/c.opt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Fc-family%2Fc.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Fc-family%2Fc.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc.opt?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -1284,7 +1284,7 @@ ObjC ObjC++ Var(flag_objc1_only)\n Conform to the Objective-C 1.0 language as implemented in GCC 4.0\n \n fopenacc\n-C ObjC C++ ObjC++ Var(flag_openacc)\n+C ObjC C++ ObjC++ LTO Var(flag_openacc)\n Enable OpenACC\n \n fopenmp"}, {"sha": "bb6635694187da81d7c68f460e9733d629fe16f3", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -1,3 +1,8 @@\n+2015-01-23  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR libgomp/64672\n+\t* lang.opt (fopenacc): Mark as LTO option.\n+\n 2015-01-23  Tom de Vries  <tom@codesourcery.com>\n \n \tPR libgomp/64707"}, {"sha": "d86376a917c99e36a860a61f1fe1547814b990e9", "filename": "gcc/fortran/lang.opt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Ffortran%2Flang.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Ffortran%2Flang.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Flang.opt?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -567,7 +567,7 @@ Fortran Var(flag_module_private)\n Set default accessibility of module entities to PRIVATE.\n \n fopenacc\n-Fortran\n+Fortran LTO\n ; Documented in C\n \n fopenmp"}, {"sha": "279107fdab32918713acaf8b1f4a3335ac03336a", "filename": "gcc/lto-opts.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Flto-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Flto-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-opts.c?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -169,6 +169,10 @@ lto_write_options (void)\n   if (!global_options_set.x_flag_openmp\n       && !global_options.x_flag_openmp)\n     append_to_collect_gcc_options (&temporary_obstack, &first_p, \"-fno-openmp\");\n+  if (!global_options_set.x_flag_openacc\n+      && !global_options.x_flag_openacc)\n+    append_to_collect_gcc_options (&temporary_obstack, &first_p,\n+\t\t\t\t   \"-fno-openacc\");\n \n   /* Append options from target hook and store them to offload_lto section.  */\n   if (lto_stream_offload_p)"}, {"sha": "e9507717d4447c25bd87527c3d588d06475c2ee2", "filename": "gcc/lto-wrapper.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Flto-wrapper.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/gcc%2Flto-wrapper.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-wrapper.c?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -272,6 +272,7 @@ merge_and_complain (struct cl_decoded_option **decoded_options,\n \tcase OPT_ftrapping_math:\n \tcase OPT_fwrapv:\n \tcase OPT_fopenmp:\n+\tcase OPT_fopenacc:\n \t  /* For selected options we can merge conservatively.  */\n \t  for (j = 0; j < *decoded_options_count; ++j)\n \t    if ((*decoded_options)[j].opt_index == foption->opt_index)\n@@ -492,6 +493,7 @@ append_compiler_options (obstack *argv_obstack, struct cl_decoded_option *opts,\n \tcase OPT_ftrapping_math:\n \tcase OPT_fwrapv:\n \tcase OPT_fopenmp:\n+\tcase OPT_fopenacc:\n \tcase OPT_ftrapv:\n \tcase OPT_fstrict_overflow:\n \tcase OPT_foffload_abi_:"}, {"sha": "b6dfa23d3cc2d67076d18be4baea3f5a0a09ea20", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -1,3 +1,8 @@\n+2015-01-23  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR libgomp/64672\n+\t* testsuite/libgomp.oacc-c-c++-common/abort-5.c: New test.\n+\n 2015-01-23  Tom de Vries  <tom@codesourcery.com>\n \n \tPR libgomp/64707"}, {"sha": "314f04a1e765d959834e4a4e9c0f71b8a35c2046", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/abort-5.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0c88d0629a33161add8d5bc083f1e59f3f756f7/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fabort-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0c88d0629a33161add8d5bc083f1e59f3f756f7/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fabort-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fabort-5.c?ref=a0c88d0629a33161add8d5bc083f1e59f3f756f7", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-do run } */\n+/* { dg-additional-options \"-flto\" { target lto } } */\n+\n+#include <stdlib.h>\n+\n+int\n+main (int argc, char **argv)\n+{\n+\n+#pragma acc parallel\n+  {\n+    if (argc != 1)\n+      abort ();\n+  }\n+\n+  return 0;\n+}\n+"}]}