{"sha": "dfb84d62333725bb2a75323baa6efe86176733c4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGZiODRkNjIzMzM3MjViYjJhNzUzMjNiYWE2ZWZlODYxNzY3MzNjNA==", "commit": {"author": {"name": "Mike Stump", "email": "mrs@apple.com", "date": "2006-07-21T20:39:19Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2006-07-21T20:39:19Z"}, "message": "invoke.texi (C++ Dialect Options): Note that -fvisibility-inlines-hidden doesn't affect explicitly instantiationed...\n\n\t* doc/invoke.texi (C++ Dialect Options): Note that\n\t-fvisibility-inlines-hidden doesn't affect explicitly\n\tinstantiationed inline methods.\n\ncp:\n\t* decl2.c (determine_visibility_from_class): Don't use hidden\n\tvisibility for explicit instantiations.\n\ntestsuite:\n\t* g++.dg/ext/visibility/fvisibility-inlines-hidden-3.C: New test.\n\nFrom-SVN: r115649", "tree": {"sha": "8933addce976789e0d8124aed02da74fe0e572d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8933addce976789e0d8124aed02da74fe0e572d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dfb84d62333725bb2a75323baa6efe86176733c4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfb84d62333725bb2a75323baa6efe86176733c4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dfb84d62333725bb2a75323baa6efe86176733c4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfb84d62333725bb2a75323baa6efe86176733c4/comments", "author": null, "committer": null, "parents": [{"sha": "c82815a60a1e5e744568084994a654e75d299fe8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c82815a60a1e5e744568084994a654e75d299fe8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c82815a60a1e5e744568084994a654e75d299fe8"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "a6473416f5395357fdb260f9a1b1414ef46916b2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=dfb84d62333725bb2a75323baa6efe86176733c4", "patch": "@@ -1,3 +1,9 @@\n+2006-07-21  Mike Stump  <mrs@apple.com>\n+\n+\t* doc/invoke.texi (C++ Dialect Options): Note that\n+\t-fvisibility-inlines-hidden doesn't affect explicitly\n+\tinstantiationed inline methods.\n+\n 2006-07-20  Roger Sayle  <roger@eyesopen.com>\n \n \t* config.gcc (i[34567]86-*-solaris2*): Add usegas.h to $tm_file"}, {"sha": "f74d1a7649f2e389f1a1c9c547fc4fdad16cf5f9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dfb84d62333725bb2a75323baa6efe86176733c4", "patch": "@@ -1,3 +1,8 @@\n+2006-07-20  Mike Stump  <mrs@apple.com>\n+\n+\t* decl2.c (determine_visibility_from_class): Don't use hidden\n+\tvisibility for explicit instantiations.\n+\n 2006-07-21  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \tPR c++/28250"}, {"sha": "876dea30ef23281056f6cf4ed1abd2762dd8c8b5", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=dfb84d62333725bb2a75323baa6efe86176733c4", "patch": "@@ -1801,7 +1801,9 @@ determine_visibility_from_class (tree decl, tree class_type)\n       && !processing_template_decl\n       && ! DECL_VISIBILITY_SPECIFIED (decl)\n       && TREE_CODE (decl) == FUNCTION_DECL\n-      && DECL_DECLARED_INLINE_P (decl))\n+      && DECL_DECLARED_INLINE_P (decl)\n+      && (! DECL_LANG_SPECIFIC (decl)\n+\t  || ! DECL_EXPLICIT_INSTANTIATION (decl)))\n     DECL_VISIBILITY (decl) = VISIBILITY_HIDDEN;\n   else if (!DECL_VISIBILITY_SPECIFIED (decl))\n     {"}, {"sha": "28a0a5bfa904ea17fc8045f63eff46b98a3480d1", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=dfb84d62333725bb2a75323baa6efe86176733c4", "patch": "@@ -1627,6 +1627,10 @@ effect of the switch for that method.  For example, if you do want to\n compare pointers to a particular inline method, you might mark it as\n having default visibility.\n \n+Explicitly instantiated inline methods are unaffected by this option\n+as their linkage might otherwise cross a shared library boundary.\n+@xref{Template Instantiation}.\n+\n @item -fno-weak\n @opindex fno-weak\n Do not use weak symbol support, even if it is provided by the linker."}, {"sha": "d0b9521f656725cdcad6b6098b01f6a1e4e1ddd2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dfb84d62333725bb2a75323baa6efe86176733c4", "patch": "@@ -1,5 +1,7 @@\n 2006-07-21  Mike Stump  <mrs@apple.com>\n \n+\t* g++.dg/ext/visibility/fvisibility-inlines-hidden-3.C: New test.\n+\n \t* gcc.c-torture/unsorted/dump-noaddr.x: Fix test case name.\n \n 2006-07-21  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>"}, {"sha": "50885a798ddcf1221543627fe819074b039b9dfe", "filename": "gcc/testsuite/g++.dg/ext/visibility/fvisibility-inlines-hidden-3.C", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvisibility%2Ffvisibility-inlines-hidden-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dfb84d62333725bb2a75323baa6efe86176733c4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvisibility%2Ffvisibility-inlines-hidden-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvisibility%2Ffvisibility-inlines-hidden-3.C?ref=dfb84d62333725bb2a75323baa6efe86176733c4", "patch": "@@ -0,0 +1,30 @@\n+/* { dg-do compile } */\n+/* { dg-require-visibility \"\" } */\n+/* { dg-options \"-fvisibility-inlines-hidden\" } */\n+/* { dg-final { scan-not-hidden \"_ZN1IIiE3fooEv\" } } */\n+/* { dg-final { scan-not-hidden \"_ZN1OIiE3fooEv\" } } */\n+/* { dg-final { scan-hidden \"_ZN1S3fooEv\" } } */\n+\n+template <class T>\n+struct O {\n+  static inline void foo() { }\n+};\n+\n+template void O<int>::foo();\n+\n+template <class T>\n+struct I {\n+  static inline void foo() { }\n+};\n+\n+extern template void I<int>::foo();\n+\n+struct S {\n+  static inline void foo() { }\n+};\n+\n+void bar() {\n+  I<int>::foo();\n+  O<int>::foo();\n+  S::foo();\n+}"}]}