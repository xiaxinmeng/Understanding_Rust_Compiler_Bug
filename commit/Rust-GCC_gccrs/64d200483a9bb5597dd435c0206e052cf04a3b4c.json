{"sha": "64d200483a9bb5597dd435c0206e052cf04a3b4c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjRkMjAwNDgzYTliYjU1OTdkZDQzNWMwMjA2ZTA1MmNmMDRhM2I0Yw==", "commit": {"author": {"name": "Andrew Haley", "email": "aph@redhat.com", "date": "2004-12-17T15:13:44Z"}, "committer": {"name": "Andrew Haley", "email": "aph@gcc.gnu.org", "date": "2004-12-17T15:13:44Z"}, "message": "re PR libgcj/15001 ([3.4 only] Using JNI with interpreter and interface methods yields SIGSEGV)\n\n2004-12-10  Andrew Haley  <aph@redhat.com>\n\n        PR java/15001\n        * java/lang/reflect/natMethod.cc (_Jv_CallAnyMethodA): Look up\n        abstract methods by name.\n\nFrom-SVN: r92315", "tree": {"sha": "4ec6af89798d7c2aedf38df69842202141f35b02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4ec6af89798d7c2aedf38df69842202141f35b02"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/64d200483a9bb5597dd435c0206e052cf04a3b4c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64d200483a9bb5597dd435c0206e052cf04a3b4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64d200483a9bb5597dd435c0206e052cf04a3b4c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64d200483a9bb5597dd435c0206e052cf04a3b4c/comments", "author": {"login": "theRealAph", "id": 254637, "node_id": "MDQ6VXNlcjI1NDYzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/254637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theRealAph", "html_url": "https://github.com/theRealAph", "followers_url": "https://api.github.com/users/theRealAph/followers", "following_url": "https://api.github.com/users/theRealAph/following{/other_user}", "gists_url": "https://api.github.com/users/theRealAph/gists{/gist_id}", "starred_url": "https://api.github.com/users/theRealAph/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theRealAph/subscriptions", "organizations_url": "https://api.github.com/users/theRealAph/orgs", "repos_url": "https://api.github.com/users/theRealAph/repos", "events_url": "https://api.github.com/users/theRealAph/events{/privacy}", "received_events_url": "https://api.github.com/users/theRealAph/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cd5fcd336698c4a9acaf5ec42c2444b3d432aaf2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd5fcd336698c4a9acaf5ec42c2444b3d432aaf2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd5fcd336698c4a9acaf5ec42c2444b3d432aaf2"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "9273fc917b609f4f63c405b8e01b1d6cad1c6695", "filename": "libjava/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/64d200483a9bb5597dd435c0206e052cf04a3b4c/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/64d200483a9bb5597dd435c0206e052cf04a3b4c/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=64d200483a9bb5597dd435c0206e052cf04a3b4c", "patch": "@@ -1,3 +1,9 @@\n+2004-12-10  Andrew Haley  <aph@redhat.com>\n+\n+\tPR java/15001\n+\t* java/lang/reflect/natMethod.cc (_Jv_CallAnyMethodA): Look up\n+\tabstract methods by name.\n+\n 2004-12-08  Ranjit Mathew  <rmathew@hotmail.com>\n \n \t* java/util/IdentityHashMap.java (put): Replace mistaken use"}, {"sha": "b4b3a7a9b06943c857f07801ede679960d454c30", "filename": "libjava/java/lang/reflect/natMethod.cc", "status": "modified", "additions": 22, "deletions": 1, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/64d200483a9bb5597dd435c0206e052cf04a3b4c/libjava%2Fjava%2Flang%2Freflect%2FnatMethod.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/64d200483a9bb5597dd435c0206e052cf04a3b4c/libjava%2Fjava%2Flang%2Freflect%2FnatMethod.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2Freflect%2FnatMethod.cc?ref=64d200483a9bb5597dd435c0206e052cf04a3b4c", "patch": "@@ -30,6 +30,7 @@ details.  */\n #include <java/lang/Double.h>\n #include <java/lang/IllegalAccessException.h>\n #include <java/lang/IllegalArgumentException.h>\n+#include <java/lang/IncompatibleClassChangeError.h>\n #include <java/lang/NullPointerException.h>\n #include <java/lang/ArrayIndexOutOfBoundsException.h>\n #include <java/lang/VirtualMachineError.h>\n@@ -480,7 +481,27 @@ _Jv_CallAnyMethodA (jobject obj,\n     {\n       _Jv_VTable *vtable = *(_Jv_VTable **) obj;\n       if (iface == NULL)\n-\tncode = vtable->get_method (meth->index);\n+\t{\n+\t  if (is_jni_call && Modifier::isAbstract (meth->accflags))\n+\t    {\n+\t      // With JNI we don't know if this is an interface call\n+\t      // or a call to an abstract method.  Look up the method\n+\t      // by name, the slow way.\n+\t      _Jv_Method *concrete_meth\n+\t\t= _Jv_LookupDeclaredMethod (vtable->clas,\n+\t\t\t\t\t    meth->name,\n+\t\t\t\t\t    meth->signature,\n+\t\t\t\t\t    NULL);\n+\t      if (concrete_meth == NULL\n+\t\t  || concrete_meth->ncode == NULL\n+\t\t  || Modifier::isAbstract(concrete_meth->accflags))\n+\t\tthrow new java::lang::IncompatibleClassChangeError\n+\t\t  (_Jv_GetMethodString (vtable->clas, meth->name));\n+\t      ncode = concrete_meth->ncode;\n+\t    }\n+\t  else\n+\t    ncode = vtable->get_method (meth->index);\n+\t}\n       else\n \tncode = _Jv_LookupInterfaceMethodIdx (vtable->clas, iface,\n \t\t\t\t\t      meth->index);"}]}