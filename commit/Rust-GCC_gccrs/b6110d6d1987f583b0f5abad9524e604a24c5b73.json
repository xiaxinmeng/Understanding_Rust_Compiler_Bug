{"sha": "b6110d6d1987f583b0f5abad9524e604a24c5b73", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjYxMTBkNmQxOTg3ZjU4M2IwZjVhYmFkOTUyNGU2MDRhMjRjNWI3Mw==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2010-09-28T00:07:12Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2010-09-28T00:07:12Z"}, "message": "i386.c (ix86_supports_split_stack): -fsplit-stack requires assembler support for CFI directives.\n\ngcc/:\n\t* config/i386/i386.c (ix86_supports_split_stack): -fsplit-stack\n\trequires assembler support for CFI directives.\nlibgcc/:\n\t* configure.ac: Test whether assembler supports CFI directives.\n\t* config.host: Only add t-stack and i386/t-stack-i386 to\n\ttmake_file if libgcc_cv_cfi is \"yes\".\n\t* configure: Rebuild.\n\nFrom-SVN: r164671", "tree": {"sha": "abe9b70798228d019e6509efb68de44278c0e201", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/abe9b70798228d019e6509efb68de44278c0e201"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b6110d6d1987f583b0f5abad9524e604a24c5b73", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6110d6d1987f583b0f5abad9524e604a24c5b73", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6110d6d1987f583b0f5abad9524e604a24c5b73", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6110d6d1987f583b0f5abad9524e604a24c5b73/comments", "author": null, "committer": null, "parents": [{"sha": "9b809695ffe6091f8e491cad04c08e6c63f880af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b809695ffe6091f8e491cad04c08e6c63f880af", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b809695ffe6091f8e491cad04c08e6c63f880af"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "6c7620e8bf63e5c6bb31a599e1fbbb300a6fd5c1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6110d6d1987f583b0f5abad9524e604a24c5b73/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6110d6d1987f583b0f5abad9524e604a24c5b73/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b6110d6d1987f583b0f5abad9524e604a24c5b73", "patch": "@@ -1,3 +1,8 @@\n+2010-09-27  Ian Lance Taylor  <iant@google.com>\n+\n+\t* config/i386/i386.c (ix86_supports_split_stack): -fsplit-stack\n+\trequires assembler support for CFI directives.\n+\n 2010-09-27  Richard Henderson  <rth@redhat.com>\n \n \t* dwarf2out.c (dwarf2out_cfi_label): Use ASM_OUTPUT_DEBUG_LABEL."}, {"sha": "1d1c3007e0a55fe0ffbb73e7abb27705ce0ff462", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6110d6d1987f583b0f5abad9524e604a24c5b73/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6110d6d1987f583b0f5abad9524e604a24c5b73/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=b6110d6d1987f583b0f5abad9524e604a24c5b73", "patch": "@@ -8415,6 +8415,14 @@ ix86_supports_split_stack (bool report ATTRIBUTE_UNUSED)\n   if (report)\n     error (\"%<-fsplit-stack%> currently only supported on GNU/Linux\");\n   ret = false;\n+#else\n+  if (!dwarf2out_do_cfi_asm ())\n+    {\n+      if (report)\n+\terror (\"%<-fsplit-stack%> requires \"\n+\t       \"assembler support for CFI directives\");\n+      ret = false;\n+    }\n #endif\n \n   return ret;"}, {"sha": "c6ac0b40183d7c9ddafbe15925c799e90186cd67", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=b6110d6d1987f583b0f5abad9524e604a24c5b73", "patch": "@@ -1,3 +1,10 @@\n+2010-09-27  Ian Lance Taylor  <iant@google.com>\n+\n+\t* configure.ac: Test whether assembler supports CFI directives.\n+\t* config.host: Only add t-stack and i386/t-stack-i386 to\n+\ttmake_file if libgcc_cv_cfi is \"yes\".\n+\t* configure: Rebuild.\n+\n 2010-09-27  Ian Lance Taylor  <iant@google.com>\n \n \t* generic-morestack.h: New file."}, {"sha": "ab43da96cfbdb6fbd07fcc5a560bbbf0eed81b9c", "filename": "libgcc/config.host", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2Fconfig.host", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2Fconfig.host", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig.host?ref=b6110d6d1987f583b0f5abad9524e604a24c5b73", "patch": "@@ -602,7 +602,10 @@ case ${host} in\n i[34567]86-*-linux* | x86_64-*-linux* | \\\n   i[34567]86-*-kfreebsd*-gnu | i[34567]86-*-knetbsd*-gnu | \\\n   i[34567]86-*-gnu*)\n-\ttmake_file=\"${tmake_file} t-tls t-stack i386/t-stack-i386\"\n+\ttmake_file=\"${tmake_file} t-tls\"\n+\tif test \"$libgcc_cv_cfi\" = \"yes\"; then\n+\t\ttmake_file=\"{$tmake_file} t-stack i386/t-stack-i386\"\n+\tfi\n \t;;\n esac\n "}, {"sha": "56195bb106d73adb339f36d904d0374ddf7e2c5f", "filename": "libgcc/configure", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfigure?ref=b6110d6d1987f583b0f5abad9524e604a24c5b73", "patch": "@@ -3707,6 +3707,26 @@ $as_echo \"$libgcc_cv_fixed_point\" >&6; }\n fixed_point=$libgcc_cv_fixed_point\n \n \n+# Check for assembler CFI support.\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether assembler supports CFI directives\" >&5\n+$as_echo_n \"checking whether assembler supports CFI directives... \" >&6; }\n+if test \"${libgcc_cv_cfi+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+int i = __GCC_HAVE_DWARF2_CFI_ASM;\n+_ACEOF\n+if ac_fn_c_try_compile \"$LINENO\"; then :\n+  libgcc_cv_cfi=yes\n+else\n+  libgcc_cv_cfi=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $libgcc_cv_cfi\" >&5\n+$as_echo \"$libgcc_cv_cfi\" >&6; }\n+\n # Check 32bit or 64bit for x86.\n case ${host} in\n i?86*-*-* | x86_64*-*-*)"}, {"sha": "6bb4844b882e46b7abb2054c3705d45ed00bee2f", "filename": "libgcc/configure.ac", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6110d6d1987f583b0f5abad9524e604a24c5b73/libgcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfigure.ac?ref=b6110d6d1987f583b0f5abad9524e604a24c5b73", "patch": "@@ -135,6 +135,12 @@ AC_CACHE_CHECK([whether fixed-point is supported], [libgcc_cv_fixed_point],\n fixed_point=$libgcc_cv_fixed_point\n AC_SUBST(fixed_point)\n \n+# Check for assembler CFI support.\n+AC_CACHE_CHECK([whether assembler supports CFI directives], [libgcc_cv_cfi],\n+\t       [AC_COMPILE_IFELSE([int i = __GCC_HAVE_DWARF2_CFI_ASM;],\n+\t\t\t\t  [libgcc_cv_cfi=yes],\n+\t\t\t\t  [libgcc_cv_cfi=no])])\n+\n # Check 32bit or 64bit for x86.\n case ${host} in\n i?86*-*-* | x86_64*-*-*)"}]}