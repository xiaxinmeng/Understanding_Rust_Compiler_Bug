{"sha": "bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmYwOWYwZTBlOTg3MTNiNGE3Njc0M2E4M2RkNDdjODJiMzRmYTEyYQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2008-08-29T18:59:13Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-08-29T18:59:13Z"}, "message": "re PR middle-end/37261 (Spurious (?) \"integer overflow in expression\" warnings)\n\n\tPR c/37261\n\t* fold-const.c (fold_binary): In (X | C1) & C2 canonicalization\n\tcompute new & and | in type rather than TREE_TYPE (arg0).\n\n\t* gcc.dg/pr37261.c: New test.\n\nFrom-SVN: r139784", "tree": {"sha": "60c9d72ca2cc8e6c55dbfe40008bdbd5f5759039", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/60c9d72ca2cc8e6c55dbfe40008bdbd5f5759039"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "98c0cbd30a77148e1baa024678eeae6ff2a925c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98c0cbd30a77148e1baa024678eeae6ff2a925c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98c0cbd30a77148e1baa024678eeae6ff2a925c0"}], "stats": {"total": 37, "additions": 29, "deletions": 8}, "files": [{"sha": "afc52add56334c98ddcd1fc9dc0f95f5638f73d8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "patch": "@@ -1,5 +1,9 @@\n 2008-08-29  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c/37261\n+\t* fold-const.c (fold_binary): In (X | C1) & C2 canonicalization\n+\tcompute new & and | in type rather than TREE_TYPE (arg0).\n+\n \t* dwarf2out.c (fortran_common): Update comment.\n \t(gen_variable_die): Swap com_die and var_die variables in Fortran\n \tCOMMON block handling code."}, {"sha": "01936bd55fd5459e3b1dabcbfdfffe754fcd8724", "filename": "gcc/fold-const.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "patch": "@@ -10737,14 +10737,13 @@ fold_binary (enum tree_code code, tree type, tree op0, tree op1)\n \t  && TREE_CODE (arg1) == INTEGER_CST\n \t  && TREE_CODE (TREE_OPERAND (arg0, 1)) == INTEGER_CST)\n \t{\n-\t  tree tmp1 = fold_convert (TREE_TYPE (arg0), arg1);\n-\t  tree tmp2 = fold_build2 (BIT_AND_EXPR, TREE_TYPE (arg0),\n-\t\t\t\t   TREE_OPERAND (arg0, 0), tmp1);\n-\t  tree tmp3 = fold_build2 (BIT_AND_EXPR, TREE_TYPE (arg0),\n-\t\t\t\t   TREE_OPERAND (arg0, 1), tmp1);\n+\t  tree tmp1 = fold_convert (type, arg1);\n+\t  tree tmp2 = fold_convert (type, TREE_OPERAND (arg0, 0));\n+\t  tree tmp3 = fold_convert (type, TREE_OPERAND (arg0, 1));\n+\t  tmp2 = fold_build2 (BIT_AND_EXPR, type, tmp2, tmp1);\n+\t  tmp3 = fold_build2 (BIT_AND_EXPR, type, tmp3, tmp1);\n \t  return fold_convert (type,\n-\t\t\t       fold_build2 (BIT_IOR_EXPR, TREE_TYPE (arg0),\n-\t\t\t\t\t    tmp2, tmp3));\n+\t\t\t       fold_build2 (BIT_IOR_EXPR, type, tmp2, tmp3));\n \t}\n \n       /* (X | Y) & Y is (X, Y).  */"}, {"sha": "7cae5e979d26c1b1aa413c8667d8b695e269d88c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "patch": "@@ -1,4 +1,7 @@\n-2008-08-22  Jakub Jelinek  <jakub@redhat.com>\n+2008-08-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/37261\n+\t* gcc.dg/pr37261.c: New test.\n \n \tPR fortran/23057\n \t* gfortran.dg/debug/pr35154-dwarf2.f: Adjust for replacement"}, {"sha": "a05ada148c1f8ee252e56e472094eef69bae5be3", "filename": "gcc/testsuite/gcc.dg/pr37261.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37261.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf09f0e0e98713b4a76743a83dd47c82b34fa12a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37261.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37261.c?ref=bf09f0e0e98713b4a76743a83dd47c82b34fa12a", "patch": "@@ -0,0 +1,15 @@\n+/* PR c/37261 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-optimized\" } */\n+\n+unsigned\n+foo (int x)\n+{\n+  unsigned a = ((x & 1) | 2) & 0x80000000;\t/* { dg-bogus \"integer overflow in expression\" } */\n+  unsigned b = ((x & 2) | 2) & 0x80000000;\t/* { dg-bogus \"integer overflow in expression\" } */\n+  unsigned c = ((x & 4) | 2) & 0x80000000;\t/* { dg-bogus \"integer overflow in expression\" } */\n+  return a + b + c;\n+}\n+\n+/* { dg-final { scan-tree-dump \"return 0\" \"optimized\" } } */\n+/* { dg-final { cleanup-tree-dump \"optimized\" } } */"}]}