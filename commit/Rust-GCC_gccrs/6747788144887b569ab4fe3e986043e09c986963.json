{"sha": "6747788144887b569ab4fe3e986043e09c986963", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Njc0Nzc4ODE0NDg4N2I1NjlhYjRmZTNlOTg2MDQzZTA5Yzk4Njk2Mw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-06-21T16:26:25Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-06-21T16:26:25Z"}, "message": "re PR bootstrap/44426 (gcc 4.5.0 requires c9x compiler to build)\n\n\tPR bootstrap/44426\n\t* sel-sched-dump.h (sel_prepare_string_for_dot_label): Remove\n\tprototype.\n\t(sel_print_to_dot): Remove macro.\n\t(sel_print): Likewise.  New prototype.\n\t* sel-sched-dump.c (sel_prepare_string_for_dot_label): Make static.\n\t(sel_print): New function.\n\nFrom-SVN: r161092", "tree": {"sha": "86fc98f46a0126cc9517263e47a96f27eb9f412e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/86fc98f46a0126cc9517263e47a96f27eb9f412e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6747788144887b569ab4fe3e986043e09c986963", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6747788144887b569ab4fe3e986043e09c986963", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6747788144887b569ab4fe3e986043e09c986963", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6747788144887b569ab4fe3e986043e09c986963/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d34b4f64c879442fb29b59301425fc0087fea5dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d34b4f64c879442fb29b59301425fc0087fea5dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d34b4f64c879442fb29b59301425fc0087fea5dd"}], "stats": {"total": 55, "additions": 32, "deletions": 23}, "files": [{"sha": "aa4d2a877e496b6300d12f1c905e292d6e709674", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6747788144887b569ab4fe3e986043e09c986963/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6747788144887b569ab4fe3e986043e09c986963/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6747788144887b569ab4fe3e986043e09c986963", "patch": "@@ -3,6 +3,14 @@\n \t* stmt.c (resolve_asm_operand_names): Fix handling\n \tof %%.\n \n+\tPR bootstrap/44426\n+\t* sel-sched-dump.h (sel_prepare_string_for_dot_label): Remove\n+\tprototype.\n+\t(sel_print_to_dot): Remove macro.\n+\t(sel_print): Likewise.  New prototype.\n+\t* sel-sched-dump.c (sel_prepare_string_for_dot_label): Make static.\n+\t(sel_print): New function.\n+\n 2010-06-21  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* config/sol2.h (TARGET_OS_CPP_BUILTINS): Define"}, {"sha": "e9b486f332b87bbcad5d41ec53b7a8f17cb73084", "filename": "gcc/sel-sched-dump.c", "status": "modified", "additions": 23, "deletions": 1, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6747788144887b569ab4fe3e986043e09c986963/gcc%2Fsel-sched-dump.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6747788144887b569ab4fe3e986043e09c986963/gcc%2Fsel-sched-dump.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched-dump.c?ref=6747788144887b569ab4fe3e986043e09c986963", "patch": "@@ -566,7 +566,7 @@ replace_str_in_buf (char *buf, const char *str1, const char *str2)\n }\n \n /* Replace characters in BUF that have special meaning in .dot file.  */\n-void\n+static void\n sel_prepare_string_for_dot_label (char *buf)\n {\n   static char specials_from[7][2] = { \"<\", \">\", \"{\", \"|\", \"}\", \"\\\"\",\n@@ -579,6 +579,28 @@ sel_prepare_string_for_dot_label (char *buf)\n     replace_str_in_buf (buf, specials_from[i], specials_to[i]);\n }\n \n+/* This function acts like printf but dumps to the sched_dump file.  */\n+void\n+sel_print (const char *fmt, ...)\n+{\n+  va_list ap;\n+  va_start (ap, fmt);\n+  if (sched_dump_to_dot_p)\n+    {\n+      char *message;\n+      if (vasprintf (&message, fmt, ap) >= 0 && message != NULL)\n+\t{\n+\t  message = (char *) xrealloc (message, 2 * strlen (message) + 1);\n+\t  sel_prepare_string_for_dot_label (message);\n+\t  fprintf (sched_dump, \"%s\", message);\n+\t  free (message);\n+\t}\n+    }\n+  else\n+    vfprintf (sched_dump, fmt, ap);\n+  va_end (ap);\n+}\n+\n /* Dump INSN with FLAGS.  */\n static void\n sel_dump_cfg_insn (insn_t insn, int flags)"}, {"sha": "52d7aea693a7e22cd232f91253080c623222d499", "filename": "gcc/sel-sched-dump.h", "status": "modified", "additions": 1, "deletions": 22, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6747788144887b569ab4fe3e986043e09c986963/gcc%2Fsel-sched-dump.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6747788144887b569ab4fe3e986043e09c986963/gcc%2Fsel-sched-dump.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched-dump.h?ref=6747788144887b569ab4fe3e986043e09c986963", "patch": "@@ -177,34 +177,13 @@ extern void dump_insn_1 (insn_t, int);\n extern void dump_insn (insn_t);\n extern void debug_insn (insn_t);\n \n-extern void sel_prepare_string_for_dot_label (char *);\n-\n /* When this flag is on, we are dumping to the .dot file.\n    When it is off, we are dumping to log.  */\n extern bool sched_dump_to_dot_p;\n-\n-/* This macro acts like printf but dumps information to the .dot file.\n-   Used when dumping control flow.  */\n-#define sel_print_to_dot(...)                           \\\n-  do {                                                  \\\n-    int __j = 1 + 2 * snprintf (NULL, 0, __VA_ARGS__);  \\\n-    char *__s = XALLOCAVEC (char, __j);                 \\\n-    snprintf (__s, __j, __VA_ARGS__);                   \\\n-    sel_prepare_string_for_dot_label (__s);             \\\n-    fprintf (sched_dump, \"%s\", __s);                    \\\n-  } while (0)\n-\n-/* This macro acts like printf but dumps to the sched_dump file.  */\n-#define sel_print(...)\t\t\t\t\t\\\n-  do {\t\t\t\t\t\t\t\\\n-    if (sched_dump_to_dot_p)                            \\\n-      sel_print_to_dot (__VA_ARGS__);                   \\\n-    else                                                \\\n-      fprintf (sched_dump, __VA_ARGS__);                \\\n-  } while (0)\n \f\n \n /* Functions from sel-sched-dump.c.  */\n+extern void sel_print (const char *fmt, ...) ATTRIBUTE_PRINTF_1;\n extern const char * sel_print_insn (const_rtx, int);\n extern void free_sel_dump_data (void);\n "}]}