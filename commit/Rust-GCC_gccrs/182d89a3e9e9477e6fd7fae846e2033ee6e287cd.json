{"sha": "182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTgyZDg5YTNlOWU5NDc3ZTZmZDdmYWU4NDZlMjAzM2VlNmUyODdjZA==", "commit": {"author": {"name": "Neil Booth", "email": "neil@daikokuya.co.uk", "date": "2002-08-14T22:34:50Z"}, "committer": {"name": "Neil Booth", "email": "neil@gcc.gnu.org", "date": "2002-08-14T22:34:50Z"}, "message": "re PR preprocessor/7358 (Changes to Sun's make Dependencies)\n\n\tPR preprocessor/7358\n\t* c-opts.c (check_deps_environment_vars): Ignore main file\n\tfor SUNPRO_DEPENDENCIES.\n\t* cppfiles.c (stack_include_file): Ignore main file if\n\tappropriate.\n\t* cpplib.h (struct cpp_options): New member in deps.\n\t* doc/cppenv.texi: Update.\n\nFrom-SVN: r56333", "tree": {"sha": "f37dd03c8db5ac792b317d8bbddee04999fd0d43", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f37dd03c8db5ac792b317d8bbddee04999fd0d43"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/comments", "author": {"login": "neilb-xx", "id": 160762, "node_id": "MDQ6VXNlcjE2MDc2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/160762?v=4", "gravatar_id": "", "url": "https://api.github.com/users/neilb-xx", "html_url": "https://github.com/neilb-xx", "followers_url": "https://api.github.com/users/neilb-xx/followers", "following_url": "https://api.github.com/users/neilb-xx/following{/other_user}", "gists_url": "https://api.github.com/users/neilb-xx/gists{/gist_id}", "starred_url": "https://api.github.com/users/neilb-xx/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/neilb-xx/subscriptions", "organizations_url": "https://api.github.com/users/neilb-xx/orgs", "repos_url": "https://api.github.com/users/neilb-xx/repos", "events_url": "https://api.github.com/users/neilb-xx/events{/privacy}", "received_events_url": "https://api.github.com/users/neilb-xx/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8bfb14674d5dccd6a1cdd71051dfac643901c4d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8bfb14674d5dccd6a1cdd71051dfac643901c4d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8bfb14674d5dccd6a1cdd71051dfac643901c4d4"}], "stats": {"total": 31, "additions": 26, "deletions": 5}, "files": [{"sha": "2142ccd750a7d5f8d29e38d5406e7d7454165c94", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "patch": "@@ -1,3 +1,13 @@\n+2002-08-15  Neil Booth  <neil@daikokuya.co.uk>\n+\n+\tPR preprocessor/7358\n+\t* c-opts.c (check_deps_environment_vars): Ignore main file\n+\tfor SUNPRO_DEPENDENCIES.\n+\t* cppfiles.c (stack_include_file): Ignore main file if\n+\tappropriate.\n+\t* cpplib.h (struct cpp_options): New member in deps.\n+\t* doc/cppenv.texi: Update.\n+\n 2002-08-14  Neil Booth  <neil@daikokuya.co.uk>\n \n \tPR preprocessor/7526"}, {"sha": "36f11f02288267d62af855f94fc03355a50b1cef", "filename": "gcc/c-opts.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fc-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fc-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-opts.c?ref=182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "patch": "@@ -1467,7 +1467,8 @@ c_common_finish ()\n    DEPS_TARGET\", where OUTPUT_FILE is the file to write deps info to\n    and DEPS_TARGET is the target to mention in the deps.  They also\n    result in dependency information being appended to the output file\n-   rather than overwriting it.  */\n+   rather than overwriting it, and like Sun's compiler\n+   SUNPRO_DEPENDENCIES suppresses the dependency on the main file.  */\n static void\n check_deps_environment_vars ()\n {\n@@ -1480,7 +1481,10 @@ check_deps_environment_vars ()\n     {\n       GET_ENVIRONMENT (spec, \"SUNPRO_DEPENDENCIES\");\n       if (spec)\n-\tcpp_opts->deps.style = DEPS_SYSTEM;\n+\t{\n+\t  cpp_opts->deps.style = DEPS_SYSTEM;\n+\t  cpp_opts->deps.ignore_main_file = true;\n+\t}\n     }\n \n   if (spec)"}, {"sha": "892583e2329df3022ad453f8ae8f82f1213f6769", "filename": "gcc/cppfiles.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fcppfiles.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fcppfiles.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppfiles.c?ref=182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "patch": "@@ -318,9 +318,12 @@ stack_include_file (pfile, inc)\n   sysp = MAX ((pfile->map ? pfile->map->sysp : 0),\n \t      (inc->foundhere ? inc->foundhere->sysp : 0));\n \n-  /* For -M, add the file to the dependencies on its first inclusion.  */\n+  /* Add the file to the dependencies on its first inclusion.  */\n   if (CPP_OPTION (pfile, deps.style) > !!sysp && !inc->include_count)\n-    deps_add_dep (pfile->deps, inc->name);\n+    {\n+      if (pfile->buffer || CPP_OPTION (pfile, deps.ignore_main_file) == 0)\n+\tdeps_add_dep (pfile->deps, inc->name);\n+    }\n \n   /* Not in cache?  */\n   if (! inc->buffer)"}, {"sha": "3d2cac707b53522459c9ecc1bf31aa7cff3607b3", "filename": "gcc/cpplib.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fcpplib.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fcpplib.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpplib.h?ref=182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "patch": "@@ -387,6 +387,9 @@ struct cpp_options\n     /* Generate phony targets for each dependency apart from the first\n        one.  */\n     bool phony_targets;\n+\n+    /* If true, no dependency is generated on the main file.  */\n+    bool ignore_main_file;\n   } deps;\n \n   /* Target-specific features set by the front end or client.  */"}, {"sha": "7a913f15903c411bf47f9556ea6ac03b2dfeb9a5", "filename": "gcc/doc/cppenv.texi", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fdoc%2Fcppenv.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/182d89a3e9e9477e6fd7fae846e2033ee6e287cd/gcc%2Fdoc%2Fcppenv.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fcppenv.texi?ref=182d89a3e9e9477e6fd7fae846e2033ee6e287cd", "patch": "@@ -72,7 +72,8 @@ with an optional @option{-MT} switch too.\n @cindex dependencies for make as output\n This variable is the same as @env{DEPENDENCIES_OUTPUT} (see above),\n except that system header files are not ignored, so it implies\n-@option{-M} rather than @option{-MM}.\n+@option{-M} rather than @option{-MM}.  However, the dependence on the\n+main input file is omitted.\n @ifset cppmanual\n @xref{Invocation}.\n @end ifset"}]}