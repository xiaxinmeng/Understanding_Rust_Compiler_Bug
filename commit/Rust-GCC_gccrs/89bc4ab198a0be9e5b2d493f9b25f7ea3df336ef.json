{"sha": "89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODliYzRhYjE5OGEwYmU5ZTViMmQ0OTNmOWIyNWY3ZWEzZGYzMzZlZg==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2018-07-04T16:56:21Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2018-07-04T16:56:21Z"}, "message": "Define \"random_device\" effective target\n\nCurrently only matches targets where _GLIBCXX_USE_RANDOM_TR1 is defined,\nwhich means /dev/random and /dev/urandom are usable.\n\n\t* testsuite/25_algorithms/make_heap/complexity.cc: Require effective\n\ttarget for std::random_device.\n\t* testsuite/26_numerics/random/random_device/cons/default.cc:\n\tLikewise.\n\t* testsuite/experimental/algorithm/sample-2.cc: Likewise.\n\t* testsuite/experimental/algorithm/shuffle.cc: Likewise.\n\t* testsuite/experimental/random/randint.cc: Likewise.\n\t* testsuite/lib/libstdc++.exp\n\t(check_effective_target_random_device): New proc.\n\nFrom-SVN: r262415", "tree": {"sha": "0080ada44473f1044e2754a7727460e7bf6055ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0080ada44473f1044e2754a7727460e7bf6055ea"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4e4120a27ac1e2abd4a5309aefcc4ba0dac45784", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e4120a27ac1e2abd4a5309aefcc4ba0dac45784", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e4120a27ac1e2abd4a5309aefcc4ba0dac45784"}], "stats": {"total": 45, "additions": 45, "deletions": 0}, "files": [{"sha": "24acd68751b63a6f85bbece789ab1b55efd88879", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "patch": "@@ -1,3 +1,15 @@\n+2018-07-04  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\t* testsuite/25_algorithms/make_heap/complexity.cc: Require effective\n+\ttarget for std::random_device.\n+\t* testsuite/26_numerics/random/random_device/cons/default.cc:\n+\tLikewise.\n+\t* testsuite/experimental/algorithm/sample-2.cc: Likewise.\n+\t* testsuite/experimental/algorithm/shuffle.cc: Likewise.\n+\t* testsuite/experimental/random/randint.cc: Likewise.\n+\t* testsuite/lib/libstdc++.exp\n+\t(check_effective_target_random_device): New proc.\n+\n 2018-07-04  Jonathan Wakely  <jwakely@redhat.com>\n \t    Jakub Jelinek  <jakub@redhat.com>\n "}, {"sha": "069d2d0433d1d9e56012c4f85ed0eec50012680b", "filename": "libstdc++-v3/testsuite/25_algorithms/make_heap/complexity.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2F25_algorithms%2Fmake_heap%2Fcomplexity.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2F25_algorithms%2Fmake_heap%2Fcomplexity.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F25_algorithms%2Fmake_heap%2Fcomplexity.cc?ref=89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "patch": "@@ -16,6 +16,7 @@\n // <http://www.gnu.org/licenses/>.\n \n // { dg-do run { target c++11 } }\n+// { dg-require-effective-target random_device }\n \n #include <random>\n #include <vector>"}, {"sha": "5a34526a5f75904a9d995d8aa5501ca25cb1816c", "filename": "libstdc++-v3/testsuite/26_numerics/random/random_device/cons/default.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Frandom_device%2Fcons%2Fdefault.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Frandom_device%2Fcons%2Fdefault.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F26_numerics%2Frandom%2Frandom_device%2Fcons%2Fdefault.cc?ref=89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "patch": "@@ -1,4 +1,5 @@\n // { dg-do run { target c++11 } }\n+// { dg-require-effective-target random_device }\n // { dg-require-cstdint \"\" }\n //\n // 2008-11-24  Edward M. Smith-Rowland <3dw4rd@verizon.net>"}, {"sha": "ef3f7daa14ca75aceac3fab2ffe168d6866479c1", "filename": "libstdc++-v3/testsuite/experimental/algorithm/sample-2.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Falgorithm%2Fsample-2.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Falgorithm%2Fsample-2.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Falgorithm%2Fsample-2.cc?ref=89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "patch": "@@ -16,6 +16,7 @@\n // <http://www.gnu.org/licenses/>.\n \n // { dg-do run { target c++14 } }\n+// { dg-require-effective-target random_device }\n // { dg-require-effective-target tls_runtime }\n // { dg-add-options tls }\n "}, {"sha": "db958f600d4bd2b7f7beb3dbbcdb05b3e5c96e35", "filename": "libstdc++-v3/testsuite/experimental/algorithm/shuffle.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Falgorithm%2Fshuffle.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Falgorithm%2Fshuffle.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Falgorithm%2Fshuffle.cc?ref=89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "patch": "@@ -1,4 +1,5 @@\n // { dg-do run { target c++14 } }\n+// { dg-require-effective-target random_device }\n // { dg-require-effective-target tls_runtime }\n // { dg-add-options tls }\n "}, {"sha": "90ba72ac2fc54742f06a68fa2c077ac1f23caeba", "filename": "libstdc++-v3/testsuite/experimental/random/randint.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Frandom%2Frandint.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Frandom%2Frandint.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Frandom%2Frandint.cc?ref=89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "patch": "@@ -1,4 +1,5 @@\n // { dg-do run { target c++14 } }\n+// { dg-require-effective-target random_device }\n // { dg-require-effective-target tls_runtime }\n // { dg-add-options tls }\n "}, {"sha": "d8717e402df9ad0b7fe775f633fa6f438d5b31b0", "filename": "libstdc++-v3/testsuite/lib/libstdc++.exp", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Flib%2Flibstdc%2B%2B.exp?ref=89bc4ab198a0be9e5b2d493f9b25f7ea3df336ef", "patch": "@@ -2061,6 +2061,34 @@ proc check_effective_target_cxx11-abi { } {\n     return 0\n }\n \n+# Return 1 if std::random_device should be usable using the current flags, 0 otherwise.\n+proc check_effective_target_random_device { } {\n+    global cxxflags\n+\n+    # Set up and preprocess a C++ test program that depends\n+    # on std::random_device being usable.\n+    set src random_device[pid].cc\n+\n+    set f [open $src \"w\"]\n+    puts $f \"#include <bits/c++config.h>\"\n+    puts $f \"#if ! _GLIBCXX_USE_RANDOM_TR1\"\n+    puts $f \"#  error No working std::random_device available\"\n+    puts $f \"#endif\"\n+    close $f\n+\n+    set lines [v3_target_compile $src /dev/null preprocess \"\"]\n+    file delete $src\n+\n+    if [string match \"\" $lines] {\n+\t# No error message, preprocessing succeeded.\n+\tverbose \"check_v3_random_device: `1'\" 2\n+\treturn 1\n+    }\n+\n+    verbose \"check_v3_random_device: `0'\" 2\n+    return 0\n+}\n+\n set additional_prunes \"\"\n \n if { [info exists env(GCC_RUNTEST_PARALLELIZE_DIR)] \\"}]}