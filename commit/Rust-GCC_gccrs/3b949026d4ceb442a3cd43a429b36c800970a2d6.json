{"sha": "3b949026d4ceb442a3cd43a429b36c800970a2d6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2I5NDkwMjZkNGNlYjQ0MmEzY2Q0M2E0MjliMzZjODAwOTcwYTJkNg==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2018-09-11T15:59:07Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2018-09-11T15:59:07Z"}, "message": "re PR fortran/87277 (Segfault on using array component of class scalar pointer as an actual argument)\n\n2018-09-11  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/87277\n\t* expr.c (is_subref_array): Add the check of dimensionality for\n\tclass, dummy, pointer arrays.\n\n2018-09-11  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/87277\n\t* gfortran.dg/select_type_43.f90: New test.\n\nFrom-SVN: r264210", "tree": {"sha": "8a737b03c80de2c8d93933de4496f1802a084c29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a737b03c80de2c8d93933de4496f1802a084c29"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3b949026d4ceb442a3cd43a429b36c800970a2d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b949026d4ceb442a3cd43a429b36c800970a2d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b949026d4ceb442a3cd43a429b36c800970a2d6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b949026d4ceb442a3cd43a429b36c800970a2d6/comments", "author": null, "committer": null, "parents": [{"sha": "b34e743c9c7a530c102c0c6bb1737ff2a0528da0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b34e743c9c7a530c102c0c6bb1737ff2a0528da0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b34e743c9c7a530c102c0c6bb1737ff2a0528da0"}], "stats": {"total": 60, "additions": 60, "deletions": 0}, "files": [{"sha": "c02276f7537e1291bb47fd2f55f85b17487c93ca", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=3b949026d4ceb442a3cd43a429b36c800970a2d6", "patch": "@@ -1,3 +1,9 @@\n+2018-09-11  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/87277\n+\t* expr.c (is_subref_array): Add the check of dimensionality for\n+\tclass, dummy, pointer arrays.\n+\n 2018-09-11  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/86830"}, {"sha": "3315bb840af09492f70693f70fc1867d4c87578c", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=3b949026d4ceb442a3cd43a429b36c800970a2d6", "patch": "@@ -1069,6 +1069,7 @@ is_subref_array (gfc_expr * e)\n \n   if (e->symtree->n.sym->ts.type == BT_CLASS\n       && e->symtree->n.sym->attr.dummy\n+      && CLASS_DATA (e->symtree->n.sym)->attr.dimension\n       && CLASS_DATA (e->symtree->n.sym)->attr.class_pointer)\n     return true;\n "}, {"sha": "3e35910699bc113c2665a3c222882e5a0642b01f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3b949026d4ceb442a3cd43a429b36c800970a2d6", "patch": "@@ -1,3 +1,8 @@\n+2018-09-11  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/87277\n+\t* gfortran.dg/select_type_43.f90: New test.\n+\n 2018-09-11  Nathan Sidwell  <nathan@acm.org>\n \n \t* gcc.dg/driver-specs.c: New."}, {"sha": "3bb71c399189f2c2e0451af8650911c4b353c39c", "filename": "gcc/testsuite/gfortran.dg/select_type_43.f90", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ftestsuite%2Fgfortran.dg%2Fselect_type_43.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b949026d4ceb442a3cd43a429b36c800970a2d6/gcc%2Ftestsuite%2Fgfortran.dg%2Fselect_type_43.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fselect_type_43.f90?ref=3b949026d4ceb442a3cd43a429b36c800970a2d6", "patch": "@@ -0,0 +1,48 @@\n+! { dg-do run }\n+!\n+! Tests the fix for PR87277 - runtime segfault as indicated.\n+!\n+! Contributed by Andrew Baldwin on clf.\n+!\n+      MODULE INTS_TYPE_MODULE\n+        TYPE INTS_TYPE\n+          INTEGER, ALLOCATABLE :: INTS(:)\n+        END TYPE INTS_TYPE\n+      CONTAINS\n+        SUBROUTINE ALLOCATE_INTS_TYPE (IT_OBJ)\n+          CLASS (INTS_TYPE), POINTER, INTENT (OUT) :: IT_OBJ\n+\n+          ALLOCATE (INTS_TYPE :: IT_OBJ)\n+\n+          SELECT TYPE (IT_OBJ)\n+          TYPE IS (INTS_TYPE)\n+            CALL ALLOCATE_ARRAY (IT_OBJ%INTS) ! Sefaulted at runtime here.\n+            if (.not.allocated (IT_OBJ%INTS)) stop 1\n+            if (any (IT_OBJ%INTS .ne. [1,2,3,4])) stop 2\n+          END SELECT\n+\n+          RETURN\n+        END SUBROUTINE ALLOCATE_INTS_TYPE\n+\n+        SUBROUTINE ALLOCATE_ARRAY (ALLOC_ARR)\n+          INTEGER, ALLOCATABLE, INTENT (OUT) :: ALLOC_ARR(:)\n+          INTEGER :: I\n+\n+          ALLOCATE (ALLOC_ARR(4))\n+\n+          DO I = 1, SIZE(ALLOC_ARR)\n+            ALLOC_ARR(I) = I\n+          END DO\n+\n+          RETURN\n+        END SUBROUTINE ALLOCATE_ARRAY\n+      END MODULE INTS_TYPE_MODULE\n+\n+      PROGRAM MFE\n+        USE INTS_TYPE_MODULE\n+        IMPLICIT NONE\n+\n+        CLASS (INTS_TYPE), POINTER :: IT_OBJ\n+\n+        CALL ALLOCATE_INTS_TYPE (IT_OBJ)\n+      END PROGRAM MFE"}]}