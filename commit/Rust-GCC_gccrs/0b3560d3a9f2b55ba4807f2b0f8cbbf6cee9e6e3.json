{"sha": "0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGIzNTYwZDNhOWYyYjU1YmE0ODA3ZjJiMGY4Y2JiZjZjZWU5ZTZlMw==", "commit": {"author": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2021-07-30T17:41:02Z"}, "committer": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2021-07-30T17:44:09Z"}, "message": "Move failed part of a test to a new file [PR101671]\n\nRelated:\nPR middle-end/101671 - pr83510 fails with -Os because threader confuses -Warray-bounds\n\ngcc/testsuite:\n\tPR middle-end/101671\n\t* gcc.c-torture/compile/pr83510.c: Move test functions...\n\t* gcc.dg/Warray-bounds-87.c: ...to this file.", "tree": {"sha": "4e96674961a934faf161c2c1eb6cad344146f348", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4e96674961a934faf161c2c1eb6cad344146f348"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3/comments", "author": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e5e164effa30fd2b5c5bc3e6883d63889e96d8da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5e164effa30fd2b5c5bc3e6883d63889e96d8da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e5e164effa30fd2b5c5bc3e6883d63889e96d8da"}], "stats": {"total": 73, "additions": 48, "deletions": 25}, "files": [{"sha": "7f222fa9bdb5b803fa10aefe72bc6db6425e0119", "filename": "gcc/testsuite/gcc.c-torture/compile/pr83510.c", "status": "modified", "additions": 0, "deletions": 25, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr83510.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr83510.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr83510.c?ref=0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3", "patch": "@@ -3,8 +3,6 @@\n    (PR tree-optimization/83510).  */\n \n /* { dg-options \"-Warray-bounds\" } */\n-/* { dg-xfail-if \"\" { \"*-*-*\" } { \"-Os\" } } */\n-\n \n /*  This test is XFAILed because thread1 threads a switch statement\n     such that the various cases have been split into different\n@@ -70,19 +68,6 @@ int g(struct xyz * ctx) {\n   return 0;\n }\n \n-static unsigned int f_signed(struct xyz * ctx, int number)\n-{\n-  switch (number) {\n-  case 0x9:\n-    return ctx->a0;\n-  case 0xA: case 0xB:\n-  case 0xC: case 0xD: case 0xE: case 0xF:\n-  case 0x10: case 0x11: case 0x12: case 0x13:\n-    return arr[number];\n-  }\n-  return 0;\n-}\n-\n int g_signed(struct xyz * ctx) {\n   int i;\n \n@@ -103,16 +88,6 @@ void test_2 (struct xyz * ctx)\n   }\n }\n \n-void test_2_signed (struct xyz * ctx)\n-{\n-  int i;\n-\n-  for (i = 0; i < 10; i++) {\n-    if (get_flag ())\n-      wfm(ctx, i, f_signed(ctx, i));\n-  }\n-}\n-\n void test_3 (struct xyz * ctx)\n {\n   unsigned int i;"}, {"sha": "a49874df5da4106a0549128129329d0c81a22cc1", "filename": "gcc/testsuite/gcc.dg/Warray-bounds-87.c", "status": "added", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3/gcc%2Ftestsuite%2Fgcc.dg%2FWarray-bounds-87.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3/gcc%2Ftestsuite%2Fgcc.dg%2FWarray-bounds-87.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2FWarray-bounds-87.c?ref=0b3560d3a9f2b55ba4807f2b0f8cbbf6cee9e6e3", "patch": "@@ -0,0 +1,48 @@\n+/* PR middle-end/101671 - pr83510 fails with -Os because threader confuses\n+   -Warray-bounds\n+   { dg-do compile }\n+   { dg-options \"-Os -Wall\" } */\n+\n+extern int f (void);\n+extern void sink (unsigned int);\n+\n+unsigned int a[10];\n+\n+static unsigned int g (int i, int j)\n+{\n+  if (i == 9)\n+    return j;\n+  else if (i == 10)\n+    return a[i];    // no warning here\n+  return 0;\n+}\n+\n+void test_g (int j)\n+{\n+  for (int i = 0; i < 10; i++)\n+    {\n+      if (f ())\n+\tsink (g (i, j));\n+    }\n+}\n+\n+static unsigned int h (int i, int j)\n+{\n+  switch (i)\n+    {\n+    case 9:\n+      return j;\n+    case 10:\n+      return a[i];  // { dg-bogus \"-Warray-bounds\" \"pr101671\" { xfail *-*-* } }\n+    }\n+  return 0;\n+}\n+\n+void test_h (int j)\n+{\n+  for (int i = 0; i < 10; i++)\n+    {\n+      if (f ())\n+\tsink (h (i, j));\n+    }\n+}"}]}