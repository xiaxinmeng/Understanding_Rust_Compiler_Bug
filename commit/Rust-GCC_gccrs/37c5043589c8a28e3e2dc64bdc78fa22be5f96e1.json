{"sha": "37c5043589c8a28e3e2dc64bdc78fa22be5f96e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzdjNTA0MzU4OWM4YTI4ZTNlMmRjNjRiZGM3OGZhMjJiZTVmOTZlMQ==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2009-05-20T13:32:14Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2009-05-20T13:32:14Z"}, "message": "driver-i386.c (host_detect_local_cpu): Check extended family and model for Intel processors.\n\n2009-05-20  H.J. Lu  <hongjiu.lu@intel.com>\n\n\t* config/i386/driver-i386.c (host_detect_local_cpu): Check\n\textended family and model for Intel processors.  Support Intel\n\tAtom.\n\nFrom-SVN: r147736", "tree": {"sha": "41964ad742db29084178987a593e112ec35cd908", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41964ad742db29084178987a593e112ec35cd908"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "dbb6088f89fe3cc22845097dc17f9f6a06682be1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dbb6088f89fe3cc22845097dc17f9f6a06682be1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dbb6088f89fe3cc22845097dc17f9f6a06682be1"}], "stats": {"total": 25, "additions": 22, "deletions": 3}, "files": [{"sha": "4ac176ddec20fee5b40756f694cbf870349b25c1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=37c5043589c8a28e3e2dc64bdc78fa22be5f96e1", "patch": "@@ -1,3 +1,9 @@\n+2009-05-20  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\t* config/i386/driver-i386.c (host_detect_local_cpu): Check\n+\textended family and model for Intel processors.  Support Intel\n+\tAtom.\n+\n 2009-05-20  Olivier Hainque  <hainque@adacore.com>\n \n \t* gstab.h (stab_code_type): Define, to be used instead of the"}, {"sha": "d4ba466d225e91bc6a3121645d559acee74fc537", "filename": "gcc/config/i386/driver-i386.c", "status": "modified", "additions": 16, "deletions": 3, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1/gcc%2Fconfig%2Fi386%2Fdriver-i386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37c5043589c8a28e3e2dc64bdc78fa22be5f96e1/gcc%2Fconfig%2Fi386%2Fdriver-i386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fdriver-i386.c?ref=37c5043589c8a28e3e2dc64bdc78fa22be5f96e1", "patch": "@@ -395,9 +395,22 @@ const char *host_detect_local_cpu (int argc, const char **argv)\n \n   __cpuid (1, eax, ebx, ecx, edx);\n \n-  /* We don't care for extended family.  */\n   model = (eax >> 4) & 0x0f;\n   family = (eax >> 8) & 0x0f;\n+  if (vendor == SIG_INTEL)\n+    {\n+      unsigned int extended_model, extended_family;\n+\n+      extended_model = (eax >> 12) & 0xf0;\n+      extended_family = (eax >> 20) & 0xff;\n+      if (family == 0x0f)\n+\t{\n+\t  family += extended_family;\n+\t  model += extended_model;\n+\t}\n+      else if (family == 0x06)\n+\tmodel += extended_model;\n+    }\n \n   has_sse3 = ecx & bit_SSE3;\n   has_ssse3 = ecx & bit_SSSE3;\n@@ -496,8 +509,8 @@ const char *host_detect_local_cpu (int argc, const char **argv)\n       break;\n     case PROCESSOR_PENTIUMPRO:\n       if (has_longmode)\n-\t/* It is Core 2 Duo.  */\n-\tcpu = \"core2\";\n+\t/* It is Core 2 or Atom.  */\n+\tcpu = (model == 28) ? \"atom\" : \"core2\";\n       else if (arch)\n \t{\n \t  if (has_sse3)"}]}