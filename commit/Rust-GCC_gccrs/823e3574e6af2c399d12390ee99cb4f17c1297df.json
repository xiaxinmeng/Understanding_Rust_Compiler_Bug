{"sha": "823e3574e6af2c399d12390ee99cb4f17c1297df", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODIzZTM1NzRlNmFmMmMzOTlkMTIzOTBlZTk5Y2I0ZjE3YzEyOTdkZg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2001-07-09T18:56:00Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2001-07-09T18:56:00Z"}, "message": "emit-rtl.c (adjust_address, [...]): Handle an address that is a LO_SUM specially.\n\n\t* emit-rtl.c (adjust_address, adjust_address_nv): Handle an\n\taddress that is a LO_SUM specially.\n\t* explow.c (plus_constant_wide, case LO_SUM): Deleted.\n\nFrom-SVN: r43866", "tree": {"sha": "d13565676d9fd2c3a4a8cf406c20a5d7144cffe7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d13565676d9fd2c3a4a8cf406c20a5d7144cffe7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/823e3574e6af2c399d12390ee99cb4f17c1297df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/823e3574e6af2c399d12390ee99cb4f17c1297df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/823e3574e6af2c399d12390ee99cb4f17c1297df", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/823e3574e6af2c399d12390ee99cb4f17c1297df/comments", "author": null, "committer": null, "parents": [{"sha": "60a97cd4c44ef5a2f70d5596e9c62482d802d977", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60a97cd4c44ef5a2f70d5596e9c62482d802d977", "html_url": "https://github.com/Rust-GCC/gccrs/commit/60a97cd4c44ef5a2f70d5596e9c62482d802d977"}], "stats": {"total": 37, "additions": 28, "deletions": 9}, "files": [{"sha": "18539e6cc270f4d777203fb7168766d7440aba3d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/823e3574e6af2c399d12390ee99cb4f17c1297df/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/823e3574e6af2c399d12390ee99cb4f17c1297df/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=823e3574e6af2c399d12390ee99cb4f17c1297df", "patch": "@@ -1,5 +1,9 @@\n Mon Jul  9 06:41:07 2001  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n+\t* emit-rtl.c (adjust_address, adjust_address_nv): Handle an\n+\taddress that is a LO_SUM specially.\n+\t* explow.c (plus_constant_wide, case LO_SUM): Deleted.\n+\n \t* c-lang.c (start_cdtor): Remove extra parameter from start_function.\n \n \t* emit-rtl.c (adjust_address_nv, replace_equiv_address_nv): New fcns."}, {"sha": "4187468538da38d4f58cc05f379486f8a058615f", "filename": "gcc/emit-rtl.c", "status": "modified", "additions": 24, "deletions": 4, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/823e3574e6af2c399d12390ee99cb4f17c1297df/gcc%2Femit-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/823e3574e6af2c399d12390ee99cb4f17c1297df/gcc%2Femit-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.c?ref=823e3574e6af2c399d12390ee99cb4f17c1297df", "patch": "@@ -1612,8 +1612,18 @@ adjust_address (memref, mode, offset)\n {\n   /* For now, this is just a wrapper for change_address, but eventually\n      will do memref tracking.  */\n-  return\n-    change_address (memref, mode, plus_constant (XEXP (memref, 0), offset));\n+  rtx addr = XEXP (memref, 0);\n+\n+  /* If MEMREF is a LO_SUM and the offset is within the size of the\n+     object, we can merge it into the LO_SUM.  */\n+  if (GET_MODE (memref) != BLKmode && GET_CODE (addr) == LO_SUM\n+      && offset >= 0 && offset < GET_MODE_SIZE (GET_MODE (memref)))\n+    addr = gen_rtx_LO_SUM (mode, XEXP (addr, 0),\n+\t\t\t   plus_constant (XEXP (addr, 1), offset));\n+  else\n+    addr = plus_constant (addr, offset);\n+\n+  return change_address (memref, mode, addr);\n }\n \n /* Likewise, but the reference is not required to be valid.  */\n@@ -1626,8 +1636,18 @@ adjust_address_nv (memref, mode, offset)\n {\n   /* For now, this is just a wrapper for change_address, but eventually\n      will do memref tracking.  */\n-  return change_address_1 (memref, mode,\n-\t\t\t   plus_constant (XEXP (memref, 0), offset), 0);\n+  rtx addr = XEXP (memref, 0);\n+\n+  /* If MEMREF is a LO_SUM and the offset is within the size of the\n+     object, we can merge it into the LO_SUM.  */\n+  if (GET_MODE (memref) != BLKmode && GET_CODE (addr) == LO_SUM\n+      && offset >= 0 && offset < GET_MODE_SIZE (GET_MODE (memref)))\n+    addr = gen_rtx_LO_SUM (mode, XEXP (addr, 0),\n+\t\t\t   plus_constant (XEXP (addr, 1), offset));\n+  else\n+    addr = plus_constant (addr, offset);\n+\n+  return change_address_1 (memref, mode, addr, 0);\n }\n \n /* Return a memory reference like MEMREF, but with its address changed to"}, {"sha": "cafbf2e2afade5959d5cdfc0a720fc85144acfa9", "filename": "gcc/explow.c", "status": "modified", "additions": 0, "deletions": 5, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/823e3574e6af2c399d12390ee99cb4f17c1297df/gcc%2Fexplow.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/823e3574e6af2c399d12390ee99cb4f17c1297df/gcc%2Fexplow.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexplow.c?ref=823e3574e6af2c399d12390ee99cb4f17c1297df", "patch": "@@ -180,11 +180,6 @@ plus_constant_wide (x, c)\n \t}\n       break;\n \n-    case LO_SUM:\n-      return gen_rtx_LO_SUM (mode, XEXP (x, 0),\n-\t\t\t     plus_constant (XEXP (x, 1), c));\n-\n-      \n     default:\n       break;\n     }"}]}