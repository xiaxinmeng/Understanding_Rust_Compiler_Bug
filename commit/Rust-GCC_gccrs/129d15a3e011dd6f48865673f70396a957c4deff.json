{"sha": "129d15a3e011dd6f48865673f70396a957c4deff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTI5ZDE1YTNlMDExZGQ2ZjQ4ODY1NjczZjcwMzk2YTk1N2M0ZGVmZg==", "commit": {"author": {"name": "Janus Weil", "email": "jaydub66@gmail.com", "date": "2007-08-22T21:11:13Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2007-08-22T21:11:13Z"}, "message": "decl.c (match_attr_spec): Pass on errors from gfc_match_bind_c.\n\n2007-08-22  Janus Weil  <jaydub66@gmail.com>\n\n\t* decl.c (match_attr_spec): Pass on errors from gfc_match_bind_c.\n\t(gfc_match_bind_c): Bugfix in check for NAME= with abstract interfaces.\n\t(gfc_match_mopdproc): Bugfix to reject module procedures in\n\tabstract interfaces.\n\n2007-08-22  Janus Weil  <jaydub66@gmail.com>\n\n\t* interface_abstract_1.f90: Extended test case.\n\t* interface_abstract_3.f90: New test.\n\nFrom-SVN: r127718", "tree": {"sha": "173c6a444df12265712ebd7e0ceddf0ff276c15c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/173c6a444df12265712ebd7e0ceddf0ff276c15c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/129d15a3e011dd6f48865673f70396a957c4deff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/129d15a3e011dd6f48865673f70396a957c4deff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/129d15a3e011dd6f48865673f70396a957c4deff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/129d15a3e011dd6f48865673f70396a957c4deff/comments", "author": null, "committer": null, "parents": [{"sha": "f11b235171696c8b04a850fa071a6d251b3cd533", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f11b235171696c8b04a850fa071a6d251b3cd533", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f11b235171696c8b04a850fa071a6d251b3cd533"}], "stats": {"total": 40, "additions": 37, "deletions": 3}, "files": [{"sha": "346e81197e9da8d38a168cfaa87e4c5ba6361644", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=129d15a3e011dd6f48865673f70396a957c4deff", "patch": "@@ -1,3 +1,10 @@\n+2007-08-22  Janus Weil  <jaydub66@gmail.com>\n+\n+\t* decl.c (match_attr_spec): Pass on errors from gfc_match_bind_c.\n+\t(gfc_match_bind_c): Bugfix in check for NAME= with abstract interfaces.\n+\t(gfc_match_mopdproc): Bugfix to reject module procedures in\n+\tabstract interfaces.\n+\n 2007-08-22  Kai Tietz  <kai.tietz@onevision.com>\n \n \t* f95-lang.c: (gfc_init_decl_processing): Choose sizetype by using"}, {"sha": "2a80841d5dff3fe0771f6dd1e2a58deac957dfd5", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=129d15a3e011dd6f48865673f70396a957c4deff", "patch": "@@ -2549,8 +2549,11 @@ match_attr_spec (void)\n \t      /* Chomp the comma.  */\n \t      peek_char = gfc_next_char ();\n \t      /* Try and match the bind(c).  */\n-\t      if (gfc_match_bind_c (NULL) == MATCH_YES)\n+\t      m = gfc_match_bind_c (NULL);\n+\t      if (m == MATCH_YES)\n \t\td = DECL_IS_BIND_C;\n+\t      else if (m == MATCH_ERROR)\n+\t\tgoto cleanup;\n \t    }\n \t}\n \n@@ -4183,7 +4186,8 @@ gfc_match_bind_c (gfc_symbol *sym)\n \tstrncpy (sym->binding_label, sym->name, strlen (sym->name) + 1);\n     }\n \n-  if (has_name_equals && current_interface.type == INTERFACE_ABSTRACT)\n+  if (has_name_equals && gfc_current_state () == COMP_INTERFACE\n+      && current_interface.type == INTERFACE_ABSTRACT)\n     {\n       gfc_error (\"NAME not allowed on BIND(C) for ABSTRACT INTERFACE at %C\");\n       return MATCH_ERROR;\n@@ -5327,7 +5331,8 @@ gfc_match_modproc (void)\n \n   if (gfc_state_stack->state != COMP_INTERFACE\n       || gfc_state_stack->previous == NULL\n-      || current_interface.type == INTERFACE_NAMELESS)\n+      || current_interface.type == INTERFACE_NAMELESS\n+      || current_interface.type == INTERFACE_ABSTRACT)\n     {\n       gfc_error (\"MODULE PROCEDURE at %C must be in a generic module \"\n \t\t \"interface\");"}, {"sha": "cf9b7edb91e566ddb787bf46ad80016a254c42dc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=129d15a3e011dd6f48865673f70396a957c4deff", "patch": "@@ -1,3 +1,8 @@\n+2007-08-22  Janus Weil  <jaydub66@gmail.com>\n+\n+\t* interface_abstract_1.f90: Extended test case.\n+\t* interface_abstract_3.f90: New test.\n+\n 2007-08-21  Christian Bruel  <christian.bruel@st.com>\n \n \t* gcc.dg/fold-sub.c: New test."}, {"sha": "ab816bff7a147dcef175ec4909ee09c26c5a7074", "filename": "gcc/testsuite/gfortran.dg/interface_abstract_1.f90", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_abstract_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_abstract_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_abstract_1.f90?ref=129d15a3e011dd6f48865673f70396a957c4deff", "patch": "@@ -12,4 +12,10 @@ end subroutine three ! { dg-error \"Expecting END INTERFACE statement\" }\n   subroutine real() ! { dg-error \"cannot be the same as an intrinsic type\" }\n   end subroutine real\n end interface\n+\n+contains\n+\n+  subroutine sub() bind(C,name=\"subC\")\n+  end subroutine\n+\n end"}, {"sha": "3008d1040156b1ef1aab233bfbcb49a8b2296d4a", "filename": "gcc/testsuite/gfortran.dg/interface_abstract_3.f90", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_abstract_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/129d15a3e011dd6f48865673f70396a957c4deff/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_abstract_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_abstract_3.f90?ref=129d15a3e011dd6f48865673f70396a957c4deff", "patch": "@@ -0,0 +1,11 @@\n+! { dg-do compile }\n+! test for C1204 of Fortran 2003 standard:\n+! module procedure not allowed in abstract interface\n+module m\n+  abstract interface\n+     module procedure p\t! { dg-error \"must be in a generic module interface\" }\n+  end interface\n+contains\n+  subroutine p()\n+  end subroutine\n+end module m"}]}