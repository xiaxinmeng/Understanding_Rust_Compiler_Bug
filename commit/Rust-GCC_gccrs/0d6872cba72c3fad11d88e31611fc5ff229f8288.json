{"sha": "0d6872cba72c3fad11d88e31611fc5ff229f8288", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGQ2ODcyY2JhNzJjM2ZhZDExZDg4ZTMxNjExZmM1ZmYyMjlmODI4OA==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2008-11-12T06:59:33Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2008-11-12T06:59:33Z"}, "message": "re PR fortran/38065 (private/public confusion with a contained function)\n\n2008-11-12  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/38065\n        * resolve.c (resolve_fntype): Fix private derived type checking.\n\n2008-11-12  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/38065\n        * gfortran.dg/private_type_11.f90: New test.\n        * gfortran.dg/private_type_12.f90: New test.\n\nFrom-SVN: r141780", "tree": {"sha": "3bc328af46b43b81b7b2cbe50863b22eb7139db9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3bc328af46b43b81b7b2cbe50863b22eb7139db9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0d6872cba72c3fad11d88e31611fc5ff229f8288", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d6872cba72c3fad11d88e31611fc5ff229f8288", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d6872cba72c3fad11d88e31611fc5ff229f8288", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d6872cba72c3fad11d88e31611fc5ff229f8288/comments", "author": null, "committer": null, "parents": [{"sha": "8a4d68e36d780eed4f469782486a52114a786000", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a4d68e36d780eed4f469782486a52114a786000", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a4d68e36d780eed4f469782486a52114a786000"}], "stats": {"total": 71, "additions": 65, "deletions": 6}, "files": [{"sha": "0b1253914b34422b58813e7c8e70d13006e240bc", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=0d6872cba72c3fad11d88e31611fc5ff229f8288", "patch": "@@ -1,7 +1,12 @@\n+2008-11-12  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/38065\n+\t* resolve.c (resolve_fntype): Fix private derived type checking.\n+\n 2008-11-09  Paul Thomas  <pault@gcc.gnu.org>\n \n-        PR fortran/37836\n-        * intrinsic.c (add_functions): Reference gfc_simplify._minval\n+\tPR fortran/37836\n+\t* intrinsic.c (add_functions): Reference gfc_simplify._minval\n \tand gfc_simplify_maxval.\n \t* intrinsic.h : Add prototypes for gfc_simplify._minval and\n \tgfc_simplify_maxval.\n@@ -13,8 +18,8 @@\n \n 2008-11-04  Paul Thomas  <pault@gcc.gnu.org>\n \n-        PR fortran/37597\n-        * parse.c (gfc_fixup_sibling_symbols ): Fixup contained, even\n+\tPR fortran/37597\n+\t* parse.c (gfc_fixup_sibling_symbols ): Fixup contained, even\n \twhen symbol not found.\n \n 2008-11-03  Tobias Burnus  <burnus@net-b.de>"}, {"sha": "aae1ef784f4b6f7360f9911005cf0bbca9245042", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=0d6872cba72c3fad11d88e31611fc5ff229f8288", "patch": "@@ -10179,12 +10179,14 @@ resolve_fntype (gfc_namespace *ns)\n     }\n \n   if (sym->ts.type == BT_DERIVED && !sym->ts.derived->attr.use_assoc\n+      && !sym->attr.contained\n       && !gfc_check_access (sym->ts.derived->attr.access,\n \t\t\t    sym->ts.derived->ns->default_access)\n       && gfc_check_access (sym->attr.access, sym->ns->default_access))\n     {\n-      gfc_error (\"PUBLIC function '%s' at %L cannot be of PRIVATE type '%s'\",\n-\t\t sym->name, &sym->declared_at, sym->ts.derived->name);\n+      gfc_notify_std (GFC_STD_F2003, \"Fortran 2003: PUBLIC function '%s' at \"\n+\t\t      \"%L of PRIVATE type '%s'\", sym->name,\n+\t\t      &sym->declared_at, sym->ts.derived->name);\n     }\n \n     if (ns->entries)"}, {"sha": "df1cb8621f135f04a6b6f935de705a11fea5b37b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0d6872cba72c3fad11d88e31611fc5ff229f8288", "patch": "@@ -1,3 +1,9 @@\n+2008-11-12  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/38065\n+\t* gfortran.dg/private_type_11.f90: New test.\n+\t* gfortran.dg/private_type_12.f90: New test.\n+\n 2008-11-10  Catherine Moore  <clm@codesourcery.com>\n \n \t* gcc.target/mips/no-smartmips-lwxs.c: New test."}, {"sha": "53d5f4c705c03e3164a4314f86ddfc639b0d7ece", "filename": "gcc/testsuite/gfortran.dg/private_type_11.f90", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_11.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_11.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_11.f90?ref=0d6872cba72c3fad11d88e31611fc5ff229f8288", "patch": "@@ -0,0 +1,23 @@\n+! { dg-do compile }\n+! { dg-options \"-std=f2003\" }\n+! PR fortran/38065\n+!\n+! Reported by Norman S. Clerman\n+! and reduced by Joost VandeVondele\n+!\n+MODULE M1\n+  IMPLICIT NONE\n+  PRIVATE\n+  TYPE T1\n+   INTEGER :: I1\n+  END TYPE T1\n+  PUBLIC :: S1,F2\n+CONTAINS\n+  SUBROUTINE S1\n+  CONTAINS\n+   TYPE(T1) FUNCTION F1()\n+   END FUNCTION F1\n+  END SUBROUTINE S1\n+  TYPE(T1) FUNCTION F2()\n+  END FUNCTION F2\n+END MODULE M1"}, {"sha": "c9867bcf87ba1ce427d4cab37311f227a90e9aad", "filename": "gcc/testsuite/gfortran.dg/private_type_12.f90", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_12.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d6872cba72c3fad11d88e31611fc5ff229f8288/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_12.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_12.f90?ref=0d6872cba72c3fad11d88e31611fc5ff229f8288", "patch": "@@ -0,0 +1,23 @@\n+! { dg-do compile }\n+! { dg-options \"-std=f95\" }\n+! PR fortran/38065\n+!\n+! Reported by Norman S. Clerman\n+! and reduced by Joost VandeVondele\n+!\n+MODULE M1\n+  IMPLICIT NONE\n+  PRIVATE\n+  TYPE T1\n+   INTEGER :: I1\n+  END TYPE T1\n+  PUBLIC :: S1,F2\n+CONTAINS\n+  SUBROUTINE S1\n+  CONTAINS\n+   TYPE(T1) FUNCTION F1()\n+   END FUNCTION F1\n+  END SUBROUTINE S1\n+  TYPE(T1) FUNCTION F2() ! { dg-error \"Fortran 2003: PUBLIC variable 'f2'\" }\n+  END FUNCTION F2\n+END MODULE M1"}]}