{"sha": "2a134b7364cc5b6ed52edd00702240052aa8103c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmExMzRiNzM2NGNjNWI2ZWQ1MmVkZDAwNzAyMjQwMDUyYWE4MTAzYw==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2007-01-13T19:12:39Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2007-01-13T19:12:39Z"}, "message": "ipa-reference.c (analyze_function): Consider also addresses taken in phi nodes.\n\n\t* ipa-reference.c (analyze_function): Consider also addresses taken\n\tin phi nodes.\n\n\t* gcc.dg/20070112-1.c: New test.\n\nFrom-SVN: r120757", "tree": {"sha": "8446575dc0c1e9a3e001053e272f3a83237449b0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8446575dc0c1e9a3e001053e272f3a83237449b0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a134b7364cc5b6ed52edd00702240052aa8103c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a134b7364cc5b6ed52edd00702240052aa8103c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a134b7364cc5b6ed52edd00702240052aa8103c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a134b7364cc5b6ed52edd00702240052aa8103c/comments", "author": null, "committer": null, "parents": [{"sha": "8f0d85d6e81d481c61a70ec77d7f14c77c9d5921", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f0d85d6e81d481c61a70ec77d7f14c77c9d5921", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8f0d85d6e81d481c61a70ec77d7f14c77c9d5921"}], "stats": {"total": 50, "additions": 49, "deletions": 1}, "files": [{"sha": "e18dfd6f4b66c4011b7212f43ca864843afd9dd5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2a134b7364cc5b6ed52edd00702240052aa8103c", "patch": "@@ -1,3 +1,8 @@\n+2007-01-13  Zdenek Dvorak <dvorakz@suse.cz>\n+\n+\t* ipa-reference.c (analyze_function): Consider also addresses taken\n+\tin phi nodes.\n+\n 2007-01-12  Roger Sayle  <roger@eyesopen.com>\n \n \t* c-typeck.c (null_pointer_constant_p): Replace use of"}, {"sha": "b1ff849082e48473f0cd66c57c9df5dc16935909", "filename": "gcc/ipa-reference.c", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2Fipa-reference.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2Fipa-reference.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-reference.c?ref=2a134b7364cc5b6ed52edd00702240052aa8103c", "patch": "@@ -807,6 +807,21 @@ analyze_function (struct cgraph_node *fn)\n     FOR_EACH_BB_FN (this_block, this_cfun)\n       {\n \tblock_stmt_iterator bsi;\n+\ttree phi, op;\n+\tuse_operand_p use;\n+\tssa_op_iter iter;\n+\n+\t/* Find the addresses taken in phi node arguments.  */\n+\tfor (phi = phi_nodes (this_block); phi; phi = PHI_CHAIN (phi))\n+\t  {\n+\t    FOR_EACH_PHI_ARG (use, phi, iter, SSA_OP_USE)\n+\t      {\n+\t\top = USE_FROM_PTR (use);\n+\t\tif (TREE_CODE (op) == ADDR_EXPR)\n+\t\t  check_rhs_var (l, op);\n+\t      }\n+\t  }\n+\n \tfor (bsi = bsi_start (this_block); !bsi_end_p (bsi); bsi_next (&bsi))\n \t  walk_tree (bsi_stmt_ptr (bsi), scan_for_static_refs, \n \t\t     fn, visited_nodes);"}, {"sha": "7c3b7698730cd4e88a8fa5602c759213e544cabb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2a134b7364cc5b6ed52edd00702240052aa8103c", "patch": "@@ -1,11 +1,15 @@\n+2007-01-13  Zdenek Dvorak <dvorakz@suse.cz>\n+\n+\t* gcc.dg/20070112-1.c: New test.\n+\n 2007-01-12  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libgfortran/30435\n \t* gfortran.dg/list_read_6.f90: New test.\n \n 2007-01-12  Olga Golovanevsky  <olga@il.ibm.com>\n \n-        * gcc.dg/torture/pr24750-1.c:  Add prototype of free.\n+\t* gcc.dg/torture/pr24750-1.c:  Add prototype of free.\n \n 2007-01-12  Tom Tromey  <tromey@redhat.com>\n "}, {"sha": "bd783356764f65cb0c3e6b166f1988f1674e314c", "filename": "gcc/testsuite/gcc.dg/20070112-1.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2Ftestsuite%2Fgcc.dg%2F20070112-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a134b7364cc5b6ed52edd00702240052aa8103c/gcc%2Ftestsuite%2Fgcc.dg%2F20070112-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F20070112-1.c?ref=2a134b7364cc5b6ed52edd00702240052aa8103c", "patch": "@@ -0,0 +1,24 @@\n+/* We used to ICE on this testcase: the address of bad_spill_regs is\n+   only taken in a phi node, which we missed and cleared its TREE_ADDRESSABLE\n+   flag.  This gets revealed when the loop is completely unrolled, thus\n+   exposing the addresses as ordinary statements.  */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-O1\" } */\n+\n+\n+typedef unsigned HARD_REG_SET[2];\n+static HARD_REG_SET bad_spill_regs;\n+\n+void\n+order_regs_for_reload ()\n+{\n+  register int i;\n+\n+  register unsigned *scan_tp_ = bad_spill_regs;\n+\n+  for (i = 0; i < 2; i++)\n+    *scan_tp_++ = 0;\n+\n+  bad_spill_regs[0] |= 1;\n+}"}]}