{"sha": "b5a4533b365b1405a3649f2f7c135ade80917e7b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjVhNDUzM2IzNjViMTQwNWEzNjQ5ZjJmN2MxMzVhZGU4MDkxN2U3Yg==", "commit": {"author": {"name": "Zhenqiang Chen", "email": "zhenqiang.chen@arm.com", "date": "2014-11-03T06:36:11Z"}, "committer": {"name": "Zhenqiang Chen", "email": "zqchen@gcc.gnu.org", "date": "2014-11-03T06:36:11Z"}, "message": "ifcvt.c (noce_try_store_flag_mask): Check rtx cost.\n\nChangeLog:\n2014-11-03  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n\n\t* ifcvt.c (noce_try_store_flag_mask): Check rtx cost.\n\ntestsuite/ChangeLog:\n2014-11-03  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n\n\t* gcc.target/arm/ifcvt-size-check.c: New test.\n\nFrom-SVN: r217029", "tree": {"sha": "5aeafda1b24a1ca5523464fa4aa4b3d90037403e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5aeafda1b24a1ca5523464fa4aa4b3d90037403e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b5a4533b365b1405a3649f2f7c135ade80917e7b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5a4533b365b1405a3649f2f7c135ade80917e7b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5a4533b365b1405a3649f2f7c135ade80917e7b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5a4533b365b1405a3649f2f7c135ade80917e7b/comments", "author": null, "committer": null, "parents": [{"sha": "ed60a04bbb4787ddc5efe5c2920d6c406fe566e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed60a04bbb4787ddc5efe5c2920d6c406fe566e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed60a04bbb4787ddc5efe5c2920d6c406fe566e1"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "bcfbd9b44abda2db2a6bf4e06b94fe934d834710", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b5a4533b365b1405a3649f2f7c135ade80917e7b", "patch": "@@ -1,3 +1,7 @@\n+2014-11-03  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n+\n+\t* ifcvt.c (noce_try_store_flag_mask): Check rtx cost.\n+\n 2014-11-03  Andrew Pinski  <apinski@cavium.com>\n \n \t* config/mips/mips-cpus.def (octeon3): New cpu."}, {"sha": "c5a104e2b6d07b97e95a0f322b17022cc8869268", "filename": "gcc/ifcvt.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2Fifcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2Fifcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fifcvt.c?ref=b5a4533b365b1405a3649f2f7c135ade80917e7b", "patch": "@@ -1394,13 +1394,24 @@ noce_try_store_flag_mask (struct noce_if_info *if_info)\n \n       if (target)\n \t{\n+\t  int old_cost, new_cost, insn_cost;\n+\t  int speed_p;\n+\n \t  if (target != if_info->x)\n \t    noce_emit_move_insn (if_info->x, target);\n \n \t  seq = end_ifcvt_sequence (if_info);\n \t  if (!seq)\n \t    return FALSE;\n \n+\t  speed_p = optimize_bb_for_speed_p (BLOCK_FOR_INSN (if_info->insn_a));\n+\t  insn_cost = insn_rtx_cost (PATTERN (if_info->insn_a), speed_p);\n+\t  old_cost = COSTS_N_INSNS (if_info->branch_cost) + insn_cost;\n+\t  new_cost = seq_cost (seq, speed_p);\n+\n+\t  if (new_cost > old_cost)\n+\t    return FALSE;\n+\n \t  emit_insn_before_setloc (seq, if_info->jump,\n \t\t\t\t   INSN_LOCATION (if_info->insn_a));\n \t  return TRUE;"}, {"sha": "1bf0c07c8d180f867b8da2146f2367e498645774", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b5a4533b365b1405a3649f2f7c135ade80917e7b", "patch": "@@ -1,3 +1,7 @@\n+2014-11-03  Zhenqiang Chen  <zhenqiang.chen@arm.com>\n+\n+\t* gcc.target/arm/ifcvt-size-check.c: New test.\n+\n 2014-11-03  Naveen H.S  <Naveen.Hurugalawadi@caviumnetworks.com>\n \n \t* gcc.target/mips/octeon3-pipe-1.c: New test."}, {"sha": "43fa16b82b589ebe76da3a30d1ae869de64e41b8", "filename": "gcc/testsuite/gcc.target/arm/ifcvt-size-check.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fifcvt-size-check.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5a4533b365b1405a3649f2f7c135ade80917e7b/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fifcvt-size-check.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fifcvt-size-check.c?ref=b5a4533b365b1405a3649f2f7c135ade80917e7b", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do assemble } */\n+/* { dg-options \"-mthumb -Os \" }  */\n+/* { dg-require-effective-target arm_thumb1_ok } */\n+\n+int\n+test (unsigned char iov_len, int count, int i)\n+{\n+  unsigned char bytes = 0;\n+  if ((unsigned char) ((char) 127 - bytes) < iov_len)\n+    return 22;\n+  return 0;\n+}\n+/* { dg-final { object-size text <= 12 } } */"}]}