{"sha": "c9d75a48c4ea63ab27ccdb40f993236289b243f2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzlkNzVhNDhjNGVhNjNhYjI3Y2NkYjQwZjk5MzIzNjI4OWIyNDNmMg==", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2010-07-28T17:33:37Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2010-07-28T17:33:37Z"}, "message": "decl.c (free_value): Also free repeat field.\n\n2010-07-28  Mikael Morin  <mikael@gcc.gnu.org>\n\n\t* decl.c (free_value): Also free repeat field.\n\t* data.c (gfc_assign_data_value): Always free offset before returning.\n\nFrom-SVN: r162649", "tree": {"sha": "2c3413ad539d2fc647357b1d97960cfbe3590b4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2c3413ad539d2fc647357b1d97960cfbe3590b4b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c9d75a48c4ea63ab27ccdb40f993236289b243f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9d75a48c4ea63ab27ccdb40f993236289b243f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c9d75a48c4ea63ab27ccdb40f993236289b243f2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9d75a48c4ea63ab27ccdb40f993236289b243f2/comments", "author": null, "committer": null, "parents": [{"sha": "69dcd06ab86aef723efcc294d64e31ef159ae3c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69dcd06ab86aef723efcc294d64e31ef159ae3c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69dcd06ab86aef723efcc294d64e31ef159ae3c0"}], "stats": {"total": 28, "additions": 20, "deletions": 8}, "files": [{"sha": "37da9fd5d44dacc2acac4818ffb9faa3c9dbcf83", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9d75a48c4ea63ab27ccdb40f993236289b243f2/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9d75a48c4ea63ab27ccdb40f993236289b243f2/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c9d75a48c4ea63ab27ccdb40f993236289b243f2", "patch": "@@ -1,3 +1,8 @@\n+2010-07-28  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\t* decl.c (free_value): Also free repeat field.\n+\t* data.c (gfc_assign_data_value): Always free offset before returning.\n+\n 2010-07-28  Daniel Kraft  <d@domob.eu>\n \n \t* gfortran.h (gfc_build_intrinsic_call): New method."}, {"sha": "6829fe9cd03f631255992bcf9c812907532945c1", "filename": "gcc/fortran/data.c", "status": "modified", "additions": 14, "deletions": 8, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9d75a48c4ea63ab27ccdb40f993236289b243f2/gcc%2Ffortran%2Fdata.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9d75a48c4ea63ab27ccdb40f993236289b243f2/gcc%2Ffortran%2Fdata.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdata.c?ref=c9d75a48c4ea63ab27ccdb40f993236289b243f2", "patch": "@@ -244,7 +244,7 @@ gfc_assign_data_value (gfc_expr *lvalue, gfc_expr *rvalue, mpz_t index)\n \t      gfc_error (\"'%s' at %L already is initialized at %L\",\n \t\t\t lvalue->symtree->n.sym->name, &lvalue->where,\n \t\t\t &init->where);\n-\t      return FAILURE;\n+\t      goto abort;\n \t    }\n \n \t  if (init == NULL)\n@@ -267,20 +267,20 @@ gfc_assign_data_value (gfc_expr *lvalue, gfc_expr *rvalue, mpz_t index)\n \t    {\n \t      gfc_error (\"Data element below array lower bound at %L\",\n \t\t\t &lvalue->where);\n-\t      return FAILURE;\n+\t      goto abort;\n \t    }\n \t  else\n \t    {\n \t      mpz_t size;\n \t      if (spec_size (ref->u.ar.as, &size) == SUCCESS)\n \t\t{\n \t\t  if (mpz_cmp (offset, size) >= 0)\n-\t\t  {\n-\t\t    mpz_clear (size);\n-\t\t    gfc_error (\"Data element above array upper bound at %L\",\n-\t\t\t       &lvalue->where);\n-\t\t    return FAILURE;\n-\t\t  }\n+\t\t    {\n+\t\t      mpz_clear (size);\n+\t\t      gfc_error (\"Data element above array upper bound at %L\",\n+\t\t                 &lvalue->where);\n+\t\t      goto abort;\n+\t\t    }\n \t\t  mpz_clear (size);\n \t\t}\n \t    }\n@@ -336,6 +336,8 @@ gfc_assign_data_value (gfc_expr *lvalue, gfc_expr *rvalue, mpz_t index)\n       last_con = con;\n     }\n \n+  mpz_clear (offset);\n+\n   if (ref || last_ts->type == BT_CHARACTER)\n     {\n       if (lvalue->ts.u.cl->length == NULL && !(ref && ref->u.ss.length != NULL))\n@@ -371,6 +373,10 @@ gfc_assign_data_value (gfc_expr *lvalue, gfc_expr *rvalue, mpz_t index)\n     last_con->expr = expr;\n \n   return SUCCESS;\n+\n+abort:\n+  mpz_clear (offset);\n+  return FAILURE;\n }\n \n "}, {"sha": "acc85d25484dda2463f8f7d1ec2387851d64f677", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9d75a48c4ea63ab27ccdb40f993236289b243f2/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9d75a48c4ea63ab27ccdb40f993236289b243f2/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=c9d75a48c4ea63ab27ccdb40f993236289b243f2", "patch": "@@ -134,6 +134,7 @@ free_value (gfc_data_value *p)\n   for (; p; p = q)\n     {\n       q = p->next;\n+      mpz_clear (p->repeat);\n       gfc_free_expr (p->expr);\n       gfc_free (p);\n     }"}]}