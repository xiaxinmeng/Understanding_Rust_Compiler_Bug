{"sha": "ce43588feb5a9fb952d8986d00704e5b81f2bd89", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2U0MzU4OGZlYjVhOWZiOTUyZDg5ODZkMDA3MDRlNWI4MWYyYmQ4OQ==", "commit": {"author": {"name": "Dave Love", "email": "fx@gcc.gnu.org", "date": "1998-10-13T08:51:49Z"}, "committer": {"name": "Dave Love", "email": "fx@gcc.gnu.org", "date": "1998-10-13T08:51:49Z"}, "message": "Makefile.in (.SUFFIXES): Don't use any.\n\n1998-10-12  Dave Love  <fx@gnu.org>\n\t* Makefile.in (.SUFFIXES): Don't use any.\n\t(all-unilib): New target, like old all.\n\t(all): Use it.\n\t(.PHONY): Add all-unilib.\n\nFrom-SVN: r23045", "tree": {"sha": "3085f9a110c1ee7a461f77d81561b9e531993852", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3085f9a110c1ee7a461f77d81561b9e531993852"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ce43588feb5a9fb952d8986d00704e5b81f2bd89", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce43588feb5a9fb952d8986d00704e5b81f2bd89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce43588feb5a9fb952d8986d00704e5b81f2bd89", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce43588feb5a9fb952d8986d00704e5b81f2bd89/comments", "author": null, "committer": null, "parents": [{"sha": "c007ef468c070ca20cb3761594704744b603400a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c007ef468c070ca20cb3761594704744b603400a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c007ef468c070ca20cb3761594704744b603400a"}], "stats": {"total": 53, "additions": 46, "deletions": 7}, "files": [{"sha": "5be697727a723d3ebcdc606ce1bf1690dc2c7ce3", "filename": "libf2c/Makefile.in", "status": "modified", "additions": 46, "deletions": 7, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce43588feb5a9fb952d8986d00704e5b81f2bd89/libf2c%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce43588feb5a9fb952d8986d00704e5b81f2bd89/libf2c%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libf2c%2FMakefile.in?ref=ce43588feb5a9fb952d8986d00704e5b81f2bd89", "patch": "@@ -82,14 +82,52 @@ F2CEXT = abort derf derfc ef1asc ef1cmc erf erfc exit getarg getenv iargc \\\n \tsecnds second sleep srand stat symlnk time ttynam umask unlink \\\n \tvxtidt vxttim alarm\n \n-# These dependencies can be satisfied in parallel.  The [fiu]77\n-# targets update stamp files which the $(LIBG2C) target checks in the\n-# sub-make.  (Probably only one stamp file is really needed.)\n-all: i77 f77 u77 s-libe77 $(LIBG2C)\n-\t$(MULTIDO) $(FLAGS_TO_PASS) multi-do DO=\"all\"\n+.SUFFIXES:\n+\n+# The logic here is partly dictated by the desire to keep the lib?77\n+# subdirs for compatibility with the Netlib version and because libU77\n+# has a different copyright; then the libe77 bit (EXTERNALly-callable\n+# versions) is funny.  Given that, as well as keeping things as simple\n+# as possible we want (at least) the following:\n+#  * Allow make to be run at the top level (all-target-libf2c), at this\n+#    level, or the subdirs of this level.  In the latter case we only\n+#    compile, rather than updating libg2c.a;\n+#  * A robust set of dependencies, so that we rebuild (as little as\n+#    possible) if a configuration file, g2c.h or any lib?77/*.c file\n+#    changes;\n+#  * Avoid unnecessary running of ar and ranlib;\n+#  * Expose parallelism where reasonable, but not as a priority.\n+\n+# The intended top-level target here does a non-multilib build (via\n+# the dependency) and then (perhaps) builds multilibs.\n+\n+all: all-unilib\n+\t$(MULTIDO) $(FLAGS_TO_PASS) multi-do DO=\"all-unilib\"\n+\n+# `all-unilib' is the overall target in the absence of multilibs,\n+# meant to be invoked via multi-do for multilibs.\n+\n+# Its dependencies can be satisfied in parallel.  The [fiu]77 targets\n+# update stamp files (see the subdir makefiles) which the $(LIBG2C)\n+# target checks in the sub make to decide whether to run ar/ranlib.\n+# (Probably only one stamp file is really needed.)  The stamp files\n+# s-lib[fiu]77 are intentionally not targets, since we're only meant\n+# to come in at the level of this target.  The [fiu]77 targets always\n+# invoke sub makes to check dependencies in the subdirs, else we'd\n+# have to maintain them at this level; we live with the overhead of\n+# some recursive makes which may do nothing.\n+\n+all-unilib: i77 f77 u77 s-libe77\n+\t$(MAKE) $(FLAGS_TO_PASS) $(LIBG2C)\n \n i77 f77 u77: g2c.h\n \n+# This target should normally only get invoked via `all-unilib' --\n+# after all's well in the subdirs -- actually to assemble the library.\n+# The stamp file dependencies are just to check whether libg2c.a is\n+# up-to-date (to avoid running ar regardless) -- the files should\n+# always have been created by a successful `all-unilib'.\n+\n $(LIBG2C): s-libi77 s-libf77 s-libu77 s-libe77\n \trm -f $(LIBG2C)\n \tset -e; \\\n@@ -138,7 +176,7 @@ g2c.h: g2c.hin config.status Makefile\n #\t$(srcdir)/../move-if-change g2c.h g2c.x && mv g2c.x g2c.h\n \n Makefile: Makefile.in config.status\n-# Autoconf doc uses `./config.status'.  Is there a good reason to use \n+# Autoconf doc uses `./config.status'.  Is there a good reason to use $(SHELL)?\n \t  $(SHELL) config.status\n \n config.status: configure $(gcc_version_trigger)\n@@ -197,7 +235,7 @@ rebuilt: configure\n \n .PHONY: rebuilt mostlyclean clean distclean maintainer-clean all \\\n         i77 f77 u77 check uninstall install-strip dist \\\n-        installcheck installdirs\n+        installcheck installdirs all-unilib\n \n subdir_do:\n \t@rootpre=`pwd`/; export rootpre; \\\n@@ -214,3 +252,4 @@ subdir_do:\n \t  else true; fi; \\\n \tdone\n \n+# multidoings may be added here by configure."}]}