{"sha": "9c8586819806fba3b8acd448a68424aa41d832c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWM4NTg2ODE5ODA2ZmJhM2I4YWNkNDQ4YTY4NDI0YWE0MWQ4MzJjOA==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2003-11-29T18:54:43Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2003-11-29T18:54:43Z"}, "message": "stmt.c (expand_asm_operands): Check whether force_const_mem succeeded.\n\n\t* stmt.c (expand_asm_operands): Check whether force_const_mem\n\tsucceeded.\n\ntestsuite/\n\t* gcc.dg/tls/asm-1.C: New test.\n\nFrom-SVN: r74035", "tree": {"sha": "854060a2992c75a90b555b47958be9040f4c5d60", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/854060a2992c75a90b555b47958be9040f4c5d60"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9c8586819806fba3b8acd448a68424aa41d832c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c8586819806fba3b8acd448a68424aa41d832c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9c8586819806fba3b8acd448a68424aa41d832c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c8586819806fba3b8acd448a68424aa41d832c8/comments", "author": null, "committer": null, "parents": [{"sha": "2d25605a546af33df11715eff5cc16393c0b2257", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d25605a546af33df11715eff5cc16393c0b2257", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d25605a546af33df11715eff5cc16393c0b2257"}], "stats": {"total": 31, "additions": 25, "deletions": 6}, "files": [{"sha": "2fc72f917d013550744348c49f963d92e6ceb3fa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9c8586819806fba3b8acd448a68424aa41d832c8", "patch": "@@ -1,3 +1,8 @@\n+2003-11-29  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* stmt.c (expand_asm_operands): Check whether force_const_mem\n+\tsucceeded.\n+\n 2003-11-28  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* config/gnu.h (HURD_TARGET_OS_CPP_BUILTINS): New."}, {"sha": "a7c910437f1bfb80b4a9ed3f238ac87b382f3e53", "filename": "gcc/stmt.c", "status": "modified", "additions": 9, "deletions": 6, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2Fstmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2Fstmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstmt.c?ref=9c8586819806fba3b8acd448a68424aa41d832c8", "patch": "@@ -1712,13 +1712,16 @@ expand_asm_operands (tree string, tree outputs, tree inputs,\n \n \t      if (CONSTANT_P (op))\n \t\t{\n-\t\t  op = force_const_mem (TYPE_MODE (type), op);\n-\t\t  op = validize_mem (op);\n+\t\t  rtx mem = force_const_mem (TYPE_MODE (type), op);\n+\t\t  if (mem)\n+\t\t    op = validize_mem (mem);\n+\t\t  else\n+\t\t    op = force_reg (TYPE_MODE (type), op);\n \t\t}\n-\t      else if (GET_CODE (op) == REG\n-\t\t       || GET_CODE (op) == SUBREG\n-\t\t       || GET_CODE (op) == ADDRESSOF\n-\t\t       || GET_CODE (op) == CONCAT)\n+\t      if (GET_CODE (op) == REG\n+\t\t  || GET_CODE (op) == SUBREG\n+\t\t  || GET_CODE (op) == ADDRESSOF\n+\t\t  || GET_CODE (op) == CONCAT)\n \t\t{\n \t\t  tree qual_type = build_qualified_type (type,\n \t\t\t\t\t\t\t (TYPE_QUALS (type)"}, {"sha": "6ef9814b5aefe162649113cd3d6f1439bc1949d0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9c8586819806fba3b8acd448a68424aa41d832c8", "patch": "@@ -1,3 +1,7 @@\n+2003-11-29  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* gcc.dg/tls/asm-1.C: New test.\n+\n 2003-11-28  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* testsuite/gcc.dg/cpp/assert4.c: Update."}, {"sha": "68c49f61180fd5a2fa21d89e35212f8ad1840325", "filename": "gcc/testsuite/gcc.dg/tls/asm-1.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2Ftestsuite%2Fgcc.dg%2Ftls%2Fasm-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c8586819806fba3b8acd448a68424aa41d832c8/gcc%2Ftestsuite%2Fgcc.dg%2Ftls%2Fasm-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftls%2Fasm-1.c?ref=9c8586819806fba3b8acd448a68424aa41d832c8", "patch": "@@ -0,0 +1,7 @@\n+/* { dg-options \"-Werror\" } */\n+__thread int i;\n+\n+int foo ()\n+{\n+  asm volatile (\"\" :: \"m\" (&i));\t/* { dg-error \"lvalue\" } */\n+}"}]}