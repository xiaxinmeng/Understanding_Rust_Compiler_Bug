{"sha": "90a63880dd0075e4841579daf30006030ba39ab1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTBhNjM4ODBkZDAwNzVlNDg0MTU3OWRhZjMwMDA2MDMwYmEzOWFiMQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2003-04-17T06:44:15Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2003-04-17T06:44:15Z"}, "message": "frv.c (frv_asm_out_constructor): New.\n\n        * config/frv/frv.c (frv_asm_out_constructor): New.\n        (frv_asm_out_destructor): New.\n        * config/frv/frv.h (CTORS_SECTION_ASM_OP): New.\n        (DTORS_SECTION_ASM_OP): New.\n        (ASM_OUTPUT_CONSTRUCTOR): Remove.\n        (ASM_OUTPUT_DESTRUCTOR): Remove.\n\nFrom-SVN: r65724", "tree": {"sha": "ffef96af089699b255c31094d0ce68fb469e9d9d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ffef96af089699b255c31094d0ce68fb469e9d9d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/90a63880dd0075e4841579daf30006030ba39ab1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90a63880dd0075e4841579daf30006030ba39ab1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90a63880dd0075e4841579daf30006030ba39ab1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90a63880dd0075e4841579daf30006030ba39ab1/comments", "author": null, "committer": null, "parents": [{"sha": "5c93e01bbc74be5af2771fedfbff346d2aa0b7bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c93e01bbc74be5af2771fedfbff346d2aa0b7bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c93e01bbc74be5af2771fedfbff346d2aa0b7bb"}], "stats": {"total": 61, "additions": 40, "deletions": 21}, "files": [{"sha": "4dfbdad9ad1e1fcfaafeff89f09ae4739efbe08d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90a63880dd0075e4841579daf30006030ba39ab1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90a63880dd0075e4841579daf30006030ba39ab1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=90a63880dd0075e4841579daf30006030ba39ab1", "patch": "@@ -1,3 +1,12 @@\n+2003-04-16  Richard Henderson  <rth@redhat.com>\n+\n+\t* config/frv/frv.c (frv_asm_out_constructor): New.\n+\t(frv_asm_out_destructor): New.\n+\t* config/frv/frv.h (CTORS_SECTION_ASM_OP): New.\n+\t(DTORS_SECTION_ASM_OP): New.\n+\t(ASM_OUTPUT_CONSTRUCTOR): Remove.\n+\t(ASM_OUTPUT_DESTRUCTOR): Remove.\n+\n 2003-04-16  Richard Henderson  <rth@redhat.com>\n \n \t* config/cris/cris.c (cris_gotless_symbol, cris_got_symbol): Use"}, {"sha": "7c36783fdac152efeb37f9d1d6b70db9188c4b7a", "filename": "gcc/config/frv/frv.c", "status": "modified", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90a63880dd0075e4841579daf30006030ba39ab1/gcc%2Fconfig%2Ffrv%2Ffrv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90a63880dd0075e4841579daf30006030ba39ab1/gcc%2Fconfig%2Ffrv%2Ffrv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ffrv%2Ffrv.c?ref=90a63880dd0075e4841579daf30006030ba39ab1", "patch": "@@ -284,6 +284,8 @@ static bool frv_in_small_data_p\t\t\tPARAMS ((tree));\n static void frv_asm_output_mi_thunk\n   PARAMS ((FILE *, tree, HOST_WIDE_INT, HOST_WIDE_INT, tree));\n static bool frv_rtx_costs\t\t\tPARAMS ((rtx, int, int, int*));\n+static void frv_asm_out_constructor\t\tPARAMS ((rtx, int));\n+static void frv_asm_out_destructor\t\tPARAMS ((rtx, int));\n \f\n /* Initialize the GCC target structure.  */\n #undef  TARGET_ASM_FUNCTION_PROLOGUE\n@@ -304,6 +306,10 @@ static bool frv_rtx_costs\t\t\tPARAMS ((rtx, int, int, int*));\n #define TARGET_IN_SMALL_DATA_P frv_in_small_data_p\n #undef TARGET_RTX_COSTS\n #define TARGET_RTX_COSTS frv_rtx_costs\n+#undef TARGET_ASM_CONSTRUCTOR\n+#define TARGET_ASM_CONSTRUCTOR frv_asm_out_constructor\n+#undef TARGET_ASM_DESTRUCTOR\n+#define TARGET_ASM_DESTRUCTOR frv_asm_out_destructor\n \n #undef TARGET_ASM_OUTPUT_MI_THUNK\n #define TARGET_ASM_OUTPUT_MI_THUNK frv_asm_output_mi_thunk\n@@ -9853,3 +9859,23 @@ frv_rtx_costs (x, code, outer_code, total)\n       return false;\n     }\n }\n+\f\n+static void\n+frv_asm_out_constructor (symbol, priority)\n+     rtx symbol;\n+     int priority ATTRIBUTE_UNUSED;\n+{\n+  ctors_section ();\n+  assemble_align (POINTER_SIZE);\n+  assemble_integer_with_op (\"\\t.picptr\\t\", symbol);\n+}\n+\n+static void\n+frv_asm_out_destructor (symbol, priority)\n+     rtx symbol;\n+     int priority ATTRIBUTE_UNUSED;\n+{\n+  dtors_section ();\n+  assemble_align (POINTER_SIZE);\n+  assemble_integer_with_op (\"\\t.picptr\\t\", symbol);\n+}"}, {"sha": "4273847297c7eaa85f562a30f8a39118bbd75c57", "filename": "gcc/config/frv/frv.h", "status": "modified", "additions": 5, "deletions": 21, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90a63880dd0075e4841579daf30006030ba39ab1/gcc%2Fconfig%2Ffrv%2Ffrv.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90a63880dd0075e4841579daf30006030ba39ab1/gcc%2Fconfig%2Ffrv%2Ffrv.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ffrv%2Ffrv.h?ref=90a63880dd0075e4841579daf30006030ba39ab1", "patch": "@@ -2640,6 +2640,11 @@ __asm__(\"\\n\"\t\t\t\t\t\t\t\t\\\n #define INIT_SECTION_ASM_OP\t\"\\t.section .init,\\\"ax\\\"\"\n #define FINI_SECTION_ASM_OP\t\"\\t.section .fini,\\\"ax\\\"\"\n \n+#undef CTORS_SECTION_ASM_OP\n+#undef DTORS_SECTION_ASM_OP\n+#define CTORS_SECTION_ASM_OP\t\"\\t.section\\t.ctors,\\\"a\\\"\"\n+#define DTORS_SECTION_ASM_OP\t\"\\t.section\\t.dtors,\\\"a\\\"\"\n+\n /* A C expression whose value is a string containing the assembler operation to\n    switch to the fixup section that records all initialized pointers in a -fpic\n    program so they can be changed program startup time if the program is loaded\n@@ -2860,27 +2865,6 @@ do {\t\t\t\t\t\t\t\t\t\\\n    init section is not actually run automatically, but is still useful for\n    collecting the lists of constructors and destructors.  */\n #define INVOKE__main\n-\n-/* Output appropriate code tp call a static constructor.  */\n-#undef  ASM_OUTPUT_CONSTRUCTOR\n-#define ASM_OUTPUT_CONSTRUCTOR(STREAM,NAME)\t\t\t\t\\\n-do {\t\t\t\t\t\t\t\t\t\\\n-  ctors_section ();\t\t\t\t\t\t\t\\\n-  fprintf (STREAM, \"\\t.picptr\\t\");\t\t\t\t\t\\\n-  assemble_name (STREAM, NAME);\t\t\t\t\t\t\\\n-  fprintf (STREAM, \"\\n\");\t\t\t\t\t\t\t\\\n-} while (0)\n-\n-/* Output appropriate code tp call a static destructor.  */\n-#undef  ASM_OUTPUT_DESTRUCTOR\n-#define ASM_OUTPUT_DESTRUCTOR(STREAM,NAME)\t\t\t\t\\\n-do {\t\t\t\t\t\t\t\t\t\\\n-  dtors_section ();\t\t\t\t\t\t\t\\\n-  fprintf (STREAM, \"\\t.picptr\\t\");\t\t\t\t\t\\\n-  assemble_name (STREAM, NAME);\t\t\t\t\t\t\\\n-  fprintf (STREAM, \"\\n\");\t\t\t\t\t\t\t\\\n-} while (0)\n-\n \f\n /* Output of Assembler Instructions.  */\n "}]}