{"sha": "fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmNlNjYxZThkNTQ5NWQ4NzFlMDFiNGJmNmFmZDI2MjAzZWQ4ZmE3YQ==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2016-01-22T13:58:11Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2016-01-22T13:58:11Z"}, "message": "[ARM] Fix PR target/69403: Bug in thumb2_ior_scc_strict_it pattern\n\n\tPR target/69403\n\t* config/arm/thumb2.md (*thumb2_ior_scc_strict_it): Convert to\n\tdefine_insn_and_split.  Ensure operands[1] and operands[0] do not\n\tget assigned the same register.\n\n\t* gcc.c-torture/execute/pr69403.c: New test.\n\nFrom-SVN: r232727", "tree": {"sha": "51b5b216ed0779b5ebf5d581f106a417ff976102", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/51b5b216ed0779b5ebf5d581f106a417ff976102"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "350fe2829e2012d0e768602102fac31b474b1d2c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/350fe2829e2012d0e768602102fac31b474b1d2c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/350fe2829e2012d0e768602102fac31b474b1d2c"}], "stats": {"total": 56, "additions": 50, "deletions": 6}, "files": [{"sha": "16813c7556c4114a68017a59659311153708dd7d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "patch": "@@ -1,3 +1,10 @@\n+2016-01-22  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR target/69403\n+\t* config/arm/thumb2.md (*thumb2_ior_scc_strict_it): Convert to\n+\tdefine_insn_and_split.  Ensure operands[1] and operands[0] do not\n+\tget assigned the same register.\n+\n 2016-01-22  Kugan Vivekanandarajah  <kuganv@linaro.org>\n \n \t* ipa-prop.c (ipa_set_jf_constant): Remove redundant unshare_expr."}, {"sha": "39a3d80691814c3cb2ef10a3f608d25f075bbad6", "filename": "gcc/config/arm/thumb2.md", "status": "modified", "additions": 18, "deletions": 6, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2Fconfig%2Farm%2Fthumb2.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2Fconfig%2Farm%2Fthumb2.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fthumb2.md?ref=fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "patch": "@@ -663,15 +663,27 @@\n    (set_attr \"type\" \"multiple\")]\n )\n \n-(define_insn \"*thumb2_ior_scc_strict_it\"\n-  [(set (match_operand:SI 0 \"s_register_operand\" \"=l,l\")\n+(define_insn_and_split \"*thumb2_ior_scc_strict_it\"\n+  [(set (match_operand:SI 0 \"s_register_operand\" \"=&r\")\n \t(ior:SI (match_operator:SI 2 \"arm_comparison_operator\"\n \t\t [(match_operand 3 \"cc_register\" \"\") (const_int 0)])\n-\t\t(match_operand:SI 1 \"s_register_operand\" \"0,?l\")))]\n+\t\t(match_operand:SI 1 \"s_register_operand\" \"r\")))]\n   \"TARGET_THUMB2 && arm_restrict_it\"\n-  \"@\n-   it\\\\t%d2\\;mov%d2\\\\t%0, #1\\;it\\\\t%d2\\;orr%d2\\\\t%0, %1\n-   mov\\\\t%0, #1\\;orr\\\\t%0, %1\\;it\\\\t%D2\\;mov%D2\\\\t%0, %1\"\n+  \"#\" ; orr\\\\t%0, %1, #1\\;it\\\\t%D2\\;mov%D2\\\\t%0, %1\n+  \"&& reload_completed\"\n+  [(set (match_dup 0) (ior:SI (match_dup 1) (const_int 1)))\n+   (cond_exec (match_dup 4)\n+     (set (match_dup 0) (match_dup 1)))]\n+  {\n+    machine_mode mode = GET_MODE (operands[3]);\n+    rtx_code rc = GET_CODE (operands[2]);\n+\n+    if (mode == CCFPmode || mode == CCFPEmode)\n+      rc = reverse_condition_maybe_unordered (rc);\n+    else\n+      rc = reverse_condition (rc);\n+    operands[4] = gen_rtx_fmt_ee (rc, VOIDmode, operands[3], const0_rtx);\n+  }\n   [(set_attr \"conds\" \"use\")\n    (set_attr \"length\" \"8\")\n    (set_attr \"type\" \"multiple\")]"}, {"sha": "64687d7501ff7c7eaebe61b4925b5ddcddb38e7c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "patch": "@@ -1,3 +1,8 @@\n+2016-01-22  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR target/69403\n+\t* gcc.c-torture/execute/pr69403.c: New test.\n+\n 2016-01-22  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/55843"}, {"sha": "097d366079df46e5bc41b05d835d5f3b3ea0e1a4", "filename": "gcc/testsuite/gcc.c-torture/execute/pr69403.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr69403.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fce661e8d5495d871e01b4bf6afd26203ed8fa7a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr69403.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr69403.c?ref=fce661e8d5495d871e01b4bf6afd26203ed8fa7a", "patch": "@@ -0,0 +1,20 @@\n+/* PR target/69403.  */\n+\n+int a, b, c;\n+\n+__attribute__ ((__noinline__)) int\n+fn1 ()\n+{\n+  if ((b | (a != (a & c))) == 1)\n+    __builtin_abort ();\n+  return 0;\n+}\n+\n+int\n+main (void)\n+{\n+  a = 5;\n+  c = 1;\n+  b = 6;\n+  return fn1 ();\n+}"}]}