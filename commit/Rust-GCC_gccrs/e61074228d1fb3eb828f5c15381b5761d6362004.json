{"sha": "e61074228d1fb3eb828f5c15381b5761d6362004", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTYxMDc0MjI4ZDFmYjNlYjgyOGY1YzE1MzgxYjU3NjFkNjM2MjAwNA==", "commit": {"author": {"name": "Richard Earnshaw", "email": "rearnsha@arm.com", "date": "2020-01-15T11:30:07Z"}, "committer": {"name": "Richard Earnshaw", "email": "rearnsha@arm.com", "date": "2020-01-15T11:31:29Z"}, "message": "contrib: Don't add push rules for personal and vendor spaces.\n\nOriginally, it seemed like a good idea to add automatic 'push' rules\nto the git configuration, so that personal- and vendor-space commits\nwould automatically push to the right place.  Unfortunately, this\nchanges git's behaviour and with these settings \"git push\" will try to\npush all branches in a local tree up to the corresponding location on\nthe server (ignoring the push.default setting).  The only known\nmitigation for this is to ALWAYS use \"git push <server> <branch>\".\n\nSo instead, we no-longer add those rules by default and will document\nthe options on the wiki.  We don't automatically remove the push\nentries but do print out the command that will do so, if the user so\nwishes.\n\n\t* gcc-git-customization.sh: Explain why we want the user's\n\tupstream account name.  Don't add push rules.  Check if push rules\n\thave been added and suggest that they should be removed.\n\t* git-fetch-vendor.sh: Don't add push rules.", "tree": {"sha": "a2091473ec89f64291dccba4fb6c45836769bf88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a2091473ec89f64291dccba4fb6c45836769bf88"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e61074228d1fb3eb828f5c15381b5761d6362004", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e61074228d1fb3eb828f5c15381b5761d6362004", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e61074228d1fb3eb828f5c15381b5761d6362004", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e61074228d1fb3eb828f5c15381b5761d6362004/comments", "author": null, "committer": null, "parents": [{"sha": "8817bd75802d3ae47c54ec4fe99103308353d4ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8817bd75802d3ae47c54ec4fe99103308353d4ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8817bd75802d3ae47c54ec4fe99103308353d4ed"}], "stats": {"total": 28, "additions": 24, "deletions": 4}, "files": [{"sha": "f224c20f0aa14474b10dbb373fd6062f455acd48", "filename": "contrib/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e61074228d1fb3eb828f5c15381b5761d6362004/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e61074228d1fb3eb828f5c15381b5761d6362004/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=e61074228d1fb3eb828f5c15381b5761d6362004", "patch": "@@ -1,3 +1,10 @@\n+2010-01-15  Richard Earnshaw  <rearnsha@arm.com>\n+\n+\t* gcc-git-customization.sh: Explain why we want the user's\n+\tupstream account name.  Don't add push rules.  Check if push rules\n+\thave been added and suggest that they should be removed.\n+\t* git-fetch-vendor.sh: Don't add push rules.\n+\n 2010-01-13  Richard Earnshaw  <rearnsha@arm.com>\n \n \tRevert:"}, {"sha": "dae2c35bb57fb498d71f390b75a47e0f943fa023", "filename": "contrib/gcc-git-customization.sh", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e61074228d1fb3eb828f5c15381b5761d6362004/contrib%2Fgcc-git-customization.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e61074228d1fb3eb828f5c15381b5761d6362004/contrib%2Fgcc-git-customization.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-git-customization.sh?ref=e61074228d1fb3eb828f5c15381b5761d6362004", "patch": "@@ -55,7 +55,7 @@ then\n \tfi\n     fi\n fi\n-ask \"Account name on gcc.gnu.org\" $remote_id remote_id\n+ask \"Account name on gcc.gnu.org (for your personal branches area)\" $remote_id remote_id\n git config \"gcc-config.user\" \"$remote_id\"\n \n old_pfx=`git config --get \"gcc-config.userpfx\"`\n@@ -71,4 +71,19 @@ git config \"gcc-config.userpfx\" \"$new_pfx\"\n echo \"Setting up tracking for personal namespace $remote_id in remotes/$upstream/${new_pfx}\"\n git config --replace-all \"remote.${upstream}.fetch\" \"+refs/users/${remote_id}/heads/*:refs/remotes/${upstream}/${new_pfx}/*\" \":refs/remotes/${upstream}/${old_pfx}/\"\n git config --replace-all \"remote.${upstream}.fetch\" \"+refs/users/${remote_id}/tags/*:refs/tags/${new_pfx}/*\" \":refs/tags/${old_pfx}/\"\n-git config --replace-all \"remote.${upstream}.push\" \"refs/heads/${new_pfx}/*:refs/users/${remote_id}/heads/*\" \"^\\+?refs/heads/${old_pfx}/\"\n+\n+push_rule=`git config --get \"remote.${upstream}.push\"`\n+if [ \"x$push_rule\" != \"x\" ]\n+then\n+    echo \"***********************************************\"\n+    echo \"                  Warning\"\n+    echo \"***********************************************\"\n+    echo\n+    echo \"Old versions of this script used to add custom push\"\n+    echo \"rules to simplify pushing to personal branches.\"\n+    echo \"Your configuration contains such rules, but we no-longer\"\n+    echo \"recommend doing this.\"\n+    echo\n+    echo \"To delete these rules run:\"\n+    echo \"  git config --unset-all \\\"remote.${upstream}.push\\\"\"\n+fi"}, {"sha": "d2d3ed56ad77115527a397d48e83c882219a8608", "filename": "contrib/git-fetch-vendor.sh", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e61074228d1fb3eb828f5c15381b5761d6362004/contrib%2Fgit-fetch-vendor.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e61074228d1fb3eb828f5c15381b5761d6362004/contrib%2Fgit-fetch-vendor.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgit-fetch-vendor.sh?ref=e61074228d1fb3eb828f5c15381b5761d6362004", "patch": "@@ -15,8 +15,6 @@ then\n fi\n \n echo \"setting up git to fetch vendor ${vendor} to remotes/${upstream}/${vendor}\"\n-\n git config --replace-all \"remote.${upstream}.fetch\" \"+refs/vendors/${vendor}/heads/*:refs/remotes/${upstream}/${vendor}/*\" \":refs/remotes/${upstream}/${vendor}/\"\n git config --replace-all \"remote.${upstream}.fetch\" \"+refs/vendors/${vendor}/tags/*:refs/tags/${vendor}/*\" \":refs/tags/${vendor}/\"\n-git config --replace-all \"remote.${upstream}.push\" \"+refs/heads/${vendor}/*:refs/vendors/${vendor}/heads/*\" \"^\\+refs/heads/${vendor}/\"\n git fetch"}]}