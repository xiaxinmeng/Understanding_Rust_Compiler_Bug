{"sha": "a50c33459fc9967a388f254e93de7cdbae438a66", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTUwYzMzNDU5ZmM5OTY3YTM4OGYyNTRlOTNkZTdjZGJhZTQzOGE2Ng==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2005-03-29T16:13:14Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2005-03-29T16:13:14Z"}, "message": "2005-03-29  Vincent Celier  <celier@adacore.com>\n\n\t* mlib-tgt-vms-ia64.adb, mlib-tgt-vms-alpha.adb\n\t(Build_Dynamic_Library.Version_String): Return the empty string when\n\tLib_Version is empty or when the symbol policy is not Autonomous.\n\n\t* symbols-vms-alpha.adb (Finalize): For symbol policy Compliant, when\n\ta symbol is not in the reference symbol file, increase the Major ID\n\tand set the Minor ID to 0.\n\tUse gsmatch=lequal instead of gsmatch=equal\n\nFrom-SVN: r97166", "tree": {"sha": "8a1db4e7ae4271afa67025e1b59a2e88bfb8713b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a1db4e7ae4271afa67025e1b59a2e88bfb8713b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a50c33459fc9967a388f254e93de7cdbae438a66", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50c33459fc9967a388f254e93de7cdbae438a66", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a50c33459fc9967a388f254e93de7cdbae438a66", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50c33459fc9967a388f254e93de7cdbae438a66/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bc5f3720c12852b05a9be63752e98331f214ab3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc5f3720c12852b05a9be63752e98331f214ab3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc5f3720c12852b05a9be63752e98331f214ab3b"}], "stats": {"total": 39, "additions": 22, "deletions": 17}, "files": [{"sha": "ed713ca39845a16f89163f3c162e6d3be8dee2c7", "filename": "gcc/ada/mlib-tgt-vms-alpha.adb", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50c33459fc9967a388f254e93de7cdbae438a66/gcc%2Fada%2Fmlib-tgt-vms-alpha.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50c33459fc9967a388f254e93de7cdbae438a66/gcc%2Fada%2Fmlib-tgt-vms-alpha.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-vms-alpha.adb?ref=a50c33459fc9967a388f254e93de7cdbae438a66", "patch": "@@ -160,8 +160,10 @@ package body MLib.Tgt is\n       --  Returns Symbol_File, if not empty. Otherwise, returns \"symvec.opt\"\n \n       function Version_String return String;\n-      --  Returns Lib_Version if not empty, otherwise returns \"1\".\n-      --  Fails gnatmake if Lib_Version is not the image of a positive number.\n+      --  Returns Lib_Version if not empty and if Symbol_Data.Symbol_Policy is\n+      --  not Autonomous, otherwise returns \"\".\n+      --  When Symbol_Data.Symbol_Policy is Autonomous, fails gnatmake if\n+      --  Lib_Version is not the image of a positive number.\n \n       ------------------\n       -- Is_Interface --\n@@ -215,8 +217,10 @@ package body MLib.Tgt is\n       function Version_String return String is\n          Version : Integer := 0;\n       begin\n-         if Lib_Version = \"\" then\n-            return \"1\";\n+         if Lib_Version = \"\"\n+           or else Symbol_Data.Symbol_Policy /= Autonomous\n+         then\n+            return \"\";\n \n          else\n             begin"}, {"sha": "8dfbcc2ed80df78a0c9a03e0d5f0bb4e3f24b639", "filename": "gcc/ada/mlib-tgt-vms-ia64.adb", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50c33459fc9967a388f254e93de7cdbae438a66/gcc%2Fada%2Fmlib-tgt-vms-ia64.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50c33459fc9967a388f254e93de7cdbae438a66/gcc%2Fada%2Fmlib-tgt-vms-ia64.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-vms-ia64.adb?ref=a50c33459fc9967a388f254e93de7cdbae438a66", "patch": "@@ -160,8 +160,10 @@ package body MLib.Tgt is\n       --  Returns Symbol_File, if not empty. Otherwise, returns \"symvec.opt\"\n \n       function Version_String return String;\n-      --  Returns Lib_Version if not empty, otherwise returns \"1\".\n-      --  Fails gnatmake if Lib_Version is not the image of a positive number.\n+      --  Returns Lib_Version if not empty and if Symbol_Data.Symbol_Policy is\n+      --  not Autonomous, otherwise returns \"\".\n+      --  When Symbol_Data.Symbol_Policy is Autonomous, fails gnatmake if\n+      --  Lib_Version is not the image of a positive number.\n \n       ------------------\n       -- Is_Interface --\n@@ -215,8 +217,10 @@ package body MLib.Tgt is\n       function Version_String return String is\n          Version : Integer := 0;\n       begin\n-         if Lib_Version = \"\" then\n-            return \"1\";\n+         if Lib_Version = \"\"\n+           or else Symbol_Data.Symbol_Policy /= Autonomous\n+         then\n+            return \"\";\n \n          else\n             begin"}, {"sha": "4fb68318f9914eaa3616226ca6174c9eebff3ee8", "filename": "gcc/ada/symbols-vms-alpha.adb", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50c33459fc9967a388f254e93de7cdbae438a66/gcc%2Fada%2Fsymbols-vms-alpha.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50c33459fc9967a388f254e93de7cdbae438a66/gcc%2Fada%2Fsymbols-vms-alpha.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsymbols-vms-alpha.adb?ref=a50c33459fc9967a388f254e93de7cdbae438a66", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2003-2004 Free Software Foundation, Inc.          --\n+--          Copyright (C) 2003-2005 Free Software Foundation, Inc.          --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -36,7 +36,7 @@ package body Symbols is\n    Symbol_Vector   : constant String := \"SYMBOL_VECTOR=(\";\n    Equal_Data      : constant String := \"=DATA)\";\n    Equal_Procedure : constant String := \"=PROCEDURE)\";\n-   Gsmatch         : constant String := \"gsmatch=equal,\";\n+   Gsmatch         : constant String := \"gsmatch=lequal,\";\n \n    Symbol_File_Name : String_Access := null;\n    --  Name of the symbol file\n@@ -668,18 +668,15 @@ package body Symbols is\n                   Success := False;\n                   return;\n \n-               elsif Soft_Minor_ID then\n-                  Minor_ID := Minor_ID + 1;\n+               elsif Soft_Major_ID then\n+                  Major_ID := Major_ID + 1;\n+                  Minor_ID := 0;\n+                  Soft_Major_ID := False;\n                   Soft_Minor_ID := False;\n                end if;\n \n                Original_Symbols.Table (Index_1).Present := False;\n                Free (Original_Symbols.Table (Index_1).Name);\n-\n-               if Soft_Minor_ID then\n-                  Minor_ID := Minor_ID + 1;\n-                  Soft_Minor_ID := False;\n-               end if;\n             end if;\n          end loop;\n "}]}