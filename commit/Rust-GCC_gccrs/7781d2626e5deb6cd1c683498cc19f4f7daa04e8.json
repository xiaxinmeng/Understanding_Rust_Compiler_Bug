{"sha": "7781d2626e5deb6cd1c683498cc19f4f7daa04e8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzc4MWQyNjI2ZTVkZWI2Y2QxYzY4MzQ5OGNjMTlmNGY3ZGFhMDRlOA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2015-07-16T11:51:38Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2015-07-16T11:51:38Z"}, "message": "Handle exit phi without header phi in create_parallel_loop\n\n2015-07-16  Tom de Vries  <tom@codesourcery.com>\n\n\t* tree-parloops.c (create_parallel_loop): Handle case that exit phi does\n\tnot have a corresponding loop header phi.\n\nFrom-SVN: r225873", "tree": {"sha": "4a01222e6ee45ca66ed88e998e183b165df922ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4a01222e6ee45ca66ed88e998e183b165df922ba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7781d2626e5deb6cd1c683498cc19f4f7daa04e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7781d2626e5deb6cd1c683498cc19f4f7daa04e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7781d2626e5deb6cd1c683498cc19f4f7daa04e8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7781d2626e5deb6cd1c683498cc19f4f7daa04e8/comments", "author": null, "committer": null, "parents": [{"sha": "79855460bdf36dff2eb97a726475e3f1a4eb5331", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79855460bdf36dff2eb97a726475e3f1a4eb5331", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79855460bdf36dff2eb97a726475e3f1a4eb5331"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "764e8bc874eb0a0320607d5b8e4b4bb997a603ad", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7781d2626e5deb6cd1c683498cc19f4f7daa04e8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7781d2626e5deb6cd1c683498cc19f4f7daa04e8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7781d2626e5deb6cd1c683498cc19f4f7daa04e8", "patch": "@@ -1,3 +1,8 @@\n+2015-07-16  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* tree-parloops.c (create_parallel_loop): Handle case that exit phi does\n+\tnot have a corresponding loop header phi.\n+\n 2015-07-16  Tom de Vries  <tom@codesourcery.com>\n \n \t* tree-parloops.c (create_loads_for_reductions): Handle case that"}, {"sha": "ec418343c265e6a4c585c838b8abaf61eb63c5c3", "filename": "gcc/tree-parloops.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7781d2626e5deb6cd1c683498cc19f4f7daa04e8/gcc%2Ftree-parloops.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7781d2626e5deb6cd1c683498cc19f4f7daa04e8/gcc%2Ftree-parloops.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-parloops.c?ref=7781d2626e5deb6cd1c683498cc19f4f7daa04e8", "patch": "@@ -2050,13 +2050,17 @@ create_parallel_loop (struct loop *loop, tree loop_fn, tree data,\n        !gsi_end_p (gpi); gsi_next (&gpi))\n     {\n       source_location locus;\n-      tree def;\n       gphi *phi = gpi.phi ();\n-      gphi *stmt;\n+      tree def = PHI_ARG_DEF_FROM_EDGE (phi, exit);\n+      gimple def_stmt = SSA_NAME_DEF_STMT (def);\n \n-      stmt = as_a <gphi *> (\n-\t       SSA_NAME_DEF_STMT (PHI_ARG_DEF_FROM_EDGE (phi, exit)));\n+      /* If the exit phi is not connected to a header phi in the same loop, this\n+\t value is not modified in the loop, and we're done with this phi.  */\n+      if (!(gimple_code (def_stmt) == GIMPLE_PHI\n+\t    && gimple_bb (def_stmt) == loop->header))\n+\tcontinue;\n \n+      gphi *stmt = as_a <gphi *> (def_stmt);\n       def = PHI_ARG_DEF_FROM_EDGE (stmt, loop_preheader_edge (loop));\n       locus = gimple_phi_arg_location_from_edge (stmt,\n \t\t\t\t\t\t loop_preheader_edge (loop));"}]}