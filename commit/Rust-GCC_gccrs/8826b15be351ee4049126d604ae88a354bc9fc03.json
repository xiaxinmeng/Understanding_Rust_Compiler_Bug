{"sha": "8826b15be351ee4049126d604ae88a354bc9fc03", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODgyNmIxNWJlMzUxZWU0MDQ5MTI2ZDYwNGFlODhhMzU0YmM5ZmMwMw==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2001-02-15T12:54:18Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2001-02-15T12:54:18Z"}, "message": "friend.c (do_friend): Don't take the nested [template] class into account when...\n\n* friend.c (do_friend): Don't take the nested [template] class\ninto account when deciding whether to warn about the friend\nfunction not referring to a template function.\n\nFrom-SVN: r39713", "tree": {"sha": "81ac9d8e1448195f72838801e225a13df0dd869d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/81ac9d8e1448195f72838801e225a13df0dd869d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8826b15be351ee4049126d604ae88a354bc9fc03", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8826b15be351ee4049126d604ae88a354bc9fc03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8826b15be351ee4049126d604ae88a354bc9fc03", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8826b15be351ee4049126d604ae88a354bc9fc03/comments", "author": null, "committer": null, "parents": [{"sha": "ff78d08278c15e2d8266575ecba3fcd04c50edc1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff78d08278c15e2d8266575ecba3fcd04c50edc1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff78d08278c15e2d8266575ecba3fcd04c50edc1"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "e8119eac4a7797220a199a59a827756a9200fd3d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8826b15be351ee4049126d604ae88a354bc9fc03/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8826b15be351ee4049126d604ae88a354bc9fc03/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=8826b15be351ee4049126d604ae88a354bc9fc03", "patch": "@@ -1,3 +1,9 @@\n+2001-02-15  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* friend.c (do_friend): Don't take the nested [template] class\n+\tinto account when deciding whether to warn about the friend\n+\tfunction not referring to a template function.\n+\n 2001-02-14  Jakub Jelinek  <jakub@redhat.com>\n \n \t* typeck.c (build_unary_op): Clarify error message."}, {"sha": "170f63bea1de8fc9a2ca0fdfb1960a3dc5a0ce40", "filename": "gcc/cp/friend.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8826b15be351ee4049126d604ae88a354bc9fc03/gcc%2Fcp%2Ffriend.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8826b15be351ee4049126d604ae88a354bc9fc03/gcc%2Fcp%2Ffriend.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ffriend.c?ref=8826b15be351ee4049126d604ae88a354bc9fc03", "patch": "@@ -380,6 +380,14 @@ do_friend (ctype, declarator, decl, parmdecls, attrlist,\n \n       if (! DECL_USE_TEMPLATE (decl))\n \t{\n+\t  /* We must check whether the decl refers to template\n+\t     arguments before push_template_decl_real adds a\n+\t     reference to the containing template class.  */\n+\t  int warn = (warn_nontemplate_friend\n+\t\t      && ! funcdef_flag && ! is_friend_template\n+\t\t      && current_template_parms\n+\t\t      && uses_template_parms (decl));\n+\n \t  /* We can call pushdecl here, because the TREE_CHAIN of this\n \t     FUNCTION_DECL is not needed for other purposes.  Don't do\n \t     this for a template instantiation.  However, we don't\n@@ -393,9 +401,7 @@ do_friend (ctype, declarator, decl, parmdecls, attrlist,\n \t  else \n \t    decl = push_template_decl_real (decl, /*is_friend=*/1); \n \n-\t  if (warn_nontemplate_friend\n-\t      && ! funcdef_flag && ! is_friend_template\n-\t      && current_template_parms && uses_template_parms (decl))\n+\t  if (warn)\n \t    {\n \t      static int explained;\n \t      cp_warning (\"friend declaration `%#D' declares a non-template function\", decl);"}]}