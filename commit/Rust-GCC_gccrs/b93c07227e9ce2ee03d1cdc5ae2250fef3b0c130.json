{"sha": "b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjkzYzA3MjI3ZTljZTJlZTAzZDFjZGM1YWUyMjUwZmVmM2IwYzEzMA==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2014-12-04T23:35:29Z"}, "committer": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2014-12-04T23:35:29Z"}, "message": "line-map.c (linemap_position_for_loc_and_offset): Add new linemap_assert_fails.\n\nlibcpp/ChangeLog:\n\n2014-12-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\n\t* line-map.c (linemap_position_for_loc_and_offset): Add new\n\tlinemap_assert_fails.\n\ngcc/fortran/ChangeLog:\n\n2014-12-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\n\t* scanner.c (gfc_next_char_literal): Use gfc_warning_now.\n\t(load_file): Use the line length as the column hint for\n\tlinemap_line_start. Reserve a location for the highest column of\n\tthe line.\n\nFrom-SVN: r218407", "tree": {"sha": "33789715c13d21a2d6b517515a507f50dc9274ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/33789715c13d21a2d6b517515a507f50dc9274ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/comments", "author": null, "committer": null, "parents": [{"sha": "97aa8bb6e20579f382357ffaa8f7233133fc1e7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97aa8bb6e20579f382357ffaa8f7233133fc1e7c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97aa8bb6e20579f382357ffaa8f7233133fc1e7c"}], "stats": {"total": 33, "additions": 29, "deletions": 4}, "files": [{"sha": "95605b7089d1e4de60092797b6c600a6815d2689", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "patch": "@@ -1,3 +1,10 @@\n+2014-12-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\t* scanner.c (gfc_next_char_literal): Use gfc_warning_now.\n+\t(load_file): Use the line length as the column hint for\n+\tlinemap_line_start. Reserve a location for the highest column of\n+\tthe line.\n+\n 2014-12-03  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n \n \tPR fortran/44054"}, {"sha": "718c323a5cc5e1679229089747958b4d674cdca7", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "patch": "@@ -1056,7 +1056,8 @@ gfc_next_char_literal (gfc_instring in_string)\n \n \t  gfc_current_locus.lb->truncated = 0;\n \t  gfc_current_locus.nextc =  gfc_current_locus.lb->line + maxlen;\n-\t  gfc_warning_now_1 (\"Line truncated at %L\", &gfc_current_locus);\n+\t  gfc_warning_now (OPT_Wline_truncation,\n+\t\t\t   \"Line truncated at %L\", &gfc_current_locus);\n \t  gfc_current_locus.nextc = current_nextc;\n \t}\n \n@@ -1195,7 +1196,8 @@ gfc_next_char_literal (gfc_instring in_string)\n \t  && gfc_current_locus.lb->truncated)\n \t{\n \t  gfc_current_locus.lb->truncated = 0;\n-\t  gfc_warning_now_1 (\"Line truncated at %L\", &gfc_current_locus);\n+\t  gfc_warning_now (OPT_Wline_truncation,\n+\t\t\t   \"Line truncated at %L\", &gfc_current_locus);\n \t}\n \n       prev_openmp_flag = openmp_flag;\n@@ -2044,7 +2046,13 @@ load_file (const char *realfilename, const char *displayedname, bool initial)\n \t\t    + (len + 1) * sizeof (gfc_char_t));\n \n       b->location\n-\t= linemap_line_start (line_table, current_file->line++, 120);\n+\t= linemap_line_start (line_table, current_file->line++, len);\n+      /* ??? We add the location for the maximum column possible here,\n+\t because otherwise if the next call creates a new line-map, it\n+\t will not reserve space for any offset.  */\n+      if (len > 0)\n+\tlinemap_position_for_column (line_table, len);\n+\n       b->file = current_file;\n       b->truncated = trunc;\n       wide_strcpy (b->line, line);"}, {"sha": "29802cd7c9440ac4a9f92b5295ad549ff6dd40fe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "patch": "@@ -1,3 +1,7 @@\n+2014-12-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\t* gfortran.dg/line_length_5.f90: New test.\n+\n 2014-12-04  Sriraman Tallam  <tmsriram@google.com>\n \t    H.J. Lu  <hongjiu.lu@intel.com>\n "}, {"sha": "e26c8c9b5994185deed24289ec1553e0b5e73510", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "patch": "@@ -1,3 +1,8 @@\n+2014-12-05  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\t* line-map.c (linemap_position_for_loc_and_offset): Add new\n+\tlinemap_assert_fails.\n+\n 2014-12-02  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n \n \t* include/line-map.h (linemap_assert_fails): Declare."}, {"sha": "6675634fa9763dde84737fdf446a7c8349cd5da2", "filename": "libcpp/line-map.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/libcpp%2Fline-map.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130/libcpp%2Fline-map.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fline-map.c?ref=b93c07227e9ce2ee03d1cdc5ae2250fef3b0c130", "patch": "@@ -678,7 +678,8 @@ linemap_position_for_loc_and_offset (struct line_maps *set,\n     linemap_position_for_line_and_column (map,\n \t\t\t\t\t  SOURCE_LINE (map, loc),\n \t\t\t\t\t  offset);\n-  if (linemap_assert_fails (map == linemap_lookup (set, r)))\n+  if (linemap_assert_fails (r <= set->highest_location)\n+      || linemap_assert_fails (map == linemap_lookup (set, r)))\n     return loc;\n \n   return r;"}]}