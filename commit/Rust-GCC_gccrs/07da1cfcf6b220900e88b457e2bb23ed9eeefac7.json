{"sha": "07da1cfcf6b220900e88b457e2bb23ed9eeefac7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDdkYTFjZmNmNmIyMjA5MDBlODhiNDU3ZTJiYjIzZWQ5ZWVlZmFjNw==", "commit": {"author": {"name": "Maxim Kuvyrkov", "email": "maxim@codesourcery.com", "date": "2008-08-06T06:20:02Z"}, "committer": {"name": "Maxim Kuvyrkov", "email": "mkuvyrkov@gcc.gnu.org", "date": "2008-08-06T06:20:02Z"}, "message": "sched-rgn.c (new_ready): Check if instruction can be speculatively scheduled before attempting speculation.\n\n\t* sched-rgn.c (new_ready): Check if instruction can be\n\tspeculatively scheduled before attempting speculation.\n\t(debug_rgn_dependencies): Remove wrongful assert.\n\nFrom-SVN: r138757", "tree": {"sha": "db17d5ec271eddbf73c917519bc74a8090394ccb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db17d5ec271eddbf73c917519bc74a8090394ccb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/07da1cfcf6b220900e88b457e2bb23ed9eeefac7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07da1cfcf6b220900e88b457e2bb23ed9eeefac7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07da1cfcf6b220900e88b457e2bb23ed9eeefac7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07da1cfcf6b220900e88b457e2bb23ed9eeefac7/comments", "author": null, "committer": null, "parents": [{"sha": "0f67bdf1cd15b11f00c1cc7476a33393ee77d938", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f67bdf1cd15b11f00c1cc7476a33393ee77d938", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f67bdf1cd15b11f00c1cc7476a33393ee77d938"}], "stats": {"total": 24, "additions": 21, "deletions": 3}, "files": [{"sha": "625b8960534eccbd05c9642c33757ab8fc95e3a2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/07da1cfcf6b220900e88b457e2bb23ed9eeefac7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/07da1cfcf6b220900e88b457e2bb23ed9eeefac7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=07da1cfcf6b220900e88b457e2bb23ed9eeefac7", "patch": "@@ -1,3 +1,9 @@\n+2008-08-06  Maxim Kuvyrkov  <maxim@codesourcery.com>\n+\n+\t* sched-rgn.c (new_ready): Check if instruction can be\n+\tspeculatively scheduled before attempting speculation.\n+\t(debug_rgn_dependencies): Remove wrongful assert.\n+\n 2008-08-05  Bob Wilson  <bob.wilson@acm.org>\n \n \t* config/xtensa/t-xtensa: Remove dependency for gt-xtensa.h."}, {"sha": "9304536b580f15d951955ca37dda7512823bc291", "filename": "gcc/sched-rgn.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/07da1cfcf6b220900e88b457e2bb23ed9eeefac7/gcc%2Fsched-rgn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/07da1cfcf6b220900e88b457e2bb23ed9eeefac7/gcc%2Fsched-rgn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsched-rgn.c?ref=07da1cfcf6b220900e88b457e2bb23ed9eeefac7", "patch": "@@ -2108,9 +2108,22 @@ new_ready (rtx next, ds_t ts)\n \t\t But we possibly can handle that with control speculation.  */\n \t      && (current_sched_info->flags & DO_SPECULATION)\n \t      && (spec_info->mask & BEGIN_CONTROL))\n-            /* Here we got new control-speculative instruction.  */\n-            ts = set_dep_weak (ts, BEGIN_CONTROL, MAX_DEP_WEAK);\n+\t    {\n+\t      ds_t new_ds;\n+\n+\t      /* Add control speculation to NEXT's dependency type.  */\n+\t      new_ds = set_dep_weak (ts, BEGIN_CONTROL, MAX_DEP_WEAK);\n+\n+\t      /* Check if NEXT can be speculated with new dependency type.  */\n+\t      if (sched_insn_is_legitimate_for_speculation_p (next, new_ds))\n+\t\t/* Here we got new control-speculative instruction.  */\n+\t\tts = new_ds;\n+\t      else\n+\t\t/* NEXT isn't ready yet.  */\n+\t\tts = (ts & ~SPECULATIVE) | HARD_DEP;\n+\t    }\n \t  else\n+\t    /* NEXT isn't ready yet.  */\n             ts = (ts & ~SPECULATIVE) | HARD_DEP;\n \t}\n     }\n@@ -2584,7 +2597,6 @@ debug_rgn_dependencies (int from_bb)\n     {\n       rtx head, tail;\n \n-      gcc_assert (EBB_FIRST_BB (bb) == EBB_LAST_BB (bb));\n       get_ebb_head_tail (EBB_FIRST_BB (bb), EBB_LAST_BB (bb), &head, &tail);\n       fprintf (sched_dump, \"\\n;;   --- Region Dependences --- b %d bb %d \\n\",\n \t       BB_TO_BLOCK (bb), bb);"}]}