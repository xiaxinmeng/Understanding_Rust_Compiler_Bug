{"sha": "2a851b5ccfc3c95025e154f5b4c930dd90c21527", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmE4NTFiNWNjZmMzYzk1MDI1ZTE1NGY1YjRjOTMwZGQ5MGMyMTUyNw==", "commit": {"author": {"name": "J\"orn Rennecke", "email": "amylaar@cygnus.co.uk", "date": "1998-01-26T18:13:41Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1998-01-26T18:13:41Z"}, "message": "Patch from Joern to fix dwarf1 bug: emit debug info for types defined in\nparameter lists.\n\t* c-decl.c (grokdeclarator): Get parameter tags from\n\tlast_function_parm_tags.\n\t* dwarfout.c (output_formal_types): Set TREE_ASM_WRITTEN before\n\ttraversing the parameter types.\n\t(output_type): No early exit for FUNCTION_TYPE / METHOD_TYPE context.\n\nFrom-SVN: r17490", "tree": {"sha": "8401a7a70e946b01e5c7597c1298b5221a9fe170", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8401a7a70e946b01e5c7597c1298b5221a9fe170"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a851b5ccfc3c95025e154f5b4c930dd90c21527", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a851b5ccfc3c95025e154f5b4c930dd90c21527", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a851b5ccfc3c95025e154f5b4c930dd90c21527", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a851b5ccfc3c95025e154f5b4c930dd90c21527/comments", "author": null, "committer": null, "parents": [{"sha": "ac2f83cb38a4d1eb9b0ff4705f65bfdaa1b09eaa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac2f83cb38a4d1eb9b0ff4705f65bfdaa1b09eaa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac2f83cb38a4d1eb9b0ff4705f65bfdaa1b09eaa"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "deb2d9c58c361f8ccf68417d78d416bcdd8b7f2c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a851b5ccfc3c95025e154f5b4c930dd90c21527/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a851b5ccfc3c95025e154f5b4c930dd90c21527/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2a851b5ccfc3c95025e154f5b4c930dd90c21527", "patch": "@@ -1,3 +1,11 @@\n+Mon Jan 26 18:11:30 1998  J\"orn Rennecke <amylaar@cygnus.co.uk>\n+\n+\t* c-decl.c (grokdeclarator): Get parameter tags from\n+\tlast_function_parm_tags.\n+\t* dwarfout.c (output_formal_types): Set TREE_ASM_WRITTEN before\n+\ttraversing the parameter types.\n+\t(output_type): No early exit for FUNCTION_TYPE / METHOD_TYPE context.\n+\n Mon Jan 26 01:44:12 1998  Jeffrey A Law  (law@cygnus.com)\n \n \t* h8300.c (print_operand): Handle CONST_DOUBLE for 'e', 'f', and"}, {"sha": "3c000e2523c8700fb452ae30c537af120d1e4ea5", "filename": "gcc/c-decl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a851b5ccfc3c95025e154f5b4c930dd90c21527/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a851b5ccfc3c95025e154f5b4c930dd90c21527/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=2a851b5ccfc3c95025e154f5b4c930dd90c21527", "patch": "@@ -4878,7 +4878,7 @@ grokdeclarator (declarator, declspecs, decl_context, initialized)\n \t  {\n \t    register tree link;\n \n-\t    for (link = current_function_parm_tags;\n+\t    for (link = last_function_parm_tags;\n \t\t link;\n \t\t link = TREE_CHAIN (link))\n \t      TYPE_CONTEXT (TREE_VALUE (link)) = type;"}, {"sha": "406fb89f4cd749747e49d98fc6e9dbc8e12c2e22", "filename": "gcc/dwarfout.c", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a851b5ccfc3c95025e154f5b4c930dd90c21527/gcc%2Fdwarfout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a851b5ccfc3c95025e154f5b4c930dd90c21527/gcc%2Fdwarfout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarfout.c?ref=2a851b5ccfc3c95025e154f5b4c930dd90c21527", "patch": "@@ -4018,6 +4018,12 @@ output_formal_types (function_or_method_type)\n   register tree formal_type = NULL;\n   register tree first_parm_type = TYPE_ARG_TYPES (function_or_method_type);\n \n+  /* Set TREE_ASM_WRITTEN while processing the parameters, lest we\n+     get bogus recursion when outputting tagged types local to a\n+     function declaration.  */\n+  int save_asm_written = TREE_ASM_WRITTEN (function_or_method_type);\n+  TREE_ASM_WRITTEN (function_or_method_type) = 1;\n+\n   /* In the case where we are generating a formal types list for a C++\n      non-static member function type, skip over the first thing on the\n      TYPE_ARG_TYPES list because it only represents the type of the\n@@ -4063,6 +4069,8 @@ output_formal_types (function_or_method_type)\n \n       output_type (formal_type, function_or_method_type);\n     }\n+\n+  TREE_ASM_WRITTEN (function_or_method_type) = save_asm_written;\n }\n \f\n /* Remember a type in the pending_types_list.  */\n@@ -4353,7 +4361,9 @@ output_type (type, containing_scope)\n \n \tif (TYPE_SIZE (type) == 0\n \t    && (TYPE_CONTEXT (type) == NULL\n-\t\t|| TREE_CODE_CLASS (TREE_CODE (TYPE_CONTEXT (type))) == 't')\n+\t\t|| (TREE_CODE_CLASS (TREE_CODE (TYPE_CONTEXT (type))) == 't'\n+\t\t    && TREE_CODE (TYPE_CONTEXT (type)) != FUNCTION_TYPE\n+\t\t    && TREE_CODE (TYPE_CONTEXT (type)) != METHOD_TYPE))\n \t    && !finalizing)\n \t  return;\t/* EARLY EXIT!  Avoid setting TREE_ASM_WRITTEN.  */\n "}]}