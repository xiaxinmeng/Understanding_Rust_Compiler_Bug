{"sha": "855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODU1YjRhYWVhYmRjZGRjZTA0ZmY5Mjk1YzRiMGU2YzdhYTZkYjk2Yg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@golang.org", "date": "2020-02-18T02:16:41Z"}, "committer": {"name": "Ian Lance Taylor", "email": "iant@golang.org", "date": "2020-02-18T20:03:13Z"}, "message": "cmd/go: update -DGOPKGPATH to use current pkgpath encoding\n\nThis will need to be done in the gc version too, probably more cleverly.\nThis version will ensure that the next GCC release works correctly\nwhen using the GCC version of the go tool.\n\nUpdates golang/go#37272\n\nReviewed-on: https://go-review.googlesource.com/c/gofrontend/+/219817", "tree": {"sha": "71d1ac4b10dc34681bd6a1d0598033ff59fa5615", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/71d1ac4b10dc34681bd6a1d0598033ff59fa5615"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b/comments", "author": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ce7b39d0fc694e5ec80520b7cc76f91a5476d7db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce7b39d0fc694e5ec80520b7cc76f91a5476d7db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce7b39d0fc694e5ec80520b7cc76f91a5476d7db"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "ce10ee1d8d466b160c2646af2b8a1c39a59d5045", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b", "patch": "@@ -1,4 +1,4 @@\n-8505defaa91ecc5b42afd02eb335981e8b02b288\n+d5d00d310ec33aeb18f33f807956ec0c4eeea6bb\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "63d5c624f79c5989cfde098a8ad67283282e3e5d", "filename": "libgo/go/cmd/go/internal/work/gccgo.go", "status": "modified", "additions": 20, "deletions": 6, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b/libgo%2Fgo%2Fcmd%2Fgo%2Finternal%2Fwork%2Fgccgo.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b/libgo%2Fgo%2Fcmd%2Fgo%2Finternal%2Fwork%2Fgccgo.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fcmd%2Fgo%2Finternal%2Fwork%2Fgccgo.go?ref=855b4aaeabdcddce04ff9295c4b0e6c7aa6db96b", "patch": "@@ -596,14 +596,28 @@ func gccgoPkgpath(p *load.Package) string {\n \treturn p.ImportPath\n }\n \n+// gccgoCleanPkgpath returns the form of p's pkgpath that gccgo uses\n+// for symbol names. This is like gccgoPkgpathToSymbolNew in cmd/cgo/out.go.\n func gccgoCleanPkgpath(p *load.Package) string {\n-\tclean := func(r rune) rune {\n+\tppath := gccgoPkgpath(p)\n+\tbsl := []byte{}\n+\tchanged := false\n+\tfor _, c := range []byte(ppath) {\n \t\tswitch {\n-\t\tcase 'A' <= r && r <= 'Z', 'a' <= r && r <= 'z',\n-\t\t\t'0' <= r && r <= '9':\n-\t\t\treturn r\n+\t\tcase 'A' <= c && c <= 'Z', 'a' <= c && c <= 'z',\n+\t\t\t'0' <= c && c <= '9', c == '_':\n+\t\t\tbsl = append(bsl, c)\n+\t\tcase c == '.':\n+\t\t\tbsl = append(bsl, \".x2e\"...)\n+\t\t\tchanged = true\n+\t\tdefault:\n+\t\t\tencbytes := []byte(fmt.Sprintf(\"..z%02x\", c))\n+\t\t\tbsl = append(bsl, encbytes...)\n+\t\t\tchanged = true\n \t\t}\n-\t\treturn '_'\n \t}\n-\treturn strings.Map(clean, gccgoPkgpath(p))\n+\tif !changed {\n+\t\treturn ppath\n+\t}\n+\treturn string(bsl)\n }"}]}