{"sha": "03f8829b50afa18835aa63de08232247f09289a8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDNmODgyOWI1MGFmYTE4ODM1YWE2M2RlMDgyMzIyNDdmMDkyODlhOA==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernd.schmidt@analog.com", "date": "2009-03-25T23:53:39Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2009-03-25T23:53:39Z"}, "message": "bfin.c (bfin_optimize_loop): If the LSETUP goes before a jump insn...\n\n\t* config/bfin/bfin.c (bfin_optimize_loop): If the LSETUP goes before\n\ta jump insn, count that jump in the distance to the loop start.\n\nFrom-SVN: r145080", "tree": {"sha": "eb9a7388e0ffde6448465cdc51561a41e66015ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eb9a7388e0ffde6448465cdc51561a41e66015ff"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/03f8829b50afa18835aa63de08232247f09289a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03f8829b50afa18835aa63de08232247f09289a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03f8829b50afa18835aa63de08232247f09289a8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03f8829b50afa18835aa63de08232247f09289a8/comments", "author": null, "committer": null, "parents": [{"sha": "c0b753c770f46f8bdfc868b532080e5425f1c46e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0b753c770f46f8bdfc868b532080e5425f1c46e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0b753c770f46f8bdfc868b532080e5425f1c46e"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "1f525bfb35d4a33c0c858496c7b83d26234650fa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03f8829b50afa18835aa63de08232247f09289a8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03f8829b50afa18835aa63de08232247f09289a8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=03f8829b50afa18835aa63de08232247f09289a8", "patch": "@@ -1,3 +1,8 @@\n+2009-03-26  Bernd Schmidt  <bernd.schmidt@analog.com>\n+\n+\t* config/bfin/bfin.c (bfin_optimize_loop): If the LSETUP goes before\n+\ta jump insn, count that jump in the distance to the loop start.\n+\n 2009-03-25  Kaz Kojima  <kkojima@gcc.gnu.org>\n \n \tPR target/39523"}, {"sha": "d1c964d02ea2145e5aa9801d483d0508e16896fb", "filename": "gcc/config/bfin/bfin.c", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03f8829b50afa18835aa63de08232247f09289a8/gcc%2Fconfig%2Fbfin%2Fbfin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03f8829b50afa18835aa63de08232247f09289a8/gcc%2Fconfig%2Fbfin%2Fbfin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fbfin%2Fbfin.c?ref=03f8829b50afa18835aa63de08232247f09289a8", "patch": "@@ -3854,9 +3854,17 @@ bfin_optimize_loop (loop_info loop)\n       /* Make sure the predecessor is before the loop start label, as required by\n \t the LSETUP instruction.  */\n       length = 0;\n-      for (insn = BB_END (loop->incoming_src);\n-\t   insn && insn != loop->start_label;\n-\t   insn = NEXT_INSN (insn))\n+      insn = BB_END (loop->incoming_src);\n+      /* If we have to insert the LSETUP before a jump, count that jump in the\n+\t length.  */\n+      if (VEC_length (edge, loop->incoming) > 1\n+\t  || !(VEC_last (edge, loop->incoming)->flags & EDGE_FALLTHRU))\n+\t{\n+\t  gcc_assert (JUMP_P (insn));\n+\t  insn = PREV_INSN (insn);\n+\t}\n+\n+      for (; insn && insn != loop->start_label; insn = NEXT_INSN (insn))\n \tlength += length_for_loop (insn);\n       \n       if (!insn)"}]}