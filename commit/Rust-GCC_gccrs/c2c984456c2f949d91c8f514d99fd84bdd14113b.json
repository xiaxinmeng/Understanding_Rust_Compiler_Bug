{"sha": "c2c984456c2f949d91c8f514d99fd84bdd14113b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzJjOTg0NDU2YzJmOTQ5ZDkxYzhmNTE0ZDk5ZmQ4NGJkZDE0MTEzYg==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2003-01-24T17:44:03Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2003-01-24T17:44:03Z"}, "message": "class.c (build_static_field_ref): Only a String or numeric field can fold to a constant.\n\n\t* class.c (build_static_field_ref): Only a String or numeric field\n\tcan fold to a constant.\n\nFrom-SVN: r61723", "tree": {"sha": "4721e77b27ce0835e2eb4e96ac083a7a72f02eb2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4721e77b27ce0835e2eb4e96ac083a7a72f02eb2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c2c984456c2f949d91c8f514d99fd84bdd14113b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2c984456c2f949d91c8f514d99fd84bdd14113b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2c984456c2f949d91c8f514d99fd84bdd14113b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2c984456c2f949d91c8f514d99fd84bdd14113b/comments", "author": null, "committer": null, "parents": [{"sha": "38997f1bf5ea21dc05d978620d031da33083093d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38997f1bf5ea21dc05d978620d031da33083093d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38997f1bf5ea21dc05d978620d031da33083093d"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "5c2199eb3c502f8945e559bc35ed09f3ce3e747f", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2c984456c2f949d91c8f514d99fd84bdd14113b/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2c984456c2f949d91c8f514d99fd84bdd14113b/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=c2c984456c2f949d91c8f514d99fd84bdd14113b", "patch": "@@ -1,3 +1,8 @@\n+2003-01-24  Tom Tromey  <tromey@redhat.com>\n+\n+\t* class.c (build_static_field_ref): Only a String or numeric field\n+\tcan fold to a constant.\n+\n 2003-01-23  Tom Tromey  <tromey@redhat.com>\n \n \t* jcf-parse.c (parse_zip_file_entries): Overwrite trailing \\0 of"}, {"sha": "dfaf6f15f99792d4565a0b2bfcca59848c1c6d83", "filename": "gcc/java/class.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2c984456c2f949d91c8f514d99fd84bdd14113b/gcc%2Fjava%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2c984456c2f949d91c8f514d99fd84bdd14113b/gcc%2Fjava%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fclass.c?ref=c2c984456c2f949d91c8f514d99fd84bdd14113b", "patch": "@@ -922,8 +922,18 @@ build_static_field_ref (tree fdecl)\n   tree fclass = DECL_CONTEXT (fdecl);\n   int is_compiled = is_compiled_class (fclass);\n \n-  /* Allow static final fields to fold to a constant.  */\n-  if (is_compiled || FIELD_FINAL (fdecl))\n+  /* Allow static final fields to fold to a constant.  When using\n+     -fno-assume-compiled, gcj will sometimes try to fold a field from\n+     an uncompiled class.  This is required when the field in question\n+     meets the appropriate criteria for a compile-time constant.\n+     However, currently sometimes gcj is too eager and will end up\n+     returning the field itself, leading to an incorrect external\n+     reference being generated.  */\n+  if (is_compiled\n+      || (FIELD_FINAL (fdecl) && DECL_INITIAL (fdecl) != NULL_TREE\n+\t  && (JSTRING_TYPE_P (TREE_TYPE (fdecl))\n+\t      || JNUMERIC_TYPE_P (TREE_TYPE (fdecl)))\n+\t  && TREE_CONSTANT (DECL_INITIAL (fdecl))))\n     {\n       if (!DECL_RTL_SET_P (fdecl))\n \t{"}]}