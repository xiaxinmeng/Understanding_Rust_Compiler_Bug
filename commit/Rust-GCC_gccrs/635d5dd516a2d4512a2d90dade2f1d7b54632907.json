{"sha": "635d5dd516a2d4512a2d90dade2f1d7b54632907", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjM1ZDVkZDUxNmEyZDQ1MTJhMmQ5MGRhZGUyZjFkN2I1NDYzMjkwNw==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2015-11-17T21:42:18Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2015-11-17T21:42:18Z"}, "message": "Clear LOOP_CLOSED_SSA after pass_ccp\n\n2015-11-17  Tom de Vries  <tom@codesourcery.com>\n\n\t* tree-ssa-ccp.c (do_ssa_ccp): Clear LOOP_CLOSED_SSA in loops state if\n\tsomething changed.\n\nFrom-SVN: r230503", "tree": {"sha": "8b600ea7ddcf61bab17ed51f133760c271cd696e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8b600ea7ddcf61bab17ed51f133760c271cd696e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/635d5dd516a2d4512a2d90dade2f1d7b54632907", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/635d5dd516a2d4512a2d90dade2f1d7b54632907", "html_url": "https://github.com/Rust-GCC/gccrs/commit/635d5dd516a2d4512a2d90dade2f1d7b54632907", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/635d5dd516a2d4512a2d90dade2f1d7b54632907/comments", "author": null, "committer": null, "parents": [{"sha": "886c388d74901f294841263f2c2400fe8a586eae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/886c388d74901f294841263f2c2400fe8a586eae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/886c388d74901f294841263f2c2400fe8a586eae"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "a21f18bbb8200efdea351966e4206672ac5c2cf1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/635d5dd516a2d4512a2d90dade2f1d7b54632907/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/635d5dd516a2d4512a2d90dade2f1d7b54632907/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=635d5dd516a2d4512a2d90dade2f1d7b54632907", "patch": "@@ -1,3 +1,8 @@\n+2015-11-17  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* tree-ssa-ccp.c (do_ssa_ccp): Clear LOOP_CLOSED_SSA in loops state if\n+\tsomething changed.\n+\n 2015-11-17  Tom de Vries  <tom@codesourcery.com>\n \n \t* cfgloop.h (struct loop): Add in_oacc_kernels_region field."}, {"sha": "7e8bc5276e997d80a6a3c0ec8cd4f01e0e5a2fef", "filename": "gcc/tree-ssa-ccp.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/635d5dd516a2d4512a2d90dade2f1d7b54632907/gcc%2Ftree-ssa-ccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/635d5dd516a2d4512a2d90dade2f1d7b54632907/gcc%2Ftree-ssa-ccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-ccp.c?ref=635d5dd516a2d4512a2d90dade2f1d7b54632907", "patch": "@@ -139,6 +139,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"params.h\"\n #include \"builtins.h\"\n #include \"tree-chkp.h\"\n+#include \"cfgloop.h\"\n \n \n /* Possible lattice values.  */\n@@ -2402,10 +2403,17 @@ do_ssa_ccp (bool nonzero_p)\n {\n   unsigned int todo = 0;\n   calculate_dominance_info (CDI_DOMINATORS);\n+\n   ccp_initialize ();\n   ssa_propagate (ccp_visit_stmt, ccp_visit_phi_node);\n   if (ccp_finalize (nonzero_p))\n-    todo = (TODO_cleanup_cfg | TODO_update_ssa);\n+    {\n+      todo = (TODO_cleanup_cfg | TODO_update_ssa);\n+\n+      /* ccp_finalize does not preserve loop-closed ssa.  */\n+      loops_state_clear (LOOP_CLOSED_SSA);\n+    }\n+\n   free_dominance_info (CDI_DOMINATORS);\n   return todo;\n }"}]}