{"sha": "76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzZlZDBjMGE0YmQ3NGExNDBlMGRlNTc4ZWI5NGYyZmQ5Njk2NDZiZA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@cygnus.com", "date": "1999-10-15T16:53:41Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "1999-10-15T16:53:41Z"}, "message": "gij.cc (main): Formatting fixes.\n\n\t* gij.cc (main): Formatting fixes.\n\t(_Jv_Compiler_Properties): Define.\n\t* java/lang/natSystem.cc (_Jv_Environment_Properties): Don't\n\tdeclare.\n\t(init_properties): Set properites from _Jv_Compiler_Properties.\n\t* include/java-props.h (_Jv_Compiler_Properties,\n\t_Jv_Environment_Properties): Declare.\n\nFrom-SVN: r30020", "tree": {"sha": "d36cc38c405c94aa7604774dd40bb59ca0cc4485", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d36cc38c405c94aa7604774dd40bb59ca0cc4485"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/comments", "author": null, "committer": null, "parents": [{"sha": "7cf41963391146126ec2d0064e8fb573fc0addf5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7cf41963391146126ec2d0064e8fb573fc0addf5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7cf41963391146126ec2d0064e8fb573fc0addf5"}], "stats": {"total": 45, "additions": 39, "deletions": 6}, "files": [{"sha": "4f37d8a66f2499db7f516f661e3b9d915df87baa", "filename": "libjava/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "patch": "@@ -1,5 +1,13 @@\n 1999-10-15  Tom Tromey  <tromey@cygnus.com>\n \n+\t* gij.cc (main): Formatting fixes.\n+\t(_Jv_Compiler_Properties): Define.\n+\t* java/lang/natSystem.cc (_Jv_Environment_Properties): Don't\n+\tdeclare.\n+\t(init_properties): Set properites from _Jv_Compiler_Properties.\n+\t* include/java-props.h (_Jv_Compiler_Properties,\n+\t_Jv_Environment_Properties): Declare.\n+\n \t* include/java-props.h: Added copyright.\n \n 1999-10-13  Anthony Green  <green@cygnus.com>"}, {"sha": "b851b77dcd8ffc442dc9393697293fb0eb6d49e3", "filename": "libjava/gij.cc", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2Fgij.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2Fgij.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgij.cc?ref=76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "patch": "@@ -15,13 +15,20 @@ details.  */\n #include <java/lang/System.h>\n #include <java/util/Properties.h>\n \n-int main (int argc, const char **argv)\n+// This is used to initialize the compiled-in system properties.\n+const char *_Jv_Compiler_Properties[] =\n+{\n+  NULL\n+};\n+\n+int\n+main (int argc, const char **argv)\n {\n   if (argc < 2)\n     {\n-      printf (\"usage: %s <class name> args\\n\", argv[0]);\n+      printf (\"usage: %s CLASS [ARGS]...\\n\", argv[0]);\n       exit (1);\n     }\n \n-  _Jv_RunMain (argv[1], argc-1, argv+1);\n+  _Jv_RunMain (argv[1], argc - 1, argv + 1);\n }"}, {"sha": "65130da88142009bcef30ef5ef6489c0ac227179", "filename": "libjava/include/java-props.h", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2Finclude%2Fjava-props.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2Finclude%2Fjava-props.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2Fjava-props.h?ref=76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "patch": "@@ -19,5 +19,11 @@ typedef struct\n   size_t      value_length;\n } property_pair;\n \n+// The compiler generates this declaration.\n+extern char *_Jv_Compiler_Properties[];\n+\n+// Properties taken from the user's environment.\n+extern property_pair *_Jv_Environment_Properties;\n+\n #endif\n "}, {"sha": "268c1cc480322357cb610e2cc6e3009cd2da55ad", "filename": "libjava/java/lang/natSystem.cc", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2Fjava%2Flang%2FnatSystem.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76ed0c0a4bd74a140e0de578eb94f2fd969646bd/libjava%2Fjava%2Flang%2FnatSystem.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatSystem.cc?ref=76ed0c0a4bd74a140e0de578eb94f2fd969646bd", "patch": "@@ -53,7 +53,6 @@ details.  */\n #define SystemClass _CL_Q34java4lang6System\n extern java::lang::Class SystemClass;\n \n-extern property_pair *_Jv_Environment_Properties;\n \f\n \n #if defined (ECOS)\n@@ -336,8 +335,8 @@ java::lang::System::init_properties (void)\n \n   while (buf_r != NULL)\n     {\n-      int r = getpwuid_adaptor\n-\t(getpwuid_r, user_id, &pwd_r, buf_r, len_r, &pwd_entry);\n+      int r = getpwuid_adaptor (getpwuid_r, user_id, &pwd_r,\n+\t\t\t\tbuf_r, len_r, &pwd_entry);\n       if (r == 0)\n \tbreak;\n       else if (r != ERANGE)\n@@ -379,6 +378,19 @@ java::lang::System::init_properties (void)\n     free (buffer);\n #endif\n \n+  // Set some properties according to whatever was compiled in with\n+  // `-D'.\n+  for (int i = 0; _Jv_Compiler_Properties[i]; ++i)\n+    {\n+      const char *s, *p;\n+      // Find the `='.\n+      for (s = p = _Jv_Compiler_Properties[i]; *s && *s != '='; ++s)\n+\t;\n+      jstring name = JvNewStringLatin1 (p, s - p);\n+      jstring val = JvNewStringLatin1 (*s == '=' ? s + 1 : s);\n+      properties->put (name, val);\n+    }\n+\n   // Set the system properties from the user's environment.\n   if (_Jv_Environment_Properties)\n     {"}]}