{"sha": "5147e0e84ef1daf08576c2ebc477b8941f54578f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTE0N2UwZTg0ZWYxZGFmMDg1NzZjMmViYzQ3N2I4OTQxZjU0NTc4Zg==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2016-03-03T01:40:29Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2016-03-03T01:40:29Z"}, "message": "re PR libffi/70024 (libffi ABI change w/o SONAME bump)\n\nPR libffi/70024\n\n  * Makefile.am (libffi_version_script): Look in cwd for libffi.map.\n  (libffi_version_dep, libffi.map-sun): Likewise.\n  (libffi.map): New target.\n  * libffi.map.in: Rename from libffi.map.  Add required defines,\n  includes, and conditionals.\n\nFrom-SVN: r233926", "tree": {"sha": "1b70274ec41ac71ca49f129a0d1c0168a372b4de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b70274ec41ac71ca49f129a0d1c0168a372b4de"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5147e0e84ef1daf08576c2ebc477b8941f54578f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5147e0e84ef1daf08576c2ebc477b8941f54578f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5147e0e84ef1daf08576c2ebc477b8941f54578f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5147e0e84ef1daf08576c2ebc477b8941f54578f/comments", "author": null, "committer": null, "parents": [{"sha": "72c5cfd2052df06d369be2e1ef2688fecce9652f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72c5cfd2052df06d369be2e1ef2688fecce9652f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/72c5cfd2052df06d369be2e1ef2688fecce9652f"}], "stats": {"total": 46, "additions": 31, "deletions": 15}, "files": [{"sha": "7b23599fe2bf50938ae35970f2d681914370b60a", "filename": "libffi/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=5147e0e84ef1daf08576c2ebc477b8941f54578f", "patch": "@@ -16,6 +16,12 @@\n \t* Makefile.in, configure: Rebuild.\n \t* man/Makefile.in, testsuite/Makefile.in: Rebuild.\n \n+\t* Makefile.am (libffi_version_script): Look in cwd for libffi.map.\n+\t(libffi_version_dep, libffi.map-sun): Likewise.\n+\t(libffi.map): New target.\n+\t* libffi.map.in: Rename from libffi.map.  Add required defines,\n+\tincludes, and conditionals.\n+\n 2015-10-26  John David Anglin  <danglin@gcc.gnu.org>\n \n \tPR libffi/65441"}, {"sha": "dd10cb1ebb8cc0619a208e71767afb4ebf30d6ef", "filename": "libffi/Makefile.am", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.am?ref=5147e0e84ef1daf08576c2ebc477b8941f54578f", "patch": "@@ -206,17 +206,15 @@ endif\n \n if LIBAT_BUILD_VERSIONED_SHLIB\n if LIBAT_BUILD_VERSIONED_SHLIB_GNU\n-libffi_version_script = -Wl,--version-script,$(top_srcdir)/libffi.map\n-libffi_version_dep = $(top_srcdir)/libffi.map\n+libffi_version_script = -Wl,--version-script,libffi.map\n+libffi_version_dep = libffi.map\n endif\n if LIBAT_BUILD_VERSIONED_SHLIB_SUN\n libffi_version_script = -Wl,-M,libffi.map-sun\n libffi_version_dep = libffi.map-sun\n-libffi.map-sun : $(top_srcdir)/libffi.map \\\n-                $(top_srcdir)/../contrib/make_sunver.pl \\\n+libffi.map-sun : libffi.map $(top_srcdir)/../contrib/make_sunver.pl \\\n                 $(libffi_la_OBJECTS) $(libffi_la_LIBADD)\n-        perl $(top_srcdir)/../contrib/make_sunver.pl \\\n-          $(top_srcdir)/libffi.map \\\n+        perl $(top_srcdir)/../contrib/make_sunver.pl libffi.map \\\n           $(libffi_la_OBJECTS:%.lo=.libs/%.o) \\\n          `echo $(libffi_la_LIBADD) | \\\n             sed 's,\\([^/        ]*\\)\\.l\\([ao]\\),.libs/\\1.\\2,g'` \\\n@@ -228,6 +226,9 @@ libffi_version_dep =\n endif\n libffi_version_info = -version-info `grep -v '^\\#' $(srcdir)/libtool-version`\n \n+libffi.map: $(top_srcdir)/libffi.map.in\n+\t$(COMPILE) -D$(TARGET) -E -x assembler-with-cpp -o $@ $<\n+\n libffi_la_LDFLAGS = -no-undefined $(libffi_version_info) $(libffi_version_script) $(LTLDFLAGS) $(AM_LTLDFLAGS)\n libffi_la_DEPENDENCIES = $(libffi_la_LIBADD) $(libffi_version_dep)\n "}, {"sha": "c603e45691d1bef697bb9dc6dff23e15a68b7871", "filename": "libffi/Makefile.in", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.in?ref=5147e0e84ef1daf08576c2ebc477b8941f54578f", "patch": "@@ -488,10 +488,10 @@ nodist_libffi_convenience_la_SOURCES = $(nodist_libffi_la_SOURCES)\n LTLDFLAGS = $(shell $(SHELL) $(top_srcdir)/../libtool-ldflags $(LDFLAGS))\n AM_CFLAGS = -Wall -g -fexceptions $(am__append_2)\n @LIBAT_BUILD_VERSIONED_SHLIB_FALSE@libffi_version_script = \n-@LIBAT_BUILD_VERSIONED_SHLIB_GNU_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi_version_script = -Wl,--version-script,$(top_srcdir)/libffi.map\n+@LIBAT_BUILD_VERSIONED_SHLIB_GNU_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi_version_script = -Wl,--version-script,libffi.map\n @LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi_version_script = -Wl,-M,libffi.map-sun\n @LIBAT_BUILD_VERSIONED_SHLIB_FALSE@libffi_version_dep = \n-@LIBAT_BUILD_VERSIONED_SHLIB_GNU_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi_version_dep = $(top_srcdir)/libffi.map\n+@LIBAT_BUILD_VERSIONED_SHLIB_GNU_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi_version_dep = libffi.map\n @LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi_version_dep = libffi.map-sun\n libffi_version_info = -version-info `grep -v '^\\#' $(srcdir)/libtool-version`\n libffi_la_LDFLAGS = -no-undefined $(libffi_version_info) $(libffi_version_script) $(LTLDFLAGS) $(AM_LTLDFLAGS)\n@@ -1901,16 +1901,17 @@ doc/libffi.info: $(STAMP_BUILD_INFO)\n stamp-build-info: doc/libffi.texi $(srcdir)/doc/version.texi doc/$(am__dirstamp)\n \t$(MAKEINFO) $(AM_MAKEINFOFLAGS) $(MAKEINFOFLAGS) -I $(srcdir)/doc -o doc/libffi.info $(srcdir)/doc/libffi.texi\n \t@touch $@\n-@LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi.map-sun : $(top_srcdir)/libffi.map \\\n-@LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@                $(top_srcdir)/../contrib/make_sunver.pl \\\n+@LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@libffi.map-sun : libffi.map $(top_srcdir)/../contrib/make_sunver.pl \\\n @LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@                $(libffi_la_OBJECTS) $(libffi_la_LIBADD)\n-@LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@        perl $(top_srcdir)/../contrib/make_sunver.pl \\\n-@LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@          $(top_srcdir)/libffi.map \\\n+@LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@        perl $(top_srcdir)/../contrib/make_sunver.pl libffi.map \\\n @LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@          $(libffi_la_OBJECTS:%.lo=.libs/%.o) \\\n @LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@         `echo $(libffi_la_LIBADD) | \\\n @LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@            sed 's,\\([^/        ]*\\)\\.l\\([ao]\\),.libs/\\1.\\2,g'` \\\n @LIBAT_BUILD_VERSIONED_SHLIB_SUN_TRUE@@LIBAT_BUILD_VERSIONED_SHLIB_TRUE@         > $@ || (rm -f $@ ; exit 1)\n \n+libffi.map: $(top_srcdir)/libffi.map.in\n+\t$(COMPILE) -D$(TARGET) -E -x assembler-with-cpp -o $@ $<\n+\n # Multilib support.  Automake should provide these on its own.\n all-recursive: all-multi\n install-recursive: install-multi"}, {"sha": "ca509671a8038f79c2d4848249c29371d9ea5948", "filename": "libffi/libffi.map.in", "status": "renamed", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2Flibffi.map.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5147e0e84ef1daf08576c2ebc477b8941f54578f/libffi%2Flibffi.map.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Flibffi.map.in?ref=5147e0e84ef1daf08576c2ebc477b8941f54578f", "patch": "@@ -1,3 +1,8 @@\n+#define LIBFFI_ASM\n+#define LIBFFI_H\n+#include <fficonfig.h>\n+#include <ffitarget.h>\n+\n LIBFFI_BASE_5 {\n   global:\n \t/* Exported data variables.  */\n@@ -40,16 +45,17 @@ LIBFFI_BASE_5 {\n \t*;\n };\n \n-/* This section is optional based on FFI_TARGET_HAS_COMPLEX_TYPE.  */\n+#ifdef FFI_TARGET_HAS_COMPLEX_TYPE\n LIBFFI_COMPLEX_5 {\n   global:\n \t/* Exported data variables.  */\n \tffi_type_complex_float;\n \tffi_type_complex_double;\n \tffi_type_complex_longdouble;\n } LIBFFI_BASE_5;\n+#endif\n \n-/* This section is optional based on FFI_CLOSURES.  */\n+#if FFI_CLOSURES\n LIBFFI_CLOSURE_5 {\n   global:\n \tffi_closure_alloc;\n@@ -61,10 +67,12 @@ LIBFFI_CLOSURE_5 {\n \tffi_prep_java_raw_closure;\n \tffi_prep_java_raw_closure_loc;\n } LIBFFI_BASE_5;\n+#endif\n \n-/* This section is optional based on FFI_GO_CLOSURES.  */\n+#if FFI_GO_CLOSURES\n LIBFFI_GO_CLOSURE_5 {\n   global:\n \tffi_call_go;\n \tffi_prep_go_closure;\n } LIBFFI_CLOSURE_5;\n+#endif", "previous_filename": "libffi/libffi.map"}]}