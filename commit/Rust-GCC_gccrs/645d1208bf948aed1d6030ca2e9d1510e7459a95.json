{"sha": "645d1208bf948aed1d6030ca2e9d1510e7459a95", "node_id": "C_kwDOANBUbNoAKDY0NWQxMjA4YmY5NDhhZWQxZDYwMzBjYTJlOWQxNTEwZTc0NTlhOTU", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2022-07-25T20:41:21Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "poulhies@adacore.com", "date": "2022-09-05T07:21:05Z"}, "message": "[Ada] Fix detection of unused warning suppression\n\nThe comment for Warnings_Off says: \"clients should generally not test\nthis flag directly, but instead use function Has_Warnings_Off\".\n\nPrimarily a code cleanup, as this only affects minor a corner case.\n\ngcc/ada/\n\n\t* sem_ch13.adb (Validate_Unchecked_Conversions): Use\n\tHas_Warnings_Off.\n\t* sem_elab.adb (Check_Internal_Call_Continue): Likewise.", "tree": {"sha": "a8cd494599973050e8dce6b27331c21dd5002c24", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a8cd494599973050e8dce6b27331c21dd5002c24"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/645d1208bf948aed1d6030ca2e9d1510e7459a95", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/645d1208bf948aed1d6030ca2e9d1510e7459a95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/645d1208bf948aed1d6030ca2e9d1510e7459a95", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/645d1208bf948aed1d6030ca2e9d1510e7459a95/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "95d9823d289fa8fe7be0a299993027f5e6e7824f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95d9823d289fa8fe7be0a299993027f5e6e7824f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/95d9823d289fa8fe7be0a299993027f5e6e7824f"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "4d1644be0492cb5d5940f2d7b24ab54369418471", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/645d1208bf948aed1d6030ca2e9d1510e7459a95/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/645d1208bf948aed1d6030ca2e9d1510e7459a95/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=645d1208bf948aed1d6030ca2e9d1510e7459a95", "patch": "@@ -17726,7 +17726,9 @@ package body Sem_Ch13 is\n          begin\n             --  Skip if function marked as warnings off\n \n-            if Warnings_Off (Act_Unit) or else Serious_Errors_Detected > 0 then\n+            if Has_Warnings_Off (Act_Unit)\n+              or else Serious_Errors_Detected > 0\n+            then\n                goto Continue;\n             end if;\n "}, {"sha": "b8e3fb6cb88c9c654d69a1f5d3ff0e166c6eb17f", "filename": "gcc/ada/sem_elab.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/645d1208bf948aed1d6030ca2e9d1510e7459a95/gcc%2Fada%2Fsem_elab.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/645d1208bf948aed1d6030ca2e9d1510e7459a95/gcc%2Fada%2Fsem_elab.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_elab.adb?ref=645d1208bf948aed1d6030ca2e9d1510e7459a95", "patch": "@@ -18767,9 +18767,9 @@ package body Sem_Elab is\n                      T : constant Entity_Id := Etype (First_Formal (E));\n                   begin\n                      if Is_Controlled (T) then\n-                        if Warnings_Off (T)\n+                        if Has_Warnings_Off (T)\n                           or else (Ekind (T) = E_Private_Type\n-                                    and then Warnings_Off (Full_View (T)))\n+                                    and then Has_Warnings_Off (Full_View (T)))\n                         then\n                            goto Output;\n                         end if;"}]}