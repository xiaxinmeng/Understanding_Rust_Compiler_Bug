{"sha": "9881e3e5e8b19559f67332ea3f027c315933aed0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTg4MWUzZTVlOGIxOTU1OWY2NzMzMmVhM2YwMjdjMzE1OTMzYWVkMA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2005-07-22T17:40:37Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2005-07-22T17:40:37Z"}, "message": "re PR debug/21828 (debug info omitted for uninitialized variables)\n\n\tPR debug/21828\n\t* toplev.c (check_global_declarations): Do not mark undefined\n\tvariables as DECL_IGNORED_P.\n\t* varasm.c (first_global_object_name): GTY it.\n\t(weak_global_object_name): Likewise.\n\t(notice_global_symbol): Use ggc_strdup, not xstrdup, when creating\n\ta string to go into {weak,first}_global_object_name.\n\n\tPR debug/21828\n\t* gcc.dg/debug/dwarf2/dwarf-uninit.c: New test.\n\nFrom-SVN: r102287", "tree": {"sha": "0803afaa84c77bde73aa2d88d39c8c1d727a9b2c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0803afaa84c77bde73aa2d88d39c8c1d727a9b2c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9881e3e5e8b19559f67332ea3f027c315933aed0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9881e3e5e8b19559f67332ea3f027c315933aed0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9881e3e5e8b19559f67332ea3f027c315933aed0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9881e3e5e8b19559f67332ea3f027c315933aed0/comments", "author": null, "committer": null, "parents": [{"sha": "1a8d0d41ac5e1593cebec8a1fc7b01d5e61f7018", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a8d0d41ac5e1593cebec8a1fc7b01d5e61f7018", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a8d0d41ac5e1593cebec8a1fc7b01d5e61f7018"}], "stats": {"total": 39, "additions": 30, "deletions": 9}, "files": [{"sha": "b4b36143da0abc4dd9739a421e197fefe5111dd1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9881e3e5e8b19559f67332ea3f027c315933aed0", "patch": "@@ -1,3 +1,13 @@\n+2005-07-22  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR debug/21828\n+\t* toplev.c (check_global_declarations): Do not mark undefined\n+\tvariables as DECL_IGNORED_P.\n+\t* varasm.c (first_global_object_name): GTY it.\n+\t(weak_global_object_name): Likewise.\n+\t(notice_global_symbol): Use ggc_strdup, not xstrdup, when creating\n+\ta string to go into {weak,first}_global_object_name.\n+\n 2005-07-22  DJ Delorie  <dj@redhat.com>\n \n \t* c-format.c (check_function_format): Change warning control"}, {"sha": "64a5887655ad714fc35e3c424fb23b5424915989", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9881e3e5e8b19559f67332ea3f027c315933aed0", "patch": "@@ -1,3 +1,8 @@\n+2005-07-22  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR debug/21828\n+\t* gcc.dg/debug/dwarf2/dwarf-uninit.c: New test.\n+\n 2005-07-22  Diego Novillo  <dnovillo@redhat.com>\n \n \t* gcc.dg/tree-ssa/20050719-1.c: New test."}, {"sha": "f0237cc823cc71f1dc5e36bb0ced324b56e3ffec", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/dwarf-uninit.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fdwarf-uninit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fdwarf-uninit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fdwarf-uninit.c?ref=9881e3e5e8b19559f67332ea3f027c315933aed0", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile */\n+/* { dg-options \"-O2 -gdwarf-2 -dA\" } */\n+/* { dg-final { scan-assembler \"DW_TAG_variable\" } } */\n+/* PR debug/21828 */\n+\n+static int i;\n+int main() {\n+  i += 3;\n+  return 0;\n+}"}, {"sha": "b5ee33b33b8e299f44ff04e380aa1a7a48ae2c78", "filename": "gcc/toplev.c", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=9881e3e5e8b19559f67332ea3f027c315933aed0", "patch": "@@ -802,13 +802,6 @@ check_global_declarations (tree *vec, int len)\n     {\n       decl = vec[i];\n \n-      /* Do not emit debug information about variables that are in\n-\t static storage, but not defined.  */\n-      if (TREE_CODE (decl) == VAR_DECL\n-\t  && TREE_STATIC (decl)\n-\t  && !TREE_ASM_WRITTEN (decl))\n-\tDECL_IGNORED_P (decl) = 1;\n- \n       /* Warn about any function\n \t declared static but not defined.\n \t We don't warn about variables,"}, {"sha": "3ef81468850255ed4bd101caf86fdec7ba34834d", "filename": "gcc/varasm.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9881e3e5e8b19559f67332ea3f027c315933aed0/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=9881e3e5e8b19559f67332ea3f027c315933aed0", "patch": "@@ -60,6 +60,9 @@ Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA\n #endif\n \n /* The (assembler) name of the first globally-visible object output.  */\n+extern GTY(()) const char *first_global_object_name;\n+extern GTY(()) const char *weak_global_object_name;\n+\n const char *first_global_object_name;\n const char *weak_global_object_name;\n \n@@ -1207,11 +1210,11 @@ notice_global_symbol (tree decl)\n   if (!*type)\n     {\n       const char *p;\n-      char *name;\n+      const char *name;\n       rtx decl_rtl = DECL_RTL (decl);\n \n       p = targetm.strip_name_encoding (XSTR (XEXP (decl_rtl, 0), 0));\n-      name = xstrdup (p);\n+      name = ggc_strdup (p);\n \n       *type = name;\n     }"}]}