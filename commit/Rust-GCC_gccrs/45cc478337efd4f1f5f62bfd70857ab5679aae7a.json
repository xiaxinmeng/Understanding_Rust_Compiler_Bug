{"sha": "45cc478337efd4f1f5f62bfd70857ab5679aae7a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDVjYzQ3ODMzN2VmZDRmMWY1ZjYyYmZkNzA4NTdhYjU2NzlhYWU3YQ==", "commit": {"author": {"name": "Mike Stump", "email": "mrs@apple.com", "date": "2004-07-10T05:54:27Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2004-07-10T05:54:27Z"}, "message": "darwin.c (no_dead_strip): Add.\n\n        * config/darwin.c (no_dead_strip): Add.\n        (HAVE_DEAD_STRIP): Add.\n        (darwin_emit_unwind_label): Ensure that we don't dead code strip\n        the .eh label.\nRadar 3668092\n\nFrom-SVN: r84444", "tree": {"sha": "b30fbf38df667de17e6a2aef70bc4ce69cca2d8a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b30fbf38df667de17e6a2aef70bc4ce69cca2d8a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/45cc478337efd4f1f5f62bfd70857ab5679aae7a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45cc478337efd4f1f5f62bfd70857ab5679aae7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/45cc478337efd4f1f5f62bfd70857ab5679aae7a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45cc478337efd4f1f5f62bfd70857ab5679aae7a/comments", "author": null, "committer": null, "parents": [{"sha": "d3ecb597b35d5b8c4176a0b60c10cbfdb40ace8b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d3ecb597b35d5b8c4176a0b60c10cbfdb40ace8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d3ecb597b35d5b8c4176a0b60c10cbfdb40ace8b"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "12ee0ae2e4f0dd8c9c146d167ee25f3effc9db07", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45cc478337efd4f1f5f62bfd70857ab5679aae7a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45cc478337efd4f1f5f62bfd70857ab5679aae7a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=45cc478337efd4f1f5f62bfd70857ab5679aae7a", "patch": "@@ -1,3 +1,10 @@\n+2004-07-09  Mike Stump  <mrs@apple.com>\n+\n+\t* config/darwin.c (no_dead_strip): Add.\n+\t(HAVE_DEAD_STRIP): Add.\n+\t(darwin_emit_unwind_label): Ensure that we don't dead code strip\n+\tthe .eh label.\n+\n 2004-07-09  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>\n \n \t* tree-ssa-loop-im.c: New file."}, {"sha": "e46690c74cd213beb517729d4689eb9b9ce49d04", "filename": "gcc/config/darwin.c", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45cc478337efd4f1f5f62bfd70857ab5679aae7a/gcc%2Fconfig%2Fdarwin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45cc478337efd4f1f5f62bfd70857ab5679aae7a/gcc%2Fconfig%2Fdarwin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.c?ref=45cc478337efd4f1f5f62bfd70857ab5679aae7a", "patch": "@@ -1339,6 +1339,15 @@ darwin_unique_section (tree decl, int reloc ATTRIBUTE_UNUSED)\n     darwin_make_decl_one_only (decl);\n }\n \n+#define HAVE_DEAD_STRIP 0\n+\n+static void\n+no_dead_strip (FILE *file, const char *lab)\n+{\n+  if (HAVE_DEAD_STRIP)\n+    fprintf (file, \".no_dead_strip %s\\n\", lab);\n+}\n+\n /* Emit a label for an FDE, making it global and/or weak if appropriate. \n    The third parameter is nonzero if this is for exception handling.\n    The fourth parameter is nonzero if this is just a placeholder for an\n@@ -1388,7 +1397,15 @@ darwin_emit_unwind_label (FILE *file, tree decl, int for_eh, int empty)\n     fprintf (file, \".weak_definition %s\\n\", lab);\n \n   if (empty)\n-    fprintf (file, \"%s = 0\\n\", lab);\n+    {\n+      fprintf (file, \"%s = 0\\n\", lab);\n+\n+      /* Mark the absolute .eh and .eh1 style labels as needed to\n+\t ensure that we don't dead code strip them and keep such\n+\t labels from another instantiation point until we can fix this\n+\t properly with group comdat support.  */\n+      no_dead_strip (file, lab);\n+    }\n   else\n     fprintf (file, \"%s:\\n\", lab);\n "}]}