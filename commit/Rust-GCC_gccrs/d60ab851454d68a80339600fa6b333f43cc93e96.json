{"sha": "d60ab851454d68a80339600fa6b333f43cc93e96", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDYwYWI4NTE0NTRkNjhhODAzMzk2MDBmYTZiMzMzZjQzY2M5M2U5Ng==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1998-06-10T21:03:58Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1998-06-10T21:03:58Z"}, "message": "* typeck.c (build_component_ref): Diagnose ref to nested type.\n\nFrom-SVN: r20419", "tree": {"sha": "5521912cadd7aaa119372810f5cebe0318ab904e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5521912cadd7aaa119372810f5cebe0318ab904e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d60ab851454d68a80339600fa6b333f43cc93e96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d60ab851454d68a80339600fa6b333f43cc93e96", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d60ab851454d68a80339600fa6b333f43cc93e96", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d60ab851454d68a80339600fa6b333f43cc93e96/comments", "author": null, "committer": null, "parents": [{"sha": "3e2b9a3d254f1b324d572f00df30044e2e7066fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e2b9a3d254f1b324d572f00df30044e2e7066fe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e2b9a3d254f1b324d572f00df30044e2e7066fe"}], "stats": {"total": 17, "additions": 10, "deletions": 7}, "files": [{"sha": "5259df091ac58ea265616c7e24433f81cdb2b2ee", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d60ab851454d68a80339600fa6b333f43cc93e96/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d60ab851454d68a80339600fa6b333f43cc93e96/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d60ab851454d68a80339600fa6b333f43cc93e96", "patch": "@@ -1,3 +1,7 @@\n+1998-06-10  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* typeck.c (build_component_ref): Diagnose ref to nested type.\n+\n 1998-06-10  Brendan Kehoe  <brendan@cygnus.com>\n \n \t* decl.c (grokparms): Check that INIT isn't an error_mark_node"}, {"sha": "8c71a2442207e7fbb37028a51ef4ce5cc62ac0cb", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d60ab851454d68a80339600fa6b333f43cc93e96/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d60ab851454d68a80339600fa6b333f43cc93e96/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=d60ab851454d68a80339600fa6b333f43cc93e96", "patch": "@@ -1959,10 +1959,12 @@ build_component_ref (datum, component, basetype_path, protect)\n        hierarchy, the compiler will abort (because vptr lookups are\n        not supposed to be ambiguous.  */\n     field = CLASSTYPE_VFIELD (basetype);\n-  else if (TREE_CODE (component) == FIELD_DECL\n-\t   || TREE_CODE (component) == TYPE_DECL)\n+  else if (TREE_CODE (component) == FIELD_DECL)\n+    field = component;\n+  else if (TREE_CODE (component) == TYPE_DECL)\n     {\n-      field = component;\n+      cp_pedwarn (\"invalid use of type decl `%#D' as expression\", component);\n+      return component;\n     }\n   else\n     {\n@@ -2049,10 +2051,7 @@ build_component_ref (datum, component, basetype_path, protect)\n       if (TREE_CODE (field) != FIELD_DECL)\n \t{\n \t  if (TREE_CODE (field) == TYPE_DECL)\n-\t    {\n-\t      cp_error (\"invalid use of type decl `%#D' as expression\", field);\n-\t      return error_mark_node;\n-\t    }\n+\t    cp_pedwarn (\"invalid use of type decl `%#D' as expression\", field);\n \t  else if (DECL_RTL (field) != 0)\n \t    mark_used (field);\n \t  else"}]}