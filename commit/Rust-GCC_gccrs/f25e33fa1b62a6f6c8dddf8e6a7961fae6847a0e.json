{"sha": "f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjI1ZTMzZmExYjYyYTZmNmM4ZGRkZjhlNmE3OTYxZmFlNjg0N2EwZQ==", "commit": {"author": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2020-01-10T17:04:00Z"}, "committer": {"name": "Martin Sebor", "email": "msebor@gcc.gnu.org", "date": "2020-01-10T17:04:00Z"}, "message": "PR c/93132 - bogus 'attribute((access))' warning when size-index is specified\n\ngcc/c-family/ChangeLog:\n\n\tPR c/93132\n\t* c-attribs.c (append_access_attrs): Validate against the translated\n\taccess string rather than the human-readable representation.\n\ngcc/testsuite/ChangeLog:\n\n\tPR c/93132\n\t* gcc.dg/attr-access-read-only-2.c: New test.\n\nFrom-SVN: r280124", "tree": {"sha": "88ce9f9f24cbdac4e53f3a41c5ea98f9aac5a2c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/88ce9f9f24cbdac4e53f3a41c5ea98f9aac5a2c4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/comments", "author": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b2f5b38042f6a8772237d37cdf20fc139ed0f8fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2f5b38042f6a8772237d37cdf20fc139ed0f8fe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2f5b38042f6a8772237d37cdf20fc139ed0f8fe"}], "stats": {"total": 34, "additions": 31, "deletions": 3}, "files": [{"sha": "5448acf2f7b6d9af2c60f2cca5ded6b5c5573188", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "patch": "@@ -1,3 +1,9 @@\n+2020-01-10  Martin Sebor  <msebor@redhat.com>\n+\n+\tPR c/93132\n+\t* c-attribs.c (append_access_attrs): Validate against the translated\n+\taccess string rather than the human-readable representation.\n+\n 2020-01-01  Jakub Jelinek  <jakub@redhat.com>\n \n \tUpdate copyright years."}, {"sha": "dc9579c5c606945e71090bae338b0d72039f8bad", "filename": "gcc/c-family/c-attribs.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Fc-family%2Fc-attribs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Fc-family%2Fc-attribs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-attribs.c?ref=f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "patch": "@@ -3970,14 +3970,15 @@ append_access_attrs (tree t, tree attrs, const char *attrstr,\n \t      return NULL_TREE;\n \t    }\n \n-\t  if (n2 && strncmp (attrstr + n1 + 1, pos + n1, n2))\n+\t  if (n2 && strncmp (attrspec + n1 + 1, pos + n1, n2))\n \t    {\n \t      /* Mismatch in the value of the size argument.  */\n \t      auto_diagnostic_group d;\n \t      if (warning (OPT_Wattributes,\n-\t\t\t   \"attribute %qs mismatch positional argument \"\n+\t\t\t   \"attribute %qs mismatched positional argument \"\n \t\t\t   \"values %i and %i\",\n-\t\t\t   attrstr, atoi (attrstr + n1 + 1), atoi (pos + n1))\n+\t\t\t   attrstr, atoi (attrspec + n1 + 1) + 1,\n+\t\t\t   atoi (pos + n1) + 1)\n \t\t  && DECL_P (t))\n \t\tinform (DECL_SOURCE_LOCATION (t),\n \t\t\t\"previous declaration here\");"}, {"sha": "4c7a61591a6ca27051d3e92ba3782667e74f41de", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "patch": "@@ -1,3 +1,8 @@\n+2020-01-10  Martin Sebor  <msebor@redhat.com>\n+\n+\tPR c/93132\n+\t* gcc.dg/attr-access-read-only-2.c: New test.\n+\n 2020-01-10  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* gcc.target/aarch64/sve/sel_1.c: Use SVE types for the arguments and"}, {"sha": "d3069b04ec8717fd81882cbaca6fa82a48830423", "filename": "gcc/testsuite/gcc.dg/attr-access-read-only-2.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Ftestsuite%2Fgcc.dg%2Fattr-access-read-only-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e/gcc%2Ftestsuite%2Fgcc.dg%2Fattr-access-read-only-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fattr-access-read-only-2.c?ref=f25e33fa1b62a6f6c8dddf8e6a7961fae6847a0e", "patch": "@@ -0,0 +1,16 @@\n+/* PR c/93132 - bogus 'attribute((access))' warning when size-index\n+   is specified\n+   { dg-do compile }\n+   { dg-options \"-Wall\" } */\n+\n+void __attribute__ ((access (read_only, 1, 5)))\n+f (void*, int, int, int, int);   // { dg-message \"previous declaration\" }\n+\n+void __attribute__ ((access (read_only, 1, 3)))\n+f (void*, int, int, int, int);   // { dg-warning \"attribute 'access\\\\\\(read_only, 1, 3\\\\\\)' mismatched positional argument values 3 and 5\" }\n+\n+void __attribute__ ((access (read_only, 1, 4)))\n+f (void*, int, int, int, int);   // { dg-warning \"attribute 'access\\\\\\(read_only, 1, 4\\\\\\)' mismatched positional argument values 4 and 5\" }\n+\n+void __attribute__ ((access (read_only, 1, 5)))\n+f (void*, int, int, int, int);"}]}