{"sha": "fa94e3a95d755ca73fca584afaff820566f6a980", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmE5NGUzYTk1ZDc1NWNhNzNmY2E1ODRhZmFmZjgyMDU2NmY2YTk4MA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@cygnus.com", "date": "1999-08-04T03:26:15Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "1999-08-04T03:26:15Z"}, "message": "gc_priv.h (GC_test_and_set): Implementation for Linux PPC from Franz Sirl <Franz.Sirl-kernel@lauterbach.com>.\n\n\t* gc_priv.h (GC_test_and_set): Implementation for Linux PPC from\n\tFranz Sirl <Franz.Sirl-kernel@lauterbach.com>.\n\nFrom-SVN: r28480", "tree": {"sha": "48fbfdc7d7a95b3d57c29b83bd75b07238e29d85", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/48fbfdc7d7a95b3d57c29b83bd75b07238e29d85"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fa94e3a95d755ca73fca584afaff820566f6a980", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa94e3a95d755ca73fca584afaff820566f6a980", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fa94e3a95d755ca73fca584afaff820566f6a980", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa94e3a95d755ca73fca584afaff820566f6a980/comments", "author": null, "committer": null, "parents": [{"sha": "02edc62b779ef9997410f1c1bffcbe8137fa6c44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02edc62b779ef9997410f1c1bffcbe8137fa6c44", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02edc62b779ef9997410f1c1bffcbe8137fa6c44"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "1ddff1cf906be14696c7c39abac75ac32b3d5517", "filename": "boehm-gc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa94e3a95d755ca73fca584afaff820566f6a980/boehm-gc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa94e3a95d755ca73fca584afaff820566f6a980/boehm-gc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2FChangeLog?ref=fa94e3a95d755ca73fca584afaff820566f6a980", "patch": "@@ -1,3 +1,8 @@\n+1999-08-03  Tom Tromey  <tromey@cygnus.com>\n+\n+\t* gc_priv.h (GC_test_and_set): Implementation for Linux PPC from\n+\tFranz Sirl <Franz.Sirl-kernel@lauterbach.com>.\n+\n 1999-08-02  Tom Tromey  <tromey@cygnus.com>\n \n \t* aclocal.m4, configure: Rebuilt for new libtool."}, {"sha": "29035336f62a51ea792d831cfcde6b02b007b63e", "filename": "boehm-gc/gc_priv.h", "status": "modified", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa94e3a95d755ca73fca584afaff820566f6a980/boehm-gc%2Fgc_priv.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa94e3a95d755ca73fca584afaff820566f6a980/boehm-gc%2Fgc_priv.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fgc_priv.h?ref=fa94e3a95d755ca73fca584afaff820566f6a980", "patch": "@@ -465,6 +465,29 @@ void GC_print_callers (/* struct callinfo info[NFRAMES] */);\n           __asm__ __volatile__(\"mb\": : :\"memory\");\n           *(addr) = 0;\n        }\n+#    elif defined(__powerpc__)\n+       inline static int GC_test_and_set(volatile unsigned int *addr) {\n+\t int ret, oldval=0, newval=1;\n+  \n+\t __asm__ __volatile__(\"sync\" : : : \"memory\");\n+\t __asm__ __volatile__(\n+\t\t\t      \"0:    lwarx %0,0,%1 ;\"\n+\t\t\t      \"      xor. %0,%3,%0;\"\n+\t\t\t      \"      bne 1f;\"\n+\t\t\t      \"      stwcx. %2,0,%1;\"\n+\t\t\t      \"      bne- 0b;\"\n+\t\t\t      \"1:    \"\n+\t\t\t      : \"=&r\"(ret)\n+\t\t\t      : \"r\"(addr), \"r\"(newval), \"r\"(oldval)\n+\t\t\t      : \"cr0\", \"memory\");\n+\t __asm__ __volatile__(\"sync\" : : : \"memory\");\n+\t return ret == 0;\n+       }\n+       inline static void GC_clear(volatile unsigned int *addr) {\n+          __asm__ __volatile__(\"sync\": : :\"memory\");\n+          *(addr) = 0;\n+       }\n+\n #    else\n        -- > Need implementation of GC_test_and_set()\n #    endif"}]}