{"sha": "f038ec69ccffc38e5038c121cff9e5bbc701b6cd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjAzOGVjNjljY2ZmYzM4ZTUwMzhjMTIxY2ZmOWU1YmJjNzAxYjZjZA==", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@codesourcery.com", "date": "2010-06-01T19:33:57Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2010-06-01T19:33:57Z"}, "message": "* typeck2.c (build_x_arrow): Make types_memoized a VEC.\n\nFrom-SVN: r160119", "tree": {"sha": "8ef700a6229ef5bb83f6bbb47d951ce26db24ace", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ef700a6229ef5bb83f6bbb47d951ce26db24ace"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f038ec69ccffc38e5038c121cff9e5bbc701b6cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f038ec69ccffc38e5038c121cff9e5bbc701b6cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f038ec69ccffc38e5038c121cff9e5bbc701b6cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f038ec69ccffc38e5038c121cff9e5bbc701b6cd/comments", "author": null, "committer": null, "parents": [{"sha": "bb9a7f511a3e3fff83ea40d2140a7759456f6b19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb9a7f511a3e3fff83ea40d2140a7759456f6b19", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb9a7f511a3e3fff83ea40d2140a7759456f6b19"}], "stats": {"total": 27, "additions": 16, "deletions": 11}, "files": [{"sha": "594431300d48f8a13f5e4f955ee9ea3803b9777e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f038ec69ccffc38e5038c121cff9e5bbc701b6cd/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f038ec69ccffc38e5038c121cff9e5bbc701b6cd/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f038ec69ccffc38e5038c121cff9e5bbc701b6cd", "patch": "@@ -1,3 +1,7 @@\n+2010-06-01  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* typeck2.c (build_x_arrow): Make types_memoized a VEC.\n+\n 2010-06-01  Arnaud Charlet  <charlet@adacore.com>\n \t    Matthew Gingell  <gingell@adacore.com>\n "}, {"sha": "489d3f8cf838887d30c075bc067ba1a8939fe6a4", "filename": "gcc/cp/typeck2.c", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f038ec69ccffc38e5038c121cff9e5bbc701b6cd/gcc%2Fcp%2Ftypeck2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f038ec69ccffc38e5038c121cff9e5bbc701b6cd/gcc%2Fcp%2Ftypeck2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck2.c?ref=f038ec69ccffc38e5038c121cff9e5bbc701b6cd", "patch": "@@ -1400,9 +1400,9 @@ tree\n build_x_arrow (tree expr)\n {\n   tree orig_expr = expr;\n-  tree types_memoized = NULL_TREE;\n   tree type = TREE_TYPE (expr);\n   tree last_rval = NULL_TREE;\n+  VEC(tree,gc) *types_memoized = NULL;\n \n   if (type == error_mark_node)\n     return error_mark_node;\n@@ -1421,19 +1421,20 @@ build_x_arrow (tree expr)\n \t\t\t\t   /*overloaded_p=*/NULL, \n \t\t\t\t   tf_warning_or_error)))\n \t{\n+\t  tree t;\n+\t  unsigned ix;\n+\n \t  if (expr == error_mark_node)\n \t    return error_mark_node;\n \n-\t  if (value_member (TREE_TYPE (expr), types_memoized))\n-\t    {\n-\t      error (\"circular pointer delegation detected\");\n-\t      return error_mark_node;\n-\t    }\n-\t  else\n-\t    {\n-\t      types_memoized = tree_cons (NULL_TREE, TREE_TYPE (expr),\n-\t\t\t\t\t  types_memoized);\n-\t    }\n+\t  for (ix = 0; VEC_iterate (tree, types_memoized, ix, t); ix++)\n+\t    if (TREE_TYPE (expr) == t)\n+\t      {\n+\t\terror (\"circular pointer delegation detected\");\n+\t\treturn error_mark_node;\n+\t      }\n+\n+\t  VEC_safe_push (tree, gc, types_memoized, TREE_TYPE (expr));\n \t  last_rval = expr;\n \t}\n "}]}