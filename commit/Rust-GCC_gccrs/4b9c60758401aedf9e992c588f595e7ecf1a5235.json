{"sha": "4b9c60758401aedf9e992c588f595e7ecf1a5235", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGI5YzYwNzU4NDAxYWVkZjllOTkyYzU4OGY1OTVlN2VjZjFhNTIzNQ==", "commit": {"author": {"name": "Nicolas Benoit", "email": "nbenoit@tuxfamily.org", "date": "2010-02-26T01:51:27Z"}, "committer": {"name": "Diego Novillo", "email": "dnovillo@gcc.gnu.org", "date": "2010-02-26T01:51:27Z"}, "message": "ebitmap.c: Change calls to verify_popcount with calls to sbitmap_verify_popcount.\n\n\n2010-02-25  Nicolas Benoit  <nbenoit@tuxfamily.org>\n\n\t* ebitmap.c: Change calls to verify_popcount with calls to\n\tsbitmap_verify_popcount.\n\t(ebitmap_clear_bit): Fixed map->cacheindex test and\n\tmap>cache update when bit clearing results in an empty\n\telement.\n\nFrom-SVN: r157080", "tree": {"sha": "f70b6f2552f3c55b066b3787991d366798284980", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f70b6f2552f3c55b066b3787991d366798284980"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b9c60758401aedf9e992c588f595e7ecf1a5235", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b9c60758401aedf9e992c588f595e7ecf1a5235", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b9c60758401aedf9e992c588f595e7ecf1a5235", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b9c60758401aedf9e992c588f595e7ecf1a5235/comments", "author": {"login": "nbenoit", "id": 7476289, "node_id": "MDQ6VXNlcjc0NzYyODk=", "avatar_url": "https://avatars.githubusercontent.com/u/7476289?v=4", "gravatar_id": "", "url": "https://api.github.com/users/nbenoit", "html_url": "https://github.com/nbenoit", "followers_url": "https://api.github.com/users/nbenoit/followers", "following_url": "https://api.github.com/users/nbenoit/following{/other_user}", "gists_url": "https://api.github.com/users/nbenoit/gists{/gist_id}", "starred_url": "https://api.github.com/users/nbenoit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/nbenoit/subscriptions", "organizations_url": "https://api.github.com/users/nbenoit/orgs", "repos_url": "https://api.github.com/users/nbenoit/repos", "events_url": "https://api.github.com/users/nbenoit/events{/privacy}", "received_events_url": "https://api.github.com/users/nbenoit/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cac1c927c24a07197df05f022196edcc180a1347", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cac1c927c24a07197df05f022196edcc180a1347", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cac1c927c24a07197df05f022196edcc180a1347"}], "stats": {"total": 31, "additions": 22, "deletions": 9}, "files": [{"sha": "62885ce737b10efe615e0e82c1633074b4d1072c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b9c60758401aedf9e992c588f595e7ecf1a5235/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b9c60758401aedf9e992c588f595e7ecf1a5235/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4b9c60758401aedf9e992c588f595e7ecf1a5235", "patch": "@@ -1,3 +1,11 @@\n+2010-02-25  Nicolas Benoit  <nbenoit@tuxfamily.org>\n+\n+\t* ebitmap.c: Change calls to verify_popcount with calls to\n+\tsbitmap_verify_popcount.\n+\t(ebitmap_clear_bit): Fixed map->cacheindex test and\n+\tmap>cache update when bit clearing results in an empty\n+\telement.\n+\n 2010-02-25  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/43154"}, {"sha": "64c563487cf35188cae34b7dd7665e6df022b3a7", "filename": "gcc/ebitmap.c", "status": "modified", "additions": 14, "deletions": 9, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b9c60758401aedf9e992c588f595e7ecf1a5235/gcc%2Febitmap.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b9c60758401aedf9e992c588f595e7ecf1a5235/gcc%2Febitmap.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Febitmap.c?ref=4b9c60758401aedf9e992c588f595e7ecf1a5235", "patch": "@@ -1,5 +1,5 @@\n /* Sparse array-based bitmaps.\n-   Copyright (C) 2007, 2008 Free Software Foundation, Inc.\n+   Copyright (C) 2007, 2008, 2009, 2010 Free Software Foundation, Inc.\n    Contributed by Daniel Berlin <dberlin@dberlin.org>\n \n This file is part of GCC.\n@@ -254,8 +254,13 @@ ebitmap_clear_bit (ebitmap map, unsigned int bit)\n       if (!have_eltwordindex)\n \teltwordindex = sbitmap_popcount (map->wordmask, wordindex);\n \n-      if (map->cache != NULL && map->cacheindex == eltwordindex)\n-\tmap->cache = NULL;\n+      if (map->cache != NULL)\n+        {\n+          if (map->cacheindex == wordindex)\n+            map->cache = NULL;\n+          else if (map->cacheindex > wordindex)\n+            map->cache = map->cache - 1;\n+        }\n \n       RESET_BIT (map->wordmask, wordindex);\n \n@@ -457,7 +462,7 @@ ebitmap_and_into (ebitmap dst, ebitmap src)\n     for (i = 0; i <  dst->numwords; i++)\n       gcc_assert (dst->elts[i] != 0);\n \n-    verify_popcount (dst->wordmask);\n+    sbitmap_verify_popcount (dst->wordmask);\n     gcc_assert (sbitmap_popcount (dst->wordmask,\n \t\t\t\t  dst->wordmask->n_bits) == dst->numwords);\n   }\n@@ -529,7 +534,7 @@ ebitmap_and (ebitmap dst, ebitmap src1, ebitmap src2)\n     for (i = 0; i <  dst->numwords; i++)\n       gcc_assert (dst->elts[i] != 0);\n \n-    verify_popcount (dst->wordmask);\n+    sbitmap_verify_popcount (dst->wordmask);\n     gcc_assert (sbitmap_popcount (dst->wordmask,\n \t\t\t\t  dst->wordmask->n_bits) == dst->numwords);\n   }\n@@ -652,7 +657,7 @@ ebitmap_ior_into (ebitmap dst, ebitmap src)\n     EXECUTE_IF_SET_IN_EBITMAP (dstcopy, 0, i, ebi)\n       gcc_assert (ebitmap_bit_p (dst, i));\n \n-    verify_popcount (dst->wordmask);\n+    sbitmap_verify_popcount (dst->wordmask);\n     gcc_assert (changed == !ebitmap_equal_p (dst, dstcopy));\n     gcc_assert (sbitmap_popcount (dst->wordmask,\n \t\t\t\t  dst->wordmask->n_bits) == dst->numwords);\n@@ -772,7 +777,7 @@ ebitmap_ior (ebitmap dst, ebitmap src1, ebitmap src2)\n     EXECUTE_IF_SET_IN_EBITMAP (src2, 0, i, ebi)\n       gcc_assert (ebitmap_bit_p (dst, i));\n   }\n-  verify_popcount (dst->wordmask);\n+  sbitmap_verify_popcount (dst->wordmask);\n   gcc_assert (changed == !ebitmap_equal_p (dst, dstcopy));\n   gcc_assert (sbitmap_popcount (dst->wordmask,\n \t\t\t\tdst->wordmask->n_bits) == dst->numwords);\n@@ -848,7 +853,7 @@ ebitmap_and_compl_into (ebitmap dst, ebitmap src)\n \n     gcc_assert (sbitmap_popcount (dst->wordmask,\n \t\t\t\t  dst->wordmask->n_bits) == neweltindex);\n-    verify_popcount (dst->wordmask);\n+    sbitmap_verify_popcount (dst->wordmask);\n     gcc_assert (changed == !ebitmap_equal_p (dst, dstcopy));\n     gcc_assert (sbitmap_popcount (dst->wordmask,\n \t\t\t\t  dst->wordmask->n_bits) == dst->numwords);\n@@ -950,7 +955,7 @@ ebitmap_and_compl (ebitmap dst, ebitmap src1, ebitmap src2)\n   for (i = 0; i <  dst->numwords; i++)\n     gcc_assert (dst->elts[i] != 0);\n \n-  verify_popcount (dst->wordmask);\n+  sbitmap_verify_popcount (dst->wordmask);\n   gcc_assert (sbitmap_popcount (dst->wordmask,\n \t\t\t\tdst->wordmask->n_bits) == dst->numwords);\n   }"}]}