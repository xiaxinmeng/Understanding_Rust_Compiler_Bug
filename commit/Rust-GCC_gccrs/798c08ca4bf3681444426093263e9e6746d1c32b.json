{"sha": "798c08ca4bf3681444426093263e9e6746d1c32b", "node_id": "C_kwDOANBUbNoAKDc5OGMwOGNhNGJmMzY4MTQ0NDQyNjA5MzI2M2U5ZTY3NDZkMWMzMmI", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2022-11-29T11:29:30Z"}, "committer": {"name": "Marc Poulhi\u00e8s", "email": "poulhies@adacore.com", "date": "2022-12-01T13:53:54Z"}, "message": "ada: Strip conversions for the implementation of storage models\n\nThis is necessary for unconstrained allocators with qualified expression.\n\ngcc/ada/\n\n\t* gcc-interface/trans.cc (get_storage_model_access): Strip any type\n\tconversion around the node before looking into it.", "tree": {"sha": "eda0b90eab97594b1fc4b9a2f4fdcc04b312d318", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eda0b90eab97594b1fc4b9a2f4fdcc04b312d318"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/798c08ca4bf3681444426093263e9e6746d1c32b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/798c08ca4bf3681444426093263e9e6746d1c32b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/798c08ca4bf3681444426093263e9e6746d1c32b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/798c08ca4bf3681444426093263e9e6746d1c32b/comments", "author": null, "committer": {"login": "dkm", "id": 87603, "node_id": "MDQ6VXNlcjg3NjAz", "avatar_url": "https://avatars.githubusercontent.com/u/87603?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dkm", "html_url": "https://github.com/dkm", "followers_url": "https://api.github.com/users/dkm/followers", "following_url": "https://api.github.com/users/dkm/following{/other_user}", "gists_url": "https://api.github.com/users/dkm/gists{/gist_id}", "starred_url": "https://api.github.com/users/dkm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dkm/subscriptions", "organizations_url": "https://api.github.com/users/dkm/orgs", "repos_url": "https://api.github.com/users/dkm/repos", "events_url": "https://api.github.com/users/dkm/events{/privacy}", "received_events_url": "https://api.github.com/users/dkm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "82cf82c4610dbf2a1021841fea3700a477246b79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82cf82c4610dbf2a1021841fea3700a477246b79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82cf82c4610dbf2a1021841fea3700a477246b79"}], "stats": {"total": 5, "additions": 5, "deletions": 0}, "files": [{"sha": "a012271abf37e4f5b19582b4584a74ed503768ba", "filename": "gcc/ada/gcc-interface/trans.cc", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/798c08ca4bf3681444426093263e9e6746d1c32b/gcc%2Fada%2Fgcc-interface%2Ftrans.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/798c08ca4bf3681444426093263e9e6746d1c32b/gcc%2Fada%2Fgcc-interface%2Ftrans.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Ftrans.cc?ref=798c08ca4bf3681444426093263e9e6746d1c32b", "patch": "@@ -4400,6 +4400,11 @@ get_storage_model_access (Node_Id gnat_node, Entity_Id *gnat_smo)\n       return;\n     }\n \n+  /* Now strip any type conversion from GNAT_NODE.  */\n+  if (Nkind (gnat_node) == N_Type_Conversion\n+      || Nkind (gnat_node) == N_Unchecked_Type_Conversion)\n+    gnat_node = Expression (gnat_node);\n+\n   while (node_is_component (gnat_node))\n     gnat_node = Prefix (gnat_node);\n "}]}