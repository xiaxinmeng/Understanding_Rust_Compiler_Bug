{"sha": "7d81a56745d42ec9ec6dc044135d458978722b59", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2Q4MWE1Njc0NWQ0MmVjOWVjNmRjMDQ0MTM1ZDQ1ODk3ODcyMmI1OQ==", "commit": {"author": {"name": "Claudiu Zissulescu", "email": "claziss@synopsys.com", "date": "2016-04-28T12:52:04Z"}, "committer": {"name": "Claudiu Zissulescu", "email": "claziss@gcc.gnu.org", "date": "2016-04-28T12:52:04Z"}, "message": "[ARC] Fix FPX/FPUDA code gen when compiling for big-endian.\n\ngcc/\n2016-04-28  Claudiu Zissulescu  <claziss@synopsys.com>\n\n\t* config/arc/arc.c (arc_process_double_reg_moves): Fix for\n\tbig-endian compilation.\n\t(arc_rtx_costs): Fix high/low naming.\n\t* config/arc/arc.md (addf3): Likewise.\n\t(subdf3): Likewise.\n\t(muldf3): Likewise.\n\nFrom-SVN: r235567", "tree": {"sha": "06c5b7c1dce4f339288cd049d94e9a1b79650044", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/06c5b7c1dce4f339288cd049d94e9a1b79650044"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d81a56745d42ec9ec6dc044135d458978722b59", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d81a56745d42ec9ec6dc044135d458978722b59", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d81a56745d42ec9ec6dc044135d458978722b59", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d81a56745d42ec9ec6dc044135d458978722b59/comments", "author": {"login": "claziss", "id": 2761368, "node_id": "MDQ6VXNlcjI3NjEzNjg=", "avatar_url": "https://avatars.githubusercontent.com/u/2761368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/claziss", "html_url": "https://github.com/claziss", "followers_url": "https://api.github.com/users/claziss/followers", "following_url": "https://api.github.com/users/claziss/following{/other_user}", "gists_url": "https://api.github.com/users/claziss/gists{/gist_id}", "starred_url": "https://api.github.com/users/claziss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/claziss/subscriptions", "organizations_url": "https://api.github.com/users/claziss/orgs", "repos_url": "https://api.github.com/users/claziss/repos", "events_url": "https://api.github.com/users/claziss/events{/privacy}", "received_events_url": "https://api.github.com/users/claziss/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "de3fbea3b3c62a501f446d363240a67b60888299", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de3fbea3b3c62a501f446d363240a67b60888299", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de3fbea3b3c62a501f446d363240a67b60888299"}], "stats": {"total": 47, "additions": 29, "deletions": 18}, "files": [{"sha": "39443cc559c063e4ca0e422eb2b525f7d97ee44e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d81a56745d42ec9ec6dc044135d458978722b59/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d81a56745d42ec9ec6dc044135d458978722b59/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7d81a56745d42ec9ec6dc044135d458978722b59", "patch": "@@ -1,3 +1,11 @@\n+2016-04-28  Claudiu Zissulescu  <claziss@synopsys.com>\n+\n+\t* config/arc/arc.c (arc_process_double_reg_moves): Fix for\n+\tbig-endian compilation.\n+\t* config/arc/arc.md (addf3): Likewise.\n+\t(subdf3): Likewise.\n+\t(muldf3): Likewise.\n+\n 2016-04-28  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/70840"}, {"sha": "e7067374e465ea4c4a25b9426820ca4357c2a089", "filename": "gcc/config/arc/arc.c", "status": "modified", "additions": 12, "deletions": 9, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d81a56745d42ec9ec6dc044135d458978722b59/gcc%2Fconfig%2Farc%2Farc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d81a56745d42ec9ec6dc044135d458978722b59/gcc%2Fconfig%2Farc%2Farc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farc%2Farc.c?ref=7d81a56745d42ec9ec6dc044135d458978722b59", "patch": "@@ -4426,17 +4426,16 @@ arc_rtx_costs (rtx x, machine_mode mode, int outer_code,\n \n     case CONST_DOUBLE:\n       {\n-\trtx high, low;\n+\trtx first, second;\n \n \tif (TARGET_DPFP)\n \t  {\n \t    *total = COSTS_N_INSNS (1);\n \t    return true;\n \t  }\n-\t/* FIXME: correct the order of high,low */\n-\tsplit_double (x, &high, &low);\n-\t*total = COSTS_N_INSNS (!SMALL_INT (INTVAL (high))\n-\t\t\t\t+ !SMALL_INT (INTVAL (low)));\n+\tsplit_double (x, &first, &second);\n+\t*total = COSTS_N_INSNS (!SMALL_INT (INTVAL (first))\n+\t\t\t\t+ !SMALL_INT (INTVAL (second)));\n \treturn true;\n       }\n \n@@ -8928,8 +8927,10 @@ arc_process_double_reg_moves (rtx *operands)\n \t{\n \t  /* When we have 'mov D, r' or 'mov D, D' then get the target\n \t     register pair for use with LR insn.  */\n-\t  rtx destHigh = simplify_gen_subreg(SImode, dest, DFmode, 4);\n-\t  rtx destLow  = simplify_gen_subreg(SImode, dest, DFmode, 0);\n+\t  rtx destHigh = simplify_gen_subreg (SImode, dest, DFmode,\n+\t\t\t\t\t     TARGET_BIG_ENDIAN ? 0 : 4);\n+\t  rtx destLow  = simplify_gen_subreg (SImode, dest, DFmode,\n+\t\t\t\t\t     TARGET_BIG_ENDIAN ? 4 : 0);\n \n \t  /* Produce the two LR insns to get the high and low parts.  */\n \t  emit_insn (gen_rtx_SET (destHigh,\n@@ -8946,8 +8947,10 @@ arc_process_double_reg_moves (rtx *operands)\n     {\n       /* When we have 'mov r, D' or 'mov D, D' and we have access to the\n \t LR insn get the target register pair.  */\n-      rtx srcHigh = simplify_gen_subreg(SImode, src, DFmode, 4);\n-      rtx srcLow  = simplify_gen_subreg(SImode, src, DFmode, 0);\n+      rtx srcHigh = simplify_gen_subreg (SImode, src, DFmode,\n+\t\t\t\t\tTARGET_BIG_ENDIAN ? 0 : 4);\n+      rtx srcLow  = simplify_gen_subreg (SImode, src, DFmode,\n+\t\t\t\t\tTARGET_BIG_ENDIAN ? 4 : 0);\n \n       emit_insn (gen_rtx_UNSPEC_VOLATILE (Pmode,\n \t\t\t\t\t  gen_rtvec (3, dest, srcHigh, srcLow),"}, {"sha": "8ec0ce0427baa11cd8c2ed1b17eb8c67af35db2d", "filename": "gcc/config/arc/arc.md", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d81a56745d42ec9ec6dc044135d458978722b59/gcc%2Fconfig%2Farc%2Farc.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d81a56745d42ec9ec6dc044135d458978722b59/gcc%2Fconfig%2Farc%2Farc.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farc%2Farc.md?ref=7d81a56745d42ec9ec6dc044135d458978722b59", "patch": "@@ -5752,9 +5752,9 @@\n    {\n     if (GET_CODE (operands[2]) == CONST_DOUBLE)\n      {\n-        rtx high, low, tmp;\n-        split_double (operands[2], &low, &high);\n-        tmp = force_reg (SImode, high);\n+        rtx first, second, tmp;\n+        split_double (operands[2], &first, &second);\n+        tmp = force_reg (SImode, TARGET_BIG_ENDIAN ? first : second);\n         emit_insn (gen_adddf3_insn (operands[0], operands[1],\n                                     operands[2], tmp, const0_rtx));\n      }\n@@ -5789,10 +5789,10 @@\n      if ((GET_CODE (operands[1]) == CONST_DOUBLE)\n           || GET_CODE (operands[2]) == CONST_DOUBLE)\n       {\n-        rtx high, low, tmp;\n+        rtx first, second, tmp;\n         int const_index = ((GET_CODE (operands[1]) == CONST_DOUBLE) ? 1 : 2);\n-        split_double (operands[const_index], &low, &high);\n-        tmp = force_reg (SImode, high);\n+        split_double (operands[const_index], &first, &second);\n+        tmp = force_reg (SImode, TARGET_BIG_ENDIAN ? first : second);\n         emit_insn (gen_subdf3_insn (operands[0], operands[1],\n                                     operands[2], tmp, const0_rtx));\n       }\n@@ -5824,9 +5824,9 @@\n     {\n      if (GET_CODE (operands[2]) == CONST_DOUBLE)\n       {\n-        rtx high, low, tmp;\n-        split_double (operands[2], &low, &high);\n-        tmp = force_reg (SImode, high);\n+        rtx first, second, tmp;\n+        split_double (operands[2], &first, &second);\n+        tmp = force_reg (SImode, TARGET_BIG_ENDIAN ? first : second);\n         emit_insn (gen_muldf3_insn (operands[0], operands[1],\n                                     operands[2], tmp, const0_rtx));\n       }"}]}