{"sha": "11e5fe42ca1d186a56b85214fa492ff309570a32", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTFlNWZlNDJjYTFkMTg2YTU2Yjg1MjE0ZmE0OTJmZjMwOTU3MGEzMg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1993-06-12T01:45:00Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1993-06-12T01:45:00Z"}, "message": "(rs6000_gen_section_name): Only replace last period in filename with section...\n\n(rs6000_gen_section_name): Only replace last period in filename with\nsection name and correct calculation of string length.\n\nFrom-SVN: r4665", "tree": {"sha": "0c5fe358917cf9afea9a249bacaaca7ac0438092", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c5fe358917cf9afea9a249bacaaca7ac0438092"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/11e5fe42ca1d186a56b85214fa492ff309570a32", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11e5fe42ca1d186a56b85214fa492ff309570a32", "html_url": "https://github.com/Rust-GCC/gccrs/commit/11e5fe42ca1d186a56b85214fa492ff309570a32", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11e5fe42ca1d186a56b85214fa492ff309570a32/comments", "author": null, "committer": null, "parents": [{"sha": "63b6b8450cedae2d7779003afc544537b9d67218", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63b6b8450cedae2d7779003afc544537b9d67218", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63b6b8450cedae2d7779003afc544537b9d67218"}], "stats": {"total": 26, "additions": 14, "deletions": 12}, "files": [{"sha": "3f97f44fa38097153e5819f15f2d99f466ed9c58", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 14, "deletions": 12, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/11e5fe42ca1d186a56b85214fa492ff309570a32/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/11e5fe42ca1d186a56b85214fa492ff309570a32/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=11e5fe42ca1d186a56b85214fa492ff309570a32", "patch": "@@ -1,5 +1,5 @@\n /* Subroutines used for code generation on IBM RS/6000.\n-   Copyright (C) 1991 Free Software Foundation, Inc.\n+   Copyright (C) 1991, 1993 Free Software Foundation, Inc.\n    Contributed by Richard Kenner (kenner@nyu.edu)\n \n This file is part of GNU CC.\n@@ -1744,46 +1744,48 @@ output_ascii (file, p, n)\n \n    We name the section in the same manner as xlc.  The name begins with an\n    underscore followed by the filename (after stripping any leading directory\n-   names) with the period replaced by the string SECTION_DESC.  If FILENAME\n-   does not contain a period, SECTION_DESC is appended at the end of the\n-   name.  */\n+   names) with the last period replaced by the string SECTION_DESC.  If\n+   FILENAME does not contain a period, SECTION_DESC is appended to the end of\n+   the name.  */\n \n void\n rs6000_gen_section_name (buf, filename, section_desc)\n      char **buf;\n      char *filename;\n      char *section_desc;\n {\n-  char *q, *after_last_slash;\n+  char *q, *after_last_slash, *last_period;\n   char *p;\n   int len;\n-  int used_desc = 0;\n \n   after_last_slash = filename;\n   for (q = filename; *q; q++)\n-    if (*q == '/')\n-      after_last_slash = q + 1;\n+    {\n+      if (*q == '/')\n+\tafter_last_slash = q + 1;\n+      else if (*q == '.')\n+\tlast_period = q;\n+    }\n \n-  len = strlen (filename) + strlen (section_desc) + 2;\n+  len = strlen (after_last_slash) + strlen (section_desc) + 2;\n   *buf = (char *) permalloc (len);\n \n   p = *buf;\n   *p++ = '_';\n \n   for (q = after_last_slash; *q; q++)\n     {\n-      if (*q == '.')\n+      if (q == last_period)\n         {\n \t  strcpy (p, section_desc);\n \t  p += strlen (section_desc);\n-\t  used_desc = 1;\n         }\n \n       else if (isalnum (*q))\n         *p++ = *q;\n     }\n \n-  if (! used_desc)\n+  if (last_period == 0)\n     strcpy (p, section_desc);\n   else\n     *p = '\\0';"}]}