{"sha": "5bdb1440a1e11b17ed56abdf15fb302064345565", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWJkYjE0NDBhMWUxMWIxN2VkNTZhYmRmMTVmYjMwMjA2NDM0NTU2NQ==", "commit": {"author": {"name": "Jonathan Lennox", "email": "lennox@cs.columbia.edu", "date": "2002-11-18T22:42:35Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2002-11-18T22:42:35Z"}, "message": "streambuf.tcc (__copy_streambufs): verify __sbin->gptr() + __bufsize < __sbin->egptr() before using.\n\n2002-11-18  Jonathan Lennox  <lennox@cs.columbia.edu>\n\n\t* include/bits/streambuf.tcc (__copy_streambufs): verify\n\t__sbin->gptr() + __bufsize < __sbin->egptr() before using.\n\t* testsuite/27_io/ostream_inserter_other.cc (test_buffer_4): Add.\n\t(test05): Use test_buffer_4.  Delete unused ostringstream\n\tvariables.\n\nFrom-SVN: r59234", "tree": {"sha": "edf898092def4d7c35d3378fd2bf0d5592a37073", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/edf898092def4d7c35d3378fd2bf0d5592a37073"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5bdb1440a1e11b17ed56abdf15fb302064345565", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5bdb1440a1e11b17ed56abdf15fb302064345565", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5bdb1440a1e11b17ed56abdf15fb302064345565", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5bdb1440a1e11b17ed56abdf15fb302064345565/comments", "author": null, "committer": null, "parents": [{"sha": "8c9aa0cba995b8db154e154161a9d1c8fc9753ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c9aa0cba995b8db154e154161a9d1c8fc9753ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c9aa0cba995b8db154e154161a9d1c8fc9753ee"}], "stats": {"total": 41, "additions": 38, "deletions": 3}, "files": [{"sha": "67983408d8cbeb765ba15499e8eb6b82be6fd010", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5bdb1440a1e11b17ed56abdf15fb302064345565/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5bdb1440a1e11b17ed56abdf15fb302064345565/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=5bdb1440a1e11b17ed56abdf15fb302064345565", "patch": "@@ -1,3 +1,11 @@\n+2002-11-18  Jonathan Lennox  <lennox@cs.columbia.edu>\n+\n+\t* include/bits/streambuf.tcc (__copy_streambufs): verify\n+\t__sbin->gptr() + __bufsize < __sbin->egptr() before using.\n+\t* testsuite/27_io/ostream_inserter_other.cc (test_buffer_4): Add.\n+\t(test05): Use test_buffer_4.  Delete unused ostringstream\n+\tvariables.\n+\n 2002-11-18  Paolo Carlini  <pcarlini@unitus.it>\n \n \tPR libstdc++/6745 (continued)"}, {"sha": "2862dff34ca2ed0939106f35f15d75ec364c49e1", "filename": "libstdc++-v3/include/bits/streambuf.tcc", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5bdb1440a1e11b17ed56abdf15fb302064345565/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5bdb1440a1e11b17ed56abdf15fb302064345565/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc?ref=5bdb1440a1e11b17ed56abdf15fb302064345565", "patch": "@@ -213,7 +213,8 @@ namespace std\n \t{\n \t  while (__testput && __bufsize != -1)\n   \t    {\n- \t      if (__bufsize != 0 && __sbin->gptr() != NULL) \n+ \t      if (__bufsize != 0 && __sbin->gptr() != NULL\n+\t\t  && __sbin->gptr() + __bufsize <= __sbin->egptr()) \n \t\t{\n \t\t  __xtrct = __sbout->sputn(__sbin->gptr(), __bufsize);\n \t\t  __ret += __xtrct;"}, {"sha": "4ae1f3b88a6a8347c492e3fba32643f528d39380", "filename": "libstdc++-v3/testsuite/27_io/ostream_inserter_other.cc", "status": "modified", "additions": 28, "deletions": 2, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5bdb1440a1e11b17ed56abdf15fb302064345565/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fostream_inserter_other.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5bdb1440a1e11b17ed56abdf15fb302064345565/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fostream_inserter_other.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fostream_inserter_other.cc?ref=5bdb1440a1e11b17ed56abdf15fb302064345565", "patch": "@@ -198,6 +198,28 @@ class test_buffer_3 : public std::streambuf\n   std::string::const_iterator it;\n };\n \n+class test_buffer_4 : public std::streambuf {\n+public:\n+  test_buffer_4(const std::string& s) : str(s), it(str.begin())\n+  {\n+    if (it != str.end()) {\n+      buf[0] = *it++;\n+      setg(buf, buf, buf+1);\n+    }\n+  }\n+\n+protected:\n+  virtual int underflow() { return (it != str.end() ? *it : EOF); }\n+  virtual int uflow() { return (it != str.end() ? *it++ : EOF); }\n+  virtual std::streamsize showmanyc() {\n+    std::streamsize ret = std::distance(it, str.end());\n+    return ret > 0 ? ret : -1;\n+  }\n+private:\n+  const std::string str;\n+  std::string::const_iterator it;\n+  char buf[1];\n+};\n \n void test(const std::string& str, std::streambuf& buf)\n {\n@@ -218,8 +240,6 @@ void test(const std::string& str, std::streambuf& buf)\n // Jonathan Lennox  <lennox@cs.columbia.edu>\n void test05()\n {\n-  std::ostringstream out_1, out_2, out_3, out_4;\n-\n   std::string string_a(\"Hello, world!\");\n   std::string string_b(\"\");\n \n@@ -232,6 +252,9 @@ void test05()\n   test_buffer_3 buf3a(string_a);\n   test_buffer_3 buf3b(string_b);\n \n+  test_buffer_4 buf4a(string_a);\n+  test_buffer_4 buf4b(string_b);\n+\n   test(string_a, buf1a);\n   test(string_b, buf1b);\n \n@@ -240,6 +263,9 @@ void test05()\n \n   test(string_a, buf3a);\n   test(string_b, buf3b);\n+\n+  test(string_a, buf4a);\n+  test(string_b, buf4b);\n }\n \n int "}]}