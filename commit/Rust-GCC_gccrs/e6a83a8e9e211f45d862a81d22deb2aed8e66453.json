{"sha": "e6a83a8e9e211f45d862a81d22deb2aed8e66453", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTZhODNhOGU5ZTIxMWY0NWQ4NjJhODFkMjJkZWIyYWVkOGU2NjQ1Mw==", "commit": {"author": {"name": "Cary Coutant", "email": "ccoutant@gcc.gnu.org", "date": "2009-08-28T20:32:29Z"}, "committer": {"name": "Cary Coutant", "email": "ccoutant@gcc.gnu.org", "date": "2009-08-28T20:32:29Z"}, "message": "re PR debug/41063 (ICE in output_die)\n\ngcc/ChangeLog:\n\n\tPR debug/41063\n\t* dwarf2out.c (gen_type_die_with_usage): Use proper context for\n\tstruct/union/enum types local to a function.\n\ngcc/testsuite/ChangeLog:\n\n\tPR debug/41063\n\t* g++.dg/debug/dwarf2/pr41063.C: New test.\n\nFrom-SVN: r151185", "tree": {"sha": "d2b2d979716740ba72c42ad6455dfd7dd75bff7e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d2b2d979716740ba72c42ad6455dfd7dd75bff7e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e6a83a8e9e211f45d862a81d22deb2aed8e66453", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e6a83a8e9e211f45d862a81d22deb2aed8e66453", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e6a83a8e9e211f45d862a81d22deb2aed8e66453", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e6a83a8e9e211f45d862a81d22deb2aed8e66453/comments", "author": null, "committer": null, "parents": [{"sha": "059a5f9f1cbfacf7f1102f1e03c62d9da453879c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/059a5f9f1cbfacf7f1102f1e03c62d9da453879c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/059a5f9f1cbfacf7f1102f1e03c62d9da453879c"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "aad6ee7716a5d917b65d3ce7e0cefcfc8db29a1d", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e6a83a8e9e211f45d862a81d22deb2aed8e66453/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e6a83a8e9e211f45d862a81d22deb2aed8e66453/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=e6a83a8e9e211f45d862a81d22deb2aed8e66453", "patch": "@@ -15573,6 +15573,15 @@ gen_type_die_with_usage (tree type, dw_die_ref context_die,\n \t  context_die = lookup_type_die (TYPE_CONTEXT (type));\n \t  need_pop = 1;\n \t}\n+      else if (TYPE_CONTEXT (type) != NULL_TREE\n+\t       && (TREE_CODE (TYPE_CONTEXT (type)) == FUNCTION_DECL))\n+\t{\n+\t  /* If this type is local to a function that hasn't been written\n+\t     out yet, use a NULL context for now; it will be fixed up in\n+\t     decls_for_scope.  */\n+\t  context_die = lookup_decl_die (TYPE_CONTEXT (type));\n+\t  need_pop = 0;\n+\t}\n       else\n \t{\n \t  context_die = declare_in_namespace (type, context_die);"}, {"sha": "f23efef13d21f2f63ee05452c756b19c03763041", "filename": "gcc/testsuite/g++.dg/debug/dwarf2/pr41063.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e6a83a8e9e211f45d862a81d22deb2aed8e66453/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fpr41063.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e6a83a8e9e211f45d862a81d22deb2aed8e66453/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fpr41063.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fpr41063.C?ref=e6a83a8e9e211f45d862a81d22deb2aed8e66453", "patch": "@@ -0,0 +1,20 @@\n+// Contributed by Cary Coutant <ccoutant@google.com>\n+// Origin: PR debug/41063\n+// { dg-do compile }\n+\n+struct A {\n+  virtual void run();\n+};\n+\n+void test() {\n+  struct B : public A {\n+    void run() {\n+      struct C : public A {\n+\tC() { }\n+\tB *b_;\n+      };\n+      C c;\n+    }\n+  };\n+  B b;\n+}"}]}