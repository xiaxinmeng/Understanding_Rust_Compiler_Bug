{"sha": "56a6d474ab255eddf334bd77df014673d4035336", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTZhNmQ0NzRhYjI1NWVkZGYzMzRiZDc3ZGYwMTQ2NzNkNDAzNTMzNg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2017-06-28T14:24:00Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-06-28T14:24:00Z"}, "message": "re PR tree-optimization/81227 (ICE in get_single_symbol, at tree-vrp.c:799)\n\n2017-06-28  Richard Biener  <rguenther@suse.de>\n\n\tPR middle-end/81227\n\t* fold-const.c (negate_expr_p): Use TYPE_UNSIGNED, not\n\tTYPE_OVERFLOW_WRAPS.\n\t* match.pd (negate_expr_p): Likewise.\n\t* tree-ssa-reassoc.c (optimize_range_tests_diff): Use\n\tfold_build2, not fold_binary.\n\n\t* gcc.dg/pr81227.c: New testcase.\n\nFrom-SVN: r249742", "tree": {"sha": "be42b439d86c5ccb2693751b78243de1dae4300e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/be42b439d86c5ccb2693751b78243de1dae4300e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/56a6d474ab255eddf334bd77df014673d4035336", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56a6d474ab255eddf334bd77df014673d4035336", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56a6d474ab255eddf334bd77df014673d4035336", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56a6d474ab255eddf334bd77df014673d4035336/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "00eee3fa2a884e3ab0bcbf6de3a94d4da2b34d4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00eee3fa2a884e3ab0bcbf6de3a94d4da2b34d4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00eee3fa2a884e3ab0bcbf6de3a94d4da2b34d4c"}], "stats": {"total": 42, "additions": 39, "deletions": 3}, "files": [{"sha": "34de7cf2bcef72958c81716b559eb131899db473", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a6d474ab255eddf334bd77df014673d4035336/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a6d474ab255eddf334bd77df014673d4035336/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=56a6d474ab255eddf334bd77df014673d4035336", "patch": "@@ -1,3 +1,12 @@\n+2017-06-28  Richard Biener  <rguenther@suse.de>\n+\n+\tPR middle-end/81227\n+\t* fold-const.c (negate_expr_p): Use TYPE_UNSIGNED, not\n+\tTYPE_OVERFLOW_WRAPS.\n+\t* match.pd (negate_expr_p): Likewise.\n+\t* tree-ssa-reassoc.c (optimize_range_tests_diff): Use\n+\tfold_build2, not fold_binary.\n+\n 2017-06-28  Wilco Dijkstra  <wdijkstr@arm.com>\n \n \t* config/aarch64/aarch64 (aarch64_expand_mov_immediate):"}, {"sha": "1bcbbb58154b94093dccb384357900f7214f21ee", "filename": "gcc/fold-const.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=56a6d474ab255eddf334bd77df014673d4035336", "patch": "@@ -383,7 +383,7 @@ negate_expr_p (tree t)\n   switch (TREE_CODE (t))\n     {\n     case INTEGER_CST:\n-      if (INTEGRAL_TYPE_P (type) && TYPE_OVERFLOW_WRAPS (type))\n+      if (INTEGRAL_TYPE_P (type) && TYPE_UNSIGNED (type))\n \treturn true;\n \n       /* Check that -CST will not overflow type.  */"}, {"sha": "4c64b21b46394c72fcb4a6d6719791c4696bf09d", "filename": "gcc/match.pd", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=56a6d474ab255eddf334bd77df014673d4035336", "patch": "@@ -914,7 +914,7 @@ DEFINE_INT_AND_FLOAT_ROUND_FN (RINT)\n (match negate_expr_p\n  INTEGER_CST\n  (if ((INTEGRAL_TYPE_P (type)\n-       && TYPE_OVERFLOW_WRAPS (type))\n+       && TYPE_UNSIGNED (type))\n       || (!TYPE_OVERFLOW_SANITIZED (type)\n \t  && may_negate_without_overflow_p (t)))))\n (match negate_expr_p"}, {"sha": "a96d5abb65c591d0be6d3a8079ca8c8a22e63ba9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=56a6d474ab255eddf334bd77df014673d4035336", "patch": "@@ -1,3 +1,8 @@\n+2017-06-28  Richard Biener  <rguenther@suse.de>\n+\n+\tPR middle-end/81227\n+\t* gcc.dg/pr81227.c: New testcase.\n+\n 2017-06-28  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/81193"}, {"sha": "bdaa8cbab2bdb2424de2e4630e0ab44951e5b62c", "filename": "gcc/testsuite/gcc.dg/pr81227.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ftestsuite%2Fgcc.dg%2Fpr81227.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ftestsuite%2Fgcc.dg%2Fpr81227.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr81227.c?ref=56a6d474ab255eddf334bd77df014673d4035336", "patch": "@@ -0,0 +1,22 @@\n+/* Copy of gcc.c-torture/compile/pr80443.c  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fwrapv\" } */\n+\n+struct S { int a : 1; } b, c;\n+signed char d, e, f;\n+\n+void\n+foo ()\n+{ \n+  while (f)\n+    { \n+      signed char g = b.a;\n+      if (g)\n+\tb.a = ~(1 + (d || c.a));\n+      if (b.a < g && b.a)\n+\tg = 0;\n+      if (b.a > c.a)\n+\tb.a = g;\n+      c.a = e;\n+    }\n+}"}, {"sha": "982ab790cb34e9b2b2336f7f53c59a2a965a64dc", "filename": "gcc/tree-ssa-reassoc.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ftree-ssa-reassoc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56a6d474ab255eddf334bd77df014673d4035336/gcc%2Ftree-ssa-reassoc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-reassoc.c?ref=56a6d474ab255eddf334bd77df014673d4035336", "patch": "@@ -2561,7 +2561,7 @@ optimize_range_tests_diff (enum tree_code opcode, tree type,\n   tem2 = fold_convert (type, tem2);\n   lowi = fold_convert (type, lowi);\n   mask = fold_build1 (BIT_NOT_EXPR, type, tem1);\n-  tem1 = fold_binary (MINUS_EXPR, type,\n+  tem1 = fold_build2 (MINUS_EXPR, type,\n \t\t      fold_convert (type, rangei->exp), lowi);\n   tem1 = fold_build2 (BIT_AND_EXPR, type, tem1, mask);\n   lowj = build_int_cst (type, 0);"}]}