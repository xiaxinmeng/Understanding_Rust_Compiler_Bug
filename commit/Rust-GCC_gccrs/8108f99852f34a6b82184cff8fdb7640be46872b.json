{"sha": "8108f99852f34a6b82184cff8fdb7640be46872b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODEwOGY5OTg1MmYzNGE2YjgyMTg0Y2ZmOGZkYjc2NDBiZTQ2ODcyYg==", "commit": {"author": {"name": "Archie Cobbs", "email": "archie@dellroad.org", "date": "2005-05-06T06:10:18Z"}, "committer": {"name": "Michael Koch", "email": "mkoch@gcc.gnu.org", "date": "2005-05-06T06:10:18Z"}, "message": "gnu_java_awt_peer_gtk_GdkPixbufDecoder.c: use DeleteLocalRef() to avoid exhausting local native references.\n\n2005-05-06  Archie Cobbs  <archie@dellroad.org>\n\n\t* native/jni/gtk-peer/gnu_java_awt_peer_gtk_GdkPixbufDecoder.c:\n\tuse DeleteLocalRef() to avoid exhausting local native references.\n\nFrom-SVN: r99302", "tree": {"sha": "ba34c55df46431d541bf458ab729a785d41d2313", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ba34c55df46431d541bf458ab729a785d41d2313"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8108f99852f34a6b82184cff8fdb7640be46872b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8108f99852f34a6b82184cff8fdb7640be46872b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8108f99852f34a6b82184cff8fdb7640be46872b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8108f99852f34a6b82184cff8fdb7640be46872b/comments", "author": {"login": "archiecobbs", "id": 545866, "node_id": "MDQ6VXNlcjU0NTg2Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/545866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/archiecobbs", "html_url": "https://github.com/archiecobbs", "followers_url": "https://api.github.com/users/archiecobbs/followers", "following_url": "https://api.github.com/users/archiecobbs/following{/other_user}", "gists_url": "https://api.github.com/users/archiecobbs/gists{/gist_id}", "starred_url": "https://api.github.com/users/archiecobbs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/archiecobbs/subscriptions", "organizations_url": "https://api.github.com/users/archiecobbs/orgs", "repos_url": "https://api.github.com/users/archiecobbs/repos", "events_url": "https://api.github.com/users/archiecobbs/events{/privacy}", "received_events_url": "https://api.github.com/users/archiecobbs/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9b8d7b425267df5fb5fa7f257560848c0ba0c246", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b8d7b425267df5fb5fa7f257560848c0ba0c246", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b8d7b425267df5fb5fa7f257560848c0ba0c246"}], "stats": {"total": 25, "additions": 19, "deletions": 6}, "files": [{"sha": "fd3ba76bff80831ff313ae3fdf137d33804620aa", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8108f99852f34a6b82184cff8fdb7640be46872b/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8108f99852f34a6b82184cff8fdb7640be46872b/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=8108f99852f34a6b82184cff8fdb7640be46872b", "patch": "@@ -1,3 +1,8 @@\n+2005-05-06  Archie Cobbs  <archie@dellroad.org>\n+\n+\t* native/jni/gtk-peer/gnu_java_awt_peer_gtk_GdkPixbufDecoder.c:\n+\tuse DeleteLocalRef() to avoid exhausting local native references.\n+\n 2005-05-06  Mark Wielaard  <mark@klomp.org>\n \n \t* native/jni/gtk-peer/gnu_java_awt_peer_gtk_GtkWindowPeer.c:"}, {"sha": "535e990a811659fb0ad9fcaf9878389f865114e2", "filename": "libjava/jni/gtk-peer/gnu_java_awt_peer_gtk_GdkPixbufDecoder.c", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8108f99852f34a6b82184cff8fdb7640be46872b/libjava%2Fjni%2Fgtk-peer%2Fgnu_java_awt_peer_gtk_GdkPixbufDecoder.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8108f99852f34a6b82184cff8fdb7640be46872b/libjava%2Fjni%2Fgtk-peer%2Fgnu_java_awt_peer_gtk_GdkPixbufDecoder.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjni%2Fgtk-peer%2Fgnu_java_awt_peer_gtk_GdkPixbufDecoder.c?ref=8108f99852f34a6b82184cff8fdb7640be46872b", "patch": "@@ -206,6 +206,7 @@ query_formats (JNIEnv *env, jclass clazz)\n   jclass formatClass;\n   jmethodID addExtensionID;\n   jmethodID addMimeTypeID;\n+  jobject string;\n \n   formatClass = (*env)->FindClass\n     (env, \"gnu/java/awt/peer/gtk/GdkPixbufDecoder$ImageFormatSpec\");\n@@ -227,26 +228,33 @@ query_formats (JNIEnv *env, jclass clazz)\n       format = (GdkPixbufFormat *) f->data;\n       name = gdk_pixbuf_format_get_name(format);\n \n+      string = (*env)->NewStringUTF(env, name);\n+      g_assert(string != NULL);\n+\n       jformat = (*env)->CallStaticObjectMethod \n-\t(env, clazz, registerFormatID, \t\t\t\t    \n-\t (*env)->NewStringUTF(env, name),\n+\t(env, clazz, registerFormatID, string,\n \t (jboolean) gdk_pixbuf_format_is_writable(format));\n+      (*env)->DeleteLocalRef(env, string);\n \n       g_assert(jformat != NULL);\n       \n       ch = gdk_pixbuf_format_get_extensions(format);\n       while (*ch)\n \t{\n-\t  (*env)->CallVoidMethod (env, jformat, addExtensionID, \n-\t\t\t\t  (*env)->NewStringUTF(env, *ch)); \n+\t  string = (*env)->NewStringUTF(env, *ch);\n+\t  g_assert(string != NULL);\n+\t  (*env)->CallVoidMethod (env, jformat, addExtensionID, string);\n+\t  (*env)->DeleteLocalRef(env, string);\n \t  ++ch;\n \t}\n       \n       ch = gdk_pixbuf_format_get_mime_types(format);\n       while (*ch)\n \t{\n-\t  (*env)->CallVoidMethod (env, jformat, addMimeTypeID, \n-\t\t\t\t  (*env)->NewStringUTF(env, *ch)); \n+\t  string = (*env)->NewStringUTF(env, *ch);\n+\t  g_assert(string != NULL);\n+\t  (*env)->CallVoidMethod (env, jformat, addMimeTypeID, string);\n+\t  (*env)->DeleteLocalRef(env, string);\n \t  ++ch;\n \t}\n     }"}]}