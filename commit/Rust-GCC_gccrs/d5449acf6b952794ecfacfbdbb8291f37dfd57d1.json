{"sha": "d5449acf6b952794ecfacfbdbb8291f37dfd57d1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDU0NDlhY2Y2Yjk1Mjc5NGVjZmFjZmJkYmI4MjkxZjM3ZGZkNTdkMQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2015-05-07T16:46:49Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2015-05-07T16:46:49Z"}, "message": "DR 1467 PR c++/51747\n\n\tDR 1467\n\tPR c++/51747\n\t* typeck2.c (digest_init_r): Fix single element list.\n\nFrom-SVN: r222881", "tree": {"sha": "aa079c4af155d41d03dc21b1e1cc647a61937f1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aa079c4af155d41d03dc21b1e1cc647a61937f1f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d5449acf6b952794ecfacfbdbb8291f37dfd57d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d5449acf6b952794ecfacfbdbb8291f37dfd57d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d5449acf6b952794ecfacfbdbb8291f37dfd57d1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d5449acf6b952794ecfacfbdbb8291f37dfd57d1/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a3facd7c6cdc2d72a001603170a1602743b11803", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a3facd7c6cdc2d72a001603170a1602743b11803", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a3facd7c6cdc2d72a001603170a1602743b11803"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "4929faabfd533d5272814059f7d06f6819402f2a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5449acf6b952794ecfacfbdbb8291f37dfd57d1/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5449acf6b952794ecfacfbdbb8291f37dfd57d1/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d5449acf6b952794ecfacfbdbb8291f37dfd57d1", "patch": "@@ -1,3 +1,9 @@\n+2015-05-07  Jason Merrill  <jason@redhat.com>\n+\n+\tDR 1467\n+\tPR c++/51747\n+\t* typeck2.c (digest_init_r): Fix single element list.\n+\n 2015-05-05  Jason Merrill  <jason@redhat.com>\n \n \t* cp-gimplify.c (cp_genericize_r): Track TRY_BLOCK and"}, {"sha": "076f9a03498dc0025b0f71d8fb71f57f78f64684", "filename": "gcc/cp/typeck2.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5449acf6b952794ecfacfbdbb8291f37dfd57d1/gcc%2Fcp%2Ftypeck2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5449acf6b952794ecfacfbdbb8291f37dfd57d1/gcc%2Fcp%2Ftypeck2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck2.c?ref=d5449acf6b952794ecfacfbdbb8291f37dfd57d1", "patch": "@@ -1096,6 +1096,19 @@ digest_init_r (tree type, tree init, bool nested, int flags,\n \t      || TREE_CODE (type) == UNION_TYPE\n \t      || TREE_CODE (type) == COMPLEX_TYPE);\n \n+  /* \"If T is a class type and the initializer list has a single\n+     element of type cv U, where U is T or a class derived from T,\n+     the object is initialized from that element.\"  */\n+  if (cxx_dialect >= cxx11\n+      && BRACE_ENCLOSED_INITIALIZER_P (init)\n+      && CONSTRUCTOR_NELTS (init) == 1\n+      && (CLASS_TYPE_P (type) || VECTOR_TYPE_P (type)))\n+    {\n+      tree elt = CONSTRUCTOR_ELT (init, 0)->value;\n+      if (reference_related_p (type, TREE_TYPE (elt)))\n+\tinit = elt;\n+    }\n+\n   if (BRACE_ENCLOSED_INITIALIZER_P (init)\n       && !TYPE_NON_AGGREGATE_CLASS (type))\n     return process_init_constructor (type, init, complain);"}, {"sha": "fe2c8f61ba0bd613c63f4a9f9cfad69714822d44", "filename": "gcc/testsuite/g++.dg/cpp0x/initlist95.C", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d5449acf6b952794ecfacfbdbb8291f37dfd57d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist95.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d5449acf6b952794ecfacfbdbb8291f37dfd57d1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist95.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finitlist95.C?ref=d5449acf6b952794ecfacfbdbb8291f37dfd57d1", "patch": "@@ -0,0 +1,5 @@\n+// PR c++/51747\n+// { dg-do compile { target c++11 } }\n+\n+struct B {};\n+struct D : B {D(B b) : B{b} {}};"}]}