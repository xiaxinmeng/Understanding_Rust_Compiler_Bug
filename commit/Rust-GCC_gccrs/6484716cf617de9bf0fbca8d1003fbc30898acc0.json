{"sha": "6484716cf617de9bf0fbca8d1003fbc30898acc0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjQ4NDcxNmNmNjE3ZGU5YmYwZmJjYThkMTAwM2ZiYzMwODk4YWNjMA==", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@codesourcery.com", "date": "2010-05-26T19:27:58Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2010-05-26T19:27:58Z"}, "message": "java-tree.h (struct lang_decl_func): Change type of throws_list field to a VEC.\n\n\t* java-tree.h (struct lang_decl_func): Change type of throws_list\n\tfield to a VEC.\n\t* jcf-parse.c (HANDLE_EXCEPTIONS_ATTRIBUTE): Adjust for changed type\n\tof DECL_FUNCTION_THROWS.\n\t* class.c (make_method_value): Likewise.\n\nFrom-SVN: r159899", "tree": {"sha": "10c996e7a3c75332fea7e26d8c2da608d15ddad6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/10c996e7a3c75332fea7e26d8c2da608d15ddad6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6484716cf617de9bf0fbca8d1003fbc30898acc0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6484716cf617de9bf0fbca8d1003fbc30898acc0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6484716cf617de9bf0fbca8d1003fbc30898acc0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6484716cf617de9bf0fbca8d1003fbc30898acc0/comments", "author": null, "committer": null, "parents": [{"sha": "ab9b814d258a26fc74f370b8fdb2b9250088794c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab9b814d258a26fc74f370b8fdb2b9250088794c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab9b814d258a26fc74f370b8fdb2b9250088794c"}], "stats": {"total": 32, "additions": 21, "deletions": 11}, "files": [{"sha": "62839b4fde1a7fd72b9643fe3a046d498afe7828", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=6484716cf617de9bf0fbca8d1003fbc30898acc0", "patch": "@@ -1,3 +1,11 @@\n+2010-05-26  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* java-tree.h (struct lang_decl_func): Change type of throws_list\n+\tfield to a VEC.\n+\t* jcf-parse.c (HANDLE_EXCEPTIONS_ATTRIBUTE): Adjust for changed type\n+\tof DECL_FUNCTION_THROWS.\n+\t* class.c (make_method_value): Likewise.\n+\n 2010-05-26  Nathan Froyd  <froydnj@codesourcery.com>\n \n \t* class.c (utf8_decl_list): Delete."}, {"sha": "49299b885cd5ed8798e7fb4c97dff648fd043b34", "filename": "gcc/java/class.c", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fclass.c?ref=6484716cf617de9bf0fbca8d1003fbc30898acc0", "patch": "@@ -1519,18 +1519,19 @@ make_method_value (tree mdecl)\n   {\n     /* Compute the `throws' information for the method.  */\n     tree table = null_pointer_node;\n-    if (DECL_FUNCTION_THROWS (mdecl) != NULL_TREE)\n+    if (DECL_FUNCTION_THROWS (mdecl) != NULL)\n       {\n-\tint length = 1 + list_length (DECL_FUNCTION_THROWS (mdecl));\n-\ttree iter, type, array;\n+\tint length = 1 + VEC_length (tree, DECL_FUNCTION_THROWS (mdecl));\n+\ttree t, type, array;\n \tchar buf[60];\n+        unsigned ix;\n \n \ttable = tree_cons (NULL_TREE, table, NULL_TREE);\n-\tfor (iter = DECL_FUNCTION_THROWS (mdecl);\n-\t     iter != NULL_TREE;\n-\t     iter = TREE_CHAIN (iter))\n+\tfor (ix = 0;\n+\t     VEC_iterate (tree, DECL_FUNCTION_THROWS (mdecl), ix, t);\n+\t     ix++)\n \t  {\n-\t    tree sig = DECL_NAME (TYPE_NAME (TREE_VALUE (iter)));\n+\t    tree sig = DECL_NAME (TYPE_NAME (t));\n \t    tree utf8\n \t      = build_utf8_ref (unmangle_classname (IDENTIFIER_POINTER (sig),\n \t\t\t\t\t\t    IDENTIFIER_LENGTH (sig)));"}, {"sha": "83f3b3d4a368a8b09d1091a11aba78164f210450", "filename": "gcc/java/java-tree.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2Fjava-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2Fjava-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fjava-tree.h?ref=6484716cf617de9bf0fbca8d1003fbc30898acc0", "patch": "@@ -776,7 +776,7 @@ struct GTY(()) lang_decl_func {\n   int max_stack;\n   int arg_slot_count;\n   source_location last_line;\t/* End line number for a function decl */\n-  tree throws_list;\t\t/* Exception specified by `throws' */\n+  VEC(tree,gc) *throws_list;\t/* Exception specified by `throws' */\n   tree exc_obj;\t\t\t/* Decl holding the exception object.  */\n \n   /* Class initialization test variables  */"}, {"sha": "eef75aa2516ee86df56eb533036e02293cc58c89", "filename": "gcc/java/jcf-parse.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2Fjcf-parse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6484716cf617de9bf0fbca8d1003fbc30898acc0/gcc%2Fjava%2Fjcf-parse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fjcf-parse.c?ref=6484716cf617de9bf0fbca8d1003fbc30898acc0", "patch": "@@ -936,13 +936,14 @@ handle_signature_attribute (int member_index, JCF *jcf,\n #define HANDLE_EXCEPTIONS_ATTRIBUTE(COUNT) \\\n { \\\n   int n = COUNT; \\\n-  tree list = DECL_FUNCTION_THROWS (current_method); \\\n+  VEC (tree,gc) *v = VEC_alloc (tree, gc, n); \\\n+  gcc_assert (DECL_FUNCTION_THROWS (current_method) == NULL); \\\n   while (--n >= 0) \\\n     { \\\n       tree thrown_class = get_class_constant (jcf, JCF_readu2 (jcf)); \\\n-      list = tree_cons (NULL_TREE, thrown_class, list); \\\n+      VEC_quick_push (tree, v, thrown_class); \\\n     } \\\n-  DECL_FUNCTION_THROWS (current_method) = nreverse (list); \\\n+  DECL_FUNCTION_THROWS (current_method) = v; \\\n }\n \n #define HANDLE_DEPRECATED_ATTRIBUTE()  handle_deprecated ()"}]}