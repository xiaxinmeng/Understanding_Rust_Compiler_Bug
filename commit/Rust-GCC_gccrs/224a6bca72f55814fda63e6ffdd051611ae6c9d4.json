{"sha": "224a6bca72f55814fda63e6ffdd051611ae6c9d4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjI0YTZiY2E3MmY1NTgxNGZkYTYzZTZmZmRkMDUxNjExYWU2YzlkNA==", "commit": {"author": {"name": "Chris Ball", "email": "cball@fmco.com", "date": "1999-09-29T00:37:49Z"}, "committer": {"name": "Ovidiu Predescu", "email": "ovidiu@gcc.gnu.org", "date": "1999-09-29T00:37:49Z"}, "message": "Fixed deallocation of a mutex in thr-single.c (patch from Chris Ball <cball@fmco.com>).\n\nFrom-SVN: r29701", "tree": {"sha": "ad4339b76e285ab19d6102f0c2f74853669cd952", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ad4339b76e285ab19d6102f0c2f74853669cd952"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/224a6bca72f55814fda63e6ffdd051611ae6c9d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/224a6bca72f55814fda63e6ffdd051611ae6c9d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/224a6bca72f55814fda63e6ffdd051611ae6c9d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/224a6bca72f55814fda63e6ffdd051611ae6c9d4/comments", "author": null, "committer": null, "parents": [{"sha": "ab31268c62837c1d45d7fa6e332170129fa3aa05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab31268c62837c1d45d7fa6e332170129fa3aa05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab31268c62837c1d45d7fa6e332170129fa3aa05"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "8ded8934041e0b83689b630d6a5d7d2bf7236038", "filename": "libobjc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/224a6bca72f55814fda63e6ffdd051611ae6c9d4/libobjc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/224a6bca72f55814fda63e6ffdd051611ae6c9d4/libobjc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2FChangeLog?ref=224a6bca72f55814fda63e6ffdd051611ae6c9d4", "patch": "@@ -1,3 +1,7 @@\n+Thu Sep 23 07:19:12 1999   Chris Ball <cball@fmco.com>\n+\n+\t* thr-posix.c (__objc_mutex_deallocate): made deallocate work.\n+\n Tue Sep 21 07:47:10 1999  Jeffrey A Law  (law@cygnus.com)\n \n \t* Makefile.in (gc.o, gc_gc.o): Do not pass -fgnu-runtime to"}, {"sha": "a73c62777914a000ae60df6b7ab0e8f501589fa9", "filename": "libobjc/thr-posix.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/224a6bca72f55814fda63e6ffdd051611ae6c9d4/libobjc%2Fthr-posix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/224a6bca72f55814fda63e6ffdd051611ae6c9d4/libobjc%2Fthr-posix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2Fthr-posix.c?ref=224a6bca72f55814fda63e6ffdd051611ae6c9d4", "patch": "@@ -145,6 +145,20 @@ __objc_mutex_allocate(objc_mutex_t mutex)\n int\n __objc_mutex_deallocate(objc_mutex_t mutex)\n {\n+  int count = 1;\n+\n+  /*\n+   * Posix Threads specifically require that the thread be unlocked for\n+   * pthread_mutex_destroy to work.\n+   */\n+\n+  while ( count )\n+    {\n+      if (( count = pthread_mutex_unlock((pthread_mutex_t *)mutex->backend))\n+          < 0 )\n+        return -1;\n+    }\n+\n   if (pthread_mutex_destroy((pthread_mutex_t *)mutex->backend))\n     return -1;\n "}]}