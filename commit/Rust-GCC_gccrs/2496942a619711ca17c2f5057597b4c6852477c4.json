{"sha": "2496942a619711ca17c2f5057597b4c6852477c4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjQ5Njk0MmE2MTk3MTFjYTE3YzJmNTA1NzU5N2I0YzY4NTI0NzdjNA==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2004-08-04T11:30:31Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2004-08-04T11:30:31Z"}, "message": "cfglayout.c (insn_locators_initialize): Update the current location before initializing a location.\n\n\t* cfglayout.c (insn_locators_initialize): Update the current\n\tlocation before initializing a location.\n\nFrom-SVN: r85554", "tree": {"sha": "89ed5e2c88a93888f442be1a3b80f31631739686", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/89ed5e2c88a93888f442be1a3b80f31631739686"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2496942a619711ca17c2f5057597b4c6852477c4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2496942a619711ca17c2f5057597b4c6852477c4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2496942a619711ca17c2f5057597b4c6852477c4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2496942a619711ca17c2f5057597b4c6852477c4/comments", "author": null, "committer": null, "parents": [{"sha": "545eacdb4130cd64fb7cc5e4dd46e31b2753a18b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/545eacdb4130cd64fb7cc5e4dd46e31b2753a18b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/545eacdb4130cd64fb7cc5e4dd46e31b2753a18b"}], "stats": {"total": 72, "additions": 41, "deletions": 31}, "files": [{"sha": "c6ee6602ceac9af7217501ada6e95410283f9014", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2496942a619711ca17c2f5057597b4c6852477c4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2496942a619711ca17c2f5057597b4c6852477c4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2496942a619711ca17c2f5057597b4c6852477c4", "patch": "@@ -1,3 +1,8 @@\n+2004-08-04  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* cfglayout.c (insn_locators_initialize): Update the current\n+\tlocation before initializing a location.\n+\n 2004-08-03  Zack Weinberg  <zack@codesourcery.com>\n \n \t* dbxout.c (dbxout_function_decl): Always call dbxout_function_end."}, {"sha": "b805ae5bda996c272d7e9385fb248581da3c4a53", "filename": "gcc/cfglayout.c", "status": "modified", "additions": 36, "deletions": 31, "changes": 67, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2496942a619711ca17c2f5057597b4c6852477c4/gcc%2Fcfglayout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2496942a619711ca17c2f5057597b4c6852477c4/gcc%2Fcfglayout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfglayout.c?ref=2496942a619711ca17c2f5057597b4c6852477c4", "patch": "@@ -267,12 +267,38 @@ insn_locators_initialize (void)\n \n   for (insn = get_insns (); insn; insn = next)\n     {\n+      int active = 0;\n+      \n       next = NEXT_INSN (insn);\n \n-      if ((active_insn_p (insn)\n-\t   && GET_CODE (PATTERN (insn)) != ADDR_VEC\n-\t   && GET_CODE (PATTERN (insn)) != ADDR_DIFF_VEC)\n-\t  || !NEXT_INSN (insn)\n+      if (NOTE_P (insn))\n+\t{\n+\t  switch (NOTE_LINE_NUMBER (insn))\n+\t    {\n+\t    case NOTE_INSN_BLOCK_BEG:\n+\t    case NOTE_INSN_BLOCK_END:\n+\t      abort ();\n+\t      \n+\t    default:\n+\t      if (NOTE_LINE_NUMBER (insn) > 0)\n+\t\t{\n+\t\t  expanded_location xloc;\n+\t\t  NOTE_EXPANDED_LOCATION (xloc, insn);\n+\t\t  line_number = xloc.line;\n+\t\t  file_name = xloc.file;\n+\t\t}\n+\t      break;\n+\t    }\n+\t}\n+      else\n+\tactive = (active_insn_p (insn)\n+\t\t  && GET_CODE (PATTERN (insn)) != ADDR_VEC\n+\t\t  && GET_CODE (PATTERN (insn)) != ADDR_DIFF_VEC);\n+      \n+      check_block_change (insn, &block);\n+\n+      if (active\n+\t  || !next\n \t  || (!prologue_locator && file_name))\n \t{\n \t  if (last_block != block)\n@@ -296,34 +322,13 @@ insn_locators_initialize (void)\n \t      VARRAY_PUSH_CHAR_PTR (file_locators_files, (char *) file_name);\n \t      last_file_name = file_name;\n \t    }\n+\t  if (!prologue_locator && file_name)\n+\t    prologue_locator = loc;\n+\t  if (!next)\n+\t    epilogue_locator = loc;\n+\t  if (active)\n+\t    INSN_LOCATOR (insn) = loc;\n \t}\n-      if (!prologue_locator && file_name)\n-\tprologue_locator = loc;\n-      if (!NEXT_INSN (insn))\n-\tepilogue_locator = loc;\n-      if (active_insn_p (insn))\n-        INSN_LOCATOR (insn) = loc;\n-      else if (NOTE_P (insn))\n-\t{\n-\t  switch (NOTE_LINE_NUMBER (insn))\n-\t    {\n-\t    case NOTE_INSN_BLOCK_BEG:\n-\t    case NOTE_INSN_BLOCK_END:\n-\t      abort ();\n-\n-\t    default:\n-\t      if (NOTE_LINE_NUMBER (insn) > 0)\n-\t\t{\n-\t\t  expanded_location xloc;\n-\t\t  NOTE_EXPANDED_LOCATION (xloc, insn);\n-\t\t  line_number = xloc.line;\n-\t\t  file_name = xloc.file;\n-\t\t}\n-\t      break;\n-\t    }\n-\t}\n-\n-      check_block_change (insn, &block);\n     }\n \n   /* Tag the blocks with a depth number so that change_scope can find"}]}