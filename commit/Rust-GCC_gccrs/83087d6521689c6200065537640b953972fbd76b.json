{"sha": "83087d6521689c6200065537640b953972fbd76b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODMwODdkNjUyMTY4OWM2MjAwMDY1NTM3NjQwYjk1Mzk3MmZiZDc2Yg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-11-21T07:50:15Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-11-21T07:50:15Z"}, "message": "re PR debug/82933 (valgrind error in set_cur_line_info_table with -g)\n\n\tPR debug/82933\n\t* run-rtl-passes.c: Include debug.h.\n\t(run_rtl_passes): Call debug_hooks->assembly_start.\n\t* dwarf2out.c (dwarf2out_assembly_start): Return early if invoked\n\tmultiple times.\n\n\t* gcc.dg/rtl/x86_64/pr82933.c: New test.\n\nFrom-SVN: r254987", "tree": {"sha": "06169e53be962fd05c6cffbb4b25c7a7bdc25b7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/06169e53be962fd05c6cffbb4b25c7a7bdc25b7b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/83087d6521689c6200065537640b953972fbd76b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83087d6521689c6200065537640b953972fbd76b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83087d6521689c6200065537640b953972fbd76b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83087d6521689c6200065537640b953972fbd76b/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "644f013227facdd53e313b2cb60745cedfe0c6c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/644f013227facdd53e313b2cb60745cedfe0c6c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/644f013227facdd53e313b2cb60745cedfe0c6c8"}], "stats": {"total": 22, "additions": 22, "deletions": 0}, "files": [{"sha": "1c3aaede5ec0a945c88f8a56e6c636e28ee3989b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83087d6521689c6200065537640b953972fbd76b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83087d6521689c6200065537640b953972fbd76b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=83087d6521689c6200065537640b953972fbd76b", "patch": "@@ -1,5 +1,11 @@\n 2017-11-21  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/82933\n+\t* run-rtl-passes.c: Include debug.h.\n+\t(run_rtl_passes): Call debug_hooks->assembly_start.\n+\t* dwarf2out.c (dwarf2out_assembly_start): Return early if invoked\n+\tmultiple times.\n+\n \tPR target/82981\n \t* internal-fn.c (expand_mul_overflow): Use OPTAB_WIDEN instead of\n \tOPTAB_DIRECT in calls to expand_simple_binop."}, {"sha": "7fd6ae37fd27cd0604f0bc4d559aff64098e7591", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83087d6521689c6200065537640b953972fbd76b/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83087d6521689c6200065537640b953972fbd76b/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=83087d6521689c6200065537640b953972fbd76b", "patch": "@@ -27507,6 +27507,9 @@ dwarf2out_init (const char *filename ATTRIBUTE_UNUSED)\n static void\n dwarf2out_assembly_start (void)\n {\n+  if (text_section_line_info)\n+    return;\n+\n #ifndef DWARF2_LINENO_DEBUGGING_INFO\n   ASM_GENERATE_INTERNAL_LABEL (text_section_label, TEXT_SECTION_LABEL, 0);\n   ASM_GENERATE_INTERNAL_LABEL (text_end_label, TEXT_END_LABEL, 0);"}, {"sha": "dfb5d53eb0dd6ef48096aa8630095ef7f9323fb7", "filename": "gcc/run-rtl-passes.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83087d6521689c6200065537640b953972fbd76b/gcc%2Frun-rtl-passes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83087d6521689c6200065537640b953972fbd76b/gcc%2Frun-rtl-passes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frun-rtl-passes.c?ref=83087d6521689c6200065537640b953972fbd76b", "patch": "@@ -30,6 +30,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"bitmap.h\"\n #include \"df.h\"\n #include \"regs.h\"\n+#include \"debug.h\" /* for debug_hooks.  */\n #include \"insn-attr-common.h\" /* for INSN_SCHEDULING.  */\n #include \"insn-attr.h\" /* for init_sched_attrs.  */\n #include \"run-rtl-passes.h\"\n@@ -43,6 +44,9 @@ run_rtl_passes (char *initial_pass_name)\n   cfun->pass_startwith = initial_pass_name;\n   max_regno = max_reg_num ();\n \n+  /* cgraphunit.c normally handles this.  */\n+  (*debug_hooks->assembly_start) ();\n+\n   /* Pass \"expand\" normally sets this up.  */\n #ifdef INSN_SCHEDULING\n   init_sched_attrs ();"}, {"sha": "32fce8c44216efb8fa71040f888e1f8ce7c54c15", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83087d6521689c6200065537640b953972fbd76b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83087d6521689c6200065537640b953972fbd76b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=83087d6521689c6200065537640b953972fbd76b", "patch": "@@ -1,3 +1,8 @@\n+2017-11-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/82933\n+\t* gcc.dg/rtl/x86_64/pr82933.c: New test.\n+\n 2017-11-20  Eric Gallager  <egall@gwmail.gwu.edu>\n \n \tPR preprocessor/81794"}, {"sha": "68ffe4582d73307afd4a83394786ce61e8ecd512", "filename": "gcc/testsuite/gcc.dg/rtl/x86_64/pr82933.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83087d6521689c6200065537640b953972fbd76b/gcc%2Ftestsuite%2Fgcc.dg%2Frtl%2Fx86_64%2Fpr82933.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83087d6521689c6200065537640b953972fbd76b/gcc%2Ftestsuite%2Fgcc.dg%2Frtl%2Fx86_64%2Fpr82933.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Frtl%2Fx86_64%2Fpr82933.c?ref=83087d6521689c6200065537640b953972fbd76b", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do run { target { { i?86-*-* x86_64-*-* } && lp64 } } } */\n+/* { dg-options \"-g\" } */\n+\n+#include \"into-cfglayout.c\""}]}