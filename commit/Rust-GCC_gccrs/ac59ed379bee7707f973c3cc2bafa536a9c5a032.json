{"sha": "ac59ed379bee7707f973c3cc2bafa536a9c5a032", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWM1OWVkMzc5YmVlNzcwN2Y5NzNjM2NjMmJhZmE1MzZhOWM1YTAzMg==", "commit": {"author": {"name": "David S. Miller", "email": "davem@redhat.com", "date": "2003-07-16T08:36:27Z"}, "committer": {"name": "David S. Miller", "email": "davem@gcc.gnu.org", "date": "2003-07-16T08:36:27Z"}, "message": "sparc.c (sparc_nonflat_function_epilogue): Only emit nop if the last real insn is CALL_INSN.\n\n2003-07-15  David S. Miller  <davem@redhat.com>\n\n\t* config/sparc/sparc.c (sparc_nonflat_function_epilogue): Only\n\temit nop if the last real insn is CALL_INSN.\n\nFrom-SVN: r69440", "tree": {"sha": "772f98ae3b65200ab669ce9a1de315eb0077ed69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/772f98ae3b65200ab669ce9a1de315eb0077ed69"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac59ed379bee7707f973c3cc2bafa536a9c5a032", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac59ed379bee7707f973c3cc2bafa536a9c5a032", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac59ed379bee7707f973c3cc2bafa536a9c5a032", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac59ed379bee7707f973c3cc2bafa536a9c5a032/comments", "author": null, "committer": null, "parents": [{"sha": "9f13608f62f6a55bd9058d6b27c027fc3c246c35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f13608f62f6a55bd9058d6b27c027fc3c246c35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f13608f62f6a55bd9058d6b27c027fc3c246c35"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "40f58fd8f82a5f7f2920e1451dad73e987dfd686", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac59ed379bee7707f973c3cc2bafa536a9c5a032/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac59ed379bee7707f973c3cc2bafa536a9c5a032/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ac59ed379bee7707f973c3cc2bafa536a9c5a032", "patch": "@@ -1,3 +1,8 @@\n+2003-07-15  David S. Miller  <davem@redhat.com>\n+\n+\t* config/sparc/sparc.c (sparc_nonflat_function_epilogue): Only\n+\temit nop if the last real insn is CALL_INSN.\n+\n 2003-07-16  Danny Smith  <dannysmith@users.sourceforge.net>\n \n \t* config/i386/xm-mingw32.h (HOST_BIT_BUCKET): Define"}, {"sha": "14c7c1fcf737c41e7cae59f6e5d8e8b9a6fd1239", "filename": "gcc/config/sparc/sparc.c", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac59ed379bee7707f973c3cc2bafa536a9c5a032/gcc%2Fconfig%2Fsparc%2Fsparc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac59ed379bee7707f973c3cc2bafa536a9c5a032/gcc%2Fconfig%2Fsparc%2Fsparc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.c?ref=ac59ed379bee7707f973c3cc2bafa536a9c5a032", "patch": "@@ -4046,11 +4046,19 @@ sparc_nonflat_function_epilogue (file, size, leaf_function)\n \t of a function were call foo; dslot; this can make the return\n \t PC of foo (ie. address of call instruction plus 8) point to\n \t the first instruction in the next function.  */\n-      rtx insn;\n-\n-      fputs(\"\\tnop\\n\", file);\n+      rtx insn, last_real_insn;\n \n       insn = get_last_insn ();\n+\n+      last_real_insn = prev_real_insn (insn);\n+      if (last_real_insn\n+\t  && GET_CODE (last_real_insn) == INSN\n+\t  && GET_CODE (PATTERN (last_real_insn)) == SEQUENCE)\n+\tlast_real_insn = XVECEXP (PATTERN (last_real_insn), 0, 0);\n+\n+      if (last_real_insn && GET_CODE (last_real_insn) == CALL_INSN)\n+\tfputs(\"\\tnop\\n\", file);\n+\n       if (GET_CODE (insn) == NOTE)\n \t      insn = prev_nonnote_insn (insn);\n       if (insn && GET_CODE (insn) == BARRIER)"}]}