{"sha": "bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmY3ZTI0NzI3MWZlMWFlMDBhOTRkMWQ0YmE4ZTI2ZGI5NzY3ZDVjYg==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2005-10-06T00:02:57Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2005-10-06T00:02:57Z"}, "message": "re PR middle-end/23714 (ICE in expand_assignment)\n\n        PR 23714\n        * tree-cfg.c (mark_array_ref_addressable_1): New.\n        (mark_array_ref_addressable): New.\n        * tree-flow.h (mark_array_ref_addressable): Declare.\n        * tree-optimize.c (execute_cleanup_cfg_post_optimizing): Use it.\n\nFrom-SVN: r105022", "tree": {"sha": "0593d45ae4e083fc9bb38c628fa8114d59031624", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0593d45ae4e083fc9bb38c628fa8114d59031624"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/comments", "author": null, "committer": null, "parents": [{"sha": "c54c1b2b52cb2cc41b2b5aa88d83c16f3833428b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c54c1b2b52cb2cc41b2b5aa88d83c16f3833428b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c54c1b2b52cb2cc41b2b5aa88d83c16f3833428b"}], "stats": {"total": 59, "additions": 59, "deletions": 0}, "files": [{"sha": "a1ad32453286cfe93068802832b4b75bce6f766f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "patch": "@@ -1,3 +1,11 @@\n+2005-10-05  Richard Henderson  <rth@redhat.com>\n+\n+\tPR 23714\n+\t* tree-cfg.c (mark_array_ref_addressable_1): New.\n+\t(mark_array_ref_addressable): New.\n+\t* tree-flow.h (mark_array_ref_addressable): Declare.\n+\t* tree-optimize.c (execute_cleanup_cfg_post_optimizing): Use it.\n+\n 2005-10-05  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \tPR middle-end/20606"}, {"sha": "bf1b4ac5c969b4bf7e2b85bfe7dfea99fb2ed445", "filename": "gcc/testsuite/g++.dg/opt/pr23714.C", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr23714.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr23714.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr23714.C?ref=bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "patch": "@@ -0,0 +1,16 @@\n+// { dg-do compile }\n+// { dg-options \"-O2 -fnon-call-exceptions\" }\n+\n+void run (void) {\n+  float stack[1];\n+  float *sp = stack;\n+  try\n+  {\n+    float value2 = ((float) *(--sp));\n+    float value1 = ((float) *(--sp));\n+    *(sp++) = (value1 - value2);\n+  }\n+  catch (int *ex)\n+  {\n+  }\n+}"}, {"sha": "74e6063c0ab6f4b8a6ed55fec4cc05fc85b3eeb5", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "patch": "@@ -421,6 +421,39 @@ fold_cond_expr_cond (void)\n     }\n }\n \n+/* Mark the array of any remaining ARRAY_REFs as addressable.  */\n+\n+static tree\n+mark_array_ref_addressable_1 (tree *tp, int *walk_subtrees,\n+\t\t\t      void *data ATTRIBUTE_UNUSED)\n+{\n+  tree t = *tp;\n+\n+  if (DECL_P (t) || TYPE_P (t))\n+    *walk_subtrees = 0;\n+  else if (TREE_CODE (t) == ARRAY_REF)\n+    {\n+      tree base = get_base_address (TREE_OPERAND (t, 0));\n+      if (base && DECL_P (base))\n+\tTREE_ADDRESSABLE (base) = 1;\n+    }\n+\n+  return NULL_TREE;\n+}\n+\n+void\n+mark_array_ref_addressable (void)\n+{\n+  basic_block bb;\n+  block_stmt_iterator i;\n+\n+  FOR_EACH_BB (bb)\n+    {\n+      for (i = bsi_start (bb); !bsi_end_p(i); bsi_next(&i))\n+\twalk_tree (bsi_stmt_ptr (i), mark_array_ref_addressable_1, NULL, NULL);\n+    }\n+}\n+\n /* Join all the blocks in the flowgraph.  */\n \n static void"}, {"sha": "f00f09ebba9ebc0707bfe182b4291da959fd227e", "filename": "gcc/tree-flow.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftree-flow.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftree-flow.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-flow.h?ref=bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "patch": "@@ -556,6 +556,7 @@ extern tree gimplify_build3 (block_stmt_iterator *, enum tree_code,\n \t\t\t     tree, tree, tree, tree);\n extern void init_empty_tree_cfg (void);\n extern void fold_cond_expr_cond (void);\n+extern void mark_array_ref_addressable (void);\n extern void replace_uses_by (tree, tree);\n extern void start_recording_case_labels (void);\n extern void end_recording_case_labels (void);"}, {"sha": "64b11d29927a2c274ad942cca656d27ff6bca3be", "filename": "gcc/tree-optimize.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftree-optimize.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb/gcc%2Ftree-optimize.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-optimize.c?ref=bf7e247271fe1ae00a94d1d4ba8e26db9767d5cb", "patch": "@@ -133,6 +133,7 @@ static void\n execute_cleanup_cfg_post_optimizing (void)\n {\n   fold_cond_expr_cond ();\n+  mark_array_ref_addressable ();\n   cleanup_tree_cfg ();\n   cleanup_dead_labels ();\n   group_case_labels ();"}]}