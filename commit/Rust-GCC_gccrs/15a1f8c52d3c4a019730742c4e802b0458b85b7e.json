{"sha": "15a1f8c52d3c4a019730742c4e802b0458b85b7e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTVhMWY4YzUyZDNjNGEwMTk3MzA3NDJjNGU4MDJiMDQ1OGI4NWI3ZQ==", "commit": {"author": {"name": "Kai Tietz", "email": "kai.tietz@onevision.com", "date": "2010-07-06T18:25:26Z"}, "committer": {"name": "Kai Tietz", "email": "ktietz@gcc.gnu.org", "date": "2010-07-06T18:25:26Z"}, "message": "ms_hook_prologue.c: Add x64 ms_hook_prologue support.\n\n2010-07-06  Kai Tietz  <kai.tietz@onevision.com>\n\n        * gcc.target/i386/ms_hook_prologue.c: Add x64 ms_hook_prologue\n        support.\n        * gcc.target/i386/i386.exp: Likewise.\n\nFrom-SVN: r161875", "tree": {"sha": "786322667b795319c646f390371d479d64dab679", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/786322667b795319c646f390371d479d64dab679"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/15a1f8c52d3c4a019730742c4e802b0458b85b7e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15a1f8c52d3c4a019730742c4e802b0458b85b7e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15a1f8c52d3c4a019730742c4e802b0458b85b7e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15a1f8c52d3c4a019730742c4e802b0458b85b7e/comments", "author": null, "committer": null, "parents": [{"sha": "6b0bcc9bfe4ab0dc3ae0b8a6815c9a3c8f520c04", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b0bcc9bfe4ab0dc3ae0b8a6815c9a3c8f520c04", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6b0bcc9bfe4ab0dc3ae0b8a6815c9a3c8f520c04"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "cf61679cf4ac50461b4517fe83be39f3c02051d8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15a1f8c52d3c4a019730742c4e802b0458b85b7e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15a1f8c52d3c4a019730742c4e802b0458b85b7e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=15a1f8c52d3c4a019730742c4e802b0458b85b7e", "patch": "@@ -1,3 +1,9 @@\n+2010-07-06  Kai Tietz  <kai.tietz@onevision.com>\n+\n+\t* gcc.target/i386/ms_hook_prologue.c: Add x64 ms_hook_prologue\n+\tsupport.\n+\t* gcc.target/i386/i386.exp: Likewise.\n+\n 2010-07-06  Peter Bergner  <bergner@vnet.ibm.com>\n \n \tPR testsuite/44195"}, {"sha": "65abf58db81c7a8525c5fabb11ab0eae411090a2", "filename": "gcc/testsuite/gcc.target/i386/i386.exp", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15a1f8c52d3c4a019730742c4e802b0458b85b7e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fi386.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15a1f8c52d3c4a019730742c4e802b0458b85b7e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fi386.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fi386.exp?ref=15a1f8c52d3c4a019730742c4e802b0458b85b7e", "patch": "@@ -27,8 +27,7 @@ load_lib gcc-dg.exp\n \n # Return 1 if attribute ms_hook_prologue is supported.\n proc check_effective_target_ms_hook_prologue { } {\n-    if { [check_effective_target_ilp32]\n-\t && [check_no_compiler_messages ms_hook_prologue object {\n+    if { [check_no_compiler_messages ms_hook_prologue object {\n \t     void __attribute__ ((__ms_hook_prologue__)) foo ();\n \t } \"\"] } {\n \treturn 1"}, {"sha": "e11bcc049cb2ca14f644944e29e17fd92d39c73b", "filename": "gcc/testsuite/gcc.target/i386/ms_hook_prologue.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15a1f8c52d3c4a019730742c4e802b0458b85b7e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fms_hook_prologue.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15a1f8c52d3c4a019730742c4e802b0458b85b7e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fms_hook_prologue.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fms_hook_prologue.c?ref=15a1f8c52d3c4a019730742c4e802b0458b85b7e", "patch": "@@ -11,7 +11,7 @@ int __attribute__ ((__ms_hook_prologue__)) foo ()\n   /* The NOP mov must not be optimized away by optimizations.\n      The push %ebp, mov %esp, %ebp must not be removed by\n      -fomit-frame-pointer */\n-\n+#ifndef __x86_64__\n   /* movl.s %edi, %edi */\n   if(*ptr++ != 0x8b) return 1;\n   if(*ptr++ != 0xff) return 1;\n@@ -20,6 +20,15 @@ int __attribute__ ((__ms_hook_prologue__)) foo ()\n   /* movl.s %esp, %ebp */\n   if(*ptr++ != 0x8b) return 1;\n   if(*ptr++ != 0xec) return 1;\n+#else\n+  /* leaq 0(%rsp), %rsp */\n+  if (*ptr++ != 0x48) return 1;\n+  if (*ptr++ != 0x8d) return 1;\n+  if (*ptr++ != 0xa4) return 1;\n+  if (*ptr++ != 0x24) return 1;\n+  if (ptr[0] != 0 || ptr[1] != 0 || ptr[2] != 0 || ptr[3] != 0)\n+    return 1;\n+#endif\n   return 0;\n }\n "}]}