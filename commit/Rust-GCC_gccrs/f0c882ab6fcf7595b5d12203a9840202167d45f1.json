{"sha": "f0c882ab6fcf7595b5d12203a9840202167d45f1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjBjODgyYWI2ZmNmNzU5NWI1ZDEyMjAzYTk4NDAyMDIxNjdkNDVmMQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2008-06-18T13:42:36Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2008-06-18T13:42:36Z"}, "message": "cgraph.h (cgraph_mark_if_needed): New function.\n\n\n\t* cgraph.h (cgraph_mark_if_needed): New function.\n\t* cgraphunit.c (cgraph_mark_if_needed): New function.\n\t* c-decl.c (duplicate_decl): Use it.\n\nFrom-SVN: r136893", "tree": {"sha": "0f7aeaefa2ec493bdcf33125095f31469d281db5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0f7aeaefa2ec493bdcf33125095f31469d281db5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f0c882ab6fcf7595b5d12203a9840202167d45f1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0c882ab6fcf7595b5d12203a9840202167d45f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f0c882ab6fcf7595b5d12203a9840202167d45f1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0c882ab6fcf7595b5d12203a9840202167d45f1/comments", "author": null, "committer": null, "parents": [{"sha": "ff2c88a5611bfb610de62937e762457124747d3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff2c88a5611bfb610de62937e762457124747d3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff2c88a5611bfb610de62937e762457124747d3c"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "743b89b4a5527b422b41a260c5e6992630cc6440", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f0c882ab6fcf7595b5d12203a9840202167d45f1", "patch": "@@ -1,3 +1,9 @@\n+2008-06-16  Jan Hubicka  <jh@suse.cz>\n+\n+\t* cgraph.h (cgraph_mark_if_needed): New function.\n+\t* cgraphunit.c (cgraph_mark_if_needed): New function.\n+\t* c-decl.c (duplicate_decl): Use it.\n+\n 2008-06-16  Jan Hubicka  <jh@suse.cz>\n \n \t* cgraph.c (cgraph_add_new_function): When in expansion state, do"}, {"sha": "38c1581b3ff103f3abaacb47bf749ff7f6ea6965", "filename": "gcc/c-decl.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=f0c882ab6fcf7595b5d12203a9840202167d45f1", "patch": "@@ -1913,9 +1913,9 @@ merge_decls (tree newdecl, tree olddecl, tree newtype, tree oldtype)\n   /* If we changed a function from DECL_EXTERNAL to !DECL_EXTERNAL,\n      and the definition is coming from the old version, cgraph needs\n      to be called again.  */\n-  if (extern_changed && !new_is_definition \n+  if (extern_changed && !new_is_definition\n       && TREE_CODE (olddecl) == FUNCTION_DECL && DECL_INITIAL (olddecl))\n-    cgraph_finalize_function (olddecl, false);\n+    cgraph_mark_if_needed (olddecl);\n }\n \n /* Handle when a new declaration NEWDECL has the same name as an old"}, {"sha": "dda2a1891f5421021be8a213e69e98854797bce8", "filename": "gcc/cgraph.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2Fcgraph.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2Fcgraph.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraph.h?ref=f0c882ab6fcf7595b5d12203a9840202167d45f1", "patch": "@@ -331,6 +331,7 @@ void cgraph_add_new_function (tree, bool);\n \n /* In cgraphunit.c  */\n void cgraph_finalize_function (tree, bool);\n+void cgraph_mark_if_needed (tree);\n void cgraph_finalize_compilation_unit (void);\n void cgraph_optimize (void);\n void cgraph_mark_needed_node (struct cgraph_node *);"}, {"sha": "dec2213171277aadcdfa3d53c26b428fff40fc0b", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0c882ab6fcf7595b5d12203a9840202167d45f1/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=f0c882ab6fcf7595b5d12203a9840202167d45f1", "patch": "@@ -642,6 +642,18 @@ cgraph_finalize_function (tree decl, bool nested)\n     do_warn_unused_parameter (decl);\n }\n \n+/* C99 extern inline keywords allow changing of declaration after function\n+   has been finalized.  We need to re-decide if we want to mark the function as\n+   needed then.   */\n+\n+void\n+cgraph_mark_if_needed (tree decl)\n+{\n+  struct cgraph_node *node = cgraph_node (decl);\n+  if (node->local.finalized && decide_is_function_needed (node, decl))\n+    cgraph_mark_needed_node (node);\n+}\n+\n /* Verify cgraph nodes of given cgraph node.  */\n void\n verify_cgraph_node (struct cgraph_node *node)"}]}