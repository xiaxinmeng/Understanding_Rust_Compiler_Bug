{"sha": "08ee9e8569e0742406dd585c2762df31b7ae0f6f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDhlZTllODU2OWUwNzQyNDA2ZGQ1ODVjMjc2MmRmMzFiN2FlMGY2Zg==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-07-31T22:14:29Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-07-31T22:14:29Z"}, "message": "re PR fortran/31609 (module that calls a contained function with an ENTRY point)\n\n2007-08-01  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/31609\n\t* resolve.c (resolve_entries): Entries declared to be module\n\tprocedures must point to the function namespace.\n\n2007-08-01  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/31609\n\t* gfortran.dg/entry_12.f90: New test.\n\nFrom-SVN: r127108", "tree": {"sha": "961f07e69994ec9592dc4674d7d25ec987402250", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/961f07e69994ec9592dc4674d7d25ec987402250"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/08ee9e8569e0742406dd585c2762df31b7ae0f6f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08ee9e8569e0742406dd585c2762df31b7ae0f6f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08ee9e8569e0742406dd585c2762df31b7ae0f6f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08ee9e8569e0742406dd585c2762df31b7ae0f6f/comments", "author": null, "committer": null, "parents": [{"sha": "13e7cedb76dd9a0749e1fd739ddcc188fd6dfde5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13e7cedb76dd9a0749e1fd739ddcc188fd6dfde5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/13e7cedb76dd9a0749e1fd739ddcc188fd6dfde5"}], "stats": {"total": 50, "additions": 50, "deletions": 0}, "files": [{"sha": "4acddfd1d2c7e63ece327da75f86af4a49cada4d", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=08ee9e8569e0742406dd585c2762df31b7ae0f6f", "patch": "@@ -1,3 +1,9 @@\n+2007-08-01  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/31609\n+\t* resolve.c (resolve_entries): Entries declared to be module\n+\tprocedures must point to the function namespace.\n+\n 2007-07-31  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/32938"}, {"sha": "4b8d1450d0f743fa725400ccc3cd71067c7de762", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=08ee9e8569e0742406dd585c2762df31b7ae0f6f", "patch": "@@ -431,6 +431,15 @@ resolve_entries (gfc_namespace *ns)\n       && ns->parent && ns->parent->proc_name->attr.flavor == FL_MODULE)\n     el->sym->ns = ns;\n \n+  /* Do the same for entries where the master is not a module\n+     procedure.  These are retained in the module namespace because\n+     of the module procedure declaration.  */\n+  for (el = el->next; el; el = el->next)\n+    if (el->sym->ns->proc_name->attr.flavor == FL_MODULE\n+\t  && el->sym->attr.mod_proc)\n+      el->sym->ns = ns;\n+  el = ns->entries;\n+\n   /* Add an entry statement for it.  */\n   c = gfc_get_code ();\n   c->op = EXEC_ENTRY;"}, {"sha": "2ef4a14cd44ac802318944e4b079fbabb9ff6997", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=08ee9e8569e0742406dd585c2762df31b7ae0f6f", "patch": "@@ -1,3 +1,8 @@\n+2007-08-01  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/31609\n+\t* gfortran.dg/entry_12.f90: New test.\n+\n 2007-07-31  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/32938"}, {"sha": "8793b42520ee3f8a86cc754e9bb85321dfe8e414", "filename": "gcc/testsuite/gfortran.dg/entry_12.f90", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ftestsuite%2Fgfortran.dg%2Fentry_12.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/08ee9e8569e0742406dd585c2762df31b7ae0f6f/gcc%2Ftestsuite%2Fgfortran.dg%2Fentry_12.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fentry_12.f90?ref=08ee9e8569e0742406dd585c2762df31b7ae0f6f", "patch": "@@ -0,0 +1,30 @@\n+! { dg-do run }\r\n+! Tests the fix for pr31609, where module procedure entries found\r\n+! themselves in the wrong namespace.  This test checks that all\r\n+! combinations of generic and specific calls work correctly.\r\n+!\r\n+! Contributed by Paul Thomas <pault@gcc.gnu.org> as comment #8 to the pr.\r\n+!\r\n+MODULE ksbin1_aux_mod\r\n+  interface foo\r\n+    module procedure j\r\n+  end interface\r\n+  interface bar\r\n+    module procedure k\r\n+  end interface\r\n+  interface foobar\r\n+    module procedure j, k\r\n+  end interface\r\n+  CONTAINS\r\n+    FUNCTION j () \r\n+    j = 1\r\n+    return\r\n+    ENTRY k (i) \r\n+    k = 2\r\n+    END FUNCTION j\r\n+END MODULE ksbin1_aux_mod\r\n+\r\n+    use ksbin1_aux_mod\r\n+    if (any ((/foo (), bar (99), foobar (), foobar (99), j (), k (99)/) .ne. &\r\n+             (/1, 2, 1, 2, 1, 2/))) Call abort ()\r\n+end\r"}]}