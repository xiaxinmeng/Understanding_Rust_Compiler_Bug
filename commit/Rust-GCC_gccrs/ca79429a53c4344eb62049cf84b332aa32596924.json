{"sha": "ca79429a53c4344eb62049cf84b332aa32596924", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2E3OTQyOWE1M2M0MzQ0ZWI2MjA0OWNmODRiMzMyYWEzMjU5NjkyNA==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2001-01-13T19:58:43Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2001-01-13T19:58:43Z"}, "message": "ggc-page.c (alloc_page): Round up allocation size to one page.\n\n        * ggc-page.c (alloc_page): Round up allocation size to one page.\n        Set e->order on extra pages.\n\nFrom-SVN: r38990", "tree": {"sha": "7c773f88743dffba2d709a2cbc5f4412c0794efe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7c773f88743dffba2d709a2cbc5f4412c0794efe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ca79429a53c4344eb62049cf84b332aa32596924", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca79429a53c4344eb62049cf84b332aa32596924", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca79429a53c4344eb62049cf84b332aa32596924", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca79429a53c4344eb62049cf84b332aa32596924/comments", "author": null, "committer": null, "parents": [{"sha": "2cec75a1bd9efacb57c9c262af45e32fd712b2dc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2cec75a1bd9efacb57c9c262af45e32fd712b2dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2cec75a1bd9efacb57c9c262af45e32fd712b2dc"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "dab14f20414c0538b0aedcd0524ec97a206af275", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca79429a53c4344eb62049cf84b332aa32596924/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca79429a53c4344eb62049cf84b332aa32596924/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ca79429a53c4344eb62049cf84b332aa32596924", "patch": "@@ -1,3 +1,8 @@\n+2001-01-13  Richard Henderson  <rth@redhat.com>\n+\n+\t* ggc-page.c (alloc_page): Round up allocation size to one page.\n+\tSet e->order on extra pages.\n+\n 2001-01-13  Richard Henderson  <rth@redhat.com>\n \n \t* genrecog.c (nodes_identical): Expand commentary."}, {"sha": "fa66aa49937b94052a8d785d1b9e0ff3d5d620e5", "filename": "gcc/ggc-page.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca79429a53c4344eb62049cf84b332aa32596924/gcc%2Fggc-page.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca79429a53c4344eb62049cf84b332aa32596924/gcc%2Fggc-page.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fggc-page.c?ref=ca79429a53c4344eb62049cf84b332aa32596924", "patch": "@@ -517,6 +517,8 @@ alloc_page (order)\n   bitmap_size = BITMAP_SIZE (num_objects + 1);\n   page_entry_size = sizeof (page_entry) - sizeof (long) + bitmap_size;\n   entry_size = num_objects * OBJECT_SIZE (order);\n+  if (entry_size < G.pagesize)\n+    entry_size = G.pagesize;\n \n   entry = NULL;\n   page = NULL;\n@@ -549,14 +551,15 @@ alloc_page (order)\n       struct page_entry *e, *f = G.free_pages;\n       int i;\n \n-      page = alloc_anon (NULL, entry_size * GGC_QUIRE_SIZE);\n+      page = alloc_anon (NULL, G.pagesize * GGC_QUIRE_SIZE);\n       /* This loop counts down so that the chain will be in ascending\n \t memory order.  */\n       for (i = GGC_QUIRE_SIZE - 1; i >= 1; i--)\n \t{\n-\t  e = (struct page_entry *) xcalloc (1, sizeof (struct page_entry));\n-\t  e->bytes = entry_size;\n-\t  e->page = page + i*entry_size;\n+\t  e = (struct page_entry *) xcalloc (1, page_entry_size);\n+\t  e->order = order;\n+\t  e->bytes = G.pagesize;\n+\t  e->page = page + (i << G.lg_pagesize);\n \t  e->next = f;\n \t  f = e;\n \t}"}]}