{"sha": "b1ba284ce3661918d857e9ea26bc8b1b428d6669", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjFiYTI4NGNlMzY2MTkxOGQ4NTdlOWVhMjZiYzhiMWI0MjhkNjY2OQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2010-10-13T18:18:36Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2010-10-13T18:18:36Z"}, "message": "cse.c (cse_insn): Fix thinko in the canonicalization of USE insns.\n\n\t* cse.c (cse_insn): Fix thinko in the canonicalization of USE insns.\n\tCanonicalize input operands of ASM_OPERANDS insns.\n\nFrom-SVN: r165429", "tree": {"sha": "7d2875c2390a1a897e97fc4c5055bba42e4890df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d2875c2390a1a897e97fc4c5055bba42e4890df"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b1ba284ce3661918d857e9ea26bc8b1b428d6669", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1ba284ce3661918d857e9ea26bc8b1b428d6669", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b1ba284ce3661918d857e9ea26bc8b1b428d6669", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1ba284ce3661918d857e9ea26bc8b1b428d6669/comments", "author": null, "committer": null, "parents": [{"sha": "879b9073c87cea54033e137b1ac68807ee040bcd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/879b9073c87cea54033e137b1ac68807ee040bcd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/879b9073c87cea54033e137b1ac68807ee040bcd"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "7a434ace8524cb9ed59f7f7bb0a19cbb5717ce69", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b1ba284ce3661918d857e9ea26bc8b1b428d6669/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b1ba284ce3661918d857e9ea26bc8b1b428d6669/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b1ba284ce3661918d857e9ea26bc8b1b428d6669", "patch": "@@ -1,3 +1,8 @@\n+2010-10-13  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* cse.c (cse_insn): Fix thinko in the canonicalization of USE insns.\n+\tCanonicalize input operands of ASM_OPERANDS insns.\n+\n 2010-10-13  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/45788"}, {"sha": "4d10c842e0fa7df6d1ce3a2ceea5a8e7a977b3aa", "filename": "gcc/cse.c", "status": "modified", "additions": 13, "deletions": 2, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b1ba284ce3661918d857e9ea26bc8b1b428d6669/gcc%2Fcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b1ba284ce3661918d857e9ea26bc8b1b428d6669/gcc%2Fcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcse.c?ref=b1ba284ce3661918d857e9ea26bc8b1b428d6669", "patch": "@@ -4338,12 +4338,23 @@ cse_insn (rtx insn)\n       if (MEM_P (XEXP (x, 0)))\n \tcanon_reg (XEXP (x, 0), insn);\n     }\n-\n   /* Canonicalize a USE of a pseudo register or memory location.  */\n   else if (GET_CODE (x) == USE\n \t   && ! (REG_P (XEXP (x, 0))\n \t\t && REGNO (XEXP (x, 0)) < FIRST_PSEUDO_REGISTER))\n-    canon_reg (XEXP (x, 0), insn);\n+    canon_reg (x, insn);\n+  else if (GET_CODE (x) == ASM_OPERANDS)\n+    {\n+      for (i = ASM_OPERANDS_INPUT_LENGTH (x) - 1; i >= 0; i--)\n+\t{\n+\t  rtx input = ASM_OPERANDS_INPUT (x, i);\n+\t  if (!(REG_P (input) && REGNO (input) < FIRST_PSEUDO_REGISTER))\n+\t    {\n+\t      input = canon_reg (input, insn);\n+\t      validate_change (insn, &ASM_OPERANDS_INPUT (x, i), input, 1);\n+\t    }\n+\t}\n+    }\n   else if (GET_CODE (x) == CALL)\n     {\n       /* The result of apply_change_group can be ignored; see canon_reg.  */"}]}