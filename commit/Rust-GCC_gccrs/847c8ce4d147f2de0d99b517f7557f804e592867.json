{"sha": "847c8ce4d147f2de0d99b517f7557f804e592867", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQ3YzhjZTRkMTQ3ZjJkZTBkOTliNTE3Zjc1NTdmODA0ZTU5Mjg2Nw==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2007-11-03T19:41:20Z"}, "committer": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2007-11-03T19:41:20Z"}, "message": "re PR c/29062 (unclear diagnostic for declaration after label)\n\n2007-11-03  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n\n\tPR c/29062\n\t* c-parser.c (c_parser_statement_after_labels): Error if a\n\tdeclaration is parsed after a label.\ntestsuite/\n\t* gcc.dg/20031223-1.c: Adjust error output.\n\t* gcc.dg/parse-decl-after-label.c: New.\n\nFrom-SVN: r129873", "tree": {"sha": "7bc7dbed0e4fd908371d348e8825c159f47093f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7bc7dbed0e4fd908371d348e8825c159f47093f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/847c8ce4d147f2de0d99b517f7557f804e592867", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/847c8ce4d147f2de0d99b517f7557f804e592867", "html_url": "https://github.com/Rust-GCC/gccrs/commit/847c8ce4d147f2de0d99b517f7557f804e592867", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/847c8ce4d147f2de0d99b517f7557f804e592867/comments", "author": null, "committer": null, "parents": [{"sha": "47c95bff6b78a2f8e632714172f1ba004d449cca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47c95bff6b78a2f8e632714172f1ba004d449cca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47c95bff6b78a2f8e632714172f1ba004d449cca"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "0ec67363b9974cf22a0d2c35aedc0eac3049d272", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=847c8ce4d147f2de0d99b517f7557f804e592867", "patch": "@@ -1,3 +1,9 @@\n+2007-11-03  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n+\n+\tPR c/29062\n+\t* c-parser.c (c_parser_statement_after_labels): Error if a\n+\tdeclaration is parsed after a label.\n+\t\n 2007-11-03  Daniel Jacobowitz  <dan@codesourcery.com>\n \n \tPR debug/33921"}, {"sha": "322f600e65d8e6f66cd40bf80696fd3c073f8b93", "filename": "gcc/c-parser.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Fc-parser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Fc-parser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-parser.c?ref=847c8ce4d147f2de0d99b517f7557f804e592867", "patch": "@@ -3811,6 +3811,14 @@ c_parser_statement_after_labels (c_parser *parser)\n       break;\n     default:\n     expr_stmt:\n+      if (c_parser_next_token_starts_declspecs (parser)) \n+\t{\n+\t  error (\"a label can only be part of a statement and a declaration is not a statement\");\n+\t  c_parser_declaration_or_fndef (parser, /*fndef_ok*/ false, \n+\t\t\t\t\t /*nested*/ true, /*empty_ok*/ false,\n+\t\t\t\t\t /*start_attr_ok*/ true);\n+\t  return;\n+\t}\n       stmt = c_finish_expr_stmt (c_parser_expression_conv (parser).value);\n     expect_semicolon:\n       c_parser_skip_until_found (parser, CPP_SEMICOLON, \"expected %<;%>\");"}, {"sha": "4634c63bc86cb771939d4164c943a56b86c7d88c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=847c8ce4d147f2de0d99b517f7557f804e592867", "patch": "@@ -1,3 +1,9 @@\n+2007-11-03  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n+\n+\tPR c/29062\n+\t* gcc.dg/20031223-1.c: Adjust error output.\n+\t* gcc.dg/parse-decl-after-label.c: New.\n+\t\n 2007-11-03  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libfortran/24685"}, {"sha": "d44a9cdcfc5ded5593768a1e91715fe191ba7be2", "filename": "gcc/testsuite/gcc.dg/20031223-1.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Ftestsuite%2Fgcc.dg%2F20031223-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Ftestsuite%2Fgcc.dg%2F20031223-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F20031223-1.c?ref=847c8ce4d147f2de0d99b517f7557f804e592867", "patch": "@@ -7,5 +7,6 @@\n \n void f ()\n {\n- l: int; /* { dg-error \"\" } */\n+ l: int; /* { dg-error \"a label can only be part of a statement and a declaration is not a statement\" } */\n+ /* { dg-warning \"useless type name in empty declaration\" \"\" { target *-*-* } 10 } */\n }"}, {"sha": "f457c6a69bd222d3d751d320f23fab2af45a4538", "filename": "gcc/testsuite/gcc.dg/parse-decl-after-label.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Ftestsuite%2Fgcc.dg%2Fparse-decl-after-label.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/847c8ce4d147f2de0d99b517f7557f804e592867/gcc%2Ftestsuite%2Fgcc.dg%2Fparse-decl-after-label.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fparse-decl-after-label.c?ref=847c8ce4d147f2de0d99b517f7557f804e592867", "patch": "@@ -0,0 +1,17 @@\n+/* PR 29062 \n+{ dg-do compile }\n+{ dg-options \"-fsyntax-only\" }\n+*/\n+\n+int f(x)\n+{\n+  if (x > 1) \n+    {\n+      goto finish;\n+    }\n+  return x;\n+  \n+ finish:\n+  int ret = 1; /* { dg-error \"a label can only be part of a statement and a declaration is not a statement\" } */\n+  return ret;\n+}"}]}