{"sha": "492e5456785bd2e22f7eca788589f5334780a36c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDkyZTU0NTY3ODViZDJlMjJmN2VjYTc4ODU4OWY1MzM0NzgwYTM2Yw==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2010-09-30T21:18:38Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2010-09-30T21:18:38Z"}, "message": "Fix chrec_contains_symbols_defined_in_loop.\n\n2010-08-20  Sebastian Pop  <sebastian.pop@amd.com>\n\n\t* tree-scalar-evolution.c (chrec_contains_symbols_defined_in_loop):\n\tDo not check for VAR_DECL, PARM_DECL, FUNCTION_DECL, LABEL_DECL,\n\tRESULT_DECL, and FIELD_DECL.  Return false for an\n\tSSA_NAME_IS_DEFAULT_DEF.\n\t(compute_scalar_evolution_in_loop): Do not further analyze the\n\tscalar evolution when no_evolution_in_loop_p returns true.\n\nFrom-SVN: r164789", "tree": {"sha": "d40aaf45844c05a0f308914499d089d6a8955b40", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d40aaf45844c05a0f308914499d089d6a8955b40"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/492e5456785bd2e22f7eca788589f5334780a36c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/492e5456785bd2e22f7eca788589f5334780a36c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/492e5456785bd2e22f7eca788589f5334780a36c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/492e5456785bd2e22f7eca788589f5334780a36c/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "21d9100956cc5e926c5ae38df8f9befd7ee58c7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21d9100956cc5e926c5ae38df8f9befd7ee58c7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21d9100956cc5e926c5ae38df8f9befd7ee58c7d"}], "stats": {"total": 43, "additions": 32, "deletions": 11}, "files": [{"sha": "bd84f6691658581eedf26da688635456a0ede0f3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492e5456785bd2e22f7eca788589f5334780a36c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492e5456785bd2e22f7eca788589f5334780a36c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=492e5456785bd2e22f7eca788589f5334780a36c", "patch": "@@ -1,3 +1,12 @@\n+2010-09-30  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* tree-scalar-evolution.c (chrec_contains_symbols_defined_in_loop):\n+\tDo not check for VAR_DECL, PARM_DECL, FUNCTION_DECL, LABEL_DECL,\n+\tRESULT_DECL, and FIELD_DECL.  Return false for an\n+\tSSA_NAME_IS_DEFAULT_DEF.\n+\t(compute_scalar_evolution_in_loop): Do not further analyze the\n+\tscalar evolution when no_evolution_in_loop_p returns true.\n+\n 2010-09-30  Sebastian Pop  <sebastian.pop@amd.com>\n \n \t* tree-chrec.h (evolution_function_is_affine_p): Do not check"}, {"sha": "ea6bb12e4c70ae7cf697bfeb6026c2b1836ae7d4", "filename": "gcc/ChangeLog.graphite", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492e5456785bd2e22f7eca788589f5334780a36c/gcc%2FChangeLog.graphite", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492e5456785bd2e22f7eca788589f5334780a36c/gcc%2FChangeLog.graphite", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog.graphite?ref=492e5456785bd2e22f7eca788589f5334780a36c", "patch": "@@ -1,3 +1,12 @@\n+2010-08-20  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* tree-scalar-evolution.c (chrec_contains_symbols_defined_in_loop):\n+\tDo not check for VAR_DECL, PARM_DECL, FUNCTION_DECL, LABEL_DECL,\n+\tRESULT_DECL, and FIELD_DECL.  Return false for an\n+\tSSA_NAME_IS_DEFAULT_DEF.\n+\t(compute_scalar_evolution_in_loop): Do not further analyze the\n+\tscalar evolution when no_evolution_in_loop_p returns true.\n+\n 2010-08-20  Sebastian Pop  <sebastian.pop@amd.com>\n \n \t* tree-chrec.h (evolution_function_is_affine_p): Do not check"}, {"sha": "a7e165aed3f118be26facf3c62bc33ac83796fab", "filename": "gcc/tree-scalar-evolution.c", "status": "modified", "additions": 14, "deletions": 11, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/492e5456785bd2e22f7eca788589f5334780a36c/gcc%2Ftree-scalar-evolution.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/492e5456785bd2e22f7eca788589f5334780a36c/gcc%2Ftree-scalar-evolution.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-scalar-evolution.c?ref=492e5456785bd2e22f7eca788589f5334780a36c", "patch": "@@ -385,19 +385,17 @@ chrec_contains_symbols_defined_in_loop (const_tree chrec, unsigned loop_nb)\n   if (is_gimple_min_invariant (chrec))\n     return false;\n \n-  if (TREE_CODE (chrec) == VAR_DECL\n-      || TREE_CODE (chrec) == PARM_DECL\n-      || TREE_CODE (chrec) == FUNCTION_DECL\n-      || TREE_CODE (chrec) == LABEL_DECL\n-      || TREE_CODE (chrec) == RESULT_DECL\n-      || TREE_CODE (chrec) == FIELD_DECL)\n-    return true;\n-\n   if (TREE_CODE (chrec) == SSA_NAME)\n     {\n-      gimple def = SSA_NAME_DEF_STMT (chrec);\n-      struct loop *def_loop = loop_containing_stmt (def);\n-      struct loop *loop = get_loop (loop_nb);\n+      gimple def;\n+      loop_p def_loop, loop;\n+\n+      if (SSA_NAME_IS_DEFAULT_DEF (chrec))\n+\treturn false;\n+\n+      def = SSA_NAME_DEF_STMT (chrec);\n+      def_loop = loop_containing_stmt (def);\n+      loop = get_loop (loop_nb);\n \n       if (def_loop == NULL)\n \treturn false;\n@@ -1834,13 +1832,18 @@ compute_scalar_evolution_in_loop (struct loop *wrto_loop,\n \t\t\t\t  struct loop *def_loop,\n \t\t\t\t  tree ev)\n {\n+  bool val;\n   tree res;\n+\n   if (def_loop == wrto_loop)\n     return ev;\n \n   def_loop = superloop_at_depth (def_loop, loop_depth (wrto_loop) + 1);\n   res = compute_overall_effect_of_inner_loop (def_loop, ev);\n \n+  if (no_evolution_in_loop_p (res, wrto_loop->num, &val) && val)\n+    return res;\n+\n   return analyze_scalar_evolution_1 (wrto_loop, res, chrec_not_analyzed_yet);\n }\n "}]}