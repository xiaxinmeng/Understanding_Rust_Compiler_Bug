{"sha": "1e2b90c4ac0b08279fdfe65c6fab3c49573f236c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWUyYjkwYzRhYzBiMDgyNzlmZGZlNjVjNmZhYjNjNDk1NzNmMjM2Yw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2018-03-29T19:38:41Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2018-03-29T19:38:41Z"}, "message": "PR c++/85093 - too many template args with pack expansion.\n\n\t* pt.c (coerce_template_parms): Keep pack expansion args that will\n\tneed to be empty.\n\nFrom-SVN: r258964", "tree": {"sha": "ed8fe08cf27a9873c80884ca7486e3ebbf1f733e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ed8fe08cf27a9873c80884ca7486e3ebbf1f733e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8de4a6749d16ac2663ee5a071906b8d469ad9049", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8de4a6749d16ac2663ee5a071906b8d469ad9049", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8de4a6749d16ac2663ee5a071906b8d469ad9049"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "1536c359fe8adcf45817e6cc8aa45ee288e0e150", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1e2b90c4ac0b08279fdfe65c6fab3c49573f236c", "patch": "@@ -1,3 +1,9 @@\n+2018-03-29  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/85093 - too many template args with pack expansion.\n+\t* pt.c (coerce_template_parms): Keep pack expansion args that will\n+\tneed to be empty.\n+\n 2018-03-29  Jason Merrill  <jason@redhat.com>\n \n \t* pt.c (build_non_dependent_expr): Propagate expr location."}, {"sha": "284eaf3cab66e04f6ccdf15ffa70e53f3b855828", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=1e2b90c4ac0b08279fdfe65c6fab3c49573f236c", "patch": "@@ -8497,6 +8497,22 @@ coerce_template_parms (tree parms,\n       goto bad_nargs;\n     }\n \n+  if (arg_idx < nargs)\n+    {\n+      /* We had some pack expansion arguments that will only work if the packs\n+\t are empty, but wait until instantiation time to complain.\n+\t See variadic-ttp3.C.  */\n+      int len = nparms + (nargs - arg_idx);\n+      tree args = make_tree_vec (len);\n+      int i = 0;\n+      for (; i < nparms; ++i)\n+\tTREE_VEC_ELT (args, i) = TREE_VEC_ELT (new_inner_args, i);\n+      for (; i < len; ++i, ++arg_idx)\n+\tTREE_VEC_ELT (args, i) = TREE_VEC_ELT (inner_args,\n+\t\t\t\t\t       arg_idx - pack_adjust);\n+      new_inner_args = args;\n+    }\n+\n   if (lost)\n     {\n       gcc_assert (!(complain & tf_error) || seen_error ());"}, {"sha": "42daeaa3dcb1aa9eaf4571d96960136d786f3213", "filename": "gcc/testsuite/g++.dg/cpp0x/variadic-empty1.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic-empty1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1e2b90c4ac0b08279fdfe65c6fab3c49573f236c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic-empty1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic-empty1.C?ref=1e2b90c4ac0b08279fdfe65c6fab3c49573f236c", "patch": "@@ -0,0 +1,13 @@\n+// PR c++/85093\n+// { dg-do compile { target c++11 } }\n+\n+template<class V> class A {};\n+\n+template<class V, class... G> class B {\n+  typedef A<V,G...> AB;\t\t// { dg-error \"arguments\" }\n+  AB ab;\n+};\n+\n+int main() {\n+  B<int,double> b;  \n+}"}]}