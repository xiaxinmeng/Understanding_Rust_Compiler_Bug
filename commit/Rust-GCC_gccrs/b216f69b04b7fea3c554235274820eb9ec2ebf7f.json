{"sha": "b216f69b04b7fea3c554235274820eb9ec2ebf7f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjIxNmY2OWIwNGI3ZmVhM2M1NTQyMzUyNzQ4MjBlYjllYzJlYmY3Zg==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2002-10-17T07:40:35Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2002-10-17T07:40:35Z"}, "message": "init.c (expand_default_init): Handle brace-enclosed initializers correctly.\n\n\t* init.c (expand_default_init): Handle brace-enclosed initializers\n\tcorrectly.\n\n\t* g++.dg/init/array8.C: New test.\n\nFrom-SVN: r58245", "tree": {"sha": "8e6d7857b740bd5898ac397f351e073b552192a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e6d7857b740bd5898ac397f351e073b552192a9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b216f69b04b7fea3c554235274820eb9ec2ebf7f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b216f69b04b7fea3c554235274820eb9ec2ebf7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b216f69b04b7fea3c554235274820eb9ec2ebf7f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b216f69b04b7fea3c554235274820eb9ec2ebf7f/comments", "author": null, "committer": null, "parents": [{"sha": "15e0653ea29931f005ffc72239b9e5dab4f262f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15e0653ea29931f005ffc72239b9e5dab4f262f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15e0653ea29931f005ffc72239b9e5dab4f262f7"}], "stats": {"total": 36, "additions": 26, "deletions": 10}, "files": [{"sha": "3234883303225d40f1d0ec11d762dc9dffa16cc4", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=b216f69b04b7fea3c554235274820eb9ec2ebf7f", "patch": "@@ -1,3 +1,8 @@\n+2002-10-17  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* init.c (expand_default_init): Handle brace-enclosed initializers\n+\tcorrectly.\n+\n 2002-10-16  Mark Mitchell  <mark@codesourcery.com>\n \n \t* mangle.c (write_expression): Correct handling of enumeration"}, {"sha": "a7db626785350aaa43e174da77a596a2fc72333c", "filename": "gcc/cp/init.c", "status": "modified", "additions": 5, "deletions": 10, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=b216f69b04b7fea3c554235274820eb9ec2ebf7f", "patch": "@@ -1181,17 +1181,12 @@ expand_default_init (binfo, true_exp, exp, init, flags)\n \t   to run a new constructor; and catching an exception, where we\n \t   have already built up the constructor call so we could wrap it\n \t   in an exception region.  */;\n-      else if (TREE_CODE (init) == CONSTRUCTOR)\n+      else if (TREE_CODE (init) == CONSTRUCTOR \n+\t       && TREE_HAS_CONSTRUCTOR (init))\n \t{\n-\t  if (!TYPE_HAS_CONSTRUCTOR (type))\n-\t    /* A brace-enclosed initializer has whatever type is\n-\t       required.  There's no need to convert it.  */\n-\t    ;\n-\t  else\n-\t    init = ocp_convert (type, \n-\t\t\t\tTREE_VALUE (CONSTRUCTOR_ELTS (init)),\n-\t\t\t\tCONV_IMPLICIT | CONV_FORCE_TEMP, \n-\t\t\t\tflags);\n+\t  /* A brace-enclosed initializer for an aggregate.  */\n+\t  my_friendly_assert (CP_AGGREGATE_TYPE_P (type), 20021016);\n+\t  init = digest_init (type, init, (tree *)NULL);\n \t}\n       else\n \tinit = ocp_convert (type, init, CONV_IMPLICIT|CONV_FORCE_TEMP, flags);"}, {"sha": "75bf1695f8395291c34776353ebccdbc0c9251a4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b216f69b04b7fea3c554235274820eb9ec2ebf7f", "patch": "@@ -1,3 +1,7 @@\n+2002-10-17  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* g++.dg/init/array8.C: New test.\n+\n 2002-10-17  Richard Sandiford  <rsandifo@redhat.com>\n \n \t* gcc.dg/special/mips-abi.exp: New test."}, {"sha": "5f28ca490e7167469166e580776fb519b12fd7ae", "filename": "gcc/testsuite/g++.dg/init/array8.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Farray8.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b216f69b04b7fea3c554235274820eb9ec2ebf7f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Farray8.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Farray8.C?ref=b216f69b04b7fea3c554235274820eb9ec2ebf7f", "patch": "@@ -0,0 +1,12 @@\n+struct A {\n+  A ();\n+};\n+\n+struct B {\n+  A a1;\n+  A a2;\n+};\n+\n+A a;\n+\n+struct B b[] = { { a, a }, { a, a } };"}]}