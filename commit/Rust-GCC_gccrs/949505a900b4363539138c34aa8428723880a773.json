{"sha": "949505a900b4363539138c34aa8428723880a773", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQ5NTA1YTkwMGI0MzYzNTM5MTM4YzM0YWE4NDI4NzIzODgwYTc3Mw==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2016-04-15T14:46:06Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2016-04-15T14:46:06Z"}, "message": "re PR c/70671 (Wrong column number shown for \"error: cannot take address of bit-field\")\n\n\tPR c/70671\n\t* c-typeck.c (build_unary_op): Pass location down to error and\n\twarning call.\n\n\t* gcc.dg/bitfld-22.c: New test.\n\nFrom-SVN: r235032", "tree": {"sha": "4f15149dd5627d3e757afed4ee07978cb4680f99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f15149dd5627d3e757afed4ee07978cb4680f99"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/949505a900b4363539138c34aa8428723880a773", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/949505a900b4363539138c34aa8428723880a773", "html_url": "https://github.com/Rust-GCC/gccrs/commit/949505a900b4363539138c34aa8428723880a773", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/949505a900b4363539138c34aa8428723880a773/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fab0ad9253075c67250f311462f5da6a2e2048f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fab0ad9253075c67250f311462f5da6a2e2048f9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fab0ad9253075c67250f311462f5da6a2e2048f9"}], "stats": {"total": 42, "additions": 36, "deletions": 6}, "files": [{"sha": "7257f79e0b2507abdcab7f17a1a7ede5cf0d2669", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949505a900b4363539138c34aa8428723880a773/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949505a900b4363539138c34aa8428723880a773/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=949505a900b4363539138c34aa8428723880a773", "patch": "@@ -1,3 +1,9 @@\n+2016-04-15  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/70671\n+\t* c-typeck.c (build_unary_op): Pass location down to error and\n+\twarning call.\n+\n 2016-04-15  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/70436"}, {"sha": "59a3c6153b7f3a4fe1a488d8c92a92dcca4171f3", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949505a900b4363539138c34aa8428723880a773/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949505a900b4363539138c34aa8428723880a773/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=949505a900b4363539138c34aa8428723880a773", "patch": "@@ -4436,8 +4436,8 @@ build_unary_op (location_t location,\n \tcase COMPONENT_REF:\n \t  if (DECL_C_BIT_FIELD (TREE_OPERAND (arg, 1)))\n \t    {\n-\t      error (\"cannot take address of bit-field %qD\",\n-\t\t     TREE_OPERAND (arg, 1));\n+\t      error_at (location, \"cannot take address of bit-field %qD\",\n+\t\t\tTREE_OPERAND (arg, 1));\n \t      return error_mark_node;\n \t    }\n \n@@ -4449,15 +4449,16 @@ build_unary_op (location_t location,\n \t      if (!AGGREGATE_TYPE_P (TREE_TYPE (arg))\n \t\t  && !VECTOR_TYPE_P (TREE_TYPE (arg)))\n \t\t{\n-\t\t  error (\"cannot take address of scalar with reverse storage \"\n-\t\t\t \"order\");\n+\t\t  error_at (location, \"cannot take address of scalar with \"\n+\t\t\t    \"reverse storage order\");\n \t\t  return error_mark_node;\n \t\t}\n \n \t      if (TREE_CODE (TREE_TYPE (arg)) == ARRAY_TYPE\n \t\t  && TYPE_REVERSE_STORAGE_ORDER (TREE_TYPE (arg)))\n-\t\twarning (OPT_Wscalar_storage_order, \"address of array with \"\n-\t\t\t\"reverse scalar storage order requested\");\n+\t\twarning_at (location, OPT_Wscalar_storage_order,\n+\t\t\t    \"address of array with reverse scalar storage \"\n+\t\t\t    \"order requested\");\n \t    }\n \n \tdefault:"}, {"sha": "0f2e861c5b30720bb5e2cf51ef6bf29624cd08f5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949505a900b4363539138c34aa8428723880a773/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949505a900b4363539138c34aa8428723880a773/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=949505a900b4363539138c34aa8428723880a773", "patch": "@@ -1,3 +1,8 @@\n+2016-04-15  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/70671\n+\t* gcc.dg/bitfld-22.c: New test.\n+\n 2016-04-15  Bernd Schmidt  <bschmidt@redhat.com>\n \n \t* gcc.target/i386/pr46470.c: Add -mno-red-zone to dg-options for"}, {"sha": "2fb904bce245e75ff8e81f7d6f533a5376c283c8", "filename": "gcc/testsuite/gcc.dg/bitfld-22.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/949505a900b4363539138c34aa8428723880a773/gcc%2Ftestsuite%2Fgcc.dg%2Fbitfld-22.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/949505a900b4363539138c34aa8428723880a773/gcc%2Ftestsuite%2Fgcc.dg%2Fbitfld-22.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fbitfld-22.c?ref=949505a900b4363539138c34aa8428723880a773", "patch": "@@ -0,0 +1,18 @@\n+/* PR c/70671 */\n+/* { dg-do compile } */\n+\n+extern void bar (int *);\n+\n+struct S\n+{\n+  int x:2;\n+} s, *r;\n+\n+void\n+foo (void)\n+{\n+  int *p1 = &s.x; /* { dg-error \"13:cannot take address of bit-field 'x'\" } */\n+  int *p2;\n+  p2 = &s.x; /* { dg-error \"8:cannot take address of bit-field 'x'\" } */\n+  bar (&s.x); /* { dg-error \"8:cannot take address of bit-field 'x'\" } */\n+}"}]}