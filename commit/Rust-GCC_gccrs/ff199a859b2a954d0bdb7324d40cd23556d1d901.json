{"sha": "ff199a859b2a954d0bdb7324d40cd23556d1d901", "node_id": "C_kwDOANBUbNoAKGZmMTk5YTg1OWIyYTk1NGQwYmRiNzMyNGQ0MGNkMjM1NTZkMWQ5MDE", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2022-11-16T22:38:28Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2022-11-16T22:38:28Z"}, "message": "analyzer: more test coverage for named constants\n\ngcc/testsuite/ChangeLog:\n\t* gcc.dg/analyzer/named-constants-via-command-line.c: New test.\n\t* gcc.dg/analyzer/named-constants-via-macros-3.c: New test.\n\t* gcc.dg/analyzer/named-constants-via-macros-4.c: New test.\n\t* gcc.dg/analyzer/named-constants-via-macros-empty.c: New test.\n\t* gcc.dg/analyzer/named-constants-via-macros-gc.c: New test.\n\t* gcc.dg/analyzer/named-constants-via-macros-traditional.c: New test.\n\t* gcc.dg/analyzer/named-constants-via-macros-undef.c: New test.\n\nSigned-off-by: David Malcolm <dmalcolm@redhat.com>", "tree": {"sha": "579c874ddd2060d1b99a1549efca79e1cc7dcd31", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/579c874ddd2060d1b99a1549efca79e1cc7dcd31"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ff199a859b2a954d0bdb7324d40cd23556d1d901", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff199a859b2a954d0bdb7324d40cd23556d1d901", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff199a859b2a954d0bdb7324d40cd23556d1d901", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff199a859b2a954d0bdb7324d40cd23556d1d901/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6e4962810fe5de95b807d1ac675df45a725e31a2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e4962810fe5de95b807d1ac675df45a725e31a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e4962810fe5de95b807d1ac675df45a725e31a2"}], "stats": {"total": 109, "additions": 109, "deletions": 0}, "files": [{"sha": "4a3dd16752e0790248f74760d547c15d0e1b0c72", "filename": "gcc/testsuite/gcc.dg/analyzer/named-constants-via-command-line.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-command-line.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-command-line.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-command-line.c?ref=ff199a859b2a954d0bdb7324d40cd23556d1d901", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-additional-options \"-DO_ACCMODE=42 -DO_RDONLY=0x1 -DO_WRONLY=010\" } */\n+\n+#include \"analyzer-decls.h\"\n+\n+void test_sm_fd_constants (void)\n+{\n+  __analyzer_dump_named_constant (\"O_ACCMODE\"); /* { dg-warning \"named constant 'O_ACCMODE' has value '42'\" } */\n+  __analyzer_dump_named_constant (\"O_RDONLY\"); /* { dg-warning \"named constant 'O_RDONLY' has value '1'\" } */\n+  __analyzer_dump_named_constant (\"O_WRONLY\"); /* { dg-warning \"named constant 'O_WRONLY' has value '8'\" } */\n+}"}, {"sha": "2a3f2b0070aec956e8d9dca835acaf7a1a1124f1", "filename": "gcc/testsuite/gcc.dg/analyzer/named-constants-via-macros-3.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-3.c?ref=ff199a859b2a954d0bdb7324d40cd23556d1d901", "patch": "@@ -0,0 +1,15 @@\n+#include \"analyzer-decls.h\"\n+\n+/* Various constants used by the fd state machine, as macros\n+   that can't be handled.  */\n+\n+#define O_RDONLY  (1 << 0)\n+#define O_WRONLY  (1 << 1)\n+#define O_ACCMODE (O_RDONLY | O_WRONLY)\n+\n+void test_sm_fd_constants (void)\n+{\n+  __analyzer_dump_named_constant (\"O_ACCMODE\"); /* { dg-warning \"named constant 'O_ACCMODE' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_RDONLY\"); /* { dg-warning \"named constant 'O_RDONLY' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_WRONLY\"); /* { dg-warning \"named constant 'O_WRONLY' has unknown value\" } */\n+}"}, {"sha": "16eef9640517c7c5a02aff18db223c51d000c557", "filename": "gcc/testsuite/gcc.dg/analyzer/named-constants-via-macros-4.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-4.c?ref=ff199a859b2a954d0bdb7324d40cd23556d1d901", "patch": "@@ -0,0 +1,15 @@\n+#include \"analyzer-decls.h\"\n+\n+/* Various constants used by the fd state machine, as macros\n+   that can't be handled.  */\n+\n+#define O_ACCMODE(X) 42\n+#define O_RDONLY(X)  0x1\n+#define O_WRONLY(X)  010\n+\n+void test_sm_fd_constants (void)\n+{\n+  __analyzer_dump_named_constant (\"O_ACCMODE\"); /* { dg-warning \"named constant 'O_ACCMODE' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_RDONLY\"); /* { dg-warning \"named constant 'O_RDONLY' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_WRONLY\"); /* { dg-warning \"named constant 'O_WRONLY' has unknown value\" } */\n+}"}, {"sha": "3d347e2caf5bf0586ed9d7f2a2c8e03885ac8c04", "filename": "gcc/testsuite/gcc.dg/analyzer/named-constants-via-macros-empty.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-empty.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-empty.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-empty.c?ref=ff199a859b2a954d0bdb7324d40cd23556d1d901", "patch": "@@ -0,0 +1,14 @@\n+#include \"analyzer-decls.h\"\n+\n+/* Various constants used by the fd state machine.  */\n+\n+#define O_ACCMODE\n+#define O_RDONLY\n+#define O_WRONLY\n+\n+void test_sm_fd_constants (void)\n+{\n+  __analyzer_dump_named_constant (\"O_ACCMODE\"); /* { dg-warning \"named constant 'O_ACCMODE' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_RDONLY\"); /* { dg-warning \"named constant 'O_RDONLY' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_WRONLY\"); /* { dg-warning \"named constant 'O_WRONLY' has unknown value\" } */\n+}"}, {"sha": "e7b12f325a5ce3cee19ad945ef4b4fb1c2e3ca98", "filename": "gcc/testsuite/gcc.dg/analyzer/named-constants-via-macros-gc.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-gc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-gc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-gc.c?ref=ff199a859b2a954d0bdb7324d40cd23556d1d901", "patch": "@@ -0,0 +1,21 @@\n+/* { dg-additional-options \"--param ggc-min-expand=0 --param ggc-min-heapsize=0\" } */\n+\n+#include \"analyzer-decls.h\"\n+\n+/* Various constants used by the fd state machine.  */\n+\n+#define O_ACCMODE 42\n+#define O_RDONLY  0x1\n+#define O_WRONLY  010\n+\n+void test_sm_fd_constants (void)\n+{\n+  __analyzer_dump_named_constant (\"O_ACCMODE\"); /* { dg-warning \"named constant 'O_ACCMODE' has value '42'\" } */\n+  __analyzer_dump_named_constant (\"O_RDONLY\"); /* { dg-warning \"named constant 'O_RDONLY' has value '1'\" } */\n+  __analyzer_dump_named_constant (\"O_WRONLY\"); /* { dg-warning \"named constant 'O_WRONLY' has value '8'\" } */\n+}\n+\n+void test_unknown (void)\n+{\n+  __analyzer_dump_named_constant (\"UNKNOWN\"); /* { dg-warning \"named constant 'UNKNOWN' has unknown value\" } */\n+}"}, {"sha": "64acaad6aa0add87d319d427b110fc8fbbd1c989", "filename": "gcc/testsuite/gcc.dg/analyzer/named-constants-via-macros-traditional.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-traditional.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-traditional.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-traditional.c?ref=ff199a859b2a954d0bdb7324d40cd23556d1d901", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-additional-options \"-traditional-cpp\" } */\n+\n+#include \"analyzer-decls.h\"\n+\n+/* Various constants used by the fd state machine.  */\n+\n+#define O_ACCMODE 42\n+#define O_RDONLY  0x1\n+#define O_WRONLY  010\n+\n+void test_sm_fd_constants (void)\n+{\n+  __analyzer_dump_named_constant (\"O_ACCMODE\"); /* { dg-warning \"named constant 'O_ACCMODE' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_RDONLY\"); /* { dg-warning \"named constant 'O_RDONLY' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_WRONLY\"); /* { dg-warning \"named constant 'O_WRONLY' has unknown value\" } */\n+}"}, {"sha": "46c0322319025426e4e961b2a668fa1dd55b1aab", "filename": "gcc/testsuite/gcc.dg/analyzer/named-constants-via-macros-undef.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-undef.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff199a859b2a954d0bdb7324d40cd23556d1d901/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-undef.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fnamed-constants-via-macros-undef.c?ref=ff199a859b2a954d0bdb7324d40cd23556d1d901", "patch": "@@ -0,0 +1,18 @@\n+#include \"analyzer-decls.h\"\n+\n+/* Various constants used by the fd state machine.  */\n+\n+#define O_ACCMODE 42\n+#define O_RDONLY  0x1\n+#define O_WRONLY  010\n+\n+#undef O_ACCMODE\n+#undef O_RDONLY\n+#undef O_WRONLY\n+\n+void test_sm_fd_constants (void)\n+{\n+  __analyzer_dump_named_constant (\"O_ACCMODE\"); /* { dg-warning \"named constant 'O_ACCMODE' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_RDONLY\"); /* { dg-warning \"named constant 'O_RDONLY' has unknown value\" } */\n+  __analyzer_dump_named_constant (\"O_WRONLY\"); /* { dg-warning \"named constant 'O_WRONLY' has unknown value\" } */\n+}"}]}