{"sha": "bdac4b47cbdac52c7082c02f54ed07197161cb4d", "node_id": "C_kwDOANBUbNoAKGJkYWM0YjQ3Y2JkYWM1MmM3MDgyYzAyZjU0ZWQwNzE5NzE2MWNiNGQ", "commit": {"author": {"name": "Monk Chiang", "email": "monk.chiang@sifive.com", "date": "2022-10-21T05:01:59Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2022-10-21T07:31:14Z"}, "message": "RISC-V: Add type attribute for atomic instructions.\n\ngcc/ChangeLog:\n\n\t* config/riscv/riscv.md: Add atomic type attribute.\n\t* config/riscv/sync.md: Add atomic type for atomic instructions.", "tree": {"sha": "9efad803783a1ad7316911b0e579b489b1b8507a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9efad803783a1ad7316911b0e579b489b1b8507a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bdac4b47cbdac52c7082c02f54ed07197161cb4d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdac4b47cbdac52c7082c02f54ed07197161cb4d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdac4b47cbdac52c7082c02f54ed07197161cb4d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdac4b47cbdac52c7082c02f54ed07197161cb4d/comments", "author": {"login": "monkchiang", "id": 62004175, "node_id": "MDQ6VXNlcjYyMDA0MTc1", "avatar_url": "https://avatars.githubusercontent.com/u/62004175?v=4", "gravatar_id": "", "url": "https://api.github.com/users/monkchiang", "html_url": "https://github.com/monkchiang", "followers_url": "https://api.github.com/users/monkchiang/followers", "following_url": "https://api.github.com/users/monkchiang/following{/other_user}", "gists_url": "https://api.github.com/users/monkchiang/gists{/gist_id}", "starred_url": "https://api.github.com/users/monkchiang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/monkchiang/subscriptions", "organizations_url": "https://api.github.com/users/monkchiang/orgs", "repos_url": "https://api.github.com/users/monkchiang/repos", "events_url": "https://api.github.com/users/monkchiang/events{/privacy}", "received_events_url": "https://api.github.com/users/monkchiang/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fa553ff26d96f6fecaa8f1b00649cfdc6cda5f5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa553ff26d96f6fecaa8f1b00649cfdc6cda5f5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fa553ff26d96f6fecaa8f1b00649cfdc6cda5f5a"}], "stats": {"total": 17, "additions": 11, "deletions": 6}, "files": [{"sha": "9384ced0447ba160ca0cf079311b18c8a80122c6", "filename": "gcc/config/riscv/riscv.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdac4b47cbdac52c7082c02f54ed07197161cb4d/gcc%2Fconfig%2Friscv%2Friscv.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdac4b47cbdac52c7082c02f54ed07197161cb4d/gcc%2Fconfig%2Friscv%2Friscv.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.md?ref=bdac4b47cbdac52c7082c02f54ed07197161cb4d", "patch": "@@ -317,7 +317,7 @@\n   \"unknown,branch,jump,call,load,fpload,store,fpstore,\n    mtc,mfc,const,arith,logical,shift,slt,imul,idiv,move,fmove,fadd,fmul,\n    fmadd,fdiv,fcmp,fcvt,fsqrt,multi,auipc,sfb_alu,nop,ghost,bitmanip,rotate,\n-   rdvlenb,rdvl,vsetvl,vlde,vste,vldm,vstm,vlds,vsts,\n+   atomic,rdvlenb,rdvl,vsetvl,vlde,vste,vldm,vstm,vlds,vsts,\n    vldux,vldox,vstux,vstox,vldff,vldr,vstr,\n    vialu,viwalu,vext,vicalu,vshift,vnshift,vicmp,\n    vimul,vidiv,viwmul,vimuladd,viwmuladd,vimerge,vimov,"}, {"sha": "449f275e6a2512ce8d3563999ad921fd20dcc371", "filename": "gcc/config/riscv/sync.md", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdac4b47cbdac52c7082c02f54ed07197161cb4d/gcc%2Fconfig%2Friscv%2Fsync.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdac4b47cbdac52c7082c02f54ed07197161cb4d/gcc%2Fconfig%2Friscv%2Fsync.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Fsync.md?ref=bdac4b47cbdac52c7082c02f54ed07197161cb4d", "patch": "@@ -62,7 +62,8 @@\n       UNSPEC_ATOMIC_STORE))]\n   \"TARGET_ATOMIC\"\n   \"%F2amoswap.<amo>%A2 zero,%z1,%0\"\n-  [(set (attr \"length\") (const_int 8))])\n+  [(set_attr \"type\" \"atomic\")\n+   (set (attr \"length\") (const_int 8))])\n \n (define_insn \"atomic_<atomic_optab><mode>\"\n   [(set (match_operand:GPR 0 \"memory_operand\" \"+A\")\n@@ -73,7 +74,8 @@\n \t UNSPEC_SYNC_OLD_OP))]\n   \"TARGET_ATOMIC\"\n   \"%F2amo<insn>.<amo>%A2 zero,%z1,%0\"\n-  [(set (attr \"length\") (const_int 8))])\n+  [(set_attr \"type\" \"atomic\")\n+   (set (attr \"length\") (const_int 8))])\n \n (define_insn \"atomic_fetch_<atomic_optab><mode>\"\n   [(set (match_operand:GPR 0 \"register_operand\" \"=&r\")\n@@ -86,7 +88,8 @@\n \t UNSPEC_SYNC_OLD_OP))]\n   \"TARGET_ATOMIC\"\n   \"%F3amo<insn>.<amo>%A3 %0,%z2,%1\"\n-  [(set (attr \"length\") (const_int 8))])\n+  [(set_attr \"type\" \"atomic\")\n+   (set (attr \"length\") (const_int 8))])\n \n (define_insn \"atomic_exchange<mode>\"\n   [(set (match_operand:GPR 0 \"register_operand\" \"=&r\")\n@@ -98,7 +101,8 @@\n \t(match_operand:GPR 2 \"register_operand\" \"0\"))]\n   \"TARGET_ATOMIC\"\n   \"%F3amoswap.<amo>%A3 %0,%z2,%1\"\n-  [(set (attr \"length\") (const_int 8))])\n+  [(set_attr \"type\" \"atomic\")\n+   (set (attr \"length\") (const_int 8))])\n \n (define_insn \"atomic_cas_value_strong<mode>\"\n   [(set (match_operand:GPR 0 \"register_operand\" \"=&r\")\n@@ -112,7 +116,8 @@\n    (clobber (match_scratch:GPR 6 \"=&r\"))]\n   \"TARGET_ATOMIC\"\n   \"%F5 1: lr.<amo>%A5 %0,%1; bne %0,%z2,1f; sc.<amo>%A4 %6,%z3,%1; bnez %6,1b; 1:\"\n-  [(set (attr \"length\") (const_int 20))])\n+  [(set_attr \"type\" \"atomic\")\n+   (set (attr \"length\") (const_int 20))])\n \n (define_expand \"atomic_compare_and_swap<mode>\"\n   [(match_operand:SI 0 \"register_operand\" \"\")   ;; bool output"}]}