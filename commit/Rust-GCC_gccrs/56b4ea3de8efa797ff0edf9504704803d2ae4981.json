{"sha": "56b4ea3de8efa797ff0edf9504704803d2ae4981", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTZiNGVhM2RlOGVmYTc5N2ZmMGVkZjk1MDQ3MDQ4MDNkMmFlNDk4MQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2005-09-12T04:04:03Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2005-09-12T04:04:03Z"}, "message": "decl2.c (build_anon_union_vars): Copy attributes from the base addr.\n\n        * decl2.c (build_anon_union_vars): Copy attributes from the base addr.\n        * pt.c (tsubst_decl): Substitute in DECL_VALUE_EXPR.\n\n        * g++.dg/other/error8.C: Update expected diagnostic text.\n\nFrom-SVN: r104160", "tree": {"sha": "64e5cc4d84872a31748d1d4ba6500f40fa9fbad3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/64e5cc4d84872a31748d1d4ba6500f40fa9fbad3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/56b4ea3de8efa797ff0edf9504704803d2ae4981", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56b4ea3de8efa797ff0edf9504704803d2ae4981", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56b4ea3de8efa797ff0edf9504704803d2ae4981", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56b4ea3de8efa797ff0edf9504704803d2ae4981/comments", "author": null, "committer": null, "parents": [{"sha": "f489aff87aa4c15ffe681cfcaede591c533b331e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f489aff87aa4c15ffe681cfcaede591c533b331e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f489aff87aa4c15ffe681cfcaede591c533b331e"}], "stats": {"total": 36, "additions": 27, "deletions": 9}, "files": [{"sha": "4ea174c8fe770b37378844d319e98a90fa414d82", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=56b4ea3de8efa797ff0edf9504704803d2ae4981", "patch": "@@ -1,3 +1,8 @@\n+2005-09-11  Richard Henderson  <rth@redhat.com>\n+\n+\t* decl2.c (build_anon_union_vars): Copy attributes from the base addr.\n+\t* pt.c (tsubst_decl): Substitute in DECL_VALUE_EXPR.\n+\n 2005-09-09  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n \n \t* parser.c (cp_parser_translation_unit): Simplify.  The while-block"}, {"sha": "c2a90fc5bc564c23462c3f450769805cbe2afbde", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=56b4ea3de8efa797ff0edf9504704803d2ae4981", "patch": "@@ -1101,12 +1101,18 @@ build_anon_union_vars (tree type, tree object)\n \n       if (DECL_NAME (field))\n \t{\n+\t  tree base;\n+\n \t  decl = build_decl (VAR_DECL, DECL_NAME (field), TREE_TYPE (field));\n-\t  TREE_PUBLIC (decl) = TREE_PUBLIC (object);\n-\t  TREE_STATIC (decl) = TREE_PUBLIC (object);\n-\t  DECL_EXTERNAL (decl) = DECL_EXTERNAL (object);\n+\n+\t  base = get_base_address (object);\n+\t  TREE_PUBLIC (decl) = TREE_PUBLIC (base);\n+\t  TREE_STATIC (decl) = TREE_STATIC (base);\n+\t  DECL_EXTERNAL (decl) = DECL_EXTERNAL (base);\n+\n \t  SET_DECL_VALUE_EXPR (decl, ref);\n \t  DECL_HAS_VALUE_EXPR_P (decl) = 1;\n+\n \t  decl = pushdecl (decl);\n \t}\n       else if (ANON_AGGR_TYPE_P (TREE_TYPE (field)))"}, {"sha": "85e8cb83b868f7c8cfbacd521fda3062cd6363ed", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=56b4ea3de8efa797ff0edf9504704803d2ae4981", "patch": "@@ -6674,6 +6674,13 @@ tsubst_decl (tree t, tree args, tsubst_flags_t complain)\n \t    DECL_INITIALIZED_BY_CONSTANT_EXPRESSION_P (r)\n \t      = DECL_INITIALIZED_BY_CONSTANT_EXPRESSION_P (t);\n \t    type = check_var_type (DECL_NAME (r), type);\n+\n+\t    if (DECL_HAS_VALUE_EXPR_P (t))\n+\t      {\n+\t\ttree ve = DECL_VALUE_EXPR (t);\n+\t\tve = tsubst_expr (ve, args, complain, in_decl);\n+\t        SET_DECL_VALUE_EXPR (r, ve);\n+\t      }\n \t  }\n \telse if (DECL_SELF_REFERENCE_P (t))\n \t  SET_DECL_SELF_REFERENCE_P (r);"}, {"sha": "a4b62de409943fecd1b86143efee35de50214964", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=56b4ea3de8efa797ff0edf9504704803d2ae4981", "patch": "@@ -1,3 +1,7 @@\n+2005-09-11  Richard Henderson  <rth@redhat.com>\n+\n+\t* g++.dg/other/error8.C: Update expected diagnostic text.\n+\n 2005-09-11  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR libfortran/19872"}, {"sha": "9246c2afa564339354ad548c69eeecaed6fd73da", "filename": "gcc/testsuite/g++.dg/other/error8.C", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror8.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b4ea3de8efa797ff0edf9504704803d2ae4981/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror8.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror8.C?ref=56b4ea3de8efa797ff0edf9504704803d2ae4981", "patch": "@@ -5,8 +5,8 @@\n \n void foo(void)\n {\n-  union { int alpha; int beta; }; // { dg-error \"previous declaration of 'int alpha'\" }\n-  double alpha;  // { dg-error \"redeclared\" }\n+  union { int alpha; int beta; }; // { dg-error \"previous declaration\" }\n+  double alpha;  // { dg-error \"conflicting declaration\" }\n }\n \n // This checks both the templated version, and the position of the diagnostic\n@@ -20,7 +20,3 @@ void tfoo(void)\n   }; // { dg-bogus \"\" \"misplaced position of the declaration\" { xfail *-*-* } }\n   double alpha; // { dg-error \"\" \"\" }\n }\n-\n-// The duplicated error messages are xfailed for now (tracked in the PR)\n-// { dg-bogus \"\" \"duplicate error messages\" { target *-*-* } 8 }\n-// { dg-bogus \"\" \"duplicate error messages\" { target *-*-* } 9 }"}]}