{"sha": "7b24db31a41695cfd4adcee73f5edd73ae001517", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2IyNGRiMzFhNDE2OTVjZmQ0YWRjZWU3M2Y1ZWRkNzNhZTAwMTUxNw==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-05-10T22:43:00Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-05-10T22:43:00Z"}, "message": "re PR fortran/70870 (Segmentation violation in gfc_assign_data_value)\n\n2018-05-10  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/70870\n\t* data.c (gfc_assign_data_value): Check that a data object does\n\tnot also have default initialization.\n\n2018-05-10  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/70870\n\t* gfortran.dg/pr70870_1.f90: New test.\n\nFrom-SVN: r260138", "tree": {"sha": "1a21c3b863bc802042c52c160243d7f27d3d7f5c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1a21c3b863bc802042c52c160243d7f27d3d7f5c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7b24db31a41695cfd4adcee73f5edd73ae001517", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b24db31a41695cfd4adcee73f5edd73ae001517", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b24db31a41695cfd4adcee73f5edd73ae001517", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b24db31a41695cfd4adcee73f5edd73ae001517/comments", "author": null, "committer": null, "parents": [{"sha": "b0aed64bdef6a581650576edbfbb6e6721cc9a9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0aed64bdef6a581650576edbfbb6e6721cc9a9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0aed64bdef6a581650576edbfbb6e6721cc9a9a"}], "stats": {"total": 29, "additions": 29, "deletions": 0}, "files": [{"sha": "aedcb2d96084e497c6f4ab92f375e9b9124f5bf1", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=7b24db31a41695cfd4adcee73f5edd73ae001517", "patch": "@@ -1,3 +1,9 @@\n+2018-05-10  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/70870\n+\t* data.c (gfc_assign_data_value): Check that a data object does\n+\tnot also have default initialization.\n+\n 2018-05-10  Marek Polacek  <polacek@redhat.com>\n \n \tPR fortran/85735"}, {"sha": "780a5ad9564ad69effa338ebeaabbef8f02ee34e", "filename": "gcc/fortran/data.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ffortran%2Fdata.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ffortran%2Fdata.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdata.c?ref=7b24db31a41695cfd4adcee73f5edd73ae001517", "patch": "@@ -491,6 +491,15 @@ gfc_assign_data_value (gfc_expr *lvalue, gfc_expr *rvalue, mpz_t index,\n     }\n   else\n     {\n+      if (lvalue->ts.type == BT_DERIVED\n+\t  && gfc_has_default_initializer (lvalue->ts.u.derived))\n+\t{\n+\t  gfc_error (\"Nonpointer object %qs with default initialization \"\n+\t\t     \"shall not appear in a DATA statement at %L\", \n+\t\t     symbol->name, &lvalue->where);\n+\t  return false;\n+\t}\n+\n       /* Overwriting an existing initializer is non-standard but usually only\n \t provokes a warning from other compilers.  */\n       if (init != NULL)"}, {"sha": "64014c4858544f1eed58d090f5e42f74477909ea", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7b24db31a41695cfd4adcee73f5edd73ae001517", "patch": "@@ -1,3 +1,8 @@\n+2018-05-10  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/70870\n+\t* gfortran.dg/pr70870_1.f90: New test.\n+\n 2018-05-10  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* gcc.target/i386/xgetsetbv.c: Check also variable arguments."}, {"sha": "0f9584a36dbfb2d63e9b3373a785b6b53dcdf7ce", "filename": "gcc/testsuite/gfortran.dg/pr70870_1.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr70870_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b24db31a41695cfd4adcee73f5edd73ae001517/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr70870_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr70870_1.f90?ref=7b24db31a41695cfd4adcee73f5edd73ae001517", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+! PR fortran/70870\n+! Contributed by Vittorio Zecca <zeccav at gmail dot com >\n+      type t\n+       integer :: g=0   ! default initialization\n+      end type\n+      type(t) :: v2\n+      data v2/t(2)/     ! { dg-error \"default initialization shall not\" }\n+      end"}]}