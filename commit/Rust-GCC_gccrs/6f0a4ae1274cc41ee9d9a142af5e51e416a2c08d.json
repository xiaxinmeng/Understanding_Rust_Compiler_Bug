{"sha": "6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmYwYTRhZTEyNzRjYzQxZWU5ZDlhMTQyYWY1ZTUxZTQxNmEyYzA4ZA==", "commit": {"author": {"name": "Maciej W. Rozycki", "email": "macro@linux-mips.org", "date": "2020-10-12T18:09:13Z"}, "committer": {"name": "Maciej W. Rozycki", "email": "macro@linux-mips.org", "date": "2020-10-12T18:09:13Z"}, "message": "MIPS/libphobos: Fix switchcontext.S assembly for MIPS I ISA\n\nCorrect MIPS I assembly build errors in switchcontext.S:\n\n.../libphobos/libdruntime/config/mips/switchcontext.S: Assembler messages:\n.../libphobos/libdruntime/config/mips/switchcontext.S:50: Error: opcode not supported on this processor: mips1 (mips1) `sdc1 $f20,(0*8-((6*8+4+(-6*8+4&7))))($sp)'\n\netc., due to the use of the MIPS II LDC1 and SDC1 hardware instructions\nfor FP register load and store operations.  Instead use the L.D and S.D\ngeneric assembly instructions, which are strict aliases for the LDC1 and\nSDC1 instructions respectively and produce identical machine code where\nthe assembly for the MIPS II or a higher ISA has been requested, however\nthey become assembly macros and expand to compatible sequences of LWC1\nand SWC1 hardware instructions where the assembly for the MIPS I ISA is\nin effect.\n\n\tlibphobos/\n\t* libdruntime/config/mips/switchcontext.S [__mips_hard_float]:\n\tUse L.D and S.D generic assembly instructions rather than LDC1\n\tand SDC1 MIPS II hardware instructions.", "tree": {"sha": "bc504e40cef98e66afb9b17c945f4a47ba06acc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc504e40cef98e66afb9b17c945f4a47ba06acc5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d/comments", "author": null, "committer": null, "parents": [{"sha": "46f4a397ab0907ce5786e1f0b92030a73e8b89ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46f4a397ab0907ce5786e1f0b92030a73e8b89ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46f4a397ab0907ce5786e1f0b92030a73e8b89ef"}], "stats": {"total": 24, "additions": 12, "deletions": 12}, "files": [{"sha": "2e0bd86d6641b17728b4b18f5b629bc6c68ad888", "filename": "libphobos/libdruntime/config/mips/switchcontext.S", "status": "modified", "additions": 12, "deletions": 12, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d/libphobos%2Flibdruntime%2Fconfig%2Fmips%2Fswitchcontext.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d/libphobos%2Flibdruntime%2Fconfig%2Fmips%2Fswitchcontext.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libphobos%2Flibdruntime%2Fconfig%2Fmips%2Fswitchcontext.S?ref=6f0a4ae1274cc41ee9d9a142af5e51e416a2c08d", "patch": "@@ -47,12 +47,12 @@ fiber_switchContext:\n #ifdef __mips_hard_float\n #define ALIGN8(val) (val + (-val & 7))\n #define BELOW (ALIGN8(6 * 8 + 4))\n-    sdc1 $f20, (0 * 8 - BELOW)($sp)\n-    sdc1 $f22, (1 * 8 - BELOW)($sp)\n-    sdc1 $f24, (2 * 8 - BELOW)($sp)\n-    sdc1 $f26, (3 * 8 - BELOW)($sp)\n-    sdc1 $f28, (4 * 8 - BELOW)($sp)\n-    sdc1 $f30, (5 * 8 - BELOW)($sp)\n+    s.d $f20, (0 * 8 - BELOW)($sp)\n+    s.d $f22, (1 * 8 - BELOW)($sp)\n+    s.d $f24, (2 * 8 - BELOW)($sp)\n+    s.d $f26, (3 * 8 - BELOW)($sp)\n+    s.d $f28, (4 * 8 - BELOW)($sp)\n+    s.d $f30, (5 * 8 - BELOW)($sp)\n #endif\n     sw $ra, -4($sp)\n \n@@ -72,12 +72,12 @@ fiber_switchContext:\n     move $sp, $a1\n \n #ifdef __mips_hard_float\n-    ldc1 $f20, (0 * 8 - BELOW)($sp)\n-    ldc1 $f22, (1 * 8 - BELOW)($sp)\n-    ldc1 $f24, (2 * 8 - BELOW)($sp)\n-    ldc1 $f26, (3 * 8 - BELOW)($sp)\n-    ldc1 $f28, (4 * 8 - BELOW)($sp)\n-    ldc1 $f30, (5 * 8 - BELOW)($sp)\n+    l.d $f20, (0 * 8 - BELOW)($sp)\n+    l.d $f22, (1 * 8 - BELOW)($sp)\n+    l.d $f24, (2 * 8 - BELOW)($sp)\n+    l.d $f26, (3 * 8 - BELOW)($sp)\n+    l.d $f28, (4 * 8 - BELOW)($sp)\n+    l.d $f30, (5 * 8 - BELOW)($sp)\n #endif\n     lw $ra, -4($sp)\n "}]}