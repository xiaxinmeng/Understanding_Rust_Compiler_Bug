{"sha": "847d0c088861dcfa8ae1571140f30d08a24838ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQ3ZDBjMDg4ODYxZGNmYThhZTE1NzExNDBmMzBkMDhhMjQ4MzhlYw==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2005-02-16T19:01:29Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2005-02-16T19:01:29Z"}, "message": "re PR debug/19521 (omitted stab for gcov initialization function)\n\n        PR debug/19521\n        * dbxout.c (dbxout_function_end): Take decl parameter; update callers.\n        Do nothing if debug info suppressed for this function.\n        (dbxout_begin_function): Early exit if debug info suppressed for\n        this function.\n\nCo-Authored-By: Stuart Hastings <stuart@apple.com>\n\nFrom-SVN: r95112", "tree": {"sha": "21dbfbd6c850d52064690fd08eb343402ba5de52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/21dbfbd6c850d52064690fd08eb343402ba5de52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/847d0c088861dcfa8ae1571140f30d08a24838ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/847d0c088861dcfa8ae1571140f30d08a24838ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/847d0c088861dcfa8ae1571140f30d08a24838ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/847d0c088861dcfa8ae1571140f30d08a24838ec/comments", "author": null, "committer": null, "parents": [{"sha": "019dac321407d9048889e41e400cdb6381924b77", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/019dac321407d9048889e41e400cdb6381924b77", "html_url": "https://github.com/Rust-GCC/gccrs/commit/019dac321407d9048889e41e400cdb6381924b77"}], "stats": {"total": 39, "additions": 27, "deletions": 12}, "files": [{"sha": "cff547cbe311c7e9c858230d77f9f21503cd9ad1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/847d0c088861dcfa8ae1571140f30d08a24838ec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/847d0c088861dcfa8ae1571140f30d08a24838ec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=847d0c088861dcfa8ae1571140f30d08a24838ec", "patch": "@@ -1,3 +1,12 @@\n+2005-02-16  Richard Henderson  <rth@redhat.com>\n+\t    Stuart Hastings  <stuart@apple.com>\n+\n+\tPR debug/19521\n+\t* dbxout.c (dbxout_function_end): Take decl parameter; update callers.\n+\tDo nothing if debug info suppressed for this function.\n+\t(dbxout_begin_function): Early exit if debug info suppressed for\n+\tthis function.\n+\n 2005-02-16  Kazu Hirata  <kazu@cs.umass.edu>\n \n \tPR target/20007"}, {"sha": "7a9cb60377bf194ae2b4e3ab1837983e7e2d472c", "filename": "gcc/dbxout.c", "status": "modified", "additions": 18, "deletions": 12, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/847d0c088861dcfa8ae1571140f30d08a24838ec/gcc%2Fdbxout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/847d0c088861dcfa8ae1571140f30d08a24838ec/gcc%2Fdbxout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdbxout.c?ref=847d0c088861dcfa8ae1571140f30d08a24838ec", "patch": "@@ -343,7 +343,7 @@ static void dbxout_handle_pch (unsigned);\n static void dbxout_source_line (unsigned int, const char *);\n static void dbxout_begin_prologue (unsigned int, const char *);\n static void dbxout_source_file (const char *);\n-static void dbxout_function_end (void);\n+static void dbxout_function_end (tree);\n static void dbxout_begin_function (tree);\n static void dbxout_begin_block (unsigned, unsigned);\n static void dbxout_end_block (unsigned, unsigned);\n@@ -903,10 +903,19 @@ dbxout_finish_complex_stabs (tree sym, STAB_CODE_TYPE code,\n #if defined (DBX_DEBUGGING_INFO)\n \n static void\n-dbxout_function_end (void)\n+dbxout_function_end (tree decl)\n {\n   char lscope_label_name[100];\n \n+  /* The N_FUN tag at the end of the function is a GNU extension,\n+     which may be undesirable, and is unnecessary if we do not have\n+     named sections.  */\n+  if (!use_gnu_debug_info_extensions\n+      || NO_DBX_FUNCTION_END\n+      || !targetm.have_named_sections\n+      || DECL_IGNORED_P (decl))\n+    return;\n+\n   /* The Lscope label must be emitted even if we aren't doing anything\n      else; dbxout_block needs it.  */\n   function_section (current_function_decl);\n@@ -918,14 +927,6 @@ dbxout_function_end (void)\n   targetm.asm_out.internal_label (asm_out_file, \"Lscope\", scope_labelno);\n   scope_labelno++;\n \n-  /* The N_FUN tag at the end of the function is a GNU extension,\n-     which may be undesirable, and is unnecessary if we do not have\n-     named sections.  */\n-  if (!use_gnu_debug_info_extensions\n-      || NO_DBX_FUNCTION_END\n-      || !targetm.have_named_sections)\n-    return;\n-\n   /* By convention, GCC will mark the end of a function with an N_FUN\n      symbol and an empty string.  */\n #ifdef DBX_OUTPUT_NFUN\n@@ -1296,7 +1297,7 @@ dbxout_function_decl (tree decl)\n   dbxout_begin_function (decl);\n #endif\n   dbxout_block (DECL_INITIAL (decl), 0, DECL_ARGUMENTS (decl));\n-  dbxout_function_end ();\n+  dbxout_function_end (decl);\n }\n \n #endif /* DBX_DEBUGGING_INFO  */\n@@ -3358,7 +3359,12 @@ dbxout_block (tree block, int depth, tree args)\n static void\n dbxout_begin_function (tree decl)\n {\n-  int saved_tree_used1 = TREE_USED (decl);\n+  int saved_tree_used1;\n+\n+  if (DECL_IGNORED_P (decl))\n+    return;\n+\n+  saved_tree_used1 = TREE_USED (decl);\n   TREE_USED (decl) = 1;\n   if (DECL_NAME (DECL_RESULT (decl)) != 0)\n     {"}]}