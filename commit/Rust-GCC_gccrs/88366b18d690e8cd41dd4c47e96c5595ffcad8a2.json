{"sha": "88366b18d690e8cd41dd4c47e96c5595ffcad8a2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODgzNjZiMThkNjkwZThjZDQxZGQ0YzQ3ZTk2YzU1OTVmZmNhZDhhMg==", "commit": {"author": {"name": "Maxim Kuvyrkov", "email": "maxim.kuvyrkov@linaro.org", "date": "2014-08-07T11:16:16Z"}, "committer": {"name": "Maxim Kuvyrkov", "email": "mkuvyrkov@gcc.gnu.org", "date": "2014-08-07T11:16:16Z"}, "message": "Fix INSN_TICK heuristic for SCHED_PRESSURE\n\n\t* haifa-sched.c (rank_for_schedule): Fix INSN_TICK-based heuristics.\n\nFrom-SVN: r213708", "tree": {"sha": "6d177538c49fa7953215baff16336a58aeaecf0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6d177538c49fa7953215baff16336a58aeaecf0c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88366b18d690e8cd41dd4c47e96c5595ffcad8a2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88366b18d690e8cd41dd4c47e96c5595ffcad8a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88366b18d690e8cd41dd4c47e96c5595ffcad8a2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88366b18d690e8cd41dd4c47e96c5595ffcad8a2/comments", "author": {"login": "maxim-kuvyrkov", "id": 12545699, "node_id": "MDQ6VXNlcjEyNTQ1Njk5", "avatar_url": "https://avatars.githubusercontent.com/u/12545699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxim-kuvyrkov", "html_url": "https://github.com/maxim-kuvyrkov", "followers_url": "https://api.github.com/users/maxim-kuvyrkov/followers", "following_url": "https://api.github.com/users/maxim-kuvyrkov/following{/other_user}", "gists_url": "https://api.github.com/users/maxim-kuvyrkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxim-kuvyrkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxim-kuvyrkov/subscriptions", "organizations_url": "https://api.github.com/users/maxim-kuvyrkov/orgs", "repos_url": "https://api.github.com/users/maxim-kuvyrkov/repos", "events_url": "https://api.github.com/users/maxim-kuvyrkov/events{/privacy}", "received_events_url": "https://api.github.com/users/maxim-kuvyrkov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "81051ff6698bd53d574fba3979c67558f5e2cdaf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81051ff6698bd53d574fba3979c67558f5e2cdaf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81051ff6698bd53d574fba3979c67558f5e2cdaf"}], "stats": {"total": 20, "additions": 10, "deletions": 10}, "files": [{"sha": "b6f03630890fa7f8d7b3a304f9a41f7c05978639", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88366b18d690e8cd41dd4c47e96c5595ffcad8a2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88366b18d690e8cd41dd4c47e96c5595ffcad8a2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=88366b18d690e8cd41dd4c47e96c5595ffcad8a2", "patch": "@@ -1,3 +1,7 @@\n+2014-08-07  Maxim Kuvyrkov  <maxim.kuvyrkov@linaro.org>\n+\n+\t* haifa-sched.c (rank_for_schedule): Fix INSN_TICK-based heuristics.\n+\n 2014-08-07  Ilya Tocar  <ilya.tocar@intel.com>\n \n \t* config/i386/sse.md (vec_extract_lo_<mode><mask_name>): Fix"}, {"sha": "a33186d45cba0898390bbfb904e8c2086f614c18", "filename": "gcc/haifa-sched.c", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88366b18d690e8cd41dd4c47e96c5595ffcad8a2/gcc%2Fhaifa-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88366b18d690e8cd41dd4c47e96c5595ffcad8a2/gcc%2Fhaifa-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fhaifa-sched.c?ref=88366b18d690e8cd41dd4c47e96c5595ffcad8a2", "patch": "@@ -2584,14 +2584,11 @@ rank_for_schedule (const void *x, const void *y)\n     }\n \n   if (sched_pressure != SCHED_PRESSURE_NONE\n-      && (INSN_TICK (tmp2) > clock_var || INSN_TICK (tmp) > clock_var))\n+      && (INSN_TICK (tmp2) > clock_var || INSN_TICK (tmp) > clock_var)\n+      && INSN_TICK (tmp2) != INSN_TICK (tmp))\n     {\n-      if (INSN_TICK (tmp) <= clock_var)\n-\treturn -1;\n-      else if (INSN_TICK (tmp2) <= clock_var)\n-\treturn 1;\n-      else\n-\treturn INSN_TICK (tmp) - INSN_TICK (tmp2);\n+      diff = INSN_TICK (tmp) - INSN_TICK (tmp2);\n+      return diff;\n     }\n \n   /* If we are doing backtracking in this schedule, prefer insns that\n@@ -2676,10 +2673,9 @@ rank_for_schedule (const void *x, const void *y)\n     }\n \n   /* Prefer instructions that occur earlier in the model schedule.  */\n-  if (sched_pressure == SCHED_PRESSURE_MODEL)\n+  if (sched_pressure == SCHED_PRESSURE_MODEL\n+      && INSN_BB (tmp) == target_bb && INSN_BB (tmp2) == target_bb)\n     {\n-      int diff;\n-\n       diff = model_index (tmp) - model_index (tmp2);\n       if (diff != 0)\n \treturn diff;"}]}