{"sha": "5d24b4f2dad8883db004481ebd633a0bf8d4f8e9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWQyNGI0ZjJkYWQ4ODgzZGIwMDQ0ODFlYmQ2MzNhMGJmOGQ0ZjhlOQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2019-11-06T19:36:22Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2019-11-06T19:36:22Z"}, "message": "ggc-common.c (ggc_prune_overhead_list): Do not delete surviving allocations.\n\n\t* ggc-common.c (ggc_prune_overhead_list): Do not delete surviving\n\tallocations.\n\t* mem-stats.h (mem_alloc_description<T>::release_object_overhead):\n\tDo not silently ignore summary corruptions.\n\nFrom-SVN: r277890", "tree": {"sha": "26254a0b9d22d2713949b92f16cd72737ebc5f0e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26254a0b9d22d2713949b92f16cd72737ebc5f0e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9/comments", "author": null, "committer": null, "parents": [{"sha": "0c92c8627c1cbf7cbc76d065514a564dc8f044c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c92c8627c1cbf7cbc76d065514a564dc8f044c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0c92c8627c1cbf7cbc76d065514a564dc8f044c0"}], "stats": {"total": 22, "additions": 13, "deletions": 9}, "files": [{"sha": "f451b1f91b77eada0522eb903bdb9f20d7d3da05", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5d24b4f2dad8883db004481ebd633a0bf8d4f8e9", "patch": "@@ -1,3 +1,10 @@\n+2019-11-06  Jan Hubicka  <jh@suse.cz>\n+\n+\t* ggc-common.c (ggc_prune_overhead_list): Do not delete surviving\n+\tallocations.\n+\t* mem-stats.h (mem_alloc_description<T>::release_object_overhead):\n+\tDo not silently ignore summary corruptions.\n+\n 2019-11-06  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* tree-vect-loop.c (vect_analyze_loop): Only try to vectorize"}, {"sha": "f94c39f110d3d5658828bd336b60db1ada3b06d7", "filename": "gcc/ggc-common.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9/gcc%2Fggc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9/gcc%2Fggc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fggc-common.c?ref=5d24b4f2dad8883db004481ebd633a0bf8d4f8e9", "patch": "@@ -1003,10 +1003,10 @@ ggc_prune_overhead_list (void)\n \n   for (; it != ggc_mem_desc.m_reverse_object_map->end (); ++it)\n     if (!ggc_marked_p ((*it).first))\n-      (*it).second.first->m_collected += (*it).second.second;\n-\n-  delete ggc_mem_desc.m_reverse_object_map;\n-  ggc_mem_desc.m_reverse_object_map = new map_t (13, false, false, false);\n+      {\n+        (*it).second.first->m_collected += (*it).second.second;\n+\tggc_mem_desc.m_reverse_object_map->remove ((*it).first);\n+      }\n }\n \n /* Return memory used by heap in kb, 0 if this info is not available.  */"}, {"sha": "c80be76927acb8791f53c113e48dc2fcb8b2784f", "filename": "gcc/mem-stats.h", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9/gcc%2Fmem-stats.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d24b4f2dad8883db004481ebd633a0bf8d4f8e9/gcc%2Fmem-stats.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmem-stats.h?ref=5d24b4f2dad8883db004481ebd633a0bf8d4f8e9", "patch": "@@ -535,11 +535,8 @@ inline void\n mem_alloc_description<T>::release_object_overhead (void *ptr)\n {\n   std::pair <T *, size_t> *entry = m_reverse_object_map->get (ptr);\n-  if (entry)\n-    {\n-      entry->first->release_overhead (entry->second);\n-      m_reverse_object_map->remove (ptr);\n-    }\n+  entry->first->release_overhead (entry->second);\n+  m_reverse_object_map->remove (ptr);\n }\n \n /* Unregister a memory allocation descriptor registered with"}]}