{"sha": "05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDU1MTY0MDJmOGViOGVjMjgyYTEzZmExZTM4ZDlmOWM1YjNkZDNlNQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2021-06-25T06:54:14Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2021-06-25T08:18:56Z"}, "message": "Fixup reduction info on addsub SLP pattern\n\ngcc.dg/vect/pr96854.c shows we need to copy over reduction info\nto the SLP pattern as already done for the complex patterns.\n\n2021-06-25  Richard Biener  <rguenther@suse.de>\n\n\t* tree-vect-slp-patterns.c (addsub_pattern::build): Copy\n\tSTMT_VINFO_REDUC_DEF from the original representative.", "tree": {"sha": "e2d54778795c2386bbed23042190b5bd1b8b3bc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e2d54778795c2386bbed23042190b5bd1b8b3bc5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c6c7ac0499c722ad03259013d6dc50e585a71860", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6c7ac0499c722ad03259013d6dc50e585a71860", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c6c7ac0499c722ad03259013d6dc50e585a71860"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "2671f91972d790004e5ff37e60a86cd57d0c5611", "filename": "gcc/tree-vect-slp-patterns.c", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5/gcc%2Ftree-vect-slp-patterns.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5/gcc%2Ftree-vect-slp-patterns.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-slp-patterns.c?ref=05516402f8eb8ec282a13fa1e38d9f9c5b3dd3e5", "patch": "@@ -1577,11 +1577,13 @@ addsub_pattern::build (vec_info *vinfo)\n \t\t\t       (TREE_TYPE (gimple_assign_lhs (rep->stmt))));\n   gimple_call_set_nothrow (call, true);\n   gimple_set_bb (call, gimple_bb (rep->stmt));\n-  SLP_TREE_REPRESENTATIVE (node) = vinfo->add_pattern_stmt (call, rep);\n-  STMT_VINFO_RELEVANT (SLP_TREE_REPRESENTATIVE (node)) = vect_used_in_scope;\n-  STMT_SLP_TYPE (SLP_TREE_REPRESENTATIVE (node)) = pure_slp;\n-  STMT_VINFO_VECTYPE (SLP_TREE_REPRESENTATIVE (node)) = SLP_TREE_VECTYPE (node);\n-  STMT_VINFO_SLP_VECT_ONLY_PATTERN (SLP_TREE_REPRESENTATIVE (node)) = true;\n+  stmt_vec_info new_rep = vinfo->add_pattern_stmt (call, rep);\n+  SLP_TREE_REPRESENTATIVE (node) = new_rep;\n+  STMT_VINFO_RELEVANT (new_rep) = vect_used_in_scope;\n+  STMT_SLP_TYPE (new_rep) = pure_slp;\n+  STMT_VINFO_VECTYPE (new_rep) = SLP_TREE_VECTYPE (node);\n+  STMT_VINFO_SLP_VECT_ONLY_PATTERN (new_rep) = true;\n+  STMT_VINFO_REDUC_DEF (new_rep) = STMT_VINFO_REDUC_DEF (vect_orig_stmt (rep));\n   SLP_TREE_CODE (node) = ERROR_MARK;\n   SLP_TREE_LANE_PERMUTATION (node).release ();\n "}]}