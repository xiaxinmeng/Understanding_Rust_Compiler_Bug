{"sha": "e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZThjM2ZmOTcxMmY2YTcyMmZiNGRiMjIyMGJmZTg2ZjdjNWNiZGRlOQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2006-04-23T18:14:13Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2006-04-23T18:14:13Z"}, "message": "tree-tailcall.c (pass_tail_recursion): Use gate_tail_calls too.\n\n\t* tree-tailcall.c (pass_tail_recursion): Use gate_tail_calls too.\n\ntestsuite/\n\t* gcc.dg/sibcall-7.c: New test.\n\t* gcc.dg/tree-ssa/tailrecursion-1.c: Pass -foptimize-sibling-calls.\n\t* gcc.dg/tree-ssa/tailrecursion-2.c: Likewise.\n\t* gcc.dg/tree-ssa/tailrecursion-3.c: Likewise.\n\t* gcc.dg/tree-ssa/tailrecursion-4.c: Likewise.\n\t* gcc.dg/tree-ssa/tailrecursion-5.c: Likewise.\n\nFrom-SVN: r113200", "tree": {"sha": "d1a7e6e80a5fc148f5dff78d1c5b732f515bb61a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d1a7e6e80a5fc148f5dff78d1c5b732f515bb61a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/comments", "author": null, "committer": null, "parents": [{"sha": "38a4afeecdf392267ff73a27a69f458b5d8b424c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38a4afeecdf392267ff73a27a69f458b5d8b424c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38a4afeecdf392267ff73a27a69f458b5d8b424c"}], "stats": {"total": 68, "additions": 62, "deletions": 6}, "files": [{"sha": "52485b6a60151f28e343efd2942cd13ba1abc613", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1,3 +1,7 @@\n+2006-04-23  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* tree-tailcall.c (pass_tail_recursion): Use gate_tail_calls too.\n+\n 2006-04-23  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/26534"}, {"sha": "7714bc2ee78d4e3dc298eda31f8f84f6c66bd10e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1,3 +1,12 @@\n+2006-04-23  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc.dg/sibcall-7.c: New test.\n+\t* gcc.dg/tree-ssa/tailrecursion-1.c: Pass -foptimize-sibling-calls.\n+\t* gcc.dg/tree-ssa/tailrecursion-2.c: Likewise.\n+\t* gcc.dg/tree-ssa/tailrecursion-3.c: Likewise.\n+\t* gcc.dg/tree-ssa/tailrecursion-4.c: Likewise.\n+\t* gcc.dg/tree-ssa/tailrecursion-5.c: Likewise.\n+\n 2006-04-23  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/26534"}, {"sha": "273c2c36d214d1397b08882f5981603e284303ea", "filename": "gcc/testsuite/gcc.dg/sibcall-7.c", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Fsibcall-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Fsibcall-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fsibcall-7.c?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -0,0 +1,43 @@\n+/* Simple check that tail recursive call optimization is also\n+   controlled by -foptimize-sibling-calls.\n+\n+   Copyright (C) 2006 Free Software Foundation Inc.\n+   Original test by Hans-Peter Nilsson  <hp@bitrange.com>  */\n+\n+/* { dg-do run } */\n+/* { dg-options \"-O2 -fno-optimize-sibling-calls\" } */\n+\n+\n+extern void abort (void);\n+\n+extern void recurser_void (int);\n+extern void track (int);\n+\n+int main (void)\n+{\n+  recurser_void (0);\n+  return 0;\n+}\n+\n+void recurser_void (int n)\n+{\n+  if (n == 0 || n == 7)\n+    track (n);\n+\n+  if (n == 10)\n+    return;\n+\n+  recurser_void (n + 1);\n+}\n+\n+void *trackpoint;\n+\n+void track (int n)\n+{\n+  char stackpos[1];\n+\n+  if (n == 0)\n+    trackpoint = stackpos;\n+  else if (n != 7 || trackpoint == stackpos)\n+    abort ();\n+}"}, {"sha": "8802bc8bc69fa5f9d1b1f8758be41d6f612b32cf", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailrecursion-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-1.c?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O1 -fdump-tree-tailr-details\" } */\n+/* { dg-options \"-O1 -foptimize-sibling-calls -fdump-tree-tailr-details\" } */\n int\n t(int a)\n {"}, {"sha": "9fe3af9855ad202d8a60cbd6170aee194ebfc321", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailrecursion-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-2.c?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O1 -fdump-tree-tailr-details\" } */\n+/* { dg-options \"-O1 -foptimize-sibling-calls -fdump-tree-tailr-details\" } */\n int\n t(char *a)\n {"}, {"sha": "ca727df391d45f4541928bb5b4f8d51de1d3c932", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailrecursion-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-3.c?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O1 -fdump-tree-tailr-details\" } */\n+/* { dg-options \"-O1 -foptimize-sibling-calls -fdump-tree-tailr-details\" } */\n int\n t(int a)\n {"}, {"sha": "bb43d76aca9035d1be00a72b4ac10395db2a21a8", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailrecursion-4.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-4.c?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O1 -fdump-tree-tailr-details\" } */\n+/* { dg-options \"-O1 -foptimize-sibling-calls -fdump-tree-tailr-details\" } */\n int\n t(int a)\n {"}, {"sha": "53a2cdb15e3647b604178731c489749bd5f0882f", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailrecursion-5.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailrecursion-5.c?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do run } */\n-/* { dg-options \"-O1 -fdump-tree-optimized\" } */\n+/* { dg-options \"-O1 -foptimize-sibling-calls -fdump-tree-optimized\" } */\n \n extern void abort (void);\n extern void exit (int);"}, {"sha": "fb9948e672d8c5a6ed2a45535589253f95610fee", "filename": "gcc/tree-tailcall.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftree-tailcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9/gcc%2Ftree-tailcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-tailcall.c?ref=e8c3ff9712f6a722fb4db2220bfe86f7c5cbdde9", "patch": "@@ -1017,7 +1017,7 @@ execute_tail_calls (void)\n struct tree_opt_pass pass_tail_recursion = \n {\n   \"tailr\",\t\t\t\t/* name */\n-  NULL,\t\t\t\t\t/* gate */\n+  gate_tail_calls,\t\t\t/* gate */\n   execute_tail_recursion,\t\t/* execute */\n   NULL,\t\t\t\t\t/* sub */\n   NULL,\t\t\t\t\t/* next */"}]}