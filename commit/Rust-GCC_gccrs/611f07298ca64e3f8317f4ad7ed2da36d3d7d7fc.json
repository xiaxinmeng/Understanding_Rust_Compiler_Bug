{"sha": "611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjExZjA3Mjk4Y2E2NGUzZjgzMTdmNGFkN2VkMmRhMzZkM2Q3ZDdmYw==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@bigpond.net.au", "date": "2003-03-25T23:23:23Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2003-03-25T23:23:23Z"}, "message": "c-incpath.c (add_standard_paths): Add both \"translated\" and non-translated header paths.\n\n\t* c-incpath.c (add_standard_paths): Add both \"translated\" and\n\tnon-translated header paths.\n\nFrom-SVN: r64872", "tree": {"sha": "94d2a6fe6464db5a0f0fc7b4f2eb92e669194577", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/94d2a6fe6464db5a0f0fc7b4f2eb92e669194577"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc/comments", "author": null, "committer": null, "parents": [{"sha": "e4e7d312cd684d267e661faa08db332ddf347856", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4e7d312cd684d267e661faa08db332ddf347856", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4e7d312cd684d267e661faa08db332ddf347856"}], "stats": {"total": 36, "additions": 28, "deletions": 8}, "files": [{"sha": "22da035348978540be8e7bff5c7cea22e5f17d9d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc", "patch": "@@ -1,3 +1,8 @@\n+2003-03-26  Alan Modra  <amodra@bigpond.net.au>\n+\n+\t* c-incpath.c (add_standard_paths): Add both \"translated\" and\n+\tnon-translated header paths.\n+\n 2003-03-25  Loren James Rittle  <ljrittle@acm.org>\n \n \t* doc/install.texi (*-*-freebsd*): Update with known status."}, {"sha": "abd738c027e0f11716190241ad705d81108bbce6", "filename": "gcc/c-incpath.c", "status": "modified", "additions": 23, "deletions": 8, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc/gcc%2Fc-incpath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc/gcc%2Fc-incpath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-incpath.c?ref=611f07298ca64e3f8317f4ad7ed2da36d3d7d7fc", "patch": "@@ -127,10 +127,30 @@ add_standard_paths (sysroot, iprefix, cxx_stdinc)\n      int cxx_stdinc;\n {\n   const struct default_include *p;\n-  size_t len = 0;\n+  size_t len;\n \n-  if (iprefix)\n-    len = cpp_GCC_INCLUDE_DIR_len;\n+  if (iprefix && (len = cpp_GCC_INCLUDE_DIR_len) != 0)\n+    {\n+      /* Look for directories that start with the standard prefix.\n+\t \"Translate\" them, ie. replace /usr/local/lib/gcc... with\n+\t IPREFIX and search them first.  */\n+      for (p = cpp_include_defaults; p->fname; p++)\n+\t{\n+\t  if (!p->cplusplus || cxx_stdinc)\n+\t    {\n+\t      /* Should we be translating sysrooted dirs too?  Assume\n+\t\t that iprefix and sysroot are mutually exclusive, for\n+\t\t now.  */\n+\t      if (sysroot && p->add_sysroot)\n+\t\tcontinue;\n+\t      if (!strncmp (p->fname, cpp_GCC_INCLUDE_DIR, len))\n+\t\t{\n+\t\t  char *str = concat (iprefix, p->fname + len, NULL);\n+\t\t  add_path (str, SYSTEM, p->cxx_aware);\n+\t\t}\n+\t    }\n+\t}\n+    }\n \n   for (p = cpp_include_defaults; p->fname; p++)\n     {\n@@ -141,11 +161,6 @@ add_standard_paths (sysroot, iprefix, cxx_stdinc)\n \t  /* Should this directory start with the sysroot?  */\n \t  if (sysroot && p->add_sysroot)\n \t    str = concat (sysroot, p->fname, NULL);\n-\t  /* Does this directory start with the prefix?  If so, search\n-\t     \"translated\" versions of GNU directories.  These have\n-\t     /usr/local/lib/gcc... replaced by iprefix.  */\n-\t  else if (len && !strncmp (p->fname, cpp_GCC_INCLUDE_DIR, len))\n-\t    str = concat (iprefix, p->fname + len, NULL);\n \t  else\n \t    str = update_path (p->fname, p->component);\n "}]}