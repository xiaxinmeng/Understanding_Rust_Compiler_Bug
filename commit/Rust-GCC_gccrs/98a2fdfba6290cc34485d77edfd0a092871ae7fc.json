{"sha": "98a2fdfba6290cc34485d77edfd0a092871ae7fc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OThhMmZkZmJhNjI5MGNjMzQ0ODVkNzdlZGZkMGEwOTI4NzFhZTdmYw==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2014-04-15T14:04:06Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2014-04-15T14:04:06Z"}, "message": "re PR rtl-optimization/60663 (Errors out on valid inline asm)\n\n\n\tPR rtl-optimization/60663\n\t* config/arm/arm.c (arm_new_rtx_costs): Improve ASM_OPERANDS case,\n\tavoid 0 cost.\n\nFrom-SVN: r209419", "tree": {"sha": "652dc50b2c332768e18edd452496d53671bc6ed6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/652dc50b2c332768e18edd452496d53671bc6ed6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98a2fdfba6290cc34485d77edfd0a092871ae7fc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98a2fdfba6290cc34485d77edfd0a092871ae7fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98a2fdfba6290cc34485d77edfd0a092871ae7fc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98a2fdfba6290cc34485d77edfd0a092871ae7fc/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9ffc6d0bc2a2c50047ef25871e290f75a45bd231", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ffc6d0bc2a2c50047ef25871e290f75a45bd231", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ffc6d0bc2a2c50047ef25871e290f75a45bd231"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "cd6adc4efe6121c6dbd86664f7b1e41d007fdb23", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98a2fdfba6290cc34485d77edfd0a092871ae7fc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98a2fdfba6290cc34485d77edfd0a092871ae7fc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=98a2fdfba6290cc34485d77edfd0a092871ae7fc", "patch": "@@ -1,3 +1,9 @@\n+2014-04-15  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR rtl-optimization/60663\n+\t* config/arm/arm.c (arm_new_rtx_costs): Improve ASM_OPERANDS case,\n+\tavoid 0 cost.\n+\n 2014-04-15  Richard Biener  <rguenther@suse.de>\n \n \t* lto-streamer.h (LTO_major_version): Bump to 4."}, {"sha": "773c353ba0996cd4601aecf743f4b4306526ee9b", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98a2fdfba6290cc34485d77edfd0a092871ae7fc/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98a2fdfba6290cc34485d77edfd0a092871ae7fc/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=98a2fdfba6290cc34485d77edfd0a092871ae7fc", "patch": "@@ -10670,10 +10670,16 @@ arm_new_rtx_costs (rtx x, enum rtx_code code, enum rtx_code outer_code,\n       return true;\n \n     case ASM_OPERANDS:\n-      /* Just a guess.  Cost one insn per input.  */\n-      *cost = COSTS_N_INSNS (ASM_OPERANDS_INPUT_LENGTH (x));\n-      return true;\n+      {\n+      /* Just a guess.  Guess number of instructions in the asm\n+         plus one insn per input.  Always a minimum of COSTS_N_INSNS (1)\n+         though (see PR60663).  */\n+        int asm_length = MAX (1, asm_str_count (ASM_OPERANDS_TEMPLATE (x)));\n+        int num_operands = ASM_OPERANDS_INPUT_LENGTH (x);\n \n+        *cost = COSTS_N_INSNS (asm_length + num_operands);\n+        return true;\n+      }\n     default:\n       if (mode != VOIDmode)\n \t*cost = COSTS_N_INSNS (ARM_NUM_REGS (mode));"}]}