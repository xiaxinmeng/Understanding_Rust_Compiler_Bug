{"sha": "1a14348afefc62313e38156fde768744378f9ebf", "node_id": "C_kwDOANBUbNoAKDFhMTQzNDhhZmVmYzYyMzEzZTM4MTU2ZmRlNzY4NzQ0Mzc4ZjllYmY", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2022-03-17T13:15:45Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-03-17T13:15:45Z"}, "message": "Merge #1035\n\n1035: Handle -fsyntax-only r=CohenArthur a=CohenArthur\n\nHandle the -fsyntax-only properly from the rust frontend. This flag\r\nallows checking for syntax and stopping after that, skipping further\r\npasses of the pipeline.\r\nThe flag was accepted by the frontend, but was not used anywhere.\n\nCo-authored-by: Arthur Cohen <arthur.cohen@embecosm.com>", "tree": {"sha": "75b49c17766404d0bda46c54d3df337e1449fd75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/75b49c17766404d0bda46c54d3df337e1449fd75"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a14348afefc62313e38156fde768744378f9ebf", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiMzSBCRBK7hj4Ov3rIwAAnt4IAAaOMTiKhDFGPVkV5u7lo1VV\nk27dFnkAMvTa+8lICnEB329qctHdgImx2FbNyVqkklg/WZ/WVLwg85smkdIGw6ch\n909NcZ1bInr0snqoohfGqqr4NAuj7Pn5l19xPrd7M36mqTSFWD9gKmDreg5HW3sV\nPvj2aUEszaqo1kLCcWD4xAymOdaaDU5vAv0vbQOs21EZf+O2+c6TL8DpgDIXWp8s\nkXJ5MJDoPrqA209LtlLGTarQ6EOD7qDruo79br7U55FayFW3ZzsnvdnMGUlivKa8\nMMhGG2ot+kT/3dTfYx6wdkNXchfWehDj3BKx09F5rSWSe4kqLTM9NokOh5M7f8o=\n=o9MI\n-----END PGP SIGNATURE-----\n", "payload": "tree 75b49c17766404d0bda46c54d3df337e1449fd75\nparent b7baee87956913a4debd7e4bad29ddc9b9645325\nparent e30d07de5c89e0f8a4d8304846e21f8e775c9f79\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1647522945 +0000\ncommitter GitHub <noreply@github.com> 1647522945 +0000\n\nMerge #1035\n\n1035: Handle -fsyntax-only r=CohenArthur a=CohenArthur\n\nHandle the -fsyntax-only properly from the rust frontend. This flag\r\nallows checking for syntax and stopping after that, skipping further\r\npasses of the pipeline.\r\nThe flag was accepted by the frontend, but was not used anywhere.\n\nCo-authored-by: Arthur Cohen <arthur.cohen@embecosm.com>\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a14348afefc62313e38156fde768744378f9ebf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a14348afefc62313e38156fde768744378f9ebf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a14348afefc62313e38156fde768744378f9ebf/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b7baee87956913a4debd7e4bad29ddc9b9645325", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7baee87956913a4debd7e4bad29ddc9b9645325", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7baee87956913a4debd7e4bad29ddc9b9645325"}, {"sha": "e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30d07de5c89e0f8a4d8304846e21f8e775c9f79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e30d07de5c89e0f8a4d8304846e21f8e775c9f79"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "96d94b2fbb2f0939a9ed4c1c44a3a201e94deb80", "filename": "gcc/rust/rust-session-manager.cc", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a14348afefc62313e38156fde768744378f9ebf/gcc%2Frust%2Frust-session-manager.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a14348afefc62313e38156fde768744378f9ebf/gcc%2Frust%2Frust-session-manager.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Frust-session-manager.cc?ref=1a14348afefc62313e38156fde768744378f9ebf", "patch": "@@ -542,6 +542,11 @@ Session::parse_file (const char *filename)\n \n   rust_debug (\"\\033[0;31mSUCCESSFULLY PARSED CRATE \\033[0m\");\n \n+  // If -fsyntax-only was passed, we can just skip the remaining passes.\n+  // Parsing errors are already emitted in `parse_crate()`\n+  if (flag_syntax_only)\n+    return;\n+\n   // register plugins pipeline stage\n   register_plugins (parsed_crate);\n   rust_debug (\"\\033[0;31mSUCCESSFULLY REGISTERED PLUGINS \\033[0m\");"}, {"sha": "cd84907bf842439b652f8479e4aa6a3c7456b0e8", "filename": "gcc/testsuite/rust/compile/syntax-only.rs", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a14348afefc62313e38156fde768744378f9ebf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fsyntax-only.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a14348afefc62313e38156fde768744378f9ebf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fsyntax-only.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fsyntax-only.rs?ref=1a14348afefc62313e38156fde768744378f9ebf", "patch": "@@ -0,0 +1,6 @@\n+// { dg-additional-options \"-fsyntax-only\" }\n+\n+fn main() {\n+    let mut a = 15;\n+    a = true;\n+}"}]}