{"sha": "67a6e8167985001be8a50485a8cd8a0d0355a363", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjdhNmU4MTY3OTg1MDAxYmU4YTUwNDg1YThjZDhhMGQwMzU1YTM2Mw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2009-07-25T03:57:20Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2009-07-25T03:57:20Z"}, "message": "Core issue 901\n\n\tCore issue 901\n\t* libsupc++/vec.cc (__cxa_vec_new2, __cxa_vec_new3): Handle NULL\n\tdealloc.\n\t* call.c (build_op_delete_call): If this is for a new-expression\n\tand the op delete is deleted, do nothing.\n\nFrom-SVN: r150073", "tree": {"sha": "a1321c242570af678195bae067b31b4c26c4980e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a1321c242570af678195bae067b31b4c26c4980e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/67a6e8167985001be8a50485a8cd8a0d0355a363", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67a6e8167985001be8a50485a8cd8a0d0355a363", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67a6e8167985001be8a50485a8cd8a0d0355a363", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67a6e8167985001be8a50485a8cd8a0d0355a363/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "05b5c4e8742e5deba247f5a68eec43b13e88ce8c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05b5c4e8742e5deba247f5a68eec43b13e88ce8c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05b5c4e8742e5deba247f5a68eec43b13e88ce8c"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "2ee951c907ddad10144bbf0ecb1b993510e6175c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=67a6e8167985001be8a50485a8cd8a0d0355a363", "patch": "@@ -1,5 +1,9 @@\n 2009-07-24  Jason Merrill  <jason@redhat.com>\n \n+\tCore issue 901\n+\t* call.c (build_op_delete_call): If this is for a new-expression\n+\tand the op delete is deleted, do nothing.\n+\n \tCore issue 702\n \t* call.c (compare_ics): Give list-initialization of std::init_list\n \tpriority over conversion to scalar, too."}, {"sha": "0254ecb8af9be6a0fbb460b13b6912abdc1db966", "filename": "gcc/cp/call.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=67a6e8167985001be8a50485a8cd8a0d0355a363", "patch": "@@ -4595,6 +4595,10 @@ build_op_delete_call (enum tree_code code, tree addr, tree size,\n       if (DECL_CLASS_SCOPE_P (fn))\n \tperform_or_defer_access_check (TYPE_BINFO (type), fn, fn);\n \n+      /* Core issue 901: It's ok to new a type with deleted delete.  */\n+      if (DECL_DELETED_FN (fn) && alloc_fn)\n+\treturn NULL_TREE;\n+\n       if (placement)\n \t{\n \t  /* The placement args might not be suitable for overload"}, {"sha": "00dbba780f65136bc86b781f1e2ac8f2e0ff6fba", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=67a6e8167985001be8a50485a8cd8a0d0355a363", "patch": "@@ -1,5 +1,7 @@\n 2009-07-24  Jason Merrill  <jason@redhat.com>\n \n+\t* g++.dg/cpp0x/defaulted11.C: New.\n+\n \t* g++.dg/cpp0x/initlist23.C: New.\n \n 2009-07-24  Janus Weil  <janus@gcc.gnu.org>"}, {"sha": "b9bed7e0037ba929c596972172912062270221cf", "filename": "gcc/testsuite/g++.dg/cpp0x/defaulted11.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdefaulted11.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67a6e8167985001be8a50485a8cd8a0d0355a363/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdefaulted11.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fdefaulted11.C?ref=67a6e8167985001be8a50485a8cd8a0d0355a363", "patch": "@@ -0,0 +1,15 @@\n+// Core issue 901\n+// { dg-options \"-std=c++0x\" }\n+\n+struct A\n+{\n+  A(); ~A();\n+  void operator delete (void *) = delete;\n+  void operator delete[] (void *) = delete;\n+};\n+\n+int main()\n+{\n+  A* ap = new A;\n+  ap = new A[2];\n+}"}, {"sha": "21f67c5d670f8f566c1d06aaa5dd26033920f108", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67a6e8167985001be8a50485a8cd8a0d0355a363/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67a6e8167985001be8a50485a8cd8a0d0355a363/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=67a6e8167985001be8a50485a8cd8a0d0355a363", "patch": "@@ -1,3 +1,9 @@\n+2009-07-24  Jason Merrill  <jason@redhat.com>\n+\n+\tCore issue 901\n+\t* libsupc++/vec.cc (__cxa_vec_new2, __cxa_vec_new3): Handle NULL\n+\tdealloc.\n+\n 2009-07-24  Joseph Myers  <joseph@codesourcery.com>\n \n \t* include/c_global/cwchar (swprintf, vswprintf): Do not use if"}, {"sha": "e44a023049ed52ae94508fdfaa605550f183877f", "filename": "libstdc++-v3/libsupc++/vec.cc", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67a6e8167985001be8a50485a8cd8a0d0355a363/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fvec.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67a6e8167985001be8a50485a8cd8a0d0355a363/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fvec.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Fvec.cc?ref=67a6e8167985001be8a50485a8cd8a0d0355a363", "patch": "@@ -104,7 +104,10 @@ namespace __cxxabiv1\n       {\n \t{\n \t  uncatch_exception ue;\n-\t  dealloc(base - padding_size);\n+\t  // Core issue 901 will probably be resolved such that a\n+\t  // deleted operator delete means not freeing memory here.\n+\t  if (dealloc)\n+\t    dealloc(base - padding_size);\n \t}\n \t__throw_exception_again;\n       }\n@@ -142,7 +145,8 @@ namespace __cxxabiv1\n       {\n \t{\n \t  uncatch_exception ue;\n-\t  dealloc(base - padding_size, size);\n+\t  if (dealloc)\n+\t    dealloc(base - padding_size, size);\n \t}\n \t__throw_exception_again;\n       }"}]}