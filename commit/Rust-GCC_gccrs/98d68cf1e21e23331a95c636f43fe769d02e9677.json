{"sha": "98d68cf1e21e23331a95c636f43fe769d02e9677", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OThkNjhjZjFlMjFlMjMzMzFhOTVjNjM2ZjQzZmU3NjlkMDJlOTY3Nw==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2007-08-31T10:24:29Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-08-31T10:24:29Z"}, "message": "tempdir.adb: On VMS, take into account GNUTMPDIR before TMPDIR\n\n2007-08-31  Vincent Celier  <celier@adacore.com>\n\n\t* tempdir.adb: On VMS, take into account GNUTMPDIR before TMPDIR\n\nFrom-SVN: r127982", "tree": {"sha": "57d50e33aa789538ff490e3ed306e768cc9977b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/57d50e33aa789538ff490e3ed306e768cc9977b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98d68cf1e21e23331a95c636f43fe769d02e9677", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98d68cf1e21e23331a95c636f43fe769d02e9677", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98d68cf1e21e23331a95c636f43fe769d02e9677", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98d68cf1e21e23331a95c636f43fe769d02e9677/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f33abf26a8dc2dc946e9ad7c5e4496ecfe494766", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f33abf26a8dc2dc946e9ad7c5e4496ecfe494766", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f33abf26a8dc2dc946e9ad7c5e4496ecfe494766"}], "stats": {"total": 29, "additions": 23, "deletions": 6}, "files": [{"sha": "cc13a4c164368bdd2a64630257d83e53292e4f17", "filename": "gcc/ada/tempdir.adb", "status": "modified", "additions": 23, "deletions": 6, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98d68cf1e21e23331a95c636f43fe769d02e9677/gcc%2Fada%2Ftempdir.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98d68cf1e21e23331a95c636f43fe769d02e9677/gcc%2Fada%2Ftempdir.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ftempdir.adb?ref=98d68cf1e21e23331a95c636f43fe769d02e9677", "patch": "@@ -26,16 +26,18 @@\n \n with GNAT.Directory_Operations; use GNAT.Directory_Operations;\n \n-with Opt;    use Opt;\n-with Output; use Output;\n+with Hostparm; use Hostparm;\n+with Opt;      use Opt;\n+with Output;   use Output;\n \n package body Tempdir is\n \n    Tmpdir_Needs_To_Be_Displayed : Boolean := True;\n \n-   Tmpdir   : constant String := \"TMPDIR\";\n-   No_Dir   : aliased String  := \"\";\n-   Temp_Dir : String_Access   := No_Dir'Access;\n+   Tmpdir    : constant String := \"TMPDIR\";\n+   Gnutmpdir : constant String := \"GNUTMPDIR\";\n+   No_Dir    : aliased String  := \"\";\n+   Temp_Dir  : String_Access   := No_Dir'Access;\n \n    ----------------------\n    -- Create_Temp_File --\n@@ -114,9 +116,24 @@ package body Tempdir is\n \n begin\n    declare\n-      Dir : String_Access := Getenv (Tmpdir);\n+      Dir : String_Access;\n \n    begin\n+      --  On VMS, if GNUTMPDIR is defined, use it\n+\n+      if OpenVMS then\n+         Dir := Getenv (Gnutmpdir);\n+\n+         --  Otherwise, if GNUTMPDIR is not defined, try TMPDIR\n+\n+         if Dir'Length = 0 then\n+            Dir := Getenv (Tmpdir);\n+         end if;\n+\n+      else\n+         Dir := Getenv (Tmpdir);\n+      end if;\n+\n       if Dir'Length > 0 and then\n         Is_Absolute_Path (Dir.all) and then\n         Is_Directory (Dir.all)"}]}