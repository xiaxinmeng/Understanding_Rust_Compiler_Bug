{"sha": "3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2MxOWU1ZTFhMThmYTU5ZGQ2OWMxYTIxZTE3NjE5ZjYxNjZjOTYzZQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-04-07T20:29:13Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-04-07T20:29:13Z"}, "message": "re PR fortran/31257 (ICE in gfc_conv_expr_descriptor)\n\n2007-04-07  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/31257\n\t* intrinsic.c (add_functions): Add ref. to gfc_resolve_achar.\n\t* intrinsic.h : Add prototype for gfc_resolve_achar.\n\t* iresolve.c (gfc_resolve_achar): New function.\n\n2007-04-07  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/31257\n\t* gfortran.dg/achar_4.f90: New test.\n\nFrom-SVN: r123646", "tree": {"sha": "f05c09f61a0b2a7d5ced0831c3bbf0a01f6fb8d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f05c09f61a0b2a7d5ced0831c3bbf0a01f6fb8d3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/comments", "author": null, "committer": null, "parents": [{"sha": "145bdc2cbc1237d3f3ab25f45d18f1fce7ecb2b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/145bdc2cbc1237d3f3ab25f45d18f1fce7ecb2b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/145bdc2cbc1237d3f3ab25f45d18f1fce7ecb2b5"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "ce7b74437c377cf8197f4ec14779b55d75760a37", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "patch": "@@ -1,3 +1,10 @@\n+2007-04-07  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/31257\n+\t* intrinsic.c (add_functions): Add ref. to gfc_resolve_achar.\n+\t* intrinsic.h : Add prototype for gfc_resolve_achar.\n+\t* iresolve.c (gfc_resolve_achar): New function.\n+\n 2007-04-07  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/30880"}, {"sha": "2210dc27cc9cbb3edf53f07e7e2b91e93977b4cd", "filename": "gcc/fortran/intrinsic.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2Fintrinsic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2Fintrinsic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fintrinsic.c?ref=3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "patch": "@@ -951,7 +951,7 @@ add_functions (void)\n   make_generic (\"access\", GFC_ISYM_ACCESS, GFC_STD_GNU);\n \n   add_sym_1 (\"achar\", ELEMENTAL, ACTUAL_NO, BT_CHARACTER, dc, GFC_STD_F95,\n-\t     gfc_check_achar, gfc_simplify_achar, NULL,\n+\t     gfc_check_achar, gfc_simplify_achar, gfc_resolve_achar,\n \t     i, BT_INTEGER, di, REQUIRED);\n \n   make_generic (\"achar\", GFC_ISYM_ACHAR, GFC_STD_F95);"}, {"sha": "46d49f7e7442e91e24216d32f7c561dc8fb82cb9", "filename": "gcc/fortran/intrinsic.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2Fintrinsic.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2Fintrinsic.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fintrinsic.h?ref=3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "patch": "@@ -301,6 +301,7 @@ gfc_expr *gfc_convert_constant (gfc_expr *, bt, int);\n /* Resolution functions.  */\n void gfc_resolve_abs (gfc_expr *, gfc_expr *);\n void gfc_resolve_access (gfc_expr *, gfc_expr *, gfc_expr *);\n+void gfc_resolve_achar (gfc_expr *, gfc_expr *);\n void gfc_resolve_acos (gfc_expr *, gfc_expr *);\n void gfc_resolve_acosh (gfc_expr *, gfc_expr *);\n void gfc_resolve_aimag (gfc_expr *, gfc_expr *);"}, {"sha": "14ed3e32e8dccfa91fbb6acfdd071f0ccc6f413e", "filename": "gcc/fortran/iresolve.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2Firesolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ffortran%2Firesolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Firesolve.c?ref=3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "patch": "@@ -98,6 +98,22 @@ gfc_resolve_access (gfc_expr *f, gfc_expr *name ATTRIBUTE_UNUSED,\n }\n \n \n+void\n+gfc_resolve_achar (gfc_expr *f, gfc_expr *x)\n+{\n+  \n+  f->ts.type = BT_CHARACTER;\n+  f->ts.kind = gfc_default_character_kind;\n+  f->ts.cl = gfc_get_charlen ();\n+  f->ts.cl->next = gfc_current_ns->cl_list;\n+  gfc_current_ns->cl_list = f->ts.cl;\n+  f->ts.cl->length = gfc_int_expr (1);\n+\n+  f->value.function.name\n+    = gfc_get_string (\"__achar_%c%d\", gfc_type_letter (x->ts.type), x->ts.kind);\n+}\n+\n+\n void\n gfc_resolve_acos (gfc_expr *f, gfc_expr *x)\n {"}, {"sha": "ace71ca69335ebdc5373ed3f1849e18d7fad3ce6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "patch": "@@ -1,3 +1,8 @@\n+2007-04-07  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/31257\n+\t* gfortran.dg/achar_4.f90: New test.\n+\n 2007-04-07  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/30880"}, {"sha": "3bbc2af5cb5e6514ce8723736f88304127bf68fc", "filename": "gcc/testsuite/gfortran.dg/achar_4.f90", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ftestsuite%2Fgfortran.dg%2Fachar_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3c19e5e1a18fa59dd69c1a21e17619f6166c963e/gcc%2Ftestsuite%2Fgfortran.dg%2Fachar_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fachar_4.f90?ref=3c19e5e1a18fa59dd69c1a21e17619f6166c963e", "patch": "@@ -0,0 +1,20 @@\n+! { dg-do run }\n+! Tests the fix for PR31257, in which achar caused an ICE because it had no\n+! charlen.\n+!\n+! The code comes from http://www.star.le.ac.uk/~cgp/fortran.html (by Clive Page)\n+! Reported by Thomas Koenig <tkoenig@gcc.gnu.org>\n+!\n+  if (any (Up (\"AbCdEfGhIjKlM\") .ne. (/\"ABCDEFGHIJKLM\"/))) call abort ()\n+contains\n+  Character (len=20) Function Up (string)\n+    Character(len=*) string\n+    Up =                                                                &\n+     transfer(merge(achar(iachar(transfer(string,\"x\",len(string)))-     &\n+     (ichar('a')-ichar('A')) ),                                         &\n+     transfer(string,\"x\",len(string)) ,                                 &\n+     transfer(string,\"x\",len(string)) >= \"a\" .and.                      &\n+     transfer(string,\"x\",len(string)) <= \"z\"), repeat(\"x\", len(string)))\n+    return\n+  end function Up\n+end"}]}