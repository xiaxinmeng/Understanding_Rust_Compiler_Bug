{"sha": "840bd9f778b1fd68365b57aac7cf21a8b3a75620", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQwYmQ5Zjc3OGIxZmQ2ODM2NWI1N2FhYzdjZjIxYThiM2E3NTYyMA==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargls@comcast.net", "date": "2006-03-14T19:37:49Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2006-03-14T19:37:49Z"}, "message": "re PR fortran/18537 (no warning about tabs with std=f95 option)\n\n        PR 18537\n        * gfortran.h: Wrap Copyright line.\n        (gfc_option_t): add warn_tabs member.\n        * lang.opt: Update Coyright year.  Add the Wtabs.\n        * invoke.texi: Document -Wtabs.\n        * scanner.c (gfc_gobble_whitespace): Use warn_tabs.  Add linenum to\n        suppress multiple warnings.\n        (load_line): Use warn_tabs.  Add linenum, current_line, seen_comment\n        to suppress multiple warnings.\n        * options.c (gfc_init_options): Initialize warn_tabs.\n        (set_Wall): set warn_tabs for -Wall.\n        (gfc_post_options): Adjust flag_tabs depending on -pedantic.\n        (gfc_handle_option):  Process command-line option -W[no-]tabs\n\nFrom-SVN: r112066", "tree": {"sha": "23e49aecb250e0c261f9007175cf7a970b2fd22a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/23e49aecb250e0c261f9007175cf7a970b2fd22a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/840bd9f778b1fd68365b57aac7cf21a8b3a75620", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/840bd9f778b1fd68365b57aac7cf21a8b3a75620", "html_url": "https://github.com/Rust-GCC/gccrs/commit/840bd9f778b1fd68365b57aac7cf21a8b3a75620", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/840bd9f778b1fd68365b57aac7cf21a8b3a75620/comments", "author": null, "committer": null, "parents": [{"sha": "df6872b72d5ceb81427a55038f0dba06b72f7a68", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df6872b72d5ceb81427a55038f0dba06b72f7a68", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df6872b72d5ceb81427a55038f0dba06b72f7a68"}], "stats": {"total": 101, "additions": 83, "deletions": 18}, "files": [{"sha": "47e6afd1704f6f5b706eb35f13c36ed18a55713e", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=840bd9f778b1fd68365b57aac7cf21a8b3a75620", "patch": "@@ -1,3 +1,19 @@\n+2006-03-14  Steven G. Kargl  <kargls@comcast.net>\n+\n+\tPR 18537\n+\t* gfortran.h: Wrap Copyright line.\n+\t(gfc_option_t): add warn_tabs member.\n+\t* lang.opt: Update Coyright year.  Add the Wtabs.\n+\t* invoke.texi: Document -Wtabs.\n+\t* scanner.c (gfc_gobble_whitespace): Use warn_tabs.  Add linenum to\n+\tsuppress multiple warnings.\n+\t(load_line): Use warn_tabs.  Add linenum, current_line, seen_comment\n+\tto suppress multiple warnings.\n+\t* options.c (gfc_init_options): Initialize warn_tabs.\n+\t(set_Wall): set warn_tabs for -Wall.\n+\t(gfc_post_options): Adjust flag_tabs depending on -pedantic.\n+\t(gfc_handle_option):  Process command-line option -W[no-]tabs\n+\n 2006-03-13  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/25378"}, {"sha": "0e6b21c541eeabfc82eaceeb652f9179ac8db755", "filename": "gcc/fortran/gfortran.h", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Fgfortran.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Fgfortran.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fgfortran.h?ref=840bd9f778b1fd68365b57aac7cf21a8b3a75620", "patch": "@@ -1,6 +1,6 @@\n /* gfortran header file\n-   Copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006 Free Software \n-   Foundation, Inc.\n+   Copyright (C) 2000, 2001, 2002, 2003, 2004, 2005, 2006\n+   Free Software Foundation, Inc.\n    Contributed by Andy Vaught\n \n This file is part of GCC.\n@@ -1605,8 +1605,9 @@ typedef struct\n   int warn_conversion;\n   int warn_implicit_interface;\n   int warn_line_truncation;\n-  int warn_underflow;\n   int warn_surprising;\n+  int warn_tabs;\n+  int warn_underflow;\n   int warn_unused_labels;\n \n   int flag_default_double;"}, {"sha": "a65fbffa3139a210761b120300b49ebb562b4cfa", "filename": "gcc/fortran/invoke.texi", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finvoke.texi?ref=840bd9f778b1fd68365b57aac7cf21a8b3a75620", "patch": "@@ -128,8 +128,8 @@ by type.  Explanations are in the following sections.\n @xref{Warning Options,,Options to Request or Suppress Warnings}.\n @gccoptlist{\n -fsyntax-only  -pedantic  -pedantic-errors @gol\n--w  -Wall  -Waliasing  -Wconversion @gol\n--Wimplicit-interface  -Wnonstd-intrinsics  -Wsurprising  -Wunderflow @gol\n+-w  -Wall  -Waliasing  -Wconversion -Wimplicit-interface @gol\n+-Wtabs -Wnonstd-intrinsics -Wsurprising -Wunderflow @gol\n -Wunused-labels -Wline-truncation -W}\n \n @item Debugging Options\n@@ -378,8 +378,8 @@ Inhibit all warning messages.\n Enables commonly used warning options that which pertain to usage that\n we recommend avoiding and that we believe is easy to avoid.\n This currently includes @option{-Wunused-labels}, @option{-Waliasing},\n-@option{-Wsurprising}, @option{-Wnonstd-intrinsic} and\n-@option{-Wline-truncation}.\n+@option{-Wsurprising}, @option{-Wnonstd-intrinsic},  @option{-Wno-tabs},\n+and @option{-Wline-truncation}.\n \n \n @cindex -Waliasing option\n@@ -445,6 +445,15 @@ lower value is greater than its upper value.\n A LOGICAL SELECT construct has three CASE statements.\n @end itemize\n \n+@cindex -Wtabs\n+@cindex options, -Wtabs\n+@item -Wtabs\n+@cindex Tabs\n+By default, tabs are accepted as whitespace, but tabs are not members\n+of the Fortran Character Set.  @option{-Wno-tabs} will cause a warning\n+to be issued if a tab is encountered. Note, @option{-Wno-tabs} is active\n+for @option{-pedantic}, @option{-std=f95}, and @option{-Wall}.\n+\n @cindex -Wunderflow\n @cindex options, -Wunderflow\n @item -Wunderflow"}, {"sha": "bbf5d81e21a04ad18a31129ca787e17f92a0512c", "filename": "gcc/fortran/lang.opt", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Flang.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Flang.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Flang.opt?ref=840bd9f778b1fd68365b57aac7cf21a8b3a75620", "patch": "@@ -1,5 +1,5 @@\n ; Options for the Fortran 95 front end.\n-; Copyright (C) 2003, 2004, 2005 Free Software Foundation, Inc.\n+; Copyright (C) 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n ;\n ; This file is part of GCC.\n ;\n@@ -61,6 +61,10 @@ Wsurprising\n Fortran\n Warn about \\\"suspicious\\\" constructs\n \n+Wtabs\n+Fortran\n+Warn about nonconforming uses of the tab character\n+\n Wunderflow\n Fortran\n Warn about underflow of numerical constant expressions"}, {"sha": "f0ab3993e890eba257fe00c4807096a900c7b04d", "filename": "gcc/fortran/options.c", "status": "modified", "additions": 15, "deletions": 8, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Foptions.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Foptions.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Foptions.c?ref=840bd9f778b1fd68365b57aac7cf21a8b3a75620", "patch": "@@ -55,8 +55,9 @@ gfc_init_options (unsigned int argc ATTRIBUTE_UNUSED,\n   gfc_option.warn_conversion = 0;\n   gfc_option.warn_implicit_interface = 0;\n   gfc_option.warn_line_truncation = 0;\n-  gfc_option.warn_underflow = 1;\n   gfc_option.warn_surprising = 0;\n+  gfc_option.warn_tabs = 1;\n+  gfc_option.warn_underflow = 1;\n   gfc_option.warn_unused_labels = 0;\n \n   gfc_option.flag_default_double = 0;\n@@ -283,11 +284,12 @@ set_Wall (void)\n \n   gfc_option.warn_aliasing = 1;\n   gfc_option.warn_line_truncation = 1;\n-  gfc_option.warn_underflow = 1;\n+  gfc_option.warn_nonstd_intrinsics = 1;\n   gfc_option.warn_surprising = 1;\n+  gfc_option.warn_tabs = 0;\n+  gfc_option.warn_underflow = 1;\n   gfc_option.warn_unused_labels = 1;\n-  gfc_option.warn_nonstd_intrinsics = 1;\n-\n+ \n   set_Wunused (1);\n   warn_return_type = 1;\n   warn_switch = 1;\n@@ -395,14 +397,18 @@ gfc_handle_option (size_t scode, const char *arg, int value)\n       gfc_option.warn_line_truncation = value;\n       break;\n \n-    case OPT_Wunderflow:\n-      gfc_option.warn_underflow = value;\n-      break;\n-\n     case OPT_Wsurprising:\n       gfc_option.warn_surprising = value;\n       break;\n \n+    case OPT_Wtabs:\n+      gfc_option.warn_tabs = value;\n+      break;\n+\n+    case OPT_Wunderflow:\n+      gfc_option.warn_underflow = value;\n+      break;\n+\n     case OPT_Wunused_labels:\n       gfc_option.warn_unused_labels = value;\n       break;\n@@ -547,6 +553,7 @@ gfc_handle_option (size_t scode, const char *arg, int value)\n       gfc_option.allow_std = GFC_STD_F95_OBS | GFC_STD_F95 | GFC_STD_F77;\n       gfc_option.warn_std = GFC_STD_F95_OBS;\n       gfc_option.max_identifier_length = 31;\n+      gfc_option.warn_tabs = 0;\n       break;\n \n     case OPT_std_f2003:"}, {"sha": "7c09b40a2032717fc102eb981314b061f1c703ec", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 30, "deletions": 2, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/840bd9f778b1fd68365b57aac7cf21a8b3a75620/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=840bd9f778b1fd68365b57aac7cf21a8b3a75620", "patch": "@@ -836,13 +836,23 @@ gfc_error_recovery (void)\n void\n gfc_gobble_whitespace (void)\n {\n+  static int linenum = 0;\n   locus old_loc;\n   int c;\n \n   do\n     {\n       old_loc = gfc_current_locus;\n       c = gfc_next_char_literal (0);\n+      /* Issue a warning for nonconforming tabs.  We keep track of the line\n+\t number because the Fortran matchers will often back up and the same\n+\t line will be scanned multiple times.  */\n+      if (!gfc_option.warn_tabs && c == '\\t'\n+\t  && gfc_current_locus.lb->linenum != linenum)\n+\t{\n+\t  linenum = gfc_current_locus.lb->linenum;\n+\t  gfc_warning_now (\"Nonconforming tab character at %C\");\n+\t}\n     }\n   while (gfc_is_whitespace (c));\n \n@@ -865,8 +875,9 @@ gfc_gobble_whitespace (void)\n static int\n load_line (FILE * input, char **pbuf, int *pbuflen)\n {\n+  static int linenum = 0, current_line = 1;\n   int c, maxlen, i, preprocessor_flag, buflen = *pbuflen;\n-  int trunc_flag = 0;\n+  int trunc_flag = 0, seen_comment = 0;\n   char *buffer;\n \n   /* Determine the maximum allowed line length.\n@@ -932,8 +943,24 @@ load_line (FILE * input, char **pbuf, int *pbuflen)\n \t  break;\n \t}\n \n+      /* Is this a fixed-form comment?  */\n+      if (gfc_current_form == FORM_FIXED && i == 0\n+\t  && (c == '*' || c == 'c' || c == 'd'))\n+\tseen_comment = 1;\n+\n       if (gfc_current_form == FORM_FIXED && c == '\\t' && i <= 6)\n-\t{\t\t\t/* Tab expansion.  */\n+\t{\n+\t  /* The error machinery isn't available at this point, so we can't\n+\t     easily report line and column numbers consistent with other \n+\t     parts of gfortran.  */\n+\t  if (!gfc_option.warn_tabs && seen_comment == 0\n+\t      && current_line != linenum)\n+\t    {\n+\t      linenum = current_line;\n+\t      gfc_warning_now (\n+\t\t\"Nonconforming tab character in column 1 of line %d\", linenum);\n+\t    }\n+\n \t  while (i <= 6)\n \t    {\n \t      *buffer++ = ' ';\n@@ -985,6 +1012,7 @@ load_line (FILE * input, char **pbuf, int *pbuflen)\n \n   *buffer = '\\0';\n   *pbuflen = buflen;\n+  current_line++;\n \n   return trunc_flag;\n }"}]}