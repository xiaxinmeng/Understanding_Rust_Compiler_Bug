{"sha": "f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjRjMjIyYzAzNThkYzBmOWY2MzkwZTFlZWUxYzZhOTIxNGY3ZjgyOQ==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2017-08-07T17:06:11Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2017-08-07T17:06:11Z"}, "message": "Fix diff_type in expand_oacc_for char iter_type\n\n2017-08-07  Tom de Vries  <tom@codesourcery.com>\n\n\tPR middle-end/78266\n\t* omp-expand.c (expand_oacc_for): Ensure diff_type is large enough.\n\n\t* testsuite/libgomp.oacc-c-c++-common/vprop-2.c: New test.\n\t* testsuite/libgomp.oacc-c-c++-common/vprop.c: Remove xfail.\n\nFrom-SVN: r250925", "tree": {"sha": "75adc4e765783e7a1a3ac4a08c86f29481880c7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/75adc4e765783e7a1a3ac4a08c86f29481880c7c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/comments", "author": null, "committer": null, "parents": [{"sha": "58fccd6c21433d60c8ff41272c2edec0d4f39df7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58fccd6c21433d60c8ff41272c2edec0d4f39df7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58fccd6c21433d60c8ff41272c2edec0d4f39df7"}], "stats": {"total": 59, "additions": 58, "deletions": 1}, "files": [{"sha": "2f1a274db16642b1bee5dddbc824fe9d30b69a41", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "patch": "@@ -1,3 +1,8 @@\n+2017-08-07  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR middle-end/78266\n+\t* omp-expand.c (expand_oacc_for): Ensure diff_type is large enough.\n+\n 2017-08-07  Martin Liska  <mliska@suse.cz>\n \n \t* config/mips/mips.c: Include attribs.h."}, {"sha": "0f635070a2136b44b61e4db9bf407f7aa9c7b3fd", "filename": "gcc/omp-expand.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/gcc%2Fomp-expand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/gcc%2Fomp-expand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-expand.c?ref=f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "patch": "@@ -5328,6 +5328,8 @@ expand_oacc_for (struct omp_region *region, struct omp_for_data *fd)\n     }\n   if (POINTER_TYPE_P (diff_type) || TYPE_UNSIGNED (diff_type))\n     diff_type = signed_type_for (diff_type);\n+  if (TYPE_PRECISION (diff_type) < TYPE_PRECISION (integer_type_node))\n+    diff_type = integer_type_node;\n \n   basic_block entry_bb = region->entry; /* BB ending in OMP_FOR */\n   basic_block exit_bb = region->exit; /* BB ending in OMP_RETURN */"}, {"sha": "62d4f27d2f34251b3edcd54ce350bcbe3bb0ea1e", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "patch": "@@ -1,3 +1,9 @@\n+2017-08-07  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR middle-end/78266\n+\t* testsuite/libgomp.oacc-c-c++-common/vprop-2.c: New test.\n+\t* testsuite/libgomp.oacc-c-c++-common/vprop.c: Remove xfail.\n+\n 2017-07-27  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/45784"}, {"sha": "046ac68014b4206ffd0b749a9aae9d60d3785fb8", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/vprop-2.c", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fvprop-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fvprop-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fvprop-2.c?ref=f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "patch": "@@ -0,0 +1,45 @@\n+/* { dg-do run } */\n+\n+#include <assert.h>\n+\n+#define DO_PRAGMA(x) _Pragma (#x)\n+\n+#define test(idx,type,ngangs)                           \\\n+  void                                                  \\\n+  test_##idx ()                                         \\\n+  {                                                     \\\n+    int b[100];                                         \\\n+                                                        \\\n+    for (unsigned int i = 0; i < 100; i++)              \\\n+      b[i] = 0;                                         \\\n+                                                        \\\n+    DO_PRAGMA(acc parallel num_gangs (ngangs) copy (b)) \\\n+      {                                                 \\\n+        _Pragma(\"acc loop gang\")                        \\\n+          for (type j = 0; j < 5; j++)                  \\\n+            {                                           \\\n+              _Pragma(\"acc loop vector\")                \\\n+                for (unsigned int i = 0; i < 20; i++)   \\\n+                  b[j * 20 + i] = -2;                   \\\n+            }                                           \\\n+      }                                                 \\\n+                                                        \\\n+    for (unsigned int i = 0; i < 100; i++)              \\\n+      assert (b[i] == -2);                              \\\n+  }\n+\n+test (0, signed char, 256)\n+test (1, unsigned char, 256)\n+test (2, signed short, 65535)\n+test (3, unsigned short, 65535)\n+\n+int\n+main ()\n+{\n+  test_0 ();\n+  test_1 ();\n+  test_2 ();\n+  test_3 ();\n+\n+  return 0;\n+}"}, {"sha": "e4dd682e84f04926c88073bf434ba1a6eb9edff9", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/vprop.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fvprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4c222c0358dc0f9f6390e1eee1c6a9214f7f829/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fvprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fvprop.c?ref=f4c222c0358dc0f9f6390e1eee1c6a9214f7f829", "patch": "@@ -1,5 +1,4 @@\n /* { dg-do run } */\n-/* { dg-xfail-run-if \"PR78266\" { openacc_nvidia_accel_selected } } */\n \n #include <assert.h>\n "}]}