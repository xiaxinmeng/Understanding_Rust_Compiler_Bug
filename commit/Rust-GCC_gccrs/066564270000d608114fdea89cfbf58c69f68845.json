{"sha": "066564270000d608114fdea89cfbf58c69f68845", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDY2NTY0MjcwMDAwZDYwODExNGZkZWE4OWNmYmY1OGM2OWY2ODg0NQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2019-12-10T17:47:28Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2019-12-10T17:47:28Z"}, "message": "predict.c (compute_function_frequency): Check for presence of IPA profile.\n\n\t* predict.c (compute_function_frequency): Check for presence of IPA\n\tprofile.\n\nFrom-SVN: r279177", "tree": {"sha": "a5d84230d458d8c7f49569aad7d94c200fe7a5e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a5d84230d458d8c7f49569aad7d94c200fe7a5e6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/066564270000d608114fdea89cfbf58c69f68845", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/066564270000d608114fdea89cfbf58c69f68845", "html_url": "https://github.com/Rust-GCC/gccrs/commit/066564270000d608114fdea89cfbf58c69f68845", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/066564270000d608114fdea89cfbf58c69f68845/comments", "author": null, "committer": null, "parents": [{"sha": "12651dc6dcaafb3c8a5cdfc10b7bc25e6f62cb33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/12651dc6dcaafb3c8a5cdfc10b7bc25e6f62cb33", "html_url": "https://github.com/Rust-GCC/gccrs/commit/12651dc6dcaafb3c8a5cdfc10b7bc25e6f62cb33"}], "stats": {"total": 13, "additions": 8, "deletions": 5}, "files": [{"sha": "76da7318741af2ed937eb4d7a372d08f7f004cb2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/066564270000d608114fdea89cfbf58c69f68845/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/066564270000d608114fdea89cfbf58c69f68845/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=066564270000d608114fdea89cfbf58c69f68845", "patch": "@@ -1,3 +1,8 @@\n+2019-12-10  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* predict.c (compute_function_frequency): Check for presence of IPA\n+\tprofile.\n+\n 2019-12-10  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* varasm.c (default_function_section): Fix confused tests for"}, {"sha": "4b5b77e78d2dcb440bd8208510c30c2354cbbf67", "filename": "gcc/predict.c", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/066564270000d608114fdea89cfbf58c69f68845/gcc%2Fpredict.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/066564270000d608114fdea89cfbf58c69f68845/gcc%2Fpredict.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpredict.c?ref=066564270000d608114fdea89cfbf58c69f68845", "patch": "@@ -3932,13 +3932,11 @@ compute_function_frequency (void)\n   if (DECL_STATIC_DESTRUCTOR (current_function_decl))\n     node->only_called_at_exit = true;\n \n-  if (profile_status_for_fn (cfun) != PROFILE_READ)\n+  if (!ENTRY_BLOCK_PTR_FOR_FN (cfun)->count.ipa_p ())\n     {\n       int flags = flags_from_decl_or_type (current_function_decl);\n-      if ((ENTRY_BLOCK_PTR_FOR_FN (cfun)->count.ipa_p ()\n-\t   && ENTRY_BLOCK_PTR_FOR_FN (cfun)->count.ipa() == profile_count::zero ())\n-\t  || lookup_attribute (\"cold\", DECL_ATTRIBUTES (current_function_decl))\n-\t     != NULL)\n+      if (lookup_attribute (\"cold\", DECL_ATTRIBUTES (current_function_decl))\n+\t  != NULL)\n \t{\n           node->frequency = NODE_FREQUENCY_UNLIKELY_EXECUTED;\n \t  warn_function_cold (current_function_decl);"}]}