{"sha": "3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "node_id": "C_kwDOANBUbNoAKDNiZmQwNDIwZTRhMTdhODI0NTRlZDNiZGFkYzBmNWQzNjJkOWI2MzY", "commit": {"author": {"name": "Arsen Arsenovi\u0107", "email": "arsen@aarsen.me", "date": "2023-04-04T21:24:52Z"}, "committer": {"name": "Arsen Arsenovi\u0107", "email": "arsen@aarsen.me", "date": "2023-04-05T16:45:15Z"}, "message": "libstdc++: Fix some freestanding test failures\n\nAt some point, <charconv> was added to the non-hosted bit of the C++17\nblock, which induced failures in many tests.\n\nIn addition, some tests also lacked a dg-require-effective-target hosted\ntag.\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/precompiled/stdc++.h (C++17): Don't double-include\n\t<charconv>, once with wrong conditions.\n\t* testsuite/18_support/96817.cc: Require hosted.\n\t* testsuite/18_support/bad_exception/59392.cc: Ditto.\n\t* testsuite/20_util/scoped_allocator/108952.cc: Ditto.\n\t* testsuite/20_util/uses_allocator/lwg3527.cc: Ditto.\n\t* testsuite/29_atomics/atomic/operators/pointer_partial_void.cc:\n\tDitto.", "tree": {"sha": "fbb024b74bc6e92d939b6cfc8d1a639d6049159f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fbb024b74bc6e92d939b6cfc8d1a639d6049159f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niNUEABYKAH0WIQT+4rPRE/wAoxYtYGFSwpQwHqLEkwUCZC2lm18UgAAAAAAuAChp\nc3N1ZXItZnByQG5vdGF0aW9ucy5vcGVucGdwLmZpZnRoaG9yc2VtYW4ubmV0RkVF\nMkIzRDExM0ZDMDBBMzE2MkQ2MDYxNTJDMjk0MzAxRUEyQzQ5MwAKCRBSwpQwHqLE\nk6GzAP0UA662P+4wwHloj+h8DSwqNdD+zpKCXQaxZWSyqTIK+QEA/l95k2rc1VeY\nF0z9biYWQQcM3KyOcwqAfW26T4f4/QM=\n=AuO3\n-----END PGP SIGNATURE-----", "payload": "tree fbb024b74bc6e92d939b6cfc8d1a639d6049159f\nparent bff26ac162772313d3d9b8ce952b5a0846e26878\nauthor Arsen Arsenovi\u0107 <arsen@aarsen.me> 1680643492 +0200\ncommitter Arsen Arsenovi\u0107 <arsen@aarsen.me> 1680713115 +0200\n\nlibstdc++: Fix some freestanding test failures\n\nAt some point, <charconv> was added to the non-hosted bit of the C++17\nblock, which induced failures in many tests.\n\nIn addition, some tests also lacked a dg-require-effective-target hosted\ntag.\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/precompiled/stdc++.h (C++17): Don't double-include\n\t<charconv>, once with wrong conditions.\n\t* testsuite/18_support/96817.cc: Require hosted.\n\t* testsuite/18_support/bad_exception/59392.cc: Ditto.\n\t* testsuite/20_util/scoped_allocator/108952.cc: Ditto.\n\t* testsuite/20_util/uses_allocator/lwg3527.cc: Ditto.\n\t* testsuite/29_atomics/atomic/operators/pointer_partial_void.cc:\n\tDitto.\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/comments", "author": {"login": "ArsenArsen", "id": 7805050, "node_id": "MDQ6VXNlcjc4MDUwNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7805050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArsenArsen", "html_url": "https://github.com/ArsenArsen", "followers_url": "https://api.github.com/users/ArsenArsen/followers", "following_url": "https://api.github.com/users/ArsenArsen/following{/other_user}", "gists_url": "https://api.github.com/users/ArsenArsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArsenArsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArsenArsen/subscriptions", "organizations_url": "https://api.github.com/users/ArsenArsen/orgs", "repos_url": "https://api.github.com/users/ArsenArsen/repos", "events_url": "https://api.github.com/users/ArsenArsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ArsenArsen/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ArsenArsen", "id": 7805050, "node_id": "MDQ6VXNlcjc4MDUwNTA=", "avatar_url": "https://avatars.githubusercontent.com/u/7805050?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArsenArsen", "html_url": "https://github.com/ArsenArsen", "followers_url": "https://api.github.com/users/ArsenArsen/followers", "following_url": "https://api.github.com/users/ArsenArsen/following{/other_user}", "gists_url": "https://api.github.com/users/ArsenArsen/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArsenArsen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArsenArsen/subscriptions", "organizations_url": "https://api.github.com/users/ArsenArsen/orgs", "repos_url": "https://api.github.com/users/ArsenArsen/repos", "events_url": "https://api.github.com/users/ArsenArsen/events{/privacy}", "received_events_url": "https://api.github.com/users/ArsenArsen/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bff26ac162772313d3d9b8ce952b5a0846e26878", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bff26ac162772313d3d9b8ce952b5a0846e26878", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bff26ac162772313d3d9b8ce952b5a0846e26878"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "176ad79ff3c330314dec6a5af1e7687f298df8c9", "filename": "libstdc++-v3/include/precompiled/stdc++.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Finclude%2Fprecompiled%2Fstdc%2B%2B.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Finclude%2Fprecompiled%2Fstdc%2B%2B.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fprecompiled%2Fstdc%2B%2B.h?ref=3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "patch": "@@ -75,7 +75,6 @@\n \n #if __cplusplus >= 201703L\n #include <any>\n-#include <charconv>\n // #include <execution>\n #include <optional>\n #include <variant>"}, {"sha": "073fc337e8f09a0dc1ae5dd69d6578e6cb7ed6e5", "filename": "libstdc++-v3/testsuite/18_support/96817.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2F96817.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2F96817.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2F96817.cc?ref=3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "patch": "@@ -17,6 +17,7 @@\n \n // { dg-do run }\n // { dg-additional-options \"-pthread\" { target pthread } }\n+// { dg-require-effective-target hosted }\n \n // Static init cannot detect recursion for gthreads targets without futexes\n // (and the futex case can only detect it if __libc_single_threaded==true)."}, {"sha": "ae972d0535db5dfe9d94de4b690f117fb5716132", "filename": "libstdc++-v3/testsuite/18_support/bad_exception/59392.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2Fbad_exception%2F59392.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2Fbad_exception%2F59392.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F18_support%2Fbad_exception%2F59392.cc?ref=3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "patch": "@@ -17,6 +17,7 @@\n \n // { dg-options \"-Wno-deprecated\" }\n // { dg-do run { target c++14_down } }\n+// { dg-require-effective-target hosted }\n \n #include <exception>\n #include <cstdlib>"}, {"sha": "9342f453bf4952bdedf3d510beeb6d32d3c37a18", "filename": "libstdc++-v3/testsuite/20_util/scoped_allocator/108952.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fscoped_allocator%2F108952.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fscoped_allocator%2F108952.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fscoped_allocator%2F108952.cc?ref=3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "patch": "@@ -1,4 +1,5 @@\n // { dg-do compile { target c++11 } }\n+// { dg-require-effective-target hosted }\n \n #include <scoped_allocator>\n "}, {"sha": "c5a7d513b314cc871a311c588b078c153fa1a864", "filename": "libstdc++-v3/testsuite/20_util/uses_allocator/lwg3527.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fuses_allocator%2Flwg3527.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fuses_allocator%2Flwg3527.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fuses_allocator%2Flwg3527.cc?ref=3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "patch": "@@ -1,5 +1,6 @@\n // { dg-options \"-std=gnu++20\" }\n // { dg-do compile { target c++20 } }\n+// { dg-require-effective-target hosted }\n \n #include <memory>\n "}, {"sha": "e5d221ed15a2ce649c4ef95ff86fad679bab3dc8", "filename": "libstdc++-v3/testsuite/29_atomics/atomic/operators/pointer_partial_void.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F29_atomics%2Fatomic%2Foperators%2Fpointer_partial_void.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3bfd0420e4a17a82454ed3bdadc0f5d362d9b636/libstdc%2B%2B-v3%2Ftestsuite%2F29_atomics%2Fatomic%2Foperators%2Fpointer_partial_void.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F29_atomics%2Fatomic%2Foperators%2Fpointer_partial_void.cc?ref=3bfd0420e4a17a82454ed3bdadc0f5d362d9b636", "patch": "@@ -1,5 +1,6 @@\n // { dg-do run { target { c++11_only || c++14_only } } }\n // { dg-require-atomic-builtins \"\" }\n+// { dg-require-effective-target hosted }\n \n // Copyright (C) 2012-2023 Free Software Foundation, Inc.\n //"}]}