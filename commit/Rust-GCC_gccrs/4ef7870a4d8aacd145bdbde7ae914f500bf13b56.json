{"sha": "4ef7870a4d8aacd145bdbde7ae914f500bf13b56", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGVmNzg3MGE0ZDhhYWNkMTQ1YmRiZGU3YWU5MTRmNTAwYmYxM2I1Ng==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@libertysurf.fr", "date": "2002-10-07T07:37:12Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2002-10-07T07:37:12Z"}, "message": "re PR c/7411 (cistore.c:392: Internal compiler error in instantiate_virtual_regs_1, at function.c:3974)\n\n PR c/7411\n * expr.c (expand_expr) [PLUS]: Simplify after the operands\n have been expanded in EXPAND_NORMAL mode.\n\nCo-Authored-By: Volker Reichelt <reichelt@igpm.rwth-aachen.de>\n\nFrom-SVN: r57882", "tree": {"sha": "d7b1d8da3e6a106a36561c0c86b098f57082381e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d7b1d8da3e6a106a36561c0c86b098f57082381e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4ef7870a4d8aacd145bdbde7ae914f500bf13b56", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ef7870a4d8aacd145bdbde7ae914f500bf13b56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ef7870a4d8aacd145bdbde7ae914f500bf13b56", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ef7870a4d8aacd145bdbde7ae914f500bf13b56/comments", "author": {"login": "ebotcazou", "id": 48091907, "node_id": "MDQ6VXNlcjQ4MDkxOTA3", "avatar_url": "https://avatars.githubusercontent.com/u/48091907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebotcazou", "html_url": "https://github.com/ebotcazou", "followers_url": "https://api.github.com/users/ebotcazou/followers", "following_url": "https://api.github.com/users/ebotcazou/following{/other_user}", "gists_url": "https://api.github.com/users/ebotcazou/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebotcazou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebotcazou/subscriptions", "organizations_url": "https://api.github.com/users/ebotcazou/orgs", "repos_url": "https://api.github.com/users/ebotcazou/repos", "events_url": "https://api.github.com/users/ebotcazou/events{/privacy}", "received_events_url": "https://api.github.com/users/ebotcazou/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fe736b6c2c9fa73540d1f54059fdccbd7ac9aac6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe736b6c2c9fa73540d1f54059fdccbd7ac9aac6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe736b6c2c9fa73540d1f54059fdccbd7ac9aac6"}], "stats": {"total": 33, "additions": 29, "deletions": 4}, "files": [{"sha": "47717e7d9975cce191426aa0d24ed735a91fdf30", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ef7870a4d8aacd145bdbde7ae914f500bf13b56/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ef7870a4d8aacd145bdbde7ae914f500bf13b56/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4ef7870a4d8aacd145bdbde7ae914f500bf13b56", "patch": "@@ -1,3 +1,10 @@\n+2002-09-25  Eric Botcazou  <ebotcazou@libertysurf.fr>\n+            Volker Reichelt <reichelt@igpm.rwth-aachen.de>\n+\n+\tPR c/7411\n+\t* expr.c (expand_expr) [PLUS]: Simplify after the operands\n+\thave been expanded in EXPAND_NORMAL mode.\n+\n 2002-10-06  Richard Henderson  <rth@redhat.com>\n \n \t* config/rs6000/rs6000.md (load_toc_v4_PIC_2): Fix base constraint."}, {"sha": "e33d8145e1f8957580fefffde44e20831093ee0e", "filename": "gcc/expr.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ef7870a4d8aacd145bdbde7ae914f500bf13b56/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ef7870a4d8aacd145bdbde7ae914f500bf13b56/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=4ef7870a4d8aacd145bdbde7ae914f500bf13b56", "patch": "@@ -7899,16 +7899,23 @@ expand_expr (exp, target, tmode, modifier)\n \t    }\n \t}\n \n+      if (! safe_from_p (subtarget, TREE_OPERAND (exp, 1), 1))\n+\tsubtarget = 0;\n+\n       /* No sense saving up arithmetic to be done\n \t if it's all in the wrong mode to form part of an address.\n \t And force_operand won't know whether to sign-extend or\n \t zero-extend.  */\n       if ((modifier != EXPAND_SUM && modifier != EXPAND_INITIALIZER)\n \t  || mode != ptr_mode)\n-\tgoto binop;\n-\n-      if (! safe_from_p (subtarget, TREE_OPERAND (exp, 1), 1))\n-\tsubtarget = 0;\n+\t{\n+\t  op0 = expand_expr (TREE_OPERAND (exp, 0), subtarget, VOIDmode, 0);\n+\t  op1 = expand_expr (TREE_OPERAND (exp, 1), NULL_RTX, VOIDmode, 0);\n+\t  temp = simplify_binary_operation (PLUS, mode, op0, op1);\n+\t  if (temp)\n+\t    return temp;\n+\t  goto binop2;\n+\t}\n \n       op0 = expand_expr (TREE_OPERAND (exp, 0), subtarget, VOIDmode, modifier);\n       op1 = expand_expr (TREE_OPERAND (exp, 1), NULL_RTX, VOIDmode, modifier);"}, {"sha": "de4c0defae9f21adb0eff110394115c78aac2ca4", "filename": "gcc/testsuite/gcc.c-torture/compile/20021007-1.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ef7870a4d8aacd145bdbde7ae914f500bf13b56/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20021007-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ef7870a4d8aacd145bdbde7ae914f500bf13b56/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20021007-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20021007-1.c?ref=4ef7870a4d8aacd145bdbde7ae914f500bf13b56", "patch": "@@ -0,0 +1,11 @@\n+/* PR c/7411 */\n+/* Verify that GCC simplifies the null addition to i before\n+   virtual register substitution tries it and winds up with\n+   a memory to memory move.  */\n+                        \n+void foo ()     \n+{\n+   int i = 0,j;\n+ \n+   i+=j=0;\n+}"}]}