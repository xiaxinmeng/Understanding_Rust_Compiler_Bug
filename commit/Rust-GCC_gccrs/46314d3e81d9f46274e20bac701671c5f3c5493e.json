{"sha": "46314d3e81d9f46274e20bac701671c5f3c5493e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDYzMTRkM2U4MWQ5ZjQ2Mjc0ZTIwYmFjNzAxNjcxYzVmM2M1NDkzZQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2010-05-21T10:02:07Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2010-05-21T10:02:07Z"}, "message": "re PR middle-end/44101 (ICE compiling 25_algorithms/fill/4.cc on Tru64 UNIX V5.1B)\n\n\tPR middle-end/44101\n\t* gimplify.c (gimplify_init_constructor): Build a VIEW_CONVERT_EXPR\n\taround the uniquized constructor if its type requires a conversion.\n\nFrom-SVN: r159655", "tree": {"sha": "2b828b4c72f7f8ac16899fa066373c29a62932a3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2b828b4c72f7f8ac16899fa066373c29a62932a3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/46314d3e81d9f46274e20bac701671c5f3c5493e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46314d3e81d9f46274e20bac701671c5f3c5493e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46314d3e81d9f46274e20bac701671c5f3c5493e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46314d3e81d9f46274e20bac701671c5f3c5493e/comments", "author": null, "committer": null, "parents": [{"sha": "f99fcb3ba5b2f9bae0d0e85e97e6e6e4ec3e5aa4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f99fcb3ba5b2f9bae0d0e85e97e6e6e4ec3e5aa4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f99fcb3ba5b2f9bae0d0e85e97e6e6e4ec3e5aa4"}], "stats": {"total": 40, "additions": 38, "deletions": 2}, "files": [{"sha": "ac091e5eab9fe6db4c13b7e1ccd6a5ce5b625037", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=46314d3e81d9f46274e20bac701671c5f3c5493e", "patch": "@@ -1,3 +1,9 @@\n+2010-05-21  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\tPR middle-end/44101\n+\t* gimplify.c (gimplify_init_constructor): Build a VIEW_CONVERT_EXPR\n+\taround the uniquized constructor if its type requires a conversion.\n+\n 2010-05-21  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/44205"}, {"sha": "f5bd994ffbbed8f6160e286ceba82619e649ff34", "filename": "gcc/gimplify.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=46314d3e81d9f46274e20bac701671c5f3c5493e", "patch": "@@ -3813,8 +3813,11 @@ gimplify_init_constructor (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \t\tif (notify_temp_creation)\n \t\t  return GS_ERROR;\n \n-\t        walk_tree (&ctor, force_labels_r, NULL, NULL);\n-\t\tTREE_OPERAND (*expr_p, 1) = tree_output_constant_def (ctor);\n+\t\twalk_tree (&ctor, force_labels_r, NULL, NULL);\n+\t\tctor = tree_output_constant_def (ctor);\n+\t\tif (!useless_type_conversion_p (type, TREE_TYPE (ctor)))\n+\t\t  ctor = build1 (VIEW_CONVERT_EXPR, type, ctor);\n+\t\tTREE_OPERAND (*expr_p, 1) = ctor;\n \n \t\t/* This is no longer an assignment of a CONSTRUCTOR, but\n \t\t   we still may have processing to do on the LHS.  So"}, {"sha": "a0740aac91a696ca25c6338fc924ac7e740a89d7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=46314d3e81d9f46274e20bac701671c5f3c5493e", "patch": "@@ -1,3 +1,7 @@\n+2010-05-21  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* g++.dg/other/const3.C: New test.\n+\n 2010-05-20  Daniel Franke  <franke.daniel@gmail.com>\n \n         PR fortran/38407"}, {"sha": "d47133b455a3f2620379b7f6db489ecb6cf0babd", "filename": "gcc/testsuite/g++.dg/other/const3.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fconst3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46314d3e81d9f46274e20bac701671c5f3c5493e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fconst3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fconst3.C?ref=46314d3e81d9f46274e20bac701671c5f3c5493e", "patch": "@@ -0,0 +1,23 @@\n+// PR middle-end/44101\n+// { dg-do compile }\n+\n+extern bool equal (int[], int[], const int[]);\n+extern bool equal (wchar_t[], wchar_t[], const wchar_t[]);\n+\n+void foo(void)\n+{\n+  const int A1[] = {3, 3, 3, 3, 3, 3, 3, 3, 3, 3};\n+  const int N1 = sizeof(A1) / sizeof(int);\n+  int i1[N1];\n+\n+  if (equal(i1, i1 + N1, A1))\n+    return;\n+\n+  const wchar_t A3[] = {L'\\3', L'\\3', L'\\3', L'\\3', L'\\3',\n+   L'\\3', L'\\3', L'\\3', L'\\3', L'\\3'};\n+  const int N3 = sizeof(A3) / sizeof(wchar_t);\n+  wchar_t i3[N3];\n+\n+  if (equal(i3, i3 + N3, A3))\n+    return;\n+}"}]}