{"sha": "fa275f0a5cd7380966a54c48d38e95938dd791f4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmEyNzVmMGE1Y2Q3MzgwOTY2YTU0YzQ4ZDM4ZTk1OTM4ZGQ3OTFmNA==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2006-03-28T19:02:25Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2006-03-28T19:02:25Z"}, "message": "re PR libgcj/26441 (Old libltdl may cause memory leak in Class.forName())\n\n\tPR libgcj/26641:\n\t* Merged libltdl 1.5.16 from vendor branch.\n\nFrom-SVN: r112464", "tree": {"sha": "44928bcc3b5d69ceb886786f3462685287f715f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/44928bcc3b5d69ceb886786f3462685287f715f3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fa275f0a5cd7380966a54c48d38e95938dd791f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa275f0a5cd7380966a54c48d38e95938dd791f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fa275f0a5cd7380966a54c48d38e95938dd791f4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa275f0a5cd7380966a54c48d38e95938dd791f4/comments", "author": null, "committer": null, "parents": [{"sha": "625a46d9b69b3068844a79bb20e07abe8b3ac57e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/625a46d9b69b3068844a79bb20e07abe8b3ac57e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/625a46d9b69b3068844a79bb20e07abe8b3ac57e"}], "stats": {"total": 6393, "additions": 3896, "deletions": 2497}, "files": [{"sha": "ba2be481c1b60b8246acfeeea6fec8648fa5aa1e", "filename": "libjava/libltdl/COPYING.LIB", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FCOPYING.LIB", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FCOPYING.LIB", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2FCOPYING.LIB?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -3,7 +3,7 @@\n                        Version 2.1, February 1999\n \n  Copyright (C) 1991, 1999 Free Software Foundation, Inc.\n-     59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n+     51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n  Everyone is permitted to copy and distribute verbatim copies\n  of this license document, but changing it is not allowed.\n \n@@ -493,7 +493,7 @@ does.>\n \n     You should have received a copy of the GNU Lesser General Public\n     License along with this library; if not, write to the Free Software\n-    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307  USA\n+    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA\n \n Also add information on how to contact you by electronic and paper\n mail."}, {"sha": "adb0570c1ac075c3de5bbbafcd71ad43c457bbf3", "filename": "libjava/libltdl/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2FChangeLog?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -1,3 +1,8 @@\n+2006-03-28  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR libgcj/26641:\n+\t* Merged libltdl 1.5.16 from vendor branch.\n+\n 2004-11-24  Kelley Cook  <kcook@gcc.gnu.org>\n \n \t* Makefile.in: Regenrate with Automake 1.9.3."}, {"sha": "b8d5cf1b14f0afafe247ed3767a85c4a4bb6fcbc", "filename": "libjava/libltdl/Makefile.am", "status": "modified", "additions": 17, "deletions": 16, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2FMakefile.am?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -20,7 +20,7 @@ endif\n CLEANFILES = libltdl.la libltdlc.la\n \n libltdl_la_SOURCES = ltdl.c\n-libltdl_la_LDFLAGS = -no-undefined -version-info 4:0:1\n+libltdl_la_LDFLAGS = -no-undefined -version-info 4:1:1\n libltdl_la_LIBADD = $(LIBADD_DL)\n \n libltdlc_la_SOURCES = ltdl.c\n@@ -33,18 +33,19 @@ $(libltdl_la_OBJECTS) $(libltdlc_la_OBJECTS): libtool\n libtool: $(LIBTOOL_DEPS)\n \t$(SHELL) ./config.status --recheck\n \n-## This allows us to install libltdl without using ln and without creating\n-## a world writeable directory.\n-## FIXME:  Remove this rule once automake can do this properly by itself.\n-local-install-files: $(DISTFILES)\n-\t-rm -rf $(DESTDIR)$(datadir)/libtool/libltdl\n-\t$(mkinstalldirs) $(DESTDIR)$(datadir)/libtool/libltdl\n-\t@for file in $(DISTFILES); do \\\n-\t  d=$(srcdir); \\\n-\t  if test -d $$d/$$file; then \\\n-\t    cp -r $$d/$$file $(DESTDIR)$(datadir)/libtool/libltdl/$$file; \\\n-\t  else \\\n-\t    test -f $(DESTDIR)$(datadir)/libtool/libltdl/$$file \\\n-\t    || cp $$d/$$file $(DESTDIR)$(datadir)/libtool/libltdl/$$file || :; \\\n-\t  fi; \\\n-\tdone\n+## These are installed as a subdirectory of pkgdatadir so that\n+## libtoolize --ltdl can find them later:\n+ltdldatadir = $(datadir)/libtool/libltdl\n+ltdldatafiles = COPYING.LIB README acinclude.m4 aclocal.m4 \\\n+\t\tMakefile.am Makefile.in configure.ac configure \\\n+\t\tconfig-h.in config.guess config.sub \\\n+\t\tinstall-sh missing ltmain.sh \\\n+\t\tltdl.c ltdl.h\n+\n+## To avoid spurious reconfiguration when the user installs these files\n+## with libtoolize, we have to preserve their timestamps carefully:\n+install-data-local:\n+\t-rm -rf $(DESTDIR)$(ltdldatadir)\n+\t$(mkinstalldirs) $(DESTDIR)$(ltdldatadir)\n+\t( cd $(srcdir) && $(AMTAR) chf - $(ltdldatafiles); ) \\\n+\t  | ( umask 0 && cd $(DESTDIR)$(ltdldatadir) && $(AMTAR) xf -; )"}, {"sha": "47e192c325c03f16bb7154b80b81357a3a73bb5d", "filename": "libjava/libltdl/Makefile.in", "status": "modified", "additions": 54, "deletions": 40, "changes": 94, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2FMakefile.in?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -1,8 +1,8 @@\n-# Makefile.in generated by automake 1.9.5 from Makefile.am.\n+# Makefile.in generated by automake 1.9.3 from Makefile.am.\n # @configure_input@\n \n # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,\n-# 2003, 2004, 2005  Free Software Foundation, Inc.\n+# 2003, 2004  Free Software Foundation, Inc.\n # This Makefile.in is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n@@ -43,7 +43,7 @@ DIST_COMMON = README $(am__configure_deps) $(am__include_HEADERS_DIST) \\\n \t$(am__noinst_HEADERS_DIST) $(srcdir)/Makefile.am \\\n \t$(srcdir)/Makefile.in $(srcdir)/config-h.in \\\n \t$(top_srcdir)/configure COPYING.LIB ChangeLog config.guess \\\n-\tconfig.sub install-sh ltmain.sh missing mkinstalldirs\n+\tconfig.sub install-sh ltmain.sh missing\n subdir = .\n ACLOCAL_M4 = $(top_srcdir)/aclocal.m4\n am__aclocal_m4_deps = $(top_srcdir)/acinclude.m4 \\\n@@ -52,8 +52,9 @@ am__configure_deps = $(am__aclocal_m4_deps) $(CONFIGURE_DEPENDENCIES) \\\n \t$(ACLOCAL_M4)\n am__CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \\\n  configure.lineno configure.status.lineno\n-mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs\n-CONFIG_CLEAN_FILES = config.h\n+mkinstalldirs = $(install_sh) -d\n+CONFIG_HEADER = config.h\n+CONFIG_CLEAN_FILES =\n am__vpath_adj_setup = srcdirstrip=`echo \"$(srcdir)\" | sed 's|.|.|g'`;\n am__vpath_adj = case $$p in \\\n     $(srcdir)/*) f=`echo \"$$p\" | sed \"s|^$$srcdirstrip/||\"`;; \\\n@@ -72,7 +73,7 @@ libltdlc_la_DEPENDENCIES = $(am__DEPENDENCIES_1)\n am_libltdlc_la_OBJECTS = ltdl.lo\n libltdlc_la_OBJECTS = $(am_libltdlc_la_OBJECTS)\n @CONVENIENCE_LTDL_TRUE@am_libltdlc_la_rpath =\n-DEFAULT_INCLUDES = -I. -I$(srcdir)\n+DEFAULT_INCLUDES = -I. -I$(srcdir) -I.\n depcomp =\n am__depfiles_maybe =\n COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \\\n@@ -149,9 +150,6 @@ LIBTOOL = @LIBTOOL@\n LIBTOOL_DEPS = @LIBTOOL_DEPS@\n LN_S = @LN_S@\n LTLIBOBJS = @LTLIBOBJS@\n-MAINT = @MAINT@\n-MAINTAINER_MODE_FALSE = @MAINTAINER_MODE_FALSE@\n-MAINTAINER_MODE_TRUE = @MAINTAINER_MODE_TRUE@\n MAKEINFO = @MAKEINFO@\n OBJDUMP = @OBJDUMP@\n OBJEXT = @OBJEXT@\n@@ -221,17 +219,25 @@ INCLUDES = $(GCINCS)\n @CONVENIENCE_LTDL_TRUE@noinst_LTLIBRARIES = libltdlc.la\n CLEANFILES = libltdl.la libltdlc.la\n libltdl_la_SOURCES = ltdl.c\n-libltdl_la_LDFLAGS = -no-undefined -version-info 4:0:1\n+libltdl_la_LDFLAGS = -no-undefined -version-info 4:1:1\n libltdl_la_LIBADD = $(LIBADD_DL)\n libltdlc_la_SOURCES = ltdl.c\n libltdlc_la_LIBADD = $(LIBADD_DL)\n-all: all-am\n+ltdldatadir = $(datadir)/libtool/libltdl\n+ltdldatafiles = COPYING.LIB README acinclude.m4 aclocal.m4 \\\n+\t\tMakefile.am Makefile.in configure.ac configure \\\n+\t\tconfig-h.in config.guess config.sub \\\n+\t\tinstall-sh missing ltmain.sh \\\n+\t\tltdl.c ltdl.h\n+\n+all: config.h\n+\t$(MAKE) $(AM_MAKEFLAGS) all-am\n \n .SUFFIXES:\n .SUFFIXES: .c .lo .o .obj\n am--refresh:\n \t@:\n-$(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am  $(am__configure_deps)\n+$(srcdir)/Makefile.in:  $(srcdir)/Makefile.am  $(am__configure_deps)\n \t@for dep in $?; do \\\n \t  case '$(am__configure_deps)' in \\\n \t    *$$dep*) \\\n@@ -258,12 +264,27 @@ Makefile: $(srcdir)/Makefile.in $(top_builddir)/config.status\n $(top_builddir)/config.status: $(top_srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)\n \t$(SHELL) ./config.status --recheck\n \n-$(top_srcdir)/configure: @MAINTAINER_MODE_TRUE@ $(am__configure_deps)\n+$(top_srcdir)/configure:  $(am__configure_deps)\n \tcd $(srcdir) && $(AUTOCONF)\n-$(ACLOCAL_M4): @MAINTAINER_MODE_TRUE@ $(am__aclocal_m4_deps)\n+$(ACLOCAL_M4):  $(am__aclocal_m4_deps)\n \tcd $(srcdir) && $(ACLOCAL) $(ACLOCAL_AMFLAGS)\n-config.h: $(top_builddir)/config.status $(srcdir)/config-h.in\n-\tcd $(top_builddir) && $(SHELL) ./config.status $@\n+\n+config.h: stamp-h1\n+\t@if test ! -f $@; then \\\n+\t  rm -f stamp-h1; \\\n+\t  $(MAKE) stamp-h1; \\\n+\telse :; fi\n+\n+stamp-h1: $(srcdir)/config-h.in $(top_builddir)/config.status\n+\t@rm -f stamp-h1\n+\tcd $(top_builddir) && $(SHELL) ./config.status config.h\n+$(srcdir)/config-h.in:  $(am__configure_deps) \n+\tcd $(top_srcdir) && $(AUTOHEADER)\n+\trm -f stamp-h1\n+\ttouch $@\n+\n+distclean-hdr:\n+\t-rm -f config.h stamp-h1\n install-libLTLIBRARIES: $(lib_LTLIBRARIES)\n \t@$(NORMAL_INSTALL)\n \ttest -z \"$(libdir)\" || $(mkdir_p) \"$(DESTDIR)$(libdir)\"\n@@ -357,11 +378,11 @@ ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)\n \tmkid -fID $$unique\n tags: TAGS\n \n-TAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \\\n+TAGS:  $(HEADERS) $(SOURCES) config-h.in $(TAGS_DEPENDENCIES) \\\n \t\t$(TAGS_FILES) $(LISP)\n \ttags=; \\\n \there=`pwd`; \\\n-\tlist='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \\\n+\tlist='$(SOURCES) $(HEADERS) config-h.in $(LISP) $(TAGS_FILES)'; \\\n \tunique=`for i in $$list; do \\\n \t    if test -f \"$$i\"; then echo $$i; else echo $(srcdir)/$$i; fi; \\\n \t  done | \\\n@@ -373,11 +394,11 @@ TAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \\\n \t    $$tags $$unique; \\\n \tfi\n ctags: CTAGS\n-CTAGS:  $(HEADERS) $(SOURCES)  $(TAGS_DEPENDENCIES) \\\n+CTAGS:  $(HEADERS) $(SOURCES) config-h.in $(TAGS_DEPENDENCIES) \\\n \t\t$(TAGS_FILES) $(LISP)\n \ttags=; \\\n \there=`pwd`; \\\n-\tlist='$(SOURCES) $(HEADERS)  $(LISP) $(TAGS_FILES)'; \\\n+\tlist='$(SOURCES) $(HEADERS) config-h.in $(LISP) $(TAGS_FILES)'; \\\n \tunique=`for i in $$list; do \\\n \t    if test -f \"$$i\"; then echo $$i; else echo $(srcdir)/$$i; fi; \\\n \t  done | \\\n@@ -398,7 +419,6 @@ distclean-tags:\n distdir: $(DISTFILES)\n \t$(am__remove_distdir)\n \tmkdir $(distdir)\n-\t$(mkdir_p) $(distdir)/.\n \t@srcdirstrip=`echo \"$(srcdir)\" | sed 's|.|.|g'`; \\\n \ttopsrcdirstrip=`echo \"$(top_srcdir)\" | sed 's|.|.|g'`; \\\n \tlist='$(DISTFILES)'; for file in $$list; do \\\n@@ -524,7 +544,7 @@ distcleancheck: distclean\n \t       exit 1; } >&2\n check-am: all-am\n check: check-am\n-all-am: Makefile $(LTLIBRARIES) $(HEADERS)\n+all-am: Makefile $(LTLIBRARIES) $(HEADERS) config.h\n installdirs:\n \tfor dir in \"$(DESTDIR)$(libdir)\" \"$(DESTDIR)$(includedir)\"; do \\\n \t  test -z \"$$dir\" || $(mkdir_p) \"$$dir\"; \\\n@@ -563,7 +583,7 @@ distclean: distclean-am\n \t-rm -f $(am__CONFIG_DISTCLEAN_FILES)\n \t-rm -f Makefile\n distclean-am: clean-am distclean-compile distclean-generic \\\n-\tdistclean-libtool distclean-tags\n+\tdistclean-hdr distclean-libtool distclean-tags\n \n dvi: dvi-am\n \n@@ -575,7 +595,7 @@ info: info-am\n \n info-am:\n \n-install-data-am: install-includeHEADERS\n+install-data-am: install-data-local install-includeHEADERS\n \n install-exec-am: install-libLTLIBRARIES\n \n@@ -611,10 +631,11 @@ uninstall-am: uninstall-includeHEADERS uninstall-info-am \\\n \tclean-generic clean-libLTLIBRARIES clean-libtool \\\n \tclean-noinstLTLIBRARIES ctags dist dist-all dist-bzip2 \\\n \tdist-gzip dist-shar dist-tarZ dist-zip distcheck distclean \\\n-\tdistclean-compile distclean-generic distclean-libtool \\\n-\tdistclean-tags distcleancheck distdir distuninstallcheck dvi \\\n-\tdvi-am html html-am info info-am install install-am \\\n-\tinstall-data install-data-am install-exec install-exec-am \\\n+\tdistclean-compile distclean-generic distclean-hdr \\\n+\tdistclean-libtool distclean-tags distcleancheck distdir \\\n+\tdistuninstallcheck dvi dvi-am html html-am info info-am \\\n+\tinstall install-am install-data install-data-am \\\n+\tinstall-data-local install-exec install-exec-am \\\n \tinstall-includeHEADERS install-info install-info-am \\\n \tinstall-libLTLIBRARIES install-man install-strip installcheck \\\n \tinstallcheck-am installdirs maintainer-clean \\\n@@ -630,18 +651,11 @@ $(libltdl_la_OBJECTS) $(libltdlc_la_OBJECTS): libtool\n libtool: $(LIBTOOL_DEPS)\n \t$(SHELL) ./config.status --recheck\n \n-local-install-files: $(DISTFILES)\n-\t-rm -rf $(DESTDIR)$(datadir)/libtool/libltdl\n-\t$(mkinstalldirs) $(DESTDIR)$(datadir)/libtool/libltdl\n-\t@for file in $(DISTFILES); do \\\n-\t  d=$(srcdir); \\\n-\t  if test -d $$d/$$file; then \\\n-\t    cp -r $$d/$$file $(DESTDIR)$(datadir)/libtool/libltdl/$$file; \\\n-\t  else \\\n-\t    test -f $(DESTDIR)$(datadir)/libtool/libltdl/$$file \\\n-\t    || cp $$d/$$file $(DESTDIR)$(datadir)/libtool/libltdl/$$file || :; \\\n-\t  fi; \\\n-\tdone\n+install-data-local:\n+\t-rm -rf $(DESTDIR)$(ltdldatadir)\n+\t$(mkinstalldirs) $(DESTDIR)$(ltdldatadir)\n+\t( cd $(srcdir) && $(AMTAR) chf - $(ltdldatafiles); ) \\\n+\t  | ( umask 0 && cd $(DESTDIR)$(ltdldatadir) && $(AMTAR) xf -; )\n # Tell versions [3.59,3.63) of GNU make to not export all variables.\n # Otherwise a system limit (for SysV at least) may be exceeded.\n .NOEXPORT:"}, {"sha": "e3ae5aea4a780bef2e52d6974cf1df5759c6259c", "filename": "libjava/libltdl/acinclude.m4", "status": "modified", "additions": 662, "deletions": 376, "changes": 1038, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Facinclude.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Facinclude.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Facinclude.m4?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -1,26 +1,11 @@\n # libtool.m4 - Configure libtool for the host system. -*-Autoconf-*-\n-## Copyright 1996, 1997, 1998, 1999, 2000, 2001\n+## Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005\n ## Free Software Foundation, Inc.\n ## Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996\n ##\n-## This program is free software; you can redistribute it and/or modify\n-## it under the terms of the GNU General Public License as published by\n-## the Free Software Foundation; either version 2 of the License, or\n-## (at your option) any later version.\n-##\n-## This program is distributed in the hope that it will be useful, but\n-## WITHOUT ANY WARRANTY; without even the implied warranty of\n-## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n-## General Public License for more details.\n-##\n-## You should have received a copy of the GNU General Public License\n-## along with this program; if not, write to the Free Software\n-## Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n-##\n-## As a special exception to the GNU General Public License, if you\n-## distribute this file as part of a program that contains a\n-## configuration script generated by Autoconf, you may include it under\n-## the same distribution terms that you use for the rest of that program.\n+## This file is free software; the Free Software Foundation gives\n+## unlimited permission to copy and/or distribute it, with or without\n+## modifications, as long as this notice is preserved.\n \n # serial 47 AC_PROG_LIBTOOL\n \n@@ -132,7 +117,7 @@ esac\n \n # Sed substitution that helps us do robust quoting.  It backslashifies\n # metacharacters that are still active within double-quoted strings.\n-Xsed='sed -e s/^X//'\n+Xsed='sed -e 1s/^X//'\n [sed_quote_subst='s/\\([\\\\\"\\\\`$\\\\\\\\]\\)/\\\\\\1/g']\n \n # Same as above, but do not quote variable references.\n@@ -200,6 +185,8 @@ if test -n \"$RANLIB\"; then\n   old_archive_cmds=\"$old_archive_cmds~\\$RANLIB \\$oldlib\"\n fi\n \n+_LT_CC_BASENAME([$compiler])\n+\n # Only perform the check for file, if the check method requires it\n case $deplibs_check_method in\n file_magic*)\n@@ -245,6 +232,48 @@ compiler=$CC\n ])# _LT_AC_SYS_COMPILER\n \n \n+# _LT_CC_BASENAME(CC)\n+# -------------------\n+# Calculate cc_basename.  Skip known compiler wrappers and cross-prefix.\n+AC_DEFUN([_LT_CC_BASENAME],\n+[for cc_temp in $1\"\"; do\n+  case $cc_temp in\n+    compile | *[[\\\\/]]compile | ccache | *[[\\\\/]]ccache ) ;;\n+    distcc | *[[\\\\/]]distcc | purify | *[[\\\\/]]purify ) ;;\n+    \\-*) ;;\n+    *) break;;\n+  esac\n+done\n+cc_basename=`$echo \"X$cc_temp\" | $Xsed -e 's%.*/%%' -e \"s%^$host_alias-%%\"`\n+])\n+\n+\n+# _LT_COMPILER_BOILERPLATE\n+# ------------------------\n+# Check for compiler boilerplate output or warnings with\n+# the simple compiler test code.\n+AC_DEFUN([_LT_COMPILER_BOILERPLATE],\n+[ac_outfile=conftest.$ac_objext\n+printf \"$lt_simple_compile_test_code\" >conftest.$ac_ext\n+eval \"$ac_compile\" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err\n+_lt_compiler_boilerplate=`cat conftest.err`\n+$rm conftest*\n+])# _LT_COMPILER_BOILERPLATE\n+\n+\n+# _LT_LINKER_BOILERPLATE\n+# ----------------------\n+# Check for linker boilerplate output or warnings with\n+# the simple link test code.\n+AC_DEFUN([_LT_LINKER_BOILERPLATE],\n+[ac_outfile=conftest.$ac_objext\n+printf \"$lt_simple_link_test_code\" >conftest.$ac_ext\n+eval \"$ac_link\" 2>&1 >/dev/null | $SED '/^$/d' >conftest.err\n+_lt_linker_boilerplate=`cat conftest.err`\n+$rm conftest*\n+])# _LT_LINKER_BOILERPLATE\n+\n+\n # _LT_AC_SYS_LIBPATH_AIX\n # ----------------------\n # Links a minimal program and checks the executable\n@@ -317,7 +346,7 @@ fi\n \n # The HP-UX ksh and POSIX shell print the target directory to stdout\n # if CDPATH is set.\n-if test \"X${CDPATH+set}\" = Xset; then CDPATH=:; export CDPATH; fi\n+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH\n \n if test -z \"$ECHO\"; then\n if test \"X${echo_test_string+set}\" != Xset; then\n@@ -500,7 +529,7 @@ x86_64-*linux*|ppc*-*linux*|powerpc*-*linux*|s390*-*linux*|sparc*-*linux*)\n         x86_64-*linux*)\n           LD=\"${LD-ld} -m elf_i386\"\n           ;;\n-        ppc64-*linux*)\n+        ppc64-*linux*|powerpc64-*linux*)\n           LD=\"${LD-ld} -m elf32ppclinux\"\n           ;;\n         s390x-*linux*)\n@@ -564,7 +593,8 @@ need_locks=\"$enable_libtool_lock\"\n # ----------------------------------------------------------------\n # Check whether the given compiler option works\n AC_DEFUN([AC_LIBTOOL_COMPILER_OPTION],\n-[AC_CACHE_CHECK([$1], [$2],\n+[AC_REQUIRE([LT_AC_PROG_SED])\n+AC_CACHE_CHECK([$1], [$2],\n   [$2=no\n   ifelse([$4], , [ac_outfile=conftest.$ac_objext], [ac_outfile=$4])\n    printf \"$lt_simple_compile_test_code\" > conftest.$ac_ext\n@@ -585,8 +615,10 @@ AC_DEFUN([AC_LIBTOOL_COMPILER_OPTION],\n    echo \"$as_me:__oline__: \\$? = $ac_status\" >&AS_MESSAGE_LOG_FD\n    if (exit $ac_status) && test -s \"$ac_outfile\"; then\n      # The compiler can only warn and ignore the option if not recognized\n-     # So say no if there are warnings\n-     if test ! -s conftest.err; then\n+     # So say no if there are warnings other than the usual output.\n+     $echo \"X$_lt_compiler_boilerplate\" | $Xsed >conftest.exp\n+     $SED '/^$/d' conftest.err >conftest.er2\n+     if test ! -s conftest.err || diff conftest.exp conftest.er2 >/dev/null; then\n        $2=yes\n      fi\n    fi\n@@ -617,6 +649,11 @@ AC_DEFUN([AC_LIBTOOL_LINKER_OPTION],\n      if test -s conftest.err; then\n        # Append any errors to the config.log.\n        cat conftest.err 1>&AS_MESSAGE_LOG_FD\n+       $echo \"X$_lt_linker_boilerplate\" | $Xsed > conftest.exp\n+       $SED '/^$/d' conftest.err >conftest.er2\n+       if diff conftest.exp conftest.er2 >/dev/null; then\n+         $2=yes\n+       fi\n      else\n        $2=yes\n      fi\n@@ -640,7 +677,7 @@ AC_DEFUN([AC_LIBTOOL_SYS_MAX_CMD_LEN],\n AC_MSG_CHECKING([the maximum length of command line arguments])\n AC_CACHE_VAL([lt_cv_sys_max_cmd_len], [dnl\n   i=0\n-  testring=\"ABCD\"\n+  teststring=\"ABCD\"\n \n   case $build_os in\n   msdosdjgpp*)\n@@ -669,20 +706,53 @@ AC_CACHE_VAL([lt_cv_sys_max_cmd_len], [dnl\n     lt_cv_sys_max_cmd_len=8192;\n     ;;\n \n- *)\n+  amigaos*)\n+    # On AmigaOS with pdksh, this test takes hours, literally.\n+    # So we just punt and use a minimum line length of 8192.\n+    lt_cv_sys_max_cmd_len=8192;\n+    ;;\n+\n+  netbsd* | freebsd* | openbsd* | darwin* | dragonfly*)\n+    # This has been around since 386BSD, at least.  Likely further.\n+    if test -x /sbin/sysctl; then\n+      lt_cv_sys_max_cmd_len=`/sbin/sysctl -n kern.argmax`\n+    elif test -x /usr/sbin/sysctl; then\n+      lt_cv_sys_max_cmd_len=`/usr/sbin/sysctl -n kern.argmax`\n+    else\n+      lt_cv_sys_max_cmd_len=65536 # usable default for *BSD\n+    fi\n+    # And add a safety zone\n+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \\/ 4`\n+    lt_cv_sys_max_cmd_len=`expr $lt_cv_sys_max_cmd_len \\* 3`\n+    ;;\n+  osf*)\n+    # Dr. Hans Ekkehard Plesser reports seeing a kernel panic running configure\n+    # due to this test when exec_disable_arg_limit is 1 on Tru64. It is not\n+    # nice to cause kernel panics so lets avoid the loop below.\n+    # First set a reasonable default.\n+    lt_cv_sys_max_cmd_len=16384\n+    # \n+    if test -x /sbin/sysconfig; then\n+      case `/sbin/sysconfig -q proc exec_disable_arg_limit` in\n+        *1*) lt_cv_sys_max_cmd_len=-1 ;;\n+      esac\n+    fi\n+    ;;\n+  *)\n     # If test is not a shell built-in, we'll probably end up computing a\n     # maximum length that is only half of the actual maximum length, but\n     # we can't tell.\n-    while (test \"X\"`$CONFIG_SHELL [$]0 --fallback-echo \"X$testring\" 2>/dev/null` \\\n-\t       = \"XX$testring\") >/dev/null 2>&1 &&\n-\t    new_result=`expr \"X$testring\" : \".*\" 2>&1` &&\n+    SHELL=${SHELL-${CONFIG_SHELL-/bin/sh}}\n+    while (test \"X\"`$SHELL [$]0 --fallback-echo \"X$teststring\" 2>/dev/null` \\\n+\t       = \"XX$teststring\") >/dev/null 2>&1 &&\n+\t    new_result=`expr \"X$teststring\" : \".*\" 2>&1` &&\n \t    lt_cv_sys_max_cmd_len=$new_result &&\n \t    test $i != 17 # 1/2 MB should be enough\n     do\n       i=`expr $i + 1`\n-      testring=$testring$testring\n+      teststring=$teststring$teststring\n     done\n-    testring=\n+    teststring=\n     # Add a significant safety factor because C++ compilers can tack on massive\n     # amounts of additional arguments before passing them to the linker.\n     # It appears as though 1/2 is a usable value.\n@@ -832,7 +902,7 @@ else\n     lt_cv_dlopen_self=yes\n     ])\n    ;;\n-    \n+\n   *)\n     AC_CHECK_FUNC([shl_load],\n \t  [lt_cv_dlopen=\"shl_load\"],\n@@ -921,13 +991,6 @@ AC_CACHE_CHECK([if $compiler supports -c -o file.$ac_objext],\n    mkdir out\n    printf \"$lt_simple_compile_test_code\" > conftest.$ac_ext\n \n-   # According to Tom Tromey, Ian Lance Taylor reported there are C compilers\n-   # that will create temporary files in the current directory regardless of\n-   # the output directory.  Thus, making CWD read-only will cause this test\n-   # to fail, enabling locking or at least warning the user not to do parallel\n-   # builds.\n-   chmod -w .\n-\n    lt_compiler_flag=\"-o out/conftest2.$ac_objext\"\n    # Insert the option either (1) after the last *FLAGS variable, or\n    # (2) before a word containing \"conftest.\", or (3) at the end.\n@@ -946,13 +1009,18 @@ AC_CACHE_CHECK([if $compiler supports -c -o file.$ac_objext],\n    then\n      # The compiler can only warn and ignore the option if not recognized\n      # So say no if there are warnings\n-     if test ! -s out/conftest.err; then\n+     $echo \"X$_lt_compiler_boilerplate\" | $Xsed > out/conftest.exp\n+     $SED '/^$/d' out/conftest.err >out/conftest.er2\n+     if test ! -s out/conftest.err || diff out/conftest.exp out/conftest.er2 >/dev/null; then\n        _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=yes\n      fi\n    fi\n    chmod u+w .\n-   $rm conftest* out/*\n-   rmdir out\n+   $rm conftest*\n+   # SGI C++ compiler will create directory out/ii_files/ for\n+   # template instantiation\n+   test -d out/ii_files && $rm out/ii_files/* && rmdir out/ii_files\n+   $rm out/* && rmdir out\n    cd ..\n    rmdir conftest\n    $rm conftest*\n@@ -1011,8 +1079,8 @@ AC_DEFUN([AC_LIBTOOL_PROG_LD_HARDCODE_LIBPATH],\n [AC_MSG_CHECKING([how to hardcode library paths into programs])\n _LT_AC_TAGVAR(hardcode_action, $1)=\n if test -n \"$_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)\" || \\\n-   test -n \"$_LT_AC_TAGVAR(runpath_var $1)\" || \\\n-   test \"X$_LT_AC_TAGVAR(hardcode_automatic, $1)\"=\"Xyes\" ; then\n+   test -n \"$_LT_AC_TAGVAR(runpath_var, $1)\" || \\\n+   test \"X$_LT_AC_TAGVAR(hardcode_automatic, $1)\" = \"Xyes\" ; then\n \n   # We can hardcode non-existant directories.\n   if test \"$_LT_AC_TAGVAR(hardcode_direct, $1)\" != no &&\n@@ -1069,7 +1137,7 @@ fi\n    *)\n   AC_MSG_RESULT([no])\n     ;;\n-  esac  \n+  esac\n fi\n ])# AC_LIBTOOL_SYS_LIB_STRIP\n \n@@ -1082,7 +1150,7 @@ AC_DEFUN([AC_LIBTOOL_SYS_DYNAMIC_LINKER],\n library_names_spec=\n libname_spec='lib$name'\n soname_spec=\n-shrext=\".so\"\n+shrext_cmds=\".so\"\n postinstall_cmds=\n postuninstall_cmds=\n finish_cmds=\n@@ -1170,7 +1238,7 @@ aix4* | aix5*)\n amigaos*)\n   library_names_spec='$libname.ixlibrary $libname.a'\n   # Create ${libname}_ixlibrary.a entries in /sys/libs.\n-  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo \"X$lib\" | $Xsed -e '\\''s%^.*/\\([[^/]]*\\)\\.ixlibrary$%\\1%'\\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show \"(cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a)\"; (cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a) || exit 1; done'\n+  finish_eval='for lib in `ls $libdir/*.ixlibrary 2>/dev/null`; do libname=`$echo \"X$lib\" | $Xsed -e '\\''s%^.*/\\([[^/]]*\\)\\.ixlibrary$%\\1%'\\''`; test $rm /sys/libs/${libname}_ixlibrary.a; $show \"cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a\"; cd /sys/libs && $LN_S $lib ${libname}_ixlibrary.a || exit 1; done'\n   ;;\n \n beos*)\n@@ -1179,7 +1247,7 @@ beos*)\n   shlibpath_var=LIBRARY_PATH\n   ;;\n \n-bsdi4*)\n+bsdi[[45]]*)\n   version_type=linux\n   need_version=no\n   library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major $libname${shared_ext}'\n@@ -1195,7 +1263,7 @@ bsdi4*)\n \n cygwin* | mingw* | pw32*)\n   version_type=windows\n-  shrext=\".dll\"\n+  shrext_cmds=\".dll\"\n   need_version=no\n   need_lib_prefix=no\n \n@@ -1217,7 +1285,7 @@ cygwin* | mingw* | pw32*)\n     cygwin*)\n       # Cygwin DLLs use 'cyg' prefix rather than 'lib'\n       soname_spec='`echo ${libname} | sed -e 's/^lib/cyg/'``echo ${release} | $SED -e 's/[[.]]/-/g'`${versuffix}${shared_ext}'\n-      sys_lib_search_path_spec=\"/lib /lib/w32api /usr/lib /usr/local/lib\"\n+      sys_lib_search_path_spec=\"/usr/lib /lib/w32api /lib /usr/local/lib\"\n       ;;\n     mingw*)\n       # MinGW DLLs use traditional 'lib' prefix\n@@ -1237,7 +1305,7 @@ cygwin* | mingw* | pw32*)\n       ;;\n     pw32*)\n       # pw32 DLLs use 'pw' prefix rather than 'lib'\n-      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[.]/-/g'`${versuffix}${shared_ext}'\n+      library_names_spec='`echo ${libname} | sed -e 's/^lib/pw/'``echo ${release} | $SED -e 's/[[.]]/-/g'`${versuffix}${shared_ext}'\n       ;;\n     esac\n     ;;\n@@ -1256,17 +1324,16 @@ darwin* | rhapsody*)\n   version_type=darwin\n   need_lib_prefix=no\n   need_version=no\n-  # FIXME: Relying on posixy $() will cause problems for\n-  #        cross-compilation, but unfortunately the echo tests do not\n-  #        yet detect zsh echo's removal of \\ escapes.\n   library_names_spec='${libname}${release}${versuffix}$shared_ext ${libname}${release}${major}$shared_ext ${libname}$shared_ext'\n   soname_spec='${libname}${release}${major}$shared_ext'\n   shlibpath_overrides_runpath=yes\n   shlibpath_var=DYLD_LIBRARY_PATH\n-  shrext='$(test .$module = .yes && echo .so || echo .dylib)'\n+  shrext_cmds='$(test .$module = .yes && echo .so || echo .dylib)'\n   # Apple's gcc prints 'gcc -print-search-dirs' doesn't operate the same.\n-  if $CC -v 2>&1 | grep 'Apple' >/dev/null ; then \n-  sys_lib_search_path_spec=`$CC -print-search-dirs | tr \"\\n\" \"$PATH_SEPARATOR\" | sed -e 's/libraries:/@libraries:/' | tr \"@\" \"\\n\" | grep \"^libraries:\" | sed -e \"s/^libraries://\" -e \"s,=/,/,g\" -e \"s,$PATH_SEPARATOR, ,g\" -e \"s,.*,& /lib /usr/lib /usr/local/lib,g\"`\n+  if test \"$GCC\" = yes; then\n+    sys_lib_search_path_spec=`$CC -print-search-dirs | tr \"\\n\" \"$PATH_SEPARATOR\" | sed -e 's/libraries:/@libraries:/' | tr \"@\" \"\\n\" | grep \"^libraries:\" | sed -e \"s/^libraries://\" -e \"s,=/,/,g\" -e \"s,$PATH_SEPARATOR, ,g\" -e \"s,.*,& /lib /usr/lib /usr/local/lib,g\"`\n+  else\n+    sys_lib_search_path_spec='/lib /usr/lib /usr/local/lib'\n   fi\n   sys_lib_dlsearch_path_spec='/usr/local/lib /lib /usr/lib'\n   ;;\n@@ -1284,7 +1351,21 @@ freebsd1*)\n   dynamic_linker=no\n   ;;\n \n-freebsd*)\n+kfreebsd*-gnu)\n+  version_type=linux\n+  need_lib_prefix=no\n+  need_version=no\n+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'\n+  soname_spec='${libname}${release}${shared_ext}$major'\n+  shlibpath_var=LD_LIBRARY_PATH\n+  shlibpath_overrides_runpath=no\n+  hardcode_into_libs=yes\n+  dynamic_linker='GNU ld.so'\n+  ;;\n+\n+freebsd* | dragonfly*)\n+  # DragonFly does not have aout.  When/if they implement a new\n+  # versioning mechanism, adjust this.\n   objformat=`test -x /usr/bin/objformat && /usr/bin/objformat || echo aout`\n   version_type=freebsd-$objformat\n   case $version_type in\n@@ -1303,7 +1384,7 @@ freebsd*)\n   freebsd2*)\n     shlibpath_overrides_runpath=yes\n     ;;\n-  freebsd3.[01]* | freebsdelf3.[01]*)\n+  freebsd3.[[01]]* | freebsdelf3.[[01]]*)\n     shlibpath_overrides_runpath=yes\n     hardcode_into_libs=yes\n     ;;\n@@ -1332,7 +1413,7 @@ hpux9* | hpux10* | hpux11*)\n   need_version=no\n   case \"$host_cpu\" in\n   ia64*)\n-    shrext='.so'\n+    shrext_cmds='.so'\n     hardcode_into_libs=yes\n     dynamic_linker=\"$host_os dld.so\"\n     shlibpath_var=LD_LIBRARY_PATH\n@@ -1347,7 +1428,7 @@ hpux9* | hpux10* | hpux11*)\n     sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec\n     ;;\n    hppa*64*)\n-     shrext='.sl'\n+     shrext_cmds='.sl'\n      hardcode_into_libs=yes\n      dynamic_linker=\"$host_os dld.sl\"\n      shlibpath_var=LD_LIBRARY_PATH # How should we handle SHLIB_PATH\n@@ -1358,7 +1439,7 @@ hpux9* | hpux10* | hpux11*)\n      sys_lib_dlsearch_path_spec=$sys_lib_search_path_spec\n      ;;\n    *)\n-    shrext='.sl'\n+    shrext_cmds='.sl'\n     dynamic_linker=\"$host_os dld.sl\"\n     shlibpath_var=SHLIB_PATH\n     shlibpath_overrides_runpath=no # +s is required to enable SHLIB_PATH\n@@ -1427,6 +1508,29 @@ linux*)\n   # before this can be enabled.\n   hardcode_into_libs=yes\n \n+  # find out which ABI we are using\n+  libsuff=\n+  case \"$host_cpu\" in\n+  x86_64*|s390x*|powerpc64*)\n+    echo '[#]line __oline__ \"configure\"' > conftest.$ac_ext\n+    if AC_TRY_EVAL(ac_compile); then\n+      case `/usr/bin/file conftest.$ac_objext` in\n+      *64-bit*)\n+        libsuff=64\n+        sys_lib_search_path_spec=\"/lib${libsuff} /usr/lib${libsuff} /usr/local/lib${libsuff}\"\n+        ;;\n+      esac\n+    fi\n+    rm -rf conftest*\n+    ;;\n+  esac\n+\n+  # Append ld.so.conf contents to the search path\n+  if test -f /etc/ld.so.conf; then\n+    lt_ld_extra=`awk '/^include / { system(sprintf(\"cd /etc; cat %s\", \\[$]2)); skip = 1; } { if (!skip) print \\[$]0; skip = 0; }' < /etc/ld.so.conf | $SED -e 's/#.*//;s/[:,\\t]/ /g;s/=[^=]*$//;s/=[^= ]* / /g;/^$/d' | tr '\\n' ' '`\n+    sys_lib_dlsearch_path_spec=\"/lib${libsuff} /usr/lib${libsuff} $lt_ld_extra\"\n+  fi\n+\n   # We used to test for /lib/ld.so.1 and disable shared libraries on\n   # powerpc, because MkLinux only supported shared libraries with the\n   # GNU dynamic linker.  Since this was broken with cross compilers,\n@@ -1436,6 +1540,18 @@ linux*)\n   dynamic_linker='GNU/Linux ld.so'\n   ;;\n \n+knetbsd*-gnu)\n+  version_type=linux\n+  need_lib_prefix=no\n+  need_version=no\n+  library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'\n+  soname_spec='${libname}${release}${shared_ext}$major'\n+  shlibpath_var=LD_LIBRARY_PATH\n+  shlibpath_overrides_runpath=no\n+  hardcode_into_libs=yes\n+  dynamic_linker='GNU ld.so'\n+  ;;\n+\n netbsd*)\n   version_type=sunos\n   need_lib_prefix=no\n@@ -1445,7 +1561,7 @@ netbsd*)\n     finish_cmds='PATH=\"\\$PATH:/sbin\" ldconfig -m $libdir'\n     dynamic_linker='NetBSD (a.out) ld.so'\n   else\n-    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${release}${shared_ext} ${libname}${shared_ext}'\n+    library_names_spec='${libname}${release}${shared_ext}$versuffix ${libname}${release}${shared_ext}$major ${libname}${shared_ext}'\n     soname_spec='${libname}${release}${shared_ext}$major'\n     dynamic_linker='NetBSD ld.elf_so'\n   fi\n@@ -1461,7 +1577,7 @@ newsos6)\n   shlibpath_overrides_runpath=yes\n   ;;\n \n-nto-qnx)\n+nto-qnx*)\n   version_type=linux\n   need_lib_prefix=no\n   need_version=no\n@@ -1494,7 +1610,7 @@ openbsd*)\n \n os2*)\n   libname_spec='$name'\n-  shrext=\".dll\"\n+  shrext_cmds=\".dll\"\n   need_lib_prefix=no\n   library_names_spec='$libname${shared_ext} $libname.a'\n   dynamic_linker='OS/2 ld.exe'\n@@ -1640,7 +1756,9 @@ if test -f \"$ltmain\" && test -n \"$tagnames\"; then\n \n       case $tagname in\n       CXX)\n-\tif test -n \"$CXX\" && test \"X$CXX\" != \"Xno\"; then\n+\tif test -n \"$CXX\" && ( test \"X$CXX\" != \"Xno\" &&\n+\t    ( (test \"X$CXX\" = \"Xg++\" && `g++ -v >/dev/null 2>&1` ) ||\n+\t    (test \"X$CXX\" != \"Xg++\"))) ; then\n \t  AC_LIBTOOL_LANG_CXX_CONFIG\n \telse\n \t  tagname=\"\"\n@@ -1930,7 +2048,7 @@ fi\n \n # AC_PROG_LD\n # ----------\n-# find the path to the GNU or non-GNU linker\n+# find the pathname to the GNU or non-GNU linker\n AC_DEFUN([AC_PROG_LD],\n [AC_ARG_WITH([gnu-ld],\n     [AC_HELP_STRING([--with-gnu-ld],\n@@ -1956,7 +2074,7 @@ if test \"$GCC\" = yes; then\n     # Accept absolute paths.\n     [[\\\\/]]* | ?:[[\\\\/]]*)\n       re_direlt='/[[^/]][[^/]]*/\\.\\./'\n-      # Canonicalize the path of ld\n+      # Canonicalize the pathname of ld\n       ac_prog=`echo $ac_prog| $SED 's%\\\\\\\\%/%g'`\n       while echo $ac_prog | grep \"$re_direlt\" > /dev/null 2>&1; do\n \tac_prog=`echo $ac_prog| $SED \"s%$re_direlt%/%\"`\n@@ -2019,7 +2137,7 @@ AC_DEFUN([AC_PROG_LD_GNU],\n [AC_REQUIRE([AC_PROG_EGREP])dnl\n AC_CACHE_CHECK([if the linker ($LD) is GNU ld], lt_cv_prog_gnu_ld,\n [# I'd rather use --version here, but apparently some GNU ld's only accept -v.\n-case `\"$LD\" -v 2>&1 </dev/null` in\n+case `$LD -v 2>&1 </dev/null` in\n *GNU* | *'with BFD'*)\n   lt_cv_prog_gnu_ld=yes\n   ;;\n@@ -2045,6 +2163,15 @@ case $reload_flag in\n *) reload_flag=\" $reload_flag\" ;;\n esac\n reload_cmds='$LD$reload_flag -o $output$reload_objs'\n+case $host_os in\n+  darwin*)\n+    if test \"$GCC\" = yes; then\n+      reload_cmds='$CC -nostdlib ${wl}-r -o $output$reload_objs'\n+    else\n+      reload_cmds='$LD$reload_flag -o $output$reload_objs'\n+    fi\n+    ;;\n+esac\n ])# AC_PROG_LD_RELOAD_FLAG\n \n \n@@ -2078,40 +2205,36 @@ beos*)\n   lt_cv_deplibs_check_method=pass_all\n   ;;\n \n-bsdi4*)\n+bsdi[[45]]*)\n   lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[ML]]SB (shared object|dynamic lib)'\n   lt_cv_file_magic_cmd='/usr/bin/file -L'\n   lt_cv_file_magic_test_file=/shlib/libc.so\n   ;;\n \n-cygwin* | mingw* | pw32*)\n-  # win32_libid is a shell function defined in ltmain.sh\n+cygwin*)\n+  # func_win32_libid is a shell function defined in ltmain.sh\n   lt_cv_deplibs_check_method='file_magic ^x86 archive import|^x86 DLL'\n-  lt_cv_file_magic_cmd='win32_libid'\n+  lt_cv_file_magic_cmd='func_win32_libid'\n+  ;;\n+\n+mingw* | pw32*)\n+  # Base MSYS/MinGW do not provide the 'file' command needed by\n+  # func_win32_libid shell function, so use a weaker test based on 'objdump'.\n+  lt_cv_deplibs_check_method='file_magic file format pei*-i386(.*architecture: i386)?'\n+  lt_cv_file_magic_cmd='$OBJDUMP -f'\n   ;;\n \n darwin* | rhapsody*)\n-  # this will be overwritten by pass_all, but leave it in just in case\n-  lt_cv_deplibs_check_method='file_magic Mach-O dynamically linked shared library'\n-  lt_cv_file_magic_cmd='/usr/bin/file -L'\n-  case \"$host_os\" in\n-  rhapsody* | darwin1.[[012]])\n-    lt_cv_file_magic_test_file=`/System/Library/Frameworks/System.framework/System`\n-    ;;\n-  *) # Darwin 1.3 on\n-    lt_cv_file_magic_test_file='/usr/lib/libSystem.dylib'\n-    ;;\n-  esac\n   lt_cv_deplibs_check_method=pass_all\n   ;;\n \n-freebsd*)\n+freebsd* | kfreebsd*-gnu | dragonfly*)\n   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then\n     case $host_cpu in\n     i*86 )\n       # Not sure whether the presence of OpenBSD here was a mistake.\n       # Let's accept both of them until this is cleared up.\n-      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD)/i[[3-9]]86 (compact )?demand paged shared library'\n+      lt_cv_deplibs_check_method='file_magic (FreeBSD|OpenBSD|DragonFly)/i[[3-9]]86 (compact )?demand paged shared library'\n       lt_cv_file_magic_cmd=/usr/bin/file\n       lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`\n       ;;\n@@ -2144,36 +2267,18 @@ hpux10.20* | hpux11*)\n   ;;\n \n irix5* | irix6* | nonstopux*)\n-  case $host_os in\n-  irix5* | nonstopux*)\n-    # this will be overridden with pass_all, but let us keep it just in case\n-    lt_cv_deplibs_check_method=\"file_magic ELF 32-bit MSB dynamic lib MIPS - version 1\"\n-    ;;\n-  *)\n-    case $LD in\n-    *-32|*\"-32 \") libmagic=32-bit;;\n-    *-n32|*\"-n32 \") libmagic=N32;;\n-    *-64|*\"-64 \") libmagic=64-bit;;\n-    *) libmagic=never-match;;\n-    esac\n-    # this will be overridden with pass_all, but let us keep it just in case\n-    lt_cv_deplibs_check_method=\"file_magic ELF ${libmagic} MSB mips-[[1234]] dynamic lib MIPS - version 1\"\n-    ;;\n+  case $LD in\n+  *-32|*\"-32 \") libmagic=32-bit;;\n+  *-n32|*\"-n32 \") libmagic=N32;;\n+  *-64|*\"-64 \") libmagic=64-bit;;\n+  *) libmagic=never-match;;\n   esac\n-  lt_cv_file_magic_test_file=`echo /lib${libsuff}/libc.so*`\n   lt_cv_deplibs_check_method=pass_all\n   ;;\n \n # This must be Linux ELF.\n linux*)\n-  case $host_cpu in\n-  alpha* | hppa* | i*86 | ia64* | m68* | mips | mipsel | powerpc* | sparc* | s390* | sh*)\n-    lt_cv_deplibs_check_method=pass_all ;;\n-  *)\n-    # glibc up to 2.1.1 does not perform some relocations on ARM\n-    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB (shared object|dynamic lib )' ;;\n-  esac\n-  lt_cv_file_magic_test_file=`echo /lib/libc.so* /lib/libc-*.so`\n+  lt_cv_deplibs_check_method=pass_all\n   ;;\n \n netbsd*)\n@@ -2190,24 +2295,19 @@ newos6*)\n   lt_cv_file_magic_test_file=/usr/lib/libnls.so\n   ;;\n \n-nto-qnx)\n+nto-qnx*)\n   lt_cv_deplibs_check_method=unknown\n   ;;\n \n openbsd*)\n-  lt_cv_file_magic_cmd=/usr/bin/file\n-  lt_cv_file_magic_test_file=`echo /usr/lib/libc.so.*`\n   if test -z \"`echo __ELF__ | $CC -E - | grep __ELF__`\" || test \"$host_os-$host_cpu\" = \"openbsd2.8-powerpc\"; then\n-    lt_cv_deplibs_check_method='file_magic ELF [[0-9]][[0-9]]*-bit [[LM]]SB shared object'\n+    lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\\.so\\.[[0-9]]+\\.[[0-9]]+|\\.so|_pic\\.a)$'\n   else\n-    lt_cv_deplibs_check_method='file_magic OpenBSD.* shared library'\n+    lt_cv_deplibs_check_method='match_pattern /lib[[^/]]+(\\.so\\.[[0-9]]+\\.[[0-9]]+|_pic\\.a)$'\n   fi\n   ;;\n \n osf3* | osf4* | osf5*)\n-  # this will be overridden with pass_all, but let us keep it just in case\n-  lt_cv_deplibs_check_method='file_magic COFF format alpha shared library'\n-  lt_cv_file_magic_test_file=/shlib/libc.so\n   lt_cv_deplibs_check_method=pass_all\n   ;;\n \n@@ -2217,7 +2317,6 @@ sco3.2v5*)\n \n solaris*)\n   lt_cv_deplibs_check_method=pass_all\n-  lt_cv_file_magic_test_file=/lib/libc.so\n   ;;\n \n sysv4 | sysv4.2uw2* | sysv4.3* | sysv5*)\n@@ -2257,7 +2356,7 @@ test -z \"$deplibs_check_method\" && deplibs_check_method=unknown\n \n # AC_PROG_NM\n # ----------\n-# find the path to a BSD-compatible name lister\n+# find the pathname to a BSD-compatible name lister\n AC_DEFUN([AC_PROG_NM],\n [AC_CACHE_CHECK([for BSD-compatible nm], lt_cv_path_NM,\n [if test -n \"$NM\"; then\n@@ -2394,10 +2493,21 @@ AC_DEFUN([AC_LIBTOOL_CXX],\n # ---------------\n AC_DEFUN([_LT_AC_LANG_CXX],\n [AC_REQUIRE([AC_PROG_CXX])\n-AC_REQUIRE([AC_PROG_CXXCPP])\n-_LT_AC_SHELL_INIT([tagnames=`echo \"$tagnames,CXX\" | sed 's/^,//'`])\n+AC_REQUIRE([_LT_AC_PROG_CXXCPP])\n+_LT_AC_SHELL_INIT([tagnames=${tagnames+${tagnames},}CXX])\n ])# _LT_AC_LANG_CXX\n \n+# _LT_AC_PROG_CXXCPP\n+# ---------------\n+AC_DEFUN([_LT_AC_PROG_CXXCPP],\n+[\n+AC_REQUIRE([AC_PROG_CXX])\n+if test -n \"$CXX\" && ( test \"X$CXX\" != \"Xno\" &&\n+    ( (test \"X$CXX\" = \"Xg++\" && `g++ -v >/dev/null 2>&1` ) ||\n+    (test \"X$CXX\" != \"Xg++\"))) ; then\n+  AC_PROG_CXXCPP\n+fi\n+])# _LT_AC_PROG_CXXCPP\n \n # AC_LIBTOOL_F77\n # --------------\n@@ -2411,7 +2521,7 @@ AC_DEFUN([AC_LIBTOOL_F77],\n # ---------------\n AC_DEFUN([_LT_AC_LANG_F77],\n [AC_REQUIRE([AC_PROG_F77])\n-_LT_AC_SHELL_INIT([tagnames=`echo \"$tagnames,F77\" | sed 's/^,//'`])\n+_LT_AC_SHELL_INIT([tagnames=${tagnames+${tagnames},}F77])\n ])# _LT_AC_LANG_F77\n \n \n@@ -2432,7 +2542,7 @@ AC_DEFUN([_LT_AC_LANG_GCJ],\n       [ifdef([AC_PROG_GCJ],[AC_REQUIRE([AC_PROG_GCJ])],\n \t [ifdef([A][M_PROG_GCJ],[AC_REQUIRE([A][M_PROG_GCJ])],\n \t   [AC_REQUIRE([A][C_PROG_GCJ_OR_A][M_PROG_GCJ])])])])])])\n-_LT_AC_SHELL_INIT([tagnames=`echo \"$tagnames,GCJ\" | sed 's/^,//'`])\n+_LT_AC_SHELL_INIT([tagnames=${tagnames+${tagnames},}GCJ])\n ])# _LT_AC_LANG_GCJ\n \n \n@@ -2441,7 +2551,7 @@ _LT_AC_SHELL_INIT([tagnames=`echo \"$tagnames,GCJ\" | sed 's/^,//'`])\n # enable support for Windows resource files\n AC_DEFUN([AC_LIBTOOL_RC],\n [AC_REQUIRE([LT_AC_PROG_RC])\n-_LT_AC_SHELL_INIT([tagnames=`echo \"$tagnames,RC\" | sed 's/^,//'`])\n+_LT_AC_SHELL_INIT([tagnames=${tagnames+${tagnames},}RC])\n ])# AC_LIBTOOL_RC\n \n \n@@ -2470,6 +2580,10 @@ lt_simple_link_test_code='int main(){return(0);}\\n'\n \n _LT_AC_SYS_COMPILER\n \n+# save warnings/boilerplate of simple test code\n+_LT_COMPILER_BOILERPLATE\n+_LT_LINKER_BOILERPLATE\n+\n #\n # Check for any special shared library compilation flags.\n #\n@@ -2483,7 +2597,7 @@ if test \"$GCC\" = no; then\n fi\n if test -n \"$_LT_AC_TAGVAR(lt_prog_cc_shlib, $1)\"; then\n   AC_MSG_WARN([`$CC' requires `$_LT_AC_TAGVAR(lt_prog_cc_shlib, $1)' to build shared libraries])\n-  if echo \"$old_CC $old_CFLAGS \" | grep \"[[ \t]]$]_LT_AC_TAGVAR(lt_prog_cc_shlib, $1)[[[ \t]]\" >/dev/null; then :\n+  if echo \"$old_CC $old_CFLAGS \" | grep \"[[ \t]]$_LT_AC_TAGVAR(lt_prog_cc_shlib, $1)[[ \t]]\" >/dev/null; then :\n   else\n     AC_MSG_WARN([add `$_LT_AC_TAGVAR(lt_prog_cc_shlib, $1)' to the CC or CFLAGS env variable and reconfigure])\n     _LT_AC_TAGVAR(lt_cv_prog_cc_can_build_shared, $1)=no\n@@ -2510,9 +2624,9 @@ AC_LIBTOOL_PROG_COMPILER_PIC($1)\n AC_LIBTOOL_PROG_CC_C_O($1)\n AC_LIBTOOL_SYS_HARD_LINK_LOCKS($1)\n AC_LIBTOOL_PROG_LD_SHLIBS($1)\n+AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n AC_LIBTOOL_PROG_LD_HARDCODE_LIBPATH($1)\n AC_LIBTOOL_SYS_LIB_STRIP\n-AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n AC_LIBTOOL_DLOPEN_SELF($1)\n \n # Report which librarie types wil actually be built\n@@ -2533,39 +2647,11 @@ aix3*)\n   fi\n   ;;\n \n-aix4*)\n+aix4* | aix5*)\n   if test \"$host_cpu\" != ia64 && test \"$aix_use_runtimelinking\" = no ; then\n     test \"$enable_shared\" = yes && enable_static=no\n   fi\n-  ;;\n-  darwin* | rhapsody*)\n-  if $CC -v 2>&1 | grep 'Apple' >/dev/null ; then \n-    _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n-    case \"$host_os\" in\n-    rhapsody* | darwin1.[[012]])\n-      _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'\n-      ;;\n-    *) # Darwin 1.3 on\n-      test -z ${LD_TWOLEVEL_NAMESPACE} && _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'\n-      ;;\n-    esac\n-    # FIXME: Relying on posixy $() will cause problems for\n-    #        cross-compilation, but unfortunately the echo tests do not\n-    #        yet detect zsh echo's removal of \\ escapes.  Also zsh mangles\n-    #\t       `\"' quotes if we put them in here... so don't!\n-\t\toutput_verbose_link_cmd='echo'\n-    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring'\n-    _LT_AC_TAGVAR(module_cmds, $1)='$CC -bundle $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags'\n-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's\n-\t\t  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n-\t\t  _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -bundle $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n-    _LT_AC_TAGVAR(hardcode_direct, $1)=no\n-    _LT_AC_TAGVAR(hardcode_automatic, $1)=yes\n-    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported\n-    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'\n-    _LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n-    fi\n-    ;;  \n+    ;;\n esac\n AC_MSG_RESULT([$enable_shared])\n \n@@ -2590,7 +2676,7 @@ AC_DEFUN([AC_LIBTOOL_LANG_CXX_CONFIG], [_LT_AC_LANG_CXX_CONFIG(CXX)])\n AC_DEFUN([_LT_AC_LANG_CXX_CONFIG],\n [AC_LANG_PUSH(C++)\n AC_REQUIRE([AC_PROG_CXX])\n-AC_REQUIRE([AC_PROG_CXXCPP])\n+AC_REQUIRE([_LT_AC_PROG_CXXCPP])\n \n _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n _LT_AC_TAGVAR(allow_undefined_flag, $1)=\n@@ -2634,6 +2720,10 @@ lt_simple_link_test_code='int main(int, char *[]) { return(0); }\\n'\n # ltmain only uses $CC for tagged configurations so make sure $CC is set.\n _LT_AC_SYS_COMPILER\n \n+# save warnings/boilerplate of simple test code\n+_LT_COMPILER_BOILERPLATE\n+_LT_LINKER_BOILERPLATE\n+\n # Allow CC to be a program name with arguments.\n lt_save_CC=$CC\n lt_save_LD=$LD\n@@ -2655,7 +2745,7 @@ test -z \"${LDCXX+set}\" || LD=$LDCXX\n CC=${CXX-\"c++\"}\n compiler=$CC\n _LT_AC_TAGVAR(compiler, $1)=$CC\n-cc_basename=`$echo X\"$compiler\" | $Xsed -e 's%^.*/%%'`\n+_LT_CC_BASENAME([$compiler])\n \n # We don't want -fno-exception wen compiling C++ code, so set the\n # no_builtin_flag separately\n@@ -2700,7 +2790,7 @@ if test \"$GXX\" = yes; then\n     # linker, instead of GNU ld.  If possible, this setting should\n     # overridden to take advantage of the native linker features on\n     # the platform it is being used on.\n-    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'\n+    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'\n   fi\n \n   # Commands to make compiler produce verbose output that lists\n@@ -2762,7 +2852,7 @@ case $host_os in\n     _LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n \n     if test \"$GXX\" = yes; then\n-      case $host_os in aix4.[012]|aix4.[012].*)\n+      case $host_os in aix4.[[012]]|aix4.[[012]].*)\n       # We only want to do this on AIX 4.2 and lower, the check\n       # below for broken collect2 doesn't work under 4.3+\n \tcollect2name=`${CC} -print-prog-name=collect2`\n@@ -2783,6 +2873,9 @@ case $host_os in\n \tfi\n       esac\n       shared_flag='-shared'\n+      if test \"$aix_use_runtimelinking\" = yes; then\n+\tshared_flag=\"$shared_flag \"'${wl}-G'\n+      fi\n     else\n       # not using gcc\n       if test \"$host_cpu\" = ia64; then\n@@ -2842,6 +2935,7 @@ case $host_os in\n     esac\n     ;;\n \n+\n   cygwin* | mingw* | pw32*)\n     # _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1) is actually meaningless,\n     # as there is no search path for DLLs.\n@@ -2865,52 +2959,76 @@ case $host_os in\n       _LT_AC_TAGVAR(ld_shlibs, $1)=no\n     fi\n   ;;\n+      darwin* | rhapsody*)\n+        case \"$host_os\" in\n+        rhapsody* | darwin1.[[012]])\n+         _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}suppress'\n+         ;;\n+       *) # Darwin 1.3 on\n+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then\n+           _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'\n+         else\n+           case ${MACOSX_DEPLOYMENT_TARGET} in\n+             10.[[012]])\n+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'\n+               ;;\n+             10.*)\n+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}dynamic_lookup'\n+               ;;\n+           esac\n+         fi\n+         ;;\n+        esac\n+      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n+      _LT_AC_TAGVAR(hardcode_direct, $1)=no\n+      _LT_AC_TAGVAR(hardcode_automatic, $1)=yes\n+      _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported\n+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=''\n+      _LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n \n-  darwin* | rhapsody*)\n-   if $CC -v 2>&1 | grep 'Apple' >/dev/null ; then \n-    _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n-    case \"$host_os\" in\n-    rhapsody* | darwin1.[[012]])\n-      _LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'\n-      ;;\n-    *) # Darwin 1.3 on\n-      test -z ${LD_TWOLEVEL_NAMESPACE} && _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'\n-      ;;\n-    esac\n-    \tlt_int_apple_cc_single_mod=no\n-    \toutput_verbose_link_cmd='echo'\n-    \tif $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then\n-    \t  lt_int_apple_cc_single_mod=yes\n-    \tfi\n-    \tif test \"X$lt_int_apple_cc_single_mod\" = Xyes ; then\n-    \t  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'\n-    \telse\n-        _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'\n+    if test \"$GXX\" = yes ; then\n+      lt_int_apple_cc_single_mod=no\n+      output_verbose_link_cmd='echo'\n+      if $CC -dumpspecs 2>&1 | $EGREP 'single_module' >/dev/null ; then\n+       lt_int_apple_cc_single_mod=yes\n       fi\n-      _LT_AC_TAGVAR(module_cmds, $1)='$CC -bundle ${wl}-bind_at_load $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags'\n-\n-    # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's\n       if test \"X$lt_int_apple_cc_single_mod\" = Xyes ; then\n-        _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'\n+      else\n+          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'\n+        fi\n+        _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'\n+        # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's\n+          if test \"X$lt_int_apple_cc_single_mod\" = Xyes ; then\n+            _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+          else\n+            _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+          fi\n+            _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n       else\n-        _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+      case $cc_basename in\n+        xlc*)\n+         output_verbose_link_cmd='echo'\n+          _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'\n+          _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'\n+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's\n+          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj ${wl}-single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+          ;;\n+       *)\n+         _LT_AC_TAGVAR(ld_shlibs, $1)=no\n+          ;;\n+      esac\n       fi\n-        _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -bundle $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n-    _LT_AC_TAGVAR(hardcode_direct, $1)=no\n-    _LT_AC_TAGVAR(hardcode_automatic, $1)=yes\n-    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported\n-    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'\n-    _LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n-   fi \n-    ;;\n+        ;;\n \n   dgux*)\n     case $cc_basename in\n-      ec++)\n+      ec++*)\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n \t;;\n-      ghcx)\n+      ghcx*)\n \t# Green Hills C++ Compiler\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n@@ -2921,14 +3039,14 @@ case $host_os in\n \t;;\n     esac\n     ;;\n-  freebsd[12]*)\n+  freebsd[[12]]*)\n     # C++ shared libraries reported to be fairly broken before switch to ELF\n     _LT_AC_TAGVAR(ld_shlibs, $1)=no\n     ;;\n   freebsd-elf*)\n     _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n     ;;\n-  freebsd*)\n+  freebsd* | kfreebsd*-gnu | dragonfly*)\n     # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF\n     # conventions\n     _LT_AC_TAGVAR(ld_shlibs, $1)=yes\n@@ -2945,11 +3063,11 @@ case $host_os in\n \t\t\t\t# location of the library.\n \n     case $cc_basename in\n-    CC)\n+    CC*)\n       # FIXME: insert proper C++ library support\n       _LT_AC_TAGVAR(ld_shlibs, $1)=no\n       ;;\n-    aCC)\n+    aCC*)\n       _LT_AC_TAGVAR(archive_cmds, $1)='$rm $output_objdir/$soname~$CC -b ${wl}+b ${wl}$install_libdir -o $output_objdir/$soname $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags~test $output_objdir/$soname = $lib || mv $output_objdir/$soname $lib'\n       # Commands to make compiler produce verbose output that lists\n       # what \"hidden\" libraries, object files and flags are used when\n@@ -2959,7 +3077,7 @@ case $host_os in\n       # explicitly linking system object files so we need to strip them\n       # from the output so that they don't get included in the library\n       # dependencies.\n-      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | egrep \"\\-L\"`; list=\"\"; for z in $templist; do case $z in conftest.$objext) list=\"$list $z\";; *.$objext);; *) list=\"$list $z\";;esac; done; echo $list'\n+      output_verbose_link_cmd='templist=`($CC -b $CFLAGS -v conftest.$objext 2>&1) | grep \"[[-]]L\"`; list=\"\"; for z in $templist; do case $z in conftest.$objext) list=\"$list $z\";; *.$objext);; *) list=\"$list $z\";;esac; done; echo $list'\n       ;;\n     *)\n       if test \"$GXX\" = yes; then\n@@ -3010,11 +3128,11 @@ case $host_os in\n     esac\n \n     case $cc_basename in\n-      CC)\n+      CC*)\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n \t;;\n-      aCC)\n+      aCC*)\n \tcase \"$host_cpu\" in\n \thppa*64*|ia64*)\n \t  _LT_AC_TAGVAR(archive_cmds, $1)='$LD -b +h $soname -o $lib $linker_flags $libobjs $deplibs'\n@@ -3054,9 +3172,9 @@ case $host_os in\n     ;;\n   irix5* | irix6*)\n     case $cc_basename in\n-      CC)\n+      CC*)\n \t# SGI C++\n-\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n+\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -all -multigot $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'\n \n \t# Archives containing C++ object files must be created using\n \t# \"CC -ar\", where \"CC\" is the IRIX C++ compiler.  This is\n@@ -3067,7 +3185,7 @@ case $host_os in\n       *)\n \tif test \"$GXX\" = yes; then\n \t  if test \"$with_gnu_ld\" = no; then\n-\t    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'\n+\t    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'\n \t  else\n \t    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` -o $lib'\n \t  fi\n@@ -3080,7 +3198,7 @@ case $host_os in\n     ;;\n   linux*)\n     case $cc_basename in\n-      KCC)\n+      KCC*)\n \t# Kuck and Associates, Inc. (KAI) C++ Compiler\n \n \t# KCC will only create a shared library if the output file\n@@ -3105,17 +3223,41 @@ case $host_os in\n \t# \"CC -Bstatic\", where \"CC\" is the KAI C++ compiler.\n \t_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -Bstatic -o $oldlib $oldobjs'\n \t;;\n-      icpc)\n+      icpc*)\n \t# Intel C++\n \twith_gnu_ld=yes\n+\t# version 8.0 and above of icpc choke on multiply defined symbols\n+\t# if we add $predep_objects and $postdep_objects, however 7.1 and\n+\t# earlier do not add the objects themselves.\n+\tcase `$CC -V 2>&1` in\n+\t*\"Version 7.\"*)\n+  \t  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+  \t  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n+\t  ;;\n+\t*)  # Version 8.0 or newer\n+\t  tmp_idyn=\n+\t  case $host_cpu in\n+\t    ia64*) tmp_idyn=' -i_dynamic';;\n+\t  esac\n+  \t  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'\"$tmp_idyn\"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+\t  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared'\"$tmp_idyn\"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n+\t  ;;\n+\tesac\n \t_LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n-\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'\n-\t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname ${wl}-retain-symbols-file $wl$export_symbols -o $lib'\n \t_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'\n \t_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'\n \t_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}--whole-archive$convenience ${wl}--no-whole-archive'\n \t;;\n-      cxx)\n+      pgCC*)\n+        # Portland Group C++ compiler\n+\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname -o $lib'\n+  \t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname ${wl}-retain-symbols-file ${wl}$export_symbols -o $lib'\n+\n+\t_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'\n+\t_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'\n+\t_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=''\n+        ;;\n+      cxx*)\n \t# Compaq C++\n \t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname -o $lib'\n \t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $wl$soname  -o $lib ${wl}-retain-symbols-file $wl$export_symbols'\n@@ -3146,7 +3288,7 @@ case $host_os in\n     ;;\n   mvs*)\n     case $cc_basename in\n-      cxx)\n+      cxx*)\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n \t;;\n@@ -3167,9 +3309,25 @@ case $host_os in\n     # Workaround some broken pre-1.5 toolchains\n     output_verbose_link_cmd='$CC -shared $CFLAGS -v conftest.$objext 2>&1 | grep conftest.$objext | $SED -e \"s:-lgcc -lc -lgcc::\"'\n     ;;\n+  openbsd2*)\n+    # C++ shared libraries are fairly broken\n+    _LT_AC_TAGVAR(ld_shlibs, $1)=no\n+    ;;\n+  openbsd*)\n+    _LT_AC_TAGVAR(hardcode_direct, $1)=yes\n+    _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no\n+    _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -o $lib'\n+    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'\n+    if test -z \"`echo __ELF__ | $CC -E - | grep __ELF__`\" || test \"$host_os-$host_cpu\" = \"openbsd2.8-powerpc\"; then\n+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-retain-symbols-file,$export_symbols -o $lib'\n+      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'\n+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\"$wlarc\"'--whole-archive$convenience '\"$wlarc\"'--no-whole-archive'\n+    fi\n+    output_verbose_link_cmd='echo'\n+    ;;\n   osf3*)\n     case $cc_basename in\n-      KCC)\n+      KCC*)\n \t# Kuck and Associates, Inc. (KAI) C++ Compiler\n \n \t# KCC will only create a shared library if the output file\n@@ -3185,14 +3343,14 @@ case $host_os in\n \t_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -Bstatic -o $oldlib $oldobjs'\n \n \t;;\n-      RCC)\n+      RCC*)\n \t# Rational C++ 2.4.1\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n \t;;\n-      cxx)\n+      cxx*)\n \t_LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\\*'\n-\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n \"$verstring\" && echo ${wl}-set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n+\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname $soname `test -n \"$verstring\" && echo ${wl}-set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'\n \n \t_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'\n \t_LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:\n@@ -3210,7 +3368,7 @@ case $host_os in\n       *)\n \tif test \"$GXX\" = yes && test \"$with_gnu_ld\" = no; then\n \t  _LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\\*'\n-\t  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'\n+\t  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'\n \n \t  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'\n \t  _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:\n@@ -3229,7 +3387,7 @@ case $host_os in\n     ;;\n   osf4* | osf5*)\n     case $cc_basename in\n-      KCC)\n+      KCC*)\n \t# Kuck and Associates, Inc. (KAI) C++ Compiler\n \n \t# KCC will only create a shared library if the output file\n@@ -3244,17 +3402,17 @@ case $host_os in\n \t# the KAI C++ compiler.\n \t_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -o $oldlib $oldobjs'\n \t;;\n-      RCC)\n+      RCC*)\n \t# Rational C++ 2.4.1\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n \t;;\n-      cxx)\n+      cxx*)\n \t_LT_AC_TAGVAR(allow_undefined_flag, $1)=' -expect_unresolved \\*'\n-\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib'\n+\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'\n \t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='for i in `cat $export_symbols`; do printf \"%s %s\\\\n\" -exported_symbol \"\\$i\" >> $lib.exp; done~\n \t  echo \"-hidden\">> $lib.exp~\n-\t  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n \"$verstring\" && echo -set_version\t$verstring` -update_registry $objdir/so_locations -o $lib~\n+\t  $CC -shared$allow_undefined_flag $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags -msym -soname $soname -Wl,-input -Wl,$lib.exp  `test -n \"$verstring\" && echo -set_version\t$verstring` -update_registry ${output_objdir}/so_locations -o $lib~\n \t  $rm $lib.exp'\n \n \t_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-rpath $libdir'\n@@ -3273,7 +3431,7 @@ case $host_os in\n       *)\n \tif test \"$GXX\" = yes && test \"$with_gnu_ld\" = no; then\n \t  _LT_AC_TAGVAR(allow_undefined_flag, $1)=' ${wl}-expect_unresolved ${wl}\\*'\n-\t _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${objdir}/so_locations -o $lib'\n+\t _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -nostdlib ${allow_undefined_flag} $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-msym ${wl}-soname ${wl}$soname `test -n \"$verstring\" && echo ${wl}-set_version ${wl}$verstring` ${wl}-update_registry ${wl}${output_objdir}/so_locations -o $lib'\n \n \t  _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath ${wl}$libdir'\n \t  _LT_AC_TAGVAR(hardcode_libdir_separator, $1)=:\n@@ -3297,7 +3455,7 @@ case $host_os in\n   sco*)\n     _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n     case $cc_basename in\n-      CC)\n+      CC*)\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n \t;;\n@@ -3309,12 +3467,12 @@ case $host_os in\n     ;;\n   sunos4*)\n     case $cc_basename in\n-      CC)\n+      CC*)\n \t# Sun C++ 4.x\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n \t;;\n-      lcc)\n+      lcc*)\n \t# Lucid\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n@@ -3327,7 +3485,7 @@ case $host_os in\n     ;;\n   solaris*)\n     case $cc_basename in\n-      CC)\n+      CC*)\n \t# Sun C++ 4.2, 5.x and Centerline C++\n \t_LT_AC_TAGVAR(no_undefined_flag, $1)=' -zdefs'\n \t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -G${allow_undefined_flag} -nolib -h$soname -o $lib $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags'\n@@ -3337,13 +3495,17 @@ case $host_os in\n \t_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'\n \t_LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no\n \tcase $host_os in\n-\t  solaris2.[0-5] | solaris2.[0-5].*) ;;\n+\t  solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;\n \t  *)\n \t    # The C++ compiler is used as linker so we must use $wl\n \t    # flag to pass the commands to the underlying system\n-\t    # linker.\n+\t    # linker. We must also pass each convience library through\n+\t    # to the system linker between allextract/defaultextract.\n+\t    # The C++ compiler will combine linker options so we\n+\t    # cannot just pass the convience library names through\n+\t    # without $wl.\n \t    # Supported since Solaris 2.6 (maybe 2.5.1?)\n-\t    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract$convenience ${wl}-z ${wl}defaultextract'\n+\t    _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\\\"\\\"; do test -n \\\"$conv\\\" && new_convenience=\\\"$new_convenience,$conv\\\"; done; $echo \\\"$new_convenience\\\"` ${wl}-z ${wl}defaultextract'\n \t    ;;\n \tesac\n \t_LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n@@ -3364,7 +3526,7 @@ case $host_os in\n \t# in the archive.\n \t_LT_AC_TAGVAR(old_archive_cmds, $1)='$CC -xar -o $oldlib $oldobjs'\n \t;;\n-      gcx)\n+      gcx*)\n \t# Green Hills C++ Compiler\n \t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $predep_objects $libobjs $deplibs $postdep_objects $compiler_flags ${wl}-h $wl$soname -o $lib'\n \n@@ -3407,7 +3569,7 @@ case $host_os in\n     ;;\n   tandem*)\n     case $cc_basename in\n-      NCC)\n+      NCC*)\n \t# NonStop-UX NCC 3.20\n \t# FIXME: insert proper C++ library support\n \t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n@@ -3442,9 +3604,9 @@ AC_LIBTOOL_PROG_COMPILER_PIC($1)\n AC_LIBTOOL_PROG_CC_C_O($1)\n AC_LIBTOOL_SYS_HARD_LINK_LOCKS($1)\n AC_LIBTOOL_PROG_LD_SHLIBS($1)\n+AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n AC_LIBTOOL_PROG_LD_HARDCODE_LIBPATH($1)\n AC_LIBTOOL_SYS_LIB_STRIP\n-AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n AC_LIBTOOL_DLOPEN_SELF($1)\n \n AC_LIBTOOL_CONFIG($1)\n@@ -3643,12 +3805,16 @@ lt_simple_link_test_code=\"      program t\\n      end\\n\"\n # ltmain only uses $CC for tagged configurations so make sure $CC is set.\n _LT_AC_SYS_COMPILER\n \n+# save warnings/boilerplate of simple test code\n+_LT_COMPILER_BOILERPLATE\n+_LT_LINKER_BOILERPLATE\n+\n # Allow CC to be a program name with arguments.\n lt_save_CC=\"$CC\"\n CC=${F77-\"f77\"}\n compiler=$CC\n _LT_AC_TAGVAR(compiler, $1)=$CC\n-cc_basename=`$echo X\"$compiler\" | $Xsed -e 's%^.*/%%'`\n+_LT_CC_BASENAME([$compiler])\n \n AC_MSG_CHECKING([if libtool supports shared libraries])\n AC_MSG_RESULT([$can_build_shared])\n@@ -3666,8 +3832,10 @@ aix3*)\n     postinstall_cmds='$RANLIB $lib'\n   fi\n   ;;\n-aix4*)\n-  test \"$enable_shared\" = yes && enable_static=no\n+aix4* | aix5*)\n+  if test \"$host_cpu\" != ia64 && test \"$aix_use_runtimelinking\" = no ; then\n+    test \"$enable_shared\" = yes && enable_static=no\n+  fi\n   ;;\n esac\n AC_MSG_RESULT([$enable_shared])\n@@ -3686,9 +3854,10 @@ AC_LIBTOOL_PROG_COMPILER_PIC($1)\n AC_LIBTOOL_PROG_CC_C_O($1)\n AC_LIBTOOL_SYS_HARD_LINK_LOCKS($1)\n AC_LIBTOOL_PROG_LD_SHLIBS($1)\n+AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n AC_LIBTOOL_PROG_LD_HARDCODE_LIBPATH($1)\n AC_LIBTOOL_SYS_LIB_STRIP\n-AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n+\n \n AC_LIBTOOL_CONFIG($1)\n \n@@ -3717,20 +3886,27 @@ _LT_AC_TAGVAR(objext, $1)=$objext\n lt_simple_compile_test_code=\"class foo {}\\n\"\n \n # Code to be used in simple link tests\n-lt_simple_link_test_code='public class conftest { public static void main(String[] argv) {}; }\\n'\n+lt_simple_link_test_code='public class conftest { public static void main(String[[]] argv) {}; }\\n'\n \n # ltmain only uses $CC for tagged configurations so make sure $CC is set.\n _LT_AC_SYS_COMPILER\n \n+# save warnings/boilerplate of simple test code\n+_LT_COMPILER_BOILERPLATE\n+_LT_LINKER_BOILERPLATE\n+\n # Allow CC to be a program name with arguments.\n lt_save_CC=\"$CC\"\n CC=${GCJ-\"gcj\"}\n compiler=$CC\n _LT_AC_TAGVAR(compiler, $1)=$CC\n+_LT_CC_BASENAME([$compiler])\n \n # GCJ did not exist at the time GCC didn't implicitly link libc in.\n _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n \n+_LT_AC_TAGVAR(old_archive_cmds, $1)=$old_archive_cmds\n+\n ## CAVEAT EMPTOR:\n ## There is no encapsulation within the following macros, do not change\n ## the running order or otherwise move them around unless you know exactly\n@@ -3740,9 +3916,9 @@ AC_LIBTOOL_PROG_COMPILER_PIC($1)\n AC_LIBTOOL_PROG_CC_C_O($1)\n AC_LIBTOOL_SYS_HARD_LINK_LOCKS($1)\n AC_LIBTOOL_PROG_LD_SHLIBS($1)\n+AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n AC_LIBTOOL_PROG_LD_HARDCODE_LIBPATH($1)\n AC_LIBTOOL_SYS_LIB_STRIP\n-AC_LIBTOOL_SYS_DYNAMIC_LINKER($1)\n AC_LIBTOOL_DLOPEN_SELF($1)\n \n AC_LIBTOOL_CONFIG($1)\n@@ -3777,11 +3953,16 @@ lt_simple_link_test_code=\"$lt_simple_compile_test_code\"\n # ltmain only uses $CC for tagged configurations so make sure $CC is set.\n _LT_AC_SYS_COMPILER\n \n+# save warnings/boilerplate of simple test code\n+_LT_COMPILER_BOILERPLATE\n+_LT_LINKER_BOILERPLATE\n+\n # Allow CC to be a program name with arguments.\n lt_save_CC=\"$CC\"\n CC=${RC-\"windres\"}\n compiler=$CC\n _LT_AC_TAGVAR(compiler, $1)=$CC\n+_LT_CC_BASENAME([$compiler])\n _LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)=yes\n \n AC_LIBTOOL_CONFIG($1)\n@@ -3807,11 +3988,12 @@ if test -f \"$ltmain\"; then\n   # without removal of \\ escapes.\n   if test -n \"${ZSH_VERSION+set}\" ; then\n     setopt NO_GLOB_SUBST\n-  fi  \n+  fi\n   # Now quote all the things that may contain metacharacters while being\n   # careful not to overquote the AC_SUBSTed values.  We take copies of the\n   # variables and quote the copies for generation of the libtool script.\n-  for var in echo old_CC old_CFLAGS AR AR_FLAGS EGREP RANLIB LN_S LTCC NM SED SHELL \\\n+  for var in echo old_CC old_CFLAGS AR AR_FLAGS EGREP RANLIB LN_S LTCC NM \\\n+    SED SHELL STRIP \\\n     libname_spec library_names_spec soname_spec extract_expsyms_cmds \\\n     old_striplib striplib file_magic_cmd finish_cmds finish_eval \\\n     deplibs_check_method reload_flag reload_cmds need_locks \\\n@@ -3861,7 +4043,7 @@ if test -f \"$ltmain\"; then\n     _LT_AC_TAGVAR(archive_cmds, $1) | \\\n     _LT_AC_TAGVAR(archive_expsym_cmds, $1) | \\\n     _LT_AC_TAGVAR(module_cmds, $1) | \\\n-    _LT_AC_TAGVAR(module_expsym_cmds, $1) | \\   \n+    _LT_AC_TAGVAR(module_expsym_cmds, $1) | \\\n     _LT_AC_TAGVAR(old_archive_from_expsyms_cmds, $1) | \\\n     _LT_AC_TAGVAR(export_symbols_cmds, $1) | \\\n     extract_expsyms_cmds | reload_cmds | finish_cmds | \\\n@@ -3916,7 +4098,7 @@ ifelse([$1], [],\n #\n # You should have received a copy of the GNU General Public License\n # along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.\n #\n # As a special exception to the GNU General Public License, if you\n # distribute this file as part of a program that contains a\n@@ -3927,11 +4109,11 @@ ifelse([$1], [],\n SED=$lt_SED\n \n # Sed that helps us avoid accidentally triggering echo(1) options like -n.\n-Xsed=\"$SED -e s/^X//\"\n+Xsed=\"$SED -e 1s/^X//\"\n \n # The HP-UX ksh and POSIX shell print the target directory to stdout\n # if CDPATH is set.\n-if test \"X\\${CDPATH+set}\" = Xset; then CDPATH=:; export CDPATH; fi\n+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH\n \n # The names of the tagged configurations supported by this script.\n available_tags=\n@@ -3962,6 +4144,12 @@ fast_install=$enable_fast_install\n # The host system.\n host_alias=$host_alias\n host=$host\n+host_os=$host_os\n+\n+# The build system.\n+build_alias=$build_alias\n+build=$build\n+build_os=$build_os\n \n # An echo program that does not interpret backslashes.\n echo=$lt_echo\n@@ -3992,7 +4180,7 @@ LN_S=$lt_LN_S\n NM=$lt_NM\n \n # A symbol stripping program\n-STRIP=$STRIP\n+STRIP=$lt_STRIP\n \n # Used to examine libraries when file_magic_cmd begins \"file\"\n MAGIC_CMD=$MAGIC_CMD\n@@ -4023,7 +4211,7 @@ objext=\"$ac_objext\"\n libext=\"$libext\"\n \n # Shared library suffix (normally \".so\").\n-shrext='$shrext'\n+shrext_cmds='$shrext_cmds'\n \n # Executable file suffix (normally \"\").\n exeext=\"$exeext\"\n@@ -4038,7 +4226,7 @@ max_cmd_len=$lt_cv_sys_max_cmd_len\n # Does compiler simultaneously support -c and -o options?\n compiler_c_o=$lt_[]_LT_AC_TAGVAR(lt_cv_prog_compiler_c_o, $1)\n \n-# Must we lock files when doing compilation ?\n+# Must we lock files when doing compilation?\n need_locks=$lt_need_locks\n \n # Do we need the lib prefix for modules?\n@@ -4267,7 +4455,10 @@ else\n   # If there is no Makefile yet, we rely on a make rule to execute\n   # `config.status --recheck' to rerun these tests and create the\n   # libtool script then.\n-  test -f Makefile && make \"$ltmain\"\n+  ltmain_in=`echo $ltmain | sed -e 's/\\.sh$/.in/'`\n+  if test -f \"$ltmain_in\"; then\n+    test -f Makefile && make \"$ltmain\"\n+  fi\n fi\n ])# AC_LIBTOOL_CONFIG\n \n@@ -4309,9 +4500,6 @@ symcode='[[BCDEGRST]]'\n # Regexp to match symbols that can be accessed directly from C.\n sympat='\\([[_A-Za-z]][[_A-Za-z0-9]]*\\)'\n \n-# Transform the above into a raw symbol and a C symbol.\n-symxfrm='\\1 \\2\\3 \\3'\n-\n # Transform an extracted symbol line into a proper C declaration\n lt_cv_sys_global_symbol_to_cdecl=\"sed -n -e 's/^. .* \\(.*\\)$/extern int \\1;/p'\"\n \n@@ -4333,14 +4521,21 @@ hpux*) # Its linker distinguishes data from code symbols\n   lt_cv_sys_global_symbol_to_cdecl=\"sed -n -e 's/^T .* \\(.*\\)$/extern int \\1();/p' -e 's/^$symcode* .* \\(.*\\)$/extern char \\1;/p'\"\n   lt_cv_sys_global_symbol_to_c_name_address=\"sed -n -e 's/^: \\([[^ ]]*\\) $/  {\\\\\\\"\\1\\\\\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \\([[^ ]]*\\) \\([[^ ]]*\\)$/  {\\\"\\2\\\", (lt_ptr) \\&\\2},/p'\"\n   ;;\n+linux*)\n+  if test \"$host_cpu\" = ia64; then\n+    symcode='[[ABCDGIRSTW]]'\n+    lt_cv_sys_global_symbol_to_cdecl=\"sed -n -e 's/^T .* \\(.*\\)$/extern int \\1();/p' -e 's/^$symcode* .* \\(.*\\)$/extern char \\1;/p'\"\n+    lt_cv_sys_global_symbol_to_c_name_address=\"sed -n -e 's/^: \\([[^ ]]*\\) $/  {\\\\\\\"\\1\\\\\\\", (lt_ptr) 0},/p' -e 's/^$symcode* \\([[^ ]]*\\) \\([[^ ]]*\\)$/  {\\\"\\2\\\", (lt_ptr) \\&\\2},/p'\"\n+  fi\n+  ;;\n irix* | nonstopux*)\n   symcode='[[BCDEGRST]]'\n   ;;\n osf*)\n   symcode='[[BCDEGQRST]]'\n   ;;\n solaris* | sysv5*)\n-  symcode='[[BDT]]'\n+  symcode='[[BDRT]]'\n   ;;\n sysv4)\n   symcode='[[DFNSTU]]'\n@@ -4358,14 +4553,17 @@ esac\n # If we're using GNU nm, then use its standard symbol codes.\n case `$NM -V 2>&1` in\n *GNU* | *'with BFD'*)\n-  symcode='[[ABCDGISTW]]' ;;\n+  symcode='[[ABCDGIRSTW]]' ;;\n esac\n \n # Try without a prefix undercore, then with it.\n for ac_symprfx in \"\" \"_\"; do\n \n+  # Transform symcode, sympat, and symprfx into a raw symbol and a C symbol.\n+  symxfrm=\"\\\\1 $ac_symprfx\\\\2 \\\\2\"\n+\n   # Write the raw and C identifiers.\n-  lt_cv_sys_global_symbol_pipe=\"sed -n -e 's/^.*[[ \t]]\\($symcode$symcode*\\)[[ \t]][[ \t]]*\\($ac_symprfx\\)$sympat$opt_cr$/$symxfrm/p'\"\n+  lt_cv_sys_global_symbol_pipe=\"sed -n -e 's/^.*[[ \t]]\\($symcode$symcode*\\)[[ \t]][[ \t]]*$ac_symprfx$sympat$opt_cr$/$symxfrm/p'\"\n \n   # Check to see that the pipe works correctly.\n   pipe_works=no\n@@ -4554,38 +4752,48 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       chorus*)\n \tcase $cc_basename in\n-\tcxch68)\n+\tcxch68*)\n \t  # Green Hills C++ Compiler\n \t  # _LT_AC_TAGVAR(lt_prog_compiler_static, $1)=\"--no_auto_instantiation -u __main -u __premain -u _abort -r $COOL_DIR/lib/libOrb.a $MVME_DIR/lib/CC/libC.a $MVME_DIR/lib/classix/libcx.s.a\"\n \t  ;;\n \tesac\n \t;;\n+       darwin*)\n+         # PIC is the default on this platform\n+         # Common symbols not allowed in MH_DYLIB files\n+         case $cc_basename in\n+           xlc*)\n+           _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'\n+           _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n+           ;;\n+         esac\n+       ;;\n       dgux*)\n \tcase $cc_basename in\n-\t  ec++)\n+\t  ec++*)\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'\n \t    ;;\n-\t  ghcx)\n+\t  ghcx*)\n \t    # Green Hills C++ Compiler\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'\n \t    ;;\n \t  *)\n \t    ;;\n \tesac\n \t;;\n-      freebsd*)\n+      freebsd* | kfreebsd*-gnu | dragonfly*)\n \t# FreeBSD uses GNU C++\n \t;;\n       hpux9* | hpux10* | hpux11*)\n \tcase $cc_basename in\n-\t  CC)\n+\t  CC*)\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)=\"${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive\"\n \t    if test \"$host_cpu\" != ia64; then\n \t      _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='+Z'\n \t    fi\n \t    ;;\n-\t  aCC)\n+\t  aCC*)\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)=\"${ac_cv_prog_cc_wl}-a ${ac_cv_prog_cc_wl}archive\"\n \t    case \"$host_cpu\" in\n@@ -4603,7 +4811,7 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       irix5* | irix6* | nonstopux*)\n \tcase $cc_basename in\n-\t  CC)\n+\t  CC*)\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'\n \t    # CC pic flag -KPIC is the default.\n@@ -4614,18 +4822,24 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       linux*)\n \tcase $cc_basename in\n-\t  KCC)\n+\t  KCC*)\n \t    # KAI C++ Compiler\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='--backend -Wl,'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fPIC'\n \t    ;;\n-\t  icpc)\n+\t  icpc* | ecpc*)\n \t    # Intel C++\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'\n-\t    ;; \n-\t  cxx)\n+\t    ;;\n+\t  pgCC*)\n+\t    # Portland Group C++ compiler.\n+\t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n+\t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fpic'\n+\t    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'\n+\t    ;;\n+\t  cxx*)\n \t    # Compaq C++\n \t    # Make sure the PIC flag is empty.  It appears that all Alpha\n \t    # Linux and Compaq Tru64 Unix objects are PIC.\n@@ -4642,8 +4856,8 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       mvs*)\n \tcase $cc_basename in\n-\t  cxx)\n-\t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-Wextra c,exportall'\n+\t  cxx*)\n+\t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-W c,exportall'\n \t    ;;\n \t  *)\n \t    ;;\n@@ -4653,14 +4867,14 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       osf3* | osf4* | osf5*)\n \tcase $cc_basename in\n-\t  KCC)\n+\t  KCC*)\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='--backend -Wl,'\n \t    ;;\n-\t  RCC)\n+\t  RCC*)\n \t    # Rational C++ 2.4.1\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'\n \t    ;;\n-\t  cxx)\n+\t  cxx*)\n \t    # Digital/Compaq C++\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n \t    # Make sure the PIC flag is empty.  It appears that all Alpha\n@@ -4676,7 +4890,7 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       sco*)\n \tcase $cc_basename in\n-\t  CC)\n+\t  CC*)\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fPIC'\n \t    ;;\n \t  *)\n@@ -4685,13 +4899,13 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       solaris*)\n \tcase $cc_basename in\n-\t  CC)\n+\t  CC*)\n \t    # Sun C++ 4.2, 5.x and Centerline C++\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld '\n \t    ;;\n-\t  gcx)\n+\t  gcx*)\n \t    # Green Hills C++ Compiler\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-PIC'\n \t    ;;\n@@ -4701,12 +4915,12 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       sunos4*)\n \tcase $cc_basename in\n-\t  CC)\n+\t  CC*)\n \t    # Sun C++ 4.x\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'\n \t    _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'\n \t    ;;\n-\t  lcc)\n+\t  lcc*)\n \t    # Lucid\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'\n \t    ;;\n@@ -4716,7 +4930,7 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t;;\n       tandem*)\n \tcase $cc_basename in\n-\t  NCC)\n+\t  NCC*)\n \t    # NonStop-UX NCC 3.20\n \t    _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'\n \t    ;;\n@@ -4813,6 +5027,16 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n \t_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-bnso -bI:/lib/syscalls.exp'\n       fi\n       ;;\n+      darwin*)\n+        # PIC is the default on this platform\n+        # Common symbols not allowed in MH_DYLIB files\n+       case $cc_basename in\n+         xlc*)\n+         _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-qnocommon'\n+         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n+         ;;\n+       esac\n+       ;;\n \n     mingw* | pw32* | os2*)\n       # This hack is so that the source file can tell whether it is being\n@@ -4848,13 +5072,20 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n       ;;\n \n     linux*)\n-      case $CC in\n-      icc|ecc)\n+      case $cc_basename in\n+      icc* | ecc*)\n \t_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n \t_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'\n \t_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'\n         ;;\n-      ccc)\n+      pgcc* | pgf77* | pgf90*)\n+        # Portland Group compilers (*not* the Pentium gcc compiler,\n+\t# which looks to be a dead project)\n+\t_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n+\t_LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-fpic'\n+\t_LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-static'\n+        ;;\n+      ccc*)\n         _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n         # All Alpha code is PIC.\n         _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-non_shared'\n@@ -4874,9 +5105,14 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n       ;;\n \n     solaris*)\n-      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-KPIC'\n       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'\n+      case $cc_basename in\n+      f77* | f90* | f95*)\n+\t_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Qoption ld ';;\n+      *)\n+\t_LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,';;\n+      esac\n       ;;\n \n     sunos4*)\n@@ -4898,6 +5134,11 @@ AC_MSG_CHECKING([for $compiler option to produce PIC])\n       fi\n       ;;\n \n+    unicos*)\n+      _LT_AC_TAGVAR(lt_prog_compiler_wl, $1)='-Wl,'\n+      _LT_AC_TAGVAR(lt_prog_compiler_can_build_shared, $1)=no\n+      ;;\n+\n     uts4*)\n       _LT_AC_TAGVAR(lt_prog_compiler_pic, $1)='-pic'\n       _LT_AC_TAGVAR(lt_prog_compiler_static, $1)='-Bstatic'\n@@ -4958,7 +5199,7 @@ ifelse([$1],[CXX],[\n     _LT_AC_TAGVAR(export_symbols_cmds, $1)=\"$ltdll_cmds\"\n   ;;\n   cygwin* | mingw*)\n-    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\\''/^[[BCDGS]] /s/.* \\([[^ ]]*\\)/\\1 DATA/'\\'' | $SED -e '\\''/^[[AITW]] /s/.* //'\\'' | sort | uniq > $export_symbols'\n+    _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\\''/^[[BCDGRS]] /s/.* \\([[^ ]]*\\)/\\1 DATA/;/^.* __nm__/s/^.* __nm__\\([[^ ]]*\\) [[^ ]]*/\\1 DATA/;/^I /d;/^[[AITW]] /s/.* //'\\'' | sort | uniq > $export_symbols'\n   ;;\n   *)\n     _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\\''s/.* //'\\'' | sort | uniq > $export_symbols'\n@@ -4984,7 +5225,7 @@ ifelse([$1],[CXX],[\n   _LT_AC_TAGVAR(link_all_deplibs, $1)=unknown\n   _LT_AC_TAGVAR(hardcode_automatic, $1)=no\n   _LT_AC_TAGVAR(module_cmds, $1)=\n-  _LT_AC_TAGVAR(module_expsym_cmds, $1)=  \n+  _LT_AC_TAGVAR(module_expsym_cmds, $1)=\n   _LT_AC_TAGVAR(always_export_symbols, $1)=no\n   _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED '\\''s/.* //'\\'' | sort | uniq > $export_symbols'\n   # include_expsyms should be a list of space-separated symbols to be *always*\n@@ -5001,7 +5242,8 @@ ifelse([$1],[CXX],[\n   # rely on this symbol name, it's probably fine to never include it in\n   # preloaded symbol tables.\n   extract_expsyms_cmds=\n-\n+  # Just being paranoid about ensuring that cc_basename is set.\n+  _LT_CC_BASENAME([$compiler])\n   case $host_os in\n   cygwin* | mingw* | pw32*)\n     # FIXME: the MSVC++ port hasn't been tested in a loooong time\n@@ -5020,7 +5262,28 @@ ifelse([$1],[CXX],[\n   if test \"$with_gnu_ld\" = yes; then\n     # If archive_cmds runs LD, not CC, wlarc should be empty\n     wlarc='${wl}'\n-\n+    \n+    # Set some defaults for GNU ld with shared library support. These\n+    # are reset later if shared libraries are not supported. Putting them\n+    # here allows them to be overridden if necessary.\n+    runpath_var=LD_RUN_PATH\n+    _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'\n+    _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'\n+    # ancient GNU ld didn't support --whole-archive et. al.\n+    if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then\n+\t_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\"$wlarc\"'--whole-archive$convenience '\"$wlarc\"'--no-whole-archive'\n+      else\n+  \t_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\n+    fi\n+    supports_anon_versioning=no\n+    case `$LD -v 2>/dev/null` in\n+      *\\ [[01]].* | *\\ 2.[[0-9]].* | *\\ 2.10.*) ;; # catch versions < 2.11\n+      *\\ 2.11.93.0.2\\ *) supports_anon_versioning=yes ;; # RH7.3 ...\n+      *\\ 2.11.92.0.12\\ *) supports_anon_versioning=yes ;; # Mandrake 8.2 ...\n+      *\\ 2.11.*) ;; # other 2.11 versions\n+      *) supports_anon_versioning=yes ;;\n+    esac\n+    \n     # See if GNU ld supports shared libraries.\n     case $host_os in\n     aix3* | aix4* | aix5*)\n@@ -5071,7 +5334,7 @@ EOF\n       _LT_AC_TAGVAR(allow_undefined_flag, $1)=unsupported\n       _LT_AC_TAGVAR(always_export_symbols, $1)=no\n       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes\n-      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\\''/^[[BCDGS]] /s/.* \\([[^ ]]*\\)/\\1 DATA/'\\'' | $SED -e '\\''/^[[AITW]] /s/.* //'\\'' | sort | uniq > $export_symbols'\n+      _LT_AC_TAGVAR(export_symbols_cmds, $1)='$NM $libobjs $convenience | $global_symbol_pipe | $SED -e '\\''/^[[BCDGRS]] /s/.* \\([[^ ]]*\\)/\\1 DATA/'\\'' | $SED -e '\\''/^[[AITW]] /s/.* //'\\'' | sort | uniq > $export_symbols'\n \n       if $LD --help 2>&1 | grep 'auto-import' > /dev/null; then\n         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000 ${wl}--out-implib,$lib'\n@@ -5085,7 +5348,37 @@ EOF\n \tfi~\n \t$CC -shared $output_objdir/$soname.def $libobjs $deplibs $compiler_flags -o $output_objdir/$soname ${wl}--image-base=0x10000000  ${wl}--out-implib,$lib'\n       else\n-\tld_shlibs=no\n+\t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n+      fi\n+      ;;\n+\n+    linux*)\n+      if $LD --help 2>&1 | grep ': supported targets:.* elf' > /dev/null; then\n+\ttmp_addflag=\n+\tcase $cc_basename,$host_cpu in\n+\tpgcc*)\t\t\t\t# Portland Group C compiler\n+\t  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\n+\t  ;;\n+\tpgf77* | pgf90* )\t\t\t# Portland Group f77 and f90 compilers\n+\t  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\n+\t  tmp_addflag=' -fpic -Mnomain' ;;\n+\tecc*,ia64* | icc*,ia64*)\t\t# Intel C compiler on ia64\n+\t  tmp_addflag=' -i_dynamic' ;;\n+\tefc*,ia64* | ifort*,ia64*)\t# Intel Fortran compiler on ia64\n+\t  tmp_addflag=' -i_dynamic -nofor_main' ;;\n+\tifc* | ifort*)\t\t\t# Intel Fortran compiler\n+\t  tmp_addflag=' -nofor_main' ;;\n+\tesac\n+\t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared'\"$tmp_addflag\"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname -o $lib'\n+\n+\tif test $supports_anon_versioning = yes; then\n+\t  _LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo \"{ global:\" > $output_objdir/$libname.ver~\n+  cat $export_symbols | sed -e \"s/\\(.*\\)/\\1;/\" >> $output_objdir/$libname.ver~\n+  $echo \"local: *; };\" >> $output_objdir/$libname.ver~\n+\t  $CC -shared'\"$tmp_addflag\"' $libobjs $deplibs $compiler_flags ${wl}-soname $wl$soname ${wl}-version-script ${wl}$output_objdir/$libname.ver -o $lib'\n+\tfi\n+      else\n+\t_LT_AC_TAGVAR(ld_shlibs, $1)=no\n       fi\n       ;;\n \n@@ -5137,16 +5430,11 @@ EOF\n       ;;\n     esac\n \n-    if test \"$_LT_AC_TAGVAR(ld_shlibs, $1)\" = yes; then\n-      runpath_var=LD_RUN_PATH\n-      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}--rpath ${wl}$libdir'\n-      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}--export-dynamic'\n-      # ancient GNU ld didn't support --whole-archive et. al.\n-      if $LD --help 2>&1 | grep 'no-whole-archive' > /dev/null; then\n- \t_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\"$wlarc\"'--whole-archive$convenience '\"$wlarc\"'--no-whole-archive'\n-      else\n-  \t_LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\n-      fi\n+    if test \"$_LT_AC_TAGVAR(ld_shlibs, $1)\" = no; then\n+      runpath_var=\n+      _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)=\n+      _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)=\n+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=\n     fi\n   else\n     # PORTME fill in a description of your system's linker (not GNU ld)\n@@ -5210,7 +5498,7 @@ EOF\n       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n \n       if test \"$GCC\" = yes; then\n-\tcase $host_os in aix4.[012]|aix4.[012].*)\n+\tcase $host_os in aix4.[[012]]|aix4.[[012]].*)\n \t# We only want to do this on AIX 4.2 and lower, the check\n \t# below for broken collect2 doesn't work under 4.3+\n \t  collect2name=`${CC} -print-prog-name=collect2`\n@@ -5231,6 +5519,9 @@ EOF\n \t  fi\n \tesac\n \tshared_flag='-shared'\n+\tif test \"$aix_use_runtimelinking\" = yes; then\n+\t  shared_flag=\"$shared_flag \"'${wl}-G'\n+\tfi\n       else\n \t# not using gcc\n \tif test \"$host_cpu\" = ia64; then\n@@ -5289,7 +5580,7 @@ EOF\n       _LT_AC_TAGVAR(ld_shlibs, $1)=no\n       ;;\n \n-    bsdi4*)\n+    bsdi[[45]]*)\n       _LT_AC_TAGVAR(export_dynamic_flag_spec, $1)=-rdynamic\n       ;;\n \n@@ -5303,56 +5594,65 @@ EOF\n       # Tell ltmain to make .lib files, not .a files.\n       libext=lib\n       # Tell ltmain to make .dll files, not .so files.\n-      shrext=\".dll\"\n+      shrext_cmds=\".dll\"\n       # FIXME: Setting linknames here is a bad hack.\n       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -o $lib $libobjs $compiler_flags `echo \"$deplibs\" | $SED -e '\\''s/ -lc$//'\\''` -link -dll~linknames='\n       # The linker will automatically build a .lib file if we build a DLL.\n       _LT_AC_TAGVAR(old_archive_From_new_cmds, $1)='true'\n       # FIXME: Should let the user specify the lib program.\n       _LT_AC_TAGVAR(old_archive_cmds, $1)='lib /OUT:$oldlib$oldobjs$old_deplibs'\n-      fix_srcfile_path='`cygpath -w \"$srcfile\"`'\n+      _LT_AC_TAGVAR(fix_srcfile_path, $1)='`cygpath -w \"$srcfile\"`'\n       _LT_AC_TAGVAR(enable_shared_with_static_runtimes, $1)=yes\n       ;;\n \n     darwin* | rhapsody*)\n-    if $CC -v 2>&1 | grep 'Apple' >/dev/null ; then \n-      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n       case \"$host_os\" in\n-      rhapsody* | darwin1.[[012]])\n-\t_LT_AC_TAGVAR(allow_undefined_flag, $1)='-undefined suppress'\n-\t;;\n-      *) # Darwin 1.3 on\n-\ttest -z ${LD_TWOLEVEL_NAMESPACE} && _LT_AC_TAGVAR(allow_undefined_flag, $1)='-flat_namespace -undefined suppress'\n-\t;;\n+        rhapsody* | darwin1.[[012]])\n+         _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}suppress'\n+         ;;\n+       *) # Darwin 1.3 on\n+         if test -z ${MACOSX_DEPLOYMENT_TARGET} ; then\n+           _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'\n+         else\n+           case ${MACOSX_DEPLOYMENT_TARGET} in\n+             10.[[012]])\n+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-flat_namespace ${wl}-undefined ${wl}suppress'\n+               ;;\n+             10.*)\n+               _LT_AC_TAGVAR(allow_undefined_flag, $1)='${wl}-undefined ${wl}dynamic_lookup'\n+               ;;\n+           esac\n+         fi\n+         ;;\n       esac\n-      # FIXME: Relying on posixy $() will cause problems for\n-      #        cross-compilation, but unfortunately the echo tests do not\n-      #        yet detect zsh echo's removal of \\ escapes.  Also zsh mangles\n-      #\t       `\"' quotes if we put them in here... so don't!\n-    \tlt_int_apple_cc_single_mod=no\n-    \toutput_verbose_link_cmd='echo'\n-    \tif $CC -dumpspecs 2>&1 | grep 'single_module' >/dev/null ; then\n-    \t  lt_int_apple_cc_single_mod=yes\n-    \tfi\n-    \tif test \"X$lt_int_apple_cc_single_mod\" = Xyes ; then\n-    \t  _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'\n-    \telse\n-        _LT_AC_TAGVAR(archive_cmds, $1)='$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring'\n-      fi\n-      _LT_AC_TAGVAR(module_cmds, $1)='$CC -bundle ${wl}-bind_at_load $allow_undefined_flag -o $lib $libobjs $deplibs$compiler_flags'\n-      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's\n-        if test \"X$lt_int_apple_cc_single_mod\" = Xyes ; then\n-          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib -single_module $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n-        else\n-          _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -r ${wl}-bind_at_load -keep_private_externs -nostdlib -o ${lib}-master.o $libobjs~$CC -dynamiclib $allow_undefined_flag -o $lib ${lib}-master.o $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n-        fi\n-          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -bundle $allow_undefined_flag  -o $lib $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+      _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no\n       _LT_AC_TAGVAR(hardcode_direct, $1)=no\n       _LT_AC_TAGVAR(hardcode_automatic, $1)=yes\n       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=unsupported\n-      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-all_load $convenience'\n+      _LT_AC_TAGVAR(whole_archive_flag_spec, $1)=''\n       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n-    fi  \n+    if test \"$GCC\" = yes ; then\n+    \toutput_verbose_link_cmd='echo'\n+        _LT_AC_TAGVAR(archive_cmds, $1)='$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring'\n+      _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'\n+      # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's\n+      _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -dynamiclib $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags -install_name $rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+      _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+    else\n+      case $cc_basename in\n+        xlc*)\n+         output_verbose_link_cmd='echo'\n+         _LT_AC_TAGVAR(archive_cmds, $1)='$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}`echo $rpath/$soname` $verstring'\n+         _LT_AC_TAGVAR(module_cmds, $1)='$CC $allow_undefined_flag -o $lib -bundle $libobjs $deplibs$compiler_flags'\n+          # Don't fix this by using the ld -exported_symbols_list flag, it doesn't exist in older darwin ld's\n+         _LT_AC_TAGVAR(archive_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC -qmkshrobj $allow_undefined_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-install_name ${wl}$rpath/$soname $verstring~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+          _LT_AC_TAGVAR(module_expsym_cmds, $1)='sed -e \"s,#.*,,\" -e \"s,^[    ]*,,\" -e \"s,^\\(..*\\),_&,\" < $export_symbols > $output_objdir/${libname}-symbols.expsym~$CC $allow_undefined_flag  -o $lib -bundle $libobjs $deplibs$compiler_flags~nmedit -s $output_objdir/${libname}-symbols.expsym ${lib}'\n+          ;;\n+       *)\n+         _LT_AC_TAGVAR(ld_shlibs, $1)=no\n+          ;;\n+      esac\n+    fi\n       ;;\n \n     dgux*)\n@@ -5385,7 +5685,7 @@ EOF\n       ;;\n \n     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.\n-    freebsd*)\n+    freebsd* | kfreebsd*-gnu | dragonfly*)\n       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -o $lib $libobjs $deplibs $compiler_flags'\n       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'\n       _LT_AC_TAGVAR(hardcode_direct, $1)=yes\n@@ -5496,6 +5796,7 @@ EOF\n       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no\n       if test -z \"`echo __ELF__ | $CC -E - | grep __ELF__`\" || test \"$host_os-$host_cpu\" = \"openbsd2.8-powerpc\"; then\n \t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags'\n+\t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$CC -shared $pic_flag -o $lib $libobjs $deplibs $compiler_flags ${wl}-retain-symbols-file,$export_symbols'\n \t_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='${wl}-rpath,$libdir'\n \t_LT_AC_TAGVAR(export_dynamic_flag_spec, $1)='${wl}-E'\n       else\n@@ -5541,7 +5842,7 @@ EOF\n \t_LT_AC_TAGVAR(allow_undefined_flag, $1)=' -expect_unresolved \\*'\n \t_LT_AC_TAGVAR(archive_cmds, $1)='$LD -shared${allow_undefined_flag} $libobjs $deplibs $linker_flags -msym -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib'\n \t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='for i in `cat $export_symbols`; do printf \"%s %s\\\\n\" -exported_symbol \"\\$i\" >> $lib.exp; done; echo \"-hidden\">> $lib.exp~\n-\t$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${objdir}/so_locations -o $lib~$rm $lib.exp'\n+\t$LD -shared${allow_undefined_flag} -input $lib.exp $linker_flags $libobjs $deplibs -soname $soname `test -n \"$verstring\" && echo -set_version $verstring` -update_registry ${output_objdir}/so_locations -o $lib~$rm $lib.exp'\n \n \t# Both c and cxx compiler support -rpath directly\n \t_LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-rpath $libdir'\n@@ -5560,10 +5861,12 @@ EOF\n     solaris*)\n       _LT_AC_TAGVAR(no_undefined_flag, $1)=' -z text'\n       if test \"$GCC\" = yes; then\n+\twlarc='${wl}'\n \t_LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags'\n \t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo \"{ global:\" > $lib.exp~cat $export_symbols | $SED -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n \t  $CC -shared ${wl}-M ${wl}$lib.exp ${wl}-h ${wl}$soname -o $lib $libobjs $deplibs $compiler_flags~$rm $lib.exp'\n       else\n+\twlarc=''\n \t_LT_AC_TAGVAR(archive_cmds, $1)='$LD -G${allow_undefined_flag} -h $soname -o $lib $libobjs $deplibs $linker_flags'\n \t_LT_AC_TAGVAR(archive_expsym_cmds, $1)='$echo \"{ global:\" > $lib.exp~cat $export_symbols | $SED -e \"s/\\(.*\\)/\\1;/\" >> $lib.exp~$echo \"local: *; };\" >> $lib.exp~\n   \t$LD -G${allow_undefined_flag} -M $lib.exp -h $soname -o $lib $libobjs $deplibs $linker_flags~$rm $lib.exp'\n@@ -5572,8 +5875,18 @@ EOF\n       _LT_AC_TAGVAR(hardcode_shlibpath_var, $1)=no\n       case $host_os in\n       solaris2.[[0-5]] | solaris2.[[0-5]].*) ;;\n-      *) # Supported since Solaris 2.6 (maybe 2.5.1?)\n-\t_LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;\n+      *)\n+ \t# The compiler driver will combine linker options so we\n+ \t# cannot just pass the convience library names through\n+ \t# without $wl, iff we do not link with $LD.\n+ \t# Luckily, gcc supports the same syntax we need for Sun Studio.\n+ \t# Supported since Solaris 2.6 (maybe 2.5.1?)\n+ \tcase $wlarc in\n+ \t'')\n+ \t  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='-z allextract$convenience -z defaultextract' ;;\n+ \t*)\n+ \t  _LT_AC_TAGVAR(whole_archive_flag_spec, $1)='${wl}-z ${wl}allextract`for conv in $convenience\\\"\\\"; do test -n \\\"$conv\\\" && new_convenience=\\\"$new_convenience,$conv\\\"; done; $echo \\\"$new_convenience\\\"` ${wl}-z ${wl}defaultextract' ;;\n+ \tesac ;;\n       esac\n       _LT_AC_TAGVAR(link_all_deplibs, $1)=yes\n       ;;\n@@ -5702,7 +6015,7 @@ x|xyes)\n       AC_MSG_CHECKING([whether -lc should be explicitly linked in])\n       $rm conftest*\n       printf \"$lt_simple_compile_test_code\" > conftest.$ac_ext\n-  \n+\n       if AC_TRY_EVAL(ac_compile) 2>conftest.err; then\n         soname=conftest\n         lib=conftest\n@@ -5836,7 +6149,7 @@ lt_ac_count=0\n # Add /usr/xpg4/bin/sed as it is typically found on Solaris\n # along with /bin/sed that truncates output.\n for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do\n-  test ! -f $lt_ac_sed && break\n+  test ! -f $lt_ac_sed && continue\n   cat /dev/null > conftest.in\n   lt_ac_count=0\n   echo $ECHO_N \"0123456789$ECHO_C\" >conftest.in\n@@ -5861,31 +6174,16 @@ for lt_ac_sed in $lt_ac_sed_list /usr/xpg4/bin/sed; do\n     fi\n   done\n done\n-SED=$lt_cv_path_SED\n ])\n+SED=$lt_cv_path_SED\n AC_MSG_RESULT([$SED])\n ])\n ## ltdl.m4 - Configure ltdl for the target system. -*-Autoconf-*-\n ## Copyright (C) 1999-2000 Free Software Foundation, Inc.\n ##\n-## This program is free software; you can redistribute it and/or modify\n-## it under the terms of the GNU General Public License as published by\n-## the Free Software Foundation; either version 2 of the License, or\n-## (at your option) any later version.\n-##\n-## This program is distributed in the hope that it will be useful, but\n-## WITHOUT ANY WARRANTY; without even the implied warranty of\n-## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n-## General Public License for more details.\n-##\n-## You should have received a copy of the GNU General Public License\n-## along with this program; if not, write to the Free Software\n-## Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n-##\n-## As a special exception to the GNU General Public License, if you\n-## distribute this file as part of a program that contains a\n-## configuration script generated by Autoconf, you may include it under\n-## the same distribution terms that you use for the rest of that program.\n+## This file is free software; the Free Software Foundation gives\n+## unlimited permission to copy and/or distribute it, with or without\n+## modifications, as long as this notice is preserved.\n \n # serial 6 AC_LIB_LTDL\n \n@@ -6008,8 +6306,9 @@ AC_CACHE_CHECK([whether deplibs are loaded by dlopen],\n     # Assuming the user has installed a libdl from somewhere, this is true\n     # If you are looking for one http://www.opendarwin.org/projects/dlcompat\n     libltdl_cv_sys_dlopen_deplibs=yes\n-    ;;   \n-  gnu*)\n+    ;;\n+  gnu* | linux* | kfreebsd*-gnu | knetbsd*-gnu)\n+    # GNU and its variants, using gnu ld.so (Glibc)\n     libltdl_cv_sys_dlopen_deplibs=yes\n     ;;\n   hpux10*|hpux11*)\n@@ -6025,9 +6324,6 @@ AC_CACHE_CHECK([whether deplibs are loaded by dlopen],\n     # at 6.2 and later dlopen does load deplibs.\n     libltdl_cv_sys_dlopen_deplibs=yes\n     ;;\n-  linux*)\n-    libltdl_cv_sys_dlopen_deplibs=yes\n-    ;;\n   netbsd*)\n     libltdl_cv_sys_dlopen_deplibs=yes\n     ;;\n@@ -6075,18 +6371,8 @@ AC_DEFUN([AC_LTDL_SHLIBEXT],\n AC_CACHE_CHECK([which extension is used for loadable modules],\n   [libltdl_cv_shlibext],\n [\n-# Here in libltdl for libgcj we don't build modules for darwin.\n-# So we say no. Then the extension gets .dylib which is the right\n-# thing for shared libraries on darwin.\n-case \"$host_os\" in\n-darwin*)\n-\tmodule=no\n-\t;;\n-*)\n-\tmodule=yes\n-\t;;\n-esac\n-eval libltdl_cv_shlibext=$shrext\n+module=yes\n+eval libltdl_cv_shlibext=$shrext_cmds\n   ])\n if test -n \"$libltdl_cv_shlibext\"; then\n   AC_DEFINE_UNQUOTED(LTDL_SHLIB_EXT, \"$libltdl_cv_shlibext\","}, {"sha": "f50f25525ce84848daaa09e889e6559d416d17ec", "filename": "libjava/libltdl/aclocal.m4", "status": "modified", "additions": 24, "deletions": 40, "changes": 64, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Faclocal.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Faclocal.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Faclocal.m4?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -396,6 +396,30 @@ AC_DEFUN([AM_OUTPUT_DEPENDENCY_COMMANDS],\n      [AMDEP_TRUE=\"$AMDEP_TRUE\" ac_aux_dir=\"$ac_aux_dir\"])\n ])\n \n+# Like AC_CONFIG_HEADER, but automatically create stamp file. -*- Autoconf -*-\n+\n+# Copyright (C) 1996, 1997, 2000, 2001, 2003 Free Software Foundation, Inc.\n+\n+# This program is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 2, or (at your option)\n+# any later version.\n+\n+# This program is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+\n+# You should have received a copy of the GNU General Public License\n+# along with this program; if not, write to the Free Software\n+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA\n+# 02111-1307, USA.\n+\n+# serial 7\n+\n+# AM_CONFIG_HEADER is obsolete.  It has been replaced by AC_CONFIG_HEADERS.\n+AU_DEFUN([AM_CONFIG_HEADER], [AC_CONFIG_HEADERS($@)])\n+\n # Do all the work for Automake.                            -*- Autoconf -*-\n \n # This macro actually does too much some checks are only needed if\n@@ -580,46 +604,6 @@ fi\n rmdir .tst 2>/dev/null\n AC_SUBST([am__leading_dot])])\n \n-# Add --enable-maintainer-mode option to configure.\n-# From Jim Meyering\n-\n-# Copyright (C) 1996, 1998, 2000, 2001, 2002, 2003, 2004\n-# Free Software Foundation, Inc.\n-\n-# This program is free software; you can redistribute it and/or modify\n-# it under the terms of the GNU General Public License as published by\n-# the Free Software Foundation; either version 2, or (at your option)\n-# any later version.\n-\n-# This program is distributed in the hope that it will be useful,\n-# but WITHOUT ANY WARRANTY; without even the implied warranty of\n-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n-# GNU General Public License for more details.\n-\n-# You should have received a copy of the GNU General Public License\n-# along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA\n-# 02111-1307, USA.\n-\n-# serial 3\n-\n-AC_DEFUN([AM_MAINTAINER_MODE],\n-[AC_MSG_CHECKING([whether to enable maintainer-specific portions of Makefiles])\n-  dnl maintainer-mode is disabled by default\n-  AC_ARG_ENABLE(maintainer-mode,\n-[  --enable-maintainer-mode  enable make rules and dependencies not useful\n-\t\t\t  (and sometimes confusing) to the casual installer],\n-      USE_MAINTAINER_MODE=$enableval,\n-      USE_MAINTAINER_MODE=no)\n-  AC_MSG_RESULT([$USE_MAINTAINER_MODE])\n-  AM_CONDITIONAL(MAINTAINER_MODE, [test $USE_MAINTAINER_MODE = yes])\n-  MAINT=$MAINTAINER_MODE_TRUE\n-  AC_SUBST(MAINT)dnl\n-]\n-)\n-\n-AU_DEFUN([jm_MAINTAINER_MODE], [AM_MAINTAINER_MODE])\n-\n # Check to see how 'make' treats includes.\t-*- Autoconf -*-\n \n # Copyright (C) 2001, 2002, 2003 Free Software Foundation, Inc."}, {"sha": "3c89816b9b2b568a1147ffd1f540f6d2e3c552b9", "filename": "libjava/libltdl/configure", "status": "modified", "additions": 1951, "deletions": 977, "changes": 2928, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Fconfigure?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4"}, {"sha": "1446efbd03611901daeb32806849bdbc6b5b01c7", "filename": "libjava/libltdl/configure.ac", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Fconfigure.ac?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -13,17 +13,19 @@\n #\n # You should have received a copy of the GNU General Public License\n # along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA\n-# 02111-1307  USA\n+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA\n+# 02110-1301  USA\n+\n+\n+dnl FIXME: Is this really new enough?\n+AC_PREREQ(2.50)\n \n \n ## ------------------------ ##\n ## Autoconf initialisation. ##\n ## ------------------------ ##\n-AC_PREREQ(2.59)\n AC_INIT([libltdl], [1.2], [bug-libtool@gnu.org])\n AC_CONFIG_SRCDIR([ltdl.c])\n-AC_CONFIG_FILES([config.h:config-h.in])\n \n \n ## ------------------------------- ##\n@@ -48,8 +50,8 @@ fi\n ## ------------------------ ##\n ## Automake Initialisation. ##\n ## ------------------------ ##\n-AM_INIT_AUTOMAKE([1.9.1])\n-AM_MAINTAINER_MODE\n+AM_INIT_AUTOMAKE(AC_PACKAGE_TARNAME, AC_PACKAGE_VERSION, -)\n+AM_CONFIG_HEADER([config.h:config-h.in])\n \n \n ## ------------------ ##"}, {"sha": "1a8353401c4223bf93e7d7dd76164de5400be672", "filename": "libjava/libltdl/install-sh", "status": "modified", "additions": 253, "deletions": 224, "changes": 477, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Finstall-sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Finstall-sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Finstall-sh?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -1,7 +1,8 @@\n #!/bin/sh\n-#\n # install - install a program, script, or datafile\n-#\n+\n+scriptversion=2005-02-02.21\n+\n # This originates from X11R5 (mit/util/scripts/install.sh), which was\n # later released in X11R6 (xc/config/util/install.sh) with the\n # following copyright and license.\n@@ -41,13 +42,11 @@\n # from scratch.  It can only install one file at a time, a restriction\n # shared with many OS's install programs.\n \n-\n # set DOITPROG to echo to test this script\n \n # Don't use :- since 4.3BSD and earlier shells don't like it.\n doit=\"${DOITPROG-}\"\n \n-\n # put in absolute paths if you don't have them in your path; or use env. vars.\n \n mvprog=\"${MVPROG-mv}\"\n@@ -59,236 +58,266 @@ stripprog=\"${STRIPPROG-strip}\"\n rmprog=\"${RMPROG-rm}\"\n mkdirprog=\"${MKDIRPROG-mkdir}\"\n \n-transformbasename=\"\"\n-transform_arg=\"\"\n-instcmd=\"$mvprog\"\n chmodcmd=\"$chmodprog 0755\"\n-chowncmd=\"\"\n-chgrpcmd=\"\"\n-stripcmd=\"\"\n+chowncmd=\n+chgrpcmd=\n+stripcmd=\n rmcmd=\"$rmprog -f\"\n mvcmd=\"$mvprog\"\n-src=\"\"\n-dst=\"\"\n-dir_arg=\"\"\n-\n-while [ x\"$1\" != x ]; do\n-    case $1 in\n-\t-c) instcmd=$cpprog\n-\t    shift\n-\t    continue;;\n-\n-\t-d) dir_arg=true\n-\t    shift\n-\t    continue;;\n-\n-\t-m) chmodcmd=\"$chmodprog $2\"\n-\t    shift\n-\t    shift\n-\t    continue;;\n-\n-\t-o) chowncmd=\"$chownprog $2\"\n-\t    shift\n-\t    shift\n-\t    continue;;\n-\n-\t-g) chgrpcmd=\"$chgrpprog $2\"\n-\t    shift\n-\t    shift\n-\t    continue;;\n-\n-\t-s) stripcmd=$stripprog\n-\t    shift\n-\t    continue;;\n-\n-\t-t=*) transformarg=`echo $1 | sed 's/-t=//'`\n-\t    shift\n-\t    continue;;\n-\n-\t-b=*) transformbasename=`echo $1 | sed 's/-b=//'`\n-\t    shift\n-\t    continue;;\n-\n-\t*)  if [ x\"$src\" = x ]\n-\t    then\n-\t\tsrc=$1\n-\t    else\n-\t\t# this colon is to work around a 386BSD /bin/sh bug\n-\t\t:\n-\t\tdst=$1\n-\t    fi\n-\t    shift\n-\t    continue;;\n-    esac\n-done\n-\n-if [ x\"$src\" = x ]\n-then\n-\techo \"$0: no input file specified\" >&2\n-\texit 1\n-else\n-\t:\n-fi\n-\n-if [ x\"$dir_arg\" != x ]; then\n-\tdst=$src\n-\tsrc=\"\"\n-\n-\tif [ -d \"$dst\" ]; then\n-\t\tinstcmd=:\n-\t\tchmodcmd=\"\"\n-\telse\n-\t\tinstcmd=$mkdirprog\n-\tfi\n-else\n-\n-# Waiting for this to be detected by the \"$instcmd $src $dsttmp\" command\n-# might cause directories to be created, which would be especially bad\n-# if $src (and thus $dsttmp) contains '*'.\n-\n-\tif [ -f \"$src\" ] || [ -d \"$src\" ]\n-\tthen\n-\t\t:\n-\telse\n-\t\techo \"$0: $src does not exist\" >&2\n-\t\texit 1\n-\tfi\n-\n-\tif [ x\"$dst\" = x ]\n-\tthen\n-\t\techo \"$0: no destination specified\" >&2\n-\t\texit 1\n-\telse\n-\t\t:\n-\tfi\n-\n-# If destination is a directory, append the input filename; if your system\n-# does not like double slashes in filenames, you may need to add some logic\n-\n-\tif [ -d \"$dst\" ]\n-\tthen\n-\t\tdst=$dst/`basename \"$src\"`\n-\telse\n-\t\t:\n-\tfi\n-fi\n-\n-## this sed command emulates the dirname command\n-dstdir=`echo \"$dst\" | sed -e 's,[^/]*$,,;s,/$,,;s,^$,.,'`\n-\n-# Make sure that the destination directory exists.\n-#  this part is taken from Noah Friedman's mkinstalldirs script\n-\n-# Skip lots of stat calls in the usual case.\n-if [ ! -d \"$dstdir\" ]; then\n-defaultIFS='\n-\t'\n-IFS=\"${IFS-$defaultIFS}\"\n-\n-oIFS=$IFS\n-# Some sh's can't handle IFS=/ for some reason.\n-IFS='%'\n-set - `echo \"$dstdir\" | sed -e 's@/@%@g' -e 's@^%@/@'`\n-IFS=$oIFS\n-\n-pathcomp=''\n-\n-while [ $# -ne 0 ] ; do\n-\tpathcomp=$pathcomp$1\n+src=\n+dst=\n+dir_arg=\n+dstarg=\n+no_target_directory=\n+\n+usage=\"Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE\n+   or: $0 [OPTION]... SRCFILES... DIRECTORY\n+   or: $0 [OPTION]... -t DIRECTORY SRCFILES...\n+   or: $0 [OPTION]... -d DIRECTORIES...\n+\n+In the 1st form, copy SRCFILE to DSTFILE.\n+In the 2nd and 3rd, copy all SRCFILES to DIRECTORY.\n+In the 4th, create DIRECTORIES.\n+\n+Options:\n+-c         (ignored)\n+-d         create directories instead of installing files.\n+-g GROUP   $chgrpprog installed files to GROUP.\n+-m MODE    $chmodprog installed files to MODE.\n+-o USER    $chownprog installed files to USER.\n+-s         $stripprog installed files.\n+-t DIRECTORY  install into DIRECTORY.\n+-T         report an error if DSTFILE is a directory.\n+--help     display this help and exit.\n+--version  display version info and exit.\n+\n+Environment variables override the default commands:\n+  CHGRPPROG CHMODPROG CHOWNPROG CPPROG MKDIRPROG MVPROG RMPROG STRIPPROG\n+\"\n+\n+while test -n \"$1\"; do\n+  case $1 in\n+    -c) shift\n+        continue;;\n+\n+    -d) dir_arg=true\n+        shift\n+        continue;;\n+\n+    -g) chgrpcmd=\"$chgrpprog $2\"\n+        shift\n+        shift\n+        continue;;\n+\n+    --help) echo \"$usage\"; exit $?;;\n+\n+    -m) chmodcmd=\"$chmodprog $2\"\n+        shift\n+        shift\n+        continue;;\n+\n+    -o) chowncmd=\"$chownprog $2\"\n+        shift\n+        shift\n+        continue;;\n+\n+    -s) stripcmd=$stripprog\n+        shift\n+        continue;;\n+\n+    -t) dstarg=$2\n \tshift\n+\tshift\n+\tcontinue;;\n \n-\tif [ ! -d \"$pathcomp\" ] ;\n-        then\n-\t\t$mkdirprog \"$pathcomp\"\n-\telse\n-\t\t:\n-\tfi\n-\n-\tpathcomp=$pathcomp/\n+    -T) no_target_directory=true\n+\tshift\n+\tcontinue;;\n+\n+    --version) echo \"$0 $scriptversion\"; exit $?;;\n+\n+    *)  # When -d is used, all remaining arguments are directories to create.\n+\t# When -t is used, the destination is already specified.\n+\ttest -n \"$dir_arg$dstarg\" && break\n+        # Otherwise, the last argument is the destination.  Remove it from $@.\n+\tfor arg\n+\tdo\n+          if test -n \"$dstarg\"; then\n+\t    # $@ is not empty: it contains at least $arg.\n+\t    set fnord \"$@\" \"$dstarg\"\n+\t    shift # fnord\n+\t  fi\n+\t  shift # arg\n+\t  dstarg=$arg\n+\tdone\n+\tbreak;;\n+  esac\n done\n-fi\n-\n-if [ x\"$dir_arg\" != x ]\n-then\n-\t$doit $instcmd \"$dst\" &&\n \n-\tif [ x\"$chowncmd\" != x ]; then $doit $chowncmd \"$dst\"; else : ; fi &&\n-\tif [ x\"$chgrpcmd\" != x ]; then $doit $chgrpcmd \"$dst\"; else : ; fi &&\n-\tif [ x\"$stripcmd\" != x ]; then $doit $stripcmd \"$dst\"; else : ; fi &&\n-\tif [ x\"$chmodcmd\" != x ]; then $doit $chmodcmd \"$dst\"; else : ; fi\n-else\n-\n-# If we're going to rename the final executable, determine the name now.\n-\n-\tif [ x\"$transformarg\" = x ]\n-\tthen\n-\t\tdstfile=`basename \"$dst\"`\n-\telse\n-\t\tdstfile=`basename \"$dst\" $transformbasename |\n-\t\t\tsed $transformarg`$transformbasename\n-\tfi\n-\n-# don't allow the sed command to completely eliminate the filename\n-\n-\tif [ x\"$dstfile\" = x ]\n-\tthen\n-\t\tdstfile=`basename \"$dst\"`\n-\telse\n-\t\t:\n-\tfi\n-\n-# Make a couple of temp file names in the proper directory.\n-\n-\tdsttmp=$dstdir/_inst.$$_\n-\trmtmp=$dstdir/_rm.$$_\n-\n-# Trap to clean up temp files at exit.\n-\n-\ttrap 'status=$?; rm -f \"$dsttmp\" \"$rmtmp\" && exit $status' 0\n-\ttrap '(exit $?); exit' 1 2 13 15\n-\n-# Move or copy the file name to the temp name\n-\n-\t$doit $instcmd \"$src\" \"$dsttmp\" &&\n-\n-# and set any options; do chmod last to preserve setuid bits\n-\n-# If any of these fail, we abort the whole thing.  If we want to\n-# ignore errors from any of these, just make sure not to ignore\n-# errors from the above \"$doit $instcmd $src $dsttmp\" command.\n-\n-\tif [ x\"$chowncmd\" != x ]; then $doit $chowncmd \"$dsttmp\"; else :;fi &&\n-\tif [ x\"$chgrpcmd\" != x ]; then $doit $chgrpcmd \"$dsttmp\"; else :;fi &&\n-\tif [ x\"$stripcmd\" != x ]; then $doit $stripcmd \"$dsttmp\"; else :;fi &&\n-\tif [ x\"$chmodcmd\" != x ]; then $doit $chmodcmd \"$dsttmp\"; else :;fi &&\n-\n-# Now remove or move aside any old file at destination location.  We try this\n-# two ways since rm can't unlink itself on some systems and the destination\n-# file might be busy for other reasons.  In this case, the final cleanup\n-# might fail but the new file should still install successfully.\n-\n-{\n-\tif [ -f \"$dstdir/$dstfile\" ]\n-\tthen\n-\t\t$doit $rmcmd -f \"$dstdir/$dstfile\" 2>/dev/null ||\n-\t\t$doit $mvcmd -f \"$dstdir/$dstfile\" \"$rmtmp\" 2>/dev/null ||\n-\t\t{\n-\t\t  echo \"$0: cannot unlink or rename $dstdir/$dstfile\" >&2\n-\t\t  (exit 1); exit\n-\t\t}\n-\telse\n-\t\t:\n-\tfi\n-} &&\n-\n-# Now rename the file to the real destination.\n+if test -z \"$1\"; then\n+  if test -z \"$dir_arg\"; then\n+    echo \"$0: no input file specified.\" >&2\n+    exit 1\n+  fi\n+  # It's OK to call `install-sh -d' without argument.\n+  # This can happen when creating conditional directories.\n+  exit 0\n+fi\n \n-\t$doit $mvcmd \"$dsttmp\" \"$dstdir/$dstfile\"\n+for src\n+do\n+  # Protect names starting with `-'.\n+  case $src in\n+    -*) src=./$src ;;\n+  esac\n+\n+  if test -n \"$dir_arg\"; then\n+    dst=$src\n+    src=\n+\n+    if test -d \"$dst\"; then\n+      mkdircmd=:\n+      chmodcmd=\n+    else\n+      mkdircmd=$mkdirprog\n+    fi\n+  else\n+    # Waiting for this to be detected by the \"$cpprog $src $dsttmp\" command\n+    # might cause directories to be created, which would be especially bad\n+    # if $src (and thus $dsttmp) contains '*'.\n+    if test ! -f \"$src\" && test ! -d \"$src\"; then\n+      echo \"$0: $src does not exist.\" >&2\n+      exit 1\n+    fi\n+\n+    if test -z \"$dstarg\"; then\n+      echo \"$0: no destination specified.\" >&2\n+      exit 1\n+    fi\n+\n+    dst=$dstarg\n+    # Protect names starting with `-'.\n+    case $dst in\n+      -*) dst=./$dst ;;\n+    esac\n \n-fi &&\n+    # If destination is a directory, append the input filename; won't work\n+    # if double slashes aren't ignored.\n+    if test -d \"$dst\"; then\n+      if test -n \"$no_target_directory\"; then\n+\techo \"$0: $dstarg: Is a directory\" >&2\n+\texit 1\n+      fi\n+      dst=$dst/`basename \"$src\"`\n+    fi\n+  fi\n+\n+  # This sed command emulates the dirname command.\n+  dstdir=`echo \"$dst\" | sed -e 's,/*$,,;s,[^/]*$,,;s,/*$,,;s,^$,.,'`\n+\n+  # Make sure that the destination directory exists.\n+\n+  # Skip lots of stat calls in the usual case.\n+  if test ! -d \"$dstdir\"; then\n+    defaultIFS='\n+\t '\n+    IFS=\"${IFS-$defaultIFS}\"\n+\n+    oIFS=$IFS\n+    # Some sh's can't handle IFS=/ for some reason.\n+    IFS='%'\n+    set x `echo \"$dstdir\" | sed -e 's@/@%@g' -e 's@^%@/@'`\n+    shift\n+    IFS=$oIFS\n+\n+    pathcomp=\n+\n+    while test $# -ne 0 ; do\n+      pathcomp=$pathcomp$1\n+      shift\n+      if test ! -d \"$pathcomp\"; then\n+        $mkdirprog \"$pathcomp\"\n+\t# mkdir can fail with a `File exist' error in case several\n+\t# install-sh are creating the directory concurrently.  This\n+\t# is OK.\n+\ttest -d \"$pathcomp\" || exit\n+      fi\n+      pathcomp=$pathcomp/\n+    done\n+  fi\n+\n+  if test -n \"$dir_arg\"; then\n+    $doit $mkdircmd \"$dst\" \\\n+      && { test -z \"$chowncmd\" || $doit $chowncmd \"$dst\"; } \\\n+      && { test -z \"$chgrpcmd\" || $doit $chgrpcmd \"$dst\"; } \\\n+      && { test -z \"$stripcmd\" || $doit $stripcmd \"$dst\"; } \\\n+      && { test -z \"$chmodcmd\" || $doit $chmodcmd \"$dst\"; }\n+\n+  else\n+    dstfile=`basename \"$dst\"`\n+\n+    # Make a couple of temp file names in the proper directory.\n+    dsttmp=$dstdir/_inst.$$_\n+    rmtmp=$dstdir/_rm.$$_\n+\n+    # Trap to clean up those temp files at exit.\n+    trap 'ret=$?; rm -f \"$dsttmp\" \"$rmtmp\" && exit $ret' 0\n+    trap '(exit $?); exit' 1 2 13 15\n+\n+    # Copy the file name to the temp name.\n+    $doit $cpprog \"$src\" \"$dsttmp\" &&\n+\n+    # and set any options; do chmod last to preserve setuid bits.\n+    #\n+    # If any of these fail, we abort the whole thing.  If we want to\n+    # ignore errors from any of these, just make sure not to ignore\n+    # errors from the above \"$doit $cpprog $src $dsttmp\" command.\n+    #\n+    { test -z \"$chowncmd\" || $doit $chowncmd \"$dsttmp\"; } \\\n+      && { test -z \"$chgrpcmd\" || $doit $chgrpcmd \"$dsttmp\"; } \\\n+      && { test -z \"$stripcmd\" || $doit $stripcmd \"$dsttmp\"; } \\\n+      && { test -z \"$chmodcmd\" || $doit $chmodcmd \"$dsttmp\"; } &&\n+\n+    # Now rename the file to the real destination.\n+    { $doit $mvcmd -f \"$dsttmp\" \"$dstdir/$dstfile\" 2>/dev/null \\\n+      || {\n+\t   # The rename failed, perhaps because mv can't rename something else\n+\t   # to itself, or perhaps because mv is so ancient that it does not\n+\t   # support -f.\n+\n+\t   # Now remove or move aside any old file at destination location.\n+\t   # We try this two ways since rm can't unlink itself on some\n+\t   # systems and the destination file might be busy for other\n+\t   # reasons.  In this case, the final cleanup might fail but the new\n+\t   # file should still install successfully.\n+\t   {\n+\t     if test -f \"$dstdir/$dstfile\"; then\n+\t       $doit $rmcmd -f \"$dstdir/$dstfile\" 2>/dev/null \\\n+\t       || $doit $mvcmd -f \"$dstdir/$dstfile\" \"$rmtmp\" 2>/dev/null \\\n+\t       || {\n+\t\t echo \"$0: cannot unlink or rename $dstdir/$dstfile\" >&2\n+\t\t (exit 1); exit 1\n+\t       }\n+\t     else\n+\t       :\n+\t     fi\n+\t   } &&\n+\n+\t   # Now rename the file to the real destination.\n+\t   $doit $mvcmd \"$dsttmp\" \"$dstdir/$dstfile\"\n+\t }\n+    }\n+  fi || { (exit 1); exit 1; }\n+done\n \n # The final little trick to \"correctly\" pass the exit status to the exit trap.\n-\n {\n-\t(exit 0); exit\n+  (exit 0); exit 0\n }\n+\n+# Local variables:\n+# eval: (add-hook 'write-file-hooks 'time-stamp)\n+# time-stamp-start: \"scriptversion=\"\n+# time-stamp-format: \"%:y-%02m-%02d.%02H\"\n+# time-stamp-end: \"$\"\n+# End:"}, {"sha": "6b5d8890efa77113e8f033ecdee9e24692c48cee", "filename": "libjava/libltdl/ltdl.c", "status": "modified", "additions": 93, "deletions": 74, "changes": 167, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fltdl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fltdl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Fltdl.c?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -1,5 +1,5 @@\n /* ltdl.c -- system independent dlopen wrapper\n-   Copyright (C) 1998, 1999, 2000 Free Software Foundation, Inc.\n+   Copyright (C) 1998, 1999, 2000, 2004, 2006  Free Software Foundation, Inc.\n    Originally by Thomas Tanner <tanner@ffii.org>\n    This file is part of GNU Libtool.\n \n@@ -20,15 +20,19 @@ Lesser General Public License for more details.\n \n You should have received a copy of the GNU Lesser General Public\n License along with this library; if not, write to the Free Software\n-Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA\n-02111-1307  USA\n+Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA\n+02110-1301  USA\n \n */\n \n #if HAVE_CONFIG_H\n #  include <config.h>\n #endif\n \n+#if HAVE_BOEHM_GC\n+#  include <gc.h>\n+#endif\n+\n #if HAVE_UNISTD_H\n #  include <unistd.h>\n #endif\n@@ -37,8 +41,14 @@ Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA\n #  include <stdio.h>\n #endif\n \n+/* Include the header defining malloc.  On K&R C compilers,\n+   that's <malloc.h>, on ANSI C and ISO C compilers, that's <stdlib.h>.  */\n #if HAVE_STDLIB_H\n #  include <stdlib.h>\n+#else\n+#  if HAVE_MALLOC_H\n+#    include <malloc.h>\n+#  endif\n #endif\n \n #if HAVE_STRING_H\n@@ -53,10 +63,6 @@ Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA\n #  include <ctype.h>\n #endif\n \n-#if HAVE_MALLOC_H\n-#  include <malloc.h>\n-#endif\n-\n #if HAVE_MEMORY_H\n #  include <memory.h>\n #endif\n@@ -65,10 +71,6 @@ Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA\n #  include <errno.h>\n #endif\n \n-#if HAVE_BOEHM_GC\n-#include <gc.h>\n-#endif\n-\n \n #ifndef __WINDOWS__\n #  ifdef __WIN32__\n@@ -241,7 +243,7 @@ LT_GLOBAL_DATA void   (*lt_dlfree)\tLT_PARAMS((lt_ptr ptr))\n #else\n \n #define LT_DLMALLOC(tp, n)\t((tp *) lt_dlmalloc ((n) * sizeof(tp)))\n-#define LT_DLREALLOC(tp, p, n)\t((tp *) rpl_realloc ((p), (n) * sizeof(tp)))\n+#define LT_DLREALLOC(tp, p, n)\t((tp *) lt_dlrealloc ((p), (n) * sizeof(tp)))\n #define LT_DLFREE(p)\t\t\t\t\t\t\\\n \tLT_STMT_START { if (p) (p) = (lt_dlfree (p), (lt_ptr) 0); } LT_STMT_END\n \n@@ -387,11 +389,13 @@ memcpy (dest, src, size)\n      const lt_ptr src;\n      size_t size;\n {\n-  size_t i = 0;\n+  const char *\ts = src;\n+  char *\td = dest;\n+  size_t\ti = 0;\n \n   for (i = 0; i < size; ++i)\n     {\n-      dest[i] = src[i];\n+      d[i] = s[i];\n     }\n \n   return dest;\n@@ -411,17 +415,21 @@ memmove (dest, src, size)\n      const lt_ptr src;\n      size_t size;\n {\n-  size_t i;\n+  const char *\ts = src;\n+  char *\td = dest;\n+  size_t\ti;\n \n-  if (dest < src)\n+  if (d < s)\n     for (i = 0; i < size; ++i)\n       {\n-\tdest[i] = src[i];\n+\td[i] = s[i];\n       }\n-  else if (dest > src)\n-    for (i = size -1; i >= 0; --i)\n+  else if (d > s && size > 0)\n+    for (i = size -1; ; --i)\n       {\n-\tdest[i] = src[i];\n+\td[i] = s[i];\n+\tif (i == 0)\n+\t  break;\n       }\n \n   return dest;\n@@ -453,7 +461,9 @@ opendir (path)\n   DIR *entry;\n \n   assert(path != (char *) NULL);\n-  (void) strncpy(file_specification,path,LT_FILENAME_MAX-1);\n+  /* allow space for: path + '\\\\' '\\\\' '*' '.' '*' + '\\0' */\n+  (void) strncpy (file_specification, path, LT_FILENAME_MAX-6);\n+  file_specification[LT_FILENAME_MAX-6] = LT_EOS_CHAR;\n   (void) strcat(file_specification,\"\\\\\");\n   entry = LT_DLMALLOC (DIR,sizeof(DIR));\n   if (entry != (DIR *) 0)\n@@ -494,6 +504,7 @@ static struct dirent *readdir(entry)\n   entry->firsttime = FALSE;\n   (void) strncpy(entry->file_info.d_name,entry->Win32FindData.cFileName,\n     LT_FILENAME_MAX-1);\n+  entry->file_info.d_name[LT_FILENAME_MAX - 1] = LT_EOS_CHAR;\n   entry->file_info.d_namlen = strlen(entry->file_info.d_name);\n   return(&entry->file_info);\n }\n@@ -686,7 +697,7 @@ argz_insert (pargz, pargz_len, before, entry)\n   /* This probably indicates a programmer error, but to preserve\n      semantics, scan back to the start of an entry if BEFORE points\n      into the middle of it.  */\n-  while ((before >= *pargz) && (before[-1] != LT_EOS_CHAR))\n+  while ((before > *pargz) && (before[-1] != LT_EOS_CHAR))\n     --before;\n \n   {\n@@ -1020,7 +1031,7 @@ lt_erealloc (addr, size)\n      lt_ptr addr;\n      size_t size;\n {\n-  lt_ptr mem = realloc (addr, size);\n+  lt_ptr mem = lt_dlrealloc (addr, size);\n   if (size && !mem)\n     LT_DLMUTEX_SETERROR (LT_DLSTRERROR (NO_MEMORY));\n   return mem;\n@@ -1584,7 +1595,11 @@ static struct lt_user_dlloader sys_dld = {\n \n \n #if HAVE_MACH_O_DYLD_H\n-#  include <mach-o/dyld.h>\n+#if !defined(__APPLE_CC__) && !defined(__MWERKS__) && !defined(__private_extern__)\n+/* Is this correct? Does it still function properly? */\n+#define __private_extern__ extern\n+#endif\n+# include <mach-o/dyld.h>\n #endif\n #include <mach-o/getsect.h>\n \n@@ -1610,14 +1625,14 @@ static enum DYLD_BOOL (*ltdl_NSIsSymbolNameDefinedInImage)(const struct mach_hea\n static enum DYLD_BOOL (*ltdl_NSMakePrivateModulePublic)(NSModule module) = 0;\n \n #ifndef NSADDIMAGE_OPTION_NONE\n-#define NSADDIMAGE_OPTION_NONE                          0x0    \n+#define NSADDIMAGE_OPTION_NONE                          0x0\n #endif\n #ifndef NSADDIMAGE_OPTION_RETURN_ON_ERROR\n #define NSADDIMAGE_OPTION_RETURN_ON_ERROR               0x1\n-#endif    \n+#endif\n #ifndef NSADDIMAGE_OPTION_WITH_SEARCHING\n #define NSADDIMAGE_OPTION_WITH_SEARCHING                0x2\n-#endif    \n+#endif\n #ifndef NSADDIMAGE_OPTION_RETURN_ONLY_IF_LOADED\n #define NSADDIMAGE_OPTION_RETURN_ONLY_IF_LOADED         0x4\n #endif\n@@ -1626,7 +1641,7 @@ static enum DYLD_BOOL (*ltdl_NSMakePrivateModulePublic)(NSModule module) = 0;\n #endif\n #ifndef NSLOOKUPSYMBOLINIMAGE_OPTION_BIND\n #define NSLOOKUPSYMBOLINIMAGE_OPTION_BIND            0x0\n-#endif   \n+#endif\n #ifndef NSLOOKUPSYMBOLINIMAGE_OPTION_BIND_NOW\n #define NSLOOKUPSYMBOLINIMAGE_OPTION_BIND_NOW        0x1\n #endif\n@@ -1647,11 +1662,11 @@ lt_int_dyld_error(othererror)\n \tint lerno;\n \tconst char *errstr;\n \tconst char *file;\n-\tNSLinkEditError(&ler,&lerno,&file,&errstr);\t\n+\tNSLinkEditError(&ler,&lerno,&file,&errstr);\n \tif (!errstr || !strlen(errstr)) errstr = othererror;\n \treturn errstr;\n }\n- \n+\n static const struct mach_header *\n lt_int_dyld_get_mach_header_from_nsmodule(module)\n \tNSModule module;\n@@ -1675,7 +1690,7 @@ lt_int_dyld_get_mach_header_from_nsmodule(module)\n \n static const char* lt_int_dyld_lib_install_name(mh)\n \tconst struct mach_header *mh;\n-{\t\n+{\n /* NSAddImage is also used to get the loaded image, but it only works if the lib\n    is installed, for uninstalled libs we need to check the install_names against\n    each other. Note that this is still broken if DYLD_IMAGE_SUFFIX is set and a\n@@ -1684,14 +1699,13 @@ static const char* lt_int_dyld_lib_install_name(mh)\n \tint j;\n \tstruct load_command *lc;\n \tunsigned long offset = sizeof(struct mach_header);\n-\tconst struct mach_header *mh1;\n \tconst char* retStr=NULL;\n \tfor (j = 0; j < mh->ncmds; j++)\n \t{\n \t\tlc = (struct load_command*)(((unsigned long)mh) + offset);\n \t\tif (LC_ID_DYLIB == lc->cmd)\n \t\t{\n-\t\t\tretStr=(char*)(((struct dylib_command*)lc)->dylib.name.offset + \n+\t\t\tretStr=(char*)(((struct dylib_command*)lc)->dylib.name.offset +\n \t\t\t\t\t\t\t\t\t(unsigned long)lc);\n \t\t}\n \t\toffset += lc->cmdsize;\n@@ -1705,7 +1719,7 @@ lt_int_dyld_match_loaded_lib_by_install_name(const char *name)\n \tint i=_dyld_image_count();\n \tint j;\n \tconst struct mach_header *mh=NULL;\n-\tconst char *id=NULL;\t\n+\tconst char *id=NULL;\n \tfor (j = 0; j < i; j++)\n \t{\n \t\tid=lt_int_dyld_lib_install_name(_dyld_get_image_header(j));\n@@ -1717,7 +1731,7 @@ lt_int_dyld_match_loaded_lib_by_install_name(const char *name)\n \t}\n \treturn mh;\n }\n-\t\n+\n static NSSymbol\n lt_int_dyld_NSlookupSymbolInLinkedLibs(symbol,mh)\n \tconst char *symbol;\n@@ -1736,26 +1750,26 @@ lt_int_dyld_NSlookupSymbolInLinkedLibs(symbol,mh)\n \t\t\tlc = (struct load_command*)(((unsigned long)mh) + offset);\n \t\t\tif ((LC_LOAD_DYLIB == lc->cmd) || (LC_LOAD_WEAK_DYLIB == lc->cmd))\n \t\t\t{\n-\t\t\t\tmh1=lt_int_dyld_match_loaded_lib_by_install_name((char*)(((struct dylib_command*)lc)->dylib.name.offset + \n+\t\t\t\tmh1=lt_int_dyld_match_loaded_lib_by_install_name((char*)(((struct dylib_command*)lc)->dylib.name.offset +\n \t\t\t\t\t\t\t\t\t\t(unsigned long)lc));\n \t\t\t\tif (!mh1)\n-\t\t\t\t{\t\n-\t\t\t\t\t/* Maybe NSAddImage can find it */\t\t\t\t\t\t\t\t\t\t\t\t\n-\t\t\t\t\tmh1=ltdl_NSAddImage((char*)(((struct dylib_command*)lc)->dylib.name.offset + \n+\t\t\t\t{\n+\t\t\t\t\t/* Maybe NSAddImage can find it */\n+\t\t\t\t\tmh1=ltdl_NSAddImage((char*)(((struct dylib_command*)lc)->dylib.name.offset +\n \t\t\t\t\t\t\t\t\t\t(unsigned long)lc),\n-\t\t\t\t\t\t\t\t\t\tNSADDIMAGE_OPTION_RETURN_ONLY_IF_LOADED + \n+\t\t\t\t\t\t\t\t\t\tNSADDIMAGE_OPTION_RETURN_ONLY_IF_LOADED +\n \t\t\t\t\t\t\t\t\t\tNSADDIMAGE_OPTION_WITH_SEARCHING +\n \t\t\t\t\t\t\t\t\t\tNSADDIMAGE_OPTION_RETURN_ON_ERROR );\n-\t\t\t\t}\t\t\t\t\t\t\n+\t\t\t\t}\n \t\t\t\tif (mh1)\n \t\t\t\t{\n \t\t\t\t\tretSym = ltdl_NSLookupSymbolInImage(mh1,\n \t\t\t\t\t\t\t\t\t\t\tsymbol,\n-\t\t\t\t\t\t\t\t\t\t\tNSLOOKUPSYMBOLINIMAGE_OPTION_BIND_NOW \n+\t\t\t\t\t\t\t\t\t\t\tNSLOOKUPSYMBOLINIMAGE_OPTION_BIND_NOW\n \t\t\t\t\t\t\t\t\t\t\t| NSLOOKUPSYMBOLINIMAGE_OPTION_RETURN_ON_ERROR\n \t\t\t\t\t\t\t\t\t\t\t);\n-\t\t\t\t\tif (retSym) break;\t\t\t\t\t\t\n-\t\t\t\t}\t\t\t\t\t\t\n+\t\t\t\t\tif (retSym) break;\n+\t\t\t\t}\n \t\t\t}\n \t\t\toffset += lc->cmdsize;\n \t\t}\n@@ -1768,7 +1782,7 @@ sys_dyld_init()\n {\n \tint retCode = 0;\n \tint err = 0;\n-\tif (!_dyld_present()) { \n+\tif (!_dyld_present()) {\n \t\tretCode=1;\n \t}\n \telse {\n@@ -1788,8 +1802,8 @@ sys_dyld_open (loader_data, filename)\n \tlt_module   module   = 0;\n \tNSObjectFileImage ofi = 0;\n \tNSObjectFileImageReturnCode ofirc;\n-\t\n-  \tif (!filename) \n+\n+  \tif (!filename)\n   \t\treturn (lt_module)-1;\n \tofirc = NSCreateObjectFileImageFromFile(filename, &ofi);\n \tswitch (ofirc)\n@@ -1806,9 +1820,9 @@ sys_dyld_open (loader_data, filename)\n \t\tcase NSObjectFileImageInappropriateFile:\n \t\t    if (ltdl_NSIsSymbolNameDefinedInImage && ltdl_NSLookupSymbolInImage)\n \t\t    {\n-\t\t\t\tmodule = (lt_module)ltdl_NSAddImage(filename, NSADDIMAGE_OPTION_RETURN_ON_ERROR);\t\n+\t\t\t\tmodule = (lt_module)ltdl_NSAddImage(filename, NSADDIMAGE_OPTION_RETURN_ON_ERROR);\n \t\t\t\tbreak;\n-\t\t\t}\t\n+\t\t\t}\n \t\tdefault:\n \t\t\tLT_DLMUTEX_SETERROR (lt_int_dyld_error(LT_DLSTRERROR(CANNOT_OPEN)));\n \t\t\treturn 0;\n@@ -1824,13 +1838,12 @@ sys_dyld_close (loader_data, module)\n {\n \tint retCode = 0;\n \tint flags = 0;\n-\tunsigned long size=0;\n \tif (module == (lt_module)-1) return 0;\n-#ifdef __BIG_ENDIAN__  \t\n+#ifdef __BIG_ENDIAN__\n   \tif (((struct mach_header *)module)->magic == MH_MAGIC)\n-#else  \t\n+#else\n     if (((struct mach_header *)module)->magic == MH_CIGAM)\n-#endif \n+#endif\n \t{\n \t  LT_DLMUTEX_SETERROR(\"Can not close a dylib\");\n \t  retCode = 1;\n@@ -1841,24 +1854,24 @@ sys_dyld_close (loader_data, module)\n /* Currently, if a module contains c++ static destructors and it is unloaded, we\n    get a segfault in atexit(), due to compiler and dynamic loader differences of\n    opinion, this works around that.\n-*/   \n-\t\tif ((const struct section *)NULL != \n+*/\n+\t\tif ((const struct section *)NULL !=\n \t\t   getsectbynamefromheader(lt_int_dyld_get_mach_header_from_nsmodule(module),\n \t\t   \"__DATA\",\"__mod_term_func\"))\n \t\t{\n \t\t\tflags += NSUNLINKMODULE_OPTION_KEEP_MEMORY_MAPPED;\n-\t\t} \n-#endif\t\t\n+\t\t}\n+#endif\n #ifdef __ppc__\n \t\t\tflags += NSUNLINKMODULE_OPTION_RESET_LAZY_REFERENCES;\n #endif\n \t\tif (!NSUnLinkModule(module,flags))\n \t\t{\n \t\t\tretCode=1;\n \t\t\tLT_DLMUTEX_SETERROR (lt_int_dyld_error(LT_DLSTRERROR(CANNOT_CLOSE)));\n-\t\t}\t\t\t\t\t\t\t\t\t\t\n+\t\t}\n \t}\n-\t\n+\n  return retCode;\n }\n \n@@ -1872,44 +1885,47 @@ sys_dyld_sym (loader_data, module, symbol)\n   \tNSSymbol *nssym = 0;\n   \tvoid *unused;\n   \tconst struct mach_header *mh=NULL;\n+  \tchar saveError[256] = \"Symbol not found\";\n   \tif (module == (lt_module)-1)\n   \t{\n   \t\t_dyld_lookup_and_bind(symbol,(unsigned long*)&address,&unused);\n   \t\treturn address;\n   \t}\n-#ifdef __BIG_ENDIAN__  \t\n+#ifdef __BIG_ENDIAN__\n   \tif (((struct mach_header *)module)->magic == MH_MAGIC)\n-#else  \t\n+#else\n     if (((struct mach_header *)module)->magic == MH_CIGAM)\n-#endif    \n+#endif\n   \t{\n   \t    if (ltdl_NSIsSymbolNameDefinedInImage && ltdl_NSLookupSymbolInImage)\n   \t    {\n   \t    \tmh=module;\n-\t\t\tif (ltdl_NSIsSymbolNameDefinedInImage((struct mach_header*)module,symbol)) \n+\t\t\tif (ltdl_NSIsSymbolNameDefinedInImage((struct mach_header*)module,symbol))\n \t\t\t{\n \t\t\t\tnssym = ltdl_NSLookupSymbolInImage((struct mach_header*)module,\n \t\t\t\t\t\t\t\t\t\t\tsymbol,\n-\t\t\t\t\t\t\t\t\t\t\tNSLOOKUPSYMBOLINIMAGE_OPTION_BIND_NOW \n+\t\t\t\t\t\t\t\t\t\t\tNSLOOKUPSYMBOLINIMAGE_OPTION_BIND_NOW\n \t\t\t\t\t\t\t\t\t\t\t| NSLOOKUPSYMBOLINIMAGE_OPTION_RETURN_ON_ERROR\n \t\t\t\t\t\t\t\t\t\t\t);\n \t\t\t}\n-\t    }\t\n-  \n-  \t}    \n+\t    }\n+\n+  \t}\n   else {\n \tnssym = NSLookupSymbolInModule(module, symbol);\n \t}\n-\tif (!nssym) \n+\tif (!nssym)\n \t{\n+\t\tstrncpy(saveError, lt_int_dyld_error(LT_DLSTRERROR(SYMBOL_NOT_FOUND)), 255);\n+\t\tsaveError[255] = 0;\n \t\tif (!mh) mh=lt_int_dyld_get_mach_header_from_nsmodule(module);\n \t\tnssym = lt_int_dyld_NSlookupSymbolInLinkedLibs(symbol,mh);\n-\t}\t\t\n-\tif (!nssym) \n+\t}\n+\tif (!nssym)\n \t{\n-\t\tLT_DLMUTEX_SETERROR (lt_int_dyld_error(LT_DLSTRERROR(SYMBOL_NOT_FOUND)));\n+\t\tLT_DLMUTEX_SETERROR (saveError);\n \t\treturn NULL;\n-\t}\t\n+\t}\n \treturn NSAddressOfSymbol(nssym);\n }\n \n@@ -2988,6 +3004,9 @@ trim (dest, str)\n \n   LT_DLFREE (*dest);\n \n+  if (!end)\n+    return 1;\n+\n   if (len > 3 && str[0] == '\\'')\n     {\n       tmp = LT_EMALLOC (char, end - str);\n@@ -3092,7 +3111,7 @@ try_dlopen (phandle, filename)\n       ++base_name;\n     }\n   else\n-    LT_DLMEM_REASSIGN (base_name, canonical);\n+    base_name = canonical;\n \n   assert (base_name && *base_name);\n \n@@ -3923,7 +3942,7 @@ lt_dlerror ()\n   LT_DLMUTEX_GETERROR (error);\n   LT_DLMUTEX_SETERROR (0);\n \n-  return error ? error : LT_DLSTRERROR (UNKNOWN);\n+  return error ? error : NULL;\n }\n \n static int"}, {"sha": "8aaf3429ad42da3e1d3c0e97100583b3ea8848a8", "filename": "libjava/libltdl/ltdl.h", "status": "modified", "additions": 39, "deletions": 34, "changes": 73, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fltdl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fltdl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Fltdl.h?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -20,8 +20,8 @@ Lesser General Public License for more details.\n \n You should have received a copy of the GNU Lesser General Public\n License along with this library; if not, write to the Free\n-Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA\n-02111-1307  USA\n+Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA\n+02110-1301  USA\n */\n \n /* Only include this header file once. */\n@@ -79,7 +79,7 @@ LT_BEGIN_C_DECLS\n \n /* LT_CONC creates a new concatenated symbol for the compiler\n    in a portable way.  */\n-#if defined(__STDC__) || defined(__cplusplus)\n+#if defined(__STDC__) || defined(__cplusplus) || defined(_MSC_VER)\n #  define LT_CONC(s,t)\ts##t\n #else\n #  define LT_CONC(s,t)\ts/**/t\n@@ -111,6 +111,7 @@ LT_BEGIN_C_DECLS\n #  endif\n #endif\n \n+\n #ifdef __WINDOWS__\n #  ifndef __CYGWIN__\n /* LT_DIRSEP_CHAR is accepted *in addition* to '/' as a directory\n@@ -140,6 +141,10 @@ LT_BEGIN_C_DECLS\n #endif\n \n \n+#if defined(_MSC_VER) /* Visual Studio */\n+#  define R_OK 4\n+#endif\n+\n \n \f\n /* --- DYNAMIC MODULE LOADING API --- */\n@@ -148,31 +153,31 @@ LT_BEGIN_C_DECLS\n typedef\tstruct lt_dlhandle_struct *lt_dlhandle;\t/* A loaded module.  */\n \n /* Initialisation and finalisation functions for libltdl. */\n-extern\tint\t    lt_dlinit\t\tLT_PARAMS((void));\n-extern\tint\t    lt_dlexit\t\tLT_PARAMS((void));\n+LT_SCOPE\tint\t    lt_dlinit\t\tLT_PARAMS((void));\n+LT_SCOPE\tint\t    lt_dlexit\t\tLT_PARAMS((void));\n \n /* Module search path manipulation.  */\n-extern\tint\t    lt_dladdsearchdir\t LT_PARAMS((const char *search_dir));\n-extern\tint\t    lt_dlinsertsearchdir LT_PARAMS((const char *before,\n+LT_SCOPE\tint\t    lt_dladdsearchdir\t LT_PARAMS((const char *search_dir));\n+LT_SCOPE\tint\t    lt_dlinsertsearchdir LT_PARAMS((const char *before,\n \t\t\t\t\t\t    const char *search_dir));\n-extern\tint \t    lt_dlsetsearchpath\t LT_PARAMS((const char *search_path));\n-extern\tconst char *lt_dlgetsearchpath\t LT_PARAMS((void));\n-extern\tint\t    lt_dlforeachfile\t LT_PARAMS((\n+LT_SCOPE\tint \t    lt_dlsetsearchpath\t LT_PARAMS((const char *search_path));\n+LT_SCOPE\tconst char *lt_dlgetsearchpath\t LT_PARAMS((void));\n+LT_SCOPE\tint\t    lt_dlforeachfile\t LT_PARAMS((\n \t\t\tconst char *search_path,\n \t\t\tint (*func) (const char *filename, lt_ptr data),\n \t\t\tlt_ptr data));\n \n /* Portable libltdl versions of the system dlopen() API. */\n-extern\tlt_dlhandle lt_dlopen\t\tLT_PARAMS((const char *filename));\n-extern\tlt_dlhandle lt_dlopenext\tLT_PARAMS((const char *filename));\n-extern\tlt_ptr\t    lt_dlsym\t\tLT_PARAMS((lt_dlhandle handle,\n+LT_SCOPE\tlt_dlhandle lt_dlopen\t\tLT_PARAMS((const char *filename));\n+LT_SCOPE\tlt_dlhandle lt_dlopenext\tLT_PARAMS((const char *filename));\n+LT_SCOPE\tlt_ptr\t    lt_dlsym\t\tLT_PARAMS((lt_dlhandle handle,\n \t\t\t\t\t\t     const char *name));\n-extern\tconst char *lt_dlerror\t\tLT_PARAMS((void));\n-extern\tint\t    lt_dlclose\t\tLT_PARAMS((lt_dlhandle handle));\n+LT_SCOPE\tconst char *lt_dlerror\t\tLT_PARAMS((void));\n+LT_SCOPE\tint\t    lt_dlclose\t\tLT_PARAMS((lt_dlhandle handle));\n \n /* Module residency management. */\n-extern\tint\t    lt_dlmakeresident\tLT_PARAMS((lt_dlhandle handle));\n-extern\tint\t    lt_dlisresident\tLT_PARAMS((lt_dlhandle handle));\n+LT_SCOPE\tint\t    lt_dlmakeresident\tLT_PARAMS((lt_dlhandle handle));\n+LT_SCOPE\tint\t    lt_dlisresident\tLT_PARAMS((lt_dlhandle handle));\n \n \n \n@@ -185,7 +190,7 @@ typedef void\tlt_dlmutex_unlock\tLT_PARAMS((void));\n typedef void\tlt_dlmutex_seterror\tLT_PARAMS((const char *errmsg));\n typedef const char *lt_dlmutex_geterror\tLT_PARAMS((void));\n \n-extern\tint\tlt_dlmutex_register\tLT_PARAMS((lt_dlmutex_lock *lock,\n+LT_SCOPE\tint\tlt_dlmutex_register\tLT_PARAMS((lt_dlmutex_lock *lock,\n \t\t\t\t\t    lt_dlmutex_unlock *unlock,\n \t\t\t\t\t    lt_dlmutex_seterror *seterror,\n \t\t\t\t\t    lt_dlmutex_geterror *geterror));\n@@ -218,8 +223,8 @@ typedef struct {\n   lt_ptr      address;\n } lt_dlsymlist;\n \n-extern\tint\tlt_dlpreload\tLT_PARAMS((const lt_dlsymlist *preloaded));\n-extern\tint\tlt_dlpreload_default\n+LT_SCOPE\tint\tlt_dlpreload\tLT_PARAMS((const lt_dlsymlist *preloaded));\n+LT_SCOPE\tint\tlt_dlpreload_default\n \t\t\t\tLT_PARAMS((const lt_dlsymlist *preloaded));\n \n #define LTDL_SET_PRELOADED_SYMBOLS() \t\tLT_STMT_START{\t\\\n@@ -241,20 +246,20 @@ typedef\tstruct {\n \t\t\t\t   number of times lt_dlclosed. */\n } lt_dlinfo;\n \n-extern\tconst lt_dlinfo\t*lt_dlgetinfo\t    LT_PARAMS((lt_dlhandle handle));\n-extern\tlt_dlhandle\tlt_dlhandle_next    LT_PARAMS((lt_dlhandle place));\n-extern\tint\t\tlt_dlforeach\t    LT_PARAMS((\n+LT_SCOPE\tconst lt_dlinfo\t*lt_dlgetinfo\t    LT_PARAMS((lt_dlhandle handle));\n+LT_SCOPE\tlt_dlhandle\tlt_dlhandle_next    LT_PARAMS((lt_dlhandle place));\n+LT_SCOPE\tint\t\tlt_dlforeach\t    LT_PARAMS((\n \t\t\t\tint (*func) (lt_dlhandle handle, lt_ptr data),\n \t\t\t\tlt_ptr data));\n \n /* Associating user data with loaded modules. */\n typedef unsigned lt_dlcaller_id;\n \n-extern\tlt_dlcaller_id\tlt_dlcaller_register  LT_PARAMS((void));\n-extern\tlt_ptr\t\tlt_dlcaller_set_data  LT_PARAMS((lt_dlcaller_id key,\n+LT_SCOPE\tlt_dlcaller_id\tlt_dlcaller_register  LT_PARAMS((void));\n+LT_SCOPE\tlt_ptr\t\tlt_dlcaller_set_data  LT_PARAMS((lt_dlcaller_id key,\n \t\t\t\t\t\tlt_dlhandle handle,\n \t\t\t\t\t\tlt_ptr data));\n-extern\tlt_ptr\t\tlt_dlcaller_get_data  LT_PARAMS((lt_dlcaller_id key,\n+LT_SCOPE\tlt_ptr\t\tlt_dlcaller_get_data  LT_PARAMS((lt_dlcaller_id key,\n \t\t\t\t\t\tlt_dlhandle handle));\n \n \n@@ -285,15 +290,15 @@ struct lt_user_dlloader {\n   lt_user_data\t\tdlloader_data;\n };\n \n-extern\tlt_dlloader    *lt_dlloader_next    LT_PARAMS((lt_dlloader *place));\n-extern\tlt_dlloader    *lt_dlloader_find    LT_PARAMS((\n+LT_SCOPE\tlt_dlloader    *lt_dlloader_next    LT_PARAMS((lt_dlloader *place));\n+LT_SCOPE\tlt_dlloader    *lt_dlloader_find    LT_PARAMS((\n \t\t\t\t\t\tconst char *loader_name));\n-extern\tconst char     *lt_dlloader_name    LT_PARAMS((lt_dlloader *place));\n-extern\tlt_user_data   *lt_dlloader_data    LT_PARAMS((lt_dlloader *place));\n-extern\tint\t\tlt_dlloader_add     LT_PARAMS((lt_dlloader *place,\n+LT_SCOPE\tconst char     *lt_dlloader_name    LT_PARAMS((lt_dlloader *place));\n+LT_SCOPE\tlt_user_data   *lt_dlloader_data    LT_PARAMS((lt_dlloader *place));\n+LT_SCOPE\tint\t\tlt_dlloader_add     LT_PARAMS((lt_dlloader *place,\n \t\t\t\tconst struct lt_user_dlloader *dlloader,\n \t\t\t\tconst char *loader_name));\n-extern\tint\t\tlt_dlloader_remove  LT_PARAMS((\n+LT_SCOPE\tint\t\tlt_dlloader_remove  LT_PARAMS((\n \t\t\t\t\t\tconst char *loader_name));\n \n \n@@ -336,8 +341,8 @@ enum {\n };\n \n /* These functions are only useful from inside custom module loaders. */\n-extern\tint\tlt_dladderror\tLT_PARAMS((const char *diagnostic));\n-extern\tint\tlt_dlseterror\tLT_PARAMS((int errorcode));\n+LT_SCOPE\tint\tlt_dladderror\tLT_PARAMS((const char *diagnostic));\n+LT_SCOPE\tint\tlt_dlseterror\tLT_PARAMS((int errorcode));\n \n \n "}, {"sha": "9be0eb1c38c2db306bd70075c0b78a49d842ebf4", "filename": "libjava/libltdl/ltmain.sh", "status": "modified", "additions": 716, "deletions": 542, "changes": 1258, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fltmain.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fltmain.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Fltmain.sh?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -1,7 +1,7 @@\n # ltmain.sh - Provide generalized library-building support services.\n # NOTE: Changing this file will not affect anything until you rerun configure.\n #\n-# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003\n+# Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005\n # Free Software Foundation, Inc.\n # Originally by Gordon Matzigkeit <gord@gnu.ai.mit.edu>, 1996\n #\n@@ -17,13 +17,41 @@\n #\n # You should have received a copy of the GNU General Public License\n # along with this program; if not, write to the Free Software\n-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.\n+# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.\n #\n # As a special exception to the GNU General Public License, if you\n # distribute this file as part of a program that contains a\n # configuration script generated by Autoconf, you may include it under\n # the same distribution terms that you use for the rest of that program.\n \n+basename=\"s,^.*/,,g\"\n+\n+# Work around backward compatibility issue on IRIX 6.5. On IRIX 6.4+, sh\n+# is ksh but when the shell is invoked as \"sh\" and the current value of\n+# the _XPG environment variable is not equal to 1 (one), the special\n+# positional parameter $0, within a function call, is the name of the\n+# function.\n+progpath=\"$0\"\n+\n+# The name of this program:\n+progname=`echo \"$progpath\" | $SED $basename`\n+modename=\"$progname\"\n+\n+# Global variables:\n+EXIT_SUCCESS=0\n+EXIT_FAILURE=1\n+\n+PROGRAM=ltmain.sh\n+PACKAGE=libtool\n+VERSION=1.5.16\n+TIMESTAMP=\" (1.1220.2.235 2005/04/25 18:13:26)\"\n+\n+# See if we are running on zsh, and set the options which allow our\n+# commands through without removal of \\ escapes.\n+if test -n \"${ZSH_VERSION+set}\" ; then\n+  setopt NO_GLOB_SUBST\n+fi\n+\n # Check that we have a working $echo.\n if test \"X$1\" = X--no-reexec; then\n   # Discard the --no-reexec flag, and continue.\n@@ -36,7 +64,7 @@ elif test \"X`($echo '\\t') 2>/dev/null`\" = 'X\\t'; then\n   :\n else\n   # Restart under the correct shell, and then maybe $echo will work.\n-  exec $SHELL \"$0\" --no-reexec ${1+\"$@\"}\n+  exec $SHELL \"$progpath\" --no-reexec ${1+\"$@\"}\n fi\n \n if test \"X$1\" = X--fallback-echo; then\n@@ -45,19 +73,9 @@ if test \"X$1\" = X--fallback-echo; then\n   cat <<EOF\n $*\n EOF\n-  exit 0\n+  exit $EXIT_SUCCESS\n fi\n \n-# The name of this program.\n-progname=`$echo \"$0\" | ${SED} 's%^.*/%%'`\n-modename=\"$progname\"\n-\n-# Constants.\n-PROGRAM=ltmain.sh\n-PACKAGE=libtool\n-VERSION=1.5.0a\n-TIMESTAMP=\" (1.1220.2.25 2003/08/01 19:08:35) Debian$Rev: 49 $\"\n-\n default_mode=\n help=\"Try \\`$progname --help' for more information.\"\n magic=\"%%%MAGIC variable%%%\"\n@@ -94,13 +112,14 @@ if test \"${LANG+set}\" = set; then\n fi\n \n # Make sure IFS has a sensible default\n-: ${IFS=\" \t\n-\"}\n+lt_nl='\n+'\n+IFS=\" \t$lt_nl\"\n \n if test \"$build_libtool_libs\" != yes && test \"$build_old_libs\" != yes; then\n   $echo \"$modename: not configured to build any kind of library\" 1>&2\n   $echo \"Fatal configuration error.  See the $PACKAGE docs for more information.\" 1>&2\n-  exit 1\n+  exit $EXIT_FAILURE\n fi\n \n # Global variables.\n@@ -114,15 +133,20 @@ show_help=\n execute_dlfiles=\n lo2o=\"s/\\\\.lo\\$/.${objext}/\"\n o2lo=\"s/\\\\.${objext}\\$/.lo/\"\n+quote_scanset='[[~#^*{};<>?'\"'\"' \t]'\n \n #####################################\n # Shell function definitions:\n # This seems to be the best place for them\n \n+# func_win32_libid arg\n+# return the library type of file 'arg'\n+#\n # Need a lot of goo to handle *both* DLLs and import libs\n # Has to be a shell function in order to 'eat' the argument\n # that is supplied when $file_magic_command is called.\n-win32_libid () {\n+func_win32_libid ()\n+{\n   win32_libid_type=\"unknown\"\n   win32_fileres=`file -L $1 2>/dev/null`\n   case $win32_fileres in\n@@ -131,7 +155,7 @@ win32_libid () {\n     ;;\n   *ar\\ archive*) # could be an import, or static\n     if eval $OBJDUMP -f $1 | $SED -e '10q' 2>/dev/null | \\\n-      grep -E 'file format pe-i386(.*architecture: i386)?' >/dev/null ; then\n+      $EGREP -e 'file format pe-i386(.*architecture: i386)?' >/dev/null ; then\n       win32_nmres=`eval $NM -f posix -A $1 | \\\n \tsed -n -e '1,100{/ I /{x;/import/!{s/^/import/;h;p;};x;};}'`\n       if test \"X$win32_nmres\" = \"Ximport\" ; then\n@@ -141,7 +165,7 @@ win32_libid () {\n       fi\n     fi\n     ;;\n-  *DLL*) \n+  *DLL*)\n     win32_libid_type=\"x86 DLL\"\n     ;;\n   *executable*) # but shell scripts are \"executable\" too...\n@@ -155,9 +179,179 @@ win32_libid () {\n   $echo $win32_libid_type\n }\n \n+\n+# func_infer_tag arg\n+# Infer tagged configuration to use if any are available and\n+# if one wasn't chosen via the \"--tag\" command line option.\n+# Only attempt this if the compiler in the base compile\n+# command doesn't match the default compiler.\n+# arg is usually of the form 'gcc ...'\n+func_infer_tag ()\n+{\n+    if test -n \"$available_tags\" && test -z \"$tagname\"; then\n+      CC_quoted=\n+      for arg in $CC; do\n+\tcase $arg in\n+\t  *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n+\t  arg=\"\\\"$arg\\\"\"\n+\t  ;;\n+\tesac\n+\tCC_quoted=\"$CC_quoted $arg\"\n+      done\n+      case $@ in\n+      # Blanks in the command may have been stripped by the calling shell,\n+      # but not from the CC environment variable when configure was run.\n+      \" $CC \"* | \"$CC \"* | \" `$echo $CC` \"* | \"`$echo $CC` \"* | \" $CC_quoted\"* | \"$CC_quoted \"* | \" `$echo $CC_quoted` \"* | \"`$echo $CC_quoted` \"*) ;;\n+      # Blanks at the start of $base_compile will cause this to fail\n+      # if we don't check for them as well.\n+      *)\n+\tfor z in $available_tags; do\n+\t  if grep \"^# ### BEGIN LIBTOOL TAG CONFIG: $z$\" < \"$progpath\" > /dev/null; then\n+\t    # Evaluate the configuration.\n+\t    eval \"`${SED} -n -e '/^# ### BEGIN LIBTOOL TAG CONFIG: '$z'$/,/^# ### END LIBTOOL TAG CONFIG: '$z'$/p' < $progpath`\"\n+\t    CC_quoted=\n+\t    for arg in $CC; do\n+\t    # Double-quote args containing other shell metacharacters.\n+\t    case $arg in\n+\t      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n+\t      arg=\"\\\"$arg\\\"\"\n+\t      ;;\n+\t    esac\n+\t    CC_quoted=\"$CC_quoted $arg\"\n+\t  done\n+\t    case \"$@ \" in\n+\t      \" $CC \"* | \"$CC \"* | \" `$echo $CC` \"* | \"`$echo $CC` \"* | \" $CC_quoted\"* | \"$CC_quoted \"* | \" `$echo $CC_quoted` \"* | \"`$echo $CC_quoted` \"*)\n+\t      # The compiler in the base compile command matches\n+\t      # the one in the tagged configuration.\n+\t      # Assume this is the tagged configuration we want.\n+\t      tagname=$z\n+\t      break\n+\t      ;;\n+\t    esac\n+\t  fi\n+\tdone\n+\t# If $tagname still isn't set, then no tagged configuration\n+\t# was found and let the user know that the \"--tag\" command\n+\t# line option must be used.\n+\tif test -z \"$tagname\"; then\n+\t  $echo \"$modename: unable to infer tagged configuration\"\n+\t  $echo \"$modename: specify a tag with \\`--tag'\" 1>&2\n+\t  exit $EXIT_FAILURE\n+#        else\n+#          $echo \"$modename: using $tagname tagged configuration\"\n+\tfi\n+\t;;\n+      esac\n+    fi\n+}\n+\n+\n+# func_extract_an_archive dir oldlib\n+func_extract_an_archive ()\n+{\n+    f_ex_an_ar_dir=\"$1\"; shift\n+    f_ex_an_ar_oldlib=\"$1\"\n+\n+    $show \"(cd $f_ex_an_ar_dir && $AR x $f_ex_an_ar_oldlib)\"\n+    $run eval \"(cd \\$f_ex_an_ar_dir && $AR x \\$f_ex_an_ar_oldlib)\" || exit $?\n+    if ($AR t \"$f_ex_an_ar_oldlib\" | sort | sort -uc >/dev/null 2>&1); then\n+     :\n+    else\n+      $echo \"$modename: ERROR: object name conflicts: $f_ex_an_ar_dir/$f_ex_an_ar_oldlib\" 1>&2\n+      exit $EXIT_FAILURE\n+    fi\n+}\n+\n+# func_extract_archives gentop oldlib ...\n+func_extract_archives ()\n+{\n+    my_gentop=\"$1\"; shift\n+    my_oldlibs=${1+\"$@\"}\n+    my_oldobjs=\"\"\n+    my_xlib=\"\"\n+    my_xabs=\"\"\n+    my_xdir=\"\"\n+    my_status=\"\"\n+\n+    $show \"${rm}r $my_gentop\"\n+    $run ${rm}r \"$my_gentop\"\n+    $show \"$mkdir $my_gentop\"\n+    $run $mkdir \"$my_gentop\"\n+    my_status=$?\n+    if test \"$my_status\" -ne 0 && test ! -d \"$my_gentop\"; then\n+      exit $my_status\n+    fi\n+\n+    for my_xlib in $my_oldlibs; do\n+      # Extract the objects.\n+      case $my_xlib in\n+\t[\\\\/]* | [A-Za-z]:[\\\\/]*) my_xabs=\"$my_xlib\" ;;\n+\t*) my_xabs=`pwd`\"/$my_xlib\" ;;\n+      esac\n+      my_xlib=`$echo \"X$my_xlib\" | $Xsed -e 's%^.*/%%'`\n+      my_xdir=\"$my_gentop/$my_xlib\"\n+\n+      $show \"${rm}r $my_xdir\"\n+      $run ${rm}r \"$my_xdir\"\n+      $show \"$mkdir $my_xdir\"\n+      $run $mkdir \"$my_xdir\"\n+      status=$?\n+      if test \"$status\" -ne 0 && test ! -d \"$my_xdir\"; then\n+\texit $status\n+      fi\n+      case $host in\n+      *-darwin*)\n+\t$show \"Extracting $my_xabs\"\n+\t# Do not bother doing anything if just a dry run\n+\tif test -z \"$run\"; then\n+\t  darwin_orig_dir=`pwd`\n+\t  cd $my_xdir || exit $?\n+\t  darwin_archive=$my_xabs\n+\t  darwin_curdir=`pwd`\n+\t  darwin_base_archive=`$echo \"X$darwin_archive\" | $Xsed -e 's%^.*/%%'`\n+\t  darwin_arches=`lipo -info \"$darwin_archive\" 2>/dev/null | $EGREP Architectures 2>/dev/null`\n+\t  if test -n \"$darwin_arches\"; then \n+\t    darwin_arches=`echo \"$darwin_arches\" | $SED -e 's/.*are://'`\n+\t    darwin_arch=\n+\t    $show \"$darwin_base_archive has multiple architectures $darwin_arches\"\n+\t    for darwin_arch in  $darwin_arches ; do\n+\t      mkdir -p \"unfat-$$/${darwin_base_archive}-${darwin_arch}\"\n+\t      lipo -thin $darwin_arch -output \"unfat-$$/${darwin_base_archive}-${darwin_arch}/${darwin_base_archive}\" \"${darwin_archive}\"\n+\t      cd \"unfat-$$/${darwin_base_archive}-${darwin_arch}\"\n+\t      func_extract_an_archive \"`pwd`\" \"${darwin_base_archive}\"\n+\t      cd \"$darwin_curdir\"\n+\t      $rm \"unfat-$$/${darwin_base_archive}-${darwin_arch}/${darwin_base_archive}\"\n+\t    done # $darwin_arches\n+      ## Okay now we have a bunch of thin objects, gotta fatten them up :)\n+\t    darwin_filelist=`find unfat-$$ -type f -name \\*.o -print -o -name \\*.lo -print| xargs basename | sort -u | $NL2SP`\n+\t    darwin_file=\n+\t    darwin_files=\n+\t    for darwin_file in $darwin_filelist; do\n+\t      darwin_files=`find unfat-$$ -name $darwin_file -print | $NL2SP`\n+\t      lipo -create -output \"$darwin_file\" $darwin_files\n+\t    done # $darwin_filelist\n+\t    ${rm}r unfat-$$\n+\t    cd \"$darwin_orig_dir\"\n+\t  else\n+\t    cd \"$darwin_orig_dir\"\n+ \t    func_extract_an_archive \"$my_xdir\" \"$my_xabs\"\n+\t  fi # $darwin_arches\n+\tfi # $run\n+      ;;\n+      *)\n+        func_extract_an_archive \"$my_xdir\" \"$my_xabs\"\n+        ;;\n+      esac\n+      my_oldobjs=\"$my_oldobjs \"`find $my_xdir -name \\*.$objext -print -o -name \\*.lo -print | $NL2SP`\n+    done\n+    func_extract_archives_result=\"$my_oldobjs\"\n+}\n # End of Shell function definitions\n #####################################\n \n+# Darwin sucks\n+eval std_shrext=\\\"$shrext_cmds\\\"\n+\n # Parse our command line options once, thoroughly.\n while test \"$#\" -gt 0\n do\n@@ -177,12 +371,13 @@ do\n       ;;\n     tag)\n       tagname=\"$arg\"\n+      preserve_args=\"${preserve_args}=$arg\"\n \n       # Check whether tagname contains only valid characters\n       case $tagname in\n       *[!-_A-Za-z0-9,/]*)\n \t$echo \"$progname: invalid tag name: $tagname\" 1>&2\n-\texit 1\n+\texit $EXIT_FAILURE\n \t;;\n       esac\n \n@@ -192,10 +387,10 @@ do\n \t# not specially marked.\n \t;;\n       *)\n-\tif grep \"^# ### BEGIN LIBTOOL TAG CONFIG: $tagname$\" < \"$0\" > /dev/null; then\n+\tif grep \"^# ### BEGIN LIBTOOL TAG CONFIG: $tagname$\" < \"$progpath\" > /dev/null; then\n \t  taglist=\"$taglist $tagname\"\n \t  # Evaluate the configuration.\n-\t  eval \"`${SED} -n -e '/^# ### BEGIN LIBTOOL TAG CONFIG: '$tagname'$/,/^# ### END LIBTOOL TAG CONFIG: '$tagname'$/p' < $0`\"\n+\t  eval \"`${SED} -n -e '/^# ### BEGIN LIBTOOL TAG CONFIG: '$tagname'$/,/^# ### END LIBTOOL TAG CONFIG: '$tagname'$/p' < $progpath`\"\n \telse\n \t  $echo \"$progname: ignoring unknown tag $tagname\" 1>&2\n \tfi\n@@ -221,24 +416,25 @@ do\n   --version)\n     $echo \"$PROGRAM (GNU $PACKAGE) $VERSION$TIMESTAMP\"\n     $echo\n-    $echo \"Copyright (C) 2003  Free Software Foundation, Inc.\"\n+    $echo \"Copyright (C) 2005  Free Software Foundation, Inc.\"\n     $echo \"This is free software; see the source for copying conditions.  There is NO\"\n     $echo \"warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\"\n-    exit 0\n+    exit $?\n     ;;\n \n   --config)\n-    ${SED} -e '1,/^# ### BEGIN LIBTOOL CONFIG/d' -e '/^# ### END LIBTOOL CONFIG/,$d' $0\n+    ${SED} -e '1,/^# ### BEGIN LIBTOOL CONFIG/d' -e '/^# ### END LIBTOOL CONFIG/,$d' $progpath\n     # Now print the configurations for the tags.\n     for tagname in $taglist; do\n-      ${SED} -n -e \"/^# ### BEGIN LIBTOOL TAG CONFIG: $tagname$/,/^# ### END LIBTOOL TAG CONFIG: $tagname$/p\" < \"$0\"\n+      ${SED} -n -e \"/^# ### BEGIN LIBTOOL TAG CONFIG: $tagname$/,/^# ### END LIBTOOL TAG CONFIG: $tagname$/p\" < \"$progpath\"\n     done\n-    exit 0\n+    exit $?\n     ;;\n \n   --debug)\n     $echo \"$progname: enabling shell trace mode\"\n     set -x\n+    preserve_args=\"$preserve_args $arg\"\n     ;;\n \n   --dry-run | -n)\n@@ -257,7 +453,7 @@ do\n     else\n       $echo \"disable static libraries\"\n     fi\n-    exit 0\n+    exit $?\n     ;;\n \n   --finish) mode=\"finish\" ;;\n@@ -269,13 +465,15 @@ do\n \n   --quiet | --silent)\n     show=:\n+    preserve_args=\"$preserve_args $arg\"\n     ;;\n \n   --tag) prevopt=\"--tag\" prev=tag ;;\n   --tag=*)\n     set tag \"$optarg\" ${1+\"$@\"}\n     shift\n     prev=tag\n+    preserve_args=\"$preserve_args --tag\"\n     ;;\n \n   -dlopen)\n@@ -286,7 +484,7 @@ do\n   -*)\n     $echo \"$modename: unrecognized option \\`$arg'\" 1>&2\n     $echo \"$help\" 1>&2\n-    exit 1\n+    exit $EXIT_FAILURE\n     ;;\n \n   *)\n@@ -299,7 +497,7 @@ done\n if test -n \"$prevopt\"; then\n   $echo \"$modename: option \\`$prevopt' requires an argument\" 1>&2\n   $echo \"$help\" 1>&2\n-  exit 1\n+  exit $EXIT_FAILURE\n fi\n \n # If this variable is set in any of the actions, the command in it\n@@ -312,7 +510,7 @@ if test -z \"$show_help\"; then\n   # Infer the operation mode.\n   if test -z \"$mode\"; then\n     $echo \"*** Warning: inferring the mode of operation is deprecated.\" 1>&2\n-    $echo \"*** Future versions of Libtool will require -mode=MODE be specified.\" 1>&2\n+    $echo \"*** Future versions of Libtool will require --mode=MODE be specified.\" 1>&2\n     case $nonopt in\n     *cc | cc* | *++ | gcc* | *-gcc* | g++* | xlc*)\n       mode=link\n@@ -355,7 +553,7 @@ if test -z \"$show_help\"; then\n   if test -n \"$execute_dlfiles\" && test \"$mode\" != execute; then\n     $echo \"$modename: unrecognized option \\`-dlopen'\" 1>&2\n     $echo \"$help\" 1>&2\n-    exit 1\n+    exit $EXIT_FAILURE\n   fi\n \n   # Change the help message to a mode-specific one.\n@@ -370,9 +568,11 @@ if test -z \"$show_help\"; then\n     # Get the compilation command and the source file.\n     base_compile=\n     srcfile=\"$nonopt\"  #  always keep a non-empty value in \"srcfile\"\n+    suppress_opt=yes\n     suppress_output=\n     arg_mode=normal\n     libobj=\n+    later=\n \n     for arg\n     do\n@@ -395,24 +595,19 @@ if test -z \"$show_help\"; then\n \t-o)\n \t  if test -n \"$libobj\" ; then\n \t    $echo \"$modename: you cannot specify \\`-o' more than once\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \t  arg_mode=target\n \t  continue\n \t  ;;\n \n-\t-static)\n-\t  build_old_libs=yes\n-\t  continue\n-\t  ;;\n-\n-\t-prefer-pic)\n-\t  pic_mode=yes\n+\t-static | -prefer-pic | -prefer-non-pic)\n+\t  later=\"$later $arg\"\n \t  continue\n \t  ;;\n \n-\t-prefer-non-pic)\n-\t  pic_mode=no\n+\t-no-suppress)\n+\t  suppress_opt=no\n \t  continue\n \t  ;;\n \n@@ -425,14 +620,14 @@ if test -z \"$show_help\"; then\n \t  args=`$echo \"X$arg\" | $Xsed -e \"s/^-Wc,//\"`\n \t  lastarg=\n \t  save_ifs=\"$IFS\"; IFS=','\n-\t  for arg in $args; do\n+ \t  for arg in $args; do\n \t    IFS=\"$save_ifs\"\n \n \t    # Double-quote args containing other shell metacharacters.\n \t    # Many Bourne shells cannot handle close brackets correctly\n \t    # in scan sets, so we specify it separately.\n \t    case $arg in\n-\t      *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+\t      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \t      arg=\"\\\"$arg\\\"\"\n \t      ;;\n \t    esac\n@@ -463,8 +658,11 @@ if test -z \"$show_help\"; then\n       case $lastarg in\n       # Double-quote args containing other shell metacharacters.\n       # Many Bourne shells cannot handle close brackets correctly\n-      # in scan sets, so we specify it separately.\n-      *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+      # in scan sets, and some SunOS ksh mistreat backslash-escaping\n+      # in scan sets (worked around with variable expansion),\n+      # and furthermore cannot handle '|' '&' '(' ')' in scan sets \n+      # at all, so we specify them separately.\n+      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \tlastarg=\"\\\"$lastarg\\\"\"\n \t;;\n       esac\n@@ -475,11 +673,11 @@ if test -z \"$show_help\"; then\n     case $arg_mode in\n     arg)\n       $echo \"$modename: you must specify an argument for -Xcompile\"\n-      exit 1\n+      exit $EXIT_FAILURE\n       ;;\n     target)\n       $echo \"$modename: you must specify a target with \\`-o'\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n       ;;\n     *)\n       # Get the name of the library object.\n@@ -512,51 +710,40 @@ if test -z \"$show_help\"; then\n     *.lo) obj=`$echo \"X$libobj\" | $Xsed -e \"$lo2o\"` ;;\n     *)\n       $echo \"$modename: cannot determine name of library object from \\`$libobj'\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n       ;;\n     esac\n \n-    # Infer tagged configuration to use if any are available and\n-    # if one wasn't chosen via the \"--tag\" command line option.\n-    # Only attempt this if the compiler in the base compile\n-    # command doesn't match the default compiler.\n-    if test -n \"$available_tags\" && test -z \"$tagname\"; then\n-      case $base_compile in\n-      # Blanks in the command may have been stripped by the calling shell,\n-      # but not from the CC environment variable when configure was run.\n-      \" $CC \"* | \"$CC \"* | \" `$echo $CC` \"* | \"`$echo $CC` \"*) ;;\n-      # Blanks at the start of $base_compile will cause this to fail\n-      # if we don't check for them as well.\n-      *)\n-\tfor z in $available_tags; do\n-\t  if grep \"^# ### BEGIN LIBTOOL TAG CONFIG: $z$\" < \"$0\" > /dev/null; then\n-\t    # Evaluate the configuration.\n-\t    eval \"`${SED} -n -e '/^# ### BEGIN LIBTOOL TAG CONFIG: '$z'$/,/^# ### END LIBTOOL TAG CONFIG: '$z'$/p' < $0`\"\n-\t    case \"$base_compile \" in\n-\t    \"$CC \"* | \" $CC \"* | \"`$echo $CC` \"* | \" `$echo $CC` \"*)\n-\t      # The compiler in the base compile command matches\n-\t      # the one in the tagged configuration.\n-\t      # Assume this is the tagged configuration we want.\n-\t      tagname=$z\n-\t      break\n-\t      ;;\n-\t    esac\n-\t  fi\n-\tdone\n-\t# If $tagname still isn't set, then no tagged configuration\n-\t# was found and let the user know that the \"--tag\" command\n-\t# line option must be used.\n-\tif test -z \"$tagname\"; then\n-\t  $echo \"$modename: unable to infer tagged configuration\"\n-\t  $echo \"$modename: specify a tag with \\`--tag'\" 1>&2\n-\t  exit 1\n-#        else\n-#          $echo \"$modename: using $tagname tagged configuration\"\n-\tfi\n+    func_infer_tag $base_compile\n+\n+    for arg in $later; do\n+      case $arg in\n+      -static)\n+\tbuild_old_libs=yes\n+\tcontinue\n+\t;;\n+\n+      -prefer-pic)\n+\tpic_mode=yes\n+\tcontinue\n+\t;;\n+\n+      -prefer-non-pic)\n+\tpic_mode=no\n+\tcontinue\n \t;;\n       esac\n-    fi\n+    done\n \n+    qlibobj=`$echo \"X$libobj\" | $Xsed -e \"$sed_quote_subst\"`\n+    case $qlibobj in\n+      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n+\tqlibobj=\"\\\"$qlibobj\\\"\" ;;\n+    esac\n+    if test \"X$libobj\" != \"X$qlibobj\"; then\n+\t$echo \"$modename: libobj name \\`$libobj' may not contain shell special characters.\"\n+\texit $EXIT_FAILURE\n+    fi\n     objname=`$echo \"X$obj\" | $Xsed -e 's%^.*/%%'`\n     xdir=`$echo \"X$obj\" | $Xsed -e 's%/[^/]*$%%'`\n     if test \"X$xdir\" = \"X$obj\"; then\n@@ -569,7 +756,7 @@ if test -z \"$show_help\"; then\n     if test -z \"$base_compile\"; then\n       $echo \"$modename: you must specify a compilation command\" 1>&2\n       $echo \"$help\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n     fi\n \n     # Delete any leftover library objects.\n@@ -580,7 +767,7 @@ if test -z \"$show_help\"; then\n     fi\n \n     $run $rm $removelist\n-    trap \"$run $rm $removelist; exit 1\" 1 2 15\n+    trap \"$run $rm $removelist; exit $EXIT_FAILURE\" 1 2 15\n \n     # On Cygwin there's no \"real\" PIC flag so we must build both object types\n     case $host_os in\n@@ -599,7 +786,7 @@ if test -z \"$show_help\"; then\n       output_obj=`$echo \"X$srcfile\" | $Xsed -e 's%^.*/%%' -e 's%\\.[^.]*$%%'`.${objext}\n       lockfile=\"$output_obj.lock\"\n       removelist=\"$removelist $output_obj $lockfile\"\n-      trap \"$run $rm $removelist; exit 1\" 1 2 15\n+      trap \"$run $rm $removelist; exit $EXIT_FAILURE\" 1 2 15\n     else\n       output_obj=\n       need_locks=no\n@@ -609,7 +796,7 @@ if test -z \"$show_help\"; then\n     # Lock this critical section if it is needed\n     # We use this script file to make the link, it avoids creating a new file\n     if test \"$need_locks\" = yes; then\n-      until $run ln \"$0\" \"$lockfile\" 2>/dev/null; do\n+      until $run ln \"$progpath\" \"$lockfile\" 2>/dev/null; do\n \t$show \"Waiting for $lockfile to be removed\"\n \tsleep 2\n       done\n@@ -627,14 +814,19 @@ avoid parallel builds (make -j) in this platform, or get a better\n compiler.\"\n \n \t$run $rm $removelist\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n-      $echo $srcfile > \"$lockfile\"\n+      $echo \"$srcfile\" > \"$lockfile\"\n     fi\n \n     if test -n \"$fix_srcfile_path\"; then\n       eval srcfile=\\\"$fix_srcfile_path\\\"\n     fi\n+    qsrcfile=`$echo \"X$srcfile\" | $Xsed -e \"$sed_quote_subst\"`\n+    case $qsrcfile in\n+      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n+      qsrcfile=\"\\\"$qsrcfile\\\"\" ;;\n+    esac\n \n     $run $rm \"$libobj\" \"${libobj}T\"\n \n@@ -656,10 +848,10 @@ EOF\n       fbsd_hideous_sh_bug=$base_compile\n \n       if test \"$pic_mode\" != no; then\n-\tcommand=\"$base_compile $srcfile $pic_flag\"\n+\tcommand=\"$base_compile $qsrcfile $pic_flag\"\n       else\n \t# Don't build PIC code\n-\tcommand=\"$base_compile $srcfile\"\n+\tcommand=\"$base_compile $qsrcfile\"\n       fi\n \n       if test ! -d \"${xdir}$objdir\"; then\n@@ -682,7 +874,7 @@ EOF\n       if $run eval \"$command\"; then :\n       else\n \ttest -n \"$output_obj\" && $run $rm $removelist\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n \n       if test \"$need_locks\" = warn &&\n@@ -702,7 +894,7 @@ avoid parallel builds (make -j) in this platform, or get a better\n compiler.\"\n \n \t$run $rm $removelist\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n \n       # Just move the object if needed, then go on to compile the next one\n@@ -723,7 +915,9 @@ pic_object='$objdir/$objname'\n EOF\n \n       # Allow error messages only from the first compilation.\n-      suppress_output=' >/dev/null 2>&1'\n+      if test \"$suppress_opt\" = yes; then\n+        suppress_output=' >/dev/null 2>&1'\n+      fi\n     else\n       # No PIC object so indicate it doesn't exist in the libtool\n       # object file.\n@@ -737,9 +931,9 @@ EOF\n     if test \"$build_old_libs\" = yes; then\n       if test \"$pic_mode\" != yes; then\n \t# Don't build PIC code\n-\tcommand=\"$base_compile $srcfile\"\n+\tcommand=\"$base_compile $qsrcfile\"\n       else\n-\tcommand=\"$base_compile $srcfile $pic_flag\"\n+\tcommand=\"$base_compile $qsrcfile $pic_flag\"\n       fi\n       if test \"$compiler_c_o\" = yes; then\n \tcommand=\"$command -o $obj\"\n@@ -752,7 +946,7 @@ EOF\n       if $run eval \"$command\"; then :\n       else\n \t$run $rm $removelist\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n \n       if test \"$need_locks\" = warn &&\n@@ -772,7 +966,7 @@ avoid parallel builds (make -j) in this platform, or get a better\n compiler.\"\n \n \t$run $rm $removelist\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n \n       # Just move the object if needed\n@@ -810,7 +1004,7 @@ EOF\n       $run $rm \"$lockfile\"\n     fi\n \n-    exit 0\n+    exit $EXIT_SUCCESS\n     ;;\n \n   # libtool link mode\n@@ -836,7 +1030,7 @@ EOF\n       ;;\n     esac\n     libtool_args=\"$nonopt\"\n-    base_compile=\"$nonopt\"\n+    base_compile=\"$nonopt $@\"\n     compile_command=\"$nonopt\"\n     finalize_command=\"$nonopt\"\n \n@@ -868,6 +1062,7 @@ EOF\n     no_install=no\n     objs=\n     non_pic_objects=\n+    precious_files_regex=\n     prefer_static_libs=no\n     preload=no\n     prev=\n@@ -881,6 +1076,8 @@ EOF\n     vinfo=\n     vinfo_number=no\n \n+    func_infer_tag $base_compile\n+\n     # We need to know -static, to get the right output filenames.\n     for arg\n     do\n@@ -912,10 +1109,9 @@ EOF\n     # Go through the arguments, transforming them on the way.\n     while test \"$#\" -gt 0; do\n       arg=\"$1\"\n-      base_compile=\"$base_compile $arg\"\n       shift\n       case $arg in\n-      *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \tqarg=\\\"`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\\\" ### testsuite: skip nested quoting test\n \t;;\n       *) qarg=$arg ;;\n@@ -976,7 +1172,7 @@ EOF\n \t  export_symbols=\"$arg\"\n \t  if test ! -f \"$arg\"; then\n \t    $echo \"$modename: symbol file \\`$arg' does not exist\"\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \t  prev=\n \t  continue\n@@ -991,6 +1187,11 @@ EOF\n \t  prev=\n \t  continue\n \t  ;;\n+\tprecious_regex)\n+\t  precious_files_regex=\"$arg\"\n+\t  prev=\n+\t  continue\n+\t  ;;\n \trelease)\n \t  release=\"-$arg\"\n \t  prev=\n@@ -1023,7 +1224,7 @@ EOF\n \t\t   test \"$pic_object\" = none && \\\n \t\t   test \"$non_pic_object\" = none; then\n \t\t  $echo \"$modename: cannot find name of object for \\`$arg'\" 1>&2\n-\t\t  exit 1\n+\t\t  exit $EXIT_FAILURE\n \t\tfi\n \n \t\t# Extract subdirectory from the argument.\n@@ -1076,7 +1277,7 @@ EOF\n \t\t# Only an error if not doing a dry-run.\n \t\tif test -z \"$run\"; then\n \t\t  $echo \"$modename: \\`$arg' is not a valid libtool object\" 1>&2\n-\t\t  exit 1\n+\t\t  exit $EXIT_FAILURE\n \t\telse\n \t\t  # Dry-run case.\n \n@@ -1097,7 +1298,7 @@ EOF\n \t    done\n \t  else\n \t    $echo \"$modename: link input file \\`$save_arg' does not exist\"\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \t  arg=$save_arg\n \t  prev=\n@@ -1109,7 +1310,7 @@ EOF\n \t  [\\\\/]* | [A-Za-z]:[\\\\/]*) ;;\n \t  *)\n \t    $echo \"$modename: only absolute run-paths are allowed\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t    ;;\n \t  esac\n \t  if test \"$prev\" = rpath; then\n@@ -1149,6 +1350,16 @@ EOF\n \t  finalize_command=\"$finalize_command $qarg\"\n \t  continue\n \t  ;;\n+\tshrext)\n+  \t  shrext_cmds=\"$arg\"\n+\t  prev=\n+\t  continue\n+\t  ;;\n+        darwin_framework)\n+\t  compiler_flags=\"$compiler_flags $arg\"\n+\t  prev=\n+\t  continue\n+\t  ;;\n \t*)\n \t  eval \"$prev=\\\"\\$arg\\\"\"\n \t  prev=\n@@ -1197,7 +1408,7 @@ EOF\n       -export-symbols | -export-symbols-regex)\n \tif test -n \"$export_symbols\" || test -n \"$export_symbols_regex\"; then\n \t  $echo \"$modename: more than one -exported-symbols argument is not allowed\"\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \tif test \"X$arg\" = \"X-export-symbols\"; then\n \t  prev=expsyms\n@@ -1207,6 +1418,12 @@ EOF\n \tcontinue\n \t;;\n \n+      -framework)\n+        prev=darwin_framework\n+        compiler_flags=\"$compiler_flags $arg\"\n+        continue\n+        ;;\n+\n       -inst-prefix-dir)\n \tprev=inst_prefix\n \tcontinue\n@@ -1233,7 +1450,7 @@ EOF\n \t  absdir=`cd \"$dir\" && pwd`\n \t  if test -z \"$absdir\"; then\n \t    $echo \"$modename: cannot determine absolute directory name of \\`$dir'\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \t  dir=\"$absdir\"\n \t  ;;\n@@ -1267,7 +1484,7 @@ EOF\n \t    # These systems don't actually have a C library (as such)\n \t    test \"X$arg\" = \"X-lc\" && continue\n \t    ;;\n-\t  *-*-openbsd* | *-*-freebsd*)\n+\t  *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)\n \t    # Do not include libc due to us having libc/libc_r.\n \t    test \"X$arg\" = \"X-lc\" && continue\n \t    ;;\n@@ -1278,7 +1495,7 @@ EOF\n \t  esac\n \telif test \"X$arg\" = \"X-lc_r\"; then\n \t case $host in\n-\t *-*-openbsd* | *-*-freebsd*)\n+\t *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)\n \t   # Do not include libc_r directly, use -pthread flag.\n \t   continue\n \t   ;;\n@@ -1288,23 +1505,41 @@ EOF\n \tcontinue\n \t;;\n \n+      # Tru64 UNIX uses -model [arg] to determine the layout of C++\n+      # classes, name mangling, and exception handling.\n+      -model)\n+\tcompile_command=\"$compile_command $arg\"\n+\tcompiler_flags=\"$compiler_flags $arg\"\n+\tfinalize_command=\"$finalize_command $arg\"\n+\tprev=xcompiler\n+\tcontinue\n+\t;;\n+\n+     -mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)\n+\tcompiler_flags=\"$compiler_flags $arg\"\n+\tcompile_command=\"$compile_command $arg\"\n+\tfinalize_command=\"$finalize_command $arg\"\n+\tcontinue\n+\t;;\n+\n       -module)\n \tmodule=yes\n \tcontinue\n \t;;\n \n-      # gcc -m* arguments should be passed to the linker via $compiler_flags\n-      # in order to pass architecture information to the linker\n-      # (e.g. 32 vs 64-bit).  This may also be accomplished via -Wl,-mfoo\n-      # but this is not reliable with gcc because gcc may use -mfoo to\n-      # select a different linker, different libraries, etc, while\n-      # -Wl,-mfoo simply passes -mfoo to the linker.\n-      -m*)\n+      # -64, -mips[0-9] enable 64-bit mode on the SGI compiler\n+      # -r[0-9][0-9]* specifies the processor on the SGI compiler\n+      # -xarch=*, -xtarget=* enable 64-bit mode on the Sun compiler\n+      # +DA*, +DD* enable 64-bit mode on the HP compiler\n+      # -q* pass through compiler args for the IBM compiler\n+      # -m* pass through architecture-specific compiler args for GCC\n+      -64|-mips[0-9]|-r[0-9][0-9]*|-xarch=*|-xtarget=*|+DA*|+DD*|-q*|-m*)\n+\n \t# Unknown arguments in both finalize_command and compile_command need\n \t# to be aesthetically quoted because they are evaled later.\n \targ=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n \tcase $arg in\n-\t*[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+\t*$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \t  arg=\"\\\"$arg\\\"\"\n \t  ;;\n \tesac\n@@ -1352,6 +1587,11 @@ EOF\n \n       -o) prev=output ;;\n \n+      -precious-files-regex)\n+\tprev=precious_regex\n+\tcontinue\n+\t;;\n+\n       -release)\n \tprev=release\n \tcontinue\n@@ -1374,7 +1614,7 @@ EOF\n \t[\\\\/]* | [A-Za-z]:[\\\\/]*) ;;\n \t*)\n \t  $echo \"$modename: only absolute run-paths are allowed\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n \tcase \"$xrpath \" in\n@@ -1415,7 +1655,7 @@ EOF\n \tfor flag in $args; do\n \t  IFS=\"$save_ifs\"\n \t  case $flag in\n-\t    *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+\t    *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \t    flag=\"\\\"$flag\\\"\"\n \t    ;;\n \t  esac\n@@ -1433,7 +1673,7 @@ EOF\n \tfor flag in $args; do\n \t  IFS=\"$save_ifs\"\n \t  case $flag in\n-\t    *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+\t    *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \t    flag=\"\\\"$flag\\\"\"\n \t    ;;\n \t  esac\n@@ -1466,7 +1706,7 @@ EOF\n \t# to be aesthetically quoted because they are evaled later.\n \targ=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n \tcase $arg in\n-\t*[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+\t*$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \t  arg=\"\\\"$arg\\\"\"\n \t  ;;\n \tesac\n@@ -1497,7 +1737,7 @@ EOF\n \t     test \"$pic_object\" = none && \\\n \t     test \"$non_pic_object\" = none; then\n \t    $echo \"$modename: cannot find name of object for \\`$arg'\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \n \t  # Extract subdirectory from the argument.\n@@ -1550,7 +1790,7 @@ EOF\n \t  # Only an error if not doing a dry-run.\n \t  if test -z \"$run\"; then\n \t    $echo \"$modename: \\`$arg' is not a valid libtool object\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  else\n \t    # Dry-run case.\n \n@@ -1600,7 +1840,7 @@ EOF\n \t# to be aesthetically quoted because they are evaled later.\n \targ=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n \tcase $arg in\n-\t*[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*|\"\")\n+\t*$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \t  arg=\"\\\"$arg\\\"\"\n \t  ;;\n \tesac\n@@ -1617,48 +1857,7 @@ EOF\n     if test -n \"$prev\"; then\n       $echo \"$modename: the \\`$prevarg' option requires an argument\" 1>&2\n       $echo \"$help\" 1>&2\n-      exit 1\n-    fi\n-\n-    # Infer tagged configuration to use if any are available and\n-    # if one wasn't chosen via the \"--tag\" command line option.\n-    # Only attempt this if the compiler in the base link\n-    # command doesn't match the default compiler.\n-    if test -n \"$available_tags\" && test -z \"$tagname\"; then\n-      case $base_compile in\n-      # Blanks in the command may have been stripped by the calling shell,\n-      # but not from the CC environment variable when configure was run.\n-      \"$CC \"* | \" $CC \"* | \"`$echo $CC` \"* | \" `$echo $CC` \"*) ;;\n-      # Blanks at the start of $base_compile will cause this to fail\n-      # if we don't check for them as well.\n-      *)\n-\tfor z in $available_tags; do\n-\t  if grep \"^# ### BEGIN LIBTOOL TAG CONFIG: $z$\" < \"$0\" > /dev/null; then\n-\t    # Evaluate the configuration.\n-\t    eval \"`${SED} -n -e '/^# ### BEGIN LIBTOOL TAG CONFIG: '$z'$/,/^# ### END LIBTOOL TAG CONFIG: '$z'$/p' < $0`\"\n-\t    case $base_compile in\n-\t    \"$CC \"* | \" $CC \"* | \"`$echo $CC` \"* | \" `$echo $CC` \"*)\n-\t      # The compiler in $compile_command matches\n-\t      # the one in the tagged configuration.\n-\t      # Assume this is the tagged configuration we want.\n-\t      tagname=$z\n-\t      break\n-\t      ;;\n-\t    esac\n-\t  fi\n-\tdone\n-\t# If $tagname still isn't set, then no tagged configuration\n-\t# was found and let the user know that the \"--tag\" command\n-\t# line option must be used.\n-\tif test -z \"$tagname\"; then\n-\t  $echo \"$modename: unable to infer tagged configuration\"\n-\t  $echo \"$modename: specify a tag with \\`--tag'\" 1>&2\n-\t  exit 1\n-#       else\n-#         $echo \"$modename: using $tagname tagged configuration\"\n-\tfi\n-\t;;\n-      esac\n+      exit $EXIT_FAILURE\n     fi\n \n     if test \"$export_dynamic\" = yes && test -n \"$export_dynamic_flag_spec\"; then\n@@ -1702,7 +1901,7 @@ EOF\n     \"\")\n       $echo \"$modename: you must specify an output file\" 1>&2\n       $echo \"$help\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n       ;;\n     *.$libext) linkmode=oldlib ;;\n     *.lo | *.$objext) linkmode=obj ;;\n@@ -1712,7 +1911,7 @@ EOF\n \n     case $host in\n     *cygwin* | *mingw* | *pw32*)\n-      # don't eliminate duplcations in $postdeps and $predeps\n+      # don't eliminate duplications in $postdeps and $predeps\n       duplicate_compiler_generated_deps=yes\n       ;;\n     *)\n@@ -1765,7 +1964,7 @@ EOF\n \t  *.la) ;;\n \t  *)\n \t    $echo \"$modename: libraries can \\`-dlopen' only libtool libraries: $file\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t    ;;\n \t  esac\n \tdone\n@@ -1803,18 +2002,23 @@ EOF\n \tlib=\n \tfound=no\n \tcase $deplib in\n+\t-mt|-mthreads|-kthread|-Kthread|-pthread|-pthreads|--thread-safe)\n+\t  if test \"$linkmode,$pass\" = \"prog,link\"; then\n+\t    compile_deplibs=\"$deplib $compile_deplibs\"\n+\t    finalize_deplibs=\"$deplib $finalize_deplibs\"\n+\t  else\n+\t    compiler_flags=\"$compiler_flags $deplib\"\n+\t  fi\n+\t  continue\n+\t  ;;\n \t-l*)\n \t  if test \"$linkmode\" != lib && test \"$linkmode\" != prog; then\n \t    $echo \"$modename: warning: \\`-l' is ignored for archives/objects\" 1>&2\n \t    continue\n \t  fi\n-\t  if test \"$pass\" = conv; then\n-\t    deplibs=\"$deplib $deplibs\"\n-\t    continue\n-\t  fi\n \t  name=`$echo \"X$deplib\" | $Xsed -e 's/^-l//'`\n \t  for searchdir in $newlib_search_path $lib_search_path $sys_lib_search_path $shlib_search_path; do\n-\t    for search_ext in .la $shrext .so .a; do\n+\t    for search_ext in .la $std_shrext .so .a; do\n \t      # Search the libtool library\n \t      lib=\"$searchdir/lib${name}${search_ext}\"\n \t      if test -f \"$lib\"; then\n@@ -1890,11 +2094,11 @@ EOF\n \t    fi\n \t    if test \"$pass\" = scan; then\n \t      deplibs=\"$deplib $deplibs\"\n-\t      newlib_search_path=\"$newlib_search_path \"`$echo \"X$deplib\" | $Xsed -e 's/^-L//'`\n \t    else\n \t      compile_deplibs=\"$deplib $compile_deplibs\"\n \t      finalize_deplibs=\"$deplib $finalize_deplibs\"\n \t    fi\n+\t    newlib_search_path=\"$newlib_search_path \"`$echo \"X$deplib\" | $Xsed -e 's/^-L//'`\n \t    ;;\n \t  *)\n \t    $echo \"$modename: warning: \\`-L' is ignored for archives/objects\" 1>&2\n@@ -1922,7 +2126,22 @@ EOF\n \t  fi\n \t  case $linkmode in\n \t  lib)\n-\t    if test \"$deplibs_check_method\" != pass_all; then\n+\t    valid_a_lib=no\n+\t    case $deplibs_check_method in\n+\t      match_pattern*)\n+\t\tset dummy $deplibs_check_method\n+\t        match_pattern_regex=`expr \"$deplibs_check_method\" : \"$2 \\(.*\\)\"`\n+\t\tif eval $echo \\\"$deplib\\\" 2>/dev/null \\\n+\t\t    | $SED 10q \\\n+\t\t    | $EGREP \"$match_pattern_regex\" > /dev/null; then\n+\t\t  valid_a_lib=yes\n+\t\tfi\n+\t\t;;\n+\t      pass_all)\n+\t\tvalid_a_lib=yes\n+\t\t;;\n+            esac\n+\t    if test \"$valid_a_lib\" != yes; then\n \t      $echo\n \t      $echo \"*** Warning: Trying to link with static lib archive $deplib.\"\n \t      $echo \"*** I have the capability to make that library automatically link in when\"\n@@ -1973,14 +2192,14 @@ EOF\n \tif test \"$found\" = yes || test -f \"$lib\"; then :\n \telse\n \t  $echo \"$modename: cannot find the library \\`$lib'\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \n \t# Check to see that this really is a libtool archive.\n \tif (${SED} -e '2q' $lib | grep \"^# Generated by .*$PACKAGE\") >/dev/null 2>&1; then :\n \telse\n \t  $echo \"$modename: \\`$lib' is not a valid libtool archive\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \n \tladir=`$echo \"X$lib\" | $Xsed -e 's%/[^/]*$%%'`\n@@ -1996,6 +2215,8 @@ EOF\n \t# it will not redefine variables installed, or shouldnotlink\n \tinstalled=yes\n \tshouldnotlink=no\n+\tavoidtemprpath=\n+\n \n \t# Read the .la file\n \tcase $lib in\n@@ -2016,7 +2237,7 @@ EOF\n \t  if test -z \"$libdir\"; then\n \t    if test -z \"$old_library\"; then\n \t      $echo \"$modename: cannot find name of link library for \\`$lib'\" 1>&2\n-\t      exit 1\n+\t      exit $EXIT_FAILURE\n \t    fi\n \t    # It is a libtool convenience library, so add in its objects.\n \t    convenience=\"$convenience $ladir/$objdir/$old_library\"\n@@ -2033,29 +2254,31 @@ EOF\n \t    done\n \t  elif test \"$linkmode\" != prog && test \"$linkmode\" != lib; then\n \t    $echo \"$modename: \\`$lib' is not a convenience library\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \t  continue\n \tfi # $pass = conv\n \n-    \n+\n \t# Get the name of the library we link against.\n \tlinklib=\n \tfor l in $old_library $library_names; do\n \t  linklib=\"$l\"\n \tdone\n \tif test -z \"$linklib\"; then\n \t  $echo \"$modename: cannot find name of link library for \\`$lib'\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \n \t# This library was specified with -dlopen.\n \tif test \"$pass\" = dlopen; then\n \t  if test -z \"$libdir\"; then\n \t    $echo \"$modename: cannot -dlopen a convenience library: \\`$lib'\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n-\t  if test -z \"$dlname\" || test \"$dlopen_support\" != yes || test \"$build_libtool_libs\" = no; then\n+\t  if test -z \"$dlname\" ||\n+\t     test \"$dlopen_support\" != yes ||\n+\t     test \"$build_libtool_libs\" = no; then\n \t    # If there is no dlname, no dlopen support or we're linking\n \t    # statically, we need to preload.  We also need to preload any\n \t    # dependent libraries so libltdl's deplib preloader doesn't\n@@ -2092,19 +2315,27 @@ EOF\n \t    dir=\"$libdir\"\n \t    absdir=\"$libdir\"\n \t  fi\n+\t  test \"X$hardcode_automatic\" = Xyes && avoidtemprpath=yes\n \telse\n-\t  dir=\"$ladir/$objdir\"\n-\t  absdir=\"$abs_ladir/$objdir\"\n-\t  # Remove this search path later\n-\t  notinst_path=\"$notinst_path $abs_ladir\"\n+\t  if test ! -f \"$ladir/$objdir/$linklib\" && test -f \"$abs_ladir/$linklib\"; then\n+\t    dir=\"$ladir\"\n+\t    absdir=\"$abs_ladir\"\n+\t    # Remove this search path later\n+\t    notinst_path=\"$notinst_path $abs_ladir\"\n+\t  else\n+\t    dir=\"$ladir/$objdir\"\n+\t    absdir=\"$abs_ladir/$objdir\"\n+\t    # Remove this search path later\n+\t    notinst_path=\"$notinst_path $abs_ladir\"\n+\t  fi\n \tfi # $installed = yes\n \tname=`$echo \"X$laname\" | $Xsed -e 's/\\.la$//' -e 's/^lib//'`\n \n \t# This library was specified with -dlpreopen.\n \tif test \"$pass\" = dlpreopen; then\n \t  if test -z \"$libdir\"; then\n \t    $echo \"$modename: cannot -dlpreopen a convenience library: \\`$lib'\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \t  # Prefer using a static library (so that no silly _DYNAMIC symbols\n \t  # are required to link).\n@@ -2131,7 +2362,7 @@ EOF\n \t  continue\n \tfi\n \n-    \n+\n \tif test \"$linkmode\" = prog && test \"$pass\" != link; then\n \t  newlib_search_path=\"$newlib_search_path $ladir\"\n \t  deplibs=\"$lib $deplibs\"\n@@ -2169,7 +2400,7 @@ EOF\n \t  if test -n \"$library_names\" &&\n \t     { test \"$prefer_static_libs\" = no || test -z \"$old_library\"; }; then\n \t    # We need to hardcode the library path\n-\t    if test -n \"$shlibpath_var\"; then\n+\t    if test -n \"$shlibpath_var\" && test -z \"$avoidtemprpath\" ; then\n \t      # Make sure the rpath contains only unique directories.\n \t      case \"$temp_rpath \" in\n \t      *\" $dir \"*) ;;\n@@ -2218,17 +2449,18 @@ EOF\n \t    need_relink=yes\n \t  fi\n \t  # This is a shared library\n-\t\n-      # Warn about portability, can't link against -module's on some systems (darwin)\n-      if test \"$shouldnotlink\" = yes && test \"$pass\" = link ; then\n+\n+\t  # Warn about portability, can't link against -module's on\n+\t  # some systems (darwin)\n+\t  if test \"$shouldnotlink\" = yes && test \"$pass\" = link ; then\n \t    $echo\n \t    if test \"$linkmode\" = prog; then\n \t      $echo \"*** Warning: Linking the executable $output against the loadable module\"\n \t    else\n \t      $echo \"*** Warning: Linking the shared library $output against the loadable module\"\n \t    fi\n-\t    $echo \"*** $linklib is not portable!\"    \n-      fi\t  \n+\t    $echo \"*** $linklib is not portable!\"\n+\t  fi\n \t  if test \"$linkmode\" = lib &&\n \t     test \"$hardcode_into_libs\" = yes; then\n \t    # Hardcode the library path.\n@@ -2286,9 +2518,10 @@ EOF\n \t    else\n \t      $show \"extracting exported symbol list from \\`$soname'\"\n \t      save_ifs=\"$IFS\"; IFS='~'\n-\t      eval cmds=\\\"$extract_expsyms_cmds\\\"\n+\t      cmds=$extract_expsyms_cmds\n \t      for cmd in $cmds; do\n \t\tIFS=\"$save_ifs\"\n+\t\teval cmd=\\\"$cmd\\\"\n \t\t$show \"$cmd\"\n \t\t$run eval \"$cmd\" || exit $?\n \t      done\n@@ -2299,9 +2532,10 @@ EOF\n \t    if test -f \"$output_objdir/$newlib\"; then :; else\n \t      $show \"generating import library for \\`$soname'\"\n \t      save_ifs=\"$IFS\"; IFS='~'\n-\t      eval cmds=\\\"$old_archive_from_expsyms_cmds\\\"\n+\t      cmds=$old_archive_from_expsyms_cmds\n \t      for cmd in $cmds; do\n \t\tIFS=\"$save_ifs\"\n+\t\teval cmd=\\\"$cmd\\\"\n \t\t$show \"$cmd\"\n \t\t$run eval \"$cmd\" || exit $?\n \t      done\n@@ -2324,17 +2558,17 @@ EOF\n \t\tcase $host in\n \t\t  *-*-sco3.2v5* ) add_dir=\"-L$dir\" ;;\n \t\t  *-*-darwin* )\n-\t\t    # if the lib is a module then we can not link against it, someone\n-\t\t    # is ignoring the new warnings I added\n-\t\t    if /usr/bin/file -L $add 2> /dev/null | grep \"bundle\" >/dev/null ; then\n+\t\t    # if the lib is a module then we can not link against\n+\t\t    # it, someone is ignoring the new warnings I added\n+\t\t    if /usr/bin/file -L $add 2> /dev/null | $EGREP \"bundle\" >/dev/null ; then\n \t\t      $echo \"** Warning, lib $linklib is a module, not a shared library\"\n \t\t      if test -z \"$old_library\" ; then\n \t\t        $echo\n \t\t        $echo \"** And there doesn't seem to be a static archive available\"\n \t\t        $echo \"** The link will probably fail, sorry\"\n \t\t      else\n \t\t        add=\"$dir/$old_library\"\n-\t\t      fi \n+\t\t      fi\n \t\t    fi\n \t\tesac\n \t      elif test \"$hardcode_minus_L\" = no; then\n@@ -2376,7 +2610,7 @@ EOF\n \n \t    if test \"$lib_linked\" != yes; then\n \t      $echo \"$modename: configuration error: unsupported hardcode properties\"\n-\t      exit 1\n+\t      exit $EXIT_FAILURE\n \t    fi\n \n \t    if test -n \"$add_shlibpath\"; then\n@@ -2419,7 +2653,8 @@ EOF\n \t      esac\n \t      add=\"-l$name\"\n \t    elif test \"$hardcode_automatic\" = yes; then\n-\t      if test -n \"$inst_prefix_dir\" && test -f \"$inst_prefix_dir$libdir/$linklib\" ; then\n+\t      if test -n \"$inst_prefix_dir\" &&\n+\t\t test -f \"$inst_prefix_dir$libdir/$linklib\" ; then\n \t        add=\"$inst_prefix_dir$libdir/$linklib\"\n \t      else\n \t        add=\"$libdir/$linklib\"\n@@ -2499,7 +2734,8 @@ EOF\n \n \tif test \"$linkmode\" = lib; then\n \t  if test -n \"$dependency_libs\" &&\n-\t     { test \"$hardcode_into_libs\" != yes || test \"$build_old_libs\" = yes ||\n+\t     { test \"$hardcode_into_libs\" != yes ||\n+\t       test \"$build_old_libs\" = yes ||\n \t       test \"$link_static\" = yes; }; then\n \t    # Extract -R from dependency_libs\n \t    temp_deplibs=\n@@ -2556,7 +2792,7 @@ EOF\n \t\t  eval libdir=`${SED} -n -e 's/^libdir=\\(.*\\)$/\\1/p' $deplib`\n \t\t  if test -z \"$libdir\"; then\n \t\t    $echo \"$modename: \\`$deplib' is not a valid libtool archive\" 1>&2\n-\t\t    exit 1\n+\t\t    exit $EXIT_FAILURE\n \t\t  fi\n \t\t  if test \"$absdir\" != \"$libdir\"; then\n \t\t    $echo \"$modename: warning: \\`$deplib' seems to be moved\" 1>&2\n@@ -2566,54 +2802,54 @@ EOF\n \t\tdepdepl=\n \t\tcase $host in\n \t\t*-*-darwin*)\n-\t\t  # we do not want to link against static libs, but need to link against shared\n+\t\t  # we do not want to link against static libs,\n+\t\t  # but need to link against shared\n \t\t  eval deplibrary_names=`${SED} -n -e 's/^library_names=\\(.*\\)$/\\1/p' $deplib`\n \t\t  if test -n \"$deplibrary_names\" ; then\n \t\t    for tmp in $deplibrary_names ; do\n \t\t      depdepl=$tmp\n \t\t    done\n \t\t    if test -f \"$path/$depdepl\" ; then\n \t\t      depdepl=\"$path/$depdepl\"\n-\t\t   fi\n+\t\t    fi\n \t\t    # do not add paths which are already there\n \t\t    case \" $newlib_search_path \" in\n \t\t    *\" $path \"*) ;;\n \t\t    *) newlib_search_path=\"$newlib_search_path $path\";;\n \t\t    esac\n-\t\t    path=\"\"\n \t\t  fi\n+\t\t  path=\"\"\n \t\t  ;;\n \t\t*)\n-\t\tpath=\"-L$path\"\n-\t\t;;\n-\t\tesac \n-\t\t\n+\t\t  path=\"-L$path\"\n+\t\t  ;;\n+\t\tesac\n \t\t;;\n-\t\t  -l*)\n+\t      -l*)\n \t\tcase $host in\n \t\t*-*-darwin*)\n-\t\t # Again, we only want to link against shared libraries\n-\t\t eval tmp_libs=`$echo \"X$deplib\" | $Xsed -e \"s,^\\-l,,\"`\n-\t\t for tmp in $newlib_search_path ; do\n-\t\t     if test -f \"$tmp/lib$tmp_libs.dylib\" ; then\n-\t\t       eval depdepl=\"$tmp/lib$tmp_libs.dylib\"\n-\t\t       break\n-\t\t     fi  \n-         done\n-         path=\"\"\n+\t\t  # Again, we only want to link against shared libraries\n+\t\t  eval tmp_libs=`$echo \"X$deplib\" | $Xsed -e \"s,^\\-l,,\"`\n+\t\t  for tmp in $newlib_search_path ; do\n+\t\t    if test -f \"$tmp/lib$tmp_libs.dylib\" ; then\n+\t\t      eval depdepl=\"$tmp/lib$tmp_libs.dylib\"\n+\t\t      break\n+\t\t    fi\n+\t\t  done\n+\t\t  path=\"\"\n \t\t  ;;\n \t\t*) continue ;;\n-\t\tesac  \t\t  \n+\t\tesac\n \t\t;;\n \t      *) continue ;;\n \t      esac\n \t      case \" $deplibs \" in\n-\t      *\" $depdepl \"*) ;;\n-\t      *) deplibs=\"$deplibs $depdepl\" ;;\n-\t      esac\t      \n-\t      case \" $deplibs \" in\n \t      *\" $path \"*) ;;\n-\t      *) deplibs=\"$deplibs $path\" ;;\n+\t      *) deplibs=\"$path $deplibs\" ;;\n+\t      esac\n+\t      case \" $deplibs \" in\n+\t      *\" $depdepl \"*) ;;\n+\t      *) deplibs=\"$depdepl $deplibs\" ;;\n \t      esac\n \t    done\n \t  fi # link_all_deplibs != no\n@@ -2700,7 +2936,8 @@ EOF\n \t  eval $var=\\\"$tmp_libs\\\"\n \tdone # for var\n       fi\n-      # Last step: remove runtime libs from dependency_libs (they stay in deplibs)\n+      # Last step: remove runtime libs from dependency_libs\n+      # (they stay in deplibs)\n       tmp_libs=\n       for i in $dependency_libs ; do\n \tcase \" $predeps $postdeps $compiler_lib_search_path \" in\n@@ -2760,19 +2997,19 @@ EOF\n       case $outputname in\n       lib*)\n \tname=`$echo \"X$outputname\" | $Xsed -e 's/\\.la$//' -e 's/^lib//'`\n-\teval shared_ext=\\\"$shrext\\\"\n+\teval shared_ext=\\\"$shrext_cmds\\\"\n \teval libname=\\\"$libname_spec\\\"\n \t;;\n       *)\n \tif test \"$module\" = no; then\n \t  $echo \"$modename: libtool library \\`$output' must begin with \\`lib'\" 1>&2\n \t  $echo \"$help\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \tif test \"$need_lib_prefix\" != no; then\n \t  # Add the \"lib\" prefix for modules if required\n \t  name=`$echo \"X$outputname\" | $Xsed -e 's/\\.la$//'`\n-\t  eval shared_ext=\\\"$shrext\\\"\n+\t  eval shared_ext=\\\"$shrext_cmds\\\"\n \t  eval libname=\\\"$libname_spec\\\"\n \telse\n \t  libname=`$echo \"X$outputname\" | $Xsed -e 's/\\.la$//'`\n@@ -2783,7 +3020,7 @@ EOF\n       if test -n \"$objs\"; then\n \tif test \"$deplibs_check_method\" != pass_all; then\n \t  $echo \"$modename: cannot build libtool library \\`$output' from non-libtool objects on this host:$objs\" 2>&1\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \telse\n \t  $echo\n \t  $echo \"*** Warning: Linking the shared library $output against the non-libtool\"\n@@ -2831,13 +3068,13 @@ EOF\n \tif test -n \"$8\"; then\n \t  $echo \"$modename: too many parameters to \\`-version-info'\" 1>&2\n \t  $echo \"$help\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \n \t# convert absolute version numbers to libtool ages\n \t# this retains compatibility with .la files and attempts\n \t# to make the code below a bit more comprehensible\n-\t\n+\n \tcase $vinfo_number in\n \tyes)\n \t  number_major=\"$2\"\n@@ -2877,36 +3114,36 @@ EOF\n \n \t# Check that each of the things are valid numbers.\n \tcase $current in\n-\t0 | [1-9] | [1-9][0-9] | [1-9][0-9][0-9]) ;;\n+\t0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;\n \t*)\n-\t  $echo \"$modename: CURRENT \\`$current' is not a nonnegative integer\" 1>&2\n+\t  $echo \"$modename: CURRENT \\`$current' must be a nonnegative integer\" 1>&2\n \t  $echo \"$modename: \\`$vinfo' is not valid version information\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n \n \tcase $revision in\n-\t0 | [1-9] | [1-9][0-9] | [1-9][0-9][0-9]) ;;\n+\t0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;\n \t*)\n-\t  $echo \"$modename: REVISION \\`$revision' is not a nonnegative integer\" 1>&2\n+\t  $echo \"$modename: REVISION \\`$revision' must be a nonnegative integer\" 1>&2\n \t  $echo \"$modename: \\`$vinfo' is not valid version information\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n \n \tcase $age in\n-\t0 | [1-9] | [1-9][0-9] | [1-9][0-9][0-9]) ;;\n+\t0|[1-9]|[1-9][0-9]|[1-9][0-9][0-9]|[1-9][0-9][0-9][0-9]|[1-9][0-9][0-9][0-9][0-9]) ;;\n \t*)\n-\t  $echo \"$modename: AGE \\`$age' is not a nonnegative integer\" 1>&2\n+\t  $echo \"$modename: AGE \\`$age' must be a nonnegative integer\" 1>&2\n \t  $echo \"$modename: \\`$vinfo' is not valid version information\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n \n \tif test \"$age\" -gt \"$current\"; then\n \t  $echo \"$modename: AGE \\`$age' is greater than the current interface number \\`$current'\" 1>&2\n \t  $echo \"$modename: \\`$vinfo' is not valid version information\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \n \t# Calculate the version variables.\n@@ -2923,7 +3160,7 @@ EOF\n \t  versuffix=\"$major.$age.$revision\"\n \t  # Darwin ld doesn't like 0 for these options...\n \t  minor_current=`expr $current + 1`\n-\t  verstring=\"-compatibility_version $minor_current -current_version $minor_current.$revision\"\n+\t  verstring=\"${wl}-compatibility_version ${wl}$minor_current ${wl}-current_version ${wl}$minor_current.$revision\"\n \t  ;;\n \n \tfreebsd-aout)\n@@ -2995,7 +3232,7 @@ EOF\n \t*)\n \t  $echo \"$modename: unknown library version type \\`$version_type'\" 1>&2\n \t  $echo \"Fatal configuration error.  See the $PACKAGE docs for more information.\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n \n@@ -3049,6 +3286,12 @@ EOF\n \t    *.$objext)\n \t       ;;\n \t    $output_objdir/$outputname | $output_objdir/$libname.* | $output_objdir/${libname}${release}.*)\n+\t       if test \"X$precious_files_regex\" != \"X\"; then\n+\t         if echo $p | $EGREP -e \"$precious_files_regex\" >/dev/null 2>&1\n+\t         then\n+\t\t   continue\n+\t\t fi\n+\t       fi\n \t       removelist=\"$removelist $p\"\n \t       ;;\n \t    *) ;;\n@@ -3123,7 +3366,7 @@ EOF\n \t  *-*-netbsd*)\n \t    # Don't link with libc until the a.out ld.so is fixed.\n \t    ;;\n-\t  *-*-openbsd* | *-*-freebsd*)\n+\t  *-*-openbsd* | *-*-freebsd* | *-*-dragonfly*)\n \t    # Do not include libc due to us having libc/libc_r.\n \t    test \"X$arg\" = \"X-lc\" && continue\n \t    ;;\n@@ -3528,7 +3771,7 @@ EOF\n \tfi\n \n \t# Get the real and link names of the library.\n-\teval shared_ext=\\\"$shrext\\\"\n+\teval shared_ext=\\\"$shrext_cmds\\\"\n \teval library_names=\\\"$library_names_spec\\\"\n \tset dummy $library_names\n \trealname=\"$2\"\n@@ -3558,10 +3801,11 @@ EOF\n \t    $show \"generating symbol list for \\`$libname.la'\"\n \t    export_symbols=\"$output_objdir/$libname.exp\"\n \t    $run $rm $export_symbols\n-\t    eval cmds=\\\"$export_symbols_cmds\\\"\n+\t    cmds=$export_symbols_cmds\n \t    save_ifs=\"$IFS\"; IFS='~'\n \t    for cmd in $cmds; do\n \t      IFS=\"$save_ifs\"\n+\t      eval cmd=\\\"$cmd\\\"\n \t      if len=`expr \"X$cmd\" : \".*\"` &&\n \t       test \"$len\" -le \"$max_cmd_len\" || test \"$max_cmd_len\" -le -1; then\n \t        $show \"$cmd\"\n@@ -3591,80 +3835,26 @@ EOF\n \tfor test_deplib in $deplibs; do\n \t\tcase \" $convenience \" in\n \t\t*\" $test_deplib \"*) ;;\n-\t\t*) \n+\t\t*)\n \t\t\ttmp_deplibs=\"$tmp_deplibs $test_deplib\"\n \t\t\t;;\n \t\tesac\n \tdone\n-\tdeplibs=\"$tmp_deplibs\" \n+\tdeplibs=\"$tmp_deplibs\"\n \n \tif test -n \"$convenience\"; then\n \t  if test -n \"$whole_archive_flag_spec\"; then\n \t    save_libobjs=$libobjs\n \t    eval libobjs=\\\"\\$libobjs $whole_archive_flag_spec\\\"\n \t  else\n \t    gentop=\"$output_objdir/${outputname}x\"\n-\t    $show \"${rm}r $gentop\"\n-\t    $run ${rm}r \"$gentop\"\n-\t    $show \"$mkdir $gentop\"\n-\t    $run $mkdir \"$gentop\"\n-\t    status=$?\n-\t    if test \"$status\" -ne 0 && test ! -d \"$gentop\"; then\n-\t      exit $status\n-\t    fi\n \t    generated=\"$generated $gentop\"\n \n-\t    for xlib in $convenience; do\n-\t      # Extract the objects.\n-\t      case $xlib in\n-\t      [\\\\/]* | [A-Za-z]:[\\\\/]*) xabs=\"$xlib\" ;;\n-\t      *) xabs=`pwd`\"/$xlib\" ;;\n-\t      esac\n-\t      xlib=`$echo \"X$xlib\" | $Xsed -e 's%^.*/%%'`\n-\t      xdir=\"$gentop/$xlib\"\n-\n-\t      $show \"${rm}r $xdir\"\n-\t      $run ${rm}r \"$xdir\"\n-\t      $show \"$mkdir $xdir\"\n-\t      $run $mkdir \"$xdir\"\n-\t      status=$?\n-\t      if test \"$status\" -ne 0 && test ! -d \"$xdir\"; then\n-\t\texit $status\n-\t      fi\n-\t      # We will extract separately just the conflicting names and we will no\n-\t      # longer touch any unique names. It is faster to leave these extract\n-\t      # automatically by $AR in one run.\n-\t      $show \"(cd $xdir && $AR x $xabs)\"\n-\t      $run eval \"(cd \\$xdir && $AR x \\$xabs)\" || exit $?\n-\t      if ($AR t \"$xabs\" | sort | sort -uc >/dev/null 2>&1); then\n-\t\t:\n-\t      else\n-\t\t$echo \"$modename: warning: object name conflicts; renaming object files\" 1>&2\n-\t\t$echo \"$modename: warning: to ensure that they will not overwrite\" 1>&2\n-\t\t$AR t \"$xabs\" | sort | uniq -cd | while read -r count name\n-\t\tdo\n-\t\t  i=1\n-\t\t  while test \"$i\" -le \"$count\"\n-\t\t  do\n-\t\t   # Put our $i before any first dot (extension)\n-\t\t   # Never overwrite any file\n-\t\t   name_to=\"$name\"\n-\t\t   while test \"X$name_to\" = \"X$name\" || test -f \"$xdir/$name_to\"\n-\t\t   do\n-\t\t     name_to=`$echo \"X$name_to\" | $Xsed -e \"s/\\([^.]*\\)/\\1-$i/\"`\n-\t\t   done\n-\t\t   $show \"(cd $xdir && $AR xN $i $xabs '$name' && $mv '$name' '$name_to')\"\n-\t\t   $run eval \"(cd \\$xdir && $AR xN $i \\$xabs '$name' && $mv '$name' '$name_to')\" || exit $?\n-\t\t   i=`expr $i + 1`\n-\t\t  done\n-\t\tdone\n-\t      fi\n-\n-\t      libobjs=\"$libobjs \"`find $xdir -name \\*.$objext -print -o -name \\*.lo -print | $NL2SP`\n-\t    done\n+\t    func_extract_archives $gentop $convenience\n+\t    libobjs=\"$libobjs $func_extract_archives_result\"\n \t  fi\n \tfi\n-\n+\t\n \tif test \"$thread_safe\" = yes && test -n \"$thread_safe_flag_spec\"; then\n \t  eval flag=\\\"$thread_safe_flag_spec\\\"\n \t  linker_flags=\"$linker_flags $flag\"\n@@ -3678,19 +3868,23 @@ EOF\n \t# Do each of the archive commands.\n \tif test \"$module\" = yes && test -n \"$module_cmds\" ; then\n \t  if test -n \"$export_symbols\" && test -n \"$module_expsym_cmds\"; then\n-\t    eval cmds=\\\"$module_expsym_cmds\\\"\n+\t    eval test_cmds=\\\"$module_expsym_cmds\\\"\n+\t    cmds=$module_expsym_cmds\n \t  else\n-\t    eval cmds=\\\"$module_cmds\\\"\n+\t    eval test_cmds=\\\"$module_cmds\\\"\n+\t    cmds=$module_cmds\n \t  fi\n \telse\n \tif test -n \"$export_symbols\" && test -n \"$archive_expsym_cmds\"; then\n-\t  eval cmds=\\\"$archive_expsym_cmds\\\"\n+\t  eval test_cmds=\\\"$archive_expsym_cmds\\\"\n+\t  cmds=$archive_expsym_cmds\n \telse\n-\t  eval cmds=\\\"$archive_cmds\\\"\n+\t  eval test_cmds=\\\"$archive_cmds\\\"\n+\t  cmds=$archive_cmds\n \t  fi\n \tfi\n \n-\tif test \"X$skipped_export\" != \"X:\" && len=`expr \"X$cmds\" : \".*\"` &&\n+\tif test \"X$skipped_export\" != \"X:\" && len=`expr \"X$test_cmds\" : \".*\"` &&\n \t   test \"$len\" -le \"$max_cmd_len\" || test \"$max_cmd_len\" -le -1; then\n \t  :\n \telse\n@@ -3709,6 +3903,7 @@ EOF\n \t    save_libobjs=$libobjs\n \t  fi\n \t  save_output=$output\n+\t  output_la=`$echo \"X$output\" | $Xsed -e \"$basename\"`\n \n \t  # Clear the reloadable object creation command queue and\n \t  # initialize k to one.\n@@ -3718,7 +3913,7 @@ EOF\n \t  delfiles=\n \t  last_robj=\n \t  k=1\n-\t  output=$output_objdir/$save_output-${k}.$objext\n+\t  output=$output_objdir/$output_la-${k}.$objext\n \t  # Loop over the list of objects to be linked.\n \t  for obj in $save_libobjs\n \t  do\n@@ -3738,9 +3933,9 @@ EOF\n \t\t# the last one created.\n \t\teval concat_cmds=\\\"\\$concat_cmds~$reload_cmds $objlist $last_robj\\\"\n \t      fi\n-\t      last_robj=$output_objdir/$save_output-${k}.$objext\n+\t      last_robj=$output_objdir/$output_la-${k}.$objext\n \t      k=`expr $k + 1`\n-\t      output=$output_objdir/$save_output-${k}.$objext\n+\t      output=$output_objdir/$output_la-${k}.$objext\n \t      objlist=$obj\n \t      len=1\n \t    fi\n@@ -3760,13 +3955,13 @@ EOF\n \t    eval concat_cmds=\\\"\\$concat_cmds~$export_symbols_cmds\\\"\n           fi\n \n-\t  # Set up a command to remove the reloadale object files\n+\t  # Set up a command to remove the reloadable object files\n \t  # after they are used.\n \t  i=0\n \t  while test \"$i\" -lt \"$k\"\n \t  do\n \t    i=`expr $i + 1`\n-\t    delfiles=\"$delfiles $output_objdir/$save_output-${i}.$objext\"\n+\t    delfiles=\"$delfiles $output_objdir/$output_la-${i}.$objext\"\n \t  done\n \n \t  $echo \"creating a temporary reloadable object file: $output\"\n@@ -3791,19 +3986,28 @@ EOF\n \t  # value of $libobjs for piecewise linking.\n \n \t  # Do each of the archive commands.\n+\t  if test \"$module\" = yes && test -n \"$module_cmds\" ; then\n+\t    if test -n \"$export_symbols\" && test -n \"$module_expsym_cmds\"; then\n+\t      cmds=$module_expsym_cmds\n+\t    else\n+\t      cmds=$module_cmds\n+\t    fi\n+\t  else\n \t  if test -n \"$export_symbols\" && test -n \"$archive_expsym_cmds\"; then\n-\t    eval cmds=\\\"$archive_expsym_cmds\\\"\n+\t    cmds=$archive_expsym_cmds\n \t  else\n-\t    eval cmds=\\\"$archive_cmds\\\"\n+\t    cmds=$archive_cmds\n+\t    fi\n \t  fi\n \n \t  # Append the command to remove the reloadable object files\n \t  # to the just-reset $cmds.\n-\t  eval cmds=\\\"\\$cmds~$rm $delfiles\\\"\n+\t  eval cmds=\\\"\\$cmds~\\$rm $delfiles\\\"\n \tfi\n \tsave_ifs=\"$IFS\"; IFS='~'\n \tfor cmd in $cmds; do\n \t  IFS=\"$save_ifs\"\n+\t  eval cmd=\\\"$cmd\\\"\n \t  $show \"$cmd\"\n \t  $run eval \"$cmd\" || exit $?\n \tdone\n@@ -3812,7 +4016,7 @@ EOF\n \t# Restore the uninstalled library and exit\n \tif test \"$mode\" = relink; then\n \t  $run eval '(cd $output_objdir && $rm ${realname}T && $mv $realname ${realname}T && $mv \"$realname\"U $realname)' || exit $?\n-\t  exit 0\n+\t  exit $EXIT_SUCCESS\n \tfi\n \n \t# Create links to the real library.\n@@ -3860,7 +4064,7 @@ EOF\n       *.lo)\n \tif test -n \"$objs$old_deplibs\"; then\n \t  $echo \"$modename: cannot build library object \\`$output' from non-libtool objects\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \tlibobj=\"$output\"\n \tobj=`$echo \"X$output\" | $Xsed -e \"$lo2o\"`\n@@ -3889,75 +4093,22 @@ EOF\n \t  eval reload_conv_objs=\\\"\\$reload_objs $whole_archive_flag_spec\\\"\n \telse\n \t  gentop=\"$output_objdir/${obj}x\"\n-\t  $show \"${rm}r $gentop\"\n-\t  $run ${rm}r \"$gentop\"\n-\t  $show \"$mkdir $gentop\"\n-\t  $run $mkdir \"$gentop\"\n-\t  status=$?\n-\t  if test \"$status\" -ne 0 && test ! -d \"$gentop\"; then\n-\t    exit $status\n-\t  fi\n \t  generated=\"$generated $gentop\"\n \n-\t  for xlib in $convenience; do\n-\t    # Extract the objects.\n-\t    case $xlib in\n-\t    [\\\\/]* | [A-Za-z]:[\\\\/]*) xabs=\"$xlib\" ;;\n-\t    *) xabs=`pwd`\"/$xlib\" ;;\n-\t    esac\n-\t    xlib=`$echo \"X$xlib\" | $Xsed -e 's%^.*/%%'`\n-\t    xdir=\"$gentop/$xlib\"\n-\n-\t    $show \"${rm}r $xdir\"\n-\t    $run ${rm}r \"$xdir\"\n-\t    $show \"$mkdir $xdir\"\n-\t    $run $mkdir \"$xdir\"\n-\t    status=$?\n-\t    if test \"$status\" -ne 0 && test ! -d \"$xdir\"; then\n-\t      exit $status\n-\t    fi\n-\t    # We will extract separately just the conflicting names and we will no\n-\t    # longer touch any unique names. It is faster to leave these extract\n-\t    # automatically by $AR in one run.\n-\t    $show \"(cd $xdir && $AR x $xabs)\"\n-\t    $run eval \"(cd \\$xdir && $AR x \\$xabs)\" || exit $?\n-\t    if ($AR t \"$xabs\" | sort | sort -uc >/dev/null 2>&1); then\n-\t      :\n-\t    else\n-\t      $echo \"$modename: warning: object name conflicts; renaming object files\" 1>&2\n-\t      $echo \"$modename: warning: to ensure that they will not overwrite\" 1>&2\n-\t      $AR t \"$xabs\" | sort | uniq -cd | while read -r count name\n-\t      do\n-\t\ti=1\n-\t\twhile test \"$i\" -le \"$count\"\n-\t\tdo\n-\t\t # Put our $i before any first dot (extension)\n-\t\t # Never overwrite any file\n-\t\t name_to=\"$name\"\n-\t\t while test \"X$name_to\" = \"X$name\" || test -f \"$xdir/$name_to\"\n-\t\t do\n-\t\t   name_to=`$echo \"X$name_to\" | $Xsed -e \"s/\\([^.]*\\)/\\1-$i/\"`\n-\t\t done\n-\t\t $show \"(cd $xdir && $AR xN $i $xabs '$name' && $mv '$name' '$name_to')\"\n-\t\t $run eval \"(cd \\$xdir && $AR xN $i \\$xabs '$name' && $mv '$name' '$name_to')\" || exit $?\n-\t\t i=`expr $i + 1`\n-\t\tdone\n-\t      done\n-\t    fi\n-\n-\t    reload_conv_objs=\"$reload_objs \"`find $xdir -name \\*.$objext -print -o -name \\*.lo -print | $NL2SP`\n-\t  done\n+\t  func_extract_archives $gentop $convenience\n+\t  reload_conv_objs=\"$reload_objs $func_extract_archives_result\"\n \tfi\n       fi\n \n       # Create the old-style object.\n       reload_objs=\"$objs$old_deplibs \"`$echo \"X$libobjs\" | $SP2NL | $Xsed -e '/\\.'${libext}$'/d' -e '/\\.lib$/d' -e \"$lo2o\" | $NL2SP`\" $reload_conv_objs\" ### testsuite: skip nested quoting test\n \n       output=\"$obj\"\n-      eval cmds=\\\"$reload_cmds\\\"\n+      cmds=$reload_cmds\n       save_ifs=\"$IFS\"; IFS='~'\n       for cmd in $cmds; do\n \tIFS=\"$save_ifs\"\n+\teval cmd=\\\"$cmd\\\"\n \t$show \"$cmd\"\n \t$run eval \"$cmd\" || exit $?\n       done\n@@ -3970,7 +4121,7 @@ EOF\n \t  $run ${rm}r $gentop\n \tfi\n \n-\texit 0\n+\texit $EXIT_SUCCESS\n       fi\n \n       if test \"$build_libtool_libs\" != yes; then\n@@ -3983,17 +4134,18 @@ EOF\n \t# accidentally link it into a program.\n \t# $show \"echo timestamp > $libobj\"\n \t# $run eval \"echo timestamp > $libobj\" || exit $?\n-\texit 0\n+\texit $EXIT_SUCCESS\n       fi\n \n       if test -n \"$pic_flag\" || test \"$pic_mode\" != default; then\n \t# Only do commands if we really have different PIC objects.\n \treload_objs=\"$libobjs $reload_conv_objs\"\n \toutput=\"$libobj\"\n-\teval cmds=\\\"$reload_cmds\\\"\n+\tcmds=$reload_cmds\n \tsave_ifs=\"$IFS\"; IFS='~'\n \tfor cmd in $cmds; do\n \t  IFS=\"$save_ifs\"\n+\t  eval cmd=\\\"$cmd\\\"\n \t  $show \"$cmd\"\n \t  $run eval \"$cmd\" || exit $?\n \tdone\n@@ -4005,7 +4157,7 @@ EOF\n \t$run ${rm}r $gentop\n       fi\n \n-      exit 0\n+      exit $EXIT_SUCCESS\n       ;;\n \n     prog)\n@@ -4206,12 +4358,12 @@ extern \\\"C\\\" {\n \n \t    # Prepare the list of exported symbols\n \t    if test -z \"$export_symbols\"; then\n-\t      export_symbols=\"$output_objdir/$output.exp\"\n+\t      export_symbols=\"$output_objdir/$outputname.exp\"\n \t      $run $rm $export_symbols\n \t      $run eval \"${SED} -n -e '/^: @PROGRAM@$/d' -e 's/^.* \\(.*\\)$/\\1/p' \"'< \"$nlist\" > \"$export_symbols\"'\n \t    else\n-\t      $run eval \"${SED} -e 's/\\([][.*^$]\\)/\\\\\\1/g' -e 's/^/ /' -e 's/$/$/'\"' < \"$export_symbols\" > \"$output_objdir/$output.exp\"'\n-\t      $run eval 'grep -f \"$output_objdir/$output.exp\" < \"$nlist\" > \"$nlist\"T'\n+\t      $run eval \"${SED} -e 's/\\([ ][.*^$]\\)/\\\\\\1/g' -e 's/^/ /' -e 's/$/$/'\"' < \"$export_symbols\" > \"$output_objdir/$outputname.exp\"'\n+\t      $run eval 'grep -f \"$output_objdir/$outputname.exp\" < \"$nlist\" > \"$nlist\"T'\n \t      $run eval 'mv \"$nlist\"T \"$nlist\"'\n \t    fi\n \t  fi\n@@ -4263,7 +4415,26 @@ extern \\\"C\\\" {\n #endif\n \n /* The mapping between symbol names and symbols. */\n+\"\n+\n+\t    case $host in\n+\t    *cygwin* | *mingw* )\n+\t  $echo >> \"$output_objdir/$dlsyms\" \"\\\n+/* DATA imports from DLLs on WIN32 can't be const, because\n+   runtime relocations are performed -- see ld's documentation\n+   on pseudo-relocs */\n+struct {\n+\"\n+\t      ;;\n+\t    * )\n+\t  $echo >> \"$output_objdir/$dlsyms\" \"\\\n const struct {\n+\"\n+\t      ;;\n+\t    esac\n+\n+\n+\t  $echo >> \"$output_objdir/$dlsyms\" \"\\\n   const char *name;\n   lt_ptr address;\n }\n@@ -4323,7 +4494,7 @@ static const void *lt_preloaded_setup() {\n \t  ;;\n \t*)\n \t  $echo \"$modename: unknown suffix for \\`$dlsyms'\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n       else\n@@ -4411,7 +4582,7 @@ static const void *lt_preloaded_setup() {\n \t# Link the executable and exit\n \t$show \"$link_command\"\n \t$run eval \"$link_command\" || exit $?\n-\texit 0\n+\texit $EXIT_SUCCESS\n       fi\n \n       if test \"$hardcode_action\" = relink; then\n@@ -4466,10 +4637,10 @@ static const void *lt_preloaded_setup() {\n       fi\n \n       # Quote $echo for shipping.\n-      if test \"X$echo\" = \"X$SHELL $0 --fallback-echo\"; then\n-\tcase $0 in\n-\t[\\\\/]* | [A-Za-z]:[\\\\/]*) qecho=\"$SHELL $0 --fallback-echo\";;\n-\t*) qecho=\"$SHELL `pwd`/$0 --fallback-echo\";;\n+      if test \"X$echo\" = \"X$SHELL $progpath --fallback-echo\"; then\n+\tcase $progpath in\n+\t[\\\\/]* | [A-Za-z]:[\\\\/]*) qecho=\"$SHELL $progpath --fallback-echo\";;\n+\t*) qecho=\"$SHELL `pwd`/$progpath --fallback-echo\";;\n \tesac\n \tqecho=`$echo \"X$qecho\" | $Xsed -e \"$sed_quote_subst\"`\n       else\n@@ -4492,10 +4663,10 @@ static const void *lt_preloaded_setup() {\n \tesac\n \tcase $host in\n \t  *cygwin* | *mingw* )\n-\t    cwrappersource=`$echo ${objdir}/lt-${output}.c`\n+\t    cwrappersource=`$echo ${objdir}/lt-${outputname}.c`\n \t    cwrapper=`$echo ${output}.exe`\n \t    $rm $cwrappersource $cwrapper\n-\t    trap \"$rm $cwrappersource $cwrapper; exit 1\" 1 2 15\n+\t    trap \"$rm $cwrappersource $cwrapper; exit $EXIT_FAILURE\" 1 2 15\n \n \t    cat > $cwrappersource <<EOF\n \n@@ -4504,7 +4675,7 @@ static const void *lt_preloaded_setup() {\n \n    The $output program cannot be directly executed until all the libtool\n    libraries that it depends on are installed.\n-   \n+\n    This wrapper executable should never be moved out of the build directory.\n    If it is, it will not operate correctly.\n \n@@ -4536,7 +4707,7 @@ EOF\n #if defined (_WIN32) || defined (__MSDOS__) || defined (__DJGPP__) || \\\n   defined (__OS2__)\n #define HAVE_DOS_BASED_FILE_SYSTEM\n-#ifndef DIR_SEPARATOR_2 \n+#ifndef DIR_SEPARATOR_2\n #define DIR_SEPARATOR_2 '\\\\'\n #endif\n #endif\n@@ -4567,7 +4738,7 @@ main (int argc, char *argv[])\n {\n   char **newargz;\n   int i;\n-  \n+\n   program_name = (char *) xstrdup ((char *) basename (argv[0]));\n   newargz = XMALLOC(char *, argc+2);\n EOF\n@@ -4580,7 +4751,7 @@ EOF\n   newargz[1] = fnqualify(argv[0]);\n   /* we know the script has the same name, without the .exe */\n   /* so make sure newargz[1] doesn't end in .exe */\n-  strendzap(newargz[1],\".exe\"); \n+  strendzap(newargz[1],\".exe\");\n   for (i = 1; i < argc; i++)\n     newargz[i+1] = xstrdup(argv[i]);\n   newargz[argc+1] = NULL;\n@@ -4603,7 +4774,7 @@ xmalloc (size_t num)\n   return p;\n }\n \n-char * \n+char *\n xstrdup (const char *string)\n {\n   return string ? strcpy ((char *) xmalloc (strlen (string) + 1), string) : NULL\n@@ -4617,7 +4788,7 @@ basename (const char *name)\n \n #if defined (HAVE_DOS_BASED_FILE_SYSTEM)\n   /* Skip over the disk name in MSDOS pathnames. */\n-  if (isalpha (name[0]) && name[1] == ':') \n+  if (isalpha (name[0]) && name[1] == ':')\n     name += 2;\n #endif\n \n@@ -4627,7 +4798,7 @@ basename (const char *name)\n   return (char *) base;\n }\n \n-char * \n+char *\n fnqualify(const char *path)\n {\n   size_t size;\n@@ -4655,7 +4826,7 @@ fnqualify(const char *path)\n }\n \n char *\n-strendzap(char *str, const char *pat) \n+strendzap(char *str, const char *pat)\n {\n   size_t len, patlen;\n \n@@ -4675,7 +4846,7 @@ strendzap(char *str, const char *pat)\n }\n \n static void\n-lt_error_core (int exit_status, const char * mode, \n+lt_error_core (int exit_status, const char * mode,\n           const char * message, va_list ap)\n {\n   fprintf (stderr, \"%s: %s: \", program_name, mode);\n@@ -4704,7 +4875,7 @@ EOF\n \t  ;;\n \tesac\n \t$rm $output\n-\ttrap \"$rm $output; exit 1\" 1 2 15\n+\ttrap \"$rm $output; exit $EXIT_FAILURE\" 1 2 15\n \n \t$echo > $output \"\\\n #! $SHELL\n@@ -4725,7 +4896,7 @@ sed_quote_subst='$sed_quote_subst'\n \n # The HP-UX ksh and POSIX shell print the target directory to stdout\n # if CDPATH is set.\n-if test \\\"\\${CDPATH+set}\\\" = set; then CDPATH=:; export CDPATH; fi\n+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH\n \n relink_command=\\\"$relink_command\\\"\n \n@@ -4804,7 +4975,7 @@ else\n       else\n \t$echo \\\"\\$relink_command_output\\\" >&2\n \t$rm \\\"\\$progdir/\\$file\\\"\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n     fi\n \n@@ -4866,20 +5037,20 @@ else\n \tesac\n \t$echo >> $output \"\\\n       \\$echo \\\"\\$0: cannot exec \\$program \\${1+\\\"\\$@\\\"}\\\"\n-      exit 1\n+      exit $EXIT_FAILURE\n     fi\n   else\n     # The program doesn't exist.\n     \\$echo \\\"\\$0: error: \\$progdir/\\$program does not exist\\\" 1>&2\n     \\$echo \\\"This script is just a wrapper for \\$program.\\\" 1>&2\n     $echo \\\"See the $PACKAGE documentation for more information.\\\" 1>&2\n-    exit 1\n+    exit $EXIT_FAILURE\n   fi\n fi\\\n \"\n \tchmod +x $output\n       fi\n-      exit 0\n+      exit $EXIT_SUCCESS\n       ;;\n     esac\n \n@@ -4902,76 +5073,78 @@ fi\\\n \n       if test -n \"$addlibs\"; then\n \tgentop=\"$output_objdir/${outputname}x\"\n-\t$show \"${rm}r $gentop\"\n-\t$run ${rm}r \"$gentop\"\n-\t$show \"$mkdir $gentop\"\n-\t$run $mkdir \"$gentop\"\n-\tstatus=$?\n-\tif test \"$status\" -ne 0 && test ! -d \"$gentop\"; then\n-\t  exit $status\n-\tfi\n \tgenerated=\"$generated $gentop\"\n \n-\t# Add in members from convenience archives.\n-\tfor xlib in $addlibs; do\n-\t  # Extract the objects.\n-\t  case $xlib in\n-\t  [\\\\/]* | [A-Za-z]:[\\\\/]*) xabs=\"$xlib\" ;;\n-\t  *) xabs=`pwd`\"/$xlib\" ;;\n-\t  esac\n-\t  xlib=`$echo \"X$xlib\" | $Xsed -e 's%^.*/%%'`\n-\t  xdir=\"$gentop/$xlib\"\n-\n-\t  $show \"${rm}r $xdir\"\n-\t  $run ${rm}r \"$xdir\"\n-\t  $show \"$mkdir $xdir\"\n-\t  $run $mkdir \"$xdir\"\n-\t  status=$?\n-\t  if test \"$status\" -ne 0 && test ! -d \"$xdir\"; then\n-\t    exit $status\n-\t  fi\n-\t  # We will extract separately just the conflicting names and we will no\n-\t  # longer touch any unique names. It is faster to leave these extract\n-\t  # automatically by $AR in one run.\n-\t  $show \"(cd $xdir && $AR x $xabs)\"\n-\t  $run eval \"(cd \\$xdir && $AR x \\$xabs)\" || exit $?\n-\t  if ($AR t \"$xabs\" | sort | sort -uc >/dev/null 2>&1); then\n-\t    :\n-\t  else\n-\t    $echo \"$modename: warning: object name conflicts; renaming object files\" 1>&2\n-\t    $echo \"$modename: warning: to ensure that they will not overwrite\" 1>&2\n-\t    $AR t \"$xabs\" | sort | uniq -cd | while read -r count name\n-\t    do\n-\t      i=1\n-\t      while test \"$i\" -le \"$count\"\n-\t      do\n-\t       # Put our $i before any first dot (extension)\n-\t       # Never overwrite any file\n-\t       name_to=\"$name\"\n-\t       while test \"X$name_to\" = \"X$name\" || test -f \"$xdir/$name_to\"\n-\t       do\n-\t\t name_to=`$echo \"X$name_to\" | $Xsed -e \"s/\\([^.]*\\)/\\1-$i/\"`\n-\t       done\n-\t       $show \"(cd $xdir && $AR xN $i $xabs '$name' && $mv '$name' '$name_to')\"\n-\t       $run eval \"(cd \\$xdir && $AR xN $i \\$xabs '$name' && $mv '$name' '$name_to')\" || exit $?\n-\t       i=`expr $i + 1`\n-\t      done\n-\t    done\n-\t  fi\n-\n-\t  oldobjs=\"$oldobjs \"`find $xdir -name \\*.${objext} -print -o -name \\*.lo -print | $NL2SP`\n-\tdone\n+\tfunc_extract_archives $gentop $addlibs\n+\toldobjs=\"$oldobjs $func_extract_archives_result\"\n       fi\n \n       # Do each command in the archive commands.\n       if test -n \"$old_archive_from_new_cmds\" && test \"$build_libtool_libs\" = yes; then\n-\teval cmds=\\\"$old_archive_from_new_cmds\\\"\n+       cmds=$old_archive_from_new_cmds\n       else\n+\t# POSIX demands no paths to be encoded in archives.  We have\n+\t# to avoid creating archives with duplicate basenames if we\n+\t# might have to extract them afterwards, e.g., when creating a\n+\t# static archive out of a convenience library, or when linking\n+\t# the entirety of a libtool archive into another (currently\n+\t# not supported by libtool).\n+\tif (for obj in $oldobjs\n+\t    do\n+\t      $echo \"X$obj\" | $Xsed -e 's%^.*/%%'\n+\t    done | sort | sort -uc >/dev/null 2>&1); then\n+\t  :\n+\telse\n+\t  $echo \"copying selected object files to avoid basename conflicts...\"\n+\n+\t  if test -z \"$gentop\"; then\n+\t    gentop=\"$output_objdir/${outputname}x\"\n+\t    generated=\"$generated $gentop\"\n+\n+\t    $show \"${rm}r $gentop\"\n+\t    $run ${rm}r \"$gentop\"\n+\t    $show \"$mkdir $gentop\"\n+\t    $run $mkdir \"$gentop\"\n+\t    status=$?\n+\t    if test \"$status\" -ne 0 && test ! -d \"$gentop\"; then\n+\t      exit $status\n+\t    fi\n+\t  fi\n+\n+\t  save_oldobjs=$oldobjs\n+\t  oldobjs=\n+\t  counter=1\n+\t  for obj in $save_oldobjs\n+\t  do\n+\t    objbase=`$echo \"X$obj\" | $Xsed -e 's%^.*/%%'`\n+\t    case \" $oldobjs \" in\n+\t    \" \") oldobjs=$obj ;;\n+\t    *[\\ /]\"$objbase \"*)\n+\t      while :; do\n+\t\t# Make sure we don't pick an alternate name that also\n+\t\t# overlaps.\n+\t\tnewobj=lt$counter-$objbase\n+\t\tcounter=`expr $counter + 1`\n+\t\tcase \" $oldobjs \" in\n+\t\t*[\\ /]\"$newobj \"*) ;;\n+\t\t*) if test ! -f \"$gentop/$newobj\"; then break; fi ;;\n+\t\tesac\n+\t      done\n+\t      $show \"ln $obj $gentop/$newobj || cp $obj $gentop/$newobj\"\n+\t      $run ln \"$obj\" \"$gentop/$newobj\" ||\n+\t      $run cp \"$obj\" \"$gentop/$newobj\"\n+\t      oldobjs=\"$oldobjs $gentop/$newobj\"\n+\t      ;;\n+\t    *) oldobjs=\"$oldobjs $obj\" ;;\n+\t    esac\n+\t  done\n+\tfi\n+\n \teval cmds=\\\"$old_archive_cmds\\\"\n \n \tif len=`expr \"X$cmds\" : \".*\"` &&\n \t     test \"$len\" -le \"$max_cmd_len\" || test \"$max_cmd_len\" -le -1; then\n-\t  :\n+\t  cmds=$old_archive_cmds\n \telse\n \t  # the command line is too long to link in one step, link in parts\n \t  $echo \"using piecewise archive linking...\"\n@@ -4980,25 +5153,12 @@ fi\\\n \t  objlist=\n \t  concat_cmds=\n \t  save_oldobjs=$oldobjs\n-\t  # GNU ar 2.10+ was changed to match POSIX; thus no paths are\n-\t  # encoded into archives.  This makes 'ar r' malfunction in\n-\t  # this piecewise linking case whenever conflicting object\n-\t  # names appear in distinct ar calls; check, warn and compensate.\n-\t    if (for obj in $save_oldobjs\n-\t    do\n-\t      $echo \"X$obj\" | $Xsed -e 's%^.*/%%'\n-\t    done | sort | sort -uc >/dev/null 2>&1); then\n-\t    :\n-\t  else\n-\t    $echo \"$modename: warning: object name conflicts; overriding AR_FLAGS to 'cq'\" 1>&2\n-\t    $echo \"$modename: warning: to ensure that POSIX-compatible ar will work\" 1>&2\n-\t    AR_FLAGS=cq\n-\t  fi\n+\n \t  # Is there a better way of finding the last object in the list?\n \t  for obj in $save_oldobjs\n \t  do\n \t    last_oldobj=$obj\n-\t  done  \n+\t  done\n \t  for obj in $save_oldobjs\n \t  do\n \t    oldobjs=\"$objlist $obj\"\n@@ -5012,7 +5172,7 @@ fi\\\n \t      oldobjs=$objlist\n \t      if test \"$obj\" = \"$last_oldobj\" ; then\n \t        RANLIB=$save_RANLIB\n-\t      fi  \n+\t      fi\n \t      test -z \"$concat_cmds\" || concat_cmds=$concat_cmds~\n \t      eval concat_cmds=\\\"\\${concat_cmds}$old_archive_cmds\\\"\n \t      objlist=\n@@ -5023,12 +5183,13 @@ fi\\\n \t  if test \"X$oldobjs\" = \"X\" ; then\n \t    eval cmds=\\\"\\$concat_cmds\\\"\n \t  else\n-\t    eval cmds=\\\"\\$concat_cmds~$old_archive_cmds\\\"\n+\t    eval cmds=\\\"\\$concat_cmds~\\$old_archive_cmds\\\"\n \t  fi\n \tfi\n       fi\n       save_ifs=\"$IFS\"; IFS='~'\n       for cmd in $cmds; do\n+        eval cmd=\\\"$cmd\\\"\n \tIFS=\"$save_ifs\"\n \t$show \"$cmd\"\n \t$run eval \"$cmd\" || exit $?\n@@ -5060,11 +5221,13 @@ fi\\\n \tfi\n       done\n       # Quote the link command for shipping.\n-      relink_command=\"(cd `pwd`; $SHELL $0 --mode=relink $libtool_args @inst_prefix_dir@)\"\n+      relink_command=\"(cd `pwd`; $SHELL $progpath $preserve_args --mode=relink $libtool_args @inst_prefix_dir@)\"\n       relink_command=`$echo \"X$relink_command\" | $Xsed -e \"$sed_quote_subst\"`\n       if test \"$hardcode_automatic\" = yes ; then\n-        relink_command=\n-      fi  \n+\trelink_command=\n+      fi\n+\n+\n       # Only create the output if not a dry run.\n       if test -z \"$run\"; then\n \tfor installed in no yes; do\n@@ -5082,7 +5245,7 @@ fi\\\n \t\teval libdir=`${SED} -n -e 's/^libdir=\\(.*\\)$/\\1/p' $deplib`\n \t\tif test -z \"$libdir\"; then\n \t\t  $echo \"$modename: \\`$deplib' is not a valid libtool archive\" 1>&2\n-\t\t  exit 1\n+\t\t  exit $EXIT_FAILURE\n \t\tfi\n \t\tnewdependency_libs=\"$newdependency_libs $libdir/$name\"\n \t\t;;\n@@ -5096,7 +5259,7 @@ fi\\\n \t      eval libdir=`${SED} -n -e 's/^libdir=\\(.*\\)$/\\1/p' $lib`\n \t      if test -z \"$libdir\"; then\n \t\t$echo \"$modename: \\`$lib' is not a valid libtool archive\" 1>&2\n-\t\texit 1\n+\t\texit $EXIT_FAILURE\n \t      fi\n \t      newdlfiles=\"$newdlfiles $libdir/$name\"\n \t    done\n@@ -5107,15 +5270,15 @@ fi\\\n \t      eval libdir=`${SED} -n -e 's/^libdir=\\(.*\\)$/\\1/p' $lib`\n \t      if test -z \"$libdir\"; then\n \t\t$echo \"$modename: \\`$lib' is not a valid libtool archive\" 1>&2\n-\t\texit 1\n+\t\texit $EXIT_FAILURE\n \t      fi\n \t      newdlprefiles=\"$newdlprefiles $libdir/$name\"\n \t    done\n \t    dlprefiles=\"$newdlprefiles\"\n \t  else\n \t    newdlfiles=\n \t    for lib in $dlfiles; do\n-\t      case $lib in \n+\t      case $lib in\n \t\t[\\\\/]* | [A-Za-z]:[\\\\/]*) abs=\"$lib\" ;;\n \t\t*) abs=`pwd`\"/$lib\" ;;\n \t      esac\n@@ -5124,7 +5287,7 @@ fi\\\n \t    dlfiles=\"$newdlfiles\"\n \t    newdlprefiles=\n \t    for lib in $dlprefiles; do\n-\t      case $lib in \n+\t      case $lib in\n \t\t[\\\\/]* | [A-Za-z]:[\\\\/]*) abs=\"$lib\" ;;\n \t\t*) abs=`pwd`\"/$lib\" ;;\n \t      esac\n@@ -5187,7 +5350,7 @@ relink_command=\\\"$relink_command\\\"\"\n       $run eval '(cd $output_objdir && $rm $outputname && $LN_S ../$outputname $outputname)' || exit $?\n       ;;\n     esac\n-    exit 0\n+    exit $EXIT_SUCCESS\n     ;;\n \n   # libtool install mode\n@@ -5202,7 +5365,7 @@ relink_command=\\\"$relink_command\\\"\"\n       # Aesthetically quote it.\n       arg=`$echo \"X$nonopt\" | $Xsed -e \"$sed_quote_subst\"`\n       case $arg in\n-      *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*)\n+      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \targ=\"\\\"$arg\\\"\"\n \t;;\n       esac\n@@ -5218,7 +5381,7 @@ relink_command=\\\"$relink_command\\\"\"\n     # Aesthetically quote it.\n     arg=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n     case $arg in\n-    *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*)\n+    *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n       arg=\"\\\"$arg\\\"\"\n       ;;\n     esac\n@@ -5266,7 +5429,7 @@ relink_command=\\\"$relink_command\\\"\"\n       # Aesthetically quote the argument.\n       arg=`$echo \"X$arg\" | $Xsed -e \"$sed_quote_subst\"`\n       case $arg in\n-      *[\\[\\~\\#\\^\\&\\*\\(\\)\\{\\}\\|\\;\\<\\>\\?\\'\\ \\\t]*|*]*)\n+      *$quote_scanset* | *]* | *\\|* | *\\&* | *\\(* | *\\)* | \"\")\n \targ=\"\\\"$arg\\\"\"\n \t;;\n       esac\n@@ -5276,13 +5439,13 @@ relink_command=\\\"$relink_command\\\"\"\n     if test -z \"$install_prog\"; then\n       $echo \"$modename: you must specify an install program\" 1>&2\n       $echo \"$help\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n     fi\n \n     if test -n \"$prev\"; then\n       $echo \"$modename: the \\`$prev' option requires an argument\" 1>&2\n       $echo \"$help\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n     fi\n \n     if test -z \"$files\"; then\n@@ -5292,7 +5455,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t$echo \"$modename: you must specify a destination\" 1>&2\n       fi\n       $echo \"$help\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n     fi\n \n     # Strip any trailing slash from the destination.\n@@ -5313,7 +5476,7 @@ relink_command=\\\"$relink_command\\\"\"\n       if test \"$#\" -gt 2; then\n \t$echo \"$modename: \\`$dest' is not a directory\" 1>&2\n \t$echo \"$help\" 1>&2\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n     fi\n     case $destdir in\n@@ -5325,7 +5488,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t*)\n \t  $echo \"$modename: \\`$destdir' must be an absolute directory name\" 1>&2\n \t  $echo \"$help\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n       done\n@@ -5354,7 +5517,7 @@ relink_command=\\\"$relink_command\\\"\"\n \telse\n \t  $echo \"$modename: \\`$file' is not a valid libtool archive\" 1>&2\n \t  $echo \"$help\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \n \tlibrary_names=\n@@ -5396,7 +5559,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t  # but it's something to keep an eye on.\n \t  if test \"$inst_prefix_dir\" = \"$destdir\"; then\n \t    $echo \"$modename: error: cannot install \\`$file' to a directory not ending in $libdir\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \n \t  if test -n \"$inst_prefix_dir\"; then\n@@ -5411,7 +5574,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t  if $run eval \"$relink_command\"; then :\n \t  else\n \t    $echo \"$modename: error: relink \\`$file' with the above command before installing it\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \tfi\n \n@@ -5446,10 +5609,11 @@ relink_command=\\\"$relink_command\\\"\"\n \n \t  # Do each command in the postinstall commands.\n \t  lib=\"$destdir/$realname\"\n-\t  eval cmds=\\\"$postinstall_cmds\\\"\n+\t  cmds=$postinstall_cmds\n \t  save_ifs=\"$IFS\"; IFS='~'\n \t  for cmd in $cmds; do\n \t    IFS=\"$save_ifs\"\n+\t    eval cmd=\\\"$cmd\\\"\n \t    $show \"$cmd\"\n \t    $run eval \"$cmd\" || exit $?\n \t  done\n@@ -5489,7 +5653,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t*)\n \t  $echo \"$modename: cannot copy a libtool object to \\`$destfile'\" 1>&2\n \t  $echo \"$help\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \t  ;;\n \tesac\n \n@@ -5507,7 +5671,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t  $show \"$install_prog $staticobj $staticdest\"\n \t  $run eval \"$install_prog \\$staticobj \\$staticdest\" || exit $?\n \tfi\n-\texit 0\n+\texit $EXIT_SUCCESS\n \t;;\n \n       *)\n@@ -5561,7 +5725,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t  # Check the variables that should have been set.\n \t  if test -z \"$notinst_deplibs\"; then\n \t    $echo \"$modename: invalid libtool wrapper script \\`$wrapper'\" 1>&2\n-\t    exit 1\n+\t    exit $EXIT_FAILURE\n \t  fi\n \n \t  finalize=yes\n@@ -5602,8 +5766,12 @@ relink_command=\\\"$relink_command\\\"\"\n \t      tmpdir=\"/tmp\"\n \t      test -n \"$TMPDIR\" && tmpdir=\"$TMPDIR\"\n \t      tmpdir=\"$tmpdir/libtool-$$\"\n-\t      if $mkdir -p \"$tmpdir\" && chmod 700 \"$tmpdir\"; then :\n+\t      save_umask=`umask`\n+\t      umask 0077\n+\t      if $mkdir \"$tmpdir\"; then\n+\t        umask $save_umask\n \t      else\n+\t        umask $save_umask\n \t\t$echo \"$modename: error: cannot create temporary directory \\`$tmpdir'\" 1>&2\n \t\tcontinue\n \t      fi\n@@ -5662,16 +5830,17 @@ relink_command=\\\"$relink_command\\\"\"\n       $show \"$install_prog $file $oldlib\"\n       $run eval \"$install_prog \\$file \\$oldlib\" || exit $?\n \n-      if test -n \"$stripme\" && test -n \"$striplib\"; then\n+      if test -n \"$stripme\" && test -n \"$old_striplib\"; then\n \t$show \"$old_striplib $oldlib\"\n \t$run eval \"$old_striplib $oldlib\" || exit $?\n       fi\n \n       # Do each command in the postinstall commands.\n-      eval cmds=\\\"$old_postinstall_cmds\\\"\n+      cmds=$old_postinstall_cmds\n       save_ifs=\"$IFS\"; IFS='~'\n       for cmd in $cmds; do\n \tIFS=\"$save_ifs\"\n+\teval cmd=\\\"$cmd\\\"\n \t$show \"$cmd\"\n \t$run eval \"$cmd\" || exit $?\n       done\n@@ -5685,9 +5854,9 @@ relink_command=\\\"$relink_command\\\"\"\n     if test -n \"$current_libdirs\"; then\n       # Maybe just do a dry run.\n       test -n \"$run\" && current_libdirs=\" -n$current_libdirs\"\n-      exec_cmd='$SHELL $0 --finish$current_libdirs'\n+      exec_cmd='$SHELL $progpath $preserve_args --finish$current_libdirs'\n     else\n-      exit 0\n+      exit $EXIT_SUCCESS\n     fi\n     ;;\n \n@@ -5706,10 +5875,11 @@ relink_command=\\\"$relink_command\\\"\"\n       for libdir in $libdirs; do\n \tif test -n \"$finish_cmds\"; then\n \t  # Do each command in the finish commands.\n-\t  eval cmds=\\\"$finish_cmds\\\"\n+\t  cmds=$finish_cmds\n \t  save_ifs=\"$IFS\"; IFS='~'\n \t  for cmd in $cmds; do\n \t    IFS=\"$save_ifs\"\n+\t    eval cmd=\\\"$cmd\\\"\n \t    $show \"$cmd\"\n \t    $run eval \"$cmd\" || admincmds=\"$admincmds\n        $cmd\"\n@@ -5726,7 +5896,7 @@ relink_command=\\\"$relink_command\\\"\"\n     fi\n \n     # Exit here if they wanted silent mode.\n-    test \"$show\" = : && exit 0\n+    test \"$show\" = : && exit $EXIT_SUCCESS\n \n     $echo \"----------------------------------------------------------------------\"\n     $echo \"Libraries have been installed in:\"\n@@ -5762,7 +5932,7 @@ relink_command=\\\"$relink_command\\\"\"\n     $echo \"See any operating system documentation about shared libraries for\"\n     $echo \"more information, such as the ld(1) and ld.so(8) manual pages.\"\n     $echo \"----------------------------------------------------------------------\"\n-    exit 0\n+    exit $EXIT_SUCCESS\n     ;;\n \n   # libtool execute mode\n@@ -5774,15 +5944,15 @@ relink_command=\\\"$relink_command\\\"\"\n     if test -z \"$cmd\"; then\n       $echo \"$modename: you must specify a COMMAND\" 1>&2\n       $echo \"$help\"\n-      exit 1\n+      exit $EXIT_FAILURE\n     fi\n \n     # Handle -dlopen flags immediately.\n     for file in $execute_dlfiles; do\n       if test ! -f \"$file\"; then\n \t$echo \"$modename: \\`$file' is not a file\" 1>&2\n \t$echo \"$help\" 1>&2\n-\texit 1\n+\texit $EXIT_FAILURE\n       fi\n \n       dir=\n@@ -5793,7 +5963,7 @@ relink_command=\\\"$relink_command\\\"\"\n \telse\n \t  $echo \"$modename: \\`$lib' is not a valid libtool archive\" 1>&2\n \t  $echo \"$help\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \n \t# Read the libtool library.\n@@ -5820,7 +5990,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t  dir=\"$dir/$objdir\"\n \telse\n \t  $echo \"$modename: cannot find \\`$dlname' in \\`$dir' or \\`$dir/$objdir'\" 1>&2\n-\t  exit 1\n+\t  exit $EXIT_FAILURE\n \tfi\n \t;;\n \n@@ -5900,7 +6070,7 @@ relink_command=\\\"$relink_command\\\"\"\n \t$echo \"export $shlibpath_var\"\n       fi\n       $echo \"$cmd$args\"\n-      exit 0\n+      exit $EXIT_SUCCESS\n     fi\n     ;;\n \n@@ -5928,7 +6098,7 @@ relink_command=\\\"$relink_command\\\"\"\n     if test -z \"$rm\"; then\n       $echo \"$modename: you must specify an RM program\" 1>&2\n       $echo \"$help\" 1>&2\n-      exit 1\n+      exit $EXIT_FAILURE\n     fi\n \n     rmdirs=\n@@ -5983,10 +6153,11 @@ relink_command=\\\"$relink_command\\\"\"\n \t  if test \"$mode\" = uninstall; then\n \t    if test -n \"$library_names\"; then\n \t      # Do each command in the postuninstall commands.\n-\t      eval cmds=\\\"$postuninstall_cmds\\\"\n+\t      cmds=$postuninstall_cmds\n \t      save_ifs=\"$IFS\"; IFS='~'\n \t      for cmd in $cmds; do\n \t\tIFS=\"$save_ifs\"\n+\t\teval cmd=\\\"$cmd\\\"\n \t\t$show \"$cmd\"\n \t\t$run eval \"$cmd\"\n \t\tif test \"$?\" -ne 0 && test \"$rmforce\" != yes; then\n@@ -5998,10 +6169,11 @@ relink_command=\\\"$relink_command\\\"\"\n \n \t    if test -n \"$old_library\"; then\n \t      # Do each command in the old_postuninstall commands.\n-\t      eval cmds=\\\"$old_postuninstall_cmds\\\"\n+\t      cmds=$old_postuninstall_cmds\n \t      save_ifs=\"$IFS\"; IFS='~'\n \t      for cmd in $cmds; do\n \t\tIFS=\"$save_ifs\"\n+\t\teval cmd=\\\"$cmd\\\"\n \t\t$show \"$cmd\"\n \t\t$run eval \"$cmd\"\n \t\tif test \"$?\" -ne 0 && test \"$rmforce\" != yes; then\n@@ -6040,7 +6212,7 @@ relink_command=\\\"$relink_command\\\"\"\n \tif test \"$mode\" = clean ; then\n \t  noexename=$name\n \t  case $file in\n-\t  *.exe) \n+\t  *.exe)\n \t    file=`$echo $file|${SED} 's,.exe$,,'`\n \t    noexename=`$echo $name|${SED} 's,.exe$,,'`\n \t    # $file with .exe has already been added to rmfiles,\n@@ -6085,20 +6257,20 @@ relink_command=\\\"$relink_command\\\"\"\n   \"\")\n     $echo \"$modename: you must specify a MODE\" 1>&2\n     $echo \"$generic_help\" 1>&2\n-    exit 1\n+    exit $EXIT_FAILURE\n     ;;\n   esac\n \n   if test -z \"$exec_cmd\"; then\n     $echo \"$modename: invalid operation mode \\`$mode'\" 1>&2\n     $echo \"$generic_help\" 1>&2\n-    exit 1\n+    exit $EXIT_FAILURE\n   fi\n fi # test -z \"$show_help\"\n \n if test -n \"$exec_cmd\"; then\n   eval exec $exec_cmd\n-  exit 1\n+  exit $EXIT_FAILURE\n fi\n \n # We need to display help for each of the modes.\n@@ -6134,7 +6306,7 @@ MODE-ARGS vary depending on the MODE.  Try \\`$modename --help --mode=MODE' for\n a more detailed description of MODE.\n \n Report bugs to <bug-libtool@gnu.org>.\"\n-  exit 0\n+  exit $EXIT_SUCCESS\n   ;;\n \n clean)\n@@ -6246,6 +6418,8 @@ The following components of LINK-COMMAND are treated specially:\n   -no-undefined     declare that a library does not refer to external symbols\n   -o OUTPUT-FILE    create OUTPUT-FILE from the specified objects\n   -objectlist FILE  Use a list of object files found in FILE to specify objects\n+  -precious-files-regex REGEX\n+                    don't remove output files matching REGEX\n   -release RELEASE  specify package release information\n   -rpath LIBDIR     the created library will eventually be installed in LIBDIR\n   -R[ ]LIBDIR       add LIBDIR to the runtime path of programs and libraries\n@@ -6287,14 +6461,14 @@ Otherwise, only FILE itself is deleted using RM.\"\n *)\n   $echo \"$modename: invalid operation mode \\`$mode'\" 1>&2\n   $echo \"$help\" 1>&2\n-  exit 1\n+  exit $EXIT_FAILURE\n   ;;\n esac\n \n $echo\n $echo \"Try \\`$modename --help' for more information about other modes.\"\n \n-exit 0\n+exit $?\n \n # The TAGs below are defined such that we never get into a situation\n # in which we disable both kinds of libraries.  Given conflicting"}, {"sha": "64b5f901dd558f301c33a0fb99466b48eb58a27f", "filename": "libjava/libltdl/missing", "status": "modified", "additions": 72, "deletions": 55, "changes": 127, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fmissing", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fa275f0a5cd7380966a54c48d38e95938dd791f4/libjava%2Flibltdl%2Fmissing", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Fmissing?ref=fa275f0a5cd7380966a54c48d38e95938dd791f4", "patch": "@@ -1,6 +1,10 @@\n #! /bin/sh\n # Common stub for a few missing GNU programs while installing.\n-# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003 Free Software Foundation, Inc.\n+\n+scriptversion=2004-09-07.08\n+\n+# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004\n+#   Free Software Foundation, Inc.\n # Originally by Fran,cois Pinard <pinard@iro.umontreal.ca>, 1996.\n \n # This program is free software; you can redistribute it and/or modify\n@@ -38,18 +42,24 @@ else\n   configure_ac=configure.in\n fi\n \n+msg=\"missing on your system\"\n+\n case \"$1\" in\n --run)\n   # Try to run requested program, and just exit if it succeeds.\n   run=\n   shift\n   \"$@\" && exit 0\n+  # Exit code 63 means version mismatch.  This often happens\n+  # when the user try to use an ancient version of a tool on\n+  # a file that requires a minimum version.  In this case we\n+  # we should proceed has if the program had been absent, or\n+  # if --run hadn't been passed.\n+  if test $? = 63; then\n+    run=:\n+    msg=\"probably too old\"\n+  fi\n   ;;\n-esac\n-\n-# If it does not exist, or fails to run (possibly an outdated version),\n-# try to emulate it.\n-case \"$1\" in\n \n   -h|--h|--he|--hel|--help)\n     echo \"\\\n@@ -74,11 +84,15 @@ Supported PROGRAM values:\n   lex          create \\`lex.yy.c', if possible, from existing .c\n   makeinfo     touch the output file\n   tar          try tar, gnutar, gtar, then tar without non-portable flags\n-  yacc         create \\`y.tab.[ch]', if possible, from existing .[ch]\"\n+  yacc         create \\`y.tab.[ch]', if possible, from existing .[ch]\n+\n+Send bug reports to <bug-automake@gnu.org>.\"\n+    exit 0\n     ;;\n \n   -v|--v|--ve|--ver|--vers|--versi|--versio|--version)\n-    echo \"missing 0.4 - GNU automake\"\n+    echo \"missing $scriptversion (GNU Automake)\"\n+    exit 0\n     ;;\n \n   -*)\n@@ -87,42 +101,62 @@ Supported PROGRAM values:\n     exit 1\n     ;;\n \n-  aclocal*)\n+esac\n+\n+# Now exit if we have it, but it failed.  Also exit now if we\n+# don't have it and --version was passed (most likely to detect\n+# the program).\n+case \"$1\" in\n+  lex|yacc)\n+    # Not GNU programs, they don't have --version.\n+    ;;\n+\n+  tar)\n+    if test -n \"$run\"; then\n+       echo 1>&2 \"ERROR: \\`tar' requires --run\"\n+       exit 1\n+    elif test \"x$2\" = \"x--version\" || test \"x$2\" = \"x--help\"; then\n+       exit 1\n+    fi\n+    ;;\n+\n+  *)\n     if test -z \"$run\" && ($1 --version) > /dev/null 2>&1; then\n        # We have it, but it failed.\n        exit 1\n+    elif test \"x$2\" = \"x--version\" || test \"x$2\" = \"x--help\"; then\n+       # Could not run --version or --help.  This is probably someone\n+       # running `$TOOL --version' or `$TOOL --help' to check whether\n+       # $TOOL exists and not knowing $TOOL uses missing.\n+       exit 1\n     fi\n+    ;;\n+esac\n \n+# If it does not exist, or fails to run (possibly an outdated version),\n+# try to emulate it.\n+case \"$1\" in\n+  aclocal*)\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' is $msg.  You should only need it if\n          you modified \\`acinclude.m4' or \\`${configure_ac}'.  You might want\n          to install the \\`Automake' and \\`Perl' packages.  Grab them from\n          any GNU archive site.\"\n     touch aclocal.m4\n     ;;\n \n   autoconf)\n-    if test -z \"$run\" && ($1 --version) > /dev/null 2>&1; then\n-       # We have it, but it failed.\n-       exit 1\n-    fi\n-\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' is $msg.  You should only need it if\n          you modified \\`${configure_ac}'.  You might want to install the\n          \\`Autoconf' and \\`GNU m4' packages.  Grab them from any GNU\n          archive site.\"\n     touch configure\n     ;;\n \n   autoheader)\n-    if test -z \"$run\" && ($1 --version) > /dev/null 2>&1; then\n-       # We have it, but it failed.\n-       exit 1\n-    fi\n-\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' is $msg.  You should only need it if\n          you modified \\`acconfig.h' or \\`${configure_ac}'.  You might want\n          to install the \\`Autoconf' and \\`GNU m4' packages.  Grab them\n          from any GNU archive site.\"\n@@ -140,13 +174,8 @@ WARNING: \\`$1' is missing on your system.  You should only need it if\n     ;;\n \n   automake*)\n-    if test -z \"$run\" && ($1 --version) > /dev/null 2>&1; then\n-       # We have it, but it failed.\n-       exit 1\n-    fi\n-\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' is $msg.  You should only need it if\n          you modified \\`Makefile.am', \\`acinclude.m4' or \\`${configure_ac}'.\n          You might want to install the \\`Automake' and \\`Perl' packages.\n          Grab them from any GNU archive site.\"\n@@ -156,14 +185,9 @@ WARNING: \\`$1' is missing on your system.  You should only need it if\n     ;;\n \n   autom4te)\n-    if test -z \"$run\" && ($1 --version) > /dev/null 2>&1; then\n-       # We have it, but it failed.\n-       exit 1\n-    fi\n-\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is needed, and you do not seem to have it handy on your\n-         system.  You might have modified some files without having the\n+WARNING: \\`$1' is needed, but is $msg.\n+         You might have modified some files without having the\n          proper tools for further handling them.\n          You can get \\`$1' as part of \\`Autoconf' from any GNU\n          archive site.\"\n@@ -185,7 +209,7 @@ WARNING: \\`$1' is needed, and you do not seem to have it handy on your\n \n   bison|yacc)\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' $msg.  You should only need it if\n          you modified a \\`.y' file.  You may need the \\`Bison' package\n          in order for those modifications to take effect.  You can get\n          \\`Bison' from any GNU archive site.\"\n@@ -215,7 +239,7 @@ WARNING: \\`$1' is missing on your system.  You should only need it if\n \n   lex|flex)\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' is $msg.  You should only need it if\n          you modified a \\`.l' file.  You may need the \\`Flex' package\n          in order for those modifications to take effect.  You can get\n          \\`Flex' from any GNU archive site.\"\n@@ -237,13 +261,8 @@ WARNING: \\`$1' is missing on your system.  You should only need it if\n     ;;\n \n   help2man)\n-    if test -z \"$run\" && ($1 --version) > /dev/null 2>&1; then\n-       # We have it, but it failed.\n-       exit 1\n-    fi\n-\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' is $msg.  You should only need it if\n \t you modified a dependency of a manual page.  You may need the\n \t \\`Help2man' package in order for those modifications to take\n \t effect.  You can get \\`Help2man' from any GNU archive site.\"\n@@ -262,13 +281,8 @@ WARNING: \\`$1' is missing on your system.  You should only need it if\n     ;;\n \n   makeinfo)\n-    if test -z \"$run\" && (makeinfo --version) > /dev/null 2>&1; then\n-       # We have makeinfo, but it failed.\n-       exit 1\n-    fi\n-\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is missing on your system.  You should only need it if\n+WARNING: \\`$1' is $msg.  You should only need it if\n          you modified a \\`.texi' or \\`.texinfo' file, or any other file\n          indirectly affecting the aspect of the manual.  The spurious\n          call might also be the consequence of using a buggy \\`make' (AIX,\n@@ -284,10 +298,6 @@ WARNING: \\`$1' is missing on your system.  You should only need it if\n \n   tar)\n     shift\n-    if test -n \"$run\"; then\n-      echo 1>&2 \"ERROR: \\`tar' requires --run\"\n-      exit 1\n-    fi\n \n     # We have already tried tar in the generic part.\n     # Look for gnutar/gtar before invocation to avoid ugly error\n@@ -323,8 +333,8 @@ WARNING: I can't seem to be able to run \\`tar' with the given arguments.\n \n   *)\n     echo 1>&2 \"\\\n-WARNING: \\`$1' is needed, and you do not seem to have it handy on your\n-         system.  You might have modified some files without having the\n+WARNING: \\`$1' is needed, and is $msg.\n+         You might have modified some files without having the\n          proper tools for further handling them.  Check the \\`README' file,\n          it often tells you about the needed prerequisites for installing\n          this package.  You may also peek at any GNU archive site, in case\n@@ -334,3 +344,10 @@ WARNING: \\`$1' is needed, and you do not seem to have it handy on your\n esac\n \n exit 0\n+\n+# Local variables:\n+# eval: (add-hook 'write-file-hooks 'time-stamp)\n+# time-stamp-start: \"scriptversion=\"\n+# time-stamp-format: \"%:y-%02m-%02d.%02H\"\n+# time-stamp-end: \"$\"\n+# End:"}, {"sha": "d2d5f21b611235316317197d3a32c2dff5897a6f", "filename": "libjava/libltdl/mkinstalldirs", "status": "removed", "additions": 0, "deletions": 111, "changes": 111, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/625a46d9b69b3068844a79bb20e07abe8b3ac57e/libjava%2Flibltdl%2Fmkinstalldirs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/625a46d9b69b3068844a79bb20e07abe8b3ac57e/libjava%2Flibltdl%2Fmkinstalldirs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibltdl%2Fmkinstalldirs?ref=625a46d9b69b3068844a79bb20e07abe8b3ac57e", "patch": "@@ -1,111 +0,0 @@\n-#! /bin/sh\n-# mkinstalldirs --- make directory hierarchy\n-# Author: Noah Friedman <friedman@prep.ai.mit.edu>\n-# Created: 1993-05-16\n-# Public domain\n-\n-errstatus=0\n-dirmode=\"\"\n-\n-usage=\"\\\n-Usage: mkinstalldirs [-h] [--help] [-m mode] dir ...\"\n-\n-# process command line arguments\n-while test $# -gt 0 ; do\n-  case $1 in\n-    -h | --help | --h*)         # -h for help\n-      echo \"$usage\" 1>&2\n-      exit 0\n-      ;;\n-    -m)                         # -m PERM arg\n-      shift\n-      test $# -eq 0 && { echo \"$usage\" 1>&2; exit 1; }\n-      dirmode=$1\n-      shift\n-      ;;\n-    --)                         # stop option processing\n-      shift\n-      break\n-      ;;\n-    -*)                         # unknown option\n-      echo \"$usage\" 1>&2\n-      exit 1\n-      ;;\n-    *)                          # first non-opt arg\n-      break\n-      ;;\n-  esac\n-done\n-\n-for file\n-do\n-  if test -d \"$file\"; then\n-    shift\n-  else\n-    break\n-  fi\n-done\n-\n-case $# in\n-  0) exit 0 ;;\n-esac\n-\n-case $dirmode in\n-  '')\n-    if mkdir -p -- . 2>/dev/null; then\n-      echo \"mkdir -p -- $*\"\n-      exec mkdir -p -- \"$@\"\n-    fi\n-    ;;\n-  *)\n-    if mkdir -m \"$dirmode\" -p -- . 2>/dev/null; then\n-      echo \"mkdir -m $dirmode -p -- $*\"\n-      exec mkdir -m \"$dirmode\" -p -- \"$@\"\n-    fi\n-    ;;\n-esac\n-\n-for file\n-do\n-  set fnord `echo \":$file\" | sed -ne 's/^:\\//#/;s/^://;s/\\// /g;s/^#/\\//;p'`\n-  shift\n-\n-  pathcomp=\n-  for d\n-  do\n-    pathcomp=\"$pathcomp$d\"\n-    case $pathcomp in\n-      -*) pathcomp=./$pathcomp ;;\n-    esac\n-\n-    if test ! -d \"$pathcomp\"; then\n-      echo \"mkdir $pathcomp\"\n-\n-      mkdir \"$pathcomp\" || lasterr=$?\n-\n-      if test ! -d \"$pathcomp\"; then\n-  \terrstatus=$lasterr\n-      else\n-  \tif test ! -z \"$dirmode\"; then\n-\t  echo \"chmod $dirmode $pathcomp\"\n-    \t  lasterr=\"\"\n-  \t  chmod \"$dirmode\" \"$pathcomp\" || lasterr=$?\n-\n-  \t  if test ! -z \"$lasterr\"; then\n-  \t    errstatus=$lasterr\n-  \t  fi\n-  \tfi\n-      fi\n-    fi\n-\n-    pathcomp=\"$pathcomp/\"\n-  done\n-done\n-\n-exit $errstatus\n-\n-# Local Variables:\n-# mode: shell-script\n-# sh-indentation: 2\n-# End:\n-# mkinstalldirs ends here"}]}