{"sha": "c37257a1f686bdd260a2edc445f8b3f24dceec2e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzM3MjU3YTFmNjg2YmRkMjYwYTJlZGM0NDVmOGIzZjI0ZGNlZWMyZQ==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2011-12-08T08:50:35Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2011-12-08T08:50:35Z"}, "message": "re PR lto/48437 (LTO crashes with block-local function declarations)\n\n2011-12-08  Richard Guenther  <rguenther@suse.de>\n\n\tPR lto/48437\n\t* lto-streamer-out.c (tree_is_indexable): Exclude block-local\n\textern declarations.\n\n\t* gcc.dg/lto/20111207-2_0.c: New testcase.\n\t* gcc.dg/guality/pr48437.c: Likewise.\n\nFrom-SVN: r182100", "tree": {"sha": "704e59c3933823639810c63e24aef23672bd795e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/704e59c3933823639810c63e24aef23672bd795e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c37257a1f686bdd260a2edc445f8b3f24dceec2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c37257a1f686bdd260a2edc445f8b3f24dceec2e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c37257a1f686bdd260a2edc445f8b3f24dceec2e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c37257a1f686bdd260a2edc445f8b3f24dceec2e/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a633b93ea34210dcb8ce06c7bfb3df8efd7c3fbc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a633b93ea34210dcb8ce06c7bfb3df8efd7c3fbc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a633b93ea34210dcb8ce06c7bfb3df8efd7c3fbc"}], "stats": {"total": 56, "additions": 56, "deletions": 0}, "files": [{"sha": "325c1e0763e5508c900de483f60bfa63567fd39d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c37257a1f686bdd260a2edc445f8b3f24dceec2e", "patch": "@@ -1,3 +1,9 @@\n+2011-12-08  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR lto/48437\n+\t* lto-streamer-out.c (tree_is_indexable): Exclude block-local\n+\textern declarations.\n+\n 2011-12-07  Andrew Pinski  <apinski@cavium.com>\n \n \tPR middle-end/45416"}, {"sha": "655cf89bc288b768fb91d5a389b018e7e90af545", "filename": "gcc/lto-streamer-out.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Flto-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Flto-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-out.c?ref=c37257a1f686bdd260a2edc445f8b3f24dceec2e", "patch": "@@ -129,6 +129,16 @@ tree_is_indexable (tree t)\n   else if (TREE_CODE (t) == VAR_DECL && decl_function_context (t)\n \t   && !TREE_STATIC (t))\n     return false;\n+  /* If this is a decl generated for block local externs for\n+     debug info generation, stream it unshared alongside BLOCK_VARS.  */\n+  else if (VAR_OR_FUNCTION_DECL_P (t)\n+\t   /* ???  The following tests are a literal match on what\n+\t      c-decl.c:pop_scope does.  */\n+\t   && TREE_PUBLIC (t)\n+\t   && DECL_EXTERNAL (t)\n+\t   && DECL_CONTEXT (t)\n+\t   && TREE_CODE (DECL_CONTEXT (t)) == FUNCTION_DECL)\n+    return false;\n   else\n     return (TYPE_P (t) || DECL_P (t) || TREE_CODE (t) == SSA_NAME);\n }"}, {"sha": "ededf0425f6703bfc23652e0982f9072b62c982d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c37257a1f686bdd260a2edc445f8b3f24dceec2e", "patch": "@@ -1,3 +1,9 @@\n+2011-12-08  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR lto/48437\n+\t* gcc.dg/lto/20111207-2_0.c: New testcase.\n+\t* gcc.dg/guality/pr48437.c: Likewise.\n+\n 2011-12-07  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/51401"}, {"sha": "5346baa0bd85a5b6335993b6b2abbbad52a54c72", "filename": "gcc/testsuite/gcc.dg/guality/pr48437.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Ftestsuite%2Fgcc.dg%2Fguality%2Fpr48437.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Ftestsuite%2Fgcc.dg%2Fguality%2Fpr48437.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fguality%2Fpr48437.c?ref=c37257a1f686bdd260a2edc445f8b3f24dceec2e", "patch": "@@ -0,0 +1,17 @@\n+/* PR lto/48437 */\n+/* { dg-do run } */\n+/* { dg-options \"-g\" } */\n+\n+#include \"../nop.h\"\n+\n+int i __attribute__((used));\n+int main()\n+{\n+  volatile int i;\n+  for (i = 3; i < 7; ++i)\n+    {\n+      extern int i;\n+      asm volatile (NOP : : : \"memory\"); /* { dg-final { gdb-test 14 \"i\" \"0\" } } */\n+    }\n+  return 0;\n+}"}, {"sha": "672db535a08fdc2a363b192b79eb08bde86c74eb", "filename": "gcc/testsuite/gcc.dg/lto/20111207-2_0.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20111207-2_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c37257a1f686bdd260a2edc445f8b3f24dceec2e/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20111207-2_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20111207-2_0.c?ref=c37257a1f686bdd260a2edc445f8b3f24dceec2e", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-lto-do run } */\n+\n+int\n+test (void)\n+{\n+  int f (void);\n+  return 0;\n+}\n+\n+int\n+main (void)\n+{\n+  int f (void);\n+  int test (void);\n+\n+  return test ();\n+}"}]}