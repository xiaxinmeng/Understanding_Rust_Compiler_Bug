{"sha": "0ae278e724b821268d715bdb7535aefef0575b1e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGFlMjc4ZTcyNGI4MjEyNjhkNzE1YmRiNzUzNWFlZmVmMDU3NWIxZQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2009-10-16T21:10:43Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2009-10-16T21:10:43Z"}, "message": "re PR fortran/41719 ([OOP] invalid: Intrinsic assignment involving polymorphic variables)\n\n2009-10-16  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/41719\n\t* resolve.c (resolve_ordinary_assign): Reject intrinsic assignments\n\tto polymorphic variables.\n\n\n2009-10-16  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/41719\n\t* gfortran.dg/class_5.f03: New test case.\n\t* gfortran.dg/typebound_operator_2.f03: Fixing invalid test case.\n\t* gfortran.dg/typebound_operator_4.f03: Ditto.\n\nFrom-SVN: r152919", "tree": {"sha": "74273dd62402ab14ae2d7cda3239f6af8f06299b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74273dd62402ab14ae2d7cda3239f6af8f06299b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ae278e724b821268d715bdb7535aefef0575b1e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ae278e724b821268d715bdb7535aefef0575b1e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ae278e724b821268d715bdb7535aefef0575b1e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ae278e724b821268d715bdb7535aefef0575b1e/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "02be8f4a8a9088e9f00717b1720b2158830c7ac1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02be8f4a8a9088e9f00717b1720b2158830c7ac1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02be8f4a8a9088e9f00717b1720b2158830c7ac1"}], "stats": {"total": 57, "additions": 54, "deletions": 3}, "files": [{"sha": "17bbc06e83342cfcc0a77d9cafd926e5d1d71cf6", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=0ae278e724b821268d715bdb7535aefef0575b1e", "patch": "@@ -1,3 +1,9 @@\n+2009-10-16  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/41719\n+\t* resolve.c (resolve_ordinary_assign): Reject intrinsic assignments\n+\tto polymorphic variables.\n+\n 2009-10-16  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/41648"}, {"sha": "d76c461d28a9b68c1761f94984fb8f2b364e3491", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=0ae278e724b821268d715bdb7535aefef0575b1e", "patch": "@@ -7629,6 +7629,14 @@ resolve_ordinary_assign (gfc_code *code, gfc_namespace *ns)\n \t}\n     }\n \n+  /* F03:7.4.1.2.  */\n+  if (lhs->ts.type == BT_CLASS)\n+    {\n+      gfc_error (\"Variable must not be polymorphic in assignment at %L\",\n+\t\t &lhs->where);\n+      return false;\n+    }\n+\n   gfc_check_assign (lhs, rhs, 1);\n   return false;\n }"}, {"sha": "ffd0d7ebb2f6dd3e6d46a61c98bf7369d7a14eb2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0ae278e724b821268d715bdb7535aefef0575b1e", "patch": "@@ -1,3 +1,10 @@\n+2009-10-16  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/41719\n+\t* gfortran.dg/class_5.f03: New test case.\n+\t* gfortran.dg/typebound_operator_2.f03: Fixing invalid test case.\n+\t* gfortran.dg/typebound_operator_4.f03: Ditto.\n+\n 2009-10-16  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* g++.dg/ipa/iinline-1.C: Use dg-add-options bind_pic_locally."}, {"sha": "087d745aec7f9911e1dbe7305c184db190a1cbec", "filename": "gcc/testsuite/gfortran.dg/class_5.f03", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_5.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_5.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_5.f03?ref=0ae278e724b821268d715bdb7535aefef0575b1e", "patch": "@@ -0,0 +1,31 @@\n+! { dg-do compile }\n+!\n+! PR 41719: [OOP] invalid: Intrinsic assignment involving polymorphic variables\n+!\n+! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n+\n+ implicit none\n+\n+ type t1\n+   integer :: a\n+ end type\n+\n+ type, extends(t1) :: t2\n+   integer :: b\n+ end type\n+\n+ class(t1),pointer :: cp\n+ type(t2) :: x\n+\n+ x = t2(45,478)\n+ allocate(t2 :: cp)\n+\n+ cp = x   ! { dg-error \"Variable must not be polymorphic\" }\n+\n+ select type (cp)\n+ type is (t2)\n+   print *, cp%a, cp%b\n+ end select\n+\n+end\n+ \n\\ No newline at end of file"}, {"sha": "b8dc5c9d1041e2b02ce68188aee2390db4a58fd0", "filename": "gcc/testsuite/gfortran.dg/typebound_operator_2.f03", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_2.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_2.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_2.f03?ref=0ae278e724b821268d715bdb7535aefef0575b1e", "patch": "@@ -50,7 +50,6 @@ END FUNCTION threearg\n   LOGICAL FUNCTION func (me, b) ! { dg-error \"must be a SUBROUTINE\" }\n     CLASS(t), INTENT(OUT) :: me\n     CLASS(t), INTENT(IN) :: b\n-    me = t ()\n     func = .TRUE.\n   END FUNCTION func\n "}, {"sha": "835ceb63ff064c98ed4b64f355765d391a70c33f", "filename": "gcc/testsuite/gfortran.dg/typebound_operator_4.f03", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_4.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ae278e724b821268d715bdb7535aefef0575b1e/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_4.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_4.f03?ref=0ae278e724b821268d715bdb7535aefef0575b1e", "patch": "@@ -37,7 +37,7 @@ END FUNCTION add_int\n   PURE SUBROUTINE assign_int (dest, from)\n     CLASS(myint), INTENT(OUT) :: dest\n     INTEGER, INTENT(IN) :: from\n-    dest = myint (from)\n+    dest%value = from\n   END SUBROUTINE assign_int\n \n   TYPE(myreal) FUNCTION add_real (a, b)\n@@ -49,7 +49,7 @@ END FUNCTION add_real\n   SUBROUTINE assign_real (dest, from)\n     CLASS(myreal), INTENT(OUT) :: dest\n     REAL, INTENT(IN) :: from\n-    dest = myreal (from)\n+    dest%value = from\n   END SUBROUTINE assign_real\n \n   SUBROUTINE in_module ()"}]}