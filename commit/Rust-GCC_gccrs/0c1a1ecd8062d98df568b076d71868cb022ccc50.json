{"sha": "0c1a1ecd8062d98df568b076d71868cb022ccc50", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGMxYTFlY2Q4MDYyZDk4ZGY1NjhiMDc2ZDcxODY4Y2IwMjJjY2M1MA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-05-28T20:17:18Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-05-28T20:17:18Z"}, "message": "re PR c++/14668 (no warning anymore for reevaluation of declaration)\n\n\tPR c++/14668\n\t* parser.c (cp_parser_simple_type_specifier): Call\n\tmaybe_note_name_used_in_class.\n\n\tPR c++/14668\n\t* g++.dg/lookup/redecl1.C: New test.\n\t* g++.old-deja/g++.benjamin/tem04.C: Add error marker.\n\nFrom-SVN: r82375", "tree": {"sha": "96235c8e5e4f1937606c4c269e1e5b18c07385af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96235c8e5e4f1937606c4c269e1e5b18c07385af"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0c1a1ecd8062d98df568b076d71868cb022ccc50", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c1a1ecd8062d98df568b076d71868cb022ccc50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0c1a1ecd8062d98df568b076d71868cb022ccc50", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c1a1ecd8062d98df568b076d71868cb022ccc50/comments", "author": null, "committer": null, "parents": [{"sha": "09b01df889135a0ba5a2dadfae952c8daaaeef8a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09b01df889135a0ba5a2dadfae952c8daaaeef8a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09b01df889135a0ba5a2dadfae952c8daaaeef8a"}], "stats": {"total": 40, "additions": 34, "deletions": 6}, "files": [{"sha": "5ba480020551ea284cf971083fcce73cc57b6218", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=0c1a1ecd8062d98df568b076d71868cb022ccc50", "patch": "@@ -1,3 +1,9 @@\n+2004-05-28  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/14668\n+\t* parser.c (cp_parser_simple_type_specifier): Call\n+\tmaybe_note_name_used_in_class.\n+\n 2004-05-28  Tom Marshall  <tmarshall@real.com>\n \n \tPR c++/15214"}, {"sha": "9ea37ef85a481779f2eab4035c25504d86ac24ed", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 14, "deletions": 5, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=0c1a1ecd8062d98df568b076d71868cb022ccc50", "patch": "@@ -8944,6 +8944,8 @@ cp_parser_simple_type_specifier (cp_parser* parser, cp_parser_flags flags,\n   /* The type-specifier must be a user-defined type.  */\n   if (!(flags & CP_PARSER_FLAGS_NO_USER_DEFINED_TYPES))\n     {\n+      bool qualified_p;\n+\n       /* Don't gobble tokens or issue error messages if this is an\n \t optional type-specifier.  */\n       if (flags & CP_PARSER_FLAGS_OPTIONAL)\n@@ -8953,11 +8955,12 @@ cp_parser_simple_type_specifier (cp_parser* parser, cp_parser_flags flags,\n       cp_parser_global_scope_opt (parser,\n \t\t\t\t  /*current_scope_valid_p=*/false);\n       /* Look for the nested-name specifier.  */\n-      cp_parser_nested_name_specifier_opt (parser,\n-\t\t\t\t\t   /*typename_keyword_p=*/false,\n-\t\t\t\t\t   /*check_dependency_p=*/true,\n-\t\t\t\t\t   /*type_p=*/false,\n-\t\t\t\t\t   /*is_declaration=*/false);\n+      qualified_p\n+\t= (cp_parser_nested_name_specifier_opt (parser,\n+\t\t\t\t\t\t/*typename_keyword_p=*/false,\n+\t\t\t\t\t\t/*check_dependency_p=*/true,\n+\t\t\t\t\t\t/*type_p=*/false,\n+\t\t\t\t\t\t/*is_declaration=*/false));\n       /* If we have seen a nested-name-specifier, and the next token\n \t is `template', then we are using the template-id production.  */\n       if (parser->scope\n@@ -8979,6 +8982,12 @@ cp_parser_simple_type_specifier (cp_parser* parser, cp_parser_flags flags,\n       /* Otherwise, look for a type-name.  */\n       else\n \ttype = cp_parser_type_name (parser);\n+      /* Keep track of all name-lookups performed in class scopes.  */\n+      if (type  \n+\t  && !qualified_p\n+\t  && TREE_CODE (type) == TYPE_DECL \n+\t  && TREE_CODE (DECL_NAME (type)) == IDENTIFIER_NODE)\n+\tmaybe_note_name_used_in_class (DECL_NAME (type), type);\n       /* If it didn't work out, we don't have a TYPE.  */\n       if ((flags & CP_PARSER_FLAGS_OPTIONAL)\n \t  && !cp_parser_parse_definitely (parser))"}, {"sha": "22afe9416049125b9b02a385d1b369c47303a089", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0c1a1ecd8062d98df568b076d71868cb022ccc50", "patch": "@@ -1,3 +1,9 @@\n+2004-05-28  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/14668\n+\t* g++.dg/lookup/redecl1.C: New test.\n+\t* g++.old-deja/g++.benjamin/tem04.C: Add error marker.\n+\n 2004-05-28  Paolo Bonzini  <bonzini@gnu.org>\n \n \t* gcc.c-torture/compare-fp-1.c, gcc.c-torture/compare-fp-2.c,"}, {"sha": "436316ca07011427a9f4b286b6c25e3bec13b7fa", "filename": "gcc/testsuite/g++.dg/lookup/redecl1.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fredecl1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fredecl1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fredecl1.C?ref=0c1a1ecd8062d98df568b076d71868cb022ccc50", "patch": "@@ -0,0 +1,7 @@\n+// PR c++/14668\n+\n+class A {}; // { dg-error \"\" }\n+class B { \n+  static A *A; // { dg-error \"\" }\n+}; \n+A *B::A = 0;"}, {"sha": "d486efbbaefed3b1c9fc8db4cfb8b59220cb30b8", "filename": "gcc/testsuite/g++.old-deja/g++.benjamin/tem04.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.benjamin%2Ftem04.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0c1a1ecd8062d98df568b076d71868cb022ccc50/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.benjamin%2Ftem04.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.benjamin%2Ftem04.C?ref=0c1a1ecd8062d98df568b076d71868cb022ccc50", "patch": "@@ -91,7 +91,7 @@ public:\n template <typename T14, template <typename T15> class C12>// { dg-error \"\" } .*\n class Xeighteen {\n protected:\n-  C12<T14> value;\n+  C12<T14> value; // { dg-error \"\" }\n   int C12; // { dg-error \"\" } .*\n };\n "}]}