{"sha": "35e3f0829d8e9cdc7ea19917c9f3a7add3f14847", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzVlM2YwODI5ZDhlOWNkYzdlYTE5OTE3YzlmM2E3YWRkM2YxNDg0Nw==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-12T13:28:05Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-14T16:26:24Z"}, "message": "analyzer: fix ICE on setjmp with non-pointer-type [PR97029]\n\ngcc/analyzer/ChangeLog:\n\tPR analyzer/97029\n\t* analyzer.cc (is_setjmp_call_p): Require the initial arg to be a\n\tpointer.\n\t* region-model.cc (region_model::deref_rvalue): Assert that the\n\tsvalue is of pointer type.\n\ngcc/testsuite/ChangeLog:\n\t* gcc.dg/analyzer/pr97029.c: New test.", "tree": {"sha": "ec301c5842cac19f59dcc340c4f431702a21c395", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ec301c5842cac19f59dcc340c4f431702a21c395"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a7d8dcdf2f3cf9a801e655f2eec3967a3a3ba666", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7d8dcdf2f3cf9a801e655f2eec3967a3a3ba666", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7d8dcdf2f3cf9a801e655f2eec3967a3a3ba666"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "82d487858dc66c68725b23b775e0025c7b12a700", "filename": "gcc/analyzer/analyzer.cc", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847/gcc%2Fanalyzer%2Fanalyzer.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847/gcc%2Fanalyzer%2Fanalyzer.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fanalyzer.cc?ref=35e3f0829d8e9cdc7ea19917c9f3a7add3f14847", "patch": "@@ -204,7 +204,9 @@ is_setjmp_call_p (const gcall *call)\n {\n   if (is_special_named_call_p (call, \"setjmp\", 1)\n       || is_special_named_call_p (call, \"sigsetjmp\", 2))\n-    return true;\n+    /* region_model::on_setjmp requires a pointer.  */\n+    if (POINTER_TYPE_P (TREE_TYPE (gimple_call_arg (call, 0))))\n+      return true;\n \n   return false;\n }"}, {"sha": "d53272e4332c283e5f978556c63ef0b0289518ce", "filename": "gcc/analyzer/region-model.cc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847/gcc%2Fanalyzer%2Fregion-model.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847/gcc%2Fanalyzer%2Fregion-model.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fregion-model.cc?ref=35e3f0829d8e9cdc7ea19917c9f3a7add3f14847", "patch": "@@ -1446,13 +1446,15 @@ region_model::region_exists_p (const region *reg) const\n \n /* Get a region for referencing PTR_SVAL, creating a region if need be, and\n    potentially generating warnings via CTXT.\n+   PTR_SVAL must be of pointer type.\n    PTR_TREE if non-NULL can be used when emitting diagnostics.  */\n \n const region *\n region_model::deref_rvalue (const svalue *ptr_sval, tree ptr_tree,\n \t\t\t    region_model_context *ctxt)\n {\n   gcc_assert (ptr_sval);\n+  gcc_assert (POINTER_TYPE_P (ptr_sval->get_type ()));\n \n   /* If we're dereferencing PTR_SVAL, assume that it is non-NULL; add this\n      as a constraint.  This suppresses false positives from"}, {"sha": "ff83ad4d56ef2f4a112c355f8c44fb7fa2439c59", "filename": "gcc/testsuite/gcc.dg/analyzer/pr97029.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr97029.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35e3f0829d8e9cdc7ea19917c9f3a7add3f14847/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr97029.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr97029.c?ref=35e3f0829d8e9cdc7ea19917c9f3a7add3f14847", "patch": "@@ -0,0 +1,7 @@\n+struct vj {};\n+\n+void\n+setjmp (struct vj pl)\n+{\n+  setjmp (pl);\n+}"}]}