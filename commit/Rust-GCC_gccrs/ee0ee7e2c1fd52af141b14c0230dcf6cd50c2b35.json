{"sha": "ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWUwZWU3ZTJjMWZkNTJhZjE0MWIxNGMwMjMwZGNmNmNkNTBjMmIzNQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-03-05T12:50:36Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-03-05T12:50:36Z"}, "message": "re PR debug/39379 (DW_TAG_imported* no longer emitted)\n\n\tPR debug/39379\n\t* tree-cfg.c (remove_useless_stmts_bind): Don't remove GIMPLE_BINDs\n\twith blocks containing IMPORTED_DECLs in BLOCK_VARS.\n\n\t* g++.dg/debug/dwarf2/imported-module-3.C: New test.\n\t* g++.dg/debug/dwarf2/imported-module-4.C: New test.\n\nFrom-SVN: r144640", "tree": {"sha": "9965c4ee4fa295755fc70e7820216ddf00608b1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9965c4ee4fa295755fc70e7820216ddf00608b1c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6c6094f12fae0fe23eb390a115645d78f82a42c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c6094f12fae0fe23eb390a115645d78f82a42c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c6094f12fae0fe23eb390a115645d78f82a42c1"}], "stats": {"total": 68, "additions": 65, "deletions": 3}, "files": [{"sha": "a0ff5c863f2a9ce953c3a68ea7ad775f2235d4f5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "patch": "@@ -1,3 +1,9 @@\n+2009-03-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/39379\n+\t* tree-cfg.c (remove_useless_stmts_bind): Don't remove GIMPLE_BINDs\n+\twith blocks containing IMPORTED_DECLs in BLOCK_VARS.\n+\n 2009-03-05  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.md (R8_REG, R9_REG): New constants."}, {"sha": "f71de1c30e9b7ad46166c611efc091642ed89407", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "patch": "@@ -1,3 +1,9 @@\n+2009-03-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/39379\n+\t* g++.dg/debug/dwarf2/imported-module-3.C: New test.\n+\t* g++.dg/debug/dwarf2/imported-module-4.C: New test.\n+\n 2009-03-04  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/13549"}, {"sha": "d62a506f49b9fd2e0f2885f6b353566dc91e60e0", "filename": "gcc/testsuite/g++.dg/debug/dwarf2/imported-module-3.C", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fimported-module-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fimported-module-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fimported-module-3.C?ref=ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "patch": "@@ -0,0 +1,17 @@\n+// PR debug/39379\n+// { dg-do compile }\n+// { dg-options \"-g -dA\" }\n+// { dg-final { scan-assembler \"DW_TAG_imported\" }  }\n+\n+namespace A\n+{\n+  int v;\n+}\n+\n+int\n+main ()\n+{\n+  using namespace A;\n+  v++;\n+  return v - 1;\n+}"}, {"sha": "6e9b52e1f193cdc0d19a99ac6d4b65581433f96b", "filename": "gcc/testsuite/g++.dg/debug/dwarf2/imported-module-4.C", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fimported-module-4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fimported-module-4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fimported-module-4.C?ref=ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "patch": "@@ -0,0 +1,21 @@\n+// PR debug/39379\n+// { dg-do compile }\n+// { dg-options \"-g -dA\" }\n+// { dg-final { scan-assembler \"DW_TAG_imported\" }  }\n+\n+namespace A\n+{\n+  int v;\n+}\n+\n+int\n+f ()\n+{\n+  int i;\n+  {\n+    using namespace A;\n+    v++;\n+    i = v - 1;\n+  }\n+  return i;\n+}"}, {"sha": "440aa93682693a91224c9e383b7df2147b2a141e", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=ee0ee7e2c1fd52af141b14c0230dcf6cd50c2b35", "patch": "@@ -1796,9 +1796,21 @@ remove_useless_stmts_bind (gimple_stmt_iterator *gsi, struct rus_data *data ATTR\n \t  || (TREE_CODE (BLOCK_ABSTRACT_ORIGIN (block))\n \t      != FUNCTION_DECL)))\n     {\n-      gsi_insert_seq_before (gsi, body_seq, GSI_SAME_STMT);\n-      gsi_remove (gsi, false);\n-      data->repeat = true;\n+      tree var = NULL_TREE;\n+      /* Even if there are no gimple_bind_vars, there might be other\n+\t decls in BLOCK_VARS rendering the GIMPLE_BIND not useless.  */\n+      if (block)\n+\tfor (var = BLOCK_VARS (block); var; var = TREE_CHAIN (var))\n+\t  if (TREE_CODE (var) == IMPORTED_DECL)\n+\t    break;\n+      if (var)\n+\tgsi_next (gsi);\n+      else\n+\t{\n+\t  gsi_insert_seq_before (gsi, body_seq, GSI_SAME_STMT);\n+\t  gsi_remove (gsi, false);\n+\t  data->repeat = true;\n+\t}\n     }\n   else\n     gsi_next (gsi);"}]}