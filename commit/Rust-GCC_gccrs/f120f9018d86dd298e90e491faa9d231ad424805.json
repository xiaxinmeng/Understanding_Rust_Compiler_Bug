{"sha": "f120f9018d86dd298e90e491faa9d231ad424805", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjEyMGY5MDE4ZDg2ZGQyOThlOTBlNDkxZmFhOWQyMzFhZDQyNDgwNQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "1999-10-24T04:08:16Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "1999-10-24T04:08:16Z"}, "message": "integrate.c (integrate_decl_tree): Tweak setting of DECL_CONTEXT for inlined declarations.\n\n\t* integrate.c (integrate_decl_tree): Tweak setting of DECL_CONTEXT\n\tfor inlined declarations.\n\nFrom-SVN: r30140", "tree": {"sha": "0e06e50fb911e6ce7c9899a592714185e2593146", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0e06e50fb911e6ce7c9899a592714185e2593146"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f120f9018d86dd298e90e491faa9d231ad424805", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f120f9018d86dd298e90e491faa9d231ad424805", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f120f9018d86dd298e90e491faa9d231ad424805", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f120f9018d86dd298e90e491faa9d231ad424805/comments", "author": null, "committer": null, "parents": [{"sha": "ea1e32f66f22ce3ffb346374c5ff7f0a06356165", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea1e32f66f22ce3ffb346374c5ff7f0a06356165", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea1e32f66f22ce3ffb346374c5ff7f0a06356165"}], "stats": {"total": 39, "additions": 22, "deletions": 17}, "files": [{"sha": "6192c8ecb260148b71d1c5fa3cb176898cabc2e1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f120f9018d86dd298e90e491faa9d231ad424805/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f120f9018d86dd298e90e491faa9d231ad424805/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f120f9018d86dd298e90e491faa9d231ad424805", "patch": "@@ -1,3 +1,8 @@\n+Sat Oct 23 21:13:00 1999  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* integrate.c (integrate_decl_tree): Tweak setting of DECL_CONTEXT\n+\tfor inlined declarations.\n+\n Fri Oct 22 18:05:43 1999  Jeffrey A Law  (law@cygnus.com)\n \n \t* arm.c (logical_binary_operator): New fucntion."}, {"sha": "6c5abe8c1bed1ec2b653a0186812b79a1e9e7718", "filename": "gcc/integrate.c", "status": "modified", "additions": 17, "deletions": 17, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f120f9018d86dd298e90e491faa9d231ad424805/gcc%2Fintegrate.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f120f9018d86dd298e90e491faa9d231ad424805/gcc%2Fintegrate.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintegrate.c?ref=f120f9018d86dd298e90e491faa9d231ad424805", "patch": "@@ -1419,23 +1419,23 @@ integrate_decl_tree (let, map)\n       if (DECL_LANG_SPECIFIC (d))\n \tcopy_lang_decl (d);\n \n-      /* ??? We used to call pushdecl here, but that does not work now that\n-\t we generate entire functions as trees.  We only want the pushdecl\n-\t code that sets DECL_CONTEXT.  Each front end sets DECL_CONTEXT\n-\t slightly differently though, so we may need new callbacks to the\n-\t front-ends to do this right.  For now, we just use the code from the\n-\t C front end and hope that is sufficient.  Alternatively, we could\n-\t set DECL_CONTEXT (d) here only if DECL_CONTEXT (t) is non-null.  */\n-      /* This new declaration is now in the scope of the function into\n-\t which we are inlining the function, not the function being\n-\t inlined.  */\n-      DECL_CONTEXT (d) = current_function_decl;\n-      /* A local extern declaration for a function doesn't constitute nesting.\n-\t A local auto declaration does, since it's a forward decl\n-\t for a nested function coming later.  */\n-      if (TREE_CODE (d) == FUNCTION_DECL && DECL_INITIAL (d) == 0\n-\t  && DECL_EXTERNAL (d))\n-\tDECL_CONTEXT (d) = 0;\n+      /* Set the context for the new declaration.  */\n+      if (!DECL_CONTEXT (t))\n+\t/* Globals stay global.  */\n+\t;\n+      else if (DECL_CONTEXT (t) != map->fndecl)\n+\t/* Things that weren't in the scope of the function we're\n+\t   inlining from aren't in the scope we're inlining too,\n+\t   either.  */\n+\t;\n+      else if (TREE_STATIC (t))\n+\t/* Function-scoped static variables should say in the original\n+\t   function.  */\n+\t;\n+      else\n+\t/* Ordinary automatic local variables are now in the scope of\n+\t   the new function.  */\n+\tDECL_CONTEXT (d) = current_function_decl;\n \n       /* Add this declaration to the list of variables in the new\n \t block.  */"}]}