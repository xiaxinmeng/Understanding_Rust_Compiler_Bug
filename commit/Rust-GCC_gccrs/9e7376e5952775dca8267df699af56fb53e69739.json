{"sha": "9e7376e5952775dca8267df699af56fb53e69739", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWU3Mzc2ZTU5NTI3NzVkY2E4MjY3ZGY2OTlhZjU2ZmI1M2U2OTczOQ==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "dvorakz@suse.cz", "date": "2005-02-25T12:07:11Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2005-02-25T12:07:11Z"}, "message": "re PR tree-optimization/19937 (Wrong loop exit (causes binutils to fail))\n\n\tPR tree-optimization/19937\n\t* tree-ssa-loop-ivopts.c (rewrite_use_compare): Cast the final value\n\tto the type of the induction variable.\n\nFrom-SVN: r95535", "tree": {"sha": "f8ee603bfd3418fc02fdb4850b03ae8255571708", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f8ee603bfd3418fc02fdb4850b03ae8255571708"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9e7376e5952775dca8267df699af56fb53e69739", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e7376e5952775dca8267df699af56fb53e69739", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9e7376e5952775dca8267df699af56fb53e69739", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e7376e5952775dca8267df699af56fb53e69739/comments", "author": null, "committer": null, "parents": [{"sha": "bd182be84e9c8ae8485ac7c392fa0b6678969e3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd182be84e9c8ae8485ac7c392fa0b6678969e3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd182be84e9c8ae8485ac7c392fa0b6678969e3c"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "ef164be76618902bbe8f2e6cb4889364f40c8c5b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9e7376e5952775dca8267df699af56fb53e69739/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9e7376e5952775dca8267df699af56fb53e69739/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9e7376e5952775dca8267df699af56fb53e69739", "patch": "@@ -1,3 +1,9 @@\n+2005-02-25  Zdenek Dvorak  <dvorakz@suse.cz>\n+\n+\tPR tree-optimization/19937\n+\t* tree-ssa-loop-ivopts.c (rewrite_use_compare): Cast the final value\n+\tto the type of the induction variable.\n+\n 2005-02-25  Kaz Kojima  <kkojima@gcc.gnu.org>\n \n \tPR rtl-optimization/20117"}, {"sha": "b1636a7ffe998486e53125da37c06b2aa90a050d", "filename": "gcc/tree-ssa-loop-ivopts.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9e7376e5952775dca8267df699af56fb53e69739/gcc%2Ftree-ssa-loop-ivopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9e7376e5952775dca8267df699af56fb53e69739/gcc%2Ftree-ssa-loop-ivopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivopts.c?ref=9e7376e5952775dca8267df699af56fb53e69739", "patch": "@@ -4878,15 +4878,17 @@ rewrite_use_compare (struct ivopts_data *data,\n   \n   if (may_eliminate_iv (data, use, cand, &compare, &bound))\n     {\n+      tree var = var_at_stmt (data->current_loop, cand, use->stmt);\n+      tree var_type = TREE_TYPE (var);\n+\n+      bound = fold_convert (var_type, bound);\n       op = force_gimple_operand (unshare_expr (bound), &stmts,\n \t\t\t\t true, NULL_TREE);\n \n       if (stmts)\n \tbsi_insert_before (&bsi, stmts, BSI_SAME_STMT);\n \n-      *use->op_p = build2 (compare, boolean_type_node,\n-\t\t\t  var_at_stmt (data->current_loop,\n-\t\t\t\t       cand, use->stmt), op);\n+      *use->op_p = build2 (compare, boolean_type_node, var, op);\n       modify_stmt (use->stmt);\n       return;\n     }"}]}