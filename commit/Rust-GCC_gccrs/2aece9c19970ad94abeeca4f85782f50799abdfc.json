{"sha": "2aece9c19970ad94abeeca4f85782f50799abdfc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmFlY2U5YzE5OTcwYWQ5NGFiZWVjYTRmODU3ODJmNTA3OTlhYmRmYw==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-05-23T22:33:36Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-05-23T22:33:36Z"}, "message": "re PR target/78849 (ICE on initialization of global struct containing __int20 array at varasm.c:4968)\n\n\tPR target/78849\n\t* gcc/tree.c (build_common_tree_nodes): Dont set TYPE_SIZE for __intN\n\ttypes.\n\n\tPR target/78849\n\t* gcc.target/msp430/msp430.exp: Remove -pedantic-errors from\n\tDEFAULT_CFLAGS.\n\t* gcc.target/msp430/pr78849.c: New test.\n\nFrom-SVN: r260627", "tree": {"sha": "d012c1b4f1887cf875de320555ee7c20d52bdda6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d012c1b4f1887cf875de320555ee7c20d52bdda6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2aece9c19970ad94abeeca4f85782f50799abdfc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2aece9c19970ad94abeeca4f85782f50799abdfc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2aece9c19970ad94abeeca4f85782f50799abdfc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2aece9c19970ad94abeeca4f85782f50799abdfc/comments", "author": null, "committer": null, "parents": [{"sha": "54fd159056765b65191e7685673133f34786b76c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54fd159056765b65191e7685673133f34786b76c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54fd159056765b65191e7685673133f34786b76c"}], "stats": {"total": 80, "additions": 73, "deletions": 7}, "files": [{"sha": "df282da361525ad9f031ddc3b8e6c01ce06829f2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2aece9c19970ad94abeeca4f85782f50799abdfc", "patch": "@@ -1,4 +1,10 @@\n-2017-05-23  Segher Boessenkool  <segher@kernel.crashing.org>\n+2018-05-23  Jozef Lawrynowicz  <jozef.l@somniumtech.com>\n+\n+\tPR target/78849\n+\t* gcc/tree.c (build_common_tree_nodes): Dont set TYPE_SIZE for __intN\n+\ttypes.\n+\n+2018-05-23  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* doc/sourcebuild.texi (Endianness): New subsubsection.\n "}, {"sha": "fb4c74e02446ac0fd81060b7fb11c0c8a5a88614", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2aece9c19970ad94abeeca4f85782f50799abdfc", "patch": "@@ -1,3 +1,10 @@\n+2018-05-23  Jozef Lawrynowicz  <jozef.l@somniumtech.com>\n+\n+\tPR target/78849\n+\t* gcc.target/msp430/msp430.exp: Remove -pedantic-errors from\n+\tDEFAULT_CFLAGS.\n+\t* gcc.target/msp430/pr78849.c: New test.\n+\n 2018-05-23  Marek Polacek  <polacek@redhat.com>\n \n \t* g++.dg/cpp2a/range-for8.C: New test."}, {"sha": "0bd42c24f2b9c743ad96b4fdfa8fb6a90447dc31", "filename": "gcc/testsuite/gcc.target/msp430/msp430.exp", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftestsuite%2Fgcc.target%2Fmsp430%2Fmsp430.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftestsuite%2Fgcc.target%2Fmsp430%2Fmsp430.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmsp430%2Fmsp430.exp?ref=2aece9c19970ad94abeeca4f85782f50799abdfc", "patch": "@@ -24,18 +24,23 @@ if { ![istarget msp430-*-*] } then {\n # Load support procs.\n load_lib gcc-dg.exp\n \n-# If a testcase doesn't have special options, use these.\n+# The '-pedantic-errors' option in the global variable DEFAULT_CFLAGS that is\n+# set by other drivers causes an error when the __int20 type is used, so remove\n+# this option from DEFAULT_CFLAGS for the msp430 tests.\n global DEFAULT_CFLAGS\n-if ![info exists DEFAULT_CFLAGS] then {\n-    set DEFAULT_CFLAGS \"\"\n+if [info exists DEFAULT_CFLAGS] then {\n+    set MSP430_DEFAULT_CFLAGS \\\n+      [ string map { \"-pedantic-errors\" \"\" } $DEFAULT_CFLAGS ]\n+} else {\n+   set MSP430_DEFAULT_CFLAGS \"\"\n }\n \n # Initialize `dg'.\n dg-init\n \n # Main loop.\n dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/*.\\[cCS\\]]] \\\n-\t\"\" $DEFAULT_CFLAGS\n+\t\"\" $MSP430_DEFAULT_CFLAGS\n \n # All done.\n dg-finish"}, {"sha": "f70f0bbf5f771495ef0479c49d331b95c5243cb1", "filename": "gcc/testsuite/gcc.target/msp430/pr78849.c", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftestsuite%2Fgcc.target%2Fmsp430%2Fpr78849.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftestsuite%2Fgcc.target%2Fmsp430%2Fpr78849.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmsp430%2Fpr78849.c?ref=2aece9c19970ad94abeeca4f85782f50799abdfc", "patch": "@@ -0,0 +1,50 @@\n+/* { dg-do compile } */\n+/* { dg-final { scan-assembler \".size.*instance.*52\" } } */\n+\n+struct t_inner\n+{\n+  __int20 a;\n+  char val1;\n+  __int20 b[3];\n+  char val2;\n+};\n+\n+struct t_full\n+{\n+  __int20 array[2];\n+  char val1;\n+  struct t_inner bb[2];\n+  char val2;\n+};\n+\n+struct t_full instance =\n+{\n+    {\n+      4231,\n+      3212,\n+    },\n+    5,\n+    {\n+        {\n+          87680,\n+\t  20,\n+          {\n+            2534,\n+            3,\n+            41,\n+          },\n+\t  55,\n+        },\n+        {\n+          567,\n+\t  4,\n+          {\n+            43522,\n+            5433,\n+            454,\n+          },\n+\t  88,\n+        },\n+    },\n+    8,\n+};"}, {"sha": "e8dc42557d0b13ea3411ae0f9976b11d573fbef6", "filename": "gcc/tree.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2aece9c19970ad94abeeca4f85782f50799abdfc/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=2aece9c19970ad94abeeca4f85782f50799abdfc", "patch": "@@ -9785,8 +9785,6 @@ build_common_tree_nodes (bool signed_char)\n     {\n       int_n_trees[i].signed_type = make_signed_type (int_n_data[i].bitsize);\n       int_n_trees[i].unsigned_type = make_unsigned_type (int_n_data[i].bitsize);\n-      TYPE_SIZE (int_n_trees[i].signed_type) = bitsize_int (int_n_data[i].bitsize);\n-      TYPE_SIZE (int_n_trees[i].unsigned_type) = bitsize_int (int_n_data[i].bitsize);\n \n       if (int_n_data[i].bitsize > LONG_LONG_TYPE_SIZE\n \t  && int_n_enabled_p[i])"}]}