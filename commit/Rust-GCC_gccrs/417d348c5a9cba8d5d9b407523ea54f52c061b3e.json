{"sha": "417d348c5a9cba8d5d9b407523ea54f52c061b3e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDE3ZDM0OGM1YTljYmE4ZDVkOWI0MDc1MjNlYTU0ZjUyYzA2MWIzZQ==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1999-10-20T22:19:06Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1999-10-20T22:19:06Z"}, "message": "Fix numerous -O3 -g testsuite failures for DWARF2 targets.\n\n\t* integrate.c (integrate_decl_tree): Set DECL_CONTEXT to 0 if this is\n\ta local extern function declaration.\n\nFrom-SVN: r30107", "tree": {"sha": "c329b1b6f7eb3b47edbbd06db5f5be40e11fea38", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c329b1b6f7eb3b47edbbd06db5f5be40e11fea38"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/417d348c5a9cba8d5d9b407523ea54f52c061b3e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/417d348c5a9cba8d5d9b407523ea54f52c061b3e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/417d348c5a9cba8d5d9b407523ea54f52c061b3e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/417d348c5a9cba8d5d9b407523ea54f52c061b3e/comments", "author": null, "committer": null, "parents": [{"sha": "276ab4a49cabf93897caa27ada91672c1f0ffff1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/276ab4a49cabf93897caa27ada91672c1f0ffff1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/276ab4a49cabf93897caa27ada91672c1f0ffff1"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "998c4671edfaacee2fcb463cea89b88b3b5e1932", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/417d348c5a9cba8d5d9b407523ea54f52c061b3e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/417d348c5a9cba8d5d9b407523ea54f52c061b3e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=417d348c5a9cba8d5d9b407523ea54f52c061b3e", "patch": "@@ -1,3 +1,8 @@\n+Wed Oct 20 15:18:42 1999  Jim Wilson  <wilson@cygnus.com>\n+\n+\t* integrate.c (integrate_decl_tree): Set DECL_CONTEXT to 0 if this is\n+\ta local extern function declaration.\n+\n Wed Oct 20 13:56:01 1999  Richard Henderson  <rth@cygnus.com>\n \n \t* i386.c (ix86_expand_prologue): Properly wrap USE around"}, {"sha": "e312b18853175df1fe4ff99164d516c905b5a748", "filename": "gcc/integrate.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/417d348c5a9cba8d5d9b407523ea54f52c061b3e/gcc%2Fintegrate.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/417d348c5a9cba8d5d9b407523ea54f52c061b3e/gcc%2Fintegrate.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintegrate.c?ref=417d348c5a9cba8d5d9b407523ea54f52c061b3e", "patch": "@@ -1419,10 +1419,23 @@ integrate_decl_tree (let, map)\n       if (DECL_LANG_SPECIFIC (d))\n \tcopy_lang_decl (d);\n \n+      /* ??? We used to call pushdecl here, but that does not work now that\n+\t we generate entire functions as trees.  We only want the pushdecl\n+\t code that sets DECL_CONTEXT.  Each front end sets DECL_CONTEXT\n+\t slightly differently though, so we may need new callbacks to the\n+\t front-ends to do this right.  For now, we just use the code from the\n+\t C front end and hope that is sufficient.  Alternatively, we could\n+\t set DECL_CONTEXT (d) here only if DECL_CONTEXT (t) is non-null.  */\n       /* This new declaration is now in the scope of the function into\n \t which we are inlining the function, not the function being\n \t inlined.  */\n       DECL_CONTEXT (d) = current_function_decl;\n+      /* A local extern declaration for a function doesn't constitute nesting.\n+\t A local auto declaration does, since it's a forward decl\n+\t for a nested function coming later.  */\n+      if (TREE_CODE (d) == FUNCTION_DECL && DECL_INITIAL (d) == 0\n+\t  && DECL_EXTERNAL (d))\n+\tDECL_CONTEXT (d) = 0;\n \n       /* Add this declaration to the list of variables in the new\n \t block.  */"}]}