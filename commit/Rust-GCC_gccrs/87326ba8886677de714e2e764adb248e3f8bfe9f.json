{"sha": "87326ba8886677de714e2e764adb248e3f8bfe9f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODczMjZiYTg4ODY2NzdkZTcxNGUyZTc2NGFkYjI0OGUzZjhiZmU5Zg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2001-06-14T10:48:20Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2001-06-14T10:48:20Z"}, "message": "class.c (dfs_accumulate_vtbl_inits): For case 2 & 3...\n\ncp:\n\t* class.c (dfs_accumulate_vtbl_inits): For case 2 & 3, make sure\n\twe've not emerged from the hierarchy of RTTI_BINFO on reaching\n\ta non-virtual base.\ntestsuite:\n\t* g++.old-deja/g++.abi/vbase8-9.C: New test.\n\nFrom-SVN: r43368", "tree": {"sha": "322737c6515bacad42496cb0c3a64e2f9e772372", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/322737c6515bacad42496cb0c3a64e2f9e772372"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/87326ba8886677de714e2e764adb248e3f8bfe9f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87326ba8886677de714e2e764adb248e3f8bfe9f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87326ba8886677de714e2e764adb248e3f8bfe9f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87326ba8886677de714e2e764adb248e3f8bfe9f/comments", "author": null, "committer": null, "parents": [{"sha": "c6036a37872de176b7d02fa9926bceb1ba0c28d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6036a37872de176b7d02fa9926bceb1ba0c28d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c6036a37872de176b7d02fa9926bceb1ba0c28d7"}], "stats": {"total": 110, "additions": 107, "deletions": 3}, "files": [{"sha": "f02f7fa8cedf1a360665b07279706b5adb47e66c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=87326ba8886677de714e2e764adb248e3f8bfe9f", "patch": "@@ -1,3 +1,9 @@\n+2001-06-14  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* class.c (dfs_accumulate_vtbl_inits): For case 2 & 3, make sure\n+\twe've not emerged from the hierarchy of RTTI_BINFO on reaching\n+\ta non-virtual base.\n+\n 2001-06-13  Mark Mitchell  <mark@codesourcery.com>\n \n \t* NEWS: Update release number."}, {"sha": "1fbf8d04e688745f1bac1294e75930ecb2b1b5ad", "filename": "gcc/cp/class.c", "status": "modified", "additions": 21, "deletions": 3, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=87326ba8886677de714e2e764adb248e3f8bfe9f", "patch": "@@ -7564,7 +7564,7 @@ accumulate_vtbl_inits (binfo, orig_binfo, rtti_binfo, t, inits)\n \t\t\t\t   BINFO_TYPE (orig_binfo)),\n \t\t      20000517);\n \n-  /* If it doesn't have a vpte, we don't do anything. */\n+  /* If it doesn't have a vptr, we don't do anything. */\n   if (!TYPE_CONTAINS_VPTR_P (BINFO_TYPE (binfo)))\n     return;\n   \n@@ -7675,14 +7675,32 @@ dfs_accumulate_vtbl_inits (binfo, orig_binfo, rtti_binfo, t, l)\n \t         still be primary to something within a lost primary\n \t         virtual base of RTTI_BINFO.  */\n \t      tree b;\n-\t      tree last, orig_last;\n+\t      tree last = binfo;\n+\t      tree orig_last = orig_binfo;\n \n \t      /* First, look through the bases we are primary to for a\n \t     \t virtual base.  */\n-\t      for (b = BINFO_PRIMARY_BASE_OF (binfo), orig_last = orig_binfo;\n+\t      for (b = BINFO_PRIMARY_BASE_OF (binfo);\n \t\t   b;\n \t\t   b = BINFO_PRIMARY_BASE_OF (b))\n \t\t{\n+\t\t  if (!TREE_VIA_VIRTUAL (b))\n+\t\t    {\n+\t\t      /* See if B is still within the hierarchy starting\n+\t\t\t at RTTI_BINFO. */\n+\t\t      tree probe;\n+\n+\t\t      for (probe = b; probe;\n+\t\t\t   probe = BINFO_INHERITANCE_CHAIN (probe))\n+\t\t\tif (probe == rtti_binfo)\n+\t\t\t  break;\n+\t\t      if (!probe)\n+\t\t\t{\n+\t\t\t  b = NULL_TREE;\n+\t\t\t  break;\n+\t\t\t}\n+\t\t    }\n+\t\t  \n \t\t  last = b;\n \t\t  if (orig_last)\n \t\t    orig_last = BINFO_PRIMARY_BASE_OF (orig_last);"}, {"sha": "8a767a52f3a62104b84aee8f5362f7a6d3105491", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=87326ba8886677de714e2e764adb248e3f8bfe9f", "patch": "@@ -1,3 +1,7 @@\n+2001-06-14  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.old-deja/g++.abi/vbase8-9.C: New test.\n+\n 2001-06-13  Franz Sirl  <Franz.Sirl-kernel@lauterbach.com>\n \n \t* lib/objc.exp (objc_target_compile): Add ${rootme} to ld_library_path"}, {"sha": "43bd86a968c8a70cfb7ec1527e96c181fae0af05", "filename": "gcc/testsuite/g++.old-deja/g++.abi/vbase8-9.C", "status": "added", "additions": 76, "deletions": 0, "changes": 76, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.abi%2Fvbase8-9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87326ba8886677de714e2e764adb248e3f8bfe9f/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.abi%2Fvbase8-9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.abi%2Fvbase8-9.C?ref=87326ba8886677de714e2e764adb248e3f8bfe9f", "patch": "@@ -0,0 +1,76 @@\n+// Special g++ Options: -ansi -pedantic-errors -w\n+\n+// Copyright (C) 2001 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 14 Jun 2001 <nathan@codesourcery.com>\n+\n+// Bug 3145, generated by script provided by stefan@space.twc.de\n+// This is case number 9\n+\n+class C0\n+{};\n+class C1\n+ :  public C0\n+{};\n+class C2\n+ :  public C1\n+ ,  public C0\n+{};\n+class C3\n+ :  virtual public C0\n+ ,  public C2\n+ ,  virtual public C1\n+{};\n+class C4\n+ :  virtual public C2\n+ ,  public C0\n+ ,  virtual public C3\n+ ,  public C1\n+{};\n+class C5\n+ :  public C0\n+ ,  public C1\n+ ,  public C4\n+ ,  virtual public C2\n+ ,  public C3\n+{};\n+class C6\n+ :  public C1\n+ ,  public C3\n+ ,  virtual public C5\n+ ,  virtual public C2\n+ ,  public C0\n+ ,  virtual public C4\n+{};\n+class C7\n+ :  virtual public C1\n+ ,  virtual public C0\n+ ,  public C6\n+ ,  virtual public C2\n+ ,  public C5\n+{};\n+class C8\n+ :  virtual public C1\n+ ,  virtual public C4\n+ ,  public C0\n+ ,  virtual public C7\n+ ,  virtual public C2\n+{};\n+class C9\n+ :  virtual public C1\n+ ,  virtual public C6\n+ ,  public C8\n+ ,  virtual public C2\n+ ,  public C0\n+{};\n+int main() {\n+  C0 c0;\n+  C1 c1;\n+  C2 c2;\n+  C3 c3;\n+  C4 c4;\n+  C5 c5;\n+  C6 c6;\n+  C7 c7;\n+  C8 c8;\n+  C9 c9;\n+}"}]}