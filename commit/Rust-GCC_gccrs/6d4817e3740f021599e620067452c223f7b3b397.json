{"sha": "6d4817e3740f021599e620067452c223f7b3b397", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQ0ODE3ZTM3NDBmMDIxNTk5ZTYyMDA2NzQ1MmMyMjNmN2IzYjM5Nw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2007-03-12T15:59:06Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2007-03-12T15:59:06Z"}, "message": "cppdefault.c (cpp_EXEC_PREFIX): New variable.\n\n\t* cppdefault.c (cpp_EXEC_PREFIX): New variable.\n\t* cppdefault.h (cpp_PREFIX): Document.\n\t(cpp_PREFIX_len): Likewise.\n\t(cpp_EXEC_PREFIX): New variable.\n\t* Makefile.in (PREPROCESSOR_DEFINES): Add STANDARD_EXEC_PREFIX.\n\t* c-incpath.c (add_standard_paths): Correct logic for relocating\n\tpaths within prefix.\n\nFrom-SVN: r122843", "tree": {"sha": "b1c057375072b5526bd29466adc19cb4108c1305", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1c057375072b5526bd29466adc19cb4108c1305"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d4817e3740f021599e620067452c223f7b3b397", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d4817e3740f021599e620067452c223f7b3b397", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d4817e3740f021599e620067452c223f7b3b397", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d4817e3740f021599e620067452c223f7b3b397/comments", "author": null, "committer": null, "parents": [{"sha": "91b0b94a042721a2a8dff04f0a177a37c4f08cad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91b0b94a042721a2a8dff04f0a177a37c4f08cad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/91b0b94a042721a2a8dff04f0a177a37c4f08cad"}], "stats": {"total": 45, "additions": 40, "deletions": 5}, "files": [{"sha": "de0dd70eb1468559c49fedc5cc55093c40211d06", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4817e3740f021599e620067452c223f7b3b397/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4817e3740f021599e620067452c223f7b3b397/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6d4817e3740f021599e620067452c223f7b3b397", "patch": "@@ -1,3 +1,13 @@\n+2007-03-12  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* cppdefault.c (cpp_EXEC_PREFIX): New variable.\n+\t* cppdefault.h (cpp_PREFIX): Document.\n+\t(cpp_PREFIX_len): Likewise.\n+\t(cpp_EXEC_PREFIX): New variable.\n+\t* Makefile.in (PREPROCESSOR_DEFINES): Add STANDARD_EXEC_PREFIX.\n+\t* c-incpath.c (add_standard_paths): Correct logic for relocating\n+\tpaths within prefix.\n+\n 2007-03-12  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.md (fixuns_trunc<mode>hi2): Implement from"}, {"sha": "6d3fe12e0d7253bb73ff4648d4722a97a5cb1579", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4817e3740f021599e620067452c223f7b3b397/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4817e3740f021599e620067452c223f7b3b397/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=6d4817e3740f021599e620067452c223f7b3b397", "patch": "@@ -3210,6 +3210,7 @@ PREPROCESSOR_DEFINES = \\\n   -DCROSS_INCLUDE_DIR=\\\"$(CROSS_SYSTEM_HEADER_DIR)\\\" \\\n   -DTOOL_INCLUDE_DIR=\\\"$(gcc_tooldir)/include\\\" \\\n   -DPREFIX=\\\"$(prefix)\\\" \\\n+  -DSTANDARD_EXEC_PREFIX=\\\"$(libdir)/gcc\\\" \\\n   @TARGET_SYSTEM_ROOT_DEFINE@\n \n cppdefault.o: cppdefault.c $(CONFIG_H) $(SYSTEM_H) coretypes.h $(TM_H) \\"}, {"sha": "3a9585bd26de23edf8778804a9bbe61e71a1d4f5", "filename": "gcc/c-incpath.c", "status": "modified", "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4817e3740f021599e620067452c223f7b3b397/gcc%2Fc-incpath.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4817e3740f021599e620067452c223f7b3b397/gcc%2Fc-incpath.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-incpath.c?ref=6d4817e3740f021599e620067452c223f7b3b397", "patch": "@@ -167,11 +167,26 @@ add_standard_paths (const char *sysroot, const char *iprefix,\n \t  else if (!p->add_sysroot && relocated\n \t\t   && strncmp (p->fname, cpp_PREFIX, cpp_PREFIX_len) == 0)\n \t    {\n-\t      /* If the compiler is relocated, and this is a configured \n-\t\t prefix relative path, then we use gcc_exec_prefix instead \n-\t\t of the configured prefix.  */\n-\t      str = concat (gcc_exec_prefix, p->fname\n-\t\t\t      + cpp_PREFIX_len, NULL);\n+ \t      static const char *relocated_prefix;\n+\t      /* If this path starts with the configure-time prefix, \n+\t\t but the compiler has been relocated, replace it \n+\t\t with the run-time prefix.  The run-time exec prefix\n+\t\t is GCC_EXEC_PREFIX.  Compute the path from there back\n+\t\t to the toplevel prefix.  */\n+\t      if (!relocated_prefix)\n+\t\t{\n+\t\t  char *dummy;\n+\t\t  /* Make relative prefix expects the first argument\n+\t\t     to be a program, not a directory.  */\n+\t\t  dummy = concat (gcc_exec_prefix, \"dummy\", NULL);\n+\t\t  relocated_prefix \n+\t\t    = make_relative_prefix (dummy,\n+\t\t\t\t\t    cpp_EXEC_PREFIX,\n+\t\t\t\t\t    cpp_PREFIX);\n+\t\t}\n+\t      str = concat (relocated_prefix,\n+\t\t\t    p->fname + cpp_PREFIX_len, \n+\t\t\t    NULL);\n \t      str = update_path (str, p->component);\n \t    }\n \t  else"}, {"sha": "3e60841980f202e3257260346858dcf1a3efb432", "filename": "gcc/cppdefault.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4817e3740f021599e620067452c223f7b3b397/gcc%2Fcppdefault.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4817e3740f021599e620067452c223f7b3b397/gcc%2Fcppdefault.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppdefault.c?ref=6d4817e3740f021599e620067452c223f7b3b397", "patch": "@@ -112,6 +112,7 @@ const size_t cpp_GCC_INCLUDE_DIR_len = 0;\n /* The configured prefix.  */\n const char cpp_PREFIX[] = PREFIX;\n const size_t cpp_PREFIX_len = sizeof PREFIX - 1;\n+const char cpp_EXEC_PREFIX[] = STANDARD_EXEC_PREFIX;\n \n /* This value is set by cpp_relocated at runtime */\n const char *gcc_exec_prefix;"}, {"sha": "398cc857424118f981536ac3b790162e9b1f3606", "filename": "gcc/cppdefault.h", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4817e3740f021599e620067452c223f7b3b397/gcc%2Fcppdefault.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4817e3740f021599e620067452c223f7b3b397/gcc%2Fcppdefault.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppdefault.h?ref=6d4817e3740f021599e620067452c223f7b3b397", "patch": "@@ -52,8 +52,16 @@ extern const struct default_include cpp_include_defaults[];\n extern const char cpp_GCC_INCLUDE_DIR[];\n extern const size_t cpp_GCC_INCLUDE_DIR_len;\n \n+/* The configure-time prefix, i.e., the value supplied as the argument\n+   to --prefix=.  */\n extern const char cpp_PREFIX[];\n+/* The length of the configure-time prefix.  */\n extern const size_t cpp_PREFIX_len;\n+/* The configure-time execution prefix.  This is typically the lib/gcc\n+   subdirectory of cpp_PREFIX.  */\n+extern const char cpp_EXEC_PREFIX[];\n+/* The run-time execution prefix.  This is typically the lib/gcc\n+   subdirectory of the actual installation.  */\n extern const char *gcc_exec_prefix;\n \n /* Return true if the toolchain is relocated.  */"}]}