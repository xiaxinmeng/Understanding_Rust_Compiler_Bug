{"sha": "ad6ed77efd770405e0c861a7819ba4e3f9a9f756", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWQ2ZWQ3N2VmZDc3MDQwNWUwYzg2MWE3ODE5YmE0ZTNmOWE5Zjc1Ng==", "commit": {"author": {"name": "Jon Grimm", "email": "jgrimm2@us.ibm.com", "date": "2005-12-06T23:13:15Z"}, "committer": {"name": "Ben Elliston", "email": "bje@gcc.gnu.org", "date": "2005-12-06T23:13:15Z"}, "message": "cpplib.h (CPP_N_DFLOAT): New.\n\n\t* include/cpplib.h (CPP_N_DFLOAT): New.\n\t* expr.c (interpret_float_suffix): Identify df, dd, and dl\n\tsuffixes as decimal floating point constants.\n\t(cpp_classify_number): Disallow hexadecimal DFP constants.\n\nCo-Authored-By: Ben Elliston <bje@au.ibm.com>\n\nFrom-SVN: r108133", "tree": {"sha": "26d2e8e0bea6ee9e502a1040ff11525cbbc867b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26d2e8e0bea6ee9e502a1040ff11525cbbc867b7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad6ed77efd770405e0c861a7819ba4e3f9a9f756", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad6ed77efd770405e0c861a7819ba4e3f9a9f756", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad6ed77efd770405e0c861a7819ba4e3f9a9f756", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad6ed77efd770405e0c861a7819ba4e3f9a9f756/comments", "author": null, "committer": null, "parents": [{"sha": "2b948876d87065efd5c0aeabe828a586b9454cbd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b948876d87065efd5c0aeabe828a586b9454cbd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b948876d87065efd5c0aeabe828a586b9454cbd"}], "stats": {"total": 33, "additions": 31, "deletions": 2}, "files": [{"sha": "d96b55f07a6d116e29fa7f9147de00a19832ecd4", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad6ed77efd770405e0c861a7819ba4e3f9a9f756/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad6ed77efd770405e0c861a7819ba4e3f9a9f756/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=ad6ed77efd770405e0c861a7819ba4e3f9a9f756", "patch": "@@ -1,3 +1,11 @@\n+2005-12-07  Jon Grimm  <jgrimm2@us.ibm.com>\n+\t    Ben Elliston  <bje@au.ibm.com>\n+\n+\t* include/cpplib.h (CPP_N_DFLOAT): New.\n+\t* expr.c (interpret_float_suffix): Identify df, dd, and dl\n+\tsuffixes as decimal floating point constants.\n+\t(cpp_classify_number): Disallow hexadecimal DFP constants.\n+\n 2005-11-14  Gerald Pfeifer  <gerald@pfeifer.com>\n             Ian Lance Taylor  <ian@airs.com>\n "}, {"sha": "a61ff665ec0fa13dbd5556930317b380ab212b1c", "filename": "libcpp/expr.c", "status": "modified", "additions": 22, "deletions": 2, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad6ed77efd770405e0c861a7819ba4e3f9a9f756/libcpp%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad6ed77efd770405e0c861a7819ba4e3f9a9f756/libcpp%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fexpr.c?ref=ad6ed77efd770405e0c861a7819ba4e3f9a9f756", "patch": "@@ -82,7 +82,7 @@ static void check_promotion (cpp_reader *, const struct op *);\n static unsigned int\n interpret_float_suffix (const uchar *s, size_t len)\n {\n-  size_t f = 0, l = 0, i = 0;\n+  size_t f = 0, l = 0, i = 0, d = 0;\n \n   while (len--)\n     switch (s[len])\n@@ -91,16 +91,27 @@ interpret_float_suffix (const uchar *s, size_t len)\n       case 'l': case 'L': l++; break;\n       case 'i': case 'I':\n       case 'j': case 'J': i++; break;\n+      case 'd': case 'D': \n+\t/* Disallow fd, ld suffixes.  */\n+\tif (d && (f || l))\n+\t  return 0;\n+\td++;\n+\tbreak;\n       default:\n \treturn 0;\n       }\n \n   if (f + l > 1 || i > 1)\n     return 0;\n \n+  /* Allow dd, df, dl suffixes for decimal float constants.  */\n+  if (d && ((d + f + l != 2) || i))\n+    return 0;\n+\n   return ((i ? CPP_N_IMAGINARY : 0)\n \t  | (f ? CPP_N_SMALL :\n-\t     l ? CPP_N_LARGE : CPP_N_MEDIUM));\n+\t     l ? CPP_N_LARGE : CPP_N_MEDIUM)\n+\t  | (d ? CPP_N_DFLOAT : 0));\n }\n \n /* Subroutine of cpp_classify_number.  S points to an integer suffix\n@@ -250,6 +261,15 @@ cpp_classify_number (cpp_reader *pfile, const cpp_token *token)\n \t\t   \"traditional C rejects the \\\"%.*s\\\" suffix\",\n \t\t   (int) (limit - str), str);\n \n+      /* Radix must be 10 for decimal floats.  */\n+      if ((result & CPP_N_DFLOAT) && radix != 10)\n+        {\n+          cpp_error (pfile, CPP_DL_ERROR,\n+                     \"invalid suffix \\\"%.*s\\\" with hexadecimal floating constant\",\n+                     (int) (limit - str), str);\n+          return CPP_N_INVALID;\n+        }\n+\n       result |= CPP_N_FLOATING;\n     }\n   else"}, {"sha": "b5bece5e5d60bc9789de3b2222e5c1c777868a3b", "filename": "libcpp/include/cpplib.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad6ed77efd770405e0c861a7819ba4e3f9a9f756/libcpp%2Finclude%2Fcpplib.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad6ed77efd770405e0c861a7819ba4e3f9a9f756/libcpp%2Finclude%2Fcpplib.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Finclude%2Fcpplib.h?ref=ad6ed77efd770405e0c861a7819ba4e3f9a9f756", "patch": "@@ -743,6 +743,7 @@ struct cpp_num\n \n #define CPP_N_UNSIGNED\t0x1000\t/* Properties.  */\n #define CPP_N_IMAGINARY\t0x2000\n+#define CPP_N_DFLOAT\t0x4000\n \n /* Classify a CPP_NUMBER token.  The return value is a combination of\n    the flags from the above sets.  */"}]}