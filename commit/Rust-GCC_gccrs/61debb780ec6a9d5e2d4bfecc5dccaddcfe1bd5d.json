{"sha": "61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjFkZWJiNzgwZWM2YTlkNWUyZDRiZmVjYzVkY2NhZGRjZmUxYmQ1ZA==", "commit": {"author": {"name": "David Daney", "email": "ddaney@avtrex.com", "date": "2008-09-22T19:48:09Z"}, "committer": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2008-09-22T19:48:09Z"}, "message": "re PR target/37593 (-mlong-calls doesn't affect calls to _mcount generated with -pg)\n\n2008-09-22  David Daney  <ddaney@avtrex.com>\n\n\tPR target/37593\n\t* config/mips/mips.h (FUNCTION_PROFILER): Call _mcount via a\n\tregister if TARGET_LONG_CALLS.\n\n2008-09-22  David Daney  <ddaney@avtrex.com>\n\n\tPR target/37593\n\t* gcc.target/mips/long-calls-pg.c: New test.\n\nFrom-SVN: r140563", "tree": {"sha": "352e23c3afaac48cc1b3d232b40cd43789597408", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/352e23c3afaac48cc1b3d232b40cd43789597408"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/comments", "author": null, "committer": null, "parents": [{"sha": "ecb4e37b73d7649a447fe63f33dc20826fce0bb6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ecb4e37b73d7649a447fe63f33dc20826fce0bb6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ecb4e37b73d7649a447fe63f33dc20826fce0bb6"}], "stats": {"total": 31, "additions": 30, "deletions": 1}, "files": [{"sha": "f558558fbca212a2b4166bd2fbe103dc15d069de", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "patch": "@@ -1,3 +1,9 @@\n+2008-09-22  David Daney  <ddaney@avtrex.com>\n+\n+\tPR target/37593\n+\t* config/mips/mips.h (FUNCTION_PROFILER): Call _mcount via a\n+\tregister if TARGET_LONG_CALLS.\n+\n 2008-09-22  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/37145"}, {"sha": "55e240e5217ee91445a98f56211f97cf3547d2ae", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "patch": "@@ -2263,6 +2263,14 @@ typedef struct mips_args {\n {\t\t\t\t\t\t\t\t\t\\\n   if (TARGET_MIPS16)\t\t\t\t\t\t\t\\\n     sorry (\"mips16 function profiling\");\t\t\t\t\\\n+  if (TARGET_LONG_CALLS)\t\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\t\\\n+      /*  For TARGET_LONG_CALLS use $3 for the address of _mcount.  */\t\\\n+      if (Pmode == DImode)\t\t\t\t\t\t\\\n+\tfprintf (FILE, \"\\tdla\\t%s,_mcount\\n\", reg_names[GP_REG_FIRST + 3]); \\\n+      else\t\t\t\t\t\t\t\t\\\n+\tfprintf (FILE, \"\\tla\\t%s,_mcount\\n\", reg_names[GP_REG_FIRST + 3]); \\\n+    }\t\t\t\t\t\t\t\t\t\\\n   fprintf (FILE, \"\\t.set\\tnoat\\n\");\t\t\t\t\t\\\n   fprintf (FILE, \"\\tmove\\t%s,%s\\t\\t# save current return address\\n\",\t\\\n \t   reg_names[GP_REG_FIRST + 1], reg_names[GP_REG_FIRST + 31]);\t\\\n@@ -2279,7 +2287,10 @@ typedef struct mips_args {\n \t       reg_names[STACK_POINTER_REGNUM],\t\t\t\t\\\n \t       Pmode == DImode ? 16 : 8);\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n-  fprintf (FILE, \"\\tjal\\t_mcount\\n\");                                   \\\n+  if (TARGET_LONG_CALLS)\t\t\t\t\t\t\\\n+    fprintf (FILE, \"\\tjalr\\t%s\\n\", reg_names[GP_REG_FIRST + 3]);\t\\\n+  else\t\t\t\t\t\t\t\t\t\\\n+    fprintf (FILE, \"\\tjal\\t_mcount\\n\");\t\t\t\t\t\\\n   fprintf (FILE, \"\\t.set\\tat\\n\");\t\t\t\t\t\\\n   /* _mcount treats $2 as the static chain register.  */\t\t\\\n   if (cfun->static_chain_decl != NULL)\t\t\t\t\t\\"}, {"sha": "752213180b65bbf59313417cd2b61f3169b2bd26", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "patch": "@@ -1,3 +1,8 @@\n+2008-09-22  David Daney  <ddaney@avtrex.com>\n+\n+\tPR target/37593\n+\t* gcc.target/mips/long-calls-pg.c: New test.\n+\n 2008-09-22  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/37145"}, {"sha": "7d2d5f16150c57d5f072c6363ebacc645fb5fb29", "filename": "gcc/testsuite/gcc.target/mips/long-calls-pg.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Flong-calls-pg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Flong-calls-pg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Flong-calls-pg.c?ref=61debb780ec6a9d5e2d4bfecc5dccaddcfe1bd5d", "patch": "@@ -0,0 +1,7 @@\n+/* { dg-do compile } */\n+/* { dg-mips-options \"-O2 -mabi=32 -march=mips32 -fno-pic -pg -mno-abicalls -mlong-calls\" } */\n+/* { dg-final { scan-assembler-not \"\\tjal\\t_mcount\" } } */\n+void\n+foo (void)\n+{\n+}"}]}