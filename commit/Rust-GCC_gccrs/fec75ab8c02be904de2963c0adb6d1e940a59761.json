{"sha": "fec75ab8c02be904de2963c0adb6d1e940a59761", "node_id": "C_kwDOANBUbNoAKGZlYzc1YWI4YzAyYmU5MDRkZTI5NjNjMGFkYjZkMWU5NDBhNTk3NjE", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-09-22T07:30:21Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-09-22T11:28:16Z"}, "message": "Check for BB before calling register_outgoing_edges.\n\nWe may be asked to fold an artificial statement not in the CFG.  Since\nthere are no outgoing edges from those, avoid calling\nregister_outgoing_edges.\n\nTested on x86-64 Linux.\n\ngcc/ChangeLog:\n\n\t* gimple-range-fold.cc (fold_using_range::range_of_range_op):\n\tMove check for non-empty BB here.\n\t(fur_source::register_outgoing_edges): ...from here.", "tree": {"sha": "0669ad429f65951fb8257725317d0c627fb3ed85", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0669ad429f65951fb8257725317d0c627fb3ed85"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fec75ab8c02be904de2963c0adb6d1e940a59761", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fec75ab8c02be904de2963c0adb6d1e940a59761", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fec75ab8c02be904de2963c0adb6d1e940a59761", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fec75ab8c02be904de2963c0adb6d1e940a59761/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7e5e44bd1729b7a9b458d512ddf61bfba5031869", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e5e44bd1729b7a9b458d512ddf61bfba5031869", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e5e44bd1729b7a9b458d512ddf61bfba5031869"}], "stats": {"total": 8, "additions": 3, "deletions": 5}, "files": [{"sha": "1da1befa9a2358a97dc606a9d2d94cded7262d7a", "filename": "gcc/gimple-range-fold.cc", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fec75ab8c02be904de2963c0adb6d1e940a59761/gcc%2Fgimple-range-fold.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fec75ab8c02be904de2963c0adb6d1e940a59761/gcc%2Fgimple-range-fold.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-range-fold.cc?ref=fec75ab8c02be904de2963c0adb6d1e940a59761", "patch": "@@ -650,7 +650,9 @@ fold_using_range::range_of_range_op (irange &r, gimple *s, fur_source &src)\n \t\t    src.register_relation (s, rel, lhs, op2);\n \t\t}\n \t    }\n-\t  else if (is_a<gcond *> (s))\n+\t  // Check for an existing BB, as we maybe asked to fold an\n+\t  // artificial statement not in the CFG.\n+\t  else if (is_a<gcond *> (s) && gimple_bb (s))\n \t    {\n \t      basic_block bb = gimple_bb (s);\n \t      edge e0 = EDGE_SUCC (bb, 0);\n@@ -1404,10 +1406,6 @@ fur_source::register_outgoing_edges (gcond *s, irange &lhs_range, edge e0, edge\n   range_operator *handler;\n   basic_block bb = gimple_bb (s);\n \n-  // We may get asked to fold an artificial statement not in the CFG.\n-  if (!bb)\n-    return;\n-\n   if (e0)\n     {\n       // If this edge is never taken, ignore it."}]}