{"sha": "484c39243085f21d504251d9f56d5685b73f40fd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDg0YzM5MjQzMDg1ZjIxZDUwNDI1MWQ5ZjU2ZDU2ODViNzNmNDBmZA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-03-11T13:29:36Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-03-11T13:29:36Z"}, "message": "(jump_optimize): Delete REG_LABEL note if label no longer in insn.\n\nFrom-SVN: r6745", "tree": {"sha": "98bfa7e196cd47ea775b341eb2d86294694a6c36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/98bfa7e196cd47ea775b341eb2d86294694a6c36"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/484c39243085f21d504251d9f56d5685b73f40fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/484c39243085f21d504251d9f56d5685b73f40fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/484c39243085f21d504251d9f56d5685b73f40fd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/484c39243085f21d504251d9f56d5685b73f40fd/comments", "author": null, "committer": null, "parents": [{"sha": "d18225c493c9d677f1fb27a611c47ea8ba276d99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d18225c493c9d677f1fb27a611c47ea8ba276d99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d18225c493c9d677f1fb27a611c47ea8ba276d99"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "a69ca799298dc68fc51401140fae25b20d3a2906", "filename": "gcc/jump.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/484c39243085f21d504251d9f56d5685b73f40fd/gcc%2Fjump.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/484c39243085f21d504251d9f56d5685b73f40fd/gcc%2Fjump.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjump.c?ref=484c39243085f21d504251d9f56d5685b73f40fd", "patch": "@@ -143,22 +143,32 @@ jump_optimize (f, cross_jump, noop_moves, after_regscan)\n      int noop_moves;\n      int after_regscan;\n {\n-  register rtx insn, next;\n+  register rtx insn, next, note;\n   int changed;\n   int first = 1;\n   int max_uid = 0;\n   rtx last_insn;\n \n   cross_jump_death_matters = (cross_jump == 2);\n \n-  /* Initialize LABEL_NUSES and JUMP_LABEL fields.  */\n+  /* Initialize LABEL_NUSES and JUMP_LABEL fields.  Delete any REG_LABEL\n+     notes whose labels don't occur in the insn any more.  */\n \n   for (insn = f; insn; insn = NEXT_INSN (insn))\n     {\n       if (GET_CODE (insn) == CODE_LABEL)\n \tLABEL_NUSES (insn) = (LABEL_PRESERVE_P (insn) != 0);\n       else if (GET_CODE (insn) == JUMP_INSN)\n \tJUMP_LABEL (insn) = 0;\n+      else if (GET_CODE (insn) == INSN || GET_CODE (insn) == CALL_INSN)\n+\tfor (note = REG_NOTES (insn); note; note = next)\n+\t  {\n+\t    next = XEXP (note, 1);\n+\t    if (REG_NOTE_KIND (note) == REG_LABEL\n+\t\t&& ! reg_mentioned_p (XEXP (note, 0), PATTERN (insn)))\n+\t      remove_note (insn, note);\n+\t  }\n+\n       if (INSN_UID (insn) > max_uid)\n \tmax_uid = INSN_UID (insn);\n     }"}]}