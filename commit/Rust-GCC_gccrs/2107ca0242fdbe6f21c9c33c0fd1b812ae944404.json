{"sha": "2107ca0242fdbe6f21c9c33c0fd1b812ae944404", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjEwN2NhMDI0MmZkYmU2ZjIxYzljMzNjMGZkMWI4MTJhZTk0NDQwNA==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2020-01-31T17:28:21Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2020-06-05T12:17:43Z"}, "message": "[Ada] Spurious error on address clause in task body\n\n2020-06-05  Ed Schonberg  <schonberg@adacore.com>\n\ngcc/ada/\n\n\t* sem_ch9.adb, (Analyze_Task_Body): After analying the task\n\tbody, indicate that all local variables have no delayed aspects.\n\tThis prevents improper later calls to\n\tCheck_Aspect_At_End_Of_Declarations, that would happen when the\n\tconstructed task_procedure body (generated during expansion) is\n\tanalyzed. The legality of aspect specifications that may appear\n\ton local declarations has already been established, and it is in\n\tgeneral not possible to recheck them properly during expansion,\n\twhen visibility may not be fully established.", "tree": {"sha": "c490b3dbe5e3f26026e717fbbd1685f266a1eb84", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c490b3dbe5e3f26026e717fbbd1685f266a1eb84"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2107ca0242fdbe6f21c9c33c0fd1b812ae944404", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2107ca0242fdbe6f21c9c33c0fd1b812ae944404", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2107ca0242fdbe6f21c9c33c0fd1b812ae944404", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2107ca0242fdbe6f21c9c33c0fd1b812ae944404/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a8aecf319aaa77429584ac8c18f556c2577616b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8aecf319aaa77429584ac8c18f556c2577616b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8aecf319aaa77429584ac8c18f556c2577616b9"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "05a6d9aa1b56bddff8d30fe54725440ef3dc1319", "filename": "gcc/ada/sem_ch9.adb", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2107ca0242fdbe6f21c9c33c0fd1b812ae944404/gcc%2Fada%2Fsem_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2107ca0242fdbe6f21c9c33c0fd1b812ae944404/gcc%2Fada%2Fsem_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch9.adb?ref=2107ca0242fdbe6f21c9c33c0fd1b812ae944404", "patch": "@@ -2993,6 +2993,24 @@ package body Sem_Ch9 is\n          else\n             Set_First_Private_Entity (Spec_Id, First_Entity (Spec_Id));\n          end if;\n+\n+         --  The entity list of the current scope now includes entities in\n+         --  the spec as well as the body. Their declarations will become\n+         --  part of the statement sequence of the task body procedure that\n+         --  is built during expansion. Indicate that aspect specifications\n+         --  for these entities need not be rechecked. The guards on\n+         --  Check_Aspect_At_End_Of_Declarations are not sufficient to\n+         --  suppress these checks, because the declarations come from source.\n+\n+         declare\n+            Priv : Entity_Id := First_Private_Entity (Spec_Id);\n+\n+         begin\n+            while Present (Priv) loop\n+               Set_Has_Delayed_Aspects (Priv, False);\n+               Next_Entity (Priv);\n+            end loop;\n+         end;\n       end if;\n \n       --  Mark all handlers as not suitable for local raise optimization,"}]}