{"sha": "7626537ae7643013855cf28f82b16239314f20d1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzYyNjUzN2FlNzY0MzAxMzg1NWNmMjhmODJiMTYyMzkzMTRmMjBkMQ==", "commit": {"author": {"name": "Matthieu Eyraud", "email": "eyraud@adacore.com", "date": "2021-02-23T07:54:30Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-06-16T08:43:00Z"}, "message": "[Ada] Fix ALI source location for dominance markers\n\ngcc/ada/\n\n\t* par_sco.adb (Set_Statement_Entry): Change sloc for dominance\n\tmarker.\n\t(Traverse_One): Fix typo.\n\t(Output_Header): Fix comment.", "tree": {"sha": "6faab54b97db915c44f29f8bd611a8d1d4a56961", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6faab54b97db915c44f29f8bd611a8d1d4a56961"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7626537ae7643013855cf28f82b16239314f20d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7626537ae7643013855cf28f82b16239314f20d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7626537ae7643013855cf28f82b16239314f20d1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7626537ae7643013855cf28f82b16239314f20d1/comments", "author": {"login": "Jugst3r", "id": 38359364, "node_id": "MDQ6VXNlcjM4MzU5MzY0", "avatar_url": "https://avatars.githubusercontent.com/u/38359364?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Jugst3r", "html_url": "https://github.com/Jugst3r", "followers_url": "https://api.github.com/users/Jugst3r/followers", "following_url": "https://api.github.com/users/Jugst3r/following{/other_user}", "gists_url": "https://api.github.com/users/Jugst3r/gists{/gist_id}", "starred_url": "https://api.github.com/users/Jugst3r/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Jugst3r/subscriptions", "organizations_url": "https://api.github.com/users/Jugst3r/orgs", "repos_url": "https://api.github.com/users/Jugst3r/repos", "events_url": "https://api.github.com/users/Jugst3r/events{/privacy}", "received_events_url": "https://api.github.com/users/Jugst3r/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ff4746bcdefb170e9583b673d29af474b7ca0786", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff4746bcdefb170e9583b673d29af474b7ca0786", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff4746bcdefb170e9583b673d29af474b7ca0786"}], "stats": {"total": 23, "additions": 19, "deletions": 4}, "files": [{"sha": "b4f76091f4441c09590451601db46d57a1f77809", "filename": "gcc/ada/par_sco.adb", "status": "modified", "additions": 19, "deletions": 4, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7626537ae7643013855cf28f82b16239314f20d1/gcc%2Fada%2Fpar_sco.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7626537ae7643013855cf28f82b16239314f20d1/gcc%2Fada%2Fpar_sco.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar_sco.adb?ref=7626537ae7643013855cf28f82b16239314f20d1", "patch": "@@ -683,9 +683,12 @@ package body Par_SCO is\n                --  two levels (through the pragma argument association) to\n                --  get to the pragma node itself. For the guard on a select\n                --  alternative, we do not have access to the token location for\n-               --  the WHEN, so we use the first sloc of the condition itself\n-               --  (note: we use First_Sloc, not Sloc, because this is what is\n-               --  referenced by dominance markers).\n+               --  the WHEN, so we use the first sloc of the condition itself.\n+               --  First_Sloc gives the most sensible result, but we have to\n+               --  beware of also using it when computing the dominance marker\n+               --  sloc (in the Set_Statement_Entry procedure), as this is not\n+               --  fully equivalent to the \"To\" sloc computed by\n+               --  Sloc_Range (Guard, To, From).\n \n                --  Doesn't this requirement of using First_Sloc need to be\n                --  documented in the spec ???\n@@ -1579,6 +1582,18 @@ package body Par_SCO is\n                         To := No_Location;\n                      end if;\n \n+                     --  Be consistent with the location determined in\n+                     --  Output_Header.\n+\n+                     if Current_Dominant.K = 'T'\n+                        and then Nkind (Parent (Current_Dominant.N))\n+                                   in N_Accept_Alternative\n+                                    | N_Delay_Alternative\n+                                    | N_Terminate_Alternative\n+                     then\n+                        From := First_Sloc (Current_Dominant.N);\n+                     end if;\n+\n                      Set_Raw_Table_Entry\n                        (C1                 => '>',\n                         C2                 => Current_Dominant.K,\n@@ -1867,7 +1882,7 @@ package body Par_SCO is\n                      Process_Decisions_Defer (Cond, 'G');\n \n                      --  For an entry body with a barrier, the entry body\n-                     --  is dominanted by a True evaluation of the barrier.\n+                     --  is dominated by a True evaluation of the barrier.\n \n                      Inner_Dominant := ('T', N);\n                   end if;"}]}