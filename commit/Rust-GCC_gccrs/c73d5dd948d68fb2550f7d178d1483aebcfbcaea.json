{"sha": "c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzczZDVkZDk0OGQ2OGZiMjU1MGY3ZDE3OGQxNDgzYWViY2ZiY2FlYQ==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2008-08-08T23:32:23Z"}, "committer": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2008-08-08T23:32:23Z"}, "message": "re PR middle-end/7651 (Define -Wextra strictly in terms of other warning flags)\n\n2008-08-09  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n\n\tPR 7651\n\t* doc/invoke.texi (-Wextra): Move warning from here...\n\t(-Wuninitialized): ... to here.\ncp/\n\t* class.c (check_bases_and_members): Warn with -Wuninitialized\n\tinstead of -Wextra.\ntestsuite/\n\t* g++.dg/warn/Wuninitializable-member.C: New.\n\t* g++.dg/warn/Wuninitializable-member-no.C: New.\n\nFrom-SVN: r138892", "tree": {"sha": "bc97d77632044f39e89c6f57ff0998acec035a7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc97d77632044f39e89c6f57ff0998acec035a7c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/comments", "author": null, "committer": null, "parents": [{"sha": "63a3341a9d1f760b1761b365f57a27523bfb548b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63a3341a9d1f760b1761b365f57a27523bfb548b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63a3341a9d1f760b1761b365f57a27523bfb548b"}], "stats": {"total": 67, "additions": 56, "deletions": 11}, "files": [{"sha": "8ba80b2aa3420c683f4825ff909340346ffebc4f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "patch": "@@ -1,3 +1,9 @@\n+2008-08-09  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n+\n+\tPR 7651\n+\t* doc/invoke.texi (-Wextra): Move warning from here...\n+\t(-Wuninitialized): ... to here.\n+\t\n 2008-08-08  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n \n \tPR 28875"}, {"sha": "46370908becddca23b8617e70c16d51d82d2a0db", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "patch": "@@ -1,3 +1,9 @@\n+2008-08-09  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n+\n+\tPR 7651\n+\t* class.c (check_bases_and_members): Warn with -Wuninitialized\n+\tinstead of -Wextra.\n+\t\n 2008-08-08  Volker Reichelt  <v.reichelt@netcologne.de>\n \n \tPR c++/35985"}, {"sha": "b08f9c80d2962824be1e40befe852bd61615e340", "filename": "gcc/cp/class.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "patch": "@@ -4306,7 +4306,7 @@ check_bases_and_members (tree t)\n   /* If the class has no user-declared constructor, but does have\n      non-static const or reference data members that can never be\n      initialized, issue a warning.  */\n-  if (extra_warnings\n+  if (warn_uninitialized\n       /* Classes with user-declared constructors are presumed to\n \t initialize these members.  */\n       && !TYPE_HAS_USER_CONSTRUCTOR (t)\n@@ -4325,13 +4325,13 @@ check_bases_and_members (tree t)\n \n \t  type = TREE_TYPE (field);\n \t  if (TREE_CODE (type) == REFERENCE_TYPE)\n-\t    warning (OPT_Wextra, \"non-static reference %q+#D in class \"\n-\t\t     \"without a constructor\", field);\n+\t    warning (OPT_Wuninitialized, \"non-static reference %q+#D \"\n+\t\t     \"in class without a constructor\", field);\n \t  else if (CP_TYPE_CONST_P (type)\n \t\t   && (!CLASS_TYPE_P (type)\n \t\t       || !TYPE_HAS_DEFAULT_CONSTRUCTOR (type)))\n-\t    warning (OPT_Wextra, \"non-static const member %q+#D in class \"\n-\t\t     \"without a constructor\", field);\n+\t    warning (OPT_Wuninitialized, \"non-static const member %q+#D \"\n+\t\t     \"in class without a constructor\", field);\n \t}\n     }\n "}, {"sha": "051f6d1ff053ad8a2f98a8740e547f68d90bbe3e", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "patch": "@@ -2748,10 +2748,6 @@ A pointer is compared against integer zero with @samp{<}, @samp{<=},\n (C++ only) An enumerator and a non-enumerator both appear in a\n conditional expression.\n \n-@item \n-(C++ only) A non-static reference or non-static @samp{const} member\n-appears in a class without constructors.\n-\n @item \n (C++ only) Ambiguous virtual bases.\n \n@@ -3173,8 +3169,10 @@ either specify @samp{-Wextra -Wunused} (note that @samp{-Wall} implies\n @item -Wuninitialized\n @opindex Wuninitialized\n @opindex Wno-uninitialized\n-Warn if an automatic variable is used without first being initialized or\n-if a variable may be clobbered by a @code{setjmp} call.\n+Warn if an automatic variable is used without first being initialized\n+or if a variable may be clobbered by a @code{setjmp} call. In C++,\n+warn if a non-static reference or non-static @samp{const} member\n+appears in a class without constructors.\n \n If you want to warn about code which uses the uninitialized value of the\n variable in its own initializer, use the @option{-Winit-self} option."}, {"sha": "6be4d9423f42692385c8baba81cf43820cf113b8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "patch": "@@ -1,3 +1,9 @@\n+2008-08-09  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n+\n+\tPR 7651\n+\t* g++.dg/warn/Wuninitializable-member.C: New.\n+\t* g++.dg/warn/Wuninitializable-member-no.C: New.\n+\t\n 2008-08-08  Manuel Lopez-Ibanez  <manu@gcc.gnu.org>\n \n \tPR 28875"}, {"sha": "0f6ccfd9d62adf6f262b598f5bc7d88745ee35df", "filename": "gcc/testsuite/g++.dg/warn/Wuninitializable-member-no.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWuninitializable-member-no.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWuninitializable-member-no.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWuninitializable-member-no.C?ref=c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "patch": "@@ -0,0 +1,15 @@\n+// Test disabling\n+// { dg-do compile } \n+// { dg-options \"-Wall -Wextra -Wno-uninitialized\" }\n+\n+class X {\n+  int & flag;// { dg-bogus \"non-static reference 'int& X::flag' in class without a constructor\" }\n+public:\n+  void f(){ flag++ ; }\n+};\n+\n+class Y {\n+  const int var;// { dg-bogus \"non-static const member 'const int Y::var' in class without a constructor\" }\n+public:\n+  int g(){ return 2*var; }\n+};"}, {"sha": "1c37e3ea0239ec439769c4ee144dcb33f0a24f94", "filename": "gcc/testsuite/g++.dg/warn/Wuninitializable-member.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWuninitializable-member.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c73d5dd948d68fb2550f7d178d1483aebcfbcaea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWuninitializable-member.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWuninitializable-member.C?ref=c73d5dd948d68fb2550f7d178d1483aebcfbcaea", "patch": "@@ -0,0 +1,14 @@\n+// { dg-do compile } \n+// { dg-options \"-Wuninitialized\" }\n+\n+class X {\n+  int & flag;// { dg-warning \"non-static reference 'int& X::flag' in class without a constructor\" }\n+public:\n+  void f(){ flag++ ; }\n+};\n+\n+class Y {\n+  const int var;// { dg-warning \"non-static const member 'const int Y::var' in class without a constructor\" }\n+public:\n+  int g(){ return 2*var; }\n+};"}]}