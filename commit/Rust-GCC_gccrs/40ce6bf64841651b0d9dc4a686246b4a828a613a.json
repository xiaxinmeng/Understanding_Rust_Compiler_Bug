{"sha": "40ce6bf64841651b0d9dc4a686246b4a828a613a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDBjZTZiZjY0ODQxNjUxYjBkOWRjNGE2ODYyNDZiNGE4MjhhNjEzYQ==", "commit": {"author": {"name": "Danny Smith", "email": "dannysmith@users.sourceforge.net", "date": "2005-04-01T08:20:24Z"}, "committer": {"name": "Danny Smith", "email": "dannysmith@gcc.gnu.org", "date": "2005-04-01T08:20:24Z"}, "message": "selectany1.C: New file.\n\n\t* g++.dg/ext/selectany1.C: New file. Test for linkonce sections.\n\t* g++.dg/ext/selectany2.C: New file. Test for errors with invalid\n\tselectany usage.\n\nFrom-SVN: r97378", "tree": {"sha": "2e6c5f4ad83dc86a5175419065a0eab141ff993e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2e6c5f4ad83dc86a5175419065a0eab141ff993e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40ce6bf64841651b0d9dc4a686246b4a828a613a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40ce6bf64841651b0d9dc4a686246b4a828a613a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40ce6bf64841651b0d9dc4a686246b4a828a613a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40ce6bf64841651b0d9dc4a686246b4a828a613a/comments", "author": null, "committer": null, "parents": [{"sha": "a20f6f00bf53a4debcbf361256ed098f8e930850", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a20f6f00bf53a4debcbf361256ed098f8e930850", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a20f6f00bf53a4debcbf361256ed098f8e930850"}], "stats": {"total": 57, "additions": 57, "deletions": 0}, "files": [{"sha": "2f5f4669d07a1376a4874f25fd905bb9c74630e8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40ce6bf64841651b0d9dc4a686246b4a828a613a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40ce6bf64841651b0d9dc4a686246b4a828a613a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=40ce6bf64841651b0d9dc4a686246b4a828a613a", "patch": "@@ -1,3 +1,9 @@\n+2005-04-01  Danny Smith  <dannysmith@users.sourceforge.net>\n+\n+\t* g++.dg/ext/selectany1.C: New file. Test for linkonce sections.\n+\t* g++.dg/ext/selectany2.C: New file. Test for errors with invalid\n+\tselectany usage.\n+\n 2005-04-01  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/19406"}, {"sha": "065332a51c711f181a9501ba162bc8d891761925", "filename": "gcc/testsuite/g++.dg/ext/selectany1.C", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40ce6bf64841651b0d9dc4a686246b4a828a613a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fselectany1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40ce6bf64841651b0d9dc4a686246b4a828a613a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fselectany1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fselectany1.C?ref=40ce6bf64841651b0d9dc4a686246b4a828a613a", "patch": "@@ -0,0 +1,21 @@\n+// { dg-do compile { target i?86-pc-cygwin } }\n+// { dg-do compile { target i?86-pc-mingw* } }\n+\n+// Check that selectany attribute puts symbols into link-once sections.\n+\n+// { dg-final { scan-assembler \"\\.section\\t\\.data\\\\\\$foo\\[^\\n\\]*\\n\\t\\.linkonce discard\" } }\n+// { dg-final { scan-assembler \"\\.section\\t\\.data\\\\\\$x\\[^\\n\\]*\\n\\t\\.linkonce discard\" } }\n+// { dg-final { scan-assembler-dem \"\\nguard variable for x:\" } }\n+\n+__declspec (selectany) int foo = 1;\n+\n+class X\n+{\n+private:\n+  int m_i;\n+public:\n+  X(int i): m_i(i){}\n+  ~X(){};\n+};\n+\n+__declspec(selectany) X x(1);"}, {"sha": "af70dcc0869fc3a8060c4ef672538a530a62448e", "filename": "gcc/testsuite/g++.dg/ext/selectany2.C", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40ce6bf64841651b0d9dc4a686246b4a828a613a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fselectany2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40ce6bf64841651b0d9dc4a686246b4a828a613a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fselectany2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fselectany2.C?ref=40ce6bf64841651b0d9dc4a686246b4a828a613a", "patch": "@@ -0,0 +1,30 @@\n+// { dg-do compile { target i?86-pc-cygwin } }\n+// { dg-do compile { target i?86-pc-mingw* } }\n+\n+// Check for errors with invalid usage of selectany attribute.\n+\n+extern int foo;\n+__declspec (selectany) int foo = 1;  // OK\n+\n+struct d\n+{\n+  static int foo;\n+};\n+__declspec (selectany) int d::foo = 1;  // OK \n+\n+struct  f\n+{\n+  int i;\n+};\n+__declspec (selectany) struct f  F= {1}; // OK\n+\n+__declspec (selectany) int boo;\t//{ dg-error \"selectany\" }\n+\n+__declspec (selectany) static int bar = 1; // { dg-error \"selectany\" }\n+int use_bar = bar;  //  Avoid defined but not used warning. \n+\n+int baz()\n+{\n+  __declspec (selectany)  int foo = 1;  // { dg-error \"selectany\" }\n+  return foo;\n+}"}]}