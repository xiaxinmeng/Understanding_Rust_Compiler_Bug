{"sha": "1c8264003ab1d6932d874bd1a9af4ac498d4b4a4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWM4MjY0MDAzYWIxZDY5MzJkODc0YmQxYTlhZjRhYzQ5OGQ0YjRhNA==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2019-10-06T15:39:27Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2019-10-06T15:39:27Z"}, "message": "Fix EXECUTE_IF_SET_IN_HARD_REG_SET use\n\nAs Maxim pointed out, r276309 broke -O3 bootstrap for aarch64-linux-gnu.\nIt turns out that EXECUTE_IF_SET_IN_HARD_REG_SET isn't safe to use for\ntemporary objects because their lifetimes don't extend to the end of\nthe loop.  This patch therefore uses an explicit temporary instead.\n\nOther patches in the series already used this style (but for\nfull_reg_and_partial_clobbers rather than full_reg_clobbers),\nso AFAICT this is the only place that needs fixing.\n\n2019-10-06  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/\n\t* var-tracking.c (dataflow_set_clear_at_call): Hoist temporary\n\tfunction result outside of EXECUTE_IF_SET_IN_HARD_REG_SET.\n\nFrom-SVN: r276639", "tree": {"sha": "4c483e64765bbcd33a788ee7e2fa6e6a9bc42832", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4c483e64765bbcd33a788ee7e2fa6e6a9bc42832"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8ab38f6cbc16025515571cd40f0f0d872d39c5ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ab38f6cbc16025515571cd40f0f0d872d39c5ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ab38f6cbc16025515571cd40f0f0d872d39c5ba"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "4b7cb0e59246df247ae7d130732d4dec4681eb31", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1c8264003ab1d6932d874bd1a9af4ac498d4b4a4", "patch": "@@ -1,3 +1,8 @@\n+2019-10-06  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* var-tracking.c (dataflow_set_clear_at_call): Hoist temporary\n+\tfunction result outside of EXECUTE_IF_SET_IN_HARD_REG_SET.\n+\n 2019-10-06  Iain Sandoe  <iain@sandoe.co.uk>\n \n \t* config/darwin.c (darwin_override_options): Adjust objective-c"}, {"sha": "5de36ae2f47287a439a1e7ab6fc0826b882253da", "filename": "gcc/var-tracking.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4/gcc%2Fvar-tracking.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c8264003ab1d6932d874bd1a9af4ac498d4b4a4/gcc%2Fvar-tracking.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvar-tracking.c?ref=1c8264003ab1d6932d874bd1a9af4ac498d4b4a4", "patch": "@@ -4902,9 +4902,10 @@ dataflow_set_clear_at_call (dataflow_set *set, rtx_insn *call_insn)\n   unsigned int r;\n   hard_reg_set_iterator hrsi;\n \n-  function_abi callee_abi = insn_callee_abi (call_insn);\n+  HARD_REG_SET callee_clobbers\n+    = insn_callee_abi (call_insn).full_reg_clobbers ();\n \n-  EXECUTE_IF_SET_IN_HARD_REG_SET (callee_abi.full_reg_clobbers (), 0, r, hrsi)\n+  EXECUTE_IF_SET_IN_HARD_REG_SET (callee_clobbers, 0, r, hrsi)\n     var_regno_delete (set, r);\n \n   if (MAY_HAVE_DEBUG_BIND_INSNS)"}]}