{"sha": "81ef7e2403b3d6025205e253c87fc3f50828b941", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODFlZjdlMjQwM2IzZDYwMjUyMDVlMjUzYzg3ZmMzZjUwODI4Yjk0MQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-03-24T20:31:09Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-03-24T20:31:09Z"}, "message": "re PR target/43498 (No unwind info for thunks even with -fasynchronous-unwind-tables)\n\n\tPR target/43498\n\t* config/i386/i386.c (x86_output_mi_thunk): Call final_start_function\n\tat the beginning and final_end_function at the end.\n\t* config/s390/s390.c (s390_output_mi_thunk): Likewise.\n\nFrom-SVN: r157706", "tree": {"sha": "0c559f49d5fcb3b2859cb09b8aa0a020b0aaa759", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c559f49d5fcb3b2859cb09b8aa0a020b0aaa759"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/81ef7e2403b3d6025205e253c87fc3f50828b941", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81ef7e2403b3d6025205e253c87fc3f50828b941", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81ef7e2403b3d6025205e253c87fc3f50828b941", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81ef7e2403b3d6025205e253c87fc3f50828b941/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f1c26cad132b285586863242c4bb6b5f551fae41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1c26cad132b285586863242c4bb6b5f551fae41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1c26cad132b285586863242c4bb6b5f551fae41"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "02441b74a883bb59fcc6bf3cdef118f27caea0b5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81ef7e2403b3d6025205e253c87fc3f50828b941/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81ef7e2403b3d6025205e253c87fc3f50828b941/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=81ef7e2403b3d6025205e253c87fc3f50828b941", "patch": "@@ -1,3 +1,10 @@\n+2010-03-24  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/43498\n+\t* config/i386/i386.c (x86_output_mi_thunk): Call final_start_function\n+\tat the beginning and final_end_function at the end.\n+\t* config/s390/s390.c (s390_output_mi_thunk): Likewise.\n+\n 2010-03-24  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* configure.ac (i[34567]86-*-*): Handle Solaris 2/x86 TLS support"}, {"sha": "2a6d674bbb2c4229f742248cd353ca22b12b8fa1", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81ef7e2403b3d6025205e253c87fc3f50828b941/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81ef7e2403b3d6025205e253c87fc3f50828b941/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=81ef7e2403b3d6025205e253c87fc3f50828b941", "patch": "@@ -26191,14 +26191,17 @@ x86_can_output_mi_thunk (const_tree thunk ATTRIBUTE_UNUSED,\n    *(*this + vcall_offset) should be added to THIS.  */\n \n static void\n-x86_output_mi_thunk (FILE *file ATTRIBUTE_UNUSED,\n+x86_output_mi_thunk (FILE *file,\n \t\t     tree thunk ATTRIBUTE_UNUSED, HOST_WIDE_INT delta,\n \t\t     HOST_WIDE_INT vcall_offset, tree function)\n {\n   rtx xops[3];\n   rtx this_param = x86_this_parameter (function);\n   rtx this_reg, tmp;\n \n+  /* Make sure unwind info is emitted for the thunk if needed.  */\n+  final_start_function (emit_barrier (), file, 1);\n+\n   /* If VCALL_OFFSET, we'll need THIS in a register.  Might as well\n      pull it in now and let DELTA benefit.  */\n   if (REG_P (this_param))\n@@ -26327,6 +26330,7 @@ x86_output_mi_thunk (FILE *file ATTRIBUTE_UNUSED,\n \t  output_asm_insn (\"jmp\\t{*}%1\", xops);\n \t}\n     }\n+  final_end_function ();\n }\n \n static void"}, {"sha": "2f82f661308366f2726b46414834d0d7e8d4349f", "filename": "gcc/config/s390/s390.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81ef7e2403b3d6025205e253c87fc3f50828b941/gcc%2Fconfig%2Fs390%2Fs390.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81ef7e2403b3d6025205e253c87fc3f50828b941/gcc%2Fconfig%2Fs390%2Fs390.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390.c?ref=81ef7e2403b3d6025205e253c87fc3f50828b941", "patch": "@@ -1,6 +1,6 @@\n /* Subroutines used for code generation on IBM S/390 and zSeries\n    Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006,\n-   2007, 2008, 2009 Free Software Foundation, Inc.\n+   2007, 2008, 2009, 2010 Free Software Foundation, Inc.\n    Contributed by Hartmut Penner (hpenner@de.ibm.com) and\n                   Ulrich Weigand (uweigand@de.ibm.com) and\n                   Andreas Krebbel (Andreas.Krebbel@de.ibm.com).\n@@ -9030,6 +9030,9 @@ s390_output_mi_thunk (FILE *file, tree thunk ATTRIBUTE_UNUSED,\n   rtx op[10];\n   int nonlocal = 0;\n \n+  /* Make sure unwind info is emitted for the thunk if needed.  */\n+  final_start_function (emit_barrier (), file, 1);\n+\n   /* Operand 0 is the target function.  */\n   op[0] = XEXP (DECL_RTL (function), 0);\n   if (flag_pic && !SYMBOL_REF_LOCAL_P (op[0]))\n@@ -9279,6 +9282,7 @@ s390_output_mi_thunk (FILE *file, tree thunk ATTRIBUTE_UNUSED,\n \t  output_asm_insn (\".long\\t%3\", op);\n \t}\n     }\n+  final_end_function ();\n }\n \n static bool"}]}