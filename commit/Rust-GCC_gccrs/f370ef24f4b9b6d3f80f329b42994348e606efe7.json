{"sha": "f370ef24f4b9b6d3f80f329b42994348e606efe7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjM3MGVmMjRmNGI5YjZkM2Y4MGYzMjliNDI5OTQzNDhlNjA2ZWZlNw==", "commit": {"author": {"name": "Michael Koch", "email": "konqueror@gmx.de", "date": "2004-07-30T17:00:34Z"}, "committer": {"name": "Michael Koch", "email": "mkoch@gcc.gnu.org", "date": "2004-07-30T17:00:34Z"}, "message": "2004-07-30  Michael Koch  <konqueror@gmx.de>\n\n\t* java/util/zip/GZIPInputStream.java\n\t(GZIPInputStream): Increase buffer size to 4k.\n\t* java/util/zip/GZIPOutputStream.java\n\t(GZIPOutputStream): Likewise.\n\t* java/util/zip/Inflater.java\n\t(setInput): Merged formating with GNU classpath.\n\t* java/util/zip/InflaterInputStream.java\n\t(InflaterInputStream): Increase buffer size to 4k.\n\t(fill): Throw exception if stream ends early.\n\t(read): Merged endless-loop with GNU classpath.\n\t(skip): Increase buffer size to 2k.\n\nFrom-SVN: r85340", "tree": {"sha": "0768b92f77f32a9eee18589b26d6c67372372ee9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0768b92f77f32a9eee18589b26d6c67372372ee9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f370ef24f4b9b6d3f80f329b42994348e606efe7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f370ef24f4b9b6d3f80f329b42994348e606efe7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f370ef24f4b9b6d3f80f329b42994348e606efe7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f370ef24f4b9b6d3f80f329b42994348e606efe7/comments", "author": null, "committer": null, "parents": [{"sha": "fbc876279385f050d3c3d03d07ea70d11afffdf9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbc876279385f050d3c3d03d07ea70d11afffdf9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbc876279385f050d3c3d03d07ea70d11afffdf9"}], "stats": {"total": 42, "additions": 30, "deletions": 12}, "files": [{"sha": "213dbcf3998d4eb1c40496415515b38df7cc5d7c", "filename": "libjava/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=f370ef24f4b9b6d3f80f329b42994348e606efe7", "patch": "@@ -1,3 +1,17 @@\n+2004-07-30  Michael Koch  <konqueror@gmx.de>\n+\n+\t* java/util/zip/GZIPInputStream.java\n+\t(GZIPInputStream): Increase buffer size to 4k.\n+\t* java/util/zip/GZIPOutputStream.java\n+\t(GZIPOutputStream): Likewise.\n+\t* java/util/zip/Inflater.java\n+\t(setInput): Merged formating with GNU classpath.\n+\t* java/util/zip/InflaterInputStream.java\n+\t(InflaterInputStream): Increase buffer size to 4k.\n+\t(fill): Throw exception if stream ends early.\n+\t(read): Merged endless-loop with GNU classpath.\n+\t(skip): Increase buffer size to 2k.\n+\n 2004-07-30  Michael Koch  <konqueror@gmx.de>\n \n \t* gnu/java/awt/EmbeddedWindow.java"}, {"sha": "9eef73eb9453ac025f5b119a2baef51708f63365", "filename": "libjava/java/util/zip/GZIPInputStream.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FGZIPInputStream.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FGZIPInputStream.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FGZIPInputStream.java?ref=f370ef24f4b9b6d3f80f329b42994348e606efe7", "patch": "@@ -104,7 +104,7 @@\n   public GZIPInputStream(InputStream in)\n     throws IOException\n   {\n-    this(in, 512);\n+    this(in, 4096);\n   }\n \n   /**"}, {"sha": "4ec6cb1a6b8e92f992398ce87063fda1e41d80cd", "filename": "libjava/java/util/zip/GZIPOutputStream.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FGZIPOutputStream.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FGZIPOutputStream.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FGZIPOutputStream.java?ref=f370ef24f4b9b6d3f80f329b42994348e606efe7", "patch": "@@ -69,7 +69,7 @@ public class GZIPOutputStream extends DeflaterOutputStream\n    */\n   public GZIPOutputStream(OutputStream out) throws IOException\n   {\n-    this(out, 512);\n+    this(out, 4096);\n   }\n \n   /**"}, {"sha": "5b6921a70299590e4b1bc7659a073fdc2bf78d6a", "filename": "libjava/java/util/zip/Inflater.java", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FInflater.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FInflater.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FInflater.java?ref=f370ef24f4b9b6d3f80f329b42994348e606efe7", "patch": "@@ -251,7 +251,7 @@ public void setDictionary (byte[] buf)\n    * @param buffer the input.\n    * @exception IllegalStateException if no input is needed.\n    */\n-  public void setInput (byte[] buf)\n+  public void setInput (byte[] buf) \n   {\n     setInput (buf, 0, buf.length);\n   }"}, {"sha": "27c29ff41dfd4dac0a70330ebf76a1ce0c68811c", "filename": "libjava/java/util/zip/InflaterInputStream.java", "status": "modified", "additions": 13, "deletions": 9, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FInflaterInputStream.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f370ef24f4b9b6d3f80f329b42994348e606efe7/libjava%2Fjava%2Futil%2Fzip%2FInflaterInputStream.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FInflaterInputStream.java?ref=f370ef24f4b9b6d3f80f329b42994348e606efe7", "patch": "@@ -79,7 +79,7 @@ public class InflaterInputStream extends FilterInputStream\n    */\n   public InflaterInputStream(InputStream in) \n   {\n-    this(in, new Inflater(), 512);\n+    this(in, new Inflater(), 4096);\n   }\n \n   /**\n@@ -91,7 +91,7 @@ public InflaterInputStream(InputStream in)\n    */\n   public InflaterInputStream(InputStream in, Inflater inf) \n   {\n-    this(in, inf, 512);\n+    this(in, inf, 4096);\n   }\n \n   /**\n@@ -149,8 +149,10 @@ protected void fill() throws IOException\n     \n     len = in.read(buf, 0, buf.length);\n \n-    if (len != -1)\n-      inf.setInput(buf, 0, len);\n+    if (len < 0)\n+      throw new ZipException(\"Deflated stream ends early.\");\n+    \n+    inf.setInput(buf, 0, len);\n   }\n \n   /**\n@@ -170,7 +172,7 @@ public int read(byte[] b, int off, int len) throws IOException\n       return -1;\n \n     int count = 0;\n-    while (count == 0)\n+    for (;;)\n       {\n \tif (inf.needsInput())\n \t  fill();\n@@ -193,8 +195,10 @@ public int read(byte[] b, int off, int len) throws IOException\n \t  {\n \t    throw new ZipException(dfe.getMessage());\n \t  }\n+\n+\tif (count > 0)\n+\t  return count;\n       }\n-    return count;\n   }\n \n   /**\n@@ -212,18 +216,18 @@ public long skip(long n) throws IOException\n     if (n == 0)\n       return 0;\n \n-    int buflen = (int) Math.min(n, 1024);\n+    int buflen = (int) Math.min(n, 2048);\n     byte[] tmpbuf = new byte[buflen];\n \n     long skipped = 0L;\n     while (n > 0L)\n       {\n \tint numread = read(tmpbuf, 0, buflen);\n-\tif (numread == -1)\n+\tif (numread <= 0)\n \t  break;\n \tn -= numread;\n \tskipped += numread;\n-\tbuflen = (int) Math.min(n, 1024);\n+\tbuflen = (int) Math.min(n, 2048);\n       }\n \n     return skipped;"}]}