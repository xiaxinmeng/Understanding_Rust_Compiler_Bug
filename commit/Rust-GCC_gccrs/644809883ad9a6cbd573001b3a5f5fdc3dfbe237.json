{"sha": "644809883ad9a6cbd573001b3a5f5fdc3dfbe237", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjQ0ODA5ODgzYWQ5YTZjYmQ1NzMwMDFiM2E1ZjVmZGMzZGZiZTIzNw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-04-04T22:51:02Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-04-04T22:51:02Z"}, "message": "re PR c++/14804 ([unit-at-a-time] initializing const data with reinterpret_cast-ed pointer-to-member function crashes)\n\n\tPR c++/14804\n\t* varasm.c (initializer_constant_valid_p): Allow NOP_EXPRs to\n\tRECORD_TYPEs.\n\nFrom-SVN: r80404", "tree": {"sha": "d8264309dc2c46a391392670e32318186e13e6c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8264309dc2c46a391392670e32318186e13e6c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/644809883ad9a6cbd573001b3a5f5fdc3dfbe237", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/644809883ad9a6cbd573001b3a5f5fdc3dfbe237", "html_url": "https://github.com/Rust-GCC/gccrs/commit/644809883ad9a6cbd573001b3a5f5fdc3dfbe237", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/644809883ad9a6cbd573001b3a5f5fdc3dfbe237/comments", "author": null, "committer": null, "parents": [{"sha": "aaf3c6d91d8d9013234d58100c23c2f78249cf3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aaf3c6d91d8d9013234d58100c23c2f78249cf3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aaf3c6d91d8d9013234d58100c23c2f78249cf3c"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "582add276f361c19bc841aa97e13dbfa44249bef", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/644809883ad9a6cbd573001b3a5f5fdc3dfbe237/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/644809883ad9a6cbd573001b3a5f5fdc3dfbe237/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=644809883ad9a6cbd573001b3a5f5fdc3dfbe237", "patch": "@@ -1,3 +1,9 @@\n+2004-04-04  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/14804\n+\t* varasm.c (initializer_constant_valid_p): Allow NOP_EXPRs to\n+\tRECORD_TYPEs.\n+\n 2004-04-04  Mark Mitchell  <mark@codesourcery.com>\n \n \t* doc/invoke.texi (-mabi=o64): Create link to O64 ABI"}, {"sha": "707ad4bbe65e1ba519558067e7c701e595909225", "filename": "gcc/varasm.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/644809883ad9a6cbd573001b3a5f5fdc3dfbe237/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/644809883ad9a6cbd573001b3a5f5fdc3dfbe237/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=644809883ad9a6cbd573001b3a5f5fdc3dfbe237", "patch": "@@ -3332,8 +3332,10 @@ initializer_constant_valid_p (tree value, tree endtype)\n \t\t\t\t\t\t endtype);\n \t}\n \n-      /* Allow conversions to union types if the value inside is okay.  */\n-      if (TREE_CODE (TREE_TYPE (value)) == UNION_TYPE)\n+      /* Allow conversions to struct or union types if the value\n+\t inside is okay.  */\n+      if (TREE_CODE (TREE_TYPE (value)) == RECORD_TYPE\n+\t  || TREE_CODE (TREE_TYPE (value)) == UNION_TYPE)\n \treturn initializer_constant_valid_p (TREE_OPERAND (value, 0),\n \t\t\t\t\t     endtype);\n       break;"}]}