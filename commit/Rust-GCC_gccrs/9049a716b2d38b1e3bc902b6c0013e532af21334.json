{"sha": "9049a716b2d38b1e3bc902b6c0013e532af21334", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTA0OWE3MTZiMmQzOGIxZTNiYzkwMmI2YzAwMTNlNTMyYWYyMTMzNA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1996-01-31T13:24:55Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1996-01-31T13:24:55Z"}, "message": "(STATIC_CHAIN_REGNUM): Redefine to use register a1.\n\n(TRAMPOLINE_TEMPLATE): Likewise.\n\nFrom-SVN: r11136", "tree": {"sha": "5a19be3c33975481a6631bf6454fe7b2a91dc485", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5a19be3c33975481a6631bf6454fe7b2a91dc485"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9049a716b2d38b1e3bc902b6c0013e532af21334", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9049a716b2d38b1e3bc902b6c0013e532af21334", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9049a716b2d38b1e3bc902b6c0013e532af21334", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9049a716b2d38b1e3bc902b6c0013e532af21334/comments", "author": null, "committer": null, "parents": [{"sha": "4710d01a2951d789b802d8c84becf444c3c3724f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4710d01a2951d789b802d8c84becf444c3c3724f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4710d01a2951d789b802d8c84becf444c3c3724f"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "3a8b2e06d592a4e412734c08aed59790d57f9e24", "filename": "gcc/config/m68k/m68kv4.h", "status": "modified", "additions": 28, "deletions": 2, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9049a716b2d38b1e3bc902b6c0013e532af21334/gcc%2Fconfig%2Fm68k%2Fm68kv4.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9049a716b2d38b1e3bc902b6c0013e532af21334/gcc%2Fconfig%2Fm68k%2Fm68kv4.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Fm68kv4.h?ref=9049a716b2d38b1e3bc902b6c0013e532af21334", "patch": "@@ -1,5 +1,5 @@\n /* Target definitions for GNU compiler for mc680x0 running System V.4\n-   Copyright (C) 1991, 1993, 1994, 1995 Free Software Foundation, Inc.\n+   Copyright (C) 1991, 1993, 1994, 1995, 1996 Free Software Foundation, Inc.\n \n    Written by Ron Guilmette (rfg@netcom.com) and Fred Fish (fnf@cygnus.com).\n \n@@ -113,6 +113,13 @@ while (0)\n #undef STRUCT_VALUE_REGNUM\n #define STRUCT_VALUE_REGNUM 8\n \n+/* Register in which static-chain is passed to a function.  The\n+   default in m68k.h is a0, but that is already the struct value\n+   regnum.  Make it a1 instead.  */\n+\n+#undef STATIC_CHAIN_REGNUM\n+#define STATIC_CHAIN_REGNUM 9\n+\n #define ASM_COMMENT_START \"#\"\n \n #undef TYPE_OPERAND_FMT\n@@ -186,7 +193,8 @@ do {\t\t\t\t\t\t\t\t\t\\\n \n #undef LIBCALL_VALUE\n #define LIBCALL_VALUE(MODE)\t\t\t\t\t\t\\\n-  (((MODE) == SFmode || (MODE) == DFmode) && TARGET_68881\t\t\\\n+  ((((MODE) == SFmode || (MODE) == DFmode || (MODE) == XFmode)\t\t\\\n+    && TARGET_68881)\t\t\t\t\t\t\t\\\n    ? gen_rtx (REG, (MODE), 16)\t\t\t\t\t\t\\\n    : gen_rtx (REG, (MODE), 0))\n \n@@ -302,3 +310,21 @@ int switch_table_difference_label_flag;\n   if (! TARGET_68020 && flag_pic == 2)\t\\\n     error(\"-fPIC is not currently supported on the 68000 or 68010\\n\");\t\\\n }\n+\n+/* Output assembler code for a block containing the constant parts\n+   of a trampoline, leaving space for the variable parts.  */\n+\n+/* On m68k svr4, the trampoline is different from the generic version\n+   in that we use a1 as the static call chain.  */\n+\n+#undef TRAMPOLINE_TEMPLATE\n+#define TRAMPOLINE_TEMPLATE(FILE)\t\t\t\t\t\\\n+{\t\t\t\t\t\t\t\t\t\\\n+  ASM_OUTPUT_SHORT (FILE, gen_rtx (CONST_INT, VOIDmode, 0x207b));\t\\\n+  ASM_OUTPUT_SHORT (FILE, gen_rtx (CONST_INT, VOIDmode, 8));\t\t\\\n+  ASM_OUTPUT_SHORT (FILE, gen_rtx (CONST_INT, VOIDmode, 0x2f3a));\t\\\n+  ASM_OUTPUT_SHORT (FILE, gen_rtx (CONST_INT, VOIDmode, 8));\t\t\\\n+  ASM_OUTPUT_SHORT (FILE, gen_rtx (CONST_INT, VOIDmode, 0x4e75));\t\\\n+  ASM_OUTPUT_INT (FILE, const0_rtx);\t\t\t\t\t\\\n+  ASM_OUTPUT_INT (FILE, const0_rtx);\t\t\t\t\t\\\n+}"}]}