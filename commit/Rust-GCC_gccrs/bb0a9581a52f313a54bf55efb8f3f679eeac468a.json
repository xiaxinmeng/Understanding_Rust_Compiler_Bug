{"sha": "bb0a9581a52f313a54bf55efb8f3f679eeac468a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmIwYTk1ODFhNTJmMzEzYTU0YmY1NWVmYjhmM2Y2NzllZWFjNDY4YQ==", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@codesourcery.com", "date": "2010-11-15T15:24:31Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2010-11-15T15:24:31Z"}, "message": "re PR preprocessor/45038 (__DBL_MIN__ result in old-style-cast)\n\ngcc/c-family/\n\tPR preprocessor/45038\n\t* c-cppbuiltin.c (c_cpp_builtins): Use different format for C++\n\tdialects.\n\ngcc/testsuite/\n\tPR preprocessor/45038\n\t* g++.dg/pr45038.C: New test.\n\nFrom-SVN: r166756", "tree": {"sha": "6e418dc0ff807b9ab6f27b6df17a998720393508", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6e418dc0ff807b9ab6f27b6df17a998720393508"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb0a9581a52f313a54bf55efb8f3f679eeac468a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb0a9581a52f313a54bf55efb8f3f679eeac468a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb0a9581a52f313a54bf55efb8f3f679eeac468a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb0a9581a52f313a54bf55efb8f3f679eeac468a/comments", "author": null, "committer": null, "parents": [{"sha": "c636a4fbf67f2d5344ba102fd55896587ab189c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c636a4fbf67f2d5344ba102fd55896587ab189c4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c636a4fbf67f2d5344ba102fd55896587ab189c4"}], "stats": {"total": 30, "additions": 27, "deletions": 3}, "files": [{"sha": "4e31d6a1e18456c9d96aa7b29c6e2bd9a08448f1", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=bb0a9581a52f313a54bf55efb8f3f679eeac468a", "patch": "@@ -1,3 +1,9 @@\n+2010-11-15  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\tPR preprocessor/45038\n+\t* c-cppbuiltin.c (c_cpp_builtins): Use different format for C++\n+\tdialects.\n+\n 2010-11-12  Joseph Myers  <joseph@codesourcery.com>\n \n \t* c-common.h (c_family_lang_mask): Declare."}, {"sha": "ca779648b20479cd2e82877ce1c009923225d676", "filename": "gcc/c-family/c-cppbuiltin.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Fc-family%2Fc-cppbuiltin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Fc-family%2Fc-cppbuiltin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-cppbuiltin.c?ref=bb0a9581a52f313a54bf55efb8f3f679eeac468a", "patch": "@@ -657,9 +657,13 @@ c_cpp_builtins (cpp_reader *pfile)\n   /* Cast the double precision constants.  This is needed when single\n      precision constants are specified or when pragma FLOAT_CONST_DECIMAL64\n      is used.  The correct result is computed by the compiler when using\n-     macros that include a cast.  */\n-  builtin_define_float_constants (\"DBL\", \"L\", \"((double)%s)\", \"\",\n-\t\t\t\t  double_type_node);\n+     macros that include a cast.  We use a different cast for C++ to avoid\n+     problems with -Wold-style-cast.  */\n+  builtin_define_float_constants (\"DBL\", \"L\",\n+\t\t\t\t  (c_dialect_cxx ()\n+\t\t\t\t   ? \"double(%s)\"\n+\t\t\t\t   : \"((double)%s)\"),\n+\t\t\t\t  \"\", double_type_node);\n   builtin_define_float_constants (\"LDBL\", \"L\", \"%s\", \"L\",\n \t\t\t\t  long_double_type_node);\n "}, {"sha": "79ec4a98a64d352e5c5490aad655cbe1cef7530d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bb0a9581a52f313a54bf55efb8f3f679eeac468a", "patch": "@@ -1,3 +1,8 @@\n+2010-11-15  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\tPR preprocessor/45038\n+\t* g++.dg/pr45038.C: New test.\n+\n 2010-11-15  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/46467"}, {"sha": "57c0c4417e66ef72e64b399ddaffb7ed7517ac80", "filename": "gcc/testsuite/g++.dg/pr45038.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpr45038.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb0a9581a52f313a54bf55efb8f3f679eeac468a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpr45038.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fpr45038.C?ref=bb0a9581a52f313a54bf55efb8f3f679eeac468a", "patch": "@@ -0,0 +1,9 @@\n+// PR preprocessor/45038\n+// { dg-do compile }\n+// { dg-options \"-Werror -Wold-style-cast\" }\n+\n+double f(void)\n+{\n+  // We used to produce old-style casts for this.\n+  return __DBL_MIN__;\n+}"}]}