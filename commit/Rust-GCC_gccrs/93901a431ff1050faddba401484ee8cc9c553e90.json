{"sha": "93901a431ff1050faddba401484ee8cc9c553e90", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTM5MDFhNDMxZmYxMDUwZmFkZGJhNDAxNDg0ZWU4Y2M5YzU1M2U5MA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-06-12T10:14:44Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-06-12T10:14:44Z"}, "message": "[multiple changes]\n\n2012-06-12  Robert Dewar  <dewar@adacore.com>\n\n\t* xref_lib.adb, sem_ch13.adb, lib-xref.adb: Minor reformatting.\n\n2012-06-12  Javier Miranda  <miranda@adacore.com>\n\n\t* lib-xref.ads Adding missing documentation.\n\nFrom-SVN: r188439", "tree": {"sha": "92ef26c049da2ec8184dd48cb7db5e5da916e546", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/92ef26c049da2ec8184dd48cb7db5e5da916e546"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/93901a431ff1050faddba401484ee8cc9c553e90", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93901a431ff1050faddba401484ee8cc9c553e90", "html_url": "https://github.com/Rust-GCC/gccrs/commit/93901a431ff1050faddba401484ee8cc9c553e90", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/93901a431ff1050faddba401484ee8cc9c553e90/comments", "author": null, "committer": null, "parents": [{"sha": "3235dc87bf6bbe42b58a40f0d894283997e3100c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3235dc87bf6bbe42b58a40f0d894283997e3100c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3235dc87bf6bbe42b58a40f0d894283997e3100c"}], "stats": {"total": 80, "additions": 59, "deletions": 21}, "files": [{"sha": "42f3653906a775e579f2499e9937e2adaa21a590", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=93901a431ff1050faddba401484ee8cc9c553e90", "patch": "@@ -1,3 +1,11 @@\n+2012-06-12  Robert Dewar  <dewar@adacore.com>\n+\n+\t* xref_lib.adb, sem_ch13.adb, lib-xref.adb: Minor reformatting.\n+\n+2012-06-12  Javier Miranda  <miranda@adacore.com>\n+\n+\t* lib-xref.ads Adding missing documentation.\n+\n 2012-06-12  Hristian Kirtchev  <kirtchev@adacore.com>\n \n \t* exp_ch7.adb (Create_Finalizer): Add the"}, {"sha": "bbf1a3db4fb7f8b448303748bb03a77c9aa4ded5", "filename": "gcc/ada/lib-xref.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Flib-xref.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Flib-xref.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib-xref.adb?ref=93901a431ff1050faddba401484ee8cc9c553e90", "patch": "@@ -2443,7 +2443,7 @@ package body Lib.Xref is\n \n                      if Is_Overloadable (XE.Key.Ent) then\n                         if (Is_Imported (XE.Key.Ent) and then XE.Key.Typ = 'b')\n-                          or else\n+                             or else\n                            (Is_Exported (XE.Key.Ent) and then XE.Key.Typ = 'i')\n                         then\n                            Output_Import_Export_Info (XE.Key.Ent);"}, {"sha": "c0fd31653d94f6cffe968f84bb324b49588f9160", "filename": "gcc/ada/lib-xref.ads", "status": "modified", "additions": 20, "deletions": 7, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Flib-xref.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Flib-xref.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib-xref.ads?ref=93901a431ff1050faddba401484ee8cc9c553e90", "patch": "@@ -565,22 +565,35 @@ package Lib.Xref is\n    --    y     abstract function               entry or entry family\n    --    z     generic formal parameter        (unused)\n \n-   --------------------------------------\n-   -- Handling of Imported Subprograms --\n-   --------------------------------------\n+   ---------------------------------------------------\n+   -- Handling of Imported and Exported Subprograms --\n+   ---------------------------------------------------\n \n    --  If a pragma Import or Interface applies to a subprogram, the pragma is\n    --  the completion of the subprogram. This is noted in the ALI file by\n    --  making the occurrence of the subprogram in the pragma into a body\n    --  reference ('b') and by including the external name of the subprogram and\n    --  its language, bracketed by '<' and '>' in that reference. For example:\n-   --\n-   --     3U13*elsewhere 4b<c,there>21\n-   --\n-   --  indicates that procedure elsewhere, declared at line 3, has a pragma\n+\n+   --     3U13*imported_proc 4b<c,there>21\n+\n+   --  indicates that procedure imported_proc, declared at line 3, has a pragma\n    --  Import at line 4, that its body is in C, and that the link name as given\n    --  in the pragma is \"there\".\n \n+   --  If a pragma Export applies to a subprogram exported to a foreign\n+   --  language (ie. the pragma has convention different from Ada), then the\n+   --  pragma is annotated in the ALI file by making the occurrence of the\n+   --  subprogram in the pragma into an implicit reference ('i') and by\n+   --  including the external name of the subprogram and its language,\n+   --  bracketed by '<' and '>' in that reference. For example:\n+\n+   --     3U13*exported_proc 4i<c,here>21\n+\n+   --  indicates that procedure exported_proc, declared at line 3, has a pragma\n+   --  Export at line 4, that its body is exported to C, and that the link name\n+   --  as given in the pragma is \"here\".\n+\n    ----------------------\n    -- Alfa Information --\n    ----------------------"}, {"sha": "9acce0f163c4c98d904b0828230e93f8645b5160", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 28, "deletions": 11, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=93901a431ff1050faddba401484ee8cc9c553e90", "patch": "@@ -950,14 +950,11 @@ package body Sem_Ch13 is\n \n                      goto Continue;\n \n-                  elsif A_Id = Aspect_Import\n-                    or else A_Id = Aspect_Export\n-                  then\n-\n-                     --  Verify that there is an aspect Convention that will\n-                     --  incorporate the Import/Export aspect, and eventual\n-                     --  Link/External names.\n+                  --  For Import/Export, Verify that there is an aspect\n+                  --  Convention that will incorporate the Import/Export\n+                  --  aspect, and eventual Link/External names.\n \n+                  elsif A_Id = Aspect_Import or else A_Id = Aspect_Export then\n                      declare\n                         A : Node_Id;\n \n@@ -1218,36 +1215,56 @@ package body Sem_Ch13 is\n                      L_Assoc  := Empty;\n                      E_Assoc  := Empty;\n \n+                     --  Loop to look for Import/Export/Link_Name/External_Name\n+\n                      A := First (L);\n                      while Present (A) loop\n                         A_Name := Chars (Identifier (A));\n \n+                        --  Import/Export\n+\n                         if A_Name = Name_Import\n-                          or else A_Name = Name_Export\n+                             or else\n+                           A_Name = Name_Export\n                         then\n+                           --  Forbid duplicates, at most one can appear\n+\n                            if Found then\n-                              Error_Msg_N (\"conflicting\", A);\n+                              Error_Msg_Name_1 := A_Name;\n+                              Error_Msg_Name_2 := P_Name;\n+                              Error_Msg_N\n+                                (\"% aspect conflicts with previous % aspect\",\n+                                 A);\n                            else\n                               Found := True;\n                            end if;\n \n+                           --  Record name of pragma to generate\n+\n                            P_Name := A_Name;\n \n+                        --  Capture Link_Name\n+\n                         elsif A_Name = Name_Link_Name then\n                            L_Assoc := Make_Pragma_Argument_Association (Loc,\n-                              Chars => A_Name,\n+                              Chars      => A_Name,\n                               Expression => Relocate_Node (Expression (A)));\n \n+                        --  Capture External_Name\n+\n                         elsif A_Name = Name_External_Name then\n                            E_Assoc := Make_Pragma_Argument_Association (Loc,\n-                              Chars => A_Name,\n+                              Chars      => A_Name,\n                               Expression => Relocate_Node (Expression (A)));\n                         end if;\n \n                         Next (A);\n                      end loop;\n \n+                     --  Construct pragma\n+\n                      Arg_List := New_List (Relocate_Node (Expr), Ent);\n+\n                      if Present (L_Assoc) then\n                         Append_To (Arg_List, L_Assoc);\n                      end if;"}, {"sha": "30180af042def61d8586a41c8a59e4d12dbc66ed", "filename": "gcc/ada/xref_lib.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Fxref_lib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/93901a431ff1050faddba401484ee8cc9c553e90/gcc%2Fada%2Fxref_lib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fxref_lib.adb?ref=93901a431ff1050faddba401484ee8cc9c553e90", "patch": "@@ -1103,8 +1103,8 @@ package body Xref_Lib is\n                Ptr := Ptr + 1;\n             end if;\n \n-            --  Imported entities might special indication as to their external\n-            --  name:\n+            --  Imported entities may have an indication specifying information\n+            --  about the corresponding external name:\n             --    5U14*Foo2 5>20 6b<c,myfoo2>22   # Imported entity\n             --    5U14*Foo2 5>20 6i<c,myfoo2>22   # Exported entity\n "}]}