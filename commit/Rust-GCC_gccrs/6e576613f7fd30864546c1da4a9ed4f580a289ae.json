{"sha": "6e576613f7fd30864546c1da4a9ed4f580a289ae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmU1NzY2MTNmN2ZkMzA4NjQ1NDZjMWRhNGE5ZWQ0ZjU4MGEyODlhZQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely.gcc@gmail.com", "date": "2012-01-06T01:26:06Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2012-01-06T01:26:06Z"}, "message": "re PR libstdc++/51504 (Data race hunting instructions in manual do not work)\n\n\tPR libstdc++/51504\n\t* doc/xml/manual/debug.xml: Suggest using symbol interposition\n\tto override symbols using annotation macros.\n\nFrom-SVN: r182943", "tree": {"sha": "680ea72aee0ab27bd74bd4012057eae063fde26d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/680ea72aee0ab27bd74bd4012057eae063fde26d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6e576613f7fd30864546c1da4a9ed4f580a289ae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e576613f7fd30864546c1da4a9ed4f580a289ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e576613f7fd30864546c1da4a9ed4f580a289ae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e576613f7fd30864546c1da4a9ed4f580a289ae/comments", "author": null, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ea0463d9d481d4274180c69b516f9ada549fb928", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea0463d9d481d4274180c69b516f9ada549fb928", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea0463d9d481d4274180c69b516f9ada549fb928"}], "stats": {"total": 30, "additions": 23, "deletions": 7}, "files": [{"sha": "e0b3bc8566de1d3efe0e5101c95452a878f8b188", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e576613f7fd30864546c1da4a9ed4f580a289ae/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e576613f7fd30864546c1da4a9ed4f580a289ae/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=6e576613f7fd30864546c1da4a9ed4f580a289ae", "patch": "@@ -1,3 +1,9 @@\n+2012-01-06  Jonathan Wakely  <jwakely.gcc@gmail.com>\n+\n+\tPR libstdc++/51504\n+\t* doc/xml/manual/debug.xml: Suggest using symbol interposition\n+\tto override symbols using annotation macros.\n+\n 2012-01-05  Fran\u00e7ois Dumont  <fdumont@gcc.gnu.org>\n \n \t* include/bits/hashtable_policy.h (_Hashtable_base<>::_M_eq()):"}, {"sha": "7ee2abf6988048e3260bc19526f49a6047e048d3", "filename": "libstdc++-v3/doc/xml/manual/debug.xml", "status": "modified", "additions": 17, "deletions": 7, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e576613f7fd30864546c1da4a9ed4f580a289ae/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fdebug.xml", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e576613f7fd30864546c1da4a9ed4f580a289ae/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fdebug.xml", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdoc%2Fxml%2Fmanual%2Fdebug.xml?ref=6e576613f7fd30864546c1da4a9ed4f580a289ae", "patch": "@@ -207,14 +207,24 @@\n   redefining them will only affect inline functions and template\n   instantiations which are compiled in user code. This allows annotation\n   of templates such as <code>shared_ptr</code>, but not code which is\n-  only instantiated in the library.\n-  In order to annotate <code>basic_string</code> reference counting it\n-  is necessary to disable extern templates (by defining \n-  <code>_GLIBCXX_EXTERN_TEMPLATE=-1</code>) or to rebuild the \n-  <code>.so</code> file.\n+  only instantiated in the library.  Code which is only instantiated in\n+  the library needs to be recompiled with the annotation macros defined.\n+  That can be done by rebuilding the entire\n+  <filename class=\"libraryfile\">libstdc++.so</filename> file but a simpler\n+  alternative exists for ELF platforms such as GNU/Linux, because ELF\n+  symbol interposition allows symbols defined in the shared library to be\n+  overridden by symbols with the same name that appear earlier in the\n+  runtime search path. This means you only need to recompile the functions\n+  that are affected by the annotation macros, which can be done by\n+  recompiling individual files.\n+  Annotating <code>std::string</code> and <code>std::wstring</code>\n+  reference counting can be done by disabling extern templates (by defining \n+  <code>_GLIBCXX_EXTERN_TEMPLATE=-1</code>) or by rebuilding the \n+  <filename>src/string-inst.cc</filename> file.\n   Annotating the remaining atomic operations (at the time of writing these\n-  are in <code>ios_base::Init::~Init</code>, <code>locale::_Impl</code> and\n-  <code>locale::facet</code>) requires rebuilding the <code>.so</code> file.\n+  are in <code>ios_base::Init::~Init</code>, <code>locale::_Impl</code>,\n+  <code>locale::facet</code> and <code>thread::_M_start_thread</code>)\n+  requires rebuilding the relevant source files.\n </para>\n \n <para>"}]}