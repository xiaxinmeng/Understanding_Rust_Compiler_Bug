{"sha": "a7d3cd407ccea644f1405cf331edf3bb30e57e65", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTdkM2NkNDA3Y2NlYTY0NGYxNDA1Y2YzMzFlZGYzYmIzMGU1N2U2NQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2017-11-22T11:37:16Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2017-11-22T11:37:16Z"}, "message": "re PR fortran/79072 (ICE with class(*) pointer function result and character value)\n\n2017-11-22  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/79072\n\t* trans-stmt.c (trans_associate_var): Weaken the over strong\n\tcondition for using the fake result decl.\n\n2017-11-22  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/79072\n\t* gfortran.dg/class_result_6.f90: New test for comment 10 of\n\tthe PR.\n\nFrom-SVN: r255053", "tree": {"sha": "6399e69314ca4091b958337d37928c2ec2e6def7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6399e69314ca4091b958337d37928c2ec2e6def7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7d3cd407ccea644f1405cf331edf3bb30e57e65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7d3cd407ccea644f1405cf331edf3bb30e57e65", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7d3cd407ccea644f1405cf331edf3bb30e57e65", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7d3cd407ccea644f1405cf331edf3bb30e57e65/comments", "author": null, "committer": null, "parents": [{"sha": "e350134d727b80b261d410b62f791fe96a3b3e89", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e350134d727b80b261d410b62f791fe96a3b3e89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e350134d727b80b261d410b62f791fe96a3b3e89"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "7fc965baf81c6a1351a8426e95520a34ac9e6353", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=a7d3cd407ccea644f1405cf331edf3bb30e57e65", "patch": "@@ -1,3 +1,9 @@\n+2017-11-22  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/79072\n+\t* trans-stmt.c (trans_associate_var): Weaken the over strong\n+\tcondition for using the fake result decl.\n+\n 2017-11-20  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/79072"}, {"sha": "db913bfe5156917d85df6f29138588a4d99db246", "filename": "gcc/fortran/trans-stmt.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ffortran%2Ftrans-stmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ffortran%2Ftrans-stmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-stmt.c?ref=a7d3cd407ccea644f1405cf331edf3bb30e57e65", "patch": "@@ -1828,8 +1828,7 @@ trans_associate_var (gfc_symbol *sym, gfc_wrapped_block *block)\n \t  tmp = e->symtree->n.sym->ts.u.cl->backend_decl;\n \t}\n       else if (e->symtree->n.sym->attr.function\n-\t       && e->symtree->n.sym == e->symtree->n.sym->result\n-\t       && e->symtree->n.sym == e->symtree->n.sym->ns->proc_name)\n+\t       && e->symtree->n.sym == e->symtree->n.sym->result)\n \t{\n \t  tmp = gfc_get_fake_result_decl (e->symtree->n.sym, 0);\n \t  tmp = gfc_class_len_get (tmp);"}, {"sha": "39dd1446bac04a0e746c4e488961e3c2845b204a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a7d3cd407ccea644f1405cf331edf3bb30e57e65", "patch": "@@ -1,3 +1,9 @@\n+2017-11-22  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/79072\n+\t* gfortran.dg/class_result_6.f90: New test for comment 10 of\n+\tthe PR.\n+\n 2017-11-22  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/83084"}, {"sha": "44e17a22025c0f2fe1b8c2875f1336568f7300ab", "filename": "gcc/testsuite/gfortran.dg/class_result_6.f90", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_result_6.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7d3cd407ccea644f1405cf331edf3bb30e57e65/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_result_6.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_result_6.f90?ref=a7d3cd407ccea644f1405cf331edf3bb30e57e65", "patch": "@@ -0,0 +1,24 @@\n+! { dg-do run }\n+!\n+! Test the fix for PR79072 comment #12. A description of the problem\n+! is to be found in class_result_5.f90.\n+!\n+! Contributed by Neil Carlson  <neil.n.carlson@gmail.com>\n+!\n+  character(3), target :: a = 'foo'\n+  class(*), pointer :: b\n+  b => ptr()\n+  select type (b)\n+    type is (character(*))\n+      if (a .ne. \"bar\") call abort\n+  end select\n+contains\n+  function ptr()\n+    class(*), pointer :: ptr\n+    ptr => a\n+    select type (ptr)\n+      type is (character(*))\n+        ptr = \"bar\"\n+    end select\n+  end function\n+end"}]}