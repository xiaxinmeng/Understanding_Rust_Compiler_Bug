{"sha": "39587bb9f39130beb3a499e4ecb67b7971354ef1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mzk1ODdiYjlmMzkxMzBiZWIzYTQ5OWU0ZWNiNjdiNzk3MTM1NGVmMQ==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "rakdver@atrey.karlin.mff.cuni.cz", "date": "2002-09-07T14:02:55Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2002-09-07T14:02:55Z"}, "message": "cfgcleanup.c (try_crossjump_to_edge): Fix updating of liveness information.\n\n\t* cfgcleanup.c (try_crossjump_to_edge): Fix updating of liveness\n\tinformation.\n\nFrom-SVN: r56916", "tree": {"sha": "212ae3fc2c728076495908805b060a2ede8f6bb6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/212ae3fc2c728076495908805b060a2ede8f6bb6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/39587bb9f39130beb3a499e4ecb67b7971354ef1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39587bb9f39130beb3a499e4ecb67b7971354ef1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39587bb9f39130beb3a499e4ecb67b7971354ef1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39587bb9f39130beb3a499e4ecb67b7971354ef1/comments", "author": null, "committer": null, "parents": [{"sha": "92d9256d257aab3b1d05cb1a89d13f7b9d129a62", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92d9256d257aab3b1d05cb1a89d13f7b9d129a62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/92d9256d257aab3b1d05cb1a89d13f7b9d129a62"}], "stats": {"total": 33, "additions": 11, "deletions": 22}, "files": [{"sha": "e666c3f0ff2b7dff886380d1f8bdab610c703140", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39587bb9f39130beb3a499e4ecb67b7971354ef1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39587bb9f39130beb3a499e4ecb67b7971354ef1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=39587bb9f39130beb3a499e4ecb67b7971354ef1", "patch": "@@ -1,3 +1,8 @@\n+2002-09-07  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>\n+\n+\t* cfgcleanup.c (try_crossjump_to_edge): Fix updating of liveness\n+\tinformation.\n+\n 2002-09-07  Graham Stott  <graham.stott@btinternet.con>\n \n        * rtlanal.c (dead_or_set_regno_p): Fix typo."}, {"sha": "f6a011ad51e51c0669a25dd313f054bb98e76239", "filename": "gcc/cfgcleanup.c", "status": "modified", "additions": 6, "deletions": 22, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39587bb9f39130beb3a499e4ecb67b7971354ef1/gcc%2Fcfgcleanup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39587bb9f39130beb3a499e4ecb67b7971354ef1/gcc%2Fcfgcleanup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgcleanup.c?ref=39587bb9f39130beb3a499e4ecb67b7971354ef1", "patch": "@@ -1308,11 +1308,9 @@ try_crossjump_to_edge (mode, e1, e2)\n {\n   int nmatch;\n   basic_block src1 = e1->src, src2 = e2->src;\n-  basic_block redirect_to;\n+  basic_block redirect_to, redirect_from, to_remove;\n   rtx newpos1, newpos2;\n   edge s;\n-  rtx last;\n-  rtx label;\n \n   /* Search backward through forwarder blocks.  We don't need to worry\n      about multiple entry or chained forwarders, as they will be optimized\n@@ -1440,28 +1438,14 @@ try_crossjump_to_edge (mode, e1, e2)\n \n   if (GET_CODE (newpos1) == NOTE)\n     newpos1 = NEXT_INSN (newpos1);\n-  last = src1->end;\n \n-  /* Emit the jump insn.  */\n-  label = block_label (redirect_to);\n-  emit_jump_insn_after (gen_jump (label), src1->end);\n-  JUMP_LABEL (src1->end) = label;\n-  LABEL_NUSES (label)++;\n+  redirect_from = split_block (src1, PREV_INSN (newpos1))->src;\n+  to_remove = redirect_from->succ->dest;\n \n-  /* Delete the now unreachable instructions.  */\n-  delete_insn_chain (newpos1, last);\n+  redirect_edge_and_branch_force (redirect_from->succ, redirect_to);\n+  flow_delete_block (to_remove);\n \n-  /* Make sure there is a barrier after the new jump.  */\n-  last = next_nonnote_insn (src1->end);\n-  if (!last || GET_CODE (last) != BARRIER)\n-    emit_barrier_after (src1->end);\n-\n-  /* Update CFG.  */\n-  while (src1->succ)\n-    remove_edge (src1->succ);\n-  make_single_succ_edge (src1, redirect_to, 0);\n-\n-  update_forwarder_flag (src1);\n+  update_forwarder_flag (redirect_from);\n \n   return true;\n }"}]}