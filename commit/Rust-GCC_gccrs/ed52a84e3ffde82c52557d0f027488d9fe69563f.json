{"sha": "ed52a84e3ffde82c52557d0f027488d9fe69563f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWQ1MmE4NGUzZmZkZTgyYzUyNTU3ZDBmMDI3NDg4ZDlmZTY5NTYzZg==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2013-06-08T18:37:40Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2013-06-08T18:37:40Z"}, "message": "re PR rtl-optimization/57559 (S/390: ICE with lra)\n\n2013-06-08  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/57559\n\t* lra-constraints.c (process_alt_operands): Don't discourage\n\tmemory with known offset for offsetable memory constraint.\n\t* lra.c (lra_emit_add): Exchange y and z for 2-op add insn.\n\n2013-06-08  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/57559\n\t* gcc.target/s390/pr57559.c : New test.\n\nFrom-SVN: r199859", "tree": {"sha": "ab8306145143473f85493065bdb87f06d1bef071", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab8306145143473f85493065bdb87f06d1bef071"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ed52a84e3ffde82c52557d0f027488d9fe69563f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed52a84e3ffde82c52557d0f027488d9fe69563f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed52a84e3ffde82c52557d0f027488d9fe69563f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed52a84e3ffde82c52557d0f027488d9fe69563f/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7b91690215d275028eacf31f75a22aaa9bc4f3b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b91690215d275028eacf31f75a22aaa9bc4f3b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b91690215d275028eacf31f75a22aaa9bc4f3b2"}], "stats": {"total": 53, "additions": 41, "deletions": 12}, "files": [{"sha": "12d773c50b7a0c0e443d47f04d462b6f99e12ae0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ed52a84e3ffde82c52557d0f027488d9fe69563f", "patch": "@@ -1,3 +1,10 @@\n+2013-06-08  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/57559\n+\t* lra-constraints.c (process_alt_operands): Don't discourage\n+\tmemory with known offset for offsetable memory constraint.\n+\t* lra.c (lra_emit_add): Exchange y and z for 2-op add insn.\n+\n 2013-06-08  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* varasm.c (struct oc_local_state): Reorder fields."}, {"sha": "ed84d9568cfffa5f39fe053097269dc4e9cc1a9b", "filename": "gcc/lra-constraints.c", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Flra-constraints.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Flra-constraints.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-constraints.c?ref=ed52a84e3ffde82c52557d0f027488d9fe69563f", "patch": "@@ -1997,15 +1997,8 @@ process_alt_operands (int only_alternative)\n \t\t\t      (op, this_alternative) == NO_REGS))))\n \t\treject += LRA_MAX_REJECT;\n \n-\t      if (MEM_P (op) && offmemok)\n-\t\t{\n-\t\t  /* If we know offset and this non-offsetable memory,\n-\t\t     something wrong with this memory and it is better\n-\t\t     to try other memory possibilities.  */\n-\t\t  if (MEM_OFFSET_KNOWN_P (op))\n-\t\t    reject += LRA_MAX_REJECT;\n-\t\t}\n-\t      else if (! (const_to_mem && constmemok))\n+\t      if (! (MEM_P (op) && offmemok)\n+\t\t  && ! (const_to_mem && constmemok))\n \t\t{\n \t\t  /* We prefer to reload pseudos over reloading other\n \t\t     things, since such reloads may be able to be"}, {"sha": "51f17072317497cda1fe157e87946542e8a3a7e9", "filename": "gcc/lra.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Flra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Flra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra.c?ref=ed52a84e3ffde82c52557d0f027488d9fe69563f", "patch": "@@ -306,11 +306,11 @@ lra_emit_add (rtx x, rtx y, rtx z)\n \t  || (disp != NULL_RTX && ! CONSTANT_P (disp))\n \t  || (scale != NULL_RTX && ! CONSTANT_P (scale)))\n \t{\n-\t  /* Its is not an address generation.\tProbably we have no 3 op\n+\t  /* It is not an address generation.\tProbably we have no 3 op\n \t     add.  Last chance is to use 2-op add insn.\t */\n \t  lra_assert (x != y && x != z);\n-\t  emit_move_insn (x, z);\n-\t  insn = gen_add2_insn (x, y);\n+\t  emit_move_insn (x, y);\n+\t  insn = gen_add2_insn (x, z);\n \t  emit_insn (insn);\n \t}\n       else"}, {"sha": "b8fe362cfa054adba8261fc2d49827712fea018f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ed52a84e3ffde82c52557d0f027488d9fe69563f", "patch": "@@ -1,3 +1,8 @@\n+2013-06-08  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/57559\n+\t* gcc.target/s390/pr57559.c : New test.\n+\n 2013-06-08  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/37336"}, {"sha": "15c3878c4cfaa4154641f7d5ce612774db7238de", "filename": "gcc/testsuite/gcc.target/s390/pr57559.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fpr57559.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed52a84e3ffde82c52557d0f027488d9fe69563f/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fpr57559.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fs390%2Fpr57559.c?ref=ed52a84e3ffde82c52557d0f027488d9fe69563f", "patch": "@@ -0,0 +1,24 @@\n+/* PR rtl-optimization/57559  */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-march=z10 -m64 -mzarch  -O1\" } */\n+\n+typedef int int32_t;\n+typedef unsigned char uint8_t;\n+typedef unsigned int uint32_t;\n+struct _IO_marker\n+{\n+};\n+static const int32_t mfcone = 1;\n+static const uint8_t *mfctop = (const uint8_t *) &mfcone;\n+int32_t\n+decContextTestEndian (uint8_t quiet)\n+{\n+  int32_t res = 0;\n+  uint32_t dle = (uint32_t) 0;\n+  if (*(int *) 10 != 0)\n+    {\n+      res = (int32_t) * mfctop - dle;\n+    }\n+  return res;\n+}"}]}