{"sha": "6bc85e79525c2b226121dbcc8e15824f7d44f055", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmJjODVlNzk1MjVjMmIyMjYxMjFkYmNjOGUxNTgyNGY3ZDQ0ZjA1NQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-19T23:27:01Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-19T23:27:01Z"}, "message": "(integrate_decl_tree): Only set DECL_ABSTRACT_ORIGIN if the decl\nreturned by pushdecl is the one we started with.\n\nFrom-SVN: r10018", "tree": {"sha": "c07c8e60173ae55dbf015fef35e583083f8534c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c07c8e60173ae55dbf015fef35e583083f8534c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6bc85e79525c2b226121dbcc8e15824f7d44f055", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6bc85e79525c2b226121dbcc8e15824f7d44f055", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6bc85e79525c2b226121dbcc8e15824f7d44f055", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6bc85e79525c2b226121dbcc8e15824f7d44f055/comments", "author": null, "committer": null, "parents": [{"sha": "4ff0a1d8d927b110c0581da7339a23af61c7a5ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ff0a1d8d927b110c0581da7339a23af61c7a5ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ff0a1d8d927b110c0581da7339a23af61c7a5ae"}], "stats": {"total": 13, "additions": 10, "deletions": 3}, "files": [{"sha": "525977acecaec431b94d65ca1cb9e2c941df10f2", "filename": "gcc/integrate.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6bc85e79525c2b226121dbcc8e15824f7d44f055/gcc%2Fintegrate.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6bc85e79525c2b226121dbcc8e15824f7d44f055/gcc%2Fintegrate.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintegrate.c?ref=6bc85e79525c2b226121dbcc8e15824f7d44f055", "patch": "@@ -1968,6 +1968,7 @@ integrate_decl_tree (let, level, map)\n   for (t = BLOCK_VARS (let); t; t = TREE_CHAIN (t))\n     {\n       tree d;\n+      tree newd;\n \n       push_obstacks_nochange ();\n       saveable_allocation ();\n@@ -1986,13 +1987,19 @@ integrate_decl_tree (let, level, map)\n \t}\n       /* These args would always appear unused, if not for this.  */\n       TREE_USED (d) = 1;\n-      /* Prevent warning for shadowing with these.  */\n-      DECL_ABSTRACT_ORIGIN (d) = t;\n \n       if (DECL_LANG_SPECIFIC (d))\n \tcopy_lang_decl (d);\n \n-      pushdecl (d);\n+      newd = pushdecl (d);\n+\n+      /* If the decl we get back is the copy of 't' that we started with,\n+\t then set the DECL_ABSTRACT_ORIGIN.  Otherwise, we must have a\n+\t duplicate decl, and we got the older one back.  In that case, setting\n+\t DECL_ABSTRACT_ORIGIN is not appropriate.  */\n+      if (newd == d)\n+\t/* Prevent warning for shadowing with these.  */\n+\tDECL_ABSTRACT_ORIGIN (d) = t;\n     }\n \n   for (t = BLOCK_SUBBLOCKS (let); t; t = TREE_CHAIN (t))"}]}