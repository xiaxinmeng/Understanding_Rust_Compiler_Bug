{"sha": "38ec83b17afd5769823418e574240eb81ec8e44a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzhlYzgzYjE3YWZkNTc2OTgyMzQxOGU1NzQyNDBlYjgxZWM4ZTQ0YQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2002-08-31T02:29:20Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2002-08-31T02:29:20Z"}, "message": "c-objc-common.c: Include target.h.\n\n        * c-objc-common.c: Include target.h.\n        (c_cannot_inline_tree_fn): Don't auto-inline functions that\n        don't bind locally.  Factor setting DECL_UNINLINABLE.\n        * Makefile.in (c-objc-common.o): Update.\n\nFrom-SVN: r56691", "tree": {"sha": "75cc0661da5e3cdaa70bac03cc91d7ba06f5a96b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/75cc0661da5e3cdaa70bac03cc91d7ba06f5a96b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/38ec83b17afd5769823418e574240eb81ec8e44a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38ec83b17afd5769823418e574240eb81ec8e44a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38ec83b17afd5769823418e574240eb81ec8e44a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38ec83b17afd5769823418e574240eb81ec8e44a/comments", "author": null, "committer": null, "parents": [{"sha": "03296d1c22a05defd0ad10620369df3e88658505", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03296d1c22a05defd0ad10620369df3e88658505", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03296d1c22a05defd0ad10620369df3e88658505"}], "stats": {"total": 39, "additions": 22, "deletions": 17}, "files": [{"sha": "c47b260ead28142794bd8082bc5947e2a483e9df", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38ec83b17afd5769823418e574240eb81ec8e44a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38ec83b17afd5769823418e574240eb81ec8e44a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=38ec83b17afd5769823418e574240eb81ec8e44a", "patch": "@@ -1,3 +1,10 @@\n+2002-08-30  Richard Henderson  <rth@redhat.com>\n+\n+\t* c-objc-common.c: Include target.h.\n+\t(c_cannot_inline_tree_fn): Don't auto-inline functions that\n+\tdon't bind locally.  Factor setting DECL_UNINLINABLE.\n+\t* Makefile.in (c-objc-common.o): Update.\n+\n 2002-08-30  Janis Johnson  <janis187@us.ibm.com>\n \n \t* doc/install.texi (Configuration, Building): Fix a typo and"}, {"sha": "a02fdc9db271e87725e9c92577379f3ebf4f83d3", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38ec83b17afd5769823418e574240eb81ec8e44a/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38ec83b17afd5769823418e574240eb81ec8e44a/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=38ec83b17afd5769823418e574240eb81ec8e44a", "patch": "@@ -1190,7 +1190,7 @@ c-lex.o : c-lex.c $(CONFIG_H) $(SYSTEM_H) $(TREE_H) $(RTL_H) \\\n c-objc-common.o : c-objc-common.c $(CONFIG_H) $(SYSTEM_H) $(TREE_H) \\\n     $(C_TREE_H) $(RTL_H) insn-config.h integrate.h $(EXPR_H) $(C_TREE_H) \\\n     flags.h toplev.h tree-inline.h diagnostic.h integrate.h $(VARRAY_H) \\\n-    langhooks.h $(GGC_H) gt-c-objc-common.h\n+    langhooks.h $(GGC_H) gt-c-objc-common.h $(TARGET_H)\n c-aux-info.o : c-aux-info.c  $(CONFIG_H) $(SYSTEM_H) $(TREE_H) $(C_TREE_H) \\\n     flags.h toplev.h\n c-convert.o : c-convert.c $(CONFIG_H) $(SYSTEM_H) $(TREE_H) flags.h toplev.h \\"}, {"sha": "30c85148db7d3a8f5e31b015d995d29c8b1a32da", "filename": "gcc/c-objc-common.c", "status": "modified", "additions": 14, "deletions": 16, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/38ec83b17afd5769823418e574240eb81ec8e44a/gcc%2Fc-objc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/38ec83b17afd5769823418e574240eb81ec8e44a/gcc%2Fc-objc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-objc-common.c?ref=38ec83b17afd5769823418e574240eb81ec8e44a", "patch": "@@ -34,6 +34,7 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n #include \"varray.h\"\n #include \"ggc.h\"\n #include \"langhooks.h\"\n+#include \"target.h\"\n \n static bool c_tree_printer PARAMS ((output_buffer *, text_info *));\n static tree inline_forbidden_p PARAMS ((tree *, int *, void *));\n@@ -150,11 +151,13 @@ c_cannot_inline_tree_fn (fnp)\n       && lookup_attribute (\"always_inline\", DECL_ATTRIBUTES (fn)) == NULL)\n     return 1;\n \n+  /* Don't auto-inline anything that might not be bound within \n+     this unit of translation.  */\n+  if (!DECL_DECLARED_INLINE_P (fn) && !(*targetm.binds_local_p) (fn))\n+    goto cannot_inline;\n+\n   if (! function_attribute_inlinable_p (fn))\n-    {\n-      DECL_UNINLINABLE (fn) = 1;\n-      return 1;\n-    }\n+    goto cannot_inline;\n \n   /* If a function has pending sizes, we must not defer its\n      compilation, and we can't inline it as a tree.  */\n@@ -164,21 +167,15 @@ c_cannot_inline_tree_fn (fnp)\n       put_pending_sizes (t);\n \n       if (t)\n-\t{\n-\t  DECL_UNINLINABLE (fn) = 1;\n-\t  return 1;\n-\t}\n+\tgoto cannot_inline;\n     }\n \n   if (DECL_CONTEXT (fn))\n     {\n       /* If a nested function has pending sizes, we may have already\n          saved them.  */\n       if (DECL_LANG_SPECIFIC (fn)->pending_sizes)\n-\t{\n-\t  DECL_UNINLINABLE (fn) = 1;\n-\t  return 1;\n-\t}\n+\tgoto cannot_inline;\n     }\n   else\n     {\n@@ -201,12 +198,13 @@ c_cannot_inline_tree_fn (fnp)\n     }\n     \n   if (walk_tree (&DECL_SAVED_TREE (fn), inline_forbidden_p, fn, NULL))\n-    {\n-      DECL_UNINLINABLE (fn) = 1;\n-      return 1;\n-    }\n+    goto cannot_inline;\n \n   return 0;\n+\n+ cannot_inline:\n+  DECL_UNINLINABLE (fn) = 1;\n+  return 1;\n }\n \n /* Called from check_global_declarations.  */"}]}