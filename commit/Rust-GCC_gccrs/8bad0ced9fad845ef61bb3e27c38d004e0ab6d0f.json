{"sha": "8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGJhZDBjZWQ5ZmFkODQ1ZWY2MWJiM2UyN2MzOGQwMDRlMGFiNmQwZg==", "commit": {"author": {"name": "Andrey Belevantsev", "email": "abel@ispras.ru", "date": "2019-04-01T16:32:24Z"}, "committer": {"name": "Alexander Monakov", "email": "amonakov@gcc.gnu.org", "date": "2019-04-01T16:32:24Z"}, "message": "sel-sched: update liveness in redirect_edge_and_branch hooks (PR 86928)\n\n2019-04-01  Andrey Belevantsev  <abel@ispras.ru>\n\n\tPR rtl-optimization/86928\n\t* sel-sched-ir.c (sel_redirect_edge_and_branch_force): Invoke\n\tcompute_live if necessary.\n\t(sel_redirect_edge_and_branch): Likewise.\n\n\t* gcc.dg/pr86928.c: New test.\n\nFrom-SVN: r270061", "tree": {"sha": "79a64bb099de3cc7e50973fe262ceb4de2c694a4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/79a64bb099de3cc7e50973fe262ceb4de2c694a4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/comments", "author": {"login": "abonzo", "id": 20396542, "node_id": "MDQ6VXNlcjIwMzk2NTQy", "avatar_url": "https://avatars.githubusercontent.com/u/20396542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abonzo", "html_url": "https://github.com/abonzo", "followers_url": "https://api.github.com/users/abonzo/followers", "following_url": "https://api.github.com/users/abonzo/following{/other_user}", "gists_url": "https://api.github.com/users/abonzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/abonzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abonzo/subscriptions", "organizations_url": "https://api.github.com/users/abonzo/orgs", "repos_url": "https://api.github.com/users/abonzo/repos", "events_url": "https://api.github.com/users/abonzo/events{/privacy}", "received_events_url": "https://api.github.com/users/abonzo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0d2a576a1417b8d4526d369fef1d87cee2c49f99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d2a576a1417b8d4526d369fef1d87cee2c49f99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d2a576a1417b8d4526d369fef1d87cee2c49f99"}], "stats": {"total": 41, "additions": 41, "deletions": 0}, "files": [{"sha": "9afd09bd7d9421f6fcb10e91eee0d3c9fed8ecae", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "patch": "@@ -1,3 +1,10 @@\n+2019-04-01  Andrey Belevantsev  <abel@ispras.ru>\n+\n+\tPR rtl-optimization/86928\n+\t* sel-sched-ir.c (sel_redirect_edge_and_branch_force): Invoke\n+\tcompute_live if necessary.\n+\t(sel_redirect_edge_and_branch): Likewise.\n+\n 2019-04-01  Vladimir Makarov  <vmakarov@redhat.com>\n \n \tPR rtl-optimization/89865"}, {"sha": "6dec1beaa04632e05c70ec1251416ce0ffeae5f4", "filename": "gcc/sel-sched-ir.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2Fsel-sched-ir.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2Fsel-sched-ir.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched-ir.c?ref=8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "patch": "@@ -5637,6 +5637,8 @@ sel_redirect_edge_and_branch_force (edge e, basic_block to)\n \t\t\t   recompute_dominator (CDI_DOMINATORS, to));\n   set_immediate_dominator (CDI_DOMINATORS, orig_dest,\n \t\t\t   recompute_dominator (CDI_DOMINATORS, orig_dest));\n+  if (jump && sel_bb_head_p (jump))\n+    compute_live (jump);\n }\n \n /* A wrapper for redirect_edge_and_branch.  Return TRUE if blocks connected by\n@@ -5697,6 +5699,8 @@ sel_redirect_edge_and_branch (edge e, basic_block to)\n       set_immediate_dominator (CDI_DOMINATORS, orig_dest,\n                                recompute_dominator (CDI_DOMINATORS, orig_dest));\n     }\n+  if (jump && sel_bb_head_p (jump))\n+    compute_live (jump);\n   return recompute_toporder_p;\n }\n "}, {"sha": "d194f4d88d41e5fc2cc183848971f5a4e3f16402", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "patch": "@@ -1,3 +1,8 @@\n+2019-04-01  Andrey Belevantsev  <abel@ispras.ru>\n+\n+\tPR rtl-optimization/86928\n+\t* gcc.dg/pr86928.c: New test.\n+\n 2019-04-01  Andrey Belevantsev  <abel@ispras.ru>\n \n \tPR rtl-optimization/87273"}, {"sha": "1586a36f9458b427c99cf70fedf609390e14df63", "filename": "gcc/testsuite/gcc.dg/pr86928.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2Ftestsuite%2Fgcc.dg%2Fpr86928.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f/gcc%2Ftestsuite%2Fgcc.dg%2Fpr86928.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr86928.c?ref=8bad0ced9fad845ef61bb3e27c38d004e0ab6d0f", "patch": "@@ -0,0 +1,25 @@\n+/* { dg-do compile { target powerpc*-*-* ia64-*-* i?86-*-* x86_64-*-* } } */\n+/* { dg-options \"-O2 -fnon-call-exceptions -fsel-sched-pipelining -fsel-sched-pipelining-outer-loops -fselective-scheduling -fno-if-conversion -fno-tree-dce -w\" } */\n+/* { dg-additional-options \"-m32\" { target powerpc*-*-* } } */\n+\n+int kn;\n+\n+void\n+gd (short int sk)\n+{\n+  char *as;\n+\n+  while (sk < 1)\n+    {\n+      char *ci;\n+\n+      if (*ci == 0)\n+        *as += ci;\n+\n+      for (kn = 0; kn < 18; ++kn)\n+        {\n+        }\n+\n+      ++sk;\n+    }\n+}"}]}