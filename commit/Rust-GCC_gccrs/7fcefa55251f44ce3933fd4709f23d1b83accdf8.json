{"sha": "7fcefa55251f44ce3933fd4709f23d1b83accdf8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2ZjZWZhNTUyNTFmNDRjZTM5MzNmZDQ3MDlmMjNkMWI4M2FjY2RmOA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2011-11-08T10:23:53Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2011-11-08T10:23:53Z"}, "message": "re PR c++/50864 (ICE with decltype and \"declval\" from another namespace)\n\n/cp\n2011-11-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/50864\n\t* parser.c (cp_parser_postfix_dot_deref_expression): Reject invalid\n\tuses of '->' and '.' as postfix-expression in namespace scope.\n\n/testsuite\n2011-11-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/50864\n\t* g++.dg/parse/template26.C: New.\n\t* g++.dg/template/crash45.C: Adjust dg-error string.\n\nFrom-SVN: r181151", "tree": {"sha": "39b0e29d39ac466b25e2858b4fdd2c26bedf6590", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/39b0e29d39ac466b25e2858b4fdd2c26bedf6590"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7fcefa55251f44ce3933fd4709f23d1b83accdf8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fcefa55251f44ce3933fd4709f23d1b83accdf8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fcefa55251f44ce3933fd4709f23d1b83accdf8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fcefa55251f44ce3933fd4709f23d1b83accdf8/comments", "author": null, "committer": null, "parents": [{"sha": "295258228b461ae1ec71bd52d52759946a83faf4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/295258228b461ae1ec71bd52d52759946a83faf4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/295258228b461ae1ec71bd52d52759946a83faf4"}], "stats": {"total": 47, "additions": 42, "deletions": 5}, "files": [{"sha": "5a492e9ca2023d755c2635778fb461dd6cc0fd52", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7fcefa55251f44ce3933fd4709f23d1b83accdf8", "patch": "@@ -1,3 +1,9 @@\n+2011-11-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/50864\n+\t* parser.c (cp_parser_postfix_dot_deref_expression): Reject invalid\n+\tuses of '->' and '.' as postfix-expression in namespace scope.\n+\n 2011-11-07  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/50848"}, {"sha": "7d04971eea5ded73edd2b35fc44c04f42ee47e71", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=7fcefa55251f44ce3933fd4709f23d1b83accdf8", "patch": "@@ -5969,10 +5969,17 @@ cp_parser_postfix_dot_deref_expression (cp_parser *parser,\n \t{\n \t  if (name != error_mark_node && !BASELINK_P (name) && parser->scope)\n \t    {\n-\t      name = build_qualified_name (/*type=*/NULL_TREE,\n-\t\t\t\t\t   parser->scope,\n-\t\t\t\t\t   name,\n-\t\t\t\t\t   template_p);\n+\t      if (TREE_CODE (parser->scope) == NAMESPACE_DECL)\n+\t\t{\n+\t\t  error_at (token->location, \"%<%D::%D%> is not a class member\",\n+\t\t\t    parser->scope, name);\n+\t\t  postfix_expression = error_mark_node;\n+\t\t}\n+\t      else\n+\t\tname = build_qualified_name (/*type=*/NULL_TREE,\n+\t\t\t\t\t     parser->scope,\n+\t\t\t\t\t     name,\n+\t\t\t\t\t     template_p);\n \t      parser->scope = NULL_TREE;\n \t      parser->qualifying_scope = NULL_TREE;\n \t      parser->object_scope = NULL_TREE;"}, {"sha": "12ad3d45dc7bc2ca8f01af1f66945ec53c18d36b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7fcefa55251f44ce3933fd4709f23d1b83accdf8", "patch": "@@ -1,3 +1,9 @@\n+2011-11-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/50864\n+\t* g++.dg/parse/template26.C: New.\n+\t* g++.dg/template/crash45.C: Adjust dg-error string.\n+\n 2011-11-07  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/50848"}, {"sha": "aab9763ccaf60715585bd138c4c599fb1be6cdc9", "filename": "gcc/testsuite/g++.dg/parse/template26.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate26.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate26.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate26.C?ref=7fcefa55251f44ce3933fd4709f23d1b83accdf8", "patch": "@@ -0,0 +1,18 @@\n+// PR c++/50864\n+\n+namespace impl\n+{\n+  template <class T> T create();\n+}\n+\n+template <class T, class U, __SIZE_TYPE__\n+\t  = sizeof(impl::create<T>()->*impl::create<U>())>\n+struct foo1;\n+\n+template <class T, class U, __SIZE_TYPE__\n+\t  = sizeof(impl::create<T>()->impl::create<U>())> // { dg-error \"not a class member\" }\n+struct foo2;\n+\n+template <class T, class U, __SIZE_TYPE__\n+\t  = sizeof(impl::create<T>().impl::create<U>())> // { dg-error \"not a class member\" }\n+struct foo3;"}, {"sha": "f67fd022f63061157779424b60e9e5ae68120061", "filename": "gcc/testsuite/g++.dg/template/crash45.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash45.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fcefa55251f44ce3933fd4709f23d1b83accdf8/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash45.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash45.C?ref=7fcefa55251f44ce3933fd4709f23d1b83accdf8", "patch": "@@ -9,5 +9,5 @@ namespace N\n \n void bar(A *p)\n {\n-  p->N::foo<0>; // { dg-error \"not a member\" } \n+  p->N::foo<0>; // { dg-error \"not a class member\" }\n }"}]}