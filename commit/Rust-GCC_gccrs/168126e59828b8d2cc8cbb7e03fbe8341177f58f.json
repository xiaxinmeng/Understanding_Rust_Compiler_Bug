{"sha": "168126e59828b8d2cc8cbb7e03fbe8341177f58f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTY4MTI2ZTU5ODI4YjhkMmNjOGNiYjdlMDNmYmU4MzQxMTc3ZjU4Zg==", "commit": {"author": {"name": "Mark Wielaard", "email": "mark@klomp.org", "date": "2016-11-15T19:31:59Z"}, "committer": {"name": "Mark Wielaard", "email": "mark@gcc.gnu.org", "date": "2016-11-15T19:31:59Z"}, "message": "libiberty: demangler crash with missing :? or fold expression component.\n\nWhen constructing an :? or fold expression that requires a third\nexpression only the first and second were explicitly checked to\nnot be NULL. Since the third expression is also required in these\nconstructs it needs to be explicitly checked and rejected when missing.\nOtherwise the demangler will crash once it tries to d_print the\nNULL component. Added two examples to demangle-expected of strings\nthat would crash before this fix.\n\nFound by American Fuzzy Lop (afl) fuzzer.\n\nFrom-SVN: r242451", "tree": {"sha": "8f5009b475fabf82e2a02e550cfd3e7eac405f5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8f5009b475fabf82e2a02e550cfd3e7eac405f5d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/168126e59828b8d2cc8cbb7e03fbe8341177f58f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/168126e59828b8d2cc8cbb7e03fbe8341177f58f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/168126e59828b8d2cc8cbb7e03fbe8341177f58f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/168126e59828b8d2cc8cbb7e03fbe8341177f58f/comments", "author": null, "committer": null, "parents": [{"sha": "0d0bfbf47c67397b8380d5cd47aec8429888b196", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d0bfbf47c67397b8380d5cd47aec8429888b196", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d0bfbf47c67397b8380d5cd47aec8429888b196"}], "stats": {"total": 19, "additions": 19, "deletions": 0}, "files": [{"sha": "8b52166bcca5e3d5446f6b655e954344f596a46d", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/168126e59828b8d2cc8cbb7e03fbe8341177f58f/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/168126e59828b8d2cc8cbb7e03fbe8341177f58f/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=168126e59828b8d2cc8cbb7e03fbe8341177f58f", "patch": "@@ -1,3 +1,10 @@\n+2016-11-15  Mark Wielaard  <mark@klomp.org>\n+\n+\t* cp-demangle.c (d_expression_1): Make sure third expression\n+\texists for ?: and fold expressions.\n+\t* testsuite/demangle-expected: Add examples of strings that could\n+\tcrash the demangler because of missing expression.\n+\n 2016-11-14  Mark Wielaard  <mark@klomp.org>\n \n \t* cplus-dem.c (demangle_signature): After 'H', template function,"}, {"sha": "45663fe8b0dc8c8eb5d5abf96b191b1aff83247f", "filename": "libiberty/cp-demangle.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/168126e59828b8d2cc8cbb7e03fbe8341177f58f/libiberty%2Fcp-demangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/168126e59828b8d2cc8cbb7e03fbe8341177f58f/libiberty%2Fcp-demangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fcp-demangle.c?ref=168126e59828b8d2cc8cbb7e03fbe8341177f58f", "patch": "@@ -3415,13 +3415,17 @@ d_expression_1 (struct d_info *di)\n \t\tfirst = d_expression_1 (di);\n \t\tsecond = d_expression_1 (di);\n \t\tthird = d_expression_1 (di);\n+\t\tif (third == NULL)\n+\t\t  return NULL;\n \t      }\n \t    else if (code[0] == 'f')\n \t      {\n \t\t/* fold-expression.  */\n \t\tfirst = d_operator_name (di);\n \t\tsecond = d_expression_1 (di);\n \t\tthird = d_expression_1 (di);\n+\t\tif (third == NULL)\n+\t\t  return NULL;\n \t      }\n \t    else if (code[0] == 'n')\n \t      {"}, {"sha": "af491d8196ef99dffc2d807366665c86c101ae8e", "filename": "libiberty/testsuite/demangle-expected", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/168126e59828b8d2cc8cbb7e03fbe8341177f58f/libiberty%2Ftestsuite%2Fdemangle-expected", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/168126e59828b8d2cc8cbb7e03fbe8341177f58f/libiberty%2Ftestsuite%2Fdemangle-expected", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Ftestsuite%2Fdemangle-expected?ref=168126e59828b8d2cc8cbb7e03fbe8341177f58f", "patch": "@@ -4626,3 +4626,11 @@ _$_H1R\n # Could crash\n _Q8ccQ4M2e.\n _Q8ccQ4M2e.\n+\n+# fold-expression with missing third component could crash.\n+_Z12binary_rightIJLi1ELi2ELi3EEEv1AIXfRplT_LiEEE\n+_Z12binary_rightIJLi1ELi2ELi3EEEv1AIXfRplT_LiEEE\n+\n+# ?: expression with missing third component could crash.\n+AquT_quT_4mxautouT_4mxxx\n+AquT_quT_4mxautouT_4mxxx"}]}