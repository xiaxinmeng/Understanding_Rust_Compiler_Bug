{"sha": "2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmIxOGViMzI3Y2U4YmJlMjRlOTQ4OTE4YzhiZjA0ZTQ4ZTNjYWRkOA==", "commit": {"author": {"name": "Mingjie Xing", "email": "mingjie.xing@gmail.com", "date": "2011-01-04T02:53:50Z"}, "committer": {"name": "Mingjie Xing", "email": "xmj@gcc.gnu.org", "date": "2011-01-04T02:53:50Z"}, "message": "Add the pipeline description for Loongson3A.\n\nFrom-SVN: r168452", "tree": {"sha": "3ed94e6435ba784b783fae93c4670e161bed0615", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3ed94e6435ba784b783fae93c4670e161bed0615"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/comments", "author": {"login": "xingmingjie", "id": 7777963, "node_id": "MDQ6VXNlcjc3Nzc5NjM=", "avatar_url": "https://avatars.githubusercontent.com/u/7777963?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xingmingjie", "html_url": "https://github.com/xingmingjie", "followers_url": "https://api.github.com/users/xingmingjie/followers", "following_url": "https://api.github.com/users/xingmingjie/following{/other_user}", "gists_url": "https://api.github.com/users/xingmingjie/gists{/gist_id}", "starred_url": "https://api.github.com/users/xingmingjie/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xingmingjie/subscriptions", "organizations_url": "https://api.github.com/users/xingmingjie/orgs", "repos_url": "https://api.github.com/users/xingmingjie/repos", "events_url": "https://api.github.com/users/xingmingjie/events{/privacy}", "received_events_url": "https://api.github.com/users/xingmingjie/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5e7e855011f4d62892afecf915ff6fc6e9315142", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e7e855011f4d62892afecf915ff6fc6e9315142", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e7e855011f4d62892afecf915ff6fc6e9315142"}], "stats": {"total": 147, "additions": 146, "deletions": 1}, "files": [{"sha": "f22250bffe4b771f411edc19ce0ad074657a1a0e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "patch": "@@ -1,3 +1,10 @@\n+2011-01-04  Mingjie Xing  <mingjie.xing@gmail.com>\n+\n+\t* config/mips/loongson3a.md: New file.\n+\t* config/mips/mips.md: Include loongson3a.md.\n+\t* config/mips/mips.c (mips_multipass_dfa_lookahead): Return 4 when\n+\tTUNE_LOONGSON_3A.\n+\n 2011-01-03  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR middle-end/47017"}, {"sha": "c584f42f0e04552dadc6ed62dd9e30bdef715ee1", "filename": "gcc/config/mips/loongson3a.md", "status": "added", "additions": 137, "deletions": 0, "changes": 137, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2Fconfig%2Fmips%2Floongson3a.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2Fconfig%2Fmips%2Floongson3a.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Floongson3a.md?ref=2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "patch": "@@ -0,0 +1,137 @@\n+;; Pipeline model for Loongson-3A cores.\n+\n+;; Copyright (C) 2011 Free Software Foundation, Inc.\n+;;\n+;; This file is part of GCC.\n+;;\n+;; GCC is free software; you can redistribute it and/or modify it\n+;; under the terms of the GNU General Public License as published\n+;; by the Free Software Foundation; either version 3, or (at your\n+;; option) any later version.\n+;;\n+;; GCC is distributed in the hope that it will be useful, but WITHOUT\n+;; ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+;; or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public\n+;; License for more details.\n+;;\n+;; You should have received a copy of the GNU General Public License\n+;; along with GCC; see the file COPYING3.  If not see\n+;; <http://www.gnu.org/licenses/>.\n+\n+;; Uncomment the following line to output automata for debugging.\n+;; (automata_option \"v\")\n+\n+;; Automaton for integer instructions.\n+(define_automaton \"ls3a_a_alu\")\n+\n+;; Automaton for floating-point instructions.\n+(define_automaton \"ls3a_a_falu\")\n+\n+;; Automaton for memory operations.\n+(define_automaton \"ls3a_a_mem\")\n+\n+;; Describe the resources.\n+\n+(define_cpu_unit \"ls3a_alu1\" \"ls3a_a_alu\")\n+(define_cpu_unit \"ls3a_alu2\" \"ls3a_a_alu\")\n+(define_cpu_unit \"ls3a_mem\" \"ls3a_a_mem\")\n+(define_cpu_unit \"ls3a_falu1\" \"ls3a_a_falu\")\n+(define_cpu_unit \"ls3a_falu2\" \"ls3a_a_falu\")\n+\n+;; Describe instruction reservations.\n+\n+(define_insn_reservation \"ls3a_arith\" 1\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"arith,clz,const,logical,\n+                        move,nop,shift,signext,slt\"))\n+  \"ls3a_alu1 | ls3a_alu2\")\n+\n+(define_insn_reservation \"ls3a_branch\" 1\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"branch,jump,call,condmove,trap\"))\n+  \"ls3a_alu1\")\n+\n+(define_insn_reservation \"ls3a_mfhilo\" 1\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"mfhilo,mthilo\"))\n+  \"ls3a_alu2\")\n+\n+;; Operation imul3nc is fully pipelined.\n+(define_insn_reservation \"ls3a_imul3nc\" 5\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"imul3nc\"))\n+  \"ls3a_alu2\")\n+ \n+(define_insn_reservation \"ls3a_imul\" 7\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"imul,imadd\"))\n+  \"ls3a_alu2 * 7\")\n+ \n+(define_insn_reservation \"ls3a_idiv_si\" 12\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (and (eq_attr \"type\" \"idiv\")\n+            (eq_attr \"mode\" \"SI\")))\n+  \"ls3a_alu2 * 12\")\n+\n+(define_insn_reservation \"ls3a_idiv_di\" 25\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (and (eq_attr \"type\" \"idiv\")\n+            (eq_attr \"mode\" \"DI\")))\n+  \"ls3a_alu2 * 25\")\n+\n+(define_insn_reservation \"ls3a_load\" 3\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"load\"))\n+  \"ls3a_mem\")\n+ \n+(define_insn_reservation \"ls3a_fpload\" 4\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"load,mfc,mtc\"))\n+  \"ls3a_mem\")\n+\n+(define_insn_reservation \"ls3a_prefetch\" 0\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"prefetch,prefetchx\"))\n+  \"ls3a_mem\")\n+ \n+(define_insn_reservation \"ls3a_store\" 0\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"store,fpstore,fpidxstore\"))\n+  \"ls3a_mem\")\n+\n+;; All the fp operations can be executed in FALU1.  Only fp add,\n+;; sub, mul, madd can be executed in FALU2.  Try FALU2 firstly.\n+(define_insn_reservation \"ls3a_fadd\" 6\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"fadd,fmul,fmadd\"))\n+  \"ls3a_falu2 | ls3a_falu1\")\n+\n+(define_insn_reservation \"ls3a_fcmp\" 2\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"fabs,fcmp,fmove,fneg\"))\n+  \"ls3a_falu1\")\n+\n+(define_insn_reservation \"ls3a_fcvt\" 4\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"fcvt\"))\n+  \"ls3a_falu1\")\n+\n+(define_insn_reservation \"ls3a_fdiv_sf\" 12\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (and (eq_attr \"type\" \"fdiv,frdiv,fsqrt,frsqrt\")\n+            (eq_attr \"mode\" \"SF\")))\n+  \"ls3a_falu1 * 12\")\n+ \n+(define_insn_reservation \"ls3a_fdiv_df\" 19\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (and (eq_attr \"type\" \"fdiv,frdiv,fsqrt,frsqrt\")\n+            (eq_attr \"mode\" \"DF\")))\n+  \"ls3a_falu1 * 19\")\n+\n+;; Force single-dispatch for unknown or multi.\n+(define_insn_reservation \"ls3a_unknown\" 1\n+  (and (eq_attr \"cpu\" \"loongson_3a\")\n+       (eq_attr \"type\" \"unknown,multi\"))\n+  \"ls3a_alu1 + ls3a_alu2 + ls3a_falu1 + ls3a_falu2 + ls3a_mem\")\n+\n+;; End of DFA-based pipeline description for loongson_3a"}, {"sha": "357054691925ea04c35271fee6027e588474c7ed", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "patch": "@@ -12154,7 +12154,7 @@ mips_multipass_dfa_lookahead (void)\n   if (TUNE_SB1)\n     return 4;\n \n-  if (TUNE_LOONGSON_2EF)\n+  if (TUNE_LOONGSON_2EF || TUNE_LOONGSON_3A)\n     return 4;\n \n   if (TUNE_OCTEON)"}, {"sha": "08837804221df00beaadf1ef71f1f2ba7b0a26ce", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2b18eb327ce8bbe24e948918c8bf04e48e3cadd8/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=2b18eb327ce8bbe24e948918c8bf04e48e3cadd8", "patch": "@@ -908,6 +908,7 @@\n (include \"9000.md\")\n (include \"10000.md\")\n (include \"loongson2ef.md\")\n+(include \"loongson3a.md\")\n (include \"octeon.md\")\n (include \"sb1.md\")\n (include \"sr71k.md\")"}]}