{"sha": "61a36e0df4c8372e2e0383a62649c15f5adddca2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjFhMzZlMGRmNGM4MzcyZTJlMDM4M2E2MjY0OWMxNWY1YWRkZGNhMg==", "commit": {"author": {"name": "Kyle Galloway", "email": "kgallowa@redhat.com", "date": "2007-03-06T18:22:28Z"}, "committer": {"name": "Kyle Galloway", "email": "kgallowa@gcc.gnu.org", "date": "2007-03-06T18:22:28Z"}, "message": "jvmti.cc (_Jv_JVMTI_GetLocalVariableTable): Fix _Jv_Malloc parameters.\n\n2007-03-06  Kyle Galloway  <kgallowa@redhat.com>\n\t* jvmti.cc(_Jv_JVMTI_GetLocalVariableTable): Fix _Jv_Malloc parameters.\n\t* testsuite/libjava.jvmti/interp/natgetlocalvartable.cc\n\t(do_getlocalvartable_tests): Add Deallocate calls to free strings.\n\nFrom-SVN: r122630", "tree": {"sha": "9fe206fae105ae05d810fe654bdf04bb62da04cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9fe206fae105ae05d810fe654bdf04bb62da04cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/61a36e0df4c8372e2e0383a62649c15f5adddca2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61a36e0df4c8372e2e0383a62649c15f5adddca2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61a36e0df4c8372e2e0383a62649c15f5adddca2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61a36e0df4c8372e2e0383a62649c15f5adddca2/comments", "author": null, "committer": null, "parents": [{"sha": "4ba851b58beb3102b31fb4282fdea684dfa6865a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ba851b58beb3102b31fb4282fdea684dfa6865a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ba851b58beb3102b31fb4282fdea684dfa6865a"}], "stats": {"total": 28, "additions": 18, "deletions": 10}, "files": [{"sha": "b44c352d60e338ebec4ff4771480c3197a3245b6", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61a36e0df4c8372e2e0383a62649c15f5adddca2/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61a36e0df4c8372e2e0383a62649c15f5adddca2/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=61a36e0df4c8372e2e0383a62649c15f5adddca2", "patch": "@@ -1,3 +1,8 @@\n+2007-03-06  Kyle Galloway  <kgallowa@redhat.com>\n+\t* jvmti.cc(_Jv_JVMTI_GetLocalVariableTable): Fix _Jv_Malloc parameters.\n+\t* testsuite/libjava.jvmti/interp/natgetlocalvartable.cc\n+\t(do_getlocalvartable_tests): Add Deallocate calls to free strings.\n+\n 2007-03-05  Matthias Klose  <doko@debian.org>\n \n \t* Makefile.am (gij_LDFLAGS): Use dbexecdir."}, {"sha": "068878793d5b2146d10c0923cb220babc4d4ff8b", "filename": "libjava/jvmti.cc", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61a36e0df4c8372e2e0383a62649c15f5adddca2/libjava%2Fjvmti.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61a36e0df4c8372e2e0383a62649c15f5adddca2/libjava%2Fjvmti.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjvmti.cc?ref=61a36e0df4c8372e2e0383a62649c15f5adddca2", "patch": "@@ -997,23 +997,23 @@ _Jv_JVMTI_GetLocalVariableTable (MAYBE_UNUSED jvmtiEnv *env, jmethodID method,\n                                  table_slot) \n             >= 0)\n     {\n+      char **str_ptr = &(*locals)[table_slot].name;\n       jerr = env->Allocate (static_cast<jlong> (strlen (name) + 1),\n-                             reinterpret_cast<unsigned char **>\n-                               (&(*locals)[table_slot].name));\n+                             reinterpret_cast<unsigned char **> (str_ptr));\n       if (jerr != JVMTI_ERROR_NONE)\n         return jerr;\n       strcpy ((*locals)[table_slot].name, name);\n-\n-      jerr = env->Allocate (static_cast<jlong> (strlen (name) + 1),\n-                               reinterpret_cast<unsigned char **>\n-                                 (&(*locals)[table_slot].signature));\n+      \n+      str_ptr = &(*locals)[table_slot].signature;\n+      jerr = env->Allocate (static_cast<jlong> (strlen (sig) + 1),\n+                               reinterpret_cast<unsigned char **> (str_ptr));\n       if (jerr != JVMTI_ERROR_NONE)\n         return jerr;\n       strcpy ((*locals)[table_slot].signature, sig);\n-  \n-      jerr = env->Allocate (static_cast<jlong> (strlen (name) + 1),\n-                               reinterpret_cast<unsigned char **>\n-                               (&(*locals)[table_slot].generic_signature));\n+      \n+      str_ptr = &(*locals)[table_slot].generic_signature;\n+      jerr = env->Allocate (static_cast<jlong> (strlen (generic_sig) + 1),\n+                               reinterpret_cast<unsigned char **> (str_ptr));\n       if (jerr != JVMTI_ERROR_NONE)\n         return jerr;\n       strcpy ((*locals)[table_slot].generic_signature, generic_sig);"}, {"sha": "8899bac3b87e0fa1321d5a582ae4addd0ca54296", "filename": "libjava/testsuite/libjava.jvmti/interp/natgetlocalvartable.cc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61a36e0df4c8372e2e0383a62649c15f5adddca2/libjava%2Ftestsuite%2Flibjava.jvmti%2Finterp%2Fnatgetlocalvartable.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61a36e0df4c8372e2e0383a62649c15f5adddca2/libjava%2Ftestsuite%2Flibjava.jvmti%2Finterp%2Fnatgetlocalvartable.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jvmti%2Finterp%2Fnatgetlocalvartable.cc?ref=61a36e0df4c8372e2e0383a62649c15f5adddca2", "patch": "@@ -53,8 +53,11 @@ JNIEXPORT jint JNICALL Java_getlocalvartable_do_1getlocalvartable_1tests\n             {\n               printf (\"Slot: %d\\n\", static_cast<int> (var_table[j].slot));\n               printf (\"  Name: %s\\n\", var_table[j].name);\n+              jvmti->Deallocate (reinterpret_cast<unsigned char *> (var_table[j].name));\n               printf (\"  Sig: %s\\n\", var_table[j].signature);\n+              jvmti->Deallocate (reinterpret_cast<unsigned char *> (var_table[j].signature));\n               printf (\"  Gen Sig: %s\\n\", var_table[j].generic_signature);\n+              jvmti->Deallocate (reinterpret_cast<unsigned char *> (var_table[j].generic_signature));\n               printf (\"  Start Loc: %ld\\n\", static_cast<long> (var_table[j].start_location));\n               printf (\"  Length: %d\\n\", static_cast<int> (var_table[j].length));\n             }"}]}