{"sha": "66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjZmYWVkNzY0MzcxZmU2Mzg1ZDU0ZDZlN2RjMGE5Y2IwZmE1YzY3Zg==", "commit": {"author": {"name": "Daniel Franke", "email": "franke.daniel@gmail.com", "date": "2010-05-19T12:55:26Z"}, "committer": {"name": "Daniel Franke", "email": "dfranke@gcc.gnu.org", "date": "2010-05-19T12:55:26Z"}, "message": "re PR fortran/38404 (Warning message identifies incorrect line)\n\ngcc/fortran/:\n2010-05-19  Daniel Franke  <franke.daniel@gmail.com>\n\n\tPR fortran/38404\n\t* primary.c (match_string_constant): Move start_locus just inside \n\tthe string.\n\t* data.c (create_character_intializer): Clarified truncation warning.\n\ngcc/testsuite/:\n2010-05-19  Daniel Franke  <franke.daniel@gmail.com>\n\n\tPR fortran/38404\n\t* gfortran.dg/data_char_1.f90: Updated warning message.\n\t* gfortran.dg/data_array_6.f: New.\n\nFrom-SVN: r159561", "tree": {"sha": "d49ae3e63ba3e59b31cb9720298cce5bd6cf56f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d49ae3e63ba3e59b31cb9720298cce5bd6cf56f9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/comments", "author": {"login": "dfranke76", "id": 15729164, "node_id": "MDQ6VXNlcjE1NzI5MTY0", "avatar_url": "https://avatars.githubusercontent.com/u/15729164?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dfranke76", "html_url": "https://github.com/dfranke76", "followers_url": "https://api.github.com/users/dfranke76/followers", "following_url": "https://api.github.com/users/dfranke76/following{/other_user}", "gists_url": "https://api.github.com/users/dfranke76/gists{/gist_id}", "starred_url": "https://api.github.com/users/dfranke76/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dfranke76/subscriptions", "organizations_url": "https://api.github.com/users/dfranke76/orgs", "repos_url": "https://api.github.com/users/dfranke76/repos", "events_url": "https://api.github.com/users/dfranke76/events{/privacy}", "received_events_url": "https://api.github.com/users/dfranke76/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "749aa96dabbb0fef0d81b382a49849186f907d95", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/749aa96dabbb0fef0d81b382a49849186f907d95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/749aa96dabbb0fef0d81b382a49849186f907d95"}], "stats": {"total": 48, "additions": 40, "deletions": 8}, "files": [{"sha": "b9a986ed05c8e105e2b40249de6306d5daf53536", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "patch": "@@ -1,3 +1,10 @@\n+2010-05-19  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/38404\n+\t* primary.c (match_string_constant): Move start_locus just inside \n+\tthe string.\n+\t* data.c (create_character_intializer): Clarified truncation warning.\n+\n 2010-05-19  Daniel Franke  <franke.daniel@gmail.com>\n \n \tPR fortran/34505"}, {"sha": "6561cdc338c148c7d6256c85283154e23c579002", "filename": "gcc/fortran/data.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ffortran%2Fdata.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ffortran%2Fdata.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdata.c?ref=66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "patch": "@@ -154,9 +154,10 @@ create_character_intializer (gfc_expr *init, gfc_typespec *ts,\n \n   if (len > end - start)\n     {\n+      gfc_warning_now (\"Initialization string starting at %L was \"\n+\t\t       \"truncated to fit the variable (%d/%d)\",\n+\t\t       &rvalue->where, end - start, len);\n       len = end - start;\n-      gfc_warning_now (\"initialization string truncated to match variable \"\n-\t\t       \"at %L\", &rvalue->where);\n     }\n \n   if (rvalue->ts.type == BT_HOLLERITH)"}, {"sha": "09f4eb1c6d49c2c6c66d2013c71dff9a5308dc21", "filename": "gcc/fortran/primary.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ffortran%2Fprimary.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ffortran%2Fprimary.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fprimary.c?ref=66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "patch": "@@ -868,12 +868,11 @@ match_string_constant (gfc_expr **result)\n \n   gfc_gobble_whitespace ();\n \n-  start_locus = gfc_current_locus;\n-\n   c = gfc_next_char ();\n   if (c == '\\'' || c == '\"')\n     {\n       kind = gfc_default_character_kind;\n+      start_locus = gfc_current_locus;\n       goto got_delim;\n     }\n \n@@ -917,12 +916,13 @@ match_string_constant (gfc_expr **result)\n     goto no_match;\n \n   gfc_gobble_whitespace ();\n-  start_locus = gfc_current_locus;\n \n   c = gfc_next_char ();\n   if (c != '\\'' && c != '\"')\n     goto no_match;\n \n+  start_locus = gfc_current_locus;\n+\n   if (kind == -1)\n     {\n       q = gfc_extract_int (sym->value, &kind);\n@@ -976,7 +976,6 @@ match_string_constant (gfc_expr **result)\n   e->ts.is_iso_c = 0;\n \n   gfc_current_locus = start_locus;\n-  gfc_next_char ();\t\t/* Skip delimiter */\n \n   /* We disable the warning for the following loop as the warning has already\n      been printed in the loop above.  */"}, {"sha": "f18f56f2fa4cd91bafd19381ac87d002fd24bbb3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "patch": "@@ -1,3 +1,9 @@\n+2010-05-19  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/38404\n+\t* gfortran.dg/data_char_1.f90: Updated warning message.\n+\t* gfortran.dg/data_array_6.f: New.\n+\n 2010-05-19  Martin Jambor  <mjambor@suse.cz>\n \n \t* g++.dg/ipa/ivinline-8.C: New test."}, {"sha": "6564402f1e9eeba8049ce77629724332860cc742", "filename": "gcc/testsuite/gfortran.dg/data_array_6.f", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_array_6.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_array_6.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_array_6.f?ref=66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "patch": "@@ -0,0 +1,19 @@\n+! { dg-do \"compile\" }\n+!\n+! PR fortran/38404 - location marker in wrong line\n+! Testcase contributed by Steve Chapel <steve DOT chapel AT a2pg DOT com>\n+!\n+\n+      CHARACTER(len=72) TEXT(3)\n+      DATA (TEXT(I),I=1,3)/\n+     &'a string without issues',\n+     &'a string with too many characters properly broken into the next\n+     &line but too long to fit the variable',\n+     &                                                                '\n+     &a string that started just at the end of the last line -- some \n+     &may not be helped'/\n+\n+      ! { dg-warning \"truncated\" \"\" { target *-*-* } 10 }\n+      ! { dg-warning \"truncated\" \"\" { target *-*-* } 12 }\n+\n+      END"}, {"sha": "96db4fd30eb7b9cbea8f28ea48b21d5602ade8d7", "filename": "gcc/testsuite/gfortran.dg/data_char_1.f90", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_char_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66faed764371fe6385d54d6e7dc0a9cb0fa5c67f/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_char_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_char_1.f90?ref=66faed764371fe6385d54d6e7dc0a9cb0fa5c67f", "patch": "@@ -5,9 +5,9 @@\n program data_char_1\n   character(len=5) :: a(2)\n   character(len=5) :: b(2)\n-  data a /'Hellow', 'orld'/       ! { dg-warning \"string truncated\" }\n+  data a /'Hellow', 'orld'/       ! { dg-warning \"truncated\" }\n   data b(:)(1:4), b(1)(5:5), b(2)(5:5) &\n-      /'abcdefg', 'hi', 'j', 'k'/ ! { dg-warning \"string truncated\" }\n+      /'abcdefg', 'hi', 'j', 'k'/ ! { dg-warning \"truncated\" }\n   \n   if ((a(1) .ne. 'Hello') .or. (a(2) .ne. 'orld ')) call abort\n   if ((b(1) .ne. 'abcdj') .or. (b(2) .ne. 'hi  k')) call abort"}]}