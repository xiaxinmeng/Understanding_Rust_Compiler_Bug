{"sha": "a125de0cbf0106312c61b65872eec96a9f28f5d4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTEyNWRlMGNiZjAxMDYzMTJjNjFiNjU4NzJlZWM5NmE5ZjI4ZjVkNA==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2007-09-06T18:38:49Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2007-09-06T18:38:49Z"}, "message": "re PR c++/32674 (ICE in lvalue_p_1 initialising static variable inside template class)\n\n/cp\n2007-09-06  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR c++/32674\n\t* decl.c (cp_finish_decl): When processing_template_decl,\n\tdeal correctly with init as TREE_LIST.\n\n/testsuite\n2007-09-06  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR c++/32674\n\t* g++.dg/template/static31.C: New.\n\nFrom-SVN: r128201", "tree": {"sha": "285b9d3567dee4c834ac3ad4c250a9fe0f90759f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/285b9d3567dee4c834ac3ad4c250a9fe0f90759f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a125de0cbf0106312c61b65872eec96a9f28f5d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a125de0cbf0106312c61b65872eec96a9f28f5d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a125de0cbf0106312c61b65872eec96a9f28f5d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a125de0cbf0106312c61b65872eec96a9f28f5d4/comments", "author": null, "committer": null, "parents": [{"sha": "566dfd713db9d71de2e1ff4ee176df4aacda7e6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/566dfd713db9d71de2e1ff4ee176df4aacda7e6f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/566dfd713db9d71de2e1ff4ee176df4aacda7e6f"}], "stats": {"total": 46, "additions": 45, "deletions": 1}, "files": [{"sha": "2c3533d8ea1fa4b4a7dcd085fdca6f386c4566f5", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a125de0cbf0106312c61b65872eec96a9f28f5d4", "patch": "@@ -1,3 +1,9 @@\n+2007-09-06  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR c++/32674\n+\t* decl.c (cp_finish_decl): When processing_template_decl,\n+\tdeal correctly with init as TREE_LIST.\n+\n 2007-09-06  Tom Tromey  <tromey@redhat.com>\n \n \t* decl.c (finish_function): Put return's location on line zero of"}, {"sha": "271b8e6885f6c3607f7bd6c438e6e3f2b7b5c95b", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=a125de0cbf0106312c61b65872eec96a9f28f5d4", "patch": "@@ -5333,7 +5333,21 @@ cp_finish_decl (tree decl, tree init, bool init_const_expr_p,\n \t  goto finish_end;\n \t}\n \n-      init = fold_non_dependent_expr (init);\n+      if (TREE_CODE (init) == TREE_LIST)\n+\t{\n+\t  /* If the parenthesized-initializer form was used (e.g.,\n+\t     \"int A<N>::i(X)\"), then INIT will be a TREE_LIST of initializer\n+\t     arguments.  (There is generally only one.)  We convert them\n+\t     individually.  */\n+\t  tree list = init;\n+\t  for (; list; list = TREE_CHAIN (list))\n+\t    {\n+\t      tree elt = TREE_VALUE (list);\n+\t      TREE_VALUE (list) = fold_non_dependent_expr (elt);\n+\t    }\n+\t}\n+      else\n+\tinit = fold_non_dependent_expr (init);\n       processing_template_decl = 0;\n     }\n "}, {"sha": "de450f6ca034da374feecf36253bf75f022ef1cf", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a125de0cbf0106312c61b65872eec96a9f28f5d4", "patch": "@@ -1,3 +1,8 @@\n+2007-09-06  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR c++/32674\n+\t* g++.dg/template/static31.C: New.\n+\n 2007-09-06  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/33271"}, {"sha": "935a8a790fa464813f6bdc867f258dd6db3a169d", "filename": "gcc/testsuite/g++.dg/template/static31.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic31.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a125de0cbf0106312c61b65872eec96a9f28f5d4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic31.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fstatic31.C?ref=a125de0cbf0106312c61b65872eec96a9f28f5d4", "patch": "@@ -0,0 +1,19 @@\n+// PR c++/32674\n+\n+class C\n+{\n+  static const int j = 3;\n+};\n+\n+template<int> class A\n+{\n+  static const int i1;\n+  static const int i2;\n+  static const int i3;\n+  static const int i4;\n+};\n+\n+template<int N> const int A<N>::i1(C::j);\n+template<int N> const int A<N>::i2 = C::j;\n+template<int N> const int A<N>::i3(C::j, 5); // { dg-error \"compound expression\" }\n+template<int N> const int A<N>::i4 = (C::j, 7);"}]}