{"sha": "dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGNiM2E3YjYyYjkxY2Y4OTBjM2JjOTFiNGZhZjNlNzM0M2I2Y2I0Mg==", "commit": {"author": {"name": "Mark Wielaard", "email": "mark@klomp.org", "date": "2021-05-22T01:11:39Z"}, "committer": {"name": "Mark Wielaard", "email": "mark@klomp.org", "date": "2021-05-22T01:11:39Z"}, "message": "Fix aarch64 config for rust\n\nDefine aarch64_rust_target_cpu_info in aarch64-protos.h.\nAARCH64_ISA_V8_1 isn't defined directly, check aarch64_isa_flags.", "tree": {"sha": "d5de447b943108c4a334b80cf8dbabc3f48be5b6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d5de447b943108c4a334b80cf8dbabc3f48be5b6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42/comments", "author": null, "committer": null, "parents": [{"sha": "99b73780e6e30f962c01532d3ec189ceeecf7f93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99b73780e6e30f962c01532d3ec189ceeecf7f93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99b73780e6e30f962c01532d3ec189ceeecf7f93"}], "stats": {"total": 5, "additions": 4, "deletions": 1}, "files": [{"sha": "86c2d49db902f33a02b9788e2592ffe3ef78a02b", "filename": "gcc/config/aarch64/aarch64-protos.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42/gcc%2Fconfig%2Faarch64%2Faarch64-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42/gcc%2Fconfig%2Faarch64%2Faarch64-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-protos.h?ref=dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42", "patch": "@@ -786,6 +786,9 @@ std::string aarch64_get_extension_string_for_isa_flags (uint64_t, uint64_t);\n /* Defined in aarch64-d.c  */\n extern void aarch64_d_target_versions (void);\n \n+/* In aarch64-rust.c  */\n+extern void aarch64_rust_target_cpu_info (void);\n+\n rtl_opt_pass *make_pass_fma_steering (gcc::context *);\n rtl_opt_pass *make_pass_track_speculation (gcc::context *);\n rtl_opt_pass *make_pass_tag_collision_avoidance (gcc::context *);"}, {"sha": "2ecc53afea490b0f42f88210d9560af4ab6d6d16", "filename": "gcc/config/aarch64/aarch64-rust.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42/gcc%2Fconfig%2Faarch64%2Faarch64-rust.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42/gcc%2Fconfig%2Faarch64%2Faarch64-rust.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-rust.c?ref=dcb3a7b62b91cf890c3bc91b4faf3e7343b6cb42", "patch": "@@ -55,7 +55,7 @@ void aarch64_rust_target_cpu_info(void) {\n         rust_add_target_info(\"target_feature\", \"rcpc\");\n     if (TARGET_DOTPROD)\n         rust_add_target_info(\"target_feature\", \"dotprod\");\n-    if (AARCH64_ISA_V8_1)\n+    if (aarch64_isa_flags & AARCH64_FL_V8_2)\n         rust_add_target_info(\"target_feature\", \"v8.1a\");\n     if (AARCH64_ISA_V8_2)\n         rust_add_target_info(\"target_feature\", \"v8.2a\");"}]}