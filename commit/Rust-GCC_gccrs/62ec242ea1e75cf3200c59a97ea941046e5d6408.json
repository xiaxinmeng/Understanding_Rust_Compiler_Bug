{"sha": "62ec242ea1e75cf3200c59a97ea941046e5d6408", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjJlYzI0MmVhMWU3NWNmMzIwMGM1OWE5N2VhOTQxMDQ2ZTVkNjQwOA==", "commit": {"author": {"name": "Jozef Lawrynowicz", "email": "jozef.l@mittosystems.com", "date": "2019-11-04T12:41:56Z"}, "committer": {"name": "Jozef Lawrynowicz", "email": "jozefl@gcc.gnu.org", "date": "2019-11-04T12:41:56Z"}, "message": "libgcc: Fix incorrect use of USE_TM_CLONE_REGISTRY\n\n2019-11-04  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n\n\t* crtstuff.c: Define USE_TM_CLONE_REGISTRY to 0 if it's undefined and\n\tthe target output object format is not ELF.\n\ts/defined(USE_TM_CLONE_REGISTRY)/USE_TM_CLONE_REGISTRY.\n\nFrom-SVN: r277775", "tree": {"sha": "7ddd9ea89e7e001d57c82db5c113aca55b8d8508", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7ddd9ea89e7e001d57c82db5c113aca55b8d8508"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/62ec242ea1e75cf3200c59a97ea941046e5d6408", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62ec242ea1e75cf3200c59a97ea941046e5d6408", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62ec242ea1e75cf3200c59a97ea941046e5d6408", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62ec242ea1e75cf3200c59a97ea941046e5d6408/comments", "author": {"login": "jozefl-mitto", "id": 36524004, "node_id": "MDQ6VXNlcjM2NTI0MDA0", "avatar_url": "https://avatars.githubusercontent.com/u/36524004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jozefl-mitto", "html_url": "https://github.com/jozefl-mitto", "followers_url": "https://api.github.com/users/jozefl-mitto/followers", "following_url": "https://api.github.com/users/jozefl-mitto/following{/other_user}", "gists_url": "https://api.github.com/users/jozefl-mitto/gists{/gist_id}", "starred_url": "https://api.github.com/users/jozefl-mitto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jozefl-mitto/subscriptions", "organizations_url": "https://api.github.com/users/jozefl-mitto/orgs", "repos_url": "https://api.github.com/users/jozefl-mitto/repos", "events_url": "https://api.github.com/users/jozefl-mitto/events{/privacy}", "received_events_url": "https://api.github.com/users/jozefl-mitto/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "02afb6a9321fbfb435452636cedc2cd43f0c4fd2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02afb6a9321fbfb435452636cedc2cd43f0c4fd2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02afb6a9321fbfb435452636cedc2cd43f0c4fd2"}], "stats": {"total": 17, "additions": 11, "deletions": 6}, "files": [{"sha": "c528cec2db3fafaadd8ce964ca8acba0216e377d", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62ec242ea1e75cf3200c59a97ea941046e5d6408/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62ec242ea1e75cf3200c59a97ea941046e5d6408/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=62ec242ea1e75cf3200c59a97ea941046e5d6408", "patch": "@@ -1,3 +1,9 @@\n+2019-11-04  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n+\n+\t* crtstuff.c: Define USE_TM_CLONE_REGISTRY to 0 if it's undefined and\n+\tthe target output object format is not ELF.\n+\ts/defined(USE_TM_CLONE_REGISTRY)/USE_TM_CLONE_REGISTRY.\n+\n 2019-11-03  Oleg Endo  <olegendo@gcc.gnu.org>\n \n \tPR libgcc/78804"}, {"sha": "ae6328d317de8381c0a15c9a8b9d1043ae484281", "filename": "libgcc/crtstuff.c", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62ec242ea1e75cf3200c59a97ea941046e5d6408/libgcc%2Fcrtstuff.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62ec242ea1e75cf3200c59a97ea941046e5d6408/libgcc%2Fcrtstuff.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fcrtstuff.c?ref=62ec242ea1e75cf3200c59a97ea941046e5d6408", "patch": "@@ -153,6 +153,8 @@ call_ ## FUNC (void)\t\t\t\t\t\\\n \n #if !defined(USE_TM_CLONE_REGISTRY) && defined(OBJECT_FORMAT_ELF)\n # define USE_TM_CLONE_REGISTRY 1\n+#elif !defined(USE_TM_CLONE_REGISTRY)\n+# define USE_TM_CLONE_REGISTRY 0\n #endif\n \n /* We do not want to add the weak attribute to the declarations of these\n@@ -450,8 +452,7 @@ CRT_CALL_STATIC_FUNCTION (__LIBGCC_INIT_SECTION_ASM_OP__,\n \t\t\t  __do_global_dtors_aux_1)\n #endif\n \n-#if defined(USE_EH_FRAME_REGISTRY) \\\n-    || defined(USE_TM_CLONE_REGISTRY)\n+#if defined(USE_EH_FRAME_REGISTRY) || USE_TM_CLONE_REGISTRY\n /* Stick a call to __register_frame_info into the .init section.  For some\n    reason calls with no arguments work more reliably in .init, so stick the\n    call in another function.  */\n@@ -560,8 +561,7 @@ __do_global_dtors (void)\n #endif\n }\n \n-#if defined(USE_EH_FRAME_REGISTRY) \\\n-    || defined(USE_TM_CLONE_REGISTRY)\n+#if defined(USE_EH_FRAME_REGISTRY) || USE_TM_CLONE_REGISTRY\n /* A helper function for __do_global_ctors, which is in crtend.o.  Here\n    in crtbegin.o, we can reference a couple of symbols not visible there.\n    Plus, since we're before libgcc.a, we have no problems referencing\n@@ -733,8 +733,7 @@ void\n __do_global_ctors (void)\n {\n   func_ptr *p;\n-#if defined(USE_EH_FRAME_REGISTRY) \\\n-    || defined(USE_TM_CLONE_REGISTRY)\n+#if defined(USE_EH_FRAME_REGISTRY) || USE_TM_CLONE_REGISTRY\n   __do_global_ctors_1();\n #endif\n   for (p = __CTOR_END__ - 1; *p != (func_ptr) -1; p--)"}]}