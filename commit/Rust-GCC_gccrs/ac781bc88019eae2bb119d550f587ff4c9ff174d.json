{"sha": "ac781bc88019eae2bb119d550f587ff4c9ff174d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWM3ODFiYzg4MDE5ZWFlMmJiMTE5ZDU1MGY1ODdmZjRjOWZmMTc0ZA==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2019-05-17T14:13:43Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2019-05-17T14:13:43Z"}, "message": "Fix std::variant test for ILP32 targets\n\n\t* testsuite/20_util/variant/compile.cc: Fix narrowing test for ILP32\n\ttargets. Add more cases from P0608R3.\n\t* testsuite/20_util/variant/run.cc: Add more cases from P0608R3.\n\nFrom-SVN: r271325", "tree": {"sha": "664d5687a22e8960cd83248bfe0c488fb23d7265", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/664d5687a22e8960cd83248bfe0c488fb23d7265"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac781bc88019eae2bb119d550f587ff4c9ff174d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac781bc88019eae2bb119d550f587ff4c9ff174d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac781bc88019eae2bb119d550f587ff4c9ff174d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac781bc88019eae2bb119d550f587ff4c9ff174d/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "593cda3e61f6645d4999b7065b6f49ce631567a3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/593cda3e61f6645d4999b7065b6f49ce631567a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/593cda3e61f6645d4999b7065b6f49ce631567a3"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "1ba66d80a1522d091bc72b2200eca778fc8fc079", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac781bc88019eae2bb119d550f587ff4c9ff174d/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac781bc88019eae2bb119d550f587ff4c9ff174d/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=ac781bc88019eae2bb119d550f587ff4c9ff174d", "patch": "@@ -1,5 +1,9 @@\n 2019-05-17  Jonathan Wakely  <jwakely@redhat.com>\n \n+\t* testsuite/20_util/variant/compile.cc: Fix narrowing test for ILP32\n+\ttargets. Add more cases from P0608R3.\n+\t* testsuite/20_util/variant/run.cc: Add more cases from P0608R3.\n+\n \t* include/bits/random.h (seed_seq::param): Fix non-reserved name.\n \t* include/experimental/type_traits (is_detected_exact)\n \t(is_detected_exact_v): Likewise."}, {"sha": "dc3d4c2b3f142a8e0c0814514766f03017eb8e35", "filename": "libstdc++-v3/testsuite/20_util/variant/compile.cc", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac781bc88019eae2bb119d550f587ff4c9ff174d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac781bc88019eae2bb119d550f587ff4c9ff174d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc?ref=ac781bc88019eae2bb119d550f587ff4c9ff174d", "patch": "@@ -144,7 +144,15 @@ void arbitrary_ctor()\n   static_assert(noexcept(variant<int, DefaultNoexcept>(DefaultNoexcept{})));\n \n   // P0608R3 disallow narrowing conversions and boolean conversions\n-  static_assert(!is_constructible_v<variant<int>, long>);\n+  static_assert(!is_constructible_v<variant<float>, int>);\n+  static_assert(!is_constructible_v<variant<float, vector<int>>, int>);\n+  static_assert(is_constructible_v<variant<float, int>, char>);\n+  static_assert(!is_constructible_v<variant<float, char>, int>);\n+  static_assert(is_constructible_v<variant<float, long>, int>);\n+  struct big_int { big_int(int) { } };\n+  static_assert(is_constructible_v<variant<float, big_int>, int>);\n+\n+  static_assert(!is_constructible_v<variant<int>, unsigned>);\n   static_assert(!is_constructible_v<variant<bool>, int>);\n   static_assert(!is_constructible_v<variant<bool>, void*>);\n }"}, {"sha": "045e1f23ada14dbad53663cca4d152d14486b619", "filename": "libstdc++-v3/testsuite/20_util/variant/run.cc", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac781bc88019eae2bb119d550f587ff4c9ff174d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Frun.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac781bc88019eae2bb119d550f587ff4c9ff174d/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Frun.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Frun.cc?ref=ac781bc88019eae2bb119d550f587ff4c9ff174d", "patch": "@@ -128,6 +128,17 @@ void arbitrary_ctor()\n     VERIFY(y.index() == 1);\n     VERIFY(std::get<1>(y).d == d);\n   }\n+\n+  {\n+    // P0608R3\n+    variant<float, int> v1 = 'a';\n+    VERIFY(std::get<1>(v1) == int('a'));\n+    variant<float, long> v2 = 0;\n+    VERIFY(std::get<1>(v2) == 0L);\n+    struct big_int { big_int(int) { } };\n+    variant<float, big_int> v3 = 0;\n+    VERIFY(v3.index() == 1);\n+  }\n }\n \n struct ThrowingMoveCtorThrowsCopyCtor"}]}