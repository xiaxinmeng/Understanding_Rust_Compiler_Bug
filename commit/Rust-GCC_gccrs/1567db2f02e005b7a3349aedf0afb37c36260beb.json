{"sha": "1567db2f02e005b7a3349aedf0afb37c36260beb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTU2N2RiMmYwMmUwMDViN2EzMzQ5YWVkZjBhZmIzN2MzNjI2MGJlYg==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-10-21T21:12:05Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-10-21T21:12:05Z"}, "message": "fold-const.c (operand_equal_p): Add code matching empty constructors.\n\n\t* fold-const.c (operand_equal_p): Add code matching empty\n\tconstructors.\n\t* gcc.dg/tree-ssa/operand-equal-1.c: Verify that empty constructors\n\tare matched.\n\nFrom-SVN: r229147", "tree": {"sha": "d49fbba1fc1f57ae6b2bf82b7ae886bec54401ad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d49fbba1fc1f57ae6b2bf82b7ae886bec54401ad"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1567db2f02e005b7a3349aedf0afb37c36260beb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1567db2f02e005b7a3349aedf0afb37c36260beb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1567db2f02e005b7a3349aedf0afb37c36260beb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1567db2f02e005b7a3349aedf0afb37c36260beb/comments", "author": null, "committer": null, "parents": [{"sha": "c26065cc38586f9d014b0f04a54dfa0e52c23189", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c26065cc38586f9d014b0f04a54dfa0e52c23189", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c26065cc38586f9d014b0f04a54dfa0e52c23189"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "38ae32110db492b6fda6db6d7ab925d02d9682a3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1567db2f02e005b7a3349aedf0afb37c36260beb", "patch": "@@ -1,3 +1,8 @@\n+2015-10-11  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* fold-const.c (operand_equal_p): Add code matching empty\n+\tconstructors.\n+\n 2015-10-21  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* tree.def (CEIL_DIV_EXPR, FLOOR_DIV_EXPR, ROUND_DIV_EXPR): Tweak"}, {"sha": "602ea240cb4b148442890fff3b0358556f87d4ff", "filename": "gcc/fold-const.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=1567db2f02e005b7a3349aedf0afb37c36260beb", "patch": "@@ -2891,6 +2891,11 @@ operand_equal_p (const_tree arg0, const_tree arg1, unsigned int flags)\n \treturn operand_equal_p (TREE_OPERAND (arg0, 0), TREE_OPERAND (arg1, 0),\n \t\t\t\tflags | OEP_ADDRESS_OF\n \t\t\t\t| OEP_CONSTANT_ADDRESS_OF);\n+      case CONSTRUCTOR:\n+\t/* In GIMPLE empty constructors are allowed in initializers of\n+\t   aggregates.  */\n+\treturn (!vec_safe_length (CONSTRUCTOR_ELTS (arg0))\n+\t\t&& !vec_safe_length (CONSTRUCTOR_ELTS (arg1)));\n       default:\n \tbreak;\n       }"}, {"sha": "4637ae747e2059a2e273f7582128879ef4c5a6a3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1567db2f02e005b7a3349aedf0afb37c36260beb", "patch": "@@ -1,3 +1,8 @@\n+2015-10-11  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* gcc.dg/tree-ssa/operand-equal-1.c: Verify that empty constructors\n+\tare matched.\n+\n 2015-10-21  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* gcc.dg/lto/20110201-1_0.c: Restrict to sqrt_insn targets.\n@@ -21,6 +26,7 @@\n \n 2015-10-21  Marek Polacek  <polacek@redhat.com>\n \n+\n \tPR c/68024\n \t* gcc.dg/pr68024.c: New test.\n "}, {"sha": "09e9302ac16117f9d762af4437eedf605b83e9d3", "filename": "gcc/testsuite/gcc.dg/tree-ssa/operand-equal-1.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Foperand-equal-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1567db2f02e005b7a3349aedf0afb37c36260beb/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Foperand-equal-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Foperand-equal-1.c?ref=1567db2f02e005b7a3349aedf0afb37c36260beb", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-pre\" } */\n+struct a {int a,b;};\n+struct a ret(int val)\n+{\n+   return val? (struct a){} : (struct a){};\n+}\n+/* { dg-final { scan-tree-dump-not \"if \" \"pre\"} } */"}]}