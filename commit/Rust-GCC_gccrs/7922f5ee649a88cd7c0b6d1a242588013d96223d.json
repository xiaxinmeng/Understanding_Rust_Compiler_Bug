{"sha": "7922f5ee649a88cd7c0b6d1a242588013d96223d", "node_id": "C_kwDOANBUbNoAKDc5MjJmNWVlNjQ5YTg4Y2Q3YzBiNmQxYTI0MjU4ODAxM2Q5NjIyM2Q", "commit": {"author": {"name": "Dimitrije Milosevic", "email": "Dimitrije.Milosevic@Syrmia.com", "date": "2022-07-06T17:58:20Z"}, "committer": {"name": "Xi Ruoyao", "email": "xry111@xry111.site", "date": "2022-07-07T02:20:03Z"}, "message": "Mips: Fix the ASAN shadow offset hook for the n32 ABI\n\ngcc/ChangeLog:\n\n\t* config/mips/mips.cc (mips_asan_shadow_offset): Reformat\n\tto handle the N32 ABI.\n\t* config/mips/mips.h (SUBTARGET_SHADOW_OFFSET): Remove\n\tthe macro, as it is not needed anymore.", "tree": {"sha": "4706791ae3dcab174fe911e3b9ec9d20786d5620", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4706791ae3dcab174fe911e3b9ec9d20786d5620"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7922f5ee649a88cd7c0b6d1a242588013d96223d", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYKAB0WIQSR0PV2MB+STX3t3OisqtIOGecQ4wUCYsZC0wAKCRCsqtIOGecQ\n4/PlAP45XDe6YKoxtqTFPMwHCS8tbfZBtzLP6n0k+oijJRO/cQD+LhbJ3DyyLmPm\nxThwCK/g5uy2H9ehl2UNJN6IEW5TIgI=\n=h2lY\n-----END PGP SIGNATURE-----", "payload": "tree 4706791ae3dcab174fe911e3b9ec9d20786d5620\nparent ee915c72da2caf92697dbedf0d9d9730ce9aca7a\nauthor Dimitrije Milosevic <Dimitrije.Milosevic@Syrmia.com> 1657130300 +0800\ncommitter Xi Ruoyao <xry111@xry111.site> 1657160403 +0800\n\nMips: Fix the ASAN shadow offset hook for the n32 ABI\n\ngcc/ChangeLog:\n\n\t* config/mips/mips.cc (mips_asan_shadow_offset): Reformat\n\tto handle the N32 ABI.\n\t* config/mips/mips.h (SUBTARGET_SHADOW_OFFSET): Remove\n\tthe macro, as it is not needed anymore.\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7922f5ee649a88cd7c0b6d1a242588013d96223d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7922f5ee649a88cd7c0b6d1a242588013d96223d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7922f5ee649a88cd7c0b6d1a242588013d96223d/comments", "author": {"login": "dmilosevic141", "id": 86828432, "node_id": "MDQ6VXNlcjg2ODI4NDMy", "avatar_url": "https://avatars.githubusercontent.com/u/86828432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dmilosevic141", "html_url": "https://github.com/dmilosevic141", "followers_url": "https://api.github.com/users/dmilosevic141/followers", "following_url": "https://api.github.com/users/dmilosevic141/following{/other_user}", "gists_url": "https://api.github.com/users/dmilosevic141/gists{/gist_id}", "starred_url": "https://api.github.com/users/dmilosevic141/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dmilosevic141/subscriptions", "organizations_url": "https://api.github.com/users/dmilosevic141/orgs", "repos_url": "https://api.github.com/users/dmilosevic141/repos", "events_url": "https://api.github.com/users/dmilosevic141/events{/privacy}", "received_events_url": "https://api.github.com/users/dmilosevic141/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xry111", "id": 8733039, "node_id": "MDQ6VXNlcjg3MzMwMzk=", "avatar_url": "https://avatars.githubusercontent.com/u/8733039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xry111", "html_url": "https://github.com/xry111", "followers_url": "https://api.github.com/users/xry111/followers", "following_url": "https://api.github.com/users/xry111/following{/other_user}", "gists_url": "https://api.github.com/users/xry111/gists{/gist_id}", "starred_url": "https://api.github.com/users/xry111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xry111/subscriptions", "organizations_url": "https://api.github.com/users/xry111/orgs", "repos_url": "https://api.github.com/users/xry111/repos", "events_url": "https://api.github.com/users/xry111/events{/privacy}", "received_events_url": "https://api.github.com/users/xry111/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ee915c72da2caf92697dbedf0d9d9730ce9aca7a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee915c72da2caf92697dbedf0d9d9730ce9aca7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee915c72da2caf92697dbedf0d9d9730ce9aca7a"}], "stats": {"total": 14, "additions": 6, "deletions": 8}, "files": [{"sha": "e81a245dcf46e903eb9d254f20237d92e31eed9a", "filename": "gcc/config/mips/mips.cc", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7922f5ee649a88cd7c0b6d1a242588013d96223d/gcc%2Fconfig%2Fmips%2Fmips.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7922f5ee649a88cd7c0b6d1a242588013d96223d/gcc%2Fconfig%2Fmips%2Fmips.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.cc?ref=7922f5ee649a88cd7c0b6d1a242588013d96223d", "patch": "@@ -22743,7 +22743,12 @@ mips_constant_alignment (const_tree exp, HOST_WIDE_INT align)\n static unsigned HOST_WIDE_INT\n mips_asan_shadow_offset (void)\n {\n-  return SUBTARGET_SHADOW_OFFSET;\n+  if (mips_abi == ABI_N32)\n+    return (HOST_WIDE_INT_1 << 29);\n+  if (POINTER_SIZE == 64)\n+    return (HOST_WIDE_INT_1 << 37);\n+  else\n+    return HOST_WIDE_INT_C (0x0aaa0000);\n }\n \n /* Implement TARGET_STARTING_FRAME_OFFSET.  See mips_compute_frame_info"}, {"sha": "0029864fdcdf0b68a5467dcad9bdb991aae40fe1", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7922f5ee649a88cd7c0b6d1a242588013d96223d/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7922f5ee649a88cd7c0b6d1a242588013d96223d/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=7922f5ee649a88cd7c0b6d1a242588013d96223d", "patch": "@@ -3463,10 +3463,3 @@ struct GTY(())  machine_function {\n    && !TARGET_MICROMIPS && !TARGET_FIX_24K)\n \n #define NEED_INDICATE_EXEC_STACK 0\n-\n-/* Define the shadow offset for asan. Other OS's can override in the\n-   respective tm.h files.  */\n-#ifndef SUBTARGET_SHADOW_OFFSET\n-#define SUBTARGET_SHADOW_OFFSET \\\n-  (POINTER_SIZE == 64 ? HOST_WIDE_INT_1 << 37 : HOST_WIDE_INT_C (0x0aaa0000))\n-#endif"}]}