{"sha": "9092932bf8f827f52efbd55dc1ca78249d15a7b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTA5MjkzMmJmOGY4MjdmNTJlZmJkNTVkYzFjYTc4MjQ5ZDE1YTdiOQ==", "commit": {"author": {"name": "Roman Kennke", "email": "roman@kennke.org", "date": "2005-04-19T10:55:12Z"}, "committer": {"name": "Michael Koch", "email": "mkoch@gcc.gnu.org", "date": "2005-04-19T10:55:12Z"}, "message": "2005-04-19  Roman Kennke  <roman@kennke.org>\n\n\t* javax/swing/text/JTextComponent.java\n\t(JTextComponent): Added repaintListener which issues repaint\n\trequests when the underlying document changes.\n\t(setDocument): Adds repaintListener to document when the\n\tdocument is changed.\n\t* javax/swing/text/DefaultEditorKit.java:\n\tRemoved repaint calls on JTextComponent. This is now handled\n\tthrough a DocumentListener in JTextComponent that repaints\n\tthe component when needed.\n\nFrom-SVN: r98403", "tree": {"sha": "bbceff2b3a57d304b3fad36799cebf645405ee04", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bbceff2b3a57d304b3fad36799cebf645405ee04"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9092932bf8f827f52efbd55dc1ca78249d15a7b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9092932bf8f827f52efbd55dc1ca78249d15a7b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9092932bf8f827f52efbd55dc1ca78249d15a7b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9092932bf8f827f52efbd55dc1ca78249d15a7b9/comments", "author": null, "committer": null, "parents": [{"sha": "6384325b3a550af1fce10cec27a1df32e7f9e616", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6384325b3a550af1fce10cec27a1df32e7f9e616", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6384325b3a550af1fce10cec27a1df32e7f9e616"}], "stats": {"total": 41, "additions": 38, "deletions": 3}, "files": [{"sha": "49677a3bc740772d6715c5e59e88a5bffcff82f4", "filename": "libjava/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9092932bf8f827f52efbd55dc1ca78249d15a7b9/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9092932bf8f827f52efbd55dc1ca78249d15a7b9/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=9092932bf8f827f52efbd55dc1ca78249d15a7b9", "patch": "@@ -1,3 +1,15 @@\n+2005-04-19  Roman Kennke  <roman@kennke.org>\n+\n+\t* javax/swing/text/JTextComponent.java\n+\t(JTextComponent): Added repaintListener which issues repaint\n+\trequests when the underlying document changes.\n+\t(setDocument): Adds repaintListener to document when the\n+\tdocument is changed.\n+\t* javax/swing/text/DefaultEditorKit.java:\n+\tRemoved repaint calls on JTextComponent. This is now handled\n+\tthrough a DocumentListener in JTextComponent that repaints\n+\tthe component when needed.\n+\n 2005-04-19  Roman Kennke  <roman@kennke.org>\n \n \tPR libgcj/21064"}, {"sha": "891731f365a86ea98a2b7af7f3e5de4956187fbf", "filename": "libjava/javax/swing/text/DefaultEditorKit.java", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9092932bf8f827f52efbd55dc1ca78249d15a7b9/libjava%2Fjavax%2Fswing%2Ftext%2FDefaultEditorKit.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9092932bf8f827f52efbd55dc1ca78249d15a7b9/libjava%2Fjavax%2Fswing%2Ftext%2FDefaultEditorKit.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjavax%2Fswing%2Ftext%2FDefaultEditorKit.java?ref=9092932bf8f827f52efbd55dc1ca78249d15a7b9", "patch": "@@ -110,7 +110,6 @@ public void actionPerformed(ActionEvent event)\n               t.getDocument().insertString(t.getCaret().getDot(), event.getActionCommand(), null);\n               t.getCaret().setDot(Math.min(t.getCaret().getDot() + 1,\n                                            t.getDocument().getEndPosition().getOffset()));\n-              t.repaint();\n             }\n           catch (BadLocationException be)\n             {\n@@ -251,7 +250,6 @@ public void actionPerformed(ActionEvent event)\n                 if (pos < t.getDocument().getEndPosition().getOffset())\n                   {\n                     t.getDocument().remove(t.getCaret().getDot(), 1);\n-                    t.repaint();\n                   }\n               }\n             catch (BadLocationException e)\n@@ -275,7 +273,6 @@ public void actionPerformed(ActionEvent event)\n                   {\n                     t.getDocument().remove(pos - 1, 1);\n                     t.getCaret().setDot(pos - 1);\n-                    t.repaint();\n                   }\n               }\n             catch (BadLocationException e)"}, {"sha": "fa0040bfd4412eee97fe1097e12f793e22c536fd", "filename": "libjava/javax/swing/text/JTextComponent.java", "status": "modified", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9092932bf8f827f52efbd55dc1ca78249d15a7b9/libjava%2Fjavax%2Fswing%2Ftext%2FJTextComponent.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9092932bf8f827f52efbd55dc1ca78249d15a7b9/libjava%2Fjavax%2Fswing%2Ftext%2FJTextComponent.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjavax%2Fswing%2Ftext%2FJTextComponent.java?ref=9092932bf8f827f52efbd55dc1ca78249d15a7b9", "patch": "@@ -894,11 +894,30 @@ public Action[] getActions()\n   private Insets margin;\n   private boolean dragEnabled;\n \n+  /** Issues repaint request on document changes. */\n+  private DocumentListener repaintListener;\n+\n   /**\n    * Creates a new <code>JTextComponent</code> instance.\n    */\n   public JTextComponent()\n   {\n+    repaintListener = new DocumentListener()\n+      {\n+\tpublic void changedUpdate(DocumentEvent ev)\n+\t{\n+\t  repaint();\n+\t}\n+\tpublic void insertUpdate(DocumentEvent ev)\n+\t{\n+\t  repaint();\n+\t}\n+\tpublic void removeUpdate(DocumentEvent ev)\n+\t{\n+\t  repaint();\n+\t}\n+      };\n+\n     Keymap defkeymap = getKeymap(DEFAULT_KEYMAP);\n     boolean creatingKeymap = false;\n     if (defkeymap == null)\n@@ -932,6 +951,13 @@ public void setDocument(Document newDoc)\n   {\n     Document oldDoc = doc;\n     doc = newDoc;\n+\n+    // setup document listener\n+    if (oldDoc != null)\n+      oldDoc.removeDocumentListener(repaintListener);\n+    if (newDoc != null)\n+      newDoc.addDocumentListener(repaintListener);\n+\n     firePropertyChange(\"document\", oldDoc, newDoc);\n     revalidate();\n     repaint();"}]}