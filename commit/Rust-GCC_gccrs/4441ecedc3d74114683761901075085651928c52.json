{"sha": "4441ecedc3d74114683761901075085651928c52", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDQ0MWVjZWRjM2Q3NDExNDY4Mzc2MTkwMTA3NTA4NTY1MTkyOGM1Mg==", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2020-04-03T07:10:08Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2020-04-03T08:07:46Z"}, "message": "Fix PR94443 with gsi_insert_seq_before [PR94443]\n\nThis patch is to fix the stupid mistake by using\ngsi_insert_seq_before instead of gsi_insert_before.\n\nBTW, the regression testing on one x86_64 machine from CFarm is\nunable to reveal it (I guess due to native arch sandybridge?), so I\nspecified additional option -march=znver2 and verified the coverage.\n\nBootstrapped/regtested on powerpc64le-linux-gnu (P9) and\nx86_64-pc-linux-gnu, also verified the fail cases in related PRs.\n\n2020-04-03  Kewen Lin  <linkw@gcc.gnu.org>\n\ngcc/\n    PR tree-optimization/94443\n    * tree-vect-loop.c (vectorizable_live_operation): Use\n    gsi_insert_seq_before to replace gsi_insert_before.\n\ngcc/testsuite/\n    PR tree-optimization/94443\n    * gcc.dg/vect/pr94443.c: New test.", "tree": {"sha": "449a8666b1f7b8ac0bf188b7b107c4c3b88c58e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/449a8666b1f7b8ac0bf188b7b107c4c3b88c58e8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4441ecedc3d74114683761901075085651928c52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4441ecedc3d74114683761901075085651928c52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4441ecedc3d74114683761901075085651928c52", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4441ecedc3d74114683761901075085651928c52/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "55a7380213a5c16120d5c674fb42b38a3d796b57", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55a7380213a5c16120d5c674fb42b38a3d796b57", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55a7380213a5c16120d5c674fb42b38a3d796b57"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "472ce173ed2b1e9125867d3e91c1af78630d6c75", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4441ecedc3d74114683761901075085651928c52/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4441ecedc3d74114683761901075085651928c52/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4441ecedc3d74114683761901075085651928c52", "patch": "@@ -1,3 +1,9 @@\n+2020-04-03  Kewen Lin  <linkw@gcc.gnu.org>\n+\n+\tPR tree-optimization/94443\n+\t* tree-vect-loop.c (vectorizable_live_operation): Use\n+\tgsi_insert_seq_before to replace gsi_insert_before.\n+\n 2020-04-03  Martin Liska  <mliska@suse.cz>\n \n \tPR ipa/94445"}, {"sha": "927abc89b08018086ab7a22510532ea9bbc4f5a7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4441ecedc3d74114683761901075085651928c52/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4441ecedc3d74114683761901075085651928c52/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4441ecedc3d74114683761901075085651928c52", "patch": "@@ -1,3 +1,8 @@\n+2020-04-03  Kewen Lin  <linkw@gcc.gnu.org>\n+\n+\tPR tree-optimization/94443\n+\t* gcc.dg/vect/pr94443.c: New test.\n+\n 2020-04-02  Sandra Loosemore  <sandra@codesourcery.com>\n \n \t* lib/target-supports.exp (check_effective_target_sigsetjmp): Test"}, {"sha": "f8cbaf1b9ce9b6690f9794c5cb3aa6120a998d8e", "filename": "gcc/testsuite/gcc.dg/vect/pr94443.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4441ecedc3d74114683761901075085651928c52/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr94443.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4441ecedc3d74114683761901075085651928c52/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr94443.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr94443.c?ref=4441ecedc3d74114683761901075085651928c52", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-march=znver2\" { target { x86_64-*-* i?86-*-* } } } */\n+\n+/* Check it to be compiled successfully without any ICE.  */\n+\n+int a;\n+unsigned *b;\n+\n+void foo()\n+{\n+  for (unsigned i; i <= a; ++i, ++b)\n+    ;\n+}"}, {"sha": "265bcfdc5afb0eee59d734aa3262b2357047d717", "filename": "gcc/tree-vect-loop.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4441ecedc3d74114683761901075085651928c52/gcc%2Ftree-vect-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4441ecedc3d74114683761901075085651928c52/gcc%2Ftree-vect-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-loop.c?ref=4441ecedc3d74114683761901075085651928c52", "patch": "@@ -8050,7 +8050,7 @@ vectorizable_live_operation (stmt_vec_info stmt_info,\n   if (stmts)\n     {\n       gimple_stmt_iterator exit_gsi = gsi_after_labels (exit_bb);\n-      gsi_insert_before (&exit_gsi, stmts, GSI_CONTINUE_LINKING);\n+      gsi_insert_seq_before (&exit_gsi, stmts, GSI_SAME_STMT);\n \n       /* Remove existing phi from lhs and create one copy from new_tree.  */\n       tree lhs_phi = NULL_TREE;\n@@ -8063,7 +8063,7 @@ vectorizable_live_operation (stmt_vec_info stmt_info,\n \t      remove_phi_node (&gsi, false);\n \t      lhs_phi = gimple_phi_result (phi);\n \t      gimple *copy = gimple_build_assign (lhs_phi, new_tree);\n-\t      gsi_insert_after (&exit_gsi, copy, GSI_CONTINUE_LINKING);\n+\t      gsi_insert_before (&exit_gsi, copy, GSI_SAME_STMT);\n \t      break;\n \t    }\n \t}"}]}