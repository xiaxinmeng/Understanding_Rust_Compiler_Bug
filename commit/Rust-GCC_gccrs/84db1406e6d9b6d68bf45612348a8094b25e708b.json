{"sha": "84db1406e6d9b6d68bf45612348a8094b25e708b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODRkYjE0MDZlNmQ5YjZkNjhiZjQ1NjEyMzQ4YTgwOTRiMjVlNzA4Yg==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2016-11-25T08:18:26Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2016-11-25T08:18:26Z"}, "message": "Add run tests for recent sibcall patches\n\ngcc/testsuite/\n\t* gcc.dg/tree-ssa/tailcall-7-run.c: New test.\n\t* gcc.dg/tree-ssa/tailcall-8-run.c: Likewise.\n\nFrom-SVN: r242861", "tree": {"sha": "331ad7f396d6a6d2e3eb6bff6c1bc2033cbb13c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/331ad7f396d6a6d2e3eb6bff6c1bc2033cbb13c9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84db1406e6d9b6d68bf45612348a8094b25e708b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84db1406e6d9b6d68bf45612348a8094b25e708b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84db1406e6d9b6d68bf45612348a8094b25e708b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84db1406e6d9b6d68bf45612348a8094b25e708b/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2c28c3e49983e8054850e60704edc391146e376d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c28c3e49983e8054850e60704edc391146e376d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2c28c3e49983e8054850e60704edc391146e376d"}], "stats": {"total": 163, "additions": 163, "deletions": 0}, "files": [{"sha": "159b14d96708b9f3baa5ebb7f6bd432a778e88ef", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84db1406e6d9b6d68bf45612348a8094b25e708b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84db1406e6d9b6d68bf45612348a8094b25e708b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=84db1406e6d9b6d68bf45612348a8094b25e708b", "patch": "@@ -1,3 +1,8 @@\n+2016-11-25  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* gcc.dg/tree-ssa/tailcall-7-run.c: New test.\n+\t* gcc.dg/tree-ssa/tailcall-8-run.c: Likewise.\n+\n 2016-11-25  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* gcc.dg/tree-ssa/tailcall-8.c: New test."}, {"sha": "d18ff9d8914f1bf617bf3b9eda81d26122076502", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailcall-7-run.c", "status": "added", "additions": 72, "deletions": 0, "changes": 72, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84db1406e6d9b6d68bf45612348a8094b25e708b/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-7-run.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84db1406e6d9b6d68bf45612348a8094b25e708b/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-7-run.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-7-run.c?ref=84db1406e6d9b6d68bf45612348a8094b25e708b", "patch": "@@ -0,0 +1,72 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O2\" } */\n+/* { dg-additional-sources \"tailcall-7.c\" } */\n+\n+struct s { int x; };\n+extern struct s global;\n+\n+void g1 (void);\n+void g2 (void);\n+void g3 (struct s *);\n+struct s g4 (struct s);\n+struct s g5 (void);\n+struct s g6 (void);\n+struct s g7 (void);\n+struct s g8 (struct s *);\n+int g9 (struct s);\n+int g10 (int);\n+\n+struct s last;\n+struct s tmp;\n+\n+struct s\n+f (int i)\n+{\n+  struct s ret;\n+  ret.x = i + 100;\n+  last = ret;\n+  return ret;\n+}\n+\n+void\n+callit (void (*fn) (void))\n+{\n+  fn ();\n+}\n+\n+int\n+test (int last_val, int global_val, int tmp_val)\n+{\n+  return last.x == last_val && global.x == global_val && tmp.x == tmp_val;\n+}\n+\n+int\n+main (void)\n+{\n+  global.x = 200;\n+  tmp.x = 300;\n+  g1 ();\n+  if (!test (101, 200, 300))\n+    __builtin_abort ();\n+  g2 ();\n+  if (!test (102, 102, 300))\n+    __builtin_abort ();\n+  g3 (&tmp);\n+  if (!test (103, 102, 103))\n+    __builtin_abort ();\n+  if (g4 (tmp).x != 104 || !test (104, 102, 103))\n+    __builtin_abort ();\n+  if (g5 ().x != 105 || !test (105, 102, 103))\n+    __builtin_abort ();\n+  if (g6 ().x != 106 || !test (106, 102, 103))\n+    __builtin_abort ();\n+  if (g7 ().x != 107 || !test (107, 107, 103))\n+    __builtin_abort ();\n+  if (g8 (&tmp).x != 108 || !test (108, 107, 108))\n+    __builtin_abort ();\n+  if (g9 (tmp) != 9 || !test (109, 107, 108))\n+    __builtin_abort ();\n+  if (g10 (10) != 10 || !test (110, 107, 108))\n+    __builtin_abort ();\n+  return 0;\n+}"}, {"sha": "f8929093846002dde1bdf96a09d2ca6411dda9c6", "filename": "gcc/testsuite/gcc.dg/tree-ssa/tailcall-8-run.c", "status": "added", "additions": 86, "deletions": 0, "changes": 86, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84db1406e6d9b6d68bf45612348a8094b25e708b/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-8-run.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84db1406e6d9b6d68bf45612348a8094b25e708b/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-8-run.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ftailcall-8-run.c?ref=84db1406e6d9b6d68bf45612348a8094b25e708b", "patch": "@@ -0,0 +1,86 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O2\" } */\n+/* { dg-additional-sources \"tailcall-8.c\" } */\n+\n+struct s { int x; };\n+\n+int expected;\n+struct s *last_ptr;\n+struct s tmp;\n+\n+void\n+start (int val, struct s *initial_last_ptr)\n+{\n+  expected = val;\n+  tmp.x = val;\n+  last_ptr = initial_last_ptr;\n+}\n+\n+void\n+f_direct (struct s param)\n+{\n+  if (param.x != expected)\n+    __builtin_abort ();\n+}\n+\n+void\n+f_indirect (struct s *ptr)\n+{\n+  if (ptr->x != expected)\n+    __builtin_abort ();\n+  last_ptr = ptr;\n+  ptr->x += 100;\n+}\n+\n+void\n+f_void (void)\n+{\n+  if (last_ptr->x != expected + 100)\n+    __builtin_abort ();\n+}\n+\n+\n+void g1 (struct s);\n+void g2 (struct s *);\n+void g3 (struct s *);\n+void g4 (struct s *);\n+void g5 (struct s);\n+void g6 (struct s);\n+void g7 (struct s);\n+void g8 (struct s *);\n+void g9 (struct s *);\n+\n+int\n+main (void)\n+{\n+  struct s g6_s = { 106 };\n+\n+  start (1, 0);\n+  g1 (tmp);\n+\n+  start (2, 0);\n+  g2 (&tmp);\n+\n+  start (3, 0);\n+  g3 (&tmp);\n+\n+  start (4, 0);\n+  g4 (&tmp);\n+\n+  start (5, 0);\n+  g5 (tmp);\n+\n+  start (6, &g6_s);\n+  g6 (tmp);\n+\n+  start (7, 0);\n+  g7 (tmp);\n+\n+  start (8, 0);\n+  g8 (&tmp);\n+\n+  start (9, 0);\n+  g9 (&tmp);\n+\n+  return 0;\n+}"}]}