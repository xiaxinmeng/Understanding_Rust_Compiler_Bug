{"sha": "7d9735bbb88b6e61e5405d7c99e6cc97112e7a41", "node_id": "C_kwDOANBUbNoAKDdkOTczNWJiYjg4YjZlNjFlNTQwNWQ3Yzk5ZTZjYzk3MTEyZTdhNDE", "commit": {"author": {"name": "Justin Squirek", "email": "squirek@adacore.com", "date": "2021-07-09T00:33:05Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-09-21T15:25:03Z"}, "message": "[Ada] Spurious dynamic accessibility check on allocator\n\ngcc/ada/\n\n\t* sem_util.adb (Accessibility_Level): Remove spurious special\n\tcase for protected type components.\n\t* exp_ch4.adb (Generate_Accessibility_Check): Use general\n\tAccessibility_Level instead of the low-level function\n\tType_Access_Level.", "tree": {"sha": "e7521b7ac2ee2ec6c56337137bf1e403ebd8b4f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e7521b7ac2ee2ec6c56337137bf1e403ebd8b4f7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41/comments", "author": {"login": "AdaDoom3", "id": 3445599, "node_id": "MDQ6VXNlcjM0NDU1OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/3445599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdaDoom3", "html_url": "https://github.com/AdaDoom3", "followers_url": "https://api.github.com/users/AdaDoom3/followers", "following_url": "https://api.github.com/users/AdaDoom3/following{/other_user}", "gists_url": "https://api.github.com/users/AdaDoom3/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdaDoom3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdaDoom3/subscriptions", "organizations_url": "https://api.github.com/users/AdaDoom3/orgs", "repos_url": "https://api.github.com/users/AdaDoom3/repos", "events_url": "https://api.github.com/users/AdaDoom3/events{/privacy}", "received_events_url": "https://api.github.com/users/AdaDoom3/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f6ccb788f29ce79af3a5dad0bd96f0db98a5c028", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6ccb788f29ce79af3a5dad0bd96f0db98a5c028", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6ccb788f29ce79af3a5dad0bd96f0db98a5c028"}], "stats": {"total": 14, "additions": 1, "deletions": 13}, "files": [{"sha": "497a52ba05dd5ecb5fb312997fe1a5b8e360b6e1", "filename": "gcc/ada/exp_ch4.adb", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41/gcc%2Fada%2Fexp_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41/gcc%2Fada%2Fexp_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch4.adb?ref=7d9735bbb88b6e61e5405d7c99e6cc97112e7a41", "patch": "@@ -767,8 +767,7 @@ package body Exp_Ch4 is\n             Cond :=\n               Make_Op_Gt (Loc,\n                 Left_Opnd  => Cond,\n-                Right_Opnd =>\n-                  Make_Integer_Literal (Loc, Type_Access_Level (PtrT)));\n+                Right_Opnd => Accessibility_Level (N, Dynamic_Level));\n \n             --  Due to the complexity and side effects of the check, utilize an\n             --  if statement instead of the regular Program_Error circuitry."}, {"sha": "45a338a927be972989b0050b81b6da0301096154", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d9735bbb88b6e61e5405d7c99e6cc97112e7a41/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=7d9735bbb88b6e61e5405d7c99e6cc97112e7a41", "patch": "@@ -728,17 +728,6 @@ package body Sem_Util is\n                return Make_Level_Literal\n                         (Typ_Access_Level (Etype (E)));\n \n-            --  When E is a component of the current instance of a\n-            --  protected type, we assume the level to be deeper than that of\n-            --  the type itself.\n-\n-            elsif not Is_Overloadable (E)\n-              and then Ekind (Scope (E)) = E_Protected_Type\n-              and then Comes_From_Source (Scope (E))\n-            then\n-               return Make_Level_Literal\n-                        (Scope_Depth (Enclosing_Dynamic_Scope (E)) + 1);\n-\n             --  Check if E is an expansion-generated renaming of an iterator\n             --  by examining Related_Expression. If so, determine the\n             --  accessibility level based on the original expression."}]}