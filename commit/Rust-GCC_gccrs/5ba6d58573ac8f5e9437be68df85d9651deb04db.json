{"sha": "5ba6d58573ac8f5e9437be68df85d9651deb04db", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWJhNmQ1ODU3M2FjOGY1ZTk0MzdiZTY4ZGY4NWQ5NjUxZGViMDRkYg==", "commit": {"author": {"name": "Kito Cheng", "email": "kito.cheng@gmail.com", "date": "2018-04-04T08:25:36Z"}, "committer": {"name": "Chung-Ju Wu", "email": "jasonwucj@gcc.gnu.org", "date": "2018-04-04T08:25:36Z"}, "message": "[NDS32] Refine instruction type attribute.\n\ngcc/\n\t* config/nds32/nds32-doubleword.md: Refine all the instruction type.\n\t* config/nds32/nds32.md: Ditto.\n\t* config/nds32/pipelines.md: Ditto.\n\nFrom-SVN: r259069", "tree": {"sha": "7bcef68e07591f4e381df380298624eef803be72", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7bcef68e07591f4e381df380298624eef803be72"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5ba6d58573ac8f5e9437be68df85d9651deb04db", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ba6d58573ac8f5e9437be68df85d9651deb04db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5ba6d58573ac8f5e9437be68df85d9651deb04db", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ba6d58573ac8f5e9437be68df85d9651deb04db/comments", "author": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7d048870c1e97470af577e782c3285a827d6a49f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d048870c1e97470af577e782c3285a827d6a49f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d048870c1e97470af577e782c3285a827d6a49f"}], "stats": {"total": 93, "additions": 51, "deletions": 42}, "files": [{"sha": "d84cb00403db76542cf624575699825c041ff49c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5ba6d58573ac8f5e9437be68df85d9651deb04db", "patch": "@@ -1,3 +1,9 @@\n+2018-04-04  Kito Cheng  <kito.cheng@gmail.com>\n+\n+\t* config/nds32/nds32-doubleword.md: Refine all the instruction type.\n+\t* config/nds32/nds32.md: Ditto.\n+\t* config/nds32/pipelines.md: Ditto.\n+\n 2018-04-04  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/85168"}, {"sha": "beefca49c5927ebbcb9e609eab33420a08a65276", "filename": "gcc/config/nds32/nds32-doubleword.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2Fconfig%2Fnds32%2Fnds32-doubleword.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2Fconfig%2Fnds32%2Fnds32-doubleword.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnds32%2Fnds32-doubleword.md?ref=5ba6d58573ac8f5e9437be68df85d9651deb04db", "patch": "@@ -182,8 +182,8 @@\n       gcc_unreachable ();\n     }\n }\n-  [(set_attr \"type\"   \"move,move,move,move\")\n-   (set_attr \"length\" \"   4,  16,   8,   8\")])\n+  [(set_attr \"type\"   \"alu,alu,alu,alu\")\n+   (set_attr \"length\" \"  4, 16,  8,  8\")])\n \n (define_split\n   [(set (match_operand:DIDF 0 \"register_operand\"     \"\")"}, {"sha": "b105e26d437aca50880329a22e5e0d2eea75ec96", "filename": "gcc/config/nds32/nds32.md", "status": "modified", "additions": 42, "deletions": 39, "changes": 81, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2Fconfig%2Fnds32%2Fnds32.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2Fconfig%2Fnds32%2Fnds32.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnds32%2Fnds32.md?ref=5ba6d58573ac8f5e9437be68df85d9651deb04db", "patch": "@@ -52,10 +52,9 @@\n \n ;; Insn type, it is used to default other attribute values.\n (define_attr \"type\"\n-  \"unknown,move,load,store,load_multiple,store_multiple,alu,compare,branch,call,misc\"\n+  \"unknown,load,store,load_multiple,store_multiple,alu,alu_shift,mul,mac,div,branch,call,misc\"\n   (const_string \"unknown\"))\n \n-\n ;; Length, in bytes, default is 4-bytes.\n (define_attr \"length\" \"\" (const_int 4))\n \n@@ -184,7 +183,7 @@\n \t(match_operand:SI 1 \"nds32_symbolic_operand\" \" i, i\"))]\n   \"\"\n   \"la\\t%0, %1\"\n-  [(set_attr \"type\" \"move\")\n+  [(set_attr \"type\"  \"alu\")\n    (set_attr \"length\"  \"8\")])\n \n \n@@ -337,8 +336,9 @@\n \n   return \"add_slli\\t%0, %3, %1, %2\";\n }\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"combo\"        \"2\")\n+   (set_attr \"length\"       \"4\")])\n \n (define_insn \"*add_srli\"\n   [(set (match_operand:SI 0 \"register_operand\"                        \"=   r\")\n@@ -347,8 +347,9 @@\n \t\t (match_operand:SI 3 \"register_operand\"               \"    r\")))]\n   \"TARGET_ISA_V3\"\n   \"add_srli\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"combo\"        \"2\")\n+   (set_attr \"length\"       \"4\")])\n \n \n ;; GCC intends to simplify (minus (reg) (ashift ...))\n@@ -369,8 +370,9 @@\n \n   return \"sub_slli\\t%0, %1, %2, %3\";\n }\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"combo\"        \"2\")\n+   (set_attr \"length\"       \"4\")])\n \n (define_insn \"*sub_srli\"\n   [(set (match_operand:SI 0 \"register_operand\"                         \"=   r\")\n@@ -379,8 +381,9 @@\n \t\t\t       (match_operand:SI 3 \"immediate_operand\" \" Iu05\"))))]\n   \"TARGET_ISA_V3\"\n   \"sub_srli\\t%0, %1, %2, %3\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"combo\"        \"2\")\n+   (set_attr \"length\"       \"4\")])\n \n \n ;; Multiplication instructions.\n@@ -393,7 +396,7 @@\n   \"@\n   mul33\\t%0, %2\n   mul\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"alu,alu\")\n+  [(set_attr \"type\"    \"mul,mul\")\n    (set_attr \"length\" \"  2,  4\")])\n \n (define_insn \"mulsidi3\"\n@@ -402,7 +405,7 @@\n \t\t (sign_extend:DI (match_operand:SI 2 \"register_operand\" \" r\"))))]\n   \"TARGET_ISA_V2 || TARGET_ISA_V3\"\n   \"mulsr64\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"alu\")\n+  [(set_attr \"type\"   \"mul\")\n    (set_attr \"length\"   \"4\")])\n \n (define_insn \"umulsidi3\"\n@@ -411,7 +414,7 @@\n \t\t (zero_extend:DI (match_operand:SI 2 \"register_operand\" \" r\"))))]\n   \"TARGET_ISA_V2 || TARGET_ISA_V3\"\n   \"mulr64\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"alu\")\n+  [(set_attr \"type\"   \"mul\")\n    (set_attr \"length\"   \"4\")])\n \n \n@@ -424,7 +427,7 @@\n \t\t\t  (match_operand:SI 2 \"register_operand\" \" r\"))))]\n   \"\"\n   \"maddr32\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"alu\")\n+  [(set_attr \"type\"   \"mac\")\n    (set_attr \"length\"   \"4\")])\n \n (define_insn \"*maddr32_1\"\n@@ -434,7 +437,7 @@\n \t\t (match_operand:SI 3 \"register_operand\"          \" 0\")))]\n   \"\"\n   \"maddr32\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"alu\")\n+  [(set_attr \"type\"   \"mac\")\n    (set_attr \"length\"   \"4\")])\n \n (define_insn \"*msubr32\"\n@@ -444,7 +447,7 @@\n \t\t\t   (match_operand:SI 2 \"register_operand\" \" r\"))))]\n   \"\"\n   \"msubr32\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"alu\")\n+  [(set_attr \"type\"   \"mac\")\n    (set_attr \"length\"   \"4\")])\n \n \n@@ -458,7 +461,7 @@\n \t(mod:SI (match_dup 1) (match_dup 2)))]\n   \"\"\n   \"divsr\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\"   \"alu\")\n+  [(set_attr \"type\"   \"div\")\n    (set_attr \"length\"   \"4\")])\n \n (define_insn \"udivmodsi4\"\n@@ -469,7 +472,7 @@\n \t(umod:SI (match_dup 1) (match_dup 2)))]\n   \"\"\n   \"divr\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\"   \"alu\")\n+  [(set_attr \"type\"   \"div\")\n    (set_attr \"length\"   \"4\")])\n \n \n@@ -568,8 +571,8 @@\n \t\t(match_operand:SI 3 \"register_operand\"              \"    r\")))]\n   \"TARGET_ISA_V3\"\n   \"and_slli\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"length\"       \"4\")])\n \n (define_insn \"*and_srli\"\n   [(set (match_operand:SI 0 \"register_operand\"                       \"=   r\")\n@@ -578,8 +581,8 @@\n \t\t(match_operand:SI 3 \"register_operand\"               \"    r\")))]\n   \"TARGET_ISA_V3\"\n   \"and_srli\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"length\"       \"4\")])\n \n \n ;; ----------------------------------------------------------------------------\n@@ -628,8 +631,8 @@\n \t\t(match_operand:SI 3 \"register_operand\"             \"    r\")))]\n   \"TARGET_ISA_V3\"\n   \"or_slli\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"length\"       \"4\")])\n \n (define_insn \"*or_srli\"\n   [(set (match_operand:SI 0 \"register_operand\"                       \"=   r\")\n@@ -638,8 +641,8 @@\n \t\t(match_operand:SI 3 \"register_operand\"               \"    r\")))]\n   \"TARGET_ISA_V3\"\n   \"or_srli\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"length\"       \"4\")])\n \n \n ;; ----------------------------------------------------------------------------\n@@ -688,8 +691,8 @@\n \t\t(match_operand:SI 3 \"register_operand\"             \"    r\")))]\n   \"TARGET_ISA_V3\"\n   \"xor_slli\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"length\"       \"4\")])\n \n (define_insn \"*xor_srli\"\n   [(set (match_operand:SI 0 \"register_operand\"                       \"=   r\")\n@@ -698,8 +701,8 @@\n \t\t(match_operand:SI 3 \"register_operand\"               \"    r\")))]\n   \"TARGET_ISA_V3\"\n   \"xor_srli\\t%0, %3, %1, %2\"\n-  [(set_attr \"type\" \"alu\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"alu_shift\")\n+   (set_attr \"length\"       \"4\")])\n \n ;; Rotate Right Instructions.\n \n@@ -711,8 +714,8 @@\n   \"@\n   rotri\\t%0, %1, %2\n   rotr\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"alu,alu\")\n-   (set_attr \"length\" \"  4,  4\")])\n+  [(set_attr \"type\"    \"  alu,  alu\")\n+   (set_attr \"length\"  \"    4,    4\")])\n \n \n ;; ----------------------------------------------------------------------------\n@@ -924,7 +927,7 @@ create_template:\n   \"@\n    cmovz\\t%0, %2, %1\n    cmovn\\t%0, %3, %1\"\n-  [(set_attr \"type\" \"move\")\n+  [(set_attr \"type\"  \"alu\")\n    (set_attr \"length\"  \"4\")])\n \n (define_insn \"cmovn\"\n@@ -937,7 +940,7 @@ create_template:\n   \"@\n    cmovn\\t%0, %2, %1\n    cmovz\\t%0, %3, %1\"\n-  [(set_attr \"type\" \"move\")\n+  [(set_attr \"type\"  \"alu\")\n    (set_attr \"length\"  \"4\")])\n \n \n@@ -1831,7 +1834,7 @@ create_template:\n    sltsi45\\t%1, %2\n    slts\\t%0, %1, %2\n    sltsi\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"compare,compare,compare,compare\")\n+  [(set_attr \"type\"   \"    alu,    alu,    alu,    alu\")\n    (set_attr \"length\" \"      2,      2,      4,      4\")])\n \n (define_insn \"slt_compare\"\n@@ -1844,8 +1847,8 @@ create_template:\n    slti45\\t%1, %2\n    slt\\t%0, %1, %2\n    slti\\t%0, %1, %2\"\n-  [(set_attr \"type\"   \"compare,compare,compare,compare\")\n-   (set_attr \"length\" \"      2,      2,      4,      4\")])\n+  [(set_attr \"type\"   \"alu,    alu,    alu,    alu\")\n+   (set_attr \"length\" \"  2,      2,      4,      4\")])\n \n \n ;; ----------------------------------------------------------------------------\n@@ -2333,7 +2336,7 @@ create_template:\n     return nds32_output_casesi (operands);\n }\n   [(set_attr \"length\" \"20\")\n-   (set_attr \"type\" \"alu\")])\n+   (set_attr \"type\" \"branch\")])\n \n ;; ----------------------------------------------------------------------------\n "}, {"sha": "2ae2d71445e427690ec42dbaffed509fca136c28", "filename": "gcc/config/nds32/pipelines.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2Fconfig%2Fnds32%2Fpipelines.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ba6d58573ac8f5e9437be68df85d9651deb04db/gcc%2Fconfig%2Fnds32%2Fpipelines.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnds32%2Fpipelines.md?ref=5ba6d58573ac8f5e9437be68df85d9651deb04db", "patch": "@@ -23,7 +23,7 @@\n (define_cpu_unit \"general_unit\" \"nds32_machine\")\n \n (define_insn_reservation \"simple_insn\" 1\n-\t\t\t (eq_attr \"type\" \"unknown,load,store,move,alu,compare,branch,call,misc\")\n+\t\t\t (eq_attr \"type\" \"unknown,load,store,load_multiple,store_multiple,alu,alu_shift,mul,mac,div,branch,call,misc\")\n \t\t\t \"general_unit\")\n \n ;; ------------------------------------------------------------------------"}]}