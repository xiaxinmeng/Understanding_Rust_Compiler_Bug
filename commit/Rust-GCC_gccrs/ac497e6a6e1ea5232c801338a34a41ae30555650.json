{"sha": "ac497e6a6e1ea5232c801338a34a41ae30555650", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWM0OTdlNmE2ZTFlYTUyMzJjODAxMzM4YTM0YTQxYWUzMDU1NTY1MA==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2007-03-08T12:30:58Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2007-03-08T12:30:58Z"}, "message": "re PR fortran/30973 ([4.1, 4.2 only] undetected name conflict: variables may be named like modules)\n\n2007-03-08  Tobias Burnus  <burnus@net-b.de>\n\n\tPR fortran/30973\n\t* module.c (read_module): Always import module name as symbol.\n\t(gfc_match_use): Disallow module name in the only clause of\n\ta use statement.\n\n2007-03-08  Tobias Burnus  <burnus@net-b.de>\n\n\tPR fortran/30973\n\t* gfortran.dg/use_4.f90: New test.\n\t* gfortran.dg/used_dummy_types_7.f90: Correct ambiguous symbol.\n\nFrom-SVN: r122696", "tree": {"sha": "c34e8f381f0fe1211440c2a6c4cf7f60681e5e1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c34e8f381f0fe1211440c2a6c4cf7f60681e5e1c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac497e6a6e1ea5232c801338a34a41ae30555650", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac497e6a6e1ea5232c801338a34a41ae30555650", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac497e6a6e1ea5232c801338a34a41ae30555650", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac497e6a6e1ea5232c801338a34a41ae30555650/comments", "author": null, "committer": null, "parents": [{"sha": "9eaa999637696850a541a2eab736ea83690d32b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9eaa999637696850a541a2eab736ea83690d32b3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9eaa999637696850a541a2eab736ea83690d32b3"}], "stats": {"total": 81, "additions": 69, "deletions": 12}, "files": [{"sha": "3580963bdef337ef5fc9d9800003d83adf655596", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 13, "deletions": 6, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=ac497e6a6e1ea5232c801338a34a41ae30555650", "patch": "@@ -1,9 +1,16 @@\n-2007-03-08  Paul Thomas  <pault@gcc.gnu.org>\r\n-\r\n-\tPR fortran/31011\r\n-\t* expr.c (find_array_section): Correct arithmetic for section\r\n-\tsize.\r\n-\r\n+2007-07-08  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/30973\n+\t* module.c (read_module): Always import module name as symbol.\n+\t(gfc_match_use): Disallow module name in the only clause of\n+\ta use statement.\n+\n+2007-03-08  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/31011\n+\t* expr.c (find_array_section): Correct arithmetic for section\n+\tsize.\n+\n 2007-03-07  Brooks Moses  <brooks.moses@codesourcery.com>\n \n \t* iresolve.c (gfc_resolve_ishftc): Correct s_kind value."}, {"sha": "fcae6bd7d3f7671d861f4beca342d1ea56b846b7", "filename": "gcc/fortran/module.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ffortran%2Fmodule.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ffortran%2Fmodule.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmodule.c?ref=ac497e6a6e1ea5232c801338a34a41ae30555650", "patch": "@@ -619,6 +619,14 @@ gfc_match_use (void)\n \t\tgoto cleanup;\n \t    }\n \n+\t  if (strcmp (new->use_name, module_name) == 0\n+\t      || strcmp (new->local_name, module_name) == 0)\n+\t    {\n+\t      gfc_error (\"The name '%s' at %C has already been used as \"\n+\t\t\t \"an external module name.\", module_name);\n+\t      goto cleanup;\n+\t    }\n+\n \t  break;\n \n \tcase INTERFACE_USER_OP:\n@@ -3438,6 +3446,9 @@ read_module (void)\n \t  /* Get the jth local name for this symbol.  */\n \t  p = find_use_name_n (name, &j);\n \n+\t  if (p == NULL && strcmp (name, module_name) == 0)\n+\t    p = name;\n+\n \t  /* Skip symtree nodes not in an ONLY clause, unless there\n \t     is an existing symtree loaded from another USE\n \t     statement.  */"}, {"sha": "dbc2c1fe91b859767456def23eee684dd57a96ed", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ac497e6a6e1ea5232c801338a34a41ae30555650", "patch": "@@ -1,7 +1,13 @@\n-2007-03-08  Paul Thomas  <pault@gcc.gnu.org>\r\n-\r\n-\tPR fortran/31011\r\n-\t* gfortran.dg/parameter_array_section_2.f90: New test.\r\n+2007-03-08  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/30973\n+\t* gfortran.dg/use_4.f90: New test.\n+\t* gfortran.dg/used_dummy_types_7.f90: Correct ambiguous symbol.\n+\n+2007-03-08  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/31011\n+\t* gfortran.dg/parameter_array_section_2.f90: New test.\n \n 2007-03-08  Volker Reichelt  <reichelt@netcologne.de>\n "}, {"sha": "43d94bc223ca5619b108fb9167e416d77babe7d3", "filename": "gcc/testsuite/gfortran.dg/use_4.f90", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fuse_4.f90?ref=ac497e6a6e1ea5232c801338a34a41ae30555650", "patch": "@@ -0,0 +1,33 @@\n+! { dg-do \"compile\" }\n+! PR fortran/30973\n+! Using symbols with the name of the module\n+\n+module foo\n+  integer :: i\n+end module foo\n+\n+module bar\n+  integer :: j\n+end module bar\n+\n+module test\n+  use foo, only:\n+  integer :: foo ! { dg-error \"cannot have a type\" }\n+end module test\n+\n+module test2\n+  use bar, only: foo => j\n+  use foo ! ok, unless foo is accessed\n+end module test2\n+\n+module test3\n+  use bar, only: foo => j\n+  use foo ! ok, unless foo is accessed\n+  foo = 5 ! { dg-error \"is an ambiguous reference to 'j'\" }\n+end module test3\n+\n+program test_foo\n+  use foo, only: foo  ! { dg-error \"been used as an external module name\" }\n+  use foo, only: i => foo! { dg-error \"been used as an external module name\" }\n+  use foo, only: foo => i! { dg-error \"been used as an external module name\" }\n+end program"}, {"sha": "b0acc51409f441dc67c9d2b28466ab82ead87db2", "filename": "gcc/testsuite/gfortran.dg/used_dummy_types_7.f90", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ftestsuite%2Fgfortran.dg%2Fused_dummy_types_7.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac497e6a6e1ea5232c801338a34a41ae30555650/gcc%2Ftestsuite%2Fgfortran.dg%2Fused_dummy_types_7.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fused_dummy_types_7.f90?ref=ac497e6a6e1ea5232c801338a34a41ae30555650", "patch": "@@ -33,12 +33,12 @@ SUBROUTINE dummy_atom_insert_symmetry_mate(this, other)\n \n MODULE list\n INTERFACE\n-  SUBROUTINE dummy_atom_list_insert(this, atom)\n+  SUBROUTINE dummy_atom_list_insert(this, atom2)\n     USE types, ONLY: dummy_atom_list\n     USE atom, ONLY: dummy_atom\n \n     TYPE(dummy_atom_list), INTENT(inout) :: this\n-    TYPE(dummy_atom), INTENT(in)         :: atom\n+    TYPE(dummy_atom), INTENT(in)         :: atom2\n   END SUBROUTINE\n END INTERFACE\n END MODULE"}]}