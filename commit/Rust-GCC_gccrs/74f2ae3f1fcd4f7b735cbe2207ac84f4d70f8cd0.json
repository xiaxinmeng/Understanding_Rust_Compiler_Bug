{"sha": "74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzRmMmFlM2YxZmNkNGY3YjczNWNiZTIyMDdhYzg0ZjRkNzBmOGNkMA==", "commit": {"author": {"name": "Aaron Sawdey", "email": "acsawdey@linux.ibm.com", "date": "2021-02-03T01:40:56Z"}, "committer": {"name": "Aaron Sawdey", "email": "acsawdey@linux.ibm.com", "date": "2021-02-03T15:34:36Z"}, "message": "Fix earlier commit missing patch review changes\n\nSomehow I lost my fixes based on Segher's review of the p10\nlogical-logical fusion patch. This commit adds the changes that\nshould have been there before. Bootstrap/regtest passed.\n\ngcc/ChangeLog:\n\n\t* config/rs6000/genfusion.pl (gen_2logical): Add missing\n\tfixes based on patch review.\n\t* config/rs6000/fusion.md: Regenerate file.", "tree": {"sha": "bf7191fc9167e4854fb415d0d8de337b0ce6e9c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bf7191fc9167e4854fb415d0d8de337b0ce6e9c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0/comments", "author": {"login": "acsawdey", "id": 41373646, "node_id": "MDQ6VXNlcjQxMzczNjQ2", "avatar_url": "https://avatars.githubusercontent.com/u/41373646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/acsawdey", "html_url": "https://github.com/acsawdey", "followers_url": "https://api.github.com/users/acsawdey/followers", "following_url": "https://api.github.com/users/acsawdey/following{/other_user}", "gists_url": "https://api.github.com/users/acsawdey/gists{/gist_id}", "starred_url": "https://api.github.com/users/acsawdey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/acsawdey/subscriptions", "organizations_url": "https://api.github.com/users/acsawdey/orgs", "repos_url": "https://api.github.com/users/acsawdey/repos", "events_url": "https://api.github.com/users/acsawdey/events{/privacy}", "received_events_url": "https://api.github.com/users/acsawdey/received_events", "type": "User", "site_admin": false}, "committer": {"login": "acsawdey", "id": 41373646, "node_id": "MDQ6VXNlcjQxMzczNjQ2", "avatar_url": "https://avatars.githubusercontent.com/u/41373646?v=4", "gravatar_id": "", "url": "https://api.github.com/users/acsawdey", "html_url": "https://github.com/acsawdey", "followers_url": "https://api.github.com/users/acsawdey/followers", "following_url": "https://api.github.com/users/acsawdey/following{/other_user}", "gists_url": "https://api.github.com/users/acsawdey/gists{/gist_id}", "starred_url": "https://api.github.com/users/acsawdey/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/acsawdey/subscriptions", "organizations_url": "https://api.github.com/users/acsawdey/orgs", "repos_url": "https://api.github.com/users/acsawdey/repos", "events_url": "https://api.github.com/users/acsawdey/events{/privacy}", "received_events_url": "https://api.github.com/users/acsawdey/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "05c93a63a6be522b814cc03629751a7bc9b78b99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05c93a63a6be522b814cc03629751a7bc9b78b99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05c93a63a6be522b814cc03629751a7bc9b78b99"}], "stats": {"total": 1937, "additions": 1033, "deletions": 904}, "files": [{"sha": "737a6da385fe83d98236bf6c9af913b6150c50e9", "filename": "gcc/config/rs6000/fusion.md", "status": "modified", "additions": 1024, "deletions": 896, "changes": 1920, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0/gcc%2Fconfig%2Frs6000%2Ffusion.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0/gcc%2Fconfig%2Frs6000%2Ffusion.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Ffusion.md?ref=74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0"}, {"sha": "e1c45f57065eddcd9757dd9ee7bc7f64616578d0", "filename": "gcc/config/rs6000/genfusion.pl", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0/gcc%2Fconfig%2Frs6000%2Fgenfusion.pl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0/gcc%2Fconfig%2Frs6000%2Fgenfusion.pl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fgenfusion.pl?ref=74f2ae3f1fcd4f7b735cbe2207ac84f4d70f8cd0", "patch": "@@ -192,7 +192,8 @@ sub gen_2logical\n \t  if ( ($inner_comp & 2) == 2 ) {\n \t      $inner_arg1 = \"(not:${mode} $inner_arg1)\";\n \t  }\n-\t  $inner_exp = \"(${inner_rtl}:${mode} ${inner_arg0} ${inner_arg1})\";\n+\t  $inner_exp = \"(${inner_rtl}:${mode} ${inner_arg0} \n+                          ${inner_arg1})\";\n \t  if ( $inner_inv == 1 ) {\n \t      $inner_exp = \"(not:${mode} $inner_exp)\";\n \t  }\n@@ -203,25 +204,25 @@ sub gen_2logical\n \t  if ( ($outer_comp & 2) == 2 ) {\n \t      $inner_exp = \"(not:${mode} $inner_exp)\";\n \t  }\n-\t  $outer_exp = \"(${outer_rtl}:${mode} ${inner_exp} ${outer_arg2})\";\n+\t  $outer_exp = \"(${outer_rtl}:${mode} ${inner_exp}\n+                 ${outer_arg2})\";\n \t  if ( $outer_inv == 1 ) {\n \t      $outer_exp = \"(not:${mode} $outer_exp)\";\n \t  }\n \n \t  $insn =  <<\"EOF\";\n \n ;; logical-logical fusion pattern generated by gen_2logical\n-;; kind: $kind outer: $outer op $outer_op rtl $outer_rtl inv $outer_inv comp $outer_comp\n-;; inner: $inner op $inner_op rtl $inner_rtl inv $inner_inv comp $inner_comp\n+;; $kind $inner_op -> $outer_op\n (define_insn \"*fuse_${inner_op}_${outer_op}\"\n-  [(set (match_operand:${mode} 3 \"${pred}\" \"=&${constraint},0,1,${constraint}\")\n+  [(set (match_operand:${mode} 3 \"${pred}\" \"=0,1,&${constraint},${constraint}\")\n         ${outer_exp})\n-   (clobber (match_scratch:${mode} 4 \"=X,X,X,r\"))]\n+   (clobber (match_scratch:${mode} 4 \"=X,X,X,&r\"))]\n   \"(TARGET_P10_FUSION && TARGET_P10_FUSION_2LOGICAL)\"\n   \"@\n    ${inner_op} %3,%1,%0\\\\;${outer_op} %3,%3,%2\n-   ${inner_op} %0,%1,%0\\\\;${outer_op} %0,%0,%2\n-   ${inner_op} %1,%1,%0\\\\;${outer_op} %1,%1,%2\n+   ${inner_op} %3,%1,%0\\\\;${outer_op} %3,%3,%2\n+   ${inner_op} %3,%1,%0\\\\;${outer_op} %3,%3,%2\n    ${inner_op} %4,%1,%0\\\\;${outer_op} %3,%4,%2\"\n   [(set_attr \"type\" \"logical\")\n    (set_attr \"cost\" \"6\")"}]}