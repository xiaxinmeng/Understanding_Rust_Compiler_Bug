{"sha": "452ba14de17872cf0d51da73f6faa6b2f3668753", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDUyYmExNGRlMTc4NzJjZjBkNTFkYTczZjZmYWE2YjJmMzY2ODc1Mw==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "dvorakz@suse.cz", "date": "2007-07-09T22:44:03Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2007-07-09T22:44:03Z"}, "message": "cfghooks.c (remove_edge): New function.\n\n\t* cfghooks.c (remove_edge): New function.\n\t(redirect_edge_and_branch, remove_branch, merge_blocks): Updated\n\tloop exit rescans.\n\t* cfghooks.h (remove_edge): Declare.\n\t* cfg.c (remove_edge): Renamed to remove_edge_raw.\n\t* basic-block.h (remove_edge): Declaration changed to remove_edge_raw.\n\nFrom-SVN: r126499", "tree": {"sha": "0e61aac0e1113d8e8432e300c7301abcb9e59db8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0e61aac0e1113d8e8432e300c7301abcb9e59db8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/452ba14de17872cf0d51da73f6faa6b2f3668753", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/452ba14de17872cf0d51da73f6faa6b2f3668753", "html_url": "https://github.com/Rust-GCC/gccrs/commit/452ba14de17872cf0d51da73f6faa6b2f3668753", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/452ba14de17872cf0d51da73f6faa6b2f3668753/comments", "author": null, "committer": null, "parents": [{"sha": "18c492a9942639026fc27de5f1631f35b3d1b5ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18c492a9942639026fc27de5f1631f35b3d1b5ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18c492a9942639026fc27de5f1631f35b3d1b5ab"}], "stats": {"total": 42, "additions": 28, "deletions": 14}, "files": [{"sha": "2955ab87a09ba1024d9f3ea996b2eb92b3f38cb1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=452ba14de17872cf0d51da73f6faa6b2f3668753", "patch": "@@ -1,3 +1,12 @@\n+2007-07-10  Zdenek Dvorak  <dvorakz@suse.cz>\n+\n+\t* cfghooks.c (remove_edge): New function.\n+\t(redirect_edge_and_branch, remove_branch, merge_blocks): Updated\n+\tloop exit rescans.\n+\t* cfghooks.h (remove_edge): Declare.\n+\t* cfg.c (remove_edge): Renamed to remove_edge_raw.\n+\t* basic-block.h (remove_edge): Declaration changed to remove_edge_raw.\n+\n 2007-07-09  Wolfgang Gellerich  <gellerich@de.ibm.com>\n \n \t* optabs.h: Added declaration for signbit_optab.  "}, {"sha": "6d5280eaf1ce1f32720e6a60fbbf9fec08adc6f5", "filename": "gcc/basic-block.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fbasic-block.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fbasic-block.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbasic-block.h?ref=452ba14de17872cf0d51da73f6faa6b2f3668753", "patch": "@@ -490,7 +490,7 @@ extern edge unchecked_make_edge (basic_block, basic_block, int);\n extern edge cached_make_edge (sbitmap, basic_block, basic_block, int);\n extern edge make_edge (basic_block, basic_block, int);\n extern edge make_single_succ_edge (basic_block, basic_block, int);\n-extern void remove_edge (edge);\n+extern void remove_edge_raw (edge);\n extern void redirect_edge_succ (edge, basic_block);\n extern edge redirect_edge_succ_nodup (edge, basic_block);\n extern void redirect_edge_pred (edge, basic_block);"}, {"sha": "020be514ac90e9579d5bd363a8278e030cb604a9", "filename": "gcc/cfg.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fcfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fcfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfg.c?ref=452ba14de17872cf0d51da73f6faa6b2f3668753", "patch": "@@ -352,7 +352,7 @@ make_single_succ_edge (basic_block src, basic_block dest, int flags)\n /* This function will remove an edge from the flow graph.  */\n \n void\n-remove_edge (edge e)\n+remove_edge_raw (edge e)\n {\n   remove_predictions_associated_with_edge (e);\n   execute_on_shrinking_pred (e);"}, {"sha": "286625766e38e6530678d36624c25e6324350db3", "filename": "gcc/cfghooks.c", "status": "modified", "additions": 16, "deletions": 12, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fcfghooks.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fcfghooks.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfghooks.c?ref=452ba14de17872cf0d51da73f6faa6b2f3668753", "patch": "@@ -310,10 +310,10 @@ redirect_edge_and_branch (edge e, basic_block dest)\n \n   ret = cfg_hooks->redirect_edge_and_branch (e, dest);\n \n-  /* If RET != E, then the edge E was removed since RET already lead to the\n-     same destination.  */\n-  if (ret != NULL && current_loops != NULL)\n-    rescan_loop_exit (e, false, ret != e);\n+  /* If RET != E, then either the redirection failed, or the edge E\n+     was removed since RET already lead to the same destination.  */\n+  if (current_loops != NULL && ret == e)\n+    rescan_loop_exit (e, false, false);\n \n   return ret;\n }\n@@ -350,16 +350,24 @@ remove_branch (edge e)\n   other = EDGE_SUCC (src, EDGE_SUCC (src, 0) == e);\n   irr = other->flags & EDGE_IRREDUCIBLE_LOOP;\n \n-  if (current_loops != NULL)\n-    rescan_loop_exit (e, false, true);\n-\n   e = redirect_edge_and_branch (e, other->dest);\n   gcc_assert (e != NULL);\n \n   e->flags &= ~EDGE_IRREDUCIBLE_LOOP;\n   e->flags |= irr;\n }\n \n+/* Removes edge E from cfg.  Unlike remove_branch, it does not update IL.  */\n+\n+void\n+remove_edge (edge e)\n+{\n+  if (current_loops != NULL)\n+    rescan_loop_exit (e, false, true);\n+\n+  remove_edge_raw (e);\n+}\n+\n /* Redirect the edge E to basic block DEST even if it requires creating\n    of a new basic block; then it returns the newly created basic block.\n    Aborts when redirection is impossible.  */\n@@ -657,11 +665,7 @@ merge_blocks (basic_block a, basic_block b)\n      whole lot of them and hope the caller knows what they're doing.  */\n \n   while (EDGE_COUNT (a->succs) != 0)\n-    {\n-      if (current_loops != NULL)\n-\trescan_loop_exit (EDGE_SUCC (a, 0), false, true);\n-      remove_edge (EDGE_SUCC (a, 0));\n-    }\n+    remove_edge (EDGE_SUCC (a, 0));\n \n   /* Adjust the edges out of B for the new owner.  */\n   FOR_EACH_EDGE (e, ei, b->succs)"}, {"sha": "76bf238c5b4336814fd37bd238963e848da2d163", "filename": "gcc/cfghooks.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fcfghooks.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/452ba14de17872cf0d51da73f6faa6b2f3668753/gcc%2Fcfghooks.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfghooks.h?ref=452ba14de17872cf0d51da73f6faa6b2f3668753", "patch": "@@ -144,6 +144,7 @@ extern edge redirect_edge_and_branch (edge, basic_block);\n extern basic_block redirect_edge_and_branch_force (edge, basic_block);\n extern bool can_remove_branch_p (edge);\n extern void remove_branch (edge);\n+extern void remove_edge (edge);\n extern edge split_block (basic_block, void *);\n extern edge split_block_after_labels (basic_block);\n extern bool move_block_after (basic_block, basic_block);"}]}