{"sha": "8efcd34fa233d0ce3197e042677f1a0fb2801c35", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGVmY2QzNGZhMjMzZDBjZTMxOTdlMDQyNjc3ZjFhMGZiMjgwMWMzNQ==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@bigpond.net.au", "date": "2004-04-23T02:16:26Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2004-04-23T02:16:26Z"}, "message": "gcc.c (init_gcc_specs): Test USE_LD_AS_NEEDED, not HAVE_LD_AS_NEEDED.\n\n\t* gcc.c (init_gcc_specs): Test USE_LD_AS_NEEDED, not HAVE_LD_AS_NEEDED.\n\t* config/linux.h (USE_LD_AS_NEEDED): Define.\n\t* gcc/config/alpha/linux.h (USE_LD_AS_NEEDED): Define.\n\t* gcc/config/arm/linux-elf.h (USE_LD_AS_NEEDED): Define.\n\t* gcc/config/rs6000/linux.h (USE_LD_AS_NEEDED): Define.\n\t* gcc/config/rs6000/linux64.h (USE_LD_AS_NEEDED): Define.\n\t* gcc/config/sh/linux.h (USE_LD_AS_NEEDED): Define.\n\t* gcc/config/sparc/linux.h (USE_LD_AS_NEEDED): Define.\n\t* gcc/config/sparc/linux64.h (USE_LD_AS_NEEDED): Define.\n\nFrom-SVN: r81072", "tree": {"sha": "19ecdce5770c443ff6c937695a19fb3fac65ea7f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/19ecdce5770c443ff6c937695a19fb3fac65ea7f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8efcd34fa233d0ce3197e042677f1a0fb2801c35", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8efcd34fa233d0ce3197e042677f1a0fb2801c35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8efcd34fa233d0ce3197e042677f1a0fb2801c35", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8efcd34fa233d0ce3197e042677f1a0fb2801c35/comments", "author": null, "committer": null, "parents": [{"sha": "3092d0fc1bf706c5038eaddc3510ff84c914b8c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3092d0fc1bf706c5038eaddc3510ff84c914b8c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3092d0fc1bf706c5038eaddc3510ff84c914b8c7"}], "stats": {"total": 64, "additions": 61, "deletions": 3}, "files": [{"sha": "6c3d3279111451d5b666f8b3a8056f6c47beba91", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -1,3 +1,15 @@\n+2004-04-23  Alan Modra  <amodra@bigpond.net.au>\n+\n+\t* gcc.c (init_gcc_specs): Test USE_LD_AS_NEEDED, not HAVE_LD_AS_NEEDED.\n+\t* config/linux.h (USE_LD_AS_NEEDED): Define.\n+\t* gcc/config/alpha/linux.h (USE_LD_AS_NEEDED): Define.\n+\t* gcc/config/arm/linux-elf.h (USE_LD_AS_NEEDED): Define.\n+\t* gcc/config/rs6000/linux.h (USE_LD_AS_NEEDED): Define.\n+\t* gcc/config/rs6000/linux64.h (USE_LD_AS_NEEDED): Define.\n+\t* gcc/config/sh/linux.h (USE_LD_AS_NEEDED): Define.\n+\t* gcc/config/sparc/linux.h (USE_LD_AS_NEEDED): Define.\n+\t* gcc/config/sparc/linux64.h (USE_LD_AS_NEEDED): Define.\n+\n 2004-04-22  Per Bothner  <per@bothner.com>\n \n \t* cppinit.c (cpp_read_main_file):  Return NULL rather than false."}, {"sha": "e2a16dff3dba064626467c74fc87a8f79bb8da8b", "filename": "gcc/config/alpha/linux.h", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Falpha%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Falpha%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Falpha%2Flinux.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -1,6 +1,7 @@\n /* Definitions of target machine for GNU compiler,\n    for Alpha Linux-based GNU systems.\n-   Copyright (C) 1996, 1997, 1998, 2002, 2003 Free Software Foundation, Inc.\n+   Copyright (C) 1996, 1997, 1998, 2002, 2003, 2004\n+   Free Software Foundation, Inc.\n    Contributed by Richard Henderson.\n \n This file is part of GCC.\n@@ -70,6 +71,11 @@ Boston, MA 02111-1307, USA.  */\n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n \n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif\n+\n /* Do code reading to identify a signal frame, and set the frame\n    state data appropriately.  See unwind-dw2.c for the structs.  */\n "}, {"sha": "b4b389c1b7cdfbd0679ddb7d05d8e01bb89212e1", "filename": "gcc/config/arm/linux-elf.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Farm%2Flinux-elf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Farm%2Flinux-elf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Flinux-elf.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -126,3 +126,8 @@\n \n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n+\n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif"}, {"sha": "af7bf257ec4d29f4489ac4c215bcd097876c272d", "filename": "gcc/config/linux.h", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Flinux.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -1,5 +1,5 @@\n /* Definitions for Linux-based GNU systems with ELF format\n-   Copyright (C) 1995, 1996, 1997, 1998, 1999, 2000, 2003\n+   Copyright (C) 1995, 1996, 1997, 1998, 1999, 2000, 2003, 2004\n    Free Software Foundation, Inc.\n    Contributed by Eric Youngdale.\n    Modified for stabs-in-ELF by H.J. Lu (hjl@lucon.org).\n@@ -117,6 +117,11 @@ Boston, MA 02111-1307, USA.  */\n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n \n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif\n+\n /* Determine whether the the entire c99 runtime\n    is present in the runtime library.  */\n #ifndef USE_GNULIBC_1"}, {"sha": "83aef83a387b1174948801033b244ba1829f2557", "filename": "gcc/config/rs6000/linux.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Frs6000%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Frs6000%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Flinux.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -66,6 +66,11 @@\n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n \n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif\n+\n #undef  TARGET_VERSION\n #define TARGET_VERSION fprintf (stderr, \" (PowerPC GNU/Linux)\");\n "}, {"sha": "a63cb5fcff17a0fcdf7b6e0734693a7316484370", "filename": "gcc/config/rs6000/linux64.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Frs6000%2Flinux64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Frs6000%2Flinux64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Flinux64.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -548,6 +548,11 @@ while (0)\n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n \n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif\n+\n /* Do code reading to identify a signal frame, and set the frame\n    state data appropriately.  See unwind-dw2.c for the structs.  */\n "}, {"sha": "b01b52d28db9b7b96a90603f265521cbd849482d", "filename": "gcc/config/sh/linux.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Fsh%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Fsh%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Flinux.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -112,6 +112,11 @@ do { \\\n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n \n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif\n+\n /* Output assembler code to STREAM to call the profiler.  */\n \n #undef FUNCTION_PROFILER"}, {"sha": "107880f401d0e6ecdcdddec3e88b16c153571ee7", "filename": "gcc/config/sparc/linux.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Fsparc%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Fsparc%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Flinux.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -256,6 +256,11 @@ do {\t\t\t\t\t\t\t\t\t\\\n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n \n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif\n+\n /* Do code reading to identify a signal frame, and set the frame\n    state data appropriately.  See unwind-dw2.c for the structs.  */\n "}, {"sha": "09d14ae537a5a08a955b92a34fb5eba5911cab4e", "filename": "gcc/config/sparc/linux64.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Fsparc%2Flinux64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fconfig%2Fsparc%2Flinux64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Flinux64.h?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -334,6 +334,11 @@ do {\t\t\t\t\t\t\t\t\t\\\n #define LINK_GCC_C_SEQUENCE_SPEC \\\n   \"%{static:--start-group} %G %L %{static:--end-group}%{!static:%G}\"\n \n+/* Use --as-needed -lgcc_s for eh support.  */\n+#ifdef HAVE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 1\n+#endif\n+\n /* Do code reading to identify a signal frame, and set the frame\n    state data appropriately.  See unwind-dw2.c for the structs.  */\n "}, {"sha": "4e4f93b9ccd7b85bdae930ca6da0bfcb45ad550c", "filename": "gcc/gcc.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8efcd34fa233d0ce3197e042677f1a0fb2801c35/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=8efcd34fa233d0ce3197e042677f1a0fb2801c35", "patch": "@@ -1543,6 +1543,11 @@ static int processing_spec_function;\n    various permutations of -shared-libgcc, -shared, and such.  */\n \n #if defined(ENABLE_SHARED_LIBGCC) && !defined(REAL_LIBGCC_SPEC)\n+\n+#ifndef USE_LD_AS_NEEDED\n+#define USE_LD_AS_NEEDED 0\n+#endif\n+\n static void\n init_gcc_specs (struct obstack *obstack, const char *shared_name,\n \t\tconst char *static_name, const char *eh_name)\n@@ -1551,7 +1556,7 @@ init_gcc_specs (struct obstack *obstack, const char *shared_name,\n \n   buf = concat (\"%{static|static-libgcc:\", static_name, \" \", eh_name,\n \t\t\"}%{!static:%{!static-libgcc:\",\n-#ifdef HAVE_LD_AS_NEEDED\n+#if USE_LD_AS_NEEDED\n \t\t\"%{!shared-libgcc:\", static_name,\n \t\t\" --as-needed \", shared_name, \" --no-as-needed}\"\n \t\t\"%{shared-libgcc:\", shared_name, \"%{!shared: \", static_name,"}]}