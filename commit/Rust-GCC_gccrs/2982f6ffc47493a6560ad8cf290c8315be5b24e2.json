{"sha": "2982f6ffc47493a6560ad8cf290c8315be5b24e2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjk4MmY2ZmZjNDc0OTNhNjU2MGFkOGNmMjkwYzgzMTViZTViMjRlMg==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2002-10-17T01:19:59Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2002-10-17T01:19:59Z"}, "message": "locale_facets.h (__timepunct::__timepunct): Allocate _M_name_timepunct.\n\n\n2002-10-16  Benjamin Kosnik  <bkoz@redhat.com>\n\n\t* include/bits/locale_facets.h (__timepunct::__timepunct): Allocate\n\t_M_name_timepunct.\n\t(__timepunct::~__timepunct): Deallocate, remove specialization\n\tdeclarations.\n\t(messages::messages): Allocate _M_name_messages.\n\t(messages::~messages): Deallocate.\n\t(messages_byname): Same.\n\t* config/locale/gnu/time_members.cc (__timepunct::~__timepunct):\n\tRemove.\n\t* config/locale/generic/time_members.cc (__timepunct::~__timepunct):\n\tRemove.\n\n\t* docs/html/install.html: Add es_MX, en_PH to required locales list.\n\nFrom-SVN: r58232", "tree": {"sha": "0482b8efaca3c6f8f1b31c28f63b2cea5f2e3150", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0482b8efaca3c6f8f1b31c28f63b2cea5f2e3150"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2982f6ffc47493a6560ad8cf290c8315be5b24e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2982f6ffc47493a6560ad8cf290c8315be5b24e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2982f6ffc47493a6560ad8cf290c8315be5b24e2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2982f6ffc47493a6560ad8cf290c8315be5b24e2/comments", "author": null, "committer": null, "parents": [{"sha": "2303a07914bc82ca17706fc15166bf40b940bfa7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2303a07914bc82ca17706fc15166bf40b940bfa7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2303a07914bc82ca17706fc15166bf40b940bfa7"}], "stats": {"total": 90, "additions": 53, "deletions": 37}, "files": [{"sha": "8cd5158aca90a6dbfe14755aa13ccfc2a28b715c", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=2982f6ffc47493a6560ad8cf290c8315be5b24e2", "patch": "@@ -1,3 +1,19 @@\n+2002-10-16  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\t* include/bits/locale_facets.h (__timepunct::__timepunct): Allocate\n+\t_M_name_timepunct.\n+\t(__timepunct::~__timepunct): Deallocate, remove specialization\n+\tdeclarations.\n+\t(messages::messages): Allocate _M_name_messages.\n+\t(messages::~messages): Deallocate.\n+\t(messages_byname): Same.\n+\t* config/locale/gnu/time_members.cc (__timepunct::~__timepunct):\n+\tRemove.\n+\t* config/locale/generic/time_members.cc (__timepunct::~__timepunct):\n+\tRemove.\n+\n+\t* docs/html/install.html: Add es_MX, en_PH to required locales list.\n+\n 2002-10-16  Benjamin Kosnik  <bkoz@redhat.com>\n \n \t* config/linker-map.gnu: Add exports for codecvt constructors"}, {"sha": "fd45645a690cf59d0d63c662c8cfcdf431ee4e03", "filename": "libstdc++-v3/config/locale/generic/time_members.cc", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgeneric%2Ftime_members.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgeneric%2Ftime_members.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgeneric%2Ftime_members.cc?ref=2982f6ffc47493a6560ad8cf290c8315be5b24e2", "patch": "@@ -38,10 +38,6 @@\n \n namespace std\n {\n-  template<>\n-    __timepunct<char>::~__timepunct()\n-    { _S_destroy_c_locale(_M_c_locale_timepunct); }\n-\n   template<>\n     void\n     __timepunct<char>::\n@@ -118,10 +114,6 @@ namespace std\n     }\n \n #ifdef _GLIBCPP_USE_WCHAR_T\n-  template<>\n-    __timepunct<wchar_t>::~__timepunct()\n-    { _S_destroy_c_locale(_M_c_locale_timepunct); }\n-\n   template<>\n     void\n     __timepunct<wchar_t>::"}, {"sha": "7df10b8ab7162dff7e11eac3e02af203d46a4752", "filename": "libstdc++-v3/config/locale/gnu/time_members.cc", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgnu%2Ftime_members.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgnu%2Ftime_members.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fgnu%2Ftime_members.cc?ref=2982f6ffc47493a6560ad8cf290c8315be5b24e2", "patch": "@@ -39,10 +39,6 @@\n \n namespace std\n {\n-  template<>\n-    __timepunct<char>::~__timepunct()\n-    { _S_destroy_c_locale(_M_c_locale_timepunct); }\n-\n   template<>\n     void\n     __timepunct<char>::\n@@ -188,10 +184,6 @@ namespace std\n     }\n \n #ifdef _GLIBCPP_USE_WCHAR_T\n-  template<>\n-    __timepunct<wchar_t>::~__timepunct()\n-    { _S_destroy_c_locale(_M_c_locale_timepunct); }\n-\n   template<>\n     void\n     __timepunct<wchar_t>::"}, {"sha": "58439330200dd00a39266743a1bfb2121aa3f99e", "filename": "libstdc++-v3/docs/html/install.html", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Finstall.html", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Finstall.html", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Finstall.html?ref=2982f6ffc47493a6560ad8cf290c8315be5b24e2", "patch": "@@ -109,8 +109,8 @@ <h2><a name=\"prereqs\">Tools you will need beforehand</a></h2>\n       <p>\n       If the 'gnu' locale model is being used, the following locales\n       are used and tested in the libstdc++ testsuites: en_HK, en_US,\n-      fr_FR, fr_FR@euro, de_DE, de_DE@euro, ja_JP.eucjp, and\n-      it_IT. Failure to have the underlying \"C\" library locale\n+      fr_FR, fr_FR@euro, de_DE, de_DE@euro, ja_JP.eucjp, es_MX, en_PH,\n+      and it_IT. Failure to have the underlying \"C\" library locale\n       information installed will mean that C++ named locales for the\n       above regions will not work: because of this, the libstdc++\n       testsuite will not pass the named locale tests. If this isn't an"}, {"sha": "660bad3c11a939459c4290ee4cfc33756c32abc6", "filename": "libstdc++-v3/include/bits/locale_facets.h", "status": "modified", "additions": 35, "deletions": 19, "changes": 54, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2982f6ffc47493a6560ad8cf290c8315be5b24e2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.h?ref=2982f6ffc47493a6560ad8cf290c8315be5b24e2", "patch": "@@ -952,7 +952,7 @@ namespace std\n \n     protected:\n       __c_locale\t\t\t_M_c_locale_timepunct;\n-      const char*\t\t\t_M_name_timepunct;\n+      char*\t\t\t\t_M_name_timepunct;\n       const _CharT* \t\t\t_M_date_format;\n       const _CharT* \t\t\t_M_date_era_format;\n       const _CharT* \t\t\t_M_time_format;\n@@ -1012,13 +1012,21 @@ namespace std\n     public:\n       explicit \n       __timepunct(size_t __refs = 0) \n-      : locale::facet(__refs), _M_name_timepunct(\"C\")\n-      { _M_initialize_timepunct(); }\n+      : locale::facet(__refs)\n+      { \n+\t_M_name_timepunct = new char[2];\n+\tstrcpy(_M_name_timepunct, \"C\");\n+\t_M_initialize_timepunct(); \n+      }\n \n       explicit \n       __timepunct(__c_locale __cloc, const char* __s, size_t __refs = 0) \n-      : locale::facet(__refs), _M_name_timepunct(__s)\n-      { _M_initialize_timepunct(__cloc); }\n+      : locale::facet(__refs)\n+      { \n+\t_M_name_timepunct = new char[strlen(__s) + 1];\n+\tstrcpy(_M_name_timepunct, __s);\n+\t_M_initialize_timepunct(__cloc); \n+      }\n \n       void\n       _M_put(_CharT* __s, size_t __maxlen, const _CharT* __format, \n@@ -1115,7 +1123,11 @@ namespace std\n \n     protected:\n       virtual \n-      ~__timepunct();\n+      ~__timepunct()\n+      { \n+\tdelete [] _M_name_timepunct;\n+\t_S_destroy_c_locale(_M_c_locale_timepunct); \n+      }\n \n       // For use at construction time only.\n       void \n@@ -1126,9 +1138,6 @@ namespace std\n     locale::id __timepunct<_CharT>::id;\n \n   // Specializations.\n-  template<>\n-    __timepunct<char>::~__timepunct();\n-\n   template<> \n     const char*\n     __timepunct<char>::_S_timezones[14];\n@@ -1142,9 +1151,6 @@ namespace std\n     __timepunct<char>::_M_put(char*, size_t, const char*, const tm*) const;\n \n #ifdef _GLIBCPP_USE_WCHAR_T\n-  template<>\n-    __timepunct<wchar_t>::~__timepunct();\n-\n   template<> \n     const wchar_t*\n     __timepunct<wchar_t>::_S_timezones[14];\n@@ -1624,23 +1630,28 @@ namespace std\n       __c_locale\t\t\t_M_c_locale_messages;\n #if 1\n       // Only needed if glibc < 2.3\n-      const char*\t\t\t_M_name_messages;\n+      char*\t\t\t\t_M_name_messages;\n #endif\n \n     public:\n       static locale::id \t\tid;\n \n       explicit \n       messages(size_t __refs = 0) \n-      : locale::facet(__refs), _M_name_messages(\"C\")\n-      { _M_c_locale_messages = _S_c_locale; }\n+      : locale::facet(__refs)\n+      { \n+\t_M_name_messages = new char[2];\n+\tstrcpy(_M_name_messages, \"C\");\n+\t_M_c_locale_messages = _S_c_locale; \n+      }\n \n       // Non-standard.\n       explicit \n-      messages(__c_locale __cloc, const char* __name, size_t __refs = 0) \n+      messages(__c_locale __cloc, const char* __s, size_t __refs = 0) \n       : locale::facet(__refs)\n       { \n-\t_M_name_messages = __name;\n+\t_M_name_messages = new char[strlen(__s) + 1];\n+\tstrcpy(_M_name_messages, __s);\n \t_M_c_locale_messages = _S_clone_c_locale(__cloc); \n       }\n \n@@ -1663,7 +1674,10 @@ namespace std\n     protected:\n       virtual \n       ~messages()\n-       { _S_destroy_c_locale(_M_c_locale_messages); }\n+       { \n+\t delete [] _M_name_messages;\n+\t _S_destroy_c_locale(_M_c_locale_messages); \n+       }\n \n       virtual catalog \n       do_open(const basic_string<char>&, const locale&) const;\n@@ -1751,7 +1765,9 @@ namespace std\n       messages_byname(const char* __s, size_t __refs = 0)\n       : messages<_CharT>(__refs) \n       { \n-\t_M_name_messages = __s;\n+\tdelete [] _M_name_messages;\n+\t_M_name_messages = new char[strlen(__s) + 1];\n+\tstrcpy(_M_name_messages, __s);\n \t_S_destroy_c_locale(_M_c_locale_messages);\n \t_S_create_c_locale(_M_c_locale_messages, __s); \n       }"}]}