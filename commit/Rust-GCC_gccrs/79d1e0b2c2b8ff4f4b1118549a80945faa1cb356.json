{"sha": "79d1e0b2c2b8ff4f4b1118549a80945faa1cb356", "node_id": "C_kwDOANBUbNoAKDc5ZDFlMGIyYzJiOGZmNGY0YjExMTg1NDlhODA5NDVmYWExY2IzNTY", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2023-03-30T12:03:11Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2023-03-31T09:38:18Z"}, "message": "c++tools: Fix Makefile to properly clean and rebuild [PR101834]\n\nThe c++tools makefile doesn't remove progressively more files in each of\nmostlyclean, clean, and distclean. Instead, each removes a different set\nof files (and some files are not removed by any target). Use\nprerequisites so that everything is removed.\n\nAlso, building in the $objdir/c++tools directory doesn't work, because\nthe INSTALL variable is never set. It works when building from the\ntop-level because INSTALL is set in the environment when recursively\ninvoking make for sub-directories.\n\nc++tools/ChangeLog:\n\n\tPR bootstrap/101834\n\t* Makefile.in (INSTALL): Set variable.\n\t(mostlyclean): Mark as a phony target.\n\t(clean): Add mostlyclean as a prerequisite.\n\t(distclean): Add clean as a prerequisite and remove more files.\n\t(maintainer-clean): Add distclean as a prerequisite.", "tree": {"sha": "c78bc8c8aec0554e5811a7f873a9faddee18e4ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c78bc8c8aec0554e5811a7f873a9faddee18e4ce"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/79d1e0b2c2b8ff4f4b1118549a80945faa1cb356", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79d1e0b2c2b8ff4f4b1118549a80945faa1cb356", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79d1e0b2c2b8ff4f4b1118549a80945faa1cb356", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79d1e0b2c2b8ff4f4b1118549a80945faa1cb356/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "608388486a54afe98aed0f105a6101ae7a9ff66c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/608388486a54afe98aed0f105a6101ae7a9ff66c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/608388486a54afe98aed0f105a6101ae7a9ff66c"}], "stats": {"total": 12, "additions": 7, "deletions": 5}, "files": [{"sha": "77bda3d56dc16af82eef7c718b223c945c5c13c1", "filename": "c++tools/Makefile.in", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/79d1e0b2c2b8ff4f4b1118549a80945faa1cb356/c%2B%2Btools%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/79d1e0b2c2b8ff4f4b1118549a80945faa1cb356/c%2B%2Btools%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/c%2B%2Btools%2FMakefile.in?ref=79d1e0b2c2b8ff4f4b1118549a80945faa1cb356", "patch": "@@ -22,6 +22,7 @@ libexecdir := @libexecdir@\n target_noncanonical := @target_noncanonical@\n gcc_version := $(shell @get_gcc_base_ver@ $(srcdir)/../gcc/BASE-VER)\n libexecsubdir := $(libexecdir)/gcc/$(target_noncanonical)/$(gcc_version)\n+INSTALL := @INSTALL@\n INSTALL_PROGRAM := @INSTALL_PROGRAM@\n INSTALL_STRIP_PROGRAM := $(srcdir)/../install-sh -c -s\n AUTOCONF := @AUTOCONF@\n@@ -41,13 +42,14 @@ all::\n mostlyclean::\n \trm -f $(MAPPER.O)\n \n-clean::\n+clean:: mostlyclean\n \trm -f g++-mapper-server$(exeext)\n \n-distclean::\n-\trm -f config.log config.status config.h\n+distclean:: clean\n+\trm -f config.log config.status config.h config.cache Makefile\n+\trm -f $(MAPPER.O:%.o=%.d)\n \n-maintainer-clean::\n+maintainer-clean:: distclean\n \n install::\n \n@@ -132,6 +134,6 @@ config.h: config.status config.h.in\n config.status: $(srcdir)/configure $(srcdir)/config.h.in\n \tif test -x $@; then ./$@ -recheck; else $< @configure_args@; fi\n \n-.PHONY: all check clean distclean maintainer-clean\n+.PHONY: all check mostlyclean clean distclean maintainer-clean\n \n -include $(MAPPER.O:.o=.d)"}]}