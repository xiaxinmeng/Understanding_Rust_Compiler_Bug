{"sha": "64fe5271963de7f68994ce99bda3a380f20b5dbe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjRmZTUyNzE5NjNkZTdmNjg5OTRjZTk5YmRhM2EzODBmMjBiNWRiZQ==", "commit": {"author": {"name": "Kazu Hirata", "email": "kazu@cs.umass.edu", "date": "2005-05-03T16:44:24Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2005-05-03T16:44:24Z"}, "message": "tree-mudflap.c (deferred_static_decls, [...]): Use VEC instead of VARRAY.\n\n\t* tree-mudflap.c (deferred_static_decls, mudflap_enqueue_decl,\n\tmudflap_finish_file, mudflap_finish_file): Use VEC instead of\n\tVARRAY.\n\nFrom-SVN: r99164", "tree": {"sha": "79d150c01f035c053db7e2541d526f8e2688fa5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/79d150c01f035c053db7e2541d526f8e2688fa5d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/64fe5271963de7f68994ce99bda3a380f20b5dbe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64fe5271963de7f68994ce99bda3a380f20b5dbe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64fe5271963de7f68994ce99bda3a380f20b5dbe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64fe5271963de7f68994ce99bda3a380f20b5dbe/comments", "author": null, "committer": null, "parents": [{"sha": "88c710ec5e0bda2dfa89de40018fefcaa5a8e551", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88c710ec5e0bda2dfa89de40018fefcaa5a8e551", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88c710ec5e0bda2dfa89de40018fefcaa5a8e551"}], "stats": {"total": 18, "additions": 9, "deletions": 9}, "files": [{"sha": "defdebb2817566ead036100f20979725c2c0d232", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/64fe5271963de7f68994ce99bda3a380f20b5dbe/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/64fe5271963de7f68994ce99bda3a380f20b5dbe/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=64fe5271963de7f68994ce99bda3a380f20b5dbe", "patch": "@@ -6,6 +6,10 @@\n \tinsn_locators_initialize, insn_scope): Use VEC instead of\n \tVARRAY.\n \n+\t* tree-mudflap.c (deferred_static_decls, mudflap_enqueue_decl,\n+\tmudflap_finish_file, mudflap_finish_file): Use VEC instead of\n+\tVARRAY.\n+\n 2005-05-03  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \t* config/sparc/predicates.md (const_compl_high_operand): New."}, {"sha": "04282a883208c3ebfdbe847324555db6344cb79c", "filename": "gcc/tree-mudflap.c", "status": "modified", "additions": 5, "deletions": 9, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/64fe5271963de7f68994ce99bda3a380f20b5dbe/gcc%2Ftree-mudflap.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/64fe5271963de7f68994ce99bda3a380f20b5dbe/gcc%2Ftree-mudflap.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-mudflap.c?ref=64fe5271963de7f68994ce99bda3a380f20b5dbe", "patch": "@@ -1148,7 +1148,7 @@ mf_marked_p (tree t)\n    delayed until program finish time.  If they're still incomplete by\n    then, warnings are emitted.  */\n \n-static GTY (()) varray_type deferred_static_decls;\n+static GTY (()) VEC(tree,gc) *deferred_static_decls;\n \n /* A list of statements for calling __mf_register() at startup time.  */\n static GTY (()) tree enqueued_call_stmt_chain;\n@@ -1189,10 +1189,7 @@ mudflap_enqueue_decl (tree obj)\n   if (DECL_P (obj) && DECL_EXTERNAL (obj) && DECL_ARTIFICIAL (obj))\n     return;\n \n-  if (! deferred_static_decls)\n-    VARRAY_TREE_INIT (deferred_static_decls, 10, \"deferred static list\");\n-\n-  VARRAY_PUSH_TREE (deferred_static_decls, obj);\n+  VEC_safe_push (tree, gc, deferred_static_decls, obj);\n }\n \n \n@@ -1243,10 +1240,9 @@ mudflap_finish_file (void)\n   if (deferred_static_decls)\n     {\n       size_t i;\n-      for (i = 0; i < VARRAY_ACTIVE_SIZE (deferred_static_decls); i++)\n+      tree obj;\n+      for (i = 0; VEC_iterate (tree, deferred_static_decls, i, obj); i++)\n         {\n-          tree obj = VARRAY_TREE (deferred_static_decls, i);\n-\n           gcc_assert (DECL_P (obj));\n \n           if (mf_marked_p (obj))\n@@ -1271,7 +1267,7 @@ mudflap_finish_file (void)\n                                  mf_varname_tree (obj));\n         }\n \n-      VARRAY_CLEAR (deferred_static_decls);\n+      VEC_truncate (tree, deferred_static_decls, 0);\n     }\n \n   /* Append all the enqueued registration calls.  */"}]}