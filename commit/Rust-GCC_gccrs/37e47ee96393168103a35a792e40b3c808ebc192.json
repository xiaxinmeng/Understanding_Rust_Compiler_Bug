{"sha": "37e47ee96393168103a35a792e40b3c808ebc192", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzdlNDdlZTk2MzkzMTY4MTAzYTM1YTc5MmU0MGIzYzgwOGViYzE5Mg==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-03-28T10:13:50Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-03-28T10:13:50Z"}, "message": "re PR fortran/26779 (Internal module procedure may not have private type dummy arguments)\n\n2006-03-28 Paul Thomas <pault@gcc.gnu.org>\n\n\tPR fortran/26779\n\t*resolve.c (resolve_fl_procedure): Do not check the access of\n\tderived types for internal procedures.\n\n\n2006-03-28 Paul Thomas <pault@gcc.gnu.org>\n\n\tPR fortran/26779\n\t* gfortran.dg/private_type_5.f90: New test.\n\nFrom-SVN: r112442", "tree": {"sha": "67e215c9e639e3eb52fdc4220f02441cfda969a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/67e215c9e639e3eb52fdc4220f02441cfda969a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/37e47ee96393168103a35a792e40b3c808ebc192", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37e47ee96393168103a35a792e40b3c808ebc192", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37e47ee96393168103a35a792e40b3c808ebc192", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37e47ee96393168103a35a792e40b3c808ebc192/comments", "author": null, "committer": null, "parents": [{"sha": "7f166b0a8e4cf02f0e297429471ab95078820a48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f166b0a8e4cf02f0e297429471ab95078820a48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f166b0a8e4cf02f0e297429471ab95078820a48"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "d2a1e4fc66dd5c1d164c9d3164cba86923a8eaab", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=37e47ee96393168103a35a792e40b3c808ebc192", "patch": "@@ -1,3 +1,9 @@\n+2006-03-28 Paul Thomas <pault@gcc.gnu.org>\n+\n+\tPR fortran/26779\n+\t*resolve.c (resolve_fl_procedure): Do not check the access of\n+\tderived types for internal procedures.\n+\n 2006-03-27  Jakub Jelinek  <jakub@redhat.com>\n \n \t* io.c (check_io_constraints): Don't look at"}, {"sha": "562338fdb6454d0e50fd2750ebee126b2ca4351e", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=37e47ee96393168103a35a792e40b3c808ebc192", "patch": "@@ -4834,9 +4834,13 @@ resolve_fl_procedure (gfc_symbol *sym, int mp_flag)\n         }\n     }\n \n-  /* Ensure that derived type formal arguments of a public procedure\n-     are not of a private type.  */\n-  if (gfc_check_access(sym->attr.access, sym->ns->default_access))\n+  /* Ensure that derived type for are not of a private type.  Internal\n+     module procedures are excluded by 2.2.3.3 - ie. they are not\n+     externally accessible and can access all the objects accesible in\n+     the host. */\n+  if (!(sym->ns->parent\n+\t    && sym->ns->parent->proc_name->attr.flavor == FL_MODULE)\n+\t&& gfc_check_access(sym->attr.access, sym->ns->default_access))\n     {\n       for (arg = sym->formal; arg; arg = arg->next)\n \t{"}, {"sha": "c2383d247b5db5b1fda5a27eb0228b0149e7f3d4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=37e47ee96393168103a35a792e40b3c808ebc192", "patch": "@@ -1,3 +1,8 @@\n+2006-03-28 Paul Thomas <pault@gcc.gnu.org>\n+\n+\tPR fortran/26779\n+\t* gfortran.dg/private_type_5.f90: New test.\n+\n 2006-03-27  David Edelsohn  <edelsohn@gnu.org>\n \n \t* objc.dg/objc-nofilename-1.m: Limit to Darwin."}, {"sha": "e62fe6e21c451ee833b6cf6b124128120f1ad9d0", "filename": "gcc/testsuite/gfortran.dg/private_type_5.f90", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_5.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37e47ee96393168103a35a792e40b3c808ebc192/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_5.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fprivate_type_5.f90?ref=37e47ee96393168103a35a792e40b3c808ebc192", "patch": "@@ -0,0 +1,24 @@\n+! { dg-do compile }\n+! Tests the fix for PR26779, where an error would occur because\n+! init was detected to be public with a private type dummy argument.\n+!\n+! Contributed by Paul Thomas  <pault@gcc.gnu.org>\n+!\n+module test\n+  public sub\n+  type, private :: t\n+    integer :: i\n+  end type t\n+contains\n+  subroutine sub (arg)\n+    integer arg\n+    type(t) :: root\n+    call init(root, arg)\n+  contains\n+    subroutine init(ir, i)\n+      integer i\n+      type(t) :: ir\n+      ir%i = i\n+    end subroutine init\n+  end subroutine sub\n+end module test\n\\ No newline at end of file"}]}