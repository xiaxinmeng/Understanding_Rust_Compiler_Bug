{"sha": "677ff44144c9a085fd89f336776cbac272df05cf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Njc3ZmY0NDE0NGM5YTA4NWZkODlmMzM2Nzc2Y2JhYzI3MmRmMDVjZg==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-04-06T19:30:45Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-04-06T19:30:45Z"}, "message": "(decl_attributes...\n\n(decl_attributes, format case): Error if num_arg does\nnot point to a string type argument, or if first_arg_num not the\nanonymous argument.\n\nFrom-SVN: r4032", "tree": {"sha": "1631746372fc920493ae32ffee6b26f284c0bb88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1631746372fc920493ae32ffee6b26f284c0bb88"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/677ff44144c9a085fd89f336776cbac272df05cf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/677ff44144c9a085fd89f336776cbac272df05cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/677ff44144c9a085fd89f336776cbac272df05cf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/677ff44144c9a085fd89f336776cbac272df05cf/comments", "author": null, "committer": null, "parents": [{"sha": "1b8297c13f94c9dd27b5f726d388cc09d2d8a391", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b8297c13f94c9dd27b5f726d388cc09d2d8a391", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1b8297c13f94c9dd27b5f726d388cc09d2d8a391"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "e4d161f75fd5e559ec9ca1b815f9be927c414883", "filename": "gcc/c-common.c", "status": "modified", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/677ff44144c9a085fd89f336776cbac272df05cf/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/677ff44144c9a085fd89f336776cbac272df05cf/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=677ff44144c9a085fd89f336776cbac272df05cf", "patch": "@@ -275,6 +275,8 @@ decl_attributes (decl, attributes)\n \tint format_num = TREE_INT_CST_LOW (TREE_PURPOSE (TREE_VALUE (list)));\n \tint first_arg_num = TREE_INT_CST_LOW (TREE_VALUE (TREE_VALUE (list)));\n \tint is_scan;\n+\ttree argument;\n+\tint arg_num;\n \t\n \tif (TREE_CODE (decl) != FUNCTION_DECL)\n \t  {\n@@ -299,6 +301,34 @@ decl_attributes (decl, attributes)\n \t\t\"format string arg follows the args to be formatted, for `%s'\");\n \t    return;\n \t  }\n+\n+\t/* Verify that the format_num argument is actually a string, in case\n+\t   the format attribute is in error.  */\n+\targument = TYPE_ARG_TYPES (TREE_TYPE (decl));\n+\tfor (arg_num = 1; ; ++arg_num)\n+\t  {\n+\t    if (argument == 0 || arg_num == format_num)\n+\t      break;\n+\t    argument = TREE_CHAIN (argument);\n+\t  }\n+\tif (! argument\n+\t    || TREE_CODE (TREE_VALUE (argument)) != POINTER_TYPE\n+\t    || (TYPE_MAIN_VARIANT (TREE_TYPE (TREE_VALUE (argument)))\n+\t\t!= char_type_node))\n+\t  {\n+\t    error_with_decl (decl,\n+\t\t\t     \"format string arg not a string type, for `%s'\");\n+\t    return;\n+\t  }\n+\t/* Verify that first_arg_num points to the last argument, the ... */\n+\twhile (argument)\n+\t  arg_num++, argument = TREE_CHAIN (argument);\n+\tif (arg_num != first_arg_num)\n+\t  {\n+\t    error_with_decl (decl,\n+\t\t\t     \"args to be formatted is not ..., for `%s'\");\n+\t    return;\n+\t  }\n \t\n \trecord_format_info (DECL_NAME (decl), is_scan, format_num,\n \t\t\t    first_arg_num);"}]}