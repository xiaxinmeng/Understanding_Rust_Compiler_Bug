{"sha": "a50f2a09bad28c34417b321ca0ce3ea7a793a3d6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTUwZjJhMDliYWQyOGMzNDQxN2IzMjFjYTBjZTNlYTdhNzkzYTNkNg==", "commit": {"author": {"name": "Andrew Cagney", "email": "cagney@b1.cygnus.com", "date": "1999-02-22T19:38:39Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1999-02-22T19:38:39Z"}, "message": "Fix mips16 debug info problems with frame address.\n\n\t* config/mips/mips.c (mips_debugger_offset): When TARGET_MIPS16 &&\n \tframe_pointer_needed adjust frame size.\n\t(function_prologue): Don't MIPS16 .mask GPOFFSET. Already adjusted\n \tin .frame pseudo-op.\n\tFrm Jim Wilson  <wilson@cygnus.com>:\n\t* mips.c (function_prologue): Adjust frame size in .frame pseudo-op\n\twhen TARGET_MIPS16 && frame_pointer_needed.\n\nFrom-SVN: r25382", "tree": {"sha": "69af8ad6974b103f962e62d86bce92974bf2ce31", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/69af8ad6974b103f962e62d86bce92974bf2ce31"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6/comments", "author": null, "committer": null, "parents": [{"sha": "3b7265ff89ae9a1fad9fc05b055274513bf0d7c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b7265ff89ae9a1fad9fc05b055274513bf0d7c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b7265ff89ae9a1fad9fc05b055274513bf0d7c2"}], "stats": {"total": 30, "additions": 25, "deletions": 5}, "files": [{"sha": "909637b91e88a392816694b1320b189e60dfef0b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a50f2a09bad28c34417b321ca0ce3ea7a793a3d6", "patch": "@@ -1,3 +1,13 @@\n+Mon Feb 22 19:36:33 1999  Andrew Cagney  <cagney@b1.cygnus.com>\n+\n+\t* config/mips/mips.c (mips_debugger_offset): When TARGET_MIPS16 &&\n+ \tframe_pointer_needed adjust frame size.\n+\t(function_prologue): Don't MIPS16 .mask GPOFFSET. Already adjusted\n+ \tin .frame pseudo-op.\n+\tFrm Jim Wilson  <wilson@cygnus.com>:\n+\t* mips.c (function_prologue): Adjust frame size in .frame pseudo-op\n+\twhen TARGET_MIPS16 && frame_pointer_needed.\n+\n 1999-02-22  Nick Clifton  <nickc@cygnus.com>\n \n \t* config/arm/arm.h: Add TARGET_CPU_strongarm1100."}, {"sha": "6491b71168ff709259525efa67172b194f5c88c0", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50f2a09bad28c34417b321ca0ce3ea7a793a3d6/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=a50f2a09bad28c34417b321ca0ce3ea7a793a3d6", "patch": "@@ -4545,6 +4545,10 @@ mips_debugger_offset (addr, offset)\n \t\t\t\t  ? compute_frame_size (get_frame_size ())\n \t\t\t\t  : current_frame_info.total_size;\n \n+      /* MIPS16 frame is smaller */\n+      if (frame_pointer_needed && TARGET_MIPS16)\n+\tframe_size -= current_function_outgoing_args_size;\n+\n       offset = offset - frame_size;\n     }\n \n@@ -6115,25 +6119,31 @@ function_prologue (file, size)\n \n   if (!flag_inhibit_size_directive)\n     {\n+      /* .frame FRAMEREG, FRAMESIZE, RETREG */\n       fprintf (file,\n \t       \"\\t.frame\\t%s,%ld,%s\\t\\t# vars= %ld, regs= %d/%d, args= %d, extra= %ld\\n\",\n \t       (reg_names[(frame_pointer_needed)\n \t\t\t  ? HARD_FRAME_POINTER_REGNUM : STACK_POINTER_REGNUM]),\n-\t       tsize, reg_names[31 + GP_REG_FIRST],\n+\t       ((frame_pointer_needed && TARGET_MIPS16)\n+\t\t? (tsize - current_function_outgoing_args_size)\n+\t\t: tsize),\n+\t       reg_names[31 + GP_REG_FIRST],\n \t       current_frame_info.var_size,\n \t       current_frame_info.num_gp,\n \t       current_frame_info.num_fp,\n \t       current_function_outgoing_args_size,\n \t       current_frame_info.extra_size);\n \n+      /* .mask MASK, GPOFFSET; .fmask FPOFFSET */\n       fprintf (file, \"\\t.mask\\t0x%08lx,%ld\\n\\t.fmask\\t0x%08lx,%ld\\n\",\n \t       current_frame_info.mask,\n-\t       ((frame_pointer_needed && TARGET_MIPS16)\n-\t\t? (current_frame_info.gp_save_offset\n-\t\t   - current_function_outgoing_args_size)\n-\t\t: current_frame_info.gp_save_offset),\n+\t       current_frame_info.gp_save_offset,\n \t       current_frame_info.fmask,\n \t       current_frame_info.fp_save_offset);\n+\n+      /* Require:\n+\t OLD_SP == *FRAMEREG + FRAMESIZE => can find old_sp from nominated FP reg.\n+\t HIGHEST_GP_SAVED == *FRAMEREG + FRAMESIZE + GPOFFSET => can find saved regs. */\n     }\n \n   if (mips_entry && ! mips_can_use_return_insn ())"}]}