{"sha": "94cf7a2d95bf6db873cdcc4085a697ad40057957", "node_id": "C_kwDOANBUbNoAKDk0Y2Y3YTJkOTViZjZkYjg3M2NkY2M0MDg1YTY5N2FkNDAwNTc5NTc", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2022-12-21T03:04:54Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2022-12-21T03:04:54Z"}, "message": "fold-const: Treat fp conversion to a type with same mode as copy\n\nIn function fold_convert_const_real_from_real, when the modes of\ntwo types involved in fp conversion are the same, we can simply\ntake it as copy, rebuild with the exactly same TREE_REAL_CST and\nthe target type.  It is more efficient and helps to avoid possible\nunexpected signalling bit clearing in [1].\n\n[1] https://gcc.gnu.org/pipermail/gcc-patches/2022-December/608533.html\n\ngcc/ChangeLog:\n\n\t* fold-const.cc (fold_convert_const_real_from_real): Treat floating\n\tpoint conversion to a type with same mode as copy instead of normal\n\tconvertFormat.", "tree": {"sha": "37ca3926fd5fcbb1e8d9ba22b476cbcc2dafb897", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/37ca3926fd5fcbb1e8d9ba22b476cbcc2dafb897"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/94cf7a2d95bf6db873cdcc4085a697ad40057957", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94cf7a2d95bf6db873cdcc4085a697ad40057957", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94cf7a2d95bf6db873cdcc4085a697ad40057957", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94cf7a2d95bf6db873cdcc4085a697ad40057957/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "282462b39584ae49eaaa6f53bd44b6cfdc4ccbcb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/282462b39584ae49eaaa6f53bd44b6cfdc4ccbcb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/282462b39584ae49eaaa6f53bd44b6cfdc4ccbcb"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "d4ee3b30983427a9c922a134dd7e879f04b2260d", "filename": "gcc/fold-const.cc", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94cf7a2d95bf6db873cdcc4085a697ad40057957/gcc%2Ffold-const.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94cf7a2d95bf6db873cdcc4085a697ad40057957/gcc%2Ffold-const.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.cc?ref=94cf7a2d95bf6db873cdcc4085a697ad40057957", "patch": "@@ -2178,6 +2178,15 @@ fold_convert_const_real_from_real (tree type, const_tree arg1)\n   REAL_VALUE_TYPE value;\n   tree t;\n \n+  /* If the underlying modes are the same, simply treat it as\n+     copy and rebuild with TREE_REAL_CST information and the\n+     given type.  */\n+  if (TYPE_MODE (type) == TYPE_MODE (TREE_TYPE (arg1)))\n+    {\n+      t = build_real (type, TREE_REAL_CST (arg1));\n+      return t;\n+    }\n+\n   /* Don't perform the operation if flag_signaling_nans is on\n      and the operand is a signaling NaN.  */\n   if (HONOR_SNANS (arg1)"}]}