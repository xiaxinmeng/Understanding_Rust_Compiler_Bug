{"sha": "601a5d76ca67442686facfb179aac2064003bb99", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjAxYTVkNzZjYTY3NDQyNjg2ZmFjZmIxNzlhYWMyMDY0MDAzYmI5OQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-09-07T19:46:14Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-09-07T19:46:14Z"}, "message": "re PR target/50310 (ICE: in gen_vcondv2div2df, at config/i386/sse.md:1435 with -O -ftree-vectorize and __builtin_isunordered())\n\n\t* config/i386/sse.md (sseinsnmode): Remove 32-byte integer vector\n\tduplicates.\n\n\tPR target/50310\n\t* config/i386/sse.md (*andnot<mode>3, *<code><mode>3): Fix up\n\t\"mode\" attribute computation.\n\n\t* gcc.dg/pr50310-1.c: New test.\n\nFrom-SVN: r178659", "tree": {"sha": "07610fd16628deefb29f1d6e4884af2dad75f7e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/07610fd16628deefb29f1d6e4884af2dad75f7e0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/601a5d76ca67442686facfb179aac2064003bb99", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/601a5d76ca67442686facfb179aac2064003bb99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/601a5d76ca67442686facfb179aac2064003bb99", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/601a5d76ca67442686facfb179aac2064003bb99/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ca1ae7e38dc2cfbb9e62e49ad6bbcc35f6038a7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca1ae7e38dc2cfbb9e62e49ad6bbcc35f6038a7c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca1ae7e38dc2cfbb9e62e49ad6bbcc35f6038a7c"}], "stats": {"total": 56, "additions": 43, "deletions": 13}, "files": [{"sha": "3f79363feaf8ca654be6edf8406489d065b262cf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/601a5d76ca67442686facfb179aac2064003bb99/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/601a5d76ca67442686facfb179aac2064003bb99/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=601a5d76ca67442686facfb179aac2064003bb99", "patch": "@@ -1,3 +1,12 @@\n+2011-09-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* config/i386/sse.md (sseinsnmode): Remove 32-byte integer vector\n+\tduplicates.\n+\n+\tPR target/50310\n+\t* config/i386/sse.md (*andnot<mode>3, *<code><mode>3): Fix up\n+\t\"mode\" attribute computation.\n+\n 2011-09-07  Bernd Schmidt  <bernds@codesourcery.com>\n \n \t* regrename.c (struct du_head): Make nregs signed."}, {"sha": "e96fb7d300c2bc8a6146d884fd03a83e231ad94f", "filename": "gcc/config/i386/sse.md", "status": "modified", "additions": 11, "deletions": 13, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/601a5d76ca67442686facfb179aac2064003bb99/gcc%2Fconfig%2Fi386%2Fsse.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/601a5d76ca67442686facfb179aac2064003bb99/gcc%2Fconfig%2Fi386%2Fsse.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsse.md?ref=601a5d76ca67442686facfb179aac2064003bb99", "patch": "@@ -229,7 +229,7 @@\n    (V16QI \"TI\") (V8HI \"TI\") (V4SI \"TI\") (V2DI \"TI\") (V1TI \"TI\")\n    (V8SF \"V8SF\") (V4DF \"V4DF\")\n    (V4SF \"V4SF\") (V2DF \"V2DF\")\n-   (TI \"TI\") (V32QI \"OI\") (V16HI \"OI\") (V8SI \"OI\") (V4DI \"OI\")])\n+   (TI \"TI\")])\n \n ;; Mapping of vector float modes to an integer mode of the same size\n (define_mode_attr sseintvecmode\n@@ -6340,14 +6340,13 @@\n        (const_string \"*\")))\n    (set_attr \"prefix\" \"orig,vex\")\n    (set (attr \"mode\")\n-     (cond [(match_test \"TARGET_AVX2\")\n-\t      (const_string \"OI\")\n-\t    (match_test \"GET_MODE_SIZE (<MODE>mode) > 128\")\n+     (cond [(and (not (match_test \"TARGET_AVX2\"))\n+\t\t (match_test \"GET_MODE_SIZE (<MODE>mode) > 16\"))\n \t      (const_string \"V8SF\")\n-\t    (match_test \"TARGET_SSE2\")\n-\t      (const_string \"TI\")\n+\t    (not (match_test \"TARGET_SSE2\"))\n+\t      (const_string \"V4SF\")\n \t   ]\n-\t   (const_string \"V4SF\")))])\n+\t   (const_string \"<sseinsnmode>\")))])\n \n (define_expand \"<code><mode>3\"\n   [(set (match_operand:VI 0 \"register_operand\" \"\")\n@@ -6416,14 +6415,13 @@\n        (const_string \"*\")))\n    (set_attr \"prefix\" \"orig,vex\")\n    (set (attr \"mode\")\n-     (cond [(match_test \"TARGET_AVX2\")\n-\t      (const_string \"OI\")\n-\t    (match_test \"GET_MODE_SIZE (<MODE>mode) > 128\")\n+     (cond [(and (not (match_test \"TARGET_AVX2\"))\n+\t\t (match_test \"GET_MODE_SIZE (<MODE>mode) > 16\"))\n \t      (const_string \"V8SF\")\n-\t    (match_test \"TARGET_SSE2\")\n-\t      (const_string \"TI\")\n+\t    (not (match_test \"TARGET_SSE2\"))\n+\t      (const_string \"V4SF\")\n \t   ]\n-\t   (const_string \"V4SF\")))])\n+\t   (const_string \"<sseinsnmode>\")))])\n \n (define_insn \"*andnottf3\"\n   [(set (match_operand:TF 0 \"register_operand\" \"=x,x\")"}, {"sha": "61c6c95567a05ecc0f22c8e29d98dd11cae3aff1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/601a5d76ca67442686facfb179aac2064003bb99/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/601a5d76ca67442686facfb179aac2064003bb99/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=601a5d76ca67442686facfb179aac2064003bb99", "patch": "@@ -1,3 +1,8 @@\n+2011-09-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/50310\n+\t* gcc.dg/pr50310-1.c: New test.\n+\n 2011-09-07  Georg-Johann Lay  <avr@gjlay.de>\n \n \tPR middle-end/48571"}, {"sha": "e82276677eab836c71b5862d33637cca8dcc11ab", "filename": "gcc/testsuite/gcc.dg/pr50310-1.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/601a5d76ca67442686facfb179aac2064003bb99/gcc%2Ftestsuite%2Fgcc.dg%2Fpr50310-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/601a5d76ca67442686facfb179aac2064003bb99/gcc%2Ftestsuite%2Fgcc.dg%2Fpr50310-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr50310-1.c?ref=601a5d76ca67442686facfb179aac2064003bb99", "patch": "@@ -0,0 +1,18 @@\n+/* PR target/50310 */\n+/* { dg-do run } */\n+/* { dg-options \"-O3\" } */\n+/* { dg-options \"-O3 -mavx -mno-avx2\" { target avx_runtime } } */\n+\n+double s1[4], s2[4];\n+long long e[4];\n+\n+int\n+main ()\n+{\n+  int i;\n+  asm volatile (\"\" : : : \"memory\");\n+  for (i = 0; i < 4; i++)\n+    e[i] = __builtin_isunordered (s1[i], s2[i]) && s1[i] != s2[i] ? -1 : 0;\n+  asm volatile (\"\" : : : \"memory\");\n+  return 0;\n+}"}]}