{"sha": "6a920eb51077cd465472eabb24a49b3e4ca30e93", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmE5MjBlYjUxMDc3Y2Q0NjU0NzJlYWJiMjRhNDliM2U0Y2EzMGU5Mw==", "commit": {"author": {"name": "Bob Duff", "email": "duff@adacore.com", "date": "2020-03-30T19:34:28Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2020-06-15T08:04:25Z"}, "message": "[Ada] Put_Image: Enable for access-to-subprogram types\n\n2020-06-15  Bob Duff  <duff@adacore.com>\n\ngcc/ada/\n\n\t* exp_put_image.adb, libgnat/s-putima.adb, libgnat/s-putima.ads,\n\trtsfind.ads: Enable Put_Image if Is_Access_Subprogram_Type (Typ).\n\tRemove comment saying it's disabled in that case.  Rename\n\tPut_Image_Access_Prot to be Put_Image_Access_Prot_Subp to\n\tclarify that we're talking about access-to-subprogram, not\n\taccess-to-protected-object.", "tree": {"sha": "1b216d0340468657aafd593d64c028844b310336", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1b216d0340468657aafd593d64c028844b310336"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6a920eb51077cd465472eabb24a49b3e4ca30e93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a920eb51077cd465472eabb24a49b3e4ca30e93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a920eb51077cd465472eabb24a49b3e4ca30e93", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a920eb51077cd465472eabb24a49b3e4ca30e93/comments", "author": {"login": "bobduff", "id": 29099567, "node_id": "MDQ6VXNlcjI5MDk5NTY3", "avatar_url": "https://avatars.githubusercontent.com/u/29099567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobduff", "html_url": "https://github.com/bobduff", "followers_url": "https://api.github.com/users/bobduff/followers", "following_url": "https://api.github.com/users/bobduff/following{/other_user}", "gists_url": "https://api.github.com/users/bobduff/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobduff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobduff/subscriptions", "organizations_url": "https://api.github.com/users/bobduff/orgs", "repos_url": "https://api.github.com/users/bobduff/repos", "events_url": "https://api.github.com/users/bobduff/events{/privacy}", "received_events_url": "https://api.github.com/users/bobduff/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6349cf36d8bb7fb83f67a7bc27fc67dca73b19dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6349cf36d8bb7fb83f67a7bc27fc67dca73b19dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6349cf36d8bb7fb83f67a7bc27fc67dca73b19dd"}], "stats": {"total": 20, "additions": 9, "deletions": 11}, "files": [{"sha": "0fa4304e19433ea180ed5328f34ac8c414018ae9", "filename": "gcc/ada/exp_put_image.adb", "status": "modified", "additions": 1, "deletions": 6, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Fexp_put_image.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Fexp_put_image.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_put_image.adb?ref=6a920eb51077cd465472eabb24a49b3e4ca30e93", "patch": "@@ -315,7 +315,7 @@ package body Exp_Put_Image is\n \n       elsif Is_Access_Type (U_Type) then\n          if Is_Access_Protected_Subprogram_Type (U_Type) then\n-            Lib_RE := RE_Put_Image_Access_Prot;\n+            Lib_RE := RE_Put_Image_Access_Prot_Subp;\n          elsif Is_Access_Subprogram_Type (U_Type) then\n             Lib_RE := RE_Put_Image_Access_Subp;\n          elsif P_Size = System_Address_Size then\n@@ -830,15 +830,10 @@ package body Exp_Put_Image is\n       --  types in the private part of a Remote_Types package.\n       --\n       --  Put_Image on tagged types triggers some bugs.\n-      --\n-      --  Put_Image doesn't work for access-to-protected types, because of\n-      --  confusion over their size. Disable for all access-to-subprogram\n-      --  types, just in case.\n \n       if Is_Remote_Types (Scope (Typ))\n         or else (Is_Tagged_Type (Typ) and then In_Predefined_Unit (Typ))\n         or else (Is_Tagged_Type (Typ) and then not Tagged_Put_Image_Enabled)\n-        or else Is_Access_Subprogram_Type (Typ)\n       then\n          return False;\n       end if;"}, {"sha": "1b214bf872287e5dd75380522733259467c69556", "filename": "gcc/ada/libgnat/s-putima.adb", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Flibgnat%2Fs-putima.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Flibgnat%2Fs-putima.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fs-putima.adb?ref=6a920eb51077cd465472eabb24a49b3e4ca30e93", "patch": "@@ -158,10 +158,12 @@ package body System.Put_Images is\n       Thin_Instance (S, X, \"access subprogram\");\n    end Put_Image_Access_Subp;\n \n-   procedure Put_Image_Access_Prot (S : in out Sink'Class; X : Thin_Pointer) is\n+   procedure Put_Image_Access_Prot_Subp\n+     (S : in out Sink'Class; X : Thin_Pointer)\n+   is\n    begin\n       Thin_Instance (S, X, \"access protected subprogram\");\n-   end Put_Image_Access_Prot;\n+   end Put_Image_Access_Prot_Subp;\n \n    procedure Put_Image_String (S : in out Sink'Class; X : String) is\n    begin"}, {"sha": "da6293004f1845a9af7fe2fc1e61aee62003ef00", "filename": "gcc/ada/libgnat/s-putima.ads", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Flibgnat%2Fs-putima.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Flibgnat%2Fs-putima.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fs-putima.ads?ref=6a920eb51077cd465472eabb24a49b3e4ca30e93", "patch": "@@ -72,7 +72,8 @@ package System.Put_Images is\n    procedure Put_Image_Access_Subp (S : in out Sink'Class; X : Thin_Pointer);\n    --  For access-to-subprogram types\n \n-   procedure Put_Image_Access_Prot (S : in out Sink'Class; X : Thin_Pointer);\n+   procedure Put_Image_Access_Prot_Subp\n+     (S : in out Sink'Class; X : Thin_Pointer);\n    --  For access-to-protected-subprogram types\n \n    procedure Put_Image_String (S : in out Sink'Class; X : String);"}, {"sha": "0200c1d0f51302bdf851072be7e3b131f2fcb243", "filename": "gcc/ada/rtsfind.ads", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Frtsfind.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a920eb51077cd465472eabb24a49b3e4ca30e93/gcc%2Fada%2Frtsfind.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frtsfind.ads?ref=6a920eb51077cd465472eabb24a49b3e4ca30e93", "patch": "@@ -1180,7 +1180,7 @@ package Rtsfind is\n      RE_Put_Image_Thin_Pointer,          -- System.Put_Images\n      RE_Put_Image_Fat_Pointer,           -- System.Put_Images\n      RE_Put_Image_Access_Subp,           -- System.Put_Images\n-     RE_Put_Image_Access_Prot,           -- System.Put_Images\n+     RE_Put_Image_Access_Prot_Subp,      -- System.Put_Images\n      RE_Put_Image_String,                -- System.Put_Images\n      RE_Put_Image_Wide_String,           -- System.Put_Images\n      RE_Put_Image_Wide_Wide_String,      -- System.Put_Images\n@@ -2583,7 +2583,7 @@ package Rtsfind is\n      RE_Put_Image_Thin_Pointer           => System_Put_Images,\n      RE_Put_Image_Fat_Pointer            => System_Put_Images,\n      RE_Put_Image_Access_Subp            => System_Put_Images,\n-     RE_Put_Image_Access_Prot            => System_Put_Images,\n+     RE_Put_Image_Access_Prot_Subp       => System_Put_Images,\n      RE_Put_Image_String                 => System_Put_Images,\n      RE_Put_Image_Wide_String            => System_Put_Images,\n      RE_Put_Image_Wide_Wide_String       => System_Put_Images,"}]}