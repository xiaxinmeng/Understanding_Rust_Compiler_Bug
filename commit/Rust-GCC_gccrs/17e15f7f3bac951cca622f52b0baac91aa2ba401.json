{"sha": "17e15f7f3bac951cca622f52b0baac91aa2ba401", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTdlMTVmN2YzYmFjOTUxY2NhNjIyZjUyYjBiYWFjOTFhYTJiYTQwMQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2003-12-02T18:30:42Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2003-12-02T18:30:42Z"}, "message": "locale_facets.tcc (time_get::do_get_year): Avoid using a basic_string and calling a full blown strtol (via __convert_to_v)...\n\n2003-12-02  Paolo Carlini  <pcarlini@suse.de>\n\n\t* include/bits/locale_facets.tcc (time_get::do_get_year):\n\tAvoid using a basic_string and calling a full blown strtol\n\t(via __convert_to_v) for simple 2 or 4 digits, base 10,\n\tpositive integers; simplify.\n\nFrom-SVN: r74193", "tree": {"sha": "768293df17c2e0932f06bd9ebdc0fff4176f88ec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/768293df17c2e0932f06bd9ebdc0fff4176f88ec"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/17e15f7f3bac951cca622f52b0baac91aa2ba401", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17e15f7f3bac951cca622f52b0baac91aa2ba401", "html_url": "https://github.com/Rust-GCC/gccrs/commit/17e15f7f3bac951cca622f52b0baac91aa2ba401", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17e15f7f3bac951cca622f52b0baac91aa2ba401/comments", "author": null, "committer": null, "parents": [{"sha": "0548bb4aba154c468f2ea6b498089891415bf526", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0548bb4aba154c468f2ea6b498089891415bf526", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0548bb4aba154c468f2ea6b498089891415bf526"}], "stats": {"total": 29, "additions": 16, "deletions": 13}, "files": [{"sha": "63eed9dbdaff30839af7fb56f187715cca0b25ec", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17e15f7f3bac951cca622f52b0baac91aa2ba401/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17e15f7f3bac951cca622f52b0baac91aa2ba401/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=17e15f7f3bac951cca622f52b0baac91aa2ba401", "patch": "@@ -1,3 +1,10 @@\n+2003-12-02  Paolo Carlini  <pcarlini@suse.de>\n+\n+\t* include/bits/locale_facets.tcc (time_get::do_get_year):\n+\tAvoid using a basic_string and calling a full blown strtol\n+\t(via __convert_to_v) for simple 2 or 4 digits, base 10,\n+\tpositive integers; simplify.\n+\n 2003-12-02  Paolo Carlini  <pcarlini@suse.de>\n \n \t* config/locale/gnu/monetary_members.cc"}, {"sha": "47696ac7c76d04eecf02c1a996823213bab5ba05", "filename": "libstdc++-v3/include/bits/locale_facets.tcc", "status": "modified", "additions": 9, "deletions": 13, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17e15f7f3bac951cca622f52b0baac91aa2ba401/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17e15f7f3bac951cca622f52b0baac91aa2ba401/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc?ref=17e15f7f3bac951cca622f52b0baac91aa2ba401", "patch": "@@ -1964,21 +1964,17 @@ namespace std\n       const ctype<_CharT>& __ctype = use_facet<ctype<_CharT> >(__loc); \n \n       size_t __i = 0;\n-      string __digits;\n-      for (; __i < 4 && __beg != __end\n-\t     && __ctype.is(ctype_base::digit, *__beg); ++__beg, ++__i)\n-\t__digits += __ctype.narrow(*__beg, 0);\n-      if (__i == 2 || __i == 4)\n+      int __value = 0;\n+      for (; __beg != __end && __i < 4; ++__beg, ++__i)\n \t{\n-\t  long __l;\n-\t  std::__convert_to_v(__digits.c_str(), __l, __err,\n-\t\t\t      _S_get_c_locale());\n-\t  if (!(__err & ios_base::failbit) && __l <= INT_MAX)\n-\t    {\n-\t      __l = __i == 2 ? __l : __l - 1900; \n-\t      __tm->tm_year = static_cast<int>(__l);\n-\t    }\n+\t  const char __c = __ctype.narrow(*__beg, '*');\n+\t  if (__c >= '0' && __c <= '9')\n+\t    __value = __value * 10 + (__c - '0');\n+\t  else\n+\t    break;\n \t}\n+      if (__i == 2 || __i == 4)\n+\t__tm->tm_year = __i == 2 ? __value : __value - 1900; \n       else\n \t__err |= ios_base::failbit;\n       if (__beg == __end)"}]}