{"sha": "f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjg1N2U5YTQ2ZWYzYmZiZjhlMWE0MmFlYzg2ZDcwMzNhZDM0M2Q4Nw==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2010-05-04T09:49:45Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2010-05-04T09:49:45Z"}, "message": "re PR c++/43953 (ICE: dependent_type_p, at cp/pt.c:17404)\n\nFix PR c++/43953\n\ngcc/cp/ChangeLog:\n\tPR c++/43953\n\t* pt.c (most_specialized_class): Pretend we are processing\n\ta template decl during the call to coerce_template_parms.\n\ngcc/testsuite/ChangeLog:\n\tPR c++/43953\n\t* g++.dg/other/crash-12.C: New test.\n\nFrom-SVN: r159019", "tree": {"sha": "172380cb649bc9cd1a9292ccd5322655d0bfeb35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/172380cb649bc9cd1a9292ccd5322655d0bfeb35"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/comments", "author": null, "committer": null, "parents": [{"sha": "9f1b98f0fafeb61e39ff5abc1d59f7765111db8e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f1b98f0fafeb61e39ff5abc1d59f7765111db8e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f1b98f0fafeb61e39ff5abc1d59f7765111db8e"}], "stats": {"total": 44, "additions": 41, "deletions": 3}, "files": [{"sha": "026abe8254dec6cbb80ee0054ef1f854bbf783ff", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "patch": "@@ -1,3 +1,9 @@\n+2010-05-03  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/43953\n+\t* pt.c (most_specialized_class): Pretend we are processing\n+\ta template decl during the call to coerce_template_parms.\n+\n 2010-05-03  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/42810"}, {"sha": "fbf9b905c0286c7af39c29d37aa3e1b33823511a", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "patch": "@@ -15941,12 +15941,13 @@ most_specialized_class (tree type, tree tmpl)\n       tree parms = TREE_VALUE (t);\n \n       partial_spec_args = CLASSTYPE_TI_ARGS (TREE_TYPE (t));\n+\n+      ++processing_template_decl;\n+\n       if (outer_args)\n \t{\n \t  int i;\n \n-\t  ++processing_template_decl;\n-\n \t  /* Discard the outer levels of args, and then substitute in the\n \t     template args from the enclosing class.  */\n \t  partial_spec_args = INNERMOST_TEMPLATE_ARGS (partial_spec_args);\n@@ -15963,7 +15964,6 @@ most_specialized_class (tree type, tree tmpl)\n \t    TREE_VEC_ELT (parms, i) =\n \t      tsubst (TREE_VEC_ELT (parms, i), outer_args, tf_none, NULL_TREE);\n \n-\t  --processing_template_decl;\n \t}\n \n       partial_spec_args =\n@@ -15974,6 +15974,8 @@ most_specialized_class (tree type, tree tmpl)\n \t\t\t\t /*require_all_args=*/true,\n \t\t\t\t /*use_default_args=*/true);\n \n+      --processing_template_decl;\n+\n       if (partial_spec_args == error_mark_node)\n \treturn error_mark_node;\n "}, {"sha": "4c7f13da78945c2d929ae6e84ab7c262e7991a69", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "patch": "@@ -1,3 +1,8 @@\n+2010-05-03  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/43953\n+\t* g++.dg/other/crash-12.C: New test.\n+\n 2010-05-03  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* g++.dg/cdce3.C: Add a space.  Updated."}, {"sha": "6612ff216ba7436edec9d5edd765e3e3cbdc5e84", "filename": "gcc/testsuite/g++.dg/other/crash-12.C", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcrash-12.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f857e9a46ef3bfbf8e1a42aec86d7033ad343d87/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcrash-12.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcrash-12.C?ref=f857e9a46ef3bfbf8e1a42aec86d7033ad343d87", "patch": "@@ -0,0 +1,25 @@\n+// Origin: PR c++/43953\n+\n+template<typename T,\n+         typename U,\n+\t typename T::type V> class bad;\n+\n+// partial specialization\n+// for T = U\n+template<typename T, typename T::type V>\n+class bad<T, T, V>\n+{\n+public:\n+  static void foo() {}\n+};\n+\n+struct dummy\n+{\n+  typedef int type;\n+};\n+\n+int main()\n+{\n+  bad<dummy, dummy, 0>::foo();\n+}\n+"}]}