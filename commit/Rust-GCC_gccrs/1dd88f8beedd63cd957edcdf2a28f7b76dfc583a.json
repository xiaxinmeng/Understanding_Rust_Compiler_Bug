{"sha": "1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWRkODhmOGJlZWRkNjNjZDk1N2VkY2RmMmEyOGY3Yjc2ZGZjNTgzYQ==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-06-09T15:58:24Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2018-06-09T15:58:24Z"}, "message": "re PR fortran/38351 (Poor error message for rank mismatch in operator args)\n\n2018-06-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n\tPR fortran/38351\n\t* resolve.c (resolve_operator): Provide better error message for\n\tderived type entity used in an binary intrinsic numeric operator.\n\n2018-06-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/38351\n\t* gfortran.dg/pr38351.f90: New test.\n\t* gfortran.dg/typebound_operator_4.f03: Adjust for new error message.\n\nFrom-SVN: r261363", "tree": {"sha": "ca0891c34fc2374a2efdbb7e31482d272bb071dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ca0891c34fc2374a2efdbb7e31482d272bb071dd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/comments", "author": null, "committer": null, "parents": [{"sha": "3cf89a7b992d483e80b3b5960f6f4012fae95045", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3cf89a7b992d483e80b3b5960f6f4012fae95045", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3cf89a7b992d483e80b3b5960f6f4012fae95045"}], "stats": {"total": 43, "additions": 41, "deletions": 2}, "files": [{"sha": "7bfeac1c8aa918a217383c4b1259d75afa220b33", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "patch": "@@ -1,3 +1,9 @@\n+2018-06-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n+ \n+\tPR fortran/38351\n+\t* resolve.c (resolve_operator): Provide better error message for\n+\tderived type entity used in an binary intrinsic numeric operator.\n+\n 2018-06-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/85138"}, {"sha": "b1d4e0327739aaa7d5443ab6e5f3f250d1146d02", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "patch": "@@ -3878,7 +3878,13 @@ resolve_operator (gfc_expr *e)\n \t  break;\n \t}\n \n-      sprintf (msg,\n+      if (op1->ts.type == BT_DERIVED || op2->ts.type == BT_DERIVED)\n+\tsprintf (msg,\n+\t       _(\"Unexpected derived-type entities in binary intrinsic \"\n+\t\t \"numeric operator %%<%s%%> at %%L\"),\n+\t       gfc_op2string (e->value.op.op));\n+      else\n+      \tsprintf (msg,\n \t       _(\"Operands of binary numeric operator %%<%s%%> at %%L are %s/%s\"),\n \t       gfc_op2string (e->value.op.op), gfc_typename (&op1->ts),\n \t       gfc_typename (&op2->ts));"}, {"sha": "41e24e762ed26eaccf2227ffaa02f8cc22573f82", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "patch": "@@ -1,3 +1,9 @@\n+2018-06-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/38351\n+\t* gfortran.dg/pr38351.f90: New test.\n+\t* gfortran.dg/typebound_operator_4.f03: Adjust for new error message.\n+\n 2018-06-09  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/85138"}, {"sha": "08e1724dc0a619ec1a6928177a1e1a3ef0eca23e", "filename": "gcc/testsuite/gfortran.dg/pr38351.f90", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr38351.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr38351.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr38351.f90?ref=1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "patch": "@@ -0,0 +1,21 @@\n+! { dg-do compile }\n+module m1\n+   type t1\n+      integer :: i\n+   end type t1\n+   interface operator(+)\n+      module procedure add\n+   end interface\n+   contains\n+      type(t1) function add(a,b)\n+         type(t1), intent(in) :: a,b\n+      end function\n+end module m1\n+\n+program foo\n+   use m1\n+   type(t1), dimension(2,2) :: a = t1(1), b = t1(2)\n+   type(t1) :: c=t1(1), d=t1(2)\n+   c = c + d\n+   a = a + b   ! { dg-error \"Unexpected derived-type entities\" }\n+end program foo"}, {"sha": "cd0e8f602ae3608e43b57b1f10606b96b849d617", "filename": "gcc/testsuite/gfortran.dg/typebound_operator_4.f03", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_4.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dd88f8beedd63cd957edcdf2a28f7b76dfc583a/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_4.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftypebound_operator_4.f03?ref=1dd88f8beedd63cd957edcdf2a28f7b76dfc583a", "patch": "@@ -84,6 +84,6 @@ PROGRAM main\n   TYPE(myint) :: x\n \n   x = 0 ! { dg-error \"Can't convert\" }\n-  x = x + 42 ! { dg-error \"Operands of\" }\n+  x = x + 42 ! { dg-error \"binary intrinsic numeric operator\" }\n   x = x .PLUS. 5 ! { dg-error \"Unknown operator\" }\n END PROGRAM main"}]}