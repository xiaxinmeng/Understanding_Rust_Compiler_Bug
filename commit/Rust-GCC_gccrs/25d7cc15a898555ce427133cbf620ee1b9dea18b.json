{"sha": "25d7cc15a898555ce427133cbf620ee1b9dea18b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjVkN2NjMTVhODk4NTU1Y2U0MjcxMzNjYmY2MjBlZTFiOWRlYTE4Yg==", "commit": {"author": {"name": "Sebastian Pop", "email": "sebastian.pop@amd.com", "date": "2009-08-12T14:27:33Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2009-08-12T14:27:33Z"}, "message": "Add PDR->nb_subscripts.\n\n2009-08-11  Sebastian Pop  <sebastian.pop@amd.com>\n\n\t* graphite-dependences.c (dependence_polyhedron_1): Replace\n\tpdr_nb_subscripts with PDR_NB_SUBSCRIPTS.\n\t(graphite_legal_transform_dr): Same.\n\t(graphite_carried_dependence_level_k): Same.\n\t* graphite-poly.c (new_poly_dr): Add a parameter nb_subscripts.\n\tInitialize PDR_NB_SUBSCRIPTS.\n\t(print_pdr_access_layout): Replace pdr_nb_subscripts with\n\tPDR_NB_SUBSCRIPTS.\n\t* graphite-poly.h (struct poly_dr): Add nb_subscripts field.\n\t(PDR_NB_SUBSCRIPTS): New.\n\t(pdr_nb_subscripts): Removed.\n\t(pdr_dim): Simplified.\n\t* graphite-sese-to-poly.c (build_poly_dr): Replace pdr_nb_subscripts\n\twith PDR_NB_SUBSCRIPTS.\n\nFrom-SVN: r150690", "tree": {"sha": "693f3fed676c9442115de315fe7587dec80d797e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/693f3fed676c9442115de315fe7587dec80d797e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/25d7cc15a898555ce427133cbf620ee1b9dea18b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25d7cc15a898555ce427133cbf620ee1b9dea18b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/25d7cc15a898555ce427133cbf620ee1b9dea18b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25d7cc15a898555ce427133cbf620ee1b9dea18b/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "66096911fd4c37da10f7ddf3388867acf29451ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66096911fd4c37da10f7ddf3388867acf29451ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66096911fd4c37da10f7ddf3388867acf29451ee"}], "stats": {"total": 92, "additions": 60, "deletions": 32}, "files": [{"sha": "dd74c022e691db7f33f9b96af91e76ce125e51db", "filename": "gcc/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=25d7cc15a898555ce427133cbf620ee1b9dea18b", "patch": "@@ -1,3 +1,20 @@\n+2009-08-12  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* graphite-dependences.c (dependence_polyhedron_1): Replace\n+\tpdr_nb_subscripts with PDR_NB_SUBSCRIPTS.\n+\t(graphite_legal_transform_dr): Same.\n+\t(graphite_carried_dependence_level_k): Same.\n+\t* graphite-poly.c (new_poly_dr): Add a parameter nb_subscripts.\n+\tInitialize PDR_NB_SUBSCRIPTS.\n+\t(print_pdr_access_layout): Replace pdr_nb_subscripts with\n+\tPDR_NB_SUBSCRIPTS.\n+\t* graphite-poly.h (struct poly_dr): Add nb_subscripts field.\n+\t(PDR_NB_SUBSCRIPTS): New.\n+\t(pdr_nb_subscripts): Removed.\n+\t(pdr_dim): Simplified.\n+\t* graphite-sese-to-poly.c (build_poly_dr): Replace pdr_nb_subscripts\n+\twith PDR_NB_SUBSCRIPTS.\n+\n 2009-08-12  Sebastian Pop  <sebastian.pop@amd.com>\n \n \t* graphite-interchange.c (compute_array_size): Remove use of"}, {"sha": "ceda6c42eeec02d5cba118fdec3f85a91de2a495", "filename": "gcc/ChangeLog.graphite", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2FChangeLog.graphite", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2FChangeLog.graphite", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog.graphite?ref=25d7cc15a898555ce427133cbf620ee1b9dea18b", "patch": "@@ -1,3 +1,20 @@\n+2009-08-11  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\t* graphite-dependences.c (dependence_polyhedron_1): Replace\n+\tpdr_nb_subscripts with PDR_NB_SUBSCRIPTS.\n+\t(graphite_legal_transform_dr): Same.\n+\t(graphite_carried_dependence_level_k): Same.\n+\t* graphite-poly.c (new_poly_dr): Add a parameter nb_subscripts.\n+\tInitialize PDR_NB_SUBSCRIPTS.\n+\t(print_pdr_access_layout): Replace pdr_nb_subscripts with\n+\tPDR_NB_SUBSCRIPTS.\n+\t* graphite-poly.h (struct poly_dr): Add nb_subscripts field.\n+\t(PDR_NB_SUBSCRIPTS): New.\n+\t(pdr_nb_subscripts): Removed.\n+\t(pdr_dim): Simplified.\n+\t* graphite-sese-to-poly.c (build_poly_dr): Replace pdr_nb_subscripts\n+\twith PDR_NB_SUBSCRIPTS.\n+\n 2009-08-11  Sebastian Pop  <sebastian.pop@amd.com>\n \n \t* graphite-interchange.c (compute_array_size): Remove use of"}, {"sha": "59e2a0d4da23b6c589357f642c4004e2716c87a6", "filename": "gcc/graphite-dependences.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-dependences.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-dependences.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-dependences.c?ref=25d7cc15a898555ce427133cbf620ee1b9dea18b", "patch": "@@ -380,7 +380,7 @@ dependence_polyhedron_1 (poly_bb_p pbb1, poly_bb_p pbb2,\n     pbb_nb_scattering_orig (pbb2) : pbb_nb_scattering_transform (pbb2);\n   graphite_dim_t ddim1 = pbb_dim_iter_domain (pbb1);\n   graphite_dim_t ddim2 = pbb_dim_iter_domain (pbb2);\n-  graphite_dim_t sdim1 = pdr_nb_subscripts (pdr1) + 1;\n+  graphite_dim_t sdim1 = PDR_NB_SUBSCRIPTS (pdr1) + 1;\n   graphite_dim_t gdim = scop_nb_params (scop);\n   graphite_dim_t dim1 = pdr_dim (pdr1);\n   graphite_dim_t dim2 = pdr_dim (pdr2);\n@@ -492,8 +492,8 @@ graphite_legal_transform_dr (poly_bb_p pbb1, poly_bb_p pbb2,\n   ppl_Polyhedron_t so2 = PBB_ORIGINAL_SCATTERING (pbb2);\n   ppl_Pointset_Powerset_C_Polyhedron_t po;\n \n-  graphite_dim_t sdim1 = pdr_nb_subscripts (pdr1) + 1;\n-  graphite_dim_t sdim2 = pdr_nb_subscripts (pdr2) + 1;\n+  graphite_dim_t sdim1 = PDR_NB_SUBSCRIPTS (pdr1) + 1;\n+  graphite_dim_t sdim2 = PDR_NB_SUBSCRIPTS (pdr2) + 1;\n \n   if (sdim1 != sdim2)\n     return true;\n@@ -661,8 +661,8 @@ graphite_carried_dependence_level_k (poly_dr_p pdr1, poly_dr_p pdr2,\n   ppl_Polyhedron_t so2 = PBB_TRANSFORMED_SCATTERING (pbb2);\n   ppl_Pointset_Powerset_C_Polyhedron_t po;\n   ppl_Pointset_Powerset_C_Polyhedron_t eqpp;\n-  graphite_dim_t sdim1 = pdr_nb_subscripts (pdr1) + 1;\n-  graphite_dim_t sdim2 = pdr_nb_subscripts (pdr2) + 1;\n+  graphite_dim_t sdim1 = PDR_NB_SUBSCRIPTS (pdr1) + 1;\n+  graphite_dim_t sdim2 = PDR_NB_SUBSCRIPTS (pdr2) + 1;\n   graphite_dim_t tdim1 = pbb_nb_scattering_transform (pbb1);\n   graphite_dim_t ddim1 = pbb_dim_iter_domain (pbb1);\n   ppl_dimension_type dim;"}, {"sha": "944c4bf2553a0229a097de853fcb100c715a43fd", "filename": "gcc/graphite-poly.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-poly.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-poly.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-poly.c?ref=25d7cc15a898555ce427133cbf620ee1b9dea18b", "patch": "@@ -263,20 +263,22 @@ apply_poly_transforms (scop_p scop)\n   return transform_done;\n }\n \n-/* Create a new polyhedral data reference and add it to PBB. It is defined by\n-   its ACCESSES, its TYPE*/\n+/* Create a new polyhedral data reference and add it to PBB.  It is\n+   defined by its ACCESSES, its TYPE, and the number of subscripts\n+   NB_SUBSCRIPTS.  */\n \n void\n new_poly_dr (poly_bb_p pbb,\n \t     ppl_Pointset_Powerset_C_Polyhedron_t accesses,\n-\t     enum POLY_DR_TYPE type, void *cdr)\n+\t     enum POLY_DR_TYPE type, void *cdr, int nb_subscripts)\n {\n   poly_dr_p pdr = XNEW (struct poly_dr);\n \n   PDR_PBB (pdr) = pbb;\n   PDR_ACCESSES (pdr) = accesses;\n   PDR_TYPE (pdr) = type;\n   PDR_CDR (pdr) = cdr;\n+  PDR_NB_SUBSCRIPTS (pdr) = nb_subscripts;\n   VEC_safe_push (poly_dr_p, heap, PBB_DRS (pbb), pdr);\n }\n \n@@ -348,7 +350,7 @@ print_pdr_access_layout (FILE *file, poly_dr_p pdr)\n \n   fprintf (file, \"  alias\");\n \n-  for (i = 0; i < pdr_nb_subscripts (pdr); i++)\n+  for (i = 0; i < PDR_NB_SUBSCRIPTS (pdr); i++)\n     fprintf (file, \"   sub%d\", (int) i);\n \n   fprintf (file, \"    cst\\n\");"}, {"sha": "4459315b8a2c18742317015cc6865075b1acfb47", "filename": "gcc/graphite-poly.h", "status": "modified", "additions": 13, "deletions": 22, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-poly.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-poly.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-poly.h?ref=25d7cc15a898555ce427133cbf620ee1b9dea18b", "patch": "@@ -92,12 +92,12 @@ struct poly_dr\n      |       p = A;\n      |       ... = p[?][?];\n      | \t   for j\n-     |       A[i][j+b] = m;\n+     |       A[i][j+k] = m;\n      |   }\n \n      The data access A[i][j+k] in alias set \"5\" is described like this:\n \n-     | i   j   k   a   s0  s1  1\n+     | i   j   k   a  s0  s1   1\n      | 0   0   0   1   0   0  -5     =  0\n      |-1   0   0   0   1   0   0     =  0\n      | 0  -1  -1   0   0   1   0     =  0\n@@ -110,13 +110,13 @@ struct poly_dr\n      polyhedron:\n \n \n-     | i   k   a   s0  1\n+     | i   k   a  s0   1\n      | 0   0   1   0  -5   =  0\n      | 0   0   0   1   0   >= 0\n \n      \"or\"\n \n-     | i   k   a   s0  1\n+     | i   k   a  s0   1\n      | 0   0   1   0  -7   =  0\n      | 0   0   0   1   0   >= 0\n \n@@ -128,31 +128,33 @@ struct poly_dr\n      | i   j   k   a   1\n      | 0   0   0  -1   15  = 0 */\n   ppl_Pointset_Powerset_C_Polyhedron_t accesses;\n+\n+  /* The number of subscripts.  */\n+  graphite_dim_t nb_subscripts; \n };\n \n #define PDR_CDR(PDR) (PDR->compiler_dr)\n #define PDR_PBB(PDR) (PDR->pbb)\n #define PDR_TYPE(PDR) (PDR->type)\n #define PDR_ACCESSES(PDR) (PDR->accesses)\n+#define PDR_NB_SUBSCRIPTS(PDR) (PDR->nb_subscripts)\n \n void new_poly_dr (poly_bb_p, ppl_Pointset_Powerset_C_Polyhedron_t,\n-\t\t  enum POLY_DR_TYPE, void *);\n+\t\t  enum POLY_DR_TYPE, void *, int);\n void free_poly_dr (poly_dr_p);\n void debug_pdr (poly_dr_p);\n void print_pdr (FILE *, poly_dr_p);\n static inline scop_p pdr_scop (poly_dr_p pdr);\n \n-/* The number of subscripts of the PDR.  */\n+/* The dimension of the PDR_ACCESSES polyhedron of PDR.  */\n \n-static inline graphite_dim_t\n-pdr_nb_subscripts (poly_dr_p pdr)\n+static inline ppl_dimension_type\n+pdr_dim (poly_dr_p pdr)\n {\n-  poly_bb_p pbb = PDR_PBB (pdr);\n   ppl_dimension_type dim;\n-\n   ppl_Pointset_Powerset_C_Polyhedron_space_dimension (PDR_ACCESSES (pdr),\n \t\t\t\t\t\t      &dim);\n-  return dim - pbb_dim_iter_domain (pbb) - pbb_nb_params (pbb) - 1;\n+  return dim;\n }\n \n /* The dimension of the iteration domain of the scop of PDR.  */\n@@ -171,17 +173,6 @@ pdr_nb_params (poly_dr_p pdr)\n   return scop_nb_params (pdr_scop (pdr));\n }\n \n-/* The dimension of the accesses polyhedron of PDR.  */\n-\n-static inline graphite_dim_t\n-pdr_dim (poly_dr_p pdr)\n-{\n-  graphite_dim_t alias_nb_dimensions = 1;\n-\n-  return pbb_dim_iter_domain (PDR_PBB (pdr)) + alias_nb_dimensions\n-    + pdr_nb_subscripts (pdr) + scop_nb_params (pdr_scop (pdr));\n-}\n-\n /* The dimension of the alias set in PDR.  */\n \n static inline ppl_dimension_type"}, {"sha": "f05a31d2e5d8cec91e64012d477bced8a7246adf", "filename": "gcc/graphite-sese-to-poly.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-sese-to-poly.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25d7cc15a898555ce427133cbf620ee1b9dea18b/gcc%2Fgraphite-sese-to-poly.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-sese-to-poly.c?ref=25d7cc15a898555ce427133cbf620ee1b9dea18b", "patch": "@@ -1723,7 +1723,8 @@ build_poly_dr (data_reference_p dr, poly_bb_p pbb)\n   ppl_new_Pointset_Powerset_C_Polyhedron_from_C_Polyhedron (&accesses_ps,\n \t\t\t\t\t\t\t    accesses);\n   ppl_delete_Polyhedron (accesses);\n-  new_poly_dr (pbb, accesses_ps, DR_IS_READ (dr) ? PDR_READ : PDR_WRITE, dr);\n+  new_poly_dr (pbb, accesses_ps, DR_IS_READ (dr) ? PDR_READ : PDR_WRITE, dr,\n+\t       DR_NUM_DIMENSIONS (dr));\n }\n \n /* Group each data reference in DRS with it's alias set num.  */"}]}