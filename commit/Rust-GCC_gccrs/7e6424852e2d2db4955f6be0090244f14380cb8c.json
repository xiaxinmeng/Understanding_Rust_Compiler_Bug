{"sha": "7e6424852e2d2db4955f6be0090244f14380cb8c", "node_id": "C_kwDOANBUbNoAKDdlNjQyNDg1MmUyZDJkYjQ5NTVmNmJlMDA5MDI0NGYxNDM4MGNiOGM", "commit": {"author": {"name": "Mark Wielaard", "email": "mark@klomp.org", "date": "2022-06-18T23:27:19Z"}, "committer": {"name": "Mark Wielaard", "email": "mark@klomp.org", "date": "2022-06-18T23:27:19Z"}, "message": "Actually set TYPE_PACKED for type_record\n\nWhen bootstrapping with --enable-checking=no you'll get:\n\ngcc/rust/backend/rust-compile-type.cc: In member function\n\u2018virtual void Rust::Compile::TyTyResolveCompile::visit(const Rust::TyTy::ADTType&)\u2019:\ngcc/tree.h:2312:59: error: statement has no effect [-Werror=unused-value]\n 2312 | #define TYPE_PACKED(NODE) (TYPE_CHECK (NODE)->base.u.bits.packed_flag)\n      |                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~\ngcc/rust/backend/rust-compile-type.cc:315:7:\n  note: in expansion of macro \u2018TYPE_PACKED\u2019\n  315 |       TYPE_PACKED (type_record);\n      |       ^~~~~~~~~~~\n\nWe need to actually set a value for the packed_flag.", "tree": {"sha": "b1974e6f010013a11e2bf77eb6b29dfbd748e51d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1974e6f010013a11e2bf77eb6b29dfbd748e51d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e6424852e2d2db4955f6be0090244f14380cb8c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e6424852e2d2db4955f6be0090244f14380cb8c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e6424852e2d2db4955f6be0090244f14380cb8c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e6424852e2d2db4955f6be0090244f14380cb8c/comments", "author": null, "committer": null, "parents": [{"sha": "c0f11672d760513256997f325da678016d13f677", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0f11672d760513256997f325da678016d13f677", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0f11672d760513256997f325da678016d13f677"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "eced909673e76b1ff4a048e7c0c26cb5bb364a45", "filename": "gcc/rust/backend/rust-compile-type.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e6424852e2d2db4955f6be0090244f14380cb8c/gcc%2Frust%2Fbackend%2Frust-compile-type.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e6424852e2d2db4955f6be0090244f14380cb8c/gcc%2Frust%2Fbackend%2Frust-compile-type.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fbackend%2Frust-compile-type.cc?ref=7e6424852e2d2db4955f6be0090244f14380cb8c", "patch": "@@ -312,7 +312,7 @@ TyTyResolveCompile::visit (const TyTy::ADTType &type)\n   TyTy::ADTType::ReprOptions repr = type.get_repr_options ();\n   if (repr.pack)\n     {\n-      TYPE_PACKED (type_record);\n+      TYPE_PACKED (type_record) = 1;\n       if (repr.pack > 1)\n \t{\n \t  SET_TYPE_ALIGN (type_record, repr.pack * 8);"}]}