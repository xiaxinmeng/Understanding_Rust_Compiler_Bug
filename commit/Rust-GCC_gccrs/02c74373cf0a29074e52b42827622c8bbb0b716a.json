{"sha": "02c74373cf0a29074e52b42827622c8bbb0b716a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDJjNzQzNzNjZjBhMjkwNzRlNTJiNDI4Mjc2MjJjOGJiYjBiNzE2YQ==", "commit": {"author": {"name": "Francois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2011-11-09T09:41:17Z"}, "committer": {"name": "Fran\u00e7ois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2011-11-09T09:41:17Z"}, "message": "re PR fortran/38718 (some simplifiers for elemental intrinsics missing; required for init expressions)\n\n\tPR fortran/38718\n\n\t* intrinsic.c (add_functions): Add gfc_simplify_dreal.\n\t* intrinsic.h (gfc_simplify_dreal): New proto.\n\t* simplify.c (gfc_simplify_dreal): New function.\n\n\t* gfortran.dg/initialization_29.f90: Expand test.\n\nFrom-SVN: r181198", "tree": {"sha": "b9ffe796c165296254c21775bc6f2300920b44ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b9ffe796c165296254c21775bc6f2300920b44ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/02c74373cf0a29074e52b42827622c8bbb0b716a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02c74373cf0a29074e52b42827622c8bbb0b716a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02c74373cf0a29074e52b42827622c8bbb0b716a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02c74373cf0a29074e52b42827622c8bbb0b716a/comments", "author": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c5bdb340d6458e3df097f58d611e75f999e07653", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5bdb340d6458e3df097f58d611e75f999e07653", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c5bdb340d6458e3df097f58d611e75f999e07653"}], "stats": {"total": 47, "additions": 45, "deletions": 2}, "files": [{"sha": "1fffbc609b6a30b5b470d760a4feac2c60f1be20", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=02c74373cf0a29074e52b42827622c8bbb0b716a", "patch": "@@ -1,3 +1,10 @@\n+2011-11-08  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n+\n+\tPR fortran/38718\n+\t* intrinsic.c (add_functions): Allow dreal simplification.\n+\t* intrinsic.h (gfc_simplify_dreal): New prototype.\n+\t* simplify.c (gfc_simplify_dreal): New function.\n+\n 2011-11-09  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/21881"}, {"sha": "38bcb273fdd146b31ab42ca9739fe98d47921c3e", "filename": "gcc/fortran/intrinsic.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2Fintrinsic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2Fintrinsic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fintrinsic.c?ref=02c74373cf0a29074e52b42827622c8bbb0b716a", "patch": "@@ -1557,8 +1557,8 @@ add_functions (void)\n \n   make_generic (\"dprod\", GFC_ISYM_DPROD, GFC_STD_F77);\n \n-  add_sym_1 (\"dreal\", GFC_ISYM_REAL, CLASS_ELEMENTAL, ACTUAL_NO, BT_REAL, dd, GFC_STD_GNU,\n-\t     NULL, NULL, NULL,\n+  add_sym_1 (\"dreal\", GFC_ISYM_REAL, CLASS_ELEMENTAL, ACTUAL_NO,\n+\t     BT_REAL, dd, GFC_STD_GNU, NULL, gfc_simplify_dreal, NULL,\n \t     a, BT_COMPLEX, dd, REQUIRED);\n \n   make_generic (\"dreal\", GFC_ISYM_REAL, GFC_STD_GNU);"}, {"sha": "bfc2455cfd2351b5b9d63813b00aac4bd6394d17", "filename": "gcc/fortran/intrinsic.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2Fintrinsic.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2Fintrinsic.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fintrinsic.h?ref=02c74373cf0a29074e52b42827622c8bbb0b716a", "patch": "@@ -262,6 +262,7 @@ gfc_expr *gfc_simplify_digits (gfc_expr *);\n gfc_expr *gfc_simplify_dim (gfc_expr *, gfc_expr *);\n gfc_expr *gfc_simplify_dprod (gfc_expr *, gfc_expr *);\n gfc_expr *gfc_simplify_dot_product (gfc_expr *, gfc_expr *);\n+gfc_expr *gfc_simplify_dreal (gfc_expr *);\n gfc_expr *gfc_simplify_dshiftl (gfc_expr *, gfc_expr *, gfc_expr *);\n gfc_expr *gfc_simplify_dshiftr (gfc_expr *, gfc_expr *, gfc_expr *);\n gfc_expr *gfc_simplify_epsilon (gfc_expr *);"}, {"sha": "443182613880ac7815cc662b7384d454efd76270", "filename": "gcc/fortran/simplify.c", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2Fsimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ffortran%2Fsimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsimplify.c?ref=02c74373cf0a29074e52b42827622c8bbb0b716a", "patch": "@@ -938,6 +938,21 @@ gfc_simplify_dint (gfc_expr *e)\n }\n \n \n+gfc_expr *\n+gfc_simplify_dreal (gfc_expr *e)\n+{\n+  gfc_expr *result = NULL;\n+\n+  if (e->expr_type != EXPR_CONSTANT)\n+    return NULL;\n+\n+  result = gfc_get_constant_expr (BT_REAL, e->ts.kind, &e->where);\n+  mpc_real (result->value.real, e->value.complex, GFC_RND_MODE);\n+\n+  return range_check (result, \"DREAL\");\n+}\n+\n+\n gfc_expr *\n gfc_simplify_anint (gfc_expr *e, gfc_expr *k)\n {"}, {"sha": "e6e9049cd97434e38abfb26a185fdbcce8e1b6a4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=02c74373cf0a29074e52b42827622c8bbb0b716a", "patch": "@@ -1,3 +1,8 @@\n+2011-11-09  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n+\n+\tPR fortran/38718\n+\t* gfortran.dg/initialization_29.f90: Expand test.\n+\n 2011-11-09  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/51027"}, {"sha": "e3f2992e75f0b6a384e1fdab4ea51c1b41147cf5", "filename": "gcc/testsuite/gfortran.dg/initialization_29.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_29.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02c74373cf0a29074e52b42827622c8bbb0b716a/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_29.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finitialization_29.f90?ref=02c74373cf0a29074e52b42827622c8bbb0b716a", "patch": "@@ -0,0 +1,15 @@\n+! { dg-do compile }\n+!\n+! PR fortran/38718\n+!\n+  implicit none\n+  real(kind=8), parameter :: r = kind(0) + 0.2\n+  complex(kind=8), parameter :: c = (r, -9.3)\n+  integer, parameter :: k = nint(dreal(c))\n+  integer, parameter :: l = nint(realpart(c))\n+  integer(kind=k) :: i\n+  integer(kind=l) :: j\n+  i = 42\n+  j = 42\n+  print *, k, i, j, r\n+  end"}]}