{"sha": "b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60", "node_id": "C_kwDOANBUbNoAKGI3Y2I2ZDY2YmQ1MmU4ODRmZjMzYzYxZTQ2YTllZTlmYWNjMmFjNjA", "commit": {"author": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2021-10-22T02:17:50Z"}, "committer": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2021-10-22T15:28:42Z"}, "message": "Add testcase for PR fortran/100906\n\n2021-10-21  Jos\u00e9 Rui Faustino de Sousa  <jrfsousa@gmail.com>\n\t    Sandra Loosemore  <sandra@codesourcery.com>\n\n\tgcc/testsuite/\n\n\tPR fortran/100906\n\t* gfortran.dg/PR100906.f90: New.\n\t* gfortran.dg/PR100906.c: New.", "tree": {"sha": "d55d71049fc85505c15e9e455f2ff4d30c41023b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d55d71049fc85505c15e9e455f2ff4d30c41023b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60/comments", "author": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c2a9a98a369528c8689ecb68db576f8e7dc2fa45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2a9a98a369528c8689ecb68db576f8e7dc2fa45", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2a9a98a369528c8689ecb68db576f8e7dc2fa45"}], "stats": {"total": 1868, "additions": 1868, "deletions": 0}, "files": [{"sha": "f71d567708444cd41f8dd5d5ad4614eace735d6d", "filename": "gcc/testsuite/gfortran.dg/PR100906.c", "status": "added", "additions": 169, "deletions": 0, "changes": 169, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60/gcc%2Ftestsuite%2Fgfortran.dg%2FPR100906.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60/gcc%2Ftestsuite%2Fgfortran.dg%2FPR100906.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2FPR100906.c?ref=b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60", "patch": "@@ -0,0 +1,169 @@\n+/* Test the fix for PR100906 */\n+\n+#include <assert.h>\n+#include <stdbool.h>\n+#include <stdint.h>\n+#include <stdio.h>\n+/* #include <uchar.h> */\n+\n+#include <ISO_Fortran_binding.h>\n+\n+#define _CFI_type_mask 0xFF\n+#define _CFI_type_kind_shift 8\n+\n+#define _CFI_decode_type(NAME) (signed char)((NAME) & CFI_type_mask)\n+#define _CFI_decode_kind(NAME) (signed char)(((NAME) >> CFI_type_kind_shift) & CFI_type_mask)\n+\n+#define _CFI_encode_type(TYPE, KIND) (int16_t)\\\n+((((KIND) & CFI_type_mask) << CFI_type_kind_shift)\\\n+ | ((TYPE) & CFI_type_mask))\n+\n+#define N 11\n+#define M 7\n+\n+typedef char c_char;\n+/* typedef char32_t c_ucs4_char; */\n+typedef uint32_t char32_t;\n+typedef uint32_t c_ucs4_char;\n+ \n+bool charcmp (char *, char, size_t);\n+\n+bool ucharcmp (char32_t *, char32_t, size_t);\n+\n+bool c_vrfy_c_char (const CFI_cdesc_t *restrict, const size_t);\n+\n+bool c_vrfy_c_ucs4_char (const CFI_cdesc_t *restrict, const size_t);\n+\n+bool c_vrfy_character (const CFI_cdesc_t *restrict, const size_t);\n+ \n+void check_tk (const CFI_cdesc_t*restrict, const CFI_type_t, const signed char, const size_t, const size_t);\n+\n+bool\n+charcmp (char *c, char v, size_t n)\n+{\n+  bool res = true;\n+  char b = (char)'A';\n+  size_t i;\n+\n+  for (i=0; ((i<n)&&(res)); i++, c++)\n+    res = (*c == (v+b));\n+  return res;\n+}\n+\n+bool\n+ucharcmp (char32_t *c, char32_t v, size_t n)\n+{\n+  bool res = true;\n+  char32_t b = (char32_t)0xFF01;\n+  size_t i;\n+\n+  for (i=0; ((i<n)&&(res)); i++, c++)\n+    res = (*c == (v+b));\n+  return res;\n+}\n+\n+bool\n+c_vrfy_c_char (const CFI_cdesc_t *restrict auxp, const size_t len)\n+{\n+  CFI_index_t i, lb, ub, ex;\n+  size_t sz;\n+  c_char *ip = NULL;\n+\n+  assert (auxp);\n+  assert (auxp->base_addr);\n+  assert (auxp->elem_len>0);\n+  lb = auxp->dim[0].lower_bound;\n+  ex = auxp->dim[0].extent;\n+  assert (ex==N);\n+  sz = (size_t)auxp->elem_len / sizeof (c_char);\n+  assert (sz==len);\n+  ub = ex + lb - 1;\n+  ip = (c_char*)auxp->base_addr;\n+  for (i=0; i<ex; i++, ip+=sz)\n+    if (!charcmp (ip, (c_char)(i), sz))\n+      return false;\n+  for (i=lb; i<ub+1; i++)\n+    {\n+      ip = (c_char*)CFI_address(auxp, &i);\n+      if (!charcmp (ip, (c_char)(i-lb), sz))\n+\treturn false;\n+    }\n+  return true;\n+}\n+\n+bool\n+c_vrfy_c_ucs4_char (const CFI_cdesc_t *restrict auxp, const size_t len)\n+{\n+  CFI_index_t i, lb, ub, ex;\n+  size_t sz;\n+  c_ucs4_char *ip = NULL;\n+\n+  assert (auxp);\n+  assert (auxp->base_addr);\n+  assert (auxp->elem_len>0);\n+  lb = auxp->dim[0].lower_bound;\n+  ex = auxp->dim[0].extent;\n+  assert (ex==N);\n+  sz = (size_t)auxp->elem_len / sizeof (c_ucs4_char);\n+  assert (sz==len);\n+  ub = ex + lb - 1;\n+  ip = (c_ucs4_char*)auxp->base_addr;\n+  for (i=0; i<ex; i++, ip+=sz)\n+    if (!ucharcmp (ip, (c_ucs4_char)(i), sz))\n+      return false;\n+  for (i=lb; i<ub+1; i++)\n+    {\n+      ip = (c_ucs4_char*)CFI_address(auxp, &i);\n+      if (!ucharcmp (ip, (c_ucs4_char)(i-lb), sz))\n+\treturn false;\n+    }\n+  return true;\n+}\n+\n+bool\n+c_vrfy_character (const CFI_cdesc_t *restrict auxp, const size_t len)\n+{\n+  signed char type, kind;\n+  \n+  assert (auxp);\n+  type = _CFI_decode_type(auxp->type);\n+  kind = _CFI_decode_kind(auxp->type);\n+  assert (type == CFI_type_Character);\n+  switch (kind)\n+    {\n+    case 1:\n+      return c_vrfy_c_char (auxp, len);\n+      break;\n+    case 4:\n+      return c_vrfy_c_ucs4_char (auxp, len);\n+      break;\n+    default:\n+      assert (false);\n+    }\n+  return true;\n+}\n+\n+void\n+check_tk (const CFI_cdesc_t *restrict auxp, const CFI_type_t type, const signed char kind, const size_t elem_len, const size_t nelem)\n+{\n+  signed char ityp, iknd;\n+\n+  assert (auxp);\n+  assert (auxp->elem_len==elem_len*nelem);\n+  assert (auxp->rank==1);\n+  assert (auxp->dim[0].sm>0);\n+  assert ((size_t)auxp->dim[0].sm==elem_len*nelem);\n+  /*  */\n+  assert (auxp->type==type);\n+  ityp = _CFI_decode_type(auxp->type);\n+  assert (ityp == CFI_type_Character);\n+  iknd = _CFI_decode_kind(auxp->type);\n+  assert (_CFI_decode_type(type)==ityp);\n+  assert (kind==iknd);\n+  assert (c_vrfy_character (auxp, nelem));\n+  return;\n+}\n+\n+// Local Variables:\n+// mode: C\n+// End:"}, {"sha": "f6cb3af6d8a6050d7a28264bbbfe09c4c67e421d", "filename": "gcc/testsuite/gfortran.dg/PR100906.f90", "status": "added", "additions": 1699, "deletions": 0, "changes": 1699, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60/gcc%2Ftestsuite%2Fgfortran.dg%2FPR100906.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60/gcc%2Ftestsuite%2Fgfortran.dg%2FPR100906.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2FPR100906.f90?ref=b7cb6d66bd52e884ff33c61e46a9ee9facc2ac60", "patch": "@@ -0,0 +1,1699 @@\n+! { dg-do run }\n+! { dg-additional-sources PR100906.c }\n+!\n+! Test the fix for PR100906\n+! \n+\n+module isof_m\n+\n+  use, intrinsic :: iso_c_binding, only: &\n+    c_signed_char, c_int16_t\n+  \n+  implicit none\n+\n+  private\n+  \n+  public ::             &\n+    CFI_type_character\n+\n+  public ::             &\n+    CFI_type_char,      &\n+    CFI_type_ucs4_char\n+ \n+  public ::      &\n+    check_tk_as, &\n+    check_tk_ar\n+  \n+  \n+  public ::          &\n+    cfi_encode_type\n+  \n+  integer, parameter :: CFI_type_t = c_int16_t\n+  \n+  integer(kind=c_int16_t), parameter :: CFI_type_mask = int(z\"FF\", kind=c_int16_t)\n+  integer(kind=c_int16_t), parameter :: CFI_type_kind_shift = 8_c_int16_t\n+\n+  ! Intrinsic types. Their kind number defines their storage size. */\n+  integer(kind=c_signed_char), parameter :: CFI_type_Character = 5\n+\n+  ! C-Fortran Interoperability types.\n+  integer(kind=cfi_type_t), parameter :: CFI_type_char      = &\n+    ior(int(CFI_type_Character, kind=c_int16_t), shiftl(1_c_int16_t, CFI_type_kind_shift))\n+  integer(kind=cfi_type_t), parameter :: CFI_type_ucs4_char = &\n+    ior(int(CFI_type_Character, kind=c_int16_t), shiftl(4_c_int16_t, CFI_type_kind_shift))\n+\n+  interface\n+    subroutine check_tk_as(a, t, k, e, n) &\n+      bind(c, name=\"check_tk\")\n+      use, intrinsic :: iso_c_binding, only: &\n+        c_int16_t, c_signed_char, c_size_t\n+      implicit none\n+      type(*),                       intent(in) :: a(:)\n+      integer(c_int16_t),     value, intent(in) :: t\n+      integer(c_signed_char), value, intent(in) :: k\n+      integer(c_size_t),      value, intent(in) :: e\n+      integer(c_size_t),      value, intent(in) :: n\n+    end subroutine check_tk_as\n+    subroutine check_tk_ar(a, t, k, e, n) &\n+      bind(c, name=\"check_tk\")\n+      use, intrinsic :: iso_c_binding, only: &\n+        c_int16_t, c_signed_char, c_size_t\n+      implicit none\n+      type(*),                       intent(in) :: a(..)\n+      integer(c_int16_t),     value, intent(in) :: t\n+      integer(c_signed_char), value, intent(in) :: k\n+      integer(c_size_t),      value, intent(in) :: e\n+      integer(c_size_t),      value, intent(in) :: n\n+    end subroutine check_tk_ar\n+  end interface\n+\n+contains\n+\n+  elemental function cfi_encode_type(type, kind) result(itype)\n+    integer(kind=c_signed_char), intent(in) :: type\n+    integer(kind=c_signed_char), intent(in) :: kind\n+\n+    integer(kind=c_int16_t) :: itype, ikind\n+\n+    itype = int(type, kind=c_int16_t)\n+    itype = iand(itype, CFI_type_mask)\n+    ikind = int(kind, kind=c_int16_t)\n+    ikind = iand(ikind, CFI_type_mask)\n+    ikind = shiftl(ikind, CFI_type_kind_shift)\n+    itype = ior(ikind, itype)\n+    return\n+  end function cfi_encode_type\n+  \n+end module isof_m\n+\n+module iso_check_m\n+\n+  use, intrinsic :: iso_c_binding, only: &\n+    c_signed_char, c_int16_t, c_size_t\n+\n+  use, intrinsic :: iso_c_binding, only: &\n+    c_char\n+\n+  use :: isof_m, only:  &\n+    CFI_type_character\n+\n+  use :: isof_m, only:  &\n+    CFI_type_char,      &\n+    CFI_type_ucs4_char\n+\n+  use :: isof_m, only: &\n+    check_tk_as,       &\n+    check_tk_ar\n+\n+  use :: isof_m, only: &\n+    cfi_encode_type\n+\n+  implicit none\n+\n+  private\n+\n+  public ::               &\n+    check_c_char_l1,      &\n+    check_c_char_lm,      &\n+    check_c_ucs4_char_l1, &\n+    check_c_ucs4_char_lm\n+  \n+  integer                           :: i\n+  integer(kind=c_size_t), parameter :: b = 8\n+  integer,                parameter :: n = 11\n+  integer,                parameter :: m = 7\n+  \n+  integer, parameter :: c_ucs4_char = 4\n+  \n+  character(kind=c_char, len=1), parameter :: ref_c_char_l1(*) = &\n+    [(achar(i+iachar(\"A\")-1, kind=c_char), i=1,n)]\n+  character(kind=c_char, len=m), parameter :: ref_c_char_lm(*) = &\n+    [(repeat(achar(i+iachar(\"A\")-1, kind=c_char), m), i=1,n)]\n+  character(kind=c_ucs4_char, len=1), parameter :: ref_c_ucs4_char_l1(*) = &\n+    [(achar(i+iachar(\"A\")-1, kind=c_ucs4_char), i=1,n)]\n+  character(kind=c_ucs4_char, len=m), parameter :: ref_c_ucs4_char_lm(*) = &\n+    [(repeat(achar(i+iachar(\"A\")-1, kind=c_ucs4_char), m), i=1,n)]\n+\n+contains\n+\n+  subroutine check_c_char_l1()\n+    character(kind=c_char, len=1), target :: a(n)\n+    !\n+    character(kind=c_char, len=:), pointer :: p(:)\n+    !\n+    a = ref_c_char_l1\n+    call f_check_c_char_c1_as(a)\n+    if(any(a/=ref_c_char_l1)) stop 1\n+    a = ref_c_char_l1\n+    call c_check_c_char_c1_as(a)\n+    if(any(a/=ref_c_char_l1)) stop 2\n+    a = ref_c_char_l1\n+    call f_check_c_char_c1_ar(a)\n+    if(any(a/=ref_c_char_l1)) stop 3\n+    a = ref_c_char_l1\n+    call c_check_c_char_c1_ar(a)\n+    if(any(a/=ref_c_char_l1)) stop 4\n+    a = ref_c_char_l1\n+    call f_check_c_char_a1_as(a)\n+    if(any(a/=ref_c_char_l1)) stop 5\n+    a = ref_c_char_l1\n+    call c_check_c_char_a1_as(a)\n+    if(any(a/=ref_c_char_l1)) stop 6\n+    a = ref_c_char_l1\n+    call f_check_c_char_a1_ar(a)\n+    if(any(a/=ref_c_char_l1)) stop 7\n+    a = ref_c_char_l1\n+    call c_check_c_char_a1_ar(a)\n+    if(any(a/=ref_c_char_l1)) stop 8\n+    a = ref_c_char_l1\n+    p => a  \n+    call f_check_c_char_d1_as(p)\n+    if(.not.associated(p)) stop 9\n+    if(.not.associated(p, a)) stop 10\n+    if(any(p/=ref_c_char_l1)) stop 11\n+    if(any(a/=ref_c_char_l1)) stop 12\n+    a = ref_c_char_l1\n+    p => a  \n+    call c_check_c_char_d1_as(p)\n+    if(.not.associated(p)) stop 13\n+    if(.not.associated(p, a)) stop 14\n+    if(any(p/=ref_c_char_l1)) stop 15\n+    if(any(a/=ref_c_char_l1)) stop 16\n+    a = ref_c_char_l1\n+    p => a  \n+    call f_check_c_char_d1_ar(p)\n+    if(.not.associated(p)) stop 17\n+    if(.not.associated(p, a)) stop 18\n+    if(any(p/=ref_c_char_l1)) stop 19\n+    if(any(a/=ref_c_char_l1)) stop 20\n+    a = ref_c_char_l1\n+    p => a  \n+    call c_check_c_char_d1_ar(p)\n+    if(.not.associated(p)) stop 21\n+    if(.not.associated(p, a)) stop 22\n+    if(any(p/=ref_c_char_l1)) stop 23\n+    if(any(a/=ref_c_char_l1)) stop 24\n+    return\n+  end subroutine check_c_char_l1\n+\n+  subroutine f_check_c_char_c1_as(a)\n+    character(kind=c_char, len=1), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 25\n+    if(k/=1_c_signed_char) stop 26\n+    if(n/=1) stop 27\n+    if(int(k, kind=c_size_t)/=e) stop 28\n+    if(t/=CFI_type_char) stop 29\n+    if(any(a/=ref_c_char_l1)) stop 30\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_l1)) stop 31\n+    return\n+  end subroutine f_check_c_char_c1_as\n+\n+  subroutine c_check_c_char_c1_as(a) bind(c)\n+    character(kind=c_char, len=1), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 32\n+    if(k/=1_c_signed_char) stop 33\n+    if(n/=1) stop 34\n+    if(int(k, kind=c_size_t)/=e) stop 35\n+    if(t/=CFI_type_char) stop 36\n+    if(any(a/=ref_c_char_l1)) stop 37\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_l1)) stop 38\n+    return\n+  end subroutine c_check_c_char_c1_as\n+\n+  subroutine f_check_c_char_c1_ar(a)\n+    character(kind=c_char, len=1), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 39\n+    if(k/=1_c_signed_char) stop 40\n+    if(n/=1) stop 41\n+    if(int(k, kind=c_size_t)/=e) stop 42\n+    if(t/=CFI_type_char) stop 43\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 44\n+    rank default\n+      stop 45\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 46\n+    rank default\n+      stop 47\n+    end select\n+    return\n+  end subroutine f_check_c_char_c1_ar\n+\n+  subroutine c_check_c_char_c1_ar(a) bind(c)\n+    character(kind=c_char, len=1), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 48\n+    if(k/=1_c_signed_char) stop 49\n+    if(n/=1) stop 50\n+    if(int(k, kind=c_size_t)/=e) stop 51\n+    if(t/=CFI_type_char) stop 52\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 53\n+    rank default\n+      stop 54\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 55\n+    rank default\n+      stop 56\n+    end select\n+    return\n+  end subroutine c_check_c_char_c1_ar\n+\n+  subroutine f_check_c_char_a1_as(a)\n+    character(kind=c_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 57\n+    if(k/=1_c_signed_char) stop 58\n+    if(n/=1) stop 59\n+    if(int(k, kind=c_size_t)/=e) stop 60\n+    if(t/=CFI_type_char) stop 61\n+    if(any(a/=ref_c_char_l1)) stop 62\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_l1)) stop 63\n+    return\n+  end subroutine f_check_c_char_a1_as\n+\n+  subroutine c_check_c_char_a1_as(a) bind(c)\n+    character(kind=c_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 64\n+    if(k/=1_c_signed_char) stop 65\n+    if(n/=1) stop 66\n+    if(int(k, kind=c_size_t)/=e) stop 67\n+    if(t/=CFI_type_char) stop 68\n+    if(any(a/=ref_c_char_l1)) stop 69\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_l1)) stop 70\n+    return\n+  end subroutine c_check_c_char_a1_as\n+\n+  subroutine f_check_c_char_a1_ar(a)\n+    character(kind=c_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 71\n+    if(k/=1_c_signed_char) stop 72\n+    if(n/=1) stop 73\n+    if(int(k, kind=c_size_t)/=e) stop 74\n+    if(t/=CFI_type_char) stop 75\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 76\n+    rank default\n+      stop 77\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 78\n+    rank default\n+      stop 79\n+    end select\n+    return\n+  end subroutine f_check_c_char_a1_ar\n+\n+  subroutine c_check_c_char_a1_ar(a) bind(c)\n+    character(kind=c_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 80\n+    if(k/=1_c_signed_char) stop 81\n+    if(n/=1) stop 82\n+    if(int(k, kind=c_size_t)/=e) stop 83\n+    if(t/=CFI_type_char) stop 84\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 85\n+    rank default\n+      stop 86\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 87\n+    rank default\n+      stop 88\n+    end select\n+    return\n+  end subroutine c_check_c_char_a1_ar\n+\n+  subroutine f_check_c_char_d1_as(a)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 89\n+    if(k/=1_c_signed_char) stop 90\n+    if(n/=1) stop 91\n+    if(int(k, kind=c_size_t)/=e) stop 92\n+    if(t/=CFI_type_char) stop 93\n+    if(any(a/=ref_c_char_l1)) stop 94\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_l1)) stop 95\n+    return\n+  end subroutine f_check_c_char_d1_as\n+\n+  subroutine c_check_c_char_d1_as(a) bind(c)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 96\n+    if(k/=1_c_signed_char) stop 97\n+    if(n/=1) stop 98\n+    if(int(k, kind=c_size_t)/=e) stop 99\n+    if(t/=CFI_type_char) stop 100\n+    if(any(a/=ref_c_char_l1)) stop 101\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_l1)) stop 102\n+    return\n+  end subroutine c_check_c_char_d1_as\n+\n+  subroutine f_check_c_char_d1_ar(a)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 103\n+    if(k/=1_c_signed_char) stop 104\n+    if(n/=1) stop 105\n+    if(int(k, kind=c_size_t)/=e) stop 106\n+    if(t/=CFI_type_char) stop 107\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 108\n+    rank default\n+      stop 109\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 110\n+    rank default\n+      stop 111\n+    end select\n+    return\n+  end subroutine f_check_c_char_d1_ar\n+\n+  subroutine c_check_c_char_d1_ar(a) bind(c)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 112\n+    if(k/=1_c_signed_char) stop 113\n+    if(n/=1) stop 114\n+    if(int(k, kind=c_size_t)/=e) stop 115\n+    if(t/=CFI_type_char) stop 116\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 117\n+    rank default\n+      stop 118\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_l1)) stop 119\n+    rank default\n+      stop 120\n+    end select\n+    return\n+  end subroutine c_check_c_char_d1_ar\n+\n+  subroutine check_c_char_lm()\n+    character(kind=c_char, len=m), target :: a(n)\n+    !\n+    character(kind=c_char, len=:), pointer :: p(:)\n+    !\n+    a = ref_c_char_lm\n+    call f_check_c_char_cm_as(a)\n+    if(any(a/=ref_c_char_lm)) stop 121\n+    a = ref_c_char_lm\n+    call c_check_c_char_cm_as(a)\n+    if(any(a/=ref_c_char_lm)) stop 122\n+    a = ref_c_char_lm\n+    call f_check_c_char_cm_ar(a)\n+    if(any(a/=ref_c_char_lm)) stop 123\n+    a = ref_c_char_lm\n+    call c_check_c_char_cm_ar(a)\n+    if(any(a/=ref_c_char_lm)) stop 124\n+    a = ref_c_char_lm\n+    call f_check_c_char_am_as(a)\n+    if(any(a/=ref_c_char_lm)) stop 125\n+    a = ref_c_char_lm\n+    call c_check_c_char_am_as(a)\n+    if(any(a/=ref_c_char_lm)) stop 126\n+    a = ref_c_char_lm\n+    call f_check_c_char_am_ar(a)\n+    if(any(a/=ref_c_char_lm)) stop 127\n+    a = ref_c_char_lm\n+    call c_check_c_char_am_ar(a)\n+    if(any(a/=ref_c_char_lm)) stop 128\n+    a = ref_c_char_lm\n+    p => a  \n+    call f_check_c_char_dm_as(p)\n+    if(.not.associated(p)) stop 129\n+    if(.not.associated(p, a)) stop 130\n+    if(any(p/=ref_c_char_lm)) stop 131\n+    if(any(a/=ref_c_char_lm)) stop 132\n+    a = ref_c_char_lm\n+    p => a  \n+    call c_check_c_char_dm_as(p)\n+    if(.not.associated(p)) stop 133\n+    if(.not.associated(p, a)) stop 134\n+    if(any(p/=ref_c_char_lm)) stop 135\n+    if(any(a/=ref_c_char_lm)) stop 136\n+    a = ref_c_char_lm\n+    p => a  \n+    call f_check_c_char_dm_ar(p)\n+    if(.not.associated(p)) stop 137\n+    if(.not.associated(p, a)) stop 138\n+    if(any(p/=ref_c_char_lm)) stop 139\n+    if(any(a/=ref_c_char_lm)) stop 140\n+    a = ref_c_char_lm\n+    p => a  \n+    call c_check_c_char_dm_ar(p)\n+    if(.not.associated(p)) stop 141\n+    if(.not.associated(p, a)) stop 142\n+    if(any(p/=ref_c_char_lm)) stop 143\n+    if(any(a/=ref_c_char_lm)) stop 144\n+    return\n+  end subroutine check_c_char_lm\n+\n+  subroutine f_check_c_char_cm_as(a)\n+    character(kind=c_char, len=m), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 145\n+    if(k/=1_c_signed_char) stop 146\n+    if(n/=m) stop 147\n+    if(int(k, kind=c_size_t)/=e) stop 148\n+    if(t/=CFI_type_char) stop 149\n+    if(any(a/=ref_c_char_lm)) stop 150\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_lm)) stop 151\n+    return\n+  end subroutine f_check_c_char_cm_as\n+\n+  subroutine c_check_c_char_cm_as(a) bind(c)\n+    character(kind=c_char, len=m), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 152\n+    if(k/=1_c_signed_char) stop 153\n+    if(n/=m) stop 154\n+    if(int(k, kind=c_size_t)/=e) stop 155\n+    if(t/=CFI_type_char) stop 156\n+    if(any(a/=ref_c_char_lm)) stop 157\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_lm)) stop 158\n+    return\n+  end subroutine c_check_c_char_cm_as\n+\n+  subroutine f_check_c_char_cm_ar(a)\n+    character(kind=c_char, len=m), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 159\n+    if(k/=1_c_signed_char) stop 160\n+    if(n/=m) stop 161\n+    if(int(k, kind=c_size_t)/=e) stop 162\n+    if(t/=CFI_type_char) stop 163\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 164\n+    rank default\n+      stop 165\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 166\n+    rank default\n+      stop 167\n+    end select\n+    return\n+  end subroutine f_check_c_char_cm_ar\n+\n+  subroutine c_check_c_char_cm_ar(a) bind(c)\n+    character(kind=c_char, len=m), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 168\n+    if(k/=1_c_signed_char) stop 169\n+    if(n/=m) stop 170\n+    if(int(k, kind=c_size_t)/=e) stop 171\n+    if(t/=CFI_type_char) stop 172\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 173\n+    rank default\n+      stop 174\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 175\n+    rank default\n+      stop 176\n+    end select\n+    return\n+  end subroutine c_check_c_char_cm_ar\n+\n+  subroutine f_check_c_char_am_as(a)\n+    character(kind=c_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 177\n+    if(k/=1_c_signed_char) stop 178\n+    if(n/=m) stop 179\n+    if(int(k, kind=c_size_t)/=e) stop 180\n+    if(t/=CFI_type_char) stop 181\n+    if(any(a/=ref_c_char_lm)) stop 182\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_lm)) stop 183\n+    return\n+  end subroutine f_check_c_char_am_as\n+\n+  subroutine c_check_c_char_am_as(a) bind(c)\n+    character(kind=c_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 184\n+    if(k/=1_c_signed_char) stop 185\n+    if(n/=m) stop 186\n+    if(int(k, kind=c_size_t)/=e) stop 187\n+    if(t/=CFI_type_char) stop 188\n+    if(any(a/=ref_c_char_lm)) stop 189\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_lm)) stop 190\n+    return\n+  end subroutine c_check_c_char_am_as\n+\n+  subroutine f_check_c_char_am_ar(a)\n+    character(kind=c_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 191\n+    if(k/=1_c_signed_char) stop 192\n+    if(n/=m) stop 193\n+    if(int(k, kind=c_size_t)/=e) stop 194\n+    if(t/=CFI_type_char) stop 195\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 196\n+    rank default\n+      stop 197\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 198\n+    rank default\n+      stop 199\n+    end select\n+    return\n+  end subroutine f_check_c_char_am_ar\n+\n+  subroutine c_check_c_char_am_ar(a) bind(c)\n+    character(kind=c_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 200\n+    if(k/=1_c_signed_char) stop 201\n+    if(n/=m) stop 202\n+    if(int(k, kind=c_size_t)/=e) stop 203\n+    if(t/=CFI_type_char) stop 204\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 205\n+    rank default\n+      stop 206\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 207\n+    rank default\n+      stop 208\n+    end select\n+    return\n+  end subroutine c_check_c_char_am_ar\n+\n+  subroutine f_check_c_char_dm_as(a)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 209\n+    if(k/=1_c_signed_char) stop 210\n+    if(n/=m) stop 211\n+    if(int(k, kind=c_size_t)/=e) stop 212\n+    if(t/=CFI_type_char) stop 213\n+    if(any(a/=ref_c_char_lm)) stop 214\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_lm)) stop 215\n+    return\n+  end subroutine f_check_c_char_dm_as\n+\n+  subroutine c_check_c_char_dm_as(a) bind(c)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 216\n+    if(k/=1_c_signed_char) stop 217\n+    if(n/=m) stop 218\n+    if(int(k, kind=c_size_t)/=e) stop 219\n+    if(t/=CFI_type_char) stop 220\n+    if(any(a/=ref_c_char_lm)) stop 221\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_char_lm)) stop 222\n+    return\n+  end subroutine c_check_c_char_dm_as\n+\n+  subroutine f_check_c_char_dm_ar(a)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 223\n+    if(k/=1_c_signed_char) stop 224\n+    if(n/=m) stop 225\n+    if(int(k, kind=c_size_t)/=e) stop 226\n+    if(t/=CFI_type_char) stop 227\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 228\n+    rank default\n+      stop 229\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 230\n+    rank default\n+      stop 231\n+    end select\n+    return\n+  end subroutine f_check_c_char_dm_ar\n+\n+  subroutine c_check_c_char_dm_ar(a) bind(c)\n+    character(kind=c_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 232\n+    if(k/=1_c_signed_char) stop 233\n+    if(n/=m) stop 234\n+    if(int(k, kind=c_size_t)/=e) stop 235\n+    if(t/=CFI_type_char) stop 236\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 237\n+    rank default\n+      stop 238\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_char_lm)) stop 239\n+    rank default\n+      stop 240\n+    end select\n+    return\n+  end subroutine c_check_c_char_dm_ar\n+\n+  subroutine check_c_ucs4_char_l1()\n+    character(kind=c_ucs4_char, len=1), target :: a(n)\n+    !\n+    character(kind=c_ucs4_char, len=:), pointer :: p(:)\n+    !\n+    a = ref_c_ucs4_char_l1\n+    call f_check_c_ucs4_char_c1_as(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 241\n+    a = ref_c_ucs4_char_l1\n+    call c_check_c_ucs4_char_c1_as(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 242\n+    a = ref_c_ucs4_char_l1\n+    call f_check_c_ucs4_char_c1_ar(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 243\n+    a = ref_c_ucs4_char_l1\n+    call c_check_c_ucs4_char_c1_ar(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 244\n+    a = ref_c_ucs4_char_l1\n+    call f_check_c_ucs4_char_a1_as(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 245\n+    a = ref_c_ucs4_char_l1\n+    call c_check_c_ucs4_char_a1_as(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 246\n+    a = ref_c_ucs4_char_l1\n+    call f_check_c_ucs4_char_a1_ar(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 247\n+    a = ref_c_ucs4_char_l1\n+    call c_check_c_ucs4_char_a1_ar(a)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 248\n+    a = ref_c_ucs4_char_l1\n+    p => a  \n+    call f_check_c_ucs4_char_d1_as(p)\n+    if(.not.associated(p)) stop 249\n+    if(.not.associated(p, a)) stop 250\n+    if(any(p/=ref_c_ucs4_char_l1)) stop 251\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 252\n+    a = ref_c_ucs4_char_l1\n+    p => a  \n+    call c_check_c_ucs4_char_d1_as(p)\n+    if(.not.associated(p)) stop 253\n+    if(.not.associated(p, a)) stop 254\n+    if(any(p/=ref_c_ucs4_char_l1)) stop 255\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 256\n+    a = ref_c_ucs4_char_l1\n+    p => a  \n+    call f_check_c_ucs4_char_d1_ar(p)\n+    if(.not.associated(p)) stop 257\n+    if(.not.associated(p, a)) stop 258\n+    if(any(p/=ref_c_ucs4_char_l1)) stop 259\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 260\n+    a = ref_c_ucs4_char_l1\n+    p => a  \n+    call c_check_c_ucs4_char_d1_ar(p)\n+    if(.not.associated(p)) stop 261\n+    if(.not.associated(p, a)) stop 262\n+    if(any(p/=ref_c_ucs4_char_l1)) stop 263\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 264\n+    return\n+  end subroutine check_c_ucs4_char_l1\n+\n+  subroutine f_check_c_ucs4_char_c1_as(a)\n+    character(kind=c_ucs4_char, len=1), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 265\n+    if(k/=4_c_signed_char) stop 266\n+    if(n/=1) stop 267\n+    if(int(k, kind=c_size_t)/=e) stop 268\n+    if(t/=CFI_type_ucs4_char) stop 269\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 270\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 271\n+    return\n+  end subroutine f_check_c_ucs4_char_c1_as\n+\n+  subroutine c_check_c_ucs4_char_c1_as(a) bind(c)\n+    character(kind=c_ucs4_char, len=1), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 272\n+    if(k/=4_c_signed_char) stop 273\n+    if(n/=1) stop 274\n+    if(int(k, kind=c_size_t)/=e) stop 275\n+    if(t/=CFI_type_ucs4_char) stop 276\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 277\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 278\n+    return\n+  end subroutine c_check_c_ucs4_char_c1_as\n+\n+  subroutine f_check_c_ucs4_char_c1_ar(a)\n+    character(kind=c_ucs4_char, len=1), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 279\n+    if(k/=4_c_signed_char) stop 280\n+    if(n/=1) stop 281\n+    if(int(k, kind=c_size_t)/=e) stop 282\n+    if(t/=CFI_type_ucs4_char) stop 283\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 284\n+    rank default\n+      stop 285\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 286\n+    rank default\n+      stop 287\n+    end select\n+    return\n+  end subroutine f_check_c_ucs4_char_c1_ar\n+\n+  subroutine c_check_c_ucs4_char_c1_ar(a) bind(c)\n+    character(kind=c_ucs4_char, len=1), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 288\n+    if(k/=4_c_signed_char) stop 289\n+    if(n/=1) stop 290\n+    if(int(k, kind=c_size_t)/=e) stop 291\n+    if(t/=CFI_type_ucs4_char) stop 292\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 293\n+    rank default\n+      stop 294\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 295\n+    rank default\n+      stop 296\n+    end select\n+    return\n+  end subroutine c_check_c_ucs4_char_c1_ar\n+\n+  subroutine f_check_c_ucs4_char_a1_as(a)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 297\n+    if(k/=4_c_signed_char) stop 298\n+    if(n/=1) stop 299\n+    if(int(k, kind=c_size_t)/=e) stop 300\n+    if(t/=CFI_type_ucs4_char) stop 301\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 302\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 303\n+    return\n+  end subroutine f_check_c_ucs4_char_a1_as\n+\n+  subroutine c_check_c_ucs4_char_a1_as(a) bind(c)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 304\n+    if(k/=4_c_signed_char) stop 305\n+    if(n/=1) stop 306\n+    if(int(k, kind=c_size_t)/=e) stop 307\n+    if(t/=CFI_type_ucs4_char) stop 308\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 309\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 310\n+    return\n+  end subroutine c_check_c_ucs4_char_a1_as\n+\n+  subroutine f_check_c_ucs4_char_a1_ar(a)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 311\n+    if(k/=4_c_signed_char) stop 312\n+    if(n/=1) stop 313\n+    if(int(k, kind=c_size_t)/=e) stop 314\n+    if(t/=CFI_type_ucs4_char) stop 315\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 316\n+    rank default\n+      stop 317\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 318\n+    rank default\n+      stop 319\n+    end select\n+    return\n+  end subroutine f_check_c_ucs4_char_a1_ar\n+\n+  subroutine c_check_c_ucs4_char_a1_ar(a) bind(c)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 320\n+    if(k/=4_c_signed_char) stop 321\n+    if(n/=1) stop 322\n+    if(int(k, kind=c_size_t)/=e) stop 323\n+    if(t/=CFI_type_ucs4_char) stop 324\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 325\n+    rank default\n+      stop 326\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 327\n+    rank default\n+      stop 328\n+    end select\n+    return\n+  end subroutine c_check_c_ucs4_char_a1_ar\n+\n+  subroutine f_check_c_ucs4_char_d1_as(a)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 329\n+    if(k/=4_c_signed_char) stop 330\n+    if(n/=1) stop 331\n+    if(int(k, kind=c_size_t)/=e) stop 332\n+    if(t/=CFI_type_ucs4_char) stop 333\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 334\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 335\n+    return\n+  end subroutine f_check_c_ucs4_char_d1_as\n+\n+  subroutine c_check_c_ucs4_char_d1_as(a) bind(c)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 336\n+    if(k/=4_c_signed_char) stop 337\n+    if(n/=1) stop 338\n+    if(int(k, kind=c_size_t)/=e) stop 339\n+    if(t/=CFI_type_ucs4_char) stop 340\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 341\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_l1)) stop 342\n+    return\n+  end subroutine c_check_c_ucs4_char_d1_as\n+\n+  subroutine f_check_c_ucs4_char_d1_ar(a)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 343\n+    if(k/=4_c_signed_char) stop 344\n+    if(n/=1) stop 345\n+    if(int(k, kind=c_size_t)/=e) stop 346\n+    if(t/=CFI_type_ucs4_char) stop 347\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 348\n+    rank default\n+      stop 349\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 350\n+    rank default\n+      stop 351\n+    end select\n+    return\n+  end subroutine f_check_c_ucs4_char_d1_ar\n+\n+  subroutine c_check_c_ucs4_char_d1_ar(a) bind(c)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*1)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 352\n+    if(k/=4_c_signed_char) stop 353\n+    if(n/=1) stop 354\n+    if(int(k, kind=c_size_t)/=e) stop 355\n+    if(t/=CFI_type_ucs4_char) stop 356\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 357\n+    rank default\n+      stop 358\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_l1)) stop 359\n+    rank default\n+      stop 360\n+    end select\n+    return\n+  end subroutine c_check_c_ucs4_char_d1_ar\n+\n+  subroutine check_c_ucs4_char_lm()\n+    character(kind=c_ucs4_char, len=m), target :: a(n)\n+    !\n+    character(kind=c_ucs4_char, len=:), pointer :: p(:)\n+    !\n+    a = ref_c_ucs4_char_lm\n+    call f_check_c_ucs4_char_cm_as(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 361\n+    a = ref_c_ucs4_char_lm\n+    call c_check_c_ucs4_char_cm_as(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 362\n+    a = ref_c_ucs4_char_lm\n+    call f_check_c_ucs4_char_cm_ar(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 363\n+    a = ref_c_ucs4_char_lm\n+    call c_check_c_ucs4_char_cm_ar(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 364\n+    a = ref_c_ucs4_char_lm\n+    call f_check_c_ucs4_char_am_as(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 365\n+    a = ref_c_ucs4_char_lm\n+    call c_check_c_ucs4_char_am_as(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 366\n+    a = ref_c_ucs4_char_lm\n+    call f_check_c_ucs4_char_am_ar(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 367\n+    a = ref_c_ucs4_char_lm\n+    call c_check_c_ucs4_char_am_ar(a)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 368\n+    a = ref_c_ucs4_char_lm\n+    p => a  \n+    call f_check_c_ucs4_char_dm_as(p)\n+    if(.not.associated(p)) stop 369\n+    if(.not.associated(p, a)) stop 370\n+    if(any(p/=ref_c_ucs4_char_lm)) stop 371\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 372\n+    a = ref_c_ucs4_char_lm\n+    p => a  \n+    call c_check_c_ucs4_char_dm_as(p)\n+    if(.not.associated(p)) stop 373\n+    if(.not.associated(p, a)) stop 374\n+    if(any(p/=ref_c_ucs4_char_lm)) stop 375\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 376\n+    a = ref_c_ucs4_char_lm\n+    p => a  \n+    call f_check_c_ucs4_char_dm_ar(p)\n+    if(.not.associated(p)) stop 377\n+    if(.not.associated(p, a)) stop 378\n+    if(any(p/=ref_c_ucs4_char_lm)) stop 379\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 380\n+    a = ref_c_ucs4_char_lm\n+    p => a  \n+    call c_check_c_ucs4_char_dm_ar(p)\n+    if(.not.associated(p)) stop 381\n+    if(.not.associated(p, a)) stop 382\n+    if(any(p/=ref_c_ucs4_char_lm)) stop 383\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 384\n+    return\n+  end subroutine check_c_ucs4_char_lm\n+\n+  subroutine f_check_c_ucs4_char_cm_as(a)\n+    character(kind=c_ucs4_char, len=m), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 385\n+    if(k/=4_c_signed_char) stop 386\n+    if(n/=m) stop 387\n+    if(int(k, kind=c_size_t)/=e) stop 388\n+    if(t/=CFI_type_ucs4_char) stop 389\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 390\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 391\n+    return\n+  end subroutine f_check_c_ucs4_char_cm_as\n+\n+  subroutine c_check_c_ucs4_char_cm_as(a) bind(c)\n+    character(kind=c_ucs4_char, len=m), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 392\n+    if(k/=4_c_signed_char) stop 393\n+    if(n/=m) stop 394\n+    if(int(k, kind=c_size_t)/=e) stop 395\n+    if(t/=CFI_type_ucs4_char) stop 396\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 397\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 398\n+    return\n+  end subroutine c_check_c_ucs4_char_cm_as\n+\n+  subroutine f_check_c_ucs4_char_cm_ar(a)\n+    character(kind=c_ucs4_char, len=m), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 399\n+    if(k/=4_c_signed_char) stop 400\n+    if(n/=m) stop 401\n+    if(int(k, kind=c_size_t)/=e) stop 402\n+    if(t/=CFI_type_ucs4_char) stop 403\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 404\n+    rank default\n+      stop 405\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 406\n+    rank default\n+      stop 407\n+    end select\n+    return\n+  end subroutine f_check_c_ucs4_char_cm_ar\n+\n+  subroutine c_check_c_ucs4_char_cm_ar(a) bind(c)\n+    character(kind=c_ucs4_char, len=m), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 408\n+    if(k/=4_c_signed_char) stop 409\n+    if(n/=m) stop 410\n+    if(int(k, kind=c_size_t)/=e) stop 411\n+    if(t/=CFI_type_ucs4_char) stop 412\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 413\n+    rank default\n+      stop 414\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 415\n+    rank default\n+      stop 416\n+    end select\n+    return\n+  end subroutine c_check_c_ucs4_char_cm_ar\n+\n+  subroutine f_check_c_ucs4_char_am_as(a)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 417\n+    if(k/=4_c_signed_char) stop 418\n+    if(n/=m) stop 419\n+    if(int(k, kind=c_size_t)/=e) stop 420\n+    if(t/=CFI_type_ucs4_char) stop 421\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 422\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 423\n+    return\n+  end subroutine f_check_c_ucs4_char_am_as\n+\n+  subroutine c_check_c_ucs4_char_am_as(a) bind(c)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 424\n+    if(k/=4_c_signed_char) stop 425\n+    if(n/=m) stop 426\n+    if(int(k, kind=c_size_t)/=e) stop 427\n+    if(t/=CFI_type_ucs4_char) stop 428\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 429\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 430\n+    return\n+  end subroutine c_check_c_ucs4_char_am_as\n+\n+  subroutine f_check_c_ucs4_char_am_ar(a)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 431\n+    if(k/=4_c_signed_char) stop 432\n+    if(n/=m) stop 433\n+    if(int(k, kind=c_size_t)/=e) stop 434\n+    if(t/=CFI_type_ucs4_char) stop 435\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 436\n+    rank default\n+      stop 437\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 438\n+    rank default\n+      stop 439\n+    end select\n+    return\n+  end subroutine f_check_c_ucs4_char_am_ar\n+\n+  subroutine c_check_c_ucs4_char_am_ar(a) bind(c)\n+    character(kind=c_ucs4_char, len=*), intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 440\n+    if(k/=4_c_signed_char) stop 441\n+    if(n/=m) stop 442\n+    if(int(k, kind=c_size_t)/=e) stop 443\n+    if(t/=CFI_type_ucs4_char) stop 444\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 445\n+    rank default\n+      stop 446\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 447\n+    rank default\n+      stop 448\n+    end select\n+    return\n+  end subroutine c_check_c_ucs4_char_am_ar\n+\n+  subroutine f_check_c_ucs4_char_dm_as(a)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 449\n+    if(k/=4_c_signed_char) stop 450\n+    if(n/=m) stop 451\n+    if(int(k, kind=c_size_t)/=e) stop 452\n+    if(t/=CFI_type_ucs4_char) stop 453\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 454\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 455\n+    return\n+  end subroutine f_check_c_ucs4_char_dm_as\n+\n+  subroutine c_check_c_ucs4_char_dm_as(a) bind(c)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(:)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 456\n+    if(k/=4_c_signed_char) stop 457\n+    if(n/=m) stop 458\n+    if(int(k, kind=c_size_t)/=e) stop 459\n+    if(t/=CFI_type_ucs4_char) stop 460\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 461\n+    call check_tk_as(a, t, k, e, n)\n+    if(any(a/=ref_c_ucs4_char_lm)) stop 462\n+    return\n+  end subroutine c_check_c_ucs4_char_dm_as\n+\n+  subroutine f_check_c_ucs4_char_dm_ar(a)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 463\n+    if(k/=4_c_signed_char) stop 464\n+    if(n/=m) stop 465\n+    if(int(k, kind=c_size_t)/=e) stop 466\n+    if(t/=CFI_type_ucs4_char) stop 467\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 468\n+    rank default\n+      stop 469\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 470\n+    rank default\n+      stop 471\n+    end select\n+    return\n+  end subroutine f_check_c_ucs4_char_dm_ar\n+\n+  subroutine c_check_c_ucs4_char_dm_ar(a) bind(c)\n+    character(kind=c_ucs4_char, len=:), pointer, intent(in) :: a(..)\n+    !\n+    integer(kind=c_int16_t)     :: t\n+    integer(kind=c_signed_char) :: k\n+    integer(kind=c_size_t)      :: e, n\n+    !\n+    k = kind(a)\n+    n = len(a, kind=kind(e))\n+    e = storage_size(a, kind=kind(e))/(b*m)\n+    t = cfi_encode_type(CFI_type_Character, k)\n+    if(k<=0_c_signed_char) stop 472\n+    if(k/=4_c_signed_char) stop 473\n+    if(n/=m) stop 474\n+    if(int(k, kind=c_size_t)/=e) stop 475\n+    if(t/=CFI_type_ucs4_char) stop 476\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 477\n+    rank default\n+      stop 478\n+    end select\n+    call check_tk_ar(a, t, k, e, n)\n+    select rank(a)\n+    rank(1)\n+      if(any(a/=ref_c_ucs4_char_lm)) stop 479\n+    rank default\n+      stop 480\n+    end select\n+    return\n+  end subroutine c_check_c_ucs4_char_dm_ar\n+  \n+end module iso_check_m\n+\n+program main_p\n+  \n+  use :: iso_check_m, only: &\n+    check_c_char_l1,        &\n+    check_c_char_lm,        &\n+    check_c_ucs4_char_l1,   &\n+    check_c_ucs4_char_lm\n+\n+  implicit none\n+\n+  call check_c_char_l1()\n+  call check_c_char_lm()\n+  ! See PR100907\n+  !call check_c_ucs4_char_l1()\n+  !call check_c_ucs4_char_lm()\n+  stop\n+\n+end program main_p\n+\n+!! Local Variables:\n+!! mode: f90\n+!! End:\n+"}]}