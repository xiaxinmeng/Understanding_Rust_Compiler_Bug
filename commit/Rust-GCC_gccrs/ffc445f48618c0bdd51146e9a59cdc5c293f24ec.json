{"sha": "ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmZjNDQ1ZjQ4NjE4YzBiZGQ1MTE0NmU5YTU5Y2RjNWMyOTNmMjRlYw==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2016-01-26T17:29:02Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2016-01-26T17:29:02Z"}, "message": "re PR middle-end/60908 (compiler bug related to trans-mem.c)\n\nPR middle-end/60908\n\n  * trans-mem.c (tm_region_init): Mark entry block as visited.\ntestsuite/\n  * gcc.dg/tm/pr60908.c: New test.\n\nFrom-SVN: r232839", "tree": {"sha": "e6bd983d58381ccf42b88e0d9a4c3958c5abece9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e6bd983d58381ccf42b88e0d9a4c3958c5abece9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/comments", "author": null, "committer": null, "parents": [{"sha": "dcbc08799695068b5beee1e5b89daacac23cfc0d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dcbc08799695068b5beee1e5b89daacac23cfc0d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dcbc08799695068b5beee1e5b89daacac23cfc0d"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "fef8cfe7f99d9cecc6c6f5ee063daa0489b5b201", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "patch": "@@ -1,3 +1,8 @@\n+2016-01-26  Richard Henderson  <rth@redhat.com>\n+\n+\tPR middle-end/60908\n+\t* trans-mem.c (tm_region_init): Mark entry block as visited.\n+\n 2016-01-26  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR other/69006"}, {"sha": "3e40014eeb0b4f4c3b457a8a7a7c04fc77d31501", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "patch": "@@ -1,3 +1,7 @@\n+2016-01-26  Richard Henderson  <rth@redhat.com>\n+\n+\t* gcc.dg/tm/pr60908.c: New test.\n+\n 2016-01-26  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR other/69006"}, {"sha": "773438ddbe6f8dddf25a2baf666dd1d0bd7ca92d", "filename": "gcc/testsuite/gcc.dg/tm/pr60908.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2Ftestsuite%2Fgcc.dg%2Ftm%2Fpr60908.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2Ftestsuite%2Fgcc.dg%2Ftm%2Fpr60908.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftm%2Fpr60908.c?ref=ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fgnu-tm\" } */\n+\n+int t, v;\n+\n+int\n+foo (void)\n+{\n+  while (1)\n+    {\n+      __transaction_atomic { v++; }\n+      if (t)\n+        return 0;\n+    }\n+}"}, {"sha": "500071f94f1407c5f9a67d150355589931e096df", "filename": "gcc/trans-mem.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2Ftrans-mem.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ffc445f48618c0bdd51146e9a59cdc5c293f24ec/gcc%2Ftrans-mem.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftrans-mem.c?ref=ffc445f48618c0bdd51146e9a59cdc5c293f24ec", "patch": "@@ -2039,16 +2039,17 @@ tm_region_init (struct tm_region *region)\n   struct tm_region *old_region;\n   auto_vec<tm_region *> bb_regions;\n \n-  all_tm_regions = region;\n-  bb = single_succ (ENTRY_BLOCK_PTR_FOR_FN (cfun));\n-\n   /* We could store this information in bb->aux, but we may get called\n      through get_all_tm_blocks() from another pass that may be already\n      using bb->aux.  */\n   bb_regions.safe_grow_cleared (last_basic_block_for_fn (cfun));\n \n+  all_tm_regions = region;\n+  bb = single_succ (ENTRY_BLOCK_PTR_FOR_FN (cfun));\n   queue.safe_push (bb);\n+  bitmap_set_bit (visited_blocks, bb->index);\n   bb_regions[bb->index] = region;\n+\n   do\n     {\n       bb = queue.pop ();"}]}