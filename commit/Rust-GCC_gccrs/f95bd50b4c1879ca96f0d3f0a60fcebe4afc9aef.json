{"sha": "f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjk1YmQ1MGI0YzE4NzljYTk2ZjBkM2YwYTYwZmNlYmU0YWZjOWFlZg==", "commit": {"author": {"name": "Yeting Kuo", "email": "fakepaper56@gmail.com", "date": "2020-09-17T21:29:27Z"}, "committer": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2020-09-17T21:29:57Z"}, "message": "RISC-V: fix a typo in riscv.h\n\ngcc/ChangeLog:\n\t* config/riscv/riscv.h (CSW_MAX_OFFSET): Fix typo.\n\ngcc/testsuite/ChangeLog:\n\t* gcc.target/riscv/shorten-memrefs-8.c: New test.", "tree": {"sha": "1de42ddb47a1e3ed187bc4819bf0105360aa2a6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1de42ddb47a1e3ed187bc4819bf0105360aa2a6a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef/comments", "author": null, "committer": null, "parents": [{"sha": "172178c0c35e1dabb778c80c26dc872136c45cf5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/172178c0c35e1dabb778c80c26dc872136c45cf5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/172178c0c35e1dabb778c80c26dc872136c45cf5"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "b7b4a1c88a522ad19cff176a2d087c2dc0180f63", "filename": "gcc/config/riscv/riscv.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef/gcc%2Fconfig%2Friscv%2Friscv.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef/gcc%2Fconfig%2Friscv%2Friscv.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.h?ref=f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef", "patch": "@@ -941,7 +941,7 @@ extern unsigned riscv_stack_boundary;\n \n /* This is the maximum value that can be represented in a compressed load/store\n    offset (an unsigned 5-bit value scaled by 4).  */\n-#define CSW_MAX_OFFSET ((4LL << C_S_BITS) - 1) & ~3\n+#define CSW_MAX_OFFSET (((4LL << C_S_BITS) - 1) & ~3)\n \n /* Called from RISCV_REORG, this is defined in riscv-sr.c.  */\n "}, {"sha": "a9128caeea9d94f8939f3d1b1744b6fb8b3c3bd3", "filename": "gcc/testsuite/gcc.target/riscv/shorten-memrefs-8.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef/gcc%2Ftestsuite%2Fgcc.target%2Friscv%2Fshorten-memrefs-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef/gcc%2Ftestsuite%2Fgcc.target%2Friscv%2Fshorten-memrefs-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Friscv%2Fshorten-memrefs-8.c?ref=f95bd50b4c1879ca96f0d3f0a60fcebe4afc9aef", "patch": "@@ -0,0 +1,27 @@\n+/* { dg-options \"-Os -march=rv32imc -mabi=ilp32\" } */\n+\n+/* shorten_memrefs should use a correct base address*/\n+\n+void\n+store (char *p, int k)\n+{\n+  *(int *)(p + 17) = k;\n+  *(int *)(p + 21) = k;\n+  *(int *)(p + 25) = k;\n+  *(int *)(p + 29) = k;\n+}\n+\n+int\n+load (char *p)\n+{\n+  int a = 0;\n+  a += *(int *)(p + 17);\n+  a += *(int *)(p + 21);\n+  a += *(int *)(p + 25);\n+  a += *(int *)(p + 29);\n+  return a;\n+}\n+\n+/* { dg-final { scan-assembler \"store:\\n\\taddi\\ta\\[0-7\\],a\\[0-7\\],1\" } } */\n+/* { dg-final { scan-assembler \"load:\\n\\taddi\\ta\\[0-7\\],a\\[0-7\\],1\" } } */\n+"}]}