{"sha": "384dedaf65db115e9795438d787bc8bd84bb6777", "node_id": "C_kwDOANBUbNoAKDM4NGRlZGFmNjVkYjExNWU5Nzk1NDM4ZDc4N2JjOGJkODRiYjY3Nzc", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2023-02-14T17:29:50Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@bitrange.com", "date": "2023-02-16T00:26:45Z"}, "message": "objs-gcc.sh: Only bootstrap if source-directory contains gcc\n\nI use objs-gcc.sh as a preparatory step before calling\nbtest-gcc.sh in my scripts, for example my cris-elf\nautotester.  I thought, why not use it for native builds\ntoo.  Except that use, with binutils release-style tarballs\nand a x86_64-pc-linux-gnu host, was broken.  Now that I look\nat it, the script seems to have aged poorly...  Still,\nthere's a need for such a script to install stuff needed for\nbtest-gcc.sh (and to fix up stuff if needed), and this can\nstill be that script.  So, I prefer to fix show-stoppers for\ncommon uses, while taking care to retain compatibility for\nuse that could possibly still work, with current sources.\n\nA long time ago (before 2011, but after this script was\ncreated in 2002, and used for a few years), the binutils\n(and gdb and gcc) toplevel Makefile may have had a bootstrap\ntarget that worked with binutils but didn't require gcc\nsources to be present.  Now, you'll get an error (see\nconfigure.ac line 1366 and on).  Let's just build the\ndefault make-target when \"bootstrap\" is known to fail.\nAn alternative would be to fold this native\nnon-i686-pc-linux-gnu clause into the native\ni686-pc-linux-gnu clause, as that seems to have been\noriginally intended as *the* single native clause, but\nthat'd require further edits (e.g. to remove install-dejagnu\nand make gdb build conditional on gdb sources presence, to\nwork with binutils tarballs, and I'd also then prefer to\nbuild not just ld, but also gas and binutils).\n\nAs it's a minimal obvious change required for current native\nuse with release-tarballs and git-checkout use(*), I'm\ninstalling this as obvious.\n\n*) Native i686-pc-linux-gnu remains broken for other use\nthan specially constructed combined trees where dejagnu is\nincluded at the toplevel (i.e. historic Cygnus devo-type).\n\ncontrib/regression:\n\t* objs-gcc.sh: Only bootstrap if source-directory contains gcc.", "tree": {"sha": "1bf334dfe0f924518b26003cb18a89b97a1cff15", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1bf334dfe0f924518b26003cb18a89b97a1cff15"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/384dedaf65db115e9795438d787bc8bd84bb6777", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/384dedaf65db115e9795438d787bc8bd84bb6777", "html_url": "https://github.com/Rust-GCC/gccrs/commit/384dedaf65db115e9795438d787bc8bd84bb6777", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/384dedaf65db115e9795438d787bc8bd84bb6777/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "88e02a1de7b4702c032f5a16ffd360c61a4439aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88e02a1de7b4702c032f5a16ffd360c61a4439aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88e02a1de7b4702c032f5a16ffd360c61a4439aa"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "d205bab1736857799f31f49d48e26c8e86a1c14d", "filename": "contrib/regression/objs-gcc.sh", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/384dedaf65db115e9795438d787bc8bd84bb6777/contrib%2Fregression%2Fobjs-gcc.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/384dedaf65db115e9795438d787bc8bd84bb6777/contrib%2Fregression%2Fobjs-gcc.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fregression%2Fobjs-gcc.sh?ref=384dedaf65db115e9795438d787bc8bd84bb6777", "patch": "@@ -106,7 +106,9 @@ if [ $H_REAL_TARGET = $H_REAL_HOST -a $H_REAL_TARGET = i686-pc-linux-gnu ]\n   make all-gdb all-dejagnu all-ld || exit 1\n   make install-gdb install-dejagnu install-ld || exit 1\n elif [ $H_REAL_TARGET = $H_REAL_HOST ] ; then\n-  make bootstrap || exit 1\n+  H_MAKE_TARGET=\n+  test -f $SOURCE/gcc/configure && H_MAKE_TARGET=bootstrap\n+  make $H_MAKE_TARGET || exit 1\n   make install || exit 1\n else\n   make || exit 1"}]}