{"sha": "33fe78517fb405739fdd5ae4491aa93dd3656bd3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzNmZTc4NTE3ZmI0MDU3MzlmZGQ1YWU0NDkxYWE5M2RkMzY1NmJkMw==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-09-16T06:05:28Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1993-09-16T06:05:28Z"}, "message": "(mark_set_resources): For CALL_INSN...\n\n(mark_set_resources): For CALL_INSN, if followed by a\nNOTE_INSN_SETJMP note, then assume that all registers are clobbered.\nHandle case where CALL_INSN is in a sequence.\n\nFrom-SVN: r5334", "tree": {"sha": "ff607d934212591193db48f5185f961cc2e91fe8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ff607d934212591193db48f5185f961cc2e91fe8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/33fe78517fb405739fdd5ae4491aa93dd3656bd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33fe78517fb405739fdd5ae4491aa93dd3656bd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33fe78517fb405739fdd5ae4491aa93dd3656bd3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33fe78517fb405739fdd5ae4491aa93dd3656bd3/comments", "author": null, "committer": null, "parents": [{"sha": "cc3cdac3bbb122bd647b0d9521a9b8b93218fc21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc3cdac3bbb122bd647b0d9521a9b8b93218fc21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc3cdac3bbb122bd647b0d9521a9b8b93218fc21"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "ba3ef381e5066de348ddb0e04a76ea0450f3724d", "filename": "gcc/reorg.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33fe78517fb405739fdd5ae4491aa93dd3656bd3/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33fe78517fb405739fdd5ae4491aa93dd3656bd3/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=33fe78517fb405739fdd5ae4491aa93dd3656bd3", "patch": "@@ -506,12 +506,18 @@ mark_set_resources (x, res, in_dest, include_delayed_effects)\n       if (include_delayed_effects)\n \t{\n \t  rtx next = NEXT_INSN (x);\n+\t  rtx prev = PREV_INSN (x);\n \n \t  res->cc = res->memory = 1;\n \t  for (i = 0; i < FIRST_PSEUDO_REGISTER; i++)\n \t    if (call_used_regs[i] || global_regs[i])\n \t      SET_HARD_REG_BIT (res->regs, i);\n \n+\t  /* If X is part of a delay slot sequence, then NEXT should be\n+\t     the first insn after the sequence.  */\n+\t  if (NEXT_INSN (prev) != x)\n+\t    next = NEXT_INSN (NEXT_INSN (prev));\n+\n \t  /* Skip any possible labels between the CALL_INSN and CLOBBERs.  */\n \t  while (GET_CODE (next) == CODE_LABEL)\n \t    next = NEXT_INSN (next);\n@@ -520,6 +526,12 @@ mark_set_resources (x, res, in_dest, include_delayed_effects)\n \t\t  && GET_CODE (PATTERN (next)) == CLOBBER);\n \t       next = NEXT_INSN (next))\n \t    mark_set_resources (XEXP (PATTERN (next), 0), res, 1, 0);\n+\n+\t  /* Check for a NOTE_INSN_SETJMP.  If it exists, then we must\n+\t     assume that this call can clobber any register.  */\n+\t  if (next && GET_CODE (next) == NOTE\n+\t      && NOTE_LINE_NUMBER (next) == NOTE_INSN_SETJMP)\n+\t    SET_HARD_REG_SET (res->regs);\n \t}\n \n       /* ... and also what it's RTL says it modifies, if anything.  */"}]}