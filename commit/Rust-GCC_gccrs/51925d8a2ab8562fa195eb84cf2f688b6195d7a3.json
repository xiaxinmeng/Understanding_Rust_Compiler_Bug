{"sha": "51925d8a2ab8562fa195eb84cf2f688b6195d7a3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTE5MjVkOGEyYWI4NTYyZmExOTVlYjg0Y2YyZjY4OGI2MTk1ZDdhMw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1999-09-17T01:44:05Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1999-09-17T01:44:05Z"}, "message": "decl.c (saved_scope_p): New fn.\n\n\t* decl.c (saved_scope_p): New fn.\n\t* class.c (pushclass): Don't clear class_cache_obstack if we have\n\tsaved scopes.\n\nFrom-SVN: r29468", "tree": {"sha": "a1e7c52670b5af2ae61e71a4e6c4d8bc59675ebe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a1e7c52670b5af2ae61e71a4e6c4d8bc59675ebe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/51925d8a2ab8562fa195eb84cf2f688b6195d7a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51925d8a2ab8562fa195eb84cf2f688b6195d7a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51925d8a2ab8562fa195eb84cf2f688b6195d7a3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51925d8a2ab8562fa195eb84cf2f688b6195d7a3/comments", "author": null, "committer": null, "parents": [{"sha": "0868989e574e03570ce6388a9b2e00fdbb63b0ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0868989e574e03570ce6388a9b2e00fdbb63b0ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0868989e574e03570ce6388a9b2e00fdbb63b0ee"}], "stats": {"total": 27, "additions": 22, "deletions": 5}, "files": [{"sha": "3f7d508db23096c836915599e627f7c4077555ea", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51925d8a2ab8562fa195eb84cf2f688b6195d7a3/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51925d8a2ab8562fa195eb84cf2f688b6195d7a3/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=51925d8a2ab8562fa195eb84cf2f688b6195d7a3", "patch": "@@ -1,3 +1,9 @@\n+1999-09-16  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* decl.c (saved_scope_p): New fn.\n+\t* class.c (pushclass): Don't clear class_cache_obstack if we have\n+\tsaved scopes.\n+\n 1999-09-16  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* lex.c (init_cpp_parse): Call xcalloc, not malloc/bzero."}, {"sha": "3b63503c5c0757929edbad0ba1cdef1e5b0c8a2d", "filename": "gcc/cp/class.c", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51925d8a2ab8562fa195eb84cf2f688b6195d7a3/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51925d8a2ab8562fa195eb84cf2f688b6195d7a3/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=51925d8a2ab8562fa195eb84cf2f688b6195d7a3", "patch": "@@ -4499,11 +4499,16 @@ pushclass (type, modify)\n       /* Forcibly remove any old class remnants.  */\n       invalidate_class_lookup_cache ();\n \n-      /* Now, free the obstack on which we cached all the values.  */\n-      if (class_cache_firstobj)\n-\tobstack_free (&class_cache_obstack, class_cache_firstobj);\n-      class_cache_firstobj \n-\t= (char*) obstack_finish (&class_cache_obstack);\n+      /* Now, free the obstack on which we cached all the values.\n+         We can't do this if we have saved scopes sitting around, since\n+\t they may have saved previous_class_values.  */\n+      if (! saved_scope_p ())\n+\t{\n+\t  if (class_cache_firstobj)\n+\t    obstack_free (&class_cache_obstack, class_cache_firstobj);\n+\t  class_cache_firstobj \n+\t    = (char*) obstack_finish (&class_cache_obstack);\n+\t}\n     }\n \n   /* If we're about to enter a nested class, clear"}, {"sha": "d8ad184cc2ff001395b0f28888a825b77ba673f5", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51925d8a2ab8562fa195eb84cf2f688b6195d7a3/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51925d8a2ab8562fa195eb84cf2f688b6195d7a3/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=51925d8a2ab8562fa195eb84cf2f688b6195d7a3", "patch": "@@ -2481,6 +2481,12 @@ pop_from_top_level ()\n \n   free (s);\n }\n+\n+int\n+saved_scope_p ()\n+{\n+  return current_saved_scope != NULL;\n+}\n \f\n /* Push a definition of struct, union or enum tag \"name\".\n    into binding_level \"b\".   \"type\" should be the type node, "}]}