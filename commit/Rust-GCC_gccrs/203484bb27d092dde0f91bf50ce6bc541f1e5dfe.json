{"sha": "203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjAzNDg0YmIyN2QwOTJkZGUwZjkxYmY1MGNlNmJjNTQxZjFlNWRmZQ==", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2016-01-16T02:30:14Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2016-01-16T02:30:14Z"}, "message": "Fix logic bug in Cilk Plus array expansion\n\ngcc/cp/ChangeLog:\n\n\t* cp-array-notation.c (cp_expand_cond_array_notations): Return\n\terror_mark_node only if find_rank failed, not if it was\n\tsuccessful.\n\ngcc/testsuite/ChangeLog:\n\n\t* c-c++-common/cilk-plus/AN/an-if.c: Check that the original\n\tdump does not contain an error_mark_node.\n\t* c-c++-common/cilk-plus/CK/pr60469.c: Likewise.\n\t* c-c++-common/cilk-plus/AN/fn_ptr-2.c: New xfail'd test.\n\nFrom-SVN: r232462", "tree": {"sha": "f5d75ff6dd39696c86933b9753178c8ba2b7bb77", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f5d75ff6dd39696c86933b9753178c8ba2b7bb77"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/comments", "author": null, "committer": null, "parents": [{"sha": "aa2500e9bc6ce022c604fefb5f9c60d6fd7134f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa2500e9bc6ce022c604fefb5f9c60d6fd7134f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa2500e9bc6ce022c604fefb5f9c60d6fd7134f8"}], "stats": {"total": 41, "additions": 37, "deletions": 4}, "files": [{"sha": "91b92a8b82cf28d48da6b55e53f0ebb4cd3d0290", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "patch": "@@ -1,3 +1,9 @@\n+2016-01-16  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\t* cp-array-notation.c (cp_expand_cond_array_notations): Return\n+\terror_mark_node only if find_rank failed, not if it was\n+\tsuccessful.\n+\n 2016-01-16  Patrick Palka  <ppalka@gcc.gnu.org>\n \n \tPR c++/68936"}, {"sha": "4687ced6729c13fd2c64a808c3ffc6dc3fe3993f", "filename": "gcc/cp/cp-array-notation.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Fcp%2Fcp-array-notation.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Fcp%2Fcp-array-notation.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-array-notation.c?ref=203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "patch": "@@ -807,8 +807,8 @@ cp_expand_cond_array_notations (tree orig_stmt)\n       if (!find_rank (EXPR_LOCATION (cond), cond, cond, true, &cond_rank)\n \t  || !find_rank (EXPR_LOCATION (yes_expr), yes_expr, yes_expr, true,\n \t\t\t &yes_rank)\n-\t  || find_rank (EXPR_LOCATION (no_expr), no_expr, no_expr, true,\n-\t\t\t&no_rank))\n+\t  || !find_rank (EXPR_LOCATION (no_expr), no_expr, no_expr, true,\n+\t\t\t &no_rank))\n \treturn error_mark_node;\n       /* If the condition has a zero rank, then handle array notations in body\n \t separately.  */"}, {"sha": "e21aad44ca6b131a43f4ce356cbf11cef2fdbc36", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "patch": "@@ -1,3 +1,10 @@\n+2016-01-16  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\t* c-c++-common/cilk-plus/AN/an-if.c: Check that the original\n+\tdump does not contain an error_mark_node.\n+\t* c-c++-common/cilk-plus/CK/pr60469.c: Likewise.\n+\t* c-c++-common/cilk-plus/AN/fn_ptr-2.c: New xfail'd test.\n+\n 2016-01-16  Patrick Palka  <ppalka@gcc.gnu.org>\n \n \tPR c++/68936"}, {"sha": "4ac46abc4048133d5dab7572d484bbb8b80dc58a", "filename": "gcc/testsuite/c-c++-common/cilk-plus/AN/an-if.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FAN%2Fan-if.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FAN%2Fan-if.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FAN%2Fan-if.c?ref=203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do run } */\n-/* { dg-options \"-fcilkplus\" } */\n+/* { dg-options \"-fcilkplus -fdump-tree-original\" } */\n \n #if HAVE_IO\n #include <stdio.h>\n@@ -46,3 +46,6 @@ int main() {\n     }\n     return 0;\n }\n+\n+/* The C++ FE once emitted a bogus error_mark_node for this test case.  */\n+/* { dg-final { scan-tree-dump-not \"<<< error >>>\" \"original\" } } */"}, {"sha": "4e1990fcc3474715e1cae6e223549a3ed7fd106d", "filename": "gcc/testsuite/c-c++-common/cilk-plus/AN/fn_ptr-2.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FAN%2Ffn_ptr-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FAN%2Ffn_ptr-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FAN%2Ffn_ptr-2.c?ref=203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fcilkplus\" } */\n+\n+typedef void (*f) (void *);\n+f b[1024];\n+void *c[1024][1024];\n+\n+int\n+main (void)\n+{\n+  (b[:]) (c[:][:]); /* { dg-error \"rank mismatch\" \"\" { xfail *-*-* } } */\n+  return 0;\n+}\n+"}, {"sha": "670df17faa2c56b5268e5c05b2accd9453a78287", "filename": "gcc/testsuite/c-c++-common/cilk-plus/CK/pr60469.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fpr60469.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203484bb27d092dde0f91bf50ce6bc541f1e5dfe/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fpr60469.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fpr60469.c?ref=203484bb27d092dde0f91bf50ce6bc541f1e5dfe", "patch": "@@ -1,6 +1,6 @@\n /* PR middle-end/60469 */\n /* { dg-do compile } */\n-/* { dg-options \"-fcilkplus\" } */\n+/* { dg-options \"-fcilkplus -fdump-tree-original\" } */\n \n void foo() {}\n \n@@ -13,3 +13,6 @@ int main(int argc, char* argv[])\n   _Cilk_spawn foo();\n   return 0;\n }\n+\n+/* The C++ FE once emitted a bogus error_mark_node for this test case.  */\n+/* { dg-final { scan-tree-dump-not \"<<< error >>>\" \"original\" } } */"}]}