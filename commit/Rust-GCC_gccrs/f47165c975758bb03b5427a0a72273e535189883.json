{"sha": "f47165c975758bb03b5427a0a72273e535189883", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjQ3MTY1Yzk3NTc1OGJiMDNiNTQyN2EwYTcyMjczZTUzNTE4OTg4Mw==", "commit": {"author": {"name": "Steve Ellcey", "email": "sje@cup.hp.com", "date": "2006-08-01T16:31:40Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2006-08-01T16:31:40Z"}, "message": "re PR c++/28256 (ICE with empty initializer)\n\n\tPR c++/28256\n\t* decl.c (check_initializer): Check for 1 initializer on scalar types.\n\t* g++.dg/init/brace2.C: Change expected error message, add empty init.\n\nFrom-SVN: r115856", "tree": {"sha": "4cdddc7b7fbe172f68632f40ef0c73b2d4f5d9d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4cdddc7b7fbe172f68632f40ef0c73b2d4f5d9d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f47165c975758bb03b5427a0a72273e535189883", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f47165c975758bb03b5427a0a72273e535189883", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f47165c975758bb03b5427a0a72273e535189883", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f47165c975758bb03b5427a0a72273e535189883/comments", "author": null, "committer": null, "parents": [{"sha": "4fbbe6941cb824dc2defe3172263efac648ec27a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4fbbe6941cb824dc2defe3172263efac648ec27a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4fbbe6941cb824dc2defe3172263efac648ec27a"}], "stats": {"total": 22, "additions": 20, "deletions": 2}, "files": [{"sha": "8fe52a90c0f0d5fd3bc418380221a3ac8725dc59", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f47165c975758bb03b5427a0a72273e535189883/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f47165c975758bb03b5427a0a72273e535189883/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f47165c975758bb03b5427a0a72273e535189883", "patch": "@@ -1,3 +1,8 @@\n+2006-08-01  Steve Ellcey  <sje@cup.hp.com>\n+\n+\tPR c++/28256\n+\t* decl.c (check_initializer): Check for 1 initializer on scalar types.\n+\n 2006-08-01  Daniel Jacobowitz  <dan@codesourcery.com>\n \n \tPR debug/23336"}, {"sha": "fe73942e9bd5841b5f7b8d225d9ea5afbf0d3f9d", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f47165c975758bb03b5427a0a72273e535189883/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f47165c975758bb03b5427a0a72273e535189883/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=f47165c975758bb03b5427a0a72273e535189883", "patch": "@@ -4730,6 +4730,14 @@ check_initializer (tree decl, tree init, int flags, tree *cleanup)\n       TREE_TYPE (decl) = error_mark_node;\n       init = NULL_TREE;\n     }\n+  else if (!CP_AGGREGATE_TYPE_P (type)\n+\t   && init && BRACE_ENCLOSED_INITIALIZER_P (init)\n+\t   && VEC_length (constructor_elt, CONSTRUCTOR_ELTS (init)) != 1)\n+    {\n+      error (\"scalar object %qD requires one element in initializer\", decl);\n+      TREE_TYPE (decl) = error_mark_node;\n+      init = NULL_TREE;\n+    }\n \n   if (TREE_CODE (decl) == CONST_DECL)\n     {"}, {"sha": "e1a69c1dd9ad21e3e06610bb021592237e7905f6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f47165c975758bb03b5427a0a72273e535189883/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f47165c975758bb03b5427a0a72273e535189883/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f47165c975758bb03b5427a0a72273e535189883", "patch": "@@ -1,3 +1,8 @@\n+2006-08-01  Steve Ellcey  <sje@cup.hp.com>\n+\n+\tPR c++/28256\n+\t* g++.dg/init/brace2.C: Change expected error message, add empty init.\n+\n 2006-08-01  Daniel Jacobowitz  <dan@codesourcery.com>\n \n \tPR debug/23336"}, {"sha": "2af063d5f5668e165bb550a31be90de8850317b7", "filename": "gcc/testsuite/g++.dg/init/brace2.C", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f47165c975758bb03b5427a0a72273e535189883/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fbrace2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f47165c975758bb03b5427a0a72273e535189883/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fbrace2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Fbrace2.C?ref=f47165c975758bb03b5427a0a72273e535189883", "patch": "@@ -3,6 +3,6 @@\n int x = { 2 };\n const char * y = { \"hello\" };\n int a = 2;\n-int b = { 2,3 }; // { dg-error \"too many initializers\" }\n+int b = { 2,3 }; // { dg-error \"requires one element in initializer\" }\n int c = { { 2 } } ; // { dg-error \"braces around scalar initializer\" }\n-\n+int d = {}; // { dg-error \"requires one element in initializer\" }"}]}