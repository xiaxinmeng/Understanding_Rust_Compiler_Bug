{"sha": "dc329d293894ba51b1630a2d41c8e23e1478893b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGMzMjlkMjkzODk0YmE1MWIxNjMwYTJkNDFjOGUyM2UxNDc4ODkzYg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2000-08-11T22:41:38Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2000-08-11T22:41:38Z"}, "message": "straits.h (is_del): Boolify with !!.\n\n        * std/straits.h (is_del): Boolify with !!.\n\n        * std/bastring.cc (compare to charT*): Add rlen==n check.\n        * std/bastring.h (Rep::grab): Add x86 atomic version.\n\nFrom-SVN: r35647", "tree": {"sha": "a60805c840ee94f03189163f278c237b8628e4cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a60805c840ee94f03189163f278c237b8628e4cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dc329d293894ba51b1630a2d41c8e23e1478893b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc329d293894ba51b1630a2d41c8e23e1478893b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc329d293894ba51b1630a2d41c8e23e1478893b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc329d293894ba51b1630a2d41c8e23e1478893b/comments", "author": null, "committer": null, "parents": [{"sha": "dcf6e6746d750dd8bf123341fff16fa33a7ca203", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dcf6e6746d750dd8bf123341fff16fa33a7ca203", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dcf6e6746d750dd8bf123341fff16fa33a7ca203"}], "stats": {"total": 30, "additions": 24, "deletions": 6}, "files": [{"sha": "ba4a27385e5a4e00626d8018f1d21ad0ce18e292", "filename": "libstdc++/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B%2FChangeLog?ref=dc329d293894ba51b1630a2d41c8e23e1478893b", "patch": "@@ -1,3 +1,12 @@\n+2000-08-11  Jason Merrill  <jason@redhat.com>\n+\n+\t* std/straits.h (is_del): Boolify with !!.\n+\n+2000-08-11  \"Axel Habermann\" <Axel.Habermann@xtradyne.de>\n+\n+\t* std/bastring.cc (compare to charT*): Add rlen==n check.\n+\t* std/bastring.h (Rep::grab): Add x86 atomic version.\n+\n 2000-8-4  David E O'Brien  <obrien@FreeBSD.org>\n \n \t* std/mask_array.h (mask_array): Rename template type"}, {"sha": "b8fec4fa7dba9c98d6b02f30288ebbbebfbb3c17", "filename": "libstdc++/std/bastring.cc", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2Fstd%2Fbastring.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2Fstd%2Fbastring.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B%2Fstd%2Fbastring.cc?ref=dc329d293894ba51b1630a2d41c8e23e1478893b", "patch": "@@ -1,5 +1,5 @@\n // Member templates for the -*- C++ -*- string classes.\n-// Copyright (C) 1994, 1999 Free Software Foundation\n+// Copyright (C) 1994, 1999, 2000 Free Software Foundation\n \n // This file is part of the GNU ANSI C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -423,6 +423,8 @@ compare (const charT* s, size_type pos, size_type n) const\n   int r = traits::compare (data () + pos, s, rlen);\n   if (r != 0)\n     return r;\n+  if (rlen == n)   \n+    return 0;\n   return (length () - pos) - n;\n }\n "}, {"sha": "5551ec1fe478ca5d6daac9ddd2b6f23ff286fed4", "filename": "libstdc++/std/bastring.h", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2Fstd%2Fbastring.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2Fstd%2Fbastring.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B%2Fstd%2Fbastring.h?ref=dc329d293894ba51b1630a2d41c8e23e1478893b", "patch": "@@ -72,9 +72,14 @@ class basic_string\n \n     charT* data () { return reinterpret_cast<charT *>(this + 1); }\n     charT& operator[] (size_t s) { return data () [s]; }\n-    charT* grab () { if (selfish) return clone (); ++ref; return data (); }\n #if defined __i486__ || defined __i586__ || defined __i686__\n-    void release ()\n+    charT* grab () { if (selfish) return clone (); \n+      asm (\"lock; addl %0, (%1)\"\n+           : : \"a\" (1), \"d\" (&ref)\n+           : \"memory\");\n+      return data (); }\n+\n+    void release () \n       {\n \tsize_t __val;\n \t// This opcode exists as a .byte instead of as a mnemonic for the\n@@ -90,6 +95,7 @@ class basic_string\n \t  delete this;\n       }\n #elif defined __sparc_v9__\n+    charT* grab () { if (selfish) return clone (); ++ref; return data (); }\n     void release ()\n       {\n \tsize_t __newval, __oldval = ref;\n@@ -111,6 +117,7 @@ class basic_string\n \t  delete this;\n       }\n #else\n+    charT* grab () { if (selfish) return clone (); ++ref; return data (); }\n     void release () { if (--ref == 0) delete this; }\n #endif\n "}, {"sha": "eada4fc4d859c463f5026cdc0bf02c755810e07b", "filename": "libstdc++/std/straits.h", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2Fstd%2Fstraits.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc329d293894ba51b1630a2d41c8e23e1478893b/libstdc%2B%2B%2Fstd%2Fstraits.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B%2Fstd%2Fstraits.h?ref=dc329d293894ba51b1630a2d41c8e23e1478893b", "patch": "@@ -1,5 +1,5 @@\n // Character traits template for the -*- C++ -*- string classes.\n-// Copyright (C) 1994 Free Software Foundation\n+// Copyright (C) 1994, 2000 Free Software Foundation\n \n // This file is part of the GNU ANSI C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -117,7 +117,7 @@ struct string_char_traits <char> {\n   static bool lt (const char_type& c1, const char_type& c2)\n     { return (c1 < c2); }\n   static char_type eos () { return 0; }\n-  static bool is_del(char_type a) { return isspace(a); }\n+  static bool is_del(char_type a) { return !!isspace(a); }\n \n   static int compare (const char_type* s1, const char_type* s2, size_t n)\n     { return memcmp (s1, s2, n); }\n@@ -145,7 +145,7 @@ struct string_char_traits <wchar_t> {\n   static bool lt (const char_type& c1, const char_type& c2)\n     { return (c1 < c2); }\n   static char_type eos () { return 0; }\n-  static bool is_del(char_type a) { return iswspace(a); }\n+  static bool is_del(char_type a) { return !!iswspace(a); }\n \n   static int compare (const char_type* s1, const char_type* s2, size_t n)\n     { return wmemcmp (s1, s2, n); }"}]}