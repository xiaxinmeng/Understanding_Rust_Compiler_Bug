{"sha": "14532762245860c7f5fef6cd83f283359590b22b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTQ1MzI3NjIyNDU4NjBjN2Y1ZmVmNmNkODNmMjgzMzU5NTkwYjIyYg==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2004-12-08T11:45:51Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2004-12-08T11:45:51Z"}, "message": "exp_ch7.adb (Expand_Cleanup_Actions): If statement sequence of construct is rewritten...\n\n\t* exp_ch7.adb (Expand_Cleanup_Actions): If statement sequence of\n\tconstruct is rewritten, preserve end label to permit source navigation.\n\nFrom-SVN: r91883", "tree": {"sha": "9d663321d683aa76b371a007a82fa03c922ef5f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9d663321d683aa76b371a007a82fa03c922ef5f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/14532762245860c7f5fef6cd83f283359590b22b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14532762245860c7f5fef6cd83f283359590b22b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14532762245860c7f5fef6cd83f283359590b22b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14532762245860c7f5fef6cd83f283359590b22b/comments", "author": null, "committer": null, "parents": [{"sha": "98f01d532a15a16c5d9afb0d35c9ea18688d2541", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98f01d532a15a16c5d9afb0d35c9ea18688d2541", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98f01d532a15a16c5d9afb0d35c9ea18688d2541"}], "stats": {"total": 14, "additions": 10, "deletions": 4}, "files": [{"sha": "6134df71199cb64e7df3c4ddcf020954615d3f47", "filename": "gcc/ada/exp_ch7.adb", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14532762245860c7f5fef6cd83f283359590b22b/gcc%2Fada%2Fexp_ch7.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14532762245860c7f5fef6cd83f283359590b22b/gcc%2Fada%2Fexp_ch7.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch7.adb?ref=14532762245860c7f5fef6cd83f283359590b22b", "patch": "@@ -507,7 +507,7 @@ package body Exp_Ch7 is\n       --  of a single component of the array.\n \n       function Free_One_Dimension (Dim : Int) return List_Id;\n-      --  Generate a loop over one dimension of the array.\n+      --  Generate a loop over one dimension of the array\n \n       --------------------\n       -- Free_Component --\n@@ -721,7 +721,7 @@ package body Exp_Ch7 is\n          Next_Entity (E);\n       end loop;\n \n-      --   Analyze inserted cleanup statements.\n+      --   Analyze inserted cleanup statements\n \n       if Present (Stmt) then\n          Stmt := Next (Stmt);\n@@ -1106,6 +1106,7 @@ package body Exp_Ch7 is\n       Mark      : Entity_Id := Empty;\n       New_Decls : constant List_Id := New_List;\n       Blok      : Node_Id;\n+      End_Lab   : Node_Id;\n       Wrapped   : Boolean;\n       Chain     : Entity_Id := Empty;\n       Decl      : Node_Id;\n@@ -1233,11 +1234,16 @@ package body Exp_Ch7 is\n       --  exception handlers and an AT END call in the same scope.\n \n       if Present (Exception_Handlers (Handled_Statement_Sequence (N))) then\n+\n+         --  Preserve end label to provide proper cross-reference information\n+\n+         End_Lab := End_Label (Handled_Statement_Sequence (N));\n          Blok :=\n            Make_Block_Statement (Loc,\n              Handled_Statement_Sequence => Handled_Statement_Sequence (N));\n          Set_Handled_Statement_Sequence (N,\n            Make_Handled_Sequence_Of_Statements (Loc, New_List (Blok)));\n+         Set_End_Label (Handled_Statement_Sequence (N), End_Lab);\n          Wrapped := True;\n \n       --  Otherwise we do not wrap\n@@ -1306,7 +1312,7 @@ package body Exp_Ch7 is\n       Set_Declarations (N, New_Decls);\n       Analyze_Declarations (New_Decls);\n \n-      --  The At_End call is attached to the sequence of statements.\n+      --  The At_End call is attached to the sequence of statements\n \n       declare\n          HSS : Node_Id;\n@@ -2140,7 +2146,7 @@ package body Exp_Ch7 is\n          --  NOTE: This cleanup handler references _object, a parameter\n          --        to the procedure.\n \n-         --  Find the _object parameter representing the protected object.\n+         --  Find the _object parameter representing the protected object\n \n          Spec := Parent (Corresponding_Spec (N));\n "}]}