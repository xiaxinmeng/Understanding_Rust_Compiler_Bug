{"sha": "85af47b9e63a79018beeb7f19190860cb990cdba", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVhZjQ3YjllNjNhNzkwMThiZWViN2YxOTE5MDg2MGNiOTkwY2RiYQ==", "commit": {"author": {"name": "Daniel Jacobowitz", "email": "drow@mvista.com", "date": "2002-11-19T18:27:01Z"}, "committer": {"name": "Daniel Jacobowitz", "email": "drow@gcc.gnu.org", "date": "2002-11-19T18:27:01Z"}, "message": "sh.c (gen_shl_and): Revert previous patch.\n\n        * config/sh/sh.c (gen_shl_and): Revert previous patch.\n        * config/sh/sh.md (ashrdi3+1, ashrdi3+2): Predicate on\n        reload_completed.\n\nFrom-SVN: r59269", "tree": {"sha": "791aa842a20236baa6b2332895b5ec15d1a21358", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/791aa842a20236baa6b2332895b5ec15d1a21358"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85af47b9e63a79018beeb7f19190860cb990cdba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85af47b9e63a79018beeb7f19190860cb990cdba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85af47b9e63a79018beeb7f19190860cb990cdba", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85af47b9e63a79018beeb7f19190860cb990cdba/comments", "author": null, "committer": null, "parents": [{"sha": "9675a91e9b34e7f8e0ecdcad732c58f14784d465", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9675a91e9b34e7f8e0ecdcad732c58f14784d465", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9675a91e9b34e7f8e0ecdcad732c58f14784d465"}], "stats": {"total": 38, "additions": 15, "deletions": 23}, "files": [{"sha": "31e3bbbd8302a1ae10dd1de46db9bf472b09d5be", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85af47b9e63a79018beeb7f19190860cb990cdba/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85af47b9e63a79018beeb7f19190860cb990cdba/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=85af47b9e63a79018beeb7f19190860cb990cdba", "patch": "@@ -1,3 +1,9 @@\n+2002-11-19  Daniel Jacobowitz  <drow@mvista.com>\n+\n+\t* config/sh/sh.c (gen_shl_and): Revert previous patch.\n+\t* config/sh/sh.md (ashrdi3+1, ashrdi3+2): Predicate on\n+\treload_completed.\n+\n 2002-11-19  Kazu Hirata  <kazu@cs.umass.edu>\n \n \t* config/h8300/h8300.c (print_operand): Update the use of"}, {"sha": "70cb0c1f167de34d4e3f7f0b26c10975ccca54a1", "filename": "gcc/config/sh/sh.c", "status": "modified", "additions": 7, "deletions": 21, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85af47b9e63a79018beeb7f19190860cb990cdba/gcc%2Fconfig%2Fsh%2Fsh.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85af47b9e63a79018beeb7f19190860cb990cdba/gcc%2Fconfig%2Fsh%2Fsh.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.c?ref=85af47b9e63a79018beeb7f19190860cb990cdba", "patch": "@@ -1823,16 +1823,11 @@ gen_shl_and (dest, left_rtx, mask_rtx, source)\n \n \tif (first < 0)\n \t  {\n-\t    enum machine_mode mode\n-\t      = ((mask << right) <= 0xff) ? QImode : HImode;\n-\t    rtx lowpart = gen_lowpart (mode, source);\n-\n-\t    if (no_new_pseudos && ! TARGET_SHMEDIA\n-\t\t&& ! arith_reg_operand (lowpart, mode))\n-\t      return -1;\n \t    emit_insn ((mask << right) <= 0xff\n-\t\t       ? gen_zero_extendqisi2(dest, lowpart)\n-\t\t       : gen_zero_extendhisi2(dest, lowpart));\n+\t\t       ? gen_zero_extendqisi2(dest,\n+\t\t\t\t\t      gen_lowpart (QImode, source))\n+\t\t       : gen_zero_extendhisi2(dest,\n+\t\t\t\t\t      gen_lowpart (HImode, source)));\n \t    source = dest;\n \t  }\n \tif (source != dest)\n@@ -1851,18 +1846,9 @@ gen_shl_and (dest, left_rtx, mask_rtx, source)\n \t    mask <<= first;\n \t  }\n \tif (first >= 0)\n-\t  {\n-\t    enum machine_mode mode = (mask <= 0xff) ? QImode : HImode;\n-\t    rtx lowpart = gen_lowpart (mode, dest);\n-\n-\t    if (no_new_pseudos && ! TARGET_SHMEDIA\n-\t\t&& ! arith_reg_operand (lowpart, mode))\n-\t      return -1;\n-\t    emit_insn (mask <= 0xff\n-\t\t       ? gen_zero_extendqisi2(dest, lowpart)\n-\t\t       : gen_zero_extendhisi2(dest, lowpart));\n-\t  }\n-\t\n+\t  emit_insn (mask <= 0xff\n+\t\t     ? gen_zero_extendqisi2(dest, gen_lowpart (QImode, dest))\n+\t\t     : gen_zero_extendhisi2(dest, gen_lowpart (HImode, dest)));\n \tif (total_shift > 0)\n \t  {\n \t    operands[2] = GEN_INT (total_shift);"}, {"sha": "ed14fbd4e33d0546478af1405e43be1034a9d7e2", "filename": "gcc/config/sh/sh.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85af47b9e63a79018beeb7f19190860cb990cdba/gcc%2Fconfig%2Fsh%2Fsh.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85af47b9e63a79018beeb7f19190860cb990cdba/gcc%2Fconfig%2Fsh%2Fsh.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.md?ref=85af47b9e63a79018beeb7f19190860cb990cdba", "patch": "@@ -2694,7 +2694,7 @@\n \t(and:SI (ashift:SI (match_operand:SI 1 \"register_operand\" \"\")\n \t\t\t   (match_operand:SI 2 \"const_int_operand\" \"\"))\n \t\t(match_operand:SI 3 \"const_int_operand\" \"\")))]\n-  \"TARGET_SH1 && (unsigned)INTVAL (operands[2]) < 32\"\n+  \"TARGET_SH1 && reload_completed && (unsigned)INTVAL (operands[2]) < 32\"\n   [(use (reg:SI R0_REG))]\n   \"if (gen_shl_and (operands[0], operands[2], operands[3], operands[1])) FAIL;\n    DONE;\")\n@@ -2705,7 +2705,7 @@\n \t\t\t   (match_operand:SI 2 \"const_int_operand\" \"\"))\n \t\t(match_operand:SI 3 \"const_int_operand\" \"\")))\n    (clobber (reg:SI T_REG))]\n-  \"TARGET_SH1 && (unsigned)INTVAL (operands[2]) < 32\"\n+  \"TARGET_SH1 && reload_completed && (unsigned)INTVAL (operands[2]) < 32\"\n   [(use (reg:SI R0_REG))]\n   \"if (gen_shl_and (operands[0], operands[2], operands[3], operands[1])) FAIL;\n    DONE;\")"}]}