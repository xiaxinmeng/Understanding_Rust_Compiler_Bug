{"sha": "170e0690ee57c42c1805f5d7e31f29c94b97ea91", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTcwZTA2OTBlZTU3YzQyYzE4MDVmNWQ3ZTMxZjI5Yzk0Yjk3ZWE5MQ==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "1996-10-18T17:35:40Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "1996-10-18T17:35:40Z"}, "message": "Fix float conversions if sign extension in offset would occur\n\nFrom-SVN: r12977", "tree": {"sha": "8a906f2d6a895a3db47771389139a716d7b9ec10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a906f2d6a895a3db47771389139a716d7b9ec10"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/170e0690ee57c42c1805f5d7e31f29c94b97ea91", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/170e0690ee57c42c1805f5d7e31f29c94b97ea91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/170e0690ee57c42c1805f5d7e31f29c94b97ea91", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/170e0690ee57c42c1805f5d7e31f29c94b97ea91/comments", "author": null, "committer": null, "parents": [{"sha": "f37230f0b482fc057ba2dc7d9fbdb2bec90ba19e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f37230f0b482fc057ba2dc7d9fbdb2bec90ba19e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f37230f0b482fc057ba2dc7d9fbdb2bec90ba19e"}], "stats": {"total": 14, "additions": 7, "deletions": 7}, "files": [{"sha": "382a0a79abda763f1b01a37acb85838b4dcec924", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/170e0690ee57c42c1805f5d7e31f29c94b97ea91/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/170e0690ee57c42c1805f5d7e31f29c94b97ea91/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=170e0690ee57c42c1805f5d7e31f29c94b97ea91", "patch": "@@ -3670,7 +3670,7 @@\n \n       xop[0] = operands[0];\n       xop[1] = (frame_pointer_needed) ? frame_pointer_rtx : stack_pointer_rtx;\n-      xop[2] = GEN_INT ((rs6000_fpmem_offset >> 16) & 0xffff);\n+      xop[2] = GEN_INT ((rs6000_fpmem_offset >> 16) + ((rs6000_fpmem_offset & 0x8000) >> 15));\n       output_asm_insn (\\\"{cau %0,%2(%1)|addis %0,%1,%2}\\\", xop);\n     }\n   else if (rs6000_fpmem_offset < 0)\n@@ -3699,7 +3699,7 @@\n   operands[2] = gen_rtx (MEM, SImode,\n \t\t\t gen_rtx (PLUS, Pmode,\n \t\t\t\t  indx,\n-\t\t\t\t  GEN_INT ((rs6000_fpmem_offset & 0xffff)\n+\t\t\t\t  GEN_INT ((((rs6000_fpmem_offset & 0xffff) ^ 0x8000) - 0x8000)\n \t\t\t\t\t   + ((WORDS_BIG_ENDIAN != 0) * 4))));\n \n   return \\\"{st|stw} %0,%2\\\";\n@@ -3726,7 +3726,7 @@\n   operands[2] = gen_rtx (MEM, SImode,\n \t\t\t gen_rtx (PLUS, Pmode,\n \t\t\t\t  indx,\n-\t\t\t\t  GEN_INT ((rs6000_fpmem_offset & 0xffff)\n+\t\t\t\t  GEN_INT ((((rs6000_fpmem_offset & 0xffff) ^ 0x8000) - 0x8000)\n \t\t\t\t\t   + ((WORDS_BIG_ENDIAN == 0) * 4))));\n \n   return \\\"{st|stw} %0,%2\\\";\n@@ -3746,7 +3746,7 @@\n   if (rs6000_fpmem_offset > 32760)\n     {\n       indx = operands[1];\n-      offset &= 0xffff;\n+      offset = (((offset & 0xffff) ^ 0x8000) - 0x8000);\n     }\n   else if (frame_pointer_needed)\n     indx = frame_pointer_rtx;\n@@ -3836,9 +3836,9 @@\n   operands[2] = gen_rtx (MEM, DFmode,\n \t\t\t gen_rtx (PLUS, Pmode,\n \t\t\t\t  indx,\n-\t\t\t\t  GEN_INT ((rs6000_fpmem_offset & 0xffff))));\n+\t\t\t\t  GEN_INT (rs6000_fpmem_offset)));\n \n-  return \\\"stfd %0,%2\\\";\n+  return \\\"stfd %0,%w2\\\";\n }\"\n   [(set_attr \"type\" \"fpstore\")])\n \n@@ -3861,7 +3861,7 @@\n   operands[2] = gen_rtx (MEM, DFmode,\n \t\t\t gen_rtx (PLUS, Pmode,\n \t\t\t\t  indx,\n-\t\t\t\t  GEN_INT ((rs6000_fpmem_offset & 0xffff)\n+\t\t\t\t  GEN_INT ((((rs6000_fpmem_offset & 0xffff) ^ 0x8000) - 0x8000)\n \t\t\t\t\t   + ((WORDS_BIG_ENDIAN) ? 4 : 0))));\n \n   return \\\"{l|lwz} %0,%2\\\";"}]}