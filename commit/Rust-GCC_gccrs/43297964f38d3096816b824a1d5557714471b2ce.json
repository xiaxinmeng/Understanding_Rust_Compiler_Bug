{"sha": "43297964f38d3096816b824a1d5557714471b2ce", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDMyOTc5NjRmMzhkMzA5NjgxNmI4MjRhMWQ1NTU3NzE0NDcxYjJjZQ==", "commit": {"author": {"name": "Craig Burley", "email": "craig@jcb-sc.com", "date": "1999-02-22T08:49:36Z"}, "committer": {"name": "Craig Burley", "email": "burley@gcc.gnu.org", "date": "1999-02-22T08:49:36Z"}, "message": "improve wall of separation between build and install\n\nFrom-SVN: r25367", "tree": {"sha": "ba621587c9761eda2f90d62ec9556008acf4c724", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ba621587c9761eda2f90d62ec9556008acf4c724"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/43297964f38d3096816b824a1d5557714471b2ce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43297964f38d3096816b824a1d5557714471b2ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/43297964f38d3096816b824a1d5557714471b2ce", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/43297964f38d3096816b824a1d5557714471b2ce/comments", "author": null, "committer": null, "parents": [{"sha": "a2cf7debc7c05419c10d07324e93b157b4717283", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a2cf7debc7c05419c10d07324e93b157b4717283", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a2cf7debc7c05419c10d07324e93b157b4717283"}], "stats": {"total": 87, "additions": 65, "deletions": 22}, "files": [{"sha": "edde6873f7967a722ef653a68765b27b6d51633a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -1,4 +1,9 @@\n Mon Feb 22 11:40:44 1999  Craig Burley  <craig@jcb-sc.com>\n+Sat Feb 20 09:59:36 1999  Craig Burley  <craig@jcb-sc.com>\n+\n+\t* Makefile.in (all.internal, all.cross): Depend on `doc'\n+\ttarget, to ensure docs get made before installation.\n+\n \n \tDecrease spurious warnings from -fsyntax-only:\n \t* stmt.c (expand_expr_stmt): Expand expr even when -fsyntax-only."}, {"sha": "93d03cd48a01ab67f00fffd11037c396080ae66b", "filename": "gcc/Makefile.in", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -824,12 +824,12 @@ config.status: configure version.c\n \t  LANGUAGES=\"$(CONFIG_LANGUAGES)\" $(SHELL) config.status --recheck; \\\n \tfi\n \n-all.internal: start.encap rest.encap\n+all.internal: start.encap rest.encap doc\n # This is what to compile if making a cross-compiler.\n # Note that we can compile enquire using the cross-compiler just built,\n # although we can't run it on this machine.\n all.cross: native gcc-cross specs stmp-headers $(STMP_FIXPROTO) $(LIBGCC) \\\n-\t$(LIBGCC1_TEST) $(EXTRA_PARTS) lang.all.cross\n+\t$(LIBGCC1_TEST) $(EXTRA_PARTS) lang.all.cross doc\n # This is what to compile if making gcc with a cross-compiler.\n all.build: native xgcc$(exeext) $(EXTRA_PARTS) lang.all.build\n # This is what must be made before installing GCC and converting libraries."}, {"sha": "2c3f9385974394a058f525369de64ed68a219fb8", "filename": "gcc/ch/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fch%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fch%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fch%2FChangeLog?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -1,4 +1,16 @@\n Sun Jan 31 20:34:29 1999  Zack Weinberg  <zack@rabi.columbia.edu>\n+1999-02-20  Craig Burley  <craig@jcb-sc.com>\n+\n+\t* Make-lang.in (CHILL.info): Depend on intermediate ch/chill.info\n+\ttarget instead of the chill.texi file.\n+\t(ch/chill.info): New target, depends on the chill.texi source file.\n+\tIts command writes ch/chill.info instead of chill.info.\n+\t(CHILL.install-info): Install from ch/chill.info instead of\n+\tchill.info.\n+\tIf any ch/chill.info* files exist, delete *all* chill.info* files\n+\tin $infodir first, not just the ones corresponding to the\n+\tfiles to be installed (just in case the docs get smaller).\n+\n \n \t* decl2.c: Don't define flag_no_ident here.  Don't process\n \t-f(no-)ident here."}, {"sha": "e0e94626127f8d390773eeda500657683df7f86b", "filename": "gcc/ch/Make-lang.in", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fch%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fch%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fch%2FMake-lang.in?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -107,8 +107,10 @@ CHILL.all.cross: chill-cross\n CHILL.start.encap: chill\n CHILL.rest.encap:\n \n-CHILL.info: $(srcdir)/ch/chill.texi\n-\t$(MAKEINFO) -I$(srcdir)/ch $(srcdir)/ch/chill.texi -o chill.info\n+CHILL.info: ch/chill.info\n+\n+ch/chill.info: $(srcdir)/ch/chill.texi\n+\t$(MAKEINFO) -I$(srcdir)/ch $(srcdir)/ch/chill.texi -o ch/chill.info\n \n chill.dvi: $(srcdir)/ch/chill.texi $(srcdir)/extend.texi $(srcdir)/invoke.texi $(srcdir)/md.texi $(srcdir)/rtl.texi $(srcdir)/tm.texi\n \tcd ch ; \\\n@@ -139,10 +141,13 @@ CHILL.install-common:\n \t  fi ; \\\n \tfi\n \n+# Don't delete $(infodir)/ch.info* unless there's actually new\n+# docs to install (in case LANGUAGES didn't contain chill earlier).\n CHILL.install-info:\n-\t-for i in chill.info*; do \\\n-\t  rm -f $(infodir)/$$i; \\\n-\t  $(INSTALL_DATA) $$i $(infodir)/$$i; \\\n+\t-for i in ch/chill.info*; do \\\n+\t  rm -f $(infodir)/chill.info*; \\\n+\t  realfile=`echo $$i | sed -e 's|.*/\\([^/]*\\)$$|\\1|'`; \\\n+\t  $(INSTALL_DATA) $$i $(infodir)/$$realfile; \\\n \tdone\n \n CHILL.install-man:"}, {"sha": "a4d9d60786ac083fa63bf9faf4b5e6259bc70343", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -1,4 +1,10 @@\n Sun Feb 21 20:38:00 1999  H.J. Lu  (hjl@gnu.org)\n+1999-02-20  Craig Burley  <craig@jcb-sc.com>\n+\n+\t* Make-lang.in (cplib2.ready): Don't consider updating\n+\tcplib2 stuff if the current directory isn't writable, as\n+\tit won't work (such as during a `make install').\n+\n \n \t* decl2.c (start_objects): Make file scope constructors and\n \tdestructors local to the file if ASM_OUTPUT_CONSTRUCTOR and"}, {"sha": "8be82bfc9493c229a8094ad7ccacfa1424e82bc6", "filename": "gcc/cp/Make-lang.in", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fcp%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Fcp%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FMake-lang.in?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -189,8 +189,11 @@ cplib2.txt: $(CXX_LIB2SRCS) $(CXX_EXTRA_HEADERS) cplib2.ready\n \tmv -f cplib2.new cplib2.txt \n \n # Or if it would be different.\n+# Don't try to do write if `.' is not writable;\n+# in that case, we're installing from someone else's directory.\n+# But go ahead and fail if that directory hasn't been properly built.\n cplib2.ready: $(GCC_PASSES) $(LANGUAGES) $(LIBGCC2_DEPS) stmp-int-hdrs\n-\t@if [ -r cplib2.txt ]; then \\\n+\t@if [ -r cplib2.txt -a -w . ]; then \\\n \t  case \" $(LANGUAGES) \" in \\\n \t  *\" \"[cC]\"++ \"*) \\\n \t    echo $(CXX_LIB2FUNCS) > cplib2.new;; \\"}, {"sha": "45695f21e776e3d69c8f172c841d5a83d32ec3cb", "filename": "gcc/f/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Ff%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Ff%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2FChangeLog?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -1,4 +1,12 @@\n 1999-02-20  Craig Burley  <craig@jcb-sc.com>\n+1999-02-20  Craig Burley  <craig@jcb-sc.com>\n+\n+\t* Make-lang.in (f77.install-common, f77.install-info,\n+\tf77.install-man, f77.uninstall): Use `$(prefix)/lang-f77'\n+\tinstead of `lang-f77' for flag file, to be sure of a\n+\twritable directory, and remove the flag file after each\n+\toperation to keep things clean.\n+\n \n \t* g77.texi: Properly attribute Priest document; clarify\n \tthat it is in the .ps version of the Goldberg document."}, {"sha": "3cc2884547cdc9687c6bf6e84c28d5c0e4d0408c", "filename": "gcc/f/Make-lang.in", "status": "modified", "additions": 18, "deletions": 14, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Ff%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/43297964f38d3096816b824a1d5557714471b2ce/gcc%2Ff%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2FMake-lang.in?ref=43297964f38d3096816b824a1d5557714471b2ce", "patch": "@@ -331,10 +331,10 @@ f77.install-normal:\n # and also as either g77 (if native) or $(tooldir)/bin/g77.\n f77.install-common:\n \tcase \"$(LANGUAGES)\" in \\\n-\t  *[fF]77*) touch lang-f77;; \\\n-\t  *) rm -f lang-f77;; \\\n+\t  *[fF]77*) touch $(prefix)/lang-f77;; \\\n+\t  *) rm -f $(prefix)/lang-f77;; \\\n \tesac\n-\t-if [ -f lang-f77 -a -f f771$(exeext) ] ; then \\\n+\t-if [ -f $(prefix)/lang-f77 -a -f f771$(exeext) ] ; then \\\n \t  if [ -f g77-cross$(exeext) ] ; then \\\n \t    rm -f $(bindir)/$(G77_CROSS_NAME)$(exeext); \\\n \t    $(INSTALL_PROGRAM) g77-cross$(exeext) $(bindir)/$(G77_CROSS_NAME)$(exeext); \\\n@@ -354,35 +354,37 @@ f77.install-common:\n \t  echo '         f77-install-ok in the source or build directory.)'; \\\n \t  echo ''; \\\n \telse true; fi\n+\trm -f $(prefix)/lang-f77\n \n # $(INSTALL_DATA) might be a relative pathname, so we can't cd into srcdir\n # to do the install.  The sed rule was copied from stmp-int-hdrs.\n f77.install-info: f77.info\n \tcase \"$(LANGUAGES)\" in \\\n-\t  *[fF]77*) touch lang-f77;; \\\n-\t  *) rm -f lang-f77;; \\\n+\t  *[fF]77*) touch $(prefix)/lang-f77;; \\\n+\t  *) rm -f $(prefix)/lang-f77;; \\\n \tesac\n-\tif [ -f lang-f77 -a -f f/g77.info ] ; then \\\n+\tif [ -f $(prefix)/lang-f77 -a -f f/g77.info ] ; then \\\n \t  rm -f $(infodir)/g77.info*; \\\n \t  for f in f/g77.info*; do \\\n \t      realfile=`echo $$f | sed -e 's|.*/\\([^/]*\\)$$|\\1|'`; \\\n \t      $(INSTALL_DATA) $$f $(infodir)/$$realfile; \\\n \t  done; \\\n \t  chmod a-x $(infodir)/g77.info*; \\\n \telse true; fi\n-\t@if [ -f lang-f77 -a -f $(srcdir)/f/g77.info ] ; then \\\n+\t@if [ -f $(prefix)/lang-f77 -a -f $(srcdir)/f/g77.info ] ; then \\\n \t  if $(SHELL) -c 'install-info --version | sed 1q | fgrep -s -v -i debian' >/dev/null 2>&1; then \\\n \t    echo \" install-info --info-dir=$(infodir) $(infodir)/g77.info\"; \\\n \t    install-info --info-dir=$(infodir) $(infodir)/g77.info || : ; \\\n \t  else : ; fi; \\\n \telse : ; fi\n+\trm -f $(prefix)/lang-f77\n \n f77.install-man: $(srcdir)/f/g77.1\n \tcase \"$(LANGUAGES)\" in \\\n-\t  *[fF]77*) touch lang-f77;; \\\n-\t  *) rm -f lang-f77;; \\\n+\t  *[fF]77*) touch $(prefix)/lang-f77;; \\\n+\t  *) rm -f $(prefix)/lang-f77;; \\\n \tesac\n-\t-if [ -f lang-f77 -a -f f771$(exeext) ] ; then \\\n+\t-if [ -f $(prefix)/lang-f77 -a -f f771$(exeext) ] ; then \\\n \t  if [ -f g77-cross$(exeext) ] ; then \\\n \t    rm -f $(man1dir)/$(G77_CROSS_NAME)$(manext); \\\n \t    $(INSTALL_DATA) $(srcdir)/f/g77.1 $(man1dir)/$(G77_CROSS_NAME)$(manext); \\\n@@ -393,25 +395,27 @@ f77.install-man: $(srcdir)/f/g77.1\n \t    chmod a-x $(man1dir)/$(G77_INSTALL_NAME)$(manext); \\\n \t  fi; \\\n \telse true; fi\n+\trm -f $(prefix)/lang-f77\n \n f77.uninstall:\n \tcase \"$(LANGUAGES)\" in \\\n-\t  *[fF]77*) touch lang-f77;; \\\n-\t  *) rm -f lang-f77;; \\\n+\t  *[fF]77*) touch $(prefix)/lang-f77;; \\\n+\t  *) rm -f $(prefix)/lang-f77;; \\\n \tesac\n-\t@if [ -f lang-f77 ] ; then \\\n+\t@if [ -f $(prefix)/lang-f77 ] ; then \\\n \t  if $(SHELL) -c 'install-info --version | sed 1q | fgrep -s -v -i debian' >/dev/null 2>&1; then \\\n \t    echo \" install-info --delete --info-dir=$(infodir) $(infodir)/g77.info\"; \\\n \t    install-info --delete --info-dir=$(infodir) $(infodir)/g77.info || : ; \\\n \t  else : ; fi; \\\n \telse : ; fi\n-\t-if [ -f lang-f77 ]; then \\\n+\t-if [ -f $(prefix)/lang-f77 ]; then \\\n \t  rm -rf $(bindir)/$(G77_INSTALL_NAME)$(exeext); \\\n \t  rm -rf $(bindir)/$(G77_CROSS_NAME)$(exeext); \\\n \t  rm -rf $(man1dir)/$(G77_INSTALL_NAME)$(manext); \\\n \t  rm -rf $(man1dir)/$(G77_CROSS_NAME)$(manext); \\\n \t  rm -rf $(infodir)/g77.info*; \\\n \tfi\n+\trm -f $(prefix)/lang-f77\n #\f\n # Clean hooks:\n # A lot of the ancillary files are deleted by the main makefile."}]}