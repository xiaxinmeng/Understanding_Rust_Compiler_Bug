{"sha": "497716fecf8c610d672576c71ca435e804f04f4a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDk3NzE2ZmVjZjhjNjEwZDY3MjU3NmM3MWNhNDM1ZTgwNGYwNGY0YQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-01-21T16:24:37Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-01-21T16:24:37Z"}, "message": "[multiple changes]\n\n2014-01-21  Hristian Kirtchev  <kirtchev@adacore.com>\n\n\t* sem_prag.adb (Analyze_External_Property): Add processing for \"others\".\n\t(Analyze_Pragma): Update the grammar of pragma Abstract_State to\n\tinclude \"others\".\n\n2014-01-21  Arnaud Charlet  <charlet@adacore.com>\n\n\t* gnat_ugn.texi: Minor updates.\n\nFrom-SVN: r206889", "tree": {"sha": "f97aa947f39162939211a085f99744aaaf9cde5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f97aa947f39162939211a085f99744aaaf9cde5a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/497716fecf8c610d672576c71ca435e804f04f4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/497716fecf8c610d672576c71ca435e804f04f4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/497716fecf8c610d672576c71ca435e804f04f4a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/497716fecf8c610d672576c71ca435e804f04f4a/comments", "author": null, "committer": null, "parents": [{"sha": "fb1fdf7d6bbcb4728c13d14987acfa97b1cda03d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb1fdf7d6bbcb4728c13d14987acfa97b1cda03d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb1fdf7d6bbcb4728c13d14987acfa97b1cda03d"}], "stats": {"total": 124, "additions": 95, "deletions": 29}, "files": [{"sha": "19a390e0047afb978a83bd30f0b4bb1de48866b9", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497716fecf8c610d672576c71ca435e804f04f4a/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497716fecf8c610d672576c71ca435e804f04f4a/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=497716fecf8c610d672576c71ca435e804f04f4a", "patch": "@@ -1,3 +1,13 @@\n+2014-01-21  Hristian Kirtchev  <kirtchev@adacore.com>\n+\n+\t* sem_prag.adb (Analyze_External_Property): Add processing for \"others\".\n+\t(Analyze_Pragma): Update the grammar of pragma Abstract_State to\n+\tinclude \"others\".\n+\n+2014-01-21  Arnaud Charlet  <charlet@adacore.com>\n+\n+\t* gnat_ugn.texi: Minor updates.\n+\n 2014-01-21  Thomas Quinot  <quinot@adacore.com>\n \n \t* exp_pakd.adb: Update comment, minor reformatting."}, {"sha": "b8cc039868c172cbc467a6ae0b0fefd58b6a11c2", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 13, "deletions": 6, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497716fecf8c610d672576c71ca435e804f04f4a/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497716fecf8c610d672576c71ca435e804f04f4a/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=497716fecf8c610d672576c71ca435e804f04f4a", "patch": "@@ -3571,6 +3571,13 @@ This information is used by advanced coverage tools. See unit @file{SCOs}\n in the compiler sources for details in files @file{scos.ads} and\n @file{scos.adb}.\n \n+@item -fdump-xref\n+@cindex @option{-fdump-xref} (@command{gcc})\n+Generates cross reference information in GLI files for C and C++ sources.\n+The GLI files have the same syntax as the ALI files for Ada, and can be used\n+for source navigation in IDEs and on the command line using e.g. gnatxref\n+and the @option{--ext=gli} switch.\n+\n @item -flto@r{[}=n@r{]}\n @cindex @option{-flto} (@command{gcc})\n Enables Link Time Optimization. This switch must be used in conjunction\n@@ -13177,9 +13184,9 @@ Do not look for library files in the system default directory.\n @item --ext=@var{extension}\n @cindex @option{--ext} (@command{gnatxref})\n Specify an alternate ali file extension. The default is @code{ali} and other\n-extensions (e.g. @code{sli} for SPARK library files) may be specified via this\n-switch. Note that if this switch overrides the default, which means that only\n-the new extension will be considered.\n+extensions (e.g. @code{gli} for C/C++ sources when using @option{-fdump-xref})\n+may be specified via this switch. Note that if this switch overrides the\n+default, which means that only the new extension will be considered.\n \n @item --RTS=@var{rts-path}\n @cindex @option{--RTS} (@command{gnatxref})\n@@ -13354,9 +13361,9 @@ Do not look for library files in the system default directory.\n @item --ext=@var{extension}\n @cindex @option{--ext} (@command{gnatfind})\n Specify an alternate ali file extension. The default is @code{ali} and other\n-extensions (e.g. @code{sli} for SPARK library files) may be specified via this\n-switch. Note that if this switch overrides the default, which means that only\n-the new extension will be considered.\n+extensions (e.g. @code{gli} for C/C++ sources when using @option{-fdump-xref})\n+may be specified via this switch. Note that if this switch overrides the\n+default, which means that only the new extension will be considered.\n \n @item --RTS=@var{rts-path}\n @cindex @option{--RTS} (@command{gnatfind})"}, {"sha": "043dc4e0c8bd54d5775154be2fdd52537a88e8cc", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 72, "deletions": 23, "changes": 95, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497716fecf8c610d672576c71ca435e804f04f4a/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497716fecf8c610d672576c71ca435e804f04f4a/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=497716fecf8c610d672576c71ca435e804f04f4a", "patch": "@@ -9487,12 +9487,12 @@ package body Sem_Prag is\n          --  pragma Abstract_State (ABSTRACT_STATE_LIST)\n \n          --  ABSTRACT_STATE_LIST ::=\n-         --    null\n-         --  | STATE_NAME_WITH_OPTIONS\n+         --     null\n+         --  |  STATE_NAME_WITH_OPTIONS\n          --  | (STATE_NAME_WITH_OPTIONS {, STATE_NAME_WITH_OPTIONS} )\n \n          --  STATE_NAME_WITH_OPTIONS ::=\n-         --    STATE_NAME\n+         --     STATE_NAME\n          --  | (STATE_NAME with OPTION_LIST)\n \n          --  OPTION_LIST ::= OPTION {, OPTION}\n@@ -9508,14 +9508,15 @@ package body Sem_Prag is\n          --  | External [=> EXTERNAL_PROPERTY_LIST]\n \n          --  EXTERNAL_PROPERTY_LIST ::=\n-         --    EXTERNAL_PROPERTY\n+         --     EXTERNAL_PROPERTY\n          --  | (EXTERNAL_PROPERTY {, EXTERNAL_PROPERTY} )\n \n          --  EXTERNAL_PROPERTY ::=\n          --    Async_Readers    [=> boolean_EXPRESSION]\n          --  | Async_Writers    [=> boolean_EXPRESSION]\n          --  | Effective_Reads  [=> boolean_EXPRESSION]\n          --  | Effective_Writes [=> boolean_EXPRESSION]\n+         --    others            => boolean_EXPRESSION\n \n          --  STATE_NAME ::= defining_identifier\n \n@@ -9549,6 +9550,7 @@ package body Sem_Prag is\n                ER_Seen       : Boolean := False;\n                EW_Seen       : Boolean := False;\n                External_Seen : Boolean := False;\n+               Others_Seen   : Boolean := False;\n                Part_Of_Seen  : Boolean := False;\n \n                --  Flags used to store the static value of all external states'\n@@ -9660,15 +9662,36 @@ package body Sem_Prag is\n                   Expr_Val : Boolean;\n \n                begin\n-                  --  The external property must be one of the predefined four\n-                  --  reader/writer choices.\n-\n-                  if Nkind (Prop) /= N_Identifier\n-                    or else not Nam_In (Chars (Prop), Name_Async_Readers,\n-                                                      Name_Async_Writers,\n-                                                      Name_Effective_Reads,\n-                                                      Name_Effective_Writes)\n+                  --  Check the placement of \"others\" (if available)\n+\n+                  if Nkind (Prop) = N_Others_Choice then\n+                     if Others_Seen then\n+                        Error_Msg_N\n+                          (\"only one others choice allowed in option External\",\n+                           Prop);\n+                     else\n+                        Others_Seen := True;\n+                     end if;\n+\n+                  elsif Others_Seen then\n+                     Error_Msg_N\n+                       (\"others must be the last property in option External\",\n+                        Prop);\n+\n+                  --  The only remaining legal options are the four predefined\n+                  --  external properties.\n+\n+                  elsif Nkind (Prop) = N_Identifier\n+                    and then Nam_In (Chars (Prop), Name_Async_Readers,\n+                                                   Name_Async_Writers,\n+                                                   Name_Effective_Reads,\n+                                                   Name_Effective_Writes)\n                   then\n+                     null;\n+\n+                  --  Otherwise the construct is not a valid property\n+\n+                  else\n                      Error_Msg_N (\"invalid external state property\", Prop);\n                      return;\n                   end if;\n@@ -9693,21 +9716,47 @@ package body Sem_Prag is\n                      Expr_Val := True;\n                   end if;\n \n-                  if Chars (Prop) = Name_Async_Readers then\n-                     Check_Duplicate_Option (Prop, AR_Seen);\n-                     AR_Val := Expr_Val;\n+                  --  Named properties\n \n-                  elsif Chars (Prop) = Name_Async_Writers then\n-                     Check_Duplicate_Option (Prop, AW_Seen);\n-                     AW_Val := Expr_Val;\n+                  if Nkind (Prop) = N_Identifier then\n+                     if Chars (Prop) = Name_Async_Readers then\n+                        Check_Duplicate_Option (Prop, AR_Seen);\n+                        AR_Val := Expr_Val;\n \n-                  elsif Chars (Prop) = Name_Effective_Reads then\n-                     Check_Duplicate_Option (Prop, ER_Seen);\n-                     ER_Val := Expr_Val;\n+                     elsif Chars (Prop) = Name_Async_Writers then\n+                        Check_Duplicate_Option (Prop, AW_Seen);\n+                        AW_Val := Expr_Val;\n+\n+                     elsif Chars (Prop) = Name_Effective_Reads then\n+                        Check_Duplicate_Option (Prop, ER_Seen);\n+                        ER_Val := Expr_Val;\n+\n+                     else\n+                        Check_Duplicate_Option (Prop, EW_Seen);\n+                        EW_Val := Expr_Val;\n+                     end if;\n+\n+                  --  The handling of property \"others\" must take into account\n+                  --  all other named properties that have been encountered so\n+                  --  far. Only those that have not been seen are affected by\n+                  --  \"others\".\n \n                   else\n-                     Check_Duplicate_Option (Prop, EW_Seen);\n-                     EW_Val := Expr_Val;\n+                     if not AR_Seen then\n+                        AR_Val := Expr_Val;\n+                     end if;\n+\n+                     if not AW_Seen then\n+                        AW_Val := Expr_Val;\n+                     end if;\n+\n+                     if not ER_Seen then\n+                        ER_Val := Expr_Val;\n+                     end if;\n+\n+                     if not EW_Seen then\n+                        EW_Val := Expr_Val;\n+                     end if;\n                   end if;\n                end Analyze_External_Property;\n "}]}