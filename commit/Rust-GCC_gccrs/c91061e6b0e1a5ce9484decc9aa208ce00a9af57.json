{"sha": "c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzkxMDYxZTZiMGUxYTVjZTk0ODRkZWNjOWFhMjA4Y2UwMGE5YWY1Nw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2013-09-02T20:17:10Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2013-09-02T20:17:10Z"}, "message": "ipa-split.c (execute_split_functions): Split externally visible functions called once.\n\n\n\t* ipa-split.c (execute_split_functions): Split externally visible\n\tfunctions called once.\n\t* gcc.dg/tree-ssa/fnsplit-1.c: New testcase.\n\nFrom-SVN: r202185", "tree": {"sha": "2a42e8797aec5db5e1df9c0cc6cd3628837a6036", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2a42e8797aec5db5e1df9c0cc6cd3628837a6036"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/comments", "author": null, "committer": null, "parents": [{"sha": "2fd0985c70240012e8b0b63a9cafe3b241dcddc9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2fd0985c70240012e8b0b63a9cafe3b241dcddc9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2fd0985c70240012e8b0b63a9cafe3b241dcddc9"}], "stats": {"total": 36, "additions": 35, "deletions": 1}, "files": [{"sha": "359b9d844d92125277459989780e9e9567646dd1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "patch": "@@ -1,3 +1,8 @@\n+2013-09-02  Jan Hubicka  <jh@suse.cz>\n+\n+\t* ipa-split.c (execute_split_functions): Split externally visible\n+\tfunctions called once.\n+\n 2013-09-02  Martin Jambor  <mjambor@suse.cz>\n \n \tPR ipa/58106"}, {"sha": "5c3ee4fa2cebc21959d0e21120e079cf490f253c", "filename": "gcc/ipa-split.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2Fipa-split.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2Fipa-split.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-split.c?ref=c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "patch": "@@ -1537,7 +1537,9 @@ execute_split_functions (void)\n      Note that we are not completely conservative about disqualifying functions\n      called once.  It is possible that the caller is called more then once and\n      then inlining would still benefit.  */\n-  if ((!node->callers || !node->callers->next_caller)\n+  if ((!node->callers\n+       /* Local functions called once will be completely inlined most of time.  */\n+       || (!node->callers->next_caller && node->local.local))\n       && !node->symbol.address_taken\n       && (!flag_lto || !node->symbol.externally_visible))\n     {"}, {"sha": "c01c48c22837e1e86e847914df95b3d85b27292b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "patch": "@@ -1,3 +1,7 @@\n+2013-09-02  Jan Hubicka  <jh@suse.cz>\n+\n+\t* gcc.dg/tree-ssa/fnsplit-1.c: New testcase.\n+\n 2013-09-02  Martin Jambor  <mjambor@suse.cz>\n \n \tPR ipa/58106"}, {"sha": "0c81d92bfa97912fb32099ffdea424c59fb703dc", "filename": "gcc/testsuite/gcc.dg/tree-ssa/fnsplit-1.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ffnsplit-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c91061e6b0e1a5ce9484decc9aa208ce00a9af57/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ffnsplit-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Ffnsplit-1.c?ref=c91061e6b0e1a5ce9484decc9aa208ce00a9af57", "patch": "@@ -0,0 +1,23 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-fnsplit\" } */\n+#include <stdio.h>\n+int a[1000];\n+\n+void\n+t(int a)\n+{\n+  if (a)\n+    printf (\"I Am Completely Operational,\"),\n+    printf (\"And All My Circuits Are Functioning Perfectly\\n\");\n+}\n+int\n+main(void)\n+{\n+  int i;\n+  for (i = 0; i < 1000; i++)\n+    t(a[i]);\n+  return 0;\n+}\n+/* { dg-final { scan-tree-dump-times \"Splitting function at:\" 1 \"fnsplit\"} } */\n+\n+/* { dg-final { cleanup-tree-dump \"fnsplit\" } } */"}]}