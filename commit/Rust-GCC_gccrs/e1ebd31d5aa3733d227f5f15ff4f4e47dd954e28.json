{"sha": "e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTFlYmQzMWQ1YWEzNzMzZDIyN2Y1ZjE1ZmY0ZjRlNDdkZDk1NGUyOA==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2016-06-24T13:37:06Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2016-06-24T13:37:06Z"}, "message": "configure.ac (HAVE_AS_GOTOF_IN_DATA): Use $as_ix86_gas_32_opt to assemble for 32bit target.\n\n\t* configure.ac (HAVE_AS_GOTOF_IN_DATA): Use $as_ix86_gas_32_opt to\n\tassemble for 32bit target.\n\t(HAVE_AS_IX86_TLSGDPLT): Use $as_ix86_gas_32_opt to assemble\n\tand $ld_ix86_gld_32_opt to link for 32bit target.\n\t(HAVE_AS_IX86_TLSLDMPLT): Ditto.\n\t* configure: Regenerate.\n\nFrom-SVN: r237758", "tree": {"sha": "502e7aef56296ce08c11c76505416da539b75271", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/502e7aef56296ce08c11c76505416da539b75271"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "68a8632380e3606aeea2eb11921461e24926dddc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68a8632380e3606aeea2eb11921461e24926dddc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68a8632380e3606aeea2eb11921461e24926dddc"}], "stats": {"total": 193, "additions": 99, "deletions": 94}, "files": [{"sha": "01c7807e873540ff84872e31b5d37fe136accb73", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28", "patch": "@@ -1,3 +1,12 @@\n+2016-06-24  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\t* configure.ac (HAVE_AS_GOTOF_IN_DATA): Use $as_ix86_gas_32_opt to\n+\tassemble for 32bit target.\n+\t(HAVE_AS_IX86_TLSGDPLT): Use $as_ix86_gas_32_opt to assemble\n+\tand $ld_ix86_gld_32_opt to link for 32bit target.\n+\t(HAVE_AS_IX86_TLSLDMPLT): Ditto.\n+\t* configure: Regenerate.\n+\n 2016-06-24  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* config/arm/arm.c (int_log2): Delete definition and prototype."}, {"sha": "9fec1cc89026111d75597cc73f697cf4c1d8bd95", "filename": "gcc/configure", "status": "modified", "additions": 58, "deletions": 61, "changes": 119, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28", "patch": "@@ -25707,52 +25707,6 @@ $as_echo \"#define HAVE_AS_IX86_DIFF_SECT_DELTA 1\" >>confdefs.h\n \n fi\n \n-    # These two are used unconditionally by i386.[ch]; it is to be defined\n-    # to 1 if the feature is present, 0 otherwise.\n-    as_ix86_gotoff_in_data_opt=\n-    if test x$gas = xyes; then\n-      as_ix86_gotoff_in_data_opt=\"--32\"\n-    fi\n-    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking assembler for GOTOFF in data\" >&5\n-$as_echo_n \"checking assembler for GOTOFF in data... \" >&6; }\n-if test \"${gcc_cv_as_ix86_gotoff_in_data+set}\" = set; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  gcc_cv_as_ix86_gotoff_in_data=no\n-    if test $in_tree_gas = yes; then\n-    if test $gcc_cv_gas_vers -ge `expr \\( \\( 2 \\* 1000 \\) + 11 \\) \\* 1000 + 0`\n-  then gcc_cv_as_ix86_gotoff_in_data=yes\n-fi\n-  elif test x$gcc_cv_as != x; then\n-    $as_echo '\t.text\n-.L0:\n-\tnop\n-\t.data\n-\t.long .L0@GOTOFF' > conftest.s\n-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags $as_ix86_gotoff_in_data_opt -o conftest.o conftest.s >&5'\n-  { { eval echo \"\\\"\\$as_me\\\":${as_lineno-$LINENO}: \\\"$ac_try\\\"\"; } >&5\n-  (eval $ac_try) 2>&5\n-  ac_status=$?\n-  $as_echo \"$as_me:${as_lineno-$LINENO}: \\$? = $ac_status\" >&5\n-  test $ac_status = 0; }; }\n-    then\n-\tgcc_cv_as_ix86_gotoff_in_data=yes\n-    else\n-      echo \"configure: failed program was\" >&5\n-      cat conftest.s >&5\n-    fi\n-    rm -f conftest.o conftest.s\n-  fi\n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gcc_cv_as_ix86_gotoff_in_data\" >&5\n-$as_echo \"$gcc_cv_as_ix86_gotoff_in_data\" >&6; }\n-\n-\n-cat >>confdefs.h <<_ACEOF\n-#define HAVE_AS_GOTOFF_IN_DATA `if test $gcc_cv_as_ix86_gotoff_in_data = yes; then echo 1; else echo 0; fi`\n-_ACEOF\n-\n-\n     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking assembler for rep and lock prefix\" >&5\n $as_echo_n \"checking assembler for rep and lock prefix... \" >&6; }\n if test \"${gcc_cv_as_ix86_rep_lock_prefix+set}\" = set; then :\n@@ -25821,6 +25775,18 @@ $as_echo \"#define HAVE_AS_IX86_UD2 1\" >>confdefs.h\n \n fi\n \n+    # Enforce 32-bit output with gas and gld.\n+    if test x$gas = xyes; then\n+      as_ix86_gas_32_opt=\"--32\"\n+    fi\n+    if echo \"$ld_ver\" | grep GNU > /dev/null; then\n+      if $gcc_cv_ld -V 2>/dev/null | grep elf_i386_sol2 > /dev/null; then\n+        ld_ix86_gld_32_opt=\"-melf_i386_sol2\"\n+      else\n+        ld_ix86_gld_32_opt=\"-melf_i386\"\n+      fi\n+    fi\n+\n     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking assembler for R_386_TLS_GD_PLT reloc\" >&5\n $as_echo_n \"checking assembler for R_386_TLS_GD_PLT reloc... \" >&6; }\n if test \"${gcc_cv_as_ix86_tlsgdplt+set}\" = set; then :\n@@ -25829,15 +25795,15 @@ else\n   gcc_cv_as_ix86_tlsgdplt=no\n   if test x$gcc_cv_as != x; then\n     $as_echo 'call    tls_gd@tlsgdplt' > conftest.s\n-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags  -o conftest.o conftest.s >&5'\n+    if { ac_try='$gcc_cv_as $gcc_cv_as_flags $as_ix86_gas_32_opt -o conftest.o conftest.s >&5'\n   { { eval echo \"\\\"\\$as_me\\\":${as_lineno-$LINENO}: \\\"$ac_try\\\"\"; } >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   $as_echo \"$as_me:${as_lineno-$LINENO}: \\$? = $ac_status\" >&5\n   test $ac_status = 0; }; }\n     then\n \tif test x$gcc_cv_ld != x \\\n-\t && $gcc_cv_ld -o conftest conftest.o -G > /dev/null 2>&1; then\n+\t && $gcc_cv_ld $ld_ix86_gld_32_opt -o conftest conftest.o -G > /dev/null 2>&1; then\n \t   gcc_cv_as_ix86_tlsgdplt=yes\n \t fi\n \t rm -f conftest\n@@ -25861,6 +25827,7 @@ fi\n tls_ld:\n \t.section .text,\"ax\",@progbits\n \t call    tls_ld@tlsldmplt'\n+\n     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking assembler for R_386_TLS_LDM_PLT reloc\" >&5\n $as_echo_n \"checking assembler for R_386_TLS_LDM_PLT reloc... \" >&6; }\n if test \"${gcc_cv_as_ix86_tlsldmplt+set}\" = set; then :\n@@ -25869,15 +25836,15 @@ else\n   gcc_cv_as_ix86_tlsldmplt=no\n   if test x$gcc_cv_as != x; then\n     $as_echo \"$conftest_s\" > conftest.s\n-    if { ac_try='$gcc_cv_as $gcc_cv_as_flags  -o conftest.o conftest.s >&5'\n+    if { ac_try='$gcc_cv_as $gcc_cv_as_flags $as_ix86_gas_32_opt -o conftest.o conftest.s >&5'\n   { { eval echo \"\\\"\\$as_me\\\":${as_lineno-$LINENO}: \\\"$ac_try\\\"\"; } >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n   $as_echo \"$as_me:${as_lineno-$LINENO}: \\$? = $ac_status\" >&5\n   test $ac_status = 0; }; }\n     then\n \tif test x$gcc_cv_ld != x \\\n-\t && $gcc_cv_ld -o conftest conftest.o -G > /dev/null 2>&1; then\n+\t && $gcc_cv_ld $ld_ix86_gld_32_opt -o conftest conftest.o -G > /dev/null 2>&1; then\n \t   gcc_cv_as_ix86_tlsldmplt=yes\n \t fi\n \t rm -f conftest\n@@ -25897,17 +25864,6 @@ cat >>confdefs.h <<_ACEOF\n _ACEOF\n \n \n-    # Enforce 32-bit output with gas and gld.\n-    if test x$gas = xyes; then\n-      as_ix86_gas_32_opt=\"--32\"\n-    fi\n-    if echo \"$ld_ver\" | grep GNU > /dev/null; then\n-      if $gcc_cv_ld -V 2>/dev/null | grep elf_i386_sol2 > /dev/null; then\n-        ld_ix86_gld_32_opt=\"-melf_i386_sol2\"\n-      else\n-        ld_ix86_gld_32_opt=\"-melf_i386\"\n-      fi\n-    fi\n     conftest_s='\n \t.section .text,\"ax\",@progbits\n         .globl  _start\n@@ -26010,6 +25966,47 @@ cat >>confdefs.h <<_ACEOF\n #define HAVE_AS_IX86_GOT32X `if test x\"$gcc_cv_as_ix86_got32x\" = xyes; then echo 1; else echo 0; fi`\n _ACEOF\n \n+\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking assembler for GOTOFF in data\" >&5\n+$as_echo_n \"checking assembler for GOTOFF in data... \" >&6; }\n+if test \"${gcc_cv_as_ix86_gotoff_in_data+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  gcc_cv_as_ix86_gotoff_in_data=no\n+    if test $in_tree_gas = yes; then\n+    if test $gcc_cv_gas_vers -ge `expr \\( \\( 2 \\* 1000 \\) + 11 \\) \\* 1000 + 0`\n+  then gcc_cv_as_ix86_gotoff_in_data=yes\n+fi\n+  elif test x$gcc_cv_as != x; then\n+    $as_echo '\t.text\n+.L0:\n+\tnop\n+\t.data\n+\t.long .L0@GOTOFF' > conftest.s\n+    if { ac_try='$gcc_cv_as $gcc_cv_as_flags $as_ix86_gas_32_opt -o conftest.o conftest.s >&5'\n+  { { eval echo \"\\\"\\$as_me\\\":${as_lineno-$LINENO}: \\\"$ac_try\\\"\"; } >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  $as_echo \"$as_me:${as_lineno-$LINENO}: \\$? = $ac_status\" >&5\n+  test $ac_status = 0; }; }\n+    then\n+\tgcc_cv_as_ix86_gotoff_in_data=yes\n+    else\n+      echo \"configure: failed program was\" >&5\n+      cat conftest.s >&5\n+    fi\n+    rm -f conftest.o conftest.s\n+  fi\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gcc_cv_as_ix86_gotoff_in_data\" >&5\n+$as_echo \"$gcc_cv_as_ix86_gotoff_in_data\" >&6; }\n+\n+\n+cat >>confdefs.h <<_ACEOF\n+#define HAVE_AS_GOTOFF_IN_DATA `if test $gcc_cv_as_ix86_gotoff_in_data = yes; then echo 1; else echo 0; fi`\n+_ACEOF\n+\n+\n     ;;\n \n   ia64*-*-*)"}, {"sha": "dd5c3d276f4443c23bf6b9b7197211910601e7b9", "filename": "gcc/configure.ac", "status": "modified", "additions": 32, "deletions": 33, "changes": 65, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=e1ebd31d5aa3733d227f5f15ff4f4e47dd954e28", "patch": "@@ -4098,24 +4098,6 @@ foo:\tnop\n       [AC_DEFINE(HAVE_AS_IX86_DIFF_SECT_DELTA, 1,\n         [Define if your assembler supports the subtraction of symbols in different sections.])])\n \n-    # These two are used unconditionally by i386.[ch]; it is to be defined\n-    # to 1 if the feature is present, 0 otherwise.\n-    as_ix86_gotoff_in_data_opt=\n-    if test x$gas = xyes; then\n-      as_ix86_gotoff_in_data_opt=\"--32\"\n-    fi\n-    gcc_GAS_CHECK_FEATURE([GOTOFF in data],\n-      gcc_cv_as_ix86_gotoff_in_data, [2,11,0],\n-      [$as_ix86_gotoff_in_data_opt],\n-[\t.text\n-.L0:\n-\tnop\n-\t.data\n-\t.long .L0@GOTOFF])\n-    AC_DEFINE_UNQUOTED(HAVE_AS_GOTOFF_IN_DATA,\n-      [`if test $gcc_cv_as_ix86_gotoff_in_data = yes; then echo 1; else echo 0; fi`],\n-      [Define true if the assembler supports '.long foo@GOTOFF'.])\n-\n     gcc_GAS_CHECK_FEATURE([rep and lock prefix],\n         gcc_cv_as_ix86_rep_lock_prefix,,,\n \t[rep movsl\n@@ -4134,11 +4116,24 @@ foo:\tnop\n       [AC_DEFINE(HAVE_AS_IX86_UD2, 1,\n \t[Define if your assembler supports the 'ud2' mnemonic.])])\n \n+    # Enforce 32-bit output with gas and gld.\n+    if test x$gas = xyes; then\n+      as_ix86_gas_32_opt=\"--32\"\n+    fi\n+    if echo \"$ld_ver\" | grep GNU > /dev/null; then\n+      if $gcc_cv_ld -V 2>/dev/null | grep elf_i386_sol2 > /dev/null; then\n+        ld_ix86_gld_32_opt=\"-melf_i386_sol2\"\n+      else\n+        ld_ix86_gld_32_opt=\"-melf_i386\"\n+      fi\n+    fi\n+\n     gcc_GAS_CHECK_FEATURE([R_386_TLS_GD_PLT reloc],\n-        gcc_cv_as_ix86_tlsgdplt,,,\n+        gcc_cv_as_ix86_tlsgdplt,,\n+\t[$as_ix86_gas_32_opt],\n \t[call    tls_gd@tlsgdplt],\n \t[if test x$gcc_cv_ld != x \\\n-\t && $gcc_cv_ld -o conftest conftest.o -G > /dev/null 2>&1; then\n+\t && $gcc_cv_ld $ld_ix86_gld_32_opt -o conftest conftest.o -G > /dev/null 2>&1; then\n \t   gcc_cv_as_ix86_tlsgdplt=yes\n \t fi\n \t rm -f conftest],\n@@ -4150,29 +4145,20 @@ foo:\tnop\n tls_ld:\n \t.section .text,\"ax\",@progbits\n \t call    tls_ld@tlsldmplt'\n+\n     gcc_GAS_CHECK_FEATURE([R_386_TLS_LDM_PLT reloc],\n-        gcc_cv_as_ix86_tlsldmplt,,,\n+        gcc_cv_as_ix86_tlsldmplt,,\n+\t[$as_ix86_gas_32_opt],\n \t[$conftest_s],\n \t[if test x$gcc_cv_ld != x \\\n-\t && $gcc_cv_ld -o conftest conftest.o -G > /dev/null 2>&1; then\n+\t && $gcc_cv_ld $ld_ix86_gld_32_opt -o conftest conftest.o -G > /dev/null 2>&1; then\n \t   gcc_cv_as_ix86_tlsldmplt=yes\n \t fi\n \t rm -f conftest])\n     AC_DEFINE_UNQUOTED(HAVE_AS_IX86_TLSLDMPLT,\n       [`if test $gcc_cv_as_ix86_tlsldmplt = yes; then echo 1; else echo 0; fi`],\n       [Define to 1 if your assembler and linker support @tlsldmplt.])\n \n-    # Enforce 32-bit output with gas and gld.\n-    if test x$gas = xyes; then\n-      as_ix86_gas_32_opt=\"--32\"\n-    fi\n-    if echo \"$ld_ver\" | grep GNU > /dev/null; then\n-      if $gcc_cv_ld -V 2>/dev/null | grep elf_i386_sol2 > /dev/null; then\n-        ld_ix86_gld_32_opt=\"-melf_i386_sol2\"\n-      else\n-        ld_ix86_gld_32_opt=\"-melf_i386\"\n-      fi\n-    fi\n     conftest_s='\n \t.section .text,\"ax\",@progbits\n         .globl  _start\n@@ -4229,6 +4215,19 @@ _start:\n     AC_DEFINE_UNQUOTED(HAVE_AS_IX86_GOT32X,\n       [`if test x\"$gcc_cv_as_ix86_got32x\" = xyes; then echo 1; else echo 0; fi`],\n       [Define 0/1 if your assembler and linker support @GOT.])\n+\n+    gcc_GAS_CHECK_FEATURE([GOTOFF in data],\n+      gcc_cv_as_ix86_gotoff_in_data, [2,11,0],\n+      [$as_ix86_gas_32_opt],\n+[\t.text\n+.L0:\n+\tnop\n+\t.data\n+\t.long .L0@GOTOFF])\n+    AC_DEFINE_UNQUOTED(HAVE_AS_GOTOFF_IN_DATA,\n+      [`if test $gcc_cv_as_ix86_gotoff_in_data = yes; then echo 1; else echo 0; fi`],\n+      [Define true if the assembler supports '.long foo@GOTOFF'.])\n+\n     ;;\n \n   ia64*-*-*)"}]}