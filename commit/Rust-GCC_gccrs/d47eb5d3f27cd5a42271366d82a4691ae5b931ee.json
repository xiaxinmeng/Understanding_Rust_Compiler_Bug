{"sha": "d47eb5d3f27cd5a42271366d82a4691ae5b931ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDQ3ZWI1ZDNmMjdjZDVhNDIyNzEzNjZkODJhNDY5MWFlNWI5MzFlZQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2001-12-21T21:59:27Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-12-21T21:59:27Z"}, "message": "re PR java/5165 (Loading class fields with a ConstantValue attribute)\n\n\tFix for PR java/5165:\n\t* java/lang/natClassLoader.cc (_Jv_PrepareCompiledClass):\n\tConvert any constant string field to a String; not just final\n\tfields.\n\nFrom-SVN: r48255", "tree": {"sha": "54f9b84c2732cc330a0ac803e8b772e9bf190d7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/54f9b84c2732cc330a0ac803e8b772e9bf190d7d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d47eb5d3f27cd5a42271366d82a4691ae5b931ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d47eb5d3f27cd5a42271366d82a4691ae5b931ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d47eb5d3f27cd5a42271366d82a4691ae5b931ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d47eb5d3f27cd5a42271366d82a4691ae5b931ee/comments", "author": null, "committer": null, "parents": [{"sha": "655781b7af994b586ae96c191d4ae2d3c2c33822", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/655781b7af994b586ae96c191d4ae2d3c2c33822", "html_url": "https://github.com/Rust-GCC/gccrs/commit/655781b7af994b586ae96c191d4ae2d3c2c33822"}], "stats": {"total": 13, "additions": 8, "deletions": 5}, "files": [{"sha": "b4daf82ee9c9827c29e00515b37c27f2e5e92dcf", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d47eb5d3f27cd5a42271366d82a4691ae5b931ee/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d47eb5d3f27cd5a42271366d82a4691ae5b931ee/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=d47eb5d3f27cd5a42271366d82a4691ae5b931ee", "patch": "@@ -1,5 +1,10 @@\n 2001-12-21  Tom Tromey  <tromey@redhat.com>\n \n+\tFix for PR java/5165:\n+\t* java/lang/natClassLoader.cc (_Jv_PrepareCompiledClass):\n+\tConvert any constant string field to a String; not just final\n+\tfields.\n+\n \tFix for PR libgcj/2428:\n \t* java/lang/natClass.cc: Include RuntimePermission.h.\n \t(getClassLoader): Define."}, {"sha": "75d9e32ff2e542b8245cab988c40e46d51a36d6f", "filename": "libjava/java/lang/natClassLoader.cc", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d47eb5d3f27cd5a42271366d82a4691ae5b931ee/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d47eb5d3f27cd5a42271366d82a4691ae5b931ee/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatClassLoader.cc?ref=d47eb5d3f27cd5a42271366d82a4691ae5b931ee", "patch": "@@ -292,12 +292,10 @@ _Jv_PrepareCompiledClass (jclass klass)\n       for (int n = JvNumStaticFields (klass); n > 0; --n)\n \t{\n \t  int mod = f->getModifiers ();\n-\t  // Maybe the compiler should mark these with\n-\t  // _Jv_FIELD_CONSTANT_VALUE?  For now we just know that this\n-\t  // only happens for constant strings.\n+\t  // If we have a static String field with a non-null initial\n+\t  // value, we know it points to a Utf8Const.\n \t  if (f->getClass () == &StringClass\n-\t      && java::lang::reflect::Modifier::isStatic (mod)\n-\t      && java::lang::reflect::Modifier::isFinal (mod))\n+\t      && java::lang::reflect::Modifier::isStatic (mod))\n \t    {\n \t      jstring *strp = (jstring *) f->u.addr;\n \t      if (*strp)"}]}