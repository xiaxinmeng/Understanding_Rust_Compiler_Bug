{"sha": "50b99cc8fe032c1631c99f9f1ccda990d717d63b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTBiOTljYzhmZTAzMmMxNjMxYzk5ZjlmMWNjZGE5OTBkNzE3ZDYzYg==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@cygnus.com", "date": "2000-04-12T20:45:59Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2000-04-12T20:45:59Z"}, "message": "natString.cc (unintern): Added `obj' argument.\n\n\t* java/lang/natString.cc (unintern): Added `obj' argument.\n\t(intern): Register finalizer for string.\n\t* java/lang/String.java (unintern): Now static; added obj\n\targument.\n\nFrom-SVN: r33124", "tree": {"sha": "2ac625d7c625346436407d047780b41336a326c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2ac625d7c625346436407d047780b41336a326c8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/50b99cc8fe032c1631c99f9f1ccda990d717d63b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50b99cc8fe032c1631c99f9f1ccda990d717d63b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/50b99cc8fe032c1631c99f9f1ccda990d717d63b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50b99cc8fe032c1631c99f9f1ccda990d717d63b/comments", "author": null, "committer": null, "parents": [{"sha": "07385c4994a45ba1781fb91e0585da3a0628e14d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07385c4994a45ba1781fb91e0585da3a0628e14d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07385c4994a45ba1781fb91e0585da3a0628e14d"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "19d074a5707df4ed13b5ce23e20025ebf0ec6701", "filename": "libjava/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/50b99cc8fe032c1631c99f9f1ccda990d717d63b/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/50b99cc8fe032c1631c99f9f1ccda990d717d63b/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=50b99cc8fe032c1631c99f9f1ccda990d717d63b", "patch": "@@ -1,3 +1,10 @@\n+2000-04-12  Tom Tromey  <tromey@cygnus.com>\n+\n+\t* java/lang/natString.cc (unintern): Added `obj' argument.\n+\t(intern): Register finalizer for string.\n+\t* java/lang/String.java (unintern): Now static; added obj\n+\targument.\n+\n 2000-04-11  Tom Tromey  <tromey@cygnus.com>\n \n \t* java/util/Vector.java (VectorEnumeration): Now `final'."}, {"sha": "272f3e29a4dafe98d60ab33c11c05109dbbe12bb", "filename": "libjava/java/lang/String.java", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/50b99cc8fe032c1631c99f9f1ccda990d717d63b/libjava%2Fjava%2Flang%2FString.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/50b99cc8fe032c1631c99f9f1ccda990d717d63b/libjava%2Fjava%2Flang%2FString.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FString.java?ref=50b99cc8fe032c1631c99f9f1ccda990d717d63b", "patch": "@@ -1,4 +1,4 @@\n-/* Copyright (C) 1998, 1999  Free Software Foundation\n+/* Copyright (C) 1998, 1999, 2000  Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -302,6 +302,6 @@ private native void init (char[] chars, int offset, int count,\n   private native void init (byte[] chars, int hibyte, int offset, int count);\n   private native void init (byte[] chars, int offset, int count, String enc)\n     throws UnsupportedEncodingException;\n-  private native void unintern ();\n+  private static native void unintern (Object obj);\n   private static native void rehash ();\n }"}, {"sha": "175d8eb5a1bea185213f534fd085395465217a95", "filename": "libjava/java/lang/natString.cc", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/50b99cc8fe032c1631c99f9f1ccda990d717d63b/libjava%2Fjava%2Flang%2FnatString.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/50b99cc8fe032c1631c99f9f1ccda990d717d63b/libjava%2Fjava%2Flang%2FnatString.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatString.cc?ref=50b99cc8fe032c1631c99f9f1ccda990d717d63b", "patch": "@@ -1,6 +1,6 @@\n // natString.cc - Implementation of java.lang.String native methods.\n \n-/* Copyright (C) 1998, 1999  Free Software Foundation\n+/* Copyright (C) 1998, 1999, 2000  Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -153,15 +153,18 @@ java::lang::String::intern()\n   SET_STRING_IS_INTERNED(this);\n   strhash_count++;\n   *ptr = this;\n+  // When string is GC'd, clear the slot in the hash table.\n+  _Jv_RegisterFinalizer ((void *) this, unintern);\n   return this;\n }\n \n /* Called by String fake finalizer. */\n void\n-java::lang::String::unintern()\n+java::lang::String::unintern (jobject obj)\n {\n   JvSynchronize sync (&StringClass);\n-  jstring* ptr = _Jv_StringGetSlot(this);\n+  jstring str = reinterpret_cast<jstring> (obj);\n+  jstring* ptr = _Jv_StringGetSlot(str);\n   if (*ptr == NULL || *ptr == DELETED_STRING)\n     return;\n   *ptr = DELETED_STRING;"}]}