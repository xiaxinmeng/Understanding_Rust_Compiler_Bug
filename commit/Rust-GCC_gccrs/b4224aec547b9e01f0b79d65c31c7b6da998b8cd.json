{"sha": "b4224aec547b9e01f0b79d65c31c7b6da998b8cd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjQyMjRhZWM1NDdiOWUwMWYwYjc5ZDY1YzMxYzdiNmRhOTk4YjhjZA==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2011-05-14T06:35:18Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2011-05-14T06:35:18Z"}, "message": "re PR libfortran/48961 (EXECUTE_COMMAND_LINE(WAIT=.false.) fails on MinGW)\n\n2011-05-14  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/48961\n        * intrinsics/execute_command_line.c (set_cmdstat): Don't abort if\n        synchronously executing with WAIT=.false.\n        (execute_command_line): Fix setting of cmdstat and exitstat.\n\nFrom-SVN: r173748", "tree": {"sha": "81bdaf969181cf13f0189259f9ec948ad548a711", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/81bdaf969181cf13f0189259f9ec948ad548a711"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b4224aec547b9e01f0b79d65c31c7b6da998b8cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b4224aec547b9e01f0b79d65c31c7b6da998b8cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b4224aec547b9e01f0b79d65c31c7b6da998b8cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b4224aec547b9e01f0b79d65c31c7b6da998b8cd/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2d9d4585c67d8e6f6e5ea0beffa85871999dbbb3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d9d4585c67d8e6f6e5ea0beffa85871999dbbb3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d9d4585c67d8e6f6e5ea0beffa85871999dbbb3"}], "stats": {"total": 32, "additions": 22, "deletions": 10}, "files": [{"sha": "ab952172f765fd45b517c81293157bf742aa9c57", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b4224aec547b9e01f0b79d65c31c7b6da998b8cd/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b4224aec547b9e01f0b79d65c31c7b6da998b8cd/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=b4224aec547b9e01f0b79d65c31c7b6da998b8cd", "patch": "@@ -1,3 +1,10 @@\n+2011-05-14  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/48961\n+\t* intrinsics/execute_command_line.c (set_cmdstat): Don't abort if\n+\tsynchronously executing with WAIT=.false.\n+\t(execute_command_line): Fix setting of cmdstat and exitstat.\n+\n 2011-05-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/18918"}, {"sha": "d0b79a45a52a85c6a80a1736bf380fadd287a405", "filename": "libgfortran/intrinsics/execute_command_line.c", "status": "modified", "additions": 15, "deletions": 10, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b4224aec547b9e01f0b79d65c31c7b6da998b8cd/libgfortran%2Fintrinsics%2Fexecute_command_line.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b4224aec547b9e01f0b79d65c31c7b6da998b8cd/libgfortran%2Fintrinsics%2Fexecute_command_line.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fintrinsics%2Fexecute_command_line.c?ref=b4224aec547b9e01f0b79d65c31c7b6da998b8cd", "patch": "@@ -38,9 +38,12 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n #endif\n \n \n-enum { EXEC_NOERROR = 0, EXEC_SYSTEMFAILED };\n+enum { EXEC_SYNCHRONOUS = -2, EXEC_NOERROR = 0, EXEC_SYSTEMFAILED,\n+       EXEC_CHILDFAILED };\n static const char *cmdmsg_values[] =\n-  { \"\", \"Execution of child process impossible\" };\n+  { \"\",\n+    \"Termination status of the command-language interpreter cannot be obtained\",\n+    \"Execution of child process impossible\" };\n \n \n \n@@ -49,7 +52,7 @@ set_cmdstat (int *cmdstat, int value)\n {\n   if (cmdstat)\n     *cmdstat = value;\n-  else if (value != 0)\n+  else if (value > EXEC_NOERROR)\n     runtime_error (\"Could not execute command line\");\n }\n \n@@ -74,10 +77,10 @@ execute_command_line (const char *command, bool wait, int *exitstat,\n       /* Asynchronous execution.  */\n       pid_t pid;\n \n-      set_cmdstat (cmdstat, 0);\n+      set_cmdstat (cmdstat, EXEC_NOERROR);\n \n       if ((pid = fork()) < 0)\n-\tset_cmdstat (cmdstat, EXEC_SYSTEMFAILED);\n+\tset_cmdstat (cmdstat, EXEC_CHILDFAILED);\n       else if (pid == 0)\n \t{\n \t  /* Child process.  */\n@@ -91,13 +94,15 @@ execute_command_line (const char *command, bool wait, int *exitstat,\n       /* Synchronous execution.  */\n       int res = system (cmd);\n \n-      if (!wait)\n-\tset_cmdstat (cmdstat, -2);\n-      else if (res == -1)\n+      if (res == -1)\n \tset_cmdstat (cmdstat, EXEC_SYSTEMFAILED);\n+      else if (!wait)\n+\tset_cmdstat (cmdstat, EXEC_SYNCHRONOUS);\n       else\n+\tset_cmdstat (cmdstat, EXEC_NOERROR);\n+\n+      if (res != -1)\n \t{\n-\t  set_cmdstat (cmdstat, 0);\n #if defined(WEXITSTATUS) && defined(WIFEXITED)\n \t  *exitstat = WIFEXITED(res) ? WEXITSTATUS(res) : res;\n #else\n@@ -107,7 +112,7 @@ execute_command_line (const char *command, bool wait, int *exitstat,\n     }\n \n   /* Now copy back to the Fortran string if needed.  */\n-  if (cmdstat && *cmdstat > 0)\n+  if (cmdstat && *cmdstat > EXEC_NOERROR)\n     {\n       if (cmdmsg)\n \tfstrcpy (cmdmsg, cmdmsg_len, cmdmsg_values[*cmdstat],"}]}