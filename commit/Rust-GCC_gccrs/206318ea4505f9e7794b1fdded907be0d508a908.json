{"sha": "206318ea4505f9e7794b1fdded907be0d508a908", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjA2MzE4ZWE0NTA1ZjllNzc5NGIxZmRkZWQ5MDdiZTBkNTA4YTkwOA==", "commit": {"author": {"name": "Anthony Green", "email": "green@redhat.com", "date": "2005-03-25T00:38:43Z"}, "committer": {"name": "Anthony Green", "email": "green@gcc.gnu.org", "date": "2005-03-25T00:38:43Z"}, "message": "From libjava...\n\n2005-03-24  Anthony Green  <green@redhat.com>\n\n        * gnu/gcj/tools/gcj_dbtool/Main.java: Accept libdir argument with\n        -p option.\n        (usage): Add [LIBDIR] to help output.\n        * gnu/gcj/tools/gcj_dbtool/natMain.cc: New file.\n        * Makefile.am (AM_CXXFLAGS): Define\n        LIBGCJ_DEFAULT_DATABASE_PATH_TAIL.\n        (db_pathtail): New macro.\n\nFrom gcc/java...\n\n2005-03-24  Anthony Green  <green@redhat.com>\n\n        * gcj.texi (Invoking gcj-dbtool): Document new LIBDIR option to\n        'gcj-dbtool -p'.\n\nFrom-SVN: r97028", "tree": {"sha": "d5fad0adecf376ff1dbdfe3f240a480ab44643b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d5fad0adecf376ff1dbdfe3f240a480ab44643b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/206318ea4505f9e7794b1fdded907be0d508a908", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/206318ea4505f9e7794b1fdded907be0d508a908", "html_url": "https://github.com/Rust-GCC/gccrs/commit/206318ea4505f9e7794b1fdded907be0d508a908", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/206318ea4505f9e7794b1fdded907be0d508a908/comments", "author": {"login": "atgreen", "id": 89993, "node_id": "MDQ6VXNlcjg5OTkz", "avatar_url": "https://avatars.githubusercontent.com/u/89993?v=4", "gravatar_id": "", "url": "https://api.github.com/users/atgreen", "html_url": "https://github.com/atgreen", "followers_url": "https://api.github.com/users/atgreen/followers", "following_url": "https://api.github.com/users/atgreen/following{/other_user}", "gists_url": "https://api.github.com/users/atgreen/gists{/gist_id}", "starred_url": "https://api.github.com/users/atgreen/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/atgreen/subscriptions", "organizations_url": "https://api.github.com/users/atgreen/orgs", "repos_url": "https://api.github.com/users/atgreen/repos", "events_url": "https://api.github.com/users/atgreen/events{/privacy}", "received_events_url": "https://api.github.com/users/atgreen/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "761d80b91f9b4b57b29a7f1df3ff34340b5a0ae2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/761d80b91f9b4b57b29a7f1df3ff34340b5a0ae2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/761d80b91f9b4b57b29a7f1df3ff34340b5a0ae2"}], "stats": {"total": 62, "additions": 51, "deletions": 11}, "files": [{"sha": "1c38f50dfee3fbc1d2f80b80c0574fd78b7bb7ca", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/206318ea4505f9e7794b1fdded907be0d508a908/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/206318ea4505f9e7794b1fdded907be0d508a908/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=206318ea4505f9e7794b1fdded907be0d508a908", "patch": "@@ -1,3 +1,8 @@\n+2005-03-24  Anthony Green  <green@redhat.com>\n+\n+\t* gcj.texi (Invoking gcj-dbtool): Document new LIBDIR option to\n+\t'gcj-dbtool -p'.\n+\n 2005-03-23  Tom Tromey  <tromey@redhat.com>\n \n \t* decl.c (GCJ_CURRENT_BC_ABI_VERSION): New define."}, {"sha": "748597b8eb74f3b0c511338d061f43fa28fea294", "filename": "gcc/java/gcj.texi", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/206318ea4505f9e7794b1fdded907be0d508a908/gcc%2Fjava%2Fgcj.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/206318ea4505f9e7794b1fdded907be0d508a908/gcc%2Fjava%2Fgcj.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fgcj.texi?ref=206318ea4505f9e7794b1fdded907be0d508a908", "patch": "@@ -991,7 +991,7 @@ Each time a class is initialized, print a short message on standard error.\n gcj-dbtool @option{OPTION} @var{DBFILE} [@option{MORE}] @dots{}\n \n gcj-dbtool [@option{-n}] [@option{-a}] [@option{-f}]\n-  [@option{-t}] [@option{-l}] [@option{-p}]\n+  [@option{-t}] [@option{-l}] [@option{-p} [@var{LIBDIR}]]\n   [@option{-v}] [@option{--version}] [@option{--help}]\n \n @c man end\n@@ -1045,7 +1045,9 @@ List the contents of a database.\n \n @item -p\n Print the name of the default database.  If there is no default\n-database, this prints a blank line.\n+database, this prints a blank line.  If @var{LIBDIR} is specified, use\n+it instead of the default library directory component of the database\n+name.\n \n @item --help\n Print a help message, then exit."}, {"sha": "e7de36293733cebea88a2bb76e6ba2f1f352392d", "filename": "libjava/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=206318ea4505f9e7794b1fdded907be0d508a908", "patch": "@@ -1,3 +1,13 @@\n+2005-03-24  Anthony Green  <green@redhat.com>\n+\n+\t* gnu/gcj/tools/gcj_dbtool/Main.java: Accept libdir argument with\n+\t-p option.\n+\t(usage): Add [LIBDIR] to help output.\n+\t* gnu/gcj/tools/gcj_dbtool/natMain.cc: New file.\n+\t* Makefile.am (AM_CXXFLAGS): Define\n+\tLIBGCJ_DEFAULT_DATABASE_PATH_TAIL.\n+\t(db_pathtail): New macro.\n+\n 2005-03-24  Tom Tromey  <tromey@redhat.com>\n \n \t* gnu/gcj/runtime/BootClassLoader.java (BootClassLoader): Don't"}, {"sha": "30513e60268d815ac9c8bc833d5b5ce16410ff1d", "filename": "libjava/Makefile.am", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FMakefile.am?ref=206318ea4505f9e7794b1fdded907be0d508a908", "patch": "@@ -130,6 +130,8 @@ propdir = $(libdir)\n dbexecdir = $(libdir)/gcj-$(gcc_version)\n ## Name of the default .db.\n db_name = classmap.db\n+## Compiler specific component of the .db file\n+db_pathtail = gcj-@gcc_version@/$(db_name)\n \n ## For now, only on native systems.  FIXME.\n if NATIVE\n@@ -185,6 +187,7 @@ AM_CXXFLAGS = \\\n \t-DBOOT_CLASS_PATH=\"\\\"$(jardir)/$(jar_DATA)\\\"\" \\\n \t-DJAVA_EXT_DIRS=\"\\\"$(jardir)/ext\\\"\" \\\n \t-DLIBGCJ_DEFAULT_DATABASE=\"\\\"$(dbexecdir)/$(db_name)\\\"\" \\\n+\t-DLIBGCJ_DEFAULT_DATABASE_PATH_TAIL=\"\\\"$(db_pathtail)\\\"\" \\\n \t-DTOOLEXECLIBDIR=\"\\\"$(toolexeclibdir)\\\"\"\n \n AM_GCJFLAGS = \\\n@@ -715,7 +718,7 @@ inner_nat_headers = java/io/ObjectOutputStream$$PutField.h \\\n \tgnu/java/nio/PipeImpl$$SourceChannelImpl.h \\\n \t$(PLATFORM_INNER_NAT_HDRS)\n \n-nat_headers = $(ordinary_nat_headers) $(inner_nat_headers)\n+nat_headers = $(ordinary_nat_headers) $(inner_nat_headers) gnu/gcj/tools/gcj_dbtool/Main.h\n nat_headers_install = $(ordinary_nat_headers)\n \n xlib_nat_headers = $(xlib_java_source_files:.java=.h)\n@@ -1028,7 +1031,8 @@ jv_convert_LDADD = -L$(here)/.libs libgcj.la\n ## linking this program.\n jv_convert_DEPENDENCIES = libgcj.la libgcj.spec\n \n-gcj_dbtool_SOURCES = gnu/gcj/tools/gcj_dbtool/Main.java\n+gcj_dbtool_SOURCES = gnu/gcj/tools/gcj_dbtool/Main.java \\\n+\tgnu/gcj/tools/gcj_dbtool/natMain.cc\n ## We need -nodefaultlibs because we want to avoid gcj's `-lgcj'.  We\n ## need this because we are explicitly using libtool to link using the\n ## `.la' file."}, {"sha": "1fc97bb276c03a4b71e2043c2d6cdbe25bae7175", "filename": "libjava/Makefile.in", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FMakefile.in?ref=206318ea4505f9e7794b1fdded907be0d508a908", "patch": "@@ -4188,7 +4188,8 @@ libjawt_la_OBJECTS = $(am_libjawt_la_OBJECTS)\n @GTK_AWT_TRUE@am_libjawt_la_rpath = -rpath $(toolexeclibdir)\n binPROGRAMS_INSTALL = $(INSTALL_PROGRAM)\n PROGRAMS = $(bin_PROGRAMS) $(noinst_PROGRAMS)\n-am_gcj_dbtool_OBJECTS = gnu/gcj/tools/gcj_dbtool/Main.$(OBJEXT)\n+am_gcj_dbtool_OBJECTS = gnu/gcj/tools/gcj_dbtool/Main.$(OBJEXT) \\\n+\tgnu/gcj/tools/gcj_dbtool/natMain.$(OBJEXT)\n gcj_dbtool_OBJECTS = $(am_gcj_dbtool_OBJECTS)\n am__gen_from_JIS_SOURCES_DIST = gnu/gcj/convert/gen-from-JIS.c \\\n \tgnu/gcj/convert/make-trie.c\n@@ -4544,6 +4545,7 @@ secdir = $(libdir)/security\n propdir = $(libdir)\n dbexecdir = $(libdir)/gcj-$(gcc_version)\n db_name = classmap.db\n+db_pathtail = gcj-@gcc_version@/$(db_name)\n @NATIVE_TRUE@dbexec_DATA = $(db_name)\n bin_SCRIPTS = addr2name.awk\n GCJ_WITH_FLAGS = $(GCJ) --encoding=UTF-8 -Wno-deprecated\n@@ -4567,6 +4569,7 @@ AM_CXXFLAGS = \\\n \t-DBOOT_CLASS_PATH=\"\\\"$(jardir)/$(jar_DATA)\\\"\" \\\n \t-DJAVA_EXT_DIRS=\"\\\"$(jardir)/ext\\\"\" \\\n \t-DLIBGCJ_DEFAULT_DATABASE=\"\\\"$(dbexecdir)/$(db_name)\\\"\" \\\n+\t-DLIBGCJ_DEFAULT_DATABASE_PATH_TAIL=\"\\\"$(db_pathtail)\\\"\" \\\n \t-DTOOLEXECLIBDIR=\"\\\"$(toolexeclibdir)\\\"\"\n \n AM_GCJFLAGS = \\\n@@ -4813,7 +4816,7 @@ inner_nat_headers = java/io/ObjectOutputStream$$PutField.h \\\n \tgnu/java/nio/PipeImpl$$SourceChannelImpl.h \\\n \t$(PLATFORM_INNER_NAT_HDRS)\n \n-nat_headers = $(ordinary_nat_headers) $(inner_nat_headers)\n+nat_headers = $(ordinary_nat_headers) $(inner_nat_headers) gnu/gcj/tools/gcj_dbtool/Main.h\n nat_headers_install = $(ordinary_nat_headers)\n xlib_nat_headers = $(xlib_java_source_files:.java=.h)\n extra_headers = java/lang/Object.h java/lang/Class.h\n@@ -4834,7 +4837,9 @@ jv_convert_LDFLAGS = --main=gnu.gcj.convert.Convert \\\n jv_convert_LINK = $(GCJLINK)\n jv_convert_LDADD = -L$(here)/.libs libgcj.la\n jv_convert_DEPENDENCIES = libgcj.la libgcj.spec\n-gcj_dbtool_SOURCES = gnu/gcj/tools/gcj_dbtool/Main.java\n+gcj_dbtool_SOURCES = gnu/gcj/tools/gcj_dbtool/Main.java \\\n+\tgnu/gcj/tools/gcj_dbtool/natMain.cc\n+\n gcj_dbtool_LDFLAGS = --main=gnu.gcj.tools.gcj_dbtool.Main \\\n \t-rpath $(toolexeclibdir) -shared-libgcc $(THREADLDFLAGS)\n \n@@ -14672,6 +14677,9 @@ gnu/gcj/tools/gcj_dbtool/$(DEPDIR)/$(am__dirstamp):\n gnu/gcj/tools/gcj_dbtool/Main.$(OBJEXT):  \\\n \tgnu/gcj/tools/gcj_dbtool/$(am__dirstamp) \\\n \tgnu/gcj/tools/gcj_dbtool/$(DEPDIR)/$(am__dirstamp)\n+gnu/gcj/tools/gcj_dbtool/natMain.$(OBJEXT):  \\\n+\tgnu/gcj/tools/gcj_dbtool/$(am__dirstamp) \\\n+\tgnu/gcj/tools/gcj_dbtool/$(DEPDIR)/$(am__dirstamp)\n gcj-dbtool$(EXEEXT): $(gcj_dbtool_OBJECTS) $(gcj_dbtool_DEPENDENCIES) \n \t@rm -f gcj-dbtool$(EXEEXT)\n \t$(gcj_dbtool_LINK) $(gcj_dbtool_LDFLAGS) $(gcj_dbtool_OBJECTS) $(gcj_dbtool_LDADD) $(LIBS)\n@@ -14866,6 +14874,7 @@ mostlyclean-compile:\n \t-rm -f gnu/gcj/runtime/natVMClassLoader.$(OBJEXT)\n \t-rm -f gnu/gcj/runtime/natVMClassLoader.lo\n \t-rm -f gnu/gcj/tools/gcj_dbtool/Main.$(OBJEXT)\n+\t-rm -f gnu/gcj/tools/gcj_dbtool/natMain.$(OBJEXT)\n \t-rm -f gnu/gcj/util/Debug.$(OBJEXT)\n \t-rm -f gnu/gcj/util/Debug.lo\n \t-rm -f gnu/gcj/util/natDebug.$(OBJEXT)\n@@ -19826,6 +19835,7 @@ distclean-compile:\n @AMDEP_TRUE@@am__include@ @am__quote@gnu/gcj/runtime/$(DEPDIR)/natStringBuffer.Plo@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@gnu/gcj/runtime/$(DEPDIR)/natVMClassLoader.Plo@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@gnu/gcj/tools/gcj_dbtool/$(DEPDIR)/Main.Po@am__quote@\n+@AMDEP_TRUE@@am__include@ @am__quote@gnu/gcj/tools/gcj_dbtool/$(DEPDIR)/natMain.Po@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@gnu/gcj/util/$(DEPDIR)/Debug.Plo@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@gnu/gcj/util/$(DEPDIR)/natDebug.Plo@am__quote@\n @AMDEP_TRUE@@am__include@ @am__quote@gnu/gcj/xlib/$(DEPDIR)/Clip.Plo@am__quote@"}, {"sha": "cfd22bd3cc1a5e470fff7abc7ebaca28bfa7895d", "filename": "libjava/gnu/gcj/tools/gcj_dbtool/Main.java", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2Fgnu%2Fgcj%2Ftools%2Fgcj_dbtool%2FMain.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/206318ea4505f9e7794b1fdded907be0d508a908/libjava%2Fgnu%2Fgcj%2Ftools%2Fgcj_dbtool%2FMain.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fgnu%2Fgcj%2Ftools%2Fgcj_dbtool%2FMain.java?ref=206318ea4505f9e7794b1fdded907be0d508a908", "patch": "@@ -259,9 +259,16 @@ public static void main (String[] s)\n \n     if (s[0].equals(\"-p\"))\n       {\n-\tinsist (s.length == 1);\n-\tString result = System.getProperty(\"gnu.gcj.precompiled.db.path\",\n-\t\t\t\t\t   \"\");\n+\tinsist (s.length == 1 || s.length == 2);\n+\tString result;\n+\t\n+\tif (s.length == 1)\n+\t  result = System.getProperty(\"gnu.gcj.precompiled.db.path\", \"\");\n+\telse \n+\t  result = (s[1] \n+\t\t    + (s[1].endsWith(File.separator) ? \"\" : File.separator)\n+\t\t    + getDbPathTail ());\n+\n \tSystem.out.println (result);\n \treturn;\n       }\n@@ -270,6 +277,8 @@ public static void main (String[] s)\n     System.exit(1);\t    \n   }\n \n+  private static native String getDbPathTail ();\n+    \n   private static void insist(boolean ok)\n   {\n     if (! ok)\n@@ -296,7 +305,7 @@ private static void usage(PrintStream out)\n        + \"             - Merge gcj map databases into dest\\n\"\n        + \"               Replaces dest\\n\"\n        + \"               To add to dest, include dest in the list of sources\\n\"\n-       + \"    gcj-dbtool -p                       - Print default database name\");\n+       + \"    gcj-dbtool -p [LIBDIR]              - Print default database name\");\n   }\n \n   // Add a jar to a map.  This copies the map first and returns a"}]}