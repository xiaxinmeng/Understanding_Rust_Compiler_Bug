{"sha": "e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTJjMTA0ZDhiNjIzODI4ODNlYjNhNzA0ZjU2YjczOTRmMmMxZThlNg==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2006-12-12T12:41:26Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2006-12-12T12:41:26Z"}, "message": "re PR libstdc++/26497 (libstdc++-v3: configure: test: -lt: unary operator expected)\n\n\n2006-12-12  Benjamin Kosnik  <bkoz@redhat.com>\n\n\tPR libstdc++/26497\n\t* crossconfig.m4: Add GLIBCXX_CHECK_LINKER_FEATURES for Solaris.\n\t* acinclude.m4 (GLIBCXX_CHECK_LINKER_FEATURES): Set\n\tglibcxx_gnu_ld_version only when with GNU ld confirmed.\t\n\t* configure: Regenerate.\n\nFrom-SVN: r119778", "tree": {"sha": "ecc298c73c20960994cd0d9e25a3b2b438733448", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ecc298c73c20960994cd0d9e25a3b2b438733448"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/comments", "author": null, "committer": null, "parents": [{"sha": "8e3dc7a3449a516cacb71735055eb12fcebf5b6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e3dc7a3449a516cacb71735055eb12fcebf5b6f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e3dc7a3449a516cacb71735055eb12fcebf5b6f"}], "stats": {"total": 325, "additions": 257, "deletions": 68}, "files": [{"sha": "4192b79a9f1b306678cd5ee9cec1dd9fbce993d8", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "patch": "@@ -1,3 +1,11 @@\n+2006-12-12  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\tPR libstdc++/26497\n+\t* crossconfig.m4: Add GLIBCXX_CHECK_LINKER_FEATURES for Solaris.\n+\t* acinclude.m4 (GLIBCXX_CHECK_LINKER_FEATURES): Set\n+\tglibcxx_gnu_ld_version only when with GNU ld confirmed.\t\n+\t* configure: Regenerate.\n+\n 2006-12-11  Benjamin Kosnik  <bkoz@redhat.com>\n \n \tPR libstdc++/28125"}, {"sha": "b9f5d3fc1af26ed5a81cf61b2c82bf243f8ea87c", "filename": "libstdc++-v3/acinclude.m4", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2Facinclude.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2Facinclude.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Facinclude.m4?ref=e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "patch": "@@ -231,14 +231,16 @@ AC_DEFUN([GLIBCXX_CHECK_LINKER_FEATURES], [\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  AC_MSG_CHECKING([for ld version])\n-  changequote(,)\n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n-  changequote([,])\n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) [$]3=0; print ([$]1*100+[$]2)*100+[$]3 }'`\n-  AC_MSG_RESULT($glibcxx_gnu_ld_version)\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    AC_MSG_CHECKING([for ld version])\n+    changequote(,)\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    changequote([,])\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) [$]3=0; print ([$]1*100+[$]2)*100+[$]3 }'`\n+    AC_MSG_RESULT($glibcxx_gnu_ld_version)\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602"}, {"sha": "6b95b0ef1d99ba61b709dbfbdb30df53e19b21af", "filename": "libstdc++-v3/configure", "status": "modified", "additions": 238, "deletions": 60, "changes": 298, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure?ref=e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "patch": "@@ -8374,16 +8374,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -54178,16 +54180,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -75482,16 +75486,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -76949,16 +76955,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -78384,16 +78392,18 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -100131,16 +100141,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -101427,16 +101439,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -102772,16 +102786,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -104509,16 +104525,18 @@ echo \"${ECHO_T}$glibcxx_cv_WRITEV\" >&6\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602\n@@ -105670,6 +105688,164 @@ _ACEOF\n     #    os_include_dir=\"os/solaris/solaris2.6\"\n     #    ;;\n       *-solaris2.7 | *-solaris2.8 | *-solaris2.9 | *-solaris2.10)\n+\n+  # If we're not using GNU ld, then there's no point in even trying these\n+  # tests.  Check for that first.  We should have already tested for gld\n+  # by now (in libtool), but require it now just to be safe...\n+  test -z \"$SECTION_LDFLAGS\" && SECTION_LDFLAGS=''\n+  test -z \"$OPT_LDFLAGS\" && OPT_LDFLAGS=''\n+\n+\n+\n+  # The name set by libtool depends on the version of libtool.  Shame on us\n+  # for depending on an impl detail, but c'est la vie.  Older versions used\n+  # ac_cv_prog_gnu_ld, but now it's lt_cv_prog_gnu_ld, and is copied back on\n+  # top of with_gnu_ld (which is also set by --with-gnu-ld, so that actually\n+  # makes sense).  We'll test with_gnu_ld everywhere else, so if that isn't\n+  # set (hence we're using an older libtool), then set it.\n+  if test x${with_gnu_ld+set} != xset; then\n+    if test x${ac_cv_prog_gnu_ld+set} != xset; then\n+      # We got through \"ac_require(ac_prog_ld)\" and still not set?  Huh?\n+      with_gnu_ld=no\n+    else\n+      with_gnu_ld=$ac_cv_prog_gnu_ld\n+    fi\n+  fi\n+\n+  # Start by getting the version number.  I think the libtool test already\n+  # does some of this, but throws away the result.\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n+echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n+\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n+\n+  # Set --gc-sections.\n+  glibcxx_gcsections_min_ld=21602\n+  if test x\"$with_gnu_ld\" = x\"yes\" &&\n+\ttest $glibcxx_gnu_ld_version -gt $glibcxx_gcsections_min_ld ; then\n+\n+    # Sufficiently young GNU ld it is!  Joy and bunny rabbits!\n+    # NB: This flag only works reliably after 2.16.1. Configure tests\n+    # for this are difficult, so hard wire a value that should work.\n+\n+    # All these tests are for C++, but run with the \"C\" compiler driver.\n+    # Need to do this so that g++ won't try to link in libstdc++/libsupc++.\n+    ac_test_CFLAGS=\"${CFLAGS+set}\"\n+    ac_save_CFLAGS=\"$CFLAGS\"\n+    CFLAGS='-x c++ -Wl,--gc-sections'\n+\n+    # Check for -Wl,--gc-sections\n+    echo \"$as_me:$LINENO: checking for ld that supports -Wl,--gc-sections\" >&5\n+echo $ECHO_N \"checking for ld that supports -Wl,--gc-sections... $ECHO_C\" >&6\n+    if test x$gcc_no_link = xyes; then\n+  { { echo \"$as_me:$LINENO: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&5\n+echo \"$as_me: error: Link tests are not allowed after GCC_NO_EXECUTABLES.\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+ int one(void) { return 1; }\n+     int two(void) { return 2; }\n+\n+int\n+main ()\n+{\n+ two();\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext conftest$ac_exeext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n+  (eval $ac_link) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest$ac_exeext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_gcsections=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_gcsections=no\n+fi\n+rm -f conftest.err conftest.$ac_objext \\\n+      conftest$ac_exeext conftest.$ac_ext\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      rm -f conftest.c\n+      touch conftest.c\n+      if $CC -c conftest.c; then\n+\tif $LD --gc-sections -o conftest conftest.o 2>&1 | \\\n+\t   grep \"Warning: gc-sections option ignored\" > /dev/null; then\n+\t  ac_gcsections=no\n+\tfi\n+      fi\n+      rm -f conftest.c conftest.o conftest\n+    fi\n+    if test \"$ac_gcsections\" = \"yes\"; then\n+      SECTION_LDFLAGS=\"-Wl,--gc-sections $SECTION_LDFLAGS\"\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_gcsections\" >&5\n+echo \"${ECHO_T}$ac_gcsections\" >&6\n+\n+    if test \"$ac_test_CFLAGS\" = set; then\n+      CFLAGS=\"$ac_save_CFLAGS\"\n+    else\n+      # this is the suspicious part\n+      CFLAGS=''\n+    fi\n+  fi\n+\n+  # Set -z,relro.\n+  # Note this is only for shared objects.\n+  ac_ld_relro=no\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld that supports -Wl,-z,relro\" >&5\n+echo $ECHO_N \"checking for ld that supports -Wl,-z,relro... $ECHO_C\" >&6\n+    cxx_z_relo=`$LD -v --help 2>/dev/null | grep \"z relro\"`\n+    if test -n \"$cxx_z_relo\"; then\n+      OPT_LDFLAGS=\"-Wl,-z,relro\"\n+      ac_ld_relro=yes\n+    fi\n+    echo \"$as_me:$LINENO: result: $ac_ld_relro\" >&5\n+echo \"${ECHO_T}$ac_ld_relro\" >&6\n+  fi\n+\n+  # Set linker optimization flags.\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    OPT_LDFLAGS=\"-Wl,-O1 $OPT_LDFLAGS\"\n+  fi\n+\n+\n+\n+\n          cat >>confdefs.h <<\\_ACEOF\n #define HAVE_GETPAGESIZE 1\n _ACEOF\n@@ -106511,16 +106687,18 @@ done\n \n   # Start by getting the version number.  I think the libtool test already\n   # does some of this, but throws away the result.\n-  echo \"$as_me:$LINENO: checking for ld version\" >&5\n+  if test x\"$with_gnu_ld\" = x\"yes\"; then\n+    echo \"$as_me:$LINENO: checking for ld version\" >&5\n echo $ECHO_N \"checking for ld version... $ECHO_C\" >&6\n \n-  ldver=`$LD --version 2>/dev/null | head -1 | \\\n-         sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n+    ldver=`$LD --version 2>/dev/null | head -1 | \\\n+           sed -e 's/GNU ld version \\([0-9.][0-9.]*\\).*/\\1/'`\n \n-  glibcxx_gnu_ld_version=`echo $ldver | \\\n-         $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n-  echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n+    glibcxx_gnu_ld_version=`echo $ldver | \\\n+           $AWK -F. '{ if (NF<3) $3=0; print ($1*100+$2)*100+$3 }'`\n+    echo \"$as_me:$LINENO: result: $glibcxx_gnu_ld_version\" >&5\n echo \"${ECHO_T}$glibcxx_gnu_ld_version\" >&6\n+  fi\n \n   # Set --gc-sections.\n   glibcxx_gcsections_min_ld=21602"}, {"sha": "87fc59147a426531e5c9c74cab116455f3a859cd", "filename": "libstdc++-v3/crossconfig.m4", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2Fcrossconfig.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e2c104d8b62382883eb3a704f56b7394f2c1e8e6/libstdc%2B%2B-v3%2Fcrossconfig.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fcrossconfig.m4?ref=e2c104d8b62382883eb3a704f56b7394f2c1e8e6", "patch": "@@ -254,6 +254,7 @@ case \"${host}\" in\n     #    os_include_dir=\"os/solaris/solaris2.6\"\n     #    ;;\n       *-solaris2.7 | *-solaris2.8 | *-solaris2.9 | *-solaris2.10)\n+         GLIBCXX_CHECK_LINKER_FEATURES\n          AC_DEFINE(HAVE_GETPAGESIZE)\n          AC_DEFINE(HAVE_SIGSETJMP)\n          AC_DEFINE(HAVE_MBSTATE_T)"}]}