{"sha": "72826319ff3c180fd7c549a31b16167128c8945a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzI4MjYzMTlmZjNjMTgwZmQ3YzU0OWEzMWIxNjE2NzEyOGM4OTQ1YQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2004-09-14T20:09:31Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2004-09-14T20:09:31Z"}, "message": "natPosixProcess.cc (waitForSignal): Ignore return value of sigsuspend.\n\n        * java/lang/natPosixProcess.cc (waitForSignal): Ignore return\n        value of sigsuspend.\n\nFrom-SVN: r87505", "tree": {"sha": "01aeb539a7cf89605b88803678a1dfa8d88ba69d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/01aeb539a7cf89605b88803678a1dfa8d88ba69d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/72826319ff3c180fd7c549a31b16167128c8945a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72826319ff3c180fd7c549a31b16167128c8945a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/72826319ff3c180fd7c549a31b16167128c8945a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72826319ff3c180fd7c549a31b16167128c8945a/comments", "author": null, "committer": null, "parents": [{"sha": "0393a68af01f1eb9b2a6753e76b308b4645a2f3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0393a68af01f1eb9b2a6753e76b308b4645a2f3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0393a68af01f1eb9b2a6753e76b308b4645a2f3c"}], "stats": {"total": 24, "additions": 13, "deletions": 11}, "files": [{"sha": "2a3039e6e8dd17d52c37a4a860f33997508d9a0c", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/72826319ff3c180fd7c549a31b16167128c8945a/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/72826319ff3c180fd7c549a31b16167128c8945a/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=72826319ff3c180fd7c549a31b16167128c8945a", "patch": "@@ -1,3 +1,8 @@\n+2004-09-14  Richard Henderson  <rth@redhat.com>\n+\n+\t* java/lang/natPosixProcess.cc (waitForSignal): Ignore return\n+\tvalue of sigsuspend.\n+\n 2004-09-12  Tom Tromey  <tromey@redhat.com>\n \n \t* javax/naming/CompoundName.java (CompoundName): Don't check for"}, {"sha": "cca768b6c6f53281ed21aec3cba23799438ca901", "filename": "libjava/java/lang/natPosixProcess.cc", "status": "modified", "additions": 8, "deletions": 11, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/72826319ff3c180fd7c549a31b16167128c8945a/libjava%2Fjava%2Flang%2FnatPosixProcess.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/72826319ff3c180fd7c549a31b16167128c8945a/libjava%2Fjava%2Flang%2FnatPosixProcess.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatPosixProcess.cc?ref=72826319ff3c180fd7c549a31b16167128c8945a", "patch": "@@ -126,26 +126,23 @@ java::lang::ConcreteProcess$ProcessManager::init ()\n void\n java::lang::ConcreteProcess$ProcessManager::waitForSignal ()\n {\n-  using namespace java::lang;\n-\n-  sigset_t mask;\n   // Wait for SIGCHLD\n+  sigset_t mask;\n   pthread_sigmask (0, NULL, &mask);\n   sigdelset (&mask, SIGCHLD);\n+\n   // Use sigsuspend() instead of sigwait() as sigwait() doesn't play\n   // nicely with the GC's use of signals.\n-  int c = sigsuspend (&mask);\n+  sigsuspend (&mask);\n \n-  if (c != -1)\n-    goto error;\n-  if (errno != EINTR)\n-    goto error;\n+  // Do not check sigsuspend return value.  The only legitimate return\n+  // is EINTR, but there is a known kernel bug affecting alpha-linux\n+  // wrt sigsuspend+handler+sigreturn that can result in a return value\n+  // of __NR_sigsuspend and errno unset.  Don't fail unnecessarily on\n+  // older kernel versions.\n \n   // All OK.\n   return;\n-\n-error:\n-  throw new InternalError (JvNewStringUTF (strerror (errno)));\n }\n \n jboolean java::lang::ConcreteProcess$ProcessManager::reap ()"}]}