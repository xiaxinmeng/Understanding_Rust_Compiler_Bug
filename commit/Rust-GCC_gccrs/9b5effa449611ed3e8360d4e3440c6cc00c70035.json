{"sha": "9b5effa449611ed3e8360d4e3440c6cc00c70035", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWI1ZWZmYTQ0OTYxMWVkM2U4MzYwZDRlMzQ0MGM2Y2MwMGM3MDAzNQ==", "commit": {"author": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2012-05-21T12:31:45Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2012-05-21T12:31:45Z"}, "message": "Use unspec_volatile on rdrand<mode>_1\n\ngcc/\n\n\tPR target/53416\n\t* config/i386/i386.md (UNSPEC_RDRAND): Renamed to ...\n\t(UNSPECV_RDRAND): This.\n\t(rdrand<mode>_1): Updated.\n\ngcc/testsuite/\n\n\tPR target/53416\n\t* gcc.target/i386/pr53416.c: New file.\n\nFrom-SVN: r187709", "tree": {"sha": "6a1375782ea7a99066680586a8f28d06eb850d6e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6a1375782ea7a99066680586a8f28d06eb850d6e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9b5effa449611ed3e8360d4e3440c6cc00c70035", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b5effa449611ed3e8360d4e3440c6cc00c70035", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b5effa449611ed3e8360d4e3440c6cc00c70035", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b5effa449611ed3e8360d4e3440c6cc00c70035/comments", "author": null, "committer": null, "parents": [{"sha": "47fb0e185a16682017f27eed5c46d8fdce6f968e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47fb0e185a16682017f27eed5c46d8fdce6f968e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47fb0e185a16682017f27eed5c46d8fdce6f968e"}], "stats": {"total": 40, "additions": 35, "deletions": 5}, "files": [{"sha": "3634b63a951119eebc37c8c48ec59be6d05b33fc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9b5effa449611ed3e8360d4e3440c6cc00c70035", "patch": "@@ -1,3 +1,10 @@\n+2012-05-21  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/53416\n+\t* config/i386/i386.md (UNSPEC_RDRAND): Renamed to ...\n+\t(UNSPECV_RDRAND): This.\n+\t(rdrand<mode>_1): Updated.\n+\n 2012-05-21  Richard Guenther  <rguenther@suse.de>\n \n \t* tree-loop-distribution.c (can_generate_builtin): Reject"}, {"sha": "8326ceb7f204ac4b6d5334f943f4563f8240cf0c", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=9b5effa449611ed3e8360d4e3440c6cc00c70035", "patch": "@@ -176,9 +176,6 @@\n   ;; For CRC32 support\n   UNSPEC_CRC32\n \n-  ;; For RDRAND support\n-  UNSPEC_RDRAND\n-\n   ;; For BMI support\n   UNSPEC_BEXTR\n \n@@ -208,6 +205,9 @@\n   UNSPECV_WRFSBASE\n   UNSPECV_WRGSBASE\n \n+  ;; For RDRAND support\n+  UNSPECV_RDRAND\n+\n   ;; For RTM support\n   UNSPECV_XBEGIN\n   UNSPECV_XEND\n@@ -18403,9 +18403,9 @@\n \n (define_insn \"rdrand<mode>_1\"\n   [(set (match_operand:SWI248 0 \"register_operand\" \"=r\")\n-\t(unspec:SWI248 [(const_int 0)] UNSPEC_RDRAND))\n+\t(unspec_volatile:SWI248 [(const_int 0)] UNSPECV_RDRAND))\n    (set (reg:CCC FLAGS_REG)\n-\t(unspec:CCC [(const_int 0)] UNSPEC_RDRAND))]\n+\t(unspec_volatile:CCC [(const_int 0)] UNSPECV_RDRAND))]\n   \"TARGET_RDRND\"\n   \"rdrand\\t%0\"\n   [(set_attr \"type\" \"other\")"}, {"sha": "3c82445eea2d395a2ed91e2be8719b4c4dce6db7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9b5effa449611ed3e8360d4e3440c6cc00c70035", "patch": "@@ -1,3 +1,9 @@\n+2012-05-21  Uros Bizjak  <ubizjak@gmail.com>\n+\t    H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/53416\n+\t* gcc.target/i386/pr53416.c: New file.\n+\n 2012-05-21  Richard Guenther  <rguenther@suse.de>\n \n \t* gfortran.dg/pr46519-2.f90: Adjust to avoid memset transform."}, {"sha": "68abe8bddbc9dcd29f6b963554378dcaa2201124", "filename": "gcc/testsuite/gcc.target/i386/pr53416.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr53416.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b5effa449611ed3e8360d4e3440c6cc00c70035/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr53416.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr53416.c?ref=9b5effa449611ed3e8360d4e3440c6cc00c70035", "patch": "@@ -0,0 +1,17 @@\n+/* PR target/53416 */\n+/* { dg-options \"-O2 -mrdrnd\" } */\n+\n+int test (void)\n+{\n+  unsigned int number = 0;\n+  int result0, result1, result2, result3;\n+\n+  result0 = __builtin_ia32_rdrand32_step (&number);\n+  result1 = __builtin_ia32_rdrand32_step (&number);\n+  result2 = __builtin_ia32_rdrand32_step (&number);\n+  result3 = __builtin_ia32_rdrand32_step (&number);\n+\n+  return result0 + result1 +result2 + result3;\n+}\n+\n+/* { dg-final { scan-assembler-times \"rdrand\" 4 } } */"}]}