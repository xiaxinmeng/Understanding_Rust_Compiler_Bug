{"sha": "2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjU5M2MzZTFjYjhiNDMyNWY4N2VhNWEyY2U5YzFmOTA2YzRjZjQ1Yg==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-01-26T10:02:11Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-01-26T10:02:11Z"}, "message": "[multiple changes]\n\n2010-01-26  Arnaud Charlet  <charlet@adacore.com>\n\n\t* s-tpoben.adb: Update comments.\n\n2010-01-26  Robert Dewar  <dewar@adacore.com>\n\n\t* freeze.adb (Set_Small_Size): Don't set size if alignment clause\n\tpresent.\n\n2010-01-26  Robert Dewar  <dewar@adacore.com>\n\n\t* scos.ads: Clean up documentation, remove obsolete XOR references\n\nFrom-SVN: r156238", "tree": {"sha": "0381871c3df52168bdd59daf8a8cca434563c28e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0381871c3df52168bdd59daf8a8cca434563c28e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/comments", "author": null, "committer": null, "parents": [{"sha": "1a1054884e248ff337bb8958e1889b90c192f22d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a1054884e248ff337bb8958e1889b90c192f22d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a1054884e248ff337bb8958e1889b90c192f22d"}], "stats": {"total": 54, "additions": 39, "deletions": 15}, "files": [{"sha": "6ed8ae33770889ea840f657d714d33c1ce1320da", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "patch": "@@ -1,3 +1,15 @@\n+2010-01-26  Arnaud Charlet  <charlet@adacore.com>\n+\n+\t* s-tpoben.adb: Update comments.\n+\n+2010-01-26  Robert Dewar  <dewar@adacore.com>\n+\n+\t* freeze.adb (Set_Small_Size): Don't set size if alignment clause\n+\tpresent.\n+\n+2010-01-26  Robert Dewar  <dewar@adacore.com>\n+\n+\t* scos.ads: Clean up documentation, remove obsolete XOR references\n 2010-01-26  Vincent Celier  <celier@adacore.com>\n \n \t* gnat_ugn.texi: Complete documentation on the restrictions for"}, {"sha": "c9639361ec01c87b9d4e37df77b89579c8ec1ec2", "filename": "gcc/ada/freeze.adb", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2Ffreeze.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2Ffreeze.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ffreeze.adb?ref=2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "patch": "@@ -568,7 +568,7 @@ package body Freeze is\n       procedure Set_Small_Size (T : Entity_Id; S : Uint);\n       --  Sets the compile time known size (32 bits or less) in the Esize\n       --  field, of T checking for a size clause that was given which attempts\n-      --  to give a smaller size.\n+      --  to give a smaller size, and also checking for an alignment clause.\n \n       function Size_Known (T : Entity_Id) return Boolean;\n       --  Recursive function that does all the work\n@@ -589,6 +589,15 @@ package body Freeze is\n          if S > 32 then\n             return;\n \n+         --  Don't bother if alignment clause with a value other than 1 is\n+         --  present, because size may be padded up to meet back end alignment\n+         --  requirements, and only the back end knows the rules!\n+\n+         elsif Known_Alignment (T) and then Alignment (T) /= 1 then\n+            return;\n+\n+         --  Check for bad size clause given\n+\n          elsif Has_Size_Clause (T) then\n             if RM_Size (T) < S then\n                Error_Msg_Uint_1 := S;\n@@ -890,12 +899,12 @@ package body Freeze is\n \n                      if Is_Elementary_Type (Ctyp)\n                        or else (Is_Array_Type (Ctyp)\n-                                and then Present (Packed_Array_Type (Ctyp))\n-                                and then Is_Modular_Integer_Type\n-                                           (Packed_Array_Type (Ctyp)))\n+                                 and then Present (Packed_Array_Type (Ctyp))\n+                                 and then Is_Modular_Integer_Type\n+                                            (Packed_Array_Type (Ctyp)))\n                      then\n-                        --  If RM_Size is known and static, then we can\n-                        --  keep accumulating the packed size.\n+                        --  If RM_Size is known and static, then we can keep\n+                        --  accumulating the packed size.\n \n                         if Known_Static_RM_Size (Ctyp) then\n "}, {"sha": "4694310ebff27a011c72122a16b26a333415919d", "filename": "gcc/ada/s-tpoben.adb", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2Fs-tpoben.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2Fs-tpoben.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-tpoben.adb?ref=2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                               B o d y                                    --\n --                                                                          --\n---          Copyright (C) 1998-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1998-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNARL is free software; you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -226,14 +226,12 @@ package body System.Tasking.Protected_Objects.Entries is\n          raise Program_Error;\n       end if;\n \n+      --  pragma Assert (Self_Id.Deferral_Level = 0);\n       --  If a PO is created from a controlled operation, abort is already\n       --  deferred at this point, so we need to use Defer_Abort_Nestable\n-      --  In some cases, the below assertion can be useful to spot\n+      --  In some cases, the above assertion can be useful to spot\n       --  inconsistencies, outside the above scenario involving controlled\n-      --  types:\n-\n-      --  pragma Assert (Self_Id.Deferral_Level = 0);\n-      --  Why is this commented out Assert here ???\n+      --  types.\n \n       Initialization.Defer_Abort_Nestable (Self_ID);\n       Initialize_Lock (Init_Priority, Object.L'Access);"}, {"sha": "3efc5a54f3de25bb33b4d6d393bdad846b1ac479", "filename": "gcc/ada/scos.ads", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2Fscos.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b/gcc%2Fada%2Fscos.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fscos.ads?ref=2593c3e1cb8b4325f87ea5a2ce9c1f906c4cf45b", "patch": "@@ -160,7 +160,12 @@ package SCOs is\n    --  Decisions\n \n    --    Note: in the following description, logical operator includes only the\n-   --    short circuited forms (so can be only of NOT, AND THEN, or OR ELSE).\n+   --    short circuited forms and NOT (so can be only NOT, AND THEN, OR ELSE).\n+   --    The reason that we can exclude AND/OR/XOR is that we expect SCO's to\n+   --    be generated using the restriction No_Direct_Boolean_Operators, which\n+   --    does not permit the use of AND/OR/XOR on boolean operands. These are\n+   --    permitted on modular integer types, but such operations do not count\n+   --    as decisions in any case\n \n    --    Decisions are either simple or complex. A simple decision is a boolean\n    --    expresssion that occurs in the context of a control structure in the\n@@ -217,7 +222,7 @@ package SCOs is\n    --      expression ::= !sloc term       (if expr is NOT)\n \n    --      In the last four cases, sloc is the source location of the AND, OR,\n-   --      XOR or NOT token, respectively.\n+   --      or NOT token, respectively.\n \n    --      term ::= element\n    --      term ::= expression\n@@ -296,7 +301,7 @@ package SCOs is\n    --    Operator\n    --      C1   = '!', '^', '&', '|'\n    --      C2   = ' '\n-   --      From = location of NOT/XOR/AND/OR token\n+   --      From = location of NOT/AND/OR token\n    --      To   = No_Source_Location\n    --      Last = False\n "}]}