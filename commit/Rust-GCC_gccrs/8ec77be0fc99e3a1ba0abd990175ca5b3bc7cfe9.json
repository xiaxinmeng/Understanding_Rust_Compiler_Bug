{"sha": "8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGVjNzdiZTBmYzk5ZTNhMWJhMGFiZDk5MDE3NWNhNWIzYmM3Y2ZlOQ==", "commit": {"author": {"name": "Edgar E. Iglesias", "email": "edgar.iglesias@gmail.com", "date": "2013-02-16T17:42:30Z"}, "committer": {"name": "Michael Eager", "email": "eager@gcc.gnu.org", "date": "2013-02-16T17:42:30Z"}, "message": "microblaze.c (microblaze_asm_trampoline_template): Replace with a microblaze version.\n\n\t* config/microblaze/microblaze.c (microblaze_asm_trampoline_template): \n\tReplace with a microblaze version.\n\t(microblaze_trampoline_init): Adapt for microblaze.\n\t* gcc/config/microblaze/microblaze.h (TRAMPOLINE_SIZE): Adapt for \n\tmicroblaze.\n\nFrom-SVN: r196103", "tree": {"sha": "8db6827c5afa13cddf755039dc7fffa850c2fd37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8db6827c5afa13cddf755039dc7fffa850c2fd37"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9/comments", "author": {"login": "edgarigl", "id": 86901, "node_id": "MDQ6VXNlcjg2OTAx", "avatar_url": "https://avatars.githubusercontent.com/u/86901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edgarigl", "html_url": "https://github.com/edgarigl", "followers_url": "https://api.github.com/users/edgarigl/followers", "following_url": "https://api.github.com/users/edgarigl/following{/other_user}", "gists_url": "https://api.github.com/users/edgarigl/gists{/gist_id}", "starred_url": "https://api.github.com/users/edgarigl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edgarigl/subscriptions", "organizations_url": "https://api.github.com/users/edgarigl/orgs", "repos_url": "https://api.github.com/users/edgarigl/repos", "events_url": "https://api.github.com/users/edgarigl/events{/privacy}", "received_events_url": "https://api.github.com/users/edgarigl/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b41288b3a57a382c7e06ef0f847584f06583ceb4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b41288b3a57a382c7e06ef0f847584f06583ceb4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b41288b3a57a382c7e06ef0f847584f06583ceb4"}], "stats": {"total": 29, "additions": 17, "deletions": 12}, "files": [{"sha": "555e946d8dd0134788038494d7f61021b51428f2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "patch": "@@ -1,3 +1,11 @@\n+2013-02-16  Edgar E. Iglesias  <edgar.iglesias@gmail.com>\n+\n+\t* config/microblaze/microblaze.c (microblaze_asm_trampoline_template): \n+\tReplace with a microblaze version.\n+\t(microblaze_trampoline_init): Adapt for microblaze.\n+\t* gcc/config/microblaze/microblaze.h (TRAMPOLINE_SIZE): Adapt for \n+\tmicroblaze.\n+\n 2013-02-16  Jakub Jelinek  <jakub@redhat.com>\n \t    Dodji Seketeli  <dodji@redhat.com>\n "}, {"sha": "90c962b2eabf2bb0764519a558ce8092f64f0404", "filename": "gcc/config/microblaze/microblaze.c", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c?ref=8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "patch": "@@ -2776,14 +2776,10 @@ microblaze_elf_asm_init_sections (void)\n static void\n microblaze_asm_trampoline_template (FILE *f)\n {\n-  fprintf (f, \"\\t.word\\t0x03e00821\\t\\t# move   $1,$31\\n\");\n-  fprintf (f, \"\\t.word\\t0x04110001\\t\\t# bgezal $0,.+8\\n\");\n-  fprintf (f, \"\\t.word\\t0x00000000\\t\\t# nop\\n\");\n-  fprintf (f, \"\\t.word\\t0x8fe30014\\t\\t# lw     $3,20($31)\\n\");\n-  fprintf (f, \"\\t.word\\t0x8fe20018\\t\\t# lw     $2,24($31)\\n\");\n-  fprintf (f, \"\\t.word\\t0x0060c821\\t\\t# move   $25,$3 (abicalls)\\n\");\n-  fprintf (f, \"\\t.word\\t0x00600008\\t\\t# jr     $3\\n\");\n-  fprintf (f, \"\\t.word\\t0x0020f821\\t\\t# move   $31,$1\\n\");\n+  fprintf (f, \"\\tmfs r18, rpc\\n\");\n+  fprintf (f, \"\\tlwi r3, r18, 16\\n\");\n+  fprintf (f, \"\\tlwi r18, r18, 20\\n\");\n+  fprintf (f, \"\\tbra r18\\n\");\n   /* fprintf (f, \"\\t.word\\t0x00000000\\t\\t# <function address>\\n\");  */\n   /* fprintf (f, \"\\t.word\\t0x00000000\\t\\t# <static chain value>\\n\");  */\n }\n@@ -2797,11 +2793,11 @@ microblaze_trampoline_init (rtx m_tramp, tree fndecl, rtx chain_value)\n   rtx mem;\n \n   emit_block_move (m_tramp, assemble_trampoline_template (),\n-\t\t   GEN_INT (8*UNITS_PER_WORD), BLOCK_OP_NORMAL);\n+\t\t   GEN_INT (6*UNITS_PER_WORD), BLOCK_OP_NORMAL);\n \n-  mem = adjust_address (m_tramp, SImode, 8);\n+  mem = adjust_address (m_tramp, SImode, 16);\n   emit_move_insn (mem, chain_value);\n-  mem = adjust_address (m_tramp, SImode, 12);\n+  mem = adjust_address (m_tramp, SImode, 20);\n   emit_move_insn (mem, fnaddr);\n }\n \f"}, {"sha": "327614544f2036fb5f392a3f364988fc54f93346", "filename": "gcc/config/microblaze/microblaze.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h?ref=8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "patch": "@@ -499,7 +499,8 @@ typedef struct microblaze_args\n \n #define EXIT_IGNORE_STACK\t\t\t1\n \n-#define TRAMPOLINE_SIZE\t\t\t\t(32 + 8)\n+/* 4 insns + 2 words of data.  */\n+#define TRAMPOLINE_SIZE\t\t\t\t(6 * 4)\n \n #define TRAMPOLINE_ALIGNMENT\t\t\t32\n "}]}