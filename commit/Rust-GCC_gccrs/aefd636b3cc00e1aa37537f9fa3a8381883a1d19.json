{"sha": "aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWVmZDYzNmIzY2MwMGUxYWEzNzUzN2Y5ZmEzYTgzODE4ODNhMWQxOQ==", "commit": {"author": {"name": "Louis Krupp", "email": "louis.krupp@zoho.com", "date": "2017-12-27T19:20:12Z"}, "committer": {"name": "Louis Krupp", "email": "lkrupp@gcc.gnu.org", "date": "2017-12-27T19:20:12Z"}, "message": "2017_12_27  Louis Krupp  <louis.krupp@zoho.com>\n\n\tPR fortran/83092\n\t* expr.c (gfc_apply_init): Check that typespec has character type\n\tbefore using character length field.\n\n2017_12_27  Louis Krupp  <louis.krupp@zoho.com>\n\n\tPR fortran/83092\n\t* gfortran.dg/init_char_with_nonchar_ctr.f90: New test.\n\nFrom-SVN: r256011", "tree": {"sha": "9ab9aa114277ba50463637b6940bf80217960a8a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9ab9aa114277ba50463637b6940bf80217960a8a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/comments", "author": null, "committer": null, "parents": [{"sha": "467e6f1bb18878c330e1dc88888b133e85524c46", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/467e6f1bb18878c330e1dc88888b133e85524c46", "html_url": "https://github.com/Rust-GCC/gccrs/commit/467e6f1bb18878c330e1dc88888b133e85524c46"}], "stats": {"total": 46, "additions": 46, "deletions": 0}, "files": [{"sha": "91771e0d6699a74a331e654d3fe55efd8727113d", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "patch": "@@ -1,3 +1,9 @@\n+2017_12_27  Louis Krupp  <louis.krupp@zoho.com>\n+\n+\tPR fortran/83092\n+\t* expr.c (gfc_apply_init): Check that typespec has character type\n+\tbefore using character length field.\n+\n 2017-12-26  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/83540"}, {"sha": "2cdd46522ed34c71d216d12fce724b4c7ab0b08b", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "patch": "@@ -4208,6 +4208,7 @@ gfc_apply_init (gfc_typespec *ts, symbol_attribute *attr, gfc_expr *init)\n       if (init->expr_type == EXPR_CONSTANT)\n         gfc_set_constant_character_len (len, init, -1);\n       else if (init\n+\t       && init->ts.type == BT_CHARACTER\n                && init->ts.u.cl\n                && mpz_cmp (ts->u.cl->length->value.integer,\n                            init->ts.u.cl->length->value.integer))"}, {"sha": "f8fcc47ad7a0ab829e5aac4a476fe299131a0e87", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "patch": "@@ -1,3 +1,8 @@\n+2017_12_27  Louis Krupp  <louis.krupp@zoho.com>\n+\n+\tPR fortran/83092\n+\t* gfortran.dg/init_char_with_nonchar_ctr.f90: New test.\n+\n 2017-12-27  Kugan Vivekanandarajah  <kuganv@linaro.org>\n \n \t* gcc.target/aarch64/advsimd-intrinsics/vld1x2.c: New test."}, {"sha": "b84a9a83c5016de52822218c6348e79537069d35", "filename": "gcc/testsuite/gfortran.dg/init_char_with_nonchar_ctr.f90", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ftestsuite%2Fgfortran.dg%2Finit_char_with_nonchar_ctr.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aefd636b3cc00e1aa37537f9fa3a8381883a1d19/gcc%2Ftestsuite%2Fgfortran.dg%2Finit_char_with_nonchar_ctr.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finit_char_with_nonchar_ctr.f90?ref=aefd636b3cc00e1aa37537f9fa3a8381883a1d19", "patch": "@@ -0,0 +1,34 @@\n+! { dg-do compile }\n+\n+! Initialization of character by non-character constructor\n+\n+subroutine s1\n+   type t\n+      integer :: n = 0\n+   end type\n+   type t2\n+      character :: c = t() ! { dg-error \"Can't convert TYPE\\\\(t\\\\) to CHARACTER\\\\(1\\\\)\" }\n+   end type\n+end subroutine\n+\n+subroutine s2\n+   type t\n+   end type\n+   type t2\n+      character :: c(1) = [t()] ! { dg-error \"Can't convert TYPE\\\\(t\\\\) to CHARACTER\\\\(1\\\\)\" }\n+   end type\n+end subroutine\n+\n+subroutine s3\n+   type t\n+      integer :: a = 1\n+      character :: c = t() ! { dg-error \"Can't convert TYPE\\\\(t\\\\) to CHARACTER\\\\(1\\\\)\" }\n+   end type\n+end subroutine\n+\n+subroutine s4\n+   type t\n+      integer, allocatable :: a\n+      character :: c = t() ! { dg-error \"Can't convert TYPE\\\\(t\\\\) to CHARACTER\\\\(1\\\\)\" }\n+   end type\n+end subroutine"}]}