{"sha": "90630d1932caf1b04df0fb082c36717fa25d2bf3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTA2MzBkMTkzMmNhZjFiMDRkZjBmYjA4MmMzNjcxN2ZhMjVkMmJmMw==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-04-01T05:11:23Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-04-01T05:11:23Z"}, "message": "libgo: Support Solaris 8/9.\n\nFrom Rainer Orth.\n\nFrom-SVN: r171818", "tree": {"sha": "97b7a67ffa9b52603d34af2dc21ec00bbcd09d1d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/97b7a67ffa9b52603d34af2dc21ec00bbcd09d1d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/90630d1932caf1b04df0fb082c36717fa25d2bf3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90630d1932caf1b04df0fb082c36717fa25d2bf3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/90630d1932caf1b04df0fb082c36717fa25d2bf3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/90630d1932caf1b04df0fb082c36717fa25d2bf3/comments", "author": null, "committer": null, "parents": [{"sha": "e8110d6f22a87f265a46907483d32fcfd78f746f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8110d6f22a87f265a46907483d32fcfd78f746f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8110d6f22a87f265a46907483d32fcfd78f746f"}], "stats": {"total": 66, "additions": 51, "deletions": 15}, "files": [{"sha": "9a848751f21f0165ec822a06dcdb346f6fbc0bb9", "filename": "libgo/Makefile.am", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2FMakefile.am?ref=90630d1932caf1b04df0fb082c36717fa25d2bf3", "patch": "@@ -1511,6 +1511,8 @@ libgo_go_objs = \\\n \n libgo_la_SOURCES = $(runtime_files)\n \n+libgo_la_LDFLAGS = $(PTHREAD_CFLAGS)\n+\n libgo_la_LIBADD = \\\n \t$(libgo_go_objs) $(LIBFFI) $(PTHREAD_LIBS) $(MATH_LIBS) $(NET_LIBS)\n \n@@ -2615,7 +2617,7 @@ testing/script/check: $(CHECK_DEPS)\n \n sysinfo.go: s-sysinfo; @true\n s-sysinfo: $(srcdir)/mksysinfo.sh config.h\n-\tCC=\"$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS)\" $(SHELL) $(srcdir)/mksysinfo.sh\n+\tCC=\"$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(OSCFLAGS)\" $(SHELL) $(srcdir)/mksysinfo.sh\n \t$(SHELL) $(srcdir)/../move-if-change tmp-sysinfo.go sysinfo.go\n \t$(STAMP) $@\n "}, {"sha": "a7596af4c04ee916d5572440d1101bf428e6d24b", "filename": "libgo/Makefile.in", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2FMakefile.in?ref=90630d1932caf1b04df0fb082c36717fa25d2bf3", "patch": "@@ -247,6 +247,9 @@ am__objects_3 = go-append.lo go-assert.lo go-assert-interface.lo \\\n \tstring.lo\n am_libgo_la_OBJECTS = $(am__objects_3)\n libgo_la_OBJECTS = $(am_libgo_la_OBJECTS)\n+libgo_la_LINK = $(LIBTOOL) --tag=CC $(AM_LIBTOOLFLAGS) $(LIBTOOLFLAGS) \\\n+\t--mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(libgo_la_LDFLAGS) \\\n+\t$(LDFLAGS) -o $@\n DEFAULT_INCLUDES = -I.@am__isrc@\n depcomp = $(SHELL) $(top_srcdir)/../depcomp\n am__depfiles_maybe = depfiles\n@@ -386,6 +389,7 @@ NMEDIT = @NMEDIT@\n OBJCOPY = @OBJCOPY@\n OBJDUMP = @OBJDUMP@\n OBJEXT = @OBJEXT@\n+OSCFLAGS = @OSCFLAGS@\n OTOOL = @OTOOL@\n OTOOL64 = @OTOOL64@\n PACKAGE = @PACKAGE@\n@@ -1844,6 +1848,7 @@ libgo_go_objs = \\\n \ttesting/script.lo\n \n libgo_la_SOURCES = $(runtime_files)\n+libgo_la_LDFLAGS = $(PTHREAD_CFLAGS)\n libgo_la_LIBADD = \\\n \t$(libgo_go_objs) $(LIBFFI) $(PTHREAD_LIBS) $(MATH_LIBS) $(NET_LIBS)\n \n@@ -2183,7 +2188,7 @@ clean-toolexeclibLTLIBRARIES:\n \t  rm -f \"$${dir}/so_locations\"; \\\n \tdone\n libgo.la: $(libgo_la_OBJECTS) $(libgo_la_DEPENDENCIES) \n-\t$(LINK) -rpath $(toolexeclibdir) $(libgo_la_OBJECTS) $(libgo_la_LIBADD) $(LIBS)\n+\t$(libgo_la_LINK) -rpath $(toolexeclibdir) $(libgo_la_OBJECTS) $(libgo_la_LIBADD) $(LIBS)\n \n mostlyclean-compile:\n \t-rm -f *.$(OBJEXT)\n@@ -5021,7 +5026,7 @@ testing/script/check: $(CHECK_DEPS)\n \n sysinfo.go: s-sysinfo; @true\n s-sysinfo: $(srcdir)/mksysinfo.sh config.h\n-\tCC=\"$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS)\" $(SHELL) $(srcdir)/mksysinfo.sh\n+\tCC=\"$(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(OSCFLAGS)\" $(SHELL) $(srcdir)/mksysinfo.sh\n \t$(SHELL) $(srcdir)/../move-if-change tmp-sysinfo.go sysinfo.go\n \t$(STAMP) $@\n "}, {"sha": "1c70b860262a391cd54be493b38208f451488318", "filename": "libgo/configure", "status": "modified", "additions": 18, "deletions": 2, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fconfigure?ref=90630d1932caf1b04df0fb082c36717fa25d2bf3", "patch": "@@ -616,6 +616,7 @@ MATH_LIBS\n USING_SPLIT_STACK_FALSE\n USING_SPLIT_STACK_TRUE\n SPLIT_STACK\n+OSCFLAGS\n GO_DEBUG_PROC_REGS_OS_ARCH_FILE\n GO_SYSCALLS_SYSCALL_OS_ARCH_FILE\n GOARCH\n@@ -10910,7 +10911,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 10913 \"configure\"\n+#line 10914 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -11016,7 +11017,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11019 \"configure\"\n+#line 11020 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -13544,6 +13545,21 @@ if test -f ${srcdir}/go/debug/proc/regs_${GOOS}_${GOARCH}.go; then\n fi\n \n \n+case \"$target\" in\n+    *-*-solaris2.[89])\n+\t# Solaris 8/9 need this so struct msghdr gets the msg_control\n+\t# etc. fields in <sys/socket.h> (_XPG4_2).\n+\tOSCFLAGS='-D_XOPEN_SOURCE=500 -D_XOPEN_SOURCE_EXTENDED -D__EXTENSIONS__'\n+\t;;\n+    *-*-solaris2.1[01])\n+\t# Solaris 10+ needs this so struct msghdr gets the msg_control\n+\t# etc. fields in <sys/socket.h> (_XPG4_2).  _XOPEN_SOURCE=500 as\n+\t# above doesn't work with C99.\n+\tOSCFLAGS='-D_XOPEN_SOURCE=600 -D__EXTENSIONS__'\n+\t;;\n+esac\n+\n+\n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether -fsplit-stack is supported\" >&5\n $as_echo_n \"checking whether -fsplit-stack is supported... \" >&6; }\n if test \"${libgo_cv_c_split_stack_supported+set}\" = set; then :"}, {"sha": "f7fa3aad281a2e39f506aad9a78a40165d7be4b4", "filename": "libgo/configure.ac", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fconfigure.ac?ref=90630d1932caf1b04df0fb082c36717fa25d2bf3", "patch": "@@ -252,6 +252,22 @@ if test -f ${srcdir}/go/debug/proc/regs_${GOOS}_${GOARCH}.go; then\n fi\n AC_SUBST(GO_DEBUG_PROC_REGS_OS_ARCH_FILE)\n \n+dnl Some targets need special flags to build sysinfo.go.\n+case \"$target\" in\n+    *-*-solaris2.[[89]])\n+\t# Solaris 8/9 need this so struct msghdr gets the msg_control\n+\t# etc. fields in <sys/socket.h> (_XPG4_2).\n+\tOSCFLAGS='-D_XOPEN_SOURCE=500 -D_XOPEN_SOURCE_EXTENDED -D__EXTENSIONS__'\n+\t;;\n+    *-*-solaris2.1[[01]])\n+\t# Solaris 10+ needs this so struct msghdr gets the msg_control\n+\t# etc. fields in <sys/socket.h> (_XPG4_2).  _XOPEN_SOURCE=500 as\n+\t# above doesn't work with C99.\n+\tOSCFLAGS='-D_XOPEN_SOURCE=600 -D__EXTENSIONS__'\n+\t;;\n+esac\n+AC_SUBST(OSCFLAGS)\n+\n dnl Use -fsplit-stack when compiling C code if available.\n AC_CACHE_CHECK([whether -fsplit-stack is supported],\n [libgo_cv_c_split_stack_supported],"}, {"sha": "ab0efe531db8636ccf9078c20d1073e234be909f", "filename": "libgo/mksysinfo.sh", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Fmksysinfo.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Fmksysinfo.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fmksysinfo.sh?ref=90630d1932caf1b04df0fb082c36717fa25d2bf3", "patch": "@@ -29,12 +29,6 @@ cat > sysinfo.c <<EOF\n #define _LARGEFILE_SOURCE\n #define _FILE_OFFSET_BITS 64\n \n-#if defined(__sun__) && defined(__svr4__)\n-/* Needed by Solaris header files.  */\n-#define _XOPEN_SOURCE 600\n-#define __EXTENSIONS__\n-#endif\n-\n #ifdef __sgi__\n /* IRIX 6 needs _XOPEN_SOURCE=500 for the XPG5 version of struct msghdr in\n    <sys/socket.h>.  */\n@@ -108,7 +102,7 @@ grep '^const _E' gen-sysinfo.go | \\\n   sed -e 's/^\\(const \\)_\\(E[^= ]*\\)\\(.*\\)$/\\1\\2 = _\\2/' >> ${OUT}\n \n # The O_xxx flags.\n-grep '^const _\\(O\\|F\\|FD\\)_' gen-sysinfo.go | \\\n+egrep '^const _(O|F|FD)_' gen-sysinfo.go | \\\n   sed -e 's/^\\(const \\)_\\([^= ]*\\)\\(.*\\)$/\\1\\2 = _\\2/' >> ${OUT}\n if ! grep '^const O_ASYNC' ${OUT} >/dev/null 2>&1; then\n   echo \"const O_ASYNC = 0\" >> ${OUT}\n@@ -151,7 +145,7 @@ if grep '^const ___WALL = ' gen-sysinfo.go >/dev/null 2>&1 \\\n fi\n \n # Networking constants.\n-grep '^const _\\(AF\\|SOCK\\|SOL\\|SO\\|IPPROTO\\|TCP\\|IP\\|IPV6\\)_' gen-sysinfo.go |\n+egrep '^const _(AF|SOCK|SOL|SO|IPPROTO|TCP|IP|IPV6)_' gen-sysinfo.go |\n   sed -e 's/^\\(const \\)_\\([^= ]*\\)\\(.*\\)$/\\1\\2 = _\\2/' >> ${OUT}\n grep '^const _SOMAXCONN' gen-sysinfo.go |\n   sed -e 's/^\\(const \\)_\\(SOMAXCONN[^= ]*\\)\\(.*\\)$/\\1\\2 = _\\2/' \\\n@@ -334,7 +328,8 @@ if test \"$stat\" != \"\"; then\n   grep '^type _stat64 ' gen-sysinfo.go\n else\n   grep '^type _stat ' gen-sysinfo.go\n-fi | sed -e 's/type _stat\\(64\\)\\?/type Stat_t/' \\\n+fi | sed -e 's/type _stat64/type Stat_t/' \\\n+         -e 's/type _stat/type Stat_t/' \\\n          -e 's/st_dev/Dev/' \\\n          -e 's/st_ino/Ino/g' \\\n          -e 's/st_nlink/Nlink/' \\\n@@ -360,7 +355,8 @@ if test \"$dirent\" != \"\"; then\n   grep '^type _dirent64 ' gen-sysinfo.go\n else\n   grep '^type _dirent ' gen-sysinfo.go\n-fi | sed -e 's/type _dirent\\(64\\)\\?/type Dirent/' \\\n+fi | sed -e 's/type _dirent64/type Dirent/' \\\n+         -e 's/type _dirent/type Dirent/' \\\n          -e 's/d_name \\[0+1\\]/d_name [0+256]/' \\\n          -e 's/d_name/Name/' \\\n          -e 's/]int8/]byte/' \\"}, {"sha": "2117960e26b3ebc64f8f5a1dc782d82cea51feb8", "filename": "libgo/testsuite/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Ftestsuite%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/90630d1932caf1b04df0fb082c36717fa25d2bf3/libgo%2Ftestsuite%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Ftestsuite%2FMakefile.in?ref=90630d1932caf1b04df0fb082c36717fa25d2bf3", "patch": "@@ -113,6 +113,7 @@ NMEDIT = @NMEDIT@\n OBJCOPY = @OBJCOPY@\n OBJDUMP = @OBJDUMP@\n OBJEXT = @OBJEXT@\n+OSCFLAGS = @OSCFLAGS@\n OTOOL = @OTOOL@\n OTOOL64 = @OTOOL64@\n PACKAGE = @PACKAGE@"}]}