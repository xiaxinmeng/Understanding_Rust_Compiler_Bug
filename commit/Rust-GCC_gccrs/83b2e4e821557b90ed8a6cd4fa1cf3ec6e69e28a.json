{"sha": "83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODNiMmU0ZTgyMTU1N2I5MGVkOGE2Y2Q0ZmExY2YzZWM2ZTY5ZTI4YQ==", "commit": {"author": {"name": "Daniel Franke", "email": "franke.daniel@gmail.com", "date": "2007-07-08T20:38:58Z"}, "committer": {"name": "Daniel Franke", "email": "dfranke@gcc.gnu.org", "date": "2007-07-08T20:38:58Z"}, "message": "re PR fortran/25094 (Procedure with public generic identifier allowed to have argument of private type)\n\ngcc/fortran:\n2007-07-08  Daniel Franke  <franke.daniel@gmail.com>\n\n\tPR fortran/25094\n\t* resolve.c (resolve_fl_procedure): Added check for PRIVATE types\n\tin PUBLIC interfaces.\n\ngcc/testsuite:\n2007-07-08  Daniel Franke  <franke.daniel@gmail.com>\n\n        PR fortran/25094\n\t* gfortran.dg/interface_15.f90: New test.\n\nFrom-SVN: r126466", "tree": {"sha": "5265367f152799418f5add3884d981db427538fb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5265367f152799418f5add3884d981db427538fb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/comments", "author": {"login": "dfranke76", "id": 15729164, "node_id": "MDQ6VXNlcjE1NzI5MTY0", "avatar_url": "https://avatars.githubusercontent.com/u/15729164?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dfranke76", "html_url": "https://github.com/dfranke76", "followers_url": "https://api.github.com/users/dfranke76/followers", "following_url": "https://api.github.com/users/dfranke76/following{/other_user}", "gists_url": "https://api.github.com/users/dfranke76/gists{/gist_id}", "starred_url": "https://api.github.com/users/dfranke76/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dfranke76/subscriptions", "organizations_url": "https://api.github.com/users/dfranke76/orgs", "repos_url": "https://api.github.com/users/dfranke76/repos", "events_url": "https://api.github.com/users/dfranke76/events{/privacy}", "received_events_url": "https://api.github.com/users/dfranke76/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "298f40649496430f6e6c42a137cd15eda59c1d48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/298f40649496430f6e6c42a137cd15eda59c1d48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/298f40649496430f6e6c42a137cd15eda59c1d48"}], "stats": {"total": 58, "additions": 58, "deletions": 0}, "files": [{"sha": "bda3726b24152c4b1a4d0ea66bd44c10c795d54f", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "patch": "@@ -1,3 +1,9 @@\n+2007-07-08  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/25094\n+\t* resolve.c (resolve_fl_procedure): Added check for PRIVATE types \n+\tin PUBLIC interfaces.\n+\n 2007-07-07  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR fortran/32644"}, {"sha": "b887d82e8c9802459fc5ebffba4ec9023f2c69c8", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "patch": "@@ -6649,6 +6649,8 @@ resolve_fl_procedure (gfc_symbol *sym, int mp_flag)\n \t&& sym->ns->parent->proc_name->attr.flavor == FL_MODULE)\n       && gfc_check_access(sym->attr.access, sym->ns->default_access))\n     {\n+      gfc_interface *iface;\n+\n       for (arg = sym->formal; arg; arg = arg->next)\n \t{\n \t  if (arg->sym\n@@ -6666,6 +6668,29 @@ resolve_fl_procedure (gfc_symbol *sym, int mp_flag)\n \t      return FAILURE;\n \t    }\n \t}\n+\n+      /* PUBLIC interfaces may expose PRIVATE procedures that take types\n+\t PRIVATE to the containing module.  */\n+      for (iface = sym->generic; iface; iface = iface->next)\n+\t{\n+\t  for (arg = iface->sym->formal; arg; arg = arg->next)\n+\t    {\n+\t      if (arg->sym\n+\t\t  && arg->sym->ts.type == BT_DERIVED\n+\t\t  && !arg->sym->ts.derived->attr.use_assoc\n+\t\t  && !gfc_check_access (arg->sym->ts.derived->attr.access,\n+\t\t\t\t\targ->sym->ts.derived->ns->default_access))\n+\t\t{\n+\t\t  gfc_error_now (\"Procedure '%s' in PUBLIC interface '%s' at %L takes \"\n+\t\t\t\t \"dummy arguments of '%s' which is PRIVATE\",\n+\t\t\t\t iface->sym->name, sym->name, &iface->sym->declared_at,\n+\t\t\t\t gfc_typename(&arg->sym->ts));\n+\t\t  /* Stop this message from recurring.  */\n+\t\t  arg->sym->ts.derived->attr.access = ACCESS_PUBLIC;\n+\t\t  return FAILURE;\n+\t\t}\n+\t     }\n+\t}\n     }\n \n   /* An external symbol may not have an initializer because it is taken to be"}, {"sha": "0aec398b7f998d9af64d669b301c21bb13ef42ee", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "patch": "@@ -1,3 +1,8 @@\n+2007-07-08  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/25094\n+\t* gfortran.dg/interface_155555.f90: New test.\n+\n 2007-07-08  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.dg/c99-math-double-1.c, gcc.dg/c99-math-float-1.c,"}, {"sha": "c9a3add74aedf0dbbbcdbfa715b24bb1a942810f", "filename": "gcc/testsuite/gfortran.dg/interface_15.f90", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_15.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_15.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_15.f90?ref=83b2e4e821557b90ed8a6cd4fa1cf3ec6e69e28a", "patch": "@@ -0,0 +1,22 @@\n+! { dg-do compile }\n+! { dg-options \"-c\" }\n+! Testcase from PR fortran/25094\n+! Contributed by Joost VandeVondele <jv244@cam.ac.uk>\n+\n+MODULE M1\n+  TYPE T1\n+    INTEGER :: I\n+  END TYPE T1\n+  INTERFACE I\n+    MODULE PROCEDURE F1        ! { dg-error \"PUBLIC interface\" }\n+  END INTERFACE\n+  PRIVATE ! :: T1,F1\n+  PUBLIC  :: I\n+CONTAINS\n+  INTEGER FUNCTION F1(D)\n+    TYPE(T1) :: D\n+    F1 = D%I\n+  END FUNCTION\n+END MODULE\n+\n+! { dg-final { cleanup-modules \"M1\" } }"}]}