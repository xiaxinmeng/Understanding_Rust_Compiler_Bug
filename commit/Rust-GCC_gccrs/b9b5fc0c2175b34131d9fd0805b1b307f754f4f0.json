{"sha": "b9b5fc0c2175b34131d9fd0805b1b307f754f4f0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjliNWZjMGMyMTc1YjM0MTMxZDlmZDA4MDViMWIzMDdmNzU0ZjRmMA==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-15T18:25:52Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-09-16T23:00:41Z"}, "message": "analyzer: add program_point::get_next\n\nAvoid some future copy-and-paste by introducing a function.\n\ngcc/analyzer/ChangeLog:\n\t* engine.cc\n\t(exploded_graph::process_node) <case PK_BEFORE_SUPERNODE>:\n\tSimplify by using program_point::get_next.\n\t* program-point.cc (program_point::get_next): New.\n\t* program-point.h (program_point::get_next): New decl.", "tree": {"sha": "70e496d98dccdbfea0cccc8b6ae281e869dc28f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/70e496d98dccdbfea0cccc8b6ae281e869dc28f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6dd96e24ea3cb9919fedd4da35fbfd36ed98b0ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6dd96e24ea3cb9919fedd4da35fbfd36ed98b0ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6dd96e24ea3cb9919fedd4da35fbfd36ed98b0ea"}], "stats": {"total": 55, "additions": 35, "deletions": 20}, "files": [{"sha": "5903b19b7744a5c26962bd97ef19cfc5440bd069", "filename": "gcc/analyzer/engine.cc", "status": "modified", "additions": 4, "deletions": 20, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0/gcc%2Fanalyzer%2Fengine.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0/gcc%2Fanalyzer%2Fengine.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fengine.cc?ref=b9b5fc0c2175b34131d9fd0805b1b307f754f4f0", "patch": "@@ -2458,26 +2458,10 @@ exploded_graph::process_node (exploded_node *node)\n \t\t &ctxt);\n \t  }\n \n-\tif (point.get_supernode ()->m_stmts.length () > 0)\n-\t  {\n-\t    program_point next_point\n-\t      = program_point::before_stmt (point.get_supernode (), 0,\n-\t\t\t\t\t    point.get_call_string ());\n-\t    exploded_node *next\n-\t      = get_or_create_node (next_point, next_state, node);\n-\t    if (next)\n-\t      add_edge (node, next, NULL);\n-\t  }\n-\telse\n-\t  {\n-\t    program_point next_point\n-\t      = program_point::after_supernode (point.get_supernode (),\n-\t\t\t\t\t\tpoint.get_call_string ());\n-\t    exploded_node *next = get_or_create_node (next_point, next_state,\n-\t\t\t\t\t\t      node);\n-\t    if (next)\n-\t      add_edge (node, next, NULL);\n-\t  }\n+\tprogram_point next_point (point.get_next ());\n+\texploded_node *next = get_or_create_node (next_point, next_state, node);\n+\tif (next)\n+\t  add_edge (node, next, NULL);\n       }\n       break;\n     case PK_BEFORE_STMT:"}, {"sha": "ef19e6e38e576f71d121b1c347d2f72c6a339c1b", "filename": "gcc/analyzer/program-point.cc", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0/gcc%2Fanalyzer%2Fprogram-point.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0/gcc%2Fanalyzer%2Fprogram-point.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fprogram-point.cc?ref=b9b5fc0c2175b34131d9fd0805b1b307f754f4f0", "patch": "@@ -529,6 +529,35 @@ function_point::next_stmt ()\n     }\n }\n \n+/* For those program points for which there is a uniquely-defined\n+   successor, return it.  */\n+\n+program_point\n+program_point::get_next () const\n+{\n+  switch (m_function_point.get_kind ())\n+    {\n+    default:\n+      gcc_unreachable ();\n+    case PK_ORIGIN:\n+    case PK_AFTER_SUPERNODE:\n+      gcc_unreachable (); /* Not uniquely defined.  */\n+    case PK_BEFORE_SUPERNODE:\n+      if (get_supernode ()->m_stmts.length () > 0)\n+\treturn before_stmt (get_supernode (), 0, get_call_string ());\n+      else\n+\treturn after_supernode (get_supernode (), get_call_string ());\n+    case PK_BEFORE_STMT:\n+      {\n+\tunsigned next_idx = get_stmt_idx ();\n+\tif (next_idx < get_supernode ()->m_stmts.length ())\n+\t  return before_stmt (get_supernode (), next_idx, get_call_string ());\n+\telse\n+\t  return after_supernode (get_supernode (), get_call_string ());\n+      }\n+    }\n+}\n+\n #if CHECKING_P\n \n namespace selftest {"}, {"sha": "97fd0a5e9deea7a4b2a18da63f81a111f9a24c8d", "filename": "gcc/analyzer/program-point.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0/gcc%2Fanalyzer%2Fprogram-point.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b9b5fc0c2175b34131d9fd0805b1b307f754f4f0/gcc%2Fanalyzer%2Fprogram-point.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fprogram-point.h?ref=b9b5fc0c2175b34131d9fd0805b1b307f754f4f0", "patch": "@@ -294,6 +294,8 @@ class program_point\n   /* For before_stmt, go to next stmt.  */\n   void next_stmt () { m_function_point.next_stmt (); }\n \n+  program_point get_next () const;\n+\n  private:\n   function_point m_function_point;\n   call_string m_call_string;"}]}