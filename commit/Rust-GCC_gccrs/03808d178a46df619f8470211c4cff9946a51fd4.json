{"sha": "03808d178a46df619f8470211c4cff9946a51fd4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDM4MDhkMTc4YTQ2ZGY2MTlmODQ3MDIxMWM0Y2ZmOTk0NmE1MWZkNA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2011-05-09T17:34:44Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2011-05-09T17:34:44Z"}, "message": "re PR c++/34772 (self-initialisation does not silence uninitialised warnings (-Winit-self ignored))\n\n\tPR c++/34772\n\t* decl.c (initialize_local_var): Use DECL_INITIAL for simple\n\tinitialization.\n\nFrom-SVN: r173582", "tree": {"sha": "bae19d0639a05bedd77dd0624d652463792c9222", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bae19d0639a05bedd77dd0624d652463792c9222"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/03808d178a46df619f8470211c4cff9946a51fd4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03808d178a46df619f8470211c4cff9946a51fd4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03808d178a46df619f8470211c4cff9946a51fd4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03808d178a46df619f8470211c4cff9946a51fd4/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b5da71d41644c40db95aabac8f67c28294f4c85f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5da71d41644c40db95aabac8f67c28294f4c85f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5da71d41644c40db95aabac8f67c28294f4c85f"}], "stats": {"total": 54, "additions": 41, "deletions": 13}, "files": [{"sha": "4c4036ab3b9aecfaaa358f6bd549bb3f109b5d20", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=03808d178a46df619f8470211c4cff9946a51fd4", "patch": "@@ -1,3 +1,9 @@\n+2011-05-09  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/34772\n+\t* decl.c (initialize_local_var): Use DECL_INITIAL for simple\n+\tinitialization.\n+\n 2011-05-08  Ville Voutilainen  <ville.voutilainen@gmail.com>\n \n \tImplement final/override for member functions."}, {"sha": "c255e16c6dacca6c7c0f371d4e9d3ee8b9660897", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 24, "deletions": 13, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "patch": "@@ -5689,21 +5689,32 @@ initialize_local_var (tree decl, tree init)\n   /* Perform the initialization.  */\n   if (init)\n     {\n-      int saved_stmts_are_full_exprs_p;\n+      if (TREE_CODE (init) == INIT_EXPR\n+\t  && !TREE_SIDE_EFFECTS (TREE_OPERAND (init, 1)))\n+\t{\n+\t  /* Stick simple initializers in DECL_INITIAL so that\n+\t     -Wno-init-self works (c++/34772).  */\n+\t  gcc_assert (TREE_OPERAND (init, 0) == decl);\n+\t  DECL_INITIAL (decl) = TREE_OPERAND (init, 1);\n+\t}\n+      else\n+\t{\n+\t  int saved_stmts_are_full_exprs_p;\n \n-      /* If we're only initializing a single object, guard the destructors\n-\t of any temporaries used in its initializer with its destructor.\n-\t This isn't right for arrays because each element initialization is\n-\t a full-expression.  */\n-      if (cleanup && TREE_CODE (type) != ARRAY_TYPE)\n-\twrap_temporary_cleanups (init, cleanup);\n+\t  /* If we're only initializing a single object, guard the\n+\t     destructors of any temporaries used in its initializer with\n+\t     its destructor.  This isn't right for arrays because each\n+\t     element initialization is a full-expression.  */\n+\t  if (cleanup && TREE_CODE (type) != ARRAY_TYPE)\n+\t    wrap_temporary_cleanups (init, cleanup);\n \n-      gcc_assert (building_stmt_tree ());\n-      saved_stmts_are_full_exprs_p = stmts_are_full_exprs_p ();\n-      current_stmt_tree ()->stmts_are_full_exprs_p = 1;\n-      finish_expr_stmt (init);\n-      current_stmt_tree ()->stmts_are_full_exprs_p =\n-\tsaved_stmts_are_full_exprs_p;\n+\t  gcc_assert (building_stmt_tree ());\n+\t  saved_stmts_are_full_exprs_p = stmts_are_full_exprs_p ();\n+\t  current_stmt_tree ()->stmts_are_full_exprs_p = 1;\n+\t  finish_expr_stmt (init);\n+\t  current_stmt_tree ()->stmts_are_full_exprs_p =\n+\t    saved_stmts_are_full_exprs_p;\n+\t}\n     }\n \n   /* Set this to 0 so we can tell whether an aggregate which was"}, {"sha": "b30addc7390937f09a3b354402fef0c360ba4444", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=03808d178a46df619f8470211c4cff9946a51fd4", "patch": "@@ -1,3 +1,14 @@\n+2011-05-09  Jason Merrill  <jason@redhat.com>\n+\n+\t* gcc.dg/gcc.dg/uninit-D.c: Move to c-c++-common.\n+\t* gcc.dg/gcc.dg/uninit-D-O0.c: Move to c-c++-common.\n+\t* gcc.dg/gcc.dg/uninit-E.c: Move to c-c++-common.\n+\t* gcc.dg/gcc.dg/uninit-E-O0.c: Move to c-c++-common.\n+\t* gcc.dg/gcc.dg/uninit-F.c: Move to c-c++-common.\n+\t* gcc.dg/gcc.dg/uninit-F-O0.c: Move to c-c++-common.\n+\t* gcc.dg/gcc.dg/uninit-G.c: Move to c-c++-common.\n+\t* gcc.dg/gcc.dg/uninit-G-O0.c: Move to c-c++-common.\n+\n 2011-05-08  Ville Voutilainen  <ville.voutilainen@gmail.com>\n \n         * g++.dg/inherit/virtual9.C: New."}, {"sha": "e63cb80aee0f89a413ac74acfd19297715f54e09", "filename": "gcc/testsuite/c-c++-common/uninit-D-O0.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-D-O0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-D-O0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-D-O0.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-D-O0.c"}, {"sha": "ea957e49e98a9211df2c3c6aaae10909e472b8ef", "filename": "gcc/testsuite/c-c++-common/uninit-D.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-D.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-D.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-D.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-D.c"}, {"sha": "2cc2459663d0fe2aaa9856702adf42b4366c86be", "filename": "gcc/testsuite/c-c++-common/uninit-E-O0.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-E-O0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-E-O0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-E-O0.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-E-O0.c"}, {"sha": "eb356c3ee0d64c405ae12c1ce55dccc99ba3d189", "filename": "gcc/testsuite/c-c++-common/uninit-E.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-E.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-E.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-E.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-E.c"}, {"sha": "737cc65007ec6caaf38fc6748c969c7f090a0de8", "filename": "gcc/testsuite/c-c++-common/uninit-F-O0.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-F-O0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-F-O0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-F-O0.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-F-O0.c"}, {"sha": "1dbb365e5b70729f6146ffcd936c1adcbb0a3100", "filename": "gcc/testsuite/c-c++-common/uninit-F.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-F.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-F.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-F.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-F.c"}, {"sha": "d6edffede66d020146ea36f36186bb640a2e4386", "filename": "gcc/testsuite/c-c++-common/uninit-G-O0.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-G-O0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-G-O0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-G-O0.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-G-O0.c"}, {"sha": "08f5f532116097e214f331102be6cc680d31824a", "filename": "gcc/testsuite/c-c++-common/uninit-G.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-G.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03808d178a46df619f8470211c4cff9946a51fd4/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-G.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Funinit-G.c?ref=03808d178a46df619f8470211c4cff9946a51fd4", "previous_filename": "gcc/testsuite/gcc.dg/uninit-G.c"}]}