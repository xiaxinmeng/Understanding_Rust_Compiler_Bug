{"sha": "007a787db4538b34e254963ee27d43ea48cbb8c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDA3YTc4N2RiNDUzOGIzNGUyNTQ5NjNlZTI3ZDQzZWE0OGNiYjhjNg==", "commit": {"author": {"name": "Christian Bruel", "email": "chrbr@gcc.gnu.org", "date": "2012-04-19T09:06:53Z"}, "committer": {"name": "Christian Bruel", "email": "chrbr@gcc.gnu.org", "date": "2012-04-19T09:06:53Z"}, "message": "Fix #52283 error: case label does not reduce to an integer constant\n\nFrom-SVN: r186586", "tree": {"sha": "a89d5ad3ac4390a00e23584ee2bc15d40c7f3d1a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a89d5ad3ac4390a00e23584ee2bc15d40c7f3d1a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/007a787db4538b34e254963ee27d43ea48cbb8c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/007a787db4538b34e254963ee27d43ea48cbb8c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/007a787db4538b34e254963ee27d43ea48cbb8c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/007a787db4538b34e254963ee27d43ea48cbb8c6/comments", "author": null, "committer": null, "parents": [{"sha": "daa573866d655917328caec7debf2175e2a566f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/daa573866d655917328caec7debf2175e2a566f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/daa573866d655917328caec7debf2175e2a566f8"}], "stats": {"total": 48, "additions": 40, "deletions": 8}, "files": [{"sha": "7f3d9ac6b9a767d98a2e5ca82ae190bc42ab091e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=007a787db4538b34e254963ee27d43ea48cbb8c6", "patch": "@@ -1,3 +1,9 @@\n+2012-04-19   Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c/52283/37985\n+\t* stmt.c (warn_if_unused_value): Skip NOP_EXPR.\n+\t* convert.c (convert_to_integer): Don't set TREE_NO_WARNING.\n+\n 2012-04-19  Richard Guenther  <rguenther@suse.de>\n \n \tPR rtl-optimization/44688"}, {"sha": "339eefeea84a3f1b0a3ffedff8dc6e2adf76d532", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=007a787db4538b34e254963ee27d43ea48cbb8c6", "patch": "@@ -1692,6 +1692,7 @@ warn_if_unused_value (const_tree exp, location_t locus)\n \n     case SAVE_EXPR:\n     case NON_LVALUE_EXPR:\n+    case NOP_EXPR:\n       exp = TREE_OPERAND (exp, 0);\n       goto restart;\n "}, {"sha": "5e6b09e06545805374c87b117b9a2f1057d4e392", "filename": "gcc/convert.c", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Fconvert.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Fconvert.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconvert.c?ref=007a787db4538b34e254963ee27d43ea48cbb8c6", "patch": "@@ -537,7 +537,6 @@ convert_to_integer (tree type, tree expr)\n       else if (outprec >= inprec)\n \t{\n \t  enum tree_code code;\n-\t  tree tem;\n \n \t  /* If the precision of the EXPR's type is K bits and the\n \t     destination mode has more bits, and the sign is changing,\n@@ -555,13 +554,7 @@ convert_to_integer (tree type, tree expr)\n \t  else\n \t    code = NOP_EXPR;\n \n-\t  tem = fold_unary (code, type, expr);\n-\t  if (tem)\n-\t    return tem;\n-\n-\t  tem = build1 (code, type, expr);\n-\t  TREE_NO_WARNING (tem) = 1;\n-\t  return tem;\n+\t  return fold_build1 (code, type, expr);\n \t}\n \n       /* If TYPE is an enumeral type or a type with a precision less"}, {"sha": "e838343e3b7f2a13dfbdadde88255f2a64555083", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=007a787db4538b34e254963ee27d43ea48cbb8c6", "patch": "@@ -1,3 +1,11 @@\n+2012-04-19  Christian Bruel  <christian.bruel@st.com>\n+\n+\t* gcc.dg/pr52283.c: New test.\n+\n+2012-04-19   Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\t* gcc.dg/pr37985.c: New test.\n+\n 2012-04-19  Richard Guenther  <rguenther@suse.de>\n \n \tPR rtl-optimization/44688"}, {"sha": "93e640b4a36617818dcb7bd07cb7b840c1a7c107", "filename": "gcc/testsuite/gcc.dg/pr37985.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37985.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37985.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37985.c?ref=007a787db4538b34e254963ee27d43ea48cbb8c6", "patch": "@@ -0,0 +1,8 @@\n+/* PR c37985 */\n+/* { dg-do compile } */\n+/* { dg-options \" -Wall -Wextra \" } */\n+unsigned char foo(unsigned char a)\n+{\n+  a >> 2; /* { dg-warning \"no effect\" } */\n+  return a;\n+}"}, {"sha": "33785a598e2b5d038953db9f462595c9c6d8f619", "filename": "gcc/testsuite/gcc.dg/pr52283.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Ftestsuite%2Fgcc.dg%2Fpr52283.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/007a787db4538b34e254963ee27d43ea48cbb8c6/gcc%2Ftestsuite%2Fgcc.dg%2Fpr52283.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr52283.c?ref=007a787db4538b34e254963ee27d43ea48cbb8c6", "patch": "@@ -0,0 +1,16 @@\n+/* Test for case labels not integer constant expressions but folding\n+   to integer constants (used in Linux kernel).  */\n+/* { dg-do compile } */\n+\n+extern unsigned int u;\n+\n+void\n+b (int c)\n+{\n+  switch (c)\n+    {\n+    case (int) (2  | ((4 < 8) ? 8 : u)):\n+      ;\n+    }\n+}\n+"}]}