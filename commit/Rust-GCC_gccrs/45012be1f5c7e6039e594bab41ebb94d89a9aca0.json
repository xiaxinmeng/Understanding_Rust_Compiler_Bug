{"sha": "45012be1f5c7e6039e594bab41ebb94d89a9aca0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDUwMTJiZTFmNWM3ZTYwMzllNTk0YmFiNDFlYmI5NGQ4OWE5YWNhMA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2019-10-23T19:03:42Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2019-10-23T19:03:42Z"}, "message": "ipa-reference.c (varpool_removal_hook, [...]): Fix previous patch.\n\n\t* ipa-reference.c (varpool_removal_hook, ipa_reference_c_finalize): Fix\n\tprevious patch.\n\nFrom-SVN: r277347", "tree": {"sha": "1112f1bae8d7c8bc8df40c6249c2483ae9d3b023", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1112f1bae8d7c8bc8df40c6249c2483ae9d3b023"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/45012be1f5c7e6039e594bab41ebb94d89a9aca0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45012be1f5c7e6039e594bab41ebb94d89a9aca0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/45012be1f5c7e6039e594bab41ebb94d89a9aca0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45012be1f5c7e6039e594bab41ebb94d89a9aca0/comments", "author": null, "committer": null, "parents": [{"sha": "ebad2eeed903f7c9cf6c55d37be8af8c84f1cf32", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebad2eeed903f7c9cf6c55d37be8af8c84f1cf32", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ebad2eeed903f7c9cf6c55d37be8af8c84f1cf32"}], "stats": {"total": 11, "additions": 7, "deletions": 4}, "files": [{"sha": "d6c0c9ec6ee06cc5ded62cfcaf121706ce483acd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45012be1f5c7e6039e594bab41ebb94d89a9aca0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45012be1f5c7e6039e594bab41ebb94d89a9aca0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=45012be1f5c7e6039e594bab41ebb94d89a9aca0", "patch": "@@ -1,3 +1,8 @@\n+2019-10-23  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-reference.c (varpool_removal_hook, ipa_reference_c_finalize): Fix\n+\tprevious patch.\n+\n 2019-10-23  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* lto-streamer-out.c (output_constructor): Push CTORS_OUT timevar."}, {"sha": "87d583fff0fc1e8c5804c0324ca17cceeaa6087d", "filename": "gcc/ipa-reference.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/45012be1f5c7e6039e594bab41ebb94d89a9aca0/gcc%2Fipa-reference.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/45012be1f5c7e6039e594bab41ebb94d89a9aca0/gcc%2Fipa-reference.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-reference.c?ref=45012be1f5c7e6039e594bab41ebb94d89a9aca0", "patch": "@@ -436,9 +436,7 @@ propagate_bits (ipa_reference_global_vars_info_t x_global, struct cgraph_node *x\n static void\n varpool_removal_hook (varpool_node *node, void *)\n {\n-  int *id = ipa_reference_vars_map->get (node->decl)\n-  if (id)\n-    ipa_reference_vars_map->remove (*id);\n+  ipa_reference_vars_map->remove (node->decl);\n }\n \n static bool ipa_init_p = false;\n@@ -1291,7 +1289,7 @@ ipa_reference_c_finalize (void)\n       ipa_ref_opt_sum_summaries = NULL;\n       delete ipa_reference_vars_map;\n       ipa_reference_vars_map = NULL;\n-      symtab->remove_varpool_removal_hook (varpool_node_hooks)\n+      symtab->remove_varpool_removal_hook (varpool_node_hooks);\n     }\n \n   if (ipa_init_p)"}]}