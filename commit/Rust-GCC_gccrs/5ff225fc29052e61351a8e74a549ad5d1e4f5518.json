{"sha": "5ff225fc29052e61351a8e74a549ad5d1e4f5518", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWZmMjI1ZmMyOTA1MmU2MTM1MWE4ZTc0YTU0OWFkNWQxZTRmNTUxOA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2002-05-23T18:11:04Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2002-05-23T18:11:04Z"}, "message": "varasm.c (make_decl_rtl): Don't allow weak variables to be placed in common.\n\n\t* varasm.c (make_decl_rtl): Don't allow weak variables to be\n\tplaced in common.\n\n\t* gcc/testsuite/gcc.dg/weak-8.c: New test.\n\nFrom-SVN: r53798", "tree": {"sha": "8d96cee5f637f07d622e051d659a07f1f11da2df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8d96cee5f637f07d622e051d659a07f1f11da2df"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5ff225fc29052e61351a8e74a549ad5d1e4f5518", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ff225fc29052e61351a8e74a549ad5d1e4f5518", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5ff225fc29052e61351a8e74a549ad5d1e4f5518", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ff225fc29052e61351a8e74a549ad5d1e4f5518/comments", "author": null, "committer": null, "parents": [{"sha": "0f72964f10dd338c59e1ea8e8eee3a966154540d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f72964f10dd338c59e1ea8e8eee3a966154540d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f72964f10dd338c59e1ea8e8eee3a966154540d"}], "stats": {"total": 23, "additions": 23, "deletions": 0}, "files": [{"sha": "f90aa474507427294fcbe4d7f1d254f87ae1ad63", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5ff225fc29052e61351a8e74a549ad5d1e4f5518", "patch": "@@ -1,3 +1,8 @@\n+2002-05-23  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* varasm.c (make_decl_rtl): Don't allow weak variables to be\n+\tplaced in common.\n+\n Thu May 23 19:43:41 CEST 2002  Jan Hubicka  <jh@suse.cz>\n \n \t* cfg.c (dump_flow_info): Print results of"}, {"sha": "fb0340638ac249c1b94257e97c8879747b87543d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5ff225fc29052e61351a8e74a549ad5d1e4f5518", "patch": "@@ -1,3 +1,7 @@\n+2002-05-23  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* gcc/testsuite/gcc.dg/weak-8.c: New test.\n+\n Thu May 23 11:09:26 2002  J\"orn Rennecke <joern.rennecke@superh.com>\n \n \t* gcc.dg/weak-2.c: Allow optional leading underscore"}, {"sha": "9cfb51706aaa7ab0037c4521d010cc5ce13f24b5", "filename": "gcc/testsuite/gcc.dg/weak-8.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2Ftestsuite%2Fgcc.dg%2Fweak-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2Ftestsuite%2Fgcc.dg%2Fweak-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fweak-8.c?ref=5ff225fc29052e61351a8e74a549ad5d1e4f5518", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do assemble } */\n+\n+/* COFF does not support weak, and dg doesn't support UNSUPPORTED.  */\n+/* { dg-do assemble { xfail *-*-coff i?86-pc-cygwin h8300-*-hms } } */\n+\n+__attribute__ ((weak)) int i;\n+\n+int f() {\n+  return i;\n+}"}, {"sha": "8a7f949245ca2e5fa57167cc44e3c2a12d66dac0", "filename": "gcc/varasm.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ff225fc29052e61351a8e74a549ad5d1e4f5518/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=5ff225fc29052e61351a8e74a549ad5d1e4f5518", "patch": "@@ -922,6 +922,10 @@ make_decl_rtl (decl, asmspec)\n       && DECL_COMMON (decl))\n     DECL_COMMON (decl) = 0;\n \n+  /* Variables can't be both common and weak.  */\n+  if (TREE_CODE (decl) == VAR_DECL && DECL_WEAK (decl))\n+    DECL_COMMON (decl) = 0;\n+\n   /* Can't use just the variable's own name for a variable\n      whose scope is less than the whole file, unless it's a member\n      of a local class (which will already be unambiguous)."}]}