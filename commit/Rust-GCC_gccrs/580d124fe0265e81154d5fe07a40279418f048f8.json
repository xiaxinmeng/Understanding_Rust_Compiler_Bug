{"sha": "580d124fe0265e81154d5fe07a40279418f048f8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTgwZDEyNGZlMDI2NWU4MTE1NGQ1ZmUwN2E0MDI3OTQxOGYwNDhmOA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2004-07-03T13:45:29Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2004-07-03T13:45:29Z"}, "message": "tree-ssa.c (tree_ssa_useless_type_conversion): Also look at VIEW_CONVERT_EXPR and NON_LVALUE_EXPR.\n\n\t* tree-ssa.c (tree_ssa_useless_type_conversion): Also look at\n\tVIEW_CONVERT_EXPR and NON_LVALUE_EXPR.\n\t* tree-ssa-ccp.c (fold_stmt): Call just STRIP_USELESS_TYPE_CONVERSION.\n\t* tree-ssa-dom.c (local_fold): Likewise.\n\nFrom-SVN: r84054", "tree": {"sha": "34f13484cf58f62d24730cc46761b0c4d20b7ad2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/34f13484cf58f62d24730cc46761b0c4d20b7ad2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/580d124fe0265e81154d5fe07a40279418f048f8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/580d124fe0265e81154d5fe07a40279418f048f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/580d124fe0265e81154d5fe07a40279418f048f8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/580d124fe0265e81154d5fe07a40279418f048f8/comments", "author": null, "committer": null, "parents": [{"sha": "e30bb772cb02a5b523d036eaaa5a402a471d476b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e30bb772cb02a5b523d036eaaa5a402a471d476b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e30bb772cb02a5b523d036eaaa5a402a471d476b"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "53722270cc7a1eb64ebec339319c440a49c49df8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=580d124fe0265e81154d5fe07a40279418f048f8", "patch": "@@ -1,5 +1,10 @@\n 2004-07-03  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \t\n+\t* tree-ssa.c (tree_ssa_useless_type_conversion): Also look at\n+\tVIEW_CONVERT_EXPR and NON_LVALUE_EXPR.\n+\t* tree-ssa-ccp.c (fold_stmt): Call just STRIP_USELESS_TYPE_CONVERSION.\n+\t* tree-ssa-dom.c (local_fold): Likewise.\n+\n \t* langhooks-def.h (LANG_HOOKS_TYPE_MAX_SIZE): New langhook.\n \t* langhooks.h (strct lang_hooks): New field type_max_size.\n \t* function.c (assign_temp): Call it."}, {"sha": "0b990717b33ce5d28312d88a0e6f857c39f36c28", "filename": "gcc/tree-ssa-ccp.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2Ftree-ssa-ccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2Ftree-ssa-ccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-ccp.c?ref=580d124fe0265e81154d5fe07a40279418f048f8", "patch": "@@ -2086,7 +2086,6 @@ fold_stmt (tree *stmt_p)\n   /* Strip away useless type conversions.  Both the NON_LVALUE_EXPR that\n      may have been added by fold, and \"useless\" type conversions that might\n      now be apparent due to propagation.  */\n-  STRIP_MAIN_TYPE_NOPS (result);\n   STRIP_USELESS_TYPE_CONVERSION (result);\n \n   if (result != rhs)"}, {"sha": "b556b4eedf2440d1a8bf7cabffadb9cde46ad664", "filename": "gcc/tree-ssa-dom.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2Ftree-ssa-dom.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2Ftree-ssa-dom.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-dom.c?ref=580d124fe0265e81154d5fe07a40279418f048f8", "patch": "@@ -279,7 +279,6 @@ local_fold (tree t)\n   /* Strip away useless type conversions.  Both the NON_LVALUE_EXPR that\n      may have been added by fold, and \"useless\" type conversions that might\n      now be apparent due to propagation.  */\n-  STRIP_MAIN_TYPE_NOPS (t);\n   STRIP_USELESS_TYPE_CONVERSION (t);\n \n   return t;"}, {"sha": "4cdfd3ddf22902002a76d44313d16d99dc540dac", "filename": "gcc/tree-ssa.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2Ftree-ssa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/580d124fe0265e81154d5fe07a40279418f048f8/gcc%2Ftree-ssa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa.c?ref=580d124fe0265e81154d5fe07a40279418f048f8", "patch": "@@ -601,7 +601,9 @@ tree_ssa_useless_type_conversion (tree expr)\n      the top of the RHS to the type of the LHS and the type conversion\n      is \"safe\", then strip away the type conversion so that we can\n      enter LHS = RHS into the const_and_copies table.  */\n-  if (TREE_CODE (expr) == NOP_EXPR || TREE_CODE (expr) == CONVERT_EXPR)\n+  if (TREE_CODE (expr) == NOP_EXPR || TREE_CODE (expr) == CONVERT_EXPR\n+      || TREE_CODE (expr) == VIEW_CONVERT_EXPR\n+      || TREE_CODE (expr) == NON_LVALUE_EXPR)\n     return tree_ssa_useless_type_conversion_1 (TREE_TYPE (expr),\n \t\t\t\t\t       TREE_TYPE (TREE_OPERAND (expr,\n \t\t\t\t\t\t\t\t\t0)));"}]}