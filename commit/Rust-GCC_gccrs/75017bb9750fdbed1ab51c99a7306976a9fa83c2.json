{"sha": "75017bb9750fdbed1ab51c99a7306976a9fa83c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzUwMTdiYjk3NTBmZGJlZDFhYjUxYzk5YTczMDY5NzZhOWZhODNjMg==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2017-05-29T07:31:02Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2017-05-29T07:31:02Z"}, "message": "check_GNU_style.py: Read stdin if file argument is '-'\n\n2017-05-29  Tom de Vries  <tom@codesourcery.com>\n\n\t* check_GNU_style_lib.py (check_GNU_style_file): Treat file argument as\n\tfile handle.  Add and handle file_encoding argument.\n\t* check_GNU_style.py (main): Handle '-' file argument.  Call\n\tcheck_GNU_style_file with file handle as argument.\n\nFrom-SVN: r248555", "tree": {"sha": "c01f020ebfc7f2853ae2895bca929f360c8b5748", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c01f020ebfc7f2853ae2895bca929f360c8b5748"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/75017bb9750fdbed1ab51c99a7306976a9fa83c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75017bb9750fdbed1ab51c99a7306976a9fa83c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/75017bb9750fdbed1ab51c99a7306976a9fa83c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/75017bb9750fdbed1ab51c99a7306976a9fa83c2/comments", "author": null, "committer": null, "parents": [{"sha": "76baf5ca9d58cfde6c015cc1162c39a9aec60771", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76baf5ca9d58cfde6c015cc1162c39a9aec60771", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76baf5ca9d58cfde6c015cc1162c39a9aec60771"}], "stats": {"total": 22, "additions": 18, "deletions": 4}, "files": [{"sha": "d5b390c8c86a0750ae13b0e6ce2e70f313c211e1", "filename": "contrib/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75017bb9750fdbed1ab51c99a7306976a9fa83c2/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75017bb9750fdbed1ab51c99a7306976a9fa83c2/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=75017bb9750fdbed1ab51c99a7306976a9fa83c2", "patch": "@@ -1,3 +1,10 @@\n+2017-05-29  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* check_GNU_style_lib.py (check_GNU_style_file): Treat file argument as\n+\tfile handle.  Add and handle file_encoding argument.\n+\t* check_GNU_style.py (main): Handle '-' file argument.  Call\n+\tcheck_GNU_style_file with file handle as argument.\n+\n 2017-05-29  Tom de Vries  <tom@codesourcery.com>\n \n \t* check_GNU_style_lib.py: Use import_pip3 to import pip3 packages."}, {"sha": "61faa290fa101521431918d3911ad0c73c9b957d", "filename": "contrib/check_GNU_style.py", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75017bb9750fdbed1ab51c99a7306976a9fa83c2/contrib%2Fcheck_GNU_style.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75017bb9750fdbed1ab51c99a7306976a9fa83c2/contrib%2Fcheck_GNU_style.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fcheck_GNU_style.py?ref=75017bb9750fdbed1ab51c99a7306976a9fa83c2", "patch": "@@ -21,6 +21,7 @@\n # <http://www.gnu.org/licenses/>.  */\n \n import argparse\n+import sys\n from check_GNU_style_lib import check_GNU_style_file\n \n def main():\n@@ -30,6 +31,13 @@ def main():\n         help = 'Display format',\n         choices = ['stdio', 'quickfix'])\n     args = parser.parse_args()\n-    check_GNU_style_file(args.file, args.format)\n+    filename = args.file\n+    format = args.format\n+\n+    if filename == '-':\n+        check_GNU_style_file(sys.stdin, None, format)\n+    else:\n+        with open(filename, 'rb') as diff_file:\n+            check_GNU_style_file(diff_file, 'utf-8', format)\n \n main()"}, {"sha": "e1031dfcd929678479a381ae518f367192f32b23", "filename": "contrib/check_GNU_style_lib.py", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/75017bb9750fdbed1ab51c99a7306976a9fa83c2/contrib%2Fcheck_GNU_style_lib.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/75017bb9750fdbed1ab51c99a7306976a9fa83c2/contrib%2Fcheck_GNU_style_lib.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fcheck_GNU_style_lib.py?ref=75017bb9750fdbed1ab51c99a7306976a9fa83c2", "patch": "@@ -223,16 +223,15 @@ def test_line_length_check_basic(self):\n         self.assertEqual(r.console_error,\n             self.check.limit * 'a' + error_string(' = 123;'))\n \n-def check_GNU_style_file(file, format):\n+def check_GNU_style_file(file, file_encoding, format):\n     checks = [LineLengthCheck(), SpacesCheck(), TrailingWhitespaceCheck(),\n         SentenceSeparatorCheck(), SentenceEndOfCommentCheck(),\n         SentenceDotEndCheck(), FunctionParenthesisCheck(),\n         SquareBracketCheck(), ClosingParenthesisCheck(),\n         BracesOnSeparateLineCheck(), TrailinigOperatorCheck()]\n     errors = []\n \n-    with open(file, 'rb') as diff_file:\n-        patch = PatchSet(diff_file, encoding = 'utf-8')\n+    patch = PatchSet(file, encoding=file_encoding)\n \n     for pfile in patch.added_files + patch.modified_files:\n         t = pfile.target_file.lstrip('b/')"}]}