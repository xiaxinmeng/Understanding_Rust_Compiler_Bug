{"sha": "32f86f2b54dc97cb6a40edef421b6a30c3bd1c04", "node_id": "C_kwDOANBUbNoAKDMyZjg2ZjJiNTRkYzk3Y2I2YTQwZWRlZjQyMWI2YTMwYzNiZDFjMDQ", "commit": {"author": {"name": "Jiawei", "email": "jiawei@iscas.ac.cn", "date": "2022-09-08T01:50:49Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2022-09-30T15:09:16Z"}, "message": "RISC-V: Add '-m[no]-csr-check' option in gcc.\n\nAdd -m[no]-csr-check option in gcc part, when enable -mcsr-check option,\nit will add csr-check in .option section and pass this to assembler.\n\ngcc/ChangeLog:\n\n\t* config/riscv/riscv.cc (riscv_file_start): New .option.\n\t* config/riscv/riscv.opt: New options.\n\t* doc/invoke.texi: New definations.", "tree": {"sha": "1500e2972004b198efe625515ea966a34c3a355b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1500e2972004b198efe625515ea966a34c3a355b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04/comments", "author": {"login": "pz9115", "id": 43362020, "node_id": "MDQ6VXNlcjQzMzYyMDIw", "avatar_url": "https://avatars.githubusercontent.com/u/43362020?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pz9115", "html_url": "https://github.com/pz9115", "followers_url": "https://api.github.com/users/pz9115/followers", "following_url": "https://api.github.com/users/pz9115/following{/other_user}", "gists_url": "https://api.github.com/users/pz9115/gists{/gist_id}", "starred_url": "https://api.github.com/users/pz9115/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pz9115/subscriptions", "organizations_url": "https://api.github.com/users/pz9115/orgs", "repos_url": "https://api.github.com/users/pz9115/repos", "events_url": "https://api.github.com/users/pz9115/events{/privacy}", "received_events_url": "https://api.github.com/users/pz9115/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1e2c124d71ac051373a30495793883c45bcc5415", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e2c124d71ac051373a30495793883c45bcc5415", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e2c124d71ac051373a30495793883c45bcc5415"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "200ad6031fd4294397822c3e484b4df21ded9686", "filename": "gcc/config/riscv/riscv.cc", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04/gcc%2Fconfig%2Friscv%2Friscv.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04/gcc%2Fconfig%2Friscv%2Friscv.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.cc?ref=32f86f2b54dc97cb6a40edef421b6a30c3bd1c04", "patch": "@@ -5440,6 +5440,11 @@ riscv_file_start (void)\n   if (! riscv_mrelax)\n     fprintf (asm_out_file, \"\\t.option norelax\\n\");\n \n+  /* If the user specifies \"-mcsr-check\" on the command line then enable csr\n+     check in the assembler.  */\n+  if (riscv_mcsr_check)\n+    fprintf (asm_out_file, \"\\t.option csr-check\\n\");\n+\n   if (riscv_emit_attribute_p)\n     riscv_emit_attribute ();\n }"}, {"sha": "8923a11a97df0bfcb152aac66b435162456819ca", "filename": "gcc/config/riscv/riscv.opt", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04/gcc%2Fconfig%2Friscv%2Friscv.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04/gcc%2Fconfig%2Friscv%2Friscv.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.opt?ref=32f86f2b54dc97cb6a40edef421b6a30c3bd1c04", "patch": "@@ -132,6 +132,12 @@ Target Bool Var(riscv_mrelax) Init(1)\n Take advantage of linker relaxations to reduce the number of instructions\n required to materialize symbol addresses.\n \n+mcsr-check\n+Target Bool Var(riscv_mcsr_check) Init(0)\n+Enable the CSR checking for the ISA-dependent CRS and the read-only CSR.\n+The ISA-dependent CSR are only valid when the specific ISA is set.  The\n+read-only CSR can not be written by the CSR instructions.\n+\n Mask(64BIT)\n \n Mask(MUL)"}, {"sha": "a5dc63778356d6cee928cd61b950250f25f78ee1", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32f86f2b54dc97cb6a40edef421b6a30c3bd1c04/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=32f86f2b54dc97cb6a40edef421b6a30c3bd1c04", "patch": "@@ -1226,6 +1226,7 @@ See RS/6000 and PowerPC Options.\n -mbig-endian  -mlittle-endian @gol\n -mstack-protector-guard=@var{guard}  -mstack-protector-guard-reg=@var{reg} @gol\n -mstack-protector-guard-offset=@var{offset}}\n+-mcsr-check -mno-csr-check @gol\n \n @emph{RL78 Options}\n @gccoptlist{-msim  -mmul=none  -mmul=g13  -mmul=g14  -mallregs @gol\n@@ -28605,6 +28606,11 @@ linker relaxations.\n Emit (do not emit) RISC-V attribute to record extra information into ELF\n objects.  This feature requires at least binutils 2.32.\n \n+@item -mcsr-check\n+@itemx -mno-csr-check\n+@opindex mcsr-check\n+Enables or disables the CSR checking.\n+\n @item -malign-data=@var{type}\n @opindex malign-data\n Control how GCC aligns variables and constants of array, structure, or union"}]}