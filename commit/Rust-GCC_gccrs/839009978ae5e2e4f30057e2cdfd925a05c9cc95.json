{"sha": "839009978ae5e2e4f30057e2cdfd925a05c9cc95", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODM5MDA5OTc4YWU1ZTJlNGYzMDA1N2UyY2RmZDkyNWEwNWM5Y2M5NQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2006-01-23T21:50:15Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2006-01-23T21:50:15Z"}, "message": "re PR preprocessor/25717 (-dD does not list all defined macros (in particular, __STDC__))\n\n\tPR preprocessor/25717\n\t* init.c (cpp_init_builtins): If __STDC__ will not change value\n\tbetween system headers and other sources, define it as a normal\n\tmacro rather than a builtin.\n\t* macro.c (_cpp_builtin_macro_text) <case BT_STDC>: Only check\n\tcpp_in_system_header condition.\n\nFrom-SVN: r110144", "tree": {"sha": "426b4cdfa24c0b381ad5f2bef8e8807afd097204", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/426b4cdfa24c0b381ad5f2bef8e8807afd097204"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/839009978ae5e2e4f30057e2cdfd925a05c9cc95", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/839009978ae5e2e4f30057e2cdfd925a05c9cc95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/839009978ae5e2e4f30057e2cdfd925a05c9cc95", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/839009978ae5e2e4f30057e2cdfd925a05c9cc95/comments", "author": null, "committer": null, "parents": [{"sha": "7ebaeab50e26463a6fbe6fe23cffdf69a84bce30", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ebaeab50e26463a6fbe6fe23cffdf69a84bce30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ebaeab50e26463a6fbe6fe23cffdf69a84bce30"}], "stats": {"total": 33, "additions": 22, "deletions": 11}, "files": [{"sha": "3a4885fc950b978f98f645338bc3a839f1c7779d", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/839009978ae5e2e4f30057e2cdfd925a05c9cc95/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/839009978ae5e2e4f30057e2cdfd925a05c9cc95/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=839009978ae5e2e4f30057e2cdfd925a05c9cc95", "patch": "@@ -1,4 +1,13 @@\n-2006-02-05  Paolo Bonzini  <bonzini@gnu.org>\n+2006-01-23  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR preprocessor/25717\n+\t* init.c (cpp_init_builtins): If __STDC__ will not change value\n+\tbetween system headers and other sources, define it as a normal\n+\tmacro rather than a builtin.\n+\t* macro.c (_cpp_builtin_macro_text) <case BT_STDC>: Only check\n+\tcpp_in_system_header condition.\n+\n+2006-01-05  Paolo Bonzini  <bonzini@gnu.org>\n \n \t* Makefile.in: Use -MMD instead of -MD.\n "}, {"sha": "bf4c34cf5dc7892e1f55bcf78621ee029cc62483", "filename": "libcpp/init.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/839009978ae5e2e4f30057e2cdfd925a05c9cc95/libcpp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/839009978ae5e2e4f30057e2cdfd925a05c9cc95/libcpp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Finit.c?ref=839009978ae5e2e4f30057e2cdfd925a05c9cc95", "patch": "@@ -357,8 +357,14 @@ cpp_init_builtins (cpp_reader *pfile, int hosted)\n \n   if (CPP_OPTION (pfile, traditional))\n     n -= 2;\n+  else if (! CPP_OPTION (pfile, stdc_0_in_system_headers)\n+\t   || CPP_OPTION (pfile, std))\n+    {\n+      n--;\n+      _cpp_define_builtin (pfile, \"__STDC__ 1\");\n+    }\n \n-  for(b = builtin_array; b < builtin_array + n; b++)\n+  for (b = builtin_array; b < builtin_array + n; b++)\n     {\n       cpp_hashnode *hp = cpp_lookup (pfile, b->name, b->len);\n       hp->type = NT_MACRO;"}, {"sha": "3204e553b02e1cf64d29136025710ec6aad60542", "filename": "libcpp/macro.c", "status": "modified", "additions": 5, "deletions": 9, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/839009978ae5e2e4f30057e2cdfd925a05c9cc95/libcpp%2Fmacro.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/839009978ae5e2e4f30057e2cdfd925a05c9cc95/libcpp%2Fmacro.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fmacro.c?ref=839009978ae5e2e4f30057e2cdfd925a05c9cc95", "patch": "@@ -169,16 +169,12 @@ _cpp_builtin_macro_text (cpp_reader *pfile, cpp_hashnode *node)\n \t However, if (a) we are in a system header, (b) the option\n \t stdc_0_in_system_headers is true (set by target config), and\n \t (c) we are not in strictly conforming mode, then it has the\n-\t value 0.  */\n+\t value 0.  (b) and (c) are already checked in cpp_init_builtins.  */\n     case BT_STDC:\n-      {\n-\tif (cpp_in_system_header (pfile)\n-\t    && CPP_OPTION (pfile, stdc_0_in_system_headers)\n-\t    && !CPP_OPTION (pfile,std))\n-\t  number = 0;\n-\telse\n-\t  number = 1;\n-      }\n+      if (cpp_in_system_header (pfile))\n+\tnumber = 0;\n+      else\n+\tnumber = 1;\n       break;\n \n     case BT_DATE:"}]}