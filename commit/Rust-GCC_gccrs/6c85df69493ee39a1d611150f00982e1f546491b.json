{"sha": "6c85df69493ee39a1d611150f00982e1f546491b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmM4NWRmNjk0OTNlZTM5YTFkNjExMTUwZjAwOTgyZTFmNTQ2NDkxYg==", "commit": {"author": {"name": "Andrew Haley", "email": "aph@cygnus.com", "date": "1999-11-22T14:20:35Z"}, "committer": {"name": "Andrew Haley", "email": "aph@gcc.gnu.org", "date": "1999-11-22T14:20:35Z"}, "message": "varasm.c (function_defined): Remove.\n\n1999-11-22  Andrew Haley  <aph@cygnus.com>\n\n        * varasm.c (function_defined): Remove.\n        (make_function_rtl): Don't set function_defined.\n        (make_decl_rtl): Remove global register warning.\n        * regclass.c (no_global_reg_vars): New variable.\n        (globalize_reg): Warn if function has already been defined.\n        (regclass_init): Set no_global_reg_vars.\n\nFrom-SVN: r30611", "tree": {"sha": "83e25ee33818de7dc432efb7853fb333b22ae4c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/83e25ee33818de7dc432efb7853fb333b22ae4c1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6c85df69493ee39a1d611150f00982e1f546491b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c85df69493ee39a1d611150f00982e1f546491b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c85df69493ee39a1d611150f00982e1f546491b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c85df69493ee39a1d611150f00982e1f546491b/comments", "author": null, "committer": null, "parents": [{"sha": "9ffc5a70f84fad33a63d085225e7c2b78ae6dc01", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ffc5a70f84fad33a63d085225e7c2b78ae6dc01", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ffc5a70f84fad33a63d085225e7c2b78ae6dc01"}], "stats": {"total": 30, "additions": 20, "deletions": 10}, "files": [{"sha": "6cec51c1c289490adf7be3c8a21f920cd35871a1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c85df69493ee39a1d611150f00982e1f546491b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c85df69493ee39a1d611150f00982e1f546491b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6c85df69493ee39a1d611150f00982e1f546491b", "patch": "@@ -1,3 +1,12 @@\n+1999-11-22  Andrew Haley  <aph@cygnus.com>\n+\n+        * varasm.c (function_defined): Remove.\n+        (make_function_rtl): Don't set function_defined.\n+        (make_decl_rtl): Remove global register warning.\n+        * regclass.c (no_global_reg_vars): New variable.\n+        (globalize_reg): Warn if function has already been defined.\n+        (regclass_init): Set no_global_reg_vars.\n+\n Mon Nov 22 14:42:22 MET 1999  Jan Hubicka  <hubicka@freesoft.cz>\n \n \t* regclass.c (reg_pref): New structure and static variable"}, {"sha": "cba13c48033772189deb607fe6ee5f5c3a5d900b", "filename": "gcc/regclass.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c85df69493ee39a1d611150f00982e1f546491b/gcc%2Fregclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c85df69493ee39a1d611150f00982e1f546491b/gcc%2Fregclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fregclass.c?ref=6c85df69493ee39a1d611150f00982e1f546491b", "patch": "@@ -218,6 +218,11 @@ struct reg_info_data {\n \n static struct reg_info_data *reg_info_head;\n \n+/* No more global register vairiables may be declared; true once\n+   regclass has been initialized. */\n+\n+static int no_global_reg_vars = 0;\n+\n \n /* Function called only once to initialize the above data on reg usage.\n    Once this is done, various switches may override.  */\n@@ -625,6 +630,9 @@ void\n globalize_reg (i)\n      int i;\n {\n+  if (no_global_reg_vars)\n+    error (\"global register variable follows a function definition\");\n+\n   if (global_regs[i])\n     {\n       warning (\"register used for two global register variables\");\n@@ -758,6 +766,9 @@ regclass_init ()\n   /* This prevents dump_flow_info from losing if called\n      before regclass is run.  */\n   reg_pref = NULL;\n+\n+  /* No more global register vairiables may be declared. */\n+  no_global_reg_vars = 1;\n }\n \f\n /* Dump register costs.  */"}, {"sha": "aca7a074d433fa5ef51d896e9c3b5f880ce09056", "filename": "gcc/varasm.c", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c85df69493ee39a1d611150f00982e1f546491b/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c85df69493ee39a1d611150f00982e1f546491b/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=6c85df69493ee39a1d611150f00982e1f546491b", "patch": "@@ -149,10 +149,6 @@ int size_directive_output;\n \n tree last_assemble_variable_decl;\n \n-/* Nonzero if at least one function definition has been seen.  */\n-\n-static int function_defined;\n-\n static const char *strip_reg_name\tPROTO((const char *));\n static int contains_pointers_p\t\tPROTO((tree));\n static void decode_addr_const\t\tPROTO((tree, struct addr_const *));\n@@ -579,9 +575,6 @@ make_function_rtl (decl)\n \tENCODE_SECTION_INFO (decl);\n #endif\n     }\n-\n-  /* Record at least one function has been defined.  */\n-  function_defined = 1;\n }\n \n /* Given NAME, a putative register name, discard any customary prefixes.  */\n@@ -729,9 +722,6 @@ make_decl_rtl (decl, asmspec, top_level)\n \t      DECL_INITIAL (decl) = 0;\n \t      error (\"global register variable has initial value\");\n \t    }\n-\t  if (fixed_regs[reg_number] == 0\n-\t      && function_defined && top_level)\n-\t    error (\"global register variable follows a function definition\");\n \t  if (TREE_THIS_VOLATILE (decl))\n \t    warning (\"volatile register variables don't work as you might wish\");\n "}]}