{"sha": "8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGZhNTQ2OWQzOGI3ZTI3ZjdmODk3ZmJlNzU2ZDI5MDJiNTRiNGRlNQ==", "commit": {"author": {"name": "Devang Patel", "email": "dpatel@apple.com", "date": "2004-08-12T21:32:56Z"}, "committer": {"name": "Devang Patel", "email": "dpatel@gcc.gnu.org", "date": "2004-08-12T21:32:56Z"}, "message": "dbxout.c (dbxout_begin_prologue): New function.\n\n        * dbxout.c (dbxout_begin_prologue): New function.\n        (dbx_debug_hooks): Use new begin prologue hook.\n        (dbxout_function_end): Emit N_ENSYM.\n        * stab.def (N_BNSYM, N_ENSYM): Define and document these two new stabs.\n\n        testsuite:\n        gcc.dg/darwin-20040809-2.c: New test.\n\nFrom-SVN: r85908", "tree": {"sha": "85c5760826de54f9a125455e8e36d8ebb96299eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/85c5760826de54f9a125455e8e36d8ebb96299eb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/comments", "author": null, "committer": null, "parents": [{"sha": "950a175b04eda2cdcea01a61a3c4a09a23b6d2c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/950a175b04eda2cdcea01a61a3c4a09a23b6d2c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/950a175b04eda2cdcea01a61a3c4a09a23b6d2c6"}], "stats": {"total": 54, "additions": 50, "deletions": 4}, "files": [{"sha": "7ddf1acd3fc9f5e77576ba8ba8fb873ad3407471", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "patch": "@@ -1,3 +1,10 @@\n+2004-08-12  Devang patel  <dpatel@apple.com>\n+\n+\t* dbxout.c (dbxout_begin_prologue): New function.\n+\t(dbx_debug_hooks): Use new begin prologue hook.\n+\t(dbxout_function_end): Emit N_ENSYM.\n+\t* stab.def (N_BNSYM, N_ENSYM): Define and document these two new stabs.\n+\t\n 2004-08-12  Janis Johnson  <janis187@us.ibm.com>\n \n \t* config/rs6000/altivec.h (vec_dst): Fix C++ functions whose first"}, {"sha": "55f2275094f9cf7c4f45f0a34468abf003c29fe2", "filename": "gcc/dbxout.c", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Fdbxout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Fdbxout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdbxout.c?ref=8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "patch": "@@ -372,6 +372,7 @@ static void dbxout_handle_pch (unsigned);\n #if defined (DBX_DEBUGGING_INFO)\n \n static void dbxout_source_line (unsigned int, const char *);\n+static void dbxout_begin_prologue (unsigned int, const char *);\n static void dbxout_source_file (FILE *, const char *);\n static void dbxout_function_end (void);\n static void dbxout_begin_function (tree);\n@@ -391,8 +392,7 @@ const struct gcc_debug_hooks dbx_debug_hooks =\n   dbxout_end_block,\n   debug_true_tree,\t\t         /* ignore_block */\n   dbxout_source_line,\t\t         /* source_line */\n-  dbxout_source_line,\t\t         /* begin_prologue: just output \n-\t\t\t\t\t    line info */\n+  dbxout_begin_prologue,\t         /* begin_prologue */\n   debug_nothing_int_charstar,\t         /* end_prologue */\n   debug_nothing_int_charstar,\t         /* end_epilogue */\n #ifdef DBX_FUNCTION_FIRST\n@@ -481,6 +481,9 @@ dbxout_function_end (void)\n   assemble_name (asmfile, XSTR (XEXP (DECL_RTL (current_function_decl), 0), 0));\n   fprintf (asmfile, \"\\n\");\n #endif\n+\n+  if (!flag_debug_only_used_symbols)\n+    fprintf (asmfile, \"%s%d,0,0\\n\", ASM_STABD_OP, N_ENSYM);\n }\n #endif /* DBX_DEBUGGING_INFO */\n \n@@ -753,6 +756,17 @@ dbxout_source_file (FILE *file, const char *filename)\n     }\n }\n \n+/* Output N_BNSYM and line number symbol entry.  */\n+\n+static void\n+dbxout_begin_prologue (unsigned int lineno, const char *filename)\n+{\n+  if (!flag_debug_only_used_symbols)\n+    fprintf (asmfile, \"%s%d,0,0\\n\", ASM_STABD_OP, N_BNSYM);\n+\n+  dbxout_source_line (lineno, filename);\n+}\n+\n /* Output a line number symbol entry for source file FILENAME and line\n    number LINENO.  */\n "}, {"sha": "2d5896162359b3d12d6c28edd5c4ccd8354de4b7", "filename": "gcc/stab.def", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Fstab.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Fstab.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstab.def?ref=8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "patch": "@@ -39,6 +39,12 @@ __define_stab (N_STSYM, 0x26, \"STSYM\")\n /* BSS-segment variable with internal linkage.  Value is its address.  */\n __define_stab (N_LCSYM, 0x28, \"LCSYM\")\n \n+/* Begin function marker.  */\n+__define_stab (N_BNSYM, 0x2e, \"BNSYM\")\n+\n+/* End function marker.  */\n+__define_stab (N_ENSYM, 0x4e, \"ENSYM\")\n+\n /* Name of main routine.  Only the name is significant.\n    This is not used in C.  */\n __define_stab (N_MAIN, 0x2a, \"MAIN\")\n@@ -201,11 +207,11 @@ __define_stab (N_LENG, 0xfe, \"LENG\")\n \t|_______________________________________________|\n \t| Debug entries with bit 01 set are unused.\t|\n \t| 20 GSYM   | 22 FNAME\t| 24 FUN    | 26 STSYM\t|\n-\t| 28 LCSYM  | 2A MAIN\t| 2C\t    | 2E\t|\n+\t| 28 LCSYM  | 2A MAIN\t| 2C\t    | 2E BNSYM\t|\n \t| 30 PC\t    | 32 NSYMS\t| 34 NOMAP  | 36\t|\n \t| 38 OBJ    | 3A\t| 3C OPT    | 3E\t|\n \t| 40 RSYM   | 42 M2C\t| 44 SLINE  | 46 DSLINE |\n-\t| 48 BSLINE*| 4A DEFD\t| 4C        | 4E\t|\n+\t| 48 BSLINE*| 4A DEFD\t| 4C        | 4E ENSYM\t|\n \t| 50 EHDECL*| 52\t| 54 CATCH  | 56        |\n \t| 58        | 5A        | 5C        | 5E\t|\n \t| 60 SSYM   | 62\t| 64 SO\t    | 66 \t|"}, {"sha": "73d9c13ab24937f4c6fa72477bcd2d798ad78c34", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "patch": "@@ -1,3 +1,7 @@\n+2004-08-12  Devang patel  <dpatel@apple.com>\n+\n+\t* gcc.dg/darwin-20040809-2.c: New test.\n+\t\n 2004-08-12  Janis Johnson  <janis1872us.ibm.com>\n \n \t* g++.dg/ext/altivec-12.C: New test."}, {"sha": "5ed27a4363a4ad70a4f405055c07d4f02ae82c39", "filename": "gcc/testsuite/gcc.dg/darwin-20040809-2.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Ftestsuite%2Fgcc.dg%2Fdarwin-20040809-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fa5469d38b7e27f7f897fbe756d2902b54b4de5/gcc%2Ftestsuite%2Fgcc.dg%2Fdarwin-20040809-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdarwin-20040809-2.c?ref=8fa5469d38b7e27f7f897fbe756d2902b54b4de5", "patch": "@@ -0,0 +1,15 @@\n+/* Test dead code strip support.  */\n+/* Contributed by Devang Patel  <dpatel@apple.com>  */\n+\n+/* { dg-do compile { target *-*-darwin* } } */\n+/* { dg-options \"-g -fno-eliminate-unused-debug-symbols\" } */\n+\n+int\n+main ()\n+{\n+  return 0;\n+}\n+\n+/* { dg-final { scan-assembler \".stabd.46,0,0\" } } */\n+/* { dg-final { scan-assembler \".stabd.78,0,0\" } } */\n+"}]}