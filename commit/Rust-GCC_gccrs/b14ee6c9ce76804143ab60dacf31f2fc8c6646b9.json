{"sha": "b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjE0ZWU2YzljZTc2ODA0MTQzYWI2MGRhY2YzMWYyZmM4YzY2NDZiOQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rdsandiford@googlemail.com", "date": "2011-04-17T17:29:52Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2011-04-17T17:29:52Z"}, "message": "mips.c (mips_cfun_call_saved_reg_p): Handle global registers.\n\ngcc/\n\t* config/mips/mips.c (mips_cfun_call_saved_reg_p): Handle global\n\tregisters.\n\ngcc/testsuite/\n\t* gcc.target/mips/reg-var-1.c: New test.\n\nFrom-SVN: r172616", "tree": {"sha": "5af1c9d0f424d607112b994578164ecde106a9f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5af1c9d0f424d607112b994578164ecde106a9f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/comments", "author": {"login": "rsandifo", "id": 4235983, "node_id": "MDQ6VXNlcjQyMzU5ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/4235983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo", "html_url": "https://github.com/rsandifo", "followers_url": "https://api.github.com/users/rsandifo/followers", "following_url": "https://api.github.com/users/rsandifo/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo/orgs", "repos_url": "https://api.github.com/users/rsandifo/repos", "events_url": "https://api.github.com/users/rsandifo/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "10158cd3db8e8a64c39661418ec6ac1a57cdb092", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/10158cd3db8e8a64c39661418ec6ac1a57cdb092", "html_url": "https://github.com/Rust-GCC/gccrs/commit/10158cd3db8e8a64c39661418ec6ac1a57cdb092"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "4212388a4b4034fada71b0f4d13924481f23d9fc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "patch": "@@ -1,3 +1,8 @@\n+2011-04-17  Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\t* config/mips/mips.c (mips_cfun_call_saved_reg_p): Handle global\n+\tregisters.\n+\n 2011-04-17  Jan Hubicka  <jh@suse.cz>\n \n \t* cgrpah.h (struct cgraph_node): Remove finalized_by_frontend."}, {"sha": "e075c4f26485355ae66baa3a8f51e1c0759d0877", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "patch": "@@ -9097,6 +9097,11 @@ mips_interrupt_extra_call_saved_reg_p (unsigned int regno)\n static bool\n mips_cfun_call_saved_reg_p (unsigned int regno)\n {\n+  /* If the user makes an ordinarily-call-saved register global,\n+     that register is no longer call-saved.  */\n+  if (global_regs[regno])\n+    return false;\n+\n   /* Interrupt handlers need to save extra registers.  */\n   if (cfun->machine->interrupt_handler_p\n       && mips_interrupt_extra_call_saved_reg_p (regno))"}, {"sha": "fa74ad298ff412dc703d63cfa6b83af3fc24381a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "patch": "@@ -1,3 +1,7 @@\n+2011-04-17  Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\t* gcc.target/mips/reg-var-1.c: New test.\n+\n 2011-04-17  Jan Hubicka  <jh@suse.cz>\n \n \t* gcc.dg/winline-5.c: Update testcase."}, {"sha": "d8b8118103ac503c72b172acd21d5eecd9750875", "filename": "gcc/testsuite/gcc.target/mips/reg-var-1.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Freg-var-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b14ee6c9ce76804143ab60dacf31f2fc8c6646b9/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Freg-var-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Freg-var-1.c?ref=b14ee6c9ce76804143ab60dacf31f2fc8c6646b9", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-do run } */\n+register int g asm (\"$18\");\n+\n+void __attribute__((noinline))\n+test (void)\n+{\n+  g = g + 1;\n+}\n+\n+int\n+main (void)\n+{\n+  g = 2;\n+  test ();\n+  return g != 3;\n+}"}]}