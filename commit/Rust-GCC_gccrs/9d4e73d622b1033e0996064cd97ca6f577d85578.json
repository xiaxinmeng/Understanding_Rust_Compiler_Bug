{"sha": "9d4e73d622b1033e0996064cd97ca6f577d85578", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWQ0ZTczZDYyMmIxMDMzZTA5OTYwNjRjZDk3Y2E2ZjU3N2Q4NTU3OA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-05-29T02:44:55Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-05-29T02:44:55Z"}, "message": "(init...\n\n(init, compstmt, stmt, all_iter_stmt_with_decl): If the lookahead\ntoken is a constant and we need to pop the momentary obstack, don't\nfree it.\n\nFrom-SVN: r7382", "tree": {"sha": "894cbd2b84d691b0019824fddc32583a281303ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/894cbd2b84d691b0019824fddc32583a281303ab"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9d4e73d622b1033e0996064cd97ca6f577d85578", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d4e73d622b1033e0996064cd97ca6f577d85578", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9d4e73d622b1033e0996064cd97ca6f577d85578", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d4e73d622b1033e0996064cd97ca6f577d85578/comments", "author": null, "committer": null, "parents": [{"sha": "d3b35d7584ef28d51bdf2a2fed49ba18c924fb81", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d3b35d7584ef28d51bdf2a2fed49ba18c924fb81", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d3b35d7584ef28d51bdf2a2fed49ba18c924fb81"}], "stats": {"total": 33, "additions": 26, "deletions": 7}, "files": [{"sha": "d3c6cad4b68511e2dfb143edd250c84b231e0dd6", "filename": "gcc/c-parse.in", "status": "modified", "additions": 26, "deletions": 7, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9d4e73d622b1033e0996064cd97ca6f577d85578/gcc%2Fc-parse.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9d4e73d622b1033e0996064cd97ca6f577d85578/gcc%2Fc-parse.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-parse.in?ref=9d4e73d622b1033e0996064cd97ca6f577d85578", "patch": "@@ -1111,7 +1111,8 @@ init:\n \t\t  push_momentary (); }\n \t  initlist_maybe_comma '}'\n \t\t{ $$ = pop_init_level (0);\n-\t\t  if ($$ == error_mark_node)\n+\t\t  if ($$ == error_mark_node\n+\t\t      && ! (yychar == STRING || yychar == CONSTANT))\n \t\t    pop_momentary ();\n \t\t  else\n \t\t    pop_momentary_nofree (); }\n@@ -1551,17 +1552,26 @@ compstmt: '{' '}'\n \t\t{ emit_line_note (input_filename, lineno);\n \t\t  expand_end_bindings (getdecls (), 1, 0);\n \t\t  $$ = poplevel (1, 1, 0);\n-\t\t  pop_momentary (); }\n+\t\t  if (yychar == CONSTANT || yychar == STRING)\n+\t\t    pop_momentary_nofree ();\n+\t\t  else\n+\t\t    pop_momentary (); }\n \t| '{' pushlevel maybe_label_decls error '}'\n \t\t{ emit_line_note (input_filename, lineno);\n \t\t  expand_end_bindings (getdecls (), kept_level_p (), 0);\n \t\t  $$ = poplevel (kept_level_p (), 0, 0);\n-\t\t  pop_momentary (); }\n+\t\t  if (yychar == CONSTANT || yychar == STRING)\n+\t\t    pop_momentary_nofree ();\n+\t\t  else\n+\t\t    pop_momentary (); }\n \t| '{' pushlevel maybe_label_decls stmts '}'\n \t\t{ emit_line_note (input_filename, lineno);\n \t\t  expand_end_bindings (getdecls (), kept_level_p (), 0);\n \t\t  $$ = poplevel (kept_level_p (), 0, 0);\n-\t\t  pop_momentary (); }\n+\t\t  if (yychar == CONSTANT || yychar == STRING)\n+\t\t    pop_momentary_nofree ();\n+\t\t  else\n+\t\t    pop_momentary (); }\n \t;\n \n /* Value is number of statements counted as of the closeparen.  */\n@@ -1746,7 +1756,10 @@ stmt:\n \t\t  expand_loop_continue_here ();\n \t\t  if ($9)\n \t\t    c_expand_expr_stmt ($9);\n-\t\t  pop_momentary ();\n+\t\t  if (yychar == CONSTANT || yychar == STRING)\n+\t\t    pop_momentary_nofree ();\n+\t\t  else\n+\t\t    pop_momentary ();\n \t\t  expand_end_loop (); }\n \t| SWITCH '(' expr ')'\n \t\t{ stmt_count++;\n@@ -1758,7 +1771,10 @@ stmt:\n \t\t  position_after_white_space (); }\n \t  lineno_labeled_stmt\n \t\t{ expand_end_case ($3);\n-\t\t  pop_momentary (); }\n+\t\t  if (yychar == CONSTANT || yychar == STRING)\n+\t\t    pop_momentary_nofree ();\n+\t\t  else\n+\t\t    pop_momentary (); }\n \t| BREAK ';'\n \t\t{ stmt_count++;\n \t\t  emit_line_note ($<filename>-1, $<lineno>0);\n@@ -1878,7 +1894,10 @@ all_iter_stmt_with_decl:\n \t    emit_line_note (input_filename, lineno);\n \t    expand_end_bindings (getdecls (), 1, 0);\n \t    $<ttype>$ = poplevel (1, 1, 0);\n-\t    pop_momentary ();\t    \n+\t    if (yychar == CONSTANT || yychar == STRING)\n+\t      pop_momentary_nofree ();\n+\t    else\n+\t      pop_momentary ();\t    \n \t  }\n */\n "}]}