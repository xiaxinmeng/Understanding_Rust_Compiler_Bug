{"sha": "22cd031212e2376221435db5e9c6a298f24d7046", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjJjZDAzMTIxMmUyMzc2MjIxNDM1ZGI1ZTljNmEyOThmMjRkNzA0Ng==", "commit": {"author": {"name": "Bernd Edlinger", "email": "bernd.edlinger@hotmail.de", "date": "2019-09-13T11:33:18Z"}, "committer": {"name": "Bernd Edlinger", "email": "edlinger@gcc.gnu.org", "date": "2019-09-13T11:33:18Z"}, "message": "re PR fortran/91716 (ICE in output_constant, at varasm.c:5026)\n\n2019-09-13  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n\n        PR fortran/91716\n        * trans-array.c (gfc_conv_array_initializer): Always assign the\n        array type of the field to the string constant.\n\ntestsuite:\n2019-09-13  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n\n        PR fortran/91716\n        * gfortran.dg/pr91716.f90: New test.\n\nFrom-SVN: r275698", "tree": {"sha": "1e57e5edf8dbc98fb09ef9e5ca11b32f313cd7c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1e57e5edf8dbc98fb09ef9e5ca11b32f313cd7c8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/22cd031212e2376221435db5e9c6a298f24d7046", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22cd031212e2376221435db5e9c6a298f24d7046", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22cd031212e2376221435db5e9c6a298f24d7046", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22cd031212e2376221435db5e9c6a298f24d7046/comments", "author": {"login": "bernd-edlinger", "id": 17638929, "node_id": "MDQ6VXNlcjE3NjM4OTI5", "avatar_url": "https://avatars.githubusercontent.com/u/17638929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bernd-edlinger", "html_url": "https://github.com/bernd-edlinger", "followers_url": "https://api.github.com/users/bernd-edlinger/followers", "following_url": "https://api.github.com/users/bernd-edlinger/following{/other_user}", "gists_url": "https://api.github.com/users/bernd-edlinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/bernd-edlinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bernd-edlinger/subscriptions", "organizations_url": "https://api.github.com/users/bernd-edlinger/orgs", "repos_url": "https://api.github.com/users/bernd-edlinger/repos", "events_url": "https://api.github.com/users/bernd-edlinger/events{/privacy}", "received_events_url": "https://api.github.com/users/bernd-edlinger/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0d1cfeed7f7c5dbd3524fc64ab3f84dc4ed6ee17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d1cfeed7f7c5dbd3524fc64ab3f84dc4ed6ee17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d1cfeed7f7c5dbd3524fc64ab3f84dc4ed6ee17"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "a396418118d24bdcb8325278b3aa3c271420d499", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=22cd031212e2376221435db5e9c6a298f24d7046", "patch": "@@ -1,3 +1,9 @@\n+2019-09-13  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n+\n+\tPR fortran/91716\n+\t* trans-array.c (gfc_conv_array_initializer): Always assign the\n+\tarray type of the field to the string constant.\n+\n 2019-09-13  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/91717"}, {"sha": "8881fd953ed466000107f953302c658158e729bf", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=22cd031212e2376221435db5e9c6a298f24d7046", "patch": "@@ -6108,17 +6108,20 @@ gfc_conv_array_initializer (tree type, gfc_expr * expr)\n \t\t  tree atype = type;\n \t\t  while (TREE_CODE (TREE_TYPE (atype)) == ARRAY_TYPE)\n \t\t    atype = TREE_TYPE (atype);\n-\t\t  if (TREE_CODE (TREE_TYPE (atype)) == INTEGER_TYPE\n-\t\t      && tree_to_uhwi (TYPE_SIZE_UNIT (TREE_TYPE (se.expr)))\n-\t\t\t > tree_to_uhwi (TYPE_SIZE_UNIT (atype)))\n+\t\t  gcc_checking_assert (TREE_CODE (TREE_TYPE (atype))\n+\t\t\t\t       == INTEGER_TYPE);\n+\t\t  gcc_checking_assert (TREE_TYPE (TREE_TYPE (se.expr))\n+\t\t\t\t       == TREE_TYPE (atype));\n+\t\t  if (tree_to_uhwi (TYPE_SIZE_UNIT (TREE_TYPE (se.expr)))\n+\t\t      > tree_to_uhwi (TYPE_SIZE_UNIT (atype)))\n \t\t    {\n \t\t      unsigned HOST_WIDE_INT size\n \t\t\t= tree_to_uhwi (TYPE_SIZE_UNIT (atype));\n \t\t      const char *p = TREE_STRING_POINTER (se.expr);\n \n \t\t      se.expr = build_string (size, p);\n-\t\t      TREE_TYPE (se.expr) = atype;\n \t\t    }\n+\t\t  TREE_TYPE (se.expr) = atype;\n \t\t}\n \t      break;\n "}, {"sha": "62766c215566101078cd362546ecffab57bbb360", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=22cd031212e2376221435db5e9c6a298f24d7046", "patch": "@@ -1,3 +1,8 @@\n+2019-09-13  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n+\n+\tPR fortran/91716\n+\t* gfortran.dg/pr91716.f90: New test.\n+\n 2019-09-13  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/91717"}, {"sha": "d5de35882059e68c855bbfa668504743cca71a47", "filename": "gcc/testsuite/gfortran.dg/pr91716.f90", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91716.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22cd031212e2376221435db5e9c6a298f24d7046/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91716.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91716.f90?ref=22cd031212e2376221435db5e9c6a298f24d7046", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+! PR fortran/91716\n+! Code contributed by Gerhard Steinmetz\n+module m\n+   type t\n+      character :: c(2) = [character(-1) :: 'a', 'b']\n+   end type\n+end"}]}