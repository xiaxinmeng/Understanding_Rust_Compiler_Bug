{"sha": "a67ed43f1f1e0a64e55a207c7e8626330a91559d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTY3ZWQ0M2YxZjFlMGE2NGU1NWEyMDdjN2U4NjI2MzMwYTkxNTU5ZA==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2002-12-23T22:08:57Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@gcc.gnu.org", "date": "2002-12-23T22:08:57Z"}, "message": "altivec.md (mulv4sf3): Rewrite to add -0.0 vector.\n\n2002-12-23  Aldy Hernandez  <aldyh@redhat.com>\n\n\tPR/8763\n\t* config/rs6000/altivec.md (mulv4sf3): Rewrite to add -0.0 vector.\n\t(altivec_vspltisw_v4sf): Name pattern.\n\t(altivec_vslw_v4sf): New pattern.\n\nFrom-SVN: r60453", "tree": {"sha": "0e9b519ccd9d8aca8b0352f5546d34c8e485f852", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0e9b519ccd9d8aca8b0352f5546d34c8e485f852"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a67ed43f1f1e0a64e55a207c7e8626330a91559d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a67ed43f1f1e0a64e55a207c7e8626330a91559d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a67ed43f1f1e0a64e55a207c7e8626330a91559d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a67ed43f1f1e0a64e55a207c7e8626330a91559d/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "df82908a6fa55f17fb36ac970b718fd6f5846264", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df82908a6fa55f17fb36ac970b718fd6f5846264", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df82908a6fa55f17fb36ac970b718fd6f5846264"}], "stats": {"total": 42, "additions": 33, "deletions": 9}, "files": [{"sha": "6fd530633cd40cdafaa1e5a4ede20105ee9e8e53", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a67ed43f1f1e0a64e55a207c7e8626330a91559d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a67ed43f1f1e0a64e55a207c7e8626330a91559d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a67ed43f1f1e0a64e55a207c7e8626330a91559d", "patch": "@@ -1,3 +1,10 @@\n+2002-12-23  Aldy Hernandez  <aldyh@redhat.com>\n+\n+        PR/8763\n+        * config/rs6000/altivec.md (mulv4sf3): Rewrite to add -0.0 vector.\n+        (altivec_vspltisw_v4sf): Name pattern.\n+        (altivec_vslw_v4sf): New pattern.\n+\n 2002-12-23  Joseph S. Myers  <jsm@polyomino.org.uk>\n \n \t* doc/include/gcc-common.texi: Define DEVELOPMENT."}, {"sha": "c3f67d2210eef1fab71188e14b8941d5fe188f7c", "filename": "gcc/config/rs6000/altivec.md", "status": "modified", "additions": 26, "deletions": 9, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a67ed43f1f1e0a64e55a207c7e8626330a91559d/gcc%2Fconfig%2Frs6000%2Faltivec.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a67ed43f1f1e0a64e55a207c7e8626330a91559d/gcc%2Fconfig%2Frs6000%2Faltivec.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Faltivec.md?ref=a67ed43f1f1e0a64e55a207c7e8626330a91559d", "patch": "@@ -490,18 +490,27 @@\n   \"vmaddfp %0,%1,%2,%3\"\n   [(set_attr \"type\" \"vecfloat\")])\n \n-;; The unspec here is a vec splat of 0. We do multiply as a fused\n-;; multiply-add with an add of a 0 vector. \n+;; We do multiply as a fused multiply-add with an add of a -0.0 vector.\n \n (define_expand \"mulv4sf3\"\n-  [(set (match_dup 3) (unspec:V4SF [(const_int 0)] 142))\n-   (set (match_operand:V4SF 0 \"register_operand\" \"=v\")\n-        (plus:V4SF (mult:V4SF (match_operand:V4SF 1 \"register_operand\" \"v\")\n-\t                      (match_operand:V4SF 2 \"register_operand\" \"v\"))\n-\t\t   (match_dup 3)))]\n+  [(use (match_operand:V4SF 0 \"register_operand\" \"\"))\n+   (use (match_operand:V4SF 1 \"register_operand\" \"\"))\n+   (use (match_operand:V4SF 2 \"register_operand\" \"\"))]\n   \"TARGET_ALTIVEC && TARGET_FUSED_MADD\"\n   \"\n-{ operands[3] = gen_reg_rtx (V4SFmode); }\")\n+{\n+  rtx neg0;\n+\n+  /* Generate [-0.0, -0.0, -0.0, -0.0].  */\n+  neg0 = gen_reg_rtx (V4SFmode);\n+  emit_insn (gen_altivec_vspltisw_v4sf (neg0, GEN_INT (-1)));\n+  emit_insn (gen_altivec_vslw_v4sf (neg0, neg0, neg0));\n+\n+  /* Use the multiply-add.  */\n+  emit_insn (gen_altivec_vmaddfp (operands[0], operands[1], operands[2],\n+\t\t\t\t  neg0));\n+  DONE;\n+}\")\n \n ;; Fused multiply subtract \n (define_insn \"altivec_vnmsubfp\"\n@@ -1043,6 +1052,14 @@\n   \"vslw %0,%1,%2\"\n   [(set_attr \"type\" \"vecsimple\")])\n \n+(define_insn \"altivec_vslw_v4sf\"\n+  [(set (match_operand:V4SF 0 \"register_operand\" \"=v\")\n+        (unspec:V4SF [(match_operand:V4SF 1 \"register_operand\" \"v\")\n+                      (match_operand:V4SF 2 \"register_operand\" \"v\")] 109))]\n+  \"TARGET_ALTIVEC\"\n+  \"vslw %0,%1,%2\"\n+  [(set_attr \"type\" \"vecsimple\")])\n+\n (define_insn \"altivec_vsl\"\n   [(set (match_operand:V4SI 0 \"register_operand\" \"=v\")\n         (unspec:V4SI [(match_operand:V4SI 1 \"register_operand\" \"v\")\n@@ -1315,7 +1332,7 @@\n   \"vspltisw %0, %1\"\n   [(set_attr \"type\" \"vecperm\")])\n \n-(define_insn \"\"\n+(define_insn \"altivec_vspltisw_v4sf\"\n   [(set (match_operand:V4SF 0 \"register_operand\" \"=v\")\n         (unspec:V4SF [(match_operand:QI 1 \"immediate_operand\" \"i\")] 142))]\n   \"TARGET_ALTIVEC\""}]}