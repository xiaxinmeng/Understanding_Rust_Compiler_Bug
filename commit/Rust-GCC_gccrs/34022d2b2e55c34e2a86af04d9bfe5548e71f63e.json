{"sha": "34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzQwMjJkMmIyZTU1YzM0ZTJhODZhZjA0ZDliZmU1NTQ4ZTcxZjYzZQ==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2016-12-06T17:13:31Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2016-12-06T17:13:31Z"}, "message": "re PR fortran/78659 ([F03] Spurious \"requires DTIO\" reported against namelist statement)\n\n2016-12-06  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR fortran/78659\n\t* resolve.c (resolve_fl_namelist): Remove unneeded error.\n\tPR fortran/78659\n\t* gfortran.dg/alloc_comp_constraint_1.f90: Update test.\n\t* gfortran.dg/alloc_comp_constraint_7.f90: New test.\n\t* gfortran.dg/namelist_34.f90: Update test.\n\t* gfortran.dg/namelist_63.f90: Update test.\n\nFrom-SVN: r243308", "tree": {"sha": "621a99be891691a1fec5b2d90fd9f2f2b41b5a4f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/621a99be891691a1fec5b2d90fd9f2f2b41b5a4f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/comments", "author": null, "committer": null, "parents": [{"sha": "0eada3216bc0eab65325bdcf0fee3584007830ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0eada3216bc0eab65325bdcf0fee3584007830ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0eada3216bc0eab65325bdcf0fee3584007830ff"}], "stats": {"total": 66, "additions": 46, "deletions": 20}, "files": [{"sha": "14bf4f9619ee2b301654242facc3b36c00140c4f", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "patch": "@@ -1,3 +1,8 @@\n+2016-12-06  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR fortran/78659\n+\t* resolve.c (resolve_fl_namelist): Remove unneeded error.\n+\n 2016-12-06  Andre Vehreschild  <vehre@gcc.gnu.org>\n \n \tPR fortran/78226"}, {"sha": "e4ea10f27bccff034d9f5bc4ac5d59fc4233543f", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "patch": "@@ -13900,15 +13900,7 @@ resolve_fl_namelist (gfc_symbol *sym)\n \t\t\t       \"or POINTER components\", nl->sym->name,\n \t\t\t       sym->name, &sym->declared_at))\n \t    return false;\n-\n-\t  if (!dtio)\n-\t    {\n-\t      gfc_error (\"NAMELIST object %qs in namelist %qs at %L has \"\n-\t\t\t\"ALLOCATABLE or POINTER components and thus requires \"\n-\t\t\t\"a defined input/output procedure\", nl->sym->name,\n-\t\t\tsym->name, &sym->declared_at);\n-\t      return false;\n-\t    }\n+\t  return true;\n \t}\n     }\n "}, {"sha": "b293dcf9518892c33858245fb348e2f51136450c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "patch": "@@ -1,3 +1,11 @@\n+2016-12-06  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR fortran/78659\n+\t* gfortran.dg/alloc_comp_constraint_1.f90: Update test.\n+\t* gfortran.dg/alloc_comp_constraint_7.f90: New test.\n+\t* gfortran.dg/namelist_34.f90: Update test.\n+\t* gfortran.dg/namelist_63.f90: Update test.\n+\n 2016-12-06  Robert Suchanek  <robert.suchanek@imgtec.com>\n \n \t* gcc.target/mips/msa-builtins-err.c: New test."}, {"sha": "e1715256f4f4f98101de06e0f7fde39480d2899e", "filename": "gcc/testsuite/gfortran.dg/alloc_comp_constraint_1.f90", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Falloc_comp_constraint_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Falloc_comp_constraint_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Falloc_comp_constraint_1.f90?ref=34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "patch": "@@ -1,5 +1,6 @@\n ! { dg-do compile }\n-! Check that we don't allow IO or NAMELISTs with types with allocatable\n+! { dg-options -std=f2003 }\n+! Check that we don't allow IO of NAMELISTs with types with allocatable\n ! components (PR 20541)\n program main\n \n@@ -13,8 +14,8 @@ program main\n \n     type(foo) :: a\n     type(bar) :: b\n-    namelist /blah/ a ! { dg-error \"has ALLOCATABLE or POINTER components and thus requires a defined input/output\" }\n-\n+    namelist /blah/ a  ! This is allowed under F2003, but not F95\n+    ! The following require User Defined Derived Type I/O procedures.\n     write (*, *) a  ! { dg-error \"cannot have ALLOCATABLE components\" }\n \n     read (*, *) b  ! { dg-error \"cannot have ALLOCATABLE components\" }"}, {"sha": "35b8e1f029f3c910bd7751b8c51d765d2339758d", "filename": "gcc/testsuite/gfortran.dg/alloc_comp_constraint_7.f90", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Falloc_comp_constraint_7.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Falloc_comp_constraint_7.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Falloc_comp_constraint_7.f90?ref=34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "patch": "@@ -0,0 +1,19 @@\n+! { dg-do compile }\n+! { dg-options -std=f95 }\n+! Check that we don't allow types with allocatable\n+program main\n+\n+    type :: foo\n+        integer :: k\n+        integer, allocatable :: x(:) ! { dg-error \"Fortran 2003: ALLOCATABLE\" }\n+    end type foo\n+\n+    type :: bar\n+        type(foo) :: x\n+    end type bar\n+\n+    type(foo) :: a\n+    type(bar) :: b\n+    namelist /blah/ a\n+\n+end program main"}, {"sha": "be8f49f71e457d0d704feec3281bd0ef7c70786a", "filename": "gcc/testsuite/gfortran.dg/namelist_34.f90", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_34.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_34.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_34.f90?ref=34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "patch": "@@ -1,7 +1,7 @@\n ! { dg-do compile }\n-!\n+! { dg-options -std=f95 }\n ! PR fortran/32905 - accepts types with ultimate POINTER components\n-!\n+! updated for PR78659\n MODULE types\n   type :: tp3\n     real :: x\n@@ -22,7 +22,7 @@ MODULE nml\n USE types\n    type(tp1) :: t1\n    type(tp3) :: t3\n-\n-   namelist /a/ t1    ! { dg-error \"has ALLOCATABLE or POINTER components and thus requires a defined input/output\" }\n-   namelist /b/ t3    ! { dg-error \"has ALLOCATABLE or POINTER components and thus requires a defined input/output\" }\n+! The following are allowed under f2003.\n+   namelist /a/ t1    ! { dg-error \"with ALLOCATABLE or POINTER components\" }\n+   namelist /b/ t3    ! { dg-error \"with ALLOCATABLE or POINTER components\" }\n END MODULE"}, {"sha": "de27b82d52fafcd7d90d3427a809df8d314e0030", "filename": "gcc/testsuite/gfortran.dg/namelist_63.f90", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_63.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34022d2b2e55c34e2a86af04d9bfe5548e71f63e/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_63.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_63.f90?ref=34022d2b2e55c34e2a86af04d9bfe5548e71f63e", "patch": "@@ -1,6 +1,6 @@\n ! { dg-do compile }\n-!\n-! PR fortran/45530\n+! { dg-options -std=f95 }\n+! PR fortran/45530, updated for PR78659\n !\n ! Contributed by david.sagan@gmail.com\n !\n@@ -24,5 +24,6 @@ program test\n end type\n \n type (c_struct) curve(10)\n-namelist / params / curve ! { dg-error \"ALLOCATABLE or POINTER components and thus requires a defined input/output\" }\n+! The following is allowed with f2003.\n+namelist / params / curve ! { dg-error \"ALLOCATABLE or POINTER components\" }\n end program"}]}