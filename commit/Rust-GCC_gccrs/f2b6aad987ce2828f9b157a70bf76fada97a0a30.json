{"sha": "f2b6aad987ce2828f9b157a70bf76fada97a0a30", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjJiNmFhZDk4N2NlMjgyOGY5YjE1N2E3MGJmNzZmYWRhOTdhMGEzMA==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2016-11-17T23:39:08Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2016-11-17T23:39:08Z"}, "message": "re PR target/47192 (m68k target - gcc uses stack frame after it has been unlinked when compiling with -Os)\n\n\tPR target/47192\n\t* config/m68k/m68k.c (m68k_expand_epilogue): Emit a scheduling\n\tbarrier prior to deallocating the stack.\n\n\tPR target/47192\n\t* gcc.target/m68k/pr47192.c: New test.\n\nFrom-SVN: r242575", "tree": {"sha": "5ee1637c3650ad8d655da30909516bd875089fde", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ee1637c3650ad8d655da30909516bd875089fde"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f2b6aad987ce2828f9b157a70bf76fada97a0a30", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2b6aad987ce2828f9b157a70bf76fada97a0a30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f2b6aad987ce2828f9b157a70bf76fada97a0a30", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2b6aad987ce2828f9b157a70bf76fada97a0a30/comments", "author": null, "committer": null, "parents": [{"sha": "e080b2818b12b856ed8bc6dd26edb89703a2ff0d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e080b2818b12b856ed8bc6dd26edb89703a2ff0d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e080b2818b12b856ed8bc6dd26edb89703a2ff0d"}], "stats": {"total": 49, "additions": 49, "deletions": 0}, "files": [{"sha": "86a8fdf7d76e28b73b4db5dc789325fe36db0738", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f2b6aad987ce2828f9b157a70bf76fada97a0a30", "patch": "@@ -1,3 +1,9 @@\n+2016-11-17  Jeff Law  <law@redhat.com>\n+\n+\tPR target/47192\n+\t* config/m68k/m68k.c (m68k_expand_epilogue): Emit a scheduling\n+\tbarrier prior to deallocating the stack.\n+\n 2016-11-17  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* config/arc/arc.md (cmem bit/sign-extend peephole2): New peephole"}, {"sha": "346c2dc6af36c93acc64274e5a8f4950eb153af3", "filename": "gcc/config/m68k/m68k.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2Fconfig%2Fm68k%2Fm68k.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2Fconfig%2Fm68k%2Fm68k.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Fm68k.c?ref=f2b6aad987ce2828f9b157a70bf76fada97a0a30", "patch": "@@ -1205,6 +1205,7 @@ m68k_expand_epilogue (bool sibcall_p)\n \t     stack-based restore.  */\n \t  emit_move_insn (gen_rtx_REG (Pmode, A1_REG),\n \t\t\t  GEN_INT (-(current_frame.offset + fsize)));\n+\t  emit_insn (gen_blockage ());\n \t  emit_insn (gen_addsi3 (stack_pointer_rtx,\n \t\t\t\t gen_rtx_REG (Pmode, A1_REG),\n \t\t\t\t frame_pointer_rtx));\n@@ -1306,6 +1307,7 @@ m68k_expand_epilogue (bool sibcall_p)\n \t\t\t current_frame.fpu_mask, false, false);\n     }\n \n+  emit_insn (gen_blockage ());\n   if (frame_pointer_needed)\n     emit_insn (gen_unlink (frame_pointer_rtx));\n   else if (fsize_with_regs)"}, {"sha": "5dd6f569a2299e6257f4cba4b5c79558c1e8ce1d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f2b6aad987ce2828f9b157a70bf76fada97a0a30", "patch": "@@ -1,3 +1,8 @@\n+2016-11-17  Jeff Law  <law@redhat.com>\n+\n+\tPR target/47192\n+\t* gcc.target/m68k/pr47192.c: New test.\n+\n 2016-11-17  Toma Tabacu  <toma.tabacu@imgtec.com>\n \n \t* gcc.target/mips/branch-cost-1.c (dg-options): Use (HAS_MOVN)"}, {"sha": "5bbef586632be34ac9e2902c11ba1051ac750a6c", "filename": "gcc/testsuite/gcc.target/m68k/pr47192.c", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2Ftestsuite%2Fgcc.target%2Fm68k%2Fpr47192.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2b6aad987ce2828f9b157a70bf76fada97a0a30/gcc%2Ftestsuite%2Fgcc.target%2Fm68k%2Fpr47192.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fm68k%2Fpr47192.c?ref=f2b6aad987ce2828f9b157a70bf76fada97a0a30", "patch": "@@ -0,0 +1,36 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -mcpu=51qe -fdisable-ipa-pure-const -fdump-rtl-pro_and_epilogue\" } */\n+/* { dg-final { scan-rtl-dump-times \"unspec_volatile\" 1 \"pro_and_epilogue\"} } */\n+\n+\n+char F(short *ty);\n+\n+short V(char cmd)\n+{\n+  static short st256;\n+  static short stc;\n+  short sc;\n+  short scd;\n+  short d;\n+\n+  F(&sc);\n+\n+  if (cmd == 4)\n+  {\n+    st256 = 0;\n+    d = 0;\n+  }\n+  else\n+  {\n+    scd = sc - stc;\n+    if (scd < -128)\n+    {\n+      scd += 256;\n+    }\n+    d = st256 >> 8;\n+    st256 -= d << 8;\n+  }\n+  stc = sc;\n+  return d;\n+}\n+"}]}