{"sha": "c2124b51a9b83c76400ebb1862b26f61410e77db", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzIxMjRiNTFhOWI4M2M3NjQwMGViYjE4NjJiMjZmNjE0MTBlNzdkYg==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-06-22T07:19:45Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-06-23T07:39:10Z"}, "message": "contrib: add git-commit-mklog wrapper\n\ncontrib/ChangeLog:\n\n\t* gcc-git-customization.sh: Use the new wrapper.\n\t* git-commit-mklog.py: New file.\n\t* prepare-commit-msg: Support GCC_MKLOG_ARGS.", "tree": {"sha": "ff4f5a398a4cf17c2dbcc4e357fcfccbb13649ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ff4f5a398a4cf17c2dbcc4e357fcfccbb13649ed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c2124b51a9b83c76400ebb1862b26f61410e77db", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2124b51a9b83c76400ebb1862b26f61410e77db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2124b51a9b83c76400ebb1862b26f61410e77db", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2124b51a9b83c76400ebb1862b26f61410e77db/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "47749c43acb460ac8f410ee599616d1860ee5a35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47749c43acb460ac8f410ee599616d1860ee5a35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47749c43acb460ac8f410ee599616d1860ee5a35"}], "stats": {"total": 57, "additions": 55, "deletions": 2}, "files": [{"sha": "6f8f23deebf17dec7b63a8f1286af03226dce772", "filename": "contrib/gcc-git-customization.sh", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2124b51a9b83c76400ebb1862b26f61410e77db/contrib%2Fgcc-git-customization.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2124b51a9b83c76400ebb1862b26f61410e77db/contrib%2Fgcc-git-customization.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-git-customization.sh?ref=c2124b51a9b83c76400ebb1862b26f61410e77db", "patch": "@@ -28,7 +28,7 @@ git config alias.gcc-undescr \\!\"f() { o=\\$(git config --get gcc-config.upstream)\n git config alias.gcc-verify '!f() { \"`git rev-parse --show-toplevel`/contrib/gcc-changelog/git_check_commit.py\" $@; } ; f'\n git config alias.gcc-backport '!f() { \"`git rev-parse --show-toplevel`/contrib/git-backport.py\" $@; } ; f'\n git config alias.gcc-mklog '!f() { \"`git rev-parse --show-toplevel`/contrib/mklog.py\" $@; } ; f'\n-git config alias.gcc-commit-mklog '!f() { GCC_FORCE_MKLOG=1 git commit \"$@\"; }; f'\n+git config alias.gcc-commit-mklog '!f() { \"`git rev-parse --show-toplevel`/contrib/git-commit-mklog.py\" $@; }; f'\n \n # Make diff on MD files use \"(define\" as a function marker.\n # Use this in conjunction with a .gitattributes file containing"}, {"sha": "9c59fb97809555f3d37cce9fb2fc8a77d69b4194", "filename": "contrib/git-commit-mklog.py", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2124b51a9b83c76400ebb1862b26f61410e77db/contrib%2Fgit-commit-mklog.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2124b51a9b83c76400ebb1862b26f61410e77db/contrib%2Fgit-commit-mklog.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgit-commit-mklog.py?ref=c2124b51a9b83c76400ebb1862b26f61410e77db", "patch": "@@ -0,0 +1,53 @@\n+#!/usr/bin/env python3\n+\n+# Copyright (C) 2020 Free Software Foundation, Inc.\n+#\n+# This file is part of GCC.\n+#\n+# GCC is free software; you can redistribute it and/or modify\n+# it under the terms of the GNU General Public License as published by\n+# the Free Software Foundation; either version 3, or (at your option)\n+# any later version.\n+#\n+# GCC is distributed in the hope that it will be useful,\n+# but WITHOUT ANY WARRANTY; without even the implied warranty of\n+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+# GNU General Public License for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with GCC; see the file COPYING.  If not, write to\n+# the Free Software Foundation, 51 Franklin Street, Fifth Floor,\n+# Boston, MA 02110-1301, USA.\n+#\n+# The script is wrapper for git commit-mklog alias where it parses\n+# -b/--pr-numbers argument and passes it via environment variable\n+# to mklog.py script.\n+\n+import argparse\n+import os\n+import subprocess\n+\n+if __name__ == '__main__':\n+    children_args = []\n+    myenv = os.environ.copy()\n+\n+    parser = argparse.ArgumentParser(description='git-commit-mklog wrapped')\n+    parser.add_argument('-b', '--pr-numbers', action='store',\n+                        type=lambda arg: arg.split(','), nargs='?',\n+                        help='Add the specified PRs (comma separated)')\n+    parser.add_argument('-p', '--fill-up-bug-titles', action='store_true',\n+                        help='Download title of mentioned PRs')\n+    args, unknown_args = parser.parse_known_args()\n+\n+    myenv['GCC_FORCE_MKLOG'] = '1'\n+    mklog_args = []\n+    if args.pr_numbers:\n+        mklog_args.append(f'-b {\",\".join(args.pr_numbers)}')\n+    if args.fill_up_bug_titles:\n+        mklog_args.append('-p')\n+\n+    if mklog_args:\n+        myenv['GCC_MKLOG_ARGS'] = ' '.join(mklog_args)\n+\n+    commit_args = ' '.join(unknown_args)\n+    subprocess.run(f'git commit {commit_args}', shell=True, env=myenv)"}, {"sha": "5da878458cd214277c432bd4778982218774281d", "filename": "contrib/prepare-commit-msg", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c2124b51a9b83c76400ebb1862b26f61410e77db/contrib%2Fprepare-commit-msg", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c2124b51a9b83c76400ebb1862b26f61410e77db/contrib%2Fprepare-commit-msg", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fprepare-commit-msg?ref=c2124b51a9b83c76400ebb1862b26f61410e77db", "patch": "@@ -78,4 +78,4 @@ else\n     tee=\"cat\"\n fi\n \n-git $cmd | $tee | git gcc-mklog -c \"$COMMIT_MSG_FILE\"\n+git $cmd | $tee | git gcc-mklog $GCC_MKLOG_ARGS -c \"$COMMIT_MSG_FILE\""}]}