{"sha": "c7a52e72da5d893545496a2f6772374c7282ba9c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzdhNTJlNzJkYTVkODkzNTQ1NDk2YTJmNjc3MjM3NGM3MjgyYmE5Yw==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2018-08-18T09:15:05Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2018-08-18T09:15:05Z"}, "message": "Darwin does not support gsplit-dwarf.\n\n2018-08-18  Iain Sandoe  <iain@sandoe.co.uk>\n\ngcc/\n\n\t* config/darwin.c (darwin_override_options): If -gsplit-dwarf is set,\n\temit a diagnostic that it is not supported and reset the option.\n\t* config/darwin.h (DRIVER_SELF_SPECS): Note that gsplit-dwarf is not\n\tsupported and consume the option.  (ASM_FINAL_SPEC): New.\n\ngcc/testsuite\n\n\t* g++.dg/debug/dwarf2/pr85302.C: Skip unsupported split DWARF\n\ttest on Darwin.\n\t* g++.dg/debug/dwarf2/pr85302.C: Likewise.\n\t* gcc.dg/lto/pr83719_0.c: Likewise.\n\nFrom-SVN: r263645", "tree": {"sha": "df123e91f7060b140c0ac489544c88ca883e2ca7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/df123e91f7060b140c0ac489544c88ca883e2ca7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c7a52e72da5d893545496a2f6772374c7282ba9c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7a52e72da5d893545496a2f6772374c7282ba9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c7a52e72da5d893545496a2f6772374c7282ba9c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7a52e72da5d893545496a2f6772374c7282ba9c/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2ed3a817c841071731219272de54c2aaefa741be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ed3a817c841071731219272de54c2aaefa741be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ed3a817c841071731219272de54c2aaefa741be"}], "stats": {"total": 31, "additions": 30, "deletions": 1}, "files": [{"sha": "ccc76e48bb041ed26e51ac6a14643e139692351b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c7a52e72da5d893545496a2f6772374c7282ba9c", "patch": "@@ -1,3 +1,10 @@\n+2018-08-18  Iain Sandoe  <iain@sandoe.co.uk>\n+\n+\t* config/darwin.c (darwin_override_options): If -gsplit-dwarf is set,\n+\temit a diagnostic that it is not supported and reset the option.\n+\t* config/darwin.h (DRIVER_SELF_SPECS): Note that gsplit-dwarf is not\n+\tsupported and consume the option.  (ASM_FINAL_SPEC): New.\n+\n 2018-08-17  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* doc/md.texi (Patterns): Use @ref instead of @xref in the middle of"}, {"sha": "233076a3b77a202c2f46ae77e647faa2fa9f6c53", "filename": "gcc/config/darwin.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Fconfig%2Fdarwin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Fconfig%2Fdarwin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.c?ref=c7a52e72da5d893545496a2f6772374c7282ba9c", "patch": "@@ -3176,6 +3176,14 @@ darwin_override_options (void)\n   if (!global_options_set.x_dwarf_version)\n     dwarf_version = 2;\n \n+  if (global_options_set.x_dwarf_split_debug_info)\n+    {\n+      inform (input_location,\n+\t      \"-gsplit-dwarf is not supported on this platform, ignored\");\n+      dwarf_split_debug_info = 0;\n+      global_options_set.x_dwarf_split_debug_info = 0;\n+    }\n+\n   /* Do not allow unwind tables to be generated by default for m32.  \n      fnon-call-exceptions will override this, regardless of what we do.  */\n   if (generating_for_darwin_version < 10"}, {"sha": "05c8cf71a1f949f211bd347ea82593fda7d13258", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=c7a52e72da5d893545496a2f6772374c7282ba9c", "patch": "@@ -122,7 +122,9 @@ extern GTY(()) int darwin_ms_struct;\n   \"%{gfull:-g -fno-eliminate-unused-debug-symbols} %<gfull\",\t\\\n   \"%{gused:-g -feliminate-unused-debug-symbols} %<gused\",\t\\\n   \"%{fapple-kext|mkernel:-static}\",\t\t\t\t\\\n-  \"%{shared:-Zdynamiclib} %<shared\"\n+  \"%{shared:-Zdynamiclib} %<shared\",                            \\\n+  \"%{gsplit-dwarf:%ngsplit-dwarf is not supported on this platform } \\\n+     %<gsplit-dwarf\"\n \n #define DARWIN_CC1_SPEC\t\t\t\t\t\t\t\\\n   \"%{findirect-virtual-calls: -fapple-kext} %<findirect-virtual-calls \" \\\n@@ -421,6 +423,8 @@ extern GTY(()) int darwin_ms_struct;\n    debugging data.  */\n \n #define ASM_DEBUG_SPEC  \"%{g*:%{%:debug-level-gt(0):%{!gdwarf*:--gstabs}}}\"\n+#define ASM_FINAL_SPEC \\\n+  \"%{gsplit-dwarf:%ngsplit-dwarf is not supported on this platform } %<gsplit-dwarf\"\n \n /* We still allow output of STABS if the assembler supports it.  */\n #ifdef HAVE_AS_STABS_DIRECTIVE"}, {"sha": "5a1aedfd899bc4319423264c00cd196b9f270c57", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c7a52e72da5d893545496a2f6772374c7282ba9c", "patch": "@@ -1,3 +1,10 @@\n+2018-08-18  Iain Sandoe  <iain@sandoe.co.uk>\n+\n+\t* g++.dg/debug/dwarf2/pr85302.C: Skip unsupported split DWARF\n+\ttest on Darwin.\n+\t* g++.dg/debug/dwarf2/pr85302.C: Likewise.\n+\t* gcc.dg/lto/pr83719_0.c: Likewise.\n+\n 2018-08-17  Martin Sebor  <msebor@redhat.com>\n \n \tPR testsuite/86996"}, {"sha": "457508dd586745e4d71ac2304ae513465c66783f", "filename": "gcc/testsuite/g++.dg/debug/dwarf2/pr85302.C", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fpr85302.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fpr85302.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Fpr85302.C?ref=c7a52e72da5d893545496a2f6772374c7282ba9c", "patch": "@@ -1,5 +1,6 @@\n // PR debug/85302\n // { dg-do compile }\n+// { dg-skip-if \"split DWARF unsupported\" { *-*-darwin* } }\n // { dg-options \"-std=c++11 -gsplit-dwarf -O1\" }\n // { dg-additional-options \"-fPIE\" { target pie } }\n "}, {"sha": "cd4cab369a5d397e1a2403afb9e8f823954a67fe", "filename": "gcc/testsuite/gcc.dg/lto/pr83719_0.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr83719_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr83719_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fpr83719_0.c?ref=c7a52e72da5d893545496a2f6772374c7282ba9c", "patch": "@@ -1,4 +1,5 @@\n /* { dg-lto-do assemble } */\n+/* { dg-skip-if \"split DWARF unsupported\" { *-*-darwin* } } */\n /* { dg-lto-options { { -flto -g -gsplit-dwarf } } } */\n \n /* Empty.  */"}, {"sha": "3397427256922deaccd29d6994e480a6bb77ebf3", "filename": "gcc/testsuite/gcc.dg/pr86064.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2Fgcc.dg%2Fpr86064.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c7a52e72da5d893545496a2f6772374c7282ba9c/gcc%2Ftestsuite%2Fgcc.dg%2Fpr86064.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr86064.c?ref=c7a52e72da5d893545496a2f6772374c7282ba9c", "patch": "@@ -1,4 +1,5 @@\n /* { dg-do compile } */\n+/* { dg-skip-if \"split DWARF unsupported\" { *-*-darwin* } } */\n /* { dg-options \"-g -O2 -fno-var-tracking-assignments -gsplit-dwarf\" } */\n \n /* This used to fail with location views (implicitly) enabled, because"}]}