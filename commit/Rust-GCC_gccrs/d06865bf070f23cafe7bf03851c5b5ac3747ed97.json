{"sha": "d06865bf070f23cafe7bf03851c5b5ac3747ed97", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDA2ODY1YmYwNzBmMjNjYWZlN2JmMDM4NTFjNWI1YWMzNzQ3ZWQ5Nw==", "commit": {"author": {"name": "Dave Korn", "email": "dave.korn.cygwin@gmail.com", "date": "2011-01-10T00:33:32Z"}, "committer": {"name": "Dave Korn", "email": "davek@gcc.gnu.org", "date": "2011-01-10T00:33:32Z"}, "message": "re PR c++/47218 (C++ multiple definitions of non-virtual thunk problem)\n\ngcc/ChangeLog:\n\n\tPR c++/47218\n\t* cgraphunit.c (assemble_thunk): Call resolve_unique_section.\n\ngcc/testsuite/ChangeLog:\n\n\tPR c++/47218\n\t* g++.dg/other/pr47218-1.C: New test file.\n\t* g++.dg/other/pr47218.C: Likewise.\n\t* g++.dg/other/pr47218.h: New supporting header.\n\nFrom-SVN: r168624", "tree": {"sha": "05685f0c2b4e57f2206b97d58364d368424f2cd5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/05685f0c2b4e57f2206b97d58364d368424f2cd5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d06865bf070f23cafe7bf03851c5b5ac3747ed97", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d06865bf070f23cafe7bf03851c5b5ac3747ed97", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d06865bf070f23cafe7bf03851c5b5ac3747ed97", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d06865bf070f23cafe7bf03851c5b5ac3747ed97/comments", "author": {"login": "davek-cygwin", "id": 530057, "node_id": "MDQ6VXNlcjUzMDA1Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/530057?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davek-cygwin", "html_url": "https://github.com/davek-cygwin", "followers_url": "https://api.github.com/users/davek-cygwin/followers", "following_url": "https://api.github.com/users/davek-cygwin/following{/other_user}", "gists_url": "https://api.github.com/users/davek-cygwin/gists{/gist_id}", "starred_url": "https://api.github.com/users/davek-cygwin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davek-cygwin/subscriptions", "organizations_url": "https://api.github.com/users/davek-cygwin/orgs", "repos_url": "https://api.github.com/users/davek-cygwin/repos", "events_url": "https://api.github.com/users/davek-cygwin/events{/privacy}", "received_events_url": "https://api.github.com/users/davek-cygwin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "637ebedd3893c7b350dc2b14d3f0458b11f9a519", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/637ebedd3893c7b350dc2b14d3f0458b11f9a519", "html_url": "https://github.com/Rust-GCC/gccrs/commit/637ebedd3893c7b350dc2b14d3f0458b11f9a519"}], "stats": {"total": 81, "additions": 79, "deletions": 2}, "files": [{"sha": "99532478c3ecfe3df0ae971413b7a91d6da93769", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d06865bf070f23cafe7bf03851c5b5ac3747ed97", "patch": "@@ -1,3 +1,8 @@\n+2011-01-10  Dave Korn  <dave.korn.cygwin@gmail.com>\n+\n+\tPR c++/47218\n+\t* cgraphunit.c (assemble_thunk): Call resolve_unique_section.\n+\n 2011-01-09  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \tPR objc/47232"}, {"sha": "92e5aa9546120c60b2b9b176a593162aa9007dbf", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=d06865bf070f23cafe7bf03851c5b5ac3747ed97", "patch": "@@ -1,6 +1,6 @@\n /* Callgraph based interprocedural optimizations.\n-   Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n-   Free Software Foundation, Inc.\n+   Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010,\n+   2011 Free Software Foundation, Inc.\n    Contributed by Jan Hubicka\n \n This file is part of GCC.\n@@ -1317,6 +1317,9 @@ assemble_thunk (struct cgraph_node *node)\n \n   current_function_decl = thunk_fndecl;\n \n+  /* Ensure thunks are emitted in their correct sections.  */\n+  resolve_unique_section (thunk_fndecl, 0, flag_function_sections);\n+\n   if (this_adjusting\n       && targetm.asm_out.can_output_mi_thunk (thunk_fndecl, fixed_offset,\n \t\t\t\t\t      virtual_value, alias))"}, {"sha": "48aa10137b99761852e1b3ea30b849710203a64a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d06865bf070f23cafe7bf03851c5b5ac3747ed97", "patch": "@@ -1,3 +1,10 @@\n+2011-01-10  Dave Korn  <dave.korn.cygwin@gmail.com>\n+\n+\tPR c++/47218\n+\t* g++.dg/other/pr47218-1.C: New test file.\n+\t* g++.dg/other/pr47218.C: Likewise.\n+\t* g++.dg/other/pr47218.h: New supporting header.\n+\n 2011-01-09  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \tPR objc/47232"}, {"sha": "aeb070b0c3a1346b57c41eed6594ba54c768692d", "filename": "gcc/testsuite/g++.dg/other/pr47218-1.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218-1.C?ref=d06865bf070f23cafe7bf03851c5b5ac3747ed97", "patch": "@@ -0,0 +1,10 @@\n+#include \"pr47218.h\"\n+\n+Foo2::~Foo2 ()\n+{\n+  ((FooBaseBase1*)this)->Bar();\n+}\n+\n+void Foo2::Bar()\n+{\n+}"}, {"sha": "3056795a5fb9a11ddd64c7fa3c20c431ab613fb5", "filename": "gcc/testsuite/g++.dg/other/pr47218.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218.C?ref=d06865bf070f23cafe7bf03851c5b5ac3747ed97", "patch": "@@ -0,0 +1,19 @@\n+/* { dg-do link } */\n+/* { dg-options \"--save-temps\" } */\n+/* { dg-additional-sources \"pr47218-1.C\" } */\n+\n+#include \"pr47218.h\"\n+\n+Foo3::~Foo3 ()\n+{\n+  ((FooBaseBase1*)this)->Bar();\n+}\n+\n+void Foo3::Bar()\n+{\n+}\n+\n+int main ()\n+{\n+  return 0;\n+}"}, {"sha": "1b07da7464c6f1b85d027a7540916e486f0df5cf", "filename": "gcc/testsuite/g++.dg/other/pr47218.h", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d06865bf070f23cafe7bf03851c5b5ac3747ed97/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr47218.h?ref=d06865bf070f23cafe7bf03851c5b5ac3747ed97", "patch": "@@ -0,0 +1,33 @@\n+\n+class FooBaseBase0\n+{\n+public:\n+  virtual ~FooBaseBase0 () {}\n+};\n+\n+class FooBaseBase1\n+{\n+public:\n+  virtual void Bar() {}\n+};\n+\n+\n+class FooBase: public FooBaseBase0, public FooBaseBase1\n+{\n+public:\n+  virtual void Bar() {}\n+};\n+\n+class Foo2: public FooBase\n+{\n+public:\n+  ~Foo2 ();\n+  virtual void Bar();\n+};\n+\n+class Foo3: public FooBase\n+{\n+public:\n+  ~Foo3 ();\n+  virtual void Bar();\n+};"}]}