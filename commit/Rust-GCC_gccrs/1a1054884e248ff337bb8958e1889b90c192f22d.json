{"sha": "1a1054884e248ff337bb8958e1889b90c192f22d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWExMDU0ODg0ZTI0OGZmMzM3YmI4OTU4ZTE4ODliOTBjMTkyZjIyZA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-01-26T09:56:25Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-01-26T09:56:25Z"}, "message": "[multiple changes]\n\n2010-01-26  Vincent Celier  <celier@adacore.com>\n\n\t* gnat_ugn.texi: Complete documentation on the restrictions for\n\tcombined options in -gnatxxx switches.\n\tFix typo.\n\n2010-01-26  Arnaud Charlet  <charlet@adacore.com>\n\n\t* s-tpoben.adb (Initialize_Protection_Entries): If a PO is created from\n\ta controlled operation, abort is already deferred at this point, so we\n\tneed to use Defer_Abort_Nestable.\n\n2010-01-26  Vincent Celier  <celier@adacore.com>\n\n\t* prj-conf.adb (Get_Config_Switches): Check for a default language for\n\ta project extending a project with no languages.\n\nFrom-SVN: r156237", "tree": {"sha": "39d4362ce79e1cff512ceb6da7520b7144968011", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/39d4362ce79e1cff512ceb6da7520b7144968011"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a1054884e248ff337bb8958e1889b90c192f22d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a1054884e248ff337bb8958e1889b90c192f22d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a1054884e248ff337bb8958e1889b90c192f22d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a1054884e248ff337bb8958e1889b90c192f22d/comments", "author": null, "committer": null, "parents": [{"sha": "057dd91d0c1df52679f71644d95fea2ae9522f3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/057dd91d0c1df52679f71644d95fea2ae9522f3e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/057dd91d0c1df52679f71644d95fea2ae9522f3e"}], "stats": {"total": 68, "additions": 57, "deletions": 11}, "files": [{"sha": "3884aa43626ae3491980a1529c7aeb3f6a7030fe", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=1a1054884e248ff337bb8958e1889b90c192f22d", "patch": "@@ -1,3 +1,20 @@\n+2010-01-26  Vincent Celier  <celier@adacore.com>\n+\n+\t* gnat_ugn.texi: Complete documentation on the restrictions for\n+\tcombined options in -gnatxxx switches.\n+\tFix typo.\n+\n+2010-01-26  Arnaud Charlet  <charlet@adacore.com>\n+\n+\t* s-tpoben.adb (Initialize_Protection_Entries): If a PO is created from\n+\ta controlled operation, abort is already deferred at this point, so we\n+\tneed to use Defer_Abort_Nestable.\n+\n+2010-01-26  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-conf.adb (Get_Config_Switches): Check for a default language for\n+\ta project extending a project with no languages.\n+\n 2010-01-26  Vincent Celier  <celier@adacore.com>\n \n \t* switch-c.adb (Scan_Front_End_Switches): Take into account options"}, {"sha": "7cb31f26460a7d3e45f3a60faa0c4fcfa1fb0392", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=1a1054884e248ff337bb8958e1889b90c192f22d", "patch": "@@ -390,8 +390,8 @@ GNAT Project Manager\n \n The Cross-Referencing Tools gnatxref and gnatfind\n \n-* gnatxref Switches::\n-* gnatfind Switches::\n+* Switches for gnatxref::\n+* Switches for gnatfind::\n * Project Files for gnatxref and gnatfind::\n * Regular Expressions in gnatfind and gnatxref::\n * Examples of gnatxref Usage::\n@@ -4595,6 +4595,10 @@ as warning mode modifiers (see description of @option{-gnatw}).\n Once a ``V'' appears in the string (that is a use of the @option{-gnatV}\n switch), then all further characters in the switch are interpreted\n as validity checking options (@pxref{Validity Checking}).\n+\n+@item\n+Option ``em'', ``ec'', ``ep'', ``l='' and ``R'' must be the last options in\n+a combined list of options.\n @end ifclear\n @end itemize\n \n@@ -15377,15 +15381,15 @@ Note: to invoke @code{gnatxref} or @code{gnatfind} with a project file,\n use the @code{gnat} driver (see @ref{The GNAT Driver and Project Files}).\n \n @menu\n-* gnatxref Switches::\n-* gnatfind Switches::\n+* Switches for gnatxref::\n+* Switches for gnatfind::\n * Project Files for gnatxref and gnatfind::\n * Regular Expressions in gnatfind and gnatxref::\n * Examples of gnatxref Usage::\n * Examples of gnatfind Usage::\n @end menu\n \n-@node gnatxref Switches\n+@node Switches for gnatxref\n @section @code{gnatxref} Switches\n \n @noindent\n@@ -15516,7 +15520,7 @@ appear after the file names. They need not be separated by spaces, thus\n you can say @samp{gnatxref ^-ag^/ALL_FILES/IGNORE_LOCALS^} instead of\n @samp{gnatxref ^-a -g^/ALL_FILES /IGNORE_LOCALS^}.\n \n-@node gnatfind Switches\n+@node Switches for gnatfind\n @section @code{gnatfind} Switches\n \n @noindent"}, {"sha": "dfebd9a5d4903a24281003d4a5394a32eac3a5b4", "filename": "gcc/ada/prj-conf.adb", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2Fprj-conf.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2Fprj-conf.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.adb?ref=1a1054884e248ff337bb8958e1889b90c192f22d", "patch": "@@ -516,6 +516,8 @@ package body Prj.Conf is\n          Count    : Natural;\n          Result   : Argument_List_Access;\n \n+         Check_Default : Boolean;\n+\n       begin\n          Prj_Iter := Project_Tree.Projects;\n          while Prj_Iter /= null loop\n@@ -530,9 +532,23 @@ package body Prj.Conf is\n                  or else Variable.Default\n                then\n                   --  Languages is not declared. If it is not an extending\n-                  --  project, check for Default_Language\n+                  --  project, or if it extends a project with no Languages,\n+                  --  check for Default_Language.\n+\n+                  Check_Default := Prj_Iter.Project.Extends = No_Project;\n+\n+                  if not Check_Default then\n+                     Variable :=\n+                       Value_Of\n+                         (Name_Languages,\n+                          Prj_Iter.Project.Extends.Decl.Attributes,\n+                          Project_Tree);\n+                     Check_Default :=\n+                       Variable /= Nil_Variable_Value\n+                         and then Variable.Values = Nil_String;\n+                  end if;\n \n-                  if Prj_Iter.Project.Extends = No_Project then\n+                  if Check_Default then\n                      Variable :=\n                        Value_Of\n                          (Name_Default_Language,\n@@ -548,7 +564,7 @@ package body Prj.Conf is\n                         Language_Htable.Set (Lang, Lang);\n \n                      else\n-                        --  If no language is declared, default to Ada\n+                        --  If no default language is declared, default to Ada\n \n                         Language_Htable.Set (Name_Ada, Name_Ada);\n                      end if;"}, {"sha": "561d79306c7e0d02f87062804e131a156a4dd98c", "filename": "gcc/ada/s-tpoben.adb", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2Fs-tpoben.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a1054884e248ff337bb8958e1889b90c192f22d/gcc%2Fada%2Fs-tpoben.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-tpoben.adb?ref=1a1054884e248ff337bb8958e1889b90c192f22d", "patch": "@@ -226,9 +226,18 @@ package body System.Tasking.Protected_Objects.Entries is\n          raise Program_Error;\n       end if;\n \n-      Initialization.Defer_Abort (Self_ID);\n+      --  If a PO is created from a controlled operation, abort is already\n+      --  deferred at this point, so we need to use Defer_Abort_Nestable\n+      --  In some cases, the below assertion can be useful to spot\n+      --  inconsistencies, outside the above scenario involving controlled\n+      --  types:\n+\n+      --  pragma Assert (Self_Id.Deferral_Level = 0);\n+      --  Why is this commented out Assert here ???\n+\n+      Initialization.Defer_Abort_Nestable (Self_ID);\n       Initialize_Lock (Init_Priority, Object.L'Access);\n-      Initialization.Undefer_Abort (Self_ID);\n+      Initialization.Undefer_Abort_Nestable (Self_ID);\n \n       Object.Ceiling          := System.Any_Priority (Init_Priority);\n       Object.New_Ceiling      := System.Any_Priority (Init_Priority);"}]}