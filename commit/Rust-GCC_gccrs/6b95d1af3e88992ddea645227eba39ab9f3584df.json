{"sha": "6b95d1af3e88992ddea645227eba39ab9f3584df", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmI5NWQxYWYzZTg4OTkyZGRlYTY0NTIyN2ViYTM5YWI5ZjM1ODRkZg==", "commit": {"author": {"name": "Cesar Philippidis", "email": "cesar@codesourcery.com", "date": "2018-04-12T18:48:56Z"}, "committer": {"name": "Cesar Philippidis", "email": "cesar@gcc.gnu.org", "date": "2018-04-12T18:48:56Z"}, "message": "Revert 259346.\n\n\tgcc/\n\t* lto-streamer-out.c (output_function): Revert 259346.\n\t* omp-expand.c (expand_oacc_for): Likewise.\n\n\tlibgomp/\n\t* testsuite/libgomp.oacc-c-c++-common/pr84955.c: Revert 259346.\n\t* testsuite/libgomp.oacc-fortran/pr84955.f90:Likewise.\n\nFrom-SVN: r259351", "tree": {"sha": "3740cab6519d80544a7d1b15f4397ba33f6a1e81", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3740cab6519d80544a7d1b15f4397ba33f6a1e81"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6b95d1af3e88992ddea645227eba39ab9f3584df", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b95d1af3e88992ddea645227eba39ab9f3584df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6b95d1af3e88992ddea645227eba39ab9f3584df", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b95d1af3e88992ddea645227eba39ab9f3584df/comments", "author": {"login": "cesarjp", "id": 4576177, "node_id": "MDQ6VXNlcjQ1NzYxNzc=", "avatar_url": "https://avatars.githubusercontent.com/u/4576177?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cesarjp", "html_url": "https://github.com/cesarjp", "followers_url": "https://api.github.com/users/cesarjp/followers", "following_url": "https://api.github.com/users/cesarjp/following{/other_user}", "gists_url": "https://api.github.com/users/cesarjp/gists{/gist_id}", "starred_url": "https://api.github.com/users/cesarjp/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cesarjp/subscriptions", "organizations_url": "https://api.github.com/users/cesarjp/orgs", "repos_url": "https://api.github.com/users/cesarjp/repos", "events_url": "https://api.github.com/users/cesarjp/events{/privacy}", "received_events_url": "https://api.github.com/users/cesarjp/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e417946035bda841f537ffab208b5dc7c1a49f8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e417946035bda841f537ffab208b5dc7c1a49f8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e417946035bda841f537ffab208b5dc7c1a49f8f"}], "stats": {"total": 66, "additions": 12, "deletions": 54}, "files": [{"sha": "6890d2a1ad4dace5bb01303f52da28cca6a4d70f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6b95d1af3e88992ddea645227eba39ab9f3584df", "patch": "@@ -1,3 +1,8 @@\n+2018-04-12  Cesar Philippidis  <cesar@codesourcery.com>\n+\n+\t* lto-streamer-out.c (output_function): Revert 259346.\n+\t* omp-expand.c (expand_oacc_for): Likewise.\n+\n 2018-04-12  Alexander Monakov  <amonakov@ispras.ru>\n \n \tPR rtl-optimization/85354"}, {"sha": "1d2ab9757f1a3352f03f03028e59358a4f210683", "filename": "gcc/lto-streamer-out.c", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2Flto-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2Flto-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-out.c?ref=6b95d1af3e88992ddea645227eba39ab9f3584df", "patch": "@@ -2084,9 +2084,6 @@ output_function (struct cgraph_node *node)\n   /* Set current_function_decl and cfun.  */\n   push_cfun (fn);\n \n-  /* Fixup loops if required to match discovery done in the reader.  */\n-  loop_optimizer_init (AVOID_CFG_MODIFICATIONS);\n-\n   /* Make string 0 be a NULL string.  */\n   streamer_write_char_stream (ob->string_stream, 0);\n \n@@ -2179,13 +2176,12 @@ output_function (struct cgraph_node *node)\n       streamer_write_record_start (ob, LTO_null);\n \n       output_cfg (ob, fn);\n+\n+      pop_cfun ();\n    }\n   else\n     streamer_write_uhwi (ob, 0);\n \n-  loop_optimizer_finalize ();\n-  pop_cfun ();\n-\n   /* Create a section to hold the pickled output of this function.   */\n   produce_asm (ob, function);\n "}, {"sha": "bb204906ea64efa94a78b42bbc606c0e61f29192", "filename": "gcc/omp-expand.c", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2Fomp-expand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2Fomp-expand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-expand.c?ref=6b95d1af3e88992ddea645227eba39ab9f3584df", "patch": "@@ -5439,14 +5439,6 @@ expand_oacc_for (struct omp_region *region, struct omp_for_data *fd)\n \n \t  split->flags ^= EDGE_FALLTHRU | EDGE_TRUE_VALUE;\n \n-\t  /* Add a dummy exit for the tiled block when cont_bb is missing.  */\n-\t  if (cont_bb == NULL)\n-\t    {\n-\t      edge e = make_edge (body_bb, exit_bb, EDGE_FALSE_VALUE);\n-\t      e->probability = profile_probability::even ();\n-\t      split->probability = profile_probability::even ();\n-\t    }\n-\n \t  /* Initialize the user's loop vars.  */\n \t  gsi = gsi_start_bb (elem_body_bb);\n \t  expand_oacc_collapse_vars (fd, true, &gsi, counts, e_offset);"}, {"sha": "2b4f2504e077e8191863140e2d30d5c099432185", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b95d1af3e88992ddea645227eba39ab9f3584df/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6b95d1af3e88992ddea645227eba39ab9f3584df", "patch": "@@ -1,3 +1,8 @@\n+2018-04-12  Cesar Philippidis  <cesar@codesourcery.com>\n+\n+\t* testsuite/libgomp.oacc-c-c++-common/pr84955.c: Revert 259346.\n+\t* testsuite/libgomp.oacc-fortran/pr84955.f90: Likewise.\n+\n 2018-04-12  Kelvin Nilsen  <kelvin@gcc.gnu.org>\n \n \tPR target/85347"}, {"sha": "5910b57b68ddddcaefb1941e0fca442826c6fc07", "filename": "libgomp/testsuite/libgomp.oacc-c-c++-common/pr84955.c", "status": "removed", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e417946035bda841f537ffab208b5dc7c1a49f8f/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fpr84955.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e417946035bda841f537ffab208b5dc7c1a49f8f/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fpr84955.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c-c%2B%2B-common%2Fpr84955.c?ref=e417946035bda841f537ffab208b5dc7c1a49f8f", "patch": "@@ -1,20 +0,0 @@\n-/* { dg-do compile }  */\n-\n-int\n-main ()\n-{\n-  int i, j;\n-\n-#pragma acc parallel loop tile(2,3)\n-  for (i = 1; i < 10; i++)\n-    for (j = 1; j < 10; j++)\n-      for (;;)\n-\t;\n-\n-#pragma acc parallel loop\n-  for (i = 1; i < 10; i++)\n-    for (;;)\n-      ;\n-\n-  return i + j;\n-}"}, {"sha": "878d8a89f41a2d1cd8fe07027525c52ba542f466", "filename": "libgomp/testsuite/libgomp.oacc-fortran/pr84955.f90", "status": "removed", "additions": 0, "deletions": 20, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e417946035bda841f537ffab208b5dc7c1a49f8f/libgomp%2Ftestsuite%2Flibgomp.oacc-fortran%2Fpr84955.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e417946035bda841f537ffab208b5dc7c1a49f8f/libgomp%2Ftestsuite%2Flibgomp.oacc-fortran%2Fpr84955.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-fortran%2Fpr84955.f90?ref=e417946035bda841f537ffab208b5dc7c1a49f8f", "patch": "@@ -1,20 +0,0 @@\n-! { dg-do compile }\n-\n-subroutine s\n-   integer :: i, j\n-   !$acc parallel loop tile(2,3)\n-   do i = 1, 10\n-      do j = 1, 10\n-         do\n-         end do\n-      end do\n-   end do\n-  !$acc end parallel loop\n-\n-  !$acc parallel loop\n-   do i = 1, 10\n-      do\n-      end do\n-   end do\n-  !$acc end parallel loop\n-end subroutine s"}]}