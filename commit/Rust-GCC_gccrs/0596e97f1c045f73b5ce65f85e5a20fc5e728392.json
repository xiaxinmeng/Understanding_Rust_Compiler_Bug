{"sha": "0596e97f1c045f73b5ce65f85e5a20fc5e728392", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDU5NmU5N2YxYzA0NWY3M2I1Y2U2NWY4NWU1YTIwZmM1ZTcyODM5Mg==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2009-12-15T15:17:46Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@gcc.gnu.org", "date": "2009-12-15T15:17:46Z"}, "message": "re PR tree-optimization/42185 ([graphite] expected gimple_assign(error_mark), have gimple_call() in gimple_assign_rhs_code, at gimple.h:1820)\n\n       PR graphite/42185\n        * graphite-sese-to-poly.c (is_reduction_operation_p): Assert that\n        we are a GIMPLE_ASSIGN.  Do not calculate rhs code twice.\n        (follow_ssa_with_commutative_ops): Return NULL on non assignment.\n\nFrom-SVN: r155256", "tree": {"sha": "10039beb55c068a2e7c2ed3a603b42ebdc4214c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/10039beb55c068a2e7c2ed3a603b42ebdc4214c6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0596e97f1c045f73b5ce65f85e5a20fc5e728392", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0596e97f1c045f73b5ce65f85e5a20fc5e728392", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0596e97f1c045f73b5ce65f85e5a20fc5e728392", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0596e97f1c045f73b5ce65f85e5a20fc5e728392/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3efd49f9dfe125830c71d8f52a65ced5180dad88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3efd49f9dfe125830c71d8f52a65ced5180dad88", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3efd49f9dfe125830c71d8f52a65ced5180dad88"}], "stats": {"total": 46, "additions": 44, "deletions": 2}, "files": [{"sha": "62594155d93f28c7c36df08c765ae8136ee31537", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0596e97f1c045f73b5ce65f85e5a20fc5e728392/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0596e97f1c045f73b5ce65f85e5a20fc5e728392/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0596e97f1c045f73b5ce65f85e5a20fc5e728392", "patch": "@@ -1,3 +1,10 @@\n+2009-12-15  Aldy Hernandez  <aldyh@redhat.com>\n+\n+\tPR graphite/42185\n+\t* graphite-sese-to-poly.c (is_reduction_operation_p): Assert that\n+\twe are a GIMPLE_ASSIGN.  Do not calculate rhs code twice.\n+\t(follow_ssa_with_commutative_ops): Return NULL on non assignment.\n+\n 2009-12-15  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* config/rs6000/rs6000.md (probe_stack): Use an enclosing SET."}, {"sha": "370bbff5ddd6e8fe9e931e7fd223cc51f17a5337", "filename": "gcc/graphite-sese-to-poly.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0596e97f1c045f73b5ce65f85e5a20fc5e728392/gcc%2Fgraphite-sese-to-poly.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0596e97f1c045f73b5ce65f85e5a20fc5e728392/gcc%2Fgraphite-sese-to-poly.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-sese-to-poly.c?ref=0596e97f1c045f73b5ce65f85e5a20fc5e728392", "patch": "@@ -2462,9 +2462,14 @@ split_reduction_stmt (gimple stmt)\n static inline bool\n is_reduction_operation_p (gimple stmt)\n {\n+  enum tree_code code;\n+\n+  gcc_assert (is_gimple_assign (stmt));\n+  code = gimple_assign_rhs_code (stmt);\n+\n   return flag_associative_math\n-    && commutative_tree_code (gimple_assign_rhs_code (stmt))\n-    && associative_tree_code (gimple_assign_rhs_code (stmt));\n+    && commutative_tree_code (code)\n+    && associative_tree_code (code);\n }\n \n /* Returns true when PHI contains an argument ARG.  */\n@@ -2500,6 +2505,9 @@ follow_ssa_with_commutative_ops (tree arg, tree lhs)\n       return NULL;\n     }\n \n+  if (!is_gimple_assign (stmt))\n+    return NULL;\n+\n   if (gimple_num_ops (stmt) == 2)\n     return follow_ssa_with_commutative_ops (gimple_assign_rhs1 (stmt), lhs);\n "}, {"sha": "0918f72874c457cc8bb4bb48877bda679c4a1f9d", "filename": "gcc/testsuite/gfortran.dg/graphite/pr42185.f90", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0596e97f1c045f73b5ce65f85e5a20fc5e728392/gcc%2Ftestsuite%2Fgfortran.dg%2Fgraphite%2Fpr42185.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0596e97f1c045f73b5ce65f85e5a20fc5e728392/gcc%2Ftestsuite%2Fgfortran.dg%2Fgraphite%2Fpr42185.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgraphite%2Fpr42185.f90?ref=0596e97f1c045f73b5ce65f85e5a20fc5e728392", "patch": "@@ -0,0 +1,27 @@\n+! { dg-compile }\n+! { dg-options \"-fgraphite -O -ffast-math\" }\n+\n+MODULE powell\n+  INTEGER, PARAMETER :: dp=8\n+CONTAINS\n+  SUBROUTINE trsapp (n,npt,xopt,xpt,gq,hq,pq,delta,step,d,g,hd,hs,crvmin)\n+    REAL(dp), DIMENSION(*), INTENT(INOUT)    :: step, d, g, hd, hs\n+    LOGICAL                                  :: jump1, jump2\n+    REAL(dp) :: alpha, angle, angtest, bstep, cf, cth, dd, delsq, dg, dhd, &\n+      reduc, sg, sgk, shs, ss, sth, temp, tempa, tempb\n+    DO i=1,n\n+       dd=dd+d(i)**2\n+    END DO\n+    mainloop : DO\n+       IF ( .NOT. jump2 ) THEN\n+          IF ( .NOT. jump1 ) THEN\n+             bstep=temp/(ds+SQRT(ds*ds+dd*temp))\n+             IF (alpha < bstep) THEN\n+                IF (ss < delsq) CYCLE mainloop\n+             END IF\n+             IF (gg <= 1.0e-4_dp*ggbeg) EXIT mainloop\n+          END IF\n+       END IF\n+    END DO mainloop\n+  END SUBROUTINE trsapp\n+END MODULE powell"}]}