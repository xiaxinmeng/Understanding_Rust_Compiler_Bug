{"sha": "5ef5a3b7c21df246f1e023f765d61c445cef4d71", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWVmNWEzYjdjMjFkZjI0NmYxZTAyM2Y3NjVkNjFjNDQ1Y2VmNGQ3MQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-09-06T07:29:12Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-09-06T07:29:12Z"}, "message": "re PR rtl-optimization/54455 (ICE: RTL check: expected elt 3 type 'B', have '0' (rtx barrier) in compute_bb_for_insn, at cfgrtl.c:418)\n\n\tPR rtl-optimization/54455\n\t* sel-sched-ir.c (maybe_tidy_empty_bb): Give up if previous fallthru\n\tbb ends up with asm goto referencing bb's label.\n\n\t* gcc.dg/54455.c: New test.\n\nFrom-SVN: r191013", "tree": {"sha": "f8d040452ec5242138c3043b9a7cc3be15f871d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f8d040452ec5242138c3043b9a7cc3be15f871d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5ef5a3b7c21df246f1e023f765d61c445cef4d71", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ef5a3b7c21df246f1e023f765d61c445cef4d71", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5ef5a3b7c21df246f1e023f765d61c445cef4d71", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ef5a3b7c21df246f1e023f765d61c445cef4d71/comments", "author": null, "committer": null, "parents": [{"sha": "3dcdfdc804568d313dd879a5fb6ea9beb115a27b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dcdfdc804568d313dd879a5fb6ea9beb115a27b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3dcdfdc804568d313dd879a5fb6ea9beb115a27b"}], "stats": {"total": 58, "additions": 55, "deletions": 3}, "files": [{"sha": "ca501249a3a51216501df3682a3ac053c6261a00", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5ef5a3b7c21df246f1e023f765d61c445cef4d71", "patch": "@@ -1,3 +1,9 @@\n+2012-09-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/54455\n+\t* sel-sched-ir.c (maybe_tidy_empty_bb): Give up if previous fallthru\n+\tbb ends up with asm goto referencing bb's label.\n+\n 2012-09-06  Chen Liqin  <liqin.gcc@gmail.com>\n \n \t* config/score/score.c: Remove TARGET_LEGITIMIZE_ADDRESS define"}, {"sha": "d237a24ef4f72e3f214b722f04e4e648bc881fc2", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=5ef5a3b7c21df246f1e023f765d61c445cef4d71", "patch": "@@ -1,4 +1,4 @@\n-2012-09-06  Tobias Burnus\n+2012-09-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/54463\n \t* trans-intrinsic.c (gfc_conv_intrinsic_funcall): Fix matmul"}, {"sha": "1f1095ecfed09eda561f49655067f3ed7f4b801d", "filename": "gcc/sel-sched-ir.c", "status": "modified", "additions": 17, "deletions": 1, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Fsel-sched-ir.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Fsel-sched-ir.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched-ir.c?ref=5ef5a3b7c21df246f1e023f765d61c445cef4d71", "patch": "@@ -1,5 +1,5 @@\n /* Instruction scheduling pass.  Selective scheduler and pipeliner.\n-   Copyright (C) 2006, 2007, 2008, 2009, 2010, 2011\n+   Copyright (C) 2006, 2007, 2008, 2009, 2010, 2011, 2012\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -3686,6 +3686,22 @@ maybe_tidy_empty_bb (basic_block bb)\n   FOR_EACH_EDGE (e, ei, bb->preds)\n     if (e->flags & EDGE_COMPLEX)\n       return false;\n+    else if (e->flags & EDGE_FALLTHRU)\n+      {\n+\trtx note;\n+\t/* If prev bb ends with asm goto, see if any of the\n+\t   ASM_OPERANDS_LABELs don't point to the fallthru\n+\t   label.  Do not attempt to redirect it in that case.  */\n+\tif (JUMP_P (BB_END (e->src))\n+\t    && (note = extract_asm_operands (PATTERN (BB_END (e->src)))))\n+\t  {\n+\t    int i, n = ASM_OPERANDS_LABEL_LENGTH (note);\n+\n+\t    for (i = 0; i < n; ++i)\n+\t      if (XEXP (ASM_OPERANDS_LABEL (note, i), 0) == BB_HEAD (bb))\n+\t\treturn false;\n+\t  }\n+      }\n \n   free_data_sets (bb);\n "}, {"sha": "8589e9ec4634e0a69553aa42ae9238c90c2004f5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5ef5a3b7c21df246f1e023f765d61c445cef4d71", "patch": "@@ -1,4 +1,9 @@\n-2012-09-06  Tobias Burnus\n+2012-09-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/54455\n+\t* gcc.dg/54455.c: New test.\n+\n+2012-09-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/54463\n \t* gfortran.dg/promotion_2.f90: New."}, {"sha": "de68a53e2335c1175560c0ddf67c7e3fa029a9a8", "filename": "gcc/testsuite/gcc.dg/54455.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Ftestsuite%2Fgcc.dg%2F54455.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5ef5a3b7c21df246f1e023f765d61c445cef4d71/gcc%2Ftestsuite%2Fgcc.dg%2F54455.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F54455.c?ref=5ef5a3b7c21df246f1e023f765d61c445cef4d71", "patch": "@@ -0,0 +1,25 @@\n+/* PR rtl-optimization/54455 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -fschedule-insns -fselective-scheduling --param max-sched-extend-regions-iters=2\" } */\n+\n+extern void fn1 (void), fn2 (void);\n+\n+static inline __attribute__((always_inline)) int\n+foo (int *x, long y)\n+{\n+  asm goto (\"\" : : \"r\" (x), \"r\" (y) : \"memory\" : lab);\n+  return 0;\n+lab:\n+  return 1;\n+}\n+\n+void\n+bar (int *x)\n+{\n+  if (foo (x, 23))\n+    fn1 ();\n+  else\n+    fn2 ();\n+\n+  foo (x, 2);\n+}"}]}