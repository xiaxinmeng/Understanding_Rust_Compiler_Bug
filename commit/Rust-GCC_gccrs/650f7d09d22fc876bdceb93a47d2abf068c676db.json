{"sha": "650f7d09d22fc876bdceb93a47d2abf068c676db", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjUwZjdkMDlkMjJmYzg3NmJkY2ViOTNhNDdkMmFiZjA2OGM2NzZkYg==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2017-09-24T08:39:00Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2017-09-24T08:39:00Z"}, "message": "re PR fortran/80118 (ICE with zero size parameter array)\n\n2017-09-24  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\t    Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/80118\n\t* expr.c (gfc_get_full_arrayspec_from_expr): If there is\n\tno symtree, set array spec to NULL.\n\n2017-09-24  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\t    Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/80118\n\t* gfortran.dg/zero_sized_7.f90: New test.\n\n\nCo-Authored-By: Steven G. Kargl <kargl@gcc.gnu.org>\n\nFrom-SVN: r253123", "tree": {"sha": "667b16bf637db0a4449c057781f75bb37d30eaa0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/667b16bf637db0a4449c057781f75bb37d30eaa0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/650f7d09d22fc876bdceb93a47d2abf068c676db", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/650f7d09d22fc876bdceb93a47d2abf068c676db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/650f7d09d22fc876bdceb93a47d2abf068c676db", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/650f7d09d22fc876bdceb93a47d2abf068c676db/comments", "author": null, "committer": null, "parents": [{"sha": "e6a951d26565dd138af99b3cb9c3ec4f10e74458", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e6a951d26565dd138af99b3cb9c3ec4f10e74458", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e6a951d26565dd138af99b3cb9c3ec4f10e74458"}], "stats": {"total": 37, "additions": 36, "deletions": 1}, "files": [{"sha": "29504c85b18527efa288138fd65d5737760b4523", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=650f7d09d22fc876bdceb93a47d2abf068c676db", "patch": "@@ -1,3 +1,10 @@\n+2017-09-24  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\t    Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/80118\n+\t* expr.c (gfc_get_full_arrayspec_from_expr): If there is\n+\tno symtree, set array spec to NULL.\n+\n 2017-09-23  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/82143"}, {"sha": "bfbb19ee577fab64ef433983a0f2510c3adcaba6", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=650f7d09d22fc876bdceb93a47d2abf068c676db", "patch": "@@ -4568,7 +4568,11 @@ gfc_get_full_arrayspec_from_expr (gfc_expr *expr)\n   if (expr->expr_type == EXPR_VARIABLE\n       || expr->expr_type == EXPR_CONSTANT)\n     {\n-      as = expr->symtree->n.sym->as;\n+      if (expr->symtree)\n+\tas = expr->symtree->n.sym->as;\n+      else\n+\tas = NULL;\n+\n       for (ref = expr->ref; ref; ref = ref->next)\n \t{\n \t  switch (ref->type)"}, {"sha": "bc23562b1b92cb7b00c3922a0b0326aaebcdc971", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=650f7d09d22fc876bdceb93a47d2abf068c676db", "patch": "@@ -1,3 +1,9 @@\n+2017-09-24  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\t    Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/80118\n+\t* gfortran.dg/zero_sized_7.f90: New test.\n+\n 2017-09-23  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/82143"}, {"sha": "7908532eaea5332712a16af5e6af103fbac39db9", "filename": "gcc/testsuite/gfortran.dg/zero_sized_7.f90", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ftestsuite%2Fgfortran.dg%2Fzero_sized_7.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/650f7d09d22fc876bdceb93a47d2abf068c676db/gcc%2Ftestsuite%2Fgfortran.dg%2Fzero_sized_7.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fzero_sized_7.f90?ref=650f7d09d22fc876bdceb93a47d2abf068c676db", "patch": "@@ -0,0 +1,18 @@\n+! { dg-do compile }\n+! PR 80118 - this used to ICE\n+! Original test case by Marco Restelli\n+module m\n+implicit none\n+\n+  integer, parameter :: not_empty(1) = 0\n+  integer, parameter :: empty1(0) = (/integer :: /)\n+  integer, parameter :: empty2(0) = 0\n+\n+contains\n+\n+ subroutine sub(v)\n+  integer, allocatable, intent(out) :: v(:)\n+   v = 2*empty2 ! internal compiler error\n+ end subroutine sub\n+\n+end module m"}]}