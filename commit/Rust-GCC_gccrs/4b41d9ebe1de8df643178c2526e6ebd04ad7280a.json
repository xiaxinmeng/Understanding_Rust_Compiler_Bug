{"sha": "4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGI0MWQ5ZWJlMWRlOGRmNjQzMTc4YzI1MjZlNmViZDA0YWQ3MjgwYQ==", "commit": {"author": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@users.sourceforge.net", "date": "2003-05-05T12:19:12Z"}, "committer": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@gcc.gnu.org", "date": "2003-05-05T12:19:12Z"}, "message": "re PR c++/4494 (Possible problem with compiler warnings on main())\n\n\tPR c++/4494\n\t* decl.c (start_function): Use same_type_p to check return type\n\tof main.\n\n\t* g++.dg/warn/main.C: New test.\n\nFrom-SVN: r66476", "tree": {"sha": "f60d3ff551a0b0872e8682bfb14e152b62836009", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f60d3ff551a0b0872e8682bfb14e152b62836009"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/comments", "author": null, "committer": null, "parents": [{"sha": "1e77e67301dfb36ff74a274a100489d6cce714b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1e77e67301dfb36ff74a274a100489d6cce714b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1e77e67301dfb36ff74a274a100489d6cce714b8"}], "stats": {"total": 27, "additions": 25, "deletions": 2}, "files": [{"sha": "0a8d76daa741dac45986ef236dd6a8c346b1146b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "patch": "@@ -1,3 +1,9 @@\n+2003-05-05  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/4494\n+\t* decl.c (start_function): Use same_type_p to check return type\n+\tof main.\n+\n 2003-05-03  Zack Weinberg  <zack@codesourcery.com>\n \n \tPR c/10604"}, {"sha": "34f82bd9d08fc3691c56466cc06a83416a5186d6", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "patch": "@@ -13382,8 +13382,9 @@ start_function (tree declspecs, tree declarator, tree attrs, int flags)\n \tctype = TYPE_METHOD_BASETYPE (fntype);\n       else if (DECL_MAIN_P (decl1))\n \t{\n-\t  /* If this doesn't return integer_type, complain.  */\n-\t  if (TREE_TYPE (TREE_TYPE (decl1)) != integer_type_node)\n+\t  /* If this doesn't return integer_type, or a typedef to\n+\t     integer_type, complain.  */\n+\t  if (!same_type_p (TREE_TYPE (TREE_TYPE (decl1)), integer_type_node))\n \t    {\n \t      if (pedantic || warn_return_type)\n \t\tpedwarn (\"return type for `main' changed to `int'\");"}, {"sha": "aec72724b3ee46e02efdf3d161276f9dfd83dfbf", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "patch": "@@ -1,3 +1,8 @@\n+2003-05-05  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/4494\n+\t* g++.dg/warn/main.C: New test.\n+\n 2003-05-04  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.dg/nonnull-3.c: New test."}, {"sha": "ebf92177b2d01b9bc1d4ba82db8705cc5e6596ba", "filename": "gcc/testsuite/g++.dg/warn/main.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fmain.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b41d9ebe1de8df643178c2526e6ebd04ad7280a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fmain.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fmain.C?ref=4b41d9ebe1de8df643178c2526e6ebd04ad7280a", "patch": "@@ -0,0 +1,11 @@\n+// { dg-do compile }\n+\n+// Origin: Donald W. Gillies <dgillies@graviton.com>\n+\n+// PR c++/4494: Incorrect diagnostics about return type of main.\n+\n+typedef int int_t;\n+\n+int_t main() {\n+\n+}"}]}