{"sha": "0efe7d8796e00a5737017fe472680b653bd83d90", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGVmZTdkODc5NmUwMGE1NzM3MDE3ZmU0NzI2ODBiNjUzYmQ4M2Q5MA==", "commit": {"author": {"name": "Andre Simoes Dias Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2020-03-20T09:07:10Z"}, "committer": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2020-03-20T09:08:39Z"}, "message": "gcc, Arm: Fix MVE move from GPR -> GPR\n\nThis patch fixes the pattern mve_mov for the case where both MVE vectors are in\nR registers and the move does not get optimized away.  I use the same approach\nas we do for NEON, where we use four register moves.\n\ngcc/ChangeLog:\n2020-03-20  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\t* config/arm/mve.md (mve_mov<mode>): Fix R->R case.\n\ngcc/testsuite/ChangeLog:\n2020-03-20  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\t* gcc.target/arm/mve/intrinsics/mve_move_gpr_to_gpr.c: New test.", "tree": {"sha": "bf319ea475f48f72c4e48adb57e67b7edeef34b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bf319ea475f48f72c4e48adb57e67b7edeef34b2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0efe7d8796e00a5737017fe472680b653bd83d90", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0efe7d8796e00a5737017fe472680b653bd83d90", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0efe7d8796e00a5737017fe472680b653bd83d90", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0efe7d8796e00a5737017fe472680b653bd83d90/comments", "author": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4119cd693d27e9dd87c547de75283edd45bf6dce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4119cd693d27e9dd87c547de75283edd45bf6dce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4119cd693d27e9dd87c547de75283edd45bf6dce"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "ccda62fdd42e48b9d38bed2208fcdb977342cb67", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0efe7d8796e00a5737017fe472680b653bd83d90", "patch": "@@ -1,3 +1,7 @@\n+2020-03-20  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n+\n+\t* config/arm/mve.md (mve_mov<mode>): Fix R->R case.\n+\n 2020-03-20  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/94224"}, {"sha": "b80a2a66044bb471271ed89e52a7003a74c40f42", "filename": "gcc/config/arm/mve.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2Fconfig%2Farm%2Fmve.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2Fconfig%2Farm%2Fmve.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fmve.md?ref=0efe7d8796e00a5737017fe472680b653bd83d90", "patch": "@@ -663,15 +663,15 @@\n       else\n \treturn \"vldrb.8 %q0, %E1\";\n     case 5:\n-      return output_move_neon (operands);\n+      return output_move_quad (operands);\n     case 7:\n       return \"vstrb.8 %q1, %E0\";\n     default:\n       gcc_unreachable ();\n       return \"\";\n     }\n }\n-  [(set_attr \"type\" \"mve_move,mve_move,mve_move,mve_move,mve_load,mve_move,mve_move,mve_store\")\n+  [(set_attr \"type\" \"mve_move,mve_move,mve_move,mve_move,mve_load,multiple,mve_move,mve_store\")\n    (set_attr \"length\" \"4,8,8,4,8,8,4,4\")\n    (set_attr \"thumb2_pool_range\" \"*,*,*,*,1018,*,*,*\")\n    (set_attr \"neg_pool_range\" \"*,*,*,*,996,*,*,*\")])"}, {"sha": "a039f9658ae26b72267232a215f0b0d58c0ba5b5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0efe7d8796e00a5737017fe472680b653bd83d90", "patch": "@@ -1,3 +1,7 @@\n+2020-03-20  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n+\n+\t* gcc.target/arm/mve/intrinsics/mve_move_gpr_to_gpr.c: New test.\n+\n 2020-03-20  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/94224"}, {"sha": "791b8529a052dfca42e12648b6967eca3a2a985e", "filename": "gcc/testsuite/gcc.target/arm/mve/intrinsics/mve_move_gpr_to_gpr.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmve%2Fintrinsics%2Fmve_move_gpr_to_gpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0efe7d8796e00a5737017fe472680b653bd83d90/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmve%2Fintrinsics%2Fmve_move_gpr_to_gpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fmve%2Fintrinsics%2Fmve_move_gpr_to_gpr.c?ref=0efe7d8796e00a5737017fe472680b653bd83d90", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-do compile  } */\n+/* { dg-require-effective-target arm_v8_1m_mve_fp_ok } */\n+/* { dg-add-options arm_v8_1m_mve_fp } */\n+/* { dg-additional-options \"-O2 -mfloat-abi=softfp\" } */\n+\n+#include \"arm_mve.h\"\n+\n+extern int bar (float16x8_t, float16_t);\n+\n+extern void foobar (float16_t);\n+\n+int\n+foo (float16x8_t a, float16_t b)\n+{\n+  foobar (b);\n+  return bar (a, b);\n+}\n+"}]}