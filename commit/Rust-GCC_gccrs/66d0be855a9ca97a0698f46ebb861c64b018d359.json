{"sha": "66d0be855a9ca97a0698f46ebb861c64b018d359", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjZkMGJlODU1YTljYTk3YTA2OThmNDZlYmI4NjFjNjRiMDE4ZDM1OQ==", "commit": {"author": {"name": "Janis Johnson", "email": "janis187@us.ibm.com", "date": "2008-05-20T23:29:56Z"}, "committer": {"name": "Janis Johnson", "email": "janis@gcc.gnu.org", "date": "2008-05-20T23:29:56Z"}, "message": "scandump.exp (scan-dump): Handle non-existent dump file.\n\n\t* lib/scandump.exp (scan-dump): Handle non-existent dump file.\n\t(scan-dump-times): Ditto.\n\t(scan-dump-not): Ditto.\n\t(scan-dump-dem): Ditto.\n\t(scan-dump-dem-not): Ditto.\n\nFrom-SVN: r135690", "tree": {"sha": "aab72f92437c4dd0949a5bea81bc8904d77140fd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aab72f92437c4dd0949a5bea81bc8904d77140fd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66d0be855a9ca97a0698f46ebb861c64b018d359", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66d0be855a9ca97a0698f46ebb861c64b018d359", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66d0be855a9ca97a0698f46ebb861c64b018d359", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66d0be855a9ca97a0698f46ebb861c64b018d359/comments", "author": null, "committer": null, "parents": [{"sha": "8a93eaf25ec07269ee7c47641317a640a9ac2964", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a93eaf25ec07269ee7c47641317a640a9ac2964", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a93eaf25ec07269ee7c47641317a640a9ac2964"}], "stats": {"total": 73, "additions": 53, "deletions": 20}, "files": [{"sha": "ab4b65a5b690414d3d70b4656b9146036cdfbcd6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66d0be855a9ca97a0698f46ebb861c64b018d359/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66d0be855a9ca97a0698f46ebb861c64b018d359/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=66d0be855a9ca97a0698f46ebb861c64b018d359", "patch": "@@ -1,5 +1,11 @@\n 2008-05-20  Janis Johnson  <janis187@us.ibm.com>\n \n+\t* lib/scandump.exp (scan-dump): Handle non-existent dump file.\n+\t(scan-dump-times): Ditto.\n+\t(scan-dump-not): Ditto.\n+\t(scan-dump-dem): Ditto.\n+\t(scan-dump-dem-not): Ditto.\n+\n \t* obj-c++.dg/bitfield-1.mm: XFAIL for ICE; move dg-options after other\n \ttest directives; use dg-prune-output instead of dg-excess-errors for\n \tpossible message to ignore; adjust line numbers for messages."}, {"sha": "373052b45665d8ac9fbfe2b65898062475a71950", "filename": "gcc/testsuite/lib/scandump.exp", "status": "modified", "additions": 47, "deletions": 20, "changes": 67, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66d0be855a9ca97a0698f46ebb861c64b018d359/gcc%2Ftestsuite%2Flib%2Fscandump.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66d0be855a9ca97a0698f46ebb861c64b018d359/gcc%2Ftestsuite%2Flib%2Fscandump.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fscandump.exp?ref=66d0be855a9ca97a0698f46ebb861c64b018d359", "patch": "@@ -49,18 +49,23 @@ proc scan-dump { args } {\n     # A cleaner solution would require a new DejaGnu release.\n     upvar 3 name testcase\n \n+    set suf [dump-suffix [lindex $args 2]]\n+    set testname \"$testcase scan-[lindex $args 0]-dump $suf \\\"[lindex $args 1]\\\"\"\n     set src [file tail [lindex $testcase 0]]\n-    set output_file \"[glob $src.[lindex $args 2]]\"\n+    set output_file \"[glob -nocomplain $src.[lindex $args 2]]\"\n+    if { $output_file == \"\" } {\n+\tfail \"$testname: dump file does not exist\"\n+\treturn\n+    }\n \n     set fd [open $output_file r]\n     set text [read $fd]\n     close $fd\n \n-    set suf [dump-suffix [lindex $args 2]]\n     if [regexp -- [lindex $args 1] $text] {\n-\tpass \"$testcase scan-[lindex $args 0]-dump $suf \\\"[lindex $args 1]\\\"\"\n+\tpass \"$testname\"\n     } else {\n-\tfail \"$testcase scan-[lindex $args 0]-dump $suf \\\"[lindex $args 1]\\\"\"\n+\tfail \"$testname\"\n     }\n }\n \n@@ -86,18 +91,23 @@ proc scan-dump-times { args } {\n     # A cleaner solution would require a new DejaGnu release.\n     upvar 3 name testcase\n \n+    set suf [dump-suffix [lindex $args 3]]\n+    set testname \"$testcase scan-[lindex $args 0]-dump-times $suf \\\"[lindex $args 1]\\\" [lindex $args 2]\"\n     set src [file tail [lindex $testcase 0]]\n-    set output_file \"[glob $src.[lindex $args 3]]\"\n+    set output_file \"[glob -nocomplain $src.[lindex $args 3]]\"\n+    if { $output_file == \"\" } {\n+\tfail \"$testname: dump file does not exist\"\n+\treturn\n+    }\n \n     set fd [open $output_file r]\n     set text [read $fd]\n     close $fd\n \n-    set suf [dump-suffix [lindex $args 3]]\n     if { [llength [regexp -inline -all -- [lindex $args 1] $text]] == [lindex $args 2]} {\n-        pass \"$testcase scan-[lindex $args 0]-dump-times $suf \\\"[lindex $args 1]\\\" [lindex $args 2]\"\n+        pass \"$testname\"\n     } else {\n-        fail \"$testcase scan-[lindex $args 0]-dump-times $suf \\\"[lindex $args 1]\\\" [lindex $args 2]\"\n+        fail \"$testname\"\n     }\n }\n \n@@ -122,18 +132,24 @@ proc scan-dump-not { args } {\n     # it still stores the filename of the testcase in a local variable \"name\".\n     # A cleaner solution would require a new DejaGnu release.\n     upvar 3 name testcase\n+\n+    set suf [dump-suffix [lindex $args 2]]\n+    set testname \"$testcase scan-[lindex $args 0]-dump-not $suf \\\"[lindex $args 1]\\\"\"\n     set src [file tail [lindex $testcase 0]]\n-    set output_file \"[glob $src.[lindex $args 2]]\"\n+    set output_file \"[glob -nocomplain $src.[lindex $args 2]]\"\n+    if { $output_file == \"\" } {\n+\tfail \"$testname: dump file does not exist\"\n+\treturn\n+    }\n \n     set fd [open $output_file r]\n     set text [read $fd]\n     close $fd\n \n-    set suf [dump-suffix [lindex $args 2]]\n     if ![regexp -- [lindex $args 1] $text] {\n-\tpass \"$testcase scan-[lindex $args 0]-dump-not $suf \\\"[lindex $args 1]\\\"\"\n+\tpass \"$testname\"\n     } else {\n-\tfail \"$testcase scan-[lindex $args 0]-dump-not $suf \\\"[lindex $args 1]\\\"\"\n+\tfail \"$testname\"\n     }\n }\n \n@@ -168,18 +184,23 @@ proc scan-dump-dem { args } {\n     }\n \n     upvar 3 name testcase\n+    set suf [dump-suffix [lindex $args 2]]\n+    set testname \"$testcase scan-[lindex $args 0]-dump-dem $suf \\\"[lindex $args 1]\\\"\"\n     set src [file tail [lindex $testcase 0]]\n-    set output_file \"[glob $src.[lindex $args 2]]\"\n+    set output_file \"[glob -nocomplain $src.[lindex $args 2]]\"\n+    if { $output_file == \"\" } {\n+\tfail \"$testname: dump file does not exist\"\n+\treturn\n+    }\n \n     set fd [open \"| $cxxfilt < $output_file\" r]\n     set text [read $fd]\n     close $fd\n \n-    set suf [dump-suffix [lindex $args 2]]\n     if [regexp -- [lindex $args 1] $text] {\n-\tpass \"$testcase scan-[lindex $args 0]-dump-dem $suf \\\"[lindex $args 1]\\\"\"\n+\tpass \"$testname\"\n     } else {\n-\tfail \"$testcase scan-[lindex $args 0]-dump-dem $suf \\\"[lindex $args 1]\\\"\"\n+\tfail \"$testname\"\n     }\n }\n \n@@ -213,17 +234,23 @@ proc scan-dump-dem-not { args } {\n     }\n \n     upvar 3 name testcase\n+\n+    set suf [dump-suffix [lindex $args 2]]\n+    set testname \"$testcase scan-[lindex $args 0]-dump-dem-not $suf \\\"[lindex $args 1]\\\"\"\n     set src [file tail [lindex $testcase 0]]\n-    set output_file \"[glob $src.[lindex $args 2]]\"\n+    set output_file \"[glob -nocomplain $src.[lindex $args 2]]\"\n+    if { $output_file == \"\" } {\n+\tfail \"$testname: dump file does not exist\"\n+\treturn\n+    }\n \n     set fd [open \"| $cxxfilt < $output_file\" r]\n     set text [read $fd]\n     close $fd\n \n-    set suf [dump-suffix [lindex $args 2]]\n     if ![regexp -- [lindex $args 1] $text] {\n-\tpass \"$testcase scan-[lindex $args 0]-dump-dem-not $suf \\\"[lindex $args 1]\\\"\"\n+\tpass \"$testname\"\n     } else {\n-\tfail \"$testcase scan-[lindex $args 0]-dump-dem-not $suf \\\"[lindex $args 1]\\\"\"\n+\tfail \"$testname\"\n     }\n }"}]}