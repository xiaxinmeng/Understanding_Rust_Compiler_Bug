{"sha": "5e5812126c454414459a8f9fa46b7ff3032c8c53", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWU1ODEyMTI2YzQ1NDQxNDQ1OWE4ZjlmYTQ2YjdmZjMwMzJjOGM1Mw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2013-08-31T13:47:20Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2013-08-31T13:47:20Z"}, "message": "cgraph.c (cgraph_get_body): Update call of lto_input_function_body.\n\n\n\t* cgraph.c (cgraph_get_body): Update call of lto_input_function_body.\n\t* gimple-streamer-in.c (input_gimple_stmt): Move sanity check to ...\n\t* tree-cfg.c (verify_gimple_label): ... here.\n\t* ipa-utils.c: Include lto-streamer.h, ipa-inline.h\n\t(ipa_merge_profiles): New function.\n\t* lto-streamer-in.c (lto_read_body): Take node instead of fn_decl.\n\t(lto_input_function_body): Likewise.\n\t* ipa-utils.h (ipa_merge_profiles): Declare.\n\t* lto-streamer.h (lto_input_function_body): Update prototype.\n\t(emit_label_in_global_context_p): Remove.\n\t* lto-symtab.c: Include ipa-utils.h\n\t(lto_cgraph_replace_node): Use ipa_merge_profiles.\n\nFrom-SVN: r202131", "tree": {"sha": "0b6aa3ca927f90f796fadadf97fd76f1e2d242e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b6aa3ca927f90f796fadadf97fd76f1e2d242e1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5e5812126c454414459a8f9fa46b7ff3032c8c53", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e5812126c454414459a8f9fa46b7ff3032c8c53", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e5812126c454414459a8f9fa46b7ff3032c8c53", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e5812126c454414459a8f9fa46b7ff3032c8c53/comments", "author": null, "committer": null, "parents": [{"sha": "4843f03206f7ee188c5f7368ec6e64da7e90a396", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4843f03206f7ee188c5f7368ec6e64da7e90a396", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4843f03206f7ee188c5f7368ec6e64da7e90a396"}], "stats": {"total": 27, "additions": 18, "deletions": 9}, "files": [{"sha": "f569cdab7493e3a979788a19b2cbb83345ddd5da", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5e5812126c454414459a8f9fa46b7ff3032c8c53", "patch": "@@ -2,10 +2,16 @@\n \n \t* cgraph.c (cgraph_get_body): Update call of lto_input_function_body.\n \t* gimple-streamer-in.c (input_gimple_stmt): Move sanity check to ...\n+\t* tree-cfg.c (verify_gimple_label): ... here.\n \t* ipa-utils.c: Include lto-streamer.h, ipa-inline.h\n \t(ipa_merge_profiles): New function.\n \t* lto-streamer-in.c (lto_read_body): Take node instead of fn_decl.\n \t(lto_input_function_body): Likewise.\n+\t* ipa-utils.h (ipa_merge_profiles): Declare.\n+\t* lto-streamer.h (lto_input_function_body): Update prototype.\n+\t(emit_label_in_global_context_p): Remove.\n+\t* lto-symtab.c: Include ipa-utils.h\n+\t(lto_cgraph_replace_node): Use ipa_merge_profiles.\n \n 2013-08-31  Jan Hubicka  <jh@suse.cz>\n "}, {"sha": "77ed6cee63af35957bfe4c1c350b61bd6e6ece75", "filename": "gcc/ipa-utils.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Fipa-utils.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Fipa-utils.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-utils.h?ref=5e5812126c454414459a8f9fa46b7ff3032c8c53", "patch": "@@ -44,6 +44,8 @@ void ipa_free_postorder_info (void);\n vec<cgraph_node_ptr> ipa_get_nodes_in_cycle (struct cgraph_node *);\n int ipa_reverse_postorder (struct cgraph_node **);\n tree get_base_var (tree);\n+void ipa_merge_profiles (struct cgraph_node *dst,\n+\t\t\t struct cgraph_node *src);\n \n /* In ipa-devirt.c  */\n "}, {"sha": "4a2ea0b2993d659d0840b4e414fba1eb927173d1", "filename": "gcc/lto-streamer.h", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Flto-streamer.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Flto-streamer.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer.h?ref=5e5812126c454414459a8f9fa46b7ff3032c8c53", "patch": "@@ -834,7 +834,8 @@ extern void lto_streamer_hooks_init (void);\n /* In lto-streamer-in.c */\n extern void lto_input_cgraph (struct lto_file_decl_data *, const char *);\n extern void lto_reader_init (void);\n-extern void lto_input_function_body (struct lto_file_decl_data *, tree,\n+extern void lto_input_function_body (struct lto_file_decl_data *,\n+\t\t\t\t     struct cgraph_node *,\n \t\t\t\t     const char *);\n extern void lto_input_constructors_and_inits (struct lto_file_decl_data *,\n \t\t\t\t\t      const char *);\n@@ -1030,14 +1031,6 @@ lto_tree_ref_encoder_get_tree (struct lto_tree_ref_encoder *encoder,\n   return encoder->trees[idx];\n }\n \n-\n-/* Return true if LABEL should be emitted in the global context.  */\n-static inline bool\n-emit_label_in_global_context_p (tree label)\n-{\n-  return DECL_NONLOCAL (label) || FORCED_LABEL (label);\n-}\n-\n /* Return number of encoded nodes in ENCODER.  */\n static inline int\n lto_symtab_encoder_size (lto_symtab_encoder_t encoder)"}, {"sha": "83026ef7c8c0b530d3d0a4bc641c61bc11affd69", "filename": "gcc/lto-symtab.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Flto-symtab.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Flto-symtab.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-symtab.c?ref=5e5812126c454414459a8f9fa46b7ff3032c8c53", "patch": "@@ -28,6 +28,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"hashtab.h\"\n #include \"plugin-api.h\"\n #include \"lto-streamer.h\"\n+#include \"ipa-utils.h\"\n \n /* Vector to keep track of external variables we've seen so far.  */\n vec<tree, va_gc> *lto_global_var_decls;\n@@ -80,6 +81,7 @@ lto_cgraph_replace_node (struct cgraph_node *node,\n   /* Redirect incomming references.  */\n   ipa_clone_referring ((symtab_node)prevailing_node, &node->symbol.ref_list);\n \n+  ipa_merge_profiles (prevailing_node, node);\n   lto_free_function_in_decl_state_for_node ((symtab_node)node);\n \n   if (node->symbol.decl != prevailing_node->symbol.decl)"}, {"sha": "bc1e1ba90fcca0db090b93cef6a82133ab6ee25e", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5e5812126c454414459a8f9fa46b7ff3032c8c53/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=5e5812126c454414459a8f9fa46b7ff3032c8c53", "patch": "@@ -4252,6 +4252,12 @@ verify_gimple_label (gimple stmt)\n \n   if (TREE_CODE (decl) != LABEL_DECL)\n     return true;\n+  if (!DECL_NONLOCAL (decl) && !FORCED_LABEL (decl)\n+      && DECL_CONTEXT (decl) != current_function_decl)\n+    {\n+      error (\"label's context is not the current function decl\");\n+      err |= true;\n+    }\n \n   uid = LABEL_DECL_UID (decl);\n   if (cfun->cfg"}]}