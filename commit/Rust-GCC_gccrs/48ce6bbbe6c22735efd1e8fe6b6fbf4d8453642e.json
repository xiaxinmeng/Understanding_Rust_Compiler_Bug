{"sha": "48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDhjZTZiYmJlNmMyMjczNWVmZDFlOGZlNmI2ZmJmNGQ4NDUzNjQyZQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2001-02-12T14:06:22Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2001-02-12T14:06:22Z"}, "message": "mkdeps.c (deps_add_default_target): Robustify.\n\n\t* mkdeps.c (deps_add_default_target): Robustify. Add\n\tbasename component only.\n\t* cpp.texi (-M): Describe how default target is generated.\n\t* invoke.texi (-M): Likewise.\n\nFrom-SVN: r39602", "tree": {"sha": "484bc05f164378c9dbb5ea022669b86655e63b43", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/484bc05f164378c9dbb5ea022669b86655e63b43"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/comments", "author": null, "committer": null, "parents": [{"sha": "823a99190da6b3498f94ab042597b53dc44636b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/823a99190da6b3498f94ab042597b53dc44636b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/823a99190da6b3498f94ab042597b53dc44636b8"}], "stats": {"total": 39, "additions": 25, "deletions": 14}, "files": [{"sha": "5838071d35d923c8ab073846b9028b9b4c7846ab", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "patch": "@@ -1,3 +1,10 @@\n+2001-02-12  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* mkdeps.c (deps_add_default_target): Robustify. Add\n+\tbasename component only.\n+\t* cpp.texi (-M): Describe how default target is generated.\n+\t* invoke.texi (-M): Likewise.\n+\n 2001-02-12  Kazu Hirata  <kazu@hxi.com>\n \n \t* toplev.c (push_float_handler): Remove."}, {"sha": "756f50ac0a1a088ce156073a4f034d8da47546cc", "filename": "gcc/cpp.texi", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2Fcpp.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2Fcpp.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpp.texi?ref=48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "patch": "@@ -3495,7 +3495,10 @@ suitable for @code{make} describing the dependencies of the main source\n file.  The preprocessor outputs one @code{make} rule containing the\n object file name for that source file, a colon, and the names of all the\n included files, including those coming from @samp{-include} or\n-@samp{-imacros} command line options.  If there are many included files\n+@samp{-imacros} command line options.  Unless specified explicitly (with\n+@samp{-MT} or @samp{-MQ}), the object file name consists of the basename\n+of the source file with any suffix replaced with object file suffix.\n+If there are many included files\n then the rule is split into several lines using @samp{\\}-newline.\n \n @item -MM"}, {"sha": "e77d4c700718a833986b4dd1a3c2d6fd4586be00", "filename": "gcc/invoke.texi", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Finvoke.texi?ref=48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "patch": "@@ -3364,8 +3364,10 @@ Instead of outputting the result of preprocessing, output a rule\n suitable for @code{make} describing the dependencies of the main source\n file.  The preprocessor outputs one @code{make} rule containing the\n object file name for that source file, a colon, and the names of all the\n-included files.  If there are many included files then the rule is split\n-into several lines using @samp{\\}-newline.\n+included files.  Unless overridden explicitly, the object file name\n+consists of the basename of the source file with any suffix replaced with\n+object file suffix. If there are many included files then the\n+rule is split into several lines using @samp{\\}-newline.\n \n @samp{-M} implies @samp{-E}.\n "}, {"sha": "14935b328a6e1ff77289ebd8c328861edd00c78e", "filename": "gcc/mkdeps.c", "status": "modified", "additions": 10, "deletions": 11, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2Fmkdeps.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e/gcc%2Fmkdeps.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmkdeps.c?ref=48ce6bbbe6c22735efd1e8fe6b6fbf4d8453642e", "patch": "@@ -180,8 +180,6 @@ deps_add_default_target (d, tgt)\n      struct deps *d;\n      const char *tgt;\n {\n-  char *o, *suffix;\n-\n   /* Only if we have no targets.  */\n   if (d->ntargets)\n     return;\n@@ -190,19 +188,20 @@ deps_add_default_target (d, tgt)\n     deps_add_target (d, \"-\", 1);\n   else\n     {\n-      o = (char *) alloca (strlen (tgt) + 8);\n-\n-      strcpy (o, tgt);\n-      suffix = strrchr (o, '.');\n-\n #ifndef OBJECT_SUFFIX\n # define OBJECT_SUFFIX \".o\"\n #endif\n+      char *start = basename (tgt);\n+      char *o = (char *) alloca (strlen (start) + strlen (OBJECT_SUFFIX) + 1);\n+      char *suffix;\n \n-      if (suffix)\n-\tstrcpy (suffix, OBJECT_SUFFIX);\n-      else\n-\tstrcat (o, OBJECT_SUFFIX);\n+      strcpy (o, start);\n+      \n+      suffix = strrchr (o, '.');\n+      if (!suffix)\n+        suffix = o + strlen (o);\n+      strcpy (suffix, OBJECT_SUFFIX);\n+      \n       deps_add_target (d, o, 1);\n     }\n }"}]}