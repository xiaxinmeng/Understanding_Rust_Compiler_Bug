{"sha": "32273f9fa66e66aa0e5316b68ec56c6290c22b65", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzIyNzNmOWZhNjZlNjZhYTBlNTMxNmI2OGVjNTZjNjI5MGMyMmI2NQ==", "commit": {"author": {"name": "Lee Millward", "email": "lee.millward@codesourcery.com", "date": "2006-09-21T18:33:49Z"}, "committer": {"name": "Lee Millward", "email": "lmillward@gcc.gnu.org", "date": "2006-09-21T18:33:49Z"}, "message": "re PR c++/28303 (ICE on invalid typedef)\n\n        PR c++/28303\n        * decl.c (grokdeclarator): Return error_mark_node on\n        declaration with two or more data types.\n\n        * g++.dg/template/typedef6.C: New test.\n        * g++.dg/init/error1.C: Adjust error markers.\n        * g++.dg/parse/crash9.C: Likewise.\n        * g++.dg/template/crash55.C: Likewise.\n\nFrom-SVN: r117118", "tree": {"sha": "01824585fe7dd4573fbcd63220aa1f7eb2c8f775", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/01824585fe7dd4573fbcd63220aa1f7eb2c8f775"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/32273f9fa66e66aa0e5316b68ec56c6290c22b65", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32273f9fa66e66aa0e5316b68ec56c6290c22b65", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32273f9fa66e66aa0e5316b68ec56c6290c22b65", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32273f9fa66e66aa0e5316b68ec56c6290c22b65/comments", "author": null, "committer": null, "parents": [{"sha": "d2a8ac2cf23c32f56a8aa2a820859aa91b810f31", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2a8ac2cf23c32f56a8aa2a820859aa91b810f31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2a8ac2cf23c32f56a8aa2a820859aa91b810f31"}], "stats": {"total": 28, "additions": 25, "deletions": 3}, "files": [{"sha": "f6b83bd7894563f9cdfe8dc1f7baf35142a9cd41", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=32273f9fa66e66aa0e5316b68ec56c6290c22b65", "patch": "@@ -3,6 +3,10 @@\n \tPR c++/28861\n \t* decl.c (shadow_tag): Return error_mark_node\n         if maybe_process_partial_specialization failed.\n+\n+\tPR c++/28303\n+        * decl.c (grokdeclarator): Return error_mark_node on\n+        declaration with two or more data types.\n \t\n 2006-09-20  Danny Smith  <dannysmith@users.sourceforge.net>\n "}, {"sha": "7b932c05b1ec7d062899387bc2aac5d6f595ea21", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=32273f9fa66e66aa0e5316b68ec56c6290c22b65", "patch": "@@ -7117,7 +7117,11 @@ grokdeclarator (const cp_declarator *declarator,\n   /* If there were multiple types specified in the decl-specifier-seq,\n      issue an error message.  */\n   if (declspecs->multiple_types_p)\n-    error (\"two or more data types in declaration of %qs\", name);\n+    {\n+      error (\"two or more data types in declaration of %qs\", name);\n+      return error_mark_node;\n+    }\n+\n   /* Extract the basic type from the decl-specifier-seq.  */\n   type = declspecs->type;\n   if (type == error_mark_node)"}, {"sha": "49ea82513864ef4545bd880f0df1225844b05ae7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=32273f9fa66e66aa0e5316b68ec56c6290c22b65", "patch": "@@ -3,6 +3,12 @@\n         PR c++/28861\n         * g++.dg/template/spec32.C: New test.\n         * g++.dg/parse/crash9.C: Adjust error markers.\n+\n+\tPR c++/28303\n+        * g++.dg/template/typedef6.C: New test.\n+        * g++.dg/init/error1.C: Adjust error markers.\n+        * g++.dg/parse/crash9.C: Likewise.\n+        * g++.dg/template/crash55.C: Likewise.\n \t\n 2006-09-21  Janis Johnson  <janis187@us.ibm.com>\n "}, {"sha": "dd12e4cca43d546eabbca844e72ef27ca56bae6b", "filename": "gcc/testsuite/g++.dg/init/error1.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Ferror1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Ferror1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finit%2Ferror1.C?ref=32273f9fa66e66aa0e5316b68ec56c6290c22b65", "patch": "@@ -1,7 +1,7 @@\n // PR c++/12696\n \n struct A {\n-  static float b[10]; // { dg-error \"\" }\n+  static float b[10];\n }\n \n float A::b[] = {1,2,3}; // { dg-error \"\" }"}, {"sha": "377603dcff3d394c804a4187ddbb7e8d614b5f1b", "filename": "gcc/testsuite/g++.dg/template/crash55.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash55.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash55.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash55.C?ref=32273f9fa66e66aa0e5316b68ec56c6290c22b65", "patch": "@@ -1,6 +1,6 @@\n //PR c++/27668\n \n template<typename class T, T = T()> // { dg-error \"nested-name-specifier|two or more|valid type\" }\n-struct A {};                        // { dg-error \"definition\"\n+struct A {};                        // { dg-error \"definition|template\" }\n \n template<int> void foo(A<int>);     // { dg-error \"mismatch|constant|template argument\" }"}, {"sha": "cd2db634a2b015c7f427500ce15c96b77f122a0a", "filename": "gcc/testsuite/g++.dg/template/typedef6.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ftypedef6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32273f9fa66e66aa0e5316b68ec56c6290c22b65/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ftypedef6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ftypedef6.C?ref=32273f9fa66e66aa0e5316b68ec56c6290c22b65", "patch": "@@ -0,0 +1,8 @@\n+//PR c++/28303\n+\n+template<typename T> struct A\n+{\n+  typedef struct typename T::X X;       // { dg-error \"expected identifier|two or more\" }\n+};\n+\n+template<typename T> A<T>::X::X() {}    // { dg-error \"not a type|forbids declaration\" }"}]}