{"sha": "24a235c84f2a6d589e8a0d35121773232fcf787b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjRhMjM1Yzg0ZjJhNmQ1ODllOGEwZDM1MTIxNzczMjMyZmNmNzg3Yg==", "commit": {"author": {"name": "Christian Borntraeger", "email": "borntraeger@de.ibm.com", "date": "2010-05-17T07:52:27Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2010-05-17T07:52:27Z"}, "message": "s390.c: Define sane prefetch settings and activate flag_prefetch_loop_arrays on -O3.\n\n2010-05-17  Christian Borntraeger  <borntraeger@de.ibm.com>\n\n        * config/s390/s390.c: Define sane prefetch settings and activate\n        flag_prefetch_loop_arrays on -O3.\n        * config/s390/s390.h: Declare that read can use write prefetch.\n\nFrom-SVN: r159474", "tree": {"sha": "52e1f759e31d104d3b48c29f881d46d29bfe7204", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/52e1f759e31d104d3b48c29f881d46d29bfe7204"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/24a235c84f2a6d589e8a0d35121773232fcf787b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24a235c84f2a6d589e8a0d35121773232fcf787b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24a235c84f2a6d589e8a0d35121773232fcf787b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24a235c84f2a6d589e8a0d35121773232fcf787b/comments", "author": {"login": "borntraeger", "id": 3006059, "node_id": "MDQ6VXNlcjMwMDYwNTk=", "avatar_url": "https://avatars.githubusercontent.com/u/3006059?v=4", "gravatar_id": "", "url": "https://api.github.com/users/borntraeger", "html_url": "https://github.com/borntraeger", "followers_url": "https://api.github.com/users/borntraeger/followers", "following_url": "https://api.github.com/users/borntraeger/following{/other_user}", "gists_url": "https://api.github.com/users/borntraeger/gists{/gist_id}", "starred_url": "https://api.github.com/users/borntraeger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/borntraeger/subscriptions", "organizations_url": "https://api.github.com/users/borntraeger/orgs", "repos_url": "https://api.github.com/users/borntraeger/repos", "events_url": "https://api.github.com/users/borntraeger/events{/privacy}", "received_events_url": "https://api.github.com/users/borntraeger/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "18252dcfaa504d6711e6d96a05a5c360b2b7078c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18252dcfaa504d6711e6d96a05a5c360b2b7078c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18252dcfaa504d6711e6d96a05a5c360b2b7078c"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "7482a367f7cfc971d3ba056fc1f6d8a19f422d5c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24a235c84f2a6d589e8a0d35121773232fcf787b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24a235c84f2a6d589e8a0d35121773232fcf787b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=24a235c84f2a6d589e8a0d35121773232fcf787b", "patch": "@@ -1,3 +1,9 @@\n+2010-05-17  Christian Borntraeger  <borntraeger@de.ibm.com>\n+\n+        * config/s390/s390.c: Define sane prefetch settings and activate\n+        flag_prefetch_loop_arrays on -O3.\n+        * config/s390/s390.h: Declare that read can use write prefetch.\n+\n 2010-05-17  Jakub Jelinek  <jakub@redhat.com>\n \n \t* lto-streamer-out.c (lto_output): Fix --enable-checking=release"}, {"sha": "b660e36406f1edb193456d69f5e21daaa9751db4", "filename": "gcc/config/s390/s390.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24a235c84f2a6d589e8a0d35121773232fcf787b/gcc%2Fconfig%2Fs390%2Fs390.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24a235c84f2a6d589e8a0d35121773232fcf787b/gcc%2Fconfig%2Fs390%2Fs390.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390.c?ref=24a235c84f2a6d589e8a0d35121773232fcf787b", "patch": "@@ -1475,6 +1475,9 @@ optimization_options (int level ATTRIBUTE_UNUSED, int size ATTRIBUTE_UNUSED)\n      without maintaining a stack frame back-chain.  */\n   flag_asynchronous_unwind_tables = 1;\n \n+  if (HAVE_prefetch || optimize >= 3)\n+      flag_prefetch_loop_arrays = 1;\n+\n   /* Use MVCLE instructions to decrease code size if requested.  */\n   if (size != 0)\n     target_flags |= MASK_MVCLE;\n@@ -1661,6 +1664,19 @@ override_options (void)\n     }\n \n   set_param_value (\"max-pending-list-length\", 256);\n+  /* values for loop prefetching */\n+  set_param_value (\"l1-cache-line-size\", 256);\n+  if (!PARAM_SET_P (PARAM_L1_CACHE_SIZE))\n+    set_param_value (\"l1-cache-size\", 128);\n+  /* s390 has more than 2 levels and the size is much larger.  Since\n+     we are always running virtualized assume that we only get a small\n+     part of the caches above l1.  */\n+  if (!PARAM_SET_P (PARAM_L2_CACHE_SIZE))\n+    set_param_value (\"l2-cache-size\", 1500);\n+  if (!PARAM_SET_P (PARAM_PREFETCH_MIN_INSN_TO_MEM_RATIO))\n+    set_param_value (\"prefetch-min-insn-to-mem-ratio\", 2);\n+  if (!PARAM_SET_P (PARAM_SIMULTANEOUS_PREFETCHES))\n+    set_param_value (\"simultaneous-prefetches\", 6);\n }\n \n /* Map for smallest class containing reg regno.  */"}, {"sha": "1d74d30c000e48d1068e255b629d268888c107c3", "filename": "gcc/config/s390/s390.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24a235c84f2a6d589e8a0d35121773232fcf787b/gcc%2Fconfig%2Fs390%2Fs390.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24a235c84f2a6d589e8a0d35121773232fcf787b/gcc%2Fconfig%2Fs390%2Fs390.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390.h?ref=24a235c84f2a6d589e8a0d35121773232fcf787b", "patch": "@@ -989,4 +989,6 @@ do {\t\t\t\t\t\t\t\t\t\\\n   (TARGET_LONG_DISPLACEMENT? ((d) >= -524288 && (d) <= 524287) \\\n                            : ((d) >= 0 && (d) <= 4095))\n \n+/* Reads can reuse write prefetches, used by tree-ssa-prefetch-loops.c.  */\n+#define READ_CAN_USE_WRITE_PREFETCH 1\n #endif"}]}