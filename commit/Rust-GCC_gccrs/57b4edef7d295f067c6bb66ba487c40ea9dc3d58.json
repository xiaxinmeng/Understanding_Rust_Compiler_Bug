{"sha": "57b4edef7d295f067c6bb66ba487c40ea9dc3d58", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTdiNGVkZWY3ZDI5NWYwNjdjNmJiNjZiYTQ4N2M0MGVhOWRjM2Q1OA==", "commit": {"author": {"name": "Mark Wielaard", "email": "mark@klomp.org", "date": "2003-10-27T11:02:44Z"}, "committer": {"name": "Mark Wielaard", "email": "mark@gcc.gnu.org", "date": "2003-10-27T11:02:44Z"}, "message": "Reported by Helmer Kraemer <hkraemer@freenet.de>\n\n       Reported by Helmer Kraemer <hkraemer@freenet.de>\n       * java/util/jar/JarInputStream.java (readManifest): Don't call\n       closeEntry().\n\n       * java/util/zip/DeflaterOutputStream.java (inbufWrite): New method.\n       (finish): Use inbufWrite().\n       (write(int)): Likewise.\n       (write(byte[],int,int)): Likewise.\n\nFrom-SVN: r72976", "tree": {"sha": "925879ccbf56ae0aba32d61adcf4d4d421adde0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/925879ccbf56ae0aba32d61adcf4d4d421adde0a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/57b4edef7d295f067c6bb66ba487c40ea9dc3d58", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57b4edef7d295f067c6bb66ba487c40ea9dc3d58", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57b4edef7d295f067c6bb66ba487c40ea9dc3d58", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57b4edef7d295f067c6bb66ba487c40ea9dc3d58/comments", "author": null, "committer": null, "parents": [{"sha": "b19ee4bd24bb2ef06911fdf609a156171e2a4e0d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b19ee4bd24bb2ef06911fdf609a156171e2a4e0d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b19ee4bd24bb2ef06911fdf609a156171e2a4e0d"}], "stats": {"total": 42, "additions": 23, "deletions": 19}, "files": [{"sha": "a7fe99ad1ccbcb33e4994f22499cb6f0830a565d", "filename": "libjava/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57b4edef7d295f067c6bb66ba487c40ea9dc3d58/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57b4edef7d295f067c6bb66ba487c40ea9dc3d58/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=57b4edef7d295f067c6bb66ba487c40ea9dc3d58", "patch": "@@ -1,3 +1,14 @@\n+2003-10-26  Mark Wielaard  <mark@klomp.org>\n+\n+\tReported by Helmer Kraemer <hkraemer@freenet.de>\n+\t* java/util/jar/JarInputStream.java (readManifest): Don't call\n+\tcloseEntry().\n+\n+\t* java/util/zip/DeflaterOutputStream.java (inbufWrite): New method.\n+\t(finish): Use inbufWrite().\n+\t(write(int)): Likewise.\n+\t(write(byte[],int,int)): Likewise.\n+\n 2003-10-26  Bryce McKinlay  <bryce@mckinlay.net.nz>\n \n \t* java/lang/reflect/AccessibleObject.java (secureSetAccessible):"}, {"sha": "daf935fa70a0cfee6d9153d99faf0931fc60e3b9", "filename": "libjava/java/util/jar/JarInputStream.java", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57b4edef7d295f067c6bb66ba487c40ea9dc3d58/libjava%2Fjava%2Futil%2Fjar%2FJarInputStream.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57b4edef7d295f067c6bb66ba487c40ea9dc3d58/libjava%2Fjava%2Futil%2Fjar%2FJarInputStream.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fjar%2FJarInputStream.java?ref=57b4edef7d295f067c6bb66ba487c40ea9dc3d58", "patch": "@@ -116,7 +116,6 @@ private void readManifest(boolean verify) throws IOException\n \t  }\n \tfirstEntry = (JarEntry) super.getNextEntry();\n       }\n-    closeEntry();\n \n     if (verify)\n       {"}, {"sha": "6a4fa95886bd73e712137553cc228fae1674af9d", "filename": "libjava/java/util/zip/DeflaterOutputStream.java", "status": "modified", "additions": 12, "deletions": 18, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/57b4edef7d295f067c6bb66ba487c40ea9dc3d58/libjava%2Fjava%2Futil%2Fzip%2FDeflaterOutputStream.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/57b4edef7d295f067c6bb66ba487c40ea9dc3d58/libjava%2Fjava%2Futil%2Fzip%2FDeflaterOutputStream.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2Fzip%2FDeflaterOutputStream.java?ref=57b4edef7d295f067c6bb66ba487c40ea9dc3d58", "patch": "@@ -127,12 +127,7 @@ public DeflaterOutputStream(OutputStream out, Deflater defl, int bufsize)\n    */\n   public void finish () throws IOException\n   {\n-    if (inbufLength > 0)\n-      {\n-\tdef.setInput (inbuf, 0, inbufLength);\n-\tdeflate ();\n-\tinbufLength = 0;\n-      }\n+    inbufWrite();\n     def.finish();\n     while (! def.finished ())\n       {\n@@ -145,28 +140,27 @@ public void finish () throws IOException\n   public void write (int bval) throws IOException\n   {\n     if (inbuf == null)\n-      {\n-\tinbuf = new byte[128];\n-      }\n+      inbuf = new byte[128];\n     else if (inbufLength == inbuf.length)\n-      {\n-\tdef.setInput (inbuf, 0, inbufLength);\n-\tdeflate ();\n-\tinbufLength = 0;\n-      }\n+      inbufWrite ();\n     inbuf[inbufLength++] = (byte) bval;\n   }\n \n   public void write (byte[] buf, int off, int len) throws IOException\n+  {\n+    inbufWrite ();\n+    def.setInput (buf, off, len);\n+    deflate ();\n+  }\n+\n+  private void inbufWrite () throws IOException\n   {\n     if (inbufLength > 0)\n       {\n-\tdef.setInput (inbuf, 0, inbufLength);\n-\tdeflate ();\n+\tint size = inbufLength;\n \tinbufLength = 0;\n+\twrite (inbuf, 0, size);\n       }\n-    def.setInput (buf, off, len);\n-    deflate ();\n   }\n \n   // Used, if needed, for write(int)."}]}