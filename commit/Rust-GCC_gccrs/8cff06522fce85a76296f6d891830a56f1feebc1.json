{"sha": "8cff06522fce85a76296f6d891830a56f1feebc1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGNmZjA2NTIyZmNlODVhNzYyOTZmNmQ4OTE4MzBhNTZmMWZlZWJjMQ==", "commit": {"author": {"name": "Vinay Kumar", "email": "vinay.kumar@blackfigtech.com", "date": "2018-10-04T18:23:25Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-10-04T18:23:25Z"}, "message": "invoke.texi (-Wno-prio-ctor-dtor): Document new warning -Wno-prio-ctor-dtor.\n\n\t* doc/invoke.texi (-Wno-prio-ctor-dtor): Document new warning\n\t-Wno-prio-ctor-dtor.\n\n\t* c-attribs.c (get_priority): Add a warning flag warn_prio_ctor_dtor\n\tto generate constructor destructor priority warning.\n\t* c.opt (-Wprio-ctor-dtor): New option.\n\n\t* c-c++-common/Wprio-ctor-dtor.c: New test.\n\nFrom-SVN: r264853", "tree": {"sha": "77b5bd8b9e5a9bf1326f8d5f1623e59700365ec8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/77b5bd8b9e5a9bf1326f8d5f1623e59700365ec8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8cff06522fce85a76296f6d891830a56f1feebc1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cff06522fce85a76296f6d891830a56f1feebc1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8cff06522fce85a76296f6d891830a56f1feebc1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cff06522fce85a76296f6d891830a56f1feebc1/comments", "author": null, "committer": null, "parents": [{"sha": "f4ebbd243f887b3c5e01c65ad80a8f64a8261e61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4ebbd243f887b3c5e01c65ad80a8f64a8261e61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4ebbd243f887b3c5e01c65ad80a8f64a8261e61"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "f6de4aab25fb58fb51f15046baa6da57c053f844", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8cff06522fce85a76296f6d891830a56f1feebc1", "patch": "@@ -1,3 +1,8 @@\n+2018-10-04  Vinay Kumar  <vinay.kumar@blackfigtech.com>\n+\n+\t* doc/invoke.texi (-Wno-prio-ctor-dtor): Document new warning\n+\t-Wno-prio-ctor-dtor.\n+\n 2018-10-04  David Malcolm  <dmalcolm@redhat.com>\n \n \t* Makefile.in (OBJS): Add opt-problem.o."}, {"sha": "b6ff1f783b32ed8f47ef97a2de7e9bed0148d842", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=8cff06522fce85a76296f6d891830a56f1feebc1", "patch": "@@ -1,3 +1,9 @@\n+2018-10-04  Vinay Kumar  <vinay.kumar@blackfigtech.com>\n+\n+\t* c-attribs.c (get_priority): Add a warning flag warn_prio_ctor_dtor\n+\tto generate constructor destructor priority warning.\n+\t* c.opt (-Wprio-ctor-dtor): New option.\n+\n 2018-10-01  Jason Merrill  <jason@redhat.com>\n \n \t* c-lex.c (c_common_has_attribute): Add no_unique_address."}, {"sha": "4416b5042f7592762b2850cfed33bbc6509626b9", "filename": "gcc/c-family/c-attribs.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fc-family%2Fc-attribs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fc-family%2Fc-attribs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-attribs.c?ref=8cff06522fce85a76296f6d891830a56f1feebc1", "patch": "@@ -1350,12 +1350,12 @@ get_priority (tree args, bool is_destructor)\n   if (pri <= MAX_RESERVED_INIT_PRIORITY)\n     {\n       if (is_destructor)\n-\twarning (0,\n+\twarning (OPT_Wprio_ctor_dtor,\n \t\t \"destructor priorities from 0 to %d are reserved \"\n \t\t \"for the implementation\",\n \t\t MAX_RESERVED_INIT_PRIORITY);\n       else\n-\twarning (0,\n+\twarning (OPT_Wprio_ctor_dtor,\n \t\t \"constructor priorities from 0 to %d are reserved \"\n \t\t \"for the implementation\",\n \t\t MAX_RESERVED_INIT_PRIORITY);"}, {"sha": "54603486ed1bd559b35f32df018395af381d8f23", "filename": "gcc/c-family/c.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fc-family%2Fc.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fc-family%2Fc.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc.opt?ref=8cff06522fce85a76296f6d891830a56f1feebc1", "patch": "@@ -973,6 +973,10 @@ Wpragmas\n C ObjC C++ ObjC++ Var(warn_pragmas) Init(1) Warning\n Warn about misuses of pragmas.\n \n+Wprio-ctor-dtor\n+C ObjC C++ ObjC++ Var(warn_prio_ctor_dtor) Init(1) Warning\n+Warn if constructor or destructors with priorities from 0 to 100 are used.\n+\n Wproperty-assign-default\n ObjC ObjC++ Var(warn_property_assign_default) Init(1) Warning\n Warn if a property for an Objective-C object has no assign semantics specified."}, {"sha": "89c2eda58c47225a5997bbdf25788e2f97141f38", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=8cff06522fce85a76296f6d891830a56f1feebc1", "patch": "@@ -324,7 +324,8 @@ Objective-C and Objective-C++ Dialects}.\n -Wparentheses  -Wno-pedantic-ms-format @gol\n -Wplacement-new  -Wplacement-new=@var{n} @gol\n -Wpointer-arith  -Wpointer-compare  -Wno-pointer-to-int-cast @gol\n--Wno-pragmas  -Wredundant-decls  -Wrestrict  -Wno-return-local-addr @gol\n+-Wno-pragmas  -Wno-prio-ctor-dtor -Wredundant-decls @gol\n+-Wrestrict  -Wno-return-local-addr @gol\n -Wreturn-type  -Wsequence-point  -Wshadow  -Wno-shadow-ivar @gol\n -Wshadow=global,  -Wshadow=local,  -Wshadow=compatible-local @gol\n -Wshift-overflow  -Wshift-overflow=@var{n} @gol\n@@ -5329,6 +5330,16 @@ Do not warn about misuses of pragmas, such as incorrect parameters,\n invalid syntax, or conflicts between pragmas.  See also\n @option{-Wunknown-pragmas}.\n \n+@item -Wno-prio-ctor-dtor\n+@opindex Wno-prio-ctor-dtor\n+@opindex Wprio-ctor-dtor\n+Do not warn if a priority from 0 to 100 is used for constructor or destructor.\n+The use of constructor and destructor attributes allow you to assign a\n+priority to the constructor/destructor to control its order of execution\n+before @code{main} is called or after it returns.  The priority values must be\n+greater than 100 as the compiler reserves priority values between 0--100 for\n+the implementation.\n+\n @item -Wstrict-aliasing\n @opindex Wstrict-aliasing\n @opindex Wno-strict-aliasing"}, {"sha": "1e0029b1b6d7d8d5eba8ee23ef116052ffb7dd8f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8cff06522fce85a76296f6d891830a56f1feebc1", "patch": "@@ -1,3 +1,7 @@\n+2018-10-04  Vinay Kumar  <vinay.kumar@blackfigtech.com>\n+\n+\t* c-c++-common/Wprio-ctor-dtor.c: New test.\n+\n 2018-10-04  David Malcolm  <dmalcolm@redhat.com>\n \n \t* gcc.dg/vect/nodump-vect-opt-info-2.c: New test."}, {"sha": "5b08059f3fa5058163eefe0904fac5fdda322d0e", "filename": "gcc/testsuite/c-c++-common/Wprio-ctor-dtor.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWprio-ctor-dtor.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cff06522fce85a76296f6d891830a56f1feebc1/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWprio-ctor-dtor.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWprio-ctor-dtor.c?ref=8cff06522fce85a76296f6d891830a56f1feebc1", "patch": "@@ -0,0 +1,9 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wno-prio-ctor-dtor\" } */\n+\n+void construct1 () __attribute__ ((constructor (10)));\n+void construct2 () __attribute__ ((constructor (100)));\n+void construct2 () __attribute__ ((constructor (101)));\n+void destruct1 () __attribute__ ((destructor (1)));\n+void destruct2 () __attribute__ ((destructor (02)));\n+void destruct2 () __attribute__ ((destructor (102)));"}]}