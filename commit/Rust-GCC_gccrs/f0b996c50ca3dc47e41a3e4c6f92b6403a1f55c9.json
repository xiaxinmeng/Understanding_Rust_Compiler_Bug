{"sha": "f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjBiOTk2YzUwY2EzZGM0N2U0MWEzZTRjNmY5MmI2NDAzYTFmNTVjOQ==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-03-04T20:34:56Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-03-04T20:34:56Z"}, "message": "(truthvalue_conversion): Fix handling of COMPLEX_EXPR.\n\nHandle all complex values specially.\n\nFrom-SVN: r3645", "tree": {"sha": "47bf88a4f61cc4f9d9c3e38a932044fb6f6b1685", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/47bf88a4f61cc4f9d9c3e38a932044fb6f6b1685"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9/comments", "author": null, "committer": null, "parents": [{"sha": "a333b79fc53fa0b721a74e4444920c209296a06b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a333b79fc53fa0b721a74e4444920c209296a06b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a333b79fc53fa0b721a74e4444920c209296a06b"}], "stats": {"total": 15, "additions": 12, "deletions": 3}, "files": [{"sha": "db0a5e11e72358da44784d4ef8d2ac08a96cddbe", "filename": "gcc/c-common.c", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=f0b996c50ca3dc47e41a3e4c6f92b6403a1f55c9", "patch": "@@ -967,9 +967,10 @@ truthvalue_conversion (expr)\n \treturn integer_one_node;\n \n     case COMPLEX_EXPR:\n-      return build_binary_op (TRUTH_ANDIF_EXPR,\n-\t\t\t      truthvalue_conversion (TREE_REALPART (expr)),\n-\t\t\t      truthvalue_conversion (TREE_IMAGPART (expr)),\n+      return build_binary_op ((TREE_SIDE_EFFECTS (TREE_OPERAND (expr, 1))\n+\t\t\t       ? TRUTH_AND_EXPR : TRUTH_ANDIF_EXPR),\n+\t\t\t      truthvalue_conversion (TREE_OPERAND (expr, 0)),\n+\t\t\t      truthvalue_conversion (TREE_OPERAND (expr, 1)),\n \t\t\t      0);\n \n     case NEGATE_EXPR:\n@@ -1027,6 +1028,14 @@ truthvalue_conversion (expr)\n       break;\n     }\n \n+  if (TREE_CODE (TREE_TYPE (expr)) == COMPLEX_TYPE)\n+    return (build_binary_op\n+\t    ((TREE_SIDE_EFFECTS (expr)\n+\t      ? TRUTH_AND_EXPR : TRUTH_ANDIF_EXPR),\n+\t     truthvalue_conversion (build_unary_op (REALPART_EXPR, expr, 0)),\n+\t     truthvalue_conversion (build_unary_op (IMAGPART_EXPR, expr, 0)),\n+\t     0));\n+\n   return build_binary_op (NE_EXPR, expr, integer_zero_node, 1);\n }\n \f"}]}