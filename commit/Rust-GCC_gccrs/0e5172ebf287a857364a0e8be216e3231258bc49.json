{"sha": "0e5172ebf287a857364a0e8be216e3231258bc49", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGU1MTcyZWJmMjg3YTg1NzM2NGEwZThiZTIxNmUzMjMxMjU4YmM0OQ==", "commit": {"author": {"name": "Claudiu Zissulescu", "email": "claziss@synopsys.com", "date": "2017-03-13T12:56:22Z"}, "committer": {"name": "Claudiu Zissulescu", "email": "claziss@gcc.gnu.org", "date": "2017-03-13T12:56:22Z"}, "message": "[ARC] Code size modifications.\n\ngcc/\n2017-03-13  Claudiu Zissulescu  <claziss@synopsys.com>\n\n\t* config/arc/arc.c (arc_init): Use multiplier whenever we have it.\n\t(arc_conditional_register_usage): Use a different allocation order\n\twhen optimizing for size.\n\t* common/config/arc/arc-common.c (arc_option_optimization_table):\n\tSection anchors default on when optimizing for size.\n\nFrom-SVN: r246091", "tree": {"sha": "ab1dd02665910d28be40d85cade651a67290cb2b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab1dd02665910d28be40d85cade651a67290cb2b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0e5172ebf287a857364a0e8be216e3231258bc49", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e5172ebf287a857364a0e8be216e3231258bc49", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e5172ebf287a857364a0e8be216e3231258bc49", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e5172ebf287a857364a0e8be216e3231258bc49/comments", "author": {"login": "claziss", "id": 2761368, "node_id": "MDQ6VXNlcjI3NjEzNjg=", "avatar_url": "https://avatars.githubusercontent.com/u/2761368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/claziss", "html_url": "https://github.com/claziss", "followers_url": "https://api.github.com/users/claziss/followers", "following_url": "https://api.github.com/users/claziss/following{/other_user}", "gists_url": "https://api.github.com/users/claziss/gists{/gist_id}", "starred_url": "https://api.github.com/users/claziss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/claziss/subscriptions", "organizations_url": "https://api.github.com/users/claziss/orgs", "repos_url": "https://api.github.com/users/claziss/repos", "events_url": "https://api.github.com/users/claziss/events{/privacy}", "received_events_url": "https://api.github.com/users/claziss/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8c56cc5a88342b2c327bdcee9245e4afd86a8862", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c56cc5a88342b2c327bdcee9245e4afd86a8862", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c56cc5a88342b2c327bdcee9245e4afd86a8862"}], "stats": {"total": 65, "additions": 51, "deletions": 14}, "files": [{"sha": "b00a0cd6d95a39c206bdb6a9d698b8c0febd40f8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e5172ebf287a857364a0e8be216e3231258bc49/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e5172ebf287a857364a0e8be216e3231258bc49/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0e5172ebf287a857364a0e8be216e3231258bc49", "patch": "@@ -1,3 +1,11 @@\n+2017-03-13  Claudiu Zissulescu  <claziss@synopsys.com>\n+\n+\t* config/arc/arc.c (arc_init): Use multiplier whenever we have it.\n+\t(arc_conditional_register_usage): Use a different allocation order\n+\twhen optimizing for size.\n+\t* common/config/arc/arc-common.c (arc_option_optimization_table):\n+\tSection anchors default on when optimizing for size.\n+\n 2017-03-13  Claudiu Zissulescu  <claziss@synopsys.com>\n \n \t* config/arc/arc.md (*tst_bitfield_tst): Fix pattern."}, {"sha": "82e0dd383c9d627d39cc8cf904ef3c17a80f3da9", "filename": "gcc/common/config/arc/arc-common.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e5172ebf287a857364a0e8be216e3231258bc49/gcc%2Fcommon%2Fconfig%2Farc%2Farc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e5172ebf287a857364a0e8be216e3231258bc49/gcc%2Fcommon%2Fconfig%2Farc%2Farc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Farc%2Farc-common.c?ref=0e5172ebf287a857364a0e8be216e3231258bc49", "patch": "@@ -46,6 +46,7 @@ arc_option_init_struct (struct gcc_options *opts)\n #define OPT_LEVELS_3_PLUS_SPEED_ONLY OPT_LEVELS_3_PLUS\n static const struct default_options arc_option_optimization_table[] =\n   {\n+    { OPT_LEVELS_SIZE, OPT_fsection_anchors, NULL, 1 },\n     { OPT_LEVELS_1_PLUS, OPT_fomit_frame_pointer, NULL, 1 },\n     { OPT_LEVELS_ALL, OPT_mRcq, NULL, 1 },\n     { OPT_LEVELS_ALL, OPT_mRcw, NULL, 1 },"}, {"sha": "1116b2dbc253fcc57c2a38d4358b549d126f967c", "filename": "gcc/config/arc/arc.c", "status": "modified", "additions": 42, "deletions": 14, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e5172ebf287a857364a0e8be216e3231258bc49/gcc%2Fconfig%2Farc%2Farc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e5172ebf287a857364a0e8be216e3231258bc49/gcc%2Fconfig%2Farc%2Farc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farc%2Farc.c?ref=0e5172ebf287a857364a0e8be216e3231258bc49", "patch": "@@ -676,6 +676,12 @@ make_pass_arc_predicate_delay_insns (gcc::context *ctxt)\n static void\n arc_init (void)\n {\n+  if (TARGET_V2)\n+    {\n+      /* I have the multiplier, then use it*/\n+      if (TARGET_MPYW || TARGET_MULTI)\n+\t  arc_multcost = COSTS_N_INSNS (1);\n+    }\n   /* Note: arc_multcost is only used in rtx_cost if speed is true.  */\n   if (arc_multcost < 0)\n     switch (arc_tune)\n@@ -1374,20 +1380,42 @@ arc_conditional_register_usage (void)\n     }\n   if (TARGET_Q_CLASS)\n     {\n-      reg_alloc_order[2] = 12;\n-      reg_alloc_order[3] = 13;\n-      reg_alloc_order[4] = 14;\n-      reg_alloc_order[5] = 15;\n-      reg_alloc_order[6] = 1;\n-      reg_alloc_order[7] = 0;\n-      reg_alloc_order[8] = 4;\n-      reg_alloc_order[9] = 5;\n-      reg_alloc_order[10] = 6;\n-      reg_alloc_order[11] = 7;\n-      reg_alloc_order[12] = 8;\n-      reg_alloc_order[13] = 9;\n-      reg_alloc_order[14] = 10;\n-      reg_alloc_order[15] = 11;\n+      if (optimize_size)\n+\t{\n+\t  reg_alloc_order[0] = 0;\n+\t  reg_alloc_order[1] = 1;\n+\t  reg_alloc_order[2] = 2;\n+\t  reg_alloc_order[3] = 3;\n+\t  reg_alloc_order[4] = 12;\n+\t  reg_alloc_order[5] = 13;\n+\t  reg_alloc_order[6] = 14;\n+\t  reg_alloc_order[7] = 15;\n+\t  reg_alloc_order[8] = 4;\n+\t  reg_alloc_order[9] = 5;\n+\t  reg_alloc_order[10] = 6;\n+\t  reg_alloc_order[11] = 7;\n+\t  reg_alloc_order[12] = 8;\n+\t  reg_alloc_order[13] = 9;\n+\t  reg_alloc_order[14] = 10;\n+\t  reg_alloc_order[15] = 11;\n+\t}\n+      else\n+\t{\n+\t  reg_alloc_order[2] = 12;\n+\t  reg_alloc_order[3] = 13;\n+\t  reg_alloc_order[4] = 14;\n+\t  reg_alloc_order[5] = 15;\n+\t  reg_alloc_order[6] = 1;\n+\t  reg_alloc_order[7] = 0;\n+\t  reg_alloc_order[8] = 4;\n+\t  reg_alloc_order[9] = 5;\n+\t  reg_alloc_order[10] = 6;\n+\t  reg_alloc_order[11] = 7;\n+\t  reg_alloc_order[12] = 8;\n+\t  reg_alloc_order[13] = 9;\n+\t  reg_alloc_order[14] = 10;\n+\t  reg_alloc_order[15] = 11;\n+\t}\n     }\n   if (TARGET_SIMD_SET)\n     {"}]}