{"sha": "7c4f0041b0e872a979e20dd8192af178ecf733de", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2M0ZjAwNDFiMGU4NzJhOTc5ZTIwZGQ4MTkyYWYxNzhlY2Y3MzNkZQ==", "commit": {"author": {"name": "Jie Zhang", "email": "jie@codesourcery.com", "date": "2010-07-03T16:49:05Z"}, "committer": {"name": "Jie Zhang", "email": "jiez@gcc.gnu.org", "date": "2010-07-03T16:49:05Z"}, "message": "arm.c (arm_attr_length_move_neon): New.\n\n\t* config/arm/arm.c (arm_attr_length_move_neon): New.\n\t* config/arm/arm-protos.h (arm_attr_length_move_neon): Declare.\n\t* config/arm/neon.md (define_mode_attr V_slen): Remove.\n\t(neon_mov<mode> for VSTRUCT): Use arm_attr_length_move_neon\n\tto compute length attribute.\n\nFrom-SVN: r161776", "tree": {"sha": "7ee72735e0f65edea09f4794793a672429c7d6d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7ee72735e0f65edea09f4794793a672429c7d6d6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7c4f0041b0e872a979e20dd8192af178ecf733de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c4f0041b0e872a979e20dd8192af178ecf733de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7c4f0041b0e872a979e20dd8192af178ecf733de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c4f0041b0e872a979e20dd8192af178ecf733de/comments", "author": null, "committer": null, "parents": [{"sha": "4e6f5666ac37c9cb8cc86008c906b0095b628ac4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e6f5666ac37c9cb8cc86008c906b0095b628ac4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e6f5666ac37c9cb8cc86008c906b0095b628ac4"}], "stats": {"total": 65, "additions": 61, "deletions": 4}, "files": [{"sha": "f20eccda7b4744e0b19b6ae184b16ad0e8258c69", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7c4f0041b0e872a979e20dd8192af178ecf733de", "patch": "@@ -1,3 +1,11 @@\n+2010-07-03  Jie Zhang  <jie@codesourcery.com>\n+\n+\t* config/arm/arm.c (arm_attr_length_move_neon): New.\n+\t* config/arm/arm-protos.h (arm_attr_length_move_neon): Declare.\n+\t* config/arm/neon.md (define_mode_attr V_slen): Remove.\n+\t(neon_mov<mode> for VSTRUCT): Use arm_attr_length_move_neon\n+\tto compute length attribute.\n+\n 2010-07-03  Jie Zhang  <jie@codesourcery.com>\n \n \t* config/arm/vfp.md (*push_multi_vfp): Use vfp_register_operand"}, {"sha": "11e2e288ce9352f633959b5ad0eea4fbb85352f8", "filename": "gcc/config/arm/arm-protos.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2Fconfig%2Farm%2Farm-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2Fconfig%2Farm%2Farm-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm-protos.h?ref=7c4f0041b0e872a979e20dd8192af178ecf733de", "patch": "@@ -131,6 +131,7 @@ extern const char *output_move_double (rtx *);\n extern const char *output_move_quad (rtx *);\n extern const char *output_move_vfp (rtx *operands);\n extern const char *output_move_neon (rtx *operands);\n+extern int arm_attr_length_move_neon (rtx);\n extern const char *output_add_immediate (rtx *);\n extern const char *arithmetic_instr (rtx, int);\n extern void output_ascii_pseudo_op (FILE *, const unsigned char *, int);"}, {"sha": "85d1e8cb82bb61ea09f106ebaa8f24d217b77efc", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=7c4f0041b0e872a979e20dd8192af178ecf733de", "patch": "@@ -12859,6 +12859,57 @@ output_move_neon (rtx *operands)\n   return \"\";\n }\n \n+/* Compute and return the length of neon_mov<mode>, where <mode> is\n+   one of VSTRUCT modes: EI, OI, CI or XI.  */\n+int\n+arm_attr_length_move_neon (rtx insn)\n+{\n+  rtx reg, mem, addr;\n+  int regno, load;\n+  enum machine_mode mode;\n+\n+  extract_insn_cached (insn);\n+\n+  if (REG_P (recog_data.operand[0]) && REG_P (recog_data.operand[1]))\n+    {\n+      mode = GET_MODE (recog_data.operand[0]);\n+      switch (mode)\n+\t{\n+\tcase EImode:\n+\tcase OImode:\n+\t  return 8;\n+\tcase CImode:\n+\t  return 12;\n+\tcase XImode:\n+\t  return 16;\n+\tdefault:\n+\t  gcc_unreachable ();\n+\t}\n+    }\n+\n+  load = REG_P (recog_data.operand[0]);\n+  reg = recog_data.operand[!load];\n+  mem = recog_data.operand[load];\n+\n+  gcc_assert (MEM_P (mem));\n+\n+  mode = GET_MODE (reg);\n+  regno = REGNO (reg);\n+  addr = XEXP (mem, 0);\n+\n+  /* Strip off const from addresses like (const (plus (...))).  */\n+  if (GET_CODE (addr) == CONST && GET_CODE (XEXP (addr, 0)) == PLUS)\n+    addr = XEXP (addr, 0);\n+\n+  if (GET_CODE (addr) == LABEL_REF || GET_CODE (addr) == PLUS)\n+    {\n+      int insns = HARD_REGNO_NREGS (REGNO (reg), mode) / 2;\n+      return insns * 4;\n+    }\n+  else\n+    return 4;\n+}\n+\n /* Output an ADD r, s, #n where n may be too big for one instruction.\n    If adding zero to one register, output nothing.  */\n const char *"}, {"sha": "15f347c9607d4b216ec23fd608a24241010314cc", "filename": "gcc/config/arm/neon.md", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2Fconfig%2Farm%2Fneon.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7c4f0041b0e872a979e20dd8192af178ecf733de/gcc%2Fconfig%2Farm%2Fneon.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fneon.md?ref=7c4f0041b0e872a979e20dd8192af178ecf733de", "patch": "@@ -166,9 +166,6 @@\n ;; Opaque structure types wider than TImode.\n (define_mode_iterator VSTRUCT [EI OI CI XI])\n \n-;; Number of instructions needed to load/store struct elements. FIXME!\n-(define_mode_attr V_slen [(EI \"2\") (OI \"2\") (CI \"3\") (XI \"4\")])\n-\n ;; Opaque structure types used in table lookups (except vtbl1/vtbx1).\n (define_mode_iterator VTAB [TI EI OI])\n \n@@ -576,7 +573,7 @@\n     }\n }\n   [(set_attr \"neon_type\" \"neon_int_1,neon_stm_2,neon_ldm_2\")\n-   (set_attr \"length\" \"<V_slen>,<V_slen>,<V_slen>\")])\n+   (set (attr \"length\") (symbol_ref \"arm_attr_length_move_neon (insn)\"))])\n \n (define_split\n   [(set (match_operand:EI 0 \"s_register_operand\" \"\")"}]}