{"sha": "257e81a6191507c54271466eb360b0822ff94fb9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjU3ZTgxYTYxOTE1MDdjNTQyNzE0NjZlYjM2MGIwODIyZmY5NGZiOQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2013-01-22T10:01:08Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2013-01-22T10:01:08Z"}, "message": "trans.c (Pragma_to_gnu): Use optimize_size instead of optimize and adjust warning message.\n\n\t* gcc-interface/trans.c (Pragma_to_gnu) <Name_Space>: Use optimize_size\n\tinstead of optimize and adjust warning message.\n\t(Compilation_Unit_to_gnu): Process pragmas preceding the unit.\n\nFrom-SVN: r195366", "tree": {"sha": "7b7bb1e9cc6bb612cb66f4343c281c9524ac08b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7b7bb1e9cc6bb612cb66f4343c281c9524ac08b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/257e81a6191507c54271466eb360b0822ff94fb9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/257e81a6191507c54271466eb360b0822ff94fb9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/257e81a6191507c54271466eb360b0822ff94fb9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/257e81a6191507c54271466eb360b0822ff94fb9/comments", "author": null, "committer": null, "parents": [{"sha": "48a24fcfc32ab00e84821c25af74252ff26b48b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48a24fcfc32ab00e84821c25af74252ff26b48b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48a24fcfc32ab00e84821c25af74252ff26b48b7"}], "stats": {"total": 44, "additions": 38, "deletions": 6}, "files": [{"sha": "263113b91e55bc62c4639559ae94a45f7414cf76", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=257e81a6191507c54271466eb360b0822ff94fb9", "patch": "@@ -1,3 +1,9 @@\n+2013-01-22  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/trans.c (Pragma_to_gnu) <Name_Space>: Use optimize_size\n+\tinstead of optimize and adjust warning message.\n+\t(Compilation_Unit_to_gnu): Process pragmas preceding the unit.\n+\n 2013-01-22  Tristan Gingold  <gingold@adacore.com>\n \n \t* gcc-interface/gigi.h (ADT_unhandled_except_decl,"}, {"sha": "6bb2e5b2723d90d4f46a1d3ed23242782d0adfeb", "filename": "gcc/ada/gcc-interface/trans.c", "status": "modified", "additions": 20, "deletions": 6, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Ftrans.c?ref=257e81a6191507c54271466eb360b0822ff94fb9", "patch": "@@ -6,7 +6,7 @@\n  *                                                                          *\n  *                          C Implementation File                           *\n  *                                                                          *\n- *          Copyright (C) 1992-2012, Free Software Foundation, Inc.         *\n+ *          Copyright (C) 1992-2013, Free Software Foundation, Inc.         *\n  *                                                                          *\n  * GNAT is free software;  you can  redistribute it  and/or modify it under *\n  * terms of the  GNU General Public License as published  by the Free Soft- *\n@@ -1254,16 +1254,21 @@ Pragma_to_gnu (Node_Id gnat_node)\n       switch (Chars (Expression\n \t\t     (First (Pragma_Argument_Associations (gnat_node)))))\n \t{\n-\tcase Name_Time:  case Name_Space:\n-\t  if (!optimize)\n-\t    post_error (\"insufficient -O value?\", gnat_node);\n-\t  break;\n-\n \tcase Name_Off:\n \t  if (optimize)\n \t    post_error (\"must specify -O0?\", gnat_node);\n \t  break;\n \n+\tcase Name_Space:\n+\t  if (!optimize_size)\n+\t    post_error (\"must specify -Os?\", gnat_node);\n+\t  break;\n+\n+\tcase Name_Time:\n+\t  if (!optimize)\n+\t    post_error (\"insufficient -O value?\", gnat_node);\n+\t  break;\n+\n \tdefault:\n \t  gcc_unreachable ();\n \t}\n@@ -4743,6 +4748,7 @@ Compilation_Unit_to_gnu (Node_Id gnat_node)\n   const bool body_p = (Nkind (gnat_unit) == N_Package_Body\n \t\t       || Nkind (gnat_unit) == N_Subprogram_Body);\n   const Entity_Id gnat_unit_entity = Defining_Entity (gnat_unit);\n+  Node_Id gnat_pragma;\n   /* Make the decl for the elaboration procedure.  */\n   tree gnu_elab_proc_decl\n     = create_subprog_decl\n@@ -4778,8 +4784,16 @@ Compilation_Unit_to_gnu (Node_Id gnat_node)\n \treturn;\n     }\n \n+  /* Then process any pragmas and declarations preceding the unit.  */\n+  for (gnat_pragma = First (Context_Items (gnat_node));\n+       Present (gnat_pragma);\n+       gnat_pragma = Next (gnat_pragma))\n+    if (Nkind (gnat_pragma) == N_Pragma)\n+      add_stmt (gnat_to_gnu (gnat_pragma));\n   process_decls (Declarations (Aux_Decls_Node (gnat_node)), Empty, Empty,\n \t\t true, true);\n+\n+  /* Process the unit itself.  */\n   add_stmt (gnat_to_gnu (gnat_unit));\n \n   /* If we can inline, generate code for all the inlined subprograms.  */"}, {"sha": "2fe215e41f07e1377f6c7e6d7a3c6b8ca17489b8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=257e81a6191507c54271466eb360b0822ff94fb9", "patch": "@@ -1,3 +1,7 @@\n+2013-01-22  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/warn8.adb: New test.\n+\n 2013-01-21  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/55919"}, {"sha": "8fddb6ffc2df9ab9758ab92bf856375910ffac93", "filename": "gcc/testsuite/gnat.dg/warn8.adb", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/257e81a6191507c54271466eb360b0822ff94fb9/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn8.adb?ref=257e81a6191507c54271466eb360b0822ff94fb9", "patch": "@@ -0,0 +1,8 @@\n+-- { dg-do compile }\n+\n+pragma Optimize (Space); -- { dg-warning \"must specify -Os\" }\n+\n+procedure Warn8 is\n+begin\n+  null;\n+end;"}]}