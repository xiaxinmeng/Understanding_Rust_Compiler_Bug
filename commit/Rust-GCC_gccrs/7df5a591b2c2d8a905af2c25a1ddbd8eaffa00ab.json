{"sha": "7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2RmNWE1OTFiMmMyZDhhOTA1YWYyYzI1YTFkZGJkOGVhZmZhMDBhYg==", "commit": {"author": {"name": "Kazu Hirata", "email": "kazu@cs.umass.edu", "date": "2005-04-23T15:10:31Z"}, "committer": {"name": "Kazu Hirata", "email": "kazu@gcc.gnu.org", "date": "2005-04-23T15:10:31Z"}, "message": "tree-ssa-live.c (build_tree_conflict_graph): Allocate partition_link and tpa_nodes on heap.\n\n\t* tree-ssa-live.c (build_tree_conflict_graph): Allocate\n\tpartition_link and tpa_nodes on heap.\n\nFrom-SVN: r98617", "tree": {"sha": "4a33e5e9ac1d788b34126572538e9beb33738e40", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4a33e5e9ac1d788b34126572538e9beb33738e40"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab/comments", "author": null, "committer": null, "parents": [{"sha": "d0b06ef9018e85eb621d5ba10a2416a2c6cbddd5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0b06ef9018e85eb621d5ba10a2416a2c6cbddd5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d0b06ef9018e85eb621d5ba10a2416a2c6cbddd5"}], "stats": {"total": 22, "additions": 14, "deletions": 8}, "files": [{"sha": "164a4a3c9271ad55e17fd75fe6411106bec34636", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab", "patch": "@@ -4,6 +4,9 @@\n \theap as an argument.  Update uses of stack.\n \t(calculate_live_on_entry): Allocate stack on heap.\n \n+\t* tree-ssa-live.c (build_tree_conflict_graph): Allocate\n+\tpartition_link and tpa_nodes on heap.\n+\n 2005-04-23  Mike Stump  <mrs@apple.com>\n \n \t* config/darwin.c (machopic_indirection_name): Don't use"}, {"sha": "6f9d77ea6458ca3005d2426f6bb7f322c896915f", "filename": "gcc/tree-ssa-live.c", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab/gcc%2Ftree-ssa-live.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab/gcc%2Ftree-ssa-live.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-live.c?ref=7df5a591b2c2d8a905af2c25a1ddbd8eaffa00ab", "patch": "@@ -1293,7 +1293,8 @@ build_tree_conflict_graph (tree_live_info_p liveinfo, tpa_p tpa,\n   bitmap live;\n   unsigned x, y, i;\n   basic_block bb;\n-  varray_type partition_link, tpa_to_clear, tpa_nodes;\n+  varray_type tpa_to_clear;\n+  int *partition_link, *tpa_nodes;\n   unsigned l;\n   ssa_op_iter iter;\n   bitmap_iterator bi;\n@@ -1306,8 +1307,8 @@ build_tree_conflict_graph (tree_live_info_p liveinfo, tpa_p tpa,\n \n   live = BITMAP_ALLOC (NULL);\n \n-  VARRAY_INT_INIT (partition_link, num_var_partitions (map) + 1, \"part_link\");\n-  VARRAY_INT_INIT (tpa_nodes, tpa_num_trees (tpa), \"tpa nodes\");\n+  partition_link = xcalloc (num_var_partitions (map) + 1, sizeof (int));\n+  tpa_nodes = xcalloc (tpa_num_trees (tpa), sizeof (int));\n   VARRAY_INT_INIT (tpa_to_clear, 50, \"tpa to clear\");\n \n   FOR_EACH_BB (bb)\n@@ -1414,26 +1415,28 @@ build_tree_conflict_graph (tree_live_info_p liveinfo, tpa_p tpa,\n \t  i = tpa_find_tree (tpa, x);\n \t  if (i != (unsigned)TPA_NONE)\n \t    {\n-\t      int start = VARRAY_INT (tpa_nodes, i);\n+\t      int start = tpa_nodes[i];\n \t      /* If start is 0, a new root reference list is being started.\n \t\t Register it to be cleared.  */\n \t      if (!start)\n \t        VARRAY_PUSH_INT (tpa_to_clear, i);\n \n \t      /* Add interferences to other tpa members seen.  */\n-\t      for (y = start; y != 0; y = VARRAY_INT (partition_link, y))\n+\t      for (y = start; y != 0; y = partition_link[y])\n \t\tconflict_graph_add (graph, x, y - 1);\n-\t      VARRAY_INT (tpa_nodes, i) = x + 1;\n-\t      VARRAY_INT (partition_link, x + 1) = start;\n+\t      tpa_nodes[i] = x + 1;\n+\t      partition_link[x + 1] = start;\n \t    }\n \t}\n \n \t/* Now clear the used tpa root references.  */\n \tfor (l = 0; l < VARRAY_ACTIVE_SIZE (tpa_to_clear); l++)\n-\t  VARRAY_INT (tpa_nodes, VARRAY_INT (tpa_to_clear, l)) = 0;\n+\t  tpa_nodes[VARRAY_INT (tpa_to_clear, l)] = 0;\n \tVARRAY_POP_ALL (tpa_to_clear);\n     }\n \n+  free (tpa_nodes);\n+  free (partition_link);\n   BITMAP_FREE (live);\n   return graph;\n }"}]}