{"sha": "711084c9450c49b372e177d94ae99fc642e1cc73", "node_id": "C_kwDOANBUbNoAKDcxMTA4NGM5NDUwYzQ5YjM3MmUxNzdkOTRhZTk5ZmM2NDJlMWNjNzM", "commit": {"author": {"name": "Matt Jacobson", "email": "mhjacobson@me.com", "date": "2021-12-03T02:51:28Z"}, "committer": {"name": "Jeff Law", "email": "jeffreyalaw@gmail.com", "date": "2021-12-03T02:53:13Z"}, "message": "build: Implement --with-multilib-list for avr target\n\ngcc\n\n\t* config.gcc: For the AVR target, populate TM_MULTILIB_CONFIG.\n\t* config/avr/genmultilib.awk: Add ability to filter generated multilib\n\tlist.\n\t* config/avr/t-avr: Pass TM_MULTILIB_CONFIG to genmultilib.awk.\n\t* configure.ac: Update help string for --with-multilib-list.\n\t* configure: Regenerate.", "tree": {"sha": "7a41f2716580c89e35cca4acf0db0573640fb1d2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7a41f2716580c89e35cca4acf0db0573640fb1d2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/711084c9450c49b372e177d94ae99fc642e1cc73", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/711084c9450c49b372e177d94ae99fc642e1cc73", "html_url": "https://github.com/Rust-GCC/gccrs/commit/711084c9450c49b372e177d94ae99fc642e1cc73", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/711084c9450c49b372e177d94ae99fc642e1cc73/comments", "author": {"login": "mhjacobson", "id": 1477437, "node_id": "MDQ6VXNlcjE0Nzc0Mzc=", "avatar_url": "https://avatars.githubusercontent.com/u/1477437?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mhjacobson", "html_url": "https://github.com/mhjacobson", "followers_url": "https://api.github.com/users/mhjacobson/followers", "following_url": "https://api.github.com/users/mhjacobson/following{/other_user}", "gists_url": "https://api.github.com/users/mhjacobson/gists{/gist_id}", "starred_url": "https://api.github.com/users/mhjacobson/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mhjacobson/subscriptions", "organizations_url": "https://api.github.com/users/mhjacobson/orgs", "repos_url": "https://api.github.com/users/mhjacobson/repos", "events_url": "https://api.github.com/users/mhjacobson/events{/privacy}", "received_events_url": "https://api.github.com/users/mhjacobson/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JeffreyALaw", "id": 14062506, "node_id": "MDQ6VXNlcjE0MDYyNTA2", "avatar_url": "https://avatars.githubusercontent.com/u/14062506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeffreyALaw", "html_url": "https://github.com/JeffreyALaw", "followers_url": "https://api.github.com/users/JeffreyALaw/followers", "following_url": "https://api.github.com/users/JeffreyALaw/following{/other_user}", "gists_url": "https://api.github.com/users/JeffreyALaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeffreyALaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeffreyALaw/subscriptions", "organizations_url": "https://api.github.com/users/JeffreyALaw/orgs", "repos_url": "https://api.github.com/users/JeffreyALaw/repos", "events_url": "https://api.github.com/users/JeffreyALaw/events{/privacy}", "received_events_url": "https://api.github.com/users/JeffreyALaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ea6ef320b0d7e6a9335691af8c8d1daae396d2a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea6ef320b0d7e6a9335691af8c8d1daae396d2a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea6ef320b0d7e6a9335691af8c8d1daae396d2a7"}], "stats": {"total": 30, "additions": 27, "deletions": 3}, "files": [{"sha": "1ca9d364ff07d01d6d6570feb413c34f12d20525", "filename": "gcc/config.gcc", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=711084c9450c49b372e177d94ae99fc642e1cc73", "patch": "@@ -4315,6 +4315,13 @@ case \"${target}\" in\n \t\tfi\n \t\t;;\n \n+\tavr-*-*)\n+\t\t# Handle --with-multilib-list.\n+\t\tif test \"x${with_multilib_list}\" != xdefault; then\n+\t\t\tTM_MULTILIB_CONFIG=\"${with_multilib_list}\"\n+\t\tfi\n+\t;;\n+\n     csky-*-*)\n \tsupported_defaults=\"cpu endian float\"\n \t;;"}, {"sha": "c5f6ed0f3e336f64807cb11d7124f3a09f85592c", "filename": "gcc/config/avr/genmultilib.awk", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfig%2Favr%2Fgenmultilib.awk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfig%2Favr%2Fgenmultilib.awk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Fgenmultilib.awk?ref=711084c9450c49b372e177d94ae99fc642e1cc73", "patch": "@@ -67,6 +67,16 @@ BEGIN {\n \n     dir_long_double = \"long-double\"   (96 - with_long_double)\n     opt_long_double = \"mlong-double=\" (96 - with_long_double)\n+\n+    if (with_multilib_list != \"\")\n+    {\n+\tsplit(with_multilib_list, multilib_list, \",\")\n+\n+\tfor (i in multilib_list)\n+\t{\n+\t    multilibs[multilib_list[i]] = 1\n+\t}\n+    }\n }\n \n ##################################################################\n@@ -137,6 +147,9 @@ BEGIN {\n \tif (core == \"avr1\")\n \t    next\n \n+\tif (with_multilib_list != \"\" && !(core in multilibs))\n+\t    next\n+\n \toption[core] = \"mmcu=\" core\n \n \tm_options  = m_options m_sep option[core]\n@@ -150,6 +163,9 @@ BEGIN {\n     if (core == \"avr1\")\n \tnext\n \n+    if (with_multilib_list != \"\" && !(core in multilibs))\n+\tnext\n+\n     opts = option[core]\n \n     # split device specific feature list"}, {"sha": "3120b19df81e2b573eef84c154e7ab4ba21fdf97", "filename": "gcc/config/avr/t-avr", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfig%2Favr%2Ft-avr", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfig%2Favr%2Ft-avr", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Ft-avr?ref=711084c9450c49b372e177d94ae99fc642e1cc73", "patch": "@@ -127,6 +127,7 @@ t-multilib-avr: $(srcdir)/config/avr/genmultilib.awk \\\n \t\t-v HAVE_LONG_DOUBLE64=$(HAVE_LONG_DOUBLE64) \t\t\\\n \t\t-v with_double=$(WITH_DOUBLE) \t\t\t\t\\\n \t\t-v with_long_double=$(WITH_LONG_DOUBLE)\t\t\t\\\n+\t\t-v with_multilib_list=$(TM_MULTILIB_CONFIG)\t\t\\\n \t\t-f $< $< $(AVR_MCUS) > $@\n \n include t-multilib-avr"}, {"sha": "de20e5d26293baeb9babe3a7e3f6449bab79c511", "filename": "gcc/configure", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=711084c9450c49b372e177d94ae99fc642e1cc73", "patch": "@@ -1831,8 +1831,8 @@ Optional Packages:\n                           Root for documentation URLs\n   --with-changes-root-url=URL\n                           Root for GCC changes URLs\n-  --with-multilib-list    select multilibs (AArch64, ARM, OR1K, RISC-V, SH and\n-                          x86-64 only)\n+  --with-multilib-list    select multilibs (AArch64, ARM, AVR, OR1K, RISC-V,\n+                          SH and x86-64 only)\n   --with-multilib-generator\n                           Multi-libs configuration string (RISC-V only)\n   --with-zstd=PATH        specify prefix directory for installed zstd library."}, {"sha": "2b4914b6ec199d0f4bdcd9119af7bf6f270be829", "filename": "gcc/configure.ac", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/711084c9450c49b372e177d94ae99fc642e1cc73/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=711084c9450c49b372e177d94ae99fc642e1cc73", "patch": "@@ -1171,7 +1171,7 @@ if test \"x$enable_offload_defaulted\" = xyes; then\n fi\n \n AC_ARG_WITH(multilib-list,\n-[AS_HELP_STRING([--with-multilib-list], [select multilibs (AArch64, ARM, OR1K, RISC-V, SH and x86-64 only)])],\n+[AS_HELP_STRING([--with-multilib-list], [select multilibs (AArch64, ARM, AVR, OR1K, RISC-V, SH and x86-64 only)])],\n :,\n with_multilib_list=default)\n "}]}