{"sha": "e40191f1e0d1729b0a942e3ca286bf44e1443c59", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQwMTkxZjFlMGQxNzI5YjBhOTQyZTNjYTI4NmJmNDRlMTQ0M2M1OQ==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2013-10-27T23:36:51Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2013-10-27T23:36:51Z"}, "message": "Fix line number data for PIC register setup code.\n\n2013-10-27  Tom de Vries  <tom@codesourcery.com>\n\n\t* cfgexpand.c (gimple_expand_cfg): Remove test for parm_birth_insn.\n\tDon't commit insertions after NOTE_INSN_FUNCTION_BEG.\n\n\t* gcc.target/arm/require-pic-register-loc.c: New test.\n\nFrom-SVN: r204112", "tree": {"sha": "96774eab55838741023e71ac4d4d3f566efb7e7d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96774eab55838741023e71ac4d4d3f566efb7e7d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e40191f1e0d1729b0a942e3ca286bf44e1443c59", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e40191f1e0d1729b0a942e3ca286bf44e1443c59", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e40191f1e0d1729b0a942e3ca286bf44e1443c59", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e40191f1e0d1729b0a942e3ca286bf44e1443c59/comments", "author": null, "committer": null, "parents": [{"sha": "3c7ac4cbe7335e3690ebaa7b2b8b8c9041f73c44", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c7ac4cbe7335e3690ebaa7b2b8b8c9041f73c44", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3c7ac4cbe7335e3690ebaa7b2b8b8c9041f73c44"}], "stats": {"total": 50, "additions": 46, "deletions": 4}, "files": [{"sha": "8d6147a3188e32b0176e10c0deea4beec3f1ccf4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e40191f1e0d1729b0a942e3ca286bf44e1443c59/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e40191f1e0d1729b0a942e3ca286bf44e1443c59/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e40191f1e0d1729b0a942e3ca286bf44e1443c59", "patch": "@@ -1,3 +1,8 @@\n+2013-10-27  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* cfgexpand.c (gimple_expand_cfg): Remove test for parm_birth_insn.\n+\tDon't commit insertions after NOTE_INSN_FUNCTION_BEG.\n+\n 2013-10-27  Oleg Endo  <olegendo@gcc.gnu.org>\n \n \t* config/sh/sh.c (MSW, LSW): Move and rename macros to..."}, {"sha": "97050360f2b6391d69a220b3cf65484924706558", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e40191f1e0d1729b0a942e3ca286bf44e1443c59/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e40191f1e0d1729b0a942e3ca286bf44e1443c59/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=e40191f1e0d1729b0a942e3ca286bf44e1443c59", "patch": "@@ -4789,14 +4789,18 @@ gimple_expand_cfg (void)\n \t  if (e->insns.r)\n \t    {\n \t      rebuild_jump_labels_chain (e->insns.r);\n-\t      /* Avoid putting insns before parm_birth_insn.  */\n+\t      /* Put insns after parm birth, but before\n+\t\t NOTE_INSNS_FUNCTION_BEG.  */\n \t      if (e->src == ENTRY_BLOCK_PTR\n-\t\t  && single_succ_p (ENTRY_BLOCK_PTR)\n-\t\t  && parm_birth_insn)\n+\t\t  && single_succ_p (ENTRY_BLOCK_PTR))\n \t\t{\n \t\t  rtx insns = e->insns.r;\n \t\t  e->insns.r = NULL_RTX;\n-\t\t  emit_insn_after_noloc (insns, parm_birth_insn, e->dest);\n+\t\t  if (NOTE_P (parm_birth_insn)\n+\t\t      && NOTE_KIND (parm_birth_insn) == NOTE_INSN_FUNCTION_BEG)\n+\t\t    emit_insn_before_noloc (insns, parm_birth_insn, e->dest);\n+\t\t  else\n+\t\t    emit_insn_after_noloc (insns, parm_birth_insn, e->dest);\n \t\t}\n \t      else\n \t\tcommit_one_edge_insertion (e);"}, {"sha": "12028b44027bef389a3d73ab549a397371b1b684", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e40191f1e0d1729b0a942e3ca286bf44e1443c59/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e40191f1e0d1729b0a942e3ca286bf44e1443c59/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e40191f1e0d1729b0a942e3ca286bf44e1443c59", "patch": "@@ -1,3 +1,7 @@\n+2013-10-27  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* gcc.target/arm/require-pic-register-loc.c: New test.\n+\n 2013-10-27  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/58679"}, {"sha": "bd85e8640c24eeb35af0d55cdfa1a0670df0eebb", "filename": "testsuite/gcc.target/arm/require-pic-register-loc.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e40191f1e0d1729b0a942e3ca286bf44e1443c59/testsuite%2Fgcc.target%2Farm%2Frequire-pic-register-loc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e40191f1e0d1729b0a942e3ca286bf44e1443c59/testsuite%2Fgcc.target%2Farm%2Frequire-pic-register-loc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/testsuite%2Fgcc.target%2Farm%2Frequire-pic-register-loc.c?ref=e40191f1e0d1729b0a942e3ca286bf44e1443c59", "patch": "@@ -0,0 +1,29 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-g -fPIC\" } */\n+\n+void *v;\n+void a (void *x) { }\n+void b (void) { }\n+                       /* line 7.  */\n+int                    /* line 8.  */\n+main (int argc)        /* line 9.  */\n+{                      /* line 10.  */\n+  if (argc == 12345)   /* line 11.  */\n+    {\n+      a (v);\n+      return 1;\n+    }\n+  b ();\n+\n+  return 0;\n+}\n+\n+/* { dg-final { scan-assembler-not \"\\.loc 1 7 0\" } } */\n+/* { dg-final { scan-assembler-not \"\\.loc 1 8 0\" } } */\n+/* { dg-final { scan-assembler-not \"\\.loc 1 9 0\" } } */\n+\n+/* The loc at the start of the prologue.  */\n+/* { dg-final { scan-assembler-times \"\\.loc 1 10 0\" 1 } } */\n+\n+/* The loc at the end of the prologue, with the first user line.  */\n+/* { dg-final { scan-assembler-times \"\\.loc 1 11 0\" 1 } } */"}]}