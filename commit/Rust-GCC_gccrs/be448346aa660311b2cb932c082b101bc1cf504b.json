{"sha": "be448346aa660311b2cb932c082b101bc1cf504b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmU0NDgzNDZhYTY2MDMxMWIyY2I5MzJjMDgyYjEwMWJjMWNmNTA0Yg==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernd.schmidt@analog.com", "date": "2006-05-17T13:54:38Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2006-05-17T13:54:38Z"}, "message": "re PR bootstrap/22541 (Building into empty PREFIX causes broken limits.h to be installed)\n\n\tPR bootstrap/22541\n\tFrom Dan Kegel <dank@kegel.com>:\n\t* Makefile.in: Strip \"dir/../\" combinations from SYSTEM_INCLUDE_DIR.\n\nFrom-SVN: r113859", "tree": {"sha": "a385159e4118c650300beb9f5557e65775ac052b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a385159e4118c650300beb9f5557e65775ac052b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/be448346aa660311b2cb932c082b101bc1cf504b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be448346aa660311b2cb932c082b101bc1cf504b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be448346aa660311b2cb932c082b101bc1cf504b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be448346aa660311b2cb932c082b101bc1cf504b/comments", "author": null, "committer": null, "parents": [{"sha": "2e3b8fe7b5405a94d86bfa323c0e80e83c58d784", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e3b8fe7b5405a94d86bfa323c0e80e83c58d784", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e3b8fe7b5405a94d86bfa323c0e80e83c58d784"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "eefaa9a22d31928270cce25227496fb4f0a4cec9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be448346aa660311b2cb932c082b101bc1cf504b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be448346aa660311b2cb932c082b101bc1cf504b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=be448346aa660311b2cb932c082b101bc1cf504b", "patch": "@@ -1,3 +1,9 @@\n+2005-05-17  Bernd Schmidt  <bernd.schmidt@analog.com>\n+\n+\tPR bootstrap/22541\n+\tFrom Dan Kegel <dank@kegel.com>:\n+\t* Makefile.in: Strip \"dir/../\" combinations from SYSTEM_INCLUDE_DIR.\n+\n 2006-05-17  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* tree.c (variably_modified_type_p) <ARRAY_TYPE>: Return true"}, {"sha": "4aa1967dcf83c2b16a2791e89c37707ee843a988", "filename": "gcc/Makefile.in", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be448346aa660311b2cb932c082b101bc1cf504b/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be448346aa660311b2cb932c082b101bc1cf504b/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=be448346aa660311b2cb932c082b101bc1cf504b", "patch": "@@ -397,7 +397,10 @@ NATIVE_SYSTEM_HEADER_DIR = /usr/include\n CROSS_SYSTEM_HEADER_DIR = @CROSS_SYSTEM_HEADER_DIR@\n \n # autoconf sets SYSTEM_HEADER_DIR to one of the above.\n-SYSTEM_HEADER_DIR = @SYSTEM_HEADER_DIR@\n+# Purge it of unneccessary internal relative paths\n+# to directories that might not exist yet.\n+# The sed idiom for this is to repeat the search-and-replace until it doesn't match, using :a ... ta.\n+SYSTEM_HEADER_DIR = `echo @SYSTEM_HEADER_DIR@ | sed -e :a -e \"s,[^/]*/\\.\\.\\/,,\" -e ta`\n \n # Control whether to run fixproto and fixincludes.\n STMP_FIXPROTO = @STMP_FIXPROTO@\n@@ -3211,13 +3214,16 @@ s-macro_list : $(GCC_PASSES)\n ../$(build_subdir)/fixincludes/fixincl: ; @ :\n \n # Build fixed copies of system files.\n+# Abort if no system headers available, unless building a crosscompiler.\n+# FIXME: abort unless building --without-headers would be more accurate and less ugly\n stmp-fixinc: gsyslimits.h macro_list \\\n   $(build_objdir)/fixincludes/fixincl \\\n   $(build_objdir)/fixincludes/fixinc.sh\n \t@if ! $(inhibit_libc) && test ! -d ${SYSTEM_HEADER_DIR}; then \\\n \t  echo The directory that should contain system headers does not exist: >&2 ; \\\n \t  echo \"  ${SYSTEM_HEADER_DIR}\" >&2 ; \\\n-\t  if test \"x${SYSTEM_HEADER_DIR}\" = \"x${gcc_tooldir}/sys-include\"; \\\n+\t  tooldir_sysinc=`echo \"${gcc_tooldir}/sys-include\" | sed -e :a -e \"s,[^/]*/\\.\\.\\/,,\" -e ta`; \\\n+\t  if test \"x${SYSTEM_HEADER_DIR}\" = \"x${tooldir_sysinc}\"; \\\n \t  then sleep 1; else exit 1; fi; \\\n \tfi\n \trm -rf include; mkdir include"}]}