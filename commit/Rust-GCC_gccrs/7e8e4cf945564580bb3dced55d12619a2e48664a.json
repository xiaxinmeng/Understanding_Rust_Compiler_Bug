{"sha": "7e8e4cf945564580bb3dced55d12619a2e48664a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2U4ZTRjZjk0NTU2NDU4MGJiM2RjZWQ1NWQxMjYxOWEyZTQ4NjY0YQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2014-11-10T19:51:48Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2014-11-10T19:51:48Z"}, "message": "frv.c: Move include of rtl.h after hard-reg-set.h.\n\ngcc/\n\t* config/frv/frv.c: Move include of rtl.h after hard-reg-set.h.\n\t(frv_clear_registers_used): Delete.\n\t(frv_ifcvt_modify_tests): Use find_all_hard_regs.\n\nFrom-SVN: r217308", "tree": {"sha": "934813d2b62e210c17f9bf7eb1e734b2afacc219", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/934813d2b62e210c17f9bf7eb1e734b2afacc219"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e8e4cf945564580bb3dced55d12619a2e48664a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e8e4cf945564580bb3dced55d12619a2e48664a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e8e4cf945564580bb3dced55d12619a2e48664a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e8e4cf945564580bb3dced55d12619a2e48664a/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fe8dd12e2057860085caad10d0f4d2c681ff8bf9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe8dd12e2057860085caad10d0f4d2c681ff8bf9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe8dd12e2057860085caad10d0f4d2c681ff8bf9"}], "stats": {"total": 46, "additions": 13, "deletions": 33}, "files": [{"sha": "67ff64ea439c474feab0308693679c2cef7ad0c9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e8e4cf945564580bb3dced55d12619a2e48664a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e8e4cf945564580bb3dced55d12619a2e48664a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7e8e4cf945564580bb3dced55d12619a2e48664a", "patch": "@@ -1,3 +1,9 @@\n+2014-11-10  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* config/frv/frv.c: Move include of rtl.h after hard-reg-set.h.\n+\t(frv_clear_registers_used): Delete.\n+\t(frv_ifcvt_modify_tests): Use find_all_hard_regs.\n+\n 2014-11-10  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR bootstrap/63573"}, {"sha": "64697081f0cab0b4ed5ae83ebad75ab023da5131", "filename": "gcc/config/frv/frv.c", "status": "modified", "additions": 7, "deletions": 33, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e8e4cf945564580bb3dced55d12619a2e48664a/gcc%2Fconfig%2Ffrv%2Ffrv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e8e4cf945564580bb3dced55d12619a2e48664a/gcc%2Fconfig%2Ffrv%2Ffrv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ffrv%2Ffrv.c?ref=7e8e4cf945564580bb3dced55d12619a2e48664a", "patch": "@@ -21,13 +21,13 @@ along with GCC; see the file COPYING3.  If not see\n #include \"system.h\"\n #include \"coretypes.h\"\n #include \"tm.h\"\n-#include \"rtl.h\"\n #include \"tree.h\"\n #include \"varasm.h\"\n #include \"stor-layout.h\"\n #include \"stringpool.h\"\n #include \"regs.h\"\n #include \"hard-reg-set.h\"\n+#include \"rtl.h\"\n #include \"insn-config.h\"\n #include \"conditions.h\"\n #include \"insn-flags.h\"\n@@ -335,7 +335,6 @@ static rtx frv_expand_mwtacc_builtin\t\t(enum insn_code, tree);\n static rtx frv_expand_noargs_builtin\t\t(enum insn_code);\n static void frv_split_iacc_move\t\t\t(rtx, rtx);\n static rtx frv_emit_comparison\t\t\t(enum rtx_code, rtx, rtx);\n-static int frv_clear_registers_used\t\t(rtx *, void *);\n static void frv_ifcvt_add_insn\t\t\t(rtx, rtx, int);\n static rtx frv_ifcvt_rewrite_mem\t\t(rtx, machine_mode, rtx);\n static rtx frv_ifcvt_load_value\t\t\t(rtx, rtx);\n@@ -5193,33 +5192,6 @@ frv_split_abs (rtx operands[])\n   return ret;\n }\n \n-\f\n-/* An internal function called by for_each_rtx to clear in a hard_reg set each\n-   register used in an insn.  */\n-\n-static int\n-frv_clear_registers_used (rtx *ptr, void *data)\n-{\n-  if (GET_CODE (*ptr) == REG)\n-    {\n-      int regno = REGNO (*ptr);\n-      HARD_REG_SET *p_regs = (HARD_REG_SET *)data;\n-\n-      if (regno < FIRST_PSEUDO_REGISTER)\n-\t{\n-\t  int reg_max = regno + HARD_REGNO_NREGS (regno, GET_MODE (*ptr));\n-\n-\t  while (regno < reg_max)\n-\t    {\n-\t      CLEAR_HARD_REG_BIT (*p_regs, regno);\n-\t      regno++;\n-\t    }\n-\t}\n-    }\n-\n-  return 0;\n-}\n-\n \f\n /* Initialize machine-specific if-conversion data.\n    On the FR-V, we don't have any extra fields per se, but it is useful hook to\n@@ -5413,9 +5385,11 @@ frv_ifcvt_modify_tests (ce_if_block *ce_info, rtx *p_true, rtx *p_false)\n \t      rtx pattern;\n \t      rtx set;\n \t      int skip_nested_if = FALSE;\n+\t      HARD_REG_SET mentioned_regs;\n \n-\t      for_each_rtx (&PATTERN (insn), frv_clear_registers_used,\n-\t\t\t    (void *)&tmp_reg->regs);\n+\t      CLEAR_HARD_REG_SET (mentioned_regs);\n+\t      find_all_hard_regs (PATTERN (insn), &mentioned_regs);\n+\t      AND_COMPL_HARD_REG_SET (tmp_reg->regs, mentioned_regs);\n \n \t      pattern = PATTERN (insn);\n \t      if (GET_CODE (pattern) == COND_EXEC)\n@@ -5451,8 +5425,8 @@ frv_ifcvt_modify_tests (ce_if_block *ce_info, rtx *p_true, rtx *p_false)\n \t\t}\n \n \t      if (! skip_nested_if)\n-\t\tfor_each_rtx (&PATTERN (insn), frv_clear_registers_used,\n-\t\t\t      (void *)&frv_ifcvt.nested_cc_ok_rewrite);\n+\t\tAND_COMPL_HARD_REG_SET (frv_ifcvt.nested_cc_ok_rewrite,\n+\t\t\t\t\tmentioned_regs);\n \t    }\n \n \t  if (insn == last_insn)"}]}