{"sha": "32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzJkNmU2YzBmODAyMjY0ZDRjNWE2Yzk5ZDUxMDlkNGNiYjZmNzMzNw==", "commit": {"author": {"name": "Joey Ye", "email": "joey.ye@arm.com", "date": "2013-11-19T10:00:46Z"}, "committer": {"name": "Joey Ye", "email": "jye2@gcc.gnu.org", "date": "2013-11-19T10:00:46Z"}, "message": "arm.opt (-marm-pic-data-is-text-relative): New option.\n\n2013-11-19  Joey Ye  <joey.ye@arm.com>\n\n        * config/arm/arm.opt (-marm-pic-data-is-text-relative): New option.\n        * doc/invoke.texi (-marm-pic-data-is-text-relative): Documentation\n        for new option.\n        * config/arm/arm.c (arm_option_override): By default disable\n        -marm-pic-data-is-text-relative.\n        (legitimize_pic_address): Use arm_pic_data_is_text_relative.\n        (arm_assemble_integer): Likewise.\n        * config/arm/arm.h (TARGET_DEFAULT_PIC_DATA_IS_TEXT_RELATIVE): \n        New macro to initialize -marm-pic-data-is-text-relative.\n\nFrom-SVN: r205016", "tree": {"sha": "8aea504c43370e1fdb28cd1b1c8baf8085b6e680", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8aea504c43370e1fdb28cd1b1c8baf8085b6e680"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/comments", "author": {"login": "joeye-arm", "id": 38510878, "node_id": "MDQ6VXNlcjM4NTEwODc4", "avatar_url": "https://avatars.githubusercontent.com/u/38510878?v=4", "gravatar_id": "", "url": "https://api.github.com/users/joeye-arm", "html_url": "https://github.com/joeye-arm", "followers_url": "https://api.github.com/users/joeye-arm/followers", "following_url": "https://api.github.com/users/joeye-arm/following{/other_user}", "gists_url": "https://api.github.com/users/joeye-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/joeye-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/joeye-arm/subscriptions", "organizations_url": "https://api.github.com/users/joeye-arm/orgs", "repos_url": "https://api.github.com/users/joeye-arm/repos", "events_url": "https://api.github.com/users/joeye-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/joeye-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cd0470594cbc319d4a179734b2d6247056d07afb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd0470594cbc319d4a179734b2d6247056d07afb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd0470594cbc319d4a179734b2d6247056d07afb"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "b47cacf2b41aa891f72ea33f8fd995776d7980bf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "patch": "@@ -1,3 +1,15 @@\n+2013-11-19  Joey Ye  <joey.ye@arm.com>\n+\n+\t* config/arm/arm.opt (-marm-pic-data-is-text-relative): New option.\n+\t* doc/invoke.texi (-marm-pic-data-is-text-relative): Documentation\n+\tfor new option.\n+\t* config/arm/arm.c (arm_option_override): By default disable\n+\t-marm-pic-data-is-text-relative.\n+\t(legitimize_pic_address): Use arm_pic_data_is_text_relative.\n+\t(arm_assemble_integer): Likewise.\n+\t* config/arm/arm.h (TARGET_DEFAULT_PIC_DATA_IS_TEXT_RELATIVE):\n+\tNew macro to initialize -marm-pic-data-is-text-relative.\n+\n 2013-11-19  Bin Cheng  <bin.cheng@arm.com>\n \n \t* tree-ssa-loop-ivopts.c (enum ainc_type): New."}, {"sha": "a5bd01006b6c9435d4afdab7abf34b17af83ff27", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "patch": "@@ -2449,6 +2449,10 @@ arm_option_override (void)\n \tarm_pic_register = pic_register;\n     }\n \n+  if (TARGET_VXWORKS_RTP\n+      && !global_options_set.x_arm_pic_data_is_text_relative)\n+    arm_pic_data_is_text_relative = 0;\n+\n   /* Enable -mfix-cortex-m3-ldrd by default for Cortex-M3 cores.  */\n   if (fix_cm3_ldrd == 2)\n     {\n@@ -5965,7 +5969,7 @@ legitimize_pic_address (rtx orig, enum machine_mode mode, rtx reg)\n \t   || (GET_CODE (orig) == SYMBOL_REF &&\n \t       SYMBOL_REF_LOCAL_P (orig)))\n \t  && NEED_GOT_RELOC\n-\t  && !TARGET_VXWORKS_RTP)\n+\t  && arm_pic_data_is_text_relative)\n \tinsn = arm_pic_static_addr (orig, reg);\n       else\n \t{\n@@ -21458,7 +21462,7 @@ arm_assemble_integer (rtx x, unsigned int size, int aligned_p)\n \t{\n \t  /* See legitimize_pic_address for an explanation of the\n \t     TARGET_VXWORKS_RTP check.  */\n-\t  if (TARGET_VXWORKS_RTP\n+\t  if (!arm_pic_data_is_text_relative\n \t      || (GET_CODE (x) == SYMBOL_REF && !SYMBOL_REF_LOCAL_P (x)))\n \t    fputs (\"(GOT)\", asm_out_file);\n \t  else"}, {"sha": "dbd841ec842bab5d0a7192eb6461686d6b065c39", "filename": "gcc/config/arm/arm.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fconfig%2Farm%2Farm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fconfig%2Farm%2Farm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.h?ref=32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "patch": "@@ -568,6 +568,10 @@ extern int prefer_neon_for_64bits;\n #define NEED_PLT_RELOC\t0\n #endif\n \n+#ifndef TARGET_DEFAULT_PIC_DATA_IS_TEXT_RELATIVE\n+#define TARGET_DEFAULT_PIC_DATA_IS_TEXT_RELATIVE 1\n+#endif\n+\n /* Nonzero if we need to refer to the GOT with a PC-relative\n    offset.  In other words, generate\n "}, {"sha": "fa0839a9e12e0fc28221f6a47f88867114a922e4", "filename": "gcc/config/arm/arm.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fconfig%2Farm%2Farm.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fconfig%2Farm%2Farm.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.opt?ref=32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "patch": "@@ -158,6 +158,10 @@ mlong-calls\n Target Report Mask(LONG_CALLS)\n Generate call insns as indirect calls, if necessary\n \n+mpic-data-is-text-relative\n+Target Report Var(arm_pic_data_is_text_relative) Init(TARGET_DEFAULT_PIC_DATA_IS_TEXT_RELATIVE)\n+Assume data segments are relative to text segment.\n+\n mpic-register=\n Target RejectNegative Joined Var(arm_pic_register_string)\n Specify the register to be used for PIC addressing"}, {"sha": "c250385eebcd911c747d582c051c8034ddf0af01", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=32d6e6c0f802264d4c5a6c99d5109d4cbb6f7337", "patch": "@@ -12188,6 +12188,12 @@ before execution begins.\n Specify the register to be used for PIC addressing.  The default is R10\n unless stack-checking is enabled, when R9 is used.\n \n+@item -mpic-data-is-text-relative\n+@opindex mpic-data-is-text-relative\n+Assume that each data segments are relative to text segment at load time.\n+Therefore, it permits addressing data using PC-relative operations.\n+This option is on by default for targets other than VxWorks RTP.\n+\n @item -mpoke-function-name\n @opindex mpoke-function-name\n Write the name of each function into the text section, directly"}]}