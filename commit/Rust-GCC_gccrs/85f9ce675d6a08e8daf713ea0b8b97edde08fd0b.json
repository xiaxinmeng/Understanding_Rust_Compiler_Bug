{"sha": "85f9ce675d6a08e8daf713ea0b8b97edde08fd0b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVmOWNlNjc1ZDZhMDhlOGRhZjcxM2VhMGI4Yjk3ZWRkZTA4ZmQwYg==", "commit": {"author": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2012-12-05T23:55:28Z"}, "committer": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2012-12-05T23:55:28Z"}, "message": "re PR rtl-optimization/55604 (ICE while dumping in remove_some_program_points_and_update_live_ranges)\n\n\tPR rtl-optimization/55604\n\t* lra-lives.c (lra_create_live_ranges): If there are no referenced\n\tpseudos left, do not compute live ranges.\n\nFrom-SVN: r194230", "tree": {"sha": "dd461e9466c11bba0bdb0180dcc8f3a32539b025", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dd461e9466c11bba0bdb0180dcc8f3a32539b025"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b/comments", "author": null, "committer": null, "parents": [{"sha": "aeb9f7cf3ce55e65fb9f435702e20c7c3f37d7e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aeb9f7cf3ce55e65fb9f435702e20c7c3f37d7e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aeb9f7cf3ce55e65fb9f435702e20c7c3f37d7e5"}], "stats": {"total": 26, "additions": 24, "deletions": 2}, "files": [{"sha": "b6326f3cd73d31b1bbbd789bc5467d4c7e11d83e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=85f9ce675d6a08e8daf713ea0b8b97edde08fd0b", "patch": "@@ -1,3 +1,9 @@\n+2012-12-05  Steven Bosscher  <steven@gcc.gnu.org>\n+\n+\tPR rtl-optimization/55604\n+\t* lra-lives.c (lra_create_live_ranges): If there are no referenced\n+\tpseudos left, do not compute live ranges.\n+\n 2012-12-05  Steven Bosscher  <steven@gcc.gnu.org>\n \n \t* doc/tm.texi.in (TARGET_CLASS_LIKELY_SPILLED_P): Update documentation."}, {"sha": "4764ae6e1824e97d222fa1e9c8bd9d2aa48dbcd4", "filename": "gcc/lra-lives.c", "status": "modified", "additions": 18, "deletions": 2, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b/gcc%2Flra-lives.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85f9ce675d6a08e8daf713ea0b8b97edde08fd0b/gcc%2Flra-lives.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-lives.c?ref=85f9ce675d6a08e8daf713ea0b8b97edde08fd0b", "patch": "@@ -915,6 +915,7 @@ lra_create_live_ranges (bool all_p)\n   basic_block bb;\n   int i, hard_regno, max_regno = max_reg_num ();\n   int curr_point;\n+  bool have_referenced_pseudos = false;\n \n   timevar_push (TV_LRA_CREATE_LIVE_RANGES);\n \n@@ -947,10 +948,24 @@ lra_create_live_ranges (bool all_p)\n       lra_reg_info[i].call_p = false;\n #endif\n       if (i >= FIRST_PSEUDO_REGISTER\n-\t  && lra_reg_info[i].nrefs != 0 && (hard_regno = reg_renumber[i]) >= 0)\n-\tlra_hard_reg_usage[hard_regno] += lra_reg_info[i].freq;\n+\t  && lra_reg_info[i].nrefs != 0)\n+\t{\n+\t  if ((hard_regno = reg_renumber[i]) >= 0)\n+\t    lra_hard_reg_usage[hard_regno] += lra_reg_info[i].freq;\n+\t  have_referenced_pseudos = true;\n+\t}\n     }\n   lra_free_copies ();\n+ \n+  /* Under some circumstances, we can have functions without pseudo\n+     registers.  For such functions, lra_live_max_point will be 0,\n+     see e.g. PR55604, and there's nothing more to do for us here.  */\n+  if (! have_referenced_pseudos)\n+    {\n+      timevar_pop (TV_LRA_CREATE_LIVE_RANGES);\n+      return;\n+    }\n+\n   pseudos_live = sparseset_alloc (max_regno);\n   pseudos_live_through_calls = sparseset_alloc (max_regno);\n   pseudos_live_through_setjumps = sparseset_alloc (max_regno);\n@@ -973,6 +988,7 @@ lra_create_live_ranges (bool all_p)\n     }\n   free (post_order_rev_cfg);\n   lra_live_max_point = curr_point;\n+  gcc_checking_assert (lra_live_max_point > 0);\n   if (lra_dump_file != NULL)\n     print_live_ranges (lra_dump_file);\n   /* Clean up.\t*/"}]}