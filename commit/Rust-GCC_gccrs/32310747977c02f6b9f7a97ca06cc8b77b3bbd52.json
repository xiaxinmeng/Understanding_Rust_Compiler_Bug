{"sha": "32310747977c02f6b9f7a97ca06cc8b77b3bbd52", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzIzMTA3NDc5NzdjMDJmNmI5ZjdhOTdjYTA2Y2M4Yjc3YjNiYmQ1Mg==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2004-11-19T10:57:36Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2004-11-19T10:57:36Z"}, "message": "exp_dbug.ads: Update documentation to reflect simpler encoding for protected operations.\n\n\t* exp_dbug.ads: Update documentation to reflect simpler encoding for\n\tprotected operations.\n\n\t* exp_ch9.adb (Build_Selected_Name): Do not include \"PT\" suffix in\n\tgenerated name, it complicates decoding in gdb and hinders debugging\n\tof protected operations.\n\t(Build_Barrier_Function_Specification): Set the Needs_Debug_Info\n\tflag for the protected entry barrier function.\n\t(Build_Protected_Entry_Specification): Set the Needs_Debug_Info\n\tflag for the protected entry function.\n\nFrom-SVN: r90907", "tree": {"sha": "867cefd2bc273802292f4d0e5123c3320dfb55d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/867cefd2bc273802292f4d0e5123c3320dfb55d4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/32310747977c02f6b9f7a97ca06cc8b77b3bbd52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32310747977c02f6b9f7a97ca06cc8b77b3bbd52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32310747977c02f6b9f7a97ca06cc8b77b3bbd52", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32310747977c02f6b9f7a97ca06cc8b77b3bbd52/comments", "author": null, "committer": null, "parents": [{"sha": "ffe9aba81229acba2f9c9a96503dc08ae9a03bb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ffe9aba81229acba2f9c9a96503dc08ae9a03bb5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ffe9aba81229acba2f9c9a96503dc08ae9a03bb5"}], "stats": {"total": 39, "additions": 19, "deletions": 20}, "files": [{"sha": "ac1e21384905e2e9647e8967ab738a5da0a0c10c", "filename": "gcc/ada/exp_ch9.adb", "status": "modified", "additions": 11, "deletions": 12, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32310747977c02f6b9f7a97ca06cc8b77b3bbd52/gcc%2Fada%2Fexp_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32310747977c02f6b9f7a97ca06cc8b77b3bbd52/gcc%2Fada%2Fexp_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch9.adb?ref=32310747977c02f6b9f7a97ca06cc8b77b3bbd52", "patch": "@@ -187,13 +187,12 @@ package body Exp_Ch9 is\n       Append_Char      : Character := ' ') return Name_Id;\n    --  Build a name in the form of Prefix__Selector, with an optional\n    --  character appended. This is used for internal subprograms generated\n-   --  for operations of protected types, including barrier functions. In\n-   --  order to simplify the work of the debugger, the prefix includes the\n-   --  characters PT. For the subprograms generated for entry bodies and\n-   --  entry barriers, the generated name includes a sequence number that\n-   --  makes names unique in the presence of entry overloading. This is\n-   --  necessary because entry body procedures and barrier functions all\n-   --  have the same signature.\n+   --  for operations of protected types, including barrier functions.\n+   --  For the subprograms generated for entry bodies and entry barriers,\n+   --  the generated name includes a sequence number that makes names\n+   --  unique in the presence of entry overloading. This is necessary\n+   --  because entry body procedures and barrier functions all have the\n+   --  same signature.\n \n    procedure Build_Simple_Entry_Call\n      (N       : Node_Id;\n@@ -799,6 +798,7 @@ package body Exp_Ch9 is\n       Loc    : Source_Ptr) return Node_Id\n    is\n    begin\n+      Set_Needs_Debug_Info (Def_Id);\n       return Make_Function_Specification (Loc,\n         Defining_Unit_Name => Def_Id,\n         Parameter_Specifications => New_List (\n@@ -1395,6 +1395,7 @@ package body Exp_Ch9 is\n       P : Entity_Id;\n \n    begin\n+      Set_Needs_Debug_Info (Def_Id);\n       P := Make_Defining_Identifier (Loc, Name_uP);\n \n       if Present (Ent_Id) then\n@@ -1911,12 +1912,10 @@ package body Exp_Ch9 is\n          Name_Len := Name_Len - 1;\n       end if;\n \n-      Name_Buffer (Name_Len + 1) := 'P';\n-      Name_Buffer (Name_Len + 2) := 'T';\n-      Name_Buffer (Name_Len + 3) := '_';\n-      Name_Buffer (Name_Len + 4) := '_';\n+      Name_Buffer (Name_Len + 1) := '_';\n+      Name_Buffer (Name_Len + 2) := '_';\n \n-      Name_Len := Name_Len + 4;\n+      Name_Len := Name_Len + 2;\n       for J in 1 .. Select_Len loop\n          Name_Len := Name_Len + 1;\n          Name_Buffer (Name_Len) := Select_Buffer (J);"}, {"sha": "83604f7901f5b07ffd929e9d65011ca64dba5641", "filename": "gcc/ada/exp_dbug.ads", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/32310747977c02f6b9f7a97ca06cc8b77b3bbd52/gcc%2Fada%2Fexp_dbug.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/32310747977c02f6b9f7a97ca06cc8b77b3bbd52/gcc%2Fada%2Fexp_dbug.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_dbug.ads?ref=32310747977c02f6b9f7a97ca06cc8b77b3bbd52", "patch": "@@ -354,8 +354,8 @@ package Exp_Dbug is\n       --  calls from other operations on the same object. The locking operation\n       --  simply acquires the lock, and then calls the non-locking version.\n       --  The names of all of these have a prefix constructed from the name of\n-      --  the type, the string \"PT\", and a suffix which is P or N, depending on\n-      --  whether this is the protected/non-locking version of the operation.\n+      --  the type, and a suffix which is P or N, depending on whether this is\n+      --  the protected/non-locking version of the operation.\n \n       --  Operations generated for protected entries follow the same encoding.\n       --  Each entry results in two suprograms: a procedure that holds the\n@@ -376,14 +376,14 @@ package Exp_Dbug is\n \n       --  the following operations are created:\n \n-      --    lockPT_getN\n-      --    lockPT_getP,\n+      --    lock_getN\n+      --    lock_getP,\n \n-      --    lockPT_setN\n-      --    lockPT_setP\n+      --    lock_setN\n+      --    lock_setP\n \n-      --    lockPT_update1sE\n-      --    lockPT_udpate2sB\n+      --    lock_update1sE\n+      --    lock_udpate2sB\n \n    ----------------------------------------------------\n    -- Conversion between Entities and External Names --"}]}