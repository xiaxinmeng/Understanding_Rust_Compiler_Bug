{"sha": "4b1d52c7ae4f1ccf81daa0b238b797031ce7d613", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGIxZDUyYzdhZTRmMWNjZjgxZGFhMGIyMzhiNzk3MDMxY2U3ZDYxMw==", "commit": {"author": {"name": "Gabriel Dos Reis", "email": "gdr@codesourcery.com", "date": "2002-06-07T13:00:43Z"}, "committer": {"name": "Gabriel Dos Reis", "email": "gdr@gcc.gnu.org", "date": "2002-06-07T13:00:43Z"}, "message": "* diagnostic.c (diagnostic_build_prefix): Tidy.\n\nFrom-SVN: r54337", "tree": {"sha": "e13052f18e8402392c71592a97c9250f0b8ddccf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e13052f18e8402392c71592a97c9250f0b8ddccf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613/comments", "author": null, "committer": null, "parents": [{"sha": "255d3c70281ee4384238ad6fcde356e887a25084", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/255d3c70281ee4384238ad6fcde356e887a25084", "html_url": "https://github.com/Rust-GCC/gccrs/commit/255d3c70281ee4384238ad6fcde356e887a25084"}], "stats": {"total": 38, "additions": 20, "deletions": 18}, "files": [{"sha": "10d1df8aa1e2d438fc3e65f31d93eb2d880d0a0d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4b1d52c7ae4f1ccf81daa0b238b797031ce7d613", "patch": "@@ -1,3 +1,7 @@\n+2002-06-07  Gabriel Dos Reis  <gdr@codesourcery.com>\n+\n+\t* diagnostic.c (diagnostic_build_prefix): Tidy.\n+\n 2002-06-07  Neil Booth  <neil@daikokuya.demon.co.uk>\n \n \t* cpptrad.c (struct block, BLOCK_HEADER_LEN, BLOCK_LEN,"}, {"sha": "54f4911e98fcfc1d87d109b777de6165d4fbcb7c", "filename": "gcc/diagnostic.c", "status": "modified", "additions": 16, "deletions": 18, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613/gcc%2Fdiagnostic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b1d52c7ae4f1ccf81daa0b238b797031ce7d613/gcc%2Fdiagnostic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdiagnostic.c?ref=4b1d52c7ae4f1ccf81daa0b238b797031ce7d613", "patch": "@@ -790,24 +790,22 @@ char *\n diagnostic_build_prefix (diagnostic)\n      diagnostic_info *diagnostic;\n {\n-  if (diagnostic->location.file)\n-    {\n-      if (diagnostic->kind == DK_WARNING)\n-\treturn build_message_string (_(\"%s:%d: warning: \"),\n-                                     diagnostic->location.file,\n-                                     diagnostic->location.line);\n-      else\n-\treturn build_message_string (\"%s:%d: \",\n-                                     diagnostic->location.file,\n-                                     diagnostic->location.line);\n-    }\n-  else\n-    {\n-      if (diagnostic->kind == DK_WARNING)\n-\treturn build_message_string (_(\"%s: warning: \"), progname);\n-      else\n-\treturn build_message_string (\"%s: \", progname);\n-    }\n+  static const char *diagnostic_kind_text[] = {\n+#define DEFINE_DIAGNOSTIC_KIND(K, T) _(T),\n+#include \"diagnostic.def\"\n+#undef DEFINE_DIAGNOSTIC_KIND\n+    \"must-not-happen\"\n+  };\n+   if (diagnostic->kind >= DK_LAST_DIAGNOSTIC_KIND)\n+     abort();\n+\n+  return diagnostic->location.file\n+    ? build_message_string (\"%s:%d: %s\",\n+                            diagnostic->location.file,\n+                            diagnostic->location.line,\n+                            diagnostic_kind_text[diagnostic->kind])\n+    : build_message_string (\"%s: %s\", progname,\n+                            diagnostic_kind_text[diagnostic->kind]);\n }\n \n /* Report a diagnostic MESSAGE at the declaration DECL."}]}