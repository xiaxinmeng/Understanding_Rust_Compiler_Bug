{"sha": "111716e0e166cbcec6880ec3266bbc335f96d2ca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTExNzE2ZTBlMTY2Y2JjZWM2ODgwZWMzMjY2YmJjMzM1Zjk2ZDJjYQ==", "commit": {"author": {"name": "Daniel Franke", "email": "dfranke@gcc.gnu.org", "date": "2007-12-22T22:18:28Z"}, "committer": {"name": "Daniel Franke", "email": "dfranke@gcc.gnu.org", "date": "2007-12-22T22:18:28Z"}, "message": "re PR fortran/34559 (ICE using REPEAT on string literals)\n\ngcc/fortran:\n2007-12-22  Daniel Franke  <franke.daniel@gmail.com>\n\n        PR fortran/34559\n        * simplify.c (gfc_simplify_repeat): Added safeguard for empty string\n        literals.\n\ngcc/testsuite:\n2007-12-22  Daniel Franke  <franke.daniel@gmail.com>\n\n\tPR fortran/34559\n\t* gfortran.dg/repeat_6.f90: New test.\n\nFrom-SVN: r131139", "tree": {"sha": "ccbe60c206a371af87a720afe69089d642dff136", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ccbe60c206a371af87a720afe69089d642dff136"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/111716e0e166cbcec6880ec3266bbc335f96d2ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/111716e0e166cbcec6880ec3266bbc335f96d2ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/111716e0e166cbcec6880ec3266bbc335f96d2ca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/111716e0e166cbcec6880ec3266bbc335f96d2ca/comments", "author": null, "committer": null, "parents": [{"sha": "62ee27a4694a9dcd8a9470217dd03900ef7c8ba3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62ee27a4694a9dcd8a9470217dd03900ef7c8ba3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62ee27a4694a9dcd8a9470217dd03900ef7c8ba3"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "79c23de109052740c21e92c725da5d01336ee3f6", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=111716e0e166cbcec6880ec3266bbc335f96d2ca", "patch": "@@ -1,3 +1,9 @@\n+2007-12-22  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/34559\n+\t* simplify.c (gfc_simplify_repeat): Added safeguard for empty\n+\tstring literals.\n+\n 2007-12-22  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/34549\n@@ -26,6 +32,7 @@\n \t* module.c (read_module): Check sym->module is there before\n \tusing it in a string comparison.\n \n+>>>>>>> .r131138\n 2007-12-20  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/34482"}, {"sha": "1641586457eda0989434cf57023fc366bdf40bf2", "filename": "gcc/fortran/simplify.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ffortran%2Fsimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ffortran%2Fsimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsimplify.c?ref=111716e0e166cbcec6880ec3266bbc335f96d2ca", "patch": "@@ -3128,7 +3128,9 @@ gfc_simplify_repeat (gfc_expr *e, gfc_expr *n)\n   if (e->expr_type != EXPR_CONSTANT)\n     return NULL;\n \n-  if (len || mpz_sgn (e->ts.cl->length->value.integer) != 0)\n+  if (len || \n+      (e->ts.cl->length && \n+       mpz_sgn (e->ts.cl->length->value.integer)) != 0)\n     {\n       const char *res = gfc_extract_int (n, &ncop);\n       gcc_assert (res == NULL);"}, {"sha": "a6816d48bc01eff4c6e0db9b0752e188dcdee18b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=111716e0e166cbcec6880ec3266bbc335f96d2ca", "patch": "@@ -1,3 +1,8 @@\n+2007-12-22  Daniel Franke  <franke.daniel@gmail.com>\n+\n+\tPR fortran/34559\n+\t* gfortran.dg/repeat_6.f90: New test.\n+\n 2007-12-22  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/34549"}, {"sha": "308941f9a2dbfa66060305867025416bc4ae7868", "filename": "gcc/testsuite/gfortran.dg/repeat_6.f90", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ftestsuite%2Fgfortran.dg%2Frepeat_6.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/111716e0e166cbcec6880ec3266bbc335f96d2ca/gcc%2Ftestsuite%2Fgfortran.dg%2Frepeat_6.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Frepeat_6.f90?ref=111716e0e166cbcec6880ec3266bbc335f96d2ca", "patch": "@@ -0,0 +1,13 @@\n+! { dg-do run }\n+!\n+! PR34559 -- ICE on empty string literals\n+!\n+! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n+!\n+\n+  character(len=200) :: string = \"a\" // repeat (\"\", 3)       &\n+                                     // repeat (\"xxx\", 0)    &\n+                                     // repeat (\"string\", 2)\n+\n+  if (string /= \"astringstring\") CALL abort()\n+end"}]}