{"sha": "6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmZlZWVkMDY1Y2JhMzE4NWQwODdhYTcwYTVhNzQ5M2E0YTdiYmMzYg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2011-07-15T21:29:57Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2011-07-15T21:29:57Z"}, "message": "re PR testsuite/49741 (make -k check-c++0x not multilib aware)\n\n\tPR testsuite/49741\ngcc/\n\t* Makefile.in ($(lang_checks_parallelized)): Allow --extra_opts\n\trather than --tool_opts.\ngcc/cp/\n\t* Make-lang.in (check-c++0x): Use --extra_opts instead of--tool_opts.\ngcc/testsuite/\n\t* lib/g++.exp (${tool}_option_help, ${tool}_option_proc): Restore.\n\tUse --extra_opts instead of --additional_options.\n\n\t* Makefile.in (check-c++): Move check-gcc-c++0x after\n\tcheck-target-libstdc++-v3.\n\nFrom-SVN: r176332", "tree": {"sha": "807b02754172ebb603c80eaace60c1e49b750d16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/807b02754172ebb603c80eaace60c1e49b750d16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4476205585284726e033e2759f29652c4798d160", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4476205585284726e033e2759f29652c4798d160", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4476205585284726e033e2759f29652c4798d160"}], "stats": {"total": 61, "additions": 57, "deletions": 4}, "files": [{"sha": "5794a5d1a1037c86e2a1c2caeaa598281597413b", "filename": "ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -1,3 +1,8 @@\n+2011-07-15  Jason Merrill  <jason@redhat.com>\n+\n+\t* Makefile.in (check-c++): Move check-gcc-c++0x after\n+\tcheck-target-libstdc++-v3.\n+\n 2011-07-15  Bernd Schmidt  <bernds@codesourcery.com>\n \n \t* MAINTAINERS (c6x port): New entry."}, {"sha": "0d40358d209db2b763f1907005eb9a3411cf9c04", "filename": "Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/Makefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/Makefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Makefile.in?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -40157,7 +40157,7 @@ check-gcc-c++0x:\n \ts=`cd $(srcdir); ${PWD_COMMAND}`; export s; \\\n \t$(HOST_EXPORTS) \\\n \t(cd gcc && $(MAKE) $(GCC_FLAGS_TO_PASS) check-c++0x);\n-check-c++: check-gcc-c++ check-gcc-c++0x check-target-libstdc++-v3\n+check-c++: check-gcc-c++ check-target-libstdc++-v3 check-gcc-c++0x\n \n .PHONY: check-gcc-fortran check-fortran\n check-gcc-fortran:"}, {"sha": "7d52dd3ecbb5256906b8a423314dc5def3db799a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -1,3 +1,9 @@\n+2011-07-15  Jason Merrill  <jason@redhat.com>\n+\n+\tPR testsuite/49741\n+\t* Makefile.in ($(lang_checks_parallelized)): Allow --extra_opts\n+\trather than --tool_opts.\n+\n 2011-07-15  Basile Starynkevitch  <basile@starynkevitch.net>\n \n \t* doc/plugins.texi (Building GCC plugins): gengtype needs its"}, {"sha": "47e14fa969757327116979a82f3c31cc991b5ea1", "filename": "gcc/Makefile.in", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -5019,7 +5019,7 @@ check_p_subdirs=$(wordlist 1,$(words $(check_$*_parallelize)),$(check_p_numbers)\n \n # For parallelized check-% targets, this decides whether parallelization\n # is desirable (if -jN is used and RUNTESTFLAGS doesn't contain anything\n-# but optional --target_board or --tool_opts arguments).  If it is desirable,\n+# but optional --target_board or --extra_opts arguments).  If desirable,\n # recursive make is run with check-parallel-$lang{,1,2,3,4,5} etc. goals,\n # which can be executed in parallel, as they are run in separate directories.\n # check-parallel-$lang{1,2,3,4,5} etc. goals invoke runtest with the longest\n@@ -5036,7 +5036,7 @@ check_p_subdirs=$(wordlist 1,$(words $(check_$*_parallelize)),$(check_p_numbers)\n # to lang_checks_parallelized variable and define check_$lang_parallelize\n # variable (see above check_gcc_parallelize description).\n $(lang_checks_parallelized): check-% : site.exp\n-\t@if [ -z \"$(filter-out --target_board=%,$(filter-out --tool_opts%,$(RUNTESTFLAGS)))\" ] \\\n+\t@if [ -z \"$(filter-out --target_board=%,$(filter-out --extra_opts%,$(RUNTESTFLAGS)))\" ] \\\n \t    && [ \"$(filter -j, $(MFLAGS))\" = \"-j\" ]; then \\\n \t  $(MAKE) TESTSUITEDIR=\"$(TESTSUITEDIR)\" RUNTESTFLAGS=\"$(RUNTESTFLAGS)\" \\\n \t    check-parallel-$* \\"}, {"sha": "a0ce80dadbd5d769d381913bde27dd5757b00bb9", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -1,3 +1,8 @@\n+2011-07-15  Jason Merrill  <jason@redhat.com>\n+\n+\tPR testsuite/49741\n+\t* Make-lang.in (check-c++0x): Use --extra_opts instead of--tool_opts.\n+\n 2011-07-13  Jason Merrill  <jason@redhat.com>\n \n \t* Make-lang.in (check-c++0x): New."}, {"sha": "ad466b2dc163107a8a8d65aaa42cdcf5467defab", "filename": "gcc/cp/Make-lang.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Fcp%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Fcp%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FMake-lang.in?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -151,7 +151,7 @@ c++.srcman: doc/g++.1\n check-c++ : check-g++\n # Run the testsute in C++0x mode.\n check-c++0x:\n-\t$(MAKE) RUNTESTFLAGS=\"$(RUNTESTFLAGS) --tool_opts=-std=gnu++0x\" \\\n+\t$(MAKE) RUNTESTFLAGS=\"$(RUNTESTFLAGS) --extra_opts,-std=gnu++0x\" \\\n \t  TESTSUITEDIR=\"$(TESTSUITEDIR).c++0x\" check-g++\n check-c++-subtargets : check-g++-subtargets\n # List of targets that can use the generic check- rule and its // variant."}, {"sha": "c49833478f34e6db4997697cca7ee1cc1e1e6086", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -1,3 +1,9 @@\n+2011-07-15  Jason Merrill  <jason@redhat.com>\n+\n+\tPR testsuite/49741\n+\t* lib/g++.exp (${tool}_option_help, ${tool}_option_proc): Restore.\n+\tUse --extra_opts instead of --additional_options.\n+\n 2011-07-15  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR testsuite/49753"}, {"sha": "9e269b12d66c4428bc58dc650b3b7c2791f45bed", "filename": "gcc/testsuite/lib/g++.exp", "status": "modified", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Ftestsuite%2Flib%2Fg%2B%2B.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6feeed065cba3185d087aa70a5a7493a4a7bbc3b/gcc%2Ftestsuite%2Flib%2Fg%2B%2B.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fg%2B%2B.exp?ref=6feeed065cba3185d087aa70a5a7493a4a7bbc3b", "patch": "@@ -307,3 +307,34 @@ proc g++_target_compile { source dest type options } {\n \n     return $result\n }\n+\n+#\n+# ${tool}_option_help\n+#\n+# Changed \"additional\" to \"extra\" because runtest.exp treats --a* as --all.\n+#\n+# This shouldn't be necessary at all; it should be entirely redundant with\n+# --tool_opts, except that --tool_opts currently breaks multilib: see\n+# http://lists.gnu.org/archive/html/dejagnu/2002-10/msg00007.html\n+\n+proc ${tool}_option_help { } {\n+    send_user \" --extra_opts,OPTIONS\\t\\tUse OPTIONS to compile the testcase files. OPTIONS should be comma-separated.\\n\"\n+}\n+\n+#\n+# ${tool}_option_proc\n+#\n+\n+proc ${tool}_option_proc { option } {\n+    if [regexp \"^--extra_opts,\" $option] {\n+\tglobal gpp_compile_options\n+\tregsub \"^--extra_opts,\" $option \"\" option\n+\tforeach x [split $option \",\"] {\n+\t    lappend gpp_compile_options \"additional_flags=$x\"\n+\t}\n+\tverbose -log \"gpp_compile_options set to $gpp_compile_options\"\n+\treturn 1\n+    } else {\n+\treturn 0\n+    }\n+}"}]}