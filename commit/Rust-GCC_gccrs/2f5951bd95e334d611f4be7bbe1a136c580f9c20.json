{"sha": "2f5951bd95e334d611f4be7bbe1a136c580f9c20", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmY1OTUxYmQ5NWUzMzRkNjExZjRiZTdiYmUxYTEzNmM1ODBmOWMyMA==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-08-19T21:36:53Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-08-20T01:18:30Z"}, "message": "analyzer: fix ICE on vector comparisons [PR96713]\n\ngcc/analyzer/ChangeLog:\n\tPR analyzer/96713\n\t* region-model.cc (region_model::get_gassign_result): For\n\tcomparisons, only use eval_condition when the lhs has boolean\n\ttype, and use get_or_create_constant_svalue on the boolean\n\tconstants directly rather than via get_rvalue.\n\ngcc/testsuite/ChangeLog:\n\tPR analyzer/96713\n\t* gcc.dg/analyzer/pr96713.c: New test.", "tree": {"sha": "d8b4686beed979d3f49d0f6bc2ae610d53198b16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8b4686beed979d3f49d0f6bc2ae610d53198b16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f5951bd95e334d611f4be7bbe1a136c580f9c20", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f5951bd95e334d611f4be7bbe1a136c580f9c20", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f5951bd95e334d611f4be7bbe1a136c580f9c20", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f5951bd95e334d611f4be7bbe1a136c580f9c20/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04e23a4051fb3c049f85b9e6e2fc58f937337aff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04e23a4051fb3c049f85b9e6e2fc58f937337aff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04e23a4051fb3c049f85b9e6e2fc58f937337aff"}], "stats": {"total": 33, "additions": 20, "deletions": 13}, "files": [{"sha": "b8a0f9ffd3d5fa340a68b81c635b5c73adb14883", "filename": "gcc/analyzer/region-model.cc", "status": "modified", "additions": 12, "deletions": 13, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f5951bd95e334d611f4be7bbe1a136c580f9c20/gcc%2Fanalyzer%2Fregion-model.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f5951bd95e334d611f4be7bbe1a136c580f9c20/gcc%2Fanalyzer%2Fregion-model.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fregion-model.cc?ref=2f5951bd95e334d611f4be7bbe1a136c580f9c20", "patch": "@@ -462,24 +462,23 @@ region_model::get_gassign_result (const gassign *assign,\n       {\n \ttree rhs2 = gimple_assign_rhs2 (assign);\n \n-\t// TODO: constraints between svalues\n \tconst svalue *rhs1_sval = get_rvalue (rhs1, ctxt);\n \tconst svalue *rhs2_sval = get_rvalue (rhs2, ctxt);\n \n-\ttristate t = eval_condition (rhs1_sval, op, rhs2_sval);\n-\tif (t.is_known ())\n-\t  return get_rvalue (t.is_true ()\n-\t\t\t     ? boolean_true_node\n-\t\t\t     : boolean_false_node,\n-\t\t\t     ctxt);\n-\telse\n+\tif (TREE_TYPE (lhs) == boolean_type_node)\n \t  {\n-\t    // TODO: symbolic value for binop\n-\t    const svalue *sval_binop\n-\t      = m_mgr->get_or_create_binop (TREE_TYPE (lhs), op,\n-\t\t\t\t\t    rhs1_sval, rhs2_sval);\n-\t    return sval_binop;\n+\t    /* Consider constraints between svalues.  */\n+\t    tristate t = eval_condition (rhs1_sval, op, rhs2_sval);\n+\t    if (t.is_known ())\n+\t      return m_mgr->get_or_create_constant_svalue\n+\t\t(t.is_true () ? boolean_true_node : boolean_false_node);\n \t  }\n+\n+\t/* Otherwise, generate a symbolic binary op.  */\n+\tconst svalue *sval_binop\n+\t  = m_mgr->get_or_create_binop (TREE_TYPE (lhs), op,\n+\t\t\t\t\trhs1_sval, rhs2_sval);\n+\treturn sval_binop;\n       }\n       break;\n "}, {"sha": "fe9cafd73f1fb6fe5788960d26a778c6e52d7952", "filename": "gcc/testsuite/gcc.dg/analyzer/pr96713.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f5951bd95e334d611f4be7bbe1a136c580f9c20/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr96713.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f5951bd95e334d611f4be7bbe1a136c580f9c20/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr96713.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr96713.c?ref=2f5951bd95e334d611f4be7bbe1a136c580f9c20", "patch": "@@ -0,0 +1,8 @@\n+typedef int __attribute__ ((vector_size (8))) V;\n+\n+void\n+foo (V d, V e)\n+{\n+  d <= e;\n+  foo ((V){}, (V){});\n+}"}]}