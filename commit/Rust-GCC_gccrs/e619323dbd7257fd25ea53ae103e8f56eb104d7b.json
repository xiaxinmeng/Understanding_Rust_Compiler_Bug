{"sha": "e619323dbd7257fd25ea53ae103e8f56eb104d7b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTYxOTMyM2RiZDcyNTdmZDI1ZWE1M2FlMTAzZThmNTZlYjEwNGQ3Yg==", "commit": {"author": {"name": "David S. Miller", "email": "davem@redhat.com", "date": "1999-12-18T18:30:41Z"}, "committer": {"name": "David S. Miller", "email": "davem@gcc.gnu.org", "date": "1999-12-18T18:30:41Z"}, "message": "toplev.c (rest_of_compilation): Restore BLOCK tree reconstruction and branch shortening changes lost in...\n\n\t* toplev.c (rest_of_compilation): Restore BLOCK tree\n\treconstruction and branch shortening changes lost in\n\tDecember 18th change.\n\nFrom-SVN: r31013", "tree": {"sha": "88c60111a0e53336c1becf36b5787d9c54231947", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/88c60111a0e53336c1becf36b5787d9c54231947"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e619323dbd7257fd25ea53ae103e8f56eb104d7b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e619323dbd7257fd25ea53ae103e8f56eb104d7b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e619323dbd7257fd25ea53ae103e8f56eb104d7b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e619323dbd7257fd25ea53ae103e8f56eb104d7b/comments", "author": null, "committer": null, "parents": [{"sha": "05e1739fcf801f145ae480d694b8d97c4cc8acdd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05e1739fcf801f145ae480d694b8d97c4cc8acdd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05e1739fcf801f145ae480d694b8d97c4cc8acdd"}], "stats": {"total": 27, "additions": 21, "deletions": 6}, "files": [{"sha": "8be52e9e335ed2ec4b1b7a54d711ee22ba554e72", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e619323dbd7257fd25ea53ae103e8f56eb104d7b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e619323dbd7257fd25ea53ae103e8f56eb104d7b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e619323dbd7257fd25ea53ae103e8f56eb104d7b", "patch": "@@ -1,3 +1,9 @@\n+1999-12-18  David S. Miller  <davem@redhat.com>\n+\n+\t* toplev.c (rest_of_compilation): Restore BLOCK tree\n+\treconstruction and branch shortening changes lost in\n+\tDecember 18th change.\n+\n Sat Dec 18 05:29:29 1999  Scott Bambrough  <scottb@netwinder.org>\n \n \t* config/arm/linux-elf.h: Change all instances of "}, {"sha": "39354a56096edf411015772c5a6f2ec7c74f6a6d", "filename": "gcc/toplev.c", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e619323dbd7257fd25ea53ae103e8f56eb104d7b/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e619323dbd7257fd25ea53ae103e8f56eb104d7b/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=e619323dbd7257fd25ea53ae103e8f56eb104d7b", "patch": "@@ -2750,6 +2750,14 @@ rest_of_compilation (decl)\n      collector to reclaim the memory used by the notes.  */\n   remove_unncessary_notes ();\n \n+  /* In function-at-a-time mode, we do not attempt to keep the BLOCK\n+     tree in sensible shape.  So, we just recalculate it here.  */\n+  if (current_function->x_whole_function_mode_p)\n+    {\n+      find_loop_tree_blocks ();\n+      unroll_block_trees ();\n+    }\n+\n   /* If we are reconsidering an inline function\n      at the end of compilation, skip the stuff for making it inline.  */\n \n@@ -3205,6 +3213,7 @@ rest_of_compilation (decl)\n \t(flow_time,\n \t {\n \t   find_basic_blocks (insns, max_reg_num (), rtl_dump_file, 1);\n+\t   calculate_loop_depth (rtl_dump_file);\n \t   life_analysis (insns, max_reg_num (), rtl_dump_file, 1);\n \t });\n \n@@ -3537,12 +3546,6 @@ rest_of_compilation (decl)\n      ggc_collect ();\n #endif\n \n-  /* Shorten branches.  */\n-  TIMEVAR (shorten_branch_time,\n-\t   {\n-\t     shorten_branches (get_insns ());\n-\t   });\n-\n #ifdef STACK_REGS\n   if (stack_reg_dump)\n     open_dump_file (\".20.stack\", decl_printable_name (decl, 2));\n@@ -3560,6 +3563,12 @@ rest_of_compilation (decl)\n      ggc_collect ();\n #endif\n \n+  /* Shorten branches.  */\n+  TIMEVAR (shorten_branch_time,\n+\t   {\n+\t     shorten_branches (get_insns ());\n+\t   });\n+\n   /* Now turn the rtl into assembler code.  */\n \n   TIMEVAR (final_time,"}]}