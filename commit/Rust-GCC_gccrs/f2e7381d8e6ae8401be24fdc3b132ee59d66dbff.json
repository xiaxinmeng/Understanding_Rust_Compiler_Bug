{"sha": "f2e7381d8e6ae8401be24fdc3b132ee59d66dbff", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjJlNzM4MWQ4ZTZhZTg0MDFiZTI0ZmRjM2IxMzJlZTU5ZDY2ZGJmZg==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@unitus.it", "date": "2002-01-30T21:00:40Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2002-01-30T21:00:40Z"}, "message": "2002-01-30  Paolo Carlini  <pcarlini@unitus.it>\n\n        * config/locale/numpunct_members_gnu.cc\n\t(numpunct<char, wchar_t>::_M_initialize_numpunct()):\n\tFix initialization of _M_grouping for locales which have\n\t_M_thousands_sep == '\\0'(L'\\0', respectively).\n\t* testsuite/22_locale/numpunct_byname.cc (test02): Add test.\n\nFrom-SVN: r49343", "tree": {"sha": "f27444366e9bc7b064f14b74d6090599626c1e96", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f27444366e9bc7b064f14b74d6090599626c1e96"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff/comments", "author": null, "committer": null, "parents": [{"sha": "a852d50fb4f376a7bd79a9b05025dbc5590da378", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a852d50fb4f376a7bd79a9b05025dbc5590da378", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a852d50fb4f376a7bd79a9b05025dbc5590da378"}], "stats": {"total": 36, "additions": 34, "deletions": 2}, "files": [{"sha": "34126053580786bfea4d090b5506031684f3d38a", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=f2e7381d8e6ae8401be24fdc3b132ee59d66dbff", "patch": "@@ -1,3 +1,11 @@\n+2002-01-30  Paolo Carlini  <pcarlini@unitus.it>\n+\n+\t* config/locale/numpunct_members_gnu.cc\n+\t(numpunct<char, wchar_t>::_M_initialize_numpunct()):\n+\tFix initialization of _M_grouping for locales which have\n+\t_M_thousands_sep == '\\0'(L'\\0', respectively).\n+\t* testsuite/22_locale/numpunct_byname.cc (test02): Add test.\n+\n 2002-01-30  Paolo Carlini  <pcarlini@unitus.it>\n \n \t* testsuite/27_io/ostream_inserter_arith.cc (test03):"}, {"sha": "4284c7c07b37971b5312f4123b9460b71b2599c1", "filename": "libstdc++-v3/config/locale/numpunct_members_gnu.cc", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fnumpunct_members_gnu.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fnumpunct_members_gnu.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Flocale%2Fnumpunct_members_gnu.cc?ref=f2e7381d8e6ae8401be24fdc3b132ee59d66dbff", "patch": "@@ -53,7 +53,11 @@ namespace std\n \t  // Named locale.\n \t  _M_decimal_point = *(__nl_langinfo_l(RADIXCHAR, __cloc));\n \t  _M_thousands_sep = *(__nl_langinfo_l(THOUSEP, __cloc));\n-\t  _M_grouping = __nl_langinfo_l(GROUPING, __cloc);\n+\t  // Check for NUL, which implies no grouping.\n+\t  if (_M_thousands_sep == '\\0')\n+\t    _M_grouping = \"\";\n+\t  else\n+\t    _M_grouping = __nl_langinfo_l(GROUPING, __cloc);\n \t}\n       // NB: There is no way to extact this info from posix locales.\n       // _M_truename = __nl_langinfo_l(YESSTR, __cloc);\n@@ -79,7 +83,10 @@ namespace std\n \t  // Named locale.\n \t  _M_decimal_point = static_cast<wchar_t>(((union { const char *__s; unsigned int __w; }){ __s: __nl_langinfo_l(_NL_NUMERIC_DECIMAL_POINT_WC, __cloc)}).__w);\n \t  _M_thousands_sep = static_cast<wchar_t>(((union { const char *__s; unsigned int __w; }){ __s: __nl_langinfo_l(_NL_NUMERIC_THOUSANDS_SEP_WC, __cloc)}).__w);\n-\t  _M_grouping = __nl_langinfo_l(GROUPING, __cloc);\n+\t  if (_M_thousands_sep == L'\\0')\n+\t    _M_grouping = \"\";\n+\t  else\n+\t    _M_grouping = __nl_langinfo_l(GROUPING, __cloc);\n \t}\n       // NB: There is no way to extact this info from posix locales.\n       // _M_truename = __nl_langinfo_l(YESSTR, __cloc);"}, {"sha": "4c69b291a0a8e4ae9fe550bee66e6cd58c55e3c3", "filename": "libstdc++-v3/testsuite/22_locale/numpunct_byname.cc", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnumpunct_byname.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2e7381d8e6ae8401be24fdc3b132ee59d66dbff/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnumpunct_byname.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnumpunct_byname.cc?ref=f2e7381d8e6ae8401be24fdc3b132ee59d66dbff", "patch": "@@ -72,9 +72,26 @@ void test01()\n   VERIFY( dp1 != dp3 );\n }\n \n+void test02()\n+{\n+  using namespace std;\n+  \n+  bool test = true;\n+\n+  locale loc_it(\"it_IT\");\n+\n+  const numpunct<char>& nump_it = use_facet<numpunct<char> >(loc_it); \n+\n+  string g = nump_it.grouping();\n+\n+  VERIFY( g == \"\" );\n+}\n+\n+\n int main()\n {\n   test01();\n+  test02();\n \n   return 0;\n }"}]}