{"sha": "c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzc1Nzk1ZmExZGMyOTcxNmY1MTljYTZkMWM4Y2NjYjY3ZDBkMjA2Mg==", "commit": {"author": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2019-01-25T14:39:58Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2019-01-25T14:39:58Z"}, "message": "[libbacktrace] Fix strrchr segfault\n\nCurrently, when running a libbacktrace testcase t with .gnu_debuglink to\nt.debug, and t.debug having a .gnu_debugaltlink to t.alt.debug, a segfault\nis triggered when calling strrchr with a NULL string from\nelf_find_debugfile_by_debuglink.  The NULL string originates from the elf_add\ncalled for the .gnu_debugaltlink, which uses NULL as filename argument.\n\nFix this by using \"\" as filename argument instead.\n\n2019-01-25  Tom de Vries  <tdevries@suse.de>\n\n\t* elf.c (elf_add): When handling .gnu_debugaltlink, call elf_add with\n\tfilename == \"\".\n\t* Makefile.am (TESTS): Add btest_dwz_gnudebuglink.\n\t* Makefile.in: Regenerate.\n\nFrom-SVN: r268269", "tree": {"sha": "4a320ed1ce1aa49329041a5d06027e300d24ee86", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4a320ed1ce1aa49329041a5d06027e300d24ee86"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/comments", "author": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "37ab491dcee76e83ce32506632810b04a6045d5e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37ab491dcee76e83ce32506632810b04a6045d5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37ab491dcee76e83ce32506632810b04a6045d5e"}], "stats": {"total": 37, "additions": 29, "deletions": 8}, "files": [{"sha": "55ccd62261edbbb0589f12b690991628f3196192", "filename": "libbacktrace/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libbacktrace%2FChangeLog?ref=c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "patch": "@@ -1,3 +1,10 @@\n+2019-01-25  Tom de Vries  <tdevries@suse.de>\n+\n+\t* elf.c (elf_add): When handling .gnu_debugaltlink, call elf_add with\n+\tfilename == \"\".\n+\t* Makefile.am (TESTS): Add btest_dwz_gnudebuglink.\n+\t* Makefile.in: Regenerate.\n+\n 2019-01-25  Tom de Vries  <tdevries@suse.de>\n \n \t* Makefile.am: Rewrite dtest rule into \"%_gnudebuglink\" pattern rule."}, {"sha": "997a535dff45ec820183547170aa35a5c0c7641a", "filename": "libbacktrace/Makefile.am", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libbacktrace%2FMakefile.am?ref=c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "patch": "@@ -190,6 +190,12 @@ if HAVE_DWZ\n \n TESTS += btest_dwz\n \n+if HAVE_OBJCOPY_DEBUGLINK\n+\n+TESTS += btest_dwz_gnudebuglink\n+\n+endif HAVE_OBJCOPY_DEBUGLINK\n+\n endif HAVE_DWZ\n \n stest_SOURCES = stest.c"}, {"sha": "f04577066f81dd665bfe3b031392635eeab1406f", "filename": "libbacktrace/Makefile.in", "status": "modified", "additions": 15, "deletions": 7, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libbacktrace%2FMakefile.in?ref=c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "patch": "@@ -127,11 +127,12 @@ check_PROGRAMS = $(am__EXEEXT_1) $(am__EXEEXT_2) $(am__EXEEXT_3)\n @NATIVE_TRUE@\tztest ztest_alloc edtest edtest_alloc\n @NATIVE_TRUE@am__append_2 = allocfail.sh\n @HAVE_DWZ_TRUE@@NATIVE_TRUE@am__append_3 = btest_dwz\n-@HAVE_ZLIB_TRUE@@NATIVE_TRUE@am__append_4 = -lz\n+@HAVE_DWZ_TRUE@@HAVE_OBJCOPY_DEBUGLINK_TRUE@@NATIVE_TRUE@am__append_4 = btest_dwz_gnudebuglink\n @HAVE_ZLIB_TRUE@@NATIVE_TRUE@am__append_5 = -lz\n-@HAVE_PTHREAD_TRUE@@NATIVE_TRUE@am__append_6 = ttest ttest_alloc\n-@HAVE_OBJCOPY_DEBUGLINK_TRUE@@NATIVE_TRUE@am__append_7 = btest_gnudebuglink\n-@HAVE_COMPRESSED_DEBUG_TRUE@@NATIVE_TRUE@am__append_8 = ctestg ctesta \\\n+@HAVE_ZLIB_TRUE@@NATIVE_TRUE@am__append_6 = -lz\n+@HAVE_PTHREAD_TRUE@@NATIVE_TRUE@am__append_7 = ttest ttest_alloc\n+@HAVE_OBJCOPY_DEBUGLINK_TRUE@@NATIVE_TRUE@am__append_8 = btest_gnudebuglink\n+@HAVE_COMPRESSED_DEBUG_TRUE@@NATIVE_TRUE@am__append_9 = ctestg ctesta \\\n @HAVE_COMPRESSED_DEBUG_TRUE@@NATIVE_TRUE@\tctestg_alloc \\\n @HAVE_COMPRESSED_DEBUG_TRUE@@NATIVE_TRUE@\tctesta_alloc\n subdir = .\n@@ -789,7 +790,7 @@ libbacktrace_la_LIBADD = \\\n \n libbacktrace_la_DEPENDENCIES = $(libbacktrace_la_LIBADD)\n TESTS = $(check_PROGRAMS) $(am__append_2) $(am__append_3) \\\n-\t$(am__append_7)\n+\t$(am__append_4) $(am__append_8)\n @NATIVE_TRUE@check_LTLIBRARIES = libbacktrace_alloc.la \\\n @NATIVE_TRUE@\tlibbacktrace_noformat.la \\\n @NATIVE_TRUE@\tlibbacktrace_instrumented_alloc.la\n@@ -834,9 +835,9 @@ TESTS = $(check_PROGRAMS) $(am__append_2) $(am__append_3) \\\n @NATIVE_TRUE@stest_alloc_LDADD = libbacktrace_alloc.la\n @NATIVE_TRUE@ztest_SOURCES = ztest.c testlib.c\n @NATIVE_TRUE@ztest_CFLAGS = -DSRCDIR=\\\"$(srcdir)\\\"\n-@NATIVE_TRUE@ztest_LDADD = libbacktrace.la $(am__append_4) \\\n+@NATIVE_TRUE@ztest_LDADD = libbacktrace.la $(am__append_5) \\\n @NATIVE_TRUE@\t$(CLOCK_GETTIME_LINK)\n-@NATIVE_TRUE@ztest_alloc_LDADD = libbacktrace_alloc.la $(am__append_5) \\\n+@NATIVE_TRUE@ztest_alloc_LDADD = libbacktrace_alloc.la $(am__append_6) \\\n @NATIVE_TRUE@\t$(CLOCK_GETTIME_LINK)\n @NATIVE_TRUE@ztest_alloc_SOURCES = $(ztest_SOURCES)\n @NATIVE_TRUE@ztest_alloc_CFLAGS = $(ztest_CFLAGS)\n@@ -1585,6 +1586,13 @@ btest_dwz.log: btest_dwz\n \t--log-file $$b.log --trs-file $$b.trs \\\n \t$(am__common_driver_flags) $(AM_LOG_DRIVER_FLAGS) $(LOG_DRIVER_FLAGS) -- $(LOG_COMPILE) \\\n \t\"$$tst\" $(AM_TESTS_FD_REDIRECT)\n+btest_dwz_gnudebuglink.log: btest_dwz_gnudebuglink\n+\t@p='btest_dwz_gnudebuglink'; \\\n+\tb='btest_dwz_gnudebuglink'; \\\n+\t$(am__check_pre) $(LOG_DRIVER) --test-name \"$$f\" \\\n+\t--log-file $$b.log --trs-file $$b.trs \\\n+\t$(am__common_driver_flags) $(AM_LOG_DRIVER_FLAGS) $(LOG_DRIVER_FLAGS) -- $(LOG_COMPILE) \\\n+\t\"$$tst\" $(AM_TESTS_FD_REDIRECT)\n btest_gnudebuglink.log: btest_gnudebuglink\n \t@p='btest_gnudebuglink'; \\\n \tb='btest_gnudebuglink'; \\"}, {"sha": "632477f3099d6f4bac421e56476137e882cd8e44", "filename": "libbacktrace/elf.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2Felf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c75795fa1dc29716f519ca6d1c8cccb67d0d2062/libbacktrace%2Felf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libbacktrace%2Felf.c?ref=c75795fa1dc29716f519ca6d1c8cccb67d0d2062", "patch": "@@ -3080,7 +3080,7 @@ elf_add (struct backtrace_state *state, const char *filename, int descriptor,\n \t  if (debugaltlink_view_valid)\n \t    backtrace_release_view (state, &debugaltlink_view, error_callback,\n \t\t\t\t    data);\n-\t  ret = elf_add (state, NULL, d, base_address, error_callback, data,\n+\t  ret = elf_add (state, \"\", d, base_address, error_callback, data,\n \t\t\t fileline_fn, found_sym, found_dwarf, NULL, 0, 1, NULL,\n \t\t\t 0);\n \t  if (ret < 0)"}]}