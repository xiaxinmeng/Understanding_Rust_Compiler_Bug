{"sha": "3f467ea953431aa6af12aaed6d32f476f7ace1e5", "node_id": "C_kwDOANBUbNoAKDNmNDY3ZWE5NTM0MzFhYTZhZjEyYWFlZDZkMzJmNDc2ZjdhY2UxZTU", "commit": {"author": {"name": "Bernhard Reutner-Fischer", "email": "aldot@gcc.gnu.org", "date": "2021-11-06T05:48:00Z"}, "committer": {"name": "Bernhard Reutner-Fischer", "email": "aldot@gcc.gnu.org", "date": "2022-11-17T19:40:47Z"}, "message": "c: Set the locus of the function result decl\n\ngcc/c/ChangeLog:\n\n\t* c-decl.cc (start_function): Set the result decl source\n\tlocation to the location of the typespec.", "tree": {"sha": "0be64260e8c3e15302747260c0ebad452a2d77a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0be64260e8c3e15302747260c0ebad452a2d77a8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3f467ea953431aa6af12aaed6d32f476f7ace1e5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3f467ea953431aa6af12aaed6d32f476f7ace1e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3f467ea953431aa6af12aaed6d32f476f7ace1e5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3f467ea953431aa6af12aaed6d32f476f7ace1e5/comments", "author": null, "committer": null, "parents": [{"sha": "19be89d79ee149e812ccc6027956cefb7f3e1016", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19be89d79ee149e812ccc6027956cefb7f3e1016", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19be89d79ee149e812ccc6027956cefb7f3e1016"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "098e475f65d593a4f56d687f272d6c7ea72146d4", "filename": "gcc/c/c-decl.cc", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3f467ea953431aa6af12aaed6d32f476f7ace1e5/gcc%2Fc%2Fc-decl.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3f467ea953431aa6af12aaed6d32f476f7ace1e5/gcc%2Fc%2Fc-decl.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.cc?ref=3f467ea953431aa6af12aaed6d32f476f7ace1e5", "patch": "@@ -10059,6 +10059,7 @@ start_function (struct c_declspecs *declspecs, struct c_declarator *declarator,\n   tree decl1, old_decl;\n   tree restype, resdecl;\n   location_t loc;\n+  location_t result_loc;\n \n   current_function_returns_value = 0;  /* Assume, until we see it does.  */\n   current_function_returns_null = 0;\n@@ -10285,8 +10286,11 @@ start_function (struct c_declspecs *declspecs, struct c_declarator *declarator,\n   push_scope ();\n   declare_parm_level ();\n \n+  /* Set the result decl source location to the location of the typespec.  */\n+  result_loc = (declspecs->locations[cdw_typespec] == UNKNOWN_LOCATION\n+\t\t? loc : declspecs->locations[cdw_typespec]);\n   restype = TREE_TYPE (TREE_TYPE (current_function_decl));\n-  resdecl = build_decl (loc, RESULT_DECL, NULL_TREE, restype);\n+  resdecl = build_decl (result_loc, RESULT_DECL, NULL_TREE, restype);\n   DECL_ARTIFICIAL (resdecl) = 1;\n   DECL_IGNORED_P (resdecl) = 1;\n   DECL_RESULT (current_function_decl) = resdecl;"}]}