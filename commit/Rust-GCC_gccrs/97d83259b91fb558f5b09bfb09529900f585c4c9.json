{"sha": "97d83259b91fb558f5b09bfb09529900f585c4c9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTdkODMyNTliOTFmYjU1OGY1YjA5YmZiMDk1Mjk5MDBmNTg1YzRjOQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2021-06-07T16:17:31Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2021-06-07T16:22:29Z"}, "message": "Fix old thinko in warning on pointer for storage order purposes\n\ngcc/c\n\tPR c/100920\n\t* c-typeck.c (convert_for_assignment): Test fndecl_built_in_p to\n\tspot built-in functions.\ngcc/testsuite/\n\t* gcc.dg/sso-14.c: Adjust.", "tree": {"sha": "056bbb7001ac9840e7ea501389fd4e2b580988bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/056bbb7001ac9840e7ea501389fd4e2b580988bf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/97d83259b91fb558f5b09bfb09529900f585c4c9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97d83259b91fb558f5b09bfb09529900f585c4c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97d83259b91fb558f5b09bfb09529900f585c4c9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97d83259b91fb558f5b09bfb09529900f585c4c9/comments", "author": null, "committer": null, "parents": [{"sha": "6cb35b606c39d5f21f3298c77bfbcaaef3fbc872", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6cb35b606c39d5f21f3298c77bfbcaaef3fbc872", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6cb35b606c39d5f21f3298c77bfbcaaef3fbc872"}], "stats": {"total": 9, "additions": 6, "deletions": 3}, "files": [{"sha": "845d50f3310d7d46f13cbc6bbd57ddfbbdffaa15", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97d83259b91fb558f5b09bfb09529900f585c4c9/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97d83259b91fb558f5b09bfb09529900f585c4c9/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=97d83259b91fb558f5b09bfb09529900f585c4c9", "patch": "@@ -7303,7 +7303,7 @@ convert_for_assignment (location_t location, location_t expr_loc, tree type,\n \t    /* Do not warn for built-in functions, for example memcpy, since we\n \t       control how they behave and they can be useful in this area.  */\n \t    if (TREE_CODE (rname) != FUNCTION_DECL\n-\t\t|| !DECL_IS_UNDECLARED_BUILTIN (rname))\n+\t\t|| !fndecl_built_in_p (rname))\n \t      warning_at (location, OPT_Wscalar_storage_order,\n \t\t\t  \"passing argument %d of %qE from incompatible \"\n \t\t\t  \"scalar storage order\", parmnum, rname);"}, {"sha": "8941946c3ab108aaf9f13bdd0fea41baa07d8d7a", "filename": "gcc/testsuite/gcc.dg/sso-14.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97d83259b91fb558f5b09bfb09529900f585c4c9/gcc%2Ftestsuite%2Fgcc.dg%2Fsso-14.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97d83259b91fb558f5b09bfb09529900f585c4c9/gcc%2Ftestsuite%2Fgcc.dg%2Fsso-14.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fsso-14.c?ref=97d83259b91fb558f5b09bfb09529900f585c4c9", "patch": "@@ -5,6 +5,7 @@\n \n #include <stddef.h>\n #include <stdlib.h>\n+#include <string.h>\n \n #if __BYTE_ORDER__ == __ORDER_LITTLE_ENDIAN__\n #define REV_ENDIANNESS __attribute__((scalar_storage_order(\"big-endian\")))\n@@ -42,12 +43,14 @@ int main(void)\n {\n   t_s12 *msg1 = __builtin_alloca(10);\n   t_u12 *msg2 = __builtin_alloca(10);\n+  int same;\n \n   msg1 = malloc (sizeof (t_s12));\n   msg2 = malloc (sizeof (t_u12));\n \n-  msg1->a[0].val = 0;\n-  msg2->a[0].val = 0;\n+  memset (msg1, 0, sizeof (t_s12));\n+  memcpy (msg2, &msg1, sizeof (t_s12));\n+  same = memcmp (msg1, msg2, sizeof (t_s12));\n \n   return 0;\n }"}]}