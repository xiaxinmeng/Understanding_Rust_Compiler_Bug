{"sha": "cd71491e1cc5df228efbc518502cdc373c2d7585", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2Q3MTQ5MWUxY2M1ZGYyMjhlZmJjNTE4NTAyY2RjMzczYzJkNzU4NQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-04-30T18:45:47Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-04-30T18:45:47Z"}, "message": "lto-symtab.c (lto_symtab_resolve_can_prevail_p): Chose var with varpool.\n\n\t* lto-symtab.c (lto_symtab_resolve_can_prevail_p): Chose var with varpool.\n\t(lto_symtab_merge_decls_1): Remove logic looking for an initializer.\n\nFrom-SVN: r158944", "tree": {"sha": "c8bfb3ab53ad9de726a6028c6f5e6252ae0079e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c8bfb3ab53ad9de726a6028c6f5e6252ae0079e2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cd71491e1cc5df228efbc518502cdc373c2d7585", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd71491e1cc5df228efbc518502cdc373c2d7585", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd71491e1cc5df228efbc518502cdc373c2d7585", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd71491e1cc5df228efbc518502cdc373c2d7585/comments", "author": null, "committer": null, "parents": [{"sha": "ace72c88c59513b361ce1cfffed07e14990b6bba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ace72c88c59513b361ce1cfffed07e14990b6bba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ace72c88c59513b361ce1cfffed07e14990b6bba"}], "stats": {"total": 22, "additions": 6, "deletions": 16}, "files": [{"sha": "e370a9f658c7ef4ab5e1077b80a43ffb0046c393", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd71491e1cc5df228efbc518502cdc373c2d7585/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd71491e1cc5df228efbc518502cdc373c2d7585/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cd71491e1cc5df228efbc518502cdc373c2d7585", "patch": "@@ -1,3 +1,8 @@\n+2010-04-30  Jan Hubicka  <jh@suse.cz>\n+\n+\t* lto-symtab.c (lto_symtab_resolve_can_prevail_p): Chose var with varpool.\n+\t(lto_symtab_merge_decls_1): Remove logic looking for an initializer.\n+\n 2010-04-30  Jan Hubicka  <jh@suse.cz>\n \n \t* cgraph.h (cgraph_node_set_nonempty_p, varpool_node_set_nonempty_p): New."}, {"sha": "b5430a5ab74fd59de436d88530956a329d870923", "filename": "gcc/lto-symtab.c", "status": "modified", "additions": 1, "deletions": 16, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd71491e1cc5df228efbc518502cdc373c2d7585/gcc%2Flto-symtab.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd71491e1cc5df228efbc518502cdc373c2d7585/gcc%2Flto-symtab.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-symtab.c?ref=cd71491e1cc5df228efbc518502cdc373c2d7585", "patch": "@@ -406,11 +406,7 @@ lto_symtab_resolve_can_prevail_p (lto_symtab_entry_t e)\n \n   /* A variable should have a size.  */\n   else if (TREE_CODE (e->decl) == VAR_DECL)\n-    return (DECL_SIZE (e->decl) != NULL_TREE\n-\t    /* The C++ frontend retains TREE_STATIC on the declaration\n-\t       of foo_ in struct Foo { static Foo *foo_; }; but it is\n-\t       not a definition.  g++.dg/lto/20090315_0.C.  */\n-\t    && !DECL_EXTERNAL (e->decl));\n+    return (e->vnode && e->vnode->finalized);\n \n   gcc_unreachable ();\n }\n@@ -588,17 +584,6 @@ lto_symtab_merge_decls_1 (void **slot, void *data ATTRIBUTE_UNUSED)\n \twhile (!prevailing->vnode\n \t       && prevailing->next)\n \t  prevailing = prevailing->next;\n-      /* We do not stream varpool nodes, so the first decl has to\n-\t be good enough for now.\n-\t ???  For QOI choose a variable with readonly initializer\n-\t if there is one.  This matches C++\n-\t struct Foo { static const int i = 1; }; without a real\n-\t definition.  */\n-      if (TREE_CODE (prevailing->decl) == VAR_DECL)\n-\twhile (!(TREE_READONLY (prevailing->decl)\n-\t\t && DECL_INITIAL (prevailing->decl))\n-\t       && prevailing->next)\n-\t  prevailing = prevailing->next;\n     }\n \n   /* Move it first in the list.  */"}]}