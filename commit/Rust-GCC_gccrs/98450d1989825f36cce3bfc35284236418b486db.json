{"sha": "98450d1989825f36cce3bfc35284236418b486db", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTg0NTBkMTk4OTgyNWYzNmNjZTNiZmMzNTI4NDIzNjQxOGI0ODZkYg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2019-11-19T18:57:50Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2019-11-19T18:57:50Z"}, "message": "Remove unused parameter PROB in ipa-fnsummary.c\n\n        * ipa-fnsummary.c (estimate_edge_size_and_time): Drop parameter PROB.\n\t(estimate_calls_size_and_time): Update.\n\nFrom-SVN: r278460", "tree": {"sha": "fd630b2746a7db7964377a4edcb46f708bae080d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fd630b2746a7db7964377a4edcb46f708bae080d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98450d1989825f36cce3bfc35284236418b486db", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98450d1989825f36cce3bfc35284236418b486db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98450d1989825f36cce3bfc35284236418b486db", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98450d1989825f36cce3bfc35284236418b486db/comments", "author": null, "committer": null, "parents": [{"sha": "ea8dd3b6cea2a4d4dab7e2997b88a170f8093ce6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea8dd3b6cea2a4d4dab7e2997b88a170f8093ce6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea8dd3b6cea2a4d4dab7e2997b88a170f8093ce6"}], "stats": {"total": 17, "additions": 9, "deletions": 8}, "files": [{"sha": "170486a71969a2ff3d621493c4e3c3b4cc1a9c92", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98450d1989825f36cce3bfc35284236418b486db/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98450d1989825f36cce3bfc35284236418b486db/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=98450d1989825f36cce3bfc35284236418b486db", "patch": "@@ -1,3 +1,8 @@\n+2019-11-18  Jan Hubicka  <jh@suse.cz>\n+\n+\t* ipa-fnsummary.c (estimate_edge_size_and_time): Drop parameter PROB.\n+\t(estimate_calls_size_and_time): Update.\n+\n 2019-11-18  Jan Hubicka  <jh@suse.cz>\n \n \t* ipa-inline.c (inlining_speedup): New function."}, {"sha": "a883325d7632736838be1ec182ed7b552efab5f5", "filename": "gcc/ipa-fnsummary.c", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98450d1989825f36cce3bfc35284236418b486db/gcc%2Fipa-fnsummary.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98450d1989825f36cce3bfc35284236418b486db/gcc%2Fipa-fnsummary.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-fnsummary.c?ref=98450d1989825f36cce3bfc35284236418b486db", "patch": "@@ -2950,7 +2950,6 @@ estimate_edge_devirt_benefit (struct cgraph_edge *ie,\n static inline void\n estimate_edge_size_and_time (struct cgraph_edge *e, int *size, int *min_size,\n \t\t\t     sreal *time,\n-\t\t\t     int prob,\n \t\t\t     vec<tree> known_vals,\n \t\t\t     vec<ipa_polymorphic_call_context> known_contexts,\n \t\t\t     vec<ipa_agg_value_set> known_aggs,\n@@ -2960,6 +2959,7 @@ estimate_edge_size_and_time (struct cgraph_edge *e, int *size, int *min_size,\n   int call_size = es->call_stmt_size;\n   int call_time = es->call_stmt_time;\n   int cur_size;\n+\n   if (!e->callee && hints && e->maybe_hot_p ()\n       && estimate_edge_devirt_benefit (e, &call_size, &call_time,\n \t\t\t\t       known_vals, known_contexts, known_aggs))\n@@ -2968,12 +2968,8 @@ estimate_edge_size_and_time (struct cgraph_edge *e, int *size, int *min_size,\n   *size += cur_size;\n   if (min_size)\n     *min_size += cur_size;\n-  if (!time)\n-    ;\n-  else if (prob == REG_BR_PROB_BASE)\n+  if (time)\n     *time += ((sreal)call_time) * e->sreal_frequency ();\n-  else\n-    *time += ((sreal)call_time * prob) * e->sreal_frequency ();\n }\n \n \n@@ -3019,7 +3015,7 @@ estimate_calls_size_and_time (struct cgraph_node *node, int *size,\n \t     sowe do not need to compute probabilities.  */\n \t  estimate_edge_size_and_time (e, size,\n \t\t\t\t       es->predicate ? NULL : min_size,\n-\t\t\t\t       time, REG_BR_PROB_BASE,\n+\t\t\t\t       time,\n \t\t\t\t       known_vals, known_contexts,\n \t\t\t\t       known_aggs, hints);\n \t}\n@@ -3031,7 +3027,7 @@ estimate_calls_size_and_time (struct cgraph_node *node, int *size,\n \t  || es->predicate->evaluate (possible_truths))\n \testimate_edge_size_and_time (e, size,\n \t\t\t\t     es->predicate ? NULL : min_size,\n-\t\t\t\t     time, REG_BR_PROB_BASE,\n+\t\t\t\t     time,\n \t\t\t\t     known_vals, known_contexts, known_aggs,\n \t\t\t\t     hints);\n     }"}]}