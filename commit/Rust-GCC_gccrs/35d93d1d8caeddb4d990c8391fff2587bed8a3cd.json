{"sha": "35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzVkOTNkMWQ4Y2FlZGRiNGQ5OTBjODM5MWZmZjI1ODdiZWQ4YTNjZA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2018-01-24T16:18:18Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-01-24T16:18:18Z"}, "message": "ipa-profile.c (ipa_propagate_frequency_1): Fix logic skipping calls with zero counts.\n\n\n\t* ipa-profile.c (ipa_propagate_frequency_1): Fix logic skipping calls\n\twith zero counts.\n\nFrom-SVN: r257020", "tree": {"sha": "4c2cdd81abb1e79324639c88fa340e63a6bb1a3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4c2cdd81abb1e79324639c88fa340e63a6bb1a3c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35d93d1d8caeddb4d990c8391fff2587bed8a3cd/comments", "author": null, "committer": null, "parents": [{"sha": "0976f13bee1b7d472723ce5f37930b54f119feae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0976f13bee1b7d472723ce5f37930b54f119feae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0976f13bee1b7d472723ce5f37930b54f119feae"}], "stats": {"total": 13, "additions": 8, "deletions": 5}, "files": [{"sha": "1b64db3eb371b06eabdf8f778215ba07863a12f1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35d93d1d8caeddb4d990c8391fff2587bed8a3cd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35d93d1d8caeddb4d990c8391fff2587bed8a3cd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "patch": "@@ -1,3 +1,8 @@\n+2018-01-24  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa-profile.c (ipa_propagate_frequency_1): Fix logic skipping calls\n+\twith zero counts.\n+\n 2018-01-24  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n \t* config/rs6000/rs6000.md (*call_indirect_nonlocal_sysv<mode>):"}, {"sha": "1ab838aca2ae9677cec2037c4875c2335bba1e7c", "filename": "gcc/ipa-profile.c", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35d93d1d8caeddb4d990c8391fff2587bed8a3cd/gcc%2Fipa-profile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35d93d1d8caeddb4d990c8391fff2587bed8a3cd/gcc%2Fipa-profile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-profile.c?ref=35d93d1d8caeddb4d990c8391fff2587bed8a3cd", "patch": "@@ -331,16 +331,14 @@ ipa_propagate_frequency_1 (struct cgraph_node *node, void *data)\n \t it is executed by the train run.  Transfer the function only if all\n \t callers are unlikely executed.  */\n       if (profile_info\n-\t  && edge->callee->count.initialized_p ()\n-\t  /* Thunks are not profiled.  This is more or less implementation\n-\t     bug.  */\n-\t  && !d->function_symbol->thunk.thunk_p\n+\t  && !(edge->callee->count.ipa () == profile_count::zero ())\n \t  && (edge->caller->frequency != NODE_FREQUENCY_UNLIKELY_EXECUTED\n \t      || (edge->caller->global.inlined_to\n \t\t  && edge->caller->global.inlined_to->frequency\n \t\t     != NODE_FREQUENCY_UNLIKELY_EXECUTED)))\n \t  d->maybe_unlikely_executed = false;\n-      if (edge->count.initialized_p () && !edge->count.nonzero_p ())\n+      if (edge->count.ipa ().initialized_p ()\n+\t  && !edge->count.ipa ().nonzero_p ())\n \tcontinue;\n       switch (edge->caller->frequency)\n         {"}]}