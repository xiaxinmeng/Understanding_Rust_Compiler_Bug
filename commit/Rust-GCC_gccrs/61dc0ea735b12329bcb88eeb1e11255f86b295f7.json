{"sha": "61dc0ea735b12329bcb88eeb1e11255f86b295f7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjFkYzBlYTczNWIxMjMyOWJjYjg4ZWViMWUxMTI1NWY4NmIyOTVmNw==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2012-10-29T19:36:47Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2012-10-29T19:36:47Z"}, "message": "re PR debug/54693 (VTA guality issues with loops)\n\ngcc/ChangeLog:\nPR debug/54693\n* tree-ssa-threadedge.c (thread_around_empty_block): Copy\ndebug temps from predecessor before threading.\ngcc/testsuite/ChangeLog:\nPR debug/54693\n* gcc.dg/guality/pr54693.c: New.\n\nFrom-SVN: r192961", "tree": {"sha": "e8add9a26d8368777c8713859ad9a343912fc457", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e8add9a26d8368777c8713859ad9a343912fc457"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/61dc0ea735b12329bcb88eeb1e11255f86b295f7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61dc0ea735b12329bcb88eeb1e11255f86b295f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61dc0ea735b12329bcb88eeb1e11255f86b295f7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61dc0ea735b12329bcb88eeb1e11255f86b295f7/comments", "author": null, "committer": null, "parents": [{"sha": "6119d95c67f627e95131041c5d33756d42c892a3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6119d95c67f627e95131041c5d33756d42c892a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6119d95c67f627e95131041c5d33756d42c892a3"}], "stats": {"total": 57, "additions": 57, "deletions": 0}, "files": [{"sha": "491128e1aa74fdba8da2b6f3d755576b861a9fd3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=61dc0ea735b12329bcb88eeb1e11255f86b295f7", "patch": "@@ -1,3 +1,9 @@\n+2012-10-29  Alexandre Oliva <aoliva@redhat.com>\n+\n+\tPR debug/54693\n+\t* tree-ssa-threadedge.c (thread_around_empty_block): Copy\n+\tdebug temps from predecessor before threading.\n+\n 2012-10-29  Alexandre Oliva <aoliva@redhat.com>\n \n \tPR debug/54551"}, {"sha": "c6899df3c95a8f668fbf08aa7f833b90f132f8fb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=61dc0ea735b12329bcb88eeb1e11255f86b295f7", "patch": "@@ -1,3 +1,8 @@\n+2012-10-29  Alexandre Oliva <aoliva@redhat.com>\n+\n+\tPR debug/54693\n+\t* gcc.dg/guality/pr54693.c: New.\n+\n 2012-10-29  Marc Glisse  <marc.glisse@inria.fr>\n \n \tPR middle-end/55027"}, {"sha": "adc2dfd0326253c16842203b9db0e97d7e3099ab", "filename": "gcc/testsuite/gcc.dg/guality/pr54693.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2Ftestsuite%2Fgcc.dg%2Fguality%2Fpr54693.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2Ftestsuite%2Fgcc.dg%2Fguality%2Fpr54693.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fguality%2Fpr54693.c?ref=61dc0ea735b12329bcb88eeb1e11255f86b295f7", "patch": "@@ -0,0 +1,28 @@\n+/* PR debug/54693 */\n+/* { dg-do run } */\n+/* { dg-options \"-g\" } */\n+\n+__attribute__((noinline, noclone)) void\n+foo (char *str, char c)\n+{\n+  asm volatile (\"\" : : \"r\" (str), \"r\" (c) : \"memory\");\n+  *str = c;\n+}\n+\n+int\n+main ()\n+{\n+  int i;\n+  char c;\n+  char arr[11];\n+\n+  for (i = 0; i < 10; i++)\n+    {\n+      c = 0x30 + i;\n+      foo (&arr[i], c); /* { dg-final { gdb-test 22 \"i\" \"c - 48\" } } */\n+    }\n+\n+  __builtin_printf (\"arr = %s\\n\", arr);\n+  return 0;\n+}\n+"}, {"sha": "f43a564d7862f6b30c5326f16bc5e7bc1240d9a9", "filename": "gcc/tree-ssa-threadedge.c", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2Ftree-ssa-threadedge.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/61dc0ea735b12329bcb88eeb1e11255f86b295f7/gcc%2Ftree-ssa-threadedge.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-threadedge.c?ref=61dc0ea735b12329bcb88eeb1e11255f86b295f7", "patch": "@@ -637,6 +637,24 @@ thread_around_empty_block (edge taken_edge,\n   if (!single_pred_p (bb))\n     return NULL;\n \n+  /* Before threading, copy DEBUG stmts from the predecessor, so that\n+     we don't lose the bindings as we redirect the edges.  */\n+  if (MAY_HAVE_DEBUG_STMTS)\n+    {\n+      gsi = gsi_after_labels (bb);\n+      for (gimple_stmt_iterator si = gsi_last_bb (taken_edge->src);\n+\t   !gsi_end_p (si); gsi_prev (&si))\n+\t{\n+\t  stmt = gsi_stmt (si);\n+\t  if (!is_gimple_debug (stmt))\n+\t    continue;\n+\n+\t  stmt = gimple_copy (stmt);\n+\t  /* ??? Should we drop the location of the copy?  */\n+\t  gsi_insert_before (&gsi, stmt, GSI_NEW_STMT);\n+\t}\n+    }\n+\n   /* This block must have more than one successor.  */\n   if (single_succ_p (bb))\n     return NULL;"}]}