{"sha": "ef22816c3b3f580addc60df340abda46cc6ba01c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWYyMjgxNmMzYjNmNTgwYWRkYzYwZGYzNDBhYmRhNDZjYzZiYTAxYw==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-03-27T18:42:02Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2018-03-27T18:42:02Z"}, "message": "re PR fortran/85084 (ICE: out of memory allocating 18446744073709551600 bytes ...)\n\n2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/85084\n\t* frontend-passes.c (gfc_run_passes): Do not run front-end\n\toptimizations if a previous error occurred.\n\n2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/85084\n\t* gfortran.dg/matmul_rank_1.f90: New test.\n\nFrom-SVN: r258900", "tree": {"sha": "46e1c9ecdbcac8b4255e0a12c94e413e8d0cef31", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/46e1c9ecdbcac8b4255e0a12c94e413e8d0cef31"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef22816c3b3f580addc60df340abda46cc6ba01c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef22816c3b3f580addc60df340abda46cc6ba01c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef22816c3b3f580addc60df340abda46cc6ba01c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef22816c3b3f580addc60df340abda46cc6ba01c/comments", "author": null, "committer": null, "parents": [{"sha": "13a7688fb902adb314679a2ffe64d80186632224", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13a7688fb902adb314679a2ffe64d80186632224", "html_url": "https://github.com/Rust-GCC/gccrs/commit/13a7688fb902adb314679a2ffe64d80186632224"}], "stats": {"total": 28, "additions": 24, "deletions": 4}, "files": [{"sha": "b88b27ba784981c8c7953875c3ce57912b94161e", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=ef22816c3b3f580addc60df340abda46cc6ba01c", "patch": "@@ -1,3 +1,9 @@\n+2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/85084\n+\t* frontend-passes.c (gfc_run_passes): Do not run front-end\n+\toptimizations if a previous error occurred.\n+\n 2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \tHarald Anlauf  <anlauf@gmx.de>\n "}, {"sha": "6888224cd8111169a6e1ced08d3fd53a06d09eb8", "filename": "gcc/fortran/frontend-passes.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ffortran%2Ffrontend-passes.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ffortran%2Ffrontend-passes.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ffrontend-passes.c?ref=ef22816c3b3f580addc60df340abda46cc6ba01c", "patch": "@@ -156,6 +156,10 @@ gfc_run_passes (gfc_namespace *ns)\n   check_locus (ns);\n #endif\n \n+  gfc_get_errors (&w, &e);\n+  if (e > 0)\n+    return;\n+\n   if (flag_frontend_optimize || flag_frontend_loop_interchange)\n     optimize_namespace (ns);\n \n@@ -168,10 +172,6 @@ gfc_run_passes (gfc_namespace *ns)\n       expr_array.release ();\n     }\n \n-  gfc_get_errors (&w, &e);\n-  if (e > 0)\n-   return;\n-\n   if (flag_realloc_lhs)\n     realloc_strings (ns);\n }"}, {"sha": "b8d56f8532c6f46f1f7bf70f7f0c1506ef969e85", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ef22816c3b3f580addc60df340abda46cc6ba01c", "patch": "@@ -1,3 +1,8 @@\n+2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/85084\n+\t* gfortran.dg/matmul_rank_1.f90: New test.\n+\n 2018-03-27  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \tHarald Anlauf  <anlauf@gmx.de>\n "}, {"sha": "f111b26018fd19415db2e68054a0573d34a30052", "filename": "gcc/testsuite/gfortran.dg/matmul_rank_1.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ftestsuite%2Fgfortran.dg%2Fmatmul_rank_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef22816c3b3f580addc60df340abda46cc6ba01c/gcc%2Ftestsuite%2Fgfortran.dg%2Fmatmul_rank_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fmatmul_rank_1.f90?ref=ef22816c3b3f580addc60df340abda46cc6ba01c", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+! { dg-additional-options \"-ffrontend-optimize\" }\n+! PR 85044 - used to die on allocating a negative amount of memory.\n+! Test case by Gerhard Steinmetz.\n+program p\n+   real :: a(3,3) = 1.0\n+   real :: b(33)\n+   b = matmul(a, a) ! { dg-error \"Incompatible ranks\" }\n+end"}]}