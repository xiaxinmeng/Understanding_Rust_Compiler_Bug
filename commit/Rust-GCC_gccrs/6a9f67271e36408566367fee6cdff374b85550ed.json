{"sha": "6a9f67271e36408566367fee6cdff374b85550ed", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmE5ZjY3MjcxZTM2NDA4NTY2MzY3ZmVlNmNkZmYzNzRiODU1NTBlZA==", "commit": {"author": {"name": "Matt Kraai", "email": "kraai@alumni.carnegiemellon.edu", "date": "2001-09-07T08:54:32Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2001-09-07T08:54:32Z"}, "message": "typeck.c (java_array_type_length, [...]): Represent empty arrays by NULL index.\n\n        * java/typeck.c (java_array_type_length, build_prim_array_type):\n        Represent empty arrays by NULL index.\n\n        * stor-layout.c (compute_record_mode): Check DECL_SIZE is set.\n\nFrom-SVN: r45460", "tree": {"sha": "1e788927b81a47a45083c0dbbb5b39a39a643941", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1e788927b81a47a45083c0dbbb5b39a39a643941"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6a9f67271e36408566367fee6cdff374b85550ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a9f67271e36408566367fee6cdff374b85550ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a9f67271e36408566367fee6cdff374b85550ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a9f67271e36408566367fee6cdff374b85550ed/comments", "author": null, "committer": null, "parents": [{"sha": "b5f20931962d4ef52f2ff80891a7feb74e6811be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5f20931962d4ef52f2ff80891a7feb74e6811be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5f20931962d4ef52f2ff80891a7feb74e6811be"}], "stats": {"total": 31, "additions": 25, "deletions": 6}, "files": [{"sha": "42660490415960aaf30fef4c55f2ee99dea80157", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6a9f67271e36408566367fee6cdff374b85550ed", "patch": "@@ -1,3 +1,7 @@\n+2001-09-07  Matt Kraai  <kraai@alumni.carnegiemellon.edu>\n+\n+\t* stor-layout.c (compute_record_mode): Check DECL_SIZE is set.\n+\n 2001-09-06  Ira Ruben  <ira@apple.com>\n \n \tRemove OP_IDENTIFIER."}, {"sha": "c50858777672109db1afe268f000a4c815d4e188", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=6a9f67271e36408566367fee6cdff374b85550ed", "patch": "@@ -1,3 +1,8 @@\n+2001-09-07  Matt Kraai  <kraai@alumni.carnegiemellon.edu>\n+\n+\t* typeck.c (java_array_type_length, build_prim_array_type):\n+\tRepresent empty arrays by NULL index.\n+\n 2001-09-06  Anthony Green  <green@redhat.com>\n \n \t* class.c (O_BINARY): Define if necessary."}, {"sha": "4f8a34e752e021d9322a79068c70c2c37dd39a25", "filename": "gcc/java/typeck.c", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2Fjava%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2Fjava%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Ftypeck.c?ref=6a9f67271e36408566367fee6cdff374b85550ed", "patch": "@@ -353,9 +353,12 @@ java_array_type_length (array_type)\n   if (arfld != NULL_TREE)\n     {\n       tree index_type = TYPE_DOMAIN (TREE_TYPE (arfld));\n-      tree high = TYPE_MAX_VALUE (index_type);\n-      if (TREE_CODE (high) == INTEGER_CST)\n-\treturn TREE_INT_CST_LOW (high) + 1;\n+      if (index_type != NULL_TREE)\n+\t{\n+\t  tree high = TYPE_MAX_VALUE (index_type);\n+\t  if (TREE_CODE (high) == INTEGER_CST)\n+\t    return TREE_INT_CST_LOW (high) + 1;\n+\t}\n     }\n   return -1;\n }\n@@ -370,9 +373,15 @@ build_prim_array_type (element_type, length)\n      tree element_type;\n      HOST_WIDE_INT length;\n {\n-  tree max_index = build_int_2 (length - 1, (0 == length ? -1 : 0));\n-  TREE_TYPE (max_index) = sizetype;\n-  return build_array_type (element_type, build_index_type (max_index));\n+  tree index = NULL;\n+\n+  if (length != -1)\n+    {\n+      tree max_index = build_int_2 (length - 1, (0 == length ? -1 : 0));\n+      TREE_TYPE (max_index) = sizetype;\n+      index = build_index_type (max_index);\n+    }\n+  return build_array_type (element_type, index);\n }\n \n /* Return a Java array type with a given ELEMENT_TYPE and LENGTH."}, {"sha": "e145b97e5d6f14005bbf80f2bf6ab83af08b58f9", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a9f67271e36408566367fee6cdff374b85550ed/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=6a9f67271e36408566367fee6cdff374b85550ed", "patch": "@@ -1110,6 +1110,7 @@ compute_record_mode (type)\n \t  || (TYPE_MODE (TREE_TYPE (field)) == BLKmode\n \t      && ! TYPE_NO_FORCE_BLK (TREE_TYPE (field)))\n \t  || ! host_integerp (bit_position (field), 1)\n+\t  || DECL_SIZE (field) == 0\n \t  || ! host_integerp (DECL_SIZE (field), 1))\n \treturn;\n "}]}