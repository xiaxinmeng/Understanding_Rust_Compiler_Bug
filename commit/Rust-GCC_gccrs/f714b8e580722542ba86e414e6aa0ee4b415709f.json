{"sha": "f714b8e580722542ba86e414e6aa0ee4b415709f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjcxNGI4ZTU4MDcyMjU0MmJhODZlNDE0ZTZhYTBlZTRiNDE1NzA5Zg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-23T02:28:23Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-06-23T02:28:23Z"}, "message": "(finish_struct): A data member with the same name as the class doesn't suppress constructors.\n\n(finish_struct): A data member with the same name as the class doesn't\nsuppress constructors.\n(dont_allow_type_definitions): New variable set when types cannot be defined.\n(finish_struct): Use it.\n(build_vfn_ref): Deleted signature specific code, we don't call this function\nanymore from build_signature_method_call.\n\nFrom-SVN: r10038", "tree": {"sha": "a1cd507e21d45954e2308119870ea972899742bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a1cd507e21d45954e2308119870ea972899742bc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f714b8e580722542ba86e414e6aa0ee4b415709f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f714b8e580722542ba86e414e6aa0ee4b415709f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f714b8e580722542ba86e414e6aa0ee4b415709f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f714b8e580722542ba86e414e6aa0ee4b415709f/comments", "author": null, "committer": null, "parents": [{"sha": "1743ca29c36c08b7cd482adbd1979e3da58a3082", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1743ca29c36c08b7cd482adbd1979e3da58a3082", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1743ca29c36c08b7cd482adbd1979e3da58a3082"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "9a373c3c2c729e9e35b4c010813e1f6eaf53010e", "filename": "gcc/cp/class.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f714b8e580722542ba86e414e6aa0ee4b415709f/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f714b8e580722542ba86e414e6aa0ee4b415709f/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=f714b8e580722542ba86e414e6aa0ee4b415709f", "patch": "@@ -91,6 +91,8 @@ int current_lang_stacksize;\n tree lang_name_c, lang_name_cplusplus;\n tree current_lang_name;\n \n+char *dont_allow_type_definitions;\n+\n /* When layout out an aggregate type, the size of the\n    basetypes (virtual and non-virtual) is passed to layout_record\n    via this node.  */\n@@ -466,8 +468,6 @@ build_vfn_ref (ptr_to_instptr, instance, idx)\n \t}\n \n       if (IS_AGGR_TYPE (TREE_TYPE (instance))\n-\t  && !IS_SIGNATURE_POINTER (TREE_TYPE (instance))\n-\t  && !IS_SIGNATURE_REFERENCE (TREE_TYPE (instance))\n \t  && (TREE_CODE (instance) == RESULT_DECL\n \t      || TREE_CODE (instance) == PARM_DECL\n \t      || TREE_CODE (instance) == VAR_DECL))\n@@ -2783,6 +2783,12 @@ finish_struct (t, list_of_fieldlists, warn_anon)\n       return t;\n     }\n \n+  if (dont_allow_type_definitions)\n+    {\n+      pedwarn (\"types cannot be defined %s\",\n+\t       dont_allow_type_definitions);\n+    }\n+\n   /* Append the fields we need for constructing signature tables.  */\n   if (IS_SIGNATURE (t))\n     append_signature_fields (list_of_fieldlists);\n@@ -3038,8 +3044,10 @@ finish_struct (t, list_of_fieldlists, warn_anon)\n \t      TREE_TYPE (x) = build_pointer_type (TREE_TYPE (x));\n \t    }\n \n+#if 0\n \t  if (DECL_NAME (x) == constructor_name (t))\n \t    cant_have_default_ctor = cant_synth_copy_ctor = 1;\n+#endif\n \n \t  if (TREE_TYPE (x) == error_mark_node)\n \t    continue;"}]}