{"sha": "be197ade2e5fb42606339080b08e885824fb9644", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmUxOTdhZGUyZTVmYjQyNjA2MzM5MDgwYjA4ZTg4NTgyNGZiOTY0NA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-01-31T16:07:06Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-01-31T16:07:06Z"}, "message": "re PR c++/84092 (ICE on C++14 code with variable template: in build_qualified_name, at cp/tree.c:2043)\n\n/cp\n2018-01-31  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/84092\n\t* semantics.c (finish_qualified_id_expr): When handling an\n\tUNBOUND_CLASS_TEMPLATE only adjust qualifying_class and expr.\n\n/testsuite\n2018-01-31  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/84092\n\t* g++.dg/cpp1y/var-templ57.C: New.\n\nFrom-SVN: r257242", "tree": {"sha": "0ac357c9bc904583891f081050ee4742f41b593e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0ac357c9bc904583891f081050ee4742f41b593e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/be197ade2e5fb42606339080b08e885824fb9644", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be197ade2e5fb42606339080b08e885824fb9644", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be197ade2e5fb42606339080b08e885824fb9644", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be197ade2e5fb42606339080b08e885824fb9644/comments", "author": null, "committer": null, "parents": [{"sha": "4ecd9c156cb6a4d67d59563b73cccfd0d5045a50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ecd9c156cb6a4d67d59563b73cccfd0d5045a50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ecd9c156cb6a4d67d59563b73cccfd0d5045a50"}], "stats": {"total": 27, "additions": 21, "deletions": 6}, "files": [{"sha": "ee06ba61546bd1f8043a34d43f3656bed18d05df", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=be197ade2e5fb42606339080b08e885824fb9644", "patch": "@@ -1,3 +1,9 @@\n+2018-01-31  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/84092\n+\t* semantics.c (finish_qualified_id_expr): When handling an\n+\tUNBOUND_CLASS_TEMPLATE only adjust qualifying_class and expr.\n+\n 2018-01-31  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/84138"}, {"sha": "76160345882ed64321d3becf7fbd0c05b34e5b42", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=be197ade2e5fb42606339080b08e885824fb9644", "patch": "@@ -2001,12 +2001,12 @@ finish_qualified_id_expr (tree qualifying_class,\n   if (template_p)\n     {\n       if (TREE_CODE (expr) == UNBOUND_CLASS_TEMPLATE)\n-\t/* cp_parser_lookup_name thought we were looking for a type,\n-\t   but we're actually looking for a declaration.  */\n-\texpr = build_qualified_name (/*type*/NULL_TREE,\n-\t\t\t\t     TYPE_CONTEXT (expr),\n-\t\t\t\t     TYPE_IDENTIFIER (expr),\n-\t\t\t\t     /*template_p*/true);\n+\t{\n+\t  /* cp_parser_lookup_name thought we were looking for a type,\n+\t     but we're actually looking for a declaration.  */\n+\t  qualifying_class = TYPE_CONTEXT (expr);\n+\t  expr = TYPE_IDENTIFIER (expr);\n+\t}\n       else\n \tcheck_template_keyword (expr);\n     }"}, {"sha": "60756dab0eadeb518ed6838132219e2621fc6f40", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=be197ade2e5fb42606339080b08e885824fb9644", "patch": "@@ -1,3 +1,8 @@\n+2018-01-31  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/84092\n+\t* g++.dg/cpp1y/var-templ57.C: New.\n+\n 2018-01-31  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/84138"}, {"sha": "030e9a2dfd620b7b61cbf398d652b5f4cf7d6bc2", "filename": "gcc/testsuite/g++.dg/cpp1y/var-templ57.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fvar-templ57.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be197ade2e5fb42606339080b08e885824fb9644/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fvar-templ57.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fvar-templ57.C?ref=be197ade2e5fb42606339080b08e885824fb9644", "patch": "@@ -0,0 +1,4 @@\n+// PR c++/84092\n+// { dg-do compile { target c++14 } }\n+\n+template < typename T > int a (T::template b);"}]}