{"sha": "db0d4b71b579a9ce556bb19948ce4c847cc6c129", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGIwZDRiNzFiNTc5YTljZTU1NmJiMTk5NDhjZTRjODQ3Y2M2YzEyOQ==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2010-10-06T17:01:11Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2010-10-06T17:01:11Z"}, "message": "re PR libstdc++/45863 (FAIL: libstdc++-abi/abi_check)\n\n\tPR libstdc++/45863\n\t* scripts/extract_symvers: Restore revision 164879.\n\tOnly use pvs on SunOS.\n\nFrom-SVN: r165055", "tree": {"sha": "556301b056c334c950e38229f995ac83a40781fd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/556301b056c334c950e38229f995ac83a40781fd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/db0d4b71b579a9ce556bb19948ce4c847cc6c129", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db0d4b71b579a9ce556bb19948ce4c847cc6c129", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db0d4b71b579a9ce556bb19948ce4c847cc6c129", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db0d4b71b579a9ce556bb19948ce4c847cc6c129/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d213e92e53c40f0ab53a6813c9284814f54c58c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d213e92e53c40f0ab53a6813c9284814f54c58c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d213e92e53c40f0ab53a6813c9284814f54c58c9"}], "stats": {"total": 87, "additions": 68, "deletions": 19}, "files": [{"sha": "0f3c85352858f6d85fa0067c5fffd072ecb91a71", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db0d4b71b579a9ce556bb19948ce4c847cc6c129/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db0d4b71b579a9ce556bb19948ce4c847cc6c129/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=db0d4b71b579a9ce556bb19948ce4c847cc6c129", "patch": "@@ -1,3 +1,9 @@\n+2010-10-06  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\tPR libstdc++/45863\n+\t* scripts/extract_symvers: Restore revision 164879.\n+\tOnly use pvs on SunOS.\n+\n 2010-10-05  David Krauss  <potswa@mac.com>\n \n \tPR libstdc++/45841"}, {"sha": "7510233d62621c8bf7e30d88e251d551b452fdf2", "filename": "libstdc++-v3/scripts/extract_symvers", "status": "modified", "additions": 62, "deletions": 19, "changes": 81, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db0d4b71b579a9ce556bb19948ce4c847cc6c129/libstdc%2B%2B-v3%2Fscripts%2Fextract_symvers", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db0d4b71b579a9ce556bb19948ce4c847cc6c129/libstdc%2B%2B-v3%2Fscripts%2Fextract_symvers", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fscripts%2Fextract_symvers?ref=db0d4b71b579a9ce556bb19948ce4c847cc6c129", "patch": "@@ -1,6 +1,6 @@\n #!/bin/sh\n \n-# Copyright (C) 2002, 2003, 2009 Free Software Foundation, Inc.\n+# Copyright (C) 2002, 2003, 2009, 2010 Free Software Foundation, Inc.\n #\n # This file is part of the GNU ISO C++ Library.  This library is free\n # software; you can redistribute it and/or modify it under the\n@@ -26,14 +26,6 @@ fi\n lib=$1\n output=$2\n \n-# GNU binutils, somewhere after version 2.11.2, requires -W/--wide to avoid\n-# default line truncation.  -W is not supported and truncation did not occur\n-# by default before that point.\n-readelf=\"readelf --symbols\"\n-if readelf --help | grep -- --wide > /dev/null; then\n-    readelf=\"$readelf --wide\"\n-fi\n-\n # This avoids weird sorting problems later.\n LC_ALL=C\n export LC_ALL\n@@ -42,16 +34,67 @@ export LANG\n \n tmp=extract.$$\n \n-${readelf} ${lib} |\\\n-sed -e 's/ \\[<other>: [A-Fa-f0-9]*\\] //' -e '/\\.dynsym/,/^$/p;d' |\\\n-egrep -v ' (LOCAL|UND) ' |\\\n-awk '{ if ($4 == \"FUNC\" || $4 == \"NOTYPE\")\n-         printf \"%s:%s\\n\", $4, $8;\n-       else if ($4 == \"OBJECT\" || $4 == \"TLS\")\n-         printf \"%s:%s:%s\\n\", $4, $3, $8;\n-     }' | sort | uniq > $tmp 2>&1\n-#       else printf \"Huh?  What is %s?\\n\", $8;\n-\n+case `uname -s` in\n+SunOS)\n+  # Sun ld doesn't record symbol versions in .dynsym entries and they\n+  # cannot easily be extracted from readelf --versions output, so use pvs\n+  # instead.  Linux may have a completely different pvs from LVM2, so only\n+  # do this on SunOS.\n+  # Need to use nawk on Solaris 2 since Solaris 8/9 awk (oawk) cannot handle\n+  # sub.\n+  pvs -dsvo ${lib} | \\\n+  nawk '# Remove colon separator from version field, trailing semicolon.\n+\t{\n+\t  sub (/:$/, \"\", $3);\n+\t  sub (/;$/, \"\");\n+\t}\n+\t# Record base version.  The [BASE] field was only added in Solaris 11,\n+\t# so simply use the first record instead.\n+\tNR == 1 {\n+\t  basever = $3;\n+\t  next;\n+\t}\n+\t# Ignore version dependencies.\n+\t$4 ~ /\\{.*\\}/ {\n+\t  next;\n+\t}\n+\tNF == 4 {\n+\t  if ($3 == $4 || $3 == basever)\n+\t    # Emit versions or symbols bound to base versions as objects.\n+\t    printf \"OBJECT:0:%s\\n\", $4;\n+\t  else\n+\t    # Everything else without a size field is a function.\n+\t    printf \"FUNC:%s@@%s\\n\", $4, $3;\n+\t  next;\n+\t}\n+\t# Emit objects.\n+\tNF == 5 {\n+\t  # Strip parens from object size.\n+\t  sub (/^\\(/, \"\", $5);\n+\t  sub (/\\)$/, \"\", $5);\n+\t  printf \"OBJECT:%s:%s@@%s\\n\", $5, $4, $3;\n+\t  next;\n+\t}' | sort | uniq > $tmp 2>&1\n+  ;;\n+*)\n+  # GNU binutils, somewhere after version 2.11.2, requires -W/--wide to\n+  # avoid default line truncation.  -W is not supported and truncation did\n+  # not occur by default before that point.\n+  readelf=\"readelf --symbols\"\n+  if readelf --help | grep -- --wide > /dev/null; then\n+    readelf=\"$readelf --wide\"\n+  fi\n+  ${readelf} ${lib} |\\\n+  sed -e 's/ \\[<other>: [A-Fa-f0-9]*\\] //' -e '/\\.dynsym/,/^$/p;d' |\\\n+  egrep -v ' (LOCAL|UND) ' |\\\n+  awk '{ if ($4 == \"FUNC\" || $4 == \"NOTYPE\")\n+           printf \"%s:%s\\n\", $4, $8;\n+         else if ($4 == \"OBJECT\" || $4 == \"TLS\")\n+           printf \"%s:%s:%s\\n\", $4, $3, $8;\n+       }' | sort | uniq > $tmp 2>&1\n+#        else printf \"Huh?  What is %s?\\n\", $8;\n+  ;;\n+esac\n \n # I think we'll be doing some more with this file, but for now, dump.\n mv $tmp $output"}]}