{"sha": "049bc4044531a146d278dd63ff0ad226c239424c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDQ5YmM0MDQ0NTMxYTE0NmQyNzhkZDYzZmYwYWQyMjZjMjM5NDI0Yw==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2004-10-01T03:46:39Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2004-10-01T03:46:39Z"}, "message": "re PR libobjc/16448 (FAIL: objc/execute/IMP.m compilation,  -O0)\n\n2004-09-16  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR libobjc/16448\n        * exception.c: Include config.h\n        (objc_exception_throw): Change _GLIBCXX_SJLJ_EXCEPTIONS to\n        SJLJ_EXCEPTIONS.\n        * configure.ac: Find out what exception handling code we use.\n        * configure: Regenerate.\n        * config.h.in: New file, regenerate.\n\nFrom-SVN: r88379", "tree": {"sha": "3e3bcca19e5054e4df68cedcfb17b544f287f58d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3e3bcca19e5054e4df68cedcfb17b544f287f58d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/049bc4044531a146d278dd63ff0ad226c239424c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/049bc4044531a146d278dd63ff0ad226c239424c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/049bc4044531a146d278dd63ff0ad226c239424c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/049bc4044531a146d278dd63ff0ad226c239424c/comments", "author": null, "committer": null, "parents": [{"sha": "bd042dbb63f5c616041474fcbc268598dfb6d5e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd042dbb63f5c616041474fcbc268598dfb6d5e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd042dbb63f5c616041474fcbc268598dfb6d5e5"}], "stats": {"total": 510, "additions": 457, "deletions": 53}, "files": [{"sha": "3c8017a47675ee89489c882ccd0bb05fe447924a", "filename": "libobjc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2FChangeLog?ref=049bc4044531a146d278dd63ff0ad226c239424c", "patch": "@@ -1,3 +1,13 @@\n+2004-09-16  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR libobjc/16448\n+\t* exception.c: Include config.h\n+\t(objc_exception_throw): Change _GLIBCXX_SJLJ_EXCEPTIONS to\n+\tSJLJ_EXCEPTIONS.\n+\t* configure.ac: Find out what exception handling code we use.\n+\t* configure: Regenerate.\n+\t* config.h.in: New file, regenerate.\n+\n 2004-09-16  Andrew Pinski  <apinski@apple.com>\n \n \t* encoding.c (ALTIVEC_VECTOR_MODE): Define a bogus macro."}, {"sha": "83b195cd10119aa9d6d74f96a2336987af6f8f2b", "filename": "libobjc/config.h.in", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2Fconfig.h.in?ref=049bc4044531a146d278dd63ff0ad226c239424c", "patch": "@@ -0,0 +1,52 @@\n+/* config.h.in.  Generated from configure.ac by autoheader.  */\n+\n+/* Define to 1 if you have the <inttypes.h> header file. */\n+#undef HAVE_INTTYPES_H\n+\n+/* Define to 1 if you have the <memory.h> header file. */\n+#undef HAVE_MEMORY_H\n+\n+/* Define to 1 if you have the <sched.h> header file. */\n+#undef HAVE_SCHED_H\n+\n+/* Define to 1 if you have the <stdint.h> header file. */\n+#undef HAVE_STDINT_H\n+\n+/* Define to 1 if you have the <stdlib.h> header file. */\n+#undef HAVE_STDLIB_H\n+\n+/* Define to 1 if you have the <strings.h> header file. */\n+#undef HAVE_STRINGS_H\n+\n+/* Define to 1 if you have the <string.h> header file. */\n+#undef HAVE_STRING_H\n+\n+/* Define to 1 if you have the <sys/stat.h> header file. */\n+#undef HAVE_SYS_STAT_H\n+\n+/* Define to 1 if you have the <sys/types.h> header file. */\n+#undef HAVE_SYS_TYPES_H\n+\n+/* Define to 1 if you have the <unistd.h> header file. */\n+#undef HAVE_UNISTD_H\n+\n+/* Define to the address where bug reports for this package should be sent. */\n+#undef PACKAGE_BUGREPORT\n+\n+/* Define to the full name of this package. */\n+#undef PACKAGE_NAME\n+\n+/* Define to the full name and version of this package. */\n+#undef PACKAGE_STRING\n+\n+/* Define to the one symbol short name of this package. */\n+#undef PACKAGE_TARNAME\n+\n+/* Define to the version of this package. */\n+#undef PACKAGE_VERSION\n+\n+/* Define if the compiler is configured for setjmp/longjmp exceptions. */\n+#undef SJLJ_EXCEPTIONS\n+\n+/* Define to 1 if you have the ANSI C header files. */\n+#undef STDC_HEADERS"}, {"sha": "6a440186d8490d650a29be593a0cb3dc533f8805", "filename": "libobjc/configure", "status": "modified", "additions": 337, "deletions": 52, "changes": 389, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2Fconfigure?ref=049bc4044531a146d278dd63ff0ad226c239424c", "patch": "@@ -843,6 +843,8 @@ Optional Features:\n   --enable-static=PKGS  build static libraries default=yes\n   --enable-fast-install=PKGS  optimize for fast installation default=yes\n   --disable-libtool-lock  avoid locking (might break parallel builds)\n+  --enable-sjlj-exceptions\n+                          force use of builtin_setjmp for exceptions\n \n Optional Packages:\n   --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]\n@@ -953,7 +955,7 @@ esac\n     else\n       echo \"$as_me: WARNING: no configuration information is in $ac_dir\" >&2\n     fi\n-    cd \"$ac_popdir\"\n+    cd $ac_popdir\n   done\n fi\n \n@@ -1536,6 +1538,7 @@ esac\n \n \n \n+\n # Export source directory.\n # These need to be absolute paths, yet at the same time need to\n # canonicalize only relative paths, because then amd will not unmount\n@@ -1596,6 +1599,9 @@ esac\n \n \n \n+          ac_config_headers=\"$ac_config_headers config.h\"\n+\n+\n # --------\n # Programs\n # --------\n@@ -2209,7 +2215,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2267,7 +2274,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2383,7 +2391,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2437,7 +2446,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2482,7 +2492,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2526,7 +2537,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3632,7 +3644,7 @@ test x\"$pic_mode\" = xno && libtool_flags=\"$libtool_flags --prefer-non-pic\"\n case $host in\n *-*-irix6*)\n   # Find out which ABI we are using.\n-  echo '#line 3635 \"configure\"' > conftest.$ac_ext\n+  echo '#line 3647 \"configure\"' > conftest.$ac_ext\n   if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   (eval $ac_compile) 2>&5\n   ac_status=$?\n@@ -3779,7 +3791,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4241,7 +4254,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4411,7 +4425,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4474,7 +4489,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4631,7 +4647,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4798,7 +4815,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4940,6 +4958,75 @@ echo \"${ECHO_T}$objc_cv_gthread_flags\" >&6\n GTHREAD_FLAGS=$objc_cv_gthread_flags\n \n \n+echo \"$as_me:$LINENO: checking for exception model to use\" >&5\n+echo $ECHO_N \"checking for exception model to use... $ECHO_C\" >&6\n+ac_ext=c\n+ac_cpp='$CPP $CPPFLAGS'\n+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_c_compiler_gnu\n+\n+# Check whether --enable-sjlj-exceptions or --disable-sjlj-exceptions was given.\n+if test \"${enable_sjlj_exceptions+set}\" = set; then\n+  enableval=\"$enable_sjlj_exceptions\"\n+  :\n+else\n+  cat > conftest.$ac_ext << EOF\n+#line 4975 \"configure\"\n+@interface Frob\n+@end\n+@implementation Frob\n+@end\n+int proc();\n+int foo()\n+{\n+  @try {\n+   return proc();\n+  }\n+  @catch (Frob* ex) {\n+    return 0;\n+  }\n+}\n+EOF\n+old_CFLAGS=\"$CFLAGS\"\n+CFLAGS=\"-x objective-c -fgnu-runtime -fobjc-exceptions -S\"\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; then\n+  if grep _Unwind_SjLj_Resume conftest.s >/dev/null 2>&1 ; then\n+    enable_sjlj_exceptions=yes\n+  elif grep _Unwind_Resume conftest.s >/dev/null 2>&1 ; then\n+    enable_sjlj_exceptions=no\n+  fi\n+fi\n+CFLAGS=\"$old_CFLAGS\"\n+rm -f conftest*\n+fi;\n+if test x$enable_sjlj_exceptions = xyes; then\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define SJLJ_EXCEPTIONS 1\n+_ACEOF\n+\n+  ac_exception_model_name=sjlj\n+elif test x$enable_sjlj_exceptions = xno; then\n+  ac_exception_model_name=\"call frame\"\n+else\n+  { { echo \"$as_me:$LINENO: error: unable to detect exception model\" >&5\n+echo \"$as_me: error: unable to detect exception model\" >&2;}\n+   { (exit 1); exit 1; }; }\n+fi\n+ac_ext=c\n+ac_cpp='$CPP $CPPFLAGS'\n+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'\n+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'\n+ac_compiler_gnu=$ac_cv_c_compiler_gnu\n+\n+echo \"$as_me:$LINENO: result: $ac_exception_model_name\" >&5\n+echo \"${ECHO_T}$ac_exception_model_name\" >&6\n+\n # ------\n # Output\n # ------\n@@ -5024,38 +5111,7 @@ s/^[^=]*=[\t ]*$//;\n }'\n fi\n \n-# Transform confdefs.h into DEFS.\n-# Protect against shell expansion while executing Makefile rules.\n-# Protect against Makefile macro expansion.\n-#\n-# If the first sed substitution is executed (which looks for macros that\n-# take arguments), then we branch to the quote section.  Otherwise,\n-# look for a macro that doesn't take arguments.\n-cat >confdef2opt.sed <<\\_ACEOF\n-t clear\n-: clear\n-s,^[\t ]*#[\t ]*define[\t ][\t ]*\\([^\t (][^\t (]*([^)]*)\\)[\t ]*\\(.*\\),-D\\1=\\2,g\n-t quote\n-s,^[\t ]*#[\t ]*define[\t ][\t ]*\\([^\t ][^\t ]*\\)[\t ]*\\(.*\\),-D\\1=\\2,g\n-t quote\n-d\n-: quote\n-s,[\t `~#$^&*(){}\\\\|;'\"<>?],\\\\&,g\n-s,\\[,\\\\&,g\n-s,\\],\\\\&,g\n-s,\\$,$$,g\n-p\n-_ACEOF\n-# We use echo to avoid assuming a particular line-breaking character.\n-# The extra dot is to prevent the shell from consuming trailing\n-# line-breaks from the sub-command output.  A line-break within\n-# single-quotes doesn't work because, if this script is created in a\n-# platform that uses two characters for line-breaks (e.g., DOS), tr\n-# would break.\n-ac_LF_and_DOT=`echo; echo .`\n-DEFS=`sed -n -f confdef2opt.sed confdefs.h | tr \"$ac_LF_and_DOT\" ' .'`\n-rm -f confdef2opt.sed\n-\n+DEFS=-DHAVE_CONFIG_H\n \n ac_libobjs=\n ac_ltlibobjs=\n@@ -5389,10 +5445,15 @@ Usage: $0 [OPTIONS] [FILE]...\n       --recheck    update $as_me by reconfiguring in the same conditions\n   --file=FILE[:TEMPLATE]\n \t\t   instantiate the configuration file FILE\n+  --header=FILE[:TEMPLATE]\n+\t\t   instantiate the configuration header FILE\n \n Configuration files:\n $config_files\n \n+Configuration headers:\n+$config_headers\n+\n Configuration commands:\n $config_commands\n \n@@ -5522,6 +5583,7 @@ do\n   # Handling of arguments.\n   \"Makefile\" ) CONFIG_FILES=\"$CONFIG_FILES Makefile\" ;;\n   \"default\" ) CONFIG_COMMANDS=\"$CONFIG_COMMANDS default\" ;;\n+  \"config.h\" ) CONFIG_HEADERS=\"$CONFIG_HEADERS config.h\" ;;\n   *) { { echo \"$as_me:$LINENO: error: invalid argument: $ac_config_target\" >&5\n echo \"$as_me: error: invalid argument: $ac_config_target\" >&2;}\n    { (exit 1); exit 1; }; };;\n@@ -5534,6 +5596,7 @@ done\n # bizarre bug on SunOS 4.1.3.\n if $ac_need_defaults; then\n   test \"${CONFIG_FILES+set}\" = set || CONFIG_FILES=$config_files\n+  test \"${CONFIG_HEADERS+set}\" = set || CONFIG_HEADERS=$config_headers\n   test \"${CONFIG_COMMANDS+set}\" = set || CONFIG_COMMANDS=$config_commands\n fi\n \n@@ -5819,6 +5882,11 @@ esac\n   *) ac_INSTALL=$ac_top_builddir$INSTALL ;;\n   esac\n \n+  if test x\"$ac_file\" != x-; then\n+    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n+echo \"$as_me: creating $ac_file\" >&6;}\n+    rm -f \"$ac_file\"\n+  fi\n   # Let's still pretend it is `configure' which instantiates (i.e., don't\n   # use $as_me), people would be surprised to read:\n   #    /* config.h.  Generated by config.status.  */\n@@ -5857,12 +5925,6 @@ echo \"$as_me: error: cannot find input file: $f\" >&2;}\n \t fi;;\n       esac\n     done` || { (exit 1); exit 1; }\n-\n-  if test x\"$ac_file\" != x-; then\n-    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n-echo \"$as_me: creating $ac_file\" >&6;}\n-    rm -f \"$ac_file\"\n-  fi\n _ACEOF\n cat >>$CONFIG_STATUS <<_ACEOF\n   sed \"$ac_vpsub\n@@ -5894,6 +5956,229 @@ done\n _ACEOF\n cat >>$CONFIG_STATUS <<\\_ACEOF\n \n+#\n+# CONFIG_HEADER section.\n+#\n+\n+# These sed commands are passed to sed as \"A NAME B NAME C VALUE D\", where\n+# NAME is the cpp macro being defined and VALUE is the value it is being given.\n+#\n+# ac_d sets the value in \"#define NAME VALUE\" lines.\n+ac_dA='s,^\\([\t ]*\\)#\\([\t ]*define[\t ][\t ]*\\)'\n+ac_dB='[\t ].*$,\\1#\\2'\n+ac_dC=' '\n+ac_dD=',;t'\n+# ac_u turns \"#undef NAME\" without trailing blanks into \"#define NAME VALUE\".\n+ac_uA='s,^\\([\t ]*\\)#\\([\t ]*\\)undef\\([\t ][\t ]*\\)'\n+ac_uB='$,\\1#\\2define\\3'\n+ac_uC=' '\n+ac_uD=',;t'\n+\n+for ac_file in : $CONFIG_HEADERS; do test \"x$ac_file\" = x: && continue\n+  # Support \"outfile[:infile[:infile...]]\", defaulting infile=\"outfile.in\".\n+  case $ac_file in\n+  - | *:- | *:-:* ) # input from stdin\n+\tcat >$tmp/stdin\n+\tac_file_in=`echo \"$ac_file\" | sed 's,[^:]*:,,'`\n+\tac_file=`echo \"$ac_file\" | sed 's,:.*,,'` ;;\n+  *:* ) ac_file_in=`echo \"$ac_file\" | sed 's,[^:]*:,,'`\n+\tac_file=`echo \"$ac_file\" | sed 's,:.*,,'` ;;\n+  * )   ac_file_in=$ac_file.in ;;\n+  esac\n+\n+  test x\"$ac_file\" != x- && { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n+echo \"$as_me: creating $ac_file\" >&6;}\n+\n+  # First look for the input files in the build tree, otherwise in the\n+  # src tree.\n+  ac_file_inputs=`IFS=:\n+    for f in $ac_file_in; do\n+      case $f in\n+      -) echo $tmp/stdin ;;\n+      [\\\\/$]*)\n+\t # Absolute (can't be DOS-style, as IFS=:)\n+\t test -f \"$f\" || { { echo \"$as_me:$LINENO: error: cannot find input file: $f\" >&5\n+echo \"$as_me: error: cannot find input file: $f\" >&2;}\n+   { (exit 1); exit 1; }; }\n+\t # Do quote $f, to prevent DOS paths from being IFS'd.\n+\t echo \"$f\";;\n+      *) # Relative\n+\t if test -f \"$f\"; then\n+\t   # Build tree\n+\t   echo \"$f\"\n+\t elif test -f \"$srcdir/$f\"; then\n+\t   # Source tree\n+\t   echo \"$srcdir/$f\"\n+\t else\n+\t   # /dev/null tree\n+\t   { { echo \"$as_me:$LINENO: error: cannot find input file: $f\" >&5\n+echo \"$as_me: error: cannot find input file: $f\" >&2;}\n+   { (exit 1); exit 1; }; }\n+\t fi;;\n+      esac\n+    done` || { (exit 1); exit 1; }\n+  # Remove the trailing spaces.\n+  sed 's/[\t ]*$//' $ac_file_inputs >$tmp/in\n+\n+_ACEOF\n+\n+# Transform confdefs.h into two sed scripts, `conftest.defines' and\n+# `conftest.undefs', that substitutes the proper values into\n+# config.h.in to produce config.h.  The first handles `#define'\n+# templates, and the second `#undef' templates.\n+# And first: Protect against being on the right side of a sed subst in\n+# config.status.  Protect against being in an unquoted here document\n+# in config.status.\n+rm -f conftest.defines conftest.undefs\n+# Using a here document instead of a string reduces the quoting nightmare.\n+# Putting comments in sed scripts is not portable.\n+#\n+# `end' is used to avoid that the second main sed command (meant for\n+# 0-ary CPP macros) applies to n-ary macro definitions.\n+# See the Autoconf documentation for `clear'.\n+cat >confdef2sed.sed <<\\_ACEOF\n+s/[\\\\&,]/\\\\&/g\n+s,[\\\\$`],\\\\&,g\n+t clear\n+: clear\n+s,^[\t ]*#[\t ]*define[\t ][\t ]*\\([^\t (][^\t (]*\\)\\(([^)]*)\\)[\t ]*\\(.*\\)$,${ac_dA}\\1${ac_dB}\\1\\2${ac_dC}\\3${ac_dD},gp\n+t end\n+s,^[\t ]*#[\t ]*define[\t ][\t ]*\\([^\t ][^\t ]*\\)[\t ]*\\(.*\\)$,${ac_dA}\\1${ac_dB}\\1${ac_dC}\\2${ac_dD},gp\n+: end\n+_ACEOF\n+# If some macros were called several times there might be several times\n+# the same #defines, which is useless.  Nevertheless, we may not want to\n+# sort them, since we want the *last* AC-DEFINE to be honored.\n+uniq confdefs.h | sed -n -f confdef2sed.sed >conftest.defines\n+sed 's/ac_d/ac_u/g' conftest.defines >conftest.undefs\n+rm -f confdef2sed.sed\n+\n+# This sed command replaces #undef with comments.  This is necessary, for\n+# example, in the case of _POSIX_SOURCE, which is predefined and required\n+# on some systems where configure will not decide to define it.\n+cat >>conftest.undefs <<\\_ACEOF\n+s,^[\t ]*#[\t ]*undef[\t ][\t ]*[a-zA-Z_][a-zA-Z_0-9]*,/* & */,\n+_ACEOF\n+\n+# Break up conftest.defines because some shells have a limit on the size\n+# of here documents, and old seds have small limits too (100 cmds).\n+echo '  # Handle all the #define templates only if necessary.' >>$CONFIG_STATUS\n+echo '  if grep \"^[\t ]*#[\t ]*define\" $tmp/in >/dev/null; then' >>$CONFIG_STATUS\n+echo '  # If there are no defines, we may have an empty if/fi' >>$CONFIG_STATUS\n+echo '  :' >>$CONFIG_STATUS\n+rm -f conftest.tail\n+while grep . conftest.defines >/dev/null\n+do\n+  # Write a limited-size here document to $tmp/defines.sed.\n+  echo '  cat >$tmp/defines.sed <<CEOF' >>$CONFIG_STATUS\n+  # Speed up: don't consider the non `#define' lines.\n+  echo '/^[\t ]*#[\t ]*define/!b' >>$CONFIG_STATUS\n+  # Work around the forget-to-reset-the-flag bug.\n+  echo 't clr' >>$CONFIG_STATUS\n+  echo ': clr' >>$CONFIG_STATUS\n+  sed ${ac_max_here_lines}q conftest.defines >>$CONFIG_STATUS\n+  echo 'CEOF\n+  sed -f $tmp/defines.sed $tmp/in >$tmp/out\n+  rm -f $tmp/in\n+  mv $tmp/out $tmp/in\n+' >>$CONFIG_STATUS\n+  sed 1,${ac_max_here_lines}d conftest.defines >conftest.tail\n+  rm -f conftest.defines\n+  mv conftest.tail conftest.defines\n+done\n+rm -f conftest.defines\n+echo '  fi # grep' >>$CONFIG_STATUS\n+echo >>$CONFIG_STATUS\n+\n+# Break up conftest.undefs because some shells have a limit on the size\n+# of here documents, and old seds have small limits too (100 cmds).\n+echo '  # Handle all the #undef templates' >>$CONFIG_STATUS\n+rm -f conftest.tail\n+while grep . conftest.undefs >/dev/null\n+do\n+  # Write a limited-size here document to $tmp/undefs.sed.\n+  echo '  cat >$tmp/undefs.sed <<CEOF' >>$CONFIG_STATUS\n+  # Speed up: don't consider the non `#undef'\n+  echo '/^[\t ]*#[\t ]*undef/!b' >>$CONFIG_STATUS\n+  # Work around the forget-to-reset-the-flag bug.\n+  echo 't clr' >>$CONFIG_STATUS\n+  echo ': clr' >>$CONFIG_STATUS\n+  sed ${ac_max_here_lines}q conftest.undefs >>$CONFIG_STATUS\n+  echo 'CEOF\n+  sed -f $tmp/undefs.sed $tmp/in >$tmp/out\n+  rm -f $tmp/in\n+  mv $tmp/out $tmp/in\n+' >>$CONFIG_STATUS\n+  sed 1,${ac_max_here_lines}d conftest.undefs >conftest.tail\n+  rm -f conftest.undefs\n+  mv conftest.tail conftest.undefs\n+done\n+rm -f conftest.undefs\n+\n+cat >>$CONFIG_STATUS <<\\_ACEOF\n+  # Let's still pretend it is `configure' which instantiates (i.e., don't\n+  # use $as_me), people would be surprised to read:\n+  #    /* config.h.  Generated by config.status.  */\n+  if test x\"$ac_file\" = x-; then\n+    echo \"/* Generated by configure.  */\" >$tmp/config.h\n+  else\n+    echo \"/* $ac_file.  Generated by configure.  */\" >$tmp/config.h\n+  fi\n+  cat $tmp/in >>$tmp/config.h\n+  rm -f $tmp/in\n+  if test x\"$ac_file\" != x-; then\n+    if diff $ac_file $tmp/config.h >/dev/null 2>&1; then\n+      { echo \"$as_me:$LINENO: $ac_file is unchanged\" >&5\n+echo \"$as_me: $ac_file is unchanged\" >&6;}\n+    else\n+      ac_dir=`(dirname \"$ac_file\") 2>/dev/null ||\n+$as_expr X\"$ac_file\" : 'X\\(.*[^/]\\)//*[^/][^/]*/*$' \\| \\\n+\t X\"$ac_file\" : 'X\\(//\\)[^/]' \\| \\\n+\t X\"$ac_file\" : 'X\\(//\\)$' \\| \\\n+\t X\"$ac_file\" : 'X\\(/\\)' \\| \\\n+\t .     : '\\(.\\)' 2>/dev/null ||\n+echo X\"$ac_file\" |\n+    sed '/^X\\(.*[^/]\\)\\/\\/*[^/][^/]*\\/*$/{ s//\\1/; q; }\n+  \t  /^X\\(\\/\\/\\)[^/].*/{ s//\\1/; q; }\n+  \t  /^X\\(\\/\\/\\)$/{ s//\\1/; q; }\n+  \t  /^X\\(\\/\\).*/{ s//\\1/; q; }\n+  \t  s/.*/./; q'`\n+      { if $as_mkdir_p; then\n+    mkdir -p \"$ac_dir\"\n+  else\n+    as_dir=\"$ac_dir\"\n+    as_dirs=\n+    while test ! -d \"$as_dir\"; do\n+      as_dirs=\"$as_dir $as_dirs\"\n+      as_dir=`(dirname \"$as_dir\") 2>/dev/null ||\n+$as_expr X\"$as_dir\" : 'X\\(.*[^/]\\)//*[^/][^/]*/*$' \\| \\\n+\t X\"$as_dir\" : 'X\\(//\\)[^/]' \\| \\\n+\t X\"$as_dir\" : 'X\\(//\\)$' \\| \\\n+\t X\"$as_dir\" : 'X\\(/\\)' \\| \\\n+\t .     : '\\(.\\)' 2>/dev/null ||\n+echo X\"$as_dir\" |\n+    sed '/^X\\(.*[^/]\\)\\/\\/*[^/][^/]*\\/*$/{ s//\\1/; q; }\n+  \t  /^X\\(\\/\\/\\)[^/].*/{ s//\\1/; q; }\n+  \t  /^X\\(\\/\\/\\)$/{ s//\\1/; q; }\n+  \t  /^X\\(\\/\\).*/{ s//\\1/; q; }\n+  \t  s/.*/./; q'`\n+    done\n+    test ! -n \"$as_dirs\" || mkdir $as_dirs\n+  fi || { { echo \"$as_me:$LINENO: error: cannot create directory \\\"$ac_dir\\\"\" >&5\n+echo \"$as_me: error: cannot create directory \\\"$ac_dir\\\"\" >&2;}\n+   { (exit 1); exit 1; }; }; }\n+\n+      rm -f $ac_file\n+      mv $tmp/config.h $ac_file\n+    fi\n+  else\n+    cat $tmp/config.h\n+    rm -f $tmp/config.h\n+  fi\n+done\n+_ACEOF\n+cat >>$CONFIG_STATUS <<\\_ACEOF\n+\n #\n # CONFIG_COMMANDS section.\n #"}, {"sha": "6c6b4309b634e0d531bb1a14ee0e64da9a9dadbe", "filename": "libobjc/configure.ac", "status": "modified", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2Fconfigure.ac?ref=049bc4044531a146d278dd63ff0ad226c239424c", "patch": "@@ -167,6 +167,8 @@ esac\n AC_SUBST(includedirname)\n AC_SUBST(libext)\n \n+AC_CONFIG_HEADERS(config.h)\n+\n # --------\n # Programs\n # --------\n@@ -228,6 +230,60 @@ fi])\n GTHREAD_FLAGS=$objc_cv_gthread_flags\n AC_SUBST(GTHREAD_FLAGS)\n \n+AC_MSG_CHECKING([for exception model to use])\n+AC_LANG_PUSH(C)\n+AC_ARG_ENABLE(sjlj-exceptions,\n+  AS_HELP_STRING([--enable-sjlj-exceptions],\n+                 [force use of builtin_setjmp for exceptions]),\n+[:],\n+[dnl Botheration.  Now we've got to detect the exception model.\n+dnl Link tests against libgcc.a are problematic since -- at least\n+dnl as of this writing -- we've not been given proper -L bits for\n+dnl single-tree newlib and libgloss.\n+dnl\n+dnl This is what AC_TRY_COMPILE would do if it didn't delete the\n+dnl conftest files before we got a change to grep them first.\n+cat > conftest.$ac_ext << EOF\n+[#]line __oline__ \"configure\"\n+@interface Frob\n+@end\n+@implementation Frob\n+@end\n+int proc();\n+int foo()\n+{\n+  @try {\n+   return proc();\n+  }\n+  @catch (Frob* ex) {\n+    return 0;\n+  }\n+}\n+EOF\n+old_CFLAGS=\"$CFLAGS\" \n+dnl work around that we don't have Objective-C support in autoconf\n+CFLAGS=\"-x objective-c -fgnu-runtime -fobjc-exceptions -S\"\n+if AC_TRY_EVAL(ac_compile); then\n+  if grep _Unwind_SjLj_Resume conftest.s >/dev/null 2>&1 ; then\n+    enable_sjlj_exceptions=yes\n+  elif grep _Unwind_Resume conftest.s >/dev/null 2>&1 ; then\n+    enable_sjlj_exceptions=no\n+  fi\n+fi\n+CFLAGS=\"$old_CFLAGS\"\n+rm -f conftest*])\n+if test x$enable_sjlj_exceptions = xyes; then\n+  AC_DEFINE(SJLJ_EXCEPTIONS, 1,\n+\t[Define if the compiler is configured for setjmp/longjmp exceptions.])\n+  ac_exception_model_name=sjlj\n+elif test x$enable_sjlj_exceptions = xno; then\n+  ac_exception_model_name=\"call frame\"\n+else\n+  AC_MSG_ERROR([unable to detect exception model])\n+fi\n+AC_LANG_POP(C)\n+AC_MSG_RESULT($ac_exception_model_name)\n+\n # ------\n # Output\n # ------"}, {"sha": "cfce70c51e321939965581a84b5eab5f31319a08", "filename": "libobjc/exception.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fexception.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/049bc4044531a146d278dd63ff0ad226c239424c/libobjc%2Fexception.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2Fexception.c?ref=049bc4044531a146d278dd63ff0ad226c239424c", "patch": "@@ -25,6 +25,7 @@ Boston, MA 02111-1307, USA.  */\n    executable file might be covered by the GNU General Public License. */\n \n #include <stdlib.h>\n+#include \"config.h\"\n #include \"objc/objc-api.h\"\n #include \"unwind.h\"\n #include \"unwind-pe.h\"\n@@ -356,7 +357,7 @@ objc_exception_throw (id value)\n   header->base.exception_cleanup = __objc_exception_cleanup;\n   header->value = value;\n \n-#ifdef _GLIBCXX_SJLJ_EXCEPTIONS\n+#ifdef SJLJ_EXCEPTIONS\n   _Unwind_SjLj_RaiseException (&header->base);\n #else\n   _Unwind_RaiseException (&header->base);"}]}