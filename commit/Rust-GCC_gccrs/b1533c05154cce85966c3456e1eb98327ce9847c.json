{"sha": "b1533c05154cce85966c3456e1eb98327ce9847c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjE1MzNjMDUxNTRjY2U4NTk2NmMzNDU2ZTFlYjk4MzI3Y2U5ODQ3Yw==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-11-09T23:53:36Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-11-09T23:53:36Z"}, "message": "(loop on $required): When a file is copied\nbecause another file needs it, scan it for what files it needs.\n\nFrom-SVN: r6045", "tree": {"sha": "623ebe15571cc33659b866f7cad4022d5d707d55", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/623ebe15571cc33659b866f7cad4022d5d707d55"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b1533c05154cce85966c3456e1eb98327ce9847c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1533c05154cce85966c3456e1eb98327ce9847c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b1533c05154cce85966c3456e1eb98327ce9847c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b1533c05154cce85966c3456e1eb98327ce9847c/comments", "author": null, "committer": null, "parents": [{"sha": "2878315f416febae786ade601b66e031b8257c1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2878315f416febae786ade601b66e031b8257c1c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2878315f416febae786ade601b66e031b8257c1c"}], "stats": {"total": 37, "additions": 23, "deletions": 14}, "files": [{"sha": "b2d527d63ce8332c772abda83aca259816ead832", "filename": "gcc/fixincludes", "status": "modified", "additions": 23, "deletions": 14, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b1533c05154cce85966c3456e1eb98327ce9847c/gcc%2Ffixincludes", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b1533c05154cce85966c3456e1eb98327ce9847c/gcc%2Ffixincludes", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixincludes?ref=b1533c05154cce85966c3456e1eb98327ce9847c", "patch": "@@ -339,20 +339,29 @@ done\n \n # Make sure that any include files referenced using double quotes\n # exist in the fixed directory.\n-set x $required\n-shift\n-while [ $# != 0 ]; do\n-  # $1 is the directory to copy from, $2 is the unfixed file,\n-  # $3 is the fixed file name.\n-  cd ${INPUT}\n-  cd $1\n-  if [ -r $2 ] && [ ! -r $3 ]; then\n-    cp $2 $3 >/dev/null 2>&1 || echo \"Can't copy $2\"\n-    chmod +w $3 2>/dev/null\n-    chmod a+r $3 2>/dev/null\n-    echo Copied $2\n-  fi\n-  shift; shift; shift\n+while [ -n \"$required\" ]; do\n+  newreq=\n+  set x $required\n+  shift\n+  while [ $# != 0 ]; do\n+    # $1 is the directory to copy from, $2 is the unfixed file,\n+    # $3 is the fixed file name.\n+    cd ${INPUT}\n+    cd $1\n+    if [ -r $2 ] && [ ! -r $3 ]; then\n+      cp $2 $3 >/dev/null 2>&1 || echo \"Can't copy $2\"\n+      chmod +w $3 2>/dev/null\n+      chmod a+r $3 2>/dev/null\n+      echo Copied $2\n+      for include in `egrep '^[ \t]*#[ \t]*include[ \t]*\"[^/]' $3 | sed -e 's/^[ \t]*#[ \t]*include[ \t]*\"\\([^\"]*\\)\".*$/\\1/'`; do\n+\tdir=`echo $2 | sed -e s'|/[^/]*$||'`\n+\tdir2=`echo $3 | sed -e s'|/[^/]*$||'`\n+\tnewreq=\"$newreq $1 $dir/$include $dir2/$include\"\n+      done\n+    fi\n+    shift; shift; shift\n+  done\n+  required=$newreq\n done\n \n cd ${INPUT}"}]}