{"sha": "51a56a7d474daf301f46324da38208835a524f2c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTFhNTZhN2Q0NzRkYWYzMDFmNDYzMjRkYTM4MjA4ODM1YTUyNGYyYw==", "commit": {"author": {"name": "Stan Shebs", "email": "shebs@apple.com", "date": "2001-12-28T23:22:05Z"}, "committer": {"name": "Stan Shebs", "email": "shebs@gcc.gnu.org", "date": "2001-12-28T23:22:05Z"}, "message": "objc-act.c (build_module_descriptor): Make sure the init function is not deferred.\n\n\t* objc/objc-act.c (build_module_descriptor): Make sure the init\n\tfunction is not deferred.\n\t(build_dispatch_table_initializer): Compute the method encoding if\n\tnot already done.\n\nFrom-SVN: r48356", "tree": {"sha": "16cc0c286d32484983410e291a463ab7db481967", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/16cc0c286d32484983410e291a463ab7db481967"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/51a56a7d474daf301f46324da38208835a524f2c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51a56a7d474daf301f46324da38208835a524f2c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51a56a7d474daf301f46324da38208835a524f2c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51a56a7d474daf301f46324da38208835a524f2c/comments", "author": null, "committer": null, "parents": [{"sha": "fae81b385b8b6dc357a802edfe8082817acfdc27", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fae81b385b8b6dc357a802edfe8082817acfdc27", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fae81b385b8b6dc357a802edfe8082817acfdc27"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "895a9afdce359a4743735b947c3266a59b8bf0a8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51a56a7d474daf301f46324da38208835a524f2c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51a56a7d474daf301f46324da38208835a524f2c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=51a56a7d474daf301f46324da38208835a524f2c", "patch": "@@ -1,3 +1,10 @@\n+2001-12-28  Stan Shebs  <shebs@apple.com>\n+\n+\t* objc/objc-act.c (build_module_descriptor): Make sure the init\n+\tfunction is not deferred.\n+\t(build_dispatch_table_initializer): Compute the method encoding if\n+\tnot already done.\n+\n 2001-12-28  Kazu Hirata  <kazu@hxi.com>\n \n \t* doc/md.texi: Add @findex define_insn_and_split."}, {"sha": "8dd08011177d0aac988bd86bc2e8669134893458", "filename": "gcc/objc/objc-act.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51a56a7d474daf301f46324da38208835a524f2c/gcc%2Fobjc%2Fobjc-act.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51a56a7d474daf301f46324da38208835a524f2c/gcc%2Fobjc%2Fobjc-act.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2Fobjc-act.c?ref=51a56a7d474daf301f46324da38208835a524f2c", "patch": "@@ -1763,6 +1763,9 @@ build_module_descriptor ()\n     init_function_decl = current_function_decl;\n     TREE_PUBLIC (init_function_decl) = ! targetm.have_ctors_dtors;\n     TREE_USED (init_function_decl) = 1;\n+    /* Don't let this one be deferred.  */\n+    DECL_INLINE (init_function_decl) = 0;\n+    DECL_UNINLINABLE (init_function_decl) = 1;\n     current_function_cannot_inline\n       = \"static constructors and destructors cannot be inlined\";\n \n@@ -3856,6 +3859,11 @@ build_dispatch_table_initializer (type, entries)\n \t\t\t    build_selector (METHOD_SEL_NAME (entries)),\n \t\t\t    NULL_TREE);\n \n+      /* Generate the method encoding if we don't have one already.  */\n+      if (! METHOD_ENCODING (entries))\n+\tMETHOD_ENCODING (entries) =\n+\t  encode_method_def (METHOD_DEFINITION (entries));\n+\n       elemlist = tree_cons (NULL_TREE,\n \t\t\t    add_objc_string (METHOD_ENCODING (entries),\n \t\t\t\t\t     meth_var_types),"}]}