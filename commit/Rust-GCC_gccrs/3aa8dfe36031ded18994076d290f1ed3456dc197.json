{"sha": "3aa8dfe36031ded18994076d290f1ed3456dc197", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2FhOGRmZTM2MDMxZGVkMTg5OTQwNzZkMjkwZjFlZDM0NTZkYzE5Nw==", "commit": {"author": {"name": "Oleg Endo", "email": "olegendo@gcc.gnu.org", "date": "2015-01-08T11:07:45Z"}, "committer": {"name": "Oleg Endo", "email": "olegendo@gcc.gnu.org", "date": "2015-01-08T11:07:45Z"}, "message": "re PR target/55212 ([SH] Switch to LRA)\n\ngcc/\n\tPR target/55212\n\t* config/sh/sh.md (*addsi3_compact): Emit reg-reg copy instead of\n\tconstant load if constant operand fits into I08.\n\nFrom-SVN: r219341", "tree": {"sha": "ee0407280e2fc184f1d628f7ae41d272663195c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee0407280e2fc184f1d628f7ae41d272663195c9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3aa8dfe36031ded18994076d290f1ed3456dc197", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3aa8dfe36031ded18994076d290f1ed3456dc197", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3aa8dfe36031ded18994076d290f1ed3456dc197", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3aa8dfe36031ded18994076d290f1ed3456dc197/comments", "author": null, "committer": null, "parents": [{"sha": "bd84df1879c9f7acf4e25a2b7d638013d17e6896", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd84df1879c9f7acf4e25a2b7d638013d17e6896", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd84df1879c9f7acf4e25a2b7d638013d17e6896"}], "stats": {"total": 17, "additions": 14, "deletions": 3}, "files": [{"sha": "2d5fcb383df474b723e9302d6e320e36678261b1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3aa8dfe36031ded18994076d290f1ed3456dc197/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3aa8dfe36031ded18994076d290f1ed3456dc197/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3aa8dfe36031ded18994076d290f1ed3456dc197", "patch": "@@ -1,3 +1,9 @@\n+2015-01-08  Oleg Endo  <olegendo@gcc.gnu.org>\n+\n+\tPR target/55212\n+\t* config/sh/sh.md (*addsi3_compact): Emit reg-reg copy instead of\n+\tconstant load if constant operand fits into I08.\n+\n 2015-01-08  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR sanitizer/64336"}, {"sha": "bbbdc1960e40e4ef58e50ccedb7ac4d636e508b1", "filename": "gcc/config/sh/sh.md", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3aa8dfe36031ded18994076d290f1ed3456dc197/gcc%2Fconfig%2Fsh%2Fsh.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3aa8dfe36031ded18994076d290f1ed3456dc197/gcc%2Fconfig%2Fsh%2Fsh.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.md?ref=3aa8dfe36031ded18994076d290f1ed3456dc197", "patch": "@@ -2061,8 +2061,9 @@\n ;; The problem is that LRA expects something like\n ;;    (set rA (plus rB (const_int N)))\n ;; to work.  We can do that, but we have to split out an additional reg-reg\n-;; copy before the actual add insn.  Use u constraint for that case to avoid\n-;; the invalid value in the stack pointer.\n+;; copy or constant load before the actual add insn.\n+;; Use u constraint for that case to avoid the invalid value in the stack\n+;; pointer.\n (define_insn_and_split \"*addsi3_compact\"\n   [(set (match_operand:SI 0 \"arith_reg_dest\" \"=r,&u\")\n \t(plus:SI (match_operand:SI 1 \"arith_operand\" \"%0,r\")\n@@ -2078,7 +2079,11 @@\n    && ! reg_overlap_mentioned_p (operands[0], operands[1])\"\n   [(set (match_dup 0) (match_dup 2))\n    (set (match_dup 0) (plus:SI (match_dup 0) (match_dup 1)))]\n-  \"\"\n+{\n+  /* Prefer 'mov r0,r1; add #imm8,r1' over 'mov #imm8,r1; add r0,r1'  */\n+  if (satisfies_constraint_I08 (operands[2]))\n+    std::swap (operands[1], operands[2]);\n+}\n   [(set_attr \"type\" \"arith\")])\n \n ;; -------------------------------------------------------------------------"}]}