{"sha": "965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTY1ZDdmYTQwZWUyNWViNmQ1MTY4ZGRiYmIyYzY1NDFlNDU1OGMyZA==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2005-11-27T21:31:36Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2005-11-27T21:31:36Z"}, "message": "re PR tree-optimization/24575 (-(i /10) is not foldded to i/-10)\n\n2005-11-27  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR middle-end/24575\n        * fold-const.c (negate_expr_p): Add case for signed divides if overflow\n        is undefined.\n        (negate_expr): Likewise.\n2005-11-27  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR middle-end/24575\n        * gcc.dg/tree-ssa/divide-3.c: New test.\n        * gcc.dg/tree-ssa/divide-4.c: New test.\n\nFrom-SVN: r107575", "tree": {"sha": "b7fdf4f01178be8199203636f4b7c9cb41de7ae9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b7fdf4f01178be8199203636f4b7c9cb41de7ae9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/comments", "author": null, "committer": null, "parents": [{"sha": "a0a7fbc94e5c317cbb5f5164ee626f51ae6844d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0a7fbc94e5c317cbb5f5164ee626f51ae6844d3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0a7fbc94e5c317cbb5f5164ee626f51ae6844d3"}], "stats": {"total": 73, "additions": 73, "deletions": 0}, "files": [{"sha": "615160c8fe57822d5f3794a5d90c78628b5db341", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "patch": "@@ -1,3 +1,10 @@\n+2005-11-27  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR middle-end/24575\n+\t* fold-const.c (negate_expr_p): Add case for signed divides if overflow\n+\tis undefined.\n+\t(negate_expr): Likewise.\n+\n 2005-11-27  Andreas Schwab  <schwab@suse.de>\n \n \t* config/m68k/m68k.c: Reindent and fix whitespace, remove"}, {"sha": "45863ee77e3c90f9cd119ff69d7a255e0d71c12e", "filename": "gcc/fold-const.c", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "patch": "@@ -991,6 +991,16 @@ negate_expr_p (tree t)\n \t       || negate_expr_p (TREE_OPERAND (t, 0));\n       break;\n \n+    case TRUNC_DIV_EXPR:\n+    case ROUND_DIV_EXPR:\n+    case FLOOR_DIV_EXPR:\n+    case CEIL_DIV_EXPR:\n+    case EXACT_DIV_EXPR:\n+      if (TYPE_UNSIGNED (TREE_TYPE (t)) || flag_wrapv)\n+        break;\n+      return negate_expr_p (TREE_OPERAND (t, 1))\n+             || negate_expr_p (TREE_OPERAND (t, 0));\n+\n     case NOP_EXPR:\n       /* Negate -((double)float) as (double)(-float).  */\n       if (TREE_CODE (type) == REAL_TYPE)\n@@ -1132,6 +1142,28 @@ negate_expr (tree t)\n \t}\n       break;\n \n+    case TRUNC_DIV_EXPR:\n+    case ROUND_DIV_EXPR:\n+    case FLOOR_DIV_EXPR:\n+    case CEIL_DIV_EXPR:\n+    case EXACT_DIV_EXPR:\n+      if (!TYPE_UNSIGNED (TREE_TYPE (t)) && !flag_wrapv)\n+        {\n+          tem = TREE_OPERAND (t, 1);\n+          if (negate_expr_p (tem))\n+            return fold_convert (type,\n+                                 fold_build2 (TREE_CODE (t), TREE_TYPE (t),\n+                                              TREE_OPERAND (t, 0),\n+                                              negate_expr (tem)));\n+          tem = TREE_OPERAND (t, 0);\n+          if (negate_expr_p (tem))\n+            return fold_convert (type,\n+                                 fold_build2 (TREE_CODE (t), TREE_TYPE (t),\n+                                              negate_expr (tem),\n+                                              TREE_OPERAND (t, 1)));\n+        }\n+      break;\n+\n     case NOP_EXPR:\n       /* Convert -((double)float) into (double)(-float).  */\n       if (TREE_CODE (type) == REAL_TYPE)"}, {"sha": "8c38c880317711805b3390c01e21594694e463f9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "patch": "@@ -1,3 +1,9 @@\n+2005-11-27  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR middle-end/24575\n+\t* gcc.dg/tree-ssa/divide-3.c: New test.\n+\t* gcc.dg/tree-ssa/divide-4.c: New test.\n+\n 2005-11-27  Steven G. Kargl  <kargls@comcast.net>\n \n \tPR fortran/24917"}, {"sha": "fa3e35a6a0be51a79ff2e698abc657bf39f14cad", "filename": "gcc/testsuite/gcc.dg/tree-ssa/divide-3.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-3.c?ref=965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -fdump-tree-optimized\" } */\n+\n+int f(int a)\n+{\n+  return -(a/10);\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"a / 10\" 0 \"optimized\"} } */\n+/* { dg-final { scan-tree-dump-times \"a / -10\" 1 \"optimized\"} } */\n+\n+/* { dg-final { cleanup-tree-dump \"optimized\" } } */\n+\n+"}, {"sha": "38c68cf6e8dda99bc037c6a3e7856c0751ddf64a", "filename": "gcc/testsuite/gcc.dg/tree-ssa/divide-4.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fdivide-4.c?ref=965d7fa40ee25eb6d5168ddbbb2c6541e4558c2d", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -fdump-tree-optimized\" } */\n+\n+int f(int a)\n+{\n+  return -(-a/10);\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"-a / 10\" 0 \"optimized\"} } */\n+/* { dg-final { scan-tree-dump-times \"a / 10\" 1 \"optimized\"} } */\n+\n+/* { dg-final { cleanup-tree-dump \"optimized\" } } */\n+\n+"}]}