{"sha": "e23580688cbb529bbbb5ed691b65f01aba1945e0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTIzNTgwNjg4Y2JiNTI5YmJiYjVlZDY5MWI2NWYwMWFiYTE5NDVlMA==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2002-10-23T17:55:56Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2002-10-23T17:55:56Z"}, "message": "alpha.c (TARGET_ASM_CAN_OUTPUT_MI_THUNK): True.\n\n        * config/alpha/alpha.c (TARGET_ASM_CAN_OUTPUT_MI_THUNK): True.\n        (alpha_output_mi_thunk_osf): Handle vcall_offset.\n\t* g++.dg/inherit/thunk1.C: Enable for s390 and alpha.\n\nFrom-SVN: r58462", "tree": {"sha": "0dce4b5dcecda262471114ba3d6b64ec1cd74bf0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0dce4b5dcecda262471114ba3d6b64ec1cd74bf0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e23580688cbb529bbbb5ed691b65f01aba1945e0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e23580688cbb529bbbb5ed691b65f01aba1945e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e23580688cbb529bbbb5ed691b65f01aba1945e0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e23580688cbb529bbbb5ed691b65f01aba1945e0/comments", "author": null, "committer": null, "parents": [{"sha": "8bcefb43ccfaf402c35312dd06c234e2ec975656", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8bcefb43ccfaf402c35312dd06c234e2ec975656", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8bcefb43ccfaf402c35312dd06c234e2ec975656"}], "stats": {"total": 46, "additions": 43, "deletions": 3}, "files": [{"sha": "20f3b347390dc142f592c3eab2b4a2277fe79875", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e23580688cbb529bbbb5ed691b65f01aba1945e0", "patch": "@@ -1,3 +1,8 @@\n+2002-10-23  Richard Henderson  <rth@redhat.com>\n+\n+\t* config/alpha/alpha.c (TARGET_ASM_CAN_OUTPUT_MI_THUNK): True.\n+\t(alpha_output_mi_thunk_osf): Handle vcall_offset.\n+\n 2002-10-23  Zack Weinberg  <zack@codesourcery.com>\n \n \t* langhooks.h (struct lang_hooks_for_tree_inlining): Add"}, {"sha": "d6a9f6bc661a15608190f8eea6d3c4436e3e02a6", "filename": "gcc/config/alpha/alpha.c", "status": "modified", "additions": 33, "deletions": 2, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2Fconfig%2Falpha%2Falpha.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2Fconfig%2Falpha%2Falpha.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Falpha%2Falpha.c?ref=e23580688cbb529bbbb5ed691b65f01aba1945e0", "patch": "@@ -301,7 +301,7 @@ static void unicosmk_unique_section PARAMS ((tree, int));\n #undef TARGET_ASM_OUTPUT_MI_THUNK\n #define TARGET_ASM_OUTPUT_MI_THUNK alpha_output_mi_thunk_osf\n #undef TARGET_ASM_CAN_OUTPUT_MI_THUNK\n-#define TARGET_ASM_CAN_OUTPUT_MI_THUNK default_can_output_mi_thunk_no_vcall\n+#define TARGET_ASM_CAN_OUTPUT_MI_THUNK hook_bool_tree_hwi_hwi_tree_true\n #endif\n \n struct gcc_target targetm = TARGET_INITIALIZER;\n@@ -7866,7 +7866,7 @@ alpha_output_mi_thunk_osf (file, thunk_fndecl, delta, vcall_offset, function)\n      FILE *file;\n      tree thunk_fndecl ATTRIBUTE_UNUSED;\n      HOST_WIDE_INT delta;\n-     HOST_WIDE_INT vcall_offset ATTRIBUTE_UNUSED;\n+     HOST_WIDE_INT vcall_offset;\n      tree function;\n {\n   HOST_WIDE_INT hi, lo;\n@@ -7901,6 +7901,37 @@ alpha_output_mi_thunk_osf (file, thunk_fndecl, delta, vcall_offset, function)\n       emit_insn (gen_adddi3 (this, this, tmp));\n     }\n \n+  /* Add a delta stored in the vtable at VCALL_OFFSET.  */\n+  if (vcall_offset)\n+    {\n+      rtx tmp, tmp2;\n+\n+      tmp = gen_rtx_REG (Pmode, 0);\n+      emit_move_insn (tmp, gen_rtx_MEM (Pmode, this));\n+\n+      lo = ((vcall_offset & 0xffff) ^ 0x8000) - 0x8000;\n+      hi = (((vcall_offset - lo) & 0xffffffff) ^ 0x80000000) - 0x80000000;\n+      if (hi + lo == vcall_offset)\n+\t{\n+\t  if (hi)\n+\t    emit_insn (gen_adddi3 (tmp, tmp, GEN_INT (hi)));\n+\t}\n+      else\n+\t{\n+\t  tmp2 = alpha_emit_set_long_const (gen_rtx_REG (Pmode, 1),\n+\t\t\t\t\t    vcall_offset, -(vcall_offset < 0));\n+          emit_insn (gen_adddi3 (tmp, tmp, tmp2));\n+\t  lo = 0;\n+\t}\n+      if (lo)\n+\ttmp2 = gen_rtx_PLUS (Pmode, tmp, GEN_INT (lo));\n+      else\n+\ttmp2 = tmp;\n+      emit_move_insn (tmp, gen_rtx_MEM (Pmode, tmp2));\n+\n+      emit_insn (gen_adddi3 (this, this, tmp));\n+    }\n+\n   /* Generate a tail call to the target function.  */\n   if (! TREE_USED (function))\n     {"}, {"sha": "e79e4b51461b7a8918e7657482b83cc3c0c3625e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e23580688cbb529bbbb5ed691b65f01aba1945e0", "patch": "@@ -1,3 +1,7 @@\n+2002-10-23  Richard Henderson  <rth@redhat.com>\n+\n+\t* g++.dg/inherit/thunk1.C: Enable for s390 and alpha.\n+\n 2002-10-22  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/6579"}, {"sha": "4dd05c91d7347509d8303d82809df93a47be3acd", "filename": "gcc/testsuite/g++.dg/inherit/thunk1.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fthunk1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e23580688cbb529bbbb5ed691b65f01aba1945e0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fthunk1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fthunk1.C?ref=e23580688cbb529bbbb5ed691b65f01aba1945e0", "patch": "@@ -1,4 +1,4 @@\n-// { dg-do run { target i?86-*-* } }\n+// { dg-do run { target i?86-*-* s390*-*-* alpha*-*-* } }\n \n #include <stdarg.h>\n "}]}