{"sha": "c648ab8a1a389833a4985c972e783649efe27328", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzY0OGFiOGExYTM4OTgzM2E0OTg1Yzk3MmU3ODM2NDllZmUyNzMyOA==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-28T22:55:11Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-28T22:55:11Z"}, "message": "(process_command): When GCC_EXEC_PREFIX is defined and tooldir is relative...\n\n(process_command): When GCC_EXEC_PREFIX is defined and\ntooldir is relative, add it to search path in addition to standard\ndirectory rather than instead of.\n\nFrom-SVN: r4588", "tree": {"sha": "a42ff21de8a8e82aa9877895bb4a24c510b02612", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a42ff21de8a8e82aa9877895bb4a24c510b02612"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c648ab8a1a389833a4985c972e783649efe27328", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c648ab8a1a389833a4985c972e783649efe27328", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c648ab8a1a389833a4985c972e783649efe27328", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c648ab8a1a389833a4985c972e783649efe27328/comments", "author": null, "committer": null, "parents": [{"sha": "db25e492164350aed1e016186e2c5937fa16f938", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db25e492164350aed1e016186e2c5937fa16f938", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db25e492164350aed1e016186e2c5937fa16f938"}], "stats": {"total": 47, "additions": 29, "deletions": 18}, "files": [{"sha": "502f13e4086c20dfefa302ef5d2de0fe77449e89", "filename": "gcc/gcc.c", "status": "modified", "additions": 29, "deletions": 18, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c648ab8a1a389833a4985c972e783649efe27328/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c648ab8a1a389833a4985c972e783649efe27328/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=c648ab8a1a389833a4985c972e783649efe27328", "patch": "@@ -2352,24 +2352,6 @@ process_command (argc, argv)\n \tn_infiles++;\n     }\n \n-  tooldir_prefix = concat (tooldir_base_prefix, spec_machine, \"/\");\n-\n-  /* If tooldir is relative, base it on exec_prefix.  A relative\n-     tooldir lets us move the installed tree as a unit.  */\n-\n-  if (*tooldir_prefix != '/')\n-    {\n-      if (gcc_exec_prefix)\n-\ttooldir_prefix = concat (concat (gcc_exec_prefix, spec_machine, \"/\"),\n-\t\t\t\t concat (spec_version, \"/\", tooldir_prefix),\n-\t\t\t\t \"\");\n-      else\n-\ttooldir_prefix = concat (concat (standard_exec_prefix, spec_machine, \"/\"),\n-\t\t\t\t concat (spec_version, \"/\", tooldir_prefix),\n-\t\t\t\t \"\");\n-    }\n-\n-\n   /* Set up the search paths before we go looking for config files.  */\n \n   /* These come before the md prefixes so that we will find gcc's subcommands\n@@ -2382,6 +2364,35 @@ process_command (argc, argv)\n   add_prefix (&startfile_prefix, standard_exec_prefix, 0, 1, NULL_PTR);\n   add_prefix (&startfile_prefix, standard_exec_prefix_1, 0, 1, NULL_PTR);\n \n+  tooldir_prefix = concat (tooldir_base_prefix, spec_machine, \"/\");\n+\n+  /* If tooldir is relative, base it on exec_prefix.  A relative\n+     tooldir lets us move the installed tree as a unit.\n+\n+     If GCC_EXEC_PREFIX is defined, then we want to add two relative\n+     directories, so that we can search both the user specified directory\n+     and the standard place.  */\n+\n+  if (*tooldir_prefix != '/')\n+    {\n+      if (gcc_exec_prefix)\n+\t{\n+\t  char *gcc_exec_tooldir_prefix\n+\t    = concat (concat (gcc_exec_prefix, spec_machine, \"/\"),\n+\t\t      concat (spec_version, \"/\", tooldir_prefix),\n+\t\t      \"\");\n+\n+\t  add_prefix (&exec_prefix, concat (gcc_exec_tooldir_prefix, \"bin\", \"/\"),\n+\t\t      0, 0, NULL_PTR);\n+\t  add_prefix (&startfile_prefix, concat (gcc_exec_tooldir_prefix, \"lib\", \"/\"),\n+\t\t      0, 0, NULL_PTR);\n+\t}\n+\n+      tooldir_prefix = concat (concat (standard_exec_prefix, spec_machine, \"/\"),\n+\t\t\t       concat (spec_version, \"/\", tooldir_prefix),\n+\t\t\t       \"\");\n+    }\n+\n   add_prefix (&exec_prefix, concat (tooldir_prefix, \"bin\", \"/\"),\n \t      0, 0, NULL_PTR);\n   add_prefix (&startfile_prefix, concat (tooldir_prefix, \"lib\", \"/\"),"}]}