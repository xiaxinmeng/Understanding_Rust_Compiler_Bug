{"sha": "3aac5aad16e7e77dcd3885089c6b2566df29feb9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2FhYzVhYWQxNmU3ZTc3ZGNkMzg4NTA4OWM2YjI1NjZkZjI5ZmViOQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2012-11-14T23:14:05Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2012-11-14T23:14:05Z"}, "message": "builtins.c (define_builtin): Accept ECF flags and use set_call_expr_flags.\n\n\n\t* builtins.c (define_builtin): Accept ECF flags and\n\tuse set_call_expr_flags.\n\t(initialize_builtins): Update.\n\nFrom-SVN: r193513", "tree": {"sha": "3aad2d10480297a65eecb66e34f75f402b94e2a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3aad2d10480297a65eecb66e34f75f402b94e2a9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3aac5aad16e7e77dcd3885089c6b2566df29feb9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3aac5aad16e7e77dcd3885089c6b2566df29feb9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3aac5aad16e7e77dcd3885089c6b2566df29feb9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3aac5aad16e7e77dcd3885089c6b2566df29feb9/comments", "author": null, "committer": null, "parents": [{"sha": "7153ca970bac312f5e52af870560669ffd438b3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7153ca970bac312f5e52af870560669ffd438b3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7153ca970bac312f5e52af870560669ffd438b3b"}], "stats": {"total": 53, "additions": 27, "deletions": 26}, "files": [{"sha": "0f2722413bf0d3d57d10192d6ad219c2a1d0dfad", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3aac5aad16e7e77dcd3885089c6b2566df29feb9/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3aac5aad16e7e77dcd3885089c6b2566df29feb9/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=3aac5aad16e7e77dcd3885089c6b2566df29feb9", "patch": "@@ -1,3 +1,9 @@\n+2012-11-15  Jan Hubicka  <jh@suse.cz>\n+\n+\t* builtins.c (define_builtin): Accept ECF flags and\n+\tuse set_call_expr_flags.\n+\t(initialize_builtins): Update.\n+\n 2012-10-01  Lawrence Crowl  <crowl@google.com>\n \n \t* Make-lang.in (JAVA_OBJS): Add dependence on hash-table.o."}, {"sha": "b873a8f01e7a54f85efbd979f0be52c31617afa4", "filename": "gcc/java/builtins.c", "status": "modified", "additions": 21, "deletions": 26, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3aac5aad16e7e77dcd3885089c6b2566df29feb9/gcc%2Fjava%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3aac5aad16e7e77dcd3885089c6b2566df29feb9/gcc%2Fjava%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fbuiltins.c?ref=3aac5aad16e7e77dcd3885089c6b2566df29feb9", "patch": "@@ -451,8 +451,6 @@ VMSupportsCS8_builtin (tree method_return_type,\n \n \f\n \n-#define BUILTIN_NOTHROW 1\n-#define BUILTIN_CONST 2\n /* Define a single builtin.  */\n static void\n define_builtin (enum built_in_function val,\n@@ -471,10 +469,7 @@ define_builtin (enum built_in_function val,\n   pushdecl (decl);\n   DECL_BUILT_IN_CLASS (decl) = BUILT_IN_NORMAL;\n   DECL_FUNCTION_CODE (decl) = val;\n-  if (flags & BUILTIN_NOTHROW)\n-    TREE_NOTHROW (decl) = 1;\n-  if (flags & BUILTIN_CONST)\n-    TREE_READONLY (decl) = 1;\n+  set_call_expr_flags (decl, flags);\n \n   set_builtin_decl (val, decl, true);\n }\n@@ -512,49 +507,49 @@ initialize_builtins (void)\n \t\t\t\tdouble_type_node, double_type_node, NULL_TREE);\n \n   define_builtin (BUILT_IN_FMOD, \"__builtin_fmod\",\n-\t\t  double_ftype_double_double, \"fmod\", BUILTIN_CONST);\n+\t\t  double_ftype_double_double, \"fmod\", ECF_CONST);\n   define_builtin (BUILT_IN_FMODF, \"__builtin_fmodf\",\n-\t\t  float_ftype_float_float, \"fmodf\", BUILTIN_CONST);\n+\t\t  float_ftype_float_float, \"fmodf\", ECF_CONST);\n \n   define_builtin (BUILT_IN_ACOS, \"__builtin_acos\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math4acosEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_ASIN, \"__builtin_asin\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math4asinEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_ATAN, \"__builtin_atan\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math4atanEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_ATAN2, \"__builtin_atan2\",\n \t\t  double_ftype_double_double, \"_ZN4java4lang4Math5atan2EJddd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_CEIL, \"__builtin_ceil\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math4ceilEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_COS, \"__builtin_cos\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math3cosEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_EXP, \"__builtin_exp\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math3expEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_FLOOR, \"__builtin_floor\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math5floorEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_LOG, \"__builtin_log\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math3logEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_POW, \"__builtin_pow\",\n \t\t  double_ftype_double_double, \"_ZN4java4lang4Math3powEJddd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_SIN, \"__builtin_sin\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math3sinEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_SQRT, \"__builtin_sqrt\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math4sqrtEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   define_builtin (BUILT_IN_TAN, \"__builtin_tan\",\n \t\t  double_ftype_double, \"_ZN4java4lang4Math3tanEJdd\",\n-\t\t  BUILTIN_CONST);\n+\t\t  ECF_CONST);\n   \n   boolean_ftype_boolean_boolean\n     = build_function_type_list (boolean_type_node,\n@@ -563,28 +558,28 @@ initialize_builtins (void)\n   define_builtin (BUILT_IN_EXPECT, \"__builtin_expect\", \n \t\t  boolean_ftype_boolean_boolean,\n \t\t  \"__builtin_expect\",\n-\t\t  BUILTIN_CONST | BUILTIN_NOTHROW);\n+\t\t  ECF_CONST | ECF_NOTHROW);\n   define_builtin (BUILT_IN_SYNC_BOOL_COMPARE_AND_SWAP_4, \n \t\t  \"__sync_bool_compare_and_swap_4\",\n \t\t  build_function_type_list (boolean_type_node,\n \t\t\t\t\t    int_type_node, \n \t\t\t\t\t    build_pointer_type (int_type_node),\n \t\t\t\t\t    int_type_node, NULL_TREE), \n-\t\t  \"__sync_bool_compare_and_swap_4\", 0);\n+\t\t  \"__sync_bool_compare_and_swap_4\", ECF_NOTHROW | ECF_LEAF);\n   define_builtin (BUILT_IN_SYNC_BOOL_COMPARE_AND_SWAP_8, \n \t\t  \"__sync_bool_compare_and_swap_8\",\n \t\t  build_function_type_list (boolean_type_node,\n \t\t\t\t\t    long_type_node, \n \t\t\t\t\t    build_pointer_type (long_type_node),\n \t\t\t\t\t    int_type_node, NULL_TREE), \n-\t\t  \"__sync_bool_compare_and_swap_8\", 0);\n+\t\t  \"__sync_bool_compare_and_swap_8\", ECF_NOTHROW | ECF_LEAF);\n   define_builtin (BUILT_IN_SYNC_SYNCHRONIZE, \"__sync_synchronize\",\n \t\t  build_function_type_list (void_type_node, NULL_TREE),\n-\t\t  \"__sync_synchronize\", BUILTIN_NOTHROW);\n+\t\t  \"__sync_synchronize\", ECF_NOTHROW | ECF_LEAF);\n   \n   define_builtin (BUILT_IN_RETURN_ADDRESS, \"__builtin_return_address\",\n \t\t  build_function_type_list (ptr_type_node, int_type_node, NULL_TREE),\n-\t\t  \"__builtin_return_address\", BUILTIN_NOTHROW);\n+\t\t  \"__builtin_return_address\", ECF_NOTHROW | ECF_LEAF);\n \n   build_common_builtin_nodes ();\n }"}]}