{"sha": "c6147dc433015793d92602811e585b83c9018bc2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzYxNDdkYzQzMzAxNTc5M2Q5MjYwMjgxMWU1ODViODNjOTAxOGJjMg==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2016-09-26T15:53:28Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2016-09-26T15:53:28Z"}, "message": "c-lex.c (c_common_has_attribute): Handle attribute fallthrough.\n\n\t* c-lex.c (c_common_has_attribute): Handle attribute fallthrough.\n\n\t* system.h: Use __has_attribute to check whether the fallthrough\n\tattribute is supported.\n\n\t* g++.dg/cpp1z/feat-cxx1z.C: Test attribute fallthrough.\n\nFrom-SVN: r240499", "tree": {"sha": "0ae29fdb0d04e4498b59ab6240031213610fb6e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0ae29fdb0d04e4498b59ab6240031213610fb6e8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c6147dc433015793d92602811e585b83c9018bc2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6147dc433015793d92602811e585b83c9018bc2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c6147dc433015793d92602811e585b83c9018bc2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6147dc433015793d92602811e585b83c9018bc2/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8e4284d0b24bd3c745c054054d673ed306d30467", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e4284d0b24bd3c745c054054d673ed306d30467", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e4284d0b24bd3c745c054054d673ed306d30467"}], "stats": {"total": 30, "additions": 27, "deletions": 3}, "files": [{"sha": "f7122e258d1e84989e317098a58607c375b7e7ed", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c6147dc433015793d92602811e585b83c9018bc2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c6147dc433015793d92602811e585b83c9018bc2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c6147dc433015793d92602811e585b83c9018bc2", "patch": "@@ -1,3 +1,8 @@\n+2016-09-26  Marek Polacek  <polacek@redhat.com>\n+\n+\t* system.h: Use __has_attribute to check whether the fallthrough\n+\tattribute is supported.\n+\n 2016-09-26  Marek Polacek  <polacek@redhat.com>\n \n \t* ipa-inline-analysis.c (find_foldable_builtin_expect): Use"}, {"sha": "6eec8958902a77b7b3d811cc57c1a2ee387fa233", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=c6147dc433015793d92602811e585b83c9018bc2", "patch": "@@ -1,3 +1,7 @@\n+2016-09-26  Marek Polacek  <polacek@redhat.com>\n+\n+\t* c-lex.c (c_common_has_attribute): Handle attribute fallthrough.\n+\n 2016-09-26  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/7652"}, {"sha": "5c6496ebecf83784db4e4c2c3626d2777142a8e3", "filename": "gcc/c-family/c-lex.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Fc-family%2Fc-lex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Fc-family%2Fc-lex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-lex.c?ref=c6147dc433015793d92602811e585b83c9018bc2", "patch": "@@ -350,7 +350,8 @@ c_common_has_attribute (cpp_reader *pfile)\n \t      else if (is_attribute_p (\"deprecated\", attr_name))\n \t\tresult = 201309;\n \t      else if (is_attribute_p (\"maybe_unused\", attr_name)\n-\t\t       || is_attribute_p (\"nodiscard\", attr_name))\n+\t\t       || is_attribute_p (\"nodiscard\", attr_name)\n+\t\t       || is_attribute_p (\"fallthrough\", attr_name))\n \t\tresult = 201603;\n \t      if (result)\n \t\tattr_name = NULL_TREE;"}, {"sha": "0952e4f6e8f83c606b310bf95cd69a729387b38a", "filename": "gcc/system.h", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Fsystem.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Fsystem.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsystem.h?ref=c6147dc433015793d92602811e585b83c9018bc2", "patch": "@@ -746,8 +746,12 @@ extern void fancy_abort (const char *, int, const char *) ATTRIBUTE_NORETURN;\n #define gcc_unreachable() (fancy_abort (__FILE__, __LINE__, __FUNCTION__))\n #endif\n \n-#if GCC_VERSION >= 7000\n-# define gcc_fallthrough() __attribute__((fallthrough))\n+#if GCC_VERSION >= 7000 && defined(__has_attribute)\n+# if __has_attribute(fallthrough)\n+#  define gcc_fallthrough() __attribute__((fallthrough))\n+# else\n+#  define gcc_fallthrough()\n+# endif\n #else\n # define gcc_fallthrough()\n #endif"}, {"sha": "0692c017ef98d6f3d2c190860a10bff88119cbf2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c6147dc433015793d92602811e585b83c9018bc2", "patch": "@@ -1,3 +1,7 @@\n+2016-09-26  Marek Polacek  <polacek@redhat.com>\n+\n+\t* g++.dg/cpp1z/feat-cxx1z.C: Test attribute fallthrough.\n+\n 2016-09-26  Martin Liska  <mliska@suse.cz>\n \n \t* c-c++-common/ubsan/sanitize-recover-1.c: New test."}, {"sha": "71c8c7d3768c2beaa92ad77d90ad8903a7c73bb9", "filename": "gcc/testsuite/g++.dg/cpp1z/feat-cxx1z.C", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Ffeat-cxx1z.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c6147dc433015793d92602811e585b83c9018bc2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Ffeat-cxx1z.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Ffeat-cxx1z.C?ref=c6147dc433015793d92602811e585b83c9018bc2", "patch": "@@ -370,6 +370,12 @@\n #    error \"__has_cpp_attribute(nodiscard) != 201603\"\n #  endif\n \n+#  if ! __has_cpp_attribute(fallthrough)\n+#    error \"__has_cpp_attribute(fallthrough)\"\n+#  elif __has_cpp_attribute(fallthrough) != 201603\n+#    error \"__has_cpp_attribute(fallthrough) != 201603\"\n+#  endif\n+\n #else\n #  error \"__has_cpp_attribute\"\n #endif"}]}