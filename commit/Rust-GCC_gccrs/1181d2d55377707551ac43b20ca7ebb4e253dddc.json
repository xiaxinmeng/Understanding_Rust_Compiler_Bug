{"sha": "1181d2d55377707551ac43b20ca7ebb4e253dddc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTE4MWQyZDU1Mzc3NzA3NTUxYWM0M2IyMGNhN2ViYjRlMjUzZGRkYw==", "commit": {"author": {"name": "H.J. Lu", "email": "hjl@gnu.ai.mit.edu", "date": "1997-10-23T01:17:58Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-10-23T01:17:58Z"}, "message": "libio.h (_IO_LOCK_T): Handle glibc 2 when _IO_MTSAFE_IO is not defined.\n\n        * libio.h (_IO_LOCK_T): Handle glibc 2 when _IO_MTSAFE_IO is\n        not defined.\n\n        * iovsscanf.c (vsscanf): Make it weak alias of _IO_vsscanf if\n        __linux__ is defined instead of __ELF__\n\n        * config/linuxlibc1.mt (USER_INCLUDES): Add libio.h.\nOK'd by Ulrich.\n\nFrom-SVN: r16151", "tree": {"sha": "8a86fdd90a3b0a82e0d6c72cbc99059eaa1e6533", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a86fdd90a3b0a82e0d6c72cbc99059eaa1e6533"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1181d2d55377707551ac43b20ca7ebb4e253dddc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1181d2d55377707551ac43b20ca7ebb4e253dddc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1181d2d55377707551ac43b20ca7ebb4e253dddc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1181d2d55377707551ac43b20ca7ebb4e253dddc/comments", "author": null, "committer": null, "parents": [{"sha": "4966381af5a597dd1cf0f4f73b70d12f5d17be13", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4966381af5a597dd1cf0f4f73b70d12f5d17be13", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4966381af5a597dd1cf0f4f73b70d12f5d17be13"}], "stats": {"total": 24, "additions": 18, "deletions": 6}, "files": [{"sha": "6da6b9c5b911688f325d5f8b258fabf09d2d1e8d", "filename": "libio/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libio%2FChangeLog?ref=1181d2d55377707551ac43b20ca7ebb4e253dddc", "patch": "@@ -1,3 +1,13 @@\n+Wed Oct 22 19:19:32 1997  H.J. Lu  (hjl@gnu.ai.mit.edu)\n+\n+\t* libio.h (_IO_LOCK_T): Handle glibc 2 when _IO_MTSAFE_IO is\n+\tnot defined.\n+\n+\t* iovsscanf.c (vsscanf): Make it weak alias of _IO_vsscanf if\n+\t__linux__ is defined instead of __ELF__\n+\n+\t* config/linuxlibc1.mt (USER_INCLUDES): Add libio.h.\n+\n 1997-10-15  Ulrich Drepper  <drepper@cygnus.com>\n \n \t* configure.in: Create compatibility code in bits/libc-lock.h file."}, {"sha": "09c4c83804e95b94fd6c5f8054d1b8cb870fbd56", "filename": "libio/config/linuxlibc1.mt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2Fconfig%2Flinuxlibc1.mt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2Fconfig%2Flinuxlibc1.mt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libio%2Fconfig%2Flinuxlibc1.mt?ref=1181d2d55377707551ac43b20ca7ebb4e253dddc", "patch": "@@ -20,7 +20,7 @@ STDIO_OBJECTS=\n USER_INCLUDES=PlotFile.h SFile.h builtinbuf.h editbuf.h fstream.h \\\n \tindstream.h iomanip.h iostream.h istream.h ostream.h \\\n \tparsestream.h pfstream.h procbuf.h stdiostream.h stream.h \\\n-\tstreambuf.h strfile.h strstream.h\n+\tstreambuf.h strfile.h strstream.h libio.h\n \n # A bad kludge\n MT_CFLAGS=-D_G_HAVE_MMAP"}, {"sha": "beb0bc3a6b22eb4f3801bda0094fa46ac9f7a509", "filename": "libio/iovsscanf.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2Fiovsscanf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2Fiovsscanf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libio%2Fiovsscanf.c?ref=1181d2d55377707551ac43b20ca7ebb4e253dddc", "patch": "@@ -52,7 +52,7 @@ _IO_vsscanf (string, format, args)\n weak_alias (_IO_vsscanf, __vsscanf)\n weak_alias (_IO_vsscanf, vsscanf)\n #else\n-#ifdef __ELF__\n+#ifdef __linux__\n #pragma weak vsscanf = _IO_vsscanf\n #endif\n #endif"}, {"sha": "eeee6ceeb0bec1778568a1e1c2be5ddbf59693c4", "filename": "libio/libio.h", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2Flibio.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1181d2d55377707551ac43b20ca7ebb4e253dddc/libio%2Flibio.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libio%2Flibio.h?ref=1181d2d55377707551ac43b20ca7ebb4e253dddc", "patch": "@@ -157,15 +157,17 @@ struct _IO_jump_t;  struct _IO_FILE;\n # endif\n #else\n /* XXX This will go away as soon as comthread is finished.  */\n-# ifdef __linux__\n+# if defined __GLIBC__ && __GLIBC__ >= 2\n+#  define _IO_LOCK_T void *\n+# else\n+#  ifdef __linux__\n struct _IO_lock_t {\n   void *ptr;\n   short int field1;\n   short int field2;\n };\n-#  define _IO_LOCK_T struct _IO_lock_t\n-# else\n-typedef void _IO_lock_t;\n+#   define _IO_LOCK_T struct _IO_lock_t\n+#  endif\n # endif\n #endif\n "}]}