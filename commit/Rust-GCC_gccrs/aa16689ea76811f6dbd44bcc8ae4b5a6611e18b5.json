{"sha": "aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWExNjY4OWVhNzY4MTFmNmRiZDQ0YmNjOGFlNGI1YTY2MTFlMThiNQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2019-11-14T08:15:31Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2019-11-14T08:15:31Z"}, "message": "i386-options.c (ix86_omp_device_kind_arch_isa): Don't change sse4.2 to sse4_2 and sse4.1 to sse4.1.\n\n\t* config/i386/i386-options.c (ix86_omp_device_kind_arch_isa): Don't\n\tchange sse4.2 to sse4_2 and sse4.1 to sse4.1.\n\t* config/i386/t-omp-device (omp-device-properties-i386): Likewise.\n\n\t* c-c++-common/gomp/declare-variant-11.c: Add \"sse4.2\" and \"sse4.1\"\n\ttest.\n\nFrom-SVN: r278205", "tree": {"sha": "56757441d566a6d3d61488196120a8669dce81e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/56757441d566a6d3d61488196120a8669dce81e1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bedb7f045f3bc4ccf17f4b58f840c93acb821a3f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bedb7f045f3bc4ccf17f4b58f840c93acb821a3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bedb7f045f3bc4ccf17f4b58f840c93acb821a3f"}], "stats": {"total": 21, "additions": 11, "deletions": 10}, "files": [{"sha": "4a23dfc2ac20ae265102c72dd7d22c1d5bd03252", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "patch": "@@ -1,5 +1,9 @@\n 2019-11-14  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* config/i386/i386-options.c (ix86_omp_device_kind_arch_isa): Don't\n+\tchange sse4.2 to sse4_2 and sse4.1 to sse4.1.\n+\t* config/i386/t-omp-device (omp-device-properties-i386): Likewise.\n+\n \t* omp-general.c (omp_context_name_list_prop): New function.\n \t(omp_context_selector_matches): Use it.  Return 0 if it returns\n \tNULL."}, {"sha": "7470013437fcfc105a53bc510ab305d47c80ff0e", "filename": "gcc/config/i386/i386-options.c", "status": "modified", "additions": 2, "deletions": 8, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Fconfig%2Fi386%2Fi386-options.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Fconfig%2Fi386%2Fi386-options.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386-options.c?ref=aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "patch": "@@ -316,19 +316,13 @@ ix86_omp_device_kind_arch_isa (enum omp_device_kind_arch_isa trait,\n \t  HOST_WIDE_INT mask = i ? ix86_isa_flags2 : ix86_isa_flags;\n \t  for (size_t n = 0; n < nopts; n++)\n \t    {\n-\t      const char *option = opts[n].option + 2;\n-\t      /* -msse4.2 and -msse4.1 options contain dot, which is not valid\n-\t\t in identifiers.  Use underscore instead, and handle sse4\n-\t\t as an alias to sse4_2.  */\n+\t      /* Handle sse4 as an alias to sse4.2.  */\n \t      if (opts[n].mask == OPTION_MASK_ISA_SSE4_2)\n \t\t{\n-\t\t  option = \"sse4_2\";\n \t\t  if (strcmp (name, \"sse4\") == 0)\n \t\t    return (mask & opts[n].mask) != 0 ? 1 : -1;\n \t\t}\n-\t      else if (opts[n].mask == OPTION_MASK_ISA_SSE4_1)\n-\t\toption = \"sse4_1\";\n-\t      if (strcmp (name, option) == 0)\n+\t      if (strcmp (name, opts[n].option + 2) == 0)\n \t\treturn (mask & opts[n].mask) != 0 ? 1 : -1;\n \t    }\n \t}"}, {"sha": "037ae5e112d9d832ce733c6a5358a3439ec56a01", "filename": "gcc/config/i386/t-omp-device", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Fconfig%2Fi386%2Ft-omp-device", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Fconfig%2Fi386%2Ft-omp-device", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Ft-omp-device?ref=aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "patch": "@@ -3,4 +3,4 @@ omp-device-properties-i386: $(srcdir)/config/i386/i386-options.c\n \techo arch: x86 x86_64 i386 i486 i586 i686 ia32 >> $@\n \techo isa: sse4 `sed -n '/^static struct ix86_target_opts isa2\\?_opts\\[\\] =/,/^};/p' \\\n \t  $(srcdir)/config/i386/i386-options.c | \\\n-\t  sed -n 's/\",.*$$//;s/\\./_/;s/^  { \"-m//p'` >> $@\n+\t  sed -n 's/\",.*$$//;s/^  { \"-m//p'` >> $@"}, {"sha": "19aaa423bfc26b72374930b2a83b30156218ba16", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "patch": "@@ -1,5 +1,8 @@\n 2019-11-14  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* c-c++-common/gomp/declare-variant-11.c: Add \"sse4.2\" and \"sse4.1\"\n+\ttest.\n+\n \t* c-c++-common/gomp/declare-variant-2.c: Add test for non-integral\n \tscore and for negative score.\n \t* c-c++-common/gomp/declare-variant-3.c: Add test for zero score."}, {"sha": "50a3132869c1d24db9be942877ae356a96865a24", "filename": "gcc/testsuite/c-c++-common/gomp/declare-variant-11.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgomp%2Fdeclare-variant-11.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgomp%2Fdeclare-variant-11.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgomp%2Fdeclare-variant-11.c?ref=aa16689ea76811f6dbd44bcc8ae4b5a6611e18b5", "patch": "@@ -14,7 +14,7 @@ void f05 (void);\n void f06 (void);\n void f07 (void);\n void f08 (void);\n-#pragma omp declare variant (f07) match (device={isa(sse4,sse3,\"avx\")})\n+#pragma omp declare variant (f07) match (device={isa(sse4,\"sse4.1\",\"sse4.2\",sse3,\"avx\")})\n #pragma omp declare variant (f08) match (device={isa(\"avx\",sse3)})\n void f09 (void);\n void f10 (void);"}]}