{"sha": "2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmMyZmYxNjg0ZGQzM2E0ZWMyZWE3YjkxYzBhZGE5Y2YzNzFiZjc1Zg==", "commit": {"author": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2019-01-12T22:19:15Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2019-01-12T22:19:15Z"}, "message": "[nvptx] Enable setting vector length using -fopenacc-dim\n\nEnable setting vector length using -fopenacc-dim, f.i. -fopenacc-dim=::128.\n\n2019-01-12  Tom de Vries  <tdevries@suse.de>\n\n\t* config/nvptx/nvptx.c (nvptx_goacc_validate_dims_1): Alow setting\n\tvector length using -fopenacc-dim.\n\n\t* plugin/plugin-nvptx.c (nvptx_exec): Update error message.\n\nFrom-SVN: r267896", "tree": {"sha": "61235a7b30ab9a56f66607d3efcf978ca3f07463", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/61235a7b30ab9a56f66607d3efcf978ca3f07463"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/comments", "author": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a10577582585850c88b77dbc492eb046c05e79ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a10577582585850c88b77dbc492eb046c05e79ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a10577582585850c88b77dbc492eb046c05e79ce"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "2ba0b7cf8e08d943b2c8bead590dc9178abd0df3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "patch": "@@ -1,3 +1,8 @@\n+2019-01-12  Tom de Vries  <tdevries@suse.de>\n+\n+\t* config/nvptx/nvptx.c (nvptx_goacc_validate_dims_1): Alow setting\n+\tvector length using -fopenacc-dim.\n+\n 2019-01-12  Tom de Vries  <tdevries@suse.de>\n \n \t* config/nvptx/nvptx.c (nvptx_goacc_validate_dims): Take larger vector"}, {"sha": "03c0f82f4a2a7ea6cad4e38b26bf9d79928e3de4", "filename": "gcc/config/nvptx/nvptx.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/gcc%2Fconfig%2Fnvptx%2Fnvptx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/gcc%2Fconfig%2Fnvptx%2Fnvptx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnvptx%2Fnvptx.c?ref=2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "patch": "@@ -5705,7 +5705,8 @@ nvptx_goacc_validate_dims_1 (tree decl, int dims[], int fn_level, unsigned used)\n \n   if (oacc_default_dims_p)\n     {\n-      dims[GOMP_DIM_VECTOR] = default_vector_length;\n+      if (dims[GOMP_DIM_VECTOR] < 0)\n+\tdims[GOMP_DIM_VECTOR] = default_vector_length;\n       if (dims[GOMP_DIM_WORKER] < 0)\n \tdims[GOMP_DIM_WORKER] = PTX_DEFAULT_RUNTIME_DIM;\n       if (dims[GOMP_DIM_GANG] < 0)"}, {"sha": "00210529a55e1769bef177d8adf85e2d8384e924", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "patch": "@@ -1,3 +1,7 @@\n+2019-01-12  Tom de Vries  <tdevries@suse.de>\n+\n+\t* plugin/plugin-nvptx.c (nvptx_exec): Update error message.\n+\n 2019-01-12  Tom de Vries  <tdevries@suse.de>\n \n \t* testsuite/libgomp.oacc-c-c++-common/vector-length-64-1.c: New test."}, {"sha": "dd2bcf3083fe0739688cc19096612acae5f8f06e", "filename": "libgomp/plugin/plugin-nvptx.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/libgomp%2Fplugin%2Fplugin-nvptx.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f/libgomp%2Fplugin%2Fplugin-nvptx.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fplugin%2Fplugin-nvptx.c?ref=2c2ff1684dd33a4ec2ea7b91c0ada9cf371bf75f", "patch": "@@ -1321,7 +1321,7 @@ nvptx_exec (void (*fn), size_t mapnum, void **hostaddrs, void **devaddrs,\n \t   \" region or '-fopenacc-dim=:x:' where x <= 15\"\n \t   \"; \"\n \t   \"or, recompile the program with 'vector_length = 32' on that\"\n-\t   \" offloaded region\"\n+\t   \" offloaded region or '-fopenacc-dim=::32'\"\n \t   \".\\n\");\n \tGOMP_PLUGIN_fatal (msg, targ_fn->launch->fn, dims[GOMP_DIM_WORKER],\n \t\t\t   dims[GOMP_DIM_VECTOR]);"}]}