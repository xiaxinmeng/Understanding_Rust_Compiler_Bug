{"sha": "8da1a312964053d22469519475e61573d8ebf2a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGRhMWEzMTI5NjQwNTNkMjI0Njk1MTk0NzVlNjE1NzNkOGViZjJhNQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-05T14:08:42Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-09-05T14:08:42Z"}, "message": "[multiple changes]\n\n2011-09-05  Johannes Kanig  <kanig@adacore.com>\n\n\t* g-comlin.adb (Set_Usage): Additional optional argument to set help\n\tmessage.\n\t(Display_Help): display the user given help message, if available.\n\n2011-09-05  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch3.adb (OK_For_Limited_Init_In_05): The expression\n\tis legal if the original node is an identifier that is a\n\tparameterless function call.\n\nFrom-SVN: r178547", "tree": {"sha": "e37f5f37d5b9261edeffea638a83632cc3747857", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e37f5f37d5b9261edeffea638a83632cc3747857"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8da1a312964053d22469519475e61573d8ebf2a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8da1a312964053d22469519475e61573d8ebf2a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8da1a312964053d22469519475e61573d8ebf2a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8da1a312964053d22469519475e61573d8ebf2a5/comments", "author": null, "committer": null, "parents": [{"sha": "69b73847d7e9d65dc285d473115a363ed7da3c90", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69b73847d7e9d65dc285d473115a363ed7da3c90", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69b73847d7e9d65dc285d473115a363ed7da3c90"}], "stats": {"total": 70, "additions": 48, "deletions": 22}, "files": [{"sha": "12a99785573c8232d88bf17ff77dfea53ba0b358", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=8da1a312964053d22469519475e61573d8ebf2a5", "patch": "@@ -1,3 +1,15 @@\n+2011-09-05  Johannes Kanig  <kanig@adacore.com>\n+\n+\t* g-comlin.adb (Set_Usage): Additional optional argument to set help\n+\tmessage.\n+\t(Display_Help): display the user given help message, if available.\n+\n+2011-09-05  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch3.adb (OK_For_Limited_Init_In_05): The expression\n+\tis legal if the original node is an identifier that is a\n+\tparameterless function call.\n+\n 2011-09-05  Pascal Obry  <obry@adacore.com>\n \n \t* prj-nmsc.adb: Minor reformatting."}, {"sha": "e83ad519f63865f6cef375b6a4b2f6171273be03", "filename": "gcc/ada/g-comlin.adb", "status": "modified", "additions": 16, "deletions": 11, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2Fg-comlin.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2Fg-comlin.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-comlin.adb?ref=8da1a312964053d22469519475e61573d8ebf2a5", "patch": "@@ -3026,18 +3026,20 @@ package body GNAT.Command_Line is\n    ---------------\n \n    procedure Set_Usage\n-     (Config : in out Command_Line_Configuration;\n-      Usage  : String := \"[switches] [arguments]\";\n-      Help   : String := \"\")\n+     (Config   : in out Command_Line_Configuration;\n+      Usage    : String := \"[switches] [arguments]\";\n+      Help     : String := \"\";\n+      Help_Msg : String := \"\")\n    is\n    begin\n       if Config = null then\n          Config := new Command_Line_Configuration_Record;\n       end if;\n \n       Free (Config.Usage);\n-      Config.Usage := new String'(Usage);\n-      Config.Help  := new String'(Help);\n+      Config.Usage    := new String'(Usage);\n+      Config.Help     := new String'(Help);\n+      Config.Help_Msg := new String'(Help_Msg);\n    end Set_Usage;\n \n    ------------------\n@@ -3222,12 +3224,15 @@ package body GNAT.Command_Line is\n                    & \" [switches] [arguments]\");\n       end if;\n \n-      Display_Section_Help (\"\");\n-\n-      if Config.Sections /= null and then Config.Switches /= null then\n-         for S in Config.Sections'Range loop\n-            Display_Section_Help (Config.Sections (S).all);\n-         end loop;\n+      if Config.Help_Msg /= null and then Config.Help_Msg.all /= \"\" then\n+         Put_Line (Config.Help_Msg.all);\n+      else\n+         Display_Section_Help (\"\");\n+         if Config.Sections /= null and then Config.Switches /= null then\n+            for S in Config.Sections'Range loop\n+               Display_Section_Help (Config.Sections (S).all);\n+            end loop;\n+         end if;\n       end if;\n    end Display_Help;\n "}, {"sha": "9b2b0059788520fbef7359cc7defc97dcefd3fd7", "filename": "gcc/ada/g-comlin.ads", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2Fg-comlin.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2Fg-comlin.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-comlin.ads?ref=8da1a312964053d22469519475e61573d8ebf2a5", "patch": "@@ -664,11 +664,14 @@ package GNAT.Command_Line is\n    --  Output is always initialized to the empty string.\n \n    procedure Set_Usage\n-     (Config : in out Command_Line_Configuration;\n-      Usage  : String := \"[switches] [arguments]\";\n-      Help   : String := \"\");\n+     (Config   : in out Command_Line_Configuration;\n+      Usage    : String := \"[switches] [arguments]\";\n+      Help     : String := \"\";\n+      Help_Msg : String := \"\");\n    --  Defines the general format of the call to the application, and a short\n-   --  help text. These are both displayed by Display_Help\n+   --  help text. These are both displayed by Display_Help. When a non-empty\n+   --  Help_Msg is given, it is used by Display_Help instead of the\n+   --  automatically generated list of supported switches.\n \n    procedure Display_Help (Config : Command_Line_Configuration);\n    --  Display the help for the tool (ie its usage, and its supported switches)\n@@ -1134,6 +1137,7 @@ private\n       Aliases  : Alias_Definitions_List;\n       Usage    : GNAT.OS_Lib.String_Access;\n       Help     : GNAT.OS_Lib.String_Access;\n+      Help_Msg : GNAT.OS_Lib.String_Access;\n       Switches : Switch_Definitions_List;\n       --  List of expected switches (Used when expanding switch groups)\n    end record;"}, {"sha": "8802ae52077b9b745efc0914c1ec0b1135ca8282", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8da1a312964053d22469519475e61573d8ebf2a5/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=8da1a312964053d22469519475e61573d8ebf2a5", "patch": "@@ -772,8 +772,8 @@ package body Sem_Ch3 is\n             Anon_Scope := Scope (Defining_Entity (Related_Nod));\n          end if;\n \n-         --  For an access type definition, if the current scope is a child\n-         --  unit it is the scope of the type.\n+      --  For an access type definition, if the current scope is a child\n+      --  unit it is the scope of the type.\n \n       elsif Is_Compilation_Unit (Current_Scope) then\n          Anon_Scope := Current_Scope;\n@@ -821,7 +821,7 @@ package body Sem_Ch3 is\n          Set_Can_Use_Internal_Rep\n            (Anon_Type, not Always_Compatible_Rep_On_Target);\n \n-         --  If the anonymous access is associated with a protected operation\n+         --  If the anonymous access is associated with a protected operation,\n          --  create a reference to it after the enclosing protected definition\n          --  because the itype will be used in the subsequent bodies.\n \n@@ -908,10 +908,10 @@ package body Sem_Ch3 is\n                  Make_Object_Declaration (Loc,\n                    Defining_Identifier =>\n                      Make_Defining_Identifier (Loc, Name_uMaster),\n-                   Constant_Present => True,\n-                   Object_Definition =>\n+                   Constant_Present    => True,\n+                   Object_Definition   =>\n                      New_Reference_To (RTE (RE_Master_Id), Loc),\n-                   Expression =>\n+                   Expression          =>\n                      Make_Explicit_Dereference (Loc,\n                        New_Reference_To (RTE (RE_Current_Master), Loc)));\n \n@@ -16866,12 +16866,17 @@ package body Sem_Ch3 is\n       --  function calls. The function call may have been given in prefixed\n       --  notation, in which case the original node is an indexed component.\n       --  If the function is parameterless, the original node was an explicit\n-      --  dereference.\n+      --  dereference. The function may also be parameterless, in which case\n+      --  the source node is just an identifier.\n \n       case Nkind (Original_Node (Exp)) is\n          when N_Aggregate | N_Extension_Aggregate | N_Function_Call | N_Op =>\n             return True;\n \n+         when N_Identifier =>\n+            return Present (Entity (Original_Node (Exp)))\n+              and then Ekind (Entity (Original_Node (Exp))) = E_Function;\n+\n          when N_Qualified_Expression =>\n             return\n               OK_For_Limited_Init_In_05"}]}