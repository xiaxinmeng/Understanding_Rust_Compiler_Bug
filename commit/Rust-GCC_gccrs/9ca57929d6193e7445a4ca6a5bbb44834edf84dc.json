{"sha": "9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWNhNTc5MjlkNjE5M2U3NDQ1YTRjYTZhNWJiYjQ0ODM0ZWRmODRkYw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2014-01-30T14:32:25Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2014-01-30T14:32:25Z"}, "message": "re PR c++/58843 (ICE with broken destructor call)\n\n/cp\n2014-01-30  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/58843\n\t* typeck.c (lookup_destructor): Check dtor_type for error_mark_node.\n\n/testsuite\n2014-01-30  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/58843\n\t* g++.dg/lookup/crash8.C: New.\n\nFrom-SVN: r207305", "tree": {"sha": "37407f85991be736888c610604b8114db6e88d69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/37407f85991be736888c610604b8114db6e88d69"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/comments", "author": null, "committer": null, "parents": [{"sha": "e1b317aecf5cc86d1b61ba07c79fcd93a15a47c5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1b317aecf5cc86d1b61ba07c79fcd93a15a47c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1b317aecf5cc86d1b61ba07c79fcd93a15a47c5"}], "stats": {"total": 27, "additions": 27, "deletions": 0}, "files": [{"sha": "f49e2e55c4b21d9f7376df25b292b1b0c7dcf374", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "patch": "@@ -1,3 +1,8 @@\n+2014-01-30  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/58843\n+\t* typeck.c (lookup_destructor): Check dtor_type for error_mark_node.\n+\n 2014-01-30  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/58649"}, {"sha": "b6f47384f31c58edcac746f3ce4b88b9a7891b0b", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "patch": "@@ -2486,6 +2486,10 @@ lookup_destructor (tree object, tree scope, tree dtor_name,\n   tree dtor_type = TREE_OPERAND (dtor_name, 0);\n   tree expr;\n \n+  /* We've already complained about this destructor.  */\n+  if (dtor_type == error_mark_node)\n+    return error_mark_node;\n+\n   if (scope && !check_dtor_name (scope, dtor_type))\n     {\n       if (complain & tf_error)"}, {"sha": "22a79d4d971250aaf13546617ac17e13ab539757", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "patch": "@@ -1,3 +1,8 @@\n+2014-01-30  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/58843\n+\t* g++.dg/lookup/crash8.C: New.\n+\n 2014-01-30  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/58649"}, {"sha": "7dce9cb7237630a1511332e0bc632a6b6259a34e", "filename": "gcc/testsuite/g++.dg/lookup/crash8.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fcrash8.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ca57929d6193e7445a4ca6a5bbb44834edf84dc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fcrash8.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fcrash8.C?ref=9ca57929d6193e7445a4ca6a5bbb44834edf84dc", "patch": "@@ -0,0 +1,13 @@\n+// PR c++/58843\n+\n+struct A {};\n+\n+template<typename T> void foo(T t)\n+{\n+  t.T::~X();  // { dg-error \"no type\" }\n+}\n+\n+void bar()\n+{\n+  foo(A());\n+}"}]}