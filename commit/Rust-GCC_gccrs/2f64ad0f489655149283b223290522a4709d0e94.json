{"sha": "2f64ad0f489655149283b223290522a4709d0e94", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmY2NGFkMGY0ODk2NTUxNDkyODNiMjIzMjkwNTIyYTQ3MDlkMGU5NA==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@linux.vnet.ibm.com", "date": "2010-12-01T20:47:47Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "2010-12-01T20:47:47Z"}, "message": "Provide FMA costs; enable some debug flags\n\nFrom-SVN: r167354", "tree": {"sha": "ae09aee61d8ab3ab769607900a05f0589dfea559", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae09aee61d8ab3ab769607900a05f0589dfea559"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f64ad0f489655149283b223290522a4709d0e94", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f64ad0f489655149283b223290522a4709d0e94", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f64ad0f489655149283b223290522a4709d0e94", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f64ad0f489655149283b223290522a4709d0e94/comments", "author": null, "committer": null, "parents": [{"sha": "6399666bfc86a253c40b04cd4dba38ffab61db5c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6399666bfc86a253c40b04cd4dba38ffab61db5c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6399666bfc86a253c40b04cd4dba38ffab61db5c"}], "stats": {"total": 79, "additions": 22, "deletions": 57}, "files": [{"sha": "1f051c0ef20f8875f9b2e795df03c18ff5f8a56e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f64ad0f489655149283b223290522a4709d0e94/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f64ad0f489655149283b223290522a4709d0e94/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2f64ad0f489655149283b223290522a4709d0e94", "patch": "@@ -1,3 +1,9 @@\n+2010-12-01  Michael Meissner  <meissner@linux.vnet.ibm.com>\n+\n+\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Fix\n+\tthinko regarding setting -mno-<xxx> debug switches.\n+\t(rs6000_rtx_costs): Add FMA.  Delete old rtl based FMA costs.\n+\n 2010-12-01  Joseph Myers  <joseph@codesourcery.com>\n \n \t* intl.c: Don't include tm.h."}, {"sha": "f63aaecd5c329756d9d3076101fc239064076661", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 16, "deletions": 57, "changes": 73, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f64ad0f489655149283b223290522a4709d0e94/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f64ad0f489655149283b223290522a4709d0e94/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=2f64ad0f489655149283b223290522a4709d0e94", "patch": "@@ -3017,14 +3017,15 @@ rs6000_option_override_internal (bool global_init_p)\n \t\t\t\t || rs6000_cpu == PROCESSOR_PPCE500MC\n \t\t\t\t || rs6000_cpu == PROCESSOR_PPCE500MC64);\n \n-  /* Allow debug switches to override the above settings.  */\n-  if (TARGET_ALWAYS_HINT > 0)\n+  /* Allow debug switches to override the above settings.  These are set to -1\n+     in rs6000.opt to indicate the user hasn't directly set the switch.  */\n+  if (TARGET_ALWAYS_HINT >= 0)\n     rs6000_always_hint = TARGET_ALWAYS_HINT;\n \n-  if (TARGET_SCHED_GROUPS > 0)\n+  if (TARGET_SCHED_GROUPS >= 0)\n     rs6000_sched_groups = TARGET_SCHED_GROUPS;\n \n-  if (TARGET_ALIGN_BRANCH_TARGETS > 0)\n+  if (TARGET_ALIGN_BRANCH_TARGETS >= 0)\n     rs6000_align_branch_targets = TARGET_ALIGN_BRANCH_TARGETS;\n \n   rs6000_sched_restricted_insns_priority\n@@ -26072,54 +26073,9 @@ rs6000_rtx_costs (rtx x, int code, int outer_code, int *total,\n       return true;\n \n     case PLUS:\n-      if (mode == DFmode)\n-\t{\n-\t  if (GET_CODE (XEXP (x, 0)) == MULT)\n-\t    {\n-\t      /* FNMA accounted in outer NEG.  */\n-\t      if (outer_code == NEG)\n-\t\t*total = rs6000_cost->dmul - rs6000_cost->fp;\n-\t      else\n-\t\t*total = rs6000_cost->dmul;\n-\t    }\n-\t  else\n-\t    *total = rs6000_cost->fp;\n-\t}\n-      else if (mode == SFmode)\n-\t{\n-\t  /* FNMA accounted in outer NEG.  */\n-\t  if (outer_code == NEG && GET_CODE (XEXP (x, 0)) == MULT)\n-\t    *total = 0;\n-\t  else\n-\t    *total = rs6000_cost->fp;\n-\t}\n-      else\n-\t*total = COSTS_N_INSNS (1);\n-      return false;\n-\n     case MINUS:\n-      if (mode == DFmode)\n-\t{\n-\t  if (GET_CODE (XEXP (x, 0)) == MULT\n-\t      || GET_CODE (XEXP (x, 1)) == MULT)\n-\t    {\n-\t      /* FNMA accounted in outer NEG.  */\n-\t      if (outer_code == NEG)\n-\t\t*total = rs6000_cost->dmul - rs6000_cost->fp;\n-\t      else\n-\t\t*total = rs6000_cost->dmul;\n-\t    }\n-\t  else\n-\t    *total = rs6000_cost->fp;\n-\t}\n-      else if (mode == SFmode)\n-\t{\n-\t  /* FNMA accounted in outer NEG.  */\n-\t  if (outer_code == NEG && GET_CODE (XEXP (x, 0)) == MULT)\n-\t    *total = 0;\n-\t  else\n-\t    *total = rs6000_cost->fp;\n-\t}\n+      if (FLOAT_MODE_P (mode))\n+\t*total = rs6000_cost->fp;\n       else\n \t*total = COSTS_N_INSNS (1);\n       return false;\n@@ -26134,20 +26090,23 @@ rs6000_rtx_costs (rtx x, int code, int outer_code, int *total,\n \t  else\n \t    *total = rs6000_cost->mulsi_const;\n \t}\n-      /* FMA accounted in outer PLUS/MINUS.  */\n-      else if ((mode == DFmode || mode == SFmode)\n-\t       && (outer_code == PLUS || outer_code == MINUS))\n-\t*total = 0;\n-      else if (mode == DFmode)\n-\t*total = rs6000_cost->dmul;\n       else if (mode == SFmode)\n \t*total = rs6000_cost->fp;\n+      else if (FLOAT_MODE_P (mode))\n+\t*total = rs6000_cost->dmul;\n       else if (mode == DImode)\n \t*total = rs6000_cost->muldi;\n       else\n \t*total = rs6000_cost->mulsi;\n       return false;\n \n+    case FMA:\n+      if (mode == SFmode)\n+\t*total = rs6000_cost->fp;\n+      else\n+\t*total = rs6000_cost->dmul;\n+      break;\n+\n     case DIV:\n     case MOD:\n       if (FLOAT_MODE_P (mode))"}]}