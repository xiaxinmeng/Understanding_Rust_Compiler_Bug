{"sha": "a3fea1ef37cded943ca50c3f38d74916e24373ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTNmZWExZWYzN2NkZWQ5NDNjYTUwYzNmMzhkNzQ5MTZlMjQzNzNlZQ==", "commit": {"author": {"name": "Andrew Sutton", "email": "andrew.n.sutton@gmail.com", "date": "2014-08-13T14:16:48Z"}, "committer": {"name": "Andrew Sutton", "email": "asutton@gcc.gnu.org", "date": "2014-08-13T14:16:48Z"}, "message": "pt.c (lookup_template_variable): Make dependent variable templates have unknown type.\n\n2014-08-13  Andrew Sutton  <andrew.n.sutton@gmail.com>\n\n        * pt.c (lookup_template_variable): Make dependent variable templates\n        have unknown type.\n\nFrom-SVN: r213910", "tree": {"sha": "277f6ee6031ce428f5dd352a6634008808e64eb1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/277f6ee6031ce428f5dd352a6634008808e64eb1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a3fea1ef37cded943ca50c3f38d74916e24373ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a3fea1ef37cded943ca50c3f38d74916e24373ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a3fea1ef37cded943ca50c3f38d74916e24373ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a3fea1ef37cded943ca50c3f38d74916e24373ee/comments", "author": {"login": "asutton", "id": 570796, "node_id": "MDQ6VXNlcjU3MDc5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/570796?v=4", "gravatar_id": "", "url": "https://api.github.com/users/asutton", "html_url": "https://github.com/asutton", "followers_url": "https://api.github.com/users/asutton/followers", "following_url": "https://api.github.com/users/asutton/following{/other_user}", "gists_url": "https://api.github.com/users/asutton/gists{/gist_id}", "starred_url": "https://api.github.com/users/asutton/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/asutton/subscriptions", "organizations_url": "https://api.github.com/users/asutton/orgs", "repos_url": "https://api.github.com/users/asutton/repos", "events_url": "https://api.github.com/users/asutton/events{/privacy}", "received_events_url": "https://api.github.com/users/asutton/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "429e4fdebf1aa0b14a39ac03c71becfd8d0d5f56", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/429e4fdebf1aa0b14a39ac03c71becfd8d0d5f56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/429e4fdebf1aa0b14a39ac03c71becfd8d0d5f56"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "0889ea6e7fe42e2805d51634aa528736c56726b3", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a3fea1ef37cded943ca50c3f38d74916e24373ee/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a3fea1ef37cded943ca50c3f38d74916e24373ee/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=a3fea1ef37cded943ca50c3f38d74916e24373ee", "patch": "@@ -1,3 +1,8 @@\n+2014-08-13  Andrew Sutton  <andrew.n.sutton@gmail.com>\n+\n+\t* pt.c (lookup_template_variable): Make dependent variable templates \n+\thave unknown type.\n+\n 2014-08-13  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \t* parser.c (cp_parser_elaborated_type_specifier): Handle"}, {"sha": "be16ca8a0c91d1ce132032906ac0480c2f790f67", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a3fea1ef37cded943ca50c3f38d74916e24373ee/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a3fea1ef37cded943ca50c3f38d74916e24373ee/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=a3fea1ef37cded943ca50c3f38d74916e24373ee", "patch": "@@ -7965,13 +7965,22 @@ lookup_template_class (tree d1, tree arglist, tree in_decl, tree context,\n   return ret;\n }\n \n-/* Return a TEMPLATE_ID_EXPR for the given variable template and ARGLIST. */\n+/* Return a TEMPLATE_ID_EXPR for the given variable template and ARGLIST. \n+   If the ARGLIST refers to any template parameters, the type of the\n+   expression is the unknown_type_node since the template-id could\n+   refer to an explicit or partial specialization. */\n \n tree\n lookup_template_variable (tree templ, tree arglist)\n {\n-  return build2 (TEMPLATE_ID_EXPR, TREE_TYPE (templ), templ, arglist);\n+  tree type;\n+  if (uses_template_parms (arglist))\n+    type = unknown_type_node;\n+  else\n+    type = TREE_TYPE (templ);\n+  return build2 (TEMPLATE_ID_EXPR, type, templ, arglist);\n }\n+\n \f\n struct pair_fn_data\n {"}, {"sha": "2125d6c9487ecc825c045f1687f35f972d9ee8be", "filename": "gcc/testsuite/g++.dg/cpp1y/var-templ6.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a3fea1ef37cded943ca50c3f38d74916e24373ee/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fvar-templ6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a3fea1ef37cded943ca50c3f38d74916e24373ee/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fvar-templ6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fvar-templ6.C?ref=a3fea1ef37cded943ca50c3f38d74916e24373ee", "patch": "@@ -0,0 +1,12 @@\n+// { dg-options \"-std=c++1y\" }\n+\n+template<typename T>\n+  constexpr bool Class = __is_class(T);\n+\n+template<typename T>\n+  constexpr bool Test = Class<T>;\n+\n+struct S { };\n+\n+static_assert(!Test<int>, \"\");\n+static_assert(Test<S>, \"\");"}]}