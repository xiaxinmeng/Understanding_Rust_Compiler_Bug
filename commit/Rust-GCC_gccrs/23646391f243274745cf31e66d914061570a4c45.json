{"sha": "23646391f243274745cf31e66d914061570a4c45", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjM2NDYzOTFmMjQzMjc0NzQ1Y2YzMWU2NmQ5MTQwNjE1NzBhNGM0NQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2014-06-09T19:28:37Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2014-06-09T19:28:37Z"}, "message": "re PR c++/22556 (extern array: compatible declaration at function scope refused)\n\n/cp\n2014-06-09  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/22556\n\t* name-lookup.c (pushdecl_maybe_friend_1): Use comptypes.\n\n/testsuite\n2014-06-09  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/22556\n\t* g++.dg/other/redecl3.C: New.\n\nFrom-SVN: r211385", "tree": {"sha": "50747cd0ece1e1409da319bdd1c34bb4d5db7516", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50747cd0ece1e1409da319bdd1c34bb4d5db7516"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23646391f243274745cf31e66d914061570a4c45", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23646391f243274745cf31e66d914061570a4c45", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23646391f243274745cf31e66d914061570a4c45", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23646391f243274745cf31e66d914061570a4c45/comments", "author": null, "committer": null, "parents": [{"sha": "748e88da7ede35273266e9f35488a9a4dd299f84", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/748e88da7ede35273266e9f35488a9a4dd299f84", "html_url": "https://github.com/Rust-GCC/gccrs/commit/748e88da7ede35273266e9f35488a9a4dd299f84"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "6b2068868b5606805c1102ef03719a663c748106", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23646391f243274745cf31e66d914061570a4c45/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23646391f243274745cf31e66d914061570a4c45/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=23646391f243274745cf31e66d914061570a4c45", "patch": "@@ -1,3 +1,8 @@\n+2014-06-09  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/22556\n+\t* name-lookup.c (pushdecl_maybe_friend_1): Use comptypes.\n+\n 2014-06-07  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* method.c (use_thunk): Use set_decl_section_name."}, {"sha": "90f51083915bdcd0cd347df91b4592d437d58ccb", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23646391f243274745cf31e66d914061570a4c45/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23646391f243274745cf31e66d914061570a4c45/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=23646391f243274745cf31e66d914061570a4c45", "patch": "@@ -974,7 +974,8 @@ pushdecl_maybe_friend_1 (tree x, bool is_friend)\n \t      && (DECL_EXTERNAL (decl) || TREE_PUBLIC (decl))\n \t      /* If different sort of thing, we already gave an error.  */\n \t      && TREE_CODE (decl) == TREE_CODE (x)\n-\t      && !same_type_p (TREE_TYPE (x), TREE_TYPE (decl)))\n+\t      && !comptypes (TREE_TYPE (x), TREE_TYPE (decl),\n+\t\t\t     COMPARE_REDECLARATION))\n \t    {\n \t      if (permerror (input_location, \"type mismatch with previous \"\n \t\t\t     \"external decl of %q#D\", x))"}, {"sha": "06bdfa6d062d8f3eb7c2aa50aadb62f1846271c8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23646391f243274745cf31e66d914061570a4c45/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23646391f243274745cf31e66d914061570a4c45/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=23646391f243274745cf31e66d914061570a4c45", "patch": "@@ -1,3 +1,8 @@\n+2014-06-09  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/22556\n+\t* g++.dg/other/redecl3.C: New.\n+\n 2014-06-09  Marc Glisse  <marc.glisse@inria.fr>\n \n \tPR c++/54442"}, {"sha": "6d35bf53e9d34278718c6d7d70236715861cd93e", "filename": "gcc/testsuite/g++.dg/other/redecl3.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23646391f243274745cf31e66d914061570a4c45/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fredecl3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23646391f243274745cf31e66d914061570a4c45/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fredecl3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fredecl3.C?ref=23646391f243274745cf31e66d914061570a4c45", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/22556\n+\n+extern int foo[]; // OK\n+int foo[] = {1,2,3};\n+extern int foo[]; // OK\n+\n+void bar(){\n+  extern int foo[]; // g++: ERROR -- SHOULD BE OK\n+}"}]}