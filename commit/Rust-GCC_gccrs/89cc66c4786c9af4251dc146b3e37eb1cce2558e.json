{"sha": "89cc66c4786c9af4251dc146b3e37eb1cce2558e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODljYzY2YzQ3ODZjOWFmNDI1MWRjMTQ2YjNlMzdlYjFjY2UyNTU4ZQ==", "commit": {"author": {"name": "Ximin Luo", "email": "infinity0@pwned.gg", "date": "2016-10-24T11:57:27Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-10-24T11:57:27Z"}, "message": "re PR debug/77985 (DW_AT_comp_dir is omitted when filename is absolute and the file does not contain a specific typedef)\n\n2016-10-24  Ximin Luo  <infinity0@pwned.gg>\n\n\tPR debug/77985\n\t* dwarf2out.c (file_table_relative_p): Remove.\n\t(gen_compile_unit_die, dwarf2out_early_finish): Emit DW_AT_comp_dir\n\talso for absolute paths.\n\t* doc/tm.texi: Update.\n\t* doc/tm.texi.in (SDB and DWARF) <TARGET_FORCE_AT_COMP_DIR>: Remove.\n\t* target.def (force_at_comp_dir): Remove hook.\n\t* config/darwin.h (TARGET_FORCE_AT_COMP_DIR): Remove define.\n\nFrom-SVN: r241473", "tree": {"sha": "50f226ba04019b5bb110b9f76dc737fd9750a19c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50f226ba04019b5bb110b9f76dc737fd9750a19c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/89cc66c4786c9af4251dc146b3e37eb1cce2558e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89cc66c4786c9af4251dc146b3e37eb1cce2558e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/89cc66c4786c9af4251dc146b3e37eb1cce2558e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89cc66c4786c9af4251dc146b3e37eb1cce2558e/comments", "author": {"login": "infinity0", "id": 78398, "node_id": "MDQ6VXNlcjc4Mzk4", "avatar_url": "https://avatars.githubusercontent.com/u/78398?v=4", "gravatar_id": "", "url": "https://api.github.com/users/infinity0", "html_url": "https://github.com/infinity0", "followers_url": "https://api.github.com/users/infinity0/followers", "following_url": "https://api.github.com/users/infinity0/following{/other_user}", "gists_url": "https://api.github.com/users/infinity0/gists{/gist_id}", "starred_url": "https://api.github.com/users/infinity0/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/infinity0/subscriptions", "organizations_url": "https://api.github.com/users/infinity0/orgs", "repos_url": "https://api.github.com/users/infinity0/repos", "events_url": "https://api.github.com/users/infinity0/events{/privacy}", "received_events_url": "https://api.github.com/users/infinity0/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c101fad870ddf376d5722e5b2a9ee0f32888d056", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c101fad870ddf376d5722e5b2a9ee0f32888d056", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c101fad870ddf376d5722e5b2a9ee0f32888d056"}], "stats": {"total": 52, "additions": 13, "deletions": 39}, "files": [{"sha": "f050a17c17a2616271c256607c9d03447036bc6c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=89cc66c4786c9af4251dc146b3e37eb1cce2558e", "patch": "@@ -1,3 +1,14 @@\n+2016-10-24  Ximin Luo  <infinity0@pwned.gg>\n+\n+\tPR debug/77985\n+\t* dwarf2out.c (file_table_relative_p): Remove.\n+\t(gen_compile_unit_die, dwarf2out_early_finish): Emit DW_AT_comp_dir\n+\talso for absolute paths.\n+\t* doc/tm.texi: Update.\n+\t* doc/tm.texi.in (SDB and DWARF) <TARGET_FORCE_AT_COMP_DIR>: Remove.\n+\t* target.def (force_at_comp_dir): Remove hook.\n+\t* config/darwin.h (TARGET_FORCE_AT_COMP_DIR): Remove define.\n+\n 2016-10-24  Richard Biener  <rguenther@suse.de>\n \n \t* tree-vrp.c (evrp_dom_walker::before_dom_children): Ignore"}, {"sha": "98d2382009db113d2ea05586e9b804f1f3fabd94", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=89cc66c4786c9af4251dc146b3e37eb1cce2558e", "patch": "@@ -424,8 +424,6 @@ extern GTY(()) int darwin_ms_struct;\n \n #define TARGET_WANT_DEBUG_PUB_SECTIONS true\n \n-#define TARGET_FORCE_AT_COMP_DIR true\n-\n /* When generating stabs debugging, use N_BINCL entries.  */\n \n #define DBX_USE_BINCL"}, {"sha": "cffcfe9cca92b9cd8233f1657ec3dcbb40198297", "filename": "gcc/doc/tm.texi", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fdoc%2Ftm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fdoc%2Ftm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Ftm.texi?ref=89cc66c4786c9af4251dc146b3e37eb1cce2558e", "patch": "@@ -9784,10 +9784,6 @@ tables, and hence is desirable if it works.\n True if the @code{.debug_pubtypes} and @code{.debug_pubnames} sections should be emitted.  These sections are not used on most platforms, and in particular GDB does not use them.\n @end deftypevr\n \n-@deftypevr {Target Hook} bool TARGET_FORCE_AT_COMP_DIR\n-True if the @code{DW_AT_comp_dir} attribute should be emitted for each  compilation unit.  This attribute is required for the darwin linker  to emit debug information.\n-@end deftypevr\n-\n @deftypevr {Target Hook} bool TARGET_DELAY_SCHED2\n True if sched2 is not to be run at its normal place.\n This usually means it will be run as part of machine-specific reorg."}, {"sha": "d2dd45fdea6432151366f51bb11446a49bebb737", "filename": "gcc/doc/tm.texi.in", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fdoc%2Ftm.texi.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fdoc%2Ftm.texi.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Ftm.texi.in?ref=89cc66c4786c9af4251dc146b3e37eb1cce2558e", "patch": "@@ -7084,8 +7084,6 @@ tables, and hence is desirable if it works.\n \n @hook TARGET_WANT_DEBUG_PUB_SECTIONS\n \n-@hook TARGET_FORCE_AT_COMP_DIR\n-\n @hook TARGET_DELAY_SCHED2\n \n @hook TARGET_DELAY_VARTRACK"}, {"sha": "b059ed2a3ee32143675a6cf82e3ee3e2c76dd647", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 2, "deletions": 24, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=89cc66c4786c9af4251dc146b3e37eb1cce2558e", "patch": "@@ -22005,7 +22005,7 @@ gen_compile_unit_die (const char *filename)\n     {\n       add_name_attribute (die, filename);\n       /* Don't add cwd for <built-in>.  */\n-      if (!IS_ABSOLUTE_PATH (filename) && filename[0] != '<')\n+      if (filename[0] != '<')\n \tadd_comp_dir_attribute (die);\n     }\n \n@@ -26368,20 +26368,6 @@ prune_unused_types (void)\n     prune_unmark_dies (ctnode->root_die);\n }\n \n-/* Set the parameter to true if there are any relative pathnames in\n-   the file table.  */\n-int\n-file_table_relative_p (dwarf_file_data **slot, bool *p)\n-{\n-  struct dwarf_file_data *d = *slot;\n-  if (!IS_ABSOLUTE_PATH (d->filename))\n-    {\n-      *p = true;\n-      return 0;\n-    }\n-  return 1;\n-}\n-\n /* Helpers to manipulate hash table of comdat type units.  */\n \n struct comdat_type_hasher : nofree_ptr_hash <comdat_type_node>\n@@ -28195,15 +28181,7 @@ dwarf2out_early_finish (const char *filename)\n   /* Add the name for the main input file now.  We delayed this from\n      dwarf2out_init to avoid complications with PCH.  */\n   add_name_attribute (comp_unit_die (), remap_debug_filename (filename));\n-  if (!IS_ABSOLUTE_PATH (filename) || targetm.force_at_comp_dir)\n-    add_comp_dir_attribute (comp_unit_die ());\n-  else if (get_AT (comp_unit_die (), DW_AT_comp_dir) == NULL)\n-    {\n-      bool p = false;\n-      file_table->traverse<bool *, file_table_relative_p> (&p);\n-      if (p)\n-\tadd_comp_dir_attribute (comp_unit_die ());\n-    }\n+  add_comp_dir_attribute (comp_unit_die ());\n \n   /* With LTO early dwarf was really finished at compile-time, so make\n      sure to adjust the phase after annotating the LTRANS CU DIE.  */"}, {"sha": "20def246043350e38b1a9ffa923ba1c4748c912b", "filename": "gcc/target.def", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Ftarget.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cc66c4786c9af4251dc146b3e37eb1cce2558e/gcc%2Ftarget.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftarget.def?ref=89cc66c4786c9af4251dc146b3e37eb1cce2558e", "patch": "@@ -6056,13 +6056,6 @@ DEFHOOKPOD\n  in particular GDB does not use them.\",\n  bool, false)\n \n-DEFHOOKPOD\n-(force_at_comp_dir,\n- \"True if the @code{DW_AT_comp_dir} attribute should be emitted for each \\\n- compilation unit.  This attribute is required for the darwin linker \\\n- to emit debug information.\",\n- bool, false)\n-\n DEFHOOKPOD\n (delay_sched2, \"True if sched2 is not to be run at its normal place.\\n\\\n This usually means it will be run as part of machine-specific reorg.\","}]}