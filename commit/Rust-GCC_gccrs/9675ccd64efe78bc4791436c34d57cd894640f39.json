{"sha": "9675ccd64efe78bc4791436c34d57cd894640f39", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTY3NWNjZDY0ZWZlNzhiYzQ3OTE0MzZjMzRkNTdjZDg5NDY0MGYzOQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-01-18T18:13:44Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2021-01-18T18:13:44Z"}, "message": "widening_mul: Fix up signed multiplication overflow check handling [PR98727]\n\nI forgot one line, which means that if the second operand of the multiplication\nisn't constant, it would be just the same as the first one.\n\n2021-01-18  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR tree-optimization/98727\n\t* tree-ssa-math-opts.c (match_arith_overflow): Fix up computation of\n\tsecond .MUL_OVERFLOW operand for signed multiplication with overflow\n\tchecking if the second operand of multiplication is not constant.\n\n\t* gcc.c-torture/execute/pr98727.c: New test.", "tree": {"sha": "17ad2b20b99e70564ddda936ce64259643e570af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/17ad2b20b99e70564ddda936ce64259643e570af"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9675ccd64efe78bc4791436c34d57cd894640f39", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9675ccd64efe78bc4791436c34d57cd894640f39", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9675ccd64efe78bc4791436c34d57cd894640f39", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9675ccd64efe78bc4791436c34d57cd894640f39/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f56e14101b9f808b4cdded9bf6900b2ec4b1417a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f56e14101b9f808b4cdded9bf6900b2ec4b1417a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f56e14101b9f808b4cdded9bf6900b2ec4b1417a"}], "stats": {"total": 21, "additions": 21, "deletions": 0}, "files": [{"sha": "7ecdef805826552c1768114016e29e77e86d9e9f", "filename": "gcc/testsuite/gcc.c-torture/execute/pr98727.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9675ccd64efe78bc4791436c34d57cd894640f39/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr98727.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9675ccd64efe78bc4791436c34d57cd894640f39/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr98727.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr98727.c?ref=9675ccd64efe78bc4791436c34d57cd894640f39", "patch": "@@ -0,0 +1,20 @@\n+/* PR tree-optimization/98727 */\n+\n+__attribute__((noipa)) long int\n+foo (long int x, long int y)\n+{\n+  long int z = (unsigned long) x * y;\n+  if (x != z / y)\n+    return -1;\n+  return z;\n+}\n+\n+int\n+main ()\n+{\n+  if (foo (4, 24) != 96\n+      || foo (124, 126) != 124L * 126\n+      || foo (__LONG_MAX__ / 16, 17) != -1)\n+    __builtin_abort ();\n+  return 0;\n+}"}, {"sha": "d6201d3cb943e145720c18fbf3aadd853fd87b44", "filename": "gcc/tree-ssa-math-opts.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9675ccd64efe78bc4791436c34d57cd894640f39/gcc%2Ftree-ssa-math-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9675ccd64efe78bc4791436c34d57cd894640f39/gcc%2Ftree-ssa-math-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-math-opts.c?ref=9675ccd64efe78bc4791436c34d57cd894640f39", "patch": "@@ -4170,6 +4170,7 @@ match_arith_overflow (gimple_stmt_iterator *gsi, gimple *stmt,\n \trhs2 = fold_convert (type, rhs2);\n       else\n \t{\n+\t  g = SSA_NAME_DEF_STMT (rhs2);\n \t  if (gimple_assign_cast_p (g)\n \t      && useless_type_conversion_p (type,\n \t\t\t\t\t    TREE_TYPE (gimple_assign_rhs1 (g)))"}]}