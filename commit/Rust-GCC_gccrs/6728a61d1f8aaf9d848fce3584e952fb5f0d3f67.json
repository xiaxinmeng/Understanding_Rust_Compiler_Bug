{"sha": "6728a61d1f8aaf9d848fce3584e952fb5f0d3f67", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjcyOGE2MWQxZjhhYWY5ZDg0OGZjZTM1ODRlOTUyZmI1ZjBkM2Y2Nw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2001-06-15T23:22:02Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-06-15T23:22:02Z"}, "message": "natRuntime.cc (_Jv_FindSymbolInExecutable): Return NULL if no library on the list has the symbol.\n\n\t* java/lang/natRuntime.cc (_Jv_FindSymbolInExecutable): Return\n\tNULL if no library on the list has the symbol.\n\t(init): Call add_library on the program itself.\n\t* prims.cc (JvRunMain): Initialize Runtime before searching for\n\t`main'.\n\t(_Jv_RunMain): Likewise.\n\nFrom-SVN: r43413", "tree": {"sha": "66a09d8d7bb82b638704942709ea98d649fdbfa3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/66a09d8d7bb82b638704942709ea98d649fdbfa3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67/comments", "author": null, "committer": null, "parents": [{"sha": "21ea1c28cf21127a3a6e4155a977bd78542a5c4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21ea1c28cf21127a3a6e4155a977bd78542a5c4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21ea1c28cf21127a3a6e4155a977bd78542a5c4c"}], "stats": {"total": 26, "additions": 23, "deletions": 3}, "files": [{"sha": "9d20d86d6eeb3c044dcddd1d4ca5b2f658250723", "filename": "libjava/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=6728a61d1f8aaf9d848fce3584e952fb5f0d3f67", "patch": "@@ -1,3 +1,12 @@\n+2001-06-15  Tom Tromey  <tromey@redhat.com>\n+\n+\t* java/lang/natRuntime.cc (_Jv_FindSymbolInExecutable): Return\n+\tNULL if no library on the list has the symbol.\n+\t(init): Call add_library on the program itself.\n+\t* prims.cc (JvRunMain): Initialize Runtime before searching for\n+\t`main'.\n+\t(_Jv_RunMain): Likewise.\n+\n 2001-06-15  Tom Tromey  <tromey@redhat.com>\n \n \t* jni.cc (ClassClass): Removed; updated all users."}, {"sha": "cdd44a48dd1cac6cbaff8c068e1978581d4c6d01", "filename": "libjava/java/lang/natRuntime.cc", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67/libjava%2Fjava%2Flang%2FnatRuntime.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67/libjava%2Fjava%2Flang%2FnatRuntime.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatRuntime.cc?ref=6728a61d1f8aaf9d848fce3584e952fb5f0d3f67", "patch": "@@ -69,7 +69,7 @@ _Jv_FindSymbolInExecutable (const char *symname)\n \treturn r;\n     }\n \n-  return lt_dlsym (NULL, symname);\n+  return NULL;\n }\n \n #else\n@@ -199,6 +199,9 @@ java::lang::Runtime::init (void)\n   finalize_on_exit = false;\n #ifdef USE_LTDL\n   lt_dlinit ();\n+  lt_dlhandle self = lt_dlopen (NULL);\n+  if (self != NULL)\n+    add_library (self);\n #endif\n }\n "}, {"sha": "eac47e5fee56f696db29643195c9ccc68e8e940f", "filename": "libjava/prims.cc", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67/libjava%2Fprims.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6728a61d1f8aaf9d848fce3584e952fb5f0d3f67/libjava%2Fprims.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fprims.cc?ref=6728a61d1f8aaf9d848fce3584e952fb5f0d3f67", "patch": "@@ -1008,14 +1008,18 @@ JvRunMain (jclass klass, int argc, const char **argv)\n   _Jv_ThisExecutable (argv[0]);\n #endif\n \n+  // Get the Runtime here.  We want to initialize it before searching\n+  // for `main'; that way it will be set up if `main' is a JNI method.\n+  java::lang::Runtime *rtime = java::lang::Runtime::getRuntime ();\n+\n   main_thread = _Jv_AttachCurrentThread (JvNewStringLatin1 (\"main\"), NULL);\n   arg_vec = JvConvertArgv (argc - 1, argv + 1);\n   runFirst (klass, arg_vec);\n   _Jv_ThreadWait ();\n \n   int status = (int) java::lang::ThreadGroup::had_uncaught_exception;\n     \n-  java::lang::Runtime::getRuntime ()->_exit (status);\n+  rtime->_exit (status);\n }\n \n void\n@@ -1031,6 +1035,10 @@ _Jv_RunMain (const char *name, int argc, const char **argv, bool is_jar)\n   _Jv_ThisExecutable (exec_name);\n #endif\n \n+  // Get the Runtime here.  We want to initialize it before searching\n+  // for `main'; that way it will be set up if `main' is a JNI method.\n+  java::lang::Runtime *rtime = java::lang::Runtime::getRuntime ();\n+\n   main_thread = _Jv_AttachCurrentThread (JvNewStringLatin1 (\"main\"), NULL);\n \n   if (is_jar)\n@@ -1061,7 +1069,7 @@ _Jv_RunMain (const char *name, int argc, const char **argv, bool is_jar)\n \n   int status = (int) java::lang::ThreadGroup::had_uncaught_exception;\n \n-  java::lang::Runtime::getRuntime ()->exit (status);\n+  rtime->exit (status);\n }\n \n \f"}]}