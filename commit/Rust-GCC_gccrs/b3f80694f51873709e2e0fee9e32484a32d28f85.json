{"sha": "b3f80694f51873709e2e0fee9e32484a32d28f85", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjNmODA2OTRmNTE4NzM3MDllMmUwZmVlOWUzMjQ4NGEzMmQyOGY4NQ==", "commit": {"author": {"name": "Gabriel Dos Reis", "email": "gdr@integrable-solutions.net", "date": "2013-08-05T07:27:27Z"}, "committer": {"name": "Gabriel Dos Reis", "email": "gdr@gcc.gnu.org", "date": "2013-08-05T07:27:27Z"}, "message": "gimple-pretty-print.c (buffer): Remove.\n\n\t* gimple-pretty-print.c (buffer): Remove.\n\t(initialized): Likewise.\n\t(maybe_init_pretty_print): Likewise.\n\t(print_gimple_stmt): Do not call it.  Use non-static local\n\tpretty_printer variable.\n\t(print_gimple_expr): Likewise.\n\t(print_gimple_seq): Likewise.\n\t(gimple_dump_bb): Likewise.\n\nFrom-SVN: r201482", "tree": {"sha": "4d9e5dc7a8d618f07df1de0d53b07b73195726e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4d9e5dc7a8d618f07df1de0d53b07b73195726e6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b3f80694f51873709e2e0fee9e32484a32d28f85", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3f80694f51873709e2e0fee9e32484a32d28f85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b3f80694f51873709e2e0fee9e32484a32d28f85", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3f80694f51873709e2e0fee9e32484a32d28f85/comments", "author": {"login": "cxx-undef", "id": 5528103, "node_id": "MDQ6VXNlcjU1MjgxMDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5528103?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cxx-undef", "html_url": "https://github.com/cxx-undef", "followers_url": "https://api.github.com/users/cxx-undef/followers", "following_url": "https://api.github.com/users/cxx-undef/following{/other_user}", "gists_url": "https://api.github.com/users/cxx-undef/gists{/gist_id}", "starred_url": "https://api.github.com/users/cxx-undef/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cxx-undef/subscriptions", "organizations_url": "https://api.github.com/users/cxx-undef/orgs", "repos_url": "https://api.github.com/users/cxx-undef/repos", "events_url": "https://api.github.com/users/cxx-undef/events{/privacy}", "received_events_url": "https://api.github.com/users/cxx-undef/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e0aec1e9303b523df5552689a20cd0e0309d4308", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0aec1e9303b523df5552689a20cd0e0309d4308", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0aec1e9303b523df5552689a20cd0e0309d4308"}], "stats": {"total": 50, "additions": 27, "deletions": 23}, "files": [{"sha": "2fe5ac5e6604b4857c5c3b6be05141a9335342fe", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3f80694f51873709e2e0fee9e32484a32d28f85/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3f80694f51873709e2e0fee9e32484a32d28f85/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b3f80694f51873709e2e0fee9e32484a32d28f85", "patch": "@@ -1,3 +1,14 @@\n+2013-08-05  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n+\n+\t* gimple-pretty-print.c (buffer): Remove.\n+\t(initialized): Likewise.\n+\t(maybe_init_pretty_print): Likewise.\n+\t(print_gimple_stmt): Do not call it.  Use non-static local\n+\tpretty_printer variable.\n+\t(print_gimple_expr): Likewise.\n+\t(print_gimple_seq): Likewise.\n+\t(gimple_dump_bb): Likewise.\n+\n 2013-08-05  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n \n \t* asan.c (asan_pp): Remove."}, {"sha": "1d4068079ec6fdeeb2d5a0c0527447b1d315a765", "filename": "gcc/gimple-pretty-print.c", "status": "modified", "additions": 16, "deletions": 23, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3f80694f51873709e2e0fee9e32484a32d28f85/gcc%2Fgimple-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3f80694f51873709e2e0fee9e32484a32d28f85/gcc%2Fgimple-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-pretty-print.c?ref=b3f80694f51873709e2e0fee9e32484a32d28f85", "patch": "@@ -36,9 +36,6 @@ along with GCC; see the file COPYING3.  If not see\n #define INDENT(SPACE)\t\t\t\t\t\t\t\\\n   do { int i; for (i = 0; i < SPACE; i++) pp_space (buffer); } while (0)\n \n-static pretty_printer buffer;\n-static bool initialized = false;\n-\n #define GIMPLE_NIY do_niy (buffer,gs)\n \n /* Try to print on BUFFER a default message for the unrecognized\n@@ -52,22 +49,6 @@ do_niy (pretty_printer *buffer, gimple gs)\n }\n \n \n-/* Initialize the pretty printer on FILE if needed.  */\n-\n-static void\n-maybe_init_pretty_print (FILE *file)\n-{\n-  if (!initialized)\n-    {\n-      pp_construct (&buffer, NULL, 0);\n-      pp_needs_newline (&buffer) = true;\n-      initialized = true;\n-    }\n-\n-  buffer.buffer->stream = file;\n-}\n-\n-\n /* Emit a newline and SPC indentation spaces to BUFFER.  */\n \n static void\n@@ -93,7 +74,10 @@ debug_gimple_stmt (gimple gs)\n void\n print_gimple_stmt (FILE *file, gimple g, int spc, int flags)\n {\n-  maybe_init_pretty_print (file);\n+  pretty_printer buffer;\n+  pp_construct (&buffer, NULL, 0);\n+  pp_needs_newline (&buffer) = true;\n+  buffer.buffer->stream = file;\n   pp_gimple_stmt_1 (&buffer, g, spc, flags);\n   pp_newline_and_flush (&buffer);\n }\n@@ -122,7 +106,10 @@ void\n print_gimple_expr (FILE *file, gimple g, int spc, int flags)\n {\n   flags |= TDF_RHS_ONLY;\n-  maybe_init_pretty_print (file);\n+  pretty_printer buffer;\n+  pp_construct (&buffer, NULL, 0);\n+  pp_needs_newline (&buffer) = true;\n+  buffer.buffer->stream = file;\n   pp_gimple_stmt_1 (&buffer, g, spc, flags);\n   pp_flush (&buffer);\n }\n@@ -155,7 +142,10 @@ dump_gimple_seq (pretty_printer *buffer, gimple_seq seq, int spc, int flags)\n void\n print_gimple_seq (FILE *file, gimple_seq seq, int spc, int flags)\n {\n-  maybe_init_pretty_print (file);\n+  pretty_printer buffer;\n+  pp_construct (&buffer, NULL, 0);\n+  pp_needs_newline (&buffer) = true;\n+  buffer.buffer->stream = file;\n   dump_gimple_seq (&buffer, seq, spc, flags);\n   pp_newline_and_flush (&buffer);\n }\n@@ -2279,7 +2269,10 @@ gimple_dump_bb (FILE *file, basic_block bb, int indent, int flags)\n   dump_gimple_bb_header (file, bb, indent, flags);\n   if (bb->index >= NUM_FIXED_BLOCKS)\n     {\n-      maybe_init_pretty_print (file);\n+      pretty_printer buffer;\n+      pp_construct (&buffer, NULL, 0);\n+      pp_needs_newline (&buffer) = true;\n+      buffer.buffer->stream = file;\n       gimple_dump_bb_buff (&buffer, bb, indent, flags);\n     }\n   dump_gimple_bb_footer (file, bb, indent, flags);"}]}