{"sha": "461f8762a0b00404770bbbcc288c741f931140e4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDYxZjg3NjJhMGIwMDQwNDc3MGJiYmNjMjg4Yzc0MWY5MzExNDBlNA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2008-03-16T15:45:09Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2008-03-16T15:45:09Z"}, "message": "re PR tree-optimization/35607 (IVOPTs produces invalid gimple)\n\n2008-03-16  Richard Guenther  <rguenther@suse.de>\n\n\tPR middle-end/35607\n\t* tree-ssa-loop-niter.c (expand_simple_operations): Do not\n\texpand TREE_INVARIANT operations that are not gimple invariant.\n\n\t* gcc.c-torture/compile/pr35607.c: New testcase.\n\t* gcc.dg/tree-ssa/loop-19.c: Use -O2 to avoid vectorization.\n\nFrom-SVN: r133273", "tree": {"sha": "31a2feec16994e9a97405adbceee111bf59d80b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/31a2feec16994e9a97405adbceee111bf59d80b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/461f8762a0b00404770bbbcc288c741f931140e4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/461f8762a0b00404770bbbcc288c741f931140e4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/461f8762a0b00404770bbbcc288c741f931140e4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/461f8762a0b00404770bbbcc288c741f931140e4/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2a31c49ceb396963e298abb196fe3b099814cd3f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a31c49ceb396963e298abb196fe3b099814cd3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a31c49ceb396963e298abb196fe3b099814cd3f"}], "stats": {"total": 27, "additions": 26, "deletions": 1}, "files": [{"sha": "58d47850c1868532044d4c2e410057a4ffd0b19b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=461f8762a0b00404770bbbcc288c741f931140e4", "patch": "@@ -1,3 +1,9 @@\n+2008-03-16  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/35607\n+\t* tree-ssa-loop-niter.c (expand_simple_operations): Do not\n+\texpand TREE_INVARIANT operations that are not gimple invariant.\n+\n 2008-03-16  Hans-Peter Nilsson  <hp@axis.com>\n \n \t* doc/extend.texi (Alignment): Say that the ABI controls"}, {"sha": "d6c830a3e18e9940a319f45977c2c9b05eec8f81", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=461f8762a0b00404770bbbcc288c741f931140e4", "patch": "@@ -1,3 +1,9 @@\n+2008-03-16  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR middle-end/35607\n+\t* gcc.c-torture/compile/pr35607.c: New testcase.\n+\t* gcc.dg/tree-ssa/loop-19.c: Use -O2 to avoid vectorization.\n+\n 2008-03-16  Daniel Franke  <franke.daniel@gmail.com>\n \n \tPR fortran/35582"}, {"sha": "7f5aa7a2b7c22aa3e2776bbc57e8bd6dd1420a51", "filename": "gcc/testsuite/gcc.c-torture/compile/pr35607.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr35607.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr35607.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr35607.c?ref=461f8762a0b00404770bbbcc288c741f931140e4", "patch": "@@ -0,0 +1,9 @@\n+extern void (*__fini_array_start []) (void);\n+extern void (*__fini_array_end []) (void);\n+void\n+__libc_csu_fini (void)\n+{\n+  __SIZE_TYPE__ i = __fini_array_end - __fini_array_start;\n+  while (i-- > 0)\n+    (*__fini_array_start [i]) ();\n+}"}, {"sha": "1614f7e4de14a52905f04873605463200785c625", "filename": "gcc/testsuite/gcc.dg/tree-ssa/loop-19.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Floop-19.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Floop-19.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Floop-19.c?ref=461f8762a0b00404770bbbcc288c741f931140e4", "patch": "@@ -6,7 +6,7 @@\n \n /* { dg-do compile { target i?86-*-* x86_64-*-* powerpc*-*-*} } */\n /* { dg-require-effective-target nonpic } */\n-/* { dg-options \"-O3 -fdump-tree-final_cleanup\" } */\n+/* { dg-options \"-O2 -fdump-tree-final_cleanup\" } */\n \n # define N      2000000\n static double   a[N],c[N];"}, {"sha": "0696342bd1b4140be5df73acf5cfb8d305683a42", "filename": "gcc/tree-ssa-loop-niter.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftree-ssa-loop-niter.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/461f8762a0b00404770bbbcc288c741f931140e4/gcc%2Ftree-ssa-loop-niter.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-niter.c?ref=461f8762a0b00404770bbbcc288c741f931140e4", "patch": "@@ -1436,6 +1436,10 @@ expand_simple_operations (tree expr)\n     return expr;\n \n   e = GIMPLE_STMT_OPERAND (stmt, 1);\n+  /* Do not expand random invariants.  */\n+  if (TREE_INVARIANT (e)\n+      && !is_gimple_min_invariant (e))\n+    return expr;\n   if (/* Casts are simple.  */\n       TREE_CODE (e) != NOP_EXPR\n       && TREE_CODE (e) != CONVERT_EXPR"}]}