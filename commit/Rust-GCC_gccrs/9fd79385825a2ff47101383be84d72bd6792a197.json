{"sha": "9fd79385825a2ff47101383be84d72bd6792a197", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWZkNzkzODU4MjVhMmZmNDcxMDEzODNiZTg0ZDcyYmQ2NzkyYTE5Nw==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2007-06-06T10:29:53Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-06-06T10:29:53Z"}, "message": "gnatls.adb: Add 3 spaces before the default project directory when...\n\n2007-04-20  Vincent Celier  <celier@adacore.com>\n\n\t* gnatls.adb: \n\tAdd 3 spaces before the default project directory when displaying\n\tthe project search path.\n\tAdd new command line switch '-l' to display license information.\n\nFrom-SVN: r125418", "tree": {"sha": "66e6a81ef30cd8e7a52c0a4d6af75e2411184c16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/66e6a81ef30cd8e7a52c0a4d6af75e2411184c16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9fd79385825a2ff47101383be84d72bd6792a197", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fd79385825a2ff47101383be84d72bd6792a197", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fd79385825a2ff47101383be84d72bd6792a197", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fd79385825a2ff47101383be84d72bd6792a197/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "37ed3e067925442661abfe3292cdf06d37bdb8db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37ed3e067925442661abfe3292cdf06d37bdb8db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37ed3e067925442661abfe3292cdf06d37bdb8db"}], "stats": {"total": 92, "additions": 82, "deletions": 10}, "files": [{"sha": "dcef59d3dd5470be00fa2e0ef25cc935009fff08", "filename": "gcc/ada/gnatls.adb", "status": "modified", "additions": 82, "deletions": 10, "changes": 92, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9fd79385825a2ff47101383be84d72bd6792a197/gcc%2Fada%2Fgnatls.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9fd79385825a2ff47101383be84d72bd6792a197/gcc%2Fada%2Fgnatls.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatls.adb?ref=9fd79385825a2ff47101383be84d72bd6792a197", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2006, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2007, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -111,10 +111,11 @@ procedure Gnatls is\n    Print_Object     : Boolean := True;\n    --  Flags controlling the form of the output\n \n-   Dependable  : Boolean := False;  --  flag -d\n-   Also_Predef : Boolean := False;\n-\n-   Very_Verbose_Mode : Boolean := False; --  flag -V\n+   Also_Predef       : Boolean := False;  --  -a\n+   Dependable        : Boolean := False;  --  -d\n+   License           : Boolean := False;  --  -l\n+   Very_Verbose_Mode : Boolean := False;  --  -V\n+   --  Command line flags\n \n    Unit_Start   : Integer;\n    Unit_End     : Integer;\n@@ -177,6 +178,10 @@ procedure Gnatls is\n    procedure Usage;\n    --  Print usage message\n \n+   procedure Output_License_Information;\n+   --  Output license statement, and if not found, output reference to\n+   --  COPYING.\n+\n    function Image (Restriction : Restriction_Id) return String;\n    --  Returns the capitalized image of Restriction\n \n@@ -253,10 +258,10 @@ procedure Gnatls is\n          end if;\n       end loop;\n \n-      Error_Msg_Name_1 := Units.Table (U).Uname;\n-      Error_Msg_Name_2 := ALIs.Table (A).Afile;\n+      Error_Msg_Unit_1 := Units.Table (U).Uname;\n+      Error_Msg_File_1 := ALIs.Table (A).Afile;\n       Write_Eol;\n-      Error_Msg (\"wrong ALI format, can't find dependency line for & in %\");\n+      Error_Msg (\"wrong ALI format, can't find dependency line for $ in {\");\n       Exit_Program (E_Fatal);\n    end Corresponding_Sdep_Entry;\n \n@@ -682,7 +687,7 @@ procedure Gnatls is\n \n          --  Output Name\n \n-         Output_Name (Units.Table (U).Uname);\n+         Output_Name (Name_Id (Units.Table (U).Uname));\n \n          --  Output Kind\n \n@@ -768,7 +773,7 @@ procedure Gnatls is\n          Output_Token (T_With);\n          N_Indents := N_Indents + 1;\n \n-         Output_Name (Withs.Table (W).Uname);\n+         Output_Name (Name_Id (Withs.Table (W).Uname));\n \n          --  Output Kind\n \n@@ -815,6 +820,50 @@ procedure Gnatls is\n       return Result;\n    end Image;\n \n+   --------------------------------\n+   -- Output_License_Information --\n+   --------------------------------\n+\n+   procedure Output_License_Information is\n+      Params_File_Name : constant String := \"gnatlic.adl\";\n+      --  Name of license file\n+\n+      Lo   : constant Source_Ptr := 1;\n+      Hi   : Source_Ptr;\n+      Text : Source_Buffer_Ptr;\n+\n+   begin\n+      Name_Len := 0;\n+      Add_Str_To_Name_Buffer (Params_File_Name);\n+      Read_Source_File (Name_Find, Lo, Hi, Text);\n+\n+      if Text /= null then\n+\n+         --  Omit last character (end-of-file marker) in output\n+\n+         Write_Str (String (Text (Lo .. Hi - 1)));\n+         Write_Eol;\n+\n+         --  The following condition is determined at compile time: disable\n+         --  \"condition is always true/false\" warning.\n+\n+         pragma Warnings (Off);\n+      elsif Build_Type /= GPL and then Build_Type /= FSF then\n+         pragma Warnings (On);\n+\n+         Write_Str (\"License file missing, please contact AdaCore.\");\n+         Write_Eol;\n+\n+      else\n+         Write_Str (\"Please refer to file COPYING in your distribution\"\n+                  & \" for license terms.\");\n+         Write_Eol;\n+\n+      end if;\n+\n+      Exit_Program (E_Success);\n+   end Output_License_Information;\n+\n    -------------------\n    -- Output_Object --\n    -------------------\n@@ -1219,6 +1268,7 @@ procedure Gnatls is\n                when 'o' => Reset_Print; Print_Object := True;\n                when 'v' => Verbose_Mode              := True;\n                when 'd' => Dependable                := True;\n+               when 'l' => License                   := True;\n                when 'V' => Very_Verbose_Mode         := True;\n \n                when others => null;\n@@ -1395,6 +1445,11 @@ procedure Gnatls is\n                                \"depend\");\n       Write_Eol;\n \n+      --  Line for -l\n+\n+      Write_Str (\"  -l         output license information\");\n+      Write_Eol;\n+\n       --  Line for -v\n \n       Write_Str (\"  -v         verbose output, full path and unit \" &\n@@ -1478,6 +1533,15 @@ begin\n       Next_Arg := Next_Arg + 1;\n    end loop Scan_Args;\n \n+   --  If -l (output license information) is given, it must be the only switch\n+\n+   if License and then Arg_Count /= 2 then\n+      Write_Str (\"Can't use -l with another switch\");\n+      Write_Eol;\n+      Usage;\n+      Exit_Program (E_Fatal);\n+   end if;\n+\n    --  Add the source and object directories specified on the\n    --  command line, if any, to the searched directories.\n \n@@ -1639,6 +1703,7 @@ begin\n                Name_Buffer (Name_Len + 1 .. Name_Len + 4) := \"gnat\";\n                Name_Buffer (Name_Len + 5) := Directory_Separator;\n                Name_Len := Name_Len + 5;\n+               Write_Str (\"   \");\n                Write_Line\n                  (To_Host_Dir_Spec (Name_Buffer (1 .. Name_Len), True).all);\n             end if;\n@@ -1654,6 +1719,13 @@ begin\n       Usage;\n    end if;\n \n+   --  Output license information when requested\n+\n+   if License then\n+      Output_License_Information;\n+      Exit_Program (E_Success);\n+   end if;\n+\n    if not More_Lib_Files then\n       if not Print_Usage and then not Verbose_Mode then\n          Usage;"}]}