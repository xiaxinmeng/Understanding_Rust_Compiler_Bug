{"sha": "a944c79a88afb91706e4b29db4224981fe0c91eb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTk0NGM3OWE4OGFmYjkxNzA2ZTRiMjlkYjQyMjQ5ODFmZTBjOTFlYg==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-10-18T12:48:37Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2007-10-18T12:48:37Z"}, "message": "re PR fortran/33233 (Parent and contained procedure: Wrongly treated as generic procedures)\n\n2007-10-18  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/33233\n\t* resolve.c (check_host_association): Check singly contained\n\tnamespaces and start search for symbol in current namespace.\n\n2007-10-18  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/33233\n\t* gfortran.dg/host_assoc_function_1.f90: Correct references.\n\t* gfortran.dg/host_assoc_function_3.f90: New test.\n\nFrom-SVN: r129437", "tree": {"sha": "ec5ef02923b8c25783183f624b111244cb04dff8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ec5ef02923b8c25783183f624b111244cb04dff8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a944c79a88afb91706e4b29db4224981fe0c91eb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a944c79a88afb91706e4b29db4224981fe0c91eb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a944c79a88afb91706e4b29db4224981fe0c91eb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a944c79a88afb91706e4b29db4224981fe0c91eb/comments", "author": null, "committer": null, "parents": [{"sha": "a7f638eca471ae667d2aea8d634869d1f0809887", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7f638eca471ae667d2aea8d634869d1f0809887", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7f638eca471ae667d2aea8d634869d1f0809887"}], "stats": {"total": 50, "additions": 45, "deletions": 5}, "files": [{"sha": "3a736539789baf6cf550e02861445d131643039d", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=a944c79a88afb91706e4b29db4224981fe0c91eb", "patch": "@@ -1,3 +1,9 @@\n+2007-10-18  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/33233\n+\t* resolve.c (check_host_association): Check singly contained\n+\tnamespaces and start search for symbol in current namespace.\n+\n 2007-10-18  Paul Thomas  <pault@gcc.gnu.org>\n \t    Dominique d'Humieres  <dominiq@lps.ens.fr>\n "}, {"sha": "dffa76e0cff20dd11147f3f74584257fb13aa95c", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=a944c79a88afb91706e4b29db4224981fe0c91eb", "patch": "@@ -4014,11 +4014,12 @@ check_host_association (gfc_expr *e)\n     return retval;\n \n   if (gfc_current_ns->parent\n-\t&& gfc_current_ns->parent->parent\n \t&& old_sym->ns != gfc_current_ns)\n     {\n-      gfc_find_symbol (old_sym->name, gfc_current_ns->parent, 1, &sym);\n-      if (sym && old_sym != sym && sym->attr.flavor == FL_PROCEDURE)\n+      gfc_find_symbol (old_sym->name, gfc_current_ns, 1, &sym);\n+      if (sym && old_sym != sym\n+\t      && sym->attr.flavor == FL_PROCEDURE\n+\t      && sym->attr.contained)\n \t{\n \t  temp_locus = gfc_current_locus;\n \t  gfc_current_locus = e->where;"}, {"sha": "cbda26de31e884f71f4fcaf00a68ec7ad02a8476", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a944c79a88afb91706e4b29db4224981fe0c91eb", "patch": "@@ -1,3 +1,9 @@\n+2007-10-18  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/33233\n+\t* gfortran.dg/host_assoc_function_1.f90: Correct references.\n+\t* gfortran.dg/host_assoc_function_3.f90: New test.\n+\n 2007-10-18  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/33733"}, {"sha": "f80f97a27ab5b996b13207e16825388402c9e2fc", "filename": "gcc/testsuite/gfortran.dg/host_assoc_function_1.f90", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fhost_assoc_function_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fhost_assoc_function_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fhost_assoc_function_1.f90?ref=a944c79a88afb91706e4b29db4224981fe0c91eb", "patch": "@@ -19,8 +19,8 @@ real function z (i)\n   end interface\n CONTAINS\n   SUBROUTINE s\n-    if (x(2) .ne. 2.5) call abort ()\n-    if (z(3) .ne. real (3)**3) call abort ()\n+    if (x(2, 3) .ne. real (2)**3) call abort ()\n+    if (z(3, 3) .ne. real (3)**3) call abort ()\n     CALL inner\n   CONTAINS\n     SUBROUTINE inner"}, {"sha": "a83fa1738af5c7c4702b0f47d7b0d4c3402fd347", "filename": "gcc/testsuite/gfortran.dg/host_assoc_function_3.f90", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fhost_assoc_function_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a944c79a88afb91706e4b29db4224981fe0c91eb/gcc%2Ftestsuite%2Fgfortran.dg%2Fhost_assoc_function_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fhost_assoc_function_3.f90?ref=a944c79a88afb91706e4b29db4224981fe0c91eb", "patch": "@@ -0,0 +1,27 @@\n+! { dg-do run }\n+! Tests the fix for the bug PR33233, in which the reference to 'x'\n+! in 'inner' wrongly host-associated with the variable 'x' rather\n+! than the function.\n+!\n+! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n+!\n+MODULE m\n+  REAL :: x(3) = (/ 1.5, 2.5, 3.5 /)\n+CONTAINS\n+  SUBROUTINE s\n+    if (x(2) .eq. 2.5) call abort ()\n+  CONTAINS\n+    FUNCTION x(n, m)\n+      integer, optional :: m\n+      if (present(m)) then\n+        x = REAL(n)**m\n+      else\n+        x = 0.0\n+      end if\n+    END FUNCTION\n+  END SUBROUTINE s\n+END MODULE m\n+  use m\n+  call s\n+end\n+! { dg-final { cleanup-modules \"m\" } }"}]}