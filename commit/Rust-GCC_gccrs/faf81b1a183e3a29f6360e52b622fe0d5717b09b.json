{"sha": "faf81b1a183e3a29f6360e52b622fe0d5717b09b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmFmODFiMWExODNlM2EyOWY2MzYwZTUyYjYyMmZlMGQ1NzE3YjA5Yg==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2011-12-15T19:02:51Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2011-12-15T19:02:51Z"}, "message": "9780-2.cc: Add test for \"C\" locale, add sanity checks in case of grouping.\n\n2011-12-15  Benjamin Kosnik  <bkoz@redhat.com>\n\n        * testsuite/22_locale/num_put/put/char/9780-2.cc: Add test for \"C\"\n        locale, add sanity checks in case of grouping.\n\nFrom-SVN: r182385", "tree": {"sha": "74a52234f2adcd35759b23c579b466b0ed21d78b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/74a52234f2adcd35759b23c579b466b0ed21d78b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/faf81b1a183e3a29f6360e52b622fe0d5717b09b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/faf81b1a183e3a29f6360e52b622fe0d5717b09b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/faf81b1a183e3a29f6360e52b622fe0d5717b09b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/faf81b1a183e3a29f6360e52b622fe0d5717b09b/comments", "author": null, "committer": null, "parents": [{"sha": "a3fd80eade6e515fef7bce24e178dd4c986e6ae1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a3fd80eade6e515fef7bce24e178dd4c986e6ae1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a3fd80eade6e515fef7bce24e178dd4c986e6ae1"}], "stats": {"total": 60, "additions": 51, "deletions": 9}, "files": [{"sha": "38e0ff229cef5e24bcaef70549f0b5141c5b46c8", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/faf81b1a183e3a29f6360e52b622fe0d5717b09b/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/faf81b1a183e3a29f6360e52b622fe0d5717b09b/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=faf81b1a183e3a29f6360e52b622fe0d5717b09b", "patch": "@@ -1,3 +1,8 @@\n+2011-12-15  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\t* testsuite/22_locale/num_put/put/char/9780-2.cc: Add test for \"C\"\n+\tlocale, add sanity checks in case of grouping.\n+\n 2011-12-15  Jonathan Wakely  <jwakely.gcc@gmail.com>\n \n \tPR libstdc++/51540"}, {"sha": "5cf0d048a1cef7d688d27ff42d166983db838a18", "filename": "libstdc++-v3/testsuite/22_locale/num_put/put/char/9780-2.cc", "status": "modified", "additions": 46, "deletions": 9, "changes": 55, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/faf81b1a183e3a29f6360e52b622fe0d5717b09b/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_put%2Fput%2Fchar%2F9780-2.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/faf81b1a183e3a29f6360e52b622fe0d5717b09b/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_put%2Fput%2Fchar%2F9780-2.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fnum_put%2Fput%2Fchar%2F9780-2.cc?ref=faf81b1a183e3a29f6360e52b622fe0d5717b09b", "patch": "@@ -1,7 +1,7 @@\n // { dg-require-namedlocale \"de_DE\" }\n // { dg-require-namedlocale \"es_ES\" }\n \n-// Copyright (C) 2004, 2005, 2009 Free Software Foundation, Inc.\n+// Copyright (C) 2004, 2005, 2009, 2011 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -22,23 +22,60 @@\n #include <locale>\n #include <testsuite_hooks.h>\n \n-int main()\n+// Make sure that formatted output uses the locale in the output stream.\n+using namespace std;\n+locale l1 = locale(\"de_DE\");\n+const num_put<char>& np = use_facet<num_put<char> >(l1);\n+const numpunct<char>& npunct = use_facet<numpunct<char> >(l1);\n+\n+void test01()\n {\n-  using namespace std;\n+  bool test __attribute__((unused)) = true;\n+\n+  locale l2 = locale(\"C\");\n+  const numpunct<char>& npunct2 = use_facet<numpunct<char> >(l2);\n+  char c = npunct2.thousands_sep();\n+  string s = npunct2.grouping();\n+\n+  ostringstream oss;\n+  oss.imbue(l2);\n+\n+  long l = 1234567890;\n+  np.put(oss.rdbuf(), oss, ' ', l);\n+  string res = oss.str();\n+\n+  VERIFY( res == \"1234567890\" );\n+}\n \n+void test02()\n+{\n   bool test __attribute__((unused)) = true;\n-  locale l1 = locale(\"de_DE\");\n+\n   locale l2 = locale(\"es_ES\");\n-  \n-  const num_put<char>& np = use_facet<num_put<char> >(l1);  \n+  const numpunct<char>& npunct3 = use_facet<numpunct<char> >(l2);\n+  char c = npunct3.thousands_sep();\n+  string s = npunct3.grouping();\n+\n   ostringstream oss;\n   oss.imbue(l2);\n \n   long l = 1234567890;\n-  np.put(oss.rdbuf(), oss, ' ', l); // 1234567890\n+  np.put(oss.rdbuf(), oss, ' ', l);\n   string res = oss.str();\n-  \n-  VERIFY( res == \"1234567890\" );\n \n+  if (!s.empty())\n+    VERIFY( res == \"1.234.567.890\" );\n+  else\n+    VERIFY( res == \"1234567890\" );\n+}\n+\n+int main()\n+{\n+  // Sanity check.\n+  char c = npunct.thousands_sep();\n+  string s = npunct.grouping();\n+\n+  test01();\n+  test02();\n   return 0;\n }"}]}