{"sha": "5fd5c97a3458128c95577bbff190795f39e4cdfb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWZkNWM5N2EzNDU4MTI4Yzk1NTc3YmJmZjE5MDc5NWYzOWU0Y2RmYg==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2010-04-07T15:16:12Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2010-04-07T15:16:12Z"}, "message": "re PR c++/42697 (ice-on-legal-code: template class template function local objects)\n\nFix PR c++/42697\n\ngcc/cp/ChangeLog:\n\tPR c++/42697\n\t*pt.c (tsubst_decl): Get the arguments of a specialization from\n\tthe specialization template, not from the most general template.\n\ngcc/testsuite/ChangeLog:\n\tPR c++/42697\n\t* g++.dg/template/crash94.C: New test.\n\nFrom-SVN: r158068", "tree": {"sha": "5855473c06cc1ce2175bfc2d88f39aee807e5c62", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5855473c06cc1ce2175bfc2d88f39aee807e5c62"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5fd5c97a3458128c95577bbff190795f39e4cdfb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fd5c97a3458128c95577bbff190795f39e4cdfb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fd5c97a3458128c95577bbff190795f39e4cdfb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fd5c97a3458128c95577bbff190795f39e4cdfb/comments", "author": null, "committer": null, "parents": [{"sha": "7c094c11510e9a7bb99a9b2b2dd4f6087cedda3c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7c094c11510e9a7bb99a9b2b2dd4f6087cedda3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7c094c11510e9a7bb99a9b2b2dd4f6087cedda3c"}], "stats": {"total": 42, "additions": 41, "deletions": 1}, "files": [{"sha": "3d412443a7be567d126cd02594eeff148153a975", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=5fd5c97a3458128c95577bbff190795f39e4cdfb", "patch": "@@ -1,3 +1,9 @@\n+2010-04-07  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/42697\n+\t*pt.c (tsubst_decl): Get the arguments of a specialization from\n+\tthe specialization template, not from the most general template.\n+\n 2010-04-07  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/40239"}, {"sha": "13bb5aadf4d185bf74781d7e07217b7b15560567", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=5fd5c97a3458128c95577bbff190795f39e4cdfb", "patch": "@@ -9020,7 +9020,8 @@ tsubst_decl (tree t, tree args, tsubst_flags_t complain)\n \t       specialize R.  */\n \t    gen_tmpl = most_general_template (DECL_TI_TEMPLATE (t));\n \t    argvec = tsubst_template_args (DECL_TI_ARGS\n-\t\t\t\t\t   (DECL_TEMPLATE_RESULT (gen_tmpl)),\n+                                          (DECL_TEMPLATE_RESULT\n+                                                 (DECL_TI_TEMPLATE (t))),\n \t\t\t\t\t   args, complain, in_decl);\n \n \t    /* Check to see if we already have this specialization.  */"}, {"sha": "0032dd813b0d6b1df11003f8cee7f4dcbdb1dbbd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5fd5c97a3458128c95577bbff190795f39e4cdfb", "patch": "@@ -1,3 +1,8 @@\n+2010-04-07  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/42697\n+\t* g++.dg/template/crash94.C: New test.\n+\n 2010-04-07  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/40239"}, {"sha": "810aed0a61c6e97a1222e76130ad1f6e4e8fb382", "filename": "gcc/testsuite/g++.dg/template/crash94.C", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash94.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fd5c97a3458128c95577bbff190795f39e4cdfb/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash94.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash94.C?ref=5fd5c97a3458128c95577bbff190795f39e4cdfb", "patch": "@@ -0,0 +1,28 @@\n+// Origin: PR c++/42697\n+// { dg-do compile }\n+\n+template<class Value_t>\n+class fparser\n+{\n+    template<bool Option>\n+    void eval2(Value_t r[2]);\n+public:\n+    void evaltest();\n+};\n+\n+template<>\n+template<bool Option>\n+void fparser<int>::eval2(int r[2])\n+{\n+    struct ObjType {};\n+}\n+\n+\n+template<class Value_t>\n+void fparser<Value_t>::evaltest\n+    ()\n+{\n+    eval2<false>(0);\n+}\n+\n+template class fparser<int>;"}]}