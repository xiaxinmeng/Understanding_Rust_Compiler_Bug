{"sha": "0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGVmNWZiYzFmNGI0ZTM0ZTRiMDg0ZjViNTliMDg4NWJmYTMzMDBmYg==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2015-11-30T13:33:27Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2015-11-30T13:33:27Z"}, "message": "re PR fortran/68534 (No error on mismatch in number of arguments between submodule and module interface)\n\n2015-11-30  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/68534\n\t* decl.c (gfc_match_formal_arglist): Cope with zero formal args\n\teither in interface declaration or in procedure declaration in\n\tsubmodule.\n\n2015-11-30  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/68534\n\t* gfortran.dg/submodule_13.f08: New test.\n\nFrom-SVN: r231072", "tree": {"sha": "2b2cbae4d77a9f7243f7234671539d7495c7eb42", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2b2cbae4d77a9f7243f7234671539d7495c7eb42"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/comments", "author": null, "committer": null, "parents": [{"sha": "02718b323ba585f41a34e4202c9ca5ba1b3aa321", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02718b323ba585f41a34e4202c9ca5ba1b3aa321", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02718b323ba585f41a34e4202c9ca5ba1b3aa321"}], "stats": {"total": 69, "additions": 63, "deletions": 6}, "files": [{"sha": "c7c50647d006e488c177d36de4fa08af21586b1b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "patch": "@@ -1,3 +1,10 @@\n+2015-11-30  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/68534\n+\t* decl.c (gfc_match_formal_arglist): Cope with zero formal args\n+\teither in interface declaration or in procedure declaration in\n+\tsubmodule.\n+\n 2015-11-25  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/68227\n@@ -68,7 +75,7 @@\n \t* resolve.c (gfc_resolve_blocks): Handle EXEC_OACC_DECLARE.\n \t* st.c (gfc_free_statement): Handle EXEC_OACC_DECLARE.\n \t* symbol.c (check_conflict): Add conflict checks.\n-\t(gfc_add_oacc_declare_create, gfc_add_oacc_declare_copyin, \n+\t(gfc_add_oacc_declare_create, gfc_add_oacc_declare_copyin,\n \tgfc_add_oacc_declare_deviceptr, gfc_add_oacc_declare_device_resident):\n \tNew functions.\n \t(gfc_copy_attr): Handle new symbols.\n@@ -84,7 +91,7 @@\n 2015-11-21  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \t* simplify.c (gfc_simplify_cshift): Work around bootstrap issues\n-\tdue to inappropriate warning options. \n+\tdue to inappropriate warning options.\n \n 2015-11-21  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n@@ -93,7 +100,7 @@\n \t(gfc_simplify_spread): Remove a FIXME and add error condition.\n \t* intrinsic.h: Prototype for gfc_simplify_cshift\n \t* intrinsic.c (add_functions): Use gfc_simplify_cshift.\n- \n+\n 2015-11-20  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/68237"}, {"sha": "10a08e0591be64e91c7be490ee00fb5408665667", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 16, "deletions": 3, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "patch": "@@ -4817,14 +4817,23 @@ gfc_match_formal_arglist (gfc_symbol *progname, int st_flag, int null_flag)\n       goto cleanup;\n     }\n \n-  if (formal)\n+  if (progname->attr.module_procedure && progname->attr.host_assoc)\n     {\n+      bool arg_count_mismatch = false;\n+\n+      if (!formal && head)\n+\targ_count_mismatch = true;\n+\n+      /* Abbreviated module procedure declaration is not meant to have any\n+\t formal arguments!  */\n+      if (!sym->abr_modproc_decl && formal && !head)\n+\targ_count_mismatch = true;\n+\n       for (p = formal, q = head; p && q; p = p->next, q = q->next)\n \t{\n \t  if ((p->next != NULL && q->next == NULL)\n \t      || (p->next == NULL && q->next != NULL))\n-\t    gfc_error_now (\"Mismatch in number of MODULE PROCEDURE \"\n-\t\t           \"formal arguments at %C\");\n+\t    arg_count_mismatch = true;\n \t  else if ((p->sym == NULL && q->sym == NULL)\n \t\t    || strcmp (p->sym->name, q->sym->name) == 0)\n \t    continue;\n@@ -4833,6 +4842,10 @@ gfc_match_formal_arglist (gfc_symbol *progname, int st_flag, int null_flag)\n \t\t\t   \"argument names (%s/%s) at %C\",\n \t\t\t   p->sym->name, q->sym->name);\n \t}\n+\n+      if (arg_count_mismatch)\n+\tgfc_error_now (\"Mismatch in number of MODULE PROCEDURE \"\n+\t\t       \"formal arguments at %C\");\n     }\n \n   return MATCH_YES;"}, {"sha": "805d7943d2570fa810568253a1a972bd6c316636", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "patch": "@@ -1,3 +1,8 @@\n+2015-11-30  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/68534\n+\t* gfortran.dg/submodule_13.f08: New test.\n+\n 2015-11-30  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n \n \t* gcc.target/s390/load-relative-check.c: Add scan patterns for"}, {"sha": "6a4d2ad113e5e440d6b62d96df7a9260ac8c4341", "filename": "gcc/testsuite/gfortran.dg/submodule_13.f08", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fsubmodule_13.f08", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb/gcc%2Ftestsuite%2Fgfortran.dg%2Fsubmodule_13.f08", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fsubmodule_13.f08?ref=0ef5fbc1f4b4e34e4b084f5b59b0885bfa3300fb", "patch": "@@ -0,0 +1,32 @@\n+! { dg-do compile }\n+!\n+! Checks the fix for PR68534 in which checks for the number\n+! failed if either the interface or the module procedure had\n+! no dummies.\n+!\n+! Reported on clf at:\n+! https://groups.google.com/forum/#!topic/comp.lang.fortran/-ZgbM5qkFmc\n+!\n+module m\n+  implicit none\n+    interface\n+      module subroutine foo()\n+      end subroutine foo\n+\n+      module subroutine bar(i)\n+        integer, intent(inout) :: i\n+      end subroutine bar\n+   end interface\n+end module m\n+\n+submodule(m) sm\n+contains\n+  module subroutine foo(i) ! { dg-error \"Mismatch in number of MODULE PROCEDURE formal\" }\n+    integer, intent(inout) :: i\n+    i = 42\n+  end subroutine foo\n+\n+  module subroutine bar ! { dg-error \"Mismatch in number of MODULE PROCEDURE formal\" }\n+    print *, \"bar\"\n+  end subroutine bar\n+end submodule sm"}]}