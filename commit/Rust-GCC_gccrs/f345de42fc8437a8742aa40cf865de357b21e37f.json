{"sha": "f345de42fc8437a8742aa40cf865de357b21e37f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjM0NWRlNDJmYzg0MzdhODc0MmFhNDBjZjg2NWRlMzU3YjIxZTM3Zg==", "commit": {"author": {"name": "Jeffrey A Law", "email": "law@cygnus.com", "date": "1997-08-27T19:59:51Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-08-27T19:59:51Z"}, "message": "reorg.c (dbr_schedule): Allow current_function_return_rtx to be something other than a REG.\n\n        * reorg.c (dbr_schedule): Allow current_function_return_rtx\n        to be something other than a REG.\n        * function.c (expand_function_end): Fix current_function_return_rtx\n        if it was a pseudo.\nBrought over from the fsf/devo.\n\nFrom-SVN: r14972", "tree": {"sha": "7d1359bf6a618db548e998e24f753e012f4a0dbd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d1359bf6a618db548e998e24f753e012f4a0dbd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f345de42fc8437a8742aa40cf865de357b21e37f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f345de42fc8437a8742aa40cf865de357b21e37f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f345de42fc8437a8742aa40cf865de357b21e37f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f345de42fc8437a8742aa40cf865de357b21e37f/comments", "author": null, "committer": null, "parents": [{"sha": "67f68fd265af43b2ebeb3d478f71da0389763a98", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67f68fd265af43b2ebeb3d478f71da0389763a98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67f68fd265af43b2ebeb3d478f71da0389763a98"}], "stats": {"total": 21, "additions": 15, "deletions": 6}, "files": [{"sha": "93a2c91b263bb949c646b6873ef8856e47100640", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f345de42fc8437a8742aa40cf865de357b21e37f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f345de42fc8437a8742aa40cf865de357b21e37f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f345de42fc8437a8742aa40cf865de357b21e37f", "patch": "@@ -29,6 +29,11 @@ Wed Aug 27 01:24:25 1997  H.J. Lu   (hjl@gnu.ai.mit.edu)\n \n Wed Aug 27 00:49:14 1997  Jeffrey A Law  (law@cygnus.com)\n \n+\t* reorg.c (dbr_schedule): Allow current_function_return_rtx\n+\tto be something other than a REG.\n+\t* function.c (expand_function_end): Fix current_function_return_rtx\n+\tif it was a pseudo.\n+\n \t* t-freebsd (USER_H): Include EXTRA_HEADERS and LANG_EXTRA_HEADERS.\n \t* x-netbsd: Likewise\n \t* x-dgux (USER_H): Include EXTRA_HEADERS and LANG_EXTRA_HEADERS"}, {"sha": "644cc72eb53b6ff412c7183d6fd317d733f58afc", "filename": "gcc/function.c", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f345de42fc8437a8742aa40cf865de357b21e37f/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f345de42fc8437a8742aa40cf865de357b21e37f/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=f345de42fc8437a8742aa40cf865de357b21e37f", "patch": "@@ -191,10 +191,10 @@ CUMULATIVE_ARGS current_function_args_info;\n \n char *current_function_name;\n \n-/* If non-zero, an RTL expression for that location at which the current\n-   function returns its result.  Always equal to\n-   DECL_RTL (DECL_RESULT (current_function_decl)), but provided\n-   independently of the tree structures.  */\n+/* If non-zero, an RTL expression for the location at which the current \n+   function returns its result.  If the current function returns its\n+   result in a register, current_function_return_rtx will always be\n+   the hard register containing the result.  */\n \n rtx current_function_return_rtx;\n \n@@ -5692,6 +5692,11 @@ expand_function_end (filename, line, end_bindings)\n       emit_move_insn (real_decl_result,\n \t\t      DECL_RTL (DECL_RESULT (current_function_decl)));\n       emit_insn (gen_rtx (USE, VOIDmode, real_decl_result));\n+\n+      /* The delay slot scheduler assumes that current_function_return_rtx\n+\t holds the hard register containing the return value, not a temporary\n+\t pseudo.  */\n+      current_function_return_rtx = real_decl_result;\n     }\n \n   /* If returning a structure, arrange to return the address of the value"}, {"sha": "3686907ded4e607a4129e5d22af4deea7bcd824e", "filename": "gcc/reorg.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f345de42fc8437a8742aa40cf865de357b21e37f/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f345de42fc8437a8742aa40cf865de357b21e37f/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=f345de42fc8437a8742aa40cf865de357b21e37f", "patch": "@@ -4492,8 +4492,7 @@ dbr_schedule (first, file)\n   else\n     SET_HARD_REG_BIT (end_of_function_needs.regs, STACK_POINTER_REGNUM);\n \n-  if (current_function_return_rtx != 0\n-      && GET_CODE (current_function_return_rtx) == REG)\n+  if (current_function_return_rtx != 0)\n     mark_referenced_resources (current_function_return_rtx,\n \t\t\t       &end_of_function_needs, 1);\n "}]}