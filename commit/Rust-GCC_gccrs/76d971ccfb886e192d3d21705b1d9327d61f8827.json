{"sha": "76d971ccfb886e192d3d21705b1d9327d61f8827", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzZkOTcxY2NmYjg4NmUxOTJkM2QyMTcwNWIxZDkzMjdkNjFmODgyNw==", "commit": {"author": {"name": "Nathan Froyd", "email": "froydnj@codesourcery.com", "date": "2010-06-18T15:49:55Z"}, "committer": {"name": "Nathan Froyd", "email": "froydnj@gcc.gnu.org", "date": "2010-06-18T15:49:55Z"}, "message": "tree.h (record_layout_info): Change type of pending_statics field to a VEC.\n\n\t* tree.h (record_layout_info): Change type of pending_statics field\n\tto a VEC.\n\t* stor-layout.c (start_record_layout): Store NULL into\n\tpending_statics.\n\t(debug_rli): Call debug_vec_tree instead of debug_tree.\n\t(place_field): Likewise.\n\t(finish_record_layout): Likewise.\n\nFrom-SVN: r161000", "tree": {"sha": "bf77ef78c9c1fda781e7ea74231e6b5dc0d22d25", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bf77ef78c9c1fda781e7ea74231e6b5dc0d22d25"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/76d971ccfb886e192d3d21705b1d9327d61f8827", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76d971ccfb886e192d3d21705b1d9327d61f8827", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76d971ccfb886e192d3d21705b1d9327d61f8827", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76d971ccfb886e192d3d21705b1d9327d61f8827/comments", "author": null, "committer": null, "parents": [{"sha": "d4fc0fb47f2fbc0910178660cffdf6f0b209fad9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4fc0fb47f2fbc0910178660cffdf6f0b209fad9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4fc0fb47f2fbc0910178660cffdf6f0b209fad9"}], "stats": {"total": 35, "additions": 23, "deletions": 12}, "files": [{"sha": "ef71ff7d304c31fe66103b573f34e53e29808531", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76d971ccfb886e192d3d21705b1d9327d61f8827/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76d971ccfb886e192d3d21705b1d9327d61f8827/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=76d971ccfb886e192d3d21705b1d9327d61f8827", "patch": "@@ -1,3 +1,13 @@\n+2010-06-18  Nathan Froyd  <froydnj@codesourcery.com>\n+\n+\t* tree.h (record_layout_info): Change type of pending_statics field\n+\tto a VEC.\n+\t* stor-layout.c (start_record_layout): Store NULL into\n+\tpending_statics.\n+\t(debug_rli): Call debug_vec_tree instead of debug_tree.\n+\t(place_field): Likewise.\n+\t(finish_record_layout): Likewise.\n+\n 2010-06-18  Alan Modra  <amodra@gmail.com>\n \n \t* config/rs6000/linux64.h (SET_CMODEL): Don't expand to empty."}, {"sha": "7e144325a55ab07db48071d1f1b3b7d58cb47f2a", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76d971ccfb886e192d3d21705b1d9327d61f8827/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76d971ccfb886e192d3d21705b1d9327d61f8827/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=76d971ccfb886e192d3d21705b1d9327d61f8827", "patch": "@@ -743,7 +743,7 @@ start_record_layout (tree t)\n   rli->offset = size_zero_node;\n   rli->bitpos = bitsize_zero_node;\n   rli->prev_field = 0;\n-  rli->pending_statics = 0;\n+  rli->pending_statics = NULL;\n   rli->packed_maybe_necessary = 0;\n   rli->remaining_in_alignment = 0;\n \n@@ -827,10 +827,12 @@ debug_rli (record_layout_info rli)\n   if (rli->packed_maybe_necessary)\n     fprintf (stderr, \"packed may be necessary\\n\");\n \n-  if (rli->pending_statics)\n+  if (!VEC_empty (tree, rli->pending_statics))\n     {\n+      unsigned ix;\n+      tree t;\n       fprintf (stderr, \"pending statics:\\n\");\n-      debug_tree (rli->pending_statics);\n+      debug_vec_tree (rli->pending_statics);\n     }\n }\n \n@@ -1041,8 +1043,7 @@ place_field (record_layout_info rli, tree field)\n      it *after* the record is laid out.  */\n   if (TREE_CODE (field) == VAR_DECL)\n     {\n-      rli->pending_statics = tree_cons (NULL_TREE, field,\n-\t\t\t\t\trli->pending_statics);\n+      VEC_safe_push (tree, gc, rli->pending_statics, field);\n       return;\n     }\n \n@@ -1718,15 +1719,15 @@ finish_record_layout (record_layout_info rli, int free_p)\n \n   /* Lay out any static members.  This is done now because their type\n      may use the record's type.  */\n-  while (rli->pending_statics)\n-    {\n-      layout_decl (TREE_VALUE (rli->pending_statics), 0);\n-      rli->pending_statics = TREE_CHAIN (rli->pending_statics);\n-    }\n+  while (!VEC_empty (tree, rli->pending_statics))\n+    layout_decl (VEC_pop (tree, rli->pending_statics), 0);\n \n   /* Clean up.  */\n   if (free_p)\n-    free (rli);\n+    {\n+      VEC_free (tree, gc, rli->pending_statics);\n+      free (rli);\n+    }\n }\n \f\n "}, {"sha": "80f97eeb46f45df68127bd6537e99c1648c4675b", "filename": "gcc/tree.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76d971ccfb886e192d3d21705b1d9327d61f8827/gcc%2Ftree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76d971ccfb886e192d3d21705b1d9327d61f8827/gcc%2Ftree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.h?ref=76d971ccfb886e192d3d21705b1d9327d61f8827", "patch": "@@ -4334,7 +4334,7 @@ typedef struct record_layout_info_s\n   tree prev_field;\n   /* The static variables (i.e., class variables, as opposed to\n      instance variables) encountered in T.  */\n-  tree pending_statics;\n+  VEC(tree,gc) *pending_statics;\n   /* Bits remaining in the current alignment group */\n   int remaining_in_alignment;\n   /* True if we've seen a packed field that didn't have normal"}]}