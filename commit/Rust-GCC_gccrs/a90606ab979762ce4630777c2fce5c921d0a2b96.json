{"sha": "a90606ab979762ce4630777c2fce5c921d0a2b96", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTkwNjA2YWI5Nzk3NjJjZTQ2MzA3NzdjMmZjZTVjOTIxZDBhMmI5Ng==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-12-01T08:41:16Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-12-01T08:41:16Z"}, "message": "c++, debug: Treat -std=c++20 -gdwarf-5 like C++14 rather than C++98\n\nI have noticed that while we use DW_LANG_C_plus_plus_14 for -std=c++17 -gdwarf-5,\nwe use DW_LANG_C_plus_plus (aka C++98) for -std=c++20 -gdwarf-5.  The\nfollowing patch makes those two match.\n\n2020-12-01  Jakub Jelinek  <jakub@redhat.com>\n\n\t* dwarf2out.c (gen_compile_unit_die): Treat GNU C++20\n\tlike C++14 for -gdwarf-5.\n\n\t* g++.dg/debug/dwarf2/lang-cpp17.C: New test.\n\t* g++.dg/debug/dwarf2/lang-cpp20.C: New test.", "tree": {"sha": "f2253e5c4373b240d056f2c7084d9877505ecb73", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f2253e5c4373b240d056f2c7084d9877505ecb73"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a90606ab979762ce4630777c2fce5c921d0a2b96", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a90606ab979762ce4630777c2fce5c921d0a2b96", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a90606ab979762ce4630777c2fce5c921d0a2b96", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a90606ab979762ce4630777c2fce5c921d0a2b96/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "934a54180541d27139aecbd19e7f50cb73552c7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/934a54180541d27139aecbd19e7f50cb73552c7c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/934a54180541d27139aecbd19e7f50cb73552c7c"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "0a0a7ead2eae547c841fa8d31b21a1ddcd3429ed", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a90606ab979762ce4630777c2fce5c921d0a2b96/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a90606ab979762ce4630777c2fce5c921d0a2b96/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=a90606ab979762ce4630777c2fce5c921d0a2b96", "patch": "@@ -24646,7 +24646,8 @@ gen_compile_unit_die (const char *filename)\n \t    language = DW_LANG_C_plus_plus_11;\n \t  else if (strcmp (language_string, \"GNU C++14\") == 0)\n \t    language = DW_LANG_C_plus_plus_14;\n-\t  else if (strcmp (language_string, \"GNU C++17\") == 0)\n+\t  else if (strcmp (language_string, \"GNU C++17\") == 0\n+\t\t   || strcmp (language_string, \"GNU C++20\") == 0)\n \t    /* For now.  */\n \t    language = DW_LANG_C_plus_plus_14;\n \t}"}, {"sha": "460294ca27d4520ce98637f75c75a36e2c3bca9e", "filename": "gcc/testsuite/g++.dg/debug/dwarf2/lang-cpp17.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a90606ab979762ce4630777c2fce5c921d0a2b96/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Flang-cpp17.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a90606ab979762ce4630777c2fce5c921d0a2b96/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Flang-cpp17.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Flang-cpp17.C?ref=a90606ab979762ce4630777c2fce5c921d0a2b96", "patch": "@@ -0,0 +1,7 @@\n+// { dg-do compile }\n+// { dg-options \"-O -std=c++17 -gdwarf-5 -dA\" }\n+// For -gdwarf-6 hopefully DW_LANG_C_plus_plus_17\n+// DW_LANG_C_plus_plus_14 = 0x0021\n+// { dg-final { scan-assembler \"0x21\\[^\\n\\r]* DW_AT_language\" } } */\n+\n+int version;"}, {"sha": "abd7351e4de2bf3bebb62e0bbf7042a756735d43", "filename": "gcc/testsuite/g++.dg/debug/dwarf2/lang-cpp20.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a90606ab979762ce4630777c2fce5c921d0a2b96/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Flang-cpp20.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a90606ab979762ce4630777c2fce5c921d0a2b96/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Flang-cpp20.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fdwarf2%2Flang-cpp20.C?ref=a90606ab979762ce4630777c2fce5c921d0a2b96", "patch": "@@ -0,0 +1,7 @@\n+// { dg-do compile }\n+// { dg-options \"-O -std=c++20 -gdwarf-5 -dA\" }\n+// For -gdwarf-6 hopefully DW_LANG_C_plus_plus_20\n+// DW_LANG_C_plus_plus_14 = 0x0021\n+// { dg-final { scan-assembler \"0x21\\[^\\n\\r]* DW_AT_language\" } } */\n+\n+int version;"}]}