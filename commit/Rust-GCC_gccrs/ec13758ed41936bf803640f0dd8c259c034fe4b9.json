{"sha": "ec13758ed41936bf803640f0dd8c259c034fe4b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWMxMzc1OGVkNDE5MzZiZjgwMzY0MGYwZGQ4YzI1OWMwMzRmZTRiOQ==", "commit": {"author": {"name": "Martin Uecker", "email": "muecker@gwdg.de", "date": "2020-12-16T22:43:42Z"}, "committer": {"name": "Martin Uecker", "email": "muecker@gwdg.de", "date": "2020-12-16T22:43:42Z"}, "message": "C: Avoid incorrect warning for volatile in compound expressions [PR98260]\n\n2020-12-16  Martin Uecker  <muecker@gwdg.de>\n\ngcc/c/\n\tPR c/98260\n\t* c-parser.c (c_parser_expression): Look into\n\tnop expression when marking expressions as read.\n\ngcc/testsuite/\n\tPR c/98260\n\t* gcc.dg/unused-9.c: New test.", "tree": {"sha": "2cd876d31542cee9d6818f0151887fd3f6aea753", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2cd876d31542cee9d6818f0151887fd3f6aea753"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ec13758ed41936bf803640f0dd8c259c034fe4b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec13758ed41936bf803640f0dd8c259c034fe4b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec13758ed41936bf803640f0dd8c259c034fe4b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec13758ed41936bf803640f0dd8c259c034fe4b9/comments", "author": {"login": "uecker", "id": 2036635, "node_id": "MDQ6VXNlcjIwMzY2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/2036635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/uecker", "html_url": "https://github.com/uecker", "followers_url": "https://api.github.com/users/uecker/followers", "following_url": "https://api.github.com/users/uecker/following{/other_user}", "gists_url": "https://api.github.com/users/uecker/gists{/gist_id}", "starred_url": "https://api.github.com/users/uecker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/uecker/subscriptions", "organizations_url": "https://api.github.com/users/uecker/orgs", "repos_url": "https://api.github.com/users/uecker/repos", "events_url": "https://api.github.com/users/uecker/events{/privacy}", "received_events_url": "https://api.github.com/users/uecker/received_events", "type": "User", "site_admin": false}, "committer": {"login": "uecker", "id": 2036635, "node_id": "MDQ6VXNlcjIwMzY2MzU=", "avatar_url": "https://avatars.githubusercontent.com/u/2036635?v=4", "gravatar_id": "", "url": "https://api.github.com/users/uecker", "html_url": "https://github.com/uecker", "followers_url": "https://api.github.com/users/uecker/followers", "following_url": "https://api.github.com/users/uecker/following{/other_user}", "gists_url": "https://api.github.com/users/uecker/gists{/gist_id}", "starred_url": "https://api.github.com/users/uecker/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/uecker/subscriptions", "organizations_url": "https://api.github.com/users/uecker/orgs", "repos_url": "https://api.github.com/users/uecker/repos", "events_url": "https://api.github.com/users/uecker/events{/privacy}", "received_events_url": "https://api.github.com/users/uecker/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "64a54505ec8249178b9767d1420354f8eb55de50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/64a54505ec8249178b9767d1420354f8eb55de50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/64a54505ec8249178b9767d1420354f8eb55de50"}], "stats": {"total": 23, "additions": 21, "deletions": 2}, "files": [{"sha": "b9fdc90274eff79a0e6aaca0436ad0471aa8d3e6", "filename": "gcc/c/c-parser.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec13758ed41936bf803640f0dd8c259c034fe4b9/gcc%2Fc%2Fc-parser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec13758ed41936bf803640f0dd8c259c034fe4b9/gcc%2Fc%2Fc-parser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-parser.c?ref=ec13758ed41936bf803640f0dd8c259c034fe4b9", "patch": "@@ -10615,8 +10615,14 @@ c_parser_expression (c_parser *parser)\n       c_parser_consume_token (parser);\n       expr_loc = c_parser_peek_token (parser)->location;\n       lhsval = expr.value;\n-      while (TREE_CODE (lhsval) == COMPOUND_EXPR)\n-\tlhsval = TREE_OPERAND (lhsval, 1);\n+      while (TREE_CODE (lhsval) == COMPOUND_EXPR\n+\t     || TREE_CODE (lhsval) == NOP_EXPR)\n+\t{\n+\t  if (TREE_CODE (lhsval) == COMPOUND_EXPR)\n+\t    lhsval = TREE_OPERAND (lhsval, 1);\n+\t  else\n+\t    lhsval = TREE_OPERAND (lhsval, 0);\n+\t}\n       if (DECL_P (lhsval) || handled_component_p (lhsval))\n \tmark_exp_read (lhsval);\n       next = c_parser_expr_no_commas (parser, NULL);"}, {"sha": "bdf36e1f50e83eadaa1352fdc5bd1d1b5f7096d4", "filename": "gcc/testsuite/gcc.dg/unused-9.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec13758ed41936bf803640f0dd8c259c034fe4b9/gcc%2Ftestsuite%2Fgcc.dg%2Funused-9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec13758ed41936bf803640f0dd8c259c034fe4b9/gcc%2Ftestsuite%2Fgcc.dg%2Funused-9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Funused-9.c?ref=ec13758ed41936bf803640f0dd8c259c034fe4b9", "patch": "@@ -0,0 +1,13 @@\n+/* PR c/98260 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wunused\" } */\n+\n+\n+void g(void)\n+{\n+  int i = 0;\n+  volatile int x;\n+  (x, i++);\t/* { dg-bogus \"set but not used\" } */\n+}\n+\n+"}]}