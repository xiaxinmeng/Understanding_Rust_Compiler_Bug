{"sha": "0ba09d8fc65f306909c11b68c67030a3c6ca13c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGJhMDlkOGZjNjVmMzA2OTA5YzExYjY4YzY3MDMwYTNjNmNhMTNjMg==", "commit": {"author": {"name": "Bryce McKinlay", "email": "mckinlay@redhat.com", "date": "2004-10-10T16:19:37Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2004-10-10T16:19:37Z"}, "message": "Calendar.java (set): Invalidate DST_OFFSET field as a DST boundary may have been crossed.\n\n2004-10-08  Bryce McKinlay  <mckinlay@redhat.com>\n\n\t* java/util/Calendar.java (set): Invalidate DST_OFFSET\n\tfield as a DST boundary may have been crossed.\n\t* java/util/GregorianCalendar.java (add): Throw\n\tIllegalArgumentException on attempt to add to DST_OFFSET or\n\tZONE_OFFSET fields. Update javadoc.\n\nFrom-SVN: r88847", "tree": {"sha": "24be0ef56d3c74ad47155697e7641564c0c6fad0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/24be0ef56d3c74ad47155697e7641564c0c6fad0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ba09d8fc65f306909c11b68c67030a3c6ca13c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ba09d8fc65f306909c11b68c67030a3c6ca13c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ba09d8fc65f306909c11b68c67030a3c6ca13c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ba09d8fc65f306909c11b68c67030a3c6ca13c2/comments", "author": null, "committer": null, "parents": [{"sha": "711f836923656e4f736eb4a743f0960ade959ff6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/711f836923656e4f736eb4a743f0960ade959ff6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/711f836923656e4f736eb4a743f0960ade959ff6"}], "stats": {"total": 31, "additions": 20, "deletions": 11}, "files": [{"sha": "f46c28306602166e1dd3d8f397d6bd3b97f9f4ba", "filename": "libjava/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ba09d8fc65f306909c11b68c67030a3c6ca13c2/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ba09d8fc65f306909c11b68c67030a3c6ca13c2/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=0ba09d8fc65f306909c11b68c67030a3c6ca13c2", "patch": "@@ -1,3 +1,11 @@\n+2004-10-08  Bryce McKinlay  <mckinlay@redhat.com>\n+\n+\t* java/util/Calendar.java (set): Invalidate DST_OFFSET\n+\tfield as a DST boundary may have been crossed.\n+\t* java/util/GregorianCalendar.java (add): Throw \n+\tIllegalArgumentException on attempt to add to DST_OFFSET or \n+\tZONE_OFFSET fields. Update javadoc.\n+\n 2004-10-09  Michael Koch  <konqueror@gmx.de>\n \n \t* java/io/CharArrayWriter.java"}, {"sha": "6e9eda92a7394ab60f0dbf0161b68d4db4e4c80c", "filename": "libjava/java/util/Calendar.java", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ba09d8fc65f306909c11b68c67030a3c6ca13c2/libjava%2Fjava%2Futil%2FCalendar.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ba09d8fc65f306909c11b68c67030a3c6ca13c2/libjava%2Fjava%2Futil%2FCalendar.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2FCalendar.java?ref=0ba09d8fc65f306909c11b68c67030a3c6ca13c2", "patch": "@@ -651,6 +651,10 @@ public void set(int field, int value)\n \tisSet[HOUR_OF_DAY] = false;\n \tbreak;\n       }\n+\n+    // May have crossed over a DST boundary.\n+    if (field != DST_OFFSET && field != ZONE_OFFSET)\n+      isSet[DST_OFFSET] = false;\n   }\n \n   /**\n@@ -671,6 +675,8 @@ public final void set(int year, int month, int date)\n     isSet[WEEK_OF_MONTH] = false;\n     isSet[DAY_OF_WEEK] = false;\n     isSet[DAY_OF_WEEK_IN_MONTH] = false;\n+\n+    isSet[DST_OFFSET] = false;  // May have crossed a DST boundary.\n   }\n \n   /**"}, {"sha": "2504f60342763f9f89c1f33790a564fe43ef7d55", "filename": "libjava/java/util/GregorianCalendar.java", "status": "modified", "additions": 6, "deletions": 11, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ba09d8fc65f306909c11b68c67030a3c6ca13c2/libjava%2Fjava%2Futil%2FGregorianCalendar.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ba09d8fc65f306909c11b68c67030a3c6ca13c2/libjava%2Fjava%2Futil%2FGregorianCalendar.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Futil%2FGregorianCalendar.java?ref=0ba09d8fc65f306909c11b68c67030a3c6ca13c2", "patch": "@@ -540,7 +540,7 @@ private void calculateDay(int day, boolean gregorian)\n     fields[DAY_OF_WEEK] = weekday;\n \n     // get a first approximation of the year.  This may be one \n-    // year to big.\n+    // year too big.\n     int year = 1970 + (gregorian\n \t\t       ? ((day - 100) * 400) / (365 * 400 + 100 - 4 + 1)\n \t\t       : ((day - 100) * 4) / (365 * 4 + 1));\n@@ -709,6 +709,10 @@ public boolean equals(Object o)\n    * it does what you expect: Jan, 25 + 10 Days is Feb, 4.\n    * @param field the time field. One of the time field constants.\n    * @param amount the amount of time.\n+   * @exception IllegalArgumentException if <code>field</code> is \n+   *   <code>ZONE_OFFSET</code>, <code>DST_OFFSET</code>, or invalid; or\n+   *   if <code>amount</code> contains an out-of-range value and the calendar\n+   *   is not in lenient mode.\n    */\n   public void add(int field, int amount)\n   {\n@@ -785,18 +789,9 @@ public void add(int field, int amount)\n \tareFieldsSet = false;\n \tbreak;\n       case ZONE_OFFSET:\n-\tcomplete();\n-\tfields[ZONE_OFFSET] += amount;\n-\ttime -= amount;\n-\tbreak;\n       case DST_OFFSET:\n-\tcomplete();\n-\tfields[DST_OFFSET] += amount;\n-\tisTimeSet = false;\n-\tbreak;\n       default:\n-\tthrow new IllegalArgumentException\n-\t  (\"Unknown Calendar field: \" + field);\n+\tthrow new IllegalArgumentException(\"Invalid or unknown field\");\n       }\n   }\n "}]}