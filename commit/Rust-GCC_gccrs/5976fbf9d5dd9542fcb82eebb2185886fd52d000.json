{"sha": "5976fbf9d5dd9542fcb82eebb2185886fd52d000", "node_id": "C_kwDOANBUbNoAKDU5NzZmYmY5ZDVkZDk1NDJmY2I4MmVlYmIyMTg1ODg2ZmQ1MmQwMDA", "commit": {"author": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2022-09-20T20:41:48Z"}, "committer": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2022-09-20T20:41:48Z"}, "message": "Fortran: error recovery on invalid ARRAY argument to FINDLOC [PR106986]\n\ngcc/fortran/ChangeLog:\n\n\tPR fortran/106986\n\t* simplify.cc (gfc_simplify_findloc): Do not try to simplify\n\tintrinsic FINDLOC when the ARRAY argument has a NULL shape.\n\ngcc/testsuite/ChangeLog:\n\n\tPR fortran/106986\n\t* gfortran.dg/pr106986.f90: New test.", "tree": {"sha": "af107cfe56108ec38bf35db35bbfd934c3078fe9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/af107cfe56108ec38bf35db35bbfd934c3078fe9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5976fbf9d5dd9542fcb82eebb2185886fd52d000", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5976fbf9d5dd9542fcb82eebb2185886fd52d000", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5976fbf9d5dd9542fcb82eebb2185886fd52d000", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5976fbf9d5dd9542fcb82eebb2185886fd52d000/comments", "author": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8dbb15bc2d019488240c1e69d93121b0347ac092", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8dbb15bc2d019488240c1e69d93121b0347ac092", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8dbb15bc2d019488240c1e69d93121b0347ac092"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "c0fbd0ed7c255152b55e5208096294c2fd449d4f", "filename": "gcc/fortran/simplify.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5976fbf9d5dd9542fcb82eebb2185886fd52d000/gcc%2Ffortran%2Fsimplify.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5976fbf9d5dd9542fcb82eebb2185886fd52d000/gcc%2Ffortran%2Fsimplify.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsimplify.cc?ref=5976fbf9d5dd9542fcb82eebb2185886fd52d000", "patch": "@@ -5895,6 +5895,7 @@ gfc_simplify_findloc (gfc_expr *array, gfc_expr *value, gfc_expr *dim,\n   bool back_val = false;\n \n   if (!is_constant_array_expr (array)\n+      || array->shape == NULL\n       || !gfc_is_constant_expr (dim))\n     return NULL;\n "}, {"sha": "a309b25d181ca06d331af1dd37c011114841ef85", "filename": "gcc/testsuite/gfortran.dg/pr106986.f90", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5976fbf9d5dd9542fcb82eebb2185886fd52d000/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr106986.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5976fbf9d5dd9542fcb82eebb2185886fd52d000/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr106986.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr106986.f90?ref=5976fbf9d5dd9542fcb82eebb2185886fd52d000", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+! PR fortran/106986 - ICE in simplify_findloc_nodim\n+! Contributed by G.Steinmetz\n+\n+program p\n+  integer, parameter :: a(:) = [1] ! { dg-error \"deferred shape\" }\n+  print *, findloc (a, 1)\n+end"}]}