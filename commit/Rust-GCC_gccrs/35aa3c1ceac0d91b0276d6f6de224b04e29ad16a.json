{"sha": "35aa3c1ceac0d91b0276d6f6de224b04e29ad16a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzVhYTNjMWNlYWMwZDkxYjAyNzZkNmY2ZGUyMjRiMDRlMjlhZDE2YQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2002-03-02T13:53:38Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2002-03-02T13:53:38Z"}, "message": "sparc.c (sparc_initialize_trampoline): Use trunc_int_for_mode.\n\n\t* config/sparc/sparc.c (sparc_initialize_trampoline): Use\n\ttrunc_int_for_mode.\n\nFrom-SVN: r50226", "tree": {"sha": "b1775d6b204a02ba6f675a078644bd0fb81d0d4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1775d6b204a02ba6f675a078644bd0fb81d0d4a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a/comments", "author": null, "committer": null, "parents": [{"sha": "f6041ed87e746b78a13232fec0b658b662191276", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6041ed87e746b78a13232fec0b658b662191276", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6041ed87e746b78a13232fec0b658b662191276"}], "stats": {"total": 61, "additions": 33, "deletions": 28}, "files": [{"sha": "2b395d39785ac99ccec67da6a31bd03880be4057", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=35aa3c1ceac0d91b0276d6f6de224b04e29ad16a", "patch": "@@ -1,5 +1,8 @@\n Sat Mar  2 06:30:14 2002  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n+\t* config/sparc/sparc.c (sparc_initialize_trampoline): Use\n+\ttrunc_int_for_mode.\n+\n \t* emit-rtl.c (offset_address): Call update_temp_slot_address.\n \n 2002-03-01  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>"}, {"sha": "e101fa7a0acbfb25c8a5841b6dee88bbd3ff82a2", "filename": "gcc/config/sparc/sparc.c", "status": "modified", "additions": 30, "deletions": 28, "changes": 58, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a/gcc%2Fconfig%2Fsparc%2Fsparc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35aa3c1ceac0d91b0276d6f6de224b04e29ad16a/gcc%2Fconfig%2Fsparc%2Fsparc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.c?ref=35aa3c1ceac0d91b0276d6f6de224b04e29ad16a", "patch": "@@ -6263,37 +6263,39 @@ sparc_initialize_trampoline (tramp, fnaddr, cxt)\n                      0, VOIDmode, 1, tramp, Pmode);\n #endif\n \n-  emit_move_insn (gen_rtx_MEM (SImode, plus_constant (tramp, 0)),\n-\t\t  expand_binop (SImode, ior_optab,\n-\t\t\t\texpand_shift (RSHIFT_EXPR, SImode, fnaddr,\n-\t\t\t\t\t      size_int (10), 0, 1),\n-\t\t\t\tGEN_INT (0x03000000),\n-\t\t\t\tNULL_RTX, 1, OPTAB_DIRECT));\n+  emit_move_insn\n+    (gen_rtx_MEM (SImode, plus_constant (tramp, 0)),\n+     expand_binop (SImode, ior_optab,\n+\t\t   expand_shift (RSHIFT_EXPR, SImode, fnaddr,\n+\t\t\t\t size_int (10), 0, 1),\n+\t\t   GEN_INT (trunc_int_for_mode (0x03000000, SImode)),\n+\t\t   NULL_RTX, 1, OPTAB_DIRECT));\n+\n+  emit_move_insn\n+    (gen_rtx_MEM (SImode, plus_constant (tramp, 4)),\n+     expand_binop (SImode, ior_optab,\n+\t\t   expand_shift (RSHIFT_EXPR, SImode, cxt,\n+\t\t\t\t size_int (10), 0, 1),\n+\t\t   GEN_INT (trunc_int_for_mode (0x05000000, SImode)),\n+\t\t   NULL_RTX, 1, OPTAB_DIRECT));\n+\n+  emit_move_insn\n+    (gen_rtx_MEM (SImode, plus_constant (tramp, 8)),\n+     expand_binop (SImode, ior_optab,\n+\t\t   expand_and (SImode, fnaddr, GEN_INT (0x3ff), NULL_RTX),\n+\t\t   GEN_INT (trunc_int_for_mode (0x81c06000, SImode)),\n+\t\t   NULL_RTX, 1, OPTAB_DIRECT));\n+\n+  emit_move_insn\n+    (gen_rtx_MEM (SImode, plus_constant (tramp, 12)),\n+     expand_binop (SImode, ior_optab,\n+\t\t   expand_and (SImode, cxt, GEN_INT (0x3ff), NULL_RTX),\n+\t\t   GEN_INT (trunc_int_for_mode (0x8410a000, SImode)),\n+\t\t   NULL_RTX, 1, OPTAB_DIRECT));\n \n-  emit_move_insn (gen_rtx_MEM (SImode, plus_constant (tramp, 4)),\n-\t\t  expand_binop (SImode, ior_optab,\n-\t\t\t\texpand_shift (RSHIFT_EXPR, SImode, cxt,\n-\t\t\t\t\t      size_int (10), 0, 1),\n-\t\t\t\tGEN_INT (0x05000000),\n-\t\t\t\tNULL_RTX, 1, OPTAB_DIRECT));\n-\n-  emit_move_insn (gen_rtx_MEM (SImode, plus_constant (tramp, 8)),\n-\t\t  expand_binop (SImode, ior_optab,\n-\t\t\t\texpand_and (SImode, fnaddr, GEN_INT (0x3ff),\n-\t\t\t\t\t    NULL_RTX),\n-\t\t\t\tGEN_INT (0x81c06000),\n-\t\t\t\tNULL_RTX, 1, OPTAB_DIRECT));\n-\n-  emit_move_insn (gen_rtx_MEM (SImode, plus_constant (tramp, 12)),\n-\t\t  expand_binop (SImode, ior_optab,\n-\t\t\t\texpand_and (SImode, cxt, GEN_INT (0x3ff),\n-\t\t\t\t\t    NULL_RTX),\n-\t\t\t\tGEN_INT (0x8410a000),\n-\t\t\t\tNULL_RTX, 1, OPTAB_DIRECT));\n-\n-  emit_insn (gen_flush (validize_mem (gen_rtx_MEM (SImode, tramp))));\n   /* On UltraSPARC a flush flushes an entire cache line.  The trampoline is\n      aligned on a 16 byte boundary so one flush clears it all.  */\n+  emit_insn (gen_flush (validize_mem (gen_rtx_MEM (SImode, tramp))));\n   if (sparc_cpu != PROCESSOR_ULTRASPARC)\n     emit_insn (gen_flush (validize_mem (gen_rtx_MEM (SImode,\n \t\t\t\t\t\t     plus_constant (tramp, 8)))));"}]}