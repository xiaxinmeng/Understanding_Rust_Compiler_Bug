{"sha": "efd40fc4161967fa7e0503f12162c8b28c85d632", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWZkNDBmYzQxNjE5NjdmYTdlMDUwM2YxMjE2MmM4YjI4Yzg1ZDYzMg==", "commit": {"author": {"name": "Roland McGrath", "email": "roland@gnu.org", "date": "2015-10-18T10:33:37Z"}, "committer": {"name": "Iain Sandoe", "email": "iains@gcc.gnu.org", "date": "2015-10-18T10:33:37Z"}, "message": "Fix PR63758 by using the _NSGetEnviron() API on Darwin\n\ninclude/\n\n\tRoland McGrath  <roland@gnu.org>\n\n\tPR other/63758\n\t* environ.h: New file.\n\nlibiberty/\n\n\tRoland McGrath  <roland@gnu.org>\n\tIain Sandoe  <iain@codesourcery.com>\n\n\tPR other/63758\n\t* pex-unix.c: Obtain the environment interface from settings in environ.h\n\trather than in-line code.  Update copyright date.\n\t* setenv.c: Likewise.\n\t* xmalloc.c: Likewise.\n\n\n\nCo-Authored-By: Iain Sandoe <iain@codesourcery.com>\n\nFrom-SVN: r228942", "tree": {"sha": "5fc208bc3baf41e825404c97445ff45b58f1f042", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5fc208bc3baf41e825404c97445ff45b58f1f042"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/efd40fc4161967fa7e0503f12162c8b28c85d632", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/efd40fc4161967fa7e0503f12162c8b28c85d632", "html_url": "https://github.com/Rust-GCC/gccrs/commit/efd40fc4161967fa7e0503f12162c8b28c85d632", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/efd40fc4161967fa7e0503f12162c8b28c85d632/comments", "author": null, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "37341412a50d7389802039e1890df3dca717b9db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37341412a50d7389802039e1890df3dca717b9db", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37341412a50d7389802039e1890df3dca717b9db"}], "stats": {"total": 67, "additions": 55, "deletions": 12}, "files": [{"sha": "583a2e193ef198e27eee525dfedd3035a511e4b4", "filename": "include/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efd40fc4161967fa7e0503f12162c8b28c85d632/include%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efd40fc4161967fa7e0503f12162c8b28c85d632/include%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/include%2FChangeLog?ref=efd40fc4161967fa7e0503f12162c8b28c85d632", "patch": "@@ -1,3 +1,8 @@\n+2015-10-18  Roland McGrath  <roland@gnu.org>\n+\n+\tPR other/63758\n+\t* environ.h: New file.\n+\n 2015-10-13  Jakub Jelinek  <jakub@redhat.com>\n \t    Ilya Verbin  <ilya.verbin@intel.com>\n "}, {"sha": "c18902ba5b4fb19d97ccbf5f6eb2d746497c1808", "filename": "include/environ.h", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efd40fc4161967fa7e0503f12162c8b28c85d632/include%2Fenviron.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efd40fc4161967fa7e0503f12162c8b28c85d632/include%2Fenviron.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/include%2Fenviron.h?ref=efd40fc4161967fa7e0503f12162c8b28c85d632", "patch": "@@ -0,0 +1,33 @@\n+/* Declare the environ system variable.\n+   Copyright (C) 2015 Free Software Foundation, Inc.\n+\n+This file is part of the libiberty library.\n+Libiberty is free software; you can redistribute it and/or\n+modify it under the terms of the GNU Library General Public\n+License as published by the Free Software Foundation; either\n+version 2 of the License, or (at your option) any later version.\n+\n+Libiberty is distributed in the hope that it will be useful,\n+but WITHOUT ANY WARRANTY; without even the implied warranty of\n+MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n+Library General Public License for more details.\n+\n+You should have received a copy of the GNU Library General Public\n+License along with libiberty; see the file COPYING.LIB.  If not,\n+write to the Free Software Foundation, Inc., 51 Franklin Street - Fifth Floor,\n+Boston, MA 02110-1301, USA.  */\n+\n+/* On OSX, the environ variable can be used directly in the code of an\n+   executable, but cannot be used in the code of a shared library (such as\n+   GCC's liblto_plugin, which links in libiberty code).  Instead, the\n+   function _NSGetEnviron can be called to get the address of environ.  */\n+\n+#ifndef HAVE_ENVIRON_DECL\n+#  ifdef __APPLE__\n+#     include <crt_externs.h>\n+#     define environ (*_NSGetEnviron ())\n+#  else\n+extern char **environ;\n+#  endif\n+#  define HAVE_ENVIRON_DECL\n+#endif"}, {"sha": "3fe0f69fac5d1535a8434f8fdd30f21a10b6458e", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=efd40fc4161967fa7e0503f12162c8b28c85d632", "patch": "@@ -1,3 +1,12 @@\n+2015-10-18  Roland McGrath  <roland@gnu.org>\n+\t    Iain Sandoe  <iain@codesourcery.com>\n+\n+\tPR other/63758\n+\t* pex-unix.c: Obtain the environment interface from settings in\n+\tenviron.h rather than in-line code.  Update copyright date.\n+\t* setenv.c: Likewise.\n+\t* xmalloc.c: Likewise.\n+\n 2015-09-30  Jason Merrill  <jason@redhat.com>\n \n \t* cp-demangle.c (d_cv_qualifiers): Dx means transaction_safe."}, {"sha": "b48f315f83fa9b744426bd3f89acfce0f72e861a", "filename": "libiberty/pex-unix.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2Fpex-unix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2Fpex-unix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fpex-unix.c?ref=efd40fc4161967fa7e0503f12162c8b28c85d632", "patch": "@@ -2,7 +2,7 @@\n    with other subprocesses), and wait for it.  Generic Unix version\n    (also used for UWIN and VMS).\n    Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2003, 2004, 2005, 2009,\n-   2010 Free Software Foundation, Inc.\n+   2010, 2015 Free Software Foundation, Inc.\n \n This file is part of the libiberty library.\n Libiberty is free software; you can redistribute it and/or\n@@ -23,6 +23,7 @@ Boston, MA 02110-1301, USA.  */\n #include \"config.h\"\n #include \"libiberty.h\"\n #include \"pex-common.h\"\n+#include \"environ.h\"\n \n #include <stdio.h>\n #include <signal.h>\n@@ -390,8 +391,6 @@ pex_child_error (struct pex_obj *obj, const char *executable,\n \n /* Execute a child.  */\n \n-extern char **environ;\n-\n #if defined(HAVE_SPAWNVE) && defined(HAVE_SPAWNVPE)\n /* Implementation of pex->exec_child using the Cygwin spawn operation.  */\n "}, {"sha": "5b51193319de57d81f8f7f9c751175850f107819", "filename": "libiberty/setenv.c", "status": "modified", "additions": 3, "deletions": 7, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2Fsetenv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2Fsetenv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fsetenv.c?ref=efd40fc4161967fa7e0503f12162c8b28c85d632", "patch": "@@ -1,5 +1,5 @@\n-/* Copyright (C) 1992, 1995, 1996, 1997, 2002, 2011 Free Software Foundation,\n-   Inc.\n+/* Copyright (C) 1992, 1995, 1996, 1997, 2002, 2011, 2015\n+   Free Software Foundation, Inc.\n    This file based on setenv.c in the GNU C Library.\n \n    The GNU C Library is free software; you can redistribute it and/or\n@@ -62,11 +62,7 @@ extern int errno;\n #endif\n \n #define __environ\tenviron\n-#ifndef HAVE_ENVIRON_DECL\n-#ifndef environ\n-extern char **environ;\n-#endif\n-#endif\n+#include \"environ.h\"\n \n #undef setenv\n #undef unsetenv"}, {"sha": "f849aee53e28c8581e662c872c9931bdbcca2b91", "filename": "libiberty/xmalloc.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2Fxmalloc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/efd40fc4161967fa7e0503f12162c8b28c85d632/libiberty%2Fxmalloc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fxmalloc.c?ref=efd40fc4161967fa7e0503f12162c8b28c85d632", "patch": "@@ -1,5 +1,6 @@\n /* memory allocation routines with error checking.\n-   Copyright 1989, 90, 91, 92, 93, 94 Free Software Foundation, Inc.\n+   Copyright 1989, 1990, 1991, 1992, 1993, 1994, 2015\n+   Free Software Foundation, Inc.\n    \n This file is part of the libiberty library.\n Libiberty is free software; you can redistribute it and/or\n@@ -65,6 +66,7 @@ function will be called to print an error message and terminate execution.\n #endif\n #include \"ansidecl.h\"\n #include \"libiberty.h\"\n+#include \"environ.h\"\n \n #include <stdio.h>\n \n@@ -117,7 +119,6 @@ void\n xmalloc_failed (size_t size)\n {\n #ifdef HAVE_SBRK\n-  extern char **environ;\n   size_t allocated;\n \n   if (first_break != NULL)"}]}