{"sha": "b6da85666d4180adde474902aa289b512ccc8c2e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjZkYTg1NjY2ZDQxODBhZGRlNDc0OTAyYWEyODliNTEyY2NjOGMyZQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-03-27T12:15:55Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-03-27T12:15:55Z"}, "message": "Removed __NetBSD__ from conditional.\n\nDeclare strerror if HAVE_STRERROR is defined; otherwise declare sys_errlist\nand sys_nerr.\n(my_strerror): New function.\n\nFrom-SVN: r9233", "tree": {"sha": "7640943335a154835dc0824122ea7a27871ec853", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7640943335a154835dc0824122ea7a27871ec853"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b6da85666d4180adde474902aa289b512ccc8c2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6da85666d4180adde474902aa289b512ccc8c2e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6da85666d4180adde474902aa289b512ccc8c2e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6da85666d4180adde474902aa289b512ccc8c2e/comments", "author": null, "committer": null, "parents": [{"sha": "08fb8ad0d5dc96ee07b4a1a8187dae5fc4b0304d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08fb8ad0d5dc96ee07b4a1a8187dae5fc4b0304d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08fb8ad0d5dc96ee07b4a1a8187dae5fc4b0304d"}], "stats": {"total": 34, "additions": 30, "deletions": 4}, "files": [{"sha": "5fd2b9ef317505ca691e4090919b6c0384241135", "filename": "gcc/gcc.c", "status": "modified", "additions": 30, "deletions": 4, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6da85666d4180adde474902aa289b512ccc8c2e/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6da85666d4180adde474902aa289b512ccc8c2e/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=b6da85666d4180adde474902aa289b512ccc8c2e", "patch": "@@ -171,11 +171,15 @@ extern int errno;\n #endif\n \n extern int sys_nerr;\n-#if defined(bsd4_4) || defined(__NetBSD__)\n+#ifndef HAVE_STRERROR\n+#if defined(bsd4_4)\n extern const char *const sys_errlist[];\n #else\n extern char *sys_errlist[];\n #endif\n+#else\n+extern char *strerror();\n+#endif\n \n extern int execv (), execvp ();\n \n@@ -1102,6 +1106,28 @@ translate_options (argcp, argvp)\n   *argcp = newindex;\n }\n \f\n+char *\n+my_strerror(e)\n+     int e;\n+{\n+\n+#ifdef HAVE_STRERROR\n+  return strerror(e);\n+\n+#else\n+\n+  static char buffer[30];\n+  if (!e)\n+    return \"\";\n+\n+  if (e > 0 && e < sys_nerr)\n+    return sys_errlist[e];\n+\n+  sprintf (buffer, \"Unknown error %d\", e);\n+  return buffer;\n+#endif\n+}\n+\f\n /* Read compilation specs from a file named FILENAME,\n    replacing the default ones.\n \n@@ -4800,7 +4826,7 @@ pfatal_with_name (name)\n   char *s;\n \n   if (errno < sys_nerr)\n-    s = concat (\"%s: \", sys_errlist[errno]);\n+    s = concat (\"%s: \", my_strerror( errno ));\n   else\n     s = \"cannot open %s\";\n   fatal (s, name);\n@@ -4813,7 +4839,7 @@ perror_with_name (name)\n   char *s;\n \n   if (errno < sys_nerr)\n-    s = concat (\"%s: \", sys_errlist[errno]);\n+    s = concat (\"%s: \", my_strerror( errno ));\n   else\n     s = \"cannot open %s\";\n   error (s, name);\n@@ -4826,7 +4852,7 @@ perror_exec (name)\n   char *s;\n \n   if (errno < sys_nerr)\n-    s = concat (\"installation problem, cannot exec %s: \", sys_errlist[errno]);\n+    s = concat (\"installation problem, cannot exec %s: \", my_strerror( errno ));\n   else\n     s = \"installation problem, cannot exec %s\";\n   error (s, name);"}]}