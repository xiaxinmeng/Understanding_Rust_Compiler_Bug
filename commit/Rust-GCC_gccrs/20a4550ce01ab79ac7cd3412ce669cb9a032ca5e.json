{"sha": "20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjBhNDU1MGNlMDFhYjc5YWM3Y2QzNDEyY2U2NjljYjlhMDMyY2E1ZQ==", "commit": {"author": {"name": "Fran\u00e7ois Dumont", "email": "fdumont@gcc.gnu.org", "date": "2019-03-08T05:37:50Z"}, "committer": {"name": "Fran\u00e7ois Dumont", "email": "fdumont@gcc.gnu.org", "date": "2019-03-08T05:37:50Z"}, "message": "re PR libstdc++/89608 (Undetected iterator invalidations on unordered containers in debug mode)\n\n2019-03-08  Fran\u00e7ois Dumont  <fdumont@gcc.gnu.org>\n\n\tPR libstdc++/89608\n\t* include/debug/unordered_map (unordered_map<>::_M_check_rehashed):\n\tInvalidate all iterators in case of rehash.\n\t(unordered_multimap<>::_M_check_rehashed): Likewise.\n\t* include/debug/unordered_set\n\t(unordered_set<>::_M_check_rehashed): Likewise.\n\t(unordered_multiset<>::_M_check_rehashed): Likewise.\n\t* testsuite/23_containers/unordered_set/debug/89608_neg.cc: New.\n\nFrom-SVN: r269478", "tree": {"sha": "fc7c9c8d2b2323fb8861e5b7845c5e2b0ec0a53a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc7c9c8d2b2323fb8861e5b7845c5e2b0ec0a53a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/comments", "author": null, "committer": null, "parents": [{"sha": "bddee796d0b4800b5ac3d7e7e9e315c23799424d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bddee796d0b4800b5ac3d7e7e9e315c23799424d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bddee796d0b4800b5ac3d7e7e9e315c23799424d"}], "stats": {"total": 56, "additions": 52, "deletions": 4}, "files": [{"sha": "d98a591f3a36edbb2cbc9024795d772c0401526c", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "patch": "@@ -1,3 +1,14 @@\n+2019-03-08  Fran\u00e7ois Dumont  <fdumont@gcc.gnu.org>\n+\n+\tPR libstdc++/89608\n+\t* include/debug/unordered_map (unordered_map<>::_M_check_rehashed):\n+\tInvalidate all iterators in case of rehash.\n+\t(unordered_multimap<>::_M_check_rehashed): Likewise.\n+\t* include/debug/unordered_set\n+\t(unordered_set<>::_M_check_rehashed): Likewise.\n+\t(unordered_multiset<>::_M_check_rehashed): Likewise.\n+\t* testsuite/23_containers/unordered_set/debug/89608_neg.cc: New.\n+\n 2019-03-07  Andreas Schwab  <schwab@suse.de>\n \n \t* config/abi/post/riscv64-linux-gnu: New directory."}, {"sha": "0a7485d6e18e8787916f12cc18aa1cc6e24c5480", "filename": "libstdc++-v3/include/debug/unordered_map", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Funordered_map", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Funordered_map", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Funordered_map?ref=20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "patch": "@@ -611,7 +611,7 @@ namespace __debug\n       _M_check_rehashed(size_type __prev_count)\n       {\n \tif (__prev_count != this->bucket_count())\n-\t  this->_M_invalidate_locals();\n+\t  this->_M_invalidate_all();\n       }\n \n       void\n@@ -1210,7 +1210,7 @@ namespace __debug\n       _M_check_rehashed(size_type __prev_count)\n       {\n \tif (__prev_count != this->bucket_count())\n-\t  this->_M_invalidate_locals();\n+\t  this->_M_invalidate_all();\n       }\n \n       void"}, {"sha": "a593143aa93872fe45f5309a5f77cc45536aab7e", "filename": "libstdc++-v3/include/debug/unordered_set", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Funordered_set", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Funordered_set", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Funordered_set?ref=20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "patch": "@@ -496,7 +496,7 @@ namespace __debug\n       _M_check_rehashed(size_type __prev_count)\n       {\n \tif (__prev_count != this->bucket_count())\n-\t  this->_M_invalidate_locals();\n+\t  this->_M_invalidate_all();\n       }\n \n       void\n@@ -1050,7 +1050,7 @@ namespace __debug\n       _M_check_rehashed(size_type __prev_count)\n       {\n \tif (__prev_count != this->bucket_count())\n-\t  this->_M_invalidate_locals();\n+\t  this->_M_invalidate_all();\n       }\n \n       void"}, {"sha": "871b1c3381dd8df6aa7d7d5e3b6df7dcfdfa9b6e", "filename": "libstdc++-v3/testsuite/23_containers/unordered_set/debug/89608_neg.cc", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_set%2Fdebug%2F89608_neg.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/20a4550ce01ab79ac7cd3412ce669cb9a032ca5e/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_set%2Fdebug%2F89608_neg.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_set%2Fdebug%2F89608_neg.cc?ref=20a4550ce01ab79ac7cd3412ce669cb9a032ca5e", "patch": "@@ -0,0 +1,37 @@\n+// Copyright (C) 2019 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+//\n+// { dg-do run { target c++11 xfail *-*-* } }\n+// { dg-require-debug-mode \"\" }\n+\n+// PR libstdc++/89608\n+\n+#include <unordered_set>\n+\n+int main()\n+{\n+  std::unordered_set<int> myset;\n+  myset.reserve(2);\n+  myset.insert(0);\n+  myset.insert(1);\n+\n+  int i = 2;\n+  for (auto it = myset.begin(), end = myset.end(); it != end; ++it)\n+    myset.insert(i++);\n+\n+  return 0;\n+}"}]}