{"sha": "54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTRlZTk3OTk3YTRlOWI1YTU0YWU4Y2JjNzY1ZWMxMGRhMGMxYTQyNQ==", "commit": {"author": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2001-10-29T21:29:30Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2001-10-29T21:29:30Z"}, "message": "Undo assemble_name change in earlier patch.\n\nFrom-SVN: r46617", "tree": {"sha": "edc942936d3f5f4a78e0d940e7dc38438f0ce341", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/edc942936d3f5f4a78e0d940e7dc38438f0ce341"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/comments", "author": null, "committer": null, "parents": [{"sha": "26e51caa4d5c885118c3b0ce9e07e77178029d4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26e51caa4d5c885118c3b0ce9e07e77178029d4b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26e51caa4d5c885118c3b0ce9e07e77178029d4b"}], "stats": {"total": 77, "additions": 60, "deletions": 17}, "files": [{"sha": "5cd6c8db334db1e2540f933ad06360290a40bace", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "patch": "@@ -1,9 +1,13 @@\n+2001-10-29  David Edelsohn  <edelsohn@gnu.org>\n+\n+\tUndo assemble_name change in earlier patch.\n+\n Mon Oct 29 21:11:40 2001  Nicola Pero  <n.pero@mi.flashnet.it>\n \t\n \t* objc/objc-act.c (finish_message_expr): For the GNU runtime: when\n \tdetermining the type of the receiver, do not check that TREE_CODE\n-\tof receiver is CALL_EXPR before calling receiver_is_class_object\n-\t().  (receiver_is_class_object): For the GNU runtime: recognize\n+\tof receiver is CALL_EXPR before calling receiver_is_class_object().\n+\t(receiver_is_class_object): For the GNU runtime: recognize\n \tthe case that the receiver is self in a class method context.\n \tCheck that TREE_CODE of receiver is CALL_EXPR when checking that\n \tthe receiver is a call to objc_get_class."}, {"sha": "1156b1eb0d4314d7d4b6ffda4ae19f25334dc69e", "filename": "gcc/config/rs6000/aix31.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Faix31.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Faix31.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Faix31.h?ref=54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "patch": "@@ -45,7 +45,7 @@ Boston, MA 02111-1307, USA.  */\n   if (TREE_CODE (DECL) == FUNCTION_DECL)\t\\\n     {\t\t\t\t\t\t\\\n       fputs (\"\\n\\t.extern .\", FILE);\t\t\\\n-      assemble_name (FILE, XSTR (_symref, 0));\t\\\n+      RS6000_OUTPUT_BASENAME (FILE, XSTR (_symref, 0));\t\\\n     }\t\t\t\t\t\t\\\n   putc ('\\n', FILE);\t\t\t\t\\\n }"}, {"sha": "768f4d77e27cb7102a9cdc497f812cc4508c8190", "filename": "gcc/config/rs6000/darwin.h", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin.h?ref=54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "patch": "@@ -79,6 +79,12 @@ Boston, MA 02111-1307, USA.  */\n #undef REGISTER_NAMES\n #define REGISTER_NAMES DEBUG_REGISTER_NAMES\n \n+/* This outputs NAME to FILE.  */\n+\n+#undef  RS6000_OUTPUT_BASENAME\n+#define RS6000_OUTPUT_BASENAME(FILE, NAME)\t\\\n+    assemble_name (FILE, NAME);\n+\n /* Output before instructions.  */\n /* This is how to output the definition of a user-level label named NAME,\n    such as the label on a static function or variable NAME.  */\n@@ -92,7 +98,7 @@ Boston, MA 02111-1307, USA.  */\n #undef ASM_GLOBALIZE_LABEL\n #define ASM_GLOBALIZE_LABEL(FILE,NAME)\t\\\n   do { fputs (\"\\t.globl \", FILE);\t\\\n-       assemble_name (FILE, NAME); putc ('\\n', FILE);} while (0)\n+       RS6000_OUTPUT_BASENAME (FILE, NAME); putc ('\\n', FILE);} while (0)\n \n /* This is how to output an internal label prefix.  rs6000.c uses this\n    when generating traceback tables.  */\n@@ -116,7 +122,7 @@ Boston, MA 02111-1307, USA.  */\n #undef  ASM_OUTPUT_ALIGNED_COMMON\n #define ASM_OUTPUT_COMMON(FILE, NAME, SIZE, ROUNDED)\t\\\n   do { fputs (\".comm \", (FILE));\t\t\t\\\n-       assemble_name ((FILE), (NAME));\t\t\\\n+       RS6000_OUTPUT_BASENAME ((FILE), (NAME));\t\t\\\n        fprintf ((FILE), \",%d\\n\", (SIZE)); } while (0)\n \n #define ASM_OUTPUT_SKIP(FILE,SIZE)  \\"}, {"sha": "117bb180ff55a9c37954d2765d1b551e6f45ae9b", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 20, "deletions": 2, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "patch": "@@ -4691,7 +4691,11 @@ print_operand (file, x, code)\n \t      break;\n \t    }\n \t}\n+#if TARGET_AIX\n+      RS6000_OUTPUT_BASENAME (file, XSTR (x, 0));\n+#else\n       assemble_name (file, XSTR (x, 0));\n+#endif\n       return;\n \n     case 'Z':\n@@ -7045,9 +7049,17 @@ rs6000_output_function_epilogue (file, size)\n       /* Offset from start of code to tb table.  */\n       fputs (\"\\t.long \", file);\n       ASM_OUTPUT_INTERNAL_LABEL_PREFIX (file, \"LT\");\n+#if TARGET_AIX\n+      RS6000_OUTPUT_BASENAME (file, fname);\n+#else\n       assemble_name (file, fname);\n+#endif\n       fputs (\"-.\", file);\n+#if TARGET_AIX\n+      RS6000_OUTPUT_BASENAME (file, fname);\n+#else\n       assemble_name (file, fname);\n+#endif\n       putc ('\\n', file);\n \n       /* Interrupt handler mask.  */\n@@ -7464,7 +7476,13 @@ rs6000_output_symbol_ref (file, x)\n      we emit the TOC reference to reference the symbol and not the\n      section.  */\n   const char *name = XSTR (x, 0);\n-  assemble_name (file, name);\n+\n+  if (VTABLE_NAME_P (name)) \n+    {\n+      RS6000_OUTPUT_BASENAME (file, name);\n+    }\n+  else\n+    assemble_name (file, name);\n }\n \n /* Output a TOC entry.  We derive the entry name from what is being\n@@ -7697,7 +7715,7 @@ output_toc (file, x, labelno, mode)\n      section.  */\n   if (VTABLE_NAME_P (name))\n     {\n-      assemble_name (file, name);\n+      RS6000_OUTPUT_BASENAME (file, name);\n       if (offset < 0)\n \tfprintf (file, \"%d\", offset);\n       else if (offset > 0)"}, {"sha": "0a24cc30be4849d083a407d3c55d2189b9f2217f", "filename": "gcc/config/rs6000/sysv4.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Fsysv4.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Fsysv4.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fsysv4.h?ref=54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "patch": "@@ -886,6 +886,11 @@ do {\t\t\t\t\t\t\t\t\t\\\n #undef\tENCODE_SECTION_INFO\n #define\tENCODE_SECTION_INFO(DECL) rs6000_encode_section_info (DECL)\n \n+/* The ELF version doesn't encode [DS] or whatever at the end of symbols.  */\n+\n+#define\tRS6000_OUTPUT_BASENAME(FILE, NAME)\t\\\n+    assemble_name (FILE, NAME)\n+\n /* This macro gets just the user-specified name\n    out of the string in a SYMBOL_REF.  Discard\n    a leading * or @.  */"}, {"sha": "558560fb2ceccf8ab40bd6d09840c0f03578db5d", "filename": "gcc/config/rs6000/xcoff.h", "status": "modified", "additions": 20, "deletions": 10, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Fxcoff.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54ee97997a4e9b5a54ae8cbc765ec10da0c1a425/gcc%2Fconfig%2Frs6000%2Fxcoff.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fxcoff.h?ref=54ee97997a4e9b5a54ae8cbc765ec10da0c1a425", "patch": "@@ -231,18 +231,28 @@ toc_section ()\t\t\t\t\t\t\\\n #define RS6000_ITRUNC \"__itrunc\"\n #define RS6000_UITRUNC \"__uitrunc\"\n \n+/* This outputs NAME to FILE up to the first null or '['.  */\n+\n+#define RS6000_OUTPUT_BASENAME(FILE, NAME)\t\\\n+  {\t\t\t\t\t\t\\\n+    const char *_p;\t\t\t\t\\\n+\t\t\t\t\t\t\\\n+    STRIP_NAME_ENCODING (_p, (NAME));\t\t\\\n+    assemble_name ((FILE), _p);\t\t\t\\\n+  }\n+\n /* This is how to output the definition of a user-level label named NAME,\n    such as the label on a static function or variable NAME.  */\n \n #define ASM_OUTPUT_LABEL(FILE,NAME)\t\\\n-  do { assemble_name (FILE, NAME); fputs (\":\\n\", FILE); } while (0)\n+  do { RS6000_OUTPUT_BASENAME (FILE, NAME); fputs (\":\\n\", FILE); } while (0)\n \n /* This is how to output a command to make the user-level label named NAME\n    defined for reference from other files.  */\n \n #define ASM_GLOBALIZE_LABEL(FILE,NAME)\t\\\n   do { fputs (\"\\t.globl \", FILE);\t\\\n-       assemble_name (FILE, NAME); putc ('\\n', FILE);} while (0)\n+       RS6000_OUTPUT_BASENAME (FILE, NAME); putc ('\\n', FILE);} while (0)\n \n /* Remove any trailing [DS] or the like from the symbol name.  */\n \n@@ -333,27 +343,27 @@ toc_section ()\t\t\t\t\t\t\\\n   if (TREE_PUBLIC (DECL))\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\\\n       fputs (\"\\t.globl .\", FILE);\t\t\t\t\\\n-      assemble_name (FILE, NAME);\t\t\t\t\\\n+      RS6000_OUTPUT_BASENAME (FILE, NAME);\t\t\t\\\n       putc ('\\n', FILE);\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\\\n       fputs (\"\\t.lglobl .\", FILE);\t\t\t\t\\\n-      assemble_name (FILE, NAME);\t\t\t\t\\\n+      RS6000_OUTPUT_BASENAME (FILE, NAME);\t\t\t\\\n       putc ('\\n', FILE);\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\\\n   fputs (\"\\t.csect \", FILE);\t\t\t\t\t\\\n-  assemble_name (FILE, NAME);\t\t\t\t\t\\\n+  RS6000_OUTPUT_BASENAME (FILE, NAME);\t\t\t\t\\\n   fputs (TARGET_32BIT ? \"[DS]\\n\" : \"[DS],3\\n\", FILE);\t\t\\\n-  assemble_name (FILE, NAME);\t\t\t\t\t\\\n+  RS6000_OUTPUT_BASENAME (FILE, NAME);\t\t\t\t\\\n   fputs (\":\\n\", FILE);\t\t\t\t\t\t\\\n   fputs (TARGET_32BIT ? \"\\t.long .\" : \"\\t.llong .\", FILE);\t\\\n-  assemble_name (FILE, NAME);\t\t\t\t\t\\\n+  RS6000_OUTPUT_BASENAME (FILE, NAME);\t\t\t\t\\\n   fputs (\", TOC[tc0], 0\\n\", FILE);\t\t\t\t\\\n   in_section = no_section;\t\t\t\t\t\\\n   function_section(DECL);\t\t\t\t\t\\\n   putc ('.', FILE);\t\t\t\t\t\t\\\n-  assemble_name (FILE, NAME);\t\t\t\t\t\\\n+  RS6000_OUTPUT_BASENAME (FILE, NAME);\t\t\t\t\\\n   fputs (\":\\n\", FILE);\t\t\t\t\t\t\\\n   if (write_symbols == XCOFF_DEBUG)\t\t\t\t\\\n     xcoffout_declare_function (FILE, DECL, NAME);\t\t\\\n@@ -421,7 +431,7 @@ toc_section ()\t\t\t\t\t\t\\\n \n #define ASM_OUTPUT_ALIGNED_COMMON(FILE, NAME, SIZE, ALIGNMENT)\t\\\n   do { fputs (\"\\t.comm \", (FILE));\t\t\t\\\n-       assemble_name ((FILE), (NAME));\t\t\t\\\n+       RS6000_OUTPUT_BASENAME ((FILE), (NAME));\t\t\\\n        if ( (SIZE) > 4)\t\t\t\t\t\\\n          fprintf ((FILE), \",%d,3\\n\", (SIZE));\t\t\\\n        else\t\t\t\t\t\t\\\n@@ -439,7 +449,7 @@ toc_section ()\t\t\t\t\t\t\\\n \n #define ASM_OUTPUT_LOCAL(FILE, NAME, SIZE, ROUNDED)\t\\\n   do { fputs (\"\\t.lcomm \", (FILE));\t\t\t\\\n-       assemble_name ((FILE), (NAME));\t\t\t\\\n+       RS6000_OUTPUT_BASENAME ((FILE), (NAME));\t\t\\\n        fprintf ((FILE), \",%d,%s\\n\", (TARGET_32BIT ? (SIZE) : (ROUNDED)), \\\n \t\txcoff_bss_section_name);\t\t\\\n      } while (0)"}]}