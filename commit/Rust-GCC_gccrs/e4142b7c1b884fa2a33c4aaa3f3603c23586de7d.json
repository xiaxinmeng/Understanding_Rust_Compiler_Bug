{"sha": "e4142b7c1b884fa2a33c4aaa3f3603c23586de7d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQxNDJiN2MxYjg4NGZhMmEzM2M0YWFhM2YzNjAzYzIzNTg2ZGU3ZA==", "commit": {"author": {"name": "Kenneth Zadeck", "email": "zadeck@gcc.gnu.org", "date": "2007-07-27T17:22:14Z"}, "committer": {"name": "Kenneth Zadeck", "email": "zadeck@gcc.gnu.org", "date": "2007-07-27T17:22:14Z"}, "message": "re PR middle-end/32749 (gfortran.dg/auto_array_1.f90)\n\n2007-07-26  Kenneth Zadeck <zadeck@naturalbridge.com>\n\n\tPR middle-end/32749\n\t\n\t* df-problems.c (df_create_unused_note): Removed do_not_gen parm\n\tand the updating of the live and do_not_gen sets.\n\t(df_note_bb_compute): Added updating of live and do_not_gen sets\n\tfor regular defs so that the case of clobber inside conditional\n\tcall is processed correctly.\n\nFrom-SVN: r126987", "tree": {"sha": "25e3e24a883406c4f896a741ef10cd2fd6d89929", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25e3e24a883406c4f896a741ef10cd2fd6d89929"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d/comments", "author": null, "committer": null, "parents": [{"sha": "83144bd60ce827e50425094f47f39aed75324cd6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83144bd60ce827e50425094f47f39aed75324cd6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83144bd60ce827e50425094f47f39aed75324cd6"}], "stats": {"total": 63, "additions": 36, "deletions": 27}, "files": [{"sha": "a13f34946cdacb0480db221531d0d9ea9f4bc937", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 3, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e4142b7c1b884fa2a33c4aaa3f3603c23586de7d", "patch": "@@ -1,3 +1,13 @@\n+2007-07-26  Kenneth Zadeck <zadeck@naturalbridge.com>\n+\n+\tPR middle-end/32749\n+\t\n+\t* df-problems.c (df_create_unused_note): Removed do_not_gen parm\n+\tand the updating of the live and do_not_gen sets.\n+\t(df_note_bb_compute): Added updating of live and do_not_gen sets\n+\tfor regular defs so that the case of clobber inside conditional\n+\tcall is processed correctly.\n+\t\n 2007-07-27  Zdenek Dvorak  <dvorakz@suse.cz>\n \n \t* config/rs6000/rs6000.c (rs6000_gimplify_va_arg): Generate the\n@@ -12517,7 +12527,7 @@\n \n \t* c-common.c (warn_logical_operator): Fix condition.\n \n-2007-03-10  Tobias Schl\ufffdter  <tobi@gcc.gnu.org>\n+2007-03-10  Tobias Schl\u00ef\u00bf\u00bdter  <tobi@gcc.gnu.org>\n \n \t* config/i386/darwin.h (DARWIN_MINVERSION_SPEC): Add missing\n \tquotation mark.\n@@ -19659,7 +19669,7 @@\n \t* langhooks.h (struct lang_hooks): Removed field\n \t'can_use_bit_fields_p'.\n \n-2007-01-10  Ralf Cors\u00e9pius <ralf.corsepius@rtems.org>\n+2007-01-10  Ralf Cors\u00c3\u00a9pius <ralf.corsepius@rtems.org>\n \n \t* config/bfin/t-bfin, config/bfin/t-bfin-elf: Remove GCC_CFLAGS.\n \n@@ -19888,7 +19898,7 @@\n \t* config/frv/predicates.md (reg_or_0_operand): Accept\n \tCONST_DOUBLEs.\n \n-2007-01-08  Ralf Cors\u00e9pius <ralf.corsepius@rtems.org>\n+2007-01-08  Ralf Cors\u00c3\u00a9pius <ralf.corsepius@rtems.org>\n \n \t* config/bfin/rtems.h, config/bfin/t-rtems: New.\n \t* config.gcc: Add bfin*-rtems*."}, {"sha": "fa349633556fae24b9df39b7791e3bae77a7d3ae", "filename": "gcc/df-problems.c", "status": "modified", "additions": 23, "deletions": 24, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d/gcc%2Fdf-problems.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4142b7c1b884fa2a33c4aaa3f3603c23586de7d/gcc%2Fdf-problems.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdf-problems.c?ref=e4142b7c1b884fa2a33c4aaa3f3603c23586de7d", "patch": "@@ -3868,13 +3868,12 @@ df_set_dead_notes_for_mw (rtx insn, rtx old, struct df_mw_hardreg *mws,\n }\n \n \n-/* Create a REG_UNUSED note if necessary for DEF in INSN updating LIVE\n-   and DO_NOT_GEN.  Do not generate notes for registers in artificial\n-   uses.  */\n+/* Create a REG_UNUSED note if necessary for DEF in INSN updating\n+   LIVE.  Do not generate notes for registers in ARTIFICIAL_USES.  */\n \n static rtx\n df_create_unused_note (rtx insn, rtx old, struct df_ref *def, \n-\t\t       bitmap live, bitmap do_not_gen, bitmap artificial_uses)\n+\t\t       bitmap live, bitmap artificial_uses)\n {\n   unsigned int dregno = DF_REF_REGNO (def);\n   \n@@ -3899,12 +3898,6 @@ df_create_unused_note (rtx insn, rtx old, struct df_ref *def,\n #endif\n     }\n   \n-  if (!(DF_REF_FLAGS (def) & (DF_REF_MUST_CLOBBER + DF_REF_MAY_CLOBBER)))\n-    bitmap_set_bit (do_not_gen, dregno);\n-  \n-  /* Kill this register if it is not a subreg store or conditional store.  */\n-  if (!(DF_REF_FLAGS (def) & (DF_REF_PARTIAL | DF_REF_CONDITIONAL)))\n-    bitmap_clear_bit (live, dregno);\n   return old;\n }\n \n@@ -3915,7 +3908,7 @@ df_create_unused_note (rtx insn, rtx old, struct df_ref *def,\n \n static void\n df_note_bb_compute (unsigned int bb_index, \n-\t\t  bitmap live, bitmap do_not_gen, bitmap artificial_uses)\n+\t\t    bitmap live, bitmap do_not_gen, bitmap artificial_uses)\n {\n   basic_block bb = BASIC_BLOCK (bb_index);\n   rtx insn;\n@@ -4012,17 +4005,17 @@ df_note_bb_compute (unsigned int bb_index,\n \t  for (def_rec = DF_INSN_UID_DEFS (uid); *def_rec; def_rec++)\n \t    {\n \t      struct df_ref *def = *def_rec;\n-\t      if (!(DF_REF_FLAGS (def) & (DF_REF_MUST_CLOBBER | DF_REF_MAY_CLOBBER)))\n-\t\told_unused_notes\n-\t\t  = df_create_unused_note (insn, old_unused_notes, \n-\t\t\t\t\t   def, live, do_not_gen, \n-\t\t\t\t\t   artificial_uses);\n-\n-\t      /* However a may or must clobber still needs to kill the\n-\t\t reg so that REG_DEAD notes are later placed\n-\t\t appropriately.  */ \n-\t      else \n-\t\tbitmap_clear_bit (live, DF_REF_REGNO (def));\n+\t      unsigned int dregno = DF_REF_REGNO (def);\n+\t      if (!DF_REF_FLAGS_IS_SET (def, DF_REF_MUST_CLOBBER | DF_REF_MAY_CLOBBER))\n+\t\t{\n+\t\t  old_unused_notes\n+\t\t    = df_create_unused_note (insn, old_unused_notes, \n+\t\t\t\t\t     def, live, artificial_uses);\n+\t\t  bitmap_set_bit (do_not_gen, dregno);\n+\t\t}\n+\n+\t      if (!DF_REF_FLAGS_IS_SET (def, DF_REF_PARTIAL | DF_REF_CONDITIONAL))\n+\t\tbitmap_clear_bit (live, dregno);\n \t    }\n \t}\n       else\n@@ -4043,10 +4036,16 @@ df_note_bb_compute (unsigned int bb_index,\n \t  for (def_rec = DF_INSN_UID_DEFS (uid); *def_rec; def_rec++)\n \t    {\n \t      struct df_ref *def = *def_rec;\n+\t      unsigned int dregno = DF_REF_REGNO (def);\n \t      old_unused_notes\n \t\t= df_create_unused_note (insn, old_unused_notes, \n-\t\t\t\t\t def, live, do_not_gen, \n-\t\t\t\t\t artificial_uses);\n+\t\t\t\t\t def, live, artificial_uses);\n+\n+\t      if (!DF_REF_FLAGS_IS_SET (def, DF_REF_MUST_CLOBBER | DF_REF_MAY_CLOBBER))\n+\t\tbitmap_set_bit (do_not_gen, dregno);\n+\n+\t      if (!DF_REF_FLAGS_IS_SET (def, DF_REF_PARTIAL | DF_REF_CONDITIONAL))\n+\t\tbitmap_clear_bit (live, dregno);\n \t    }\n \t}\n       "}]}