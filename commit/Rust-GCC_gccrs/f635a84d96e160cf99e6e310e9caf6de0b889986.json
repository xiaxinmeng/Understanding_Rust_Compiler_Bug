{"sha": "f635a84d96e160cf99e6e310e9caf6de0b889986", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjYzNWE4NGQ5NmUxNjBjZjk5ZTZlMzEwZTljYWY2ZGUwYjg4OTk4Ng==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-03-01T11:39:01Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-03-01T11:39:01Z"}, "message": "(store_expr): Do conversion in two steps for promoted lhs.\n\nFrom-SVN: r9098", "tree": {"sha": "f16467982b7a9f35c237fd7925f518ac1b915c5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f16467982b7a9f35c237fd7925f518ac1b915c5a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f635a84d96e160cf99e6e310e9caf6de0b889986", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f635a84d96e160cf99e6e310e9caf6de0b889986", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f635a84d96e160cf99e6e310e9caf6de0b889986", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f635a84d96e160cf99e6e310e9caf6de0b889986/comments", "author": null, "committer": null, "parents": [{"sha": "d72471fd1a739031934cd0e4b6064759ccfc7b16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d72471fd1a739031934cd0e4b6064759ccfc7b16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d72471fd1a739031934cd0e4b6064759ccfc7b16"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "1ee04801e1abfc92ae2540f49b8da04270424cbd", "filename": "gcc/expr.c", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f635a84d96e160cf99e6e310e9caf6de0b889986/gcc%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f635a84d96e160cf99e6e310e9caf6de0b889986/gcc%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fexpr.c?ref=f635a84d96e160cf99e6e310e9caf6de0b889986", "patch": "@@ -2743,11 +2743,23 @@ store_expr (exp, target, want_value)\n        expression.  */\n     {\n       /* If we don't want a value, we can do the conversion inside EXP,\n-\t which will often result in some optimizations.  */\n+\t which will often result in some optimizations.  Do the conversion\n+\t in two steps: first change the signedness, if needed, then\n+\t the extend.  */\n       if (! want_value)\n-\texp = convert (type_for_mode (GET_MODE (SUBREG_REG (target)),\n-\t\t\t\t      SUBREG_PROMOTED_UNSIGNED_P (target)),\n-\t\t       exp);\n+\t{\n+\t  if (TREE_UNSIGNED (TREE_TYPE (exp))\n+\t      != SUBREG_PROMOTED_UNSIGNED_P (target))\n+\t    exp\n+\t      = convert\n+\t\t(signed_or_unsigned_type (SUBREG_PROMOTED_UNSIGNED_P (target),\n+\t\t\t\t\t  TREE_TYPE (exp)),\n+\t\t exp);\n+\n+\t  exp = convert (type_for_mode (GET_MODE (SUBREG_REG (target)),\n+\t\t\t\t\tSUBREG_PROMOTED_UNSIGNED_P (target)),\n+\t\t\t exp);\n+\t}\n \t \n       temp = expand_expr (exp, NULL_RTX, VOIDmode, 0);\n "}]}