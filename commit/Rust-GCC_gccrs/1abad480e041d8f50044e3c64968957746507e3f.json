{"sha": "1abad480e041d8f50044e3c64968957746507e3f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWFiYWQ0ODBlMDQxZDhmNTAwNDRlM2M2NDk2ODk1Nzc0NjUwN2UzZg==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-06-19T10:38:49Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-06-19T10:38:49Z"}, "message": "[multiple changes]\n\n2009-06-19  Jose Ruiz  <ruiz@adacore.com>\n\n\t* env.c (__gnat_environ): RTX does not support this functionality.\n\n2009-06-19  Sergey Rybin  <rybin@adacore.com>\n\n\t* gnat_ugn.texi, vms_data.ads: Fix VMS qualifiers.\n\n2009-06-19  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem.adb (Walk_Library_Items): Include bodies in the list of units to\n\ttraverse, to account for front-end inlining and instantiations in a\n\tspec or in the main unit.\n\n2009-06-19  Robert Dewar  <dewar@adacore.com>\n\n\t* checks.adb (Determine_Range): Do not attempt to get range of generic\n\ttype.\n\nFrom-SVN: r148693", "tree": {"sha": "8956aa6dd1308f33d8d9731128c2f703d6ee88f4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8956aa6dd1308f33d8d9731128c2f703d6ee88f4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1abad480e041d8f50044e3c64968957746507e3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1abad480e041d8f50044e3c64968957746507e3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1abad480e041d8f50044e3c64968957746507e3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1abad480e041d8f50044e3c64968957746507e3f/comments", "author": null, "committer": null, "parents": [{"sha": "c38e990f94159ffbf15c7c41f8ea30cccffabfd5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c38e990f94159ffbf15c7c41f8ea30cccffabfd5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c38e990f94159ffbf15c7c41f8ea30cccffabfd5"}], "stats": {"total": 436, "additions": 236, "deletions": 200}, "files": [{"sha": "d621b1b9d16676fe6ede4fa442d111acfae6abf0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=1abad480e041d8f50044e3c64968957746507e3f", "patch": "@@ -1,3 +1,18 @@\n+2009-06-19  Jose Ruiz  <ruiz@adacore.com>\n+\n+\t* env.c (__gnat_environ): RTX does not support this functionality.\n+\n+2009-06-19  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem.adb (Walk_Library_Items): Include bodies in the list of units to\n+\ttraverse, to account for front-end inlining and instantiations in a\n+\tspec or in the main unit.\n+\n+2009-06-19  Robert Dewar  <dewar@adacore.com>\n+\n+\t* checks.adb (Determine_Range): Do not attempt to get range of generic\n+\ttype.\n+\n 2009-06-19  Sergey Rybin  <rybin@adacore.com>\n \n \t* gnat_ugn.texi, vms_data.ads: Add the documentation for the new"}, {"sha": "50e52693e948b30aaf6c8336d1aa1adf845837bd", "filename": "gcc/ada/checks.adb", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fchecks.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fchecks.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fchecks.adb?ref=1abad480e041d8f50044e3c64968957746507e3f", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2009, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -3095,11 +3095,23 @@ package body Checks is\n       Lor := No_Uint;\n       Hir := No_Uint;\n \n-      --  If the type is not discrete, or is undefined, then we can't do\n-      --  anything about determining the range.\n+      --  If type is not defined, we can't determine its range\n \n-      if No (Typ) or else not Is_Discrete_Type (Typ)\n-        or else Error_Posted (N)\n+      if No (Typ)\n+\n+        --  We don't deal with anything except discrete types\n+\n+        or else not Is_Discrete_Type (Typ)\n+\n+        --  Ignore type for which an error has been posted, since range in\n+        --  this case may well be a bogosity deriving from the error. Also\n+        --  ignore if error posted on the reference node.\n+\n+        or else Error_Posted (N) or else Error_Posted (Typ)\n+\n+        --  Ignore generic type, since range is indeed bogus\n+\n+        or else Is_Generic_Type (Typ)\n       then\n          OK := False;\n          return;"}, {"sha": "e6720e3064bdcfec2a65fc52a94d16faaea06e61", "filename": "gcc/ada/env.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fenv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fenv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fenv.c?ref=1abad480e041d8f50044e3c64968957746507e3f", "patch": "@@ -190,7 +190,7 @@ __gnat_setenv (char *name, char *value)\n char **\n __gnat_environ (void)\n {\n-#if defined (VMS)\n+#if defined (VMS) || defined (RTX)\n   /* Not implemented */\n   return NULL;\n #elif defined (__APPLE__)"}, {"sha": "d936e232ccfeae998e187d37952f3104b4afa6fd", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 54, "deletions": 54, "changes": 108, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=1abad480e041d8f50044e3c64968957746507e3f", "patch": "@@ -17336,56 +17336,56 @@ to be computed and reported.\n @cindex @option{--no-lines@var{x}}\n @end ifclear\n \n-@item ^--lines-all^/LINE_COUNT_METRICS=ALL_ON^\n+@item ^--lines-all^/LINE_COUNT_METRICS=ALL^\n Report all the line metrics\n \n-@item ^--no-lines-all^/LINE_COUNT_METRICS=ALL_OFF^\n+@item ^--no-lines-all^/LINE_COUNT_METRICS=NONE^\n Do not report any of line metrics\n \n-@item ^--lines^/LINE_COUNT_METRICS=ALL_LINES_ON^\n+@item ^--lines^/LINE_COUNT_METRICS=ALL_LINES^\n Report the number of all lines\n \n-@item ^--no-lines^/LINE_COUNT_METRICS=ALL_LINES_OFF^\n+@item ^--no-lines^/LINE_COUNT_METRICS=NOALL_LINES^\n Do not report the number of all lines\n \n-@item ^--lines-code^/LINE_COUNT_METRICS=CODE_LINES_ON^\n+@item ^--lines-code^/LINE_COUNT_METRICS=CODE_LINES^\n Report the number of code lines\n \n-@item ^--no-lines-code^/LINE_COUNT_METRICS=CODE_LINES_OFF^\n+@item ^--no-lines-code^/LINE_COUNT_METRICS=NOCODE_LINES^\n Do not report the number of code lines\n \n-@item ^--lines-comment^/LINE_COUNT_METRICS=COMMENT_LINES_ON^\n+@item ^--lines-comment^/LINE_COUNT_METRICS=COMMENT_LINES^\n Report the number of comment lines\n \n-@item ^--no-lines-comment^/LINE_COUNT_METRICS=COMMENT_LINES_OFF^\n+@item ^--no-lines-comment^/LINE_COUNT_METRICS=NOCOMMENT_LINES^\n Do not report the number of comment lines\n \n-@item ^--lines-eol-comment^/LINE_COUNT_METRICS=CODE_COMMENT_LINES_ON^\n+@item ^--lines-eol-comment^/LINE_COUNT_METRICS=CODE_COMMENT_LINES^\n Report the number of code lines containing\n end-of-line comments\n \n-@item ^--no-lines-eol-comment^/LINE_COUNT_METRICS=CODE_COMMENT_LINES_OFF^\n+@item ^--no-lines-eol-comment^/LINE_COUNT_METRICS=NOCODE_COMMENT_LINES^\n Do not report the number of code lines containing\n end-of-line comments\n \n-@item ^--lines-ratio^/LINE_COUNT_METRICS=COMMENT_PERCENTAGE_ON^\n+@item ^--lines-ratio^/LINE_COUNT_METRICS=COMMENT_PERCENTAGE^\n Report the comment percentage in the program text\n \n-@item ^--no-lines-ratio^/LINE_COUNT_METRICS=COMMENT_PERCENTAGE_OFF^\n+@item ^--no-lines-ratio^/LINE_COUNT_METRICS=NOCOMMENT_PERCENTAGE^\n Do not report the comment percentage in the program text\n \n-@item ^--lines-blank^/LINE_COUNT_METRICS=BLANK_LINES_ON^\n+@item ^--lines-blank^/LINE_COUNT_METRICS=BLANK_LINES^\n Report the number of blank lines\n \n-@item ^--no-lines-blank^/LINE_COUNT_METRICS=BLANK_LINES_OFF^\n+@item ^--no-lines-blank^/LINE_COUNT_METRICS=NOBLANK_LINES^\n Do not report the number of blank lines\n \n-@item ^--lines-average^/LINE_COUNT_METRICS=AVERAGE_BODY_LINES_ON^\n+@item ^--lines-average^/LINE_COUNT_METRICS=AVERAGE_BODY_LINES^\n Report the average number of code lines in subprogram bodies, task bodies,\n entry bodies and statement sequences in package bodies. The metric is computed\n and reported for the whole set of processed Ada sources only.\n \n-@item ^--no-lines-average^/LINE_COUNT_METRICS=AVERAGE_BODY_LINES_OFF^\n+@item ^--no-lines-average^/LINE_COUNT_METRICS=NOAVERAGE_BODY_LINES^\n Do not report the average number of code lines in subprogram bodies,\n task bodies, entry bodies and statement sequences in package bodies.\n \n@@ -17490,58 +17490,58 @@ following switches to select specific syntax metrics.\n @cindex @option{--no-syntax@var{x}} (@command{gnatmetric})\n @end ifclear\n \n-@item ^--syntax-all^/SYNTAX_METRICS=ALL_ON^\n+@item ^--syntax-all^/SYNTAX_METRICS=ALL^\n Report all the syntax metrics\n \n-@item ^--no-syntax-all^/ALL_OFF^\n+@item ^--no-syntax-all^/SYNTAX_METRICS=NONE^\n Do not report any of syntax metrics\n \n-@item ^--declarations^/SYNTAX_METRICS=DECLARATIONS_ON^\n+@item ^--declarations^/SYNTAX_METRICS=DECLARATIONS^\n Report the total number of declarations\n \n-@item ^--no-declarations^/SYNTAX_METRICS=DECLARATIONS_OFF^\n+@item ^--no-declarations^/SYNTAX_METRICS=NODECLARATIONS^\n Do not report the total number of declarations\n \n-@item ^--statements^/SYNTAX_METRICS=STATEMENTS_ON^\n+@item ^--statements^/SYNTAX_METRICS=STATEMENTS^\n Report the total number of statements\n \n-@item ^--no-statements^/SYNTAX_METRICS=STATEMENTS_OFF^\n+@item ^--no-statements^/SYNTAX_METRICS=NOSTATEMENTS^\n Do not report the total number of statements\n \n-@item ^--public-subprograms^/SYNTAX_METRICS=PUBLIC_SUBPROGRAMS_ON^\n+@item ^--public-subprograms^/SYNTAX_METRICS=PUBLIC_SUBPROGRAMS^\n Report the number of public subprograms in a compilation unit\n \n-@item ^--no-public-subprograms^/SYNTAX_METRICS=PUBLIC_SUBPROGRAMS_OFF^\n+@item ^--no-public-subprograms^/SYNTAX_METRICS=NOPUBLIC_SUBPROGRAMS^\n Do not report the number of public subprograms in a compilation unit\n \n-@item ^--all-subprograms^/SYNTAX_METRICS=ALL_SUBPROGRAMS_ON^\n+@item ^--all-subprograms^/SYNTAX_METRICS=ALL_SUBPROGRAMS^\n Report the number of all the subprograms in a compilation unit\n \n-@item ^--no-all-subprograms^/SYNTAX_METRICS=ALL_SUBPROGRAMS_OFF^\n+@item ^--no-all-subprograms^/SYNTAX_METRICS=NOALL_SUBPROGRAMS^\n Do not report the number of all the subprograms in a compilation unit\n \n-@item ^--public-types^/SYNTAX_METRICS=PUBLIC_TYPES_ON^\n+@item ^--public-types^/SYNTAX_METRICS=PUBLIC_TYPES^\n Report the number of public types in a compilation unit\n \n-@item ^--no-public-types^/SYNTAX_METRICS=PUBLIC_TYPES_OFF^\n+@item ^--no-public-types^/SYNTAX_METRICS=NOPUBLIC_TYPES^\n Do not report the number of public types in a compilation unit\n \n-@item ^--all-types^/SYNTAX_METRICS=ALL_TYPES_ON^\n+@item ^--all-types^/SYNTAX_METRICS=ALL_TYPES^\n Report the number of all the types in a compilation unit\n \n-@item ^--no-all-types^/SYNTAX_METRICS=ALL_TYPES_OFF^\n+@item ^--no-all-types^/SYNTAX_METRICS=NOALL_TYPES^\n Do not report the number of all the types in a compilation unit\n \n-@item ^--unit-nesting^/SYNTAX_METRICS=UNIT_NESTING_ON^\n+@item ^--unit-nesting^/SYNTAX_METRICS=UNIT_NESTING^\n Report the maximal program unit nesting level\n \n @item ^--no-unit-nesting^/SYNTAX_METRICS=UNIT_NESTING_OFF^\n Do not report the maximal program unit nesting level\n \n-@item ^--construct-nesting^/SYNTAX_METRICS=CONSTRUCT_NESTING_ON^\n+@item ^--construct-nesting^/SYNTAX_METRICS=CONSTRUCT_NESTING^\n Report the maximal construct nesting level\n \n-@item ^--no-construct-nesting^/SYNTAX_METRICS=CONSTRUCT_NESTING_OFF^\n+@item ^--no-construct-nesting^/SYNTAX_METRICS=NOCONSTRUCT_NESTING^\n Do not report the maximal construct nesting level\n \n @end table\n@@ -17604,37 +17604,37 @@ the following switches:\n @cindex @option{--no-complexity@var{x}}\n @end ifclear\n \n-@item ^--complexity-all^/COMPLEXITY_METRICS=ALL_ON^\n+@item ^--complexity-all^/COMPLEXITY_METRICS=ALL^\n Report all the complexity metrics\n \n-@item ^--no-complexity-all^/COMPLEXITY_METRICS=ALL_OFF^\n+@item ^--no-complexity-all^/COMPLEXITY_METRICS=NONE^\n Do not report any of complexity metrics\n \n-@item ^--complexity-cyclomatic^/COMPLEXITY_METRICS=CYCLOMATIC_ON^\n+@item ^--complexity-cyclomatic^/COMPLEXITY_METRICS=CYCLOMATIC^\n Report the McCabe Cyclomatic Complexity\n \n-@item ^--no-complexity-cyclomatic^/COMPLEXITY_METRICS=CYCLOMATIC_OFF^\n+@item ^--no-complexity-cyclomatic^/COMPLEXITY_METRICS=NOCYCLOMATIC^\n Do not report the McCabe Cyclomatic Complexity\n \n-@item ^--complexity-essential^/COMPLEXITY_METRICS=ESSENTIAL_ON^\n+@item ^--complexity-essential^/COMPLEXITY_METRICS=ESSENTIAL^\n Report the Essential Complexity\n \n-@item ^--no-complexity-essential^/COMPLEXITY_METRICS=ESSENTIAL_OFF^\n+@item ^--no-complexity-essential^/COMPLEXITY_METRICS=NOESSENTIAL^\n Do not report the Essential Complexity\n \n @item ^--loop-nesting^/COMPLEXITY_METRICS=LOOP_NESTING_ON^\n Report maximal loop nesting level\n \n-@item ^--no-loop-nesting^/COMPLEXITY_METRICS=LOOP_NESTING_OFF^\n+@item ^--no-loop-nesting^/COMPLEXITY_METRICS=NOLOOP_NESTING^\n Do not report maximal loop nesting level\n \n-@item ^--complexity-average^/COMPLEXITY_METRICS=AVERAGE_COMPLEXITY_ON^\n+@item ^--complexity-average^/COMPLEXITY_METRICS=AVERAGE_COMPLEXITY^\n Report the average McCabe Cyclomatic Complexity for all the subprogram bodies,\n task bodies, entry bodies and statement sequences in package bodies.\n The metric is computed and reported for whole set of processed Ada sources\n only.\n \n-@item ^--no-complexity-average^/COMPLEXITY_METRICS=AVERAGE_COMPLEXITY_OFF^\n+@item ^--no-complexity-average^/COMPLEXITY_METRICS=NOAVERAGE_COMPLEXITY^\n Do not report the average McCabe Cyclomatic Complexity for all the subprogram\n bodies, task bodies, entry bodies and statement sequences in package bodies\n \n@@ -17643,14 +17643,14 @@ bodies, task bodies, entry bodies and statement sequences in package bodies\n Do not consider @code{exit} statements as @code{goto}s when\n computing Essential Complexity\n \n-@item ^--extra-exit-points^/EXTRA_EXIT_POINTS_ON^\n+@item ^--extra-exit-points^/EXTRA_EXIT_POINTS^\n Report the extra exit points for subprogram bodies. As an exit point, this\n metric counts @code{return} statements and raise statements in case when the\n raised exception is not handled in the same body. In case of a function this\n metric subtracts 1 from the number of exit points, because a function body\n must contain at least one @code{return} statement.\n \n-@item ^--no-extra-exit-points^/EXTRA_EXIT_POINTS_OFF^\n+@item ^--no-extra-exit-points^/NOEXTRA_EXIT_POINTS^\n Do not report the extra exit points for subprogram bodies\n @end table\n \n@@ -17723,34 +17723,34 @@ switches to specify the coupling metrics to be computed and reported:\n @cindex @option{/COUPLING_METRICS} (@command{gnatmetric})\n @end ifset\n \n-@item ^--coupling-all^/COUPLING_METRICS=ALL_ON^\n+@item ^--coupling-all^/COUPLING_METRICS=ALL^\n Report all the coupling metrics\n \n-@item ^--no-coupling-all^/COUPLING_METRICS=ALL_OFF^\n+@item ^--no-coupling-all^/COUPLING_METRICS=NONE^\n Do not report any of  metrics\n \n-@item ^--package-efferent-coupling^/COUPLING_METRICS=PACKAGE_EFFERENT_ON^\n+@item ^--package-efferent-coupling^/COUPLING_METRICS=PACKAGE_EFFERENT^\n Report package efferent coupling\n \n-@item ^--no-package-efferent-coupling^/COUPLING_METRICS=PACKAGE_EFFERENT_OFF^\n+@item ^--no-package-efferent-coupling^/COUPLING_METRICS=NOPACKAGE_EFFERENT^\n Do not report package efferent coupling\n \n-@item ^--package-afferent-coupling^/COUPLING_METRICS=PACKAGE_AFFERENT_ON^\n+@item ^--package-afferent-coupling^/COUPLING_METRICS=PACKAGE_AFFERENT^\n Report package afferent coupling\n \n-@item ^--no-package-afferent-coupling^/COUPLING_METRICS=PACKAGE_AFFERENT_OFF^\n+@item ^--no-package-afferent-coupling^/COUPLING_METRICS=NOPACKAGE_AFFERENT^\n Do not report package afferent coupling\n \n-@item ^--category-efferent-coupling^/COUPLING_METRICS=CATEGORY_EFFERENT_ON^\n+@item ^--category-efferent-coupling^/COUPLING_METRICS=CATEGORY_EFFERENT^\n Report category efferent coupling\n \n-@item ^--no-category-efferent-coupling^/COUPLING_METRICS=CATEGORY_EFFERENT_OFF^\n+@item ^--no-category-efferent-coupling^/COUPLING_METRICS=NOCATEGORY_EFFERENT^\n Do not report category efferent coupling\n \n-@item ^--category-afferent-coupling^/COUPLING_METRICS=CATEGORY_AFFERENT_ON^\n+@item ^--category-afferent-coupling^/COUPLING_METRICS=CATEGORY_AFFERENT^\n Report category afferent coupling\n \n-@item ^--no-category-afferent-coupling^/COUPLING_METRICS=CATEGORY_AFFERENT_OFF^\n+@item ^--no-category-afferent-coupling^/COUPLING_METRICS=NOCATEGORY_AFFERENT^\n Do not report category afferent coupling\n \n @end table"}, {"sha": "d2b54c3ca69ffea1f3d067ed5e2e7b92d4f7ca65", "filename": "gcc/ada/sem.adb", "status": "modified", "additions": 21, "deletions": 12, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fsem.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fsem.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem.adb?ref=1abad480e041d8f50044e3c64968957746507e3f", "patch": "@@ -1541,9 +1541,15 @@ package body Sem is\n               N_Generic_Procedure_Renaming_Declaration =>\n                null;  --  Specs are OK\n \n-            when N_Package_Body | N_Subprogram_Body =>\n+               --  Package bodies are processed immediately after the\n+               --  corresponding spec.\n \n-               --  A body must be the main unit\n+            when N_Package_Body  =>\n+               null;\n+\n+            when  N_Subprogram_Body =>\n+\n+               --  A subprogram body must be the main unit\n \n                pragma Assert (Acts_As_Spec (CU)\n                                or else CU = Cunit (Main_Unit));\n@@ -1716,15 +1722,25 @@ package body Sem is\n          --  processing of the body of a unit named by pragma Extend_System,\n          --  because it has cyclic dependences in some cases.\n \n-         if not Nkind_In (Item, N_Package_Body, N_Subprogram_Body) then\n+         --  A body that is not the main unit is present because of inlining\n+         --  and/or instantiations, and it is best to process a body as early\n+         --  as possible after the spec (as if an Elaborate_Body were present).\n+         --  Currently all such bodies are added to the units list. It might\n+         --  be possible to restrict the list to those bodies that are used\n+         --  in the main unit. Possible optimization ???\n+\n+         if Nkind (Item) = N_Package_Declaration then\n             declare\n                Body_Unit : constant Node_Id := Library_Unit (CU);\n+\n             begin\n                if Present (Body_Unit)\n                  and then Body_Unit /= Cunit (Main_Unit)\n                  and then Unit_Num /= Get_Source_Unit (System_Aux_Id)\n                then\n                   Do_Unit_And_Dependents (Body_Unit, Unit (Body_Unit));\n+                  Do_Action (Body_Unit, Unit (Body_Unit));\n+                  Done (Get_Cunit_Unit_Number (Body_Unit)) := True;\n                end if;\n             end;\n          end if;\n@@ -1771,14 +1787,7 @@ package body Sem is\n                         Entity := Specification (Entity);\n                      end if;\n \n-                     Entity := Defining_Unit_Name (Entity);\n-\n-                     if Nkind (Entity) not in N_Entity then\n-\n-                        --  Must be N_Defining_Program_Unit_Name\n-\n-                        Entity := Defining_Identifier (Entity);\n-                     end if;\n+                     Entity := Defining_Entity (Entity);\n \n                      if Is_Generic_Instance (Entity) then\n                         declare\n@@ -1791,7 +1800,7 @@ package body Sem is\n                            --  with_clauses that got attached to the body.\n \n                            Append_List\n-                            (Context_Items (CU), Context_Items (Spec_Unit));\n+                             (Context_Items (CU), Context_Items (Spec_Unit));\n                            Do_Unit_And_Dependents\n                              (Spec_Unit, Unit (Spec_Unit));\n                         end;"}, {"sha": "04c3c3864da170195bbbf6b860ec5b6b4815b66b", "filename": "gcc/ada/vms_data.ads", "status": "modified", "additions": 128, "deletions": 128, "changes": 256, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fvms_data.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abad480e041d8f50044e3c64968957746507e3f/gcc%2Fada%2Fvms_data.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fvms_data.ads?ref=1abad480e041d8f50044e3c64968957746507e3f", "patch": "@@ -4892,41 +4892,41 @@ package VMS_Data is\n    --  NODOC  (see /SYNTAX_METRICS)\n \n    S_Metric_Syntax : aliased constant S := \"/SYNTAX_METRICS=\"              &\n-                                             \"ALL_ON \"                     &\n+                                             \"ALL \"                        &\n                                              \"--syntax-all \"               &\n-                                             \"ALL_OFF \"                    &\n+                                             \"NONE \"                       &\n                                              \"--no-syntax-all \"            &\n-                                             \"DECLARATIONS_ON \"            &\n+                                             \"DECLARATIONS \"               &\n                                              \"--declarations \"             &\n-                                             \"DECLARATIONS_OFF \"           &\n+                                             \"NODECLARATIONS \"             &\n                                              \"--no-declarations \"          &\n-                                             \"STATEMENTS_ON \"              &\n+                                             \"STATEMENTS \"                 &\n                                              \"--statements \"               &\n-                                             \"STATEMENTS_OFF \"             &\n+                                             \"NOSTATEMENTS \"               &\n                                              \"--no-statements \"            &\n-                                             \"PUBLIC_SUBPROGRAMS_ON \"      &\n+                                             \"PUBLIC_SUBPROGRAMS \"         &\n                                              \"--public-subprograms \"       &\n-                                             \"PUBLIC_SUBPROGRAMS_OFF \"     &\n+                                             \"NOPUBLIC_SUBPROGRAMS \"       &\n                                              \"--no-public-subprograms \"    &\n-                                             \"ALL_SUBPROGRAMS_ON \"         &\n+                                             \"ALL_SUBPROGRAMS \"            &\n                                              \"--all-subprograms \"          &\n-                                             \"ALL_SUBPROGRAMS_OFF \"        &\n+                                             \"NOALL_SUBPROGRAMS \"          &\n                                              \"--no-all-subprograms \"       &\n-                                             \"PUBLIC_TYPES_ON \"            &\n+                                             \"PUBLIC_TYPES \"               &\n                                              \"--public-types \"             &\n-                                             \"PUBLIC_TYPES_OFF \"           &\n+                                             \"NOPUBLIC_TYPES \"             &\n                                              \"--no-public-types \"          &\n-                                             \"ALL_TYPES_ON \"               &\n+                                             \"ALL_TYPES \"                  &\n                                              \"--all-types \"                &\n-                                             \"ALL_TYPES_OFF \"              &\n+                                             \"NOALL_TYPES \"                &\n                                              \"--no-all-types \"             &\n-                                             \"UNIT_NESTING_ON \"            &\n+                                             \"UNIT_NESTING \"               &\n                                              \"--unit-nesting \"             &\n-                                             \"UNIT_NESTING_OFF \"           &\n+                                             \"NOUNIT_NESTING \"             &\n                                              \"--no-unit-nesting \"          &\n-                                             \"CONSTRUCT_NESTING_ON \"       &\n+                                             \"CONSTRUCT_NESTING \"          &\n                                              \"--construct-nesting \"        &\n-                                             \"CONSTRUCT_NESTING_OFF \"      &\n+                                             \"NOCONSTRUCT_NESTING \"        &\n                                              \"--no-construct-nesting\";\n    --       /SYNTAX_METRICS(option, option ...)\n    --\n@@ -4937,31 +4937,28 @@ package VMS_Data is\n    --\n    --   option may be one of the following:\n    --\n-   --     ALL_ON (D)               All the syntax element metrics are computed\n-   --     ALL_OFF                  None of syntax element metrics is computed\n-   --     DECLARATIONS_ON          Compute the total number of declarations\n-   --     DECLARATIONS_OFF         Do not compute the total number of\n-   --                              declarations\n-   --     STATEMENTS_ON            Compute the total number of statements\n-   --     STATEMENTS_OFF           Do not compute the total number of\n-   --                              statements\n-   --     PUBLIC_SUBPROGRAMS_ON    Compute the number of public subprograms\n-   --     PUBLIC_SUBPROGRAMS_OFF   Do not compute the number of public\n-   --                              subprograms\n-   --     ALL_SUBPROGRAMS_ON       Compute the number of all the subprograms\n-   --     ALL_SUBPROGRAMS_OFF      Do not compute the number of all the\n-   --                              subprograms\n-   --     PUBLIC_TYPES_ON          Compute the number of public types\n-   --     PUBLIC_TYPES_OFF         Do not compute the number of public types\n-   --     ALL_TYPES_ON             Compute the number of all the types\n-   --     ALL_TYPES_OFF            Do not compute the number of all the types\n-   --     UNIT_NESTING_ON          Compute the maximal program unit nesting\n-   --                              level\n-   --     UNIT_NESTING_OFF         Do not compute the maximal program unit\n-   --                              nesting level\n-   --     CONSTRUCT_NESTING_ON     Compute the maximal construct nesting level\n-   --     CONSTRUCT_NESTING_OFF    Do not compute the maximal construct nesting\n-   --                              level\n+   --     ALL (D)               All the syntax element metrics are computed\n+   --     NONE                  None of syntax element metrics is computed\n+   --     DECLARATIONS          Compute the total number of declarations\n+   --     NODECLARATIONS        Do not compute the total number of declarations\n+   --     STATEMENTS            Compute the total number of statements\n+   --     NOSTATEMENTS          Do not compute the total number of statements\n+   --     PUBLIC_SUBPROGRAMS    Compute the number of public subprograms\n+   --     NOPUBLIC_SUBPROGRAMS  Do not compute the number of public subprograms\n+   --     ALL_SUBPROGRAMS       Compute the number of all the subprograms\n+   --     NOALL_SUBPROGRAMS     Do not compute the number of all the\n+   --                           subprograms\n+   --     PUBLIC_TYPES          Compute the number of public types\n+   --     NOPUBLIC_TYPES        Do not compute the number of public types\n+   --     ALL_TYPES             Compute the number of all the types\n+   --     NOALL_TYPES           Do not compute the number of all the types\n+   --     UNIT_NESTING          Compute the maximal program unit nesting\n+   --                           level\n+   --     NOUNIT_NESTING        Do not compute the maximal program unit\n+   --                           nesting level\n+   --     CONSTRUCT_NESTING     Compute the maximal construct nesting level\n+   --     NOCONSTRUCT_NESTING   Do not compute the maximal construct nesting\n+   --                           level\n    --\n    --   All combinations of syntax element metrics options are allowed.\n \n@@ -5035,37 +5032,37 @@ package VMS_Data is\n    --  NODOC  (see /LINE_COUNT_METRICS)\n \n    S_Metric_Lines : aliased constant S := \"/LINE_COUNT_METRICS=\"           &\n-                                           \"ALL_ON \"                       &\n+                                           \"ALL \"                          &\n                                            \"--lines-all \"                  &\n-                                           \"ALL_OFF \"                      &\n+                                           \"NONE \"                         &\n                                            \"--no-lines-all \"               &\n-                                           \"ALL_LINES_ON \"                 &\n+                                           \"ALL_LINES \"                    &\n                                            \"--lines \"                      &\n-                                           \"ALL_LINES_OFF \"                &\n+                                           \"NOALL_LINES \"                  &\n                                            \"--no-lines \"                   &\n-                                           \"CODE_LINES_ON \"                &\n+                                           \"CODE_LINES \"                   &\n                                            \"--lines-code \"                 &\n-                                           \"CODE_LINES_OFF \"               &\n+                                           \"NOCODE_LINES \"                 &\n                                            \"--no-lines-code \"              &\n-                                           \"COMMENT_LINES_ON \"             &\n+                                           \"COMMENT_LINES \"                &\n                                            \"--lines-comment \"              &\n-                                           \"COMMENT_LINES_OFF \"            &\n+                                           \"NOCOMMENT_LINES \"              &\n                                            \"--no-lines-comment \"           &\n-                                           \"CODE_COMMENT_LINES_ON \"        &\n+                                           \"CODE_COMMENT_LINES \"           &\n                                            \"--lines-eol-comment \"          &\n-                                           \"CODE_COMMENT_LINES_OFF \"       &\n+                                           \"NOCODE_COMMENT_LINES \"         &\n                                            \"--no-lines-eol-comment \"       &\n-                                           \"COMMENT_PERCENTAGE_ON \"        &\n+                                           \"COMMENT_PERCENTAGE \"           &\n                                            \"--lines-ratio \"                &\n-                                           \"COMMENT_PERCENTAGE_OFF \"       &\n+                                           \"NOCOMMENT_PERCENTAGE \"         &\n                                            \"--no-lines-ratio \"             &\n-                                           \"BLANK_LINES_ON \"               &\n+                                           \"BLANK_LINES \"                  &\n                                            \"--lines-blank \"                &\n-                                           \"BLANK_LINES_OFF \"              &\n+                                           \"NOBLANK_LINES \"                &\n                                            \"--no-lines-blank \"             &\n-                                           \"AVERAGE_BODY_LINES_ON \"        &\n+                                           \"AVERAGE_BODY_LINES \"           &\n                                            \"--lines-average \"              &\n-                                           \"AVERAGE_BODY_LINES_OFF \"       &\n+                                           \"NOAVERAGE_BODY_LINES \"         &\n                                            \"--no-lines-average\";\n    --      /LINE_COUNT_METRICS=(option, option ...)\n \n@@ -5076,55 +5073,59 @@ package VMS_Data is\n    --\n    --   option may be one of the following:\n    --\n-   --     ALL_ON (D)               All the line metrics are computed\n-   --     ALL_OFF                  None of line metrics is computed\n-   --     ALL_LINES_ON             All lines are computed\n-   --     ALL_LINES_OFF            All lines are not computed\n-   --     CODE_LINES_ON            Lines with Ada code are computed\n-   --     CODE_LINES_OFF           Lines with Ada code are not computed\n-   --     COMMENT_LINES_ON         Comment lines are computed\n-   --     COMMENT_LINES_OFF        Comment lines are not computed\n-   --     COMMENT_PERCENTAGE_ON    Ratio between comment lines and all the\n-   --                              lines containing comments and program code\n-   --                              is computed\n-   --     COMMENT_PERCENTAGE_OFF    Ratio between comment lines and all the\n-   --                              lines containing comments and program code\n-   --                              is not computed\n-   --     BLANK_LINES_ON           Blank lines are computed\n-   --     BLANK_LINES_OFF          Blank lines are not computed\n-   --     AVERAGE_BODY_LINES_ON    Average number of code lines in subprogram,\n-   --                              task and entry bodies and statement\n-   --                              sequences of package bodies is computed\n-   --     AVERAGE_BODY_LINES_OFF   Average number of code lines in subprogram,\n-   --                              task and entry bodies and statement\n-   --                              sequences of package bodies is not computed\n+   --     ALL (D)               All the line metrics are computed\n+   --     NONE                  None of line metrics is computed\n+   --     ALL_LINES             All lines are computed\n+   --     NOALL_LINES           All lines are not computed\n+   --     CODE_LINES            Lines with Ada code are computed\n+   --     NOCODE_LINES          Lines with Ada code are not computed\n+   --     COMMENT_LINES         Comment lines are computed\n+   --     NOCOMMENT_LINES       Comment lines are not computed\n+   --     CODE_COMMENT_LINES    Lines containing both code and comment parts\n+   --                           are computed\n+   --     NOCODE_COMMENT_LINES  Lines containing both code and comment parts\n+   --                           are not computed\n+   --     COMMENT_PERCENTAGE    Ratio between comment lines and all the lines\n+   --                           containing comments and program code is\n+   --                           computed\n+   --     NOCOMMENT_PERCENTAGE  Ratio between comment lines and all the lines\n+   --                           containing comments and program code is not\n+   --                           computed\n+   --     BLANK_LINES           Blank lines are computed\n+   --     NOBLANK_LINES         Blank lines are not computed\n+   --     AVERAGE_BODY_LINES    Average number of code lines in subprogram,\n+   --                           task and entry bodies and statement sequences\n+   --                           of package bodies is computed\n+   --     NOAVERAGE_BODY_LINES  Average number of code lines in subprogram,\n+   --                           task and entry bodies and statement sequences\n+   --                           of package bodies is not computed\n    --\n    --   All combinations of line metrics options are allowed.\n \n    S_Metric_Complexity : aliased constant S := \"/COMPLEXITY_METRICS=\"      &\n-                                               \"ALL_ON \"                   &\n+                                               \"ALL \"                      &\n                                                \"--complexity-all \"         &\n-                                              \"ALL_OFF \"                   &\n+                                              \"NONE \"                      &\n                                               \"--no-complexity-all \"       &\n-                                              \"CYCLOMATIC_ON \"             &\n+                                              \"CYCLOMATIC \"                &\n                                               \"--complexity-cyclomatic \"   &\n-                                              \"CYCLOMATIC_OFF \"            &\n+                                              \"NOCYCLOMATIC \"              &\n                                               \"--no-complexity-cyclomatic \"&\n-                                              \"ESSENTIAL_ON \"              &\n+                                              \"ESSENTIAL \"                 &\n                                               \"--complexity-essential \"    &\n-                                              \"ESSENTIAL_OFF \"             &\n+                                              \"NOESSENTIAL \"               &\n                                               \"--no-complexity-essential \" &\n-                                              \"LOOP_NESTING_ON \"           &\n+                                              \"LOOP_NESTING \"              &\n                                               \"--loop-nesting \"            &\n-                                              \"LOOP_NESTING_OFF \"          &\n+                                              \"NOLOOP_NESTING \"            &\n                                               \"--no-loop-nesting \"         &\n-                                              \"AVERAGE_COMPLEXITY_ON \"     &\n+                                              \"AVERAGE_COMPLEXITY \"        &\n                                               \"--complexity-average \"      &\n-                                              \"AVERAGE_COMPLEXITY_OFF \"    &\n+                                              \"NOAVERAGE_COMPLEXITY \"      &\n                                               \"--no-complexity-average \"   &\n-                                              \"EXTRA_EXIT_POINTS_ON \"      &\n+                                              \"EXTRA_EXIT_POINTS \"         &\n                                               \"--extra-exit-points \"       &\n-                                              \"EXTRA_EXIT_POINTS_OFF \"     &\n+                                              \"NOEXTRA_EXIT_POINTS \"       &\n                                               \"--no-extra-exit-points\";\n    --      /COMPLEXITY_METRICS=(option, option ...)\n \n@@ -5135,44 +5136,43 @@ package VMS_Data is\n    --\n    --   option may be one of the following:\n    --\n-   --     ALL_ON (D)               All the complexity metrics are computed\n-   --     ALL_OFF                  None of complexity metrics is computed\n-   --     CYCLOMATIC_ON            Compute the McCabe Cyclomatic Complexity\n-   --     CYCLOMATIC_OFF           Do not compute the McCabe Cyclomatic\n-   --                              Complexity\n-   --     ESSENTIAL_ON             Compute the Essential Complexity\n-   --     ESSENTIAL_OFF            Do not compute the Essential Complexity\n-   --     LOOP_NESTIMG_ON          Compute the maximal loop nesting\n-   --     LOOP_NESTIMG_OFF         Do not compute the maximal loop nesting\n-   --     AVERAGE_COMPLEXITY_ON    Compute the average complexity for\n-   --                              executable bodies\n-   --     AVERAGE_COMPLEXITY_OFF   Do not compute the average complexity for\n-   --                              executable bodies\n-   --     EXTRA_EXIT_POINTS_ON     Compute extra exit points metric\n-   --     EXTRA_EXIT_POINTS_OFF    Do not compute extra exit points metric\n+   --     ALL (D)               All the complexity metrics are computed\n+   --     NONE                  None of complexity metrics is computed\n+   --     CYCLOMATIC            Compute the McCabe Cyclomatic Complexity\n+   --     NOCYCLOMATIC          Do not compute the McCabe Cyclomatic Complexity\n+   --     ESSENTIAL             Compute the Essential Complexity\n+   --     NOESSENTIAL           Do not compute the Essential Complexity\n+   --     LOOP_NESTING          Compute the maximal loop nesting\n+   --     NOLOOP_NESTING        Do not compute the maximal loop nesting\n+   --     AVERAGE_COMPLEXITY    Compute the average complexity for executable\n+   --                           bodies\n+   --     NOAVERAGE_COMPLEXITY  Do not compute the average complexity for\n+   --                           executable bodies\n+   --     EXTRA_EXIT_POINTS     Compute extra exit points metric\n+   --     NOEXTRA_EXIT_POINTS   Do not compute extra exit points metric\n    --\n    --   All combinations of line metrics options are allowed.\n \n    S_Metric_Coupling : aliased constant S := \"/COUPLING_METRICS=\"             &\n-                                           \"ALL_ON \"                          &\n+                                           \"ALL \"                             &\n                                            \"--coupling-all \"                  &\n-                                           \"ALL_OFF \"                         &\n+                                           \"NONE \"                            &\n                                            \"--no-coupling-all \"               &\n-                                           \"PACKAGE_EFFERENT_ON \"             &\n+                                           \"PACKAGE_EFFERENT \"                &\n                                            \"--package-efferent-coupling \"     &\n-                                           \"PACKAGE_EFFERENT_OFF \"            &\n+                                           \"NOPACKAGE_EFFERENT \"              &\n                                            \"--no-package-efferent-coupling \"  &\n-                                           \"PACKAGE_AFFERENT_ON \"             &\n+                                           \"PACKAGE_AFFERENT \"                &\n                                            \"--package-afferent-coupling \"     &\n-                                           \"PACKAGE_AFFERENT_OFF \"            &\n+                                           \"NOPACKAGE_AFFERENT \"              &\n                                            \"--no-package-afferent-coupling \"  &\n-                                           \"CATEGORY_EFFERENT_ON \"            &\n+                                           \"CATEGORY_EFFERENT \"               &\n                                            \"--category-efferent-coupling \"    &\n-                                           \"CATEGORY_EFFERENT_OFF \"           &\n+                                           \"NOCATEGORY_EFFERENT \"             &\n                                            \"--no-category-efferent-coupling \" &\n-                                           \"CATEGORY_AFFERENT_ON \"            &\n+                                           \"CATEGORY_AFFERENT \"               &\n                                            \"--category-afferent-coupling \"    &\n-                                           \"CATEGORY_AFFERENT_OFF \"           &\n+                                           \"NOCATEGORY_AFFERENT \"             &\n                                            \"--no-category-afferent-coupling\";\n \n    --      /COUPLING_METRICS=(option, option ...)\n@@ -5181,16 +5181,16 @@ package VMS_Data is\n    --\n    --   option may be one of the following:\n    --\n-   --     ALL_ON                   All the coupling metrics are computed\n-   --     ALL_OFF (D)              None of coupling metrics is computed\n-   --     PACKAGE_EFFERENT_ON      Compute package efferent coupling\n-   --     PACKAGE_EFFERENT_OFF     Do not compute package efferent coupling\n-   --     PACKAGE_AFFERENT_ON      Compute package afferent coupling\n-   --     PACKAGE_AFFERENT_OFF     Do not compute package afferent coupling\n-   --     CATEGORY_EFFERENT_ON     Compute category efferent coupling\n-   --     CATEGORY_EFFERENT_OFF    Do not compute category efferent coupling\n-   --     CATEGORY_AFFERENT_ON     Compute category afferent coupling\n-   --     CATEGORY_AFFERENT_OFF    Do not compute category afferent coupling\n+   --     ALL                   All the coupling metrics are computed\n+   --     NONE (D)              None of coupling metrics is computed\n+   --     PACKAGE_EFFERENT      Compute package efferent coupling\n+   --     NOPACKAGE_EFFERENT    Do not compute package efferent coupling\n+   --     PACKAGE_AFFERENT      Compute package afferent coupling\n+   --     NOPACKAGE_AFFERENT    Do not compute package afferent coupling\n+   --     CATEGORY_EFFERENT     Compute category efferent coupling\n+   --     NOCATEGORY_EFFERENT   Do not compute category efferent coupling\n+   --     CATEGORY_AFFERENT     Compute category afferent coupling\n+   --     NOCATEGORY_AFFERENT   Do not compute category afferent coupling\n    --\n    --   All combinations of coupling metrics options are allowed.\n "}]}