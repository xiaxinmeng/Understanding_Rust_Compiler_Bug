{"sha": "4da39468e78f9bbc7abb34db5a71b3c8183e848a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGRhMzk0NjhlNzhmOWJiYzdhYmIzNGRiNWE3MWIzYzgxODNlODQ4YQ==", "commit": {"author": {"name": "Ira Rosen", "email": "irar@il.ibm.com", "date": "2009-05-11T12:33:13Z"}, "committer": {"name": "Ira Rosen", "email": "irar@gcc.gnu.org", "date": "2009-05-11T12:33:13Z"}, "message": "re PR tree-optimization/40074 (ICE in vect_get_vec_def_for_operand, at tree-vect-stmts.c:944)\n\n\tPR tree-optimization/40074\n\t* tree-vect-data-refs.c (vect_analyze_group_access): Take gaps into\n\taccount in group size and step comparison.\n\nFrom-SVN: r147372", "tree": {"sha": "8e88e1d02b9765f0c7c8d49664f5a03d1d46f536", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e88e1d02b9765f0c7c8d49664f5a03d1d46f536"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4da39468e78f9bbc7abb34db5a71b3c8183e848a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4da39468e78f9bbc7abb34db5a71b3c8183e848a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4da39468e78f9bbc7abb34db5a71b3c8183e848a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4da39468e78f9bbc7abb34db5a71b3c8183e848a/comments", "author": {"login": "irar2", "id": 16818592, "node_id": "MDQ6VXNlcjE2ODE4NTky", "avatar_url": "https://avatars.githubusercontent.com/u/16818592?v=4", "gravatar_id": "", "url": "https://api.github.com/users/irar2", "html_url": "https://github.com/irar2", "followers_url": "https://api.github.com/users/irar2/followers", "following_url": "https://api.github.com/users/irar2/following{/other_user}", "gists_url": "https://api.github.com/users/irar2/gists{/gist_id}", "starred_url": "https://api.github.com/users/irar2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/irar2/subscriptions", "organizations_url": "https://api.github.com/users/irar2/orgs", "repos_url": "https://api.github.com/users/irar2/repos", "events_url": "https://api.github.com/users/irar2/events{/privacy}", "received_events_url": "https://api.github.com/users/irar2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4effdf02d48fae0d7487a558125563ec12d7b586", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4effdf02d48fae0d7487a558125563ec12d7b586", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4effdf02d48fae0d7487a558125563ec12d7b586"}], "stats": {"total": 74, "additions": 71, "deletions": 3}, "files": [{"sha": "f33d4b0b1ec288269e5542fb2d7b83ee212158b6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4da39468e78f9bbc7abb34db5a71b3c8183e848a", "patch": "@@ -1,3 +1,9 @@\n+2009-05-11  Ira Rosen  <irar@il.ibm.com>\n+\n+\tPR tree-optimization/40074\n+\t* tree-vect-data-refs.c (vect_analyze_group_access): Take gaps into\n+\taccount in group size and step comparison.\n+\n 2009-05-11  Richard Guenther  <rguenther@suse.de>\n \n \t* passes.c (init_optimization_passes): Strip now incorrect comment."}, {"sha": "1ccd97a548ad37b860bdb8c579c840fe926cf820", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4da39468e78f9bbc7abb34db5a71b3c8183e848a", "patch": "@@ -1,3 +1,8 @@\n+2009-05-11  Ira Rosen  <irar@il.ibm.com>\n+\n+\tPR tree-optimization/40074\n+\t* gcc.dg/vect/pr40074.c: New test.\n+\n 2009-05-10  Ian Lance Taylor  <iant@google.com>\n \n \t* gcc.dg/Wcxx-compat-7.c: New testcase."}, {"sha": "6459f1b552eacf6fb63948f3e6b98da2e2a52609", "filename": "gcc/testsuite/gcc.dg/vect/pr40074.c", "status": "added", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr40074.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr40074.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fpr40074.c?ref=4da39468e78f9bbc7abb34db5a71b3c8183e848a", "patch": "@@ -0,0 +1,54 @@\n+/* { dg-require-effective-target vect_int } */\n+\n+#include <stdarg.h>\n+#include \"tree-vect.h\"\n+\n+#define N 16 \n+\n+typedef struct {\n+   int a;\n+   int b;\n+   int c;\n+   int d;\n+} s;\n+\n+\n+s arr[N] = {{7,0,1,5}, {7,2,3,5}, {7,4,5,5}, {7,6,7,5}, {7,8,9,5}, {7,10,11,5}, {7,12,13,5}, {7,14,15,5}, {7,16,17,5}, {7,18,19,5}, {7,20,21,5}, {7,22,23,5}, {7,24,25,5}, {7,26,27,5}, {7,28,29,5}, {7,30,31,5}};\n+\n+__attribute__ ((noinline)) int\n+main1 ()\n+{\n+  s *p = arr, *q = arr + 1;\n+  int res[N];\n+  int i;\n+\n+  for (i = 0; i < N-1; i++)\n+    {\n+      res[i] = p->b + p->d + q->b;\n+      p++;\n+      q++;\n+    }\n+  \n+  /* check results:  */\n+  for (i = 0; i < N-1; i++)\n+    {\n+      if (res[i] != arr[i].b + arr[i].d + arr[i+1].b)\n+\tabort ();\n+    }\n+\n+  return 0;\n+}\n+\n+int main (void)\n+{\n+  int i;\n+  \n+  check_vect ();\n+\n+  main1 ();\n+\n+  return 0;\n+}\n+\n+/* { dg-final { cleanup-tree-dump \"vect\" } } */\n+  "}, {"sha": "42854a0663134530ad602b2cb2c98936ed09fced", "filename": "gcc/tree-vect-data-refs.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2Ftree-vect-data-refs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4da39468e78f9bbc7abb34db5a71b3c8183e848a/gcc%2Ftree-vect-data-refs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-data-refs.c?ref=4da39468e78f9bbc7abb34db5a71b3c8183e848a", "patch": "@@ -1424,7 +1424,7 @@ vect_analyze_group_access (struct data_reference *dr)\n       /* First stmt in the interleaving chain. Check the chain.  */\n       gimple next = DR_GROUP_NEXT_DR (vinfo_for_stmt (stmt));\n       struct data_reference *data_ref = dr;\n-      unsigned int count = 1;\n+      unsigned int count = 1, gaps = 0;\n       tree next_step;\n       tree prev_init = DR_INIT (data_ref);\n       gimple prev = stmt;\n@@ -1490,6 +1490,8 @@ vect_analyze_group_access (struct data_reference *dr)\n \t\t    fprintf (vect_dump, \"interleaved store with gaps\");\n \t\t  return false;\n \t\t}\n+\n+              gaps += diff - 1;\n \t    }\n \n           /* Store the gap from the previous member of the group. If there is no\n@@ -1506,8 +1508,9 @@ vect_analyze_group_access (struct data_reference *dr)\n          the type to get COUNT_IN_BYTES.  */\n       count_in_bytes = type_size * count;\n \n-      /* Check that the size of the interleaving is not greater than STEP.  */\n-      if (dr_step < count_in_bytes)\n+     /* Check that the size of the interleaving (including gaps) is not greater\n+         than STEP.  */\n+      if (dr_step && dr_step < count_in_bytes + gaps * type_size)\n         {\n           if (vect_print_dump_info (REPORT_DETAILS))\n             {"}]}