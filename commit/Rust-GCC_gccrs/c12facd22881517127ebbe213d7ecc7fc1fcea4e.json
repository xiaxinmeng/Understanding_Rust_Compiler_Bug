{"sha": "c12facd22881517127ebbe213d7ecc7fc1fcea4e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzEyZmFjZDIyODgxNTE3MTI3ZWJiZTIxM2Q3ZWNjN2ZjMWZjZWE0ZQ==", "commit": {"author": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2020-09-17T12:01:09Z"}, "committer": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2020-09-17T12:01:09Z"}, "message": "Fortran: Avoid double-free with parse error (PR96041, PR93423)\n\ngcc/fortran/\n\n\tPR fortran/96041\n\tPR fortran/93423\n\t* decl.c (gfc_match_submod_proc): Avoid later double-free\n\tin the error case.", "tree": {"sha": "d8c15903cdb63512718f5ca1a473c7afcf2ec993", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8c15903cdb63512718f5ca1a473c7afcf2ec993"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c12facd22881517127ebbe213d7ecc7fc1fcea4e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c12facd22881517127ebbe213d7ecc7fc1fcea4e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c12facd22881517127ebbe213d7ecc7fc1fcea4e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c12facd22881517127ebbe213d7ecc7fc1fcea4e/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c7f4be78cb61006492d16375aba5392f580cd633", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c7f4be78cb61006492d16375aba5392f580cd633", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c7f4be78cb61006492d16375aba5392f580cd633"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "326e6f5db7aeed29ab44a80de61a5f4ce466ac27", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c12facd22881517127ebbe213d7ecc7fc1fcea4e/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c12facd22881517127ebbe213d7ecc7fc1fcea4e/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=c12facd22881517127ebbe213d7ecc7fc1fcea4e", "patch": "@@ -9819,6 +9819,15 @@ gfc_match_submod_proc (void)\n \n   if (gfc_match_eos () != MATCH_YES)\n     {\n+      /* Unset st->n.sym. Note: in reject_statement (), the symbol changes are\n+\t undone, such that the st->n.sym->formal points to the original symbol;\n+\t if now this namespace is finalized, the formal namespace is freed,\n+\t but it might be still needed in the parent namespace.  */\n+      gfc_symtree *st = gfc_find_symtree (gfc_current_ns->sym_root, sym->name);\n+      st->n.sym = NULL;\n+      gfc_free_symbol (sym->tlink);\n+      sym->tlink = NULL;\n+      sym->refs--;\n       gfc_syntax_error (ST_MODULE_PROC);\n       return MATCH_ERROR;\n     }"}]}