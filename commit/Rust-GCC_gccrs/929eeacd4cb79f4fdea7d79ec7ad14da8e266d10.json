{"sha": "929eeacd4cb79f4fdea7d79ec7ad14da8e266d10", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTI5ZWVhY2Q0Y2I3OWY0ZmRlYTdkNzllYzdhZDE0ZGE4ZTI2NmQxMA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-04-24T14:54:17Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2012-04-24T14:54:17Z"}, "message": "compiler: Reject invalid composite literals.\n\nFrom-SVN: r186766", "tree": {"sha": "7cf552c36051a19cbecac2981ea3fc7647578dba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7cf552c36051a19cbecac2981ea3fc7647578dba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/929eeacd4cb79f4fdea7d79ec7ad14da8e266d10", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/929eeacd4cb79f4fdea7d79ec7ad14da8e266d10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/929eeacd4cb79f4fdea7d79ec7ad14da8e266d10", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/929eeacd4cb79f4fdea7d79ec7ad14da8e266d10/comments", "author": null, "committer": null, "parents": [{"sha": "46b380a23b6504fe3c5747673e8897debc42a633", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46b380a23b6504fe3c5747673e8897debc42a633", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46b380a23b6504fe3c5747673e8897debc42a633"}], "stats": {"total": 11, "additions": 10, "deletions": 1}, "files": [{"sha": "7a567a1cd14065c3cd64b7d3ea16297024b66a43", "filename": "gcc/go/gofrontend/parse.cc", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/929eeacd4cb79f4fdea7d79ec7ad14da8e266d10/gcc%2Fgo%2Fgofrontend%2Fparse.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/929eeacd4cb79f4fdea7d79ec7ad14da8e266d10/gcc%2Fgo%2Fgofrontend%2Fparse.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fparse.cc?ref=929eeacd4cb79f4fdea7d79ec7ad14da8e266d10", "patch": "@@ -2865,7 +2865,16 @@ Parse::primary_expr(bool may_be_sink, bool may_be_composite_lit,\n     {\n       if (this->peek_token()->is_op(OPERATOR_LCURLY))\n \t{\n-\t  if (is_parenthesized)\n+\t  if (!may_be_composite_lit)\n+\t    {\n+\t      Type* t = ret->type();\n+\t      if (t->named_type() != NULL\n+\t\t  || t->forward_declaration_type() != NULL)\n+\t\terror_at(start_loc,\n+\t\t\t _(\"parentheses required around this composite literal\"\n+\t\t\t   \"to avoid parsing ambiguity\"));\n+\t    }\n+\t  else if (is_parenthesized)\n \t    error_at(start_loc,\n \t\t     \"cannot parenthesize type in composite literal\");\n \t  ret = this->composite_lit(ret->type(), 0, ret->location());"}]}