{"sha": "a5277405c8ec3cc34a48c1498abcfc3145046477", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTUyNzc0MDVjOGVjM2NjMzRhNDhjMTQ5OGFiY2ZjMzE0NTA0NjQ3Nw==", "commit": {"author": {"name": "Fran\u00e7ois Dumont", "email": "fdumont@gcc.gnu.org", "date": "2018-05-08T19:41:02Z"}, "committer": {"name": "Fran\u00e7ois Dumont", "email": "fdumont@gcc.gnu.org", "date": "2018-05-08T19:41:02Z"}, "message": "formatter.h (_Error_formatter::_M_function): New.\n\n2018-05-08  Fran\u00e7ois Dumont  <fdumont@gcc.gnu.org>\n\n\t* include/debug/formatter.h (_Error_formatter::_M_function): New.\n\t(_Error_formatter(const char*, unsigned int)): Adapt.\n\t(_Error_formatter::_M_at): Rename in...\n\t(_Error_formatter::_S_at): ...that and adapt.\n\t* include/debug/macros.h (_GLIBCXX_DEBUG_VERIFY_AT_F): New.\n\t(_GLIBCXX_DEBUG_VERIFY_AT, _GLIBCXX_DEBUG_VERIFY): Adapt.\n\t* src/c++11/debug.cc (_Error_formatter::_M_error): Render _M_function\n\twhen available.\n\nFrom-SVN: r260052", "tree": {"sha": "09b24aa95a0be23379b9f508ae725c5434a3bfae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/09b24aa95a0be23379b9f508ae725c5434a3bfae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a5277405c8ec3cc34a48c1498abcfc3145046477", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5277405c8ec3cc34a48c1498abcfc3145046477", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5277405c8ec3cc34a48c1498abcfc3145046477", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5277405c8ec3cc34a48c1498abcfc3145046477/comments", "author": null, "committer": null, "parents": [{"sha": "9f171abdbcdb944e317ddee480d62b4dc7ce6cbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f171abdbcdb944e317ddee480d62b4dc7ce6cbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f171abdbcdb944e317ddee480d62b4dc7ce6cbf"}], "stats": {"total": 49, "additions": 38, "deletions": 11}, "files": [{"sha": "87bd39c9341c50f5d1d0d7264fef2dc483a2d193", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=a5277405c8ec3cc34a48c1498abcfc3145046477", "patch": "@@ -1,3 +1,14 @@\n+2018-05-08  Fran\u00e7ois Dumont  <fdumont@gcc.gnu.org>\n+\n+\t* include/debug/formatter.h (_Error_formatter::_M_function): New.\n+\t(_Error_formatter(const char*, unsigned int)): Adapt.\n+\t(_Error_formatter::_M_at): Rename in...\n+\t(_Error_formatter::_S_at): ...that and adapt.\n+\t* include/debug/macros.h (_GLIBCXX_DEBUG_VERIFY_AT_F): New.\n+\t(_GLIBCXX_DEBUG_VERIFY_AT, _GLIBCXX_DEBUG_VERIFY): Adapt.\n+\t* src/c++11/debug.cc (_Error_formatter::_M_error): Render _M_function\n+\twhen available.\n+\n 2018-05-08  Jonathan Wakely  <jwakely@redhat.com>\n \n \t* include/bits/regex_automaton.h (_NFA_base::_M_paren_stack, _NFA):"}, {"sha": "c160bd8432c7e5e6b5d4b0b88b04c512dc940043", "filename": "libstdc++-v3/include/debug/formatter.h", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fformatter.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fformatter.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fformatter.h?ref=a5277405c8ec3cc34a48c1498abcfc3145046477", "patch": "@@ -467,8 +467,10 @@ namespace __gnu_debug\n #endif\n \n   private:\n-    _Error_formatter(const char* __file, unsigned int __line)\n+    _Error_formatter(const char* __file, unsigned int __line,\n+\t\t     const char* __function)\n     : _M_file(__file), _M_line(__line), _M_num_parameters(0), _M_text(0)\n+    , _M_function(__function)\n     { }\n \n #if !_GLIBCXX_INLINE_VERSION\n@@ -483,12 +485,13 @@ namespace __gnu_debug\n     _Parameter\t\t_M_parameters[__max_parameters];\n     unsigned int\t_M_num_parameters;\n     const char*\t\t_M_text;\n+    const char*\t\t_M_function;\n \n   public:\n     static _Error_formatter&\n-    _M_at(const char* __file, unsigned int __line)\n+    _S_at(const char* __file, unsigned int __line, const char* __function)\n     {\n-      static _Error_formatter __formatter(__file, __line);\n+      static _Error_formatter __formatter(__file, __line, __function);\n       return __formatter;\n     }\n   };"}, {"sha": "6f901bc00314e6ed8c0de038f4c62e801b05f465", "filename": "libstdc++-v3/include/debug/macros.h", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fmacros.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fmacros.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fmacros.h?ref=a5277405c8ec3cc34a48c1498abcfc3145046477", "patch": "@@ -38,16 +38,20 @@\n  * the user error and where the error is reported.\n  *\n  */\n-#define _GLIBCXX_DEBUG_VERIFY_AT(_Condition,_ErrorMessage,_File,_Line)\t\\\n+#define _GLIBCXX_DEBUG_VERIFY_AT_F(_Cond,_ErrMsg,_File,_Line,_Func)\t\\\n   do\t\t\t\t\t\t\t\t\t\\\n   {\t\t\t\t\t\t\t\t\t\\\n-    if (! (_Condition))\t\t\t\t\t\t\t\\\n-      __gnu_debug::_Error_formatter::_M_at(_File, _Line)\t\t\\\n-\t  ._ErrorMessage._M_error();\t\t\t\t\t\\\n+    if (! (_Cond))\t\t\t\t\t\t\t\\\n+      __gnu_debug::_Error_formatter::_S_at(_File, _Line, _Func)\t\t\\\n+\t._ErrMsg._M_error();\t\t\t\t\t\t\\\n   } while (false)\n \n-#define _GLIBCXX_DEBUG_VERIFY(_Condition,_ErrorMessage)\t\t\t\\\n-  _GLIBCXX_DEBUG_VERIFY_AT(_Condition,_ErrorMessage,__FILE__,__LINE__)\n+#define _GLIBCXX_DEBUG_VERIFY_AT(_Cond,_ErrMsg,_File,_Line)\t\t\\\n+  _GLIBCXX_DEBUG_VERIFY_AT_F(_Cond,_ErrMsg,_File,_Line,__PRETTY_FUNCTION__)\n+\n+#define _GLIBCXX_DEBUG_VERIFY(_Cond,_ErrMsg)\t\t\t\t\\\n+  _GLIBCXX_DEBUG_VERIFY_AT_F(_Cond, _ErrMsg, __FILE__, __LINE__,\t\\\n+\t\t\t     __PRETTY_FUNCTION__)\n \n // Verify that [_First, _Last) forms a valid iterator range.\n #define __glibcxx_check_valid_range(_First,_Last)\t\t\t\\"}, {"sha": "89d387cdea5688fb2409bd011711fedf5bb49056", "filename": "libstdc++-v3/src/c++11/debug.cc", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Fdebug.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5277405c8ec3cc34a48c1498abcfc3145046477/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Fdebug.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Fdebug.cc?ref=a5277405c8ec3cc34a48c1498abcfc3145046477", "patch": "@@ -923,9 +923,9 @@ namespace\n \t    continue;\n \t  }\n \n-\tif (*start != '%')\n+\tif (!num_parameters || *start != '%')\n \t  {\n-\t    // Normal char.\n+\t    // Normal char or no parameter to look for.\n \t    buf[bufindex++] = *start++;\n \t    continue;\n \t  }\n@@ -1034,6 +1034,15 @@ namespace __gnu_debug\n     if (ctx._M_max_length)\n       ctx._M_wordwrap = true;\n \n+    if (_M_function)\n+      {\n+\tprint_literal(ctx, \"In function:\\n\");\n+\tprint_string(ctx, _M_function, nullptr, 0);\n+\tprint_literal(ctx, \"\\n\");\n+\tctx._M_first_line = true;\n+\tprint_literal(ctx, \"\\n\");\n+      }\n+\n     print_literal(ctx, \"Error: \");\n \n     // Print the error message"}]}