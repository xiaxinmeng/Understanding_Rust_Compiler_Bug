{"sha": "5f620f482ec35b18c419368a8cae2218bd4cacf5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWY2MjBmNDgyZWMzNWIxOGM0MTkzNjhhOGNhZTIyMThiZDRjYWNmNQ==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2008-05-20T19:01:46Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2008-05-20T19:01:46Z"}, "message": "re PR testsuite/36057 (struct-layout-1_generate.c  uses non-ISO C  '%n$'  operand number formats)\n\n\tPR testsuite/36057\n\t* g++.dg/compat/struct-layout-1_generate.c (DG_OPTIONS): Remove.\n\t(const char *dg_options): New array.\n\t(switchfiles): Loop through dg_options array to generate dg-options\n\tdirectives.  Remove numbered arguments usage from fprintf\n\tformat strings.\n\nFrom-SVN: r135671", "tree": {"sha": "b3c516308bd4f77fcbdd9baa1ea8c5bcb950538e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b3c516308bd4f77fcbdd9baa1ea8c5bcb950538e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5f620f482ec35b18c419368a8cae2218bd4cacf5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f620f482ec35b18c419368a8cae2218bd4cacf5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5f620f482ec35b18c419368a8cae2218bd4cacf5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5f620f482ec35b18c419368a8cae2218bd4cacf5/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5fb0445da6a641f2723de1fda82bbc31040dd25b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fb0445da6a641f2723de1fda82bbc31040dd25b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fb0445da6a641f2723de1fda82bbc31040dd25b"}], "stats": {"total": 50, "additions": 34, "deletions": 16}, "files": [{"sha": "fae968728a57a173ce0729e79faaaf475312f63f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f620f482ec35b18c419368a8cae2218bd4cacf5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f620f482ec35b18c419368a8cae2218bd4cacf5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5f620f482ec35b18c419368a8cae2218bd4cacf5", "patch": "@@ -1,3 +1,12 @@\n+2008-05-20  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR testsuite/36057\n+\t* g++.dg/compat/struct-layout-1_generate.c (DG_OPTIONS): Remove.\n+\t(const char *dg_options): New array.\n+\t(switchfiles): Loop through dg_options array to generate dg-options\n+\tdirectives.  Remove numbered arguments usage from fprintf\n+\tformat strings.\n+\n 2008-05-20  Jan Sjodin  <jan.sjodin@amd.com>\n \t    Sebastian Pop  <sebastian.pop@amd.com>\n "}, {"sha": "e6f4cb969edcd107751452e7157865713b469d41", "filename": "gcc/testsuite/g++.dg/compat/struct-layout-1_generate.c", "status": "modified", "additions": 25, "deletions": 16, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5f620f482ec35b18c419368a8cae2218bd4cacf5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcompat%2Fstruct-layout-1_generate.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5f620f482ec35b18c419368a8cae2218bd4cacf5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcompat%2Fstruct-layout-1_generate.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcompat%2Fstruct-layout-1_generate.c?ref=5f620f482ec35b18c419368a8cae2218bd4cacf5", "patch": "@@ -42,12 +42,13 @@ along with GCC; see the file COPYING3.  If not see\n #define COMPAT_PRLL \"ll\"\n #endif\n \n-#define DG_OPTIONS \"\\\n-/* { dg-options \\\"%1$s-I%2$s\\\" } */\\n\\\n-/* { dg-options \\\"%1$s-I%2$s -mno-mmx\\\" { target i?86-*-* x86_64-*-* } } */\\n\\\n-/* { dg-options \\\"%1$s-I%2$s -fno-common\\\" { target hppa*-*-hpux* } } */\\n\\\n-/* { dg-options \\\"%1$s-I%2$s -mno-base-addresses\\\" { target mmix-*-* } } */\\n\\\n-\\n\"\n+const char *dg_options[] = {\n+\"/* { dg-options \\\"%s-I%s\\\" } */\\n\",\n+\"/* { dg-options \\\"%s-I%s -mno-mmx\\\" { target i?86-*-* x86_64-*-* } } */\\n\",\n+\"/* { dg-options \\\"%s-I%s -fno-common\\\" { target hppa*-*-hpux* } } */\\n\",\n+\"/* { dg-options \\\"%s-I%s -mno-base-addresses\\\" { target mmix-*-* } } */\\n\"\n+#define NDG_OPTIONS (sizeof (dg_options) / sizeof (dg_options[0]))\n+};\n \n typedef unsigned int hashval_t;\n \n@@ -501,6 +502,8 @@ switchfiles (int fields)\n {\n   static int filecnt;\n   static char *destbuf, *destptr;\n+  int i;\n+\n   ++filecnt;\n   if (outfile)\n     fclose (outfile);\n@@ -528,45 +531,51 @@ switchfiles (int fields)\n       fputs (\"failed to create test files\\n\", stderr);\n       exit (1);\n     }\n-  fprintf (outfile, DG_OPTIONS \"\\\n+  for (i = 0; i < NDG_OPTIONS; i++)\n+    fprintf (outfile, dg_options[i], \"\", srcdir);\n+  fprintf (outfile, \"\\n\\\n #include \\\"struct-layout-1.h\\\"\\n\\\n \\n\\\n #define TX(n, type, attrs, fields, ops) extern void test##n (void);\\n\\\n-#include \\\"t%3$03d_test.h\\\"\\n\\\n+#include \\\"t%03d_test.h\\\"\\n\\\n #undef TX\\n\\\n \\n\\\n int main (void)\\n\\\n {\\n\\\n #define TX(n, type, attrs, fields, ops)   test##n ();\\n\\\n-#include \\\"t%3$03d_test.h\\\"\\n\\\n+#include \\\"t%03d_test.h\\\"\\n\\\n #undef TX\\n\\\n   if (fails)\\n\\\n     {\\n\\\n       fflush (stdout);\\n\\\n       abort ();\\n\\\n     }\\n\\\n   exit (0);\\n\\\n-}\\n\", \"\", srcdir, filecnt);\n+}\\n\", filecnt, filecnt);\n   fclose (outfile);\n   sprintf (destptr, \"t%03d_x.C\", filecnt);\n   outfile = fopen (destbuf, \"w\");\n   if (outfile == NULL)\n     goto fail;\n-  fprintf (outfile, DG_OPTIONS \"\\\n+  for (i = 0; i < NDG_OPTIONS; i++)\n+    fprintf (outfile, dg_options[i], \"-w \", srcdir);\n+  fprintf (outfile, \"\\n\\\n #include \\\"struct-layout-1_x1.h\\\"\\n\\\n-#include \\\"t%3$03d_test.h\\\"\\n\\\n+#include \\\"t%03d_test.h\\\"\\n\\\n #include \\\"struct-layout-1_x2.h\\\"\\n\\\n-#include \\\"t%3$03d_test.h\\\"\\n\", \"-w \", srcdir, filecnt);\n+#include \\\"t%03d_test.h\\\"\\n\", filecnt, filecnt);\n   fclose (outfile);\n   sprintf (destptr, \"t%03d_y.C\", filecnt);\n   outfile = fopen (destbuf, \"w\");\n   if (outfile == NULL)\n     goto fail;\n-  fprintf (outfile, DG_OPTIONS \"\\\n+  for (i = 0; i < NDG_OPTIONS; i++)\n+    fprintf (outfile, dg_options[i], \"-w \", srcdir);\n+  fprintf (outfile, \"\\n\\\n #include \\\"struct-layout-1_y1.h\\\"\\n\\\n-#include \\\"t%3$03d_test.h\\\"\\n\\\n+#include \\\"t%03d_test.h\\\"\\n\\\n #include \\\"struct-layout-1_y2.h\\\"\\n\\\n-#include \\\"t%3$03d_test.h\\\"\\n\", \"-w \", srcdir, filecnt);\n+#include \\\"t%03d_test.h\\\"\\n\", filecnt, filecnt);\n   fclose (outfile);\n   sprintf (destptr, \"t%03d_test.h\", filecnt);\n   outfile = fopen (destbuf, \"w\");"}]}