{"sha": "f3be9e3c336718ee354a5a76eff94315ee2eac9a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjNiZTllM2MzMzY3MThlZTM1NGE1YTc2ZWZmOTQzMTVlZTJlYWM5YQ==", "commit": {"author": {"name": "Per Bothner", "email": "bothner@kalessin.cygnus.com", "date": "1995-08-25T23:06:45Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1995-08-25T23:06:45Z"}, "message": "(do_identifier): Handle old (non-ANSI) for scoping, and warn if\nconflicts.\n\nFrom-SVN: r10275", "tree": {"sha": "4b7c86e341883619548aa0d07456ebe6416b4b4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b7c86e341883619548aa0d07456ebe6416b4b4b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f3be9e3c336718ee354a5a76eff94315ee2eac9a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f3be9e3c336718ee354a5a76eff94315ee2eac9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f3be9e3c336718ee354a5a76eff94315ee2eac9a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f3be9e3c336718ee354a5a76eff94315ee2eac9a/comments", "author": null, "committer": null, "parents": [{"sha": "d2ad151f7fb2ebf6685826b250e55e5038482a1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2ad151f7fb2ebf6685826b250e55e5038482a1c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2ad151f7fb2ebf6685826b250e55e5038482a1c"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "a99e9af0933d568fb9a2c3756503a3e02c1e26c5", "filename": "gcc/cp/lex.c", "status": "modified", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f3be9e3c336718ee354a5a76eff94315ee2eac9a/gcc%2Fcp%2Flex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f3be9e3c336718ee354a5a76eff94315ee2eac9a/gcc%2Fcp%2Flex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flex.c?ref=f3be9e3c336718ee354a5a76eff94315ee2eac9a", "patch": "@@ -2916,6 +2916,41 @@ do_identifier (token)\n \t  SET_IDENTIFIER_ERROR_LOCUS (token, current_function_decl);\n \t}\n     }\n+\n+  if (TREE_CODE (id) == VAR_DECL && DECL_DEAD_FOR_LOCAL (id))\n+    {\n+      tree shadowed = DECL_SHADOWED_FOR_VAR (id);\n+      if (shadowed)\n+\t{\n+\t  if (!DECL_ERROR_REPORTED (id))\n+\t    {\n+\t      warning (\"name lookup of `%s' changed\",\n+\t\t       IDENTIFIER_POINTER (token));\n+\t      cp_warning_at (\"  matches this `%D' under current ANSI rules\",\n+\t\t\t     shadowed);\n+\t      cp_warning_at (\"  matches this `%D' under old rules\", id);\n+\t      DECL_ERROR_REPORTED (id) = 1;\n+\t    }\n+\t  id = shadowed;\n+\t}\n+      else if (!DECL_ERROR_REPORTED (id))\n+\t{\n+\t  static char msg[]\n+\t    = \"name lookup of `%s' changed for new ANSI `for' scoping\";\n+\t  DECL_ERROR_REPORTED (id) = 1;\n+\t  if (TYPE_NEEDS_DESTRUCTOR (TREE_TYPE (id)))\n+\t    {\n+\t      error (msg, IDENTIFIER_POINTER (token));\n+\t      cp_error_at (\"  cannot use obsolete binding at `%D' because it has a destructor\", id);\n+\t      id = error_mark_node;\n+\t    }\n+\t  else\n+\t    {\n+\t      pedwarn (msg, IDENTIFIER_POINTER (token));\n+\t      cp_pedwarn_at (\"  using obsolete binding at `%D'\", id);\n+\t    }\n+\t}\n+    }\n   /* TREE_USED is set in `hack_identifier'.  */\n   if (TREE_CODE (id) == CONST_DECL)\n     {"}]}