{"sha": "bc91c4361527fb229ad47f20a45de0b3160f2de9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmM5MWM0MzYxNTI3ZmIyMjlhZDQ3ZjIwYTQ1ZGUwYjMxNjBmMmRlOQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2016-07-22T10:19:57Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2016-07-22T10:19:57Z"}, "message": "Consider functions with xloc.file == NULL (PR\n\n\tPR gcov-profile/69028\n\tPR gcov-profile/62047\n\t* g++.dg/cilk-plus/pr69028.C: New test.\n\tPR gcov-profile/69028\n\tPR gcov-profile/62047\n\t* cilk.c (create_cilk_helper_decl): Set location of a new decl\n\tto the current_function_decl.\n\tPR gcov-profile/69028\n\tPR gcov-profile/62047\n\t* coverage.c (coverage_compute_lineno_checksum): Do not\n\tcalculate checksum for fns w/o xloc.file.\n\t(coverage_compute_profile_id): Likewise.\n\nFrom-SVN: r238637", "tree": {"sha": "7d61a4e799f8e9fba5938c4b59cb017add066d75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d61a4e799f8e9fba5938c4b59cb017add066d75"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc91c4361527fb229ad47f20a45de0b3160f2de9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc91c4361527fb229ad47f20a45de0b3160f2de9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc91c4361527fb229ad47f20a45de0b3160f2de9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc91c4361527fb229ad47f20a45de0b3160f2de9/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9fe9a3a780c9cd8f5fa45e162640b7169c27fe8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fe9a3a780c9cd8f5fa45e162640b7169c27fe8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fe9a3a780c9cd8f5fa45e162640b7169c27fe8f"}], "stats": {"total": 45, "additions": 41, "deletions": 4}, "files": [{"sha": "f889abd32126d7db4d90d3d0e1fab6e46a36fa71", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bc91c4361527fb229ad47f20a45de0b3160f2de9", "patch": "@@ -1,3 +1,11 @@\n+2016-07-22  Martin Liska  <mliska@suse.cz>\n+\n+\tPR gcov-profile/69028\n+\tPR gcov-profile/62047\n+\t* coverage.c (coverage_compute_lineno_checksum): Do not\n+\tcalculate checksum for fns w/o xloc.file.\n+\t(coverage_compute_profile_id): Likewise.\n+\n 2016-07-22  Georg-Johann Lay  <avr@gjlay.de>\n \n \t* config/avr/avr.c (TARGET_SECONDARY_RELOAD): Remove hook define..."}, {"sha": "ba6093af6f68f74f208dd3135825c368f10f27da", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=bc91c4361527fb229ad47f20a45de0b3160f2de9", "patch": "@@ -1,3 +1,10 @@\n+2016-07-22  Martin Liska  <mliska@suse.cz>\n+\n+\tPR gcov-profile/69028\n+\tPR gcov-profile/62047\n+\t* cilk.c (create_cilk_helper_decl): Set location of a new decl\n+\tto the current_function_decl.\n+\n 2016-07-21  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/65168"}, {"sha": "39781c483a0095e876297355b2e5a5daa4f40a61", "filename": "gcc/c-family/cilk.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Fc-family%2Fcilk.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Fc-family%2Fcilk.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fcilk.c?ref=bc91c4361527fb229ad47f20a45de0b3160f2de9", "patch": "@@ -312,8 +312,9 @@ create_cilk_helper_decl (struct wrapper_data *wd)\n     gcc_unreachable (); \n   \n   clean_symbol_name (name);\n-  tree fndecl = build_decl (UNKNOWN_LOCATION, FUNCTION_DECL, \n-\t\t\t    get_identifier (name), wd->fntype);\n+\n+  tree fndecl = build_decl (DECL_SOURCE_LOCATION (current_function_decl),\n+\t\t\t    FUNCTION_DECL, get_identifier (name), wd->fntype);\n \n   TREE_PUBLIC (fndecl) = 0;\n   TREE_STATIC (fndecl) = 1;"}, {"sha": "d4d371ecd6d403b4407946619e61628a18024ad9", "filename": "gcc/coverage.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Fcoverage.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Fcoverage.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcoverage.c?ref=bc91c4361527fb229ad47f20a45de0b3160f2de9", "patch": "@@ -553,7 +553,8 @@ coverage_compute_lineno_checksum (void)\n     = expand_location (DECL_SOURCE_LOCATION (current_function_decl));\n   unsigned chksum = xloc.line;\n \n-  chksum = coverage_checksum_string (chksum, xloc.file);\n+  if (xloc.file)\n+    chksum = coverage_checksum_string (chksum, xloc.file);\n   chksum = coverage_checksum_string\n     (chksum, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (current_function_decl)));\n \n@@ -580,7 +581,8 @@ coverage_compute_profile_id (struct cgraph_node *n)\n       bool use_name_only = (PARAM_VALUE (PARAM_PROFILE_FUNC_INTERNAL_ID) == 0);\n \n       chksum = (use_name_only ? 0 : xloc.line);\n-      chksum = coverage_checksum_string (chksum, xloc.file);\n+      if (xloc.file)\n+\tchksum = coverage_checksum_string (chksum, xloc.file);\n       chksum = coverage_checksum_string\n \t(chksum, IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (n->decl)));\n       if (!use_name_only && first_global_object_name)"}, {"sha": "656a6c23ddafa1114b5a54b5e4c5f51e7d3ceb7f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bc91c4361527fb229ad47f20a45de0b3160f2de9", "patch": "@@ -1,3 +1,9 @@\n+2016-07-22  Martin Liska  <mliska@suse.cz>\n+\n+\tPR gcov-profile/69028\n+\tPR gcov-profile/62047\n+\t* g++.dg/cilk-plus/pr69028.C: New test.\n+\n 2016-07-22  Andre Vehreschild  <vehre@gcc.gnu.org>\n \n \t* gfortran.dg/coarray_stat_2.f90: New test."}, {"sha": "31542f34e9a024dcc1cecda4687b57f0fb18fdd1", "filename": "gcc/testsuite/g++.dg/cilk-plus/pr69028.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2Fpr69028.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc91c4361527fb229ad47f20a45de0b3160f2de9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2Fpr69028.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2Fpr69028.C?ref=bc91c4361527fb229ad47f20a45de0b3160f2de9", "patch": "@@ -0,0 +1,13 @@\n+// PR c++/69028\n+// { dg-require-effective-target c++11 }\n+// { dg-options \"-fcilkplus -fprofile-arcs\" }\n+\n+void parallel()\n+{\n+}\n+\n+int main()\n+{\n+   _Cilk_spawn parallel();\n+   _Cilk_sync;\n+}"}]}