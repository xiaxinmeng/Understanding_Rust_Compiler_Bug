{"sha": "3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2ZmMGRjMTdhNDFjYTRhOGM2NzNjNjdkMDA1M2U4NWE2NTIxYzczOQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2018-01-10T10:54:20Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2018-01-10T10:54:20Z"}, "message": "Clean up partitioning in try_optimize_cfg (PR bootstrap/82831).\n\n2018-01-10  Martin Liska  <mliska@suse.cz>\n\n\tPR bootstrap/82831\n\t* basic-block.h (CLEANUP_NO_PARTITIONING): New define.\n\t* bb-reorder.c (pass_reorder_blocks::execute): Do not clean up\n\tpartitioning.\n\t* cfgcleanup.c (try_optimize_cfg): Fix up partitioning if\n\tCLEANUP_NO_PARTITIONING is not set.\n\nFrom-SVN: r256422", "tree": {"sha": "f23e1eb29735ba98c89f93421a9b7ee92fab31aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f23e1eb29735ba98c89f93421a9b7ee92fab31aa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2072a319569067b9b99154e8d1bbec894034652f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2072a319569067b9b99154e8d1bbec894034652f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2072a319569067b9b99154e8d1bbec894034652f"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "19eea83b82a7815b94f4d182a4b67a8a9bb3baf9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "patch": "@@ -1,3 +1,12 @@\n+2018-01-10  Martin Liska  <mliska@suse.cz>\n+\n+\tPR bootstrap/82831\n+\t* basic-block.h (CLEANUP_NO_PARTITIONING): New define.\n+\t* bb-reorder.c (pass_reorder_blocks::execute): Do not clean up\n+\tpartitioning.\n+\t* cfgcleanup.c (try_optimize_cfg): Fix up partitioning if\n+\tCLEANUP_NO_PARTITIONING is not set.\n+\n 2018-01-10  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \t* doc/rtl.texi: Remove documentation of (const ...) wrappers"}, {"sha": "823627a14a8d359f55c0248a79f00a00bd99b1fa", "filename": "gcc/basic-block.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2Fbasic-block.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2Fbasic-block.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbasic-block.h?ref=3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "patch": "@@ -506,6 +506,7 @@ ei_cond (edge_iterator ei, edge *p)\n \t\t\t\t\t   insns.  */\n #define CLEANUP_CFGLAYOUT\t32\t/* Do cleanup in cfglayout mode.  */\n #define CLEANUP_CFG_CHANGED\t64      /* The caller changed the CFG.  */\n+#define CLEANUP_NO_PARTITIONING\t128     /* Do not try to fix partitions.  */\n \n /* Return true if BB is in a transaction.  */\n "}, {"sha": "9d18fcc495f3b2b3517a7bc4b566fa2c8ee4d16c", "filename": "gcc/bb-reorder.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2Fbb-reorder.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2Fbb-reorder.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbb-reorder.c?ref=3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "patch": "@@ -2575,7 +2575,7 @@ pass_reorder_blocks::execute (function *fun)\n   cfg_layout_initialize (CLEANUP_EXPENSIVE);\n \n   reorder_basic_blocks ();\n-  cleanup_cfg (CLEANUP_EXPENSIVE);\n+  cleanup_cfg (CLEANUP_EXPENSIVE | CLEANUP_NO_PARTITIONING);\n \n   FOR_EACH_BB_FN (bb, fun)\n     if (bb->next_bb != EXIT_BLOCK_PTR_FOR_FN (fun))"}, {"sha": "eebbe8f7959bd4ddadcff94513a171696eb559db", "filename": "gcc/cfgcleanup.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2Fcfgcleanup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ff0dc17a41ca4a8c673c67d0053e85a6521c739/gcc%2Fcfgcleanup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgcleanup.c?ref=3ff0dc17a41ca4a8c673c67d0053e85a6521c739", "patch": "@@ -3012,7 +3012,8 @@ try_optimize_cfg (int mode)\n                  to detect and fix during edge forwarding, and in some cases\n                  is only visible after newly unreachable blocks are deleted,\n                  which will be done in fixup_partitions.  */\n-\t      fixup_partitions ();\n+\t      if ((mode & CLEANUP_NO_PARTITIONING) == 0)\n+\t\tfixup_partitions ();\n \t      checking_verify_flow_info ();\n             }\n "}]}