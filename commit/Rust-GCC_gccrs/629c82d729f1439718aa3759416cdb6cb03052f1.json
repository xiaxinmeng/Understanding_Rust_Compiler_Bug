{"sha": "629c82d729f1439718aa3759416cdb6cb03052f1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjI5YzgyZDcyOWYxNDM5NzE4YWEzNzU5NDE2Y2RiNmNiMDMwNTJmMQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@adacore.com", "date": "2021-05-28T14:25:39Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-07-08T13:34:21Z"}, "message": "[Ada] Spurious warning in generic instance\n\ngcc/ada/\n\n\t* sem_util.ads, sem_util.adb\n\t(Apply_Compile_Time_Constraint_Error): New parameter\n\tEmit_Message.\n\t* sem_ch4.adb (Analyze_Selected_Component): Disable warning\n\twithin an instance.", "tree": {"sha": "7630c6f893f1fbed9504c16372d1fa0e3ceb4000", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7630c6f893f1fbed9504c16372d1fa0e3ceb4000"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/629c82d729f1439718aa3759416cdb6cb03052f1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/629c82d729f1439718aa3759416cdb6cb03052f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/629c82d729f1439718aa3759416cdb6cb03052f1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/629c82d729f1439718aa3759416cdb6cb03052f1/comments", "author": {"login": "ArnaudCharlet", "id": 30291825, "node_id": "MDQ6VXNlcjMwMjkxODI1", "avatar_url": "https://avatars.githubusercontent.com/u/30291825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArnaudCharlet", "html_url": "https://github.com/ArnaudCharlet", "followers_url": "https://api.github.com/users/ArnaudCharlet/followers", "following_url": "https://api.github.com/users/ArnaudCharlet/following{/other_user}", "gists_url": "https://api.github.com/users/ArnaudCharlet/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArnaudCharlet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArnaudCharlet/subscriptions", "organizations_url": "https://api.github.com/users/ArnaudCharlet/orgs", "repos_url": "https://api.github.com/users/ArnaudCharlet/repos", "events_url": "https://api.github.com/users/ArnaudCharlet/events{/privacy}", "received_events_url": "https://api.github.com/users/ArnaudCharlet/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "a9c3a4975013a9c3e29c03af5a1d0772d81aba12", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9c3a4975013a9c3e29c03af5a1d0772d81aba12", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a9c3a4975013a9c3e29c03af5a1d0772d81aba12"}], "stats": {"total": 41, "additions": 24, "deletions": 17}, "files": [{"sha": "c052022886ad9148c22cc0804df0daadb4eae274", "filename": "gcc/ada/sem_ch4.adb", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/629c82d729f1439718aa3759416cdb6cb03052f1/gcc%2Fada%2Fsem_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/629c82d729f1439718aa3759416cdb6cb03052f1/gcc%2Fada%2Fsem_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch4.adb?ref=629c82d729f1439718aa3759416cdb6cb03052f1", "patch": "@@ -5471,7 +5471,9 @@ package body Sem_Ch4 is\n                      Apply_Compile_Time_Constraint_Error\n                        (N, \"component not present in }??\",\n                         CE_Discriminant_Check_Failed,\n-                        Ent => Prefix_Type);\n+                        Ent          => Prefix_Type,\n+                        Emit_Message =>\n+                          SPARK_Mode = On or not In_Instance_Not_Visible);\n                      return;\n                   end if;\n "}, {"sha": "6fdacdcba232ca5fe250be0cf8d17933f96eef73", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 12, "deletions": 9, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/629c82d729f1439718aa3759416cdb6cb03052f1/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/629c82d729f1439718aa3759416cdb6cb03052f1/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=629c82d729f1439718aa3759416cdb6cb03052f1", "patch": "@@ -1510,13 +1510,14 @@ package body Sem_Util is\n    -----------------------------------------\n \n    procedure Apply_Compile_Time_Constraint_Error\n-     (N      : Node_Id;\n-      Msg    : String;\n-      Reason : RT_Exception_Code;\n-      Ent    : Entity_Id  := Empty;\n-      Typ    : Entity_Id  := Empty;\n-      Loc    : Source_Ptr := No_Location;\n-      Warn   : Boolean    := False)\n+     (N            : Node_Id;\n+      Msg          : String;\n+      Reason       : RT_Exception_Code;\n+      Ent          : Entity_Id  := Empty;\n+      Typ          : Entity_Id  := Empty;\n+      Loc          : Source_Ptr := No_Location;\n+      Warn         : Boolean    := False;\n+      Emit_Message : Boolean    := True)\n    is\n       Stat   : constant Boolean := Is_Static_Expression (N);\n       R_Stat : constant Node_Id :=\n@@ -1530,8 +1531,10 @@ package body Sem_Util is\n          Rtyp := Typ;\n       end if;\n \n-      Discard_Node\n-        (Compile_Time_Constraint_Error (N, Msg, Ent, Loc, Warn => Warn));\n+      if Emit_Message then\n+         Discard_Node\n+           (Compile_Time_Constraint_Error (N, Msg, Ent, Loc, Warn => Warn));\n+      end if;\n \n       --  Now we replace the node by an N_Raise_Constraint_Error node\n       --  This does not need reanalyzing, so set it as analyzed now."}, {"sha": "440ac800c111b57052f439a9c151fc42f8fe75e4", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/629c82d729f1439718aa3759416cdb6cb03052f1/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/629c82d729f1439718aa3759416cdb6cb03052f1/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=629c82d729f1439718aa3759416cdb6cb03052f1", "patch": "@@ -161,13 +161,14 @@ package Sem_Util is\n    --  part of the current package.\n \n    procedure Apply_Compile_Time_Constraint_Error\n-     (N      : Node_Id;\n-      Msg    : String;\n-      Reason : RT_Exception_Code;\n-      Ent    : Entity_Id  := Empty;\n-      Typ    : Entity_Id  := Empty;\n-      Loc    : Source_Ptr := No_Location;\n-      Warn   : Boolean    := False);\n+     (N            : Node_Id;\n+      Msg          : String;\n+      Reason       : RT_Exception_Code;\n+      Ent          : Entity_Id  := Empty;\n+      Typ          : Entity_Id  := Empty;\n+      Loc          : Source_Ptr := No_Location;\n+      Warn         : Boolean    := False;\n+      Emit_Message : Boolean    := True);\n    --  N is a subexpression that will raise Constraint_Error when evaluated\n    --  at run time. Msg is a message that explains the reason for raising the\n    --  exception. The last character is ? if the message is always a warning,\n@@ -189,6 +190,7 @@ package Sem_Util is\n    --  when the caller wants to parameterize whether an error or warning is\n    --  given), or when the message should be treated as a warning even when\n    --  SPARK_Mode is On (which otherwise would force an error).\n+   --  If Emit_Message is False, then do not emit any message.\n \n    function Async_Readers_Enabled (Id : Entity_Id) return Boolean;\n    --  Id should be the entity of a state abstraction, an object, or a type."}]}