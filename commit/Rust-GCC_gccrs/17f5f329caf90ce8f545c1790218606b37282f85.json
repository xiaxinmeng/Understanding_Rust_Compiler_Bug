{"sha": "17f5f329caf90ce8f545c1790218606b37282f85", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTdmNWYzMjljYWY5MGNlOGY1NDVjMTc5MDIxODYwNmIzNzI4MmY4NQ==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1997-08-02T17:19:38Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1997-08-02T17:19:38Z"}, "message": "(expand_computed_goto): If -fcheck-memory-usage, check that computed address of a goto is executable.\n\n(expand_computed_goto): If -fcheck-memory-usage, check that computed address\nof a goto is executable.\n(expand_asm, expand_asm_operands): If -fcheck-memory-usage, disallow\nasm statments.\n\nFrom-SVN: r14616", "tree": {"sha": "01023786dd035098ce448a7de3e3df0e114a48cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/01023786dd035098ce448a7de3e3df0e114a48cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/17f5f329caf90ce8f545c1790218606b37282f85", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17f5f329caf90ce8f545c1790218606b37282f85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/17f5f329caf90ce8f545c1790218606b37282f85", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17f5f329caf90ce8f545c1790218606b37282f85/comments", "author": null, "committer": null, "parents": [{"sha": "8960ab1a988069cd69a711111177b4c44bfb8512", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8960ab1a988069cd69a711111177b4c44bfb8512", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8960ab1a988069cd69a711111177b4c44bfb8512"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "dcc5fa331feeb1f403d9f8aef7fc504dd9c9ae47", "filename": "gcc/stmt.c", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/17f5f329caf90ce8f545c1790218606b37282f85/gcc%2Fstmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/17f5f329caf90ce8f545c1790218606b37282f85/gcc%2Fstmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstmt.c?ref=17f5f329caf90ce8f545c1790218606b37282f85", "patch": "@@ -627,6 +627,11 @@ expand_computed_goto (exp)\n #endif\n \n       emit_queue ();\n+      /* Be sure the function is executable.  */\n+      if (flag_check_memory_usage)\n+\temit_library_call (chkr_check_exec_libfunc, 1,\n+\t\t\t   VOIDmode, 1, x, ptr_mode);\n+\n       do_pending_stack_adjust ();\n       emit_indirect_jump (x);\n     }\n@@ -1352,6 +1357,12 @@ expand_asm (body)\n       return;\n     }\n \n+  if (flag_check_memory_usage)\n+    {\n+      error (\"`asm' cannot be used with `-fcheck-memory-usage'\");\n+      return;\n+    }\n+\n   if (TREE_CODE (body) == ADDR_EXPR)\n     body = TREE_OPERAND (body, 0);\n \n@@ -1404,6 +1415,12 @@ expand_asm_operands (string, outputs, inputs, clobbers, vol, filename, line)\n       return;\n     }\n \n+  if (flag_check_memory_usage)\n+    {\n+      error (\"`asm' cannot be used with `-fcheck-memory-usage'\");\n+      return;\n+    }\n+\n   /* Count the number of meaningful clobbered registers, ignoring what\n      we would ignore later.  */\n   nclobbers = 0;\n@@ -1502,7 +1519,8 @@ expand_asm_operands (string, outputs, inputs, clobbers, vol, filename, line)\n \t    mark_addressable (TREE_VALUE (tail));\n \n \t  output_rtx[i]\n-\t    = expand_expr (TREE_VALUE (tail), NULL_RTX, VOIDmode, 0);\n+\t    = expand_expr (TREE_VALUE (tail), NULL_RTX, VOIDmode,\n+\t\t\t   EXPAND_MEMORY_USE_WO);\n \n \t  if (! allows_reg && GET_CODE (output_rtx[i]) != MEM)\n \t    error (\"output number %d not directly addressable\", i);"}]}