{"sha": "662f8070eb0bbefc336c02147ce3030e7379fcf6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjYyZjgwNzBlYjBiYmVmYzMzNmMwMjE0N2NlMzAzMGU3Mzc5ZmNmNg==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2012-02-02T19:45:04Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2012-02-02T19:45:04Z"}, "message": "re PR rtl-optimization/49800 (segfault with -fsched-pressure -fdump-rtl-sched1)\n\n2012-02-02  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/49800\n\t* haifa-sched.c (sched_init): Call regstat_init_n_sets_and_refs.\n\t(sched_finish): Call regstat_free_n_sets_and_refs.\n\nFrom-SVN: r183843", "tree": {"sha": "836eee446a39d2e312efb141929efa0cc6da43e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/836eee446a39d2e312efb141929efa0cc6da43e0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/662f8070eb0bbefc336c02147ce3030e7379fcf6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/662f8070eb0bbefc336c02147ce3030e7379fcf6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/662f8070eb0bbefc336c02147ce3030e7379fcf6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/662f8070eb0bbefc336c02147ce3030e7379fcf6/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "14bc59cb4fae60ad4ff4bb4aa0bd6085b2fc0e50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14bc59cb4fae60ad4ff4bb4aa0bd6085b2fc0e50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14bc59cb4fae60ad4ff4bb4aa0bd6085b2fc0e50"}], "stats": {"total": 12, "additions": 12, "deletions": 0}, "files": [{"sha": "2054898625720bfb12310308a04d288a31a711cd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/662f8070eb0bbefc336c02147ce3030e7379fcf6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/662f8070eb0bbefc336c02147ce3030e7379fcf6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=662f8070eb0bbefc336c02147ce3030e7379fcf6", "patch": "@@ -1,3 +1,9 @@\n+2012-02-02  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/49800\n+\t* haifa-sched.c (sched_init): Call regstat_init_n_sets_and_refs.\n+\t(sched_finish): Call regstat_free_n_sets_and_refs.\n+\n 2012-02-02  Jia Liu  <proljc@gmail.com>\n \n \t* config/mips/mips-dspr2.md (mips_prepend): Mask operand 3 rather"}, {"sha": "d7d0b38ce1dec03a01a33a8226f507dc05a10ded", "filename": "gcc/haifa-sched.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/662f8070eb0bbefc336c02147ce3030e7379fcf6/gcc%2Fhaifa-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/662f8070eb0bbefc336c02147ce3030e7379fcf6/gcc%2Fhaifa-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fhaifa-sched.c?ref=662f8070eb0bbefc336c02147ce3030e7379fcf6", "patch": "@@ -4835,6 +4835,10 @@ sched_init (void)\n     {\n       int i, max_regno = max_reg_num ();\n \n+      if (sched_dump != NULL)\n+\t/* We need info about pseudos for rtl dumps about pseudo\n+\t   classes and costs.  */\n+\tregstat_init_n_sets_and_refs ();\n       ira_set_pseudo_classes (sched_verbose ? sched_dump : NULL);\n       sched_regno_pressure_class\n \t= (enum reg_class *) xmalloc (max_regno * sizeof (enum reg_class));\n@@ -4946,6 +4950,8 @@ sched_finish (void)\n   haifa_finish_h_i_d ();\n   if (sched_pressure_p)\n     {\n+      if (regstat_n_sets_and_refs != NULL)\n+\tregstat_free_n_sets_and_refs ();\n       free (sched_regno_pressure_class);\n       BITMAP_FREE (region_ref_regs);\n       BITMAP_FREE (saved_reg_live);"}]}