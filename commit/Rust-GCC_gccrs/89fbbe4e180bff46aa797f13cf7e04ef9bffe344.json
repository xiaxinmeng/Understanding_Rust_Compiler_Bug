{"sha": "89fbbe4e180bff46aa797f13cf7e04ef9bffe344", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODlmYmJlNGUxODBiZmY0NmFhNzk3ZjEzY2Y3ZTA0ZWY5YmZmZTM0NA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2009-05-28T06:49:37Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2009-05-28T06:49:37Z"}, "message": "tree-ssa-live.c (remove_unused_locals): Skip when not optimizing.\n\n* tree-ssa-live.c (remove_unused_locals): Skip when not optimizing.\nSimplify other tests involving optimize.\n\nFrom-SVN: r147939", "tree": {"sha": "7a9076943d7e759fd36b9ae5653dd380ef72e61d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7a9076943d7e759fd36b9ae5653dd380ef72e61d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/89fbbe4e180bff46aa797f13cf7e04ef9bffe344", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89fbbe4e180bff46aa797f13cf7e04ef9bffe344", "html_url": "https://github.com/Rust-GCC/gccrs/commit/89fbbe4e180bff46aa797f13cf7e04ef9bffe344", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89fbbe4e180bff46aa797f13cf7e04ef9bffe344/comments", "author": null, "committer": null, "parents": [{"sha": "c0ba77370f931c5f7079350a3a70475fca7d4487", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0ba77370f931c5f7079350a3a70475fca7d4487", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0ba77370f931c5f7079350a3a70475fca7d4487"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "544c9886d931f7381afc8d2f7c640a752055b3dd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89fbbe4e180bff46aa797f13cf7e04ef9bffe344/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89fbbe4e180bff46aa797f13cf7e04ef9bffe344/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=89fbbe4e180bff46aa797f13cf7e04ef9bffe344", "patch": "@@ -1,3 +1,8 @@\n+2009-05-28  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* tree-ssa-live.c (remove_unused_locals): Skip when not optimizing.\n+\tSimplify other tests involving optimize.\n+\n 2009-05-27  Tom Tromey  <tromey@redhat.com>\n \n \t* unwind-dw2.c (_Unwind_DebugHook): New function."}, {"sha": "a02b1c5209f89e789f278d055c3eceb3b817edb5", "filename": "gcc/tree-ssa-live.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89fbbe4e180bff46aa797f13cf7e04ef9bffe344/gcc%2Ftree-ssa-live.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89fbbe4e180bff46aa797f13cf7e04ef9bffe344/gcc%2Ftree-ssa-live.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-live.c?ref=89fbbe4e180bff46aa797f13cf7e04ef9bffe344", "patch": "@@ -639,6 +639,12 @@ remove_unused_locals (void)\n   var_ann_t ann;\n   bitmap global_unused_vars = NULL;\n \n+  /* Removing declarations from lexical blocks when not optimizing is\n+     not only a waste of time, it actually causes differences in stack\n+     layout.  */\n+  if (!optimize)\n+    return;\n+\n   mark_scope_block_unused (DECL_INITIAL (current_function_decl));\n \n   /* Assume all locals are unused.  */\n@@ -701,8 +707,7 @@ remove_unused_locals (void)\n \n       if (TREE_CODE (var) != FUNCTION_DECL\n \t  && (!(ann = var_ann (var))\n-\t      || !ann->used)\n-\t  && (optimize || DECL_ARTIFICIAL (var)))\n+\t      || !ann->used))\n \t{\n \t  if (is_global_var (var))\n \t    {\n@@ -761,8 +766,7 @@ remove_unused_locals (void)\n \t&& TREE_CODE (t) != PARM_DECL\n \t&& TREE_CODE (t) != RESULT_DECL\n \t&& !(ann = var_ann (t))->used\n-\t&& !TREE_ADDRESSABLE (t)\n-\t&& (optimize || DECL_ARTIFICIAL (t)))\n+\t&& !TREE_ADDRESSABLE (t))\n       remove_referenced_var (t);\n   remove_unused_scope_block_p (DECL_INITIAL (current_function_decl));\n   if (dump_file && (dump_flags & TDF_DETAILS))"}]}