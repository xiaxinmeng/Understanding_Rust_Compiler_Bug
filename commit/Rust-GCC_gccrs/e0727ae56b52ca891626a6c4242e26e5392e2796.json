{"sha": "e0727ae56b52ca891626a6c4242e26e5392e2796", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTA3MjdhZTU2YjUyY2E4OTE2MjZhNmM0MjQyZTI2ZTUzOTJlMjc5Ng==", "commit": {"author": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2017-12-08T04:24:21Z"}, "committer": {"name": "Sandra Loosemore", "email": "sandra@gcc.gnu.org", "date": "2017-12-08T04:24:21Z"}, "message": "nios2.md (ld<bhw_uns>io): Add splitter for memory operand.\n\n2017-12-07  Sandra Loosemore  <sandra@codesourcery.com>\n\n\tgcc/\n\t* config/nios2/nios2.md (ld<bhw_uns>io): Add splitter for memory\n\toperand.\n\t(ld<bh>io_signed): Likewise.\n\t(st<bhw>io): Likewise.\n\t* config/nios2/predicates.md (ldstio_memory_operand): Allow\n\tSMALL_INT12 constant integer operand.\n\nFrom-SVN: r255493", "tree": {"sha": "26bd7b67126169bbd5f77c5ad3da6f0e77869d14", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26bd7b67126169bbd5f77c5ad3da6f0e77869d14"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e0727ae56b52ca891626a6c4242e26e5392e2796", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0727ae56b52ca891626a6c4242e26e5392e2796", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0727ae56b52ca891626a6c4242e26e5392e2796", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0727ae56b52ca891626a6c4242e26e5392e2796/comments", "author": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "df8ceba6a23ea326444348b922ef0550f9239107", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df8ceba6a23ea326444348b922ef0550f9239107", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df8ceba6a23ea326444348b922ef0550f9239107"}], "stats": {"total": 34, "additions": 31, "deletions": 3}, "files": [{"sha": "bea643d6285d2da0471c3baa05f070fda736b1d7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0727ae56b52ca891626a6c4242e26e5392e2796/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0727ae56b52ca891626a6c4242e26e5392e2796/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e0727ae56b52ca891626a6c4242e26e5392e2796", "patch": "@@ -1,3 +1,12 @@\n+2017-12-07  Sandra Loosemore  <sandra@codesourcery.com>\n+\n+\t* config/nios2/nios2.md (ld<bhw_uns>io): Add splitter for memory\n+\toperand.\n+\t(ld<bh>io_signed): Likewise.\n+\t(st<bhw>io): Likewise.\n+\t* config/nios2/predicates.md (ldstio_memory_operand): Allow\n+\tSMALL_INT12 constant integer operand.\n+\n 2017-12-07  Sandra Loosemore  <sandra@codesourcery.com>\n \n \t* config/nios2/nios2.c (nios2_symbolic_constant_allowed):"}, {"sha": "04693b1ab4f88ffdc778de021d7e08a59f270ae5", "filename": "gcc/config/nios2/nios2.md", "status": "modified", "additions": 20, "deletions": 3, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0727ae56b52ca891626a6c4242e26e5392e2796/gcc%2Fconfig%2Fnios2%2Fnios2.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0727ae56b52ca891626a6c4242e26e5392e2796/gcc%2Fconfig%2Fnios2%2Fnios2.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnios2%2Fnios2.md?ref=e0727ae56b52ca891626a6c4242e26e5392e2796", "patch": "@@ -318,12 +318,18 @@\n (define_mode_attr bhw [(QI \"b\") (HI \"h\") (SI \"w\")])\n (define_mode_attr bhw_uns [(QI \"bu\") (HI \"hu\") (SI \"w\")])\n \n-(define_insn \"ld<bhw_uns>io\"\n+(define_insn_and_split \"ld<bhw_uns>io\"\n   [(set (match_operand:BHW 0 \"register_operand\" \"=r\")\n         (unspec_volatile:BHW\n           [(match_operand:BHW 1 \"ldstio_memory_operand\" \"w\")] UNSPECV_LDXIO))]\n   \"\"\n   \"ld<bhw_uns>io\\\\t%0, %1\"\n+  \"nios2_large_constant_memory_operand_p (operands[1])\"\n+  [(set (match_dup 0) \n+        (unspec_volatile:BHW [(match_dup 1)] UNSPECV_LDXIO))]\n+  {\n+    operands[1] = nios2_split_large_constant_memory_operand (operands[1]);\n+  }\n   [(set_attr \"type\" \"ld\")])\n \n (define_expand \"ld<bh>io\"\n@@ -337,21 +343,32 @@\n   DONE;\n })\n \n-(define_insn \"ld<bh>io_signed\"\n+(define_insn_and_split \"ld<bh>io_signed\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n         (sign_extend:SI\n           (unspec_volatile:BH\n             [(match_operand:BH 1 \"ldstio_memory_operand\" \"w\")] UNSPECV_LDXIO)))]\n   \"\"\n   \"ld<bh>io\\\\t%0, %1\"\n+  \"nios2_large_constant_memory_operand_p (operands[1])\"\n+  [(set (match_dup 0) \n+        (sign_extend:SI (unspec_volatile:BH [(match_dup 1)] UNSPECV_LDXIO)))]\n+  {\n+    operands[1] = nios2_split_large_constant_memory_operand (operands[1]);\n+  }\n   [(set_attr \"type\" \"ld\")])\n \n-(define_insn \"st<bhw>io\"\n+(define_insn_and_split \"st<bhw>io\"\n   [(set (match_operand:BHW 0 \"ldstio_memory_operand\" \"=w\")\n         (unspec_volatile:BHW\n           [(match_operand:BHW 1 \"reg_or_0_operand\" \"rM\")] UNSPECV_STXIO))]\n   \"\"\n   \"st<bhw>io\\\\t%z1, %0\"\n+  \"nios2_large_constant_memory_operand_p (operands[0])\"\n+  [(set (match_dup 0) (unspec_volatile:BHW [(match_dup 1)] UNSPECV_STXIO))]\n+  {\n+    operands[0] = nios2_split_large_constant_memory_operand (operands[0]);\n+  }\n   [(set_attr \"type\" \"st\")])\n \n \f"}, {"sha": "d60529998c9cf3ab713a0f199e0b03dcd5ace8fc", "filename": "gcc/config/nios2/predicates.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0727ae56b52ca891626a6c4242e26e5392e2796/gcc%2Fconfig%2Fnios2%2Fpredicates.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0727ae56b52ca891626a6c4242e26e5392e2796/gcc%2Fconfig%2Fnios2%2Fpredicates.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnios2%2Fpredicates.md?ref=e0727ae56b52ca891626a6c4242e26e5392e2796", "patch": "@@ -146,6 +146,8 @@\n         return (REG_P (XEXP (addr, 0))\n                 && CONST_INT_P (XEXP (addr, 1))\n                 && SMALL_INT12 (INTVAL (XEXP (addr, 1))));\n+      else if (CONST_INT_P (addr))\n+        return SMALL_INT12 (INTVAL (addr));\n       return false;\n     }\n   return memory_operand (op, mode);"}]}