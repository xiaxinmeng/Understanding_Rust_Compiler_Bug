{"sha": "4104f0f400f167b37370cbc20f4f7da218a95ded", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDEwNGYwZjQwMGYxNjdiMzczNzBjYmMyMGY0ZjdkYTIxOGE5NWRlZA==", "commit": {"author": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@users.sourceforge.net", "date": "2004-12-08T10:25:22Z"}, "committer": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@gcc.gnu.org", "date": "2004-12-08T10:25:22Z"}, "message": "re PR c++/18100 (template member with same name as class not rejected)\n\n\tPR c++/18100\n\t* decl.c (lookup_and_check_tag): Diagnose nested class with\n\tthe same name as enclosing class.\n\n\t* g++.dg/lookup/name-clash4.C: New test.\n\nFrom-SVN: r91866", "tree": {"sha": "ba2cf8aead370d4ea6daf2310a770af38c8348f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ba2cf8aead370d4ea6daf2310a770af38c8348f3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4104f0f400f167b37370cbc20f4f7da218a95ded", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4104f0f400f167b37370cbc20f4f7da218a95ded", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4104f0f400f167b37370cbc20f4f7da218a95ded", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4104f0f400f167b37370cbc20f4f7da218a95ded/comments", "author": null, "committer": null, "parents": [{"sha": "0710ccffc3ddf8e4877fdab6cf712cd65f45d1cb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0710ccffc3ddf8e4877fdab6cf712cd65f45d1cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0710ccffc3ddf8e4877fdab6cf712cd65f45d1cb"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "13cfc69426d7fe402abb72a4139cd0b1787cf912", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=4104f0f400f167b37370cbc20f4f7da218a95ded", "patch": "@@ -1,3 +1,9 @@\n+2004-12-08  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/18100\n+\t* decl.c (lookup_and_check_tag): Diagnose nested class with \n+\tthe same name as enclosing class.\n+\n 2004-12-08  Nathan Sidwell  <nathan@codesourcery.com>\n \n \tPR c++/18803"}, {"sha": "410f686a3ae1d90cf6165310ccdcc34d9e353b46", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=4104f0f400f167b37370cbc20f4f7da218a95ded", "patch": "@@ -9169,6 +9169,18 @@ lookup_and_check_tag (enum tag_types tag_code, tree name,\n \n   if (decl && TREE_CODE (decl) == TYPE_DECL)\n     {\n+      /* Look for invalid nested type:\n+\t   class C {\n+\t     class C {};\n+\t   };  */\n+      if (scope == ts_current && DECL_SELF_REFERENCE_P (decl))\n+\t{\n+\t  error (\"%qD has the same name as the class in which it is \"\n+\t\t \"declared\",\n+\t\t decl);\n+\t  return error_mark_node;\n+\t}\n+\n       /* Two cases we need to consider when deciding if a class\n \t template is allowed as an elaborated type specifier:\n \t 1. It is a self reference to its own class."}, {"sha": "468fb31620c45a71036ce84c6009a5823e21a6cf", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4104f0f400f167b37370cbc20f4f7da218a95ded", "patch": "@@ -1,3 +1,8 @@\n+2004-12-08  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/18100\n+\t* g++.dg/lookup/name-clash4.C: New test.\n+\n 2004-12-08  Nathan Sidwell  <nathan@codesourcery.com>\n \n \tPR c++/18672"}, {"sha": "d4ff551339353ac125c398a31ca02367b94764eb", "filename": "gcc/testsuite/g++.dg/lookup/name-clash4.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fname-clash4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4104f0f400f167b37370cbc20f4f7da218a95ded/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fname-clash4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fname-clash4.C?ref=4104f0f400f167b37370cbc20f4f7da218a95ded", "patch": "@@ -0,0 +1,12 @@\n+// { dg-do compile }\n+\n+// Origin: Volker Reichelt <reichelt@gcc.gnu.org>\n+\n+// PR c++/18100: Invalid nested type.\n+\n+struct A\n+{\n+    template<int> struct A {};\t// { dg-error \"same name\" }\n+};\n+\n+A::A<0> a;\t\t\t// { dg-error \"not a template\" }"}]}