{"sha": "7cf256c3c8d9375fea7a0f02c128fa084ae53396", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2NmMjU2YzNjOGQ5Mzc1ZmVhN2EwZjAyYzEyOGZhMDg0YWU1MzM5Ng==", "commit": {"author": {"name": "Nikhil Benesch", "email": "nikhil.benesch@gmail.com", "date": "2020-10-19T02:07:34Z"}, "committer": {"name": "Ian Lance Taylor", "email": "iant@golang.org", "date": "2020-10-20T20:01:26Z"}, "message": "libgo: adjust NetBSD-specific types for stable syscall API\n\nThe backwards-compatibility guarantees of the syscall package\nrequire some munging of the C API inferred by mksysinfo.sh.\nSpecifically, the RTM_RESOLVE constant must be added if it is\nmissing, and the stat_t struct must use the suffix \"timespec\"\nrather than \"tim\" for its time-related fields.\n\nReviewed-on: https://go-review.googlesource.com/c/gofrontend/+/263519", "tree": {"sha": "e0b2c121b4537eff41fc44c5eac7520f95fef6eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e0b2c121b4537eff41fc44c5eac7520f95fef6eb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7cf256c3c8d9375fea7a0f02c128fa084ae53396", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7cf256c3c8d9375fea7a0f02c128fa084ae53396", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7cf256c3c8d9375fea7a0f02c128fa084ae53396", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7cf256c3c8d9375fea7a0f02c128fa084ae53396/comments", "author": {"login": "benesch", "id": 882976, "node_id": "MDQ6VXNlcjg4Mjk3Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/882976?v=4", "gravatar_id": "", "url": "https://api.github.com/users/benesch", "html_url": "https://github.com/benesch", "followers_url": "https://api.github.com/users/benesch/followers", "following_url": "https://api.github.com/users/benesch/following{/other_user}", "gists_url": "https://api.github.com/users/benesch/gists{/gist_id}", "starred_url": "https://api.github.com/users/benesch/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/benesch/subscriptions", "organizations_url": "https://api.github.com/users/benesch/orgs", "repos_url": "https://api.github.com/users/benesch/repos", "events_url": "https://api.github.com/users/benesch/events{/privacy}", "received_events_url": "https://api.github.com/users/benesch/received_events", "type": "User", "site_admin": false}, "committer": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "52cb0c7b0e9eaa757c70a745f737b7393ec3137e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/52cb0c7b0e9eaa757c70a745f737b7393ec3137e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/52cb0c7b0e9eaa757c70a745f737b7393ec3137e"}], "stats": {"total": 20, "additions": 16, "deletions": 4}, "files": [{"sha": "fb7aa3e6eaeca12b11556ec22f0a6a659183d3cb", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7cf256c3c8d9375fea7a0f02c128fa084ae53396/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7cf256c3c8d9375fea7a0f02c128fa084ae53396/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=7cf256c3c8d9375fea7a0f02c128fa084ae53396", "patch": "@@ -1,4 +1,4 @@\n-6662382a279dd5a5f99307e9b609654717638b24\n+b2be94556bbc98f565fc277e30a038c742bf28a4\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "deac5ce8d67d592458581bd57aa5be3598333c08", "filename": "libgo/mksysinfo.sh", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7cf256c3c8d9375fea7a0f02c128fa084ae53396/libgo%2Fmksysinfo.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7cf256c3c8d9375fea7a0f02c128fa084ae53396/libgo%2Fmksysinfo.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fmksysinfo.sh?ref=7cf256c3c8d9375fea7a0f02c128fa084ae53396", "patch": "@@ -507,6 +507,13 @@ if grep 'define st_dev st_fsid' gen-sysinfo.go > /dev/null 2>&1; then\n   st_dev='-e s/st_fsid/Dev/'\n fi\n \n+# For historical reasons Go uses the suffix \"timespec\" instead of \"tim\" for\n+# stat_t's time fields on NetBSD.\n+st_times='-e s/st_atim/Atim/ -e s/st_mtim/Mtim/ -e s/st_ctim/Ctim/'\n+if test \"${GOOS}\" = \"netbsd\"; then\n+    st_times='-e s/st_atim/Atimespec/ -e s/st_mtim/Mtimespec/ -e s/st_ctim/Ctimespec/'\n+fi\n+\n # The stat type.\n # Prefer largefile variant if available.\n stat=`grep '^type _stat64 ' gen-sysinfo.go || true`\n@@ -517,6 +524,7 @@ else\n fi | sed -e 's/type _stat64/type Stat_t/' \\\n          -e 's/type _stat/type Stat_t/' \\\n          ${st_dev} \\\n+         ${st_times} \\\n          -e 's/st_ino/Ino/g' \\\n          -e 's/st_nlink/Nlink/' \\\n          -e 's/st_mode/Mode/' \\\n@@ -526,9 +534,6 @@ fi | sed -e 's/type _stat64/type Stat_t/' \\\n          -e 's/st_size/Size/' \\\n          -e 's/st_blksize/Blksize/' \\\n          -e 's/st_blocks/Blocks/' \\\n-         -e 's/st_atim/Atim/' \\\n-         -e 's/st_mtim/Mtim/' \\\n-         -e 's/st_ctim/Ctim/' \\\n          -e 's/\\([^a-zA-Z0-9_]\\)_timeval\\([^a-zA-Z0-9_]\\)/\\1Timeval\\2/g' \\\n          -e 's/\\([^a-zA-Z0-9_]\\)_timespec_t\\([^a-zA-Z0-9_]\\)/\\1Timespec\\2/g' \\\n          -e 's/\\([^a-zA-Z0-9_]\\)_st_timespec_t\\([^a-zA-Z0-9_]\\)/\\1StTimespec\\2/g' \\\n@@ -1055,6 +1060,13 @@ grep '^const _RTCF' gen-sysinfo.go | \\\n     sed -e 's/^\\(const \\)_\\(RTCF[^= ]*\\)\\(.*\\)$/\\1\\2 = _\\2/' >> ${OUT}\n grep '^const _RTM' gen-sysinfo.go | \\\n     sed -e 's/^\\(const \\)_\\(RTM[^= ]*\\)\\(.*\\)$/\\1\\2 = _\\2/' >> ${OUT}\n+if test \"${GOOS}\" = \"netbsd\"; then\n+  if ! grep \"RTM_RESOLVE\" ${OUT} >/dev/null 2>&1; then\n+    # NetBSD 8.0 removed RTM_RESOLVE, but it is part of the syscall package's\n+    # stable API, so add it manually.\n+    echo \"const RTM_RESOLVE = 0xb\" >> ${OUT}\n+  fi\n+fi\n grep '^const _RTN' gen-sysinfo.go | \\\n     sed -e 's/^\\(const \\)_\\(RTN[^= ]*\\)\\(.*\\)$/\\1\\2 = _\\2/' >> ${OUT}\n grep '^const _RTPROT' gen-sysinfo.go | \\"}]}