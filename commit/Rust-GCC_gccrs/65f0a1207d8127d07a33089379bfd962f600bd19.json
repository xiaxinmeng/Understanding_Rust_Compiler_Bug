{"sha": "65f0a1207d8127d07a33089379bfd962f600bd19", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjVmMGExMjA3ZDgxMjdkMDdhMzMwODkzNzliZmQ5NjJmNjAwYmQxOQ==", "commit": {"author": {"name": "Gabriel Dos Reis", "email": "gdr@integrable-solutions.net", "date": "2013-08-05T08:58:27Z"}, "committer": {"name": "Gabriel Dos Reis", "email": "gdr@gcc.gnu.org", "date": "2013-08-05T08:58:27Z"}, "message": "graph.c (init_graph_slim_pretty_print): Remove.\n\n\t* graph.c (init_graph_slim_pretty_print): Remove.\n\t(print_graph_cfg): Do not call it.  Use local pretty printer.\n\t(start_graph_dump): Likewise.\n\nFrom-SVN: r201483", "tree": {"sha": "04ba52c5691b2bb5fbceff8571653c46f1dcbe00", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/04ba52c5691b2bb5fbceff8571653c46f1dcbe00"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/65f0a1207d8127d07a33089379bfd962f600bd19", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65f0a1207d8127d07a33089379bfd962f600bd19", "html_url": "https://github.com/Rust-GCC/gccrs/commit/65f0a1207d8127d07a33089379bfd962f600bd19", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65f0a1207d8127d07a33089379bfd962f600bd19/comments", "author": {"login": "cxx-undef", "id": 5528103, "node_id": "MDQ6VXNlcjU1MjgxMDM=", "avatar_url": "https://avatars.githubusercontent.com/u/5528103?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cxx-undef", "html_url": "https://github.com/cxx-undef", "followers_url": "https://api.github.com/users/cxx-undef/followers", "following_url": "https://api.github.com/users/cxx-undef/following{/other_user}", "gists_url": "https://api.github.com/users/cxx-undef/gists{/gist_id}", "starred_url": "https://api.github.com/users/cxx-undef/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cxx-undef/subscriptions", "organizations_url": "https://api.github.com/users/cxx-undef/orgs", "repos_url": "https://api.github.com/users/cxx-undef/repos", "events_url": "https://api.github.com/users/cxx-undef/events{/privacy}", "received_events_url": "https://api.github.com/users/cxx-undef/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b3f80694f51873709e2e0fee9e32484a32d28f85", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3f80694f51873709e2e0fee9e32484a32d28f85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b3f80694f51873709e2e0fee9e32484a32d28f85"}], "stats": {"total": 36, "additions": 14, "deletions": 22}, "files": [{"sha": "fb908485684adb386662d96245ab45cf7dad0dda", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65f0a1207d8127d07a33089379bfd962f600bd19/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65f0a1207d8127d07a33089379bfd962f600bd19/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=65f0a1207d8127d07a33089379bfd962f600bd19", "patch": "@@ -1,3 +1,9 @@\n+2013-08-05  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n+\n+\t* graph.c (init_graph_slim_pretty_print): Remove.\n+\t(print_graph_cfg): Do not call it.  Use local pretty printer.\n+\t(start_graph_dump): Likewise.\n+\n 2013-08-05  Gabriel Dos Reis  <gdr@integrable-solutions.net>\n \n \t* gimple-pretty-print.c (buffer): Remove."}, {"sha": "91391a67afcd52d4251f0df116752756ade3b828", "filename": "gcc/graph.c", "status": "modified", "additions": 8, "deletions": 22, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65f0a1207d8127d07a33089379bfd962f600bd19/gcc%2Fgraph.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65f0a1207d8127d07a33089379bfd962f600bd19/gcc%2Fgraph.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraph.c?ref=65f0a1207d8127d07a33089379bfd962f600bd19", "patch": "@@ -56,26 +56,6 @@ open_graph_file (const char *base, const char *mode)\n   return fp;\n }\n \n-/* Return a pretty-print buffer for output to file FP.  */\n-\n-static pretty_printer *\n-init_graph_slim_pretty_print (FILE *fp)\n-{\n-  static bool initialized = false;\n-  static pretty_printer graph_slim_pp;\n-\n-  if (! initialized)\n-    {\n-      pp_construct (&graph_slim_pp, /*prefix=*/NULL, /*linewidth=*/0);\n-      initialized = true;\n-    }\n-  else\n-    gcc_assert (! pp_last_position_in_text (&graph_slim_pp));\n-\n-  graph_slim_pp.buffer->stream = fp;\n-  return &graph_slim_pp;\n-}\n-\n /* Draw a basic block BB belonging to the function with FUNCDEF_NO\n    as its unique number.  */\n static void\n@@ -297,7 +277,10 @@ print_graph_cfg (const char *base, struct function *fun)\n {\n   const char *funcname = function_name (fun);\n   FILE *fp = open_graph_file (base, \"a\");\n-  pretty_printer *pp = init_graph_slim_pretty_print (fp);\n+  pretty_printer graph_slim_pp;\n+  pp_construct (&graph_slim_pp, /*prefix=*/NULL, /*linewidth=*/0);\n+  graph_slim_pp.buffer->stream = fp;\n+  pretty_printer *const pp = &graph_slim_pp;\n   pp_printf (pp, \"subgraph \\\"%s\\\" {\\n\"\n \t         \"\\tcolor=\\\"black\\\";\\n\"\n \t\t \"\\tlabel=\\\"%s\\\";\\n\",\n@@ -313,7 +296,10 @@ print_graph_cfg (const char *base, struct function *fun)\n static void\n start_graph_dump (FILE *fp, const char *base)\n {\n-  pretty_printer *pp = init_graph_slim_pretty_print (fp);\n+  pretty_printer graph_slim_pp;\n+  pp_construct (&graph_slim_pp, /*prefix=*/NULL, /*linewidth=*/0);\n+  graph_slim_pp.buffer->stream = fp;\n+  pretty_printer *const pp = &graph_slim_pp;\n   pp_string (pp, \"digraph \\\"\");\n   pp_write_text_to_stream (pp);\n   pp_string (pp, base);"}]}