{"sha": "72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzJjNDdlMGQzNGQ1YWY1YWI3YmI0YjI4ZTgzY2NjZWFlZDFjMGM4Mw==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2014-07-21T09:11:04Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2014-07-21T09:11:04Z"}, "message": "Fix fuse-caller-save-xmm.c test-case\n\n2014-07-21  Tom de Vries  <tom@codesourcery.com>\n\n\tPR target/61827\n\t* gcc.target/i386/fuse-caller-save-xmm.c: Add -fomit-frame-pointer to\n\tdg-options.  Add checks for insns with xmm registers.  Remove\n\tcfi_def_cfa_offset checks.  Generalize checks containing %rsp.\n\t(main): Remove.\n\nFrom-SVN: r212888", "tree": {"sha": "843f7874e1a0bc36d5aa42cca0e7f685b91eba73", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/843f7874e1a0bc36d5aa42cca0e7f685b91eba73"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83", "html_url": "https://github.com/Rust-GCC/gccrs/commit/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83/comments", "author": null, "committer": null, "parents": [{"sha": "87adf25ab975947dc35d9cfd8d311e8d732dfbeb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87adf25ab975947dc35d9cfd8d311e8d732dfbeb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87adf25ab975947dc35d9cfd8d311e8d732dfbeb"}], "stats": {"total": 37, "additions": 17, "deletions": 20}, "files": [{"sha": "aea21255401f4a4f513afc5fec23d14b482bc3b1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83", "patch": "@@ -1,3 +1,11 @@\n+2014-07-21  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR target/61827\n+\t* gcc.target/i386/fuse-caller-save-xmm.c: Add -fomit-frame-pointer to\n+\tdg-options.  Add checks for insns with xmm registers.  Remove\n+\tcfi_def_cfa_offset checks.  Generalize checks containing %rsp.\n+\t(main): Remove.\n+\n 2014-07-21  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/61855"}, {"sha": "c639936a4ca8e6379086994e22c7b0b4cf89a4fb", "filename": "gcc/testsuite/gcc.target/i386/fuse-caller-save-xmm.c", "status": "modified", "additions": 9, "deletions": 20, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuse-caller-save-xmm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuse-caller-save-xmm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuse-caller-save-xmm.c?ref=72c47e0d34d5af5ab7bb4b28e83ccceaed1c0c83", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O2 -msse -fuse-caller-save\" } */\n+/* { dg-options \"-O2 -msse -fuse-caller-save -fomit-frame-pointer\" } */\n \n typedef double v2df __attribute__((vector_size (16)));\n \n@@ -15,23 +15,12 @@ foo (v2df y)\n   return y + bar (y);\n }\n \n-int\n-main (void)\n-{\n-  int success;\n-  union {\n-    v2df v;\n-    double d[2];\n-  } u;\n-\n-  u.v = foo ((v2df){ 5.0, 5.0});\n-  success = (u.d[0] == 13.0\n-\t     && u.d[1] == 13.0);\n-\n-  return !success;\n-}\n+/* Check presence of all insns on xmm registers.  These checks are expected to\n+   pass with both -fuse-caller-save and -fno-use-caller-save.  */\n+/* { dg-final { scan-assembler-times \"addpd\\t\\\\.LC0.*, %xmm0\" 1 } } */\n+/* { dg-final { scan-assembler-times \"addpd\\t%xmm1, %xmm0\" 1 } } */\n+/* { dg-final { scan-assembler-times \"movapd\\t%xmm0, %xmm1\" 1 } } */\n \n-/* { dg-final { scan-assembler-not \"movaps\\t%xmm1, \\\\(%rsp\\\\)\" } } */\n-/* { dg-final { scan-assembler-not \"movapd\\t\\\\(%rsp\\\\), %xmm1\" } } */\n-/* { dg-final { scan-assembler-times \".cfi_def_cfa_offset 16\" 1 } } */\n-/* { dg-final { scan-assembler-times \".cfi_def_cfa_offset 32\" 1 } } */\n+/* Check absence of save/restore of xmm1 register.  */\n+/* { dg-final { scan-assembler-not \"movaps\\t%xmm1, \\\\(%\\[re\\]?sp\\\\)\" } } */\n+/* { dg-final { scan-assembler-not \"movapd\\t\\\\(%\\[re\\]?sp\\\\), %xmm1\" } } */"}]}