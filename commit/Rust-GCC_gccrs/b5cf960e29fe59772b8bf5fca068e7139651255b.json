{"sha": "b5cf960e29fe59772b8bf5fca068e7139651255b", "node_id": "C_kwDOANBUbNoAKGI1Y2Y5NjBlMjlmZTU5NzcyYjhiZjVmY2EwNjhlNzEzOTY1MTI1NWI", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2022-05-31T12:17:21Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2022-05-31T12:17:21Z"}, "message": "c++: use current_template_constraints more\n\ngcc/cp/ChangeLog:\n\n\t* decl.cc (grokvardecl): Use current_template_constraints.\n\t(grokdeclarator): Likewise.\n\t(xref_tag): Likewise.\n\t* semantics.cc (finish_template_template_parm): Likewise.", "tree": {"sha": "e17ab0e33008fad34f6e79f4bd4978b4d69aa8f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e17ab0e33008fad34f6e79f4bd4978b4d69aa8f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b5cf960e29fe59772b8bf5fca068e7139651255b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5cf960e29fe59772b8bf5fca068e7139651255b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5cf960e29fe59772b8bf5fca068e7139651255b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5cf960e29fe59772b8bf5fca068e7139651255b/comments", "author": null, "committer": null, "parents": [{"sha": "f38b20d68fade5a922b9f68c4c3841e653d1b83c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f38b20d68fade5a922b9f68c4c3841e653d1b83c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f38b20d68fade5a922b9f68c4c3841e653d1b83c"}], "stats": {"total": 20, "additions": 5, "deletions": 15}, "files": [{"sha": "663a72fae15184fcf9d23359542201c1fe2c60a2", "filename": "gcc/cp/decl.cc", "status": "modified", "additions": 4, "deletions": 13, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5cf960e29fe59772b8bf5fca068e7139651255b/gcc%2Fcp%2Fdecl.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5cf960e29fe59772b8bf5fca068e7139651255b/gcc%2Fcp%2Fdecl.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.cc?ref=b5cf960e29fe59772b8bf5fca068e7139651255b", "patch": "@@ -10789,9 +10789,7 @@ grokvardecl (tree type,\n   else if (flag_concepts\n \t   && current_template_depth > template_class_depth (scope))\n     {\n-      tree reqs = TEMPLATE_PARMS_CONSTRAINTS (current_template_parms);\n-      tree ci = build_constraints (reqs, NULL_TREE);\n-\n+      tree ci = current_template_constraints ();\n       set_constraints (decl, ci);\n     }\n \n@@ -14227,9 +14225,7 @@ grokdeclarator (const cp_declarator *declarator,\n \t\t\t\t> template_class_depth (current_class_type));\n \t\tif (memtmpl)\n \t\t  {\n-\t\t    tree tmpl_reqs\n-\t\t      = TEMPLATE_PARMS_CONSTRAINTS (current_template_parms);\n-\t\t    tree ci = build_constraints (tmpl_reqs, NULL_TREE);\n+\t\t    tree ci = current_template_constraints ();\n \t\t    set_constraints (decl, ci);\n \t\t  }\n \t      }\n@@ -15852,13 +15848,8 @@ xref_tag (enum tag_types tag_code, tree name,\n         {\n           /* Check that we aren't trying to overload a class with different\n              constraints.  */\n-          tree constr = NULL_TREE;\n-          if (current_template_parms)\n-            {\n-              tree reqs = TEMPLATE_PARMS_CONSTRAINTS (current_template_parms);\n-              constr = build_constraints (reqs, NULL_TREE);\n-            }\n-\t  if (!redeclare_class_template (t, current_template_parms, constr))\n+\t  if (!redeclare_class_template (t, current_template_parms,\n+\t\t\t\t\t current_template_constraints ()))\n \t    return error_mark_node;\n         }\n       else if (!processing_template_decl"}, {"sha": "3600d270ff8d3e891b071e3a768d311f9e517259", "filename": "gcc/cp/semantics.cc", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5cf960e29fe59772b8bf5fca068e7139651255b/gcc%2Fcp%2Fsemantics.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5cf960e29fe59772b8bf5fca068e7139651255b/gcc%2Fcp%2Fsemantics.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.cc?ref=b5cf960e29fe59772b8bf5fca068e7139651255b", "patch": "@@ -3387,8 +3387,7 @@ finish_template_template_parm (tree aggr, tree identifier)\n \n   /* Associate the constraints with the underlying declaration,\n      not the template.  */\n-  tree reqs = TEMPLATE_PARMS_CONSTRAINTS (current_template_parms);\n-  tree constr = build_constraints (reqs, NULL_TREE);\n+  tree constr = current_template_constraints ();\n   set_constraints (decl, constr);\n \n   end_template_decl ();"}]}