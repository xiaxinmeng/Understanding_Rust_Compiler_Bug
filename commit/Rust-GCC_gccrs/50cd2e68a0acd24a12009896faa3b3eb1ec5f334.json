{"sha": "50cd2e68a0acd24a12009896faa3b3eb1ec5f334", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTBjZDJlNjhhMGFjZDI0YTEyMDA5ODk2ZmFhM2IzZWIxZWM1ZjMzNA==", "commit": {"author": {"name": "Karl Berry", "email": "karl@gnu.org", "date": "1997-05-05T21:06:33Z"}, "committer": {"name": "Karl Berry", "email": "karl@gnu.org", "date": "1997-05-05T21:06:33Z"}, "message": "(\\onepageout): \\ifcropmarks, center the page body.\n\nLost this when merged \\croppageout with \\onepageout.\nFound by Arnold.\n\n(\\doprintindex): Do not bother to go into double column mode unless\nthere actually is a non-empty index.\n\n(\\begindoublecolumns): Include any existing \\partialpage in the new one,\nlest we lose a whole page of output.\nFound by M J Morley <mjm@scs.leeds.ac.uk>.\n\n(\\chapternofonts): Remove spurious spaces, both in the definitions that\nget output to the aux file(s) and in this macro.\n\nFix comments and rationalize whitespace in various other places.\n\nFrom-SVN: r14015", "tree": {"sha": "20cfea03242b041845b1bc9c9842b741ab163cd8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/20cfea03242b041845b1bc9c9842b741ab163cd8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/50cd2e68a0acd24a12009896faa3b3eb1ec5f334", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50cd2e68a0acd24a12009896faa3b3eb1ec5f334", "html_url": "https://github.com/Rust-GCC/gccrs/commit/50cd2e68a0acd24a12009896faa3b3eb1ec5f334", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50cd2e68a0acd24a12009896faa3b3eb1ec5f334/comments", "author": null, "committer": null, "parents": [{"sha": "3f76745e0104f5da78cc456ef85464a8e915e25e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3f76745e0104f5da78cc456ef85464a8e915e25e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3f76745e0104f5da78cc456ef85464a8e915e25e"}], "stats": {"total": 223, "additions": 119, "deletions": 104}, "files": [{"sha": "bba5d577ccb23c75b7b68092f8131c9ef873bc9c", "filename": "gcc/texinfo.tex", "status": "modified", "additions": 119, "deletions": 104, "changes": 223, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/50cd2e68a0acd24a12009896faa3b3eb1ec5f334/gcc%2Ftexinfo.tex", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/50cd2e68a0acd24a12009896faa3b3eb1ec5f334/gcc%2Ftexinfo.tex", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftexinfo.tex?ref=50cd2e68a0acd24a12009896faa3b3eb1ec5f334", "patch": "@@ -1,5 +1,5 @@\n %% TeX macros to handle Texinfo files.\n-%% $Id: texinfo.tex,v 2.197 1997/04/26 23:22:03 karl Exp $\n+%% $Id: texinfo.tex,v 2.197 1997/04/27 19:40:44 karl Exp karl $\n \n %  Copyright (C) 1985, 86, 88, 90, 91, 92, 93,\n %                94, 95, 96, 97 Free Software Foundation, Inc.\n@@ -147,11 +147,7 @@\n % \\onepageout takes a vbox as an argument.  Note that \\pagecontents\n % does insertions, but you have to call it yourself.\n \\def\\onepageout#1{%\n-  \\ifcropmarks\n-    \\hoffset = 0pt\n-  \\else\n-    \\hoffset = \\normaloffset\n-  \\fi\n+  \\ifcropmarks \\hoffset=0pt \\else \\hoffset=\\normaloffset \\fi\n   %\n   \\ifodd\\pageno  \\advance\\hoffset by \\bindingoffset\n   \\else \\advance\\hoffset by -\\bindingoffset\\fi\n@@ -171,37 +167,42 @@\n     \\normalturnoffactive  % \\ in index entries must not stay \\, e.g., if\n                    % the page break happens to be in the middle of an example.\n     \\shipout\\vbox{%\n-      \\ifcropmarks\n-        \\vbox to \\outervsize\\bgroup\n-          \\hsize = \\outerhsize\n-          \\vbox{\\line{\\ewtop\\hfill\\ewtop}}%\n-          \\nointerlineskip\n-          \\line{%\n-            \\vbox{\\moveleft\\cornerthick\\nstop}%\n-            \\hfill\n-            \\vbox{\\moveright\\cornerthick\\nstop}%\n-          }%\n-          \\vskip\\topandbottommargin\n+      \\ifcropmarks \\vbox to \\outervsize\\bgroup\n+        \\hsize = \\outerhsize\n+        \\line{\\ewtop\\hfil\\ewtop}%\n+        \\nointerlineskip\n+        \\line{%\n+          \\vbox{\\moveleft\\cornerthick\\nstop}%\n+          \\hfill\n+          \\vbox{\\moveright\\cornerthick\\nstop}%\n+        }%\n+        \\vskip\\topandbottommargin\n+        \\line\\bgroup\n+          \\hfil % center the page within the outer (page) hsize.\n+          \\ifodd\\pageno\\hskip\\bindingoffset\\fi\n+          \\vbox\\bgroup\n       \\fi\n       %\n       \\unvbox\\headlinebox\n       \\pagebody{#1}%\n       \\unvbox\\footlinebox\n       %\n       \\ifcropmarks\n-          \\vskip\\topandbottommargin plus1fill minus1fill\n-          \\boxmaxdepth = \\cornerthick\n-          \\line{%\n-            \\vbox{\\moveleft\\cornerthick\\nsbot}%\n-            \\hfill\n-            \\vbox{\\moveright\\cornerthick\\nsbot}%\n-          }%\n-          \\nointerlineskip\n-          \\vbox{\\line{\\ewbot\\hfill\\ewbot}}%\n-        \\egroup % \\vbox from first cropmarks clause\n+          \\egroup % end of \\vbox\\bgroup\n+        \\hfil\\egroup % end of (centering) \\line\\bgroup\n+        \\vskip\\topandbottommargin plus1fill minus1fill\n+        \\boxmaxdepth = \\cornerthick\n+        \\line{%\n+          \\vbox{\\moveleft\\cornerthick\\nsbot}%\n+          \\hfill\n+          \\vbox{\\moveright\\cornerthick\\nsbot}%\n+        }%\n+        \\nointerlineskip\n+        \\line{\\ewbot\\hfil\\ewbot}%\n+      \\egroup % \\vbox from first cropmarks clause\n       \\fi\n-    }%\n-    }%\n+    }% end of \\shipout\\vbox\n+  }% end of group with \\turnoffactive\n   \\advancepageno\n   \\ifnum\\outputpenalty>-20000 \\else\\dosupereject\\fi\n }\n@@ -219,7 +220,6 @@\n \\ifr@ggedbottom \\kern-\\dimen@ \\vfil \\fi}\n }\n \n-%\n % Here are the rules for the cropmarks.  Note that they are\n % offset so that the space between them is truly \\outerhsize or \\outervsize\n % (P. A. MacKay, 12 November, 1986)\n@@ -2408,27 +2408,16 @@\n \n % Define the macros used in formatting output of the sorted index material.\n \n-% This is what you call to cause a particular index to get printed.\n-% Write\n-% @unnumbered Function Index\n-% @printindex fn\n-\n+% @printindex causes a particular index (the ??s file) to get printed.\n+% It does not print any chapter heading (usually an @unnumbered).\n+%\n \\def\\printindex{\\parsearg\\doprintindex}\n-\n \\def\\doprintindex#1{\\begingroup\n   \\dobreak \\chapheadingskip{10000}%\n   %\n   \\indexfonts \\rm\n   \\tolerance = 9500\n   \\indexbreaks\n-  \\def\\indexbackslash{\\rawbackslashxx}%\n-  % Index files are almost Texinfo source, but we use \\ as the escape\n-  % character.  It would be better to use @, but that's too big a change\n-  % to make right now.\n-  \\catcode`\\\\ = 0\n-  \\catcode`\\@ = 11\n-  \\escapechar = `\\\\\n-  \\begindoublecolumns\n   %\n   % See if the index file exists and is nonempty.\n   \\openin 1 \\jobname.#1s\n@@ -2447,11 +2436,19 @@\n     \\ifeof 1\n       (Index is empty)\n     \\else\n+      % Index files are almost Texinfo source, but we use \\ as the escape\n+      % character.  It would be better to use @, but that's too big a change\n+      % to make right now.\n+      \\def\\indexbackslash{\\rawbackslashxx}%\n+      \\catcode`\\\\ = 0\n+      \\catcode`\\@ = 11\n+      \\escapechar = `\\\\\n+      \\begindoublecolumns\n       \\input \\jobname.#1s\n+      \\enddoublecolumns\n     \\fi\n   \\fi\n   \\closein 1\n-  \\enddoublecolumns\n \\endgroup}\n \n % These macros are used by the sorted index file itself.\n@@ -2553,24 +2550,39 @@\n \n \\def\\begindoublecolumns{\\begingroup % ended by \\enddoublecolumns\n   % Grab any single-column material above us.\n-  \\output = {\\global\\setbox\\partialpage\n-    =\\vbox{\\unvbox255\\kern -\\topskip \\kern \\baselineskip}}%\n+  \\output = {\\global\\setbox\\partialpage = \\vbox{%\n+    % \n+    % Here is a possibility not foreseen in manmac: if we accumulate a\n+    % whole lot of material, we might end up calling this \\output\n+    % routine twice in a row (see the doublecol-lose test, which is\n+    % essentially a couple of indexes with @setchapternewpage off).  In\n+    % that case, we must prevent the second \\partialpage from\n+    % simply overwriting the first, causing us to lose the page.\n+    % This will preserve it until a real output routine can ship it\n+    % out.  Generally, \\partialpage will be empty when this runs and\n+    % this will be a no-op.\n+    \\unvbox\\partialpage\n+    %\n+    % Unvbox the main output page.\n+    \\unvbox255\n+    \\kern-\\topskip \\kern\\baselineskip\n+  }}%\n   \\eject\n   %\n-  % Now switch to the double-column output routine.\n-  \\output={\\doublecolumnout}%\n+  % Use the double-column output routine for subsequent pages.\n+  \\output = {\\doublecolumnout}%\n   %\n   % Change the page size parameters.  We could do this once outside this\n   % routine, in each of @smallbook, @afourpaper, and the default 8.5x11\n   % format, but then we repeat the same computation.  Repeating a couple\n   % of assignments once per index is clearly meaningless for the\n-  % execution time, so we may as well do it once.\n+  % execution time, so we may as well do it in one place.\n   %\n   % First we halve the line length, less a little for the gutter between\n   % the columns.  We compute the gutter based on the line length, so it\n   % changes automatically with the paper format.  The magic constant\n-  % below is chosen so that the gutter has the same value (well, +- <\n-  % 1pt) as it did when we hard-coded it.\n+  % below is chosen so that the gutter has the same value (well, +-<1pt)\n+  % as it did when we hard-coded it.\n   %\n   % We put the result in a separate register, \\doublecolumhsize, so we\n   % can restore it in \\pagesofar, after \\hsize itself has (potentially)\n@@ -2591,100 +2603,103 @@\n   % (undoubled) page height minus any material left over from the\n   % previous page.\n   \\dimen@=\\pageheight \\advance\\dimen@ by-\\ht\\partialpage\n-  % box0 will be the left-hand column, box1 the right.\n+  % box0 will be the left-hand column, box2 the right.\n   \\setbox0=\\vsplit255 to\\dimen@ \\setbox2=\\vsplit255 to\\dimen@\n   \\onepageout\\pagesofar\n-  \\unvbox255 \\penalty\\outputpenalty\n+  \\unvbox255\n+  \\penalty\\outputpenalty\n }\n \\def\\pagesofar{%\n-  % The contents of the output page -- any previous material,\n+  % Re-output the contents of the output page -- any previous material,\n   % followed by the two boxes we just split.\n   \\unvbox\\partialpage\n   \\hsize = \\doublecolumnhsize\n   \\wd0=\\hsize \\wd2=\\hsize \\hbox to\\pagewidth{\\box0\\hfil\\box2}%\n }\n \\def\\enddoublecolumns{%\n-  \\output={\\balancecolumns}\\eject % split what we have\n-  \\endgroup\n+  \\output = {\\balancecolumns}\\eject % split what we have\n+  \\endgroup % started in \\begindoublecolumns\n+  %\n   % Back to normal single-column typesetting, but take account of the\n   % fact that we just accumulated some stuff on the output page.\n-  \\pagegoal=\\vsize\n+  \\pagegoal = \\vsize\n }\n \\def\\balancecolumns{%\n-  % Called on the last page of the double column material.\n-  \\setbox0=\\vbox{\\unvbox255}%\n+  % Called at the end of the double column material.\n+  \\setbox0 = \\vbox{\\unvbox255}%\n   \\dimen@ = \\ht0\n   \\advance\\dimen@ by \\topskip\n   \\advance\\dimen@ by-\\baselineskip\n   \\divide\\dimen@ by 2\n   \\splittopskip = \\topskip\n   % Loop until we get a decent breakpoint.\n-  {\\vbadness=10000 \\loop \\global\\setbox3=\\copy0\n+  {\\vbadness=10000 \\loop\n+    \\global\\setbox3=\\copy0\n     \\global\\setbox1=\\vsplit3 to\\dimen@\n-    \\ifdim\\ht3>\\dimen@ \\global\\advance\\dimen@ by1pt \\repeat}%\n+    \\ifdim\\ht3>\\dimen@ \\global\\advance\\dimen@ by1pt\n+   \\repeat}%\n   \\setbox0=\\vbox to\\dimen@{\\unvbox1}%\n   \\setbox2=\\vbox to\\dimen@{\\unvbox3}%\n   \\pagesofar\n }\n-\\catcode `\\@=\\other\n+\\catcode`\\@ = \\other\n \n \n \\message{sectioning,}\n % Define chapters, sections, etc.\n \n-\\newcount \\chapno\n-\\newcount \\secno        \\secno=0\n-\\newcount \\subsecno     \\subsecno=0\n-\\newcount \\subsubsecno  \\subsubsecno=0\n+\\newcount\\chapno\n+\\newcount\\secno        \\secno=0\n+\\newcount\\subsecno     \\subsecno=0\n+\\newcount\\subsubsecno  \\subsubsecno=0\n \n % This counter is funny since it counts through charcodes of letters A, B, ...\n-\\newcount \\appendixno  \\appendixno = `\\@\n+\\newcount\\appendixno  \\appendixno = `\\@\n \\def\\appendixletter{\\char\\the\\appendixno}\n \n-\\newwrite \\contentsfile\n+\\newwrite\\contentsfile\n % This is called from \\setfilename.\n-\\def\\opencontents{\\openout \\contentsfile = \\jobname.toc}\n+\\def\\opencontents{\\openout\\contentsfile = \\jobname.toc }\n \n % Each @chapter defines this as the name of the chapter.\n % page headings and footings can use it.  @section does likewise\n \n \\def\\thischapter{} \\def\\thissection{}\n-\\def\\seccheck#1{\\if \\pageno<0 %\n-\\errmessage{@#1 not allowed after generating table of contents}\\fi\n-%\n-}\n+\\def\\seccheck#1{\\ifnum \\pageno<0\n+  \\errmessage{@#1 not allowed after generating table of contents}%\n+\\fi}\n \n \\def\\chapternofonts{%\n-\\let\\rawbackslash=\\relax%\n-\\let\\frenchspacing=\\relax%\n-\\def\\result{\\realbackslash result}\n-\\def\\equiv{\\realbackslash equiv}\n-\\def\\expansion{\\realbackslash expansion}\n-\\def\\print{\\realbackslash print}\n-\\def\\TeX{\\realbackslash TeX}\n-\\def\\dots{\\realbackslash dots}\n-\\def\\copyright{\\realbackslash copyright}\n-\\def\\tt{\\realbackslash tt}\n-\\def\\bf{\\realbackslash bf }\n-\\def\\w{\\realbackslash w}\n-\\def\\less{\\realbackslash less}\n-\\def\\gtr{\\realbackslash gtr}\n-\\def\\hat{\\realbackslash hat}\n-\\def\\char{\\realbackslash char}\n-\\def\\tclose##1{\\realbackslash tclose {##1}}\n-\\def\\code##1{\\realbackslash code {##1}}\n-\\def\\samp##1{\\realbackslash samp {##1}}\n-\\def\\r##1{\\realbackslash r {##1}}\n-\\def\\b##1{\\realbackslash b {##1}}\n-\\def\\key##1{\\realbackslash key {##1}}\n-\\def\\file##1{\\realbackslash file {##1}}\n-\\def\\kbd##1{\\realbackslash kbd {##1}}\n-% These are redefined because @smartitalic wouldn't work inside xdef.\n-\\def\\i##1{\\realbackslash i {##1}}\n-\\def\\cite##1{\\realbackslash cite {##1}}\n-\\def\\var##1{\\realbackslash var {##1}}\n-\\def\\emph##1{\\realbackslash emph {##1}}\n-\\def\\dfn##1{\\realbackslash dfn {##1}}\n+  \\let\\rawbackslash=\\relax\n+  \\let\\frenchspacing=\\relax\n+  \\def\\result{\\realbackslash result}%\n+  \\def\\equiv{\\realbackslash equiv}%\n+  \\def\\expansion{\\realbackslash expansion}%\n+  \\def\\print{\\realbackslash print}%\n+  \\def\\TeX{\\realbackslash TeX}%\n+  \\def\\dots{\\realbackslash dots}%\n+  \\def\\copyright{\\realbackslash copyright}%\n+  \\def\\tt{\\realbackslash tt}%\n+  \\def\\bf{\\realbackslash bf}%\n+  \\def\\w{\\realbackslash w}%\n+  \\def\\less{\\realbackslash less}%\n+  \\def\\gtr{\\realbackslash gtr}%\n+  \\def\\hat{\\realbackslash hat}%\n+  \\def\\char{\\realbackslash char}%\n+  \\def\\tclose##1{\\realbackslash tclose{##1}}%\n+  \\def\\code##1{\\realbackslash code{##1}}%\n+  \\def\\samp##1{\\realbackslash samp{##1}}%\n+  \\def\\r##1{\\realbackslash r{##1}}%\n+  \\def\\b##1{\\realbackslash b{##1}}%\n+  \\def\\key##1{\\realbackslash key{##1}}%\n+  \\def\\file##1{\\realbackslash file{##1}}%\n+  \\def\\kbd##1{\\realbackslash kbd{##1}}%\n+  % These are redefined because @smartitalic wouldn't work inside xdef.\n+  \\def\\i##1{\\realbackslash i{##1}}%\n+  \\def\\cite##1{\\realbackslash cite{##1}}%\n+  \\def\\var##1{\\realbackslash var{##1}}%\n+  \\def\\emph##1{\\realbackslash emph{##1}}%\n+  \\def\\dfn##1{\\realbackslash dfn{##1}}%\n }\n \n \\newcount\\absseclevel % used to calculate proper heading level"}]}