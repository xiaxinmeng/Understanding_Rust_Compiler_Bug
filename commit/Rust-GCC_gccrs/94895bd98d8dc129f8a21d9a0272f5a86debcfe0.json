{"sha": "94895bd98d8dc129f8a21d9a0272f5a86debcfe0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQ4OTViZDk4ZDhkYzEyOWY4YTIxZDlhMDI3MmY1YTg2ZGViY2ZlMA==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2017-06-05T16:49:04Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2017-06-05T16:49:04Z"}, "message": "PR libstdc++/80939 Remove unmeetable constexpr specifiers\n\n\tPR libstdc++/80939\n\t* include/std/variant (__erased_ctor, __erased_assign, __erased_swap)\n\t(__erased_hash): Remove constexpr specifier and qualify calls to\n\t__ref_cast.\n\t(__erased_dtor): Remove constexpr specifier and use _Destroy.\n\nFrom-SVN: r248881", "tree": {"sha": "fb2a8e9574c41290d48b5ce40a02498dac8df7b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fb2a8e9574c41290d48b5ce40a02498dac8df7b7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/94895bd98d8dc129f8a21d9a0272f5a86debcfe0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94895bd98d8dc129f8a21d9a0272f5a86debcfe0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94895bd98d8dc129f8a21d9a0272f5a86debcfe0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94895bd98d8dc129f8a21d9a0272f5a86debcfe0/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3c5a5b930d72ae41e8894f14d227d9d81bcb7edf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c5a5b930d72ae41e8894f14d227d9d81bcb7edf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3c5a5b930d72ae41e8894f14d227d9d81bcb7edf"}], "stats": {"total": 41, "additions": 27, "deletions": 14}, "files": [{"sha": "9abc73cb5791813fbfdf81f4f64e15739215d25d", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94895bd98d8dc129f8a21d9a0272f5a86debcfe0/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94895bd98d8dc129f8a21d9a0272f5a86debcfe0/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=94895bd98d8dc129f8a21d9a0272f5a86debcfe0", "patch": "@@ -1,3 +1,11 @@\n+2017-06-02  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/80939\n+\t* include/std/variant (__erased_ctor, __erased_assign, __erased_swap)\n+\t(__erased_hash): Remove constexpr specifier and qualify calls to\n+\t__ref_cast.\n+\t(__erased_dtor): Remove constexpr specifier and use _Destroy.\n+\n 2017-06-05  Jonathan Wakely  <jwakely@redhat.com>\n \n \t* include/bits/stl_iterator_base_funcs.h"}, {"sha": "e5fe9f927c1621e3959464e8277489b756d02547", "filename": "libstdc++-v3/include/std/variant", "status": "modified", "additions": 19, "deletions": 14, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94895bd98d8dc129f8a21d9a0272f5a86debcfe0/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvariant", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94895bd98d8dc129f8a21d9a0272f5a86debcfe0/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvariant", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvariant?ref=94895bd98d8dc129f8a21d9a0272f5a86debcfe0", "patch": "@@ -44,6 +44,9 @@\n #include <bits/invoke.h>\n #include <ext/aligned_buffer.h>\n #include <bits/parse_numbers.h>\n+#include <bits/stl_iterator_base_types.h>\n+#include <bits/stl_iterator_base_funcs.h>\n+#include <bits/stl_construct.h>\n \n namespace std _GLIBCXX_VISIBILITY(default)\n {\n@@ -238,30 +241,32 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n   // Various functions as \"vtable\" entries, where those vtables are used by\n   // polymorphic operations.\n   template<typename _Lhs, typename _Rhs>\n-    constexpr void\n+    void\n     __erased_ctor(void* __lhs, void* __rhs)\n-    { ::new (__lhs) remove_reference_t<_Lhs>(__ref_cast<_Rhs>(__rhs)); }\n+    {\n+      using _Type = remove_reference_t<_Lhs>;\n+      ::new (__lhs) _Type(__variant::__ref_cast<_Rhs>(__rhs));\n+    }\n \n   template<typename _Variant, size_t _Np>\n-    constexpr void\n+    void\n     __erased_dtor(_Variant&& __v)\n-    {\n-      auto&& __element = __get<_Np>(std::forward<_Variant>(__v));\n-      using _Type = std::remove_reference_t<decltype(__element)>;\n-      __element.~_Type();\n-    }\n+    { std::_Destroy(std::__addressof(__get<_Np>(__v))); }\n \n   template<typename _Lhs, typename _Rhs>\n-    constexpr void\n+    void\n     __erased_assign(void* __lhs, void* __rhs)\n-    { __ref_cast<_Lhs>(__lhs) = __ref_cast<_Rhs>(__rhs); }\n+    {\n+      __variant::__ref_cast<_Lhs>(__lhs) = __variant::__ref_cast<_Rhs>(__rhs);\n+    }\n \n   template<typename _Lhs, typename _Rhs>\n-    constexpr void\n+    void\n     __erased_swap(void* __lhs, void* __rhs)\n     {\n       using std::swap;\n-      swap(__ref_cast<_Lhs>(__lhs), __ref_cast<_Rhs>(__rhs));\n+      swap(__variant::__ref_cast<_Lhs>(__lhs),\n+\t   __variant::__ref_cast<_Rhs>(__rhs));\n     }\n \n #define _VARIANT_RELATION_FUNCTION_TEMPLATE(__OP, __NAME) \\\n@@ -283,11 +288,11 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n #undef _VARIANT_RELATION_FUNCTION_TEMPLATE\n \n   template<typename _Tp>\n-    constexpr size_t\n+    size_t\n     __erased_hash(void* __t)\n     {\n       return std::hash<remove_cv_t<remove_reference_t<_Tp>>>{}(\n-\t  __ref_cast<_Tp>(__t));\n+\t  __variant::__ref_cast<_Tp>(__t));\n     }\n \n   // Defines members and ctors."}]}