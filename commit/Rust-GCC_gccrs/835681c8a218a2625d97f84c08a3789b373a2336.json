{"sha": "835681c8a218a2625d97f84c08a3789b373a2336", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODM1NjgxYzhhMjE4YTI2MjVkOTdmODRjMDhhMzc4OWIzNzNhMjMzNg==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@verizon.net", "date": "2005-10-24T03:51:24Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2005-10-24T03:51:24Z"}, "message": "re PR libfortran/24489 (read_block wrong execution order)\n\n2005-10-23  Jerry DeLisle  <jvdelisle@verizon.net>\n\n        PR libgfortran/24489\n        * io/transfer.c (read_block): Change the order of execution to not read\n        past end-of-record.\n        (read_block_direct): Same change.\n\nFrom-SVN: r105840", "tree": {"sha": "6b79cd06e656c4d0572adf233e3348fe44ce4a2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6b79cd06e656c4d0572adf233e3348fe44ce4a2a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/835681c8a218a2625d97f84c08a3789b373a2336", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/835681c8a218a2625d97f84c08a3789b373a2336", "html_url": "https://github.com/Rust-GCC/gccrs/commit/835681c8a218a2625d97f84c08a3789b373a2336", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/835681c8a218a2625d97f84c08a3789b373a2336/comments", "author": null, "committer": null, "parents": [{"sha": "9da7372540424be93813a529fd479be069daea91", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9da7372540424be93813a529fd479be069daea91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9da7372540424be93813a529fd479be069daea91"}], "stats": {"total": 33, "additions": 20, "deletions": 13}, "files": [{"sha": "6dd23590d523e443f1bfd9e0927715ad0160ebde", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/835681c8a218a2625d97f84c08a3789b373a2336/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/835681c8a218a2625d97f84c08a3789b373a2336/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=835681c8a218a2625d97f84c08a3789b373a2336", "patch": "@@ -1,3 +1,10 @@\n+2005-10-23  Jerry DeLisle  <jvdelisle@verizon.net>\n+\n+        PR libgfortran/24489\n+        * io/transfer.c (read_block): Change the order of execution to not read\n+        past end-of-record.\n+        (read_block_direct): Same change.\n+\n 2005-10-23  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR libfortran/23272"}, {"sha": "efd8e9dde4f8519a32ceadf6450611e7bf81a630", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 13, "deletions": 13, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/835681c8a218a2625d97f84c08a3789b373a2336/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/835681c8a218a2625d97f84c08a3789b373a2336/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=835681c8a218a2625d97f84c08a3789b373a2336", "patch": "@@ -248,10 +248,6 @@ read_block (int *length)\n   char *source;\n   int nread;\n \n-  if (current_unit->flags.form == FORM_FORMATTED &&\n-      current_unit->flags.access == ACCESS_SEQUENTIAL)\n-    return read_sf (length);\t/* Special case.  */\n-\n   if (current_unit->bytes_left < *length)\n     {\n       if (current_unit->flags.pad == PAD_NO)\n@@ -262,6 +258,10 @@ read_block (int *length)\n \n       *length = current_unit->bytes_left;\n     }\n+    \n+  if (current_unit->flags.form == FORM_FORMATTED &&\n+      current_unit->flags.access == ACCESS_SEQUENTIAL)\n+    return read_sf (length);\t/* Special case.  */\n \n   current_unit->bytes_left -= *length;\n \n@@ -295,15 +295,6 @@ read_block_direct (void * buf, size_t * nbytes)\n   void *data;\n   size_t nread;\n \n-  if (current_unit->flags.form == FORM_FORMATTED &&\n-      current_unit->flags.access == ACCESS_SEQUENTIAL)\n-    {\n-      length = (int*) nbytes;\n-      data = read_sf (length);\t/* Special case.  */\n-      memcpy (buf, data, (size_t) *length);\n-      return;\n-    }\n-\n   if (current_unit->bytes_left < *nbytes)\n     {\n       if (current_unit->flags.pad == PAD_NO)\n@@ -315,6 +306,15 @@ read_block_direct (void * buf, size_t * nbytes)\n       *nbytes = current_unit->bytes_left;\n     }\n \n+  if (current_unit->flags.form == FORM_FORMATTED &&\n+      current_unit->flags.access == ACCESS_SEQUENTIAL)\n+    {\n+      length = (int*) nbytes;\n+      data = read_sf (length);\t/* Special case.  */\n+      memcpy (buf, data, (size_t) *length);\n+      return;\n+    }\n+\n   current_unit->bytes_left -= *nbytes;\n \n   nread = *nbytes;"}]}