{"sha": "cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2RiM2YyZjQzMTRmNWNkNzI5MjdlYjdmNjIwZTFkZjE0ZTFkYTU3NA==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2018-11-06T15:08:46Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2018-11-06T15:08:46Z"}, "message": "Fix D compilation on Solaris\n\n\t* config/default-d.c: Include memmodel.h.\n\n\t* config/sol2-d.c: New file.\n\t* config/t-sol2 (sol2-d.o): New rule.\n\t* config.gcc <*-*-solaris2*>: Set d_target_objs,\n\ttarget_has_targetdm.\n\nFrom-SVN: r265846", "tree": {"sha": "be1ad2eca3c953039e51178dec64956bf58b03db", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/be1ad2eca3c953039e51178dec64956bf58b03db"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f8d69798fd096ab6fca98ab189f31b31cb004502", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8d69798fd096ab6fca98ab189f31b31cb004502", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f8d69798fd096ab6fca98ab189f31b31cb004502"}], "stats": {"total": 70, "additions": 69, "deletions": 1}, "files": [{"sha": "77fcf1e3d3c5748fdb0b4bd4ebaefdd111550f26", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "patch": "@@ -1,3 +1,12 @@\n+2018-11-06  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* config/default-d.c: Include memmodel.h.\n+\n+\t* config/sol2-d.c: New file.\n+\t* config/t-sol2 (sol2-d.o): New rule.\n+\t* config.gcc <*-*-solaris2*>: Set d_target_objs,\n+\ttarget_has_targetdm.\n+\n 2018-11-06  Jan Hubicka  <jh@suse.cz>\n \n \t* tree.c (fld_type_variant): Also copy alignment; be sure that"}, {"sha": "284f7d178de93fbe22aa5c0bede6e82ba88874b1", "filename": "gcc/config.gcc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "patch": "@@ -917,13 +917,15 @@ case ${target} in\n   tmake_file=\"${tmake_file} t-sol2 t-slibgcc\"\n   c_target_objs=\"${c_target_objs} sol2-c.o\"\n   cxx_target_objs=\"${cxx_target_objs} sol2-c.o sol2-cxx.o\"\n+  d_target_objs=\"${d_target_objs} sol2-d.o\"\n   extra_objs=\"${extra_objs} sol2.o sol2-stubs.o\"\n   extra_options=\"${extra_options} sol2.opt\"\n   case ${enable_threads}:${have_pthread_h}:${have_thread_h} in\n     \"\":yes:* | yes:yes:* )\n       thread_file=posix\n       ;;\n   esac\n+  target_has_targetdm=yes\n   ;;\n *-*-*vms*)\n   extra_options=\"${extra_options} vms/vms.opt\""}, {"sha": "85c70e071fa487141265003ad198d2d92fdcb72d", "filename": "gcc/config/default-d.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig%2Fdefault-d.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig%2Fdefault-d.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdefault-d.c?ref=cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "patch": "@@ -18,6 +18,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"config.h\"\n #include \"system.h\"\n #include \"coretypes.h\"\n+#include \"memmodel.h\"\n #include \"tm_d.h\"\n #include \"d/d-target.h\"\n #include \"d/d-target-def.h\""}, {"sha": "534ad2a3c9123cc1feb6a2a00f309435c2b3b904", "filename": "gcc/config/sol2-d.c", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig%2Fsol2-d.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig%2Fsol2-d.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsol2-d.c?ref=cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "patch": "@@ -0,0 +1,51 @@\n+/* Solaris support needed only by D front-end.\n+   Copyright (C) 2018 Free Software Foundation, Inc.\n+\n+GCC is free software; you can redistribute it and/or modify it under\n+the terms of the GNU General Public License as published by the Free\n+Software Foundation; either version 3, or (at your option) any later\n+version.\n+\n+GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+for more details.\n+\n+You should have received a copy of the GNU General Public License\n+along with GCC; see the file COPYING3.  If not see\n+<http://www.gnu.org/licenses/>.  */\n+\n+#include \"config.h\"\n+#include \"system.h\"\n+#include \"coretypes.h\"\n+#include \"tm.h\"\n+#include \"memmodel.h\"\n+#include \"tm_p.h\"\n+#include \"d/d-target.h\"\n+#include \"d/d-target-def.h\"\n+\n+/* Implement TARGET_D_OS_VERSIONS for Solaris targets.  */\n+\n+static void\n+solaris_d_os_builtins (void)\n+{\n+  d_add_builtin_version (\"Posix\");\n+  d_add_builtin_version (\"Solaris\");\t\t\t\\\n+}\n+\n+/* Implement TARGET_D_CRITSEC_SIZE for Solaris targets.  */\n+\n+static unsigned\n+solaris_d_critsec_size (void)\n+{\n+  /* This is the sizeof pthread_mutex_t.  */\n+  return 24;\n+}\n+\n+#undef TARGET_D_OS_VERSIONS\n+#define TARGET_D_OS_VERSIONS solaris_d_os_builtins\n+\n+#undef TARGET_D_CRITSEC_SIZE\n+#define TARGET_D_CRITSEC_SIZE solaris_d_critsec_size\n+\n+struct gcc_targetdm targetdm = TARGETDM_INITIALIZER;"}, {"sha": "f1983cfc7de05df76bafad93d91ac91b6061f20e", "filename": "gcc/config/t-sol2", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig%2Ft-sol2", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdb3f2f4314f5cd72927eb7f620e1df14e1da574/gcc%2Fconfig%2Ft-sol2", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ft-sol2?ref=cdb3f2f4314f5cd72927eb7f620e1df14e1da574", "patch": "@@ -16,7 +16,7 @@\n # along with GCC; see the file COPYING3.  If not see\n # <http://www.gnu.org/licenses/>.\n \n-# Solaris-specific format checking and pragmas\n+# Solaris-specific format checking and pragmas.\n sol2-c.o: $(srcdir)/config/sol2-c.c\n \t$(COMPILE) $<\n \t$(POSTCOMPILE)\n@@ -26,6 +26,11 @@ sol2-cxx.o: $(srcdir)/config/sol2-cxx.c\n \t$(COMPILE) $<\n \t$(POSTCOMPILE)\n \n+# Solaris-specific D support.\n+sol2-d.o: $(srcdir)/config/sol2-d.c\n+\t$(COMPILE) $<\n+\t$(POSTCOMPILE)\n+\n # Corresponding stub routines.\n sol2-stubs.o: $(srcdir)/config/sol2-stubs.c\n \t$(COMPILE) $<"}]}