{"sha": "2d65b828b292adf5e39bb71addbd671217211cd5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmQ2NWI4MjhiMjkyYWRmNWUzOWJiNzFhZGRiZDY3MTIxNzIxMWNkNQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2007-09-18T15:38:02Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2007-09-18T15:38:02Z"}, "message": "re PR c++/33463 (Broken diagnostic: 'typeid_expr' not supported by dump_expr)\n\n/cp\n2007-09-18  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR c++/33463\n\t* cxx-pretty-print.c (pp_cxx_postfix_expression): Split\n\tout case TYPEID_EXPR to...\n\t(pp_cxx_typeid_expression): ... here; use pp_cxx_left_paren\n\tand pp_cxx_right_paren.\n\t* cxx-pretty-print.h (pp_cxx_typeid_expression): Declare.\n\t* error.c (dump_expr): Use it.\n\n/testsuite\n2007-09-18  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR c++/33463\n\t* g++.dg/rtti/typeid6.C: New.\n\nFrom-SVN: r128582", "tree": {"sha": "0112eedeafb6663855a7150d4e7ef0f39d72379e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0112eedeafb6663855a7150d4e7ef0f39d72379e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2d65b828b292adf5e39bb71addbd671217211cd5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d65b828b292adf5e39bb71addbd671217211cd5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d65b828b292adf5e39bb71addbd671217211cd5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d65b828b292adf5e39bb71addbd671217211cd5/comments", "author": null, "committer": null, "parents": [{"sha": "bdfb7c6d56a79c4bb0c937ee1d4a7186a6aa3438", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdfb7c6d56a79c4bb0c937ee1d4a7186a6aa3438", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdfb7c6d56a79c4bb0c937ee1d4a7186a6aa3438"}], "stats": {"total": 53, "additions": 45, "deletions": 8}, "files": [{"sha": "504a0c36d285f0f28cd00ad9419b7c630d629da1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2d65b828b292adf5e39bb71addbd671217211cd5", "patch": "@@ -1,3 +1,13 @@\n+2007-09-18  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR c++/33463\n+\t* cxx-pretty-print.c (pp_cxx_postfix_expression): Split\n+\tout case TYPEID_EXPR to...\n+\t(pp_cxx_typeid_expression): ... here; use pp_cxx_left_paren\n+\tand pp_cxx_right_paren.\n+\t* cxx-pretty-print.h (pp_cxx_typeid_expression): Declare.\n+\t* error.c (dump_expr): Use it.\n+\n 2007-09-18  Paolo Carlini  <pcarlini@suse.de>\n \n \tPR c++/33464"}, {"sha": "a73a052572b979b509c4760c0bf9490f0ae4a30e", "filename": "gcc/cp/cxx-pretty-print.c", "status": "modified", "additions": 14, "deletions": 8, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2Fcxx-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2Fcxx-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcxx-pretty-print.c?ref=2d65b828b292adf5e39bb71addbd671217211cd5", "patch": "@@ -571,14 +571,7 @@ pp_cxx_postfix_expression (cxx_pretty_printer *pp, tree t)\n       break;\n \n     case TYPEID_EXPR:\n-      t = TREE_OPERAND (t, 0);\n-      pp_cxx_identifier (pp, \"typeid\");\n-      pp_left_paren (pp);\n-      if (TYPE_P (t))\n-\tpp_cxx_type_id (pp, t);\n-      else\n-\tpp_cxx_expression (pp, t);\n-      pp_right_paren (pp);\n+      pp_cxx_typeid_expression (pp, t);\n       break;\n \n     case PSEUDO_DTOR_EXPR:\n@@ -2146,6 +2139,19 @@ pp_cxx_declaration (cxx_pretty_printer *pp, tree t)\n     }\n }\n \n+void\n+pp_cxx_typeid_expression (cxx_pretty_printer *pp, tree t)\n+{\n+  t = TREE_OPERAND (t, 0);\n+  pp_cxx_identifier (pp, \"typeid\");\n+  pp_cxx_left_paren (pp);\n+  if (TYPE_P (t))\n+    pp_cxx_type_id (pp, t);\n+  else\n+    pp_cxx_expression (pp, t);\n+  pp_cxx_right_paren (pp);\n+}\n+\n void\n pp_cxx_trait_expression (cxx_pretty_printer *pp, tree t)\n {"}, {"sha": "f399feafaa4d4307eec56285438592df87aef8eb", "filename": "gcc/cp/cxx-pretty-print.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2Fcxx-pretty-print.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2Fcxx-pretty-print.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcxx-pretty-print.h?ref=2d65b828b292adf5e39bb71addbd671217211cd5", "patch": "@@ -70,5 +70,6 @@ void pp_cxx_separate_with (cxx_pretty_printer *, int);\n void pp_cxx_declaration (cxx_pretty_printer *, tree);\n void pp_cxx_canonical_template_parameter (cxx_pretty_printer *, tree);\n void pp_cxx_trait_expression (cxx_pretty_printer *, tree);\n+void pp_cxx_typeid_expression (cxx_pretty_printer *, tree);\n \n #endif /* GCC_CXX_PRETTY_PRINT_H */"}, {"sha": "1854fd6888cf7536ee3580c8554daacf75c3737d", "filename": "gcc/cp/error.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=2d65b828b292adf5e39bb71addbd671217211cd5", "patch": "@@ -2058,6 +2058,10 @@ dump_expr (tree t, int flags)\n       pp_cxx_trait_expression (cxx_pp, t);\n       break;\n \n+    case TYPEID_EXPR:\n+      pp_cxx_typeid_expression (cxx_pp, t);\n+      break;\n+\n       /*  This list is incomplete, but should suffice for now.\n \t  It is very important that `sorry' does not call\n \t  `report_error_function'.  That could cause an infinite loop.  */"}, {"sha": "fe8802588e810c7e02f1104e1199dcce8987b5b5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2d65b828b292adf5e39bb71addbd671217211cd5", "patch": "@@ -1,3 +1,8 @@\n+2007-09-18  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR c++/33463\n+\t* g++.dg/rtti/typeid6.C: New.\n+\n 2007-09-18  Paolo Carlini  <pcarlini@suse.de>\n \n \tPR c++/33464"}, {"sha": "18709b4976d35a622457992d338a32ae43b1233b", "filename": "gcc/testsuite/g++.dg/rtti/typeid6.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Ftypeid6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d65b828b292adf5e39bb71addbd671217211cd5/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Ftypeid6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Ftypeid6.C?ref=2d65b828b292adf5e39bb71addbd671217211cd5", "patch": "@@ -0,0 +1,11 @@\n+// PR c++/33463\n+\n+namespace std\n+{\n+  class type_info {};\n+}\n+\n+template<int> void foo()\n+{\n+  !typeid(void); // { dg-error \"!typeid\\\\(void\\\\)|candidates\" }\n+}"}]}