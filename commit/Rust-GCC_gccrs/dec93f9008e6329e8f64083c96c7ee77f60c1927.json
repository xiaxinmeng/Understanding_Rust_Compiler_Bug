{"sha": "dec93f9008e6329e8f64083c96c7ee77f60c1927", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGVjOTNmOTAwOGU2MzI5ZThmNjQwODNjOTZjN2VlNzdmNjBjMTkyNw==", "commit": {"author": {"name": "Gary Benson", "email": "gbenson@redhat.com", "date": "2007-03-23T11:25:46Z"}, "committer": {"name": "Gary Benson", "email": "gary@gcc.gnu.org", "date": "2007-03-23T11:25:46Z"}, "message": "link.cc (_Jv_Linker::resolve_method_entry): Ensure that the argument types and the return type of the found method match...\n\n2007-03-23  Gary Benson  <gbenson@redhat.com>\n\n\t* link.cc (_Jv_Linker::resolve_method_entry):\n\tEnsure that the argument types and the return type of the\n\tfound method match those expected by the calling method.\n\nFrom-SVN: r123156", "tree": {"sha": "de7a7aaa1f0a42b41571e5a82154605527a268e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/de7a7aaa1f0a42b41571e5a82154605527a268e0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dec93f9008e6329e8f64083c96c7ee77f60c1927", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dec93f9008e6329e8f64083c96c7ee77f60c1927", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dec93f9008e6329e8f64083c96c7ee77f60c1927", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dec93f9008e6329e8f64083c96c7ee77f60c1927/comments", "author": null, "committer": null, "parents": [{"sha": "3c2e80433d69dc6df77a1e916fe35d75a470528f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3c2e80433d69dc6df77a1e916fe35d75a470528f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3c2e80433d69dc6df77a1e916fe35d75a470528f"}], "stats": {"total": 48, "additions": 40, "deletions": 8}, "files": [{"sha": "8e4f518f3e00ee11a5a91354aba455655dbc71c8", "filename": "libjava/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dec93f9008e6329e8f64083c96c7ee77f60c1927/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dec93f9008e6329e8f64083c96c7ee77f60c1927/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=dec93f9008e6329e8f64083c96c7ee77f60c1927", "patch": "@@ -1,3 +1,9 @@\n+2007-03-23  Gary Benson  <gbenson@redhat.com>\n+\n+\t* link.cc (_Jv_Linker::resolve_method_entry):\n+\tEnsure that the argument types and the return type of the\n+\tfound method match those expected by the calling method.\n+\n 2007-03-22  David Daney  <ddaney@avtrex.com>\n \n \tPR libgcj/31228"}, {"sha": "1d873acf288cdcecdb88fe647e311b5627b9b415", "filename": "libjava/link.cc", "status": "modified", "additions": 34, "deletions": 8, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dec93f9008e6329e8f64083c96c7ee77f60c1927/libjava%2Flink.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dec93f9008e6329e8f64083c96c7ee77f60c1927/libjava%2Flink.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flink.cc?ref=dec93f9008e6329e8f64083c96c7ee77f60c1927", "patch": "@@ -343,14 +343,6 @@ _Jv_Linker::resolve_method_entry (jclass klass, jclass &found_class,\n   \n \n  end_of_method_search:\n-\n-  // FIXME: if (cls->loader != klass->loader), then we\n-  // must actually check that the types of arguments\n-  // correspond.  That is, for each argument type, and\n-  // the return type, doing _Jv_FindClassFromSignature\n-  // with either loader should produce the same result,\n-  // i.e., exactly the same jclass object. JVMS 5.4.3.3    \n-    \n   if (the_method == 0)\n     {\n       java::lang::StringBuffer *sb = new java::lang::StringBuffer();\n@@ -364,6 +356,40 @@ _Jv_Linker::resolve_method_entry (jclass klass, jclass &found_class,\n       throw new java::lang::NoSuchMethodError (sb->toString());\n     }\n \n+  // if (found_class->loader != klass->loader), then we\n+  // must actually check that the types of arguments\n+  // correspond.  That is, for each argument type, and\n+  // the return type, doing _Jv_FindClassFromSignature\n+  // with either loader should produce the same result,\n+  // i.e., exactly the same jclass object. JVMS 5.4.3.3\n+  if (found_class->loader != klass->loader)\n+    {\n+      JArray<jclass> *found_args, *klass_args;\n+      jclass found_return, klass_return;\n+\n+      _Jv_GetTypesFromSignature (the_method,\n+\t\t\t\t found_class,\n+\t\t\t\t &found_args,\n+\t\t\t\t &found_return);\n+      _Jv_GetTypesFromSignature (the_method,\n+\t\t\t\t klass,\n+\t\t\t\t &klass_args,\n+\t\t\t\t &klass_return);\n+\n+      jclass *found_arg = elements (found_args);\n+      jclass *klass_arg = elements (klass_args);\n+\n+      for (int i = 0; i < found_args->length; i++)\n+\t{\n+\t  if (*(found_arg++) != *(klass_arg++))\n+\t    throw new java::lang::LinkageError (JvNewStringLatin1 \n+\t      (\"argument type mismatch with different loaders\"));\n+\t}\n+      if (found_return != klass_return)\n+\tthrow new java::lang::LinkageError (JvNewStringLatin1\n+\t  (\"return type mismatch with different loaders\"));\n+    }\n+  \n   return the_method;\n }\n "}]}