{"sha": "7461b5813126c6dbe11f0f9d06c1bd83b082111e", "node_id": "C_kwDOANBUbNoAKDc0NjFiNTgxMzEyNmM2ZGJlMTFmMGY5ZDA2YzFiZDgzYjA4MjExMWU", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2021-11-16T17:23:27Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2021-11-16T17:23:27Z"}, "message": "libstdc++: Merge latest Ryu sources\n\nlibstdc++-v3/ChangeLog:\n\n\t* src/c++17/ryu/MERGE: Update the commit hash.\n\t* src/c++17/ryu/d2s_intrinsics.h: Merge from Ryu's master\n\tbranch.\n\nSigned-off-by: Patrick Palka <ppalka@redhat.com>", "tree": {"sha": "1a6c732c6738ca146fdd3f16ab72df54f31e6f4f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1a6c732c6738ca146fdd3f16ab72df54f31e6f4f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7461b5813126c6dbe11f0f9d06c1bd83b082111e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7461b5813126c6dbe11f0f9d06c1bd83b082111e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7461b5813126c6dbe11f0f9d06c1bd83b082111e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7461b5813126c6dbe11f0f9d06c1bd83b082111e/comments", "author": null, "committer": null, "parents": [{"sha": "b96e2ff9d8c56bad68b5dd10e3a601f12496ae36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b96e2ff9d8c56bad68b5dd10e3a601f12496ae36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b96e2ff9d8c56bad68b5dd10e3a601f12496ae36"}], "stats": {"total": 11, "additions": 5, "deletions": 6}, "files": [{"sha": "9035502846eee90660f21a62e0e8e541afb8cbbc", "filename": "libstdc++-v3/src/c++17/ryu/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7461b5813126c6dbe11f0f9d06c1bd83b082111e/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B17%2Fryu%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7461b5813126c6dbe11f0f9d06c1bd83b082111e/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B17%2Fryu%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B17%2Fryu%2FMERGE?ref=7461b5813126c6dbe11f0f9d06c1bd83b082111e", "patch": "@@ -1,4 +1,4 @@\n-22c887c017a8512abcd4a8f6bfcdb2742829cd7d\n+150d0c87830756d34e76c42f7f33f811d89903a8\n \n The first line of this file holds the git revision number of the\n last merge done from the master library sources."}, {"sha": "e3206b5d7dd5a42f2f89a82f47df5036727524a5", "filename": "libstdc++-v3/src/c++17/ryu/d2s_intrinsics.h", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7461b5813126c6dbe11f0f9d06c1bd83b082111e/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B17%2Fryu%2Fd2s_intrinsics.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7461b5813126c6dbe11f0f9d06c1bd83b082111e/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B17%2Fryu%2Fd2s_intrinsics.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B17%2Fryu%2Fd2s_intrinsics.h?ref=7461b5813126c6dbe11f0f9d06c1bd83b082111e", "patch": "@@ -181,15 +181,14 @@ static inline uint32_t mod1e9(const uint64_t x) {\n #endif // defined(RYU_32_BIT_PLATFORM)\n \n static inline uint32_t pow5Factor(uint64_t value) {\n+  const uint64_t m_inv_5 = 14757395258967641293u; // 5 * m_inv_5 = 1 (mod 2^64)\n+  const uint64_t n_div_5 = 3689348814741910323u;  // #{ n | n = 0 (mod 2^64) } = 2^64 / 5\n   uint32_t count = 0;\n   for (;;) {\n     assert(value != 0);\n-    const uint64_t q = div5(value);\n-    const uint32_t r = ((uint32_t) value) - 5 * ((uint32_t) q);\n-    if (r != 0) {\n+    value *= m_inv_5;\n+    if (value > n_div_5)\n       break;\n-    }\n-    value = q;\n     ++count;\n   }\n   return count;"}]}