{"sha": "82d6f5327943f851a1c2973055f3e7ed09071dbb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODJkNmY1MzI3OTQzZjg1MWExYzI5NzMwNTVmM2U3ZWQwOTA3MWRiYg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2010-04-25T09:22:35Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2010-04-25T09:22:35Z"}, "message": "trans.c (gnat_to_gnu): Do not use memmove if the array type is bit-packed.\n\n\t* gcc-interface/trans.c (gnat_to_gnu) <N_Assignment_Statement>: Do not\n\tuse memmove if the array type is bit-packed.\n\nFrom-SVN: r158701", "tree": {"sha": "34d9cfc1911359c24046c9c69c0604dc047d3083", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/34d9cfc1911359c24046c9c69c0604dc047d3083"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82d6f5327943f851a1c2973055f3e7ed09071dbb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82d6f5327943f851a1c2973055f3e7ed09071dbb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82d6f5327943f851a1c2973055f3e7ed09071dbb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82d6f5327943f851a1c2973055f3e7ed09071dbb/comments", "author": null, "committer": null, "parents": [{"sha": "3d416346cfca32e50fc17feea9ba012b3a2730f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d416346cfca32e50fc17feea9ba012b3a2730f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d416346cfca32e50fc17feea9ba012b3a2730f5"}], "stats": {"total": 47, "additions": 45, "deletions": 2}, "files": [{"sha": "51f769cbd8db4a6b2a2d65fcfafe271167f2b081", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=82d6f5327943f851a1c2973055f3e7ed09071dbb", "patch": "@@ -1,3 +1,8 @@\n+2010-04-25  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/trans.c (gnat_to_gnu) <N_Assignment_Statement>: Do not\n+\tuse memmove if the array type is bit-packed.\n+\n 2010-04-18  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/misc.c (gnat_init): Remove second argument in call to"}, {"sha": "84fa13878707a480b923672c336c2aec44053e3b", "filename": "gcc/ada/gcc-interface/trans.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Ftrans.c?ref=82d6f5327943f851a1c2973055f3e7ed09071dbb", "patch": "@@ -4797,10 +4797,12 @@ gnat_to_gnu (Node_Id gnat_node)\n \t  gnu_result\n \t    = build_binary_op (MODIFY_EXPR, NULL_TREE, gnu_lhs, gnu_rhs);\n \n-\t  /* If the type being assigned is an array type and the two sides\n-\t     are not completely disjoint, play safe and use memmove.  */\n+\t  /* If the type being assigned is an array type and the two sides are\n+\t     not completely disjoint, play safe and use memmove.  But don't do\n+\t     it for a bit-packed array as it might not be byte-aligned.  */\n \t  if (TREE_CODE (gnu_result) == MODIFY_EXPR\n \t      && Is_Array_Type (Etype (Name (gnat_node)))\n+\t      && !Is_Bit_Packed_Array (Etype (Name (gnat_node)))\n \t      && !(Forwards_OK (gnat_node) && Backwards_OK (gnat_node)))\n \t    {\n \t      tree to, from, size, to_ptr, from_ptr, t;"}, {"sha": "6afd75b1c433c4ca13bb11af75218c07e3dd32ca", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=82d6f5327943f851a1c2973055f3e7ed09071dbb", "patch": "@@ -1,3 +1,7 @@\n+2010-04-25  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/pack15.ad[sb]: New test.\n+\n 2010-04-25  Paolo Bonzini  <bonzini@gnu.org>\n \n \t* gcc.target/arm/mla-1.c: New test."}, {"sha": "019b2da0f7873f1c4e0d00d2d2badde3cc0f7b4b", "filename": "gcc/testsuite/gnat.dg/pack15.adb", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Ftestsuite%2Fgnat.dg%2Fpack15.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Ftestsuite%2Fgnat.dg%2Fpack15.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fpack15.adb?ref=82d6f5327943f851a1c2973055f3e7ed09071dbb", "patch": "@@ -0,0 +1,10 @@\n+-- { dg-do compile }\n+\n+package body Pack15 is\n+\n+  procedure Transfer is\n+  begin\n+    O.Status_Flags := Status_Flags;\n+  end;\n+\n+end Pack15;"}, {"sha": "94be462c084da0784aa3abb03c2729733625abff", "filename": "gcc/testsuite/gnat.dg/pack15.ads", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Ftestsuite%2Fgnat.dg%2Fpack15.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82d6f5327943f851a1c2973055f3e7ed09071dbb/gcc%2Ftestsuite%2Fgnat.dg%2Fpack15.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fpack15.ads?ref=82d6f5327943f851a1c2973055f3e7ed09071dbb", "patch": "@@ -0,0 +1,22 @@\n+package Pack15 is\n+\n+  type Flags is array (1..2) of Boolean;\n+  for Flags'Component_Size use 1;\n+\n+  type Messages is record\n+    Status_Flags : Flags;\n+  end record;\n+\n+  for Messages use record\n+    Status_Flags at 0 range 1 .. 2;\n+  end record;\n+\n+  O : Messages;\n+\n+  Buffer : Integer;\n+  Status_Flags : Flags;\n+  for Status_Flags'Address use Buffer'Address;\n+\n+  procedure Transfer;\n+\n+end Pack15;"}]}