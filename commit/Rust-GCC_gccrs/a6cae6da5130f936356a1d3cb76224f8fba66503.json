{"sha": "a6cae6da5130f936356a1d3cb76224f8fba66503", "node_id": "C_kwDOANBUbNoAKGE2Y2FlNmRhNTEzMGY5MzYzNTZhMWQzY2I3NjIyNGY4ZmJhNjY1MDM", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-11-22T17:05:18Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2021-11-22T17:31:19Z"}, "message": "Fix toplevel crate ribs id's\n\nToplevel ribs should be the same id of the Crate this allows is to scan\nall toplevel ribs simply by knowing the crate number.", "tree": {"sha": "60ff8fe756224171f5104a65b664ac16f0790e39", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/60ff8fe756224171f5104a65b664ac16f0790e39"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a6cae6da5130f936356a1d3cb76224f8fba66503", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6cae6da5130f936356a1d3cb76224f8fba66503", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a6cae6da5130f936356a1d3cb76224f8fba66503", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a6cae6da5130f936356a1d3cb76224f8fba66503/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "87da9922e66d64e2ef307d33076da86b8486bea0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87da9922e66d64e2ef307d33076da86b8486bea0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87da9922e66d64e2ef307d33076da86b8486bea0"}], "stats": {"total": 10, "additions": 4, "deletions": 6}, "files": [{"sha": "66553a6e40944300b101ef4492562916bae4e2ca", "filename": "gcc/rust/resolve/rust-ast-resolve.cc", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a6cae6da5130f936356a1d3cb76224f8fba66503/gcc%2Frust%2Fresolve%2Frust-ast-resolve.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a6cae6da5130f936356a1d3cb76224f8fba66503/gcc%2Frust%2Fresolve%2Frust-ast-resolve.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fresolve%2Frust-ast-resolve.cc?ref=a6cae6da5130f936356a1d3cb76224f8fba66503", "patch": "@@ -313,14 +313,12 @@ NameResolution::Resolve (AST::Crate &crate)\n void\n NameResolution::go (AST::Crate &crate)\n {\n-  // setup parent scoping for names\n-  resolver->get_name_scope ().push (crate.get_node_id ());\n+  NodeId scope_node_id = crate.get_node_id ();\n+  resolver->get_name_scope ().push (scope_node_id);\n+  resolver->get_type_scope ().push (scope_node_id);\n+  resolver->get_label_scope ().push (scope_node_id);\n   resolver->push_new_name_rib (resolver->get_name_scope ().peek ());\n-  // setup parent scoping for new types\n-  resolver->get_type_scope ().push (mappings->get_next_node_id ());\n   resolver->push_new_type_rib (resolver->get_type_scope ().peek ());\n-  // setup label scope\n-  resolver->get_label_scope ().push (mappings->get_next_node_id ());\n   resolver->push_new_label_rib (resolver->get_type_scope ().peek ());\n \n   // first gather the top-level namespace names then we drill down"}]}