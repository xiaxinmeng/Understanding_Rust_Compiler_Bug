{"sha": "b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjIyNDRlMjJhMGNlZTViNjE3YmMwNjE5ZTVmOGMyYjExZTE0YjJlMQ==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1999-08-27T02:37:40Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1999-08-27T02:37:40Z"}, "message": "Add support for defering line number table construction to assembler.\n\n\t* dwarf2out.c (DWARF2_ASM_LINE_DEBUG_INFO): Add default definition.\n\t(debug_dwarf): Add DWARF2_ASM_LINE_DEBUG_INFO support.\n\t(dwarf2out_line, dwarf2out_finish): Likewise.\n\t* tm.texi (DWARF2_ASM_LINE_DEBUG_INFO): Add documetation.\n\nFrom-SVN: r28910", "tree": {"sha": "848c61a91662d479d931045e6aee44b755d53d5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/848c61a91662d479d931045e6aee44b755d53d5a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1/comments", "author": null, "committer": null, "parents": [{"sha": "26612c795a5a069188b4a3019a0a92b7a442f141", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26612c795a5a069188b4a3019a0a92b7a442f141", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26612c795a5a069188b4a3019a0a92b7a442f141"}], "stats": {"total": 52, "additions": 47, "deletions": 5}, "files": [{"sha": "85b24a5f07a27e225c9e190b0a61de963d1c6527", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1", "patch": "@@ -1,3 +1,10 @@\n+Thu Aug 26 19:33:23 1999  Jim Wilson  <wilson@cygnus.com>\n+\n+\t* dwarf2out.c (DWARF2_ASM_LINE_DEBUG_INFO): Add default definition.\n+\t(debug_dwarf): Add DWARF2_ASM_LINE_DEBUG_INFO support.\n+\t(dwarf2out_line, dwarf2out_finish): Likewise.\n+\t* tm.texi (DWARF2_ASM_LINE_DEBUG_INFO): Add documetation.\n+\n Thu Aug 26 16:10:56 1999  Gavin Romig-Koch  <gavin@cygnus.com>\n \n \t* tree.c (lang_unsave_expr_now) : Correct return type."}, {"sha": "81792b56490ae6abefc59b63b2fc4c202530fe8f", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 34, "deletions": 5, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1", "patch": "@@ -2237,6 +2237,11 @@ extern char *language_string;\n #define DWARF_ARANGES_HEADER_SIZE \\\n   (DWARF_ROUND (2 * DWARF_OFFSET_SIZE + 4, PTR_SIZE * 2) - DWARF_OFFSET_SIZE)\n \n+/* The default is to have gcc emit the line number tables.  */\n+#ifndef DWARF2_ASM_LINE_DEBUG_INFO\n+#define DWARF2_ASM_LINE_DEBUG_INFO 0\n+#endif\n+\n /* Define the architecture-dependent minimum instruction length (in bytes).\n    In this implementation of DWARF, this field is used for information\n    purposes only.  Since GCC generates assembly language, we have\n@@ -4446,7 +4451,8 @@ debug_dwarf ()\n {\n   print_indent = 0;\n   print_die (comp_unit_die, stderr);\n-  print_dwarf_line_table (stderr);\n+  if (! DWARF2_ASM_LINE_DEBUG_INFO)\n+    print_dwarf_line_table (stderr);\n }\n \f\n /* Traverse the DIE, and add a sibling attribute if it may have the\n@@ -9850,7 +9856,27 @@ dwarf2out_line (filename, line)\n     {\n       function_section (current_function_decl);\n \n-      if (DECL_SECTION_NAME (current_function_decl))\n+      if (DWARF2_ASM_LINE_DEBUG_INFO)\n+\t{\n+\t  static char *lastfile;\n+\n+\t  /* Emit the .file and .loc directives understood by GNU as.  */\n+\t  if (lastfile == 0 || strcmp (filename, lastfile))\n+\t    {\n+\t      fprintf (asm_out_file, \"\\t.file 0 \\\"%s\\\"\\n\", filename);\n+\t      lastfile = filename;\n+\t    }\n+\n+\t  fprintf (asm_out_file, \"\\t.loc 0 %d 0\\n\", line);\n+\n+\t  /* Indicate that line number info exists.  */\n+\t  ++line_info_table_in_use;\n+\n+\t  /* Indicate that multiple line number tables exist.  */\n+\t  if (DECL_SECTION_NAME (current_function_decl))\n+\t    ++separate_line_info_table_in_use;\n+\t}\n+      else if (DECL_SECTION_NAME (current_function_decl))\n \t{\n \t  register dw_separate_line_info_ref line_info;\n \t  ASM_OUTPUT_INTERNAL_LABEL (asm_out_file, SEPARATE_LINE_CODE_LABEL,\n@@ -10097,9 +10123,12 @@ dwarf2out_finish ()\n   /* Output the source line correspondence table.  */\n   if (line_info_table_in_use > 1 || separate_line_info_table_in_use)\n     {\n-      fputc ('\\n', asm_out_file);\n-      ASM_OUTPUT_SECTION (asm_out_file, DEBUG_LINE_SECTION);\n-      output_line_info ();\n+      if (! DWARF2_ASM_LINE_DEBUG_INFO)\n+\t{\n+\t  fputc ('\\n', asm_out_file);\n+\t  ASM_OUTPUT_SECTION (asm_out_file, DEBUG_LINE_SECTION);\n+\t  output_line_info ();\n+\t}\n \n       /* We can only use the low/high_pc attributes if all of the code\n \t was in .text.  */"}, {"sha": "c3e3c271f6851edd48c944146300d7e7b772549d", "filename": "gcc/tm.texi", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1/gcc%2Ftm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1/gcc%2Ftm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftm.texi?ref=b2244e22a0cee5b617bc0619e5f8c2b11e14b2e1", "patch": "@@ -6943,6 +6943,12 @@ label to mark the beginning of the text section.  If it is better simply\n to use the name of the text section itself, rather than an explicit label,\n to indicate the beginning of the text section, define this macro to zero.\n \n+@findex DWARF2_ASM_LINE_DEBUG_INFO\n+@item DWARF2_ASM_LINE_DEBUG_INFO\n+Define this macro to be a nonzero value if the assembler can generate Dwarf 2\n+line debug info sections.  This will result in much more compact line number\n+tables, and hence is desirable if it works.\n+\n @findex PUT_SDB_@dots{}\n @item PUT_SDB_@dots{}\n Define these macros to override the assembler syntax for the special"}]}