{"sha": "76e716d76171e50353e7eb80632ea75165eabdc0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzZlNzE2ZDc2MTcxZTUwMzUzZTdlYjgwNjMyZWE3NTE2NWVhYmRjMA==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2019-07-05T07:03:54Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-05T07:03:54Z"}, "message": "[Ada] Compiler loop on illegal nested accept statement\n\nThis patch fixes a \"Compilation abandoned\" message in a compiler built\nwith assertions, or a compiler loop otherwise, when an accept statement\ncontains an illegal accept statement for the same entry.\n\nCompiling accept_in_accept.adb must yield:\n\naccept_in_accept.adb:12:13:\n          duplicate accept statement for same entry (RM 9.5.2 (15))\n\n----\nprocedure accept_in_accept is\n\n   task a_in_a is\n      entry a (i : Integer);\n   end a_in_a;\n\n   task body a_in_a is\n   begin\n      select\n         accept a (i : Integer) do\n            null;\n            accept a (i : integer) do\n              null;\n            end a;\n         end a;\n      or\n         terminate;\n      end select;\n   end a_in_a;\n\nbegin\n   a_in_a.a (1);\nend accept_in_accept;\n\n2019-07-05  Ed Schonberg  <schonberg@adacore.com>\n\ngcc/ada/\n\n\t* sem_ch9.adb (Analyze_Accept_Statement): If this is an illegal\n\taccept statement for an enclosing entry abandon analysis to\n\tprevent scope mismatches and potential infinite loops in\n\tcompiler.\n\nFrom-SVN: r273129", "tree": {"sha": "251a07dbc848e282ba8c7305e01dde1da72033a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/251a07dbc848e282ba8c7305e01dde1da72033a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/76e716d76171e50353e7eb80632ea75165eabdc0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76e716d76171e50353e7eb80632ea75165eabdc0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76e716d76171e50353e7eb80632ea75165eabdc0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76e716d76171e50353e7eb80632ea75165eabdc0/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3eb5e54a4a50f3e7c39a1f5435f9d4eedb26bb37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3eb5e54a4a50f3e7c39a1f5435f9d4eedb26bb37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3eb5e54a4a50f3e7c39a1f5435f9d4eedb26bb37"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "c875ac3b2c108bc4c2edf63faa3ff2e42ac1f531", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76e716d76171e50353e7eb80632ea75165eabdc0/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76e716d76171e50353e7eb80632ea75165eabdc0/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=76e716d76171e50353e7eb80632ea75165eabdc0", "patch": "@@ -1,3 +1,10 @@\n+2019-07-05  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch9.adb (Analyze_Accept_Statement): If this is an illegal\n+\taccept statement for an enclosing entry abandon analysis to\n+\tprevent scope mismatches and potential infinite loops in\n+\tcompiler.\n+\n 2019-07-05  Hristian Kirtchev  <kirtchev@adacore.com>\n \n \t* ali.adb (For_Each_Invocation_Construct,"}, {"sha": "19fff57799421052e1f6201a54cfcd56a9451eb0", "filename": "gcc/ada/sem_ch9.adb", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76e716d76171e50353e7eb80632ea75165eabdc0/gcc%2Fada%2Fsem_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76e716d76171e50353e7eb80632ea75165eabdc0/gcc%2Fada%2Fsem_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch9.adb?ref=76e716d76171e50353e7eb80632ea75165eabdc0", "patch": "@@ -883,7 +883,13 @@ package body Sem_Ch9 is\n          exit when Task_Nam = Scope_Stack.Table (J).Entity;\n \n          if Entry_Nam = Scope_Stack.Table (J).Entity then\n-            Error_Msg_N (\"duplicate accept statement for same entry\", N);\n+            Error_Msg_N\n+              (\"duplicate accept statement for same entry (RM 9.5.2 (15))\", N);\n+\n+            --  Do not continue analysis of accept statement, to prevent\n+            --  cascaded errors.\n+\n+            return;\n          end if;\n       end loop;\n "}]}