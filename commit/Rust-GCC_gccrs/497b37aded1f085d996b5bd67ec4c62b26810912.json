{"sha": "497b37aded1f085d996b5bd67ec4c62b26810912", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDk3YjM3YWRlZDFmMDg1ZDk5NmI1YmQ2N2VjNGM2MmIyNjgxMDkxMg==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-22T13:51:35Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-22T13:51:35Z"}, "message": "[multiple changes]\n\n2010-10-22  Jerome Lambourg  <lambourg@adacore.com>\n\n\t* gnatlink.adb (Process_Binder_File): Remove CLI-specific code, now\n\tmoved to dotnet-ld.\n\t(Gnatlink): Remove CLI-specific code, moved to dotnet-ld\n\t* bindgen.adb (Gen_Object_Files_Options): Do not issue -L switches with\n\tthe .NET compiler, useless and unsupported.\n\n2010-10-22  Robert Dewar  <dewar@adacore.com>\n\n\t* sem_util.ads (Get_Num_Lit_From_Pos): Fix errors in documentation,\n\tthis returns a Node_Id for a reference to the entity, not the entity\n\titself!\n\n2010-10-22  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch5.adb (Analyze_Iteration_Scheme): use Insert_Actions when\n\tbounds require a temporary.\n\nFrom-SVN: r165827", "tree": {"sha": "d3c6af85269ff86cfccfd1ce960ea98326ee49aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d3c6af85269ff86cfccfd1ce960ea98326ee49aa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/497b37aded1f085d996b5bd67ec4c62b26810912", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/497b37aded1f085d996b5bd67ec4c62b26810912", "html_url": "https://github.com/Rust-GCC/gccrs/commit/497b37aded1f085d996b5bd67ec4c62b26810912", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/497b37aded1f085d996b5bd67ec4c62b26810912/comments", "author": null, "committer": null, "parents": [{"sha": "45010db959f848053fc5e1e08f8e6237ce8beafb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45010db959f848053fc5e1e08f8e6237ce8beafb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/45010db959f848053fc5e1e08f8e6237ce8beafb"}], "stats": {"total": 143, "additions": 43, "deletions": 100}, "files": [{"sha": "8dbeb57c7f664ed3842405a1be8b7d8e79cd61ae", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=497b37aded1f085d996b5bd67ec4c62b26810912", "patch": "@@ -1,3 +1,22 @@\n+2010-10-22  Jerome Lambourg  <lambourg@adacore.com>\n+\n+\t* gnatlink.adb (Process_Binder_File): Remove CLI-specific code, now\n+\tmoved to dotnet-ld.\n+\t(Gnatlink): Remove CLI-specific code, moved to dotnet-ld\n+\t* bindgen.adb (Gen_Object_Files_Options): Do not issue -L switches with\n+\tthe .NET compiler, useless and unsupported.\n+\n+2010-10-22  Robert Dewar  <dewar@adacore.com>\n+\n+\t* sem_util.ads (Get_Num_Lit_From_Pos): Fix errors in documentation,\n+\tthis returns a Node_Id for a reference to the entity, not the entity\n+\titself!\n+\n+2010-10-22  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch5.adb (Analyze_Iteration_Scheme): use Insert_Actions when\n+\tbounds require a temporary.\n+\n 2010-10-22  Robert Dewar  <dewar@adacore.com>\n \n \t* sem_ch4.adb: Minor reformatting."}, {"sha": "499b61257d234e28394282afb700002aa5a0b46e", "filename": "gcc/ada/bindgen.adb", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fbindgen.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fbindgen.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindgen.adb?ref=497b37aded1f085d996b5bd67ec4c62b26810912", "patch": "@@ -2074,17 +2074,18 @@ package body Bindgen is\n       end if;\n \n       --  Add a \"-Ldir\" for each directory in the object path\n-\n-      for J in 1 .. Nb_Dir_In_Obj_Search_Path loop\n-         declare\n-            Dir : constant String_Ptr := Dir_In_Obj_Search_Path (J);\n-         begin\n-            Name_Len := 0;\n-            Add_Str_To_Name_Buffer (\"-L\");\n-            Add_Str_To_Name_Buffer (Dir.all);\n-            Write_Linker_Option;\n-         end;\n-      end loop;\n+      if VM_Target /= CLI_Target then\n+         for J in 1 .. Nb_Dir_In_Obj_Search_Path loop\n+            declare\n+               Dir : constant String_Ptr := Dir_In_Obj_Search_Path (J);\n+            begin\n+               Name_Len := 0;\n+               Add_Str_To_Name_Buffer (\"-L\");\n+               Add_Str_To_Name_Buffer (Dir.all);\n+               Write_Linker_Option;\n+            end;\n+         end loop;\n+      end if;\n \n       --  Sort linker options\n "}, {"sha": "0b5d681b376cdb8b9b80e00ed13d0376f9494256", "filename": "gcc/ada/gnatlink.adb", "status": "modified", "additions": 4, "deletions": 79, "changes": 83, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fgnatlink.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fgnatlink.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatlink.adb?ref=497b37aded1f085d996b5bd67ec4c62b26810912", "patch": "@@ -159,10 +159,6 @@ procedure Gnatlink is\n    --  Temporary file used by linker to pass list of object files on\n    --  certain systems with limitations on size of arguments.\n \n-   Lname : String_Access := null;\n-   --  File used by linker for CLI target, used to concatenate all .il files\n-   --  when the command line passed to ilasm is too long\n-\n    Debug_Flag_Present : Boolean := False;\n    Verbose_Mode       : Boolean := False;\n    Very_Verbose_Mode  : Boolean := False;\n@@ -990,42 +986,7 @@ procedure Gnatlink is\n       --  to read from a file instead of the command line is only triggered if\n       --  a conservative threshold is passed.\n \n-      if VM_Target = CLI_Target\n-        and then Link_Bytes > Link_Max\n-      then\n-         Lname := new String'(\"l~\" & Base_Name (Ali_File_Name.all) & \".il\");\n-\n-         for J in Objs_Begin .. Objs_End loop\n-            Copy_File (Linker_Objects.Table (J).all, Lname.all,\n-                       Success => Closing_Status,\n-                       Mode    => Append);\n-         end loop;\n-\n-         --  Add the special objects list file option together with the name\n-         --  of the temporary file to the objects file table.\n-\n-         Linker_Objects.Table (Objs_Begin) :=\n-           new String'(Value (Object_File_Option_Ptr) & Lname.all);\n-\n-         --  The slots containing these object file names are then removed\n-         --  from the objects table so they do not appear in the link. They\n-         --  are removed by moving up the linker options and non-Ada object\n-         --  files appearing after the Ada object list in the table.\n-\n-         declare\n-            N : Integer;\n-\n-         begin\n-            N := Objs_End - Objs_Begin + 1;\n-\n-            for J in Objs_End + 1 .. Linker_Objects.Last loop\n-               Linker_Objects.Table (J - N + 1) := Linker_Objects.Table (J);\n-            end loop;\n-\n-            Linker_Objects.Set_Last (Linker_Objects.Last - N + 1);\n-         end;\n-\n-      elsif Object_List_File_Required\n+      if Object_List_File_Required\n         or else (Object_List_File_Supported\n                    and then Link_Bytes > Link_Max)\n       then\n@@ -1736,7 +1697,7 @@ begin\n \n    if Linker_Path = null then\n       if VM_Target = CLI_Target then\n-         Linker_Path := System.OS_Lib.Locate_Exec_On_Path (\"ilasm\");\n+         Linker_Path := System.OS_Lib.Locate_Exec_On_Path (\"dotnet-ld\");\n \n          if Linker_Path = null then\n             Exit_With_Error (\"Couldn't locate ilasm\");\n@@ -1767,18 +1728,7 @@ begin\n                       & Get_Target_Debuggable_Suffix.all);\n    end if;\n \n-   if VM_Target = CLI_Target then\n-      Linker_Options.Increment_Last;\n-      Linker_Options.Table (Linker_Options.Last) := new String'(\"/QUIET\");\n-\n-      Linker_Options.Increment_Last;\n-      Linker_Options.Table (Linker_Options.Last) := new String'(\"/DEBUG\");\n-\n-      Linker_Options.Increment_Last;\n-      Linker_Options.Table (Linker_Options.Last) :=\n-        new String'(\"/OUTPUT=\" & Output_File_Name.all);\n-\n-   elsif RTX_RTSS_Kernel_Module_On_Target then\n+   if RTX_RTSS_Kernel_Module_On_Target then\n       Linker_Options.Increment_Last;\n       Linker_Options.Table (Linker_Options.Last) :=\n         new String'(\"/OUT:\" & Output_File_Name.all);\n@@ -1954,28 +1904,7 @@ begin\n          IDENT_Op : Boolean := False;\n \n       begin\n-         if VM_Target = CLI_Target then\n-\n-            --  Remove extraneous flags not relevant for CIL. Also remove empty\n-            --  arguments, since ilasm chokes on them.\n-\n-            for J in reverse Linker_Options.First .. Linker_Options.Last loop\n-               if Linker_Options.Table (J)'Length = 0\n-                 or else Linker_Options.Table (J) (1 .. 2) = \"-L\"\n-                 or else Linker_Options.Table (J) (1 .. 2) = \"-l\"\n-                 or else Linker_Options.Table (J) (1 .. 3) = \"-Wl\"\n-                 or else Linker_Options.Table (J) (1 .. 3) = \"-sh\"\n-                 or else Linker_Options.Table (J) (1 .. 2) = \"-O\"\n-                 or else Linker_Options.Table (J) (1 .. 2) = \"-g\"\n-               then\n-                  Linker_Options.Table (J .. Linker_Options.Last - 1) :=\n-                    Linker_Options.Table (J + 1 .. Linker_Options.Last);\n-                  Linker_Options.Decrement_Last;\n-                  Num_Args := Num_Args - 1;\n-               end if;\n-            end loop;\n-\n-         elsif AAMP_On_Target then\n+         if AAMP_On_Target then\n \n             --  Remove extraneous flags not relevant for AAMP\n \n@@ -2306,10 +2235,6 @@ begin\n                Delete (Tname);\n             end if;\n \n-            if Lname /= null then\n-               Delete (Lname.all & ASCII.NUL);\n-            end if;\n-\n             if not Success then\n                Error_Msg (\"error when calling \" & Linker_Path.all);\n                Exit_Program (E_Fatal);"}, {"sha": "692b1798edd944ee83388ad4fcf203620dd14593", "filename": "gcc/ada/sem_ch5.adb", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fsem_ch5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fsem_ch5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch5.adb?ref=497b37aded1f085d996b5bd67ec4c62b26810912", "patch": "@@ -1550,23 +1550,20 @@ package body Sem_Ch5 is\n                return Expression (Decl);\n             end if;\n \n-            --  Here we make a declaration with a separate assignment statement\n+            --  Here we make a declaration with a separate assignment\n+            --   statement, and insert before loop header.\n \n             Decl :=\n               Make_Object_Declaration (Loc,\n                 Defining_Identifier => Id,\n                 Object_Definition   => New_Occurrence_Of (Typ, Loc));\n \n-            Insert_Before (Parent (N), Decl);\n-            Analyze (Decl);\n-\n             Assign :=\n               Make_Assignment_Statement (Loc,\n                 Name        => New_Occurrence_Of (Id, Loc),\n                 Expression  => Relocate_Node (Original_Bound));\n \n-            Insert_Before (Parent (N), Assign);\n-            Analyze (Assign);\n+            Insert_Actions (Parent (N), New_List (Decl, Assign));\n \n             Rewrite (Original_Bound, New_Occurrence_Of (Id, Loc));\n "}, {"sha": "928d8bf958dff3783b15292e5c9a739d28db43cc", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/497b37aded1f085d996b5bd67ec4c62b26810912/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=497b37aded1f085d996b5bd67ec4c62b26810912", "patch": "@@ -465,11 +465,12 @@ package Sem_Util is\n    function Get_Enum_Lit_From_Pos\n      (T   : Entity_Id;\n       Pos : Uint;\n-      Loc : Source_Ptr) return Entity_Id;\n+      Loc : Source_Ptr) return Node_Id;\n    --  This function obtains the E_Enumeration_Literal entity for the specified\n-   --  value from the enumeration type or subtype T. The second argument is the\n-   --  Pos value, which is assumed to be in range. The third argument supplies\n-   --  a source location for constructed nodes returned by this function.\n+   --  value from the enumeration type or subtype T and returns an identifier\n+   --  node referencing this value. The second argument is the Pos value, which\n+   --  is assumed to be in range. The third argument supplies a source location\n+   --  for constructed nodes returned by this function.\n \n    procedure Get_Library_Unit_Name_String (Decl_Node : Node_Id);\n    --  Retrieve the fully expanded name of the library unit declared by"}]}