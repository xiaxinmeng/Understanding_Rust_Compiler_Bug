{"sha": "fc56f9d2843266a0d38f52b44ca5343604fccc2f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmM1NmY5ZDI4NDMyNjZhMGQzOGY1MmI0NGNhNTM0MzYwNGZjY2MyZg==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2014-06-30T20:14:42Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2014-06-30T20:14:42Z"}, "message": "re PR rtl-optimization/61608 (FAIL: gcc.target/arm/epilog-1.c scan-assembler tests)\n\nPR rtl-opt/61608\n\n        PR target/39284\n        * bb-reorder.c (pass_duplicate_computed_gotos::execute): Cleanup\n        the cfg if there were any changes.\n        * passes.def: Revert move of peephole2 after reorder_blocks;\n        move duplicate_computed_gotos before peephole2.\n\nFrom-SVN: r212172", "tree": {"sha": "175c0fc497121c92660a49b3a816d2a4d4d565f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/175c0fc497121c92660a49b3a816d2a4d4d565f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fc56f9d2843266a0d38f52b44ca5343604fccc2f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc56f9d2843266a0d38f52b44ca5343604fccc2f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fc56f9d2843266a0d38f52b44ca5343604fccc2f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc56f9d2843266a0d38f52b44ca5343604fccc2f/comments", "author": null, "committer": null, "parents": [{"sha": "a4a51a5262b8a12475fd7811dac3fd05f02886ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4a51a5262b8a12475fd7811dac3fd05f02886ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4a51a5262b8a12475fd7811dac3fd05f02886ce"}], "stats": {"total": 39, "additions": 24, "deletions": 15}, "files": [{"sha": "671fc6ce072447953e785398a437d7a3fa03bf78", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc56f9d2843266a0d38f52b44ca5343604fccc2f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc56f9d2843266a0d38f52b44ca5343604fccc2f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fc56f9d2843266a0d38f52b44ca5343604fccc2f", "patch": "@@ -1,3 +1,12 @@\n+2014-06-30  Richard Henderson  <rth@redhat.com>\n+\n+\tPR rtl-opt/61608\n+\tPR target/39284\n+\t* bb-reorder.c (pass_duplicate_computed_gotos::execute): Cleanup\n+\tthe cfg if there were any changes.\n+\t* passes.def: Revert move of peephole2 after reorder_blocks;\n+\tmove duplicate_computed_gotos before peephole2.\n+\n 2014-06-30  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* except.c (emit_note_eh_region_end): New helper function."}, {"sha": "cd68fee4d77a1c3971fa169a6ffc34f32f1fff59", "filename": "gcc/bb-reorder.c", "status": "modified", "additions": 13, "deletions": 6, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc56f9d2843266a0d38f52b44ca5343604fccc2f/gcc%2Fbb-reorder.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc56f9d2843266a0d38f52b44ca5343604fccc2f/gcc%2Fbb-reorder.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbb-reorder.c?ref=fc56f9d2843266a0d38f52b44ca5343604fccc2f", "patch": "@@ -2520,13 +2520,20 @@ pass_duplicate_computed_gotos::execute (function *fun)\n       changed = true;\n     }\n \n-done:\n-  /* Duplicating blocks above will redirect edges and may cause hot blocks\n-     previously reached by both hot and cold blocks to become dominated only\n-     by cold blocks.  */\n+ done:\n   if (changed)\n-    fixup_partitions ();\n-  cfg_layout_finalize ();\n+    {\n+      /* Duplicating blocks above will redirect edges and may cause hot\n+\t blocks previously reached by both hot and cold blocks to become\n+\t dominated only by cold blocks.  */\n+      fixup_partitions ();\n+\n+      /* Merge the duplicated blocks into predecessors, when possible.  */\n+      cfg_layout_finalize ();\n+      cleanup_cfg (0);\n+    }\n+  else\n+    cfg_layout_finalize ();\n \n   BITMAP_FREE (candidates);\n   return 0;"}, {"sha": "f13df6cff26853f81df1bfdd4e9829d26417dcea", "filename": "gcc/passes.def", "status": "modified", "additions": 2, "deletions": 9, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fc56f9d2843266a0d38f52b44ca5343604fccc2f/gcc%2Fpasses.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fc56f9d2843266a0d38f52b44ca5343604fccc2f/gcc%2Fpasses.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpasses.def?ref=fc56f9d2843266a0d38f52b44ca5343604fccc2f", "patch": "@@ -396,20 +396,13 @@ along with GCC; see the file COPYING3.  If not see\n \t  NEXT_PASS (pass_rtl_dse2);\n \t  NEXT_PASS (pass_stack_adjustments);\n \t  NEXT_PASS (pass_jump2);\n+\t  NEXT_PASS (pass_duplicate_computed_gotos);\n+\t  NEXT_PASS (pass_peephole2);\n \t  NEXT_PASS (pass_if_after_reload);\n \t  NEXT_PASS (pass_regrename);\n \t  NEXT_PASS (pass_cprop_hardreg);\n \t  NEXT_PASS (pass_fast_rtl_dce);\n-\t  NEXT_PASS (pass_duplicate_computed_gotos);\n \t  NEXT_PASS (pass_reorder_blocks);\n-\t  /* We need to run peephole2 pass after the duplicate-\n-\t     compute-gotos and the reorder-blocks pass (PR/39284).\n-\t     We have a single indirect branch in the entire function\n-\t     before duplicate-compute-gotos pass.  This vastly reduces\n-\t     the size of the CFG.\n-\t     For preventing to run peephole2 pass twice, its run after\n-\t     the jump2 got removed.  */\n-\t  NEXT_PASS (pass_peephole2);\n \t  NEXT_PASS (pass_branch_target_load_optimize2);\n \t  NEXT_PASS (pass_leaf_regs);\n \t  NEXT_PASS (pass_split_before_sched2);"}]}