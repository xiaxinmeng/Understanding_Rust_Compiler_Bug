{"sha": "c049309d975209a0c127ebdd95645bece1af4ecb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzA0OTMwOWQ5NzUyMDlhMGMxMjdlYmRkOTU2NDViZWNlMWFmNGVjYg==", "commit": {"author": {"name": "Ulrich Weigand", "email": "uweigand@de.ibm.com", "date": "2009-04-17T10:36:21Z"}, "committer": {"name": "Ulrich Weigand", "email": "uweigand@gcc.gnu.org", "date": "2009-04-17T10:36:21Z"}, "message": "configure.ac: Test for -ffunction-sections -fdata-sections and set SECTION_FLAGS accordingly.\n\n\t* configure.ac: Test for -ffunction-sections -fdata-sections and\n\tset SECTION_FLAGS accordingly.\n\t* configure: Regenerate.\n\n\t* Makefile.am: Add SECTION_FLAGS to AM_CFLAGS.\n\t* Makefile.in: Regenerate.\n\nFrom-SVN: r146241", "tree": {"sha": "ab5c51fd8c311955361c7dfdccdab0a7612968e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab5c51fd8c311955361c7dfdccdab0a7612968e7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c049309d975209a0c127ebdd95645bece1af4ecb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c049309d975209a0c127ebdd95645bece1af4ecb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c049309d975209a0c127ebdd95645bece1af4ecb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c049309d975209a0c127ebdd95645bece1af4ecb/comments", "author": null, "committer": null, "parents": [{"sha": "e3ac77ff51a54f0def757d05affde4ecf3f941e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3ac77ff51a54f0def757d05affde4ecf3f941e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3ac77ff51a54f0def757d05affde4ecf3f941e9"}], "stats": {"total": 153, "additions": 129, "deletions": 24}, "files": [{"sha": "fd703da64476569f0aab0835d5aef5363d754538", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=c049309d975209a0c127ebdd95645bece1af4ecb", "patch": "@@ -1,3 +1,12 @@\n+2009-04-17  Ulrich Weigand  <Ulrich.Weigand@de.ibm.com>\n+\n+\t* configure.ac: Test for -ffunction-sections -fdata-sections and\n+\tset SECTION_FLAGS accordingly.\n+\t* configure: Regenerate.\n+\n+\t* Makefile.am: Add SECTION_FLAGS to AM_CFLAGS.\n+\t* Makefile.in: Regenerate.\n+\n 2009-04-15  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \tPR libfortran/38668"}, {"sha": "ce73ff22e51a15453daffa623f6309747f8af796", "filename": "libgfortran/Makefile.am", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FMakefile.am?ref=c049309d975209a0c127ebdd95645bece1af4ecb", "patch": "@@ -33,6 +33,10 @@ AM_CPPFLAGS = -iquote$(srcdir)/io -I$(srcdir)/$(MULTISRCTOP)../gcc \\\n # Fortran rules for complex multiplication and division\n AM_CFLAGS += -fcx-fortran-rules\n \n+# Use -ffunction-sections -fdata-sections if supported by the compiler\n+SECTION_FLAGS = @SECTION_FLAGS@\n+AM_CFLAGS += $(SECTION_FLAGS)\n+\n gfor_io_src= \\\n io/close.c \\\n io/file_pos.c \\"}, {"sha": "8d356d5f3b857dea830754662944487946a008d0", "filename": "libgfortran/Makefile.in", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FMakefile.in?ref=c049309d975209a0c127ebdd95645bece1af4ecb", "patch": "@@ -815,7 +815,7 @@ AMDEP_TRUE = @AMDEP_TRUE@\n AMTAR = @AMTAR@\n \n # Fortran rules for complex multiplication and division\n-AM_CFLAGS = @AM_CFLAGS@ -fcx-fortran-rules\n+AM_CFLAGS = @AM_CFLAGS@ -fcx-fortran-rules $(SECTION_FLAGS)\n AM_FCFLAGS = @AM_FCFLAGS@\n AR = @AR@\n AS = @AS@\n@@ -875,6 +875,9 @@ PACKAGE_TARNAME = @PACKAGE_TARNAME@\n PACKAGE_VERSION = @PACKAGE_VERSION@\n PATH_SEPARATOR = @PATH_SEPARATOR@\n RANLIB = @RANLIB@\n+\n+# Use -ffunction-sections -fdata-sections if supported by the compiler\n+SECTION_FLAGS = @SECTION_FLAGS@\n SED = @SED@\n SET_MAKE = @SET_MAKE@\n SHELL = @SHELL@"}, {"sha": "0ebca7d67da8a3e69b8bc8475120c2c32ec9e138", "filename": "libgfortran/configure", "status": "modified", "additions": 91, "deletions": 23, "changes": 114, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fconfigure?ref=c049309d975209a0c127ebdd95645bece1af4ecb", "patch": "@@ -457,7 +457,7 @@ ac_includes_default=\"\\\n # include <unistd.h>\n #endif\"\n \n-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os build_libsubdir build_subdir host_subdir target_subdir onestep_TRUE onestep_FALSE onestep host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT multi_basedir toolexecdir toolexeclibdir CC ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE AM_FCFLAGS AM_CFLAGS CFLAGS LIBGFOR_USE_SYMVER_TRUE LIBGFOR_USE_SYMVER_FALSE AS ac_ct_AS AR ac_ct_AR RANLIB ac_ct_RANLIB LIBTOOL SED EGREP FGREP GREP LD DUMPBIN ac_ct_DUMPBIN NM LN_S OBJDUMP ac_ct_OBJDUMP lt_ECHO DSYMUTIL ac_ct_DSYMUTIL NMEDIT ac_ct_NMEDIT LIPO ac_ct_LIPO OTOOL ac_ct_OTOOL OTOOL64 ac_ct_OTOOL64 CPP CPPFLAGS enable_shared enable_static FC FCFLAGS LDFLAGS ac_ct_FC extra_ldflags_libgfortran FPU_HOST_HEADER LIBOBJS LTLIBOBJS'\n+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os build_libsubdir build_subdir host_subdir target_subdir onestep_TRUE onestep_FALSE onestep host host_cpu host_vendor host_os target target_cpu target_vendor target_os INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT multi_basedir toolexecdir toolexeclibdir CC ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE AM_FCFLAGS AM_CFLAGS CFLAGS LIBGFOR_USE_SYMVER_TRUE LIBGFOR_USE_SYMVER_FALSE SECTION_FLAGS AS ac_ct_AS AR ac_ct_AR RANLIB ac_ct_RANLIB LIBTOOL SED EGREP FGREP GREP LD DUMPBIN ac_ct_DUMPBIN NM LN_S OBJDUMP ac_ct_OBJDUMP lt_ECHO DSYMUTIL ac_ct_DSYMUTIL NMEDIT ac_ct_NMEDIT LIPO ac_ct_LIPO OTOOL ac_ct_OTOOL OTOOL64 ac_ct_OTOOL64 CPP CPPFLAGS enable_shared enable_static FC FCFLAGS LDFLAGS ac_ct_FC extra_ldflags_libgfortran FPU_HOST_HEADER LIBOBJS LTLIBOBJS'\n ac_subst_files=''\n ac_pwd=`pwd`\n \n@@ -3500,6 +3500,73 @@ else\n fi\n \n \n+# Figure out whether the compiler supports \"-ffunction-sections -fdata-sections\",\n+# similarly to how libstdc++ does it\n+ac_test_CFLAGS=\"${CFLAGS+set}\"\n+ac_save_CFLAGS=\"$CFLAGS\"\n+\n+# Check for -ffunction-sections -fdata-sections\n+echo \"$as_me:$LINENO: checking for gcc that supports -ffunction-sections -fdata-sections\" >&5\n+echo $ECHO_N \"checking for gcc that supports -ffunction-sections -fdata-sections... $ECHO_C\" >&6\n+CFLAGS='-Werror -ffunction-sections -fdata-sections'\n+cat >conftest.$ac_ext <<_ACEOF\n+/* confdefs.h.  */\n+_ACEOF\n+cat confdefs.h >>conftest.$ac_ext\n+cat >>conftest.$ac_ext <<_ACEOF\n+/* end confdefs.h.  */\n+\n+int\n+main ()\n+{\n+int foo;\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+rm -f conftest.$ac_objext\n+if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n+  (eval $ac_compile) 2>conftest.er1\n+  ac_status=$?\n+  grep -v '^ *+' conftest.er1 >conftest.err\n+  rm -f conftest.er1\n+  cat conftest.err >&5\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); } &&\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; } &&\n+\t { ac_try='test -s conftest.$ac_objext'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }; then\n+  ac_fdsections=yes\n+else\n+  echo \"$as_me: failed program was:\" >&5\n+sed 's/^/| /' conftest.$ac_ext >&5\n+\n+ac_fdsections=no\n+fi\n+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext\n+if test \"$ac_test_CFLAGS\" = set; then\n+  CFLAGS=\"$ac_save_CFLAGS\"\n+else\n+  # this is the suspicious part\n+  CFLAGS=\"\"\n+fi\n+if test x\"$ac_fdsections\" = x\"yes\"; then\n+  SECTION_FLAGS='-ffunction-sections -fdata-sections'\n+fi\n+echo \"$as_me:$LINENO: result: $ac_fdsections\" >&5\n+echo \"${ECHO_T}$ac_fdsections\" >&6\n+\n+\n # Find other programs we need.\n if test -n \"$ac_tool_prefix\"; then\n   # Extract the first word of \"${ac_tool_prefix}as\", so it can be a program name with args.\n@@ -4287,13 +4354,13 @@ if test \"${lt_cv_nm_interface+set}\" = set; then\n else\n   lt_cv_nm_interface=\"BSD nm\"\n   echo \"int some_variable = 0;\" > conftest.$ac_ext\n-  (eval echo \"\\\"\\$as_me:4290: $ac_compile\\\"\" >&5)\n+  (eval echo \"\\\"\\$as_me:4357: $ac_compile\\\"\" >&5)\n   (eval \"$ac_compile\" 2>conftest.err)\n   cat conftest.err >&5\n-  (eval echo \"\\\"\\$as_me:4293: $NM \\\\\\\"conftest.$ac_objext\\\\\\\"\\\"\" >&5)\n+  (eval echo \"\\\"\\$as_me:4360: $NM \\\\\\\"conftest.$ac_objext\\\\\\\"\\\"\" >&5)\n   (eval \"$NM \\\"conftest.$ac_objext\\\"\" 2>conftest.err > conftest.out)\n   cat conftest.err >&5\n-  (eval echo \"\\\"\\$as_me:4296: output\\\"\" >&5)\n+  (eval echo \"\\\"\\$as_me:4363: output\\\"\" >&5)\n   cat conftest.out >&5\n   if $GREP 'External.*some_variable' conftest.out > /dev/null; then\n     lt_cv_nm_interface=\"MS dumpbin\"\n@@ -5450,7 +5517,7 @@ ia64-*-hpux*)\n   ;;\n *-*-irix6*)\n   # Find out which ABI we are using.\n-  echo '#line 5453 \"configure\"' > conftest.$ac_ext\n+  echo '#line 5520 \"configure\"' > conftest.$ac_ext\n   if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   (eval $ac_compile) 2>&5\n   ac_status=$?\n@@ -7239,11 +7306,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:7242: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:7309: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>conftest.err)\n    ac_status=$?\n    cat conftest.err >&5\n-   echo \"$as_me:7246: \\$? = $ac_status\" >&5\n+   echo \"$as_me:7313: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s \"$ac_outfile\"; then\n      # The compiler can only warn and ignore the option if not recognized\n      # So say no if there are warnings other than the usual output.\n@@ -7578,11 +7645,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:7581: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:7648: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>conftest.err)\n    ac_status=$?\n    cat conftest.err >&5\n-   echo \"$as_me:7585: \\$? = $ac_status\" >&5\n+   echo \"$as_me:7652: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s \"$ac_outfile\"; then\n      # The compiler can only warn and ignore the option if not recognized\n      # So say no if there are warnings other than the usual output.\n@@ -7683,11 +7750,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:7686: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:7753: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:7690: \\$? = $ac_status\" >&5\n+   echo \"$as_me:7757: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -7738,11 +7805,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:7741: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:7808: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:7745: \\$? = $ac_status\" >&5\n+   echo \"$as_me:7812: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -10605,7 +10672,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 10608 \"configure\"\n+#line 10675 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -10701,7 +10768,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 10704 \"configure\"\n+#line 10771 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -11027,7 +11094,7 @@ fi\n \n \n # Provide some information about the compiler.\n-echo \"$as_me:11030:\" \\\n+echo \"$as_me:11097:\" \\\n      \"checking for Fortran compiler version\" >&5\n ac_compiler=`set X $ac_compile; echo $2`\n { (eval echo \"$as_me:$LINENO: \\\"$ac_compiler --version </dev/null >&5\\\"\") >&5\n@@ -11263,7 +11330,7 @@ fi\n \n \n # Provide some information about the compiler.\n-echo \"$as_me:11266:\" \\\n+echo \"$as_me:11333:\" \\\n      \"checking for Fortran compiler version\" >&5\n ac_compiler=`set X $ac_compile; echo $2`\n { (eval echo \"$as_me:$LINENO: \\\"$ac_compiler --version </dev/null >&5\\\"\") >&5\n@@ -12003,11 +12070,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:12006: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:12073: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>conftest.err)\n    ac_status=$?\n    cat conftest.err >&5\n-   echo \"$as_me:12010: \\$? = $ac_status\" >&5\n+   echo \"$as_me:12077: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s \"$ac_outfile\"; then\n      # The compiler can only warn and ignore the option if not recognized\n      # So say no if there are warnings other than the usual output.\n@@ -12102,11 +12169,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:12105: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:12172: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:12109: \\$? = $ac_status\" >&5\n+   echo \"$as_me:12176: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -12154,11 +12221,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:12157: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:12224: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:12161: \\$? = $ac_status\" >&5\n+   echo \"$as_me:12228: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -35350,6 +35417,7 @@ s,@AM_CFLAGS@,$AM_CFLAGS,;t t\n s,@CFLAGS@,$CFLAGS,;t t\n s,@LIBGFOR_USE_SYMVER_TRUE@,$LIBGFOR_USE_SYMVER_TRUE,;t t\n s,@LIBGFOR_USE_SYMVER_FALSE@,$LIBGFOR_USE_SYMVER_FALSE,;t t\n+s,@SECTION_FLAGS@,$SECTION_FLAGS,;t t\n s,@AS@,$AS,;t t\n s,@ac_ct_AS@,$ac_ct_AS,;t t\n s,@AR@,$AR,;t t"}, {"sha": "c0709bbbe5113996e4247ebe67f8d766523ddec3", "filename": "libgfortran/configure.ac", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c049309d975209a0c127ebdd95645bece1af4ecb/libgfortran%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fconfigure.ac?ref=c049309d975209a0c127ebdd95645bece1af4ecb", "patch": "@@ -149,6 +149,27 @@ LDFLAGS=\"$save_LDFLAGS\"\n AC_MSG_RESULT($gfortran_use_symver)\n AM_CONDITIONAL(LIBGFOR_USE_SYMVER, [test \"x$gfortran_use_symver\" = xyes])\n \n+# Figure out whether the compiler supports \"-ffunction-sections -fdata-sections\",\n+# similarly to how libstdc++ does it\n+ac_test_CFLAGS=\"${CFLAGS+set}\"\n+ac_save_CFLAGS=\"$CFLAGS\"\n+\n+# Check for -ffunction-sections -fdata-sections\n+AC_MSG_CHECKING([for gcc that supports -ffunction-sections -fdata-sections])\n+CFLAGS='-Werror -ffunction-sections -fdata-sections'\n+AC_TRY_COMPILE(, [int foo;], [ac_fdsections=yes], [ac_fdsections=no])\n+if test \"$ac_test_CFLAGS\" = set; then\n+  CFLAGS=\"$ac_save_CFLAGS\"\n+else\n+  # this is the suspicious part\n+  CFLAGS=\"\"\n+fi\n+if test x\"$ac_fdsections\" = x\"yes\"; then\n+  SECTION_FLAGS='-ffunction-sections -fdata-sections'\n+fi\n+AC_MSG_RESULT($ac_fdsections)\n+AC_SUBST(SECTION_FLAGS)\n+\n # Find other programs we need.\n AC_CHECK_TOOL(AS, as)\n AC_CHECK_TOOL(AR, ar)"}]}