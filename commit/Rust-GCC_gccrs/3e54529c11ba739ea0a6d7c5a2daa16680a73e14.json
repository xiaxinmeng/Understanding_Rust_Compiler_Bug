{"sha": "3e54529c11ba739ea0a6d7c5a2daa16680a73e14", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2U1NDUyOWMxMWJhNzM5ZWEwYTZkN2M1YTJkYWExNjY4MGE3M2UxNA==", "commit": {"author": {"name": "Ralf Wildenhues", "email": "Ralf.Wildenhues@gmx.de", "date": "2009-09-08T17:55:03Z"}, "committer": {"name": "Ralf Wildenhues", "email": "rwild@gcc.gnu.org", "date": "2009-09-08T17:55:03Z"}, "message": "Fix toplevel config.status for HP-UX sed.\n\n/:\n\t* configure.ac: Do not use $extrasub for replacing @if/@endif\n\tparts in Makefile; instead, use additional arguments to\n\tAC_CONFIG_COMMANDS to do the replacement manually, with several\n\tsed invocations, to avoid HP-UX sed command limits.\n\t* configure: Regenerate.\n\nFrom-SVN: r151525", "tree": {"sha": "0c0b930efbc445b58dd42d7f9e328d2fb01fbb87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c0b930efbc445b58dd42d7f9e328d2fb01fbb87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3e54529c11ba739ea0a6d7c5a2daa16680a73e14", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e54529c11ba739ea0a6d7c5a2daa16680a73e14", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e54529c11ba739ea0a6d7c5a2daa16680a73e14", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e54529c11ba739ea0a6d7c5a2daa16680a73e14/comments", "author": null, "committer": null, "parents": [{"sha": "6a57e634bf5c78f8d7297a07bca2a77c4a186ab9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a57e634bf5c78f8d7297a07bca2a77c4a186ab9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a57e634bf5c78f8d7297a07bca2a77c4a186ab9"}], "stats": {"total": 83, "additions": 62, "deletions": 21}, "files": [{"sha": "b4a5819771f907b7530eaf2756e7cf68e8427fa5", "filename": "ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e54529c11ba739ea0a6d7c5a2daa16680a73e14/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e54529c11ba739ea0a6d7c5a2daa16680a73e14/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=3e54529c11ba739ea0a6d7c5a2daa16680a73e14", "patch": "@@ -1,3 +1,11 @@\n+2009-09-08  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>\n+\n+\t* configure.ac: Do not use $extrasub for replacing @if/@endif\n+\tparts in Makefile; instead, use additional arguments to\n+\tAC_CONFIG_COMMANDS to do the replacement manually, with several\n+\tsed invocations, to avoid HP-UX sed command limits.\n+\t* configure: Regenerate.\n+\n 2009-09-08  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* libtool.m4 (output_verbose_link_cmd): Require leading blank, and"}, {"sha": "aa1662c88713dbb4e4c46232279c599af775e036", "filename": "configure", "status": "modified", "additions": 30, "deletions": 10, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e54529c11ba739ea0a6d7c5a2daa16680a73e14/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e54529c11ba739ea0a6d7c5a2daa16680a73e14/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=3e54529c11ba739ea0a6d7c5a2daa16680a73e14", "patch": "@@ -6519,12 +6519,13 @@ INSTALL_GDB_TK=`echo ${GDB_TK} | sed s/-all-/-install-/g`\n # configuration, so that the top-level Makefile reconfigures them,\n # like we used to do when configure itself was recursive.\n \n-# Loop over modules.  $extrasub must be used with care, limiting as\n-# much as possible the usage of range addresses.  That's because autoconf\n-# splits the sed script to overcome limits in the number of commands,\n-# and relying on carefully-timed sed passes may turn out to be very hard\n-# to maintain later.  In this particular case, you just have to be careful\n-# not to nest @if/@endif pairs, because configure will not warn you at all.\n+# Loop over modules.  We used to use the \"$extrasub\" feature from Autoconf\n+# but now we're fixing up the Makefile ourselves with the additional\n+# commands passed to AC_CONFIG_FILES.  Use separate variables\n+# extrasub-{build,host,target} not because there is any reason to split\n+# the substitutions up that way, but only to remain below the limit of\n+# 99 commands in a script, for HP-UX sed.\n+# Do not nest @if/@endif pairs, because configure will not warn you at all.\n \n # Check whether --enable-bootstrap was given.\n if test \"${enable_bootstrap+set}\" = set; then :\n@@ -6620,18 +6621,20 @@ fi\n $as_echo \"$BUILD_CONFIG\" >&6; }\n \n \n+extrasub_build=\n for module in ${build_configdirs} ; do\n   if test -z \"${no_recursion}\" \\\n      && test -f ${build_subdir}/${module}/Makefile; then\n     echo 1>&2 \"*** removing ${build_subdir}/${module}/Makefile to force reconfigure\"\n     rm -f ${build_subdir}/${module}/Makefile\n   fi\n-  extrasub=\"$extrasub\n+  extrasub_build=\"$extrasub_build\n /^@if build-$module\\$/d\n /^@endif build-$module\\$/d\n /^@if build-$module-$bootstrap_suffix\\$/d\n /^@endif build-$module-$bootstrap_suffix\\$/d\"\n done\n+extrasub_host=\n for module in ${configdirs} ; do\n   if test -z \"${no_recursion}\"; then\n     for file in stage*-${module}/Makefile prev-${module}/Makefile ${module}/Makefile; do\n@@ -6641,12 +6644,13 @@ for module in ${configdirs} ; do\n       fi\n     done\n   fi\n-  extrasub=\"$extrasub\n+  extrasub_host=\"$extrasub_host\n /^@if $module\\$/d\n /^@endif $module\\$/d\n /^@if $module-$bootstrap_suffix\\$/d\n /^@endif $module-$bootstrap_suffix\\$/d\"\n done\n+extrasub_target=\n for module in ${target_configdirs} ; do\n   if test -z \"${no_recursion}\" \\\n      && test -f ${target_subdir}/${module}/Makefile; then\n@@ -6660,14 +6664,15 @@ for module in ${target_configdirs} ; do\n     *) target_bootstrap_suffix=no-bootstrap ;;\n   esac\n \n-  extrasub=\"$extrasub\n+  extrasub_target=\"$extrasub_target\n /^@if target-$module\\$/d\n /^@endif target-$module\\$/d\n /^@if target-$module-$target_bootstrap_suffix\\$/d\n /^@endif target-$module-$target_bootstrap_suffix\\$/d\"\n done\n \n-extrasub=\"$extrasub\n+# Do the final fixup along with target modules.\n+extrasub_target=\"$extrasub_target\n /^@if /,/^@endif /d\"\n \n # Create the serialization dependencies.  This uses a temporary file.\n@@ -14036,6 +14041,13 @@ _ASBOX\n \n _ACEOF\n cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1\n+#\n+# INIT-COMMANDS\n+#\n+extrasub_build=\"$extrasub_build\"\n+   extrasub_host=\"$extrasub_host\"\n+   extrasub_target=\"$extrasub_target\"\n+\n _ACEOF\n \n cat >>$CONFIG_STATUS <<\\_ACEOF || ac_write_fail=1\n@@ -14491,6 +14503,14 @@ which seems to be undefined.  Please make sure it is defined.\" >&2;}\n \n   esac\n \n+\n+  case $ac_file$ac_mode in\n+    \"Makefile\":F) sed \"$extrasub_build\" Makefile |\n+   sed \"$extrasub_host\" |\n+   sed \"$extrasub_target\" > mf$$\n+   mv -f mf$$ Makefile ;;\n+\n+  esac\n done # for ac_tag\n \n "}, {"sha": "a85c3bd35471d69f2d93aa405fada8f447127758", "filename": "configure.ac", "status": "modified", "additions": 24, "deletions": 11, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e54529c11ba739ea0a6d7c5a2daa16680a73e14/configure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e54529c11ba739ea0a6d7c5a2daa16680a73e14/configure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.ac?ref=3e54529c11ba739ea0a6d7c5a2daa16680a73e14", "patch": "@@ -2410,12 +2410,13 @@ INSTALL_GDB_TK=`echo ${GDB_TK} | sed s/-all-/-install-/g`\n # configuration, so that the top-level Makefile reconfigures them,\n # like we used to do when configure itself was recursive.\n \n-# Loop over modules.  $extrasub must be used with care, limiting as\n-# much as possible the usage of range addresses.  That's because autoconf\n-# splits the sed script to overcome limits in the number of commands,\n-# and relying on carefully-timed sed passes may turn out to be very hard\n-# to maintain later.  In this particular case, you just have to be careful\n-# not to nest @if/@endif pairs, because configure will not warn you at all.\n+# Loop over modules.  We used to use the \"$extrasub\" feature from Autoconf\n+# but now we're fixing up the Makefile ourselves with the additional\n+# commands passed to AC_CONFIG_FILES.  Use separate variables\n+# extrasub-{build,host,target} not because there is any reason to split\n+# the substitutions up that way, but only to remain below the limit of\n+# 99 commands in a script, for HP-UX sed.\n+# Do not nest @if/@endif pairs, because configure will not warn you at all.\n \n AC_ARG_ENABLE([bootstrap],\n [  --enable-bootstrap      enable bootstrapping @<:@yes if native build@:>@],,\n@@ -2502,18 +2503,20 @@ fi\n AC_MSG_RESULT($BUILD_CONFIG)\n AC_SUBST(BUILD_CONFIG)\n \n+extrasub_build=\n for module in ${build_configdirs} ; do\n   if test -z \"${no_recursion}\" \\\n      && test -f ${build_subdir}/${module}/Makefile; then\n     echo 1>&2 \"*** removing ${build_subdir}/${module}/Makefile to force reconfigure\"\n     rm -f ${build_subdir}/${module}/Makefile\n   fi\n-  extrasub=\"$extrasub\n+  extrasub_build=\"$extrasub_build\n /^@if build-$module\\$/d\n /^@endif build-$module\\$/d\n /^@if build-$module-$bootstrap_suffix\\$/d\n /^@endif build-$module-$bootstrap_suffix\\$/d\"\n done\n+extrasub_host=\n for module in ${configdirs} ; do\n   if test -z \"${no_recursion}\"; then\n     for file in stage*-${module}/Makefile prev-${module}/Makefile ${module}/Makefile; do\n@@ -2523,12 +2526,13 @@ for module in ${configdirs} ; do\n       fi\n     done\n   fi\n-  extrasub=\"$extrasub\n+  extrasub_host=\"$extrasub_host\n /^@if $module\\$/d\n /^@endif $module\\$/d\n /^@if $module-$bootstrap_suffix\\$/d\n /^@endif $module-$bootstrap_suffix\\$/d\"\n done\n+extrasub_target=\n for module in ${target_configdirs} ; do\n   if test -z \"${no_recursion}\" \\\n      && test -f ${target_subdir}/${module}/Makefile; then\n@@ -2542,14 +2546,15 @@ for module in ${target_configdirs} ; do\n     *) target_bootstrap_suffix=no-bootstrap ;;\n   esac\n \n-  extrasub=\"$extrasub\n+  extrasub_target=\"$extrasub_target\n /^@if target-$module\\$/d\n /^@endif target-$module\\$/d\n /^@if target-$module-$target_bootstrap_suffix\\$/d\n /^@endif target-$module-$target_bootstrap_suffix\\$/d\"\n done\n \n-extrasub=\"$extrasub\n+# Do the final fixup along with target modules.\n+extrasub_target=\"$extrasub_target\n /^@if /,/^@endif /d\"\n \n # Create the serialization dependencies.  This uses a temporary file.\n@@ -3167,4 +3172,12 @@ case \"$target\" in\n esac\n AC_SUBST(compare_exclusions)\n \n-AC_OUTPUT(Makefile)\n+AC_CONFIG_FILES([Makefile],\n+  [sed \"$extrasub_build\" Makefile |\n+   sed \"$extrasub_host\" |\n+   sed \"$extrasub_target\" > mf$$\n+   mv -f mf$$ Makefile],\n+  [extrasub_build=\"$extrasub_build\"\n+   extrasub_host=\"$extrasub_host\"\n+   extrasub_target=\"$extrasub_target\"])\n+AC_OUTPUT"}]}