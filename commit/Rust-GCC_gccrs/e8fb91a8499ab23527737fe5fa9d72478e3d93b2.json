{"sha": "e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZThmYjkxYTg0OTlhYjIzNTI3NzM3ZmU1ZmE5ZDcyNDc4ZTNkOTNiMg==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2015-03-01T00:13:10Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2015-03-01T00:13:10Z"}, "message": "ICF is more strict about non-common function and var\n\n\t* ipa-icf-gimple.c (func_checker::compare_variable_decl):\n\tValidate variable alignment.\n\t* ipa-icf.c (sem_function::equals_private): Be more precise\n\tabout non-common function attributes.\n\t(sem_variable::equals): Likewise.\n\t* gcc.target/i386/stackalign/longlong-2.c: Omit ICF.\n\t* g++.dg/ipa/pr63595.C: Update expected results.\n\nFrom-SVN: r221080", "tree": {"sha": "b32624baede6dc130c452a014b11eb18829b4a1e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b32624baede6dc130c452a014b11eb18829b4a1e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bbcdfb939d7ef82bd50afe51b1f332f7191e6d27", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbcdfb939d7ef82bd50afe51b1f332f7191e6d27", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bbcdfb939d7ef82bd50afe51b1f332f7191e6d27"}], "stats": {"total": 57, "additions": 55, "deletions": 2}, "files": [{"sha": "5d792b1dc2b3379e615b324d03d3b7b563038aa0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "patch": "@@ -1,3 +1,13 @@\n+2015-03-01  Martin Liska  <mliska@suse.cz>\n+\n+\t    Jan Hubicka   <hubicka@ucw.cz>\n+\n+\t* ipa-icf-gimple.c (func_checker::compare_variable_decl):\n+\tValidate variable alignment.\n+\t* ipa-icf.c (sem_function::equals_private): Be more precise\n+\tabout non-common function attributes.\n+\t(sem_variable::equals): Likewise.\n+\n 2015-02-28  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR ipa/65237"}, {"sha": "cbeb7952ca10d86f5877f848671b6b9c0796d6e0", "filename": "gcc/ipa-icf-gimple.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Fipa-icf-gimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Fipa-icf-gimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-icf-gimple.c?ref=e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "patch": "@@ -575,6 +575,9 @@ func_checker::compare_variable_decl (tree t1, tree t2)\n   if (t1 == t2)\n     return true;\n \n+  if (DECL_ALIGN (t1) != DECL_ALIGN (t2))\n+    return return_false_with_msg (\"alignments are different\");\n+\n   if (DECL_HARD_REGISTER (t1) != DECL_HARD_REGISTER (t2))\n     return return_false_with_msg (\"DECL_HARD_REGISTER are different\");\n "}, {"sha": "6db5c084ad519e37975415a16700cb1771314237", "filename": "gcc/ipa-icf.c", "status": "modified", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Fipa-icf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Fipa-icf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-icf.c?ref=e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "patch": "@@ -619,6 +619,30 @@ sem_function::equals_private (sem_item *item,\n     if (!compare_phi_node (bb_sorted[i]->bb, m_compared_func->bb_sorted[i]->bb))\n       return return_false_with_msg (\"PHI node comparison returns false\");\n \n+  /* Compare special function DECL attributes.  */\n+  if (DECL_FUNCTION_PERSONALITY (decl) != DECL_FUNCTION_PERSONALITY (item->decl))\n+    return return_false_with_msg (\"function personalities are different\");\n+\n+  if (DECL_DISREGARD_INLINE_LIMITS (decl) != DECL_DISREGARD_INLINE_LIMITS (item->decl))\n+    return return_false_with_msg (\"DECL_DISREGARD_INLINE_LIMITS are different\");\n+\n+  if (DECL_DECLARED_INLINE_P (decl) != DECL_DECLARED_INLINE_P (item->decl))\n+    return return_false_with_msg (\"inline attributes are different\");\n+\n+  if (DECL_IS_OPERATOR_NEW (decl) != DECL_IS_OPERATOR_NEW (item->decl))\n+    return return_false_with_msg (\"operator new flags are different\");\n+\n+  if (DECL_NO_INSTRUMENT_FUNCTION_ENTRY_EXIT (decl)\n+       != DECL_NO_INSTRUMENT_FUNCTION_ENTRY_EXIT (item->decl))\n+    return return_false_with_msg (\"intrument function entry exit \"\n+\t\t\t\t  \"attributes are different\");\n+\n+  if (DECL_NO_LIMIT_STACK (decl) != DECL_NO_LIMIT_STACK (item->decl))\n+    return return_false_with_msg (\"no stack limit attributes are different\");\n+\n+  if (flags_from_decl_or_type (decl) != flags_from_decl_or_type (item->decl))\n+    return return_false_with_msg (\"decl_or_type flags are different\");\n+\n   return result;\n }\n \n@@ -1298,6 +1322,17 @@ sem_variable::equals (sem_item *item,\n   if (!ctor || !v->ctor)\n     return return_false_with_msg (\"ctor is missing for semantic variable\");\n \n+  if (DECL_IN_CONSTANT_POOL (decl)\n+      && (DECL_IN_CONSTANT_POOL (item->decl)\n+\t  || item->node->address_matters_p ()))\n+    return return_false_with_msg (\"constant pool\");\n+\n+  if (DECL_IN_TEXT_SECTION (decl) != DECL_IN_TEXT_SECTION (item->decl))\n+    return return_false_with_msg (\"text section\");\n+\n+  if (DECL_TLS_MODEL (decl) || DECL_TLS_MODEL (item->decl))\n+    return return_false_with_msg (\"TLS model\");\n+\n   return sem_variable::equals (ctor, v->ctor);\n }\n "}, {"sha": "0ec2c0cb9b83ea5895765a35a7a11f5aba6f68e2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "patch": "@@ -1,3 +1,8 @@\n+2015-03-01  Martin Liska  <mliska@suse.cz>\n+\n+\t* gcc.target/i386/stackalign/longlong-2.c: Omit ICF.\n+\t* g++.dg/ipa/pr63595.C: Update expected results.\n+\n 2015-02-28  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR ipa/65236"}, {"sha": "48ba4193b7111d9ce5a75555114ffe375dad8815", "filename": "gcc/testsuite/g++.dg/ipa/pr63595.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fipa%2Fpr63595.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fipa%2Fpr63595.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fipa%2Fpr63595.C?ref=e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "patch": "@@ -76,5 +76,5 @@ int main()\n   return 0;\n }\n \n-/* { dg-final { scan-ipa-dump \"Equal symbols: 1\" \"icf\"  } } */\n+/* { dg-final { scan-ipa-dump \"Equal symbols: 0\" \"icf\"  } } */\n /* { dg-final { cleanup-ipa-dump \"icf\" } } */"}, {"sha": "d52b9d15f64bf427c88f4564f70c5997cbf17454", "filename": "gcc/testsuite/gcc.target/i386/stackalign/longlong-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fstackalign%2Flonglong-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e8fb91a8499ab23527737fe5fa9d72478e3d93b2/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fstackalign%2Flonglong-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fstackalign%2Flonglong-2.c?ref=e8fb91a8499ab23527737fe5fa9d72478e3d93b2", "patch": "@@ -1,6 +1,6 @@\n /* { dg-do compile  { target { ! *-*-darwin* } } } */\n /* { dg-require-effective-target ia32 } */\n-/* { dg-options \"-O2 -mpreferred-stack-boundary=2\" } */\n+/* { dg-options \"-O2 -mpreferred-stack-boundary=2 -fno-ipa-icf\" } */\n /* { dg-final { scan-assembler-times \"and\\[lq\\]?\\[^\\\\n\\]*-8,\\[^\\\\n\\]*sp\" 2 } } */ \n /* { dg-final { scan-assembler-times \"and\\[lq\\]?\\[^\\\\n\\]*-16,\\[^\\\\n\\]*sp\" 2 } } */ \n "}]}