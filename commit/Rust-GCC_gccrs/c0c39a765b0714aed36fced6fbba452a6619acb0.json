{"sha": "c0c39a765b0714aed36fced6fbba452a6619acb0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzBjMzlhNzY1YjA3MTRhZWQzNmZjZWQ2ZmJiYTQ1MmE2NjE5YWNiMA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-05-13T09:21:02Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-05-13T09:21:02Z"}, "message": "Fold single imm use of a FMA if it is a negation [PR95060]\n\nmatch.pd already has simplifications for negation of a FMA (FMS, FNMA, FNMS)\ncall if it is single use, but when the widening_mul pass discovers FMAs,\nnothing folds the statements anymore.\n\nSo, the following patch adjusts the widening_mul pass to handle that.\n\nI had to adjust quite a lot of tests, because they have in them nested FMAs\n(one FMA feeding another one) and the patch results in some (equivalent) changes\nin the chosen instructions, previously the negation of one FMA's result\nwould result in the dependent FMA being adjusted for the negation, but now\ninstead the first FMA is adjusted.\n\n2020-05-13  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR tree-optimization/95060\n\t* tree-ssa-math-opts.c (convert_mult_to_fma_1): Fold a NEGATE_EXPR\n\tif it is the single use of the FMA internal builtin.\n\n\t* gcc.target/i386/avx512f-pr95060.c: New test.\n\t* gcc.target/i386/fma_double_1.c: Adjust expected insn counts.\n\t* gcc.target/i386/fma_double_2.c: Likewise.\n\t* gcc.target/i386/fma_double_3.c: Likewise.\n\t* gcc.target/i386/fma_double_4.c: Likewise.\n\t* gcc.target/i386/fma_double_5.c: Likewise.\n\t* gcc.target/i386/fma_double_6.c: Likewise.\n\t* gcc.target/i386/fma_float_1.c: Likewise.\n\t* gcc.target/i386/fma_float_2.c: Likewise.\n\t* gcc.target/i386/fma_float_3.c: Likewise.\n\t* gcc.target/i386/fma_float_4.c: Likewise.\n\t* gcc.target/i386/fma_float_5.c: Likewise.\n\t* gcc.target/i386/fma_float_6.c: Likewise.\n\t* gcc.target/i386/l_fma_double_1.c: Likewise.\n\t* gcc.target/i386/l_fma_double_2.c: Likewise.\n\t* gcc.target/i386/l_fma_double_3.c: Likewise.\n\t* gcc.target/i386/l_fma_double_4.c: Likewise.\n\t* gcc.target/i386/l_fma_double_5.c: Likewise.\n\t* gcc.target/i386/l_fma_double_6.c: Likewise.\n\t* gcc.target/i386/l_fma_float_1.c: Likewise.\n\t* gcc.target/i386/l_fma_float_2.c: Likewise.\n\t* gcc.target/i386/l_fma_float_3.c: Likewise.\n\t* gcc.target/i386/l_fma_float_4.c: Likewise.\n\t* gcc.target/i386/l_fma_float_5.c: Likewise.\n\t* gcc.target/i386/l_fma_float_6.c: Likewise.", "tree": {"sha": "117abca1f8030df99ba6d5b4e5d0ec7d1139edc8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/117abca1f8030df99ba6d5b4e5d0ec7d1139edc8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c0c39a765b0714aed36fced6fbba452a6619acb0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0c39a765b0714aed36fced6fbba452a6619acb0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0c39a765b0714aed36fced6fbba452a6619acb0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0c39a765b0714aed36fced6fbba452a6619acb0/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f884bef21cccc05d748fd7869cd641cbb4f6b6bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f884bef21cccc05d748fd7869cd641cbb4f6b6bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f884bef21cccc05d748fd7869cd641cbb4f6b6bb"}], "stats": {"total": 370, "additions": 226, "deletions": 144}, "files": [{"sha": "ba230b42121073fb7218ef0c191515f61f6d23e2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -1,3 +1,9 @@\n+2020-05-13  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/95060\n+\t* tree-ssa-math-opts.c (convert_mult_to_fma_1): Fold a NEGATE_EXPR\n+\tif it is the single use of the FMA internal builtin.\n+\n 2020-05-13  Bin Cheng  <bin.cheng@linux.alibaba.com>\n \n \tPR tree-optimization/94969"}, {"sha": "02878c0647c49438411e6ab3be79f9997a342e2f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -1,3 +1,32 @@\n+2020-05-13  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/95060\n+\t* gcc.target/i386/avx512f-pr95060.c: New test.\n+\t* gcc.target/i386/fma_double_1.c: Adjust expected insn counts.\n+\t* gcc.target/i386/fma_double_2.c: Likewise.\n+\t* gcc.target/i386/fma_double_3.c: Likewise.\n+\t* gcc.target/i386/fma_double_4.c: Likewise.\n+\t* gcc.target/i386/fma_double_5.c: Likewise.\n+\t* gcc.target/i386/fma_double_6.c: Likewise.\n+\t* gcc.target/i386/fma_float_1.c: Likewise.\n+\t* gcc.target/i386/fma_float_2.c: Likewise.\n+\t* gcc.target/i386/fma_float_3.c: Likewise.\n+\t* gcc.target/i386/fma_float_4.c: Likewise.\n+\t* gcc.target/i386/fma_float_5.c: Likewise.\n+\t* gcc.target/i386/fma_float_6.c: Likewise.\n+\t* gcc.target/i386/l_fma_double_1.c: Likewise.\n+\t* gcc.target/i386/l_fma_double_2.c: Likewise.\n+\t* gcc.target/i386/l_fma_double_3.c: Likewise.\n+\t* gcc.target/i386/l_fma_double_4.c: Likewise.\n+\t* gcc.target/i386/l_fma_double_5.c: Likewise.\n+\t* gcc.target/i386/l_fma_double_6.c: Likewise.\n+\t* gcc.target/i386/l_fma_float_1.c: Likewise.\n+\t* gcc.target/i386/l_fma_float_2.c: Likewise.\n+\t* gcc.target/i386/l_fma_float_3.c: Likewise.\n+\t* gcc.target/i386/l_fma_float_4.c: Likewise.\n+\t* gcc.target/i386/l_fma_float_5.c: Likewise.\n+\t* gcc.target/i386/l_fma_float_6.c: Likewise.\n+\n 2020-05-13  Martin Liska  <mliska@suse.cz>\n \n \tPR sanitizer/95051"}, {"sha": "b38dc4f1e1325e054b9579d48c53b28103447499", "filename": "gcc/testsuite/gcc.target/i386/avx512f-pr95060.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr95060.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr95060.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr95060.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -0,0 +1,22 @@\n+/* PR tree-optimization/95060 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -ffast-math -mavx512f\" } */\n+/* { dg-final { scan-assembler \"\\tvfnmsub\" } } */\n+/* { dg-final { scan-assembler-not \"\\tvfmadd\" } } */\n+\n+#define N 32\n+float r[N], a[N], b[N], c[N];\n+\n+void\n+foo (void)\n+{\n+  for (int i = 0; i < N; i++)\n+    r[i] = -(a[i] * b[i]) - c[i];\n+}\n+\n+void\n+bar (void)\n+{\n+  for (int i = 0; i < N; i++)\n+    r[i] = -(a[i] * b[i] + c[i]);\n+}"}, {"sha": "767ee5ca63e36b6cbecea9abe7a1c3565eecba5a", "filename": "gcc/testsuite/gcc.target/i386/fma_double_1.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_1.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,11 +8,9 @@\n \n #include \"fma_1.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132sd\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132sd\" 8  } } */\n /* { dg-final { scan-assembler-times \"vfmadd231sd\" 4  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132sd\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132sd\" 8  } } */\n /* { dg-final { scan-assembler-times \"vfmsub231sd\" 4  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132sd\" 4  } } */\n /* { dg-final { scan-assembler-times \"vfnmadd231sd\" 4  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132sd\" 4  } } */\n /* { dg-final { scan-assembler-times \"vfnmsub231sd\" 4  } } */"}, {"sha": "f15fb3b2cfa1a8dd24d745c21dd0ed61f26172f7", "filename": "gcc/testsuite/gcc.target/i386/fma_double_2.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_2.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_2.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132sd\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd132sd\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub132sd\" 4  } } */"}, {"sha": "6b67774ca9113c9d8a59addb559848a7696f8b97", "filename": "gcc/testsuite/gcc.target/i386/fma_double_3.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_3.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_3.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+sd\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+sd\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+sd\" 4  } } */"}, {"sha": "267f6fd2d161d28c4620b5dfa571f969942bb5b6", "filename": "gcc/testsuite/gcc.target/i386/fma_double_4.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_4.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_4.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132sd\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd132sd\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub132sd\" 4  } } */"}, {"sha": "fd7fcabe5b56589f383b1a5934c9cdc9d154591d", "filename": "gcc/testsuite/gcc.target/i386/fma_double_5.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_5.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_5.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[132\\]+sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+sd\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[132\\]+sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+sd\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+sd\" 4  } } */"}, {"sha": "f7ab1ce5b75450e1841f164bc745bcf297b371ce", "filename": "gcc/testsuite/gcc.target/i386/fma_double_6.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_double_6.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_6.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132sd\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132sd\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132sd\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd132sd\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub132sd\" 4  } } */"}, {"sha": "a4ac2cbbe00927662494c045dd53b413ab3ae899", "filename": "gcc/testsuite/gcc.target/i386/fma_float_1.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_1.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,11 +8,9 @@\n \n #include \"fma_1.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132ss\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132ss\" 8  } } */\n /* { dg-final { scan-assembler-times \"vfmadd231ss\" 4  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132ss\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132ss\" 8  } } */\n /* { dg-final { scan-assembler-times \"vfmsub231ss\" 4  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132ss\" 4  } } */\n /* { dg-final { scan-assembler-times \"vfnmadd231ss\" 4  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132ss\" 4  } } */\n /* { dg-final { scan-assembler-times \"vfnmsub231ss\" 4  } } */"}, {"sha": "a7509116b81ea47e892a592189d2e3fdec5a39fa", "filename": "gcc/testsuite/gcc.target/i386/fma_float_2.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_2.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_2.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132ss\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd132ss\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub132ss\" 4  } } */"}, {"sha": "d88a3bfcd25060e2e0e0c9c69a12568622222056", "filename": "gcc/testsuite/gcc.target/i386/fma_float_3.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_3.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_3.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[132\\]+ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+ss\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[132\\]+ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+ss\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+ss\" 4  } } */"}, {"sha": "cb1a81cbb26fffcaf47135bd9c575ad0db620e34", "filename": "gcc/testsuite/gcc.target/i386/fma_float_4.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_4.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_4.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132ss\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd132ss\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub132ss\" 4  } } */"}, {"sha": "3a62590d2a2e1af9eea4c7ab1be97eb58c8b4172", "filename": "gcc/testsuite/gcc.target/i386/fma_float_5.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_5.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_5.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[132\\]+ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+ss\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[132\\]+ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[132\\]+ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[132\\]+ss\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[132\\]+ss\" 4  } } */"}, {"sha": "30d8283bde390e0eb853d84505c615deb38eb503", "filename": "gcc/testsuite/gcc.target/i386/fma_float_6.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffma_float_6.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -8,7 +8,7 @@\n \n #include \"fma_6.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfmsub132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd132ss\" 8  } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub132ss\" 8  } } */\n+/* { dg-final { scan-assembler-times \"vfmadd132ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfmsub132ss\" 12  } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd132ss\" 4  } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub132ss\" 4  } } */"}, {"sha": "5089874faa5c89e6072b7e31eba388788aaa32a2", "filename": "gcc/testsuite/gcc.target/i386/l_fma_double_1.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_1.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -11,11 +11,11 @@ typedef double adouble __attribute__((aligned(sizeof (double))));\n \n #include \"l_fma_1.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 16 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 16 } } */"}, {"sha": "e4696204299792a26b3658a384d6109659946226", "filename": "gcc/testsuite/gcc.target/i386/l_fma_double_2.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_2.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -11,11 +11,11 @@ typedef double adouble __attribute__((aligned(sizeof (double))));\n \n #include \"l_fma_2.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 16 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 16 } } */"}, {"sha": "df986d0a633dfed241a671b3f5c65029fdb43743", "filename": "gcc/testsuite/gcc.target/i386/l_fma_double_3.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_3.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -11,11 +11,11 @@ typedef double adouble __attribute__((aligned(sizeof (double))));\n \n #include \"l_fma_3.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 16 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 16 } } */"}, {"sha": "ae065590f62d847f101d35b68a4844f46a47fc63", "filename": "gcc/testsuite/gcc.target/i386/l_fma_double_4.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_4.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -11,11 +11,11 @@ typedef double adouble __attribute__((aligned(sizeof (double))));\n \n #include \"l_fma_4.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 16 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 16 } } */"}, {"sha": "5d31abaa5a7271a910aafda437c065cae6aff3f4", "filename": "gcc/testsuite/gcc.target/i386/l_fma_double_5.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_5.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -11,11 +11,11 @@ typedef double adouble __attribute__((aligned(sizeof (double))));\n \n #include \"l_fma_5.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 16 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 16 } } */"}, {"sha": "ff857fb02f174262ea9c07465805948e53249c52", "filename": "gcc/testsuite/gcc.target/i386/l_fma_double_6.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_double_6.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -11,11 +11,11 @@ typedef double adouble __attribute__((aligned(sizeof (double))));\n \n #include \"l_fma_6.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 32 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+pd\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+pd\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+sd\" 48 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+sd\" 16 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+sd\" 16 } } */"}, {"sha": "daef8767a5d3db155e8a85dee6af87d07aa5cd2a", "filename": "gcc/testsuite/gcc.target/i386/l_fma_float_1.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_1.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -10,11 +10,11 @@\n \n #include \"l_fma_1.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 64 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 32 } } */"}, {"sha": "ffa5c6f1b398aa4d331cd2c3a049aaf627f77663", "filename": "gcc/testsuite/gcc.target/i386/l_fma_float_2.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_2.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -10,11 +10,11 @@\n \n #include \"l_fma_2.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 64 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 32 } } */"}, {"sha": "a05ef5912f4d17cdd5e8e49edaebf8c89b73c3f5", "filename": "gcc/testsuite/gcc.target/i386/l_fma_float_3.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_3.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -10,11 +10,11 @@\n \n #include \"l_fma_3.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 64 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 32 } } */"}, {"sha": "b0a37baafeb3f4f664fc39d712f0f1ac851b08b0", "filename": "gcc/testsuite/gcc.target/i386/l_fma_float_4.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_4.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -10,11 +10,11 @@\n \n #include \"l_fma_4.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 64 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 32 } } */"}, {"sha": "598275c54af8cda32541614a67fab4217d7b85d0", "filename": "gcc/testsuite/gcc.target/i386/l_fma_float_5.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_5.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -10,11 +10,11 @@\n \n #include \"l_fma_5.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 64 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 32 } } */"}, {"sha": "1e7a2162c07eef5b15375b51878489464c672fca", "filename": "gcc/testsuite/gcc.target/i386/l_fma_float_6.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fl_fma_float_6.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -10,11 +10,11 @@\n \n #include \"l_fma_6.h\"\n \n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 8 } } */\n-/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 64 } } */\n-/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 64 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ps\" 12 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ps\" 4 } } */\n+/* { dg-final { scan-assembler-times \"vfmadd\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfmsub\\[123\\]+ss\" 96 } } */\n+/* { dg-final { scan-assembler-times \"vfnmadd\\[123\\]+ss\" 32 } } */\n+/* { dg-final { scan-assembler-times \"vfnmsub\\[123\\]+ss\" 32 } } */"}, {"sha": "5fbaa24142e3ca6d7325f6860ad6779ddd1b4bc7", "filename": "gcc/tree-ssa-math-opts.c", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftree-ssa-math-opts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0c39a765b0714aed36fced6fbba452a6619acb0/gcc%2Ftree-ssa-math-opts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-math-opts.c?ref=c0c39a765b0714aed36fced6fbba452a6619acb0", "patch": "@@ -2930,6 +2930,35 @@ convert_mult_to_fma_1 (tree mul_result, tree op1, tree op2)\n \t  fprintf (dump_file, \"\\n\");\n \t}\n \n+      /* If the FMA result is negated in a single use, fold the negation\n+\t too.  */\n+      orig_stmt = gsi_stmt (gsi);\n+      use_operand_p use_p;\n+      gimple *neg_stmt;\n+      if (is_gimple_call (orig_stmt)\n+\t  && gimple_call_internal_p (orig_stmt)\n+\t  && gimple_call_lhs (orig_stmt)\n+\t  && TREE_CODE (gimple_call_lhs (orig_stmt)) == SSA_NAME\n+\t  && single_imm_use (gimple_call_lhs (orig_stmt), &use_p, &neg_stmt)\n+\t  && is_gimple_assign (neg_stmt)\n+\t  && gimple_assign_rhs_code (neg_stmt) == NEGATE_EXPR\n+\t  && !stmt_could_throw_p (cfun, neg_stmt))\n+\t{\n+\t  gsi = gsi_for_stmt (neg_stmt);\n+\t  if (fold_stmt (&gsi, follow_all_ssa_edges))\n+\t    {\n+\t      if (maybe_clean_or_replace_eh_stmt (neg_stmt, gsi_stmt (gsi)))\n+\t\tgcc_unreachable ();\n+\t      update_stmt (gsi_stmt (gsi));\n+\t      if (dump_file && (dump_flags & TDF_DETAILS))\n+\t\t{\n+\t\t  fprintf (dump_file, \"Folded FMA negation \");\n+\t\t  print_gimple_stmt (dump_file, gsi_stmt (gsi), 0, TDF_NONE);\n+\t\t  fprintf (dump_file, \"\\n\");\n+\t\t}\n+\t    }\n+\t}\n+\n       widen_mul_stats.fmas_inserted++;\n     }\n }"}]}