{"sha": "056cf43428e87bff0703ab4a6ec3558a90328be4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDU2Y2Y0MzQyOGU4N2JmZjA3MDNhYjRhNmVjMzU1OGE5MDMyOGJlNA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2017-12-21T18:14:21Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2017-12-21T18:14:21Z"}, "message": "[-fcompare-debug] retain insn locations when turning dbr seq into return\n\nA number of -fcompare-debug errors on sparc arise as we split a dbr\nSEQUENCE back into separate insns to turn the branch into a return.\nIf we just take the location from the PREV_INSN, it might be a debug\ninsn without INSN_LOCATION, or an insn with an unrelated location.\nBut that's silly: each of the SEQUENCEd insns is still an insn with\nits own INSN_LOCATION, so use that instead, even though some may have\nbeen adjusted while constructing the SEQUENCE.\n\nfor  gcc/ChangeLog\n\n\t* reorg.c (make_return_insns): Reemit each insn with its own\n\tlocation.\n\nFrom-SVN: r255948", "tree": {"sha": "60034773156af884394ff38decf779dd751a8978", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/60034773156af884394ff38decf779dd751a8978"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/056cf43428e87bff0703ab4a6ec3558a90328be4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/056cf43428e87bff0703ab4a6ec3558a90328be4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/056cf43428e87bff0703ab4a6ec3558a90328be4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/056cf43428e87bff0703ab4a6ec3558a90328be4/comments", "author": null, "committer": null, "parents": [{"sha": "cb6332333854a698cbfc2ea4b1e52ce9bd59f664", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb6332333854a698cbfc2ea4b1e52ce9bd59f664", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb6332333854a698cbfc2ea4b1e52ce9bd59f664"}], "stats": {"total": 14, "additions": 12, "deletions": 2}, "files": [{"sha": "7200561a332072525c3815c426b773985044365b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/056cf43428e87bff0703ab4a6ec3558a90328be4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/056cf43428e87bff0703ab4a6ec3558a90328be4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=056cf43428e87bff0703ab4a6ec3558a90328be4", "patch": "@@ -1,3 +1,8 @@\n+2017-12-21  Alexandre Oliva <aoliva@redhat.com>\n+\n+\t* reorg.c (make_return_insns): Reemit each insn with its own\n+\tlocation.\n+\n 2017-12-21  Alexandre Oliva <aoliva@redhat.com>\n \n \tPR debug/83419"}, {"sha": "02d8adc61808ed1514b6481e3724d89adbc12123", "filename": "gcc/reorg.c", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/056cf43428e87bff0703ab4a6ec3558a90328be4/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/056cf43428e87bff0703ab4a6ec3558a90328be4/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=056cf43428e87bff0703ab4a6ec3558a90328be4", "patch": "@@ -3612,9 +3612,14 @@ make_return_insns (rtx_insn *first)\n \n \t  delete_related_insns (insn);\n \t  for (i = 1; i < XVECLEN (pat, 0); i++)\n-\t    prev = emit_insn_after (PATTERN (XVECEXP (pat, 0, i)), prev);\n+\t    {\n+\t      rtx_insn *in_seq_insn = as_a<rtx_insn *> (XVECEXP (pat, 0, i));\n+\t      prev = emit_insn_after_setloc (PATTERN (in_seq_insn), prev,\n+\t\t\t\t\t     INSN_LOCATION (in_seq_insn));\n+\t    }\n \n-\t  insn = emit_jump_insn_after (PATTERN (jump_insn), prev);\n+\t  insn = emit_jump_insn_after_setloc (PATTERN (jump_insn), prev,\n+\t\t\t\t\t      INSN_LOCATION (jump_insn));\n \t  emit_barrier_after (insn);\n \n \t  if (slots)"}]}