{"sha": "1ab71299a5bdb316006cb8e71197a3dd918cd4f2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWFiNzEyOTlhNWJkYjMxNjAwNmNiOGU3MTE5N2EzZGQ5MThjZDRmMg==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2010-03-23T13:24:37Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2010-03-23T13:24:37Z"}, "message": "Fix stdlib.h for mingw.\n\n2010-03-23  H.J. Lu  <hongjiu.lu@intel.com>\n\n\tPR target/40722\n\t* mkfixinc.sh: Fix stdlib.h for mingw.\n\nFrom-SVN: r157665", "tree": {"sha": "b2d717bef449c98c9cad7f0fd90fca37354d3ab2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b2d717bef449c98c9cad7f0fd90fca37354d3ab2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1ab71299a5bdb316006cb8e71197a3dd918cd4f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ab71299a5bdb316006cb8e71197a3dd918cd4f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ab71299a5bdb316006cb8e71197a3dd918cd4f2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ab71299a5bdb316006cb8e71197a3dd918cd4f2/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6644642ef7b7b58c39b6fc1184d6c873badbc285", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6644642ef7b7b58c39b6fc1184d6c873badbc285", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6644642ef7b7b58c39b6fc1184d6c873badbc285"}], "stats": {"total": 52, "additions": 50, "deletions": 2}, "files": [{"sha": "513cfdd1ae4e7da7ec38cc7819383259c33867b2", "filename": "fixincludes/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ab71299a5bdb316006cb8e71197a3dd918cd4f2/fixincludes%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ab71299a5bdb316006cb8e71197a3dd918cd4f2/fixincludes%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2FChangeLog?ref=1ab71299a5bdb316006cb8e71197a3dd918cd4f2", "patch": "@@ -1,3 +1,8 @@\n+2010-03-23  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR target/40722\n+\t* mkfixinc.sh: Fix stdlib.h for mingw.\n+\n 2010-02-19  Bruce Korb  <bkorb@gnu.org>\n \n \t* inclhack.def: remove vestiges of inadvertently committed changes"}, {"sha": "c353d89be50c945f8c1c83b317446729ad6fc0ee", "filename": "fixincludes/mkfixinc.sh", "status": "modified", "additions": 45, "deletions": 2, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ab71299a5bdb316006cb8e71197a3dd918cd4f2/fixincludes%2Fmkfixinc.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ab71299a5bdb316006cb8e71197a3dd918cd4f2/fixincludes%2Fmkfixinc.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Fmkfixinc.sh?ref=1ab71299a5bdb316006cb8e71197a3dd918cd4f2", "patch": "@@ -15,8 +15,6 @@ case $machine in\n     i?86-moss-msdos* | \\\n     i?86-*-pe | \\\n     i?86-*-cygwin* | \\\n-    i?86-*-mingw32* | \\\n-    x86_64-*-mingw32* | \\\n     i?86-*-interix* | \\\n     *-*-vxworks* | \\\n     powerpc-*-eabisim* | \\\n@@ -29,6 +27,51 @@ case $machine in\n \t(echo \"#! /bin/sh\" ; echo \"exit 0\" ) > ${target}\n         ;;\n \n+    i?86-*-mingw32* | \\\n+    x86_64-*-mingw32*)\n+        # We only want to fix stdlib.h in mingw.\n+\t# FIXME: Is SED available on mingw? \n+\t(cat > ${target} << EOF\n+#! /bin/sh\n+\n+OUTPUT_DIR=\\$1\n+if [ \"x\\$OUTPUT_DIR\" = \"x\" ]; then\n+  echo fixincludes: no output directory specified\n+  exit 1\n+fi\n+\n+if [ ! -d \\$OUTPUT_DIR ]; then\n+  echo fixincludes: output dir \\\"\\$OUTPUT_DIR\\\" is an invalid directory\n+  exit 1\n+fi\n+\n+INPUT_DIR=\\$2\n+if [ \"x\\$INPUT_DIR\" = \"x\" ]; then\n+  echo fixincludes: no input directory specified\n+  exit 1\n+fi\n+\n+if [ ! -d \\$INPUT_DIR ]; then\n+  echo fixincludes: input dir \\\"\\$INPUT_DIR\\\" is an invalid directory\n+  exit 1\n+fi\n+\n+INPUT_STDLIB_H=\\$INPUT_DIR/stdlib.h\n+if [ ! -f \\$INPUT_STDLIB_H ]; then\n+  echo fixincludes: \\\"stdlib.h\\\" is an invalid file\n+  exit 1\n+fi\n+\n+OUTPUT_STDLIB_H=\\$OUTPUT_DIR/stdlib.h\n+sed -e \"s/\\(.*_rotl.*\\)/#if __GNUC__ < 4 || (__GNUC__ == 4 \\&\\& __GNUC_MINOR__ < 5)\\n\\1/\" \\\n+    -e \"s/\\(.*_lrotr.*\\)/\\1\\n#else\\n\\#include <x86intrin.h>\\n#endif/\" \\\n+   \\$INPUT_STDLIB_H > \\$OUTPUT_STDLIB_H\n+\n+exit 0\n+EOF\n+)\n+        ;;\n+\n     *)\n \tcat < ${srcdir}/fixinc.in > ${target} || exit 1\n \t;;"}]}