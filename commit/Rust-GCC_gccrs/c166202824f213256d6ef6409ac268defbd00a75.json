{"sha": "c166202824f213256d6ef6409ac268defbd00a75", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzE2NjIwMjgyNGYyMTMyNTZkNmVmNjQwOWFjMjY4ZGVmYmQwMGE3NQ==", "commit": {"author": {"name": "Bin Cheng", "email": "bin.cheng@arm.com", "date": "2017-05-02T16:03:49Z"}, "committer": {"name": "Bin Cheng", "email": "amker@gcc.gnu.org", "date": "2017-05-02T16:03:49Z"}, "message": "tree-ssa-loop-ivopts.c (get_computation_cost_at): Remove pseudo iv_cand code.\n\n\t* tree-ssa-loop-ivopts.c (get_computation_cost_at): Remove pseudo\n\tiv_cand code.\n\t(determine_group_iv_cost_cond, determine_iv_cost): Ditto.\n\t(iv_ca_set_no_cp, create_new_iv): Ditto.\n\nFrom-SVN: r247510", "tree": {"sha": "563371c471ffbc57845742b26f4a82de09edfd2c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/563371c471ffbc57845742b26f4a82de09edfd2c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c166202824f213256d6ef6409ac268defbd00a75", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c166202824f213256d6ef6409ac268defbd00a75", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c166202824f213256d6ef6409ac268defbd00a75", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c166202824f213256d6ef6409ac268defbd00a75/comments", "author": null, "committer": null, "parents": [{"sha": "53685896151d0ec0685ad73ab447c16cf5fd7f03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53685896151d0ec0685ad73ab447c16cf5fd7f03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53685896151d0ec0685ad73ab447c16cf5fd7f03"}], "stats": {"total": 30, "additions": 11, "deletions": 19}, "files": [{"sha": "6f80ac0f187f19bcac56de8d03a58946199e5a0c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c166202824f213256d6ef6409ac268defbd00a75/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c166202824f213256d6ef6409ac268defbd00a75/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c166202824f213256d6ef6409ac268defbd00a75", "patch": "@@ -1,3 +1,10 @@\n+2017-05-02  Bin Cheng  <bin.cheng@arm.com>\n+\n+\t* tree-ssa-loop-ivopts.c (get_computation_cost_at): Remove pseudo\n+\tiv_cand code.\n+\t(determine_group_iv_cost_cond, determine_iv_cost): Ditto.\n+\t(iv_ca_set_no_cp, create_new_iv): Ditto.\n+\n 2017-05-02  Bin Cheng  <bin.cheng@arm.com>\n \n \t* rtlanal.c (rtx_cost): Handle TRUNCATE between tieable modes."}, {"sha": "93128491059f649bf34fe32524fbc2bbcefb1a19", "filename": "gcc/tree-ssa-loop-ivopts.c", "status": "modified", "additions": 4, "deletions": 19, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c166202824f213256d6ef6409ac268defbd00a75/gcc%2Ftree-ssa-loop-ivopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c166202824f213256d6ef6409ac268defbd00a75/gcc%2Ftree-ssa-loop-ivopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivopts.c?ref=c166202824f213256d6ef6409ac268defbd00a75", "patch": "@@ -4845,10 +4845,6 @@ get_computation_cost_at (struct ivopts_data *data,\n   if (depends_on)\n     *depends_on = NULL;\n \n-  /* Only consider real candidates.  */\n-  if (!cand->iv)\n-    return infinite_cost;\n-\n   cbase = cand->iv->base;\n   cstep = cand->iv->step;\n   ctype = TREE_TYPE (cbase);\n@@ -5568,8 +5564,6 @@ determine_group_iv_cost_cond (struct ivopts_data *data,\n   enum tree_code comp = ERROR_MARK;\n   struct iv_use *use = group->vuses[0];\n \n-  gcc_assert (cand->iv);\n-\n   /* Try iv elimination.  */\n   if (may_eliminate_iv (data, use, cand, &bound, &comp))\n     {\n@@ -5898,11 +5892,7 @@ determine_iv_cost (struct ivopts_data *data, struct iv_cand *cand)\n   unsigned cost, cost_step;\n   tree base;\n \n-  if (!cand->iv)\n-    {\n-      cand->cost = 0;\n-      return;\n-    }\n+  gcc_assert (cand->iv != NULL);\n \n   /* There are two costs associated with the candidate -- its increment\n      and its initialization.  The second is almost negligible for any loop\n@@ -6123,9 +6113,7 @@ iv_ca_set_no_cp (struct ivopts_data *data, struct iv_ca *ivs,\n   if (ivs->n_cand_uses[cid] == 0)\n     {\n       bitmap_clear_bit (ivs->cands, cid);\n-      /* Do not count the pseudocandidates.  */\n-      if (cp->cand->iv)\n-\tivs->n_regs--;\n+      ivs->n_regs--;\n       ivs->n_cands--;\n       ivs->cand_cost -= cp->cand->cost;\n \n@@ -6189,9 +6177,7 @@ iv_ca_set_cp (struct ivopts_data *data, struct iv_ca *ivs,\n       if (ivs->n_cand_uses[cid] == 1)\n \t{\n \t  bitmap_set_bit (ivs->cands, cid);\n-\t  /* Do not count the pseudocandidates.  */\n-\t  if (cp->cand->iv)\n-\t    ivs->n_regs++;\n+\t  ivs->n_regs++;\n \t  ivs->n_cands++;\n \t  ivs->cand_cost += cp->cand->cost;\n \n@@ -7076,8 +7062,7 @@ create_new_iv (struct ivopts_data *data, struct iv_cand *cand)\n   struct iv_group *group;\n   bool after = false;\n \n-  if (!cand->iv)\n-    return;\n+  gcc_assert (cand->iv != NULL);\n \n   switch (cand->pos)\n     {"}]}