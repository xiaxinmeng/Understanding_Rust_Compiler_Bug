{"sha": "6f9071656286512360ca22b6668c9c8d823ec907", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmY5MDcxNjU2Mjg2NTEyMzYwY2EyMmI2NjY4YzljOGQ4MjNlYzkwNw==", "commit": {"author": {"name": "Alan Lawrence", "email": "alan.lawrence@arm.com", "date": "2015-10-27T12:36:55Z"}, "committer": {"name": "Alan Lawrence", "email": "alalaw01@gcc.gnu.org", "date": "2015-10-27T12:36:55Z"}, "message": "tree-scalar-evolution.c: Handle LSHIFT by constant\n\ngcc/:\n\n\ttree-scalar-evolution.c (interpret_rhs_expr): Handle some LSHIFT_EXPRs\n\tas equivalent MULT_EXPRs.\n\ngcc/testsuite/:\n\n\tgcc.dg/vect/vect-strided-shift.c: New.\n\nFrom-SVN: r229437", "tree": {"sha": "e86f482365a51e41752e05345ed006755044537f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e86f482365a51e41752e05345ed006755044537f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6f9071656286512360ca22b6668c9c8d823ec907", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f9071656286512360ca22b6668c9c8d823ec907", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f9071656286512360ca22b6668c9c8d823ec907", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f9071656286512360ca22b6668c9c8d823ec907/comments", "author": null, "committer": null, "parents": [{"sha": "85f5231d73ab398af64c03e4121ab16c6c172cf6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85f5231d73ab398af64c03e4121ab16c6c172cf6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85f5231d73ab398af64c03e4121ab16c6c172cf6"}], "stats": {"total": 57, "additions": 57, "deletions": 0}, "files": [{"sha": "9bee00f56d30d993ae91269dddf54772b3c4f7ab", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6f9071656286512360ca22b6668c9c8d823ec907", "patch": "@@ -1,3 +1,9 @@\n+2015-10-27  Alan Lawrence  <alan.lawrence@arm.com>\n+\n+\tPR tree-optimization/65963\n+\t* tree-scalar-evolution.c (interpret_rhs_expr): Handle some LSHIFT_EXPRs\n+\tas equivalent MULT_EXPRs.\n+\n 2015-10-27  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \tPR target/67929"}, {"sha": "e693063b4ad62cec7abcfcf7633003488f4acdd7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6f9071656286512360ca22b6668c9c8d823ec907", "patch": "@@ -1,3 +1,7 @@\n+2015-10-27  Alan Lawrence  <alan.lawrence@arm.com>\n+\n+\t* gcc.dg/vect/vect-strided-shift-1.c: New.\n+\n 2015-10-27  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \tPR target/67929"}, {"sha": "b1ce2ece1707ef23d4aa81b715f8ac7dfcbeafe6", "filename": "gcc/testsuite/gcc.dg/vect/vect-strided-shift-1.c", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect-strided-shift-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect-strided-shift-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect-strided-shift-1.c?ref=6f9071656286512360ca22b6668c9c8d823ec907", "patch": "@@ -0,0 +1,33 @@\n+/* PR tree-optimization/65963.  */\n+#include \"tree-vect.h\"\n+\n+#define N 512\n+\n+int in[2*N], out[N];\n+\n+__attribute__ ((noinline)) void\n+loop (void)\n+{\n+  for (int i = 0; i < N; i++)\n+    out[i] = in[i << 1] + 7;\n+}\n+\n+int\n+main (int argc, char **argv)\n+{\n+  check_vect ();\n+  for (int i = 0; i < 2*N; i++)\n+    {\n+      in[i] = i;\n+      __asm__ volatile (\"\" : : : \"memory\");\n+    }\n+  loop ();\n+  __asm__ volatile (\"\" : : : \"memory\");\n+  for (int i = 0; i < N; i++)\n+    {\n+      if (out[i] != i*2 + 7)\n+\tabort ();\n+    }\n+  return 0;\n+}\n+/* { dg-final { scan-tree-dump-times \"vectorized 1 loops in function\" 1 \"vect\" { target { vect_strided2 } } } } */"}, {"sha": "8e95ddd2d6abc353685c955261ae347db708d93d", "filename": "gcc/tree-scalar-evolution.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2Ftree-scalar-evolution.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6f9071656286512360ca22b6668c9c8d823ec907/gcc%2Ftree-scalar-evolution.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-scalar-evolution.c?ref=6f9071656286512360ca22b6668c9c8d823ec907", "patch": "@@ -1840,6 +1840,20 @@ interpret_rhs_expr (struct loop *loop, gimple *at_stmt,\n       res = chrec_fold_multiply (type, chrec1, chrec2);\n       break;\n \n+    case LSHIFT_EXPR:\n+      /* Handle A<<B as A * (1<<B).  */\n+      chrec1 = analyze_scalar_evolution (loop, rhs1);\n+      chrec2 = analyze_scalar_evolution (loop, rhs2);\n+      chrec1 = chrec_convert (type, chrec1, at_stmt);\n+      chrec1 = instantiate_parameters (loop, chrec1);\n+      chrec2 = instantiate_parameters (loop, chrec2);\n+\n+      chrec2 = fold_build2 (LSHIFT_EXPR, type,\n+\t\t\t    build_int_cst (TREE_TYPE (rhs1), 1),\n+\t\t\t    chrec2);\n+      res = chrec_fold_multiply (type, chrec1, chrec2);\n+      break;\n+\n     CASE_CONVERT:\n       /* In case we have a truncation of a widened operation that in\n          the truncated type has undefined overflow behavior analyze"}]}