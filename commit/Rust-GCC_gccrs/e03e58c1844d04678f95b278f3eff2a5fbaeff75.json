{"sha": "e03e58c1844d04678f95b278f3eff2a5fbaeff75", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTAzZTU4YzE4NDRkMDQ2NzhmOTViMjc4ZjNlZmYyYTVmYmFlZmY3NQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-02-23T10:14:03Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-02-23T10:15:16Z"}, "message": "Fix UBSAN in __ubsan::Value::getSIntValue\n\n/home/marxin/Programming/gcc2/libsanitizer/ubsan/ubsan_value.cpp:77:25: runtime error: left shift of 0x0000000000000000fffffffffffffffb by 96 places cannot be represented in type '__int128'\n    #0 0x7ffff754edfe in __ubsan::Value::getSIntValue() const /home/marxin/Programming/gcc2/libsanitizer/ubsan/ubsan_value.cpp:77\n    #1 0x7ffff7548719 in __ubsan::Value::isNegative() const /home/marxin/Programming/gcc2/libsanitizer/ubsan/ubsan_value.h:190\n    #2 0x7ffff7542a34 in handleShiftOutOfBoundsImpl /home/marxin/Programming/gcc2/libsanitizer/ubsan/ubsan_handlers.cpp:338\n    #3 0x7ffff75431b7 in __ubsan_handle_shift_out_of_bounds /home/marxin/Programming/gcc2/libsanitizer/ubsan/ubsan_handlers.cpp:370\n    #4 0x40067f in main (/home/marxin/Programming/testcases/a.out+0x40067f)\n    #5 0x7ffff72c8b24 in __libc_start_main (/lib64/libc.so.6+0x27b24)\n    #6 0x4005bd in _start (/home/marxin/Programming/testcases/a.out+0x4005bd)\n\nDifferential Revision: https://reviews.llvm.org/D97263\n\nCherry-pick from 16ede0956cb1f4b692dfa619ccfa6ab1de28e19b.", "tree": {"sha": "a9eb4582e40be970e6f5bbcd30191cc558244d65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a9eb4582e40be970e6f5bbcd30191cc558244d65"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e03e58c1844d04678f95b278f3eff2a5fbaeff75", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e03e58c1844d04678f95b278f3eff2a5fbaeff75", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e03e58c1844d04678f95b278f3eff2a5fbaeff75", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e03e58c1844d04678f95b278f3eff2a5fbaeff75/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "74af13c174714dd3b9f1ded4b39955f003c16361", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74af13c174714dd3b9f1ded4b39955f003c16361", "html_url": "https://github.com/Rust-GCC/gccrs/commit/74af13c174714dd3b9f1ded4b39955f003c16361"}], "stats": {"total": 2, "additions": 1, "deletions": 1}, "files": [{"sha": "40042bf3a9030b20e9661f9585f4ec7bf32021ae", "filename": "libsanitizer/ubsan/ubsan_value.cpp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e03e58c1844d04678f95b278f3eff2a5fbaeff75/libsanitizer%2Fubsan%2Fubsan_value.cpp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e03e58c1844d04678f95b278f3eff2a5fbaeff75/libsanitizer%2Fubsan%2Fubsan_value.cpp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libsanitizer%2Fubsan%2Fubsan_value.cpp?ref=e03e58c1844d04678f95b278f3eff2a5fbaeff75", "patch": "@@ -74,7 +74,7 @@ SIntMax Value::getSIntValue() const {\n     // to SIntMax.\n     const unsigned ExtraBits =\n       sizeof(SIntMax) * 8 - getType().getIntegerBitWidth();\n-    return SIntMax(Val) << ExtraBits >> ExtraBits;\n+    return SIntMax(UIntMax(Val) << ExtraBits) >> ExtraBits;\n   }\n   if (getType().getIntegerBitWidth() == 64)\n     return *reinterpret_cast<s64*>(Val);"}]}