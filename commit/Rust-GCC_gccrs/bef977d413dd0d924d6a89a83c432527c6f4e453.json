{"sha": "bef977d413dd0d924d6a89a83c432527c6f4e453", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmVmOTc3ZDQxM2RkMGQ5MjRkNmE4OWE4M2M0MzI1MjdjNmY0ZTQ1Mw==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2016-03-29T14:39:33Z"}, "committer": {"name": "Thomas Schwinge", "email": "tschwinge@gcc.gnu.org", "date": "2016-03-29T14:39:33Z"}, "message": "[PR testsuite/64177] Audit Cilk Plus tests for CILK_NWORKERS=1\n\n\tPR testsuite/64177\n\tgcc/testsuite/\n\t* c-c++-common/cilk-plus/CK/spawning_arg.c (main): Call\n\t__cilkrts_set_param to set two workers.\n\t* c-c++-common/cilk-plus/CK/steal_check.c (main): Likewise.\n\t* g++.dg/cilk-plus/CK/catch_exc.cc (main): Likewise.\n\nFrom-SVN: r234523", "tree": {"sha": "26ecbf3652b5ce5d25f0268a410a01b19312e610", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26ecbf3652b5ce5d25f0268a410a01b19312e610"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bef977d413dd0d924d6a89a83c432527c6f4e453", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bef977d413dd0d924d6a89a83c432527c6f4e453", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bef977d413dd0d924d6a89a83c432527c6f4e453", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bef977d413dd0d924d6a89a83c432527c6f4e453/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ce83104bd8ce698a0a544f0eb9818a91b341ca5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce83104bd8ce698a0a544f0eb9818a91b341ca5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce83104bd8ce698a0a544f0eb9818a91b341ca5a"}], "stats": {"total": 54, "additions": 51, "deletions": 3}, "files": [{"sha": "f9b4b001c791b77f66164393668d39aa948e8377", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bef977d413dd0d924d6a89a83c432527c6f4e453", "patch": "@@ -1,3 +1,11 @@\n+2016-03-29  Thomas Schwinge  <thomas@codesourcery.com>\n+\n+\tPR testsuite/64177\n+\t* c-c++-common/cilk-plus/CK/spawning_arg.c (main): Call\n+\t__cilkrts_set_param to set two workers.\n+\t* c-c++-common/cilk-plus/CK/steal_check.c (main): Likewise.\n+\t* g++.dg/cilk-plus/CK/catch_exc.cc (main): Likewise.\n+\n 2016-03-28  Dominique d'Humieres  <dominiq@lps.ens.fr>\n \n \tg++.dg/ext/fnname5.C: Update the test for Darwin."}, {"sha": "138b82c187cfae03ed1a617ed39512e40c21b697", "filename": "gcc/testsuite/c-c++-common/cilk-plus/CK/spawning_arg.c", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fspawning_arg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fspawning_arg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fspawning_arg.c?ref=bef977d413dd0d924d6a89a83c432527c6f4e453", "patch": "@@ -2,6 +2,17 @@\n /* { dg-options \"-fcilkplus\" } */\n /* { dg-additional-options \"-lcilkrts\" { target { i?86-*-* x86_64-*-* } } } */\n \n+#ifdef __cplusplus\n+extern \"C\" {\n+#endif\n+\n+extern int __cilkrts_set_param (const char *, const char *);\n+\n+#ifdef __cplusplus\n+}\n+#endif\n+\n+\n void f0(volatile int *steal_flag)\n { \n   int i = 0;\n@@ -32,6 +43,10 @@ void f3()\n \n int main()\n {\n+  /* Ensure more than one worker.  */\n+  if (__cilkrts_set_param(\"nworkers\", \"2\") != 0)\n+    __builtin_abort();\n+\n   f3();\n   return 0;\n }"}, {"sha": "6b41c7faf041485000dbcb10c7dbcd1ebe7f891c", "filename": "gcc/testsuite/c-c++-common/cilk-plus/CK/steal_check.c", "status": "modified", "additions": 14, "deletions": 3, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fsteal_check.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fsteal_check.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fcilk-plus%2FCK%2Fsteal_check.c?ref=bef977d413dd0d924d6a89a83c432527c6f4e453", "patch": "@@ -2,16 +2,27 @@\n /* { dg-options \"-fcilkplus\" } */\n /* { dg-additional-options \"-lcilkrts\" { target { i?86-*-* x86_64-*-* } } } */\n \n-// #include <cilk/cilk_api.h>\n-extern void __cilkrts_set_param (char *, char *);\n+#ifdef __cplusplus\n+extern \"C\" {\n+#endif\n+\n+extern int __cilkrts_set_param (const char *, const char *);\n+\n+#ifdef __cplusplus\n+}\n+#endif\n+\n \n void foo(volatile int *);\n \n void main2(void);\n \n int main(void)\n {\n- //  __cilkrts_set_param ((char *)\"nworkers\", (char *)\"2\");\n+  /* Ensure more than one worker.  */\n+  if (__cilkrts_set_param(\"nworkers\", \"2\") != 0)\n+    __builtin_abort();\n+\n   main2();\n   return 0;\n }"}, {"sha": "09ddf8b28e3242410ba642ff1031065563023549", "filename": "gcc/testsuite/g++.dg/cilk-plus/CK/catch_exc.cc", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2FCK%2Fcatch_exc.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bef977d413dd0d924d6a89a83c432527c6f4e453/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2FCK%2Fcatch_exc.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcilk-plus%2FCK%2Fcatch_exc.cc?ref=bef977d413dd0d924d6a89a83c432527c6f4e453", "patch": "@@ -10,6 +10,16 @@\n #endif\n #include <cstdlib>\n \n+#ifdef __cplusplus\n+extern \"C\" {\n+#endif\n+\n+extern int __cilkrts_set_param (const char *, const char *);\n+\n+#ifdef __cplusplus\n+}\n+#endif\n+\n \n void func(int volatile* steal_me) \n {\n@@ -59,6 +69,10 @@ void my_test()\n \n int main() \n {\n+  /* Ensure more than one worker.  */\n+  if (__cilkrts_set_param(\"nworkers\", \"2\") != 0)\n+    __builtin_abort();\n+\n   my_test();\n #if HAVE_IO\n   printf(\"PASSED\\n\");"}]}