{"sha": "dbeee82924bc45e9990c2205e2768a52ffda5fbf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGJlZWU4MjkyNGJjNDVlOTk5MGMyMjA1ZTI3NjhhNTJmZmRhNWZiZg==", "commit": {"author": {"name": "David S. Miller", "email": "davem@davemloft.net", "date": "2011-10-30T07:48:05Z"}, "committer": {"name": "David S. Miller", "email": "davem@gcc.gnu.org", "date": "2011-10-30T07:48:05Z"}, "message": "Properly limit backwards label scanning in reorg.\n\n\t* reorg.c (label_before_next_insn): New function.\n\t(relax_delay_slots): Use it instead of prev_label.\n\t* rtl.h (prev_label): Delete declaration.\n\t* emit-rtl.c (prev_label): Remove.\n\nFrom-SVN: r180674", "tree": {"sha": "6927a78bf433978e525defc0a83618ff6bb2613a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6927a78bf433978e525defc0a83618ff6bb2613a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dbeee82924bc45e9990c2205e2768a52ffda5fbf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dbeee82924bc45e9990c2205e2768a52ffda5fbf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dbeee82924bc45e9990c2205e2768a52ffda5fbf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dbeee82924bc45e9990c2205e2768a52ffda5fbf/comments", "author": {"login": "davem330", "id": 1053866, "node_id": "MDQ6VXNlcjEwNTM4NjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1053866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davem330", "html_url": "https://github.com/davem330", "followers_url": "https://api.github.com/users/davem330/followers", "following_url": "https://api.github.com/users/davem330/following{/other_user}", "gists_url": "https://api.github.com/users/davem330/gists{/gist_id}", "starred_url": "https://api.github.com/users/davem330/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davem330/subscriptions", "organizations_url": "https://api.github.com/users/davem330/orgs", "repos_url": "https://api.github.com/users/davem330/repos", "events_url": "https://api.github.com/users/davem330/events{/privacy}", "received_events_url": "https://api.github.com/users/davem330/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cc1efdff706c78c874ab8ff65264004fdc8a7081", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc1efdff706c78c874ab8ff65264004fdc8a7081", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc1efdff706c78c874ab8ff65264004fdc8a7081"}], "stats": {"total": 40, "additions": 23, "deletions": 17}, "files": [{"sha": "e9bda2b793a7f51ad0f20df74e2a3897bc63d61f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=dbeee82924bc45e9990c2205e2768a52ffda5fbf", "patch": "@@ -1,3 +1,10 @@\n+2011-10-30  David S. Miller  <davem@davemloft.net>\n+\n+\t* reorg.c (label_before_next_insn): New function.\n+\t(relax_delay_slots): Use it instead of prev_label.\n+\t* rtl.h (prev_label): Delete declaration.\n+\t* emit-rtl.c (prev_label): Remove.\n+\n 2011-10-30  Revital Eres  <revital.eres@linaro.org>\n \n \t* modulo-sched.c (generate_prolog_epilog): Mark prolog and epilog"}, {"sha": "c2bc56b9758f7fb0104b9f0637e2bb8e1fc3fc4c", "filename": "gcc/emit-rtl.c", "status": "modified", "additions": 0, "deletions": 15, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2Femit-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2Femit-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.c?ref=dbeee82924bc45e9990c2205e2768a52ffda5fbf", "patch": "@@ -3330,21 +3330,6 @@ next_label (rtx insn)\n   return insn;\n }\n \n-/* Return the last CODE_LABEL before the insn INSN, or 0 if there is none.  */\n-\n-rtx\n-prev_label (rtx insn)\n-{\n-  while (insn)\n-    {\n-      insn = PREV_INSN (insn);\n-      if (insn == 0 || LABEL_P (insn))\n-\tbreak;\n-    }\n-\n-  return insn;\n-}\n-\n /* Return the last label to mark the same position as LABEL.  Return LABEL\n    itself if it is null or any return rtx.  */\n "}, {"sha": "40d73a76a7174a68536482218d33bf7b4e84a9b2", "filename": "gcc/reorg.c", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=dbeee82924bc45e9990c2205e2768a52ffda5fbf", "patch": "@@ -3349,6 +3349,21 @@ delete_jump (rtx insn)\n     delete_computation (insn);\n }\n \n+static rtx\n+label_before_next_insn (rtx x, rtx scan_limit)\n+{\n+  rtx insn = next_active_insn (x);\n+  while (insn)\n+    {\n+      insn = PREV_INSN (insn);\n+      if (insn == scan_limit || insn == NULL_RTX)\n+\treturn NULL_RTX;\n+      if (LABEL_P (insn))\n+\tbreak;\n+    }\n+  return insn;\n+}\n+\n \f\n /* Once we have tried two ways to fill a delay slot, make a pass over the\n    code to try to improve the results and to do such things as more jump\n@@ -3634,7 +3649,7 @@ relax_delay_slots (rtx first)\n \t identical to the one in its delay slot.  In this case, we can just\n \t delete the branch and the insn in its delay slot.  */\n       if (next && NONJUMP_INSN_P (next)\n-\t  && prev_label (next_active_insn (next)) == target_label\n+\t  && label_before_next_insn (next, insn) == target_label\n \t  && simplejump_p (insn)\n \t  && XVECLEN (pat, 0) == 2\n \t  && rtx_equal_p (PATTERN (next), PATTERN (XVECEXP (pat, 0, 1))))"}, {"sha": "41536bea02c073326feb48c468c5cec30a06dd00", "filename": "gcc/rtl.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2Frtl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbeee82924bc45e9990c2205e2768a52ffda5fbf/gcc%2Frtl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frtl.h?ref=dbeee82924bc45e9990c2205e2768a52ffda5fbf", "patch": "@@ -1812,7 +1812,6 @@ extern rtx next_real_insn (rtx);\n extern rtx prev_active_insn (rtx);\n extern rtx next_active_insn (rtx);\n extern int active_insn_p (const_rtx);\n-extern rtx prev_label (rtx);\n extern rtx next_label (rtx);\n extern rtx skip_consecutive_labels (rtx);\n extern rtx next_cc0_user (rtx);"}]}