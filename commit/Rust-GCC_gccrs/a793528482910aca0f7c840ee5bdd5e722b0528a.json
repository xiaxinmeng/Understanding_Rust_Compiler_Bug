{"sha": "a793528482910aca0f7c840ee5bdd5e722b0528a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTc5MzUyODQ4MjkxMGFjYTBmN2M4NDBlZTViZGQ1ZTcyMmIwNTI4YQ==", "commit": {"author": {"name": "Bingfeng Mei", "email": "bmei@broadcom.com", "date": "2014-07-31T08:50:50Z"}, "committer": {"name": "Bingfeng Mei", "email": "meibf@gcc.gnu.org", "date": "2014-07-31T08:50:50Z"}, "message": "re PR lto/61868 (-frandom-seed always results in random_seed of 0)\n\n2014-07-31  Bingfeng Mei <bmei@broadcom.com>\n\n\tPR lto/61868\n\t* toplev.c (init_random_seed): Move piece of code never called to\n\tset_random_seed.\n\t(set_random_seed): see above.\n\t\n\t* gcc.dg/pr61868.c: New test.\n\nFrom-SVN: r213321", "tree": {"sha": "54733b3b92816303feb98e0f57cab1c0f45bbda0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/54733b3b92816303feb98e0f57cab1c0f45bbda0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a793528482910aca0f7c840ee5bdd5e722b0528a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a793528482910aca0f7c840ee5bdd5e722b0528a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a793528482910aca0f7c840ee5bdd5e722b0528a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a793528482910aca0f7c840ee5bdd5e722b0528a/comments", "author": null, "committer": null, "parents": [{"sha": "3e455386cf84b081dcb00df4a27e2755cb504169", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e455386cf84b081dcb00df4a27e2755cb504169", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e455386cf84b081dcb00df4a27e2755cb504169"}], "stats": {"total": 41, "additions": 31, "deletions": 10}, "files": [{"sha": "0ee4580d0c4f90401a7d937270f6979a31bb5ed5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a793528482910aca0f7c840ee5bdd5e722b0528a", "patch": "@@ -1,3 +1,10 @@\n+2014-07-31  Bingfeng Mei <bmei@broadcom.com>\n+\n+\tPR lto/61868\n+\t* toplev.c (init_random_seed): Move piece of code never called to\n+\tset_random_seed.\n+\t(set_random_seed): see above.\n+\n 2014-07-31  Tom de Vries  <tom@codesourcery.com>\n \n \t* tree-ssa-loop.c (pass_tree_loop_init::execute): Remove dead code."}, {"sha": "82ec9efc71dd610e8d97adf2e6120163009215ad", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a793528482910aca0f7c840ee5bdd5e722b0528a", "patch": "@@ -1,3 +1,8 @@\n+2014-07-31  Bingfeng Mei  <bmei@broadcom.com>\n+\n+\tPR lto/61868\n+\t* gcc.dg/pr61868.c: New test.\n+\n 2014-07-30  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/57397"}, {"sha": "a2872a9ec79cd586cdcce04078c2bacae111a3ec", "filename": "gcc/testsuite/gcc.dg/pr61868.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr61868.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2Ftestsuite%2Fgcc.dg%2Fpr61868.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr61868.c?ref=a793528482910aca0f7c840ee5bdd5e722b0528a", "patch": "@@ -0,0 +1,9 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-flto -frandom-seed=0x12345\" }  */\n+extern int foo (int);\n+int main ()\n+{\n+  foo (100);\n+  return 0;\n+}\n+/* { dg-final { scan-assembler \"\\.gnu\\.lto.*.12345\" } } */"}, {"sha": "98ea05880135f993f79b5ca335ca428b7ac00089", "filename": "gcc/toplev.c", "status": "modified", "additions": 10, "deletions": 10, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a793528482910aca0f7c840ee5bdd5e722b0528a/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=a793528482910aca0f7c840ee5bdd5e722b0528a", "patch": "@@ -282,16 +282,7 @@ init_local_tick (void)\n static void\n init_random_seed (void)\n {\n-  if (flag_random_seed)\n-    {\n-      char *endp;\n-\n-      /* When the driver passed in a hex number don't crc it again */\n-      random_seed = strtoul (flag_random_seed, &endp, 0);\n-      if (!(endp > flag_random_seed && *endp == 0))\n-        random_seed = crc32_string (0, flag_random_seed);\n-    }\n-  else if (!random_seed)\n+  if (!random_seed)\n     random_seed = local_tick ^ getpid ();  /* Old racey fallback method */\n }\n \n@@ -314,6 +305,15 @@ set_random_seed (const char *val)\n {\n   const char *old = flag_random_seed;\n   flag_random_seed = val;\n+  if (flag_random_seed)\n+    {\n+      char *endp;\n+\n+      /* When the driver passed in a hex number don't crc it again */\n+      random_seed = strtoul (flag_random_seed, &endp, 0);\n+      if (!(endp > flag_random_seed && *endp == 0))\n+        random_seed = crc32_string (0, flag_random_seed);\n+    }\n   return old;\n }\n "}]}