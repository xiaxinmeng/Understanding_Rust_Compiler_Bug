{"sha": "f76d0d86454baf99ada0748c73a29816854e1b91", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjc2ZDBkODY0NTRiYWY5OWFkYTA3NDhjNzNhMjk4MTY4NTRlMWI5MQ==", "commit": {"author": {"name": "Xing GUO", "email": "higuoxing@gmail.com", "date": "2021-01-28T03:22:40Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2021-01-28T03:25:50Z"}, "message": "RISC-V: Fix -march option parsing when  extension exists.\n\nThis patch fixes -march option parsing when `p` extension exists,\ne.g., -march=rv64imafdcp should produce\n\n.attribute arch, \"rv64i2p0_m2p0_a2p0_f2p0_d2p0_c2p0_p\"\n\nrather than\n\n.attribute arch, \"rv64i2p0_m2p0_a2p0_f2p0_d2p0_c_p\"\n\ngcc/ChangeLog:\n\n\t* common/config/riscv/riscv-common.c\n\t(riscv_subset_list::parsing_subset_version): Fix -march option parsing\n\twhen `p` extension exists.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.target/riscv/attribute-18.c: New test.", "tree": {"sha": "775eb7c49464a5046fbcf3c71f73c1646835dcfc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/775eb7c49464a5046fbcf3c71f73c1646835dcfc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f76d0d86454baf99ada0748c73a29816854e1b91", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f76d0d86454baf99ada0748c73a29816854e1b91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f76d0d86454baf99ada0748c73a29816854e1b91", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f76d0d86454baf99ada0748c73a29816854e1b91/comments", "author": {"login": "higuoxing", "id": 21099318, "node_id": "MDQ6VXNlcjIxMDk5MzE4", "avatar_url": "https://avatars.githubusercontent.com/u/21099318?v=4", "gravatar_id": "", "url": "https://api.github.com/users/higuoxing", "html_url": "https://github.com/higuoxing", "followers_url": "https://api.github.com/users/higuoxing/followers", "following_url": "https://api.github.com/users/higuoxing/following{/other_user}", "gists_url": "https://api.github.com/users/higuoxing/gists{/gist_id}", "starred_url": "https://api.github.com/users/higuoxing/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/higuoxing/subscriptions", "organizations_url": "https://api.github.com/users/higuoxing/orgs", "repos_url": "https://api.github.com/users/higuoxing/repos", "events_url": "https://api.github.com/users/higuoxing/events{/privacy}", "received_events_url": "https://api.github.com/users/higuoxing/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "aa69f0a8203095b5a689fae48d5ca8006ecfca61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa69f0a8203095b5a689fae48d5ca8006ecfca61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa69f0a8203095b5a689fae48d5ca8006ecfca61"}], "stats": {"total": 8, "additions": 5, "deletions": 3}, "files": [{"sha": "6bbe25dba89074e691ae9e17a755314e5b462c6c", "filename": "gcc/common/config/riscv/riscv-common.c", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f76d0d86454baf99ada0748c73a29816854e1b91/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f76d0d86454baf99ada0748c73a29816854e1b91/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.c?ref=f76d0d86454baf99ada0748c73a29816854e1b91", "patch": "@@ -527,9 +527,7 @@ riscv_subset_list::parsing_subset_version (const char *ext,\n \t      /* Might be beginning of `p` extension.  */\n \t      if (std_ext_p)\n \t\t{\n-\t\t  *major_version = version;\n-\t\t  *minor_version = 0;\n-\t\t  *explicit_version_p = true;\n+\t\t  get_default_version (ext, major_version, minor_version);\n \t\t  return p;\n \t\t}\n \t      else"}, {"sha": "1fd80fed51b2ddeebcd9b85d2302f300a73572bb", "filename": "gcc/testsuite/gcc.target/riscv/attribute-18.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f76d0d86454baf99ada0748c73a29816854e1b91/gcc%2Ftestsuite%2Fgcc.target%2Friscv%2Fattribute-18.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f76d0d86454baf99ada0748c73a29816854e1b91/gcc%2Ftestsuite%2Fgcc.target%2Friscv%2Fattribute-18.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Friscv%2Fattribute-18.c?ref=f76d0d86454baf99ada0748c73a29816854e1b91", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-march=rv64imafdcp -mabi=lp64d -misa-spec=2.2\" } */\n+int foo() {}\n+/* { dg-final { scan-assembler \".attribute arch, \\\"rv64i2p0_m2p0_a2p0_f2p0_d2p0_c2p0_p\\\"\" } } */"}]}