{"sha": "5da250fca2d707547044284a84e94beb0c74bb5a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWRhMjUwZmNhMmQ3MDc1NDcwNDQyODRhODRlOTRiZWIwYzc0YmI1YQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2008-04-03T21:02:44Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-04-03T21:02:44Z"}, "message": "re PR middle-end/35818 (ICE on incomplete array in shared clause)\n\n\tPR middle-end/35818\n\t* omp-low.c (scan_sharing_clauses) <case OMP_CLAUSE_SHARED>: Don't\n\tcall is_variable_sized if decl has incomplete type.\n\n\t* gcc.dg/gomp/pr35818.c: New test.\n\nFrom-SVN: r133875", "tree": {"sha": "7337ce1fc06ad5e8ff8f9584479ecb8e19b23807", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7337ce1fc06ad5e8ff8f9584479ecb8e19b23807"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5da250fca2d707547044284a84e94beb0c74bb5a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5da250fca2d707547044284a84e94beb0c74bb5a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5da250fca2d707547044284a84e94beb0c74bb5a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5da250fca2d707547044284a84e94beb0c74bb5a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "637b5a8e7ced71facbb36d9505b85ad3b991572b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/637b5a8e7ced71facbb36d9505b85ad3b991572b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/637b5a8e7ced71facbb36d9505b85ad3b991572b"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "29a3cce9711d0519707c08ca6a9ff08b0411fa35", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5da250fca2d707547044284a84e94beb0c74bb5a", "patch": "@@ -1,3 +1,9 @@\n+2008-04-03  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/35818\n+\t* omp-low.c (scan_sharing_clauses) <case OMP_CLAUSE_SHARED>: Don't\n+\tcall is_variable_sized if decl has incomplete type.\n+\n 2008-04-03  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* config/i386/i386-protos.h (ix86_aligned_p): Removed."}, {"sha": "ffdf447d32926e9db01716ed387c046878122814", "filename": "gcc/omp-low.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2Fomp-low.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2Fomp-low.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-low.c?ref=5da250fca2d707547044284a84e94beb0c74bb5a", "patch": "@@ -993,7 +993,8 @@ scan_sharing_clauses (tree clauses, omp_context *ctx)\n \tcase OMP_CLAUSE_SHARED:\n \t  gcc_assert (is_parallel_ctx (ctx));\n \t  decl = OMP_CLAUSE_DECL (c);\n-\t  gcc_assert (!is_variable_sized (decl));\n+\t  gcc_assert (!COMPLETE_TYPE_P (TREE_TYPE (decl))\n+\t\t      || !is_variable_sized (decl));\n \t  by_ref = use_pointer_for_field (decl, ctx);\n \t  /* Global variables don't need to be copied,\n \t     the receiver side will use them directly.  */"}, {"sha": "1bad997c7fa9dac5ec177eee8db34faeae6095b2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5da250fca2d707547044284a84e94beb0c74bb5a", "patch": "@@ -1,5 +1,8 @@\n 2008-04-03  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR middle-end/35818\n+\t* gcc.dg/gomp/pr35818.c: New test.\n+\n \tPR fortran/35786\n \t* gfortran.dg/gomp/pr35786-1.f90: New test.\n \t* gfortran.dg/gomp/pr35786-2.f90: New test."}, {"sha": "b2165eb3973d0e31134b4814d2a029aca7852791", "filename": "gcc/testsuite/gcc.dg/gomp/pr35818.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr35818.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5da250fca2d707547044284a84e94beb0c74bb5a/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr35818.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr35818.c?ref=5da250fca2d707547044284a84e94beb0c74bb5a", "patch": "@@ -0,0 +1,16 @@\n+/* PR middle-end/35818 */\n+/* { dg-do compile } */\n+/* { dg-options \"-fopenmp\" } */\n+\n+extern int a[];\n+\n+void\n+foo (void)\n+{\n+#pragma omp parallel\n+#pragma omp master\n+  a[3] = 1;\n+#pragma omp parallel shared(a)\n+#pragma omp master\n+  a[3] = 1;\n+}"}]}