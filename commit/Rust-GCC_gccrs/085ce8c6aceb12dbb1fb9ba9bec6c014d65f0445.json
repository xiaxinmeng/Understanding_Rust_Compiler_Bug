{"sha": "085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDg1Y2U4YzZhY2ViMTJkYmIxZmI5YmE5YmVjNmMwMTRkNjVmMDQ0NQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@cygnus.com", "date": "2000-05-16T06:11:56Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2000-05-16T06:11:56Z"}, "message": "varasm.c (output_constant_pool): Abort instead of converting (improperly) deleted labels to zero.\n\n        * varasm.c (output_constant_pool): Abort instead of converting\n        (improperly) deleted labels to zero.\n\nFrom-SVN: r33922", "tree": {"sha": "de09b5f8efd045b0d0ca86225f7e8db1db084b94", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/de09b5f8efd045b0d0ca86225f7e8db1db084b94"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445", "html_url": "https://github.com/Rust-GCC/gccrs/commit/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445/comments", "author": null, "committer": null, "parents": [{"sha": "02a18962ab86a9a9eab7220cd779acc33fadf94e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02a18962ab86a9a9eab7220cd779acc33fadf94e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02a18962ab86a9a9eab7220cd779acc33fadf94e"}], "stats": {"total": 43, "additions": 35, "deletions": 8}, "files": [{"sha": "dd6ecb3206015dfd43f88464dd28570935ea3315", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445", "patch": "@@ -1,3 +1,8 @@\n+2000-05-15  Richard Henderson  <rth@cygnus.com>\n+\n+\t* varasm.c (output_constant_pool): Abort instead of converting\n+\t(improperly) deleted labels to zero.\n+\n 2000-05-16  Neil Booth  <NeilB@earthling.net>\n \n \t* cpplex.c (parse_string2): Update comment."}, {"sha": "b92bf3c8156a92b12705343437f48745348ae42d", "filename": "gcc/varasm.c", "status": "modified", "additions": 30, "deletions": 8, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=085ce8c6aceb12dbb1fb9ba9bec6c014d65f0445", "patch": "@@ -3781,6 +3781,8 @@ output_constant_pool (fnname, fndecl)\n \n   for (pool = first_pool; pool; pool = pool->next)\n     {\n+      rtx tmp;\n+\n       x = pool->constant;\n \n       if (! pool->mark)\n@@ -3791,14 +3793,34 @@ output_constant_pool (fnname, fndecl)\n \t is eliminated by optimization.  If so, write a constant of zero\n \t instead.  Note that this can also happen by turning the\n \t CODE_LABEL into a NOTE.  */\n-      if (((GET_CODE (x) == LABEL_REF\n-\t    && (INSN_DELETED_P (XEXP (x, 0))\n-\t\t|| GET_CODE (XEXP (x, 0)) == NOTE)))\n-\t  || (GET_CODE (x) == CONST && GET_CODE (XEXP (x, 0)) == PLUS\n-\t      && GET_CODE (XEXP (XEXP (x, 0), 0)) == LABEL_REF\n-\t      && (INSN_DELETED_P (XEXP (XEXP (XEXP (x, 0), 0), 0))\n-\t\t  || GET_CODE (XEXP (XEXP (XEXP (x, 0), 0), 0)) == NOTE)))\n-\tx = const0_rtx;\n+      /* ??? This seems completely and utterly wrong.  Certainly it's\n+\t not true for NOTE_INSN_DELETED_LABEL, but I disbelieve proper\n+\t functioning even with INSN_DELETED_P and friends.  */\n+\n+      tmp = x;\n+      switch (GET_CODE (x))\n+\t{\n+\tcase CONST:\n+\t  if (GET_CODE (XEXP (x, 0)) != PLUS\n+\t      || GET_CODE (XEXP (XEXP (x, 0), 0)) != LABEL_REF)\n+\t    break;\n+\t  tmp = XEXP (XEXP (x, 0), 0);\n+\t  /* FALLTHRU */\n+\n+\tcase LABEL_REF:\n+\t  tmp = XEXP (x, 0);\n+\t  if (INSN_DELETED_P (tmp)\n+\t      || (GET_CODE (tmp) == NOTE\n+\t\t  && NOTE_LINE_NUMBER (tmp) == NOTE_INSN_DELETED))\n+\t    {\n+\t      abort ();\n+\t      x = const0_rtx;\n+\t    }\n+\t  break;\n+\t  \n+\tdefault:\n+\t  break;\n+\t}\n \n       /* First switch to correct section.  */\n #ifdef SELECT_RTX_SECTION"}]}