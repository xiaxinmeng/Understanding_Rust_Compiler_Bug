{"sha": "dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGJlOTFkZWI5YTdhYjRiNzk1MmEyYWU3ZTg5N2U5MmI5YjkwOTE1YQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2005-10-12T10:59:27Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2005-10-12T10:59:27Z"}, "message": "re PR c++/19964 (ICE on invalid member declaration)\n\n\tPR c++/19964\n\t* stor-layout.c (place_field): Set DECL_FIELD_OFFSET and\n\tDECL_FIELD_BIT_OFFSET of FIELD_DECLs, even if they have an invalid\n\ttype.\ncp:\n\tPR c++/19964\n\t* cp/class.c (walk_subobject_offsets): Don't walk error_mark_node.\ntestsuite:\n\tPR c++/19964\n\t* g++.dg/parse/crash31.C: New.\n\nFrom-SVN: r105293", "tree": {"sha": "b0465a3073a9f4f3860f76293fb3d13b4ca9868a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b0465a3073a9f4f3860f76293fb3d13b4ca9868a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/comments", "author": null, "committer": null, "parents": [{"sha": "25c5165b9a7d1a9247c461e4e90dee53ae6e099f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25c5165b9a7d1a9247c461e4e90dee53ae6e099f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/25c5165b9a7d1a9247c461e4e90dee53ae6e099f"}], "stats": {"total": 44, "additions": 42, "deletions": 2}, "files": [{"sha": "f7ce0153c91c12035d41fefbcc774a97690b9113", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "patch": "@@ -1,3 +1,10 @@\n+2005-10-12  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/19964\n+\t* stor-layout.c (place_field): Set DECL_FIELD_OFFSET and\n+\tDECL_FIELD_BIT_OFFSET of FIELD_DECLs, even if they have an invalid\n+\ttype.\n+\n 2005-10-12  Richard Guenther  <rguenther@suse.de>\n \n \tPR c++/23799\n@@ -39,6 +46,7 @@\n \tOnly apply the optimization for rounding builtins if the inner\n \tcast is also an extension.\n \n+>>>>>>> 2.10143\n 2005-10-11  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \tPR tree-opt/23946"}, {"sha": "53a5cb0cbecbb6f36b27ddd2639d629c4d25711e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "patch": "@@ -1,3 +1,8 @@\n+2005-10-12  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/19964\n+\t* cp/class.c (walk_subobject_offsets): Don't walk error_mark_node.\n+\n 2005-10-11  Ian Lance Taylor  <ian@airs.com>\n \n \tPR c++/8057"}, {"sha": "3f56652f045eaa525ebbcf90c5a25731e7d02e64", "filename": "gcc/cp/class.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "patch": "@@ -3101,6 +3101,9 @@ walk_subobject_offsets (tree type,\n   if (max_offset && INT_CST_LT (max_offset, offset))\n     return 0;\n \n+  if (type == error_mark_node)\n+    return 0;\n+  \n   if (!TYPE_P (type))\n     {\n       if (abi_version_at_least (2))"}, {"sha": "7b81abf5aee474f4091ec6b342561b0d9c77e112", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "patch": "@@ -800,9 +800,19 @@ place_field (record_layout_info rli, tree field)\n   /* The type of this field.  */\n   tree type = TREE_TYPE (field);\n \n-  if (TREE_CODE (field) == ERROR_MARK || TREE_CODE (type) == ERROR_MARK)\n-      return;\n+  gcc_assert (TREE_CODE (field) != ERROR_MARK);\n \n+  if (TREE_CODE (type) == ERROR_MARK)\n+    {\n+      if (TREE_CODE (field) == FIELD_DECL)\n+\t{\n+\t  DECL_FIELD_OFFSET (field) = size_int (0);\n+\t  DECL_FIELD_BIT_OFFSET (field) = bitsize_int (0);\n+\t}\n+      \n+      return;\n+    }\n+  \n   /* If FIELD is static, then treat it like a separate variable, not\n      really like a structure field.  If it is a FUNCTION_DECL, it's a\n      method.  In both cases, all we do is lay out the decl, and we do"}, {"sha": "51b811947ff1b675008abba17f2d15aa1f0aa6e4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "patch": "@@ -1,3 +1,8 @@\n+2005-10-12  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/19964\n+\t* g++.dg/parse/crash31.C: New.\n+\n 2005-10-12  Razya Ladelsky <razya@il.ibm.com>\n \n         * g++.dg/ipa/ipa-1.c: New test."}, {"sha": "c3fc6790a2fe153b76e298d82fac10e42cb2cbfa", "filename": "gcc/testsuite/g++.dg/parse/crash31.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fcrash31.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fcrash31.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fcrash31.C?ref=dbe91deb9a7ab4b7952a2ae7e897e92b9b90915a", "patch": "@@ -0,0 +1,9 @@\n+struct A\n+{ // { dg-error \"forward declaration\" }\n+  A : A; // { dg-error \"expected|incomplete\" }\n+  A : B; // { dg-error \"not declared|incomplete\" }\n+  A : A(); // { dg-error \"undefined type|incomplete\" }\n+  A : B(); // { dg-error \"function call|incomplete\" }\n+  A : A[]; // { dg-error \"expected|array reference|incomplete\" }\n+  A : B[]; // { dg-error \"not declared|expected|array reference|incomplete\" }\n+};"}]}