{"sha": "8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGQ2NDYyMmZjZWFhYzdmMjdiNmU3YzM1ZmNhOWY5MTIzNmYzNGI4ZA==", "commit": {"author": {"name": "Roman Zhuykov", "email": "zhroma@gcc.gnu.org", "date": "2019-04-23T12:53:43Z"}, "committer": {"name": "Roman Zhuykov", "email": "zhroma@gcc.gnu.org", "date": "2019-04-23T12:53:43Z"}, "message": "modulo-sched: fix branch scheduling issue (PR84032)\n\n\tPR rtl-optimization/84032\n\t* modulo-sched.c (ps_insn_find_column): Change condition so that\n\tbranch will always be the last insn in a row inside partial\n\tschedule.\n\ntestsuite:\n\n\tPR rtl-optimization/84032\n\t* gcc.dg/pr84032.c: New test.\n\nFrom-SVN: r270511", "tree": {"sha": "77aa4a640f4fda00d53364b6d16c115d179a6734", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/77aa4a640f4fda00d53364b6d16c115d179a6734"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/comments", "author": null, "committer": null, "parents": [{"sha": "038bc9bfd6dfd94336e0bebf416f1bbc3ed3272e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/038bc9bfd6dfd94336e0bebf416f1bbc3ed3272e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/038bc9bfd6dfd94336e0bebf416f1bbc3ed3272e"}], "stats": {"total": 43, "additions": 38, "deletions": 5}, "files": [{"sha": "f7109468b9740539a5dbd29e22d9ab484c508e90", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "patch": "@@ -1,3 +1,10 @@\n+2019-04-23  Roman Zhuykov  <zhroma@ispras.ru>\n+\n+\tPR rtl-optimization/84032\n+\t* modulo-sched.c (ps_insn_find_column): Change condition so that\n+\tbranch will always be the last insn in a row inside partial\n+\tschedule.\n+\n 2019-04-23  Richard Biener  <rguenther@suse.de>\n \n \tPR debug/90131"}, {"sha": "44014a063878d596dee63f4ad1f2889dc3600940", "filename": "gcc/modulo-sched.c", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2Fmodulo-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2Fmodulo-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmodulo-sched.c?ref=8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "patch": "@@ -2996,9 +2996,7 @@ ps_insn_find_column (partial_schedule_ptr ps, ps_insn_ptr ps_i,\n             last_must_precede = next_ps_i;\n         }\n       /* The closing branch must be the last in the row.  */\n-      if (must_precede \n-\t  && bitmap_bit_p (must_precede, next_ps_i->id)\n-\t  && JUMP_P (ps_rtl_insn (ps, next_ps_i->id)))\n+      if (JUMP_P (ps_rtl_insn (ps, next_ps_i->id)))\n \treturn false;\n              \n        last_in_row = next_ps_i;"}, {"sha": "029bad5ae95991fa7c39bd1f544c756c3dba885a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "patch": "@@ -1,12 +1,17 @@\n+2019-04-23  Roman Zhuykov  <zhroma@ispras.ru>\n+\n+\tPR rtl-optimization/84032\n+\t* gcc.dg/pr84032.c: New test.\n+\n 2018-04-23  Bin Cheng  <bin.cheng@linux.alibaba.com>\n \n \tPR tree-optimization/90078\n-\t* gcc/testsuite/g++.dg/tree-ssa/pr90078.C: New test.\n+\t* g++.dg/tree-ssa/pr90078.C: New test.\n \n 2018-04-23  Bin Cheng  <bin.cheng@linux.alibaba.com>\n \n \tPR tree-optimization/90021\n-\t* gcc/testsuite/gfortran.dg/pr90021.f90: New test.\n+\t* gfortran.dg/pr90021.f90: New test.\n \n 2019-04-22  Steven G. Kargl  <kargl@gcc.gnu.org>\n "}, {"sha": "c295d9a0dae4a65932226e165b578ff6cd3154c4", "filename": "gcc/testsuite/gcc.dg/pr84032.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84032.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d64622fceaac7f27b6e7c35fca9f91236f34b8d/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84032.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84032.c?ref=8d64622fceaac7f27b6e7c35fca9f91236f34b8d", "patch": "@@ -0,0 +1,23 @@\n+/* PR rtl-optimization/84032 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -fmodulo-sched\" } */\n+/* { dg-additional-options \"-mcpu=power6\" { target { powerpc-*-* } } } */\n+\n+void\n+yr (int cm)\n+{\n+  int ka = cm;\n+\n+  for (;;)\n+    {\n+      short int m0;\n+\n+      for (m0 = 0; m0 < 6; ++m0)\n+        {\n+          ka &= 1;\n+          cm *= 2;\n+        }\n+\n+      ka = (ka == 0) ? cm : 0;\n+    }\n+}"}]}