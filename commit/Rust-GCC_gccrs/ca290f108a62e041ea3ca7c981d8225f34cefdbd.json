{"sha": "ca290f108a62e041ea3ca7c981d8225f34cefdbd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2EyOTBmMTA4YTYyZTA0MWVhM2NhN2M5ODFkODIyNWYzNGNlZmRiZA==", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2021-05-10T16:00:46Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-07-06T14:46:57Z"}, "message": "[Ada] Simplify unit loading with membership tests\n\ngcc/ada/\n\n\t* lib-load.adb (Load_Unit): Remove excessive whitespace.\n\t* lib.adb (Is_Internal_Unit, Is_Predefined_Unit): Likewise.\n\t* par-ch10.adb (P_Compilation_Unit): Simplify with membership\n\ttest.\n\t* par-load.adb (Load): Likewise.\n\t* uname.adb (Get_Unit_Name): Likewise.", "tree": {"sha": "2dd19bf81eb31f4449c3712af83672391046d6f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2dd19bf81eb31f4449c3712af83672391046d6f6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ca290f108a62e041ea3ca7c981d8225f34cefdbd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca290f108a62e041ea3ca7c981d8225f34cefdbd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ca290f108a62e041ea3ca7c981d8225f34cefdbd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ca290f108a62e041ea3ca7c981d8225f34cefdbd/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3751af1e7ba5173f35f0e0a5adc62e4455f7a963", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3751af1e7ba5173f35f0e0a5adc62e4455f7a963", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3751af1e7ba5173f35f0e0a5adc62e4455f7a963"}], "stats": {"total": 58, "additions": 22, "deletions": 36}, "files": [{"sha": "75b52e2240a7c84c2c16c06cc33434f2217f06b7", "filename": "gcc/ada/lib-load.adb", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Flib-load.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Flib-load.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib-load.adb?ref=ca290f108a62e041ea3ca7c981d8225f34cefdbd", "patch": "@@ -396,14 +396,14 @@ package body Lib.Load is\n    ---------------\n \n    function Load_Unit\n-     (Load_Name         : Unit_Name_Type;\n-      Required          : Boolean;\n-      Error_Node        : Node_Id;\n-      Subunit           : Boolean;\n-      Corr_Body         : Unit_Number_Type := No_Unit;\n-      Renamings         : Boolean          := False;\n-      With_Node         : Node_Id          := Empty;\n-      PMES              : Boolean          := False) return Unit_Number_Type\n+     (Load_Name  : Unit_Name_Type;\n+      Required   : Boolean;\n+      Error_Node : Node_Id;\n+      Subunit    : Boolean;\n+      Corr_Body  : Unit_Number_Type := No_Unit;\n+      Renamings  : Boolean          := False;\n+      With_Node  : Node_Id          := Empty;\n+      PMES       : Boolean          := False) return Unit_Number_Type\n    is\n       Calling_Unit : Unit_Number_Type;\n       Uname_Actual : Unit_Name_Type;"}, {"sha": "44aa5c61e609d084bed904595d942a1a9549814b", "filename": "gcc/ada/lib.adb", "status": "modified", "additions": 4, "deletions": 10, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Flib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Flib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib.adb?ref=ca290f108a62e041ea3ca7c981d8225f34cefdbd", "patch": "@@ -128,12 +128,12 @@ package body Lib is\n       return Units.Table (U).Is_Predefined_Renaming;\n    end Is_Predefined_Renaming;\n \n-   function Is_Internal_Unit       (U : Unit_Number_Type) return Boolean is\n+   function Is_Internal_Unit (U : Unit_Number_Type) return Boolean is\n    begin\n       return Units.Table (U).Is_Internal_Unit;\n    end Is_Internal_Unit;\n \n-   function Is_Predefined_Unit     (U : Unit_Number_Type) return Boolean is\n+   function Is_Predefined_Unit (U : Unit_Number_Type) return Boolean is\n    begin\n       return Units.Table (U).Is_Predefined_Unit;\n    end Is_Predefined_Unit;\n@@ -482,18 +482,12 @@ package body Lib is\n          --  body of the same unit. The location in the spec is considered\n          --  earlier.\n \n-         if Nkind (Unit1) = N_Subprogram_Body\n-              or else\n-            Nkind (Unit1) = N_Package_Body\n-         then\n+         if Nkind (Unit1) in N_Subprogram_Body | N_Package_Body then\n             if Library_Unit (Cunit (Unum1)) = Cunit (Unum2) then\n                return Yes_After;\n             end if;\n \n-         elsif Nkind (Unit2) = N_Subprogram_Body\n-                 or else\n-               Nkind (Unit2) = N_Package_Body\n-         then\n+         elsif Nkind (Unit2) in N_Subprogram_Body | N_Package_Body then\n             if Library_Unit (Cunit (Unum2)) = Cunit (Unum1) then\n                return Yes_Before;\n             end if;"}, {"sha": "9a49d45b8ab502a9b354113a73987ad6ffcbcba0", "filename": "gcc/ada/par-ch10.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Fpar-ch10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Fpar-ch10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-ch10.adb?ref=ca290f108a62e041ea3ca7c981d8225f34cefdbd", "patch": "@@ -555,7 +555,7 @@ package body Ch10 is\n                                   | N_Generic_Function_Renaming_Declaration\n                                   | N_Generic_Package_Renaming_Declaration\n                                   | N_Generic_Procedure_Renaming_Declaration\n-          or else Nkind (Unit_Node) in N_Package_Body\n+                                  | N_Package_Body\n                                   | N_Package_Instantiation\n                                   | N_Package_Renaming_Declaration\n                                   | N_Package_Specification"}, {"sha": "fe8fede714ca188d2599e302c2c4ae34579e37de", "filename": "gcc/ada/par-load.adb", "status": "modified", "additions": 7, "deletions": 15, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Fpar-load.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Fpar-load.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fpar-load.adb?ref=ca290f108a62e041ea3ca7c981d8225f34cefdbd", "patch": "@@ -182,14 +182,8 @@ begin\n       --  Check for predefined file case\n \n       if Name_Len > 1\n+        and then Name_Buffer (1) in 'a' | 's' | 'i' | 'g'\n         and then Name_Buffer (2) = '-'\n-        and then (Name_Buffer (1) = 'a'\n-                    or else\n-                  Name_Buffer (1) = 's'\n-                    or else\n-                  Name_Buffer (1) = 'i'\n-                    or else\n-                  Name_Buffer (1) = 'g')\n       then\n          declare\n             Expect_Name : constant Unit_Name_Type := Expected_Unit (Cur_Unum);\n@@ -248,9 +242,7 @@ begin\n \n    --  If current unit is a body, load its corresponding spec\n \n-   if Nkind (Unit (Curunit)) = N_Package_Body\n-     or else Nkind (Unit (Curunit)) = N_Subprogram_Body\n-   then\n+   if Nkind (Unit (Curunit)) in N_Package_Body | N_Subprogram_Body then\n       Spec_Name := Get_Spec_Name (Unit_Name (Cur_Unum));\n       Unum :=\n         Load_Unit\n@@ -304,11 +296,11 @@ begin\n    --  If current unit is a child unit spec, load its parent. If the child unit\n    --  is loaded through a limited with, the parent must be as well.\n \n-   elsif     Nkind (Unit (Curunit)) =  N_Package_Declaration\n-     or else Nkind (Unit (Curunit)) =  N_Subprogram_Declaration\n-     or else Nkind (Unit (Curunit)) in N_Generic_Declaration\n-     or else Nkind (Unit (Curunit)) in N_Generic_Instantiation\n-     or else Nkind (Unit (Curunit)) in N_Renaming_Declaration\n+   elsif Nkind (Unit (Curunit)) in N_Package_Declaration\n+                                 | N_Subprogram_Declaration\n+                                 | N_Generic_Declaration\n+                                 | N_Generic_Instantiation\n+                                 | N_Renaming_Declaration\n    then\n       --  Turn style checks off for parent unit\n "}, {"sha": "3192c3da6d2a92e7fd2087599b6f2e9b160c657d", "filename": "gcc/ada/uname.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Funame.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ca290f108a62e041ea3ca7c981d8225f34cefdbd/gcc%2Fada%2Funame.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Funame.adb?ref=ca290f108a62e041ea3ca7c981d8225f34cefdbd", "patch": "@@ -367,8 +367,8 @@ package body Uname is\n          Node := Declaration_Node (Entity (Node));\n       end if;\n \n-      if Nkind (Node) = N_Package_Specification\n-        or else Nkind (Node) in N_Subprogram_Specification\n+      if Nkind (Node) in N_Package_Specification\n+                       | N_Subprogram_Specification\n       then\n          Node := Parent (Node);\n       end if;"}]}