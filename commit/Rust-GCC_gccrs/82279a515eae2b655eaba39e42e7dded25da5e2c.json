{"sha": "82279a515eae2b655eaba39e42e7dded25da5e2c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODIyNzlhNTE1ZWFlMmI2NTVlYWJhMzllNDJlN2RkZWQyNWRhNWUyYw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@linaro.org", "date": "2018-01-16T09:28:26Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2018-01-16T09:28:26Z"}, "message": "Don't group gather loads (PR83847)\n\nIn the testcase we were trying to group two gather loads, even though\nthat isn't supported.  Fixed by explicitly disallowing grouping of\ngathers and scatters.\n\nThis problem didn't show up on SVE because there we convert to\nIFN_GATHER_LOAD/IFN_SCATTER_STORE pattern statements, which fail\nthe can_group_stmts_p check.\n\n2018-01-16  Richard Sandiford  <richard.sandiford@linaro.org>\n\ngcc/\n\t* tree-vect-data-refs.c (vect_analyze_data_ref_accesses):\n\ngcc/testsuite/\n\t* gcc.dg/torture/pr83847.c: New test.\n\nFrom-SVN: r256730", "tree": {"sha": "1cefcc28303d503484179c158c5c32f77a936a1b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1cefcc28303d503484179c158c5c32f77a936a1b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82279a515eae2b655eaba39e42e7dded25da5e2c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82279a515eae2b655eaba39e42e7dded25da5e2c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82279a515eae2b655eaba39e42e7dded25da5e2c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82279a515eae2b655eaba39e42e7dded25da5e2c/comments", "author": null, "committer": null, "parents": [{"sha": "9064759767c96c221038fc5998596d425a18622d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9064759767c96c221038fc5998596d425a18622d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9064759767c96c221038fc5998596d425a18622d"}], "stats": {"total": 46, "additions": 44, "deletions": 2}, "files": [{"sha": "f83d351942ad4d82efcbc3f9fc296b6843caf0b3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=82279a515eae2b655eaba39e42e7dded25da5e2c", "patch": "@@ -1,3 +1,7 @@\n+2018-01-16  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\t* tree-vect-data-refs.c (vect_analyze_data_ref_accesses):\n+\n 2018-01-16  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR rtl-optimization/86620"}, {"sha": "9bc4d7be97c9b7b01b607b800078670771a994c1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=82279a515eae2b655eaba39e42e7dded25da5e2c", "patch": "@@ -1,3 +1,7 @@\n+2018-01-16  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\t* gcc.dg/torture/pr83847.c: New test.\n+\n 2018-01-16  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR rtl-optimization/86620"}, {"sha": "e42541e1b57c9511bd902d8676772fd348f97579", "filename": "gcc/testsuite/gcc.dg/torture/pr83847.c", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr83847.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr83847.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr83847.c?ref=82279a515eae2b655eaba39e42e7dded25da5e2c", "patch": "@@ -0,0 +1,32 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-march=bdver4\" { target i?86-*-* x86_64-*-* } } */\n+\n+typedef struct {\n+  struct {\n+    int a;\n+    int b;\n+  } c;\n+} * d;\n+typedef struct {\n+  unsigned e;\n+  d f[];\n+} g;\n+g h;\n+d *k;\n+int i(int j) {\n+  if (j) {\n+    *k = *h.f;\n+    return 1;\n+  }\n+  return 0;\n+}\n+int l;\n+int m;\n+int n;\n+d o;\n+void p() {\n+  for (; i(l); l++) {\n+    n += o->c.a;\n+    m += o->c.b;\n+  }\n+}"}, {"sha": "01f7138e077abf1f49e3ffbb0771b7a7d6161448", "filename": "gcc/tree-vect-data-refs.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2Ftree-vect-data-refs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82279a515eae2b655eaba39e42e7dded25da5e2c/gcc%2Ftree-vect-data-refs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-data-refs.c?ref=82279a515eae2b655eaba39e42e7dded25da5e2c", "patch": "@@ -2923,7 +2923,8 @@ vect_analyze_data_ref_accesses (vec_info *vinfo)\n       data_reference_p dra = datarefs_copy[i];\n       stmt_vec_info stmtinfo_a = vinfo_for_stmt (DR_STMT (dra));\n       stmt_vec_info lastinfo = NULL;\n-      if (! STMT_VINFO_VECTORIZABLE (stmtinfo_a))\n+      if (!STMT_VINFO_VECTORIZABLE (stmtinfo_a)\n+\t  || STMT_VINFO_GATHER_SCATTER_P (stmtinfo_a))\n \t{\n \t  ++i;\n \t  continue;\n@@ -2932,7 +2933,8 @@ vect_analyze_data_ref_accesses (vec_info *vinfo)\n \t{\n \t  data_reference_p drb = datarefs_copy[i];\n \t  stmt_vec_info stmtinfo_b = vinfo_for_stmt (DR_STMT (drb));\n-\t  if (! STMT_VINFO_VECTORIZABLE (stmtinfo_b))\n+\t  if (!STMT_VINFO_VECTORIZABLE (stmtinfo_b)\n+\t      || STMT_VINFO_GATHER_SCATTER_P (stmtinfo_b))\n \t    break;\n \n \t  /* ???  Imperfect sorting (non-compatible types, non-modulo"}]}