{"sha": "e4672ccdb366be7135f3e931c710df0ffbc46d1d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQ2NzJjY2RiMzY2YmU3MTM1ZjNlOTMxYzcxMGRmMGZmYmM0NmQxZA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2010-01-20T21:30:20Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2010-01-20T21:30:20Z"}, "message": "re PR c++/40750 (Side-effect of member function call not produced in certain circumstances)\n\n\tPR c++/40750\n\t* decl.c (grokdeclarator): Clear type_quals for a member function\n\tdeclared using a typedef.  Don't complain about adding cv-quals\n\tto a function typedef in C++0x mode.\n\nFrom-SVN: r156084", "tree": {"sha": "e967e0b66fcbfaa1ab6aac422cfbc8718b8478a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e967e0b66fcbfaa1ab6aac422cfbc8718b8478a1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4672ccdb366be7135f3e931c710df0ffbc46d1d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4672ccdb366be7135f3e931c710df0ffbc46d1d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4672ccdb366be7135f3e931c710df0ffbc46d1d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4672ccdb366be7135f3e931c710df0ffbc46d1d/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "35b954c12d0d5473a5d51fe1ff167aa0774c1a9c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35b954c12d0d5473a5d51fe1ff167aa0774c1a9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35b954c12d0d5473a5d51fe1ff167aa0774c1a9c"}], "stats": {"total": 37, "additions": 34, "deletions": 3}, "files": [{"sha": "726983807bbabf945b65cc180777775e66fd8ab1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=e4672ccdb366be7135f3e931c710df0ffbc46d1d", "patch": "@@ -1,3 +1,10 @@\n+2010-01-20  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/40750\n+\t* decl.c (grokdeclarator): Clear type_quals for a member function\n+\tdeclared using a typedef.  Don't complain about adding cv-quals\n+\tto a function typedef in C++0x mode.\n+\n 2010-01-20  Jakub Jelinek  <jakub@redhat.com>\n \n \t* decl.c (create_array_type_for_decl): Remove set but not used"}, {"sha": "920d75b75a83f824c93c1606f6568db59a7c864d", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=e4672ccdb366be7135f3e931c710df0ffbc46d1d", "patch": "@@ -8149,7 +8149,7 @@ grokdeclarator (const cp_declarator *declarator,\n       /* This was an error in C++98 (cv-qualifiers cannot be added to\n \t a function type), but DR 295 makes the code well-formed by\n \t dropping the extra qualifiers. */\n-      if (pedantic)\n+      if (pedantic && cxx_dialect == cxx98)\n \t{\n \t  tree bad_type = build_qualified_type (type, type_quals);\n \t  pedwarn (input_location, OPT_pedantic, \n@@ -9046,6 +9046,7 @@ grokdeclarator (const cp_declarator *declarator,\n \t  /* The qualifiers on the function type become the qualifiers on\n \t     the non-static member function. */\n \t  memfn_quals |= cp_type_quals (type);\n+\t  type_quals = TYPE_UNQUALIFIED;\n \t}\n     }\n "}, {"sha": "db9bb35d5157675392580b3a9effa565823f8f58", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e4672ccdb366be7135f3e931c710df0ffbc46d1d", "patch": "@@ -1,3 +1,9 @@\n+2010-01-20  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/40750\n+\t* g++.dg/parse/fn-typedef1.C: New.\n+\t* g++.dg/other/cv_quals.C: Adjust.\n+\n 2010-01-20  Anthony Green  <green@moxielogic.com>\n \n \t* gcc.dg/cpp/_Pragma6.c: Skip this test for moxie-*-* (no"}, {"sha": "788c173b423733fedc0baa5827fccac4e60a9673", "filename": "gcc/testsuite/g++.dg/other/cv_func.C", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func.C?ref=e4672ccdb366be7135f3e931c710df0ffbc46d1d", "patch": "@@ -4,7 +4,6 @@ typedef int FIC(int) const;\n typedef int FI(int);\n \n FIC f; // { dg-error \"qualified\" }\n-// { dg-error \"ignoring\" \"ignoring\" { target *-*-* } 6 }\n struct S {\n   FIC f; // OK\n \n@@ -15,7 +14,7 @@ struct S {\n };\n FIC S::*pm = &S::f;\n const FI S::*pm2 = &S::f; // { dg-error \"qualifier\" }\n-// { dg-error \"cannot convert\" \"cannot convert\" { target *-*-* } 17 }\n+// { dg-error \"cannot convert\" \"cannot convert\" { target *-*-* } 16 }\n const FIC S::*pm3 = &S::f; // { dg-error \"qualifier\" }\n \n int S::f(int) const"}, {"sha": "6cc862583f418f4da397459510fb0ff52d5f2262", "filename": "gcc/testsuite/g++.dg/parse/fn-typedef1.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ffn-typedef1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4672ccdb366be7135f3e931c710df0ffbc46d1d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ffn-typedef1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ffn-typedef1.C?ref=e4672ccdb366be7135f3e931c710df0ffbc46d1d", "patch": "@@ -0,0 +1,18 @@\n+// PR c++/40750\n+\n+extern \"C\" void abort ();\n+\n+typedef void Fn() const;\n+\n+struct Foo {\n+  Fn fn;\n+};\n+\n+bool called = false;\n+void Foo::fn() const { called = true; }\n+\n+int main() {\n+  Foo f; f.fn();\n+  if (!called)\n+    abort();\n+}"}]}