{"sha": "36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzZiODZmNGE1NDY3NWUwZDcwN2EzM2UxYmM2MDVlYjRkN2U2MTM5ZA==", "commit": {"author": {"name": "Jie Zhang", "email": "jie@codesourcery.com", "date": "2010-08-05T03:05:35Z"}, "committer": {"name": "Jie Zhang", "email": "jiez@gcc.gnu.org", "date": "2010-08-05T03:05:35Z"}, "message": "re PR tree-optimization/45144 (SRA optimization issue of bit-field)\n\n\tPR tree-optimization/45144\n\t* tree-sra.c (type_consists_of_records_p): Return false\n\tif the record contains bit-field.\n\n\ttestsuite/\n\tPR tree-optimization/45144\n\t* gcc.dg/tree-ssa/pr45144.c: New test.\n\nFrom-SVN: r162897", "tree": {"sha": "9e187d4ca7b2b2e716a05a1076c35b48a73d25c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9e187d4ca7b2b2e716a05a1076c35b48a73d25c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/comments", "author": null, "committer": null, "parents": [{"sha": "370f330ff58ff6ec3504fd2886d79e15368f3143", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/370f330ff58ff6ec3504fd2886d79e15368f3143", "html_url": "https://github.com/Rust-GCC/gccrs/commit/370f330ff58ff6ec3504fd2886d79e15368f3143"}], "stats": {"total": 62, "additions": 61, "deletions": 1}, "files": [{"sha": "e014b3e43a7eda69eb154b5c1d7e6474ff0315e4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "patch": "@@ -1,3 +1,9 @@\n+2010-08-05  Jie Zhang  <jie@codesourcery.com>\n+\n+\tPR tree-optimization/45144\n+\t* tree-sra.c (type_consists_of_records_p): Return false\n+\tif the record contains bit-field.\n+\n 2010-08-04  Richard Henderson  <rth@redhat.com>\n \n \t* config/i386/i386.c (struct ix86_frame): Remove padding and"}, {"sha": "6c37a88dd06476ec102e7a60d1ce061262644dba", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "patch": "@@ -1,3 +1,8 @@\n+2010-08-05  Jie Zhang  <jie@codesourcery.com>\n+\n+\tPR tree-optimization/45144\n+\t* gcc.dg/tree-ssa/pr45144.c: New test.\n+\n 2010-08-04  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/42207"}, {"sha": "47530ced46e4001894e27bb0dd7f0eee797377a7", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr45144.c", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr45144.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr45144.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr45144.c?ref=36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "patch": "@@ -0,0 +1,46 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-optimized\" } */\n+\n+void baz (unsigned);\n+\n+extern unsigned buf[];\n+\n+struct A\n+{\n+  unsigned a1:10;\n+  unsigned a2:3;\n+  unsigned:19;\n+};\n+\n+union TMP\n+{\n+  struct A a;\n+  unsigned int b;\n+};\n+\n+static unsigned\n+foo (struct A *p)\n+{\n+  union TMP t;\n+  struct A x;\n+  \n+  x = *p;\n+  t.a = x;\n+  return t.b;\n+}\n+\n+void\n+bar (unsigned orig, unsigned *new)\n+{\n+  struct A a;\n+  union TMP s;\n+\n+  s.b = orig;\n+  a = s.a;\n+  if (a.a1)\n+    baz (a.a2);\n+  *new = foo (&a);\n+}\n+\n+/* { dg-final { scan-tree-dump \"x = a;\" \"optimized\"} } */\n+/* { dg-final { cleanup-tree-dump \"optimized\" } } */"}, {"sha": "d32bbebc0f2d7503726183fd8cc1fbb0d0758e9f", "filename": "gcc/tree-sra.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2Ftree-sra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/36b86f4a54675e0d707a33e1bc605eb4d7e6139d/gcc%2Ftree-sra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-sra.c?ref=36b86f4a54675e0d707a33e1bc605eb4d7e6139d", "patch": "@@ -811,7 +811,7 @@ create_access (tree expr, gimple stmt, bool write)\n /* Return true iff TYPE is a RECORD_TYPE with fields that are either of gimple\n    register types or (recursively) records with only these two kinds of fields.\n    It also returns false if any of these records has a zero-size field as its\n-   last field.  */\n+   last field or has a bit-field.  */\n \n static bool\n type_consists_of_records_p (tree type)\n@@ -827,6 +827,9 @@ type_consists_of_records_p (tree type)\n       {\n \ttree ft = TREE_TYPE (fld);\n \n+\tif (DECL_BIT_FIELD (fld))\n+\t  return false;\n+\n \tif (!is_gimple_reg_type (ft)\n \t    && !type_consists_of_records_p (ft))\n \t  return false;"}]}