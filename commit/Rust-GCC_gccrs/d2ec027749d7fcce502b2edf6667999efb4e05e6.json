{"sha": "d2ec027749d7fcce502b2edf6667999efb4e05e6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDJlYzAyNzc0OWQ3ZmNjZTUwMmIyZWRmNjY2Nzk5OWVmYjRlMDVlNg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2017-10-11T13:18:46Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-10-11T13:18:46Z"}, "message": "tree.def (POLYNOMIAL_CHREC): Remove CHREC_VARIABLE tree operand.\n\n2017-10-11  Richard Biener  <rguenther@suse.de>\n\n\t* tree.def (POLYNOMIAL_CHREC): Remove CHREC_VARIABLE tree operand.\n\t* tree-core.h (tree_base): Add chrec_var union member.\n\t* tree.h (CHREC_VAR): Remove.\n\t(CHREC_LEFT, CHREC_RIGHT, CHREC_VARIABLE): Adjust.\n\t* tree-chrec.h (build_polynomial_chrec): Adjust.\n\t* tree-chrec.c (reset_evolution_in_loop): Use build_polynomial_chrec.\n\t* tree-pretty-print.c (dump_generic_node): Use CHREC_VARIABLE.\n\nFrom-SVN: r253643", "tree": {"sha": "1f7df19f00d7907c8969115d87abfaa9bf8a929f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1f7df19f00d7907c8969115d87abfaa9bf8a929f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d2ec027749d7fcce502b2edf6667999efb4e05e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2ec027749d7fcce502b2edf6667999efb4e05e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2ec027749d7fcce502b2edf6667999efb4e05e6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2ec027749d7fcce502b2edf6667999efb4e05e6/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6358a676c3eb4c6df013ce8319bcf429cd14232b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6358a676c3eb4c6df013ce8319bcf429cd14232b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6358a676c3eb4c6df013ce8319bcf429cd14232b"}], "stats": {"total": 35, "additions": 23, "deletions": 12}, "files": [{"sha": "91e16cf61e172a7ac5aca3208141eb51ab544e4d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d2ec027749d7fcce502b2edf6667999efb4e05e6", "patch": "@@ -1,3 +1,13 @@\n+2017-10-11  Richard Biener  <rguenther@suse.de>\n+\n+\t* tree.def (POLYNOMIAL_CHREC): Remove CHREC_VARIABLE tree operand.\n+\t* tree-core.h (tree_base): Add chrec_var union member.\n+\t* tree.h (CHREC_VAR): Remove.\n+\t(CHREC_LEFT, CHREC_RIGHT, CHREC_VARIABLE): Adjust.\n+\t* tree-chrec.h (build_polynomial_chrec): Adjust.\n+\t* tree-chrec.c (reset_evolution_in_loop): Use build_polynomial_chrec.\n+\t* tree-pretty-print.c (dump_generic_node): Use CHREC_VARIABLE.\n+\n 2017-10-11  Marc Glisse  <marc.glisse@inria.fr>\n \n \t* fold-const.c (fold_binary_loc) [X +- Y CMP X]: Move ..."}, {"sha": "beddf108104bb9d1d9e46e7589cdcddc0796dccf", "filename": "gcc/tree-chrec.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-chrec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-chrec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-chrec.c?ref=d2ec027749d7fcce502b2edf6667999efb4e05e6", "patch": "@@ -872,8 +872,7 @@ reset_evolution_in_loop (unsigned loop_num,\n \t\t\t\t\t   new_evol);\n       tree right = reset_evolution_in_loop (loop_num, CHREC_RIGHT (chrec),\n \t\t\t\t\t    new_evol);\n-      return build3 (POLYNOMIAL_CHREC, TREE_TYPE (left),\n-\t\t     CHREC_VAR (chrec), left, right);\n+      return build_polynomial_chrec (CHREC_VARIABLE (chrec), left, right);\n     }\n \n   while (TREE_CODE (chrec) == POLYNOMIAL_CHREC"}, {"sha": "4838bae89aa1ba9b317eeb9bd61230b5e7c3c42f", "filename": "gcc/tree-chrec.h", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-chrec.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-chrec.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-chrec.h?ref=d2ec027749d7fcce502b2edf6667999efb4e05e6", "patch": "@@ -157,8 +157,9 @@ build_polynomial_chrec (unsigned loop_num,\n   if (chrec_zerop (right))\n     return left;\n \n-  return build3 (POLYNOMIAL_CHREC, TREE_TYPE (left),\n-\t\t build_int_cst (NULL_TREE, loop_num), left, right);\n+  tree chrec = build2 (POLYNOMIAL_CHREC, TREE_TYPE (left), left, right);\n+  CHREC_VARIABLE (chrec) = loop_num;\n+  return chrec;\n }\n \n /* Determines whether the expression CHREC is a constant.  */"}, {"sha": "09be62390751559eedbacdb94df5738df5ec2717", "filename": "gcc/tree-core.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-core.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-core.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-core.h?ref=d2ec027749d7fcce502b2edf6667999efb4e05e6", "patch": "@@ -981,6 +981,9 @@ struct GTY(()) tree_base {\n     /* SSA version number.  This field is only used with SSA_NAME.  */\n     unsigned int version;\n \n+    /* CHREC_VARIABLE.  This field is only used with POLYNOMIAL_CHREC.  */\n+    unsigned int chrec_var;\n+\n     /* Internal function code.  */\n     enum internal_fn ifn;\n "}, {"sha": "9a5eab5b2e1c88a46ec620332f997fe622619ed5", "filename": "gcc/tree-pretty-print.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-pretty-print.c?ref=d2ec027749d7fcce502b2edf6667999efb4e05e6", "patch": "@@ -2819,8 +2819,7 @@ dump_generic_node (pretty_printer *pp, tree node, int spc, dump_flags_t flags,\n       dump_generic_node (pp, CHREC_LEFT (node), spc, flags, false);\n       pp_string (pp, \", +, \");\n       dump_generic_node (pp, CHREC_RIGHT (node), spc, flags, false);\n-      pp_string (pp, \"}_\");\n-      dump_generic_node (pp, CHREC_VAR (node), spc, flags, false);\n+      pp_printf (pp, \"}_%u\", CHREC_VARIABLE (node));\n       is_stmt = false;\n       break;\n "}, {"sha": "3d2bd95d666545c18a8ec0cd26ecb91807070f10", "filename": "gcc/tree.def", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.def?ref=d2ec027749d7fcce502b2edf6667999efb4e05e6", "patch": "@@ -982,8 +982,8 @@ DEFTREECODE (SCEV_KNOWN, \"scev_known\", tcc_expression, 0)\n DEFTREECODE (SCEV_NOT_KNOWN, \"scev_not_known\", tcc_expression, 0)\n \n /* Polynomial chains of recurrences.\n-   Under the form: cr = {CHREC_LEFT (cr), +, CHREC_RIGHT (cr)}.  */\n-DEFTREECODE (POLYNOMIAL_CHREC, \"polynomial_chrec\", tcc_expression, 3)\n+   cr = {CHREC_LEFT (cr), +, CHREC_RIGHT (cr)}_CHREC_VARIABLE (cr).  */\n+DEFTREECODE (POLYNOMIAL_CHREC, \"polynomial_chrec\", tcc_expression, 2)\n \n /* Used to chain children of container statements together.\n    Use the interface in tree-iterator.h to access this node.  */"}, {"sha": "9507c3bef51b103c8e3be5785acbcb31ab6261b0", "filename": "gcc/tree.h", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2ec027749d7fcce502b2edf6667999efb4e05e6/gcc%2Ftree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.h?ref=d2ec027749d7fcce502b2edf6667999efb4e05e6", "patch": "@@ -1241,10 +1241,9 @@ extern void protected_set_expr_location (tree, location_t);\n #define COND_EXPR_ELSE(NODE)\t(TREE_OPERAND (COND_EXPR_CHECK (NODE), 2))\n \n /* Accessors for the chains of recurrences.  */\n-#define CHREC_VAR(NODE)           TREE_OPERAND (POLYNOMIAL_CHREC_CHECK (NODE), 0)\n-#define CHREC_LEFT(NODE)          TREE_OPERAND (POLYNOMIAL_CHREC_CHECK (NODE), 1)\n-#define CHREC_RIGHT(NODE)         TREE_OPERAND (POLYNOMIAL_CHREC_CHECK (NODE), 2)\n-#define CHREC_VARIABLE(NODE)      TREE_INT_CST_LOW (CHREC_VAR (NODE))\n+#define CHREC_LEFT(NODE)          TREE_OPERAND (POLYNOMIAL_CHREC_CHECK (NODE), 0)\n+#define CHREC_RIGHT(NODE)         TREE_OPERAND (POLYNOMIAL_CHREC_CHECK (NODE), 1)\n+#define CHREC_VARIABLE(NODE)      POLYNOMIAL_CHREC_CHECK (NODE)->base.u.chrec_var\n \n /* LABEL_EXPR accessor. This gives access to the label associated with\n    the given label expression.  */"}]}