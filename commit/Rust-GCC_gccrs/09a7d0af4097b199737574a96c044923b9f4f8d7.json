{"sha": "09a7d0af4097b199737574a96c044923b9f4f8d7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDlhN2QwYWY0MDk3YjE5OTczNzU3NGE5NmMwNDQ5MjNiOWY0ZjhkNw==", "commit": {"author": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2009-08-04T21:33:50Z"}, "committer": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2009-08-04T21:33:50Z"}, "message": "linux-atomic.asm (ATOMIC_BOOL_COMPARE_AND_SWAP, [...]): Define.\n\n\t* config/sh/linux-atomic.asm (ATOMIC_BOOL_COMPARE_AND_SWAP,\n\tATOMIC_OP_AND_FETCH, ATOMIC_COMBOP_AND_FETCH): Define.\n\nFrom-SVN: r150469", "tree": {"sha": "95e608501f025987f3e3eda9471d9f10269a0158", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/95e608501f025987f3e3eda9471d9f10269a0158"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/09a7d0af4097b199737574a96c044923b9f4f8d7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09a7d0af4097b199737574a96c044923b9f4f8d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09a7d0af4097b199737574a96c044923b9f4f8d7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09a7d0af4097b199737574a96c044923b9f4f8d7/comments", "author": null, "committer": null, "parents": [{"sha": "3693f2667550f29bde20f910c8e9ba4854114878", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3693f2667550f29bde20f910c8e9ba4854114878", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3693f2667550f29bde20f910c8e9ba4854114878"}], "stats": {"total": 87, "additions": 87, "deletions": 0}, "files": [{"sha": "e94be4e3e20d74a7c9488aab3af9bb9efcf7848f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09a7d0af4097b199737574a96c044923b9f4f8d7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09a7d0af4097b199737574a96c044923b9f4f8d7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=09a7d0af4097b199737574a96c044923b9f4f8d7", "patch": "@@ -1,3 +1,8 @@\n+2009-08-04  Kaz Kojima  <kkojima@gcc.gnu.org>\n+\n+\t* config/sh/linux-atomic.asm (ATOMIC_BOOL_COMPARE_AND_SWAP,\n+\tATOMIC_OP_AND_FETCH, ATOMIC_COMBOP_AND_FETCH): Define.\n+\n 2009-08-03  Janis Johnson  <janis187@us.ibm.com>\n \n \tPR c/39902"}, {"sha": "743c61bb76c66904ffd738687bfd108d1e94da99", "filename": "gcc/config/sh/linux-atomic.asm", "status": "modified", "additions": 82, "deletions": 0, "changes": 82, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09a7d0af4097b199737574a96c044923b9f4f8d7/gcc%2Fconfig%2Fsh%2Flinux-atomic.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09a7d0af4097b199737574a96c044923b9f4f8d7/gcc%2Fconfig%2Fsh%2Flinux-atomic.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Flinux-atomic.asm?ref=09a7d0af4097b199737574a96c044923b9f4f8d7", "patch": "@@ -75,6 +75,28 @@ ATOMIC_COMPARE_AND_SWAP (1,b,exts.b,extu.b)\n ATOMIC_COMPARE_AND_SWAP (2,w,exts.w,extu.w)\n ATOMIC_COMPARE_AND_SWAP (4,l,mov,mov)\n \n+#define ATOMIC_BOOL_COMPARE_AND_SWAP(N,T,EXTS) \\\n+\t.global\t__sync_bool_compare_and_swap_##N; \\\n+\tHIDDEN_FUNC(__sync_bool_compare_and_swap_##N); \\\n+\t.align\t2; \\\n+__sync_bool_compare_and_swap_##N:; \\\n+\tmova\t1f, r0; \\\n+\tEXTS\tr5, r5; \\\n+\tmov\tr15, r1; \\\n+\tmov\t#(0f-1f), r15; \\\n+0:\tmov.##T\t@r4, r2; \\\n+\tcmp/eq\tr2, r5; \\\n+\tbf\t1f; \\\n+\tmov.##T\tr6, @r4; \\\n+1:\tmov\tr1, r15; \\\n+\trts; \\\n+\t movt\tr0; \\\n+\tENDFUNC(__sync_bool_compare_and_swap_##N)\n+\n+ATOMIC_BOOL_COMPARE_AND_SWAP (1,b,exts.b)\n+ATOMIC_BOOL_COMPARE_AND_SWAP (2,w,exts.w)\n+ATOMIC_BOOL_COMPARE_AND_SWAP (4,l,mov)\n+\n #define ATOMIC_FETCH_AND_OP(OP,N,T,EXT) \\\n \t.global\t__sync_fetch_and_##OP##_##N; \\\n \tHIDDEN_FUNC(__sync_fetch_and_##OP##_##N); \\\n@@ -135,6 +157,66 @@ ATOMIC_FETCH_AND_COMBOP(nand,and,not,1,b,extu.b)\n ATOMIC_FETCH_AND_COMBOP(nand,and,not,2,w,extu.w)\n ATOMIC_FETCH_AND_COMBOP(nand,and,not,4,l,mov)\n \n+#define ATOMIC_OP_AND_FETCH(OP,N,T,EXT) \\\n+\t.global\t__sync_##OP##_and_fetch_##N; \\\n+\tHIDDEN_FUNC(__sync_##OP##_and_fetch_##N); \\\n+\t.align\t2; \\\n+__sync_##OP##_and_fetch_##N:; \\\n+\tmova\t1f, r0; \\\n+\tnop; \\\n+\tmov\tr15, r1; \\\n+\tmov\t#(0f-1f), r15; \\\n+0:\tmov.##T\t@r4, r2; \\\n+\tmov\tr5, r3; \\\n+\tOP\tr2, r3; \\\n+\tmov.##T\tr3, @r4; \\\n+1:\tmov\tr1, r15; \\\n+\trts; \\\n+\t EXT\tr3, r0; \\\n+\tENDFUNC(__sync_##OP##_and_fetch_##N)\n+\n+ATOMIC_OP_AND_FETCH(add,1,b,extu.b)\n+ATOMIC_OP_AND_FETCH(add,2,w,extu.w)\n+ATOMIC_OP_AND_FETCH(add,4,l,mov)\n+\n+ATOMIC_OP_AND_FETCH(or,1,b,extu.b)\n+ATOMIC_OP_AND_FETCH(or,2,w,extu.w)\n+ATOMIC_OP_AND_FETCH(or,4,l,mov)\n+\n+ATOMIC_OP_AND_FETCH(and,1,b,extu.b)\n+ATOMIC_OP_AND_FETCH(and,2,w,extu.w)\n+ATOMIC_OP_AND_FETCH(and,4,l,mov)\n+\n+ATOMIC_OP_AND_FETCH(xor,1,b,extu.b)\n+ATOMIC_OP_AND_FETCH(xor,2,w,extu.w)\n+ATOMIC_OP_AND_FETCH(xor,4,l,mov)\n+\n+#define ATOMIC_COMBOP_AND_FETCH(OP,OP0,OP1,N,T,EXT) \\\n+\t.global\t__sync_##OP##_and_fetch_##N; \\\n+\tHIDDEN_FUNC(__sync_##OP##_and_fetch_##N); \\\n+\t.align\t2; \\\n+__sync_##OP##_and_fetch_##N:; \\\n+\tmova\t1f, r0; \\\n+\tmov\tr15, r1; \\\n+\tmov\t#(0f-1f), r15; \\\n+0:\tmov.##T\t@r4, r2; \\\n+\tmov\tr5, r3; \\\n+\tOP0\tr2, r3; \\\n+\tOP1\tr3, r3; \\\n+\tmov.##T\tr3, @r4; \\\n+1:\tmov\tr1, r15; \\\n+\trts; \\\n+\t EXT\tr3, r0; \\\n+\tENDFUNC(__sync_##OP##_and_fetch_##N)\n+\n+ATOMIC_COMBOP_AND_FETCH(sub,sub,neg,1,b,extu.b)\n+ATOMIC_COMBOP_AND_FETCH(sub,sub,neg,2,w,extu.w)\n+ATOMIC_COMBOP_AND_FETCH(sub,sub,neg,4,l,mov)\n+\n+ATOMIC_COMBOP_AND_FETCH(nand,and,not,1,b,extu.b)\n+ATOMIC_COMBOP_AND_FETCH(nand,and,not,2,w,extu.w)\n+ATOMIC_COMBOP_AND_FETCH(nand,and,not,4,l,mov)\n+\n .section .note.GNU-stack,\"\",%progbits\n .previous\n "}]}