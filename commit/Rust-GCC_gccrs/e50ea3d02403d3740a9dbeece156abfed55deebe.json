{"sha": "e50ea3d02403d3740a9dbeece156abfed55deebe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTUwZWEzZDAyNDAzZDM3NDBhOWRiZWVjZTE1NmFiZmVkNTVkZWViZQ==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-11-02T19:26:16Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-11-02T19:26:16Z"}, "message": "(sys/stat.h) Fix fchmod prototype, first arg is int, not char * [AIX 3.2.4].\n\n(rpc/svc.h): Avoid nested comments [Ultrix 4.3].\n(stdio.h, stdlib.h): Fixed getopt prototypes to match POSIX.2\n[DEC Alpha OSF/1 1.3].\n\nFix <sys/limits.h> like <limits.h>.\n\nFrom-SVN: r5974", "tree": {"sha": "e7a1a85c3340780f7726cc1b08690f57f2b80a86", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e7a1a85c3340780f7726cc1b08690f57f2b80a86"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e50ea3d02403d3740a9dbeece156abfed55deebe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e50ea3d02403d3740a9dbeece156abfed55deebe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e50ea3d02403d3740a9dbeece156abfed55deebe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e50ea3d02403d3740a9dbeece156abfed55deebe/comments", "author": null, "committer": null, "parents": [{"sha": "7f7d6d64327e5d5e903f70acf184a503f4f76222", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f7d6d64327e5d5e903f70acf184a503f4f76222", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f7d6d64327e5d5e903f70acf184a503f4f76222"}], "stats": {"total": 119, "additions": 89, "deletions": 30}, "files": [{"sha": "d34dee3dd23c2bb9abfd8fda0467b16fb462a9d7", "filename": "gcc/fixincludes", "status": "modified", "additions": 89, "deletions": 30, "changes": 119, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e50ea3d02403d3740a9dbeece156abfed55deebe/gcc%2Ffixincludes", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e50ea3d02403d3740a9dbeece156abfed55deebe/gcc%2Ffixincludes", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixincludes?ref=e50ea3d02403d3740a9dbeece156abfed55deebe", "patch": "@@ -1002,6 +1002,25 @@ if [ -r ${LIB}/$file ]; then\n   fi\n fi\n \n+# Wrong fchmod prototype on RS/6000.\n+file=sys/stat.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/sys 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+  chmod a+r ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file, fchmod prototype\n+  sed -e 's/fchmod(char \\*/fchmod(int/' \\\n+    ${LIB}/$file > ${LIB}/$file.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n # NeXT 2.0 defines 'int wait(union wait*)', which conflicts with Posix.1.\n # Note that version 3 of the NeXT system has wait.h in a different directory,\n # so that this code won't do anything.  But wait.h in version 3 has a\n@@ -1086,57 +1105,78 @@ if [ -r ${LIB}/$file ]; then\n   fi\n fi\n \n+# Avoid nested comments on Ultrix 4.3.\n+file=rpc/svc.h\n+if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+  mkdir ${LIB}/rpc 2>/dev/null\n+  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+  chmod +w ${LIB}/$file 2>/dev/null\n+  chmod a+r ${LIB}/$file 2>/dev/null\n+fi\n+\n+if [ -r ${LIB}/$file ]; then\n+  echo Fixing $file, nested comment\n+  sed -e 's@^\\( \\*\tint protocol;  \\)/\\*@\\1*/ /*@' \\\n+    ${LIB}/$file > ${LIB}/$file.sed\n+  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+    rm -f ${LIB}/$file\n+  fi\n+fi\n+\n # In limits.h, put #ifndefs around things that are supposed to be defined\n # in float.h to avoid redefinition errors if float.h is included first.\n # On HP/UX this patch does not work, because on HP/UX limits.h uses\n # multi line comments and the inserted #endif winds up inside the\n # comment.  Fortunately, HP/UX already uses #ifndefs in limits.h; if\n # we find a #ifndef FLT_MIN we assume that all the required #ifndefs\n # are there, and we do not add them ourselves.\n-file=limits.h\n-if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n-  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n-  chmod +w ${LIB}/$file 2>/dev/null\n-  chmod a+r ${LIB}/$file 2>/dev/null\n-fi\n+for file in limits.h sys/limits.h; do\n+  if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+    mkdir ${LIB}/sys 2>/dev/null\n+    cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+    chmod +w ${LIB}/$file 2>/dev/null\n+    chmod a+r ${LIB}/$file 2>/dev/null\n+  fi\n \n-if [ -r ${LIB}/$file ]; then\n-  if egrep 'ifndef[ \t]+FLT_MIN' ${LIB}/$file >/dev/null; then\n-    true\n-  else\n-    echo Fixing $file\n-    sed -e '/[ \t]FLT_MIN[ \t]/i\\\n+  if [ -r ${LIB}/$file ]; then\n+    if egrep 'ifndef[ \t]+FLT_MIN' ${LIB}/$file >/dev/null; then\n+      true\n+    else\n+      echo Fixing $file\n+      sed -e '/[ \t]FLT_MIN[ \t]/i\\\n #ifndef FLT_MIN'\\\n-        -e '/[ \t]FLT_MIN[ \t]/a\\\n+\t  -e '/[ \t]FLT_MIN[ \t]/a\\\n #endif'\\\n-        -e '/[ \t]FLT_MAX[ \t]/i\\\n+\t  -e '/[ \t]FLT_MAX[ \t]/i\\\n #ifndef FLT_MAX'\\\n-        -e '/[ \t]FLT_MAX[ \t]/a\\\n+\t  -e '/[ \t]FLT_MAX[ \t]/a\\\n #endif'\\\n-        -e '/[ \t]FLT_DIG[ \t]/i\\\n+\t  -e '/[ \t]FLT_DIG[ \t]/i\\\n #ifndef FLT_DIG'\\\n-        -e '/[ \t]FLT_DIG[ \t]/a\\\n+\t  -e '/[ \t]FLT_DIG[ \t]/a\\\n #endif'\\\n-        -e '/[ \t]DBL_MIN[ \t]/i\\\n+\t  -e '/[ \t]DBL_MIN[ \t]/i\\\n #ifndef DBL_MIN'\\\n-        -e '/[ \t]DBL_MIN[ \t]/a\\\n+\t  -e '/[ \t]DBL_MIN[ \t]/a\\\n #endif'\\\n-        -e '/[ \t]DBL_MAX[ \t]/i\\\n+\t  -e '/[ \t]DBL_MAX[ \t]/i\\\n #ifndef DBL_MAX'\\\n-        -e '/[ \t]DBL_MAX[ \t]/a\\\n+\t  -e '/[ \t]DBL_MAX[ \t]/a\\\n #endif'\\\n-        -e '/[ \t]DBL_DIG[ \t]/i\\\n+\t  -e '/[ \t]DBL_DIG[ \t]/i\\\n #ifndef DBL_DIG'\\\n-        -e '/[ \t]DBL_DIG[ \t]/a\\\n+\t  -e '/[ \t]DBL_DIG[ \t]/a\\\n #endif'\\\n-      ${LIB}/$file > ${LIB}/${file}.sed\n-    rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n-  fi\n-  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n-    echo Deleting ${LIB}/$file\\; no fixes were needed.\n-    rm -f ${LIB}/$file\n+\t${LIB}/$file > ${LIB}/${file}.sed\n+      rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+    fi\n+    if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+      echo Deleting ${LIB}/$file\\; no fixes were needed.\n+      rm -f ${LIB}/$file\n+    fi\n   fi\n-fi\n+done\n \n # In math.h, put #ifndefs around things that might be defined in a gcc\n # specific math-*.h file.\n@@ -1198,6 +1238,25 @@ if [ -r ${LIB}/$file ]; then\n   fi\n fi\n \n+# Fix getopt declarations in stdio.h and stdlib.h on Alpha OSF/1.\n+for file in stdio.h stdlib.h; do\n+  if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+    cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+    chmod +w ${LIB}/$file 2>/dev/null\n+    chmod a+r ${LIB}/$file 2>/dev/null\n+  fi\n+\n+  if [ -r ${LIB}/$file ]; then\n+    echo Fixing $file, getopt declaration\n+    sed -e 's/getopt(int, char \\*\\[\\],char \\*)/getopt(int, char *const[], const char *)/' \\\n+      ${LIB}/$file > ${LIB}/${file}.sed\n+    rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+    if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+      rm -f ${LIB}/$file\n+    fi\n+  fi\n+done\n+\n # These two files on SunOS 4 are included by other files\n # in the same directory, using \"...\".  So we must make sure they exist\n # in the same directory as the other fixed files."}]}