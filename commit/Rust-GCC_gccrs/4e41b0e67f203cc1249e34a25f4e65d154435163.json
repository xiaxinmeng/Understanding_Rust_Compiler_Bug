{"sha": "4e41b0e67f203cc1249e34a25f4e65d154435163", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGU0MWIwZTY3ZjIwM2NjMTI0OWUzNGEyNWY0ZTY1ZDE1NDQzNTE2Mw==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@adacore.com", "date": "2017-01-12T15:57:45Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2017-01-12T15:57:45Z"}, "message": "* gcc-interface/Makefile.in: Clean up VxWorks targets.\n\nFrom-SVN: r244367", "tree": {"sha": "148633a649ebff7f529b327414e7e7534a89eef5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/148633a649ebff7f529b327414e7e7534a89eef5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4e41b0e67f203cc1249e34a25f4e65d154435163", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e41b0e67f203cc1249e34a25f4e65d154435163", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e41b0e67f203cc1249e34a25f4e65d154435163", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e41b0e67f203cc1249e34a25f4e65d154435163/comments", "author": {"login": "ArnaudCharlet", "id": 30291825, "node_id": "MDQ6VXNlcjMwMjkxODI1", "avatar_url": "https://avatars.githubusercontent.com/u/30291825?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ArnaudCharlet", "html_url": "https://github.com/ArnaudCharlet", "followers_url": "https://api.github.com/users/ArnaudCharlet/followers", "following_url": "https://api.github.com/users/ArnaudCharlet/following{/other_user}", "gists_url": "https://api.github.com/users/ArnaudCharlet/gists{/gist_id}", "starred_url": "https://api.github.com/users/ArnaudCharlet/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ArnaudCharlet/subscriptions", "organizations_url": "https://api.github.com/users/ArnaudCharlet/orgs", "repos_url": "https://api.github.com/users/ArnaudCharlet/repos", "events_url": "https://api.github.com/users/ArnaudCharlet/events{/privacy}", "received_events_url": "https://api.github.com/users/ArnaudCharlet/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0289a8d7ef1288cc9b2be36b3080981c9fac839e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0289a8d7ef1288cc9b2be36b3080981c9fac839e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0289a8d7ef1288cc9b2be36b3080981c9fac839e"}], "stats": {"total": 79, "additions": 52, "deletions": 27}, "files": [{"sha": "04e5b8ad45a9b919c7cf124ea4909d5fe4d786b2", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e41b0e67f203cc1249e34a25f4e65d154435163/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e41b0e67f203cc1249e34a25f4e65d154435163/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=4e41b0e67f203cc1249e34a25f4e65d154435163", "patch": "@@ -1,3 +1,7 @@\n+2017-01-12  Arnaud Charlet  <charlet@adacore.com>\n+\n+\t* gcc-interface/Makefile.in: Clean up VxWorks targets.\n+\n 2017-01-12  Ed Schonberg  <schonberg@adacore.com>\n \n \t* sem_attr.adb (Analyze_Attribute_Reference, case Loop_Entry):"}, {"sha": "c90abe2c6e068edd68047fa466a6d8c118756c0a", "filename": "gcc/ada/gcc-interface/Makefile.in", "status": "modified", "additions": 48, "deletions": 27, "changes": 75, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e41b0e67f203cc1249e34a25f4e65d154435163/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e41b0e67f203cc1249e34a25f4e65d154435163/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMakefile.in?ref=4e41b0e67f203cc1249e34a25f4e65d154435163", "patch": "@@ -435,6 +435,7 @@ X86_64_TARGET_PAIRS = \\\n   a-numaux.adb<a-numaux-x86.adb \\\n   s-atocou.adb<s-atocou-builtin.adb\n \n+# Shared library version\n LIB_VERSION = $(strip $(shell grep ' Library_Version :' $(fsrcpfx)ada/gnatvsn.ads | sed -e 's/.*\"\\(.*\\)\".*/\\1/'))\n \n # Additionnal object files from C source to be added to libgnat.\n@@ -496,8 +497,8 @@ ifeq ($(strip $(filter-out m68k% wrs vx%,$(target_cpu) $(target_vendor) $(target\n \n   TOOLS_TARGET_PAIRS=mlib-tgt-specific.adb<mlib-tgt-specific-vxworks.adb\n \n-  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o\n-  EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o s-stchop.o\n+  EXTRA_GNATRTL_TASKING_OBJS=i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=vx_stack_info.o\n \n@@ -512,7 +513,7 @@ ifeq ($(strip $(filter-out m68k% wrs vx%,$(target_cpu) $(target_vendor) $(target\n endif\n \n # PowerPC and e500v2 VxWorks\n-ifeq ($(strip $(filter-out powerpc% wrs vxworks vxworks7,$(target_cpu) $(target_vendor) $(target_os))),)\n+ifeq ($(strip $(filter-out powerpc% wrs vxworks vxworksspe vxworks7 vxworks7spe,$(target_cpu) $(target_vendor) $(target_os))),)\n \n   ifeq ($(strip $(filter-out e500%, $(target_alias))),)\n      ARCH_STR=e500\n@@ -558,6 +559,7 @@ ifeq ($(strip $(filter-out powerpc% wrs vxworks vxworks7,$(target_cpu) $(target_\n     LIBGNAT_TARGET_PAIRS += \\\n       s-stchop.ads<s-stchop-limit.ads \\\n       s-stchop.adb<s-stchop-vxworks.adb\n+    EXTRA_GNATRTL_NONTASKING_OBJS+=s-stchop.o\n   endif\n \n   TOOLS_TARGET_PAIRS=\\\n@@ -620,7 +622,8 @@ ifeq ($(strip $(filter-out powerpc% wrs vxworks vxworks7,$(target_cpu) $(target_\n           system.ads<system-vxworks-ppc.ads\n         endif\n       endif\n-      EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o\n+      EXTRA_GNATRTL_NONTASKING_OBJS=i-vxinco.o i-vxwork.o i-vxwoio.o\n+      EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n     endif\n   endif\n \n@@ -632,7 +635,13 @@ ifeq ($(strip $(filter-out powerpc% wrs vxworks vxworks7,$(target_cpu) $(target_\n   EXTRA_LIBGNAT_SRCS+=vx_crtbegin.inc\n   GCC_SPEC_FILES+=vxworks-gnat-crtbe-link.spec\n \n-  GCC_SPEC_FILES+=vxworks-$(ARCH_STR)-link.spec\n+  ifeq ($(strip $(filter-out vxworks7%, $(target_os))),)\n+    GCC_SPEC_FILES+=vxworks7-rtp-base-link.spec\n+  else\n+    GCC_SPEC_FILES+=vxworks-$(ARCH_STR)-link.spec\n+    GCC_SPEC_FILES+=vxworks-cert-$(ARCH_STR)-link.spec\n+    GCC_SPEC_FILES+=vxworks-smp-$(ARCH_STR)-link.spec\n+  endif\n endif\n \n # PowerPC and e500v2 VxWorks 653\n@@ -677,7 +686,7 @@ ifeq ($(strip $(filter-out powerpc% wrs vxworksae,$(target_cpu) $(target_vendor)\n   indepsw.adb<indepsw-gnu.adb\n \n   EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o\n-  EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_TASKING_OBJS=i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=sigtramp-vxworks.o\n   EXTRA_LIBGNAT_SRCS+=$(VX_SIGTRAMP_EXTRA_SRCS)\n@@ -743,8 +752,9 @@ ifeq ($(strip $(filter-out powerpc% wrs vxworksmils,$(target_cpu) $(target_vendo\n   mlib-tgt-specific.adb<mlib-tgt-specific-vxworks.adb \\\n   indepsw.adb<indepsw-gnu.adb\n \n-  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o s-thread.o s-osvers.o\n-  EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o \\\n+    s-thread.o s-osvers.o s-stchop.o\n+  EXTRA_GNATRTL_TASKING_OBJS=i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=vx_stack_info.o\n \n@@ -798,7 +808,7 @@ ifeq ($(strip $(filter-out %86 wrs vxworksae,$(target_cpu) $(target_vendor) $(ta\n   indepsw.adb<indepsw-gnu.adb\n \n   EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o s-thread.o\n-  EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_TASKING_OBJS=i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=vx_stack_info.o\n   GNATRTL_SOCKETS_OBJS =\n@@ -875,8 +885,8 @@ ifeq ($(strip $(filter-out sparc% wrs vx%,$(target_cpu) $(target_vendor) $(targe\n     s-vxwext.adb<s-vxwext-kernel.adb\n   endif\n \n-  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o\n-  EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o s-stchop.o\n+  EXTRA_GNATRTL_TASKING_OBJS=i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=vx_stack_info.o\n endif\n@@ -894,10 +904,10 @@ ifeq ($(strip $(filter-out %86 x86_64 wrs vxworks vxworks7,$(target_cpu) $(targe\n \n   ifeq ($(strip $(filter-out x86_64, $(target_cpu))),)\n      X86CPU=x86_64\n-     LIBGNAT_TARGET_PAIRS=$(X86_64_TARGET_PAIRS)\n+     LIBGNAT_TARGET_PAIRS=s-atocou.adb<s-atocou-builtin.adb\n   else\n      X86CPU=x86\n-     LIBGNAT_TARGET_PAIRS=$(X86_TARGET_PAIRS)\n+     LIBGNAT_TARGET_PAIRS=s-atocou.adb<s-atocou-x86.adb\n   endif\n \n   LIBGNAT_TARGET_PAIRS+= \\\n@@ -1023,9 +1033,9 @@ ifeq ($(strip $(filter-out %86 x86_64 wrs vxworks vxworks7,$(target_cpu) $(targe\n     endif\n   endif\n \n-  EXTRA_GNATRTL_NONTASKING_OBJS += \\\n+  EXTRA_GNATRTL_NONTASKING_OBJS += s-stchop.o \\\n     $(CERTMATH_GNATRTL_OBJS) $(CERTMATH_GNATRTL_X86TRA_OBJS)\n-  EXTRA_GNATRTL_TASKING_OBJS += s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_TASKING_OBJS += i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=vx_stack_info.o\n \n@@ -1036,7 +1046,9 @@ ifeq ($(strip $(filter-out %86 x86_64 wrs vxworks vxworks7,$(target_cpu) $(targe\n   EXTRA_LIBGNAT_SRCS+=vx_crtbegin.inc\n   GCC_SPEC_FILES+=vxworks-gnat-crtbe-link.spec\n \n-  ifneq ($(strip $(filter-out vxworks7%, $(target_os))),)\n+  ifeq ($(strip $(filter-out vxworks7%, $(target_os))),)\n+    GCC_SPEC_FILES+=vxworks7-$(X86CPU)-rtp-base-link.spec\n+  else\n     GCC_SPEC_FILES+=vxworks-x86-link.spec\n     GCC_SPEC_FILES+=vxworks-cert-x86-link.spec\n     GCC_SPEC_FILES+=vxworks-smp-x86-link.spec\n@@ -1123,12 +1135,15 @@ ifeq ($(strip $(filter-out arm% coff wrs vx%,$(target_cpu) $(target_vendor) $(ta\n     endif\n   endif\n \n-  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o\n-  EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o $(CERTMATH_GNATRTL_OBJS) \\\n+    s-stchop.o\n+  EXTRA_GNATRTL_TASKING_OBJS=i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=vx_stack_info.o\n \n-  ifneq (-arm,$(EH_MECHANISM))\n+  ifeq ($(strip $(filter-out vxworks7%, $(target_os))),)\n+    GCC_SPEC_FILES+=vxworks7-rtp-base-link.spec\n+  else\n     EXTRA_ADALIB_OBJS+=$(VX_CRTBE_EXTRA_ADALIB_OBJS)\n     EXTRA_LIBGNAT_SRCS+=vx_crtbegin.inc\n     GCC_SPEC_FILES+=vxworks-gnat-crtbe-link.spec\n@@ -1202,8 +1217,8 @@ ifeq ($(strip $(filter-out mips% wrs vx%,$(target_cpu) $(target_vendor) $(target\n     endif\n   endif\n \n-  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o\n-  EXTRA_GNATRTL_TASKING_OBJS=s-vxwork.o s-vxwext.o\n+  EXTRA_GNATRTL_NONTASKING_OBJS=i-vxwork.o i-vxwoio.o s-stchop.o\n+  EXTRA_GNATRTL_TASKING_OBJS=i-vxinco.o s-vxwork.o s-vxwext.o\n \n   EXTRA_LIBGNAT_OBJS+=vx_stack_info.o\n endif\n@@ -1255,7 +1270,7 @@ ifeq ($(strip $(filter-out sparc% sun solaris%,$(target_cpu) $(target_vendor) $(\n   s-tpopsp.adb<s-tpopsp-solaris.adb \\\n   g-soliop.ads<g-soliop-solaris.ads \\\n   $(ATOMICS_TARGET_PAIRS) \\\n-  $(ATOMICS_BUILTINS_TARGET_PAIRS) \\\n+  $(ATOMICS_BUILTINS_TARGET_PAIRS)\n   system.ads<system-solaris-sparc.ads\n \n   TOOLS_TARGET_PAIRS=mlib-tgt-specific.adb<mlib-tgt-specific-solaris.adb\n@@ -1889,6 +1904,7 @@ ifeq ($(strip $(filter-out powerpc% linux%,$(target_cpu) $(target_os))),)\n     indepsw.adb<indepsw-gnu.adb\n \n   EXTRA_GNATRTL_TASKING_OBJS=s-linux.o a-exetim.o\n+\n   EH_MECHANISM=-gcc\n   THREADSLIB = -lpthread -lrt\n   GNATLIB_SHARED = gnatlib-shared-dual\n@@ -2219,6 +2235,7 @@ ifeq ($(strip $(filter-out %x86_64 linux%,$(target_cpu) $(target_os))),)\n \n   EXTRA_GNATRTL_NONTASKING_OBJS += g-sse.o g-ssvety.o\n   EXTRA_GNATRTL_TASKING_OBJS=s-linux.o a-exetim.o\n+\n   EH_MECHANISM=-gcc\n   THREADSLIB=-lpthread -lrt\n   MISCLIB = -ldl\n@@ -2443,7 +2460,8 @@ ADA_EXCLUDE_SRCS =\\\n   g-allein.ads g-alleve.adb g-alleve.ads g-altcon.adb g-altcon.ads \\\n   g-altive.ads g-alveop.adb g-alveop.ads g-alvety.ads g-alvevi.ads \\\n   g-intpri.ads g-regist.adb g-regist.ads g-sse.ads    g-ssvety.ads \\\n-  i-vxwoio.adb i-vxwoio.ads i-vxwork.ads i-bit_types.ads \\\n+  i-vxinco.adb i-vxinco.ads i-vxwoio.adb i-vxwoio.ads i-vxwork.ads \\\n+  i-bit_types.ads \\\n   s-bb.ads     s-bbbosu.ads s-bbcaco.ads s-bbcppr.ads s-bbexti.adb \\\n   s-bbexti.ads s-bbinte.adb s-bbinte.ads s-bbprot.adb s-bbprot.ads \\\n   s-bbsle3.ads s-bbsuer.ads s-bbsule.ads s-bbthqu.adb s-bbthqu.ads \\\n@@ -2455,7 +2473,8 @@ ADA_EXCLUDE_SRCS =\\\n   s-memcom.adb s-memcom.ads s-memmov.adb s-memmov.ads s-memset.adb \\\n   s-memset.ads s-mufalo.adb s-mufalo.ads s-musplo.adb s-musplo.ads \\\n   s-sam4.ads   s-sopco3.adb s-sopco3.ads s-sopco4.adb s-sopco4.ads \\\n-  s-sopco5.adb s-sopco5.ads s-stache.adb s-stache.ads s-stm32.ads \\\n+  s-sopco5.adb s-sopco5.ads s-stchop.ads s-stchop.adb \\\n+  s-stm32.ads \\\n   s-strcom.adb s-strcom.ads s-thread.ads \\\n   s-vxwexc.adb s-vxwexc.ads s-vxwext.adb s-vxwext.ads \\\n   s-win32.ads  s-winext.ads\n@@ -2625,9 +2644,9 @@ gnatlink-re: ../stamp-tools gnatmake-re\n install-gcc-specs:\n #\tInstall all the requested GCC spec files.\n \n-\t$(foreach f,$(GCC_SPEC_FILES), \\\n-\t    $(INSTALL_DATA_DATE) $(srcdir)/ada/$(f) \\\n-\t    $(DESTDIR)$(libsubdir)/$$(echo $(f)|sed -e 's#_[a-zA-Z0-9]*##g');)\n+\tfor f in $(GCC_SPEC_FILES); do \\\n+\t    $(INSTALL_DATA_DATE) $(srcdir)/ada/$$f $(libsubdir)/; \\\n+\tdone\n \n install-gnatlib: ../stamp-gnatlib-$(RTSDIR) install-gcc-specs\n \t$(RMDIR) $(DESTDIR)$(ADA_RTL_OBJ_DIR)\n@@ -2904,6 +2923,8 @@ gnatlib-shared-darwin:\n \t     THREAD_KIND=\"$(THREAD_KIND)\" \\\n \t     gnatlib\n \t$(RM) $(RTSDIR)/libgnat$(soext) $(RTSDIR)/libgnarl$(soext)\n+\t$(CP) $(RTSDIR)/libgnat$(arext) $(RTSDIR)/libgnat_pic$(arext)\n+\t$(CP) $(RTSDIR)/libgnarl$(arext) $(RTSDIR)/libgnarl_pic$(arext)\n \tcd $(RTSDIR); `echo \"$(GCC_FOR_TARGET)\" \\\n                 | sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'` -dynamiclib $(PICFLAG_FOR_TARGET) \\\n \t\t-o libgnat$(hyphen)$(LIBRARY_VERSION)$(soext) \\"}]}