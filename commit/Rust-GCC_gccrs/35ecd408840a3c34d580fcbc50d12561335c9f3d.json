{"sha": "35ecd408840a3c34d580fcbc50d12561335c9f3d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzVlY2Q0MDg4NDBhM2MzNGQ1ODBmY2JjNTBkMTI1NjEzMzVjOWYzZA==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2009-09-08T18:35:24Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2009-09-08T18:35:24Z"}, "message": "tree-ssa-sccvn.c (vn_reference_lookup_3): Don't assume there are more VR->OPERANDS than LHS operands.\n\n* tree-ssa-sccvn.c (vn_reference_lookup_3): Don't assume there are\n        more VR->OPERANDS than LHS operands.  Free LHS before returning.\n\nFrom-SVN: r151530", "tree": {"sha": "063410287f85d829f224db16474ae551771ca2ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/063410287f85d829f224db16474ae551771ca2ef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35ecd408840a3c34d580fcbc50d12561335c9f3d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35ecd408840a3c34d580fcbc50d12561335c9f3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35ecd408840a3c34d580fcbc50d12561335c9f3d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35ecd408840a3c34d580fcbc50d12561335c9f3d/comments", "author": null, "committer": null, "parents": [{"sha": "3e5e84be5a2a8ecb0dc9db24593d4d586140cbec", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e5e84be5a2a8ecb0dc9db24593d4d586140cbec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e5e84be5a2a8ecb0dc9db24593d4d586140cbec"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "6ed406a6908701edd09280c970df384f9c5b09a3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35ecd408840a3c34d580fcbc50d12561335c9f3d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35ecd408840a3c34d580fcbc50d12561335c9f3d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=35ecd408840a3c34d580fcbc50d12561335c9f3d", "patch": "@@ -89,6 +89,11 @@\n \t(remove_from_deps): Also remove calls from\n \tlast_function_call_may_noreturn list.\n \n+2009-09-07  Richard Henderson  <rth@redhat.com>\n+\n+\t* tree-ssa-sccvn.c (vn_reference_lookup_3): Don't assume there are\n+\tmore VR->OPERANDS than LHS operands.  Free LHS before returning.\n+\n 2009-09-07  Bernd Schmidt  <bernd.schmidt@analog.com>\n \n \t* config/bfin/bfin.md (UNSPEC_VOLATILE_STALL): New constant."}, {"sha": "255e8a533b87a165dbafa9aaa0575b0fc859ab33", "filename": "gcc/tree-ssa-sccvn.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35ecd408840a3c34d580fcbc50d12561335c9f3d/gcc%2Ftree-ssa-sccvn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35ecd408840a3c34d580fcbc50d12561335c9f3d/gcc%2Ftree-ssa-sccvn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-sccvn.c?ref=35ecd408840a3c34d580fcbc50d12561335c9f3d", "patch": "@@ -1120,21 +1120,22 @@ vn_reference_lookup_3 (ao_ref *ref, tree vuse, void *vr_)\n       copy_reference_ops_from_ref (gimple_assign_lhs (def_stmt), &lhs);\n       i = VEC_length (vn_reference_op_s, vr->operands) - 1;\n       j = VEC_length (vn_reference_op_s, lhs) - 1;\n-      while (j >= 0\n+      while (j >= 0 && i >= 0\n \t     && vn_reference_op_eq (VEC_index (vn_reference_op_s,\n \t\t\t\t\t       vr->operands, i),\n \t\t\t\t    VEC_index (vn_reference_op_s, lhs, j)))\n \t{\n \t  i--;\n \t  j--;\n \t}\n+\n+      VEC_free (vn_reference_op_s, heap, lhs);\n       /* i now points to the first additional op.\n \t ???  LHS may not be completely contained in VR, one or more\n \t VIEW_CONVERT_EXPRs could be in its way.  We could at least\n \t try handling outermost VIEW_CONVERT_EXPRs.  */\n       if (j != -1)\n \treturn (void *)-1;\n-      VEC_free (vn_reference_op_s, heap, lhs);\n \n       /* Now re-write REF to be based on the rhs of the assignment.  */\n       copy_reference_ops_from_ref (gimple_assign_rhs1 (def_stmt), &rhs);"}]}