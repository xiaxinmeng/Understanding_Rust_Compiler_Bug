{"sha": "3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2NkYWJlM2IwNmJmZjlkYzA1MWFhNWJhNmY5MDU2YmRjOGU3NDNiNg==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2010-02-05T08:28:24Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2010-02-05T08:28:24Z"}, "message": "re PR c++/42915 (ICE: same canonical type node for different types in recent builds)\n\nFix PR c++/42915\n\ngcc/cp/ChangeLog:\n\tPR c++/42915\n\t* typeck.c (get_template_parms_of_dependent_type): Try getting\n\tthe template parameters fromt the type itself first.\n\ngcc/testsuite/ChangeLog:\n\tPR c++/42915\n\tg++.dg/other/crash-9.C: New test.\n\nFrom-SVN: r156514", "tree": {"sha": "8b5b4721fdc94bb4b1c75d09141fc2ef0055594c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8b5b4721fdc94bb4b1c75d09141fc2ef0055594c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/comments", "author": null, "committer": null, "parents": [{"sha": "430f2d1f6fcde2ccbf5ae935e15e13f0bb3e8c4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/430f2d1f6fcde2ccbf5ae935e15e13f0bb3e8c4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/430f2d1f6fcde2ccbf5ae935e15e13f0bb3e8c4c"}], "stats": {"total": 32, "additions": 31, "deletions": 1}, "files": [{"sha": "893bd9d00e40093b5d7f4c328c836887f47a005b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "patch": "@@ -1,3 +1,9 @@\n+2010-02-05  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/42915\n+\t* typeck.c (get_template_parms_of_dependent_type): Try getting\n+\tthe template parameters fromt the type itself first.\n+\n 2010-02-03  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/4926"}, {"sha": "18d56f4bfa3abaff7cf91bc60f6c0ef66095321b", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "patch": "@@ -1106,9 +1106,13 @@ get_template_parms_of_dependent_type (tree t)\n {\n   tree tinfo = NULL_TREE, tparms = NULL_TREE;\n \n+  /* First, try the obvious case of getting the\n+     template info from T itself.  */\n+  if ((tinfo = get_template_info (t)))\n+    ;\n   /* If T1 is a typedef or whatever has a template info associated\n      to its context, get the template parameters from that context.  */\n-  if (typedef_variant_p (t)\n+  else if (typedef_variant_p (t)\n       && DECL_CONTEXT (TYPE_NAME (t))\n       && !NAMESPACE_SCOPE_P (TYPE_NAME (t)))\n     tinfo = get_template_info (DECL_CONTEXT (TYPE_NAME (t)));"}, {"sha": "c8a911a63b6e0c0c9dd9a4e4333cae38f10d6274", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "patch": "@@ -1,3 +1,8 @@\n+2010-02-05  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/42915\n+\tg++.dg/other/crash-9.C: New test.\n+\n 2010-02-05  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/42309"}, {"sha": "0953fcbc46b9f64908e0cb7bc917bbe87a08e432", "filename": "gcc/testsuite/g++.dg/other/crash-9.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcrash-9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcrash-9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcrash-9.C?ref=3cdabe3b06bff9dc051aa5ba6f9056bdc8e743b6", "patch": "@@ -0,0 +1,15 @@\n+// Origin: PR c++/42915\n+// { dg-do compile }\n+\n+template <typename T>\n+class A\n+{\n+  template <typename U>\n+  class B\n+  {\n+    B foo();\n+  };\n+};\n+template <typename T> template <typename U>\n+A<T>::B<U> A<T>::B<U>::foo() {}\n+"}]}