{"sha": "73452ce79a0be60509fde8f6f2949aa84b0b7766", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzM0NTJjZTc5YTBiZTYwNTA5ZmRlOGY2ZjI5NDlhYTg0YjBiNzc2Ng==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2011-05-06T08:34:53Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2011-05-06T08:34:53Z"}, "message": "re PR c++/48838 (valid template code does not compile)\n\nFix PR c++/48838\n\ngcc/cp\n\n\tPR c++/48838\n\t* cp-tree.h (non_static_member_function_p): Declare new function.\n\t* tree.c (non_static_member_function_p): Define it.\n\t* semantics.c (finish_call_expr): Use it.\n\ngcc/testsuite\n\n\tPR c++/48838\n\t* g++.dg/template/member9.C: New test case.\n\nFrom-SVN: r173473", "tree": {"sha": "192cba8d3931d0c9f754675ae29696b4a8ad538e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/192cba8d3931d0c9f754675ae29696b4a8ad538e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73452ce79a0be60509fde8f6f2949aa84b0b7766", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73452ce79a0be60509fde8f6f2949aa84b0b7766", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73452ce79a0be60509fde8f6f2949aa84b0b7766", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73452ce79a0be60509fde8f6f2949aa84b0b7766/comments", "author": null, "committer": null, "parents": [{"sha": "155b61760df4ffe4a3dfcbd76da2f987241255b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/155b61760df4ffe4a3dfcbd76da2f987241255b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/155b61760df4ffe4a3dfcbd76da2f987241255b1"}], "stats": {"total": 53, "additions": 51, "deletions": 2}, "files": [{"sha": "dfaaeaa54c1e262037201b8ee504d89b0100702a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=73452ce79a0be60509fde8f6f2949aa84b0b7766", "patch": "@@ -1,3 +1,10 @@\n+2011-05-06  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/48838\n+\t* cp-tree.h (non_static_member_function_p): Declare new function.\n+\t* tree.c (non_static_member_function_p): Define it.\n+\t* semantics.c (finish_call_expr): Use it.\n+\n 2011-05-05  Nathan Froyd  <froydnj@codesourcery.com>\n \n \t* decl.c (finish_case_label): Omit the loc argument to"}, {"sha": "9d13393502d202c5d6e1fa0dc2885212fa936f80", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=73452ce79a0be60509fde8f6f2949aa84b0b7766", "patch": "@@ -5432,6 +5432,7 @@ extern tree get_fns\t\t\t\t(tree);\n extern tree get_first_fn\t\t\t(tree);\n extern tree ovl_cons\t\t\t\t(tree, tree);\n extern tree build_overload\t\t\t(tree, tree);\n+extern bool non_static_member_function_p        (tree);\n extern const char *cxx_printable_name\t\t(tree, int);\n extern const char *cxx_printable_name_translate\t(tree, int);\n extern tree build_exception_variant\t\t(tree, tree);"}, {"sha": "a2b24d3e31d751d8b04477a4ae326f31e53353d5", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=73452ce79a0be60509fde8f6f2949aa84b0b7766", "patch": "@@ -2039,8 +2039,7 @@ finish_call_expr (tree fn, VEC(tree,gc) **args, bool disallow_virtual,\n \t     is not included in *ARGS even though it is considered to\n \t     be part of the list of arguments.  Note that this is\n \t     related to CWG issues 515 and 1005.  */\n-\t  || (((TREE_CODE (TREE_TYPE (fn)) == METHOD_TYPE)\n-\t       || BASELINK_P (fn))\n+\t  || (non_static_member_function_p (fn)\n \t      && current_class_ref\n \t      && type_dependent_expression_p (current_class_ref)))\n \t{"}, {"sha": "d636548895701ba7bd8772fd3be40f2de8205102", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=73452ce79a0be60509fde8f6f2949aa84b0b7766", "patch": "@@ -1480,6 +1480,22 @@ build_overload (tree decl, tree chain)\n   return ovl_cons (decl, chain);\n }\n \n+/* Return TRUE if FN is a non-static member function, FALSE otherwise.\n+   This function looks into BASELINK and OVERLOAD nodes.  */\n+\n+bool\n+non_static_member_function_p (tree fn)\n+{\n+  if (fn == NULL_TREE)\n+    return false;\n+\n+  if (is_overloaded_fn (fn))\n+    fn = get_first_fn (fn);\n+\n+  return (DECL_P (fn)\n+\t  && DECL_NONSTATIC_MEMBER_FUNCTION_P (fn));\n+}\n+\n \f\n #define PRINT_RING_SIZE 4\n "}, {"sha": "3e89c93a1595e8c3663c0470c1df88d4b8a60aaa", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=73452ce79a0be60509fde8f6f2949aa84b0b7766", "patch": "@@ -1,3 +1,8 @@\n+2011-05-06  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/48838\n+\t* g++.dg/template/member9.C: New test case.\n+\n 2011-05-05  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/discr29.ad[sb]: New test."}, {"sha": "f15272db7abaa5f20ebc8319f3f449653579924c", "filename": "gcc/testsuite/g++.dg/template/member9.C", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fmember9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73452ce79a0be60509fde8f6f2949aa84b0b7766/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fmember9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fmember9.C?ref=73452ce79a0be60509fde8f6f2949aa84b0b7766", "patch": "@@ -0,0 +1,21 @@\n+// Origin PR c++/48838\n+// { dg-do compile }\n+\n+class DUChainItemSystem\n+{\n+public:\n+\n+    template<class T>\n+    void registerTypeClass();\n+\n+    static DUChainItemSystem& self();\n+};\n+\n+template<class T>\n+struct DUChainItemRegistrator\n+{\n+    DUChainItemRegistrator()\n+    {\n+        DUChainItemSystem::self().registerTypeClass<T>();\n+    }\n+};"}]}