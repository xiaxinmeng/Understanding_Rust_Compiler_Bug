{"sha": "94887ef4788e211ffcae25f17018099bf75dbab3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTQ4ODdlZjQ3ODhlMjExZmZjYWUyNWYxNzAxODA5OWJmNzVkYmFiMw==", "commit": {"author": {"name": "Francois-Xavier Coudert", "email": "coudert@clipper.ens.fr", "date": "2005-03-25T13:35:29Z"}, "committer": {"name": "Fran\u00e7ois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2005-03-25T13:35:29Z"}, "message": "re PR libfortran/19678 (DOS files don't work for list directed input)\n\n        PR libfortran/19678\n        PR libfortran/19679\n        * gfortran.dg/dos_eol.f: New test.\n\n        PR libfortran/19678\n        * list_read.c (next_char, eat_separator, finish_separator, read_real)\n        (namelist_read): Add support for '\\r' as well as '\\n' as EOL\n        character.\n\n        PR libfortran/19679\n        * list_read.c (read_sf): Add a '\\r' in a test to support DOS\n        line-endings when line length is exceeded.\n\nFrom-SVN: r97041", "tree": {"sha": "d266bc81427627226c9cf0f342c8ef74a86d6d84", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d266bc81427627226c9cf0f342c8ef74a86d6d84"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/94887ef4788e211ffcae25f17018099bf75dbab3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94887ef4788e211ffcae25f17018099bf75dbab3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94887ef4788e211ffcae25f17018099bf75dbab3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94887ef4788e211ffcae25f17018099bf75dbab3/comments", "author": null, "committer": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cd928652255d6203f3223a589fff3eed02995850", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd928652255d6203f3223a589fff3eed02995850", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd928652255d6203f3223a589fff3eed02995850"}], "stats": {"total": 50, "additions": 46, "deletions": 4}, "files": [{"sha": "77095caab4aaa6e13b481d78c4573f7355710e53", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94887ef4788e211ffcae25f17018099bf75dbab3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94887ef4788e211ffcae25f17018099bf75dbab3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=94887ef4788e211ffcae25f17018099bf75dbab3", "patch": "@@ -1,3 +1,9 @@\n+2005-03-25  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n+\n+\tPR libfortran/19678\n+\tPR libfortran/19679\n+\t* gfortran.dg/dos_eol.f: New test.\n+\n 2005-03-25  Zdenek Dvorak  <dvorakz@suse.cz>\n \n \tPR rtl-optimization/20249"}, {"sha": "3a22a14b143f604d4349684a3eff6c76ad3ea09d", "filename": "gcc/testsuite/gfortran.dg/dos_eol.f", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94887ef4788e211ffcae25f17018099bf75dbab3/gcc%2Ftestsuite%2Fgfortran.dg%2Fdos_eol.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94887ef4788e211ffcae25f17018099bf75dbab3/gcc%2Ftestsuite%2Fgfortran.dg%2Fdos_eol.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdos_eol.f?ref=94887ef4788e211ffcae25f17018099bf75dbab3", "patch": "@@ -0,0 +1,19 @@\n+! PR libfortran/19678 and PR libfortran/19679\n+! { dg-do run }\n+      integer i, j\n+      \n+      open (10,status='scratch')\n+      write (10,'(2A)') '1', achar(13)\n+      rewind (10)\n+      read (10,*) i\n+      if (i .ne. 1) call abort\n+      close (10)\n+\n+      open (10,status='scratch')\n+      write (10,'(2A)') '   1', achar(13)\n+      write (10,'(2A)') '   2', achar(13)\n+      rewind (10)\n+      read (10,'(I4)') i\n+      read (10,'(I5)') j\n+      if ((i .ne. 1) .or. (j .ne. 2)) call abort\n+      end"}, {"sha": "32b5454827bfef62696ec44c36e4936851740b4a", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94887ef4788e211ffcae25f17018099bf75dbab3/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94887ef4788e211ffcae25f17018099bf75dbab3/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=94887ef4788e211ffcae25f17018099bf75dbab3", "patch": "@@ -1,3 +1,14 @@\n+2005-03-25  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n+\n+\tPR libfortran/19678\n+\t* list_read.c (next_char, eat_separator, finish_separator, read_real)\n+\t(namelist_read): Add support for '\\r' as well as '\\n' as EOL\n+\tcharacter.\n+\n+\tPR libfortran/19679\n+\t* list_read.c (read_sf): Add a '\\r' in a test to support DOS\n+\tline-endings when line length is exceeded.\n+\n 2005-03-25  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR libfortran/15332"}, {"sha": "384df36f6c42f16d384956d444ac238f7a2f97bf", "filename": "libgfortran/io/list_read.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94887ef4788e211ffcae25f17018099bf75dbab3/libgfortran%2Fio%2Flist_read.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94887ef4788e211ffcae25f17018099bf75dbab3/libgfortran%2Fio%2Flist_read.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Flist_read.c?ref=94887ef4788e211ffcae25f17018099bf75dbab3", "patch": "@@ -66,12 +66,13 @@ static char value[20];\n #define CASE_DIGITS   case '0': case '1': case '2': case '3': case '4': \\\n                       case '5': case '6': case '7': case '8': case '9'\n \n-#define CASE_SEPARATORS  case ' ': case ',': case '/': case '\\n': case '\\t'\n+#define CASE_SEPARATORS  case ' ': case ',': case '/': case '\\n': case '\\t': \\\n+                         case '\\r'\n \n /* This macro assumes that we're operating on a variable.  */\n \n #define is_separator(c) (c == '/' ||  c == ',' || c == '\\n' || c == ' ' \\\n-                         || c == '\\t')\n+                         || c == '\\t' || c == '\\r')\n \n /* Maximum repeat count.  Less than ten times the maximum signed int32.  */\n \n@@ -163,7 +164,7 @@ next_char (void)\n     c = *p;\n \n done:\n-  at_eol = (c == '\\n');\n+  at_eol = (c == '\\n' || c == '\\r');\n   return c;\n }\n \n@@ -230,6 +231,7 @@ eat_separator (void)\n       break;\n \n     case '\\n':\n+    case '\\r':\n       break;\n \n     case '!':\n@@ -284,6 +286,7 @@ finish_separator (void)\n       break;\n \n     case '\\n':\n+    case '\\r':\n       goto restart;\n \n     case '!':\n@@ -1052,6 +1055,8 @@ read_real (int length)\n \t  goto got_repeat;\n \n \tCASE_SEPARATORS:\n+          if (c != '\\n' &&  c != ',' && c != '\\r')\n+            unget_char (c);\n \t  goto done;\n \n \tdefault:\n@@ -1483,6 +1488,7 @@ namelist_read (void)\n           return;\n         case ' ':\n         case '\\n':\n+       case '\\r':\n         case '\\t':\n           break;\n         case ',':"}, {"sha": "aed0aa90dbc8a4f9e4d20a9aa9346ea1c0be21f5", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94887ef4788e211ffcae25f17018099bf75dbab3/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94887ef4788e211ffcae25f17018099bf75dbab3/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=94887ef4788e211ffcae25f17018099bf75dbab3", "patch": "@@ -177,7 +177,7 @@ read_sf (int *length)\n \t  return NULL;\n \t}\n \n-      if (readlen < 1 || *q == '\\n')\n+      if (readlen < 1 || *q == '\\n' || *q == '\\r')\n \t{\n \t  /* ??? What is this for?  */\n           if (current_unit->unit_number == options.stdin_unit)"}]}