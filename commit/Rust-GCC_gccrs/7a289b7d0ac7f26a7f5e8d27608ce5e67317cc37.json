{"sha": "7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2EyODliN2QwYWM3ZjI2YTdmNWU4ZDI3NjA4Y2U1ZTY3MzE3Y2MzNw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2018-12-12T22:49:35Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-12-12T22:49:35Z"}, "message": "re PR fortran/88463 (Rejects conforming source, OpenMP Parallel region Default(None) reference to module parameter array, separate source)\n\n\tPR fortran/88463\n\t* trans-openmp.c (gfc_omp_predetermined_sharing): Handle TREE_READONLY\n\tVAR_DECLs with DECL_EXTERNAL like those with TREE_STATIC.\n\n\t* testsuite/libgomp.fortran/pr88463-1.f90: New test.\n\t* testsuite/libgomp.fortran/pr88463-2.f90: New test.\n\nFrom-SVN: r267069", "tree": {"sha": "99a5b349277ac3b08c6de974105bedd12b412151", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/99a5b349277ac3b08c6de974105bedd12b412151"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "44cacba39d28fcf92f328957be7e20398dee7de2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44cacba39d28fcf92f328957be7e20398dee7de2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/44cacba39d28fcf92f328957be7e20398dee7de2"}], "stats": {"total": 41, "additions": 40, "deletions": 1}, "files": [{"sha": "bb3da68adde8c8492b1ef47c61dc6e9a8493b1bf", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "patch": "@@ -1,3 +1,9 @@\n+2018-12-12  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/88463\n+\t* trans-openmp.c (gfc_omp_predetermined_sharing): Handle TREE_READONLY\n+\tVAR_DECLs with DECL_EXTERNAL like those with TREE_STATIC.\n+\n 2018-12-11  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/88155"}, {"sha": "37acef6837b3966c346bdd9ab43d6b39c8cafb6b", "filename": "gcc/fortran/trans-openmp.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/gcc%2Ffortran%2Ftrans-openmp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/gcc%2Ffortran%2Ftrans-openmp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-openmp.c?ref=7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "patch": "@@ -149,7 +149,8 @@ gfc_omp_predetermined_sharing (tree decl)\n      variables at all (they can't be redefined), but they can nevertheless appear\n      in parallel/task regions and for default(none) purposes treat them as shared.\n      For vtables likely the same handling is desirable.  */\n-  if (VAR_P (decl) && TREE_READONLY (decl) && TREE_STATIC (decl))\n+  if (VAR_P (decl) && TREE_READONLY (decl)\n+      && (TREE_STATIC (decl) || DECL_EXTERNAL (decl)))\n     return OMP_CLAUSE_DEFAULT_SHARED;\n \n   return OMP_CLAUSE_DEFAULT_UNSPECIFIED;"}, {"sha": "c2740f3a9da426d8863af51e6e727128c3e716b9", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "patch": "@@ -1,5 +1,9 @@\n 2018-12-12  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR fortran/88463\n+\t* testsuite/libgomp.fortran/pr88463-1.f90: New test.\n+\t* testsuite/libgomp.fortran/pr88463-2.f90: New test.\n+\n \t* testsuite/libgomp.c-c++-common/for-16.c: New test.\n \n 2018-12-12  Andreas Schwab  <schwab@suse.de>"}, {"sha": "53a99ee7c7f95658d95a1b2bf87cfb0fa29de153", "filename": "libgomp/testsuite/libgomp.fortran/pr88463-1.f90", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr88463-1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr88463-1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr88463-1.f90?ref=7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "patch": "@@ -0,0 +1,19 @@\n+! PR fortran/88463\n+! { dg-do compile { target { ! *-*-* } } }\n+\n+module pr88463_1\n+  integer, parameter :: c = 1\n+  real, parameter :: d(4) = (/ 2, 3, 4, 5 /)\n+end module pr88463_1\n+\n+program pr88463\n+  use pr88463_1\n+  use pr88463_2\n+  integer :: i\n+  real :: j(4)\n+  !$omp parallel default(none) private (i, j)\n+    i = a + b(1) + b(4) + c + d(1) + d(4)\n+    j(1:4) = b(1:4)\n+    j(1:4) = d(1:4)\n+  !$omp end parallel\n+end program pr88463"}, {"sha": "8b2b98ddda1ffc032590223c87cf8ba7a1552d8d", "filename": "libgomp/testsuite/libgomp.fortran/pr88463-2.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr88463-2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr88463-2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr88463-2.f90?ref=7a289b7d0ac7f26a7f5e8d27608ce5e67317cc37", "patch": "@@ -0,0 +1,9 @@\n+! PR fortran/88463\n+! { dg-do link }\n+! { dg-options \"-fopenmp\" }\n+! { dg-additional-sources pr88463-1.f90 }\n+\n+module pr88463_2\n+  integer, parameter :: a = 1\n+  real, parameter :: b(4) = (/ 2., 3., 4., 5. /)\n+end module pr88463_2"}]}