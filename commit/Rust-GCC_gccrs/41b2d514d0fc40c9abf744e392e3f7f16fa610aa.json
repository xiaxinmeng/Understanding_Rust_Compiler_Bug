{"sha": "41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDFiMmQ1MTRkMGZjNDBjOWFiZjc0NGUzOTJlM2Y3ZjE2ZmE2MTBhYQ==", "commit": {"author": {"name": "Andrey Belevantsev", "email": "abel@ispras.ru", "date": "2014-02-25T06:41:08Z"}, "committer": {"name": "Andrey Belevantsev", "email": "abel@gcc.gnu.org", "date": "2014-02-25T06:41:08Z"}, "message": "sel-sched.c (calculate_new_fences): New parameter ptime.\n\n        * sel-sched.c (calculate_new_fences): New parameter ptime.\n        Calculate it as a maximum over all fence cycles.\n        (sel_sched_region_2): Adjust the call to calculate_new_fences.\n        Print the final schedule timing when sched_verbose.\n\nFrom-SVN: r208110", "tree": {"sha": "0068bb8aaccc423c06f3d68481ab581853087486", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0068bb8aaccc423c06f3d68481ab581853087486"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41b2d514d0fc40c9abf744e392e3f7f16fa610aa/comments", "author": {"login": "abonzo", "id": 20396542, "node_id": "MDQ6VXNlcjIwMzk2NTQy", "avatar_url": "https://avatars.githubusercontent.com/u/20396542?v=4", "gravatar_id": "", "url": "https://api.github.com/users/abonzo", "html_url": "https://github.com/abonzo", "followers_url": "https://api.github.com/users/abonzo/followers", "following_url": "https://api.github.com/users/abonzo/following{/other_user}", "gists_url": "https://api.github.com/users/abonzo/gists{/gist_id}", "starred_url": "https://api.github.com/users/abonzo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/abonzo/subscriptions", "organizations_url": "https://api.github.com/users/abonzo/orgs", "repos_url": "https://api.github.com/users/abonzo/repos", "events_url": "https://api.github.com/users/abonzo/events{/privacy}", "received_events_url": "https://api.github.com/users/abonzo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c1c99405c16922201a4d32f4a7d1c3280df7c19c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c1c99405c16922201a4d32f4a7d1c3280df7c19c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c1c99405c16922201a4d32f4a7d1c3280df7c19c"}], "stats": {"total": 32, "additions": 23, "deletions": 9}, "files": [{"sha": "385179b9c76aa3474038346c375c1e4503b2a2d0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41b2d514d0fc40c9abf744e392e3f7f16fa610aa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41b2d514d0fc40c9abf744e392e3f7f16fa610aa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "patch": "@@ -1,3 +1,10 @@\n+2014-02-25  Andrey Belevantsev  <abel@ispras.ru>\n+\t\n+\t* sel-sched.c (calculate_new_fences): New parameter ptime.\n+\tCalculate it as a maximum over all fence cycles.\n+\t(sel_sched_region_2): Adjust the call to calculate_new_fences.\n+\tPrint the final schedule timing when sched_verbose.\n+\n 2014-02-25  Andrey Belevantsev  <abel@ispras.ru>\n \n \tPR rtl-optimization/60292"}, {"sha": "241bdad146af112d850a402eec4920d074a6dcb8", "filename": "gcc/sel-sched.c", "status": "modified", "additions": 16, "deletions": 9, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/41b2d514d0fc40c9abf744e392e3f7f16fa610aa/gcc%2Fsel-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/41b2d514d0fc40c9abf744e392e3f7f16fa610aa/gcc%2Fsel-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched.c?ref=41b2d514d0fc40c9abf744e392e3f7f16fa610aa", "patch": "@@ -7467,12 +7467,13 @@ find_min_max_seqno (flist_t fences, int *min_seqno, int *max_seqno)\n     }\n }\n \n-/* Calculate new fences from FENCES.  */\n+/* Calculate new fences from FENCES.  Write the current time to PTIME.  */\n static flist_t\n-calculate_new_fences (flist_t fences, int orig_max_seqno)\n+calculate_new_fences (flist_t fences, int orig_max_seqno, int *ptime)\n {\n   flist_t old_fences = fences;\n   struct flist_tail_def _new_fences, *new_fences = &_new_fences;\n+  int max_time = 0;\n \n   flist_tail_init (new_fences);\n   for (; fences; fences = FLIST_NEXT (fences))\n@@ -7501,9 +7502,11 @@ calculate_new_fences (flist_t fences, int orig_max_seqno)\n         }\n       else\n         extract_new_fences_from (fences, new_fences, orig_max_seqno);\n+      max_time = MAX (max_time, FENCE_CYCLE (fence));\n     }\n \n   flist_clear (&old_fences);\n+  *ptime = max_time;\n   return FLIST_TAIL_HEAD (new_fences);\n }\n \n@@ -7558,6 +7561,7 @@ static void\n sel_sched_region_2 (int orig_max_seqno)\n {\n   int highest_seqno_in_use = orig_max_seqno;\n+  int max_time = 0;\n \n   stat_bookkeeping_copies = 0;\n   stat_insns_needed_bookkeeping = 0;\n@@ -7573,19 +7577,22 @@ sel_sched_region_2 (int orig_max_seqno)\n \n       find_min_max_seqno (fences, &min_seqno, &max_seqno);\n       schedule_on_fences (fences, max_seqno, &scheduled_insns_tailp);\n-      fences = calculate_new_fences (fences, orig_max_seqno);\n+      fences = calculate_new_fences (fences, orig_max_seqno, &max_time);\n       highest_seqno_in_use = update_seqnos_and_stage (min_seqno, max_seqno,\n                                                       highest_seqno_in_use,\n                                                       &scheduled_insns);\n     }\n \n   if (sched_verbose >= 1)\n-    sel_print (\"Scheduled %d bookkeeping copies, %d insns needed \"\n-               \"bookkeeping, %d insns renamed, %d insns substituted\\n\",\n-               stat_bookkeeping_copies,\n-               stat_insns_needed_bookkeeping,\n-               stat_renamed_scheduled,\n-               stat_substitutions_total);\n+    {\n+      sel_print (\"Total scheduling time: %d cycles\\n\", max_time);\n+      sel_print (\"Scheduled %d bookkeeping copies, %d insns needed \"\n+\t\t \"bookkeeping, %d insns renamed, %d insns substituted\\n\",\n+\t\t stat_bookkeeping_copies,\n+\t\t stat_insns_needed_bookkeeping,\n+\t\t stat_renamed_scheduled,\n+\t\t stat_substitutions_total);\n+    }\n }\n \n /* Schedule a region.  When pipelining, search for possibly never scheduled"}]}