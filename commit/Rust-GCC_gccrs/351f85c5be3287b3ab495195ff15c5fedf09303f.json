{"sha": "351f85c5be3287b3ab495195ff15c5fedf09303f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzUxZjg1YzViZTMyODdiM2FiNDk1MTk1ZmYxNWM1ZmVkZjA5MzAzZg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2016-05-05T13:26:59Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2016-05-05T13:26:59Z"}, "message": "c-parser.c (c_parser_switch_statement): Add IF_P argument, parse it through to c_parser_c99_block_statement.\n\n\t* c-parser.c (c_parser_switch_statement): Add IF_P argument,\n\tparse it through to c_parser_c99_block_statement.\n\t(c_parser_statement_after_labels): Adjust c_parser_switch_statement\n\tcaller.\n\n\t* parser.c (cp_parser_selection_statement): For RID_SWITCH,\n\tpass if_p instead of NULL to cp_parser_implicitly_scoped_statement.\n\n\t* c-c++-common/Wdangling-else-4.c: New test.\n\nFrom-SVN: r235920", "tree": {"sha": "b1c40179c0f161d00823019b5aa3295ab05f47ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1c40179c0f161d00823019b5aa3295ab05f47ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/351f85c5be3287b3ab495195ff15c5fedf09303f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/351f85c5be3287b3ab495195ff15c5fedf09303f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/351f85c5be3287b3ab495195ff15c5fedf09303f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/351f85c5be3287b3ab495195ff15c5fedf09303f/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f5c40ce2cf8812d28e4738143a491bd77c0a0ce0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5c40ce2cf8812d28e4738143a491bd77c0a0ce0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5c40ce2cf8812d28e4738143a491bd77c0a0ce0"}], "stats": {"total": 57, "additions": 52, "deletions": 5}, "files": [{"sha": "49c9064854f566debe1c1f91af85802d8def3d10", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=351f85c5be3287b3ab495195ff15c5fedf09303f", "patch": "@@ -1,3 +1,10 @@\n+2016-05-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* c-parser.c (c_parser_switch_statement): Add IF_P argument,\n+\tparse it through to c_parser_c99_block_statement.\n+\t(c_parser_statement_after_labels): Adjust c_parser_switch_statement\n+\tcaller.\n+\n 2016-05-04  Marek Polacek  <polacek@redhat.com>\n \n \t* c-parser.c (c_parser_if_statement): Replace OPT_Wparentheses with"}, {"sha": "6523c08d63f0975c6f7bce2578a5ed7a9727f9e8", "filename": "gcc/c/c-parser.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fc%2Fc-parser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fc%2Fc-parser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-parser.c?ref=351f85c5be3287b3ab495195ff15c5fedf09303f", "patch": "@@ -1305,7 +1305,7 @@ static void c_parser_statement (c_parser *, bool *);\n static void c_parser_statement_after_labels (c_parser *, bool *,\n \t\t\t\t\t     vec<tree> * = NULL);\n static void c_parser_if_statement (c_parser *, bool *, vec<tree> *);\n-static void c_parser_switch_statement (c_parser *);\n+static void c_parser_switch_statement (c_parser *, bool *);\n static void c_parser_while_statement (c_parser *, bool, bool *);\n static void c_parser_do_statement (c_parser *, bool);\n static void c_parser_for_statement (c_parser *, bool, bool *);\n@@ -5138,7 +5138,7 @@ c_parser_statement_after_labels (c_parser *parser, bool *if_p,\n \t  c_parser_if_statement (parser, if_p, chain);\n \t  break;\n \tcase RID_SWITCH:\n-\t  c_parser_switch_statement (parser);\n+\t  c_parser_switch_statement (parser, if_p);\n \t  break;\n \tcase RID_WHILE:\n \t  c_parser_while_statement (parser, false, if_p);\n@@ -5570,7 +5570,7 @@ c_parser_if_statement (c_parser *parser, bool *if_p, vec<tree> *chain)\n */\n \n static void\n-c_parser_switch_statement (c_parser *parser)\n+c_parser_switch_statement (c_parser *parser, bool *if_p)\n {\n   struct c_expr ce;\n   tree block, expr, body, save_break;\n@@ -5605,7 +5605,7 @@ c_parser_switch_statement (c_parser *parser)\n   c_start_case (switch_loc, switch_cond_loc, expr, explicit_cast_p);\n   save_break = c_break_label;\n   c_break_label = NULL_TREE;\n-  body = c_parser_c99_block_statement (parser, NULL/*if??*/);\n+  body = c_parser_c99_block_statement (parser, if_p);\n   c_finish_case (body, ce.original_type);\n   if (c_break_label)\n     {"}, {"sha": "9006b341a7a3d34f7d1013db5088c40995583115", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=351f85c5be3287b3ab495195ff15c5fedf09303f", "patch": "@@ -1,3 +1,8 @@\n+2016-05-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* parser.c (cp_parser_selection_statement): For RID_SWITCH,\n+\tpass if_p instead of NULL to cp_parser_implicitly_scoped_statement.\n+\n 2016-05-04  Marek Polacek  <polacek@redhat.com>\n \n \t* parser.c (cp_parser_selection_statement): Replace OPT_Wparentheses"}, {"sha": "f4c6f74b3d06fb1361fa2062581cc80138e3e944", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=351f85c5be3287b3ab495195ff15c5fedf09303f", "patch": "@@ -10978,7 +10978,7 @@ cp_parser_selection_statement (cp_parser* parser, bool *if_p,\n \t    in_statement = parser->in_statement;\n \t    parser->in_switch_statement_p = true;\n \t    parser->in_statement |= IN_SWITCH_STMT;\n-\t    cp_parser_implicitly_scoped_statement (parser, NULL,\n+\t    cp_parser_implicitly_scoped_statement (parser, if_p,\n \t\t\t\t\t\t   guard_tinfo);\n \t    parser->in_switch_statement_p = in_switch_statement_p;\n \t    parser->in_statement = in_statement;"}, {"sha": "7eefd9445a3b79025d2a92c128e79122b3a918f9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=351f85c5be3287b3ab495195ff15c5fedf09303f", "patch": "@@ -1,3 +1,7 @@\n+2016-05-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* c-c++-common/Wdangling-else-4.c: New test.\n+\n 2016-05-04  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/70906"}, {"sha": "12cc1405a40cc4b5b7a6eef2ca105672da043cee", "filename": "gcc/testsuite/c-c++-common/Wdangling-else-4.c", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWdangling-else-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/351f85c5be3287b3ab495195ff15c5fedf09303f/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWdangling-else-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWdangling-else-4.c?ref=351f85c5be3287b3ab495195ff15c5fedf09303f", "patch": "@@ -0,0 +1,31 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wdangling-else\" } */\n+\n+void bar (int);\n+\n+void\n+foo (int a, int b, int c)\n+{\n+  if (a)\t/* { dg-warning \"suggest explicit braces to avoid ambiguous .else.\" } */\n+    switch (b)\n+      case 0:\n+\tif (c)\n+\t  bar (1);\n+  else\n+    bar (2);\n+}\n+\n+void\n+baz (int a, int b, int c)\n+{\n+  if (a)\n+    switch (b)\n+      {\n+      case 0:\n+\tif (c)\n+\t  bar (1);\n+      }\n+  else\n+    bar (2);\n+}\n+"}]}