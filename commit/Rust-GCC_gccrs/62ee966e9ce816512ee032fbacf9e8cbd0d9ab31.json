{"sha": "62ee966e9ce816512ee032fbacf9e8cbd0d9ab31", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjJlZTk2NmU5Y2U4MTY1MTJlZTAzMmZiYWNmOWU4Y2JkMGQ5YWIzMQ==", "commit": {"author": {"name": "Mark J Roberts", "email": "mjr@anarcast.net", "date": "2001-08-17T22:21:02Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2001-08-17T22:21:02Z"}, "message": "BigInteger.java (randBytes): New method.\n\n2001-08-17  Mark J Roberts  <mjr@anarcast.net>\n\n\t* java/math/BigInteger.java (randBytes): New method.\n\t(BigInteger(int,Random)): Use randBytes.\n\nFrom-SVN: r44984", "tree": {"sha": "0b1fec8feb4b6c2e03281102ecfbcbd66e06c5c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0b1fec8feb4b6c2e03281102ecfbcbd66e06c5c6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31/comments", "author": null, "committer": null, "parents": [{"sha": "2d76cb1aba961fe2dc84fd3b1dad04181affd103", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d76cb1aba961fe2dc84fd3b1dad04181affd103", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d76cb1aba961fe2dc84fd3b1dad04181affd103"}], "stats": {"total": 28, "additions": 16, "deletions": 12}, "files": [{"sha": "1567a3d1af719f6770d49d915e7820934f8b4896", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=62ee966e9ce816512ee032fbacf9e8cbd0d9ab31", "patch": "@@ -1,3 +1,8 @@\n+2001-08-17  Mark J Roberts  <mjr@anarcast.net>\n+\n+\t* java/math/BigInteger.java (randBytes): New method.\n+\t(BigInteger(int,Random)): Use randBytes.\n+\n 2001-08-17  Tom Tromey  <tromey@redhat.com>\n \n \t* gnu/gcj/convert/IOConverter.java: Add `646' alias."}, {"sha": "b9bfee695b50b3e8d3eac697c8265036b14b2de5", "filename": "libjava/java/math/BigInteger.java", "status": "modified", "additions": 11, "deletions": 12, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31/libjava%2Fjava%2Fmath%2FBigInteger.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62ee966e9ce816512ee032fbacf9e8cbd0d9ab31/libjava%2Fjava%2Fmath%2FBigInteger.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Fmath%2FBigInteger.java?ref=62ee966e9ce816512ee032fbacf9e8cbd0d9ab31", "patch": "@@ -143,22 +143,21 @@ public BigInteger(int signum, byte[] magnitude)\n   }\n \n   public BigInteger(int numBits, Random rnd)\n+  {\n+    this(1, randBytes(numBits, rnd));\n+  }\n+\n+  private static byte[] randBytes(int numBits, Random rnd)\n   {\n     if (numBits < 0)\n       throw new IllegalArgumentException();\n \n-    // Result is always positive so tack on an extra zero word, it will be\n-    // canonicalized out later if necessary.\n-    int nwords = numBits / 32 + 2;\n-    words = new int[nwords];\n-    words[--nwords] = 0;\n-    words[--nwords] = rnd.nextInt() >>> (numBits % 32);\n-    while (--nwords >= 0)\n-      words[nwords] = rnd.nextInt();\n-\n-    BigInteger result = make(words, words.length);\n-    this.ival = result.ival;\n-    this.words = result.words;\n+    int extra = numBits % 8;\n+    byte[] b = new byte[numBits / 8 + (extra > 0 ? 1 : 0)];\n+    rnd.nextBytes(b);\n+    if (extra > 0)\n+      b[0] &= ~((~0) << (8 - extra));\n+    return b;\n   }\n \n   public BigInteger(int bitLength, int certainty, Random rnd)"}]}