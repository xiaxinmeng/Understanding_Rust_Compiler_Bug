{"sha": "51c5169c60be01c229b8637d11283d843bc6e126", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTFjNTE2OWM2MGJlMDFjMjI5Yjg2MzdkMTEyODNkODQzYmM2ZTEyNg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2011-04-17T10:22:40Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2011-04-17T10:22:40Z"}, "message": "decl.c (gnat_to_gnu_entity): Declare the padded type built for the return type if it is unconstrained.\n\n\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Function>: Declare the\n\tpadded type built for the return type if it is unconstrained.\n\nFrom-SVN: r172608", "tree": {"sha": "5ab97c5d9cfe522c640e3afb90d15f8809fb181e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ab97c5d9cfe522c640e3afb90d15f8809fb181e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/51c5169c60be01c229b8637d11283d843bc6e126", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51c5169c60be01c229b8637d11283d843bc6e126", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51c5169c60be01c229b8637d11283d843bc6e126", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51c5169c60be01c229b8637d11283d843bc6e126/comments", "author": null, "committer": null, "parents": [{"sha": "54333b7cda497346b2f56b79b76d52a8dab7a174", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54333b7cda497346b2f56b79b76d52a8dab7a174", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54333b7cda497346b2f56b79b76d52a8dab7a174"}], "stats": {"total": 71, "additions": 69, "deletions": 2}, "files": [{"sha": "8f52d5a50b1d5f78cbe8406dee7aad5f60851ac4", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -1,3 +1,8 @@\n+2011-04-17  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Function>: Declare the\n+\tpadded type built for the return type if it is unconstrained.\n+\n 2011-04-14  Nathan Froyd  <froydnj@codesourcery.com>\n \n \t* gcc-interface/utils.c (gnat_poplevel): Use block_chainon."}, {"sha": "185df85af32449ddefe508534a901859e8205a4a", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -4068,6 +4068,13 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, int definition)\n \t\t\t\t    max_size (TYPE_SIZE (gnu_return_type),\n \t\t\t\t\t      true),\n \t\t\t\t    0, gnat_entity, false, false, false, true);\n+\n+\t\t/* Declare it now since it will never be declared otherwise.\n+\t\t   This is necessary to ensure that its subtrees are properly\n+\t\t   marked.  */\n+\t\tcreate_type_decl (TYPE_NAME (gnu_return_type), gnu_return_type,\n+\t\t\t\t  NULL, true, debug_info_p, gnat_entity);\n+\n \t\treturn_by_invisi_ref_p = true;\n \t      }\n "}, {"sha": "8e258482f18f8254dc2560440f8434249c18cf39", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -1,3 +1,9 @@\n+2011-04-17  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/discr27.ad[sb]: Move dg directive.\n+\t* gnat.dg/discr28.ad[sb]: New test.\n+\t* gnat.dg/discr28_pkg.ads: New helper.\n+\n 2011-04-17  Michael Matz  <matz@suse.de>\n \n \tPR tree-optimization/48622"}, {"sha": "875fe435b668f855a551d01515b2cb141604c680", "filename": "gcc/testsuite/gnat.dg/discr27.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr27.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr27.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr27.adb?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -1,3 +1,5 @@\n+-- { dg-do compile }\r\n+\r\n package body Discr27 is\r\n \r\n    subtype Index is Positive range 1..4096;\r"}, {"sha": "247134a991673f770df607b413edd100a63f8188", "filename": "gcc/testsuite/gnat.dg/discr27.ads", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr27.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr27.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr27.ads?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -1,5 +1,3 @@\n--- { dg-do compile }\r\n-\r\n package Discr27 is\r\n \r\n    procedure Proc;\r"}, {"sha": "97ca8cd68b7f5205242b5107357b0fcb0347e30e", "filename": "gcc/testsuite/gnat.dg/discr28.adb", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28.adb?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -0,0 +1,25 @@\n+-- { dg-do compile }\n+\n+package body Discr28 is\n+\n+   procedure Dummy (E : Rec) is\n+   begin\n+     null;\n+   end;\n+\n+   function F return Rec is\n+   begin\n+      return Default_Rec;\n+   end;\n+\n+   procedure Proc1 is\n+   begin\n+      Dummy (F);\n+   end;\n+\n+   procedure Proc2 is\n+   begin\n+      Dummy (F);\n+   end;\n+\n+end Discr28;"}, {"sha": "3288b52bfcbe689d5ecd8ac985bde828f7d031a8", "filename": "gcc/testsuite/gnat.dg/discr28.ads", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28.ads?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -0,0 +1,19 @@\n+with Discr28_Pkg;\n+\n+package Discr28 is\n+\n+   type Enum is (One, Two);\n+\n+   type Rec (D : Enum := One) is record\n+      case D is\n+         when One => null;\n+         when Two => S : String (1 .. Discr28_Pkg.N);\n+      end case;\n+   end record;\n+\n+   Default_Rec : constant Rec := (D => One);\n+\n+   procedure Proc1;\n+   procedure Proc2;\n+\n+end Discr28;"}, {"sha": "f6be834eedcbe67517c8bf1dde91269391aee609", "filename": "gcc/testsuite/gnat.dg/discr28_pkg.ads", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51c5169c60be01c229b8637d11283d843bc6e126/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fdiscr28_pkg.ads?ref=51c5169c60be01c229b8637d11283d843bc6e126", "patch": "@@ -0,0 +1,5 @@\n+package Discr28_Pkg is\n+\n+  function N return Natural;\n+\n+end Discr28_Pkg;"}]}