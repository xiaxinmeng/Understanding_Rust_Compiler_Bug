{"sha": "d77478a5e53bc1c1daa08c675e87524193c39de2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDc3NDc4YTVlNTNiYzFjMWRhYTA4YzY3NWU4NzUyNDE5M2MzOWRlMg==", "commit": {"author": {"name": "Jerry Quinn", "email": "jlquinn@optonline.net", "date": "2003-02-21T08:34:18Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2003-02-21T08:34:18Z"}, "message": "locale_facets.tcc (_M_convert_float): Replace numpunct facet accesses with data from __locale_cache.\n\n\n2003-02-21  Jerry Quinn  <jlquinn@optonline.net>\n\n        * include/bits/locale_facets.tcc (_M_convert_float): Replace\n\tnumpunct facet accesses with data from __locale_cache.\n\nFrom-SVN: r63213", "tree": {"sha": "9c362f225f0593e002759ffa243ee11d9ef106c8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9c362f225f0593e002759ffa243ee11d9ef106c8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d77478a5e53bc1c1daa08c675e87524193c39de2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d77478a5e53bc1c1daa08c675e87524193c39de2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d77478a5e53bc1c1daa08c675e87524193c39de2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d77478a5e53bc1c1daa08c675e87524193c39de2/comments", "author": {"login": "jlquinn", "id": 826841, "node_id": "MDQ6VXNlcjgyNjg0MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/826841?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jlquinn", "html_url": "https://github.com/jlquinn", "followers_url": "https://api.github.com/users/jlquinn/followers", "following_url": "https://api.github.com/users/jlquinn/following{/other_user}", "gists_url": "https://api.github.com/users/jlquinn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jlquinn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jlquinn/subscriptions", "organizations_url": "https://api.github.com/users/jlquinn/orgs", "repos_url": "https://api.github.com/users/jlquinn/repos", "events_url": "https://api.github.com/users/jlquinn/events{/privacy}", "received_events_url": "https://api.github.com/users/jlquinn/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2d4fad8e021d52fd9ff3c1fb092c8ba8d4d757d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d4fad8e021d52fd9ff3c1fb092c8ba8d4d757d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d4fad8e021d52fd9ff3c1fb092c8ba8d4d757d4"}], "stats": {"total": 17, "additions": 11, "deletions": 6}, "files": [{"sha": "9081936787b93a79dc51ab752f4433646b41bb48", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d77478a5e53bc1c1daa08c675e87524193c39de2/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d77478a5e53bc1c1daa08c675e87524193c39de2/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=d77478a5e53bc1c1daa08c675e87524193c39de2", "patch": "@@ -1,3 +1,8 @@\n+2003-02-21  Jerry Quinn  <jlquinn@optonline.net>\n+\n+        * include/bits/locale_facets.tcc (_M_convert_float): Replace\n+\tnumpunct facet accesses with data from __locale_cache.\n+\n 2003-02-20  Phil Edwards  <pme@gcc.gnu.org>\n \n \t* docs/html/faq/index.html (3.9):  New note, wchar_t on FreeBSD.\n@@ -60,7 +65,6 @@\n \tcache literal string, grouping flag, thousands separator.\n \t(__locale_cache<_CharT>::__locale_cache): New.\n \t(__locale_cache<_CharT>::_M_init): New.\n-\t(__locale_cache<_CharT>::_M_populate): New.\n \t* src/ios.cc: Clear _M_locale_cache in constructor.\n \t* src/locale-inst.cc (__locale_cache<char>, __locale_cache<_char_t>):\n \tNew."}, {"sha": "cb6dccd19e674df28d2248bea1058070d7f62fc5", "filename": "libstdc++-v3/include/bits/locale_facets.tcc", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d77478a5e53bc1c1daa08c675e87524193c39de2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d77478a5e53bc1c1daa08c675e87524193c39de2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Flocale_facets.tcc?ref=d77478a5e53bc1c1daa08c675e87524193c39de2", "patch": "@@ -872,6 +872,9 @@ namespace std\n \telse if (__prec < static_cast<streamsize>(0))\n \t  __prec = static_cast<streamsize>(6);\n \n+\ttypedef __locale_cache<_CharT> __cache_type;\n+\t__cache_type& __lc = static_cast<__cache_type&>(__io._M_cache());\n+\n \t// [22.2.2.2.2] Stage 1, numeric conversion to character.\n \tint __len;\n \t// Long enough for the max format spec.\n@@ -917,29 +920,27 @@ namespace std\n       // numpunct.decimal_point() values for '.' and adding grouping.\n       const locale __loc = __io.getloc();\n       const ctype<_CharT>& __ctype = use_facet<ctype<_CharT> >(__loc);\n-      const numpunct<_CharT>& __np = use_facet<numpunct<_CharT> >(__loc);\n \n       _CharT* __ws = static_cast<_CharT*>(__builtin_alloca(sizeof(_CharT) \n \t\t\t\t\t\t\t   * __len));\n       __ctype.widen(__cs, __cs + __len, __ws);\n       \n       // Replace decimal point.\n       const _CharT __cdec = __ctype.widen('.');\n-      const _CharT __dec = __np.decimal_point();\n+      const _CharT __dec = __lc._M_decimal_point;\n       const _CharT* __p;\n       if (__p = char_traits<_CharT>::find(__ws, __len, __cdec))\n \t__ws[__p - __ws] = __dec;\n \n       // Add grouping, if necessary. \n       _CharT* __ws2;\n-      const string __grouping = __np.grouping();\n-      if (__grouping.size())\n+      if (__lc._M_use_grouping)\n \t{\n \t    // Grouping can add (almost) as many separators as the\n \t    // number of digits, but no more.\n \t    __ws2 = static_cast<_CharT*>(__builtin_alloca(sizeof(_CharT) \n \t\t\t\t\t\t\t  * __len * 2));\n-\t    _M_group_float(__grouping, __np.thousands_sep(), __p, \n+\t    _M_group_float(__lc._M_grouping, __lc._M_thousands_sep, __p,\n \t\t\t   __ws2, __ws, __len);\n \t    __ws = __ws2;\n \t}"}]}