{"sha": "3a4ec5cc08d808313a7e0d820193a9c405a313c5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2E0ZWM1Y2MwOGQ4MDgzMTNhN2UwZDgyMDE5M2E5YzQwNWEzMTNjNQ==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2010-06-22T10:15:49Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-22T10:15:49Z"}, "message": "bindusg.adb (Display): Update line for -R\n\n2010-06-22  Vincent Celier  <celier@adacore.com>\n\n\t* bindusg.adb (Display): Update line for -R\n\t* switch-b.adb (Scan_Binder_Switches): Allow generation of the binder\n\tgenerated files when -R is used.\n\n2010-06-22  Vincent Celier  <celier@adacore.com>\n\n\t* prj-nmsc.adb (Lib_Data_Table): New table.\n\t(Check_Library_Attributes): Check if the same library name is used in\n\ttwo different projects that do not extend each other.\n\nFrom-SVN: r161161", "tree": {"sha": "56d633654fe6f2bed93cd50b3d290cd7887f5139", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/56d633654fe6f2bed93cd50b3d290cd7887f5139"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3a4ec5cc08d808313a7e0d820193a9c405a313c5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a4ec5cc08d808313a7e0d820193a9c405a313c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a4ec5cc08d808313a7e0d820193a9c405a313c5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a4ec5cc08d808313a7e0d820193a9c405a313c5/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "47d3b920ce09b27fca7dc6504640f6fe72fb16cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47d3b920ce09b27fca7dc6504640f6fe72fb16cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47d3b920ce09b27fca7dc6504640f6fe72fb16cf"}], "stats": {"total": 69, "additions": 66, "deletions": 3}, "files": [{"sha": "df1bc715f5dbe1509282c47930237b3cda0bf639", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=3a4ec5cc08d808313a7e0d820193a9c405a313c5", "patch": "@@ -1,3 +1,15 @@\n+2010-06-22  Vincent Celier  <celier@adacore.com>\n+\n+\t* bindusg.adb (Display): Update line for -R\n+\t* switch-b.adb (Scan_Binder_Switches): Allow generation of the binder\n+\tgenerated files when -R is used.\n+\n+2010-06-22  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-nmsc.adb (Lib_Data_Table): New table.\n+\t(Check_Library_Attributes): Check if the same library name is used in\n+\ttwo different projects that do not extend each other.\n+\n 2010-06-22  Robert Dewar  <dewar@adacore.com>\n \n \t* lib-writ.ads, errout.adb, einfo.adb, einfo.ads: Minor reformatting."}, {"sha": "bfab363734426c4bb29e17043de5b384bc93a5fe", "filename": "gcc/ada/bindusg.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2Fbindusg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2Fbindusg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindusg.adb?ref=3a4ec5cc08d808313a7e0d820193a9c405a313c5", "patch": "@@ -181,7 +181,7 @@ package body Bindusg is\n       --  Line for -R switch\n \n       Write_Line\n-        (\"  -R        List sources referenced in closure (implies -c)\");\n+        (\"  -R        List sources referenced in closure\");\n \n       --  Line for -s switch\n "}, {"sha": "f16f6e7bd9bde0a94b913a6e4a95edceb35c74bd", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 53, "deletions": 1, "changes": 54, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=3a4ec5cc08d808313a7e0d820193a9c405a313c5", "patch": "@@ -26,6 +26,7 @@\n with GNAT.Case_Util;             use GNAT.Case_Util;\n with GNAT.Directory_Operations;  use GNAT.Directory_Operations;\n with GNAT.Dynamic_HTables;\n+with GNAT.Table;\n \n with Err_Vars; use Err_Vars;\n with Opt;      use Opt;\n@@ -157,6 +158,20 @@ package body Prj.Nmsc is\n    --  This data must be initialized before processing any project, and the\n    --  same data is used for processing all projects in the tree.\n \n+   type Lib_Data is record\n+      Name : Name_Id;\n+      Proj : Project_Id;\n+   end record;\n+\n+   package Lib_Data_Table is new GNAT.Table\n+     (Table_Component_Type => Lib_Data,\n+      Table_Index_Type     => Positive,\n+      Table_Low_Bound      => 1,\n+      Table_Initial        => 10,\n+      Table_Increment      => 100);\n+   --  A table to record library names in order to check that two library\n+   --  projects do not have the same library names.\n+\n    procedure Initialize\n      (Data  : out Tree_Processing_Data;\n       Tree  : Project_Tree_Ref;\n@@ -4083,9 +4098,46 @@ package body Prj.Nmsc is\n          end;\n       end if;\n \n-      if Project.Extends /= No_Project then\n+      if Project.Extends /= No_Project and then Project.Extends.Library then\n+\n+         --  Remove the library name from Lib_Data_Table\n+\n+         for J in 1 .. Lib_Data_Table.Last loop\n+            if Lib_Data_Table.Table (J).Proj = Project.Extends then\n+               Lib_Data_Table.Table (J) :=\n+                 Lib_Data_Table.Table (Lib_Data_Table.Last);\n+               Lib_Data_Table.Set_Last (Lib_Data_Table.Last - 1);\n+               exit;\n+            end if;\n+         end loop;\n+\n          Project.Extends.Library := False;\n       end if;\n+\n+      if Project.Library and then not Lib_Name.Default then\n+\n+         --  Check if the same library name is used in an other library project\n+\n+         for J in 1 .. Lib_Data_Table.Last loop\n+            if Lib_Data_Table.Table (J).Name = Project.Library_Name then\n+               Error_Msg_Name_1 := Lib_Data_Table.Table (J).Proj.Name;\n+               Error_Msg\n+                 (Data.Flags,\n+                  \"Library name cannot be the same as in project %%\",\n+                  Lib_Name.Location, Project);\n+               Project.Library := False;\n+               exit;\n+            end if;\n+         end loop;\n+      end if;\n+\n+      if Project.Library then\n+\n+         --  Record the library name\n+\n+         Lib_Data_Table.Append\n+           ((Name => Project.Library_Name, Proj => Project));\n+      end if;\n    end Check_Library_Attributes;\n \n    ---------------------------------"}, {"sha": "8a22eb0c231a99a205f91dc9ed76e30f11c8a488", "filename": "gcc/ada/switch-b.adb", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2Fswitch-b.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a4ec5cc08d808313a7e0d820193a9c405a313c5/gcc%2Fada%2Fswitch-b.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-b.adb?ref=3a4ec5cc08d808313a7e0d820193a9c405a313c5", "patch": "@@ -366,7 +366,6 @@ package body Switch.B is\n \n          when 'R' =>\n             Ptr := Ptr + 1;\n-            Check_Only   := True;\n             List_Closure := True;\n \n          --  Processing for s switch"}]}