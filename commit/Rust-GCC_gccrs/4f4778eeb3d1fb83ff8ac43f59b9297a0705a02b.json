{"sha": "4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGY0Nzc4ZWViM2QxZmI4M2ZmOGFjNDNmNTliOTI5N2EwNzA1YTAyYg==", "commit": {"author": {"name": "David S. Miller", "email": "davem@redhat.com", "date": "2002-05-10T15:07:41Z"}, "committer": {"name": "David S. Miller", "email": "davem@gcc.gnu.org", "date": "2002-05-10T15:07:41Z"}, "message": "sparc.md: Use define_constants for unspec numbers.\n\n2002-05-10  David S. Miller  <davem@redhat.com>\n\n\t* config/sparc/sparc.md: Use define_constants for unspec numbers.\n\nFrom-SVN: r53364", "tree": {"sha": "abbe245c01f9c12520c7e160d467bb88bb666e4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/abbe245c01f9c12520c7e160d467bb88bb666e4a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b/comments", "author": null, "committer": null, "parents": [{"sha": "92eca31e2374d75817895981391bbe0f783adb61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92eca31e2374d75817895981391bbe0f783adb61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/92eca31e2374d75817895981391bbe0f783adb61"}], "stats": {"total": 122, "additions": 60, "deletions": 62}, "files": [{"sha": "d933c9733b011279ab404675fd4a0615aec3f5ff", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b", "patch": "@@ -1,4 +1,6 @@\n-2002-05-09  David S. Miller  <davem@redhat.com>\n+2002-05-10  David S. Miller  <davem@redhat.com>\n+\n+\t* config/sparc/sparc.md: Use define_constants for unspec numbers.\n \n \t* rtl.h (struct rtx_def): Document unchanging and in_struct flags\n \tmore accurately."}, {"sha": "37ab89916bc06f80a909542548555e220fd37151", "filename": "gcc/config/sparc/sparc.md", "status": "modified", "additions": 57, "deletions": 61, "changes": 118, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b/gcc%2Fconfig%2Fsparc%2Fsparc.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b/gcc%2Fconfig%2Fsparc%2Fsparc.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.md?ref=4f4778eeb3d1fb83ff8ac43f59b9297a0705a02b", "patch": "@@ -24,34 +24,30 @@\n \n ;;- See file \"rtl.def\" for documentation on define_insn, match_*, et. al.\n \n-;; Uses of UNSPEC and UNSPEC_VOLATILE in this file:\n-;;\n-;; UNSPEC:\t\t0\tmovsi_{lo_sum,high}_pic\n-;;\t\t\t\tpic_lo_sum_di\n-;;\t\t\t\tpic_sethi_di\n-;;\t\t\t1\tupdate_return\n-;;\t\t\t2\tget_pc\n-;;\t\t\t5\tmovsi_{,lo_sum_,high_}pic_label_ref\n-;;\t\t\t6\tseth44\n-;;\t\t\t7\tsetm44\n-;;\t\t\t8\tsetl44\n-;;\t\t\t9\tsethh\n-;;\t\t\t10\tsetlm\n-;;\t\t\t11\tembmedany_sethi, embmedany_brsum\n-;;\t\t\t13\tembmedany_textuhi\n-;;\t\t\t14\tembmedany_texthi\n-;;\t\t\t15\tembmedany_textulo\n-;;\t\t\t16\tembmedany_textlo\n-;;\t\t\t18\tsethm\n-;;\t\t\t19\tsetlo\n-;;\n-;; UNSPEC_VOLATILE:\t0\tblockage\n-;;\t\t\t1\tflush_register_windows\n-;;\t\t\t2\tgoto_handler_and_restore\n-;;\t\t\t3\tgoto_handler_and_restore_v9*\n-;;\t\t\t4\tflush\n-;;\t\t\t5\tdo_builtin_setjmp_setup\n-;;\n+(define_constants\n+  [(UNSPEC_MOVE_PIC\t\t0)\n+   (UNSPEC_UPDATE_RETURN\t1)\n+   (UNSPEC_GET_PC\t\t2)\n+   (UNSPEC_MOVE_PIC_LABEL\t5)\n+   (UNSPEC_SETH44\t\t6)\n+   (UNSPEC_SETM44\t\t7)\n+   (UNSPEC_SETHH\t\t9)\n+   (UNSPEC_SETLM\t\t10)\n+   (UNSPEC_EMB_HISUM\t\t11)\n+   (UNSPEC_EMB_TEXTUHI\t\t13)\n+   (UNSPEC_EMB_TEXTHI\t\t14)\n+   (UNSPEC_EMB_TEXTULO\t\t15)\n+   (UNSPEC_EMB_SETHM\t\t18)\n+  ])\n+\n+(define_constants\n+  [(UNSPECV_BLOCKAGE\t\t0)\n+   (UNSPECV_FLUSHW\t\t1)\n+   (UNSPECV_GOTO\t\t2)\n+   (UNSPECV_GOTO_V9\t\t3)\n+   (UNSPECV_FLUSH\t\t4)\n+   (UNSPECV_SETJMP\t\t5)\n+  ])\n \n ;; The upper 32 fp regs on the v9 can't hold SFmode values.  To deal with this\n ;; a second register class, EXTRA_FP_REGS, exists for the v9 chip.  The name\n@@ -1778,7 +1774,7 @@\n (define_insn \"get_pc\"\n   [(clobber (reg:SI 15))\n    (set (match_operand 0 \"register_operand\" \"=r\")\n-\t(unspec [(match_operand 1 \"\" \"\") (match_operand 2 \"\" \"\")] 2))]\n+\t(unspec [(match_operand 1 \"\" \"\") (match_operand 2 \"\" \"\")] UNSPEC_GET_PC))]\n   \"flag_pic && REGNO (operands[0]) == 23\"\n   \"sethi\\\\t%%hi(%a1-4), %0\\\\n\\\\tcall\\\\t%a2\\\\n\\\\tadd\\\\t%0, %%lo(%a1+4), %0\"\n   [(set_attr \"type\" \"multi\")\n@@ -2055,22 +2051,22 @@\n (define_insn \"movsi_lo_sum_pic\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n         (lo_sum:SI (match_operand:SI 1 \"register_operand\" \"r\")\n-                   (unspec:SI [(match_operand:SI 2 \"immediate_operand\" \"in\")] 0)))]\n+                   (unspec:SI [(match_operand:SI 2 \"immediate_operand\" \"in\")] UNSPEC_MOVE_PIC)))]\n   \"flag_pic\"\n   \"or\\\\t%1, %%lo(%a2), %0\")\n \n (define_insn \"movsi_high_pic\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n-        (high:SI (unspec:SI [(match_operand 1 \"\" \"\")] 0)))]\n+        (high:SI (unspec:SI [(match_operand 1 \"\" \"\")] UNSPEC_MOVE_PIC)))]\n   \"flag_pic && check_pic (1)\"\n   \"sethi\\\\t%%hi(%a1), %0\")\n \n (define_expand \"movsi_pic_label_ref\"\n   [(set (match_dup 3) (high:SI\n      (unspec:SI [(match_operand:SI 1 \"label_ref_operand\" \"\")\n-\t\t (match_dup 2)] 5)))\n+\t\t (match_dup 2)] UNSPEC_MOVE_PIC_LABEL)))\n    (set (match_dup 4) (lo_sum:SI (match_dup 3)\n-     (unspec:SI [(match_dup 1) (match_dup 2)] 5)))\n+     (unspec:SI [(match_dup 1) (match_dup 2)] UNSPEC_MOVE_PIC_LABEL)))\n    (set (match_operand:SI 0 \"register_operand\" \"=r\")\n \t(minus:SI (match_dup 5) (match_dup 4)))]\n   \"flag_pic\"\n@@ -2095,15 +2091,15 @@\n   [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n       (high:SI\n         (unspec:SI [(match_operand:SI 1 \"label_ref_operand\" \"\")\n-\t\t    (match_operand:SI 2 \"\" \"\")] 5)))]\n+\t\t    (match_operand:SI 2 \"\" \"\")] UNSPEC_MOVE_PIC_LABEL)))]\n   \"flag_pic\"\n   \"sethi\\\\t%%hi(%a2-(%a1-.)), %0\")\n \n (define_insn \"*movsi_lo_sum_pic_label_ref\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n       (lo_sum:SI (match_operand:SI 1 \"register_operand\" \"r\")\n         (unspec:SI [(match_operand:SI 2 \"label_ref_operand\" \"\")\n-\t\t    (match_operand:SI 3 \"\" \"\")] 5)))]\n+\t\t    (match_operand:SI 3 \"\" \"\")] UNSPEC_MOVE_PIC_LABEL)))]\n   \"flag_pic\"\n   \"or\\\\t%1, %%lo(%a3-(%a2-.)), %0\")\n \n@@ -2308,9 +2304,9 @@\n (define_expand \"movdi_pic_label_ref\"\n   [(set (match_dup 3) (high:DI\n      (unspec:DI [(match_operand:DI 1 \"label_ref_operand\" \"\")\n-                 (match_dup 2)] 5)))\n+                 (match_dup 2)] UNSPEC_MOVE_PIC_LABEL)))\n    (set (match_dup 4) (lo_sum:DI (match_dup 3)\n-     (unspec:DI [(match_dup 1) (match_dup 2)] 5)))\n+     (unspec:DI [(match_dup 1) (match_dup 2)] UNSPEC_MOVE_PIC_LABEL)))\n    (set (match_operand:DI 0 \"register_operand\" \"=r\")\n         (minus:DI (match_dup 5) (match_dup 4)))]\n   \"TARGET_ARCH64 && flag_pic\"\n@@ -2335,15 +2331,15 @@\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n         (high:DI\n           (unspec:DI [(match_operand:DI 1 \"label_ref_operand\" \"\")\n-                      (match_operand:DI 2 \"\" \"\")] 5)))]\n+                      (match_operand:DI 2 \"\" \"\")] UNSPEC_MOVE_PIC_LABEL)))]\n   \"TARGET_ARCH64 && flag_pic\"\n   \"sethi\\\\t%%hi(%a2-(%a1-.)), %0\")\n \n (define_insn \"*movdi_lo_sum_pic_label_ref\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n       (lo_sum:DI (match_operand:DI 1 \"register_operand\" \"r\")\n         (unspec:DI [(match_operand:DI 2 \"label_ref_operand\" \"\")\n-                    (match_operand:DI 3 \"\" \"\")] 5)))]\n+                    (match_operand:DI 3 \"\" \"\")] UNSPEC_MOVE_PIC_LABEL)))]\n   \"TARGET_ARCH64 && flag_pic\"\n   \"or\\\\t%1, %%lo(%a3-(%a2-.)), %0\")\n \n@@ -2353,13 +2349,13 @@\n (define_insn \"movdi_lo_sum_pic\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n         (lo_sum:DI (match_operand:DI 1 \"register_operand\" \"r\")\n-                   (unspec:DI [(match_operand:DI 2 \"immediate_operand\" \"in\")] 0)))]\n+                   (unspec:DI [(match_operand:DI 2 \"immediate_operand\" \"in\")] UNSPEC_MOVE_PIC)))]\n   \"TARGET_ARCH64 && flag_pic\"\n   \"or\\\\t%1, %%lo(%a2), %0\")\n \n (define_insn \"movdi_high_pic\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (high:DI (unspec:DI [(match_operand 1 \"\" \"\")] 0)))]\n+        (high:DI (unspec:DI [(match_operand 1 \"\" \"\")] UNSPEC_MOVE_PIC)))]\n   \"TARGET_ARCH64 && flag_pic && check_pic (1)\"\n   \"sethi\\\\t%%hi(%a1), %0\")\n \n@@ -2384,14 +2380,14 @@\n \n (define_insn \"seth44\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (high:DI (unspec:DI [(match_operand:DI 1 \"symbolic_operand\" \"\")] 6)))]\n+        (high:DI (unspec:DI [(match_operand:DI 1 \"symbolic_operand\" \"\")] UNSPEC_SETH44)))]\n   \"TARGET_CM_MEDMID\"\n   \"sethi\\\\t%%h44(%a1), %0\")\n \n (define_insn \"setm44\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n         (lo_sum:DI (match_operand:DI 1 \"register_operand\" \"r\")\n-                   (unspec:DI [(match_operand:DI 2 \"symbolic_operand\" \"\")] 7)))]\n+                   (unspec:DI [(match_operand:DI 2 \"symbolic_operand\" \"\")] UNSPEC_SETM44)))]\n   \"TARGET_CM_MEDMID\"\n   \"or\\\\t%1, %%m44(%a2), %0\")\n \n@@ -2404,20 +2400,20 @@\n \n (define_insn \"sethh\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (high:DI (unspec:DI [(match_operand:DI 1 \"symbolic_operand\" \"\")] 9)))]\n+        (high:DI (unspec:DI [(match_operand:DI 1 \"symbolic_operand\" \"\")] UNSPEC_SETHH)))]\n   \"TARGET_CM_MEDANY\"\n   \"sethi\\\\t%%hh(%a1), %0\")\n \n (define_insn \"setlm\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (high:DI (unspec:DI [(match_operand:DI 1 \"symbolic_operand\" \"\")] 10)))]\n+        (high:DI (unspec:DI [(match_operand:DI 1 \"symbolic_operand\" \"\")] UNSPEC_SETLM)))]\n   \"TARGET_CM_MEDANY\"\n   \"sethi\\\\t%%lm(%a1), %0\")\n \n (define_insn \"sethm\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n         (lo_sum:DI (match_operand:DI 1 \"register_operand\" \"r\")\n-                   (unspec:DI [(match_operand:DI 2 \"symbolic_operand\" \"\")] 18)))]\n+                   (unspec:DI [(match_operand:DI 2 \"symbolic_operand\" \"\")] UNSPEC_EMB_SETHM)))]\n   \"TARGET_CM_MEDANY\"\n   \"or\\\\t%1, %%hm(%a2), %0\")\n \n@@ -2430,7 +2426,7 @@\n \n (define_insn \"embmedany_sethi\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (high:DI (unspec:DI [(match_operand:DI 1 \"data_segment_operand\" \"\")] 11)))]\n+        (high:DI (unspec:DI [(match_operand:DI 1 \"data_segment_operand\" \"\")] UNSPEC_EMB_HISUM)))]\n   \"TARGET_CM_EMBMEDANY && check_pic (1)\"\n   \"sethi\\\\t%%hi(%a1), %0\")\n \n@@ -2443,26 +2439,26 @@\n \n (define_insn \"embmedany_brsum\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (unspec:DI [(match_operand:DI 1 \"register_operand\" \"r\")] 11))]\n+        (unspec:DI [(match_operand:DI 1 \"register_operand\" \"r\")] UNSPEC_EMB_HISUM))]\n   \"TARGET_CM_EMBMEDANY\"\n   \"add\\\\t%1, %_, %0\")\n \n (define_insn \"embmedany_textuhi\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (high:DI (unspec:DI [(match_operand:DI 1 \"text_segment_operand\" \"\")] 13)))]\n+        (high:DI (unspec:DI [(match_operand:DI 1 \"text_segment_operand\" \"\")] UNSPEC_EMB_TEXTUHI)))]\n   \"TARGET_CM_EMBMEDANY && check_pic (1)\"\n   \"sethi\\\\t%%uhi(%a1), %0\")\n \n (define_insn \"embmedany_texthi\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n-        (high:DI (unspec:DI [(match_operand:DI 1 \"text_segment_operand\" \"\")] 14)))]\n+        (high:DI (unspec:DI [(match_operand:DI 1 \"text_segment_operand\" \"\")] UNSPEC_EMB_TEXTHI)))]\n   \"TARGET_CM_EMBMEDANY && check_pic (1)\"\n   \"sethi\\\\t%%hi(%a1), %0\")\n \n (define_insn \"embmedany_textulo\"\n   [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n         (lo_sum:DI (match_operand:DI 1 \"register_operand\" \"r\")\n-                   (unspec:DI [(match_operand:DI 2 \"text_segment_operand\" \"\")] 15)))]\n+                   (unspec:DI [(match_operand:DI 2 \"text_segment_operand\" \"\")] UNSPEC_EMB_TEXTULO)))]\n   \"TARGET_CM_EMBMEDANY\"\n   \"or\\\\t%1, %%ulo(%a2), %0\")\n \n@@ -7982,7 +7978,7 @@\n ;; all of memory.  This blocks insns from being moved across this point.\n \n (define_insn \"blockage\"\n-  [(unspec_volatile [(const_int 0)] 0)]\n+  [(unspec_volatile [(const_int 0)] UNSPECV_BLOCKAGE)]\n   \"\"\n   \"\"\n   [(set_attr \"length\" \"0\")])\n@@ -8034,7 +8030,7 @@\n \n (define_insn \"update_return\"\n   [(unspec:SI [(match_operand:SI 0 \"register_operand\" \"r\")\n-\t       (match_operand:SI 1 \"register_operand\" \"r\")] 1)]\n+\t       (match_operand:SI 1 \"register_operand\" \"r\")] UNSPEC_UPDATE_RETURN)]\n   \"! TARGET_ARCH64\"\n   \"cmp\\\\t%1, 0\\;be,a\\\\t.+8\\;add\\\\t%0, 4, %0\"\n   [(set_attr \"type\" \"multi\")\n@@ -8127,13 +8123,13 @@\n \n ;; Special trap insn to flush register windows.\n (define_insn \"flush_register_windows\"\n-  [(unspec_volatile [(const_int 0)] 1)]\n+  [(unspec_volatile [(const_int 0)] UNSPECV_FLUSHW)]\n   \"\"\n   \"* return TARGET_V9 ? \\\"flushw\\\" : \\\"ta\\\\t3\\\";\"\n   [(set_attr \"type\" \"misc\")])\n \n (define_insn \"goto_handler_and_restore\"\n-  [(unspec_volatile [(match_operand 0 \"register_operand\" \"=r\")] 2)]\n+  [(unspec_volatile [(match_operand 0 \"register_operand\" \"=r\")] UNSPECV_GOTO)]\n   \"GET_MODE (operands[0]) == Pmode\"\n   \"jmp\\\\t%0+0\\\\n\\\\trestore\"\n   [(set_attr \"type\" \"multi\")\n@@ -8142,7 +8138,7 @@\n ;;(define_insn \"goto_handler_and_restore_v9\"\n ;;  [(unspec_volatile [(match_operand:SI 0 \"register_operand\" \"=r,r\")\n ;;\t\t     (match_operand:SI 1 \"register_operand\" \"=r,r\")\n-;;\t\t     (match_operand:SI 2 \"const_int_operand\" \"I,n\")] 3)]\n+;;\t\t     (match_operand:SI 2 \"const_int_operand\" \"I,n\")] UNSPECV_GOTO_V9)]\n ;;  \"TARGET_V9 && ! TARGET_ARCH64\"\n ;;  \"@\n ;;   return\\\\t%0+0\\\\n\\\\tmov\\\\t%2, %Y1\n@@ -8153,7 +8149,7 @@\n ;;(define_insn \"*goto_handler_and_restore_v9_sp64\"\n ;;  [(unspec_volatile [(match_operand:DI 0 \"register_operand\" \"=r,r\")\n ;;\t\t     (match_operand:DI 1 \"register_operand\" \"=r,r\")\n-;;\t\t     (match_operand:SI 2 \"const_int_operand\" \"I,n\")] 3)]\n+;;\t\t     (match_operand:SI 2 \"const_int_operand\" \"I,n\")] UNSPECV_GOTO_V9)]\n ;;  \"TARGET_V9 && TARGET_ARCH64\"\n ;;  \"@\n ;;   return\\\\t%0+0\\\\n\\\\tmov\\\\t%2, %Y1\n@@ -8174,7 +8170,7 @@\n }\")\n \n (define_insn \"do_builtin_setjmp_setup\"\n-  [(unspec_volatile [(const_int 0)] 5)]\n+  [(unspec_volatile [(const_int 0)] UNSPECV_SETJMP)]\n   \"\"\n   \"*\n {\n@@ -8199,7 +8195,7 @@\n \t\t\t\t       (const_int 3)))])\n \n (define_split\n-  [(unspec_volatile [(const_int 0)] 5)]\n+  [(unspec_volatile [(const_int 0)] UNSPECV_SETJMP)]\n   \"! current_function_calls_alloca || ! TARGET_V9 || TARGET_FLAT\"\n   [(const_int 0)]\n   \"\n@@ -8246,13 +8242,13 @@\n ; it on SImode mem values.\n \n (define_insn \"flush\"\n-  [(unspec_volatile [(match_operand:SI 0 \"memory_operand\" \"m\")] 3)]\n+  [(unspec_volatile [(match_operand:SI 0 \"memory_operand\" \"m\")] UNSPECV_FLUSH)]\n   \"\"\n   \"* return TARGET_V9 ? \\\"flush\\\\t%f0\\\" : \\\"iflush\\\\t%f0\\\";\"\n   [(set_attr \"type\" \"misc\")])\n \n (define_insn \"flushdi\"\n-  [(unspec_volatile [(match_operand:DI 0 \"memory_operand\" \"m\")] 3)]\n+  [(unspec_volatile [(match_operand:DI 0 \"memory_operand\" \"m\")] UNSPECV_FLUSH)]\n   \"\"\n   \"* return TARGET_V9 ? \\\"flush\\\\t%f0\\\" : \\\"iflush\\\\t%f0\\\";\"\n   [(set_attr \"type\" \"misc\")])"}]}