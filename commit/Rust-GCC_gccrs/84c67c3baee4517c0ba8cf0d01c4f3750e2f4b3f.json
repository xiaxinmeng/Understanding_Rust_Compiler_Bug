{"sha": "84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODRjNjdjM2JhZWU0NTE3YzBiYThjZjBkMDFjNGYzNzUwZTJmNGIzZg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2013-10-02T23:49:39Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2013-10-02T23:49:39Z"}, "message": "runtime: Fix append of slice with elements of zero size.\n\nFrom-SVN: r203140", "tree": {"sha": "715beaa7cb3c8a67582868d206a664d831e8b67e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/715beaa7cb3c8a67582868d206a664d831e8b67e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f/comments", "author": null, "committer": null, "parents": [{"sha": "11b54a5a07970a1340eec04ddbd2f3b8c0597aae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11b54a5a07970a1340eec04ddbd2f3b8c0597aae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/11b54a5a07970a1340eec04ddbd2f3b8c0597aae"}], "stats": {"total": 12, "additions": 6, "deletions": 6}, "files": [{"sha": "8d5dee21616c2cd7557de2cf6ea8e7a8d82dd26f", "filename": "libgo/runtime/go-append.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f/libgo%2Fruntime%2Fgo-append.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f/libgo%2Fruntime%2Fgo-append.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fruntime%2Fgo-append.c?ref=84c67c3baee4517c0ba8cf0d01c4f3750e2f4b3f", "patch": "@@ -24,24 +24,24 @@ __go_append (struct __go_open_array a, void *bvalues, uintptr_t bcount,\n \t     uintptr_t element_size)\n {\n   uintptr_t ucount;\n-  int count;\n+  intgo count;\n \n   if (bvalues == NULL || bcount == 0)\n     return a;\n \n   ucount = (uintptr_t) a.__count + bcount;\n-  count = (int) ucount;\n+  count = (intgo) ucount;\n   if ((uintptr_t) count != ucount || count <= a.__count)\n     runtime_panicstring (\"append: slice overflow\");\n \n   if (count > a.__capacity)\n     {\n-      int m;\n+      intgo m;\n       void *n;\n \n       m = a.__capacity;\n-      if (m == 0)\n-\tm = (int) bcount;\n+      if (m + m < count)\n+\tm = count;\n       else\n \t{\n \t  do\n@@ -54,7 +54,7 @@ __go_append (struct __go_open_array a, void *bvalues, uintptr_t bcount,\n \t  while (m < count);\n \t}\n \n-      if ((uintptr) m > MaxMem / element_size)\n+      if (element_size > 0 && (uintptr) m > MaxMem / element_size)\n \truntime_panicstring (\"growslice: cap out of range\");\n \n       n = __go_alloc (m * element_size);"}]}