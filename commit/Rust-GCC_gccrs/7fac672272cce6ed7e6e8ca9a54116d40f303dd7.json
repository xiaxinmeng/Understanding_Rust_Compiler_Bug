{"sha": "7fac672272cce6ed7e6e8ca9a54116d40f303dd7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2ZhYzY3MjI3MmNjZTZlZDdlNmU4Y2E5YTU0MTE2ZDQwZjMwM2RkNw==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "rakdver@atrey.karlin.mff.cuni.cz", "date": "2004-09-12T20:20:58Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2004-09-12T20:20:58Z"}, "message": "tree-ssa-loop-manip.c (split_loop_exit_edge): Handle non-ssaname arguments of the phi nodes correctly.\n\n\t* tree-ssa-loop-manip.c (split_loop_exit_edge): Handle non-ssaname\n\targuments of the phi nodes correctly.\n\nFrom-SVN: r87405", "tree": {"sha": "92287a41e394dedad2c7931504cf35555ea68d16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/92287a41e394dedad2c7931504cf35555ea68d16"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7fac672272cce6ed7e6e8ca9a54116d40f303dd7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fac672272cce6ed7e6e8ca9a54116d40f303dd7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fac672272cce6ed7e6e8ca9a54116d40f303dd7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fac672272cce6ed7e6e8ca9a54116d40f303dd7/comments", "author": null, "committer": null, "parents": [{"sha": "8591459399b4773e629a008433fd4979e7bddd45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8591459399b4773e629a008433fd4979e7bddd45", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8591459399b4773e629a008433fd4979e7bddd45"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "59d386e5318d51e9821ab989160f9c7902d9fbe0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fac672272cce6ed7e6e8ca9a54116d40f303dd7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fac672272cce6ed7e6e8ca9a54116d40f303dd7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7fac672272cce6ed7e6e8ca9a54116d40f303dd7", "patch": "@@ -1,3 +1,8 @@\n+2004-09-12  Zdenek Dvorak  <rakdver@atrey.karlin.mff.cuni.cz>\n+\n+\t* tree-ssa-loop-manip.c (split_loop_exit_edge): Handle non-ssaname\n+\targuments of the phi nodes correctly.\n+\n 2004-09-12  Jan Hubicka  <jh@suse.cz>\n \n \t* ggc-common.c (cmp_statistics): Fix sorting."}, {"sha": "e6ff8a80559628d5d5dfb617b5565c8e2b7dfbcb", "filename": "gcc/tree-ssa-loop-manip.c", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fac672272cce6ed7e6e8ca9a54116d40f303dd7/gcc%2Ftree-ssa-loop-manip.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fac672272cce6ed7e6e8ca9a54116d40f303dd7/gcc%2Ftree-ssa-loop-manip.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-manip.c?ref=7fac672272cce6ed7e6e8ca9a54116d40f303dd7", "patch": "@@ -395,17 +395,26 @@ split_loop_exit_edge (edge exit)\n {\n   basic_block dest = exit->dest;\n   basic_block bb = loop_split_edge_with (exit, NULL);\n-  tree phi, new_phi, new_name;\n+  tree phi, new_phi, new_name, name;\n   use_operand_p op_p;\n \n   for (phi = phi_nodes (dest); phi; phi = TREE_CHAIN (phi))\n     {\n       op_p = PHI_ARG_DEF_PTR_FROM_EDGE (phi, bb->succ);\n \n-      new_name = duplicate_ssa_name (USE_FROM_PTR (op_p), NULL);\n+      name = USE_FROM_PTR (op_p);\n+\n+      /* If the argument of the phi node is a constant, we do not need\n+\t to keep it inside loop.  */\n+      if (TREE_CODE (name) != SSA_NAME)\n+\tcontinue;\n+\n+      /* Otherwise create an auxiliary phi node that will copy the value\n+\t of the ssa name out of the loop.  */\n+      new_name = duplicate_ssa_name (name, NULL);\n       new_phi = create_phi_node (new_name, bb);\n       SSA_NAME_DEF_STMT (new_name) = new_phi;\n-      add_phi_arg (&new_phi, USE_FROM_PTR (op_p), exit);\n+      add_phi_arg (&new_phi, name, exit);\n       SET_USE (op_p, new_name);\n     }\n }"}]}