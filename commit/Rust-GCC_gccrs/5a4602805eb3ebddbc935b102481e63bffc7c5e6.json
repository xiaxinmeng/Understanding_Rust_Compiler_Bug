{"sha": "5a4602805eb3ebddbc935b102481e63bffc7c5e6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWE0NjAyODA1ZWIzZWJkZGJjOTM1YjEwMjQ4MWU2M2JmZmM3YzVlNg==", "commit": {"author": {"name": "Ilia Diachkov", "email": "ilia.diachkov@optimitech.com", "date": "2019-06-27T23:41:03Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "2019-06-27T23:41:03Z"}, "message": "Add --disable-tm-clone-registry libgcc configure option.\n\nThis patch adds libgcc configuration option to disable TM clone \nregistry. This option helps to reduce code size for embedded targets \nwhich do not need transactional memory support.\n\n\tgcc/\n\t* doc/install.texi: Document --disable-tm-clone-registry.\n\tlibgcc/\n\t* Makefile.in (USE_TM_CLONE_REGISTRY): New.\n\t(CRTSTUFF_CFLAGS): Use USE_TM_CLONE_REGISTRY.\n\t* configure.ac: Add --disable-tm-clone-registry option.\n\t* configure: Regenerate.\n\nFrom-SVN: r272769", "tree": {"sha": "e2aab40a13c83c1b9ee1ec034d15962d39600354", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e2aab40a13c83c1b9ee1ec034d15962d39600354"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5a4602805eb3ebddbc935b102481e63bffc7c5e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a4602805eb3ebddbc935b102481e63bffc7c5e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a4602805eb3ebddbc935b102481e63bffc7c5e6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a4602805eb3ebddbc935b102481e63bffc7c5e6/comments", "author": null, "committer": null, "parents": [{"sha": "7ffc7de55b058e78cbc46803b89b712849ea35b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ffc7de55b058e78cbc46803b89b712849ea35b3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ffc7de55b058e78cbc46803b89b712849ea35b3"}], "stats": {"total": 45, "additions": 44, "deletions": 1}, "files": [{"sha": "f8bd2b21636e5670294a4a2820605ee10a5c8130", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a4602805eb3ebddbc935b102481e63bffc7c5e6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a4602805eb3ebddbc935b102481e63bffc7c5e6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5a4602805eb3ebddbc935b102481e63bffc7c5e6", "patch": "@@ -1,3 +1,7 @@\n+2019-06-27  Ilia Diachkov  <ilia.diachkov@optimitech.com>\n+\n+\t* doc/install.texi: Document --disable-tm-clone-registry.\n+\n 2019-06-27  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/91024"}, {"sha": "1a0e8c7d3f8bfe224c6826342fcb61d4e1127b27", "filename": "gcc/doc/install.texi", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a4602805eb3ebddbc935b102481e63bffc7c5e6/gcc%2Fdoc%2Finstall.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a4602805eb3ebddbc935b102481e63bffc7c5e6/gcc%2Fdoc%2Finstall.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finstall.texi?ref=5a4602805eb3ebddbc935b102481e63bffc7c5e6", "patch": "@@ -1284,6 +1284,11 @@ assumptions made by the configure test are incorrect.\n Specify that the target does not support TLS.\n This is an alias for @option{--enable-tls=no}.\n \n+@item --disable-tm-clone-registry\n+Disable TM clone registry in libgcc. It is enabled in libgcc by default.\n+This option helps to reduce code size for embedded targets which do\n+not use transactional memory.\n+\n @item --with-cpu=@var{cpu}\n @itemx --with-cpu-32=@var{cpu}\n @itemx --with-cpu-64=@var{cpu}"}, {"sha": "d69e55efdd0708abde219395cc46ff41abc0f658", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=5a4602805eb3ebddbc935b102481e63bffc7c5e6", "patch": "@@ -1,3 +1,10 @@\n+2019-06-27  Ilia Diachkov  <ilia.diachkov@optimitech.com>\n+\n+\t* Makefile.in (USE_TM_CLONE_REGISTRY): New.\n+\t(CRTSTUFF_CFLAGS): Use USE_TM_CLONE_REGISTRY.\n+\t* configure.ac: Add --disable-tm-clone-registry option.\n+\t* configure: Regenerate.\n+\n 2019-06-27  Martin Liska  <mliska@suse.cz>\n \n \t* libgcov-driver-system.c (gcov_exit_open_gcda_file): Remove obviously"}, {"sha": "e10a197a4efd2d8957b517ec0b91de3070d90452", "filename": "libgcc/Makefile.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FMakefile.in?ref=5a4602805eb3ebddbc935b102481e63bffc7c5e6", "patch": "@@ -259,6 +259,8 @@ PICFLAG = @PICFLAG@\n \n CET_FLAGS = @CET_FLAGS@\n \n+USE_TM_CLONE_REGISTRY = @use_tm_clone_registry@\n+\n # Defined in libgcc2.c, included only in the static library.\n LIB2FUNCS_ST = _eprintf __gcc_bcmp\n \n@@ -299,7 +301,7 @@ CRTSTUFF_CFLAGS = -O2 $(GCC_CFLAGS) $(INCLUDES) $(MULTILIB_CFLAGS) -g0 \\\n   $(NO_PIE_CFLAGS) -finhibit-size-directive -fno-inline -fno-exceptions \\\n   -fno-zero-initialized-in-bss -fno-toplevel-reorder -fno-tree-vectorize \\\n   -fbuilding-libgcc -fno-stack-protector $(FORCE_EXPLICIT_EH_REGISTRY) \\\n-  $(INHIBIT_LIBC_CFLAGS)\n+  $(INHIBIT_LIBC_CFLAGS) $(USE_TM_CLONE_REGISTRY)\n \n # Extra flags to use when compiling crt{begin,end}.o.\n CRTSTUFF_T_CFLAGS ="}, {"sha": "29f647319b463908f2273dba02bf985ce631cb9b", "filename": "libgcc/configure", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfigure?ref=5a4602805eb3ebddbc935b102481e63bffc7c5e6", "patch": "@@ -604,6 +604,7 @@ vis_hide\n solaris_ld_v2_maps\n real_host_noncanonical\n accel_dir_suffix\n+use_tm_clone_registry\n force_explicit_eh_registry\n CET_FLAGS\n fixed_point\n@@ -712,6 +713,7 @@ enable_decimal_float\n with_system_libunwind\n enable_cet\n enable_explicit_exception_frame_registration\n+enable_tm_clone_registry\n with_glibc_version\n enable_tls\n with_gcc_major_version_only\n@@ -1355,6 +1357,7 @@ Optional Features:\n                           register exception tables explicitly at module\n                           start, for use e.g. for compatibility with\n                           installations without PT_GNU_EH_FRAME support\n+  --disable-tm-clone-registry    disable TM clone registry\n   --enable-tls            Use thread-local storage [default=yes]\n \n Optional Packages:\n@@ -4953,6 +4956,18 @@ fi\n \n \n \n+# Check whether --enable-tm-clone-registry was given.\n+if test \"${enable_tm_clone_registry+set}\" = set; then :\n+  enableval=$enable_tm_clone_registry;\n+use_tm_clone_registry=\n+if test \"$enable_tm_clone_registry\" = no; then\n+  use_tm_clone_registry=-DUSE_TM_CLONE_REGISTRY=0\n+fi\n+\n+fi\n+\n+\n+\n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking if the linker ($LD) is GNU ld\" >&5\n $as_echo_n \"checking if the linker ($LD) is GNU ld... \" >&6; }\n if ${acl_cv_prog_gnu_ld+:} false; then :"}, {"sha": "b1b90d294ff43f735e5b2f62f34bfa8840888c6f", "filename": "libgcc/configure.ac", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5a4602805eb3ebddbc935b102481e63bffc7c5e6/libgcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfigure.ac?ref=5a4602805eb3ebddbc935b102481e63bffc7c5e6", "patch": "@@ -261,6 +261,16 @@ fi\n ])\n AC_SUBST([force_explicit_eh_registry])\n \n+AC_ARG_ENABLE([tm-clone-registry],\n+[  --disable-tm-clone-registry    disable TM clone registry],\n+[\n+use_tm_clone_registry=\n+if test \"$enable_tm_clone_registry\" = no; then\n+  use_tm_clone_registry=-DUSE_TM_CLONE_REGISTRY=0\n+fi\n+])\n+AC_SUBST([use_tm_clone_registry])\n+\n AC_LIB_PROG_LD_GNU\n \n AC_MSG_CHECKING([for thread model used by GCC])"}]}