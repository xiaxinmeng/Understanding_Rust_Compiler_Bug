{"sha": "4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGJlNjNkOWU1ZTQwNmM3Y2RlNDc5YzhjNjcxYWU5ZTljMTdjNTUyNg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2018-05-08T08:50:33Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2018-05-08T08:50:33Z"}, "message": "re PR bootstrap/85571 (non-bootstrap-debug miscompare with trunk)\n\n2018-05-08  Richard Biener  <rguenther@suse.de>\n\n\tPR bootstrap/85571\n\tconfig/\n\t* bootstrap-lto-noplugin.mk: Disable compare.\n\t* bootstrap-lto.mk: Supply contrib/compare-lto for do-compare.\n\n\tcontrib/\n\t* compare-lto: New script derived from compare-debug.\n\nFrom-SVN: r260026", "tree": {"sha": "5e13caae3ca581dc5fa0d2cc4bf9fd9bdd164db4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5e13caae3ca581dc5fa0d2cc4bf9fd9bdd164db4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ab7d466dc7ad61f8dfc69ffd6dd6faec4ac6a12f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab7d466dc7ad61f8dfc69ffd6dd6faec4ac6a12f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab7d466dc7ad61f8dfc69ffd6dd6faec4ac6a12f"}], "stats": {"total": 125, "additions": 125, "deletions": 0}, "files": [{"sha": "bebc20ee07594cbaf4744dca04ed23191c953d8f", "filename": "config/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/config%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/config%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2FChangeLog?ref=4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "patch": "@@ -1,3 +1,9 @@\n+2018-05-08  Richard Biener  <rguenther@suse.de>\n+\n+\tPR bootstrap/85571\n+\t* bootstrap-lto-noplugin.mk: Disable compare.\n+\t* bootstrap-lto.mk: Supply contrib/compare-lto for do-compare.\n+\n 2018-04-24  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR bootstrap/85490"}, {"sha": "0f50708e49d17f6314fde6fbc91910f33dcba01f", "filename": "config/bootstrap-lto-noplugin.mk", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/config%2Fbootstrap-lto-noplugin.mk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/config%2Fbootstrap-lto-noplugin.mk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Fbootstrap-lto-noplugin.mk?ref=4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "patch": "@@ -6,3 +6,4 @@ STAGE3_CFLAGS += -flto=jobserver -frandom-seed=1 -ffat-lto-objects\n STAGEprofile_CFLAGS += -flto=jobserver -frandom-seed=1\n STAGEtrain_CFLAGS += -flto=jobserver -frandom-seed=1\n STAGEfeedback_CFLAGS += -flto=jobserver -frandom-seed=1\n+do-compare = /bin/true"}, {"sha": "768b6337bd6a463bef7a919e630d9fb2fe5f776c", "filename": "config/bootstrap-lto.mk", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/config%2Fbootstrap-lto.mk", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/config%2Fbootstrap-lto.mk", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Fbootstrap-lto.mk?ref=4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "patch": "@@ -13,3 +13,5 @@ LTO_RANLIB = $$r/$(HOST_SUBDIR)/prev-gcc/gcc-ranlib$(exeext) -B$$r/$(HOST_SUBDIR\n LTO_EXPORTS = AR=\"$(LTO_AR)\"; export AR; \\\n \t      RANLIB=\"$(LTO_RANLIB)\"; export RANLIB;\n LTO_FLAGS_TO_PASS = AR=\"$(LTO_AR)\" RANLIB=\"$(LTO_RANLIB)\"\n+\n+do-compare = $(SHELL) $(srcdir)/contrib/compare-lto $$f1 $$f2"}, {"sha": "6c184f766b7159eda9261d4cd434bc66c7989770", "filename": "contrib/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "patch": "@@ -1,3 +1,8 @@\n+2018-05-08  Richard Biener  <rguenther@suse.de>\n+\n+\tPR bootstrap/85571\n+\t* compare-lto: New script derived from compare-debug.\n+\n 2018-05-02  Jakub Jelinek  <jakub@redhat.com>\n \n \t* gennews (files): Add files for GCC 8."}, {"sha": "17379e196a7bd47a8eabd21f132cafe70a375073", "filename": "contrib/compare-lto", "status": "added", "additions": 111, "deletions": 0, "changes": 111, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/contrib%2Fcompare-lto", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4be63d9e5e406c7cde479c8c671ae9e9c17c5526/contrib%2Fcompare-lto", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fcompare-lto?ref=4be63d9e5e406c7cde479c8c671ae9e9c17c5526", "patch": "@@ -0,0 +1,111 @@\n+#! /bin/sh\n+\n+# Compare copies of two given object files.\n+\n+# Copyright (C) 2007, 2008, 2009, 2010, 2012 Free Software Foundation\n+# Originally by Alexandre Oliva <aoliva@redhat.com>\n+# Modified for LTO bootstrap by Richard Biener <rguenther@suse.de>\n+\n+# This file is part of GCC.\n+\n+# GCC is free software; you can redistribute it and/or modify it under\n+# the terms of the GNU General Public License as published by the Free\n+# Software Foundation; either version 3, or (at your option) any later\n+# version.\n+\n+# GCC is distributed in the hope that it will be useful, but WITHOUT\n+# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY\n+# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public\n+# License for more details.\n+\n+# You should have received a copy of the GNU General Public License\n+# along with GCC; see the file COPYING3.  If not see\n+# <http://www.gnu.org/licenses/>.\n+\n+rm='rm -f'\n+\n+case $1 in\n+-p | --preserve)\n+  rm='echo preserving'\n+  shift\n+  ;;\n+esac\n+\n+if test $# != 2; then\n+  echo 'usage: compare-lto file1.o file2.o' >&2\n+  exit 1\n+fi\n+\n+if test ! -f \"$1\"; then\n+  echo \"$1\" does not exist >&2\n+  exit 1\n+fi\n+\n+if test ! -f \"$2\"; then\n+  echo \"$2\" does not exist >&2\n+  exit 1\n+fi\n+\n+suf1=stripped\n+while test -f \"$1.$suf1\"; do\n+  suf1=$suf1.\n+done\n+\n+suf2=stripped\n+while test -f \"$2.$suf2\"; do\n+  suf2=$suf2.\n+done\n+\n+trap 'rm -f \"$1.$suf1\" \"$2.$suf2\"' 0 1 2 15\n+\n+if cmp \"$1\" \"$2\"; then\n+  status=0\n+else\n+  status=1\n+\n+  cmd=\n+  for t in objdump readelf eu-readelf; do\n+    if ($t --help) 2>&1 | grep ' --\\[*section-\\]*headers' > /dev/null; then\n+      cmd=$t\n+      break\n+    fi\n+  done\n+\n+  # If there are LTO option sections, try to strip them off.\n+  if test \"x$cmd\" = \"x\" ||\n+     $cmd --section-headers \"$1\" | grep '.gnu.lto_.opts' > /dev/null ||\n+     $cmd --section-headers \"$2\" | grep '.gnu.lto_.opts' > /dev/null ; then\n+\n+    echo stripping off LTO option section, then retrying >&2\n+\n+    seclist=\".gnu.lto_.opts\"\n+    rsopts=`for sec in $seclist; do echo \" --remove-section $sec\"; done`\n+\n+    if (objcopy -v) 2>&1 | grep ' --remove-section' > /dev/null; then\n+      objcopy $rsopts \"$1\" \"$1.$suf1\"\n+      objcopy $rsopts \"$2\" \"$2.$suf2\"\n+    elif (strip --help) 2>&1 | grep ' --remove-section' > /dev/null; then\n+      cp \"$1\" \"$1.$suf1\"\n+      strip $rsopts \"$1.$suf1\"\n+\n+      cp \"$2\" \"$2.$suf2\"\n+      strip $rsopts \"$2.$suf2\"\n+    else\n+      echo failed to strip off LTO option section >&2\n+    fi\n+\n+    trap 'rm -f \"$1.$suf1\" \"$2.$suf2\"' 0 1 2 15\n+\n+    if cmp \"$1.$suf1\" \"$2.$suf2\"; then\n+      status=0\n+    else\n+      status=1\n+    fi\n+  fi\n+fi\n+\n+$rm \"$1.$suf1\" \"$2.$suf2\"\n+\n+trap \"exit $status; exit\" 0 1 2 15\n+\n+exit $status"}]}