{"sha": "709121b5a52e45f1bf29b56a9a4d813adf1dd292", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzA5MTIxYjVhNTJlNDVmMWJmMjliNTZhOWE0ZDgxM2FkZjFkZDI5Mg==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2010-06-18T12:44:26Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-18T12:44:26Z"}, "message": "sem_cat.adb (Validate_Object_Declaration): A variable declaration is not illegal per E.2.2(7) if...\n\n2010-06-18  Thomas Quinot  <quinot@adacore.com>\n\n\t* sem_cat.adb (Validate_Object_Declaration): A variable declaration is\n\tnot illegal per E.2.2(7) if it occurs in the private part of a\n\tRemote_Types unit.\n\nFrom-SVN: r160984", "tree": {"sha": "07ddaa2fe7730c7cbb982ab4b21b6f85692704f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/07ddaa2fe7730c7cbb982ab4b21b6f85692704f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/709121b5a52e45f1bf29b56a9a4d813adf1dd292", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/709121b5a52e45f1bf29b56a9a4d813adf1dd292", "html_url": "https://github.com/Rust-GCC/gccrs/commit/709121b5a52e45f1bf29b56a9a4d813adf1dd292", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/709121b5a52e45f1bf29b56a9a4d813adf1dd292/comments", "author": null, "committer": null, "parents": [{"sha": "bef228c2bf2176f6fd643e0e8debfe3cb956f380", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bef228c2bf2176f6fd643e0e8debfe3cb956f380", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bef228c2bf2176f6fd643e0e8debfe3cb956f380"}], "stats": {"total": 55, "additions": 26, "deletions": 29}, "files": [{"sha": "8653b021207a03d17e1059bf60d5cf1165c00cf7", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/709121b5a52e45f1bf29b56a9a4d813adf1dd292/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/709121b5a52e45f1bf29b56a9a4d813adf1dd292/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=709121b5a52e45f1bf29b56a9a4d813adf1dd292", "patch": "@@ -1,3 +1,9 @@\n+2010-06-18  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* sem_cat.adb (Validate_Object_Declaration): A variable declaration is\n+\tnot illegal per E.2.2(7) if it occurs in the private part of a\n+\tRemote_Types unit.\n+\n 2010-06-18  Arnaud Charlet  <charlet@adacore.com>\n \n \t* par-ch9.adb, sem_aggr.adb, sem_ch3.adb, layout.adb, sem_ch4.adb,\n@@ -17,7 +23,7 @@\n \n \t* par-labl.adb, restrict.adb, s-osinte-hpux-dce.ads, sem_ch11.adb,\n \texp_pakd.adb, s-filofl.ads, par-endh.adb, exp_intr.adb, sem_cat.adb,\n-\tsem_case.adb, exp_ch11.adb: Fix copyright notices.\n+\tsem_case.adb, exp_ch11.adb, s-osinte-linux.ads: Fix copyright notices.\n \n 2010-06-18  Geert Bosch  <bosch@adacore.com>\n "}, {"sha": "1cde64f474bd34c66c04672ff5896bb1298edbe8", "filename": "gcc/ada/sem_cat.adb", "status": "modified", "additions": 19, "deletions": 28, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/709121b5a52e45f1bf29b56a9a4d813adf1dd292/gcc%2Fada%2Fsem_cat.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/709121b5a52e45f1bf29b56a9a4d813adf1dd292/gcc%2Fada%2Fsem_cat.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_cat.adb?ref=709121b5a52e45f1bf29b56a9a4d813adf1dd292", "patch": "@@ -78,12 +78,12 @@ package body Sem_Cat is\n \n    function In_RCI_Declaration (N : Node_Id) return Boolean;\n    --  Determines if a declaration is  within the visible part of a Remote\n-   --  Call Interface compilation unit, for semantic checking purposes only,\n+   --  Call Interface compilation unit, for semantic checking purposes only\n    --  (returns false within an instance and within the package body).\n \n    function In_RT_Declaration return Boolean;\n-   --  Determines if current scope is within a Remote Types compilation unit,\n-   --  for semantic checking purposes.\n+   --  Determines if current scope is within the declaration of a Remote Types\n+   --  unit, for semantic checking purposes.\n \n    function Is_Non_Remote_Access_Type (E : Entity_Id) return Boolean;\n    --  Returns true if the entity is a type whose full view is a non-remote\n@@ -1061,27 +1061,25 @@ package body Sem_Cat is\n       --  Exclude generic specs from the checks (this will get rechecked\n       --  on instantiations).\n \n-      if Inside_A_Generic\n-        and then No (Enclosing_Generic_Body (Id))\n-      then\n+      if Inside_A_Generic and then No (Enclosing_Generic_Body (Id)) then\n          return;\n       end if;\n \n-      --  Required checks for declaration that is in a preelaborated\n-      --  package and is not within some subprogram.\n+      --  Required checks for declaration that is in a preelaborated package\n+      --  and is not within some subprogram.\n \n       if In_Preelaborated_Unit\n         and then not In_Subprogram_Or_Concurrent_Unit\n       then\n          --  Check for default initialized variable case. Note that in\n-         --  accordance with (RM B.1(24)) imported objects are not\n-         --  subject to default initialization.\n+         --  accordance with (RM B.1(24)) imported objects are not subject to\n+         --  default initialization.\n          --  If the initialization does not come from source and is an\n          --  aggregate, it is a static initialization that replaces an\n          --  implicit call, and must be treated as such.\n \n          if Present (E)\n-           and then\n+              and then\n             (Comes_From_Source (E) or else Nkind (E) /= N_Aggregate)\n          then\n             null;\n@@ -1210,13 +1208,8 @@ package body Sem_Cat is\n                elsif Nkind (Odf) = N_Subtype_Indication then\n                   Ent := Etype (Subtype_Mark (Odf));\n \n-               elsif\n-                  Nkind (Odf) = N_Constrained_Array_Definition\n-               then\n+               elsif Nkind (Odf) = N_Constrained_Array_Definition then\n                   Ent := Component_Type (T);\n-\n-               --  else\n-               --     return;\n                end if;\n \n                if Is_Task_Type (Ent)\n@@ -1230,9 +1223,9 @@ package body Sem_Cat is\n             end;\n          end if;\n \n-         --  Non-static discriminant not allowed in preelaborated unit\n-         --  Controlled object of a type with a user-defined Initialize\n-         --  is forbidden as well.\n+         --  Non-static discriminants not allowed in preelaborated unit.\n+         --  Objects of a controlled type with a user-defined Initialize\n+         --  are forbidden as well.\n \n          if Is_Record_Type (Etype (Id)) then\n             declare\n@@ -1247,8 +1240,8 @@ package body Sem_Cat is\n                   PEE := Parent (EE);\n \n                   if Nkind (PEE) = N_Full_Type_Declaration\n-                    and then not Static_Discriminant_Expr\n-                                  (Discriminant_Specifications (PEE))\n+                       and then not Static_Discriminant_Expr\n+                                     (Discriminant_Specifications (PEE))\n                   then\n                      Error_Msg_N\n                        (\"non-static discriminant in preelaborated unit\",\n@@ -1270,23 +1263,21 @@ package body Sem_Cat is\n       --  except within a subprogram, generic subprogram, task unit, or\n       --  protected unit (RM 10.2.1(16)).\n \n-      if In_Pure_Unit\n-        and then not In_Subprogram_Task_Protected_Unit\n-      then\n+      if In_Pure_Unit and then not In_Subprogram_Task_Protected_Unit then\n          Error_Msg_N (\"declaration of variable not allowed in pure unit\", N);\n \n       --  The visible part of an RCI library unit must not contain the\n       --  declaration of a variable (RM E.1.3(9))\n \n       elsif In_RCI_Declaration (N) then\n-         Error_Msg_N (\"declaration of variable not allowed in rci unit\", N);\n+         Error_Msg_N (\"visible variable not allowed in 'R'C'I unit\", N);\n \n       --  The visible part of a Shared Passive library unit must not contain\n       --  the declaration of a variable (RM E.2.2(7))\n \n-      elsif In_RT_Declaration then\n+      elsif In_RT_Declaration and then not In_Private_Part (Id) then\n          Error_Msg_N\n-           (\"variable declaration not allowed in remote types unit\", N);\n+           (\"visible variable not allowed in remote types unit\", N);\n       end if;\n \n    end Validate_Object_Declaration;"}]}