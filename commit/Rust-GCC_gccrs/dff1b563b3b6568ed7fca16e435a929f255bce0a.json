{"sha": "dff1b563b3b6568ed7fca16e435a929f255bce0a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGZmMWI1NjNiM2I2NTY4ZWQ3ZmNhMTZlNDM1YTkyOWYyNTViY2UwYQ==", "commit": {"author": {"name": "Volker Reichelt", "email": "reichelt@igpm.rwth-aachen.de", "date": "2005-08-22T08:37:17Z"}, "committer": {"name": "Volker Reichelt", "email": "reichelt@gcc.gnu.org", "date": "2005-08-22T08:37:17Z"}, "message": "re PR c++/23089 (internal compiler error: in int_mode_for_mode, at stor-layout.c:251 at -O1)\n\n\tPR c++/23089\n\t* decl.c (require_complete_types_for_parms): Mark incomplete types\n\tas invalid.\n\n\t* g++.dg/other/incomplete1.C: New test.\n\nFrom-SVN: r103336", "tree": {"sha": "a743cc6fe43598b6878637d2170353ef0e76afb5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a743cc6fe43598b6878637d2170353ef0e76afb5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dff1b563b3b6568ed7fca16e435a929f255bce0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dff1b563b3b6568ed7fca16e435a929f255bce0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dff1b563b3b6568ed7fca16e435a929f255bce0a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dff1b563b3b6568ed7fca16e435a929f255bce0a/comments", "author": null, "committer": null, "parents": [{"sha": "70a39602ab762d1cd7a1b34b9895598c81112fe0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/70a39602ab762d1cd7a1b34b9895598c81112fe0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/70a39602ab762d1cd7a1b34b9895598c81112fe0"}], "stats": {"total": 28, "additions": 24, "deletions": 4}, "files": [{"sha": "765ce9cc0b56e449afec14628f6b6747e589655a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dff1b563b3b6568ed7fca16e435a929f255bce0a", "patch": "@@ -1,3 +1,9 @@\n+2005-08-22  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\n+\tPR c++/23089\n+\t* decl.c (require_complete_types_for_parms): Mark incomplete types\n+\tas invalid.\n+\n 2005-08-19  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \t* parser.c (cp_parser_nth_token_starts_template_argument_list_p):"}, {"sha": "9929eb6b2c24230022d9755c881ea3129259e8d5", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=dff1b563b3b6568ed7fca16e435a929f255bce0a", "patch": "@@ -8305,14 +8305,16 @@ require_complete_types_for_parms (tree parms)\n     {\n       if (dependent_type_p (TREE_TYPE (parms)))\n \tcontinue;\n-      if (VOID_TYPE_P (TREE_TYPE (parms)))\n-\t/* grokparms will have already issued an error.  */\n-\tTREE_TYPE (parms) = error_mark_node;\n-      else if (complete_type_or_else (TREE_TYPE (parms), parms))\n+      if (!VOID_TYPE_P (TREE_TYPE (parms))\n+\t  && complete_type_or_else (TREE_TYPE (parms), parms))\n \t{\n \t  relayout_decl (parms);\n \t  DECL_ARG_TYPE (parms) = type_passed_as (TREE_TYPE (parms));\n \t}\n+      else\n+\t/* grokparms or complete_type_or_else will have already issued\n+\t   an error.  */\n+\tTREE_TYPE (parms) = error_mark_node;\n     }\n }\n "}, {"sha": "5d6a6823659fc9d8ae848e4f2c3b2201ff36df0f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dff1b563b3b6568ed7fca16e435a929f255bce0a", "patch": "@@ -1,3 +1,8 @@\n+2005-08-22  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\n+\tPR c++/23089\n+\t* g++.dg/other/incomplete1.C: New test.\n+\n 2005-08-22  Ira Rosen  <irar@il.ibm.com>   \n \n \t* gcc.dg/vect/vect-22.c: Add test for float. All four loops"}, {"sha": "cb7970fad1c22b22df3e497c872b3e94f886e219", "filename": "gcc/testsuite/g++.dg/other/incomplete1.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fincomplete1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dff1b563b3b6568ed7fca16e435a929f255bce0a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fincomplete1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fincomplete1.C?ref=dff1b563b3b6568ed7fca16e435a929f255bce0a", "patch": "@@ -0,0 +1,7 @@\n+// PR c++/23089\n+// Origin: Flash Sheridan  <flash@pobox.com>\n+// ICE on incomplete type\n+// { dg-do compile }\n+// { dg-options \"-O\" }\n+\n+void foo(struct A) {} // { dg-error \"incomplete type|forward declaration\" }"}]}