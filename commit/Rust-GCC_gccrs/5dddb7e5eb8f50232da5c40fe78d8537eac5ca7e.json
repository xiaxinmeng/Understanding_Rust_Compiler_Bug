{"sha": "5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWRkZGI3ZTVlYjhmNTAyMzJkYTVjNDBmZTc4ZDg1MzdlYWM1Y2E3ZQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2007-07-04T00:09:22Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2007-07-04T00:09:22Z"}, "message": "re PR libstdc++/31518 (_GLIBCXX_DEBUG error message formatter line width not configurable)\n\n2007-07-03  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/31518\n\t* include/debug/formatter.h (_Error_formatter::_M_get_max_length): New.\n\t(_Error_formatter::_Error_formatter): Use it.\n\t* src/debug.cc: Define.\n\t(_Error_formatter::_M_error): Tweak.\n\t* configure.ac: Adjust version to 6:10:0.\n\t* config/abi/pre/gnu.ver: Export _Error_formatter::_M_get_max_length\n\tat GLIBCXX_3.4.10.\n\t* testsuite/util/testsuite_abi.cc: Add GLIBCXX_3.4.10.\n\t* docs/html/debug.html: Document.\n\t* configure: Regenerate.\n\nFrom-SVN: r126287", "tree": {"sha": "8ff9db26af07bc74278effa0664ea1f0734438bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ff9db26af07bc74278effa0664ea1f0734438bf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/comments", "author": null, "committer": null, "parents": [{"sha": "e3ceb300c565aff0fc5e84cba60e4f715db62a27", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3ceb300c565aff0fc5e84cba60e4f715db62a27", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3ceb300c565aff0fc5e84cba60e4f715db62a27"}], "stats": {"total": 65, "additions": 58, "deletions": 7}, "files": [{"sha": "e467b5e62554758ba31e278c2984bb8eba2ee6e7", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -1,3 +1,17 @@\n+2007-07-03  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/31518\n+\t* include/debug/formatter.h (_Error_formatter::_M_get_max_length): New.\n+\t(_Error_formatter::_Error_formatter): Use it.\n+\t* src/debug.cc: Define.\n+\t(_Error_formatter::_M_error): Tweak.\n+\t* configure.ac: Adjust version to 6:10:0.\n+\t* config/abi/pre/gnu.ver: Export _Error_formatter::_M_get_max_length\n+\tat GLIBCXX_3.4.10.\n+\t* testsuite/util/testsuite_abi.cc: Add GLIBCXX_3.4.10.\n+\t* docs/html/debug.html: Document.\n+\t* configure: Regenerate.\n+\n 2007-07-02  Douglas Gregor  <doug.gregor@gmail.com>\n \n \t* testsuite/20_util/make_signed/requirements/typedefs_neg.cc:"}, {"sha": "a7f378dd236f408f4cccc9f6387aac3b6eab5830", "filename": "libstdc++-v3/config/abi/pre/gnu.ver", "status": "modified", "additions": 15, "deletions": 2, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fconfig%2Fabi%2Fpre%2Fgnu.ver", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fconfig%2Fabi%2Fpre%2Fgnu.ver", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Fabi%2Fpre%2Fgnu.ver?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -122,8 +122,8 @@ GLIBCXX_3.4 {\n       std::__num_base::_S_atoms_out;\n       std::__moneypunct_cache*;\n       std::__numpunct_cache*;\n-      std::__timepunct_cache*;\n-      __gnu_debug::_Error_formatter*\n+      std::__timepunct_cache*\n+#     __gnu_debug::_Error_formatter*\n     };\n \n     # Names not in an 'extern' block are mangled names.\n@@ -138,6 +138,13 @@ GLIBCXX_3.4 {\n     _ZNK11__gnu_debug19_Safe_iterator_base11_M_singularEv;\n     _ZNK11__gnu_debug19_Safe_iterator_base14_M_can_compareERKS0_;\n \n+    # __gnu_debug::_Error_formatter\n+    _ZNK11__gnu_debug16_Error_formatter10_M_message*;\n+    _ZNK11__gnu_debug16_Error_formatter10_Parameter*;\n+    _ZNK11__gnu_debug16_Error_formatter13_M_print_word*;\n+    _ZNK11__gnu_debug16_Error_formatter15_M_print_string*;\n+    _ZNK11__gnu_debug16_Error_formatter8_M_error*;\n+    \n     # std::string\n     _ZNSsC*;\n     _ZNSsD*;\n@@ -708,6 +715,12 @@ GLIBCXX_3.4.9 {\n \n } GLIBCXX_3.4.8;\n \n+GLIBCXX_3.4.10 {\n+\n+    _ZNK11__gnu_debug16_Error_formatter17_M_get_max_lengthEv;\n+\n+} GLIBCXX_3.4.9;\n+\n # Symbols in the support library (libsupc++) have their own tag.\n CXXABI_1.3 {\n "}, {"sha": "56368b1e5fc9a7909947e2c99a20baf3ac1a4460", "filename": "libstdc++-v3/configure", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -1547,7 +1547,7 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu\n ### am handles this now?  ORIGINAL_LD_FOR_MULTILIBS=$LD\n \n # For libtool versioning info, format is CURRENT:REVISION:AGE\n-libtool_VERSION=6:9:0\n+libtool_VERSION=6:10:0\n \n \n # Find the rest of the source tree framework."}, {"sha": "bbef6c16f06db07d2275842063ab900b2d1f2f53", "filename": "libstdc++-v3/configure.ac", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure.ac?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -12,7 +12,7 @@ AC_CONFIG_HEADER(config.h)\n ### am handles this now?  ORIGINAL_LD_FOR_MULTILIBS=$LD\n \n # For libtool versioning info, format is CURRENT:REVISION:AGE\n-libtool_VERSION=6:9:0\n+libtool_VERSION=6:10:0\n AC_SUBST(libtool_VERSION)\n \n # Find the rest of the source tree framework."}, {"sha": "6013115fe13375a687e5f1d38f9854b774926d8d", "filename": "libstdc++-v3/docs/html/debug.html", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Fdebug.html", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Fdebug.html", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdocs%2Fhtml%2Fdebug.html?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -136,6 +136,11 @@ <h4 class=\"left\">Using the libstdc++ debug mode</h4>\n   instantiation of a container is passed between the two translation\n   units.</p>\n \n+<p>By default, error messages are formatted to fit on lines of about\n+  78 characters.  The environment variable\n+  <code>GLIBCXX_DEBUG_MESSAGE_LENGTH</code> can be used to request a\n+  different length.</p>\n+\n <p>For information about the design of the libstdc++ debug mode,\n   please see the <a href=\"debug_mode.html\">libstdc++ debug mode design\n   document</a>.</p>"}, {"sha": "8a0565f708b6453b2020d88188f9667f13af8c64", "filename": "libstdc++-v3/include/debug/formatter.h", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fformatter.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fformatter.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fformatter.h?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -1,6 +1,6 @@\n // Debug-mode error formatting implementation -*- C++ -*-\n \n-// Copyright (C) 2003, 2004, 2005, 2006 Free Software Foundation, Inc.\n+// Copyright (C) 2003, 2004, 2005, 2006, 2007 Free Software Foundation, Inc.\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -359,7 +359,7 @@ namespace __gnu_debug\n     _Error_formatter(const char* __file, size_t __line)\n     : _M_file(__file), _M_line(__line), _M_num_parameters(0), _M_text(0),\n       _M_max_length(78), _M_column(1), _M_first_line(true), _M_wordwrap(false)\n-    { }\n+    { _M_get_max_length(); }\n \n     template<typename _Tp>\n       void\n@@ -371,6 +371,9 @@ namespace __gnu_debug\n     void\n     _M_print_string(const char* __string) const;\n \n+    void\n+    _M_get_max_length() const;\n+\n     enum { __max_parameters = 9 };\n \n     const char*         _M_file;"}, {"sha": "0391368a131c9d1b6346c70dbd14991f64442c6b", "filename": "libstdc++-v3/src/debug.cc", "status": "modified", "additions": 16, "deletions": 1, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fsrc%2Fdebug.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Fsrc%2Fdebug.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fdebug.cc?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -36,6 +36,7 @@\n #include <cstring>\n #include <cctype>\n #include <cstdio>\n+#include <cstdlib>\n \n using namespace std;\n \n@@ -496,7 +497,8 @@ namespace __gnu_debug\n \t_M_column += strlen(__buf);\n       }\n     \n-    _M_wordwrap = true;\n+    if (_M_max_length)\n+      _M_wordwrap = true;\n     _M_print_word(\"error: \");\n     \n     // Print the error message\n@@ -671,6 +673,19 @@ namespace __gnu_debug\n       }\n   }\n \n+  void\n+  _Error_formatter::_M_get_max_length() const\n+  {\n+    const char* __nptr = std::getenv(\"GLIBCXX_DEBUG_MESSAGE_LENGTH\");\n+    if (__nptr)\n+      {\n+\tchar* __endptr;\n+\tconst unsigned long __ret = std::strtoul(__nptr, &__endptr, 0);\n+\tif (*__nptr != '\\0' && *__endptr == '\\0')\n+\t  _M_max_length = __ret;\n+      }\n+  }\n+\n   // Instantiations.\n   template\n     void"}, {"sha": "5c49cbbe96f8dcc9b106027aa97efbee58d2364e", "filename": "libstdc++-v3/testsuite/util/testsuite_abi.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Ftestsuite%2Futil%2Ftestsuite_abi.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e/libstdc%2B%2B-v3%2Ftestsuite%2Futil%2Ftestsuite_abi.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Futil%2Ftestsuite_abi.cc?ref=5dddb7e5eb8f50232da5c40fe78d8537eac5ca7e", "patch": "@@ -189,6 +189,7 @@ check_version(symbol& test, bool added)\n       known_versions.push_back(\"GLIBCXX_3.4.7\");\n       known_versions.push_back(\"GLIBCXX_3.4.8\");\n       known_versions.push_back(\"GLIBCXX_3.4.9\");\n+      known_versions.push_back(\"GLIBCXX_3.4.10\");\n       known_versions.push_back(\"GLIBCXX_LDBL_3.4\");\n       known_versions.push_back(\"GLIBCXX_LDBL_3.4.7\");\n       known_versions.push_back(\"CXXABI_1.3\");"}]}