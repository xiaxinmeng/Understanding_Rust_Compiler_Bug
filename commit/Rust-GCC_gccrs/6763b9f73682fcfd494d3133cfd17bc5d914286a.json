{"sha": "6763b9f73682fcfd494d3133cfd17bc5d914286a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Njc2M2I5ZjczNjgyZmNmZDQ5NGQzMTMzY2ZkMTdiYzVkOTE0Mjg2YQ==", "commit": {"author": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2013-11-29T01:30:42Z"}, "committer": {"name": "Joseph Myers", "email": "jsm28@gcc.gnu.org", "date": "2013-11-29T01:30:42Z"}, "message": "re PR c/57574 (-std=c99 inline function incorrectly has external linkage with prior static declaration)\n\n\tPR c/57574\nc:\n\t* c-decl.c (merge_decls): Clear DECL_EXTERNAL for a definition of\n\tan inline function following a static declaration.\n\ntestsuite:\n\t* gcc.dg/inline-35.c: New test.\n\nFrom-SVN: r205506", "tree": {"sha": "40fc29c743ee6ca77329f7595611e4100a4b9bd1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/40fc29c743ee6ca77329f7595611e4100a4b9bd1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6763b9f73682fcfd494d3133cfd17bc5d914286a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6763b9f73682fcfd494d3133cfd17bc5d914286a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6763b9f73682fcfd494d3133cfd17bc5d914286a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6763b9f73682fcfd494d3133cfd17bc5d914286a/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b76f5d160b9922e4513a146c82d304ce8c07e167", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b76f5d160b9922e4513a146c82d304ce8c07e167", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b76f5d160b9922e4513a146c82d304ce8c07e167"}], "stats": {"total": 38, "additions": 38, "deletions": 0}, "files": [{"sha": "7016ecb4bf9f9f2169a93de7ba626c01de57d1e3", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=6763b9f73682fcfd494d3133cfd17bc5d914286a", "patch": "@@ -1,3 +1,9 @@\n+2013-11-29  Joseph Myers  <joseph@codesourcery.com>\n+\n+\tPR c/57574\n+\t* c-decl.c (merge_decls): Clear DECL_EXTERNAL for a definition of\n+\tan inline function following a static declaration.\n+\n 2013-11-28  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/59310"}, {"sha": "27be7fc1b031ba6d42e0c973cef967c0f5b74482", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=6763b9f73682fcfd494d3133cfd17bc5d914286a", "patch": "@@ -2343,6 +2343,14 @@ merge_decls (tree newdecl, tree olddecl, tree newtype, tree oldtype)\n       && !current_function_decl)\n     DECL_EXTERNAL (newdecl) = 0;\n \n+  /* An inline definition following a static declaration is not\n+     DECL_EXTERNAL.  */\n+  if (new_is_definition\n+      && (DECL_DECLARED_INLINE_P (newdecl)\n+\t  || DECL_DECLARED_INLINE_P (olddecl))\n+      && !TREE_PUBLIC (olddecl))\n+    DECL_EXTERNAL (newdecl) = 0;\n+\n   if (DECL_EXTERNAL (newdecl))\n     {\n       TREE_STATIC (newdecl) = TREE_STATIC (olddecl);"}, {"sha": "cbe455eb0aa6ed92c9fe91b6fb1a11477fb18e35", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6763b9f73682fcfd494d3133cfd17bc5d914286a", "patch": "@@ -1,3 +1,8 @@\n+2013-11-29  Joseph Myers  <joseph@codesourcery.com>\n+\n+\tPR c/57574\n+\t* gcc.dg/inline-35.c: New test.\n+\n 2013-11-28  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/59297"}, {"sha": "ebbb8df2fe1a1d90ce9f9f995d9fcd2181d586fc", "filename": "gcc/testsuite/gcc.dg/inline-35.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Ftestsuite%2Fgcc.dg%2Finline-35.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6763b9f73682fcfd494d3133cfd17bc5d914286a/gcc%2Ftestsuite%2Fgcc.dg%2Finline-35.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Finline-35.c?ref=6763b9f73682fcfd494d3133cfd17bc5d914286a", "patch": "@@ -0,0 +1,19 @@\n+/* A function definition of an inline function following a static\n+   declaration does not make an inline definition in C99/C11 terms.\n+   PR 57574.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c99 -pedantic-errors\" } */\n+\n+static int n;\n+\n+static inline int f1 (void);\n+inline int f1 (void) { return n; }\n+\n+static int f2 (void);\n+inline int f2 (void) { return n; }\n+\n+static inline int f3 (void);\n+int f3 (void) { return n; }\n+\n+static int f4 (void);\n+int f4 (void) { return n; }"}]}