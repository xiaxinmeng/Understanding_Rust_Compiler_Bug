{"sha": "abe08645a03e20da9af03cf1a1e9b288dfba4af8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWJlMDg2NDVhMDNlMjBkYTlhZjAzY2YxYTFlOWIyODhkZmJhNGFmOA==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2008-04-02T14:32:02Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2008-04-02T14:32:02Z"}, "message": "i386.c (bdesc_sse_3arg): Add __builtin_ia32_shufps and __builtin_ia32_shufpd.\n\n2008-04-02  H.J. Lu  <hongjiu.lu@intel.com>\n\n\t* config/i386/i386.c (bdesc_sse_3arg): Add __builtin_ia32_shufps\n\tand __builtin_ia32_shufpd.  Provide __builtin_ia32_roundsd and\n\t__builtin_ia32_roundss.\n\t(ix86_init_mmx_sse_builtins): Remove __builtin_ia32_shufps,\n\t__builtin_ia32_shufpd, __builtin_ia32_roundsd and\n\t__builtin_ia32_roundss.\n\t(ix86_expand_builtin): Don't handle IX86_BUILTIN_SHUFPS and\n\tIX86_BUILTIN_SHUFPD here.\n\nFrom-SVN: r133838", "tree": {"sha": "335147a5a6aa31b026700a96459e04aa97247e81", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/335147a5a6aa31b026700a96459e04aa97247e81"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/abe08645a03e20da9af03cf1a1e9b288dfba4af8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abe08645a03e20da9af03cf1a1e9b288dfba4af8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/abe08645a03e20da9af03cf1a1e9b288dfba4af8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abe08645a03e20da9af03cf1a1e9b288dfba4af8/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "94237c92ef2182d07f68ee45fedf20b2afbe26ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94237c92ef2182d07f68ee45fedf20b2afbe26ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94237c92ef2182d07f68ee45fedf20b2afbe26ae"}], "stats": {"total": 64, "additions": 19, "deletions": 45}, "files": [{"sha": "703fd01589aa002a40c8eb8b6e988b568b5b7f7c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abe08645a03e20da9af03cf1a1e9b288dfba4af8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abe08645a03e20da9af03cf1a1e9b288dfba4af8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=abe08645a03e20da9af03cf1a1e9b288dfba4af8", "patch": "@@ -1,3 +1,14 @@\n+2008-04-02  H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\t* config/i386/i386.c (bdesc_sse_3arg): Add __builtin_ia32_shufps\n+\tand __builtin_ia32_shufpd.  Provide __builtin_ia32_roundsd and\n+\t__builtin_ia32_roundss.\n+\t(ix86_init_mmx_sse_builtins): Remove __builtin_ia32_shufps,\n+\t__builtin_ia32_shufpd, __builtin_ia32_roundsd and\n+\t__builtin_ia32_roundss.\n+\t(ix86_expand_builtin): Don't handle IX86_BUILTIN_SHUFPS and\n+\tIX86_BUILTIN_SHUFPD here.\n+\n 2008-04-02  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* config/i386/i386.md (plogic): New."}, {"sha": "080286ceb6f34c4b846ac42f64d91f34c49ae92f", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 8, "deletions": 45, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abe08645a03e20da9af03cf1a1e9b288dfba4af8/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abe08645a03e20da9af03cf1a1e9b288dfba4af8/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=abe08645a03e20da9af03cf1a1e9b288dfba4af8", "patch": "@@ -17932,6 +17932,12 @@ static const struct builtin_description bdesc_crc32[] =\n /* SSE builtins with 3 arguments and the last argument must be an immediate or xmm0.  */\n static const struct builtin_description bdesc_sse_3arg[] =\n {\n+  /* SSE */\n+  { OPTION_MASK_ISA_SSE, CODE_FOR_sse_shufps, \"__builtin_ia32_shufps\", IX86_BUILTIN_SHUFPS, UNKNOWN, 0 },\n+\n+  /* SSE2 */\n+  { OPTION_MASK_ISA_SSE2, CODE_FOR_sse2_shufpd, \"__builtin_ia32_shufpd\", IX86_BUILTIN_SHUFPD, UNKNOWN, 0 },\n+\n   /* SSE4.1 */\n   { OPTION_MASK_ISA_SSE4_1, CODE_FOR_sse4_1_blendpd, \"__builtin_ia32_blendpd\", IX86_BUILTIN_BLENDPD, UNKNOWN, 0 },\n   { OPTION_MASK_ISA_SSE4_1, CODE_FOR_sse4_1_blendps, \"__builtin_ia32_blendps\", IX86_BUILTIN_BLENDPS, UNKNOWN, 0 },\n@@ -17943,8 +17949,8 @@ static const struct builtin_description bdesc_sse_3arg[] =\n   { OPTION_MASK_ISA_SSE4_1, CODE_FOR_sse4_1_mpsadbw, \"__builtin_ia32_mpsadbw128\", IX86_BUILTIN_MPSADBW128, UNKNOWN, 0 },\n   { OPTION_MASK_ISA_SSE4_1, CODE_FOR_sse4_1_pblendvb, \"__builtin_ia32_pblendvb128\", IX86_BUILTIN_PBLENDVB128, UNKNOWN, 0 },\n   { OPTION_MASK_ISA_SSE4_1, CODE_FOR_sse4_1_pblendw, \"__builtin_ia32_pblendw128\", IX86_BUILTIN_PBLENDW128, UNKNOWN, 0 },\n-  { OPTION_MASK_ISA_ROUND, CODE_FOR_sse4_1_roundsd, 0, IX86_BUILTIN_ROUNDSD, UNKNOWN, 0 },\n-  { OPTION_MASK_ISA_ROUND, CODE_FOR_sse4_1_roundss, 0, IX86_BUILTIN_ROUNDSS, UNKNOWN, 0 },\n+  { OPTION_MASK_ISA_ROUND, CODE_FOR_sse4_1_roundsd, \"__builtin_ia32_roundsd\", IX86_BUILTIN_ROUNDSD, UNKNOWN, 0 },\n+  { OPTION_MASK_ISA_ROUND, CODE_FOR_sse4_1_roundss, \"__builtin_ia32_roundss\", IX86_BUILTIN_ROUNDSS, UNKNOWN, 0 },\n };\n \n static const struct builtin_description bdesc_2arg[] =\n@@ -19376,8 +19382,6 @@ ix86_init_mmx_sse_builtins (void)\n   def_builtin_const (OPTION_MASK_ISA_SSE, \"__builtin_ia32_sqrtps_nr\", v4sf_ftype_v4sf, IX86_BUILTIN_SQRTPS_NR);\n   def_builtin_const (OPTION_MASK_ISA_SSE, \"__builtin_ia32_sqrtss\", v4sf_ftype_v4sf, IX86_BUILTIN_SQRTSS);\n \n-  def_builtin_const (OPTION_MASK_ISA_SSE, \"__builtin_ia32_shufps\", v4sf_ftype_v4sf_v4sf_int, IX86_BUILTIN_SHUFPS);\n-\n   /* Original 3DNow!  */\n   def_builtin (OPTION_MASK_ISA_3DNOW, \"__builtin_ia32_femms\", void_ftype_void, IX86_BUILTIN_FEMMS);\n   def_builtin_const (OPTION_MASK_ISA_3DNOW, \"__builtin_ia32_pavgusb\", v8qi_ftype_v8qi_v8qi, IX86_BUILTIN_PAVGUSB);\n@@ -19431,8 +19435,6 @@ ix86_init_mmx_sse_builtins (void)\n   def_builtin_const (OPTION_MASK_ISA_SSE2, \"__builtin_ia32_sqrtpd\", v2df_ftype_v2df, IX86_BUILTIN_SQRTPD);\n   def_builtin_const (OPTION_MASK_ISA_SSE2, \"__builtin_ia32_sqrtsd\", v2df_ftype_v2df, IX86_BUILTIN_SQRTSD);\n \n-  def_builtin_const (OPTION_MASK_ISA_SSE2, \"__builtin_ia32_shufpd\", v2df_ftype_v2df_v2df_int, IX86_BUILTIN_SHUFPD);\n-\n   def_builtin_const (OPTION_MASK_ISA_SSE2, \"__builtin_ia32_cvtdq2pd\", v2df_ftype_v4si, IX86_BUILTIN_CVTDQ2PD);\n   def_builtin_const (OPTION_MASK_ISA_SSE2, \"__builtin_ia32_cvtdq2ps\", v4sf_ftype_v4si, IX86_BUILTIN_CVTDQ2PS);\n \n@@ -19519,8 +19521,6 @@ ix86_init_mmx_sse_builtins (void)\n   /* SSE4.1 and SSE5 */\n   def_builtin_const (OPTION_MASK_ISA_ROUND, \"__builtin_ia32_roundpd\", v2df_ftype_v2df_int, IX86_BUILTIN_ROUNDPD);\n   def_builtin_const (OPTION_MASK_ISA_ROUND, \"__builtin_ia32_roundps\", v4sf_ftype_v4sf_int, IX86_BUILTIN_ROUNDPS);\n-  def_builtin_const (OPTION_MASK_ISA_ROUND, \"__builtin_ia32_roundsd\", v2df_ftype_v2df_v2df_int, IX86_BUILTIN_ROUNDSD);\n-  def_builtin_const (OPTION_MASK_ISA_ROUND, \"__builtin_ia32_roundss\", v4sf_ftype_v4sf_v4sf_int, IX86_BUILTIN_ROUNDSS);\n \n   /* SSE4.2. */\n   ftype = build_function_type_list (unsigned_type_node,\n@@ -20791,43 +20791,6 @@ ix86_expand_builtin (tree exp, rtx target, rtx subtarget ATTRIBUTE_UNUSED,\n       emit_insn (gen_sse_stmxcsr (target));\n       return copy_to_mode_reg (SImode, target);\n \n-    case IX86_BUILTIN_SHUFPS:\n-    case IX86_BUILTIN_SHUFPD:\n-      icode = (fcode == IX86_BUILTIN_SHUFPS\n-\t       ? CODE_FOR_sse_shufps\n-\t       : CODE_FOR_sse2_shufpd);\n-      arg0 = CALL_EXPR_ARG (exp, 0);\n-      arg1 = CALL_EXPR_ARG (exp, 1);\n-      arg2 = CALL_EXPR_ARG (exp, 2);\n-      op0 = expand_normal (arg0);\n-      op1 = expand_normal (arg1);\n-      op2 = expand_normal (arg2);\n-      tmode = insn_data[icode].operand[0].mode;\n-      mode0 = insn_data[icode].operand[1].mode;\n-      mode1 = insn_data[icode].operand[2].mode;\n-      mode2 = insn_data[icode].operand[3].mode;\n-\n-      if (! (*insn_data[icode].operand[1].predicate) (op0, mode0))\n-\top0 = copy_to_mode_reg (mode0, op0);\n-      if ((optimize && !register_operand (op1, mode1))\n-\t  || !(*insn_data[icode].operand[2].predicate) (op1, mode1))\n-\top1 = copy_to_mode_reg (mode1, op1);\n-      if (! (*insn_data[icode].operand[3].predicate) (op2, mode2))\n-\t{\n-\t  /* @@@ better error message */\n-\t  error (\"mask must be an immediate\");\n-\t  return gen_reg_rtx (tmode);\n-\t}\n-      if (optimize || target == 0\n-\t  || GET_MODE (target) != tmode\n-\t  || ! (*insn_data[icode].operand[0].predicate) (target, tmode))\n-\ttarget = gen_reg_rtx (tmode);\n-      pat = GEN_FCN (icode) (target, op0, op1, op2);\n-      if (! pat)\n-\treturn 0;\n-      emit_insn (pat);\n-      return target;\n-\n     case IX86_BUILTIN_PSHUFW:\n     case IX86_BUILTIN_PSHUFD:\n     case IX86_BUILTIN_PSHUFHW:"}]}