{"sha": "c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzBmODFmNzhhZTlhYTM5MzFiM2I1NDcyZWIxMzhmZjM4MTVkMTBkZQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2009-10-24T10:11:46Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2009-10-24T10:11:46Z"}, "message": "re PR fortran/41772 (Wrong code due to TRANSFER of EMPTY array section)\n\n2009-10-24  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/41772\n\t* trans-intrinsic.c (gfc_conv_intrinsic_transfer): Stop'extent'\n\tfrom going negative.\n\n2009-10-24  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/41772\n\t* gfortran.dg/transfer_intrinsic_3.f90.\n\nFrom-SVN: r153524", "tree": {"sha": "f452f5f60bd73aae0cda761c395451b394c5a89d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f452f5f60bd73aae0cda761c395451b394c5a89d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/comments", "author": null, "committer": null, "parents": [{"sha": "72580319c22c1b44c6c6284a65ef021a20d7b8c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/72580319c22c1b44c6c6284a65ef021a20d7b8c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/72580319c22c1b44c6c6284a65ef021a20d7b8c2"}], "stats": {"total": 51, "additions": 51, "deletions": 0}, "files": [{"sha": "cf6c8cd2dcb38510a1e7801e52de12e4593e2615", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "patch": "@@ -1,3 +1,9 @@\n+2009-10-24  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/41772\n+\t* trans-intrinsic.c (gfc_conv_intrinsic_transfer): Stop'extent'\n+\tfrom going negative.\n+\n 2009-10-23  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/41800"}, {"sha": "c3d7dfbab3c5ad816138a80fd268c8cd036c2f75", "filename": "gcc/fortran/trans-intrinsic.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ffortran%2Ftrans-intrinsic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ffortran%2Ftrans-intrinsic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-intrinsic.c?ref=c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "patch": "@@ -4490,6 +4490,8 @@ gfc_conv_intrinsic_transfer (gfc_se * se, gfc_expr * expr)\n scalar_transfer:\n   extent = fold_build2 (MIN_EXPR, gfc_array_index_type,\n \t\t\tdest_word_len, source_bytes);\n+  extent = fold_build2 (MAX_EXPR, gfc_array_index_type,\n+\t\t\textent, gfc_index_zero_node);\n \n   if (expr->ts.type == BT_CHARACTER)\n     {"}, {"sha": "676b5a73a5540fe3d22fee9dee3d9f4613d5a1e6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "patch": "@@ -1,3 +1,8 @@\n+2009-10-24  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/41772\n+\t* gfortran.dg/transfer_intrinsic_3.f90.\n+\n 2009-10-24  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/opt4.adb: New test."}, {"sha": "f0b9b5468779f6210b107ac723c36dd907a23195", "filename": "gcc/testsuite/gfortran.dg/transfer_intrinsic_3.f90", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ftestsuite%2Fgfortran.dg%2Ftransfer_intrinsic_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c0f81f78ae9aa3931b3b5472eb138ff3815d10de/gcc%2Ftestsuite%2Fgfortran.dg%2Ftransfer_intrinsic_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftransfer_intrinsic_3.f90?ref=c0f81f78ae9aa3931b3b5472eb138ff3815d10de", "patch": "@@ -0,0 +1,38 @@\n+! { dg-do run }\n+! Tests the fix for PR41772 in which the empty array reference\n+! 'qname(1:n-1)' was not handled correctly in TRANSFER.\n+!\n+! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n+!\n+module m\n+  implicit none\n+contains\n+  pure function str_vs(vs) result(s)\n+    character, dimension(:), intent(in) :: vs\n+    character(len=size(vs)) :: s\n+    s = transfer(vs, s)\n+  end function str_vs\n+  subroutine has_key_ns(uri, localname, n)\n+    character(len=*), intent(in) :: uri, localname\n+    integer, intent(in) :: n\n+    if ((n .lt. 2) .and. (len (uri) .ne. 0)) then\n+      call abort\n+    else IF ((n .ge. 2) .and. (len (uri) .ne. n - 1)) then \n+      call abort\n+    end if\n+  end subroutine\n+end module m\n+\n+  use m\n+  implicit none\n+  character, dimension(:), pointer :: QName\n+  integer :: n\n+  allocate(qname(6))\n+  qname = (/ 'a','b','c','d','e','f' /)\n+\n+  do n = 0, 3\n+    call has_key_ns(str_vs(qname(1:n-1)),\"\", n)\n+  end do\n+  deallocate(qname)\n+end\n+! { dg-final { cleanup-modules \"m\" } }\n\\ No newline at end of file"}]}