{"sha": "4cd5da011d6174e7cb152913acac760fb4a84c11", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGNkNWRhMDExZDYxNzRlN2NiMTUyOTEzYWNhYzc2MGZiNGE4NGMxMQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2018-11-21T17:32:19Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-11-21T17:32:19Z"}, "message": "re PR ipa/87957 (ICE tree check: expected tree that contains \u2018decl minimal\u2019 structure, have \u2018identifier_node\u2019 in warn_odr, at ipa-devirt.c:1051 since r265519)\n\n\n\tPR lto/87957\n\t* g++.dg/lto/odr-1_0.C: Extend by mismatched enum.\n\t* g++.dg/lto/odr-1_1.C: Extend by mismatched enum.\n\t* g++.dg/lto/odr-2_0.C: New.\n\t* g++.dg/lto/odr-2_0.C: New.\n\t* g++.dg/lto/odr-3_1.C: New.\n\t* g++.dg/lto/odr-3_1.C: New.\n\nFrom-SVN: r266351", "tree": {"sha": "3809bd2fab9dc119640e0c94018c8599998c76e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3809bd2fab9dc119640e0c94018c8599998c76e7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4cd5da011d6174e7cb152913acac760fb4a84c11", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4cd5da011d6174e7cb152913acac760fb4a84c11", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4cd5da011d6174e7cb152913acac760fb4a84c11", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4cd5da011d6174e7cb152913acac760fb4a84c11/comments", "author": null, "committer": null, "parents": [{"sha": "7424b7c13940c36700db8cd19a6f16d75af07b50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7424b7c13940c36700db8cd19a6f16d75af07b50", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7424b7c13940c36700db8cd19a6f16d75af07b50"}], "stats": {"total": 62, "additions": 56, "deletions": 6}, "files": [{"sha": "29b0c83fc8961fd17a85d4780b0fdb59c32b6649", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4cd5da011d6174e7cb152913acac760fb4a84c11", "patch": "@@ -1,3 +1,13 @@\n+2018-11-21  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR lto/87957\n+\t* g++.dg/lto/odr-1_0.C: Extend by mismatched enum.\n+\t* g++.dg/lto/odr-1_1.C: Extend by mismatched enum.\n+\t* g++.dg/lto/odr-2_0.C: New.\n+\t* g++.dg/lto/odr-2_0.C: New.\n+\t* g++.dg/lto/odr-3_1.C: New.\n+\t* g++.dg/lto/odr-3_1.C: New.\n+\n 2018-11-21  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/87839"}, {"sha": "6fff88844c302f24e670661a72614b163c511641", "filename": "gcc/testsuite/g++.dg/lto/odr-1_0.C", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-1_0.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-1_0.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-1_0.C?ref=4cd5da011d6174e7cb152913acac760fb4a84c11", "patch": "@@ -1,8 +1,11 @@\n // PR c++/82414\n // { dg-lto-do link }\n+enum vals {aa,cc}; // { dg-lto-warning \"6: type 'vals' violates the C\\\\+\\\\+ One Definition Rule\" }\n struct a { // { dg-lto-warning \"8: type 'struct a' violates the C\\\\+\\\\+ One Definition Rule\" }\n   struct b *ptr; // { dg-lto-message \"13: the first difference of corresponding definitions is field 'ptr'\" }\n+  enum vals vals;\n };\n-void test(struct a *)\n+void test(struct a *a)\n {\n+  a->vals = cc;\n }"}, {"sha": "33a13f01bf27a3134efb6eb5854de42cb2cae20e", "filename": "gcc/testsuite/g++.dg/lto/odr-1_1.C", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-1_1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-1_1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-1_1.C?ref=4cd5da011d6174e7cb152913acac760fb4a84c11", "patch": "@@ -1,12 +1,16 @@\n namespace {\n-  struct b;\n+  struct b; // { dg-lto-message \"type 'struct b' defined in anonymous namespace can not match across the translation unit boundary\" }\n  }\n-struct a {\n-  struct b *ptr;\n-};\n+enum vals {aa,bb,cc}; // { dg-lto-message \"an enum with different value name is defined in another translation unit\" }\n+struct a { // { dg-lto-message \"a different type is defined in another translation unit\" }\n+  struct b *ptr; // { dg-lto-message \"a field of same name but different type is defined in another translation unit\" }\n+  enum vals vals;\n+} a;\n void test(struct a *);\n int\n main(void)\n {\n-  test (0);\n+  test (&a);\n+  if (a.vals==aa)\n+    return 1;\n }"}, {"sha": "222fa2c1db9b948d6c7c0db37b44ca5ed0e33fe8", "filename": "gcc/testsuite/g++.dg/lto/odr-2_0.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_0.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_0.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_0.C?ref=4cd5da011d6174e7cb152913acac760fb4a84c11", "patch": "@@ -0,0 +1,8 @@\n+// { dg-lto-do link }\n+// { dg-lto-options { { -O0 -flto }  } \n+enum a {} b; // { dg-lto-warning \"6: type 'a' violates the C\\\\+\\\\+ One Definition Rule\" }\n+int\n+main(void)\n+{\n+  return 0;\n+}"}, {"sha": "f384ae893b79e9a9aeb8225cddbd6573c061dda9", "filename": "gcc/testsuite/g++.dg/lto/odr-2_1.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-2_1.C?ref=4cd5da011d6174e7cb152913acac760fb4a84c11", "patch": "@@ -0,0 +1,4 @@\n+class a { // { dg-lto-message \"a different type is defined in another translation unit\" }\n+  int *b() const;\n+};\n+int *a::b() const { return 0; }"}, {"sha": "bfa6c0bea1e213a2670389e4baf4b0efb202426b", "filename": "gcc/testsuite/g++.dg/lto/odr-3_0.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_0.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_0.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_0.C?ref=4cd5da011d6174e7cb152913acac760fb4a84c11", "patch": "@@ -0,0 +1,12 @@\n+// { dg-lto-do link }\n+// { dg-lto-options { -O0 -flto }  } \n+\n+typedef struct {\n+  int a; // { dg-lto-message \"the first difference of corresponding definitions is field 'a'\" }\n+} YYSTYPE; // { dg-lto-warning \"3: warning: type \u2018struct YYSTYPE\u2019 violates the C\\\\+\\\\+ One Definition Rule\" }\n+union yyalloc { // { dg-lto-warning \"7: type \u2018union yyalloc\u2019 violates the C\\\\+\\\\+ One Definition Rule\" }\n+  short yyss;\n+  YYSTYPE yyvs; // { dg-lto-message \"the first difference of corresponding definitions is field \u2018yyvs\u2019\" }\n+};\n+void b() { yyalloc c; }\n+"}, {"sha": "8a4448625553845de71bec776cf26ab19cb126fe", "filename": "gcc/testsuite/g++.dg/lto/odr-3_1.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cd5da011d6174e7cb152913acac760fb4a84c11/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fodr-3_1.C?ref=4cd5da011d6174e7cb152913acac760fb4a84c11", "patch": "@@ -0,0 +1,9 @@\n+typedef struct YYSTYPE { // { dg-lto-message \":16 a different type is defined in another translation unit\" }\n+} YYSTYPE;\n+union yyalloc { \n+  short yyss;\n+  YYSTYPE yyvs; // { dg-lto-message \"the first difference of corresponding definitions is field \u2018yyvs\u2019\" }\n+\n+};\n+void a() { yyalloc b; }\n+"}]}