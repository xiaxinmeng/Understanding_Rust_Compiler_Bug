{"sha": "cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2FjNzhlYTI4MTRhMzVhOGU3OTdiYTBlZDZhYjFmMjQ1MzFkZjE4YQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2000-11-22T22:43:49Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2000-11-22T22:43:49Z"}, "message": "pt.c (do_decl_instantiate): Explicitly clone constructors and destructors that haven't already been cloned.\n\n\t* pt.c (do_decl_instantiate): Explicitly clone constructors and\n\tdestructors that haven't already been cloned.\n\nFrom-SVN: r37673", "tree": {"sha": "c8e4c38b3a0dc7cfc437bf28e92fbe711fd71519", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c8e4c38b3a0dc7cfc437bf28e92fbe711fd71519"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/comments", "author": null, "committer": null, "parents": [{"sha": "57f56af4c574c7b7185cdf211ebe4877a0ca877a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/57f56af4c574c7b7185cdf211ebe4877a0ca877a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/57f56af4c574c7b7185cdf211ebe4877a0ca877a"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "ef02d3d889ad972e58c5bbf7fc646a4d28f79100", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "patch": "@@ -1,3 +1,8 @@\n+2000-11-22  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* pt.c (do_decl_instantiate): Explicitly clone constructors and\n+\tdestructors that haven't already been cloned.\n+\n 2000-11-20  Richard Henderson  <rth@redhat.com>\n \n \t* parse.y (yyparse_1): Rename the parser entry point."}, {"sha": "ddcdf8a433172429b9510010b720d7268b59ead7", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "patch": "@@ -9214,6 +9214,15 @@ do_decl_instantiation (declspecs, declarator, storage)\n     cp_error (\"storage class `%D' applied to template instantiation\",\n \t      storage);\n \n+  /* Under the new ABI, we need to make sure to instantiate all the\n+     cloned versions of constructors or destructors.  */\n+  if (flag_new_abi &&\n+      (DECL_MAYBE_IN_CHARGE_CONSTRUCTOR_P (result) || \n+       DECL_MAYBE_IN_CHARGE_DESTRUCTOR_P (result)) &&\n+      !(TREE_CHAIN (result) && \n+\tDECL_CLONED_FUNCTION (TREE_CHAIN (result))))\n+    clone_function_decl(result, /*update_method_vec_p=*/0);\n+      \n   SET_DECL_EXPLICIT_INSTANTIATION (result);\n   mark_decl_instantiated (result, extern_p);\n   repo_template_instantiated (result, extern_p);"}, {"sha": "9990ca29322d5a943e0d451b28b6b3d7d700d96a", "filename": "gcc/testsuite/g++.old-deja/g++.other/ctor1-aux.cc", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fctor1-aux.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fctor1-aux.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fctor1-aux.cc?ref=cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "patch": "@@ -0,0 +1,12 @@\n+// Origin: Mark Mitchell <mark@codesourcery.com>\n+\n+template <class T>\n+struct S {\n+  template <class U>\n+  S (U);\n+};\n+\n+int main ()\n+{\n+  S<int> (3.0);\n+}"}, {"sha": "1c67d0aa84658084f012494d2ba9906855ac8a35", "filename": "gcc/testsuite/g++.old-deja/g++.other/ctor1.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fctor1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cac78ea2814a35a8e797ba0ed6ab1f24531df18a/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fctor1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fctor1.C?ref=cac78ea2814a35a8e797ba0ed6ab1f24531df18a", "patch": "@@ -0,0 +1,14 @@\n+// Additional sources: ctor1-aux.cc\n+// Origin: Mark Mitchell <mark@codesourcery.com>\n+\n+template <class T>\n+struct S {\n+  template <class U>\n+  S (U);\n+};\n+\n+template <class T>\n+template <class U>\n+S<T>::S (U) {}\n+\n+template S<int>::S (double);"}]}