{"sha": "557c4b493bcfbda45babb0752455798328849630", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTU3YzRiNDkzYmNmYmRhNDViYWJiMDc1MjQ1NTc5ODMyODg0OTYzMA==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2013-12-09T20:02:33Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2013-12-09T20:02:33Z"}, "message": "Eliminate SET_BASIC_BLOCK macro.\n\ngcc/\n\t* basic-block.h (SET_BASIC_BLOCK): Eliminate macro.\n\n\t* cfg.c (compact_blocks): Replace uses of SET_BASIC_BLOCK\n\twith SET_BASIC_BLOCK_FOR_FN, making use of cfun explicit.\n\t(expunge_block): Likewise.\n\t* cfgrtl.c (create_basic_block_structure): Likewise.\n\t* df-core.c (df_compact_blocks, df_bb_replace): Likewise.\n\t* sel-sched.c (create_block_for_bookkeeping): Likewise.\n\t* tree-cfg.c (create_bb): Likewise.\n\nFrom-SVN: r205821", "tree": {"sha": "28af56a0f26a4692c16613add501bc7186b7be8e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/28af56a0f26a4692c16613add501bc7186b7be8e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/557c4b493bcfbda45babb0752455798328849630", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/557c4b493bcfbda45babb0752455798328849630", "html_url": "https://github.com/Rust-GCC/gccrs/commit/557c4b493bcfbda45babb0752455798328849630", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/557c4b493bcfbda45babb0752455798328849630/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ea19eb9fba65626b303781048830f5db22a1cfa5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea19eb9fba65626b303781048830f5db22a1cfa5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea19eb9fba65626b303781048830f5db22a1cfa5"}], "stats": {"total": 39, "additions": 25, "deletions": 14}, "files": [{"sha": "6ee43fe119793da50db2dbf13bc54e0f25aff2dc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/557c4b493bcfbda45babb0752455798328849630/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/557c4b493bcfbda45babb0752455798328849630/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=557c4b493bcfbda45babb0752455798328849630", "patch": "@@ -1,3 +1,15 @@\n+2013-12-09  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* basic-block.h (SET_BASIC_BLOCK): Eliminate macro.\n+\n+\t* cfg.c (compact_blocks): Replace uses of SET_BASIC_BLOCK\n+\twith SET_BASIC_BLOCK_FOR_FN, making use of cfun explicit.\n+\t(expunge_block): Likewise.\n+\t* cfgrtl.c (create_basic_block_structure): Likewise.\n+\t* df-core.c (df_compact_blocks, df_bb_replace): Likewise.\n+\t* sel-sched.c (create_block_for_bookkeeping): Likewise.\n+\t* tree-cfg.c (create_bb): Likewise.\n+\n 2013-12-09  David Malcolm  <dmalcolm@redhat.com>\n \n \t* basic-block.h (profile_status_for_function): Rename to..."}, {"sha": "f759e27897382b271ef4ccc5c0430ee478b9f437", "filename": "gcc/basic-block.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/557c4b493bcfbda45babb0752455798328849630/gcc%2Fbasic-block.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/557c4b493bcfbda45babb0752455798328849630/gcc%2Fbasic-block.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbasic-block.h?ref=557c4b493bcfbda45babb0752455798328849630", "patch": "@@ -333,7 +333,6 @@ struct GTY(()) control_flow_graph {\n #define profile_status\t\t(cfun->cfg->x_profile_status)\n \n #define BASIC_BLOCK(N)\t\t((*basic_block_info)[(N)])\n-#define SET_BASIC_BLOCK(N,BB)\t((*basic_block_info)[(N)] = (BB))\n \n /* For iterating over basic blocks.  */\n #define FOR_BB_BETWEEN(BB, FROM, TO, DIR) \\"}, {"sha": "f3861688a12b37d237e7948e4ec0110b180d154f", "filename": "gcc/cfg.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/557c4b493bcfbda45babb0752455798328849630/gcc%2Fcfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/557c4b493bcfbda45babb0752455798328849630/gcc%2Fcfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfg.c?ref=557c4b493bcfbda45babb0752455798328849630", "patch": "@@ -153,8 +153,8 @@ compact_blocks (void)\n {\n   int i;\n \n-  SET_BASIC_BLOCK (ENTRY_BLOCK, ENTRY_BLOCK_PTR_FOR_FN (cfun));\n-  SET_BASIC_BLOCK (EXIT_BLOCK, EXIT_BLOCK_PTR_FOR_FN (cfun));\n+  SET_BASIC_BLOCK_FOR_FN (cfun, ENTRY_BLOCK, ENTRY_BLOCK_PTR_FOR_FN (cfun));\n+  SET_BASIC_BLOCK_FOR_FN (cfun, EXIT_BLOCK, EXIT_BLOCK_PTR_FOR_FN (cfun));\n \n   if (df)\n     df_compact_blocks ();\n@@ -165,14 +165,14 @@ compact_blocks (void)\n       i = NUM_FIXED_BLOCKS;\n       FOR_EACH_BB (bb)\n \t{\n-\t  SET_BASIC_BLOCK (i, bb);\n+\t  SET_BASIC_BLOCK_FOR_FN (cfun, i, bb);\n \t  bb->index = i;\n \t  i++;\n \t}\n       gcc_assert (i == n_basic_blocks_for_fn (cfun));\n \n       for (; i < last_basic_block; i++)\n-\tSET_BASIC_BLOCK (i, NULL);\n+\tSET_BASIC_BLOCK_FOR_FN (cfun, i, NULL);\n     }\n   last_basic_block = n_basic_blocks_for_fn (cfun);\n }\n@@ -183,7 +183,7 @@ void\n expunge_block (basic_block b)\n {\n   unlink_block (b);\n-  SET_BASIC_BLOCK (b->index, NULL);\n+  SET_BASIC_BLOCK_FOR_FN (cfun, b->index, NULL);\n   n_basic_blocks_for_fn (cfun)--;\n   /* We should be able to ggc_free here, but we are not.\n      The dead SSA_NAMES are left pointing to dead statements that are pointing"}, {"sha": "045d78b745353304329b39da166676c220c4bb1f", "filename": "gcc/cfgrtl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/557c4b493bcfbda45babb0752455798328849630/gcc%2Fcfgrtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/557c4b493bcfbda45babb0752455798328849630/gcc%2Fcfgrtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgrtl.c?ref=557c4b493bcfbda45babb0752455798328849630", "patch": "@@ -331,7 +331,7 @@ create_basic_block_structure (rtx head, rtx end, rtx bb_note, basic_block after)\n   bb->index = last_basic_block++;\n   bb->flags = BB_NEW | BB_RTL;\n   link_block (bb, after);\n-  SET_BASIC_BLOCK (bb->index, bb);\n+  SET_BASIC_BLOCK_FOR_FN (cfun, bb->index, bb);\n   df_bb_refs_record (bb->index, false);\n   update_bb_for_insn (bb);\n   BB_SET_PARTITION (bb, BB_UNPARTITIONED);"}, {"sha": "4fb92a96f5445ad76ddc98e428f4d806668a21eb", "filename": "gcc/df-core.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/557c4b493bcfbda45babb0752455798328849630/gcc%2Fdf-core.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/557c4b493bcfbda45babb0752455798328849630/gcc%2Fdf-core.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdf-core.c?ref=557c4b493bcfbda45babb0752455798328849630", "patch": "@@ -1601,15 +1601,15 @@ df_compact_blocks (void)\n   i = NUM_FIXED_BLOCKS;\n   FOR_EACH_BB (bb)\n     {\n-      SET_BASIC_BLOCK (i, bb);\n+      SET_BASIC_BLOCK_FOR_FN (cfun, i, bb);\n       bb->index = i;\n       i++;\n     }\n \n   gcc_assert (i == n_basic_blocks_for_fn (cfun));\n \n   for (; i < last_basic_block; i++)\n-    SET_BASIC_BLOCK (i, NULL);\n+    SET_BASIC_BLOCK_FOR_FN (cfun, i, NULL);\n \n #ifdef DF_DEBUG_CFG\n   if (!df_lr->solutions_dirty)\n@@ -1645,10 +1645,10 @@ df_bb_replace (int old_index, basic_block new_block)\n     }\n \n   df_clear_bb_dirty (new_block);\n-  SET_BASIC_BLOCK (old_index, new_block);\n+  SET_BASIC_BLOCK_FOR_FN (cfun, old_index, new_block);\n   new_block->index = old_index;\n   df_set_bb_dirty (BASIC_BLOCK (old_index));\n-  SET_BASIC_BLOCK (new_block_index, NULL);\n+  SET_BASIC_BLOCK_FOR_FN (cfun, new_block_index, NULL);\n }\n \n "}, {"sha": "1195f7e6c197ec50af37f482c706159887be2837", "filename": "gcc/sel-sched.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/557c4b493bcfbda45babb0752455798328849630/gcc%2Fsel-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/557c4b493bcfbda45babb0752455798328849630/gcc%2Fsel-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsel-sched.c?ref=557c4b493bcfbda45babb0752455798328849630", "patch": "@@ -4663,8 +4663,8 @@ create_block_for_bookkeeping (edge e1, edge e2)\n \t      new_bb->index = succ->index;\n \t      succ->index = i;\n \n-\t      SET_BASIC_BLOCK (new_bb->index, new_bb);\n-\t      SET_BASIC_BLOCK (succ->index, succ);\n+\t      SET_BASIC_BLOCK_FOR_FN (cfun, new_bb->index, new_bb);\n+\t      SET_BASIC_BLOCK_FOR_FN (cfun, succ->index, succ);\n \n \t      memcpy (&gbi, SEL_GLOBAL_BB_INFO (new_bb), sizeof (gbi));\n \t      memcpy (SEL_GLOBAL_BB_INFO (new_bb), SEL_GLOBAL_BB_INFO (succ),"}, {"sha": "2d7916bde5a4f02184616d004d89b13d39494f56", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/557c4b493bcfbda45babb0752455798328849630/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/557c4b493bcfbda45babb0752455798328849630/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=557c4b493bcfbda45babb0752455798328849630", "patch": "@@ -610,7 +610,7 @@ create_bb (void *h, void *e, basic_block after)\n     }\n \n   /* Add the newly created block to the array.  */\n-  SET_BASIC_BLOCK (last_basic_block, bb);\n+  SET_BASIC_BLOCK_FOR_FN (cfun, last_basic_block, bb);\n \n   n_basic_blocks_for_fn (cfun)++;\n   last_basic_block++;"}]}