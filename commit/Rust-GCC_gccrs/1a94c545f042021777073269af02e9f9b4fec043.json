{"sha": "1a94c545f042021777073269af02e9f9b4fec043", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWE5NGM1NDVmMDQyMDIxNzc3MDczMjY5YWYwMmU5ZjliNGZlYzA0Mw==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2004-09-20T20:41:20Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2004-09-20T20:41:20Z"}, "message": "cgraph.c (cgraph_unnest_node): New function.\n\n\n\n\t* cgraph.c (cgraph_unnest_node): New function.\n\t(c_finalize): Rename to ....\n\t(c_warn_unused_result_recursivly): ... this one; do only the warning\n\t(finish_function): Finalize the toplevel function; do not lower nested tree.\n\t* cgraph.h (cgraph_unnest_node): Declare.\n\t* cgraphunit.c (decide_is_function_needed): Do not use cgraph\n\tnestedness datastructure.\n\t* cse.c (cse_insn): Do not cprop nonlocal LABEL_REFs.\n\t* reload1.c (set_label_offsets): Fix call of set_label_offsets.\n\t* tree-nested.c (finlize_nesting_tree_1):  Use un-nesting code.\n\nFrom-SVN: r87771", "tree": {"sha": "10b51dfad17b69271ca926de3da9916c61f5d835", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/10b51dfad17b69271ca926de3da9916c61f5d835"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a94c545f042021777073269af02e9f9b4fec043", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a94c545f042021777073269af02e9f9b4fec043", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a94c545f042021777073269af02e9f9b4fec043", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a94c545f042021777073269af02e9f9b4fec043/comments", "author": null, "committer": null, "parents": [{"sha": "8f2353433c31121e5ec31f24d70b80c385fb28ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f2353433c31121e5ec31f24d70b80c385fb28ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8f2353433c31121e5ec31f24d70b80c385fb28ff"}], "stats": {"total": 30, "additions": 15, "deletions": 15}, "files": [{"sha": "76c1a08d3b423f33d5712968775776a1656337e8", "filename": "gcc/c-decl.c", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a94c545f042021777073269af02e9f9b4fec043/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a94c545f042021777073269af02e9f9b4fec043/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=1a94c545f042021777073269af02e9f9b4fec043", "patch": "@@ -6128,30 +6128,21 @@ store_parm_decls (void)\n   cfun->x_dont_save_pending_sizes_p = 1;\n }\n \f\n-/* Give FNDECL and all its nested functions to cgraph for compilation.  */\n+/* Handle attribute((warn_unused_result)) on FNDECL and all its nested\n+   functions.  */\n \n static void\n-c_finalize (tree fndecl)\n+c_warn_unused_result_recursively (tree fndecl)\n {\n   struct cgraph_node *cgn;\n \n   /* Handle attribute((warn_unused_result)).  Relies on gimple input.  */\n   c_warn_unused_result (&DECL_SAVED_TREE (fndecl));\n \n-  /* ??? Objc emits functions after finalizing the compilation unit.\n-     This should be cleaned up later and this conditional removed.  */\n-  if (cgraph_global_info_ready)\n-    {\n-      c_expand_body (fndecl);\n-      return;\n-    }\n-\n   /* Finalize all nested functions now.  */\n   cgn = cgraph_node (fndecl);\n   for (cgn = cgn->nested; cgn ; cgn = cgn->next_nested)\n-    c_finalize (cgn->decl);\n-\n-  cgraph_finalize_function (fndecl, false);\n+    c_warn_unused_result_recursively (cgn->decl);\n }\n \n /* Finish up a function declaration and compile that function\n@@ -6255,8 +6246,17 @@ finish_function (void)\n       if (!decl_function_context (fndecl))\n         {\n           c_genericize (fndecl);\n-\t  lower_nested_functions (fndecl);\n-          c_finalize (fndecl);\n+          c_warn_unused_result_recursively (fndecl);\n+\n+\t  /* ??? Objc emits functions after finalizing the compilation unit.\n+\t     This should be cleaned up later and this conditional removed.  */\n+\t  if (cgraph_global_info_ready)\n+\t    {\n+\t      c_expand_body (fndecl);\n+\t      return;\n+\t    }\n+\n+\t  cgraph_finalize_function (fndecl, false);\n         }\n       else\n         {"}]}