{"sha": "37d8632b512e4b4b04aea3f951f52af8bd440bfe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzdkODYzMmI1MTJlNGI0YjA0YWVhM2Y5NTFmNTJhZjhiZDQ0MGJmZQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2011-10-14T19:12:45Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2011-10-14T19:12:45Z"}, "message": "re PR c++/50707 ([C++0x] Non-static const data member initializer breaks default constructor)\n\n\tPR c++/50507\n\t* method.c (walk_field_subobs): Check for NSDMI before\n\tcomplaining about uninitialized fields.\n\nFrom-SVN: r180002", "tree": {"sha": "bec75e49be0d594387c1a64a48851279bbe40227", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bec75e49be0d594387c1a64a48851279bbe40227"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/37d8632b512e4b4b04aea3f951f52af8bd440bfe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37d8632b512e4b4b04aea3f951f52af8bd440bfe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37d8632b512e4b4b04aea3f951f52af8bd440bfe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37d8632b512e4b4b04aea3f951f52af8bd440bfe/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c3646b46fadff29620b2f188b9f566c95d40c580", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3646b46fadff29620b2f188b9f566c95d40c580", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3646b46fadff29620b2f188b9f566c95d40c580"}], "stats": {"total": 59, "additions": 40, "deletions": 19}, "files": [{"sha": "b55e2947bc438eb1f44028ba7f2923a4e96e0c4a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=37d8632b512e4b4b04aea3f951f52af8bd440bfe", "patch": "@@ -1,5 +1,9 @@\n 2011-10-14  Jason Merrill  <jason@redhat.com>\n \n+\tPR c++/50507\n+\t* method.c (walk_field_subobs): Check for NSDMI before\n+\tcomplaining about uninitialized fields.\n+\n \t* pt.c (tsubst_decl) [FIELD_DECL]: Use void_zero_node\n \tinstead of error_mark_node as a placeholder.\n "}, {"sha": "0718f47d743e7d15ed3192e7294380ba5438a5f1", "filename": "gcc/cp/method.c", "status": "modified", "additions": 21, "deletions": 19, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Fcp%2Fmethod.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Fcp%2Fmethod.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmethod.c?ref=37d8632b512e4b4b04aea3f951f52af8bd440bfe", "patch": "@@ -1016,25 +1016,7 @@ walk_field_subobs (tree fields, tree fnname, special_function_kind sfk,\n \t}\n       else if (sfk == sfk_constructor)\n \t{\n-\t  bool bad = true;\n-\t  if (CP_TYPE_CONST_P (mem_type)\n-\t      && default_init_uninitialized_part (mem_type))\n-\t    {\n-\t      if (msg)\n-\t\terror (\"uninitialized non-static const member %q#D\",\n-\t\t       field);\n-\t    }\n-\t  else if (TREE_CODE (mem_type) == REFERENCE_TYPE)\n-\t    {\n-\t      if (msg)\n-\t\terror (\"uninitialized non-static reference member %q#D\",\n-\t\t       field);\n-\t    }\n-\t  else\n-\t    bad = false;\n-\n-\t  if (bad && deleted_p)\n-\t    *deleted_p = true;\n+\t  bool bad;\n \n \t  if (DECL_INITIAL (field))\n \t    {\n@@ -1057,6 +1039,26 @@ walk_field_subobs (tree fields, tree fnname, special_function_kind sfk,\n \t      continue;\n \t    }\n \n+\t  bad = false;\n+\t  if (CP_TYPE_CONST_P (mem_type)\n+\t      && default_init_uninitialized_part (mem_type))\n+\t    {\n+\t      if (msg)\n+\t\terror (\"uninitialized non-static const member %q#D\",\n+\t\t       field);\n+\t      bad = true;\n+\t    }\n+\t  else if (TREE_CODE (mem_type) == REFERENCE_TYPE)\n+\t    {\n+\t      if (msg)\n+\t\terror (\"uninitialized non-static reference member %q#D\",\n+\t\t       field);\n+\t      bad = true;\n+\t    }\n+\n+\t  if (bad && deleted_p)\n+\t    *deleted_p = true;\n+\n \t  /* For an implicitly-defined default constructor to be constexpr,\n \t     every member must have a user-provided default constructor or\n \t     an explicit initializer.  */"}, {"sha": "80ef91c87f97935f691c95e52042366ef88cb4f6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=37d8632b512e4b4b04aea3f951f52af8bd440bfe", "patch": "@@ -1,3 +1,8 @@\n+2011-10-14  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/50507\n+\t* g++.dg/cpp0x/nsdmi-const1.C: New.\n+\n 2011-10-14  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/50570"}, {"sha": "ddf9f04c580a3211063e5c4037718cc93fb438ad", "filename": "gcc/testsuite/g++.dg/cpp0x/nsdmi-const1.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fnsdmi-const1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37d8632b512e4b4b04aea3f951f52af8bd440bfe/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fnsdmi-const1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fnsdmi-const1.C?ref=37d8632b512e4b4b04aea3f951f52af8bd440bfe", "patch": "@@ -0,0 +1,10 @@\n+// PR c++/50707\n+// { dg-options -std=c++0x }\n+\n+int g;\n+\n+struct S {\n+   int const v=g;\n+};\n+\n+S s;"}]}