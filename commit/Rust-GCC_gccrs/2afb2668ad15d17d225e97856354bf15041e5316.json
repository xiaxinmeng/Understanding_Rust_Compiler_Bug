{"sha": "2afb2668ad15d17d225e97856354bf15041e5316", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmFmYjI2NjhhZDE1ZDE3ZDIyNWU5Nzg1NjM1NGJmMTUwNDFlNTMxNg==", "commit": {"author": {"name": "Carl Love", "email": "cel@us.ibm.com", "date": "2017-09-12T15:14:32Z"}, "committer": {"name": "Carl Love", "email": "carll@gcc.gnu.org", "date": "2017-09-12T15:14:32Z"}, "message": "altivec.md (vec_widen_umult_even_v4si, [...]): Add define expands for vmuleuw, vmulesw, vmulouw, vmulosw.\n\ngcc/ChangeLog:\n\n2017-09-12  Carl Love  <cel@us.ibm.com>\n\n        * config/rs6000/altivec.md (vec_widen_umult_even_v4si,\n\tvec_widen_smult_even_v4si): Add define expands for vmuleuw, vmulesw,\n\tvmulouw, vmulosw.\n        * config/rs6000/rs6000-builtin.def (VMLEUW, VMULESW, VMULOUW,\n        VMULOSW): Add definitions.\n        * config/rs6000/rs6000-c.c (altivec_overloaded_builtins): Add\n        ALTIVEC_BUILTIN_VMULESW, ALTIVEC_BUILTIN_VMULEUW,\n        ALTIVEC_BUILTIN_VMULOSW, ALTIVEC_BUILTIN_VMULOUW entries.\n        * config/rs6000/rs6000.c (rs6000_gimple_fold_builtin,\n        builtin_function_type): Add ALTIVEC_BUILTIN_* case statements.\n\nFrom-SVN: r252027", "tree": {"sha": "528384f1bc854468627af1c75f5695154f97ae76", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/528384f1bc854468627af1c75f5695154f97ae76"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2afb2668ad15d17d225e97856354bf15041e5316", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2afb2668ad15d17d225e97856354bf15041e5316", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2afb2668ad15d17d225e97856354bf15041e5316", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2afb2668ad15d17d225e97856354bf15041e5316/comments", "author": {"login": "carlelove", "id": 86435705, "node_id": "MDQ6VXNlcjg2NDM1NzA1", "avatar_url": "https://avatars.githubusercontent.com/u/86435705?v=4", "gravatar_id": "", "url": "https://api.github.com/users/carlelove", "html_url": "https://github.com/carlelove", "followers_url": "https://api.github.com/users/carlelove/followers", "following_url": "https://api.github.com/users/carlelove/following{/other_user}", "gists_url": "https://api.github.com/users/carlelove/gists{/gist_id}", "starred_url": "https://api.github.com/users/carlelove/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/carlelove/subscriptions", "organizations_url": "https://api.github.com/users/carlelove/orgs", "repos_url": "https://api.github.com/users/carlelove/repos", "events_url": "https://api.github.com/users/carlelove/events{/privacy}", "received_events_url": "https://api.github.com/users/carlelove/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "db46a2e6583ef7c8b284702613c8bc1bfd08e42b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db46a2e6583ef7c8b284702613c8bc1bfd08e42b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db46a2e6583ef7c8b284702613c8bc1bfd08e42b"}], "stats": {"total": 86, "additions": 82, "deletions": 4}, "files": [{"sha": "20c1e2c75f0b59da4de8465e33830c1e01941a9a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2afb2668ad15d17d225e97856354bf15041e5316", "patch": "@@ -1,3 +1,16 @@\n+2017-09-12  Carl Love  <cel@us.ibm.com>\n+\n+        * config/rs6000/altivec.md (vec_widen_umult_even_v4si,\n+\tvec_widen_smult_even_v4si): Add define expands for vmuleuw, vmulesw,\n+\tvmulouw, vmulosw.\n+        * config/rs6000/rs6000-builtin.def (VMLEUW, VMULESW, VMULOUW,\n+        VMULOSW): Add definitions.\n+        * config/rs6000/rs6000-c.c (altivec_overloaded_builtins): Add\n+        ALTIVEC_BUILTIN_VMULESW, ALTIVEC_BUILTIN_VMULEUW,\n+        ALTIVEC_BUILTIN_VMULOSW, ALTIVEC_BUILTIN_VMULOUW entries.\n+        * config/rs6000/rs6000.c (rs6000_gimple_fold_builtin,\n+        builtin_function_type): Add ALTIVEC_BUILTIN_* case statements.\n+\n 2017-09-12  James Greenhalgh  <james.greenhalgh@arm.com>\n \n \t* config/aarch64/aarch64.md (movdi_aarch64): Set load/store"}, {"sha": "8631604c64556185effa599aaa182f5c5a0528e7", "filename": "gcc/config/rs6000/altivec.md", "status": "modified", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Faltivec.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Faltivec.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Faltivec.md?ref=2afb2668ad15d17d225e97856354bf15041e5316", "patch": "@@ -1428,6 +1428,32 @@\n   DONE;\n })\n \n+(define_expand \"vec_widen_umult_even_v4si\"\n+  [(use (match_operand:V2DI 0 \"register_operand\"))\n+   (use (match_operand:V4SI 1 \"register_operand\"))\n+   (use (match_operand:V4SI 2 \"register_operand\"))]\n+  \"TARGET_P8_VECTOR\"\n+{\n+ if (VECTOR_ELT_ORDER_BIG)\n+    emit_insn (gen_altivec_vmuleuw (operands[0], operands[1], operands[2]));\n+  else\n+    emit_insn (gen_altivec_vmulouw (operands[0], operands[1], operands[2]));\n+ DONE;\n+})\n+\n+(define_expand \"vec_widen_smult_even_v4si\"\n+  [(use (match_operand:V2DI 0 \"register_operand\"))\n+   (use (match_operand:V4SI 1 \"register_operand\"))\n+   (use (match_operand:V4SI 2 \"register_operand\"))]\n+  \"TARGET_P8_VECTOR\"\n+{\n+  if (VECTOR_ELT_ORDER_BIG)\n+    emit_insn (gen_altivec_vmulesw (operands[0], operands[1], operands[2]));\n+ else\n+    emit_insn (gen_altivec_vmulosw (operands[0], operands[1], operands[2]));\n+  DONE;\n+})\n+\n (define_expand \"vec_widen_umult_odd_v16qi\"\n   [(use (match_operand:V8HI 0 \"register_operand\" \"\"))\n    (use (match_operand:V16QI 1 \"register_operand\" \"\"))\n@@ -1480,6 +1506,32 @@\n   DONE;\n })\n \n+(define_expand \"vec_widen_umult_odd_v4si\"\n+  [(use (match_operand:V2DI 0 \"register_operand\"))\n+   (use (match_operand:V4SI 1 \"register_operand\"))\n+   (use (match_operand:V4SI 2 \"register_operand\"))]\n+  \"TARGET_P8_VECTOR\"\n+{\n+  if (VECTOR_ELT_ORDER_BIG)\n+    emit_insn (gen_altivec_vmulouw (operands[0], operands[1], operands[2]));\n+  else\n+    emit_insn (gen_altivec_vmuleuw (operands[0], operands[1], operands[2]));\n+  DONE;\n+})\n+\n+(define_expand \"vec_widen_smult_odd_v4si\"\n+  [(use (match_operand:V2DI 0 \"register_operand\"))\n+   (use (match_operand:V4SI 1 \"register_operand\"))\n+   (use (match_operand:V4SI 2 \"register_operand\"))]\n+  \"TARGET_P8_VECTOR\"\n+{\n+  if (VECTOR_ELT_ORDER_BIG)\n+    emit_insn (gen_altivec_vmulosw (operands[0], operands[1], operands[2]));\n+  else\n+    emit_insn (gen_altivec_vmulesw (operands[0], operands[1], operands[2]));\n+  DONE;\n+})\n+\n (define_insn \"altivec_vmuleub\"\n   [(set (match_operand:V8HI 0 \"register_operand\" \"=v\")\n         (unspec:V8HI [(match_operand:V16QI 1 \"register_operand\" \"v\")"}, {"sha": "18db576730742b390f4f55ea01beac3c430774eb", "filename": "gcc/config/rs6000/rs6000-builtin.def", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Frs6000-builtin.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Frs6000-builtin.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000-builtin.def?ref=2afb2668ad15d17d225e97856354bf15041e5316", "patch": "@@ -1031,14 +1031,14 @@ BU_ALTIVEC_2 (VMULEUB,\t      \"vmuleub\",\tCONST,\tvec_widen_umult_even_v16qi)\n BU_ALTIVEC_2 (VMULESB,\t      \"vmulesb\",\tCONST,\tvec_widen_smult_even_v16qi)\n BU_ALTIVEC_2 (VMULEUH,\t      \"vmuleuh\",\tCONST,\tvec_widen_umult_even_v8hi)\n BU_ALTIVEC_2 (VMULESH,\t      \"vmulesh\",\tCONST,\tvec_widen_smult_even_v8hi)\n-BU_ALTIVEC_2 (VMULEUW,\t      \"vmuleuw\",\tCONST,  altivec_vmuleuw)\n-BU_ALTIVEC_2 (VMULESW,\t      \"vmulesw\",\tCONST,  altivec_vmulesw)\n+BU_ALTIVEC_2 (VMULEUW,\t      \"vmuleuw\",\tCONST,\tvec_widen_umult_even_v4si)\n+BU_ALTIVEC_2 (VMULESW,\t      \"vmulesw\",\tCONST,\tvec_widen_smult_even_v4si)\n BU_ALTIVEC_2 (VMULOUB,\t      \"vmuloub\",\tCONST,\tvec_widen_umult_odd_v16qi)\n BU_ALTIVEC_2 (VMULOSB,\t      \"vmulosb\",\tCONST,\tvec_widen_smult_odd_v16qi)\n BU_ALTIVEC_2 (VMULOUH,\t      \"vmulouh\",\tCONST,\tvec_widen_umult_odd_v8hi)\n BU_ALTIVEC_2 (VMULOSH,\t      \"vmulosh\",\tCONST,\tvec_widen_smult_odd_v8hi)\n-BU_ALTIVEC_2 (VMULOUW,\t      \"vmulouw\",\tCONST,  altivec_vmulouw)\n-BU_ALTIVEC_2 (VMULOSW,\t      \"vmulosw\",\tCONST,  altivec_vmulosw)\n+BU_ALTIVEC_2 (VMULOUW,\t      \"vmulouw\",\tCONST,\tvec_widen_umult_odd_v4si)\n+BU_ALTIVEC_2 (VMULOSW,\t      \"vmulosw\",\tCONST,\tvec_widen_smult_odd_v4si)\n BU_ALTIVEC_2 (VNOR,\t      \"vnor\",\t\tCONST,\tnorv4si3)\n BU_ALTIVEC_2 (VOR,\t      \"vor\",\t\tCONST,\tiorv4si3)\n BU_ALTIVEC_2 (VPKUHUM,\t      \"vpkuhum\",\tCONST,\taltivec_vpkuhum)"}, {"sha": "fbab0a2543e2602d96f7242e0231df3bbb72fa08", "filename": "gcc/config/rs6000/rs6000-c.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Frs6000-c.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Frs6000-c.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000-c.c?ref=2afb2668ad15d17d225e97856354bf15041e5316", "patch": "@@ -2212,6 +2212,10 @@ const struct altivec_builtin_types altivec_overloaded_builtins[] = {\n     RS6000_BTI_unsigned_V4SI, RS6000_BTI_unsigned_V8HI, RS6000_BTI_unsigned_V8HI, 0 },\n   { ALTIVEC_BUILTIN_VEC_VMULESH, ALTIVEC_BUILTIN_VMULESH,\n     RS6000_BTI_V4SI, RS6000_BTI_V8HI, RS6000_BTI_V8HI, 0 },\n+  { ALTIVEC_BUILTIN_VEC_VMULEUW, ALTIVEC_BUILTIN_VMULEUW,\n+    RS6000_BTI_V2DI, RS6000_BTI_V4SI, RS6000_BTI_V4SI, 0 },\n+  { ALTIVEC_BUILTIN_VEC_VMULESW, ALTIVEC_BUILTIN_VMULESW,\n+    RS6000_BTI_V2DI, RS6000_BTI_V4SI, RS6000_BTI_V4SI, 0 },\n   { ALTIVEC_BUILTIN_VEC_MULO, ALTIVEC_BUILTIN_VMULOUB,\n     RS6000_BTI_unsigned_V8HI, RS6000_BTI_unsigned_V16QI, RS6000_BTI_unsigned_V16QI, 0 },\n   { ALTIVEC_BUILTIN_VEC_MULO, ALTIVEC_BUILTIN_VMULOSB,\n@@ -2233,6 +2237,11 @@ const struct altivec_builtin_types altivec_overloaded_builtins[] = {\n     RS6000_BTI_V8HI, RS6000_BTI_V16QI, RS6000_BTI_V16QI, 0 },\n   { ALTIVEC_BUILTIN_VEC_VMULOUB, ALTIVEC_BUILTIN_VMULOUB,\n     RS6000_BTI_unsigned_V8HI, RS6000_BTI_unsigned_V16QI, RS6000_BTI_unsigned_V16QI, 0 },\n+  { ALTIVEC_BUILTIN_VEC_VMULOUW, ALTIVEC_BUILTIN_VMULOUW,\n+    RS6000_BTI_V2DI, RS6000_BTI_V4SI, RS6000_BTI_V4SI, 0 },\n+  { ALTIVEC_BUILTIN_VEC_VMULOSW, ALTIVEC_BUILTIN_VMULOSW,\n+    RS6000_BTI_V2DI, RS6000_BTI_V4SI, RS6000_BTI_V4SI, 0 },\n+\n   { ALTIVEC_BUILTIN_VEC_NABS, ALTIVEC_BUILTIN_NABS_V16QI,\n     RS6000_BTI_V16QI, RS6000_BTI_V16QI, 0, 0 },\n   { ALTIVEC_BUILTIN_VEC_NABS, ALTIVEC_BUILTIN_NABS_V8HI,"}, {"sha": "13383712046d6a93b74315d97b3e225d01d731d2", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2afb2668ad15d17d225e97856354bf15041e5316/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=2afb2668ad15d17d225e97856354bf15041e5316", "patch": "@@ -16242,9 +16242,11 @@ rs6000_gimple_fold_builtin (gimple_stmt_iterator *gsi)\n     /* Even element flavors of vec_mul (signed). */\n     case ALTIVEC_BUILTIN_VMULESB:\n     case ALTIVEC_BUILTIN_VMULESH:\n+    case ALTIVEC_BUILTIN_VMULESW:\n     /* Even element flavors of vec_mul (unsigned).  */\n     case ALTIVEC_BUILTIN_VMULEUB:\n     case ALTIVEC_BUILTIN_VMULEUH:\n+    case ALTIVEC_BUILTIN_VMULEUW:\n       {\n \targ0 = gimple_call_arg (stmt, 0);\n \targ1 = gimple_call_arg (stmt, 1);\n@@ -16257,9 +16259,11 @@ rs6000_gimple_fold_builtin (gimple_stmt_iterator *gsi)\n     /* Odd element flavors of vec_mul (signed).  */\n     case ALTIVEC_BUILTIN_VMULOSB:\n     case ALTIVEC_BUILTIN_VMULOSH:\n+    case ALTIVEC_BUILTIN_VMULOSW:\n     /* Odd element flavors of vec_mul (unsigned). */\n     case ALTIVEC_BUILTIN_VMULOUB:\n     case ALTIVEC_BUILTIN_VMULOUH:\n+    case ALTIVEC_BUILTIN_VMULOUW:\n       {\n \targ0 = gimple_call_arg (stmt, 0);\n \targ1 = gimple_call_arg (stmt, 1);"}]}