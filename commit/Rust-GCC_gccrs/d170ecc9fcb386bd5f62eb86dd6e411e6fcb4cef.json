{"sha": "d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "node_id": "C_kwDOANBUbNoAKGQxNzBlY2M5ZmNiMzg2YmQ1ZjYyZWI4NmRkNmU0MTFlNmZjYjRjZWY", "commit": {"author": {"name": "Sebastian Huber", "email": "sebastian.huber@embedded-brains.de", "date": "2022-03-24T20:59:21Z"}, "committer": {"name": "Sebastian Huber", "email": "sebastian.huber@embedded-brains.de", "date": "2022-04-28T18:46:49Z"}, "message": "gcov: Add mode to all gcov_open()\n\ngcc/\n\n\t* gcov-io.cc (gcov_open): Always use the mode parameter.\n\t* gcov-io.h (gcov_open): Declare it unconditionally.\n\nlibgcc/\n\n\t* libgcov-driver-system.c (gcov_exit_open_gcda_file): Open file for\n\treading and writing.\n\t* libgcov-util.c (read_gcda_file): Open file for reading.\n\t* libgcov.h (gcov_open): Delete declaration.", "tree": {"sha": "126711b71773887b2d6093a1d0330504d3a62163", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/126711b71773887b2d6093a1d0330504d3a62163"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/comments", "author": {"login": "sebhub", "id": 932056, "node_id": "MDQ6VXNlcjkzMjA1Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/932056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebhub", "html_url": "https://github.com/sebhub", "followers_url": "https://api.github.com/users/sebhub/followers", "following_url": "https://api.github.com/users/sebhub/following{/other_user}", "gists_url": "https://api.github.com/users/sebhub/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebhub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebhub/subscriptions", "organizations_url": "https://api.github.com/users/sebhub/orgs", "repos_url": "https://api.github.com/users/sebhub/repos", "events_url": "https://api.github.com/users/sebhub/events{/privacy}", "received_events_url": "https://api.github.com/users/sebhub/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sebhub", "id": 932056, "node_id": "MDQ6VXNlcjkzMjA1Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/932056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebhub", "html_url": "https://github.com/sebhub", "followers_url": "https://api.github.com/users/sebhub/followers", "following_url": "https://api.github.com/users/sebhub/following{/other_user}", "gists_url": "https://api.github.com/users/sebhub/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebhub/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebhub/subscriptions", "organizations_url": "https://api.github.com/users/sebhub/orgs", "repos_url": "https://api.github.com/users/sebhub/repos", "events_url": "https://api.github.com/users/sebhub/events{/privacy}", "received_events_url": "https://api.github.com/users/sebhub/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "336ea18ad7f48d675fce8c97bf3b7a0ee3a5a450", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/336ea18ad7f48d675fce8c97bf3b7a0ee3a5a450", "html_url": "https://github.com/Rust-GCC/gccrs/commit/336ea18ad7f48d675fce8c97bf3b7a0ee3a5a450"}], "stats": {"total": 19, "additions": 4, "deletions": 15}, "files": [{"sha": "017a6e32a5d0988f246880158fe34e807fc747a4", "filename": "gcc/gcov-io.cc", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/gcc%2Fgcov-io.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/gcc%2Fgcov-io.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov-io.cc?ref=d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "patch": "@@ -89,15 +89,8 @@ from_file (gcov_unsigned_t value)\n    Return zero on failure, non-zero on success.  */\n \n GCOV_LINKAGE int\n-#if IN_LIBGCOV\n-gcov_open (const char *name)\n-#else\n gcov_open (const char *name, int mode)\n-#endif\n {\n-#if IN_LIBGCOV\n-  int mode = 0;\n-#endif\n #if GCOV_LOCKED\n   struct flock s_flock;\n   int fd;"}, {"sha": "afe74b002f1e0741052d417960b5b1bb81f27ff3", "filename": "gcc/gcov-io.h", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/gcc%2Fgcov-io.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/gcc%2Fgcov-io.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcov-io.h?ref=d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "patch": "@@ -347,15 +347,12 @@ struct gcov_summary\n    functions for writing.  Your file may become corrupted if you break\n    these invariants.  */\n \n-#if !IN_LIBGCOV\n-GCOV_LINKAGE int gcov_open (const char */*name*/, int /*direction*/);\n-#endif\n-\n #if !IN_LIBGCOV || defined (IN_GCOV_TOOL)\n GCOV_LINKAGE int gcov_magic (gcov_unsigned_t, gcov_unsigned_t);\n #endif\n \n /* Available everywhere.  */\n+GCOV_LINKAGE int gcov_open (const char *, int) ATTRIBUTE_HIDDEN;\n GCOV_LINKAGE int gcov_close (void) ATTRIBUTE_HIDDEN;\n GCOV_LINKAGE gcov_unsigned_t gcov_read_unsigned (void) ATTRIBUTE_HIDDEN;\n GCOV_LINKAGE gcov_type gcov_read_counter (void) ATTRIBUTE_HIDDEN;"}, {"sha": "9abb2fe7f74b5ee8b9bc6cef43ac3923a4711a8e", "filename": "libgcc/libgcov-driver-system.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/libgcc%2Flibgcov-driver-system.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/libgcc%2Flibgcov-driver-system.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov-driver-system.c?ref=d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "patch": "@@ -309,7 +309,7 @@ gcov_exit_open_gcda_file (struct gcov_info *gi_ptr,\n \n   gf->filename = replace_filename_variables (gf->filename);\n \n-  if (!gcov_open (gf->filename))\n+  if (!gcov_open (gf->filename, 0))\n     {\n       /* Open failed likely due to missed directory.\n          Create directory and retry to open file. */\n@@ -318,7 +318,7 @@ gcov_exit_open_gcda_file (struct gcov_info *gi_ptr,\n           fprintf (stderr, \"profiling:%s:Skip\\n\", gf->filename);\n           return -1;\n         }\n-      if (!gcov_open (gf->filename))\n+      if (!gcov_open (gf->filename, 0))\n         {\n           fprintf (stderr, \"profiling:%s:Cannot open\\n\", gf->filename);\n           return -1;"}, {"sha": "db157220c9d867b013bf48786fddd96f2bd5ae10", "filename": "libgcc/libgcov-util.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/libgcc%2Flibgcov-util.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/libgcc%2Flibgcov-util.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov-util.c?ref=d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "patch": "@@ -268,7 +268,7 @@ read_gcda_file (const char *filename)\n     k_ctrs_mask[i] = 0;\n   k_ctrs_types = 0;\n \n-  if (!gcov_open (filename))\n+  if (!gcov_open (filename, 1))\n     {\n       fnotice (stderr, \"%s:cannot open\\n\", filename);\n       return NULL;"}, {"sha": "f190547e819dbfe412c8ebd23074cae2c6baa706", "filename": "libgcc/libgcov.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/libgcc%2Flibgcov.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef/libgcc%2Flibgcov.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov.h?ref=d170ecc9fcb386bd5f62eb86dd6e411e6fcb4cef", "patch": "@@ -343,7 +343,6 @@ extern int __gcov_execve (const char *, char  *const [], char *const [])\n   ATTRIBUTE_HIDDEN;\n \n /* Functions that only available in libgcov.  */\n-GCOV_LINKAGE int gcov_open (const char */*name*/) ATTRIBUTE_HIDDEN;\n GCOV_LINKAGE void gcov_write_summary (gcov_unsigned_t /*tag*/,\n                                       const struct gcov_summary *)\n     ATTRIBUTE_HIDDEN;"}]}