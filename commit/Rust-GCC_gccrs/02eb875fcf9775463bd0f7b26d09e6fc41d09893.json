{"sha": "02eb875fcf9775463bd0f7b26d09e6fc41d09893", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDJlYjg3NWZjZjk3NzU0NjNiZDBmN2IyNmQwOWU2ZmM0MWQwOTg5Mw==", "commit": {"author": {"name": "Paolo Bonzini", "email": "bonzini@gnu.org", "date": "2005-09-29T14:53:39Z"}, "committer": {"name": "Paolo Bonzini", "email": "bonzini@gcc.gnu.org", "date": "2005-09-29T14:53:39Z"}, "message": "re PR c/21419 (Accepts writting to const via asm)\n\ngcc:\n2005-09-29  Paolo Bonzini  <bonzini@gnu.org>\n\n\tPR c/21419\n\t* gimplify.c (gimplify_asm_expr): Raise an error if an output is\n\tread-only.\n\ntestsuite:\n2005-09-29  Paolo Bonzini  <bonzini@gnu.org>\n\n        PR c/21419\n        * gcc.dg/pr21419.c: New test.\n\nFrom-SVN: r104774", "tree": {"sha": "fa0ae259feba322798f38fbed7affb8907323e43", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fa0ae259feba322798f38fbed7affb8907323e43"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/02eb875fcf9775463bd0f7b26d09e6fc41d09893", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02eb875fcf9775463bd0f7b26d09e6fc41d09893", "html_url": "https://github.com/Rust-GCC/gccrs/commit/02eb875fcf9775463bd0f7b26d09e6fc41d09893", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/02eb875fcf9775463bd0f7b26d09e6fc41d09893/comments", "author": {"login": "bonzini", "id": 42082, "node_id": "MDQ6VXNlcjQyMDgy", "avatar_url": "https://avatars.githubusercontent.com/u/42082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bonzini", "html_url": "https://github.com/bonzini", "followers_url": "https://api.github.com/users/bonzini/followers", "following_url": "https://api.github.com/users/bonzini/following{/other_user}", "gists_url": "https://api.github.com/users/bonzini/gists{/gist_id}", "starred_url": "https://api.github.com/users/bonzini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bonzini/subscriptions", "organizations_url": "https://api.github.com/users/bonzini/orgs", "repos_url": "https://api.github.com/users/bonzini/repos", "events_url": "https://api.github.com/users/bonzini/events{/privacy}", "received_events_url": "https://api.github.com/users/bonzini/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "090037799cc3bc47500e77ed0b767b8d21bec1aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/090037799cc3bc47500e77ed0b767b8d21bec1aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/090037799cc3bc47500e77ed0b767b8d21bec1aa"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "2d793e03d12b3f299a50f750f6d366685275babf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=02eb875fcf9775463bd0f7b26d09e6fc41d09893", "patch": "@@ -1,3 +1,9 @@\n+2005-09-29  Paolo Bonzini  <bonzini@gnu.org>\n+\n+\tPR c/21419\n+\t* gimplify.c (gimplify_asm_expr): Raise an error if an output is\n+\tread-only.\n+\n 2005-09-29  Steven Bosscher  <stevenb@suse.de>\n \n \tPR tree-optimization/23911"}, {"sha": "e5d50e29ee77c04bfc7710b1d4c2bd6a86220396", "filename": "gcc/gimplify.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=02eb875fcf9775463bd0f7b26d09e6fc41d09893", "patch": "@@ -3544,6 +3544,12 @@ gimplify_asm_expr (tree *expr_p, tree *pre_p, tree *post_p)\n       parse_output_constraint (&constraint, i, 0, 0,\n \t\t\t       &allows_mem, &allows_reg, &is_inout);\n \n+      if (TYPE_READONLY (TREE_TYPE (TREE_VALUE (link))))\n+\t{\n+\t  error (\"invalid lvalue in asm output %d\", i);\n+\t  ret = GS_ERROR;\n+\t}\n+\n       if (!allows_reg && allows_mem)\n \tlang_hooks.mark_addressable (TREE_VALUE (link));\n "}, {"sha": "e279840cbb21cec1d0bedc2f7e535826525014c7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=02eb875fcf9775463bd0f7b26d09e6fc41d09893", "patch": "@@ -1,3 +1,8 @@\n+2005-09-29  Paolo Bonzini  <bonzini@gnu.org>\n+\n+        PR c/21419\n+        * gcc.dg/pr21419.c: New test.\n+\n 2005-09-29  Steven Bosscher  <stevenb@suse.de>\n \n \t* gcc.dg/pr23911.c: New test."}, {"sha": "f1e9cb924683ec9dd8fea96ef95a1418109c0451", "filename": "gcc/testsuite/gcc.dg/pr21419.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2Ftestsuite%2Fgcc.dg%2Fpr21419.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/02eb875fcf9775463bd0f7b26d09e6fc41d09893/gcc%2Ftestsuite%2Fgcc.dg%2Fpr21419.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr21419.c?ref=02eb875fcf9775463bd0f7b26d09e6fc41d09893", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile } */\n+const int i = 0;\n+\n+void f(void)\n+{\n+  __asm__ __volatile__ (\"\" : \"=m\" (i)); /* { dg-error \"invalid lvalue in asm output\" } */\n+\n+}\n+\n+void g(const int set)\n+{\n+  __asm__ __volatile__ (\"\" : \"=r\" (set)); /* { dg-error \"invalid lvalue in asm output\" } */\n+}\n+\n+"}]}