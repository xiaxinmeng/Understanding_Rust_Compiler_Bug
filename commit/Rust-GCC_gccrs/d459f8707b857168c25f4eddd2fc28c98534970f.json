{"sha": "d459f8707b857168c25f4eddd2fc28c98534970f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDQ1OWY4NzA3Yjg1NzE2OGMyNWY0ZWRkZDJmYzI4Yzk4NTM0OTcwZg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-11-05T07:58:48Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-11-05T07:58:48Z"}, "message": "re PR debug/54402 (var-tracking does not scale)\n\n\tPR debug/54402\n\t* var-tracking.c (fp_setter): Return false if there is REG_CFA_RESTORE\n\thfp note.\n\t(vt_initialize): Look for fp_setter in any bb, not just successor of\n\tentry bb.\n\nFrom-SVN: r193152", "tree": {"sha": "71aba7d9cd9d78f25062116b9d09ffdc69135348", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/71aba7d9cd9d78f25062116b9d09ffdc69135348"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d459f8707b857168c25f4eddd2fc28c98534970f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d459f8707b857168c25f4eddd2fc28c98534970f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d459f8707b857168c25f4eddd2fc28c98534970f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d459f8707b857168c25f4eddd2fc28c98534970f/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ead4af4fb64a9255fa5d056b63f1c522099e170e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ead4af4fb64a9255fa5d056b63f1c522099e170e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ead4af4fb64a9255fa5d056b63f1c522099e170e"}], "stats": {"total": 28, "additions": 22, "deletions": 6}, "files": [{"sha": "16f3a655ad8ce7bb19f1037f94885647de1d73a7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d459f8707b857168c25f4eddd2fc28c98534970f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d459f8707b857168c25f4eddd2fc28c98534970f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d459f8707b857168c25f4eddd2fc28c98534970f", "patch": "@@ -1,3 +1,11 @@\n+2012-11-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/54402\n+\t* var-tracking.c (fp_setter): Return false if there is REG_CFA_RESTORE\n+\thfp note.\n+\t(vt_initialize): Look for fp_setter in any bb, not just successor of\n+\tentry bb.\n+\n 2012-11-05  Oleg Endo  <olegendo@gcc.gnu.org>\n \n \t* config/sh/sh.h (TARGET_CACHE32, TARGET_HARVARD): Delete macro."}, {"sha": "adccf7caa0da32d4039433fd91ff5f4b7bde1e64", "filename": "gcc/var-tracking.c", "status": "modified", "additions": 14, "deletions": 6, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d459f8707b857168c25f4eddd2fc28c98534970f/gcc%2Fvar-tracking.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d459f8707b857168c25f4eddd2fc28c98534970f/gcc%2Fvar-tracking.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvar-tracking.c?ref=d459f8707b857168c25f4eddd2fc28c98534970f", "patch": "@@ -9543,16 +9543,25 @@ fp_setter (rtx insn)\n \tpat = XEXP (expr, 0);\n     }\n   if (GET_CODE (pat) == SET)\n-    return SET_DEST (pat) == hard_frame_pointer_rtx;\n+    {\n+      if (SET_DEST (pat) != hard_frame_pointer_rtx)\n+\treturn false;\n+    }\n   else if (GET_CODE (pat) == PARALLEL)\n     {\n       int i;\n       for (i = XVECLEN (pat, 0) - 1; i >= 0; i--)\n \tif (GET_CODE (XVECEXP (pat, 0, i)) == SET\n \t    && SET_DEST (XVECEXP (pat, 0, i)) == hard_frame_pointer_rtx)\n-\t  return true;\n+\t  break;\n+      if (i < 0)\n+\treturn false;\n     }\n-  return false;\n+  else\n+    return false;\n+  if (find_reg_note (insn, REG_CFA_RESTORE, hard_frame_pointer_rtx))\n+    return false;\n+  return true;\n }\n \n /* Initialize cfa_base_rtx, create a preserved VALUE for it and\n@@ -9600,7 +9609,7 @@ vt_init_cfa_base (void)\n static bool\n vt_initialize (void)\n {\n-  basic_block bb, prologue_bb = single_succ (ENTRY_BLOCK_PTR);\n+  basic_block bb;\n   HOST_WIDE_INT fp_cfa_offset = -1;\n \n   alloc_aux_for_blocks (sizeof (struct variable_tracking_info_def));\n@@ -9858,8 +9867,7 @@ vt_initialize (void)\n \t\t      VTI (bb)->out.stack_adjust += post;\n \t\t    }\n \n-\t\t  if (bb == prologue_bb\n-\t\t      && fp_cfa_offset != -1\n+\t\t  if (fp_cfa_offset != -1\n \t\t      && hard_frame_pointer_adjustment == -1\n \t\t      && RTX_FRAME_RELATED_P (insn)\n \t\t      && fp_setter (insn))"}]}