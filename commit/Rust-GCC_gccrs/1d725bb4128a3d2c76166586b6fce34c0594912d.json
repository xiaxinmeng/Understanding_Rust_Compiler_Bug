{"sha": "1d725bb4128a3d2c76166586b6fce34c0594912d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWQ3MjViYjQxMjhhM2QyYzc2MTY2NTg2YjZmY2UzNGMwNTk0OTEyZA==", "commit": {"author": {"name": "Jan-Benedict Glaw", "email": "jbglaw@gcc.gnu.org", "date": "2014-11-26T21:53:35Z"}, "committer": {"name": "Jan-Benedict Glaw", "email": "jbglaw@gcc.gnu.org", "date": "2014-11-26T21:53:35Z"}, "message": "Merge the ./config directory between GCC and Binutils\n\nThis pulls in the missing Binutils pieces into the ./config\ndirectory. Contains these missing Binutils changes:\n\n2014-08-14  Alan Modra  <amodra@gmail.com>\n\n\t* plugins.m4: Test for dlfcn.h or windows.h here to set default\n\tfor --enable-plugins.  Report error if someone tries to enable\n\tplugins on a host we don't support.\n\n2014-08-19  Alan Modra  <amodra@gmail.com>\n\n\t* plugins.m4 (AC_PLUGINS): If plugins are enabled, add -ldl to\n\tLIBS via AC_SEARCH_LIBS.\n\nFor this commit:\n\n2014-11-26  Jan-Benedict Glaw  <jbglaw@lug-owl.de>\n\n\t* config/plugins.m4: Merge from Binutils.\n\nFrom-SVN: r218102", "tree": {"sha": "4ddc981b730aadfcb987cdbcc01800e844f28f88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4ddc981b730aadfcb987cdbcc01800e844f28f88"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1d725bb4128a3d2c76166586b6fce34c0594912d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d725bb4128a3d2c76166586b6fce34c0594912d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1d725bb4128a3d2c76166586b6fce34c0594912d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1d725bb4128a3d2c76166586b6fce34c0594912d/comments", "author": null, "committer": null, "parents": [{"sha": "7b0b9f6643723a6d1fe36a867bfde842a9caf248", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b0b9f6643723a6d1fe36a867bfde842a9caf248", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b0b9f6643723a6d1fe36a867bfde842a9caf248"}], "stats": {"total": 26, "additions": 18, "deletions": 8}, "files": [{"sha": "513c690e1b57a9719df558c770ace8553b365ae2", "filename": "config/plugins.m4", "status": "modified", "additions": 18, "deletions": 8, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1d725bb4128a3d2c76166586b6fce34c0594912d/config%2Fplugins.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1d725bb4128a3d2c76166586b6fce34c0594912d/config%2Fplugins.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Fplugins.m4?ref=1d725bb4128a3d2c76166586b6fce34c0594912d", "patch": "@@ -1,11 +1,21 @@\n AC_DEFUN([AC_PLUGINS],\n [\n-AC_ARG_ENABLE([plugins],\n-AS_HELP_STRING([--enable-plugins], [Enable support for plugins (defaults no)]),\n-[case \"${enableval}\" in\n-  yes | \"\") plugins=yes ;;\n-  no) plugins=no ;;\n-  *) plugins=yes ;;\n- esac],\n-[plugins=no])\n+  maybe_plugins=no\n+  AC_CHECK_HEADERS([dlfcn.h], [maybe_plugins=yes], [], [AC_INCLUDES_DEFAULT])\n+  AC_CHECK_HEADERS([windows.h], [maybe_plugins=yes], [], [AC_INCLUDES_DEFAULT])\n+\n+  AC_ARG_ENABLE([plugins],\n+    AS_HELP_STRING([--enable-plugins], [Enable support for plugins]),\n+    [case \"${enableval}\" in\n+      no) plugins=no ;;\n+      *) plugins=yes\n+         if test \"$maybe_plugins\" != \"yes\" ; then\n+\t   AC_MSG_ERROR([Building with plugin support requires a host that supports dlopen.])\n+\t fi ;;\n+     esac],\n+    [plugins=$maybe_plugins]\n+  )\n+  if test \"$plugins\" = \"yes\"; then\n+    AC_SEARCH_LIBS([dlopen], [dl])\n+  fi\n ])"}]}