{"sha": "d2025512b3fb357768d85ccde8e21f571481d00f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDIwMjU1MTJiM2ZiMzU3NzY4ZDg1Y2NkZThlMjFmNTcxNDgxZDAwZg==", "commit": {"author": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-03-15T13:37:07Z"}, "committer": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-03-15T13:37:07Z"}, "message": "re PR d/88990 (ICE in get_symbol_decl, at d/decl.cc:1097)\n\n    PR d/88990\nd/dmd: Merge upstream dmd 8d4c876c6\n\nThe extern storage class flag was wrongly propagated to function scope\nwhen starting the semantic pass on the body.\n\nFixes https://gcc.gnu.org/PR88990\n\nReviewed-on: https://github.com/dlang/dmd/pull/9452\n\nFrom-SVN: r269708", "tree": {"sha": "a04703639df3705833fbef5bae764e713747decf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a04703639df3705833fbef5bae764e713747decf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d2025512b3fb357768d85ccde8e21f571481d00f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2025512b3fb357768d85ccde8e21f571481d00f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2025512b3fb357768d85ccde8e21f571481d00f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2025512b3fb357768d85ccde8e21f571481d00f/comments", "author": null, "committer": null, "parents": [{"sha": "ec15654627d34bf9fb4f7624c7659ac4912bef17", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec15654627d34bf9fb4f7624c7659ac4912bef17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec15654627d34bf9fb4f7624c7659ac4912bef17"}], "stats": {"total": 65, "additions": 63, "deletions": 2}, "files": [{"sha": "230fd12db2bcd099f360772d375c1003cf1e975a", "filename": "gcc/d/dmd/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Fd%2Fdmd%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Fd%2Fdmd%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2FMERGE?ref=d2025512b3fb357768d85ccde8e21f571481d00f", "patch": "@@ -1,4 +1,4 @@\n-19b1454b5ca7b1036ea5fde197d91d4a7d05c0a5\n+8d4c876c658608e8f6e653803c534a9e15618f57\n \n The first line of this file holds the git revision number of the last\n merge done from the dlang/dmd repository."}, {"sha": "835c6aef8311b72663015930f52ac948ed25f6d4", "filename": "gcc/d/dmd/declaration.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Fd%2Fdmd%2Fdeclaration.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Fd%2Fdmd%2Fdeclaration.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2Fdeclaration.c?ref=d2025512b3fb357768d85ccde8e21f571481d00f", "patch": "@@ -2008,6 +2008,7 @@ bool VarDeclaration::isDataseg()\n         else if (storage_class & (STCstatic | STCextern | STCtls | STCgshared) ||\n                  parent->isModule() || parent->isTemplateInstance() || parent->isNspace())\n         {\n+            assert(!isParameter() && !isResult());\n             isdataseg = 1; // It is in the DataSegment\n         }\n     }"}, {"sha": "afba82aac7d0ed74f07c49c03ca4e24fcf773500", "filename": "gcc/d/dmd/func.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Fd%2Fdmd%2Ffunc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Fd%2Fdmd%2Ffunc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2Ffunc.c?ref=d2025512b3fb357768d85ccde8e21f571481d00f", "patch": "@@ -1437,7 +1437,7 @@ void FuncDeclaration::semantic3(Scope *sc)\n         sc2->sw = NULL;\n         sc2->fes = fes;\n         sc2->linkage = LINKd;\n-        sc2->stc &= ~(STCauto | STCscope | STCstatic | STCabstract |\n+        sc2->stc &= ~(STCauto | STCscope | STCstatic | STCextern | STCabstract |\n                         STCdeprecated | STCoverride |\n                         STC_TYPECTOR | STCfinal | STCtls | STCgshared | STCref | STCreturn |\n                         STCproperty | STCnothrow | STCpure | STCsafe | STCtrusted | STCsystem);"}, {"sha": "efa7da3b0193968fb5c2c15250a76e71e5854acf", "filename": "gcc/testsuite/gdc.test/runnable/test19734.d", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Ftestsuite%2Fgdc.test%2Frunnable%2Ftest19734.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Ftestsuite%2Fgdc.test%2Frunnable%2Ftest19734.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Frunnable%2Ftest19734.d?ref=d2025512b3fb357768d85ccde8e21f571481d00f", "patch": "@@ -0,0 +1,38 @@\n+// https://issues.dlang.org/show_bug.cgi?id=19734\n+// REQUIRED_ARGS: -main\n+\n+class C19734\n+{\n+    import core.stdc.stdarg;\n+\n+    extern\n+    {\n+        // Invalid 'this' parameter because of applied 'extern' storage class.\n+        void testin(typeof(this) p)\n+        in { assert(this is p); }\n+        body\n+        {\n+        }\n+\n+        // Undefined reference to __result.\n+        int testout()\n+        out { assert(__result == 2); }\n+        body\n+        {\n+            return 2;\n+        }\n+\n+        // Undefined reference to var.\n+        int testlocal()\n+        {\n+            int var;\n+            return var + 2;\n+        }\n+\n+        // Variable _argptr cannot have initializer.\n+        int testvarargs(...)\n+        {\n+            return 0;\n+        }\n+    }\n+}"}, {"sha": "8a1a5e7d871fc80db99eacfb5a851c1a1fac2d4e", "filename": "gcc/testsuite/gdc.test/runnable/test19735.d", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Ftestsuite%2Fgdc.test%2Frunnable%2Ftest19735.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2025512b3fb357768d85ccde8e21f571481d00f/gcc%2Ftestsuite%2Fgdc.test%2Frunnable%2Ftest19735.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Frunnable%2Ftest19735.d?ref=d2025512b3fb357768d85ccde8e21f571481d00f", "patch": "@@ -0,0 +1,22 @@\n+// https://issues.dlang.org/show_bug.cgi?id=19735\n+\n+extern int test1(int par)\n+{\n+    int var = 42;\n+    return var + par;\n+}\n+\n+extern\n+{\n+    int test2(int par)\n+    {\n+        int var = 42;\n+        return var + par;\n+    }\n+}\n+\n+void main()\n+{\n+    assert(test1(1) == test2(1));\n+}\n+"}]}