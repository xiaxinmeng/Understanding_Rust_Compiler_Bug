{"sha": "dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGM0ZDQ5NGFlOTFiMDU1YjBiMmNhYzM5YTZhYWE4YzYzNTJmMDljOA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2015-03-09T23:43:16Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2015-03-09T23:43:16Z"}, "message": "re PR go/65349 (go tool crashes, can't compile go code on 32bit linux systems)\n\n\tPR go/65349\nruntime: Don't crash if explicitly freeing small map.\n\nFrom-SVN: r221292", "tree": {"sha": "ee68a97d9bc6e777780ba979db45c56acc20db19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee68a97d9bc6e777780ba979db45c56acc20db19"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8/comments", "author": null, "committer": null, "parents": [{"sha": "4729d7726bdc86c46aeb525270909b73490ce206", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4729d7726bdc86c46aeb525270909b73490ce206", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4729d7726bdc86c46aeb525270909b73490ce206"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "616b00c68c82e876047cffa1a2c855cdd51fa5c5", "filename": "libgo/runtime/go-map-index.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8/libgo%2Fruntime%2Fgo-map-index.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8/libgo%2Fruntime%2Fgo-map-index.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fruntime%2Fgo-map-index.c?ref=dc4d494ae91b055b0b2cac39a6aaa8c6352f09c8", "patch": "@@ -8,6 +8,7 @@\n #include <stdlib.h>\n \n #include \"runtime.h\"\n+#include \"malloc.h\"\n #include \"go-alloc.h\"\n #include \"go-assert.h\"\n #include \"map.h\"\n@@ -63,7 +64,8 @@ __go_map_rehash (struct __go_map *map)\n \t}\n     }\n \n-  __go_free (old_buckets);\n+  if (old_bucket_count * sizeof (void *) >= TinySize)\n+    __go_free (old_buckets);\n \n   map->__bucket_count = new_bucket_count;\n   map->__buckets = new_buckets;"}]}