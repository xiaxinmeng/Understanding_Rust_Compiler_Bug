{"sha": "7b98672ff9bc9b1096b604e9f900eb1692ea8bd3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2I5ODY3MmZmOWJjOWIxMDk2YjYwNGU5ZjkwMGViMTY5MmVhOGJkMw==", "commit": {"author": {"name": "Yannick Moy", "email": "moy@adacore.com", "date": "2011-08-02T15:26:43Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-08-02T15:26:43Z"}, "message": "sem_res.adb: Protect calls to Matching_Static_Array_Bounds which might be costly.\n\n2011-08-02  Yannick Moy  <moy@adacore.com>\n\n\t* sem_res.adb: Protect calls to Matching_Static_Array_Bounds which\n\tmight be costly.\n\nFrom-SVN: r177181", "tree": {"sha": "0a44d7b12f381cd08013d499d14f7c5746ecf6f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0a44d7b12f381cd08013d499d14f7c5746ecf6f6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3/comments", "author": {"login": "yannickmoy", "id": 859440, "node_id": "MDQ6VXNlcjg1OTQ0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/859440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yannickmoy", "html_url": "https://github.com/yannickmoy", "followers_url": "https://api.github.com/users/yannickmoy/followers", "following_url": "https://api.github.com/users/yannickmoy/following{/other_user}", "gists_url": "https://api.github.com/users/yannickmoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/yannickmoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yannickmoy/subscriptions", "organizations_url": "https://api.github.com/users/yannickmoy/orgs", "repos_url": "https://api.github.com/users/yannickmoy/repos", "events_url": "https://api.github.com/users/yannickmoy/events{/privacy}", "received_events_url": "https://api.github.com/users/yannickmoy/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "052e0603b1b8a2dbbcee2261642764fcea84fe51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/052e0603b1b8a2dbbcee2261642764fcea84fe51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/052e0603b1b8a2dbbcee2261642764fcea84fe51"}], "stats": {"total": 29, "additions": 25, "deletions": 4}, "files": [{"sha": "b60f87137927e6d48395d575ce327d6f9b25e7d1", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=7b98672ff9bc9b1096b604e9f900eb1692ea8bd3", "patch": "@@ -1,3 +1,8 @@\n+2011-08-02  Yannick Moy  <moy@adacore.com>\n+\n+\t* sem_res.adb: Protect calls to Matching_Static_Array_Bounds which\n+\tmight be costly.\n+\n 2011-08-02  Robert Dewar  <dewar@adacore.com>\n \n \t* exp_ch9.adb, exp_sel.adb, restrict.ads, exp_disp.adb, erroutc.ads,"}, {"sha": "893faf37271e737475ade263de5ac7d9d466dd7a", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 20, "deletions": 4, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7b98672ff9bc9b1096b604e9f900eb1692ea8bd3/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=7b98672ff9bc9b1096b604e9f900eb1692ea8bd3", "patch": "@@ -6830,7 +6830,11 @@ package body Sem_Res is\n          if Is_Array_Type (T) then\n             Current_Subprogram_Body_Is_Not_In_ALFA;\n \n-            if Base_Type (T) /= Standard_String\n+            --  Protect call to Matching_Static_Array_Bounds to avoid costly\n+            --  operation if not needed.\n+\n+            if Restriction_Check_Required (SPARK)\n+              and then Base_Type (T) /= Standard_String\n               and then Base_Type (Etype (L)) = Base_Type (Etype (R))\n               and then Etype (L) /= Any_Composite  --  or else L in error\n               and then Etype (R) /= Any_Composite  --  or else R in error\n@@ -7380,7 +7384,11 @@ package body Sem_Res is\n             Left_Typ  : constant Node_Id := Etype (Left_Opnd (N));\n             Right_Typ : constant Node_Id := Etype (Right_Opnd (N));\n          begin\n-            if Base_Type (Left_Typ) = Base_Type (Right_Typ)\n+            --  Protect call to Matching_Static_Array_Bounds to avoid costly\n+            --  operation if not needed.\n+\n+            if Restriction_Check_Required (SPARK)\n+              and then Base_Type (Left_Typ) = Base_Type (Right_Typ)\n               and then Left_Typ /= Any_Composite  --  or Left_Opnd in error\n               and then Right_Typ /= Any_Composite  --  or Right_Opnd in error\n               and then not Matching_Static_Array_Bounds (Left_Typ, Right_Typ)\n@@ -8038,7 +8046,11 @@ package body Sem_Res is\n    begin\n       Resolve (Expr, Target_Typ);\n \n-      if Is_Array_Type (Target_Typ)\n+      --  Protect call to Matching_Static_Array_Bounds to avoid costly\n+      --  operation if not needed.\n+\n+      if Restriction_Check_Required (SPARK)\n+        and then Is_Array_Type (Target_Typ)\n         and then Is_Array_Type (Etype (Expr))\n         and then Etype (Expr) /= Any_Composite  --  or else Expr in error\n         and then not Matching_Static_Array_Bounds (Target_Typ, Etype (Expr))\n@@ -9164,7 +9176,11 @@ package body Sem_Res is\n       --  In SPARK, a type conversion between array types should be restricted\n       --  to types which have matching static bounds.\n \n-      if Is_Array_Type (Target_Typ)\n+      --  Protect call to Matching_Static_Array_Bounds to avoid costly\n+      --  operation if not needed.\n+\n+      if Restriction_Check_Required (SPARK)\n+        and then Is_Array_Type (Target_Typ)\n         and then Is_Array_Type (Operand_Typ)\n         and then Operand_Typ /= Any_Composite  --  or else Operand in error\n         and then not Matching_Static_Array_Bounds (Target_Typ, Operand_Typ)"}]}