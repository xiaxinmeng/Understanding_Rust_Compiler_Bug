{"sha": "6070e39cd0af6ac4a88004c8b1b6a900a8bbce36", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjA3MGUzOWNkMGFmNmFjNGE4ODAwNGM4YjFiNmE5MDBhOGJiY2UzNg==", "commit": {"author": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2021-02-19T09:13:02Z"}, "committer": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2021-02-19T09:13:02Z"}, "message": "aarch64: Check predicate when using gen_vec_duplicate [PR98657]\n\nPrevents generation of a vec_duplicate with illegal predicate in\n<ASHIFT:optab><mode>3.\n\ngcc/ChangeLog:\n2021-02-19  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\tPR target/98657\n\t* config/aarch64/aarch64-sve.md (<ASHIFT:optab><mode>3): Use\n\texpand_vector_broadcast' to emit the vec_duplicate operand.\n\ngcc/testsuite/ChangeLog:\n2021-02-19  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n\n\tPR target/98657\n\t* gcc.target/aarch64/sve/pr98657.c: New test.", "tree": {"sha": "a6774744bd7c846afc12f7d1416c5a1425ca6341", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a6774744bd7c846afc12f7d1416c5a1425ca6341"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36/comments", "author": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0b2b7ef3676920c120d9b329e5b65924650ab44c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b2b7ef3676920c120d9b329e5b65924650ab44c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b2b7ef3676920c120d9b329e5b65924650ab44c"}], "stats": {"total": 15, "additions": 11, "deletions": 4}, "files": [{"sha": "7db2938bb84e04d066a7b07574e5cf344a3a8fb6", "filename": "gcc/config/aarch64/aarch64-sve.md", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36/gcc%2Fconfig%2Faarch64%2Faarch64-sve.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36/gcc%2Fconfig%2Faarch64%2Faarch64-sve.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-sve.md?ref=6070e39cd0af6ac4a88004c8b1b6a900a8bbce36", "patch": "@@ -4549,10 +4549,8 @@\n       }\n     else\n       {\n-\tamount = gen_reg_rtx (<MODE>mode);\n-\temit_insn (gen_vec_duplicate<mode> (amount,\n-\t\t\t\t\t    convert_to_mode (<VEL>mode,\n-\t\t\t\t\t\t\t     operands[2], 0)));\n+\tamount = convert_to_mode (<VEL>mode, operands[2], 0);\n+\tamount = expand_vector_broadcast (<MODE>mode, amount);\n       }\n     emit_insn (gen_v<optab><mode>3 (operands[0], operands[1], amount));\n     DONE;"}, {"sha": "592af25d7bbc69bc05823d27358f07cd741dbe20", "filename": "gcc/testsuite/gcc.target/aarch64/sve/pr98657.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fsve%2Fpr98657.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6070e39cd0af6ac4a88004c8b1b6a900a8bbce36/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fsve%2Fpr98657.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fsve%2Fpr98657.c?ref=6070e39cd0af6ac4a88004c8b1b6a900a8bbce36", "patch": "@@ -0,0 +1,9 @@\n+/* PR target/98657  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -msve-vector-bits=256\" } */\n+extern char a[];\n+void b(_Bool c[][18]) {\n+  int d;\n+  for (int e = 0; e < 23; e++)\n+    a[e] = 6 >> c[1][d];\n+}"}]}