{"sha": "3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2UwZGU5ZDE4ODBjY2JhMzYzMjNiNWQ2YzgxYmMyYTBiYWU5MTJmOA==", "commit": {"author": {"name": "Devang Patel", "email": "dpatel@apple.com", "date": "2005-04-05T16:33:29Z"}, "committer": {"name": "Devang Patel", "email": "dpatel@gcc.gnu.org", "date": "2005-04-05T16:33:29Z"}, "message": "altivec.md (altivec_vsr<VI_char>): Rename to ..\n\n         * config/rs600/altivec.md (altivec_vsr<VI_char>): Rename to ..\n         (lhsr<mode>3): ... new name.\n         (altivec_vsra<VI_char>): Rename to ..\n         (ashr<mode>3): ... new name.\n         * config/rs6000/rs6000.c (builtin_description): Rename shift\n         operations.\n\n         testsuite:\n         * lib/target-supports.exp (check_effective_target_vect_shif): New.\n         * gcc.dg/vect/vect-shift-1.c: New test.\n\nFrom-SVN: r97636", "tree": {"sha": "14d011f90dd136d023b5c2f138e870718fc7a295", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/14d011f90dd136d023b5c2f138e870718fc7a295"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/comments", "author": null, "committer": null, "parents": [{"sha": "e72f3fa192d67670fe3cbdb34b3b590054b684d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e72f3fa192d67670fe3cbdb34b3b590054b684d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e72f3fa192d67670fe3cbdb34b3b590054b684d5"}], "stats": {"total": 79, "additions": 67, "deletions": 12}, "files": [{"sha": "7b44a81f1d15bd37cbb6639d9959a0c4e3a69471", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "patch": "@@ -1,3 +1,12 @@\n+2004-04-05  Devang Patel  <dpatel@apple.com>\n+\n+\t* config/rs600/altivec.md (altivec_vsr<VI_char>): Rename to ..\n+\t(lhsr<mode>3): ... new name.\n+\t(altivec_vsra<VI_char>): Rename to ..\n+\t(ashr<mode>3): ... new name.\n+\t* config/rs6000/rs6000.c (builtin_description): Rename shift\n+\toperations.\n+\t\n 2004-04-05  Paolo Bonzini  <bonzini@gnu.org>\n \n \t* combine.c (RTL_HOOKS_GEN_LOWPART_NO_EMIT): Use"}, {"sha": "d455dda94d05854bc551bd2a770e38ff6cf88874", "filename": "gcc/config/rs6000/altivec.md", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Fconfig%2Frs6000%2Faltivec.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Fconfig%2Frs6000%2Faltivec.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Faltivec.md?ref=3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "patch": "@@ -968,18 +968,18 @@\n   \"vslo %0,%1,%2\"\n   [(set_attr \"type\" \"vecperm\")])\n \n-(define_insn \"altivec_vsr<VI_char>\"\n+(define_insn \"lshr<mode>3\"\n   [(set (match_operand:VI 0 \"register_operand\" \"=v\")\n-        (unspec:VI [(match_operand:VI 1 \"register_operand\" \"v\")\n-                    (match_operand:VI 2 \"register_operand\" \"v\")] 112))]\n+        (lshiftrt:VI (match_operand:VI 1 \"register_operand\" \"v\")\n+                    (match_operand:VI 2 \"register_operand\" \"v\") ))]\n   \"TARGET_ALTIVEC\"\n   \"vsr<VI_char> %0,%1,%2\"\n   [(set_attr \"type\" \"vecsimple\")])\n \n-(define_insn \"altivec_vsra<VI_char>\"\n+(define_insn \"ashr<mode>3\"\n   [(set (match_operand:VI 0 \"register_operand\" \"=v\")\n-        (unspec:VI [(match_operand:VI 1 \"register_operand\" \"v\")\n-                    (match_operand:VI 2 \"register_operand\" \"v\")] 115))]\n+        (ashiftrt:VI (match_operand:VI 1 \"register_operand\" \"v\")\n+                    (match_operand:VI 2 \"register_operand\" \"v\") ))]\n   \"TARGET_ALTIVEC\"\n   \"vsra<VI_char> %0,%1,%2\"\n   [(set_attr \"type\" \"vecsimple\")])"}, {"sha": "8ca07a242115a0a92c7e46cabe3f7790ee85a9e7", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "patch": "@@ -5590,12 +5590,12 @@ static struct builtin_description bdesc_2arg[] =\n   { MASK_ALTIVEC, CODE_FOR_altivec_vspltb, \"__builtin_altivec_vspltb\", ALTIVEC_BUILTIN_VSPLTB },\n   { MASK_ALTIVEC, CODE_FOR_altivec_vsplth, \"__builtin_altivec_vsplth\", ALTIVEC_BUILTIN_VSPLTH },\n   { MASK_ALTIVEC, CODE_FOR_altivec_vspltw, \"__builtin_altivec_vspltw\", ALTIVEC_BUILTIN_VSPLTW },\n-  { MASK_ALTIVEC, CODE_FOR_altivec_vsrb, \"__builtin_altivec_vsrb\", ALTIVEC_BUILTIN_VSRB },\n-  { MASK_ALTIVEC, CODE_FOR_altivec_vsrh, \"__builtin_altivec_vsrh\", ALTIVEC_BUILTIN_VSRH },\n-  { MASK_ALTIVEC, CODE_FOR_altivec_vsrw, \"__builtin_altivec_vsrw\", ALTIVEC_BUILTIN_VSRW },\n-  { MASK_ALTIVEC, CODE_FOR_altivec_vsrab, \"__builtin_altivec_vsrab\", ALTIVEC_BUILTIN_VSRAB },\n-  { MASK_ALTIVEC, CODE_FOR_altivec_vsrah, \"__builtin_altivec_vsrah\", ALTIVEC_BUILTIN_VSRAH },\n-  { MASK_ALTIVEC, CODE_FOR_altivec_vsraw, \"__builtin_altivec_vsraw\", ALTIVEC_BUILTIN_VSRAW },\n+  { MASK_ALTIVEC, CODE_FOR_lshrv16qi3, \"__builtin_altivec_vsrb\", ALTIVEC_BUILTIN_VSRB },\n+  { MASK_ALTIVEC, CODE_FOR_lshrv8hi3, \"__builtin_altivec_vsrh\", ALTIVEC_BUILTIN_VSRH },\n+  { MASK_ALTIVEC, CODE_FOR_lshrv4si3, \"__builtin_altivec_vsrw\", ALTIVEC_BUILTIN_VSRW },\n+  { MASK_ALTIVEC, CODE_FOR_ashrv16qi3, \"__builtin_altivec_vsrab\", ALTIVEC_BUILTIN_VSRAB },\n+  { MASK_ALTIVEC, CODE_FOR_ashrv8hi3, \"__builtin_altivec_vsrah\", ALTIVEC_BUILTIN_VSRAH },\n+  { MASK_ALTIVEC, CODE_FOR_ashrv4si3, \"__builtin_altivec_vsraw\", ALTIVEC_BUILTIN_VSRAW },\n   { MASK_ALTIVEC, CODE_FOR_altivec_vsr, \"__builtin_altivec_vsr\", ALTIVEC_BUILTIN_VSR },\n   { MASK_ALTIVEC, CODE_FOR_altivec_vsro, \"__builtin_altivec_vsro\", ALTIVEC_BUILTIN_VSRO },\n   { MASK_ALTIVEC, CODE_FOR_subv16qi3, \"__builtin_altivec_vsububm\", ALTIVEC_BUILTIN_VSUBUBM },"}, {"sha": "c5cfda23104afee6465b57eb99feeaf5569d3ad9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "patch": "@@ -1,3 +1,8 @@\n+2004-04-05  Devang Patel  <dpatel@apple.com>\n+\n+\t* lib/target-supports.exp (check_effective_target_vect_shif): New.\n+\t* gcc.dg/vect/vect-shift-1.c: New test.\n+\t\n 2005-04-05  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR libfortran/20755"}, {"sha": "cdc2fded17a3c8357c5f4d098e318f8aeee1b4de", "filename": "gcc/testsuite/gcc.dg/vect/vect-shift-1.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect-shift-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect-shift-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fvect-shift-1.c?ref=3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "patch": "@@ -0,0 +1,28 @@\n+/* { dg-require-effective-target vect_shift } */\n+\n+#include <stdarg.h>\n+#include <signal.h>\n+\n+#define N 16\n+#define MAX 42\n+\n+extern void abort(void); \n+\n+int main ()\n+{  \n+  unsigned int A[4] =  {0x08000000,0x08000001,0xff0000ff,0xf0000001};\n+  unsigned int Answer[4] = {0x01000000,0x01000000,0x01fe0001f,0x1e000000};\n+  unsigned int B[4];\n+  int i, j;\n+  \n+  for (i=0; i<4; i++)\n+    B[i] = A[i] >> 3;\n+  for (i=0; i<4; i++)\n+    if (B[i] != Answer[i])\n+      abort ();\n+  return 0;\n+}\n+\n+\n+\n+/* { dg-final { scan-tree-dump-times \"vectorized 1 loops\" 1 \"vect\" { xfail i?86-*-* x86_64-*-* } } } */"}, {"sha": "5cd503a9784e10d5e48c531fe967f83409e6a75f", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0de9d1880ccba36323b5d6c81bc2a0bae912f8/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=3e0de9d1880ccba36323b5d6c81bc2a0bae912f8", "patch": "@@ -640,6 +640,19 @@ proc check_effective_target_vect_int { } {\n     return $et_vect_int_saved\n }\n \n+# Return 1 if the target supports hardware vector shift operation.\n+\n+proc check_effective_target_vect_shift { } {\n+    if { [istarget powerpc*-*-*] } {\n+\tset answer 1\n+    } else {\n+\tset answer 0\n+    }\n+\n+    verbose \"check_effective_target_vect_shift: returning $answer\" 2\n+    return $answer\n+}\n+\n # Return 1 if the target supports hardware vectors of long, 0 otherwise.\n #\n # This can change for different subtargets so do not cache the result."}]}