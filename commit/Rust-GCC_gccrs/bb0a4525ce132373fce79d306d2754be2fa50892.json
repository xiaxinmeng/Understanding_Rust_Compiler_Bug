{"sha": "bb0a4525ce132373fce79d306d2754be2fa50892", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmIwYTQ1MjVjZTEzMjM3M2ZjZTc5ZDMwNmQyNzU0YmUyZmE1MDg5Mg==", "commit": {"author": {"name": "Per Bothner", "email": "per@bothner.com", "date": "2005-04-05T18:24:32Z"}, "committer": {"name": "Per Bothner", "email": "bothner@gcc.gnu.org", "date": "2005-04-05T18:24:32Z"}, "message": "tree-ssa.c (execute_early_warn_uninitialized): Pass context node to talk_tree as 'data' parameter, rather than EXPR_LOCUS.\n\n\n\t* tree-ssa.c (execute_early_warn_uninitialized): Pass context node\n\tto talk_tree as 'data' parameter, rather than EXPR_LOCUS.\n\t(warn_uninit): Get EXPR_LOCUS from context now instead.\n\tThis fixes a USE_MAPPED_LOCATION testsuite failure.\n\n\t* tree-ssa.c (warn_uninitialized_var): Remove useless local.\n\nFrom-SVN: r97644", "tree": {"sha": "b460bf328e8c879dc48f2b59ddc97103ceb3e8c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b460bf328e8c879dc48f2b59ddc97103ceb3e8c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb0a4525ce132373fce79d306d2754be2fa50892", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb0a4525ce132373fce79d306d2754be2fa50892", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb0a4525ce132373fce79d306d2754be2fa50892", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb0a4525ce132373fce79d306d2754be2fa50892/comments", "author": {"login": "PerBothner", "id": 10293361, "node_id": "MDQ6VXNlcjEwMjkzMzYx", "avatar_url": "https://avatars.githubusercontent.com/u/10293361?v=4", "gravatar_id": "", "url": "https://api.github.com/users/PerBothner", "html_url": "https://github.com/PerBothner", "followers_url": "https://api.github.com/users/PerBothner/followers", "following_url": "https://api.github.com/users/PerBothner/following{/other_user}", "gists_url": "https://api.github.com/users/PerBothner/gists{/gist_id}", "starred_url": "https://api.github.com/users/PerBothner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/PerBothner/subscriptions", "organizations_url": "https://api.github.com/users/PerBothner/orgs", "repos_url": "https://api.github.com/users/PerBothner/repos", "events_url": "https://api.github.com/users/PerBothner/events{/privacy}", "received_events_url": "https://api.github.com/users/PerBothner/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3d3c0aeaf2c0512bc7d1d2ddc36821b03996a6bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d3c0aeaf2c0512bc7d1d2ddc36821b03996a6bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d3c0aeaf2c0512bc7d1d2ddc36821b03996a6bb"}], "stats": {"total": 28, "additions": 21, "deletions": 7}, "files": [{"sha": "79ae89ce46472bf362591f2d0ad400925c022a36", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb0a4525ce132373fce79d306d2754be2fa50892/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb0a4525ce132373fce79d306d2754be2fa50892/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bb0a4525ce132373fce79d306d2754be2fa50892", "patch": "@@ -1,3 +1,12 @@\n+2005-04-05  Per Bothner  <per@bothner.com>\n+\n+\t* tree-ssa.c (execute_early_warn_uninitialized): Pass context node\n+\tto talk_tree as 'data' parameter, rather than EXPR_LOCUS.\n+\t(warn_uninit): Get EXPR_LOCUS from context now instead.\n+\tThis fixes a USE_MAPPED_LOCATION testsuite failure.\n+\n+\t* tree-ssa.c (warn_uninitialized_var): Remove useless local.\n+\n 2005-04-05  Per Bothner  <per@bothner.com>\n \n \t* c-decl.c (finish_function): If USE_MAPPED_LOCATION set the location"}, {"sha": "a9564b86c4a2b9ebc1d3d846961207ac11cc59c1", "filename": "gcc/tree-ssa.c", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb0a4525ce132373fce79d306d2754be2fa50892/gcc%2Ftree-ssa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb0a4525ce132373fce79d306d2754be2fa50892/gcc%2Ftree-ssa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa.c?ref=bb0a4525ce132373fce79d306d2754be2fa50892", "patch": "@@ -1337,10 +1337,12 @@ struct tree_opt_pass pass_redundant_phi =\n    warning text is in MSGID and LOCUS may contain a location or be null.  */\n \n static void\n-warn_uninit (tree t, const char *msgid, location_t *locus)\n+warn_uninit (tree t, const char *msgid, void *data)\n {\n   tree var = SSA_NAME_VAR (t);\n   tree def = SSA_NAME_DEF_STMT (t);\n+  tree context = (tree) data;\n+  location_t * locus;\n \n   /* Default uses (indicated by an empty definition statement),\n      are uninitialized.  */\n@@ -1360,8 +1362,9 @@ warn_uninit (tree t, const char *msgid, location_t *locus)\n   if (TREE_NO_WARNING (var))\n     return;\n \n-  if (!locus)\n-    locus = &DECL_SOURCE_LOCATION (var);\n+  locus = (context != NULL && EXPR_HAS_LOCATION (context)\n+\t   ? EXPR_LOCUS (context)\n+\t   : &DECL_SOURCE_LOCATION (var));\n   warning (msgid, locus, var);\n   TREE_NO_WARNING (var) = 1;\n }\n@@ -1372,13 +1375,12 @@ warn_uninit (tree t, const char *msgid, location_t *locus)\n static tree\n warn_uninitialized_var (tree *tp, int *walk_subtrees, void *data)\n {\n-  location_t *locus = data;\n   tree t = *tp;\n \n   /* We only do data flow with SSA_NAMEs, so that's all we can warn about.  */\n   if (TREE_CODE (t) == SSA_NAME)\n     {\n-      warn_uninit (t, \"%H%qD is used uninitialized in this function\", locus);\n+      warn_uninit (t, \"%H%qD is used uninitialized in this function\", data);\n       *walk_subtrees = 0;\n     }\n   else if (IS_TYPE_OR_DECL_P (t))\n@@ -1416,8 +1418,11 @@ execute_early_warn_uninitialized (void)\n \n   FOR_EACH_BB (bb)\n     for (bsi = bsi_start (bb); !bsi_end_p (bsi); bsi_next (&bsi))\n-      walk_tree (bsi_stmt_ptr (bsi), warn_uninitialized_var,\n-\t\t EXPR_LOCUS (bsi_stmt (bsi)), NULL);\n+      {\n+\ttree context = bsi_stmt (bsi);\n+\twalk_tree (bsi_stmt_ptr (bsi), warn_uninitialized_var,\n+\t\t   context, NULL);\n+      }\n }\n \n static void"}]}