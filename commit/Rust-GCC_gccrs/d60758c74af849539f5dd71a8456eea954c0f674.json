{"sha": "d60758c74af849539f5dd71a8456eea954c0f674", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDYwNzU4Yzc0YWY4NDk1MzlmNWRkNzFhODQ1NmVlYTk1NGMwZjY3NA==", "commit": {"author": {"name": "Hu Jiangping", "email": "hujiangping@cn.fujitsu.com", "date": "2020-07-27T17:22:23Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2020-07-27T17:22:23Z"}, "message": "driver: fix a problem with implementation of -falign-foo=0 [PR96247]\n\nThis patch makes the -falign-foo=0 work as described in the\ndocumentation. Thanks for all the suggestions.\n\nChangelog:\n2020-07-27  Hu Jiangping  <hujiangping@cn.fujitsu.com>\n\n\tPR driver/96247\n\t* opts.c (check_alignment_argument): Set the -falign-Name\n\ton/off flag on and set the -falign-Name string value null,\n\twhen the command-line specified argument is zero.", "tree": {"sha": "30041717acac7b6eb2c18ab19255227fcd69541f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/30041717acac7b6eb2c18ab19255227fcd69541f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d60758c74af849539f5dd71a8456eea954c0f674", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d60758c74af849539f5dd71a8456eea954c0f674", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d60758c74af849539f5dd71a8456eea954c0f674", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d60758c74af849539f5dd71a8456eea954c0f674/comments", "author": {"login": "fnst013156", "id": 25763187, "node_id": "MDQ6VXNlcjI1NzYzMTg3", "avatar_url": "https://avatars.githubusercontent.com/u/25763187?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fnst013156", "html_url": "https://github.com/fnst013156", "followers_url": "https://api.github.com/users/fnst013156/followers", "following_url": "https://api.github.com/users/fnst013156/following{/other_user}", "gists_url": "https://api.github.com/users/fnst013156/gists{/gist_id}", "starred_url": "https://api.github.com/users/fnst013156/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fnst013156/subscriptions", "organizations_url": "https://api.github.com/users/fnst013156/orgs", "repos_url": "https://api.github.com/users/fnst013156/repos", "events_url": "https://api.github.com/users/fnst013156/events{/privacy}", "received_events_url": "https://api.github.com/users/fnst013156/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "8939cef9512704dfd18d97ad3e66d6ce233e9452", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8939cef9512704dfd18d97ad3e66d6ce233e9452", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8939cef9512704dfd18d97ad3e66d6ce233e9452"}], "stats": {"total": 28, "additions": 22, "deletions": 6}, "files": [{"sha": "6628f7e8f1317e5dc6558078b432f795337703c3", "filename": "gcc/opts.c", "status": "modified", "additions": 22, "deletions": 6, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d60758c74af849539f5dd71a8456eea954c0f674/gcc%2Fopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d60758c74af849539f5dd71a8456eea954c0f674/gcc%2Fopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fopts.c?ref=d60758c74af849539f5dd71a8456eea954c0f674", "patch": "@@ -2004,13 +2004,21 @@ parse_and_check_align_values (const char *flag,\n }\n \n /* Check that alignment value FLAG for -falign-NAME is valid at a given\n-   location LOC.  */\n+   location LOC. OPT_STR points to the stored -falign-NAME=argument and\n+   OPT_FLAG points to the associated -falign-NAME on/off flag.  */\n \n static void\n-check_alignment_argument (location_t loc, const char *flag, const char *name)\n+check_alignment_argument (location_t loc, const char *flag, const char *name,\n+\t\t\t  int *opt_flag, const char **opt_str)\n {\n   auto_vec<unsigned> align_result;\n   parse_and_check_align_values (flag, name, align_result, true, loc);\n+\n+  if (align_result.length() >= 1 && align_result[0] == 0)\n+    {\n+      *opt_flag = 1;\n+      *opt_str = NULL;\n+    }\n }\n \n /* Print help when OPT__help_ is set.  */\n@@ -2785,19 +2793,27 @@ common_handle_option (struct gcc_options *opts,\n       break;\n \n     case OPT_falign_loops_:\n-      check_alignment_argument (loc, arg, \"loops\");\n+      check_alignment_argument (loc, arg, \"loops\",\n+\t\t\t\t&opts->x_flag_align_loops,\n+\t\t\t\t&opts->x_str_align_loops);\n       break;\n \n     case OPT_falign_jumps_:\n-      check_alignment_argument (loc, arg, \"jumps\");\n+      check_alignment_argument (loc, arg, \"jumps\",\n+\t\t\t\t&opts->x_flag_align_jumps,\n+\t\t\t\t&opts->x_str_align_jumps);\n       break;\n \n     case OPT_falign_labels_:\n-      check_alignment_argument (loc, arg, \"labels\");\n+      check_alignment_argument (loc, arg, \"labels\",\n+\t\t\t\t&opts->x_flag_align_labels,\n+\t\t\t\t&opts->x_str_align_labels);\n       break;\n \n     case OPT_falign_functions_:\n-      check_alignment_argument (loc, arg, \"functions\");\n+      check_alignment_argument (loc, arg, \"functions\",\n+\t\t\t\t&opts->x_flag_align_functions,\n+\t\t\t\t&opts->x_str_align_functions);\n       break;\n \n     case OPT_ftabstop_:"}]}