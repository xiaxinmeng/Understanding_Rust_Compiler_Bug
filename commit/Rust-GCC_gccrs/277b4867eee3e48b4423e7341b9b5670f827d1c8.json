{"sha": "277b4867eee3e48b4423e7341b9b5670f827d1c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjc3YjQ4NjdlZWUzZTQ4YjQ0MjNlNzM0MWI5YjU2NzBmODI3ZDFjOA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2008-08-31T11:40:11Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2008-08-31T11:40:11Z"}, "message": "cold-attribute-1.c: New testcase.\n\n\n\t* gcc.target/i386/cold-attribute-1.c: New testcase.\n\t* gcc.target/i386/cold-attribute-2.c: New testcase.\n\t* gcc.target/i386/cold-attribute-3.c: New testcase.\n\t* gcc.target/i386/cold-attribute-4.c: New testcase.\n\t* predict.c (PROB_VERY_LIKELY): Make small enough so things\n\tbecome cold.\n\t* predict.def (PRED_NORETURN_CALL, PRED_COLD_CALL): Use it.\n\nFrom-SVN: r139827", "tree": {"sha": "57ded3bb457ee70d3fede2ec7f8847787321ac33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/57ded3bb457ee70d3fede2ec7f8847787321ac33"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/277b4867eee3e48b4423e7341b9b5670f827d1c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/277b4867eee3e48b4423e7341b9b5670f827d1c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/277b4867eee3e48b4423e7341b9b5670f827d1c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/277b4867eee3e48b4423e7341b9b5670f827d1c8/comments", "author": null, "committer": null, "parents": [{"sha": "8518c095a8aaa6375e1e7046c824d7c2a9893855", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8518c095a8aaa6375e1e7046c824d7c2a9893855", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8518c095a8aaa6375e1e7046c824d7c2a9893855"}], "stats": {"total": 120, "additions": 116, "deletions": 4}, "files": [{"sha": "9b7ece0908227c3a095ec09a508a5d9c109b2d93", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -1,3 +1,9 @@\n+2008-08-31  Jan Hubicka  <jh@suse.cz>\n+\n+\t* predict.c (PROB_VERY_LIKELY): Make small enough so things\n+\tbecome cold.\n+\t* predict.def (PRED_NORETURN_CALL, PRED_COLD_CALL): Use it.\n+\n 2008-08-31  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/37287"}, {"sha": "e02f9f890c2fd417bbe94f3c29d37627a5bed436", "filename": "gcc/predict.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Fpredict.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Fpredict.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpredict.c?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -66,8 +66,10 @@ along with GCC; see the file COPYING3.  If not see\n static sreal real_zero, real_one, real_almost_one, real_br_prob_base,\n \t     real_inv_br_prob_base, real_one_half, real_bb_freq_max;\n \n-/* Random guesstimation given names.  */\n-#define PROB_VERY_UNLIKELY\t(REG_BR_PROB_BASE / 100 - 1)\n+/* Random guesstimation given names.  \n+   PROV_VERY_UNLIKELY should be small enough so basic block predicted\n+   by it gets bellow HOT_BB_FREQUENCY_FRANCTION.  */\n+#define PROB_VERY_UNLIKELY\t(REG_BR_PROB_BASE / 2000 - 1)\n #define PROB_EVEN\t\t(REG_BR_PROB_BASE / 2)\n #define PROB_VERY_LIKELY\t(REG_BR_PROB_BASE - PROB_VERY_UNLIKELY)\n #define PROB_ALWAYS\t\t(REG_BR_PROB_BASE)"}, {"sha": "e97e563fdb46c1ad64ddb27a553412fbc3ad9783", "filename": "gcc/predict.def", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Fpredict.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Fpredict.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpredict.def?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -69,11 +69,11 @@ DEF_PREDICTOR (PRED_LOOP_ITERATIONS_GUESSED, \"guessed loop iterations\",\n DEF_PREDICTOR (PRED_CONTINUE, \"continue\", HITRATE (50), 0)\n \n /* Branch to basic block containing call marked by noreturn attribute.  */\n-DEF_PREDICTOR (PRED_NORETURN, \"noreturn call\", HITRATE (99),\n+DEF_PREDICTOR (PRED_NORETURN, \"noreturn call\", PROB_VERY_LIKELY,\n \t       PRED_FLAG_FIRST_MATCH)\n \n /* Branch to basic block containing call marked by cold function attribute.  */\n-DEF_PREDICTOR (PRED_COLD_FUNCTION, \"cold function call\", HITRATE (99),\n+DEF_PREDICTOR (PRED_COLD_FUNCTION, \"cold function call\", PROB_VERY_LIKELY,\n \t       PRED_FLAG_FIRST_MATCH)\n \n /* Loopback edge is taken.  */"}, {"sha": "3e4a2e9cc271b50792ec0317c276511b64f4f155", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -1,3 +1,10 @@\n+2008-08-31  Jan Hubicka  <jh@suse.cz>\n+\n+\t* gcc.target/i386/cold-attribute-1.c: New testcase.\n+\t* gcc.target/i386/cold-attribute-2.c: New testcase.\n+\t* gcc.target/i386/cold-attribute-3.c: New testcase.\n+\t* gcc.target/i386/cold-attribute-4.c: New testcase.\n+\n 2008-08-31  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/37287"}, {"sha": "22615b38790fe076c1f694c1d9b9933d7d5abe56", "filename": "gcc/testsuite/gcc.target/i386/cold-attribute-1.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-1.c?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+#include <string.h>\n+static inline\n+__attribute__ ((cold))\n+my_cold_memset (void *a, int b,int c)\n+{\n+  memset (a,b,c);\n+}\n+t(void *a,int b,int c)\n+{\n+  if (a)\n+    my_cold_memset (a,b,c);\n+}\n+\n+/* The IF conditional should be predicted as cold and my_cold_memset inlined\n+   for size expanding memset as rep; stosb.  */\n+/* { dg-final { scan-assembler \"stosb\" } } */"}, {"sha": "93ea906614f4815134f80553e8f2cdd75da705cb", "filename": "gcc/testsuite/gcc.target/i386/cold-attribute-2.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-2.c?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+#include <string.h>\n+t(int c)\n+{\n+  if (__builtin_expect (c, 0))\n+    {\n+      cold_hint ();\n+      return c * 11;\n+    }\n+  return c;\n+}\n+\n+/* { dg-final { scan-assembler \"imul\" } } */"}, {"sha": "5225428c5c1a637d624355907e25bff4bccd6078", "filename": "gcc/testsuite/gcc.target/i386/cold-attribute-3.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-3.c?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+#include <string.h>\n+\n+int\n+__attribute__ ((cold))\n+t(int c)\n+{\n+  return c * 11;\n+}\n+\n+/* { dg-final { scan-assembler \"imul\" } } */"}, {"sha": "37a41e954daf3b189de585cb6a8f1172ac01d126", "filename": "gcc/testsuite/gcc.target/i386/cold-attribute-4.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-4.c?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+#include <string.h>\n+\n+int\n+__attribute__ ((cold))\n+t(int c)\n+{\n+  return -1;\n+}\n+\n+/* { dg-final { scan-assembler \"orl\" } } */"}, {"sha": "68d05d09d4b86137b3b13bbefa332636e4c155e8", "filename": "gcc/testsuite/gcc.target/i386/cold-attribute-4.s", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-4.s", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/277b4867eee3e48b4423e7341b9b5670f827d1c8/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-4.s", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fcold-attribute-4.s?ref=277b4867eee3e48b4423e7341b9b5670f827d1c8", "patch": "@@ -0,0 +1,41 @@\n+\t.file\t\"cold-attribute-4.c\"\n+\t.text\n+\t.p2align 4,,15\n+.globl t\n+\t.type\tt, @function\n+t:\n+.LFB14:\n+\tmovl\t$-1, %eax\n+\tret\n+.LFE14:\n+\t.size\tt, .-t\n+\t.section\t.eh_frame,\"a\",@progbits\n+.Lframe1:\n+\t.long\t.LECIE1-.LSCIE1\n+.LSCIE1:\n+\t.long\t0x0\n+\t.byte\t0x1\n+\t.string\t\"zR\"\n+\t.uleb128 0x1\n+\t.sleb128 -8\n+\t.byte\t0x10\n+\t.uleb128 0x1\n+\t.byte\t0x3\n+\t.byte\t0xc\n+\t.uleb128 0x7\n+\t.uleb128 0x8\n+\t.byte\t0x90\n+\t.uleb128 0x1\n+\t.align 8\n+.LECIE1:\n+.LSFDE1:\n+\t.long\t.LEFDE1-.LASFDE1\n+.LASFDE1:\n+\t.long\t.LASFDE1-.Lframe1\n+\t.long\t.LFB14\n+\t.long\t.LFE14-.LFB14\n+\t.uleb128 0x0\n+\t.align 8\n+.LEFDE1:\n+\t.ident\t\"GCC: (GNU) 4.1.2 20061115 (prerelease) (Debian 4.1.1-21)\"\n+\t.section\t.note.GNU-stack,\"\",@progbits"}]}