{"sha": "7d92172c18f8979710d1baa7cadc43a115dc3a13", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2Q5MjE3MmMxOGY4OTc5NzEwZDFiYWE3Y2FkYzQzYTExNWRjM2ExMw==", "commit": {"author": {"name": "Bob Duff", "email": "duff@adacore.com", "date": "2017-10-19T23:12:27Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2017-10-19T23:12:27Z"}, "message": "exp_ch6.adb (Is_Build_In_Place_Result_Type): Fix silly bug -- \"Typ\" should be \"T\".\n\n2017-10-19  Bob Duff  <duff@adacore.com>\n\n\t* exp_ch6.adb (Is_Build_In_Place_Result_Type): Fix silly bug -- \"Typ\"\n\tshould be \"T\".  Handle case of a subtype of a class-wide type.\n\nFrom-SVN: r253916", "tree": {"sha": "d7cf013ae6f4cedde62304bb76490e9c6f9f3b6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d7cf013ae6f4cedde62304bb76490e9c6f9f3b6f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d92172c18f8979710d1baa7cadc43a115dc3a13", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d92172c18f8979710d1baa7cadc43a115dc3a13", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d92172c18f8979710d1baa7cadc43a115dc3a13", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d92172c18f8979710d1baa7cadc43a115dc3a13/comments", "author": {"login": "bobduff", "id": 29099567, "node_id": "MDQ6VXNlcjI5MDk5NTY3", "avatar_url": "https://avatars.githubusercontent.com/u/29099567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobduff", "html_url": "https://github.com/bobduff", "followers_url": "https://api.github.com/users/bobduff/followers", "following_url": "https://api.github.com/users/bobduff/following{/other_user}", "gists_url": "https://api.github.com/users/bobduff/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobduff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobduff/subscriptions", "organizations_url": "https://api.github.com/users/bobduff/orgs", "repos_url": "https://api.github.com/users/bobduff/repos", "events_url": "https://api.github.com/users/bobduff/events{/privacy}", "received_events_url": "https://api.github.com/users/bobduff/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fb9dd1c7c32efd0c90c21070ed7dabc9006ef1ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb9dd1c7c32efd0c90c21070ed7dabc9006ef1ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb9dd1c7c32efd0c90c21070ed7dabc9006ef1ef"}], "stats": {"total": 25, "additions": 16, "deletions": 9}, "files": [{"sha": "f3d7209ff5b8ea374297515785004d09fbae4310", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d92172c18f8979710d1baa7cadc43a115dc3a13/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d92172c18f8979710d1baa7cadc43a115dc3a13/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=7d92172c18f8979710d1baa7cadc43a115dc3a13", "patch": "@@ -1,3 +1,8 @@\n+2017-10-19  Bob Duff  <duff@adacore.com>\n+\n+\t* exp_ch6.adb (Is_Build_In_Place_Result_Type): Fix silly bug -- \"Typ\"\n+\tshould be \"T\".  Handle case of a subtype of a class-wide type.\n+\n 2017-10-19  Bob Duff  <duff@adacore.com>\n \n \t* exp_util.adb: (Process_Statements_For_Controlled_Objects): Clarify"}, {"sha": "ecef075a85ea4dd029acf21f419cc25fd00a81d5", "filename": "gcc/ada/exp_ch6.adb", "status": "modified", "additions": 11, "deletions": 9, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d92172c18f8979710d1baa7cadc43a115dc3a13/gcc%2Fada%2Fexp_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d92172c18f8979710d1baa7cadc43a115dc3a13/gcc%2Fada%2Fexp_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch6.adb?ref=7d92172c18f8979710d1baa7cadc43a115dc3a13", "patch": "@@ -7249,26 +7249,28 @@ package body Exp_Ch6 is\n          begin\n             --  For T'Class, return True if it's True for T. This is necessary\n             --  because a class-wide function might say \"return F (...)\", where\n-            --  F returns the corresponding specific type.\n+            --  F returns the corresponding specific type. We need a loop in\n+            --  case T is a subtype of a class-wide type.\n \n-            if Is_Class_Wide_Type (Typ) then\n-               T := Etype (Typ);\n-            end if;\n+            while Is_Class_Wide_Type (T) loop\n+               T := Etype (T);\n+            end loop;\n \n             --  If this is a generic formal type in an instance, return True if\n             --  it's True for the generic actual type.\n \n-            if Nkind (Parent (Typ)) = N_Subtype_Declaration\n-              and then Present (Generic_Parent_Type (Parent (Typ)))\n+            if Nkind (Parent (T)) = N_Subtype_Declaration\n+              and then Present (Generic_Parent_Type (Parent (T)))\n             then\n-               T := Entity (Subtype_Indication (Parent (Typ)));\n+               T := Entity (Subtype_Indication (Parent (T)));\n \n                if Present (Full_View (T)) then\n                   T := Full_View (T);\n                end if;\n+            end if;\n \n-            elsif Present (Underlying_Type (Typ)) then\n-               T := Underlying_Type (Typ);\n+            if Present (Underlying_Type (T)) then\n+               T := Underlying_Type (T);\n             end if;\n \n             declare"}]}