{"sha": "9f309df283a540dfee6aab70c5ff800e3edc4698", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWYzMDlkZjI4M2E1NDBkZmVlNmFhYjcwYzVmZjgwMGUzZWRjNDY5OA==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2008-12-09T03:19:09Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2008-12-09T03:19:09Z"}, "message": "re PR fortran/38430 (gfortran.dg/streamio_1.f90, 10, 14, 2, 6 now fails)\n\n2008-12-08  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libfortran/38430\n\t* io/transfer.c (data_transfer_init): Move constraint check for REC=\n\tand STREAM access into condition for other REC= constraints to simplify.\n\tComment out this constraint to avoid breaking compatibility with 4.3\n\tuntil later.  Added a TODO for above comment and this one.\n\tFix test for max pos.\n\nFrom-SVN: r142575", "tree": {"sha": "e32337bd8289abcab39c735bd695f185dbbd4737", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e32337bd8289abcab39c735bd695f185dbbd4737"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f309df283a540dfee6aab70c5ff800e3edc4698", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f309df283a540dfee6aab70c5ff800e3edc4698", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f309df283a540dfee6aab70c5ff800e3edc4698", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f309df283a540dfee6aab70c5ff800e3edc4698/comments", "author": null, "committer": null, "parents": [{"sha": "3033db1a6da85a68e3968cb33233393803f2c5ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3033db1a6da85a68e3968cb33233393803f2c5ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3033db1a6da85a68e3968cb33233393803f2c5ab"}], "stats": {"total": 34, "additions": 22, "deletions": 12}, "files": [{"sha": "dcc4867882e5fc3c3ca0a575cce48fdb07f4fa23", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f309df283a540dfee6aab70c5ff800e3edc4698/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f309df283a540dfee6aab70c5ff800e3edc4698/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=9f309df283a540dfee6aab70c5ff800e3edc4698", "patch": "@@ -1,3 +1,12 @@\n+2008-12-08  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libfortran/38430\n+\t* io/transfer.c (data_transfer_init): Move constraint check for REC=\n+\tand STREAM access into condition for other REC= constraints to simplify.\n+\tComment out this constraint to avoid breaking compatibility with 4.3\n+\tuntil later.  Added a TODO for above comment and this one.\n+\tFix test for max pos.\n+\n 2008-12-06  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libfortran/38291"}, {"sha": "ea63a0daffcacaaa87b5d0045686583c19508b7d", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 13, "deletions": 12, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f309df283a540dfee6aab70c5ff800e3edc4698/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f309df283a540dfee6aab70c5ff800e3edc4698/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=9f309df283a540dfee6aab70c5ff800e3edc4698", "patch": "@@ -1986,15 +1986,6 @@ data_transfer_init (st_parameter_dt *dtp, int read_flag)\n       return;\n     }\n \n-  if (dtp->u.p.current_unit->flags.access == ACCESS_STREAM\n-      && (cf & IOPARM_DT_HAS_REC) != 0)\n-    {\n-      generate_error (&dtp->common, LIBERROR_OPTION_CONFLICT,\n-\t\t      \"Record number not allowed for stream access \"\n-\t\t      \"data transfer\");\n-      return;\n-    }\n-\n   /* Process the ADVANCE option.  */\n \n   dtp->u.p.advance_status\n@@ -2141,7 +2132,7 @@ data_transfer_init (st_parameter_dt *dtp, int read_flag)\n \t      return;\n \t    }\n \n-\t  if (dtp->rec >= dtp->u.p.current_unit->maxrec)\n+\t  if (dtp->pos >= dtp->u.p.current_unit->maxrec)\n \t    {\n \t      generate_error (&dtp->common, LIBERROR_BAD_OPTION,\n \t\t\t      \"POS=specifier too large\");\n@@ -2231,10 +2222,20 @@ data_transfer_init (st_parameter_dt *dtp, int read_flag)\n \t  return;\n \t}\n \n-      /* This is required to maintain compatibility between\n-\t 4.3 and 4.4 runtime.  */\n+      /* TODO: This is required to maintain compatibility between\n+\t 4.3 and 4.4 runtime. Remove when ABI changes from 4.3 */\n+\n       if (is_stream_io (dtp))\n \tdtp->u.p.current_unit->strm_pos = dtp->rec;\n+      \n+      /* TODO: Un-comment this code when ABI changes from 4.3.\n+      if (dtp->u.p.current_unit->flags.access == ACCESS_STREAM)\n+\t{\n+\t  generate_error (&dtp->common, LIBERROR_OPTION_CONFLICT,\n+\t\t      \"Record number not allowed for stream access \"\n+\t\t      \"data transfer\");\n+\t  return;\n+\t}  */\n \n     }\n "}]}