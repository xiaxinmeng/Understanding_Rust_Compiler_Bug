{"sha": "0b9fc9fee84ec9de6de8d95ee670bc121b298331", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGI5ZmM5ZmVlODRlYzlkZTZkZThkOTVlZTY3MGJjMTIxYjI5ODMzMQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2015-05-14T11:47:19Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2015-05-14T11:47:19Z"}, "message": "re PR libstdc++/66018 (opendir configure test not working when GCC_NO_EXECUTABLES)\n\n\tPR libstdc++/66018\n\t* acinclude.m4 (GLIBCXX_CHECK_FILESYSTEM_DEPS): Check for struct\n\tdirent.d_type.\n\t* config.h.in: Regenerate.\n\t* configure: Regenerate.\n\t* configure.ac (AC_STRUCT_DIRENT_D_TYPE): Remove.\n\nFrom-SVN: r223194", "tree": {"sha": "e46d3a1e3fcbf42e0bcefe1ed788fec670f30041", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e46d3a1e3fcbf42e0bcefe1ed788fec670f30041"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0b9fc9fee84ec9de6de8d95ee670bc121b298331", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b9fc9fee84ec9de6de8d95ee670bc121b298331", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b9fc9fee84ec9de6de8d95ee670bc121b298331", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b9fc9fee84ec9de6de8d95ee670bc121b298331/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3aa3c9fc9a5f82f23717386df7fa342e0a89b627", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3aa3c9fc9a5f82f23717386df7fa342e0a89b627", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3aa3c9fc9a5f82f23717386df7fa342e0a89b627"}], "stats": {"total": 378, "additions": 100, "deletions": 278}, "files": [{"sha": "000bcd56bca18dd87a07bc119a88594a7c62f364", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=0b9fc9fee84ec9de6de8d95ee670bc121b298331", "patch": "@@ -1,3 +1,12 @@\n+2015-05-14  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/66018\n+\t* acinclude.m4 (GLIBCXX_CHECK_FILESYSTEM_DEPS): Check for struct\n+\tdirent.d_type.\n+\t* config.h.in: Regenerate.\n+\t* configure: Regenerate.\n+\t* configure.ac (AC_STRUCT_DIRENT_D_TYPE): Remove.\n+\n 2015-05-13  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* acinclude.m4 (GLIBCXX_ENABLE_SJLJ_EXCEPTIONS): Delete."}, {"sha": "b2b48cc2944e36646c61b9a868e2254d42bf6b6b", "filename": "libstdc++-v3/acinclude.m4", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Facinclude.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Facinclude.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Facinclude.m4?ref=0b9fc9fee84ec9de6de8d95ee670bc121b298331", "patch": "@@ -3874,6 +3874,22 @@ dnl\n   AC_LANG_CPLUSPLUS\n   ac_save_CXXFLAGS=\"$CXXFLAGS\"\n   CXXFLAGS=\"$CXXFLAGS -fno-exceptions\"\n+dnl\n+  AC_MSG_CHECKING([for struct dirent.d_type])\n+  AC_CACHE_VAL(glibcxx_cv_dirent_d_type, [dnl\n+    GCC_TRY_COMPILE_OR_LINK(\n+      [#include <dirent.h>],\n+      [\n+       struct dirent d;\n+       if (sizeof d.d_type) return 0;\n+      ],\n+      [glibcxx_cv_dirent_d_type=yes],\n+      [glibcxx_cv_dirent_d_type=no])\n+  ])\n+  if test $glibcxx_cv_dirent_d_type = yes; then\n+    AC_DEFINE(_GLIBCXX_HAVE_STRUCT_DIRENT_D_TYPE, 1, [Define to 1 if `d_type' is a member of `struct dirent'.])\n+  fi\n+  AC_MSG_RESULT($glibcxx_cv_dirent_d_type)\n dnl\n   AC_MSG_CHECKING([for realpath])\n   AC_CACHE_VAL(glibcxx_cv_realpath, [dnl"}, {"sha": "b833c811c519c4d9a6e006bfff5de265ae3c62e2", "filename": "libstdc++-v3/config.h.in", "status": "modified", "additions": 4, "deletions": 16, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig.h.in?ref=0b9fc9fee84ec9de6de8d95ee670bc121b298331", "patch": "@@ -54,8 +54,7 @@\n /* Define to 1 if you have the `cosl' function. */\n #undef HAVE_COSL\n \n-/* Define to 1 if you have the <dirent.h> header file, and it defines `DIR'.\n-   */\n+/* Define to 1 if you have the <dirent.h> header file. */\n #undef HAVE_DIRENT_H\n \n /* Define to 1 if you have the <dlfcn.h> header file. */\n@@ -301,9 +300,6 @@\n /* Define to 1 if you have the <nan.h> header file. */\n #undef HAVE_NAN_H\n \n-/* Define to 1 if you have the <ndir.h> header file, and it defines `DIR'. */\n-#undef HAVE_NDIR_H\n-\n /* Define if poll is available in <poll.h>. */\n #undef HAVE_POLL\n \n@@ -382,20 +378,13 @@\n /* Define to 1 if you have the `strtold' function. */\n #undef HAVE_STRTOLD\n \n-/* Define to 1 if `struct dirent' is a member of `d_type'. */\n-#undef HAVE_STRUCT_DIRENT_D_TYPE\n-\n /* Define if strxfrm_l is available in <string.h>. */\n #undef HAVE_STRXFRM_L\n \n /* Define to 1 if the target runtime linker supports binding the same symbol\n    to different versions. */\n #undef HAVE_SYMVER_SYMBOL_RENAMING_RUNTIME_SUPPORT\n \n-/* Define to 1 if you have the <sys/dir.h> header file, and it defines `DIR'.\n-   */\n-#undef HAVE_SYS_DIR_H\n-\n /* Define to 1 if you have the <sys/filio.h> header file. */\n #undef HAVE_SYS_FILIO_H\n \n@@ -411,10 +400,6 @@\n /* Define to 1 if you have the <sys/machine.h> header file. */\n #undef HAVE_SYS_MACHINE_H\n \n-/* Define to 1 if you have the <sys/ndir.h> header file, and it defines `DIR'.\n-   */\n-#undef HAVE_SYS_NDIR_H\n-\n /* Define to 1 if you have the <sys/param.h> header file. */\n #undef HAVE_SYS_PARAM_H\n \n@@ -753,6 +738,9 @@\n /* Define if gthreads library is available. */\n #undef _GLIBCXX_HAS_GTHREADS\n \n+/* Define to 1 if `d_type' is a member of `struct dirent'. */\n+#undef _GLIBCXX_HAVE_STRUCT_DIRENT_D_TYPE\n+\n /* Define to 1 if a full hosted library is built, or 0 if freestanding. */\n #undef _GLIBCXX_HOSTED\n "}, {"sha": "d30cd188b4e05fe1084783ebbe7a57291cc37bd5", "filename": "libstdc++-v3/configure", "status": "modified", "additions": 71, "deletions": 261, "changes": 332, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure?ref=0b9fc9fee84ec9de6de8d95ee670bc121b298331", "patch": "@@ -2553,63 +2553,6 @@ $as_echo \"$ac_res\" >&6; }\n   eval $as_lineno_stack; test \"x$as_lineno_stack\" = x && { as_lineno=; unset as_lineno;}\n \n } # ac_fn_cxx_check_type\n-\n-# ac_fn_c_check_member LINENO AGGR MEMBER VAR INCLUDES\n-# ----------------------------------------------------\n-# Tries to find if the field MEMBER exists in type AGGR, after including\n-# INCLUDES, setting cache variable VAR accordingly.\n-ac_fn_c_check_member ()\n-{\n-  as_lineno=${as_lineno-\"$1\"} as_lineno_stack=as_lineno_stack=$as_lineno_stack\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for $2.$3\" >&5\n-$as_echo_n \"checking for $2.$3... \" >&6; }\n-if { as_var=$4; eval \"test \\\"\\${$as_var+set}\\\" = set\"; }; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-$5\n-int\n-main ()\n-{\n-static $2 ac_aggr;\n-if (ac_aggr.$3)\n-return 0;\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  eval \"$4=yes\"\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-$5\n-int\n-main ()\n-{\n-static $2 ac_aggr;\n-if (sizeof ac_aggr.$3)\n-return 0;\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  eval \"$4=yes\"\n-else\n-  eval \"$4=no\"\n-fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n-fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n-fi\n-eval ac_res=\\$$4\n-\t       { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_res\" >&5\n-$as_echo \"$ac_res\" >&6; }\n-  eval $as_lineno_stack; test \"x$as_lineno_stack\" = x && { as_lineno=; unset as_lineno;}\n-\n-} # ac_fn_c_check_member\n cat >config.log <<_ACEOF\n This file contains any messages produced by compilers while\n running configure, to aid debugging if configure makes a mistake.\n@@ -11651,7 +11594,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11654 \"configure\"\n+#line 11597 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -11757,7 +11700,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11760 \"configure\"\n+#line 11703 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -15443,7 +15386,7 @@ $as_echo \"$glibcxx_cv_atomic_long_long\" >&6; }\n   # Fake what AC_TRY_COMPILE does.\n \n     cat > conftest.$ac_ext << EOF\n-#line 15446 \"configure\"\n+#line 15389 \"configure\"\n int main()\n {\n   typedef bool atomic_type;\n@@ -15478,7 +15421,7 @@ $as_echo \"$glibcxx_cv_atomic_bool\" >&6; }\n     rm -f conftest*\n \n     cat > conftest.$ac_ext << EOF\n-#line 15481 \"configure\"\n+#line 15424 \"configure\"\n int main()\n {\n   typedef short atomic_type;\n@@ -15513,7 +15456,7 @@ $as_echo \"$glibcxx_cv_atomic_short\" >&6; }\n     rm -f conftest*\n \n     cat > conftest.$ac_ext << EOF\n-#line 15516 \"configure\"\n+#line 15459 \"configure\"\n int main()\n {\n   // NB: _Atomic_word not necessarily int.\n@@ -15549,7 +15492,7 @@ $as_echo \"$glibcxx_cv_atomic_int\" >&6; }\n     rm -f conftest*\n \n     cat > conftest.$ac_ext << EOF\n-#line 15552 \"configure\"\n+#line 15495 \"configure\"\n int main()\n {\n   typedef long long atomic_type;\n@@ -15628,7 +15571,7 @@ $as_echo \"$as_me: WARNING: Performance of certain classes will degrade as a resu\n   # unnecessary for this test.\n \n     cat > conftest.$ac_ext << EOF\n-#line 15631 \"configure\"\n+#line 15574 \"configure\"\n int main()\n {\n   _Decimal32 d1;\n@@ -15670,7 +15613,7 @@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n   # unnecessary for this test.\n \n     cat > conftest.$ac_ext << EOF\n-#line 15673 \"configure\"\n+#line 15616 \"configure\"\n template<typename T1, typename T2>\n   struct same\n   { typedef T2 type; };\n@@ -15704,7 +15647,7 @@ $as_echo \"$enable_int128\" >&6; }\n     rm -f conftest*\n \n     cat > conftest.$ac_ext << EOF\n-#line 15707 \"configure\"\n+#line 15650 \"configure\"\n template<typename T1, typename T2>\n   struct same\n   { typedef T2 type; };\n@@ -78852,201 +78795,6 @@ fi\n \n done\n \n-ac_header_dirent=no\n-for ac_hdr in dirent.h sys/ndir.h sys/dir.h ndir.h; do\n-  as_ac_Header=`$as_echo \"ac_cv_header_dirent_$ac_hdr\" | $as_tr_sh`\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking for $ac_hdr that defines DIR\" >&5\n-$as_echo_n \"checking for $ac_hdr that defines DIR... \" >&6; }\n-if { as_var=$as_ac_Header; eval \"test \\\"\\${$as_var+set}\\\" = set\"; }; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-#include <sys/types.h>\n-#include <$ac_hdr>\n-\n-int\n-main ()\n-{\n-if ((DIR *) 0)\n-return 0;\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-if ac_fn_c_try_compile \"$LINENO\"; then :\n-  eval \"$as_ac_Header=yes\"\n-else\n-  eval \"$as_ac_Header=no\"\n-fi\n-rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n-fi\n-eval ac_res=\\$$as_ac_Header\n-\t       { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_res\" >&5\n-$as_echo \"$ac_res\" >&6; }\n-eval as_val=\\$$as_ac_Header\n-   if test \"x$as_val\" = x\"\"yes; then :\n-  cat >>confdefs.h <<_ACEOF\n-#define `$as_echo \"HAVE_$ac_hdr\" | $as_tr_cpp` 1\n-_ACEOF\n-\n-ac_header_dirent=$ac_hdr; break\n-fi\n-\n-done\n-# Two versions of opendir et al. are in -ldir and -lx on SCO Xenix.\n-if test $ac_header_dirent = dirent.h; then\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for library containing opendir\" >&5\n-$as_echo_n \"checking for library containing opendir... \" >&6; }\n-if test \"${ac_cv_search_opendir+set}\" = set; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  ac_func_search_save_LIBS=$LIBS\n-cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-\n-/* Override any GCC internal prototype to avoid an error.\n-   Use char because int might match the return type of a GCC\n-   builtin and then its argument prototype would still apply.  */\n-#ifdef __cplusplus\n-extern \"C\"\n-#endif\n-char opendir ();\n-int\n-main ()\n-{\n-return opendir ();\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-for ac_lib in '' dir; do\n-  if test -z \"$ac_lib\"; then\n-    ac_res=\"none required\"\n-  else\n-    ac_res=-l$ac_lib\n-    LIBS=\"-l$ac_lib  $ac_func_search_save_LIBS\"\n-  fi\n-  if test x$gcc_no_link = xyes; then\n-  as_fn_error \"Link tests are not allowed after GCC_NO_EXECUTABLES.\" \"$LINENO\" 5\n-fi\n-if ac_fn_c_try_link \"$LINENO\"; then :\n-  ac_cv_search_opendir=$ac_res\n-fi\n-rm -f core conftest.err conftest.$ac_objext \\\n-    conftest$ac_exeext\n-  if test \"${ac_cv_search_opendir+set}\" = set; then :\n-  break\n-fi\n-done\n-if test \"${ac_cv_search_opendir+set}\" = set; then :\n-\n-else\n-  ac_cv_search_opendir=no\n-fi\n-rm conftest.$ac_ext\n-LIBS=$ac_func_search_save_LIBS\n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_opendir\" >&5\n-$as_echo \"$ac_cv_search_opendir\" >&6; }\n-ac_res=$ac_cv_search_opendir\n-if test \"$ac_res\" != no; then :\n-  test \"$ac_res\" = \"none required\" || LIBS=\"$ac_res $LIBS\"\n-\n-fi\n-\n-else\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for library containing opendir\" >&5\n-$as_echo_n \"checking for library containing opendir... \" >&6; }\n-if test \"${ac_cv_search_opendir+set}\" = set; then :\n-  $as_echo_n \"(cached) \" >&6\n-else\n-  ac_func_search_save_LIBS=$LIBS\n-cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n-/* end confdefs.h.  */\n-\n-/* Override any GCC internal prototype to avoid an error.\n-   Use char because int might match the return type of a GCC\n-   builtin and then its argument prototype would still apply.  */\n-#ifdef __cplusplus\n-extern \"C\"\n-#endif\n-char opendir ();\n-int\n-main ()\n-{\n-return opendir ();\n-  ;\n-  return 0;\n-}\n-_ACEOF\n-for ac_lib in '' x; do\n-  if test -z \"$ac_lib\"; then\n-    ac_res=\"none required\"\n-  else\n-    ac_res=-l$ac_lib\n-    LIBS=\"-l$ac_lib  $ac_func_search_save_LIBS\"\n-  fi\n-  if test x$gcc_no_link = xyes; then\n-  as_fn_error \"Link tests are not allowed after GCC_NO_EXECUTABLES.\" \"$LINENO\" 5\n-fi\n-if ac_fn_c_try_link \"$LINENO\"; then :\n-  ac_cv_search_opendir=$ac_res\n-fi\n-rm -f core conftest.err conftest.$ac_objext \\\n-    conftest$ac_exeext\n-  if test \"${ac_cv_search_opendir+set}\" = set; then :\n-  break\n-fi\n-done\n-if test \"${ac_cv_search_opendir+set}\" = set; then :\n-\n-else\n-  ac_cv_search_opendir=no\n-fi\n-rm conftest.$ac_ext\n-LIBS=$ac_func_search_save_LIBS\n-fi\n-{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ac_cv_search_opendir\" >&5\n-$as_echo \"$ac_cv_search_opendir\" >&6; }\n-ac_res=$ac_cv_search_opendir\n-if test \"$ac_res\" != no; then :\n-  test \"$ac_res\" = \"none required\" || LIBS=\"$ac_res $LIBS\"\n-\n-fi\n-\n-fi\n-\n-\n-\n-  ac_fn_c_check_member \"$LINENO\" \"struct dirent\" \"d_type\" \"ac_cv_member_struct_dirent_d_type\" \"\n-#include <sys/types.h>\n-#ifdef HAVE_DIRENT_H\n-# include <dirent.h>\n-#else\n-# define dirent direct\n-# ifdef HAVE_SYS_NDIR_H\n-#  include <sys/ndir.h>\n-# endif\n-# ifdef HAVE_SYS_DIR_H\n-#  include <sys/dir.h>\n-# endif\n-# ifdef HAVE_NDIR_H\n-#  include <ndir.h>\n-# endif\n-#endif\n-\n-\"\n-if test \"x$ac_cv_member_struct_dirent_d_type\" = x\"\"yes; then :\n-\n-cat >>confdefs.h <<_ACEOF\n-#define HAVE_STRUCT_DIRENT_D_TYPE 1\n-_ACEOF\n-\n-\n-fi\n-\n-\n \n    # Check whether --enable-libstdcxx-filesystem-ts was given.\n if test \"${enable_libstdcxx_filesystem_ts+set}\" = set; then :\n@@ -79096,6 +78844,68 @@ ac_compiler_gnu=$ac_cv_cxx_compiler_gnu\n \n   ac_save_CXXFLAGS=\"$CXXFLAGS\"\n   CXXFLAGS=\"$CXXFLAGS -fno-exceptions\"\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for struct dirent.d_type\" >&5\n+$as_echo_n \"checking for struct dirent.d_type... \" >&6; }\n+  if test \"${glibcxx_cv_dirent_d_type+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+      if test x$gcc_no_link = xyes; then\n+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <dirent.h>\n+int\n+main ()\n+{\n+\n+       struct dirent d;\n+       if (sizeof d.d_type) return 0;\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_cxx_try_compile \"$LINENO\"; then :\n+  glibcxx_cv_dirent_d_type=yes\n+else\n+  glibcxx_cv_dirent_d_type=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext\n+else\n+  if test x$gcc_no_link = xyes; then\n+  as_fn_error \"Link tests are not allowed after GCC_NO_EXECUTABLES.\" \"$LINENO\" 5\n+fi\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+#include <dirent.h>\n+int\n+main ()\n+{\n+\n+       struct dirent d;\n+       if (sizeof d.d_type) return 0;\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_cxx_try_link \"$LINENO\"; then :\n+  glibcxx_cv_dirent_d_type=yes\n+else\n+  glibcxx_cv_dirent_d_type=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+fi\n+\n+fi\n+\n+  if test $glibcxx_cv_dirent_d_type = yes; then\n+\n+$as_echo \"#define _GLIBCXX_HAVE_STRUCT_DIRENT_D_TYPE 1\" >>confdefs.h\n+\n+  fi\n+  { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $glibcxx_cv_dirent_d_type\" >&5\n+$as_echo \"$glibcxx_cv_dirent_d_type\" >&6; }\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for realpath\" >&5\n $as_echo_n \"checking for realpath... \" >&6; }\n   if test \"${glibcxx_cv_realpath+set}\" = set; then :"}, {"sha": "96ff16f3f3e01699646817febde22ca55087d08e", "filename": "libstdc++-v3/configure.ac", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b9fc9fee84ec9de6de8d95ee670bc121b298331/libstdc%2B%2B-v3%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfigure.ac?ref=0b9fc9fee84ec9de6de8d95ee670bc121b298331", "patch": "@@ -403,7 +403,6 @@ GLIBCXX_CHECK_GTHREADS\n \n # For Filesystem TS.\n AC_CHECK_HEADERS([fcntl.h dirent.h sys/statvfs.h utime.h])\n-AC_STRUCT_DIRENT_D_TYPE\n GLIBCXX_ENABLE_FILESYSTEM_TS\n GLIBCXX_CHECK_FILESYSTEM_DEPS\n "}]}