{"sha": "47b20d027ade5bfbd932724d0ea2aedee7421243", "node_id": "C_kwDOANBUbNoAKDQ3YjIwZDAyN2FkZTViZmJkOTMyNzI0ZDBlYTJhZWRlZTc0MjEyNDM", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-26T11:41:03Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-26T16:14:40Z"}, "message": "libstdc++: Add constexpr to std::counted_iterator post-increment (LWG 3643)\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/bits/stl_iterator.h (counted_iterator::operator++(int)):\n\tAdd 'constexpr' as per LWG 3643.\n\t* testsuite/24_iterators/counted_iterator/lwg3643.cc: New test.", "tree": {"sha": "4c0920e66d2be2518a491d04e28870cceaeca3a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4c0920e66d2be2518a491d04e28870cceaeca3a8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/47b20d027ade5bfbd932724d0ea2aedee7421243", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47b20d027ade5bfbd932724d0ea2aedee7421243", "html_url": "https://github.com/Rust-GCC/gccrs/commit/47b20d027ade5bfbd932724d0ea2aedee7421243", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/47b20d027ade5bfbd932724d0ea2aedee7421243/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "97dc78d705a90c1ae83c78a7f2e24942cc3a6257", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97dc78d705a90c1ae83c78a7f2e24942cc3a6257", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97dc78d705a90c1ae83c78a7f2e24942cc3a6257"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "12a89ab229f0e8e109f41628e16aedbbbd6a9887", "filename": "libstdc++-v3/include/bits/stl_iterator.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47b20d027ade5bfbd932724d0ea2aedee7421243/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47b20d027ade5bfbd932724d0ea2aedee7421243/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_iterator.h?ref=47b20d027ade5bfbd932724d0ea2aedee7421243", "patch": "@@ -2341,7 +2341,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \treturn *this;\n       }\n \n-      decltype(auto)\n+      constexpr decltype(auto)\n       operator++(int)\n       {\n \t__glibcxx_assert(_M_length > 0);\n@@ -2353,7 +2353,6 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t    ++_M_length;\n \t    __throw_exception_again;\n \t  }\n-\n       }\n \n       constexpr counted_iterator"}, {"sha": "e6f12b46c1238c8948761b9e26aec96eb660a7b1", "filename": "libstdc++-v3/testsuite/24_iterators/counted_iterator/lwg3643.cc", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/47b20d027ade5bfbd932724d0ea2aedee7421243/libstdc%2B%2B-v3%2Ftestsuite%2F24_iterators%2Fcounted_iterator%2Flwg3643.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/47b20d027ade5bfbd932724d0ea2aedee7421243/libstdc%2B%2B-v3%2Ftestsuite%2F24_iterators%2Fcounted_iterator%2Flwg3643.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F24_iterators%2Fcounted_iterator%2Flwg3643.cc?ref=47b20d027ade5bfbd932724d0ea2aedee7421243", "patch": "@@ -0,0 +1,27 @@\n+// { dg-options \"-std=gnu++20\" }\n+// { dg-do compile { target c++20 } }\n+\n+#include <iterator>\n+\n+struct InputIterator\n+{\n+  using difference_type = int;\n+  using value_type = int;\n+\n+  constexpr int operator*() const noexcept { return 0; }\n+  InputIterator& operator++() { return *this; }\n+  constexpr void operator++(int) { }\n+};\n+\n+static_assert( std::input_iterator<InputIterator> );\n+static_assert( !std::forward_iterator<InputIterator> );\n+\n+constexpr bool\n+test_lwg3643()\n+{\n+  std::counted_iterator<InputIterator> iter({}, 1);\n+  iter++;\n+  return iter == std::default_sentinel;\n+}\n+\n+static_assert( test_lwg3643() );"}]}