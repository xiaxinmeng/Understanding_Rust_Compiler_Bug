{"sha": "98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OThkNmU5YWZlYTk4YzgxYTBjYjNmYTllMWQ1NjIyZDQ3NGRkNTJlMQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2004-09-23T10:09:09Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2004-09-23T10:09:09Z"}, "message": "re PR c++/17620 (Bogus error with duplicate base class breaks boost)\n\ncp:\n\tPR c++/17620\n\t* decl.c (xref_basetypes): Look through typedefs before checking\n\tfor duplicate base.\ntestsuite:\n\tPR c++/17620\n\t* g++.dg/inherit/base2.C: New.\n\nFrom-SVN: r87938", "tree": {"sha": "9e32da01f4dd9f74821e87be2227b9646e5b67d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9e32da01f4dd9f74821e87be2227b9646e5b67d7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/comments", "author": null, "committer": null, "parents": [{"sha": "e5a067e81a6f05552064e2d1224c278724ba4ca6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5a067e81a6f05552064e2d1224c278724ba4ca6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e5a067e81a6f05552064e2d1224c278724ba4ca6"}], "stats": {"total": 45, "additions": 35, "deletions": 10}, "files": [{"sha": "2d22a5984a49bb18e654b8ac101d9cd7a718e989", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "patch": "@@ -1,3 +1,9 @@\n+2004-09-23  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/17620\n+\t* decl.c (xref_basetypes): Look through typedefs before checking\n+\tfor duplicate base.\n+\n 2004-09-22  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* cp-tree.h (unemitted_tinfo_decls): Make a VEC(tree)."}, {"sha": "30bfa8b6ef6a1bda4011fa342c2994d596b9261d", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 12, "deletions": 10, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "patch": "@@ -9286,16 +9286,6 @@ xref_basetypes (tree ref, tree base_list)\n \t  continue;\n \t}\n \n-      if (TYPE_MARKED_P (basetype))\n-\t{\n-\t  if (basetype == ref)\n-\t    error (\"recursive type `%T' undefined\", basetype);\n-\t  else\n-\t    error (\"duplicate base type `%T' invalid\", basetype);\n-\t  continue;\n-\t}\n-      TYPE_MARKED_P (basetype) = 1;\n-\n       if (TYPE_FOR_JAVA (basetype) && (current_lang_depth () == 0))\n \tTYPE_FOR_JAVA (ref) = 1;\n \n@@ -9318,6 +9308,18 @@ xref_basetypes (tree ref, tree base_list)\n \t  CLASSTYPE_REPEATED_BASE_P (ref)\n \t    |= CLASSTYPE_REPEATED_BASE_P (basetype);\n \t}\n+      \n+      /* We must do this test after we've seen through a typedef\n+\t type.  */\n+      if (TYPE_MARKED_P (basetype))\n+\t{\n+\t  if (basetype == ref)\n+\t    error (\"recursive type `%T' undefined\", basetype);\n+\t  else\n+\t    error (\"duplicate base type `%T' invalid\", basetype);\n+\t  continue;\n+\t}\n+      TYPE_MARKED_P (basetype) = 1;\n \n       base_binfo = copy_binfo (base_binfo, basetype, ref,\n \t\t\t       &igo_prev, via_virtual);"}, {"sha": "9f90b343cc622c4f4c6ceea2620878df1e7acc18", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "patch": "@@ -1,3 +1,8 @@\n+2004-09-23  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/17620\n+\t* g++.dg/inherit/base2.C: New.\n+\n 2004-09-22  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \t* gcc.dg/20001012-1.c: Add prototypes for builtin functions."}, {"sha": "5c7d812c760a086484ca7504556be0d937324d2f", "filename": "gcc/testsuite/g++.dg/inherit/base2.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fbase2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fbase2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fbase2.C?ref=98d6e9afea98c81a0cb3fa9e1d5622d474dd52e1", "patch": "@@ -0,0 +1,12 @@\n+// Copyright (C) 2004 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 23 Sep 2004 <nathan@codesourcery.com>\n+\n+// Origin: Wolfgang Bangerth <bangerth@dealii.org>\n+// Bug 17620. Bogus duplicate base error.\n+\n+struct S {}; \n+ \n+typedef S B; \n+ \n+struct D1 : B {}; \n+struct D2 : B {}; "}]}