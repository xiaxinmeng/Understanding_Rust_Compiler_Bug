{"sha": "bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmI2YTg1NmJhZjQ5NmExYjZmYjVlNmFhNDgxNzc2Y2RmMmEzOTllZg==", "commit": {"author": {"name": "Piotr Trojanek", "email": "trojanek@adacore.com", "date": "2018-07-31T09:55:37Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-07-31T09:55:37Z"}, "message": "[Ada] Replace low-level calls to Ekind with high-level calls to Is_Formal\n\nHigh-level wrappers are easier to read. This change came up while reading\nsome code related to GNATprove, but then uniformly applied to the entire\nfrontend. For the few remaining membership tests that could be replaced\nby Is_Formal it is not obvious whether the high-level routine makes the\ncode better.\n\n2018-07-31  Piotr Trojanek  <trojanek@adacore.com>\n\ngcc/ada/\n\n\t* exp_aggr.adb, exp_ch4.adb, exp_ch6.adb, lib-xref.adb,\n\trepinfo.adb, sem_ch9.adb: Minor replace Ekind membership tests\n\twith a wrapper routine.\n\nFrom-SVN: r263093", "tree": {"sha": "c36484de29bda5fc90c59d60ba55334e6d9f2e3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c36484de29bda5fc90c59d60ba55334e6d9f2e3e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/comments", "author": {"login": "ptroja", "id": 161602, "node_id": "MDQ6VXNlcjE2MTYwMg==", "avatar_url": "https://avatars.githubusercontent.com/u/161602?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ptroja", "html_url": "https://github.com/ptroja", "followers_url": "https://api.github.com/users/ptroja/followers", "following_url": "https://api.github.com/users/ptroja/following{/other_user}", "gists_url": "https://api.github.com/users/ptroja/gists{/gist_id}", "starred_url": "https://api.github.com/users/ptroja/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ptroja/subscriptions", "organizations_url": "https://api.github.com/users/ptroja/orgs", "repos_url": "https://api.github.com/users/ptroja/repos", "events_url": "https://api.github.com/users/ptroja/events{/privacy}", "received_events_url": "https://api.github.com/users/ptroja/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e8723e74410de463cdba50e31489f7803387c9bd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8723e74410de463cdba50e31489f7803387c9bd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8723e74410de463cdba50e31489f7803387c9bd"}], "stats": {"total": 20, "additions": 13, "deletions": 7}, "files": [{"sha": "861ea47fcb5b3d93f8b98c5f7db96325ef37fcdf", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "patch": "@@ -1,3 +1,9 @@\n+2018-07-31  Piotr Trojanek  <trojanek@adacore.com>\n+\n+\t* exp_aggr.adb, exp_ch4.adb, exp_ch6.adb, lib-xref.adb,\n+\trepinfo.adb, sem_ch9.adb: Minor replace Ekind membership tests\n+\twith a wrapper routine.\n+\n 2018-07-31  Piotr Trojanek  <trojanek@adacore.com>\n \n \t* ali.adb (Known_ALI_Lines): Remove 'F' as a prefix for lines"}, {"sha": "9d9ab6a63f0e232678fa92d75f0d8e1721efd977", "filename": "gcc/ada/exp_aggr.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fexp_aggr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fexp_aggr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_aggr.adb?ref=bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "patch": "@@ -7278,7 +7278,7 @@ package body Exp_Aggr is\n                 (Nkind (Expr_Q) = N_Type_Conversion\n                   or else\n                     (Is_Entity_Name (Expr_Q)\n-                      and then Ekind (Entity (Expr_Q)) in Formal_Kind))\n+                      and then Is_Formal (Entity (Expr_Q))))\n               and then Tagged_Type_Expansion\n             then\n                Static_Components := False;"}, {"sha": "b08cf37b6002e7f903d770568712b139c72c82d3", "filename": "gcc/ada/exp_ch4.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fexp_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fexp_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch4.adb?ref=bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "patch": "@@ -12547,7 +12547,7 @@ package body Exp_Ch4 is\n             Sel_Comp := Parent (Sel_Comp);\n          end loop;\n \n-         return Ekind (Entity (Prefix (Sel_Comp))) in Formal_Kind;\n+         return Is_Formal (Entity (Prefix (Sel_Comp)));\n       end Prefix_Is_Formal_Parameter;\n \n    --  Start of processing for Has_Inferable_Discriminants"}, {"sha": "2ac5db67d54ce0b7b5ec3627180ceabd117fc009", "filename": "gcc/ada/exp_ch6.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fexp_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fexp_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch6.adb?ref=bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "patch": "@@ -6799,7 +6799,7 @@ package body Exp_Ch6 is\n         and then (Nkind_In (Exp, N_Type_Conversion,\n                                  N_Unchecked_Type_Conversion)\n                     or else (Is_Entity_Name (Exp)\n-                               and then Ekind (Entity (Exp)) in Formal_Kind))\n+                               and then Is_Formal (Entity (Exp))))\n       then\n          --  When the return type is limited, perform a check that the tag of\n          --  the result is the same as the tag of the return type.\n@@ -6877,7 +6877,7 @@ package body Exp_Ch6 is\n             or else Nkind_In (Exp, N_Type_Conversion,\n                                    N_Unchecked_Type_Conversion)\n             or else (Is_Entity_Name (Exp)\n-                      and then Ekind (Entity (Exp)) in Formal_Kind)\n+                      and then Is_Formal (Entity (Exp)))\n             or else Scope_Depth (Enclosing_Dynamic_Scope (Etype (Exp))) >\n                       Scope_Depth (Enclosing_Dynamic_Scope (Scope_Id)))\n       then"}, {"sha": "b3ff4669f279ca4112abd93773f8d22a83e92c37", "filename": "gcc/ada/lib-xref.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Flib-xref.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Flib-xref.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flib-xref.adb?ref=bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "patch": "@@ -1034,7 +1034,7 @@ package body Lib.Xref is\n          --  parameters may end up being marked as not coming from source\n          --  although they are. Take these into account specially.\n \n-         elsif GNATprove_Mode and then Ekind (E) in Formal_Kind then\n+         elsif GNATprove_Mode and then Is_Formal (E) then\n             Ent := E;\n \n          --  Entity does not come from source, but is a derived subprogram and"}, {"sha": "b2bc9ca40d3fc9907cdce8ed220f2124c7673496", "filename": "gcc/ada/repinfo.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Frepinfo.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Frepinfo.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frepinfo.adb?ref=bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "patch": "@@ -428,7 +428,7 @@ package body Repinfo is\n \n                   List_Entities (E, Bytes_Big_Endian, True);\n \n-               elsif Ekind (E) in Formal_Kind and then In_Subprogram then\n+               elsif Is_Formal (E) and then In_Subprogram then\n                   null;\n \n                elsif Ekind_In (E, E_Entry,"}, {"sha": "09195560f483cd6f9d8659f65d6e718507beb35b", "filename": "gcc/ada/sem_ch9.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fsem_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6a856baf496a1b6fb5e6aa481776cdf2a399ef/gcc%2Fada%2Fsem_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch9.adb?ref=bb6a856baf496a1b6fb5e6aa481776cdf2a399ef", "patch": "@@ -2358,7 +2358,7 @@ package body Sem_Ch9 is\n          if Object_Access_Level (Target_Obj) >= Scope_Depth (Outer_Ent)\n            and then\n              (not Is_Entity_Name (Target_Obj)\n-               or else Ekind (Entity (Target_Obj)) not in Formal_Kind\n+               or else not Is_Formal (Entity (Target_Obj))\n                or else Enclosing /= Scope (Entity (Target_Obj)))\n          then\n             Error_Msg_N"}]}