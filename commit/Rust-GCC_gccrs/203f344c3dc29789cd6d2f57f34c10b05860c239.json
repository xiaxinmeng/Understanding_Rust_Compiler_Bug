{"sha": "203f344c3dc29789cd6d2f57f34c10b05860c239", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjAzZjM0NGMzZGMyOTc4OWNkNmQyZjU3ZjM0YzEwYjA1ODYwYzIzOQ==", "commit": {"author": {"name": "Bud Davis", "email": "bdavis9659@comcast.net", "date": "2004-11-27T23:35:47Z"}, "committer": {"name": "Bud Davis", "email": "bdavis@gcc.gnu.org", "date": "2004-11-27T23:35:47Z"}, "message": "re PR libfortran/18364 (endfile does not truncate file)\n\n\n2004-11-27  Bud Davis  <bdavis9659@comcast.net>\n\n        PR fortran/18364\n        * gfortran.dg/endfile.f90: New test.\n        *  io/endfile.c (st_endfile): flush the stream before truncating.\n\nFrom-SVN: r91400", "tree": {"sha": "65d480795eff18a7ac3db7791e5d0314e39c6456", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/65d480795eff18a7ac3db7791e5d0314e39c6456"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/203f344c3dc29789cd6d2f57f34c10b05860c239", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/203f344c3dc29789cd6d2f57f34c10b05860c239", "html_url": "https://github.com/Rust-GCC/gccrs/commit/203f344c3dc29789cd6d2f57f34c10b05860c239", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/203f344c3dc29789cd6d2f57f34c10b05860c239/comments", "author": null, "committer": null, "parents": [{"sha": "22e54023ca7fbcbe877b51687a9a6698640ee011", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22e54023ca7fbcbe877b51687a9a6698640ee011", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22e54023ca7fbcbe877b51687a9a6698640ee011"}], "stats": {"total": 42, "additions": 42, "deletions": 0}, "files": [{"sha": "f1dd94ccb04968aec8922cbc600f82e669588f61", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203f344c3dc29789cd6d2f57f34c10b05860c239/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203f344c3dc29789cd6d2f57f34c10b05860c239/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=203f344c3dc29789cd6d2f57f34c10b05860c239", "patch": "@@ -1,3 +1,8 @@\n+2004-11-27  Bud Davis  <bdavis9659@comcast.net>\n+\n+\tPR fortran/18364\n+\t* gfortran.dg/endfile.f90: New test.\n+\n 2004-11-27  Falk Hueffner  <falk@debian.org>\n \n \t* gcc.dg/loop-6.c: New test."}, {"sha": "1eabe9ffc7cbd70dd94f1924d1d56435c73bea65", "filename": "gcc/testsuite/gfortran.dg/endfile.f90", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203f344c3dc29789cd6d2f57f34c10b05860c239/gcc%2Ftestsuite%2Fgfortran.dg%2Fendfile.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203f344c3dc29789cd6d2f57f34c10b05860c239/gcc%2Ftestsuite%2Fgfortran.dg%2Fendfile.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fendfile.f90?ref=203f344c3dc29789cd6d2f57f34c10b05860c239", "patch": "@@ -0,0 +1,31 @@\n+! { dg-do run } \n+! pr18364 endfile does not truncate file.\n+!   write out 20 records\n+!   rewind\n+!   read 10 records\n+!   endfile\n+!   close file\n+!   open file\n+!   detect file has only 10 records  \n+      implicit none\n+      integer i,j\n+      open(unit=10,file='test.dat',access='sequential',status='replace')\n+      do i=1, 20\n+        write (10,'(I4)') i\n+      end do\n+      rewind(10)\n+      do i=1,10\n+        read (10,'(I4)') j\n+      end do\n+      endfile(10)\n+      close(10)\n+      open(unit=10,file='test.dat',access='sequential',status='old')\n+      do i=1,20 \n+        read (10,'(I4)',end=99) j \n+      end do\n+      ! should never get here\n+      call abort\n+  99  continue ! end of file\n+      if (j.ne.10) call abort   \n+      close(10,status='delete')\n+      end"}, {"sha": "a27c75d77d540c2af8ec7477913bd5b95cb869fb", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203f344c3dc29789cd6d2f57f34c10b05860c239/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203f344c3dc29789cd6d2f57f34c10b05860c239/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=203f344c3dc29789cd6d2f57f34c10b05860c239", "patch": "@@ -1,3 +1,8 @@\n+2004-11-27  Bud Davis  <bdavis9659@comcast.net>\n+\n+\tPR fortran/18364\n+\t*  io/endfile.c (st_endfile): flush the stream before truncating.\n+\n 2004-11-25  Kelley Cook  <kcook@gcc.gnu.org>\n \n \t* configure: Regenerate for libtool reversion."}, {"sha": "d8462a3faed566a246452caa5f47d4c98d5da0de", "filename": "libgfortran/io/endfile.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/203f344c3dc29789cd6d2f57f34c10b05860c239/libgfortran%2Fio%2Fendfile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/203f344c3dc29789cd6d2f57f34c10b05860c239/libgfortran%2Fio%2Fendfile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Fendfile.c?ref=203f344c3dc29789cd6d2f57f34c10b05860c239", "patch": "@@ -38,6 +38,7 @@ st_endfile (void)\n       if (u->current_record)\n \tnext_record (1);\n \n+      flush(u->s);\n       struncate (u->s);\n       u->endfile = AFTER_ENDFILE;\n     }"}]}