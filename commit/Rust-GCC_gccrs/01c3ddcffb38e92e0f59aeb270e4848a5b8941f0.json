{"sha": "01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDFjM2RkY2ZmYjM4ZTkyZTBmNTlhZWIyNzBlNDg0OGE1Yjg5NDFmMA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2019-02-26T14:09:19Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2019-02-26T14:09:19Z"}, "message": "re PR tree-optimization/89505 (LibreOffice miscompilation starting with r260383)\n\n2019-02-26  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/89505\n\t* tree-ssa-structalias.c (compute_dependence_clique): Make sure\n\tto handle restrict pointed-to vars with multiple subvars\n\tcorrectly.\n\n\t* gcc.dg/torture/pr89505.c: New testcase.\n\nFrom-SVN: r269212", "tree": {"sha": "8ddee9c1d54b069e4321c2f8d22abb607f4b4a61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ddee9c1d54b069e4321c2f8d22abb607f4b4a61"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "302fe7500a45d9dbe0cdb292f62d7dcbacff9b56", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/302fe7500a45d9dbe0cdb292f62d7dcbacff9b56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/302fe7500a45d9dbe0cdb292f62d7dcbacff9b56"}], "stats": {"total": 39, "additions": 38, "deletions": 1}, "files": [{"sha": "c4260affdf7fc2961a04564510e8659160c65443", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "patch": "@@ -1,3 +1,10 @@\n+2019-02-26  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/89505\n+\t* tree-ssa-structalias.c (compute_dependence_clique): Make sure\n+\tto handle restrict pointed-to vars with multiple subvars\n+\tcorrectly.\n+\n 2019-02-26  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/89489"}, {"sha": "3f76c4527643f6dd3804d0f09d8e18f8d077db4e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "patch": "@@ -1,3 +1,8 @@\n+2019-02-26  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/89505\n+\t* gcc.dg/torture/pr89505.c: New testcase.\n+\n 2019-02-26  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/opt77.adb: New test."}, {"sha": "6fca475ad9d6c4aebe78771b7a28dc7eebba7d10", "filename": "gcc/testsuite/gcc.dg/torture/pr89505.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr89505.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr89505.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr89505.c?ref=01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "patch": "@@ -0,0 +1,22 @@\n+/* { dg-do run } */\n+\n+struct S { int i; void *p; int j; };\n+int a;\n+int __attribute__((noinline))\n+foo (struct S * __restrict p, int q)\n+{\n+  int *x = &p->j;\n+  if (q)\n+    x = &a;\n+  p->j = 1;\n+  *x = 2;\n+  return p->j;\n+}\n+\n+int main()\n+{\n+  struct S s;\n+  if (foo (&s, 0) != 2)\n+    __builtin_abort ();\n+  return 0;\n+}"}, {"sha": "b92fcddfe9a6fb458530ba20a24f0373d3dce842", "filename": "gcc/tree-ssa-structalias.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2Ftree-ssa-structalias.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01c3ddcffb38e92e0f59aeb270e4848a5b8941f0/gcc%2Ftree-ssa-structalias.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-structalias.c?ref=01c3ddcffb38e92e0f59aeb270e4848a5b8941f0", "patch": "@@ -7613,7 +7613,10 @@ compute_dependence_clique (void)\n \t\t\t\t\t      maybe_set_dependence_info);\n \t  if (used)\n \t    {\n-\t      bitmap_set_bit (rvars, restrict_var->id);\n+\t      /* Add all subvars to the set of restrict pointed-to set. */\n+\t      for (unsigned sv = restrict_var->head; sv != 0;\n+\t\t   sv = get_varinfo (sv)->next)\n+\t\tbitmap_set_bit (rvars, sv);\n \t      varinfo_t escaped = get_varinfo (find (escaped_id));\n \t      if (bitmap_bit_p (escaped->solution, restrict_var->id))\n \t\tescaped_p = true;"}]}