{"sha": "62a7df9f59c014c272f4216aac02a301a0778fdf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjJhN2RmOWY1OWMwMTRjMjcyZjQyMTZhYWMwMmEzMDFhMDc3OGZkZg==", "commit": {"author": {"name": "Marc Glisse", "email": "glisse@gcc.gnu.org", "date": "2016-11-20T13:35:27Z"}, "committer": {"name": "Marc Glisse", "email": "glisse@gcc.gnu.org", "date": "2016-11-20T13:35:27Z"}, "message": "Protect __TMC_END__ - __TMC_LIST__ == 0\n\n2016-11-20  Marc Glisse  <marc.glisse@inria.fr>\n\n        PR libgcc/77813\n        * crtstuff.c (deregister_tm_clones, register_tm_clones): Hide\n        __TMC_END__ behind a passthrough asm.\n\nFrom-SVN: r242635", "tree": {"sha": "d8b6bcad314cbf811ad02d941e25efedb7a79b5f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8b6bcad314cbf811ad02d941e25efedb7a79b5f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/62a7df9f59c014c272f4216aac02a301a0778fdf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62a7df9f59c014c272f4216aac02a301a0778fdf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62a7df9f59c014c272f4216aac02a301a0778fdf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62a7df9f59c014c272f4216aac02a301a0778fdf/comments", "author": null, "committer": null, "parents": [{"sha": "0021284370b5d62bf8bc3f09435d5a176c18a033", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0021284370b5d62bf8bc3f09435d5a176c18a033", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0021284370b5d62bf8bc3f09435d5a176c18a033"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "90d7ee8d0795a8ab96c28eadbedf917f144d585f", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62a7df9f59c014c272f4216aac02a301a0778fdf/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62a7df9f59c014c272f4216aac02a301a0778fdf/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=62a7df9f59c014c272f4216aac02a301a0778fdf", "patch": "@@ -1,6 +1,12 @@\n+2016-11-20  Marc Glisse  <marc.glisse@inria.fr>\n+\n+\tPR libgcc/77813\n+\t* crtstuff.c (deregister_tm_clones, register_tm_clones): Hide\n+\t__TMC_END__ behind a passthrough asm.\n+\n 2016-11-18  Walter Lee  <walt@tilera.com>\n \n-        * config.host (tilepro*-*-linux*): Add t-slibgcc-libgcc to tmake_file.\n+\t* config.host (tilepro*-*-linux*): Add t-slibgcc-libgcc to tmake_file.\n \n 2016-11-17  Andrew Senkevich <andrew.senkevich@intel.com>\n "}, {"sha": "564418191d9698a694275d0f42c9ecbc07719d36", "filename": "libgcc/crtstuff.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62a7df9f59c014c272f4216aac02a301a0778fdf/libgcc%2Fcrtstuff.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62a7df9f59c014c272f4216aac02a301a0778fdf/libgcc%2Fcrtstuff.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fcrtstuff.c?ref=62a7df9f59c014c272f4216aac02a301a0778fdf", "patch": "@@ -280,7 +280,10 @@ deregister_tm_clones (void)\n   void (*fn) (void *);\n \n #ifdef HAVE_GAS_HIDDEN\n-  if (__TMC_END__ - __TMC_LIST__ == 0)\n+  func_ptr *end = __TMC_END__;\n+  // Do not optimize the comparison to false.\n+  __asm (\"\" : \"+g\" (end));\n+  if (__TMC_LIST__ == end)\n     return;\n #else\n   if (__TMC_LIST__[0] == NULL)\n@@ -300,7 +303,10 @@ register_tm_clones (void)\n   size_t size;\n \n #ifdef HAVE_GAS_HIDDEN\n-  size = (__TMC_END__ - __TMC_LIST__) / 2;\n+  func_ptr *end = __TMC_END__;\n+  // Do not optimize the comparison to false.\n+  __asm (\"\" : \"+g\" (end));\n+  size = (end - __TMC_LIST__) / 2;\n #else\n   for (size = 0; __TMC_LIST__[size * 2] != NULL; size++)\n     continue;"}]}