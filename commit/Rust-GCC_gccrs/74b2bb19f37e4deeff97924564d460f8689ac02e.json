{"sha": "74b2bb19f37e4deeff97924564d460f8689ac02e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzRiMmJiMTlmMzdlNGRlZWZmOTc5MjQ1NjRkNDYwZjg2ODlhYzAyZQ==", "commit": {"author": {"name": "Olga Makhotina", "email": "olga.makhotina@intel.com", "date": "2018-05-17T08:13:23Z"}, "committer": {"name": "Sebastian Peryt", "email": "speryt@gcc.gnu.org", "date": "2018-05-17T08:13:23Z"}, "message": "config.gcc: Support \"goldmont-plus\".\n\n2018-05-17  Olga Makhotina  <olga.makhotina@intel.com>\n\ngcc/\n\n\t* config.gcc: Support \"goldmont-plus\".\n\t* config/i386/driver-i386.c (host_detect_local_cpu): Detect\n\t\"goldmont-plus\".\n\t* config/i386/i386-c.c (ix86_target_macros_internal): Handle\n\tPROCESSOR_GOLDMONT_PLUS.\n\t* config/i386/i386.c (m_GOLDMONT_PLUS): Define.\n\t(processor_target_table): Add \"goldmont-plus\".\n\t(PTA_GOLDMONT_PLUS): Define.\n\t(ix86_lea_outperforms): Add TARGET_GOLDMONT_PLUS.\n\t(get_builtin_code_for_version): Handle PROCESSOR_GOLDMONT_PLUS.\n\t(fold_builtin_cpu): Add M_INTEL_GOLDMONT_PLUS.\n\t(fold_builtin_cpu): Add \"goldmont-plus\".\n\t(ix86_add_stmt_cost): Add TARGET_GOLDMONT_PLUS.\n\t(ix86_option_override_internal): Add \"goldmont-plus\".\n\t* config/i386/i386.h (processor_costs): Define TARGET_GOLDMONT_PLUS.\n\t(processor_type): Add PROCESSOR_GOLDMONT_PLUS.\n\t* config/i386/x86-tune.def: Add m_GOLDMONT_PLUS.\n\t* doc/invoke.texi: Add goldmont-plus as x86 -march=/-mtune= CPU type.\n\nlibgcc/\n\n\t* config/i386/cpuinfo.h (processor_types): Add INTEL_GOLDMONT_PLUS.\n\t* config/i386/cpuinfo.c (get_intel_cpu): Detect Goldmont Plus.\n\ngcc/testsuite/\n\n\t* gcc.target/i386/builtin_target.c: Test goldmont-plus.\n\t* gcc.target/i386/funcspec-56.inc: Test arch=goldmont-plus.\n\nFrom-SVN: r260307", "tree": {"sha": "65ce957b05401f2ee423fc5a5677343174466dc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/65ce957b05401f2ee423fc5a5677343174466dc5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/74b2bb19f37e4deeff97924564d460f8689ac02e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74b2bb19f37e4deeff97924564d460f8689ac02e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/74b2bb19f37e4deeff97924564d460f8689ac02e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74b2bb19f37e4deeff97924564d460f8689ac02e/comments", "author": {"login": "Djilka", "id": 6038217, "node_id": "MDQ6VXNlcjYwMzgyMTc=", "avatar_url": "https://avatars.githubusercontent.com/u/6038217?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Djilka", "html_url": "https://github.com/Djilka", "followers_url": "https://api.github.com/users/Djilka/followers", "following_url": "https://api.github.com/users/Djilka/following{/other_user}", "gists_url": "https://api.github.com/users/Djilka/gists{/gist_id}", "starred_url": "https://api.github.com/users/Djilka/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Djilka/subscriptions", "organizations_url": "https://api.github.com/users/Djilka/orgs", "repos_url": "https://api.github.com/users/Djilka/repos", "events_url": "https://api.github.com/users/Djilka/events{/privacy}", "received_events_url": "https://api.github.com/users/Djilka/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "773d0331f7456614f9f7e619e642946d9bdc638a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/773d0331f7456614f9f7e619e642946d9bdc638a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/773d0331f7456614f9f7e619e642946d9bdc638a"}], "stats": {"total": 143, "additions": 112, "deletions": 31}, "files": [{"sha": "c434149ea37cb8aaa43eb806b8cbd1fe2ace63ac", "filename": "gcc/ChangeLog", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -1,3 +1,24 @@\n+2018-05-17  Olga Makhotina  <olga.makhotina@intel.com>\n+\n+\t* config.gcc: Support \"goldmont-plus\".\n+\t* config/i386/driver-i386.c (host_detect_local_cpu): Detect\n+\t\"goldmont-plus\".\n+\t* config/i386/i386-c.c (ix86_target_macros_internal): Handle\n+\tPROCESSOR_GOLDMONT_PLUS.\n+\t* config/i386/i386.c (m_GOLDMONT_PLUS): Define.\n+\t(processor_target_table): Add \"goldmont-plus\".\n+\t(PTA_GOLDMONT_PLUS): Define.\n+\t(ix86_lea_outperforms): Add TARGET_GOLDMONT_PLUS.\n+\t(get_builtin_code_for_version): Handle PROCESSOR_GOLDMONT_PLUS.\n+\t(fold_builtin_cpu): Add M_INTEL_GOLDMONT_PLUS.\n+\t(fold_builtin_cpu): Add \"goldmont-plus\".\n+\t(ix86_add_stmt_cost): Add TARGET_GOLDMONT_PLUS.\n+\t(ix86_option_override_internal): Add \"goldmont-plus\".\n+\t* config/i386/i386.h (processor_costs): Define TARGET_GOLDMONT_PLUS.\n+\t(processor_type): Add PROCESSOR_GOLDMONT_PLUS.\n+\t* config/i386/x86-tune.def: Add m_GOLDMONT_PLUS.\n+\t* doc/invoke.texi: Add goldmont-plus as x86 -march=/-mtune= CPU type.\n+\n 2018-05-17  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/85757"}, {"sha": "8edd0cdbaed18d52bb1b82e995291edba74be362", "filename": "gcc/config.gcc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -640,7 +640,7 @@ bdver3 bdver4 znver1 btver1 btver2 k8 k8-sse3 opteron opteron-sse3 nocona \\\n core2 corei7 corei7-avx core-avx-i core-avx2 atom slm nehalem westmere \\\n sandybridge ivybridge haswell broadwell bonnell silvermont knl knm \\\n skylake-avx512 cannonlake icelake-client icelake-server skylake goldmont \\\n-x86-64 native\"\n+goldmont-plus x86-64 native\"\n \n # Additional x86 processors supported by --with-cpu=.  Each processor\n # MUST be separated by exactly one space."}, {"sha": "c0f90adf4f951aba78270140909e913f56d06b83", "filename": "gcc/config/i386/driver-i386.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fdriver-i386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fdriver-i386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fdriver-i386.c?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -764,6 +764,10 @@ const char *host_detect_local_cpu (int argc, const char **argv)\n \t  /* Goldmont.  */\n \t  cpu = \"goldmont\";\n \t  break;\n+\tcase 0x7a:\n+\t  /* Goldmont Plus.  */\n+\t  cpu = \"goldmont-plus\";\n+\t  break;\n \tcase 0x0f:\n \t  /* Merom.  */\n \tcase 0x17:\n@@ -868,7 +872,10 @@ const char *host_detect_local_cpu (int argc, const char **argv)\n \t\tcpu = \"sandybridge\";\n \t      else if (has_sse4_2)\n \t\t{\n-\t\t  if (has_xsave)\n+\t\t  if (has_sgx)\n+\t\t    /* Assume Goldmont Plus.  */\n+\t\t    cpu = \"goldmont-plus\";\n+\t\t  else if (has_xsave)\n \t\t    /* Assume Goldmont.  */\n \t\t    cpu = \"goldmont\";\n \t\t  else if (has_movbe)"}, {"sha": "25bd924b6e9eea8df36993c43bc0655daa2dd9d7", "filename": "gcc/config/i386/i386-c.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fi386-c.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fi386-c.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386-c.c?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -178,6 +178,10 @@ ix86_target_macros_internal (HOST_WIDE_INT isa_flag,\n       def_or_undef (parse_in, \"__goldmont\");\n       def_or_undef (parse_in, \"__goldmont__\");\n       break;\n+    case PROCESSOR_GOLDMONT_PLUS:\n+      def_or_undef (parse_in, \"__goldmont_plus\");\n+      def_or_undef (parse_in, \"__goldmont_plus__\");\n+      break;\n     case PROCESSOR_KNL:\n       def_or_undef (parse_in, \"__knl\");\n       def_or_undef (parse_in, \"__knl__\");\n@@ -318,6 +322,9 @@ ix86_target_macros_internal (HOST_WIDE_INT isa_flag,\n     case PROCESSOR_GOLDMONT:\n       def_or_undef (parse_in, \"__tune_goldmont__\");\n       break;\n+    case PROCESSOR_GOLDMONT_PLUS:\n+      def_or_undef (parse_in, \"__tune_goldmont_plus__\");\n+      break;\n     case PROCESSOR_KNL:\n       def_or_undef (parse_in, \"__tune_knl__\");\n       break;"}, {"sha": "0c7a6b7d98fe5e73f6808e288fd3f39667f16109", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 17, "deletions": 5, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -150,6 +150,7 @@ const struct processor_costs *ix86_cost = NULL;\n #define m_ICELAKE_CLIENT (HOST_WIDE_INT_1U<<PROCESSOR_ICELAKE_CLIENT)\n #define m_ICELAKE_SERVER (HOST_WIDE_INT_1U<<PROCESSOR_ICELAKE_SERVER)\n #define m_GOLDMONT (HOST_WIDE_INT_1U<<PROCESSOR_GOLDMONT)\n+#define m_GOLDMONT_PLUS (HOST_WIDE_INT_1U<<PROCESSOR_GOLDMONT_PLUS)\n #define m_INTEL (HOST_WIDE_INT_1U<<PROCESSOR_INTEL)\n \n #define m_GEODE (HOST_WIDE_INT_1U<<PROCESSOR_GEODE)\n@@ -860,6 +861,7 @@ static const struct ptt processor_target_table[PROCESSOR_max] =\n   {\"bonnell\", &atom_cost, 16, 15, 16, 7, 16},\n   {\"silvermont\", &slm_cost, 16, 15, 16, 7, 16},\n   {\"goldmont\", &slm_cost, 16, 15, 16, 7, 16},\n+  {\"goldmont-plus\", &slm_cost, 16, 15, 16, 7, 16},\n   {\"knl\", &slm_cost, 16, 15, 16, 7, 16},\n   {\"knm\", &slm_cost, 16, 15, 16, 7, 16},\n   {\"skylake\", &skylake_cost, 16, 10, 16, 10, 16},\n@@ -3492,6 +3494,8 @@ ix86_option_override_internal (bool main_args_p,\n   const wide_int_bitmask PTA_GOLDMONT = PTA_SILVERMONT | PTA_SHA | PTA_XSAVE\n     | PTA_RDSEED | PTA_XSAVEC | PTA_XSAVES | PTA_CLFLUSHOPT | PTA_XSAVEOPT\n     | PTA_FSGSBASE;\n+  const wide_int_bitmask PTA_GOLDMONT_PLUS = PTA_GOLDMONT | PTA_RDPID\n+    | PTA_SGX;\n   const wide_int_bitmask PTA_KNM = PTA_KNL | PTA_AVX5124VNNIW\n     | PTA_AVX5124FMAPS | PTA_AVX512VPOPCNTDQ;\n \n@@ -3568,6 +3572,7 @@ ix86_option_override_internal (bool main_args_p,\n       {\"silvermont\", PROCESSOR_SILVERMONT, CPU_SLM, PTA_SILVERMONT},\n       {\"slm\", PROCESSOR_SILVERMONT, CPU_SLM, PTA_SILVERMONT},\n       {\"goldmont\", PROCESSOR_GOLDMONT, CPU_GLM, PTA_GOLDMONT},\n+      {\"goldmont-plus\", PROCESSOR_GOLDMONT_PLUS, CPU_GLM, PTA_GOLDMONT_PLUS},\n       {\"knl\", PROCESSOR_KNL, CPU_SLM, PTA_KNL},\n       {\"knm\", PROCESSOR_KNM, CPU_SLM, PTA_KNM},\n       {\"intel\", PROCESSOR_INTEL, CPU_SLM, PTA_NEHALEM},\n@@ -21244,7 +21249,8 @@ ix86_lea_outperforms (rtx_insn *insn, unsigned int regno0, unsigned int regno1,\n   /* For Silvermont if using a 2-source or 3-source LEA for\n      non-destructive destination purposes, or due to wanting\n      ability to use SCALE, the use of LEA is justified.  */\n-  if (TARGET_SILVERMONT || TARGET_GOLDMONT || TARGET_INTEL)\n+  if (TARGET_SILVERMONT || TARGET_GOLDMONT || TARGET_GOLDMONT_PLUS\n+      || TARGET_INTEL)\n     {\n       if (has_scale)\n \treturn true;\n@@ -32419,10 +32425,14 @@ get_builtin_code_for_version (tree decl, tree *predicate_list)\n \t      arg_str = \"silvermont\";\n \t      priority = P_PROC_SSE4_2;\n \t      break;\n-\t   case PROCESSOR_GOLDMONT:\n+\t    case PROCESSOR_GOLDMONT:\n \t      arg_str = \"goldmont\";\n \t      priority = P_PROC_SSE4_2;\n \t      break;\n+\t    case PROCESSOR_GOLDMONT_PLUS:\n+\t      arg_str = \"goldmont-plus\";\n+\t      priority = P_PROC_SSE4_2;\n+\t      break;\n \t    case PROCESSOR_AMDFAM10:\n \t      arg_str = \"amdfam10h\";\n \t      priority = P_PROC_SSE4_A;\n@@ -33128,7 +33138,8 @@ fold_builtin_cpu (tree fndecl, tree *args)\n     M_INTEL_COREI7_CANNONLAKE,\n     M_INTEL_COREI7_ICELAKE_CLIENT,\n     M_INTEL_COREI7_ICELAKE_SERVER,\n-    M_INTEL_GOLDMONT\n+    M_INTEL_GOLDMONT,\n+    M_INTEL_GOLDMONT_PLUS\n   };\n \n   static struct _arch_names_table\n@@ -33158,6 +33169,7 @@ fold_builtin_cpu (tree fndecl, tree *args)\n       {\"bonnell\", M_INTEL_BONNELL},\n       {\"silvermont\", M_INTEL_SILVERMONT},\n       {\"goldmont\", M_INTEL_GOLDMONT},\n+      {\"goldmont-plus\", M_INTEL_GOLDMONT_PLUS},\n       {\"knl\", M_INTEL_KNL},\n       {\"knm\", M_INTEL_KNM},\n       {\"amdfam10h\", M_AMDFAM10H},\n@@ -50757,8 +50769,8 @@ ix86_add_stmt_cost (void *data, int count, enum vect_cost_for_stmt kind,\n   /* We need to multiply all vector stmt cost by 1.7 (estimated cost)\n      for Silvermont as it has out of order integer pipeline and can execute\n      2 scalar instruction per tick, but has in order SIMD pipeline.  */\n-  if ((TARGET_SILVERMONT || TARGET_GOLDMONT || TARGET_INTEL)\n-      && stmt_info && stmt_info->stmt)\n+  if ((TARGET_SILVERMONT || TARGET_GOLDMONT || TARGET_GOLDMONT_PLUS\n+       || TARGET_INTEL) && stmt_info && stmt_info->stmt)\n     {\n       tree lhs_op = gimple_get_lhs (stmt_info->stmt);\n       if (lhs_op && TREE_CODE (TREE_TYPE (lhs_op)) == INTEGER_TYPE)"}, {"sha": "6ee99d3620772bf24e9c39c1db9e2e6f00174707", "filename": "gcc/config/i386/i386.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fi386.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fi386.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.h?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -390,6 +390,7 @@ extern const struct processor_costs ix86_size_cost;\n #define TARGET_BONNELL (ix86_tune == PROCESSOR_BONNELL)\n #define TARGET_SILVERMONT (ix86_tune == PROCESSOR_SILVERMONT)\n #define TARGET_GOLDMONT (ix86_tune == PROCESSOR_GOLDMONT)\n+#define TARGET_GOLDMONT_PLUS (ix86_tune == PROCESSOR_GOLDMONT_PLUS)\n #define TARGET_KNL (ix86_tune == PROCESSOR_KNL)\n #define TARGET_KNM (ix86_tune == PROCESSOR_KNM)\n #define TARGET_SKYLAKE (ix86_tune == PROCESSOR_SKYLAKE)\n@@ -2285,6 +2286,7 @@ enum processor_type\n   PROCESSOR_BONNELL,\n   PROCESSOR_SILVERMONT,\n   PROCESSOR_GOLDMONT,\n+  PROCESSOR_GOLDMONT_PLUS,\n   PROCESSOR_KNL,\n   PROCESSOR_KNM,\n   PROCESSOR_SKYLAKE,"}, {"sha": "77d99340ebe5c75a4bf993de59330689c67125dc", "filename": "gcc/config/i386/x86-tune.def", "status": "modified", "additions": 31, "deletions": 24, "changes": 55, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fx86-tune.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fconfig%2Fi386%2Fx86-tune.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fx86-tune.def?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -42,15 +42,15 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n DEF_TUNE (X86_TUNE_SCHEDULE, \"schedule\",\n           m_PENT | m_LAKEMONT | m_PPRO | m_CORE_ALL | m_BONNELL | m_SILVERMONT\n \t  | m_INTEL | m_KNL | m_KNM | m_K6_GEODE | m_AMD_MULTIPLE | m_GOLDMONT\n-\t  | m_GENERIC)\n+\t  | m_GOLDMONT_PLUS | m_GENERIC)\n \n /* X86_TUNE_PARTIAL_REG_DEPENDENCY: Enable more register renaming\n    on modern chips.  Preffer stores affecting whole integer register\n    over partial stores.  For example preffer MOVZBL or MOVQ to load 8bit\n    value over movb.  */\n DEF_TUNE (X86_TUNE_PARTIAL_REG_DEPENDENCY, \"partial_reg_dependency\",\n           m_P4_NOCONA | m_CORE2 | m_NEHALEM  | m_SANDYBRIDGE\n-\t  | m_BONNELL | m_SILVERMONT | m_GOLDMONT | m_INTEL\n+\t  | m_BONNELL | m_SILVERMONT | m_GOLDMONT | m_GOLDMONT_PLUS | m_INTEL\n \t  | m_KNL | m_KNM | m_AMD_MULTIPLE | m_SKYLAKE_AVX512 | m_GENERIC)\n \n /* X86_TUNE_SSE_PARTIAL_REG_DEPENDENCY: This knob promotes all store\n@@ -86,13 +86,15 @@ DEF_TUNE (X86_TUNE_PARTIAL_FLAG_REG_STALL, \"partial_flag_reg_stall\",\n DEF_TUNE (X86_TUNE_MOVX, \"movx\",\n           m_PPRO | m_P4_NOCONA | m_CORE2 | m_NEHALEM  | m_SANDYBRIDGE\n \t  | m_BONNELL | m_SILVERMONT | m_GOLDMONT | m_KNL | m_KNM | m_INTEL\n-\t  | m_GEODE | m_AMD_MULTIPLE | m_SKYLAKE_AVX512 | m_GENERIC)\n+\t  | m_GOLDMONT_PLUS | m_GEODE | m_AMD_MULTIPLE | m_SKYLAKE_AVX512\n+\t  | m_GENERIC)\n \n /* X86_TUNE_MEMORY_MISMATCH_STALL: Avoid partial stores that are followed by\n    full sized loads.  */\n DEF_TUNE (X86_TUNE_MEMORY_MISMATCH_STALL, \"memory_mismatch_stall\",\n           m_P4_NOCONA | m_CORE_ALL | m_BONNELL | m_SILVERMONT | m_INTEL\n-\t  | m_KNL | m_KNM | m_GOLDMONT | m_AMD_MULTIPLE | m_GENERIC)\n+\t  | m_KNL | m_KNM | m_GOLDMONT | m_GOLDMONT_PLUS | m_AMD_MULTIPLE\n+\t  | m_GENERIC)\n \n /* X86_TUNE_FUSE_CMP_AND_BRANCH_32: Fuse compare with a subsequent\n    conditional jump instruction for 32 bit TARGET.  */\n@@ -131,7 +133,7 @@ DEF_TUNE (X86_TUNE_FUSE_ALU_AND_BRANCH, \"fuse_alu_and_branch\",\n \n DEF_TUNE (X86_TUNE_ACCUMULATE_OUTGOING_ARGS, \"accumulate_outgoing_args\",\n \t  m_PPRO | m_P4_NOCONA | m_BONNELL | m_SILVERMONT | m_KNL | m_KNM | m_INTEL\n-\t  | m_GOLDMONT | m_ATHLON_K8)\n+\t  | m_GOLDMONT | m_GOLDMONT_PLUS | m_ATHLON_K8)\n \n /* X86_TUNE_PROLOGUE_USING_MOVE: Do not use push/pop in prologues that are\n    considered on critical path.  */\n@@ -193,7 +195,7 @@ DEF_TUNE (X86_TUNE_PAD_RETURNS, \"pad_returns\",\n    than 4 branch instructions in the 16 byte window.  */\n DEF_TUNE (X86_TUNE_FOUR_JUMP_LIMIT, \"four_jump_limit\",\n           m_PPRO | m_P4_NOCONA | m_BONNELL | m_SILVERMONT | m_KNL | m_KNM\n-\t  | m_GOLDMONT | m_INTEL | m_ATHLON_K8 | m_AMDFAM10)\n+\t  | m_GOLDMONT | m_GOLDMONT_PLUS | m_INTEL | m_ATHLON_K8 | m_AMDFAM10)\n \n /*****************************************************************************/\n /* Integer instruction selection tuning                                      */\n@@ -222,23 +224,24 @@ DEF_TUNE (X86_TUNE_READ_MODIFY, \"read_modify\", ~(m_PENT | m_LAKEMONT | m_PPRO))\n DEF_TUNE (X86_TUNE_USE_INCDEC, \"use_incdec\",\n           ~(m_P4_NOCONA | m_CORE2 | m_NEHALEM  | m_SANDYBRIDGE\n \t    | m_BONNELL | m_SILVERMONT | m_INTEL |  m_KNL | m_KNM | m_GOLDMONT\n-\t    | m_GENERIC))\n+\t    | m_GOLDMONT_PLUS | m_GENERIC))\n \n /* X86_TUNE_INTEGER_DFMODE_MOVES: Enable if integer moves are preferred\n    for DFmode copies */\n DEF_TUNE (X86_TUNE_INTEGER_DFMODE_MOVES, \"integer_dfmode_moves\",\n           ~(m_PPRO | m_P4_NOCONA | m_CORE_ALL | m_BONNELL | m_SILVERMONT\n \t    | m_KNL | m_KNM | m_INTEL | m_GEODE | m_AMD_MULTIPLE | m_GOLDMONT\n-\t    | m_GENERIC))\n+\t    | m_GOLDMONT_PLUS | m_GENERIC))\n \n /* X86_TUNE_OPT_AGU: Optimize for Address Generation Unit. This flag\n    will impact LEA instruction selection. */\n DEF_TUNE (X86_TUNE_OPT_AGU, \"opt_agu\", m_BONNELL | m_SILVERMONT | m_KNL\n-\t | m_KNM | m_GOLDMONT | m_INTEL)\n+\t | m_KNM | m_GOLDMONT | m_GOLDMONT_PLUS | m_INTEL)\n \n /* X86_TUNE_AVOID_LEA_FOR_ADDR: Avoid lea for address computation.  */\n DEF_TUNE (X86_TUNE_AVOID_LEA_FOR_ADDR, \"avoid_lea_for_addr\",\n-\t  m_BONNELL | m_SILVERMONT | m_GOLDMONT | m_KNL | m_KNM)\n+\t  m_BONNELL | m_SILVERMONT | m_GOLDMONT | m_GOLDMONT_PLUS | m_KNL\n+\t  | m_KNM)\n \n /* X86_TUNE_SLOW_IMUL_IMM32_MEM: Imul of 32-bit constant and memory is\n    vector path on AMD machines.\n@@ -255,7 +258,8 @@ DEF_TUNE (X86_TUNE_SLOW_IMUL_IMM8, \"slow_imul_imm8\",\n /* X86_TUNE_AVOID_MEM_OPND_FOR_CMOVE: Try to avoid memory operands for\n    a conditional move.  */\n DEF_TUNE (X86_TUNE_AVOID_MEM_OPND_FOR_CMOVE, \"avoid_mem_opnd_for_cmove\",\n-\t  m_BONNELL | m_SILVERMONT | m_GOLDMONT | m_KNL | m_KNM | m_INTEL)\n+\t  m_BONNELL | m_SILVERMONT | m_GOLDMONT | m_GOLDMONT_PLUS | m_KNL\n+\t  | m_KNM | m_INTEL)\n \n /* X86_TUNE_SINGLE_STRINGOP: Enable use of single string operations, such\n    as MOVS and STOS (without a REP prefix) to move/set sequences of bytes.  */\n@@ -274,17 +278,18 @@ DEF_TUNE (X86_TUNE_MISALIGNED_MOVE_STRING_PRO_EPILOGUES,\n DEF_TUNE (X86_TUNE_USE_SAHF, \"use_sahf\",\n           m_PPRO | m_P4_NOCONA | m_CORE_ALL | m_BONNELL | m_SILVERMONT\n \t  | m_KNL | m_KNM | m_INTEL | m_K6_GEODE | m_K8 | m_AMDFAM10 | m_BDVER\n-\t  | m_BTVER | m_ZNVER1 | m_GOLDMONT | m_GENERIC)\n+\t  | m_BTVER | m_ZNVER1 | m_GOLDMONT | m_GOLDMONT_PLUS | m_GENERIC)\n \n /* X86_TUNE_USE_CLTD: Controls use of CLTD and CTQO instructions.  */\n DEF_TUNE (X86_TUNE_USE_CLTD, \"use_cltd\",\n \t  ~(m_PENT | m_LAKEMONT | m_BONNELL | m_SILVERMONT | m_KNL | m_KNM | m_INTEL\n-\t    | m_K6 | m_GOLDMONT))\n+\t    | m_K6 | m_GOLDMONT | m_GOLDMONT_PLUS))\n \n /* X86_TUNE_USE_BT: Enable use of BT (bit test) instructions.  */\n DEF_TUNE (X86_TUNE_USE_BT, \"use_bt\",\n           m_CORE_ALL | m_BONNELL | m_SILVERMONT | m_KNL | m_KNM | m_INTEL\n-\t  | m_LAKEMONT | m_AMD_MULTIPLE | m_GOLDMONT | m_GENERIC)\n+\t  | m_LAKEMONT | m_AMD_MULTIPLE | m_GOLDMONT | m_GOLDMONT_PLUS\n+\t  | m_GENERIC)\n \n /* X86_TUNE_AVOID_FALSE_DEP_FOR_BMI: Avoid false dependency\n    for bit-manipulation instructions.  */\n@@ -301,7 +306,7 @@ DEF_TUNE (X86_TUNE_ADJUST_UNROLL, \"adjust_unroll_factor\", m_BDVER3 | m_BDVER4)\n    if-converted sequence to one.  */\n DEF_TUNE (X86_TUNE_ONE_IF_CONV_INSN, \"one_if_conv_insn\",\n \t  m_SILVERMONT | m_KNL | m_KNM | m_INTEL | m_CORE_ALL | m_GOLDMONT\n-\t  | m_GENERIC)\n+\t  | m_GOLDMONT_PLUS | m_GENERIC)\n \n /*****************************************************************************/\n /* 387 instruction selection tuning                                          */\n@@ -318,7 +323,7 @@ DEF_TUNE (X86_TUNE_USE_HIMODE_FIOP, \"use_himode_fiop\",\n DEF_TUNE (X86_TUNE_USE_SIMODE_FIOP, \"use_simode_fiop\",\n           ~(m_PENT | m_LAKEMONT | m_PPRO | m_CORE_ALL | m_BONNELL\n \t    | m_SILVERMONT | m_KNL | m_KNM | m_INTEL | m_AMD_MULTIPLE\n-\t    | m_GOLDMONT | m_GENERIC))\n+\t    | m_GOLDMONT | m_GOLDMONT_PLUS | m_GENERIC))\n \n /* X86_TUNE_USE_FFREEP: Use freep instruction instead of fstp.  */\n DEF_TUNE (X86_TUNE_USE_FFREEP, \"use_ffreep\", m_AMD_MULTIPLE)\n@@ -327,7 +332,7 @@ DEF_TUNE (X86_TUNE_USE_FFREEP, \"use_ffreep\", m_AMD_MULTIPLE)\n DEF_TUNE (X86_TUNE_EXT_80387_CONSTANTS, \"ext_80387_constants\",\n           m_PPRO | m_P4_NOCONA | m_CORE_ALL | m_BONNELL | m_SILVERMONT\n \t  | m_KNL | m_KNM | m_INTEL | m_K6_GEODE | m_ATHLON_K8 | m_GOLDMONT\n-\t  | m_GENERIC)\n+\t  | m_GOLDMONT_PLUS | m_GENERIC)\n \n /*****************************************************************************/\n /* SSE instruction selection tuning                                          */\n@@ -342,15 +347,15 @@ DEF_TUNE (X86_TUNE_GENERAL_REGS_SSE_SPILL, \"general_regs_sse_spill\",\n    of a sequence loading registers by parts.  */\n DEF_TUNE (X86_TUNE_SSE_UNALIGNED_LOAD_OPTIMAL, \"sse_unaligned_load_optimal\",\n \t  m_NEHALEM | m_SANDYBRIDGE | m_HASWELL | m_SILVERMONT | m_KNL | m_KNM\n-\t  | m_INTEL | m_SKYLAKE_AVX512 | m_GOLDMONT | m_AMDFAM10 | m_BDVER\n-\t  | m_BTVER | m_ZNVER1 | m_GENERIC)\n+\t  | m_INTEL | m_SKYLAKE_AVX512 | m_GOLDMONT | m_GOLDMONT_PLUS\n+\t  | m_AMDFAM10 | m_BDVER | m_BTVER | m_ZNVER1 | m_GENERIC)\n \n /* X86_TUNE_SSE_UNALIGNED_STORE_OPTIMAL: Use movups for misaligned stores instead\n    of a sequence loading registers by parts.  */\n DEF_TUNE (X86_TUNE_SSE_UNALIGNED_STORE_OPTIMAL, \"sse_unaligned_store_optimal\",\n \t  m_NEHALEM | m_SANDYBRIDGE | m_HASWELL | m_SILVERMONT | m_KNL | m_KNM\n-\t  | m_INTEL | m_SKYLAKE_AVX512 | m_GOLDMONT | m_BDVER | m_ZNVER1\n-\t  | m_GENERIC)\n+\t  | m_INTEL | m_SKYLAKE_AVX512 | m_GOLDMONT | m_GOLDMONT_PLUS\n+\t  | m_BDVER | m_ZNVER1 | m_GENERIC)\n \n /* Use packed single precision instructions where posisble.  I.e. movups instead\n    of movupd.  */\n@@ -387,7 +392,8 @@ DEF_TUNE (X86_TUNE_INTER_UNIT_CONVERSIONS, \"inter_unit_conversions\",\n /* X86_TUNE_SPLIT_MEM_OPND_FOR_FP_CONVERTS: Try to split memory operand for\n    fp converts to destination register.  */\n DEF_TUNE (X86_TUNE_SPLIT_MEM_OPND_FOR_FP_CONVERTS, \"split_mem_opnd_for_fp_converts\",\n-\t  m_SILVERMONT | m_KNL | m_KNM | m_GOLDMONT | m_INTEL)\n+\t  m_SILVERMONT | m_KNL | m_KNM | m_GOLDMONT | m_GOLDMONT_PLUS\n+\t  | m_INTEL)\n \n /* X86_TUNE_USE_VECTOR_FP_CONVERTS: Prefer vector packed SSE conversion\n    from FP to FP.  This form of instructions avoids partial write to the\n@@ -401,11 +407,12 @@ DEF_TUNE (X86_TUNE_USE_VECTOR_CONVERTS, \"use_vector_converts\", m_AMDFAM10)\n \n /* X86_TUNE_SLOW_SHUFB: Indicates tunings with slow pshufb instruction.  */\n DEF_TUNE (X86_TUNE_SLOW_PSHUFB, \"slow_pshufb\",\n-\t  m_BONNELL | m_SILVERMONT | m_KNL | m_KNM | m_GOLDMONT | m_INTEL)\n+\t  m_BONNELL | m_SILVERMONT | m_KNL | m_KNM | m_GOLDMONT\n+\t  | m_GOLDMONT_PLUS | m_INTEL)\n \n /* X86_TUNE_AVOID_4BYTE_PREFIXES: Avoid instructions requiring 4+ bytes of prefixes.  */\n DEF_TUNE (X86_TUNE_AVOID_4BYTE_PREFIXES, \"avoid_4byte_prefixes\",\n-\t  m_SILVERMONT | m_GOLDMONT | m_INTEL)\n+\t  m_SILVERMONT | m_GOLDMONT | m_GOLDMONT_PLUS | m_INTEL)\n \n /* X86_TUNE_USE_GATHER: Use gather instructions.  */\n DEF_TUNE (X86_TUNE_USE_GATHER, \"use_gather\","}, {"sha": "4023197c07c6b9773194c006b5311e619b81c2da", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -26508,6 +26508,11 @@ Intel Goldmont CPU with 64-bit extensions, MOVBE, MMX, SSE, SSE2, SSE3, SSSE3,\n SSE4.1, SSE4.2, POPCNT, AES, PCLMUL, RDRND, XSAVE, XSAVEOPT and FSGSBASE\n instruction set support.\n \n+@item goldmont-plus\n+Intel Goldmont Plus CPU with 64-bit extensions, MOVBE, MMX, SSE, SSE2, SSE3,\n+SSSE3, SSE4.1, SSE4.2, POPCNT, AES, PCLMUL, RDRND, XSAVE, XSAVEOPT, FSGSBASE,\n+PTWRITE, RDPID, SGX and UMIP instruction set support.\n+\n @item knl\n Intel Knight's Landing CPU with 64-bit extensions, MOVBE, MMX, SSE, SSE2, SSE3,\n SSSE3, SSE4.1, SSE4.2, POPCNT, AVX, AVX2, AES, PCLMUL, FSGSBASE, RDRND, FMA,"}, {"sha": "ce6ff7e69c0f1aab780ee85837a141dcbaf41ed5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -1,3 +1,8 @@\n+2018-05-17  Olga Makhotina  <olga.makhotina@intel.com>\n+\t\n+\t* gcc.target/i386/builtin_target.c: Test goldmont-plus.\n+\t* gcc.target/i386/funcspec-56.inc: Tests for arch=goldmont-plus.\n+\n 2018-05-17  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/85757"}, {"sha": "1a7a9f3124fca6280a0b05e9bac7a4b680c6b4f9", "filename": "gcc/testsuite/gcc.target/i386/builtin_target.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fbuiltin_target.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fbuiltin_target.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fbuiltin_target.c?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -43,6 +43,10 @@ check_intel_cpu_model (unsigned int family, unsigned int model,\n \t      /* Goldmont.  */\n \t      assert (__builtin_cpu_is (\"goldmont\"));\n \t      break;\n+\t    case 0x7a:\n+\t      /* Goldmont Plus.  */\n+\t      assert (__builtin_cpu_is (\"goldmont-plus\"));\n+\t      break;\n \t    case 0x57:\n \t      /* Knights Landing.  */\n \t      assert (__builtin_cpu_is (\"knl\"));"}, {"sha": "6a110382201e70a47875b9d5d2b3a41bdb8d50d1", "filename": "gcc/testsuite/gcc.target/i386/funcspec-56.inc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuncspec-56.inc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuncspec-56.inc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Ffuncspec-56.inc?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -143,6 +143,7 @@ extern void test_arch_corei7_avx (void)\t\t__attribute__((__target__(\"arch=corei7-\n extern void test_arch_core_avx2 (void)\t\t__attribute__((__target__(\"arch=core-avx2\")));\n extern void test_arch_silvermont (void)\t\t__attribute__((__target__(\"arch=silvermont\")));\n extern void test_arch_goldmont (void)\t\t__attribute__((__target__(\"arch=goldmont\")));\n+extern void test_arch_goldmont_plus (void)\t__attribute__((__target__(\"arch=goldmont-plus\")));\n extern void test_arch_knl (void)\t\t__attribute__((__target__(\"arch=knl\")));\n extern void test_arch_knm (void)\t\t__attribute__((__target__(\"arch=knm\")));\n extern void test_arch_skylake (void)\t\t__attribute__((__target__(\"arch=skylake\")));"}, {"sha": "55bae33884f4b34cbf6e8739f91f9b2706436c65", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -1,3 +1,8 @@\n+2018-05-17  Olga Makhotina  <olga.makhotina@intel.com>\n+\n+\t* config/i386/cpuinfo.h (processor_types): Add INTEL_GOLDMONT_PLUS.\n+\t* config/i386/cpuinfo.c (get_intel_cpu): Detect Goldmont Plus.\n+\n 2018-05-08  Olga Makhotina  <olga.makhotina@intel.com>\n \n \t* config/i386/cpuinfo.h (processor_types): Add INTEL_GOLDMONT."}, {"sha": "8c9878c791de527b19e180f4b20fc55de87f5956", "filename": "libgcc/config/i386/cpuinfo.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/libgcc%2Fconfig%2Fi386%2Fcpuinfo.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/libgcc%2Fconfig%2Fi386%2Fcpuinfo.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Fi386%2Fcpuinfo.c?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -145,6 +145,10 @@ get_intel_cpu (unsigned int family, unsigned int model, unsigned int brand_id)\n \t      /* Goldmont.  */\n \t      __cpu_model.__cpu_type = INTEL_GOLDMONT;\n \t      break;\n+\t    case 0x7a:\n+\t      /* Goldmont Plus.  */\n+\t      __cpu_model.__cpu_type = INTEL_GOLDMONT_PLUS;\n+\t      break;\n \t    case 0x57:\n \t      /* Knights Landing.  */\n \t      __cpu_model.__cpu_type = INTEL_KNL;"}, {"sha": "ace07df10f348dd2098fc5aa4ff8bee1792c8b45", "filename": "libgcc/config/i386/cpuinfo.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74b2bb19f37e4deeff97924564d460f8689ac02e/libgcc%2Fconfig%2Fi386%2Fcpuinfo.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74b2bb19f37e4deeff97924564d460f8689ac02e/libgcc%2Fconfig%2Fi386%2Fcpuinfo.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Fi386%2Fcpuinfo.h?ref=74b2bb19f37e4deeff97924564d460f8689ac02e", "patch": "@@ -49,6 +49,7 @@ enum processor_types\n   AMDFAM17H,\n   INTEL_KNM,\n   INTEL_GOLDMONT,\n+  INTEL_GOLDMONT_PLUS,\n   CPU_TYPE_MAX\n };\n "}]}