{"sha": "7bbd0aab4cbbb32562e015d10419d4c1616104bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2JiZDBhYWI0Y2JiYjMyNTYyZTAxNWQxMDQxOWQ0YzE2MTYxMDRiYg==", "commit": {"author": {"name": "Mike Stump", "email": "mrs@apple.com", "date": "2005-11-18T23:40:29Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2005-11-18T23:40:29Z"}, "message": "c-common.c (handle_cleanup_attribute): Use a lang hook for lookup_name.\n\n\t* c-common.c (handle_cleanup_attribute): Use a lang hook for lookup_name.\n\t* config/darwin-c.c (darwin_pragma_unused): Likewise.\n\t* c-decl.c (lookup_name_two) Remove.\n\t* c-tree.h (lookup_name_two): Remove.\n\t* c-objc-common.h (LANG_HOOKS_LOOKUP_NAME): Add.\n\t* langhooks-def.h (LANG_HOOKS_LOOKUP_NAME): Add.\n\t(LANG_HOOKS_DECLS): Add initializer for LANG_HOOKS_LOOKUP_NAME.\n\t* langhooks.h (lang_hooks_for_decls): Add lookup_name.\n\ncp:\n\t* cp-objcp-common.h (LANG_HOOKS_LOOKUP_NAME): Add.\n\t* name-lookup.c (lookup_name_two): Remove.\n\t(lookup_name_one): Add.\n\t* name-lookup.h (lookup_name_two): Remove.\n\t(lookup_name_one): Add.\n\nFrom-SVN: r107196", "tree": {"sha": "4485e94760f589adf0f27e512f1e74736da95b8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4485e94760f589adf0f27e512f1e74736da95b8d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7bbd0aab4cbbb32562e015d10419d4c1616104bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bbd0aab4cbbb32562e015d10419d4c1616104bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7bbd0aab4cbbb32562e015d10419d4c1616104bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bbd0aab4cbbb32562e015d10419d4c1616104bb/comments", "author": null, "committer": null, "parents": [{"sha": "186abafe49fabf3f0ee8a58c54c36e256846172e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/186abafe49fabf3f0ee8a58c54c36e256846172e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/186abafe49fabf3f0ee8a58c54c36e256846172e"}], "stats": {"total": 52, "additions": 37, "deletions": 15}, "files": [{"sha": "c4f105fecd87918dedc0f7240154398c61d7da27", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -1,3 +1,14 @@\n+2005-11-18  Mike Stump  <mrs@apple.com>\n+\n+\t* c-common.c (handle_cleanup_attribute): Use a lang hook for lookup_name.\n+\t* config/darwin-c.c (darwin_pragma_unused): Likewise.\n+\t* c-decl.c (lookup_name_two) Remove.\n+\t* c-tree.h (lookup_name_two): Remove.\n+\t* c-objc-common.h (LANG_HOOKS_LOOKUP_NAME): Add.\n+\t* langhooks-def.h (LANG_HOOKS_LOOKUP_NAME): Add.\n+\t(LANG_HOOKS_DECLS): Add initializer for LANG_HOOKS_LOOKUP_NAME.\n+\t* langhooks.h (lang_hooks_for_decls): Add lookup_name.\n+\t\n 2005-11-18  Richard Earnshaw  <richard.earnshaw@arm.com>\n \n \tPR target/24914"}, {"sha": "b54755da38b8ea191da3a2995c97fa4f23155210", "filename": "gcc/c-common.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -5464,7 +5464,7 @@ handle_cleanup_attribute (tree *node, tree name, tree args,\n       *no_add_attrs = true;\n       return NULL_TREE;\n     }\n-  cleanup_decl = lookup_name_two (cleanup_id, 0);\n+  cleanup_decl = lang_hooks.decls.lookup_name (cleanup_id);\n   if (!cleanup_decl || TREE_CODE (cleanup_decl) != FUNCTION_DECL)\n     {\n       error (\"cleanup argument not a function\");"}, {"sha": "003b813fc7d5f579d5156902eab4e8425bed7435", "filename": "gcc/c-decl.c", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -2671,15 +2671,6 @@ lookup_name (tree name)\n   return 0;\n }\n \n-/* Similar to `lookup_name' for the benefit of common code and the C++\n-   front end.  */\n-\n-tree\n-lookup_name_two (tree name, int ARG_UNUSED (prefer_type))\n-{\n-  return lookup_name (name);\n-}\n-\n /* Similar to `lookup_name' but look only at the indicated scope.  */\n \n static tree"}, {"sha": "706f12075af6ded813b52f29ebb20342cb9fe5aa", "filename": "gcc/c-objc-common.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-objc-common.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-objc-common.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-objc-common.h?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -127,6 +127,8 @@ extern void c_initialize_diagnostics (diagnostic_context *);\n \n #undef LANG_HOOKS_GETDECLS\n #define LANG_HOOKS_GETDECLS lhd_return_null_tree_v\n+#undef LANG_HOOKS_LOOKUP_NAME\n+#define LANG_HOOKS_LOOKUP_NAME lookup_name\n #undef LANG_HOOKS_WRITE_GLOBALS\n #define LANG_HOOKS_WRITE_GLOBALS c_write_global_declarations\n "}, {"sha": "0894317e5741e4ec8c614224a8f13792490e0176", "filename": "gcc/c-tree.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fc-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-tree.h?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -455,7 +455,6 @@ extern tree grokparm (const struct c_parm *);\n extern tree implicitly_declare (tree);\n extern void keep_next_level (void);\n extern tree lookup_name (tree);\n-extern tree lookup_name_two (tree, int);\n extern void pending_xref_error (void);\n extern void c_push_function_context (struct function *);\n extern void c_pop_function_context (struct function *);"}, {"sha": "13be8fab95d1149a40c6eefebef80ba71b8f0f79", "filename": "gcc/config/darwin-c.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fconfig%2Fdarwin-c.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fconfig%2Fdarwin-c.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin-c.c?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -33,6 +33,7 @@ Boston, MA 02110-1301, USA.  */\n #include \"tm_p.h\"\n #include \"cppdefault.h\"\n #include \"prefix.h\"\n+#include \"langhooks.h\"\n \n /* Pragmas.  */\n \n@@ -141,7 +142,7 @@ darwin_pragma_unused (cpp_reader *pfile ATTRIBUTE_UNUSED)\n       tok = c_lex (&decl);\n       if (tok == CPP_NAME && decl)\n \t{\n-\t  tree local = lookup_name_two (decl, 0);\n+\t  tree local = lang_hooks.decls.lookup_name (decl);\n \t  if (local && (TREE_CODE (local) == PARM_DECL\n \t\t\t|| TREE_CODE (local) == VAR_DECL))\n \t    TREE_USED (local) = 1;"}, {"sha": "42e44da26ba07ef0f064735be21040d2ead76938", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -1,3 +1,11 @@\n+2005-11-18  Mike Stump  <mrs@apple.com>\n+\n+\t* cp-objcp-common.h (LANG_HOOKS_LOOKUP_NAME): Add.\n+\t* name-lookup.c (lookup_name_two): Remove.\n+\t(lookup_name_one): Add.\n+\t* name-lookup.h (lookup_name_two): Remove.\n+\t(lookup_name_one): Add.\n+\n 2005-11-15  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/24580"}, {"sha": "bd7f4f7958c87bb1f3a803a3b5f5bf811eabebd9", "filename": "gcc/cp/cp-objcp-common.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2Fcp-objcp-common.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2Fcp-objcp-common.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-objcp-common.h?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -151,5 +151,7 @@ extern tree objcp_tsubst_copy_and_build (tree, tree, tsubst_flags_t,\n #define LANG_HOOKS_TO_TARGET_CHARSET c_common_to_target_charset\n #undef LANG_HOOKS_GIMPLIFY_EXPR\n #define LANG_HOOKS_GIMPLIFY_EXPR cp_gimplify_expr\n+#undef LANG_HOOKS_LOOKUP_NAME\n+#define LANG_HOOKS_LOOKUP_NAME lookup_name_one\n \n #endif /* GCC_CP_OBJCP_COMMON */"}, {"sha": "4302ca6194ee2572496cb1f8eb276aae6696a8d7", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -4003,9 +4003,9 @@ lookup_name (tree name, int prefer_type)\n /* Similar to `lookup_name' for the benefit of common code.  */\n \n tree\n-lookup_name_two (tree name, int prefer_type)\n+lookup_name_one (tree name)\n {\n-  return lookup_name (name, prefer_type);\n+  return lookup_name (name, 0);\n }\n \n /* Look up NAME for type used in elaborated name specifier in"}, {"sha": "11c1feca5625c59c922771d2fd0a0c0cb664451f", "filename": "gcc/cp/name-lookup.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2Fname-lookup.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Fcp%2Fname-lookup.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.h?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -313,7 +313,7 @@ extern void pushlevel_class (void);\n extern void poplevel_class (void);\n extern tree pushdecl_with_scope (tree, cxx_scope *, bool);\n extern tree lookup_name\t(tree, int);\n-extern tree lookup_name_two (tree, int);\n+extern tree lookup_name_one (tree);\n extern tree lookup_name_real (tree, int, int, bool, int, int);\n extern tree lookup_type_scope (tree, tag_scope);\n extern tree namespace_binding (tree, tree);"}, {"sha": "ff5e73efb41cc15ac08ccfa5d62cbd614699702d", "filename": "gcc/langhooks-def.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Flanghooks-def.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Flanghooks-def.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks-def.h?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -234,6 +234,7 @@ extern tree lhd_make_node (enum tree_code);\n #define LANG_HOOKS_INSERT_BLOCK\tinsert_block\n #define LANG_HOOKS_PUSHDECL\tpushdecl\n #define LANG_HOOKS_GETDECLS\tgetdecls\n+#define LANG_HOOKS_LOOKUP_NAME\tlhd_return_null_tree\n #define LANG_HOOKS_WARN_UNUSED_GLOBAL_DECL lhd_warn_unused_global_decl\n #define LANG_HOOKS_WRITE_GLOBALS write_global_declarations\n #define LANG_HOOKS_PREPARE_ASSEMBLE_VARIABLE NULL\n@@ -245,6 +246,7 @@ extern tree lhd_make_node (enum tree_code);\n   LANG_HOOKS_INSERT_BLOCK, \\\n   LANG_HOOKS_PUSHDECL, \\\n   LANG_HOOKS_GETDECLS, \\\n+  LANG_HOOKS_LOOKUP_NAME, \\\n   LANG_HOOKS_WARN_UNUSED_GLOBAL_DECL, \\\n   LANG_HOOKS_WRITE_GLOBALS, \\\n   LANG_HOOKS_PREPARE_ASSEMBLE_VARIABLE, \\"}, {"sha": "22346fe59059ef995bc811cf14fee2ec2dbb9fdc", "filename": "gcc/langhooks.h", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Flanghooks.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bbd0aab4cbbb32562e015d10419d4c1616104bb/gcc%2Flanghooks.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flanghooks.h?ref=7bbd0aab4cbbb32562e015d10419d4c1616104bb", "patch": "@@ -170,6 +170,12 @@ struct lang_hooks_for_decls\n   /* Returns the chain of decls so far in the current scope level.  */\n   tree (*getdecls) (void);\n \n+/* Look up NAME in the current scope and its superiors\n+   in the namespace of variables, functions and typedefs.\n+   Return a ..._DECL node of some kind representing its definition,\n+   or return 0 if it is undefined.  */\n+  tree (*lookup_name) (tree);\n+\n   /* Returns true when we should warn for an unused global DECL.\n      We will already have checked that it has static binding.  */\n   bool (*warn_unused_global) (tree);"}]}