{"sha": "81f0bab25ec7d17b84e94ee7322aa953a75584a7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODFmMGJhYjI1ZWM3ZDE3Yjg0ZTk0ZWU3MzIyYWE5NTNhNzU1ODRhNw==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2010-10-27T21:42:36Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2010-10-27T21:42:36Z"}, "message": "c-common.c (check_case_value): Remove special C++ code.\n\nc-family/\n\t* c-common.c (check_case_value): Remove special C++ code.\ncp/\n\t* decl.c (finish_case_label): Use decl_constant_value.\n\nFrom-SVN: r166019", "tree": {"sha": "ffd5d52f502eeecf4274ffa2c4c9a0e6c6360099", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ffd5d52f502eeecf4274ffa2c4c9a0e6c6360099"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/81f0bab25ec7d17b84e94ee7322aa953a75584a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81f0bab25ec7d17b84e94ee7322aa953a75584a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81f0bab25ec7d17b84e94ee7322aa953a75584a7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81f0bab25ec7d17b84e94ee7322aa953a75584a7/comments", "author": null, "committer": null, "parents": [{"sha": "5ac13b8e0c688dcf1251aee3f90eddfc1e5ba43f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5ac13b8e0c688dcf1251aee3f90eddfc1e5ba43f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5ac13b8e0c688dcf1251aee3f90eddfc1e5ba43f"}], "stats": {"total": 27, "additions": 11, "deletions": 16}, "files": [{"sha": "1098129e40269fde895aef0adf61c19fb69d116f", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=81f0bab25ec7d17b84e94ee7322aa953a75584a7", "patch": "@@ -1,3 +1,7 @@\n+2010-10-27  Jason Merrill  <jason@redhat.com>\n+\n+\t* c-common.c (check_case_value): Remove special C++ code.\n+\n 2010-10-27  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \t* c-common.h (enum rid): Added RID_READWRITE, RID_ASSIGN,"}, {"sha": "98568e82279f60c590fdc9f9bedcef14eaf2a096", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 0, "deletions": 16, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=81f0bab25ec7d17b84e94ee7322aa953a75584a7", "patch": "@@ -2588,22 +2588,6 @@ check_case_value (tree value)\n   if (value == NULL_TREE)\n     return value;\n \n-  /* ??? Can we ever get nops here for a valid case value?  We\n-     shouldn't for C.  */\n-  STRIP_TYPE_NOPS (value);\n-  /* In C++, the following is allowed:\n-\n-       const int i = 3;\n-       switch (...) { case i: ... }\n-\n-     So, we try to reduce the VALUE to a constant that way.  */\n-  if (c_dialect_cxx ())\n-    {\n-      value = decl_constant_value (value);\n-      STRIP_TYPE_NOPS (value);\n-      value = fold (value);\n-    }\n-\n   if (TREE_CODE (value) == INTEGER_CST)\n     /* Promote char or short to int.  */\n     value = perform_integral_promotions (value);"}, {"sha": "6efa96ae022bd207cbdbd04ae5cc366268d10392", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=81f0bab25ec7d17b84e94ee7322aa953a75584a7", "patch": "@@ -1,6 +1,8 @@\n 2010-10-27  Gabriel Dos Reis  <gdr@cse.tamu.edu>\n \t    Jason Merrill  <jason@redhat.com>\n \n+\t* decl.c (finish_case_label): Use decl_constant_value.\n+\n \t* method.c (synthesized_method_walk): Track constexprness too.\n \t(process_subob_fn, walk_field_subobs): Likewise.\n \t(implicitly_declare_fn): Set DECL_DECLARED_CONSTEXPR_P."}, {"sha": "d73d109af819b5ec1d55b2844230914e5d7266de", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81f0bab25ec7d17b84e94ee7322aa953a75584a7/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=81f0bab25ec7d17b84e94ee7322aa953a75584a7", "patch": "@@ -2938,6 +2938,11 @@ finish_case_label (location_t loc, tree low_value, tree high_value)\n   if (!check_switch_goto (switch_stack->level))\n     return error_mark_node;\n \n+  if (low_value)\n+    low_value = decl_constant_value (low_value);\n+  if (high_value)\n+    high_value = decl_constant_value (high_value);\n+\n   r = c_add_case_label (loc, switch_stack->cases, cond,\n \t\t\tSWITCH_STMT_TYPE (switch_stack->switch_stmt),\n \t\t\tlow_value, high_value);"}]}