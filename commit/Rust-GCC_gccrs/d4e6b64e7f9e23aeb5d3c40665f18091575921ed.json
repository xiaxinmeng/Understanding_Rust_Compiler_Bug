{"sha": "d4e6b64e7f9e23aeb5d3c40665f18091575921ed", "node_id": "C_kwDOANBUbNoAKGQ0ZTZiNjRlN2Y5ZTIzYWViNWQzYzQwNjY1ZjE4MDkxNTc1OTIxZWQ", "commit": {"author": {"name": "Philip Herron", "email": "herron.philip@googlemail.com", "date": "2023-01-31T14:39:29Z"}, "committer": {"name": "Philip Herron", "email": "herron.philip@googlemail.com", "date": "2023-02-05T00:10:48Z"}, "message": "gccrs: Add missing Sized, Copy and Clone lang item mappings\n\nWe need these lang items to be defined and later down the line the mappings\nwill be used to implement proper copy and clone logic.\n\nFixes #1786\n\nSigned-off-by: Philip Herron <herron.philip@googlemail.com>\n\ngcc/rust/ChangeLog:\n\n\t* util/rust-lang-item.h:\n\ngcc/testsuite/ChangeLog:\n\n\t* rust/compile/issue-1786.rs: New test.", "tree": {"sha": "980f386af89a8d7a2357588e08a061dd5d1be841", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/980f386af89a8d7a2357588e08a061dd5d1be841"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d4e6b64e7f9e23aeb5d3c40665f18091575921ed", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4e6b64e7f9e23aeb5d3c40665f18091575921ed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4e6b64e7f9e23aeb5d3c40665f18091575921ed", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4e6b64e7f9e23aeb5d3c40665f18091575921ed/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e612713029296dac8429e4b00ec7659bcad5cffe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e612713029296dac8429e4b00ec7659bcad5cffe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e612713029296dac8429e4b00ec7659bcad5cffe"}], "stats": {"total": 47, "additions": 47, "deletions": 0}, "files": [{"sha": "5bad08ae7c10f594346d8323b55be8af626a464e", "filename": "gcc/rust/util/rust-lang-item.h", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4e6b64e7f9e23aeb5d3c40665f18091575921ed/gcc%2Frust%2Futil%2Frust-lang-item.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4e6b64e7f9e23aeb5d3c40665f18091575921ed/gcc%2Frust%2Futil%2Frust-lang-item.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Futil%2Frust-lang-item.h?ref=d4e6b64e7f9e23aeb5d3c40665f18091575921ed", "patch": "@@ -80,6 +80,12 @@ class RustLangItem\n     FN_ONCE,\n     FN_ONCE_OUTPUT,\n \n+    // markers\n+    COPY,\n+    CLONE,\n+    SIZED,\n+\n+    // delimiter\n     UNKNOWN,\n   };\n \n@@ -237,6 +243,18 @@ class RustLangItem\n       {\n \treturn ItemType::FN_ONCE_OUTPUT;\n       }\n+    else if (item.compare (\"copy\") == 0)\n+      {\n+\treturn ItemType::COPY;\n+      }\n+    else if (item.compare (\"clone\") == 0)\n+      {\n+\treturn ItemType::CLONE;\n+      }\n+    else if (item.compare (\"sized\") == 0)\n+      {\n+\treturn ItemType::SIZED;\n+      }\n \n     return ItemType::UNKNOWN;\n   }\n@@ -321,6 +339,12 @@ class RustLangItem\n \treturn \"fn_once\";\n       case FN_ONCE_OUTPUT:\n \treturn \"fn_once_output\";\n+      case COPY:\n+\treturn \"copy\";\n+      case CLONE:\n+\treturn \"clone\";\n+      case SIZED:\n+\treturn \"sized\";\n \n       case UNKNOWN:\n \treturn \"<UNKNOWN>\";"}, {"sha": "f73b63d0cb679ad38217120acfb6b0387d5af51c", "filename": "gcc/testsuite/rust/compile/issue-1786.rs", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d4e6b64e7f9e23aeb5d3c40665f18091575921ed/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1786.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d4e6b64e7f9e23aeb5d3c40665f18091575921ed/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1786.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1786.rs?ref=d4e6b64e7f9e23aeb5d3c40665f18091575921ed", "patch": "@@ -0,0 +1,23 @@\n+#[lang = \"clone\"]\n+trait Clone {\n+    fn clone(&self) -> Self;\n+\n+    fn clone_from(&mut self, source: &Self) {\n+        *self = source.clone()\n+    }\n+}\n+\n+#[lang = \"copy\"]\n+pub trait Copy: Clone {\n+    // Empty.\n+}\n+\n+mod impls {\n+    use super::Clone;\n+\n+    impl Clone for char {\n+        fn clone(&self) -> Self {\n+            *self\n+        }\n+    }\n+}"}]}