{"sha": "5560d026a64962d45a9f17b3a2928e1f0922a0f5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTU2MGQwMjZhNjQ5NjJkNDVhOWYxN2IzYTI5MjhlMWYwOTIyYTBmNQ==", "commit": {"author": {"name": "Chung-Lin Tang", "email": "cltang@codesourcery.com", "date": "2016-09-15T09:46:36Z"}, "committer": {"name": "Chung-Lin Tang", "email": "cltang@gcc.gnu.org", "date": "2016-09-15T09:46:36Z"}, "message": "re PR fortran/72743 (ICE in get_constraint_for_ssa_var, at tree-ssa-structalias.c:2958)\n\n2016-09-15  Chung-Lin Tang  <cltang@codesourcery.com>\n\n\tPR fortran/72743\n\t* ipa-icf.c (set_alias_uids): New function.\n\t(sem_variable::merge): Use set_alias_uids to set DECL_PT_UID of\n\tall the merged variable's referring aliases.\n\n\ttestsuite/\n\t* gfortran.dg/goacc/pr72743.f90: New test.\n\nFrom-SVN: r240155", "tree": {"sha": "27f8ed62ca6bbe83b2b61bc9a89808afba465de0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/27f8ed62ca6bbe83b2b61bc9a89808afba465de0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5560d026a64962d45a9f17b3a2928e1f0922a0f5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5560d026a64962d45a9f17b3a2928e1f0922a0f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5560d026a64962d45a9f17b3a2928e1f0922a0f5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5560d026a64962d45a9f17b3a2928e1f0922a0f5/comments", "author": {"login": "cltang", "id": 4055966, "node_id": "MDQ6VXNlcjQwNTU5NjY=", "avatar_url": "https://avatars.githubusercontent.com/u/4055966?v=4", "gravatar_id": "", "url": "https://api.github.com/users/cltang", "html_url": "https://github.com/cltang", "followers_url": "https://api.github.com/users/cltang/followers", "following_url": "https://api.github.com/users/cltang/following{/other_user}", "gists_url": "https://api.github.com/users/cltang/gists{/gist_id}", "starred_url": "https://api.github.com/users/cltang/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/cltang/subscriptions", "organizations_url": "https://api.github.com/users/cltang/orgs", "repos_url": "https://api.github.com/users/cltang/repos", "events_url": "https://api.github.com/users/cltang/events{/privacy}", "received_events_url": "https://api.github.com/users/cltang/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5334f73312e13d4ddc5968276c9ca94a98f28647", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5334f73312e13d4ddc5968276c9ca94a98f28647", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5334f73312e13d4ddc5968276c9ca94a98f28647"}], "stats": {"total": 49, "additions": 46, "deletions": 3}, "files": [{"sha": "22c5ffdd628644f1c6c2f5df40282e5bb19cd9fa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5560d026a64962d45a9f17b3a2928e1f0922a0f5", "patch": "@@ -1,3 +1,10 @@\n+2016-09-15  Chung-Lin Tang  <cltang@codesourcery.com>\n+\n+\tPR fortran/72743\n+\t* ipa-icf.c (set_alias_uids): New function.\n+\t(sem_variable::merge): Use set_alias_uids to set DECL_PT_UID of\n+\tall the merged variable's referring aliases.\n+\n 2016-09-15  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/77514"}, {"sha": "798d833971e08464247a0e26d1ff7fde2d121d67", "filename": "gcc/ipa-icf.c", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2Fipa-icf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2Fipa-icf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-icf.c?ref=5560d026a64962d45a9f17b3a2928e1f0922a0f5", "patch": "@@ -2133,6 +2133,23 @@ sem_variable::get_hash (void)\n   return m_hash;\n }\n \n+/* Set all points-to UIDs of aliases pointing to node N as UID.  */\n+\n+static void\n+set_alias_uids (symtab_node *n, int uid)\n+{\n+  ipa_ref *ref;\n+  FOR_EACH_ALIAS (n, ref)\n+    {\n+      if (dump_file)\n+\tfprintf (dump_file, \"  Setting points-to UID of [%s] as %d\\n\",\n+\t\t xstrdup_for_dump (ref->referring->asm_name ()), uid);\n+\n+      SET_DECL_PT_UID (ref->referring->decl, uid);\n+      set_alias_uids (ref->referring, uid);\n+    }\n+}\n+\n /* Merges instance with an ALIAS_ITEM, where alias, thunk or redirection can\n    be applied.  */\n \n@@ -2258,12 +2275,11 @@ sem_variable::merge (sem_item *alias_item)\n \n       varpool_node::create_alias (alias_var->decl, decl);\n       alias->resolve_alias (original);\n-      if (DECL_PT_UID_SET_P (original->decl))\n-\tSET_DECL_PT_UID (alias->decl, DECL_PT_UID (original->decl));\n \n       if (dump_file)\n-\tfprintf (dump_file, \"Unified; Variable alias has been created.\\n\\n\");\n+\tfprintf (dump_file, \"Unified; Variable alias has been created.\\n\");\n \n+      set_alias_uids (original, DECL_UID (original->decl));\n       return true;\n     }\n }"}, {"sha": "95ac8706873fc2c1611e6b43ac45a991c09c906b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5560d026a64962d45a9f17b3a2928e1f0922a0f5", "patch": "@@ -1,3 +1,8 @@\n+2016-09-15  Chung-Lin Tang  <cltang@codesourcery.com>\n+\n+\tPR fortran/72743\n+\t* gfortran.dg/goacc/pr72743.f90: New test.\n+\n 2016-09-15  Richard Biener  <rguenther@suse.de>\n \n \t* gcc.dg/fold-reassoc-2.c: Fix dump scan."}, {"sha": "a29714bd43c77f608366b46b6e8131b09ce4c4fe", "filename": "gcc/testsuite/gfortran.dg/goacc/pr72743.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fpr72743.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5560d026a64962d45a9f17b3a2928e1f0922a0f5/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fpr72743.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fpr72743.f90?ref=5560d026a64962d45a9f17b3a2928e1f0922a0f5", "patch": "@@ -0,0 +1,15 @@\n+! { dg-do compile }\n+! { dg-additional-options \"-O2\" }\n+\n+program p\n+   integer, parameter :: n = 8\n+   integer :: i, z(n)\n+   z = [(i, i=1,n)]\n+   print *, z\n+end\n+subroutine s\n+   integer, parameter :: n = 8\n+   integer :: i, z(n)\n+   z = [(i, i=1,n)]\n+   print *, z\n+end"}]}