{"sha": "3b5e8a16ba3595b38727c8e6242db740b66dae63", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2I1ZThhMTZiYTM1OTViMzg3MjdjOGU2MjQyZGI3NDBiNjZkYWU2Mw==", "commit": {"author": {"name": "Michael Hayes", "email": "m.hayes@elec.canterbury.ac.nz", "date": "1999-10-15T23:37:53Z"}, "committer": {"name": "Michael Hayes", "email": "m.hayes@gcc.gnu.org", "date": "1999-10-15T23:37:53Z"}, "message": "c4x.c (c4x_rptb_insert): Emit rpts_top pattern if appropriate.\n\n\t* config/c4x/c4x.c (c4x_rptb_insert): Emit rpts_top pattern\n\tif appropriate.\n\t* config/c4x/c4x.md (rpts_top): New pattern and splitter.\n\nFrom-SVN: r30027", "tree": {"sha": "49f793c35a48df2e6a74e3e9a8087efbf18d5611", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/49f793c35a48df2e6a74e3e9a8087efbf18d5611"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3b5e8a16ba3595b38727c8e6242db740b66dae63", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b5e8a16ba3595b38727c8e6242db740b66dae63", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b5e8a16ba3595b38727c8e6242db740b66dae63", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b5e8a16ba3595b38727c8e6242db740b66dae63/comments", "author": null, "committer": null, "parents": [{"sha": "1a616dfc0ce5c5a9b92f297a2083a8be18682d21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a616dfc0ce5c5a9b92f297a2083a8be18682d21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a616dfc0ce5c5a9b92f297a2083a8be18682d21"}], "stats": {"total": 49, "additions": 47, "deletions": 2}, "files": [{"sha": "d80b7fc716b38fbf457dba44755f29a770017ef9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b5e8a16ba3595b38727c8e6242db740b66dae63/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b5e8a16ba3595b38727c8e6242db740b66dae63/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3b5e8a16ba3595b38727c8e6242db740b66dae63", "patch": "@@ -1,3 +1,9 @@\n+Sat Oct 16 12:34:44 1999  Michael Hayes  <m.hayes@elec.canterbury.ac.nz>\n+\n+\t* config/c4x/c4x.c (c4x_rptb_insert): Emit rpts_top pattern\n+\tif appropriate.\n+\t* config/c4x/c4x.md (rpts_top): New pattern and splitter.\n+\n Sat Oct 16 12:26:30 1999  Michael Hayes  <m.hayes@elec.canterbury.ac.nz>\n \n \t* config/c4x/c4x.c (src_operand):  Check SYMBOL_REF and LABEL_REF"}, {"sha": "b927413e4b46f8781848b86262b6ea2a18bd0f92", "filename": "gcc/config/c4x/c4x.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b5e8a16ba3595b38727c8e6242db740b66dae63/gcc%2Fconfig%2Fc4x%2Fc4x.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b5e8a16ba3595b38727c8e6242db740b66dae63/gcc%2Fconfig%2Fc4x%2Fc4x.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc4x%2Fc4x.c?ref=3b5e8a16ba3595b38727c8e6242db740b66dae63", "patch": "@@ -2176,7 +2176,10 @@ c4x_rptb_insert (insn)\n     fatal_insn (\"c4x_rptb_insert: Cannot find start label\", start_label);\n \n   /* We'll have to update the basic blocks.  */\n-  emit_insn_before (gen_rptb_top (start_label, end_label), insn);\n+  if (TARGET_RPTS && c4x_rptb_rpts_p (PREV_INSN (insn), 0))\n+    emit_insn_before (gen_rpts_top (start_label, end_label), insn);\n+  else\n+    emit_insn_before (gen_rptb_top (start_label, end_label), insn);\n }\n \n "}, {"sha": "e1a39fa2ca5fed1c2a710bd32a01e589d8b4d677", "filename": "gcc/config/c4x/c4x.md", "status": "modified", "additions": 37, "deletions": 1, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b5e8a16ba3595b38727c8e6242db740b66dae63/gcc%2Fconfig%2Fc4x%2Fc4x.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b5e8a16ba3595b38727c8e6242db740b66dae63/gcc%2Fconfig%2Fc4x%2Fc4x.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fc4x%2Fc4x.md?ref=3b5e8a16ba3595b38727c8e6242db740b66dae63", "patch": "@@ -4908,10 +4908,20 @@\n   \"\n   [(set_attr \"type\" \"repeat_top\")])\n \n+(define_insn \"rpts_top\"\n+  [(unspec [(use (label_ref (match_operand 0 \"\" \"\")))\n+            (use (label_ref (match_operand 1 \"\" \"\")))] 2)]\n+  \"\"\n+  \"*\n+   return ! final_sequence && c4x_rptb_rpts_p (insn, operands[0])\n+\t ? \\\"rpts\\\\trc\\\" : \\\"rptb%#\\\\t%l1-1\\\";\n+  \"\n+  [(set_attr \"type\" \"repeat\")])\n+\n ; This pattern needs to be emitted at the start of the loop to\n ; say that RS and RE are loaded.\n (define_insn \"rptb_init\"\n-  [(unspec[(match_operand:QI 0 \"register_operand\" \"va\")] 22)\n+  [(unspec [(match_operand:QI 0 \"register_operand\" \"va\")] 22)\n    (clobber (reg:QI 25))\n    (clobber (reg:QI 26))]\n   \"\"\n@@ -4965,6 +4975,32 @@\n   \"\n   [(set_attr \"type\" \"repeat,db,jmpc,jmpc,jmpc\")])\n \n+(define_split\n+   [(set (pc)\n+        (if_then_else (ge (match_operand:QI 0 \"addr_reg_operand\" \"\")\n+                          (const_int 0))\n+                      (label_ref (match_operand 1 \"\" \"\"))\n+                      (pc)))\n+   (set (match_dup 0)\n+        (plus:QI (match_dup 0)\n+                 (const_int -1)))\n+   (use (match_operand:QI 2 \"const_int_operand\" \"\"))\n+   (use (match_operand:QI 3 \"const_int_operand\" \"\"))\n+   (use (match_operand:QI 4 \"const_int_operand\" \"\"))\n+   (use (reg:QI 25))\n+   (use (reg:QI 26))\n+   (clobber (reg:CC_NOOV 21))]\n+  \"reload_completed\"\n+  [(parallel [(set (pc)\n+                   (if_then_else (ge (match_dup 0)\n+\t\t\t             (const_int 0))\n+\t\t                 (label_ref (match_dup 1))\n+\t\t                 (pc)))\n+              (set (match_dup 0)\n+                   (plus:QI (match_dup 0)\n+                            (const_int -1)))])]\n+  \"\")\n+\n ; operand 0 is the loop count pseudo register\n ; operand 1 is the number of loop iterations or 0 if it is unknown\n ; operand 2 is the maximum number of loop iterations"}]}