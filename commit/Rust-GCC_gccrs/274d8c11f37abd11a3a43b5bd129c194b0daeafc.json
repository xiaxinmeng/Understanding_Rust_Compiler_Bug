{"sha": "274d8c11f37abd11a3a43b5bd129c194b0daeafc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjc0ZDhjMTFmMzdhYmQxMWEzYTQzYjViZDEyOWMxOTRiMGRhZWFmYw==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2015-07-24T20:20:13Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2015-07-24T20:20:13Z"}, "message": "re PR c++/64079 (%+D in diagnostics breaks pragma GCC diagnostic)\n\n2015-07-24  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\n\tPR c++/64079\n\t* toplev.c (check_global_declaration): Use DECL_SOURCE_LOCATION\n\tand \"%qD\" in warning_at instead of \"%q+D\" in warning.\n\n/testsuite\n2015-07-24  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\n\tPR c++/64079\n\t* c-c++-common/Wunused-function-1.c: New.\n\nFrom-SVN: r226191", "tree": {"sha": "5546702f4370a0141cb4902e6646f8d83f0e1492", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5546702f4370a0141cb4902e6646f8d83f0e1492"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/274d8c11f37abd11a3a43b5bd129c194b0daeafc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/274d8c11f37abd11a3a43b5bd129c194b0daeafc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/274d8c11f37abd11a3a43b5bd129c194b0daeafc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/274d8c11f37abd11a3a43b5bd129c194b0daeafc/comments", "author": null, "committer": null, "parents": [{"sha": "36b7d827dbcae9727c83ca10424d657109caa12b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/36b7d827dbcae9727c83ca10424d657109caa12b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/36b7d827dbcae9727c83ca10424d657109caa12b"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "264570832f75fd1fc33b0ad05ba12360fc01e2c0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=274d8c11f37abd11a3a43b5bd129c194b0daeafc", "patch": "@@ -1,3 +1,9 @@\n+2015-07-24  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c++/64079\n+\t* toplev.c (check_global_declaration): Use DECL_SOURCE_LOCATION\n+\tand \"%qD\" in warning_at instead of \"%q+D\" in warning.\n+\n 2015-07-24  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.c (ix86_call_abi_override): Call ix86_function_abi."}, {"sha": "57bb26d014e98269539b750654952ab754b93691", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=274d8c11f37abd11a3a43b5bd129c194b0daeafc", "patch": "@@ -1,3 +1,8 @@\n+2015-07-24  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+\tPR c++/64079\n+\t* c-c++-common/Wunused-function-1.c: New.\n+\n 2015-07-24  Tom de Vries  <tom@codesourcery.com>\n \n \t* gcc.dg/parloops-exit-first-loop-alt-2.c: Use debug print for"}, {"sha": "9f856952b2e216a1f8cbc1dd6ca7b2fa4853778c", "filename": "gcc/testsuite/c-c++-common/Wunused-function-1.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWunused-function-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWunused-function-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWunused-function-1.c?ref=274d8c11f37abd11a3a43b5bd129c194b0daeafc", "patch": "@@ -0,0 +1,10 @@\n+/* PR c++/64079 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wunused-function\" } */\n+\n+#pragma GCC diagnostic push\n+#pragma GCC diagnostic ignored \"-Wunused-function\"\n+\n+static void bar() {}\n+\n+#pragma GCC diagnostic pop"}, {"sha": "1bacb68889dc5c54f3541ed2b8cdf8c48055854b", "filename": "gcc/toplev.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/274d8c11f37abd11a3a43b5bd129c194b0daeafc/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=274d8c11f37abd11a3a43b5bd129c194b0daeafc", "patch": "@@ -524,10 +524,11 @@ check_global_declaration (tree decl)\n \t      && !DECL_STATIC_DESTRUCTOR (decl)))\n       /* Otherwise, ask the language.  */\n       && lang_hooks.decls.warn_unused_global (decl))\n-    warning ((TREE_CODE (decl) == FUNCTION_DECL)\n-\t     ? OPT_Wunused_function\n-             : OPT_Wunused_variable,\n-\t     \"%q+D defined but not used\", decl);\n+    warning_at (DECL_SOURCE_LOCATION (decl),\n+\t\t(TREE_CODE (decl) == FUNCTION_DECL)\n+\t\t? OPT_Wunused_function\n+\t\t: OPT_Wunused_variable,\n+\t\t\"%qD defined but not used\", decl);\n }\n \n /* Compile an entire translation unit.  Write a file of assembly"}]}