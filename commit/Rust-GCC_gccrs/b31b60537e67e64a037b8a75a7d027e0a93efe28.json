{"sha": "b31b60537e67e64a037b8a75a7d027e0a93efe28", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjMxYjYwNTM3ZTY3ZTY0YTAzN2I4YTc1YTdkMDI3ZTBhOTNlZmUyOA==", "commit": {"author": {"name": "Will Schmidt", "email": "will_schmidt@vnet.ibm.com", "date": "2018-03-02T15:18:54Z"}, "committer": {"name": "Will Schmidt", "email": "willschm@gcc.gnu.org", "date": "2018-03-02T15:18:54Z"}, "message": "altivec-7-be.c: Remove VSX content, allow 32-bit target.\n\n\n[testsuite]\n\n2018-03-02  Will Schmidt  <will_schmidt@vnet.ibm.com>\n\n\t* gcc.target/powerpc/altivec-7-be.c: Remove VSX content, allow\n\t32-bit target.\n\t* gcc.target/powerpc/altivec-7.h: Remove VSX content.\n\t* gcc.target/powerpc/vsx-7-be.c: New test (VSX content).\n\t* gcc.target/powerpc/vsx-7.h: New include (VSX content).\n\t* gcc.target/powerpc/altivec-7-le.c: Add vsx-7.h include.\n\nFrom-SVN: r258137", "tree": {"sha": "131b5c032e9e364e70c34ba8267b577e1db70cc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/131b5c032e9e364e70c34ba8267b577e1db70cc5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b31b60537e67e64a037b8a75a7d027e0a93efe28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b31b60537e67e64a037b8a75a7d027e0a93efe28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b31b60537e67e64a037b8a75a7d027e0a93efe28", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b31b60537e67e64a037b8a75a7d027e0a93efe28/comments", "author": {"login": "willschm", "id": 44359, "node_id": "MDQ6VXNlcjQ0MzU5", "avatar_url": "https://avatars.githubusercontent.com/u/44359?v=4", "gravatar_id": "", "url": "https://api.github.com/users/willschm", "html_url": "https://github.com/willschm", "followers_url": "https://api.github.com/users/willschm/followers", "following_url": "https://api.github.com/users/willschm/following{/other_user}", "gists_url": "https://api.github.com/users/willschm/gists{/gist_id}", "starred_url": "https://api.github.com/users/willschm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/willschm/subscriptions", "organizations_url": "https://api.github.com/users/willschm/orgs", "repos_url": "https://api.github.com/users/willschm/repos", "events_url": "https://api.github.com/users/willschm/events{/privacy}", "received_events_url": "https://api.github.com/users/willschm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3458c61f6c864a67f736839af2b8b8308f66da81", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3458c61f6c864a67f736839af2b8b8308f66da81", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3458c61f6c864a67f736839af2b8b8308f66da81"}], "stats": {"total": 92, "additions": 81, "deletions": 11}, "files": [{"sha": "94900056afd397f07850a565ce7ab76abeebe02a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b31b60537e67e64a037b8a75a7d027e0a93efe28", "patch": "@@ -1,3 +1,12 @@\n+2018-03-02  Will Schmidt  <will_schmidt@vnet.ibm.com>\n+\n+\t* gcc.target/powerpc/altivec-7-be.c: Remove VSX content, allow\n+\t32-bit target.\n+\t* gcc.target/powerpc/altivec-7.h: Remove VSX content.\n+\t* gcc.target/powerpc/vsx-7-be.c: New test (VSX content).\n+\t* gcc.target/powerpc/vsx-7.h: New include (VSX content).\n+\t* gcc.target/powerpc/altivec-7-le.c: Add vsx-7.h include.\n+\n 2018-03-02  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/84590"}, {"sha": "1e690be14452c4ce4f9dfe8ef8cce62cfeb746d1", "filename": "gcc/testsuite/gcc.target/powerpc/altivec-7-be.c", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7-be.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7-be.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7-be.c?ref=b31b60537e67e64a037b8a75a7d027e0a93efe28", "patch": "@@ -1,10 +1,10 @@\n-/* { dg-do compile { target powerpc64-*-* } } */\n+/* { dg-do compile { target powerpc*-*-* } } */\n /* { dg-require-effective-target powerpc_altivec_ok } */\n /* { dg-options \"-maltivec\" } */\n \n /* Expected results for Big Endian:\n      vec_packpx                     vpkpx\n-     vec_ld                         lxv2x\n+     vec_ld                         lxvd2x\n      vec_lde                        lvewx\n      vec_ldl                        lxvl\n      vec_lvewx                      lvewx\n@@ -21,15 +21,10 @@\n /* { dg-final { scan-assembler-times \"vpkpx\" 2 } } */\n /* { dg-final { scan-assembler-times \"vmulesb\" 1 } } */\n /* { dg-final { scan-assembler-times \"vmulosb\" 1 } } */\n-/* { dg-final { scan-assembler-times \"lxvd2x\" 6 } } */\n /* { dg-final { scan-assembler-times \"lvewx\" 2 } } */\n /* { dg-final { scan-assembler-times \"lvxl\" 1 } } */\n /* { dg-final { scan-assembler-times \"vupklsh\" 1 } } */\n /* { dg-final { scan-assembler-times \"vupkhsh\" 1 } } */\n-/* { dg-final { scan-assembler-times \"xxlnor\" 4 } } */\n-/* { dg-final { scan-assembler-times \"xxland\" 4 } } */\n-/* { dg-final { scan-assembler-times \"xxlxor\" 5 } } */\n-/* { dg-final { scan-assembler-times \"vupkhpx\" 1 } } */\n \n /* Source code for the test in altivec-7.h */\n #include \"altivec-7.h\""}, {"sha": "38ce15362714f1b3dae2b7ba8acdfa83a322b0d5", "filename": "gcc/testsuite/gcc.target/powerpc/altivec-7-le.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7-le.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7-le.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7-le.c?ref=b31b60537e67e64a037b8a75a7d027e0a93efe28", "patch": "@@ -32,5 +32,6 @@\n /* { dg-final { scan-assembler-times \"xxlxor\" 5 } } */\n /* { dg-final { scan-assembler-times \"vupkhpx\" 1 } } */\n \n-/* Source code for the test in altivec-7.h */\n+/* Source code for the test in altivec-7.h and vsx-7.h. */\n #include \"altivec-7.h\"\n+#include \"vsx-7.h\""}, {"sha": "4dedcd8146988e2178294242e0b13a46f4a972d9", "filename": "gcc/testsuite/gcc.target/powerpc/altivec-7.h", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Faltivec-7.h?ref=b31b60537e67e64a037b8a75a7d027e0a93efe28", "patch": "@@ -17,7 +17,6 @@ vector unsigned char *vecuchar;\n vector unsigned int *vecuint;\n vector unsigned short *vecushort;\n vector float *vecfloat;\n-vector double *vecdouble;\n \n int main ()\n {\n@@ -43,8 +42,6 @@ int main ()\n   *vecuint++ = vec_lvx(var_int[0], uintp[1]);\n   *vecuint++ = vec_vmsumubm(vecuchar[0], vecuchar[1], vecuint[2]);\n   *vecuchar++ = vec_xor(vecuchar[0], (vector unsigned char)vecchar[1]);\n-  *vecdouble++ = vec_unpackl(vecfloat[0]);\n-  *vecdouble++ = vec_unpackh(vecfloat[0]);\n \n   return 0;\n }"}, {"sha": "2df9fca11d4a125a6df3dab833732b9a7c4a07ab", "filename": "gcc/testsuite/gcc.target/powerpc/vsx-7-be.c", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fvsx-7-be.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fvsx-7-be.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fvsx-7-be.c?ref=b31b60537e67e64a037b8a75a7d027e0a93efe28", "patch": "@@ -0,0 +1,50 @@\n+/* { dg-do compile { target powerpc*-*-* } } */\n+/* { dg-require-effective-target powerpc_vsx_ok } */\n+/* { dg-options \"-mvsx\" } */\n+\n+/* This is an extension of altivec-7-be.c, with vsx target features included. */\n+\n+/* Expected results for Big Endian:\n+(from altivec-7.h)\n+     vec_packpx                     vpkpx\n+     vec_ld                         lxvd2x or lxv\n+     vec_lde                        lvewx\n+     vec_ldl                        lxvl\n+     vec_lvewx                      lvewx\n+     vec_andc                       xxnor\n+                                    xxland\n+     vec_vxor                       xxlxor\n+     vec_vmsumubm                   vmsumubm\n+     vec_vmulesb                    vmulesb\n+     vec_vmulosb                    vmulosb\n+(from vsx-7.h)\n+     vec_unpackl                    vupkhsh\n+     vec_unpackh                    vupklsh\n+*/\n+\n+/* { dg-final { scan-assembler-times \"vpkpx\" 2 } } */\n+/* { dg-final { scan-assembler-times \"vmulesb\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vmulosb\" 1 } } */\n+\n+// For LE platforms P9 and later, we generate the lxv insn instead of lxvd2x.\n+/* { dg-final { scan-assembler-times {\\mlxvd2x\\M}  0  { target { { powerpc64*le-*-* } && { p9vector_hw } } } } } */\n+/* { dg-final { scan-assembler-times {\\mlxv\\M}    36  { target { { powerpc64*le-*-* } && { p9vector_hw } } } } } */\n+// For LE platforms < P9.\n+/* { dg-final { scan-assembler-times {\\mlxvd2x\\M}  36  { target { { powerpc64*le-*-* } && { ! p9vector_hw } } } } } */\n+// For BE platforms we generate 6 lxvd2x insns.\n+/* { dg-final { scan-assembler-times {\\mlxvd2x\\M}  6  { target { { ! powerpc64*le-*-* } && { ! p9vector_hw } } } } } */\n+\n+/* { dg-final { scan-assembler-times \"lvewx\" 2 } } */\n+/* { dg-final { scan-assembler-times \"lvxl\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vupklsh\" 1 } } */\n+/* { dg-final { scan-assembler-times \"vupkhsh\" 1 } } */\n+/* { dg-final { scan-assembler-times \"xxlnor\" 4 } } */\n+/* { dg-final { scan-assembler-times \"xxland\" 4 } } */\n+/* { dg-final { scan-assembler-times \"xxlxor\" 5 } } */\n+/* { dg-final { scan-assembler-times \"vupkhpx\" 1 } } */\n+\n+/* Source code for the 'altivec' test in altivec-7.h */\n+/* Source code for the 'vsx' required tests in vsx-7.h */\n+\n+#include \"altivec-7.h\"\n+#include \"vsx-7.h\""}, {"sha": "fe5547243f45e1a4563fa29136458c37da6b5cf7", "filename": "gcc/testsuite/gcc.target/powerpc/vsx-7.h", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fvsx-7.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b31b60537e67e64a037b8a75a7d027e0a93efe28/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fvsx-7.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fvsx-7.h?ref=b31b60537e67e64a037b8a75a7d027e0a93efe28", "patch": "@@ -0,0 +1,18 @@\n+\n+/* This test code is included into vsx-7-be.c.\n+ * this is meant to supplement code in altivec-7.h.  */\n+\n+#include <altivec.h>\n+\n+\n+vector float *vecfloat;\n+vector double *vecdouble;\n+\n+int main2 ()\n+{\n+\n+  *vecdouble++ = vec_unpackl(vecfloat[0]);\n+  *vecdouble++ = vec_unpackh(vecfloat[0]);\n+\n+  return 0;\n+}"}]}