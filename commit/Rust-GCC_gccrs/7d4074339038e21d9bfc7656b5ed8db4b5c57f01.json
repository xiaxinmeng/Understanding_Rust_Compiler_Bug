{"sha": "7d4074339038e21d9bfc7656b5ed8db4b5c57f01", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2Q0MDc0MzM5MDM4ZTIxZDliZmM3NjU2YjVlZDhkYjRiNWM1N2YwMQ==", "commit": {"author": {"name": "Bob Wilson", "email": "bob.wilson@acm.org", "date": "2008-10-21T18:06:12Z"}, "committer": {"name": "Bob Wilson", "email": "bwilson@gcc.gnu.org", "date": "2008-10-21T18:06:12Z"}, "message": "var-tracking.c (insn_stack_adjust_offset_pre_post): If insn has a REG_FRAME_RELATED_EXPR note...\n\n\t* var-tracking.c (insn_stack_adjust_offset_pre_post): If insn has a\n\tREG_FRAME_RELATED_EXPR note, examine the pattern from the note instead\n\tof from insn.\n\nFrom-SVN: r141272", "tree": {"sha": "2177c51ed2d72409e3256ff49607c4af9cfd3328", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2177c51ed2d72409e3256ff49607c4af9cfd3328"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d4074339038e21d9bfc7656b5ed8db4b5c57f01", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d4074339038e21d9bfc7656b5ed8db4b5c57f01", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d4074339038e21d9bfc7656b5ed8db4b5c57f01", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d4074339038e21d9bfc7656b5ed8db4b5c57f01/comments", "author": null, "committer": null, "parents": [{"sha": "cd6d4007aa4f72b51756e4a571abf876fa3e3133", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd6d4007aa4f72b51756e4a571abf876fa3e3133", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd6d4007aa4f72b51756e4a571abf876fa3e3133"}], "stats": {"total": 31, "additions": 23, "deletions": 8}, "files": [{"sha": "cf00fef37a8d2212e1e531c4d3d915bdfa9e791e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d4074339038e21d9bfc7656b5ed8db4b5c57f01/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d4074339038e21d9bfc7656b5ed8db4b5c57f01/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7d4074339038e21d9bfc7656b5ed8db4b5c57f01", "patch": "@@ -1,3 +1,9 @@\n+2008-10-21  Bob Wilson  <bob.wilson@acm.org>\n+\n+\t* var-tracking.c (insn_stack_adjust_offset_pre_post): If insn has a\n+\tREG_FRAME_RELATED_EXPR note, examine the pattern from the note instead\n+\tof from insn.\n+\n 2008-10-21  Adam Nemet  <anemet@caviumnetworks.com>\n \n \tPR middle-end/37669"}, {"sha": "2b92e403bf251d51336574c543d62e03b426350a", "filename": "gcc/var-tracking.c", "status": "modified", "additions": 17, "deletions": 8, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d4074339038e21d9bfc7656b5ed8db4b5c57f01/gcc%2Fvar-tracking.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d4074339038e21d9bfc7656b5ed8db4b5c57f01/gcc%2Fvar-tracking.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvar-tracking.c?ref=7d4074339038e21d9bfc7656b5ed8db4b5c57f01", "patch": "@@ -466,22 +466,31 @@ static void\n insn_stack_adjust_offset_pre_post (rtx insn, HOST_WIDE_INT *pre,\n \t\t\t\t   HOST_WIDE_INT *post)\n {\n+  rtx pattern;\n+\n   *pre = 0;\n   *post = 0;\n \n-  if (GET_CODE (PATTERN (insn)) == SET)\n-    stack_adjust_offset_pre_post (PATTERN (insn), pre, post);\n-  else if (GET_CODE (PATTERN (insn)) == PARALLEL\n-\t   || GET_CODE (PATTERN (insn)) == SEQUENCE)\n+  pattern = PATTERN (insn);\n+  if (RTX_FRAME_RELATED_P (insn))\n+    {\n+      rtx expr = find_reg_note (insn, REG_FRAME_RELATED_EXPR, NULL_RTX);\n+      if (expr)\n+\tpattern = XEXP (expr, 0);\n+    }\n+\n+  if (GET_CODE (pattern) == SET)\n+    stack_adjust_offset_pre_post (pattern, pre, post);\n+  else if (GET_CODE (pattern) == PARALLEL\n+\t   || GET_CODE (pattern) == SEQUENCE)\n     {\n       int i;\n \n       /* There may be stack adjustments inside compound insns.  Search\n \t for them.  */\n-      for ( i = XVECLEN (PATTERN (insn), 0) - 1; i >= 0; i--)\n-\tif (GET_CODE (XVECEXP (PATTERN (insn), 0, i)) == SET)\n-\t  stack_adjust_offset_pre_post (XVECEXP (PATTERN (insn), 0, i),\n-\t\t\t\t\tpre, post);\n+      for ( i = XVECLEN (pattern, 0) - 1; i >= 0; i--)\n+\tif (GET_CODE (XVECEXP (pattern, 0, i)) == SET)\n+\t  stack_adjust_offset_pre_post (XVECEXP (pattern, 0, i), pre, post);\n     }\n }\n "}]}