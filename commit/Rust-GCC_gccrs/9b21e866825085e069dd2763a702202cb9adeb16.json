{"sha": "9b21e866825085e069dd2763a702202cb9adeb16", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWIyMWU4NjY4MjUwODVlMDY5ZGQyNzYzYTcwMjIwMmNiOWFkZWIxNg==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-12-08T22:02:23Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-12-08T22:02:23Z"}, "message": "re PR lto/61886 (LTO breaks fread with _FORTIFY_SOURCE=2)\n\n\n\tPR ipa/61886\n\t* varpool.c (varpool_node::get_availability): Recurse only on\n\tweakrefs with definition in the target.\n\t(symbol_table::remove_unreferenced_decls): Keep aliases in the boundary.\n\nFrom-SVN: r231429", "tree": {"sha": "45e5fa8debe25103566c68d50a4572bfba529fdc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/45e5fa8debe25103566c68d50a4572bfba529fdc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9b21e866825085e069dd2763a702202cb9adeb16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b21e866825085e069dd2763a702202cb9adeb16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b21e866825085e069dd2763a702202cb9adeb16", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b21e866825085e069dd2763a702202cb9adeb16/comments", "author": null, "committer": null, "parents": [{"sha": "ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ced7e9584b848a8d5975b23efb5eac04ee2aee6f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ced7e9584b848a8d5975b23efb5eac04ee2aee6f"}], "stats": {"total": 21, "additions": 14, "deletions": 7}, "files": [{"sha": "55f89c9fd588ff0e3e66d7a6d5c5bac332ad8eeb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b21e866825085e069dd2763a702202cb9adeb16/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b21e866825085e069dd2763a702202cb9adeb16/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9b21e866825085e069dd2763a702202cb9adeb16", "patch": "@@ -1,8 +1,15 @@\n 2015-12-08  Jan Hubicka  <hubicka@ucw.cz>\n \n \tPR ipa/61886\n-\t* ipa-visibility.c (can_replace_by_local_alias): Look through transparent\n-\taliaes; refuse weakrefs.\n+\t* varpool.c (varpool_node::get_availability): Recurse only on\n+\tweakrefs with definition in the target.\n+\t(symbol_table::remove_unreferenced_decls): Keep aliases in the boundary.\n+\n+2015-12-08  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/61886\n+\t* ipa-visibility.c (can_replace_by_local_alias): Look through\n+\ttransparent aliases; refuse weakrefs.\n \t(update_visibility_by_resolution_info): Skip transparent aliases in the\n \tanalysis part\n "}, {"sha": "ac77269a7385e5e11c01667603ddb526907594d8", "filename": "gcc/varpool.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9b21e866825085e069dd2763a702202cb9adeb16/gcc%2Fvarpool.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9b21e866825085e069dd2763a702202cb9adeb16/gcc%2Fvarpool.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarpool.c?ref=9b21e866825085e069dd2763a702202cb9adeb16", "patch": "@@ -490,7 +490,7 @@ varpool_node::get_availability (void)\n   if (DECL_IN_CONSTANT_POOL (decl)\n       || DECL_VIRTUAL_P (decl))\n     return AVAIL_AVAILABLE;\n-  if (transparent_alias)\n+  if (transparent_alias && definition)\n     {\n       enum availability avail;\n \n@@ -667,11 +667,11 @@ symbol_table::remove_unreferenced_decls (void)\n \t    enqueue_node (vnode, &first);\n \t  else\n \t    {\n-\t      referenced.add (node);\n-\t      while (node->alias && node->definition)\n+\t      referenced.add (vnode);\n+\t      while (vnode && vnode->alias && vnode->definition)\n \t\t{\n-\t\t  node = node->get_alias_target ();\n-\t          referenced.add (node);\n+\t\t  vnode = vnode->get_alias_target ();\n+\t          referenced.add (vnode);\n \t\t}\n \t    }\n \t}"}]}