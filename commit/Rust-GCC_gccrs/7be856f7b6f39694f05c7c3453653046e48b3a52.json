{"sha": "7be856f7b6f39694f05c7c3453653046e48b3a52", "node_id": "C_kwDOANBUbNoAKDdiZTg1NmY3YjZmMzk2OTRmMDVjN2MzNDUzNjUzMDQ2ZTQ4YjNhNTI", "commit": {"author": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-04-22T08:31:50Z"}, "committer": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-04-22T10:31:58Z"}, "message": "privacy: visibility: Add resolving for \"private\" items", "tree": {"sha": "9b743bc86d812c9d7f0842e52daccf57eca45d64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9b743bc86d812c9d7f0842e52daccf57eca45d64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7be856f7b6f39694f05c7c3453653046e48b3a52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7be856f7b6f39694f05c7c3453653046e48b3a52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7be856f7b6f39694f05c7c3453653046e48b3a52", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7be856f7b6f39694f05c7c3453653046e48b3a52/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "77afec780ae6193a5e4d3895d3169b150e4b556d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/77afec780ae6193a5e4d3895d3169b150e4b556d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/77afec780ae6193a5e4d3895d3169b150e4b556d"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "99f13674889e418eaf9adcdd2fd3c55f7b6465fc", "filename": "gcc/rust/privacy/rust-visibility-resolver.cc", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7be856f7b6f39694f05c7c3453653046e48b3a52/gcc%2Frust%2Fprivacy%2Frust-visibility-resolver.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7be856f7b6f39694f05c7c3453653046e48b3a52/gcc%2Frust%2Fprivacy%2Frust-visibility-resolver.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fprivacy%2Frust-visibility-resolver.cc?ref=7be856f7b6f39694f05c7c3453653046e48b3a52", "patch": "@@ -47,7 +47,18 @@ bool\n VisibilityResolver::resolve_visibility (const HIR::Visibility &visibility,\n \t\t\t\t\tModuleVisibility &to_resolve)\n {\n-  return false;\n+  switch (visibility.get_vis_type ())\n+    {\n+    case HIR::Visibility::PRIVATE:\n+      to_resolve = ModuleVisibility::create_restricted (peek_module ());\n+      return true;\n+    case HIR::Visibility::PUBLIC:\n+      // FIXME: We need to handle the restricted path here\n+      to_resolve = ModuleVisibility::create_public ();\n+      return true;\n+    default:\n+      return false;\n+    }\n }\n \n DefId"}]}