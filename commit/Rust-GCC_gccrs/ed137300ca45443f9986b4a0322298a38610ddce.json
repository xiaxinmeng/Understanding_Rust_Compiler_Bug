{"sha": "ed137300ca45443f9986b4a0322298a38610ddce", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWQxMzczMDBjYTQ1NDQzZjk5ODZiNGEwMzIyMjk4YTM4NjEwZGRjZQ==", "commit": {"author": {"name": "Georg-Johann Lay", "email": "avr@gjlay.de", "date": "2015-03-23T18:19:01Z"}, "committer": {"name": "Georg-Johann Lay", "email": "gjl@gcc.gnu.org", "date": "2015-03-23T18:19:01Z"}, "message": "re PR target/65296 ([avr] fix various issues with specs file generation)\n\n\tPR target/65296\n\t* config/avr/driver-avr.c (avr_devicespecs_file): Allow to specify\n\tthe same -mmcu=MCU more than once.\n\nFrom-SVN: r221602", "tree": {"sha": "e2c03422a8e473f3589b737d426c8c6efa05c5f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e2c03422a8e473f3589b737d426c8c6efa05c5f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ed137300ca45443f9986b4a0322298a38610ddce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed137300ca45443f9986b4a0322298a38610ddce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed137300ca45443f9986b4a0322298a38610ddce", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed137300ca45443f9986b4a0322298a38610ddce/comments", "author": null, "committer": {"login": "sprintersb", "id": 8905355, "node_id": "MDQ6VXNlcjg5MDUzNTU=", "avatar_url": "https://avatars.githubusercontent.com/u/8905355?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sprintersb", "html_url": "https://github.com/sprintersb", "followers_url": "https://api.github.com/users/sprintersb/followers", "following_url": "https://api.github.com/users/sprintersb/following{/other_user}", "gists_url": "https://api.github.com/users/sprintersb/gists{/gist_id}", "starred_url": "https://api.github.com/users/sprintersb/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sprintersb/subscriptions", "organizations_url": "https://api.github.com/users/sprintersb/orgs", "repos_url": "https://api.github.com/users/sprintersb/repos", "events_url": "https://api.github.com/users/sprintersb/events{/privacy}", "received_events_url": "https://api.github.com/users/sprintersb/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1c5ad28704be4ae243030d6600b0f4dbd4635986", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c5ad28704be4ae243030d6600b0f4dbd4635986", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c5ad28704be4ae243030d6600b0f4dbd4635986"}], "stats": {"total": 29, "additions": 21, "deletions": 8}, "files": [{"sha": "ad9ca05bd29673311d2ebe55718593c6c637f010", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed137300ca45443f9986b4a0322298a38610ddce/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed137300ca45443f9986b4a0322298a38610ddce/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ed137300ca45443f9986b4a0322298a38610ddce", "patch": "@@ -1,3 +1,9 @@\n+2015-03-23  Georg-Johann Lay  <avr@gjlay.de>\n+\n+\tPR target/65296\n+\t* config/avr/driver-avr.c (avr_devicespecs_file): Allow to specify\n+\tthe same -mmcu=MCU more than once.\n+\n 2015-03-23  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR bootstrap/65522"}, {"sha": "4890a39b489a9eebdedc727ee6a91e0c60ca333e", "filename": "gcc/config/avr/driver-avr.c", "status": "modified", "additions": 15, "deletions": 8, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed137300ca45443f9986b4a0322298a38610ddce/gcc%2Fconfig%2Favr%2Fdriver-avr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed137300ca45443f9986b4a0322298a38610ddce/gcc%2Fconfig%2Favr%2Fdriver-avr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Fdriver-avr.c?ref=ed137300ca45443f9986b4a0322298a38610ddce", "patch": "@@ -55,9 +55,10 @@ avr_diagnose_devicespecs_error (const char *mcu, const char *filename)\n \n /* Implement spec function `device-specs-file\u00b4.\n \n-   Compose -specs=<specs-file-name>.  If everything went well then argv[0]\n-   is the inflated specs directory and argv[1] is a device or core name as\n-   supplied to -mmcu=*.  */\n+   Compose -specs=<specs-file-name>%s.  If everything went well then argv[0]\n+   is the inflated (absolute) specs directory and argv[1] is a device or\n+   core name as supplied by -mmcu=*.  When building GCC the path might\n+   be relative.  */\n \n const char*\n avr_devicespecs_file (int argc, const char **argv)\n@@ -82,13 +83,19 @@ avr_devicespecs_file (int argc, const char **argv)\n       mmcu = AVR_MMCU_DEFAULT;\n       break;\n \n-    case 2:\n+    default:\n       mmcu = argv[1];\n-      break;\n \n-    default:\n-      error (\"specified option %qs more than once\", \"-mmcu=\");\n-      return X_NODEVLIB;\n+      // Allow specifying the same MCU more than once.\n+\n+      for (int i = 2; i < argc; i++)\n+        if (0 != strcmp (mmcu, argv[i]))\n+          {\n+            error (\"specified option %qs more than once\", \"-mmcu\");\n+            return X_NODEVLIB;\n+          }\n+\n+      break;\n     }\n \n   specfile_name = concat (argv[0], dir_separator_str, \"specs-\", mmcu, NULL);"}]}