{"sha": "bc95e478febd35e0d1fb13c1833d2383ad0e7d18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmM5NWU0NzhmZWJkMzVlMGQxZmIxM2MxODMzZDIzODNhZDBlN2QxOA==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@acm.org", "date": "2020-05-06T19:09:59Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@acm.org", "date": "2020-05-06T19:14:44Z"}, "message": "c++: QT overload regression with attribute [PR94946]\n\nJason's fix for 90570 & 79585 was a bit overzealous.  Dependent attribs should still\nattach to a parameter decl.\n\n            * decl.c (grokdeclarator): Don't splice template attributes in\n            parm context -- they can apply to the parm.", "tree": {"sha": "847d03f15b3c822cef5cab23aa855ddbb38656bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/847d03f15b3c822cef5cab23aa855ddbb38656bf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc95e478febd35e0d1fb13c1833d2383ad0e7d18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc95e478febd35e0d1fb13c1833d2383ad0e7d18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc95e478febd35e0d1fb13c1833d2383ad0e7d18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc95e478febd35e0d1fb13c1833d2383ad0e7d18/comments", "author": {"login": "urnathan", "id": 13103001, "node_id": "MDQ6VXNlcjEzMTAzMDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13103001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urnathan", "html_url": "https://github.com/urnathan", "followers_url": "https://api.github.com/users/urnathan/followers", "following_url": "https://api.github.com/users/urnathan/following{/other_user}", "gists_url": "https://api.github.com/users/urnathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/urnathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urnathan/subscriptions", "organizations_url": "https://api.github.com/users/urnathan/orgs", "repos_url": "https://api.github.com/users/urnathan/repos", "events_url": "https://api.github.com/users/urnathan/events{/privacy}", "received_events_url": "https://api.github.com/users/urnathan/received_events", "type": "User", "site_admin": false}, "committer": {"login": "urnathan", "id": 13103001, "node_id": "MDQ6VXNlcjEzMTAzMDAx", "avatar_url": "https://avatars.githubusercontent.com/u/13103001?v=4", "gravatar_id": "", "url": "https://api.github.com/users/urnathan", "html_url": "https://github.com/urnathan", "followers_url": "https://api.github.com/users/urnathan/followers", "following_url": "https://api.github.com/users/urnathan/following{/other_user}", "gists_url": "https://api.github.com/users/urnathan/gists{/gist_id}", "starred_url": "https://api.github.com/users/urnathan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/urnathan/subscriptions", "organizations_url": "https://api.github.com/users/urnathan/orgs", "repos_url": "https://api.github.com/users/urnathan/repos", "events_url": "https://api.github.com/users/urnathan/events{/privacy}", "received_events_url": "https://api.github.com/users/urnathan/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "80644a672e635261c15a5804cdcd1eb851814478", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80644a672e635261c15a5804cdcd1eb851814478", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80644a672e635261c15a5804cdcd1eb851814478"}], "stats": {"total": 21, "additions": 18, "deletions": 3}, "files": [{"sha": "7e41433707e90e35ebc858fb5e8108d3e5125806", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc95e478febd35e0d1fb13c1833d2383ad0e7d18/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc95e478febd35e0d1fb13c1833d2383ad0e7d18/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=bc95e478febd35e0d1fb13c1833d2383ad0e7d18", "patch": "@@ -1,3 +1,9 @@\n+2020-05-06  Nathan Sidwell  <nathan@acm.org>\n+\n+\tPR c++/94946\n+\t* decl.c (grokdeclarator): Don't splice template attributes in\n+\tparm context -- they can apply to the parm.\n+\n 2020-05-05  Iain Sandoe  <iain@sandoe.co.uk>\n \n \t* coroutines.cc: Remove references to n4849 throughout."}, {"sha": "232d7ed4a1459c24459a879b02aafecbb11693cf", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc95e478febd35e0d1fb13c1833d2383ad0e7d18/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc95e478febd35e0d1fb13c1833d2383ad0e7d18/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=bc95e478febd35e0d1fb13c1833d2383ad0e7d18", "patch": "@@ -11940,9 +11940,12 @@ grokdeclarator (const cp_declarator *declarator,\n \t    attr_flags |= (int) ATTR_FLAG_FUNCTION_NEXT;\n \t  if (declarator->kind == cdk_array)\n \t    attr_flags |= (int) ATTR_FLAG_ARRAY_NEXT;\n-\t  /* Assume that any attributes that get applied late to templates will\n-\t     DTRT when applied to the declaration as a whole.  */\n-\t  tree late_attrs = splice_template_attributes (&attrs, type);\n+\t  tree late_attrs = NULL_TREE;\n+\t  if (decl_context != PARM)\n+\t    /* Assume that any attributes that get applied late to\n+\t       templates will DTRT when applied to the declaration\n+\t       as a whole.  */\n+\t    late_attrs = splice_template_attributes (&attrs, type);\n \t  returned_attrs = decl_attributes (&type,\n \t\t\t\t\t    chainon (returned_attrs, attrs),\n \t\t\t\t\t    attr_flags);"}, {"sha": "cc53a2ce328b964fb8d0de38a7207b56ae4a1244", "filename": "gcc/testsuite/g++.dg/ext/attr-parm-1.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc95e478febd35e0d1fb13c1833d2383ad0e7d18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fattr-parm-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc95e478febd35e0d1fb13c1833d2383ad0e7d18/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fattr-parm-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fattr-parm-1.C?ref=bc95e478febd35e0d1fb13c1833d2383ad0e7d18", "patch": "@@ -0,0 +1,6 @@\n+// { dg-do compile { target { { i?86-*-* x86_64-*-* } && ia32 } } }\n+// PR 94946\n+class a {\n+  template <typename b> a(b (*)());\n+  template <typename b> a(b(__attribute__((fastcall)) *c)());\n+};"}]}