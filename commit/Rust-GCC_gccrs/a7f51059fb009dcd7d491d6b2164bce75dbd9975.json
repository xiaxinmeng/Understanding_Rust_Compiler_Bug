{"sha": "a7f51059fb009dcd7d491d6b2164bce75dbd9975", "node_id": "C_kwDOANBUbNoAKGE3ZjUxMDU5ZmIwMDlkY2Q3ZDQ5MWQ2YjIxNjRiY2U3NWRiZDk5NzU", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-11-11T22:36:01Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-11-12T01:29:46Z"}, "message": "libstdc++: Define INSTANTIATE_FACET_ACCESSORS macro in compat source [PR103755]\n\ncompatibility-ldbl-alt128.cc re-includes locale-inst-numeric.h and\nlocale-inst-monetary.h but wasn't defining the macros added in\nr13-3888-gb3ac43a3c05744.\n\nPut those macros in a new internal header that can be included everywhere\nthey're used.\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/103755\n\t* src/c++11/locale-inst-monetary.h: Include new header.\n\t* src/c++11/locale-inst-numeric.h: Likewise.\n\t* src/c++11/locale-inst.cc: Likewise.\n\t(INSTANTIATE_USE_FACET, INSTANTIATE_FACET_ACCESSORS): Move\n\tmacro definitions to ...\n\t* src/c++11/facet_inst_macros.h: New file.", "tree": {"sha": "8b7290aeb5acabe0c1a39da610c30d370b589d20", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8b7290aeb5acabe0c1a39da610c30d370b589d20"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7f51059fb009dcd7d491d6b2164bce75dbd9975", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7f51059fb009dcd7d491d6b2164bce75dbd9975", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7f51059fb009dcd7d491d6b2164bce75dbd9975", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7f51059fb009dcd7d491d6b2164bce75dbd9975/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5b6ce16adece24e24a4980a22792b2cb2a84b6d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b6ce16adece24e24a4980a22792b2cb2a84b6d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5b6ce16adece24e24a4980a22792b2cb2a84b6d5"}], "stats": {"total": 33, "additions": 22, "deletions": 11}, "files": [{"sha": "e0a07b1d2f72e9b1efc3d43202d9a7246d22a425", "filename": "libstdc++-v3/src/c++11/facet_inst_macros.h", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Ffacet_inst_macros.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Ffacet_inst_macros.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Ffacet_inst_macros.h?ref=a7f51059fb009dcd7d491d6b2164bce75dbd9975", "patch": "@@ -0,0 +1,17 @@\n+#ifndef _FACET_INST_MACROS_H\n+#define _FACET_INST_MACROS_H\n+\n+// These macros are used for explicit instantiation definitions in src/c++11/\n+\n+#define INSTANTIATE_USE_FACET(...)\t\t\t    \\\n+  template const __VA_ARGS__*\t\t\t\t    \\\n+    __try_use_facet< __VA_ARGS__ >(const locale&) noexcept; \\\n+  template const __VA_ARGS__&\t\t\t\t    \\\n+    use_facet<__VA_ARGS__>(const locale&)\n+\n+#define INSTANTIATE_FACET_ACCESSORS(...)\t\t    \\\n+  INSTANTIATE_USE_FACET(__VA_ARGS__);\t\t\t    \\\n+  template bool\t\t\t\t\t\t    \\\n+    has_facet<__VA_ARGS__>(const locale&) noexcept\n+\n+#endif // _FACET_INST_MACROS_H"}, {"sha": "26b1e33d3a7387e5e12f8408e531c0d03cd4cda7", "filename": "libstdc++-v3/src/c++11/locale-inst-monetary.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst-monetary.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst-monetary.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst-monetary.h?ref=a7f51059fb009dcd7d491d6b2164bce75dbd9975", "patch": "@@ -26,6 +26,8 @@\n #define \"This file should not be compiled directly, only included\"\n #endif\n \n+#include \"facet_inst_macros.h\"\n+\n // This header is included multiple times, to instantiate these symbols\n // for char/wchar_t and for both std::string ABIs,\n // and (depending on the target) for two long double formats."}, {"sha": "18514e892afe0846cbaa60470f79b617b82e653d", "filename": "libstdc++-v3/src/c++11/locale-inst-numeric.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst-numeric.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst-numeric.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst-numeric.h?ref=a7f51059fb009dcd7d491d6b2164bce75dbd9975", "patch": "@@ -26,6 +26,8 @@\n #define \"This file should not be compiled directly, only included\"\n #endif\n \n+#include \"facet_inst_macros.h\"\n+\n namespace std _GLIBCXX_VISIBILITY(default)\n {\n #if ! _GLIBCXX_USE_CXX11_ABI"}, {"sha": "6767da74b741ce392ec247f5c39a474ba1a5f59d", "filename": "libstdc++-v3/src/c++11/locale-inst.cc", "status": "modified", "additions": 1, "deletions": 11, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f51059fb009dcd7d491d6b2164bce75dbd9975/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fsrc%2Fc%2B%2B11%2Flocale-inst.cc?ref=a7f51059fb009dcd7d491d6b2164bce75dbd9975", "patch": "@@ -43,19 +43,9 @@\n # define C_is_char\n #endif\n \n-#define INSTANTIATE_USE_FACET(...)\t\t\t    \\\n-  template const __VA_ARGS__*\t\t\t\t    \\\n-    __try_use_facet< __VA_ARGS__ >(const locale&) noexcept; \\\n-  template const __VA_ARGS__&\t\t\t\t    \\\n-    use_facet<__VA_ARGS__>(const locale&)\t\t    \\\n-\n-#define INSTANTIATE_FACET_ACCESSORS(...)\t\t    \\\n-  INSTANTIATE_USE_FACET(__VA_ARGS__);\t\t\t    \\\n-  template bool\t\t\t\t\t\t    \\\n-    has_facet<__VA_ARGS__>(const locale&) noexcept\n-\n #include \"locale-inst-numeric.h\"\n #include \"locale-inst-monetary.h\"\n+#include \"facet_inst_macros.h\"\n \n namespace std _GLIBCXX_VISIBILITY(default)\n {"}]}