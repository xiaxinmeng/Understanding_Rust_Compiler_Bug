{"sha": "d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDY5NjEzNDFkZDBlZjM3ZDBjMjkyZDI1ZjdlNDI4YTQyZTIyYjBjMA==", "commit": {"author": {"name": "Andrew Cagney", "email": "ac131313@redhat.com", "date": "2002-03-23T16:33:44Z"}, "committer": {"name": "Andrew Cagney", "email": "cagney@gcc.gnu.org", "date": "2002-03-23T16:33:44Z"}, "message": "[multiple changes]\n\n2002-03-23  Andrew Cagney  <ac131313@redhat.com>\n\n\t* doc/invoke.texi (Option Summary): Mention -Wswitch-default.\n\t(Warning Options): Document -Wswitch-default.\n\t* toplev.c (W_options): Add -Wswitch-default.  Update comment on\n\t-Wswitch.\n\t(warn_switch_default): Define variable.\n\t(warn_switch): Update comment.\n\t* flags.h (warn_switch_default): Declare variable.\n\t(warn_switch): Update comment.\n\t* stmt.c (expand_end_case): Check for and, when\n\twarn_switch_no_default, warn of a missing default case.\n\nIndex: f/ChangeLog\nSat Mar 23 11:18:17 2002  Andrew Cagney  <ac131313@redhat.com>\n\n\t* invoke.texi (Warning Options): Mention -Wswitch-default.\n\nIndex: testsuite/ChangeLog\n2002-03-23  Andrew Cagney  <ac131313@redhat.com>\n\n\t* gcc.dg/Wswitch-default.c: New test.\n\nFrom-SVN: r51238", "tree": {"sha": "40bde56f3c0f0b034afa8251d7b684434a00dddd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/40bde56f3c0f0b034afa8251d7b684434a00dddd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/comments", "author": null, "committer": null, "parents": [{"sha": "c677cd7f47af8d4c2ebc387e4a1d49321bb660a6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c677cd7f47af8d4c2ebc387e4a1d49321bb660a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c677cd7f47af8d4c2ebc387e4a1d49321bb660a6"}], "stats": {"total": 114, "additions": 110, "deletions": 4}, "files": [{"sha": "123ec2760111f1b70028f10ee0e22039fb8b4905", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -1,3 +1,16 @@\n+2002-03-23  Andrew Cagney  <ac131313@redhat.com>\n+\n+\t* doc/invoke.texi (Option Summary): Mention -Wswitch-default.\n+\t(Warning Options): Document -Wswitch-default.\n+\t* toplev.c (W_options): Add -Wswitch-default.  Update comment on\n+\t-Wswitch.\n+\t(warn_switch_default): Define variable.\n+\t(warn_switch): Update comment.\n+\t* flags.h (warn_switch_default): Declare variable.\n+\t(warn_switch): Update comment.\n+\t* stmt.c (expand_end_case): Check for and, when\n+\twarn_switch_no_default, warn of a missing default case.\n+\t\n 2002-03-23  Alan Modra  <amodra@bigpond.net.au>\n \n \t* real.h (N): Special case 128 bit doubles."}, {"sha": "321cda2d239e0b688f5e1de4433c48ce5bc11156", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -228,7 +228,7 @@ in the following sections.\n -Wno-import  -Wpacked  -Wpadded @gol\n -Wparentheses  -Wpointer-arith  -Wredundant-decls @gol\n -Wreturn-type  -Wsequence-point  -Wshadow @gol\n--Wsign-compare  -Wswitch  -Wsystem-headers @gol\n+-Wsign-compare  -Wswitch  -Wswitch-default  -Wsystem-headers @gol\n -Wtrigraphs  -Wundef  -Wuninitialized @gol\n -Wunknown-pragmas  -Wunreachable-code @gol\n -Wunused  -Wunused-function  -Wunused-label  -Wunused-parameter @gol\n@@ -2034,6 +2034,11 @@ enumeration.  (The presence of a @code{default} label prevents this\n warning.)  @code{case} labels outside the enumeration range also\n provoke warnings when this option is used.\n \n+@item -Wswitch-default\n+@opindex Wswitch-switch\n+Warn whenever a @code{switch} statement does not have a @code{default}\n+case.\n+\n @item -Wtrigraphs\n @opindex Wtrigraphs\n Warn if any trigraphs are encountered that might change the meaning of"}, {"sha": "9f2016c73f17104f6a5b6a9d98a8cbb8e45ab1dc", "filename": "gcc/f/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ff%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ff%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2FChangeLog?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -1,3 +1,7 @@\n+Sat Mar 23 11:18:17 2002  Andrew Cagney  <ac131313@redhat.com>\n+\n+\t* invoke.texi (Warning Options): Mention -Wswitch-default.\n+\n Thu Mar 21 18:55:41 2002  Neil Booth  <neil@daikokuya.demon.co.uk>\n \n \t* cp-tree.h (pushdecl, pushlevel, poplevel, set_block,"}, {"sha": "025fb9ed7d1a2bc12c12637a573222f42757c7d5", "filename": "gcc/f/invoke.texi", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ff%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ff%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2Finvoke.texi?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -1356,6 +1356,9 @@ Some of these have no effect when compiling programs written in Fortran:\n @cindex -Wswitch option\n @cindex options, -Wswitch\n @item -Wswitch\n+@cindex -Wswitch-default option\n+@cindex options, -Wswitch-default\n+@item -Wswitch-default\n @cindex -Wtraditional option\n @cindex options, -Wtraditional\n @item -Wtraditional"}, {"sha": "ee9753a943b4ed6286d00701bbb5ff1eab4a6daf", "filename": "gcc/flags.h", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Fflags.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Fflags.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fflags.h?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -126,10 +126,15 @@ extern int warn_unknown_pragmas;\n \n extern int warn_shadow;\n \n-/* Warn if a switch on an enum fails to have a case for every enum value.  */\n+/* Warn if a switch on an enum, that does not have a default case,\n+   fails to have a case for every enum value.  */\n \n extern int warn_switch;\n \n+/* Warn if a switch does not have a default case.  */\n+\n+extern int warn_switch_default;\n+\n /* Nonzero means warn about function definitions that default the return type\n    or that use a null return and have a return-type other than void.  */\n "}, {"sha": "6da3fab27ce71dad4a9cece062be0a614c20c494", "filename": "gcc/stmt.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Fstmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Fstmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstmt.c?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -5284,6 +5284,9 @@ expand_end_case_type (orig_index, orig_type)\n \t  && TREE_CODE (index_expr) != INTEGER_CST)\n \tcheck_for_full_enumeration_handling (orig_type);\n \n+      if (warn_switch_default && !thiscase->data.case_stmt.default_label)\n+\twarning (\"switch missing default case\");\n+\n       /* If we don't have a default-label, create one here,\n \t after the body of the switch.  */\n       if (thiscase->data.case_stmt.default_label == 0)"}, {"sha": "c6bfa0dd08f5a3e20788ee8cd02c2e9a05d30ccc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -1,3 +1,7 @@\n+2002-03-23  Andrew Cagney  <ac131313@redhat.com>\n+\n+\t* gcc.dg/Wswitch-default.c: New test.\n+\n 2002-03-23  Jakub Jelinek  <jakub@redhat.com>\n \n \t* g++.dg/other/enum1.C: New test."}, {"sha": "3cc7f2ef0918357606246c58c1bf0f5c78ca0666", "filename": "gcc/testsuite/gcc.dg/Wswitch-default.c", "status": "added", "additions": 62, "deletions": 0, "changes": 62, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ftestsuite%2Fgcc.dg%2FWswitch-default.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ftestsuite%2Fgcc.dg%2FWswitch-default.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2FWswitch-default.c?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -0,0 +1,62 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wswitch-default\" } */\n+\n+enum e { e1, e2 };\n+\n+int\n+foo (int i, int j, enum e ei, enum e ej, enum e ek, enum e el,\n+     enum e em, enum e en, enum e eo, enum e ep)\n+{\n+  switch (i)\n+    {\n+    case 1: return 1;\n+    case 2: return 2;\n+    } /* { dg-warning \"switch missing default case\" } */\n+  switch (j)\n+    {\n+    case 3: return 4;\n+    case 4: return 3;\n+    default: break;\n+    }\n+  switch (ei)\n+    { /* { dg-warning \"switch missing default case\" } */\n+    }\n+  switch (ej)\n+    {\n+    default: break;\n+    }\n+  switch (ek)\n+    {\n+    case e1: return 1;\n+    } /* { dg-warning \"switch missing default case\" } */\n+  switch (el)\n+    {\n+    case e1: return 1;\n+    default: break;\n+    }\n+  switch (em)\n+    {\n+    case e1: return 1;\n+    case e2: return 2;\n+    } /* { dg-warning \"switch missing default case\" } */\n+  switch (en)\n+    {\n+    case e1: return 1;\n+    case e2: return 2;\n+    default: break;\n+    }\n+  switch (eo)\n+    {\n+    case e1: return 1;\n+    case e2: return 2;\n+    case 3: return 3;\n+    } /* { dg-warning \"switch missing default case\" } */\n+  switch (ep)\n+    {\n+    case e1: return 1;\n+    case e2: return 2;\n+    case 3: return 3;\n+    default: break;\n+    }\n+  return 0;\n+}"}, {"sha": "d09f58c0facfd96dde9bfc038252039085ad3d1e", "filename": "gcc/toplev.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6961341dd0ef37d0c292d25f7e428a42e22b0c0/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=d6961341dd0ef37d0c292d25f7e428a42e22b0c0", "patch": "@@ -1395,10 +1395,15 @@ int warn_uninitialized;\n \n int warn_shadow;\n \n-/* Warn if a switch on an enum fails to have a case for every enum value.  */\n+/* Warn if a switch on an enum, that does not have a default case,\n+   fails to have a case for every enum value.  */\n \n int warn_switch;\n \n+/* Warn if a switch does not have a default case.  */\n+\n+int warn_switch_default;\n+\n /* Nonzero means warn about function definitions that default the return type\n    or that use a null return and have a return-type other than void.  */\n \n@@ -1468,7 +1473,9 @@ static const lang_independent_options W_options[] =\n   {\"shadow\", &warn_shadow, 1,\n    N_(\"Warn when one local variable shadows another\") },\n   {\"switch\", &warn_switch, 1,\n-   N_(\"Warn about enumerated switches missing a specific case\") },\n+   N_(\"Warn about enumerated switches, with no default, missing a case\") },\n+  {\"switch-default\", &warn_switch_default, 1,\n+   N_(\"Warn about enumerated switches missing a default case\") },\n   {\"aggregate-return\", &warn_aggregate_return, 1,\n    N_(\"Warn about returning structures, unions or arrays\") },\n   {\"cast-align\", &warn_cast_align, 1,"}]}