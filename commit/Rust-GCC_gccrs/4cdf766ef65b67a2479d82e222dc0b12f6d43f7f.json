{"sha": "4cdf766ef65b67a2479d82e222dc0b12f6d43f7f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGNkZjc2NmVmNjViNjdhMjQ3OWQ4MmUyMjJkYzBiMTJmNmQ0M2Y3Zg==", "commit": {"author": {"name": "Francois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2007-11-08T19:19:50Z"}, "committer": {"name": "Fran\u00e7ois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2007-11-08T19:19:50Z"}, "message": "re PR debug/33739 (Failure of gfortran.dg/literal_character_constant_1_*.F with -m64 -g on Darwin)\n\n\tPR fortran/33739\n\t* scanner.c (start_source_file, end_source_file,\n\texit_remaining_files): New functions.\n\t(gfc_advance_line): Use the new functions.\n\nFrom-SVN: r130016", "tree": {"sha": "093ca7e9e5c8fa4f11db0934ed92e173a7487a56", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/093ca7e9e5c8fa4f11db0934ed92e173a7487a56"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f/comments", "author": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "committer": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "66ec5f8742ac9a9bc6401886f3e81ed61ef974f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66ec5f8742ac9a9bc6401886f3e81ed61ef974f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66ec5f8742ac9a9bc6401886f3e81ed61ef974f1"}], "stats": {"total": 63, "additions": 57, "deletions": 6}, "files": [{"sha": "4306a92078d8c36c677d103993b5401237da5808", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=4cdf766ef65b67a2479d82e222dc0b12f6d43f7f", "patch": "@@ -1,3 +1,10 @@\n+2007-11-08  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n+\n+\tPR fortran/33739\n+\t* scanner.c (start_source_file, end_source_file,\n+\texit_remaining_files): New functions.\n+\t(gfc_advance_line): Use the new functions.\n+\n 2007-11-08  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/34028"}, {"sha": "89aef49b086e110e5eb3453f434fcf7fdfc8bb09", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 50, "deletions": 6, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4cdf766ef65b67a2479d82e222dc0b12f6d43f7f/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=4cdf766ef65b67a2479d82e222dc0b12f6d43f7f", "patch": "@@ -300,13 +300,59 @@ gfc_at_eol (void)\n }\n \n \n+struct file_entered_chainon\n+{\n+  gfc_file *file;\n+  struct file_entered_chainon *prev;\n+};\n+\n+static struct file_entered_chainon *last_file_entered = NULL;\n+\n+static void\n+start_source_file (int line, gfc_file *file)\n+{\n+  struct file_entered_chainon *f = gfc_getmem (sizeof\n+                                       (struct file_entered_chainon));\n+\n+  f->file = file;\n+  f->prev = last_file_entered;\n+  last_file_entered = f;\n+\n+  (*debug_hooks->start_source_file) (line, file->filename);\n+}\n+\n+static void\n+end_source_file (int line)\n+{\n+  gcc_assert (last_file_entered);\n+  last_file_entered = last_file_entered->prev;\n+  (*debug_hooks->end_source_file) (line);\n+}\n+\n+static void\n+exit_remaining_files (void)\n+{\n+  struct file_entered_chainon *f = last_file_entered;\n+  while (f)\n+    {\n+      /* The line number doesn't matter much, because we're at the end of\n+         the toplevel file anyway.  */\n+      (*debug_hooks->end_source_file) (0);\n+\n+      f = f->prev;\n+    }\n+}\n+\n /* Advance the current line pointer to the next line.  */\n \n void\n gfc_advance_line (void)\n {\n   if (gfc_at_end ())\n-    return;\n+    {\n+      exit_remaining_files ();\n+      return;\n+    }\n \n   if (gfc_current_locus.lb == NULL) \n     {\n@@ -322,17 +368,15 @@ gfc_advance_line (void)\n \t  && gfc_current_locus.lb->file->up == gfc_current_locus.lb->next->file)\n \t{\n \t  /* We exit from an included file. */\n-\t  (*debug_hooks->end_source_file)\n-\t\t(gfc_linebuf_linenum (gfc_current_locus.lb->next));\n+\t  end_source_file (gfc_linebuf_linenum (gfc_current_locus.lb->next));\n \t  gfc_current_locus.lb->next->dbg_emitted = true;\n \t}\n       else if (gfc_current_locus.lb->next->file != gfc_current_locus.lb->file\n \t       && !gfc_current_locus.lb->next->dbg_emitted)\n \t{\n \t  /* We enter into a new file.  */\n-\t  (*debug_hooks->start_source_file)\n-\t\t(gfc_linebuf_linenum (gfc_current_locus.lb),\n-\t\t gfc_current_locus.lb->next->file->filename);\n+\t  start_source_file (gfc_linebuf_linenum (gfc_current_locus.lb),\n+\t\t\t     gfc_current_locus.lb->next->file);\n \t  gfc_current_locus.lb->next->dbg_emitted = true;\n \t}\n     }"}]}