{"sha": "e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTFiODFmMmJhMDAwYTYxYTNkODQ1ZjBkM2JiMDM4YjYyZDQzNjczZg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2016-02-01T22:36:07Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2016-02-01T22:36:07Z"}, "message": "re PR preprocessor/69543 (_Pragma does not apply within macro)\n\n\tPR preprocessor/69543\n\tPR c/69558\n\t* c-pragma.c (handle_pragma_diagnostic): Pass input_location\n\tinstead of loc to control_warning_option.\n\n\t* gcc.dg/pr69543.c: New test.\n\t* gcc.dg/pr69558.c: New test.\n\nFrom-SVN: r233058", "tree": {"sha": "4804a0cc9d344020d642b070a4d01995e66ec630", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4804a0cc9d344020d642b070a4d01995e66ec630"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bf672ee50f33f845c71a456984b9faf10e86b407", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf672ee50f33f845c71a456984b9faf10e86b407", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf672ee50f33f845c71a456984b9faf10e86b407"}], "stats": {"total": 54, "additions": 53, "deletions": 1}, "files": [{"sha": "abe970193ffef4649290e5510824998f21156a39", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "patch": "@@ -1,3 +1,10 @@\n+2016-02-01  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR preprocessor/69543\n+\tPR c/69558\n+\t* c-pragma.c (handle_pragma_diagnostic): Pass input_location\n+\tinstead of loc to control_warning_option.\n+\n 2016-02-01  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* c.opt (fopenacc-dim=): New option."}, {"sha": "38aabc0ddcc41c0e55d09745b8c0ad52ade9640b", "filename": "gcc/c-family/c-pragma.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Fc-family%2Fc-pragma.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Fc-family%2Fc-pragma.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-pragma.c?ref=e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "patch": "@@ -817,9 +817,12 @@ handle_pragma_diagnostic(cpp_reader *ARG_UNUSED(dummy))\n   const char *arg = NULL;\n   if (cl_options[option_index].flags & CL_JOINED)\n     arg = option_string + 1 + cl_options[option_index].opt_len;\n+  /* FIXME: input_location isn't the best location here, but it is\n+     what we used to do here before and changing it breaks e.g.\n+     PR69543 and PR69558.  */\n   control_warning_option (option_index, (int) kind,\n \t\t\t  arg, kind != DK_IGNORED,\n-\t\t\t  loc, lang_mask, &handlers,\n+\t\t\t  input_location, lang_mask, &handlers,\n \t\t\t  &global_options, &global_options_set,\n \t\t\t  global_dc);\n }"}, {"sha": "73b0ce8e55e099568010c5daaa25567b1f9f59cb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "patch": "@@ -1,3 +1,10 @@\n+2016-02-01  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR preprocessor/69543\n+\tPR c/69558\n+\t* gcc.dg/pr69543.c: New test.\n+\t* gcc.dg/pr69558.c: New test.\n+\n 2016-02-01  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR testsuite/65940"}, {"sha": "0bb5da0aae0da3e050fbbcaddfd608bac748676f", "filename": "gcc/testsuite/gcc.dg/pr69543.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Ftestsuite%2Fgcc.dg%2Fpr69543.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Ftestsuite%2Fgcc.dg%2Fpr69543.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr69543.c?ref=e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "patch": "@@ -0,0 +1,18 @@\n+/* PR preprocessor/69543 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -Wuninitialized\" } */\n+\n+# define YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN \\\n+    _Pragma (\"GCC diagnostic push\") \\\n+    _Pragma (\"GCC diagnostic ignored \\\"-Wuninitialized\\\"\")\\\n+    _Pragma (\"GCC diagnostic ignored \\\"-Wmaybe-uninitialized\\\"\")\n+# define YY_IGNORE_MAYBE_UNINITIALIZED_END \\\n+    _Pragma (\"GCC diagnostic pop\")\n+\n+void test (char yylval)\n+{\n+  char *yyvsp;\n+  YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN\n+  *++yyvsp = yylval;\n+  YY_IGNORE_MAYBE_UNINITIALIZED_END\n+}"}, {"sha": "3be8cf9d96533cdd6894fbe881dfeb83852b00a0", "filename": "gcc/testsuite/gcc.dg/pr69558.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Ftestsuite%2Fgcc.dg%2Fpr69558.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e1b81f2ba000a61a3d845f0d3bb038b62d43673f/gcc%2Ftestsuite%2Fgcc.dg%2Fpr69558.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr69558.c?ref=e1b81f2ba000a61a3d845f0d3bb038b62d43673f", "patch": "@@ -0,0 +1,17 @@\n+/* PR c/69558 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wdeprecated-declarations\" } */\n+\n+#define A \\\n+  _Pragma (\"GCC diagnostic push\") \\\n+  _Pragma (\"GCC diagnostic ignored \\\"-Wdeprecated-declarations\\\"\")\n+#define B \\\n+  _Pragma (\"GCC diagnostic pop\")\n+#define C(x) \\\n+  A \\\n+  static inline void bar (void) { x (); } \\\n+  B\n+\n+__attribute__((deprecated)) void foo (void); /* { dg-bogus \"declared here\" } */\n+\n+C (foo) /* { dg-bogus \"is deprecated\" } */"}]}