{"sha": "3425638af52c359b893547b9dcde5cccd1bb67ac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzQyNTYzOGFmNTJjMzU5Yjg5MzU0N2I5ZGNkZTVjY2NkMWJiNjdhYw==", "commit": {"author": {"name": "James A. Morrison", "email": "phython@gcc.gnu.org", "date": "2005-04-06T21:22:02Z"}, "committer": {"name": "James A. Morrison", "email": "phython@gcc.gnu.org", "date": "2005-04-06T21:22:02Z"}, "message": "c-common.c (handle_malloc_atttribute): Only set DECL_IS_MALLOC if the function returns a pointer type.\n\n2005-04-06  James A. Morrison  <phython@gcc.gnu.org>\n\n        * c-common.c (handle_malloc_atttribute): Only set DECL_IS_MALLOC if\n        the function returns a pointer type.\n\nFrom-SVN: r97751", "tree": {"sha": "c13d1c358e9b4295a74856f820ffd37c7785c650", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c13d1c358e9b4295a74856f820ffd37c7785c650"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3425638af52c359b893547b9dcde5cccd1bb67ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3425638af52c359b893547b9dcde5cccd1bb67ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3425638af52c359b893547b9dcde5cccd1bb67ac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3425638af52c359b893547b9dcde5cccd1bb67ac/comments", "author": null, "committer": null, "parents": [{"sha": "53ae8e14b24bcaf60acdc0d8ee6683ea741cee13", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53ae8e14b24bcaf60acdc0d8ee6683ea741cee13", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53ae8e14b24bcaf60acdc0d8ee6683ea741cee13"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "8751369fa8a3e1c504d6372eeb890d10aa141eef", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3425638af52c359b893547b9dcde5cccd1bb67ac", "patch": "@@ -1,3 +1,8 @@\n+2005-04-06  James A. Morrison  <phython@gcc.gnu.org>\n+\n+\t* c-common.c (handle_malloc_atttribute): Only set DECL_IS_MALLOC if\n+\tthe function returns a pointer type.\n+\n 2005-04-06  Daniel Berlin  <dberlin@dberlin.org>\n \n \t* params.def (PARAM_SALIAS_MAX_IMPLICIT_FIELDS): New"}, {"sha": "f68c8532ebe87b76354d95f45bde066a9fd2f2b1", "filename": "gcc/c-common.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=3425638af52c359b893547b9dcde5cccd1bb67ac", "patch": "@@ -4808,9 +4808,9 @@ static tree\n handle_malloc_attribute (tree *node, tree name, tree ARG_UNUSED (args),\n \t\t\t int ARG_UNUSED (flags), bool *no_add_attrs)\n {\n-  if (TREE_CODE (*node) == FUNCTION_DECL)\n+  if (TREE_CODE (*node) == FUNCTION_DECL\n+      && POINTER_TYPE_P (TREE_TYPE (TREE_TYPE (*node))))\n     DECL_IS_MALLOC (*node) = 1;\n-  /* ??? TODO: Support types.  */\n   else\n     {\n       warning (\"%qE attribute ignored\", name);"}, {"sha": "2b354af1a75de44873fd873a6fa4ceac728a1221", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3425638af52c359b893547b9dcde5cccd1bb67ac", "patch": "@@ -1,3 +1,8 @@\n+2005-04-06  James A. Morrison  <phython@gcc.gnu.org>\n+\n+\t* gcc.dg/15443-1.c: New test.\n+\t* gcc.dg/15443-2.c: Likewise.\n+\n 2005-04-06  Tobias Schl\"uter  <tobias.schlueter@physik.uni-muenchen.de>\n \n \t* gfortran.dg/pr15754.f90: Change annotations to dg-error."}, {"sha": "d6106b5b353688888b51efbde9369ed2f516c4c0", "filename": "gcc/testsuite/gcc.dg/pr15443-1.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Ftestsuite%2Fgcc.dg%2Fpr15443-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Ftestsuite%2Fgcc.dg%2Fpr15443-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr15443-1.c?ref=3425638af52c359b893547b9dcde5cccd1bb67ac", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+\n+void f () __attribute__ ((__malloc__)); /* { dg-warning \"ignored\" } */\n+\n+int main ()\n+{\n+\t/* This used to cause an ICE.  */\n+\tf ();\n+}\n+"}, {"sha": "d97fa2573ac335771c72ff01b3823942b6a7f14c", "filename": "gcc/testsuite/gcc.dg/pr15443-2.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Ftestsuite%2Fgcc.dg%2Fpr15443-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3425638af52c359b893547b9dcde5cccd1bb67ac/gcc%2Ftestsuite%2Fgcc.dg%2Fpr15443-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr15443-2.c?ref=3425638af52c359b893547b9dcde5cccd1bb67ac", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile } */\n+\n+struct foo {\n+\tint bar;\n+};\n+\n+typedef struct foo* bar;\n+void f () __attribute__ ((__malloc__)); /* { dg-warning \"ignored\" } */\n+int g () __attribute__ ((__malloc__)); /* { dg-warning \"ignored\" } */\n+int* h () __attribute__ ((__malloc__));\n+void* i () __attribute__ ((__malloc__));\n+\n+struct foo j () __attribute__ ((__malloc__)); /* { dg-warning \"ignored\" } */\n+struct foo* k () __attribute__ ((__malloc__));\n+bar l () __attribute__((malloc));"}]}