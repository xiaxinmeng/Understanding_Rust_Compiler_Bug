{"sha": "789a4ea32a5d73f65f75f61c5c846f5b9fc67461", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzg5YTRlYTMyYTVkNzNmNjVmNzVmNjFjNWM4NDZmNWI5ZmM2NzQ2MQ==", "commit": {"author": {"name": "Mike Stump", "email": "mrs@apple.com", "date": "2004-07-08T00:12:27Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2004-07-08T00:12:27Z"}, "message": "darwin.h (ASM_OUTPUT_LABELREF): Fix -fno-leading-underscore.\n\n\t* darwin.h (ASM_OUTPUT_LABELREF): Fix -fno-leading-underscore.\n\t* darwin.c (machopic_non_lazy_ptr_name, machopic_stub_name)\n\t(machopic_finish): Likewise.\n\nFrom-SVN: r84245", "tree": {"sha": "5a329264a977068dbe3db0253e13ffdbd066955a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5a329264a977068dbe3db0253e13ffdbd066955a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/789a4ea32a5d73f65f75f61c5c846f5b9fc67461", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/789a4ea32a5d73f65f75f61c5c846f5b9fc67461", "html_url": "https://github.com/Rust-GCC/gccrs/commit/789a4ea32a5d73f65f75f61c5c846f5b9fc67461", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/789a4ea32a5d73f65f75f61c5c846f5b9fc67461/comments", "author": null, "committer": null, "parents": [{"sha": "d969ee71f438becde51c7ddb267b30f51329a7f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d969ee71f438becde51c7ddb267b30f51329a7f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d969ee71f438becde51c7ddb267b30f51329a7f1"}], "stats": {"total": 26, "additions": 17, "deletions": 9}, "files": [{"sha": "224e26a27c4986b252f0e737563bd3239a748397", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/789a4ea32a5d73f65f75f61c5c846f5b9fc67461/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/789a4ea32a5d73f65f75f61c5c846f5b9fc67461/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=789a4ea32a5d73f65f75f61c5c846f5b9fc67461", "patch": "@@ -1,3 +1,9 @@\n+2004-07-07  Mike Stump  <mrs@apple.com>\n+\n+\t* darwin.h (ASM_OUTPUT_LABELREF): Fix -fno-leading-underscore.\n+\t* darwin.c (machopic_non_lazy_ptr_name, machopic_stub_name) \n+\t(machopic_finish): Likewise.\n+\n 2004-07-07  Richard Henderson  <rth@redhat.com>\n \n \t* tree-ssa-dom.c (simplify_switch_and_lookup_avail_expr): Look"}, {"sha": "17d7fb77f030b839949eeea217c122b29d4c6603", "filename": "gcc/config/darwin.c", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/789a4ea32a5d73f65f75f61c5c846f5b9fc67461/gcc%2Fconfig%2Fdarwin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/789a4ea32a5d73f65f75f61c5c846f5b9fc67461/gcc%2Fconfig%2Fdarwin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.c?ref=789a4ea32a5d73f65f75f61c5c846f5b9fc67461", "patch": "@@ -308,9 +308,10 @@ machopic_non_lazy_ptr_name (const char *name)\n       }\n     else\n       {\n-\tbuffer[bufferlen] = '_';\n-\tmemcpy (buffer + bufferlen +1, name, namelen+1);\n-        bufferlen += namelen +1;\n+\tstrcpy (buffer + bufferlen, user_label_prefix);\n+\tbufferlen += strlen (user_label_prefix);\n+\tmemcpy (buffer + bufferlen, name, namelen+1);\n+        bufferlen += namelen;\n       }\n \n     memcpy (buffer + bufferlen, \"$non_lazy_ptr\", strlen(\"$non_lazy_ptr\")+1);\n@@ -383,9 +384,10 @@ machopic_stub_name (const char *name)\n       }\n     else\n       {\n-\tbuffer[bufferlen] = '_';\n-\tmemcpy (buffer + bufferlen +1, name, namelen+1);\n-        bufferlen += namelen +1;\n+\tstrcpy (buffer + bufferlen, user_label_prefix);\n+\tbufferlen += strlen (user_label_prefix);\n+\tmemcpy (buffer + bufferlen, name, namelen+1);\n+        bufferlen += namelen;\n       }\n \n     if (needs_quotes)\n@@ -909,13 +911,13 @@ machopic_finish (FILE *asm_out_file)\n       else if (sym_name[0] == '-' || sym_name[0] == '+')\n \tstrcpy (sym, sym_name);\n       else\n-\tsym[0] = '_', strcpy (sym + 1, sym_name);\n+\tsprintf (sym, \"%s%s\", user_label_prefix, sym_name);\n \n       stub = alloca (strlen (stub_name) + 2);\n       if (stub_name[0] == '*' || stub_name[0] == '&')\n \tstrcpy (stub, stub_name + 1);\n       else\n-\tstub[0] = '_', strcpy (stub + 1, stub_name);\n+\tsprintf (stub, \"%s%s\", user_label_prefix, stub_name);\n \n       machopic_output_stub (asm_out_file, sym, stub);\n     }"}, {"sha": "7f6e8dcf8b887416260e40ff64b5e5a63dc6ea44", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/789a4ea32a5d73f65f75f61c5c846f5b9fc67461/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/789a4ea32a5d73f65f75f61c5c846f5b9fc67461/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=789a4ea32a5d73f65f75f61c5c846f5b9fc67461", "patch": "@@ -493,7 +493,7 @@ do { text_section ();\t\t\t\t\t\t\t\\\n        else if (!strncmp (xname, \".objc_class_name_\", 17))\t\t     \\\n \t fprintf (FILE, \"%s\", xname);\t\t\t\t\t     \\\n        else\t\t\t\t\t\t\t\t     \\\n-         fprintf (FILE, \"_%s\", xname);\t\t\t\t\t     \\\n+         asm_fprintf (FILE, \"%U%s\", xname);\t\t\t\t     \\\n   } while (0)\n \n /* Output before executable code.  */"}]}