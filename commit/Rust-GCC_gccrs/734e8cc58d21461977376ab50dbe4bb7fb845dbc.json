{"sha": "734e8cc58d21461977376ab50dbe4bb7fb845dbc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzM0ZThjYzU4ZDIxNDYxOTc3Mzc2YWI1MGRiZTRiYjdmYjg0NWRiYw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mmitchell@usa.net", "date": "1998-03-26T10:26:43Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "1998-03-26T10:26:43Z"}, "message": "call.c (build_object_call): Complain about ambiguous operator(), rather that crashing.\n\n\t* call.c (build_object_call): Complain about ambiguous operator(),\n\trather that crashing.\n\t(build_new_op): Likewise.\n\t(build_op_delete_call): Likewise.\n\nFrom-SVN: r18839", "tree": {"sha": "9cdea081ec25a3df69ca00e4a7953aaa984c5608", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9cdea081ec25a3df69ca00e4a7953aaa984c5608"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/734e8cc58d21461977376ab50dbe4bb7fb845dbc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/734e8cc58d21461977376ab50dbe4bb7fb845dbc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/734e8cc58d21461977376ab50dbe4bb7fb845dbc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/734e8cc58d21461977376ab50dbe4bb7fb845dbc/comments", "author": null, "committer": null, "parents": [{"sha": "17b75c9182d0201a0cc1362c5f0ab1fcddb02c5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/17b75c9182d0201a0cc1362c5f0ab1fcddb02c5d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/17b75c9182d0201a0cc1362c5f0ab1fcddb02c5d"}], "stats": {"total": 58, "additions": 55, "deletions": 3}, "files": [{"sha": "a7ad3374308f4ba1c322b1afbc3fc7568db2d76a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/734e8cc58d21461977376ab50dbe4bb7fb845dbc/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/734e8cc58d21461977376ab50dbe4bb7fb845dbc/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=734e8cc58d21461977376ab50dbe4bb7fb845dbc", "patch": "@@ -1,3 +1,10 @@\n+Thu Mar 26 10:24:05 1998  Mark Mitchell  <mmitchell@usa.net>\n+\n+\t* call.c (build_object_call): Complain about ambiguous operator(),\n+\trather that crashing.\n+\t(build_new_op): Likewise.\n+\t(build_op_delete_call): Likewise.\n+\n Thu Mar 26 10:23:24 1998  Mark Mitchell  <mmitchell@usa.net>\n \n \t* cvt.c (perform_qualification_conversions): Use comp_target_types"}, {"sha": "880fce419ae81bde991265f314a0bbbd2565bacc", "filename": "gcc/cp/call.c", "status": "modified", "additions": 20, "deletions": 3, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/734e8cc58d21461977376ab50dbe4bb7fb845dbc/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/734e8cc58d21461977376ab50dbe4bb7fb845dbc/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=734e8cc58d21461977376ab50dbe4bb7fb845dbc", "patch": "@@ -2288,7 +2288,9 @@ build_object_call (obj, args)\n       return error_mark_node;\n     }\n \n-  fns = lookup_fnfields (TYPE_BINFO (type), ansi_opname [CALL_EXPR], 0);\n+  fns = lookup_fnfields (TYPE_BINFO (type), ansi_opname [CALL_EXPR], 1);\n+  if (fns == error_mark_node)\n+    return error_mark_node;\n \n   args = resolve_args (args);\n \n@@ -2568,7 +2570,11 @@ build_new_op (code, flags, arg1, arg2, arg3)\n     }\n \n   if (IS_AGGR_TYPE (TREE_TYPE (arg1)))\n-    fns = lookup_fnfields (TYPE_BINFO (TREE_TYPE (arg1)), fnname, 0);\n+    {\n+      fns = lookup_fnfields (TYPE_BINFO (TREE_TYPE (arg1)), fnname, 1);\n+      if (fns == error_mark_node)\n+\treturn fns;\n+    }\n   else\n     fns = NULL_TREE;\n \n@@ -2862,7 +2868,18 @@ build_op_delete_call (code, addr, size, flags)\n   fnname = ansi_opname[code];\n \n   if (IS_AGGR_TYPE (type) && ! (flags & LOOKUP_GLOBAL))\n-    fns = lookup_fnfields (TYPE_BINFO (type), fnname, 0);\n+    /* In [class.free]\n+\n+       If the result of the lookup is ambiguous or inaccessible, or if\n+       the lookup selects a placement deallocation function, the\n+       program is ill-formed.\n+  \n+       Therefore, we ask lookup_fnfields to complain ambout ambiguity.  */\n+    {\n+      fns = lookup_fnfields (TYPE_BINFO (type), fnname, 1);\n+      if (fns == error_mark_node)\n+\treturn error_mark_node;\n+    }\n   else\n     fns = NULL_TREE;\n "}, {"sha": "04e4afa1205bcd69834433014d898ad5745ebb03", "filename": "gcc/testsuite/g++.old-deja/g++.other/ambig1.C", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/734e8cc58d21461977376ab50dbe4bb7fb845dbc/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fambig1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/734e8cc58d21461977376ab50dbe4bb7fb845dbc/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fambig1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fambig1.C?ref=734e8cc58d21461977376ab50dbe4bb7fb845dbc", "patch": "@@ -0,0 +1,28 @@\n+// Build don't link:\n+\n+struct A {\n+  int operator ++();\n+  void operator ()();\n+  void operator delete(void*);\n+};\n+\n+struct B {\n+  int operator ++(int);\n+  void operator ()();\n+  void operator delete(void*);\n+  void f();\n+};\n+\n+struct C : public A, public B {\n+};\n+\n+void f()\n+{\n+  C c;\n+  C* cp;\n+  \n+  delete cp; // ERROR - ambiguous\n+  c(); // ERROR - ambiguous\n+  c++; // ERROR - ambiguous\n+}\n+  "}]}