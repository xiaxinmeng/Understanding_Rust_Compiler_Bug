{"sha": "113ab41c059d6a3aa137c11b8e582c39a6bdc100", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTEzYWI0MWMwNTlkNmEzYWExMzdjMTFiOGU1ODJjMzlhNmJkYzEwMA==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2007-04-27T21:50:04Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2007-04-27T21:50:04Z"}, "message": "tree-ssa-forwprop.c (forward_propagate_into_cond): Keep track if we simplified anything.\n\n2007-04-27  Richard Guenther  <rguenther@suse.de>\n\n\t* tree-ssa-forwprop.c (forward_propagate_into_cond): Keep track\n\tif we simplified anything.\n\t(tree_ssa_forward_propagate_single_use_vars): Defer overflow\n\twarnings until we did a simplification and the stmt was not\n\tmarked as TREE_NO_WARNING.\n\nFrom-SVN: r124242", "tree": {"sha": "38c60ebe4613071684a8bf4936b1a59787dd94a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/38c60ebe4613071684a8bf4936b1a59787dd94a0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/113ab41c059d6a3aa137c11b8e582c39a6bdc100", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/113ab41c059d6a3aa137c11b8e582c39a6bdc100", "html_url": "https://github.com/Rust-GCC/gccrs/commit/113ab41c059d6a3aa137c11b8e582c39a6bdc100", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/113ab41c059d6a3aa137c11b8e582c39a6bdc100/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bfa455647cba43366288cfa3993843142af6af7a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfa455647cba43366288cfa3993843142af6af7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bfa455647cba43366288cfa3993843142af6af7a"}], "stats": {"total": 33, "additions": 28, "deletions": 5}, "files": [{"sha": "8363fbc350fcf76d90bdf8e6b96c8786a2603e91", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/113ab41c059d6a3aa137c11b8e582c39a6bdc100/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/113ab41c059d6a3aa137c11b8e582c39a6bdc100/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=113ab41c059d6a3aa137c11b8e582c39a6bdc100", "patch": "@@ -1,3 +1,11 @@\n+2007-04-27  Richard Guenther  <rguenther@suse.de>\n+\n+\t* tree-ssa-forwprop.c (forward_propagate_into_cond): Keep track\n+\tif we simplified anything.\n+\t(tree_ssa_forward_propagate_single_use_vars): Defer overflow\n+\twarnings until we did a simplification and the stmt was not\n+\tmarked as TREE_NO_WARNING.\n+\n 2007-04-27  Mike Stump  <mrs@apple.com>\n \n \t* config/rs6000/darwin.h (ALWAYS_PUSH_CONSTS_USING_REGS_P): Remove."}, {"sha": "860a4c4da680db33b9bcf1b88963edcbde535d35", "filename": "gcc/tree-ssa-forwprop.c", "status": "modified", "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/113ab41c059d6a3aa137c11b8e582c39a6bdc100/gcc%2Ftree-ssa-forwprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/113ab41c059d6a3aa137c11b8e582c39a6bdc100/gcc%2Ftree-ssa-forwprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-forwprop.c?ref=113ab41c059d6a3aa137c11b8e582c39a6bdc100", "patch": "@@ -372,9 +372,11 @@ combine_cond_expr_cond (enum tree_code code, tree type,\n /* Propagate from the ssa name definition statements of COND_EXPR\n    in statement STMT into the conditional if that simplifies it.  */\n \n-static void\n+static bool\n forward_propagate_into_cond (tree cond_expr, tree stmt)\n {\n+  bool did_something = false;\n+\n   do {\n     tree tmp = NULL_TREE;\n     tree cond = COND_EXPR_COND (cond_expr);\n@@ -407,7 +409,7 @@ forward_propagate_into_cond (tree cond_expr, tree stmt)\n \t    def_stmt = get_prop_source_stmt (name, false, &single_use_p);\n \t    if (def_stmt == NULL_TREE\n \t        || !can_propagate_from (def_stmt))\n-\t      return;\n+\t      return did_something;\n \n \t    rhs = GIMPLE_STMT_OPERAND (def_stmt, 1);\n \t    tmp = combine_cond_expr_cond (TREE_CODE (cond), boolean_type_node,\n@@ -422,7 +424,7 @@ forward_propagate_into_cond (tree cond_expr, tree stmt)\n \tdef_stmt = get_prop_source_stmt (name, true, NULL);\n \tif (def_stmt == NULL_TREE\n \t    || !can_propagate_from (def_stmt))\n-\t  return;\n+\t  return did_something;\n \n \trhs = GIMPLE_STMT_OPERAND (def_stmt, 1);\n \ttmp = combine_cond_expr_cond (NE_EXPR, boolean_type_node, rhs,\n@@ -447,12 +449,16 @@ forward_propagate_into_cond (tree cond_expr, tree stmt)\n \t/* Remove defining statements.  */\n \tremove_prop_source_from_use (name, NULL);\n \n+\tdid_something = true;\n+\n \t/* Continue combining.  */\n \tcontinue;\n       }\n \n     break;\n   } while (1);\n+\n+  return did_something;\n }\n \n /* We've just substituted an ADDR_EXPR into stmt.  Update all the \n@@ -986,7 +992,11 @@ tree_ssa_forward_propagate_single_use_vars (void)\n \t\t}\n               else if (TREE_CODE (rhs) == COND_EXPR)\n                 {\n-                  forward_propagate_into_cond (rhs, stmt);\n+\t\t  bool did_something;\n+\t\t  fold_defer_overflow_warnings ();\n+                  did_something = forward_propagate_into_cond (rhs, stmt);\n+\t\t  fold_undefer_overflow_warnings (!TREE_NO_WARNING (rhs)\n+\t\t    && did_something, stmt, WARN_STRICT_OVERFLOW_CONDITIONAL);\n \t\t  bsi_next (&bsi);\n                 }\n \t      else if (COMPARISON_CLASS_P (rhs))\n@@ -1010,7 +1020,12 @@ tree_ssa_forward_propagate_single_use_vars (void)\n \t    }\n \t  else if (TREE_CODE (stmt) == COND_EXPR)\n \t    {\n-\t      forward_propagate_into_cond (stmt, stmt);\n+\t      bool did_something;\n+\t      fold_defer_overflow_warnings ();\n+\t      did_something = forward_propagate_into_cond (stmt, stmt);\n+\t      fold_undefer_overflow_warnings (!TREE_NO_WARNING (stmt)\n+\t\t\t\t\t      && did_something, stmt,\n+\t\t\t\t\t      WARN_STRICT_OVERFLOW_CONDITIONAL);\n \t      bsi_next (&bsi);\n \t    }\n \t  else"}]}