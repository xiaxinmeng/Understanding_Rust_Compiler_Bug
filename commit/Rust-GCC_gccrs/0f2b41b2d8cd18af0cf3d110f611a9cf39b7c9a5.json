{"sha": "0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGYyYjQxYjJkOGNkMThhZjBjZjNkMTEwZjYxMWE5Y2YzOWI3YzlhNQ==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2004-01-23T15:29:09Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2004-01-23T15:29:09Z"}, "message": "re PR target/13819 (sh-elf broken; abort in sh_reorg())\n\nPR optimization/13819\n* config/sh/sh.c (sh_reorg): Compensate for sharing of CLOBBERs\nintroduced by 2004-01-20's Jan Hubicka's copy_insn change.\n(sh_handle_sp_switch_attribute): Remove warning.\n\nFrom-SVN: r76425", "tree": {"sha": "393493a3ba5392495ed38f19ee8c2316973e51f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/393493a3ba5392495ed38f19ee8c2316973e51f7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5/comments", "author": null, "committer": null, "parents": [{"sha": "f1184d57e2dc3a6bf4eb717a87ea6a4723c6bb7f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1184d57e2dc3a6bf4eb717a87ea6a4723c6bb7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1184d57e2dc3a6bf4eb717a87ea6a4723c6bb7f"}], "stats": {"total": 18, "additions": 14, "deletions": 4}, "files": [{"sha": "413c01ca1c30d72ea9799ecc1d48cc459ed8c5b1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5", "patch": "@@ -1,3 +1,10 @@\n+2004-01-23  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\tPR optimization/13819\n+\t* config/sh/sh.c (sh_reorg): Compensate for sharing of CLOBBERs \n+\tintroduced by 2004-01-20's Jan Hubicka's copy_insn change.\n+\t(sh_handle_sp_switch_attribute): Remove warning.\n+\n 2003-11-30  Jan Hubicka  <jh@suse.cz>\n \n \t* i386.c (ix86_emit_restore_regs_using_mov):  Deal with large offsets."}, {"sha": "f745265a92203b1910360b9621b720da1e71e92e", "filename": "gcc/config/sh/sh.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5/gcc%2Fconfig%2Fsh%2Fsh.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5/gcc%2Fconfig%2Fsh%2Fsh.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.c?ref=0f2b41b2d8cd18af0cf3d110f611a9cf39b7c9a5", "patch": "@@ -4092,8 +4092,10 @@ sh_reorg (void)\n \t\t  if (GET_CODE (dst) == REG && FP_ANY_REGISTER_P (REGNO (dst)))\n \t\t    {\n \t\t      /* This must be an insn that clobbers r0.  */\n-\t\t      rtx clobber = XVECEXP (PATTERN (scan), 0,\n-\t\t\t\t\t     XVECLEN (PATTERN (scan), 0) - 1);\n+\t\t      rtx *clobberp = &XVECEXP (PATTERN (scan), 0,\n+\t\t\t\t\t\tXVECLEN (PATTERN (scan), 0)\n+\t\t\t\t\t\t- 1);\n+\t\t      rtx clobber = *clobberp;\n \n \t\t      if (GET_CODE (clobber) != CLOBBER\n \t\t\t  || ! rtx_equal_p (XEXP (clobber, 0), r0_rtx))\n@@ -4137,7 +4139,8 @@ sh_reorg (void)\n \t\t      last_float_addr = &XEXP (newsrc, 0);\n \n \t\t      /* Remove the clobber of r0.  */\n-\t\t      XEXP (clobber, 0) = gen_rtx_SCRATCH (Pmode);\n+\t\t      *clobberp = gen_rtx_CLOBBER (GET_MODE (clobber),\n+\t\t\t\t\t\t   gen_rtx_SCRATCH (Pmode));\n \t\t      RTX_UNCHANGING_P (newsrc) = 1;\n \t\t    }\n \t\t  /* This is a mova needing a label.  Create it.  */\n@@ -6775,7 +6778,7 @@ sh_handle_sp_switch_attribute (tree *node, tree name, tree args,\n     }\n   else\n     {\n-      char *s = ggc_strdup (TREE_STRING_POINTER (TREE_VALUE (args)));\n+      const char *s = ggc_strdup (TREE_STRING_POINTER (TREE_VALUE (args)));\n       sp_switch = gen_rtx_SYMBOL_REF (VOIDmode, s);\n     }\n "}]}