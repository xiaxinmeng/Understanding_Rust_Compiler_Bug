{"sha": "be07535d0f43390b8906826cc119473dea514b54", "node_id": "C_kwDOANBUbNoAKGJlMDc1MzVkMGY0MzM5MGI4OTA2ODI2Y2MxMTk0NzNkZWE1MTRiNTQ", "commit": {"author": {"name": "Xi Ruoyao", "email": "xry111@mengyan1223.wang", "date": "2022-04-02T10:39:51Z"}, "committer": {"name": "Xi Ruoyao", "email": "xry111@mengyan1223.wang", "date": "2022-04-02T11:16:03Z"}, "message": "mips: Fix an ICE caused by r12-7962\n\nDECL_SIZE(x) is NULL if x is a flexible array member, but I forgot to\ncheck it in r12-7962.  Then if we increase the size of a struct with\nflexible array member (by using aligned attribute), the code will\ndereference NULL trying to use the \"size\" of the flexible array member.\n\ngcc/\n\n\t* config/mips/mips.cc (mips_function_arg): Check if DECL_SIZE is\n\tNULL before dereferencing it.\n\ngcc/testsuite/\n\n\t* gcc.target/mips/pr102024-4.c: New test.", "tree": {"sha": "d3f9908464445232c5b4755bca4f25886be91b75", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d3f9908464445232c5b4755bca4f25886be91b75"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/be07535d0f43390b8906826cc119473dea514b54", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEEunTLnZqV9wGnXaw2V5HFsy7NNwFAmJIMHMACgkQ2V5HFsy7\nNNywEg//dR0u1vlHqrg101XGLx3VWllb+PSNGt/IZ4mjED/TjP3GP52qPO1/OjhQ\n64pzZ6qL37MpofEmjhxuzCcJQOqNagAEUSpQIBrqpi8oQU9pS1zBBBoNdsXcnePx\n/Gds8ziZBLzxEwCWyO0g9fkoAHQpefWAxNLfvBdidGszFrb6sDZUvwgSKh2gEbHq\nCSxPIA7xQQb5QWR0HIKoDcBQ1BlsfBK9el3lVfkhmaMuKK4KkqyAQMW9F7a/10tD\nC3L6t/bz/dUXT3A3Jul4GL2O0liQWf4zmgWl8kznzI4BvUoK6qBsG5TyFQvZ5JXX\nwvO56WIdR5zrOodxWzL7Cx0UkibIE7Tuu8gC+q10Kqlg+XfxkDh+jqjoswQzO5Vw\ngMr7f9Rtn8XUMBwXFLh+ByF7wuvp0GhxbYLHMEsabKo9gNQeLucv7oyJWep0LVBz\nr6DQHttIiIP5AsVWO3YKgY67V/xchPRFhW85aXDrc4IWgbE3T/8c0ybplLEJfVB3\nS9ob/QrPwy3IEBV0GTjWJ4LMJT+S8/iCdDEpdoA7qUCTFtqg8pTFys6PFEQVtPXe\n7OW/cwu2Rx+iU2u4L/3FoqVZFdnFzfxBaISrgAC5vfATAUOGjPwQ0Ywh44scZR4x\nyYSlgN/bHba8wyuMedf1SDnsOTifOCu7m4ZGCt7H/dWlKTV8Ges=\n=RMbP\n-----END PGP SIGNATURE-----", "payload": "tree d3f9908464445232c5b4755bca4f25886be91b75\nparent 2a82301d409d3aa0e0b3b884e4c6daeaa0486d6b\nauthor Xi Ruoyao <xry111@mengyan1223.wang> 1648895991 +0800\ncommitter Xi Ruoyao <xry111@mengyan1223.wang> 1648898163 +0800\n\nmips: Fix an ICE caused by r12-7962\n\nDECL_SIZE(x) is NULL if x is a flexible array member, but I forgot to\ncheck it in r12-7962.  Then if we increase the size of a struct with\nflexible array member (by using aligned attribute), the code will\ndereference NULL trying to use the \"size\" of the flexible array member.\n\ngcc/\n\n\t* config/mips/mips.cc (mips_function_arg): Check if DECL_SIZE is\n\tNULL before dereferencing it.\n\ngcc/testsuite/\n\n\t* gcc.target/mips/pr102024-4.c: New test.\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be07535d0f43390b8906826cc119473dea514b54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be07535d0f43390b8906826cc119473dea514b54", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be07535d0f43390b8906826cc119473dea514b54/comments", "author": {"login": "xry111", "id": 8733039, "node_id": "MDQ6VXNlcjg3MzMwMzk=", "avatar_url": "https://avatars.githubusercontent.com/u/8733039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xry111", "html_url": "https://github.com/xry111", "followers_url": "https://api.github.com/users/xry111/followers", "following_url": "https://api.github.com/users/xry111/following{/other_user}", "gists_url": "https://api.github.com/users/xry111/gists{/gist_id}", "starred_url": "https://api.github.com/users/xry111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xry111/subscriptions", "organizations_url": "https://api.github.com/users/xry111/orgs", "repos_url": "https://api.github.com/users/xry111/repos", "events_url": "https://api.github.com/users/xry111/events{/privacy}", "received_events_url": "https://api.github.com/users/xry111/received_events", "type": "User", "site_admin": false}, "committer": {"login": "xry111", "id": 8733039, "node_id": "MDQ6VXNlcjg3MzMwMzk=", "avatar_url": "https://avatars.githubusercontent.com/u/8733039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/xry111", "html_url": "https://github.com/xry111", "followers_url": "https://api.github.com/users/xry111/followers", "following_url": "https://api.github.com/users/xry111/following{/other_user}", "gists_url": "https://api.github.com/users/xry111/gists{/gist_id}", "starred_url": "https://api.github.com/users/xry111/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/xry111/subscriptions", "organizations_url": "https://api.github.com/users/xry111/orgs", "repos_url": "https://api.github.com/users/xry111/repos", "events_url": "https://api.github.com/users/xry111/events{/privacy}", "received_events_url": "https://api.github.com/users/xry111/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2a82301d409d3aa0e0b3b884e4c6daeaa0486d6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a82301d409d3aa0e0b3b884e4c6daeaa0486d6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a82301d409d3aa0e0b3b884e4c6daeaa0486d6b"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "0f2492219f3eba5daed2f7efdee935e1d7929813", "filename": "gcc/config/mips/mips.cc", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be07535d0f43390b8906826cc119473dea514b54/gcc%2Fconfig%2Fmips%2Fmips.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be07535d0f43390b8906826cc119473dea514b54/gcc%2Fconfig%2Fmips%2Fmips.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.cc?ref=be07535d0f43390b8906826cc119473dea514b54", "patch": "@@ -6054,7 +6054,8 @@ mips_function_arg (cumulative_args_t cum_v, const function_arg_info &arg)\n \t\t     an ABI change.  */\n \t\t  if (DECL_FIELD_CXX_ZERO_WIDTH_BIT_FIELD (field))\n \t\t    continue;\n-\t\t  if (integer_zerop (DECL_SIZE (field)))\n+\t\t  if (DECL_SIZE (field)\n+\t\t      && integer_zerop (DECL_SIZE (field)))\n \t\t    {\n \t\t      zero_width_field_abi_change = true;\n \t\t      continue;"}, {"sha": "2147cc769d00d88acd92cb59763af4aa3d38e71f", "filename": "gcc/testsuite/gcc.target/mips/pr102024-4.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/be07535d0f43390b8906826cc119473dea514b54/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fpr102024-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/be07535d0f43390b8906826cc119473dea514b54/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fpr102024-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fpr102024-4.c?ref=be07535d0f43390b8906826cc119473dea514b54", "patch": "@@ -0,0 +1,10 @@\n+// { dg-do compile }\n+// { dg-options \"-mabi=64 -mhard-float\" }\n+\n+struct __attribute__((aligned(16))) test {\n+  int x[0];\n+  double b;\n+  int f[];\n+};\n+\n+void check(struct test) {} // { dg-message \"the ABI for passing a value containing zero-width fields before an adjacent 64-bit floating-point field was changed in GCC 12.1\" }"}]}