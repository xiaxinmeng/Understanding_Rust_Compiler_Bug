{"sha": "bb3da4f27b9d7241a626695e80edc285561f2506", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmIzZGE0ZjI3YjlkNzI0MWE2MjY2OTVlODBlZGMyODU1NjFmMjUwNg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2008-09-26T20:11:52Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2008-09-26T20:11:52Z"}, "message": "decl.c (gnat_to_gnu_entity): Cap the alignment promotion to that of ptr_mode instead of word_mode.\n\n\t* decl.c (gnat_to_gnu_entity) <object>: Cap the alignment promotion\n\tto that of ptr_mode instead of word_mode.\n\nFrom-SVN: r140711", "tree": {"sha": "d07c6f8831a4d81fa09ec5f6ea14bfb44f9d7b87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d07c6f8831a4d81fa09ec5f6ea14bfb44f9d7b87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb3da4f27b9d7241a626695e80edc285561f2506", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb3da4f27b9d7241a626695e80edc285561f2506", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb3da4f27b9d7241a626695e80edc285561f2506", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb3da4f27b9d7241a626695e80edc285561f2506/comments", "author": null, "committer": null, "parents": [{"sha": "0da7a284ef2d91cc468145b88893c99e938d5be0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0da7a284ef2d91cc468145b88893c99e938d5be0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0da7a284ef2d91cc468145b88893c99e938d5be0"}], "stats": {"total": 31, "additions": 29, "deletions": 2}, "files": [{"sha": "3aa6f4d069a62df85f55c781d07598f14615a1ca", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=bb3da4f27b9d7241a626695e80edc285561f2506", "patch": "@@ -1,3 +1,8 @@\n+2008-09-26  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* decl.c (gnat_to_gnu_entity) <object>: Cap the alignment promotion\n+\tto that of ptr_mode instead of word_mode.\n+\n 2008-09-26  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR ada/5911"}, {"sha": "b0dfc7d33e4f2e24544d6490e0e208799f030b11", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=bb3da4f27b9d7241a626695e80edc285561f2506", "patch": "@@ -734,10 +734,12 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, int definition)\n \t    && TREE_CODE (TYPE_SIZE (gnu_type)) == INTEGER_CST)\n \t  {\n \t    /* No point in jumping through all the hoops needed in order\n-\t       to support BIGGEST_ALIGNMENT if we don't really have to.  */\n+\t       to support BIGGEST_ALIGNMENT if we don't really have to.\n+\t       So we cap to the smallest alignment that corresponds to\n+\t       a known efficient memory access pattern of the target.  */\n \t    unsigned int align_cap = Is_Atomic (gnat_entity)\n \t\t\t\t     ? BIGGEST_ALIGNMENT\n-\t\t\t\t     : get_mode_alignment (word_mode);\n+\t\t\t\t     : get_mode_alignment (ptr_mode);\n \n \t    if (!host_integerp (TYPE_SIZE (gnu_type), 1)\n \t\t|| compare_tree_int (TYPE_SIZE (gnu_type), align_cap) >= 0)"}, {"sha": "8169b88a56f4a82c0099e425e0b701b00ae9e1dc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bb3da4f27b9d7241a626695e80edc285561f2506", "patch": "@@ -1,3 +1,8 @@\n+2008-09-26  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/specs/static_initializer4.ads: New test.\n+\t* gnat.dg/specs/static_initializer3.ads: Add missing marker.\n+\n 2008-09-26  Kai Tietz  <kai.tietz@onevision.com>\n \n \t* g++.dg/compat/struct-layout-1_x1.h: Add __SIZE_TYPE__ cast"}, {"sha": "2dc8be1e5beb954b54d2a5ff31a0ecb130391e9f", "filename": "gcc/testsuite/gnat.dg/specs/static_initializer3.ads", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstatic_initializer3.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstatic_initializer3.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstatic_initializer3.ads?ref=bb3da4f27b9d7241a626695e80edc285561f2506", "patch": "@@ -1,3 +1,5 @@\n+-- { dg-do compile }\n+\n with Unchecked_Conversion;\n \n package Static_Initializer3 is"}, {"sha": "a1a5e846e3301baadd6d4ae9783ed0c3a3146915", "filename": "gcc/testsuite/gnat.dg/specs/static_initializer4.ads", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstatic_initializer4.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb3da4f27b9d7241a626695e80edc285561f2506/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstatic_initializer4.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fstatic_initializer4.ads?ref=bb3da4f27b9d7241a626695e80edc285561f2506", "patch": "@@ -0,0 +1,13 @@\n+-- { dg-do compile }\n+\n+package Static_Initializer4 is\n+\n+  type R is tagged record\n+    b : Boolean;\n+  end record;\n+\n+  type NR is new R with null record;\n+\n+  C : NR := (b => True);\n+\n+end Static_Initializer4;"}]}