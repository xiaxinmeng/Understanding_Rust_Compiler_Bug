{"sha": "c96fc0812393c3e2744232c1f6e248776628397f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk2ZmMwODEyMzkzYzNlMjc0NDIzMmMxZjZlMjQ4Nzc2NjI4Mzk3Zg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2019-09-10T02:48:24Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2019-09-10T02:48:24Z"}, "message": "cmd/go: look for tool build ID before hashing entire file\n    \n    Also fix the key used to store the ID.\n    \n    This is a significant speedup in cmd/go run time.\n    \n    Reviewed-on: https://go-review.googlesource.com/c/gofrontend/+/194257\n\nFrom-SVN: r275559", "tree": {"sha": "50a15ac8527d9faca731fd6589e21f35c950b300", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50a15ac8527d9faca731fd6589e21f35c950b300"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c96fc0812393c3e2744232c1f6e248776628397f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c96fc0812393c3e2744232c1f6e248776628397f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c96fc0812393c3e2744232c1f6e248776628397f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c96fc0812393c3e2744232c1f6e248776628397f/comments", "author": null, "committer": null, "parents": [{"sha": "5447e8e2e249a12b0f22ccfb171ccc8fff9fcadc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5447e8e2e249a12b0f22ccfb171ccc8fff9fcadc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5447e8e2e249a12b0f22ccfb171ccc8fff9fcadc"}], "stats": {"total": 15, "additions": 10, "deletions": 5}, "files": [{"sha": "183dac5aae4551521d9dda3901675b40ff87e1a3", "filename": "gcc/go/gofrontend/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c96fc0812393c3e2744232c1f6e248776628397f/gcc%2Fgo%2Fgofrontend%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c96fc0812393c3e2744232c1f6e248776628397f/gcc%2Fgo%2Fgofrontend%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2FMERGE?ref=c96fc0812393c3e2744232c1f6e248776628397f", "patch": "@@ -1,4 +1,4 @@\n-5c3f52ffbae7a9bb59bce63cd2cffdd8af8f4a92\n+68038b4fdf1456482af986cb05dcf3121bd43ffc\n \n The first line of this file holds the git revision number of the last\n merge done from the gofrontend repository."}, {"sha": "5ff9337afec0ab4bc3aa1a8b9d3d3312abff9693", "filename": "libgo/go/cmd/go/internal/work/buildid.go", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c96fc0812393c3e2744232c1f6e248776628397f/libgo%2Fgo%2Fcmd%2Fgo%2Finternal%2Fwork%2Fbuildid.go", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c96fc0812393c3e2744232c1f6e248776628397f/libgo%2Fgo%2Fcmd%2Fgo%2Finternal%2Fwork%2Fbuildid.go", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fgo%2Fcmd%2Fgo%2Finternal%2Fwork%2Fbuildid.go?ref=c96fc0812393c3e2744232c1f6e248776628397f", "patch": "@@ -291,14 +291,19 @@ func (b *Builder) gccgoToolID(name, language string) (string, error) {\n \t\t\t\texe = lp\n \t\t\t}\n \t\t}\n-\t\tif _, err := os.Stat(exe); err != nil {\n-\t\t\treturn \"\", fmt.Errorf(\"%s: can not find compiler %q: %v; output %q\", name, exe, err, out)\n+\t\tid, err = buildid.ReadFile(exe)\n+\t\tif err != nil {\n+\t\t\treturn \"\", err\n+\t\t}\n+\n+\t\t// If we can't find a build ID, use a hash.\n+\t\tif id == \"\" {\n+\t\t\tid = b.fileHash(exe)\n \t\t}\n-\t\tid = b.fileHash(exe)\n \t}\n \n \tb.id.Lock()\n-\tb.toolIDCache[name] = id\n+\tb.toolIDCache[key] = id\n \tb.id.Unlock()\n \n \treturn id, nil"}]}