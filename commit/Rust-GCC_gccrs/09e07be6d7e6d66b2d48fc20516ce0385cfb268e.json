{"sha": "09e07be6d7e6d66b2d48fc20516ce0385cfb268e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDllMDdiZTZkN2U2ZDY2YjJkNDhmYzIwNTE2Y2UwMzg1Y2ZiMjY4ZQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2001-08-17T02:03:36Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2001-08-17T02:03:36Z"}, "message": "varasm.c (force_const_mem): Keep pool alignment in bits.\n\n        * varasm.c (force_const_mem): Keep pool alignment in bits.\n        (output_constant_pool): Use assemble_align.\n\nFrom-SVN: r44952", "tree": {"sha": "976675b45679dc6326128999596a627a51a6a1c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/976675b45679dc6326128999596a627a51a6a1c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/09e07be6d7e6d66b2d48fc20516ce0385cfb268e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09e07be6d7e6d66b2d48fc20516ce0385cfb268e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09e07be6d7e6d66b2d48fc20516ce0385cfb268e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09e07be6d7e6d66b2d48fc20516ce0385cfb268e/comments", "author": null, "committer": null, "parents": [{"sha": "8daaf93ce179c7d64e9d3e0f59fb75d61a113ed2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8daaf93ce179c7d64e9d3e0f59fb75d61a113ed2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8daaf93ce179c7d64e9d3e0f59fb75d61a113ed2"}], "stats": {"total": 18, "additions": 10, "deletions": 8}, "files": [{"sha": "e0c4c105b134fd47cecc8864f644d0ff27f88e85", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09e07be6d7e6d66b2d48fc20516ce0385cfb268e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09e07be6d7e6d66b2d48fc20516ce0385cfb268e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=09e07be6d7e6d66b2d48fc20516ce0385cfb268e", "patch": "@@ -1,3 +1,8 @@\n+2001-08-16  Richard Henderson  <rth@redhat.com>\n+\n+\t* varasm.c (force_const_mem): Keep pool alignment in bits.\n+\t(output_constant_pool): Use assemble_align.\n+\n 2001-08-16  Zack Weinberg  <zackw@panix.com>\n \n \t* doc/tm.texi: Remove extra @table command."}, {"sha": "4a65020abb7710d6bd0dfc04952c4f731a254dc6", "filename": "gcc/varasm.c", "status": "modified", "additions": 5, "deletions": 8, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09e07be6d7e6d66b2d48fc20516ce0385cfb268e/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09e07be6d7e6d66b2d48fc20516ce0385cfb268e/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=09e07be6d7e6d66b2d48fc20516ce0385cfb268e", "patch": "@@ -3513,16 +3513,14 @@ force_const_mem (mode, x)\n       const_rtx_hash_table[hash] = desc;\n \n       /* Align the location counter as required by EXP's data type.  */\n-      align = (mode == VOIDmode) ? UNITS_PER_WORD : GET_MODE_SIZE (mode);\n-      if (align > BIGGEST_ALIGNMENT / BITS_PER_UNIT)\n-\talign = BIGGEST_ALIGNMENT / BITS_PER_UNIT;\n+      align = GET_MODE_ALIGNMENT (mode == VOIDmode ? word_mode : mode);\n #ifdef CONSTANT_ALIGNMENT\n       align = CONSTANT_ALIGNMENT (make_tree (type_for_mode (mode, 0), x),\n-\t\t\t\t align * BITS_PER_UNIT) / BITS_PER_UNIT;\n+\t\t\t\t  align);\n #endif\n \n-      pool_offset += align - 1;\n-      pool_offset &= ~ (align - 1);\n+      pool_offset += (align / BITS_PER_UNIT) - 1;\n+      pool_offset &= ~ ((align / BITS_PER_UNIT) - 1);\n \n       if (GET_CODE (x) == LABEL_REF)\n \tLABEL_PRESERVE_P (XEXP (x, 0)) = 1;\n@@ -3731,8 +3729,7 @@ output_constant_pool (fnname, fndecl)\n \t\t\t\t     pool->align, pool->labelno, done);\n #endif\n \n-      if (pool->align > 1)\n-\tASM_OUTPUT_ALIGN (asm_out_file, floor_log2 (pool->align));\n+      assemble_align (pool->align);\n \n       /* Output the label.  */\n       ASM_OUTPUT_INTERNAL_LABEL (asm_out_file, \"LC\", pool->labelno);"}]}