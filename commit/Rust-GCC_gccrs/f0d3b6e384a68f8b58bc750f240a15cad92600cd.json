{"sha": "f0d3b6e384a68f8b58bc750f240a15cad92600cd", "node_id": "C_kwDOANBUbNoAKGYwZDNiNmUzODRhNjhmOGI1OGJjNzUwZjI0MGExNWNhZDkyNjAwY2Q", "commit": {"author": {"name": "Christophe Lyon", "email": "christophe.lyon@arm.com", "date": "2022-10-27T08:50:53Z"}, "committer": {"name": "Christophe Lyon", "email": "christophe.lyon@arm.com", "date": "2022-11-21T09:20:59Z"}, "message": "genmultilib: Add sanity check\n\nWhen a list of dirnames is provided to genmultilib, its length is\nexpected to match the number of options.  If this is not the case, the\nbuild fails later for reasons not obviously related to this mistake.\nThis patch adds a sanity check to help diagnose such cases.\n\nTested by adding an option to t-aarch64 and no corresponding dirname,\nwith both bash and dash.\n\nv2: do not use arrays (bash feature).\n\nOK for trunk?\n\ngcc/ChangeLog:\n\n\t* genmultilib: Add sanity check.", "tree": {"sha": "ce01134ab3ce0fbb894e2e49c275b10027c927d1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ce01134ab3ce0fbb894e2e49c275b10027c927d1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f0d3b6e384a68f8b58bc750f240a15cad92600cd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0d3b6e384a68f8b58bc750f240a15cad92600cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f0d3b6e384a68f8b58bc750f240a15cad92600cd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0d3b6e384a68f8b58bc750f240a15cad92600cd/comments", "author": null, "committer": null, "parents": [{"sha": "3d3b561fc3aaceb682ade756c3bb1ebb3f495231", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d3b561fc3aaceb682ade756c3bb1ebb3f495231", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d3b561fc3aaceb682ade756c3bb1ebb3f495231"}], "stats": {"total": 14, "additions": 14, "deletions": 0}, "files": [{"sha": "b5f372c83581faa8a8f623c65febc7d7e71f0dd9", "filename": "gcc/genmultilib", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0d3b6e384a68f8b58bc750f240a15cad92600cd/gcc%2Fgenmultilib", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0d3b6e384a68f8b58bc750f240a15cad92600cd/gcc%2Fgenmultilib", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgenmultilib?ref=f0d3b6e384a68f8b58bc750f240a15cad92600cd", "patch": "@@ -141,6 +141,20 @@ multiarch=$9\n multilib_reuse=${10}\n enable_multilib=${11}\n \n+# Sanity check: make sure we have as many dirnames as options\n+if [ -n \"${dirnames}\" ]; then\n+    set x $options\n+    nboptions=$#\n+    set x $dirnames\n+    nbdirnames=$#\n+    if [ $nbdirnames -ne $nboptions ]; then\n+\techo 1>&2 \"Error calling $0: Number of dirnames ($nbdirnames) does not match number of options ($nboptions)\"\n+\techo 1>&2 \"options: ${options}\"\n+\techo 1>&2 \"dirnames: ${dirnames}\"\n+\texit 1\n+    fi\n+fi\n+\n echo \"static const char *const multilib_raw[] = {\"\n \n mkdir tmpmultilib.$$ || exit 1"}]}