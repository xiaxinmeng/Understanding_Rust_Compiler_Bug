{"sha": "ab0ca06f703628ad4d25662758fe578a76d6d6dc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWIwY2EwNmY3MDM2MjhhZDRkMjU2NjI3NThmZTU3OGE3NmQ2ZDZkYw==", "commit": {"author": {"name": "David S. Miller", "email": "davem@davemloft.net", "date": "2011-09-18T01:36:55Z"}, "committer": {"name": "David S. Miller", "email": "davem@gcc.gnu.org", "date": "2011-09-18T01:36:55Z"}, "message": "sparc.c (niagara2_costs): Adjust integer divide costs.\n\n\t* gcc/config/sparc/sparc.c (niagara2_costs): Adjust integer\n\tdivide costs.\n\t(niagara3_costs): New.\n\t(sparc_option_override): Use it.\n\t* gcc/config/sparc/niagara2.md: Adjust with more accurate\n\tNiagara-3 reservations.\n\nFrom-SVN: r178938", "tree": {"sha": "8a5e9aa40a9c2c2c150863481b40fe64ba7deb4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a5e9aa40a9c2c2c150863481b40fe64ba7deb4e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ab0ca06f703628ad4d25662758fe578a76d6d6dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab0ca06f703628ad4d25662758fe578a76d6d6dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab0ca06f703628ad4d25662758fe578a76d6d6dc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab0ca06f703628ad4d25662758fe578a76d6d6dc/comments", "author": {"login": "davem330", "id": 1053866, "node_id": "MDQ6VXNlcjEwNTM4NjY=", "avatar_url": "https://avatars.githubusercontent.com/u/1053866?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davem330", "html_url": "https://github.com/davem330", "followers_url": "https://api.github.com/users/davem330/followers", "following_url": "https://api.github.com/users/davem330/following{/other_user}", "gists_url": "https://api.github.com/users/davem330/gists{/gist_id}", "starred_url": "https://api.github.com/users/davem330/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davem330/subscriptions", "organizations_url": "https://api.github.com/users/davem330/orgs", "repos_url": "https://api.github.com/users/davem330/repos", "events_url": "https://api.github.com/users/davem330/events{/privacy}", "received_events_url": "https://api.github.com/users/davem330/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b38fb6fa5744fce8d10a33747a1de136deb33e0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b38fb6fa5744fce8d10a33747a1de136deb33e0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b38fb6fa5744fce8d10a33747a1de136deb33e0f"}], "stats": {"total": 87, "additions": 75, "deletions": 12}, "files": [{"sha": "e948bdb3ce5640d9cff0e30095358b786d83ef2e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab0ca06f703628ad4d25662758fe578a76d6d6dc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab0ca06f703628ad4d25662758fe578a76d6d6dc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ab0ca06f703628ad4d25662758fe578a76d6d6dc", "patch": "@@ -21,6 +21,13 @@\n \t__vis_fpack32): Fix types.\n \t* doc/extend.texi: Document new 'edge' VIS intrinsics.\n \n+\t* gcc/config/sparc/sparc.c (niagara2_costs): Adjust integer\n+\tdivide costs.\n+\t(niagara3_costs): New.\n+\t(sparc_option_override): Use it.\n+\t* gcc/config/sparc/niagara2.md: Adjust with more accurate\n+\tNiagara-3 reservations.\n+\n 2011-09-17  Jakub Jelinek  <jakub@redhat.com>\n \n \t* config/i386/sse.md (VIMAX_AVX2): Change V4DI to V2TI."}, {"sha": "d53be84e0965a800590bfb4a8d4ab0afbf90bcc0", "filename": "gcc/config/sparc/niagara2.md", "status": "modified", "additions": 39, "deletions": 9, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab0ca06f703628ad4d25662758fe578a76d6d6dc/gcc%2Fconfig%2Fsparc%2Fniagara2.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab0ca06f703628ad4d25662758fe578a76d6d6dc/gcc%2Fconfig%2Fsparc%2Fniagara2.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fniagara2.md?ref=ab0ca06f703628ad4d25662758fe578a76d6d6dc", "patch": "@@ -45,12 +45,22 @@\n  \"niag2_pipe\")\n \n (define_insn_reservation \"niag2_imul\" 5\n- (and (eq_attr \"cpu\" \"niagara2,niagara3\")\n+ (and (eq_attr \"cpu\" \"niagara2\")\n    (eq_attr \"type\" \"imul\"))\n  \"niag2_pipe*5\")\n \n-(define_insn_reservation \"niag2_idiv\" 31\n- (and (eq_attr \"cpu\" \"niagara2,niagara3\")\n+(define_insn_reservation \"niag3_imul\" 9\n+ (and (eq_attr \"cpu\" \"niagara3\")\n+   (eq_attr \"type\" \"imul\"))\n+ \"niag2_pipe*9\")\n+\n+(define_insn_reservation \"niag2_idiv\" 26\n+ (and (eq_attr \"cpu\" \"niagara2\")\n+   (eq_attr \"type\" \"idiv\"))\n+ \"niag2_pipe*26\")\n+\n+(define_insn_reservation \"niag3_idiv\" 31\n+ (and (eq_attr \"cpu\" \"niagara3\")\n    (eq_attr \"type\" \"idiv\"))\n  \"niag2_pipe*31\")\n \n@@ -69,22 +79,42 @@\n     (eq_attr \"type\" \"store,fpstore\"))\n   \"niag2_pipe\")\n \n-(define_insn_reservation \"niag2_fp\" 3\n-  (and (eq_attr \"cpu\" \"niagara2,niagara3\")\n+(define_insn_reservation \"niag2_fp\" 6\n+  (and (eq_attr \"cpu\" \"niagara2\")\n     (eq_attr \"type\" \"fpmove,fpcmove,fpcrmove,fpcmp,fpmul\"))\n-  \"niag2_pipe*3\")\n+  \"niag2_pipe*6\")\n+\n+(define_insn_reservation \"niag3_fp\" 9\n+  (and (eq_attr \"cpu\" \"niagara3\")\n+    (eq_attr \"type\" \"fpmove,fpcmove,fpcrmove,fpcmp,fpmul\"))\n+  \"niag2_pipe*9\")\n \n (define_insn_reservation \"niag2_fdivs\" 19\n-  (and (eq_attr \"cpu\" \"niagara2,niagara3\")\n+  (and (eq_attr \"cpu\" \"niagara2\")\n     (eq_attr \"type\" \"fpdivs\"))\n   \"niag2_pipe*19\")\n \n+(define_insn_reservation \"niag3_fdivs\" 23\n+  (and (eq_attr \"cpu\" \"niagara3\")\n+    (eq_attr \"type\" \"fpdivs\"))\n+  \"niag2_pipe*23\")\n+\n (define_insn_reservation \"niag2_fdivd\" 33\n-  (and (eq_attr \"cpu\" \"niagara2,niagara3\")\n+  (and (eq_attr \"cpu\" \"niagara2\")\n     (eq_attr \"type\" \"fpdivd\"))\n   \"niag2_pipe*33\")\n \n+(define_insn_reservation \"niag3_fdivd\" 37\n+  (and (eq_attr \"cpu\" \"niagara3\")\n+    (eq_attr \"type\" \"fpdivd\"))\n+  \"niag2_pipe*37\")\n+\n (define_insn_reservation \"niag2_vis\" 6\n-  (and (eq_attr \"cpu\" \"niagara2,niagara3\")\n+  (and (eq_attr \"cpu\" \"niagara2\")\n     (eq_attr \"type\" \"fga,fgm_pack,fgm_mul,fgm_cmp,fgm_pdist,edge\"))\n   \"niag2_pipe*6\")\n+\n+(define_insn_reservation \"niag3_vis\" 9\n+  (and (eq_attr \"cpu\" \"niagara3\")\n+    (eq_attr \"type\" \"fga,fgm_pack,fgm_mul,fgm_cmp,fgm_pdist,edge\"))\n+  \"niag2_pipe*9\")"}, {"sha": "6ccc97b7416cdf633d6936c76c37876fe6d00bde", "filename": "gcc/config/sparc/sparc.c", "status": "modified", "additions": 29, "deletions": 3, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab0ca06f703628ad4d25662758fe578a76d6d6dc/gcc%2Fconfig%2Fsparc%2Fsparc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab0ca06f703628ad4d25662758fe578a76d6d6dc/gcc%2Fconfig%2Fsparc%2Fsparc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsparc%2Fsparc.c?ref=ab0ca06f703628ad4d25662758fe578a76d6d6dc", "patch": "@@ -269,8 +269,32 @@ struct processor_costs niagara2_costs = {\n   COSTS_N_INSNS (5), /* imul */\n   COSTS_N_INSNS (5), /* imulX */\n   0, /* imul bit factor */\n-  COSTS_N_INSNS (31), /* idiv, average of 12 - 41 cycle range */\n-  COSTS_N_INSNS (31), /* idivX, average of 12 - 41 cycle range */\n+  COSTS_N_INSNS (26), /* idiv, average of 12 - 41 cycle range */\n+  COSTS_N_INSNS (26), /* idivX, average of 12 - 41 cycle range */\n+  COSTS_N_INSNS (1), /* movcc/movr */\n+  0, /* shift penalty */\n+};\n+\n+static const\n+struct processor_costs niagara3_costs = {\n+  COSTS_N_INSNS (3), /* int load */\n+  COSTS_N_INSNS (3), /* int signed load */\n+  COSTS_N_INSNS (3), /* int zeroed load */\n+  COSTS_N_INSNS (3), /* float load */\n+  COSTS_N_INSNS (9), /* fmov, fneg, fabs */\n+  COSTS_N_INSNS (9), /* fadd, fsub */\n+  COSTS_N_INSNS (9), /* fcmp */\n+  COSTS_N_INSNS (9), /* fmov, fmovr */\n+  COSTS_N_INSNS (9), /* fmul */\n+  COSTS_N_INSNS (23), /* fdivs */\n+  COSTS_N_INSNS (37), /* fdivd */\n+  COSTS_N_INSNS (23), /* fsqrts */\n+  COSTS_N_INSNS (37), /* fsqrtd */\n+  COSTS_N_INSNS (9), /* imul */\n+  COSTS_N_INSNS (9), /* imulX */\n+  0, /* imul bit factor */\n+  COSTS_N_INSNS (31), /* idiv, average of 17 - 45 cycle range */\n+  COSTS_N_INSNS (30), /* idivX, average of 16 - 44 cycle range */\n   COSTS_N_INSNS (1), /* movcc/movr */\n   0, /* shift penalty */\n };\n@@ -917,9 +941,11 @@ sparc_option_override (void)\n       sparc_costs = &niagara_costs;\n       break;\n     case PROCESSOR_NIAGARA2:\n+      sparc_costs = &niagara2_costs;\n+      break;\n     case PROCESSOR_NIAGARA3:\n     case PROCESSOR_NIAGARA4:\n-      sparc_costs = &niagara2_costs;\n+      sparc_costs = &niagara3_costs;\n       break;\n     case PROCESSOR_NATIVE:\n       gcc_unreachable ();"}]}