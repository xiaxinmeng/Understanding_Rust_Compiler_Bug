{"sha": "26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjZjNDNlMjc0NDFiODhiMjBhNDYzNjg2ZmZlMGI5YjVlYmJmYmNmMA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-01-04T21:30:35Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-01-04T21:30:35Z"}, "message": "re PR c++/78693 (Bogus 'inconsistent deduction for \u2018auto\u2019' error when having a dependent initializer and a nondependent one in the same declaration)\n\n\tPR c++/78693\n\t* parser.c (cp_parser_simple_declaration): Only complain about\n\tinconsistent auto deduction if auto_result doesn't use auto.\n\n\t* g++.dg/cpp0x/pr78693.C: New test.\n\nFrom-SVN: r244074", "tree": {"sha": "3e4534773f68a3b8acb7baadbc4a5f321c830e48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3e4534773f68a3b8acb7baadbc4a5f321c830e48"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "742b18041a2624da73d57abfaa44b04fbe55fe37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/742b18041a2624da73d57abfaa44b04fbe55fe37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/742b18041a2624da73d57abfaa44b04fbe55fe37"}], "stats": {"total": 44, "additions": 42, "deletions": 2}, "files": [{"sha": "833b9049ee44c1354f57d96c2d143cd764957b59", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "patch": "@@ -1,5 +1,9 @@\n 2017-01-04  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/78693\n+\t* parser.c (cp_parser_simple_declaration): Only complain about\n+\tinconsistent auto deduction if auto_result doesn't use auto.\n+\n \t* parser.c (cp_parser_simple_declaration): Diagnose function\n \tdeclaration among more than one init-declarators with auto\n \tspecifier."}, {"sha": "57ae064719524400def7fda23d9a2392691b994c", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "patch": "@@ -12799,9 +12799,11 @@ cp_parser_simple_declaration (cp_parser* parser,\n \t    }\n \t}\n \n-      if (auto_result)\n+      if (auto_result\n+\t  && (!processing_template_decl || !type_uses_auto (auto_result)))\n \t{\n-\t  if (last_type && last_type != error_mark_node\n+\t  if (last_type\n+\t      && last_type != error_mark_node\n \t      && !same_type_p (auto_result, last_type))\n \t    {\n \t      /* If the list of declarators contains more than one declarator,"}, {"sha": "abdb8bb5a7eacb323a1e7306e80a21767cffdaed", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "patch": "@@ -1,5 +1,8 @@\n 2017-01-04  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/78693\n+\t* g++.dg/cpp0x/pr78693.C: New test.\n+\n \tPR driver/78957\n \t* gcc.dg/pr78957.c: New test.\n "}, {"sha": "c937567e3f3364a01619ba49fc09e36db2867ab6", "filename": "gcc/testsuite/g++.dg/cpp0x/pr78693.C", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr78693.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26c43e27441b88b20a463686ffe0b9b5ebbfbcf0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr78693.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fpr78693.C?ref=26c43e27441b88b20a463686ffe0b9b5ebbfbcf0", "patch": "@@ -0,0 +1,31 @@\n+// PR c++/78693\n+// { dg-do compile { target c++11 } }\n+\n+template <class T>\n+void\n+foo (T t)\n+{\n+  auto i = t, j = 1;\t\t// { dg-bogus \"inconsistent deduction\" }\n+}\n+\n+template <class T>\n+void\n+bar (T t)\n+{\n+  auto i = 1, j = t, k = 2;\t// { dg-bogus \"inconsistent deduction\" }\n+}\n+\n+template <class T, class U>\n+void\n+foo (T t, U u)\n+{\n+  auto i = t, j = u;\t\t// { dg-bogus \"inconsistent deduction\" }\n+}\n+\n+void\n+foo ()\n+{\n+  foo (0);\n+  bar (0);\n+  foo (1, 2);\n+}"}]}