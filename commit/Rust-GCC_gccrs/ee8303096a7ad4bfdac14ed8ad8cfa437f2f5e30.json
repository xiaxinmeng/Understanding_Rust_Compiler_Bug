{"sha": "ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWU4MzAzMDk2YTdhZDRiZmRhYzE0ZWQ4YWQ4Y2ZhNDM3ZjJmNWUzMA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1998-06-19T22:09:24Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-06-19T22:09:24Z"}, "message": "varasm.c (assemble_start_function): Add weak_global_object_name.\n\n        * varasm.c (assemble_start_function): Add weak_global_object_name.\n        * tree.c (get_file_function_name): Use it.\n\nFrom-SVN: r20612", "tree": {"sha": "9a6e1923f7e7d063af614201d24d4b3fece19f1c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9a6e1923f7e7d063af614201d24d4b3fece19f1c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30/comments", "author": null, "committer": null, "parents": [{"sha": "0d091530be45c4f0cd0cb86fd881c3446f967958", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d091530be45c4f0cd0cb86fd881c3446f967958", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d091530be45c4f0cd0cb86fd881c3446f967958"}], "stats": {"total": 22, "additions": 18, "deletions": 4}, "files": [{"sha": "b93e2d11aac9053bb48734a659ac064cda3647da", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30", "patch": "@@ -1,3 +1,8 @@\n+Fri Jun 19 23:06:33 1998  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* varasm.c (assemble_start_function): Add weak_global_object_name.\n+\t* tree.c (get_file_function_name): Use it.\n+\n Fri Jun 19 22:55:14 1998  Jeffrey A Law  (law@cygnus.com)\n \n \t* c-lang.c (GNU_xref_begin, GNU_xref_end): Deleted."}, {"sha": "75e1e1f533c30a0c6ffa1be41c3be9ff7daca6a0", "filename": "gcc/tree.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30", "patch": "@@ -4793,6 +4793,7 @@ dump_tree_statistics ()\n #endif\t/* NO_DOLLAR_IN_LABEL */\n \n extern char * first_global_object_name;\n+extern char * weak_global_object_name;\n \n /* If KIND=='I', return a suitable global initializer (constructor) name.\n    If KIND=='D', return a suitable global clean-up (destructor) name.  */\n@@ -4806,6 +4807,8 @@ get_file_function_name (kind)\n \n   if (first_global_object_name)\n     p = first_global_object_name;\n+  else if (weak_global_object_name)\n+    p = weak_global_object_name;\n   else if (main_input_filename)\n     p = main_input_filename;\n   else"}, {"sha": "22b752d90fc6fc9c2f1f60f079952f7156da3bf9", "filename": "gcc/varasm.c", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=ee8303096a7ad4bfdac14ed8ad8cfa437f2f5e30", "patch": "@@ -85,6 +85,7 @@ extern FILE *asm_out_file;\n \n /* The (assembler) name of the first globally-visible object output.  */\n char *first_global_object_name;\n+char *weak_global_object_name;\n \n extern struct obstack *current_obstack;\n extern struct obstack *saveable_obstack;\n@@ -1003,14 +1004,19 @@ assemble_start_function (decl, fnname)\n \n   if (TREE_PUBLIC (decl))\n     {\n-      if (!first_global_object_name && ! DECL_WEAK (decl)\n-\t  && ! DECL_ONE_ONLY (decl))\n+      if (! first_global_object_name)\n \t{\n \t  char *p;\n+\t  char **name;\n+\n+\t  if (! DECL_WEAK (decl) && ! DECL_ONE_ONLY (decl))\n+\t    name = &first_global_object_name;\n+\t  else\n+\t    name = &weak_global_object_name;\n \n \t  STRIP_NAME_ENCODING (p, fnname);\n-\t  first_global_object_name = permalloc (strlen (p) + 1);\n-\t  strcpy (first_global_object_name, p);\n+\t  *name = permalloc (strlen (p) + 1);\n+\t  strcpy (*name, p);\n \t}\n \n #ifdef ASM_WEAKEN_LABEL"}]}