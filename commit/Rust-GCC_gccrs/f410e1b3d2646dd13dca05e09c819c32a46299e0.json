{"sha": "f410e1b3d2646dd13dca05e09c819c32a46299e0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjQxMGUxYjNkMjY0NmRkMTNkY2EwNWUwOWM4MTljMzJhNDYyOTllMA==", "commit": {"author": {"name": "Rafael Avila de Espindola", "email": "espindola@google.com", "date": "2008-07-30T13:59:58Z"}, "committer": {"name": "Rafael Espindola", "email": "espindola@gcc.gnu.org", "date": "2008-07-30T13:59:58Z"}, "message": "final.c (call_from_call_insn): New.\n\n2008-07-30  Rafael Avila de Espindola  <espindola@google.com>\n\n       * final.c (call_from_call_insn): New.\n       (final_scan_insn): Call assemble_external on FUNCTION_DECLs.\n\n2008-07-30  Rafael Avila de Espindola  <espindola@google.com>\n\n\t* gcc.dg/visibility-14.c: New test.\n\t* gcc.dg/visibility-15.c: New test.\n\t* gcc.dg/visibility-16.c: New test.\n\t* gcc.dg/visibility-17.c: New test.\n\t* gcc.dg/visibility-18.c: New test.\n\t* gcc.dg/visibility-19.c: New test.\n\nFrom-SVN: r138310", "tree": {"sha": "98f89aad7babbdcab71508990897edb9726f4dc6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/98f89aad7babbdcab71508990897edb9726f4dc6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f410e1b3d2646dd13dca05e09c819c32a46299e0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f410e1b3d2646dd13dca05e09c819c32a46299e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f410e1b3d2646dd13dca05e09c819c32a46299e0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f410e1b3d2646dd13dca05e09c819c32a46299e0/comments", "author": null, "committer": null, "parents": [{"sha": "e44c800e357f128c1d29b4a907d4a5ef30d8b905", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e44c800e357f128c1d29b4a907d4a5ef30d8b905", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e44c800e357f128c1d29b4a907d4a5ef30d8b905"}], "stats": {"total": 53, "additions": 53, "deletions": 0}, "files": [{"sha": "423ac34d67832c5108e802945bfe38837500c963", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f410e1b3d2646dd13dca05e09c819c32a46299e0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f410e1b3d2646dd13dca05e09c819c32a46299e0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f410e1b3d2646dd13dca05e09c819c32a46299e0", "patch": "@@ -1,3 +1,8 @@\n+2008-07-30  Rafael Avila de Espindola  <espindola@google.com>\n+\n+       * final.c (call_from_call_insn): New.\n+       (final_scan_insn): Call assemble_external on FUNCTION_DECLs.\n+\n 2008-07-30  Paolo Bonzini  <bonzini@gnu.org>\n \n \t* configure.ac: Substitute ADA_CFLAGS."}, {"sha": "2a9d40ba75424fdd3c4e3f7976e3f58f5a6578e4", "filename": "gcc/final.c", "status": "modified", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f410e1b3d2646dd13dca05e09c819c32a46299e0/gcc%2Ffinal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f410e1b3d2646dd13dca05e09c819c32a46299e0/gcc%2Ffinal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffinal.c?ref=f410e1b3d2646dd13dca05e09c819c32a46299e0", "patch": "@@ -1744,6 +1744,31 @@ output_alternate_entry_point (FILE *file, rtx insn)\n     }\n }\n \n+/* Given a CALL_INSN, find and return the nested CALL. */\n+static rtx\n+call_from_call_insn (rtx insn)\n+{\n+  rtx x;\n+  gcc_assert (CALL_P (insn));\n+  x = PATTERN (insn);\n+\n+  while (GET_CODE (x) != CALL)\n+    {\n+      switch (GET_CODE (x))\n+\t{\n+\tdefault:\n+\t  gcc_unreachable ();\n+\tcase PARALLEL:\n+\t  x = XVECEXP (x, 0, 0);\n+\t  break;\n+\tcase SET:\n+\t  x = XEXP (x, 1);\n+\t  break;\n+\t}\n+    }\n+  return x;\n+}\n+\n /* The final scan for one insn, INSN.\n    Args are same as in `final', except that INSN\n    is the insn being scanned.\n@@ -2609,6 +2634,20 @@ final_scan_insn (rtx insn, FILE *file, int optimize ATTRIBUTE_UNUSED,\n \ttargetm.asm_out.unwind_emit (asm_out_file, insn);\n #endif\n \n+\tif (CALL_P (insn))\n+\t  {\n+\t    rtx x = call_from_call_insn (insn);\n+\t    x = XEXP (x, 0);\n+\t    if (x && MEM_P (x) && GET_CODE (XEXP (x, 0)) == SYMBOL_REF)\n+\t      {\n+\t\ttree t;\n+\t\tx = XEXP (x, 0);\n+\t\tt = SYMBOL_REF_DECL (x);\n+\t\tif (t)\n+\t\t  assemble_external (t);\n+\t      }\n+\t  }\n+\n \t/* Output assembler code from the template.  */\n \toutput_asm_insn (templ, recog_data.operand);\n "}, {"sha": "c53755b4db02f1b78520f65cc4467180a1cc00ad", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f410e1b3d2646dd13dca05e09c819c32a46299e0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f410e1b3d2646dd13dca05e09c819c32a46299e0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f410e1b3d2646dd13dca05e09c819c32a46299e0", "patch": "@@ -1,3 +1,12 @@\n+2008-07-30  Rafael Avila de Espindola  <espindola@google.com>\n+\n+\t* gcc.dg/visibility-14.c: New test.\n+\t* gcc.dg/visibility-15.c: New test.\n+\t* gcc.dg/visibility-16.c: New test.\n+\t* gcc.dg/visibility-17.c: New test.\n+\t* gcc.dg/visibility-18.c: New test.\n+\t* gcc.dg/visibility-19.c: New test.\n+\n 2008-07-30  Dodji Seketeli  <dseketel@redhat.com>\n \n \tPR c++/36767"}]}