{"sha": "92b7a2a514865e5284143beeacfe3b57341cec79", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTJiN2EyYTUxNDg2NWU1Mjg0MTQzYmVlYWNmZTNiNTczNDFjZWM3OQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2002-10-03T21:22:12Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2002-10-03T21:22:12Z"}, "message": "final.c (final): Use symbol name as function name for profiling.\n\n\n\t* final.c (final): Use symbol name as function name for profiling.\n\t* profile.c (get_exec_counts): Likewise.\n\t(branch_prob): Likewise.\n\nFrom-SVN: r57790", "tree": {"sha": "3dffee0546f36c9529e018025c2961adf6c73808", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3dffee0546f36c9529e018025c2961adf6c73808"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/92b7a2a514865e5284143beeacfe3b57341cec79", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92b7a2a514865e5284143beeacfe3b57341cec79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/92b7a2a514865e5284143beeacfe3b57341cec79", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92b7a2a514865e5284143beeacfe3b57341cec79/comments", "author": null, "committer": null, "parents": [{"sha": "429489e54f39016332a7f3a79ace6c42aafdf0c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/429489e54f39016332a7f3a79ace6c42aafdf0c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/429489e54f39016332a7f3a79ace6c42aafdf0c1"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "636128735108c2c7036f93a765531f5ccaac08c7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92b7a2a514865e5284143beeacfe3b57341cec79/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92b7a2a514865e5284143beeacfe3b57341cec79/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=92b7a2a514865e5284143beeacfe3b57341cec79", "patch": "@@ -1,3 +1,9 @@\n+Thu Oct  3 23:20:58 CEST 2002  Jan Hubicka  <jh@suse.cz>\n+\n+\t* final.c (final): Use symbol name as function name for profiling.\n+\t* profile.c (get_exec_counts): Likewise.\n+\t(branch_prob): Likewise.\n+\n 2002-10-03  Jakub Jelinek  <jakub@redhat.com>\n \n \t* longlong.h (__udiv_qrnnd): Remove PARAMS from prototype."}, {"sha": "2f5c8239fa18ac72daa3d9c6ff0fd7a81d0e7611", "filename": "gcc/final.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92b7a2a514865e5284143beeacfe3b57341cec79/gcc%2Ffinal.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92b7a2a514865e5284143beeacfe3b57341cec79/gcc%2Ffinal.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffinal.c?ref=92b7a2a514865e5284143beeacfe3b57341cec79", "patch": "@@ -1915,7 +1915,8 @@ final (first, file, optimize, prescan)\n       functions_tail = &new_item->next;\n \n       new_item->next = 0;\n-      new_item->name = xstrdup (current_function_name);\n+      new_item->name = xstrdup (IDENTIFIER_POINTER\n+\t\t\t\t (DECL_ASSEMBLER_NAME (current_function_decl)));\n       new_item->cfg_checksum = profile_info.current_function_cfg_checksum;\n       new_item->count_edges = profile_info.count_edges_instrumented_now;\n     }"}, {"sha": "60327947c2ee3bd09f683359557c56b7239e31d4", "filename": "gcc/profile.c", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/92b7a2a514865e5284143beeacfe3b57341cec79/gcc%2Fprofile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/92b7a2a514865e5284143beeacfe3b57341cec79/gcc%2Fprofile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fprofile.c?ref=92b7a2a514865e5284143beeacfe3b57341cec79", "patch": "@@ -260,6 +260,8 @@ get_exec_counts ()\n   char *function_name_buffer;\n   int function_name_buffer_len;\n   gcov_type max_counter_in_run;\n+  const char *name = IDENTIFIER_POINTER\n+\t\t      (DECL_ASSEMBLER_NAME (current_function_decl));\n \n   profile_info.max_counter_in_program = 0;\n   profile_info.count_profiles_merged = 0;\n@@ -282,7 +284,7 @@ get_exec_counts ()\n \n   profile = xmalloc (sizeof (gcov_type) * num_edges);\n   rewind (da_file);\n-  function_name_buffer_len = strlen (current_function_name) + 1;\n+  function_name_buffer_len = strlen (name) + 1;\n   function_name_buffer = xmalloc (function_name_buffer_len + 1);\n \n   for (i = 0; i < num_edges; i++)\n@@ -349,7 +351,7 @@ get_exec_counts ()\n \t      break;\n \t    }\n \n-\t  if (strcmp (function_name_buffer, current_function_name) != 0)\n+\t  if (strcmp (function_name_buffer, name) != 0)\n \t    {\n \t      /* skip */\n \t      if (fseek (da_file, arc_count * 8, SEEK_CUR) < 0)\n@@ -772,6 +774,8 @@ branch_prob ()\n   int i;\n   int num_edges, ignored_edges;\n   struct edge_list *el;\n+  const char *name = IDENTIFIER_POINTER\n+\t\t       (DECL_ASSEMBLER_NAME (current_function_decl));\n \n   profile_info.current_function_cfg_checksum = compute_checksum ();\n \n@@ -781,7 +785,7 @@ branch_prob ()\n \n   /* Start of a function.  */\n   if (flag_test_coverage)\n-    output_gcov_string (current_function_name, (long) -2);\n+    output_gcov_string (name, (long) -2);\n \n   total_num_times_called++;\n \n@@ -995,8 +999,7 @@ branch_prob ()\n     {\n       int flag_bits;\n \n-      __write_gcov_string (current_function_name,\n-\t\t           strlen (current_function_name), bbg_file, -1);\n+      __write_gcov_string (name, strlen (name), bbg_file, -1);\n \n       /* write checksum.  */\n       __write_long (profile_info.current_function_cfg_checksum, bbg_file, 4);"}]}