{"sha": "ae24748803fb1d0de3fd2f3c2f0f8363dc14417f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWUyNDc0ODgwM2ZiMWQwZGUzZmQyZjNjMmYwZjgzNjNkYzE0NDE3Zg==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2010-06-14T13:36:42Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-14T13:36:42Z"}, "message": "sem_ch8.adb (Find_Type): The attribute 'class cannot be applied to an untagged incomplete type that is a...\n\n2010-06-14  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch8.adb (Find_Type): The attribute 'class cannot be applied to\n\tan untagged incomplete type that is a limited view.\n\nFrom-SVN: r160741", "tree": {"sha": "ffd9fb930548d3afa4848ddb0346bf0494d1ff65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ffd9fb930548d3afa4848ddb0346bf0494d1ff65"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5875f8d66eca25f9208bf948c2aa80d6bb88d99f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5875f8d66eca25f9208bf948c2aa80d6bb88d99f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5875f8d66eca25f9208bf948c2aa80d6bb88d99f"}], "stats": {"total": 34, "additions": 25, "deletions": 9}, "files": [{"sha": "19b0aa2095fee54d0e78172190e595e32a65ce5a", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=ae24748803fb1d0de3fd2f3c2f0f8363dc14417f", "patch": "@@ -1,3 +1,8 @@\n+2010-06-14  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch8.adb (Find_Type): The attribute 'class cannot be applied to\n+\tan untagged incomplete type that is a limited view.\n+\n 2010-06-14  Sergey Rybin  <rybin@adacore.com>\n \n \t* gnat_ugn.texi: Add description of '-cargs gcc_switches' to gnatstub"}, {"sha": "c10ab2b53c44354cbdf70d41a280c8a44da503a0", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 20, "deletions": 9, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae24748803fb1d0de3fd2f3c2f0f8363dc14417f/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=ae24748803fb1d0de3fd2f3c2f0f8363dc14417f", "patch": "@@ -5624,22 +5624,33 @@ package body Sem_Ch8 is\n                   --  It is legal to denote the class type of an incomplete\n                   --  type. The full type will have to be tagged, of course.\n                   --  In Ada 2005 this usage is declared obsolescent, so we\n-                  --  warn accordingly.\n+                  --  warn accordingly. This usage is only legal if the type\n+                  --  is completed in the current scope, and not for a limited\n+                  --  view of a type.\n+\n+                  if not Is_Tagged_Type (T)\n+                    and then Ada_Version >= Ada_05\n+                  then\n+                     if From_With_Type (T) then\n+                        Error_Msg_N\n+                          (\"prefix of Class attribute must be tagged\", N);\n+                        Set_Etype (N, Any_Type);\n+                        Set_Entity (N, Any_Type);\n+                        return;\n \n                   --  ??? This test is temporarily disabled (always False)\n                   --  because it causes an unwanted warning on GNAT sources\n                   --  (built with -gnatg, which includes Warn_On_Obsolescent_\n                   --  Feature). Once this issue is cleared in the sources, it\n                   --  can be enabled.\n \n-                  if not Is_Tagged_Type (T)\n-                    and then Ada_Version >= Ada_05\n-                    and then Warn_On_Obsolescent_Feature\n-                    and then False\n-                  then\n-                     Error_Msg_N\n-                       (\"applying 'Class to an untagged incomplete type\"\n-                         & \" is an obsolescent feature  (RM J.11)\", N);\n+                     elsif Warn_On_Obsolescent_Feature\n+                       and then False\n+                     then\n+                        Error_Msg_N\n+                          (\"applying 'Class to an untagged incomplete type\"\n+                           & \" is an obsolescent feature  (RM J.11)\", N);\n+                     end if;\n                   end if;\n \n                   Set_Is_Tagged_Type (T);"}]}