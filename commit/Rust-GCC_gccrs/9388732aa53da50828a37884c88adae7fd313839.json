{"sha": "9388732aa53da50828a37884c88adae7fd313839", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTM4ODczMmFhNTNkYTUwODI4YTM3ODg0Yzg4YWRhZTdmZDMxMzgzOQ==", "commit": {"author": {"name": "Tamar Christina", "email": "tamar.christina@arm.com", "date": "2017-11-22T15:54:48Z"}, "committer": {"name": "Tamar Christina", "email": "tnfchris@gcc.gnu.org", "date": "2017-11-22T15:54:48Z"}, "message": "2017-11-22  Tamar Christina  <tamar.christina@arm.com>\n\n\t* config/arm/arm_neon.h (vdot_u32, vdotq_u32)\n\t(vdot_s32, vdotq_s32): New.\n\t(vdot_lane_u32, vdotq_lane_u32): New.\n\t(vdot_lane_s32, vdotq_lane_s32): New.\n\n\ngcc/testsuite/\n2017-11-22  Tamar Christina  <tamar.christina@arm.com>\n\n\t* gcc.target/arm/simd/vdot-compile.c: New.\n\t* gcc.target/arm/simd/vect-dot-qi.h: New.\n\t* gcc.target/arm/simd/vect-dot-s8.c: New.\n\t* gcc.target/arm/simd/vect-dot-u8.c: New\n\nFrom-SVN: r255064", "tree": {"sha": "8bda7b2f18f123c0089564d0ce269df221cf01e0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8bda7b2f18f123c0089564d0ce269df221cf01e0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9388732aa53da50828a37884c88adae7fd313839", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9388732aa53da50828a37884c88adae7fd313839", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9388732aa53da50828a37884c88adae7fd313839", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9388732aa53da50828a37884c88adae7fd313839/comments", "author": {"login": "TamarChristinaArm", "id": 48126768, "node_id": "MDQ6VXNlcjQ4MTI2NzY4", "avatar_url": "https://avatars.githubusercontent.com/u/48126768?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TamarChristinaArm", "html_url": "https://github.com/TamarChristinaArm", "followers_url": "https://api.github.com/users/TamarChristinaArm/followers", "following_url": "https://api.github.com/users/TamarChristinaArm/following{/other_user}", "gists_url": "https://api.github.com/users/TamarChristinaArm/gists{/gist_id}", "starred_url": "https://api.github.com/users/TamarChristinaArm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TamarChristinaArm/subscriptions", "organizations_url": "https://api.github.com/users/TamarChristinaArm/orgs", "repos_url": "https://api.github.com/users/TamarChristinaArm/repos", "events_url": "https://api.github.com/users/TamarChristinaArm/events{/privacy}", "received_events_url": "https://api.github.com/users/TamarChristinaArm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e88efb994f7a33d03569b0cb794e77aa5047b10e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e88efb994f7a33d03569b0cb794e77aa5047b10e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e88efb994f7a33d03569b0cb794e77aa5047b10e"}], "stats": {"total": 177, "additions": 177, "deletions": 0}, "files": [{"sha": "412fc15adb1c23c9dc0a06954ff0664481762dca", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9388732aa53da50828a37884c88adae7fd313839/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9388732aa53da50828a37884c88adae7fd313839/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9388732aa53da50828a37884c88adae7fd313839", "patch": "@@ -1,3 +1,11 @@\n+2017-11-22  Tamar Christina  <tamar.christina@arm.com>\n+\n+\t* config/arm/arm_neon.h (vdot_u32, vdotq_u32)\n+\t(vdot_s32, vdotq_s32): New.\n+\t(vdot_lane_u32, vdotq_lane_u32): New.\n+\t(vdot_lane_s32, vdotq_lane_s32): New.\n+\n+\n 2017-11-22  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \tPR middle-end/82547"}, {"sha": "3c9a8d90e53bc557fb611a1c4fc998ddc96413c6", "filename": "gcc/config/arm/arm_neon.h", "status": "modified", "additions": 66, "deletions": 0, "changes": 66, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9388732aa53da50828a37884c88adae7fd313839/gcc%2Fconfig%2Farm%2Farm_neon.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9388732aa53da50828a37884c88adae7fd313839/gcc%2Fconfig%2Farm%2Farm_neon.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm_neon.h?ref=9388732aa53da50828a37884c88adae7fd313839", "patch": "@@ -18034,6 +18034,72 @@ vzipq_f16 (float16x8_t __a, float16x8_t __b)\n \n #endif\n \n+/* AdvSIMD Dot Product intrinsics.  */\n+\n+#pragma GCC push_options\n+#if __ARM_ARCH >= 8\n+#pragma GCC target (\"arch=armv8.2-a+dotprod\")\n+\n+__extension__ extern __inline uint32x2_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdot_u32 (uint32x2_t __r, uint8x8_t __a, uint8x8_t __b)\n+{\n+  return __builtin_neon_udotv8qi_uuuu (__r, __a, __b);\n+}\n+\n+__extension__ extern __inline uint32x4_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdotq_u32 (uint32x4_t __r, uint8x16_t __a, uint8x16_t __b)\n+{\n+  return __builtin_neon_udotv16qi_uuuu (__r, __a, __b);\n+}\n+\n+__extension__ extern __inline int32x2_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdot_s32 (int32x2_t __r, int8x8_t __a, int8x8_t __b)\n+{\n+  return __builtin_neon_sdotv8qi (__r, __a, __b);\n+}\n+\n+__extension__ extern __inline int32x4_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdotq_s32 (int32x4_t __r, int8x16_t __a, int8x16_t __b)\n+{\n+  return __builtin_neon_sdotv16qi (__r, __a, __b);\n+}\n+\n+__extension__ extern __inline uint32x2_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdot_lane_u32 (uint32x2_t __r, uint8x8_t __a, uint8x8_t __b, const int __index)\n+{\n+  return __builtin_neon_udot_lanev8qi_uuuus (__r, __a, __b, __index);\n+}\n+\n+__extension__ extern __inline uint32x4_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdotq_lane_u32 (uint32x4_t __r, uint8x16_t __a, uint8x8_t __b,\n+\t\tconst int __index)\n+{\n+  return __builtin_neon_udot_lanev16qi_uuuus (__r, __a, __b, __index);\n+}\n+\n+__extension__ extern __inline int32x2_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdot_lane_s32 (int32x2_t __r, int8x8_t __a, int8x8_t __b, const int __index)\n+{\n+  return __builtin_neon_sdot_lanev8qi (__r, __a, __b, __index);\n+}\n+\n+__extension__ extern __inline int32x4_t\n+__attribute__ ((__always_inline__, __gnu_inline__, __artificial__))\n+vdotq_lane_s32 (int32x4_t __r, int8x16_t __a, int8x8_t __b, const int __index)\n+{\n+  return __builtin_neon_sdot_lanev16qi (__r, __a, __b, __index);\n+}\n+\n+#pragma GCC pop_options\n+#endif\n+\n #ifdef __cplusplus\n }\n #endif"}, {"sha": "04d1b2c1523e29a83f148e7a3293961c3b10ad31", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9388732aa53da50828a37884c88adae7fd313839", "patch": "@@ -1,3 +1,10 @@\n+2017-11-22  Tamar Christina  <tamar.christina@arm.com>\n+\n+\t* gcc.target/arm/simd/vdot-compile.c: New.\n+\t* gcc.target/arm/simd/vect-dot-qi.h: New.\n+\t* gcc.target/arm/simd/vect-dot-s8.c: New.\n+\t* gcc.target/arm/simd/vect-dot-u8.c: New\n+\n 2017-11-22  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* lib/target-supports.exp (check_effective_target_bswap16):"}, {"sha": "b3bd3bf00e3822fdd60b5955165583d5a5cdc1d0", "filename": "gcc/testsuite/gcc.target/arm/simd/vdot-compile.c", "status": "added", "additions": 56, "deletions": 0, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvdot-compile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvdot-compile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvdot-compile.c?ref=9388732aa53da50828a37884c88adae7fd313839", "patch": "@@ -0,0 +1,56 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-O3\" } */\n+/* { dg-require-effective-target arm_v8_2a_dotprod_neon_ok } */\n+/* { dg-add-options arm_v8_2a_dotprod_neon }  */\n+\n+#include <arm_neon.h>\n+\n+/* Unsigned Dot Product instructions.  */\n+\n+uint32x2_t ufoo (uint32x2_t r, uint8x8_t x, uint8x8_t y)\n+{\n+  return vdot_u32 (r, x, y);\n+}\n+\n+uint32x4_t ufooq (uint32x4_t r, uint8x16_t x, uint8x16_t y)\n+{\n+  return vdotq_u32 (r, x, y);\n+}\n+\n+uint32x2_t ufoo_lane (uint32x2_t r, uint8x8_t x, uint8x8_t y)\n+{\n+  return vdot_lane_u32 (r, x, y, 0);\n+}\n+\n+uint32x4_t ufooq_lane (uint32x4_t r, uint8x16_t x, uint8x8_t y)\n+{\n+  return vdotq_lane_u32 (r, x, y, 0);\n+}\n+\n+/* Signed Dot Product instructions.  */\n+\n+int32x2_t sfoo (int32x2_t r, int8x8_t x, int8x8_t y)\n+{\n+  return vdot_s32 (r, x, y);\n+}\n+\n+int32x4_t sfooq (int32x4_t r, int8x16_t x, int8x16_t y)\n+{\n+  return vdotq_s32 (r, x, y);\n+}\n+\n+int32x2_t sfoo_lane (int32x2_t r, int8x8_t x, int8x8_t y)\n+{\n+  return vdot_lane_s32 (r, x, y, 0);\n+}\n+\n+int32x4_t sfooq_lane (int32x4_t r, int8x16_t x, int8x8_t y)\n+{\n+  return vdotq_lane_s32 (r, x, y, 0);\n+}\n+\n+/* { dg-final { scan-assembler-times {v[us]dot\\.[us]8\\td[0-9]+, d[0-9]+, d[0-9]+} 4 } } */\n+/* { dg-final { scan-assembler-times {v[us]dot\\.[us]8\\tq[0-9]+, q[0-9]+, q[0-9]+} 2 } } */\n+/* { dg-final { scan-assembler-times {v[us]dot\\.[us]8\\td[0-9]+, d[0-9]+, d[0-9]+\\[#?[0-9]\\]} 2 } } */\n+/* { dg-final { scan-assembler-times {v[us]dot\\.[us]8\\tq[0-9]+, q[0-9]+, d[0-9]+\\[#?[0-9]\\]} 2 } } */\n+"}, {"sha": "ea5c212419d59afc37d5e6bbb51c4a8cb188d8dc", "filename": "gcc/testsuite/gcc.target/arm/simd/vect-dot-qi.h", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-qi.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-qi.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-qi.h?ref=9388732aa53da50828a37884c88adae7fd313839", "patch": "@@ -0,0 +1,16 @@\n+TYPE char X[N] __attribute__ ((__aligned__(__BIGGEST_ALIGNMENT__)));\n+TYPE char Y[N] __attribute__ ((__aligned__(__BIGGEST_ALIGNMENT__)));\n+\n+__attribute__ ((noinline)) int\n+foo1(int len) {\n+  int i;\n+  TYPE int result = 0;\n+  TYPE short prod;\n+\n+  for (i=0; i<len; i++) {\n+    prod = X[i] * Y[i];\n+    result += prod;\n+  }\n+  return result;\n+}\n+"}, {"sha": "d0b9d8ae71a1eeeb28e21c4644e69dca841dfd08", "filename": "gcc/testsuite/gcc.target/arm/simd/vect-dot-s8.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-s8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-s8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-s8.c?ref=9388732aa53da50828a37884c88adae7fd313839", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-O3\" } */\n+/* { dg-require-effective-target arm_v8_2a_dotprod_neon_ok } */\n+/* { dg-add-options arm_v8_2a_dotprod_neon }  */\n+\n+#define N 64\n+#define TYPE signed\n+\n+#include \"vect-dot-qi.h\"\n+\n+/* { dg-final { scan-assembler-times {vsdot\\.s8\\tq[0-9]+, q[0-9]+, q[0-9]+} 4 } } */\n+"}, {"sha": "957be3c98862078844334eaba90ec9fe10a73bf0", "filename": "gcc/testsuite/gcc.target/arm/simd/vect-dot-u8.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-u8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9388732aa53da50828a37884c88adae7fd313839/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-u8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fsimd%2Fvect-dot-u8.c?ref=9388732aa53da50828a37884c88adae7fd313839", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-O3\" } */\n+/* { dg-require-effective-target arm_v8_2a_dotprod_neon_ok } */\n+/* { dg-add-options arm_v8_2a_dotprod_neon }  */\n+\n+#define N 64\n+#define TYPE unsigned\n+\n+#include \"vect-dot-qi.h\"\n+\n+/* { dg-final { scan-assembler-times {vudot\\.u8\\tq[0-9]+, q[0-9]+, q[0-9]+} 4 } } */\n+"}]}