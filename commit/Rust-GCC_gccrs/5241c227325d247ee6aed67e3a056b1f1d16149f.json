{"sha": "5241c227325d247ee6aed67e3a056b1f1d16149f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTI0MWMyMjczMjVkMjQ3ZWU2YWVkNjdlM2EwNTZiMWYxZDE2MTQ5Zg==", "commit": {"author": {"name": "John David Anglin", "email": "dave@hiauly1.hia.nrc.ca", "date": "2001-08-03T22:13:22Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2001-08-03T22:13:22Z"}, "message": "gthr-dce.h (__GTHREAD_MUTEX_INIT_FUNCTION and __GTHREAD_MUTEX_INIT_DEFAULT): New macros for mutex initialization.\n\n\t* gthr-dce.h (__GTHREAD_MUTEX_INIT_FUNCTION and\n\t__GTHREAD_MUTEX_INIT_DEFAULT): New macros for mutex initialization.\n\t(__gthread_key_delete): Remove code for __PTHREAD_LIBRARY_VERSION_1 >= 1\n\t(__gthread_mutex_init_function): New function for mutex initialization.\n\nFrom-SVN: r44614", "tree": {"sha": "65da7a56e6ee8f546a8176fc1928dbd11ecc6ec1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/65da7a56e6ee8f546a8176fc1928dbd11ecc6ec1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5241c227325d247ee6aed67e3a056b1f1d16149f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5241c227325d247ee6aed67e3a056b1f1d16149f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5241c227325d247ee6aed67e3a056b1f1d16149f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5241c227325d247ee6aed67e3a056b1f1d16149f/comments", "author": null, "committer": null, "parents": [{"sha": "cbec65739c1937dafec8f879cfaa7e891bdfef9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbec65739c1937dafec8f879cfaa7e891bdfef9a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cbec65739c1937dafec8f879cfaa7e891bdfef9a"}], "stats": {"total": 30, "additions": 19, "deletions": 11}, "files": [{"sha": "06a0e9668a93e60392ca1058fc3eb71c126e1e5f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5241c227325d247ee6aed67e3a056b1f1d16149f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5241c227325d247ee6aed67e3a056b1f1d16149f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5241c227325d247ee6aed67e3a056b1f1d16149f", "patch": "@@ -1,3 +1,10 @@\n+2001-08-03  John David Anglin  <dave@hiauly1.hia.nrc.ca>\n+\n+\t* gthr-dce.h (__GTHREAD_MUTEX_INIT_FUNCTION and\n+\t__GTHREAD_MUTEX_INIT_DEFAULT): New macros for mutex initialization.\n+\t(__gthread_key_delete): Remove code for __PTHREAD_LIBRARY_VERSION_1 >= 1\n+\t(__gthread_mutex_init_function): New function for mutex initialization.\n+\n 2001-08-03  Daniel Berlin  <dan@cgsoftware.com>\n         \n \t* Makefile.in: Revert screwed up commit."}, {"sha": "916aefd12c3b511a24dbad78265dc7b3f28bdc09", "filename": "gcc/gthr-dce.h", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5241c227325d247ee6aed67e3a056b1f1d16149f/gcc%2Fgthr-dce.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5241c227325d247ee6aed67e3a056b1f1d16149f/gcc%2Fgthr-dce.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgthr-dce.h?ref=5241c227325d247ee6aed67e3a056b1f1d16149f", "patch": "@@ -48,7 +48,10 @@ typedef pthread_once_t __gthread_once_t;\n typedef pthread_mutex_t __gthread_mutex_t;\n \n #define __GTHREAD_ONCE_INIT pthread_once_init\n-/* Howto define __GTHREAD_MUTEX_INIT? */\n+\n+#define __GTHREAD_MUTEX_INIT_FUNCTION __gthread_mutex_init_function\n+\n+#define __GTHREAD_MUTEX_INIT_DEFAULT pthread_once_init\n \n #if SUPPORTS_WEAK && GTHREAD_USE_WEAK\n \n@@ -59,7 +62,7 @@ typedef pthread_mutex_t __gthread_mutex_t;\n #pragma weak pthread_getspecific\n #pragma weak pthread_setspecific\n #pragma weak pthread_create\n-\n+#pragma weak pthread_mutex_init\n #pragma weak pthread_mutex_lock\n #pragma weak pthread_mutex_trylock\n #pragma weak pthread_mutex_unlock\n@@ -73,7 +76,6 @@ typedef pthread_mutex_t __gthread_mutex_t;\n #pragma weak pthread_cond_wait\n #pragma weak pthread_exit\n #pragma weak pthread_getunique_np\n-#pragma weak pthread_mutex_init\n #pragma weak pthread_mutex_destroy\n #pragma weak pthread_self\n #pragma weak pthread_yield\n@@ -424,20 +426,12 @@ __gthread_key_dtor (UNUSED (__gthread_key_t key), UNUSED (void *ptr))\n   return 0;\n }\n \n-#if defined (__PTHREAD_LIBRARY_VERSION_1) && __PTHREAD_LIBRARY_VERSION_1 >= 1\n-static inline int\n-__gthread_key_delete (__gthread_key_t key)\n-{\n-  return pthread_key_delete (key);\n-}\n-#else\n static inline int\n __gthread_key_delete (UNUSED (__gthread_key_t key))\n {\n   /* Operation is not supported.  */\n   return -1;\n }\n-#endif\n \n static inline void *\n __gthread_getspecific (__gthread_key_t key)\n@@ -455,6 +449,13 @@ __gthread_setspecific (__gthread_key_t key, const void *ptr)\n   return pthread_setspecific (key, (void *) ptr);\n }\n \n+static inline void\n+__gthread_mutex_init_function (__gthread_mutex_t *mutex)\n+{\n+  if (__gthread_active_p ())\n+    pthread_mutex_init (mutex, pthread_mutexattr_default);\n+}\n+\n static inline int\n __gthread_mutex_lock (__gthread_mutex_t *mutex)\n {"}]}