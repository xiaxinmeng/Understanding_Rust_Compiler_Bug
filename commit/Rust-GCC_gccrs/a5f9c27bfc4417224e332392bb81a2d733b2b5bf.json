{"sha": "a5f9c27bfc4417224e332392bb81a2d733b2b5bf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTVmOWMyN2JmYzQ0MTcyMjRlMzMyMzkyYmI4MWEyZDczM2IyYjViZg==", "commit": {"author": {"name": "Andrew MacLeod", "email": "amacleod@redhat.com", "date": "2020-11-17T15:04:38Z"}, "committer": {"name": "Andrew MacLeod", "email": "amacleod@redhat.com", "date": "2020-11-17T16:58:07Z"}, "message": "IOR with nonzero, range cannot contain 0.\n\nRemove zero from IOR ranges with non-zero masks.\n\n\tgcc/\n\tPR tree-optimization/83072\n\t* range-op.cc (wi_optimize_and_or): Remove zero from IOR range when\n\tmask is non-zero.\n\tgcc/testsuite/\n\t* gcc.dg/pr83072.c: New.", "tree": {"sha": "4924d184b2ab656e77a14f962af4844954438028", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4924d184b2ab656e77a14f962af4844954438028"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a5f9c27bfc4417224e332392bb81a2d733b2b5bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5f9c27bfc4417224e332392bb81a2d733b2b5bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5f9c27bfc4417224e332392bb81a2d733b2b5bf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5f9c27bfc4417224e332392bb81a2d733b2b5bf/comments", "author": null, "committer": null, "parents": [{"sha": "c2cf58f0e3a32b803c890ea8daa8d9f550cf9888", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2cf58f0e3a32b803c890ea8daa8d9f550cf9888", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2cf58f0e3a32b803c890ea8daa8d9f550cf9888"}], "stats": {"total": 22, "additions": 22, "deletions": 0}, "files": [{"sha": "d0adc95527a5ac2c532fe22ea9cfa912e6153e9f", "filename": "gcc/range-op.cc", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5f9c27bfc4417224e332392bb81a2d733b2b5bf/gcc%2Frange-op.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5f9c27bfc4417224e332392bb81a2d733b2b5bf/gcc%2Frange-op.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frange-op.cc?ref=a5f9c27bfc4417224e332392bb81a2d733b2b5bf", "patch": "@@ -2163,6 +2163,14 @@ wi_optimize_and_or (irange &r,\n   else\n     gcc_unreachable ();\n   value_range_with_overflow (r, type, res_lb, res_ub);\n+\n+  // Furthermore, if the mask is non-zero, an IOR cannot contain zero.\n+  if (code == BIT_IOR_EXPR && wi::ne_p (mask, 0))\n+    {\n+      int_range<2> tmp;\n+      tmp.set_nonzero (type);\n+      r.intersect (tmp);\n+    }\n   return true;\n }\n "}, {"sha": "3bed8d890139c407a01d5aead5a88fb23f3d268e", "filename": "gcc/testsuite/gcc.dg/pr83072.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a5f9c27bfc4417224e332392bb81a2d733b2b5bf/gcc%2Ftestsuite%2Fgcc.dg%2Fpr83072.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a5f9c27bfc4417224e332392bb81a2d733b2b5bf/gcc%2Ftestsuite%2Fgcc.dg%2Fpr83072.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr83072.c?ref=a5f9c27bfc4417224e332392bb81a2d733b2b5bf", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-evrp -fno-tree-ccp -fno-tree-forwprop -fno-tree-fre\" } */\n+\n+void kill (void);\n+\n+int f(int c){\n+  c |= 1;\n+  if (c == 0)\n+    kill ();\n+\n+  return c;\n+}\n+\n+/* { dg-final { scan-tree-dump-not \"kill\" \"evrp\" } }  */"}]}