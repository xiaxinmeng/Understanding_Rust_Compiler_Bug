{"sha": "48fbb62da172a73e7b585a272fada37f28443d27", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDhmYmI2MmRhMTcyYTczZTdiNTg1YTI3MmZhZGEzN2YyODQ0M2QyNw==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2008-08-04T09:36:46Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-08-04T09:36:46Z"}, "message": "mlib.adb (Create_Sym_Links): Create relative symbolic links when requested\n\n2008-08-04  Vincent Celier  <celier@adacore.com>\n\n\t* mlib.adb (Create_Sym_Links): Create relative symbolic links when\n\trequested\n\nFrom-SVN: r138593", "tree": {"sha": "2bf1558f1f68834a1659f340a7bf340c58da3207", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2bf1558f1f68834a1659f340a7bf340c58da3207"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/48fbb62da172a73e7b585a272fada37f28443d27", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48fbb62da172a73e7b585a272fada37f28443d27", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48fbb62da172a73e7b585a272fada37f28443d27", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48fbb62da172a73e7b585a272fada37f28443d27/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f2170041e1db5fbc2809310d2eba081f41f94403", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2170041e1db5fbc2809310d2eba081f41f94403", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f2170041e1db5fbc2809310d2eba081f41f94403"}], "stats": {"total": 23, "additions": 9, "deletions": 14}, "files": [{"sha": "0bb3a99fbfb96901c08400166d0af453e43a67a1", "filename": "gcc/ada/mlib.adb", "status": "modified", "additions": 9, "deletions": 14, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48fbb62da172a73e7b585a272fada37f28443d27/gcc%2Fada%2Fmlib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48fbb62da172a73e7b585a272fada37f28443d27/gcc%2Fada%2Fmlib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib.adb?ref=48fbb62da172a73e7b585a272fada37f28443d27", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---                     Copyright (C) 1999-2007, AdaCore                     --\n+--                     Copyright (C) 1999-2008, AdaCore                     --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -310,18 +310,9 @@ package body MLib is\n       pragma Unreferenced (Success, Result);\n \n    begin\n-      if Is_Absolute_Path (Lib_Version) then\n-         Version_Path := new String (1 .. Lib_Version'Length + 1);\n-         Version_Path (1 .. Lib_Version'Length) := Lib_Version;\n-\n-      else\n-         Version_Path :=\n-           new String (1 .. Lib_Dir'Length + 1 + Lib_Version'Length + 1);\n-         Version_Path (1 .. Version_Path'Last - 1) :=\n-           Lib_Dir & Directory_Separator & Lib_Version;\n-      end if;\n-\n-      Version_Path (Version_Path'Last) := ASCII.NUL;\n+      Version_Path := new String (1 .. Lib_Version'Length + 1);\n+      Version_Path (1 .. Lib_Version'Length) := Lib_Version;\n+      Version_Path (Version_Path'Last)       := ASCII.NUL;\n \n       if Maj_Version'Length = 0 then\n          declare\n@@ -339,6 +330,7 @@ package body MLib is\n             Maj_Path : constant String :=\n                          Lib_Dir & Directory_Separator & Maj_Version;\n             Newpath2 : String (1 .. Maj_Path'Length + 1);\n+            Maj_Ver  : String (1 .. Maj_Version'Length + 1);\n \n          begin\n             Newpath1 (1 .. Lib_Path'Length) := Lib_Path;\n@@ -347,13 +339,16 @@ package body MLib is\n             Newpath2 (1 .. Maj_Path'Length) := Maj_Path;\n             Newpath2 (Newpath2'Last)        := ASCII.NUL;\n \n+            Maj_Ver (1 .. Maj_Version'Length) := Maj_Version;\n+            Maj_Ver (Maj_Ver'Last)            := ASCII.NUL;\n+\n             Delete_File (Maj_Path, Success);\n \n             Result := Symlink (Version_Path (1)'Address, Newpath2'Address);\n \n             Delete_File (Lib_Path, Success);\n \n-            Result := Symlink (Newpath2'Address, Newpath1'Address);\n+            Result := Symlink (Maj_Ver'Address, Newpath1'Address);\n          end;\n       end if;\n    end Create_Sym_Links;"}]}