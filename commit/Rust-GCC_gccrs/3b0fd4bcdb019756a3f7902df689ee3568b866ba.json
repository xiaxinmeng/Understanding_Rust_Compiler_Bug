{"sha": "3b0fd4bcdb019756a3f7902df689ee3568b866ba", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2IwZmQ0YmNkYjAxOTc1NmEzZjc5MDJkZjY4OWVlMzU2OGI4NjZiYQ==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2001-06-12T02:30:37Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2001-06-12T02:30:37Z"}, "message": "basic_string.h (string::compare): Adjust signatures as per DR 5.\n\n\n2001-06-11  Benjamin Kosnik  <bkoz@redhat.com>\n\n\tlibstdc++/3126\n\t* include/bits/basic_string.h (string::compare): Adjust signatures\n\tas per DR 5.\n\t* include/bits/basic_string.tcc: And here.\n\n\tlibstdc++/2346\n\t* config/c_io_stdio.h: Remove whitespace.\n\t* testsuite/27_io/istream_seeks.cc (test03): Add regression.\n\t(test02): Add regression.\n\t* testsuite/27_io/istream_seeks-3.tst: New file.\n\nFrom-SVN: r43240", "tree": {"sha": "1c224bfab1803de1debc3780ac8f957f19874588", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c224bfab1803de1debc3780ac8f957f19874588"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3b0fd4bcdb019756a3f7902df689ee3568b866ba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b0fd4bcdb019756a3f7902df689ee3568b866ba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b0fd4bcdb019756a3f7902df689ee3568b866ba", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b0fd4bcdb019756a3f7902df689ee3568b866ba/comments", "author": null, "committer": null, "parents": [{"sha": "9dffe3b49e68cbab5ae18813b725eafd9c985ea5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9dffe3b49e68cbab5ae18813b725eafd9c985ea5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9dffe3b49e68cbab5ae18813b725eafd9c985ea5"}], "stats": {"total": 138, "additions": 122, "deletions": 16}, "files": [{"sha": "ccf316ff0561f4a7fddce27e06bf3e0a57969202", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=3b0fd4bcdb019756a3f7902df689ee3568b866ba", "patch": "@@ -1,3 +1,16 @@\n+2001-06-11  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\tlibstdc++/3126\n+\t* include/bits/basic_string.h (string::compare): Adjust signatures\n+\tas per DR 5.\n+\t* include/bits/basic_string.tcc: And here.\n+\n+\tlibstdc++/2346\n+\t* config/c_io_stdio.h: Remove whitespace.\n+\t* testsuite/27_io/istream_seeks.cc (test03): Add regression.\n+\t(test02): Add regression.\n+\t* testsuite/27_io/istream_seeks-3.tst: New file.\n+\t\n 2001-06-11  Phil Edwards  <pme@sources.redhat.com>\n \n \t* README:  Update to reflect reality."}, {"sha": "1ea8b3081fce55505b207f997e4acc21043bb88c", "filename": "libstdc++-v3/config/c_io_stdio.h", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Fconfig%2Fc_io_stdio.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Fconfig%2Fc_io_stdio.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fconfig%2Fc_io_stdio.h?ref=3b0fd4bcdb019756a3f7902df689ee3568b866ba", "patch": "@@ -92,13 +92,3 @@ namespace std\n }\n \n #endif // _CPP_IO_STDIO_H\n-\n-\n-\n-\n-\n-\n-\n-\n-\n-"}, {"sha": "ef08da102f5f30620915ed29db9f22350b5c4f83", "filename": "libstdc++-v3/include/bits/basic_string.h", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h?ref=3b0fd4bcdb019756a3f7902df689ee3568b866ba", "patch": "@@ -842,9 +842,15 @@ namespace std\n       int \n       compare(const _CharT* __s) const;\n \n+#ifdef _GLIBCPP_RESOLVE_LIB_DEFECTS\n+// 5. String::compare specification questionable\n+      int \n+      compare(size_type __pos, size_type __n1, const _CharT* __s) const;\n+\n       int \n       compare(size_type __pos, size_type __n1, const _CharT* __s, \n-\t      size_type __n2 = npos) const;\n+\t      size_type __n2) const;\n+#endif\n   };\n \n "}, {"sha": "9a05d2c8ac75573e8c905b219aa17a7eca8e71cc", "filename": "libstdc++-v3/include/bits/basic_string.tcc", "status": "modified", "additions": 20, "deletions": 3, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.tcc?ref=3b0fd4bcdb019756a3f7902df689ee3568b866ba", "patch": "@@ -809,6 +809,24 @@ namespace std\n     }\n \n \n+  template<typename _CharT, typename _Traits, typename _Alloc>\n+    int\n+    basic_string <_CharT,_Traits,_Alloc>::\n+    compare(size_type __pos, size_type __n1, const _CharT* __s) const\n+    {\n+      size_type __size = this->size();\n+      if (__pos > __size)\n+\t__throw_out_of_range(\"basic_string::compare\");\n+      \n+      size_type __osize = traits_type::length(__s);\n+      size_type __rsize = min(__size - __pos, __n1);\n+      size_type __len = min(__rsize, __osize);\n+      int __r = traits_type::compare(_M_data() + __pos, __s, __len);\n+      if (!__r)\n+\t__r = __rsize - __osize;\n+      return __r;\n+    }\n+\n   template<typename _CharT, typename _Traits, typename _Alloc>\n     int\n     basic_string <_CharT,_Traits,_Alloc>::\n@@ -839,7 +857,6 @@ namespace std\n       _Traits::copy(__buf, __str.data(), __bytes);\n       __buf[__bytes] = _CharT();\n     }\n+} // namespace std\n \n-} // std::\n-\n-#endif /* _CPP_BITS_STRING_TCC */\n+#endif"}, {"sha": "dc45fc9330a690eca9ece9530175250fea98e72d", "filename": "libstdc++-v3/testsuite/27_io/istream_seeks-3.tst", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_seeks-3.tst", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_seeks-3.tst", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_seeks-3.tst?ref=3b0fd4bcdb019756a3f7902df689ee3568b866ba", "patch": "@@ -0,0 +1,10 @@\n+0-0 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-1 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-2 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-3 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-4 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-5 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-6 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-7 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-8 lootpack, peanut butter wolf, rob swift, madlib, quasimoto\n+0-9 lootpack, peanut butter wolf, rob swift, madlib, quasimoto"}, {"sha": "a8f138eb7b41a8c5520014ec269958d07d5256be", "filename": "libstdc++-v3/testsuite/27_io/istream_seeks.cc", "status": "modified", "additions": 72, "deletions": 2, "changes": 74, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_seeks.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b0fd4bcdb019756a3f7902df689ee3568b866ba/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_seeks.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fistream_seeks.cc?ref=3b0fd4bcdb019756a3f7902df689ee3568b866ba", "patch": "@@ -1,6 +1,6 @@\n // 2000-06-29 bkoz\n \n-// Copyright (C) 2000 Free Software Foundation\n+// Copyright (C) 2000, 2001 Free Software Foundation\n //\n // This file is part of the GNU ISO C++ Library.  This library is free\n // software; you can redistribute it and/or modify it under the\n@@ -28,7 +28,6 @@\n #include <fstream>\n #include <debug_assert.h>\n \n-\n bool test01()\n {\n   using namespace std;\n@@ -64,6 +63,71 @@ bool test01()\n   return test;\n }\n \n+const char* s = \" lootpack, peanut butter wolf, rob swift, madlib, quasimoto\";\n+const int times = 10;\n+\n+void write_rewind(std::iostream& stream)\n+{\n+  for (int j = 0; j < times; j++) \n+    {\n+      bool test = true;\n+      std::streampos begin = stream.tellg();\n+      \n+      for (int i = 0; i < times; ++i)\n+\tstream << j << '-' << i << s << '\\n';\n+      \n+      stream.seekg(begin);\n+      std::streampos end = stream.tellg(); \n+      std::streampos badpos = std::streampos(std::streambuf::off_type(-1));\n+    }\n+}\n+\n+void check_contents(std::iostream& stream)\n+{\n+  bool test = true;\n+\n+  stream.clear();\n+  stream.seekg(0, std::ios::beg);\n+  int i = 0;\n+  int loop = times * times + 2;\n+  while (i < loop)\n+    {\n+      stream.ignore(80, '\\n');\n+      if (stream.good())\n+\t++i;\n+      else\n+\tbreak;\n+    }\n+  VERIFY( i == times );\n+}\n+\n+// fstream\n+// libstdc++/2346\n+void test02()\n+{\t \n+  std::fstream ofstrm;\n+  ofstrm.open(\"istream_seeks-3.txt\", std::ios::out);\n+  if (!ofstrm)\n+    abort();\n+  write_rewind(ofstrm);\n+  ofstrm.close();\n+\n+  std::fstream ifstrm;\n+  ifstrm.open(\"istream_seeks-3.txt\", std::ios::in);\n+  check_contents(ifstrm);\n+  ifstrm.close();\n+}\n+\n+// stringstream\n+// libstdc++/2346\n+void test03()\n+{\t \n+  std::stringstream sstrm;\n+\n+  write_rewind(sstrm);\n+  check_contents(sstrm);\n+}\n+\n // fstreams\n void test04(void)\n {\n@@ -289,7 +353,13 @@ void test05(void)\n int main()\n {\n   test01();\n+\n+  test02();\n+  test03();\n+\n   test04();\n   test05();\n   return 0;\n }\n+\n+"}]}