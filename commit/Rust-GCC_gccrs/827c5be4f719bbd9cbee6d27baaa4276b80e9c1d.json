{"sha": "827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODI3YzViZTRmNzE5YmJkOWNiZWU2ZDI3YmFhYTQyNzZiODBlOWMxZA==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2009-11-18T13:24:54Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2009-11-18T13:24:54Z"}, "message": "re PR fortran/42072 ([F03] wrong-code with C_F_PROCPOINTER)\n\n2009-11-18  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/42072\n\t* trans-expr.c (gfc_conv_procedure_call): Handle procedure pointer\n\tdummies which are passed to C_F_PROCPOINTER.\n\n\n2009-11-18  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/42072\n\t* gfortran.dg/proc_ptr_8.f90: Extended.\n\nFrom-SVN: r154292", "tree": {"sha": "e7481856097ba3bd34a1792c5acf2dbc4954abcf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e7481856097ba3bd34a1792c5acf2dbc4954abcf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "965b98d04ba5577aaaa2e1e48a8d9ba6dba35da9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/965b98d04ba5577aaaa2e1e48a8d9ba6dba35da9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/965b98d04ba5577aaaa2e1e48a8d9ba6dba35da9"}], "stats": {"total": 41, "additions": 33, "deletions": 8}, "files": [{"sha": "e1f72a12f98d8b58a5bd9c0414bee8ae21110d04", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "patch": "@@ -1,3 +1,9 @@\n+2009-11-18  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/42072\n+\t* trans-expr.c (gfc_conv_procedure_call): Handle procedure pointer\n+\tdummies which are passed to C_F_PROCPOINTER.\n+\n 2009-11-18  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* module.c (mio_f2k_derived): Initialize op."}, {"sha": "b72d5401bae2d36edc4a8f313510efcbbb8d767a", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "patch": "@@ -2640,13 +2640,16 @@ gfc_conv_procedure_call (gfc_se * se, gfc_symbol * sym,\n \t  gfc_conv_expr (&fptrse, arg->next->expr);\n \t  gfc_add_block_to_block (&se->pre, &fptrse.pre);\n \t  gfc_add_block_to_block (&se->post, &fptrse.post);\n-\n-\t  if (gfc_is_proc_ptr_comp (arg->next->expr, NULL))\n-\t    tmp = gfc_get_ppc_type (arg->next->expr->ref->u.c.component);\n-\t  else\n-\t    tmp = TREE_TYPE (arg->next->expr->symtree->n.sym->backend_decl);\n-\t  se->expr = fold_build2 (MODIFY_EXPR, tmp, fptrse.expr,\n-\t\t\t\t  fold_convert (tmp, cptrse.expr));\n+\t  \n+\t  if (arg->next->expr->symtree->n.sym->attr.proc_pointer\n+\t      && arg->next->expr->symtree->n.sym->attr.dummy)\n+\t    fptrse.expr = build_fold_indirect_ref_loc (input_location,\n+\t\t\t\t\t\t       fptrse.expr);\n+\t  \n+\t  se->expr = fold_build2 (MODIFY_EXPR, TREE_TYPE (fptrse.expr),\n+\t\t\t\t  fptrse.expr,\n+\t\t\t\t  fold_convert (TREE_TYPE (fptrse.expr),\n+\t\t\t\t\t\tcptrse.expr));\n \n \t  return 0;\n \t}"}, {"sha": "594210fe335a424c15d112917b1bf46dfbf2b785", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "patch": "@@ -1,3 +1,8 @@\n+2009-11-18  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/42072\n+\t* gfortran.dg/proc_ptr_8.f90: Extended.\n+\n 2009-11-18  Shujing Zhao  <pearly.zhao@oracle.com>\n \n \t* g++.old-deja/g++.other/crash28.C: Make expected dg-error strings"}, {"sha": "f45d114f833698aa63a50fe2209e0577a043c753", "filename": "gcc/testsuite/gfortran.dg/proc_ptr_8.f90", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_8.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/827c5be4f719bbd9cbee6d27baaa4276b80e9c1d/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_8.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fproc_ptr_8.f90?ref=827c5be4f719bbd9cbee6d27baaa4276b80e9c1d", "patch": "@@ -23,12 +23,23 @@ SUBROUTINE init() BIND(C,name=\"init\")\n END MODULE X\n \n USE X\n-PROCEDURE(mytype), POINTER :: ptype\n+PROCEDURE(mytype), POINTER :: ptype,ptype2\n \n CALL init()\n CALL C_F_PROCPOINTER(funpointer,ptype)\n if (ptype(3) /= 9) call abort()\n \n+! the stuff below was added with PR 42072\n+call setpointer(ptype2)\n+if (ptype2(4) /= 12) call abort()\n+\n+contains\n+\n+  subroutine setpointer (p)\n+    PROCEDURE(mytype), POINTER :: p\n+    CALL C_F_PROCPOINTER(funpointer,p)\n+  end subroutine\n+\n END\n \n ! { dg-final { cleanup-modules \"X\" } }"}]}