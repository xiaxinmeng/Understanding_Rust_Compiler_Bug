{"sha": "5703bb66031e55b695395004578410c8e4e08f31", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTcwM2JiNjYwMzFlNTViNjk1Mzk1MDA0NTc4NDEwYzhlNGUwOGYzMQ==", "commit": {"author": {"name": "Stan Cox", "email": "coxs@gnu.org", "date": "1996-07-25T18:07:48Z"}, "committer": {"name": "Stan Cox", "email": "coxs@gnu.org", "date": "1996-07-25T18:07:48Z"}, "message": "(output_float_compare): Added support for Pentium Pro\nfcomi instruction which sets EFLAGS instead of FPU Status Word.\n\nFrom-SVN: r12563", "tree": {"sha": "646bdcd8ad0430b73ac14263fbd2f22b56fa78d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/646bdcd8ad0430b73ac14263fbd2f22b56fa78d3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5703bb66031e55b695395004578410c8e4e08f31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5703bb66031e55b695395004578410c8e4e08f31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5703bb66031e55b695395004578410c8e4e08f31", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5703bb66031e55b695395004578410c8e4e08f31/comments", "author": null, "committer": null, "parents": [{"sha": "9ad91d711549e9c3def747befde85296702511d4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ad91d711549e9c3def747befde85296702511d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ad91d711549e9c3def747befde85296702511d4"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "4499248c38a52b4d1ba8c6f82e492d2ac863ced5", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5703bb66031e55b695395004578410c8e4e08f31/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5703bb66031e55b695395004578410c8e4e08f31/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=5703bb66031e55b695395004578410c8e4e08f31", "patch": "@@ -3548,6 +3548,7 @@ output_float_compare (insn, operands)\n   int stack_top_dies;\n   rtx body = XVECEXP (PATTERN (insn), 0, 0);\n   int unordered_compare = GET_MODE (SET_SRC (body)) == CCFPEQmode;\n+  int target_fcomi = TARGET_CMOVE && STACK_REG_P (operands[1]);\n \n   rtx tmp;\n   if (! STACK_TOP_P (operands[0]))\n@@ -3585,9 +3586,9 @@ output_float_compare (insn, operands)\n \t unordered float compare. */\n \n       if (unordered_compare)\n-\tstrcpy (buf, \"fucom\");\n+\tstrcpy (buf, target_fcomi ? \"fucomi\" : \"fucom\");\n       else if (GET_MODE_CLASS (GET_MODE (operands[1])) == MODE_FLOAT)\n-\tstrcpy (buf, \"fcom\");\n+\tstrcpy (buf, target_fcomi ? \"fcomi\" : \"fcom\");\n       else\n \tstrcpy (buf, \"ficom\");\n \n@@ -3598,6 +3599,13 @@ output_float_compare (insn, operands)\n \n       if (NON_STACK_REG_P (operands[1]))\n \toutput_op_from_reg (operands[1], strcat (buf, AS1 (%z0,%1)));\n+      else if (target_fcomi) \n+\t{\n+\t  rtx xops[] = {operands[0], operands[1], operands[0]};\n+\t  \n+\t  output_asm_insn (strcat (buf, AS2 (%z1,%y1,%2)), xops);\n+\t  RET;\n+\t}\n       else\n         output_asm_insn (strcat (buf, AS1 (%z1,%y1)), operands);\n     }"}]}