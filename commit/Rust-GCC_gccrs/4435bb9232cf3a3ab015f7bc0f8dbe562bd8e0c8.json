{"sha": "4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDQzNWJiOTIzMmNmM2EzYWIwMTVmN2JjMGY4ZGJlNTYyYmQ4ZTBjOA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2014-10-19T16:47:35Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2014-10-19T16:47:35Z"}, "message": "re PR c/63567 (Linux kernel build error due to non-static initializers)\n\n\tPR c/63567\n\t* c-typeck.c (output_init_element): Allow initializing objects with\n\tstatic storage duration with compound literals even in C99 and add\n\tpedwarn for it.\n\n\t* gcc.dg/pr63567-3.c: New test.\n\t* gcc.dg/pr63567-4.c: New test.\n\nFrom-SVN: r216440", "tree": {"sha": "ea2bf947f9fb2a51c3da0346c6c1a18b7d9ff357", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ea2bf947f9fb2a51c3da0346c6c1a18b7d9ff357"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f4b0b1e3bb4dd4d89efdee99b5d032302a5f4717", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4b0b1e3bb4dd4d89efdee99b5d032302a5f4717", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4b0b1e3bb4dd4d89efdee99b5d032302a5f4717"}], "stats": {"total": 32, "additions": 31, "deletions": 1}, "files": [{"sha": "397bf285fedebd49b89610a84dcf9e0ece5125b3", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "patch": "@@ -1,3 +1,10 @@\n+2014-10-19  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/63567\n+\t* c-typeck.c (output_init_element): Allow initializing objects with\n+\tstatic storage duration with compound literals even in C99 and add\n+\tpedwarn for it.\n+\n 2014-10-17  Marek Polacek  <polacek@redhat.com>\n \n \tPR c/63567"}, {"sha": "ee874daf758fb86f7dee8aa7d374c79b2f757123", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "patch": "@@ -8251,11 +8251,14 @@ output_init_element (location_t loc, tree value, tree origtype,\n     value = array_to_pointer_conversion (input_location, value);\n \n   if (TREE_CODE (value) == COMPOUND_LITERAL_EXPR\n-      && require_constant_value && !flag_isoc99 && pending)\n+      && require_constant_value && pending)\n     {\n       /* As an extension, allow initializing objects with static storage\n \t duration with compound literals (which are then treated just as\n \t the brace enclosed list they contain).  */\n+      if (flag_isoc99)\n+\tpedwarn_init (loc, OPT_Wpedantic, \"initializer element is not \"\n+\t\t      \"constant\");\n       tree decl = COMPOUND_LITERAL_EXPR_DECL (value);\n       value = DECL_INITIAL (decl);\n     }"}, {"sha": "b5c8fb78cd15234ed2344a0a308b22b49cd8e037", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "patch": "@@ -1,3 +1,9 @@\n+2014-10-19  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/63567\n+\t* gcc.dg/pr63567-3.c: New test.\n+\t* gcc.dg/pr63567-4.c: New test.\n+\n 2014-10-19  Adhemerval Zanella  <azanella@linux.vnet.ibm.com>\n \n \t* gcc.dg/atomic/c11-atomic-exec-5.c"}, {"sha": "d62640677b0a27db99883f4f2cb2782d96151e19", "filename": "gcc/testsuite/gcc.dg/pr63567-3.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr63567-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr63567-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr63567-3.c?ref=4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "patch": "@@ -0,0 +1,7 @@\n+/* PR c/63567 */\n+/* { dg-do compile } */\n+/* { dg-options \"\" } */\n+\n+struct T { int i; };\n+struct S { struct T t; };\n+struct S s = { .t = { (int) { 1 } } };"}, {"sha": "0ca6c45cc23cf6496aa30dc5e0219a4b45e867b2", "filename": "gcc/testsuite/gcc.dg/pr63567-4.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr63567-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8/gcc%2Ftestsuite%2Fgcc.dg%2Fpr63567-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr63567-4.c?ref=4435bb9232cf3a3ab015f7bc0f8dbe562bd8e0c8", "patch": "@@ -0,0 +1,7 @@\n+/* PR c/63567 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wpedantic\" } */\n+\n+struct T { int i; };\n+struct S { struct T t; };\n+struct S s = { .t = { (int) { 1 } } }; /* { dg-warning \"initializer element is not constant\" } */"}]}