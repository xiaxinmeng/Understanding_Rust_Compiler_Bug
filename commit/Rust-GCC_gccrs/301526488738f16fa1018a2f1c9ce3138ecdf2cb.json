{"sha": "301526488738f16fa1018a2f1c9ce3138ecdf2cb", "node_id": "C_kwDOANBUbNoAKDMwMTUyNjQ4ODczOGYxNmZhMTAxOGEyZjFjOWNlMzEzOGVjZGYyY2I", "commit": {"author": {"name": "Patrick Bernardi", "email": "bernardi@adacore.com", "date": "2021-11-03T21:55:50Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2021-11-10T08:57:41Z"}, "message": "[Ada] Do not assume a priority value of zero is a valid priority\n\ngcc/ada/\n\n\t* libgnarl/s-taskin.adb (Initialize_ATCB): Initialize\n\tT.Common.Current_Priority to Priority'First.\n\t* libgnarl/s-taskin.ads (Unspecified_Priority): Redefined as -1.\n\t* libgnat/system-rtems.ads: Start priority range from 1, as 0 is\n\treserved by the operating system.", "tree": {"sha": "808ac0a89503130b0299f048ba2b253d69b1c59a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/808ac0a89503130b0299f048ba2b253d69b1c59a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/301526488738f16fa1018a2f1c9ce3138ecdf2cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/301526488738f16fa1018a2f1c9ce3138ecdf2cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/301526488738f16fa1018a2f1c9ce3138ecdf2cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/301526488738f16fa1018a2f1c9ce3138ecdf2cb/comments", "author": {"login": "burratoo", "id": 23646118, "node_id": "MDQ6VXNlcjIzNjQ2MTE4", "avatar_url": "https://avatars.githubusercontent.com/u/23646118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/burratoo", "html_url": "https://github.com/burratoo", "followers_url": "https://api.github.com/users/burratoo/followers", "following_url": "https://api.github.com/users/burratoo/following{/other_user}", "gists_url": "https://api.github.com/users/burratoo/gists{/gist_id}", "starred_url": "https://api.github.com/users/burratoo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/burratoo/subscriptions", "organizations_url": "https://api.github.com/users/burratoo/orgs", "repos_url": "https://api.github.com/users/burratoo/repos", "events_url": "https://api.github.com/users/burratoo/events{/privacy}", "received_events_url": "https://api.github.com/users/burratoo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bbe3c88351bc98a9866720e03ef76e8caf516461", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbe3c88351bc98a9866720e03ef76e8caf516461", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bbe3c88351bc98a9866720e03ef76e8caf516461"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "1e6f42da39301088919abf8f09f91e8fa7f20aba", "filename": "gcc/ada/libgnarl/s-taskin.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/301526488738f16fa1018a2f1c9ce3138ecdf2cb/gcc%2Fada%2Flibgnarl%2Fs-taskin.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/301526488738f16fa1018a2f1c9ce3138ecdf2cb/gcc%2Fada%2Flibgnarl%2Fs-taskin.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnarl%2Fs-taskin.adb?ref=301526488738f16fa1018a2f1c9ce3138ecdf2cb", "patch": "@@ -127,7 +127,7 @@ package body System.Tasking is\n       end if;\n       pragma Assert (T.Common.Domain /= null);\n \n-      T.Common.Current_Priority         := 0;\n+      T.Common.Current_Priority         := Priority'First;\n       T.Common.Protected_Action_Nesting := 0;\n       T.Common.Call                     := null;\n       T.Common.Task_Arg                 := Task_Arg;"}, {"sha": "1751553c58c467f3479ee452ac448c1225f95838", "filename": "gcc/ada/libgnarl/s-taskin.ads", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/301526488738f16fa1018a2f1c9ce3138ecdf2cb/gcc%2Fada%2Flibgnarl%2Fs-taskin.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/301526488738f16fa1018a2f1c9ce3138ecdf2cb/gcc%2Fada%2Flibgnarl%2Fs-taskin.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnarl%2Fs-taskin.ads?ref=301526488738f16fa1018a2f1c9ce3138ecdf2cb", "patch": "@@ -773,7 +773,10 @@ package System.Tasking is\n    -- Priority info --\n    -------------------\n \n-   Unspecified_Priority : constant Integer := System.Priority'First - 1;\n+   Unspecified_Priority : constant Integer := -1;\n+   --  Indicates that a task has an unspecified priority. This is hardcoded as\n+   --  -1 rather than System.Priority'First - 1 as the value needs to be used\n+   --  in init.c to specify that the main task has no specified priority.\n \n    Priority_Not_Boosted : constant Integer := System.Priority'First - 1;\n    --  Definition of Priority actually has to come from the RTS configuration"}, {"sha": "77423d316ba4091a7e408e9861dbb87cfa6f7d2e", "filename": "gcc/ada/libgnat/system-rtems.ads", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/301526488738f16fa1018a2f1c9ce3138ecdf2cb/gcc%2Fada%2Flibgnat%2Fsystem-rtems.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/301526488738f16fa1018a2f1c9ce3138ecdf2cb/gcc%2Fada%2Flibgnat%2Fsystem-rtems.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fsystem-rtems.ads?ref=301526488738f16fa1018a2f1c9ce3138ecdf2cb", "patch": "@@ -109,15 +109,13 @@ package System is\n    --             hardware priority levels.  Protected Object ceilings can\n    --             override these values.\n    --  245        is used by the Interrupt_Manager task\n-   --  0          is reserved for the RTEMS IDLE task and really should not\n-   --             be accessible from Ada but GNAT initializes\n-   --             Current_Priority to 0 so it must be valid\n+   --  0          is reserved for the RTEMS IDLE task\n \n    Max_Priority           : constant Positive := 244;\n    Max_Interrupt_Priority : constant Positive := 254;\n \n-   subtype Any_Priority       is Integer      range   0 .. 254;\n-   subtype Priority           is Any_Priority range   0 .. 244;\n+   subtype Any_Priority       is Integer      range   1 .. 254;\n+   subtype Priority           is Any_Priority range   1 .. 244;\n    subtype Interrupt_Priority is Any_Priority range 245 .. 254;\n \n    Default_Priority : constant Priority := 122;"}]}