{"sha": "ab00eb0aa3dd2f42fd175d0792908f660b366e3b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWIwMGViMGFhM2RkMmY0MmZkMTc1ZDA3OTI5MDhmNjYwYjM2NmUzYg==", "commit": {"author": {"name": "Jim Wilson", "email": "wilson@cygnus.com", "date": "1997-11-05T00:55:50Z"}, "committer": {"name": "Jim Wilson", "email": "wilson@gcc.gnu.org", "date": "1997-11-05T00:55:50Z"}, "message": "Fix shared library problem found by GNAT users.\n\n\t* mips.c (mips_expand_epilogue): Emit blockage insn before call to\n\tsave_restore_insns if no FP and GP will be restored.\n\nFrom-SVN: r16327", "tree": {"sha": "bb081603eb324b51ec68b8b7e1e8f8d433609307", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bb081603eb324b51ec68b8b7e1e8f8d433609307"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ab00eb0aa3dd2f42fd175d0792908f660b366e3b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab00eb0aa3dd2f42fd175d0792908f660b366e3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab00eb0aa3dd2f42fd175d0792908f660b366e3b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab00eb0aa3dd2f42fd175d0792908f660b366e3b/comments", "author": null, "committer": null, "parents": [{"sha": "31c8581d25e55cd1a2507e215b5b6046919b2ab3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31c8581d25e55cd1a2507e215b5b6046919b2ab3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31c8581d25e55cd1a2507e215b5b6046919b2ab3"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "7a3f4da7a73c5da11984648a8b70522284f0cf6d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab00eb0aa3dd2f42fd175d0792908f660b366e3b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab00eb0aa3dd2f42fd175d0792908f660b366e3b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ab00eb0aa3dd2f42fd175d0792908f660b366e3b", "patch": "@@ -1,4 +1,7 @@\n-Tue Nov  4 12:30:28 1997  Jim Wilson  <wilson@cygnus.com>\n+Tue Nov  4 16:55:11 1997  Jim Wilson  <wilson@cygnus.com>\n+\n+\t* mips.c (mips_expand_epilogue): Emit blockage insn before call to\n+\tsave_restore_insns if no FP and GP will be restored.\n \n \t* dwarf2out.c (expand_builtin_dwarf_reg_size): New variable mode.\n \tConvert CCmode to word_mode before calling GET_MODE_SIZE."}, {"sha": "2d6984b8737be9ef663e31b1829d10d35093ee4f", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab00eb0aa3dd2f42fd175d0792908f660b366e3b/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab00eb0aa3dd2f42fd175d0792908f660b366e3b/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=ab00eb0aa3dd2f42fd175d0792908f660b366e3b", "patch": "@@ -5591,6 +5591,13 @@ mips_expand_epilogue ()\n \t  else\n \t    emit_insn (gen_movsi (stack_pointer_rtx, frame_pointer_rtx));\n \t}\n+      /* The GP/PIC register is implicitly used by all SYMBOL_REFs, so if we\n+\t are going to restore it, then we must emit a blockage insn to\n+\t prevent the scheduler from moving the restore out of the epilogue.  */\n+      else if (TARGET_ABICALLS && mips_abi != ABI_32\n+\t       && (current_frame_info.mask\n+\t\t   & (1L << (PIC_OFFSET_TABLE_REGNUM - GP_REG_FIRST))))\n+\temit_insn (gen_blockage ());\n \n       save_restore_insns (FALSE, tmp_rtx, tsize, (FILE *)0);\n "}]}