{"sha": "bfa7a1e994988ef5827505e0e7540b810150f984", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmZhN2ExZTk5NDk4OGVmNTgyNzUwNWUwZTc1NDBiODEwMTUwZjk4NA==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2006-09-10T04:53:18Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2006-09-10T04:53:18Z"}, "message": "re PR fortran/28914 (Code inside loop hangs; outside loop runs normally; runs OK on other compilers)\n\n2006-09-09  Paul Thomas <pault@gcc.gnu.org>\n\n\tPR fortran/28914\n\t* trans-array.c (gfc_trans_array_constructor_value): Create a temporary\n\tloop variable to hold the current loop variable in case it is modified\n\tby the array constructor.\n\nFrom-SVN: r116808", "tree": {"sha": "2c014ab4556ff5f7bf4ce74fa0fb1074574ca8b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2c014ab4556ff5f7bf4ce74fa0fb1074574ca8b3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bfa7a1e994988ef5827505e0e7540b810150f984", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfa7a1e994988ef5827505e0e7540b810150f984", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bfa7a1e994988ef5827505e0e7540b810150f984", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bfa7a1e994988ef5827505e0e7540b810150f984/comments", "author": null, "committer": null, "parents": [{"sha": "66cc73628c3655e9918fec357a9e449e1682509a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66cc73628c3655e9918fec357a9e449e1682509a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66cc73628c3655e9918fec357a9e449e1682509a"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "6fbec9372922d6325050d01f8bb0e723ec56b672", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfa7a1e994988ef5827505e0e7540b810150f984/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfa7a1e994988ef5827505e0e7540b810150f984/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=bfa7a1e994988ef5827505e0e7540b810150f984", "patch": "@@ -1,3 +1,10 @@\n+2006-09-09  Paul Thomas <pault@gcc.gnu.org>\n+\n+\tPR fortran/28914\n+\t* trans-array.c (gfc_trans_array_constructor_value): Create a temporary\n+\tloop variable to hold the current loop variable in case it is modified\n+\tby the array constructor.\n+\n 2006-09-07  Steven G. Kargl  <kargls@comcast.net>\n \n \t* gfortran.h (gfc_integer_info): Eliminate max_int."}, {"sha": "bf8e6879dba3912e7240c5f6fcb015c810e662f1", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bfa7a1e994988ef5827505e0e7540b810150f984/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bfa7a1e994988ef5827505e0e7540b810150f984/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=bfa7a1e994988ef5827505e0e7540b810150f984", "patch": "@@ -1252,6 +1252,7 @@ gfc_trans_array_constructor_value (stmtblock_t * pblock, tree type,\n \t  tree exit_label;\n \t  tree loopbody;\n \t  tree tmp2;\n+\t  tree tmp_loopvar;\n \n \t  loopbody = gfc_finish_block (&body);\n \n@@ -1260,6 +1261,11 @@ gfc_trans_array_constructor_value (stmtblock_t * pblock, tree type,\n \t  gfc_add_block_to_block (pblock, &se.pre);\n \t  loopvar = se.expr;\n \n+\t  /* Make a temporary, store the current value in that\n+\t     and return it, once the loop is done.  */\n+\t  tmp_loopvar = gfc_create_var (TREE_TYPE (loopvar), \"loopvar\");\n+\t  gfc_add_modify_expr (pblock, tmp_loopvar, loopvar);\n+\n \t  /* Initialize the loop.  */\n \t  gfc_init_se (&se, NULL);\n \t  gfc_conv_expr_val (&se, c->iterator->start);\n@@ -1327,6 +1333,9 @@ gfc_trans_array_constructor_value (stmtblock_t * pblock, tree type,\n \t  /* Add the exit label.  */\n \t  tmp = build1_v (LABEL_EXPR, exit_label);\n \t  gfc_add_expr_to_block (pblock, tmp);\n+\n+\t  /* Restore the original value of the loop counter.  */\n+\t  gfc_add_modify_expr (pblock, loopvar, tmp_loopvar);\n \t}\n     }\n   mpz_clear (size);"}]}