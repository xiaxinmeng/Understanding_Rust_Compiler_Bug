{"sha": "97471d8f5fe2ae5e17ae37af6f9945631a892214", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTc0NzFkOGY1ZmUyYWU1ZTE3YWUzN2FmNmY5OTQ1NjMxYTg5MjIxNA==", "commit": {"author": {"name": "Roger Sayle", "email": "roger@eyesopen.com", "date": "2005-05-26T04:38:51Z"}, "committer": {"name": "Roger Sayle", "email": "sayle@gcc.gnu.org", "date": "2005-05-26T04:38:51Z"}, "message": "convert.c (convert_to_integer): Avoid recursive call to convert_to_integer by building the NOP_EXPR directly.\n\n\n\t* convert.c (convert_to_integer) <POINTER_TYPE>: Avoid recursive\n\tcall to convert_to_integer by building the NOP_EXPR directly.\n\nFrom-SVN: r100184", "tree": {"sha": "bd44a4cda29327050b9f2c57369d127ff6a5fde3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bd44a4cda29327050b9f2c57369d127ff6a5fde3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/97471d8f5fe2ae5e17ae37af6f9945631a892214", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97471d8f5fe2ae5e17ae37af6f9945631a892214", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97471d8f5fe2ae5e17ae37af6f9945631a892214", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97471d8f5fe2ae5e17ae37af6f9945631a892214/comments", "author": null, "committer": null, "parents": [{"sha": "883ae7b040632ec8f5dcdffcb4733bb77ce61644", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/883ae7b040632ec8f5dcdffcb4733bb77ce61644", "html_url": "https://github.com/Rust-GCC/gccrs/commit/883ae7b040632ec8f5dcdffcb4733bb77ce61644"}], "stats": {"total": 20, "additions": 13, "deletions": 7}, "files": [{"sha": "a4037339c6ef88d5c494a13e1f006c79d4fed4d7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97471d8f5fe2ae5e17ae37af6f9945631a892214/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97471d8f5fe2ae5e17ae37af6f9945631a892214/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=97471d8f5fe2ae5e17ae37af6f9945631a892214", "patch": "@@ -1,3 +1,8 @@\n+2005-05-25  Roger Sayle  <roger@eyesopen.com>\n+\n+\t* convert.c (convert_to_integer) <POINTER_TYPE>: Avoid recursive\n+\tcall to convert_to_integer by building the NOP_EXPR directly.\n+\n 2005-05-25  Richard Sandiford  <rsandifo@redhat.com>\n \n \t* config/rs6000/rs6000.opt (mprioritize-restricted-insns=): Fix typo."}, {"sha": "fbd18dee23e204bc5129b3729096aebf0911c0a1", "filename": "gcc/convert.c", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97471d8f5fe2ae5e17ae37af6f9945631a892214/gcc%2Fconvert.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97471d8f5fe2ae5e17ae37af6f9945631a892214/gcc%2Fconvert.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconvert.c?ref=97471d8f5fe2ae5e17ae37af6f9945631a892214", "patch": "@@ -411,13 +411,14 @@ convert_to_integer (tree type, tree expr)\n     case POINTER_TYPE:\n     case REFERENCE_TYPE:\n       if (integer_zerop (expr))\n-\texpr = integer_zero_node;\n-      else\n-\texpr = fold (build1 (CONVERT_EXPR,\n-\t\t\t     lang_hooks.types.type_for_size (POINTER_SIZE, 0),\n-\t\t\t     expr));\n-\n-      return convert_to_integer (type, expr);\n+\treturn build_int_cst (type, 0);\n+\n+      /* Convert to an unsigned integer of the correct width first,\n+\t and from there widen/truncate to the required type.  */\n+      expr = fold_build1 (CONVERT_EXPR,\n+\t\t\t  lang_hooks.types.type_for_size (POINTER_SIZE, 0),\n+\t\t\t  expr);\n+      return fold_build1 (NOP_EXPR, type, expr);\n \n     case INTEGER_TYPE:\n     case ENUMERAL_TYPE:"}]}