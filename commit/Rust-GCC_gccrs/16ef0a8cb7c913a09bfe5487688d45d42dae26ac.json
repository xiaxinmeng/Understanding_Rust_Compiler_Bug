{"sha": "16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTZlZjBhOGNiN2M5MTNhMDliZmU1NDg3Njg4ZDQ1ZDQyZGFlMjZhYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2018-03-06T07:06:44Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-03-06T07:06:44Z"}, "message": "re PR tree-optimization/84687 (error: invalid conversion in gimple call with -O3 and -ffast-math)\n\n\tPR tree-optimization/84687\n\t* omp-simd-clone.c (simd_clone_create): Clear DECL_BUILT_IN_CLASS\n\ton new_node->decl.\n\t* match.pd (pow(C,x)*expN(y) -> expN(logN(C)*x+y)): New optimization.\n\n\t* gcc.dg/pr84687.c: New test.\n\nFrom-SVN: r258272", "tree": {"sha": "088677addacd21e4711feca625bd7298b2316f30", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/088677addacd21e4711feca625bd7298b2316f30"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "23d63b459c032c41f99a7c735a33558e77d6baf7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23d63b459c032c41f99a7c735a33558e77d6baf7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23d63b459c032c41f99a7c735a33558e77d6baf7"}], "stats": {"total": 43, "additions": 43, "deletions": 0}, "files": [{"sha": "09123ede82061fbb4c18c4066c54b2178af5a3db", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "patch": "@@ -1,3 +1,10 @@\n+2018-03-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/84687\n+\t* omp-simd-clone.c (simd_clone_create): Clear DECL_BUILT_IN_CLASS\n+\ton new_node->decl.\n+\t* match.pd (pow(C,x)*expN(y) -> expN(logN(C)*x+y)): New optimization.\n+\n 2018-03-05  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n \n \t* config/rs6000/rs6000-builtin.def (rs6000_speculation_barrier):"}, {"sha": "5ba1304af4e15349689da6dd7dc857915fa2d8c6", "filename": "gcc/match.pd", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "patch": "@@ -4030,6 +4030,16 @@ DEFINE_INT_AND_FLOAT_ROUND_FN (RINT)\n       (exps (mult (logs @0) @1))\n       (exp2s (mult (log2s @0) @1)))))))\n \n+ /* pow(C,x)*expN(y) -> expN(logN(C)*x+y) if C > 0.  */\n+ (for pows (POW)\n+      exps (EXP EXP2 EXP10 POW10)\n+      logs (LOG LOG2 LOG10 LOG10)\n+  (simplify\n+   (mult:c (pows:s REAL_CST@0 @1) (exps:s @2))\n+   (if (real_compare (GT_EXPR, TREE_REAL_CST_PTR (@0), &dconst0)\n+\t&& real_isfinite (TREE_REAL_CST_PTR (@0)))\n+    (exps (plus (mult (logs @0) @1) @2)))))\n+\n  (for sqrts (SQRT)\n       cbrts (CBRT)\n       pows (POW)"}, {"sha": "b15adf0bada40e2f083668cf3d2390852b15d238", "filename": "gcc/omp-simd-clone.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Fomp-simd-clone.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Fomp-simd-clone.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fomp-simd-clone.c?ref=16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "patch": "@@ -456,6 +456,8 @@ simd_clone_create (struct cgraph_node *old_node)\n   if (new_node == NULL)\n     return new_node;\n \n+  DECL_BUILT_IN_CLASS (new_node->decl) = NOT_BUILT_IN;\n+  DECL_FUNCTION_CODE (new_node->decl) = (enum built_in_function) 0;\n   TREE_PUBLIC (new_node->decl) = TREE_PUBLIC (old_node->decl);\n   DECL_COMDAT (new_node->decl) = DECL_COMDAT (old_node->decl);\n   DECL_WEAK (new_node->decl) = DECL_WEAK (old_node->decl);"}, {"sha": "2e5070379511012aaec98fa46fd76aece7f14ab9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "patch": "@@ -1,3 +1,8 @@\n+2018-03-06  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/84687\n+\t* gcc.dg/pr84687.c: New test.\n+\n 2018-03-06  Alexandre Oliva <aoliva@redhat.com>\n \n \tPR c++/84231"}, {"sha": "f3ac9ac27dda681cb83cc6c721d1c9e10c997964", "filename": "gcc/testsuite/gcc.dg/pr84687.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84687.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/16ef0a8cb7c913a09bfe5487688d45d42dae26ac/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84687.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr84687.c?ref=16ef0a8cb7c913a09bfe5487688d45d42dae26ac", "patch": "@@ -0,0 +1,19 @@\n+/* PR tree-optimization/84687 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Ofast\" } */\n+\n+int a[64], b;\n+double pow (double, double);\n+__attribute__((__simd__)) double exp (double);\n+\n+void\n+foo (double x)\n+{\n+  int i;\n+  double c = exp (x);\n+  for (i = 0; i < 64; i++)\n+    {\n+      b = i;\n+      a[i] = pow (12.0, b) * pow (c, i);\n+    }\n+}"}]}