{"sha": "653a4b32fe72e33bfd4cdd4c25493049524a3805", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjUzYTRiMzJmZTcyZTMzYmZkNGNkZDRjMjU0OTMwNDk1MjRhMzgwNQ==", "commit": {"author": {"name": "Bin Cheng", "email": "bin.cheng@arm.com", "date": "2017-03-02T11:25:11Z"}, "committer": {"name": "Bin Cheng", "email": "amker@gcc.gnu.org", "date": "2017-03-02T11:25:11Z"}, "message": "re PR tree-optimization/66768 (address space gets lost on literal pointer)\n\n\tPR tree-optimization/66768\n\t* tree-ssa-loop-ivopts.c (find_interesting_uses_address): Skip addr\n\tiv_use if base object can't be determined.\n\n\tgcc/testsuite\n\t* gcc.target/i386/pr66768.c: New test.\n\nFrom-SVN: r245837", "tree": {"sha": "d30393d7ea34a1cb5755199e3cb75f71ce085221", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d30393d7ea34a1cb5755199e3cb75f71ce085221"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/653a4b32fe72e33bfd4cdd4c25493049524a3805", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/653a4b32fe72e33bfd4cdd4c25493049524a3805", "html_url": "https://github.com/Rust-GCC/gccrs/commit/653a4b32fe72e33bfd4cdd4c25493049524a3805", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/653a4b32fe72e33bfd4cdd4c25493049524a3805/comments", "author": null, "committer": null, "parents": [{"sha": "6d03bdcc8196414a7d14d21629257ea746e82385", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d03bdcc8196414a7d14d21629257ea746e82385", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d03bdcc8196414a7d14d21629257ea746e82385"}], "stats": {"total": 32, "additions": 32, "deletions": 0}, "files": [{"sha": "8f196d7a99ca41d9b49b5a04cd5437f3bad7eb55", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=653a4b32fe72e33bfd4cdd4c25493049524a3805", "patch": "@@ -1,3 +1,9 @@\n+2017-03-02  Bin Cheng  <bin.cheng@arm.com>\n+\n+\tPR tree-optimization/66768\n+\t* tree-ssa-loop-ivopts.c (find_interesting_uses_address): Skip addr\n+\tiv_use if base object can't be determined.\n+\n 2017-03-02  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/79345"}, {"sha": "9f2315451b068f8add610c78f5945dfa76987bf7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=653a4b32fe72e33bfd4cdd4c25493049524a3805", "patch": "@@ -1,3 +1,8 @@\n+2017-03-02  Bin Cheng  <bin.cheng@arm.com>\n+\n+\tPR tree-optimization/66768\n+\t* gcc.target/i386/pr66768.c: New test.\n+\n 2017-03-02  Richard Biener  <rguenther@suse.de>\n \n \t* gcc.dg/rtl/x86_64/dfinit.c: Only run for lp64."}, {"sha": "9a8ad1f5ca1e6337d2ad537a3f436f997d080da2", "filename": "gcc/testsuite/gcc.target/i386/pr66768.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr66768.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr66768.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr66768.c?ref=653a4b32fe72e33bfd4cdd4c25493049524a3805", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+\n+typedef __seg_gs struct foo_s {\n+  int a[20];\n+} foo_t;\n+\n+int sum(void)\n+{\n+  const foo_t *p = (const foo_t *)0x1234;\n+  int i, total=0;\n+  for (i=0; i<20; i++)\n+    total += p->a[i];\n+  return total;\n+}\n+\n+/* { dg-final { scan-assembler \"add*.\\[ \\t\\]%gs:\" } } */"}, {"sha": "f3ad3736698589a8b98262a19026ecb583d1c752", "filename": "gcc/tree-ssa-loop-ivopts.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2Ftree-ssa-loop-ivopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/653a4b32fe72e33bfd4cdd4c25493049524a3805/gcc%2Ftree-ssa-loop-ivopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivopts.c?ref=653a4b32fe72e33bfd4cdd4c25493049524a3805", "patch": "@@ -2324,6 +2324,10 @@ find_interesting_uses_address (struct ivopts_data *data, gimple *stmt,\n     }\n \n   civ = alloc_iv (data, base, step);\n+  /* Fail if base object of this memory reference is unknown.  */\n+  if (civ->base_object == NULL_TREE)\n+    goto fail;\n+\n   record_group_use (data, op_p, civ, stmt, USE_ADDRESS);\n   return;\n "}]}