{"sha": "865234bf36f1bf8274c3e970f32a8bfb16e96771", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODY1MjM0YmYzNmYxYmY4Mjc0YzNlOTcwZjMyYThiZmIxNmU5Njc3MQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2018-10-09T15:06:21Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-10-09T15:06:21Z"}, "message": "[Ada] Fix strange warning when using Ada.Iterator_Interface\n\nThe back-end was recently changed to issue more -Wuninitialized warnings\non Out parameters and this has caught a case related to\nAda.Iterator_Interface.: This patchlet simply kills this uninteresting\nwarning.\n\n2018-10-09  Eric Botcazou  <ebotcazou@adacore.com>\n\ngcc/ada/\n\n\t* exp_disp.adb (Make_Disp_Asynchronous_Select_Spec): Set\n\tWarnings_Off on the B out parameter.\n\ngcc/testsuite/\n\n\t* gnat.dg/warn17.adb: New testcase.\n\nFrom-SVN: r264977", "tree": {"sha": "6796fc117e2a91f77eb6bf252eb289c25cd0454a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6796fc117e2a91f77eb6bf252eb289c25cd0454a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/865234bf36f1bf8274c3e970f32a8bfb16e96771", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/865234bf36f1bf8274c3e970f32a8bfb16e96771", "html_url": "https://github.com/Rust-GCC/gccrs/commit/865234bf36f1bf8274c3e970f32a8bfb16e96771", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/865234bf36f1bf8274c3e970f32a8bfb16e96771/comments", "author": null, "committer": null, "parents": [{"sha": "fd40a157ba7f2e703570dd83feea84ef3b07fff1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd40a157ba7f2e703570dd83feea84ef3b07fff1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fd40a157ba7f2e703570dd83feea84ef3b07fff1"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "a547602240d5780626668ef4be6c0bae7350f0fa", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=865234bf36f1bf8274c3e970f32a8bfb16e96771", "patch": "@@ -1,3 +1,8 @@\n+2018-10-09  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* exp_disp.adb (Make_Disp_Asynchronous_Select_Spec): Set\n+\tWarnings_Off on the B out parameter.\n+\n 2018-10-09  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* einfo.ads: Small comment fix."}, {"sha": "79c08978071b446db09099f693eb13b2dee8e2ea", "filename": "gcc/ada/exp_disp.adb", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Fada%2Fexp_disp.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Fada%2Fexp_disp.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_disp.adb?ref=865234bf36f1bf8274c3e970f32a8bfb16e96771", "patch": "@@ -2487,9 +2487,10 @@ package body Exp_Disp is\n      (Typ : Entity_Id) return Node_Id\n    is\n       Loc    : constant Source_Ptr := Sloc (Typ);\n-      Def_Id : constant Node_Id    :=\n+      Def_Id : constant Entity_Id :=\n                  Make_Defining_Identifier (Loc,\n                    Name_uDisp_Asynchronous_Select);\n+      B_Id   : constant Entity_Id  := Make_Defining_Identifier (Loc, Name_uB);\n       Params : constant List_Id    := New_List;\n \n    begin\n@@ -2501,6 +2502,9 @@ package body Exp_Disp is\n       --  B : out Dummy_Communication_Block;  --  Communication block dummy\n       --  F : out Boolean;                    --  Status flag\n \n+      --  The B parameter may be left uninitialized\n+      Set_Warnings_Off (B_Id);\n+\n       Append_List_To (Params, New_List (\n \n         Make_Parameter_Specification (Loc,\n@@ -2518,7 +2522,7 @@ package body Exp_Disp is\n           Parameter_Type      => New_Occurrence_Of (RTE (RE_Address), Loc)),\n \n         Make_Parameter_Specification (Loc,\n-          Defining_Identifier => Make_Defining_Identifier (Loc, Name_uB),\n+          Defining_Identifier => B_Id,\n           Parameter_Type      =>\n             New_Occurrence_Of (RTE (RE_Dummy_Communication_Block), Loc),\n           Out_Present         => True),"}, {"sha": "8196ce74c5c315e8039e85e9091068b71cd83e78", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=865234bf36f1bf8274c3e970f32a8bfb16e96771", "patch": "@@ -1,3 +1,7 @@\n+2018-10-09  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/warn17.adb: New testcase.\n+\n 2018-10-09  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/inline14.adb, gnat.dg/inline14_pkg.adb,"}, {"sha": "6d48e5416a54297543a46b8298695300449c3bec", "filename": "gcc/testsuite/gnat.dg/warn17.adb", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn17.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/865234bf36f1bf8274c3e970f32a8bfb16e96771/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn17.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn17.adb?ref=865234bf36f1bf8274c3e970f32a8bfb16e96771", "patch": "@@ -0,0 +1,22 @@\n+--  { dg-do compile }\n+--  { dg-options \"-Wall\" }\n+\n+with Ada.Iterator_Interfaces;\n+\n+procedure Warn17 is\n+\n+   type Cursor is null record;\n+\n+   function Has_Element (Position : Cursor) return Boolean;\n+\n+   function Has_Element (Position : Cursor) return Boolean is (True);\n+\n+   package My_Iterator is\n+     new Ada.Iterator_Interfaces (Cursor, Has_Element);\n+\n+   type Iterator is abstract new My_Iterator.Forward_Iterator with null record;\n+\n+   pragma Unreferenced (Iterator);\n+begin\n+   null;\n+end Warn17;"}]}