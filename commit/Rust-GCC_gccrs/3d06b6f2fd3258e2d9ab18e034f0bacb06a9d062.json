{"sha": "3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2QwNmI2ZjJmZDMyNThlMmQ5YWIxOGUwMzRmMGJhY2IwNmE5ZDA2Mg==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2016-08-29T18:13:13Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2016-08-29T18:13:13Z"}, "message": "re PR c/77292 (Spurious warning: logical not is only applied to the left hand side of comparison)\n\n\tPR c/77292\n\t* c-common.c (warn_logical_not_parentheses): Don't warn for\n\ta comparison or a logical operator.\n\n\t* c-c++-common/Wlogical-not-parentheses-1.c: New test.\n\nFrom-SVN: r239833", "tree": {"sha": "e0cc10a7ba309ea1849abdf54d42b9c1a5e726b7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e0cc10a7ba309ea1849abdf54d42b9c1a5e726b7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6ac852d15367db402f94828810c9483f76492ac5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ac852d15367db402f94828810c9483f76492ac5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ac852d15367db402f94828810c9483f76492ac5"}], "stats": {"total": 43, "additions": 41, "deletions": 2}, "files": [{"sha": "2a38deb1666e5e66150245f7c9f0d9bd59cbe81a", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "patch": "@@ -1,3 +1,9 @@\n+2016-08-29  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/77292\n+\t* c-common.c (warn_logical_not_parentheses): Don't warn for\n+\ta comparison or a logical operator.\n+\n 2016-08-29  Tom de Vries  <tom@codesourcery.com>\n \n \t* c-common.c (build_va_arg): Fix type comparison assert."}, {"sha": "b29334ad9af2f3fd43eff20c07c4415fab4dc58d", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "patch": "@@ -1481,15 +1481,17 @@ warn_tautological_cmp (location_t loc, enum tree_code code, tree lhs, tree rhs)\n \n /* Warn about logical not used on the left hand side operand of a comparison.\n    This function assumes that the LHS is inside of TRUTH_NOT_EXPR.\n-   Do not warn if RHS is of a boolean type.  */\n+   Do not warn if RHS is of a boolean type, a logical operator, or\n+   a comparison.  */\n \n void\n warn_logical_not_parentheses (location_t location, enum tree_code code,\n \t\t\t      tree lhs, tree rhs)\n {\n   if (TREE_CODE_CLASS (code) != tcc_comparison\n       || TREE_TYPE (rhs) == NULL_TREE\n-      || TREE_CODE (TREE_TYPE (rhs)) == BOOLEAN_TYPE)\n+      || TREE_CODE (TREE_TYPE (rhs)) == BOOLEAN_TYPE\n+      || truth_value_p (TREE_CODE (rhs)))\n     return;\n \n   /* Don't warn for !x == 0 or !y != 0, those are equivalent to"}, {"sha": "3aed281761d3253a5b25598d4a52622afc9e881d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "patch": "@@ -1,3 +1,8 @@\n+2016-08-29  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/77292\n+\t* c-c++-common/Wlogical-not-parentheses-1.c: New test.\n+\n 2016-08-29  Tom de Vries  <tom@codesourcery.com>\n \n \tPR c/77398"}, {"sha": "b6b4e9d37c7ba8188cb3e7724bd465b4911de076", "filename": "gcc/testsuite/c-c++-common/Wlogical-not-parentheses-1.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWlogical-not-parentheses-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWlogical-not-parentheses-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWlogical-not-parentheses-1.c?ref=3d06b6f2fd3258e2d9ab18e034f0bacb06a9d062", "patch": "@@ -0,0 +1,26 @@\n+/* PR c/77292 */\n+/* { dg-do compile } */\n+/* { dg-options \"-Wlogical-not-parentheses\" } */\n+\n+ /* Test that we don't warn if rhs is a comparison or a logical op.  */\n+\n+int\n+foo (int a, int b)\n+{\n+  int r = 0;\n+  r += !a == (a < b);\n+  r += !a == (a > b);\n+  r += !a == (a >= b);\n+  r += !a == (a <= b);\n+  r += !a == (a != b);\n+  r += !a == (a == b);\n+  r += !a == (a || b);\n+  r += !a == (a && b);\n+  r += !a == (!b);\n+\n+  r += !a == (a ^ b); /* { dg-warning \"logical not is only applied to the left hand side of comparison\" } */\n+  r += !a == (a | b); /* { dg-warning \"logical not is only applied to the left hand side of comparison\" } */\n+  r += !a == (a & b); /* { dg-warning \"logical not is only applied to the left hand side of comparison\" } */\n+\n+  return r;\n+}"}]}