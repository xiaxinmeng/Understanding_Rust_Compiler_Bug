{"sha": "9ec69d2ee7e74876adf6af4e50bd4686639dce05", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWVjNjlkMmVlN2U3NDg3NmFkZjZhZjRlNTBiZDQ2ODY2MzlkY2UwNQ==", "commit": {"author": {"name": "Jack Howarth", "email": "howarth@bromo.med.uc.edu", "date": "2010-04-26T20:48:35Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2010-04-26T20:48:35Z"}, "message": "re PR target/43715 (configure option --enable-plugin fails on darwin)\n\n2010-04-26  Jack Howarth <howarth@bromo.med.uc.edu>\n\n\tPR 43715\n\t* gcc/configure.ac: Use \"$gcc_cv_nm -g\" on darwin\n\tinstead of \"$gcc_cv_objdump -T\".\n\tUse \"-undefined dynamic_lookup\" on darwin.\n\nFrom-SVN: r158748", "tree": {"sha": "1ac670155f6c0757ae6d81e85e74118a35525058", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1ac670155f6c0757ae6d81e85e74118a35525058"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ec69d2ee7e74876adf6af4e50bd4686639dce05", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ec69d2ee7e74876adf6af4e50bd4686639dce05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ec69d2ee7e74876adf6af4e50bd4686639dce05", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ec69d2ee7e74876adf6af4e50bd4686639dce05/comments", "author": null, "committer": null, "parents": [{"sha": "920a8260a475c90750d1cd3da8024c8d8c870ca3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/920a8260a475c90750d1cd3da8024c8d8c870ca3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/920a8260a475c90750d1cd3da8024c8d8c870ca3"}], "stats": {"total": 50, "additions": 44, "deletions": 6}, "files": [{"sha": "218b93e03e87a0d5f26aec809ef7b059cdbdf303", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ec69d2ee7e74876adf6af4e50bd4686639dce05/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ec69d2ee7e74876adf6af4e50bd4686639dce05/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9ec69d2ee7e74876adf6af4e50bd4686639dce05", "patch": "@@ -1,3 +1,11 @@\n+2010-04-21  Jack Howarth <howarth@bromo.med.uc.edu>\n+\n+\tPR 43715\n+\t* gcc/configure.ac: Use \"$gcc_cv_nm -g\" on darwin\n+\tinstead of \"$gcc_cv_objdump -T\".\n+\tUse \"-undefined dynamic_lookup\" on darwin.\n+\t* gcc/configure: Regenerate.\n+\n 2010-04-26  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/43893"}, {"sha": "fc4013b98f848d4e1f7a96012b45c6d816a0acd5", "filename": "gcc/configure", "status": "modified", "additions": 18, "deletions": 3, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ec69d2ee7e74876adf6af4e50bd4686639dce05/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ec69d2ee7e74876adf6af4e50bd4686639dce05/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=9ec69d2ee7e74876adf6af4e50bd4686639dce05", "patch": "@@ -25276,17 +25276,25 @@ fi\n pluginlibs=\n if test x\"$enable_plugin\" = x\"yes\"; then\n \n+  case \"${host}\" in\n+    *-*-darwin*)\n+      export_sym_check=\"$gcc_cv_nm -g\"\n+    ;;\n+    *)\n+      export_sym_check=\"$gcc_cv_objdump -T\"\n+    ;;\n+  esac\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for exported symbols\" >&5\n $as_echo_n \"checking for exported symbols... \" >&6; }\n   echo \"int main() {return 0;} int foobar() {return 0;}\" > conftest.c\n   ${CC} ${CFLAGS} ${LDFLAGS} conftest.c -o conftest > /dev/null 2>&1\n-  if $gcc_cv_objdump -T conftest | grep foobar > /dev/null; then\n+  if $export_sym_check conftest | grep foobar > /dev/null; then\n     : # No need to use a flag\n   else\n     { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for -rdynamic\" >&5\n $as_echo_n \"checking for -rdynamic... \" >&6; }\n     ${CC} ${CFLAGS} ${LDFLAGS} -rdynamic conftest.c -o conftest > /dev/null 2>&1\n-    if $gcc_cv_objdump -T conftest | grep foobar > /dev/null; then\n+    if $export_sym_check conftest | grep foobar > /dev/null; then\n       plugin_rdynamic=yes\n       pluginlibs=\"-rdynamic\"\n     else\n@@ -25362,7 +25370,14 @@ fi\n \n   # Check that we can build shared objects with -fPIC -shared\n   saved_LDFLAGS=\"$LDFLAGS\"\n-  LDFLAGS=\"$LDFLAGS -fPIC -shared\"\n+  case \"${host}\" in\n+    *-*-darwin*)\n+      LDFLAGS=\"$LDFLAGS -fPIC -shared -undefined dynamic_lookup\"\n+    ;;\n+    *)\n+      LDFLAGS=\"$LDFLAGS -fPIC -shared\"\n+    ;;\n+  esac\n   { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for -fPIC -shared\" >&5\n $as_echo_n \"checking for -fPIC -shared... \" >&6; }\n   cat confdefs.h - <<_ACEOF >conftest.$ac_ext"}, {"sha": "1676c40b4b02d110f5582521b3729ac8d2336586", "filename": "gcc/configure.ac", "status": "modified", "additions": 18, "deletions": 3, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ec69d2ee7e74876adf6af4e50bd4686639dce05/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ec69d2ee7e74876adf6af4e50bd4686639dce05/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=9ec69d2ee7e74876adf6af4e50bd4686639dce05", "patch": "@@ -4456,15 +4456,23 @@ enable_plugin=yes; default_plugin=yes)\n pluginlibs=\n if test x\"$enable_plugin\" = x\"yes\"; then\n \n+  case \"${host}\" in\n+    *-*-darwin*)\n+      export_sym_check=\"$gcc_cv_nm -g\"\n+    ;;\n+    *)\n+      export_sym_check=\"$gcc_cv_objdump -T\"\n+    ;;\n+  esac\n   AC_MSG_CHECKING([for exported symbols])\n   echo \"int main() {return 0;} int foobar() {return 0;}\" > conftest.c\n   ${CC} ${CFLAGS} ${LDFLAGS} conftest.c -o conftest > /dev/null 2>&1\n-  if $gcc_cv_objdump -T conftest | grep foobar > /dev/null; then\n+  if $export_sym_check conftest | grep foobar > /dev/null; then\n     : # No need to use a flag\n   else\n     AC_MSG_CHECKING([for -rdynamic])\n     ${CC} ${CFLAGS} ${LDFLAGS} -rdynamic conftest.c -o conftest > /dev/null 2>&1\n-    if $gcc_cv_objdump -T conftest | grep foobar > /dev/null; then\n+    if $export_sym_check conftest | grep foobar > /dev/null; then\n       plugin_rdynamic=yes\n       pluginlibs=\"-rdynamic\"\n     else\n@@ -4484,7 +4492,14 @@ if test x\"$enable_plugin\" = x\"yes\"; then\n \n   # Check that we can build shared objects with -fPIC -shared\n   saved_LDFLAGS=\"$LDFLAGS\"\n-  LDFLAGS=\"$LDFLAGS -fPIC -shared\"\n+  case \"${host}\" in\n+    *-*-darwin*)\n+      LDFLAGS=\"$LDFLAGS -fPIC -shared -undefined dynamic_lookup\"\n+    ;;\n+    *)\n+      LDFLAGS=\"$LDFLAGS -fPIC -shared\"\n+    ;;\n+  esac\n   AC_MSG_CHECKING([for -fPIC -shared])\n   AC_TRY_LINK(\n     [extern int X;],[return X == 0;],"}]}