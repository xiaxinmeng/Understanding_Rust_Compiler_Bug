{"sha": "67cef334cce4159cc4de8543ffcc399bfb6c94be", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjdjZWYzMzRjY2U0MTU5Y2M0ZGU4NTQzZmZjYzM5OWJmYjZjOTRiZQ==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2002-09-27T03:08:38Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2002-09-27T03:08:38Z"}, "message": "dbxout.c (FORCE_TEXT): Switch to current_function_decl, not text_section.\n\n2002-09-26  David Edelsohn  <edelsohn@gnu.org>\n\n        * dbxout.c (FORCE_TEXT): Switch to current_function_decl, not\n        text_section.\n        * xcoffout.h (DBX_STATIC_BLOCK_START): Remove explicit change to\n        text section.\n        * config/rs6000/rs6000.c (rs6000_override_options): Allow\n        function-sections and data-sections functionality on AIX.\n\n2002-09-26  David Edelsohn  <edelsohn@gnu.org>\n            Dale Johannesen  <dalej@apple.com>\n\n        * config/rs6000/rs6000.c (rs6000_emit_move): Insert zero-extend\n        in RTL for sub-word loads from memory.\n\nCo-Authored-By: Dale Johannesen <dalej@apple.com>\n\nFrom-SVN: r57572", "tree": {"sha": "5b410740259c1bcccd678c630e6933000e8538f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5b410740259c1bcccd678c630e6933000e8538f0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/67cef334cce4159cc4de8543ffcc399bfb6c94be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67cef334cce4159cc4de8543ffcc399bfb6c94be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67cef334cce4159cc4de8543ffcc399bfb6c94be", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67cef334cce4159cc4de8543ffcc399bfb6c94be/comments", "author": null, "committer": null, "parents": [{"sha": "fa4211cb739503d1ad376083ead0abc75cdf4831", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa4211cb739503d1ad376083ead0abc75cdf4831", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fa4211cb739503d1ad376083ead0abc75cdf4831"}], "stats": {"total": 70, "additions": 34, "deletions": 36}, "files": [{"sha": "2212bac341c573a07d4aa69f1d031b26d3e2f5f0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=67cef334cce4159cc4de8543ffcc399bfb6c94be", "patch": "@@ -1,3 +1,18 @@\n+2002-09-26  David Edelsohn  <edelsohn@gnu.org>\n+\n+\t* dbxout.c (FORCE_TEXT): Switch to current_function_decl, not\n+\ttext_section.\n+\t* xcoffout.h (DBX_STATIC_BLOCK_START): Remove explicit change to \n+\ttext section.\n+\t* config/rs6000/rs6000.c (rs6000_override_options): Allow\n+\tfunction-sections and data-sections functionality on AIX.\n+\n+2002-09-26  David Edelsohn  <edelsohn@gnu.org>\n+\t    Dale Johannesen  <dalej@apple.com>\n+\n+\t* config/rs6000/rs6000.c (rs6000_emit_move): Insert zero-extend\n+\tin RTL for sub-word loads from memory.\n+\n 2002-09-26  Richard Henderson  <rth@redhat.com>\n \n \tPR c/7160"}, {"sha": "171e557b0febfa0d53006e6dc94f1e0b461c39d8", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 16, "deletions": 17, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=67cef334cce4159cc4de8543ffcc399bfb6c94be", "patch": "@@ -590,21 +590,6 @@ rs6000_override_options (default_cpu)\n       flag_pic = 0;\n     }\n \n-#ifdef XCOFF_DEBUGGING_INFO\n-  if (flag_function_sections && (write_symbols != NO_DEBUG)\n-      && DEFAULT_ABI == ABI_AIX)\n-    {\n-      warning (\"-ffunction-sections disabled on AIX when debugging\");\n-      flag_function_sections = 0;\n-    }\n-\n-  if (flag_data_sections && (DEFAULT_ABI == ABI_AIX))\n-    {\n-      warning (\"-fdata-sections not supported on AIX\");\n-      flag_data_sections = 0;\n-    }\n-#endif\n-\n   /* For Darwin, always silently make -fpic and -fPIC identical.  */\n   if (flag_pic == 1 && DEFAULT_ABI == ABI_DARWIN)\n     flag_pic = 2;\n@@ -2579,8 +2564,22 @@ rs6000_emit_move (dest, source, mode)\n       return;\n     }\n   \n-  if (! no_new_pseudos && GET_CODE (operands[0]) != REG)\n-    operands[1] = force_reg (mode, operands[1]);\n+  if (!no_new_pseudos)\n+    {\n+      if (GET_CODE (operands[1]) == MEM && optimize > 0\n+\t  && (mode == QImode || mode == HImode || mode == SImode)\n+\t  && GET_MODE_SIZE (mode) < GET_MODE_SIZE (word_mode))\n+\t{\n+\t  rtx reg = gen_reg_rtx (word_mode);\n+\n+\t  emit_insn (gen_rtx_SET (word_mode, reg,\n+\t\t\t\t  gen_rtx_ZERO_EXTEND (word_mode,\n+\t\t\t\t\t\t       operands[1])));\n+\t  operands[1] = gen_lowpart (mode, reg);\n+\t}\n+      if (GET_CODE (operands[0]) != REG)\n+\toperands[1] = force_reg (mode, operands[1]);\n+    }\n \n   if (mode == SFmode && ! TARGET_POWERPC\n       && TARGET_HARD_FLOAT && TARGET_FPRS"}, {"sha": "9d27fa7c72afe4efff738001c291681526cf48b5", "filename": "gcc/dbxout.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2Fdbxout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2Fdbxout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdbxout.c?ref=67cef334cce4159cc4de8543ffcc399bfb6c94be", "patch": "@@ -155,7 +155,7 @@ static int source_label_number = 1;\n #endif\n \n #ifdef DEBUG_SYMS_TEXT\n-#define FORCE_TEXT text_section ();\n+#define FORCE_TEXT function_section (current_function_decl);\n #else\n #define FORCE_TEXT\n #endif"}, {"sha": "dd630c9374998fc39d124e509f881fc725141bc5", "filename": "gcc/xcoffout.h", "status": "modified", "additions": 2, "deletions": 18, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2Fxcoffout.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/67cef334cce4159cc4de8543ffcc399bfb6c94be/gcc%2Fxcoffout.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fxcoffout.h?ref=67cef334cce4159cc4de8543ffcc399bfb6c94be", "patch": "@@ -47,30 +47,14 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n \n #define DBX_STATIC_CONST_VAR_CODE N_STSYM\n \n-/* For static variables, output code to define the start of a static block.\n-\n-   ??? The IBM rs6000/AIX assembler has a bug that causes bss block debug\n-   info to be occasionally lost.  A simple example is this:\n-\tint a; static int b;\n-   The commands `gcc -g -c tmp.c; dump -t tmp.o' gives\n-[10]\tm   0x00000016         1     0    0x8f  0x0000            .bs\n-[11]\tm   0x00000000         1     0    0x90  0x0000            .es\n-...\n-[21]\tm   0x00000000        -2     0    0x85  0x0000            b:S-1\n-   which is wrong.  The `b:S-1' must be between the `.bs' and `.es'.\n-   We can apparently work around the problem by forcing the text section\n-   (even if we are already in the text section) immediately before outputting\n-   the `.bs'.  This should be fixed in the next major AIX release (3.3?).  */\n+/* For static variables, output code to define the start of a static block.  */\n \n #define DBX_STATIC_BLOCK_START(ASMFILE,CODE)\t\t\t\t\\\n {\t\t\t\t\t\t\t\t\t\\\n   if ((CODE) == N_STSYM)\t\t\t\t\t\t\\\n     fprintf ((ASMFILE), \"\\t.bs\\t%s[RW]\\n\", xcoff_private_data_section_name);\\\n   else if ((CODE) == N_LCSYM)\t\t\t\t\t\t\\\n-    {\t\t\t\t\t\t\t\t\t\\\n-      fprintf ((ASMFILE), \"%s\\n\", TEXT_SECTION_ASM_OP);\t\t\t\\\n-      fprintf ((ASMFILE), \"\\t.bs\\t%s\\n\", xcoff_bss_section_name);\t\\\n-    }\t\t\t\t\t\t\t\t\t\\\n+    fprintf ((ASMFILE), \"\\t.bs\\t%s\\n\", xcoff_bss_section_name);\t\\\n }\n \n /* For static variables, output code to define the end of a static block.  */"}]}