{"sha": "71f2cd57c6fed5d01c56858800bc17cb68a9ac38", "node_id": "C_kwDOANBUbNoAKDcxZjJjZDU3YzZmZWQ1ZDAxYzU2ODU4ODAwYmMxN2NiNjhhOWFjMzg", "commit": {"author": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-04-14T07:59:18Z"}, "committer": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-04-14T08:01:41Z"}, "message": "privacy: reachability: wip: Update all base reach levels", "tree": {"sha": "ae8c2031db59d1829dff424be4e6b7ce0cba9681", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae8c2031db59d1829dff424be4e6b7ce0cba9681"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71f2cd57c6fed5d01c56858800bc17cb68a9ac38", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71f2cd57c6fed5d01c56858800bc17cb68a9ac38", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71f2cd57c6fed5d01c56858800bc17cb68a9ac38", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71f2cd57c6fed5d01c56858800bc17cb68a9ac38/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "d36a3c5752cbffab5bc107bb3cf7710442a29f9e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d36a3c5752cbffab5bc107bb3cf7710442a29f9e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d36a3c5752cbffab5bc107bb3cf7710442a29f9e"}], "stats": {"total": 23, "additions": 19, "deletions": 4}, "files": [{"sha": "826a465566d22abeff4376697464709c1dfa385a", "filename": "gcc/rust/privacy/rust-reachability.cc", "status": "modified", "additions": 19, "deletions": 4, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71f2cd57c6fed5d01c56858800bc17cb68a9ac38/gcc%2Frust%2Fprivacy%2Frust-reachability.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71f2cd57c6fed5d01c56858800bc17cb68a9ac38/gcc%2Frust%2Fprivacy%2Frust-reachability.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fprivacy%2Frust-reachability.cc?ref=71f2cd57c6fed5d01c56858800bc17cb68a9ac38", "patch": "@@ -69,6 +69,9 @@ ReachabilityVisitor::visit_generic_predicates (\n void\n ReachabilityVisitor::visit (HIR::Module &mod)\n {\n+  auto reach = get_reachability_level (mod.get_visibility ());\n+  reach = ctx.update_reachability (mod.get_mappings (), reach);\n+\n   for (auto &item : mod.get_items ())\n     {\n       // FIXME: Is that what we want to do? Yes? Only visit the items with\n@@ -83,11 +86,17 @@ ReachabilityVisitor::visit (HIR::Module &mod)\n \n void\n ReachabilityVisitor::visit (HIR::ExternCrate &crate)\n-{}\n+{\n+  auto reach = get_reachability_level (crate.get_visibility ());\n+  reach = ctx.update_reachability (crate.get_mappings (), reach);\n+}\n \n void\n ReachabilityVisitor::visit (HIR::UseDeclaration &use_decl)\n-{}\n+{\n+  auto reach = get_reachability_level (use_decl.get_visibility ());\n+  reach = ctx.update_reachability (use_decl.get_mappings (), reach);\n+}\n \n void\n ReachabilityVisitor::visit (HIR::Function &func)\n@@ -155,11 +164,17 @@ ReachabilityVisitor::visit (HIR::Union &union_item)\n \n void\n ReachabilityVisitor::visit (HIR::ConstantItem &const_item)\n-{}\n+{\n+  auto reach = get_reachability_level (const_item.get_visibility ());\n+  reach = ctx.update_reachability (const_item.get_mappings (), reach);\n+}\n \n void\n ReachabilityVisitor::visit (HIR::StaticItem &static_item)\n-{}\n+{\n+  auto reach = get_reachability_level (static_item.get_visibility ());\n+  reach = ctx.update_reachability (static_item.get_mappings (), reach);\n+}\n \n void\n ReachabilityVisitor::visit (HIR::Trait &trait)"}]}