{"sha": "4b1a827f024234aaf83ecfe90415e88b525d3969", "node_id": "C_kwDOANBUbNoAKDRiMWE4MjdmMDI0MjM0YWFmODNlY2ZlOTA0MTVlODhiNTI1ZDM5Njk", "commit": {"author": {"name": "liuhongt", "email": "hongtao.liu@intel.com", "date": "2022-06-14T08:27:04Z"}, "committer": {"name": "liuhongt", "email": "hongtao.liu@intel.com", "date": "2022-06-15T05:55:31Z"}, "message": "Fix ICE in extract_insn, at recog.cc:2791\n\n(In reply to Uro\u0161 Bizjak from comment #1)\n> Instruction does not accept memory operand for operand 3:\n>\n> (define_insn_and_split\n> \"*<sse4_1>_blendv<ssefltmodesuffix><avxsizesuffix>_ltint\"\n>   [(set (match_operand:<ssebytemode> 0 \"register_operand\" \"=Yr,*x,x\")\n> \t(unspec:<ssebytemode>\n> \t  [(match_operand:<ssebytemode> 1 \"register_operand\" \"0,0,x\")\n> \t   (match_operand:<ssebytemode> 2 \"vector_operand\" \"YrBm,*xBm,xm\")\n> \t   (subreg:<ssebytemode>\n> \t     (lt:VI48_AVX\n> \t       (match_operand:VI48_AVX 3 \"register_operand\" \"Yz,Yz,x\")\n> \t       (match_operand:VI48_AVX 4 \"const0_operand\")) 0)]\n> \t  UNSPEC_BLENDV))]\n>\n> The problematic insn is:\n>\n> (define_insn_and_split \"*avx_cmp<mode>3_ltint_not\"\n>  [(set (match_operand:VI48_AVX  0 \"register_operand\")\n>        (vec_merge:VI48_AVX\n> \t (match_operand:VI48_AVX 1 \"vector_operand\")\n> \t (match_operand:VI48_AVX 2 \"vector_operand\")\n> \t (unspec:<avx512fmaskmode>\n> \t   [(subreg:VI48_AVX\n> \t    (not:<ssebytemode>\n> \t      (match_operand:<ssebytemode> 3 \"vector_operand\")) 0)\n> \t    (match_operand:VI48_AVX 4 \"const0_operand\")\n> \t    (match_operand:SI 5 \"const_0_to_7_operand\")]\n> \t    UNSPEC_PCMP)))]\n>\n> which gets split to the above pattern.\n>\n> In the preparation statements we have:\n>\n>   if (!MEM_P (operands[3]))\n>     operands[3] = force_reg (<ssebytemode>mode, operands[3]);\n>   operands[3] = lowpart_subreg (<MODE>mode, operands[3], <ssebytemode>mode);\n>\n> Which won't fly when operand 3 is memory operand...\n>\n\ngcc/ChangeLog:\n\n\tPR target/105953\n\t* config/i386/sse.md (*avx_cmp<mode>3_ltint_not): Force_reg\n\toperands[3].\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.target/i386/pr105953.C: New test.", "tree": {"sha": "bf4f37a7ac663ed1daa044333d816f0ee457f792", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bf4f37a7ac663ed1daa044333d816f0ee457f792"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b1a827f024234aaf83ecfe90415e88b525d3969", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b1a827f024234aaf83ecfe90415e88b525d3969", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b1a827f024234aaf83ecfe90415e88b525d3969", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b1a827f024234aaf83ecfe90415e88b525d3969/comments", "author": {"login": "algebra84", "id": 22926165, "node_id": "MDQ6VXNlcjIyOTI2MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algebra84", "html_url": "https://github.com/algebra84", "followers_url": "https://api.github.com/users/algebra84/followers", "following_url": "https://api.github.com/users/algebra84/following{/other_user}", "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}", "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions", "organizations_url": "https://api.github.com/users/algebra84/orgs", "repos_url": "https://api.github.com/users/algebra84/repos", "events_url": "https://api.github.com/users/algebra84/events{/privacy}", "received_events_url": "https://api.github.com/users/algebra84/received_events", "type": "User", "site_admin": false}, "committer": {"login": "algebra84", "id": 22926165, "node_id": "MDQ6VXNlcjIyOTI2MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algebra84", "html_url": "https://github.com/algebra84", "followers_url": "https://api.github.com/users/algebra84/followers", "following_url": "https://api.github.com/users/algebra84/following{/other_user}", "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}", "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions", "organizations_url": "https://api.github.com/users/algebra84/orgs", "repos_url": "https://api.github.com/users/algebra84/repos", "events_url": "https://api.github.com/users/algebra84/events{/privacy}", "received_events_url": "https://api.github.com/users/algebra84/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4adc5350fe239aa449c75b5cc98a37d4f00012d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4adc5350fe239aa449c75b5cc98a37d4f00012d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4adc5350fe239aa449c75b5cc98a37d4f00012d6"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "3e3d96fe087b1af59fb324f27184af74c3674fbb", "filename": "gcc/config/i386/sse.md", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b1a827f024234aaf83ecfe90415e88b525d3969/gcc%2Fconfig%2Fi386%2Fsse.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b1a827f024234aaf83ecfe90415e88b525d3969/gcc%2Fconfig%2Fi386%2Fsse.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsse.md?ref=4b1a827f024234aaf83ecfe90415e88b525d3969", "patch": "@@ -3643,8 +3643,7 @@\n \t\t\t  gen_lowpart (<ssebytemode>mode, operands[1]));\n   operands[2] = gen_lowpart (<ssebytemode>mode, operands[2]);\n \n-  if (!MEM_P (operands[3]))\n-    operands[3] = force_reg (<ssebytemode>mode, operands[3]);\n+  operands[3] = force_reg (<ssebytemode>mode, operands[3]);\n   operands[3] = lowpart_subreg (<MODE>mode, operands[3], <ssebytemode>mode);\n })\n "}, {"sha": "b423d2dfdaed31a4d010685f910ac25ec0bac8b2", "filename": "gcc/testsuite/g++.target/i386/pr105953.C", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b1a827f024234aaf83ecfe90415e88b525d3969/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr105953.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b1a827f024234aaf83ecfe90415e88b525d3969/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr105953.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr105953.C?ref=4b1a827f024234aaf83ecfe90415e88b525d3969", "patch": "@@ -0,0 +1,4 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -mavx512vl -mabi=ms\" } */\n+\n+#include \"pr100738-1.C\""}]}