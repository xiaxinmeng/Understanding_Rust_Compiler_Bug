{"sha": "3e0a08d7115f4623f580e111230561a5740c4c18", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2UwYTA4ZDcxMTVmNDYyM2Y1ODBlMTExMjMwNTYxYTU3NDBjNGMxOA==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2006-03-10T01:22:54Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2006-03-10T01:22:54Z"}, "message": "tree-ssa-phiopt.c (tree_ssa_phiopt): Add cfgchanged variable.\n\n2006-03-09  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        * tree-ssa-phiopt.c (tree_ssa_phiopt): Add cfgchanged variable.\n        Set it when one of the replacement functions returned true.\n        Return TODO_cleanup_cfg if cfgchanged is true.\n        (pass_phiopt) <todo_flags_finish>: Remove TODO_cleanup_cfg.\n\nFrom-SVN: r111920", "tree": {"sha": "41090d7b945a287821c1684a417efe538999f9bd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41090d7b945a287821c1684a417efe538999f9bd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3e0a08d7115f4623f580e111230561a5740c4c18", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e0a08d7115f4623f580e111230561a5740c4c18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e0a08d7115f4623f580e111230561a5740c4c18", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e0a08d7115f4623f580e111230561a5740c4c18/comments", "author": null, "committer": null, "parents": [{"sha": "0ade2ddf23d75245e4e9f0783604ece21a12be79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ade2ddf23d75245e4e9f0783604ece21a12be79", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ade2ddf23d75245e4e9f0783604ece21a12be79"}], "stats": {"total": 25, "additions": 17, "deletions": 8}, "files": [{"sha": "eeb0febb311c6439216deb229246bdcefbef8084", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0a08d7115f4623f580e111230561a5740c4c18/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0a08d7115f4623f580e111230561a5740c4c18/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3e0a08d7115f4623f580e111230561a5740c4c18", "patch": "@@ -1,3 +1,10 @@\n+2006-03-09  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\t* tree-ssa-phiopt.c (tree_ssa_phiopt): Add cfgchanged variable.\n+\tSet it when one of the replacement functions returned true.\n+\tReturn TODO_cleanup_cfg if cfgchanged is true.\n+\t(pass_phiopt) <todo_flags_finish>: Remove TODO_cleanup_cfg.\n+\n 2006-03-09  Adam Nemet  <anemet@caviumnetworks.com>\n \n \t* combine.c (simplify_shift_const_1): Use gen_lowpart_or_truncate"}, {"sha": "a0059919650a50839b5c3e2077403955ae144d9e", "filename": "gcc/tree-ssa-phiopt.c", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e0a08d7115f4623f580e111230561a5740c4c18/gcc%2Ftree-ssa-phiopt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e0a08d7115f4623f580e111230561a5740c4c18/gcc%2Ftree-ssa-phiopt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-phiopt.c?ref=3e0a08d7115f4623f580e111230561a5740c4c18", "patch": "@@ -139,6 +139,7 @@ tree_ssa_phiopt (void)\n   basic_block bb;\n   basic_block *bb_order;\n   unsigned n, i;\n+  bool cfgchanged = false;\n \n   /* Search every basic block for COND_EXPR we may be able to optimize.\n \n@@ -227,17 +228,19 @@ tree_ssa_phiopt (void)\n \n       /* Do the replacement of conditional if it can be done.  */\n       if (conditional_replacement (bb, bb1, e1, e2, phi, arg0, arg1))\n-\t;\n+\tcfgchanged = true;\n       else if (value_replacement (bb, bb1, e1, e2, phi, arg0, arg1))\n-\t;\n+\tcfgchanged = true;\n       else if (abs_replacement (bb, bb1, e1, e2, phi, arg0, arg1))\n-\t;\n-      else\n-\tminmax_replacement (bb, bb1, e1, e2, phi, arg0, arg1);\n+\tcfgchanged = true;\n+      else if (minmax_replacement (bb, bb1, e1, e2, phi, arg0, arg1))\n+\tcfgchanged = true;\n     }\n \n   free (bb_order);\n-  return 0;\n+  \n+  /* If the CFG has changed, we should cleanup the CFG. */\n+  return cfgchanged ? TODO_cleanup_cfg : 0;\n }\n \n /* Returns the list of basic blocks in the function in an order that guarantees\n@@ -1010,8 +1013,7 @@ struct tree_opt_pass pass_phiopt =\n   0,\t\t\t\t\t/* properties_provided */\n   0,\t\t\t\t\t/* properties_destroyed */\n   0,\t\t\t\t\t/* todo_flags_start */\n-  TODO_cleanup_cfg\n-    | TODO_dump_func\n+  TODO_dump_func\n     | TODO_ggc_collect\n     | TODO_verify_ssa\n     | TODO_verify_flow"}]}