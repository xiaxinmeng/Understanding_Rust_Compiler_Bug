{"sha": "62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjJlNGViMzU1M2Y5Y2UwNWE2ZDA4YTFlZjdkOGU1OWY4MWFlZWVlNg==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2014-08-03T12:23:03Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2014-08-03T12:23:03Z"}, "message": "c-common.c (check_case_value): Add location_t parameter.\n\n\t* c-common.c (check_case_value):  Add location_t parameter.  Use it.\n\t(c_add_case_label): Pass loc to check_case_value.\n\n\t* gcc.dg/case-bogus-1.c: New test.\n\nFrom-SVN: r213525", "tree": {"sha": "2584046c0dbb8332881d593db7cd195a717b30ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2584046c0dbb8332881d593db7cd195a717b30ce"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "87d5ce4856710235e9dbb728d3c05a8907e1c804", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87d5ce4856710235e9dbb728d3c05a8907e1c804", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87d5ce4856710235e9dbb728d3c05a8907e1c804"}], "stats": {"total": 27, "additions": 22, "deletions": 5}, "files": [{"sha": "b599627c397744386f6c6e005e8b77b0936965f3", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "patch": "@@ -1,3 +1,8 @@\n+2014-08-03  Marek Polacek  <polacek@redhat.com>\n+\n+\t* c-common.c (check_case_value):  Add location_t parameter.  Use it.\n+\t(c_add_case_label): Pass loc to check_case_value.\n+\n 2014-08-02  Trevor Saunders  <tsaunders@mozilla.com>\n \n \t* cilk.c: Use hash_map instead of pointer_map."}, {"sha": "acc9a203d557507bbf783b512fa562d0f4f7e844", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "patch": "@@ -300,7 +300,7 @@ const struct fname_var_t fname_vars[] =\n struct visibility_flags visibility_options;\n \n static tree c_fully_fold_internal (tree expr, bool, bool *, bool *);\n-static tree check_case_value (tree);\n+static tree check_case_value (location_t, tree);\n static bool check_case_bounds (location_t, tree, tree, tree *, tree *);\n \n static tree handle_packed_attribute (tree *, tree, tree, int, bool *);\n@@ -3349,7 +3349,7 @@ verify_sequence_points (tree expr)\n /* Validate the expression after `case' and apply default promotions.  */\n \n static tree\n-check_case_value (tree value)\n+check_case_value (location_t loc, tree value)\n {\n   if (value == NULL_TREE)\n     return value;\n@@ -3359,7 +3359,7 @@ check_case_value (tree value)\n     value = perform_integral_promotions (value);\n   else if (value != error_mark_node)\n     {\n-      error (\"case label does not reduce to an integer constant\");\n+      error_at (loc, \"case label does not reduce to an integer constant\");\n       value = error_mark_node;\n     }\n \n@@ -5993,14 +5993,14 @@ c_add_case_label (location_t loc, splay_tree cases, tree cond, tree orig_type,\n   type = TREE_TYPE (cond);\n   if (low_value)\n     {\n-      low_value = check_case_value (low_value);\n+      low_value = check_case_value (loc, low_value);\n       low_value = convert_and_check (loc, type, low_value);\n       if (low_value == error_mark_node)\n \tgoto error_out;\n     }\n   if (high_value)\n     {\n-      high_value = check_case_value (high_value);\n+      high_value = check_case_value (loc, high_value);\n       high_value = convert_and_check (loc, type, high_value);\n       if (high_value == error_mark_node)\n \tgoto error_out;"}, {"sha": "d18aed8ee1b74accb846cedbbc3de57c2df2d3d4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "patch": "@@ -1,3 +1,7 @@\n+2014-08-03  Marek Polacek  <polacek@redhat.com>\n+\n+\t* gcc.dg/case-bogus-1.c: New test.\n+\n 2014-08-02  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/15339"}, {"sha": "548312edf9e4fd56efcd61df8512d9fe713059b3", "filename": "gcc/testsuite/gcc.dg/case-bogus-1.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Ftestsuite%2Fgcc.dg%2Fcase-bogus-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6/gcc%2Ftestsuite%2Fgcc.dg%2Fcase-bogus-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcase-bogus-1.c?ref=62e4eb3553f9ce05a6d08a1ef7d8e59f81aeeee6", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+\n+void\n+foo (int n)\n+{\n+  switch (n)\n+    case 0: case 3: case 0.2: case 5:; /* { dg-error \"21:case label does not reduce to an integer constant\" } */\n+}"}]}