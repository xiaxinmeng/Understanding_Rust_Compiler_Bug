{"sha": "8fb08bdddfb1f19debb76262e8afb99d39a789ea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGZiMDhiZGRkZmIxZjE5ZGViYjc2MjYyZThhZmI5OWQzOWE3ODllYQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@markmitchell.com", "date": "1998-07-28T16:50:16Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "1998-07-28T16:50:16Z"}, "message": "friend.c (is_friend): Be lenient with member functions to deal with nested friends.\n\n\t* friend.c (is_friend): Be lenient with member functions to deal\n\twith nested friends.\n\nFrom-SVN: r21444", "tree": {"sha": "b79ade80c1954652445f03992bacbac7ee25370a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b79ade80c1954652445f03992bacbac7ee25370a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8fb08bdddfb1f19debb76262e8afb99d39a789ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fb08bdddfb1f19debb76262e8afb99d39a789ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8fb08bdddfb1f19debb76262e8afb99d39a789ea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fb08bdddfb1f19debb76262e8afb99d39a789ea/comments", "author": null, "committer": null, "parents": [{"sha": "9b126a10257844bbed01fecc3a557f5fa23f3ed1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b126a10257844bbed01fecc3a557f5fa23f3ed1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b126a10257844bbed01fecc3a557f5fa23f3ed1"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "db4baa19242fd01f10bbb39098847470686d3eb1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fb08bdddfb1f19debb76262e8afb99d39a789ea/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fb08bdddfb1f19debb76262e8afb99d39a789ea/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=8fb08bdddfb1f19debb76262e8afb99d39a789ea", "patch": "@@ -1,3 +1,8 @@\n+1998-07-28  Mark Mitchell  <mark@markmitchell.com>\n+\n+\t* friend.c (is_friend): Be lenient with member functions to deal\n+\twith nested friends.\n+\n 1998-07-28  Jason Merrill  <jason@yorick.cygnus.com>\n \n \t* class.c (finish_struct_1): Convert integer_zero_node to"}, {"sha": "5a97766fe0451e01ef7e802d030aa26105044c49", "filename": "gcc/cp/friend.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fb08bdddfb1f19debb76262e8afb99d39a789ea/gcc%2Fcp%2Ffriend.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fb08bdddfb1f19debb76262e8afb99d39a789ea/gcc%2Fcp%2Ffriend.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ffriend.c?ref=8fb08bdddfb1f19debb76262e8afb99d39a789ea", "patch": "@@ -77,8 +77,15 @@ is_friend (type, supplicant)\n \t\t     friendship.  This is bogus in general since two\n \t\t     specializations of a template with non-type\n \t\t     template parameters may have the same type, but\n-\t\t     be different.  */\n-\t\t  if (flag_guiding_decls \n+\t\t     be different.  \n+\n+\t\t     Temporarily, we are also more lenient to deal\n+\t\t     with nested friend functions, for which there can\n+\t\t     be more than one FUNCTION_DECL, despite being the\n+\t\t     same function.  When that's fixed, the\n+\t\t     FUNCTION_MEMBER_P bit can go.  */\n+\t\t  if ((flag_guiding_decls \n+\t\t       || DECL_FUNCTION_MEMBER_P (supplicant))\n \t\t      && comptypes (TREE_TYPE (supplicant),\n \t\t\t\t    TREE_TYPE (TREE_VALUE (friends)), 1))\n \t\t    return 1;"}, {"sha": "84c6b2d3b7c6d4d3d8777eac199daff7978e4345", "filename": "gcc/testsuite/g++.old-deja/g++.other/friend3.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8fb08bdddfb1f19debb76262e8afb99d39a789ea/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Ffriend3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8fb08bdddfb1f19debb76262e8afb99d39a789ea/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Ffriend3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Ffriend3.C?ref=8fb08bdddfb1f19debb76262e8afb99d39a789ea", "patch": "@@ -0,0 +1,23 @@\n+// Build don't link:\n+\n+class foo {\n+public:\n+    class bar;\n+    void func(bar *);\n+    class bar {\n+      int st;\n+      friend void foo::func(bar *);\n+    };\n+};\n+\n+\n+void foo::func(bar *obj) {\n+  obj->st++;\n+}\n+\n+void test02() {\n+  foo obj_f;\n+  foo::bar obj_b;\n+  \n+  obj_f.func( &obj_b);\n+}"}]}