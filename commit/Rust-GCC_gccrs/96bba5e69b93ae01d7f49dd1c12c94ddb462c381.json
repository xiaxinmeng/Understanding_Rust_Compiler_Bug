{"sha": "96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTZiYmE1ZTY5YjkzYWUwMWQ3ZjQ5ZGQxYzEyYzk0ZGRiNDYyYzM4MQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2010-07-23T19:53:29Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2010-07-23T19:53:29Z"}, "message": "utils.c (gnat_types_compatible_p): Revert latest change and recurse only for multidimensional array types instead.\n\n\t* gcc-interface/utils.c (gnat_types_compatible_p): Revert latest change\n\tand recurse only for multidimensional array types instead.\n\nFrom-SVN: r162485", "tree": {"sha": "5cb1304c4753378138ad13050630e8b216a0809c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5cb1304c4753378138ad13050630e8b216a0809c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "html_url": "https://github.com/Rust-GCC/gccrs/commit/96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/comments", "author": null, "committer": null, "parents": [{"sha": "9183bdcf817721420abd4a68de2b6e933347237c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9183bdcf817721420abd4a68de2b6e933347237c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9183bdcf817721420abd4a68de2b6e933347237c"}], "stats": {"total": 74, "additions": 72, "deletions": 2}, "files": [{"sha": "1ef253c4494b77bf5f04ba3b23d1fbf9b05e9331", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "patch": "@@ -1,3 +1,8 @@\n+2010-07-23  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/utils.c (gnat_types_compatible_p): Revert latest change\n+\tand recurse only for multidimensional array types instead.\n+\n 2010-07-22  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR ada/44892"}, {"sha": "7752edb4b6896f496233851f3d0ebf6b64f7ea36", "filename": "gcc/ada/gcc-interface/utils.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Fada%2Fgcc-interface%2Futils.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Fada%2Fgcc-interface%2Futils.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Futils.c?ref=96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "patch": "@@ -2081,7 +2081,7 @@ gnat_types_compatible_p (tree t1, tree t2)\n     return 1;\n \n   /* Array types are also compatible if they are constrained and have the same\n-     domain and compatible component types.  */\n+     domain(s) and the same component type.  */\n   if (code == ARRAY_TYPE\n       && (TYPE_DOMAIN (t1) == TYPE_DOMAIN (t2)\n \t  || (TYPE_DOMAIN (t1)\n@@ -2090,7 +2090,9 @@ gnat_types_compatible_p (tree t1, tree t2)\n \t\t\t\t     TYPE_MIN_VALUE (TYPE_DOMAIN (t2)))\n \t      && tree_int_cst_equal (TYPE_MAX_VALUE (TYPE_DOMAIN (t1)),\n \t\t\t\t     TYPE_MAX_VALUE (TYPE_DOMAIN (t2)))))\n-      && gnat_types_compatible_p (TREE_TYPE (t1), TREE_TYPE (t2)))\n+      && (TREE_TYPE (t1) == TREE_TYPE (t2)\n+\t  || (TREE_CODE (TREE_TYPE (t1)) == ARRAY_TYPE\n+\t      && gnat_types_compatible_p (TREE_TYPE (t1), TREE_TYPE (t2)))))\n     return 1;\n \n   /* Padding record types are also compatible if they pad the same"}, {"sha": "bdc2660cbbec71858f6961590f2be0fd669d81ae", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "patch": "@@ -1,3 +1,8 @@\n+2010-07-23  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/aggr16.ad[sb]: New test.\n+\t* gnat.dg/aggr16_pkg.ads: New helper.\n+\n 2010-07-23  Richard Guenther  <rguenther@suse.de>\n \n \tPR lto/43071"}, {"sha": "2f559da25f9bf4fd1dd0e0a60797581a17eb0291", "filename": "gcc/testsuite/gnat.dg/aggr16.adb", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16.adb?ref=96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "patch": "@@ -0,0 +1,26 @@\n+-- { dg-do compile }\n+\n+with Aggr16_Pkg; use Aggr16_Pkg;\n+\n+package body Aggr16 is\n+\n+  type Arr is array (1 .. 4) of Time;\n+\n+  type Change_Type is (One, Two, Three);\n+\n+  type Change (D : Change_Type) is record\n+    case D is\n+      when Three =>\n+        A : Arr;\n+      when Others =>\n+        B : Boolean;\n+    end case;\n+  end record;\n+\n+  procedure Proc is\n+    C : Change (Three);\n+  begin\n+    C.A := (others => Null_Time);\n+  end;\n+\n+end Aggr16;"}, {"sha": "3a4b0d1dfa8d9a3014f174870a2fda3bf1f99612", "filename": "gcc/testsuite/gnat.dg/aggr16.ads", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16.ads?ref=96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "patch": "@@ -0,0 +1,5 @@\n+package Aggr16 is\n+\n+  procedure Proc;\n+\n+end Aggr16;"}, {"sha": "8bacbc9b04fbae6da8c4244f849e2cb0434d5eb1", "filename": "gcc/testsuite/gnat.dg/aggr16_pkg.ads", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96bba5e69b93ae01d7f49dd1c12c94ddb462c381/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Faggr16_pkg.ads?ref=96bba5e69b93ae01d7f49dd1c12c94ddb462c381", "patch": "@@ -0,0 +1,27 @@\n+package Aggr16_Pkg is\n+\n+  type Time_Type is (A, B);\n+\n+  type Time (D : Time_Type := A) is private;\n+\n+  Null_Time : constant Time;\n+\n+private\n+\n+  type Hour is record\n+    I1 : Integer;\n+    I2 : Integer;\n+  end record;\n+\n+  type Time (D : Time_Type := A) is record\n+    case D is\n+      when A =>\n+        A_Time : Integer;\n+      when B =>\n+        B_Time : Hour;\n+    end case;\n+  end record;\n+\n+  Null_Time : constant Time := (A, 0);\n+\n+end Aggr16_Pkg;"}]}