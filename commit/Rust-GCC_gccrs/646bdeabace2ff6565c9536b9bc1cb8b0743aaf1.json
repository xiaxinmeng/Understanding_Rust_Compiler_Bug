{"sha": "646bdeabace2ff6565c9536b9bc1cb8b0743aaf1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjQ2YmRlYWJhY2UyZmY2NTY1Yzk1MzZiOWJjMWNiOGIwNzQzYWFmMQ==", "commit": {"author": {"name": "H.J. Lu", "email": "hongjiu.lu@intel.com", "date": "2014-01-18T13:25:40Z"}, "committer": {"name": "H.J. Lu", "email": "hjl@gcc.gnu.org", "date": "2014-01-18T13:25:40Z"}, "message": "Update x86 --with-arch/--with-cpu= configure handling\n\n\tPR bootstrap/59580\n\tPR bootstrap/59583\n\t* config.gcc (x86_archs): New variable.\n\t(x86_64_archs): Likewise.\n\t(x86_cpus): Likewise.\n\tUse $x86_archs, $x86_64_archs and $x86_cpus to check valid\n\t--with-arch/--with-cpu= options.\n\tSupport --with-arch=/--with-cpu={nehalem,westmere,\n\tsandybridge,ivybridge,haswell,broadwell,bonnell,silvermont}.\n\nFrom-SVN: r206756", "tree": {"sha": "ed0dc6666e757f10c7e9e139df12cec452c59b57", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ed0dc6666e757f10c7e9e139df12cec452c59b57"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7f3af6d379c17fc35e3e2ec3151ae98862191f7c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f3af6d379c17fc35e3e2ec3151ae98862191f7c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f3af6d379c17fc35e3e2ec3151ae98862191f7c"}], "stats": {"total": 145, "additions": 95, "deletions": 50}, "files": [{"sha": "89669bd4597c3a06f1b862aafe6497a052a25e57", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=646bdeabace2ff6565c9536b9bc1cb8b0743aaf1", "patch": "@@ -1,3 +1,15 @@\n+2014-01-18   H.J. Lu  <hongjiu.lu@intel.com>\n+\n+\tPR bootstrap/59580\n+\tPR bootstrap/59583\n+\t* config.gcc (x86_archs): New variable.\n+\t(x86_64_archs): Likewise.\n+\t(x86_cpus): Likewise.\n+\tUse $x86_archs, $x86_64_archs and $x86_cpus to check valid\n+\t--with-arch/--with-cpu= options.\n+\tSupport --with-arch=/--with-cpu={nehalem,westmere,\n+\tsandybridge,ivybridge,haswell,broadwell,bonnell,silvermont}.\n+\n 2014-01-18  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.c (ix86_adjust_cost): Reorder PROCESSOR_K8"}, {"sha": "c3124be40e9c02027985424f633eefa53845fb47", "filename": "gcc/config.gcc", "status": "modified", "additions": 83, "deletions": 50, "changes": 133, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/646bdeabace2ff6565c9536b9bc1cb8b0743aaf1/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=646bdeabace2ff6565c9536b9bc1cb8b0743aaf1", "patch": "@@ -596,6 +596,24 @@ esac\n # Common C libraries.\n tm_defines=\"$tm_defines LIBC_GLIBC=1 LIBC_UCLIBC=2 LIBC_BIONIC=3\"\n \n+# 32-bit x86 processors supported by --with-arch=.  Each processor\n+# MUST be separated by exactly one space.\n+x86_archs=\"athlon athlon-4 athlon-fx athlon-mp athlon-tbird \\\n+athlon-xp k6 k6-2 k6-3 geode c3 c3-2 winchip-c6 winchip2 i386 i486 \\\n+i586 i686 pentium pentium-m pentium-mmx pentium2 pentium3 pentium3m \\\n+pentium4 pentium4m pentiumpro prescott\"\n+\n+# 64-bit x86 processors supported by --with-arch=.  Each processor\n+# MUST be separated by exactly one space.\n+x86_64_archs=\"amdfam10 athlon64 athlon64-sse3 barcelona bdver1 bdver2 \\\n+bdver3 bdver4 btver1 btver2 k8 k8-sse3 opteron opteron-sse3 nocona \\\n+core2 corei7 corei7-avx core-avx-i core-avx2 atom slm nehalem westmere \\\n+sandybridge ivybridge haswell broadwell bonnell silvermont x86-64 native\"\n+\n+# Additional x86 processors supported by --with-cpu=.  Each processor\n+# MUST be separated by exactly one space.\n+x86_cpus=\"generic intel\"\n+\n # Common parts for widely ported systems.\n case ${target} in\n *-*-darwin*)\n@@ -1401,20 +1419,21 @@ i[34567]86-*-linux* | i[34567]86-*-kfreebsd*-gnu | i[34567]86-*-knetbsd*-gnu | i\n \t\t\tdone\n \t\t\tTM_MULTILIB_CONFIG=`echo $TM_MULTILIB_CONFIG | sed 's/^,//'`\n \t\t\tneed_64bit_isa=yes\n-\t\t\tcase X\"${with_cpu}\" in\n-\t\t\tXgeneric|Xintel|Xatom|Xslm|Xcore2|Xcorei7|Xcorei7-avx|Xnocona|Xx86-64|Xbdver4|Xbdver3|Xbdver2|Xbdver1|Xbtver2|Xbtver1|Xamdfam10|Xbarcelona|Xk8|Xopteron|Xathlon64|Xathlon-fx|Xathlon64-sse3|Xk8-sse3|Xopteron-sse3)\t\t\t\n-\t\t\t\t;;\n-\t\t\tX)\n+\t\t\tif test x$with_cpu = x; then\n \t\t\t\tif test x$with_cpu_64 = x; then\n \t\t\t\t\twith_cpu_64=generic\n \t\t\t\tfi\n-\t\t\t\t;;\n-\t\t\t*)\n-\t\t\t\techo \"Unsupported CPU used in --with-cpu=$with_cpu, supported values:\" 1>&2\n-\t\t\t\techo \"generic intel atom slm core2 corei7 corei7-avx nocona x86-64 bdver4 bdver3 bdver2 bdver1 btver2 btver1 amdfam10 barcelona k8 opteron athlon64 athlon-fx athlon64-sse3 k8-sse3 opteron-sse3\" 1>&2\n-\t\t\t\texit 1\n-\t\t\t\t;;\n-\t\t\tesac\n+\t\t\telse\n+\t\t\t\tcase \" $x86_cpus $x86_archs $x86_64_archs \" in\n+\t\t\t\t*\" $with_cpu \"*)\n+\t\t\t\t\t;;\n+\t\t\t\t*)\n+\t\t\t\t\techo \"Unsupported CPU used in --with-cpu=$with_cpu, supported values:\" 1>&2\n+\t\t\t\t\techo \"$x86_cpus $x86_archs $x86_64_archs \" 1>&2\n+\t\t\t\t\texit 1\n+\t\t\t\t\t;;\n+\t\t\t\tesac\n+\t\t\tfi\n \t\telse\n \t\t\ttm_file=\"${tm_file} i386/gnu-user-common.h i386/gnu-user.h i386/linux-common.h i386/linux.h\"\n \t\tfi\n@@ -1523,20 +1542,21 @@ i[34567]86-*-solaris2* | x86_64-*-solaris2.1[0-9]*)\n \t\ttm_defines=\"${tm_defines} TARGET_BI_ARCH=1\"\n \t\ttmake_file=\"$tmake_file i386/t-sol2-64\"\n \t\tneed_64bit_isa=yes\n-\t\tcase X\"${with_cpu}\" in\n-\t\tXgeneric|Xintel|Xatom|Xslm|Xcore2|Xcorei7|Xcorei7-avx|Xnocona|Xx86-64|Xbdver4|Xbdver3|Xbdver2|Xbdver1|Xbtver2|Xbtver1|Xamdfam10|Xbarcelona|Xk8|Xopteron|Xathlon64|Xathlon-fx|Xathlon64-sse3|Xk8-sse3|Xopteron-sse3)\n-\t\t\t;;\n-\t\tX)\n+\t\tif test x$with_cpu = x; then\n \t\t\tif test x$with_cpu_64 = x; then\n \t\t\t\twith_cpu_64=generic\n \t\t\tfi\n-\t\t\t;;\n-\t\t*)\n-\t\t\techo \"Unsupported CPU used in --with-cpu=$with_cpu, supported values:\" 1>&2\n-\t\t\techo \"generic intel atom slm core2 corei7 corei7-avx nocona x86-64 bdver4 bdver3 bdver2 bdver1 btver2 btver1 amdfam10 barcelona k8 opteron athlon64 athlon-fx athlon64-sse3 k8-sse3 opteron-sse3\" 1>&2\n-\t\t\texit 1\n-\t\t\t;;\n-\t\tesac\n+\t\telse\n+\t\t\tcase \" $x86_cpus $x86_archs $x86_64_archs \" in\n+\t\t\t*\" $with_cpu \"*)\n+\t\t\t\t;;\n+\t\t\t*)\n+\t\t\t\techo \"Unsupported CPU used in --with-cpu=$with_cpu, supported values:\" 1>&2\n+\t\t\t\techo \"$x86_cpus $x86_archs $x86_64_archs\" 1>&2\n+\t\t\t\texit 1\n+\t\t\t\t;;\n+\t\t\tesac\n+\t\tfi\n \t\t;;\n \tesac\n \t;;\n@@ -1608,20 +1628,21 @@ i[34567]86-*-mingw* | x86_64-*-mingw*)\n \t\t\ttm_file=\"${tm_file} i386/mingw-w64.h\"\n \t\t\tif test x$enable_targets = xall; then\n \t\t\t\ttm_defines=\"${tm_defines} TARGET_BI_ARCH=1\"\n-\t\t\t\tcase X\"${with_cpu}\" in\n-\t\t\t\tXgeneric|Xintel|Xatom|Xslm|Xcore2|Xcorei7|Xcorei7-avx|Xnocona|Xx86-64|Xbdver4|Xbdver3|Xbdver2|Xbdver1|Xbtver2|Xbtver1|Xamdfam10|Xbarcelona|Xk8|Xopteron|Xathlon64|Xathlon-fx|Xathlon64-sse3|Xk8-sse3|Xopteron-sse3)\n-\t\t\t\t\t;;\n-\t\t\t\tX)\n+\t\t\t\tif test x$with_cpu = x; then\n \t\t\t\t\tif test x$with_cpu_64 = x; then\n \t\t\t\t\t\twith_cpu_64=generic\n \t\t\t\t\tfi\n-\t\t\t\t\t;;\n-\t\t\t\t*)\n-\t\t\t\t\techo \"Unsupported CPU used in --with-cpu=$with_cpu, supported values:\" 1>&2\n-\t\t\t\t\techo \"generic intel atom slm core2 corei7 Xcorei7-avx nocona x86-64 bdver4 bdver3 bdver2 bdver1 btver2 btver1 amdfam10 barcelona k8 opteron athlon64 athlon-fx athlon64-sse3 k8-sse3 opteron-sse3\" 1>&2\n-\t\t\t\t\texit 1\n-\t\t\t\t\t;;\n-\t\t\t\tesac\n+\t\t\t\telse\n+\t\t\t\t\tcase \" $x86_cpus $x86_archs $x86_64_archs \" in\n+\t\t\t\t\t*\" $with_cpu \"*)\n+\t\t\t\t\t\t;;\n+\t\t\t\t\t*)\n+\t\t\t\t\t\techo \"Unsupported CPU used in --with-cpu=$with_cpu, supported values:\" 1>&2\n+\t\t\t\t\t\techo \"$x86_cpus $x86_archs $x86_64_archs\" 1>&2\n+\t\t\t\t\t\texit 1\n+\t\t\t\t\t\t;;\n+\t\t\t\t\tesac\n+\t\t\t\tfi\n \t\t\tfi\n \t\t\t;;\n \t\t*)\n@@ -3668,13 +3689,8 @@ case \"${target}\" in\n \t\tsupported_defaults=\"abi arch arch_32 arch_64 cpu cpu_32 cpu_64 tune tune_32 tune_64\"\n \t\tfor which in arch arch_32 arch_64 cpu cpu_32 cpu_64 tune tune_32 tune_64; do\n \t\t\teval \"val=\\$with_$which\"\n-\t\t\tcase ${val} in\n-\t\t\ti386 | i486 \\\n-\t\t\t| i586 | pentium | pentium-mmx | winchip-c6 | winchip2 \\\n-\t\t\t| c3 | c3-2 | i686 | pentiumpro | pentium2 | pentium3 \\\n-\t\t\t| pentium4 | k6 | k6-2 | k6-3 | athlon | athlon-tbird \\\n-\t\t\t| athlon-4 | athlon-xp | athlon-mp | geode \\\n-\t\t\t| prescott | pentium-m | pentium4m | pentium3m)\n+\t\t\tcase \" $x86_archs \" in\n+\t\t\t*\" ${val} \"*)\n \t\t\t\tcase \"${target}\" in\n \t\t\t\t  x86_64-*-*)\n \t\t\t\t      case \"x$which\" in\n@@ -3689,17 +3705,34 @@ case \"${target}\" in\n \t\t\t\tesac\n \t\t\t\t# OK\n \t\t\t\t;;\n-\t\t\t\"\" | x86-64 | generic | intel | native \\\n-\t\t\t| k8 | k8-sse3 | athlon64 | athlon64-sse3 | opteron \\\n-\t\t\t| opteron-sse3 | athlon-fx | bdver4 | bdver3 | bdver2 \\\n-\t\t\t| bdver1 | btver2 |  btver1 | amdfam10 | barcelona \\\n-\t\t\t| nocona | core2 | corei7 | corei7-avx | core-avx-i \\\n-\t\t\t| core-avx2 | broadwell | atom | slm)\n-\t\t\t\t# OK\n-\t\t\t\t;;\n \t\t\t*)\n-\t\t\t\techo \"Unknown CPU given in --with-$which=$val.\" 1>&2\n-\t\t\t\texit 1\n+\t\t\t\tif test x${val} != x; then\n+\t\t\t\t\tcase \" $x86_64_archs \" in\n+\t\t\t\t\t*\" ${val} \"*)\n+\t\t\t\t\t\t# OK\n+\t\t\t\t\t\t;;\n+\t\t\t\t\t*)\n+\t\t\t\t\t\t# Allow $x86_cpus --with-cpu=/--with-tune=\n+\t\t\t\t\t\tcase \"x$which\" in\n+\t\t\t\t\t\txcpu*|xtune*)\n+\t\t\t\t\t\t\tcase \" $x86_cpus \" in\n+\t\t\t\t\t\t\t*\" ${val} \"*)\n+\t\t\t\t\t\t\t\t# OK\n+\t\t\t\t\t\t\t\t;;\n+\t\t\t\t\t\t\t*)\n+\t\t\t\t\t\t\t\techo \"Unknown CPU given in --with-$which=$val.\" 1>&2\n+\t\t\t\t\t\t\t\texit 1\n+\t\t\t\t\t\t\t\t;;\n+\t\t\t\t\t\t\tesac\n+\t\t\t\t\t\t\t;;\n+\t\t\t\t\t\t*)\n+\t\t\t\t\t\t\techo \"Unknown CPU given in --with-$which=$val.\" 1>&2\n+\t\t\t\t\t\t\texit 1\n+\t\t\t\t\t\t\t;;\n+\t\t\t\t\t\tesac\n+\t\t\t\t\t;;\n+\t\t\t\t\tesac\n+\t\t\t\tfi\n \t\t\t\t;;\n \t\t\tesac\n \t\tdone"}]}