{"sha": "6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmViNTM1MTE0OWZiZTM3ZjA2YzQzYmFjYjk2OGU3MWJkNzNkZmJiNQ==", "commit": {"author": {"name": "Joseph Myers", "email": "jsm28@cam.ac.uk", "date": "2001-12-23T23:49:32Z"}, "committer": {"name": "Joseph Myers", "email": "jsm28@gcc.gnu.org", "date": "2001-12-23T23:49:32Z"}, "message": "re PR c/2454 (Test Program A0376972.c fails with gcc-20010320, works with gcc-2.95.3)\n\n\t* c-typeck.c (c_start_case): Don't strip conversions from the\n\tcontrolling expression.  Partially fixes PR c/2454.\n\ntestsuite:\n\t* gcc.c-torture/execute/20011223-1.c: New test.\n\nFrom-SVN: r48292", "tree": {"sha": "cfc882b1b4637780b15a77b7142e30441226ffc1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cfc882b1b4637780b15a77b7142e30441226ffc1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b31bbca2fe191ef1ac1b31872a57328b916ef735", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b31bbca2fe191ef1ac1b31872a57328b916ef735", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b31bbca2fe191ef1ac1b31872a57328b916ef735"}], "stats": {"total": 40, "additions": 31, "deletions": 9}, "files": [{"sha": "1b84b71906883233114803326cb0285dcf79259c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "patch": "@@ -1,3 +1,8 @@\n+2001-12-23  Joseph S. Myers  <jsm28@cam.ac.uk>\n+\n+\t* c-typeck.c (c_start_case): Don't strip conversions from the\n+\tcontrolling expression.  Partially fixes PR c/2454.\n+\n 2001-12-23  Joseph S. Myers  <jsm28@cam.ac.uk>\n \n \t* Makefile.in (USER_H): Remove proto.h."}, {"sha": "eacf4f5669143e8717d8406e1fff11e10c3a90ef", "filename": "gcc/c-typeck.c", "status": "modified", "additions": 0, "deletions": 9, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-typeck.c?ref=6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "patch": "@@ -7125,7 +7125,6 @@ c_start_case (exp)\n \t}\n       else\n \t{\n-\t  tree index;\n \t  type = TYPE_MAIN_VARIANT (TREE_TYPE (exp));\n \n \t  if (warn_traditional && !in_system_header\n@@ -7135,14 +7134,6 @@ c_start_case (exp)\n \n \t  exp = default_conversion (exp);\n \t  type = TREE_TYPE (exp);\n-\t  index = get_unwidened (exp, NULL_TREE);\n-\t  /* We can't strip a conversion from a signed type to an\n-\t     unsigned, because if we did, int_fits_type_p would do the\n-\t     wrong thing when checking case values for being in range,\n-\t     and it's too hard to do the right thing.  */\n-\t  if (TREE_UNSIGNED (TREE_TYPE (exp))\n-\t      == TREE_UNSIGNED (TREE_TYPE (index)))\n-\t    exp = index;\n \t}\n     }\n "}, {"sha": "68f0c616887a956def92d9c160f9ef80b5e131e2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "patch": "@@ -1,3 +1,7 @@\n+2001-12-23  Joseph S. Myers  <jsm28@cam.ac.uk>\n+\n+\t* gcc.c-torture/execute/20011223-1.c: New test.\n+\n 2001-12-21  Richard Henderson  <rth@redhat.com>\n \n \t* gcc.dg/wtr-aggr-init-1.c: Test that __extension__ disables then"}, {"sha": "18fb72089278a5702146b7842a87838f34883a4e", "filename": "gcc/testsuite/gcc.c-torture/execute/20011223-1.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20011223-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6eb5351149fbe37f06c43bacb968e71bd73dfbb5/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20011223-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F20011223-1.c?ref=6eb5351149fbe37f06c43bacb968e71bd73dfbb5", "patch": "@@ -0,0 +1,22 @@\n+/* Origin: Joseph Myers <jsm28@cam.ac.uk>.  */\n+/* Case labels in a switch statement are converted to the promoted\n+   type of the controlling expression, not an unpromoted version.\n+   Reported as PR c/2454 by\n+   Andreas Krakowczyk <Andreas.Krakowczyk@fujitsu-siemens.com>.  */\n+\n+extern void exit (int);\n+extern void abort (void);\n+\n+static int i;\n+\n+int\n+main (void)\n+{\n+  i = -1;\n+  switch ((signed char) i) {\n+  case 255:\n+    abort ();\n+  default:\n+    exit (0);\n+  }\n+}"}]}