{"sha": "74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzRhMWM2MmZjYTVjYTkzYWU5MzJhYzc2Y2E0NDI2NjBkOWM3OGMzYQ==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2015-01-02T16:31:52Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2015-01-02T16:31:52Z"}, "message": "re PR fortran/57562 ([OOP] ICE due to extended derived type with PARAMETER attribute)\n\n2015-01-02  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/57562\n\t* expr.c (find_component_ref): Deal with extended types.\n\n2015-01-02  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/57562\n\t* gfortran.dg/extends_16.f90: New.\n\nFrom-SVN: r219144", "tree": {"sha": "1a3c295bbabbdb58c8d6b49ea5948478a94694b0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1a3c295bbabbdb58c8d6b49ea5948478a94694b0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "09ed8520b912f4455741528556e62cd3cfa8a53d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09ed8520b912f4455741528556e62cd3cfa8a53d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09ed8520b912f4455741528556e62cd3cfa8a53d"}], "stats": {"total": 56, "additions": 51, "deletions": 5}, "files": [{"sha": "9c88eb8ead69effddfe849764578ac7dafdfa5d9", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "patch": "@@ -1,3 +1,8 @@\n+2015-01-02  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/57562\n+\t* expr.c (find_component_ref): Deal with extended types.\n+\n 2015-01-02  Tobias Burnus  <burnus@net-b.de>\n \n \t* trans-decl.c (gfc_build_qualified_array): Fix coarray tokens"}, {"sha": "2d85092865f37da45252d7c7860dff7fdb63118e", "filename": "gcc/fortran/expr.c", "status": "modified", "additions": 15, "deletions": 4, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ffortran%2Fexpr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ffortran%2Fexpr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fexpr.c?ref=74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "patch": "@@ -1270,12 +1270,23 @@ find_array_element (gfc_constructor_base base, gfc_array_ref *ar,\n static gfc_constructor *\n find_component_ref (gfc_constructor_base base, gfc_ref *ref)\n {\n-  gfc_component *comp;\n-  gfc_component *pick;\n+  gfc_component *pick = ref->u.c.component;\n   gfc_constructor *c = gfc_constructor_first (base);\n \n-  comp = ref->u.c.sym->components;\n-  pick = ref->u.c.component;\n+  gfc_symbol *dt = ref->u.c.sym;\n+  int ext = dt->attr.extension;\n+\n+  /* For extended types, check if the desired component is in one of the\n+   * parent types.  */\n+  while (ext > 0 && gfc_find_component (dt->components->ts.u.derived,\n+\t\t\t\t\tpick->name, true, true))\n+    {\n+      dt = dt->components->ts.u.derived;\n+      c = gfc_constructor_first (c->expr->value.constructor);\n+      ext--;\n+    }\n+\n+  gfc_component *comp = dt->components;\n   while (comp != pick)\n     {\n       comp = comp->next;"}, {"sha": "5fc092e9acf3ec67e1507fd4855d22a16849bd11", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "patch": "@@ -1,3 +1,8 @@\n+2015-01-02  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/57562\n+\t* gfortran.dg/extends_16.f90: New.\n+\n 2015-01-02  Tobias Burnus  <burnus@net-b.de>\n \n \t* gfortran.dg/coarray/caf.exp (dg-compile-aux-modules): Add.\n@@ -12,7 +17,7 @@\n 2015-01-02  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/60507\n-\t* gfortran.dg/dummy_procedure_11: New.\n+\t* gfortran.dg/dummy_procedure_11.f90: New.\n \n Copyright (C) 2015 Free Software Foundation, Inc.\n "}, {"sha": "376fcaae49d4187da45b880fd381bb22e6e1987b", "filename": "gcc/testsuite/gfortran.dg/extends_16.f90", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ftestsuite%2Fgfortran.dg%2Fextends_16.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/74a1c62fca5ca93ae932ac76ca442660d9c78c3a/gcc%2Ftestsuite%2Fgfortran.dg%2Fextends_16.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fextends_16.f90?ref=74a1c62fca5ca93ae932ac76ca442660d9c78c3a", "patch": "@@ -0,0 +1,25 @@\n+! { dg-do run }\r\n+!\r\n+! PR 57562: [OOP] ICE due to extended derived type with PARAMETER attribute\r\n+!\r\n+! Contributed by <helvio.vairinhos@gmail.com>\r\n+\r\n+   type :: Parent\r\n+      integer :: member1 = 0\r\n+   end type\r\n+\r\n+   type, extends(Parent) :: Child\r\n+      integer :: member2 = 0\r\n+   end type\r\n+\r\n+   type, extends(Child) :: Grandchild\r\n+      integer :: member3 = 0\r\n+   end type\r\n+\r\n+   type(Grandchild), parameter :: object = Grandchild(23, 42, -99)\r\n+\r\n+   if (object%member1 /= 23) call abort\r\n+   if (object%member2 /= 42) call abort\r\n+   if (object%member3 /= -99) call abort\r\n+\r\n+end\r"}]}