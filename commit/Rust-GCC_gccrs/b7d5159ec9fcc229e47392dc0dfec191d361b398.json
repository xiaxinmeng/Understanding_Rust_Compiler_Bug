{"sha": "b7d5159ec9fcc229e47392dc0dfec191d361b398", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjdkNTE1OWVjOWZjYzIyOWU0NzM5MmRjMGRmZWMxOTFkMzYxYjM5OA==", "commit": {"author": {"name": "Dmitriy Anisimkov", "email": "anisimko@adacore.com", "date": "2019-07-04T08:05:13Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-04T08:05:13Z"}, "message": "[Ada] GNAT.Sockets: fix socket timeout on recent Windows versions\n\n2019-07-04  Dmitriy Anisimkov  <anisimko@adacore.com>\n\ngcc/ada/\n\n\t* doc/gnat_ugn/platform_specific_information.rst: Document\n\tWindows socket timeout particularity.\n\t* gnat_ugn.texi: Regenerate.\n\t* gsocket.h: Include versionhelpers.h.\n\t* socket.c (__gnat_minus_500ms): New function.\n\t* libgnat/g-sothco.ads (Minus_500ms_Windows_Timeout): New\n\timported function.\n\t* libgnat/g-socket.adb (Set_Socket_Option): Refactor to remove\n\t500ms from the requested timeout only on old Windows version.\n\nFrom-SVN: r273045", "tree": {"sha": "1728f625585772a56f8e449aaa314216359cdac1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1728f625585772a56f8e449aaa314216359cdac1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b7d5159ec9fcc229e47392dc0dfec191d361b398", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7d5159ec9fcc229e47392dc0dfec191d361b398", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7d5159ec9fcc229e47392dc0dfec191d361b398", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7d5159ec9fcc229e47392dc0dfec191d361b398/comments", "author": {"login": "anisimkov", "id": 15864134, "node_id": "MDQ6VXNlcjE1ODY0MTM0", "avatar_url": "https://avatars.githubusercontent.com/u/15864134?v=4", "gravatar_id": "", "url": "https://api.github.com/users/anisimkov", "html_url": "https://github.com/anisimkov", "followers_url": "https://api.github.com/users/anisimkov/followers", "following_url": "https://api.github.com/users/anisimkov/following{/other_user}", "gists_url": "https://api.github.com/users/anisimkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/anisimkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/anisimkov/subscriptions", "organizations_url": "https://api.github.com/users/anisimkov/orgs", "repos_url": "https://api.github.com/users/anisimkov/repos", "events_url": "https://api.github.com/users/anisimkov/events{/privacy}", "received_events_url": "https://api.github.com/users/anisimkov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1708a783b500003d88940ba6ef417efaf045bbc1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1708a783b500003d88940ba6ef417efaf045bbc1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1708a783b500003d88940ba6ef417efaf045bbc1"}], "stats": {"total": 346, "additions": 238, "deletions": 108}, "files": [{"sha": "789dc5da914145528229061d54b1369b9f8ccde0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b7d5159ec9fcc229e47392dc0dfec191d361b398", "patch": "@@ -1,3 +1,15 @@\n+2019-07-04  Dmitriy Anisimkov  <anisimko@adacore.com>\n+\n+\t* doc/gnat_ugn/platform_specific_information.rst: Document\n+\tWindows socket timeout particularity.\n+\t* gnat_ugn.texi: Regenerate.\n+\t* gsocket.h: Include versionhelpers.h.\n+\t* socket.c (__gnat_minus_500ms): New function.\n+\t* libgnat/g-sothco.ads (Minus_500ms_Windows_Timeout): New\n+\timported function.\n+\t* libgnat/g-socket.adb (Set_Socket_Option): Refactor to remove\n+\t500ms from the requested timeout only on old Windows version.\n+\n 2019-07-04  Thomas Quinot  <quinot@adacore.com>\n \n \t* get_scos.adb: Remove bogus, dead code."}, {"sha": "53f4d98d74fdb32add15de7ae766abb1579dedc6", "filename": "gcc/ada/doc/gnat_ugn/platform_specific_information.rst", "status": "modified", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fplatform_specific_information.rst", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fplatform_specific_information.rst", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdoc%2Fgnat_ugn%2Fplatform_specific_information.rst?ref=b7d5159ec9fcc229e47392dc0dfec191d361b398", "patch": "@@ -488,6 +488,49 @@ and::\n    Ada.Command_Line.Argument (1) -> \"'*.txt'\"\n \n \n+Windows Socket Timeouts\n+-----------------------\n+\n+Microsoft Windows desktops older than ``8.0`` and Microsoft Windows Servers\n+older than ``2019`` set a socket timeout 500 milliseconds longer than the value\n+set by setsockopt with ``SO_RCVTIMEO`` and ``SO_SNDTIMEO`` options. The GNAT\n+runtime makes a correction for the difference in the corresponding Windows\n+versions. For Windows Server starting with version ``2019``, the user must\n+provide a manifest file for the GNAT runtime to be able to recognize that\n+the Windows version does not need the timeout correction. The manifest file\n+should be located in the same directory as the executable file, and its file\n+name must match the executable name suffixed by ``.manifest``. For example,\n+if the executable name is :file:`sock_wto.exe`, then the manifest file name\n+has to be :file:`sock_wto.exe.manifest`. The manifest file must contain at\n+least the following data::\n+\n+   <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n+   <assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">\n+   <compatibility xmlns=\"urn:schemas-microsoft-com:compatibility.v1\">\n+   <application>\n+      <!-- Windows Vista -->\n+      <supportedOS Id=\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\"/>\n+      <!-- Windows 7 -->\n+      <supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\"/>\n+      <!-- Windows 8 -->\n+      <supportedOS Id=\"{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\"/>\n+      <!-- Windows 8.1 -->\n+      <supportedOS Id=\"{1f676c76-80e1-4239-95bb-83d0f6d0da78}\"/>\n+      <!-- Windows 10 -->\n+      <supportedOS Id=\"{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\"/>\n+   </application>\n+   </compatibility>\n+   </assembly>\n+\n+Without the manifest file, the socket timeout is going to be overcorrected on\n+these Windows Server versions and the actual time is going to be 500\n+milliseconds shorter than what was set with GNAT.Sockets.Set_Socket_Option.\n+Note that on Microsoft Windows versions where correction is necessary, there\n+is no way to set a socket timeout shorter than 500 ms. If a socket timeout\n+shorter than 500 ms is needed on these Windows versions, a call to\n+Check_Selector should be added before any socket read or write operations.\n+\n+\n .. _Mixed-Language_Programming_on_Windows:\n \n Mixed-Language Programming on Windows"}, {"sha": "8551a17bd85e80bb1e76578e4fb3413329b8a4c6", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 147, "deletions": 99, "changes": 246, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=b7d5159ec9fcc229e47392dc0dfec191d361b398", "patch": "@@ -463,6 +463,7 @@ Microsoft Windows Topics\n * CONSOLE and WINDOWS subsystems:: \n * Temporary Files:: \n * Disabling Command Line Argument Expansion:: \n+* Windows Socket Timeouts:: \n * Mixed-Language Programming on Windows:: \n * Windows Specific Add-Ons:: \n \n@@ -23909,6 +23910,7 @@ platforms.\n * CONSOLE and WINDOWS subsystems:: \n * Temporary Files:: \n * Disabling Command Line Argument Expansion:: \n+* Windows Socket Timeouts:: \n * Mixed-Language Programming on Windows:: \n * Windows Specific Add-Ons:: \n \n@@ -24082,7 +24084,7 @@ file will be created. This is particularly useful in networked\n environments where you may not have write access to some\n directories.\n \n-@node Disabling Command Line Argument Expansion,Mixed-Language Programming on Windows,Temporary Files,Microsoft Windows Topics\n+@node Disabling Command Line Argument Expansion,Windows Socket Timeouts,Temporary Files,Microsoft Windows Topics\n @anchor{gnat_ugn/platform_specific_information disabling-command-line-argument-expansion}@anchor{1e1}\n @subsection Disabling Command Line Argument Expansion\n \n@@ -24153,8 +24155,54 @@ and:\n Ada.Command_Line.Argument (1) -> \"'*.txt'\"\n @end example\n \n-@node Mixed-Language Programming on Windows,Windows Specific Add-Ons,Disabling Command Line Argument Expansion,Microsoft Windows Topics\n-@anchor{gnat_ugn/platform_specific_information id13}@anchor{1e2}@anchor{gnat_ugn/platform_specific_information mixed-language-programming-on-windows}@anchor{1e3}\n+@node Windows Socket Timeouts,Mixed-Language Programming on Windows,Disabling Command Line Argument Expansion,Microsoft Windows Topics\n+@anchor{gnat_ugn/platform_specific_information windows-socket-timeouts}@anchor{1e2}\n+@subsection Windows Socket Timeouts\n+\n+\n+Microsoft Windows desktops older than @code{8.0} and Microsoft Windows Servers\n+older than @code{2019} set a socket timeout 500 milliseconds longer than the value\n+set by setsockopt with @code{SO_RCVTIMEO} and @code{SO_SNDTIMEO} options. The GNAT\n+runtime makes a correction for the difference in the corresponding Windows\n+versions. For Windows Server starting with version @code{2019}, the user must\n+provide a manifest file for the GNAT runtime to be able to recognize that\n+the Windows version does not need the timeout correction. The manifest file\n+should be located in the same directory as the executable file, and its file\n+name must match the executable name suffixed by @code{.manifest}. For example,\n+if the executable name is @code{sock_wto.exe}, then the manifest file name\n+has to be @code{sock_wto.exe.manifest}. The manifest file must contain at\n+least the following data:\n+\n+@example\n+<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n+<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">\n+<compatibility xmlns=\"urn:schemas-microsoft-com:compatibility.v1\">\n+<application>\n+   <!-- Windows Vista -->\n+   <supportedOS Id=\"@{e2011457-1546-43c5-a5fe-008deee3d3f0@}\"/>\n+   <!-- Windows 7 -->\n+   <supportedOS Id=\"@{35138b9a-5d96-4fbd-8e2d-a2440225f93a@}\"/>\n+   <!-- Windows 8 -->\n+   <supportedOS Id=\"@{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38@}\"/>\n+   <!-- Windows 8.1 -->\n+   <supportedOS Id=\"@{1f676c76-80e1-4239-95bb-83d0f6d0da78@}\"/>\n+   <!-- Windows 10 -->\n+   <supportedOS Id=\"@{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a@}\"/>\n+</application>\n+</compatibility>\n+</assembly>\n+@end example\n+\n+Without the manifest file, the socket timeout is going to be overcorrected on\n+these Windows Server versions and the actual time is going to be 500\n+milliseconds shorter than what was set with GNAT.Sockets.Set_Socket_Option.\n+Note that on Microsoft Windows versions where correction is necessary, there\n+is no way to set a socket timeout shorter than 500 ms. If a socket timeout\n+shorter than 500 ms is needed on these Windows versions, a call to\n+Check_Selector should be added before any socket read or write operations.\n+\n+@node Mixed-Language Programming on Windows,Windows Specific Add-Ons,Windows Socket Timeouts,Microsoft Windows Topics\n+@anchor{gnat_ugn/platform_specific_information id13}@anchor{1e3}@anchor{gnat_ugn/platform_specific_information mixed-language-programming-on-windows}@anchor{1e4}\n @subsection Mixed-Language Programming on Windows\n \n \n@@ -24176,12 +24224,12 @@ to use the Microsoft tools for your C++ code, you have two choices:\n Encapsulate your C++ code in a DLL to be linked with your Ada\n application. In this case, use the Microsoft or whatever environment to\n build the DLL and use GNAT to build your executable\n-(@ref{1e4,,Using DLLs with GNAT}).\n+(@ref{1e5,,Using DLLs with GNAT}).\n \n @item \n Or you can encapsulate your Ada code in a DLL to be linked with the\n other part of your application. In this case, use GNAT to build the DLL\n-(@ref{1e5,,Building DLLs with GNAT Project files}) and use the Microsoft\n+(@ref{1e6,,Building DLLs with GNAT Project files}) and use the Microsoft\n or whatever environment to build your executable.\n @end itemize\n \n@@ -24238,7 +24286,7 @@ native SEH support is used.\n @end menu\n \n @node Windows Calling Conventions,Introduction to Dynamic Link Libraries DLLs,,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information windows-calling-conventions}@anchor{1e6}@anchor{gnat_ugn/platform_specific_information id14}@anchor{1e7}\n+@anchor{gnat_ugn/platform_specific_information windows-calling-conventions}@anchor{1e7}@anchor{gnat_ugn/platform_specific_information id14}@anchor{1e8}\n @subsubsection Windows Calling Conventions\n \n \n@@ -24283,7 +24331,7 @@ are available for Windows:\n @end menu\n \n @node C Calling Convention,Stdcall Calling Convention,,Windows Calling Conventions\n-@anchor{gnat_ugn/platform_specific_information c-calling-convention}@anchor{1e8}@anchor{gnat_ugn/platform_specific_information id15}@anchor{1e9}\n+@anchor{gnat_ugn/platform_specific_information c-calling-convention}@anchor{1e9}@anchor{gnat_ugn/platform_specific_information id15}@anchor{1ea}\n @subsubsection @code{C} Calling Convention\n \n \n@@ -24325,10 +24373,10 @@ is missing, as in the above example, this parameter is set to be the\n When importing a variable defined in C, you should always use the @code{C}\n calling convention unless the object containing the variable is part of a\n DLL (in which case you should use the @code{Stdcall} calling\n-convention, @ref{1ea,,Stdcall Calling Convention}).\n+convention, @ref{1eb,,Stdcall Calling Convention}).\n \n @node Stdcall Calling Convention,Win32 Calling Convention,C Calling Convention,Windows Calling Conventions\n-@anchor{gnat_ugn/platform_specific_information stdcall-calling-convention}@anchor{1ea}@anchor{gnat_ugn/platform_specific_information id16}@anchor{1eb}\n+@anchor{gnat_ugn/platform_specific_information stdcall-calling-convention}@anchor{1eb}@anchor{gnat_ugn/platform_specific_information id16}@anchor{1ec}\n @subsubsection @code{Stdcall} Calling Convention\n \n \n@@ -24425,23 +24473,23 @@ Note that to ease building cross-platform bindings this convention\n will be handled as a @code{C} calling convention on non-Windows platforms.\n \n @node Win32 Calling Convention,DLL Calling Convention,Stdcall Calling Convention,Windows Calling Conventions\n-@anchor{gnat_ugn/platform_specific_information win32-calling-convention}@anchor{1ec}@anchor{gnat_ugn/platform_specific_information id17}@anchor{1ed}\n+@anchor{gnat_ugn/platform_specific_information win32-calling-convention}@anchor{1ed}@anchor{gnat_ugn/platform_specific_information id17}@anchor{1ee}\n @subsubsection @code{Win32} Calling Convention\n \n \n This convention, which is GNAT-specific is fully equivalent to the\n @code{Stdcall} calling convention described above.\n \n @node DLL Calling Convention,,Win32 Calling Convention,Windows Calling Conventions\n-@anchor{gnat_ugn/platform_specific_information id18}@anchor{1ee}@anchor{gnat_ugn/platform_specific_information dll-calling-convention}@anchor{1ef}\n+@anchor{gnat_ugn/platform_specific_information id18}@anchor{1ef}@anchor{gnat_ugn/platform_specific_information dll-calling-convention}@anchor{1f0}\n @subsubsection @code{DLL} Calling Convention\n \n \n This convention, which is GNAT-specific is fully equivalent to the\n @code{Stdcall} calling convention described above.\n \n @node Introduction to Dynamic Link Libraries DLLs,Using DLLs with GNAT,Windows Calling Conventions,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information id19}@anchor{1f0}@anchor{gnat_ugn/platform_specific_information introduction-to-dynamic-link-libraries-dlls}@anchor{1f1}\n+@anchor{gnat_ugn/platform_specific_information id19}@anchor{1f1}@anchor{gnat_ugn/platform_specific_information introduction-to-dynamic-link-libraries-dlls}@anchor{1f2}\n @subsubsection Introduction to Dynamic Link Libraries (DLLs)\n \n \n@@ -24525,10 +24573,10 @@ As a side note, an interesting difference between Microsoft DLLs and\n Unix shared libraries, is the fact that on most Unix systems all public\n routines are exported by default in a Unix shared library, while under\n Windows it is possible (but not required) to list exported routines in\n-a definition file (see @ref{1f2,,The Definition File}).\n+a definition file (see @ref{1f3,,The Definition File}).\n \n @node Using DLLs with GNAT,Building DLLs with GNAT Project files,Introduction to Dynamic Link Libraries DLLs,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information id20}@anchor{1f3}@anchor{gnat_ugn/platform_specific_information using-dlls-with-gnat}@anchor{1e4}\n+@anchor{gnat_ugn/platform_specific_information id20}@anchor{1f4}@anchor{gnat_ugn/platform_specific_information using-dlls-with-gnat}@anchor{1e5}\n @subsubsection Using DLLs with GNAT\n \n \n@@ -24619,7 +24667,7 @@ example a fictitious DLL called @code{API.dll}.\n @end menu\n \n @node Creating an Ada Spec for the DLL Services,Creating an Import Library,,Using DLLs with GNAT\n-@anchor{gnat_ugn/platform_specific_information id21}@anchor{1f4}@anchor{gnat_ugn/platform_specific_information creating-an-ada-spec-for-the-dll-services}@anchor{1f5}\n+@anchor{gnat_ugn/platform_specific_information id21}@anchor{1f5}@anchor{gnat_ugn/platform_specific_information creating-an-ada-spec-for-the-dll-services}@anchor{1f6}\n @subsubsection Creating an Ada Spec for the DLL Services\n \n \n@@ -24659,7 +24707,7 @@ end API;\n @end quotation\n \n @node Creating an Import Library,,Creating an Ada Spec for the DLL Services,Using DLLs with GNAT\n-@anchor{gnat_ugn/platform_specific_information id22}@anchor{1f6}@anchor{gnat_ugn/platform_specific_information creating-an-import-library}@anchor{1f7}\n+@anchor{gnat_ugn/platform_specific_information id22}@anchor{1f7}@anchor{gnat_ugn/platform_specific_information creating-an-import-library}@anchor{1f8}\n @subsubsection Creating an Import Library\n \n \n@@ -24673,7 +24721,7 @@ as in this case it is possible to link directly against the\n DLL. Otherwise read on.\n \n @geindex Definition file\n-@anchor{gnat_ugn/platform_specific_information the-definition-file}@anchor{1f2}\n+@anchor{gnat_ugn/platform_specific_information the-definition-file}@anchor{1f3}\n @subsubheading The Definition File\n \n \n@@ -24721,17 +24769,17 @@ EXPORTS\n @end table\n \n Note that you must specify the correct suffix (@code{@@@emph{nn}})\n-(see @ref{1e6,,Windows Calling Conventions}) for a Stdcall\n+(see @ref{1e7,,Windows Calling Conventions}) for a Stdcall\n calling convention function in the exported symbols list.\n \n There can actually be other sections in a definition file, but these\n sections are not relevant to the discussion at hand.\n-@anchor{gnat_ugn/platform_specific_information create-def-file-automatically}@anchor{1f8}\n+@anchor{gnat_ugn/platform_specific_information create-def-file-automatically}@anchor{1f9}\n @subsubheading Creating a Definition File Automatically\n \n \n You can automatically create the definition file @code{API.def}\n-(see @ref{1f2,,The Definition File}) from a DLL.\n+(see @ref{1f3,,The Definition File}) from a DLL.\n For that use the @code{dlltool} program as follows:\n \n @quotation\n@@ -24741,7 +24789,7 @@ $ dlltool API.dll -z API.def --export-all-symbols\n @end example\n \n Note that if some routines in the DLL have the @code{Stdcall} convention\n-(@ref{1e6,,Windows Calling Conventions}) with stripped @code{@@@emph{nn}}\n+(@ref{1e7,,Windows Calling Conventions}) with stripped @code{@@@emph{nn}}\n suffix then you'll have to edit @code{api.def} to add it, and specify\n @code{-k} to @code{gnatdll} when creating the import library.\n \n@@ -24765,13 +24813,13 @@ tells you what symbol is expected. You just have to go back to the\n definition file and add the right suffix.\n @end itemize\n @end quotation\n-@anchor{gnat_ugn/platform_specific_information gnat-style-import-library}@anchor{1f9}\n+@anchor{gnat_ugn/platform_specific_information gnat-style-import-library}@anchor{1fa}\n @subsubheading GNAT-Style Import Library\n \n \n To create a static import library from @code{API.dll} with the GNAT tools\n you should create the .def file, then use @code{gnatdll} tool\n-(see @ref{1fa,,Using gnatdll}) as follows:\n+(see @ref{1fb,,Using gnatdll}) as follows:\n \n @quotation\n \n@@ -24787,15 +24835,15 @@ definition file name is @code{xyz.def}, the import library name will\n be @code{libxyz.a}. Note that in the previous example option\n @code{-e} could have been removed because the name of the definition\n file (before the @code{.def} suffix) is the same as the name of the\n-DLL (@ref{1fa,,Using gnatdll} for more information about @code{gnatdll}).\n+DLL (@ref{1fb,,Using gnatdll} for more information about @code{gnatdll}).\n @end quotation\n-@anchor{gnat_ugn/platform_specific_information msvs-style-import-library}@anchor{1fb}\n+@anchor{gnat_ugn/platform_specific_information msvs-style-import-library}@anchor{1fc}\n @subsubheading Microsoft-Style Import Library\n \n \n A Microsoft import library is needed only if you plan to make an\n Ada DLL available to applications developed with Microsoft\n-tools (@ref{1e3,,Mixed-Language Programming on Windows}).\n+tools (@ref{1e4,,Mixed-Language Programming on Windows}).\n \n To create a Microsoft-style import library for @code{API.dll} you\n should create the .def file, then build the actual import library using\n@@ -24819,7 +24867,7 @@ See the Microsoft documentation for further details about the usage of\n @end quotation\n \n @node Building DLLs with GNAT Project files,Building DLLs with GNAT,Using DLLs with GNAT,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information id23}@anchor{1fc}@anchor{gnat_ugn/platform_specific_information building-dlls-with-gnat-project-files}@anchor{1e5}\n+@anchor{gnat_ugn/platform_specific_information id23}@anchor{1fd}@anchor{gnat_ugn/platform_specific_information building-dlls-with-gnat-project-files}@anchor{1e6}\n @subsubsection Building DLLs with GNAT Project files\n \n \n@@ -24835,7 +24883,7 @@ when inside the @code{DllMain} routine which is used for auto-initialization\n of shared libraries, so it is not possible to have library level tasks in SALs.\n \n @node Building DLLs with GNAT,Building DLLs with gnatdll,Building DLLs with GNAT Project files,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information building-dlls-with-gnat}@anchor{1fd}@anchor{gnat_ugn/platform_specific_information id24}@anchor{1fe}\n+@anchor{gnat_ugn/platform_specific_information building-dlls-with-gnat}@anchor{1fe}@anchor{gnat_ugn/platform_specific_information id24}@anchor{1ff}\n @subsubsection Building DLLs with GNAT\n \n \n@@ -24866,7 +24914,7 @@ $ gcc -shared -shared-libgcc -o api.dll obj1.o obj2.o ...\n It is important to note that in this case all symbols found in the\n object files are automatically exported. It is possible to restrict\n the set of symbols to export by passing to @code{gcc} a definition\n-file (see @ref{1f2,,The Definition File}).\n+file (see @ref{1f3,,The Definition File}).\n For example:\n \n @example\n@@ -24904,16 +24952,16 @@ $ gnatmake main -Iapilib -bargs -shared -largs -Lapilib -lAPI\n @end quotation\n \n @node Building DLLs with gnatdll,Ada DLLs and Finalization,Building DLLs with GNAT,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information building-dlls-with-gnatdll}@anchor{1ff}@anchor{gnat_ugn/platform_specific_information id25}@anchor{200}\n+@anchor{gnat_ugn/platform_specific_information building-dlls-with-gnatdll}@anchor{200}@anchor{gnat_ugn/platform_specific_information id25}@anchor{201}\n @subsubsection Building DLLs with gnatdll\n \n \n @geindex DLLs\n @geindex building\n \n Note that it is preferred to use GNAT Project files\n-(@ref{1e5,,Building DLLs with GNAT Project files}) or the built-in GNAT\n-DLL support (@ref{1fd,,Building DLLs with GNAT}) or to build DLLs.\n+(@ref{1e6,,Building DLLs with GNAT Project files}) or the built-in GNAT\n+DLL support (@ref{1fe,,Building DLLs with GNAT}) or to build DLLs.\n \n This section explains how to build DLLs containing Ada code using\n @code{gnatdll}. These DLLs will be referred to as Ada DLLs in the\n@@ -24929,20 +24977,20 @@ non-Ada applications are as follows:\n You need to mark each Ada entity exported by the DLL with a @code{C} or\n @code{Stdcall} calling convention to avoid any Ada name mangling for the\n entities exported by the DLL\n-(see @ref{201,,Exporting Ada Entities}). You can\n+(see @ref{202,,Exporting Ada Entities}). You can\n skip this step if you plan to use the Ada DLL only from Ada applications.\n \n @item \n Your Ada code must export an initialization routine which calls the routine\n @code{adainit} generated by @code{gnatbind} to perform the elaboration of\n-the Ada code in the DLL (@ref{202,,Ada DLLs and Elaboration}). The initialization\n+the Ada code in the DLL (@ref{203,,Ada DLLs and Elaboration}). The initialization\n routine exported by the Ada DLL must be invoked by the clients of the DLL\n to initialize the DLL.\n \n @item \n When useful, the DLL should also export a finalization routine which calls\n routine @code{adafinal} generated by @code{gnatbind} to perform the\n-finalization of the Ada code in the DLL (@ref{203,,Ada DLLs and Finalization}).\n+finalization of the Ada code in the DLL (@ref{204,,Ada DLLs and Finalization}).\n The finalization routine exported by the Ada DLL must be invoked by the\n clients of the DLL when the DLL services are no further needed.\n \n@@ -24952,11 +25000,11 @@ of the programming languages to which you plan to make the DLL available.\n \n @item \n You must provide a definition file listing the exported entities\n-(@ref{1f2,,The Definition File}).\n+(@ref{1f3,,The Definition File}).\n \n @item \n Finally you must use @code{gnatdll} to produce the DLL and the import\n-library (@ref{1fa,,Using gnatdll}).\n+library (@ref{1fb,,Using gnatdll}).\n @end itemize\n \n Note that a relocatable DLL stripped using the @code{strip}\n@@ -24976,7 +25024,7 @@ chapter of the @emph{GPRbuild User's Guide}.\n @end menu\n \n @node Limitations When Using Ada DLLs from Ada,Exporting Ada Entities,,Building DLLs with gnatdll\n-@anchor{gnat_ugn/platform_specific_information limitations-when-using-ada-dlls-from-ada}@anchor{204}\n+@anchor{gnat_ugn/platform_specific_information limitations-when-using-ada-dlls-from-ada}@anchor{205}\n @subsubsection Limitations When Using Ada DLLs from Ada\n \n \n@@ -24997,7 +25045,7 @@ It is completely safe to exchange plain elementary, array or record types,\n Windows object handles, etc.\n \n @node Exporting Ada Entities,Ada DLLs and Elaboration,Limitations When Using Ada DLLs from Ada,Building DLLs with gnatdll\n-@anchor{gnat_ugn/platform_specific_information exporting-ada-entities}@anchor{201}@anchor{gnat_ugn/platform_specific_information id26}@anchor{205}\n+@anchor{gnat_ugn/platform_specific_information exporting-ada-entities}@anchor{202}@anchor{gnat_ugn/platform_specific_information id26}@anchor{206}\n @subsubsection Exporting Ada Entities\n \n \n@@ -25097,10 +25145,10 @@ end API;\n Note that if you do not export the Ada entities with a @code{C} or\n @code{Stdcall} convention you will have to provide the mangled Ada names\n in the definition file of the Ada DLL\n-(@ref{206,,Creating the Definition File}).\n+(@ref{207,,Creating the Definition File}).\n \n @node Ada DLLs and Elaboration,,Exporting Ada Entities,Building DLLs with gnatdll\n-@anchor{gnat_ugn/platform_specific_information ada-dlls-and-elaboration}@anchor{202}@anchor{gnat_ugn/platform_specific_information id27}@anchor{207}\n+@anchor{gnat_ugn/platform_specific_information ada-dlls-and-elaboration}@anchor{203}@anchor{gnat_ugn/platform_specific_information id27}@anchor{208}\n @subsubsection Ada DLLs and Elaboration\n \n \n@@ -25118,7 +25166,7 @@ the Ada elaboration routine @code{adainit} generated by the GNAT binder\n (@ref{b4,,Binding with Non-Ada Main Programs}). See the body of\n @code{Initialize_Api} for an example. Note that the GNAT binder is\n automatically invoked during the DLL build process by the @code{gnatdll}\n-tool (@ref{1fa,,Using gnatdll}).\n+tool (@ref{1fb,,Using gnatdll}).\n \n When a DLL is loaded, Windows systematically invokes a routine called\n @code{DllMain}. It would therefore be possible to call @code{adainit}\n@@ -25131,7 +25179,7 @@ time), which means that the GNAT run-time will deadlock waiting for the\n newly created task to complete its initialization.\n \n @node Ada DLLs and Finalization,Creating a Spec for Ada DLLs,Building DLLs with gnatdll,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information id28}@anchor{208}@anchor{gnat_ugn/platform_specific_information ada-dlls-and-finalization}@anchor{203}\n+@anchor{gnat_ugn/platform_specific_information id28}@anchor{209}@anchor{gnat_ugn/platform_specific_information ada-dlls-and-finalization}@anchor{204}\n @subsubsection Ada DLLs and Finalization\n \n \n@@ -25146,10 +25194,10 @@ routine @code{adafinal} generated by the GNAT binder\n See the body of @code{Finalize_Api} for an\n example. As already pointed out the GNAT binder is automatically invoked\n during the DLL build process by the @code{gnatdll} tool\n-(@ref{1fa,,Using gnatdll}).\n+(@ref{1fb,,Using gnatdll}).\n \n @node Creating a Spec for Ada DLLs,GNAT and Windows Resources,Ada DLLs and Finalization,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information id29}@anchor{209}@anchor{gnat_ugn/platform_specific_information creating-a-spec-for-ada-dlls}@anchor{20a}\n+@anchor{gnat_ugn/platform_specific_information id29}@anchor{20a}@anchor{gnat_ugn/platform_specific_information creating-a-spec-for-ada-dlls}@anchor{20b}\n @subsubsection Creating a Spec for Ada DLLs\n \n \n@@ -25207,7 +25255,7 @@ end API;\n @end menu\n \n @node Creating the Definition File,Using gnatdll,,Creating a Spec for Ada DLLs\n-@anchor{gnat_ugn/platform_specific_information creating-the-definition-file}@anchor{206}@anchor{gnat_ugn/platform_specific_information id30}@anchor{20b}\n+@anchor{gnat_ugn/platform_specific_information creating-the-definition-file}@anchor{207}@anchor{gnat_ugn/platform_specific_information id30}@anchor{20c}\n @subsubsection Creating the Definition File\n \n \n@@ -25243,7 +25291,7 @@ EXPORTS\n @end quotation\n \n @node Using gnatdll,,Creating the Definition File,Creating a Spec for Ada DLLs\n-@anchor{gnat_ugn/platform_specific_information using-gnatdll}@anchor{1fa}@anchor{gnat_ugn/platform_specific_information id31}@anchor{20c}\n+@anchor{gnat_ugn/platform_specific_information using-gnatdll}@anchor{1fb}@anchor{gnat_ugn/platform_specific_information id31}@anchor{20d}\n @subsubsection Using @code{gnatdll}\n \n \n@@ -25454,7 +25502,7 @@ asks @code{gnatlink} to generate the routines @code{DllMain} and\n is loaded into memory.\n \n @item \n-@code{gnatdll} uses @code{dlltool} (see @ref{20d,,Using dlltool}) to build the\n+@code{gnatdll} uses @code{dlltool} (see @ref{20e,,Using dlltool}) to build the\n export table (@code{api.exp}). The export table contains the relocation\n information in a form which can be used during the final link to ensure\n that the Windows loader is able to place the DLL anywhere in memory.\n@@ -25493,7 +25541,7 @@ $ gnatbind -n api\n $ gnatlink api api.exp -o api.dll -mdll\n @end example\n @end itemize\n-@anchor{gnat_ugn/platform_specific_information using-dlltool}@anchor{20d}\n+@anchor{gnat_ugn/platform_specific_information using-dlltool}@anchor{20e}\n @subsubheading Using @code{dlltool}\n \n \n@@ -25552,7 +25600,7 @@ DLL in the static import library generated by @code{dlltool} with switch\n @item @code{-k}\n \n Kill @code{@@@emph{nn}} from exported names\n-(@ref{1e6,,Windows Calling Conventions}\n+(@ref{1e7,,Windows Calling Conventions}\n for a discussion about @code{Stdcall}-style symbols.\n @end table\n \n@@ -25608,7 +25656,7 @@ Use @code{assembler-name} as the assembler. The default is @code{as}.\n @end table\n \n @node GNAT and Windows Resources,Using GNAT DLLs from Microsoft Visual Studio Applications,Creating a Spec for Ada DLLs,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information gnat-and-windows-resources}@anchor{20e}@anchor{gnat_ugn/platform_specific_information id32}@anchor{20f}\n+@anchor{gnat_ugn/platform_specific_information gnat-and-windows-resources}@anchor{20f}@anchor{gnat_ugn/platform_specific_information id32}@anchor{210}\n @subsubsection GNAT and Windows Resources\n \n \n@@ -25703,7 +25751,7 @@ the corresponding Microsoft documentation.\n @end menu\n \n @node Building Resources,Compiling Resources,,GNAT and Windows Resources\n-@anchor{gnat_ugn/platform_specific_information building-resources}@anchor{210}@anchor{gnat_ugn/platform_specific_information id33}@anchor{211}\n+@anchor{gnat_ugn/platform_specific_information building-resources}@anchor{211}@anchor{gnat_ugn/platform_specific_information id33}@anchor{212}\n @subsubsection Building Resources\n \n \n@@ -25723,7 +25771,7 @@ complete description of the resource script language can be found in the\n Microsoft documentation.\n \n @node Compiling Resources,Using Resources,Building Resources,GNAT and Windows Resources\n-@anchor{gnat_ugn/platform_specific_information compiling-resources}@anchor{212}@anchor{gnat_ugn/platform_specific_information id34}@anchor{213}\n+@anchor{gnat_ugn/platform_specific_information compiling-resources}@anchor{213}@anchor{gnat_ugn/platform_specific_information id34}@anchor{214}\n @subsubsection Compiling Resources\n \n \n@@ -25765,7 +25813,7 @@ $ windres -i myres.res -o myres.o\n @end quotation\n \n @node Using Resources,,Compiling Resources,GNAT and Windows Resources\n-@anchor{gnat_ugn/platform_specific_information using-resources}@anchor{214}@anchor{gnat_ugn/platform_specific_information id35}@anchor{215}\n+@anchor{gnat_ugn/platform_specific_information using-resources}@anchor{215}@anchor{gnat_ugn/platform_specific_information id35}@anchor{216}\n @subsubsection Using Resources\n \n \n@@ -25785,7 +25833,7 @@ $ gnatmake myprog -largs myres.o\n @end quotation\n \n @node Using GNAT DLLs from Microsoft Visual Studio Applications,Debugging a DLL,GNAT and Windows Resources,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information using-gnat-dll-from-msvs}@anchor{216}@anchor{gnat_ugn/platform_specific_information using-gnat-dlls-from-microsoft-visual-studio-applications}@anchor{217}\n+@anchor{gnat_ugn/platform_specific_information using-gnat-dll-from-msvs}@anchor{217}@anchor{gnat_ugn/platform_specific_information using-gnat-dlls-from-microsoft-visual-studio-applications}@anchor{218}\n @subsubsection Using GNAT DLLs from Microsoft Visual Studio Applications\n \n \n@@ -25819,7 +25867,7 @@ $ gprbuild -p mylib.gpr\n @item \n Produce a .def file for the symbols you need to interface with, either by\n hand or automatically with possibly some manual adjustments\n-(see @ref{1f8,,Creating Definition File Automatically}):\n+(see @ref{1f9,,Creating Definition File Automatically}):\n @end enumerate\n \n @quotation\n@@ -25836,7 +25884,7 @@ $ dlltool libmylib.dll -z libmylib.def --export-all-symbols\n Make sure that MSVS command-line tools are accessible on the path.\n \n @item \n-Create the Microsoft-style import library (see @ref{1fb,,MSVS-Style Import Library}):\n+Create the Microsoft-style import library (see @ref{1fc,,MSVS-Style Import Library}):\n @end enumerate\n \n @quotation\n@@ -25878,7 +25926,7 @@ or copy the DLL into into the directory containing the .exe.\n @end enumerate\n \n @node Debugging a DLL,Setting Stack Size from gnatlink,Using GNAT DLLs from Microsoft Visual Studio Applications,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information id36}@anchor{218}@anchor{gnat_ugn/platform_specific_information debugging-a-dll}@anchor{219}\n+@anchor{gnat_ugn/platform_specific_information id36}@anchor{219}@anchor{gnat_ugn/platform_specific_information debugging-a-dll}@anchor{21a}\n @subsubsection Debugging a DLL\n \n \n@@ -25916,7 +25964,7 @@ tools suite used to build the DLL.\n @end menu\n \n @node Program and DLL Both Built with GCC/GNAT,Program Built with Foreign Tools and DLL Built with GCC/GNAT,,Debugging a DLL\n-@anchor{gnat_ugn/platform_specific_information id37}@anchor{21a}@anchor{gnat_ugn/platform_specific_information program-and-dll-both-built-with-gcc-gnat}@anchor{21b}\n+@anchor{gnat_ugn/platform_specific_information id37}@anchor{21b}@anchor{gnat_ugn/platform_specific_information program-and-dll-both-built-with-gcc-gnat}@anchor{21c}\n @subsubsection Program and DLL Both Built with GCC/GNAT\n \n \n@@ -25926,7 +25974,7 @@ the process. Let's suppose here that the main procedure is named\n @code{ada_main} and that in the DLL there is an entry point named\n @code{ada_dll}.\n \n-The DLL (@ref{1f1,,Introduction to Dynamic Link Libraries (DLLs)}) and\n+The DLL (@ref{1f2,,Introduction to Dynamic Link Libraries (DLLs)}) and\n program must have been built with the debugging information (see GNAT -g\n switch). Here are the step-by-step instructions for debugging it:\n \n@@ -25966,7 +26014,7 @@ you can use the standard approach to debug the whole program\n (@ref{24,,Running and Debugging Ada Programs}).\n \n @node Program Built with Foreign Tools and DLL Built with GCC/GNAT,,Program and DLL Both Built with GCC/GNAT,Debugging a DLL\n-@anchor{gnat_ugn/platform_specific_information program-built-with-foreign-tools-and-dll-built-with-gcc-gnat}@anchor{21c}@anchor{gnat_ugn/platform_specific_information id38}@anchor{21d}\n+@anchor{gnat_ugn/platform_specific_information program-built-with-foreign-tools-and-dll-built-with-gcc-gnat}@anchor{21d}@anchor{gnat_ugn/platform_specific_information id38}@anchor{21e}\n @subsubsection Program Built with Foreign Tools and DLL Built with GCC/GNAT\n \n \n@@ -25983,7 +26031,7 @@ example some C code built with Microsoft Visual C) and that there is a\n DLL named @code{test.dll} containing an Ada entry point named\n @code{ada_dll}.\n \n-The DLL (see @ref{1f1,,Introduction to Dynamic Link Libraries (DLLs)}) must have\n+The DLL (see @ref{1f2,,Introduction to Dynamic Link Libraries (DLLs)}) must have\n been built with debugging information (see the GNAT @code{-g} option).\n \n @subsubheading Debugging the DLL Directly\n@@ -26122,7 +26170,7 @@ approach to debug a program as described in\n @ref{24,,Running and Debugging Ada Programs}.\n \n @node Setting Stack Size from gnatlink,Setting Heap Size from gnatlink,Debugging a DLL,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information setting-stack-size-from-gnatlink}@anchor{136}@anchor{gnat_ugn/platform_specific_information id39}@anchor{21e}\n+@anchor{gnat_ugn/platform_specific_information setting-stack-size-from-gnatlink}@anchor{136}@anchor{gnat_ugn/platform_specific_information id39}@anchor{21f}\n @subsubsection Setting Stack Size from @code{gnatlink}\n \n \n@@ -26165,7 +26213,7 @@ because the comma is a separator for this option.\n @end itemize\n \n @node Setting Heap Size from gnatlink,,Setting Stack Size from gnatlink,Mixed-Language Programming on Windows\n-@anchor{gnat_ugn/platform_specific_information setting-heap-size-from-gnatlink}@anchor{137}@anchor{gnat_ugn/platform_specific_information id40}@anchor{21f}\n+@anchor{gnat_ugn/platform_specific_information setting-heap-size-from-gnatlink}@anchor{137}@anchor{gnat_ugn/platform_specific_information id40}@anchor{220}\n @subsubsection Setting Heap Size from @code{gnatlink}\n \n \n@@ -26198,7 +26246,7 @@ because the comma is a separator for this option.\n @end itemize\n \n @node Windows Specific Add-Ons,,Mixed-Language Programming on Windows,Microsoft Windows Topics\n-@anchor{gnat_ugn/platform_specific_information windows-specific-add-ons}@anchor{220}@anchor{gnat_ugn/platform_specific_information win32-specific-addons}@anchor{221}\n+@anchor{gnat_ugn/platform_specific_information windows-specific-add-ons}@anchor{221}@anchor{gnat_ugn/platform_specific_information win32-specific-addons}@anchor{222}\n @subsection Windows Specific Add-Ons\n \n \n@@ -26211,7 +26259,7 @@ This section describes the Windows specific add-ons.\n @end menu\n \n @node Win32Ada,wPOSIX,,Windows Specific Add-Ons\n-@anchor{gnat_ugn/platform_specific_information win32ada}@anchor{222}@anchor{gnat_ugn/platform_specific_information id41}@anchor{223}\n+@anchor{gnat_ugn/platform_specific_information win32ada}@anchor{223}@anchor{gnat_ugn/platform_specific_information id41}@anchor{224}\n @subsubsection Win32Ada\n \n \n@@ -26242,7 +26290,7 @@ gprbuild p.gpr\n @end quotation\n \n @node wPOSIX,,Win32Ada,Windows Specific Add-Ons\n-@anchor{gnat_ugn/platform_specific_information id42}@anchor{224}@anchor{gnat_ugn/platform_specific_information wposix}@anchor{225}\n+@anchor{gnat_ugn/platform_specific_information id42}@anchor{225}@anchor{gnat_ugn/platform_specific_information wposix}@anchor{226}\n @subsubsection wPOSIX\n \n \n@@ -26275,7 +26323,7 @@ gprbuild p.gpr\n @end quotation\n \n @node Mac OS Topics,,Microsoft Windows Topics,Platform-Specific Information\n-@anchor{gnat_ugn/platform_specific_information mac-os-topics}@anchor{2d}@anchor{gnat_ugn/platform_specific_information id43}@anchor{226}\n+@anchor{gnat_ugn/platform_specific_information mac-os-topics}@anchor{2d}@anchor{gnat_ugn/platform_specific_information id43}@anchor{227}\n @section Mac OS Topics\n \n \n@@ -26290,7 +26338,7 @@ platform.\n @end menu\n \n @node Codesigning the Debugger,,,Mac OS Topics\n-@anchor{gnat_ugn/platform_specific_information codesigning-the-debugger}@anchor{227}\n+@anchor{gnat_ugn/platform_specific_information codesigning-the-debugger}@anchor{228}\n @subsection Codesigning the Debugger\n \n \n@@ -26371,7 +26419,7 @@ the location where you installed GNAT.  Also, be sure that users are\n in the Unix group @code{_developer}.\n \n @node Example of Binder Output File,Elaboration Order Handling in GNAT,Platform-Specific Information,Top\n-@anchor{gnat_ugn/example_of_binder_output example-of-binder-output-file}@anchor{e}@anchor{gnat_ugn/example_of_binder_output doc}@anchor{228}@anchor{gnat_ugn/example_of_binder_output id1}@anchor{229}\n+@anchor{gnat_ugn/example_of_binder_output example-of-binder-output-file}@anchor{e}@anchor{gnat_ugn/example_of_binder_output doc}@anchor{229}@anchor{gnat_ugn/example_of_binder_output id1}@anchor{22a}\n @chapter Example of Binder Output File\n \n \n@@ -27123,7 +27171,7 @@ elaboration code in your own application).\n @c -- Example: A |withing| unit has a |with| clause, it |withs| a |withed| unit\n \n @node Elaboration Order Handling in GNAT,Inline Assembler,Example of Binder Output File,Top\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-order-handling-in-gnat}@anchor{f}@anchor{gnat_ugn/elaboration_order_handling_in_gnat doc}@anchor{22a}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id1}@anchor{22b}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-order-handling-in-gnat}@anchor{f}@anchor{gnat_ugn/elaboration_order_handling_in_gnat doc}@anchor{22b}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id1}@anchor{22c}\n @chapter Elaboration Order Handling in GNAT\n \n \n@@ -27157,7 +27205,7 @@ GNAT, either automatically or with explicit programming features.\n @end menu\n \n @node Elaboration Code,Elaboration Order,,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-code}@anchor{22c}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id2}@anchor{22d}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-code}@anchor{22d}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id2}@anchor{22e}\n @section Elaboration Code\n \n \n@@ -27299,7 +27347,7 @@ elaborated.\n @end itemize\n \n @node Elaboration Order,Checking the Elaboration Order,Elaboration Code,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-order}@anchor{22e}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id3}@anchor{22f}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-order}@anchor{22f}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id3}@anchor{230}\n @section Elaboration Order\n \n \n@@ -27449,7 +27497,7 @@ avoids ABE problems should be chosen, however a compiler may not always find\n such an order due to complications with respect to control and data flow.\n \n @node Checking the Elaboration Order,Controlling the Elaboration Order in Ada,Elaboration Order,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat id4}@anchor{230}@anchor{gnat_ugn/elaboration_order_handling_in_gnat checking-the-elaboration-order}@anchor{231}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat id4}@anchor{231}@anchor{gnat_ugn/elaboration_order_handling_in_gnat checking-the-elaboration-order}@anchor{232}\n @section Checking the Elaboration Order\n \n \n@@ -27511,7 +27559,7 @@ order.\n @end itemize\n \n @node Controlling the Elaboration Order in Ada,Controlling the Elaboration Order in GNAT,Checking the Elaboration Order,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat controlling-the-elaboration-order-in-ada}@anchor{232}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id5}@anchor{233}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat controlling-the-elaboration-order-in-ada}@anchor{233}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id5}@anchor{234}\n @section Controlling the Elaboration Order in Ada\n \n \n@@ -27839,7 +27887,7 @@ is that the program continues to stay in the last state (one or more correct\n orders exist) even if maintenance changes the bodies of targets.\n \n @node Controlling the Elaboration Order in GNAT,Common Elaboration-model Traits,Controlling the Elaboration Order in Ada,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat id6}@anchor{234}@anchor{gnat_ugn/elaboration_order_handling_in_gnat controlling-the-elaboration-order-in-gnat}@anchor{235}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat id6}@anchor{235}@anchor{gnat_ugn/elaboration_order_handling_in_gnat controlling-the-elaboration-order-in-gnat}@anchor{236}\n @section Controlling the Elaboration Order in GNAT\n \n \n@@ -27915,7 +27963,7 @@ The dynamic, legacy, and static models can be relaxed using compiler switch\n may not diagnose certain elaboration issues or install run-time checks.\n \n @node Common Elaboration-model Traits,Dynamic Elaboration Model in GNAT,Controlling the Elaboration Order in GNAT,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat common-elaboration-model-traits}@anchor{236}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id7}@anchor{237}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat common-elaboration-model-traits}@anchor{237}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id7}@anchor{238}\n @section Common Elaboration-model Traits\n \n \n@@ -27984,7 +28032,7 @@ data and control flow. The warnings can be suppressed selectively with @code{pra\n Warnigns (Off)} or globally with compiler switch @code{-gnatwL}.\n \n @node Dynamic Elaboration Model in GNAT,Static Elaboration Model in GNAT,Common Elaboration-model Traits,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat dynamic-elaboration-model-in-gnat}@anchor{238}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id8}@anchor{239}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat dynamic-elaboration-model-in-gnat}@anchor{239}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id8}@anchor{23a}\n @section Dynamic Elaboration Model in GNAT\n \n \n@@ -28041,7 +28089,7 @@ is in effect.\n @end example\n \n @node Static Elaboration Model in GNAT,SPARK Elaboration Model in GNAT,Dynamic Elaboration Model in GNAT,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat static-elaboration-model-in-gnat}@anchor{23a}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id9}@anchor{23b}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat static-elaboration-model-in-gnat}@anchor{23b}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id9}@anchor{23c}\n @section Static Elaboration Model in GNAT\n \n \n@@ -28184,7 +28232,7 @@ elaborated prior to the body of @code{Static_Model}.\n @end itemize\n \n @node SPARK Elaboration Model in GNAT,Legacy Elaboration Model in GNAT,Static Elaboration Model in GNAT,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat id10}@anchor{23c}@anchor{gnat_ugn/elaboration_order_handling_in_gnat spark-elaboration-model-in-gnat}@anchor{23d}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat id10}@anchor{23d}@anchor{gnat_ugn/elaboration_order_handling_in_gnat spark-elaboration-model-in-gnat}@anchor{23e}\n @section SPARK Elaboration Model in GNAT\n \n \n@@ -28207,7 +28255,7 @@ external, and compiler switch @code{-gnatd.v} is in effect.\n @end example\n \n @node Legacy Elaboration Model in GNAT,Mixing Elaboration Models,SPARK Elaboration Model in GNAT,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat legacy-elaboration-model-in-gnat}@anchor{23e}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat legacy-elaboration-model-in-gnat}@anchor{23f}\n @section Legacy Elaboration Model in GNAT\n \n \n@@ -28218,7 +28266,7 @@ in terms of diagnostics and run-time checks. The legacy elaboration model is\n enabled with compiler switch @code{-gnatH}.\n \n @node Mixing Elaboration Models,Elaboration Circularities,Legacy Elaboration Model in GNAT,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat mixing-elaboration-models}@anchor{23f}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id11}@anchor{240}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat mixing-elaboration-models}@anchor{240}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id11}@anchor{241}\n @section Mixing Elaboration Models\n \n \n@@ -28262,7 +28310,7 @@ warning:   \"y.ads\" which has static elaboration checks\n The warnings can be suppressed by binder switch @code{-ws}.\n \n @node Elaboration Circularities,Resolving Elaboration Circularities,Mixing Elaboration Models,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat id12}@anchor{241}@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-circularities}@anchor{242}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat id12}@anchor{242}@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-circularities}@anchor{243}\n @section Elaboration Circularities\n \n \n@@ -28321,7 +28369,7 @@ they @emph{with}, must be elaborated prior to @code{Client}. However, @code{Serv\n @code{Client}, and this leads to a circularity.\n \n @node Resolving Elaboration Circularities,Resolving Task Issues,Elaboration Circularities,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat id13}@anchor{243}@anchor{gnat_ugn/elaboration_order_handling_in_gnat resolving-elaboration-circularities}@anchor{244}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat id13}@anchor{244}@anchor{gnat_ugn/elaboration_order_handling_in_gnat resolving-elaboration-circularities}@anchor{245}\n @section Resolving Elaboration Circularities\n \n \n@@ -28489,7 +28537,7 @@ run-time checks.\n @end itemize\n \n @node Resolving Task Issues,Elaboration-related Compiler Switches,Resolving Elaboration Circularities,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat id14}@anchor{245}@anchor{gnat_ugn/elaboration_order_handling_in_gnat resolving-task-issues}@anchor{246}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat id14}@anchor{246}@anchor{gnat_ugn/elaboration_order_handling_in_gnat resolving-task-issues}@anchor{247}\n @section Resolving Task Issues\n \n \n@@ -28785,7 +28833,7 @@ static model will verify that no entry calls take place at elaboration time.\n @end itemize\n \n @node Elaboration-related Compiler Switches,Summary of Procedures for Elaboration Control,Resolving Task Issues,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-related-compiler-switches}@anchor{247}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id15}@anchor{248}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat elaboration-related-compiler-switches}@anchor{248}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id15}@anchor{249}\n @section Elaboration-related Compiler Switches\n \n \n@@ -28962,7 +29010,7 @@ checks. The example above will still fail at run time with an ABE.\n @end table\n \n @node Summary of Procedures for Elaboration Control,Inspecting the Chosen Elaboration Order,Elaboration-related Compiler Switches,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat summary-of-procedures-for-elaboration-control}@anchor{249}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id16}@anchor{24a}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat summary-of-procedures-for-elaboration-control}@anchor{24a}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id16}@anchor{24b}\n @section Summary of Procedures for Elaboration Control\n \n \n@@ -28996,7 +29044,7 @@ indicate why a server unit must be elaborated prior to a client unit.\n \n @item \n If the warnings produced by the static model indicate that a task is\n-involved, consider the options in section @ref{245,,Resolving Task Issues}.\n+involved, consider the options in section @ref{246,,Resolving Task Issues}.\n \n @item \n If none of the steps outlined above resolve the circularity, use a more\n@@ -29027,7 +29075,7 @@ Use the relaxed legacy dynamic elaboration model, with compiler switches\n @end itemize\n \n @node Inspecting the Chosen Elaboration Order,,Summary of Procedures for Elaboration Control,Elaboration Order Handling in GNAT\n-@anchor{gnat_ugn/elaboration_order_handling_in_gnat inspecting-the-chosen-elaboration-order}@anchor{24b}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id17}@anchor{24c}\n+@anchor{gnat_ugn/elaboration_order_handling_in_gnat inspecting-the-chosen-elaboration-order}@anchor{24c}@anchor{gnat_ugn/elaboration_order_handling_in_gnat id17}@anchor{24d}\n @section Inspecting the Chosen Elaboration Order\n \n \n@@ -29164,7 +29212,7 @@ gdbstr (body)\n @end example\n \n @node Inline Assembler,GNU Free Documentation License,Elaboration Order Handling in GNAT,Top\n-@anchor{gnat_ugn/inline_assembler inline-assembler}@anchor{10}@anchor{gnat_ugn/inline_assembler doc}@anchor{24d}@anchor{gnat_ugn/inline_assembler id1}@anchor{24e}\n+@anchor{gnat_ugn/inline_assembler inline-assembler}@anchor{10}@anchor{gnat_ugn/inline_assembler doc}@anchor{24e}@anchor{gnat_ugn/inline_assembler id1}@anchor{24f}\n @chapter Inline Assembler\n \n \n@@ -29223,7 +29271,7 @@ and with assembly language programming.\n @end menu\n \n @node Basic Assembler Syntax,A Simple Example of Inline Assembler,,Inline Assembler\n-@anchor{gnat_ugn/inline_assembler id2}@anchor{24f}@anchor{gnat_ugn/inline_assembler basic-assembler-syntax}@anchor{250}\n+@anchor{gnat_ugn/inline_assembler id2}@anchor{250}@anchor{gnat_ugn/inline_assembler basic-assembler-syntax}@anchor{251}\n @section Basic Assembler Syntax\n \n \n@@ -29339,7 +29387,7 @@ Intel: Destination first; for example @code{mov eax, 4}@w{ }\n \n \n @node A Simple Example of Inline Assembler,Output Variables in Inline Assembler,Basic Assembler Syntax,Inline Assembler\n-@anchor{gnat_ugn/inline_assembler a-simple-example-of-inline-assembler}@anchor{251}@anchor{gnat_ugn/inline_assembler id3}@anchor{252}\n+@anchor{gnat_ugn/inline_assembler a-simple-example-of-inline-assembler}@anchor{252}@anchor{gnat_ugn/inline_assembler id3}@anchor{253}\n @section A Simple Example of Inline Assembler\n \n \n@@ -29488,7 +29536,7 @@ If there are no errors, @code{as} will generate an object file\n @code{nothing.out}.\n \n @node Output Variables in Inline Assembler,Input Variables in Inline Assembler,A Simple Example of Inline Assembler,Inline Assembler\n-@anchor{gnat_ugn/inline_assembler id4}@anchor{253}@anchor{gnat_ugn/inline_assembler output-variables-in-inline-assembler}@anchor{254}\n+@anchor{gnat_ugn/inline_assembler id4}@anchor{254}@anchor{gnat_ugn/inline_assembler output-variables-in-inline-assembler}@anchor{255}\n @section Output Variables in Inline Assembler\n \n \n@@ -29855,7 +29903,7 @@ end Get_Flags_3;\n @end quotation\n \n @node Input Variables in Inline Assembler,Inlining Inline Assembler Code,Output Variables in Inline Assembler,Inline Assembler\n-@anchor{gnat_ugn/inline_assembler id5}@anchor{255}@anchor{gnat_ugn/inline_assembler input-variables-in-inline-assembler}@anchor{256}\n+@anchor{gnat_ugn/inline_assembler id5}@anchor{256}@anchor{gnat_ugn/inline_assembler input-variables-in-inline-assembler}@anchor{257}\n @section Input Variables in Inline Assembler\n \n \n@@ -29944,7 +29992,7 @@ _increment__incr.1:\n @end quotation\n \n @node Inlining Inline Assembler Code,Other Asm Functionality,Input Variables in Inline Assembler,Inline Assembler\n-@anchor{gnat_ugn/inline_assembler id6}@anchor{257}@anchor{gnat_ugn/inline_assembler inlining-inline-assembler-code}@anchor{258}\n+@anchor{gnat_ugn/inline_assembler id6}@anchor{258}@anchor{gnat_ugn/inline_assembler inlining-inline-assembler-code}@anchor{259}\n @section Inlining Inline Assembler Code\n \n \n@@ -30015,7 +30063,7 @@ movl %esi,%eax\n thus saving the overhead of stack frame setup and an out-of-line call.\n \n @node Other Asm Functionality,,Inlining Inline Assembler Code,Inline Assembler\n-@anchor{gnat_ugn/inline_assembler other-asm-functionality}@anchor{259}@anchor{gnat_ugn/inline_assembler id7}@anchor{25a}\n+@anchor{gnat_ugn/inline_assembler other-asm-functionality}@anchor{25a}@anchor{gnat_ugn/inline_assembler id7}@anchor{25b}\n @section Other @code{Asm} Functionality\n \n \n@@ -30030,7 +30078,7 @@ and @code{Volatile}, which inhibits unwanted optimizations.\n @end menu\n \n @node The Clobber Parameter,The Volatile Parameter,,Other Asm Functionality\n-@anchor{gnat_ugn/inline_assembler the-clobber-parameter}@anchor{25b}@anchor{gnat_ugn/inline_assembler id8}@anchor{25c}\n+@anchor{gnat_ugn/inline_assembler the-clobber-parameter}@anchor{25c}@anchor{gnat_ugn/inline_assembler id8}@anchor{25d}\n @subsection The @code{Clobber} Parameter\n \n \n@@ -30094,7 +30142,7 @@ Use 'register' name @code{memory} if you changed a memory location\n @end itemize\n \n @node The Volatile Parameter,,The Clobber Parameter,Other Asm Functionality\n-@anchor{gnat_ugn/inline_assembler the-volatile-parameter}@anchor{25d}@anchor{gnat_ugn/inline_assembler id9}@anchor{25e}\n+@anchor{gnat_ugn/inline_assembler the-volatile-parameter}@anchor{25e}@anchor{gnat_ugn/inline_assembler id9}@anchor{25f}\n @subsection The @code{Volatile} Parameter\n \n \n@@ -30130,7 +30178,7 @@ to @code{True} only if the compiler's optimizations have created\n problems.\n \n @node GNU Free Documentation License,Index,Inline Assembler,Top\n-@anchor{share/gnu_free_documentation_license gnu-fdl}@anchor{1}@anchor{share/gnu_free_documentation_license doc}@anchor{25f}@anchor{share/gnu_free_documentation_license gnu-free-documentation-license}@anchor{260}\n+@anchor{share/gnu_free_documentation_license gnu-fdl}@anchor{1}@anchor{share/gnu_free_documentation_license doc}@anchor{260}@anchor{share/gnu_free_documentation_license gnu-free-documentation-license}@anchor{261}\n @chapter GNU Free Documentation License\n \n "}, {"sha": "c44e134165c1bb9237632f60c9e4f299d1937866", "filename": "gcc/ada/gsocket.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fgsocket.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fgsocket.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgsocket.h?ref=b7d5159ec9fcc229e47392dc0dfec191d361b398", "patch": "@@ -82,6 +82,7 @@\n #ifdef __MINGW32__\n #include <winsock2.h>\n #include <ws2tcpip.h>\n+#include <versionhelpers.h>\n \n #undef  EACCES\n #define EACCES          WSAEACCES"}, {"sha": "ef6071bf8820adfaf6eca62bfb6fbf6279b684c7", "filename": "gcc/ada/libgnat/g-socket.adb", "status": "modified", "additions": 17, "deletions": 9, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Flibgnat%2Fg-socket.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Flibgnat%2Fg-socket.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fg-socket.adb?ref=b7d5159ec9fcc229e47392dc0dfec191d361b398", "patch": "@@ -2643,21 +2643,29 @@ package body GNAT.Sockets is\n          =>\n             if Is_Windows then\n \n-               --  On Windows, the timeout is a DWORD in milliseconds, and\n-               --  the actual timeout is 500 ms + the given value (unless it\n-               --  is 0).\n+               --  On Windows, the timeout is a DWORD in milliseconds\n \n-               U4 := C.unsigned (Option.Timeout / 0.001);\n+               Len := U4'Size / 8;\n+               Add := U4'Address;\n \n-               if U4 > 500 then\n-                  U4 := U4 - 500;\n+               U4 := C.unsigned (Option.Timeout / 0.001);\n \n-               elsif U4 > 0 then\n+               if Option.Timeout > 0.0 and then U4 = 0 then\n+                  --  Avoid round to zero. Zero timeout mean unlimited.\n                   U4 := 1;\n                end if;\n \n-               Len := U4'Size / 8;\n-               Add := U4'Address;\n+               --  Old windows versions actual timeout is 500 ms + the given\n+               --  value (unless it is 0).\n+\n+               if Minus_500ms_Windows_Timeout /= 0 then\n+                  if U4 > 500 then\n+                     U4 := U4 - 500;\n+\n+                  elsif U4 > 0 then\n+                     U4 := 1;\n+                  end if;\n+               end if;\n \n             else\n                VT  := To_Timeval (Option.Timeout);"}, {"sha": "c62161d78570c9b5b30d2da6a63689ff6b6e9624", "filename": "gcc/ada/libgnat/g-sothco.ads", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Flibgnat%2Fg-sothco.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Flibgnat%2Fg-sothco.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fg-sothco.ads?ref=b7d5159ec9fcc229e47392dc0dfec191d361b398", "patch": "@@ -438,6 +438,11 @@ package GNAT.Sockets.Thin_Common is\n    renames Short_To_Network;\n    --  Symmetric operation\n \n+   function Minus_500ms_Windows_Timeout return C.int;\n+   --  Microsoft Windows desktop older then 8.0 and Microsoft Windows Server\n+   --  older than 2019 need timeout correction for 500 milliseconds. This\n+   --  routine returns 1 for such versions.\n+\n private\n    pragma Import (C, Get_Socket_From_Set, \"__gnat_get_socket_from_set\");\n    pragma Import (C, Is_Socket_In_Set, \"__gnat_is_socket_in_set\");\n@@ -470,4 +475,6 @@ private\n    pragma Import (C, Hostent_H_Length,   \"__gnat_hostent_h_length\");\n    pragma Import (C, Hostent_H_Addr,     \"__gnat_hostent_h_addr\");\n \n+   pragma Import (C, Minus_500ms_Windows_Timeout, \"__gnat_minus_500ms\");\n+\n end GNAT.Sockets.Thin_Common;"}, {"sha": "8fc8415ddc195ea419ca9b01a6aad4392fd0b8ad", "filename": "gcc/ada/socket.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fsocket.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b7d5159ec9fcc229e47392dc0dfec191d361b398/gcc%2Fada%2Fsocket.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsocket.c?ref=b7d5159ec9fcc229e47392dc0dfec191d361b398", "patch": "@@ -803,4 +803,15 @@ const char * __gnat_gai_strerror(int errcode) {\n \n #endif\n \n+int __gnat_minus_500ms() {\n+#if defined (_WIN32)\n+  // Windows Server 2019 and Windows 8.0 do not need 500 millisecond socket\n+  // timeout correction.\n+  return !(IsWindows8OrGreater() && !IsWindowsServer()\n+           || IsWindowsVersionOrGreater(10, 0, 17763));\n+#else\n+   return 0;\n+#endif\n+}\n+\n #endif /* defined(HAVE_SOCKETS) */"}]}