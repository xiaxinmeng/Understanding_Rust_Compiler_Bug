{"sha": "1651cc96a4bbe8c470fe913e4aa5538dd12631fa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTY1MWNjOTZhNGJiZThjNDcwZmU5MTNlNGFhNTUzOGRkMTI2MzFmYQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2002-05-01T20:07:36Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2002-05-01T20:07:36Z"}, "message": "cppinit.c (cpp_handle_option): Don't set no_output here...\n\n\t* cppinit.c (cpp_handle_option) [-dM]: Don't set no_output here...\n\t(cpp_post_options): ...but here.  Disable -dD, -dN and -dI when\n\t-M -or -MM is in effect.\n\nFrom-SVN: r53013", "tree": {"sha": "0af5394fa69c6cca7279895bd44508f64bc4cb41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0af5394fa69c6cca7279895bd44508f64bc4cb41"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1651cc96a4bbe8c470fe913e4aa5538dd12631fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1651cc96a4bbe8c470fe913e4aa5538dd12631fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1651cc96a4bbe8c470fe913e4aa5538dd12631fa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1651cc96a4bbe8c470fe913e4aa5538dd12631fa/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8998d5bf4066a74600aa0abd1f8a6275d29b3b64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8998d5bf4066a74600aa0abd1f8a6275d29b3b64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8998d5bf4066a74600aa0abd1f8a6275d29b3b64"}], "stats": {"total": 22, "additions": 21, "deletions": 1}, "files": [{"sha": "0a2d1c5361daf93a3c5d208137ac8414561a1d7a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1651cc96a4bbe8c470fe913e4aa5538dd12631fa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1651cc96a4bbe8c470fe913e4aa5538dd12631fa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1651cc96a4bbe8c470fe913e4aa5538dd12631fa", "patch": "@@ -1,3 +1,9 @@\n+2002-05-01  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* cppinit.c (cpp_handle_option) [-dM]: Don't set no_output here...\n+\t(cpp_post_options): ...but here.  Disable -dD, -dN and -dI when\n+\t-M -or -MM is in effect.\n+\n 2002-05-01  Zack Weinberg  <zack@codesourcery.com>\n \n \t* config.gcc: Correct test of --enable-obsolete.  Obsolete all"}, {"sha": "cee75713447a07a84fdb71bc010bccb955e6dbe6", "filename": "gcc/cppinit.c", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1651cc96a4bbe8c470fe913e4aa5538dd12631fa/gcc%2Fcppinit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1651cc96a4bbe8c470fe913e4aa5538dd12631fa/gcc%2Fcppinit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppinit.c?ref=1651cc96a4bbe8c470fe913e4aa5538dd12631fa", "patch": "@@ -1549,7 +1549,6 @@ cpp_handle_option (pfile, argc, argv, ignore)\n  \t\t{\n  \t\tcase 'M':\n \t\t  CPP_OPTION (pfile, dump_macros) = dump_only;\n-\t\t  CPP_OPTION (pfile, no_output) = 1;\n \t\t  break;\n \t\tcase 'N':\n \t\t  CPP_OPTION (pfile, dump_macros) = dump_names;\n@@ -1820,6 +1819,21 @@ cpp_post_options (pfile)\n   if (CPP_OPTION (pfile, preprocessed))\n     pfile->state.prevent_expansion = 1;\n \n+  /* -dM makes no normal output.  This is set here so that -dM -dD\n+     works as expected.  */\n+  if (CPP_OPTION (pfile, dump_macros) == dump_only)\n+    CPP_OPTION (pfile, no_output) = 1;\n+\n+  /* Disable -dD, -dN and -dI if we should make no normal output\n+     (such as with -M). Allow -M -dM since some software relies on\n+     this.  */\n+  if (CPP_OPTION (pfile, no_output))\n+    {\n+      if (CPP_OPTION (pfile, dump_macros) != dump_only)\n+\tCPP_OPTION (pfile, dump_macros) = dump_none;\n+      CPP_OPTION (pfile, dump_includes) = 0;\n+    }\n+\n   /* We need to do this after option processing and before\n      cpp_start_read, as cppmain.c relies on the options->no_output to\n      set its callbacks correctly before calling cpp_start_read.  */"}]}