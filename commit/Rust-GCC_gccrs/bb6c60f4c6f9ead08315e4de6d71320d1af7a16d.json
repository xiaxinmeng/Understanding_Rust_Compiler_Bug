{"sha": "bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmI2YzYwZjRjNmY5ZWFkMDgzMTVlNGRlNmQ3MTMyMGQxYWY3YTE2ZA==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-01-06T10:33:32Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-01-06T10:33:32Z"}, "message": "[multiple changes]\n\n2015-01-06  Vincent Celier  <celier@adacore.com>\n\n\t* prj-conf.adb (Check_Target): Improve error message when\n\tthere are mismatched targets between the on in the configuration\n\tproject file and the specified one, either in the main project\n\tfile or in the --target= switch.\n\n2015-01-06  Pascal Obry  <obry@adacore.com>\n\n\t* prj-attr.adb, projects.texi, snames.ads-tmpl: Add Mode and\n\tInstall_Name attribute definitions.\n\n2015-01-06  Ed Schonberg  <schonberg@adacore.com>\n\n\t* freeze.adb (Wrap_Imported_Subprogram): Indicate that the\n\tgenerated Import pragma for the internal imported procedure does\n\tnot come from an aspect, so that Is_Imported can be properly\n\tset for it.\n\n2015-01-06  Gary Dismukes  <dismukes@adacore.com>\n\n\t* sem_ch12.adb (Might_Inline_Subp): Record whether\n\tany subprograms in the generic package are marked with\n\tpragma Inline_Always (setting flag Has_Inline_Always).\n\t(Analyze_Package_Instantiation): Add test of Has_Inline_Always\n\talongside existing test of Front_End_Inlining as alternative\n\tconditions for setting Inline_Now. Also add test of\n\tHas_Inline_Always along with Front_End_Inlining test as an\n\talternative condition for setting Needs_Body to False.\n\n2015-01-06  Tristan Gingold  <gingold@adacore.com>\n\n\t* i-cpoint.adb (Copy_Array): Handle overlap.\n\nFrom-SVN: r219253", "tree": {"sha": "ae626a6e4bdccd3b3367b5ee5a7bb567b184f726", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae626a6e4bdccd3b3367b5ee5a7bb567b184f726"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/comments", "author": null, "committer": null, "parents": [{"sha": "3dfe4883e7b0dec116a927968f8fe60500f03c35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dfe4883e7b0dec116a927968f8fe60500f03c35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3dfe4883e7b0dec116a927968f8fe60500f03c35"}], "stats": {"total": 124, "additions": 104, "deletions": 20}, "files": [{"sha": "861d0c87f45a878733055c8634ccc1abb4f39eb0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -1,3 +1,37 @@\n+2015-01-06  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-conf.adb (Check_Target): Improve error message when\n+\tthere are mismatched targets between the on in the configuration\n+\tproject file and the specified one, either in the main project\n+\tfile or in the --target= switch.\n+\n+2015-01-06  Pascal Obry  <obry@adacore.com>\n+\n+\t* prj-attr.adb, projects.texi, snames.ads-tmpl: Add Mode and\n+\tInstall_Name attribute definitions.\n+\n+2015-01-06  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* freeze.adb (Wrap_Imported_Subprogram): Indicate that the\n+\tgenerated Import pragma for the internal imported procedure does\n+\tnot come from an aspect, so that Is_Imported can be properly\n+\tset for it.\n+\n+2015-01-06  Gary Dismukes  <dismukes@adacore.com>\n+\n+\t* sem_ch12.adb (Might_Inline_Subp): Record whether\n+\tany subprograms in the generic package are marked with\n+\tpragma Inline_Always (setting flag Has_Inline_Always).\n+\t(Analyze_Package_Instantiation): Add test of Has_Inline_Always\n+\talongside existing test of Front_End_Inlining as alternative\n+\tconditions for setting Inline_Now. Also add test of\n+\tHas_Inline_Always along with Front_End_Inlining test as an\n+\talternative condition for setting Needs_Body to False.\n+\n+2015-01-06  Tristan Gingold  <gingold@adacore.com>\n+\n+\t* i-cpoint.adb (Copy_Array): Handle overlap.\n+\n 2015-01-06  Pascal Obry  <obry@adacore.com>\n \n \t* bindgen.adb: Minor style fix."}, {"sha": "a2fcddc645a7ff54d188f54a3d2f011fb5c86ba1", "filename": "gcc/ada/freeze.adb", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Ffreeze.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Ffreeze.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ffreeze.adb?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -4200,9 +4200,11 @@ package body Freeze is\n             --  generates the right visibility, and that is exactly what the\n             --  calls to Copy_Separate_Tree give us.\n \n-            --  Acquire copy of Inline pragma\n+            --  Acquire copy of Inline pragma, and indicate that it does not\n+            --  come from an aspect, as it applies to an internal entity.\n \n             Iprag := Copy_Separate_Tree (Import_Pragma (E));\n+            Set_From_Aspect_Specification (Iprag, False);\n \n             --  Fix up spec to be not imported any more\n "}, {"sha": "0f17bb25b38ed28412dd56eb1323ad3c38c5aa6e", "filename": "gcc/ada/i-cpoint.adb", "status": "modified", "additions": 20, "deletions": 5, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fi-cpoint.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fi-cpoint.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fi-cpoint.adb?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2011, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2014, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -102,19 +102,34 @@ package body Interfaces.C.Pointers is\n       Target  : Pointer;\n       Length  : ptrdiff_t)\n    is\n-      T : Pointer := Target;\n-      S : Pointer := Source;\n+      T : Pointer;\n+      S : Pointer;\n \n    begin\n-      if S = null or else T = null then\n+      if Source = null or else Target = null then\n          raise Dereference_Error;\n \n-      else\n+      elsif To_Addr (Target) <= To_Addr (Source) then\n+         --  Forward copy\n+         T := Target;\n+         S := Source;\n+\n          for J in 1 .. Length loop\n             T.all := S.all;\n             Increment (T);\n             Increment (S);\n          end loop;\n+\n+      else\n+         --  Backward copy\n+         T := Target + Length;\n+         S := Source + Length;\n+\n+         for J in 1 .. Length loop\n+            Decrement (T);\n+            Decrement (S);\n+            T.all := S.all;\n+         end loop;\n       end if;\n    end Copy_Array;\n "}, {"sha": "7bc5b23c882ff30520133200db7d54192046ae47", "filename": "gcc/ada/prj-attr.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fprj-attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fprj-attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-attr.adb?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -369,6 +369,8 @@ package body Prj.Attr is\n    \"SVproject_subdir#\" &\n    \"SVactive#\" &\n    \"LAartifacts#\" &\n+   \"SVmode#\" &\n+   \"SVinstall_name#\" &\n \n    --  package Remote\n "}, {"sha": "a3b92f8e23090fc1059f80e30bab7260a343613c", "filename": "gcc/ada/prj-conf.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fprj-conf.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fprj-conf.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.adb?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -633,8 +633,9 @@ package body Prj.Conf is\n          else\n             if Tgt_Name /= No_Name then\n                Raise_Invalid_Config\n-                 (\"invalid target name \"\"\"\n-                  & Get_Name_String (Tgt_Name) & \"\"\" in configuration\");\n+                 (\"mismatched targets: \"\"\"\n+                  & Get_Name_String (Tgt_Name) & \"\"\" in configuration, \"\"\"\n+                  & Target & \"\"\" specified\");\n             else\n                Raise_Invalid_Config\n                  (\"no target specified in configuration file\");"}, {"sha": "aa12e5bc1858f8c2be5b872b8a911615bd1045a7", "filename": "gcc/ada/projects.texi", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fprojects.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fprojects.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprojects.texi?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -1095,6 +1095,16 @@ installed. Default is @b{include}.\n \n Subdirectory of @b{Prefix} where the generated project file is to be\n installed. Default is @b{share/gpr}.\n+\n+@item @b{Mode}\n+\n+The installation mode, it is either @b{dev} (default) or @b{usage}.\n+See @b{gprbuild} user's guide for details.\n+\n+@item @b{Install_Name}\n+\n+Specify the name to use for recording the installation. The default is\n+the project name without the extension.\n @end table\n \n @c ---------------------------------------------\n@@ -4818,6 +4828,15 @@ Indicates that the project is to be installed or not. Case-insensitive value\n \"false\" means that the project is not to be installed, all other values mean\n that the project is to be installed.\n \n+@item @b{Mode}: single\n+\n+Value is the installation mode, it is either @b{dev} (default) or @b{usage}.\n+\n+@item @b{Install_Name}: single\n+\n+Specify the name to use for recording the installation. The default is\n+the project name without the extension.\n+\n @end itemize\n \n @node Package Linker Attributes"}, {"sha": "53b626eea126dc4bdc1d46bd42902a09f8d922e7", "filename": "gcc/ada/sem_ch12.adb", "status": "modified", "additions": 22, "deletions": 12, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fsem_ch12.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fsem_ch12.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch12.adb?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -3318,12 +3318,13 @@ package body Sem_Ch12 is\n       Is_Actual_Pack : constant Boolean :=\n                          Is_Internal (Defining_Entity (N));\n \n-      Env_Installed    : Boolean := False;\n-      Parent_Installed : Boolean := False;\n-      Renaming_List    : List_Id;\n-      Unit_Renaming    : Node_Id;\n-      Needs_Body       : Boolean;\n-      Inline_Now       : Boolean := False;\n+      Env_Installed     : Boolean := False;\n+      Parent_Installed  : Boolean := False;\n+      Renaming_List     : List_Id;\n+      Unit_Renaming     : Node_Id;\n+      Needs_Body        : Boolean;\n+      Inline_Now        : Boolean := False;\n+      Has_Inline_Always : Boolean := False;\n \n       Save_IPSM : constant Boolean := Ignore_Pragma_SPARK_Mode;\n       --  Save flag Ignore_Pragma_SPARK_Mode for restore on exit\n@@ -3371,6 +3372,12 @@ package body Sem_Ch12 is\n             E := First_Entity (Gen_Unit);\n             while Present (E) loop\n                if Is_Subprogram (E) and then Is_Inlined (E) then\n+                  --  Remember if there are any subprograms with Inline_Always\n+\n+                  if Has_Pragma_Inline_Always (E) then\n+                     Has_Inline_Always := True;\n+                  end if;\n+\n                   return True;\n                end if;\n \n@@ -3706,8 +3713,9 @@ package body Sem_Ch12 is\n                end loop;\n             end if;\n \n-            --  If front-end inlining is enabled, and this is a unit for which\n-            --  code will be generated, we instantiate the body at once.\n+            --  If front-end inlining is enabled or there are any subprograms\n+            --  marked with Inline_Always, and this is a unit for which code\n+            --  will be generated, we instantiate the body at once.\n \n             --  This is done if the instance is not the main unit, and if the\n             --  generic is not a child unit of another generic, to avoid scope\n@@ -3720,7 +3728,7 @@ package body Sem_Ch12 is\n               and then not Is_Actual_Pack\n             then\n                if not Back_End_Inlining\n-                 and then Front_End_Inlining\n+                 and then (Front_End_Inlining or else Has_Inline_Always)\n                  and then (Is_In_Main_Unit (N)\n                             or else In_Main_Context (Current_Scope))\n                  and then Nkind (Parent (N)) /= N_Compilation_Unit\n@@ -3775,10 +3783,12 @@ package body Sem_Ch12 is\n                           or else (Operating_Mode = Check_Semantics\n                                     and then (ASIS_Mode or GNATprove_Mode)));\n \n-            --  If front_end_inlining is enabled, do not instantiate body if\n-            --  within a generic context.\n+            --  If front-end inlining is enabled or there are any subprograms\n+            --  marked with Inline_Always, do not instantiate body when within\n+            --  a generic context.\n \n-            if (Front_End_Inlining and then not Expander_Active)\n+            if ((Front_End_Inlining or else Has_Inline_Always)\n+                  and then not Expander_Active)\n               or else Is_Generic_Unit (Cunit_Entity (Main_Unit))\n             then\n                Needs_Body := False;"}, {"sha": "3c86c9ceedd81a1239f33d4988023f735387161f", "filename": "gcc/ada/snames.ads-tmpl", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fsnames.ads-tmpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb6c60f4c6f9ead08315e4de6d71320d1af7a16d/gcc%2Fada%2Fsnames.ads-tmpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsnames.ads-tmpl?ref=bb6c60f4c6f9ead08315e4de6d71320d1af7a16d", "patch": "@@ -1286,6 +1286,7 @@ package Snames is\n    Name_Include_Path_File                  : constant Name_Id := N + $;\n    Name_Inherit_Source_Path                : constant Name_Id := N + $;\n    Name_Install                            : constant Name_Id := N + $;\n+   Name_Install_Name                       : constant Name_Id := N + $;\n    Name_Languages                          : constant Name_Id := N + $;\n    Name_Language_Kind                      : constant Name_Id := N + $;\n    Name_Leading_Library_Options            : constant Name_Id := N + $;"}]}