{"sha": "2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmYwNmNjYzY5ZTc1MTNmZjYwYWZkMDI5MGU0YTUwZjY5NjFlYjViZg==", "commit": {"author": {"name": "Francois-Xavier Coudert", "email": "coudert@clipper.ens.fr", "date": "2005-06-16T22:13:26Z"}, "committer": {"name": "Fran\u00e7ois-Xavier Coudert", "email": "fxcoudert@gcc.gnu.org", "date": "2005-06-16T22:13:26Z"}, "message": "re PR libfortran/16436 (gfortran TL edit descriptor failure - test f77-edit-t-in.f)\n\n\tPR libfortran/16436\n\t* io/transfer.c (read_sf): Correct updating of bytes_left field.\n\t(formatted_transfer): Correct updating of bytes_left field and\n\treformatting code (comments and whitespace).\n\t* io/unix.c (move_pos_offset): \"active\" field should not be\n\tchanged here. Whitespace corrections.\n\t* gfortran.dg/g77/f77-edit-t-in.f: Not XFAIL-ed any more.\n\nFrom-SVN: r101100", "tree": {"sha": "1d6aa9458c41d21dec52f9b06ae1138a18260d29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1d6aa9458c41d21dec52f9b06ae1138a18260d29"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/comments", "author": null, "committer": {"login": "fxcoudert", "id": 1980544, "node_id": "MDQ6VXNlcjE5ODA1NDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/1980544?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fxcoudert", "html_url": "https://github.com/fxcoudert", "followers_url": "https://api.github.com/users/fxcoudert/followers", "following_url": "https://api.github.com/users/fxcoudert/following{/other_user}", "gists_url": "https://api.github.com/users/fxcoudert/gists{/gist_id}", "starred_url": "https://api.github.com/users/fxcoudert/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxcoudert/subscriptions", "organizations_url": "https://api.github.com/users/fxcoudert/orgs", "repos_url": "https://api.github.com/users/fxcoudert/repos", "events_url": "https://api.github.com/users/fxcoudert/events{/privacy}", "received_events_url": "https://api.github.com/users/fxcoudert/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0518582d92b902d750f0e9d0aeaf0f4d40b5454c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0518582d92b902d750f0e9d0aeaf0f4d40b5454c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0518582d92b902d750f0e9d0aeaf0f4d40b5454c"}], "stats": {"total": 58, "additions": 33, "deletions": 25}, "files": [{"sha": "f03b329f56da6c67265a8aeacc3b690a43e1189d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "patch": "@@ -1,3 +1,8 @@\n+2005-06-17  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n+\n+\tPR libfortran/16436\n+\t* gfortran.dg/g77/f77-edit-t-in.f: Not XFAIL-ed any more.\n+\n 2005-06-16  Richard Guenther  <rguenth@gcc.gnu.org>\n \n \t* gcc.target/i386/attributes-error.c: New testcase."}, {"sha": "2314080d70862847d0566cf430f893b6dadb14b0", "filename": "gcc/testsuite/gfortran.dg/g77/f77-edit-t-in.f", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/gcc%2Ftestsuite%2Fgfortran.dg%2Fg77%2Ff77-edit-t-in.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/gcc%2Ftestsuite%2Fgfortran.dg%2Fg77%2Ff77-edit-t-in.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fg77%2Ff77-edit-t-in.f?ref=2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "patch": "@@ -3,7 +3,7 @@\n C\n C Origin: David Billinghurst <David.Billinghurst@riotinto.com>\n C\n-C { dg-do run {xfail *-*-*} } gfortran PR 16436\n+C { dg-do run }\n       integer i,j\n       real a,b,c,d,e\n       character*32 in"}, {"sha": "0467cb118cbce7684e1ef0cee8814544868e4fae", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "patch": "@@ -1,3 +1,12 @@\n+2005-06-17  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n+\n+\tPR libfortran/16436\n+\t* io/transfer.c (read_sf): Correct updating of bytes_left field.\n+\t(formatted_transfer): Correct updating of bytes_left field and\n+\treformatting code (comments and whitespace).\n+\t* io/unix.c (move_pos_offset): \"active\" field should not be\n+\tchanged here. Whitespace corrections.\n+\n 2005-06-15  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \tPR libfortran/21950"}, {"sha": "c81cb47eaa30a7ec7c876e178892cf411e279e72", "filename": "libgfortran/io/transfer.c", "status": "modified", "additions": 11, "deletions": 13, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/libgfortran%2Fio%2Ftransfer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/libgfortran%2Fio%2Ftransfer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Ftransfer.c?ref=2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "patch": "@@ -160,7 +160,6 @@ read_sf (int *length)\n       return base;\n     }\n \n-  current_unit->bytes_left = options.default_recl;\n   readlen = 1;\n   n = 0;\n \n@@ -214,6 +213,7 @@ read_sf (int *length)\n       sf_seen_eor = 0;\n     }\n   while (n < *length);\n+  current_unit->bytes_left -= *length;\n \n   if (ioparm.size != NULL)\n     *ioparm.size += *length;\n@@ -675,22 +675,19 @@ formatted_transfer (bt type, void *p, int len)\n \n         case FMT_TL:\n         case FMT_T:\n-           if (f->format==FMT_TL)\n-             {\n-                pos = f->u.n ;\n-                pos= current_unit->recl - current_unit->bytes_left - pos;\n-             }\n-           else // FMT==T\n+           if (f->format == FMT_TL)\n+             pos = current_unit->recl - current_unit->bytes_left - f->u.n;\n+           else /* FMT_T */\n              {\n-                consume_data_flag = 0 ;\n-                pos = f->u.n - 1;\n+               consume_data_flag = 0;\n+               pos = f->u.n - 1;\n              }\n \n            if (pos < 0 || pos >= current_unit->recl )\n-           {\n-             generate_error (ERROR_EOR, \"T Or TL edit position error\");\n-             break ;\n-            }\n+             {\n+               generate_error (ERROR_EOR, \"T Or TL edit position error\");\n+               break ;\n+             }\n             m = pos - (current_unit->recl - current_unit->bytes_left);\n \n             if (m == 0)\n@@ -707,6 +704,7 @@ formatted_transfer (bt type, void *p, int len)\n             if (m < 0)\n              {\n                move_pos_offset (current_unit->s,m);\n+\t       current_unit->bytes_left -= m;\n              }\n \n \t  break;"}, {"sha": "f4ee889cdda62687829ecac59277a4a49765c9ac", "filename": "libgfortran/io/unix.c", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/libgfortran%2Fio%2Funix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f06ccc69e7513ff60afd0290e4a50f6961eb5bf/libgfortran%2Fio%2Funix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Funix.c?ref=2f06ccc69e7513ff60afd0290e4a50f6961eb5bf", "patch": "@@ -154,26 +154,22 @@ move_pos_offset (stream* st, int pos_off)\n   unix_stream * str = (unix_stream*)st;\n   if (pos_off < 0)\n     {\n-      str->active  += pos_off;\n-      if (str->active < 0)\n-         str->active = 0;\n+      str->logical_offset += pos_off;\n \n-      str->logical_offset  += pos_off;\n-\n-      if (str->dirty_offset+str->ndirty > str->logical_offset)\n+      if (str->dirty_offset + str->ndirty > str->logical_offset)\n         {\n-          if (str->ndirty +  pos_off > 0)\n-            str->ndirty += pos_off ;\n+          if (str->ndirty + pos_off > 0)\n+            str->ndirty += pos_off;\n           else\n             {\n               str->dirty_offset +=  pos_off + pos_off;\n-              str->ndirty = 0 ;\n+              str->ndirty = 0;\n             }\n         }\n \n-    return pos_off ;\n+    return pos_off;\n   }\n-  return 0 ;\n+  return 0;\n }\n \n "}]}