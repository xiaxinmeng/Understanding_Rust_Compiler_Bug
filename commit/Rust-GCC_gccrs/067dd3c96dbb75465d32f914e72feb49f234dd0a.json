{"sha": "067dd3c96dbb75465d32f914e72feb49f234dd0a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDY3ZGQzYzk2ZGJiNzU0NjVkMzJmOTE0ZTcyZmViNDlmMjM0ZGQwYQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-03-03T16:43:42Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-03-03T16:43:42Z"}, "message": "re PR fortran/39354 (bad codegen for openmp atomics (Intel64 Fortran logical ops))\n\n\tPR fortran/39354\n\t* gimplify.c (goa_stabilize_expr): Handle tcc_comparison,\n\tTRUTH_ANDIF_EXPR and TRUTH_ORIF_EXPR.\n\n\t* gfortran.dg/gomp/pr39354.f90: New test.\n\nFrom-SVN: r144575", "tree": {"sha": "e0ac34092b00fab8436a07f2c7efb7e65119157c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e0ac34092b00fab8436a07f2c7efb7e65119157c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/067dd3c96dbb75465d32f914e72feb49f234dd0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/067dd3c96dbb75465d32f914e72feb49f234dd0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/067dd3c96dbb75465d32f914e72feb49f234dd0a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/067dd3c96dbb75465d32f914e72feb49f234dd0a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9bd9f73827bfddb9485bcc9a8a2c80d4ed5c9cd8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bd9f73827bfddb9485bcc9a8a2c80d4ed5c9cd8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9bd9f73827bfddb9485bcc9a8a2c80d4ed5c9cd8"}], "stats": {"total": 61, "additions": 61, "deletions": 0}, "files": [{"sha": "38698827a125cf548eafd5e1a2a63b36ba3b8c22", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=067dd3c96dbb75465d32f914e72feb49f234dd0a", "patch": "@@ -1,3 +1,9 @@\n+2009-03-03  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/39354\n+\t* gimplify.c (goa_stabilize_expr): Handle tcc_comparison,\n+\tTRUTH_ANDIF_EXPR and TRUTH_ORIF_EXPR.\n+\n 2009-03-03  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/39272"}, {"sha": "02d4923aa1e318a13a3724c7f2b3035189641237", "filename": "gcc/gimplify.c", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=067dd3c96dbb75465d32f914e72feb49f234dd0a", "patch": "@@ -6047,12 +6047,27 @@ goa_stabilize_expr (tree *expr_p, gimple_seq *pre_p, tree lhs_addr,\n   switch (TREE_CODE_CLASS (TREE_CODE (expr)))\n     {\n     case tcc_binary:\n+    case tcc_comparison:\n       saw_lhs |= goa_stabilize_expr (&TREE_OPERAND (expr, 1), pre_p, lhs_addr,\n \t\t\t\t     lhs_var);\n     case tcc_unary:\n       saw_lhs |= goa_stabilize_expr (&TREE_OPERAND (expr, 0), pre_p, lhs_addr,\n \t\t\t\t     lhs_var);\n       break;\n+    case tcc_expression:\n+      switch (TREE_CODE (expr))\n+\t{\n+\tcase TRUTH_ANDIF_EXPR:\n+\tcase TRUTH_ORIF_EXPR:\n+\t  saw_lhs |= goa_stabilize_expr (&TREE_OPERAND (expr, 1), pre_p,\n+\t\t\t\t\t lhs_addr, lhs_var);\n+\t  saw_lhs |= goa_stabilize_expr (&TREE_OPERAND (expr, 0), pre_p,\n+\t\t\t\t\t lhs_addr, lhs_var);\n+\t  break;\n+\tdefault:\n+\t  break;\n+\t}\n+      break;\n     default:\n       break;\n     }"}, {"sha": "a4bfe792d4f6e20e403fc6a283156e610d423448", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=067dd3c96dbb75465d32f914e72feb49f234dd0a", "patch": "@@ -1,5 +1,8 @@\n 2009-03-03  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR fortran/39354\n+\t* gfortran.dg/gomp/pr39354.f90: New test.\n+\n \tPR tree-optimization/39343\n \t* gcc.dg/pr39343.c: New test.\n "}, {"sha": "3b9c327849a3b5bc643e30405873ed1ee0d1a801", "filename": "gcc/testsuite/gfortran.dg/gomp/pr39354.f90", "status": "added", "additions": 37, "deletions": 0, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fpr39354.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/067dd3c96dbb75465d32f914e72feb49f234dd0a/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fpr39354.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgomp%2Fpr39354.f90?ref=067dd3c96dbb75465d32f914e72feb49f234dd0a", "patch": "@@ -0,0 +1,37 @@\n+! PR fortran/39354\n+! { dg-do compile }\n+! { dg-options \"-fopenmp\" }\n+      SUBROUTINE ltest(l1, l2, l3, l4, r1, r2, r3, r4)\n+      LOGICAL l1, l2, l3, l4, r1, r2, r3, r4\n+!$OMP ATOMIC\n+      l1 = l1 .and. r1\n+!$OMP ATOMIC\n+      l2 = l2 .or. r2\n+!$OMP ATOMIC\n+      l3 = l3 .eqv. r3\n+!$OMP ATOMIC\n+      l4 = l4 .neqv. r4\n+      END\n+      SUBROUTINE itest(l1, l2, l3, l4, l5, l6, l7, l8, l9, &\n+&                      r1, r2, r3, r4, r5, r6, r7, r8, r9)\n+      INTEGER l1, l2, l3, l4, l5, l6, l7, l8, l9, &\n+&             r1, r2, r3, r4, r5, r6, r7, r8, r9\n+!$OMP ATOMIC\n+      l1 = l1 + r1\n+!$OMP ATOMIC\n+      l2 = l2 - r2\n+!$OMP ATOMIC\n+      l3 = l3 * r3\n+!$OMP ATOMIC\n+      l4 = l4 / r4\n+!$OMP ATOMIC\n+      l5 = max (l5, r1, r5)\n+!$OMP ATOMIC\n+      l6 = min (r1, r6, l6)\n+!$OMP ATOMIC\n+      l7 = iand (l7, r7)\n+!$OMP ATOMIC\n+      l8 = ior (r8, l8)\n+!$OMP ATOMIC\n+      l9 = ieor (l9, r9)\n+      END"}]}