{"sha": "19b5595858162b8a77b84db93b21b39a48dc2d0e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTliNTU5NTg1ODE2MmI4YTc3Yjg0ZGI5M2IyMWIzOWE0OGRjMmQwZQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2018-10-24T08:47:59Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2018-10-24T08:47:59Z"}, "message": "Remove reduntant dumps and make tp_first_run dump more compact.\n\n2018-10-24  Martin Liska  <mliska@suse.cz>\n\n\t* cgraph.c (cgraph_node::dump):\n\tRemove reduntant dumps and make tp_first_run dump more compact.\n2018-10-24  Martin Liska  <mliska@suse.cz>\n\n\t* libgcov-profiler.c: Start from 1 in order to distinguish\n\tfunctions which were seen and these that were not.\n\nFrom-SVN: r265454", "tree": {"sha": "1ad536f2b3227e638ea02d3fafa0f66853a92a39", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1ad536f2b3227e638ea02d3fafa0f66853a92a39"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/19b5595858162b8a77b84db93b21b39a48dc2d0e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19b5595858162b8a77b84db93b21b39a48dc2d0e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19b5595858162b8a77b84db93b21b39a48dc2d0e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19b5595858162b8a77b84db93b21b39a48dc2d0e/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bf32992748c9849c38c089477d04b546e43ccdd1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf32992748c9849c38c089477d04b546e43ccdd1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf32992748c9849c38c089477d04b546e43ccdd1"}], "stats": {"total": 35, "additions": 21, "deletions": 14}, "files": [{"sha": "e5f43678eec3573722f4b6d6c7811e15ab886e38", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=19b5595858162b8a77b84db93b21b39a48dc2d0e", "patch": "@@ -1,3 +1,8 @@\n+2018-10-24  Martin Liska  <mliska@suse.cz>\n+\n+\t* cgraph.c (cgraph_node::dump):\n+\tRemove reduntant dumps and make tp_first_run dump more compact.\n+\n 2018-10-24  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/87665"}, {"sha": "b432f7e650076aa4f3e78cd13186ded311ed15e6", "filename": "gcc/cgraph.c", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Fcgraph.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Fcgraph.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraph.c?ref=19b5595858162b8a77b84db93b21b39a48dc2d0e", "patch": "@@ -2016,7 +2016,6 @@ cgraph_node::dump (FILE *f)\n   if (profile_id)\n     fprintf (f, \"  Profile id: %i\\n\",\n \t     profile_id);\n-  fprintf (f, \"  First run: %i\\n\", tp_first_run);\n   cgraph_function_version_info *vi = function_version ();\n   if (vi != NULL)\n     {\n@@ -2040,11 +2039,13 @@ cgraph_node::dump (FILE *f)\n   fprintf (f, \"  Function flags:\");\n   if (count.initialized_p ())\n     {\n-      fprintf (f, \" count: \");\n+      fprintf (f, \" count:\");\n       count.dump (f);\n     }\n+  if (tp_first_run > 0)\n+    fprintf (f, \" first_run:%i\", tp_first_run);\n   if (origin)\n-    fprintf (f, \" nested in: %s\", origin->asm_name ());\n+    fprintf (f, \" nested in:%s\", origin->asm_name ());\n   if (gimple_has_body_p (decl))\n     fprintf (f, \" body\");\n   if (process)\n@@ -2081,10 +2082,6 @@ cgraph_node::dump (FILE *f)\n     fprintf (f, \" unlikely_executed\");\n   if (frequency == NODE_FREQUENCY_EXECUTED_ONCE)\n     fprintf (f, \" executed_once\");\n-  if (only_called_at_startup)\n-    fprintf (f, \" only_called_at_startup\");\n-  if (only_called_at_exit)\n-    fprintf (f, \" only_called_at_exit\");\n   if (opt_for_fn (decl, optimize_size))\n     fprintf (f, \" optimize_size\");\n   if (parallelized_function)\n@@ -2096,7 +2093,7 @@ cgraph_node::dump (FILE *f)\n     {\n       fprintf (f, \"  Thunk\");\n       if (thunk.alias)\n-        fprintf (f, \"  of %s (asm: %s)\",\n+\tfprintf (f, \"  of %s (asm:%s)\",\n \t\t lang_hooks.decl_printable_name (thunk.alias, 2),\n \t\t IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (thunk.alias)));\n       fprintf (f, \" fixed offset %i virtual value %i indirect_offset %i \"\n@@ -2112,7 +2109,7 @@ cgraph_node::dump (FILE *f)\n       fprintf (f, \"  Alias of %s\",\n \t       lang_hooks.decl_printable_name (thunk.alias, 2));\n       if (DECL_ASSEMBLER_NAME_SET_P (thunk.alias))\n-        fprintf (f, \" (asm: %s)\",\n+\tfprintf (f, \" (asm:%s)\",\n \t\t IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (thunk.alias)));\n       fprintf (f, \"\\n\");\n     }"}, {"sha": "a622df23ce6057d91e7e017efa9c221ce9e7fe83", "filename": "gcc/testsuite/gcc.dg/tree-prof/time-profiler-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-1.c?ref=19b5595858162b8a77b84db93b21b39a48dc2d0e", "patch": "@@ -16,6 +16,6 @@ int main ()\n {\n   return foo ();\n }\n-/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 0\" 1 \"profile\"} } */\n /* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 1\" 1 \"profile\"} } */\n /* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 2\" 1 \"profile\"} } */\n+/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 3\" 1 \"profile\"} } */"}, {"sha": "497b585388e28a4e5c9eb4cacdcd276470fa1338", "filename": "gcc/testsuite/gcc.dg/tree-prof/time-profiler-2.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-2.c?ref=19b5595858162b8a77b84db93b21b39a48dc2d0e", "patch": "@@ -43,7 +43,7 @@ int main ()\n \n   return r;\n }\n-/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 0\" 2 \"profile\"} } */\n-/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 1\" 1 \"profile\"} } */\n+/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 1\" 2 \"profile\"} } */\n /* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 2\" 1 \"profile\"} } */\n /* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 3\" 1 \"profile\"} } */\n+/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 4\" 1 \"profile\"} } */"}, {"sha": "69daf2374830b941d38fb78b9d16a5d38c61657d", "filename": "gcc/testsuite/gcc.dg/tree-prof/time-profiler-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b5595858162b8a77b84db93b21b39a48dc2d0e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-prof%2Ftime-profiler-3.c?ref=19b5595858162b8a77b84db93b21b39a48dc2d0e", "patch": "@@ -17,6 +17,6 @@ int main ()\n {\n   return foo ();\n }\n-/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 0\" 1 \"profile\"} } */\n /* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 1\" 1 \"profile\"} } */\n /* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 2\" 1 \"profile\"} } */\n+/* { dg-final-use-not-autofdo { scan-ipa-dump-times \"Read tp_first_run: 3\" 1 \"profile\"} } */"}, {"sha": "73c6f59ae1e36c7e210fe185a7444c02c80f8652", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b5595858162b8a77b84db93b21b39a48dc2d0e/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b5595858162b8a77b84db93b21b39a48dc2d0e/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=19b5595858162b8a77b84db93b21b39a48dc2d0e", "patch": "@@ -1,3 +1,8 @@\n+2018-10-24  Martin Liska  <mliska@suse.cz>\n+\n+\t* libgcov-profiler.c: Start from 1 in order to distinguish\n+\tfunctions which were seen and these that were not.\n+\n 2018-10-18  Paul Koning  <ni1d@arrl.net>\n \n \t* udivmodsi4.c (__udivmodsi4): Rename to conform to coding"}, {"sha": "47c00ee4b4a105b6e8597960512cce5a3ad3dfae", "filename": "libgcc/libgcov-profiler.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b5595858162b8a77b84db93b21b39a48dc2d0e/libgcc%2Flibgcov-profiler.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b5595858162b8a77b84db93b21b39a48dc2d0e/libgcc%2Flibgcov-profiler.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov-profiler.c?ref=19b5595858162b8a77b84db93b21b39a48dc2d0e", "patch": "@@ -335,7 +335,7 @@ __gcov_indirect_call_profiler_v2 (gcov_type value, void* cur_func)\n #ifdef L_gcov_time_profiler\n \n /* Counter for first visit of each function.  */\n-gcov_type __gcov_time_profiler_counter ATTRIBUTE_HIDDEN;\n+gcov_type __gcov_time_profiler_counter ATTRIBUTE_HIDDEN = 1;\n \n #endif\n "}]}