{"sha": "b00a83047574eb6f8d1e670ad439609125873506", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjAwYTgzMDQ3NTc0ZWI2ZjhkMWU2NzBhZDQzOTYwOTEyNTg3MzUwNg==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-08-17T16:30:56Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2020-08-17T18:47:18Z"}, "message": "analyzer: fix ICE on NULL dereference [PR96644]\n\ngcc/analyzer/ChangeLog:\n\tPR analyzer/96644\n\t* region-model-manager.cc (get_region_for_unexpected_tree_code):\n\tHandle ctxt being NULL.\n\ngcc/testsuite/ChangeLog:\n\tPR analyzer/96644\n\t* gcc.dg/analyzer/pr96644.c: New test.", "tree": {"sha": "139ebeb1d4205f02ee52980028c35c6c5fa71ca9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/139ebeb1d4205f02ee52980028c35c6c5fa71ca9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b00a83047574eb6f8d1e670ad439609125873506", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b00a83047574eb6f8d1e670ad439609125873506", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b00a83047574eb6f8d1e670ad439609125873506", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b00a83047574eb6f8d1e670ad439609125873506/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "42c5ae5d7f0ad89b75d93c497fe44b6c66da7e76", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42c5ae5d7f0ad89b75d93c497fe44b6c66da7e76", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42c5ae5d7f0ad89b75d93c497fe44b6c66da7e76"}], "stats": {"total": 28, "additions": 26, "deletions": 2}, "files": [{"sha": "4faeaa52a639aee5662668d5292fad26fb6c13a2", "filename": "gcc/analyzer/region-model-manager.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b00a83047574eb6f8d1e670ad439609125873506/gcc%2Fanalyzer%2Fregion-model-manager.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b00a83047574eb6f8d1e670ad439609125873506/gcc%2Fanalyzer%2Fregion-model-manager.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fanalyzer%2Fregion-model-manager.cc?ref=b00a83047574eb6f8d1e670ad439609125873506", "patch": "@@ -927,11 +927,11 @@ get_region_for_unexpected_tree_code (region_model_context *ctxt,\n \t\t\t\t     tree t,\n \t\t\t\t     const dump_location_t &loc)\n {\n-  gcc_assert (ctxt);\n   tree type = TYPE_P (t) ? t : TREE_TYPE (t);\n   region *new_reg\n     = new unknown_region (alloc_region_id (), &m_root_region, type);\n-  ctxt->on_unexpected_tree_code (t, loc);\n+  if (ctxt)\n+    ctxt->on_unexpected_tree_code (t, loc);\n   return new_reg;\n }\n "}, {"sha": "3953c8d58c4005276e093d379ec69a6044eedc3b", "filename": "gcc/testsuite/gcc.dg/analyzer/pr96644.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b00a83047574eb6f8d1e670ad439609125873506/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr96644.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b00a83047574eb6f8d1e670ad439609125873506/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr96644.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr96644.c?ref=b00a83047574eb6f8d1e670ad439609125873506", "patch": "@@ -0,0 +1,24 @@\n+/* { dg-additional-options \"-O1\" } */\n+\n+int oh[1];\n+int *x3;\n+\n+int *\n+cm (char *m0)\n+{\n+  return oh;\n+}\n+\n+void\n+ek (void)\n+{\n+  for (;;)\n+    {\n+      char *b2 = 0;\n+\n+      if (*b2 != 0) /* { dg-warning \"dereference of NULL\" } */\n+\t++b2;\n+\n+      x3 = cm (b2);\n+    }\n+}"}]}