{"sha": "a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTllMDgzY2M0M2Q1ZTRjNTkxN2JmYjE2NjNmYjFhMzRiN2MyYjA2NQ==", "commit": {"author": {"name": "Trevor Saunders", "email": "tsaunders@mozilla.com", "date": "2015-02-10T02:23:11Z"}, "committer": {"name": "Trevor Saunders", "email": "tbsaunde@gcc.gnu.org", "date": "2015-02-10T02:23:11Z"}, "message": "Tolerate different definitions of symbols in lto\n\ngcc/\n\n\tPR lto/64076\n\t* ipa-visibility.c (update_visibility_by_resolution_info): Only\n\tassert when not in lto mode.\n\nFrom-SVN: r220561", "tree": {"sha": "1699b24128dd908579747103dec52a2df2dc1a50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1699b24128dd908579747103dec52a2df2dc1a50"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/comments", "author": null, "committer": null, "parents": [{"sha": "32721b2cb51a60291f8a3bbc0d26ffaa14ee63cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/32721b2cb51a60291f8a3bbc0d26ffaa14ee63cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/32721b2cb51a60291f8a3bbc0d26ffaa14ee63cf"}], "stats": {"total": 59, "additions": 54, "deletions": 5}, "files": [{"sha": "d98276b80b3bfb858b72dfbf2e7d7a8f73f9450e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "patch": "@@ -1,3 +1,9 @@\n+2015-02-09  Trevor Saunders  <tsaunders@mozilla.com>\n+\n+\tPR lto/64076\n+\t* ipa-visibility.c (update_visibility_by_resolution_info): Only\n+\tassert when not in lto mode.\n+\n 2015-02-09  Zhouyi Zhou   <yizhouzhou@ict.ac.cn>\n \n \t* ira-color.c (setup_left_conflict_sizes_p): Simplify"}, {"sha": "a8ac971b848068cd754f21876e130f960e3e349d", "filename": "gcc/ipa-visibility.c", "status": "modified", "additions": 13, "deletions": 5, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Fipa-visibility.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Fipa-visibility.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-visibility.c?ref=a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "patch": "@@ -424,11 +424,19 @@ update_visibility_by_resolution_info (symtab_node * node)\n   if (node->same_comdat_group)\n     for (symtab_node *next = node->same_comdat_group;\n \t next != node; next = next->same_comdat_group)\n-      gcc_assert (!next->externally_visible\n-\t\t  || define == (next->resolution == LDPR_PREVAILING_DEF_IRONLY\n-\t\t\t        || next->resolution == LDPR_PREVAILING_DEF\n-\t\t\t        || next->resolution == LDPR_UNDEF\n-\t\t\t        || next->resolution == LDPR_PREVAILING_DEF_IRONLY_EXP));\n+      {\n+\tif (!next->externally_visible)\n+\t  continue;\n+\n+\tbool same_def\n+\t  = define == (next->resolution == LDPR_PREVAILING_DEF_IRONLY\n+\t\t       || next->resolution == LDPR_PREVAILING_DEF\n+\t\t       || next->resolution == LDPR_UNDEF\n+\t\t       || next->resolution == LDPR_PREVAILING_DEF_IRONLY_EXP);\n+\tgcc_assert (in_lto_p || same_def);\n+\tif (!same_def)\n+\t  return;\n+      }\n \n   if (node->same_comdat_group)\n     for (symtab_node *next = node->same_comdat_group;"}, {"sha": "6afe37acc9c9b8eb9632d3c4e7b9c7c89a81cd68", "filename": "gcc/testsuite/g++.dg/lto/pr64076.H", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076.H", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076.H", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076.H?ref=a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "patch": "@@ -0,0 +1,20 @@\n+struct Base {\n+  virtual void f() = 0;\n+};\n+\n+struct X : public Base { };\n+struct Y : public Base { };\n+struct Z : public Base { };\n+struct T : public Base { };\n+\n+struct S : public X, public Y, public Z\n+#ifdef XXX\n+, public T\n+#endif\n+{\n+  void f()\n+#ifdef XXX\n+  { }\n+#endif\n+  ;\n+};"}, {"sha": "fb9b060e32350ab42e409f16e49589b3e3aea1b2", "filename": "gcc/testsuite/g++.dg/lto/pr64076_0.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076_0.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076_0.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076_0.C?ref=a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "patch": "@@ -0,0 +1,10 @@\n+// { dg-lto-do link }\n+\n+#define XXX\n+#include \"pr64076.H\"\n+\n+int main()\n+{\n+  S s;\n+  return 0;\n+}"}, {"sha": "4bd00817b1d372bfebd3943ce676e26e981e5ebd", "filename": "gcc/testsuite/g++.dg/lto/pr64076_1.C", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076_1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076_1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr64076_1.C?ref=a9e083cc43d5e4c5917bfb1663fb1a34b7c2b065", "patch": "@@ -0,0 +1,5 @@\n+// { dg-options -fno-lto }\n+\n+#include \"pr64076.H\"\n+\n+void S::f() { }"}]}