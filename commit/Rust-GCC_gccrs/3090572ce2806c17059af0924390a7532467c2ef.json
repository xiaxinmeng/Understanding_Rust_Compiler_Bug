{"sha": "3090572ce2806c17059af0924390a7532467c2ef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzA5MDU3MmNlMjgwNmMxNzA1OWFmMDkyNDM5MGE3NTMyNDY3YzJlZg==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2003-12-10T20:05:00Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2003-12-10T20:05:00Z"}, "message": "re PR libstdc++/13217 (basic_filebuf::underflow doesn't deal gracefully with read errors)\n\n2003-12-10  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/13217\n\t* include/bits/fstream.tcc (underflow): Deal gracefully with\n\tread errors: throw ios_base::failure.\n\nFrom-SVN: r74506", "tree": {"sha": "8005bb5caef94bc1b2e5f178ff8f8917dd7473dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8005bb5caef94bc1b2e5f178ff8f8917dd7473dd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3090572ce2806c17059af0924390a7532467c2ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3090572ce2806c17059af0924390a7532467c2ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3090572ce2806c17059af0924390a7532467c2ef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3090572ce2806c17059af0924390a7532467c2ef/comments", "author": null, "committer": null, "parents": [{"sha": "35d6801ebe76223839d318e66696d28fe903c739", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35d6801ebe76223839d318e66696d28fe903c739", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35d6801ebe76223839d318e66696d28fe903c739"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "4af6d4e83f2e10b4f1c8cd005834223b424462f7", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3090572ce2806c17059af0924390a7532467c2ef/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3090572ce2806c17059af0924390a7532467c2ef/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=3090572ce2806c17059af0924390a7532467c2ef", "patch": "@@ -1,3 +1,9 @@\n+2003-12-10  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/13217\n+\t* include/bits/fstream.tcc (underflow): Deal gracefully with\n+\tread errors: throw ios_base::failure.\n+\n 2003-12-10  Benjamin Kosnik  <bkoz@redhat.com>\n \n \tPR libstdc++/10063\n@@ -358,7 +364,7 @@\n \n \tPR libstdc++/11544\n \tPR libstdc++/11603\n-\t* include/bits/fstream.tcc (underflow): Throw ios_base:failure\n+\t* include/bits/fstream.tcc (underflow): Throw ios_base::failure\n \tupon incomplete or invalid byte sequences in the file.\n \t* testsuite/27_io/basic_filebuf/underflow/wchar_t/11544-1.cc: New.\n \t* testsuite/27_io/basic_filebuf/underflow/wchar_t/11544-2.cc: New."}, {"sha": "998e0c3442928591bc10833342acc483dfd60287", "filename": "libstdc++-v3/include/bits/fstream.tcc", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3090572ce2806c17059af0924390a7532467c2ef/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffstream.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3090572ce2806c17059af0924390a7532467c2ef/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffstream.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffstream.tcc?ref=3090572ce2806c17059af0924390a7532467c2ef", "patch": "@@ -258,6 +258,8 @@ namespace std\n \t\t      streamsize __elen = _M_file.xsgetn(_M_ext_end, __rlen);\n \t\t      if (__elen == 0)\n \t\t\t__got_eof = true;\n+\t\t      else if (__elen == -1)\n+\t\t\tbreak;\n \t\t      _M_ext_end += __elen;\n \t\t    }\n \n@@ -306,9 +308,12 @@ namespace std\n \t\t__throw_ios_failure(\"basic_filebuf::underflow \"\n \t\t\t\t    \"incomplete character in file\");\n \t    }\n-\t  else\n+\t  else if (__r == codecvt_base::error)\n \t    __throw_ios_failure(\"basic_filebuf::underflow \"\n \t\t\t\t\"invalid byte sequence in file\");\n+\t  else\n+\t    __throw_ios_failure(\"basic_filebuf::underflow \"\n+\t\t\t\t\"error reading the file\");\t    \n \t}\n       return __ret;\n     }"}]}