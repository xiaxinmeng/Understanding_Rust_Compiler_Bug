{"sha": "9bedc09b131799f532678275534ff774a088721a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWJlZGMwOWIxMzE3OTlmNTMyNjc4Mjc1NTM0ZmY3NzRhMDg4NzIxYQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-09-20T16:49:58Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-09-20T16:49:58Z"}, "message": "dwarf2out.c (any_cfis_emitted): New static variable.\n\n\t* dwarf2out.c (any_cfis_emitted): New static variable.\n\t(add_fde_cfi): Set it.\n\t(dwarf2out_frame_debug): Clear it before processing,\n\tif it is set afterwards, flush any queued reg saves.\n\nFrom-SVN: r164443", "tree": {"sha": "8509eac49f7a4e233128ec5c5c742ca95daca287", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8509eac49f7a4e233128ec5c5c742ca95daca287"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9bedc09b131799f532678275534ff774a088721a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bedc09b131799f532678275534ff774a088721a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9bedc09b131799f532678275534ff774a088721a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9bedc09b131799f532678275534ff774a088721a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fbbe0995b838343660140bce022165bc7976edb2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbbe0995b838343660140bce022165bc7976edb2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbbe0995b838343660140bce022165bc7976edb2"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "68ddcf8779e84ac36e116e1a26d342a8359f8ef6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bedc09b131799f532678275534ff774a088721a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bedc09b131799f532678275534ff774a088721a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9bedc09b131799f532678275534ff774a088721a", "patch": "@@ -1,5 +1,10 @@\n 2010-09-20  Jakub Jelinek  <jakub@redhat.com>\n \n+\t* dwarf2out.c (any_cfis_emitted): New static variable.\n+\t(add_fde_cfi): Set it.\n+\t(dwarf2out_frame_debug): Clear it before processing,\n+\tif it is set afterwards, flush any queued reg saves.\n+\n \tPR debug/45124\n \t* dwarf2out.c (add_accessibility_attribute): Assume\n \tDW_ACCESS_private as the default for dwarf_version > 2"}, {"sha": "908d015e9f0a09d1c8d5bc8f66d54efe5445ba3b", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9bedc09b131799f532678275534ff774a088721a/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9bedc09b131799f532678275534ff774a088721a/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=9bedc09b131799f532678275534ff774a088721a", "patch": "@@ -800,6 +800,9 @@ dwarf2out_cfi_label (bool force)\n /* True if remember_state should be emitted before following CFI directive.  */\n static bool emit_cfa_remember;\n \n+/* True if any CFI directives were emitted at the current insn.  */\n+static bool any_cfis_emitted;\n+\n /* Add CFI to the current fde at the PC value indicated by LABEL if specified,\n    or to the CIE if LABEL is NULL.  */\n \n@@ -879,6 +882,7 @@ add_fde_cfi (const char *label, dw_cfi_ref cfi)\n \t  output_cfi_directive (cfi);\n \n \t  list_head = &fde->dw_fde_cfi;\n+\t  any_cfis_emitted = true;\n \t}\n       /* ??? If this is a CFI for the CIE, we don't emit.  This\n \t assumes that the standard CIE contents that the assembler\n@@ -916,6 +920,7 @@ add_fde_cfi (const char *label, dw_cfi_ref cfi)\n \t}\n \n       list_head = &fde->dw_fde_cfi;\n+      any_cfis_emitted = true;\n     }\n \n   add_cfi (list_head, cfi);\n@@ -2745,6 +2750,7 @@ dwarf2out_frame_debug (rtx insn, bool after_p)\n     }\n \n   label = dwarf2out_cfi_label (false);\n+  any_cfis_emitted = false;\n \n   for (note = REG_NOTES (insn); note; note = XEXP (note, 1))\n     switch (REG_NOTE_KIND (note))\n@@ -2830,7 +2836,11 @@ dwarf2out_frame_debug (rtx insn, bool after_p)\n \tbreak;\n       }\n   if (handled_one)\n-    return;\n+    {\n+      if (any_cfis_emitted)\n+\tdwarf2out_flush_queued_reg_saves ();\n+      return;\n+    }\n \n   insn = PATTERN (insn);\n  found:\n@@ -2839,7 +2849,7 @@ dwarf2out_frame_debug (rtx insn, bool after_p)\n   /* Check again.  A parallel can save and update the same register.\n      We could probably check just once, here, but this is safer than\n      removing the check above.  */\n-  if (clobbers_queued_reg_save (insn))\n+  if (any_cfis_emitted || clobbers_queued_reg_save (insn))\n     dwarf2out_flush_queued_reg_saves ();\n }\n "}]}