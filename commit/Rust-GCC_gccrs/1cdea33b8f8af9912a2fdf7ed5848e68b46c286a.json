{"sha": "1cdea33b8f8af9912a2fdf7ed5848e68b46c286a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWNkZWEzM2I4ZjhhZjk5MTJhMmZkZjdlZDU4NDhlNjhiNDZjMjg2YQ==", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2012-07-16T03:02:47Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@gcc.gnu.org", "date": "2012-07-16T03:02:47Z"}, "message": "sync.md (\"atomic_compare_and_swap<mode>\"): Change predicate to nonmemory_operand for operand 3.\n\n\t* config/cris/sync.md (\"atomic_compare_and_swap<mode>\"): Change\n\tpredicate to nonmemory_operand for operand 3.  Add FIXME.\n\t(\"cris_atomic_compare_and_swap<mode>_1\"): Change predicates and\n\nFrom-SVN: r189501", "tree": {"sha": "d38afa81614946ad980dc38a1a09cee41c33f67f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d38afa81614946ad980dc38a1a09cee41c33f67f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "fdb6272c11a47c5030719f0cf059b57974a269f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdb6272c11a47c5030719f0cf059b57974a269f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fdb6272c11a47c5030719f0cf059b57974a269f2"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "2ff638d466ad3f51014c7298dde5d19a794c0c1d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1cdea33b8f8af9912a2fdf7ed5848e68b46c286a", "patch": "@@ -1,6 +1,10 @@\n 2012-07-16  Hans-Peter Nilsson  <hp@axis.com>\n \n-\t* config/cris/sync.md (\"atomic_fetch_<atomic_op_name><mode>\")\n+\t* config/cris/sync.md (\"atomic_compare_and_swap<mode>\"): Change\n+\tpredicate to nonmemory_operand for operand 3.  Add FIXME.\n+\t(\"cris_atomic_compare_and_swap<mode>_1\"): Change predicates and\n+\tconstraints for operand 3 to exclude memory.\n+\t(\"atomic_fetch_<atomic_op_name><mode>\")\n \t(\"atomic_compare_and_swap<mode>\"): Gate expand_mem_thread_fence\n \tcalls on result of call to need_atomic_barrier_p.\n "}, {"sha": "baa2bebc7cb01d6f384fe2dfd4ba12e4cbaf28b5", "filename": "gcc/config/cris/sync.md", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a/gcc%2Fconfig%2Fcris%2Fsync.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cdea33b8f8af9912a2fdf7ed5848e68b46c286a/gcc%2Fconfig%2Fcris%2Fsync.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcris%2Fsync.md?ref=1cdea33b8f8af9912a2fdf7ed5848e68b46c286a", "patch": "@@ -184,11 +184,12 @@\n ;; can_compare_and_swap_p call in omp-low.c, 4.8 era).  We'd slightly\n ;; prefer atomic_exchange<mode> over this, but having both would be\n ;; redundant.\n+;; FIXME: handle memory without side-effects for operand[3].\n (define_expand \"atomic_compare_and_swap<mode>\"\n   [(match_operand:SI 0 \"register_operand\")\n    (match_operand:BWD 1 \"register_operand\")\n    (match_operand:BWD 2 \"memory_operand\")\n-   (match_operand:BWD 3 \"general_operand\")\n+   (match_operand:BWD 3 \"nonmemory_operand\")\n    (match_operand:BWD 4 \"register_operand\")\n    (match_operand 5)\n    (match_operand 6)\n@@ -218,7 +219,7 @@\n   [(set (match_operand:SI 0 \"register_operand\" \"=&r\")\n \t(unspec_volatile:SI\n \t [(match_operand:BWD 2 \"memory_operand\" \"+Q\")\n-\t  (match_operand:BWD 3 \"general_operand\" \"g\")]\n+\t  (match_operand:BWD 3 \"nonmemory_operand\" \"ri\")]\n \t CRIS_UNSPEC_ATOMIC_SWAP_BOOL))\n    (set (match_operand:BWD 1 \"register_operand\" \"=&r\") (match_dup 2))\n    (set (match_dup 2)"}]}