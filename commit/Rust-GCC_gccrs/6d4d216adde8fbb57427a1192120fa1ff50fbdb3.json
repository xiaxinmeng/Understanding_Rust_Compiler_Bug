{"sha": "6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQ0ZDIxNmFkZGU4ZmJiNTc0MjdhMTE5MjEyMGZhMWZmNTBmYmRiMw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@libertysurf.fr", "date": "2006-10-24T13:59:06Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2006-10-24T13:59:06Z"}, "message": "re PR libgomp/29494 (libgomp build fails with missing pthread_mutexattr_settype)\n\n\tPR libgomp/29494\n\t* configure.tgt: Use posix95 configuration for Solaris 2.5.1 and 2.6.\n\t* config/posix95: New directory.\n\t* config/posix95/omp-lock.h: New file.\n\t* config/posix95/lock.c: Likewise.\n\nFrom-SVN: r118004", "tree": {"sha": "52876da9b23cde147446df15c9b86849c36e36d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/52876da9b23cde147446df15c9b86849c36e36d9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/comments", "author": {"login": "ebotcazou", "id": 48091907, "node_id": "MDQ6VXNlcjQ4MDkxOTA3", "avatar_url": "https://avatars.githubusercontent.com/u/48091907?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ebotcazou", "html_url": "https://github.com/ebotcazou", "followers_url": "https://api.github.com/users/ebotcazou/followers", "following_url": "https://api.github.com/users/ebotcazou/following{/other_user}", "gists_url": "https://api.github.com/users/ebotcazou/gists{/gist_id}", "starred_url": "https://api.github.com/users/ebotcazou/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ebotcazou/subscriptions", "organizations_url": "https://api.github.com/users/ebotcazou/orgs", "repos_url": "https://api.github.com/users/ebotcazou/repos", "events_url": "https://api.github.com/users/ebotcazou/events{/privacy}", "received_events_url": "https://api.github.com/users/ebotcazou/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a5326b13ed7805ba0c18cbd0362c95e8971f6b48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a5326b13ed7805ba0c18cbd0362c95e8971f6b48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a5326b13ed7805ba0c18cbd0362c95e8971f6b48"}], "stats": {"total": 161, "additions": 161, "deletions": 0}, "files": [{"sha": "d5788240f801cb9d57ee5632612570889f5d006f", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "patch": "@@ -1,3 +1,11 @@\n+2006-10-24  Eric Botcazou  <ebotcazou@libertysurf.fr>\n+\n+\tPR libgomp/29494\n+\t* configure.tgt: Use posix95 configuration for Solaris 2.5.1 and 2.6.\n+\t* config/posix95: New directory.\n+\t* config/posix95/omp-lock.h: New file.\n+\t* config/posix95/lock.c: Likewise.\n+\n 2006-10-14  Geoffrey Keating  <geoffk@apple.com>\n \n \t* aclocal.m4: Regenerate."}, {"sha": "2416f1131c781a10c846d01b7799b74582d9c975", "filename": "libgomp/config/posix95/lock.c", "status": "added", "additions": 131, "deletions": 0, "changes": 131, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2Fconfig%2Fposix95%2Flock.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2Fconfig%2Fposix95%2Flock.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfig%2Fposix95%2Flock.c?ref=6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "patch": "@@ -0,0 +1,131 @@\n+/* Copyright (C) 2006 Free Software Foundation, Inc.\n+\n+   This file is part of the GNU OpenMP Library (libgomp).\n+\n+   Libgomp is free software; you can redistribute it and/or modify it\n+   under the terms of the GNU Lesser General Public License as published by\n+   the Free Software Foundation; either version 2.1 of the License, or\n+   (at your option) any later version.\n+\n+   Libgomp is distributed in the hope that it will be useful, but WITHOUT ANY\n+   WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n+   FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for\n+   more details.\n+\n+   You should have received a copy of the GNU Lesser General Public License \n+   along with libgomp; see the file COPYING.LIB.  If not, write to the\n+   Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,\n+   MA 02110-1301, USA.  */\n+\n+/* As a special exception, if you link this library with other files, some\n+   of which are compiled with GCC, to produce an executable, this library\n+   does not by itself cause the resulting executable to be covered by the\n+   GNU General Public License.  This exception does not however invalidate\n+   any other reasons why the executable file might be covered by the GNU\n+   General Public License.  */\n+\n+/* This is the POSIX95 implementation of the public OpenMP locking primitives.\n+\n+   Because OpenMP uses different entry points for normal and recursive\n+   locks, and pthreads uses only one entry point, a system may be able\n+   to do better and streamline the locking as well as reduce the size\n+   of the types exported.  */\n+\n+#include \"libgomp.h\"\n+\n+\n+void\n+omp_init_lock (omp_lock_t *lock)\n+{\n+  pthread_mutex_init (lock, NULL);\n+}\n+\n+void\n+omp_destroy_lock (omp_lock_t *lock)\n+{\n+  pthread_mutex_destroy (lock);\n+}\n+\n+void\n+omp_set_lock (omp_lock_t *lock)\n+{\n+  pthread_mutex_lock (lock);\n+}\n+\n+void\n+omp_unset_lock (omp_lock_t *lock)\n+{\n+  pthread_mutex_unlock (lock);\n+}\n+\n+int\n+omp_test_lock (omp_lock_t *lock)\n+{\n+  return pthread_mutex_trylock (lock) == 0;\n+}\n+\n+void\n+omp_init_nest_lock (omp_nest_lock_t *lock)\n+{\n+  pthread_mutex_init (&lock->lock, NULL);\n+  lock->owner = (pthread_t) 0;\n+  lock->count = 0;\n+}\n+\n+void\n+omp_destroy_nest_lock (omp_nest_lock_t *lock)\n+{\n+  pthread_mutex_destroy (&lock->lock);\n+}\n+\n+void\n+omp_set_nest_lock (omp_nest_lock_t *lock)\n+{\n+  pthread_t me = pthread_self ();\n+\n+  if (lock->owner != me)\n+    {\n+      pthread_mutex_lock (&lock->lock);\n+      lock->owner = me;\n+    }\n+\n+  lock->count++;\n+}\n+\n+void\n+omp_unset_nest_lock (omp_nest_lock_t *lock)\n+{\n+  lock->count--;\n+\n+  if (lock->count == 0)\n+    {\n+      lock->owner = (pthread_t) 0;\n+      pthread_mutex_unlock (&lock->lock);\n+    }\n+}\n+\n+int\n+omp_test_nest_lock (omp_nest_lock_t *lock)\n+{\n+  pthread_t me = pthread_self ();\n+\n+  if (lock->owner != me)\n+    {\n+      if (pthread_mutex_trylock (&lock->lock) != 0)\n+\treturn 0;\n+      lock->owner = me;\n+    }\n+\n+  return ++lock->count;\n+}\n+\n+ialias (omp_init_lock)\n+ialias (omp_init_nest_lock)\n+ialias (omp_destroy_lock)\n+ialias (omp_destroy_nest_lock)\n+ialias (omp_set_lock)\n+ialias (omp_set_nest_lock)\n+ialias (omp_unset_lock)\n+ialias (omp_unset_nest_lock)\n+ialias (omp_test_lock)\n+ialias (omp_test_nest_lock)"}, {"sha": "c446aec01e5a680235d314b9d5bf7fd2e8293609", "filename": "libgomp/config/posix95/omp-lock.h", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2Fconfig%2Fposix95%2Fomp-lock.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2Fconfig%2Fposix95%2Fomp-lock.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfig%2Fposix95%2Fomp-lock.h?ref=6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "patch": "@@ -0,0 +1,17 @@\n+/* This header is used during the build process to find the size and \n+   alignment of the public OpenMP locks, so that we can export data\n+   structures without polluting the namespace.\n+\n+   In this POSIX95 implementation, we map the two locks to the\n+   same PTHREADS primitive.  */\n+\n+#include <pthread.h>\n+\n+typedef pthread_mutex_t omp_lock_t;\n+\n+typedef struct\n+{\n+  pthread_mutex_t lock;\n+  pthread_t owner;\n+  int count;\n+} omp_nest_lock_t;"}, {"sha": "7464d6a1cdfd16c9582e7863e482a999e9ef1264", "filename": "libgomp/configure.tgt", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2Fconfigure.tgt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d4d216adde8fbb57427a1192120fa1ff50fbdb3/libgomp%2Fconfigure.tgt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfigure.tgt?ref=6d4d216adde8fbb57427a1192120fa1ff50fbdb3", "patch": "@@ -95,6 +95,11 @@ case \"${target}\" in\n \tconfig_path=\"mingw32 posix\"\n \t;;\n \n+  *-*-solaris2.[56]*)\n+\tconfig_path=\"posix95 posix\"\n+\tXLDFLAGS=\"${XLDFLAGS} -lposix4\"\n+\t;;\n+\n   *)\n \t;;\n "}]}