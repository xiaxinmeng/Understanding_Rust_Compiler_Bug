{"sha": "25632d2efbf80cb0b5da2fb38081b44f766584de", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjU2MzJkMmVmYmY4MGNiMGI1ZGEyZmIzODA4MWI0NGY3NjY1ODRkZQ==", "commit": {"author": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2012-07-23T09:26:41Z"}, "committer": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2012-07-23T09:26:41Z"}, "message": "re PR tree-optimization/53881 (ICE in hoist_edge_and_branch_if_true)\n\ngcc/\n\tPR tree-optimization/53881\n\t* tree-cfg.c (group_case_labels_stmt): Look up the basic block\n\tfor each label and compare them instead of labels.\n\ntestsuite/\n\tPR tree-optimization/53881\n\t* gcc.dg/pr53881.c: Renamed to ...\n\t* gcc.dg/pr53881-1.c: ... this.\n\t* gcc.dg/pr53881-2.c: New test.\n\nFrom-SVN: r189779", "tree": {"sha": "df7beb4a840ad1542fd80829ec8ac762bde123fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/df7beb4a840ad1542fd80829ec8ac762bde123fe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/25632d2efbf80cb0b5da2fb38081b44f766584de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25632d2efbf80cb0b5da2fb38081b44f766584de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/25632d2efbf80cb0b5da2fb38081b44f766584de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25632d2efbf80cb0b5da2fb38081b44f766584de/comments", "author": null, "committer": null, "parents": [{"sha": "9696c52909efcdb631f5fd7e8a8261656a25cc1b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9696c52909efcdb631f5fd7e8a8261656a25cc1b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9696c52909efcdb631f5fd7e8a8261656a25cc1b"}], "stats": {"total": 51, "additions": 42, "deletions": 9}, "files": [{"sha": "5f498e82fd3929cacd924cdb001ede548055c1b6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=25632d2efbf80cb0b5da2fb38081b44f766584de", "patch": "@@ -1,3 +1,9 @@\n+2012-07-22  Steven Bosscher  <steven@gcc.gnu.org>\n+\n+\tPR tree-optimization/53881\n+\t* tree-cfg.c (group_case_labels_stmt): Look up the basic block\n+\tfor each label and compare them instead of labels.\n+\n 2012-07-22  Steven Bosscher <steven@gcc.gnu.org>\n \n \t* opts.c (common_handle_option): Do not set "}, {"sha": "75b8d097e5f4bdefa794c6b9b2e280568f08fdc7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=25632d2efbf80cb0b5da2fb38081b44f766584de", "patch": "@@ -1,3 +1,10 @@\n+2012-07-22  Steven Bosscher  <steven@gcc.gnu.org>\n+\n+\tPR tree-optimization/53881\n+\t* gcc.dg/pr53881.c: Renamed to ...\n+\t* gcc.dg/pr53881-1.c: ... this.\n+\t* gcc.dg/pr53881-2.c: New test.\n+\n 2012-07-22  Hans-Peter Nilsson  <hp@axis.com>\n \n \tHandle recent changes in default atomics for cris*-*-linux*."}, {"sha": "435d938a4009968e755803ab7d97b0679092d867", "filename": "gcc/testsuite/gcc.dg/pr53881-1.c", "status": "renamed", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftestsuite%2Fgcc.dg%2Fpr53881-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftestsuite%2Fgcc.dg%2Fpr53881-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr53881-1.c?ref=25632d2efbf80cb0b5da2fb38081b44f766584de", "previous_filename": "gcc/testsuite/gcc.dg/pr53881.c"}, {"sha": "f6f8f8bcb398f66b757df01b5223eccfeb172528", "filename": "gcc/testsuite/gcc.dg/pr53881-2.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftestsuite%2Fgcc.dg%2Fpr53881-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftestsuite%2Fgcc.dg%2Fpr53881-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr53881-2.c?ref=25632d2efbf80cb0b5da2fb38081b44f766584de", "patch": "@@ -0,0 +1,19 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\" } */\n+\n+int a,b,c;\n+void\n+fn1 ()\n+{\n+  switch (a)\n+    {\n+    case 0:\n+    case 10:\n+      b=c;\n+out_bcon:\n+      break;\n+    case 3:\n+      goto out_bcon;\n+    }\n+}\n+"}, {"sha": "88efc785af6c8b1b3e3c328762f5eb8ac6cdf57f", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 10, "deletions": 9, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/25632d2efbf80cb0b5da2fb38081b44f766584de/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=25632d2efbf80cb0b5da2fb38081b44f766584de", "patch": "@@ -1332,8 +1332,7 @@ group_case_labels_stmt (gimple stmt)\n {\n   int old_size = gimple_switch_num_labels (stmt);\n   int i, j, new_size = old_size;\n-  tree default_case = NULL_TREE;\n-  tree default_label = NULL_TREE;\n+  basic_block default_bb = NULL;\n   bool has_default;\n \n   /* The default label is always the first case in a switch\n@@ -1342,8 +1341,8 @@ group_case_labels_stmt (gimple stmt)\n   if (!CASE_LOW (gimple_switch_default_label (stmt))\n       && !CASE_HIGH (gimple_switch_default_label (stmt)))\n     {\n-      default_case = gimple_switch_default_label (stmt);\n-      default_label = CASE_LABEL (default_case);\n+      tree default_case = gimple_switch_default_label (stmt);\n+      default_bb = label_to_block (CASE_LABEL (default_case));\n       has_default = true;\n     }\n   else\n@@ -1356,15 +1355,17 @@ group_case_labels_stmt (gimple stmt)\n     i = 0;\n   while (i < old_size)\n     {\n-      tree base_case, base_label, base_high;\n+      tree base_case, base_high;\n+      basic_block base_bb;\n+\n       base_case = gimple_switch_label (stmt, i);\n \n       gcc_assert (base_case);\n-      base_label = CASE_LABEL (base_case);\n+      base_bb = label_to_block (CASE_LABEL (base_case));\n \n       /* Discard cases that have the same destination as the\n \t default case.  */\n-      if (base_label == default_label)\n+      if (base_bb == default_bb)\n \t{\n \t  gimple_switch_set_label (stmt, i, NULL_TREE);\n \t  i++;\n@@ -1383,13 +1384,13 @@ group_case_labels_stmt (gimple stmt)\n       while (i < old_size)\n \t{\n \t  tree merge_case = gimple_switch_label (stmt, i);\n-\t  tree merge_label = CASE_LABEL (merge_case);\n+\t  basic_block merge_bb = label_to_block (CASE_LABEL (merge_case));\n \t  double_int bhp1 = double_int_add (tree_to_double_int (base_high),\n \t\t\t\t\t    double_int_one);\n \n \t  /* Merge the cases if they jump to the same place,\n \t     and their ranges are consecutive.  */\n-\t  if (merge_label == base_label\n+\t  if (merge_bb == base_bb\n \t      && double_int_equal_p (tree_to_double_int (CASE_LOW (merge_case)),\n \t\t\t\t     bhp1))\n \t    {"}]}