{"sha": "ebc27362b382f9f23668927f632da14055164131", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWJjMjczNjJiMzgyZjlmMjM2Njg5MjdmNjMyZGExNDA1NTE2NDEzMQ==", "commit": {"author": {"name": "Per Bothner", "email": "bothner@gcc.gnu.org", "date": "1995-04-12T06:34:50Z"}, "committer": {"name": "Per Bothner", "email": "bothner@gcc.gnu.org", "date": "1995-04-12T06:34:50Z"}, "message": "fix-header.c (main): Fix loop over required_functions_list\n\n* fix-header.c (main):  Fix loop over required_functions_list\n(fatal):  Also print inc_filename.\n\nFrom-SVN: r9364", "tree": {"sha": "a88c3383b51ecd5447d29ad34eaad02b05e634ed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a88c3383b51ecd5447d29ad34eaad02b05e634ed"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ebc27362b382f9f23668927f632da14055164131", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebc27362b382f9f23668927f632da14055164131", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ebc27362b382f9f23668927f632da14055164131", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebc27362b382f9f23668927f632da14055164131/comments", "author": null, "committer": null, "parents": [{"sha": "df87c8b70be341ad48c51e6460686d5eaf728ad8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df87c8b70be341ad48c51e6460686d5eaf728ad8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df87c8b70be341ad48c51e6460686d5eaf728ad8"}], "stats": {"total": 31, "additions": 11, "deletions": 20}, "files": [{"sha": "7491f9c90c4addf7d9de5136836b3a3bf2dc6133", "filename": "gcc/fix-header.c", "status": "modified", "additions": 11, "deletions": 20, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ebc27362b382f9f23668927f632da14055164131/gcc%2Ffix-header.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ebc27362b382f9f23668927f632da14055164131/gcc%2Ffix-header.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffix-header.c?ref=ebc27362b382f9f23668927f632da14055164131", "patch": "@@ -936,7 +936,7 @@ main (argc, argv)\n   struct stat sbuf;\n   int c;\n   int i, done;\n-  const char *cptr0, *cptr, **pptr;\n+  const char *cptr, **pptr;\n   int ifndef_line;\n   int endif_line;\n   long to_read;\n@@ -996,25 +996,16 @@ main (argc, argv)\n   required_functions_list = include_entry->required;\n \n   /* Count and mark the prototypes required for this include file. */ \n-  for (cptr = required_functions_list, cptr0 = cptr, done = 0;\n-       !done; cptr++)\n+  for (cptr = required_functions_list; *cptr!= '\\0'; )\n     {\n-      if (*cptr == '\\0')\n-\t{\n-\t  if (cptr[1] == 0)\n-\t    break;\n-\t  else\n-\t    {\n-\t      struct fn_decl *fn = lookup_std_proto (cptr0, strlen (cptr0));\n-\t      required_unseen_count++;\n-\t      if (fn == NULL)\n-\t\tfprintf (stderr, \"Internal error:  No prototype for %s\\n\",\n-\t\t\t cptr0);\n-\t      else\n-\t\tSET_REQUIRED (fn);\n-\t    }\n-\t  cptr0 = cptr + 1;\n-\t}\n+      int name_len = strlen (cptr);\n+      struct fn_decl *fn = lookup_std_proto (cptr, name_len);\n+      required_unseen_count++;\n+      if (fn == NULL)\n+\tfprintf (stderr, \"Internal error:  No prototype for %s\\n\", cptr);\n+      else\n+\tSET_REQUIRED (fn);\n+      cptr += name_len + 1;\n     }\n \n   read_scan_file (argv[2], argc - 4, argv + 4);\n@@ -1197,7 +1188,7 @@ void\n fatal (str, arg)\n      char *str, *arg;\n {\n-  fprintf (stderr, \"%s: \", progname);\n+  fprintf (stderr, \"%s: %s: \", progname, inc_filename);\n   fprintf (stderr, str, arg);\n   fprintf (stderr, \"\\n\");\n   exit (FAILURE_EXIT_CODE);"}]}