{"sha": "e489eeb9331efd07f584794f69db5ced3cc959da", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTQ4OWVlYjkzMzFlZmQwN2Y1ODQ3OTRmNjlkYjVjZWQzY2M5NTlkYQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2003-06-10T02:57:48Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2003-06-10T02:57:48Z"}, "message": "gcc-dg.exp (dg-test): Clear additional_files and additional_sources.\n\n\t* lib/gcc-dg.exp (dg-test): Clear additional_files and\n\tadditional_sources.\n\nFrom-SVN: r67696", "tree": {"sha": "d3b035ecd8f852bb17fb6f9034df0f3fee61abdd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d3b035ecd8f852bb17fb6f9034df0f3fee61abdd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e489eeb9331efd07f584794f69db5ced3cc959da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e489eeb9331efd07f584794f69db5ced3cc959da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e489eeb9331efd07f584794f69db5ced3cc959da", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e489eeb9331efd07f584794f69db5ced3cc959da/comments", "author": null, "committer": null, "parents": [{"sha": "4982b6384adffe54c33ee0f5a15ba2cd3482f1f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4982b6384adffe54c33ee0f5a15ba2cd3482f1f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4982b6384adffe54c33ee0f5a15ba2cd3482f1f7"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "c660eca4838ce31a45a0d411d8ce73b2a84ac88a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e489eeb9331efd07f584794f69db5ced3cc959da/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e489eeb9331efd07f584794f69db5ced3cc959da/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e489eeb9331efd07f584794f69db5ced3cc959da", "patch": "@@ -1,3 +1,8 @@\n+2003-06-09  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* lib/gcc-dg.exp (dg-test): Clear additional_files and\n+\tadditional_sources.\n+\n 2003-05-21  David Taylor  <dtaylor@emc.com>\n \n \t* gcc.dg/Wpadded.c: New file."}, {"sha": "1feadc4a0802506f4eec9694bade3026681e685e", "filename": "gcc/testsuite/lib/gcc-dg.exp", "status": "modified", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e489eeb9331efd07f584794f69db5ced3cc959da/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e489eeb9331efd07f584794f69db5ced3cc959da/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Fgcc-dg.exp?ref=e489eeb9331efd07f584794f69db5ced3cc959da", "patch": "@@ -294,3 +294,31 @@ proc dg-require-gc-sections { args } {\n \treturn\n     }\n }\n+\n+# We need to make sure that additional_files and additional_sources\n+# are both cleared out after every test.  It is not enough to clear\n+# them out *before* the next test run because gcc-target-compile gets\n+# run directly from some .exp files (outside of any test).  (Those\n+# uses should eventually be eliminated.) \n+\n+# Because the DG framework doesn't provide a hook that is run at the\n+# end of a test, we must replace dg-test with a wrapper.\n+\n+if { [info procs saved-dg-test] == [list] } {\n+    rename dg-test saved-dg-test\n+\n+    proc dg-test { args } {\n+\tglobal additional_files\n+\tglobal additional_sources\n+\tglobal errorInfo\n+\n+\tif { [ catch { eval saved-dg-test $args } errmsg ] } {\n+\t    set saved_info $errorInfo\n+\t    set additional_files \"\"\n+\t    set additional_sources \"\"\n+\t    error $errmsg $saved_info\n+\t}\n+\tset additional_files \"\"\n+\tset additional_sources \"\"\n+    }\n+}"}]}