{"sha": "364490206eaee4e4da9f66e63169cc0c0ddfe40e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzY0NDkwMjA2ZWFlZTRlNGRhOWY2NmU2MzE2OWNjMGMwZGRmZTQwZQ==", "commit": {"author": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2017-05-13T21:07:49Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2017-05-13T21:07:49Z"}, "message": "compare-elim.c (equivalent_reg_at_start): Return NULL_RTX when returned register mode doesn't match original mode.\n\n\t* compare-elim.c (equivalent_reg_at_start): Return NULL_RTX\n\twhen returned register mode doesn't match original mode.\n\nFrom-SVN: r248009", "tree": {"sha": "b24bdeaf45d5e675382cbcf6786fe42b8e9698d8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b24bdeaf45d5e675382cbcf6786fe42b8e9698d8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/364490206eaee4e4da9f66e63169cc0c0ddfe40e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/364490206eaee4e4da9f66e63169cc0c0ddfe40e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/364490206eaee4e4da9f66e63169cc0c0ddfe40e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/364490206eaee4e4da9f66e63169cc0c0ddfe40e/comments", "author": null, "committer": null, "parents": [{"sha": "2263019d609e05c2689542a917f3b6565bd7cbb0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2263019d609e05c2689542a917f3b6565bd7cbb0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2263019d609e05c2689542a917f3b6565bd7cbb0"}], "stats": {"total": 11, "additions": 10, "deletions": 1}, "files": [{"sha": "9ec0a530f3f1aacdcad7b734e19475c4e0d307f4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/364490206eaee4e4da9f66e63169cc0c0ddfe40e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/364490206eaee4e4da9f66e63169cc0c0ddfe40e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=364490206eaee4e4da9f66e63169cc0c0ddfe40e", "patch": "@@ -1,7 +1,12 @@\n+2017-05-13  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\t* compare-elim.c (equivalent_reg_at_start): Return NULL_RTX\n+\twhen returned register mode doesn't match original mode.\n+\n 2017-05-12  Jeff Law  <law@redhat.com>\n \t    Jakub Jelinek  <jakub@redhat.com>\n \n-\t* config/mn10300/mn10300.c (mn10300_match_ccmode): Fix where\t\n+\t* config/mn10300/mn10300.c (mn10300_match_ccmode): Fix where\n \twe look for cc setter after the compare-elim changes.\n \t* config/mn10300/mn10300.md (addsi3_flags): Fix order of patterns\n \twithin the vector to match what compare-elim now expects."}, {"sha": "b5ce99341f6623263b72678e3dafcab198dd26c0", "filename": "gcc/compare-elim.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/364490206eaee4e4da9f66e63169cc0c0ddfe40e/gcc%2Fcompare-elim.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/364490206eaee4e4da9f66e63169cc0c0ddfe40e/gcc%2Fcompare-elim.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcompare-elim.c?ref=364490206eaee4e4da9f66e63169cc0c0ddfe40e", "patch": "@@ -526,6 +526,7 @@ maybe_select_cc_mode (struct comparison *cmp, rtx a ATTRIBUTE_UNUSED,\n static rtx\n equivalent_reg_at_start (rtx reg, rtx_insn *end, rtx_insn *start)\n {\n+  machine_mode orig_mode = GET_MODE (reg);\n   rtx_insn *bb_head = BB_HEAD (BLOCK_FOR_INSN (end));\n \n   for (rtx_insn *insn = PREV_INSN (end);\n@@ -572,6 +573,9 @@ equivalent_reg_at_start (rtx reg, rtx_insn *end, rtx_insn *start)\n \treturn NULL_RTX;\n     }\n \n+  if (GET_MODE (reg) != orig_mode)\n+    return NULL_RTX;\n+\n   return reg;\n }\n "}]}