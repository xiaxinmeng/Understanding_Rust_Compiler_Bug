{"sha": "bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQwYTNlMjQ0ZDk0YWQ0YTVlNDFmMDFlYmYyODVmMDg2MWNiNGEwMw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-01-21T20:43:03Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-01-21T20:43:03Z"}, "message": "riscv: Fix up riscv_rtx_costs for RTL checking (PR target/93333)\n\nAs mentioned in the PR, during combine rtx_costs can be called sometimes\neven on RTL that has not been validated yet and so can contain even operands\nthat aren't valid in any instruction.\n\n2020-01-21  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR target/93333\n\t* config/riscv/riscv.c (riscv_rtx_costs) <case ZERO_EXTRACT>: Verify\n\tthe last two operands are CONST_INT_P before using them as such.\n\n\t* gcc.c-torture/compile/pr93333.c: New test.", "tree": {"sha": "09119145dd2ab49f40778b868c48c17e6729bf35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/09119145dd2ab49f40778b868c48c17e6729bf35"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7b72c0d4a053f64c1ac1f1c2eb846aafe56a0a83", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7b72c0d4a053f64c1ac1f1c2eb846aafe56a0a83", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7b72c0d4a053f64c1ac1f1c2eb846aafe56a0a83"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "e7ae5bbefa157b718a12d58b884dedc8c82b7a4a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "patch": "@@ -1,3 +1,9 @@\n+2020-01-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/93333\n+\t* config/riscv/riscv.c (riscv_rtx_costs) <case ZERO_EXTRACT>: Verify\n+\tthe last two operands are CONST_INT_P before using them as such.\n+\n 2020-01-21  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* config/aarch64/aarch64-sve-builtins.def: Use get_typenode_from_name"}, {"sha": "e0205c66f2687594aac5884569c13cc4484c4027", "filename": "gcc/config/riscv/riscv.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2Fconfig%2Friscv%2Friscv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2Fconfig%2Friscv%2Friscv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.c?ref=bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "patch": "@@ -1642,7 +1642,10 @@ riscv_rtx_costs (rtx x, machine_mode mode, int outer_code, int opno ATTRIBUTE_UN\n \n     case ZERO_EXTRACT:\n       /* This is an SImode shift.  */\n-      if (outer_code == SET && (INTVAL (XEXP (x, 2)) > 0)\n+      if (outer_code == SET\n+\t  && CONST_INT_P (XEXP (x, 1))\n+\t  && CONST_INT_P (XEXP (x, 2))\n+\t  && (INTVAL (XEXP (x, 2)) > 0)\n \t  && (INTVAL (XEXP (x, 1)) + INTVAL (XEXP (x, 2)) == 32))\n \t{\n \t  *total = COSTS_N_INSNS (SINGLE_SHIFT_COST);"}, {"sha": "e8561cca4122b7a254f1f6dbb9ee927e8e244f2d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "patch": "@@ -1,3 +1,8 @@\n+2020-01-21  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/93333\n+\t* gcc.c-torture/compile/pr93333.c: New test.\n+\n 2020-01-21  Sandra Loosemore  <sandra@codesourcery.com>\n \n \t* g++.dg/coroutines/torture/mid-suspend-destruction-0.C: Generalize"}, {"sha": "801959bea75fb72661771194d4e401f68917ddb5", "filename": "gcc/testsuite/gcc.c-torture/compile/pr93333.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr93333.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr93333.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr93333.c?ref=bd0a3e244d94ad4a5e41f01ebf285f0861cb4a03", "patch": "@@ -0,0 +1,10 @@\n+/* PR target/93333 */\n+\n+unsigned\n+foo (int b, int c, int d, unsigned long e, int x, int y, int g, int h,\n+     unsigned i)\n+{\n+  e >>= b;\n+  i >>= e & 31;\n+  return i & 1;\n+}"}]}