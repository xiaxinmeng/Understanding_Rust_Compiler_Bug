{"sha": "94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTRkMjg1YTUzY2VhYjQ1MGNiYzM1ZTA2NzNjMzZjZDdmYzZkZDJlYQ==", "commit": {"author": {"name": "Volker Reichelt", "email": "reichelt@igpm.rwth-aachen.de", "date": "2006-04-19T22:03:24Z"}, "committer": {"name": "Volker Reichelt", "email": "reichelt@gcc.gnu.org", "date": "2006-04-19T22:03:24Z"}, "message": "re PR c++/26558 (segfault on syntax error)\n\n\tPR c++/26558\n\t* parser.c (cp_parser_class_name): Check for invalid typenames.\n\tRearrange code.\n\n\t* g++.dg/parse/template19.C: New test.\n\nFrom-SVN: r113096", "tree": {"sha": "6e28879b33c91241ff9907dd1372a56ea1b73fcb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6e28879b33c91241ff9907dd1372a56ea1b73fcb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/comments", "author": null, "committer": null, "parents": [{"sha": "51e8f10cf6fd8c4c739d7504523c6c294f951200", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51e8f10cf6fd8c4c739d7504523c6c294f951200", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51e8f10cf6fd8c4c739d7504523c6c294f951200"}], "stats": {"total": 35, "additions": 28, "deletions": 7}, "files": [{"sha": "7c1311d27a2f3c93320ed4c06dd1e6c2329fffb0", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "patch": "@@ -1,5 +1,9 @@\n 2006-04-19  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n+\tPR c++/26558\n+\t* parser.c (cp_parser_class_name): Check for invalid typenames.\n+\tRearrange code.\n+\n \tPR c++/26739\n \t* pt.c (tsubst_friend_function): Return early if\n \tpushdecl_namespace_level fails."}, {"sha": "f673c16bacf46c198b8e14416cb4fe7c08564b3e", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "patch": "@@ -12830,15 +12830,18 @@ cp_parser_class_name (cp_parser *parser,\n        standard does not seem to be definitive, but there is no other\n        valid interpretation of the following `::'.  Therefore, those\n        names are considered class-names.  */\n-    decl = TYPE_NAME (make_typename_type (scope, decl, tag_type, tf_error));\n-  else if (decl == error_mark_node\n-\t   || TREE_CODE (decl) != TYPE_DECL\n-\t   || TREE_TYPE (decl) == error_mark_node\n-\t   || !IS_AGGR_TYPE (TREE_TYPE (decl)))\n     {\n-      cp_parser_error (parser, \"expected class-name\");\n-      return error_mark_node;\n+      decl = make_typename_type (scope, decl, tag_type, tf_error);\n+      if (decl != error_mark_node)\n+\tdecl = TYPE_NAME (decl);\n     }\n+  else if (TREE_CODE (decl) != TYPE_DECL\n+\t   || TREE_TYPE (decl) == error_mark_node\n+\t   || !IS_AGGR_TYPE (TREE_TYPE (decl)))\n+    decl = error_mark_node;\n+\n+  if (decl == error_mark_node)\n+    cp_parser_error (parser, \"expected class-name\");\n \n   return decl;\n }"}, {"sha": "e55cee818b254ec5097db48a8310e8a03818fc27", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "patch": "@@ -1,5 +1,8 @@\n 2006-04-19  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n+\tPR c++/26558\n+\t* g++.dg/parse/template19.C: New test.\n+\n \tPR c++/26739\n \t* g++.old-deja/g++.pt/friend36.C: Adjust error markers.\n "}, {"sha": "dc1a67334b528891f3e65c072ce6cb3b9db4d9ec", "filename": "gcc/testsuite/g++.dg/parse/template19.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate19.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94d285a53ceab450cbc35e0673c36cd7fc6dd2ea/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate19.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate19.C?ref=94d285a53ceab450cbc35e0673c36cd7fc6dd2ea", "patch": "@@ -0,0 +1,11 @@\n+// PR c++/26558\n+// Origin: Jan Gorski <slimak@yk74.internetdsl.tpnet.pl>\n+// { dg-do compile }\n+\n+template<int> struct A\n+{\n+  template<int> void foo()\n+  {\n+    foo<0>::; // { dg-error \"before\" }\n+  }\n+};"}]}