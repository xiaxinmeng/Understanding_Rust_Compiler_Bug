{"sha": "5b2217f83f77747f59c910a9f4a971c147b9c51f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWIyMjE3ZjgzZjc3NzQ3ZjU5YzkxMGE5ZjRhOTcxYzE0N2I5YzUxZg==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@adacore.com", "date": "2008-05-28T13:47:56Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-05-28T13:47:56Z"}, "message": "restrict.ads: Add missing restrictions, and properly label all GNAT defined ones\n\n2008-05-28  Robert Dewar  <dewar@adacore.com>\n\n\t* restrict.ads:\n\tAdd missing restrictions, and properly label all GNAT defined ones\n\t\n\t* rtsfind.ads:\n\tAdd entry for Ada_Real_Time.Timing_Events.Timing_Event\n\tAdd entry for Ada.Task_Termination.Set_Specific_Handler\n\tAdd entry for Ada.Task_Termination.Specific_Handler\n\t\n\t* s-rident.ads:\n\tAdd missing restrictions and properly mark all gnat defined ones\n\t\n\t* sem_ch3.adb:\n\t(Analyze_Object_Declaration): Check No_Local_Timing_Events restriction\n\t\n\t* sem_res.adb:\n\t(Resolve_Call): Check violation of No_Specific_Termination_Handlers\n\n\t* gnat_rm.texi: Add missing restrictions, and properly label all\n\tGNAT defined ones\n\nFrom-SVN: r136087", "tree": {"sha": "26ecc70c04743ad3d5f0d5a3687242eff75c0fef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26ecc70c04743ad3d5f0d5a3687242eff75c0fef"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5b2217f83f77747f59c910a9f4a971c147b9c51f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b2217f83f77747f59c910a9f4a971c147b9c51f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5b2217f83f77747f59c910a9f4a971c147b9c51f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b2217f83f77747f59c910a9f4a971c147b9c51f/comments", "author": null, "committer": null, "parents": [{"sha": "0b795892d2bb3638b44b03fbfd0087714ced817c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b795892d2bb3638b44b03fbfd0087714ced817c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b795892d2bb3638b44b03fbfd0087714ced817c"}], "stats": {"total": 117, "additions": 83, "deletions": 34}, "files": [{"sha": "5046cc56c731a014b4cbd1bacb0a44858c9bff09", "filename": "gcc/ada/gnat_rm.texi", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fgnat_rm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fgnat_rm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_rm.texi?ref=5b2217f83f77747f59c910a9f4a971c147b9c51f", "patch": "@@ -3897,7 +3897,7 @@ the Profile (Ravenscar), the value of Max_Task_Entries is always\n no calls to Task_Identification.Abort_Task.\n \n @item No_Asynchronous_Control\n-[RM D.7] There are no semantic dependences on the package\n+There are no semantic dependences on the package\n Asynchronous_Task_Control.\n \n @item No_Calendar\n@@ -3918,6 +3918,10 @@ Detach_Handler, and Reference).\n Protected objects and access types that designate\n such objects shall be declared only at library level.\n \n+@item No_Local_Timing_Events\n+[RM D.7] All objects of type Ada.Timing_Events.Timing_Event are\n+declared at the library level.\n+\n @item No_Protected_Type_Allocators\n There are no allocators for protected types or\n types containing protected subcomponents.\n@@ -3931,6 +3935,10 @@ Requeue statements are not allowed.\n @item No_Select_Statements\n There are no select_statements.\n \n+@item No_Specific_Termination_Handlers\n+[RM D.7] There are no calls to Ada.Task_Termination.Set_Specific_Handler\n+or to Ada.Task_Termination.Specific_Handler.\n+\n @item No_Task_Allocators\n [RM D.7] There are no allocators for task types\n or types containing task subcomponents.\n@@ -3945,6 +3953,12 @@ directly on the environment task of the partition.\n @item No_Task_Termination\n Tasks which terminate are erroneous.\n \n+@item No_Unchecked_Conversion\n+There are no semantic dependencies on the Ada.Unchecked_Conversion package.\n+\n+@item No_Unchecked_Deallocation\n+There are no semantic dependencies on the Ada.Unchecked_Deallocation package.\n+\n @item Simple_Barriers\n Entry barrier condition expressions shall be either static\n boolean expressions or boolean objects which are declared in"}, {"sha": "bb81d85ed79969badcc93ea5c439ea6b9f371005", "filename": "gcc/ada/restrict.ads", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Frestrict.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Frestrict.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frestrict.ads?ref=5b2217f83f77747f59c910a9f4a971c147b9c51f", "patch": "@@ -105,14 +105,18 @@ package Restrict is\n \n    Implementation_Restriction : array (All_Restrictions) of Boolean :=\n      (Simple_Barriers                    => True,\n+      No_Asynchronous_Control            => True,\n       No_Calendar                        => True,\n       No_Dispatching_Calls               => True,\n       No_Dynamic_Attachment              => True,\n+      No_Elaboration_Code                => True,\n       No_Enumeration_Maps                => True,\n       No_Entry_Calls_In_Elaboration_Code => True,\n       No_Entry_Queue                     => True,\n       No_Exception_Handlers              => True,\n       No_Exception_Registration          => True,\n+      No_Implementation_Attributes       => True,\n+      No_Implementation_Pragmas          => True,\n       No_Implicit_Conditionals           => True,\n       No_Implicit_Dynamic_Code           => True,\n       No_Implicit_Loops                  => True,\n@@ -126,12 +130,11 @@ package Restrict is\n       No_Streams                         => True,\n       No_Task_Attributes_Package         => True,\n       No_Task_Termination                => True,\n+      No_Unchecked_Conversion            => True,\n+      No_Unchecked_Deallocation          => True,\n       No_Wide_Characters                 => True,\n       Static_Priorities                  => True,\n       Static_Storage_Size                => True,\n-      No_Implementation_Attributes       => True,\n-      No_Implementation_Pragmas          => True,\n-      No_Elaboration_Code                => True,\n       others                             => False);\n \n    --  The following table records entries made by Restrictions pragmas"}, {"sha": "b3bbf6a35395a14119c5011325cd68e9c50d6a4f", "filename": "gcc/ada/rtsfind.ads", "status": "modified", "additions": 43, "deletions": 30, "changes": 73, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Frtsfind.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Frtsfind.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frtsfind.ads?ref=5b2217f83f77747f59c910a9f4a971c147b9c51f", "patch": "@@ -144,6 +144,7 @@ package Rtsfind is\n       --  Children of Ada.Real_Time\n \n       Ada_Real_Time_Delays,\n+      Ada_Real_Time_Timing_Events,\n \n       --  Children of Ada.Streams\n \n@@ -394,7 +395,7 @@ package Rtsfind is\n    --  Range of values for children of Ada.Interrupts\n \n    subtype Ada_Real_Time_Child is Ada_Child\n-     range Ada_Real_Time_Delays .. Ada_Real_Time_Delays;\n+     range Ada_Real_Time_Delays .. Ada_Real_Time_Timing_Events;\n    --  Range of values for children of Ada.Real_Time\n \n    subtype Ada_Streams_Child is Ada_Child\n@@ -470,6 +471,12 @@ package Rtsfind is\n \n      RE_Null,\n \n+     RO_CA_Time,                         -- Ada.Calendar\n+\n+     RO_CA_Delay_For,                    -- Ada.Calendar.Delays\n+     RO_CA_Delay_Until,                  -- Ada.Calendar.Delays\n+     RO_CA_To_Duration,                  -- Ada.Calendar.Delays\n+\n      RE_Set_Deadline,                    -- Ada.Dispatching.EDF\n \n      RE_Code_Loc,                        -- Ada.Exceptions\n@@ -503,6 +510,16 @@ package Rtsfind is\n \n      RE_Names,                           -- Ada.Interrupts.Names\n \n+     RE_Clock,                           -- Ada.Real_Time\n+     RE_Time_Span,                       -- Ada.Real_Time\n+     RE_Time_Span_Zero,                  -- Ada.Real_Time\n+     RO_RT_Time,                         -- Ada.Real_Time\n+\n+     RO_RT_Delay_Until,                  -- Ada.Real_Time.Delays\n+     RO_RT_To_Duration,                  -- Ada.Real_Time.Delays\n+\n+     RE_Timing_Event,                    -- Ada_Real_Time_Timing_Events\n+\n      RE_Root_Stream_Type,                -- Ada.Streams\n      RE_Stream_Element,                  -- Ada.Streams\n \n@@ -590,24 +607,13 @@ package Rtsfind is\n      RE_TK_Tagged,                       -- Ada.Tags\n      RE_TK_Task,                         -- Ada.Tags\n \n+     RE_Set_Specific_Handler,            -- Ada.Task_Termination\n+     RE_Specific_Handler,                -- Ada.Task_Termination\n+\n      RE_Abort_Task,                      -- Ada.Task_Identification\n      RE_Current_Task,                    -- Ada.Task_Identification\n      RO_AT_Task_Id,                      -- Ada.Task_Identification\n \n-     RO_CA_Time,                         -- Ada.Calendar\n-\n-     RO_CA_Delay_For,                    -- Ada.Calendar.Delays\n-     RO_CA_Delay_Until,                  -- Ada.Calendar.Delays\n-     RO_CA_To_Duration,                  -- Ada.Calendar.Delays\n-\n-     RE_Clock,                           -- Ada.Real_Time\n-     RE_Time_Span,                       -- Ada.Real_Time\n-     RE_Time_Span_Zero,                  -- Ada.Real_Time\n-     RO_RT_Time,                         -- Ada.Real_Time\n-\n-     RO_RT_Delay_Until,                  -- Ada.Real_Time.Delays\n-     RO_RT_To_Duration,                  -- Ada.Real_Time.Delays\n-\n      RE_Integer_64,                      -- Interfaces\n      RE_Unsigned_8,                      -- Interfaces\n      RE_Unsigned_16,                     -- Interfaces\n@@ -1599,14 +1605,20 @@ package Rtsfind is\n      RO_TS_Set_Entry_Name,               -- System.Tasking.Stages\n      RE_Terminated);                     -- System.Tasking.Stages\n \n-   --  The following declarations build a table that is indexed by the\n-   --  RTE function to determine the unit containing the given entity.\n-   --  This table is sorted in order of package names.\n+   --  The following declarations build a table that is indexed by the RTE\n+   --  function to determine the unit containing the given entity. This table\n+   --  is sorted in order of package names.\n \n    RE_Unit_Table : array (RE_Id) of RTU_Id := (\n \n      RE_Null                             => RTU_Null,\n \n+     RO_CA_Time                          => Ada_Calendar,\n+\n+     RO_CA_Delay_For                     => Ada_Calendar_Delays,\n+     RO_CA_Delay_Until                   => Ada_Calendar_Delays,\n+     RO_CA_To_Duration                   => Ada_Calendar_Delays,\n+\n      RE_Set_Deadline                     => Ada_Dispatching_EDF,\n \n      RE_Code_Loc                         => Ada_Exceptions,\n@@ -1640,6 +1652,16 @@ package Rtsfind is\n \n      RE_Names                            => Ada_Interrupts_Names,\n \n+     RE_Clock                            => Ada_Real_Time,\n+     RE_Time_Span                        => Ada_Real_Time,\n+     RE_Time_Span_Zero                   => Ada_Real_Time,\n+     RO_RT_Time                          => Ada_Real_Time,\n+\n+     RO_RT_Delay_Until                   => Ada_Real_Time_Delays,\n+     RO_RT_To_Duration                   => Ada_Real_Time_Delays,\n+\n+     RE_Timing_Event                     => Ada_Real_Time_Timing_Events,\n+\n      RE_Root_Stream_Type                 => Ada_Streams,\n      RE_Stream_Element                   => Ada_Streams,\n \n@@ -1727,22 +1749,13 @@ package Rtsfind is\n      RE_TK_Tagged                        => Ada_Tags,\n      RE_TK_Task                          => Ada_Tags,\n \n+     RE_Set_Specific_Handler             => Ada_Task_Termination,\n+     RE_Specific_Handler                 => Ada_Task_Termination,\n+\n      RE_Abort_Task                       => Ada_Task_Identification,\n      RE_Current_Task                     => Ada_Task_Identification,\n      RO_AT_Task_Id                       => Ada_Task_Identification,\n \n-     RO_CA_Time                          => Ada_Calendar,\n-     RO_CA_Delay_For                     => Ada_Calendar_Delays,\n-     RO_CA_Delay_Until                   => Ada_Calendar_Delays,\n-     RO_CA_To_Duration                   => Ada_Calendar_Delays,\n-\n-     RE_Clock                            => Ada_Real_Time,\n-     RE_Time_Span                        => Ada_Real_Time,\n-     RE_Time_Span_Zero                   => Ada_Real_Time,\n-     RO_RT_Time                          => Ada_Real_Time,\n-     RO_RT_Delay_Until                   => Ada_Real_Time_Delays,\n-     RO_RT_To_Duration                   => Ada_Real_Time_Delays,\n-\n      RE_Integer_64                       => Interfaces,\n      RE_Unsigned_8                       => Interfaces,\n      RE_Unsigned_16                      => Interfaces,"}, {"sha": "bbe422377dedc9203b63cef56228b8fb0d4199ff", "filename": "gcc/ada/s-rident.ads", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fs-rident.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fs-rident.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-rident.ads?ref=5b2217f83f77747f59c910a9f4a971c147b9c51f", "patch": "@@ -89,6 +89,7 @@ package System.Rident is\n       No_Implicit_Loops,                       -- GNAT\n       No_Initialize_Scalars,                   -- GNAT\n       No_Local_Allocators,                     -- (RM H.4(8))\n+      No_Local_Timing_Events,                  -- (RM D.7(10.2/2))\n       No_Local_Protected_Objects,              -- GNAT\n       No_Nested_Finalization,                  -- (RM D.7(4))\n       No_Protected_Type_Allocators,            -- GNAT\n@@ -99,6 +100,7 @@ package System.Rident is\n       No_Requeue_Statements,                   -- GNAT\n       No_Secondary_Stack,                      -- GNAT\n       No_Select_Statements,                    -- GNAT (Ravenscar)\n+      No_Specific_Termination_Handlers,        -- (RM D.7(10.7/2))\n       No_Standard_Storage_Pools,               -- GNAT\n       No_Streams,                              -- GNAT\n       No_Task_Allocators,                      -- (RM D.7(7))"}, {"sha": "3dc47a37537b1fa9084d823ca4dddb3bc7aa0b89", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=5b2217f83f77747f59c910a9f4a971c147b9c51f", "patch": "@@ -3064,6 +3064,14 @@ package body Sem_Ch3 is\n       then\n          Set_In_Private_Part (Id);\n       end if;\n+\n+      --  Check for violation of No_Local_Timing_Events\n+\n+      if Is_RTE (Etype (Id), RE_Timing_Event)\n+        and then not Is_Library_Level_Entity (Id)\n+      then\n+         Check_Restriction (No_Local_Timing_Events, N);\n+      end if;\n    end Analyze_Object_Declaration;\n \n    ---------------------------"}, {"sha": "d1f2cefc803aaa9dca83a0dba2a9a7d8cba6f810", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5b2217f83f77747f59c910a9f4a971c147b9c51f/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=5b2217f83f77747f59c910a9f4a971c147b9c51f", "patch": "@@ -5146,6 +5146,15 @@ package body Sem_Res is\n          Check_Intrinsic_Call (N);\n       end if;\n \n+      --  Check for violation of restriction No_Specific_Termination_Handlers\n+\n+      if Is_RTE (Nam, RE_Set_Specific_Handler)\n+           or else\n+         Is_RTE (Nam, RE_Specific_Handler)\n+      then\n+         Check_Restriction (No_Specific_Termination_Handlers, N);\n+      end if;\n+\n       --  All done, evaluate call and deal with elaboration issues\n \n       Eval_Call (N);"}]}