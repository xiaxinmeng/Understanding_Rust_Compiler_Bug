{"sha": "cc665e5670eee5d0a1170bb93f74e3f58be325cb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2M2NjVlNTY3MGVlZTVkMGExMTcwYmI5M2Y3NGUzZjU4YmUzMjVjYg==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2014-11-10T19:51:57Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2014-11-10T19:51:57Z"}, "message": "frv.c: Include rtl-iter.h.\n\ngcc/\n\t* config/frv/frv.c: Include rtl-iter.h.\n\t(frv_acc_group_1): Delete.\n\t(frv_acc_group): Use FOR_EACH_SUBRTX.\n\nFrom-SVN: r217309", "tree": {"sha": "7e032e0f0d5ef9baae3d06af4cbdcbf7e6b29e1d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7e032e0f0d5ef9baae3d06af4cbdcbf7e6b29e1d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cc665e5670eee5d0a1170bb93f74e3f58be325cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc665e5670eee5d0a1170bb93f74e3f58be325cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cc665e5670eee5d0a1170bb93f74e3f58be325cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cc665e5670eee5d0a1170bb93f74e3f58be325cb/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7e8e4cf945564580bb3dced55d12619a2e48664a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e8e4cf945564580bb3dced55d12619a2e48664a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e8e4cf945564580bb3dced55d12619a2e48664a"}], "stats": {"total": 46, "additions": 24, "deletions": 22}, "files": [{"sha": "505d8cf6c0379de42c87cad05c3c9da7bb777c76", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc665e5670eee5d0a1170bb93f74e3f58be325cb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc665e5670eee5d0a1170bb93f74e3f58be325cb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cc665e5670eee5d0a1170bb93f74e3f58be325cb", "patch": "@@ -1,3 +1,9 @@\n+2014-11-10  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* config/frv/frv.c: Include rtl-iter.h.\n+\t(frv_acc_group_1): Delete.\n+\t(frv_acc_group): Use FOR_EACH_SUBRTX.\n+\n 2014-11-10  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* config/frv/frv.c: Move include of rtl.h after hard-reg-set.h."}, {"sha": "46ada4ce1b6a7c6555f0699b370972fe5f33a86d", "filename": "gcc/config/frv/frv.c", "status": "modified", "additions": 18, "deletions": 22, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cc665e5670eee5d0a1170bb93f74e3f58be325cb/gcc%2Fconfig%2Ffrv%2Ffrv.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cc665e5670eee5d0a1170bb93f74e3f58be325cb/gcc%2Fconfig%2Ffrv%2Ffrv.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ffrv%2Ffrv.c?ref=cc665e5670eee5d0a1170bb93f74e3f58be325cb", "patch": "@@ -67,6 +67,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"dumpfile.h\"\n #include \"builtins.h\"\n #include \"ifcvt.h\"\n+#include \"rtl-iter.h\"\n \n #ifndef FRV_INLINE\n #define FRV_INLINE inline\n@@ -338,7 +339,6 @@ static rtx frv_emit_comparison\t\t\t(enum rtx_code, rtx, rtx);\n static void frv_ifcvt_add_insn\t\t\t(rtx, rtx, int);\n static rtx frv_ifcvt_rewrite_mem\t\t(rtx, machine_mode, rtx);\n static rtx frv_ifcvt_load_value\t\t\t(rtx, rtx);\n-static int frv_acc_group_1\t\t\t(rtx *, void *);\n static unsigned int frv_insn_unit\t\t(rtx_insn *);\n static bool frv_issues_to_branch_unit_p\t\t(rtx_insn *);\n static int frv_cond_flags \t\t\t(rtx);\n@@ -7013,33 +7013,29 @@ frv_issue_rate (void)\n     }\n }\n \f\n-/* A for_each_rtx callback.  If X refers to an accumulator, return\n-   ACC_GROUP_ODD if the bit 2 of the register number is set and\n-   ACC_GROUP_EVEN if it is clear.  Return 0 (ACC_GROUP_NONE)\n-   otherwise.  */\n-\n-static int\n-frv_acc_group_1 (rtx *x, void *data ATTRIBUTE_UNUSED)\n-{\n-  if (REG_P (*x))\n-    {\n-      if (ACC_P (REGNO (*x)))\n-\treturn (REGNO (*x) - ACC_FIRST) & 4 ? ACC_GROUP_ODD : ACC_GROUP_EVEN;\n-      if (ACCG_P (REGNO (*x)))\n-\treturn (REGNO (*x) - ACCG_FIRST) & 4 ? ACC_GROUP_ODD : ACC_GROUP_EVEN;\n-    }\n-  return 0;\n-}\n-\n /* Return the value of INSN's acc_group attribute.  */\n \n int\n frv_acc_group (rtx insn)\n {\n   /* This distinction only applies to the FR550 packing constraints.  */\n-  if (frv_cpu_type != FRV_CPU_FR550)\n-    return ACC_GROUP_NONE;\n-  return for_each_rtx (&PATTERN (insn), frv_acc_group_1, 0);\n+  if (frv_cpu_type == FRV_CPU_FR550)\n+    {\n+      subrtx_iterator::array_type array;\n+      FOR_EACH_SUBRTX (iter, array, PATTERN (insn), NONCONST)\n+\tif (REG_P (*iter))\n+\t  {\n+\t    unsigned int regno = REGNO (*iter);\n+\t    /* If REGNO refers to an accumulator, return ACC_GROUP_ODD if\n+\t       the bit 2 of the register number is set and ACC_GROUP_EVEN if\n+\t       it is clear.  */\n+\t    if (ACC_P (regno))\n+\t      return (regno - ACC_FIRST) & 4 ? ACC_GROUP_ODD : ACC_GROUP_EVEN;\n+\t    if (ACCG_P (regno))\n+\t      return (regno - ACCG_FIRST) & 4 ? ACC_GROUP_ODD : ACC_GROUP_EVEN;\n+\t  }\n+    }\n+  return ACC_GROUP_NONE;\n }\n \n /* Return the index of the DFA unit in FRV_UNIT_NAMES[] that instruction"}]}