{"sha": "df85baa5687170cbca8450a59cf17f3157b1d61d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGY4NWJhYTU2ODcxNzBjYmNhODQ1MGE1OWNmMTdmMzE1N2IxZDYxZA==", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2021-07-09T03:00:18Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2021-07-09T03:00:18Z"}, "message": "test/rs6000: Add case to cover vector division\n\nThis patch is to add one test case to check if vectorizer\ncan exploit vector division instrutions newly introduced\nby Power10.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.target/powerpc/div-vectorize-1.c: New test.", "tree": {"sha": "e0276473e55b3742ec19db524275bb90c97bd683", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e0276473e55b3742ec19db524275bb90c97bd683"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/df85baa5687170cbca8450a59cf17f3157b1d61d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df85baa5687170cbca8450a59cf17f3157b1d61d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df85baa5687170cbca8450a59cf17f3157b1d61d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df85baa5687170cbca8450a59cf17f3157b1d61d/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c3d1aa891cbc4d78408481d528d8f0927c2a0379", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3d1aa891cbc4d78408481d528d8f0927c2a0379", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3d1aa891cbc4d78408481d528d8f0927c2a0379"}], "stats": {"total": 46, "additions": 46, "deletions": 0}, "files": [{"sha": "6208b2dc1f6ff7812cd4cf2f5ed88310f22b08ae", "filename": "gcc/testsuite/gcc.target/powerpc/div-vectorize-1.c", "status": "added", "additions": 46, "deletions": 0, "changes": 46, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df85baa5687170cbca8450a59cf17f3157b1d61d/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fdiv-vectorize-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df85baa5687170cbca8450a59cf17f3157b1d61d/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fdiv-vectorize-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fdiv-vectorize-1.c?ref=df85baa5687170cbca8450a59cf17f3157b1d61d", "patch": "@@ -0,0 +1,46 @@\n+/* { dg-require-effective-target power10_ok } */\n+/* { dg-options \"-mdejagnu-cpu=power10 -O2 -ftree-vectorize -fno-vect-cost-model -fno-unroll-loops -fdump-tree-vect-details\" } */\n+\n+/* Test vectorizer can exploit ISA 3.1 instructions Vector Divide\n+   Signed/Unsigned Word/Doubleword for word/doubleword division.  */\n+\n+#define N 128\n+\n+extern signed int si_a[N], si_b[N], si_c[N];\n+extern unsigned int ui_a[N], ui_b[N], ui_c[N];\n+extern signed long long sd_a[N], sd_b[N], sd_c[N];\n+extern unsigned long long ud_a[N], ud_b[N], ud_c[N];\n+\n+__attribute__ ((noipa)) void\n+test_si ()\n+{\n+  for (int i = 0; i < N; i++)\n+    si_c[i] = si_a[i] / si_b[i];\n+}\n+\n+__attribute__ ((noipa)) void\n+test_ui ()\n+{\n+  for (int i = 0; i < N; i++)\n+    ui_c[i] = ui_a[i] / ui_b[i];\n+}\n+\n+__attribute__ ((noipa)) void\n+test_sd ()\n+{\n+  for (int i = 0; i < N; i++)\n+    sd_c[i] = sd_a[i] / sd_b[i];\n+}\n+\n+__attribute__ ((noipa)) void\n+test_ud ()\n+{\n+  for (int i = 0; i < N; i++)\n+    ud_c[i] = ud_a[i] / ud_b[i];\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"vectorized 1 loops\" 4 \"vect\" } } */\n+/* { dg-final { scan-assembler-times {\\mvdivsw\\M} 1 } } */\n+/* { dg-final { scan-assembler-times {\\mvdivuw\\M} 1 } } */\n+/* { dg-final { scan-assembler-times {\\mvdivsd\\M} 1 } } */\n+/* { dg-final { scan-assembler-times {\\mvdivud\\M} 1 } } */"}]}