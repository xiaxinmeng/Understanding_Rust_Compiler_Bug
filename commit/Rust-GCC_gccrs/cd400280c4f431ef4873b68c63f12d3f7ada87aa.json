{"sha": "cd400280c4f431ef4873b68c63f12d3f7ada87aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2Q0MDAyODBjNGY0MzFlZjQ4NzNiNjhjNjNmMTJkM2Y3YWRhODdhYQ==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2010-11-18T21:08:38Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2010-11-18T21:08:38Z"}, "message": "re PR middle-end/46515 (Many libjava failures)\n\nPR middle-end/46515\n        * function.c (maybe_copy_prologue_epilogue_insn): Rename from\n        maybe_copy_epilogue_insn; handle prologue insns as well.\n        * rtl.h, cfglayout.c: Update for rename.\n        * recog.c (peep2_attempt): Copy prologue/epilogue data for\n        RTX_FRAME_RELATED_P insns.\n\nFrom-SVN: r166920", "tree": {"sha": "ac49e6991cf94a0226441d0291cf1772f162ce65", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ac49e6991cf94a0226441d0291cf1772f162ce65"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cd400280c4f431ef4873b68c63f12d3f7ada87aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd400280c4f431ef4873b68c63f12d3f7ada87aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd400280c4f431ef4873b68c63f12d3f7ada87aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd400280c4f431ef4873b68c63f12d3f7ada87aa/comments", "author": null, "committer": null, "parents": [{"sha": "df61e411f74162840e168dd21f6d6905890c28d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df61e411f74162840e168dd21f6d6905890c28d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df61e411f74162840e168dd21f6d6905890c28d6"}], "stats": {"total": 37, "additions": 28, "deletions": 9}, "files": [{"sha": "62adb269db068be134ea173d2ddbc138ecc71556", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cd400280c4f431ef4873b68c63f12d3f7ada87aa", "patch": "@@ -1,3 +1,12 @@\n+2010-11-18  Richard Henderson  <rth@redhat.com>\n+\n+\tPR middle-end/46515\n+\t* function.c (maybe_copy_prologue_epilogue_insn): Rename from\n+\tmaybe_copy_epilogue_insn; handle prologue insns as well.\n+\t* rtl.h, cfglayout.c: Update for rename.\n+\t* recog.c (peep2_attempt): Copy prologue/epilogue data for\n+\tRTX_FRAME_RELATED_P insns.\n+\n 2010-11-18  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/46534"}, {"sha": "e883af4afabd337ab28d80caa85de91fe2c0565c", "filename": "gcc/cfglayout.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Fcfglayout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Fcfglayout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfglayout.c?ref=cd400280c4f431ef4873b68c63f12d3f7ada87aa", "patch": "@@ -1179,7 +1179,7 @@ duplicate_insn_chain (rtx from, rtx to)\n \t      || GET_CODE (PATTERN (insn)) == ADDR_DIFF_VEC)\n \t    break;\n \t  copy = emit_copy_of_insn_after (insn, get_last_insn ());\n-          maybe_copy_epilogue_insn (insn, copy);\n+          maybe_copy_prologue_epilogue_insn (insn, copy);\n \t  break;\n \n \tcase CODE_LABEL:"}, {"sha": "0ed674d4b3c7bf9d7c66ac55d30d6288346879fb", "filename": "gcc/function.c", "status": "modified", "additions": 13, "deletions": 7, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=cd400280c4f431ef4873b68c63f12d3f7ada87aa", "patch": "@@ -5140,19 +5140,25 @@ record_insns (rtx insns, rtx end, htab_t *hashp)\n     }\n }\n \n-/* INSN has been duplicated as COPY, as part of duping a basic block.\n-   If INSN is an epilogue insn, then record COPY as epilogue as well.  */\n+/* INSN has been duplicated or replaced by as COPY, perhaps by duplicating a\n+   basic block, splitting or peepholes.  If INSN is a prologue or epilogue\n+   insn, then record COPY as well.  */\n \n void\n-maybe_copy_epilogue_insn (rtx insn, rtx copy)\n+maybe_copy_prologue_epilogue_insn (rtx insn, rtx copy)\n {\n+  htab_t hash;\n   void **slot;\n \n-  if (epilogue_insn_hash == NULL\n-      || htab_find (epilogue_insn_hash, insn) == NULL)\n-    return;\n+  hash = epilogue_insn_hash;\n+  if (!hash || !htab_find (hash, insn))\n+    {\n+      hash = prologue_insn_hash;\n+      if (!hash || !htab_find (hash, insn))\n+\treturn;\n+    }\n \n-  slot = htab_find_slot (epilogue_insn_hash, copy, INSERT);\n+  slot = htab_find_slot (hash, copy, INSERT);\n   gcc_assert (*slot == NULL);\n   *slot = copy;\n }"}, {"sha": "edbf82b004da3f70dc600b5b5603bcfb6a40a1e6", "filename": "gcc/recog.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Frecog.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Frecog.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frecog.c?ref=cd400280c4f431ef4873b68c63f12d3f7ada87aa", "patch": "@@ -3219,6 +3219,10 @@ peep2_attempt (basic_block bb, rtx insn, int match_len, rtx attempt)\n \t  if (!new_set || !rtx_equal_p (new_set, old_set))\n \t    add_reg_note (new_insn, REG_FRAME_RELATED_EXPR, old_set);\n \t}\n+\n+      /* Copy prologue/epilogue status.  This is required in order to keep\n+\t proper placement of EPILOGUE_BEG and the DW_CFA_remember_state.  */\n+      maybe_copy_prologue_epilogue_insn (old_insn, new_insn);\n     }\n \n   /* If we are splitting a CALL_INSN, look for the CALL_INSN"}, {"sha": "ab215d6ea480de0411771907e4245cf26469f685", "filename": "gcc/rtl.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Frtl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd400280c4f431ef4873b68c63f12d3f7ada87aa/gcc%2Frtl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frtl.h?ref=cd400280c4f431ef4873b68c63f12d3f7ada87aa", "patch": "@@ -2411,7 +2411,7 @@ extern int prologue_epilogue_contains (const_rtx);\n extern int sibcall_epilogue_contains (const_rtx);\n extern void mark_temp_addr_taken (rtx);\n extern void update_temp_slot_address (rtx, rtx);\n-extern void maybe_copy_epilogue_insn (rtx, rtx);\n+extern void maybe_copy_prologue_epilogue_insn (rtx, rtx);\n \n /* In stmt.c */\n extern void expand_null_return (void);"}]}