{"sha": "ff0a62841e27b838f17a9d6253d131206072df6f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmYwYTYyODQxZTI3YjgzOGYxN2E5ZDYyNTNkMTMxMjA2MDcyZGY2Zg==", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2020-03-06T18:19:13Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2020-03-08T14:45:14Z"}, "message": "c++: Fix pretty printing of TYPENAME_TYPEs\n\nI noticed that in some concepts diagnostic messages, we were printing typename\ntypes incorrectly, e.g. printing remove_reference_t<T> as\n\n  typename remove_reference<T>::remove_reference_t\n\ninstead of\n\n  typename remove_reference<T>::type.\n\nFix this by printing the TYPENAME_TYPE_FULLNAME instead of the TYPE_NAME in\ncxx_pretty_printer::simple_type_specifier, which is consistent with how\ndump_typename in error.c does it.\n\ngcc/cp/ChangeLog:\n\n\t* cxx-pretty-print.c (cxx_pretty_printer::simple_type_specifier)\n\t[TYPENAME_TYPE]: Print the TYPENAME_TYPE_FULLNAME instead of the\n\tTYPE_NAME.\n\ngcc/testsuite/ChangeLog:\n\n\t* g++.dg/concepts/diagnostic4.C: New test.", "tree": {"sha": "6617667089e1f6fa2ddefd4ee5050a51fc2a5be1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6617667089e1f6fa2ddefd4ee5050a51fc2a5be1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ff0a62841e27b838f17a9d6253d131206072df6f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff0a62841e27b838f17a9d6253d131206072df6f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff0a62841e27b838f17a9d6253d131206072df6f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff0a62841e27b838f17a9d6253d131206072df6f/comments", "author": null, "committer": null, "parents": [{"sha": "6733ecaf3fe77871d86bfb36bcda5497ae2aaba7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6733ecaf3fe77871d86bfb36bcda5497ae2aaba7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6733ecaf3fe77871d86bfb36bcda5497ae2aaba7"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "48ef75c732e3d3e49137f8b8dd0aa74bc90ce785", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ff0a62841e27b838f17a9d6253d131206072df6f", "patch": "@@ -1,3 +1,9 @@\n+2020-03-08  Patrick Palka  <ppalka@redhat.com>\n+\n+\t* cxx-pretty-print.c (cxx_pretty_printer::simple_type_specifier)\n+\t[TYPENAME_TYPE]: Print the TYPENAME_TYPE_FULLNAME instead of the\n+\tTYPE_NAME.\n+\n 2020-03-06  Nathan Sidwell  <nathan@acm.org>\n \n \tPR c++/94027"}, {"sha": "100154e400f61e2ac59de182b26c1e079ae3dfc8", "filename": "gcc/cp/cxx-pretty-print.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Fcp%2Fcxx-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Fcp%2Fcxx-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcxx-pretty-print.c?ref=ff0a62841e27b838f17a9d6253d131206072df6f", "patch": "@@ -1360,7 +1360,7 @@ cxx_pretty_printer::simple_type_specifier (tree t)\n     case TYPENAME_TYPE:\n       pp_cxx_ws_string (this, \"typename\");\n       pp_cxx_nested_name_specifier (this, TYPE_CONTEXT (t));\n-      pp_cxx_unqualified_id (this, TYPE_NAME (t));\n+      pp_cxx_unqualified_id (this, TYPENAME_TYPE_FULLNAME (t));\n       break;\n \n     default:"}, {"sha": "99e2e4260109bca201e71a5630528e5ac27d74e5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ff0a62841e27b838f17a9d6253d131206072df6f", "patch": "@@ -1,3 +1,7 @@\n+2020-03-08  Patrick Palka  <ppalka@redhat.com>\n+\n+\t* g++.dg/concepts/diagnostic4.C: New test.\n+\n 2020-03-08  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/89229"}, {"sha": "677bc867634784c69c778c9fdc69bf4d3dc639ff", "filename": "gcc/testsuite/g++.dg/concepts/diagnostic4.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconcepts%2Fdiagnostic4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ff0a62841e27b838f17a9d6253d131206072df6f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconcepts%2Fdiagnostic4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fconcepts%2Fdiagnostic4.C?ref=ff0a62841e27b838f17a9d6253d131206072df6f", "patch": "@@ -0,0 +1,18 @@\n+// { dg-do compile { target c++2a } }\n+\n+template<typename T>\n+  struct remove_reference\n+  { using type = T; };\n+\n+template<typename T>\n+  using remove_reference_t = remove_reference<T>::type;\n+\n+template<typename T>\n+  inline constexpr bool blah = false;\n+\n+template<typename T>\n+  requires blah<remove_reference_t<T>>\n+  // { dg-message \"typename remove_reference<T>::type\" \"\" { target *-*-* } .-1 }\n+  void foo() { }\n+\n+void bar() { foo<int> (); } // { dg-error \"use of\" }"}]}