{"sha": "a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTI1ZTBiNWU2YWM4YTc3YTcxYzIyOWUwYTdiNzQ0NjAzMzY1YjBlOQ==", "commit": {"author": {"name": "qing zhao", "email": "qing.zhao@oracle.com", "date": "2021-09-09T22:44:49Z"}, "committer": {"name": "qing zhao", "email": "qing.zhao@oracle.com", "date": "2021-09-09T22:44:49Z"}, "message": "Add -ftrivial-auto-var-init option and uninitialized variable attribute.\n\nInitialize automatic variables with either a pattern or with zeroes to increase\nthe security and predictability of a program by preventing uninitialized memory\ndisclosure and use.\nGCC still considers an automatic variable that doesn't have an explicit\ninitializer as uninitialized, -Wuninitialized will still report warning messages\non such automatic variables.\nWith this option, GCC will also initialize any padding of automatic variables\nthat have structure or union types to zeroes.\nYou can control this behavior for a specific variable by using the variable\nattribute \"uninitialized\" to control runtime overhead.\n\ngcc/ChangeLog:\n\n2021-09-09  qing zhao  <qing.zhao@oracle.com>\n\n\t* builtins.c (expand_builtin_memset): Make external visible.\n\t* builtins.h (expand_builtin_memset): Declare extern.\n\t* common.opt (ftrivial-auto-var-init=): New option.\n\t* doc/extend.texi: Document the uninitialized attribute.\n\t* doc/invoke.texi: Document -ftrivial-auto-var-init.\n\t* flag-types.h (enum auto_init_type): New enumerated type\n\tauto_init_type.\n\t* gimple-fold.c (clear_padding_type): Add one new parameter.\n\t(clear_padding_union): Likewise.\n\t(clear_padding_emit_loop): Likewise.\n\t(clear_type_padding_in_mask): Likewise.\n\t(gimple_fold_builtin_clear_padding): Handle this new parameter.\n\t* gimplify.c (gimple_add_init_for_auto_var): New function.\n\t(gimple_add_padding_init_for_auto_var): New function.\n\t(is_var_need_auto_init): New function.\n\t(gimplify_decl_expr): Add initialization to automatic variables per\n\tusers' requests.\n\t(gimplify_call_expr): Add one new parameter for call to\n\t__builtin_clear_padding.\n\t(gimplify_init_constructor): Add padding initialization in the end.\n\t* internal-fn.c (INIT_PATTERN_VALUE): New macro.\n\t(expand_DEFERRED_INIT): New function.\n\t* internal-fn.def (DEFERRED_INIT): New internal function.\n\t* tree-cfg.c (verify_gimple_call): Verify calls to .DEFERRED_INIT.\n\t* tree-sra.c (generate_subtree_deferred_init): New function.\n\t(scan_function): Avoid setting cannot_scalarize_away_bitmap for\n\tcalls to .DEFERRED_INIT.\n\t(sra_modify_deferred_init): New function.\n\t(sra_modify_function_body): Handle calls to DEFERRED_INIT specially.\n\t* tree-ssa-structalias.c (find_func_aliases_for_call): Likewise.\n\t* tree-ssa-uninit.c (warn_uninit): Handle calls to DEFERRED_INIT\n\tspecially.\n\t(check_defs): Likewise.\n\t(warn_uninitialized_vars): Likewise.\n\t* tree-ssa.c (ssa_undefined_value_p): Likewise.\n\t* tree.c (build_common_builtin_nodes): Build tree node for\n\tBUILT_IN_CLEAR_PADDING when needed.\n\ngcc/c-family/ChangeLog:\n\n2021-09-09  qing zhao  <qing.zhao@oracle.com>\n\n\t* c-attribs.c (handle_uninitialized_attribute): New function.\n\t(c_common_attribute_table): Add \"uninitialized\" attribute.\n\ngcc/testsuite/ChangeLog:\n\n2021-09-09  qing zhao  <qing.zhao@oracle.com>\n\n\t* c-c++-common/auto-init-1.c: New test.\n\t* c-c++-common/auto-init-10.c: New test.\n\t* c-c++-common/auto-init-11.c: New test.\n\t* c-c++-common/auto-init-12.c: New test.\n\t* c-c++-common/auto-init-13.c: New test.\n\t* c-c++-common/auto-init-14.c: New test.\n\t* c-c++-common/auto-init-15.c: New test.\n\t* c-c++-common/auto-init-16.c: New test.\n\t* c-c++-common/auto-init-2.c: New test.\n\t* c-c++-common/auto-init-3.c: New test.\n\t* c-c++-common/auto-init-4.c: New test.\n\t* c-c++-common/auto-init-5.c: New test.\n\t* c-c++-common/auto-init-6.c: New test.\n\t* c-c++-common/auto-init-7.c: New test.\n\t* c-c++-common/auto-init-8.c: New test.\n\t* c-c++-common/auto-init-9.c: New test.\n\t* c-c++-common/auto-init-esra.c: New test.\n\t* c-c++-common/auto-init-padding-1.c: New test.\n\t* c-c++-common/auto-init-padding-2.c: New test.\n\t* c-c++-common/auto-init-padding-3.c: New test.\n\t* g++.dg/auto-init-uninit-pred-1_a.C: New test.\n\t* g++.dg/auto-init-uninit-pred-2_a.C: New test.\n\t* g++.dg/auto-init-uninit-pred-3_a.C: New test.\n\t* g++.dg/auto-init-uninit-pred-4.C: New test.\n\t* gcc.dg/auto-init-sra-1.c: New test.\n\t* gcc.dg/auto-init-sra-2.c: New test.\n\t* gcc.dg/auto-init-uninit-1.c: New test.\n\t* gcc.dg/auto-init-uninit-12.c: New test.\n\t* gcc.dg/auto-init-uninit-13.c: New test.\n\t* gcc.dg/auto-init-uninit-14.c: New test.\n\t* gcc.dg/auto-init-uninit-15.c: New test.\n\t* gcc.dg/auto-init-uninit-16.c: New test.\n\t* gcc.dg/auto-init-uninit-17.c: New test.\n\t* gcc.dg/auto-init-uninit-18.c: New test.\n\t* gcc.dg/auto-init-uninit-19.c: New test.\n\t* gcc.dg/auto-init-uninit-2.c: New test.\n\t* gcc.dg/auto-init-uninit-20.c: New test.\n\t* gcc.dg/auto-init-uninit-21.c: New test.\n\t* gcc.dg/auto-init-uninit-22.c: New test.\n\t* gcc.dg/auto-init-uninit-23.c: New test.\n\t* gcc.dg/auto-init-uninit-24.c: New test.\n\t* gcc.dg/auto-init-uninit-25.c: New test.\n\t* gcc.dg/auto-init-uninit-26.c: New test.\n\t* gcc.dg/auto-init-uninit-3.c: New test.\n\t* gcc.dg/auto-init-uninit-34.c: New test.\n\t* gcc.dg/auto-init-uninit-36.c: New test.\n\t* gcc.dg/auto-init-uninit-37.c: New test.\n\t* gcc.dg/auto-init-uninit-4.c: New test.\n\t* gcc.dg/auto-init-uninit-5.c: New test.\n\t* gcc.dg/auto-init-uninit-6.c: New test.\n\t* gcc.dg/auto-init-uninit-8.c: New test.\n\t* gcc.dg/auto-init-uninit-9.c: New test.\n\t* gcc.dg/auto-init-uninit-A.c: New test.\n\t* gcc.dg/auto-init-uninit-B.c: New test.\n\t* gcc.dg/auto-init-uninit-C.c: New test.\n\t* gcc.dg/auto-init-uninit-H.c: New test.\n\t* gcc.dg/auto-init-uninit-I.c: New test.\n\t* gcc.target/aarch64/auto-init-1.c: New test.\n\t* gcc.target/aarch64/auto-init-2.c: New test.\n\t* gcc.target/aarch64/auto-init-3.c: New test.\n\t* gcc.target/aarch64/auto-init-4.c: New test.\n\t* gcc.target/aarch64/auto-init-5.c: New test.\n\t* gcc.target/aarch64/auto-init-6.c: New test.\n\t* gcc.target/aarch64/auto-init-7.c: New test.\n\t* gcc.target/aarch64/auto-init-8.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-1.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-10.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-11.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-12.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-2.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-3.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-4.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-5.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-6.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-7.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-8.c: New test.\n\t* gcc.target/aarch64/auto-init-padding-9.c: New test.\n\t* gcc.target/i386/auto-init-1.c: New test.\n\t* gcc.target/i386/auto-init-2.c: New test.\n\t* gcc.target/i386/auto-init-21.c: New test.\n\t* gcc.target/i386/auto-init-22.c: New test.\n\t* gcc.target/i386/auto-init-23.c: New test.\n\t* gcc.target/i386/auto-init-24.c: New test.\n\t* gcc.target/i386/auto-init-3.c: New test.\n\t* gcc.target/i386/auto-init-4.c: New test.\n\t* gcc.target/i386/auto-init-5.c: New test.\n\t* gcc.target/i386/auto-init-6.c: New test.\n\t* gcc.target/i386/auto-init-7.c: New test.\n\t* gcc.target/i386/auto-init-8.c: New test.\n\t* gcc.target/i386/auto-init-padding-1.c: New test.\n\t* gcc.target/i386/auto-init-padding-10.c: New test.\n\t* gcc.target/i386/auto-init-padding-11.c: New test.\n\t* gcc.target/i386/auto-init-padding-12.c: New test.\n\t* gcc.target/i386/auto-init-padding-2.c: New test.\n\t* gcc.target/i386/auto-init-padding-3.c: New test.\n\t* gcc.target/i386/auto-init-padding-4.c: New test.\n\t* gcc.target/i386/auto-init-padding-5.c: New test.\n\t* gcc.target/i386/auto-init-padding-6.c: New test.\n\t* gcc.target/i386/auto-init-padding-7.c: New test.\n\t* gcc.target/i386/auto-init-padding-8.c: New test.\n\t* gcc.target/i386/auto-init-padding-9.c: New test.", "tree": {"sha": "e46dad7fa274dc376be2ccf4735b5333c5d34315", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e46dad7fa274dc376be2ccf4735b5333c5d34315"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/comments", "author": {"login": "qingzhao69", "id": 89154636, "node_id": "MDQ6VXNlcjg5MTU0NjM2", "avatar_url": "https://avatars.githubusercontent.com/u/89154636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qingzhao69", "html_url": "https://github.com/qingzhao69", "followers_url": "https://api.github.com/users/qingzhao69/followers", "following_url": "https://api.github.com/users/qingzhao69/following{/other_user}", "gists_url": "https://api.github.com/users/qingzhao69/gists{/gist_id}", "starred_url": "https://api.github.com/users/qingzhao69/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qingzhao69/subscriptions", "organizations_url": "https://api.github.com/users/qingzhao69/orgs", "repos_url": "https://api.github.com/users/qingzhao69/repos", "events_url": "https://api.github.com/users/qingzhao69/events{/privacy}", "received_events_url": "https://api.github.com/users/qingzhao69/received_events", "type": "User", "site_admin": false}, "committer": {"login": "qingzhao69", "id": 89154636, "node_id": "MDQ6VXNlcjg5MTU0NjM2", "avatar_url": "https://avatars.githubusercontent.com/u/89154636?v=4", "gravatar_id": "", "url": "https://api.github.com/users/qingzhao69", "html_url": "https://github.com/qingzhao69", "followers_url": "https://api.github.com/users/qingzhao69/followers", "following_url": "https://api.github.com/users/qingzhao69/following{/other_user}", "gists_url": "https://api.github.com/users/qingzhao69/gists{/gist_id}", "starred_url": "https://api.github.com/users/qingzhao69/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/qingzhao69/subscriptions", "organizations_url": "https://api.github.com/users/qingzhao69/orgs", "repos_url": "https://api.github.com/users/qingzhao69/repos", "events_url": "https://api.github.com/users/qingzhao69/events{/privacy}", "received_events_url": "https://api.github.com/users/qingzhao69/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5fe0865ab788bdc387b284a3ad57e5a95a767b18", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fe0865ab788bdc387b284a3ad57e5a95a767b18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fe0865ab788bdc387b284a3ad57e5a95a767b18"}], "stats": {"total": 3175, "additions": 3131, "deletions": 44}, "files": [{"sha": "3e57eb03af039f6a1ee5d390f0ab630c54b70cdd", "filename": "gcc/builtins.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fbuiltins.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fbuiltins.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -142,7 +142,6 @@ static rtx expand_builtin_strcpy (tree, rtx);\n static rtx expand_builtin_strcpy_args (tree, tree, tree, rtx);\n static rtx expand_builtin_stpcpy (tree, rtx, machine_mode);\n static rtx expand_builtin_strncpy (tree, rtx);\n-static rtx expand_builtin_memset (tree, rtx, machine_mode);\n static rtx expand_builtin_memset_args (tree, tree, tree, rtx, machine_mode, tree);\n static rtx expand_builtin_bzero (tree);\n static rtx expand_builtin_strlen (tree, rtx, machine_mode);\n@@ -3872,7 +3871,7 @@ builtin_memset_gen_str (void *data, void *prev,\n    try to get the result in TARGET, if convenient (and in mode MODE if that's\n    convenient).  */\n \n-static rtx\n+rtx\n expand_builtin_memset (tree exp, rtx target, machine_mode mode)\n {\n   if (!validate_arglist (exp,"}, {"sha": "d330b78e5917af281ec51ca1322c40cbdea5b749", "filename": "gcc/builtins.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fbuiltins.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fbuiltins.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbuiltins.h?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -114,6 +114,7 @@ extern rtx builtin_strncpy_read_str (void *, void *, HOST_WIDE_INT,\n \t\t\t\t     fixed_size_mode);\n extern rtx builtin_memset_read_str (void *, void *, HOST_WIDE_INT,\n \t\t\t\t    fixed_size_mode);\n+extern rtx expand_builtin_memset (tree, rtx, machine_mode);\n extern rtx expand_builtin_saveregs (void);\n extern tree std_build_builtin_va_list (void);\n extern tree std_fn_abi_va_list (tree);"}, {"sha": "007b928c54b8c40ea15b87830ed7956f07ecf550", "filename": "gcc/c-family/c-attribs.c", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fc-family%2Fc-attribs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fc-family%2Fc-attribs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-attribs.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -83,6 +83,7 @@ static tree handle_artificial_attribute (tree *, tree, tree, int, bool *);\n static tree handle_flatten_attribute (tree *, tree, tree, int, bool *);\n static tree handle_error_attribute (tree *, tree, tree, int, bool *);\n static tree handle_used_attribute (tree *, tree, tree, int, bool *);\n+static tree handle_uninitialized_attribute (tree *, tree, tree, int, bool *);\n static tree handle_externally_visible_attribute (tree *, tree, tree, int,\n \t\t\t\t\t\t bool *);\n static tree handle_no_reorder_attribute (tree *, tree, tree, int,\n@@ -333,6 +334,8 @@ const struct attribute_spec c_common_attribute_table[] =\n \t\t\t      handle_used_attribute, NULL },\n   { \"unused\",                 0, 0, false, false, false, false,\n \t\t\t      handle_unused_attribute, NULL },\n+  { \"uninitialized\",\t      0, 0, true, false, false, false,\n+\t\t\t      handle_uninitialized_attribute, NULL },\n   { \"retain\",                 0, 0, true,  false, false, false,\n \t\t\t      handle_retain_attribute, NULL },\n   { \"externally_visible\",     0, 0, true,  false, false, false,\n@@ -1617,6 +1620,30 @@ handle_retain_attribute (tree *pnode, tree name, tree ARG_UNUSED (args),\n   return NULL_TREE;\n }\n \n+/* Handle an \"uninitialized\" attribute; arguments as in\n+   struct attribute_spec.handler.  */\n+\n+static tree\n+handle_uninitialized_attribute (tree *node, tree name, tree ARG_UNUSED (args),\n+\t\t\t\tint ARG_UNUSED (flags), bool *no_add_attrs)\n+{\n+  tree decl = *node;\n+  if (!VAR_P (decl))\n+    {\n+      warning (OPT_Wattributes, \"%qE attribute ignored because %qD \"\n+\t       \"is not a variable\", name, decl);\n+      *no_add_attrs = true;\n+    }\n+  else if (TREE_STATIC (decl) || DECL_EXTERNAL (decl))\n+    {\n+      warning (OPT_Wattributes, \"%qE attribute ignored because %qD \"\n+\t       \"is not a local variable\", name, decl);\n+      *no_add_attrs = true;\n+    }\n+\n+  return NULL_TREE;\n+}\n+\n /* Handle a \"externally_visible\" attribute; arguments as in\n    struct attribute_spec.handler.  */\n "}, {"sha": "b921f5e3b255e6eb2083c87ccc997391edca4497", "filename": "gcc/common.opt", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fcommon.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fcommon.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon.opt?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -3081,6 +3081,22 @@ ftree-scev-cprop\n Common Var(flag_tree_scev_cprop) Init(1) Optimization\n Enable copy propagation of scalar-evolution information.\n \n+ftrivial-auto-var-init=\n+Common Joined RejectNegative Enum(auto_init_type) Var(flag_auto_var_init) Init(AUTO_INIT_UNINITIALIZED) Optimization\n+-ftrivial-auto-var-init=[uninitialized|pattern|zero]\tAdd initializations to automatic variables.\n+\n+Enum\n+Name(auto_init_type) Type(enum auto_init_type) UnknownError(unrecognized automatic variable initialization type %qs)\n+\n+EnumValue\n+Enum(auto_init_type) String(uninitialized) Value(AUTO_INIT_UNINITIALIZED)\n+\n+EnumValue\n+Enum(auto_init_type) String(pattern) Value(AUTO_INIT_PATTERN)\n+\n+EnumValue\n+Enum(auto_init_type) String(zero) Value(AUTO_INIT_ZERO)\n+\n ; -fverbose-asm causes extra commentary information to be produced in\n ; the generated assembly code (to make it more readable).  This option\n ; is generally only of use to those who actually need to read the"}, {"sha": "8b324a097a4d6da00102e2b1729e05c2d2d64c39", "filename": "gcc/doc/extend.texi", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fdoc%2Fextend.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fdoc%2Fextend.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fextend.texi?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -7610,6 +7610,22 @@ will be placed in new, unique sections.\n \n This additional functionality requires Binutils version 2.36 or later.\n \n+@item uninitialized\n+@cindex @code{uninitialized} variable attribute\n+This attribute, attached to a variable with automatic storage, means that\n+the variable should not be automatically initialized by the compiler when\n+the option @code{-ftrivial-auto-var-init} presents.\n+\n+With the option @code{-ftrivial-auto-var-init}, all the automatic variables\n+that do not have explicit initializers will be initialized by the compiler.\n+These additional compiler initializations might incur run-time overhead,\n+sometimes dramatically.  This attribute can be used to mark some variables\n+to be excluded from such automatical initialization in order to reduce runtime\n+overhead.\n+\n+This attribute has no effect when the option @code{-ftrivial-auto-var-init}\n+does not present.\n+\n @item vector_size (@var{bytes})\n @cindex @code{vector_size} variable attribute\n This attribute specifies the vector size for the type of the declared"}, {"sha": "b08a5eb4d7330bea68ef613cf599ee7fbf023d22", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 38, "deletions": 3, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -573,9 +573,9 @@ Objective-C and Objective-C++ Dialects}.\n -ftree-parallelize-loops=@var{n}  -ftree-pre  -ftree-partial-pre  -ftree-pta @gol\n -ftree-reassoc  -ftree-scev-cprop  -ftree-sink  -ftree-slsr  -ftree-sra @gol\n -ftree-switch-conversion  -ftree-tail-merge @gol\n--ftree-ter  -ftree-vectorize  -ftree-vrp  -funconstrained-commons @gol\n--funit-at-a-time  -funroll-all-loops  -funroll-loops @gol\n--funsafe-math-optimizations  -funswitch-loops @gol\n+-ftree-ter  -ftree-vectorize  -ftree-vrp  -ftrivial-auto-var-init @gol\n+-funconstrained-commons -funit-at-a-time  -funroll-all-loops @gol\n+-funroll-loops -funsafe-math-optimizations  -funswitch-loops @gol\n -fipa-ra  -fvariable-expansion-in-unroller  -fvect-cost-model  -fvpt @gol\n -fweb  -fwhole-program  -fwpa  -fuse-linker-plugin -fzero-call-used-regs @gol\n --param @var{name}=@var{value}\n@@ -11843,6 +11843,41 @@ Perform basic block vectorization on trees. This flag is enabled by default at\n @option{-O3} and by @option{-ftree-vectorize}, @option{-fprofile-use},\n and @option{-fauto-profile}.\n \n+@item -ftrivial-auto-var-init=@var{choice}\n+@opindex ftrivial-auto-var-init\n+Initialize automatic variables with either a pattern or with zeroes to increase\n+the security and predictability of a program by preventing uninitialized memory\n+disclosure and use.\n+GCC still considers an automatic variable that doesn't have an explicit\n+initializer as uninitialized, -Wuninitialized will still report warning messages\n+on such automatic variables.\n+With this option, GCC will also initialize any padding of automatic variables\n+that have structure or union types to zeroes.\n+\n+The three values of @var{choice} are:\n+\n+@itemize @bullet\n+@item\n+@samp{uninitialized} doesn't initialize any automatic variables.\n+This is C and C++'s default.\n+\n+@item\n+@samp{pattern} Initialize automatic variables with values which will likely\n+transform logic bugs into crashes down the line, are easily recognized in a\n+crash dump and without being values that programmers can rely on for useful\n+program semantics.\n+The current value is byte-repeatable pattern with byte \"0xFE\".\n+The values used for pattern initialization might be changed in the future.\n+\n+@item\n+@samp{zero} Initialize automatic variables with zeroes.\n+@end itemize\n+\n+The default is @samp{uninitialized}.\n+\n+You can control this behavior for a specific variable by using the variable\n+attribute @code{uninitialized} (@pxref{Variable Attributes}).\n+\n @item -fvect-cost-model=@var{model}\n @opindex fvect-cost-model\n Alter the cost model used for vectorization.  The @var{model} argument"}, {"sha": "5bd1f771c8bdd9657925c5096b186d60b92db9e5", "filename": "gcc/flag-types.h", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fflag-types.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fflag-types.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fflag-types.h?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -281,6 +281,13 @@ enum vect_cost_model {\n   VECT_COST_MODEL_DEFAULT = 1\n };\n \n+/* Automatic variable initialization type.  */\n+enum auto_init_type {\n+  AUTO_INIT_UNINITIALIZED = 0,\n+  AUTO_INIT_PATTERN = 1,\n+  AUTO_INIT_ZERO = 2\n+};\n+\n /* Different instrumentation modes.  */\n enum sanitize_code {\n   /* AddressSanitizer.  */"}, {"sha": "dd0e6b5daffa7ff7ce3f2acd67fd734a832b2ab4", "filename": "gcc/gimple-fold.c", "status": "modified", "additions": 34, "deletions": 20, "changes": 54, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fgimple-fold.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fgimple-fold.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-fold.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -4518,12 +4518,14 @@ clear_padding_add_padding (clear_padding_struct *buf,\n     }\n }\n \n-static void clear_padding_type (clear_padding_struct *, tree, HOST_WIDE_INT);\n+static void clear_padding_type (clear_padding_struct *, tree,\n+\t\t\t\tHOST_WIDE_INT, bool);\n \n /* Clear padding bits of union type TYPE.  */\n \n static void\n-clear_padding_union (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n+clear_padding_union (clear_padding_struct *buf, tree type,\n+\t\t     HOST_WIDE_INT sz, bool for_auto_init)\n {\n   clear_padding_struct *union_buf;\n   HOST_WIDE_INT start_off = 0, next_off = 0;\n@@ -4568,7 +4570,7 @@ clear_padding_union (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n \t      continue;\n \t    gcc_assert (TREE_CODE (TREE_TYPE (field)) == ARRAY_TYPE\n \t\t\t&& !COMPLETE_TYPE_P (TREE_TYPE (field)));\n-\t    if (!buf->clear_in_mask)\n+\t    if (!buf->clear_in_mask && !for_auto_init)\n \t      error_at (buf->loc, \"flexible array member %qD does not have \"\n \t\t\t\t  \"well defined padding bits for %qs\",\n \t\t\tfield, \"__builtin_clear_padding\");\n@@ -4579,7 +4581,7 @@ clear_padding_union (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n \tunion_buf->off = start_off;\n \tunion_buf->size = start_size;\n \tmemset (union_buf->buf, ~0, start_size);\n-\tclear_padding_type (union_buf, TREE_TYPE (field), fldsz);\n+\tclear_padding_type (union_buf, TREE_TYPE (field), fldsz, for_auto_init);\n \tclear_padding_add_padding (union_buf, sz - fldsz);\n \tclear_padding_flush (union_buf, true);\n       }\n@@ -4649,7 +4651,8 @@ clear_padding_type_may_have_padding_p (tree type)\n      __builtin_clear_padding (buf.base);  */\n \n static void\n-clear_padding_emit_loop (clear_padding_struct *buf, tree type, tree end)\n+clear_padding_emit_loop (clear_padding_struct *buf, tree type,\n+\t\t\t tree end, bool for_auto_init)\n {\n   tree l1 = create_artificial_label (buf->loc);\n   tree l2 = create_artificial_label (buf->loc);\n@@ -4660,7 +4663,7 @@ clear_padding_emit_loop (clear_padding_struct *buf, tree type, tree end)\n   g = gimple_build_label (l1);\n   gimple_set_location (g, buf->loc);\n   gsi_insert_before (buf->gsi, g, GSI_SAME_STMT);\n-  clear_padding_type (buf, type, buf->sz);\n+  clear_padding_type (buf, type, buf->sz, for_auto_init);\n   clear_padding_flush (buf, true);\n   g = gimple_build_assign (buf->base, POINTER_PLUS_EXPR, buf->base,\n \t\t\t   size_int (buf->sz));\n@@ -4678,10 +4681,16 @@ clear_padding_emit_loop (clear_padding_struct *buf, tree type, tree end)\n }\n \n /* Clear padding bits for TYPE.  Called recursively from\n-   gimple_fold_builtin_clear_padding.  */\n+   gimple_fold_builtin_clear_padding.  If FOR_AUTO_INIT is true,\n+   the __builtin_clear_padding is not called by the end user,\n+   instead, it's inserted by the compiler to initialize the\n+   paddings of automatic variable.  Therefore, we should not\n+   emit the error messages for flexible array members to confuse\n+   the end user.  */\n \n static void\n-clear_padding_type (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n+clear_padding_type (clear_padding_struct *buf, tree type,\n+\t\t    HOST_WIDE_INT sz, bool for_auto_init)\n {\n   switch (TREE_CODE (type))\n     {\n@@ -4765,7 +4774,7 @@ clear_padding_type (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n \t\t  continue;\n \t\tgcc_assert (TREE_CODE (ftype) == ARRAY_TYPE\n \t\t\t    && !COMPLETE_TYPE_P (ftype));\n-\t\tif (!buf->clear_in_mask)\n+\t\tif (!buf->clear_in_mask && !for_auto_init)\n \t\t  error_at (buf->loc, \"flexible array member %qD does not \"\n \t\t\t\t      \"have well defined padding bits for %qs\",\n \t\t\t    field, \"__builtin_clear_padding\");\n@@ -4781,7 +4790,8 @@ clear_padding_type (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n \t\tgcc_assert (pos >= 0 && fldsz >= 0 && pos >= cur_pos);\n \t\tclear_padding_add_padding (buf, pos - cur_pos);\n \t\tcur_pos = pos;\n-\t\tclear_padding_type (buf, TREE_TYPE (field), fldsz);\n+\t\tclear_padding_type (buf, TREE_TYPE (field),\n+\t\t\t\t    fldsz, for_auto_init);\n \t\tcur_pos += fldsz;\n \t      }\n \t  }\n@@ -4821,7 +4831,7 @@ clear_padding_type (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n \t  buf->align = TYPE_ALIGN (elttype);\n \t  buf->off = 0;\n \t  buf->size = 0;\n-\t  clear_padding_emit_loop (buf, elttype, end);\n+\t  clear_padding_emit_loop (buf, elttype, end, for_auto_init);\n \t  buf->base = base;\n \t  buf->sz = prev_sz;\n \t  buf->align = prev_align;\n@@ -4831,10 +4841,10 @@ clear_padding_type (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n \t  break;\n \t}\n       for (HOST_WIDE_INT i = 0; i < nelts; i++)\n-\tclear_padding_type (buf, TREE_TYPE (type), fldsz);\n+\tclear_padding_type (buf, TREE_TYPE (type), fldsz, for_auto_init);\n       break;\n     case UNION_TYPE:\n-      clear_padding_union (buf, type, sz);\n+      clear_padding_union (buf, type, sz, for_auto_init);\n       break;\n     case REAL_TYPE:\n       gcc_assert ((size_t) sz <= clear_padding_unit);\n@@ -4858,14 +4868,14 @@ clear_padding_type (clear_padding_struct *buf, tree type, HOST_WIDE_INT sz)\n       break;\n     case COMPLEX_TYPE:\n       fldsz = int_size_in_bytes (TREE_TYPE (type));\n-      clear_padding_type (buf, TREE_TYPE (type), fldsz);\n-      clear_padding_type (buf, TREE_TYPE (type), fldsz);\n+      clear_padding_type (buf, TREE_TYPE (type), fldsz, for_auto_init);\n+      clear_padding_type (buf, TREE_TYPE (type), fldsz, for_auto_init);\n       break;\n     case VECTOR_TYPE:\n       nelts = TYPE_VECTOR_SUBPARTS (type).to_constant ();\n       fldsz = int_size_in_bytes (TREE_TYPE (type));\n       for (HOST_WIDE_INT i = 0; i < nelts; i++)\n-\tclear_padding_type (buf, TREE_TYPE (type), fldsz);\n+\tclear_padding_type (buf, TREE_TYPE (type), fldsz, for_auto_init);\n       break;\n     case NULLPTR_TYPE:\n       gcc_assert ((size_t) sz <= clear_padding_unit);\n@@ -4901,7 +4911,7 @@ clear_type_padding_in_mask (tree type, unsigned char *mask)\n   buf.sz = int_size_in_bytes (type);\n   buf.size = 0;\n   buf.union_ptr = mask;\n-  clear_padding_type (&buf, type, buf.sz);\n+  clear_padding_type (&buf, type, buf.sz, false);\n   clear_padding_flush (&buf, true);\n }\n \n@@ -4911,9 +4921,13 @@ static bool\n gimple_fold_builtin_clear_padding (gimple_stmt_iterator *gsi)\n {\n   gimple *stmt = gsi_stmt (*gsi);\n-  gcc_assert (gimple_call_num_args (stmt) == 2);\n+  gcc_assert (gimple_call_num_args (stmt) == 3);\n   tree ptr = gimple_call_arg (stmt, 0);\n   tree typearg = gimple_call_arg (stmt, 1);\n+  /* the 3rd argument of __builtin_clear_padding is to distinguish whether\n+     this call is made by the user or by the compiler for automatic variable\n+     initialization.  */\n+  bool for_auto_init = (bool) TREE_INT_CST_LOW (gimple_call_arg (stmt, 2));\n   tree type = TREE_TYPE (TREE_TYPE (typearg));\n   location_t loc = gimple_location (stmt);\n   clear_padding_struct buf;\n@@ -4970,7 +4984,7 @@ gimple_fold_builtin_clear_padding (gimple_stmt_iterator *gsi)\n \t  buf.sz = eltsz;\n \t  buf.align = TYPE_ALIGN (elttype);\n \t  buf.alias_type = build_pointer_type (elttype);\n-\t  clear_padding_emit_loop (&buf, elttype, end);\n+\t  clear_padding_emit_loop (&buf, elttype, end, for_auto_init);\n \t}\n     }\n   else\n@@ -4983,7 +4997,7 @@ gimple_fold_builtin_clear_padding (gimple_stmt_iterator *gsi)\n \t  gsi_insert_before (gsi, g, GSI_SAME_STMT);\n \t}\n       buf.alias_type = build_pointer_type (type);\n-      clear_padding_type (&buf, type, buf.sz);\n+      clear_padding_type (&buf, type, buf.sz, for_auto_init);\n       clear_padding_flush (&buf, true);\n     }\n "}, {"sha": "3314f76cf3ff8ff7e7267f3a29bb736cf48237ff", "filename": "gcc/gimplify.c", "status": "modified", "additions": 142, "deletions": 9, "changes": 151, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -1743,6 +1743,94 @@ force_labels_r (tree *tp, int *walk_subtrees, void *data ATTRIBUTE_UNUSED)\n   return NULL_TREE;\n }\n \n+/* Generate an initialization to automatic variable DECL based on INIT_TYPE.\n+   Build a call to internal const function DEFERRED_INIT:\n+   1st argument: SIZE of the DECL;\n+   2nd argument: INIT_TYPE;\n+   3rd argument: IS_VLA, 0 NO, 1 YES;\n+\n+   as LHS = DEFERRED_INIT (SIZE of the DECL, INIT_TYPE, IS_VLA)\n+   if IS_VLA is false, the LHS is the DECL itself,\n+   if IS_VLA is true, the LHS is a MEM_REF whose address is the pointer\n+   to this DECL.  */\n+static void\n+gimple_add_init_for_auto_var (tree decl,\n+\t\t\t      enum auto_init_type init_type,\n+\t\t\t      bool is_vla,\n+\t\t\t      gimple_seq *seq_p)\n+{\n+  gcc_assert (auto_var_p (decl));\n+  gcc_assert (init_type > AUTO_INIT_UNINITIALIZED);\n+  location_t loc = EXPR_LOCATION (decl);\n+  tree decl_size = TYPE_SIZE_UNIT (TREE_TYPE (decl));\n+\n+  tree init_type_node\n+    = build_int_cst (integer_type_node, (int) init_type);\n+  tree is_vla_node\n+    = build_int_cst (integer_type_node, (int) is_vla);\n+\n+  tree call = build_call_expr_internal_loc (loc, IFN_DEFERRED_INIT,\n+\t\t \t\t\t    TREE_TYPE (decl), 3,\n+\t\t\t\t\t    decl_size, init_type_node,\n+\t\t\t\t\t    is_vla_node);\n+\n+  gimplify_assign (decl, call, seq_p);\n+}\n+\n+/* Generate padding initialization for automatic vairable DECL.\n+   C guarantees that brace-init with fewer initializers than members\n+   aggregate will initialize the rest of the aggregate as-if it were\n+   static initialization.  In turn static initialization guarantees\n+   that padding is initialized to zero. So, we always initialize paddings\n+   to zeroes regardless INIT_TYPE.\n+   To do the padding initialization, we insert a call to\n+   __BUILTIN_CLEAR_PADDING (&decl, 0, for_auto_init = true).\n+   Note, we add an additional dummy argument for __BUILTIN_CLEAR_PADDING,\n+   'for_auto_init' to distinguish whether this call is for automatic\n+   variable initialization or not.\n+   */\n+static void\n+gimple_add_padding_init_for_auto_var (tree decl, bool is_vla,\n+\t\t\t\t      gimple_seq *seq_p)\n+{\n+  tree addr_of_decl = NULL_TREE;\n+  bool for_auto_init = true;\n+  tree fn = builtin_decl_explicit (BUILT_IN_CLEAR_PADDING);\n+\n+  if (is_vla)\n+    {\n+      /* The temporary address variable for this vla should be\n+\t created in gimplify_vla_decl.  */\n+      gcc_assert (DECL_HAS_VALUE_EXPR_P (decl));\n+      gcc_assert (TREE_CODE (DECL_VALUE_EXPR (decl)) == INDIRECT_REF);\n+      addr_of_decl = TREE_OPERAND (DECL_VALUE_EXPR (decl), 0);\n+    }\n+  else\n+    {\n+      mark_addressable (decl);\n+      addr_of_decl = build_fold_addr_expr (decl);\n+    }\n+\n+  gimple *call = gimple_build_call (fn,\n+\t\t\t\t    3, addr_of_decl,\n+\t\t\t\t    build_zero_cst (TREE_TYPE (addr_of_decl)),\n+\t\t\t\t    build_int_cst (integer_type_node,\n+\t\t\t\t\t\t   (int) for_auto_init));\n+  gimplify_seq_add_stmt (seq_p, call);\n+}\n+\n+/* Return true if the DECL need to be automaticly initialized by the\n+   compiler.  */\n+static bool\n+is_var_need_auto_init (tree decl)\n+{\n+  if (auto_var_p (decl)\n+      && (flag_auto_var_init > AUTO_INIT_UNINITIALIZED)\n+      && (!lookup_attribute (\"uninitialized\", DECL_ATTRIBUTES (decl))))\n+    return true;\n+  return false;\n+}\n+\n /* Gimplify a DECL_EXPR node *STMT_P by making any necessary allocation\n    and initialization explicit.  */\n \n@@ -1840,6 +1928,26 @@ gimplify_decl_expr (tree *stmt_p, gimple_seq *seq_p)\n \t       as they may contain a label address.  */\n \t    walk_tree (&init, force_labels_r, NULL, NULL);\n \t}\n+      /* When there is no explicit initializer, if the user requested,\n+\t We should insert an artifical initializer for this automatic\n+\t variable.  */\n+      else if (is_var_need_auto_init (decl))\n+\t{\n+\t  gimple_add_init_for_auto_var (decl,\n+\t\t\t\t\tflag_auto_var_init,\n+\t\t\t\t\tis_vla,\n+\t\t\t\t\tseq_p);\n+\t  /* The expanding of a call to the above .DEFERRED_INIT will apply\n+\t     block initialization to the whole space covered by this variable.\n+\t     As a result, all the paddings will be initialized to zeroes\n+\t     for zero initialization and 0xFE byte-repeatable patterns for\n+\t     pattern initialization.\n+\t     In order to make the paddings as zeroes for pattern init, We\n+\t     should add a call to __builtin_clear_padding to clear the\n+\t     paddings to zero in compatiple with CLANG.  */\n+\t  if (flag_auto_var_init == AUTO_INIT_PATTERN)\n+\t    gimple_add_padding_init_for_auto_var (decl, is_vla, seq_p);\n+\t}\n     }\n \n   return GS_ALL_DONE;\n@@ -3411,11 +3519,15 @@ gimplify_call_expr (tree *expr_p, gimple_seq *pre_p, bool want_value)\n \t  {\n \t    /* Remember the original type of the argument in an internal\n \t       dummy second argument, as in GIMPLE pointer conversions are\n-\t       useless.  */\n+\t       useless. also mark this call as not for automatic initialization\n+\t       in the internal dummy third argument.  */\n \t    p = CALL_EXPR_ARG (*expr_p, 0);\n+\t    bool for_auto_init = false;\n \t    *expr_p\n-\t      = build_call_expr_loc (EXPR_LOCATION (*expr_p), fndecl, 2, p,\n-\t\t\t\t     build_zero_cst (TREE_TYPE (p)));\n+\t      = build_call_expr_loc (EXPR_LOCATION (*expr_p), fndecl, 3, p,\n+\t\t\t\t     build_zero_cst (TREE_TYPE (p)),\n+\t\t\t\t     build_int_cst (integer_type_node,\n+\t\t\t\t\t\t    (int) for_auto_init));\n \t    return GS_OK;\n \t  }\n \tbreak;\n@@ -4872,6 +4984,9 @@ gimplify_init_constructor (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n   tree object, ctor, type;\n   enum gimplify_status ret;\n   vec<constructor_elt, va_gc> *elts;\n+  bool cleared = false;\n+  bool is_empty_ctor = false;\n+  bool is_init_expr = (TREE_CODE (*expr_p) == INIT_EXPR);\n \n   gcc_assert (TREE_CODE (TREE_OPERAND (*expr_p, 1)) == CONSTRUCTOR);\n \n@@ -4914,7 +5029,7 @@ gimplify_init_constructor (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \tstruct gimplify_init_ctor_preeval_data preeval_data;\n \tHOST_WIDE_INT num_ctor_elements, num_nonzero_elements;\n \tHOST_WIDE_INT num_unique_nonzero_elements;\n-\tbool cleared, complete_p, valid_const_initializer;\n+\tbool complete_p, valid_const_initializer;\n \n \t/* Aggregate types must lower constructors to initialization of\n \t   individual elements.  The exception is that a CONSTRUCTOR node\n@@ -4923,6 +5038,7 @@ gimplify_init_constructor (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \t  {\n \t    if (notify_temp_creation)\n \t      return GS_OK;\n+\t    is_empty_ctor = true;\n \t    break;\n \t  }\n \n@@ -5248,13 +5364,28 @@ gimplify_init_constructor (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n   if (want_value)\n     {\n       *expr_p = object;\n-      return GS_OK;\n+      ret = GS_OK;\n     }\n   else\n     {\n       *expr_p = NULL;\n-      return GS_ALL_DONE;\n-    }\n+      ret = GS_ALL_DONE;\n+    }\n+\n+  /* If the user requests to initialize automatic variables, we\n+     should initialize paddings inside the variable.  Add a call to\n+     __BUILTIN_CLEAR_PADDING (&object, 0, for_auto_init = true) to\n+     initialize paddings of object always to zero regardless of\n+     INIT_TYPE.  Note, we will not insert this call if the aggregate\n+     variable has be completely cleared already or it's initialized\n+     with an empty constructor.  */\n+  if (is_init_expr\n+      && ((AGGREGATE_TYPE_P (type) && !cleared && !is_empty_ctor)\n+\t  || !AGGREGATE_TYPE_P (type))\n+      && is_var_need_auto_init (object))\n+    gimple_add_padding_init_for_auto_var (object, false, pre_p);\n+\n+  return ret;\n }\n \n /* Given a pointer value OP0, return a simplified version of an\n@@ -5395,10 +5526,12 @@ gimplify_modify_expr_rhs (tree *expr_p, tree *from_p, tree *to_p,\n \t     crack at this before we break it down.  */\n \t  if (ret != GS_UNHANDLED)\n \t    break;\n+\n \t  /* If we're initializing from a CONSTRUCTOR, break this into\n \t     individual MODIFY_EXPRs.  */\n-\t  return gimplify_init_constructor (expr_p, pre_p, post_p, want_value,\n-\t\t\t\t\t    false);\n+\t  ret = gimplify_init_constructor (expr_p, pre_p, post_p, want_value,\n+\t\t\t\t\t   false);\n+\t  return ret;\n \n \tcase COND_EXPR:\n \t  /* If we're assigning to a non-register type, push the assignment"}, {"sha": "ada2a820ff1579978aa7bad70db5793a7a60fe03", "filename": "gcc/internal-fn.c", "status": "modified", "additions": 99, "deletions": 0, "changes": 99, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Finternal-fn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Finternal-fn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Finternal-fn.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -53,6 +53,9 @@ along with GCC; see the file COPYING3.  If not see\n #include \"rtl-iter.h\"\n #include \"gimple-range.h\"\n \n+/* For lang_hooks.types.type_for_mode.  */\n+#include \"langhooks.h\"\n+\n /* The names of each internal function, indexed by function number.  */\n const char *const internal_fn_name_array[] = {\n #define DEF_INTERNAL_FN(CODE, FLAGS, FNSPEC) #CODE,\n@@ -2977,6 +2980,102 @@ expand_UNIQUE (internal_fn, gcall *stmt)\n     emit_insn (pattern);\n }\n \n+/* Expand the IFN_DEFERRED_INIT function:\n+   LHS = DEFERRED_INIT (SIZE of the DECL, INIT_TYPE, IS_VLA);\n+\n+   if IS_VLA is false, the LHS is the DECL itself,\n+   if IS_VLA is true, the LHS is a MEM_REF whose address is the pointer\n+   to this DECL.\n+\n+   Initialize the LHS with zero/pattern according to its second argument\n+   INIT_TYPE:\n+   if INIT_TYPE is AUTO_INIT_ZERO, use zeroes to initialize;\n+   if INIT_TYPE is AUTO_INIT_PATTERN, use 0xFE byte-repeatable pattern\n+     to initialize;\n+   The LHS variable is initialized including paddings.\n+   The reasons to choose 0xFE for pattern initialization are:\n+     1. It is a non-canonical virtual address on x86_64, and at the\n+\thigh end of the i386 kernel address space.\n+     2. It is a very large float value (-1.694739530317379e+38).\n+     3. It is also an unusual number for integers.  */\n+#define INIT_PATTERN_VALUE  0xFE\n+static void\n+expand_DEFERRED_INIT (internal_fn, gcall *stmt)\n+{\n+  tree lhs = gimple_call_lhs (stmt);\n+  tree var_size = gimple_call_arg (stmt, 0);\n+  enum auto_init_type init_type\n+    = (enum auto_init_type) TREE_INT_CST_LOW (gimple_call_arg (stmt, 1));\n+  bool is_vla = (bool) TREE_INT_CST_LOW (gimple_call_arg (stmt, 2));\n+  bool reg_lhs = true;\n+\n+  tree var_type = TREE_TYPE (lhs);\n+  gcc_assert (init_type > AUTO_INIT_UNINITIALIZED);\n+\n+  if (DECL_P (lhs))\n+    {\n+      rtx tem = expand_expr (lhs, NULL_RTX, VOIDmode, EXPAND_WRITE);\n+      reg_lhs = !MEM_P (tem);\n+    }\n+  else if (TREE_CODE (lhs) == SSA_NAME)\n+    reg_lhs = true;\n+  else\n+    {\n+      gcc_assert (is_vla);\n+      reg_lhs = false;\n+    }\n+\n+\n+  if (!reg_lhs)\n+    {\n+    /* If this is a VLA or the variable is not in register,\n+       expand to a memset to initialize it.  */\n+\n+      mark_addressable (lhs);\n+      tree var_addr = build_fold_addr_expr (lhs);\n+\n+      tree value = (init_type == AUTO_INIT_PATTERN) ?\n+\t\t    build_int_cst (integer_type_node,\n+\t\t\t\t   INIT_PATTERN_VALUE) :\n+\t\t    integer_zero_node;\n+      tree m_call = build_call_expr (builtin_decl_implicit (BUILT_IN_MEMSET),\n+\t\t\t\t     3, var_addr, value, var_size);\n+      /* Expand this memset call.  */\n+      expand_builtin_memset (m_call, NULL_RTX, TYPE_MODE (var_type));\n+    }\n+  else\n+    {\n+    /* If this variable is in a register, use expand_assignment might\n+       generate better code.  */\n+      tree init = build_zero_cst (var_type);\n+      unsigned HOST_WIDE_INT total_bytes\n+\t= tree_to_uhwi (TYPE_SIZE_UNIT (var_type));\n+\n+      if (init_type == AUTO_INIT_PATTERN)\n+\t{\n+\t  tree alt_type = NULL_TREE;\n+\t  if (!can_native_interpret_type_p (var_type))\n+\t    {\n+\t      alt_type\n+\t\t= lang_hooks.types.type_for_mode (TYPE_MODE (var_type),\n+\t\t\t\t\t\t  TYPE_UNSIGNED (var_type));\n+\t      gcc_assert (can_native_interpret_type_p (alt_type));\n+\t    }\n+\n+\t  unsigned char *buf = (unsigned char *) xmalloc (total_bytes);\n+\t  memset (buf, INIT_PATTERN_VALUE, total_bytes);\n+\t  init = native_interpret_expr (alt_type ? alt_type : var_type,\n+\t\t\t\t\tbuf, total_bytes);\n+\t  gcc_assert (init);\n+\n+\t  if (alt_type)\n+\t    init = build1 (VIEW_CONVERT_EXPR, var_type, init);\n+\t}\n+\n+      expand_assignment (lhs, init, false);\n+    }\n+}\n+\n /* The size of an OpenACC compute dimension.  */\n \n static void"}, {"sha": "88169ef4656d86bfa6909855e39409bbcd720b83", "filename": "gcc/internal-fn.def", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Finternal-fn.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Finternal-fn.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Finternal-fn.def?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -360,6 +360,10 @@ DEF_INTERNAL_FN (VEC_CONVERT, ECF_CONST | ECF_LEAF | ECF_NOTHROW, NULL)\n DEF_INTERNAL_FN (UNIQUE, ECF_NOTHROW, NULL)\n DEF_INTERNAL_FN (PHI, 0, NULL)\n \n+/* A function to represent an artifical initialization to an uninitialized\n+   automatic variable.  */\n+DEF_INTERNAL_FN (DEFERRED_INIT, ECF_CONST | ECF_LEAF | ECF_NOTHROW, NULL)\n+\n /* DIM_SIZE and DIM_POS return the size of a particular compute\n    dimension and the executing thread's position within that\n    dimension.  DIM_POS is pure (and not const) so that it isn't"}, {"sha": "8b8ba3dd7e8d4828aa692fc7323a7972490bf90d", "filename": "gcc/testsuite/c-c++-common/auto-init-1.c", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,39 @@\n+/* Verify zero initialization for integer and pointer type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+#ifndef __cplusplus\n+# define bool _Bool\n+#endif\n+\n+enum E {\n+  N1 = 0,\n+  N2,\n+  N3\n+};\n+\n+extern void bar (char, short, int, enum E, long, long long, int *, bool);\n+\n+void foo()\n+{\n+  char temp1;\n+  short temp2;\n+  int temp3;\n+  enum E temp4;\n+  long temp5;\n+  long long temp6;\n+  int *temp7;\n+  bool temp8;\n+\n+  bar (temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8);\n+  return;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(1, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(2, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(4, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp4 = .DEFERRED_INIT \\\\(4, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp5 = .DEFERRED_INIT \\\\(8, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp6 = .DEFERRED_INIT \\\\(8, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp7 = .DEFERRED_INIT \\\\(8, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp8 = .DEFERRED_INIT \\\\(1, 2, 0\\\\)\" \"gimple\" } } */"}, {"sha": "f35205f2a300bcb4f9fa42bac80e1ccac03cb9e9", "filename": "gcc/testsuite/c-c++-common/auto-init-10.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-10.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-10.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-10.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify the variable attribute \"uninitialized\".  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+extern void bar (char, long long *) __attribute__ ((uninitialized)); /* { dg-warning \"'uninitialized' attribute ignored because\" \"is not a variable\" } */\n+extern int __attribute__ ((uninitialized)) boo1; /* { dg-warning \"'uninitialized' attribute ignored because 'boo1' is not a local variable\" } */\n+static int __attribute__ ((uninitialized)) boo2; /* { dg-warning \"'uninitialized' attribute ignored because 'boo2' is not a local variable\" } */\n+\n+\n+void foo()\n+{\n+  short temp1;\n+  long long __attribute__ ((uninitialized)) temp2[10];\n+  static int __attribute__ ((uninitialized)) boo3; /* { dg-warning \"'uninitialized' attribute ignored because 'boo3' is not a local variable\" } */\n+\n+\n+  bar (temp1, temp2);\n+  return;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(2, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump-not \"temp2 = .DEFERRED_INIT \\\\(\" \"gimple\" } } */"}, {"sha": "a2d66908d83efc83b503ca22dec7db5c2dddf5fd", "filename": "gcc/testsuite/c-c++-common/auto-init-11.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-11.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-11.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-11.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,14 @@\n+/* Verify zero initialization for VLA automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+extern void bar (int);\n+\n+void foo(int n)\n+{\n+  int arr[n];\n+  bar (arr[2]);\n+  return;\n+}\n+\n+/* { dg-final { scan-tree-dump \".DEFERRED_INIT \\\\(D.\\\\d*, 2, 1\\\\)\" \"gimple\" } } */"}, {"sha": "f05d743fda024693d31b833aadfb278f84971473", "filename": "gcc/testsuite/c-c++-common/auto-init-12.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-12.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-12.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-12.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,14 @@\n+/* Verify zero initialization for VLA automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+extern void bar (int);\n+\n+void foo(int n)\n+{\n+  int arr[n];\n+  bar (arr[2]);\n+  return;\n+}\n+\n+/* { dg-final { scan-tree-dump \".DEFERRED_INIT \\\\(D.\\\\d*, 1, 1\\\\)\" \"gimple\" } } */"}, {"sha": "b0c0365b288a796fb90ba4485eb97caa3c4dccab", "filename": "gcc/testsuite/c-c++-common/auto-init-13.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-13.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-13.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-13.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,23 @@\n+/* Verify the auto initialization of structure or union with a flexible array\n+   member.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+struct a {\n+  int b;\n+  int array[];\n+};\n+union tar {\n+  struct a bar;\n+  char buf;\n+};\n+\n+int foo()\n+{\n+  struct a d;\n+  union tar var;\n+  return d.b + var.bar.b;\n+}\n+\n+/* { dg-final { scan-tree-dump \"d = .DEFERRED_INIT \\\\(4, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"var = .DEFERRED_INIT \\\\(4, 1, 0\\\\)\" \"gimple\" } } */"}, {"sha": "986bb19faaf0f4f85b188dd35046deb2d5f018d8", "filename": "gcc/testsuite/c-c++-common/auto-init-14.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-14.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-14.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-14.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,23 @@\n+/* Verify the auto initialization of structure or union with a flexible array\n+   member.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+struct a {\n+  int b;\n+  int array[];\n+};\n+union tar {\n+  struct a bar;\n+  char buf;\n+};\n+\n+int foo()\n+{\n+  struct a d;\n+  union tar var;\n+  return d.b + var.bar.b;\n+}\n+\n+/* { dg-final { scan-tree-dump \"d = .DEFERRED_INIT \\\\(4, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"var = .DEFERRED_INIT \\\\(4, 2, 0\\\\)\" \"gimple\" } } */"}, {"sha": "aa9d7fab68a69aef098aef2b63d14f05d2432245", "filename": "gcc/testsuite/c-c++-common/auto-init-15.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-15.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-15.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-15.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,13 @@\n+/* Verify the auto initialization of nested VLA.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+void g(void *);\n+\n+void foo(int a)\n+{\n+  int x[a][a];\n+  g(x);\n+}\n+\n+/* { dg-final { scan-tree-dump \".DEFERRED_INIT \\\\(D.\\\\d*, 2, 1\\\\)\" \"gimple\" } } */"}, {"sha": "86493eef9e47feef4e2b646c0ffc292926b14676", "filename": "gcc/testsuite/c-c++-common/auto-init-16.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-16.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,13 @@\n+/* Verify the auto initialization of nested VLA.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+void g(void *);\n+\n+void foo(int a)\n+{\n+  int x[a][a];\n+  g(x);\n+}\n+\n+/* { dg-final { scan-tree-dump \".DEFERRED_INIT \\\\(D.\\\\d*, 1, 1\\\\)\" \"gimple\" } } */"}, {"sha": "71955b54ba031722ec9fb4b4b4535d6ef3082a55", "filename": "gcc/testsuite/c-c++-common/auto-init-2.c", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,39 @@\n+/* Verify pattern initialization for integer and pointer type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+#ifndef __cplusplus\n+# define bool _Bool\n+#endif\n+\n+enum E {\n+  N1 = 0,\n+  N2,\n+  N3\n+};\n+\n+extern void bar (char, short, int, enum E, long, long long, int *, bool);\n+\n+void foo()\n+{\n+  char temp1;\n+  short temp2;\n+  int temp3;\n+  enum E temp4;\n+  long temp5;\n+  long long temp6;\n+  int *temp7;\n+  bool temp8;\n+\n+  bar (temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8);\n+  return;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(1, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(2, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(4, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp4 = .DEFERRED_INIT \\\\(4, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp5 = .DEFERRED_INIT \\\\(8, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp6 = .DEFERRED_INIT \\\\(8, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp7 = .DEFERRED_INIT \\\\(8, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp8 = .DEFERRED_INIT \\\\(1, 1, 0\\\\)\" \"gimple\" } } */"}, {"sha": "312275666381de4f32c17f403a28246620bf57cf", "filename": "gcc/testsuite/c-c++-common/auto-init-3.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-3.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify zero initialization for floating point type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+long double result;\n+\n+long double foo()\n+{\n+  float temp1;\n+  double temp2;\n+  long double temp3;\n+  \n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(4, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(8, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(16, 2, 0\\\\)\" \"gimple\" } } */"}, {"sha": "15a431726dcd9c5f9c53ddcbdc67e698dd964d1f", "filename": "gcc/testsuite/c-c++-common/auto-init-4.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-4.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify pattern initialization for floating point type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+long double result;\n+\n+long double foo()\n+{\n+  float temp1;\n+  double temp2;\n+  long double temp3;\n+  \n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(4, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(8, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(16, 1, 0\\\\)\" \"gimple\" } } */"}, {"sha": "54f90bc890b5ff21214ac92c8f9c84887762c697", "filename": "gcc/testsuite/c-c++-common/auto-init-5.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-5.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,21 @@\n+/* Verify zero initialization for complex type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+\n+_Complex long double result;\n+\n+_Complex long double foo()\n+{\n+  _Complex float temp1;\n+  _Complex double temp2;\n+  _Complex long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(8, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(16, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(32, 2, 0\\\\)\" \"gimple\" } } */\n+"}, {"sha": "4124a2b183aad7477f143a014a5708fd2a03b8bf", "filename": "gcc/testsuite/c-c++-common/auto-init-6.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-6.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,21 @@\n+/* Verify pattern initialization for complex type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+\n+_Complex long double result;\n+\n+_Complex long double foo()\n+{\n+  _Complex float temp1;\n+  _Complex double temp2;\n+  _Complex long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(8, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(16, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(32, 1, 0\\\\)\" \"gimple\" } } */\n+"}, {"sha": "19986969a8f7052b753e890437e20812f0c1a912", "filename": "gcc/testsuite/c-c++-common/auto-init-7.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-7.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,35 @@\n+/* Verify zero initialization for array, union, and structure type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+struct S\n+{\n+  int f1;\n+  float f2;\n+  char f3[20];\n+};\n+\n+union U\n+{\n+  char u1[5];\n+  int u2;\n+  float u3; \n+};\n+\n+double result;\n+\n+double foo()\n+{\n+  int temp1[3];\n+  double temp2[3];\n+  struct S temp3;\n+  union U temp4;\n+  \n+  result = temp1[2] + temp2[1] + temp3.f2 + temp4.u3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(12, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(24, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(28, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp4 = .DEFERRED_INIT \\\\(8, 2, 0\\\\)\" \"gimple\" } } */"}, {"sha": "9778e911e3ad62473d1b79635210902d209704d9", "filename": "gcc/testsuite/c-c++-common/auto-init-8.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-8.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,35 @@\n+/* Verify pattern initialization for array, union, and structure type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+struct S\n+{\n+  int f1;\n+  float f2;\n+  char f3[20];\n+};\n+\n+union U\n+{\n+  char u1[5];\n+  int u2;\n+  float u3; \n+};\n+\n+double result;\n+\n+double foo()\n+{\n+  int temp1[3];\n+  double temp2[3];\n+  struct S temp3;\n+  union U temp4;\n+  \n+  result = temp1[2] + temp2[1] + temp3.f2 + temp4.u3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(12, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp2 = .DEFERRED_INIT \\\\(24, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp3 = .DEFERRED_INIT \\\\(28, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"temp4 = .DEFERRED_INIT \\\\(8, 1, 0\\\\)\" \"gimple\" } } */"}, {"sha": "29acb7f86691d0cfbf81450a6256babb4806ed28", "filename": "gcc/testsuite/c-c++-common/auto-init-9.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-9.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,20 @@\n+/* Verify the variable attribute \"uninitialized\".  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-tree-gimple\" } */\n+\n+extern void bar (char, long long *) __attribute__ ((uninitialized)); /* { dg-warning \"'uninitialized' attribute ignored because\" \"is not a variable\" } */\n+extern int __attribute__ ((uninitialized)) boo1; /* { dg-warning \"'uninitialized' attribute ignored because 'boo1' is not a local variable\" } */\n+static int __attribute__ ((uninitialized)) boo2; /* { dg-warning \"'uninitialized' attribute ignored because 'boo2' is not a local variable\" } */\n+\n+void foo()\n+{\n+  short temp1;\n+  long long __attribute__ ((uninitialized)) temp2[10];\n+  static int __attribute__ ((uninitialized)) boo3; /* { dg-warning \"'uninitialized' attribute ignored because 'boo3' is not a local variable\" } */\n+\n+  bar (temp1, temp2);\n+  return;\n+}\n+\n+/* { dg-final { scan-tree-dump \"temp1 = .DEFERRED_INIT \\\\(2, 2, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump-not \"temp2 = .DEFERRED_INIT \\\\(8, 2, 0\\\\)\" \"gimple\" } } */"}, {"sha": "77ec02355df43139623ba82ccc0be05b53ad970e", "filename": "gcc/testsuite/c-c++-common/auto-init-esra.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-esra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-esra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-esra.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,35 @@\n+/* Verify the strength reduction adjustment for -ftrivial-auto-var-init.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -ftrivial-auto-var-init=zero -fdump-tree-gimple -fdump-tree-esra\" } */\n+\n+\n+typedef double VECTOR[3];\n+\n+enum\n+{\n+ X = 0,\n+ Y = 1,\n+ Z = 2,\n+ T = 3\n+};\n+\n+void Assign_Vector(VECTOR d, VECTOR s)\n+{\n+ d[X] = s[X];\n+ d[Y] = s[Y];\n+ d[Z] = s[Z];\n+}\n+\n+void VCross(VECTOR a, const VECTOR b, const VECTOR c)\n+{\n+ VECTOR tmp;\n+\n+ tmp[X] = b[Y] * c[Z] - b[Z] * c[Y];\n+ tmp[Y] = b[Z] * c[X] - b[X] * c[Z];\n+ tmp[Z] = b[X] * c[Y] - b[Y] * c[X];\n+\n+ Assign_Vector(a, tmp);\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"tmp = .DEFERRED_INIT \\\\(24, 2, 0\\\\)\" 1 \"gimple\" } } */\n+/* { dg-final { scan-tree-dump-times \".DEFERRED_INIT \\\\(8, 2, 0\\\\)\" 3 \"esra\" } } */"}, {"sha": "97f78ee7d56ac59abee4658452cf8911f6399f3d", "filename": "gcc/testsuite/c-c++-common/auto-init-padding-1.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,23 @@\n+/* Verify the padding initialization for pattern initialization, we always emit\n+ * a call to __builtin_clear_padding to initialize the paddings to zero.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-tree-gimple\" } */\n+\n+\n+struct test_small_hole {\n+  int one;\n+  char two;\n+  /* 3 byte padding hole here. */\n+  int three;\n+  unsigned long four;\n+};\n+\n+extern void g (struct test_small_hole);\n+void foo(int a)\n+{\n+  struct test_small_hole s; \n+  g(s);\n+}\n+\n+/* { dg-final { scan-tree-dump \".DEFERRED_INIT \\\\(24, 1, 0\\\\)\" \"gimple\" } } */\n+/* { dg-final { scan-tree-dump \"__builtin_clear_padding\" \"gimple\" } } */"}, {"sha": "e2b50dc5ae8e1004bbb57dea8384d6836faf5bb9", "filename": "gcc/testsuite/c-c++-common/auto-init-padding-2.c", "status": "added", "additions": 114, "deletions": 0, "changes": 114, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,114 @@\n+/* To test that the compiler can fill all the paddings to zeroes for the \n+   structures when the auto variable is partially initialized,  fully \n+   initialized, or not initialized for -ftrivial-auto-var-init=zero.  */\n+/* { dg-do run} */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+/* Structure with no padding. */\n+struct test_packed {\n+  unsigned long one;\n+  unsigned long two;\n+  unsigned long three;\n+  unsigned long four;\n+} p1;\n+\n+/* Simple structure with padding likely to be covered by compiler. */\n+struct test_small_hole {\n+  unsigned long one;\n+  char two;\n+  /* 3 byte padding hole here. */\n+  int three;\n+  unsigned long four;\n+} sh1;\n+\n+/* Try to trigger unhandled padding in a structure. */\n+struct test_aligned {\n+  unsigned int internal1;\n+  unsigned long long internal2;\n+} __attribute__((__aligned__(64)));\n+\n+struct test_aligned a1;\n+\n+struct test_big_hole {\n+  unsigned char one;\n+  unsigned char two;\n+  unsigned char three;\n+  /* 61 byte padding hole here. */\n+  struct test_aligned four;\n+} __attribute__((__aligned__(64))); \n+\n+struct test_big_hole bh1;\n+\n+struct test_trailing_hole {\n+  char *one;\n+  char *two;\n+  char *three;\n+  char four;\n+  /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+} th1;\n+\n+__attribute__((noipa)) void\n+foo (struct test_packed *p, struct test_small_hole *sh, struct test_aligned *a,\n+     struct test_big_hole *bh, struct test_trailing_hole *th)\n+{\n+  p->one = 1; p->two = 2; p->three = 3; p->four = 4;\n+  sh->one = 11; sh->two = 12; sh->three = 13; sh->four = 14;\n+  a->internal1 = 21; a->internal2 = 22;\n+  bh->one = 31; bh->two = 32; bh->three = 33;\n+  bh->four.internal1 = 34; bh->four.internal2 = 35; \n+  th->one = 0; th->two = 0; th->three = 0; th->four = 44;\n+}\n+\n+int main ()\n+{\n+  struct test_packed p2;\n+  struct test_small_hole sh2;\n+  struct test_aligned a2;\n+  struct test_big_hole bh2;\n+  struct test_trailing_hole th2;\n+\n+  struct test_packed p3 = {.one = 1};\n+  struct test_small_hole sh3 = {.two = 12};\n+  struct test_aligned a3 = {.internal1 = 21};\n+  struct test_big_hole bh3 = {.one = 31};\n+  struct test_trailing_hole th3 = {.three = 0};\n+\n+  struct test_packed p4 = {.one = 1, .two = 2, .three = 3, .four = 4};\n+  struct test_small_hole sh4 = {.one = 11, .two = 12, .three = 13, .four = 14};\n+  struct test_aligned a4 = {.internal1 = 21, .internal2 = 22};\n+  struct test_big_hole bh4 = {.one = 31, .two = 32, .three = 33};\n+  struct test_trailing_hole th4 = {.one = 0, .two = 0, .three = 0, .four = 44};\n+\n+  foo (&p1, &sh1, &a1, &bh1, &th1);\n+  foo (&p2, &sh2, &a2, &bh2, &th2);\n+  foo (&p3, &sh3, &a3, &bh3, &th3);\n+  bh4.four.internal1 = 34; bh4.four.internal2 = 35;\n+\n+  __builtin_clear_padding (&p1);\n+  __builtin_clear_padding (&sh1);\n+  __builtin_clear_padding (&a1);\n+  __builtin_clear_padding (&bh1);\n+  __builtin_clear_padding (&th1);\n+\n+  if (__builtin_memcmp (&p1, &p2, sizeof (p1))\n+      || __builtin_memcmp (&sh1, &sh2, sizeof (sh1))\n+      || __builtin_memcmp (&a1, &a2, sizeof (a1))\n+      || __builtin_memcmp (&bh1, &bh2, sizeof (bh1))\n+      || __builtin_memcmp (&th1, &th2, sizeof (th1)))\n+    __builtin_abort ();\n+  if (__builtin_memcmp (&p1, &p3, sizeof (p1))\n+      || __builtin_memcmp (&sh1, &sh3, sizeof (sh1))\n+      || __builtin_memcmp (&a1, &a3, sizeof (a1))\n+      || __builtin_memcmp (&bh1, &bh3, sizeof (bh1))\n+      || __builtin_memcmp (&th1, &th3, sizeof (th1)))\n+    __builtin_abort ();\n+  if (__builtin_memcmp (&p1, &p4, sizeof (p1))\n+      || __builtin_memcmp (&sh1, &sh4, sizeof (sh1))\n+      || __builtin_memcmp (&a1, &a4, sizeof (a1))\n+      || __builtin_memcmp (&bh1, &bh4, sizeof (bh1))\n+      || __builtin_memcmp (&th1, &th4, sizeof (th1)))\n+    __builtin_abort ();\n+\n+\n+  return 0;\n+}"}, {"sha": "e2c48c002c956e8b82ad687a8321fc6eb18a7e3d", "filename": "gcc/testsuite/c-c++-common/auto-init-padding-3.c", "status": "added", "additions": 114, "deletions": 0, "changes": 114, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fauto-init-padding-3.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,114 @@\n+/* To test that the compiler can fill all the paddings to zeroes for the \n+   structures when the auto variable is partially initialized,  fully \n+   initialized, or not initialized for -ftrivial-auto-var-init=pattern.  */\n+/* { dg-do run} */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern\" } */\n+\n+/* Structure with no padding. */\n+struct test_packed {\n+  unsigned long one;\n+  unsigned long two;\n+  unsigned long three;\n+  unsigned long four;\n+} p1;\n+\n+/* Simple structure with padding likely to be covered by compiler. */\n+struct test_small_hole {\n+  unsigned long one;\n+  char two;\n+  /* 3 byte padding hole here. */\n+  int three;\n+  unsigned long four;\n+} sh1;\n+\n+/* Try to trigger unhandled padding in a structure. */\n+struct test_aligned {\n+  unsigned int internal1;\n+  unsigned long long internal2;\n+} __attribute__((__aligned__(64)));\n+\n+struct test_aligned a1;\n+\n+struct test_big_hole {\n+  unsigned char one;\n+  unsigned char two;\n+  unsigned char three;\n+  /* 61 byte padding hole here. */\n+  struct test_aligned four;\n+} __attribute__((__aligned__(64))); \n+\n+struct test_big_hole bh1;\n+\n+struct test_trailing_hole {\n+  char *one;\n+  char *two;\n+  char *three;\n+  char four;\n+  /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+} th1;\n+\n+__attribute__((noipa)) void\n+foo (struct test_packed *p, struct test_small_hole *sh, struct test_aligned *a,\n+     struct test_big_hole *bh, struct test_trailing_hole *th)\n+{\n+  p->one = 1; p->two = 2; p->three = 3; p->four = 4;\n+  sh->one = 11; sh->two = 12; sh->three = 13; sh->four = 14;\n+  a->internal1 = 21; a->internal2 = 22;\n+  bh->one = 31; bh->two = 32; bh->three = 33;\n+  bh->four.internal1 = 34; bh->four.internal2 = 35; \n+  th->one = 0; th->two = 0; th->three = 0; th->four = 44;\n+}\n+\n+int main ()\n+{\n+  struct test_packed p2;\n+  struct test_small_hole sh2;\n+  struct test_aligned a2;\n+  struct test_big_hole bh2;\n+  struct test_trailing_hole th2;\n+\n+  struct test_packed p3 = {.one = 1};\n+  struct test_small_hole sh3 = {.two = 12};\n+  struct test_aligned a3 = {.internal1 = 21};\n+  struct test_big_hole bh3 = {.one = 31};\n+  struct test_trailing_hole th3 = {.three = 0};\n+\n+  struct test_packed p4 = {.one = 1, .two = 2, .three = 3, .four = 4};\n+  struct test_small_hole sh4 = {.one = 11, .two = 12, .three = 13, .four = 14};\n+  struct test_aligned a4 = {.internal1 = 21, .internal2 = 22};\n+  struct test_big_hole bh4 = {.one = 31, .two = 32, .three = 33};\n+  struct test_trailing_hole th4 = {.one = 0, .two = 0, .three = 0, .four = 44};\n+\n+  foo (&p1, &sh1, &a1, &bh1, &th1);\n+  foo (&p2, &sh2, &a2, &bh2, &th2);\n+  foo (&p3, &sh3, &a3, &bh3, &th3);\n+  bh4.four.internal1 = 34; bh4.four.internal2 = 35;\n+\n+  __builtin_clear_padding (&p1);\n+  __builtin_clear_padding (&sh1);\n+  __builtin_clear_padding (&a1);\n+  __builtin_clear_padding (&bh1);\n+  __builtin_clear_padding (&th1);\n+\n+  if (__builtin_memcmp (&p1, &p2, sizeof (p1))\n+      || __builtin_memcmp (&sh1, &sh2, sizeof (sh1))\n+      || __builtin_memcmp (&a1, &a2, sizeof (a1))\n+      || __builtin_memcmp (&bh1, &bh2, sizeof (bh1))\n+      || __builtin_memcmp (&th1, &th2, sizeof (th1)))\n+    __builtin_abort ();\n+  if (__builtin_memcmp (&p1, &p3, sizeof (p1))\n+      || __builtin_memcmp (&sh1, &sh3, sizeof (sh1))\n+      || __builtin_memcmp (&a1, &a3, sizeof (a1))\n+      || __builtin_memcmp (&bh1, &bh3, sizeof (bh1))\n+      || __builtin_memcmp (&th1, &th3, sizeof (th1)))\n+    __builtin_abort ();\n+  if (__builtin_memcmp (&p1, &p4, sizeof (p1))\n+      || __builtin_memcmp (&sh1, &sh4, sizeof (sh1))\n+      || __builtin_memcmp (&a1, &a4, sizeof (a1))\n+      || __builtin_memcmp (&bh1, &bh4, sizeof (bh1))\n+      || __builtin_memcmp (&th1, &th4, sizeof (th1)))\n+    __builtin_abort ();\n+\n+\n+  return 0;\n+}"}, {"sha": "43002235a53c534b732d4167b93043d9254cab00", "filename": "gcc/testsuite/g++.dg/auto-init-uninit-pred-1_a.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-1_a.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-1_a.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-1_a.C?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wuninitialized -O2 -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-pred-1_a.C\""}, {"sha": "5551060b12252334462744aaac7312b0bc0d15ea", "filename": "gcc/testsuite/g++.dg/auto-init-uninit-pred-2_a.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-2_a.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-2_a.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-2_a.C?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wuninitialized -O2 -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-pred-2_a.C\""}, {"sha": "d6ab4f0b6beb62ef29f61039c31a4080866b376e", "filename": "gcc/testsuite/g++.dg/auto-init-uninit-pred-3_a.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-3_a.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-3_a.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-3_a.C?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wuninitialized -O2 -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-pred-3_a.C\""}, {"sha": "4747d283d31cb80c1ebe5110649fe8533a67ae57", "filename": "gcc/testsuite/g++.dg/auto-init-uninit-pred-4.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fauto-init-uninit-pred-4.C?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Wuninitialized -Og -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-pred-4.C\""}, {"sha": "88fd66678f290764772abb339967ffcb7378eba5", "filename": "gcc/testsuite/gcc.dg/auto-init-sra-1.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-sra-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-sra-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-sra-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,24 @@\n+/* Verify that SRA total scalarization will not be confused by padding\n+   and also not confused by auto initialization.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 --param sra-max-scalarization-size-Ospeed=16 -fdump-tree-release_ssa -ftrivial-auto-var-init=zero\" } */\n+\n+struct S\n+{\n+  int i;\n+  unsigned short f1;\n+  char f2;\n+  unsigned short f3, f4;\n+};\n+\n+\n+int foo (struct S *p)\n+{\n+  struct S l;\n+\n+  l = *p;\n+  l.i++;\n+  *p = l;\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"l;\" 0 \"release_ssa\" } } */"}, {"sha": "d260f5ae934ed1eff7f90d332af96e8a915e3934", "filename": "gcc/testsuite/gcc.dg/auto-init-sra-2.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-sra-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-sra-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-sra-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,24 @@\n+/* Verify that SRA total scalarization will not be confused by padding\n+   and also not confused by auto initialization.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 --param sra-max-scalarization-size-Ospeed=16 -fdump-tree-release_ssa -ftrivial-auto-var-init=pattern\" } */\n+\n+struct S\n+{\n+  int i;\n+  unsigned short f1;\n+  char f2;\n+  unsigned short f3, f4;\n+};\n+\n+\n+int foo (struct S *p)\n+{\n+  struct S l;\n+\n+  l = *p;\n+  l.i++;\n+  *p = l;\n+}\n+\n+/* { dg-final { scan-tree-dump-times \"l;\" 0 \"release_ssa\" } } */"}, {"sha": "502db591222a8256acc97a41e5c5ce153f313dda", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-1.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,5 @@\n+/* Spurious uninitialized variable warnings, case 1.\n+   Taken from cppfiles.c (merge_include_chains) */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-1.c\""}, {"sha": "65da110f5566889f02650499aea81081fc8fdcbb", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-12.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-12.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-12.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-12.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,4 @@\n+/* PR 23497 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-12.c\""}, {"sha": "87dd8b587e00f6cb742cb0ed45a1bc468d88ae6d", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-13.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-13.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-13.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-13.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+typedef _Complex float C;\n+C foo()\n+{\n+  C f;\n+  __imag__ f = 0;\n+  return f;\t/* { dg-warning \"is used\" \"unconditional\" } */\n+}"}, {"sha": "9ffe00a67e50a48a1004761a05651c39b0fcc337", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-14.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-14.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-14.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-14.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,4 @@\n+/* PR 24931 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-14.c\""}, {"sha": "121f0cff274a3732ff6b233a5a0391111fcc6a77", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-15.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-15.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-15.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-15.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,26 @@\n+/* PR tree-optimization/17506\n+   We issue an uninitialized variable warning at a wrong location at\n+   line 11, which is very confusing.  Make sure we print out a note to\n+   make it less confusing.  (not xfailed alternative)\n+   But it is of course ok if we warn in bar about uninitialized use\n+   of j.  (not xfailed alternative)  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+inline int\n+foo (int i)\n+{\n+  if (i) /* { dg-warning \"used uninitialized\" } */\n+    return 1;\n+  return 0;\n+}\n+\n+void baz (void);\n+\n+void\n+bar (void)\n+{\n+  int j; /* { dg-message \"note: 'j' was declared here\" \"\" } */\n+  for (; foo (j); ++j)  /* { dg-warning \"'j' is used uninitialized\" \"\" { xfail *-*-* } } */\n+    baz ();\n+}"}, {"sha": "38e19502a679e43289918341ee65b624ec6bf496", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-16.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-16.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,25 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+/* -ftrivial-auto-var-init will make the uninitialized warning for address\n+   taken auto var going away, FIXME later.  */\n+\n+int foo, bar;\n+\n+static\n+void decode_reloc(int reloc, int *is_alt)\n+{\n+  if (reloc >= 20)\n+      *is_alt = 1;\n+  else if (reloc >= 10)\n+      *is_alt = 0;\n+}\n+\n+void testfunc()\n+{\n+  int alt_reloc;\n+\n+  decode_reloc(foo, &alt_reloc);\n+\n+  if (alt_reloc) /* { dg-warning \"may be used uninitialized\" \"\" { xfail *-*-* }  }  */\n+    bar = 42;\n+}"}, {"sha": "9eec9440c75edc787ba37f68c0ed994faec9add0", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-17.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-17.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-17.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-17.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+typedef _Complex float C;\n+C foo(int cond)\n+{\n+  C f;\n+  __imag__ f = 0;\n+  if (cond)\n+    {\n+      __real__ f = 1;\n+      return f;\n+    }\n+  return f;\t/* { dg-warning \"may be used\" \"unconditional\" } */\n+}"}, {"sha": "1c9afa928c8d09da496a33507ca2cada45f58599", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-18.c", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-18.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-18.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-18.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile }  */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-18.c\""}, {"sha": "38d27e4f9548c51a54cff29d1d88dd0b0599d3f2", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-19.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-19.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-19.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-19.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,26 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+/* { dg-additional-options \"-finline-small-functions\" { target avr-*-* } } */\n+\n+int a, l, m;\n+float *b;\n+float c, d, e, g, h;\n+unsigned char i, k;\n+void\n+fn1 (int p1, float *f1, float *f2, float *f3, unsigned char *c1, float *f4,\n+     unsigned char *c2, float *p10)\n+{\n+  if (p1 & 8)\n+    b[3] = p10[a];\n+  /* { dg-warning \"may be used uninitialized\" \"\" { target { { nonpic || pie_enabled } || { hppa*64*-*-* *-*-darwin* } } } .-1 } */\n+}\n+\n+void\n+fn2 ()\n+{\n+  float *n;\n+  if (l & 6)\n+    n = &c + m;\n+  fn1 (l, &d, &e, &g, &i, &h, &k, n);\n+  /* { dg-warning \"may be used uninitialized\" \"\" { target { ! { { nonpic || pie_enabled } || { hppa*64*-*-* *-*-darwin* } } } } .-1 } */\n+}"}, {"sha": "4c32dc86397e89df6122bd019898aa8a281ba361", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-2.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,5 @@\n+/* Spurious uninitialized variable warnings, case 2.\n+   Taken from cpphash.c (macroexpand) */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-2.c\""}, {"sha": "d81957e5bb9484926a2266490ab5ac332b0b6810", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-20.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-20.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-20.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-20.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,4 @@\n+/* Spurious uninitialized variable warnings, from gdb */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-20.c\""}, {"sha": "cc617460736756519a08fb7114b9e5688f0bef69", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-21.c", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-21.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-21.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-21.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,4 @@\n+/* PR69537, spurious warning because of a missed optimization. */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fno-short-enums -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-21.c\""}, {"sha": "1e522ce542555417a2cedd7ed607d622dca4c849", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-22.c", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-22.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-22.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-22.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -Wuninitialized --param vect-max-version-for-alias-checks=20 -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-22.c\""}, {"sha": "f1f783973ae49f52374a58abebac589d56e4a197", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-23.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-23.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-23.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-23.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,27 @@\n+/* PR tree-optimization/78455 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+int ij;\n+\n+void\n+ql (void)\n+{\n+  int m5 = 0;\n+\n+  for (;;)\n+  {\n+    if (0)\n+      for (;;)\n+      {\n+        int *go;\n+        int *t4 = go; /* { dg-warning \"is used uninitialized\" } */\n+\n+ l1:\n+        *t4 = (*t4 != 0) ? 0 : 2; /* { dg-warning \"is used uninitialized\" } */\n+      }\n+\n+    if (ij != 0)\n+      goto l1;\n+  }\n+}"}, {"sha": "0f839ba9efa8e8a705d023db869766008da806a2", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-24.c", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-24.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-24.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-24.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wmaybe-uninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-24.c\""}, {"sha": "f36d95f9d27936dffa51a7c6a1776db83fd50911", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-25.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-25.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-25.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-25.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,23 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wmaybe-uninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+extern unsigned bar (void);\n+extern void quux (void);\n+\n+unsigned foo (unsigned v)\n+{\n+  unsigned u;\n+  if (v != 1)\n+    u = bar ();\n+\n+  // Prevent the \"dom\" pass from changing the CFG layout based on the inference\n+  // 'if (v != 1) is false then (v != 2) is true'.  (Now it would have to\n+  // duplicate the loop in order to do so, which is deemed expensive.)\n+  for (int i = 0; i < 10; i++)\n+    quux ();\n+\n+  if (v != 2)\n+    return u;       /* { dg-warning \"may be used uninitialized\" } */\n+\n+  return 0;\n+}"}, {"sha": "ae97ecfa71e1368e5743688bbf316370307fbfa3", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-26.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-26.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-26.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-26.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,23 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wmaybe-uninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+extern unsigned bar (void);\n+extern void quux (void);\n+\n+unsigned foo (unsigned v)\n+{\n+  unsigned u;\n+  if (v != 100)\n+    u = bar ();\n+\n+  // Prevent the \"dom\" pass from changing the CFG layout based on the inference\n+  // 'if (v != 100) is false then (v < 105) is true'.  (Now it would have to\n+  // duplicate the loop in order to do so, which is deemed expensive.)\n+  for (int i = 0; i < 10; i++)\n+    quux ();\n+\n+  if (v < 105) /* v == 100 falls into this range.  */\n+    return u;       /* { dg-warning \"may be used uninitialized\" }  */\n+\n+  return 0;\n+}"}, {"sha": "5c109202a5ef09423dae6b68a22ad6dcdb49f70f", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-3.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-3.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,5 @@\n+/* Spurious uninit variable warnings, case 3.\n+   Inspired by cppexp.c (parse_charconst) */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-3.c\""}, {"sha": "1a687654ebb7f4f95efffba2839172625ee88e84", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-34.c", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-34.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-34.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-34.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,60 @@\n+/* PR middle-end/10138 - warn for uninitialized arrays passed as const*\n+   arguments\n+   Verify that passing pointers to uninitialized objects to arguments\n+   to functions declared with attribute access is diagnosed where expected.\n+   { dg-do compile }\n+   { dg-options \"-O -Wall -ftrivial-auto-var-init=zero\" } */\n+/* -ftrivial-auto-var-init will make the uninitialized warning for address\n+   taken auto var going away, FIXME later.  */\n+\n+#define RW(...) __attribute__ ((access (read_write, __VA_ARGS__)))\n+\n+RW (1) RW (3) void\n+f4pi (int*, int*, int*, int*);    // { dg-message \"in a call to 'f4pi' declared with attribute 'access \\\\\\(read_write, \\[13\\]\\\\\\)'\" }\n+\n+\n+void nowarn_scalar (void)\n+{\n+  int i1 = 0, i2, i3 = 1, i4;\n+  f4pi (&i1, &i2, &i3, &i4);\n+}\n+\n+void warn_scalar_1 (void)\n+{\n+  int i1;                         // { dg-message \"declared here\" \"\" { xfail *-*-* } }\n+  int i2, i3 = 1, i4;\n+\n+  f4pi (&i1, &i2, &i3, &i4);      // { dg-warning \"'i1' may be used uninitialized\" \"\" { xfail *-*-* } }\n+}\n+\n+void warn_scalar_2 (void)\n+{\n+  int j1 = 0, j2, j4;\n+  int j3;\n+\n+  f4pi (&j1, &j2, &j3, &j4);      // { dg-warning \"'j3' may be used uninitialized\" \"\" { xfail *-*-* } }\n+}\n+\n+\n+void nowarn_array_init (void)\n+{\n+  int a1[4] = { 0 }, a2[5], a3[6] = { 0 }, a4[7];\n+\n+  f4pi (a1, a2, a3, a4);\n+}\n+\n+void warn_array_1 (void)\n+{\n+  int a1[4];                  // { dg-message \"'a1' declared here\" }\n+  int a2[5], a3[6] = { 0 }, a4[7];\n+\n+  f4pi (a1, a2, a3, a4);      // { dg-warning \"'a1' may be used uninitialized\" }\n+}\n+\n+void warn_array_2 (void)\n+{\n+  int a1[4] = { 0 }, a2[5], a4[7];\n+  int a3[6];                  // { dg-message \"'a3' declared here\" }\n+\n+  f4pi (a1, a2, a3, a4);      // { dg-warning \"'a3' may be used uninitialized\" }\n+}"}, {"sha": "64377d380ee914b0c9fd2cf5512d7e670af335ea", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-36.c", "status": "added", "additions": 238, "deletions": 0, "changes": 238, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-36.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-36.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-36.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,238 @@\n+/* PR middle-end/10138 - warn for uninitialized arrays passed as const*\n+   arguments\n+   Verify that passing pointers to uninitialized objects to const\n+   arguments to built-ins is diagnosed where expected.\n+   { dg-do compile }\n+   { dg-options \"-O -Wall -ftrivial-auto-var-init=zero\" }\n+   { dg-require-effective-target alloca } */\n+\n+typedef __SIZE_TYPE__ size_t;\n+\n+void* alloca (size_t);\n+void* malloc (size_t);\n+void* realloc (void*, size_t);\n+\n+void* memcpy (void*, const void*, size_t);\n+char* strcpy (char*, const char*);\n+size_t strlen (const char*);\n+\n+void sink (void*);\n+\n+void nowarn_array_memcpy (void *d, unsigned n)\n+{\n+  int a[2];\n+  /* Diagnose this?  */\n+  memcpy (d, a, n /* Non-constant to avoid folding into MEM_REF.  */);\n+}\n+\n+void nowarn_array_plus_cst_memcpy (void *d, unsigned n)\n+{\n+  int a[3];\n+  /* Diagnose this?  */\n+  memcpy (d, a + 1, n);\n+}\n+\n+void nowarn_array_plus_var_memcpy (void *d, unsigned n, int i)\n+{\n+  int a[4];\n+  /* Diagnose this?  */\n+  memcpy (d, a + i, n);\n+}\n+\n+void nowarn_array_assign_memcpy (char *d, unsigned n)\n+{\n+  int a[3];\n+  a[1] = 3;\n+  memcpy (d, a, n);\n+}\n+\n+void nowarn_array_init_memcpy (char *d, unsigned n)\n+{\n+  int a[4] = { 0 };\n+  memcpy (d, a, n);\n+}\n+\n+void nowarn_array_compound_memcpy (void *d, unsigned n)\n+{\n+  memcpy (d, (int[2]){ 0 }, n);\n+}\n+\n+void nowarn_struct_assign_memcpy (void *d, unsigned n)\n+{\n+  struct S { int a, b, c, d; } s;\n+  s.b = 1;\n+  s.d = 2;\n+  memcpy (d, &s, n);\n+}\n+\n+\n+void nowarn_array_init_strcpy (char *d[], unsigned n)\n+{\n+  char a[8] = \"012\";\n+\n+  strcpy (d[0], a);\n+  strcpy (d[1], a + 1);\n+  strcpy (d[1], a + 2);\n+  strcpy (d[1], a + 3);\n+  strcpy (d[1], a + 4);\n+  strcpy (d[1], a + 5);\n+  strcpy (d[1], a + 6);\n+  strcpy (d[1], a + 7);\n+}\n+\n+\n+void nowarn_array_assign_strcpy (char *d[], unsigned n)\n+{\n+  char a[8];\n+  a[0] = '0';\n+  a[1] = '1';\n+  a[2] = '2';\n+  a[3] = '\\0';\n+\n+  strcpy (d[0], a);\n+  strcpy (d[1], a + 1);\n+  strcpy (d[1], a + 2);\n+  strcpy (d[1], a + 3);\n+}\n+\n+void warn_array_plus_cst_strcpy (char *d, unsigned n)\n+{\n+  char a[8];\n+  a[0] = '1';\n+  a[1] = '2';\n+  a[2] = '3';\n+  a[3] = '\\0';\n+\n+  strcpy (d, a + 4);          // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+  strcpy (d, a + 5);          // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+  strcpy (d, a + 6);          // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+  strcpy (d, a + 7);          // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+}\n+\n+void nowarn_array_plus_var_strcpy (char *d, int i)\n+{\n+  char a[8];\n+  a[0] = '1';\n+  a[1] = '2';\n+  a[2] = '3';\n+  a[3] = '\\0';\n+\n+  strcpy (d, a + i);\n+}\n+\n+\n+size_t nowarn_array_assign_strlen (const char *s)\n+{\n+  char a[8];\n+  a[0] = s[0];\n+  a[1] = s[1];\n+  a[2] = s[2];\n+  a[3] = s[3];\n+\n+  size_t n = 0;\n+\n+  n += strlen (a);\n+  n += strlen (a + 1);\n+  n += strlen (a + 2);\n+  n += strlen (a + 3);\n+  return n;\n+}\n+\n+size_t warn_array_plus_cst_strlen (const char *s)\n+{\n+  char a[8];\n+  a[0] = s[0];\n+  a[1] = s[1];\n+  a[2] = s[2];\n+  a[3] = s[3];\n+\n+  return strlen (a + 4);      // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+}\n+\n+size_t nowarn_array_plus_var_strlen (const char *s, int i)\n+{\n+  char a[8];\n+  a[0] = s[0];\n+  a[1] = s[1];\n+  a[2] = s[2];\n+  a[3] = s[3];\n+\n+  return strlen (a + i);\n+}\n+\n+\n+size_t nowarn_alloca_assign_strlen (int i)\n+{\n+  char *p = (char*)alloca (8);\n+  p[i] = '\\0';\n+  return strlen (p);\n+}\n+\n+size_t nowarn_alloca_escape_strlen (int i)\n+{\n+  char *p = (char*)alloca (8);\n+  sink (p);\n+  return strlen (p);\n+}\n+\n+size_t warn_alloca_strlen (void)\n+{\n+  char *p = (char*)alloca (8);\n+  return strlen (p);          // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+}\n+\n+\n+size_t nowarn_malloc_assign_strlen (int i)\n+{\n+  char *p = (char*)malloc (8);\n+  p[i] = '\\0';\n+  return strlen (p);\n+}\n+\n+size_t nowarn_malloc_escape_strlen (int i)\n+{\n+  char *p = (char*)malloc (8);\n+  sink (p);\n+  return strlen (p);\n+}\n+\n+size_t warn_malloc_strlen (void)\n+{\n+  char *p = (char*)malloc (8);\n+  return strlen (p);          // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+}\n+\n+\n+size_t nowarn_realloc_strlen (void *p)\n+{\n+  char *q = (char*)realloc (p, 8);\n+  return strlen (q);\n+}\n+\n+\n+size_t nowarn_vla_assign_strlen (int n, int i)\n+{\n+  char vla[n];\n+  vla[i] = '\\0';\n+  return strlen (vla);\n+}\n+\n+size_t nowarn_vla_strcpy_strlen (int n, const char *s, int i)\n+{\n+  char vla[n];\n+  strcpy (vla, s);\n+  return strlen (vla + i);\n+}\n+\n+size_t nowarn_vla_escape_strlen (int n, int i)\n+{\n+  char vla[n];\n+  sink (vla);\n+  return strlen (vla);\n+}\n+\n+size_t warn_vla_strlen (unsigned n)\n+{\n+  char vla[n];\n+  return strlen (vla);        // { dg-warning \"\\\\\\[-Wuninitialized\" }\n+}"}, {"sha": "2791b37ca00947b3e2b722ad88f49f1c26f7bd77", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-37.c", "status": "added", "additions": 156, "deletions": 0, "changes": 156, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-37.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-37.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-37.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,156 @@\n+/* PR middle-end/10138 - warn for uninitialized arrays passed as const arguments\n+   Verify that -Wuninitialized and -Wmaybe-uninitialized trigger (or don't)\n+   when passing uninitialized variables by reference to functions declared\n+   with or without attribute access and with (or without) const qualified\n+   arguments of array, VLA, or pointer types.\n+   { dg-do compile }\n+   { dg-options \"-O2 -Wall -ftrack-macro-expansion=0 -ftrivial-auto-var-init=zero\" } */\n+/* -ftrivial-auto-var-init will make the uninitialized warning for address\n+   taken auto var going away, FIXME later.  */\n+\n+#define NONE    /* none */\n+#define RO(...) __attribute__ ((access (read_only, __VA_ARGS__)))\n+#define RW(...) __attribute__ ((access (read_write, __VA_ARGS__)))\n+#define WO(...) __attribute__ ((access (write_only, __VA_ARGS__)))\n+#define X(...)  __attribute__ ((access (none, __VA_ARGS__)))\n+\n+#define CONCAT(x, y) x ## y\n+#define CAT(x, y)    CONCAT (x, y)\n+#define UNIQ(pfx)    CAT (pfx, __LINE__)\n+\n+extern void sink (void*);\n+\n+\n+#define T1(attr, name, type)\t\t\t\\\n+  void UNIQ (CAT (test_, name))(void) {\t\t\\\n+    extern attr void UNIQ (name)(type);\t\t\\\n+    int x;\t\t\t\t\t\\\n+    UNIQ (name)(&x);\t\t\t\t\\\n+    sink (&x);\t\t\t\t\t\\\n+  }\n+\n+#define T2(attr, name, types)\t\t\t\\\n+  void UNIQ (CAT (test_, name))(void) {\t\t\\\n+    extern attr void UNIQ (name)(types);\t\\\n+    int x;\t\t\t\t\t\\\n+    UNIQ (name)(1, &x);\t\t\t\t\\\n+    sink (&x);\t\t\t\t\t\\\n+  }\n+\n+\n+typedef int IA_[];\n+typedef const int CIA_[];\n+\n+T1 (NONE,   fia_,   IA_);\n+T1 (NONE,   fcia_,  CIA_);    // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (RO (1), froia_, IA_);     // { dg-warning \"\\\\\\[-Wuninitialized\" \"\" { xfail *-*-* } }\n+T1 (RW (1), frwia_, IA_);     // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (WO (1), fwoia_, IA_);\n+T1 (X (1),  fxia_,  IA_);\n+\n+\n+typedef int IA1[1];\n+typedef const int CIA1[1];\n+\n+T1 (NONE,   fia1,   IA1);\n+T1 (NONE,   fcia1,  CIA1);    // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (RO (1), froia1, IA1);     // { dg-warning \"\\\\\\[-Wuninitialized\" \"\" { xfail *-*-* } }\n+T1 (RW (1), frwia1, IA1);     // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (WO (1), fwoia1, IA1);\n+T1 (X (1),  fxia1,  IA1);\n+\n+\n+#define IARS1  int[restrict static 1]\n+#define CIARS1 const int[restrict static 1]\n+\n+T1 (NONE,   fiars1,   IARS1);\n+T1 (NONE,   fciars1,  CIARS1);// { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (RO (1), froiars1, IARS1); // { dg-warning \"\\\\\\[-Wuninitialized\" \"\" { xfail *-*-* } }\n+T1 (RW (1), frwiars1, IARS1); // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (WO (1), fwoiars1, IARS1);\n+T1 (X (1),  fxiars1,  IARS1);\n+\n+\n+#define IAS1  int[static 1]\n+#define CIAS1 const int[static 1]\n+\n+T1 (NONE,   fias1,   IAS1);\n+T1 (NONE,   fcias1,  CIAS1);   // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (RO (1), froias1, IAS1);    // { dg-warning \"\\\\\\[-Wuninitialized\" \"\" { xfail *-*-* } }\n+T1 (RW (1), frwias1, IAS1);    // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (WO (1), fwoias1, IAS1);\n+T1 (X (1),  fxias1,  IAS1);\n+\n+\n+#define IAX  int[*]\n+#define CIAX const int[*]\n+\n+T1 (NONE,   fiax,   IAX);\n+T1 (NONE,   fciax,  CIAX);    // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (RO (1), froiax, IAX);     // { dg-warning \"\\\\\\[-Wuninitialized\" \"\" { xfail *-*-* } }\n+T1 (RW (1), frwiax, IAX);     // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (WO (1), fwoiax, IAX);\n+T1 (X (1),  fxiax,  IAX);\n+\n+\n+#define IAN  int n, int[n]\n+#define CIAN int n, const int[n]\n+\n+T2 (NONE,      fian,   IAN);\n+T2 (NONE,      fcian,  CIAN); // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T2 (RO (2, 1), froian, IAN);  // { dg-warning \"\\\\\\[-Wuninitialized\" \"\" { xfail *-*-* } }\n+T2 (RW (2, 1), frwian, IAN);  // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T2 (WO (2, 1), fwoian, IAN);\n+T2 (X (2, 1),  fxian,  IAN);\n+\n+\n+typedef int* IP;\n+typedef const int* CIP;\n+\n+T1 (NONE,   fip,   IP);\n+T1 (NONE,   fcip,  CIP);     // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (RO (1), froip, IP);      // { dg-warning \"\\\\\\[-Wuninitialized\" \"\" { xfail *-*-* } }\n+T1 (RW (1), frwip, IP);      // { dg-warning \"\\\\\\[-Wmaybe-uninitialized\" \"\" { xfail *-*-* } }\n+T1 (WO (1), fwoip, IP);\n+T1 (X (1),  fxip,  IP);\n+\n+\n+/* Verify that the notes printed after the warning mention attribute\n+   access only when the attribute is explicitly used in the declaration\n+   and not otherwise.  */\n+\n+void test_note_cst_restrict (void)\n+{\n+  extern void\n+    fccar (const char[restrict]);   // { dg-message \"by argument 1 of type 'const char\\\\\\[restrict]' to 'fccar'\" \"note\" }\n+\n+  char a[1];                  // { dg-message \"'a' declared here\" \"note\" }\n+  fccar (a);                  // { dg-warning \"'a' may be used uninitialized\" }\n+}\n+\n+void test_note_vla (int n)\n+{\n+  extern void\n+    fccvla (const char[n]);   // { dg-message \"by argument 1 of type 'const char\\\\\\[n]' to 'fccvla'\" \"note\" }\n+\n+  char a[2];                  // { dg-message \"'a' declared here\" \"note\" }\n+  fccvla (a);                 // { dg-warning \"'a' may be used uninitialized\" }\n+}\n+\n+void test_note_ro (void)\n+{\n+  extern RO (1) void\n+    frocar (char[restrict]);  // { dg-message \"in a call to 'frocar' declared with attribute 'access \\\\\\(read_only, 1\\\\\\)'\" \"note\" }\n+\n+  char a[3];                  // { dg-message \"'a' declared here\" \"note\" }\n+  frocar (a);                 // { dg-warning \"'a' is used uninitialized\" }\n+}\n+\n+void test_note_rw (void)\n+{\n+  extern RW (1) void\n+    frwcar (char[restrict]);  // { dg-message \"in a call to 'frwcar' declared with attribute 'access \\\\\\(read_write, 1\\\\\\)'\" \"note\" }\n+\n+  char a[4];                  // { dg-message \"'a' declared here\" \"note\" }\n+  frwcar (a);                 // { dg-warning \"'a' may be used uninitialized\" }\n+}"}, {"sha": "29ec860f0ed89d4fe82253a5fcfa55cf9873e9a8", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-4.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-4.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,10 @@\n+/* Spurious uninit variable warnings, case 4.\n+   Simplified version of cppexp.c (cpp_parse_expr).\n+\n+   This one is really fragile, it gets it right if you take out case\n+   1, or if the structure is replaced by an int, or if the structure\n+   has fewer members (!) */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-4.c\""}, {"sha": "65b251a2185f1d13114b21f2fc0b6a839518833c", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-5.c", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-5.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,6 @@\n+/* Spurious uninitialized-variable warnings.  */\n+/* Disable jump threading, etc to test compiler analysis.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -fno-tree-dce -fno-tree-vrp -fno-tree-dominator-opts -ftrivial-auto-var-init=zero\" } */\n+\n+#include \"uninit-5.c\""}, {"sha": "7c10dfc5895b353644eb509168f95a513e37611b", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-6.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-6.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,7 @@\n+/* Spurious uninitialized variable warnings.\n+   This one inspired by java/class.c:build_utf8_ref.  */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+#include \"uninit-6.c\""}, {"sha": "eaa9c0c9093fa7ead3fa1f8a3165082eee859fb2", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-8.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-8.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,8 @@\n+/* Uninitialized variable warning tests...\n+   Inspired by part of optabs.c:expand_binop.\n+   May be the same as uninit-1.c.  */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+#include \"uninit-8.c\""}, {"sha": "6dccf014fe2bedb5a40e64352c8625ddc4208c5d", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-9.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-9.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,8 @@\n+/* Spurious uninitialized variable warnings.  Slight variant on the\n+   documented case, inspired by reg-stack.c:record_asm_reg_life.  */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+/* { dg-require-effective-target alloca } */\n+\n+#include \"uninit-9.c\""}, {"sha": "0ef1d92a74738408d6758e36cf097a25c4923312", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-A.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-A.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-A.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-A.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,7 @@\n+/* Inspired by part of java/parse.y.\n+   May be a real bug in CSE. */\n+\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -Wall -ftrivial-auto-var-init=zero\" } */\n+\n+#include \"uninit-A.c\""}, {"sha": "b6d3efdfb88084dae77f0ce61991158d384b59aa", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-B.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-B.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-B.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-B.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,17 @@\n+/* Origin: PR c/179 from Gray Watson <gray@256.com>, adapted as a testcase\n+   by Joseph Myers <jsm28@cam.ac.uk>.  */\n+/* -ftrivial-auto-var-init will make the uninitialized warning for address\n+   taken auto var going away, FIXME later.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+extern void foo (int *);\n+extern void bar (int);\n+\n+void\n+baz (void)\n+{\n+  int i;\n+  if (i) /* { dg-warning \"is used uninitialized\" \"uninit i warning\" { xfail *-*-* } }  */\n+    bar (i);\n+  foo (&i);\n+}"}, {"sha": "be1979626447c412a40d585526014fffd36d4dac", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-C.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-C.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-C.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-C.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,5 @@\n+/* Spurious uninitialized variable warning, inspired by libgcc2.c.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+\n+#include \"uninit-C.c\""}, {"sha": "e442fab00be6f35e588b0adb758c02d52ee06dc4", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-H.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-H.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-H.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-H.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,5 @@\n+/* PR 14204 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -Wall -Werror -ftrivial-auto-var-init=zero\" } */\n+\n+#include \"uninit-H.c\""}, {"sha": "4f9ae6cd98cd5acddf0b84b86151f6ddce9dcf83", "filename": "gcc/testsuite/gcc.dg/auto-init-uninit-I.c", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-I.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-I.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fauto-init-uninit-I.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,3 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -Wuninitialized -ftrivial-auto-var-init=zero\" } */\n+#include \"uninit-H.c\""}, {"sha": "0fa470880bf5d7dcd1d852aee4992480174e8025", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-1.c", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,32 @@\n+/* Verify zero initialization for integer and pointer type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+#ifndef __cplusplus\n+# define bool _Bool\n+#endif\n+\n+enum E {\n+  N1 = 0,\n+  N2,\n+  N3\n+};\n+\n+extern void bar (char, short, int, enum E, long, long long, int *, bool);\n+\n+void foo()\n+{\n+  char temp1;\n+  short temp2;\n+  int temp3;\n+  enum E temp4;\n+  long temp5;\n+  long long temp6;\n+  int *temp7;\n+  bool temp8;\n+\n+  bar (temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8);\n+  return;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_int 0\" 11 \"expand\" } } */"}, {"sha": "2c54e6d603823281fc0e7058b179c115ef58872a", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-2.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,35 @@\n+/* Verify pattern initialization for integer and pointer type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+#ifndef __cplusplus\n+# define bool _Bool\n+#endif\n+\n+enum E {\n+  N1 = 0,\n+  N2,\n+  N3\n+};\n+\n+extern void bar (char, short, int, enum E, long, long long, int *, bool);\n+\n+void foo()\n+{\n+  char temp1;\n+  short temp2;\n+  int temp3;\n+  enum E temp4;\n+  long temp5;\n+  long long temp6;\n+  int *temp7;\n+  bool temp8;\n+\n+  bar (temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8);\n+  return;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfe\\\\\\]\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffefe\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 2 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfefefefefefefefe\" 2 \"expand\" } } */"}, {"sha": "7008f76b294cd349598009b910f427f248638ce3", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-3.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-3.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify zero initialization for floating point type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+long double result;\n+\n+long double foo()\n+{\n+  float temp1;\n+  double temp2;\n+  long double temp3;\n+  \n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_double\\:SF 0\\.0\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"const_double\\:DF 0\\.0\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"const_double\\:TF 0\\.0\" 1 \"expand\" } } */"}, {"sha": "10197045b4cded7e240fe7ce07ca6fb7decdc4ca", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-4.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-4.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify pattern initialization for floating point type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O -ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+long double result;\n+\n+long double foo()\n+{\n+  float temp1;\n+  double temp2;\n+  long double temp3;\n+  \n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump \"\\\\-0x0\\\\.fefefep\\\\+127\" \"expand\" } } */\n+/* { dg-final { scan-rtl-dump \"\\\\-0x0\\\\.f7f7f7f7f7f7fp\\\\+1009\" \"expand\" } } */\n+/* { dg-final { scan-rtl-dump \"\\\\-0x0\\\\.ff7f7f7f7f7f7f7f7f7f7f7f7f7fp\\\\+16128\" \"expand\" } } */"}, {"sha": "ac69ac3df82e6a2374b022348e038bdb668e1a3c", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-5.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-5.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify zero initialization for complex type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+\n+_Complex long double result;\n+\n+_Complex long double foo()\n+{\n+  _Complex float temp1;\n+  _Complex double temp2;\n+  _Complex long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-assembler-times \"\\.word\\t0\" 14 } } */\n+"}, {"sha": "27c16b33678950fabeb6d481a930f9fe68493034", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-6.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-6.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,18 @@\n+/* Verify pattern initialization for complex type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+\n+_Complex long double result;\n+\n+_Complex long double foo()\n+{\n+  _Complex float temp1;\n+  _Complex double temp2;\n+  _Complex long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 3 \"expand\" } } */"}, {"sha": "ac27fbe92f4a369913183853efb67e07a34d7b11", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-7.c", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-7.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,32 @@\n+/* Verify zero initialization for array, union, and structure type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+struct S\n+{\n+  int f1;\n+  float f2;\n+  char f3[20];\n+};\n+\n+union U\n+{\n+  char u1[5];\n+  int u2;\n+  float u3; \n+};\n+\n+double result;\n+\n+double foo()\n+{\n+  int temp1[3];\n+  double temp2[3];\n+  struct S temp3;\n+  union U temp4;\n+  \n+  result = temp1[2] + temp2[1] + temp3.f2 + temp4.u3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_int 0\" 8 \"expand\" } } */"}, {"sha": "3943f5a4d6b270f56f464b76bfd40c8053b51ce7", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-8.c", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-8.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,32 @@\n+/* Verify pattern initialization for array, union, and structure type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct S\n+{\n+  int f1;\n+  float f2;\n+  char f3[20];\n+};\n+\n+union U\n+{\n+  char u1[5];\n+  int u2;\n+  float u3; \n+};\n+\n+double result;\n+\n+double foo()\n+{\n+  int temp1[3];\n+  double temp2[3];\n+  struct S temp3;\n+  union U temp4;\n+  \n+  result = temp1[2] + temp2[1] + temp3.f2 + temp4.u3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 4 \"expand\" } } */"}, {"sha": "d3a88c724545445b08246628d5546cb5cff956c6", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-1.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,17 @@\n+/* Verify zero initialization for structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_aligned {\n+        int internal1;\n+        long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+int foo ()\n+{\n+  struct test_aligned var;\n+  return var.internal1;\n+}\n+\n+/* { dg-final { scan-assembler-times \"stp\\tq0, q0,\" 2 } } */"}, {"sha": "b0f3acb2f52863b2bef538091ef9b75c45f485db", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-10.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-10.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-10.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-10.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify pattern initialization for array type with structure element with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var[10]; \n+  return var[2].four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+"}, {"sha": "02f7edc51008ade8d7fae75bd3e47b89186a8754", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-11.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-11.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-11.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-11.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,27 @@\n+/* Verify zero initialization for union type with structure field with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+union test_union_padding {\n+  struct test_trailing_hole u1;\n+  long long u2;\n+};\n+\n+\n+int foo ()\n+{\n+  union test_union_padding var;\n+  return var.u1.four;\n+}\n+\n+/* { dg-final { scan-assembler \"stp\\txzr, xzr,\" } } */\n+"}, {"sha": "555972f1728f42e12153dba675387dd4c68ab0fb", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-12.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-12.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-12.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-12.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,27 @@\n+/* Verify pattern initialization for union type with structure field with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+union test_union_padding {\n+  struct test_trailing_hole u1;\n+  long long u2;\n+};\n+\n+\n+int foo ()\n+{\n+  union test_union_padding var;\n+  return var.u1.four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+"}, {"sha": "aceceb87fbe16ab6e291f75b10c90d47b7fa1b4f", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-2.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,18 @@\n+/* Verify pattern initialization for structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern\" } */\n+\n+struct test_aligned {\n+        int internal1;\n+        long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+int foo ()\n+{\n+  struct test_aligned var;\n+  return var.internal1;\n+}\n+\n+/* { dg-final { scan-assembler-times \"stp\\tq0, q0,\" 2 } } */\n+"}, {"sha": "085c3862921053ea0a970b94318078c376a03dc9", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-3.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-3.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,27 @@\n+/* Verify zero initialization for nested structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_aligned {\n+        unsigned internal1;\n+        unsigned long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+struct test_big_hole {\n+        char one;\n+        char two;\n+        char three;\n+        /* 61 byte padding hole here. */\n+        struct test_aligned four;\n+} __attribute__ ((aligned(64)));\n+\n+\n+int foo ()\n+{\n+  struct test_big_hole var;\n+  return var.four.internal1;\n+}\n+\n+/* { dg-final { scan-assembler-times \"stp\\tq0, q0,\" 4 } } */\n+"}, {"sha": "7a6ddbc20ee1fc26b485b349f1f897fef0b65155", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-4.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-4.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,27 @@\n+/* Verify pattern initialization for nested structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern\" } */\n+\n+struct test_aligned {\n+        unsigned internal1;\n+        unsigned long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+struct test_big_hole {\n+        char one;\n+        char two;\n+        char three;\n+        /* 61 byte padding hole here. */\n+        struct test_aligned four;\n+} __attribute__ ((aligned(64)));\n+\n+\n+int foo ()\n+{\n+  struct test_big_hole var;\n+  return var.four.internal1;\n+}\n+\n+/* { dg-final { scan-assembler-times \"stp\\tq0, q0,\" 5 } } */\n+"}, {"sha": "3c45a6c6288d7447b68fd362e0ad541d9fae0beb", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-5.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-5.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify zero initialization for structure type automatic variables with\n+   tail padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_trailing_hole {\n+        char *one;\n+        char *two;\n+        char *three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var;\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-assembler-times \"stp\\txzr, xzr,\" 2 } } */\n+\n+"}, {"sha": "bfef23d52a10cb4abf9c4430cb91747675779be7", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-6.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-6.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,20 @@\n+/* Verify pattern initialization for structure type automatic variables with\n+   tail padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        char *one;\n+        char *two;\n+        char *three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var;\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */"}, {"sha": "cb96c3a1e4b21ceeaeecee77cd2d9f552f97c690", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-7.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-7.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,20 @@\n+/* Verify zero initialization for structure type automatic variables with\n+   padding and has explicit initialization.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var = {.one = 1,.two = 2, .four = 'c'};\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-assembler \"stp\\txzr, xzr,\" } } */"}, {"sha": "ce7c7cd31c1f8f42d97fbf8ecfd756beca2db2c0", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-8.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-8.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify pattern initialization for structure type automatic variables with\n+   padding and has explicit initialization.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var = {.one = 1,.two = 2, .four = 'c'};\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-assembler \"stp\\txzr, xzr,\" } } */\n+\n+"}, {"sha": "c81e5ff28b0b7a9281b8b0f58fc9cca7adc57797", "filename": "gcc/testsuite/gcc.target/aarch64/auto-init-padding-9.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fauto-init-padding-9.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,21 @@\n+/* Verify zero initialization for array type with structure element with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var[10]; \n+  return var[2].four;\n+}\n+\n+/* { dg-final { scan-assembler-times \"stp\\tq0, q0,\" 5 } } */"}, {"sha": "b7690df2406069e82e9cd0647dd837438afe630a", "filename": "gcc/testsuite/gcc.target/i386/auto-init-1.c", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,32 @@\n+/* Verify zero initialization for integer and pointer type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+#ifndef __cplusplus\n+# define bool _Bool\n+#endif\n+\n+enum E {\n+  N1 = 0,\n+  N2,\n+  N3\n+};\n+\n+extern void bar (char, short, int, enum E, long, long long, int *, bool);\n+\n+void foo()\n+{\n+  char temp1;\n+  short temp2;\n+  int temp3;\n+  enum E temp4;\n+  long temp5;\n+  long long temp6;\n+  int *temp7;\n+  bool temp8;\n+\n+  bar (temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8);\n+  return;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_int 0\" 10 \"expand\" } } */"}, {"sha": "e76fc2565168b19784122bcab04e6a68a6b4a403", "filename": "gcc/testsuite/gcc.target/i386/auto-init-2.c", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,36 @@\n+/* Verify pattern initialization for integer and pointer type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+#ifndef __cplusplus\n+# define bool _Bool\n+#endif\n+\n+enum E {\n+  N1 = 0,\n+  N2,\n+  N3\n+};\n+\n+extern void bar (char, short, int, enum E, long, long long, int *, bool);\n+\n+void foo()\n+{\n+  char temp1;\n+  short temp2;\n+  int temp3;\n+  enum E temp4;\n+  long temp5;\n+  long long temp6;\n+  int *temp7;\n+  bool temp8;\n+\n+  bar (temp1, temp2, temp3, temp4, temp5, temp6, temp7, temp8);\n+  return;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\" 2 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffefe\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 2 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfefefefefefefefe\" 3 \"expand\" } } */\n+"}, {"sha": "1192a908f9df4a48b0f9e26c4a22570324ede044", "filename": "gcc/testsuite/gcc.target/i386/auto-init-21.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-21.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-21.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-21.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,14 @@\n+/* Verify zero initialization for VLA automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+extern void bar (int);\n+\n+void foo(int n)\n+{\n+  int arr[n];\n+  bar (arr[2]);\n+  return;\n+}\n+\n+/* { dg-final { scan-rtl-dump \"__builtin_memset\" \"expand\" } } */"}, {"sha": "431d9664e94f8e41d2e9fb5fdf91b5231b9e1320", "filename": "gcc/testsuite/gcc.target/i386/auto-init-22.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-22.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-22.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-22.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,14 @@\n+/* Verify zero initialization for VLA automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+extern void bar (int);\n+\n+void foo(int n)\n+{\n+  int arr[n];\n+  bar (arr[2]);\n+  return;\n+}\n+\n+/* { dg-final { scan-rtl-dump \"__builtin_memset\" \"expand\" } } */"}, {"sha": "72094f6bdb92208d7dda2070e3fb251dac034bb6", "filename": "gcc/testsuite/gcc.target/i386/auto-init-23.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-23.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-23.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-23.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,13 @@\n+/* Verify the auto initialization of nested VLA.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+void g(void *);\n+\n+void foo(int a)\n+{\n+  int x[a][a];\n+  g(x);\n+}\n+\n+/* { dg-final { scan-rtl-dump \"__builtin_memset\" \"expand\" } } */"}, {"sha": "5cc3a756a1c518f7f08b6951d8957eb34d0589a0", "filename": "gcc/testsuite/gcc.target/i386/auto-init-24.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-24.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-24.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-24.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,13 @@\n+/* Verify the auto initialization of nested VLA.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+void g(void *);\n+\n+void foo(int a)\n+{\n+  int x[a][a];\n+  g(x);\n+}\n+\n+/* { dg-final { scan-rtl-dump \"__builtin_memset\" \"expand\" } } */"}, {"sha": "300ddfb34f117e68c70a411e28ffbf2e8c6f0203", "filename": "gcc/testsuite/gcc.target/i386/auto-init-3.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-3.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,17 @@\n+/* Verify zero initialization for floating point type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+long double result;\n+\n+long double foo()\n+{\n+  float temp1;\n+  double temp2;\n+  long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-assembler-times \"pxor\\t\\\\\\%xmm0, \\\\\\%xmm0\" 3 } } */"}, {"sha": "abe0b7e46a071169748acf310a75fba4beaa0203", "filename": "gcc/testsuite/gcc.target/i386/auto-init-4.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-4.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,20 @@\n+/* Verify pattern initialization for floating point type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+long double result;\n+\n+long double foo()\n+{\n+  float temp1;\n+  double temp2;\n+  long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"\\\\\\[0xfefefefefefefefe\\\\\\]\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+"}, {"sha": "b2e708c5289363a3ba2f1a61d23bff392fd82458", "filename": "gcc/testsuite/gcc.target/i386/auto-init-5.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-5.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,20 @@\n+/* Verify zero initialization for complex type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+\n+_Complex long double result;\n+\n+_Complex long double foo()\n+{\n+  _Complex float temp1;\n+  _Complex double temp2;\n+  _Complex long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-assembler-times \"\\\\.long\\t0\" 14 } } */\n+\n+"}, {"sha": "c79c039c2e984ee309eccab837b2260437915a4b", "filename": "gcc/testsuite/gcc.target/i386/auto-init-6.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-6.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify pattern initialization for complex type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+\n+_Complex long double result;\n+\n+_Complex long double foo()\n+{\n+  _Complex float temp1;\n+  _Complex double temp2;\n+  _Complex long double temp3;\n+\n+  result = temp1 + temp2 + temp3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"\\\\\\[0xfefefefefefefefe\\\\\\]\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 2 \"expand\" } } */"}, {"sha": "011437965debf2e0ba54821f3a6488dc6bc3796f", "filename": "gcc/testsuite/gcc.target/i386/auto-init-7.c", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-7.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,33 @@\n+/* Verify zero initialization for array, union, and structure type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+struct S\n+{\n+  int f1;\n+  float f2;\n+  char f3[20];\n+};\n+\n+union U\n+{\n+  char u1[5];\n+  int u2;\n+  float u3; \n+};\n+\n+double result;\n+\n+double foo()\n+{\n+  int temp1[3];\n+  double temp2[3];\n+  struct S temp3;\n+  union U temp4;\n+  \n+  result = temp1[2] + temp2[1] + temp3.f2 + temp4.u3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\)\\\\\\)\" 3 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\) repeated x16\" 2 \"expand\" } } */"}, {"sha": "28fbeb7eece2c58600d1b08dc2f83f7bfc8e233f", "filename": "gcc/testsuite/gcc.target/i386/auto-init-8.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-8.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,35 @@\n+/* Verify pattern initialization for array, union, and structure type automatic variables.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct S\n+{\n+  int f1;\n+  float f2;\n+  char f3[20];\n+};\n+\n+union U\n+{\n+  char u1[5];\n+  int u2;\n+  float u3; \n+};\n+\n+double result;\n+\n+double foo()\n+{\n+  int temp1[3];\n+  double temp2[3];\n+  struct S temp3;\n+  union U temp4;\n+  \n+  result = temp1[2] + temp2[1] + temp3.f2 + temp4.u3;\n+  return result;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffefefefe\" 1 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"\\\\\\[0xfefefefefefefefe\\\\\\]\" 2 \"expand\" } } */\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 2 \"expand\" } } */\n+"}, {"sha": "a238b8b4cf58ef780fd790d285f71c56251e201f", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-1.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-1.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify zero initialization for structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+struct test_aligned {\n+        int internal1;\n+        long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+int foo ()\n+{\n+  struct test_aligned var;\n+  return var.internal1;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+\n+"}, {"sha": "3fc6b072982505e8719bcd6aa78221213b5578ef", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-10.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-10.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-10.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-10.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,21 @@\n+/* Verify pattern initialization for array type with structure element with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var[10]; \n+  return var[2].four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */"}, {"sha": "cc982b980f6fb4816b21f7e04175d17b38e9060b", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-11.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-11.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-11.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-11.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,26 @@\n+/* Verify zero initialization for union type with structure field with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+union test_union_padding {\n+  struct test_trailing_hole u1;\n+  long long u2;\n+};\n+\n+\n+int foo ()\n+{\n+  union test_union_padding var;\n+  return var.u1.four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */"}, {"sha": "0fbdb6c046d7b8ef839fdecfcaa278e135dd8b57", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-12.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-12.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-12.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-12.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,26 @@\n+/* Verify pattern initialization for union type with structure field with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+union test_union_padding {\n+  struct test_trailing_hole u1;\n+  long long u2;\n+};\n+\n+\n+int foo ()\n+{\n+  union test_union_padding var;\n+  return var.u1.four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */"}, {"sha": "5739aa16b114c01a47c538e8925b9e990010d15a", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-2.c", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-2.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,19 @@\n+/* Verify pattern initialization for structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_aligned {\n+        int internal1;\n+        long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+int foo ()\n+{\n+  struct test_aligned var;\n+  return var.internal1;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+\n+"}, {"sha": "8a6d764b9fa4be558081f00c5374e93f6720213b", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-3.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-3.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,30 @@\n+/* Verify zero initialization for nested structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_aligned {\n+        unsigned internal1;\n+        unsigned long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+struct test_big_hole {\n+        char one;\n+        char two;\n+        char three;\n+        /* 61 byte padding hole here. */\n+        struct test_aligned four;\n+} __attribute__ ((aligned(64)));\n+\n+\n+int foo ()\n+{\n+  struct test_big_hole var;\n+  return var.four.internal1;\n+}\n+\n+/* { dg-final { scan-assembler \"movl\\t\\\\\\$0,\" } } */\n+/* { dg-final { scan-assembler \"movl\\t\\\\\\$16,\" } } */\n+/* { dg-final { scan-assembler \"rep stosq\" } } */\n+\n+"}, {"sha": "d7be32617e4439d06dd9c83d146ae06ec7a4fae9", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-4.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-4.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,28 @@\n+/* Verify pattern initialization for nested structure type automatic variables with\n+   padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_aligned {\n+        unsigned internal1;\n+        unsigned long long internal2;\n+} __attribute__ ((aligned(64)));\n+\n+struct test_big_hole {\n+        char one;\n+        char two;\n+        char three;\n+        /* 61 byte padding hole here. */\n+        struct test_aligned four;\n+} __attribute__ ((aligned(64)));\n+\n+\n+int foo ()\n+{\n+  struct test_big_hole var;\n+  return var.four.internal1;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+\n+"}, {"sha": "569b09aef23929652780e00678d5757a852bbedc", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-5.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-5.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,21 @@\n+/* Verify zero initialization for structure type automatic variables with\n+   tail padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        char *one;\n+        char *two;\n+        char *three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var;\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"const_int 0 \\\\\\[0\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+"}, {"sha": "4e0b6142134fd90d60f6b3dca54cefbe89d55d1e", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-6.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-6.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify pattern initialization for structure type automatic variables with\n+   tail padding.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern -fdump-rtl-expand\" } */\n+\n+struct test_trailing_hole {\n+        char *one;\n+        char *two;\n+        char *three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var;\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-rtl-dump-times \"0xfffffffffffffffe\\\\\\]\\\\\\) repeated x16\" 1 \"expand\" } } */\n+\n+"}, {"sha": "b5abffb0fc66b11dec38d4e15eb22ec4bea62200", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-7.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-7.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify zero initialization for structure type automatic variables with\n+   padding and has explicit initialization.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var = {.one = 1,.two = 2, .four = 'c'};\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-assembler-times \"movq\\t\\\\\\$0,\" 2 } } */\n+\n+"}, {"sha": "66591cff448845020287db2c102cd53170ce6b94", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-8.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-8.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify pattern initialization for structure type automatic variables with\n+   padding and has explicit initialization.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=pattern\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var = {.one = 1,.two = 2, .four = 'c'};\n+  return var.four;\n+}\n+\n+/* { dg-final { scan-assembler-times \"movq\\t\\\\\\$0,\" 2 } } */\n+\n+"}, {"sha": "1ff900f95b98a6f52ae5197aa7a2016f376f5026", "filename": "gcc/testsuite/gcc.target/i386/auto-init-padding-9.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-9.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-9.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fauto-init-padding-9.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -0,0 +1,22 @@\n+/* Verify zero initialization for array type with structure element with\n+   padding.  */ \n+/* { dg-do compile } */\n+/* { dg-options \"-ftrivial-auto-var-init=zero\" } */\n+\n+struct test_trailing_hole {\n+        int one;\n+        int two;\n+        int three;\n+        char four;\n+        /* \"sizeof(unsigned long) - 1\" byte padding hole here. */\n+};\n+\n+\n+int foo ()\n+{\n+  struct test_trailing_hole var[10]; \n+  return var[2].four;\n+}\n+\n+/* { dg-final { scan-assembler \"movl\\t\\\\\\$0,\" } } */\n+/* { dg-final { scan-assembler \"rep stosq\" } } */"}, {"sha": "367dcfa20bf899034abda55bd01837495235e3cb", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 46, "deletions": 1, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -3452,11 +3452,56 @@ verify_gimple_call (gcall *stmt)\n \t}\n     }\n \n+  /* For a call to .DEFERRED_INIT,\n+     LHS = DEFERRED_INIT (SIZE of the DECL, INIT_TYPE, IS_VLA)\n+     we should guarantee that the 1st and the 3rd arguments are consistent:\n+     1st argument: SIZE of the DECL;\n+     3rd argument: IS_VLA, 0 NO, 1 YES;\n+\n+     if IS_VLA is false, the 1st argument should be a constant and the same as\n+     the size of the LHS.  */\n+  if (gimple_call_internal_p (stmt, IFN_DEFERRED_INIT))\n+    {\n+      tree size_of_arg0 = gimple_call_arg (stmt, 0);\n+      tree size_of_lhs = TYPE_SIZE_UNIT (TREE_TYPE (lhs));\n+      tree is_vla_node = gimple_call_arg (stmt, 2);\n+      bool is_vla = (bool) TREE_INT_CST_LOW (is_vla_node);\n+\n+      if (TREE_CODE (lhs) == SSA_NAME)\n+\tlhs = SSA_NAME_VAR (lhs);\n+\n+      poly_uint64 size_from_arg0, size_from_lhs;\n+      bool is_constant_size_arg0 = poly_int_tree_p (size_of_arg0,\n+\t\t\t\t\t\t    &size_from_arg0);\n+      bool is_constant_size_lhs = poly_int_tree_p (size_of_lhs,\n+\t\t\t\t\t\t   &size_from_lhs);\n+      if (!is_vla)\n+\t{\n+\t  if (!is_constant_size_arg0)\n+\t    {\n+\t      error (\"%<DEFFERED_INIT%> calls for non-VLA should have \"\n+\t\t     \"constant size for the first argument\");\n+\t      return true;\n+\t    }\n+\t  else if (!is_constant_size_lhs)\n+\t    {\n+\t      error (\"%<DEFFERED_INIT%> calls for non-VLA should have \"\n+\t\t     \"constant size for the LHS\");\n+\t      return true;\n+\t    }\n+\t  else if (maybe_ne (size_from_arg0, size_from_lhs))\n+\t    {\n+\t      error (\"%<DEFFERED_INIT%> calls for non-VLA should have same \"\n+\t\t     \"constant size for the first argument and LHS\");\n+\t      return true;\n+\t    }\n+\t}\n+    }\n+\n   /* ???  The C frontend passes unpromoted arguments in case it\n      didn't see a function declaration before the call.  So for now\n      leave the call arguments mostly unverified.  Once we gimplify\n      unit-at-a-time we have a chance to fix this.  */\n-\n   for (i = 0; i < gimple_call_num_args (stmt); ++i)\n     {\n       tree arg = gimple_call_arg (stmt, i);"}, {"sha": "0363c5efb7861499c032e63bedd6dccfddeceb81", "filename": "gcc/tree-sra.c", "status": "modified", "additions": 115, "deletions": 9, "changes": 124, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-sra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-sra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-sra.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -384,6 +384,13 @@ static struct\n \n   /* Numbber of components created when splitting aggregate parameters.  */\n   int param_reductions_created;\n+\n+  /* Number of deferred_init calls that are modified.  */\n+  int deferred_init;\n+\n+  /* Number of deferred_init calls that are created by\n+     generate_subtree_deferred_init.  */\n+  int subtree_deferred_init;\n } sra_stats;\n \n static void\n@@ -1388,7 +1395,14 @@ scan_function (void)\n \n \t      t = gimple_call_lhs (stmt);\n \t      if (t && !disqualify_if_bad_bb_terminating_stmt (stmt, t, NULL))\n-\t\tret |= build_access_from_expr (t, stmt, true);\n+\t\t{\n+\t\t  /* If the STMT is a call to DEFERRED_INIT, avoid setting\n+\t\t     cannot_scalarize_away_bitmap.  */\n+\t\t  if (gimple_call_internal_p (stmt, IFN_DEFERRED_INIT))\n+\t\t    ret |= !!build_access_from_expr_1 (t, stmt, true);\n+\t\t  else\n+\t\t    ret |= build_access_from_expr (t, stmt, true);\n+\t\t}\n \t      break;\n \n \t    case GIMPLE_ASM:\n@@ -4099,6 +4113,88 @@ get_repl_default_def_ssa_name (struct access *racc, tree reg_type)\n   return get_or_create_ssa_default_def (cfun, racc->replacement_decl);\n }\n \n+\n+/* Generate statements to call .DEFERRED_INIT to initialize scalar replacements\n+   of accesses within a subtree ACCESS; all its children, siblings and their\n+   children are to be processed.\n+   GSI is a statement iterator used to place the new statements.  */\n+static void\n+generate_subtree_deferred_init (struct access *access,\n+\t\t\t\ttree init_type,\n+\t\t\t\ttree is_vla,\n+\t\t\t\tgimple_stmt_iterator *gsi,\n+\t\t\t\tlocation_t loc)\n+{\n+  do\n+    {\n+      if (access->grp_to_be_replaced)\n+\t{\n+\t  tree repl = get_access_replacement (access);\n+\t  gimple *call\n+\t    = gimple_build_call_internal (IFN_DEFERRED_INIT, 3,\n+\t\t\t\t\t  TYPE_SIZE_UNIT (TREE_TYPE (repl)),\n+\t\t\t\t\t  init_type, is_vla);\n+\t  gimple_call_set_lhs (call, repl);\n+\t  gsi_insert_before (gsi, call, GSI_SAME_STMT);\n+\t  update_stmt (call);\n+\t  gimple_set_location (call, loc);\n+\t  sra_stats.subtree_deferred_init++;\n+\t}\n+      if (access->first_child)\n+\tgenerate_subtree_deferred_init (access->first_child, init_type,\n+\t\t\t\t\tis_vla, gsi, loc);\n+\n+      access = access ->next_sibling;\n+    }\n+  while (access);\n+}\n+\n+/* For a call to .DEFERRED_INIT:\n+   var = .DEFERRED_INIT (size_of_var, init_type, is_vla);\n+   examine the LHS variable VAR and replace it with a scalar replacement if\n+   there is one, also replace the RHS call to a call to .DEFERRED_INIT of\n+   the corresponding scalar relacement variable.  Examine the subtree and\n+   do the scalar replacements in the subtree too.  STMT is the call, GSI is\n+   the statment iterator to place newly created statement.  */\n+\n+static enum assignment_mod_result\n+sra_modify_deferred_init (gimple *stmt, gimple_stmt_iterator *gsi)\n+{\n+  tree lhs = gimple_call_lhs (stmt);\n+  tree init_type = gimple_call_arg (stmt, 1);\n+  tree is_vla = gimple_call_arg (stmt, 2);\n+\n+  struct access *lhs_access = get_access_for_expr (lhs);\n+  if (!lhs_access)\n+    return SRA_AM_NONE;\n+\n+  location_t loc = gimple_location (stmt);\n+\n+  if (lhs_access->grp_to_be_replaced)\n+    {\n+      tree lhs_repl = get_access_replacement (lhs_access);\n+      gimple_call_set_lhs (stmt, lhs_repl);\n+      tree arg0_repl = TYPE_SIZE_UNIT (TREE_TYPE (lhs_repl));\n+      gimple_call_set_arg (stmt, 0, arg0_repl);\n+      sra_stats.deferred_init++;\n+      gcc_assert (!lhs_access->first_child);\n+      return SRA_AM_MODIFIED;\n+    }\n+\n+  if (lhs_access->first_child)\n+    generate_subtree_deferred_init (lhs_access->first_child,\n+\t\t\t\t    init_type, is_vla, gsi, loc);\n+  if (lhs_access->grp_covered)\n+    {\n+      unlink_stmt_vdef (stmt);\n+      gsi_remove (gsi, true);\n+      release_defs (stmt);\n+      return SRA_AM_REMOVED;\n+    }\n+\n+  return SRA_AM_MODIFIED;\n+}\n+\n /* Examine both sides of the assignment statement pointed to by STMT, replace\n    them with a scalare replacement if there is one and generate copying of\n    replacements if scalarized aggregates have been used in the assignment.  GSI\n@@ -4463,17 +4559,27 @@ sra_modify_function_body (void)\n \t      break;\n \n \t    case GIMPLE_CALL:\n-\t      /* Operands must be processed before the lhs.  */\n-\t      for (i = 0; i < gimple_call_num_args (stmt); i++)\n+\t      /* Handle calls to .DEFERRED_INIT specially.  */\n+\t      if (gimple_call_internal_p (stmt, IFN_DEFERRED_INIT))\n \t\t{\n-\t\t  t = gimple_call_arg_ptr (stmt, i);\n-\t\t  modified |= sra_modify_expr (t, &gsi, false);\n+\t\t  assign_result = sra_modify_deferred_init (stmt, &gsi);\n+\t\t  modified |= assign_result == SRA_AM_MODIFIED;\n+\t\t  deleted = assign_result == SRA_AM_REMOVED;\n \t\t}\n-\n-\t      if (gimple_call_lhs (stmt))\n+\t      else\n \t\t{\n-\t\t  t = gimple_call_lhs_ptr (stmt);\n-\t\t  modified |= sra_modify_expr (t, &gsi, true);\n+\t\t  /* Operands must be processed before the lhs.  */\n+\t\t  for (i = 0; i < gimple_call_num_args (stmt); i++)\n+\t\t    {\n+\t\t      t = gimple_call_arg_ptr (stmt, i);\n+\t\t      modified |= sra_modify_expr (t, &gsi, false);\n+\t\t    }\n+\n+\t      \t  if (gimple_call_lhs (stmt))\n+\t\t    {\n+\t\t      t = gimple_call_lhs_ptr (stmt);\n+\t\t      modified |= sra_modify_expr (t, &gsi, true);\n+\t\t    }\n \t\t}\n \t      break;\n "}, {"sha": "0b8a81ff1135d6819acb5d891f9877a19e966b90", "filename": "gcc/tree-ssa-structalias.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-ssa-structalias.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-ssa-structalias.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-structalias.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -4916,6 +4916,9 @@ find_func_aliases_for_call (struct function *fn, gcall *t)\n       && find_func_aliases_for_builtin_call (fn, t))\n     return;\n \n+  if (gimple_call_internal_p (t, IFN_DEFERRED_INIT))\n+    return;\n+\n   fi = get_fi_for_callee (t);\n   if (!in_ipa_mode\n       || (fi->decl && fndecl && !fi->is_fn_info))"}, {"sha": "84eadd1179ea2a74b37902d2a1e97d87bc228ab6", "filename": "gcc/tree-ssa-uninit.c", "status": "modified", "additions": 48, "deletions": 0, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-ssa-uninit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-ssa-uninit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-uninit.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -151,6 +151,42 @@ warn_uninit (opt_code opt, tree t, tree var, const char *gmsgid,\n   if (is_gimple_assign (context)\n       && gimple_assign_rhs_code (context) == COMPLEX_EXPR)\n     return;\n+\n+  /* Ignore REALPART_EXPR or IMAGPART_EXPR if its operand is a call to\n+     .DEFERRED_INIT.  This is for handling the following case correctly:\n+\n+  1 typedef _Complex float C;\n+  2 C foo (int cond)\n+  3 {\n+  4   C f;\n+  5   __imag__ f = 0;\n+  6   if (cond)\n+  7     {\n+  8       __real__ f = 1;\n+  9       return f;\n+ 10     }\n+ 11   return f;\n+ 12 }\n+\n+    with -ftrivial-auto-var-init, compiler will insert the following\n+    artificial initialization at line 4:\n+  f = .DEFERRED_INIT (f, 2);\n+  _1 = REALPART_EXPR <f>;\n+\n+    without the following special handling, _1 = REALPART_EXPR <f> will\n+    be treated as the uninitialized use point, which is incorrect. (the\n+    real uninitialized use point is at line 11).  */\n+  if (is_gimple_assign (context)\n+      && (gimple_assign_rhs_code (context) == REALPART_EXPR\n+\t  || gimple_assign_rhs_code (context) == IMAGPART_EXPR))\n+    {\n+      tree v = gimple_assign_rhs1 (context);\n+      if (TREE_CODE (TREE_OPERAND (v, 0)) == SSA_NAME\n+\t  && gimple_call_internal_p (SSA_NAME_DEF_STMT (TREE_OPERAND (v, 0)),\n+\t\t\t\t     IFN_DEFERRED_INIT))\n+\treturn;\n+    }\n+\n   /* Anonymous SSA_NAMEs shouldn't be uninitialized, but ssa_undefined_value_p\n      can return true if the def stmt of an anonymous SSA_NAME is COMPLEX_EXPR\n      created for conversion from scalar to complex.  Use the underlying var of\n@@ -345,6 +381,11 @@ check_defs (ao_ref *ref, tree vdef, void *data_)\n   check_defs_data *data = (check_defs_data *)data_;\n   gimple *def_stmt = SSA_NAME_DEF_STMT (vdef);\n \n+  /* Ignore the vdef if the definition statement is a call\n+     to .DEFERRED_INIT function.  */\n+  if (gimple_call_internal_p (def_stmt, IFN_DEFERRED_INIT))\n+    return false;\n+\n   /* The ASAN_MARK intrinsic doesn't modify the variable.  */\n   if (is_gimple_call (def_stmt))\n     {\n@@ -868,6 +909,13 @@ warn_uninitialized_vars (bool wmaybe_uninit)\n       for (gsi = gsi_start_bb (bb); !gsi_end_p (gsi); gsi_next (&gsi))\n \t{\n \t  gimple *stmt = gsi_stmt (gsi);\n+\n+\t  /* The call is an artificial use, will not provide meaningful\n+\t     error message.  If the result of the call is used somewhere\n+\t     else, we warn there instead.  */\n+\t  if (gimple_call_internal_p (stmt, IFN_DEFERRED_INIT))\n+\t    continue;\n+\n \t  if (is_gimple_debug (stmt))\n \t    continue;\n "}, {"sha": "0fba404babe953b66b20ee110101861d65c3dd4a", "filename": "gcc/tree-ssa.c", "status": "modified", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-ssa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree-ssa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -1325,6 +1325,46 @@ ssa_undefined_value_p (tree t, bool partial)\n   if (gimple_nop_p (def_stmt))\n     return true;\n \n+  /* The value is undefined if the definition statement is a call\n+     to .DEFERRED_INIT function.  */\n+  if (gimple_call_internal_p (def_stmt, IFN_DEFERRED_INIT))\n+    return true;\n+\n+  /* The value is partially undefined if the definition statement is\n+     a REALPART_EXPR or IMAGPART_EXPR and its operand is defined by\n+     the call to .DEFERRED_INIT function.  This is for handling the\n+     following case:\n+\n+  1 typedef _Complex float C;\n+  2 C foo (int cond)\n+  3 {\n+  4   C f;\n+  5   __imag__ f = 0;\n+  6   if (cond)\n+  7     {\n+  8       __real__ f = 1;\n+  9       return f;\n+ 10     }\n+ 11   return f;\n+ 12 }\n+\n+    with -ftrivial-auto-var-init, compiler will insert the following\n+    artificial initialization:\n+  f = .DEFERRED_INIT (f, 2);\n+  _1 = REALPART_EXPR <f>;\n+\n+    we should treat the definition _1 = REALPART_EXPR <f> as undefined.  */\n+  if (partial && is_gimple_assign (def_stmt)\n+      && (gimple_assign_rhs_code (def_stmt) == REALPART_EXPR\n+\t  || gimple_assign_rhs_code (def_stmt) == IMAGPART_EXPR))\n+    {\n+      tree real_imag_part = TREE_OPERAND (gimple_assign_rhs1 (def_stmt), 0);\n+      if (TREE_CODE (real_imag_part) == SSA_NAME\n+\t && gimple_call_internal_p (SSA_NAME_DEF_STMT (real_imag_part),\n+\t\t\t\t    IFN_DEFERRED_INIT))\n+\treturn true;\n+    }\n+\n   /* Check if the complex was not only partially defined.  */\n   if (partial && is_gimple_assign (def_stmt)\n       && gimple_assign_rhs_code (def_stmt) == COMPLEX_EXPR)"}, {"sha": "3d15948fd1a3635443fa4325e219c4a0ad9397bc", "filename": "gcc/tree.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a25e0b5e6ac8a77a71c229e0a7b744603365b0e9/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9", "patch": "@@ -9511,6 +9511,19 @@ build_common_builtin_nodes (void)\n   tree tmp, ftype;\n   int ecf_flags;\n \n+  if (!builtin_decl_explicit_p (BUILT_IN_CLEAR_PADDING))\n+    {\n+      ftype = build_function_type_list (void_type_node,\n+\t\t\t\t\tptr_type_node,\n+\t\t\t\t\tptr_type_node,\n+\t\t\t\t\tinteger_type_node,\n+\t\t\t\t\tNULL_TREE);\n+      local_define_builtin (\"__builtin_clear_padding\", ftype,\n+\t\t\t    BUILT_IN_CLEAR_PADDING,\n+\t\t\t    \"__builtin_clear_padding\",\n+\t\t\t      ECF_LEAF | ECF_NOTHROW);\n+    }\n+\n   if (!builtin_decl_explicit_p (BUILT_IN_UNREACHABLE)\n       || !builtin_decl_explicit_p (BUILT_IN_ABORT))\n     {"}]}