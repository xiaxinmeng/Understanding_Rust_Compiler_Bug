{"sha": "690688b3a055de125642e79d3bff8b0291d1f8cb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjkwNjg4YjNhMDU1ZGUxMjU2NDJlNzlkM2JmZjhiMDI5MWQxZjhjYg==", "commit": {"author": {"name": "Terry Guo", "email": "terry.guo@arm.com", "date": "2013-07-25T04:10:27Z"}, "committer": {"name": "Xuepeng Guo", "email": "xguo@gcc.gnu.org", "date": "2013-07-25T04:10:27Z"}, "message": "arm.c (thumb1_size_rtx_costs): Assign proper cost for shift_add/shift_sub0/shift_sub1 RTXs.\n\ngcc/ChangeLog:\n2013-07-24  Terry Guo  <terry.guo@arm.com>\n\n\t* config/arm/arm.c (thumb1_size_rtx_costs): Assign proper cost for\n\tshift_add/shift_sub0/shift_sub1 RTXs.\n\ngcc/testsuite/ChangeLog:\n2013-07-24  Terry Guo  <terry.guo@arm.com>\n\n\t* gcc.target/arm/thumb1-Os-mult.c: New test case.\n\nFrom-SVN: r201237", "tree": {"sha": "5ae1b066d744553bfbb91a51cca6c57aa1a4f172", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5ae1b066d744553bfbb91a51cca6c57aa1a4f172"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/690688b3a055de125642e79d3bff8b0291d1f8cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/690688b3a055de125642e79d3bff8b0291d1f8cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/690688b3a055de125642e79d3bff8b0291d1f8cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/690688b3a055de125642e79d3bff8b0291d1f8cb/comments", "author": null, "committer": null, "parents": [{"sha": "a4ad093b026e5224b4bacedcee34b434e7af7ffc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4ad093b026e5224b4bacedcee34b434e7af7ffc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4ad093b026e5224b4bacedcee34b434e7af7ffc"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "fa582e306b1000282001ea69bb1d5e87d3ad7c21", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=690688b3a055de125642e79d3bff8b0291d1f8cb", "patch": "@@ -1,3 +1,8 @@\n+2013-07-25  Terry Guo  <terry.guo@arm.com>\n+\n+\t* config/arm/arm.c (thumb1_size_rtx_costs): Assign proper cost for\n+\tshift_add/shift_sub0/shift_sub1 RTXs.\n+\n 2013-07-24  Bill Schmidt  <wschmidt@linux.ibm.com>\n \t    Anton Blanchard <anton@au1.ibm.com>\n "}, {"sha": "294de80a73b29a0548425a1c66ec3743af0441ae", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=690688b3a055de125642e79d3bff8b0291d1f8cb", "patch": "@@ -7925,6 +7925,15 @@ thumb1_size_rtx_costs (rtx x, enum rtx_code code, enum rtx_code outer)\n \n     case PLUS:\n     case MINUS:\n+      /* Thumb-1 needs two instructions to fulfill shiftadd/shiftsub0/shiftsub1\n+\t defined by RTL expansion, especially for the expansion of\n+\t multiplication.  */\n+      if ((GET_CODE (XEXP (x, 0)) == MULT\n+\t   && power_of_two_operand (XEXP (XEXP (x,0),1), SImode))\n+\t  || (GET_CODE (XEXP (x, 1)) == MULT\n+\t      && power_of_two_operand (XEXP (XEXP (x, 1), 1), SImode)))\n+\treturn COSTS_N_INSNS (2);\n+      /* On purpose fall through for normal RTX.  */\n     case COMPARE:\n     case NEG:\n     case NOT:"}, {"sha": "b8bd8609e51f0473e61454eb475bfc69b8e1d610", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=690688b3a055de125642e79d3bff8b0291d1f8cb", "patch": "@@ -1,3 +1,7 @@\n+2013-07-25  Terry Guo  <terry.guo@arm.com>\n+\n+\t* gcc.target/arm/thumb1-Os-mult.c: New test case.\n+\n 2013-07-24  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/57942"}, {"sha": "31b8bd692276afcbe69961b196ad7c02f08a85ca", "filename": "gcc/testsuite/gcc.target/arm/thumb1-Os-mult.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb1-Os-mult.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/690688b3a055de125642e79d3bff8b0291d1f8cb/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb1-Os-mult.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fthumb1-Os-mult.c?ref=690688b3a055de125642e79d3bff8b0291d1f8cb", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-require-effective-target arm_thumb1_ok } */\n+/* { dg-do compile } */\n+/* { dg-options \"-Os\" } */\n+/* { dg-skip-if \"\" { ! { arm_thumb1 } } } */\n+\n+int\n+mymul3 (int x)\n+{\n+  return x * 0x555;\n+}\n+\n+/* { dg-final { scan-assembler \"mul\\[\\\\t \\]*r.,\\[\\\\t \\]*r.\" } } */"}]}