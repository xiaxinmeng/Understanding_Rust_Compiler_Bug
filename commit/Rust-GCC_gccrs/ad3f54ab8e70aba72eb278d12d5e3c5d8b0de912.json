{"sha": "ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWQzZjU0YWI4ZTcwYWJhNzJlYjI3OGQxMmQ1ZTNjNWQ4YjBkZTkxMg==", "commit": {"author": {"name": "Andi Kleen", "email": "ak@linux.intel.com", "date": "2017-12-11T16:13:53Z"}, "committer": {"name": "Andi Kleen", "email": "ak@gcc.gnu.org", "date": "2017-12-11T16:13:53Z"}, "message": "Fix stack overflow with autofdo (PR83355)\n\ng++.dg/bprob* is failing currently with autofdo.\n\nRunning in gdb shows that there is a very deep recursion in get_index_by_decl until it\noverflows the stack.\n\ngcc/:\n2017-12-11  Andi Kleen  <ak@linux.intel.com>\n\n\tPR gcov-profile/83355\n\t* auto-profile.c (string_table::get_index_by_decl): Don't\n\trecurse when abstract origin points to itself.\n\nFrom-SVN: r255540", "tree": {"sha": "282ac512ba37da0ef146f2f06023ddd149dd17e4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/282ac512ba37da0ef146f2f06023ddd149dd17e4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912/comments", "author": null, "committer": null, "parents": [{"sha": "46bb9d29d3017715a7dbb9477612aff06f8c0994", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46bb9d29d3017715a7dbb9477612aff06f8c0994", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46bb9d29d3017715a7dbb9477612aff06f8c0994"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "75a4dc4c35a577f9b646d0f793d9a299765fd36a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912", "patch": "@@ -1,3 +1,9 @@\n+2017-12-11  Andi Kleen  <ak@linux.intel.com>\n+\n+\tPR gcov-profile/83355\n+\t* auto-profile.c (string_table::get_index_by_decl): Don't\n+\trecurse when abstract origin points to itself.\n+\n 2017-12-11  Bin Cheng  <bin.cheng@arm.com>\n \n \tPR tree-optimization/83320"}, {"sha": "403709bad6b867dc9044534727dfd94b59e6f71c", "filename": "gcc/auto-profile.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912/gcc%2Fauto-profile.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912/gcc%2Fauto-profile.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fauto-profile.c?ref=ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912", "patch": "@@ -477,7 +477,7 @@ string_table::get_index_by_decl (tree decl) const\n   ret = get_index (lang_hooks.dwarf_name (decl, 0));\n   if (ret != -1)\n     return ret;\n-  if (DECL_ABSTRACT_ORIGIN (decl))\n+  if (DECL_ABSTRACT_ORIGIN (decl) && DECL_ABSTRACT_ORIGIN (decl) != decl)\n     return get_index_by_decl (DECL_ABSTRACT_ORIGIN (decl));\n \n   return -1;"}, {"sha": "3db1d38d535de72c0935a023d1c1f59c55cd381e", "filename": "gcc/lto-streamer-in.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912/gcc%2Flto-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912/gcc%2Flto-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-in.c?ref=ad3f54ab8e70aba72eb278d12d5e3c5d8b0de912", "patch": "@@ -360,6 +360,8 @@ lto_input_tree_ref (struct lto_input_block *ib, struct data_in *data_in,\n     case LTO_label_decl_ref:\n     case LTO_translation_unit_decl_ref:\n     case LTO_namelist_decl_ref:\n+      if (!data_in->file_data->current_decl_state)\n+\t      printf(\"tag %d\\n\", tag);\n       ix_u = streamer_read_uhwi (ib);\n       result = lto_file_decl_data_get_var_decl (data_in->file_data, ix_u);\n       break;"}]}