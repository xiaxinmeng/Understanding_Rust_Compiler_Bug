{"sha": "0798984a5a59e9162596db04cbf9eacc8541da7f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDc5ODk4NGE1YTU5ZTkxNjI1OTZkYjA0Y2JmOWVhY2M4NTQxZGE3Zg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-09-27T08:33:41Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-09-27T08:33:41Z"}, "message": "re PR c++/84940 (internal compiler error: in build_value_init_noctor, at cp/init.c:465)\n\n/cp\n2018-09-27  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/84940\n\t* semantics.c (finish_unary_op_expr): Check return value of\n\tbuild_x_unary_op for error_mark_node.\n\n/testsuite\n2018-09-27  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/84940\n\t* g++.dg/expr/unary4.C: New.\n\nFrom-SVN: r264664", "tree": {"sha": "442d7e3a69967678f12e11b44dfba8cae677444d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/442d7e3a69967678f12e11b44dfba8cae677444d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0798984a5a59e9162596db04cbf9eacc8541da7f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0798984a5a59e9162596db04cbf9eacc8541da7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0798984a5a59e9162596db04cbf9eacc8541da7f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0798984a5a59e9162596db04cbf9eacc8541da7f/comments", "author": null, "committer": null, "parents": [{"sha": "291a9e980ef059c46476212e4b3e88fb07e11b00", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/291a9e980ef059c46476212e4b3e88fb07e11b00", "html_url": "https://github.com/Rust-GCC/gccrs/commit/291a9e980ef059c46476212e4b3e88fb07e11b00"}], "stats": {"total": 26, "additions": 23, "deletions": 3}, "files": [{"sha": "a28b6150d8f5df53fa47dbc2708a23c3c163a133", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=0798984a5a59e9162596db04cbf9eacc8541da7f", "patch": "@@ -1,3 +1,9 @@\n+2018-09-27  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/84940\n+\t* semantics.c (finish_unary_op_expr): Check return value of\n+\tbuild_x_unary_op for error_mark_node.\n+\n 2018-09-25  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/87398"}, {"sha": "c7f53d1206e853acaa60d4fa1e78d02661956f94", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=0798984a5a59e9162596db04cbf9eacc8541da7f", "patch": "@@ -2727,13 +2727,14 @@ finish_unary_op_expr (location_t op_loc, enum tree_code code, cp_expr expr,\n   /* TODO: build_x_unary_op doesn't always honor the location.  */\n   result.set_location (combined_loc);\n \n-  tree result_ovl, expr_ovl;\n+  if (result == error_mark_node)\n+    return result;\n \n   if (!(complain & tf_warning))\n     return result;\n \n-  result_ovl = result;\n-  expr_ovl = expr;\n+  tree result_ovl = result;\n+  tree expr_ovl = expr;\n \n   if (!processing_template_decl)\n     expr_ovl = cp_fully_fold (expr_ovl);"}, {"sha": "4bca408202237f919e540acd0abe2e4ce54256fc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0798984a5a59e9162596db04cbf9eacc8541da7f", "patch": "@@ -1,3 +1,8 @@\n+2018-09-27  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/84940\n+\t* g++.dg/expr/unary4.C: New.\n+\n 2018-09-26  Indu Bhagat  <indu.bhagat@oracle.com>\n \n \tPR gcov-profile/86957"}, {"sha": "2b58a8dc2cb1885a92b569b71db075967b5c718c", "filename": "gcc/testsuite/g++.dg/expr/unary4.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Funary4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0798984a5a59e9162596db04cbf9eacc8541da7f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Funary4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Funary4.C?ref=0798984a5a59e9162596db04cbf9eacc8541da7f", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/84940\n+// { dg-additional-options -Wno-vla }\n+\n+void\n+foo (int x)\n+{\n+  struct {} a[1][x](-a[0]); // { dg-error \"wrong type argument to unary minus\" }\n+}"}]}