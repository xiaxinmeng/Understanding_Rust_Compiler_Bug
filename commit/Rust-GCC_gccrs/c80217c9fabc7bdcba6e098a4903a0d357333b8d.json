{"sha": "c80217c9fabc7bdcba6e098a4903a0d357333b8d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzgwMjE3YzlmYWJjN2JkY2JhNmUwOThhNDkwM2EwZDM1NzMzM2I4ZA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-10-08T21:58:58Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-10-08T21:58:58Z"}, "message": "re PR c++/58568 ([c++11] ICE with lambda in invalid template variable definition)\n\n/cp\n2013-10-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/58568\n\t* lambda.c (begin_lambda_type): Check return value of xref_tag\n\tfor error_mark_node; tidy.\n\t* decl.c (grokdeclarator): Tweak error message.\n\n/testsuite\n2013-10-08  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/58568\n\t* g++.dg/cpp0x/lambda/lambda-ice10.C: New.\n\t* g++.old-deja/g++.mike/misc9.C: Adjust.\n\nFrom-SVN: r203289", "tree": {"sha": "4023b4c69f0f5ea622a899f879c7cade5bafc152", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4023b4c69f0f5ea622a899f879c7cade5bafc152"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c80217c9fabc7bdcba6e098a4903a0d357333b8d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c80217c9fabc7bdcba6e098a4903a0d357333b8d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c80217c9fabc7bdcba6e098a4903a0d357333b8d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c80217c9fabc7bdcba6e098a4903a0d357333b8d/comments", "author": null, "committer": null, "parents": [{"sha": "a330ff7f5c68964b62c691649560ae2f19430a8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a330ff7f5c68964b62c691649560ae2f19430a8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a330ff7f5c68964b62c691649560ae2f19430a8f"}], "stats": {"total": 31, "additions": 26, "deletions": 5}, "files": [{"sha": "70dab1eeaecac44402efbb6c357bf9d9302c6784", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=c80217c9fabc7bdcba6e098a4903a0d357333b8d", "patch": "@@ -1,3 +1,10 @@\n+2013-10-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/58568\n+\t* lambda.c (begin_lambda_type): Check return value of xref_tag\n+\tfor error_mark_node; tidy.\n+\t* decl.c (grokdeclarator): Tweak error message.\n+\n 2013-10-08  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/58665"}, {"sha": "5f17a056079b45ea2726bf2386f66d0df3f3da2a", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=c80217c9fabc7bdcba6e098a4903a0d357333b8d", "patch": "@@ -8774,8 +8774,8 @@ grokdeclarator (const cp_declarator *declarator,\n \t\t\t     && !uniquely_derived_from_p (ctype,\n \t\t\t\t\t\t\t  current_class_type))\n \t\t      {\n-\t\t\terror (\"type %qT is not derived from type %qT\",\n-\t\t\t       ctype, current_class_type);\n+\t\t\terror (\"invalid use of qualified-name %<%T::%D%>\",\n+\t\t\t       qualifying_scope, decl);\n \t\t\treturn error_mark_node;\n \t\t      }\n \t\t  }"}, {"sha": "2ecb17cfe916220b15f201c5d8982ec218edaae2", "filename": "gcc/cp/lambda.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Fcp%2Flambda.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Fcp%2Flambda.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Flambda.c?ref=c80217c9fabc7bdcba6e098a4903a0d357333b8d", "patch": "@@ -138,6 +138,8 @@ begin_lambda_type (tree lambda)\n                      name,\n                      /*scope=*/ts_lambda,\n                      /*template_header_p=*/false);\n+    if (type == error_mark_node)\n+      return error_mark_node;\n   }\n \n   /* Designate it as a struct so that we can use aggregate initialization.  */\n@@ -152,8 +154,6 @@ begin_lambda_type (tree lambda)\n \n   /* Start the class.  */\n   type = begin_class_definition (type);\n-  if (type == error_mark_node)\n-    return error_mark_node;\n \n   return type;\n }"}, {"sha": "fde103b9e55789b429c76b5b8bd5b7eebefb9f98", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c80217c9fabc7bdcba6e098a4903a0d357333b8d", "patch": "@@ -1,3 +1,9 @@\n+2013-10-08  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/58568\n+\t* g++.dg/cpp0x/lambda/lambda-ice10.C: New.\n+\t* g++.old-deja/g++.mike/misc9.C: Adjust.\n+\n 2013-10-08  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/58665"}, {"sha": "1ea59c21c843f0c1cc43c8a7bf9cde98053c784c", "filename": "gcc/testsuite/g++.dg/cpp0x/lambda/lambda-ice10.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice10.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice10.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Flambda%2Flambda-ice10.C?ref=c80217c9fabc7bdcba6e098a4903a0d357333b8d", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/58568\n+// { dg-do compile { target c++11 } }\n+\n+template<int> struct A\n+{\n+  static const int i;\n+  template<int N> const int A<N>::i = []{ return 0; }(); // { dg-error \"invalid use\" }\n+};"}, {"sha": "7b9a86cbf4a3fe58a6a4ac3270c5af2523a8584c", "filename": "gcc/testsuite/g++.old-deja/g++.mike/misc9.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.mike%2Fmisc9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c80217c9fabc7bdcba6e098a4903a0d357333b8d/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.mike%2Fmisc9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.mike%2Fmisc9.C?ref=c80217c9fabc7bdcba6e098a4903a0d357333b8d", "patch": "@@ -8,6 +8,6 @@ class bee {\n \n class foo {\n  public:\n-  int bee::bar;\t\t// { dg-error \"not derived\" } you cannot do this\n+  int bee::bar;\t\t// { dg-error \"invalid use\" } you cannot do this\n     int me();\n };"}]}