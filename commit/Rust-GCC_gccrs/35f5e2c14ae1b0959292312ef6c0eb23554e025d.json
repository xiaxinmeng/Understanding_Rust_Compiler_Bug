{"sha": "35f5e2c14ae1b0959292312ef6c0eb23554e025d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzVmNWUyYzE0YWUxYjA5NTkyOTIzMTJlZjZjMGViMjM1NTRlMDI1ZA==", "commit": {"author": {"name": "Doug Rupp", "email": "rupp@adacore.com", "date": "2018-05-29T09:38:17Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-05-29T09:38:17Z"}, "message": "[Ada] New function to return nanoseconds from Unix Epoch\n\n2018-05-29  Doug Rupp  <rupp@adacore.com>\n\ngcc/ada/\n\n\t* libgnat/a-calend.adb (Epoch_Offset): Move from body to ...\n\t* libgnat/a-calend.ads (Epoch_Offset): to private part of spec\n\t* libgnat/a-calcon.ads (To_Unix_Nano_Time): New function spec.\n\t* libgnat/a-calcon.adb (To_Unix_Nano_Time): New function body.\n\nFrom-SVN: r260870", "tree": {"sha": "7190e555afe38348cd300ce84d057a2ae51a67ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7190e555afe38348cd300ce84d057a2ae51a67ba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35f5e2c14ae1b0959292312ef6c0eb23554e025d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35f5e2c14ae1b0959292312ef6c0eb23554e025d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35f5e2c14ae1b0959292312ef6c0eb23554e025d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35f5e2c14ae1b0959292312ef6c0eb23554e025d/comments", "author": {"login": "Cementitious", "id": 115579865, "node_id": "U_kgDOBuOb2Q", "avatar_url": "https://avatars.githubusercontent.com/u/115579865?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Cementitious", "html_url": "https://github.com/Cementitious", "followers_url": "https://api.github.com/users/Cementitious/followers", "following_url": "https://api.github.com/users/Cementitious/following{/other_user}", "gists_url": "https://api.github.com/users/Cementitious/gists{/gist_id}", "starred_url": "https://api.github.com/users/Cementitious/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Cementitious/subscriptions", "organizations_url": "https://api.github.com/users/Cementitious/orgs", "repos_url": "https://api.github.com/users/Cementitious/repos", "events_url": "https://api.github.com/users/Cementitious/events{/privacy}", "received_events_url": "https://api.github.com/users/Cementitious/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0f9ca0303ed932c4c2df9b3439aac6b6566a6728", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f9ca0303ed932c4c2df9b3439aac6b6566a6728", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f9ca0303ed932c4c2df9b3439aac6b6566a6728"}], "stats": {"total": 38, "additions": 34, "deletions": 4}, "files": [{"sha": "d5cd8715ea77868af3ff85a7831506acf66d6feb", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=35f5e2c14ae1b0959292312ef6c0eb23554e025d", "patch": "@@ -1,3 +1,10 @@\n+2018-05-29  Doug Rupp  <rupp@adacore.com>\n+\n+\t* libgnat/a-calend.adb (Epoch_Offset): Move from body to ...\n+\t* libgnat/a-calend.ads (Epoch_Offset): to private part of spec\n+\t* libgnat/a-calcon.ads (To_Unix_Nano_Time): New function spec.\n+\t* libgnat/a-calcon.adb (To_Unix_Nano_Time): New function body.\n+\n 2018-05-29  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* repinfo.ads (JSON format): Document new pair for components."}, {"sha": "1c8e8cc7eeeedb30d74b50979180aafc8ca19bbd", "filename": "gcc/ada/libgnat/a-calcon.adb", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calcon.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calcon.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-calcon.adb?ref=35f5e2c14ae1b0959292312ef6c0eb23554e025d", "patch": "@@ -30,6 +30,7 @@\n ------------------------------------------------------------------------------\n \n with Interfaces.C; use Interfaces.C;\n+with Interfaces.C.Extensions; use Interfaces.C.Extensions;\n \n package body Ada.Calendar.Conversions is\n \n@@ -145,4 +146,18 @@ package body Ada.Calendar.Conversions is\n       return long (Val);\n    end To_Unix_Time;\n \n+   -----------------------\n+   -- To_Unix_Nano_Time --\n+   -----------------------\n+\n+   function To_Unix_Nano_Time (Ada_Time : Time) return long_long is\n+      pragma Unsuppress (Overflow_Check);\n+      Ada_Rep : constant Time_Rep := Time_Rep (Ada_Time);\n+   begin\n+      return long_long (Ada_Rep + Epoch_Offset);\n+   exception\n+      when Constraint_Error =>\n+         raise Time_Error;\n+   end To_Unix_Nano_Time;\n+\n end Ada.Calendar.Conversions;"}, {"sha": "e2b3ad3b4dc199fc6d78e5f7772c2b7ac5331941", "filename": "gcc/ada/libgnat/a-calcon.ads", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calcon.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calcon.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-calcon.ads?ref=35f5e2c14ae1b0959292312ef6c0eb23554e025d", "patch": "@@ -33,6 +33,7 @@\n --  time models - Time, Duration, struct tm and struct timespec.\n \n with Interfaces.C;\n+with Interfaces.C.Extensions;\n \n package Ada.Calendar.Conversions is\n \n@@ -110,4 +111,11 @@ package Ada.Calendar.Conversions is\n    --  units of the result are seconds. Raises Time_Error if the result cannot\n    --  fit into a Time value.\n \n+   function To_Unix_Nano_Time (Ada_Time : Time) return\n+      Interfaces.C.Extensions.long_long;\n+   --  Convert a time value represented as number of time units since the Ada\n+   --  implementation-defined Epoch to a value relative to the Unix Epoch. The\n+   --  units of the result are nanoseconds. Raises Time_Error if the result\n+   --  cannot fit into a Time value.\n+\n end Ada.Calendar.Conversions;"}, {"sha": "8299b74bc98f893d843e7553607ea55e84dc4600", "filename": "gcc/ada/libgnat/a-calend.adb", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calend.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calend.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-calend.adb?ref=35f5e2c14ae1b0959292312ef6c0eb23554e025d", "patch": "@@ -203,10 +203,6 @@ is\n      Ada_Low + Time_Rep (34 * 366 + 102 * 365) * Nanos_In_Day +\n      Time_Rep (Leap_Seconds_Count) * Nano;\n \n-   Epoch_Offset : constant Time_Rep := (136 * 365 + 44 * 366) * Nanos_In_Day;\n-   --  The difference between 2150-1-1 UTC and 1970-1-1 UTC expressed in\n-   --  nanoseconds. Note that year 2100 is non-leap.\n-\n    Cumulative_Days_Before_Month :\n      constant array (Month_Number) of Natural :=\n        (0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334);"}, {"sha": "4371e110a1ec3d94e7e14d344140f0da0f2aa8e8", "filename": "gcc/ada/libgnat/a-calend.ads", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calend.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35f5e2c14ae1b0959292312ef6c0eb23554e025d/gcc%2Fada%2Flibgnat%2Fa-calend.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flibgnat%2Fa-calend.ads?ref=35f5e2c14ae1b0959292312ef6c0eb23554e025d", "patch": "@@ -221,6 +221,10 @@ private\n    --  with overloading ambiguities in the body if we tried to use Time as an\n    --  internal computational type.\n \n+   Epoch_Offset : constant Time_Rep := (136 * 365 + 44 * 366) * Nanos_In_Day;\n+   --  The difference between 2150-1-1 UTC and 1970-1-1 UTC expressed in\n+   --  nanoseconds. Note that year 2100 is non-leap.\n+\n    Days_In_Month : constant array (Month_Number) of Day_Number :=\n                      (31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);\n    --  Days in month for non-leap year, leap year case is adjusted in code"}]}