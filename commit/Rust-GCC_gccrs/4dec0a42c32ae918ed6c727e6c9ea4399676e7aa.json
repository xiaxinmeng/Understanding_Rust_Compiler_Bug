{"sha": "4dec0a42c32ae918ed6c727e6c9ea4399676e7aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGRlYzBhNDJjMzJhZTkxOGVkNmM3MjdlNmM5ZWE0Mzk5Njc2ZTdhYQ==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2012-01-11T14:39:28Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2012-01-11T14:39:28Z"}, "message": "main.c (store_exe_path): Fix absolute path detection for Windows.\n\n2012-01-11  Tobias Burnus  <burnus@net-b.de>\n\n        * runtime/main.c (store_exe_path): Fix absolute path\n        detection for Windows.\n\nFrom-SVN: r183094", "tree": {"sha": "f1d8fe218cd54aa92750dbada0cd3015f9ffb20e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f1d8fe218cd54aa92750dbada0cd3015f9ffb20e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa/comments", "author": null, "committer": null, "parents": [{"sha": "1c97289f9f4b592c877471145993191d0312878d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c97289f9f4b592c877471145993191d0312878d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c97289f9f4b592c877471145993191d0312878d"}], "stats": {"total": 23, "additions": 18, "deletions": 5}, "files": [{"sha": "b1e2b049b4f82c866f7c0ec2b44eed0ff2d85aad", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=4dec0a42c32ae918ed6c727e6c9ea4399676e7aa", "patch": "@@ -1,5 +1,10 @@\n+2012-01-11  Tobias Burnus  <burnus@net-b.de>\n+\n+\t* runtime/main.c (store_exe_path): Fix absolute path\n+\tdetection for Windows.\n+\n 2012-01-11  Janne Blomqvist  <jb@gcc.gnu.org>\n-            Mike Stump  <mikestump@comcast.net>\n+\t    Mike Stump  <mikestump@comcast.net>\n \tPR libfortran/51803\n \t* runtime/main.c (store_exe_path): Handle getcwd failure and lack\n \tof the function better."}, {"sha": "9ee47022cc9b2336e959e7d6fc949a89ec57bfdc", "filename": "libgfortran/runtime/main.c", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa/libgfortran%2Fruntime%2Fmain.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4dec0a42c32ae918ed6c727e6c9ea4399676e7aa/libgfortran%2Fruntime%2Fmain.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fruntime%2Fmain.c?ref=4dec0a42c32ae918ed6c727e6c9ea4399676e7aa", "patch": "@@ -86,7 +86,8 @@ store_exe_path (const char * argv0)\n #define DIR_SEPARATOR '/'\n #endif\n \n-  char buf[PATH_MAX], *cwd, *path;\n+  char buf[PATH_MAX], *path;\n+  const char *cwd;\n \n   /* This can only happen if store_exe_path is called multiple times.  */\n   if (please_free_exe_path_when_done)\n@@ -105,15 +106,22 @@ store_exe_path (const char * argv0)\n     }\n #endif\n \n-  /* On the simulator argv is not set.  */\n-  if (argv0 == NULL || argv0[0] == '/')\n+  /* If the path is absolute or on a simulator where argv is not set.  */\n+#ifdef __MINGW32__\n+  if (argv0 == NULL\n+      || ('A' <= argv0[0] && argv0[0] <= 'Z' && argv0[1] == ':')\n+      || ('a' <= argv0[0] && argv0[0] <= 'z' && argv0[1] == ':')\n+      || (argv0[0] == '/' && argv0[1] == '/')\n+      || (argv0[0] == '\\\\' && argv0[1] == '\\\\'))\n+#else\n+  if (argv0 == NULL || argv0[0] == DIR_SEPARATOR)\n+#endif\n     {\n       exe_path = argv0;\n       please_free_exe_path_when_done = 0;\n       return;\n     }\n \n-  memset (buf, 0, sizeof (buf));\n #ifdef HAVE_GETCWD\n   cwd = getcwd (buf, sizeof (buf));\n   if (!cwd)"}]}