{"sha": "227cf17127926cf07f801555ec6f905df82eddd2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjI3Y2YxNzEyNzkyNmNmMDdmODAxNTU1ZWM2ZjkwNWRmODJlZGRkMg==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1999-08-09T08:53:52Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1999-08-09T08:53:52Z"}, "message": "decl.c (struct binding_level): Add eh_region field.\n\n\t* decl.c (struct binding_level): Add eh_region field.\n\t(push_binding_level): Set it.\n\t(define_label): Complain about jumping into an EH block.\n\nFrom-SVN: r28622", "tree": {"sha": "37a0725d27a153ddd6bcbfbfdc622c1b91cdd6ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/37a0725d27a153ddd6bcbfbfdc622c1b91cdd6ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/227cf17127926cf07f801555ec6f905df82eddd2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/227cf17127926cf07f801555ec6f905df82eddd2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/227cf17127926cf07f801555ec6f905df82eddd2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/227cf17127926cf07f801555ec6f905df82eddd2/comments", "author": null, "committer": null, "parents": [{"sha": "e7b9b18e4ac2c20a2458270889d1b5385d158808", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7b9b18e4ac2c20a2458270889d1b5385d158808", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e7b9b18e4ac2c20a2458270889d1b5385d158808"}], "stats": {"total": 35, "additions": 30, "deletions": 5}, "files": [{"sha": "963b9c673f06459ff87f473f84c280f0c4c014a4", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/227cf17127926cf07f801555ec6f905df82eddd2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/227cf17127926cf07f801555ec6f905df82eddd2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=227cf17127926cf07f801555ec6f905df82eddd2", "patch": "@@ -1,10 +1,12 @@\n 1999-08-08  Jason Merrill  <jason@yorick.cygnus.com>\n \n+\t* decl.c (struct binding_level): Add eh_region field.\n+\t(push_binding_level): Set it.\n+\t(define_label): Complain about jumping into an EH block.\n+\n \t* ptree.c (print_lang_type): Print the real type of a PMF.\n \tPrint what exceptions a fn type throws.\n \n-\t* typeck.c (common_type): Use same_type_p.\n-\n 1999-08-07  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* class.c (count_fields, add_fields_to_vec): Add static prototype."}, {"sha": "93f66b26e425d5b30e8e8df09e804b76b55b336e", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 25, "deletions": 2, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/227cf17127926cf07f801555ec6f905df82eddd2/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/227cf17127926cf07f801555ec6f905df82eddd2/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=227cf17127926cf07f801555ec6f905df82eddd2", "patch": "@@ -639,7 +639,10 @@ struct binding_level\n        worry about ambiguous (ARM or ANSI) scope rules.  */\n     unsigned is_for_scope : 1;\n \n-    /* Two bits left for this word.  */\n+    /* True if this level corresponds to an EH region, as for a try block.  */\n+    unsigned eh_region : 1;\n+\n+    /* One bit left for this word.  */\n \n #if defined(DEBUG_CP_BINDING_LEVELS)\n     /* Binding depth at which this level began.  */\n@@ -703,6 +706,12 @@ push_binding_level (newlevel, tag_transparent, keep)\n   current_binding_level = newlevel;\n   newlevel->tag_transparent = tag_transparent;\n   newlevel->more_cleanups_ok = 1;\n+\n+  /* We are called before expand_start_bindings, but after\n+     expand_eh_region_start for a try block; so we check this now,\n+     before the EH block is covered up.  */\n+  newlevel->eh_region = is_eh_region ();\n+\n   newlevel->keep = keep;\n #if defined(DEBUG_CP_BINDING_LEVELS)\n   newlevel->binding_depth = binding_depth;\n@@ -4868,6 +4877,7 @@ define_label (filename, line, name)\n     {\n       struct named_label_list *uses, *prev;\n       int identified = 0;\n+      int saw_eh = 0;\n \n       /* Mark label as having been defined.  */\n       DECL_INITIAL (decl) = error_mark_node;\n@@ -4922,7 +4932,7 @@ define_label (filename, line, name)\n \t\t\t\t   uses->lineno_o_goto, \"  from here\");\n \t\t\t      }\n \t\t\t    identified = 1;\n-\t\t\t}\n+\t\t\t  }\n \n \t\t\tif (problem)\n \t\t\t  cp_error_at (\"  crosses initialization of `%#D'\",\n@@ -4935,6 +4945,19 @@ define_label (filename, line, name)\n \t\t  }\n \t\tif (b == uses->binding_level)\n \t\t  break;\n+\t\tif (b->eh_region && ! saw_eh)\n+\t\t  {\n+\t\t    if (! identified)\n+\t\t      {\n+\t\t\tcp_error (\"jump to label `%D'\", decl);\n+\t\t\terror_with_file_and_line\n+\t\t\t  (uses->filename_o_goto,\n+\t\t\t   uses->lineno_o_goto, \"  from here\");\n+\t\t\tidentified = 1;\n+\t\t      }\n+\t\t    error (\"  enters exception handling block\");\n+\t\t    saw_eh = 1;\n+\t\t  }\n \t\tb = b->level_chain;\n \t      }\n "}, {"sha": "991234c5678bb4de5e0986a12dfa5581924b365e", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/227cf17127926cf07f801555ec6f905df82eddd2/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/227cf17127926cf07f801555ec6f905df82eddd2/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=227cf17127926cf07f801555ec6f905df82eddd2", "patch": "@@ -699,7 +699,7 @@ common_type (t1, t2)\n \ttt1 = TYPE_MAIN_VARIANT (tt1);\n \ttt2 = TYPE_MAIN_VARIANT (tt2);\n \n-\tif (same_type_p (tt1, tt2))\n+\tif (tt1 == tt2)\n \t  target = tt1;\n \telse if (b1)\n \t  {"}]}