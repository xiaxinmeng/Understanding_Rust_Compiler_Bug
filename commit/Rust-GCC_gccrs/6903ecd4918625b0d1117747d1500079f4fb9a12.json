{"sha": "6903ecd4918625b0d1117747d1500079f4fb9a12", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjkwM2VjZDQ5MTg2MjViMGQxMTE3NzQ3ZDE1MDAwNzlmNGZiOWExMg==", "commit": {"author": {"name": "Richard Earnshaw", "email": "rearnsha@arm.com", "date": "2004-08-29T21:07:37Z"}, "committer": {"name": "Richard Earnshaw", "email": "rearnsha@gcc.gnu.org", "date": "2004-08-29T21:07:37Z"}, "message": "sched-deps.c (get_condition): Rewrite using jump support functions.\n\n* sched-deps.c (get_condition): Rewrite using jump support functions.\nUse reversed_comparison_code.\n(conditions_mutex_p): Use reversed_comparison_code.\n\nFrom-SVN: r86736", "tree": {"sha": "b7474d4fdb7d9ed9d0210dacaa8e9f133f277f5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b7474d4fdb7d9ed9d0210dacaa8e9f133f277f5d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6903ecd4918625b0d1117747d1500079f4fb9a12", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6903ecd4918625b0d1117747d1500079f4fb9a12", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6903ecd4918625b0d1117747d1500079f4fb9a12", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6903ecd4918625b0d1117747d1500079f4fb9a12/comments", "author": null, "committer": null, "parents": [{"sha": "ea9bfbf28f9d011716e6d903c063f851a716b9dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ea9bfbf28f9d011716e6d903c063f851a716b9dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ea9bfbf28f9d011716e6d903c063f851a716b9dd"}], "stats": {"total": 36, "additions": 22, "deletions": 14}, "files": [{"sha": "7f0869775bc744c19c0e4b8629a0e95fda706a0e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6903ecd4918625b0d1117747d1500079f4fb9a12/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6903ecd4918625b0d1117747d1500079f4fb9a12/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6903ecd4918625b0d1117747d1500079f4fb9a12", "patch": "@@ -1,3 +1,9 @@\n+2004-08-29  Richard Earnshaw  <rearnsha@arm.com>\n+\n+\t* sched-deps.c (get_condition): Rewrite using jump support functions.\n+\tUse reversed_comparison_code.\n+\t(conditions_mutex_p): Use reversed_comparison_code.\n+\n 2004-08-29  Richard Sandiford  <rsandifo@redhat.com>\n \n \t* config/mips/mips.c (override_options): Disable hot/cold partitioning"}, {"sha": "18f3d39a9c0a14e29f5ee114a655a301855101f4", "filename": "gcc/sched-deps.c", "status": "modified", "additions": 16, "deletions": 14, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6903ecd4918625b0d1117747d1500079f4fb9a12/gcc%2Fsched-deps.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6903ecd4918625b0d1117747d1500079f4fb9a12/gcc%2Fsched-deps.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsched-deps.c?ref=6903ecd4918625b0d1117747d1500079f4fb9a12", "patch": "@@ -145,23 +145,25 @@ get_condition (rtx insn)\n \n   if (pat == 0)\n     return 0;\n+\n   if (GET_CODE (pat) == COND_EXEC)\n     return COND_EXEC_TEST (pat);\n-  if (!JUMP_P (insn))\n-    return 0;\n-  if (GET_CODE (pat) != SET || SET_SRC (pat) != pc_rtx)\n-    return 0;\n-  if (GET_CODE (SET_DEST (pat)) != IF_THEN_ELSE)\n+\n+  if (!any_condjump_p (insn) || !onlyjump_p (insn))\n     return 0;\n-  pat = SET_DEST (pat);\n-  cond = XEXP (pat, 0);\n-  if (GET_CODE (XEXP (cond, 1)) == LABEL_REF\n-      && XEXP (cond, 2) == pc_rtx)\n+\n+  cond = XEXP (SET_SRC (pc_set (insn)), 0);\n+  if (XEXP (cond, 2) == pc_rtx)\n     return cond;\n-  else if (GET_CODE (XEXP (cond, 2)) == LABEL_REF\n-\t   && XEXP (cond, 1) == pc_rtx)\n-    return gen_rtx_fmt_ee (reverse_condition (GET_CODE (cond)), GET_MODE (cond),\n-\t\t\t   XEXP (cond, 0), XEXP (cond, 1));\n+  else if (XEXP (cond, 1) == pc_rtx)\n+    {\n+      enum rtx_code revcode = reversed_comparison_code (cond, insn);\n+\n+      if (revcode == UNKNOWN)\n+\treturn 0;\n+      return gen_rtx_fmt_ee (revcode, GET_MODE (cond), XEXP (cond, 0),\n+\t\t\t     XEXP (cond, 1));\n+    }\n   else\n     return 0;\n }\n@@ -173,7 +175,7 @@ conditions_mutex_p (rtx cond1, rtx cond2)\n {\n   if (COMPARISON_P (cond1)\n       && COMPARISON_P (cond2)\n-      && GET_CODE (cond1) == reverse_condition (GET_CODE (cond2))\n+      && GET_CODE (cond1) == reversed_comparison_code (cond2, NULL)\n       && XEXP (cond1, 0) == XEXP (cond2, 0)\n       && XEXP (cond1, 1) == XEXP (cond2, 1))\n     return 1;"}]}