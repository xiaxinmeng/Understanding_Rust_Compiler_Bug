{"sha": "0e82a9b9422447fe9730831a5072655e0f5780f7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGU4MmE5Yjk0MjI0NDdmZTk3MzA4MzFhNTA3MjY1NWUwZjU3ODBmNw==", "commit": {"author": {"name": "Bin Cheng", "email": "amker@gcc.gnu.org", "date": "2017-07-25T08:31:22Z"}, "committer": {"name": "Bin Cheng", "email": "amker@gcc.gnu.org", "date": "2017-07-25T08:31:22Z"}, "message": "re PR target/81414 (ICE in fma steering on AArch64/cortex-a57)\n\n\tPR target/81414\n\t* config/aarch64/cortex-a57-fma-steering.c (analyze): Skip fmul/fmac\n\tinstructions if no du chain is found.\n\n\tgcc/testsuite\n\t* gcc.target/aarch64/pr81414.C: New.\n\nFrom-SVN: r250496", "tree": {"sha": "c3f330e9c0fa90138c5a86b8865d315e0d6919cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c3f330e9c0fa90138c5a86b8865d315e0d6919cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0e82a9b9422447fe9730831a5072655e0f5780f7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e82a9b9422447fe9730831a5072655e0f5780f7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e82a9b9422447fe9730831a5072655e0f5780f7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e82a9b9422447fe9730831a5072655e0f5780f7/comments", "author": null, "committer": null, "parents": [{"sha": "198104af576c095b74ab456d95f6b4080e408a37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/198104af576c095b74ab456d95f6b4080e408a37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/198104af576c095b74ab456d95f6b4080e408a37"}], "stats": {"total": 35, "additions": 31, "deletions": 4}, "files": [{"sha": "24d9088b3f7e71075a0c4cecdf24303a5a9c56a9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0e82a9b9422447fe9730831a5072655e0f5780f7", "patch": "@@ -1,3 +1,9 @@\n+2017-07-25  Bin Cheng  <bin.cheng@arm.com>\n+\n+\tPR target/81414\n+\t* config/aarch64/cortex-a57-fma-steering.c (analyze): Skip fmul/fmac\n+\tinstructions if no du chain is found.\n+\n 2017-07-25  Georg-Johann Lay  <avr@gjlay.de>\n \n \t* config/avr/avr-log.c (avr_log_vadump) ['T']: Print NULL-TREE."}, {"sha": "fa8c56aab022919121aa093051ea1090865d41fa", "filename": "gcc/config/aarch64/cortex-a57-fma-steering.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2Fconfig%2Faarch64%2Fcortex-a57-fma-steering.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2Fconfig%2Faarch64%2Fcortex-a57-fma-steering.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Fcortex-a57-fma-steering.c?ref=0e82a9b9422447fe9730831a5072655e0f5780f7", "patch": "@@ -973,10 +973,17 @@ func_fma_steering::analyze ()\n \t\tbreak;\n \t    }\n \n-\t  /* We didn't find a chain with a def for this instruction.  */\n-\t  gcc_assert (i < dest_op_info->n_chains);\n-\n-\t  this->analyze_fma_fmul_insn (forest, chain, head);\n+\t  /* Due to implementation of regrename, dest register can slip away\n+\t     from regrename's analysis.  As a result, there is no chain for\n+\t     the destination register of insn.  We simply skip the insn even\n+\t     it is a fmul/fmac instruction.  This can happen when the dest\n+\t     register is also a source register of insn and one of the below\n+\t     conditions is satisfied:\n+\t       1) the source reg is setup in larger mode than this insn;\n+\t       2) the source reg is uninitialized;\n+\t       3) the source reg is passed in as parameter.  */\n+\t  if (i < dest_op_info->n_chains)\n+\t    this->analyze_fma_fmul_insn (forest, chain, head);\n \t}\n     }\n   free (bb_dfs_preorder);"}, {"sha": "aef24ec7a77433778a302c9174632a2ff764122a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0e82a9b9422447fe9730831a5072655e0f5780f7", "patch": "@@ -1,3 +1,8 @@\n+2017-07-25  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR target/81414\n+\t* gcc.target/aarch64/pr81414.C: New.\n+\n 2017-07-25  Richard Biener  <rguenther@suse.de>\n \n \tPR middle-end/81505"}, {"sha": "53dfc7cf800101d6b371588b386d8e44bbcaa858", "filename": "gcc/testsuite/gcc.target/aarch64/pr81414.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpr81414.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0e82a9b9422447fe9730831a5072655e0f5780f7/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpr81414.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpr81414.C?ref=0e82a9b9422447fe9730831a5072655e0f5780f7", "patch": "@@ -0,0 +1,9 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -mcpu=cortex-a57\" } */\n+\n+typedef __Float32x2_t float32x2_t;\n+float32x2_t\n+foo1 (float32x2_t __a, float32x2_t __b, float32x2_t __c) {\n+  return __b * __c + __a;\n+}\n+"}]}