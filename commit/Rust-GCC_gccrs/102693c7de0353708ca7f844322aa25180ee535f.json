{"sha": "102693c7de0353708ca7f844322aa25180ee535f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTAyNjkzYzdkZTAzNTM3MDhjYTdmODQ0MzIyYWEyNTE4MGVlNTM1Zg==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2007-01-12T13:34:47Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2007-01-12T13:34:47Z"}, "message": "PR libstdc++/30416 (continued)\n\n2007-01-12  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/30416 (continued)\n\t* include/std/valarray (valarray<>::shift, valarray<>::cshift):\n\tAllways return the same variable, thus facilitating NRVO.\n\nFrom-SVN: r120722", "tree": {"sha": "42cb3c1e9118a2aeade3f5161820851dc2c365bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/42cb3c1e9118a2aeade3f5161820851dc2c365bf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/102693c7de0353708ca7f844322aa25180ee535f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/102693c7de0353708ca7f844322aa25180ee535f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/102693c7de0353708ca7f844322aa25180ee535f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/102693c7de0353708ca7f844322aa25180ee535f/comments", "author": null, "committer": null, "parents": [{"sha": "f005dd79c5b51b579c211f2c6d32820a47c49e97", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f005dd79c5b51b579c211f2c6d32820a47c49e97", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f005dd79c5b51b579c211f2c6d32820a47c49e97"}], "stats": {"total": 36, "additions": 25, "deletions": 11}, "files": [{"sha": "4efc40cda95d7d07cd7c170940263802935e31bc", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/102693c7de0353708ca7f844322aa25180ee535f/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/102693c7de0353708ca7f844322aa25180ee535f/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=102693c7de0353708ca7f844322aa25180ee535f", "patch": "@@ -1,3 +1,9 @@\n+2007-01-12  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/30416 (continued)\n+\t* include/std/valarray (valarray<>::shift, valarray<>::cshift):\n+\tAllways return the same variable, thus facilitating NRVO.\n+\n 2007-01-12  Paolo Carlini  <pcarlini@suse.de>\n \n \tPR libstdc++/30416"}, {"sha": "6c828b685173220429d072b4728249bf8598928e", "filename": "libstdc++-v3/include/std/valarray", "status": "modified", "additions": 19, "deletions": 11, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/102693c7de0353708ca7f844322aa25180ee535f/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvalarray", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/102693c7de0353708ca7f844322aa25180ee535f/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvalarray", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvalarray?ref=102693c7de0353708ca7f844322aa25180ee535f", "patch": "@@ -782,14 +782,18 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n      inline valarray<_Tp>\n      valarray<_Tp>::shift(int __n) const\n      {\n-       if (_M_size == 0 || __n == 0)\n-\t return *this;\n-     \n        valarray<_Tp> __ret;\n+\n+       if (_M_size == 0)\n+\t return __ret;\n+\n        _Tp* __restrict__ __tmp_M_data =\n \t std::__valarray_get_storage<_Tp>(_M_size);\n \n-       if (__n > 0)      // shift left\n+       if (__n == 0)\n+\t std::__valarray_copy_construct(_M_data,\n+\t\t\t\t\t_M_data + _M_size, __tmp_M_data);\n+       else if (__n > 0)      // shift left\n \t {\n \t   if (size_t(__n) > _M_size)\n \t     __n = _M_size;\n@@ -799,7 +803,7 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n \t   std::__valarray_default_construct(__tmp_M_data + _M_size - __n,\n \t\t\t\t\t     __tmp_M_data + _M_size);\n \t }\n-       else              // shift right\n+       else                   // shift right\n \t {\n \t   if (size_t(-__n) > _M_size)\n \t     __n = -_M_size;\n@@ -819,14 +823,18 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n      inline valarray<_Tp>\n      valarray<_Tp>::cshift(int __n) const\n      {\n-       if (_M_size == 0 || __n == 0)\n-\t return *this;\n-\n        valarray<_Tp> __ret;\n+\n+       if (_M_size == 0)\n+\t return __ret;\n+\n        _Tp* __restrict__ __tmp_M_data =\n \t std::__valarray_get_storage<_Tp>(_M_size);\n-       \n-       if (__n > 0)      // cshift left\n+\n+       if (__n == 0)\n+\t std::__valarray_copy_construct(_M_data,\n+\t\t\t\t\t_M_data + _M_size, __tmp_M_data);\n+       else if (__n > 0)      // cshift left\n \t {\n \t   if (size_t(__n) > _M_size)\n \t     __n = __n % _M_size;\n@@ -836,7 +844,7 @@ _GLIBCXX_BEGIN_NAMESPACE(std)\n \t   std::__valarray_copy_construct(_M_data + __n, _M_data + _M_size,\n \t\t\t\t\t  __tmp_M_data);\n \t }\n-       else              // cshift right\n+       else                   // cshift right\n \t {\n \t   if (size_t(-__n) > _M_size)\n \t     __n = -(-__n % _M_size);"}]}