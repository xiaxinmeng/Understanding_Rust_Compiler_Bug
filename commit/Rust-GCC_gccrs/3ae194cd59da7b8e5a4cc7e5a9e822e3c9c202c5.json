{"sha": "3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2FlMTk0Y2Q1OWRhN2I4ZTVhNGNjN2U1YTllODIyZTNjOWMyMDJjNQ==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2006-03-24T23:21:27Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2006-03-24T23:21:27Z"}, "message": "tree-ssa-dom.c (propagate_rhs_into_lhs): Don't call update_stmt directly.\n\n        * tree-ssa-dom.c (propagate_rhs_into_lhs): Don't call update_stmt\n        directly.  Call mark_new_vars_to_rename slightly earlier.\n\n        * gcc.c-torture/pr26840.c: New test.\n\nFrom-SVN: r112365", "tree": {"sha": "a457495224966ac0267a09cd906d32e128d74d47", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a457495224966ac0267a09cd906d32e128d74d47"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/comments", "author": null, "committer": null, "parents": [{"sha": "58df1c413d4514747ce8478caf0bfdc48711e551", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58df1c413d4514747ce8478caf0bfdc48711e551", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58df1c413d4514747ce8478caf0bfdc48711e551"}], "stats": {"total": 61, "additions": 56, "deletions": 5}, "files": [{"sha": "51a9ae858c746bf9658c014c4147b026065cbe8d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "patch": "@@ -1,3 +1,8 @@\n+2006-03-24  Jeff Law  <law@redhat.com>\n+\n+\t* tree-ssa-dom.c (propagate_rhs_into_lhs): Don't call update_stmt\n+\tdirectly.  Call mark_new_vars_to_rename slightly earlier.\n+\n 2006-03-24  Geoffrey Keating  <geoffk@apple.com>\n \n \tPR 26793"}, {"sha": "c7daaebf205b4b5ca142737342b5fa752b43fee3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "patch": "@@ -1,3 +1,7 @@\n+2006-03-24  Jeff Law  <law@redhat.com>\n+\n+\t* gcc.c-torture/pr26840.c: New test.\n+\n 2006-03-24  Geoffrey Keating  <geoffk@apple.com>\n \n \t* g++.old-deja/g++.other/init19.C: New."}, {"sha": "8d864a295d879bf5df6e78f1f621fddb185374b4", "filename": "gcc/testsuite/gcc.c-torture/compile/pr26840.c", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr26840.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr26840.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr26840.c?ref=3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "patch": "@@ -0,0 +1,42 @@\n+extern int f1 (void **);\n+extern void f2 (void *);\n+\n+struct s\n+{\n+  unsigned char field1;\n+  int field2;\n+};\n+\n+static inline struct s *\n+get_globals (void)\n+{\n+  struct s * r;\n+  void * rr;\n+\n+  if (f1 (&rr))\n+    return 0;\n+  r = rr;\n+  if (! r)\n+    {\n+      extern struct s t;\n+      r = &t;\n+    }\n+  r->field1 = 1;\n+  return r;\n+}\n+\n+void\n+atexit_common (const void *dso)\n+{\n+  struct s *g = get_globals ();\n+\n+  if (! g)\n+    return;\n+  if (g->field1)\n+    {\n+      g->field2 = 0;\n+      f2 (g);\n+    }\n+  else\n+    f2 (g);\n+}"}, {"sha": "db9f873669e28cf4d4e69aef7dbe2d969776ee53", "filename": "gcc/tree-ssa-dom.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2Ftree-ssa-dom.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5/gcc%2Ftree-ssa-dom.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-dom.c?ref=3ae194cd59da7b8e5a4cc7e5a9e822e3c9c202c5", "patch": "@@ -2160,7 +2160,11 @@ propagate_rhs_into_lhs (tree stmt, tree lhs, tree rhs, bitmap interesting_names)\n \t     collapse control statements.  */\n \t  propagate_value (use_p, rhs);\n \t  fold_stmt_inplace (use_stmt);\n-\t  update_stmt (use_stmt);\n+\n+\t  /* Sometimes propagation can expose new operands to the\n+\t     renamer.  Note this will call update_stmt at the \n+\t     appropriate time.  */\n+\t  mark_new_vars_to_rename (use_stmt);\n \n \t  /* Dump details.  */\n \t  if (dump_file && (dump_flags & TDF_DETAILS))\n@@ -2170,10 +2174,6 @@ propagate_rhs_into_lhs (tree stmt, tree lhs, tree rhs, bitmap interesting_names)\n \t      fprintf (dump_file, \"\\n\");\n \t    }\n \n-\t  /* Sometimes propagation can expose new operands to the\n-\t     renamer.  */\n-\t  mark_new_vars_to_rename (use_stmt);\n-\n \t  /* If we replaced a variable index with a constant, then\n \t     we would need to update the invariant flag for ADDR_EXPRs.  */\n \t  if (TREE_CODE (use_stmt) == MODIFY_EXPR"}]}