{"sha": "822cc906fd9341dd64f808f4553aaa07c8de8c6a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODIyY2M5MDZmZDkzNDFkZDY0ZjgwOGY0NTUzYWFhMDdjOGRlOGM2YQ==", "commit": {"author": {"name": "Patrick Palka", "email": "patrick@parcs.ath.cx", "date": "2014-04-04T19:35:54Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2014-04-04T19:35:54Z"}, "message": "re PR c++/21113 (Jumps into VLA or VM scope not rejected for C++)\n\n\tPR c++/21113\n\t* decl.c (decl_jump_unsafe): Consider variably-modified decls.\n\nFrom-SVN: r209124", "tree": {"sha": "925853c0f98fae1bd5d7cf1470e266bc747eebe8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/925853c0f98fae1bd5d7cf1470e266bc747eebe8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/822cc906fd9341dd64f808f4553aaa07c8de8c6a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/822cc906fd9341dd64f808f4553aaa07c8de8c6a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/822cc906fd9341dd64f808f4553aaa07c8de8c6a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/822cc906fd9341dd64f808f4553aaa07c8de8c6a/comments", "author": null, "committer": null, "parents": [{"sha": "8fe91ca80ebe76ddc0f66674061209dd6a5e7557", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fe91ca80ebe76ddc0f66674061209dd6a5e7557", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8fe91ca80ebe76ddc0f66674061209dd6a5e7557"}], "stats": {"total": 35, "additions": 31, "deletions": 4}, "files": [{"sha": "615db3fa3e4d44c0cfc27ac1968d318a9e919d9b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/822cc906fd9341dd64f808f4553aaa07c8de8c6a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/822cc906fd9341dd64f808f4553aaa07c8de8c6a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=822cc906fd9341dd64f808f4553aaa07c8de8c6a", "patch": "@@ -1,3 +1,8 @@\n+2014-04-04  Patrick Palka  <patrick@parcs.ath.cx>\n+\n+\tPR c++/21113\n+\t* decl.c (decl_jump_unsafe): Consider variably-modified decls.\n+\n 2014-04-04  Fabien Ch\u00eane  <fabien@gcc.gnu.org>\n \n \t* class.c (find_abi_tags_r): Check for the return of warning"}, {"sha": "0d8ebcb7bfc111f6716fc56bc7a42d73b5e43ef8", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/822cc906fd9341dd64f808f4553aaa07c8de8c6a/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/822cc906fd9341dd64f808f4553aaa07c8de8c6a/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=822cc906fd9341dd64f808f4553aaa07c8de8c6a", "patch": "@@ -2785,12 +2785,11 @@ decl_jump_unsafe (tree decl)\n       || type == error_mark_node)\n     return 0;\n \n-  type = strip_array_types (type);\n-\n-  if (DECL_NONTRIVIALLY_INITIALIZED_P (decl))\n+  if (DECL_NONTRIVIALLY_INITIALIZED_P (decl)\n+      || variably_modified_type_p (type, NULL_TREE))\n     return 2;\n \n-  if (TYPE_HAS_NONTRIVIAL_DESTRUCTOR (TREE_TYPE (decl)))\n+  if (TYPE_HAS_NONTRIVIAL_DESTRUCTOR (type))\n     return 1;\n \n   return 0;"}, {"sha": "278cb63b938599f19405af2a733b3c4fe0171f55", "filename": "gcc/testsuite/g++.dg/ext/vla14.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/822cc906fd9341dd64f808f4553aaa07c8de8c6a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvla14.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/822cc906fd9341dd64f808f4553aaa07c8de8c6a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvla14.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvla14.C?ref=822cc906fd9341dd64f808f4553aaa07c8de8c6a", "patch": "@@ -0,0 +1,23 @@\n+// PR c++/21113\n+// { dg-options \"\" }\n+\n+void\n+f (int n)\n+{\n+  goto label; // { dg-error \"from here\" }\n+  int a[n]; // { dg-error \"crosses initialization\" }\n+label: // { dg-error \"jump to label\" }\n+  ;\n+}\n+\n+void\n+g (int n)\n+{\n+  switch (1)\n+  {\n+  case 1:\n+    int (*a)[n]; // { dg-error \"crosses initialization\" }\n+  default: // { dg-error \"jump to case label\" }\n+    ;\n+  }\n+}"}]}