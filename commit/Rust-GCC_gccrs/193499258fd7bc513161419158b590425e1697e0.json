{"sha": "193499258fd7bc513161419158b590425e1697e0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTkzNDk5MjU4ZmQ3YmM1MTMxNjE0MTkxNThiNTkwNDI1ZTE2OTdlMA==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonber@gnat.com", "date": "2001-12-05T18:59:43Z"}, "committer": {"name": "Geert Bosch", "email": "bosch@gcc.gnu.org", "date": "2001-12-05T18:59:43Z"}, "message": "sem_ch12.adb: Document use of Associated_Node on Selected_Components.\n\n\t* sem_ch12.adb:\n\tDocument use of Associated_Node on Selected_Components.\n\t(Save_Global_Operand_Descendants): Change to Save_Entity_Descendants,\n\tto clarify use of untyped descendant fields.\n\nFrom-SVN: r47682", "tree": {"sha": "cbb14c16ad17523610d9713e029c8e91ad3de009", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cbb14c16ad17523610d9713e029c8e91ad3de009"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/193499258fd7bc513161419158b590425e1697e0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/193499258fd7bc513161419158b590425e1697e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/193499258fd7bc513161419158b590425e1697e0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/193499258fd7bc513161419158b590425e1697e0/comments", "author": null, "committer": null, "parents": [{"sha": "2212663f7002e0459021fec3ef226c07b10c2c58", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2212663f7002e0459021fec3ef226c07b10c2c58", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2212663f7002e0459021fec3ef226c07b10c2c58"}], "stats": {"total": 65, "additions": 37, "deletions": 28}, "files": [{"sha": "622444d9b47c3152d61494b4c37ed7bd529abb0e", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/193499258fd7bc513161419158b590425e1697e0/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/193499258fd7bc513161419158b590425e1697e0/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=193499258fd7bc513161419158b590425e1697e0", "patch": "@@ -1,3 +1,10 @@\n+2001-12-05  Ed Schonberg <schonber@gnat.com>\n+\n+\t* sem_ch12.adb:\n+\tDocument use of Associated_Node on Selected_Components.\n+\t(Save_Global_Operand_Descendants): Change to Save_Entity_Descendants,\n+\tto clarify use of untyped descendant fields.\n+\n 2001-12-05  Robert Dewar <dewar@gnat.com>\n \n \t* prj-dect.ads: Add ??? comment"}, {"sha": "c47cbe6b9663901a98a49f63f83206cbc5474f41", "filename": "gcc/ada/sem_ch12.adb", "status": "modified", "additions": 30, "deletions": 28, "changes": 58, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/193499258fd7bc513161419158b590425e1697e0/gcc%2Fada%2Fsem_ch12.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/193499258fd7bc513161419158b590425e1697e0/gcc%2Fada%2Fsem_ch12.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch12.adb?ref=193499258fd7bc513161419158b590425e1697e0", "patch": "@@ -532,7 +532,7 @@ package body Sem_Ch12 is\n    --  information from the associated node is placed on the new copy, so\n    --  that name resolution is not repeated.\n \n-   --  Three kinds of nodes have associated nodes:\n+   --  Three kinds of source nodes have associated nodes:\n \n    --    a) those that contain entities, that is to say identifiers,\n    --       expanded_names, and operators (N_Has_Entity)\n@@ -553,9 +553,12 @@ package body Sem_Ch12 is\n    --  some of the ancestor types, if their view is private at the point of\n    --  instantiation.\n \n-   --  Query??? why selected components. What about N_Freeze_Nodes, I assume\n-   --  that the answer is no, which means that the comment above for a) is\n-   --  confusing ???\n+   --  Nodes that are selected components in the parse tree may be rewritten\n+   --  as expanded names after resolution, and must be treated as potential\n+   --  entity holders. which is why they also have an Associated_Node.\n+\n+   --  Nodes that do not come from source, such as freeze nodes, do not appear\n+   --  in the generic tree, and need not have an associated node.\n \n    --  The associated node is stored in the Associated_Node field. Note that\n    --  this field overlaps Entity, which is fine, because the whole point is\n@@ -8187,6 +8190,11 @@ package body Sem_Ch12 is\n       --  Save semantic information on global entity, so that it is not\n       --  resolved again at instantiation time.\n \n+      procedure Save_Entity_Descendants (N : Node_Id);\n+      --  Apply Save_Global_References to the two syntactic descendants of\n+      --  nodes that carry entities, i.e. identifiers, character literals,\n+      --  expanded names, and operators.\n+\n       procedure Save_Global_Defaults (N1, N2 : Node_Id);\n       --  Default actuals in nested instances must be handled specially\n       --  because there is no link to them from the original tree. When an\n@@ -8199,12 +8207,6 @@ package body Sem_Ch12 is\n       --  context of the parent, we must preserve the identifier of the parent\n       --  so that it can be properly resolved in a subsequent instantiation.\n \n-      procedure Save_Global_Operand_Descendants (N : Node_Id);\n-      --  Apply Save_Global_Descendant to the possible operand fields\n-      --  of the node N (Field2 = Left_Opnd, Field3 = Right_Opnd).\n-      --\n-      --  It is uncomfortable for Sem_Ch12 to have this knowledge ???\n-\n       procedure Save_Global_Descendant (D : Union_Id);\n       --  Apply Save_Global_References recursively to the descendents of\n       --  current node.\n@@ -8365,7 +8367,7 @@ package body Sem_Ch12 is\n                Change_Selected_Component_To_Expanded_Name (Parent (N));\n                Set_Associated_Node (Parent (N), Parent (N2));\n                Set_Global_Type (Parent (N), Parent (N2));\n-               Save_Global_Operand_Descendants (N);\n+               Save_Entity_Descendants (N);\n \n                --  If this is a reference to the current generic entity,\n                --  replace it with a simple name. This is to avoid anomalies\n@@ -8416,7 +8418,7 @@ package body Sem_Ch12 is\n             Change_Selected_Component_To_Expanded_Name (Parent (N));\n             Set_Associated_Node (Parent (N), Name (Parent (N2)));\n             Set_Global_Type (Parent (N), Name (Parent (N2)));\n-            Save_Global_Operand_Descendants (N);\n+            Save_Entity_Descendants (N);\n \n          else\n             --  Entity is local. Reset in generic unit, so that node\n@@ -8427,6 +8429,21 @@ package body Sem_Ch12 is\n          end if;\n       end Reset_Entity;\n \n+      -----------------------------\n+      -- Save_Entity_Descendants --\n+      -----------------------------\n+\n+      procedure Save_Entity_Descendants (N : Node_Id) is\n+\n+         use Atree.Unchecked_Access;\n+         --  This code section is part of the implementation of an untyped\n+         --  tree traversal, so it needs direct access to node fields.\n+\n+      begin\n+         Save_Global_Descendant (Field2 (N));\n+         Save_Global_Descendant (Field3 (N));\n+      end Save_Entity_Descendants;\n+\n       --------------------------\n       -- Save_Global_Defaults --\n       --------------------------\n@@ -8595,21 +8612,6 @@ package body Sem_Ch12 is\n          end if;\n       end Save_Global_Descendant;\n \n-      -------------------------------------\n-      -- Save_Global_Operand_Descendants --\n-      -------------------------------------\n-\n-      procedure Save_Global_Operand_Descendants (N : Node_Id) is\n-\n-         use Atree.Unchecked_Access;\n-         --  This code section is part of the implementation of an untyped\n-         --  tree traversal, so it needs direct access to node fields.\n-\n-      begin\n-         Save_Global_Descendant (Field2 (N));\n-         Save_Global_Descendant (Field3 (N));\n-      end Save_Global_Operand_Descendants;\n-\n       ---------------------\n       -- Save_References --\n       ---------------------\n@@ -8700,7 +8702,7 @@ package body Sem_Ch12 is\n \n             --  Complete the check on operands\n \n-            Save_Global_Operand_Descendants (N);\n+            Save_Entity_Descendants (N);\n \n          elsif Nkind (N) = N_Identifier then\n             if Nkind (N) = Nkind (Get_Associated_Node (N)) then"}]}