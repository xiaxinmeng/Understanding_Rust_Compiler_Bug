{"sha": "0679656478759e3bfd02f6f0a4b22fd792b736d7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDY3OTY1NjQ3ODc1OWUzYmZkMDJmNmYwYTRiMjJmZDc5MmI3MzZkNw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-02-25T10:50:24Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-02-25T10:50:24Z"}, "message": "re PR debug/43166 (ICE in simplify_subreg on fortran code)\n\n\tPR debug/43166\n\t* cfgexpand.c (expand_debug_expr) <case VAR_DECL>: If mode is\n\tBLKmode, assert op0 is a MEM and just adjust its mode.\n\n\t* trans-common.c (build_common_decl): Also update DECL_MODE,\n\tand DECL_SIZE when encountering a larger common block and call\n\tlayout_decl.\n\n\t* gfortran.dg/debug/pr43166.f: New test.\n\nFrom-SVN: r157063", "tree": {"sha": "8c563f765e4c4c2d824bc55f8a32342fd34a9066", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8c563f765e4c4c2d824bc55f8a32342fd34a9066"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0679656478759e3bfd02f6f0a4b22fd792b736d7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0679656478759e3bfd02f6f0a4b22fd792b736d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0679656478759e3bfd02f6f0a4b22fd792b736d7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0679656478759e3bfd02f6f0a4b22fd792b736d7/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7d5d39bb9dbdf4374f8240128048302338faaca7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d5d39bb9dbdf4374f8240128048302338faaca7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d5d39bb9dbdf4374f8240128048302338faaca7"}], "stats": {"total": 39, "additions": 37, "deletions": 2}, "files": [{"sha": "c66acfa1914693bcb61e2ad042e1d62c4f5c7b3a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0679656478759e3bfd02f6f0a4b22fd792b736d7", "patch": "@@ -1,5 +1,9 @@\n 2010-02-25  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/43166\n+\t* cfgexpand.c (expand_debug_expr) <case VAR_DECL>: If mode is\n+\tBLKmode, assert op0 is a MEM and just adjust its mode.\n+\n \tPR debug/43165\n \t* cfgexpand.c (expand_debug_expr): Don't call simplify_gen_subreg\n \tif bitpos isn't multiple of mode's bitsize."}, {"sha": "7b8df04bed01603729b49de89c1fa3073a33c380", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=0679656478759e3bfd02f6f0a4b22fd792b736d7", "patch": "@@ -2316,7 +2316,11 @@ expand_debug_expr (tree exp)\n       else\n \top0 = copy_rtx (op0);\n \n-      if (GET_MODE (op0) == BLKmode)\n+      if (GET_MODE (op0) == BLKmode\n+\t  /* If op0 is not BLKmode, but BLKmode is, adjust_mode\n+\t     below would ICE.  While it is likely a FE bug,\n+\t     try to be robust here.  See PR43166.  */\n+\t  || mode == BLKmode)\n \t{\n \t  gcc_assert (MEM_P (op0));\n \t  op0 = adjust_address_nv (op0, mode, 0);"}, {"sha": "08a6b6803305ea0f60211f788d5d7214cb0f459c", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=0679656478759e3bfd02f6f0a4b22fd792b736d7", "patch": "@@ -1,3 +1,10 @@\n+2010-02-25  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/43166\n+\t* trans-common.c (build_common_decl): Also update DECL_MODE,\n+\tand DECL_SIZE when encountering a larger common block and call\n+\tlayout_decl.\n+\n 2010-02-24  Tobias Burnus  <burnus@net-b.de>              \n \n \tPR fortran/43042"}, {"sha": "844ac1d26745f97b7cd1bd66f1a40000411d06e0", "filename": "gcc/fortran/trans-common.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ffortran%2Ftrans-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ffortran%2Ftrans-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-common.c?ref=0679656478759e3bfd02f6f0a4b22fd792b736d7", "patch": "@@ -1,5 +1,5 @@\n /* Common block and equivalence list handling\n-   Copyright (C) 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n+   Copyright (C) 2000, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n    Free Software Foundation, Inc.\n    Contributed by Canqun Yang <canqun@nudt.edu.cn>\n \n@@ -399,8 +399,11 @@ build_common_decl (gfc_common_head *com, tree union_type, bool is_init)\n \t  if (strcmp (com->name, BLANK_COMMON_NAME))\n \t    gfc_warning (\"Named COMMON block '%s' at %L shall be of the \"\n \t\t\t \"same size\", com->name, &com->where);\n+\t  DECL_SIZE (decl) = TYPE_SIZE (union_type);\n \t  DECL_SIZE_UNIT (decl) = size;\n+\t  DECL_MODE (decl) = TYPE_MODE (union_type);\n \t  TREE_TYPE (decl) = union_type;\n+\t  layout_decl (decl, 0);\n \t}\n      }\n "}, {"sha": "c3fbe6646b5367f0984510690ea1d8430651f919", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0679656478759e3bfd02f6f0a4b22fd792b736d7", "patch": "@@ -1,5 +1,8 @@\n 2010-02-25  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/43166\n+\t* gfortran.dg/debug/pr43166.f: New test.\n+\n \tPR debug/43165\n \t* gcc.dg/torture/pr43165.c: New test.\n "}, {"sha": "a3146150b9970e2a237fe75ed0442d384d603935", "filename": "gcc/testsuite/gfortran.dg/debug/pr43166.f", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ftestsuite%2Fgfortran.dg%2Fdebug%2Fpr43166.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0679656478759e3bfd02f6f0a4b22fd792b736d7/gcc%2Ftestsuite%2Fgfortran.dg%2Fdebug%2Fpr43166.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdebug%2Fpr43166.f?ref=0679656478759e3bfd02f6f0a4b22fd792b736d7", "patch": "@@ -0,0 +1,14 @@\n+C PR debug/43166\n+C { dg-do compile }\n+C { dg-options \"-O\" }\n+      SUBROUTINE FOO ()\n+      INTEGER V1\n+      COMMON // V1\n+      END\n+      SUBROUTINE BAR ()\n+      INTEGER V0,V1,V2,V3\n+      COMMON // V1(4),V2(85,4),V3\n+      DO V3=1,V1(1)\n+      V0=V2(V3,1)\n+      END DO\n+      END"}]}