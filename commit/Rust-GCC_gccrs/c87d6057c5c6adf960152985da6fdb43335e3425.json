{"sha": "c87d6057c5c6adf960152985da6fdb43335e3425", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzg3ZDYwNTdjNWM2YWRmOTYwMTUyOTg1ZGE2ZmRiNDMzMzVlMzQyNQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-06-03T12:07:18Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-06-03T12:07:18Z"}, "message": "re PR debug/44375 (goto_locus lost at -O0 during cfg cleanup)\n\n\tPR debug/44375\n\t* tree-cfg.c (gimple_can_merge_blocks_p): For -O0\n\treturn false if merging the bbs would lead to goto_locus\n\tlocation being lost from the IL.\n\nFrom-SVN: r160219", "tree": {"sha": "5d1c3d235bcff20ac849a7ae612d193a9478c613", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d1c3d235bcff20ac849a7ae612d193a9478c613"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c87d6057c5c6adf960152985da6fdb43335e3425", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c87d6057c5c6adf960152985da6fdb43335e3425", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c87d6057c5c6adf960152985da6fdb43335e3425", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c87d6057c5c6adf960152985da6fdb43335e3425/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e2cc34833f35bfcdcac58d0b348900636f54c6f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2cc34833f35bfcdcac58d0b348900636f54c6f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2cc34833f35bfcdcac58d0b348900636f54c6f1"}], "stats": {"total": 24, "additions": 24, "deletions": 0}, "files": [{"sha": "61cf4d76c32da15ed84eabd1d891bf88b5a608b1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c87d6057c5c6adf960152985da6fdb43335e3425/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c87d6057c5c6adf960152985da6fdb43335e3425/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c87d6057c5c6adf960152985da6fdb43335e3425", "patch": "@@ -1,3 +1,10 @@\n+2010-06-03  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/44375\n+\t* tree-cfg.c (gimple_can_merge_blocks_p): For -O0\n+\treturn false if merging the bbs would lead to goto_locus\n+\tlocation being lost from the IL.\n+\n 2010-06-03  Jan Hubicka  <jh@suse.cz>\n \t    Jakub Jelinek  <jakub@redhat.com>\n "}, {"sha": "eca3ed018ce7909dfa40fe89248f66b8a8ba4abe", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c87d6057c5c6adf960152985da6fdb43335e3425/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c87d6057c5c6adf960152985da6fdb43335e3425/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=c87d6057c5c6adf960152985da6fdb43335e3425", "patch": "@@ -1475,6 +1475,23 @@ gimple_can_merge_blocks_p (basic_block a, basic_block b)\n       && name_mappings_registered_p ())\n     return false;\n \n+  /* When not optimizing, don't merge if we'd lose goto_locus.  */\n+  if (!optimize\n+      && single_succ_edge (a)->goto_locus != UNKNOWN_LOCATION)\n+    {\n+      location_t goto_locus = single_succ_edge (a)->goto_locus;\n+      gimple_stmt_iterator prev, next;\n+      prev = gsi_last_nondebug_bb (a);\n+      next = gsi_after_labels (b);\n+      if (!gsi_end_p (next) && is_gimple_debug (gsi_stmt (next)))\n+\tgsi_next_nondebug (&next);\n+      if ((gsi_end_p (prev)\n+\t   || gimple_location (gsi_stmt (prev)) != goto_locus)\n+\t  && (gsi_end_p (next)\n+\t      || gimple_location (gsi_stmt (next)) != goto_locus))\n+\treturn false;\n+    }\n+\n   return true;\n }\n "}]}