{"sha": "37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzdmODhlM2VhMGQ0NTQ4YWMzZjhjMDZhMjRiMGQ3ZTI1NzM4NWFlNA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@yorick.cygnus.com", "date": "1999-10-04T08:30:28Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "1999-10-04T08:30:28Z"}, "message": "* init.c (build_vec_delete_1): Fold COND_EXPRs.\n\nFrom-SVN: r29796", "tree": {"sha": "b1e5ecf361fac5f350eca6f12b2868f30e943475", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b1e5ecf361fac5f350eca6f12b2868f30e943475"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4/comments", "author": null, "committer": null, "parents": [{"sha": "749168094a891b9e15d1025aa665f6a066992845", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/749168094a891b9e15d1025aa665f6a066992845", "html_url": "https://github.com/Rust-GCC/gccrs/commit/749168094a891b9e15d1025aa665f6a066992845"}], "stats": {"total": 30, "additions": 18, "deletions": 12}, "files": [{"sha": "21ea589290970717b427a2d41aaddc3e0ef125f1", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4", "patch": "@@ -1,3 +1,7 @@\n+1999-10-04  Jason Merrill  <jason@yorick.cygnus.com>\n+\n+\t* init.c (build_vec_delete_1): Fold COND_EXPRs.\n+\n 1999-10-03  Mark Mitchell  <mark@codesourcery.com>\n \n \t* cp-tree.def (VEC_INIT_EXPR): Remove."}, {"sha": "e6a1c5f4c5a6cf301d13e8f1d7167927ef1c34be", "filename": "gcc/cp/init.c", "status": "modified", "additions": 14, "deletions": 12, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=37f88e3ea0d4548ac3f8c06a24b0d7e257385ae4", "patch": "@@ -2526,10 +2526,10 @@ build_vec_delete_1 (base, maxindex, type, auto_delete_vec, auto_delete,\n \t\t\t      build_x_delete (base_tbd,\n \t\t\t\t\t      2 | use_global_delete,\n \t\t\t\t\t      virtual_size));\n-      body = build (COND_EXPR, void_type_node,\n-\t\t    build (BIT_AND_EXPR, integer_type_node,\n-\t\t\t   auto_delete, integer_one_node),\n-\t\t    body, integer_zero_node);\n+      body = fold (build (COND_EXPR, void_type_node,\n+\t\t\t  fold (build (BIT_AND_EXPR, integer_type_node,\n+\t\t\t\t       auto_delete, integer_one_node)),\n+\t\t\t  body, integer_zero_node));\n     }\n   else\n     body = NULL_TREE;\n@@ -2581,11 +2581,12 @@ build_vec_delete_1 (base, maxindex, type, auto_delete_vec, auto_delete,\n       deallocate_expr = build_x_delete (base_tbd,\n \t\t\t\t\t2 | use_global_delete,\n \t\t\t\t\tvirtual_size);\n-      if (auto_delete_vec != integer_one_node)\n-\tdeallocate_expr = build (COND_EXPR, void_type_node,\n-\t\t\t\t build (BIT_AND_EXPR, integer_type_node,\n-\t\t\t\t\tauto_delete_vec, integer_one_node),\n-\t\t\t\t deallocate_expr, integer_zero_node);\n+      deallocate_expr = fold (build (COND_EXPR, void_type_node,\n+\t\t\t\t     fold (build (BIT_AND_EXPR,\n+\t\t\t\t\t\t  integer_type_node,\n+\t\t\t\t\t\t  auto_delete_vec,\n+\t\t\t\t\t\t  integer_one_node)),\n+\t\t\t\t     deallocate_expr, integer_zero_node));\n     }\n \n   if (loop && deallocate_expr != integer_zero_node)\n@@ -2598,9 +2599,10 @@ build_vec_delete_1 (base, maxindex, type, auto_delete_vec, auto_delete,\n     body = loop;\n \n   /* Outermost wrapper: If pointer is null, punt.  */\n-  body = build (COND_EXPR, void_type_node,\n-\t\tbuild (NE_EXPR, boolean_type_node, base, integer_zero_node),\n-\t\tbody, integer_zero_node);\n+  body = fold (build (COND_EXPR, void_type_node,\n+\t\t      fold (build (NE_EXPR, boolean_type_node, base,\n+\t\t\t\t   integer_zero_node)),\n+\t\t      body, integer_zero_node));\n   body = build1 (NOP_EXPR, void_type_node, body);\n \n   if (controller)"}]}