{"sha": "e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTVjY2FiODM5YTI0YTljNWFjMWRkYmI2ZTBhZDFjMzM5ZGYzMTY1ZQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-05-11T18:05:46Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-05-11T19:09:42Z"}, "message": "c++: Improve print_tree of static_assert.\n\nWe weren't printing the condition and message of a STATIC_ASSERT.\n\nIt's also unnecessary to duplicate the code for instantiating a\nSTATIC_ASSERT between tsubst_expr and instantiate_class_template_1.\n\ngcc/cp/ChangeLog\n2020-05-11  Jason Merrill  <jason@redhat.com>\n\n\t* pt.c (instantiate_class_template_1): Call tsubst_expr for\n\tSTATIC_ASSERT member.\n\t* ptree.c (cxx_print_xnode): Handle STATIC_ASSERT.", "tree": {"sha": "9da88fa1a19781b4a8783ecac449bbe134bb9370", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9da88fa1a19781b4a8783ecac449bbe134bb9370"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f3f9cc41a1a793375a9fff09bfb7a103ce259e07", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f3f9cc41a1a793375a9fff09bfb7a103ce259e07", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f3f9cc41a1a793375a9fff09bfb7a103ce259e07"}], "stats": {"total": 34, "additions": 19, "deletions": 15}, "files": [{"sha": "1fdc3880fff9ebf9573c7e7e502cd3932c074638", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e", "patch": "@@ -1,3 +1,9 @@\n+2020-05-11  Jason Merrill  <jason@redhat.com>\n+\n+\t* pt.c (instantiate_class_template_1): Call tsubst_expr for\n+\tSTATIC_ASSERT member.\n+\t* ptree.c (cxx_print_xnode): Handle STATIC_ASSERT.\n+\n 2020-05-11  Jason Merrill  <jason@redhat.com>\n \n \t* pt.c (find_parameter_packs_r) [LAMBDA_EXPR]: Remove redundant"}, {"sha": "28f3c90f17b82aea57cca2122441cc0547ae5128", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 2, "deletions": 15, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e", "patch": "@@ -11809,21 +11809,8 @@ instantiate_class_template_1 (tree type)\n \t    {\n \t      /* Build new TYPE_FIELDS.  */\n               if (TREE_CODE (t) == STATIC_ASSERT)\n-                {\n-                  tree condition;\n-\n-\t\t  ++c_inhibit_evaluation_warnings;\n-\t\t  condition =\n-\t\t    tsubst_expr (STATIC_ASSERT_CONDITION (t), args,\n-\t\t\t\t tf_warning_or_error, NULL_TREE,\n-\t\t\t\t /*integral_constant_expression_p=*/true);\n-\t\t  --c_inhibit_evaluation_warnings;\n-\n-                  finish_static_assert (condition,\n-                                        STATIC_ASSERT_MESSAGE (t), \n-                                        STATIC_ASSERT_SOURCE_LOCATION (t),\n-                                        /*member_p=*/true);\n-                }\n+\t\ttsubst_expr (t, args, tf_warning_or_error, NULL_TREE,\n+\t\t\t     /*integral_constant_expression_p=*/true);\n \t      else if (TREE_CODE (t) != CONST_DECL)\n \t\t{\n \t\t  tree r;"}, {"sha": "ab18eecd0e67a6da68f95ac98de9313862c79f5c", "filename": "gcc/cp/ptree.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e/gcc%2Fcp%2Fptree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e/gcc%2Fcp%2Fptree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fptree.c?ref=e5ccab839a24a9c5ac1ddbb6e0ad1c339df3165e", "patch": "@@ -269,6 +269,17 @@ cxx_print_xnode (FILE *file, tree node, int indent)\n     case LAMBDA_EXPR:\n       cxx_print_lambda_node (file, node, indent);\n       break;\n+    case STATIC_ASSERT:\n+      if (location_t loc = STATIC_ASSERT_SOURCE_LOCATION (node))\n+\t{\n+\t  expanded_location xloc = expand_location (loc);\n+\t  indent_to (file, indent+4);\n+\t  fprintf (file, \"%s:%d:%d\", xloc.file, xloc.line, xloc.column);\n+\t}\n+      print_node (file, \"condition\", STATIC_ASSERT_CONDITION (node), indent+4);\n+      if (tree message = STATIC_ASSERT_MESSAGE (node))\n+\tprint_node (file, \"message\", message, indent+4);\n+      break;\n     default:\n       break;\n     }"}]}