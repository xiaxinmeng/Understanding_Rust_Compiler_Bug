{"sha": "5fe2e4f87e512407c5c560dfec2fe48ba099c807", "node_id": "C_kwDOANBUbNoAKDVmZTJlNGY4N2U1MTI0MDdjNWM1NjBkZmVjMmZlNDhiYTA5OWM4MDc", "commit": {"author": {"name": "Torbj\u00f6rn SVENSSON", "email": "torbjorn.svensson@foss.st.com", "date": "2022-09-29T17:38:10Z"}, "committer": {"name": "Jonathan Yong", "email": "10walls@gmail.com", "date": "2022-10-05T09:44:11Z"}, "message": "testsuite: /dev/null is not accessible on Windows\n\nWhen running the DejaGNU testsuite on a toolchain built for native\nWindows, the path /dev/null can't be used to open a stream to void.\nOn native Windows, the resource is instead named \"nul\".\n\nThe error would look like this:\nc:/arm-11.3.rel1/bin/../lib/gcc/arm-none-eabi/11.3.1/../../../../arm-none-eabi/bin/ld.exe: cannot find @/dev/null: No such file or directory\n\nPatch has been verified on Windows and Linux.\n\ngcc/testsuite:\n\n\t* gcc.misc-tests/outputs.exp: Use \"@nul\" for Windows,\n\t\"@/dev/null\" for other environments.\n\nCo-Authored-By: Yvan ROUX  <yvan.roux@foss.st.com>\nSigned-off-by: Torbj\u00f6rn SVENSSON  <torbjorn.svensson@foss.st.com>\nSigned-off-by: Jonathan Yong <10walls@gmail.com>", "tree": {"sha": "31d24f12124c7202b289a118fe5dacb0a057c2c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/31d24f12124c7202b289a118fe5dacb0a057c2c2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5fe2e4f87e512407c5c560dfec2fe48ba099c807", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fe2e4f87e512407c5c560dfec2fe48ba099c807", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fe2e4f87e512407c5c560dfec2fe48ba099c807", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fe2e4f87e512407c5c560dfec2fe48ba099c807/comments", "author": null, "committer": {"login": "jon-y", "id": 4688224, "node_id": "MDQ6VXNlcjQ2ODgyMjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4688224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jon-y", "html_url": "https://github.com/jon-y", "followers_url": "https://api.github.com/users/jon-y/followers", "following_url": "https://api.github.com/users/jon-y/following{/other_user}", "gists_url": "https://api.github.com/users/jon-y/gists{/gist_id}", "starred_url": "https://api.github.com/users/jon-y/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jon-y/subscriptions", "organizations_url": "https://api.github.com/users/jon-y/orgs", "repos_url": "https://api.github.com/users/jon-y/repos", "events_url": "https://api.github.com/users/jon-y/events{/privacy}", "received_events_url": "https://api.github.com/users/jon-y/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b77bcdf445685f28dae9e42b69e006801d653001", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b77bcdf445685f28dae9e42b69e006801d653001", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b77bcdf445685f28dae9e42b69e006801d653001"}], "stats": {"total": 17, "additions": 12, "deletions": 5}, "files": [{"sha": "3fe7270fa6346aa9da57e414d333f4db3910d451", "filename": "gcc/testsuite/gcc.misc-tests/outputs.exp", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5fe2e4f87e512407c5c560dfec2fe48ba099c807/gcc%2Ftestsuite%2Fgcc.misc-tests%2Foutputs.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5fe2e4f87e512407c5c560dfec2fe48ba099c807/gcc%2Ftestsuite%2Fgcc.misc-tests%2Foutputs.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.misc-tests%2Foutputs.exp?ref=5fe2e4f87e512407c5c560dfec2fe48ba099c807", "patch": "@@ -78,6 +78,13 @@ if {[board_info $dest exists output_format]} {\n     append link_options \" additional_flags=-Wl,-oformat,[board_info $dest output_format]\"\n }\n \n+\n+set devnull \"/dev/null\"\n+if { [info exists ::env(OS)] && [string match \"Windows*\" $::env(OS)] } {\n+    # Windows uses special file named \"nul\" as a substitute for /dev/null\n+    set devnull \"nul\"\n+}\n+\n # Avoid possible influence from the make jobserver,\n # otherwise ltrans0.ltrans_args files may be missing.\n if [info exists env(MAKEFLAGS)] {\n@@ -353,10 +360,10 @@ outest \"$b-21 exe savetmp named2\" $mult \"-o $b.exe -save-temps\" {} {{--1.i --1.s\n \n # Additional files are created when an @file is used\n if !$skip_atsave {\n-outest \"$b-22 exe savetmp namedb-2\" $sing \"@/dev/null -o $b.exe -save-temps\" {} {{--0.i --0.s --0.o .args.0 !!$gld .ld1_args !0 .exe}}\n-outest \"$b-23 exe savetmp named2-2\" $mult \"@/dev/null -o $b.exe -save-temps\" {} {{--1.i --1.s --1.o --2.i --2.s --2.o .args.0 !!$gld .ld1_args !0 .exe}}\n-outest \"$b-24 exe savetmp named2-3\" $mult \"@/dev/null -I dummy -o $b.exe -save-temps\" {} {{--1.i --1.s --1.o --2.i --2.s --2.o -args.0 -args.1 .args.2 !!$gld .ld1_args !0 .exe}}\n-outest \"$b-25 exe savetmp named2-4\" $mult \"@/dev/null -I dummy -L dummy -o $b.exe -save-temps\" {} {{--1.i --1.s --1.o --2.i --2.s --2.o -args.0 -args.1 .args.2 .args.3 !!$gld .ld1_args !0 .exe}}\n+outest \"$b-22 exe savetmp namedb-2\" $sing \"@$devnull -o $b.exe -save-temps\" {} {{--0.i --0.s --0.o .args.0 !!$gld .ld1_args !0 .exe}}\n+outest \"$b-23 exe savetmp named2-2\" $mult \"@$devnull -o $b.exe -save-temps\" {} {{--1.i --1.s --1.o --2.i --2.s --2.o .args.0 !!$gld .ld1_args !0 .exe}}\n+outest \"$b-24 exe savetmp named2-3\" $mult \"@$devnull -I dummy -o $b.exe -save-temps\" {} {{--1.i --1.s --1.o --2.i --2.s --2.o -args.0 -args.1 .args.2 !!$gld .ld1_args !0 .exe}}\n+outest \"$b-25 exe savetmp named2-4\" $mult \"@$devnull -I dummy -L dummy -o $b.exe -save-temps\" {} {{--1.i --1.s --1.o --2.i --2.s --2.o -args.0 -args.1 .args.2 .args.3 !!$gld .ld1_args !0 .exe}}\n }\n \n # Setting the main output to a dir selects it as the default aux&dump\n@@ -714,7 +721,7 @@ outest \"$b-291 lto mult named-2\" $mult \"-o $b.exe -O2 -flto -fno-use-linker-plug\n outest \"$b-292 lto sing nameddir-2\" $sing \"-o dir/$b.exe -O2 -flto -fno-use-linker-plugin -flto-partition=one -fdump-ipa-icf-optimized -fdump-rtl-final -fstack-usage\" {dir/} {{--0.c.???i.icf --0.c.???r.final .wpa.???i.icf .ltrans0.ltrans.???r.final .ltrans0.ltrans.su .exe} {}}\n outest \"$b-293 lto mult nameddir-2\" $mult \"-o dir/$b.exe -O2 -flto -fno-use-linker-plugin -flto-partition=one -fdump-ipa-icf-optimized -fdump-rtl-final -fstack-usage\" {dir/} {{--1.c.???i.icf --1.c.???r.final --2.c.???i.icf --2.c.???r.final .wpa.???i.icf .ltrans0.ltrans.???r.final .ltrans0.ltrans.su .exe} {}}\n if !$skip_atsave {\n-outest \"$b-294 lto sing unnamed-3\" $sing \"@/dev/null -O2 -flto -fno-use-linker-plugin -flto-partition=one -fdump-ipa-icf-optimized -fdump-rtl-final -fstack-usage -save-temps $oaout\" {} {{a--0.c.???i.icf a--0.c.???r.final a.wpa.???i.icf a.ltrans0.ltrans.???r.final a.ltrans0.ltrans.su a--0.o a--0.s a--0.i a.ltrans0.o a.ltrans.out a.ltrans0.ltrans.o a.ltrans0.ltrans_args a.args.0 a.ltrans0.ltrans.s a.wpa.args.0 a.lto_args a.ld1_args a.ltrans_args a.ltrans0.ltrans.args.0 a.ld_args $aout}}\n+outest \"$b-294 lto sing unnamed-3\" $sing \"@$devnull -O2 -flto -fno-use-linker-plugin -flto-partition=one -fdump-ipa-icf-optimized -fdump-rtl-final -fstack-usage -save-temps $oaout\" {} {{a--0.c.???i.icf a--0.c.???r.final a.wpa.???i.icf a.ltrans0.ltrans.???r.final a.ltrans0.ltrans.su a--0.o a--0.s a--0.i a.ltrans0.o a.ltrans.out a.ltrans0.ltrans.o a.ltrans0.ltrans_args a.args.0 a.ltrans0.ltrans.s a.wpa.args.0 a.lto_args a.ld1_args a.ltrans_args a.ltrans0.ltrans.args.0 a.ld_args $aout}}\n }\n }\n "}]}