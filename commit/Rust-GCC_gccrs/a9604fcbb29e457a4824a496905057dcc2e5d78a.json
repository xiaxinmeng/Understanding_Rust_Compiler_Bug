{"sha": "a9604fcbb29e457a4824a496905057dcc2e5d78a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTk2MDRmY2JiMjllNDU3YTQ4MjRhNDk2OTA1MDU3ZGNjMmU1ZDc4YQ==", "commit": {"author": {"name": "Marcus Comstedt", "email": "marcus@mc.pp.se", "date": "2021-03-19T19:49:03Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2021-03-23T09:31:13Z"}, "message": "RISC-V: Support -mlittle-endian and -mbig-endian\n\ngcc/\n\t* config/riscv/elf.h (LINK_SPEC): Pass linker endianness flag.\n\t* config/riscv/freebsd.h (LINK_SPEC): Likewise.\n\t* config/riscv/linux.h (LINK_SPEC): Likewise.\n\t* config/riscv/riscv.h (ASM_SPEC): Pass -mbig-endian and\n\t-mlittle-endian.\n\t(BYTES_BIG_ENDIAN): Handle big endian.\n\t(WORDS_BIG_ENDIAN): Define to BYTES_BIG_ENDIAN.\n\t* config/riscv/riscv.opt (-mbig-endian, -mlittle-endian): New\n\toptions.\n\t* doc/invoke.texi (-mbig-endian, -mlittle-endian): Document.", "tree": {"sha": "3c3c79817ba7034c2af5aaff7bb4ba47a356a10e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3c3c79817ba7034c2af5aaff7bb4ba47a356a10e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a9604fcbb29e457a4824a496905057dcc2e5d78a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9604fcbb29e457a4824a496905057dcc2e5d78a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a9604fcbb29e457a4824a496905057dcc2e5d78a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9604fcbb29e457a4824a496905057dcc2e5d78a/comments", "author": {"login": "zeldin", "id": 411296, "node_id": "MDQ6VXNlcjQxMTI5Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/411296?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zeldin", "html_url": "https://github.com/zeldin", "followers_url": "https://api.github.com/users/zeldin/followers", "following_url": "https://api.github.com/users/zeldin/following{/other_user}", "gists_url": "https://api.github.com/users/zeldin/gists{/gist_id}", "starred_url": "https://api.github.com/users/zeldin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zeldin/subscriptions", "organizations_url": "https://api.github.com/users/zeldin/orgs", "repos_url": "https://api.github.com/users/zeldin/repos", "events_url": "https://api.github.com/users/zeldin/events{/privacy}", "received_events_url": "https://api.github.com/users/zeldin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3e07e7a6a7f34f0ec2f1a3e50ebc52b77de11a30", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e07e7a6a7f34f0ec2f1a3e50ebc52b77de11a30", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e07e7a6a7f34f0ec2f1a3e50ebc52b77de11a30"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "973efdaed7b6431b2801244f987bfd9dc37f678b", "filename": "gcc/config/riscv/elf.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Felf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Felf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Felf.h?ref=a9604fcbb29e457a4824a496905057dcc2e5d78a", "patch": "@@ -20,6 +20,8 @@ along with GCC; see the file COPYING3.  If not see\n #define LINK_SPEC \"\\\n -melf\" XLEN_SPEC \"lriscv \\\n %{mno-relax:--no-relax} \\\n+%{mbig-endian:-EB} \\\n+%{mlittle-endian:-EL} \\\n %{shared}\"\n \n /* Link against Newlib libraries, because the ELF backend assumes Newlib."}, {"sha": "f3aca9f76734fe92c290a80ccda04d0f37c0a8d0", "filename": "gcc/config/riscv/freebsd.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Ffreebsd.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Ffreebsd.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Ffreebsd.h?ref=a9604fcbb29e457a4824a496905057dcc2e5d78a", "patch": "@@ -44,6 +44,8 @@ along with GCC; see the file COPYING3.  If not see\n   %{p:%nconsider using `-pg' instead of `-p' with gprof (1)}\t\\\n   %{v:-V}\t\t\t\t\t\t\t\\\n   %{assert*} %{R*} %{rpath*} %{defsym*}\t\t\t\t\\\n+  %{mbig-endian:-EB}\t\t\t\t\t\t\\\n+  %{mlittle-endian:-EL}\t\t\t\t\t\t\\\n   %{shared:-Bshareable %{h*} %{soname*}}\t\t\t\\\n   %{symbolic:-Bsymbolic}\t\t\t\t\t\\\n   %{static:-Bstatic}\t\t\t\t\t\t\\"}, {"sha": "e74f5d3f914255136641af02b76709b2b5fa1d16", "filename": "gcc/config/riscv/linux.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Flinux.h?ref=a9604fcbb29e457a4824a496905057dcc2e5d78a", "patch": "@@ -60,6 +60,8 @@ along with GCC; see the file COPYING3.  If not see\n #define LINK_SPEC \"\\\n -melf\" XLEN_SPEC \"lriscv\" LD_EMUL_SUFFIX \" \\\n %{mno-relax:--no-relax} \\\n+%{mbig-endian:-EB} \\\n+%{mlittle-endian:-EL} \\\n %{shared} \\\n   %{!shared: \\\n     %{!static: \\"}, {"sha": "0b667d2e8b9172e813abff703197206d17193c0a", "filename": "gcc/config/riscv/riscv.h", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Friscv.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Friscv.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.h?ref=a9604fcbb29e457a4824a496905057dcc2e5d78a", "patch": "@@ -91,6 +91,8 @@ extern const char *riscv_default_mtune (int argc, const char **argv);\n %{\" FPIE_OR_FPIC_SPEC \":-fpic} \\\n %{march=*} \\\n %{mabi=*} \\\n+%{mbig-endian} \\\n+%{mlittle-endian} \\\n %(subtarget_asm_spec)\" \\\n ASM_MISA_SPEC\n \n@@ -126,8 +128,8 @@ ASM_MISA_SPEC\n /* Target machine storage layout */\n \n #define BITS_BIG_ENDIAN 0\n-#define BYTES_BIG_ENDIAN 0\n-#define WORDS_BIG_ENDIAN 0\n+#define BYTES_BIG_ENDIAN (TARGET_BIG_ENDIAN != 0)\n+#define WORDS_BIG_ENDIAN (BYTES_BIG_ENDIAN)\n \n #define MAX_BITS_PER_WORD 64\n "}, {"sha": "e294e22315136d0cbff5b2b33aaa1710db746508", "filename": "gcc/config/riscv/riscv.opt", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Friscv.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fconfig%2Friscv%2Friscv.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.opt?ref=a9604fcbb29e457a4824a496905057dcc2e5d78a", "patch": "@@ -21,6 +21,14 @@\n HeaderInclude\n config/riscv/riscv-opts.h\n \n+mbig-endian\n+Target RejectNegative Mask(BIG_ENDIAN)\n+Assume target CPU is configured as big endian.\n+\n+mlittle-endian\n+Target RejectNegative InverseMask(BIG_ENDIAN)\n+Assume target CPU is configured as little endian.\n+\n mbranch-cost=\n Target RejectNegative Joined UInteger Var(riscv_branch_cost)\n -mbranch-cost=N\tSet the cost of branches to roughly N instructions."}, {"sha": "ca204c7c3d89061448d90256af9d968ed2d6c5fc", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a9604fcbb29e457a4824a496905057dcc2e5d78a/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=a9604fcbb29e457a4824a496905057dcc2e5d78a", "patch": "@@ -1171,6 +1171,7 @@ See RS/6000 and PowerPC Options.\n -mrelax  -mno-relax @gol\n -mriscv-attribute  -mmo-riscv-attribute @gol\n -malign-data=@var{type} @gol\n+-mbig-endian  -mlittle-endian @gol\n +-mstack-protector-guard=@var{guard} -mstack-protector-guard-reg=@var{reg} @gol\n +-mstack-protector-guard-offset=@var{offset}}\n \n@@ -26748,6 +26749,17 @@ types.  Supported values for @var{type} are @samp{xlen} which uses x register\n width as the alignment value, and @samp{natural} which uses natural alignment.\n @samp{xlen} is the default.\n \n+@item -mbig-endian\n+@opindex mbig-endian\n+Generate big-endian code.  This is the default when GCC is configured for a\n+@samp{riscv64be-*-*} or @samp{riscv32be-*-*} target.\n+\n+@item -mlittle-endian\n+@opindex mlittle-endian\n+Generate little-endian code.  This is the default when GCC is configured for a\n+@samp{riscv64-*-*} or @samp{riscv32-*-*} but not a @samp{riscv64be-*-*} or\n+@samp{riscv32be-*-*} target.\n+\n @item -mstack-protector-guard=@var{guard}\n @itemx -mstack-protector-guard-reg=@var{reg}\n @itemx -mstack-protector-guard-offset=@var{offset}"}]}