{"sha": "65401a0ba393e9f2b971e9069e0335dc26c8a917", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjU0MDFhMGJhMzkzZTlmMmI5NzFlOTA2OWUwMzM1ZGMyNmM4YTkxNw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2009-03-06T22:51:28Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2009-03-06T22:51:28Z"}, "message": "re PR middle-end/39360 (ICE in referenced_var_lookup, at tree-dfa.c:563)\n\n\tPR middle-end/39360\n\t* tree-flow.h (add_referenced_var): Return bool instead of void.\n\t* tree-dfa.c (add_referenced_var): Return result of\n\treferenced_var_check_and_insert call.\n\t* tree-inline.c (expand_call_inline): Call add_referenced_var instead\n\tof referenced_var_check_and_insert.\n\n\t* gcc.c-torture/compile/pr39360.c: New test.\n\nFrom-SVN: r144683", "tree": {"sha": "d04ea7237c3310a33db5662c63ae571acd66723f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d04ea7237c3310a33db5662c63ae571acd66723f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/65401a0ba393e9f2b971e9069e0335dc26c8a917", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65401a0ba393e9f2b971e9069e0335dc26c8a917", "html_url": "https://github.com/Rust-GCC/gccrs/commit/65401a0ba393e9f2b971e9069e0335dc26c8a917", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65401a0ba393e9f2b971e9069e0335dc26c8a917/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9f0e7885bb87904aac629a6c9aa3df4156667c08", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f0e7885bb87904aac629a6c9aa3df4156667c08", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f0e7885bb87904aac629a6c9aa3df4156667c08"}], "stats": {"total": 44, "additions": 37, "deletions": 7}, "files": [{"sha": "68bd222fb79683e48faf859c6644d1506c42125b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=65401a0ba393e9f2b971e9069e0335dc26c8a917", "patch": "@@ -1,5 +1,12 @@\n 2009-03-06  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR middle-end/39360\n+\t* tree-flow.h (add_referenced_var): Return bool instead of void.\n+\t* tree-dfa.c (add_referenced_var): Return result of\n+\treferenced_var_check_and_insert call.\n+\t* tree-inline.c (expand_call_inline): Call add_referenced_var instead\n+\tof referenced_var_check_and_insert.\n+\n \tPR debug/39372\n \t* dwarf2out.c (add_abstract_origin_attribute): Return\n \torigin_die."}, {"sha": "c349894213c9ce12a4e6d65643a6456185259098", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=65401a0ba393e9f2b971e9069e0335dc26c8a917", "patch": "@@ -1,5 +1,8 @@\n 2009-03-06  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR middle-end/39360\n+\t* gcc.c-torture/compile/pr39360.c: New test.\n+\n \tPR debug/39372\n \t* g++.dg/debug/dwarf2/static-local-var-in-ctor.C: New test.\n "}, {"sha": "0bd63114431c387f60ed63c0d3092a0033cb8928", "filename": "gcc/testsuite/gcc.c-torture/compile/pr39360.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr39360.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr39360.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr39360.c?ref=65401a0ba393e9f2b971e9069e0335dc26c8a917", "patch": "@@ -0,0 +1,16 @@\n+/* PR middle-end/39360 */\n+\n+static int a[] = { 1 };\n+\n+static inline void\n+bar (int **x)\n+{\n+  static int *c[2] = { 0, a };\n+  *x = c[1];\n+}\n+\n+int\n+foo (int **x)\n+{\n+  bar (x);\n+}"}, {"sha": "5241e64c9292e26f5960172621687ec8d4aa106e", "filename": "gcc/tree-dfa.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftree-dfa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftree-dfa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-dfa.c?ref=65401a0ba393e9f2b971e9069e0335dc26c8a917", "patch": "@@ -1,6 +1,6 @@\n /* Data flow functions for trees.\n-   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2007, 2008 Free Software\n-   Foundation, Inc.\n+   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2007, 2008, 2009\n+   Free Software Foundation, Inc.\n    Contributed by Diego Novillo <dnovillo@redhat.com>\n \n This file is part of GCC.\n@@ -639,7 +639,7 @@ set_default_def (tree var, tree def)\n \n /* Add VAR to the list of referenced variables if it isn't already there.  */\n \n-void\n+bool\n add_referenced_var (tree var)\n {\n   var_ann_t v_ann;\n@@ -655,7 +655,7 @@ add_referenced_var (tree var)\n       \n       /* Tag's don't have DECL_INITIAL.  */\n       if (MTAG_P (var))\n-\treturn;\n+\treturn true;\n \n       /* Scan DECL_INITIAL for pointer variables as they may contain\n \t address arithmetic referencing the address of other\n@@ -667,7 +667,11 @@ add_referenced_var (tree var)\n \t     optimizers.  */\n           && !DECL_EXTERNAL (var))\n       \twalk_tree (&DECL_INITIAL (var), find_vars_r, NULL, 0);\n+\n+      return true;\n     }\n+\n+  return false;\n }\n \n /* Remove VAR from the list.  */"}, {"sha": "40829675b84cb6079ff65d4cb5ac51f8bd192735", "filename": "gcc/tree-flow.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftree-flow.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftree-flow.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-flow.h?ref=65401a0ba393e9f2b971e9069e0335dc26c8a917", "patch": "@@ -768,7 +768,7 @@ extern void dump_referenced_vars (FILE *);\n extern void dump_variable (FILE *, tree);\n extern void debug_variable (tree);\n extern tree get_virtual_var (tree);\n-extern void add_referenced_var (tree);\n+extern bool add_referenced_var (tree);\n extern void remove_referenced_var (tree);\n extern void mark_symbols_for_renaming (gimple);\n extern void find_new_referenced_vars (gimple);"}, {"sha": "917b5267434fcc16a8f44853e38868038690cd5a", "filename": "gcc/tree-inline.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftree-inline.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65401a0ba393e9f2b971e9069e0335dc26c8a917/gcc%2Ftree-inline.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-inline.c?ref=65401a0ba393e9f2b971e9069e0335dc26c8a917", "patch": "@@ -1,5 +1,5 @@\n /* Tree inlining.\n-   Copyright 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008\n+   Copyright 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009\n    Free Software Foundation, Inc.\n    Contributed by Alexandre Oliva <aoliva@redhat.com>\n \n@@ -3383,7 +3383,7 @@ expand_call_inline (basic_block bb, gimple stmt, copy_body_data *id)\n       var = TREE_VALUE (t_step);\n       if (TREE_STATIC (var) && !TREE_ASM_WRITTEN (var))\n \t{\n-\t  if (var_ann (var) && referenced_var_check_and_insert (var))\n+\t  if (var_ann (var) && add_referenced_var (var))\n \t    cfun->local_decls = tree_cons (NULL_TREE, var,\n \t\t\t\t\t   cfun->local_decls);\n \t}"}]}