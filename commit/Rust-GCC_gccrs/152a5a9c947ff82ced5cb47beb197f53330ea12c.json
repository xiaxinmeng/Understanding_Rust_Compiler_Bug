{"sha": "152a5a9c947ff82ced5cb47beb197f53330ea12c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTUyYTVhOWM5NDdmZjgyY2VkNWNiNDdiZWIxOTdmNTMzMzBlYTEyYw==", "commit": {"author": {"name": "Jason Thorpe", "email": "thorpej@gcc.gnu.org", "date": "2002-11-26T00:31:31Z"}, "committer": {"name": "Jason Thorpe", "email": "thorpej@gcc.gnu.org", "date": "2002-11-26T00:31:31Z"}, "message": "gcc.c (static_spec_functions): Add if-exists-else spec function.\n\n* gcc.c (static_spec_functions): Add if-exists-else spec\nfunction.\n(if_exists_else_spec_function): New function.\n* doc/invoke.texi: Document the if-exists-else spec function.\n\n* config/netbsd-elf.h (NETBSD_STARTFILE_SPEC): For -static, use\n\"%:if-exists-else(crtbeginT%O%s crtbegin%O%s)\".\n\nFrom-SVN: r59480", "tree": {"sha": "fb57bd2526716f6ab368a2f04bc887feb665ac9b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fb57bd2526716f6ab368a2f04bc887feb665ac9b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/152a5a9c947ff82ced5cb47beb197f53330ea12c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/152a5a9c947ff82ced5cb47beb197f53330ea12c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/152a5a9c947ff82ced5cb47beb197f53330ea12c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/152a5a9c947ff82ced5cb47beb197f53330ea12c/comments", "author": null, "committer": null, "parents": [{"sha": "a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4967b8db12d7f2d9b0d80830507f806c4c36e5b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4967b8db12d7f2d9b0d80830507f806c4c36e5b"}], "stats": {"total": 41, "additions": 39, "deletions": 2}, "files": [{"sha": "cb38b93ba0a17911c4579cc1fddae5536474d8d7", "filename": "gcc/config/netbsd-elf.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/152a5a9c947ff82ced5cb47beb197f53330ea12c/gcc%2Fconfig%2Fnetbsd-elf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/152a5a9c947ff82ced5cb47beb197f53330ea12c/gcc%2Fconfig%2Fnetbsd-elf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnetbsd-elf.h?ref=152a5a9c947ff82ced5cb47beb197f53330ea12c", "patch": "@@ -53,7 +53,9 @@ Boston, MA 02111-1307, USA.  */\n        %{p:gcrt0%O%s}\t\t\\\n        %{!p:crt0%O%s}}}\t\t\\\n    %:if-exists(crti%O%s)\t\\\n-   %{!shared:crtbegin%O%s} %{shared:crtbeginS%O%s}\"\n+   %{static:%:if-exists-else(crtbeginT%O%s crtbegin%O%s)} \\\n+   %{!static: \\\n+     %{!shared:crtbegin%O%s} %{shared:crtbeginS%O%s}}\"\n \n #undef STARTFILE_SPEC\n #define STARTFILE_SPEC NETBSD_STARTFILE_SPEC"}, {"sha": "79579b9175e75d4e04745011dead3fd18488e467", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/152a5a9c947ff82ced5cb47beb197f53330ea12c/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/152a5a9c947ff82ced5cb47beb197f53330ea12c/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=152a5a9c947ff82ced5cb47beb197f53330ea12c", "patch": "@@ -4986,7 +4986,20 @@ pathname.  Here is a small example of its usage:\n *startfile:\n crt0%O%s %:if-exists(crti%O%s) crtbegin%O%s\n @end smallexample\n-@end table\n+\n+@item @code{if-exists-else}\n+The @code{if-exists-else} spec function is similar to the @code{if-exists}\n+spec function, except that it takes two arguments.  The first argument is\n+an absolute pathname to a file.  If the file exists, @code{if-exists-else}\n+returns the pathname.  If it does not exist, it returns the second argument.\n+This way, @code{if-exists-else} can be used to select one file or another,\n+based on the existence of the first.  Here is a small example of its usage:\n+\n+@smallexample \n+*startfile:\n+crt0%O%s %:if-exists(crti%O%s) %:if-exists-else(crtbeginT%O%s crtbegin%O%s)\n+@end smallexample\n+@end table \n \n @item %@{@code{S}@}\n Substitutes the @code{-S} switch, if that switch was given to GCC@."}, {"sha": "d7ec1260f800e44ba83e5f9e35fa92195ef9ff80", "filename": "gcc/gcc.c", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/152a5a9c947ff82ced5cb47beb197f53330ea12c/gcc%2Fgcc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/152a5a9c947ff82ced5cb47beb197f53330ea12c/gcc%2Fgcc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc.c?ref=152a5a9c947ff82ced5cb47beb197f53330ea12c", "patch": "@@ -328,6 +328,7 @@ static const char *convert_filename\tPARAMS ((const char *, int, int));\n #endif\n \n static const char *if_exists_spec_function PARAMS ((int, const char **));\n+static const char *if_exists_else_spec_function PARAMS ((int, const char **));\n \f\n /* The Specs Language\n \n@@ -1451,6 +1452,7 @@ static struct spec_list *specs = (struct spec_list *) 0;\n static const struct spec_function static_spec_functions[] =\n {\n   { \"if-exists\",\t\tif_exists_spec_function },\n+  { \"if-exists-else\",\t\tif_exists_else_spec_function },\n   { 0, 0 }\n };\n \n@@ -7264,3 +7266,23 @@ if_exists_spec_function (argc, argv)\n \n   return NULL;\n }\n+\n+/* if-exists-else built-in spec function.\n+\n+   This is like if-exists, but takes an additional argument which\n+   is returned if the first argument does not exist.  */\n+\n+static const char *\n+if_exists_else_spec_function (argc, argv)\n+     int argc;\n+     const char **argv;\n+{\n+  /* Must have exactly two arguments.  */\n+  if (argc != 2)\n+    return NULL;\n+\n+  if (IS_ABSOLUTE_PATHNAME (argv[0]) && ! access (argv[0], R_OK))\n+    return argv[0];\n+\n+  return argv[1];\n+}"}]}