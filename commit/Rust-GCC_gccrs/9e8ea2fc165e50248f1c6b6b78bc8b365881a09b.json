{"sha": "9e8ea2fc165e50248f1c6b6b78bc8b365881a09b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWU4ZWEyZmMxNjVlNTAyNDhmMWM2YjZiNzhiYzhiMzY1ODgxYTA5Yg==", "commit": {"author": {"name": "Andreas Krebbel", "email": "krebbel@linux.vnet.ibm.com", "date": "2015-05-19T17:21:56Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2015-05-19T17:21:56Z"}, "message": "S/390: Make shift_count_or_setmem_operand predicate to check for mode.\n\ngcc/\n\t* config/s390/predicates.md (shift_count_or_setmem_operand):\n        Add mode check to make sure that only scalar integer values\n        are accepted.\n\nFrom-SVN: r223392", "tree": {"sha": "311837b1d7fcfd9d544fec01cae33a954145f29f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/311837b1d7fcfd9d544fec01cae33a954145f29f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b/comments", "author": null, "committer": null, "parents": [{"sha": "872d5034baa1007606d405e37937908602fbbe51", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/872d5034baa1007606d405e37937908602fbbe51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/872d5034baa1007606d405e37937908602fbbe51"}], "stats": {"total": 12, "additions": 11, "deletions": 1}, "files": [{"sha": "dea95c19f8873241388e98423d2ac814f72db310", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9e8ea2fc165e50248f1c6b6b78bc8b365881a09b", "patch": "@@ -1,3 +1,9 @@\n+2015-05-19  Andreas Krebbel  <krebbel@linux.vnet.ibm.com>\n+\n+\t* config/s390/predicates.md (shift_count_or_setmem_operand): Add\n+\tmode check to make sure that only scalar integer values are\n+\taccepted.\n+\n 2015-05-19  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* tree.c (verify_type_variant): Fix #undef."}, {"sha": "90758b14896dc17aec7ebd72637c65c6ab405224", "filename": "gcc/config/s390/predicates.md", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b/gcc%2Fconfig%2Fs390%2Fpredicates.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9e8ea2fc165e50248f1c6b6b78bc8b365881a09b/gcc%2Fconfig%2Fs390%2Fpredicates.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fpredicates.md?ref=9e8ea2fc165e50248f1c6b6b78bc8b365881a09b", "patch": "@@ -75,14 +75,18 @@\n        (and (match_test \"mode == Pmode\")\n \t    (match_test \"!legitimate_la_operand_p (op)\"))))\n \n-;; Return true if OP is a valid operand as shift count or setmem.\n+;; Return true if OP is a valid operand as scalar shift count or setmem.\n \n (define_predicate \"shift_count_or_setmem_operand\"\n   (match_code \"reg, subreg, plus, const_int\")\n {\n   HOST_WIDE_INT offset;\n   rtx base;\n \n+  if (GET_MODE (op) != VOIDmode\n+      && GET_MODE_CLASS (GET_MODE (op)) != MODE_INT)\n+    return false;\n+\n   /* Extract base register and offset.  */\n   if (!s390_decompose_shift_count (op, &base, &offset))\n     return false;"}]}