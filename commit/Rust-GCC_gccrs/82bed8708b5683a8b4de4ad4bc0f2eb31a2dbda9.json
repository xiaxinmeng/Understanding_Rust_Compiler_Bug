{"sha": "82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODJiZWQ4NzA4YjU2ODNhOGI0ZGU0YWQ0YmMwZjJlYjMxYTJkYmRhOQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "1999-04-11T18:48:27Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "1999-04-11T18:48:27Z"}, "message": "friend.c (add_friend): Deal gracefully with error_mark_node.\n\n\t* friend.c (add_friend): Deal gracefully with error_mark_node.\n\t* method.c (build_overload_value): Handle pointers-to-members as\n\ttemplate parameters.\n\nFrom-SVN: r26351", "tree": {"sha": "e40a5a4230b6f1a24d2e45c91caac2b7cf27e931", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e40a5a4230b6f1a24d2e45c91caac2b7cf27e931"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/comments", "author": null, "committer": null, "parents": [{"sha": "391cdef0565eab9385be36eab55be03d4fe46a6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/391cdef0565eab9385be36eab55be03d4fe46a6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/391cdef0565eab9385be36eab55be03d4fe46a6b"}], "stats": {"total": 54, "additions": 51, "deletions": 3}, "files": [{"sha": "be8c8653ad9e7fbb8b416b96176523d9359cd145", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "patch": "@@ -1,5 +1,9 @@\n 1999-04-11  Mark Mitchell  <mark@codesourcery.com>\n \n+\t* friend.c (add_friend): Deal gracefully with error_mark_node.\n+\t* method.c (build_overload_value): Handle pointers-to-members as\n+\ttemplate parameters.\n+\n \t* decl.c (push_binding): Fix typo in comment.\n \n 1999-04-10  Mark Mitchell  <mark@codesourcery.com>"}, {"sha": "48b566a943a0d7d542a581c9089cbe80f5a91dc6", "filename": "gcc/cp/friend.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Fcp%2Ffriend.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Fcp%2Ffriend.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ffriend.c?ref=82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "patch": "@@ -141,10 +141,16 @@ void\n add_friend (type, decl)\n      tree type, decl;\n {\n-  tree typedecl = TYPE_MAIN_DECL (type);\n-  tree list = DECL_FRIENDLIST (typedecl);\n-  tree name = DECL_NAME (decl);\n+  tree typedecl;\n+  tree list;\n+  tree name;\n+\n+  if (decl == error_mark_node)\n+    return;\n \n+  typedecl = TYPE_MAIN_DECL (type);\n+  list = DECL_FRIENDLIST (typedecl);\n+  name = DECL_NAME (decl);\n   type = TREE_TYPE (typedecl);\n \n   while (list)"}, {"sha": "82d216822d040d5adf7737499500f1a452203dd3", "filename": "gcc/cp/method.c", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Fcp%2Fmethod.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Fcp%2Fmethod.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmethod.c?ref=82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "patch": "@@ -858,6 +858,22 @@ build_overload_value (type, value, in_template)\n \ttree delta2;\n \n \tmy_friendly_assert (TYPE_PTRMEMFUNC_P (type), 0);\n+\n+\t/* We'll get a ADDR_EXPR of a SCOPE_REF here if we're\n+\t   mangling, an instantiation of something like:\n+\n+\t     template <class T, void (T::*fp)()> class C {};\n+\t     template <class T> C<T, &T::f> x();  \n+\t\n+\t   We mangle the return type of the function, and that\n+\t   contains template parameters.  */\n+\tif (TREE_CODE (value) == ADDR_EXPR\n+\t    && TREE_CODE (TREE_OPERAND (value, 0)) == SCOPE_REF)\n+\t  {\n+\t    build_overload_scope_ref (TREE_OPERAND (value, 0));\n+\t    break;\n+\t  }\n+\n \tmy_friendly_assert (TREE_CODE (value) == PTRMEM_CST, 0);\n \n \texpand_ptrmemfunc_cst (value, &delta, &idx, &pfn, &delta2);"}, {"sha": "c2325bffa8adf972d45332515c1d77613483651c", "filename": "gcc/testsuite/g++.old-deja/g++.pt/crash37.C", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash37.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash37.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Fcrash37.C?ref=82bed8708b5683a8b4de4ad4bc0f2eb31a2dbda9", "patch": "@@ -0,0 +1,22 @@\n+// Build don't link:\n+// Origin: Jens Maurer <jmaurer@menuett.rhein-main.de>\n+\n+template<class T, void (T::*f)(int)>\n+class C { };\n+\n+template<class T>\n+C<T, &T::output> call(T& obj)\n+{   \treturn C<T, &T::output>();\n+}\n+\n+class Test {\n+public:\n+\tvoid output(int);\n+};\n+\n+void sub()\n+{\n+\tTest t;\n+\tcall(t);\n+}\n+"}]}