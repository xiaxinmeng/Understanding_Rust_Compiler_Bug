{"sha": "5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc", "node_id": "C_kwDOANBUbNoAKDU5NDBiNGU1OWY4ZTE5OGRiZjdlOGI3MzM1NjFlZjcyYTliYTJjYmM", "commit": {"author": {"name": "Antoni Boucher", "email": "bouanto@zoho.com", "date": "2022-06-10T01:37:23Z"}, "committer": {"name": "Antoni Boucher", "email": "bouanto@zoho.com", "date": "2022-06-10T01:50:25Z"}, "message": "libgccjit: Support getting the size of a float [PR105829]\n\n2022-06-09  Antoni Boucher  <bouanto@zoho.com>\n\ngcc/jit/\n\tPR jit/105829\n\t* libgccjit.cc: Add support for floating-point types in\n\tgcc_jit_type_get_size.\n\ngcc/testsuite/\n\tPR jit/105829\n\t* jit.dg/test-types.c: Add tests for gcc_jit_type_get_size.", "tree": {"sha": "687d8436b82fc8df2733b89222011f59f27d5827", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/687d8436b82fc8df2733b89222011f59f27d5827"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc/comments", "author": {"login": "antoyo", "id": 584972, "node_id": "MDQ6VXNlcjU4NDk3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/584972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antoyo", "html_url": "https://github.com/antoyo", "followers_url": "https://api.github.com/users/antoyo/followers", "following_url": "https://api.github.com/users/antoyo/following{/other_user}", "gists_url": "https://api.github.com/users/antoyo/gists{/gist_id}", "starred_url": "https://api.github.com/users/antoyo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antoyo/subscriptions", "organizations_url": "https://api.github.com/users/antoyo/orgs", "repos_url": "https://api.github.com/users/antoyo/repos", "events_url": "https://api.github.com/users/antoyo/events{/privacy}", "received_events_url": "https://api.github.com/users/antoyo/received_events", "type": "User", "site_admin": false}, "committer": {"login": "antoyo", "id": 584972, "node_id": "MDQ6VXNlcjU4NDk3Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/584972?v=4", "gravatar_id": "", "url": "https://api.github.com/users/antoyo", "html_url": "https://github.com/antoyo", "followers_url": "https://api.github.com/users/antoyo/followers", "following_url": "https://api.github.com/users/antoyo/following{/other_user}", "gists_url": "https://api.github.com/users/antoyo/gists{/gist_id}", "starred_url": "https://api.github.com/users/antoyo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/antoyo/subscriptions", "organizations_url": "https://api.github.com/users/antoyo/orgs", "repos_url": "https://api.github.com/users/antoyo/repos", "events_url": "https://api.github.com/users/antoyo/events{/privacy}", "received_events_url": "https://api.github.com/users/antoyo/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e3bba42fb5d64d2b49a9cd3511f8f57e36d46dfe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3bba42fb5d64d2b49a9cd3511f8f57e36d46dfe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3bba42fb5d64d2b49a9cd3511f8f57e36d46dfe"}], "stats": {"total": 7, "additions": 5, "deletions": 2}, "files": [{"sha": "0e76097b4bac10620a1ee4a4229f285868cbe8a8", "filename": "gcc/jit/libgccjit.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc/gcc%2Fjit%2Flibgccjit.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc/gcc%2Fjit%2Flibgccjit.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjit%2Flibgccjit.cc?ref=5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc", "patch": "@@ -545,8 +545,8 @@ gcc_jit_type_get_size (gcc_jit_type *type)\n {\n   RETURN_VAL_IF_FAIL (type, -1, NULL, NULL, \"NULL type\");\n   RETURN_VAL_IF_FAIL\n-    (type->is_int (), -1, NULL, NULL,\n-     \"only getting the size of an integer type is supported for now\");\n+    (type->is_int () || type->is_float (), -1, NULL, NULL,\n+     \"only getting the size of integer or floating-point types is supported for now\");\n   return type->get_size ();\n }\n "}, {"sha": "a01944e35fa7bf0c2c4dd7a2857209f4c27a7725", "filename": "gcc/testsuite/jit.dg/test-types.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc/gcc%2Ftestsuite%2Fjit.dg%2Ftest-types.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc/gcc%2Ftestsuite%2Fjit.dg%2Ftest-types.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fjit.dg%2Ftest-types.c?ref=5940b4e59f8e198dbf7e8b733561ef72a9ba2cbc", "patch": "@@ -489,4 +489,7 @@ verify_code (gcc_jit_context *ctxt, gcc_jit_result *result)\n     CHECK (gcc_jit_compatible_types (\n       gcc_jit_context_get_type (ctxt, GCC_JIT_TYPE_LONG),\n       gcc_jit_context_get_type (ctxt, GCC_JIT_TYPE_INT64_T)));\n+\n+  CHECK_VALUE (gcc_jit_type_get_size (gcc_jit_context_get_type (ctxt, GCC_JIT_TYPE_FLOAT)), sizeof (float));\n+  CHECK_VALUE (gcc_jit_type_get_size (gcc_jit_context_get_type (ctxt, GCC_JIT_TYPE_DOUBLE)), sizeof (double));\n }"}]}