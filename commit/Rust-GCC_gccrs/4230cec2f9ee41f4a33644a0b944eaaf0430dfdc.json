{"sha": "4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDIzMGNlYzJmOWVlNDFmNGEzMzY0NGEwYjk0NGVhYWYwNDMwZGZkYw==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2005-02-14T13:45:42Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2005-02-14T13:45:42Z"}, "message": "re PR c++/19884 (ICE on explicit instantiation of a non-template constructor)\n\ncp:\n\tPR c++/19884\n\t* pt.c (check_explicit_specialization): Make sure namespace\n\tbinding lookup found an overloaded function.\n\t(lookup_template_function): Just assert FNS is an overloaded\n\tfunction.\n\n\tPR c++/19895\n\t* decl.c (grokdeclarator): Check for error mark node in ptrmem\n\tconstruction.\ntestsuite:\n\tPR c++/19895\n\t* g++.dg/parse/ptrmem3.C: New.\n\n\tPR c++/19884\n\t* g++.old-deja/g++.oliva/template6.C: Add another case.\n\t* g++.dg/template/explicit6.C: New.\n\nFrom-SVN: r95009", "tree": {"sha": "6f729b6a58b61f7a435734962f2683174fe5b755", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6f729b6a58b61f7a435734962f2683174fe5b755"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/comments", "author": null, "committer": null, "parents": [{"sha": "d1fc3bbd80a4d4dff957b9eeb5ae463f3e8f55b1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1fc3bbd80a4d4dff957b9eeb5ae463f3e8f55b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d1fc3bbd80a4d4dff957b9eeb5ae463f3e8f55b1"}], "stats": {"total": 68, "additions": 55, "deletions": 13}, "files": [{"sha": "add1476e0d86c36d7a388c7db8752f16fbb65260", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "patch": "@@ -1,10 +1,22 @@\n+2005-02-14  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/19884\n+\t* pt.c (check_explicit_specialization): Make sure namespace\n+\tbinding lookup found an overloaded function.\n+\t(lookup_template_function): Just assert FNS is an overloaded\n+\tfunction.\n+\n+\tPR c++/19895\n+\t* decl.c (grokdeclarator): Check for error mark node in ptrmem\n+\tconstruction.\n+\n 2005-02-14  Alexandre Oliva  <aoliva@redhat.com>\n \n \tPR c++/17816\n \t* decl.c (redeclaration_error_message): Report redefinition of\n \tpure virtual function.\n \n-2005-02-11  Nathan Sidwell  <nathan@codesourcery.com>\n+2005-02-14  Nathan Sidwell  <nathan@codesourcery.com>\n \n \tPR c++/19891\n \t* class.c (build_simple_base_path): Build the component_ref"}, {"sha": "48f8d8c55fdd3e3545c0c2500d526b14817ac2f5", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "patch": "@@ -7348,6 +7348,9 @@ grokdeclarator (const cp_declarator *declarator,\n \t\t\t declarator->u.pointer.class_type);\n \t\t  type = build_pointer_type (type);\n \t\t}\n+\t      else if (declarator->u.pointer.class_type == error_mark_node)\n+\t\t/* We will already have complained.  */\n+\t\ttype = error_mark_node;\n \t      else\n \t\ttype = build_ptrmem_type (declarator->u.pointer.class_type,\n \t\t\t\t\t  type);"}, {"sha": "7025deff7887d8d5696343593fc99a44fba20c40", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 7, "deletions": 11, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "patch": "@@ -1883,6 +1883,11 @@ check_explicit_specialization (tree declarator,\n \t      /* Find the namespace binding, using the declaration\n                  context.  */\n \t      fns = namespace_binding (dname, CP_DECL_CONTEXT (decl));\n+\t      if (!fns || !is_overloaded_fn (fns))\n+\t\t{\n+\t\t  error (\"%qD is not a template function\", dname);\n+\t\t  fns = error_mark_node;\n+\t\t}\n \t    }\n \n \t  declarator = lookup_template_function (fns, NULL_TREE);\n@@ -4196,17 +4201,8 @@ lookup_template_function (tree fns, tree arglist)\n     return error_mark_node;\n \n   gcc_assert (!arglist || TREE_CODE (arglist) == TREE_VEC);\n-  if (fns == NULL_TREE \n-      || TREE_CODE (fns) == FUNCTION_DECL)\n-    {\n-      error (\"non-template used as template\");\n-      return error_mark_node;\n-    }\n-\n-  gcc_assert (TREE_CODE (fns) == TEMPLATE_DECL\n-\t      || TREE_CODE (fns) == OVERLOAD\n-\t      || BASELINK_P (fns)\n-\t      || TREE_CODE (fns) == IDENTIFIER_NODE);\n+  gcc_assert (fns && (is_overloaded_fn (fns)\n+\t\t      || TREE_CODE (fns) == IDENTIFIER_NODE));\n \n   if (BASELINK_P (fns))\n     {"}, {"sha": "61fef177c4188536e3a1de25cb6b6bf0ffe85ebd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "patch": "@@ -1,3 +1,12 @@\n+2005-02-14  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/19895\n+\t* g++.dg/parse/ptrmem3.C: New.\n+\n+\tPR c++/19884\n+\t* g++.old-deja/g++.oliva/template6.C: Add another case.\n+\t* g++.dg/template/explicit6.C: New.\n+\n 2005-02-14  Alexandre Oliva  <aoliva@redhat.com>\n \n \tPR c++/17816"}, {"sha": "444f25cd2eadd6015ef3d88316344c4bce66a260", "filename": "gcc/testsuite/g++.dg/parse/ptrmem3.C", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fptrmem3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fptrmem3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Fptrmem3.C?ref=4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "patch": "@@ -0,0 +1,11 @@\n+// Copyright (C) 2005 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 14 Feb 2005 <nathan@codesourcery.com>\n+\n+// Origin: Volker Reichelt <reichelt@gcc.gnu.org>\n+// Bug 19895: ICE on invalid\n+\n+\n+template<typename> struct A\n+{\n+  int A<0>::* p; // { dg-error \"(type/value mismatch)|(expected)\" \"\" }\n+};"}, {"sha": "f740269bb749e65315b9c1c3d94cb177c838c424", "filename": "gcc/testsuite/g++.dg/template/explicit6.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fexplicit6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fexplicit6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fexplicit6.C?ref=4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "patch": "@@ -0,0 +1,8 @@\n+// Copyright (C) 2005 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 14 Feb 2005 <nathan@codesourcery.com>\n+\n+// Origin: Volker Reichelt <reichelt@gcc.gnu.org>\n+// Bug 19895: ICE on invalid\n+\n+struct A;\n+template A<>::A(); // { dg-error \"(not a template)|(explicit qualification)\" \"\" }"}, {"sha": "270d67695f64670db04c8d274e226834bc9497c6", "filename": "gcc/testsuite/g++.old-deja/g++.oliva/template6.C", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.oliva%2Ftemplate6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4230cec2f9ee41f4a33644a0b944eaaf0430dfdc/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.oliva%2Ftemplate6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.oliva%2Ftemplate6.C?ref=4230cec2f9ee41f4a33644a0b944eaaf0430dfdc", "patch": "@@ -6,4 +6,7 @@\n // simplified from bug report by Meenaradchagan Vishnu <mvishnu@fore.com>\n \n template <typename> struct foo {};\n-template <> void foo(); // { dg-error \"\" } bad specialization\n+template <> void foo(); // { dg-error \"not a template function\" } bad specialization\n+\n+struct baz {};\n+template <> void baz (); // { dg-error \"not a template function\" } bad specialization"}]}