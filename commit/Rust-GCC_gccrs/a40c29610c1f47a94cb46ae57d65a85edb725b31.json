{"sha": "a40c29610c1f47a94cb46ae57d65a85edb725b31", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQwYzI5NjEwYzFmNDdhOTRjYjQ2YWU1N2Q2NWE4NWVkYjcyNWIzMQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2003-12-03T23:04:23Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2003-12-03T23:04:23Z"}, "message": "re PR rtl-optimization/12324 ([unit-at-a-time] not emitting function referenced from a compound statement)\n\n\tPR optimization/12324\n\t* toplev.c  (rest_of_decl_compilation): Do not deffer when compiling\n\tin unit-at-a-time mode.\n\nFrom-SVN: r74252", "tree": {"sha": "416df826773b53b3601236b5e995a747b7e4a23f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/416df826773b53b3601236b5e995a747b7e4a23f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a40c29610c1f47a94cb46ae57d65a85edb725b31", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a40c29610c1f47a94cb46ae57d65a85edb725b31", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a40c29610c1f47a94cb46ae57d65a85edb725b31", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a40c29610c1f47a94cb46ae57d65a85edb725b31/comments", "author": null, "committer": null, "parents": [{"sha": "8ecc63eb275e8f67a25c1606abb6ae7231ae724f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ecc63eb275e8f67a25c1606abb6ae7231ae724f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ecc63eb275e8f67a25c1606abb6ae7231ae724f"}], "stats": {"total": 17, "additions": 15, "deletions": 2}, "files": [{"sha": "d951c37b83f731ac6c5fc338663577c144d013cf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a40c29610c1f47a94cb46ae57d65a85edb725b31/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a40c29610c1f47a94cb46ae57d65a85edb725b31/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a40c29610c1f47a94cb46ae57d65a85edb725b31", "patch": "@@ -1,3 +1,9 @@\n+2003-12-03  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR optimization/12324\n+\t* toplev.c  (rest_of_decl_compilation): Do not deffer when compiling\n+\tin unit-at-a-time mode.\n+\n 2003-12-03  Jakub Jelinek  <jakub@redhat.com>\n \n \t* expr.c (store_constructor): Only set RTX_UNCHANGING_P for"}, {"sha": "47cdc73c7922e24e8d8699ad68eea77ed408f2c9", "filename": "gcc/toplev.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a40c29610c1f47a94cb46ae57d65a85edb725b31/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a40c29610c1f47a94cb46ae57d65a85edb725b31/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=a40c29610c1f47a94cb46ae57d65a85edb725b31", "patch": "@@ -1920,8 +1920,15 @@ rest_of_decl_compilation (tree decl,\n \tmake_decl_rtl (decl, asmspec);\n \n       /* Don't output anything when a tentative file-scope definition\n-\t is seen.  But at end of compilation, do output code for them.  */\n-      if ((at_end || !DECL_DEFER_OUTPUT (decl)) && !DECL_EXTERNAL (decl))\n+\t is seen.  But at end of compilation, do output code for them.\n+\n+\t We do output all variables when unit-at-a-time is active and rely on\n+\t callgraph code to defer them except for forward declarations\n+\t (see gcc.c-torture/compile/920624-1.c) */\n+      if ((at_end\n+\t   || !DECL_DEFER_OUTPUT (decl)\n+\t   || (flag_unit_at_a_time && DECL_INITIAL (decl)))\n+\t  && !DECL_EXTERNAL (decl))\n \t{\n \t  if (flag_unit_at_a_time && !cgraph_global_info_ready\n \t      && TREE_CODE (decl) != FUNCTION_DECL && top_level)"}]}