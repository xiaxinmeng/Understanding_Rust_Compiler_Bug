{"sha": "2f4006f8c77a20332c70e43d34bc0308405620c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmY0MDA2ZjhjNzdhMjAzMzJjNzBlNDNkMzRiYzAzMDg0MDU2MjBjMg==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2002-01-17T16:04:21Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2002-01-17T16:04:21Z"}, "message": "Makefile.am (EXTRA_DIST): Add Darwin and AIX files.\n\n        * Makefile.am (EXTRA_DIST): Add Darwin and AIX files.\n        (TARGET_SRC_POWERPC_AIX): New.\n        (POWERPC_AIX): New stanza.\n        * Makefile.in: Regenerate.\n        * configure.in: Add AIX case.\n        * configure: Regenerate.\n        * include/ffi.h.in (ffi_abi): Add FFI_AIX.\n        * src/powerpc/ffi_darwin.c (ffi_status): Use \"long\" to scale frame\n        size.  Fix \"long double\" support.\n        (ffi_call): Add FFI_AIX case.\n        * src/powerpc/aix.S: New.\n\nFrom-SVN: r48956", "tree": {"sha": "31a08ca08821cff1bd464db9f21ab0be03ae388a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/31a08ca08821cff1bd464db9f21ab0be03ae388a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f4006f8c77a20332c70e43d34bc0308405620c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f4006f8c77a20332c70e43d34bc0308405620c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f4006f8c77a20332c70e43d34bc0308405620c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f4006f8c77a20332c70e43d34bc0308405620c2/comments", "author": null, "committer": null, "parents": [{"sha": "2bcb0aa08196a5a16accb58cdd8d18cecd7ae0f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2bcb0aa08196a5a16accb58cdd8d18cecd7ae0f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2bcb0aa08196a5a16accb58cdd8d18cecd7ae0f6"}], "stats": {"total": 439, "additions": 359, "deletions": 80}, "files": [{"sha": "2d0d4382aa298cd4de4843d3b7cc6b56835c10c5", "filename": "libffi/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -1,3 +1,17 @@\n+2002-01-17  David Edelsohn  <edelsohn@gnu.org>\n+\n+\t* Makefile.am (EXTRA_DIST): Add Darwin and AIX files.\n+\t(TARGET_SRC_POWERPC_AIX): New.\n+\t(POWERPC_AIX): New stanza.\n+\t* Makefile.in: Regenerate.\n+\t* configure.in: Add AIX case.\n+\t* configure: Regenerate.\n+\t* include/ffi.h.in (ffi_abi): Add FFI_AIX.\n+\t* src/powerpc/ffi_darwin.c (ffi_status): Use \"long\" to scale frame\n+\tsize.  Fix \"long double\" support.\n+\t(ffi_call): Add FFI_AIX case.\n+\t* src/powerpc/aix.S: New.\n+\n 2001-10-09  John Hornkvist  <john@toastedmarshmallow.com>\n \n \tImplement Darwin PowerPC ABI."}, {"sha": "04cc125e5959f9f1a6afaacb95a61f84ef2e3ce9", "filename": "libffi/Makefile.am", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.am?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -11,7 +11,9 @@ EXTRA_DIST = LICENSE ChangeLog.v1 src/mips/ffi.c src/mips/n32.S \\\n \t\tsrc/alpha/ffi.c src/alpha/osf.S \\\n \t\tsrc/m68k/ffi.c src/m68k/sysv.S \\\n \t\tsrc/powerpc/ffi.c src/powerpc/sysv.S \\\n-                src/powerpc/ppc_closure.S src/powerpc/asm.h \\\n+\t\tsrc/powerpc/ppc_closure.S src/powerpc/asm.h \\\n+\t\tsrc/powerpc/ffi_darwin.c \\\n+\t\tsrc/powerpc/darwin.S src/powerpc/aix.S \\\n \t\tsrc/arm/ffi.c src/arm/sysv.S\n \n VPATH = @srcdir@:@srcdir@/src:@srcdir@/src/@TARGETDIR@\n@@ -97,6 +99,7 @@ TARGET_SRC_ALPHA = src/alpha/ffi.c src/alpha/osf.S\n TARGET_SRC_IA64 = src/ia64/ffi.c src/ia64/unix.S\n TARGET_SRC_M68K = src/m68k/ffi.c src/m68k/sysv.S\n TARGET_SRC_POWERPC = src/powerpc/ffi.c src/powerpc/sysv.S src/powerpc/ppc_closure.S\n+TARGET_SRC_POWERPC_AIX = src/powerpc/ffi_darwin.c src/powerpc/aix.S\n TARGET_SRC_POWERPC_DARWIN = src/powerpc/ffi_darwin.c src/powerpc/darwin.S\n TARGET_SRC_ARM =  src/arm/sysv.S src/arm/ffi.c\n \n@@ -140,6 +143,10 @@ if POWERPC\n libffi_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC)\n libfficonvenience_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC)\n endif\n+if POWERPC_AIX\n+libffi_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_AIX)\n+libfficonvenience_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_AIX)\n+endif\n if POWERPC_DARWIN\n libffi_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_DARWIN)\n libfficonvenience_la_SOURCES = $(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_DARWIN)"}, {"sha": "17d8d43944b6b1dcd614142f808709dcd4310336", "filename": "libffi/Makefile.in", "status": "modified", "additions": 14, "deletions": 2, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FMakefile.in?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -1,6 +1,6 @@\n # Makefile.in generated automatically by automake 1.4 from Makefile.am\n \n-# Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.\n+# Copyright (C) 1994, 1995-8, 1999, 2001, 2002 Free Software Foundation, Inc.\n # This Makefile.in is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n@@ -92,7 +92,9 @@ EXTRA_DIST = LICENSE ChangeLog.v1 src/mips/ffi.c src/mips/n32.S \\\n \t\tsrc/alpha/ffi.c src/alpha/osf.S \\\n \t\tsrc/m68k/ffi.c src/m68k/sysv.S \\\n \t\tsrc/powerpc/ffi.c src/powerpc/sysv.S \\\n-                src/powerpc/ppc_closure.S src/powerpc/asm.h \\\n+\t\tsrc/powerpc/ppc_closure.S src/powerpc/asm.h \\\n+\t\tsrc/powerpc/ffi_darwin.c \\\n+\t\tsrc/powerpc/darwin.S src/powerpc/aix.S \\\n \t\tsrc/arm/ffi.c src/arm/sysv.S\n \n \n@@ -168,6 +170,7 @@ TARGET_SRC_ALPHA = src/alpha/ffi.c src/alpha/osf.S\n TARGET_SRC_IA64 = src/ia64/ffi.c src/ia64/unix.S\n TARGET_SRC_M68K = src/m68k/ffi.c src/m68k/sysv.S\n TARGET_SRC_POWERPC = src/powerpc/ffi.c src/powerpc/sysv.S src/powerpc/ppc_closure.S\n+TARGET_SRC_POWERPC_AIX = src/powerpc/ffi_darwin.c src/powerpc/aix.S\n TARGET_SRC_POWERPC_DARWIN = src/powerpc/ffi_darwin.c src/powerpc/darwin.S\n TARGET_SRC_ARM = src/arm/sysv.S src/arm/ffi.c\n \n@@ -183,6 +186,7 @@ libffi_la_common_SOURCES = src/debug.c src/prep_cif.c src/types.c \\\n @IA64_TRUE@libffi_la_SOURCES = @IA64_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_IA64)\n @M68K_TRUE@libffi_la_SOURCES = @M68K_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_M68K)\n @POWERPC_TRUE@libffi_la_SOURCES = @POWERPC_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC)\n+@POWERPC_AIX_TRUE@libffi_la_SOURCES = @POWERPC_AIX_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_AIX)\n @POWERPC_DARWIN_TRUE@libffi_la_SOURCES = @POWERPC_DARWIN_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_DARWIN)\n @ARM_TRUE@libffi_la_SOURCES = @ARM_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_ARM)\n @MIPS_GCC_TRUE@libfficonvenience_la_SOURCES = @MIPS_GCC_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_MIPS_GCC)\n@@ -194,6 +198,7 @@ libffi_la_common_SOURCES = src/debug.c src/prep_cif.c src/types.c \\\n @IA64_TRUE@libfficonvenience_la_SOURCES = @IA64_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_IA64)\n @M68K_TRUE@libfficonvenience_la_SOURCES = @M68K_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_M68K)\n @POWERPC_TRUE@libfficonvenience_la_SOURCES = @POWERPC_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC)\n+@POWERPC_AIX_TRUE@libfficonvenience_la_SOURCES = @POWERPC_AIX_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_AIX)\n @POWERPC_DARWIN_TRUE@libfficonvenience_la_SOURCES = @POWERPC_DARWIN_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_POWERPC_DARWIN)\n @ARM_TRUE@libfficonvenience_la_SOURCES = @ARM_TRUE@$(libffi_la_common_SOURCES) $(TARGET_SRC_ARM)\n \n@@ -244,6 +249,10 @@ libfficonvenience_la_LIBADD =\n @IA64_TRUE@libfficonvenience_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n @IA64_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n @IA64_TRUE@src/ia64/ffi.lo src/ia64/unix.lo\n+@POWERPC_AIX_TRUE@libfficonvenience_la_OBJECTS =  src/debug.lo \\\n+@POWERPC_AIX_TRUE@src/prep_cif.lo src/types.lo src/raw_api.lo \\\n+@POWERPC_AIX_TRUE@src/java_raw_api.lo src/powerpc/ffi_darwin.lo \\\n+@POWERPC_AIX_TRUE@src/powerpc/aix.lo\n @POWERPC_DARWIN_TRUE@libfficonvenience_la_OBJECTS =  src/debug.lo \\\n @POWERPC_DARWIN_TRUE@src/prep_cif.lo src/types.lo src/raw_api.lo \\\n @POWERPC_DARWIN_TRUE@src/java_raw_api.lo src/powerpc/ffi_darwin.lo \\\n@@ -281,6 +290,9 @@ libffi_la_LIBADD =\n @IA64_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n @IA64_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n @IA64_TRUE@src/ia64/ffi.lo src/ia64/unix.lo\n+@POWERPC_AIX_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n+@POWERPC_AIX_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n+@POWERPC_AIX_TRUE@src/powerpc/ffi_darwin.lo src/powerpc/aix.lo\n @POWERPC_DARWIN_TRUE@libffi_la_OBJECTS =  src/debug.lo src/prep_cif.lo \\\n @POWERPC_DARWIN_TRUE@src/types.lo src/raw_api.lo src/java_raw_api.lo \\\n @POWERPC_DARWIN_TRUE@src/powerpc/ffi_darwin.lo src/powerpc/darwin.lo"}, {"sha": "f367f2e795becf5cae59dd225b7e3dab10519cb9", "filename": "libffi/configure", "status": "modified", "additions": 75, "deletions": 62, "changes": 137, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fconfigure?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -2382,6 +2382,8 @@ m68k-*-linux*) TARGET=M68K; TARGETDIR=m68k;;\n powerpc-*-linux* | powerpc-*-sysv*) TARGET=POWERPC; TARGETDIR=powerpc;;\n powerpc-*-beos*) TARGET=POWERPC; TARGETDIR=powerpc;;\n powerpc-*-darwin*) TARGET=POWERPC_DARWIN; TARGETDIR=powerpc;;\n+powerpc-*-aix*) TARGET=POWERPC_AIX; TARGETDIR=powerpc;;\n+rs6000-*-aix*) TARGET=POWERPC_AIX; TARGETDIR=powerpc;;\n arm*-*-linux-*) TARGET=ARM; TARGETDIR=arm;;\n esac\n \n@@ -2472,6 +2474,15 @@ else\n fi\n \n \n+if test x$TARGET = xPOWERPC_AIX; then\n+  POWERPC_AIX_TRUE=\n+  POWERPC_AIX_FALSE='#'\n+else\n+  POWERPC_AIX_TRUE='#'\n+  POWERPC_AIX_FALSE=\n+fi\n+\n+\n if test x$TARGET = xPOWERPC_DARWIN; then\n   POWERPC_DARWIN_TRUE=\n   POWERPC_DARWIN_FALSE='#'\n@@ -2490,7 +2501,7 @@ else\n fi\n \n echo $ac_n \"checking how to run the C preprocessor\"\"... $ac_c\" 1>&6\n-echo \"configure:2494: checking how to run the C preprocessor\" >&5\n+echo \"configure:2505: checking how to run the C preprocessor\" >&5\n # On Suns, sometimes $CPP names a directory.\n if test -n \"$CPP\" && test -d \"$CPP\"; then\n   CPP=\n@@ -2505,13 +2516,13 @@ else\n   # On the NeXT, cc -E runs the code through the compiler's parser,\n   # not just through cpp.\n   cat > conftest.$ac_ext <<EOF\n-#line 2509 \"configure\"\n+#line 2520 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2515: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2526: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -2522,13 +2533,13 @@ else\n   rm -rf conftest*\n   CPP=\"${CC-cc} -E -traditional-cpp\"\n   cat > conftest.$ac_ext <<EOF\n-#line 2526 \"configure\"\n+#line 2537 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2532: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2543: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -2539,13 +2550,13 @@ else\n   rm -rf conftest*\n   CPP=\"${CC-cc} -nologo -E\"\n   cat > conftest.$ac_ext <<EOF\n-#line 2543 \"configure\"\n+#line 2554 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2549: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2560: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -2570,20 +2581,20 @@ fi\n echo \"$ac_t\"\"$CPP\" 1>&6\n \n echo $ac_n \"checking for ANSI C header files\"\"... $ac_c\" 1>&6\n-echo \"configure:2574: checking for ANSI C header files\" >&5\n+echo \"configure:2585: checking for ANSI C header files\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_stdc'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2579 \"configure\"\n+#line 2590 \"configure\"\n #include \"confdefs.h\"\n #include <stdlib.h>\n #include <stdarg.h>\n #include <string.h>\n #include <float.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2587: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2598: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -2600,7 +2611,7 @@ rm -f conftest*\n if test $ac_cv_header_stdc = yes; then\n   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.\n cat > conftest.$ac_ext <<EOF\n-#line 2604 \"configure\"\n+#line 2615 \"configure\"\n #include \"confdefs.h\"\n #include <string.h>\n EOF\n@@ -2618,7 +2629,7 @@ fi\n if test $ac_cv_header_stdc = yes; then\n   # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.\n cat > conftest.$ac_ext <<EOF\n-#line 2622 \"configure\"\n+#line 2633 \"configure\"\n #include \"confdefs.h\"\n #include <stdlib.h>\n EOF\n@@ -2639,7 +2650,7 @@ if test \"$cross_compiling\" = yes; then\n   :\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2643 \"configure\"\n+#line 2654 \"configure\"\n #include \"confdefs.h\"\n #include <ctype.h>\n #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')\n@@ -2650,7 +2661,7 @@ if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);\n exit (0); }\n \n EOF\n-if { (eval echo configure:2654: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2665: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   :\n else\n@@ -2676,12 +2687,12 @@ fi\n for ac_func in memcpy\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:2680: checking for $ac_func\" >&5\n+echo \"configure:2691: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2685 \"configure\"\n+#line 2696 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -2704,7 +2715,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2708: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2719: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -2731,19 +2742,19 @@ done\n # The Ultrix 4.2 mips builtin alloca declared by alloca.h only works\n # for constant arguments.  Useless!\n echo $ac_n \"checking for working alloca.h\"\"... $ac_c\" 1>&6\n-echo \"configure:2735: checking for working alloca.h\" >&5\n+echo \"configure:2746: checking for working alloca.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_alloca_h'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2740 \"configure\"\n+#line 2751 \"configure\"\n #include \"confdefs.h\"\n #include <alloca.h>\n int main() {\n char *p = alloca(2 * sizeof(int));\n ; return 0; }\n EOF\n-if { (eval echo configure:2747: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2758: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_header_alloca_h=yes\n else\n@@ -2764,12 +2775,12 @@ EOF\n fi\n \n echo $ac_n \"checking for alloca\"\"... $ac_c\" 1>&6\n-echo \"configure:2768: checking for alloca\" >&5\n+echo \"configure:2779: checking for alloca\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_alloca_works'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2773 \"configure\"\n+#line 2784 \"configure\"\n #include \"confdefs.h\"\n \n #ifdef __GNUC__\n@@ -2797,7 +2808,7 @@ int main() {\n char *p = (char *) alloca(1);\n ; return 0; }\n EOF\n-if { (eval echo configure:2801: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2812: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_func_alloca_works=yes\n else\n@@ -2829,12 +2840,12 @@ EOF\n \n \n echo $ac_n \"checking whether alloca needs Cray hooks\"\"... $ac_c\" 1>&6\n-echo \"configure:2833: checking whether alloca needs Cray hooks\" >&5\n+echo \"configure:2844: checking whether alloca needs Cray hooks\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_os_cray'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2838 \"configure\"\n+#line 2849 \"configure\"\n #include \"confdefs.h\"\n #if defined(CRAY) && ! defined(CRAY2)\n webecray\n@@ -2859,12 +2870,12 @@ echo \"$ac_t\"\"$ac_cv_os_cray\" 1>&6\n if test $ac_cv_os_cray = yes; then\n for ac_func in _getb67 GETB67 getb67; do\n   echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:2863: checking for $ac_func\" >&5\n+echo \"configure:2874: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2868 \"configure\"\n+#line 2879 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -2887,7 +2898,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2891: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2902: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -2914,15 +2925,15 @@ done\n fi\n \n echo $ac_n \"checking stack direction for C alloca\"\"... $ac_c\" 1>&6\n-echo \"configure:2918: checking stack direction for C alloca\" >&5\n+echo \"configure:2929: checking stack direction for C alloca\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_stack_direction'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n   ac_cv_c_stack_direction=0\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2926 \"configure\"\n+#line 2937 \"configure\"\n #include \"confdefs.h\"\n find_stack_direction ()\n {\n@@ -2941,7 +2952,7 @@ main ()\n   exit (find_stack_direction() < 0);\n }\n EOF\n-if { (eval echo configure:2945: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2956: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_c_stack_direction=1\n else\n@@ -2964,15 +2975,15 @@ fi\n \n \n echo $ac_n \"checking size of short\"\"... $ac_c\" 1>&6\n-echo \"configure:2968: checking size of short\" >&5\n+echo \"configure:2979: checking size of short\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_short'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2976 \"configure\"\n+#line 2987 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -2983,7 +2994,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:2987: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2998: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_short=`cat conftestval`\n else\n@@ -3003,15 +3014,15 @@ EOF\n \n \n echo $ac_n \"checking size of int\"\"... $ac_c\" 1>&6\n-echo \"configure:3007: checking size of int\" >&5\n+echo \"configure:3018: checking size of int\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_int'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3015 \"configure\"\n+#line 3026 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3022,7 +3033,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3026: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3037: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_int=`cat conftestval`\n else\n@@ -3042,15 +3053,15 @@ EOF\n \n \n echo $ac_n \"checking size of long\"\"... $ac_c\" 1>&6\n-echo \"configure:3046: checking size of long\" >&5\n+echo \"configure:3057: checking size of long\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_long'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3054 \"configure\"\n+#line 3065 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3061,7 +3072,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3065: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3076: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_long=`cat conftestval`\n else\n@@ -3081,15 +3092,15 @@ EOF\n \n \n echo $ac_n \"checking size of long long\"\"... $ac_c\" 1>&6\n-echo \"configure:3085: checking size of long long\" >&5\n+echo \"configure:3096: checking size of long long\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_long_long'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3093 \"configure\"\n+#line 3104 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3100,7 +3111,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3104: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3115: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_long_long=`cat conftestval`\n else\n@@ -3120,15 +3131,15 @@ EOF\n \n \n echo $ac_n \"checking size of float\"\"... $ac_c\" 1>&6\n-echo \"configure:3124: checking size of float\" >&5\n+echo \"configure:3135: checking size of float\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_float'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3132 \"configure\"\n+#line 3143 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3139,7 +3150,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3143: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3154: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_float=`cat conftestval`\n else\n@@ -3159,15 +3170,15 @@ EOF\n \n \n echo $ac_n \"checking size of double\"\"... $ac_c\" 1>&6\n-echo \"configure:3163: checking size of double\" >&5\n+echo \"configure:3174: checking size of double\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_double'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3171 \"configure\"\n+#line 3182 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3178,7 +3189,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3182: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3193: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_double=`cat conftestval`\n else\n@@ -3198,15 +3209,15 @@ EOF\n \n \n echo $ac_n \"checking size of long double\"\"... $ac_c\" 1>&6\n-echo \"configure:3202: checking size of long double\" >&5\n+echo \"configure:3213: checking size of long double\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_long_double'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3210 \"configure\"\n+#line 3221 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3217,7 +3228,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3221: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3232: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_long_double=`cat conftestval`\n else\n@@ -3238,15 +3249,15 @@ EOF\n \n \n echo $ac_n \"checking size of void *\"\"... $ac_c\" 1>&6\n-echo \"configure:3242: checking size of void *\" >&5\n+echo \"configure:3253: checking size of void *\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_sizeof_void_p'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3250 \"configure\"\n+#line 3261 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n main()\n@@ -3257,7 +3268,7 @@ main()\n   exit(0);\n }\n EOF\n-if { (eval echo configure:3261: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3272: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_sizeof_void_p=`cat conftestval`\n else\n@@ -3277,14 +3288,14 @@ EOF\n \n \n echo $ac_n \"checking whether byte ordering is bigendian\"\"... $ac_c\" 1>&6\n-echo \"configure:3281: checking whether byte ordering is bigendian\" >&5\n+echo \"configure:3292: checking whether byte ordering is bigendian\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_bigendian'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_cv_c_bigendian=unknown\n # See if sys/param.h defines the BYTE_ORDER macro.\n cat > conftest.$ac_ext <<EOF\n-#line 3288 \"configure\"\n+#line 3299 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <sys/param.h>\n@@ -3295,11 +3306,11 @@ int main() {\n #endif\n ; return 0; }\n EOF\n-if { (eval echo configure:3299: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3310: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   # It does; now see whether it defined to BIG_ENDIAN or not.\n cat > conftest.$ac_ext <<EOF\n-#line 3303 \"configure\"\n+#line 3314 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <sys/param.h>\n@@ -3310,7 +3321,7 @@ int main() {\n #endif\n ; return 0; }\n EOF\n-if { (eval echo configure:3314: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3325: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_c_bigendian=yes\n else\n@@ -3330,7 +3341,7 @@ if test \"$cross_compiling\" = yes; then\n     { echo \"configure: error: can not run test program while cross compiling\" 1>&2; exit 1; }\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3334 \"configure\"\n+#line 3345 \"configure\"\n #include \"confdefs.h\"\n main () {\n   /* Are we little or big endian?  From Harbison&Steele.  */\n@@ -3343,7 +3354,7 @@ main () {\n   exit (u.c[sizeof (long) - 1] == 1);\n }\n EOF\n-if { (eval echo configure:3347: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:3358: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_c_bigendian=no\n else\n@@ -3619,6 +3630,8 @@ s%@M68K_TRUE@%$M68K_TRUE%g\n s%@M68K_FALSE@%$M68K_FALSE%g\n s%@POWERPC_TRUE@%$POWERPC_TRUE%g\n s%@POWERPC_FALSE@%$POWERPC_FALSE%g\n+s%@POWERPC_AIX_TRUE@%$POWERPC_AIX_TRUE%g\n+s%@POWERPC_AIX_FALSE@%$POWERPC_AIX_FALSE%g\n s%@POWERPC_DARWIN_TRUE@%$POWERPC_DARWIN_TRUE%g\n s%@POWERPC_DARWIN_FALSE@%$POWERPC_DARWIN_FALSE%g\n s%@ARM_TRUE@%$ARM_TRUE%g"}, {"sha": "645b040320703e331c39cb181fc42d0dd2c7edf9", "filename": "libffi/configure.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fconfigure.in?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -57,6 +57,8 @@ m68k-*-linux*) TARGET=M68K; TARGETDIR=m68k;;\n powerpc-*-linux* | powerpc-*-sysv*) TARGET=POWERPC; TARGETDIR=powerpc;;\n powerpc-*-beos*) TARGET=POWERPC; TARGETDIR=powerpc;;\n powerpc-*-darwin*) TARGET=POWERPC_DARWIN; TARGETDIR=powerpc;;\n+powerpc-*-aix*) TARGET=POWERPC_AIX; TARGETDIR=powerpc;;\n+rs6000-*-aix*) TARGET=POWERPC_AIX; TARGETDIR=powerpc;;\n arm*-*-linux-*) TARGET=ARM; TARGETDIR=arm;;\n esac\n \n@@ -73,6 +75,7 @@ AM_CONDITIONAL(ALPHA, test x$TARGET = xALPHA)\n AM_CONDITIONAL(IA64, test x$TARGET = xIA64)\n AM_CONDITIONAL(M68K, test x$TARGET = xM68K)\n AM_CONDITIONAL(POWERPC, test x$TARGET = xPOWERPC)\n+AM_CONDITIONAL(POWERPC_AIX, test x$TARGET = xPOWERPC_AIX)\n AM_CONDITIONAL(POWERPC_DARWIN, test x$TARGET = xPOWERPC_DARWIN)\n AM_CONDITIONAL(ARM, test x$TARGET = xARM)\n "}, {"sha": "bcb999abe03a3efda40953b6ae2f90f0c67c9ad9", "filename": "libffi/include/ffi.h.in", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Finclude%2Fffi.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Finclude%2Fffi.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Finclude%2Fffi.h.in?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -1,5 +1,5 @@\n /* -----------------------------------------------------------------*-C-*-\n-   libffi @VERSION@ - Copyright (c) 1996-1999  Cygnus Solutions\n+   libffi @VERSION@ - Copyright (c) 1996-2002  Cygnus Solutions\n \n    Permission is hereby granted, free of charge, to any person obtaining\n    a copy of this software and associated documentation files (the\n@@ -233,7 +233,14 @@ typedef enum ffi_abi {\n   FFI_DEFAULT_ABI = FFI_GCC_SYSV,\n #endif\n \n+#ifdef POWERPC_AIX\n+  FFI_AIX,\n+  FFI_DARWIN,\n+  FFI_DEFAULT_ABI = FFI_AIX,\n+#endif\n+\n #ifdef POWERPC_DARWIN\n+  FFI_AIX,\n   FFI_DARWIN,\n   FFI_DEFAULT_ABI = FFI_DARWIN,\n #endif"}, {"sha": "a0a6598175dc49d0ca28c2246e965d3c9d9deb0c", "filename": "libffi/src/powerpc/aix.S", "status": "added", "additions": 209, "deletions": 0, "changes": 209, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fsrc%2Fpowerpc%2Faix.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fsrc%2Fpowerpc%2Faix.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fpowerpc%2Faix.S?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -0,0 +1,209 @@\n+/* -----------------------------------------------------------------------\n+   aix.S - Copyright (c) 2002 Free Software Foundation, Inc.\n+   based on darwin.S by John Hornkvist\n+   \n+   PowerPC Assembly glue.\n+\n+   Permission is hereby granted, free of charge, to any person obtaining\n+   a copy of this software and associated documentation files (the\n+   ``Software''), to deal in the Software without restriction, including\n+   without limitation the rights to use, copy, modify, merge, publish,\n+   distribute, sublicense, and/or sell copies of the Software, and to\n+   permit persons to whom the Software is furnished to do so, subject to\n+   the following conditions:\n+\n+   The above copyright notice and this permission notice shall be included\n+   in all copies or substantial portions of the Software.\n+\n+   THE SOFTWARE IS PROVIDED ``AS IS'', WITHOUT WARRANTY OF ANY KIND, EXPRESS\n+   OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n+   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n+   IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY CLAIM, DAMAGES OR\n+   OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n+   ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n+   OTHER DEALINGS IN THE SOFTWARE.\n+   ----------------------------------------------------------------------- */\n+\n+        .set r0,0\n+        .set r1,1\n+        .set r2,2\n+        .set r3,3\n+        .set r4,4\n+        .set r5,5\n+        .set r6,6\n+        .set r7,7\n+        .set r8,8\n+        .set r9,9\n+        .set r10,10\n+        .set r11,11\n+        .set r12,12\n+        .set r13,13\n+        .set r14,14\n+        .set r15,15\n+        .set r16,16\n+        .set r17,17\n+        .set r18,18\n+        .set r19,19\n+        .set r20,20\n+        .set r21,21\n+        .set r22,22\n+        .set r23,23\n+        .set r24,24\n+        .set r25,25\n+        .set r26,26\n+        .set r27,27\n+        .set r28,28\n+        .set r29,29\n+        .set r30,30\n+        .set r31,31\n+        .set f0,0\n+        .set f1,1\n+        .set f2,2\n+        .set f3,3\n+        .set f4,4\n+        .set f5,5\n+        .set f6,6\n+        .set f7,7\n+        .set f8,8\n+        .set f9,9\n+        .set f10,10\n+        .set f11,11\n+        .set f12,12\n+        .set f13,13\n+        .set f14,14\n+        .set f15,15\n+        .set f16,16\n+        .set f17,17\n+        .set f18,18\n+        .set f19,19\n+        .set f20,20\n+        .set f21,21\n+\n+#define LIBFFI_ASM\t\n+#include <ffi.h>\n+#define JUMPTARGET(name) name\n+#define L(x) x\n+\t.file \"aix.S\"\n+\t.toc\n+\t.csect .text[PR]\n+\t.align 2\n+.globl ffi_prep_args\n+\n+.csect .text[PR]\n+\t.align 2\n+\t.globl ffi_call_AIX\n+\t.globl .ffi_call_AIX\n+.csect ffi_call_AIX[DS]\n+ffi_call_AIX:\n+\t.long .ffi_call_AIX, TOC[tc0], 0\n+\t.csect .text[PR]\n+.ffi_call_AIX:\n+\tmr      r12,r8 // We only need r12 until the call, so it doesn't have to be saved...\n+\t/* Save the old stack pointer as AP.  */\n+\tmr\tr8,r1\n+\n+\t/* Allocate the stack space we need.  */\n+\tstwux\tr1,r1,r4\t\n+\n+\t/* Save registers we use.  */\n+\tmflr\tr9\n+\n+\tstw\tr28,-16(r8)\n+\tstw\tr29,-12(r8)\n+\tstw\tr30, -8(r8)\n+\tstw\tr31, -4(r8)\n+\n+\tstw\tr9,  8(r8)\n+\tstw\tr2, 20(r1)\n+\n+\t/* Save arguments over call...  */\n+\tmr\tr31,r5\t/* flags, */\n+\tmr\tr30,r6\t/* rvalue, */\n+\tmr\tr29,r7\t/* function address, */\n+\tmr\tr28,r8\t/* our AP. */\n+\t\t\n+\t/* Call ffi_prep_args.  */\n+\tmr\tr4,r1\n+\tli\tr9,0\n+\n+\tlwz\tr2,4(r12)\n+\tlwz\tr12,0(r12)\n+\tmtctr\tr12 // r12 holds address of _ffi_prep_args\n+\tbctrl \n+\tlwz     r2,20(r1)\n+\n+\t/* Now do the call.  */\n+\tlwz\tr12,0(r29)\n+\t/* Set up cr1 with bits 4-7 of the flags.  */\n+\tmtcrf\t0x40,r31\n+\tstw\tr2,20(r1)\n+\tmtctr\tr12\n+\tlwz\tr2,4(r29)\n+\t/* Load all those argument registers.  */\n+        // We have set up a nice stack frame, just load it into registers.\n+        lwz     r3, 20+(1*4)(r1)\n+        lwz     r4, 20+(2*4)(r1)\n+        lwz     r5, 20+(3*4)(r1)\n+        lwz     r6, 20+(4*4)(r1)\n+        nop\n+\tlwz     r7, 20+(5*4)(r1)\n+        lwz     r8, 20+(6*4)(r1)\n+        lwz     r9, 20+(7*4)(r1)\n+        lwz     r10,20+(8*4)(r1)\n+\n+L1:\n+\t/* Load all the FP registers.  */\n+\tbf\t6,L2 // 2f + 0x18\n+\tlfd\tf1,-16-(13*8)(r28)\n+\tlfd\tf2,-16-(12*8)(r28)\n+\tlfd\tf3,-16-(11*8)(r28)\n+\tlfd\tf4,-16-(10*8)(r28)\n+\tnop\n+\tlfd\tf5,-16-(9*8)(r28)\n+\tlfd\tf6,-16-(8*8)(r28)\n+\tlfd\tf7,-16-(7*8)(r28)\n+\tlfd\tf8,-16-(6*8)(r28)\n+\tnop\n+\tlfd     f9,-16-(5*8)(r28)\n+        lfd     f10,-16-(4*8)(r28)\n+\tlfd     f11,-16-(3*8)(r28)\n+\tlfd     f12,-16-(2*8)(r28)\n+\tnop\n+\tlfd     f13,-16-(1*8)(r28)\n+\n+L2:\t\n+\t/* Make the call.  */\n+\tbctrl\n+\tlwz r2,20(r1)\n+        \n+\t/* Now, deal with the return value.  */\n+\tmtcrf\t0x01,r31\n+\n+\tbt\t30,L(done_return_value)\n+\tbt\t29,L(fp_return_value)\n+\tstw\tr3,0(r30)\n+\tbf\t28,L(done_return_value)\n+\tstw\tr4,4(r30)\n+\n+\t/* Fall through...  */\n+\n+L(done_return_value):\n+\t/* Restore the registers we used and return.  */\n+\tlwz\tr9,   8(r28)\n+\tlwz\tr31,  -4(r28)\n+\tmtlr\tr9\n+\tlwz\tr30, -8(r28)\n+\tlwz\tr29,-12(r28)\n+\tlwz\tr28,-16(r28)\n+\tlwz\tr1,0(r1)\n+\tblr\n+\n+L(fp_return_value):\n+\tbf\t28,L(float_return_value)\n+\tstfd\tf1,0(r30)\n+\tb\tL(done_return_value)\n+L(float_return_value):\n+\tstfs\tf1,0(r30)\n+\tb\tL(done_return_value)\n+//END(ffi_call_AIX)\n+"}, {"sha": "d4a986dbbd3c3da2b20c572be0f5a2309aac6039", "filename": "libffi/src/powerpc/ffi_darwin.c", "status": "modified", "additions": 28, "deletions": 14, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fsrc%2Fpowerpc%2Fffi_darwin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f4006f8c77a20332c70e43d34bc0308405620c2/libffi%2Fsrc%2Fpowerpc%2Fffi_darwin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fpowerpc%2Fffi_darwin.c?ref=2f4006f8c77a20332c70e43d34bc0308405620c2", "patch": "@@ -4,8 +4,9 @@\n    PowerPC Foreign Function Interface \n \n    Darwin ABI support (c) 2001 John Hornkvist\n+   AIX ABI support (c) 2002 Free Software Foundation, Inc.\n \n-   $Id: ffi.c,v 1.1.1.1 1998/11/29 16:48:16 green Exp $\n+   $Id: ffi_darwin.c,v 1.1 2002/01/16 05:32:15 bryce Exp $\n \n    Permission is hereby granted, free of charge, to any person obtaining\n    a copy of this software and associated documentation files (the\n@@ -202,18 +203,24 @@ ffi_status ffi_prep_cif_machdep(ffi_cif *cif)\n   /* Space for the frame pointer, callee's LR, CR, etc, and for \n      the asm's temp regs.  */\n \n-  bytes = (6 + ASM_NEEDS_REGISTERS) * sizeof(int);\n+  bytes = (6 + ASM_NEEDS_REGISTERS) * sizeof(long);\n \n   /* Return value handling.  The rules are as follows:\n      - 32-bit (or less) integer values are returned in gpr3;\n      - Structures of size <= 4 bytes also returned in gpr3;\n      - 64-bit integer values and structures between 5 and 8 bytes are returned\n        in gpr3 and gpr4;\n      - Single/double FP values are returned in fpr1;\n-     - Larger structures and long double (if not equivalent to double) values\n-       are allocated space and a pointer is passed as the first argument.  */\n+     - Long double FP (if not equivalent to double) values are returned in\n+       fpr1 and fpr2;\n+     - Larger structures values are allocated space and a pointer is passed\n+       as the first argument.  */\n   switch (cif->rtype->type)\n     {\n+#if FFI_TYPE_LONGDOUBLE != FFI_TYPE_DOUBLE\n+    case FFI_TYPE_LONGDOUBLE:\n+#endif\n+      /* Fall through.  */\n     case FFI_TYPE_DOUBLE:\n       flags |= FLAG_RETURNS_64BITS;\n       /* Fall through.  */\n@@ -227,10 +234,6 @@ ffi_status ffi_prep_cif_machdep(ffi_cif *cif)\n       break;\n \n     case FFI_TYPE_STRUCT:\n-      /* Fall through.  */\n-#if FFI_TYPE_LONGDOUBLE != FFI_TYPE_DOUBLE\n-    case FFI_TYPE_LONGDOUBLE:\n-#endif\n       flags |= FLAG_RETVAL_REFERENCE;\n       flags |= FLAG_RETURNS_NOTHING;\n       intarg_count++;\n@@ -301,9 +304,9 @@ ffi_status ffi_prep_cif_machdep(ffi_cif *cif)\n \n   /* Stack space.  */\n   if ((intarg_count + 2 * fparg_count) > NUM_GPR_ARG_REGISTERS)\n-    bytes += (intarg_count + 2 * fparg_count) * sizeof(int);\n+    bytes += (intarg_count + 2 * fparg_count) * sizeof(long);\n   else\n-    bytes += NUM_GPR_ARG_REGISTERS * sizeof(int);\n+    bytes += NUM_GPR_ARG_REGISTERS * sizeof(long);\n \n   /* The stack space allocated needs to be a multiple of 16 bytes.  */\n   bytes = (bytes + 15) & ~0xF;\n@@ -316,11 +319,16 @@ ffi_status ffi_prep_cif_machdep(ffi_cif *cif)\n \n /*@-declundef@*/\n /*@-exportheader@*/\n+extern void ffi_call_AIX(/*@out@*/ extended_cif *, \n+\t\t\t unsigned, unsigned, \n+\t\t\t /*@out@*/ unsigned *, \n+\t\t\t void (*fn)(),\n+\t\t\t void (*fn2)());\n extern void ffi_call_DARWIN(/*@out@*/ extended_cif *, \n-\t\t\t  unsigned, unsigned, \n-\t\t\t  /*@out@*/ unsigned *, \n+\t\t\t    unsigned, unsigned, \n+\t\t\t    /*@out@*/ unsigned *, \n \t\t\t    void (*fn)(),\n-\t\t\t  void (*fn2)());\n+\t\t\t    void (*fn2)());\n /*@=declundef@*/\n /*@=exportheader@*/\n \n@@ -349,10 +357,16 @@ void ffi_call(/*@dependent@*/ ffi_cif *cif,\n     \n   switch (cif->abi) \n     {\n+    case FFI_AIX:\n+      /*@-usedef@*/\n+      ffi_call_AIX(&ecif, -cif->bytes, \n+\t\t   cif->flags, ecif.rvalue, fn, ffi_prep_args);\n+      /*@=usedef@*/\n+      break;\n     case FFI_DARWIN:\n       /*@-usedef@*/\n       ffi_call_DARWIN(&ecif, -cif->bytes, \n-\t\t    cif->flags, ecif.rvalue, fn, ffi_prep_args);\n+\t\t      cif->flags, ecif.rvalue, fn, ffi_prep_args);\n       /*@=usedef@*/\n       break;\n     default:"}]}