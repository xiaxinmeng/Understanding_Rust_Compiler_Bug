{"sha": "f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjgxMmRmZThlMDlhMmZlZDY4Yzc0ZDM2ZTNjOWI5ZjFkOGQ1OWM2OA==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2019-12-10T18:31:33Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2019-12-10T18:31:33Z"}, "message": "re PR fortran/92863 (ICE in gfc_typename)\n\n2019-12-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n    PR fortran/92863\n    * misc.c (gfc_typename): If derived component is NULL for\n    derived or class, return \"invalid type\" or \"invalid class\",\n    respectively.\n\n2019-12-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n    PR fortran/92863\n    * gfortran.dg/interface_45.f90: New test.\n\nFrom-SVN: r279180", "tree": {"sha": "3392beb5db21b477dc4c4fa3aea01f631cc24f52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3392beb5db21b477dc4c4fa3aea01f631cc24f52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/comments", "author": null, "committer": null, "parents": [{"sha": "940317b75c9cc864425e8c4c1f752b2f4acbb1fc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/940317b75c9cc864425e8c4c1f752b2f4acbb1fc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/940317b75c9cc864425e8c4c1f752b2f4acbb1fc"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "b34a684a3b5092de0dcc3d9b8789f386be4d622e", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "patch": "@@ -1,3 +1,10 @@\n+2019-12-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/92863\n+\t* misc.c (gfc_typename): If derived component is NULL for\n+\tderived or class, return \"invalid type\" or \"invalid class\",\n+\trespectively.\n+\n 2019-12-10  Tobias Burnus  <tobias@codesourcery.com>\n \n \tPR fortran/92872"}, {"sha": "3ea8285f753e8dbc5fded606e4631223bcaf2085", "filename": "gcc/fortran/misc.c", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ffortran%2Fmisc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ffortran%2Fmisc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmisc.c?ref=f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "patch": "@@ -164,9 +164,19 @@ gfc_typename (gfc_typespec *ts)\n       sprintf (buffer, \"UNION(%s)\", ts->u.derived->name);\n       break;\n     case BT_DERIVED:\n+      if (ts->u.derived == NULL)\n+\t{\n+\t  sprintf (buffer, \"invalid type\");\n+\t  break;\n+\t}\n       sprintf (buffer, \"TYPE(%s)\", ts->u.derived->name);\n       break;\n     case BT_CLASS:\n+      if (ts->u.derived == NULL)\n+\t{\n+\t  sprintf (buffer, \"invalid class\");\n+\t  break;\n+\t}\n       ts1 = ts->u.derived->components ? &ts->u.derived->components->ts : NULL;\n       if (ts1 && ts1->u.derived && ts1->u.derived->attr.unlimited_polymorphic)\n \tsprintf (buffer, \"CLASS(*)\");"}, {"sha": "39e5366c366e3d8efdedaee749b47b30f5ea76fe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "patch": "@@ -1,3 +1,8 @@\n+2019-12-10  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/92863\n+\t* gfortran.dg/interface_45.f90: New test.\n+\n 2019-12-10  Richard Sandiford  <richard.sandiford@arm.com>\n \n \t* gcc.target/aarch64/sve/mixed_size_7.c: New test."}, {"sha": "095aef60186ad9afc001aae55d18084568d47863", "filename": "gcc/testsuite/gfortran.dg/interface_45.f90", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_45.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_45.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Finterface_45.f90?ref=f812dfe8e09a2fed68c74d36e3c9b9f1d8d59c68", "patch": "@@ -0,0 +1,11 @@\n+! { dg-do compile }\n+! PR 92863 - this used to ICE\n+! Test case by Arseny Solokha.\n+\n+type(l1) function mp() ! { dg-error \"type for function\" }\n+  call sub(mp) ! { dg-error \"Type mismatch\" }\n+end function mp\n+\n+function bi(ry)\n+  call sub(ry) ! { dg-error \"Type mismatch\" }\n+end function bi"}]}