{"sha": "2a2a159f7bd9d929ce457937f669ed2dd6ebccec", "node_id": "C_kwDOANBUbNoAKDJhMmExNTlmN2JkOWQ5MjljZTQ1NzkzN2Y2NjllZDJkZDZlYmNjZWM", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2023-03-08T06:57:21Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2023-03-08T06:57:21Z"}, "message": "testsuite: Adjust powerpc ppc-fortran.exp to support dg-{warning,error}\n\nAccording to Haochen's finding in [1], currently ppc-fortran.exp\ndoesn't support Fortran specific warning or error messages well.\nBy looking into it, it's due to that gfortran uses some different\nwarning/error prefixes as follows:\n\n    set gcc_warning_prefix \"\\[Ww\\]arning:\"\n    set gcc_error_prefix \"(Fatal )?\\[Ee\\]rror:\"\n\ncomparing to:\n\n    set gcc_warning_prefix \"warning:\"\n    set gcc_error_prefix \"(fatal )?error:\"\n\nSo this is to override these two prefixes and make it support\ndg-{warning,error} checks.\n\n[1] https://gcc.gnu.org/pipermail/gcc-patches/2023-March/613302.html\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.target/powerpc/ppc-fortran/ppc-fortran.exp: Override\n\tgcc_{warning,error}_prefix with Fortran specific one used in\n\tgfortran_init.", "tree": {"sha": "789b25c3d9492fdc1515835ea4f6e1f741a48b5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/789b25c3d9492fdc1515835ea4f6e1f741a48b5a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a2a159f7bd9d929ce457937f669ed2dd6ebccec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a2a159f7bd9d929ce457937f669ed2dd6ebccec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a2a159f7bd9d929ce457937f669ed2dd6ebccec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a2a159f7bd9d929ce457937f669ed2dd6ebccec/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04ff5ad0f32d6736765ad027226367939da7fd0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04ff5ad0f32d6736765ad027226367939da7fd0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04ff5ad0f32d6736765ad027226367939da7fd0f"}], "stats": {"total": 5, "additions": 5, "deletions": 0}, "files": [{"sha": "f7e99ac8487534709295954b9f035c60207013b3", "filename": "gcc/testsuite/gcc.target/powerpc/ppc-fortran/ppc-fortran.exp", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a2a159f7bd9d929ce457937f669ed2dd6ebccec/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fppc-fortran%2Fppc-fortran.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a2a159f7bd9d929ce457937f669ed2dd6ebccec/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fppc-fortran%2Fppc-fortran.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fppc-fortran%2Fppc-fortran.exp?ref=2a2a159f7bd9d929ce457937f669ed2dd6ebccec", "patch": "@@ -58,6 +58,11 @@ proc dg-compile-aux-modules { args } {\n     }\n }\n \n+# Override gcc_{warning,error}_prefix with Fortran specific prefixes used\n+# in gfortran_init to support dg-{warning,error} checks.\n+set gcc_warning_prefix \"\\[Ww\\]arning:\"\n+set gcc_error_prefix \"(Fatal )?\\[Ee\\]rror:\"\n+\n # Main loop.\n gfortran-dg-runtest [lsort \\\n        [glob -nocomplain $srcdir/$subdir/*.\\[fF\\]{,90,95,03,08} ] ] \"\" $DEFAULT_FFLAGS"}]}