{"sha": "00df7ee4474faca91d3460fe78a88e280c6c1126", "node_id": "C_kwDOANBUbNoAKDAwZGY3ZWU0NDc0ZmFjYTkxZDM0NjBmZTc4YTg4ZTI4MGM2YzExMjY", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-03-17T14:36:07Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-03-17T17:51:54Z"}, "message": "libstdc++: Avoid including <algorithm> in <filesystem> [PR92546]\n\nThis only affects Windows, but reduces the preprocessed size of\n<filesystem> significantly.\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/92546\n\t* include/bits/fs_path.h (path::make_preferred): Use\n\thandwritten loop instead of std::replace.", "tree": {"sha": "f4ebc5e6ed672e5c9a1ef614337590794c8827b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f4ebc5e6ed672e5c9a1ef614337590794c8827b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/00df7ee4474faca91d3460fe78a88e280c6c1126", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00df7ee4474faca91d3460fe78a88e280c6c1126", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00df7ee4474faca91d3460fe78a88e280c6c1126", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00df7ee4474faca91d3460fe78a88e280c6c1126/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "38ce4489635f2d65de965af3ec5d5c4adf7762d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38ce4489635f2d65de965af3ec5d5c4adf7762d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38ce4489635f2d65de965af3ec5d5c4adf7762d9"}], "stats": {"total": 9, "additions": 6, "deletions": 3}, "files": [{"sha": "9e06fa679d8a55f4099e45e112984cc2e9e333da", "filename": "libstdc++-v3/include/bits/fs_path.h", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/00df7ee4474faca91d3460fe78a88e280c6c1126/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffs_path.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/00df7ee4474faca91d3460fe78a88e280c6c1126/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffs_path.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffs_path.h?ref=00df7ee4474faca91d3460fe78a88e280c6c1126", "patch": "@@ -52,7 +52,6 @@\n \n #if defined(_WIN32) && !defined(__CYGWIN__)\n # define _GLIBCXX_FILESYSTEM_IS_WINDOWS 1\n-# include <algorithm>\n #endif\n \n namespace std _GLIBCXX_VISIBILITY(default)\n@@ -1060,8 +1059,12 @@ namespace __detail\n   path::make_preferred()\n   {\n #ifdef _GLIBCXX_FILESYSTEM_IS_WINDOWS\n-    std::replace(_M_pathname.begin(), _M_pathname.end(), L'/',\n-\t\t preferred_separator);\n+    auto __pos = _M_pathname.find(L'/');\n+    while (__pos != _M_pathname.npos)\n+      {\n+\t_M_pathname[__pos] = preferred_separator;\n+\t__pos = _M_pathname.find(L'/', __pos);\n+      }\n #endif\n     return *this;\n   }"}]}