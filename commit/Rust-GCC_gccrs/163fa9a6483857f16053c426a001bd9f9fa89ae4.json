{"sha": "163fa9a6483857f16053c426a001bd9f9fa89ae4", "node_id": "C_kwDOANBUbNoAKDE2M2ZhOWE2NDgzODU3ZjE2MDUzYzQyNmEwMDFiZDlmOWZhODlhZTQ", "commit": {"author": {"name": "Alexandre Oliva", "email": "oliva@adacore.com", "date": "2022-05-28T06:50:17Z"}, "committer": {"name": "Alexandre Oliva", "email": "oliva@gnu.org", "date": "2022-05-28T06:50:17Z"}, "message": "Rename OSCONS_CC to GCC_FOR_ADA_RTS\n\nSeveral gnatlib* targets perform, with a subshell and sed, the same\nGCC_FOR_TARGET pathname transformation that OSCONS_CC performs with\nmake subst macros.  Rename OSCONS_CC to a more general name, and use\nit for gnatlib as well.\n\n\nfor  gcc/ada/ChangeLog\n\n\t* gcc-interface/Makefile.in (OSCONS_CC): Rename to...\n\t(GCC_FOR_ADA_RTS): ... this.  Adjust users.\n\t(gnatlib): Pass it down as CC.\n\t(gnatlib-shared-default): Likewise.\n\t(gnatlib-shared-win32, gnatlib-shared-darwin): Likewise.", "tree": {"sha": "2f2b085377973e947dd743ad84aed8eca9ef7fa1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2f2b085377973e947dd743ad84aed8eca9ef7fa1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/163fa9a6483857f16053c426a001bd9f9fa89ae4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/163fa9a6483857f16053c426a001bd9f9fa89ae4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/163fa9a6483857f16053c426a001bd9f9fa89ae4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/163fa9a6483857f16053c426a001bd9f9fa89ae4/comments", "author": null, "committer": null, "parents": [{"sha": "42fd2cd932384288914174f4af7974a060972bff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/42fd2cd932384288914174f4af7974a060972bff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/42fd2cd932384288914174f4af7974a060972bff"}], "stats": {"total": 32, "additions": 12, "deletions": 20}, "files": [{"sha": "8c34f421adfc722cc4e9356bfc0590497cfa971b", "filename": "gcc/ada/gcc-interface/Makefile.in", "status": "modified", "additions": 12, "deletions": 20, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/163fa9a6483857f16053c426a001bd9f9fa89ae4/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/163fa9a6483857f16053c426a001bd9f9fa89ae4/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMakefile.in?ref=163fa9a6483857f16053c426a001bd9f9fa89ae4", "patch": "@@ -588,19 +588,19 @@ install-gnatlib: ../stamp-gnatlib-$(RTSDIR) install-gcc-specs\n \ttouch ../stamp-gnatlib1-$(RTSDIR)\n \n # GCC_FOR_TARGET has paths relative to the gcc directory, so we need to adjust\n-# for running it from ada/rts\n+# for running it from ada/rts.\n \n-OSCONS_CC=$(subst ./xgcc,../../xgcc,$(subst -B./, -B../../,$(GCC_FOR_TARGET)))\n+GCC_FOR_ADA_RTS=$(subst ./xgcc,../../xgcc,$(subst -B./, -B../../,$(GCC_FOR_TARGET)))\n \n # The main ada source directory must be on the include path for #include \"...\"\n # because s-oscons-tmplt.c requires adaint.h, gsocket.h, and any file included\n # by these headers. However note that we must use -iquote, not -I, so that\n # ada/types.h does not conflict with a same-named system header (VxWorks\n # has a <types.h> header).\n \n-OSCONS_CPP=$(OSCONS_CC) $(GNATLIBCFLAGS_FOR_C) -E -C \\\n+OSCONS_CPP=$(GCC_FOR_ADA_RTS) $(GNATLIBCFLAGS_FOR_C) -E -C \\\n   -DTARGET=\\\"$(target_noncanonical)\\\" -iquote $(fsrcpfx)ada $(fsrcpfx)ada/s-oscons-tmplt.c > s-oscons-tmplt.i\n-OSCONS_EXTRACT=$(OSCONS_CC) $(GNATLIBCFLAGS_FOR_C) -S s-oscons-tmplt.i\n+OSCONS_EXTRACT=$(GCC_FOR_ADA_RTS) $(GNATLIBCFLAGS_FOR_C) -S s-oscons-tmplt.i\n \n # Note: if you need to build with a non-GNU compiler, you could adapt the\n # following definitions (written for VMS DEC-C)\n@@ -629,17 +629,15 @@ gnatlib: ../stamp-gnatlib1-$(RTSDIR) ../stamp-gnatlib2-$(RTSDIR) $(RTSDIR)/s-osc\n \ttest -f $(RTSDIR)/s-oscons.ads || exit 1\n # C files\n \t$(MAKE) -C $(RTSDIR) \\\n-\t\tCC=\"`echo \\\"$(GCC_FOR_TARGET)\\\" \\\n-\t\t| sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'`\" \\\n+\t\tCC=\"$(GCC_FOR_ADA_RTS)\" \\\n \t        INCLUDES=\"$(INCLUDES_FOR_SUBDIR) -I./../..\" \\\n                 CFLAGS=\"$(GNATLIBCFLAGS_FOR_C)\" \\\n \t        FORCE_DEBUG_ADAFLAGS=\"$(FORCE_DEBUG_ADAFLAGS)\" \\\n \t\tsrcdir=$(fsrcdir) \\\n \t        -f ../Makefile $(LIBGNAT_OBJS) $(EXTRA_ADALIB_OBJS)\n # Ada files\n \t$(MAKE) -C $(RTSDIR) \\\n-\t\tCC=\"`echo \\\"$(GCC_FOR_TARGET)\\\" \\\n-\t\t| sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'`\" \\\n+\t\tCC=\"$(GCC_FOR_ADA_RTS)\" \\\n \t        ADA_INCLUDES=\"\" \\\n                 CFLAGS=\"$(GNATLIBCFLAGS)\" \\\n \t        ADAFLAGS=\"$(GNATLIBFLAGS)\" \\\n@@ -672,15 +670,13 @@ gnatlib-shared-default:\n \t     LN_S=\"$(LN_S)\" \\\n              gnatlib\n \t$(RM) $(RTSDIR)/libgna*$(soext)\n-\tcd $(RTSDIR); `echo \"$(GCC_FOR_TARGET)\" \\\n-                | sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'` -shared $(GNATLIBCFLAGS) \\\n+\tcd $(RTSDIR); $(GCC_FOR_ADA_RTS) -shared $(GNATLIBCFLAGS) \\\n \t\t$(PICFLAG_FOR_TARGET) \\\n \t\t-o libgnat$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(GNATRTL_NONTASKING_OBJS) $(LIBGNAT_OBJS) \\\n \t\t$(SO_OPTS)libgnat$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(MISCLIB) -lm\n-\tcd $(RTSDIR); `echo \"$(GCC_FOR_TARGET)\" \\\n-                | sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'` -shared $(GNATLIBCFLAGS) \\\n+\tcd $(RTSDIR); $(GCC_FOR_ADA_RTS) -shared $(GNATLIBCFLAGS) \\\n \t\t$(PICFLAG_FOR_TARGET) \\\n \t\t-o libgnarl$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(GNATRTL_TASKING_OBJS) \\\n@@ -764,14 +760,12 @@ gnatlib-shared-win32:\n \t$(RM) $(RTSDIR)/libgna*$(soext)\n \t$(CP) $(RTSDIR)/libgnat$(arext) $(RTSDIR)/libgnat_pic$(arext)\n \t$(CP) $(RTSDIR)/libgnarl$(arext) $(RTSDIR)/libgnarl_pic$(arext)\n-\tcd $(RTSDIR); `echo \"$(GCC_FOR_TARGET)\" \\\n-                | sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'` -shared -shared-libgcc \\\n+\tcd $(RTSDIR); $(GCC_FOR_ADA_RTS) -shared -shared-libgcc \\\n \t\t$(PICFLAG_FOR_TARGET) \\\n \t\t-o libgnat$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(GNATRTL_NONTASKING_OBJS) $(LIBGNAT_OBJS) \\\n \t\t$(SO_OPTS)libgnat$(hyphen)$(LIBRARY_VERSION)$(soext) $(MISCLIB)\n-\tcd $(RTSDIR); `echo \"$(GCC_FOR_TARGET)\" \\\n-                | sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'` -shared -shared-libgcc \\\n+\tcd $(RTSDIR); $(GCC_FOR_ADA_RTS) -shared -shared-libgcc \\\n \t\t$(PICFLAG_FOR_TARGET) \\\n \t\t-o libgnarl$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(GNATRTL_TASKING_OBJS) \\\n@@ -790,15 +784,13 @@ gnatlib-shared-darwin:\n \t$(RM) $(RTSDIR)/libgnat$(soext) $(RTSDIR)/libgnarl$(soext)\n \t$(CP) $(RTSDIR)/libgnat$(arext) $(RTSDIR)/libgnat_pic$(arext)\n \t$(CP) $(RTSDIR)/libgnarl$(arext) $(RTSDIR)/libgnarl_pic$(arext)\n-\tcd $(RTSDIR); `echo \"$(GCC_FOR_TARGET)\" \\\n-                | sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'` -dynamiclib $(PICFLAG_FOR_TARGET) \\\n+\tcd $(RTSDIR); $(GCC_FOR_ADA_RTS) -dynamiclib $(PICFLAG_FOR_TARGET) \\\n \t\t-o libgnat$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(GNATRTL_NONTASKING_OBJS) $(LIBGNAT_OBJS) \\\n \t\t$(SO_OPTS) \\\n \t\t-Wl,-install_name,@rpath/libgnat$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(MISCLIB)\n-\tcd $(RTSDIR); `echo \"$(GCC_FOR_TARGET)\" \\\n-                | sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'` -dynamiclib $(PICFLAG_FOR_TARGET) \\\n+\tcd $(RTSDIR); $(GCC_FOR_ADA_RTS) -dynamiclib $(PICFLAG_FOR_TARGET) \\\n \t\t-o libgnarl$(hyphen)$(LIBRARY_VERSION)$(soext) \\\n \t\t$(GNATRTL_TASKING_OBJS) \\\n \t\t$(SO_OPTS) \\"}]}