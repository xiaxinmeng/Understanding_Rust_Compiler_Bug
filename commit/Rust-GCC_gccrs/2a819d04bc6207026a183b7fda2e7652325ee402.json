{"sha": "2a819d04bc6207026a183b7fda2e7652325ee402", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmE4MTlkMDRiYzYyMDcwMjZhMTgzYjdmZGEyZTc2NTIzMjVlZTQwMg==", "commit": {"author": {"name": "Tom Wood", "email": "wood@gnu.org", "date": "1992-10-07T20:24:33Z"}, "committer": {"name": "Tom Wood", "email": "wood@gnu.org", "date": "1992-10-07T20:24:33Z"}, "message": "(dwarfout_{begin,end}_function): New functions.\n\n\t(body_{begin,end}_attribute): New functions.\n\t(dwarf_attr_name): Print AT_body_begin and AT_body_end.\n\t(output_{local,global}_subroutine_die): Output the new attributes.\n\nFrom-SVN: r2361", "tree": {"sha": "2ca67498f7c29317a7f9dae26f1146c012040294", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2ca67498f7c29317a7f9dae26f1146c012040294"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a819d04bc6207026a183b7fda2e7652325ee402", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a819d04bc6207026a183b7fda2e7652325ee402", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a819d04bc6207026a183b7fda2e7652325ee402", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a819d04bc6207026a183b7fda2e7652325ee402/comments", "author": null, "committer": null, "parents": [{"sha": "befb13a5878d048fecc60ae9f16018e2619b3c1a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/befb13a5878d048fecc60ae9f16018e2619b3c1a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/befb13a5878d048fecc60ae9f16018e2619b3c1a"}], "stats": {"total": 75, "additions": 69, "deletions": 6}, "files": [{"sha": "a743d51e5647d0954af403c8bd04d56b8bb818b4", "filename": "gcc/dwarfout.c", "status": "modified", "additions": 69, "deletions": 6, "changes": 75, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a819d04bc6207026a183b7fda2e7652325ee402/gcc%2Fdwarfout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a819d04bc6207026a183b7fda2e7652325ee402/gcc%2Fdwarfout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarfout.c?ref=2a819d04bc6207026a183b7fda2e7652325ee402", "patch": "@@ -532,6 +532,12 @@ static unsigned lookup_filename ();\n #ifndef SL_END_LABEL_FMT\n #define SL_END_LABEL_FMT\t\".L_sl%u_e\"\n #endif\n+#ifndef BODY_BEGIN_LABEL_FMT\n+#define BODY_BEGIN_LABEL_FMT\t\".L_b%u\"\n+#endif\n+#ifndef BODY_END_LABEL_FMT\n+#define BODY_END_LABEL_FMT\t\".L_b%u_e\"\n+#endif\n #ifndef FUNC_END_LABEL_FMT\n #define FUNC_END_LABEL_FMT\t\".L_f%u_e\"\n #endif\n@@ -888,6 +894,8 @@ dwarf_attr_name (attr)\n     case AT_src_info:\t\t\treturn \"AT_src_info\";\n     case AT_mac_info:\t\t\treturn \"AT_mac_info\";\n     case AT_src_coords:\t\t\treturn \"AT_src_coords\";\n+    case AT_body_begin:\t\t\treturn \"AT_body_begin\";\n+    case AT_body_end:\t\t\treturn \"AT_body_end\";\n \n     default:\t\t\t\treturn \"AT_<unknown>\";\n     }\n@@ -2552,6 +2560,26 @@ high_pc_attribute (asm_high_label)\n   ASM_OUTPUT_DWARF_ADDR (asm_out_file, asm_high_label);\n }\n \n+/* Generate an AT_body_begin attribute for a subroutine DIE.  */\n+\n+inline void\n+body_begin_attribute (asm_begin_label)\n+     register char *asm_begin_label;\n+{\n+  ASM_OUTPUT_DWARF_ATTRIBUTE (asm_out_file, AT_body_begin);\n+  ASM_OUTPUT_DWARF_ADDR (asm_out_file, asm_begin_label);\n+}\n+\n+/* Generate an AT_body_end attribute for a subroutine DIE.  */\n+\n+inline void\n+body_end_attribute (asm_end_label)\n+     register char *asm_end_label;\n+{\n+  ASM_OUTPUT_DWARF_ATTRIBUTE (asm_out_file, AT_body_end);\n+  ASM_OUTPUT_DWARF_ADDR (asm_out_file, asm_end_label);\n+}\n+\n /* Generate an AT_language attribute given a LANG value.  These attributes\n    are used only within TAG_compile_unit DIEs.  */\n \n@@ -3108,11 +3136,15 @@ output_global_subroutine_die (arg)\n     {\n       if (! DECL_EXTERNAL (decl))\n \t{\n-\t  char func_end_label[MAX_ARTIFICIAL_LABEL_BYTES];\n+\t  char label[MAX_ARTIFICIAL_LABEL_BYTES];\n \n \t  low_pc_attribute (IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (decl)));\n-\t  sprintf (func_end_label, FUNC_END_LABEL_FMT, current_funcdef_number);\n-\t  high_pc_attribute (func_end_label);\n+\t  sprintf (label, FUNC_END_LABEL_FMT, current_funcdef_number);\n+\t  high_pc_attribute (label);\n+\t  sprintf (label, BODY_BEGIN_LABEL_FMT, current_funcdef_number);\n+\t  body_begin_attribute (label);\n+\t  sprintf (label, BODY_END_LABEL_FMT, current_funcdef_number);\n+\t  body_end_attribute (label);\n \t}\n     }\n }\n@@ -3446,11 +3478,15 @@ output_local_subroutine_die (arg)\n \n       if (TREE_ASM_WRITTEN (decl))\n \t{\n-\t  char func_end_label[MAX_ARTIFICIAL_LABEL_BYTES];\n+\t  char label[MAX_ARTIFICIAL_LABEL_BYTES];\n \n \t  low_pc_attribute (IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (decl)));\n-\t  sprintf (func_end_label, FUNC_END_LABEL_FMT, current_funcdef_number);\n-\t  high_pc_attribute (func_end_label);\n+\t  sprintf (label, FUNC_END_LABEL_FMT, current_funcdef_number);\n+\t  high_pc_attribute (label);\n+\t  sprintf (label, BODY_BEGIN_LABEL_FMT, current_funcdef_number);\n+\t  body_begin_attribute (label);\n+\t  sprintf (label, BODY_END_LABEL_FMT, current_funcdef_number);\n+\t  body_end_attribute (label);\n \t}\n     }\n }\n@@ -4834,6 +4870,33 @@ dwarfout_label (insn)\n     }\n }\n \n+/* Output a marker (i.e. a label) for the point in the generated code where\n+   the real body of the function begins (after parameters have been moved\n+   to their home locations).  */\n+\n+void\n+dwarfout_begin_function ()\n+{\n+  char label[MAX_ARTIFICIAL_LABEL_BYTES];\n+\n+  text_section ();\n+  sprintf (label, BODY_BEGIN_LABEL_FMT, current_funcdef_number);\n+  ASM_OUTPUT_LABEL (asm_out_file, label);\n+}\n+\n+/* Output a marker (i.e. a label) for the point in the generated code where\n+   the real body of the function ends (just before the epilogue code).  */\n+\n+void\n+dwarfout_end_function ()\n+{\n+  char label[MAX_ARTIFICIAL_LABEL_BYTES];\n+\n+  text_section ();\n+  sprintf (label, BODY_END_LABEL_FMT, current_funcdef_number);\n+  ASM_OUTPUT_LABEL (asm_out_file, label);\n+}\n+\n /* Output a marker (i.e. a label) for the absolute end of the generated code\n    for a function definition.  This gets called *after* the epilogue code\n    has been generated.\t*/"}]}