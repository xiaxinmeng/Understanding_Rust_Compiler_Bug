{"sha": "49ea3702aa813f8181f4803830e0506abbd19e7a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDllYTM3MDJhYTgxM2Y4MTgxZjQ4MDM4MzBlMDUwNmFiYmQxOWU3YQ==", "commit": {"author": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2007-03-15T20:08:29Z"}, "committer": {"name": "Steven Bosscher", "email": "steven@gcc.gnu.org", "date": "2007-03-15T20:08:29Z"}, "message": "cfglayout.c (fixup_reorder_chain): Postpone deleting dead jump tables...\n\n\t* cfglayout.c (fixup_reorder_chain): Postpone deleting dead\n\tjump tables, move the call to delete_dead_jumptables from here...\n\t(cfg_layout_finalize): ...to here.  But rebuild jump labels first.\n\t* cfgrtl.c (cfg_layout_can_merge_blocks_p): When not optimizing,\n\tdon't allow merging of blocks that try_redirect_by_replacing_jump\n\talso does not handle when not optimizing.\n\nFrom-SVN: r122957", "tree": {"sha": "9b1ab29c213a2680b9ef2b4f06ef1795ab842e8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9b1ab29c213a2680b9ef2b4f06ef1795ab842e8d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/49ea3702aa813f8181f4803830e0506abbd19e7a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49ea3702aa813f8181f4803830e0506abbd19e7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49ea3702aa813f8181f4803830e0506abbd19e7a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49ea3702aa813f8181f4803830e0506abbd19e7a/comments", "author": null, "committer": null, "parents": [{"sha": "30bcc028906e873ba60715aaed036248e1420e10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30bcc028906e873ba60715aaed036248e1420e10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30bcc028906e873ba60715aaed036248e1420e10"}], "stats": {"total": 21, "additions": 17, "deletions": 4}, "files": [{"sha": "32724cc1c219a175662adb292d6e04d96af094a1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea3702aa813f8181f4803830e0506abbd19e7a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea3702aa813f8181f4803830e0506abbd19e7a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=49ea3702aa813f8181f4803830e0506abbd19e7a", "patch": "@@ -1,3 +1,13 @@\n+2007-03-15  Steven Bosscher  <steven@gcc.gnu.org>\n+\n+\tPR middle-end/31159\n+\t* cfglayout.c (fixup_reorder_chain): Postpone deleting dead\n+\tjump tables, move the call to delete_dead_jumptables from here...\n+\t(cfg_layout_finalize): ...to here.  But rebuild jump labels first.\n+\t* cfgrtl.c (cfg_layout_can_merge_blocks_p): When not optimizing,\n+\tdon't allow merging of blocks that try_redirect_by_replacing_jump\n+\talso does not handle when not optimizing.\n+\n 2007-03-15  Uros Bizjak  <ubizjak@gmail.com>\n \t    Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n "}, {"sha": "ef085fcf6d4efab244bde81a2c6652aab26567f8", "filename": "gcc/cfglayout.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea3702aa813f8181f4803830e0506abbd19e7a/gcc%2Fcfglayout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea3702aa813f8181f4803830e0506abbd19e7a/gcc%2Fcfglayout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfglayout.c?ref=49ea3702aa813f8181f4803830e0506abbd19e7a", "patch": "@@ -697,7 +697,6 @@ fixup_reorder_chain (void)\n #ifdef ENABLE_CHECKING\n   verify_insn_chain ();\n #endif\n-  delete_dead_jumptables ();\n \n   /* Now add jumps and labels as needed to match the blocks new\n      outgoing edges.  */\n@@ -1193,6 +1192,9 @@ cfg_layout_finalize (void)\n     fixup_fallthru_exit_predecessor ();\n   fixup_reorder_chain ();\n \n+  rebuild_jump_labels (get_insns ());\n+  delete_dead_jumptables ();\n+\n #ifdef ENABLE_CHECKING\n   verify_insn_chain ();\n #endif"}, {"sha": "9bc2b99a64f287fe59f8489e30552d40060c82c5", "filename": "gcc/cfgrtl.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea3702aa813f8181f4803830e0506abbd19e7a/gcc%2Fcfgrtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea3702aa813f8181f4803830e0506abbd19e7a/gcc%2Fcfgrtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgrtl.c?ref=49ea3702aa813f8181f4803830e0506abbd19e7a", "patch": "@@ -2519,10 +2519,11 @@ cfg_layout_can_merge_blocks_p (basic_block a, basic_block b)\n \t  /* Must be simple edge.  */\n \t  && !(single_succ_edge (a)->flags & EDGE_COMPLEX)\n \t  && a != ENTRY_BLOCK_PTR && b != EXIT_BLOCK_PTR\n-\t  /* If the jump insn has side effects,\n-\t     we can't kill the edge.  */\n+\t  /* If the jump insn has side effects, we can't kill the edge.\n+\t     When not optimizing, try_redirect_by_replacing_jump will\n+\t     not allow us to redirect an edge by replacing a table jump.  */\n \t  && (!JUMP_P (BB_END (a))\n-\t      || (reload_completed\n+\t      || ((!optimize || reload_completed)\n \t\t  ? simplejump_p (BB_END (a)) : onlyjump_p (BB_END (a)))));\n }\n "}]}