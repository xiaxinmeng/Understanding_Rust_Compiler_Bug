{"sha": "7d29c953afdd7232bf34cb40eaf28511692b3e77", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2QyOWM5NTNhZmRkNzIzMmJmMzRjYjQwZWFmMjg1MTE2OTJiM2U3Nw==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2011-11-08T10:27:34Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2011-11-08T10:27:34Z"}, "message": "Fix context handling of alias-declaration\n\ngcc/cp/\n\n\t* decl.c (start_decl): Update comment.\n\t* error.c (dump_alias_template_specialization): Dump the context\n\tof the specialization.\n\t* parser.c (cp_parser_alias_declaration): Call pop_scope on the\n\tpushed scope yielded by start_decl.\n\ngcc/testsuite\n\n\t* g++.dg/cpp0x/alias-decl-11.C: New test.\n\nFrom-SVN: r181152", "tree": {"sha": "ed6788aec0d242532fa9ce54ad04936c2ec78e50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ed6788aec0d242532fa9ce54ad04936c2ec78e50"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7d29c953afdd7232bf34cb40eaf28511692b3e77", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d29c953afdd7232bf34cb40eaf28511692b3e77", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d29c953afdd7232bf34cb40eaf28511692b3e77", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d29c953afdd7232bf34cb40eaf28511692b3e77/comments", "author": null, "committer": null, "parents": [{"sha": "7fcefa55251f44ce3933fd4709f23d1b83accdf8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fcefa55251f44ce3933fd4709f23d1b83accdf8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fcefa55251f44ce3933fd4709f23d1b83accdf8"}], "stats": {"total": 38, "additions": 34, "deletions": 4}, "files": [{"sha": "bcdecdf4cc36d4139f41de0293d291a472e4a059", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7d29c953afdd7232bf34cb40eaf28511692b3e77", "patch": "@@ -1,3 +1,12 @@\n+2011-11-08  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tFix context handling of alias-declaration\n+\t* decl.c (start_decl): Update comment.\n+\t* error.c (dump_alias_template_specialization): Dump the context\n+\tof the specialization.\n+\t* parser.c (cp_parser_alias_declaration): Call pop_scope on the\n+\tpushed scope yielded by start_decl.\n+\n 2011-11-08  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/50864"}, {"sha": "1c3377631106e9e5e9006b0c489f7c81d8b99b7a", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=7d29c953afdd7232bf34cb40eaf28511692b3e77", "patch": "@@ -4295,8 +4295,11 @@ groktypename (cp_decl_specifier_seq *type_specifiers,\n    deleted function, but 0 (SD_UNINITIALIZED) if this is a variable\n    implicitly initialized via a default constructor.  ATTRIBUTES and\n    PREFIX_ATTRIBUTES are GNU attributes associated with this declaration.\n-   *PUSHED_SCOPE_P is set to the scope entered in this function, if any; if\n-   set, the caller is responsible for calling pop_scope.  */\n+\n+   The scope represented by the context of the returned DECL is pushed\n+   (if it is not the global namespace) and is assigned to\n+   *PUSHED_SCOPE_P.  The caller is then responsible for calling\n+   pop_scope on *PUSHED_SCOPE_P if it is set.  */\n \n tree\n start_decl (const cp_declarator *declarator,"}, {"sha": "d2b6a62d9648a62266fd72ff9e0f3ec95bae6607", "filename": "gcc/cp/error.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=7d29c953afdd7232bf34cb40eaf28511692b3e77", "patch": "@@ -341,6 +341,8 @@ dump_alias_template_specialization (tree t, int flags)\n \n   gcc_assert (alias_template_specialization_p (t));\n \n+  if (!(flags & TFF_UNQUALIFIED_NAME))\n+    dump_scope (CP_DECL_CONTEXT (TYPE_NAME (t)), flags);\n   name = TYPE_IDENTIFIER (t);\n   pp_cxx_tree_identifier (cxx_pp, name);\n   dump_template_parms (TYPE_TEMPLATE_INFO (t),"}, {"sha": "3d3587794f2d11dc83150f16a37c6e46418f23e4", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=7d29c953afdd7232bf34cb40eaf28511692b3e77", "patch": "@@ -14891,7 +14891,7 @@ cp_parser_using_declaration (cp_parser* parser,\n static tree\n cp_parser_alias_declaration (cp_parser* parser)\n {\n-  tree id, type, decl, dummy, attributes;\n+  tree id, type, decl, pushed_scope = NULL_TREE, attributes;\n   location_t id_location;\n   cp_declarator *declarator;\n   cp_decl_specifier_seq decl_specs;\n@@ -14925,12 +14925,15 @@ cp_parser_alias_declaration (cp_parser* parser)\n \t\t      NULL_TREE, attributes);\n   else\n     decl = start_decl (declarator, &decl_specs, 0,\n-\t\t       attributes, NULL_TREE, &dummy);\n+\t\t       attributes, NULL_TREE, &pushed_scope);\n   if (decl == error_mark_node)\n     return decl;\n \n   cp_finish_decl (decl, NULL_TREE, 0, NULL_TREE, 0);\n \n+  if (pushed_scope)\n+    pop_scope (pushed_scope);\n+\n   /* If decl is a template, return its TEMPLATE_DECL so that it gets\n      added into the symbol table; otherwise, return the TYPE_DECL.  */\n   if (DECL_LANG_SPECIFIC (decl)"}, {"sha": "a62b11cbebf2c943fa45ae72f9759aad487d3906", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7d29c953afdd7232bf34cb40eaf28511692b3e77", "patch": "@@ -1,3 +1,8 @@\n+2011-11-08  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tFix context handling of alias-declaration\n+\t* g++.dg/cpp0x/alias-decl-11.C: New test.\n+\n 2011-11-08  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/50864"}, {"sha": "43ef7ba45e6465e42b649983fa38c8c8e8c9c38b", "filename": "gcc/testsuite/g++.dg/cpp0x/alias-decl-11.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Falias-decl-11.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7d29c953afdd7232bf34cb40eaf28511692b3e77/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Falias-decl-11.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Falias-decl-11.C?ref=7d29c953afdd7232bf34cb40eaf28511692b3e77", "patch": "@@ -0,0 +1,8 @@\n+// { dg-options \"-std=c++0x\" }\n+\n+namespace N\n+{\n+  template <class T> using U = T*;\n+};\n+\n+void f(N::U<int>) { blah; } // { dg-error \"void f(N::U<int>)|not declared\" }"}]}