{"sha": "d20219b5ab26cd003ae78ac9f82be337fe4df261", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDIwMjE5YjVhYjI2Y2QwMDNhZTc4YWM5ZjgyYmUzMzdmZTRkZjI2MQ==", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2020-04-23T19:59:07Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2020-04-29T07:47:34Z"}, "message": "Harden and adjust 'gcc/configure' parsing of '--enable-offload-targets'\n\nFix-up for commit d228ee80f8578be474595a517a228111fac26c5e \"re PR\nbootstrap/92314 (missing omp-device-properties', needed by\n's-omp-device-properties-h')\".\n\n\tgcc/\n\t* configure.ac <$enable_offload_targets>: Do parsing as done\n\telsewhere.\n\t* configure: Regenerate.", "tree": {"sha": "78937a8bae4f7a27d83ab1f5becf811ba6baf440", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/78937a8bae4f7a27d83ab1f5becf811ba6baf440"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d20219b5ab26cd003ae78ac9f82be337fe4df261", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d20219b5ab26cd003ae78ac9f82be337fe4df261", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d20219b5ab26cd003ae78ac9f82be337fe4df261", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d20219b5ab26cd003ae78ac9f82be337fe4df261/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b6a0ae1d22c9675f4374c2cb2b5c0833bb1461f1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6a0ae1d22c9675f4374c2cb2b5c0833bb1461f1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6a0ae1d22c9675f4374c2cb2b5c0833bb1461f1"}], "stats": {"total": 26, "additions": 18, "deletions": 8}, "files": [{"sha": "3df46e498f5795349f7dbff5bee483674df5c2df", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d20219b5ab26cd003ae78ac9f82be337fe4df261/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d20219b5ab26cd003ae78ac9f82be337fe4df261/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d20219b5ab26cd003ae78ac9f82be337fe4df261", "patch": "@@ -1,5 +1,9 @@\n 2020-04-29  Thomas Schwinge  <thomas@codesourcery.com>\n \n+\t* configure.ac <$enable_offload_targets>: Do parsing as done\n+\telsewhere.\n+\t* configure: Regenerate.\n+\n \t* configure.ac <$enable_offload_targets>: 'amdgcn' is 'gcn'.\n \t* configure: Regenerate.\n "}, {"sha": "c7bf5d1fdc6bb93c32a48161df706272eba6c4f1", "filename": "gcc/configure", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d20219b5ab26cd003ae78ac9f82be337fe4df261/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d20219b5ab26cd003ae78ac9f82be337fe4df261/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=d20219b5ab26cd003ae78ac9f82be337fe4df261", "patch": "@@ -7920,18 +7920,21 @@ for tgt in `echo $enable_offload_targets | sed 's/,/ /g'`; do\n   else\n     enable_offloading=1\n     case \"$tgt\" in\n-      *-intelmicemul-*)\n+      *-intelmic-* | *-intelmicemul-*)\n \tomp_device_property=omp-device-properties-i386\n \tomp_device_property_tmake_file=\"${omp_device_property_tmake_file} \\$(srcdir)/config/i386/t-omp-device\"\n \t;;\n-      amdgcn*-*)\n+      amdgcn*)\n \tomp_device_property=omp-device-properties-gcn\n \tomp_device_property_tmake_file=\"${omp_device_property_tmake_file} \\$(srcdir)/config/gcn/t-omp-device\"\n \t;;\n-      nvptx*-*)\n+      nvptx*)\n \tomp_device_property=omp-device-properties-nvptx\n \tomp_device_property_tmake_file=\"${omp_device_property_tmake_file} \\$(srcdir)/config/nvptx/t-omp-device\"\n \t;;\n+      *)\n+\tas_fn_error $? \"unknown offload target specified\" \"$LINENO\" 5\n+\t;;\n     esac\n     omp_device_properties=\"${omp_device_properties} ${tgt}=${omp_device_property}\"\n     omp_device_property_deps=\"${omp_device_property_deps} ${omp_device_property}\"\n@@ -18985,7 +18988,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 18988 \"configure\"\n+#line 18991 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -19091,7 +19094,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 19094 \"configure\"\n+#line 19097 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H"}, {"sha": "72f79f7ed3223024dd073219c236467d44a332aa", "filename": "gcc/configure.ac", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d20219b5ab26cd003ae78ac9f82be337fe4df261/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d20219b5ab26cd003ae78ac9f82be337fe4df261/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=d20219b5ab26cd003ae78ac9f82be337fe4df261", "patch": "@@ -1045,18 +1045,21 @@ for tgt in `echo $enable_offload_targets | sed 's/,/ /g'`; do\n   else\n     enable_offloading=1\n     case \"$tgt\" in\n-      *-intelmicemul-*)\n+      *-intelmic-* | *-intelmicemul-*)\n \tomp_device_property=omp-device-properties-i386\n \tomp_device_property_tmake_file=\"${omp_device_property_tmake_file} \\$(srcdir)/config/i386/t-omp-device\"\n \t;;\n-      amdgcn*-*)\n+      amdgcn*)\n \tomp_device_property=omp-device-properties-gcn\n \tomp_device_property_tmake_file=\"${omp_device_property_tmake_file} \\$(srcdir)/config/gcn/t-omp-device\"\n \t;;\n-      nvptx*-*)\n+      nvptx*)\n \tomp_device_property=omp-device-properties-nvptx\n \tomp_device_property_tmake_file=\"${omp_device_property_tmake_file} \\$(srcdir)/config/nvptx/t-omp-device\"\n \t;;\n+      *)\n+\tAC_MSG_ERROR([unknown offload target specified])\n+\t;;\n     esac\n     omp_device_properties=\"${omp_device_properties} ${tgt}=${omp_device_property}\"\n     omp_device_property_deps=\"${omp_device_property_deps} ${omp_device_property}\""}]}