{"sha": "0050e8620a98776c3508acd826c328e7c5023fd3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDA1MGU4NjIwYTk4Nzc2YzM1MDhhY2Q4MjZjMzI4ZTdjNTAyM2ZkMw==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@bigpond.net.au", "date": "2004-11-30T09:49:03Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2004-11-30T09:49:03Z"}, "message": "varasm.c (default_encode_section_info): Don't set SYMBOL_FLAG_SMALL on TLS symbols.\n\n\t* varasm.c (default_encode_section_info): Don't set SYMBOL_FLAG_SMALL\n\ton TLS symbols.\n\t* config/rs6000/rs6000.c (rs6000_elf_in_small_data_p): Remove TLS\n\tcheck.\n\nFrom-SVN: r91515", "tree": {"sha": "4bf5c21328c20ab2a456f4810a1fdb075a864456", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4bf5c21328c20ab2a456f4810a1fdb075a864456"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0050e8620a98776c3508acd826c328e7c5023fd3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0050e8620a98776c3508acd826c328e7c5023fd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0050e8620a98776c3508acd826c328e7c5023fd3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0050e8620a98776c3508acd826c328e7c5023fd3/comments", "author": null, "committer": null, "parents": [{"sha": "7370bebd3f4bf1725a73073c027ba13afc127f40", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7370bebd3f4bf1725a73073c027ba13afc127f40", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7370bebd3f4bf1725a73073c027ba13afc127f40"}], "stats": {"total": 15, "additions": 9, "deletions": 6}, "files": [{"sha": "510cc389b4f4bc53f9f8d2b315443d5d882e6227", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0050e8620a98776c3508acd826c328e7c5023fd3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0050e8620a98776c3508acd826c328e7c5023fd3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0050e8620a98776c3508acd826c328e7c5023fd3", "patch": "@@ -1,3 +1,10 @@\n+2004-11-30  Alan Modra  <amodra@bigpond.net.au>\n+\n+\t* varasm.c (default_encode_section_info): Don't set SYMBOL_FLAG_SMALL\n+\ton TLS symbols.\n+\t* config/rs6000/rs6000.c (rs6000_elf_in_small_data_p): Remove TLS\n+\tcheck.\n+\n 2004-11-30  Zack Weinberg  <zack@codesourcery.com>\n \n \t* gthr-gnat.c, gthr-gnat.h, gthr.h, libgcc2.h, unwind-dw2-fde.h"}, {"sha": "285996838c168a5e49b1693d136cb9b79027397b", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0050e8620a98776c3508acd826c328e7c5023fd3/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0050e8620a98776c3508acd826c328e7c5023fd3/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=0050e8620a98776c3508acd826c328e7c5023fd3", "patch": "@@ -17271,10 +17271,6 @@ rs6000_elf_in_small_data_p (tree decl)\n   if (TREE_CODE (decl) == FUNCTION_DECL)\n     return false;\n \n-  /* Thread-local vars can't go in the small data area.  */\n-  if (TREE_CODE (decl) == VAR_DECL && DECL_THREAD_LOCAL (decl))\n-    return false;\n-\n   if (TREE_CODE (decl) == VAR_DECL && DECL_SECTION_NAME (decl))\n     {\n       const char *section = TREE_STRING_POINTER (DECL_SECTION_NAME (decl));"}, {"sha": "e4fb1eee1b65b04aaa953ff048ebba49309c31cb", "filename": "gcc/varasm.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0050e8620a98776c3508acd826c328e7c5023fd3/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0050e8620a98776c3508acd826c328e7c5023fd3/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=0050e8620a98776c3508acd826c328e7c5023fd3", "patch": "@@ -5097,10 +5097,10 @@ default_encode_section_info (tree decl, rtx rtl, int first ATTRIBUTE_UNUSED)\n     flags |= SYMBOL_FLAG_FUNCTION;\n   if (targetm.binds_local_p (decl))\n     flags |= SYMBOL_FLAG_LOCAL;\n-  if (targetm.in_small_data_p (decl))\n-    flags |= SYMBOL_FLAG_SMALL;\n   if (TREE_CODE (decl) == VAR_DECL && DECL_THREAD_LOCAL (decl))\n     flags |= decl_tls_model (decl) << SYMBOL_FLAG_TLS_SHIFT;\n+  else if (targetm.in_small_data_p (decl))\n+    flags |= SYMBOL_FLAG_SMALL;\n   /* ??? Why is DECL_EXTERNAL ever set for non-PUBLIC names?  Without\n      being PUBLIC, the thing *must* be defined in this translation unit.\n      Prevent this buglet from being propagated into rtl code as well.  */"}]}