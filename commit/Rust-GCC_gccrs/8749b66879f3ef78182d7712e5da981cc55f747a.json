{"sha": "8749b66879f3ef78182d7712e5da981cc55f747a", "node_id": "C_kwDOANBUbNoAKDg3NDliNjY4NzlmM2VmNzgxODJkNzcxMmU1ZGE5ODFjYzU1Zjc0N2E", "commit": {"author": {"name": "bors[bot]", "email": "26634292+bors[bot]@users.noreply.github.com", "date": "2022-08-08T09:28:26Z"}, "committer": {"name": "GitHub", "email": "noreply@github.com", "date": "2022-08-08T09:28:26Z"}, "message": "Merge #1438\n\n1438: Enhance #1426 \"Invalid recursive :stmt expansion in fragment specifiers\" test case r=philberty a=tschwinge\n\n... that was recently added in #1429 commit 9fc6a27b5c6ea2c775646c4474b9084da76b1764 \"expand: correctly handles non-macro nodes ...\".\r\n\r\n  - Rename 'macro-issue1403.rs' -> 'macro-issue1426.rs'.\r\n  - Get rid of '-w'; expect diagnostic instead.\r\n  - Get rid of debugging options not relevant here.\r\n  - Get rid of explicit '-O1'; make it a \"torture\" test case.\r\n  - Replace always-matching 'scan-assembler \"14\"' (\"14\" appears in the crate name) with directed dump scanning.\r\n      - ..., just not for '-O0', where such optimization is not done.\r\n\n\nCo-authored-by: Thomas Schwinge <thomas@codesourcery.com>", "tree": {"sha": "52e0c304bdbc781818a220f3bc05c813bfb1941e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/52e0c304bdbc781818a220f3bc05c813bfb1941e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8749b66879f3ef78182d7712e5da981cc55f747a", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJi8Nc6CRBK7hj4Ov3rIwAAdTcIAEPTvtMgBr+gXVS49yGgRJYq\n4BFy1/oiicDV3KOlKlItdqirbWIU3TGekZdBnBUUON5zzOrLZWHvWuBxQpgxG7++\n26vDjiuV9xNVEkxZT1WRZTSwkfGKxgJbClE3BfOjToOGWpjwfBnvEjH40Z4pVwrL\n+EPxeXUSefyqk9GkNVVeWMFjgdDHfvh9VQVcTK8Mi5OkNeGDDeFmmxILYcakU+pp\ndT8T+FtpJCVV1ZhKyoyGTORix+kMLZD2KZLS64o3wtdgemmnMWqlWssvnPAj1Vsg\nYvSEs7k1AoL+uhzLWK0dtzgGpNjGBHAu4pMAVBISXUM3Dq7+cdBur0vJXHw+4cs=\n=UH60\n-----END PGP SIGNATURE-----\n", "payload": "tree 52e0c304bdbc781818a220f3bc05c813bfb1941e\nparent c8f65b3fc8c42f4a11cf4fe5cd57768a33772e02\nparent 23702abda4ec44466f65581391ba9c0eae3f13f6\nauthor bors[bot] <26634292+bors[bot]@users.noreply.github.com> 1659950906 +0000\ncommitter GitHub <noreply@github.com> 1659950906 +0000\n\nMerge #1438\n\n1438: Enhance #1426 \"Invalid recursive :stmt expansion in fragment specifiers\" test case r=philberty a=tschwinge\n\n... that was recently added in #1429 commit 9fc6a27b5c6ea2c775646c4474b9084da76b1764 \"expand: correctly handles non-macro nodes ...\".\r\n\r\n  - Rename 'macro-issue1403.rs' -> 'macro-issue1426.rs'.\r\n  - Get rid of '-w'; expect diagnostic instead.\r\n  - Get rid of debugging options not relevant here.\r\n  - Get rid of explicit '-O1'; make it a \"torture\" test case.\r\n  - Replace always-matching 'scan-assembler \"14\"' (\"14\" appears in the crate name) with directed dump scanning.\r\n      - ..., just not for '-O0', where such optimization is not done.\r\n\n\nCo-authored-by: Thomas Schwinge <thomas@codesourcery.com>\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8749b66879f3ef78182d7712e5da981cc55f747a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8749b66879f3ef78182d7712e5da981cc55f747a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8749b66879f3ef78182d7712e5da981cc55f747a/comments", "author": {"login": "bors[bot]", "id": 26634292, "node_id": "MDM6Qm90MjY2MzQyOTI=", "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bors%5Bbot%5D", "html_url": "https://github.com/apps/bors", "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers", "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos", "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events", "type": "Bot", "site_admin": false}, "committer": {"login": "web-flow", "id": 19864447, "node_id": "MDQ6VXNlcjE5ODY0NDQ3", "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4", "gravatar_id": "", "url": "https://api.github.com/users/web-flow", "html_url": "https://github.com/web-flow", "followers_url": "https://api.github.com/users/web-flow/followers", "following_url": "https://api.github.com/users/web-flow/following{/other_user}", "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}", "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions", "organizations_url": "https://api.github.com/users/web-flow/orgs", "repos_url": "https://api.github.com/users/web-flow/repos", "events_url": "https://api.github.com/users/web-flow/events{/privacy}", "received_events_url": "https://api.github.com/users/web-flow/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c8f65b3fc8c42f4a11cf4fe5cd57768a33772e02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8f65b3fc8c42f4a11cf4fe5cd57768a33772e02", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8f65b3fc8c42f4a11cf4fe5cd57768a33772e02"}, {"sha": "23702abda4ec44466f65581391ba9c0eae3f13f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23702abda4ec44466f65581391ba9c0eae3f13f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23702abda4ec44466f65581391ba9c0eae3f13f6"}], "stats": {"total": 7, "additions": 4, "deletions": 3}, "files": [{"sha": "1b558cfa83da321659dc0419b1d3ecfe37b6391c", "filename": "gcc/testsuite/rust/compile/torture/macro-issue1426.rs", "status": "renamed", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8749b66879f3ef78182d7712e5da981cc55f747a/gcc%2Ftestsuite%2Frust%2Fcompile%2Ftorture%2Fmacro-issue1426.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8749b66879f3ef78182d7712e5da981cc55f747a/gcc%2Ftestsuite%2Frust%2Fcompile%2Ftorture%2Fmacro-issue1426.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Ftorture%2Fmacro-issue1426.rs?ref=8749b66879f3ef78182d7712e5da981cc55f747a", "patch": "@@ -1,5 +1,5 @@\n-// { dg-do compile }\n-// { dg-options \"-O1 -gdwarf-5 -dA -w\" }\n+// { dg-additional-options -fdump-tree-ccp1-raw }\n+\n macro_rules! stmt {\n     ($s:stmt) => {\n         $s\n@@ -13,6 +13,7 @@ macro_rules! stmt {\n pub fn test() -> i32 {\n     stmt!(\n         let a = 1\n+\t// { dg-warning {unused name 'a'} {} { target *-*-* } .-1 }\n     );\n     stmt!(\n         let b = 2,\n@@ -21,8 +22,8 @@ pub fn test() -> i32 {\n         let e = 5,\n         let f = b + c + d + e\n     );\n-    // { dg-final { scan-assembler \"14\" } }\n     f\n+    // { dg-final { scan-tree-dump-times {gimple_return <14>} 1 ccp1 { target __OPTIMIZE__ } } }\n }\n \n fn main() {", "previous_filename": "gcc/testsuite/rust/compile/macro-issue1403.rs"}]}