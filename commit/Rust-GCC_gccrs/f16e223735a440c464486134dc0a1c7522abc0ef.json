{"sha": "f16e223735a440c464486134dc0a1c7522abc0ef", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjE2ZTIyMzczNWE0NDBjNDY0NDg2MTM0ZGMwYTFjNzUyMmFiYzBlZg==", "commit": {"author": {"name": "Tobias Grosser", "email": "grosser@fim.uni-passau.de", "date": "2010-11-12T22:08:57Z"}, "committer": {"name": "Tobias Grosser", "email": "grosser@gcc.gnu.org", "date": "2010-11-12T22:08:57Z"}, "message": "Add -enable-cloog-backend.\n\n\t* config/cloog.m4: Add -enable-cloog-backend=(isl|ppl|ppl-legacy) to\n\tdefine the cloog backend to use. Furthermore, only pass the ppllibs\n\tto the configure checks, if necessary.\n\t*configure: Regenerate.\n\nFrom-SVN: r166684", "tree": {"sha": "fa008cd3961a73e3936c07b0c576a90b8259b29b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fa008cd3961a73e3936c07b0c576a90b8259b29b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f16e223735a440c464486134dc0a1c7522abc0ef", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f16e223735a440c464486134dc0a1c7522abc0ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f16e223735a440c464486134dc0a1c7522abc0ef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f16e223735a440c464486134dc0a1c7522abc0ef/comments", "author": {"login": "tobiasgrosser", "id": 521960, "node_id": "MDQ6VXNlcjUyMTk2MA==", "avatar_url": "https://avatars.githubusercontent.com/u/521960?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tobiasgrosser", "html_url": "https://github.com/tobiasgrosser", "followers_url": "https://api.github.com/users/tobiasgrosser/followers", "following_url": "https://api.github.com/users/tobiasgrosser/following{/other_user}", "gists_url": "https://api.github.com/users/tobiasgrosser/gists{/gist_id}", "starred_url": "https://api.github.com/users/tobiasgrosser/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tobiasgrosser/subscriptions", "organizations_url": "https://api.github.com/users/tobiasgrosser/orgs", "repos_url": "https://api.github.com/users/tobiasgrosser/repos", "events_url": "https://api.github.com/users/tobiasgrosser/events{/privacy}", "received_events_url": "https://api.github.com/users/tobiasgrosser/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "731d88863243a2316352a6e4bd3cf5fc3fe2b840", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/731d88863243a2316352a6e4bd3cf5fc3fe2b840", "html_url": "https://github.com/Rust-GCC/gccrs/commit/731d88863243a2316352a6e4bd3cf5fc3fe2b840"}], "stats": {"total": 168, "additions": 130, "deletions": 38}, "files": [{"sha": "9c8b3339f74b16dd2f007812dabb2d58d55be73f", "filename": "ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f16e223735a440c464486134dc0a1c7522abc0ef/ChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f16e223735a440c464486134dc0a1c7522abc0ef/ChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/ChangeLog?ref=f16e223735a440c464486134dc0a1c7522abc0ef", "patch": "@@ -1,3 +1,10 @@\n+2010-11-12  Tobias Grosser  <grosser@fim.uni-passau.de>\n+\n+\t* config/cloog.m4: Add -enable-cloog-backend=(isl|ppl|ppl-legacy) to\n+\tdefine the cloog backend to use. Furthermore, only pass the ppllibs to\n+\tthe configure checks, if necessary.\n+\t* configure: Regenerate.\n+\n 2010-11-12  Tobias Grosser  <grosser@fim.uni-passau.de>\n \n \t* config/cloog.m4: Use CLooG predefined macro to check for CLooG PPL."}, {"sha": "4936e8a13c94394641462855d836a8bc71b100bb", "filename": "config/cloog.m4", "status": "modified", "additions": 55, "deletions": 21, "changes": 76, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f16e223735a440c464486134dc0a1c7522abc0ef/config%2Fcloog.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f16e223735a440c464486134dc0a1c7522abc0ef/config%2Fcloog.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/config%2Fcloog.m4?ref=f16e223735a440c464486134dc0a1c7522abc0ef", "patch": "@@ -36,7 +36,19 @@ AC_DEFUN([CLOOG_INIT_FLAGS],\n     [AS_HELP_STRING(\n       [--with-cloog-lib=PATH],\n       [Specify the directory for the installed CLooG library])])\n-  \n+\n+  AC_ARG_ENABLE(cloog-backend,\n+    [  --enable-cloog-backend[=backend]\n+\t\t\t\tisl: The cloog.org isl backend\n+\t\t\t\tppl-legacy: The legacy ppl backend - default\n+\t\t\t\tppl: The cloog.org ppl backend],\n+    [ if   test \"x${enableval}\" = \"xisl\"; then\n+\tcloog_backend=isl\n+      elif test \"x${enableval}\" = \"xppl\"; then\n+\tcloog_backend=ppl\n+      else\n+\tcloog_backend=ppl-legacy\n+      fi], cloog_backend=ppl-legacy)\n   AC_ARG_ENABLE(cloog-version-check,\n     [AS_HELP_STRING(\n       [--disable-cloog-version-check],\n@@ -87,11 +99,19 @@ AC_DEFUN([CLOOG_REQUESTED],\n ]\n )\n \n-# _CLOOG_ORG_PROG ()\n+# _CLOOG_ORG_PROG_ISL ()\n # ------------------\n-# Helper for detecting CLooG.org's backend.\n-m4_define([_CLOOG_ORG_PROG],[AC_LANG_PROGRAM(\n-  [#include \"cloog/cloog.h\"],\n+# Helper for detecting CLooG.org's ISL backend.\n+m4_define([_CLOOG_ORG_PROG_ISL],[AC_LANG_PROGRAM(\n+  [#include \"cloog/cloog.h\" ],\n+  [cloog_version ()])])\n+\n+# _CLOOG_ORG_PROG_PPL ()\n+# ------------------\n+# Helper for detecting CLooG.org's PPL backend.\n+m4_define([_CLOOG_ORG_PROG_PPL],[AC_LANG_PROGRAM(\n+  [#include \"cloog/cloog.h\"\n+   #include \"cloog/ppl/cloog.h\"],\n   [cloog_version ()])])\n \n # _CLOOG_PPL_LEGACY_PROG ()\n@@ -106,7 +126,7 @@ m4_define([_CLOOG_PPL_LEGACY_PROG], [AC_LANG_PROGRAM(\n # CLOOG_FIND_FLAGS ()\n # ------------------\n # Detect the used CLooG-backend and set clooginc/clooglibs/cloog_org.\n-# Preference: CLooG-PPL (Legacy) > CLooG-ISL > CLooG-PPL\n+# Only look for the CLooG backend type specified in --enable-cloog-backend\n AC_DEFUN([CLOOG_FIND_FLAGS],\n [\n   AC_REQUIRE([CLOOG_INIT_FLAGS])\n@@ -119,22 +139,36 @@ AC_DEFUN([CLOOG_FIND_FLAGS],\n   _cloogorginc=\"-DCLOOG_INT_GMP -DCLOOG_ORG\"\n  \n   dnl clooglibs & clooginc may have been initialized by CLOOG_INIT_FLAGS.\n-  CFLAGS=\"${CFLAGS} ${clooginc} ${pplinc} ${gmpinc}\"\n+  CFLAGS=\"${CFLAGS} ${clooginc} ${gmpinc}\"\n   CPPFLAGS=\"${CPPFLAGS} ${_cloogorginc}\"\n-  LDFLAGS=\"${LDFLAGS} ${clooglibs} ${ppllibs}\"\n-\n-  AC_CACHE_CHECK([for installed CLooG],\n-                 [gcc_cv_cloog_type],\n-    [LIBS=\"-lcloog ${_cloog_saved_LIBS}\"\n-     AC_LINK_IFELSE([_CLOOG_PPL_LEGACY_PROG],\n-      [gcc_cv_cloog_type=\"PPL Legacy\"],\n-      [LIBS=\"-lcloog-isl -lisl ${_cloog_saved_LIBS}\"\n-       AC_LINK_IFELSE([_CLOOG_ORG_PROG],\n-        [gcc_cv_cloog_type=ISL],\n-        [LIBS=\"-lcloog-ppl ${_cloog_saved_LIBS}\"\n-         AC_LINK_IFELSE([_CLOOG_ORG_PROG],\n-          [gcc_cv_cloog_type=PPL],\n-          [gcc_cv_cloog_type=no])])])])\n+  LDFLAGS=\"${LDFLAGS} ${clooglibs}\"\n+\n+  case $cloog_backend in\n+    \"ppl-legacy\")\n+    CFLAGS=\"${CFLAGS} ${pplinc}\"\n+    LDFLAGS=\"${LDFLAGS} ${ppllibs}\"\n+    AC_CACHE_CHECK([for installed CLooG PPL Legacy], [gcc_cv_cloog_type],\n+      [LIBS=\"-lcloog ${_cloog_saved_LIBS}\"\n+      AC_LINK_IFELSE([_CLOOG_PPL_LEGACY_PROG], [gcc_cv_cloog_type=\"PPL Legacy\"],\n+\t\t     [gcc_cv_cloog_type=no])])\n+    ;;\n+    \"isl\")\n+    AC_CACHE_CHECK([for installed CLooG ISL], [gcc_cv_cloog_type],\n+      [LIBS=\"-lcloog-isl ${_cloog_saved_LIBS}\"\n+      AC_LINK_IFELSE([_CLOOG_ORG_PROG_ISL], [gcc_cv_cloog_type=\"ISL\"],\n+\t\t     [gcc_cv_cloog_type=no])])\n+    ;;\n+    \"ppl\")\n+    CFLAGS=\"${CFLAGS} ${pplinc}\"\n+    LDFLAGS=\"${LDFLAGS} ${ppllibs}\"\n+    AC_CACHE_CHECK([for installed CLooG PPL], [gcc_cv_cloog_type],\n+      [LIBS=\"-lcloog-ppl ${_cloog_saved_LIBS}\"\n+      AC_LINK_IFELSE([_CLOOG_ORG_PROG_PPL], [gcc_cv_cloog_type=\"PPL\"],\n+\t\t     [gcc_cv_cloog_type=no])])\n+    ;;\n+    *)\n+      gcc_cv_cloog_type=\"\"\n+  esac\n \n   case $gcc_cv_cloog_type in\n     \"PPL Legacy\")"}, {"sha": "bcc087bb242a606580b58c389737cb50e89e69d3", "filename": "configure", "status": "modified", "additions": 68, "deletions": 17, "changes": 85, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f16e223735a440c464486134dc0a1c7522abc0ef/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f16e223735a440c464486134dc0a1c7522abc0ef/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=f16e223735a440c464486134dc0a1c7522abc0ef", "patch": "@@ -765,6 +765,7 @@ enable_ppl_version_check\n with_cloog\n with_cloog_include\n with_cloog_lib\n+enable_cloog_backend\n enable_cloog_version_check\n enable_lto\n enable_stage1_languages\n@@ -1451,6 +1452,10 @@ Optional Features:\n   --enable-libssp         build libssp directory\n   --enable-build-with-cxx build with C++ compiler instead of C compiler\n   --disable-ppl-version-check    disable check for PPL version\n+  --enable-cloog-backend=backend\n+\t\t\t\tisl: The cloog.org isl backend\n+\t\t\t\tppl-legacy: The legacy ppl backend - default\n+\t\t\t\tppl: The cloog.org ppl backend\n   --disable-cloog-version-check\n                           disable check for CLooG version\n   --enable-lto            enable link time optimization support\n@@ -5676,6 +5681,19 @@ if test \"${with_cloog_lib+set}\" = set; then :\n fi\n \n \n+  # Check whether --enable-cloog-backend was given.\n+if test \"${enable_cloog_backend+set}\" = set; then :\n+  enableval=$enable_cloog_backend;  if   test \"x${enableval}\" = \"xisl\"; then\n+\tcloog_backend=isl\n+      elif test \"x${enableval}\" = \"xppl\"; then\n+\tcloog_backend=ppl\n+      else\n+\tcloog_backend=ppl-legacy\n+      fi\n+else\n+  cloog_backend=ppl-legacy\n+fi\n+\n   # Check whether --enable-cloog-version-check was given.\n if test \"${enable_cloog_version_check+set}\" = set; then :\n   enableval=$enable_cloog_version_check; ENABLE_CLOOG_CHECK=$enableval\n@@ -5727,17 +5745,21 @@ if test \"x$with_cloog\" != \"xno\"; then\n \n   _cloogorginc=\"-DCLOOG_INT_GMP -DCLOOG_ORG\"\n \n-    CFLAGS=\"${CFLAGS} ${clooginc} ${pplinc} ${gmpinc}\"\n+    CFLAGS=\"${CFLAGS} ${clooginc} ${gmpinc}\"\n   CPPFLAGS=\"${CPPFLAGS} ${_cloogorginc}\"\n-  LDFLAGS=\"${LDFLAGS} ${clooglibs} ${ppllibs}\"\n-\n-  { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for installed CLooG\" >&5\n-$as_echo_n \"checking for installed CLooG... \" >&6; }\n+  LDFLAGS=\"${LDFLAGS} ${clooglibs}\"\n+\n+  case $cloog_backend in\n+    \"ppl-legacy\")\n+    CFLAGS=\"${CFLAGS} ${pplinc}\"\n+    LDFLAGS=\"${LDFLAGS} ${ppllibs}\"\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for installed CLooG PPL Legacy\" >&5\n+$as_echo_n \"checking for installed CLooG PPL Legacy... \" >&6; }\n if test \"${gcc_cv_cloog_type+set}\" = set; then :\n   $as_echo_n \"(cached) \" >&6\n else\n   LIBS=\"-lcloog ${_cloog_saved_LIBS}\"\n-     cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n #include \"cloog/cloog.h\"\n int\n@@ -5753,8 +5775,22 @@ _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n   gcc_cv_cloog_type=\"PPL Legacy\"\n else\n-  LIBS=\"-lcloog-isl -lisl ${_cloog_saved_LIBS}\"\n-       cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+  gcc_cv_cloog_type=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gcc_cv_cloog_type\" >&5\n+$as_echo \"$gcc_cv_cloog_type\" >&6; }\n+    ;;\n+    \"isl\")\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for installed CLooG ISL\" >&5\n+$as_echo_n \"checking for installed CLooG ISL... \" >&6; }\n+if test \"${gcc_cv_cloog_type+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n+else\n+  LIBS=\"-lcloog-isl ${_cloog_saved_LIBS}\"\n+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n #include \"cloog/cloog.h\"\n int\n@@ -5766,12 +5802,29 @@ cloog_version ()\n }\n _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n-  gcc_cv_cloog_type=ISL\n+  gcc_cv_cloog_type=\"ISL\"\n+else\n+  gcc_cv_cloog_type=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gcc_cv_cloog_type\" >&5\n+$as_echo \"$gcc_cv_cloog_type\" >&6; }\n+    ;;\n+    \"ppl\")\n+    CFLAGS=\"${CFLAGS} ${pplinc}\"\n+    LDFLAGS=\"${LDFLAGS} ${ppllibs}\"\n+    { $as_echo \"$as_me:${as_lineno-$LINENO}: checking for installed CLooG PPL\" >&5\n+$as_echo_n \"checking for installed CLooG PPL... \" >&6; }\n+if test \"${gcc_cv_cloog_type+set}\" = set; then :\n+  $as_echo_n \"(cached) \" >&6\n else\n   LIBS=\"-lcloog-ppl ${_cloog_saved_LIBS}\"\n-         cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n /* end confdefs.h.  */\n #include \"cloog/cloog.h\"\n+   #include \"cloog/ppl/cloog.h\"\n int\n main ()\n {\n@@ -5781,21 +5834,19 @@ cloog_version ()\n }\n _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n-  gcc_cv_cloog_type=PPL\n+  gcc_cv_cloog_type=\"PPL\"\n else\n   gcc_cv_cloog_type=no\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n fi\n-rm -f core conftest.err conftest.$ac_objext \\\n-    conftest$ac_exeext conftest.$ac_ext\n-fi\n-rm -f core conftest.err conftest.$ac_objext \\\n-    conftest$ac_exeext conftest.$ac_ext\n-fi\n { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gcc_cv_cloog_type\" >&5\n $as_echo \"$gcc_cv_cloog_type\" >&6; }\n+    ;;\n+    *)\n+      gcc_cv_cloog_type=\"\"\n+  esac\n \n   case $gcc_cv_cloog_type in\n     \"PPL Legacy\")"}]}