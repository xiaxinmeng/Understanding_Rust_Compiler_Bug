{"sha": "4ef3890074446d4ad7dcf60a538ca0c56e887804", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGVmMzg5MDA3NDQ0NmQ0YWQ3ZGNmNjBhNTM4Y2EwYzU2ZTg4NzgwNA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2018-11-19T09:33:18Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2018-11-19T09:33:18Z"}, "message": "decl2.c (grokfield): Remove obsolete _vptr check; fix explicit template argument list error location.\n\n/cp\n2018-11-18  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* decl2.c (grokfield): Remove obsolete _vptr check; fix\n\texplicit template argument list error location.\n\n/testsuite\n2018-11-18  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* g++.dg/template/crash91.C: Check location too.\n\nFrom-SVN: r266264", "tree": {"sha": "c922f6da0a59d3e1f34b6ad7753ce8a778dc4c8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c922f6da0a59d3e1f34b6ad7753ce8a778dc4c8f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4ef3890074446d4ad7dcf60a538ca0c56e887804", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ef3890074446d4ad7dcf60a538ca0c56e887804", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ef3890074446d4ad7dcf60a538ca0c56e887804", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ef3890074446d4ad7dcf60a538ca0c56e887804/comments", "author": null, "committer": null, "parents": [{"sha": "390e529e2b98983de392b3d9b9b57c4a1258b080", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/390e529e2b98983de392b3d9b9b57c4a1258b080", "html_url": "https://github.com/Rust-GCC/gccrs/commit/390e529e2b98983de392b3d9b9b57c4a1258b080"}], "stats": {"total": 31, "additions": 15, "deletions": 16}, "files": [{"sha": "6f60f0d57f943e8b1156fb79e017a4f7c4d5a38a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=4ef3890074446d4ad7dcf60a538ca0c56e887804", "patch": "@@ -1,3 +1,8 @@\n+2018-11-18  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* decl2.c (grokfield): Remove obsolete _vptr check; fix\n+\texplicit template argument list error location.\n+\n 2018-11-16  Kamlesh Kumar  <kamleshbhalui@gmail.com>\n \n \tDR 1207"}, {"sha": "7686a908631a2fccb294fd8ac87673f7143a6a57", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 5, "deletions": 15, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=4ef3890074446d4ad7dcf60a538ca0c56e887804", "patch": "@@ -804,7 +804,6 @@ grokfield (const cp_declarator *declarator,\n   tree value;\n   const char *asmspec = 0;\n   int flags;\n-  tree name;\n \n   if (init\n       && TREE_CODE (init) == TREE_LIST\n@@ -829,21 +828,12 @@ grokfield (const cp_declarator *declarator,\n   if (value == void_type_node)\n     return value;\n \n-\n-  name = DECL_NAME (value);\n-\n-  if (name != NULL_TREE)\n+  if (DECL_NAME (value)\n+      && TREE_CODE (DECL_NAME (value)) == TEMPLATE_ID_EXPR)\n     {\n-      if (TREE_CODE (name) == TEMPLATE_ID_EXPR)\n-\t{\n-\t  error (\"explicit template argument list not allowed\");\n-\t  return error_mark_node;\n-\t}\n-\n-      if (IDENTIFIER_POINTER (name)[0] == '_'\n-\t  && id_equal (name, \"_vptr\"))\n-\terror (\"member %qD conflicts with virtual function table field name\",\n-\t       value);\n+      error_at (declarator->id_loc,\n+\t\t\"explicit template argument list not allowed\");\n+      return error_mark_node;\n     }\n \n   /* Stash away type declarations.  */"}, {"sha": "e1f0ac6b0cc6a3bfb64b8a3437d71753ba998944", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4ef3890074446d4ad7dcf60a538ca0c56e887804", "patch": "@@ -1,3 +1,7 @@\n+2018-11-18  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* g++.dg/template/crash91.C: Check location too.\n+\n 2018-11-19  Martin Liska  <mliska@suse.cz>\n \n \tPR gcov-profile/88045"}, {"sha": "6fda320ee958e6c0ca68052c4db408aaf5ab4a0b", "filename": "gcc/testsuite/g++.dg/template/crash91.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash91.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4ef3890074446d4ad7dcf60a538ca0c56e887804/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash91.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash91.C?ref=4ef3890074446d4ad7dcf60a538ca0c56e887804", "patch": "@@ -4,5 +4,5 @@ template<int> void foo();\n \n struct A\n {\n-  typedef void foo<0>(); // { dg-error \"explicit template argument list not allowed\" } \n+  typedef void foo<0>(); // { dg-error \"16:explicit template argument list not allowed\" } \n };"}]}