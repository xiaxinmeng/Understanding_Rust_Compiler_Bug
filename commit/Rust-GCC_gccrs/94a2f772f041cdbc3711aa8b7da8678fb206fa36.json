{"sha": "94a2f772f041cdbc3711aa8b7da8678fb206fa36", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTRhMmY3NzJmMDQxY2RiYzM3MTFhYThiN2RhODY3OGZiMjA2ZmEzNg==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-02-10T00:38:46Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-02-10T00:38:46Z"}, "message": "re PR ipa/64978 (ICE: in ipcp_verify_propagated_values, at ipa-cp.c:1060)\n\n\n\tPR ipa/64978\n\t* ipa-cp.c (gather_caller_stats): Skip thunks.\n\t(propagate_constants_topo): Skip aliases.\n\n\t* g++.dg/torture/pr64978.C: New testcase.\n\nFrom-SVN: r220557", "tree": {"sha": "e7b9077f8f868d6c3e6d9f22b17e5ffca21cfd6d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e7b9077f8f868d6c3e6d9f22b17e5ffca21cfd6d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/94a2f772f041cdbc3711aa8b7da8678fb206fa36", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94a2f772f041cdbc3711aa8b7da8678fb206fa36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94a2f772f041cdbc3711aa8b7da8678fb206fa36", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94a2f772f041cdbc3711aa8b7da8678fb206fa36/comments", "author": null, "committer": null, "parents": [{"sha": "b25d7b91b0c763e0d078cf98465fdd2c1ec34f58", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b25d7b91b0c763e0d078cf98465fdd2c1ec34f58", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b25d7b91b0c763e0d078cf98465fdd2c1ec34f58"}], "stats": {"total": 48, "additions": 43, "deletions": 5}, "files": [{"sha": "47574709f40491853bbee5a7ed764485f6aeb276", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=94a2f772f041cdbc3711aa8b7da8678fb206fa36", "patch": "@@ -1,3 +1,9 @@\n+2015-02-09  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/64978\n+\t* ipa-cp.c (gather_caller_stats): Skip thunks.\n+\t(propagate_constants_topo): Skip aliases.\n+\n 2015-02-09  Kaz Kojima  <kkojima@gcc.gnu.org>\n \n \tPR target/64761"}, {"sha": "440ced4900c37bfc9e33c7e7087de23e1ff36041", "filename": "gcc/ipa-cp.c", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2Fipa-cp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2Fipa-cp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-cp.c?ref=94a2f772f041cdbc3711aa8b7da8678fb206fa36", "patch": "@@ -560,10 +560,7 @@ gather_caller_stats (struct cgraph_node *node, void *data)\n   struct cgraph_edge *cs;\n \n   for (cs = node->callers; cs; cs = cs->next_caller)\n-    if (cs->caller->thunk.thunk_p)\n-      cs->caller->call_for_symbol_thunks_and_aliases (gather_caller_stats,\n-\t\t\t\t\t\t    stats, false);\n-    else\n+    if (!cs->caller->thunk.thunk_p)\n       {\n \tstats->count_sum += cs->count;\n \tstats->freq_sum += cs->frequency;\n@@ -2643,7 +2640,7 @@ propagate_constants_topo (struct ipa_topo_info *topo)\n \t  for (cs = v->callees; cs; cs = cs->next_callee)\n \t    if (ipa_edge_within_scc (cs)\n \t\t&& propagate_constants_accross_call (cs))\n-\t      push_node_to_stack (topo, cs->callee);\n+\t      push_node_to_stack (topo, cs->callee->function_symbol ());\n \t  v = pop_node_from_stack (topo);\n \t}\n "}, {"sha": "f34de6ed35d1460073937631584b87048c223437", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=94a2f772f041cdbc3711aa8b7da8678fb206fa36", "patch": "@@ -1,3 +1,8 @@\n+2015-02-08  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/64978\n+\t* g++.dg/torture/pr64978.C: New testcase.\n+\n 2015-02-09  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR sanitizer/64981"}, {"sha": "a9ac49f8e1227c38b5b89cd172c0aef0cc53d2ba", "filename": "gcc/testsuite/g++.dg/torture/pr64978.C", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr64978.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/94a2f772f041cdbc3711aa8b7da8678fb206fa36/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr64978.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr64978.C?ref=94a2f772f041cdbc3711aa8b7da8678fb206fa36", "patch": "@@ -0,0 +1,30 @@\n+/* { dg-do compile } */\n+class A {\n+public:\n+  A(int, int);\n+};\n+class B {\n+public:\n+  void m_fn1(bool, const int *, int &);\n+  unsigned m_fn2();\n+};\n+namespace {\n+class C {\n+  B &VTables;\n+  void m_fn3(A, unsigned, const int *, int &);\n+\n+public:\n+  int VFTableBuilder_VisitedBases;\n+  B VFTableBuilder_VTables;\n+  C() : VTables(VFTableBuilder_VTables) {\n+    m_fn3(A(0, 0), 0, 0, VFTableBuilder_VisitedBases);\n+  }\n+};\n+}\n+int a;\n+void C::m_fn3(A, unsigned, const int *, int &) {\n+  for (;;)\n+    1 ? VTables.m_fn2() : 0;\n+}\n+void B::m_fn1(bool, const int *, int &) { C(); }\n+unsigned B::m_fn2() { m_fn1(0, 0, a); }"}]}