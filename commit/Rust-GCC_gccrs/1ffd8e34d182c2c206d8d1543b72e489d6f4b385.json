{"sha": "1ffd8e34d182c2c206d8d1543b72e489d6f4b385", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWZmZDhlMzRkMTgyYzJjMjA2ZDhkMTU0M2I3MmU0ODlkNmY0YjM4NQ==", "commit": {"author": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2020-11-17T16:30:35Z"}, "committer": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2020-11-17T16:30:35Z"}, "message": "float.h: Handle C2x __STDC_WANT_IEC_60559_EXT__\n\nTS 18661-1 and 18661-2 have various definitions conditional on\n__STDC_WANT_IEC_60559_BFP_EXT__ and __STDC_WANT_IEC_60559_DFP_EXT__\nmacros.  When those TSes were integrated into C2x, most of the feature\ntest macro conditionals were removed (with declarations for decimal FP\nbecoming conditional only on whether decimal FP is supported by the\nimplementation and those for binary FP becoming unconditionally\nrequired).\n\nA few tests of those feature test macros remained for declarations\nthat appeared only in Annex F and not in the main part of the\nstandard.  A change accepted for C2x at the last WG14 meeting (but not\nyet added to the working draft in git) was to replace both those\nmacros by __STDC_WANT_IEC_60559_EXT__; if __STDC_WANT_IEC_60559_EXT__\nis defined, the specific declarations in the headers will then depend\non which features are supported by the implementation, as for\ndeclarations not controlled by a feature test macro at all.\n\nThus, add a check of __STDC_WANT_IEC_60559_EXT__ for CR_DECIMAL_DIG in\nfloat.h, the only case of this change relevant to GCC.\n\nBootstrapped with no regressions for x86_64-pc-linux-gnu.\n\ngcc/\n2020-11-17  Joseph Myers  <joseph@codesourcery.com>\n\n\t* ginclude/float.h (CR_DECIMAL_DIG): Also define for\n\t[__STDC_WANT_IEC_60559_EXT__].\n\ngcc/testsuite/\n2020-11-17  Joseph Myers  <joseph@codesourcery.com>\n\n\t* gcc.dg/cr-decimal-dig-3.c: New test.", "tree": {"sha": "56b289e11c132df2ac25cdfba32ca150a0775ee7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/56b289e11c132df2ac25cdfba32ca150a0775ee7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1ffd8e34d182c2c206d8d1543b72e489d6f4b385", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ffd8e34d182c2c206d8d1543b72e489d6f4b385", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ffd8e34d182c2c206d8d1543b72e489d6f4b385", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ffd8e34d182c2c206d8d1543b72e489d6f4b385/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ac30c8b8d035cd9259040150f059f1cf3542f626", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac30c8b8d035cd9259040150f059f1cf3542f626", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac30c8b8d035cd9259040150f059f1cf3542f626"}], "stats": {"total": 17, "additions": 16, "deletions": 1}, "files": [{"sha": "39139ee8dd12b1f9d4977c8fe2a118866a81e598", "filename": "gcc/ginclude/float.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ffd8e34d182c2c206d8d1543b72e489d6f4b385/gcc%2Fginclude%2Ffloat.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ffd8e34d182c2c206d8d1543b72e489d6f4b385/gcc%2Fginclude%2Ffloat.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fginclude%2Ffloat.h?ref=1ffd8e34d182c2c206d8d1543b72e489d6f4b385", "patch": "@@ -285,7 +285,8 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n \n #endif /* C2X */\n \n-#ifdef __STDC_WANT_IEC_60559_BFP_EXT__\n+#if (defined __STDC_WANT_IEC_60559_BFP_EXT__ \\\n+     || defined __STDC_WANT_IEC_60559_EXT__)\n /* Number of decimal digits for which conversions between decimal\n    character strings and binary formats, in both directions, are\n    correctly rounded.  */"}, {"sha": "8e07b67dd5231c8ac00d9c2cdf8411855a962fdb", "filename": "gcc/testsuite/gcc.dg/cr-decimal-dig-3.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ffd8e34d182c2c206d8d1543b72e489d6f4b385/gcc%2Ftestsuite%2Fgcc.dg%2Fcr-decimal-dig-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ffd8e34d182c2c206d8d1543b72e489d6f4b385/gcc%2Ftestsuite%2Fgcc.dg%2Fcr-decimal-dig-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcr-decimal-dig-3.c?ref=1ffd8e34d182c2c206d8d1543b72e489d6f4b385", "patch": "@@ -0,0 +1,14 @@\n+/* Test C2x CR_DECIMAL_DIG: defined for __STDC_WANT_IEC_60559_EXT__.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c2x\" } */\n+\n+#define __STDC_WANT_IEC_60559_EXT__\n+#include <float.h>\n+\n+#ifndef CR_DECIMAL_DIG\n+#error \"CR_DECIMAL_DIG not defined\"\n+#endif\n+\n+#if CR_DECIMAL_DIG < DECIMAL_DIG + 3\n+#error \"CR_DECIMAL_DIG too small\"\n+#endif"}]}