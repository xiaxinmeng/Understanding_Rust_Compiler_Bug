{"sha": "739e7ebb3d378ece25d64b39baae47c584253498", "node_id": "C_kwDOANBUbNoAKDczOWU3ZWJiM2QzNzhlY2UyNWQ2NGIzOWJhYWU0N2M1ODQyNTM0OTg", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2023-03-04T08:48:17Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2023-03-04T08:48:17Z"}, "message": "diagnostics: Fix up selftests with $COLUMNS < 42 [PR108973]\n\nAs mentioned in the PR, GCC's diagnostics self-tests fail if $COLUMNS < 42.\nGuarding each self-test with if (get_terminal_width () > 41) or similar\nwould be a maintainance nightmare (PR has a patch to do so without\nreformatting to make it work for $COLUMNS in [30, 41] inclusive, but\nI'm afraid going down to $COLUMNS 1 would mean marking everything).\nFurthermore, the self-tests don't really emit stuff to the terminal,\nbut into a buffer, so using get_terminal_width () for it seems\ninappropriate.  The following patch makes sure test_diagnostic_context\nconstructor uses exactly 80 columns wide caret max width, of course\nsome tests override it already if they want to test for behavior in narrower\ncases.\n\n2023-03-04  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR testsuite/108973\n\t* selftest-diagnostic.cc\n\t(test_diagnostic_context::test_diagnostic_context): Set\n\tcaret_max_width to 80.", "tree": {"sha": "1694fb2398b39447dfca26aa15f20a4cbf6565c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1694fb2398b39447dfca26aa15f20a4cbf6565c1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/739e7ebb3d378ece25d64b39baae47c584253498", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/739e7ebb3d378ece25d64b39baae47c584253498", "html_url": "https://github.com/Rust-GCC/gccrs/commit/739e7ebb3d378ece25d64b39baae47c584253498", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/739e7ebb3d378ece25d64b39baae47c584253498/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "53940eee08957b8b72ee70f57770398009e19c21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/53940eee08957b8b72ee70f57770398009e19c21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/53940eee08957b8b72ee70f57770398009e19c21"}], "stats": {"total": 1, "additions": 1, "deletions": 0}, "files": [{"sha": "6d1bd1bd792b1a8bb6ee68747831450defc8fea8", "filename": "gcc/selftest-diagnostic.cc", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/739e7ebb3d378ece25d64b39baae47c584253498/gcc%2Fselftest-diagnostic.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/739e7ebb3d378ece25d64b39baae47c584253498/gcc%2Fselftest-diagnostic.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fselftest-diagnostic.cc?ref=739e7ebb3d378ece25d64b39baae47c584253498", "patch": "@@ -41,6 +41,7 @@ test_diagnostic_context::test_diagnostic_context ()\n   show_column = true;\n   start_span = start_span_cb;\n   min_margin_width = 6;\n+  caret_max_width = 80;\n }\n \n test_diagnostic_context::~test_diagnostic_context ()"}]}