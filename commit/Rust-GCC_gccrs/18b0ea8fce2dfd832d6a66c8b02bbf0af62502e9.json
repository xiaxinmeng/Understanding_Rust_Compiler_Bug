{"sha": "18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MThiMGVhOGZjZTJkZmQ4MzJkNmE2NmM4YjAyYmJmMGFmNjI1MDJlOQ==", "commit": {"author": {"name": "Michael Matz", "email": "matz@suse.de", "date": "2013-07-12T15:41:49Z"}, "committer": {"name": "Michael Matz", "email": "matz@gcc.gnu.org", "date": "2013-07-12T15:41:49Z"}, "message": "re PR middle-end/55771 (Negation and type conversion incorrectly exchanged)\n\n\tPR middle-end/55771\n\t* convert.c (convert_to_real): Reject non-float inner types.\n\ntestsuite/\n\t* c-c++-common/pr55771.c: New test.\n\nFrom-SVN: r200926", "tree": {"sha": "4d63038be796e8fcc6cbc95e125ec2ead6069df9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4d63038be796e8fcc6cbc95e125ec2ead6069df9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/comments", "author": {"login": "susematz", "id": 4117296, "node_id": "MDQ6VXNlcjQxMTcyOTY=", "avatar_url": "https://avatars.githubusercontent.com/u/4117296?v=4", "gravatar_id": "", "url": "https://api.github.com/users/susematz", "html_url": "https://github.com/susematz", "followers_url": "https://api.github.com/users/susematz/followers", "following_url": "https://api.github.com/users/susematz/following{/other_user}", "gists_url": "https://api.github.com/users/susematz/gists{/gist_id}", "starred_url": "https://api.github.com/users/susematz/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/susematz/subscriptions", "organizations_url": "https://api.github.com/users/susematz/orgs", "repos_url": "https://api.github.com/users/susematz/repos", "events_url": "https://api.github.com/users/susematz/events{/privacy}", "received_events_url": "https://api.github.com/users/susematz/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e4f0f84d56bccc7ffcbf2ba7def8bcc7cb921b6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4f0f84d56bccc7ffcbf2ba7def8bcc7cb921b6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4f0f84d56bccc7ffcbf2ba7def8bcc7cb921b6b"}], "stats": {"total": 27, "additions": 25, "deletions": 2}, "files": [{"sha": "cc3b7daf7907f26d1df6ff93319a2a9d1b8dc2dc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "patch": "@@ -1,3 +1,8 @@\n+2013-07-12  Michael Matz  <matz@suse.de>\n+\n+\tPR middle-end/55771\n+\t* convert.c (convert_to_real): Reject non-float inner types.\n+\n 2013-07-12  Tejas Belagod  <tejas.belagod@arm.com>\n \n \t* config/aarch64/aarch64-protos.h"}, {"sha": "9ecef4247ba702c6b12d9aa5b24c21278155a7dd", "filename": "gcc/convert.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2Fconvert.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2Fconvert.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconvert.c?ref=18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "patch": "@@ -213,11 +213,12 @@ convert_to_real (tree type, tree expr)\n     switch (TREE_CODE (expr))\n       {\n \t/* Convert (float)-x into -(float)x.  This is safe for\n-\t   round-to-nearest rounding mode.  */\n+\t   round-to-nearest rounding mode when the inner type is float.  */\n \tcase ABS_EXPR:\n \tcase NEGATE_EXPR:\n \t  if (!flag_rounding_math\n-\t      && TYPE_PRECISION (type) < TYPE_PRECISION (TREE_TYPE (expr)))\n+\t      && FLOAT_TYPE_P (itype)\n+\t      && TYPE_PRECISION (type) < TYPE_PRECISION (itype))\n \t    return build1 (TREE_CODE (expr), type,\n \t\t\t   fold (convert_to_real (type,\n \t\t\t\t\t\t  TREE_OPERAND (expr, 0))));"}, {"sha": "41cea555cd2ec75aea66b2ef42ac96ff68fde83c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "patch": "@@ -1,3 +1,8 @@\n+2013-07-12  Michael Matz  <matz@suse.de>\n+\n+\tPR middle-end/55771\n+\t* c-c++-common/pr55771.c: New test.\n+\n 2013-07-12  Tejas Belagod  <tejas.belagod@arm.com>\n \n \t* gcc.target/aarch64/vect-movi.c: New."}, {"sha": "16f02442c111b7a997cb9c22783bbbb6098a9dcc", "filename": "gcc/testsuite/c-c++-common/pr55771.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr55771.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr55771.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr55771.c?ref=18b0ea8fce2dfd832d6a66c8b02bbf0af62502e9", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-do run } */\n+\n+float global;\n+int main()\n+{\n+  unsigned long z = 1;\n+  float x = -z;\n+  global = x;\n+  if (global < 0)\n+    __builtin_abort ();\n+  return 0;\n+}"}]}