{"sha": "c219b878772bda4a2235e52ec715e295a8c204ad", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzIxOWI4Nzg3NzJiZGE0YTIyMzVlNTJlYzcxNWUyOTVhOGMyMDRhZA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "1999-10-07T16:41:48Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "1999-10-07T16:41:48Z"}, "message": "friend.c (make_friend_class): Robustify.\n\n\t* friend.c (make_friend_class): Robustify.\n\n\t* semantics.c (finish_object_call_expr): Reject calls to template\n\ttypes.\n\nFrom-SVN: r29855", "tree": {"sha": "4466036bfc96a1e2dc96a4a1bdadce1fe995ec1d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4466036bfc96a1e2dc96a4a1bdadce1fe995ec1d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c219b878772bda4a2235e52ec715e295a8c204ad", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c219b878772bda4a2235e52ec715e295a8c204ad", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c219b878772bda4a2235e52ec715e295a8c204ad", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c219b878772bda4a2235e52ec715e295a8c204ad/comments", "author": null, "committer": null, "parents": [{"sha": "ab150fb1894fda0eab14187338834d656de2a52a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab150fb1894fda0eab14187338834d656de2a52a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab150fb1894fda0eab14187338834d656de2a52a"}], "stats": {"total": 24, "additions": 20, "deletions": 4}, "files": [{"sha": "526edb1541c43ea0808953abbb8a455dfd26f2c3", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c219b878772bda4a2235e52ec715e295a8c204ad/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c219b878772bda4a2235e52ec715e295a8c204ad/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=c219b878772bda4a2235e52ec715e295a8c204ad", "patch": "@@ -1,3 +1,10 @@\n+1999-10-07  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* friend.c (make_friend_class): Robustify.\n+\n+\t* semantics.c (finish_object_call_expr): Reject calls to template\n+\ttypes.\n+\n 1999-10-06  Mark Mitchell  <mark@codesourcery.com>\n \n \t* dump.c (dequeue_and_dump): Dump all three operands to a COND_EXPR."}, {"sha": "d2325f34c151d16c7c1af66ff3d1d322863a983e", "filename": "gcc/cp/friend.c", "status": "modified", "additions": 12, "deletions": 3, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c219b878772bda4a2235e52ec715e295a8c204ad/gcc%2Fcp%2Ffriend.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c219b878772bda4a2235e52ec715e295a8c204ad/gcc%2Fcp%2Ffriend.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ffriend.c?ref=c219b878772bda4a2235e52ec715e295a8c204ad", "patch": "@@ -277,7 +277,8 @@ make_friend_class (type, friend_type)\n     is_template_friend = 0;\n \n   if (is_template_friend \n-      && TREE_CODE (friend_type) == TYPENAME_TYPE)\n+      && (TREE_CODE (friend_type) == TYPENAME_TYPE\n+\t  || TREE_CODE (friend_type) == TEMPLATE_TYPE_PARM))\n     {\n       /* [temp.friend]\n \n@@ -290,9 +291,17 @@ make_friend_class (type, friend_type)\n \n \t   template <class T> friend typename S<T>::X;\n \n+\t or:\n+\n+\t   template <class T> friend class T;\n+\n \t which isn't any of these.  */\n-      cp_error (\"typename type `%T' declared `friend'\",\n-\t\tfriend_type);\n+      if (TREE_CODE (friend_type) == TYPENAME_TYPE)\n+\tcp_error (\"typename type `%T' declared `friend'\",\n+\t\t  friend_type);\n+      else\n+\tcp_error (\"template parameter type `%T' declared `friend'\",\n+\t\t  friend_type);\n       return;\n     }\n "}, {"sha": "da17d3b3a01d814cc8bc6bbaab15a6e14884fa07", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c219b878772bda4a2235e52ec715e295a8c204ad/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c219b878772bda4a2235e52ec715e295a8c204ad/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=c219b878772bda4a2235e52ec715e295a8c204ad", "patch": "@@ -1480,7 +1480,7 @@ finish_object_call_expr (fn, object, args)\n   tree real_fn = build_component_ref (object, fn, NULL_TREE, 1);\n   return finish_call_expr (real_fn, args);\n #else\n-  if (TREE_CODE (fn) == TYPE_DECL)\n+  if (DECL_DECLARES_TYPE_P (fn))\n     {\n       if (processing_template_decl)\n \t/* This can happen on code like:"}]}