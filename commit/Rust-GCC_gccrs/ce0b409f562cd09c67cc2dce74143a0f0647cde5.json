{"sha": "ce0b409f562cd09c67cc2dce74143a0f0647cde5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2UwYjQwOWY1NjJjZDA5YzY3Y2MyZGNlNzQxNDNhMGYwNjQ3Y2RlNQ==", "commit": {"author": {"name": "Andrew MacLeod", "email": "amacleod@redhat.com", "date": "2021-06-24T15:13:47Z"}, "committer": {"name": "Andrew MacLeod", "email": "amacleod@redhat.com", "date": "2021-06-24T17:25:58Z"}, "message": "Fix relation query of equivalences.\n\nWhen looking for relations between equivalencies, a typo was causing\nthe wrong bitmap to be checked. Effect was is missed them.\nPlus don't dump blocks which don't exist.\n\n\t* value-relation.cc (equiv_oracle::dump): Do not dump NULL blocks.\n\t(relation_oracle::find_relation_block): Check correct bitmap.\n\t(relation_oracle::dump): Do not dump NULL blocks.", "tree": {"sha": "b9e675f285a469a8d9f831a95cf27b303579df82", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b9e675f285a469a8d9f831a95cf27b303579df82"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ce0b409f562cd09c67cc2dce74143a0f0647cde5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce0b409f562cd09c67cc2dce74143a0f0647cde5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce0b409f562cd09c67cc2dce74143a0f0647cde5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce0b409f562cd09c67cc2dce74143a0f0647cde5/comments", "author": null, "committer": null, "parents": [{"sha": "5bdcfb74ff97b42f08993af8614c35685fdd8689", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5bdcfb74ff97b42f08993af8614c35685fdd8689", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5bdcfb74ff97b42f08993af8614c35685fdd8689"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "43fcab7995ae8c91258588a9244ad17c211123d9", "filename": "gcc/value-relation.cc", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce0b409f562cd09c67cc2dce74143a0f0647cde5/gcc%2Fvalue-relation.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce0b409f562cd09c67cc2dce74143a0f0647cde5/gcc%2Fvalue-relation.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvalue-relation.cc?ref=ce0b409f562cd09c67cc2dce74143a0f0647cde5", "patch": "@@ -444,7 +444,7 @@ equiv_oracle::dump (FILE *f) const\n {\n   fprintf (f, \"Equivalency dump\\n\");\n   for (unsigned i = 0; i < m_equiv.length (); i++)\n-    if (m_equiv[i])\n+    if (m_equiv[i] && BASIC_BLOCK_FOR_FN (cfun, i))\n       {\n \tfprintf (f, \"BB%d\\n\", i);\n \tdump (f, BASIC_BLOCK_FOR_FN (cfun, i));\n@@ -757,9 +757,9 @@ relation_oracle::find_relation_block (unsigned bb, const_bitmap b1,\n     {\n       unsigned op1 = SSA_NAME_VERSION (ptr->op1 ());\n       unsigned op2 = SSA_NAME_VERSION (ptr->op2 ());\n-      if (bitmap_bit_p (b1, op1) && bitmap_bit_p (b1, op2))\n+      if (bitmap_bit_p (b1, op1) && bitmap_bit_p (b2, op2))\n \treturn ptr->kind ();\n-      if (bitmap_bit_p (b1, op2) && bitmap_bit_p (b1, op1))\n+      if (bitmap_bit_p (b1, op2) && bitmap_bit_p (b2, op1))\n \treturn relation_swap (ptr->kind ());\n     }\n \n@@ -925,8 +925,9 @@ relation_oracle::dump (FILE *f) const\n {\n   fprintf (f, \"Relation dump\\n\");\n   for (unsigned i = 0; i < m_relations.length (); i++)\n-    {\n-      fprintf (f, \"BB%d\\n\", i);\n-      dump (f, BASIC_BLOCK_FOR_FN (cfun, i));\n-    }\n+    if (BASIC_BLOCK_FOR_FN (cfun, i))\n+      {\n+\tfprintf (f, \"BB%d\\n\", i);\n+\tdump (f, BASIC_BLOCK_FOR_FN (cfun, i));\n+      }\n }"}]}