{"sha": "b573c9d6f4a2e4692492894266d1d936b8bd35af", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjU3M2M5ZDZmNGEyZTQ2OTI0OTI4OTQyNjZkMWQ5MzZiOGJkMzVhZg==", "commit": {"author": {"name": "Alessandro Fanfarillo", "email": "fanfarillo.gcc@gmail.com", "date": "2012-07-26T08:35:55Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2012-07-26T08:35:55Z"}, "message": "module.c (mio_array_spec): Don't read as->lower for assumed-rank arrays.\n\n2012-07-26  Alessandro Fanfarillo  <fanfarillo.gcc@gmail.com>\n            Tobias Burnus  <burnus@net-b.de>\n\n        * module.c (mio_array_spec): Don't read as->lower for\n        assumed-rank arrays.\n\n\nCo-Authored-By: Tobias Burnus <burnus@net-b.de>\n\nFrom-SVN: r189881", "tree": {"sha": "4262e3abbe0c445f21acc4975be1f3304a66a226", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4262e3abbe0c445f21acc4975be1f3304a66a226"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b573c9d6f4a2e4692492894266d1d936b8bd35af", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b573c9d6f4a2e4692492894266d1d936b8bd35af", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b573c9d6f4a2e4692492894266d1d936b8bd35af", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b573c9d6f4a2e4692492894266d1d936b8bd35af/comments", "author": null, "committer": null, "parents": [{"sha": "1fae9801e45958493870828b44c64726609c7500", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1fae9801e45958493870828b44c64726609c7500", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1fae9801e45958493870828b44c64726609c7500"}], "stats": {"total": 27, "additions": 21, "deletions": 6}, "files": [{"sha": "136f504bfea56799c97e093db3016c5c3489d818", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b573c9d6f4a2e4692492894266d1d936b8bd35af/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b573c9d6f4a2e4692492894266d1d936b8bd35af/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=b573c9d6f4a2e4692492894266d1d936b8bd35af", "patch": "@@ -1,3 +1,9 @@\n+2012-07-26  Alessandro Fanfarillo  <fanfarillo.gcc@gmail.com>\n+\t    Tobias Burnus  <burnus@net-b.de>\n+\n+\t* module.c (mio_array_spec): Don't read as->lower for\n+\tassumed-rank arrays.\n+\n 2012-07-25  Tobias Burnus  <burnus@net-b.de>\n \n \t* trans-types.c (gfc_real16_is_float128): Fix spelling"}, {"sha": "a4ff1998036672e12617c465c8bdb2981a2219ff", "filename": "gcc/fortran/module.c", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b573c9d6f4a2e4692492894266d1d936b8bd35af/gcc%2Ffortran%2Fmodule.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b573c9d6f4a2e4692492894266d1d936b8bd35af/gcc%2Ffortran%2Fmodule.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmodule.c?ref=b573c9d6f4a2e4692492894266d1d936b8bd35af", "patch": "@@ -2359,9 +2359,15 @@ mio_array_spec (gfc_array_spec **asp)\n \n   if (iomode == IO_OUTPUT)\n     {\n+      int rank;\n+\n       if (*asp == NULL)\n \tgoto done;\n       as = *asp;\n+\n+      /* mio_integer expects nonnegative values.  */\n+      rank = as->rank > 0 ? as->rank : 0;\n+      mio_integer (&rank);\n     }\n   else\n     {\n@@ -2372,20 +2378,23 @@ mio_array_spec (gfc_array_spec **asp)\n \t}\n \n       *asp = as = gfc_get_array_spec ();\n+      mio_integer (&as->rank);\n     }\n \n-  mio_integer (&as->rank);\n   mio_integer (&as->corank);\n   as->type = MIO_NAME (array_type) (as->type, array_spec_types);\n \n+  if (iomode == IO_INPUT && as->type == AS_ASSUMED_RANK)\n+    as->rank = -1;\n   if (iomode == IO_INPUT && as->corank)\n     as->cotype = (as->type == AS_DEFERRED) ? AS_DEFERRED : AS_EXPLICIT;\n \n-  for (i = 0; i < as->rank + as->corank; i++)\n-    {\n-      mio_expr (&as->lower[i]);\n-      mio_expr (&as->upper[i]);\n-    }\n+  if (as->rank > 0)\n+    for (i = 0; i < as->rank + as->corank; i++)\n+      {\n+\tmio_expr (&as->lower[i]);\n+\tmio_expr (&as->upper[i]);\n+      }\n \n done:\n   mio_rparen ();"}]}