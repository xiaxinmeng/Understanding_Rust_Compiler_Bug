{"sha": "84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODRjZjRhYjY1NTI5MjAzOGQxMzcxYTgwMWNiZmZiOWZjNmI2ZWNkMA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2013-09-10T11:47:19Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2013-09-10T11:47:19Z"}, "message": "re PR rtl-optimization/58365 (likely wrong code bug)\n\n\tPR rtl-optimization/58365\n\t* cfgcleanup.c (merge_memattrs): Also clear MEM_READONLY_P\n\tresp. MEM_NOTRAP_P if they differ, or set MEM_VOLATILE_P if\n\tit differs.\n\n\t* gcc.c-torture/execute/pr58365.c: New test.\n\nFrom-SVN: r202434", "tree": {"sha": "0381ed2becdbb7911d43100981e0d90f765e8049", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0381ed2becdbb7911d43100981e0d90f765e8049"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "447dd9066575a8b92bd0369b809978f71a5235e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/447dd9066575a8b92bd0369b809978f71a5235e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/447dd9066575a8b92bd0369b809978f71a5235e5"}], "stats": {"total": 65, "additions": 65, "deletions": 0}, "files": [{"sha": "cd91607f9b78bef9f3cc495219ce695946d201e6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "patch": "@@ -1,3 +1,10 @@\n+2013-09-10  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/58365\n+\t* cfgcleanup.c (merge_memattrs): Also clear MEM_READONLY_P\n+\tresp. MEM_NOTRAP_P if they differ, or set MEM_VOLATILE_P if\n+\tit differs.\n+\n 2013-09-10  Richard Biener  <rguenther@suse.de>\n \n \t* tree-data-ref.h (build_rdg): Drop all parameters but loop."}, {"sha": "e88fe2ed500c3aa78663c79f20f046adbe12a32f", "filename": "gcc/cfgcleanup.c", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2Fcfgcleanup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2Fcfgcleanup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgcleanup.c?ref=84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "patch": "@@ -925,6 +925,24 @@ merge_memattrs (rtx x, rtx y)\n \t  set_mem_align (y, MEM_ALIGN (x));\n \t}\n     }\n+  if (code == MEM)\n+    {\n+      if (MEM_READONLY_P (x) != MEM_READONLY_P (y))\n+\t{\n+\t  MEM_READONLY_P (x) = 0;\n+\t  MEM_READONLY_P (y) = 0;\n+\t}\n+      if (MEM_NOTRAP_P (x) != MEM_NOTRAP_P (y))\n+\t{\n+\t  MEM_NOTRAP_P (x) = 0;\n+\t  MEM_NOTRAP_P (y) = 0;\n+\t}\n+      if (MEM_VOLATILE_P (x) != MEM_VOLATILE_P (y))\n+\t{\n+\t  MEM_VOLATILE_P (x) = 1;\n+\t  MEM_VOLATILE_P (y) = 1;\n+\t}\n+    }\n \n   fmt = GET_RTX_FORMAT (code);\n   for (i = GET_RTX_LENGTH (code) - 1; i >= 0; i--)"}, {"sha": "fe91b24808fbbafdd8d84c139bcf227e8145291e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "patch": "@@ -1,3 +1,8 @@\n+2013-09-10  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR rtl-optimization/58365\n+\t* gcc.c-torture/execute/pr58365.c: New test.\n+\n 2013-09-10  Michael Zolotukhin  <michael.v.zolotukhin@gmail.com>\n \n \t* gcc.dg/torture/memcpy-1.c: New test."}, {"sha": "1e6079d8429af214f16ddd9d29d86d0083984eed", "filename": "gcc/testsuite/gcc.c-torture/execute/pr58365.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr58365.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84cf4ab655292038d1371a801cbffb9fc6b6ecd0/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr58365.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr58365.c?ref=84cf4ab655292038d1371a801cbffb9fc6b6ecd0", "patch": "@@ -0,0 +1,35 @@\n+/* PR rtl-optimization/58365 */\n+\n+extern void abort (void);\n+\n+struct S\n+{\n+  volatile int a;\n+  int b, c, d, e;\n+} f;\n+static struct S g, h;\n+int i = 1;\n+\n+char\n+foo (void)\n+{\n+  return i;\n+}\n+\n+static struct S\n+bar (void)\n+{\n+  if (foo ())\n+    return f;\n+  return g;\n+}\n+\n+int\n+main ()\n+{\n+  h = bar ();\n+  f.b = 1;\n+  if (h.b != 0)\n+    abort ();\n+  return 0;\n+}"}]}