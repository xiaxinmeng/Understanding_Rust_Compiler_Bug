{"sha": "d1b30231db49576afbb9780b51b1c6e1e2f2a8bd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDFiMzAyMzFkYjQ5NTc2YWZiYjk3ODBiNTFiMWM2ZTFlMmYyYThiZA==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@redhat.com", "date": "2001-08-22T05:47:35Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "2001-08-22T05:47:35Z"}, "message": "collate_byname.cc (test01): Fix.\n\n\n2001-08-21  Benjamin Kosnik  <bkoz@redhat.com>\n\n\t* testsuite/22_locale/collate_byname.cc (test01): Fix.\n\nFrom-SVN: r45094", "tree": {"sha": "31314980f34e9471b3607ea3eba5e78464fe766c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/31314980f34e9471b3607ea3eba5e78464fe766c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd/comments", "author": null, "committer": null, "parents": [{"sha": "b64d061e8060c5625d55d9f20aa3581c05b3cde3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b64d061e8060c5625d55d9f20aa3581c05b3cde3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b64d061e8060c5625d55d9f20aa3581c05b3cde3"}], "stats": {"total": 121, "additions": 94, "deletions": 27}, "files": [{"sha": "947980243669255b2668c9a5af04d8689a98e598", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=d1b30231db49576afbb9780b51b1c6e1e2f2a8bd", "patch": "@@ -1,3 +1,7 @@\n+2001-08-21  Benjamin Kosnik  <bkoz@redhat.com>\n+\n+\t* testsuite/22_locale/collate_byname.cc (test01): Fix.\n+\n 2001-08-18  Vladimir A Merzliakov  <wanderer@rsu.ru>\n \n \t* include/bits/locale_facets.tcc (collate::do_transform): Add typename."}, {"sha": "aacc333602e444ac0834a45cf5c0796920cbb997", "filename": "libstdc++-v3/testsuite/22_locale/collate_byname.cc", "status": "modified", "additions": 90, "deletions": 27, "changes": 117, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fcollate_byname.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1b30231db49576afbb9780b51b1c6e1e2f2a8bd/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fcollate_byname.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F22_locale%2Fcollate_byname.cc?ref=d1b30231db49576afbb9780b51b1c6e1e2f2a8bd", "patch": "@@ -35,38 +35,101 @@ void test01()\n   string str;\n   locale loc_c = locale::classic();\n \n-  locale loc_byname(locale::classic(), new collate_byname<char>(\"es_ES\"));\n+  locale loc_byname(locale::classic(), new collate_byname<char>(\"de_DE\"));\n   str = loc_byname.name();\n \n-  locale loc_es(\"es_ES\");\n-  str = loc_es.name();\n+  locale loc_de(\"de_DE\");\n+  str = loc_de.name();\n \n-  VERIFY( loc_es != loc_byname );\n+  VERIFY( loc_de != loc_byname );\n \n   // cache the collate facets\n-  const collate<char>& mssg_byname = use_facet<collate<char> >(loc_byname); \n-  const collate<char>& mssg_de = use_facet<collate<char> >(loc_es); \n-\n-#if 0\n-  // Check Spanish (es_ES) locale.\n-  catalog cat_de = mssg_de.open(\"libstdc++\", loc_c, dir);\n-  string s01 = mssg_de.get(cat_de, 0, 0, \"please\");\n-  string s02 = mssg_de.get(cat_de, 0, 0, \"thank you\");\n-  VERIFY ( s01 == \"bitte\" );\n-  VERIFY ( s02 == \"danke\" );\n-  mssg_de.close(cat_de);\n-\n-  // Check byname locale.\n-  catalog cat_byname = mssg_byname.open(\"libstdc++\", loc_c, dir);\n-  string s03 = mssg_byname.get(cat_de, 0, 0, \"please\");\n-  string s04 = mssg_byname.get(cat_de, 0, 0, \"thank you\");\n-  VERIFY ( s03 == \"bitte\" );\n-  VERIFY ( s04 == \"danke\" );\n-  mssg_byname.close(cat_byname);\n-\n-  VERIFY ( s01 == s03 );\n-  VERIFY ( s02 == s04 );\n-#endif\n+  const collate<char>& coll_byname = use_facet<collate<char> >(loc_byname); \n+  const collate<char>& coll_de = use_facet<collate<char> >(loc_de); \n+\n+  // Check German \"de_DE\" locale.\n+  int i1;\n+  int i2;\n+  long l1;\n+  long l2;\n+  const char* strlit3 = \"\ufffduglein Augment\"; // \"C\" == \"Augment \ufffduglein\"\n+  const char* strlit4 = \"Base ba\ufffd Ba\ufffd Bast\"; // \"C\" == \"Base ba\ufffd Ba\ufffd Bast\"\n+\n+  int size3 = strlen(strlit3) - 1;\n+  i1 = coll_de.compare(strlit3, strlit3 + size3, strlit3, strlit3 + 7);\n+  VERIFY ( i1 > 0 );\n+  i1 = coll_de.compare(strlit3, strlit3 + 7, strlit3, strlit3 + size3);\n+  VERIFY ( i1 < 0 );\n+  i1 = coll_de.compare(strlit3, strlit3 + 7, strlit3, strlit3 + 7);\n+  VERIFY ( i1 == 0 );\n+\n+  i1 = coll_de.compare(strlit3, strlit3 + 6, strlit3 + 8, strlit3 + 14);\n+  VERIFY ( i1 < 0 );\n+\n+  int size4 = strlen(strlit4) - 1;\n+  i2 = coll_de.compare(strlit4, strlit4 + size4, strlit4, strlit4 + 13);\n+  VERIFY ( i2 > 0 );\n+  i2 = coll_de.compare(strlit4, strlit4 + 13, strlit4, strlit4 + size4);\n+  VERIFY ( i2 < 0 );\n+  i2 = coll_de.compare(strlit4, strlit4 + size4, strlit4, strlit4 + size4);\n+  VERIFY ( i2 == 0 );\n+\n+  l1 = coll_de.hash(strlit3, strlit3 + size3);\n+  l2 = coll_de.hash(strlit3, strlit3 + size3 - 1);\n+  VERIFY ( l1 != l2 );\n+  l1 = coll_de.hash(strlit3, strlit3 + size3);\n+  l2 = coll_de.hash(strlit4, strlit4 + size4);\n+  VERIFY ( l1 != l2 );\n+\n+  string str3 = coll_de.transform(strlit3, strlit3 + size3);\n+  string str4 = coll_de.transform(strlit4, strlit4 + size4);\n+  i1 = coll_de.compare(str3.c_str(), str3.c_str() + size3,\n+\t\t       str4.c_str(), str4.c_str() + size4);\n+  i2 = coll_de.compare(strlit3, strlit3 + size3, strlit4, strlit4 + size4);\n+  VERIFY(i1 == i2);\n+\n+\n+  // Check byname locale\n+  int i3;\n+  int i4;\n+  long l3;\n+  long l4;\n+  size4 = strlen(strlit3) - 1;\n+  i3 = coll_de.compare(strlit3, strlit3 + size4, strlit3, strlit3 + 7);\n+  VERIFY ( i3 > 0 );\n+  i3 = coll_de.compare(strlit3, strlit3 + 7, strlit3, strlit3 + size4);\n+  VERIFY ( i3 < 0 );\n+  i3 = coll_de.compare(strlit3, strlit3 + 7, strlit3, strlit3 + 7);\n+  VERIFY ( i3 == 0 );\n+\n+  i3 = coll_de.compare(strlit3, strlit3 + 6, strlit3 + 8, strlit3 + 14);\n+  VERIFY ( i3 < 0 );\n+\n+  size4 = strlen(strlit4) - 1;\n+  i4 = coll_de.compare(strlit4, strlit4 + size4, strlit4, strlit4 + 13);\n+  VERIFY ( i4 > 0 );\n+  i4 = coll_de.compare(strlit4, strlit4 + 13, strlit4, strlit4 + size4);\n+  VERIFY ( i4 < 0 );\n+  i4 = coll_de.compare(strlit4, strlit4 + size4, strlit4, strlit4 + size4);\n+  VERIFY ( i4 == 0 );\n+\n+  l3 = coll_de.hash(strlit3, strlit3 + size4);\n+  l4 = coll_de.hash(strlit3, strlit3 + size4 - 1);\n+  VERIFY ( l3 != l4 );\n+  l3 = coll_de.hash(strlit3, strlit3 + size4);\n+  l4 = coll_de.hash(strlit4, strlit4 + size4);\n+  VERIFY ( l3 != l4 );\n+\n+  string str5 = coll_de.transform(strlit3, strlit3 + size4);\n+  string str6 = coll_de.transform(strlit4, strlit4 + size4);\n+  i3 = coll_de.compare(str5.c_str(), str5.c_str() + size4,\n+\t\t       str6.c_str(), str6.c_str() + size4);\n+  i4 = coll_de.compare(strlit3, strlit3 + size4, strlit4, strlit4 + size4);\n+  VERIFY(i3 == i4);\n+\n+  // Verify byname == de\n+  VERIFY ( str5 == str3 );\n+  VERIFY ( str6 == str4 );\n }\n \n int main()"}]}