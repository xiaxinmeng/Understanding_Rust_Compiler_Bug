{"sha": "1a78c1015f592b9a4fc2a99729c0f2ff976b6eee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWE3OGMxMDE1ZjU5MmI5YTRmYzJhOTk3MjljMGYyZmY5NzZiNmVlZQ==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-10-01T23:13:57Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-10-01T23:13:57Z"}, "message": "(bc_generate): New VMS DCL function.\n\n(bc_generate): New VMS DCL function.  Takes a BC\nheader file that needs to be generated, and builds it.\n\nCompile entries listed in BI_ALL.OPT, and then call\nbc_generate for every header file listed in BC_ALL.OPT\n\nFrom-SVN: r5553", "tree": {"sha": "f7f3b8b41433ce0010293a788b7e4a6603eae300", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f7f3b8b41433ce0010293a788b7e4a6603eae300"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a78c1015f592b9a4fc2a99729c0f2ff976b6eee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a78c1015f592b9a4fc2a99729c0f2ff976b6eee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a78c1015f592b9a4fc2a99729c0f2ff976b6eee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a78c1015f592b9a4fc2a99729c0f2ff976b6eee/comments", "author": null, "committer": null, "parents": [{"sha": "d029b00b2227ee261f24ede543bccde1a8fe8a8d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d029b00b2227ee261f24ede543bccde1a8fe8a8d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d029b00b2227ee261f24ede543bccde1a8fe8a8d"}], "stats": {"total": 53, "additions": 53, "deletions": 0}, "files": [{"sha": "7d4350b0e63d7be769b9f24f66665b0478c79bff", "filename": "gcc/make-cc1.com", "status": "modified", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a78c1015f592b9a4fc2a99729c0f2ff976b6eee/gcc%2Fmake-cc1.com", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a78c1015f592b9a4fc2a99729c0f2ff976b6eee/gcc%2Fmake-cc1.com", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmake-cc1.com?ref=1a78c1015f592b9a4fc2a99729c0f2ff976b6eee", "patch": "@@ -57,6 +57,9 @@ $!\n $!\tINDEPENDENT:\n $!\t\tCompile language independent source modules. (On by default).\n $!\n+$!\tBC:\n+$!\t\tCompile byte compiler source modules. (On by default).\n+$!\n $!\tDEBUG:\tLink images with /debug.\n $!\n $! If you want to list more than one option, you should use a spaces to\n@@ -84,6 +87,7 @@ $goto cinit\n $cinit_done: close cfile$\n $DO_INDEPENDENT = 1\n $DO_DEFAULT = 1\n+$DO_BC = 1\n $loop:\n $string = f$element(i,\" \",p1)\n $if string.eqs.\" \" then goto done\n@@ -108,6 +112,7 @@ $if DO_CC1.eq.1 then echo \"   Compile C specific object modules.\"\n $if DO_CC1PLUS.eq.1 then echo \"   Compile C++ specific object modules.\"\n $if DO_CC1OBJ.eq.1 then echo \"   Compile obj-C specific object modules.\"\n $if DO_INDEPENDENT.eq.1 then echo \"   Compile language independent object modules.\"\n+$if DO_BC.eq.1 then echo \"   Compile byte compiler object modules.\"\n $link_only:\n $if DO_CC1.eq.1 then\techo \"   Link C compiler (gcc-cc1.exe).\"\n $if DO_CC1PLUS.eq.1 then echo \"   Link C++ compiler (gcc-cc1plus.exe).\"\n@@ -144,6 +149,24 @@ $!\n $ if DO_DEBUG.eq.1 then LDFLAGS :='LDFLAGS'/debug\n $!\n $if DO_LINK.eq.1 then goto compile_cc1\n+$!\n+$if DO_BC.eq.1 \n+$\tTHEN \n+$\tcall compile bi_all.opt \"\"\n+$\topen ifile$ bc_all.opt\n+$\tread ifile$ bc_line\n+$\tclose ifile$\n+$\tbc_index = 0\n+$bc_loop:\n+$\ttfile = f$element(bc_index, \" \", bc_line)\n+$\tif tfile.eqs.\" \" then goto bc_done\n+$\tcall bc_generate 'tfile' \"bi_all.opt/opt,\"\n+$\tbc_index = bc_index + 1\n+$\tgoto bc_loop\n+$bc_done:\n+$\tendif\n+$!\n+$!\n $if DO_INDEPENDENT.eq.1 \n $\tTHEN \n $!\n@@ -359,3 +382,33 @@ $\tassign/user 'p1' sys$output:\n $\tmcr sys$disk:[]GEN'root1' md\n $!'f$verify(0)\n $endsubroutine\n+$!\n+$! This subroutine generates the bc-* files.  The first argument is the\n+$! name of the bc-* file to generate.  The second argument contains a \n+$! list of any other object modules which must be linked to the gen*.c\n+$! program.\n+$!\n+$! If a previous version of bc-* exists, it is compared to the new one,\n+$! and if it has not changed, then the new one is discarded.  This is\n+$! done so that make like programs do not get thrown off.\n+$!\n+$bc_generate:\n+$subroutine\n+$if f$extract(0,3,p1).nes.\"BC-\"\n+$\tthen\n+$\twrite sys$error \"Unknown file passed to generate.\"\n+$\texit 1\n+$\tendif\n+$root1=f$parse(f$extract(3,255,p1),,,\"NAME\")\n+$\tset verify\n+$ 'CC 'CFLAGS BI-'root1'.C\n+$ link 'LDFLAGS' BI-'root1','p2' -\n+\t  'LIBS'\n+$!\t'f$verify(0)\n+$!\n+$set verify\n+$\tassign/user bytecode.def sys$input:\n+$\tassign/user 'p1' sys$output:\n+$\tmcr sys$disk:[]BI-'root1'\n+$!'f$verify(0)\n+$endsubroutine"}]}