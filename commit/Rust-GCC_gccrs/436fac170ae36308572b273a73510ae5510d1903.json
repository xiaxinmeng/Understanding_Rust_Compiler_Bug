{"sha": "436fac170ae36308572b273a73510ae5510d1903", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDM2ZmFjMTcwYWUzNjMwODU3MmIyNzNhNzM1MTBhZTU1MTBkMTkwMw==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2003-09-28T22:18:33Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2003-09-28T22:18:33Z"}, "message": "c-decl.c (duplicate_decls): Copy DECL_SOURCE_LOCATION, not file and line separately.\n\n        * c-decl.c (duplicate_decls): Copy DECL_SOURCE_LOCATION, not\n        file and line separately.\n\nf/\n        * com.c (duplicate_decls): Copy DECL_SOURCE_LOCATION, not\n        file and line separately.\njava/\n        * check-init.c (check_init): Save and restore input_location\n        instead of file and line separately.\n        * decl.c (java_expand_body): Likewise.\n        * jcf-write.c (generate_bytecode_insns): Likewise.\n        * parse.y (safe_layout_class): Likewise.\n        * jcf-parse.c (read_class, parse_class_file): Likewise.\n        (java_parse_file): Use %H for warning locator.\n\nFrom-SVN: r71886", "tree": {"sha": "92931566ca86595833d4e800dfd6d8299effef0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/92931566ca86595833d4e800dfd6d8299effef0c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/436fac170ae36308572b273a73510ae5510d1903", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/436fac170ae36308572b273a73510ae5510d1903", "html_url": "https://github.com/Rust-GCC/gccrs/commit/436fac170ae36308572b273a73510ae5510d1903", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/436fac170ae36308572b273a73510ae5510d1903/comments", "author": null, "committer": null, "parents": [{"sha": "b2ba71cad84307d8493518fb97e19f367578dc05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2ba71cad84307d8493518fb97e19f367578dc05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2ba71cad84307d8493518fb97e19f367578dc05"}], "stats": {"total": 76, "additions": 41, "deletions": 35}, "files": [{"sha": "098aef0fdd70b6fdc2eac4d2afdc15d8d1b461a8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -1,3 +1,8 @@\n+2003-09-28  Richard Henderson  <rth@redhat.com>\n+\n+\t* c-decl.c (duplicate_decls): Copy DECL_SOURCE_LOCATION, not\n+\tfile and line separately.\n+\n 2003-09-28  Ulrich Weigand  <uweigand@de.ibm.com>\n \n \t* config/s390/s390.md (\"*adddi3_carry1_cc\", \"*adddi3_carry1_cconly\","}, {"sha": "69110efa4778caf223fa5e4543343e15c736b3c6", "filename": "gcc/c-decl.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -1305,10 +1305,7 @@ duplicate_decls (tree newdecl, tree olddecl, int different_binding_level,\n \t information so that meaningful diagnostics can be given.  */\n       if (DECL_INITIAL (newdecl) == 0 && DECL_INITIAL (olddecl) != 0\n \t  && ! different_binding_level)\n-\t{\n-\t  DECL_SOURCE_LINE (newdecl) = DECL_SOURCE_LINE (olddecl);\n-\t  DECL_SOURCE_FILE (newdecl) = DECL_SOURCE_FILE (olddecl);\n-\t}\n+\tDECL_SOURCE_LOCATION (newdecl) = DECL_SOURCE_LOCATION (olddecl);\n \n       /* Merge the unused-warning information.  */\n       if (DECL_IN_SYSTEM_HEADER (olddecl))"}, {"sha": "e97a71097c7a0a9ce844ea3a5dbd0a9748f0b9f9", "filename": "gcc/f/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Ff%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Ff%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2FChangeLog?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -1,3 +1,8 @@\n+2003-09-28  Richard Henderson  <rth@redhat.com>\n+\n+\t* com.c (duplicate_decls): Copy DECL_SOURCE_LOCATION, not\n+\tfile and line separately.\n+\n 2003-09-21  Richard Henderson  <rth@redhat.com>\n \n \t* com.c, ste.c: Revert."}, {"sha": "e992cb90b773c1b84946e5f2af7af18bac9a908e", "filename": "gcc/f/com.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Ff%2Fcom.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Ff%2Fcom.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ff%2Fcom.c?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -13297,8 +13297,7 @@ duplicate_decls (tree newdecl, tree olddecl)\n       if ((DECL_INITIAL (newdecl) == 0 && DECL_INITIAL (olddecl) != 0)\n \t  || (DECL_CONTEXT (newdecl) != 0 && DECL_CONTEXT (olddecl) == 0))\n \t{\n-\t  DECL_SOURCE_LINE (newdecl) = DECL_SOURCE_LINE (olddecl);\n-\t  DECL_SOURCE_FILE (newdecl) = DECL_SOURCE_FILE (olddecl);\n+\t  DECL_SOURCE_LOCATION (newdecl) = DECL_SOURCE_LOCATION (olddecl);\n \n \t  if (DECL_CONTEXT (olddecl) == 0\n \t      && TREE_CODE (newdecl) != FUNCTION_DECL)"}, {"sha": "f2a990cdf6288c76f477f3717b5fb229d41b1429", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -1,3 +1,13 @@\n+2003-09-28  Richard Henderson  <rth@redhat.com>\n+\n+\t* check-init.c (check_init): Save and restore input_location\n+\tinstead of file and line separately.\n+\t* decl.c (java_expand_body): Likewise.\n+\t* jcf-write.c (generate_bytecode_insns): Likewise.\n+\t* parse.y (safe_layout_class): Likewise.\n+\t* jcf-parse.c (read_class, parse_class_file): Likewise.\n+\t(java_parse_file): Use %H for warning locator.\n+\n 2003-09-28  Roger Sayle  <roger@eyesopen.com>\n \n \t* expr.c (java_check_reference): Use the semantics of COND_EXPRs"}, {"sha": "c4e394844100835bcb87f9752f63d61cf947c0db", "filename": "gcc/java/check-init.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fcheck-init.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fcheck-init.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fcheck-init.c?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -886,18 +886,16 @@ check_init (tree exp, words before)\n \n     case EXPR_WITH_FILE_LOCATION:\n       {\n-\tconst char *saved_input_filename = input_filename;\n+\tlocation_t saved_location = input_location;\n \ttree saved_wfl = wfl;\n \ttree body = EXPR_WFL_NODE (exp);\n-\tint saved_lineno = input_line;\n \tif (body == empty_stmt_node)\n \t  break;\n \twfl = exp;\n \tinput_filename = EXPR_WFL_FILENAME (exp);\n \tinput_line = EXPR_WFL_LINENO (exp);\n \tcheck_init (body, before);\n-\tinput_filename = saved_input_filename;\n-\tinput_line = saved_lineno;\n+\tinput_location = saved_location;\n \twfl = saved_wfl;\n       }\n       break;"}, {"sha": "4e413de897d1db5ebffe486f032551928d98f7fe", "filename": "gcc/java/decl.c", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fdecl.c?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -1816,12 +1816,10 @@ end_java_method (void)\n void\n java_expand_body (tree fndecl)\n {\n-  const char *saved_input_filename = input_filename;\n-  int saved_lineno = input_line;\n+  location_t saved_location = input_location;\n \n   current_function_decl = fndecl;\n-  input_filename = DECL_SOURCE_FILE (fndecl);\n-  input_line = DECL_SOURCE_LINE (fndecl);\n+  input_location = DECL_SOURCE_LOCATION (fndecl);\n \n   timevar_push (TV_EXPAND);\n \n@@ -1858,8 +1856,7 @@ java_expand_body (tree fndecl)\n \n   timevar_pop (TV_EXPAND);\n \n-  input_filename = saved_input_filename;\n-  input_line = saved_lineno;\n+  input_location = saved_location;\n \n   current_function_decl = NULL_TREE;\n }"}, {"sha": "4abd6ceac6efbc2ef58b2600a6a51aebabb93c08", "filename": "gcc/java/jcf-parse.c", "status": "modified", "additions": 10, "deletions": 11, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fjcf-parse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fjcf-parse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fjcf-parse.c?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -472,7 +472,7 @@ read_class (tree name)\n   JCF this_jcf, *jcf;\n   tree icv, class = NULL_TREE;\n   tree save_current_class = current_class;\n-  const char *save_input_filename = input_filename;\n+  location_t save_location = input_location;\n   JCF *save_current_jcf = current_jcf;\n \n   if ((icv = IDENTIFIER_CLASS_VALUE (name)) != NULL_TREE)\n@@ -550,7 +550,7 @@ read_class (tree name)\n     }\n \n   current_class = save_current_class;\n-  input_filename = save_input_filename;\n+  input_location = save_location;\n   current_jcf = save_current_jcf;\n   return 1;\n }\n@@ -703,8 +703,7 @@ static void\n parse_class_file (void)\n {\n   tree method;\n-  const char *save_input_filename = input_filename;\n-  int save_lineno = input_line;\n+  location_t save_location = input_location;\n \n   java_layout_seen_class_methods ();\n \n@@ -799,9 +798,8 @@ parse_class_file (void)\n \n   finish_class ();\n \n-  (*debug_hooks->end_source_file) (save_lineno);\n-  input_filename = save_input_filename;\n-  input_line = save_lineno;\n+  (*debug_hooks->end_source_file) (save_location.line);\n+  input_location = save_location;\n }\n \n /* Parse a source file, as pointed by the current value of INPUT_FILENAME. */\n@@ -984,10 +982,11 @@ java_parse_file (int set_yydebug ATTRIBUTE_UNUSED)\n \n \t  if (twice)\n \t    {\n-\t      const char *saved_input_filename = input_filename;\n-\t      input_filename = value;\n-\t      warning (\"source file seen twice on command line and will be compiled only once\");\n-\t      input_filename = saved_input_filename;\n+\t      location_t warn_loc;\n+\t      warn_loc.file = value;\n+\t      warn_loc.line = 0;\n+\t      warning (\"%Hsource file seen twice on command line and \"\n+\t\t       \"will be compiled only once\", &warn_loc);\n \t    }\n \t  else\n \t    {"}, {"sha": "b4a9e1b68768f4827c607a1b1d6143c29e69a738", "filename": "gcc/java/jcf-write.c", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fjcf-write.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fjcf-write.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fjcf-write.c?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -1417,9 +1417,8 @@ generate_bytecode_insns (tree exp, int target, struct jcf_partial *state)\n       break;\n     case EXPR_WITH_FILE_LOCATION:\n       {\n-\tconst char *saved_input_filename = input_filename;\n+\tlocation_t saved_location = input_location;\n \ttree body = EXPR_WFL_NODE (exp);\n-\tint saved_lineno = input_line;\n \tif (body == empty_stmt_node)\n \t  break;\n \tinput_filename = EXPR_WFL_FILENAME (exp);\n@@ -1428,8 +1427,7 @@ generate_bytecode_insns (tree exp, int target, struct jcf_partial *state)\n \t    && debug_info_level > DINFO_LEVEL_NONE)\n \t  put_linenumber (input_line, state);\n \tgenerate_bytecode_insns (body, target, state);\n-\tinput_filename = saved_input_filename;\n-\tinput_line = saved_lineno;\n+\tinput_location = saved_location;\n       }\n       break;\n     case INTEGER_CST:"}, {"sha": "541e2b2429ac70140d7c5e266f7c34e26aa896a8", "filename": "gcc/java/parse.y", "status": "modified", "additions": 2, "deletions": 4, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fparse.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/436fac170ae36308572b273a73510ae5510d1903/gcc%2Fjava%2Fparse.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fparse.y?ref=436fac170ae36308572b273a73510ae5510d1903", "patch": "@@ -5461,14 +5461,12 @@ void\n safe_layout_class (tree class)\n {\n   tree save_current_class = current_class;\n-  const char *save_input_filename = input_filename;\n-  int save_lineno = input_line;\n+  location_t save_location = input_location;\n \n   layout_class (class);\n \n   current_class = save_current_class;\n-  input_filename = save_input_filename;\n-  input_line = save_lineno;\n+  input_location = save_location;\n }\n \n static tree"}]}