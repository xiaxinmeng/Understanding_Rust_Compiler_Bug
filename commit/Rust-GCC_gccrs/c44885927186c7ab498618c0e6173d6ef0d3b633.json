{"sha": "c44885927186c7ab498618c0e6173d6ef0d3b633", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzQ0ODg1OTI3MTg2YzdhYjQ5ODYxOGMwZTYxNzNkNmVmMGQzYjYzMw==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2020-08-12T21:30:29Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "derodat@adacore.com", "date": "2020-10-22T12:11:19Z"}, "message": "[Ada] AI12-0307: uniform resolution rules for aggregates\n\ngcc/ada/\n\n\t* sem_util.ads, sem_util.adb (Check_Ambiguous_Aggregate): When a\n\tsubprogram call is found to be ambiguous, check whether\n\tambiguity is caused by an aggregate actual.  and indicate that\n\tit should carry a type qualification.\n\t* sem_ch4.adb (Traverse_Hoonyms, Try_Primitive_Operation): Call\n\tit.\n\t* sem_res.adb (Report_Ambiguous_Argument): Call it.", "tree": {"sha": "5667ee597c6a698a50af8344645071dbd0eca186", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5667ee597c6a698a50af8344645071dbd0eca186"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c44885927186c7ab498618c0e6173d6ef0d3b633", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c44885927186c7ab498618c0e6173d6ef0d3b633", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c44885927186c7ab498618c0e6173d6ef0d3b633", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c44885927186c7ab498618c0e6173d6ef0d3b633/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": {"login": "pmderodat", "id": 758452, "node_id": "MDQ6VXNlcjc1ODQ1Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/758452?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pmderodat", "html_url": "https://github.com/pmderodat", "followers_url": "https://api.github.com/users/pmderodat/followers", "following_url": "https://api.github.com/users/pmderodat/following{/other_user}", "gists_url": "https://api.github.com/users/pmderodat/gists{/gist_id}", "starred_url": "https://api.github.com/users/pmderodat/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pmderodat/subscriptions", "organizations_url": "https://api.github.com/users/pmderodat/orgs", "repos_url": "https://api.github.com/users/pmderodat/repos", "events_url": "https://api.github.com/users/pmderodat/events{/privacy}", "received_events_url": "https://api.github.com/users/pmderodat/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "1c583927a57a06e9f94de4c982ae827d227543ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c583927a57a06e9f94de4c982ae827d227543ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c583927a57a06e9f94de4c982ae827d227543ab"}], "stats": {"total": 38, "additions": 37, "deletions": 1}, "files": [{"sha": "30c977f4effde2161f9d54b8205e9c843cf97ca7", "filename": "gcc/ada/sem_ch4.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_ch4.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_ch4.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch4.adb?ref=c44885927186c7ab498618c0e6173d6ef0d3b633", "patch": "@@ -9339,6 +9339,7 @@ package body Sem_Ch4 is\n                         Error_Msg_NE (\"ambiguous call to&\", N, Hom);\n                         Report_Ambiguity (Matching_Op);\n                         Report_Ambiguity (Hom);\n+                        Check_Ambiguous_Aggregate (New_Call_Node);\n                         Error := True;\n                         return;\n                      end if;\n@@ -9961,6 +9962,7 @@ package body Sem_Ch4 is\n                      Error_Msg_NE (\"ambiguous call to&\", N, Prim_Op);\n                      Report_Ambiguity (Matching_Op);\n                      Report_Ambiguity (Prim_Op);\n+                     Check_Ambiguous_Aggregate (Call_Node);\n                      return True;\n                   end if;\n                end if;"}, {"sha": "47c743d01ef7f56adece9421bb912fbd6b1a13ff", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=c44885927186c7ab498618c0e6173d6ef0d3b633", "patch": "@@ -2097,7 +2097,8 @@ package body Sem_Res is\n          then\n             Error_Msg_NE (\"ambiguous call to&\", Arg, Name (Arg));\n \n-            --  Could use comments on what is going on here???\n+            --  Examine possible interpretations, and adapt the message\n+            --  for inherited subprograms declared by a type derivation.\n \n             Get_First_Interp (Name (Arg), I, It);\n             while Present (It.Nam) loop\n@@ -2112,6 +2113,11 @@ package body Sem_Res is\n                Get_Next_Interp (I, It);\n             end loop;\n          end if;\n+\n+         --  Additional message and hint if the ambiguity involves an Ada2020\n+         --  container aggregate.\n+\n+         Check_Ambiguous_Aggregate (N);\n       end Report_Ambiguous_Argument;\n \n       -----------------------"}, {"sha": "9930eb6658e1e19d9da1936051f1dd3bad36a5eb", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=c44885927186c7ab498618c0e6173d6ef0d3b633", "patch": "@@ -2425,6 +2425,27 @@ package body Sem_Util is\n       end if;\n    end Cannot_Raise_Constraint_Error;\n \n+   -------------------------------\n+   -- Check_Ambiguous_Aggregate --\n+   -------------------------------\n+\n+   procedure Check_Ambiguous_Aggregate (Call : Node_Id) is\n+      Actual : Node_Id;\n+\n+   begin\n+      if Extensions_Allowed then\n+         Actual := First_Actual (Call);\n+         while Present (Actual) loop\n+            if Nkind (Actual) = N_Aggregate then\n+               Error_Msg_N\n+                 (\"\\add type qualification to aggregate actual\", Actual);\n+               exit;\n+            end if;\n+            Next_Actual (Actual);\n+         end loop;\n+      end if;\n+   end Check_Ambiguous_Aggregate;\n+\n    -----------------------------------------\n    -- Check_Dynamically_Tagged_Expression --\n    -----------------------------------------"}, {"sha": "9030279b215ed67d956c93b2ab7be02f3dff81ad", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c44885927186c7ab498618c0e6173d6ef0d3b633/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=c44885927186c7ab498618c0e6173d6ef0d3b633", "patch": "@@ -349,6 +349,13 @@ package Sem_Util is\n    --  not necessarily mean that CE could be raised, but a response of True\n    --  means that for sure CE cannot be raised.\n \n+   procedure Check_Ambiguous_Aggregate (Call : Node_Id);\n+   --  Additional information on an ambiguous call in Ada_2020 when a\n+   --  subprogram call has an actual that is an aggregate, and the\n+   --  presence of container aggregates (or types with the correwponding\n+   --  aspect)  provides an additional interpretation. Message indicates\n+   --  that an aggregate actual should carry a type qualification.\n+\n    procedure Check_Dynamically_Tagged_Expression\n      (Expr        : Node_Id;\n       Typ         : Entity_Id;"}]}