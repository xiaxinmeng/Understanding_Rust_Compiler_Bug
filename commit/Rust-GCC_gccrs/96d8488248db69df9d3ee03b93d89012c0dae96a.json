{"sha": "96d8488248db69df9d3ee03b93d89012c0dae96a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTZkODQ4ODI0OGRiNjlkZjlkM2VlMDNiOTNkODkwMTJjMGRhZTk2YQ==", "commit": {"author": {"name": "Paolo Bonzini", "email": "bonzini@gnu.org", "date": "2008-03-07T11:47:20Z"}, "committer": {"name": "Paolo Bonzini", "email": "bonzini@gcc.gnu.org", "date": "2008-03-07T11:47:20Z"}, "message": "revert: re PR c++/35049 (g++.dg/conversion/simd3.C:12: error: invalid operands to binary + (have 'float __vector__' and 'int __vector__'))\n\ncp:\n2008-03-07  Paolo Bonzini  <bonzini@gnu.org>\n\n\tRevert:\n\n\t2008-02-06  Douglas Gregor  <doug.gregor@gmail.com>\n\n\tPR c++/35049\n\tPR c++/35096\n\t* typeck.c (structural_comptypes): Call cp_comptypes.\n\t(comptypes): New; called from the C/C++ common bits to perform\n\tstrict checks.\n\t(cp_comptypes): Renamed from comptypes, which is already used,\n\twith a different signature, by the C++ front end.\n\t(build_reinterpret_cast_1): Call cp_comptypes.\n\t(ptr_reasonably_similar): Ditto.\n\t* decl.c (decls_match): Ditto.\n\t* cvt.c (convert_to_reference): Ditto.\n\t* cp-tree.h (same_type_p): Ditto.\n\t(same_or_base_type_p): Ditto.\n\t(comptypes): Rename to cp_comptypes.\n\t* pt.c (canonical_type_parameter): Call cp_comptypes.\n\nobjcp:\n2008-03-07  Paolo Bonzini  <bonzini@gnu.org>\n\n\tRevert:\n\n\t2008-02-07  Andreas Tobler  <andreast-list@fgznet.ch>\n\t            Douglas Gregor  <doug.gregor@gmail.com>\n \n\tPR bootstrap/35115\n\t* objcp-decl.c (objcp_comptypes): Call cp_comptypes, not comptypes.\n\nFrom-SVN: r133007", "tree": {"sha": "8cc35bd53af5f9634b1ff4aba1a8fca93de14f26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8cc35bd53af5f9634b1ff4aba1a8fca93de14f26"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/96d8488248db69df9d3ee03b93d89012c0dae96a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96d8488248db69df9d3ee03b93d89012c0dae96a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/96d8488248db69df9d3ee03b93d89012c0dae96a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96d8488248db69df9d3ee03b93d89012c0dae96a/comments", "author": {"login": "bonzini", "id": 42082, "node_id": "MDQ6VXNlcjQyMDgy", "avatar_url": "https://avatars.githubusercontent.com/u/42082?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bonzini", "html_url": "https://github.com/bonzini", "followers_url": "https://api.github.com/users/bonzini/followers", "following_url": "https://api.github.com/users/bonzini/following{/other_user}", "gists_url": "https://api.github.com/users/bonzini/gists{/gist_id}", "starred_url": "https://api.github.com/users/bonzini/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bonzini/subscriptions", "organizations_url": "https://api.github.com/users/bonzini/orgs", "repos_url": "https://api.github.com/users/bonzini/repos", "events_url": "https://api.github.com/users/bonzini/events{/privacy}", "received_events_url": "https://api.github.com/users/bonzini/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "31908b799e741f54c2f0ca8c27348e8d74d93694", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31908b799e741f54c2f0ca8c27348e8d74d93694", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31908b799e741f54c2f0ca8c27348e8d74d93694"}], "stats": {"total": 95, "additions": 58, "deletions": 37}, "files": [{"sha": "6415063aa7912dc713239e67d4e1b644d74ab11d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -1,3 +1,25 @@\n+2008-03-07  Paolo Bonzini  <bonzini@gnu.org>\n+\n+\tRevert:\n+\n+\t2008-02-06  Douglas Gregor  <doug.gregor@gmail.com>\n+\n+\tPR c++/35049\n+\tPR c++/35096\n+\t* typeck.c (structural_comptypes): Call cp_comptypes.\n+\t(comptypes): New; called from the C/C++ common bits to perform\n+\tstrict checks.\n+\t(cp_comptypes): Renamed from comptypes, which is already used,\n+\twith a different signature, by the C++ front end.\n+\t(build_reinterpret_cast_1): Call cp_comptypes.\n+\t(ptr_reasonably_similar): Ditto.\n+\t* decl.c (decls_match): Ditto.\n+\t* cvt.c (convert_to_reference): Ditto.\n+\t* cp-tree.h (same_type_p): Ditto.\n+\t(same_or_base_type_p): Ditto.\n+\t(comptypes): Rename to cp_comptypes.\n+\t* pt.c (canonical_type_parameter): Call cp_comptypes.\n+\n 2008-03-07  Paolo Bonzini  <bonzini@gnu.org>\n \n \t* cp-objcp-common.c (cxx_types_compatible_p): Remove obsolete"}, {"sha": "4f1a34b404c8cdcc83a5ac8c3893f5cb7f11090f", "filename": "gcc/cp/cp-tree.h", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fcp-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fcp-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-tree.h?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -281,7 +281,7 @@ typedef struct ptrmem_cst * ptrmem_cst_t;\n /* Returns nonzero iff TYPE1 and TYPE2 are the same type, in the usual\n    sense of `same'.  */\n #define same_type_p(TYPE1, TYPE2) \\\n-  cp_comptypes ((TYPE1), (TYPE2), COMPARE_STRICT)\n+  comptypes ((TYPE1), (TYPE2), COMPARE_STRICT)\n \n /* Returns nonzero iff TYPE1 and TYPE2 are the same type, ignoring\n    top-level qualifiers.  */\n@@ -3744,7 +3744,7 @@ enum overload_flags { NO_SPECIAL = 0, DTOR_FLAG, OP_FLAG, TYPENAME_FLAG };\n #define WANT_VECTOR    32 /* vector types */\n #define WANT_ARITH\t(WANT_INT | WANT_FLOAT | WANT_VECTOR)\n \n-/* Used with cp_comptypes, and related functions, to guide type\n+/* Used with comptypes, and related functions, to guide type\n    comparison.  */\n \n #define COMPARE_STRICT\t      0 /* Just check if the types are the\n@@ -3780,7 +3780,7 @@ enum overload_flags { NO_SPECIAL = 0, DTOR_FLAG, OP_FLAG, TYPENAME_FLAG };\n    is derived from TYPE1, or if TYPE2 is a pointer (reference) to a\n    class derived from the type pointed to (referred to) by TYPE1.  */\n #define same_or_base_type_p(TYPE1, TYPE2) \\\n-  cp_comptypes ((TYPE1), (TYPE2), COMPARE_BASE)\n+  comptypes ((TYPE1), (TYPE2), COMPARE_BASE)\n \n /* These macros are used to access a TEMPLATE_PARM_INDEX.  */\n #define TEMPLATE_PARM_INDEX_CAST(NODE) \\\n@@ -4765,7 +4765,7 @@ extern tree complete_type\t\t\t(tree);\n extern tree complete_type_or_else\t\t(tree, tree);\n extern int type_unknown_p\t\t\t(const_tree);\n extern bool comp_except_specs\t\t\t(const_tree, const_tree, bool);\n-extern bool cp_comptypes\t\t\t(tree, tree, int);\n+extern bool comptypes\t\t\t\t(tree, tree, int);\n extern bool compparms\t\t\t\t(const_tree, const_tree);\n extern int comp_cv_qualification\t\t(const_tree, const_tree);\n extern int comp_cv_qual_signature\t\t(tree, tree);"}, {"sha": "2911fea06432ef249ff6b84515b9efcdc2757091", "filename": "gcc/cp/cvt.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcvt.c?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -465,8 +465,8 @@ convert_to_reference (tree reftype, tree expr, int convtype,\n       /* B* bp; A& ar = (A&)bp; is valid, but it's probably not what they\n \t meant.  */\n       if (TREE_CODE (intype) == POINTER_TYPE\n-\t  && (cp_comptypes (TREE_TYPE (intype), type,\n-                            COMPARE_BASE | COMPARE_DERIVED)))\n+\t  && (comptypes (TREE_TYPE (intype), type,\n+\t\t\t COMPARE_BASE | COMPARE_DERIVED)))\n \twarning (0, \"casting %qT to %qT does not dereference pointer\",\n \t\t intype, reftype);\n \n@@ -604,7 +604,7 @@ ocp_convert (tree type, tree expr, int convtype, int flags)\n \t/* The call to fold will not always remove the NOP_EXPR as\n \t   might be expected, since if one of the types is a typedef;\n \t   the comparison in fold is just equality of pointers, not a\n-\t   call to cp_comptypes.  We don't call fold in this case because\n+\t   call to comptypes.  We don't call fold in this case because\n \t   that can result in infinite recursion; fold will call\n \t   convert, which will call ocp_convert, etc.  */\n \treturn e;"}, {"sha": "a9b068c655e10b66309a491a70bb63750ca2a7cf", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -1010,9 +1010,9 @@ decls_match (tree newdecl, tree olddecl)\n       else if (TREE_TYPE (newdecl) == NULL_TREE)\n \ttypes_match = 0;\n       else\n-\ttypes_match = cp_comptypes (TREE_TYPE (newdecl),\n-                                    TREE_TYPE (olddecl),\n-                                    COMPARE_REDECLARATION);\n+\ttypes_match = comptypes (TREE_TYPE (newdecl),\n+\t\t\t\t TREE_TYPE (olddecl),\n+\t\t\t\t COMPARE_REDECLARATION);\n     }\n \n   return types_match;"}, {"sha": "d03ea9f2c3856412934d05204dc17397efd728fe", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -2891,7 +2891,7 @@ canonical_type_parameter (tree type)\n     VEC_safe_push (tree, gc, canonical_template_parms, NULL_TREE);\n \n   list = VEC_index (tree, canonical_template_parms, idx);\n-  while (list && !cp_comptypes (type, TREE_VALUE (list), COMPARE_STRUCTURAL))\n+  while (list && !comptypes (type, TREE_VALUE (list), COMPARE_STRUCTURAL))\n     list = TREE_CHAIN (list);\n \n   if (list)"}, {"sha": "d0eaf981a8a8ab583512ad0684a49343a2344685", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 14, "deletions": 25, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -160,7 +160,7 @@ type_unknown_p (const_tree exp)\n \n \f\n /* Return the common type of two parameter lists.\n-   We assume that cp_comptypes has already been done and returned 1;\n+   We assume that comptypes has already been done and returned 1;\n    if that isn't so, this may crash.\n \n    As an optimization, free the space we allocate if the parameter\n@@ -573,7 +573,7 @@ composite_pointer_type (tree t1, tree t2, tree arg1, tree arg2,\n }\n \n /* Return the merged type of two types.\n-   We assume that cp_comptypes has already been done and returned 1;\n+   We assume that comptypes has already been done and returned 1;\n    if that isn't so, this may crash.\n \n    This just combines attributes and default arguments; any other\n@@ -735,7 +735,7 @@ merge_types (tree t1, tree t2)\n }\n \n /* Return the common type of two types.\n-   We assume that cp_comptypes has already been done and returned 1;\n+   We assume that comptypes has already been done and returned 1;\n    if that isn't so, this may crash.\n \n    This is the type for the result of most arithmetic operations\n@@ -926,7 +926,7 @@ comp_array_types (const_tree t1, const_tree t2, bool allow_redeclaration)\n   return true;\n }\n \n-/* Subroutine in cp_comptypes.  */\n+/* Subroutine in comptypes.  */\n \n static bool\n structural_comptypes (tree t1, tree t2, int strict)\n@@ -1034,8 +1034,8 @@ structural_comptypes (tree t1, tree t2, int strict)\n       return false;\n \n     case OFFSET_TYPE:\n-      if (!cp_comptypes (TYPE_OFFSET_BASETYPE (t1), TYPE_OFFSET_BASETYPE (t2),\n-                         strict & ~COMPARE_REDECLARATION))\n+      if (!comptypes (TYPE_OFFSET_BASETYPE (t1), TYPE_OFFSET_BASETYPE (t2),\n+\t\t      strict & ~COMPARE_REDECLARATION))\n \treturn false;\n       if (!same_type_p (TREE_TYPE (t1), TREE_TYPE (t2)))\n \treturn false;\n@@ -1123,22 +1123,11 @@ structural_comptypes (tree t1, tree t2, int strict)\n   return targetm.comp_type_attributes (t1, t2);\n }\n \n-extern int comptypes (tree, tree);\n-\n-/* Type comparison function that matches the signature of comptypes\n-   from c-tree.h, which is used by the C front end and some of the\n-   C/C++ common bits.  */\n-int\n-comptypes (tree t1, tree t2)\n-{\n-  return cp_comptypes (t1, t2, COMPARE_STRICT);\n-}\n-\n /* Return true if T1 and T2 are related as allowed by STRICT.  STRICT\n    is a bitwise-or of the COMPARE_* flags.  */\n \n bool\n-cp_comptypes (tree t1, tree t2, int strict)\n+comptypes (tree t1, tree t2, int strict)\n {\n   if (strict == COMPARE_STRICT)\n     {\n@@ -1235,7 +1224,7 @@ comp_cv_qual_signature (tree type1, tree type2)\n     return 0;\n }\n \f\n-/* Subroutines of `cp_comptypes'.  */\n+/* Subroutines of `comptypes'.  */\n \n /* Return true if two parameter type lists PARMS1 and PARMS2 are\n    equivalent in the sense that functions with those parameter types\n@@ -5264,8 +5253,8 @@ build_reinterpret_cast_1 (tree type, tree expr, bool c_cast_p,\n \t \"B\" are related class types; the reinterpret_cast does not\n \t adjust the pointer.  */\n       if (TYPE_PTR_P (intype)\n-\t  && (cp_comptypes (TREE_TYPE (intype), TREE_TYPE (type),\n-                            COMPARE_BASE | COMPARE_DERIVED)))\n+\t  && (comptypes (TREE_TYPE (intype), TREE_TYPE (type),\n+\t\t\t COMPARE_BASE | COMPARE_DERIVED)))\n \twarning (0, \"casting %qT to %qT does not dereference pointer\",\n \t\t intype, type);\n \n@@ -6923,9 +6912,9 @@ ptr_reasonably_similar (const_tree to, const_tree from)\n \treturn 0;\n \n       if (TREE_CODE (from) == OFFSET_TYPE\n-\t  && cp_comptypes (TYPE_OFFSET_BASETYPE (to),\n-                           TYPE_OFFSET_BASETYPE (from),\n-                           COMPARE_BASE | COMPARE_DERIVED))\n+\t  && comptypes (TYPE_OFFSET_BASETYPE (to),\n+\t\t\tTYPE_OFFSET_BASETYPE (from),\n+\t\t\tCOMPARE_BASE | COMPARE_DERIVED))\n \tcontinue;\n \n       if (TREE_CODE (to) == VECTOR_TYPE\n@@ -6940,7 +6929,7 @@ ptr_reasonably_similar (const_tree to, const_tree from)\n \treturn 1;\n \n       if (TREE_CODE (to) != POINTER_TYPE)\n-\treturn cp_comptypes\n+\treturn comptypes\n \t  (TYPE_MAIN_VARIANT (to), TYPE_MAIN_VARIANT (from),\n \t   COMPARE_BASE | COMPARE_DERIVED);\n     }"}, {"sha": "227f52ebae2ddcfb6b98dcb594530ecf99a362ab", "filename": "gcc/objcp/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fobjcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fobjcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjcp%2FChangeLog?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -1,3 +1,13 @@\n+2008-03-07  Paolo Bonzini  <bonzini@gnu.org>\n+\n+\tRevert:\n+\n+\t2008-02-07  Andreas Tobler  <andreast-list@fgznet.ch>\n+\t            Douglas Gregor  <doug.gregor@gmail.com>\n+ \n+\tPR bootstrap/35115\n+\t* objcp-decl.c (objcp_comptypes): Call cp_comptypes, not comptypes.\n+\n 2008-02-07  Andreas Tobler  <andreast-list@fgznet.ch>\n             Douglas Gregor  <doug.gregor@gmail.com>\n  "}, {"sha": "12a73c1272a260771fbccae01e7293de4eaf1468", "filename": "gcc/objcp/objcp-decl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fobjcp%2Fobjcp-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96d8488248db69df9d3ee03b93d89012c0dae96a/gcc%2Fobjcp%2Fobjcp-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjcp%2Fobjcp-decl.c?ref=96d8488248db69df9d3ee03b93d89012c0dae96a", "patch": "@@ -95,7 +95,7 @@ objcp_xref_tag (enum tree_code code ATTRIBUTE_UNUSED, tree name)\n int\n objcp_comptypes (tree type1, tree type2)\n {     \n-  return cp_comptypes (type1, type2, COMPARE_STRICT);\n+  return comptypes (type1, type2, COMPARE_STRICT);\n }\n \n tree"}]}