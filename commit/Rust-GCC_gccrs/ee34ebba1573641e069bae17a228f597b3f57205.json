{"sha": "ee34ebba1573641e069bae17a228f597b3f57205", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWUzNGViYmExNTczNjQxZTA2OWJhZTE3YTIyOGY1OTdiM2Y1NzIwNQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2018-12-15T10:31:37Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2018-12-15T10:31:37Z"}, "message": "ipa.c (cgraph_build_static_cdtor_1): Add OPTIMIZATION and TARGET parameters.\n\n\n\t* ipa.c (cgraph_build_static_cdtor_1): Add OPTIMIZATION and TARGET\n\tparameters.\n\t(cgraph_build_static_cdtor): Update.\n\t(build_cdtor): Use OPTIMIZATION and TARGET of the first real cdtor\n\tcallsed.\n\nFrom-SVN: r267168", "tree": {"sha": "f9cfa15ead5147b2869ca2e67aa68f7a8ed9fb9a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f9cfa15ead5147b2869ca2e67aa68f7a8ed9fb9a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee34ebba1573641e069bae17a228f597b3f57205", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee34ebba1573641e069bae17a228f597b3f57205", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee34ebba1573641e069bae17a228f597b3f57205", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee34ebba1573641e069bae17a228f597b3f57205/comments", "author": null, "committer": null, "parents": [{"sha": "1039d00c597ece034f51a66d085fa80f1f11d9e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1039d00c597ece034f51a66d085fa80f1f11d9e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1039d00c597ece034f51a66d085fa80f1f11d9e2"}], "stats": {"total": 20, "additions": 17, "deletions": 3}, "files": [{"sha": "fe75781ecb9038132e354d5d42eacfd23579094e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee34ebba1573641e069bae17a228f597b3f57205/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee34ebba1573641e069bae17a228f597b3f57205/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ee34ebba1573641e069bae17a228f597b3f57205", "patch": "@@ -1,3 +1,11 @@\n+2018-12-15  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* ipa.c (cgraph_build_static_cdtor_1): Add OPTIMIZATION and TARGET\n+\tparameters.\n+\t(cgraph_build_static_cdtor): Update.\n+\t(build_cdtor): Use OPTIMIZATION and TARGET of the first real cdtor\n+\tcallsed.\n+\n 2018-12-15  Alan Modra  <amodra@gmail.com>\n \n \t* config/rs6000/rs6000.c (generate_set_vrsave, rs6000_emit_savres_rtx),"}, {"sha": "591634649bf957bf32185a7516693da495146d6a", "filename": "gcc/ipa.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee34ebba1573641e069bae17a228f597b3f57205/gcc%2Fipa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee34ebba1573641e069bae17a228f597b3f57205/gcc%2Fipa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa.c?ref=ee34ebba1573641e069bae17a228f597b3f57205", "patch": "@@ -831,7 +831,9 @@ ipa_discover_variable_flags (void)\n    be produced. */\n \n static void\n-cgraph_build_static_cdtor_1 (char which, tree body, int priority, bool final)\n+cgraph_build_static_cdtor_1 (char which, tree body, int priority, bool final,\n+\t\t\t     tree optimization,\n+\t\t\t     tree target)\n {\n   static int counter = 0;\n   char which_buf[16];\n@@ -862,6 +864,8 @@ cgraph_build_static_cdtor_1 (char which, tree body, int priority, bool final)\n \n   TREE_STATIC (decl) = 1;\n   TREE_USED (decl) = 1;\n+  DECL_FUNCTION_SPECIFIC_OPTIMIZATION (decl) = optimization;\n+  DECL_FUNCTION_SPECIFIC_TARGET (decl) = target;\n   DECL_ARTIFICIAL (decl) = 1;\n   DECL_IGNORED_P (decl) = 1;\n   DECL_NO_INSTRUMENT_FUNCTION_ENTRY_EXIT (decl) = 1;\n@@ -911,7 +915,7 @@ cgraph_build_static_cdtor_1 (char which, tree body, int priority, bool final)\n void\n cgraph_build_static_cdtor (char which, tree body, int priority)\n {\n-  cgraph_build_static_cdtor_1 (which, body, priority, false);\n+  cgraph_build_static_cdtor_1 (which, body, priority, false, NULL, NULL);\n }\n \n /* When target does not have ctors and dtors, we call all constructor\n@@ -993,7 +997,9 @@ build_cdtor (bool ctor_p, const vec<tree> &cdtors)\n       gcc_assert (body != NULL_TREE);\n       /* Generate a function to call all the function of like\n \t priority.  */\n-      cgraph_build_static_cdtor_1 (ctor_p ? 'I' : 'D', body, priority, true);\n+      cgraph_build_static_cdtor_1 (ctor_p ? 'I' : 'D', body, priority, true,\n+\t\t\t\t   DECL_FUNCTION_SPECIFIC_OPTIMIZATION (cdtors[0]),\n+\t\t\t\t   DECL_FUNCTION_SPECIFIC_TARGET (cdtors[0]));\n     }\n }\n "}]}