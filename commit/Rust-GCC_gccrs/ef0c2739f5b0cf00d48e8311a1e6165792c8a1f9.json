{"sha": "ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWYwYzI3MzlmNWIwY2YwMGQ0OGU4MzExYTFlNjE2NTc5MmM4YTFmOQ==", "commit": {"author": {"name": "Brendan Kehoe", "email": "brendan@gcc.gnu.org", "date": "1997-06-06T02:23:14Z"}, "committer": {"name": "Brendan Kehoe", "email": "brendan@gcc.gnu.org", "date": "1997-06-06T02:23:14Z"}, "message": "* fixinc.irix: Add declaration of __vfork to unistd.h.\n\nFrom-SVN: r14159", "tree": {"sha": "26be0e4f127e670234a5b432f5a944bc39c82254", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26be0e4f127e670234a5b432f5a944bc39c82254"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9/comments", "author": null, "committer": null, "parents": [{"sha": "67de45a8ddc7cdab8485dc1103885c7739711165", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/67de45a8ddc7cdab8485dc1103885c7739711165", "html_url": "https://github.com/Rust-GCC/gccrs/commit/67de45a8ddc7cdab8485dc1103885c7739711165"}], "stats": {"total": 35, "additions": 32, "deletions": 3}, "files": [{"sha": "337289a121edff8b8e398f3bc039f7fc244b6e8d", "filename": "gcc/fixinc.irix", "status": "modified", "additions": 32, "deletions": 3, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9/gcc%2Ffixinc.irix", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9/gcc%2Ffixinc.irix", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc.irix?ref=ef0c2739f5b0cf00d48e8311a1e6165792c8a1f9", "patch": "@@ -55,9 +55,9 @@ echo 'Building fixincludes in ' ${LIB}\n \n #\n # Note: For Irix, we deliberately don't try to create the directory trees,\n-#       since we only modify math.h and limits.h.  If we ADD ANY OTHERS,\n-#       the \"Making directories:\" and symlinks code from fixinc.svr4 may\n-#       have to go back in.\n+#       since we only modify math.h, limits.h and unistd.h.  If we\n+#\tADD ANY OTHERS, the \"Making directories:\" and symlinks code from\n+#\tfixinc.svr4 may have to go back in.\n \n # The Irix math.h defines struct exception, which conflicts with\n # the class exception defined in the C++ file std/stdexcept.h.  We\n@@ -158,4 +158,33 @@ if [ \\! -z \"$file_to_fix\" ]; then\n   rm -f /tmp/$base\n fi\n \n+# The Irix unistd.h will introduce a call to __vfork in its libc, but the\n+# function is never actually prototyped.\n+file=unistd.h\n+base=`basename $file`\n+if [ -r ${LIB}/$file ]; then\n+  file_to_fix=${LIB}/$file\n+else\n+  if [ -r ${INPUT}/$file ]; then\n+    file_to_fix=${INPUT}/$file\n+  else\n+    file_to_fix=\"\"\n+  fi\n+fi\n+if [ \\! -z \"$file_to_fix\" ]; then\n+  echo Checking $file_to_fix\n+  sed -e '/__vfork/i\\\n+extern pid_t __vfork(void);'\\\n+     $file_to_fix > /tmp/$base\n+  if cmp $file_to_fix /tmp/$base >/dev/null 2>&1; then \\\n+    true\n+  else\n+    echo Fixed $file_to_fix\n+    rm -f ${LIB}/$file\n+    cp /tmp/$base ${LIB}/$file\n+    chmod a+r ${LIB}/$file\n+  fi\n+  rm -f /tmp/$base\n+fi\n+\n exit 0"}]}