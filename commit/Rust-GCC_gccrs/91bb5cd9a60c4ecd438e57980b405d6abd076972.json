{"sha": "91bb5cd9a60c4ecd438e57980b405d6abd076972", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTFiYjVjZDlhNjBjNGVjZDQzOGU1Nzk4MGI0MDVkNmFiZDA3Njk3Mg==", "commit": {"author": {"name": "Tim Shen", "email": "timshen91@gmail.com", "date": "2014-02-26T19:45:15Z"}, "committer": {"name": "Tim Shen", "email": "timshen@gcc.gnu.org", "date": "2014-02-26T19:45:15Z"}, "message": "regex.tcc (match_results<>::format, [...]): Update __out after calling std::copy.\n\n2014-02-26  Tim Shen  <timshen91@gmail.com>\n\n\t* include/bits/regex.tcc (match_results<>::format,\n\tregex_replace<>): Update __out after calling std::copy.\n\t* testsuite/28_regex/algorithms/regex_replace/char/dr2213.cc:\n\tAdd testcase.\n\t* testsuite/28_regex/match_results/format.cc: Likewise.\n\nFrom-SVN: r208179", "tree": {"sha": "46a4b83ab67df5459975d8f47c6a5dc6f1a9001e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/46a4b83ab67df5459975d8f47c6a5dc6f1a9001e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/91bb5cd9a60c4ecd438e57980b405d6abd076972", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91bb5cd9a60c4ecd438e57980b405d6abd076972", "html_url": "https://github.com/Rust-GCC/gccrs/commit/91bb5cd9a60c4ecd438e57980b405d6abd076972", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/91bb5cd9a60c4ecd438e57980b405d6abd076972/comments", "author": {"login": "timshen91", "id": 1157432, "node_id": "MDQ6VXNlcjExNTc0MzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1157432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timshen91", "html_url": "https://github.com/timshen91", "followers_url": "https://api.github.com/users/timshen91/followers", "following_url": "https://api.github.com/users/timshen91/following{/other_user}", "gists_url": "https://api.github.com/users/timshen91/gists{/gist_id}", "starred_url": "https://api.github.com/users/timshen91/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timshen91/subscriptions", "organizations_url": "https://api.github.com/users/timshen91/orgs", "repos_url": "https://api.github.com/users/timshen91/repos", "events_url": "https://api.github.com/users/timshen91/events{/privacy}", "received_events_url": "https://api.github.com/users/timshen91/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b0ff7fe1d223260aea5b7dc3f36892aa57d43c77", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0ff7fe1d223260aea5b7dc3f36892aa57d43c77", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0ff7fe1d223260aea5b7dc3f36892aa57d43c77"}], "stats": {"total": 87, "additions": 81, "deletions": 6}, "files": [{"sha": "2918b9c7c1adc099eb22cfe1ae29ac1b3b98ed3d", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=91bb5cd9a60c4ecd438e57980b405d6abd076972", "patch": "@@ -1,3 +1,11 @@\n+2014-02-26  Tim Shen  <timshen91@gmail.com>\n+\n+\t* include/bits/regex.tcc (match_results<>::format,\n+\tregex_replace<>): Update __out after calling std::copy.\n+\t* testsuite/28_regex/algorithms/regex_replace/char/dr2213.cc:\n+\tAdd testcase.\n+\t* testsuite/28_regex/match_results/format.cc: Likewise.\n+\n 2014-02-22  Marc Glisse  <marc.glisse@inria.fr>\n \n \tPR libstdc++/60308"}, {"sha": "5fa1f018b3dcb7feb1c17050eb8ec7d266bfb0ff", "filename": "libstdc++-v3/include/bits/regex.tcc", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex.tcc?ref=91bb5cd9a60c4ecd438e57980b405d6abd076972", "patch": "@@ -425,7 +425,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t{\n \t  auto& __sub = _Base_type::operator[](__idx);\n \t  if (__sub.matched)\n-\t    std::copy(__sub.first, __sub.second, __out);\n+\t    __out = std::copy(__sub.first, __sub.second, __out);\n \t};\n \n       if (__flags & regex_constants::format_sed)\n@@ -455,7 +455,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t      if (__next == __fmt_last)\n \t\tbreak;\n \n-\t      std::copy(__fmt_first, __next, __out);\n+\t      __out = std::copy(__fmt_first, __next, __out);\n \n \t      auto __eat = [&](char __ch) -> bool\n \t\t{\n@@ -493,7 +493,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t\t*__out++ = '$';\n \t      __fmt_first = __next;\n \t    }\n-\t  std::copy(__fmt_first, __fmt_last, __out);\n+\t  __out = std::copy(__fmt_first, __fmt_last, __out);\n \t}\n       return __out;\n     }\n@@ -512,7 +512,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       if (__i == __end)\n \t{\n \t  if (!(__flags & regex_constants::format_no_copy))\n-\t    std::copy(__first, __last, __out);\n+\t    __out = std::copy(__first, __last, __out);\n \t}\n       else\n \t{\n@@ -521,14 +521,15 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t  for (; __i != __end; ++__i)\n \t    {\n \t      if (!(__flags & regex_constants::format_no_copy))\n-\t\tstd::copy(__i->prefix().first, __i->prefix().second, __out);\n+\t\t__out = std::copy(__i->prefix().first, __i->prefix().second,\n+\t\t\t\t  __out);\n \t      __out = __i->format(__out, __fmt, __fmt + __len, __flags);\n \t      __last = __i->suffix();\n \t      if (__flags & regex_constants::format_first_only)\n \t\tbreak;\n \t    }\n \t  if (!(__flags & regex_constants::format_no_copy))\n-\t    std::copy(__last.first, __last.second, __out);\n+\t    __out = std::copy(__last.first, __last.second, __out);\n \t}\n       return __out;\n     }"}, {"sha": "b2aeac0230e3519a6d812a583ba723b1f1cc6343", "filename": "libstdc++-v3/testsuite/28_regex/algorithms/regex_replace/char/dr2213.cc", "status": "added", "additions": 49, "deletions": 0, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Falgorithms%2Fregex_replace%2Fchar%2Fdr2213.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Falgorithms%2Fregex_replace%2Fchar%2Fdr2213.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Falgorithms%2Fregex_replace%2Fchar%2Fdr2213.cc?ref=91bb5cd9a60c4ecd438e57980b405d6abd076972", "patch": "@@ -0,0 +1,49 @@\n+// { dg-options \"-std=gnu++11\" }\n+\n+//\n+// Copyright (C) 2014 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// 28.11.4 regex_replace\n+// Tests ECMAScript regex_replace's _Out_iter return value.\n+\n+#include <regex>\n+#include <testsuite_hooks.h>\n+\n+using namespace std;\n+\n+void\n+test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  char buff[4096] = {0};\n+  regex re(\"asdf\");\n+  cmatch m;\n+  string s = \"asdf\";\n+  string res = \"|asdf|asdf|\";\n+  VERIFY(regex_replace(buff, s.data(), s.data() + s.size(), re, \"|&|\\\\0|\",\n+\t\t       regex_constants::format_sed) == buff + res.size());\n+  VERIFY(res == buff);\n+}\n+\n+int\n+main()\n+{\n+  test01();\n+  return 0;\n+}"}, {"sha": "e71a2326f4aa1a3542de2f4f55f4639b879728ac", "filename": "libstdc++-v3/testsuite/28_regex/match_results/format.cc", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Fmatch_results%2Fformat.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/91bb5cd9a60c4ecd438e57980b405d6abd076972/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Fmatch_results%2Fformat.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Fmatch_results%2Fformat.cc?ref=91bb5cd9a60c4ecd438e57980b405d6abd076972", "patch": "@@ -45,9 +45,26 @@ test01()\n \t == \"this is a string|a|string|is|this|\\\\\");\n }\n \n+void\n+test02()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  regex re(\"asdf\");\n+  cmatch m;\n+  regex_match(\"asdf\", m, re);\n+  string fmt = \"|&|\\\\0|\";\n+  char buff[4096] = {0};\n+  string res = \"|asdf|asdf|\";\n+  VERIFY(m.format(buff, fmt.data(), fmt.data() + fmt.size(),\n+\t\t  regex_constants::format_sed) == buff + res.size());\n+  VERIFY(res == buff);\n+}\n+\n int\n main()\n {\n   test01();\n+  test02();\n   return 0;\n }"}]}