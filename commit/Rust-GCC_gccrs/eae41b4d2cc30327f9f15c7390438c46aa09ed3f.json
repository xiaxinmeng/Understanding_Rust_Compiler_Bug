{"sha": "eae41b4d2cc30327f9f15c7390438c46aa09ed3f", "node_id": "C_kwDOANBUbNoAKGVhZTQxYjRkMmNjMzAzMjdmOWYxNWM3MzkwNDM4YzQ2YWEwOWVkM2Y", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-01-27T22:31:26Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-01-27T23:31:03Z"}, "message": "libstdc++: Prevent -Wstringop-overread warning in std::deque [PR100516]\n\nThe compiler warns about the loop in deque::_M_range_initialize because\nit doesn't know that the number of nodes has already been correctly\nsized to match the size of the input. Use __builtin_unreachable to tell\nit that the loop will never be entered if the number of elements is\nsmaller than a single node.\n\nlibstdc++-v3/ChangeLog:\n\n\tPR libstdc++/100516\n\t* include/bits/deque.tcc (_M_range_initialize<ForwardIterator>):\n\tAdd __builtin_unreachable to loop.\n\t* testsuite/23_containers/deque/100516.cc: New test.", "tree": {"sha": "650a9486da7a44d6eedad6d909d64d813ce82d67", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/650a9486da7a44d6eedad6d909d64d813ce82d67"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eae41b4d2cc30327f9f15c7390438c46aa09ed3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eae41b4d2cc30327f9f15c7390438c46aa09ed3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eae41b4d2cc30327f9f15c7390438c46aa09ed3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eae41b4d2cc30327f9f15c7390438c46aa09ed3f/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "00e7d024afb80e95fb36d74b1c059468d883a850", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/00e7d024afb80e95fb36d74b1c059468d883a850", "html_url": "https://github.com/Rust-GCC/gccrs/commit/00e7d024afb80e95fb36d74b1c059468d883a850"}], "stats": {"total": 17, "additions": 17, "deletions": 0}, "files": [{"sha": "03e0a505e14bff51eb833ee482a709ee06702578", "filename": "libstdc++-v3/include/bits/deque.tcc", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eae41b4d2cc30327f9f15c7390438c46aa09ed3f/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fdeque.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eae41b4d2cc30327f9f15c7390438c46aa09ed3f/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fdeque.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fdeque.tcc?ref=eae41b4d2cc30327f9f15c7390438c46aa09ed3f", "patch": "@@ -454,6 +454,9 @@ _GLIBCXX_BEGIN_NAMESPACE_CONTAINER\n \t\t __cur_node < this->_M_impl._M_finish._M_node;\n \t\t ++__cur_node)\n \t      {\n+\t\tif (__n < _S_buffer_size())\n+\t\t  __builtin_unreachable(); // See PR 100516\n+\n \t\t_ForwardIterator __mid = __first;\n \t\tstd::advance(__mid, _S_buffer_size());\n \t\tstd::__uninitialized_copy_a(__first, __mid, *__cur_node,"}, {"sha": "ef32ae1054579034410cdd2af520df3da6efc322", "filename": "libstdc++-v3/testsuite/23_containers/deque/100516.cc", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eae41b4d2cc30327f9f15c7390438c46aa09ed3f/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2F100516.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eae41b4d2cc30327f9f15c7390438c46aa09ed3f/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2F100516.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Fdeque%2F100516.cc?ref=eae41b4d2cc30327f9f15c7390438c46aa09ed3f", "patch": "@@ -0,0 +1,14 @@\n+// { dg-options \"-O2 -Wstringop-overread\" }\n+// { dg-do compile { target c++11 } }\n+\n+// Bug 100516\n+// Unexpected -Wstringop-overread in deque<char> initialization from empty\n+// initializer_list\n+\n+#include <deque>\n+\n+void f()\n+{\n+    std::initializer_list<char> il{};\n+    std::deque<char>{il};\n+}"}]}