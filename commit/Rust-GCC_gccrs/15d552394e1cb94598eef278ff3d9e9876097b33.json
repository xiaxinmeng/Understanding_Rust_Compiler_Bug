{"sha": "15d552394e1cb94598eef278ff3d9e9876097b33", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTVkNTUyMzk0ZTFjYjk0NTk4ZWVmMjc4ZmYzZDllOTg3NjA5N2IzMw==", "commit": {"author": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2020-01-27T22:00:52Z"}, "committer": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2020-01-27T22:00:52Z"}, "message": "Support gnu_unique_object symbols on MIPS.\n\nmips_declare_object_name is missing the support for declaring symbols\nas gnu_unique_object that is present in the generic\nASM_DECLARE_OBJECT_NAME in elfos.h.  I'm not aware of any\nMIPS-specific reason for that support to be absent;\nmips_declare_object_name predates the addition of gnu_unique_object\nsupport and as far as I can tell this was simply an oversight when\nthat support was added.  This patch adds the missing support,\nfollowing the code in elfos.h.\n\nTested with no regressions with cross to mips-linux-gnu.  In\nparticular, this fixes the failure of the recently-added glibc test\nelf/tst-dlopen-nodelete-reloc, which relies on the compiler generating\nsuch symbols, for MIPS.\n\n\t* config/mips/mips.c (mips_declare_object_name)\n\t[USE_GNU_UNIQUE_OBJECT]: Support use of gnu_unique_object.", "tree": {"sha": "60ff225677b8d641751985f0321c31226ca62914", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/60ff225677b8d641751985f0321c31226ca62914"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/15d552394e1cb94598eef278ff3d9e9876097b33", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15d552394e1cb94598eef278ff3d9e9876097b33", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15d552394e1cb94598eef278ff3d9e9876097b33", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15d552394e1cb94598eef278ff3d9e9876097b33/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2f195832a12ff4fb54d723f32019d4175db1b5da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f195832a12ff4fb54d723f32019d4175db1b5da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f195832a12ff4fb54d723f32019d4175db1b5da"}], "stats": {"total": 14, "additions": 13, "deletions": 1}, "files": [{"sha": "af0945f6799a7c10f63de0556b97705b4a3062bf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15d552394e1cb94598eef278ff3d9e9876097b33/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15d552394e1cb94598eef278ff3d9e9876097b33/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=15d552394e1cb94598eef278ff3d9e9876097b33", "patch": "@@ -1,3 +1,8 @@\n+2020-01-27  Joseph Myers  <joseph@codesourcery.com>\n+\n+\t* config/mips/mips.c (mips_declare_object_name)\n+\t[USE_GNU_UNIQUE_OBJECT]: Support use of gnu_unique_object.\n+\n 2020-01-27  Martin Liska  <mliska@suse.cz>\n \n \tPR gcov-profile/93403"}, {"sha": "513fc5fe2952c21553a1cfaca743d85cca3a4e34", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15d552394e1cb94598eef278ff3d9e9876097b33/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15d552394e1cb94598eef278ff3d9e9876097b33/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=15d552394e1cb94598eef278ff3d9e9876097b33", "patch": "@@ -9775,7 +9775,14 @@ mips_declare_object_name (FILE *stream, const char *name,\n \t\t\t  tree decl ATTRIBUTE_UNUSED)\n {\n #ifdef ASM_OUTPUT_TYPE_DIRECTIVE\n-  ASM_OUTPUT_TYPE_DIRECTIVE (stream, name, \"object\");\n+#ifdef USE_GNU_UNIQUE_OBJECT\n+  /* As in elfos.h.  */\n+  if (USE_GNU_UNIQUE_OBJECT && DECL_ONE_ONLY (decl)\n+      && (!DECL_ARTIFICIAL (decl) || !TREE_READONLY (decl)))\n+    ASM_OUTPUT_TYPE_DIRECTIVE (stream, name, \"gnu_unique_object\");\n+  else\n+#endif\n+    ASM_OUTPUT_TYPE_DIRECTIVE (stream, name, \"object\");\n #endif\n \n   size_directive_output = 0;"}]}