{"sha": "ae97ba1efcd66d73d3631addf4c09f55e12d34f5", "node_id": "C_kwDOANBUbNoAKGFlOTdiYTFlZmNkNjZkNzNkMzYzMWFkZGY0YzA5ZjU1ZTEyZDM0ZjU", "commit": {"author": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2022-09-05T13:36:45Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2022-09-05T13:46:01Z"}, "message": "RISC-V: Fix division instructions for `m` with `zmmul` extension.\n\ngcc/ChangeLog:\n\n\t* config/riscv/riscv.cc (riscv_option_override): Fix wrong\n\tcondition for MASK_DIV and simplify incompatible checking.\n\t* config/riscv/riscv.md (muldi3): Adding parentheses.", "tree": {"sha": "7370394e1144ae1fb897c5321b1ac2dfcb8f959d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7370394e1144ae1fb897c5321b1ac2dfcb8f959d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ae97ba1efcd66d73d3631addf4c09f55e12d34f5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae97ba1efcd66d73d3631addf4c09f55e12d34f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae97ba1efcd66d73d3631addf4c09f55e12d34f5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae97ba1efcd66d73d3631addf4c09f55e12d34f5/comments", "author": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "48b9c7d5d329a75d0ceb4e3b26a11bc3b6370f4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48b9c7d5d329a75d0ceb4e3b26a11bc3b6370f4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48b9c7d5d329a75d0ceb4e3b26a11bc3b6370f4c"}], "stats": {"total": 10, "additions": 3, "deletions": 7}, "files": [{"sha": "675d92c0961b304a0acd98701e091754ef673c02", "filename": "gcc/config/riscv/riscv.cc", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae97ba1efcd66d73d3631addf4c09f55e12d34f5/gcc%2Fconfig%2Friscv%2Friscv.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae97ba1efcd66d73d3631addf4c09f55e12d34f5/gcc%2Fconfig%2Friscv%2Friscv.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.cc?ref=ae97ba1efcd66d73d3631addf4c09f55e12d34f5", "patch": "@@ -5277,14 +5277,10 @@ riscv_option_override (void)\n   /* The presence of the M extension implies that division instructions\n      are present, so include them unless explicitly disabled.  */\n   if (TARGET_MUL && (target_flags_explicit & MASK_DIV) == 0)\n-    if(!TARGET_ZMMUL)\n-      target_flags |= MASK_DIV;\n+    target_flags |= MASK_DIV;\n   else if (!TARGET_MUL && TARGET_DIV)\n     error (\"%<-mdiv%> requires %<-march%> to subsume the %<M%> extension\");\n-  \n-  if(TARGET_ZMMUL && !TARGET_MUL && TARGET_DIV)\n-    warning (0, \"%<-mdiv%> cannot be used when %<ZMMUL%> extension is present\");\n-  \n+\n   /* Likewise floating-point division and square root.  */\n   if (TARGET_HARD_FLOAT && (target_flags_explicit & MASK_FDIV) == 0)\n     target_flags |= MASK_FDIV;"}, {"sha": "014206fb8bd378feb4d3fab3b2870d2f5e8bd6db", "filename": "gcc/config/riscv/riscv.md", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae97ba1efcd66d73d3631addf4c09f55e12d34f5/gcc%2Fconfig%2Friscv%2Friscv.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae97ba1efcd66d73d3631addf4c09f55e12d34f5/gcc%2Fconfig%2Friscv%2Friscv.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.md?ref=ae97ba1efcd66d73d3631addf4c09f55e12d34f5", "patch": "@@ -752,7 +752,7 @@\n   [(set (match_operand:DI          0 \"register_operand\" \"=r\")\n \t(mult:DI (match_operand:DI 1 \"register_operand\" \" r\")\n \t\t (match_operand:DI 2 \"register_operand\" \" r\")))]\n-  \"TARGET_ZMMUL || TARGET_MUL && TARGET_64BIT\"\n+  \"(TARGET_ZMMUL || TARGET_MUL) && TARGET_64BIT\"\n   \"mul\\t%0,%1,%2\"\n   [(set_attr \"type\" \"imul\")\n    (set_attr \"mode\" \"DI\")])"}]}