{"sha": "9a080ea3464b484cb6bdf464a85bbdab96aa1c95", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWEwODBlYTM0NjRiNDg0Y2I2YmRmNDY0YTg1YmJkYWI5NmFhMWM5NQ==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@gnat.com", "date": "2004-10-04T14:55:06Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2004-10-04T14:55:06Z"}, "message": "prj-part.adb (Parse_Single_Project): Call Is_Extending_All (Extended_Project) only if Extended_Project is defined...\n\n2004-10-04  Vincent Celier  <celier@gnat.com>\n\n\t* prj-part.adb (Parse_Single_Project): Call Is_Extending_All\n\t(Extended_Project) only if Extended_Project is defined, to avoid\n\tassertion error.\n\t(Post_Parse_Context_Clause): Always call Set_Path_Name_Of with a\n\tresolved path.\n\t(Parse_Single_Project): Ditto.\n\n\t* prj-env.adb (Set_Ada_Paths.Add.Recursive_Add): Do not call\n\tAdd_To_Project_Path for virtual projects.\n\nFrom-SVN: r88491", "tree": {"sha": "9970145e03d9788feac654a75df1fd90aabb55fc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9970145e03d9788feac654a75df1fd90aabb55fc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a080ea3464b484cb6bdf464a85bbdab96aa1c95", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a080ea3464b484cb6bdf464a85bbdab96aa1c95", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a080ea3464b484cb6bdf464a85bbdab96aa1c95", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a080ea3464b484cb6bdf464a85bbdab96aa1c95/comments", "author": null, "committer": null, "parents": [{"sha": "51004cb5839a2825ae15b563e7054ac66deda24a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51004cb5839a2825ae15b563e7054ac66deda24a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51004cb5839a2825ae15b563e7054ac66deda24a"}], "stats": {"total": 49, "additions": 33, "deletions": 16}, "files": [{"sha": "fda97b16ec2d2a82eb78da7b5c502d6bf2478df9", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a080ea3464b484cb6bdf464a85bbdab96aa1c95/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a080ea3464b484cb6bdf464a85bbdab96aa1c95/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=9a080ea3464b484cb6bdf464a85bbdab96aa1c95", "patch": "@@ -1,3 +1,15 @@\n+2004-10-04  Vincent Celier  <celier@gnat.com>\n+\n+\t* prj-part.adb (Parse_Single_Project): Call Is_Extending_All\n+\t(Extended_Project) only if Extended_Project is defined, to avoid\n+\tassertion error.\n+\t(Post_Parse_Context_Clause): Always call Set_Path_Name_Of with a\n+\tresolved path.\n+\t(Parse_Single_Project): Ditto.\n+\n+\t* prj-env.adb (Set_Ada_Paths.Add.Recursive_Add): Do not call\n+\tAdd_To_Project_Path for virtual projects.\n+\n 2004-10-04  Vincent Celier  <celier@gnat.com>\n \n \t* mlib-tgt-tru64.adb, mlib-tgt-aix.adb, mlib-tgt-irix.adb, "}, {"sha": "b751e6be7aa98065470d8f85e786368f2e7a8382", "filename": "gcc/ada/prj-env.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a080ea3464b484cb6bdf464a85bbdab96aa1c95/gcc%2Fada%2Fprj-env.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a080ea3464b484cb6bdf464a85bbdab96aa1c95/gcc%2Fada%2Fprj-env.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-env.adb?ref=9a080ea3464b484cb6bdf464a85bbdab96aa1c95", "patch": "@@ -1970,10 +1970,10 @@ package body Prj.Env is\n                         if Data.Library then\n                            Add_To_Object_Path (Data.Library_Dir);\n \n-                        else\n-                           --  For a non library project, add the object\n-                           --  directory.\n+                        --  For a non-library project, add the object\n+                        --  directory, if it is not a virtual project.\n \n+                        elsif not Data.Virtual then\n                            Add_To_Object_Path (Data.Object_Directory);\n                         end if;\n                      end if;"}, {"sha": "63700b0d0102ce4d03b9c806b1b1aac19a259752", "filename": "gcc/ada/prj-part.adb", "status": "modified", "additions": 18, "deletions": 13, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a080ea3464b484cb6bdf464a85bbdab96aa1c95/gcc%2Fada%2Fprj-part.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a080ea3464b484cb6bdf464a85bbdab96aa1c95/gcc%2Fada%2Fprj-part.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-part.adb?ref=9a080ea3464b484cb6bdf464a85bbdab96aa1c95", "patch": "@@ -707,6 +707,12 @@ package body Prj.Part is\n                                      (Original_Path,\n                                       Project_Directory_Path);\n \n+            Resolved_Path : constant String :=\n+                              Normalize_Pathname\n+                                (Imported_Path_Name,\n+                                 Resolve_Links => True,\n+                                 Case_Sensitive => False);\n+\n             Withed_Project : Project_Node_Id := Empty_Node;\n \n          begin\n@@ -750,21 +756,17 @@ package body Prj.Part is\n                  (Current_Project, Current_With.Path);\n                Set_Location_Of (Current_Project, Current_With.Location);\n \n-               --  If this is a \"limited with\", check if we have\n-               --  a circularity; if we have one, get the project id\n-               --  of the limited imported project file, and don't\n-               --  parse it.\n+               --  If this is a \"limited with\", check if we have a circularity.\n+               --  If we have one, get the project id of the limited imported\n+               --  project file, and do not parse it.\n \n                if Limited_With and then Project_Stack.Last > 1 then\n                   declare\n-                     Normed : constant String :=\n-                                Normalize_Pathname (Imported_Path_Name);\n                      Canonical_Path_Name : Name_Id;\n \n                   begin\n-                     Name_Len := Normed'Length;\n-                     Name_Buffer (1 .. Name_Len) := Normed;\n-                     Canonical_Case_File_Name (Name_Buffer (1 .. Name_Len));\n+                     Name_Len := Resolved_Path'Length;\n+                     Name_Buffer (1 .. Name_Len) := Resolved_Path;\n                      Canonical_Path_Name := Name_Find;\n \n                      for Index in 1 .. Project_Stack.Last loop\n@@ -818,8 +820,9 @@ package body Prj.Part is\n                      To           => Withed_Project,\n                      Limited_With => Limited_With);\n                   Set_Name_Of (Current_Project, Name_Of (Withed_Project));\n-                  Name_Len := Imported_Path_Name'Length;\n-                  Name_Buffer (1 .. Name_Len) := Imported_Path_Name;\n+\n+                  Name_Len := Resolved_Path'Length;\n+                  Name_Buffer (1 .. Name_Len) := Resolved_Path;\n                   Set_Path_Name_Of (Current_Project, Name_Find);\n \n                   if Extends_All then\n@@ -1038,7 +1041,7 @@ package body Prj.Part is\n       Project := Default_Project_Node (Of_Kind => N_Project);\n       Project_Stack.Table (Project_Stack.Last).Id := Project;\n       Set_Directory_Of (Project, Project_Directory);\n-      Set_Path_Name_Of (Project, Normed_Path_Name);\n+      Set_Path_Name_Of (Project, Canonical_Path_Name);\n       Set_Location_Of (Project, Token_Ptr);\n \n       Expect (Tok_Project, \"PROJECT\");\n@@ -1271,7 +1274,9 @@ package body Prj.Part is\n                   --  A project that extends an extending-all project is also\n                   --  an extending-all project.\n \n-                  if Is_Extending_All (Extended_Project) then\n+                  if Extended_Project /= Empty_Node\n+                    and then Is_Extending_All (Extended_Project)\n+                  then\n                      Set_Is_Extending_All (Project);\n                   end if;\n                end if;"}]}