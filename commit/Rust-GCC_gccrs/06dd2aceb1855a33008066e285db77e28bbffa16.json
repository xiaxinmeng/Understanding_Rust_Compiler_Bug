{"sha": "06dd2aceb1855a33008066e285db77e28bbffa16", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZkZDJhY2ViMTg1NWEzMzAwODA2NmUyODVkYjc3ZTI4YmJmZmExNg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2014-12-05T23:00:09Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2014-12-05T23:00:09Z"}, "message": "re PR sanitizer/64170 (ICE compiling Linux Kernel drivers/media/rc/imon.c in imon_incoming_packet)\n\n\tPR sanitizer/64170\n\t* sanopt.c (maybe_optimize_asan_check_ifn): If base_checks is\n\tnon-NULL, call maybe_get_dominating_check on it even if g is\n\tnon-NULL.\n\n\t* gcc.dg/asan/pr64170.c: New test.\n\nFrom-SVN: r218440", "tree": {"sha": "a6aec67162141abb0a0ec3158b81ddd7c15b82fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a6aec67162141abb0a0ec3158b81ddd7c15b82fe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06dd2aceb1855a33008066e285db77e28bbffa16", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06dd2aceb1855a33008066e285db77e28bbffa16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06dd2aceb1855a33008066e285db77e28bbffa16", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06dd2aceb1855a33008066e285db77e28bbffa16/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "40da08e0dd91017678b20cb1db2cb529f64d33df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40da08e0dd91017678b20cb1db2cb529f64d33df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40da08e0dd91017678b20cb1db2cb529f64d33df"}], "stats": {"total": 36, "additions": 33, "deletions": 3}, "files": [{"sha": "f9fba3e6ce10d59609881f3315425afcbe63a891", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=06dd2aceb1855a33008066e285db77e28bbffa16", "patch": "@@ -1,3 +1,10 @@\n+2014-12-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR sanitizer/64170\n+\t* sanopt.c (maybe_optimize_asan_check_ifn): If base_checks is\n+\tnon-NULL, call maybe_get_dominating_check on it even if g is\n+\tnon-NULL.\n+\n 2014-12-05  Jeff Law  <law@redhat.com>\n \n \t* doc/md.texi: Note problems using function calls to determine"}, {"sha": "ce9fbcf604a8dbd3be0968316ccae9cc5daa5fcd", "filename": "gcc/sanopt.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2Fsanopt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2Fsanopt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsanopt.c?ref=06dd2aceb1855a33008066e285db77e28bbffa16", "patch": "@@ -408,12 +408,13 @@ maybe_optimize_asan_check_ifn (struct sanopt_ctx *ctx, gimple stmt)\n     }\n \n   gimple g = maybe_get_dominating_check (*ptr_checks);\n+  gimple g2 = NULL;\n \n-  if (!g && base_checks)\n+  if (base_checks)\n     /* Try with base address as well.  */\n-    g = maybe_get_dominating_check (*base_checks);\n+    g2 = maybe_get_dominating_check (*base_checks);\n \n-  if (!g)\n+  if (g == NULL && g2 == NULL)\n     {\n       /* For this PTR we don't have any ASAN_CHECK stmts recorded, so there's\n \t nothing to optimize yet.  */"}, {"sha": "b52905e34f8ef115240e86faa82898be3f5f9f25", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=06dd2aceb1855a33008066e285db77e28bbffa16", "patch": "@@ -1,3 +1,8 @@\n+2014-12-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR sanitizer/64170\n+\t* gcc.dg/asan/pr64170.c: New test.\n+\n 2014-12-05  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/53199"}, {"sha": "c4edcaa39d16f27bf78ad8513afe0e66ac38e9b4", "filename": "gcc/testsuite/gcc.dg/asan/pr64170.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2Ftestsuite%2Fgcc.dg%2Fasan%2Fpr64170.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06dd2aceb1855a33008066e285db77e28bbffa16/gcc%2Ftestsuite%2Fgcc.dg%2Fasan%2Fpr64170.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fasan%2Fpr64170.c?ref=06dd2aceb1855a33008066e285db77e28bbffa16", "patch": "@@ -0,0 +1,17 @@\n+/* PR sanitizer/64170 */\n+/* { dg-do compile } */\n+/* { dg-options \"-fsanitize=address,null\" } */\n+\n+int a, *b, c;\n+void bar (int);\n+\n+void\n+foo (void)\n+{\n+  char *d = (char *) b;\n+  if (d[0] && d[1])\n+    return;\n+  if (c)\n+    a = *(int *) d;\n+  bar (*(int *) d);\n+}"}]}