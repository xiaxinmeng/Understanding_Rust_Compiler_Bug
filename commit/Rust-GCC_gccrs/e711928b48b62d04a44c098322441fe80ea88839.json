{"sha": "e711928b48b62d04a44c098322441fe80ea88839", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTcxMTkyOGI0OGI2MmQwNGE0NGMwOTgzMjI0NDFmZTgwZWE4ODgzOQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-03-16T16:50:27Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-03-16T16:50:27Z"}, "message": "re PR fortran/80010 (diagnostics: typo $!)\n\n\tPR fortran/80010\n\t* parse.c (gfc_ascii_statement): Use !$ACC for ST_OACC_ATOMIC\n\tand ST_OACC_END_ATOMIC, instead of !ACC.\n\t* trans-decl.c (finish_oacc_declare): Use !$ACC instead of $!ACC.\n\t* openmp.c (gfc_match_oacc_declare, gfc_match_oacc_wait,\n\tgfc_resolve_oacc_declare): Likewise.\n\n\t* gfortran.dg/goacc/asyncwait-3.f95: Adjust expected diagnostic.\n\nFrom-SVN: r246204", "tree": {"sha": "6165520e5e7ddcc0273dcd874c78f170f1f5ea2f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6165520e5e7ddcc0273dcd874c78f170f1f5ea2f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e711928b48b62d04a44c098322441fe80ea88839", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e711928b48b62d04a44c098322441fe80ea88839", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e711928b48b62d04a44c098322441fe80ea88839", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e711928b48b62d04a44c098322441fe80ea88839/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c05c23808106294ff0b6665cb4dd395a691be659", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c05c23808106294ff0b6665cb4dd395a691be659", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c05c23808106294ff0b6665cb4dd395a691be659"}], "stats": {"total": 28, "additions": 19, "deletions": 9}, "files": [{"sha": "ffad6187e5efd5046de84753c70d3b3c3fcbb9f9", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=e711928b48b62d04a44c098322441fe80ea88839", "patch": "@@ -1,5 +1,12 @@\n 2017-03-16  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR fortran/80010\n+\t* parse.c (gfc_ascii_statement): Use !$ACC for ST_OACC_ATOMIC\n+\tand ST_OACC_END_ATOMIC, instead of !ACC.\n+\t* trans-decl.c (finish_oacc_declare): Use !$ACC instead of $!ACC.\n+\t* openmp.c (gfc_match_oacc_declare, gfc_match_oacc_wait,\n+\tgfc_resolve_oacc_declare): Likewise.\n+\n \tPR fortran/79886\n \t* error.c (gfc_format_decoder): Rename plus argument to set_locus,\n \tremove ATTRIBUTE_UNUSED from all arguments, call default_tree_printer"}, {"sha": "46f8952a1794639358eb27e7c98c4460a2c44ea1", "filename": "gcc/fortran/openmp.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2Fopenmp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2Fopenmp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fopenmp.c?ref=e711928b48b62d04a44c098322441fe80ea88839", "patch": "@@ -2059,7 +2059,7 @@ gfc_match_oacc_declare (void)\n \t  if (n->u.map_op != OMP_MAP_FORCE_ALLOC\n \t      && n->u.map_op != OMP_MAP_FORCE_TO)\n \t    {\n-\t      gfc_error (\"Invalid clause in module with $!ACC DECLARE at %L\",\n+\t      gfc_error (\"Invalid clause in module with !$ACC DECLARE at %L\",\n \t\t\t &where);\n \t      return MATCH_ERROR;\n \t    }\n@@ -2069,15 +2069,15 @@ gfc_match_oacc_declare (void)\n \n       if (s->attr.use_assoc)\n \t{\n-\t  gfc_error (\"Variable is USE-associated with $!ACC DECLARE at %L\",\n+\t  gfc_error (\"Variable is USE-associated with !$ACC DECLARE at %L\",\n \t\t     &where);\n \t  return MATCH_ERROR;\n \t}\n \n       if ((s->attr.dimension || s->attr.codimension)\n \t  && s->attr.dummy && s->as->type != AS_EXPLICIT)\n \t{\n-\t  gfc_error (\"Assumed-size dummy array with $!ACC DECLARE at %L\",\n+\t  gfc_error (\"Assumed-size dummy array with !$ACC DECLARE at %L\",\n \t\t     &where);\n \t  return MATCH_ERROR;\n \t}\n@@ -2172,7 +2172,7 @@ gfc_match_oacc_wait (void)\n       {\n \tif (el->expr == NULL)\n \t  {\n-\t    gfc_error (\"Invalid argument to $!ACC WAIT at %L\",\n+\t    gfc_error (\"Invalid argument to !$ACC WAIT at %L\",\n \t\t       &wait_list->expr->where);\n \t    return MATCH_ERROR;\n \t  }\n@@ -5985,7 +5985,7 @@ gfc_resolve_oacc_declare (gfc_namespace *ns)\n \t    if (n->expr && n->expr->ref->type == REF_ARRAY)\n \t      {\n \t\tgfc_error (\"Array sections: %qs not allowed in\"\n-\t\t\t   \" $!ACC DECLARE at %L\", n->sym->name, &oc->loc);\n+\t\t\t   \" !$ACC DECLARE at %L\", n->sym->name, &oc->loc);\n \t\tcontinue;\n \t      }\n \t  }"}, {"sha": "305a036a71ea5df0fdaac5fae8c2bf37f1fde019", "filename": "gcc/fortran/parse.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2Fparse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2Fparse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fparse.c?ref=e711928b48b62d04a44c098322441fe80ea88839", "patch": "@@ -2128,10 +2128,10 @@ gfc_ascii_statement (gfc_statement st)\n       p = \"!$ACC ROUTINE\";\n       break;\n     case ST_OACC_ATOMIC:\n-      p = \"!ACC ATOMIC\";\n+      p = \"!$ACC ATOMIC\";\n       break;\n     case ST_OACC_END_ATOMIC:\n-      p = \"!ACC END ATOMIC\";\n+      p = \"!$ACC END ATOMIC\";\n       break;\n     case ST_OMP_ATOMIC:\n       p = \"!$OMP ATOMIC\";"}, {"sha": "efff9a15ac34b1607323496fbca18f0e572a4011", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=e711928b48b62d04a44c098322441fe80ea88839", "patch": "@@ -6133,7 +6133,7 @@ finish_oacc_declare (gfc_namespace *ns, gfc_symbol *sym, bool block)\n \tcontinue;\n \n       if (block)\n-\tgfc_error (\"Sorry, $!ACC DECLARE at %L is not allowed \"\n+\tgfc_error (\"Sorry, !$ACC DECLARE at %L is not allowed \"\n \t\t   \"in BLOCK construct\", &oc->loc);\n \n "}, {"sha": "d32307fc4a55466500470c2935b88af37a56a58a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e711928b48b62d04a44c098322441fe80ea88839", "patch": "@@ -1,5 +1,8 @@\n 2017-03-16  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR fortran/80010\n+\t* gfortran.dg/goacc/asyncwait-3.f95: Adjust expected diagnostic.\n+\n \tPR fortran/79886\n \t* gfortran.dg/pr79886.f90: New test.\n "}, {"sha": "5c55c36e0acc9bc9e8ba17f912fe4e3b856140f5", "filename": "gcc/testsuite/gfortran.dg/goacc/asyncwait-3.f95", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fasyncwait-3.f95", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e711928b48b62d04a44c098322441fe80ea88839/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fasyncwait-3.f95", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fgoacc%2Fasyncwait-3.f95?ref=e711928b48b62d04a44c098322441fe80ea88839", "patch": "@@ -23,7 +23,7 @@ program asyncwait\n \n   !$acc wait (1 ! { dg-error \"Syntax error in OpenACC expression list at\" }\n \n-  !$acc wait (1, *) ! { dg-error \"Invalid argument to \\\\\\$\\\\\\!ACC WAIT\" }\n+  !$acc wait (1, *) ! { dg-error \"Invalid argument to \\\\\\!\\\\\\$ACC WAIT\" }\n \n   !$acc wait (1, a) ! { dg-error \"WAIT clause at \\\\\\(1\\\\\\) requires a scalar INTEGER expression\" }\n "}]}