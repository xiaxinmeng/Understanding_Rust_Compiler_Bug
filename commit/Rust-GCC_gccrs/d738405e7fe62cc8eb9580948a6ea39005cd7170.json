{"sha": "d738405e7fe62cc8eb9580948a6ea39005cd7170", "node_id": "C_kwDOANBUbNoAKGQ3Mzg0MDVlN2ZlNjJjYzhlYjk1ODA5NDhhNmVhMzkwMDVjZDcxNzA", "commit": {"author": {"name": "H.J. Lu", "email": "hjl.tools@gmail.com", "date": "2021-08-30T21:36:52Z"}, "committer": {"name": "H.J. Lu", "email": "hjl.tools@gmail.com", "date": "2021-10-20T12:35:52Z"}, "message": "libffi: Add HOWTO_MERGE, autogen.sh and merge.sh\n\nAdd scripts for syncing with libffi upstream:\n\n1. Clone libffi repo.\n2. Checkout the specific commit.\n3. Remove the unused files.\n4. Add new files and remove old files if needed.\n\n\t* HOWTO_MERGE: New file.\n\t* autogen.sh: Likewise.\n\t* merge.sh: Likewise.", "tree": {"sha": "ce5e9cb12024b7472027a7a77cce2d3bb101ddac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ce5e9cb12024b7472027a7a77cce2d3bb101ddac"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d738405e7fe62cc8eb9580948a6ea39005cd7170", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d738405e7fe62cc8eb9580948a6ea39005cd7170", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d738405e7fe62cc8eb9580948a6ea39005cd7170", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d738405e7fe62cc8eb9580948a6ea39005cd7170/comments", "author": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "committer": {"login": "hjl-tools", "id": 1072356, "node_id": "MDQ6VXNlcjEwNzIzNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/1072356?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hjl-tools", "html_url": "https://github.com/hjl-tools", "followers_url": "https://api.github.com/users/hjl-tools/followers", "following_url": "https://api.github.com/users/hjl-tools/following{/other_user}", "gists_url": "https://api.github.com/users/hjl-tools/gists{/gist_id}", "starred_url": "https://api.github.com/users/hjl-tools/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hjl-tools/subscriptions", "organizations_url": "https://api.github.com/users/hjl-tools/orgs", "repos_url": "https://api.github.com/users/hjl-tools/repos", "events_url": "https://api.github.com/users/hjl-tools/events{/privacy}", "received_events_url": "https://api.github.com/users/hjl-tools/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7113f1b54d533526c81459324faea4c100c50497", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7113f1b54d533526c81459324faea4c100c50497", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7113f1b54d533526c81459324faea4c100c50497"}], "stats": {"total": 75, "additions": 75, "deletions": 0}, "files": [{"sha": "5b92b10c15c0b224a5bb1f7ca2a025d9863f5e6f", "filename": "libffi/HOWTO_MERGE", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d738405e7fe62cc8eb9580948a6ea39005cd7170/libffi%2FHOWTO_MERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d738405e7fe62cc8eb9580948a6ea39005cd7170/libffi%2FHOWTO_MERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FHOWTO_MERGE?ref=d738405e7fe62cc8eb9580948a6ea39005cd7170", "patch": "@@ -0,0 +1,13 @@\n+In general, merging process should not be very difficult, but we need to\n+track GCC-specific patches carefully.  Here is a general list of actions\n+required to perform the merge:\n+\n+* Checkout recent GCC tree.\n+* Run merge.sh script from the libffi directory.\n+* Add new files and remove old files if needed.\n+* Apply all needed GCC-specific patches to libffi (note that some of\n+  them might be already included to upstream).  The list of these patches\n+  is stored into LOCAL_PATCHES file.  May need to re-run autogen.sh to\n+  regenerate configure and Makefile.in files.\n+* Send your patches for review to GCC Patches Mailing List (gcc-patches@gcc.gnu.org).\n+* Update LOCAL_PATCHES file when you've committed the whole patch set with new revisions numbers."}, {"sha": "95bfc389faf0a85fabe185ba6afa9f1985b184d9", "filename": "libffi/autogen.sh", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d738405e7fe62cc8eb9580948a6ea39005cd7170/libffi%2Fautogen.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d738405e7fe62cc8eb9580948a6ea39005cd7170/libffi%2Fautogen.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fautogen.sh?ref=d738405e7fe62cc8eb9580948a6ea39005cd7170", "patch": "@@ -0,0 +1,11 @@\n+#!/bin/sh\n+#exec autoreconf -v -i\n+\n+rm -rf autom4te.cache\n+aclocal  -I .. -I ../config\n+autoheader -I .. -I ../config\n+autoconf\n+automake --foreign --add-missing --copy Makefile\n+automake --foreign include/Makefile\n+automake --foreign man/Makefile\n+automake --foreign testsuite/Makefile"}, {"sha": "b36fbb92185b48c069ce7becce025cc6298b965b", "filename": "libffi/merge.sh", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d738405e7fe62cc8eb9580948a6ea39005cd7170/libffi%2Fmerge.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d738405e7fe62cc8eb9580948a6ea39005cd7170/libffi%2Fmerge.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fmerge.sh?ref=d738405e7fe62cc8eb9580948a6ea39005cd7170", "patch": "@@ -0,0 +1,51 @@\n+#!/bin/bash\n+\n+# FIXME: do we need a license (or whatever else) header here?\n+\n+# This script merges libffi sources from upstream.\n+\n+# Default to the tip of master branch.\n+commit=${1-master}\n+\n+fatal() {\n+  echo \"$1\"\n+  exit 1;\n+}\n+\n+get_upstream() {\n+  rm -rf upstream\n+  git clone https://github.com/libffi/libffi.git upstream\n+  pushd upstream\n+  git checkout $commit || fatal \"Failed to checkout $commit\"\n+  popd\n+}\n+\n+get_current_rev() {\n+  cd upstream\n+  git rev-parse HEAD\n+}\n+\n+pwd | grep 'libffi$' || \\\n+  fatal \"Run this script from the libffi directory\"\n+get_upstream\n+CUR_REV=$(get_current_rev)\n+echo Current upstream revision: $CUR_REV\n+\n+# Remove the unused files.\n+pushd upstream\n+rm -rf ChangeLog.old .appveyor* .ci .github .gitignore .travis* \\\n+\tconfig.guess config.sub libtool-ldflags m4 make_sunver.pl \\\n+\tmsvc_build\n+rm -rf .git autogen.sh\n+cp -a . ..\n+popd\n+\n+rm -rf upstream\n+\n+# Update the MERGE file.\n+cat << EOF > MERGE\n+$CUR_REV\n+\n+The first line of this file holds the git revision number of the\n+last merge done from the master library sources.\n+EOF"}]}