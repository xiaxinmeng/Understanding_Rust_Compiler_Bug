{"sha": "0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGIxZDUyZjc0NTIyZjJlMWFiNDNhMGFkYThhZDFjODlmNmRhZWFjNQ==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2004-06-08T05:21:51Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2004-06-08T05:21:51Z"}, "message": "gimplify.c (copy_if_shared_r): Revert: 2004-05-21 Richard Henderson <rth@redhat.com>\n\n* gimplify.c (copy_if_shared_r): Revert:\n2004-05-21  Richard Henderson  <rth@redhat.com>\n* gimplify.c [...] Don't mark VA_ARG_EXPRs volatile here.\n\nFrom-SVN: r82745", "tree": {"sha": "07c443a88da1d8140be976bcd9105c71c00a434d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/07c443a88da1d8140be976bcd9105c71c00a434d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5/comments", "author": null, "committer": null, "parents": [{"sha": "5bbb9680379fdd9ac147a9e734c0b11d774c4e04", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5bbb9680379fdd9ac147a9e734c0b11d774c4e04", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5bbb9680379fdd9ac147a9e734c0b11d774c4e04"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "aec3ed2fc4e63ad39c92e487ecccb8488ada5c89", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5", "patch": "@@ -1,3 +1,9 @@\n+2004-06-08  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* gimplify.c (copy_if_shared_r): Revert:\n+\t2004-05-21  Richard Henderson  <rth@redhat.com>\n+\t* gimplify.c [...] Don't mark VA_ARG_EXPRs volatile here.\n+\n 2004-06-07  Roger Sayle  <roger@eyesopen.com>\n \n \t* expmed.c (add_cost, neg_cost, sdiv_pow2_cheap, smod_pow2_cheap):"}, {"sha": "679103e31c16a2c058ecc0e66c3cb83f23d11100", "filename": "gcc/gimplify.c", "status": "modified", "additions": 13, "deletions": 1, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=0b1d52f74522f2e1ab43a0ada8ad1c89f6daeac5", "patch": "@@ -665,7 +665,19 @@ copy_if_shared_r (tree *tp, int *walk_subtrees ATTRIBUTE_UNUSED,\n \n   /* Otherwise, mark the tree as visited and keep looking.  */\n   else\n-    TREE_VISITED (t) = 1;\n+    {\n+      TREE_VISITED (t) = 1;\n+      if (TREE_CODE (*tp) == VA_ARG_EXPR)\n+\t{\n+\t  /* Mark any _DECL inside the operand as volatile to avoid\n+\t     the optimizers messing around with it. We have to do this\n+\t     early, otherwise we might mark a variable as volatile\n+\t     after we gimplify other statements that use the variable\n+\t     assuming it's not volatile.  */\n+\t  walk_tree (&TREE_OPERAND (*tp, 0), mark_decls_volatile_r,\n+\t\t     NULL, NULL);\n+\t}\n+    }\n \n   return NULL_TREE;\n }"}]}