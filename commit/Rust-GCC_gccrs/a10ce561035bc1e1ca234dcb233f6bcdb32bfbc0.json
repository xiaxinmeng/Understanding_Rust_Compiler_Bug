{"sha": "a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTEwY2U1NjEwMzViYzFlMWNhMjM0ZGNiMjMzZjZiY2RiMzJiZmJjMA==", "commit": {"author": {"name": "James Greenhalgh", "email": "james.greenhalgh@arm.com", "date": "2014-11-01T10:14:08Z"}, "committer": {"name": "James Greenhalgh", "email": "jgreenhalgh@gcc.gnu.org", "date": "2014-11-01T10:14:08Z"}, "message": "[Patch 5/7 mips] Deprecate *_BY_PIECES_P, move to hookized version\n\ngcc/\n\n\t* config/mips/mips.h (MOVE_BY_PIECES_P): Remove.\n\t(STORE_BY_PIECES_P): Likewise.\n\t* config/mips/mips.c (TARGET_USE_BY_PIECES_INFRASTRUCTURE_P): New.\n\t(mips_move_by_pieces_p): Rename to...\n\t(mips_use_by_pieces_infrastructure_p): ...this, use new hook\n\tparameters, use the default hook implementation as a\n\tfall-back.\n\nFrom-SVN: r217002", "tree": {"sha": "311320e72f232631eb491aefbc5ad871f1aa4889", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/311320e72f232631eb491aefbc5ad871f1aa4889"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0/comments", "author": {"login": "jgreenhalgh-arm", "id": 6104025, "node_id": "MDQ6VXNlcjYxMDQwMjU=", "avatar_url": "https://avatars.githubusercontent.com/u/6104025?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jgreenhalgh-arm", "html_url": "https://github.com/jgreenhalgh-arm", "followers_url": "https://api.github.com/users/jgreenhalgh-arm/followers", "following_url": "https://api.github.com/users/jgreenhalgh-arm/following{/other_user}", "gists_url": "https://api.github.com/users/jgreenhalgh-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jgreenhalgh-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jgreenhalgh-arm/subscriptions", "organizations_url": "https://api.github.com/users/jgreenhalgh-arm/orgs", "repos_url": "https://api.github.com/users/jgreenhalgh-arm/repos", "events_url": "https://api.github.com/users/jgreenhalgh-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/jgreenhalgh-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ae59bd31fe8c3fb7933d7b87aa69d755ae02cc29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae59bd31fe8c3fb7933d7b87aa69d755ae02cc29", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae59bd31fe8c3fb7933d7b87aa69d755ae02cc29"}], "stats": {"total": 40, "additions": 26, "deletions": 14}, "files": [{"sha": "7e9ae04ab2027a05f18debcba8e7ea627113c276", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0", "patch": "@@ -1,3 +1,13 @@\n+2014-11-01  James Greenhalgh  <james.greenhalgh@arm.com>\n+\n+\t* config/mips/mips.h (MOVE_BY_PIECES_P): Remove.\n+\t(STORE_BY_PIECES_P): Likewise.\n+\t* config/mips/mips.c (TARGET_USE_BY_PIECES_INFRASTRUCTURE_P): New.\n+\t(mips_move_by_pieces_p): Rename to...\n+\t(mips_use_by_pieces_infrastructure_p): ...this, use new hook\n+\tparameters, use the default hook implementation as a\n+\tfall-back.\n+\n 2014-11-01  James Greenhalgh  <james.greenhalgh@arm.com>\n \n \t* config/sh/sh.c (TARGET_USE_BY_PIECES_INFRASTRUCTURE_P): New."}, {"sha": "ac7746c372ee26b20bfa591ba130308a2c2e71ec", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 16, "deletions": 8, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0", "patch": "@@ -7172,12 +7172,17 @@ mips_function_ok_for_sibcall (tree decl, tree exp ATTRIBUTE_UNUSED)\n   return true;\n }\n \f\n-/* Implement MOVE_BY_PIECES_P.  */\n+/* Implement TARGET_USE_MOVE_BY_PIECES_INFRASTRUCTURE_P.  */\n \n bool\n-mips_move_by_pieces_p (unsigned HOST_WIDE_INT size, unsigned int align)\n+mips_use_by_pieces_infrastructure_p (unsigned int size,\n+\t\t\t\t     unsigned int align,\n+\t\t\t\t     enum by_pieces_operation op,\n+\t\t\t\t     bool speed_p)\n {\n-  if (HAVE_movmemsi)\n+  if (op == STORE_BY_PIECES)\n+    return mips_store_by_pieces_p (size, align);\n+  if (op == MOVE_BY_PIECES && HAVE_movmemsi)\n     {\n       /* movmemsi is meant to generate code that is at least as good as\n \t move_by_pieces.  However, movmemsi effectively uses a by-pieces\n@@ -7194,13 +7199,12 @@ mips_move_by_pieces_p (unsigned HOST_WIDE_INT size, unsigned int align)\n \treturn size < UNITS_PER_WORD;\n       return size <= MIPS_MAX_MOVE_BYTES_STRAIGHT;\n     }\n-  /* The default value.  If this becomes a target hook, we should\n-     call the default definition instead.  */\n-  return (move_by_pieces_ninsns (size, align, MOVE_MAX_PIECES + 1)\n-\t  < (unsigned int) MOVE_RATIO (optimize_insn_for_speed_p ()));\n+\n+  return default_use_by_pieces_infrastructure_p (size, align, op, speed_p);\n }\n \n-/* Implement STORE_BY_PIECES_P.  */\n+/* Implement a handler for STORE_BY_PIECES operations\n+   for TARGET_USE_MOVE_BY_PIECES_INFRASTRUCTURE_P.  */\n \n bool\n mips_store_by_pieces_p (unsigned HOST_WIDE_INT size, unsigned int align)\n@@ -19119,6 +19123,10 @@ mips_lra_p (void)\n #undef TARGET_CALL_FUSAGE_CONTAINS_NON_CALLEE_CLOBBERS\n #define TARGET_CALL_FUSAGE_CONTAINS_NON_CALLEE_CLOBBERS true\n \n+#undef TARGET_USE_BY_PIECES_INFRASTRUCTURE_P\n+#define TARGET_USE_BY_PIECES_INFRASTRUCTURE_P \\\n+  mips_use_by_pieces_infrastructure_p\n+\n #undef TARGET_SPILL_CLASS\n #define TARGET_SPILL_CLASS mips_spill_class\n #undef TARGET_LRA_P"}, {"sha": "bf19920d4540c145a54179a7adb34c2a8a6f1822", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=a10ce561035bc1e1ca234dcb233f6bcdb32bfbc0", "patch": "@@ -2872,9 +2872,6 @@ while (0)\n    ? MIPS_MAX_MOVE_BYTES_STRAIGHT / MOVE_MAX\t\t\\\n    : MIPS_CALL_RATIO / 2)\n \n-#define MOVE_BY_PIECES_P(SIZE, ALIGN) \\\n-  mips_move_by_pieces_p (SIZE, ALIGN)\n-\n /* For CLEAR_RATIO, when optimizing for size, give a better estimate\n    of the length of a memset call, but use the default otherwise.  */\n \n@@ -2887,9 +2884,6 @@ while (0)\n \n #define SET_RATIO(speed) \\\n   ((speed) ? 15 : MIPS_CALL_RATIO - 2)\n-\n-#define STORE_BY_PIECES_P(SIZE, ALIGN) \\\n-  mips_store_by_pieces_p (SIZE, ALIGN)\n \f\n /* Since the bits of the _init and _fini function is spread across\n    many object files, each potentially with its own GP, we must assume"}]}