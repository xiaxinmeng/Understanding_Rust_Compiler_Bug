{"sha": "1dc82a999cf05e3138d83ea248106c9ec9d7d082", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWRjODJhOTk5Y2YwNWUzMTM4ZDgzZWEyNDgxMDZjOWVjOWQ3ZDA4Mg==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-10-29T07:16:50Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-10-29T07:16:50Z"}, "message": "re PR c++/17695 (ICE in add_abstract_origin_attribute)\n\n\tPR c++/17695\n\t* decl.c (grokdeclarator): Mark TYPE_DECLs as abstract when they\n\tappear in a constructor/destructor that will be cloned.\n\n\tPR c++/17695\n\t* g++.dg/debug/typedef2.C: New test.\n\nFrom-SVN: r89819", "tree": {"sha": "fe1af43214d3f93042b4592ab7f9b90af27cb88e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fe1af43214d3f93042b4592ab7f9b90af27cb88e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1dc82a999cf05e3138d83ea248106c9ec9d7d082", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1dc82a999cf05e3138d83ea248106c9ec9d7d082", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1dc82a999cf05e3138d83ea248106c9ec9d7d082", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1dc82a999cf05e3138d83ea248106c9ec9d7d082/comments", "author": null, "committer": null, "parents": [{"sha": "07c05acd82081dbc55bccab05e730898adb1a1ef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07c05acd82081dbc55bccab05e730898adb1a1ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07c05acd82081dbc55bccab05e730898adb1a1ef"}], "stats": {"total": 31, "additions": 31, "deletions": 0}, "files": [{"sha": "5fca4cbea404feb0f95d5e71113113b2a3c914d2", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1dc82a999cf05e3138d83ea248106c9ec9d7d082", "patch": "@@ -1,3 +1,9 @@\n+2004-10-29  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/17695\n+\t* decl.c (grokdeclarator): Mark TYPE_DECLs as abstract when they\n+\tappear in a constructor/destructor that will be cloned.\n+\n 1004-10-28  Matt Austern  <austern@apple.com>\n \n \tPR c++/14124"}, {"sha": "c435e488bb4affa96e5abe47da6c155b1f2a6ba8", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=1dc82a999cf05e3138d83ea248106c9ec9d7d082", "patch": "@@ -7619,6 +7619,14 @@ grokdeclarator (const cp_declarator *declarator,\n \t    error (\"%Jtypedef name may not be a nested-name-specifier\", decl);\n \t  if (!current_function_decl)\n \t    DECL_CONTEXT (decl) = FROB_CONTEXT (current_namespace);\n+\t  else if (DECL_MAYBE_IN_CHARGE_CONSTRUCTOR_P (current_function_decl)\n+\t\t   || (DECL_MAYBE_IN_CHARGE_DESTRUCTOR_P \n+\t\t       (current_function_decl)))\n+\t    /* The TYPE_DECL is \"abstract\" because there will be\n+\t       clones of this constructor/destructor, and there will\n+\t       be copies of this TYPE_DECL generated in those\n+\t       clones.  */\n+\t    DECL_ABSTRACT (decl) = 1;\n \t}\n \n       /* If the user declares \"typedef struct {...} foo\" then the"}, {"sha": "089fc6428d5cb54f637977940f87fda3fbb85b28", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1dc82a999cf05e3138d83ea248106c9ec9d7d082", "patch": "@@ -1,3 +1,8 @@\n+2004-10-29  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/17695\n+\t* g++.dg/debug/typedef2.C: New test.\n+\n 2004-10-29  David Billinghurst <David.Billinghurst@riotinto.com>\n \n \tPR fortran/13490"}, {"sha": "a216242c7bc390c7b68ec74a26aee1b18f616e49", "filename": "gcc/testsuite/g++.dg/debug/typedef2.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Ftypedef2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dc82a999cf05e3138d83ea248106c9ec9d7d082/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Ftypedef2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Ftypedef2.C?ref=1dc82a999cf05e3138d83ea248106c9ec9d7d082", "patch": "@@ -0,0 +1,12 @@\n+// PR c++/17695\n+\n+template<typename T> struct A\n+{\n+  T t;\n+  A();\n+};\n+\n+struct B\n+{\n+  B() { typedef int C; A<C> a; }\n+} b;"}]}