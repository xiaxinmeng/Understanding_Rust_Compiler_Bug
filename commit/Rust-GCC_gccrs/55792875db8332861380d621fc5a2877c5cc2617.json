{"sha": "55792875db8332861380d621fc5a2877c5cc2617", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTU3OTI4NzVkYjgzMzI4NjEzODBkNjIxZmM1YTI4NzdjNWNjMjYxNw==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@airs.com", "date": "2005-10-11T23:30:57Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2005-10-11T23:30:57Z"}, "message": "re PR c++/8057 (Templates/non-templates and warnings about statements without effects)\n\ncp/\n\tPR c++/8057\n\t* cvt.c (convert_to_void): Don't warn about unused values when\n\tprocessing a template declaration.\ntestsuite/\n\tPR c++/8057\n\t* g++.dg/warn/noeffect7.C: New test.\n\t* g++.dg/warn/noeffect2.C: Instantiate templates.\n\t* g++.dg/warn/noeffect4.C: Instantiate template.  Add new error\n\tand warning.\n\nFrom-SVN: r105273", "tree": {"sha": "3007b19208ae47725cf5bc26f0466ed5c6e88769", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3007b19208ae47725cf5bc26f0466ed5c6e88769"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/55792875db8332861380d621fc5a2877c5cc2617", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55792875db8332861380d621fc5a2877c5cc2617", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55792875db8332861380d621fc5a2877c5cc2617", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55792875db8332861380d621fc5a2877c5cc2617/comments", "author": {"login": "ianlancetaylor", "id": 3194333, "node_id": "MDQ6VXNlcjMxOTQzMzM=", "avatar_url": "https://avatars.githubusercontent.com/u/3194333?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ianlancetaylor", "html_url": "https://github.com/ianlancetaylor", "followers_url": "https://api.github.com/users/ianlancetaylor/followers", "following_url": "https://api.github.com/users/ianlancetaylor/following{/other_user}", "gists_url": "https://api.github.com/users/ianlancetaylor/gists{/gist_id}", "starred_url": "https://api.github.com/users/ianlancetaylor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ianlancetaylor/subscriptions", "organizations_url": "https://api.github.com/users/ianlancetaylor/orgs", "repos_url": "https://api.github.com/users/ianlancetaylor/repos", "events_url": "https://api.github.com/users/ianlancetaylor/events{/privacy}", "received_events_url": "https://api.github.com/users/ianlancetaylor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0257e3837eb84c9f288c39cfbb3caa41badf9e3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0257e3837eb84c9f288c39cfbb3caa41badf9e3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0257e3837eb84c9f288c39cfbb3caa41badf9e3b"}], "stats": {"total": 35, "additions": 31, "deletions": 4}, "files": [{"sha": "a544cfa392d50295737d0ee576361e78a26912eb", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=55792875db8332861380d621fc5a2877c5cc2617", "patch": "@@ -1,3 +1,9 @@\n+2005-10-11  Ian Lance Taylor  <ian@airs.com>\n+\n+\tPR c++/8057\n+\t* cvt.c (convert_to_void): Don't warn about unused values when\n+\tprocessing a template declaration.\n+\n 2005-10-11  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/21089"}, {"sha": "ea3c496b6c7db82327b529eb3f0e2c8ed879a8a2", "filename": "gcc/cp/cvt.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Fcp%2Fcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Fcp%2Fcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcvt.c?ref=55792875db8332861380d621fc5a2877c5cc2617", "patch": "@@ -910,7 +910,10 @@ convert_to_void (tree expr, const char *implicit)\n \n   if (expr != error_mark_node && !VOID_TYPE_P (TREE_TYPE (expr)))\n     {\n-      if (implicit && warn_unused_value && !TREE_NO_WARNING (expr))\n+      if (implicit\n+\t  && warn_unused_value\n+\t  && !TREE_NO_WARNING (expr)\n+\t  && !processing_template_decl)\n \t{\n \t  /* The middle end does not warn about expressions that have\n \t     been explicitly cast to void, so we must do so here.  */"}, {"sha": "39ea01a5e9c315031cc61ceca9f8392e25d9cfd7", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=55792875db8332861380d621fc5a2877c5cc2617", "patch": "@@ -1,3 +1,11 @@\n+2005-10-11  Ian Lance Taylor  <ian@airs.com>\n+\n+\tPR c++/8057\n+\t* g++.dg/warn/noeffect7.C: New test.\n+\t* g++.dg/warn/noeffect2.C: Instantiate templates.\n+\t* g++.dg/warn/noeffect4.C: Instantiate template.  Add new error\n+\tand warning.\n+\n 2005-10-11  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/21089"}, {"sha": "69adf3963671b819634f18e711e9a01891ee4b77", "filename": "gcc/testsuite/g++.dg/warn/noeffect2.C", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect2.C?ref=55792875db8332861380d621fc5a2877c5cc2617", "patch": "@@ -12,7 +12,9 @@ extern \"C\" void FormatDisk();\n   struct C {\n     C(){ FormatDisk(), 0; }  // { dg-warning \"right-hand operand of comma\" \"\" }\n   };\n+  template struct C<int>; // { dg-warning \"instantiated\" }\n   template <class T>\n   void f() { FormatDisk(), 0; } // { dg-warning \"right-hand operand of comma\" \"\" }\n+  template void f<int> (); // { dg-warning \"instantiated\" }\n void g() { FormatDisk(), 0; } // { dg-warning \"right-hand operand of comma\" \"\" }\n "}, {"sha": "7b051dd6766705f244d40298d2582755506f5a0e", "filename": "gcc/testsuite/g++.dg/warn/noeffect4.C", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect4.C?ref=55792875db8332861380d621fc5a2877c5cc2617", "patch": "@@ -76,13 +76,13 @@ template<int I> void Foo (X &x)\n   x->m;\n   static_cast<int> (x);\n   dynamic_cast<Y &> (x);\n-  reinterpret_cast<int> (x.Foo ());\n-  const_cast<X &> (x.Foo ());\n+  reinterpret_cast<int> (x.Foo ()); // { dg-error \"invalid cast\" }\n+  const_cast<X &> (x.Foo ());       // { dg-warning \"not used\" }\n   \n   reinterpret_cast<int *> (&x);// { dg-warning \"no effect\" \"\" }\n   const_cast<X &> (x);         // { dg-warning \"no effect\" \"\" }\n   sizeof (x++);                // { dg-warning \"no effect\" \"\" }\n   __alignof__ (x++);           // { dg-warning \"no effect\" \"\" }\n }\n-  \n \n+template void Foo<4> (X&);     // { dg-warning \"instantiated\" }"}, {"sha": "4aca2496c5eebf07320197789c8839894250515e", "filename": "gcc/testsuite/g++.dg/warn/noeffect7.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect7.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55792875db8332861380d621fc5a2877c5cc2617/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect7.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2Fnoeffect7.C?ref=55792875db8332861380d621fc5a2877c5cc2617", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/8057\n+// Don't give a \"statement has no effect\" warning when declaring a\n+// template, only when instantiating it.\n+// { dg-do compile }\n+// { dg-options \"-Wunused\" }\n+struct Y { static int i; };\n+template <typename T> class X { X() { Y::i; }; };\n+class Z { Z() { Y::i; }; }; // { dg-warning \"no effect\" }"}]}