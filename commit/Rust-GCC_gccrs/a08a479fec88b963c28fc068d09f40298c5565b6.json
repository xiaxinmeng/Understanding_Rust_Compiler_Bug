{"sha": "a08a479fec88b963c28fc068d09f40298c5565b6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTA4YTQ3OWZlYzg4Yjk2M2MyOGZjMDY4ZDA5ZjQwMjk4YzU1NjViNg==", "commit": {"author": {"name": "Frank Ch. Eigler", "email": "fche@redhat.com", "date": "2005-04-12T18:09:09Z"}, "committer": {"name": "Frank Ch. Eigler", "email": "fche@gcc.gnu.org", "date": "2005-04-12T18:09:09Z"}, "message": "re PR other/19266 ([mudflap] ICE when compiling with -fmudflap -O)\n\n2005-04-12  Frank Ch. Eigler  <fche@redhat.com>\n\n\tPR mudflap/19266\n\tFrom Richard Henderson <rth@redhat.com>:\n\t* tree-mudflap.c (mf_build_check_statement_for): Correct block\n\tsplitting logic.\n\n2005-04-12  Frank Ch. Eigler  <fche@redhat.com>\n\n\tPR mudflap/19266\n\t* testsuite/libmudflap.c++/c++frags.exp: Also test -O permutation.\n\t* testsuite/libmudflap.c++/pass57-frag.cxx: New test.\n\nFrom-SVN: r98028", "tree": {"sha": "fa131f46b98ec3d1b41397fd52e1c6aceb8ed50a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fa131f46b98ec3d1b41397fd52e1c6aceb8ed50a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a08a479fec88b963c28fc068d09f40298c5565b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a08a479fec88b963c28fc068d09f40298c5565b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a08a479fec88b963c28fc068d09f40298c5565b6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a08a479fec88b963c28fc068d09f40298c5565b6/comments", "author": {"login": "fche", "id": 588885, "node_id": "MDQ6VXNlcjU4ODg4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/588885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fche", "html_url": "https://github.com/fche", "followers_url": "https://api.github.com/users/fche/followers", "following_url": "https://api.github.com/users/fche/following{/other_user}", "gists_url": "https://api.github.com/users/fche/gists{/gist_id}", "starred_url": "https://api.github.com/users/fche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fche/subscriptions", "organizations_url": "https://api.github.com/users/fche/orgs", "repos_url": "https://api.github.com/users/fche/repos", "events_url": "https://api.github.com/users/fche/events{/privacy}", "received_events_url": "https://api.github.com/users/fche/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b7d1c15e4efd1f63d19d23470b912b048cd9660b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7d1c15e4efd1f63d19d23470b912b048cd9660b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7d1c15e4efd1f63d19d23470b912b048cd9660b"}], "stats": {"total": 73, "additions": 48, "deletions": 25}, "files": [{"sha": "a64c04278b07fb91e32c3461c1b22204327c1898", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a08a479fec88b963c28fc068d09f40298c5565b6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a08a479fec88b963c28fc068d09f40298c5565b6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a08a479fec88b963c28fc068d09f40298c5565b6", "patch": "@@ -1,3 +1,10 @@\n+2005-04-12  Frank Ch. Eigler  <fche@redhat.com>\n+\n+\tPR mudflap/19266\n+\tFrom Richard Henderson <rth@redhat.com>:\n+\t* tree-mudflap.c (mf_build_check_statement_for): Correct block\n+\tsplitting logic.\n+\n 2005-04-12  Dorit Naishlos  <dorit@il.ibm.com>\n \n \t* tree-cfg.c (tree_verify_flow_info): Use LABEL_EXPR_LABEL."}, {"sha": "b1efae87057cc97f30908f5ca1b6fd113a3743e4", "filename": "gcc/tree-mudflap.c", "status": "modified", "additions": 9, "deletions": 24, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a08a479fec88b963c28fc068d09f40298c5565b6/gcc%2Ftree-mudflap.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a08a479fec88b963c28fc068d09f40298c5565b6/gcc%2Ftree-mudflap.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-mudflap.c?ref=a08a479fec88b963c28fc068d09f40298c5565b6", "patch": "@@ -497,40 +497,25 @@ mf_build_check_statement_for (tree base, tree limit,\n   block_stmt_iterator bsi;\n   basic_block cond_bb, then_bb, join_bb;\n   edge e;\n-  tree cond, t, u, v, l1, l2;\n+  tree cond, t, u, v;\n   tree mf_base;\n   tree mf_elem;\n   tree mf_limit;\n \n   /* We first need to split the current basic block, and start altering\n      the CFG.  This allows us to insert the statements we're about to\n-     construct into the right basic blocks.  The label l1 is the label\n-     of the block for the THEN clause of the conditional jump we're\n-     about to construct, and l2 is the ELSE clause, which is just the\n-     continuation of the old statement stream.  */\n-  l1 = create_artificial_label ();\n-  l2 = create_artificial_label ();\n+     construct into the right basic blocks.  */\n+\n   cond_bb = bb_for_stmt (bsi_stmt (*instr_bsi));\n   bsi = *instr_bsi;\n   bsi_prev (&bsi);\n   if (! bsi_end_p (bsi))\n-    {\n-      /* We're processing a statement in the middle of the block, so\n-         we need to split the block.  This creates a new block and a new\n-         fallthrough edge.  */\n-      e = split_block (cond_bb, bsi_stmt (bsi));\n-      cond_bb = e->src;\n-      join_bb = e->dest;\n-    }\n+    e = split_block (cond_bb, bsi_stmt (bsi));\n   else\n-    {\n-      /* We're processing the first statement in the block, so we need\n-         to split the incoming edge.  This also creates a new block\n-         and a new fallthrough edge.  */\n-      join_bb = cond_bb;\n-      cond_bb = split_edge (find_edge (join_bb->prev_bb, join_bb));\n-    }\n-  \n+    e = split_block_after_labels (cond_bb);\n+  cond_bb = e->src;\n+  join_bb = e->dest;\n+\n   /* A recap at this point: join_bb is the basic block at whose head\n      is the gimple statement for which this check expression is being\n      built.  cond_bb is the (possibly new, synthetic) basic block the\n@@ -721,7 +706,7 @@ mf_decl_eligible_p (tree decl)\n           /* The decl must have its address taken.  In the case of\n              arrays, this flag is also set if the indexes are not\n              compile-time known valid constants.  */\n-          && TREE_ADDRESSABLE (decl)\n+          && TREE_ADDRESSABLE (decl)    /* XXX: not sufficient: return-by-value structs! */\n           /* The type of the variable must be complete.  */\n           && COMPLETE_OR_VOID_TYPE_P (TREE_TYPE (decl))\n \t  /* The decl hasn't been decomposed somehow.  */"}, {"sha": "73dfcbe50ddb056bf66d3b6dd2a30fef281a08d2", "filename": "libmudflap/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a08a479fec88b963c28fc068d09f40298c5565b6/libmudflap%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a08a479fec88b963c28fc068d09f40298c5565b6/libmudflap%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2FChangeLog?ref=a08a479fec88b963c28fc068d09f40298c5565b6", "patch": "@@ -1,3 +1,9 @@\n+2005-04-12  Frank Ch. Eigler  <fche@redhat.com>\n+\n+\tPR mudflap/19266\n+\t* testsuite/libmudflap.c++/c++frags.exp: Also test -O permutation.\n+\t* testsuite/libmudflap.c++/pass57-frag.cxx: New test.\n+\n 2005-04-04  Alan Modra  <amodra@bigpond.net.au>\n \n \t* mf-runtime.c (__mfu_unregister): Warning fix for char unsigned."}, {"sha": "1ac24adbe929bfd701c928ddc276984dce6e3ba5", "filename": "libmudflap/testsuite/libmudflap.c++/c++frags.exp", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a08a479fec88b963c28fc068d09f40298c5565b6/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fc%2B%2Bfrags.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a08a479fec88b963c28fc068d09f40298c5565b6/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fc%2B%2Bfrags.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fc%2B%2Bfrags.exp?ref=a08a479fec88b963c28fc068d09f40298c5565b6", "patch": "@@ -5,7 +5,7 @@ dg-init\n \n global srcdir\n \n-foreach flags [list {} {-static} {-O2} {-O3}] {\n+foreach flags [list {} {-static} {-O} {-O2} {-O3}] {\n     foreach srcfile [lsort [glob -nocomplain ${srcdir}/libmudflap.c++/*frag.cxx]] {\n \tset bsrc [file tail $srcfile]\n \tsetenv MUDFLAP_OPTIONS \"-viol-segv\""}, {"sha": "e4fa70176b734b98dbe823e8afa13e2ee35e0752", "filename": "libmudflap/testsuite/libmudflap.c++/pass57-frag.cxx", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a08a479fec88b963c28fc068d09f40298c5565b6/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fpass57-frag.cxx", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a08a479fec88b963c28fc068d09f40298c5565b6/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fpass57-frag.cxx", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2B%2B%2Fpass57-frag.cxx?ref=a08a479fec88b963c28fc068d09f40298c5565b6", "patch": "@@ -0,0 +1,25 @@\n+#include <vector>\n+#include <string>\n+\n+class fitscolumn\n+  {\n+  private:\n+    std::string name_, unit_;\n+   int i, t;\n+  public:\n+    fitscolumn (const std::string &nm, const std::string &un,int i1,int t1)\n+      : name_(nm), unit_(un), i(i1), t(t1){}\n+  };\n+\n+void init_bintab(std::vector<fitscolumn> & columns_)\n+{\n+  char ttype[81], tunit[81], tform[81];\n+  long repc;\n+  int typecode;\n+  columns_.push_back (fitscolumn (ttype,tunit,1,typecode));\n+}\n+\n+int main ()\n+{\n+  return 0;\n+}"}]}