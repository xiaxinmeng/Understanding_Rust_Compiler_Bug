{"sha": "8383d41d704571d7ca234c7d2f551b7b69255194", "node_id": "C_kwDOANBUbNoAKDgzODNkNDFkNzA0NTcxZDdjYTIzNGM3ZDJmNTUxYjdiNjkyNTUxOTQ", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2022-02-09T22:55:55Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2022-02-10T14:13:46Z"}, "message": "analyzer: fix testsuite issues seen with mingw [PR102052]\n\ngcc/testsuite/ChangeLog:\n\tPR analyzer/102052\n\t* gcc.dg/analyzer/fields.c (size_t): Use __SIZE_TYPE__ rather than\n\thardcoding long unsigned int.\n\t* gcc.dg/analyzer/gzio-3.c (size_t): Likewise.\n\t* gcc.dg/analyzer/gzio-3a.c (size_t): Likewise.\n\t* gcc.dg/analyzer/pr98969.c (test_1): Use __UINTPTR_TYPE__ rather\n\tthan long int.\n\t(test_2): Likewise.\n\t* gcc.dg/analyzer/pr99716-2.c (test_mountpoint): Use \"rand\" rather\n\tthan \"random\".\n\t* gcc.dg/analyzer/pr99774-1.c (size_t): Use __SIZE_TYPE__ rather\n\tthan hardcoding long unsigned int.\n\t* gcc.dg/analyzer/strndup-1.c: Add MinGW to targets that don't\n\timplement strndup.\n\t* gcc.dg/analyzer/zlib-5.c (size_t): Use __SIZE_TYPE__ rather\n\tthan hardcoding long unsigned int.\n\nSigned-off-by: David Malcolm <dmalcolm@redhat.com>", "tree": {"sha": "2e8a589936babffab8164ad9f1d2a5d5c94edadf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2e8a589936babffab8164ad9f1d2a5d5c94edadf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8383d41d704571d7ca234c7d2f551b7b69255194", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8383d41d704571d7ca234c7d2f551b7b69255194", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8383d41d704571d7ca234c7d2f551b7b69255194", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8383d41d704571d7ca234c7d2f551b7b69255194/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "3d7341cd731247c2ff6709a000837a6c924247f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d7341cd731247c2ff6709a000837a6c924247f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d7341cd731247c2ff6709a000837a6c924247f3"}], "stats": {"total": 18, "additions": 9, "deletions": 9}, "files": [{"sha": "0bf877fcf1e7017ff64c9692a51ae4210414ed58", "filename": "gcc/testsuite/gcc.dg/analyzer/fields.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffields.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffields.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Ffields.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -1,4 +1,4 @@\n-typedef long unsigned int size_t;\n+typedef __SIZE_TYPE__ size_t;\n \n extern size_t strlen (const char *__s)\n   __attribute__ ((__nothrow__ , __leaf__))"}, {"sha": "426683244ff45fc09f2be67c5fe272f7a9e6cde4", "filename": "gcc/testsuite/gcc.dg/analyzer/gzio-3.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fgzio-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fgzio-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fgzio-3.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -1,4 +1,4 @@\n-typedef long unsigned int size_t;\n+typedef __SIZE_TYPE__ size_t;\n typedef struct _IO_FILE FILE;\n extern size_t fread(void *__restrict __ptr, size_t __size, size_t __n,\n                     FILE *__restrict __stream);"}, {"sha": "faf86fa38770bb569a8003637a0f3e9285634756", "filename": "gcc/testsuite/gcc.dg/analyzer/gzio-3a.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fgzio-3a.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fgzio-3a.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fgzio-3a.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -1,4 +1,4 @@\n-typedef long unsigned int size_t;\n+typedef __SIZE_TYPE__ size_t;\n typedef struct _IO_FILE FILE;\n extern size_t fread(void *__restrict __ptr, size_t __size, size_t __n,\n                     FILE *__restrict __stream);"}, {"sha": "e4e4f0591979d9cd56efdf3f0479108eda964fa4", "filename": "gcc/testsuite/gcc.dg/analyzer/pr98969.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr98969.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr98969.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr98969.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -4,14 +4,14 @@ struct foo\n };\n \n void\n-test_1 (long int i)\n+test_1 (__UINTPTR_TYPE__ i)\n {\n   struct foo *f = (struct foo *)i;\n   f->expr = __builtin_malloc (1024);\n } /* { dg-bogus \"leak\" } */\n \n void\n-test_2 (long int i)\n+test_2 (__UINTPTR_TYPE__ i)\n {\n   __builtin_free (((struct foo *)i)->expr);\n   __builtin_free (((struct foo *)i)->expr); /* { dg-warning \"double-'free' of '\\\\*\\\\(\\\\(struct foo \\\\*\\\\)i\\\\)\\\\.expr'\" } */"}, {"sha": "adc9819643ae4f69c291e61f3231f33e0c2f0cd6", "filename": "gcc/testsuite/gcc.dg/analyzer/pr99716-2.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99716-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99716-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99716-2.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -10,7 +10,7 @@ extern int foo (void);\n void\n test_mountpoint (const char *mp)\n {\n-  const int nr_passes = 5 + (random () & 31);\n+  const int nr_passes = 5 + (rand () & 31);\n   int pass;\n   int ret = 1;\n   FILE *fp;"}, {"sha": "a0bca8b1fe252745835ffd84f8b11f16e570453c", "filename": "gcc/testsuite/gcc.dg/analyzer/pr99774-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99774-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99774-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fpr99774-1.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -7,7 +7,7 @@ typedef unsigned char uint8_t;\n typedef unsigned short uint16_t;\n typedef unsigned long uint64_t;\n typedef unsigned long uint64_t;\n-typedef long unsigned int size_t;\n+typedef __SIZE_TYPE__ size_t;\n \n extern void *calloc(size_t __nmemb, size_t __size)\n   __attribute__((__nothrow__, __leaf__))"}, {"sha": "edf494ac28448984e2225909eb6cd5f394126834", "filename": "gcc/testsuite/gcc.dg/analyzer/strndup-1.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fstrndup-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fstrndup-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fstrndup-1.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -1,4 +1,4 @@\n-/* { dg-skip-if \"no strndup in libc\" { *-*-darwin[789]* *-*-darwin10* } } */\n+/* { dg-skip-if \"no strndup in libc\" { *-*-darwin[789]* *-*-darwin10* *-*-mingw* } } */\n #include <string.h>\n #include <stdlib.h>\n "}, {"sha": "1e3746d91fc96c006091f5f70bbe6f1e004a904b", "filename": "gcc/testsuite/gcc.dg/analyzer/zlib-5.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fzlib-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8383d41d704571d7ca234c7d2f551b7b69255194/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fzlib-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fanalyzer%2Fzlib-5.c?ref=8383d41d704571d7ca234c7d2f551b7b69255194", "patch": "@@ -2,7 +2,7 @@\n \n #include \"analyzer-decls.h\"\n \n-typedef long unsigned int size_t;\n+typedef __SIZE_TYPE__ size_t;\n typedef unsigned char Byte;\n typedef unsigned int uInt;\n typedef unsigned long uLong;"}]}