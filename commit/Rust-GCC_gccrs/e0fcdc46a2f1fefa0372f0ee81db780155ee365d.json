{"sha": "e0fcdc46a2f1fefa0372f0ee81db780155ee365d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTBmY2RjNDZhMmYxZmVmYTAzNzJmMGVlODFkYjc4MDE1NWVlMzY1ZA==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-09-15T14:32:50Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-09-15T14:32:50Z"}, "message": "gcc-changelog: check git commit email address\n\ncontrib/ChangeLog:\n\n\t* gcc-changelog/git_commit.py: Check commit email.\n\t* gcc-changelog/test_email.py: Add new test.\n\t* gcc-changelog/test_patches.txt: Likewise.", "tree": {"sha": "4f00d67518b963a4b21cf9c58591cfe93a494b27", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f00d67518b963a4b21cf9c58591cfe93a494b27"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e0fcdc46a2f1fefa0372f0ee81db780155ee365d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0fcdc46a2f1fefa0372f0ee81db780155ee365d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0fcdc46a2f1fefa0372f0ee81db780155ee365d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0fcdc46a2f1fefa0372f0ee81db780155ee365d/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "26d4ba05b92d0082c7db8067021e9b3109400557", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26d4ba05b92d0082c7db8067021e9b3109400557", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26d4ba05b92d0082c7db8067021e9b3109400557"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "03736140fd05b91e19aca1c4e49ea20349762b62", "filename": "contrib/gcc-changelog/git_commit.py", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0fcdc46a2f1fefa0372f0ee81db780155ee365d/contrib%2Fgcc-changelog%2Fgit_commit.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0fcdc46a2f1fefa0372f0ee81db780155ee365d/contrib%2Fgcc-changelog%2Fgit_commit.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Fgit_commit.py?ref=e0fcdc46a2f1fefa0372f0ee81db780155ee365d", "patch": "@@ -326,6 +326,8 @@ def __init__(self, info, commit_to_info_hook=None, ref_name=None):\n         if not self.info:\n             return\n \n+        self.check_commit_email()\n+\n         # Extract PR numbers form the subject line\n         # Match either [PRnnnn] / (PRnnnn) or PR component/nnnn\n         if self.info.lines and not self.revert_commit:\n@@ -803,3 +805,11 @@ def print_errors(self):\n         print('Errors:')\n         for error in self.errors:\n             print(error)\n+\n+    def check_commit_email(self):\n+        # Parse 'Martin Liska  <mliska@suse.cz>'\n+        email = self.info.author.split(' ')[-1].strip('<>')\n+\n+        # Verify that all characters are ASCII\n+        if len(email) != len(email.encode()):\n+            self.errors.append(Error(f'non-ASCII characters in git commit email address ({email})'))"}, {"sha": "dae7c27c707944375e355c8fbc516d36595fc729", "filename": "contrib/gcc-changelog/test_email.py", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0fcdc46a2f1fefa0372f0ee81db780155ee365d/contrib%2Fgcc-changelog%2Ftest_email.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0fcdc46a2f1fefa0372f0ee81db780155ee365d/contrib%2Fgcc-changelog%2Ftest_email.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_email.py?ref=e0fcdc46a2f1fefa0372f0ee81db780155ee365d", "patch": "@@ -440,3 +440,8 @@ def test_wrong_pr_comp_in_subject(self):\n     def test_copyright_years(self):\n         email = self.from_patch_glob('copyright-years.patch')\n         assert not email.errors\n+\n+    def test_non_ascii_email(self):\n+        email = self.from_patch_glob('non-ascii-email.patch')\n+        assert (email.errors[0].message ==\n+                'non-ASCII characters in git commit email address (jbglaw@\u0142ug-owl.de)')"}, {"sha": "98a0d3f1ee022859b86d55f531cdea490887087e", "filename": "contrib/gcc-changelog/test_patches.txt", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0fcdc46a2f1fefa0372f0ee81db780155ee365d/contrib%2Fgcc-changelog%2Ftest_patches.txt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0fcdc46a2f1fefa0372f0ee81db780155ee365d/contrib%2Fgcc-changelog%2Ftest_patches.txt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fgcc-changelog%2Ftest_patches.txt?ref=e0fcdc46a2f1fefa0372f0ee81db780155ee365d", "patch": "@@ -3464,3 +3464,28 @@ index 6f67552d075..32478f070e8 100644\n +\n -- \n 2.25.1\n+\n+=== non-ascii-email.patch ===\n+From f42e95a830ab48e59389065ce79a013a519646f1 Mon Sep 17 00:00:00 2001\n+From: Jan-Benedict Glaw <jbglaw@\u0142ug-owl.de>\n+Date: Mon, 13 Sep 2021 12:08:25 +0200\n+Subject: [PATCH] Fix multi-statment macro\n+\n+INIT_CUMULATIVE_ARGS() expands to multiple statements, which will break right\n+after an `if` statement. Wrap it into a block.\n+\n+gcc/ChangeLog:\n+\n+\t* config/alpha/vms.h (INIT_CUMULATIVE_ARGS): Wrap multi-statment\n+\tdefine into a block.\n+---\n+ gcc/config/alpha/vms.h | 10 +++++++---\n+ 1 file changed, 7 insertions(+), 3 deletions(-)\n+\n+diff --git a/gcc/config/alpha/vms.h b/gcc/config/alpha/vms.h\n+index 2a9917cde62..0033b0004b3 100644\n+--- a/gcc/config/alpha/vms.h\n++++ b/gcc/config/alpha/vms.h\n+@@ -0,0 +1,1 @@\n++\n+-- "}]}