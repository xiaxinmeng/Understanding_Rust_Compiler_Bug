{"sha": "f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjJiZTA2MGZkM2MwNGIwNWMyMmYzYzc1YzFlMzJmNWIxYzdhMGY0Mw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2008-04-29T08:54:45Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-04-29T08:54:45Z"}, "message": "re PR c++/35987 (ICE with invalid if-condition)\n\n\tPR c++/35987\n\t* typeck.c (cp_build_modify_expr) <case PREINCREMENT_EXPR>: Don't build\n\tCOMPOUND_EXPR if the second argument would be error_mark_node.\n\n\t* g++.dg/other/error28.C: New test.\n\nFrom-SVN: r134786", "tree": {"sha": "c32099684fbe608cfcab212a16d22c8b3582d0c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c32099684fbe608cfcab212a16d22c8b3582d0c6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b397e31bd8dcc8b2c112a57e7dca2785cdbf569f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b397e31bd8dcc8b2c112a57e7dca2785cdbf569f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b397e31bd8dcc8b2c112a57e7dca2785cdbf569f"}], "stats": {"total": 28, "additions": 24, "deletions": 4}, "files": [{"sha": "15aa14ca4f057ca8cc536b8e5df8b6fea4d6cacd", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "patch": "@@ -1,3 +1,9 @@\n+2008-04-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/35987\n+\t* typeck.c (cp_build_modify_expr) <case PREINCREMENT_EXPR>: Don't build\n+\tCOMPOUND_EXPR if the second argument would be error_mark_node.\n+\n 2008-04-28  Jason Merrill  <jason@redhat.com>\n \t    Liu Guanwei <liu_gw@163.com>\n "}, {"sha": "bf264ad2cc731f448fd8e784d3dab022e9619677", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "patch": "@@ -5945,10 +5945,11 @@ cp_build_modify_expr (tree lhs, enum tree_code modifycode, tree rhs,\n \tlhs = build2 (TREE_CODE (lhs), TREE_TYPE (lhs),\n \t\t      stabilize_reference (TREE_OPERAND (lhs, 0)),\n \t\t      TREE_OPERAND (lhs, 1));\n-      return build2 (COMPOUND_EXPR, lhstype,\n-\t\t     lhs,\n-\t\t     cp_build_modify_expr (TREE_OPERAND (lhs, 0),\n-\t\t\t\t\t   modifycode, rhs, complain));\n+      newrhs = cp_build_modify_expr (TREE_OPERAND (lhs, 0),\n+\t\t\t\t     modifycode, rhs, complain);\n+      if (newrhs == error_mark_node)\n+\treturn error_mark_node;\n+      return build2 (COMPOUND_EXPR, lhstype, lhs, newrhs);\n \n       /* Handle (a, b) used as an \"lvalue\".  */\n     case COMPOUND_EXPR:"}, {"sha": "1154c105c9e68db3e024e980198764bdd446c1f5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "patch": "@@ -1,3 +1,8 @@\n+2008-04-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/35987\n+\t* g++.dg/other/error28.C: New test.\n+\n 2008-04-28  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/36073"}, {"sha": "5ac15b7de1ee43ef4fa69d806bb0345ba055866f", "filename": "gcc/testsuite/g++.dg/other/error28.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror28.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror28.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror28.C?ref=f2be060fd3c04b05c22f3c75c1e32f5b1c7a0f43", "patch": "@@ -0,0 +1,8 @@\n+// PR c++/35987\n+// { dg-do compile }\n+\n+void\n+foo (char *p)\n+{\n+  if (++p = true);\t// { dg-error \"cannot convert\" }\n+}"}]}