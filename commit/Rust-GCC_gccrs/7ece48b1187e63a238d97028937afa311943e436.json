{"sha": "7ece48b1187e63a238d97028937afa311943e436", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2VjZTQ4YjExODdlNjNhMjM4ZDk3MDI4OTM3YWZhMzExOTQzZTQzNg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2010-03-03T09:58:11Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-03-03T09:58:11Z"}, "message": "re PR debug/43229 (ice expand_debug_expr, at cfgexpand.c:2957)\n\n\tPR debug/43229\n\t* cfgexpand.c (expand_debug_expr): Handle DOT_PROD_EXPR,\n\tWIDEN_MULT_EXPR and WIDEN_SUM_EXPR.  Return NULL without\n\tICE for vector expressions, ADDR_SPACE_CONVERT_EXPR,\n\tFIXED_CONVERT_EXPR, OBJ_TYPE_REF and WITH_SIZE_EXPR.\n\n\t* gfortran.dg/pr43229.f90: New test.\n\nFrom-SVN: r157191", "tree": {"sha": "71bbb049c7364bc9f56491192c5d5bbdc2a74bb4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/71bbb049c7364bc9f56491192c5d5bbdc2a74bb4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7ece48b1187e63a238d97028937afa311943e436", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ece48b1187e63a238d97028937afa311943e436", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7ece48b1187e63a238d97028937afa311943e436", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7ece48b1187e63a238d97028937afa311943e436/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0508bed7ffc2de0ccfebf7bde414a31f3062a21a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0508bed7ffc2de0ccfebf7bde414a31f3062a21a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0508bed7ffc2de0ccfebf7bde414a31f3062a21a"}], "stats": {"total": 95, "additions": 95, "deletions": 0}, "files": [{"sha": "a481136dbb63d59e994b066aeb42261b553c55eb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ece48b1187e63a238d97028937afa311943e436/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ece48b1187e63a238d97028937afa311943e436/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7ece48b1187e63a238d97028937afa311943e436", "patch": "@@ -1,5 +1,11 @@\n 2010-03-03  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/43229\n+\t* cfgexpand.c (expand_debug_expr): Handle DOT_PROD_EXPR,\n+\tWIDEN_MULT_EXPR and WIDEN_SUM_EXPR.  Return NULL without\n+\tICE for vector expressions, ADDR_SPACE_CONVERT_EXPR,\n+\tFIXED_CONVERT_EXPR, OBJ_TYPE_REF and WITH_SIZE_EXPR.\n+\n \tPR debug/43237\n \t* dwarf2out.c (add_bound_info): If a decl bound doesn't have decl_die,\n \tfallthrough to default handling, just with want_address 0 instead of 2."}, {"sha": "ee14599340459d201a0b453165dfd8e9d8ae99bd", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 76, "deletions": 0, "changes": 76, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ece48b1187e63a238d97028937afa311943e436/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ece48b1187e63a238d97028937afa311943e436/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=7ece48b1187e63a238d97028937afa311943e436", "patch": "@@ -2230,6 +2230,7 @@ expand_debug_expr (tree exp)\n       switch (TREE_CODE (exp))\n \t{\n \tcase COND_EXPR:\n+\tcase DOT_PROD_EXPR:\n \t  goto ternary;\n \n \tcase TRUTH_ANDIF_EXPR:\n@@ -2950,6 +2951,81 @@ expand_debug_expr (tree exp)\n     case ERROR_MARK:\n       return NULL;\n \n+    /* Vector stuff.  For most of the codes we don't have rtl codes.  */\n+    case REALIGN_LOAD_EXPR:\n+    case REDUC_MAX_EXPR:\n+    case REDUC_MIN_EXPR:\n+    case REDUC_PLUS_EXPR:\n+    case VEC_COND_EXPR:\n+    case VEC_EXTRACT_EVEN_EXPR:\n+    case VEC_EXTRACT_ODD_EXPR:\n+    case VEC_INTERLEAVE_HIGH_EXPR:\n+    case VEC_INTERLEAVE_LOW_EXPR:\n+    case VEC_LSHIFT_EXPR:\n+    case VEC_PACK_FIX_TRUNC_EXPR:\n+    case VEC_PACK_SAT_EXPR:\n+    case VEC_PACK_TRUNC_EXPR:\n+    case VEC_RSHIFT_EXPR:\n+    case VEC_UNPACK_FLOAT_HI_EXPR:\n+    case VEC_UNPACK_FLOAT_LO_EXPR:\n+    case VEC_UNPACK_HI_EXPR:\n+    case VEC_UNPACK_LO_EXPR:\n+    case VEC_WIDEN_MULT_HI_EXPR:\n+    case VEC_WIDEN_MULT_LO_EXPR:\n+      return NULL;\n+\n+   /* Misc codes.  */\n+    case ADDR_SPACE_CONVERT_EXPR:\n+    case FIXED_CONVERT_EXPR:\n+    case OBJ_TYPE_REF:\n+    case WITH_SIZE_EXPR:\n+      return NULL;\n+\n+    case DOT_PROD_EXPR:\n+      if (SCALAR_INT_MODE_P (GET_MODE (op0))\n+\t  && SCALAR_INT_MODE_P (mode))\n+\t{\n+\t  if (TYPE_UNSIGNED (TREE_TYPE (TREE_OPERAND (exp, 0))))\n+\t    op0 = gen_rtx_ZERO_EXTEND (mode, op0);\n+\t  else\n+\t    op0 = gen_rtx_SIGN_EXTEND (mode, op0);\n+\t  if (TYPE_UNSIGNED (TREE_TYPE (TREE_OPERAND (exp, 1))))\n+\t    op1 = gen_rtx_ZERO_EXTEND (mode, op1);\n+\t  else\n+\t    op1 = gen_rtx_SIGN_EXTEND (mode, op1);\n+\t  op0 = gen_rtx_MULT (mode, op0, op1);\n+\t  return gen_rtx_PLUS (mode, op0, op2);\n+\t}\n+      return NULL;\n+\n+    case WIDEN_MULT_EXPR:\n+      if (SCALAR_INT_MODE_P (GET_MODE (op0))\n+\t  && SCALAR_INT_MODE_P (mode))\n+\t{\n+\t  if (TYPE_UNSIGNED (TREE_TYPE (TREE_OPERAND (exp, 0))))\n+\t    op0 = gen_rtx_ZERO_EXTEND (mode, op0);\n+\t  else\n+\t    op0 = gen_rtx_SIGN_EXTEND (mode, op0);\n+\t  if (TYPE_UNSIGNED (TREE_TYPE (TREE_OPERAND (exp, 1))))\n+\t    op1 = gen_rtx_ZERO_EXTEND (mode, op1);\n+\t  else\n+\t    op1 = gen_rtx_SIGN_EXTEND (mode, op1);\n+\t  return gen_rtx_MULT (mode, op0, op1);\n+\t}\n+      return NULL;\n+\n+    case WIDEN_SUM_EXPR:\n+      if (SCALAR_INT_MODE_P (GET_MODE (op0))\n+\t  && SCALAR_INT_MODE_P (mode))\n+\t{\n+\t  if (TYPE_UNSIGNED (TREE_TYPE (TREE_OPERAND (exp, 0))))\n+\t    op0 = gen_rtx_ZERO_EXTEND (mode, op0);\n+\t  else\n+\t    op0 = gen_rtx_SIGN_EXTEND (mode, op0);\n+\t  return gen_rtx_PLUS (mode, op0, op1);\n+\t}\n+      return NULL;\n+\n     default:\n     flag_unsupported:\n #ifdef ENABLE_CHECKING"}, {"sha": "9e81c0dd6de16c9cc0993943c6919ecaecda6867", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ece48b1187e63a238d97028937afa311943e436/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ece48b1187e63a238d97028937afa311943e436/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7ece48b1187e63a238d97028937afa311943e436", "patch": "@@ -1,5 +1,8 @@\n 2010-03-03  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/43229\n+\t* gfortran.dg/pr43229.f90: New test.\n+\n \tPR debug/43237\n \t* gcc.dg/debug/dwarf2/pr43237.c: New test.\n "}, {"sha": "361ea94559ec5c32756118f0c437bf3f22fd768b", "filename": "gcc/testsuite/gfortran.dg/pr43229.f90", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7ece48b1187e63a238d97028937afa311943e436/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr43229.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7ece48b1187e63a238d97028937afa311943e436/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr43229.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr43229.f90?ref=7ece48b1187e63a238d97028937afa311943e436", "patch": "@@ -0,0 +1,10 @@\n+! PR debug/43229\n+! { dg-do compile }\n+! { dg-options \"-g -O3 -ffast-math\" }\n+! { dg-options \"-g -O3 -ffast-math -msse3\" { target { i?86-*-* x86_64-*-* } } }\n+\n+function foo (c, d)\n+  real(8) :: c(6), d(6), foo\n+  x = sum (c * d)\n+  foo = exp (-x)\n+end function foo"}]}