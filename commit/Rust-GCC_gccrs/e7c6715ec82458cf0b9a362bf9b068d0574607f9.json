{"sha": "e7c6715ec82458cf0b9a362bf9b068d0574607f9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTdjNjcxNWVjODI0NThjZjBiOWEzNjJiZjliMDY4ZDA1NzQ2MDdmOQ==", "commit": {"author": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-06-16T07:48:23Z"}, "committer": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-06-16T07:48:23Z"}, "message": "re PR d/90602 (ICE: null field)\n\n\tPR d/90602\nd/dmd: Merge upstream dmd 420cce2a6\n\nFixes internal compiler error during CTFE.\n\nReviewed-on: https://github.com/dlang/dmd/pull/9997\n\nFrom-SVN: r272342", "tree": {"sha": "d8473be2cfc157fafdab06c9ebb73c750502a282", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8473be2cfc157fafdab06c9ebb73c750502a282"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e7c6715ec82458cf0b9a362bf9b068d0574607f9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7c6715ec82458cf0b9a362bf9b068d0574607f9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e7c6715ec82458cf0b9a362bf9b068d0574607f9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7c6715ec82458cf0b9a362bf9b068d0574607f9/comments", "author": null, "committer": null, "parents": [{"sha": "22682e5b5f7cc596b165534ad9b8f201354126ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22682e5b5f7cc596b165534ad9b8f201354126ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22682e5b5f7cc596b165534ad9b8f201354126ce"}], "stats": {"total": 28, "additions": 24, "deletions": 4}, "files": [{"sha": "7456d604a91f79f8d7f83ed7db3eec4079da1750", "filename": "gcc/d/dmd/MERGE", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7c6715ec82458cf0b9a362bf9b068d0574607f9/gcc%2Fd%2Fdmd%2FMERGE", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7c6715ec82458cf0b9a362bf9b068d0574607f9/gcc%2Fd%2Fdmd%2FMERGE", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2FMERGE?ref=e7c6715ec82458cf0b9a362bf9b068d0574607f9", "patch": "@@ -1,4 +1,4 @@\n-c74e624c9a0a9e7e39f96b2f005f86e123df56c9\n+420cce2a654f14b8de4a75cbb5d4203fce8d4e0f\n \n The first line of this file holds the git revision number of the last\n merge done from the dlang/dmd repository."}, {"sha": "0749c7f487dd0d222ed25f5718fc9504d4c614cd", "filename": "gcc/d/dmd/dinterpret.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7c6715ec82458cf0b9a362bf9b068d0574607f9/gcc%2Fd%2Fdmd%2Fdinterpret.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7c6715ec82458cf0b9a362bf9b068d0574607f9/gcc%2Fd%2Fdmd%2Fdinterpret.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fdmd%2Fdinterpret.c?ref=e7c6715ec82458cf0b9a362bf9b068d0574607f9", "patch": "@@ -6053,9 +6053,16 @@ class Interpreter : public Visitor\n         result = (*se->elements)[i];\n         if (!result)\n         {\n-            e->error(\"Internal Compiler Error: null field %s\", v->toChars());\n-            result = CTFEExp::cantexp;\n-            return;\n+            // https://issues.dlang.org/show_bug.cgi?id=19897\n+            // Zero-length fields don't have an initializer.\n+            if (v->type->size() == 0)\n+                result = voidInitLiteral(e->type, v).copy();\n+            else\n+            {\n+                e->error(\"Internal Compiler Error: null field %s\", v->toChars());\n+                result = CTFEExp::cantexp;\n+                return;\n+            }\n         }\n         if (result->op == TOKvoid)\n         {"}, {"sha": "8dd4e149a87779b250e3e197da74898a3e17b8f4", "filename": "gcc/testsuite/gdc.test/fail_compilation/fail19897.d", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7c6715ec82458cf0b9a362bf9b068d0574607f9/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Ffail19897.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7c6715ec82458cf0b9a362bf9b068d0574607f9/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Ffail19897.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgdc.test%2Ffail_compilation%2Ffail19897.d?ref=e7c6715ec82458cf0b9a362bf9b068d0574607f9", "patch": "@@ -0,0 +1,13 @@\n+// PERMUTE_ARGS:\n+/*\n+TEST_OUTPUT\n+---\n+fail_compilation/fail19897.d(10): Error: cannot implicitly convert expression `[]` of type `const(char[0])` to `const(char)`\n+---\n+*/\n+struct S\n+{\n+    char[0] x;\n+}\n+const a = S('a');\n+const char c = a.x;"}]}