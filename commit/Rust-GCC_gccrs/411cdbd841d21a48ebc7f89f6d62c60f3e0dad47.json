{"sha": "411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDExY2RiZDg0MWQyMWE0OGViYzdmODlmNmQ2MmM2MGYzZTBkYWQ0Nw==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2011-03-21T15:32:21Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2011-03-21T15:32:21Z"}, "message": "re PR c/47939 (Missing DW_TAG_typedef for qualified types)\n\n2011-03-21  Richard Guenther  <rguenther@suse.de>\n\n\tPR c/47939\n\t* c-decl.c (grokdeclarator): Drop to the main variant only\n\tfor array types.  Drop flag_gen_aux_info check.\n\n\t* gcc.dg/debug/dwarf2/pr47939-1.c: New testcase.\n\t* gcc.dg/debug/dwarf2/pr47939-2.c: Likewise.\n\t* gcc.dg/debug/dwarf2/pr47939-3.c: Likewise.\n\t* gcc.dg/debug/dwarf2/pr47939-4.c: Likewise.\n\nFrom-SVN: r171245", "tree": {"sha": "7dac4958a64d9e0a01ed6573dd9934b15b0dd2cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7dac4958a64d9e0a01ed6573dd9934b15b0dd2cc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "html_url": "https://github.com/Rust-GCC/gccrs/commit/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1cd9e4164e333f1c4bfc32ed3dd5550b2e625d4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cd9e4164e333f1c4bfc32ed3dd5550b2e625d4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1cd9e4164e333f1c4bfc32ed3dd5550b2e625d4a"}], "stats": {"total": 56, "additions": 55, "deletions": 1}, "files": [{"sha": "30542ef287ad8180450ae3f7d8f4de1645a5074d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "patch": "@@ -1,3 +1,9 @@\n+2011-03-21  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR c/47939\n+\t* c-decl.c (grokdeclarator): Drop to the main variant only\n+\tfor array types.  Drop flag_gen_aux_info check.\n+\n 2011-03-21  Richard Guenther  <rguenther@suse.de>\n \n \tPR translation/47911"}, {"sha": "1af3d23b6778d484c0ef6d3aec625dde5fa16ae2", "filename": "gcc/c-decl.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-decl.c?ref=411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "patch": "@@ -4888,6 +4888,7 @@ grokdeclarator (const struct c_declarator *declarator,\n   const char *errmsg;\n   tree expr_dummy;\n   bool expr_const_operands_dummy;\n+  enum c_declarator_kind first_non_attr_kind;\n \n   if (TREE_CODE (type) == ERROR_MARK)\n     return error_mark_node;\n@@ -4907,6 +4908,7 @@ grokdeclarator (const struct c_declarator *declarator,\n   {\n     const struct c_declarator *decl = declarator;\n \n+    first_non_attr_kind = cdk_attrs;\n     while (decl)\n       switch (decl->kind)\n \t{\n@@ -4918,6 +4920,8 @@ grokdeclarator (const struct c_declarator *declarator,\n \tcase cdk_pointer:\n \t  funcdef_syntax = (decl->kind == cdk_function);\n \t  decl = decl->declarator;\n+\t  if (first_non_attr_kind == cdk_attrs)\n+\t    first_non_attr_kind = decl->kind;\n \t  break;\n \n \tcase cdk_attrs:\n@@ -4928,6 +4932,8 @@ grokdeclarator (const struct c_declarator *declarator,\n \t  loc = decl->id_loc;\n \t  if (decl->u.id)\n \t    name = decl->u.id;\n+\t  if (first_non_attr_kind == cdk_attrs)\n+\t    first_non_attr_kind = decl->kind;\n \t  decl = 0;\n \t  break;\n \n@@ -5034,7 +5040,9 @@ grokdeclarator (const struct c_declarator *declarator,\n     error_at (loc, \"conflicting named address spaces (%s vs %s)\",\n \t      c_addr_space_name (as1), c_addr_space_name (as2));\n \n-  if (!flag_gen_aux_info && (TYPE_QUALS (element_type)))\n+  if ((TREE_CODE (type) == ARRAY_TYPE\n+       || first_non_attr_kind == cdk_array)\n+      && TYPE_QUALS (element_type))\n     type = TYPE_MAIN_VARIANT (type);\n   type_quals = ((constp ? TYPE_QUAL_CONST : 0)\n \t\t| (restrictp ? TYPE_QUAL_RESTRICT : 0)"}, {"sha": "8bce5264b36df89ea547d6d2665b98b69aa7672f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "patch": "@@ -1,3 +1,11 @@\n+2011-03-21  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR c/47939\n+\t* gcc.dg/debug/dwarf2/pr47939-1.c: New testcase.\n+\t* gcc.dg/debug/dwarf2/pr47939-2.c: Likewise.\n+\t* gcc.dg/debug/dwarf2/pr47939-3.c: Likewise.\n+\t* gcc.dg/debug/dwarf2/pr47939-4.c: Likewise.\n+\n 2011-03-21  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/48213"}, {"sha": "7854fdf73bb5b07138d8bf23a7966ed1785fca26", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/pr47939-1.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-1.c?ref=411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-save-temps -g -dA\" } */\n+\n+typedef struct _Harry { int dummy; } Harry_t;\n+Harry_t harry;\n+\n+/* { dg-final { scan-assembler \"DW_TAG_typedef\\[^\\\\r\\\\n\\]*\\[\\\\r\\\\n\\]+\\[^\\\\r\\\\n\\]*DW_AT_name: \\\"Harry_t\\\"\" } } */\n+/* { dg-final { cleanup-saved-temps } } */"}, {"sha": "8b623aef9ff8f0026840dcf038971bb702dc1583", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/pr47939-2.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-2.c?ref=411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-save-temps -g -dA\" } */\n+\n+typedef const struct _Harry { int dummy; } Harry_t;\n+Harry_t harry;\n+\n+/* { dg-final { scan-assembler \"DW_TAG_typedef\\[^\\\\r\\\\n\\]*\\[\\\\r\\\\n\\]+\\[^\\\\r\\\\n\\]*DW_AT_name: \\\"Harry_t\\\"\" } } */\n+/* { dg-final { cleanup-saved-temps } } */"}, {"sha": "374e6cc9077e33120a1008ca729ab3e5cedac1a5", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/pr47939-3.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-3.c?ref=411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-save-temps -g -dA\" } */\n+\n+typedef struct _Harry { int dummy; } Harry_t;\n+const Harry_t harry[5];\n+\n+/* { dg-final { scan-assembler \"DW_TAG_typedef\\[^\\\\r\\\\n\\]*\\[\\\\r\\\\n\\]+\\[^\\\\r\\\\n\\]*DW_AT_name: \\\"Harry_t\\\"\" } } */\n+/* { dg-final { cleanup-saved-temps } } */"}, {"sha": "57db399595c937c1b7cd6e11e026c052e5a5c65f", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/pr47939-4.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/411cdbd841d21a48ebc7f89f6d62c60f3e0dad47/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr47939-4.c?ref=411cdbd841d21a48ebc7f89f6d62c60f3e0dad47", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-save-temps -g -dA\" } */\n+\n+typedef const struct _Harry { int dummy; } Harry_t;\n+Harry_t harry[10];\n+\n+/* { dg-final { scan-assembler \"DW_TAG_typedef\\[^\\\\r\\\\n\\]*\\[\\\\r\\\\n\\]+\\[^\\\\r\\\\n\\]*DW_AT_name: \\\"Harry_t\\\"\" } } */\n+/* { dg-final { cleanup-saved-temps } } */"}]}