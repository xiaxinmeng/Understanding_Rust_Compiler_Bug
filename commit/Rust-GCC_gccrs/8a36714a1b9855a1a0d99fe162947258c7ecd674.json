{"sha": "8a36714a1b9855a1a0d99fe162947258c7ecd674", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGEzNjcxNGExYjk4NTVhMWEwZDk5ZmUxNjI5NDcyNThjN2VjZDY3NA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2015-06-30T11:00:32Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2015-06-30T11:00:32Z"}, "message": "Add parloops-exit-first-loop-alt-{5,6,7}.c\n\n2015-06-30  Tom de Vries  <tom@codesourcery.com>\n\n\t* gcc.dg/parloops-exit-first-loop-alt-5.c: New test.\n\t* gcc.dg/parloops-exit-first-loop-alt-6.c: New test.\n\t* gcc.dg/parloops-exit-first-loop-alt-7.c: New test.\n\t* gcc.dg/parloops-exit-first-loop-alt.c: Update comment.\n\n\t* testsuite/libgomp.c/parloops-exit-first-loop-alt-5.c: New test.\n\t* testsuite/libgomp.c/parloops-exit-first-loop-alt-6.c: New test.\n\t* testsuite/libgomp.c/parloops-exit-first-loop-alt-7.c: New test.\n\t* testsuite/libgomp.c/parloops-exit-first-loop-alt.c: Update comment.\n\nFrom-SVN: r225172", "tree": {"sha": "a89f71d09711a34b193026e0ad4127a399180399", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a89f71d09711a34b193026e0ad4127a399180399"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8a36714a1b9855a1a0d99fe162947258c7ecd674", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a36714a1b9855a1a0d99fe162947258c7ecd674", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a36714a1b9855a1a0d99fe162947258c7ecd674", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a36714a1b9855a1a0d99fe162947258c7ecd674/comments", "author": null, "committer": null, "parents": [{"sha": "a4398a300ed00d842f9786d529a7a4b0fce6e634", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a4398a300ed00d842f9786d529a7a4b0fce6e634", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a4398a300ed00d842f9786d529a7a4b0fce6e634"}], "stats": {"total": 309, "additions": 307, "deletions": 2}, "files": [{"sha": "8716cd3b9f6e789eb7c2cde3d936e03e4fd20406", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -1,3 +1,10 @@\n+2015-06-30  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* gcc.dg/parloops-exit-first-loop-alt-5.c: New test.\n+\t* gcc.dg/parloops-exit-first-loop-alt-6.c: New test.\n+\t* gcc.dg/parloops-exit-first-loop-alt-7.c: New test.\n+\t* gcc.dg/parloops-exit-first-loop-alt.c: Update comment.\n+\n 2015-06-30  Marek Polacek  <polacek@redhat.com>\n \n \t* gcc.dg/fold-ior-2.c: New test."}, {"sha": "3f799cf234d061bdba1fefd83b32de60d88c56e9", "filename": "gcc/testsuite/gcc.dg/parloops-exit-first-loop-alt-5.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-5.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -0,0 +1,22 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target pthread } */\n+/* { dg-options \"-O2 -ftree-parallelize-loops=2 -fdump-tree-parloops\" } */\n+\n+/* Variable bound, vector addition, unsigned loop counter, unsigned bound.  */\n+\n+void\n+f (unsigned int n, unsigned int *__restrict__ a, unsigned int *__restrict__ b,\n+   unsigned int *__restrict__ c)\n+{\n+  unsigned int i;\n+\n+  for (i = 0; i < n; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+/* Three times a store:\n+   - one in f._loopfn.0\n+   - one in the parallel\n+   - one in the low iteration count loop\n+   Crucially, none for a peeled off last iteration following the parallel.  */\n+/* { dg-final { scan-tree-dump-times \"(?n)^  \\\\*_\\[0-9\\]*\" 3 \"parloops\" } } */"}, {"sha": "ee19a55849a97b952aeacee1f4395a0257b2886b", "filename": "gcc/testsuite/gcc.dg/parloops-exit-first-loop-alt-6.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-6.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -0,0 +1,22 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target pthread } */\n+/* { dg-options \"-O2 -ftree-parallelize-loops=2 -fdump-tree-parloops\" } */\n+\n+/* Variable bound, vector addition, unsigned loop counter, signed bound.  */\n+\n+void\n+f (int n, unsigned int *__restrict__ a, unsigned int *__restrict__ b,\n+   unsigned int *__restrict__ c)\n+{\n+  unsigned int i;\n+\n+  for (i = 0; i < n; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+/* Three times a store:\n+   - one in f._loopfn.0\n+   - one in the parallel\n+   - one in the low iteration count loop\n+   Crucially, none for a peeled off last iteration following the parallel.  */\n+/* { dg-final { scan-tree-dump-times \"(?n)^  \\\\*_\\[0-9\\]*\" 3 \"parloops\" } } */"}, {"sha": "c3373425281dbe79e4f3eb4b6bb3f3c6e859401f", "filename": "gcc/testsuite/gcc.dg/parloops-exit-first-loop-alt-7.c", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt-7.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -0,0 +1,22 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target pthread } */\n+/* { dg-options \"-O2 -ftree-parallelize-loops=2 -fdump-tree-parloops\" } */\n+\n+/* Variable bound, vector addition, signed loop counter, signed bound.  */\n+\n+void\n+f (int n, unsigned int *__restrict__ a, unsigned int *__restrict__ b,\n+   unsigned int *__restrict__ c)\n+{\n+  int i;\n+\n+  for (i = 0; i < n; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+/* Three times a store:\n+   - one in f._loopfn.0\n+   - one in the parallel\n+   - one in the low iteration count loop\n+   Crucially, none for a peeled off last iteration following the parallel.  */\n+/* { dg-final { scan-tree-dump-times \"(?n)^  \\\\*_\\[0-9\\]*\" 3 \"parloops\" } } */"}, {"sha": "0b6916507f41dbf202c84165a5539bf26653f72f", "filename": "gcc/testsuite/gcc.dg/parloops-exit-first-loop-alt.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fparloops-exit-first-loop-alt.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -2,7 +2,7 @@\n /* { dg-require-effective-target pthread } */\n /* { dg-options \"-O2 -ftree-parallelize-loops=2 -fdump-tree-parloops\" } */\n \n-/* Variable bound, vector addition.  */\n+/* Variable bound, vector addition, signed loop counter, unsigned bound.  */\n \n void\n f (unsigned int n, unsigned int *__restrict__ a, unsigned int *__restrict__ b,"}, {"sha": "a5c51f5639d2e071bbe6a89023c2fb9eb3c5c21b", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -1,3 +1,10 @@\n+2015-06-30  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* testsuite/libgomp.c/parloops-exit-first-loop-alt-5.c: New test.\n+\t* testsuite/libgomp.c/parloops-exit-first-loop-alt-6.c: New test.\n+\t* testsuite/libgomp.c/parloops-exit-first-loop-alt-7.c: New test.\n+\t* testsuite/libgomp.c/parloops-exit-first-loop-alt.c: Update comment.\n+\n 2015-06-30  Tom de Vries  <tom@codesourcery.com>\n \n \tPR tree-optimization/66652"}, {"sha": "d8d49b41aa5d59b01244bfe3d9e2aae50cd4b64b", "filename": "libgomp/testsuite/libgomp.c/parloops-exit-first-loop-alt-5.c", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-5.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -0,0 +1,75 @@\n+/* { dg-do run } */\n+/* { dg-additional-options \"-ftree-parallelize-loops=2\" } */\n+\n+/* Variable bound, vector addition, unsigned loop counter, unsigned bound.  */\n+\n+#include <stdio.h>\n+#include <stdlib.h>\n+\n+#define N 1000\n+\n+unsigned int a[N];\n+unsigned int b[N];\n+unsigned int c[N];\n+\n+void __attribute__((noclone,noinline))\n+f (unsigned int n, unsigned int *__restrict__ a, unsigned int *__restrict__ b,\n+   unsigned int *__restrict__ c)\n+{\n+  unsigned int i;\n+\n+  for (i = 0; i < n; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+static void __attribute__((noclone,noinline))\n+init (void)\n+{\n+  int i, j;\n+\n+  /* Complexify loop to inhibit parloops.  */\n+  for (j = 0; j < 100; ++j)\n+    for (i = 0; i < 10; i++)\n+      {\n+\tint k = i + (10 * j);\n+\ta[k] = k;\n+\tb[k] = (k * 3) % 7;\n+\tc[k] = k * 2;\n+      }\n+}\n+\n+int\n+main (void)\n+{\n+  int i;\n+\n+  init ();\n+\n+  f (N, a, b, c);\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      unsigned int actual = c[i];\n+      unsigned int expected = i + ((i * 3) % 7);\n+      if (actual != expected)\n+\tabort ();\n+    }\n+\n+  /* Test low iteration count case.  */\n+\n+  init ();\n+\n+  f (10, a, b, c);\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      unsigned int actual = c[i];\n+      unsigned int expected = (i < 10\n+\t\t\t       ? i + ((i * 3) % 7)\n+\t\t\t       : i * 2);\n+      if (actual != expected)\n+\tabort ();\n+    }\n+\n+  return 0;\n+}"}, {"sha": "99c61c0c967e4178cebb6c64fdc9dc111d7f9fdd", "filename": "libgomp/testsuite/libgomp.c/parloops-exit-first-loop-alt-6.c", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-6.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -0,0 +1,75 @@\n+/* { dg-do run } */\n+/* { dg-additional-options \"-ftree-parallelize-loops=2\" } */\n+\n+/* Variable bound, vector addition, unsigned loop counter, signed bound.  */\n+\n+#include <stdio.h>\n+#include <stdlib.h>\n+\n+#define N 1000\n+\n+unsigned int a[N];\n+unsigned int b[N];\n+unsigned int c[N];\n+\n+void __attribute__((noclone,noinline))\n+f (int n, unsigned int *__restrict__ a, unsigned int *__restrict__ b,\n+   unsigned int *__restrict__ c)\n+{\n+  unsigned int i;\n+\n+  for (i = 0; i < n; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+static void __attribute__((noclone,noinline))\n+init (void)\n+{\n+  int i, j;\n+\n+  /* Complexify loop to inhibit parloops.  */\n+  for (j = 0; j < 100; ++j)\n+    for (i = 0; i < 10; i++)\n+      {\n+\tint k = i + (10 * j);\n+\ta[k] = k;\n+\tb[k] = (k * 3) % 7;\n+\tc[k] = k * 2;\n+      }\n+}\n+\n+int\n+main (void)\n+{\n+  int i;\n+\n+  init ();\n+\n+  f (N, a, b, c);\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      unsigned int actual = c[i];\n+      unsigned int expected = i + ((i * 3) % 7);\n+      if (actual != expected)\n+\tabort ();\n+    }\n+\n+  /* Test low iteration count case.  */\n+\n+  init ();\n+\n+  f (10, a, b, c);\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      unsigned int actual = c[i];\n+      unsigned int expected = (i < 10\n+\t\t\t       ? i + ((i * 3) % 7)\n+\t\t\t       : i * 2);\n+      if (actual != expected)\n+\tabort ();\n+    }\n+\n+  return 0;\n+}"}, {"sha": "1f6e5e42ea48991210b5b3ec3b3c999a476080c2", "filename": "libgomp/testsuite/libgomp.c/parloops-exit-first-loop-alt-7.c", "status": "added", "additions": 75, "deletions": 0, "changes": 75, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt-7.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -0,0 +1,75 @@\n+/* { dg-do run } */\n+/* { dg-additional-options \"-ftree-parallelize-loops=2\" } */\n+\n+/* Variable bound, vector addition, signed loop counter, signed bound.  */\n+\n+#include <stdio.h>\n+#include <stdlib.h>\n+\n+#define N 1000\n+\n+unsigned int a[N];\n+unsigned int b[N];\n+unsigned int c[N];\n+\n+void __attribute__((noclone,noinline))\n+f (int n, unsigned int *__restrict__ a, unsigned int *__restrict__ b,\n+   unsigned int *__restrict__ c)\n+{\n+  int i;\n+\n+  for (i = 0; i < n; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+static void __attribute__((noclone,noinline))\n+init (void)\n+{\n+  int i, j;\n+\n+  /* Complexify loop to inhibit parloops.  */\n+  for (j = 0; j < 100; ++j)\n+    for (i = 0; i < 10; i++)\n+      {\n+\tint k = i + (10 * j);\n+\ta[k] = k;\n+\tb[k] = (k * 3) % 7;\n+\tc[k] = k * 2;\n+      }\n+}\n+\n+int\n+main (void)\n+{\n+  int i;\n+\n+  init ();\n+\n+  f (N, a, b, c);\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      unsigned int actual = c[i];\n+      unsigned int expected = i + ((i * 3) % 7);\n+      if (actual != expected)\n+\tabort ();\n+    }\n+\n+  /* Test low iteration count case.  */\n+\n+  init ();\n+\n+  f (10, a, b, c);\n+\n+  for (i = 0; i < N; i++)\n+    {\n+      unsigned int actual = c[i];\n+      unsigned int expected = (i < 10\n+\t\t\t       ? i + ((i * 3) % 7)\n+\t\t\t       : i * 2);\n+      if (actual != expected)\n+\tabort ();\n+    }\n+\n+  return 0;\n+}"}, {"sha": "d67a4f67ece531177c9e6056fa6a04a47fe6ad7b", "filename": "libgomp/testsuite/libgomp.c/parloops-exit-first-loop-alt.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8a36714a1b9855a1a0d99fe162947258c7ecd674/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.c%2Fparloops-exit-first-loop-alt.c?ref=8a36714a1b9855a1a0d99fe162947258c7ecd674", "patch": "@@ -1,7 +1,7 @@\n /* { dg-do run } */\n /* { dg-additional-options \"-ftree-parallelize-loops=2\" } */\n \n-/* Variable bound, vector addition.  */\n+/* Variable bound, vector addition, signed loop counter, unsigned bound.  */\n \n #include <stdio.h>\n #include <stdlib.h>"}]}