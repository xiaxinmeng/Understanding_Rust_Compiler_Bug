{"sha": "f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjFiOTBhMDRlMGY4ZTY4MmE0MDUzYjhlMGQwNmM2YWZiMWVlMTIxOQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-06-25T04:48:53Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-06-25T04:48:53Z"}, "message": "decl.c (grokdeclarator): Restore error messages about __thread.\n\n\t* decl.c (grokdeclarator): Restore error messages about __thread.\n\t* parser.c (cp_parser_decl_specifier_seq): Likewise.\n\nFrom-SVN: r83636", "tree": {"sha": "47e9d68b420fdc69750338b04b896682933feb34", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/47e9d68b420fdc69750338b04b896682933feb34"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219/comments", "author": null, "committer": null, "parents": [{"sha": "6f0aa5e195d89a7e494e0362596df853762b4dac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6f0aa5e195d89a7e494e0362596df853762b4dac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6f0aa5e195d89a7e494e0362596df853762b4dac"}], "stats": {"total": 55, "additions": 46, "deletions": 9}, "files": [{"sha": "0063722b879fb2db35a9c441f918eec5d52c541c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219", "patch": "@@ -1,3 +1,8 @@\n+2004-06-24  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* decl.c (grokdeclarator): Restore error messages about __thread.\n+\t* parser.c (cp_parser_decl_specifier_seq): Likewise.\n+\n 2004-06-24  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/16115"}, {"sha": "5f7fb81ee06910b7c379c247ac44b928576c8e68", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 31, "deletions": 3, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219", "patch": "@@ -6545,7 +6545,25 @@ grokdeclarator (const cp_declarator *declarator,\n \t    longlong = 1;\n \t} \n       else if (declspecs->specs[(int)ds] > 1)\n-\terror (\"duplicate decl-specifier\");\n+\t{\n+\t  static const char *decl_spec_names[] = {\n+\t    \"signed\",\n+\t    \"unsigned\",\n+\t    \"short\",\n+\t    \"long\",\n+\t    \"const\",\n+\t    \"volatile\",\n+\t    \"restrict\",\n+\t    \"inline\",\n+\t    \"virtual\",\n+\t    \"explicit\",\n+\t    \"friend\",\n+\t    \"typedef\",\n+\t    \"__complex\",\n+\t    \"__thread\"\n+\t  };\n+\t  error (\"duplicate `%s'\", decl_spec_names[(int)ds]);\n+\t}\n     }\n \n #if 0\n@@ -6796,9 +6814,19 @@ grokdeclarator (const cp_declarator *declarator,\n      kinds of declarations (parameters, typenames, etc.).  */\n   if (declspecs->multiple_storage_classes_p)\n     error (\"multiple storage classes in declaration of `%s'\", name);\n+  else if (declspecs->specs[(int)ds_thread]\n+\t   && ((declspecs->storage_class \n+\t\t&& declspecs->storage_class != sc_extern\n+\t\t&& declspecs->storage_class != sc_static)\n+\t       || declspecs->specs[(int)ds_typedef]))\n+    {\n+      error (\"multiple storage classes in declaration of `%s'\", name);\n+      declspecs->specs[(int)ds_thread] = 0;\n+    }\n   else if (decl_context != NORMAL \n-\t   && declspecs->storage_class != sc_none\n-\t   && declspecs->storage_class != sc_mutable)\n+\t   && ((declspecs->storage_class != sc_none\n+\t\t&& declspecs->storage_class != sc_mutable)\n+\t       || declspecs->specs[(int)ds_thread]))\n     {\n       if ((decl_context == PARM || decl_context == CATCHPARM)\n \t  && (declspecs->storage_class == sc_register"}, {"sha": "346ad1cabcff2e7de7daa03f51ae0d8af9769c71", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=f1b90a04e0f8e682a4053b8e0d06c6afb1ee1219", "patch": "@@ -7200,17 +7200,21 @@ cp_parser_decl_specifier_seq (cp_parser* parser,\n \t  /* Consume the token.  */\n \t  cp_lexer_consume_token (parser->lexer);\n \t  if (decl_specs->specs[(int) ds_thread])\n-\t    error (\"`__thread' before `static'\");\n-\t  else\n-\t    cp_parser_set_storage_class (decl_specs, sc_static);\n+\t    {\n+\t      error (\"`__thread' before `static'\");\n+\t      decl_specs->specs[(int) ds_thread] = 0;\n+\t    }\n+\t  cp_parser_set_storage_class (decl_specs, sc_static);\n \t  break;\n \tcase RID_EXTERN:\n \t  /* Consume the token.  */\n \t  cp_lexer_consume_token (parser->lexer);\n \t  if (decl_specs->specs[(int) ds_thread])\n-\t    error (\"`__thread' before `extern'\");\n-\t  else\n-\t    cp_parser_set_storage_class (decl_specs, sc_extern);\n+\t    {\n+\t      error (\"`__thread' before `extern'\");\n+\t      decl_specs->specs[(int) ds_thread] = 0;\n+\t    }\n+\t  cp_parser_set_storage_class (decl_specs, sc_extern);\n \t  break;\n \tcase RID_MUTABLE:\n \t  /* Consume the token.  */"}]}