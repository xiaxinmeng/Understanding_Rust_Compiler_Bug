{"sha": "264757fb054a1f3639eafddb72e87c57004c6aaa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjY0NzU3ZmIwNTRhMWYzNjM5ZWFmZGRiNzJlODdjNTcwMDRjNmFhYQ==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2016-06-14T23:08:34Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2016-06-14T23:08:34Z"}, "message": "Introduce gcc_rich_location::add_fixit_misspelled_id\n\ngcc/c/ChangeLog:\n\t* c-typeck.c (build_component_ref): Simplify fixit code by\n\tusing gcc_rich_location::add_fixit_misspelled_id.\n\t(set_init_label): Likewise.\n\ngcc/cp/ChangeLog:\n\t* typeck.c: Include \"gcc-rich-location.h\".\n\t(finish_class_member_access_expr): Simplify fixit code by\n\tusing gcc_rich_location::add_fixit_misspelled_id.\n\ngcc/ChangeLog:\n\t* gcc-rich-location.c\n\t(gcc_rich_location::add_fixit_misspelled_id): New method.\n\t* gcc-rich-location.h\n\t(gcc_rich_location::add_fixit_misspelled_id): Add decl.\n\nFrom-SVN: r237463", "tree": {"sha": "7f70847fe1c3fb731deac7600fe4baa87c0b3c8f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7f70847fe1c3fb731deac7600fe4baa87c0b3c8f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/264757fb054a1f3639eafddb72e87c57004c6aaa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/264757fb054a1f3639eafddb72e87c57004c6aaa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/264757fb054a1f3639eafddb72e87c57004c6aaa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/264757fb054a1f3639eafddb72e87c57004c6aaa/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4eb24e010993b2d9152c2038566f0114fd65fac7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4eb24e010993b2d9152c2038566f0114fd65fac7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4eb24e010993b2d9152c2038566f0114fd65fac7"}], "stats": {"total": 62, "additions": 44, "deletions": 18}, "files": [{"sha": "c0141d6de6a3bfd4523f0a513889741c0dca1dcf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=264757fb054a1f3639eafddb72e87c57004c6aaa", "patch": "@@ -1,3 +1,10 @@\n+2016-06-14  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* gcc-rich-location.c\n+\t(gcc_rich_location::add_fixit_misspelled_id): New method.\n+\t* gcc-rich-location.h\n+\t(gcc_rich_location::add_fixit_misspelled_id): Add decl.\n+\n 2016-06-14  Andreas Tobler  <andreast@gcc.gnu.org>\n \n \t* config/arm/freebsd.h: Only enable unaligned access for armv6 on"}, {"sha": "85fe5e3562f76e2d6dd3ab5860bd33ec4e4a56a2", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=264757fb054a1f3639eafddb72e87c57004c6aaa", "patch": "@@ -1,3 +1,9 @@\n+2016-06-14  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* c-typeck.c (build_component_ref): Simplify fixit code by\n+\tusing gcc_rich_location::add_fixit_misspelled_id.\n+\t(set_init_label): Likewise.\n+\n 2016-06-13  David Malcolm  <dmalcolm@redhat.com>\n \n \t* c-parser.c (c_parser_initelt): Provide location of name for new"}, {"sha": "f9875087158a9a98a8af9d4ee541c1a59cd1763b", "filename": "gcc/c/c-typeck.c", "status": "modified", "additions": 4, "deletions": 12, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fc%2Fc-typeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fc%2Fc-typeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-typeck.c?ref=264757fb054a1f3639eafddb72e87c57004c6aaa", "patch": "@@ -2371,14 +2371,9 @@ build_component_ref (location_t loc, tree datum, tree component,\n \t\t we have a valid range for the component.  */\n \t      location_t reported_loc\n \t\t= (component_loc != UNKNOWN_LOCATION) ? component_loc : loc;\n-\t      rich_location rich_loc (line_table, reported_loc);\n+\t      gcc_rich_location rich_loc (reported_loc);\n \t      if (component_loc != UNKNOWN_LOCATION)\n-\t\t{\n-\t\t  source_range component_range =\n-\t\t    get_range_from_loc (line_table, component_loc);\n-\t\t  rich_loc.add_fixit_replace (component_range,\n-\t\t\t\t\t      IDENTIFIER_POINTER (guessed_id));\n-\t\t}\n+\t\trich_loc.add_fixit_misspelled_id (component_loc, guessed_id);\n \t      error_at_rich_loc\n \t\t(&rich_loc,\n \t\t \"%qT has no member named %qE; did you mean %qE?\",\n@@ -8234,11 +8229,8 @@ set_init_label (location_t loc, tree fieldname, location_t fieldname_loc,\n       tree guessed_id = lookup_field_fuzzy (constructor_type, fieldname);\n       if (guessed_id)\n \t{\n-\t  rich_location rich_loc (line_table, fieldname_loc);\n-\t  source_range component_range =\n-\t    get_range_from_loc (line_table, fieldname_loc);\n-\t  rich_loc.add_fixit_replace (component_range,\n-\t\t\t\t      IDENTIFIER_POINTER (guessed_id));\n+\t  gcc_rich_location rich_loc (fieldname_loc);\n+\t  rich_loc.add_fixit_misspelled_id (fieldname_loc, guessed_id);\n \t  error_at_rich_loc\n \t    (&rich_loc,\n \t     \"%qT has no member named %qE; did you mean %qE?\","}, {"sha": "4e4a662faf8e081f07c119e7ccff13f27452fe43", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=264757fb054a1f3639eafddb72e87c57004c6aaa", "patch": "@@ -1,3 +1,9 @@\n+2016-06-14  David Malcolm  <dmalcolm@redhat.com>\n+\n+\t* typeck.c: Include \"gcc-rich-location.h\".\n+\t(finish_class_member_access_expr): Simplify fixit code by\n+\tusing gcc_rich_location::add_fixit_misspelled_id.\n+\n 2016-06-14  Jason Merrill  <jason@redhat.com>\n \n \tP0145R2: Refining Expression Order for C++."}, {"sha": "2ccd2dad6a14963435da11c8dfca53b9047a49e0", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=264757fb054a1f3639eafddb72e87c57004c6aaa", "patch": "@@ -36,6 +36,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"c-family/c-objc.h\"\n #include \"c-family/c-ubsan.h\"\n #include \"params.h\"\n+#include \"gcc-rich-location.h\"\n \n static tree cp_build_addr_expr_strict (tree, tsubst_flags_t);\n static tree cp_build_function_call (tree, tree, tsubst_flags_t);\n@@ -2831,12 +2832,9 @@ finish_class_member_access_expr (cp_expr object, tree name, bool template_p,\n \t\t  if (guessed_id)\n \t\t    {\n \t\t      location_t bogus_component_loc = input_location;\n-\t\t      rich_location rich_loc (line_table, bogus_component_loc);\n-\t\t      source_range bogus_component_range =\n-\t\t\tget_range_from_loc (line_table, bogus_component_loc);\n-\t\t      rich_loc.add_fixit_replace\n-\t\t\t(bogus_component_range,\n-\t\t\t IDENTIFIER_POINTER (guessed_id));\n+\t\t      gcc_rich_location rich_loc (bogus_component_loc);\n+\t\t      rich_loc.add_fixit_misspelled_id (bogus_component_loc,\n+\t\t\t\t\t\t\tguessed_id);\n \t\t      error_at_rich_loc\n \t\t\t(&rich_loc,\n \t\t\t \"%q#T has no member named %qE; did you mean %qE?\","}, {"sha": "15c0700a25b7b110e0c7160b500a3bd77691853f", "filename": "gcc/gcc-rich-location.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fgcc-rich-location.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fgcc-rich-location.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc-rich-location.c?ref=264757fb054a1f3639eafddb72e87c57004c6aaa", "patch": "@@ -60,3 +60,17 @@ gcc_rich_location::maybe_add_expr (tree t)\n   if (EXPR_P (t))\n     add_expr (t);\n }\n+\n+/* Add a fixit hint suggesting replacing the range at MISSPELLED_TOKEN_LOC\n+   with the identifier HINT_ID.  */\n+\n+void\n+gcc_rich_location::add_fixit_misspelled_id (location_t misspelled_token_loc,\n+\t\t\t\t\t    tree hint_id)\n+{\n+  gcc_assert (TREE_CODE (hint_id) == IDENTIFIER_NODE);\n+\n+  source_range misspelled_token_range\n+    = get_range_from_loc (line_table, misspelled_token_loc);\n+  add_fixit_replace (misspelled_token_range, IDENTIFIER_POINTER (hint_id));\n+}"}, {"sha": "9c8a7904c15cc4a390a44b86d76a2290f6029a71", "filename": "gcc/gcc-rich-location.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fgcc-rich-location.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/264757fb054a1f3639eafddb72e87c57004c6aaa/gcc%2Fgcc-rich-location.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgcc-rich-location.h?ref=264757fb054a1f3639eafddb72e87c57004c6aaa", "patch": "@@ -42,6 +42,9 @@ class gcc_rich_location : public rich_location\n \n   void\n   maybe_add_expr (tree t);\n+\n+  void add_fixit_misspelled_id (location_t misspelled_token_loc,\n+\t\t\t\ttree hint_id);\n };\n \n #endif /* GCC_RICH_LOCATION_H */"}]}