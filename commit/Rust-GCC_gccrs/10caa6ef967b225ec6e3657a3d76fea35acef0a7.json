{"sha": "10caa6ef967b225ec6e3657a3d76fea35acef0a7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTBjYWE2ZWY5NjdiMjI1ZWM2ZTM2NTdhM2Q3NmZlYTM1YWNlZjBhNw==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2006-06-27T15:33:24Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2006-06-27T15:33:24Z"}, "message": "re PR libgcj/28178 (jniEnv->DeleteLocalRef (null) fails)\n\n\tPR libgcj/28178:\n\t* jni.cc (_Jv_JNI_DeleteLocalRef): Ignore null argument.\n\t(_Jv_JNI_DeleteGlobalRef): Likewise.\n\t* testsuite/libjava.jni/PR28178.java: New file.\n\t* testsuite/libjava.jni/PR28178.c: New file.\n\t* testsuite/libjava.jni/PR28178.out: New file.\n\nFrom-SVN: r115034", "tree": {"sha": "13cfcf691ed1709219a0b4189d313ba52839509e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/13cfcf691ed1709219a0b4189d313ba52839509e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/10caa6ef967b225ec6e3657a3d76fea35acef0a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/10caa6ef967b225ec6e3657a3d76fea35acef0a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/10caa6ef967b225ec6e3657a3d76fea35acef0a7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/10caa6ef967b225ec6e3657a3d76fea35acef0a7/comments", "author": null, "committer": null, "parents": [{"sha": "578089dba034de92992b968615ea5ca3625f6aed", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/578089dba034de92992b968615ea5ca3625f6aed", "html_url": "https://github.com/Rust-GCC/gccrs/commit/578089dba034de92992b968615ea5ca3625f6aed"}], "stats": {"total": 45, "additions": 45, "deletions": 0}, "files": [{"sha": "e6d1bbb69acaebaa3f1907f06f5906b3d7be2848", "filename": "libjava/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=10caa6ef967b225ec6e3657a3d76fea35acef0a7", "patch": "@@ -1,3 +1,12 @@\n+2006-06-27  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR libgcj/28178:\n+\t* jni.cc (_Jv_JNI_DeleteLocalRef): Ignore null argument.\n+\t(_Jv_JNI_DeleteGlobalRef): Likewise.\n+\t* testsuite/libjava.jni/PR28178.java: New file.\n+\t* testsuite/libjava.jni/PR28178.c: New file.\n+\t* testsuite/libjava.jni/PR28178.out: New file.\n+\n 2006-06-26  Keith Seitz  <keiths@redhat.com>\n \n \t* include/posix-threads.h: Fix coding style aberrations from"}, {"sha": "67ba8fa4941811f1bffd6d1ee04335d922309660", "filename": "libjava/jni.cc", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Fjni.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Fjni.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjni.cc?ref=10caa6ef967b225ec6e3657a3d76fea35acef0a7", "patch": "@@ -248,6 +248,12 @@ _Jv_JNI_DeleteGlobalRef (JNIEnv *, jobject obj)\n {\n   // This seems weird but I think it is correct.\n   obj = unwrap (obj);\n+  \n+  // NULL is ok here -- the JNI specification doesn't say so, but this\n+  // is a no-op.\n+  if (! obj)\n+    return;\n+\n   unmark_for_gc (obj, global_ref_table);\n }\n \n@@ -259,6 +265,11 @@ _Jv_JNI_DeleteLocalRef (JNIEnv *env, jobject obj)\n   // This seems weird but I think it is correct.\n   obj = unwrap (obj);\n \n+  // NULL is ok here -- the JNI specification doesn't say so, but this\n+  // is a no-op.\n+  if (! obj)\n+    return;\n+\n   for (frame = env->locals; frame != NULL; frame = frame->next)\n     {\n       for (int i = 0; i < frame->size; ++i)"}, {"sha": "17e730a1c362e173cbf9a181c502c69d27d4a341", "filename": "libjava/testsuite/libjava.jni/PR28178.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.c?ref=10caa6ef967b225ec6e3657a3d76fea35acef0a7", "patch": "@@ -0,0 +1,10 @@\n+#include <PR28178.h>\n+\n+void\n+Java_PR28178_m (JNIEnv *env, jclass ignore)\n+{\n+  (*env)->DeleteLocalRef(env, NULL);\n+  (*env)->DeleteGlobalRef(env, NULL);\n+}\n+\n+"}, {"sha": "f8d7b904ccd8682e403b66aba4032296521b33ad", "filename": "libjava/testsuite/libjava.jni/PR28178.java", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.java?ref=10caa6ef967b225ec6e3657a3d76fea35acef0a7", "patch": "@@ -0,0 +1,15 @@\n+// Regression test for PR 28178.\n+\n+public class PR28178\n+{\n+  static {\n+    System.loadLibrary(\"PR28178\");\n+  }\n+\n+  public static native void m();\n+\n+  public static void main(String[] args)\n+  {\n+    m();\n+  }\n+}"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "libjava/testsuite/libjava.jni/PR28178.out", "status": "added", "additions": 0, "deletions": 0, "changes": 0, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.out", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/10caa6ef967b225ec6e3657a3d76fea35acef0a7/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.out", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.jni%2FPR28178.out?ref=10caa6ef967b225ec6e3657a3d76fea35acef0a7"}]}