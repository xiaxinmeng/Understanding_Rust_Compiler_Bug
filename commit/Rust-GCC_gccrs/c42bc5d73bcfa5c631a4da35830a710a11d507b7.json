{"sha": "c42bc5d73bcfa5c631a4da35830a710a11d507b7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzQyYmM1ZDczYmNmYTVjNjMxYTRkYTM1ODMwYTcxMGExMWQ1MDdiNw==", "commit": {"author": {"name": "Tim Shen", "email": "timshen@google.com", "date": "2016-09-22T08:45:55Z"}, "committer": {"name": "Tim Shen", "email": "timshen@gcc.gnu.org", "date": "2016-09-22T08:45:55Z"}, "message": "variant (variant::operator=): Fix assignment on references.\n\n\t* libstdc++-v3/include/std/variant (variant::operator=): Fix assignment\n\ton references.\n\t* libstdc++-v3/testsuite/20_util/variant/compile.cc: Add test.\n\nFrom-SVN: r240343", "tree": {"sha": "ba386e9d2b903162a443a7ca5dd8e359c7987b4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ba386e9d2b903162a443a7ca5dd8e359c7987b4e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c42bc5d73bcfa5c631a4da35830a710a11d507b7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c42bc5d73bcfa5c631a4da35830a710a11d507b7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c42bc5d73bcfa5c631a4da35830a710a11d507b7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c42bc5d73bcfa5c631a4da35830a710a11d507b7/comments", "author": {"login": "timshen91", "id": 1157432, "node_id": "MDQ6VXNlcjExNTc0MzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1157432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timshen91", "html_url": "https://github.com/timshen91", "followers_url": "https://api.github.com/users/timshen91/followers", "following_url": "https://api.github.com/users/timshen91/following{/other_user}", "gists_url": "https://api.github.com/users/timshen91/gists{/gist_id}", "starred_url": "https://api.github.com/users/timshen91/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timshen91/subscriptions", "organizations_url": "https://api.github.com/users/timshen91/orgs", "repos_url": "https://api.github.com/users/timshen91/repos", "events_url": "https://api.github.com/users/timshen91/events{/privacy}", "received_events_url": "https://api.github.com/users/timshen91/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a8de3002f19eb09cf95d36f1a97e30f234df7d9e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8de3002f19eb09cf95d36f1a97e30f234df7d9e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8de3002f19eb09cf95d36f1a97e30f234df7d9e"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "ff984c37f0e0f949a740ee11c6bdf0ce69ef1408", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c42bc5d73bcfa5c631a4da35830a710a11d507b7/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c42bc5d73bcfa5c631a4da35830a710a11d507b7/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=c42bc5d73bcfa5c631a4da35830a710a11d507b7", "patch": "@@ -1,3 +1,9 @@\n+2016-09-22  Tim Shen  <timshen@google.com>\n+\n+\t* libstdc++-v3/include/std/variant (variant::operator=): Fix assignment\n+\ton references.\n+\t* libstdc++-v3/testsuite/20_util/variant/compile.cc: Add test.\n+\n 2016-09-22  Tim Shen  <timshen@google.com>\n \n \tPR libstdc++/77641"}, {"sha": "1ad33fc5da0d03ce9869f3fad9bf8ff4a269b5a1", "filename": "libstdc++-v3/include/std/variant", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c42bc5d73bcfa5c631a4da35830a710a11d507b7/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvariant", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c42bc5d73bcfa5c631a4da35830a710a11d507b7/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvariant", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fvariant?ref=c42bc5d73bcfa5c631a4da35830a710a11d507b7", "patch": "@@ -1147,8 +1147,7 @@ namespace __variant\n \t{\n \t  constexpr auto __index = __accepted_index<_Tp&&>;\n \t  if (index() == __index)\n-\t    *static_cast<__storage<__to_type<__index>>*>(this->_M_storage())\n-\t      = forward<_Tp>(__rhs);\n+\t    std::get<__index>(*this) = std::forward<_Tp>(__rhs);\n \t  else\n \t    this->emplace<__index>(forward<_Tp>(__rhs));\n \t  __glibcxx_assert(holds_alternative<__accepted_type<_Tp&&>>(*this));"}, {"sha": "a0a8d70ce871215f63778ad62f95cb943f80918f", "filename": "libstdc++-v3/testsuite/20_util/variant/compile.cc", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c42bc5d73bcfa5c631a4da35830a710a11d507b7/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c42bc5d73bcfa5c631a4da35830a710a11d507b7/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fvariant%2Fcompile.cc?ref=c42bc5d73bcfa5c631a4da35830a710a11d507b7", "patch": "@@ -169,6 +169,12 @@ void copy_assign()\n     variant<DefaultNoexcept> a;\n     static_assert(!noexcept(a = a), \"\");\n   }\n+\n+  {\n+    float f1 = 1.0f, f2 = 2.0f;\n+    std::variant<float&> v1(f1);\n+    v1 = f2;\n+  }\n }\n \n void move_assign()"}]}