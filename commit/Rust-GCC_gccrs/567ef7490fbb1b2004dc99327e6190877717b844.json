{"sha": "567ef7490fbb1b2004dc99327e6190877717b844", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTY3ZWY3NDkwZmJiMWIyMDA0ZGM5OTMyN2U2MTkwODc3NzE3Yjg0NA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2009-08-04T02:10:05Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2009-08-04T02:10:05Z"}, "message": "re PR c++/40948 (ICE in lower_stmt, at gimple-low.c:408)\n\n\tPR c++/40948\n\t* init.c (build_vec_init): Look through a TARGET_EXPR around a\n\tCONSTRUCTOR.\n\nCo-Authored-By: Jakub Jelinek <jakub@redhat.com>\n\nFrom-SVN: r150394", "tree": {"sha": "f8cfb26c56f8017a9b1ecb575af8d9081c7b8277", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f8cfb26c56f8017a9b1ecb575af8d9081c7b8277"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/567ef7490fbb1b2004dc99327e6190877717b844", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/567ef7490fbb1b2004dc99327e6190877717b844", "html_url": "https://github.com/Rust-GCC/gccrs/commit/567ef7490fbb1b2004dc99327e6190877717b844", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/567ef7490fbb1b2004dc99327e6190877717b844/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8ff17e188d1ade62baf71bbde12306c4997476bb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ff17e188d1ade62baf71bbde12306c4997476bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ff17e188d1ade62baf71bbde12306c4997476bb"}], "stats": {"total": 73, "additions": 73, "deletions": 0}, "files": [{"sha": "48561368800de366f51e8ef8fc166efdd252c00d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=567ef7490fbb1b2004dc99327e6190877717b844", "patch": "@@ -1,3 +1,10 @@\n+2009-08-03  Jason Merrill  <jason@redhat.com>\n+\t    Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/40948\n+\t* init.c (build_vec_init): Look through a TARGET_EXPR around a\n+\tCONSTRUCTOR.\n+\n 2009-07-31  Jason Merrill  <jason@redhat.com>\n \t    Douglas Gregor  <doug.gregor@gmail.com>\n "}, {"sha": "4462428321b00f0400f46972ed55c5c04660add0", "filename": "gcc/cp/init.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=567ef7490fbb1b2004dc99327e6190877717b844", "patch": "@@ -2695,6 +2695,12 @@ build_vec_init (tree base, tree maxindex, tree init,\n     gcc_assert (!init);\n \n   inner_elt_type = strip_array_types (type);\n+\n+  /* Look through the TARGET_EXPR around a compound literal.  */\n+  if (init && TREE_CODE (init) == TARGET_EXPR\n+      && TREE_CODE (TARGET_EXPR_INITIAL (init)) == CONSTRUCTOR)\n+    init = TARGET_EXPR_INITIAL (init);\n+\n   if (init\n       && TREE_CODE (atype) == ARRAY_TYPE\n       && (from_array == 2"}, {"sha": "26a37b1ad52a1701476cf34fcb9e5c30e689cc66", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=567ef7490fbb1b2004dc99327e6190877717b844", "patch": "@@ -1,3 +1,9 @@\n+2009-08-03  Jason Merrill  <jason@redhat.com>\n+\t    Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c++/40948\n+\t* g++.dg/ext/complit12.C: New.\n+\n 2009-08-03  Janis Johnson  <janis187@us.ibm.com>\n \n \tPR c/39902"}, {"sha": "81056214483873f31425e3bdefea0a744a182381", "filename": "gcc/testsuite/g++.dg/ext/complit12.C", "status": "added", "additions": 54, "deletions": 0, "changes": 54, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fcomplit12.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/567ef7490fbb1b2004dc99327e6190877717b844/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fcomplit12.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fcomplit12.C?ref=567ef7490fbb1b2004dc99327e6190877717b844", "patch": "@@ -0,0 +1,54 @@\n+// PR c++/40948\n+// { dg-do run }\n+// { dg-options \"\" }\n+\n+int c;\n+struct M\n+{\n+  M () { ++c; }\n+  M (const M&) { ++c; }\n+  ~M () { --c; }\n+};\n+\n+struct S\n+{\n+  S ();\n+  M m[1];\n+};\n+\n+S::S () : m ((M[1]) { M () })\n+{\n+}\n+\n+struct T\n+{\n+  T ();\n+  M m[4];\n+};\n+\n+T::T () : m ((M[4]) { M (), M (), M (), M () })\n+{\n+}\n+\n+int main ()\n+{\n+  {\n+    M m[1] = (M[1]) { M () };\n+    if (c != 1)\n+      return 1;\n+    M n = (M) { M () };\n+    if (c != 2)\n+      return 2;\n+    M o[4] = (M[4]) { M (), M (), M (), M () };\n+    if (c != 6)\n+      return 3;\n+    S s;\n+    if (c != 7)\n+      return 4;\n+    T t;\n+    if (c != 11)\n+      return 5;\n+  }\n+  if (c != 0)\n+    return 6;\n+}"}]}