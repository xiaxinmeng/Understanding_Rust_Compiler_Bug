{"sha": "468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDY4ZWU5NmE5NWE0NzBjMDZlMGY2NDZmMGE3YzgzYjE4OWI3ZmJlNg==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-18T10:14:23Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-18T10:14:23Z"}, "message": "[multiple changes]\n\n2010-10-18  Robert Dewar  <dewar@adacore.com>\n\n\t* prj-nmsc.adb, prj.adb, sem_res.adb: Minor reformatting.\n\n2010-10-18  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_util.adb (Insert_Explicit_Dereference): If operand is a selected\n\tcomponent, we generate a reference to the ultimate prefix when it is an\n\tentity name. We must place the reference on the identifier for that\n\tprefix, and not on the operand itself, to prevent spurious extra\n\treferences in the ali file.\n\n2010-10-18  Vincent Celier  <celier@adacore.com>\n\n\t* projects.texi: Add documentation for attribute Ignore_Source_Sub_Dirs\n\nFrom-SVN: r165623", "tree": {"sha": "d7fba811fa09b6de0a53d1fc0e6c4cf9f7fe6ca6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d7fba811fa09b6de0a53d1fc0e6c4cf9f7fe6ca6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/comments", "author": null, "committer": null, "parents": [{"sha": "b7f17b2062c6e07c4236e16d124e9f1dcd34447f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7f17b2062c6e07c4236e16d124e9f1dcd34447f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7f17b2062c6e07c4236e16d124e9f1dcd34447f"}], "stats": {"total": 62, "additions": 47, "deletions": 15}, "files": [{"sha": "7240bce000af887e5a750515a3df8f925d112711", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "patch": "@@ -1,3 +1,19 @@\n+2010-10-18  Robert Dewar  <dewar@adacore.com>\n+\n+\t* prj-nmsc.adb, prj.adb, sem_res.adb: Minor reformatting.\n+\n+2010-10-18  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_util.adb (Insert_Explicit_Dereference): If operand is a selected\n+\tcomponent, we generate a reference to the ultimate prefix when it is an\n+\tentity name. We must place the reference on the identifier for that\n+\tprefix, and not on the operand itself, to prevent spurious extra\n+\treferences in the ali file.\n+\n+2010-10-18  Vincent Celier  <celier@adacore.com>\n+\n+\t* projects.texi: Add documentation for attribute Ignore_Source_Sub_Dirs\n+\n 2010-10-18  Ed Schonberg  <schonberg@adacore.com>\n \n \t* einfo.ads, einfo.adb: New attribute PPC_Wrapper for entries and entry"}, {"sha": "246d28a5a7fc4e0adbbd97758502ecef98b22119", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 9, "deletions": 5, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "patch": "@@ -6896,20 +6896,20 @@ package body Prj.Nmsc is\n                      if Ignore /= Nil_String then\n                         declare\n                            Dir_Name : String := Name (1 .. Last);\n-                           List : String_List_Id := Ignore;\n+                           List     : String_List_Id := Ignore;\n+\n                         begin\n                            Canonical_Case_File_Name (Dir_Name);\n \n                            while List /= Nil_String loop\n                               Get_Name_String\n-                                (Data.Tree.String_Elements.Table\n-                                   (List).Value);\n+                                (Data.Tree.String_Elements.Table (List).Value);\n                               Canonical_Case_File_Name\n                                 (Name_Buffer (1 .. Name_Len));\n                               OK := Name_Buffer (1 .. Name_Len) /= Dir_Name;\n                               exit when not OK;\n-                              List := Data.Tree.String_Elements.Table\n-                                                                 (List).Next;\n+                              List :=\n+                                Data.Tree.String_Elements.Table (List).Next;\n                            end loop;\n                         end;\n                      end if;\n@@ -7650,6 +7650,10 @@ package body Prj.Nmsc is\n                  (Get_Name_String (Src.Path_Name)));\n             Id.File := Name_Find;\n \n+            Id.Next_With_File_Name :=\n+              Source_Files_Htable.Get (Data.Tree.Source_Files_HT, Id.File);\n+            Source_Files_Htable.Set (Data.Tree.Source_Files_HT, Id.File, Id);\n+\n             Name_Len := 0;\n             Add_Str_To_Name_Buffer\n               (Ada.Directories.Simple_Name"}, {"sha": "6402126acbe7bade5b27a36d9f75b61cd1f4bfbd", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "patch": "@@ -1161,8 +1161,7 @@ package body Prj is\n                 Length_Of_Name (Source.Language.Config.Compiler_Driver) /= 0\n               and then not Source.Locally_Removed\n               and then (Source.Language.Config.Kind /= File_Based\n-                        or else\n-                          Source.Kind /= Spec)\n+                         or else Source.Kind /= Spec)\n             then\n                --  Do not modify Source.Compilable before the source record\n                --  has been initilaized.\n@@ -1172,6 +1171,7 @@ package body Prj is\n                end if;\n \n                return True;\n+\n             else\n                if Source.Source_TS /= Empty_Time_Stamp then\n                   Source.Compilable := No;"}, {"sha": "8441ec4da0814b53d1adc3229b1211af4b8580c5", "filename": "gcc/ada/projects.texi", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fprojects.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fprojects.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprojects.texi?ref=468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "patch": "@@ -278,6 +278,14 @@ There are several ways of defining source directories:\n   be excluded. It is also possible to exclude a complete directory subtree\n   using the \"/**\" notation.\n \n+@cindex @code{Ignore_Source_Sub_Dirs}\n+  It is often desirable to remove, from the source directories, directory\n+  subtrees rooted at some subdirectories. An example is the subdirectories\n+  created by a Version Control System such as Subversion that creates directory\n+  subtrees .svn/**. To do that, attribute  @b{Ignore_Source_Sub_Dirs} can be\n+  used. It specifies the list of simple file names for the root of these\n+  undesirable directory subtrees.\n+\n @end itemize\n \n @noindent"}, {"sha": "efd44e86b8d2b81fc9c0b7fe07b8be99d1a7eb24", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "patch": "@@ -6331,19 +6331,20 @@ package body Sem_Res is\n         and then Present (PPC_Wrapper (Nam))\n         and then Current_Scope /= PPC_Wrapper (Nam)\n       then\n-\n-         --  Rewrite as call to the precondition wrapper, adding the\n-         --  task object to the list of actuals.\n+         --  Rewrite as call to the precondition wrapper, adding the task\n+         --  object to the list of actuals.\n \n          declare\n-            New_Call : Node_Id;\n+            New_Call    : Node_Id;\n             New_Actuals : List_Id;\n          begin\n             New_Actuals := New_List (Obj);\n             Append_List (Parameter_Associations (N), New_Actuals);\n-            New_Call := Make_Procedure_Call_Statement (Loc,\n-              Name => New_Occurrence_Of (PPC_Wrapper (Nam), Loc),\n-              Parameter_Associations => New_Actuals);\n+            New_Call :=\n+              Make_Procedure_Call_Statement (Loc,\n+                Name                   =>\n+                  New_Occurrence_Of (PPC_Wrapper (Nam), Loc),\n+                Parameter_Associations => New_Actuals);\n             Rewrite (N, New_Call);\n             Analyze_And_Resolve (N);\n             return;"}, {"sha": "d278e1d7bc7b18716226909f840c2b7c12f13a4d", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/468ee96a95a470c06e0f646f0a7c83b189b7fbe6/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=468ee96a95a470c06e0f646f0a7c83b189b7fbe6", "patch": "@@ -5585,6 +5585,7 @@ package body Sem_Util is\n \n          if Is_Entity_Name (New_Prefix) then\n             Ent := Entity (New_Prefix);\n+            Pref := New_Prefix;\n \n          --  For a retrieval of a subcomponent of some composite object,\n          --  retrieve the ultimate entity if there is one.\n@@ -5606,8 +5607,10 @@ package body Sem_Util is\n             end if;\n          end if;\n \n+         --  Place the reference on the entity node.\n+\n          if Present (Ent) then\n-            Generate_Reference (Ent, New_Prefix);\n+            Generate_Reference (Ent, Pref);\n          end if;\n       end if;\n    end Insert_Explicit_Dereference;"}]}