{"sha": "acafbcde95f106dafa58c6d9daca16ea3aa93668", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWNhZmJjZGU5NWYxMDZkYWZhNThjNmQ5ZGFjYTE2ZWEzYWE5MzY2OA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "iant@google.com", "date": "2008-09-19T22:30:12Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2008-09-19T22:30:12Z"}, "message": "varasm.c (narrowing_initializer_constant_valid_p): Return NULL_TREE if ENDTYPE is not an integer.\n\n\t* varasm.c (narrowing_initializer_constant_valid_p): Return\n\tNULL_TREE if ENDTYPE is not an integer.\n\nFrom-SVN: r140502", "tree": {"sha": "1ae404ea64580a3b8bc92fcb342708a000a24684", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1ae404ea64580a3b8bc92fcb342708a000a24684"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/acafbcde95f106dafa58c6d9daca16ea3aa93668", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/acafbcde95f106dafa58c6d9daca16ea3aa93668", "html_url": "https://github.com/Rust-GCC/gccrs/commit/acafbcde95f106dafa58c6d9daca16ea3aa93668", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/acafbcde95f106dafa58c6d9daca16ea3aa93668/comments", "author": null, "committer": null, "parents": [{"sha": "f22b7039d8ad71c2ceaf754087e4e52b18801201", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f22b7039d8ad71c2ceaf754087e4e52b18801201", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f22b7039d8ad71c2ceaf754087e4e52b18801201"}], "stats": {"total": 15, "additions": 12, "deletions": 3}, "files": [{"sha": "2c3959934f3302a9ce57453f6aaa648995997d52", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/acafbcde95f106dafa58c6d9daca16ea3aa93668/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/acafbcde95f106dafa58c6d9daca16ea3aa93668/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=acafbcde95f106dafa58c6d9daca16ea3aa93668", "patch": "@@ -1,3 +1,8 @@\n+2008-09-19  Ian Lance Taylor  <iant@google.com>\n+\n+\t* varasm.c (narrowing_initializer_constant_valid_p): Return\n+\tNULL_TREE if ENDTYPE is not an integer.\n+\n 2008-09-19  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n \n \tPR tree-opt/30930"}, {"sha": "b3f99907990799c939e416b9ed37747435558af8", "filename": "gcc/varasm.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/acafbcde95f106dafa58c6d9daca16ea3aa93668/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/acafbcde95f106dafa58c6d9daca16ea3aa93668/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=acafbcde95f106dafa58c6d9daca16ea3aa93668", "patch": "@@ -4064,9 +4064,10 @@ constructor_static_from_elts_p (const_tree ctor)\n }\n \n /* A subroutine of initializer_constant_valid_p.  VALUE is either a\n-   MINUS_EXPR or a POINTER_PLUS_EXPR, and ENDTYPE is a narrowing\n-   conversion to something smaller than a pointer.  This returns\n-   null_pointer_node if the resulting value is an absolute constant\n+   MINUS_EXPR or a POINTER_PLUS_EXPR.  This looks for cases of VALUE\n+   which are valid when ENDTYPE is an integer of any size; in\n+   particular, this does not accept a pointer minus a constant.  This\n+   returns null_pointer_node if the VALUE is an absolute constant\n    which can be used to initialize a static variable.  Otherwise it\n    returns NULL.  */\n \n@@ -4075,6 +4076,9 @@ narrowing_initializer_constant_valid_p (tree value, tree endtype)\n {\n   tree op0, op1;\n \n+  if (!INTEGRAL_TYPE_P (endtype))\n+    return NULL_TREE;\n+\n   op0 = TREE_OPERAND (value, 0);\n   op1 = TREE_OPERAND (value, 1);\n "}]}