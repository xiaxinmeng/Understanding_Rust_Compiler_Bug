{"sha": "c8601e4115c6155cdf8880056e9b0703efae5d9b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzg2MDFlNDExNWM2MTU1Y2RmODg4MDA1NmU5YjA3MDNlZmFlNWQ5Yg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2013-12-12T22:50:07Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2013-12-12T22:50:07Z"}, "message": "re PR ada/55946 (wrong tools used for build of gnattools [native-cross])\n\n\tPR ada/55946\ngnattools/\n\t* Makefile.in (host): Define.\n\t(host_alias): Likewise.\n\t(TOOLS_FLAGS_TO_PASS_RE): Add LDFLAGS.\n\t(GNATMAKE_FOR_HOST): Define.\n\t(GNATLINK_FOR_HOST): Likewise.\n\t(GNATBIND_FOR_HOST): Likewise.\n\t(GNATLS_FOR_HOST): Likewise.\n\t(RTS_DIR): Move around and use GNATLS_FOR_HOST.\n\t(TOOLS_FLAGS_TO_PASS_CROSS): Use the other *_HOST variables.\ngcc/ada/\n\t* gcc-interface/Make-lang.in (ada/doctools/xgnatugn): Use gnatmake.\n\t* gcc-interface/Makefile.in (GCC_LINK): Add LDFLAGS.\n\t(../../gnatmake): Remove LDFLAGS.\n\t(../../gnatlink): Likewise.\n\nCo-Authored-By: Iain Sandoe <iain@codesourcery.com>\n\nFrom-SVN: r205945", "tree": {"sha": "02c4df5dbe3d9240d6a820494453be54806358b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/02c4df5dbe3d9240d6a820494453be54806358b2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c8601e4115c6155cdf8880056e9b0703efae5d9b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8601e4115c6155cdf8880056e9b0703efae5d9b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8601e4115c6155cdf8880056e9b0703efae5d9b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8601e4115c6155cdf8880056e9b0703efae5d9b/comments", "author": null, "committer": null, "parents": [{"sha": "3742998dca66dedacda8209e8a8557a4694da41e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3742998dca66dedacda8209e8a8557a4694da41e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3742998dca66dedacda8209e8a8557a4694da41e"}], "stats": {"total": 63, "additions": 49, "deletions": 14}, "files": [{"sha": "1daf1e4329d7fc851ea7e013a08eb7fc3aaaa604", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8601e4115c6155cdf8880056e9b0703efae5d9b/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8601e4115c6155cdf8880056e9b0703efae5d9b/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c8601e4115c6155cdf8880056e9b0703efae5d9b", "patch": "@@ -1,3 +1,12 @@\n+2013-12-13  Eric Botcazou  <ebotcazou@adacore.com>\n+\t    Iain Sandoe <iain@codesourcery.com>\n+\n+\tPR ada/55946\n+\t* gcc-interface/Make-lang.in (ada/doctools/xgnatugn): Use gnatmake.\n+\t* gcc-interface/Makefile.in (GCC_LINK): Add LDFLAGS.\n+\t(../../gnatmake): Remove LDFLAGS.\n+\t(../../gnatlink): Likewise.\n+\n 2013-12-04  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR ada/59382"}, {"sha": "8c87b2bba26dd5c2c59a7d2531afa7dadeadbdd3", "filename": "gcc/ada/gcc-interface/Make-lang.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8601e4115c6155cdf8880056e9b0703efae5d9b/gcc%2Fada%2Fgcc-interface%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8601e4115c6155cdf8880056e9b0703efae5d9b/gcc%2Fada%2Fgcc-interface%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMake-lang.in?ref=c8601e4115c6155cdf8880056e9b0703efae5d9b", "patch": "@@ -658,7 +658,7 @@ ada.tags: force\n ada/doctools/xgnatugn$(build_exeext): ada/xgnatugn.adb\n \t-$(MKDIR) ada/doctools\n \t$(CP) $^ ada/doctools\n-\tcd ada/doctools && $(GNATMAKE) -q xgnatugn\n+\tcd ada/doctools && gnatmake -q xgnatugn\n \n # Note that doc/gnat_ugn.texi and doc/projects.texi do not depend on\n # xgnatugn being built so we can distribute a pregenerated doc/gnat_ugn.info"}, {"sha": "fc84f09628d2f4f542ba0b8ffdd69b3579350bcd", "filename": "gcc/ada/gcc-interface/Makefile.in", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8601e4115c6155cdf8880056e9b0703efae5d9b/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8601e4115c6155cdf8880056e9b0703efae5d9b/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMakefile.in?ref=c8601e4115c6155cdf8880056e9b0703efae5d9b", "patch": "@@ -2415,7 +2415,7 @@ TOOLS_FLAGS_TO_PASS=\t\t\\\n \t\"GNATLINK=$(GNATLINK)\"\t\\\n \t\"GNATBIND=$(GNATBIND)\"\n \n-GCC_LINK=$(CXX) $(GCC_LINK_FLAGS) $(ADA_INCLUDES)\n+GCC_LINK=$(CXX) $(GCC_LINK_FLAGS) $(ADA_INCLUDES) $(LDFLAGS)\n \n # Build directory for the tools. Let's copy the target-dependent\n # sources using the same mechanism as for gnatlib. The other sources are\n@@ -2537,12 +2537,10 @@ gnatlink-re: ../stamp-tools gnatmake-re\n \n # Likewise for the tools\n ../../gnatmake$(exeext): $(P) b_gnatm.o $(GNATMAKE_OBJS)\n-\t+$(GCC_LINK) $(ALL_CFLAGS) $(LDFLAGS) -o $@ b_gnatm.o $(GNATMAKE_OBJS) \\\n-\t\t    $(TOOLS_LIBS)\n+\t+$(GCC_LINK) $(ALL_CFLAGS) -o $@ b_gnatm.o $(GNATMAKE_OBJS) $(TOOLS_LIBS)\n \n ../../gnatlink$(exeext): $(P) b_gnatl.o $(GNATLINK_OBJS)\n-\t+$(GCC_LINK) $(ALL_CFLAGS) $(LDFLAGS) -o $@ b_gnatl.o $(GNATLINK_OBJS) \\\n-\t\t    $(TOOLS_LIBS)\n+\t+$(GCC_LINK) $(ALL_CFLAGS) -o $@ b_gnatl.o $(GNATLINK_OBJS) $(TOOLS_LIBS)\n \n ../stamp-gnatlib-$(RTSDIR):\n \t@if [ ! -f stamp-gnatlib-$(RTSDIR) ] ; \\"}, {"sha": "a2dbb2f21ab7587b8b6e39a8730ed56c5b1e0afd", "filename": "gnattools/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8601e4115c6155cdf8880056e9b0703efae5d9b/gnattools%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8601e4115c6155cdf8880056e9b0703efae5d9b/gnattools%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gnattools%2FChangeLog?ref=c8601e4115c6155cdf8880056e9b0703efae5d9b", "patch": "@@ -1,3 +1,17 @@\n+2013-12-13  Eric Botcazou  <ebotcazou@adacore.com>\n+\t    Iain Sandoe <iain@codesourcery.com>\n+\n+\tPR ada/55946\n+\t* Makefile.in (host): Define.\n+\t(host_alias): Likewise.\n+\t(TOOLS_FLAGS_TO_PASS_RE): Add LDFLAGS.\n+\t(GNATMAKE_FOR_HOST): Define.\n+\t(GNATLINK_FOR_HOST): Likewise.\n+\t(GNATBIND_FOR_HOST): Likewise.\n+\t(GNATLS_FOR_HOST): Likewise.\n+\t(RTS_DIR): Move around and use GNATLS_FOR_HOST.\n+\t(TOOLS_FLAGS_TO_PASS_CROSS): Use the other *_HOST variables.\n+\n 2013-12-04  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR ada/59382"}, {"sha": "4ec7afd5dd87a66dcf10ff55aeb42dd762025727", "filename": "gnattools/Makefile.in", "status": "modified", "additions": 22, "deletions": 8, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8601e4115c6155cdf8880056e9b0703efae5d9b/gnattools%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8601e4115c6155cdf8880056e9b0703efae5d9b/gnattools%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gnattools%2FMakefile.in?ref=c8601e4115c6155cdf8880056e9b0703efae5d9b", "patch": "@@ -24,6 +24,8 @@ srcdir = @srcdir@\n libdir = @libdir@\n build = @build@\n target = @target@\n+host = @host@\n+host_alias = @host_alias@\n prefix = @prefix@\n INSTALL = @INSTALL@\n INSTALL_DATA = @INSTALL_DATA@\n@@ -92,6 +94,7 @@ TOOLS_FLAGS_TO_PASS_RE= \\\n \t\"CC=../../xgcc -B../../\" \\\n \t\"CXX=../../xg++ -B../../ $(CXX_LFLAGS)\" \\\n \t\"CFLAGS=$(CFLAGS)\" \\\n+\t\"LDFLAGS=$(LDFLAGS)\" \\\n \t\"ADAFLAGS=$(ADAFLAGS)\" \\\n \t\"ADA_CFLAGS=$(ADA_CFLAGS)\" \\\n \t\"INCLUDES=$(INCLUDES_FOR_SUBDIR)\" \\\n@@ -105,6 +108,22 @@ TOOLS_FLAGS_TO_PASS_RE= \\\n \t\"TOOLSCASE=cross\"\n \n # Variables for gnattools, cross\n+ifeq ($(build), $(host))\n+  GNATMAKE_FOR_HOST=gnatmake\n+  GNATLINK_FOR_HOST=gnatlink\n+  GNATBIND_FOR_HOST=gnatbind\n+  GNATLS_FOR_HOST=gnatls\n+else\n+  GNATMAKE_FOR_HOST=$(host_alias)-gnatmake\n+  GNATLINK_FOR_HOST=$(host_alias)-gnatlink\n+  GNATBIND_FOR_HOST=$(host_alias)-gnatbind\n+  GNATLS_FOR_HOST=$(host_alias)-gnatls\n+endif\n+\n+# Put the host RTS dir first in the PATH to hide the default runtime\n+# files that are among the sources\n+RTS_DIR:=$(strip $(subst \\,/,$(shell $(GNATLS_FOR_HOST) -v | grep adalib )))\n+\n TOOLS_FLAGS_TO_PASS_CROSS= \\\n \t\"CC=$(CC)\" \\\n \t\"CXX=$(CXX)\" \\\n@@ -117,9 +136,9 @@ TOOLS_FLAGS_TO_PASS_CROSS= \\\n \t\"exeext=$(exeext)\" \\\n \t\"fsrcdir=$(fsrcdir)\" \\\n \t\"srcdir=$(fsrcdir)\" \\\n-\t\"GNATMAKE=gnatmake\" \\\n-\t\"GNATLINK=gnatlink\" \\\n-\t\"GNATBIND=gnatbind\" \\\n+\t\"GNATMAKE=$(GNATMAKE_FOR_HOST)\" \\\n+\t\"GNATLINK=$(GNATLINK_FOR_HOST)\" \\\n+\t\"GNATBIND=$(GNATBIND_FOR_HOST)\" \\\n \t\"TOOLSCASE=cross\" \\\n \t\"LIBGNAT=\"\n \n@@ -188,11 +207,6 @@ regnattools: $(GCC_DIR)/stamp-gnatlib-rts\n \t$(MAKE) -C $(GCC_DIR)/ada/tools -f ../Makefile \\\n \t  $(TOOLS_FLAGS_TO_PASS_NATIVE) common-tools\n \n-# For cross builds of gnattools,\n-# put the host RTS dir first in the PATH to hide the default runtime\n-# files that are among the sources\n-# FIXME: This should be done in configure.\n-RTS_DIR:=$(strip $(subst \\,/,$(shell gnatls -v | grep adalib )))\n gnattools-cross: $(GCC_DIR)/stamp-tools\n \t# gnattools1-re\n \t$(MAKE) -C $(GCC_DIR)/ada/tools -f ../Makefile \\"}]}