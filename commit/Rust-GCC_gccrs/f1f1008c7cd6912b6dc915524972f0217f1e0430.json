{"sha": "f1f1008c7cd6912b6dc915524972f0217f1e0430", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjFmMTAwOGM3Y2Q2OTEyYjZkYzkxNTUyNDk3MmYwMjE3ZjFlMDQzMA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-10-10T17:36:03Z"}, "committer": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-10-10T17:36:03Z"}, "message": "Improve tree-ssa-alias dump files.\n\n\t* tree-ssa-alias.c (ref_maybe_used_by_call_p_1): Improve debug dumps.\n\t(call_may_clobber_ref_p_1): Improve debug dumps.", "tree": {"sha": "96634639ab0e1043735123f6fcb2e5aba3c3b93a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96634639ab0e1043735123f6fcb2e5aba3c3b93a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f1f1008c7cd6912b6dc915524972f0217f1e0430", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1f1008c7cd6912b6dc915524972f0217f1e0430", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1f1008c7cd6912b6dc915524972f0217f1e0430", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1f1008c7cd6912b6dc915524972f0217f1e0430/comments", "author": null, "committer": null, "parents": [{"sha": "c28d91bf23ad5767265a1298be6fef0caa0a85f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c28d91bf23ad5767265a1298be6fef0caa0a85f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c28d91bf23ad5767265a1298be6fef0caa0a85f0"}], "stats": {"total": 44, "additions": 32, "deletions": 12}, "files": [{"sha": "877e4999f0fced0abc9829435437f7b17fe294da", "filename": "gcc/tree-ssa-alias.c", "status": "modified", "additions": 32, "deletions": 12, "changes": 44, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1f1008c7cd6912b6dc915524972f0217f1e0430/gcc%2Ftree-ssa-alias.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1f1008c7cd6912b6dc915524972f0217f1e0430/gcc%2Ftree-ssa-alias.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-alias.c?ref=f1f1008c7cd6912b6dc915524972f0217f1e0430", "patch": "@@ -43,6 +43,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"attr-fnspec.h\"\n #include \"errors.h\"\n #include \"dbgcnt.h\"\n+#include \"gimple-pretty-print.h\"\n \n /* Broad overview of how alias analysis on gimple works:\n \n@@ -2610,13 +2611,23 @@ ref_maybe_used_by_call_p_1 (gcall *call, ao_ref *ref, bool tbaa_p)\n \t\t  alias_stats.modref_use_no_alias++;\n \t\t  if (dump_file && (dump_flags & TDF_DETAILS))\n \t\t    {\n-\t\t      fprintf (dump_file, \"ipa-modref: in %s,\"\n-\t\t\t       \" call to %s does not use \",\n-\t\t\t       cgraph_node::get\n-\t\t\t\t   (current_function_decl)->dump_name (),\n+\t\t      fprintf (dump_file,\n+\t\t\t       \"ipa-modref: call stmt \");\n+\t\t      print_gimple_stmt (dump_file, call, 0);\n+\t\t      fprintf (dump_file,\n+\t\t\t       \"ipa-modref: call to %s does not use \",\n \t\t\t       node->dump_name ());\n-\t\t      print_generic_expr (dump_file, ref->ref);\n-\t\t      fprintf (dump_file, \" %i->%i\\n\",\n+\t\t      if (!ref->ref && ref->base)\n+\t\t\t{\n+\t\t\t  fprintf (dump_file, \"base: \");\n+\t\t\t  print_generic_expr (dump_file, ref->base);\n+\t\t\t}\n+\t\t      else if (ref->ref)\n+\t\t\t{\n+\t\t\t  fprintf (dump_file, \"ref: \");\n+\t\t\t  print_generic_expr (dump_file, ref->ref);\n+\t\t\t}\n+\t\t      fprintf (dump_file, \" alias sets: %i->%i\\n\",\n \t\t\t       ao_ref_base_alias_set (ref),\n \t\t\t       ao_ref_alias_set (ref));\n \t\t    }\n@@ -3035,13 +3046,22 @@ call_may_clobber_ref_p_1 (gcall *call, ao_ref *ref, bool tbaa_p)\n \t\t  if (dump_file && (dump_flags & TDF_DETAILS))\n \t\t    {\n \t\t      fprintf (dump_file,\n-\t\t\t       \"ipa-modref: in %s, \"\n-\t\t\t       \"call to %s does not clobber \",\n-\t\t\t       cgraph_node::get\n-\t\t\t\t  (current_function_decl)->dump_name (),\n+\t\t\t       \"ipa-modref: call stmt \");\n+\t\t      print_gimple_stmt (dump_file, call, 0);\n+\t\t      fprintf (dump_file,\n+\t\t\t       \"ipa-modref: call to %s does not clobber \",\n \t\t\t       node->dump_name ());\n-\t\t      print_generic_expr (dump_file, ref->ref);\n-\t\t      fprintf (dump_file, \" %i->%i\\n\",\n+\t\t      if (!ref->ref && ref->base)\n+\t\t\t{\n+\t\t\t  fprintf (dump_file, \"base: \");\n+\t\t\t  print_generic_expr (dump_file, ref->base);\n+\t\t\t}\n+\t\t      else if (ref->ref)\n+\t\t\t{\n+\t\t\t  fprintf (dump_file, \"ref: \");\n+\t\t\t  print_generic_expr (dump_file, ref->ref);\n+\t\t\t}\n+\t\t      fprintf (dump_file, \" alias sets: %i->%i\\n\",\n \t\t\t       ao_ref_base_alias_set (ref),\n \t\t\t       ao_ref_alias_set (ref));\n \t\t    }"}]}