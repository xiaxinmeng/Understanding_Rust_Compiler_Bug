{"sha": "21b807f18020f6f10753b0a0ab7d53a65f31b79a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjFiODA3ZjE4MDIwZjZmMTA3NTNiMGEwYWI3ZDUzYTY1ZjMxYjc5YQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2003-11-24T21:02:12Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2003-11-24T21:02:12Z"}, "message": "config.gcc (mips-sgi-irix6*): Add t-iris6gld to tmake_file when using GNU ld.\n\n\t* config.gcc (mips-sgi-irix6*): Add t-iris6gld to tmake_file when\n\tusing GNU ld.\n\t* config/mips/iris6.h (IRIX6_STARTFILE_SPEC): New, taking the\n\twhole of the previous STARTFILE_SPEC except crtbegin.o%s.\n\t(IRIX6_ENDFILE_SPEC): Likewise ENDFILE_SPEC and crtend.o%s.\n\t(STARTFILE_SPEC, ENDFILE_SPEC): Define in terms of the above.\n\t(SUBTARGET_EXTRA_SPECS): Define.\n\t* config/mips/iris6gld.h (LINK_SPEC): Change -init function\n\tto __gcc_init and -fini function to __gcc_fini.\n\t(STARTFILE_SPEC): Redefine, including irix6-crti.o before crtbegin.o.\n\t(ENDFILE_SPEC): Likewise, including irix6-crtn.o after crtend.o.\n\t(INIT_SECTION_ASM_OP, FINI_SECTION_ASM_OP): Define.\n\t* config/mips/t-iris6gld,\n\t* config/mips/irix6-crti.asm,\n\t* config/mips/irix6-crtn.asm: New files.\n\nFrom-SVN: r73891", "tree": {"sha": "30037e1d6d9657f2a8bbc5a68f2a9cbbfb1582aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/30037e1d6d9657f2a8bbc5a68f2a9cbbfb1582aa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/21b807f18020f6f10753b0a0ab7d53a65f31b79a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21b807f18020f6f10753b0a0ab7d53a65f31b79a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21b807f18020f6f10753b0a0ab7d53a65f31b79a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21b807f18020f6f10753b0a0ab7d53a65f31b79a/comments", "author": null, "committer": null, "parents": [{"sha": "e13e48e70711cf7328c91eedf04ad4771dc9a002", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e13e48e70711cf7328c91eedf04ad4771dc9a002", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e13e48e70711cf7328c91eedf04ad4771dc9a002"}], "stats": {"total": 124, "additions": 114, "deletions": 10}, "files": [{"sha": "f64a7e523172adcd7ca0b5c89e1a36d6b335ddff", "filename": "gcc/ChangeLog", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=21b807f18020f6f10753b0a0ab7d53a65f31b79a", "patch": "@@ -1,3 +1,21 @@\n+2003-11-24  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config.gcc (mips-sgi-irix6*): Add t-iris6gld to tmake_file when\n+\tusing GNU ld.\n+\t* config/mips/iris6.h (IRIX6_STARTFILE_SPEC): New, taking the\n+\twhole of the previous STARTFILE_SPEC except crtbegin.o%s.\n+\t(IRIX6_ENDFILE_SPEC): Likewise ENDFILE_SPEC and crtend.o%s.\n+\t(STARTFILE_SPEC, ENDFILE_SPEC): Define in terms of the above.\n+\t(SUBTARGET_EXTRA_SPECS): Define.\n+\t* config/mips/iris6gld.h (LINK_SPEC): Change -init function\n+\tto __gcc_init and -fini function to __gcc_fini.\n+\t(STARTFILE_SPEC): Redefine, including irix6-crti.o before crtbegin.o.\n+\t(ENDFILE_SPEC): Likewise, including irix6-crtn.o after crtend.o.\n+\t(INIT_SECTION_ASM_OP, FINI_SECTION_ASM_OP): Define.\n+\t* config/mips/t-iris6gld,\n+\t* config/mips/irix6-crti.asm,\n+\t* config/mips/irix6-crtn.asm: New files.\n+\n 2003-11-24  Eric Christopher  <echristo@redhat.com>\n \n \tPR C/13014"}, {"sha": "ae9447db90e7a9c5a0ce1873291fe4eaa91c039a", "filename": "gcc/config.gcc", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=21b807f18020f6f10753b0a0ab7d53a65f31b79a", "patch": "@@ -1418,15 +1418,16 @@ mips-sgi-irix6*o32)\t\t# SGI System V.4., IRIX 6, O32 ABI\n \t;;\n mips-sgi-irix6*)\t\t# SGI System V.4., IRIX 6\n \ttm_file=\"${tm_file} mips/iris5.h mips/iris6.h\"\n+\ttmake_file=\"mips/t-iris mips/t-iris5-6 mips/t-iris6\"\n \tif test x$gas = xyes\n \tthen\n \t\ttm_file=\"${tm_file} mips/iris6gas.h\"\n \tfi\n \tif test \"x$gnu_ld\" = xyes\n \tthen\n \t\ttm_file=\"${tm_file} mips/iris6gld.h\"\n+\t\ttmake_file=\"$tmake_file mips/t-iris6gld\"\n \tfi\n-\ttmake_file=\"mips/t-iris mips/t-iris5-6 mips/t-iris6\"\n \ttarget_cpu_default=\"MASK_ABICALLS|MASK_FLOAT64|MASK_64BIT\"\n \ttm_defines=\"MIPS_ISA_DEFAULT=3 MIPS_ABI_DEFAULT=ABI_N32\"\n \t# See comment in mips/iris5.h file.  Only enabled for O32 ABI"}, {"sha": "5bac6e6fd605596faa91c7c498ac190fd4c3c96c", "filename": "gcc/config/mips/iris6.h", "status": "modified", "additions": 15, "deletions": 8, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firis6.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firis6.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Firis6.h?ref=21b807f18020f6f10753b0a0ab7d53a65f31b79a", "patch": "@@ -436,8 +436,7 @@ while (0)\n /* Profiling is supported via libprof1.a not -lc_p as in IRIX 3.  */\n /* ??? If no mabi=X option give, but a mipsX option is, then should depend\n    on the mipsX option.  */\n-#undef STARTFILE_SPEC\n-#define STARTFILE_SPEC \\\n+#define IRIX6_STARTFILE_SPEC \\\n   \"%{!shared: \\\n      %{mabi=32:%{pg:gcrt1.o%s} \\\n        %{!pg:%{p:mcrt1.o%s libprof1.a%s}%{!p:crt1.o%s}}} \\\n@@ -461,8 +460,10 @@ while (0)\n            %{!p:/usr/lib32/mips4/crt1.o%s}}} \\\n        %{!mips4:%{pg:/usr/lib32/mips3/gcrt1.o%s} \\\n          %{!pg:%{p:/usr/lib32/mips3/mcrt1.o%s /usr/lib32/mips3/libprof1.a%s} \\\n-           %{!p:/usr/lib32/mips3/crt1.o%s}}}}} \\\n-   crtbegin.o%s\"\n+           %{!p:/usr/lib32/mips3/crt1.o%s}}}}}\"\n+\n+#undef STARTFILE_SPEC\n+#define STARTFILE_SPEC \"%(irix6_startfile_spec) crtbegin.o%s\"\n \n #undef LIB_SPEC\n #define LIB_SPEC \\\n@@ -481,10 +482,8 @@ while (0)\n \n /* ??? If no mabi=X option give, but a mipsX option is, then should depend\n    on the mipsX option.  */\n-#undef ENDFILE_SPEC\n-#define ENDFILE_SPEC \\\n-  \"crtend.o%s \\\n-   %{!shared: \\\n+#define IRIX6_ENDFILE_SPEC \\\n+  \"%{!shared: \\\n      %{mabi=32:crtn.o%s}\\\n      %{mabi=n32:%{mips4:/usr/lib32/mips4/crtn.o%s}\\\n        %{!mips4:/usr/lib32/mips3/crtn.o%s}}\\\n@@ -493,6 +492,9 @@ while (0)\n      %{!mabi*:%{mips4:/usr/lib32/mips4/crtn.o%s}\\\n        %{!mips4:/usr/lib32/mips3/crtn.o%s}}}\"\n \n+#undef ENDFILE_SPEC\n+#define ENDFILE_SPEC \"crtend.o%s %(irix6_endfile_spec)\"\n+\n /* ??? If no mabi=X option give, but a mipsX option is, then should depend\n    on the mipsX option.  */\n #undef LINK_SPEC\n@@ -516,3 +518,8 @@ do {\t\t\t\t\t\t\t\t\\\n } while (0)\n \n #define MIPS_TFMODE_FORMAT mips_extended_format\n+\n+#undef SUBTARGET_EXTRA_SPECS\n+#define SUBTARGET_EXTRA_SPECS \\\n+  { \"irix6_startfile_spec\", IRIX6_STARTFILE_SPEC }, \\\n+  { \"irix6_endfile_spec\", IRIX6_ENDFILE_SPEC },"}, {"sha": "1e5ee2c9f967681c88a69ebc57927ccda798c41b", "filename": "gcc/config/mips/iris6gld.h", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firis6gld.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firis6gld.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Firis6gld.h?ref=21b807f18020f6f10753b0a0ab7d53a65f31b79a", "patch": "@@ -44,8 +44,17 @@ Boston, MA 02111-1307, USA.  */\n %{static: -non_shared} \\\n %{!static: \\\n   %{!shared: %{!non_shared: %{!call_shared: -call_shared}}}} \\\n-%{rpath} -init __do_global_ctors -fini __do_global_dtors \\\n+%{rpath} -init __gcc_init -fini __gcc_fini \\\n %{mabi=32: -melf32bsmip}%{mabi=n32: -melf32bmipn32}%{mabi=64: -melf64bmip}%{!mabi*: -melf32bmipn32}\"\n \n+#undef STARTFILE_SPEC\n+#define STARTFILE_SPEC \"%(irix6_startfile_spec) irix6-crti.o%s crtbegin.o%s\"\n+\n+#undef ENDFILE_SPEC\n+#define ENDFILE_SPEC \"crtend.o%s irix6-crtn.o%s %(irix6_endfile_spec)\"\n+\n /* The GNU linker supports one-only sections.  */\n #define MAKE_DECL_ONE_ONLY(DECL) (DECL_WEAK (DECL) = 1)\n+\n+#define INIT_SECTION_ASM_OP \"\\t.section\\t.init,0x1,0x6,4,4\"\n+#define FINI_SECTION_ASM_OP \"\\t.section\\t.fini,0x1,0x6,4,4\""}, {"sha": "5d8ede703903c40f7aaeb01b3981199100a2507e", "filename": "gcc/config/mips/irix6-crti.asm", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firix6-crti.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firix6-crti.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Firix6-crti.asm?ref=21b807f18020f6f10753b0a0ab7d53a65f31b79a", "patch": "@@ -0,0 +1,33 @@\n+\t.abicalls\n+\t.set\tnoreorder\n+\t.set\tnomacro\n+\n+\t.section .init,0x1,0x6,4,4\n+\tjr\t$31\n+\tnop\n+\n+\t.globl\t__gcc_init\n+__gcc_init:\n+#if _MIPS_SIM == _ABIO32\n+\taddiu\t$sp,$sp,-16\n+\tsw\t$31,0($sp)\n+#else\n+\tdaddiu\t$sp,$sp,-16\n+\tsd\t$31,0($sp)\n+\tsd\t$28,8($sp)\n+#endif\n+\n+\t.section .fini,0x1,0x6,4,4\n+\tjr\t$31\n+\tnop\n+\n+\t.globl\t__gcc_fini\n+__gcc_fini:\n+#if _MIPS_SIM == _ABIO32\n+\taddiu\t$sp,$sp,-16\n+\tsw\t$31,0($sp)\n+#else\n+\tdaddiu\t$sp,$sp,-16\n+\tsd\t$31,0($sp)\n+\tsd\t$28,8($sp)\n+#endif"}, {"sha": "647e8e13e3174f81678d6997905038a3350b0569", "filename": "gcc/config/mips/irix6-crtn.asm", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firix6-crtn.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Firix6-crtn.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Firix6-crtn.asm?ref=21b807f18020f6f10753b0a0ab7d53a65f31b79a", "patch": "@@ -0,0 +1,27 @@\n+\t.abicalls\n+\t.set\tnoreorder\n+\t.set\tnomacro\n+\n+\t.section .init,0x1,0x6,4,4\n+#if _MIPS_SIM == _ABIO32\n+\tlw\t$31,0($sp)\n+\tjr\t$31\n+\taddiu\t$sp,$sp,16\n+#else\n+\tld\t$31,0($sp)\n+\tld\t$28,8($sp)\n+\tjr\t$31\n+\tdaddiu\t$sp,$sp,16\n+#endif\n+\n+\t.section .fini,0x1,0x6,4,4\n+#if _MIPS_SIM == _ABIO32\n+\tlw\t$31,0($sp)\n+\tjr\t$31\n+\taddiu\t$sp,$sp,16\n+#else\n+\tld\t$31,0($sp)\n+\tld\t$28,8($sp)\n+\tjr\t$31\n+\tdaddiu\t$sp,$sp,16\n+#endif"}, {"sha": "2926be0cb44cf72d2f6d4aa74599bb7f2cf17e7a", "filename": "gcc/config/mips/t-iris6gld", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Ft-iris6gld", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21b807f18020f6f10753b0a0ab7d53a65f31b79a/gcc%2Fconfig%2Fmips%2Ft-iris6gld", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Ft-iris6gld?ref=21b807f18020f6f10753b0a0ab7d53a65f31b79a", "patch": "@@ -0,0 +1,9 @@\n+$(T)irix6-crti.o: $(srcdir)/config/mips/irix6-crti.asm $(GCC_PASSES)\n+\t$(GCC_FOR_TARGET) $(GCC_CFLAGS) $(MULTILIB_CFLAGS) $(INCLUDES) \\\n+\t-c -o $@ -x assembler-with-cpp $<\n+\n+$(T)irix6-crtn.o: $(srcdir)/config/mips/irix6-crtn.asm $(GCC_PASSES)\n+\t$(GCC_FOR_TARGET) $(GCC_CFLAGS) $(MULTILIB_CFLAGS) $(INCLUDES) \\\n+\t-c -o $@ -x assembler-with-cpp $<\n+\n+EXTRA_MULTILIB_PARTS=crtbegin.o crtend.o irix6-crti.o irix6-crtn.o"}]}