{"sha": "d8086cbb53c533c2b0bbf97dbd353989cb163e94", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDgwODZjYmI1M2M1MzNjMmIwYmJmOTdkYmQzNTM5ODljYjE2M2U5NA==", "commit": {"author": {"name": "Roger Sayle", "email": "roger@eyesopen.com", "date": "2002-01-22T21:35:34Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2002-01-22T21:35:34Z"}, "message": "re PR rtl-optimization/3640 (small lost optimization of \"x==0 || x==1\")\n\n        PR opt/3640\n        * fold-const.c (fold): Optimize unsigned comparisons against\n        UINT_MAX (and similar unsigned constants).\n\nFrom-SVN: r49096", "tree": {"sha": "ab37f047934f6e0f697e2a023bf75c95dafbdacb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab37f047934f6e0f697e2a023bf75c95dafbdacb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d8086cbb53c533c2b0bbf97dbd353989cb163e94", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8086cbb53c533c2b0bbf97dbd353989cb163e94", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d8086cbb53c533c2b0bbf97dbd353989cb163e94", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8086cbb53c533c2b0bbf97dbd353989cb163e94/comments", "author": null, "committer": null, "parents": [{"sha": "11303d15ae2ef463efda87d80619f06dc1c9f8ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11303d15ae2ef463efda87d80619f06dc1c9f8ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/11303d15ae2ef463efda87d80619f06dc1c9f8ab"}], "stats": {"total": 146, "additions": 89, "deletions": 57}, "files": [{"sha": "5cafb331906c77c7502c8289fde6296b4c60e280", "filename": "gcc/ChangeLog", "status": "modified", "additions": 63, "deletions": 56, "changes": 119, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8086cbb53c533c2b0bbf97dbd353989cb163e94/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8086cbb53c533c2b0bbf97dbd353989cb163e94/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d8086cbb53c533c2b0bbf97dbd353989cb163e94", "patch": "@@ -1,8 +1,15 @@\n+2002-01-22  Roger Sayle  <roger@eyesopen.com>\n+\t    Richard Henderson  <rth@redhat.com>\n+\n+\tPR opt/3640\n+\t* fold-const.c (fold): Optimize unsigned comparisons against\n+\tUINT_MAX (and similar unsigned constants).\n+\n 2002-01-22  Janis Johnson  <janis187@us.ibm.com>\n \n-        * Makefile.in (loop.o): Depend on OPTABS_H.\n-        * loop.c (expand_builtin_prefetch): Check the prefetch operand\n-        against the predicate.\n+\t* Makefile.in (loop.o): Depend on OPTABS_H.\n+\t* loop.c (expand_builtin_prefetch): Check the prefetch operand\n+\tagainst the predicate.\n \n \tPR target/5379\n \t* config/i386/i386.md (prefetch_sse): Specify \"p\" as a constraint\n@@ -25,18 +32,18 @@\n \n 2002-01-22  Aldy Hernandez  <aldyh@redhat.com>\n \n-        * regrename.c (kill_value): Fix typo.\n+\t* regrename.c (kill_value): Fix typo.\n \n 2002-01-22  Aldy Hernandez  <aldyh@redhat.com>\n \n-        * doc/tm.texi: Remove STARTING_FRAME_PHASE.\n+\t* doc/tm.texi: Remove STARTING_FRAME_PHASE.\n \n-        * config/rs6000/rs6000.h: Same.\n+\t* config/rs6000/rs6000.h: Same.\n \n-        * function.c (instantiate_virtual_regs): Remove\n-        STARTING_FRAME_PHASE.\n-        (assign_stack_local_1): Same.\n-        Calculate frame phase.\n+\t* function.c (instantiate_virtual_regs): Remove\n+\tSTARTING_FRAME_PHASE.\n+\t(assign_stack_local_1): Same.\n+\tCalculate frame phase.\n \n 2002-01-22  Nick Clifton  <nickc@redhat.com>\n \n@@ -276,15 +283,15 @@ Sun Jan 20 18:40:14 2002  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n 2002-01-18  Aldy Hernandez  <aldyh@redhat.com>\n \n-        * doc/tm.texi (STARTING_FRAME_PHASE): Document.\n+\t* doc/tm.texi (STARTING_FRAME_PHASE): Document.\n \n-        * function.c (assign_stack_local_1): Adjust x_frame_offset with\n-        STARTING_FRAME_PHASE.\n-        (STARTING_FRAME_PHASE): New.\n-        (instantiate_virtual_regs): Check saneness of\n-        STARTING_FRAME_PHASE.\n+\t* function.c (assign_stack_local_1): Adjust x_frame_offset with\n+\tSTARTING_FRAME_PHASE.\n+\t(STARTING_FRAME_PHASE): New.\n+\t(instantiate_virtual_regs): Check saneness of\n+\tSTARTING_FRAME_PHASE.\n \n-        * config/rs6000/rs6000.h (STARTING_FRAME_PHASE): New.\n+\t* config/rs6000/rs6000.h (STARTING_FRAME_PHASE): New.\n \n 2002-01-19  Alexandre Oliva  <aoliva@redhat.com>\n \n@@ -327,11 +334,11 @@ Thu Jan 17 15:28:26 2002  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n 2002-01-17  Aldy Hernandez  <aldyh@redhat.com>\n \n-        * config.gcc (cpu_type): Include altivec.h in powerpc\n-        extra_headers.\n-        Same for darwin.\n+\t* config.gcc (cpu_type): Include altivec.h in powerpc\n+\textra_headers.\n+\tSame for darwin.\n \n-        * config/rs6000/altivec.h: New.\n+\t* config/rs6000/altivec.h: New.\n \n 2002-01-17  David Edelsohn  <edelsohn@gnu.org>\n \n@@ -409,7 +416,7 @@ Thu Jan 17 15:28:26 2002  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n 2002-01-16  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/5309:\n-        * config/sparc/sparc.c (ultrasparc_adjust_cost): Handle TYPE_IDIV the\n+\t* config/sparc/sparc.c (ultrasparc_adjust_cost): Handle TYPE_IDIV the\n \tsame way as TYPE_IMUL.\n \t(ultrasparc_sched_reorder): Likewise.\n \t* config/sparc/sparc.md (type): Add comment to update\n@@ -505,27 +512,27 @@ Wed Jan 16 17:54:22 CET 2002  Jan Hubicka  <jh@suse.cz>\n \n 2002-01-15  Aldy Hernandez  <aldyh@redhat.com>\n \n-        * config/rs6000/rs6000.md (altivec_stvx): Add parallels to stvx.\n-        (altivec_lvsl): Change constraint to b.\n-        (altivec_lvsr): Same.\n-        (altivec_lvebx): Same.\n-        (altivec_lvehx): Same.\n-        (altivec_lvewx): Same.\n-        (altivec_lvxl): Same.\n-        (altivec_lvx): Same.\n-        (altivec_stvx): Add parallel.\n-        (altivec_stvxl): Same.\n-        (altivec_stvehx): Same.\n-        (altivec_stvebx): Same.\n-        (altivec_stvebx): Same.\n+\t* config/rs6000/rs6000.md (altivec_stvx): Add parallels to stvx.\n+\t(altivec_lvsl): Change constraint to b.\n+\t(altivec_lvsr): Same.\n+\t(altivec_lvebx): Same.\n+\t(altivec_lvehx): Same.\n+\t(altivec_lvewx): Same.\n+\t(altivec_lvxl): Same.\n+\t(altivec_lvx): Same.\n+\t(altivec_stvx): Add parallel.\n+\t(altivec_stvxl): Same.\n+\t(altivec_stvehx): Same.\n+\t(altivec_stvebx): Same.\n+\t(altivec_stvebx): Same.\n \n 2002-01-15  Aldy Hernandez  <aldyh@redhat.com>\n \n-        * config.gcc: Change altivec.h to altivec-defs.h.\n+\t* config.gcc: Change altivec.h to altivec-defs.h.\n \n-        * config/rs6000/altivec.h: Delete.\n+\t* config/rs6000/altivec.h: Delete.\n \n-        * config/rs6000/altivec-defs.h: Add.\n+\t* config/rs6000/altivec-defs.h: Add.\n \n 2002-01-15  John David Anglin  <dave@hiauly1.hia.nrc.ca>\n \n@@ -903,24 +910,24 @@ Fri Jan 11 09:25:05 2002  Nicola Pero  <n.pero@mi.flashnet.it>\n \n 2002-01-10  Aldy Hernandez  <aldyh@redhat.com>\n \n-        * config/rs6000/rs6000.c (altivec_init_builtins): Add support for\n-        lvebx, lvehx, lvewx, lvxl, lvx, stvx, stvebx, stvehx, stvewx,\n-        stvxl.\n-        (altivec_expand_builtin): Same.\n-        (altivec_expand_stv_builtin): New.\n-\n-        * config/rs6000/rs6000.h (rs6000_builtins): Same.\n-\n-        * config/rs6000/rs6000.md (\"altivec_lvebx\"): New.\n-        (\"altivec_lvehx\"): New.\n-        (\"altivec_lvewx\"): New.\n-        (\"altivec_lvxl\"): New.\n-        (\"altivec_lvx\"): New.\n-        (\"altivec_stvx\"): New.\n-        (\"altivec_stvebx\"): New.\n-        (\"altivec_stvehx\"): New.\n-        (\"altivec_stvewx\"): New.\n-        (\"altivec_stvxl\"): New.\n+\t* config/rs6000/rs6000.c (altivec_init_builtins): Add support for\n+\tlvebx, lvehx, lvewx, lvxl, lvx, stvx, stvebx, stvehx, stvewx,\n+\tstvxl.\n+\t(altivec_expand_builtin): Same.\n+\t(altivec_expand_stv_builtin): New.\n+\n+\t* config/rs6000/rs6000.h (rs6000_builtins): Same.\n+\n+\t* config/rs6000/rs6000.md (\"altivec_lvebx\"): New.\n+\t(\"altivec_lvehx\"): New.\n+\t(\"altivec_lvewx\"): New.\n+\t(\"altivec_lvxl\"): New.\n+\t(\"altivec_lvx\"): New.\n+\t(\"altivec_stvx\"): New.\n+\t(\"altivec_stvebx\"): New.\n+\t(\"altivec_stvehx\"): New.\n+\t(\"altivec_stvewx\"): New.\n+\t(\"altivec_stvxl\"): New.\n \n 2002-01-10  Richard Henderson  <rth@redhat.com>\n "}, {"sha": "dec382d854e3c5275c5514ca98dd97642d3a8183", "filename": "gcc/fold-const.c", "status": "modified", "additions": 26, "deletions": 1, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8086cbb53c533c2b0bbf97dbd353989cb163e94/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8086cbb53c533c2b0bbf97dbd353989cb163e94/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=d8086cbb53c533c2b0bbf97dbd353989cb163e94", "patch": "@@ -1,6 +1,6 @@\n /* Fold a constant sub-tree into a single node for C-compiler\n    Copyright (C) 1987, 1988, 1992, 1993, 1994, 1995, 1996, 1997, 1998,\n-   1999, 2000, 2001 Free Software Foundation, Inc.\n+   1999, 2000, 2001, 2002 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -6753,6 +6753,31 @@ fold (expr)\n \t\tdefault:\n \t\t  break;\n \t\t}\n+\n+            else if (TREE_UNSIGNED (TREE_TYPE (arg1))\n+                     && tree_int_cst_equal (TYPE_MAX_VALUE (TREE_TYPE (arg1)),\n+                                            arg1))\n+              switch (TREE_CODE (t))\n+                {\n+                case GT_EXPR:\n+                  return omit_one_operand (type,\n+                                           convert (type, integer_zero_node),\n+                                           arg0);\n+                case GE_EXPR:\n+                  TREE_SET_CODE (t, EQ_EXPR);\n+                  break;\n+\n+                case LE_EXPR:\n+                  return omit_one_operand (type,\n+                                           convert (type, integer_one_node),\n+                                           arg0);\n+                case LT_EXPR:\n+                  TREE_SET_CODE (t, NE_EXPR);\n+                  break;\n+\n+                default:\n+                  break;\n+                }\n \t  }\n       }\n "}]}