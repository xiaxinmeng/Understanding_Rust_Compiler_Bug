{"sha": "ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWUzYTk5OWZlN2RmZGRiMjUzMWIwNDU3MzhmZjJjMGM0MGU2ZWI0Yw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-03-23T08:55:53Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-03-23T08:55:53Z"}, "message": "re PR sanitizer/85029 (-fsanitize=undefined internal compiler error: in maybe_optimize_ubsan_ptr_ifn, at sanopt.c:493)\n\n\tPR sanitizer/85029\n\t* sanopt.c (maybe_optimize_ubsan_ptr_ifn): If DECL_REGISTER (base),\n\tjust don't try to optimize it rather than assert it never happens.\n\n\t* g++.dg/ubsan/pr85029.C: New test.\n\nFrom-SVN: r258794", "tree": {"sha": "2e79f430a07b923b744e3898689ee65e1e67c75d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2e79f430a07b923b744e3898689ee65e1e67c75d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/comments", "author": null, "committer": null, "parents": [{"sha": "631270a5cedfad8267a5e7b94901035212713b61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/631270a5cedfad8267a5e7b94901035212713b61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/631270a5cedfad8267a5e7b94901035212713b61"}], "stats": {"total": 30, "additions": 28, "deletions": 2}, "files": [{"sha": "9b22865704815d5c8173941dcf011b2682fe56aa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "patch": "@@ -1,3 +1,9 @@\n+2018-03-23  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR sanitizer/85029\n+\t* sanopt.c (maybe_optimize_ubsan_ptr_ifn): If DECL_REGISTER (base),\n+\tjust don't try to optimize it rather than assert it never happens.\n+\n 2018-03-22  Kelvin Nilsen  <kelvin@gcc.gnu.org>\n \n \t* config/rs6000/rs6000-builtin.def: Remove various BU_ALTIVEC_X"}, {"sha": "223c06a83557ece5caeb7adb639a68b08d6d4f2a", "filename": "gcc/sanopt.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2Fsanopt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2Fsanopt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsanopt.c?ref=ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "patch": "@@ -488,9 +488,9 @@ maybe_optimize_ubsan_ptr_ifn (sanopt_ctx *ctx, gimple *stmt)\n \t\t\t\t  &unsignedp, &reversep, &volatilep);\n       if ((offset == NULL_TREE || TREE_CODE (offset) == INTEGER_CST)\n \t  && DECL_P (base)\n+\t  && !DECL_REGISTER (base)\n \t  && pbitpos.is_constant (&bitpos))\n \t{\n-\t  gcc_assert (!DECL_REGISTER (base));\n \t  offset_int expr_offset;\n \t  if (offset)\n \t    expr_offset = wi::to_offset (offset) + bitpos / BITS_PER_UNIT;"}, {"sha": "87c8970d364d5388b0b6ca34ee1c9e4e6b9e5301", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "patch": "@@ -1,3 +1,8 @@\n+2018-03-23  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR sanitizer/85029\n+\t* g++.dg/ubsan/pr85029.C: New test.\n+\n 2018-03-23  Alexandre Oliva <aoliva@redhat.com>\n \n \tPR c++/71251\n@@ -15,7 +20,7 @@\n \t* g++.old-deja/g++.robertl/eb58.C: Likewise.\n \t* g++.old-deja/g++.robertl/eb63.C: Likewise.\n \n-2018-03-22  Steven G. Kargl  <kargl@gcc.gnu.org\n+2018-03-22  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/84922\n \t* gfortran.dg/interface_42.f90: New test."}, {"sha": "07472af16a5fd39d90c154752b1599d77dbe728d", "filename": "gcc/testsuite/g++.dg/ubsan/pr85029.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr85029.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr85029.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fubsan%2Fpr85029.C?ref=ee3a999fe7dfddb2531b045738ff2c0c40e6eb4c", "patch": "@@ -0,0 +1,15 @@\n+// PR sanitizer/85029\n+// { dg-do compile }\n+// { dg-skip-if \"\" { *-*-* } { \"-flto -fno-fat-lto-objects\" } }\n+// { dg-options \"-fsanitize=undefined\" }\n+\n+struct B {\n+  virtual B bar ();\n+  int e;\n+} register a;\t// { dg-error \"register name not specified for 'a'\" }\n+\n+int\n+foo (...)\n+{\n+  return foo (a);\n+}"}]}