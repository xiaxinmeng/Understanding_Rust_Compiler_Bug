{"sha": "98056c540e9cfbaf5a463b10f8d179d58b050163", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTgwNTZjNTQwZTljZmJhZjVhNDYzYjEwZjhkMTc5ZDU4YjA1MDE2Mw==", "commit": {"author": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2015-02-13T13:06:54Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2015-02-13T13:06:54Z"}, "message": "constraints.md: Change \"Q\" and \"T\" constraints to memory constraints.\n\n\t* config/pa/constraints.md: Change \"Q\" and \"T\" constraints to memory\n\tconstraints.\n\t* config/pa/pa.c (pa_cannot_force_const_mem): Don't allow constant\n\tsymbolic references to data to be forced to constant memory on the\n\tSOM target.\n\nFrom-SVN: r220680", "tree": {"sha": "eb2ddb9c1608ecb3b157121ca10ed8cd56e47242", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eb2ddb9c1608ecb3b157121ca10ed8cd56e47242"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/98056c540e9cfbaf5a463b10f8d179d58b050163", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98056c540e9cfbaf5a463b10f8d179d58b050163", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98056c540e9cfbaf5a463b10f8d179d58b050163", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98056c540e9cfbaf5a463b10f8d179d58b050163/comments", "author": null, "committer": null, "parents": [{"sha": "fb0653ab96ba450a5f364cbf9463060dfe5729f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb0653ab96ba450a5f364cbf9463060dfe5729f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb0653ab96ba450a5f364cbf9463060dfe5729f5"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "fa363dc8bb984f974c7eabddb4f258f5edbf44f2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98056c540e9cfbaf5a463b10f8d179d58b050163/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98056c540e9cfbaf5a463b10f8d179d58b050163/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=98056c540e9cfbaf5a463b10f8d179d58b050163", "patch": "@@ -1,3 +1,11 @@\n+2015-02-13  John David Anglin  <danglin@gcc.gnu.org>\n+\n+\t* config/pa/constraints.md: Change \"Q\" and \"T\" constraints to memory\n+\tconstraints.\n+\t* config/pa/pa.c (pa_cannot_force_const_mem): Don't allow constant\n+\tsymbolic references to data to be forced to constant memory on the\n+\tSOM target.\n+\n 2015-02-13  Ilya Enkovich  <ilya.enkovich@intel.com>\n \n \tPR tree-optimization/65002"}, {"sha": "fed0b58af81cd648c2d893c32e62c943693354e2", "filename": "gcc/config/pa/constraints.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98056c540e9cfbaf5a463b10f8d179d58b050163/gcc%2Fconfig%2Fpa%2Fconstraints.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98056c540e9cfbaf5a463b10f8d179d58b050163/gcc%2Fconfig%2Fpa%2Fconstraints.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fconstraints.md?ref=98056c540e9cfbaf5a463b10f8d179d58b050163", "patch": "@@ -106,7 +106,7 @@\n   (and (match_code \"mem\")\n        (match_test \"IS_LO_SUM_DLT_ADDR_P (XEXP (op, 0))\")))\n \n-(define_constraint \"Q\"\n+(define_memory_constraint \"Q\"\n   \"A memory operand that can be used as the destination operand of an\n    integer store, or the source operand of an integer load.  That is\n    any memory operand that isn't a symbolic, indexed or lo_sum memory\n@@ -122,7 +122,7 @@\n   (and (match_code \"mem\")\n        (match_test \"IS_INDEX_ADDR_P (XEXP (op, 0))\")))\n \n-(define_constraint \"T\"\n+(define_memory_constraint \"T\"\n   \"A memory operand for floating-point loads and stores.\"\n   (match_test \"floating_point_store_memory_operand (op, mode)\"))\n "}, {"sha": "13bd5291390f9090b474b51e369d0b03b57becb2", "filename": "gcc/config/pa/pa.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/98056c540e9cfbaf5a463b10f8d179d58b050163/gcc%2Fconfig%2Fpa%2Fpa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/98056c540e9cfbaf5a463b10f8d179d58b050163/gcc%2Fconfig%2Fpa%2Fpa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.c?ref=98056c540e9cfbaf5a463b10f8d179d58b050163", "patch": "@@ -1569,6 +1569,14 @@ force_mode (machine_mode mode, rtx orig)\n static bool\n pa_cannot_force_const_mem (machine_mode mode ATTRIBUTE_UNUSED, rtx x)\n {\n+  /* Reload sometimes tries to put const data symbolic operands in\n+     readonly memory.  The HP SOM linker doesn't allow symbolic data\n+     in readonly memory.  */\n+  if (TARGET_SOM\n+      && !function_label_operand (x, VOIDmode)\n+      && symbolic_operand (x, VOIDmode))\n+    return true;\n+\n   return tls_referenced_p (x);\n }\n "}]}