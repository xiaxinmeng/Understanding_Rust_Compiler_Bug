{"sha": "ba551ec2775f53e7aab5eefd133e777d1edecd78", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmE1NTFlYzI3NzVmNTNlN2FhYjVlZWZkMTMzZTc3N2QxZWRlY2Q3OA==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@suse.de", "date": "2008-01-06T22:30:32Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2008-01-06T22:30:32Z"}, "message": "re PR libstdc++/34680 (Unconditional use of dynamic_cast in locale_facets.tcc breaks compilation with -fno-rtti)\n\ngcc/\n2008-01-06  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/34680\n\t* c-cppbuiltin.c (c_cpp_builtins): Define __GXX_RTTI, if appropriate.\n\t* doc/cpp.texi ([Common Predefined Macros]): Document.\n\ngcc/testsuite/\n2008-01-06  Paolo Carlini  <pcarlini@suse.de>\n\n\tPR libstdc++/34680\n\t* g++.dg/rtti/predefined-rtti-macro-1.C: New.\n\t* g++.dg/rtti/predefined-rtti-macro-2.C: Likewise.\n\nFrom-SVN: r131366", "tree": {"sha": "49f6db21770fca4683407960abea244f2719be10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/49f6db21770fca4683407960abea244f2719be10"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ba551ec2775f53e7aab5eefd133e777d1edecd78", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba551ec2775f53e7aab5eefd133e777d1edecd78", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba551ec2775f53e7aab5eefd133e777d1edecd78", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba551ec2775f53e7aab5eefd133e777d1edecd78/comments", "author": null, "committer": null, "parents": [{"sha": "5989df83be8402add1f7cad75ee98e7a8ac2dbda", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5989df83be8402add1f7cad75ee98e7a8ac2dbda", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5989df83be8402add1f7cad75ee98e7a8ac2dbda"}], "stats": {"total": 38, "additions": 38, "deletions": 0}, "files": [{"sha": "027769555481f95337f314b6ece7334f43215e4f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ba551ec2775f53e7aab5eefd133e777d1edecd78", "patch": "@@ -1,3 +1,9 @@\n+2008-01-06  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/34680\n+\t* c-cppbuiltin.c (c_cpp_builtins): Define __GXX_RTTI, if appropriate.\n+\t* doc/cpp.texi ([Common Predefined Macros]): Document.\n+\n 2008-01-06  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/i386.c (ix86_emit_swsqrtsf): Use negative constants in"}, {"sha": "86c3f9cfff251e285db90b36257b7ab6218bc6c0", "filename": "gcc/c-cppbuiltin.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Fc-cppbuiltin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Fc-cppbuiltin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-cppbuiltin.c?ref=ba551ec2775f53e7aab5eefd133e777d1edecd78", "patch": "@@ -449,6 +449,8 @@ c_cpp_builtins (cpp_reader *pfile)\n \tcpp_define (pfile, \"__GXX_WEAK__=0\");\n       if (warn_deprecated)\n \tcpp_define (pfile, \"__DEPRECATED\");\n+      if (flag_rtti)\n+\tcpp_define (pfile, \"__GXX_RTTI\");\n       if (cxx_dialect == cxx0x)\n         cpp_define (pfile, \"__GXX_EXPERIMENTAL_CXX0X__\");\n     }"}, {"sha": "0a0db6b7b657d78f61ca8d4b9b68a3f7aff78f94", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ba551ec2775f53e7aab5eefd133e777d1edecd78", "patch": "@@ -1,3 +1,9 @@\n+2008-01-06  Paolo Carlini  <pcarlini@suse.de>\n+\n+\tPR libstdc++/34680\n+\t* g++.dg/rtti/predefined-rtti-macro-1.C: New.\n+\t* g++.dg/rtti/predefined-rtti-macro-2.C: Likewise.\n+\n 2008-01-06  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/34545"}, {"sha": "5c94bc1de177d56aed3ff3c0201b59fa907d6f2e", "filename": "gcc/testsuite/g++.dg/rtti/predefined-rtti-macro-1.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fpredefined-rtti-macro-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fpredefined-rtti-macro-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fpredefined-rtti-macro-1.C?ref=ba551ec2775f53e7aab5eefd133e777d1edecd78", "patch": "@@ -0,0 +1,12 @@\n+// { dg-do compile }\n+\n+struct A { virtual ~A() { }; };\n+struct B : A { };\n+\n+void f(B* bp)\n+{\n+  bp =\n+#ifdef __GXX_RTTI\n+  dynamic_cast<B*>(static_cast<A*>(0));\n+#endif\n+}"}, {"sha": "284f2f64a23b71753ad4750c221a3038e421da5d", "filename": "gcc/testsuite/g++.dg/rtti/predefined-rtti-macro-2.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fpredefined-rtti-macro-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba551ec2775f53e7aab5eefd133e777d1edecd78/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fpredefined-rtti-macro-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Frtti%2Fpredefined-rtti-macro-2.C?ref=ba551ec2775f53e7aab5eefd133e777d1edecd78", "patch": "@@ -0,0 +1,12 @@\n+// { dg-do compile }\n+// { dg-options \"-fno-rtti\" }\n+\n+struct B { };\n+\n+void f(B* bp)\n+{\n+  bp =\n+#ifndef __GXX_RTTI\n+  static_cast<B*>(0);\n+#endif\n+}"}]}