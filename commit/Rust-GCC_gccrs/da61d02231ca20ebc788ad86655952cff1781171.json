{"sha": "da61d02231ca20ebc788ad86655952cff1781171", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGE2MWQwMjIzMWNhMjBlYmM3ODhhZDg2NjU1OTUyY2ZmMTc4MTE3MQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "pcarlini@unitus.it", "date": "2003-02-11T09:59:19Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2003-02-11T09:59:19Z"}, "message": "re PR libstdc++/9318 (i/ostream::operator>>/<<(streambuf*) broken)\n\n2003-02-11  Paolo Carlini  <pcarlini@unitus.it>\n\t    Petur Runolfsson  <peturr02@ru.is>\n\n\tPR libstdc++/9318\n\t* include/bits/streambuf.tcc (__copy_streambufs):\n\tDon't conditionalize the copy to __testput.\n\t* testsuite/27_io/streambuf_members.cc (test09, test10): Add.\n\nCo-Authored-By: Petur Runolfsson <peturr02@ru.is>\n\nFrom-SVN: r62689", "tree": {"sha": "7fc5c517ef72ddb7d4172de8884f02ee3a4943e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7fc5c517ef72ddb7d4172de8884f02ee3a4943e2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/da61d02231ca20ebc788ad86655952cff1781171", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da61d02231ca20ebc788ad86655952cff1781171", "html_url": "https://github.com/Rust-GCC/gccrs/commit/da61d02231ca20ebc788ad86655952cff1781171", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da61d02231ca20ebc788ad86655952cff1781171/comments", "author": null, "committer": null, "parents": [{"sha": "194ea9ced6f547f5a6922ff9ac1dfb895262f1a2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/194ea9ced6f547f5a6922ff9ac1dfb895262f1a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/194ea9ced6f547f5a6922ff9ac1dfb895262f1a2"}], "stats": {"total": 61, "additions": 58, "deletions": 3}, "files": [{"sha": "9816498714b1099d40b039ce0919026685f6fd5d", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da61d02231ca20ebc788ad86655952cff1781171/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da61d02231ca20ebc788ad86655952cff1781171/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=da61d02231ca20ebc788ad86655952cff1781171", "patch": "@@ -1,3 +1,11 @@\n+2003-02-11  Paolo Carlini  <pcarlini@unitus.it>\n+            Petur Runolfsson  <peturr02@ru.is>\n+\n+\tPR libstdc++/9318\n+\t* include/bits/streambuf.tcc (__copy_streambufs):\n+\tDon't conditionalize the copy to __testput.\n+\t* testsuite/27_io/streambuf_members.cc (test09, test10): Add.\n+\n 2002-02-11  DJ Delorie  <dj@redhat.com>\n \n \t* acinclude.m4: Check for native targets that can't link at"}, {"sha": "44ba1d9d5752cd73a5d83e7010c867c9cf96d527", "filename": "libstdc++-v3/include/bits/streambuf.tcc", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da61d02231ca20ebc788ad86655952cff1781171/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da61d02231ca20ebc788ad86655952cff1781171/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstreambuf.tcc?ref=da61d02231ca20ebc788ad86655952cff1781171", "patch": "@@ -203,10 +203,9 @@ namespace std\n       streamsize __ret = 0;\n       streamsize __bufsize = __sbin->in_avail();\n       streamsize __xtrct;\n-      bool __testput = __sbout->_M_mode & ios_base::out;\n       try \n \t{\n-\t  while (__testput && __bufsize != -1)\n+\t  while (__bufsize != -1)\n   \t    {\n  \t      if (__bufsize != 0 && __sbin->gptr() != NULL\n \t\t  && __sbin->gptr() + __bufsize <= __sbin->egptr()) "}, {"sha": "80f569d807497826cbe304101ffb7f5a7042aac7", "filename": "libstdc++-v3/testsuite/27_io/streambuf_members.cc", "status": "modified", "additions": 49, "deletions": 1, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/da61d02231ca20ebc788ad86655952cff1781171/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstreambuf_members.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/da61d02231ca20ebc788ad86655952cff1781171/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstreambuf_members.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fstreambuf_members.cc?ref=da61d02231ca20ebc788ad86655952cff1781171", "patch": "@@ -31,7 +31,7 @@\n \n #include <cstring> // for memset, memcmp\n #include <streambuf>\n-#include <string>\n+#include <sstream>\n #include <ostream>\n #include <testsuite_hooks.h>\n \n@@ -386,6 +386,51 @@ void test08()\n   VERIFY( ob.getloc() == loc_de );\n }\n \n+// libstdc++/9318\n+class Outbuf : public std::streambuf\n+{\n+public:\n+  typedef std::streambuf::traits_type traits_type;\n+\n+  std::string result() const { return str; }\n+\n+protected:\n+  virtual int_type overflow(int_type c = traits_type::eof())\n+  {\n+    if (!traits_type::eq_int_type(c, traits_type::eof()))\n+      str.push_back(traits_type::to_char_type(c));\n+    return traits_type::not_eof(c);\n+  }\n+\n+private:\n+  std::string str;\n+};\n+\n+// <1>\n+void test09()\n+{\n+  bool test = true;\n+  \n+  std::istringstream stream(\"Bad Moon Rising\");\n+  Outbuf buf;\n+  stream >> &buf;\n+\n+  VERIFY( buf.result() == \"Bad Moon Rising\" );\n+}\n+\n+// <2>\n+void test10()\n+{\n+  bool test = true;\n+\n+  std::stringbuf sbuf(\"Bad Moon Rising\", std::ios::in);\n+  Outbuf buf;\n+  std::ostream stream(&buf);\n+  stream << &sbuf;\n+\n+  VERIFY( buf.result() == \"Bad Moon Rising\" );\n+}\n+\n int main() \n {\n   test01();\n@@ -397,5 +442,8 @@ int main()\n \n   test07();\n   test08();\n+\n+  test09();\n+  test10();\n   return 0;\n }"}]}