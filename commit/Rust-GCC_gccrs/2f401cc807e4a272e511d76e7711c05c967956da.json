{"sha": "2f401cc807e4a272e511d76e7711c05c967956da", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmY0MDFjYzgwN2U0YTI3MmU1MTFkNzZlNzcxMWMwNWM5Njc5NTZkYQ==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2000-11-24T10:30:46Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2000-11-24T10:30:46Z"}, "message": "c-parse.in (unary_expr): Move VA_ARG from here ...\n\n        * c-parse.in (unary_expr): Move VA_ARG from here ...\n        (primary): ... to here.\ncp:\n        * parse.y (unary_expr): Move VA_ARG from here ...\n        (primary): ... to here.\n\ntestsuite:\n        * g++.old-deja/g++.other/vaarg4.C: New test.\n        * gcc.c-torture/compile/20001123-1.c: New test.\n\nFrom-SVN: r37703", "tree": {"sha": "20a099d0a6fc33aefedda658079bc41fbd79cb59", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/20a099d0a6fc33aefedda658079bc41fbd79cb59"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2f401cc807e4a272e511d76e7711c05c967956da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f401cc807e4a272e511d76e7711c05c967956da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f401cc807e4a272e511d76e7711c05c967956da", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f401cc807e4a272e511d76e7711c05c967956da/comments", "author": null, "committer": null, "parents": [{"sha": "3d7e9ba41e50b16c6d77392d3fd85a8f46c9f13e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3d7e9ba41e50b16c6d77392d3fd85a8f46c9f13e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3d7e9ba41e50b16c6d77392d3fd85a8f46c9f13e"}], "stats": {"total": 51, "additions": 46, "deletions": 5}, "files": [{"sha": "650c5dcff092b1442297f472e42afc974a498381", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2f401cc807e4a272e511d76e7711c05c967956da", "patch": "@@ -1,3 +1,8 @@\n+2000-11-24  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* c-parse.in (unary_expr): Move VA_ARG from here ...\n+\t(primary): ... to here.\n+\n 2000-11-23  Graham Stott  <grahams@redhat.com>\n \n \t* expr.c (store_constructor): If a field is non addressable and"}, {"sha": "d73ba4bf8da8209503738e4560a6cf65e8e08ba0", "filename": "gcc/c-parse.in", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Fc-parse.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Fc-parse.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-parse.in?ref=2f401cc807e4a272e511d76e7711c05c967956da", "patch": "@@ -514,8 +514,6 @@ unary_expr:\n \t\t{ $$ = build_unary_op (REALPART_EXPR, $2, 0); }\n \t| IMAGPART cast_expr %prec UNARY\n \t\t{ $$ = build_unary_op (IMAGPART_EXPR, $2, 0); }\n-\t| VA_ARG '(' expr_no_commas ',' typename ')'\n-\t\t{ $$ = build_va_arg ($3, groktypename ($5)); }\n \t;\n \n sizeof:\n@@ -688,6 +686,8 @@ primary:\n \t\t}\n \t| primary '(' exprlist ')'   %prec '.'\n \t\t{ $$ = build_function_call ($1, $3); }\n+\t| VA_ARG '(' expr_no_commas ',' typename ')'\n+\t\t{ $$ = build_va_arg ($3, groktypename ($5)); }\n \t| primary '[' expr ']'   %prec '.'\n \t\t{ $$ = build_array_ref ($1, $3); }\n \t| primary '.' identifier"}, {"sha": "9bbf5b92e4a90a71fde043905daf81438ac0ca68", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2f401cc807e4a272e511d76e7711c05c967956da", "patch": "@@ -1,3 +1,8 @@\n+2000-11-24  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* parse.y (unary_expr): Move VA_ARG from here ...\n+\t(primary): ... to here.\n+\n 2000-11-24  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* semantics.c (finish_id_expr): If type is error_mark, return"}, {"sha": "9e32911058f9d3538e019f414202935ef5465325", "filename": "gcc/cp/parse.y", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Fcp%2Fparse.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Fcp%2Fparse.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparse.y?ref=2f401cc807e4a272e511d76e7711c05c967956da", "patch": "@@ -1252,9 +1252,6 @@ unary_expr:\n \t\t{ $$ = build_x_unary_op (REALPART_EXPR, $2); }\n \t| IMAGPART cast_expr %prec UNARY\n \t\t{ $$ = build_x_unary_op (IMAGPART_EXPR, $2); }\n-\t| VA_ARG '(' expr_no_commas ',' type_id ')'\n-\t\t{ $$ = build_x_va_arg ($3, groktypename ($5.t));\n-\t\t  check_for_new_type (\"__builtin_va_arg\", $5); }\n \t;\n \n new_placement:\n@@ -1562,6 +1559,9 @@ primary:\n                { $$ = finish_call_expr ($1, $3, 0); }\n \t| primary LEFT_RIGHT\n                { $$ = finish_call_expr ($1, NULL_TREE, 0); }\n+\t| VA_ARG '(' expr_no_commas ',' type_id ')'\n+\t\t{ $$ = build_x_va_arg ($3, groktypename ($5.t));\n+\t\t  check_for_new_type (\"__builtin_va_arg\", $5); }\n \t| primary '[' expr ']'\n \t\t{ $$ = grok_array_decl ($$, $3); }\n \t| primary PLUSPLUS"}, {"sha": "12ded3d5481e3cb51214e967bd116cacd3debf01", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2f401cc807e4a272e511d76e7711c05c967956da", "patch": "@@ -1,3 +1,8 @@\n+2000-11-24  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.old-deja/g++.other/vaarg4.C: New test.\n+\t* gcc.c-torture/compile/20001123-1.c: New test.\n+\n 2000-11-24  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* g++.other/crash24.C: Adjust and remove XFAIL."}, {"sha": "3b312ab0ae164f909284c4136d4c7301d926f545", "filename": "gcc/testsuite/g++.old-deja/g++.other/vaarg4.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fvaarg4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fvaarg4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fvaarg4.C?ref=2f401cc807e4a272e511d76e7711c05c967956da", "patch": "@@ -0,0 +1,15 @@\n+// Build don't link:\n+\n+// Bug 845. We were treating __builtin_va_arg as a unary expr, not a primary,\n+// and hence getting parse errors.\n+\n+typedef __builtin_va_list __gnuc_va_list;\n+typedef __gnuc_va_list va_list;\n+\n+struct X { int y; };\n+\n+void func(va_list va)\n+{\n+  char* a = __builtin_va_arg(va, char**)[0];\n+  int b = __builtin_va_arg(va, X*)->y;\n+}"}, {"sha": "59534480db26be743673dc08036c748120ae306a", "filename": "gcc/testsuite/gcc.c-torture/compile/20001123-1.c", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20001123-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2f401cc807e4a272e511d76e7711c05c967956da/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20001123-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2F20001123-1.c?ref=2f401cc807e4a272e511d76e7711c05c967956da", "patch": "@@ -0,0 +1,11 @@\n+\n+typedef __builtin_va_list __gnuc_va_list;\n+typedef __gnuc_va_list va_list;\n+\n+struct X { int y; };\n+\n+void func(va_list va)\n+{\n+  char* a = __builtin_va_arg(va, char**)[0];\n+  int b = __builtin_va_arg(va, struct X*)->y;\n+}"}]}