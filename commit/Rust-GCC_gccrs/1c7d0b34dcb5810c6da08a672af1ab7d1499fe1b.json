{"sha": "1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWM3ZDBiMzRkY2I1ODEwYzZkYTA4YTY3MmFmMWFiN2QxNDk5ZmUxYg==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2011-01-21T14:57:33Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2011-01-21T14:57:33Z"}, "message": "re PR debug/47106 (-fcompare-debug failure (length) with  -fpartial-inlining -flto -fconserve-stack)\n\nPR debug/47106\n* cfgexpand.c (account_used_vars_for_block): Only account vars\nthat are annotated as used.\n(estimated_stack_frame_size): Don't set TREE_USED.\n* tree-dfa.c (create_var_ann): Mark variable as used.\n\nFrom-SVN: r169093", "tree": {"sha": "755d1d58491daff3fda926aecf62711e4f7c668b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/755d1d58491daff3fda926aecf62711e4f7c668b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b/comments", "author": null, "committer": null, "parents": [{"sha": "f99cc488e2dce167370c00d1948fe2846acab19c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f99cc488e2dce167370c00d1948fe2846acab19c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f99cc488e2dce167370c00d1948fe2846acab19c"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "36ad66e6e88a158e8a648260ca87ef747cf0cff8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b", "patch": "@@ -1,3 +1,11 @@\n+2011-01-21  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\tPR debug/47106\n+\t* cfgexpand.c (account_used_vars_for_block): Only account vars\n+\tthat are annotated as used.\n+\t(estimated_stack_frame_size): Don't set TREE_USED.\n+\t* tree-dfa.c (create_var_ann): Mark variable as used.\n+\n 2011-01-21  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/47395"}, {"sha": "bb60c3370848bcc1b97e2245964572c1863131e7", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b", "patch": "@@ -1325,7 +1325,7 @@ account_used_vars_for_block (tree block, bool toplevel)\n \n   /* Expand all variables at this level.  */\n   for (t = BLOCK_VARS (block); t ; t = DECL_CHAIN (t))\n-    if (TREE_USED (t))\n+    if (var_ann (t) && var_ann (t)->used)\n       size += expand_one_var (t, toplevel, false);\n \n   /* Expand all variables at containing levels.  */\n@@ -1389,9 +1389,10 @@ estimated_stack_frame_size (tree decl)\n \n   FOR_EACH_LOCAL_DECL (cfun, ix, var)\n     {\n+      /* TREE_USED marks local variables that do not appear in lexical\n+\t blocks.  We don't want to expand those that do twice.  */\n       if (TREE_USED (var))\n         size += expand_one_var (var, true, false);\n-      TREE_USED (var) = 1;\n     }\n   size += account_used_vars_for_block (outer_block, true);\n "}, {"sha": "876674417e54c42464051be9a20b0e64b9239c33", "filename": "gcc/tree-dfa.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b/gcc%2Ftree-dfa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b/gcc%2Ftree-dfa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-dfa.c?ref=1c7d0b34dcb5810c6da08a672af1ab7d1499fe1b", "patch": "@@ -137,6 +137,9 @@ create_var_ann (tree t)\n   ann = ggc_alloc_cleared_var_ann_d ();\n   *DECL_VAR_ANN_PTR (t) = ann;\n \n+  /* Assume the variable is used, at least for now.  */\n+  ann->used = true;\n+\n   return ann;\n }\n "}]}