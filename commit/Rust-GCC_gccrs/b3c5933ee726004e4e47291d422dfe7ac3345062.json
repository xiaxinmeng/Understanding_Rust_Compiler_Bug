{"sha": "b3c5933ee726004e4e47291d422dfe7ac3345062", "node_id": "C_kwDOANBUbNoAKGIzYzU5MzNlZTcyNjAwNGU0ZTQ3MjkxZDQyMmRmZTdhYzMzNDUwNjI", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2023-03-28T20:26:30Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2023-03-28T21:02:39Z"}, "message": "Enable 'gfortran.dg/weak-2.f90' for nvptx target\n\nFollow-up to commit bcbeebc498126c50d73809ec8a4bd0bff27ee97b\n\"Fortran: Add support for WEAK attribute for variables\".\n\n\tgcc/testsuite/\n\t* gfortran.dg/weak-2.f90: Enable for nvptx target.", "tree": {"sha": "99d1be725d71412005b175b6f680befa749c5754", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/99d1be725d71412005b175b6f680befa749c5754"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b3c5933ee726004e4e47291d422dfe7ac3345062", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3c5933ee726004e4e47291d422dfe7ac3345062", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b3c5933ee726004e4e47291d422dfe7ac3345062", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b3c5933ee726004e4e47291d422dfe7ac3345062/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cb6f663f9d79d7134ae6ecaff9a25342c40aeb5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb6f663f9d79d7134ae6ecaff9a25342c40aeb5d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb6f663f9d79d7134ae6ecaff9a25342c40aeb5d"}], "stats": {"total": 10, "additions": 6, "deletions": 4}, "files": [{"sha": "ab273a13b6ce4bb60953ef87aae397ef6732e656", "filename": "gcc/testsuite/gfortran.dg/weak-2.f90", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b3c5933ee726004e4e47291d422dfe7ac3345062/gcc%2Ftestsuite%2Fgfortran.dg%2Fweak-2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b3c5933ee726004e4e47291d422dfe7ac3345062/gcc%2Ftestsuite%2Fgfortran.dg%2Fweak-2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fweak-2.f90?ref=b3c5933ee726004e4e47291d422dfe7ac3345062", "patch": "@@ -1,25 +1,27 @@\n ! { dg-do compile }\n ! { dg-require-weak \"\" }\n ! { dg-skip-if \"\" { x86_64-*-mingw* } }\n-! { dg-skip-if \"\" { nvptx-*-* } }\n \n ! 1.\n-! { dg-final { scan-assembler \"weak\\[^ \\t\\]*\\[ \\t\\]_?__foo_MOD_abc\" } }\n+! { dg-final { scan-assembler \"weak\\[^ \\t\\]*\\[ \\t\\]_?__foo_MOD_abc\" { target { ! nvptx-*-* } } } }\n+! { dg-final { scan-assembler-times \"\\\\.weak \\\\.global \\\\.align 4 \\\\.u32 __foo_MOD_abc\" 1 { target nvptx-*-* } } }\n module foo\n implicit none\n !GCC$ ATTRIBUTES weak :: abc\n real :: abc(7)\n end module\n \n ! 2.\n-! { dg-final { scan-assembler \"weak\\[^ \\t\\]*\\[ \\t\\]_?impl1\" } }\n+! { dg-final { scan-assembler \"weak\\[^ \\t\\]*\\[ \\t\\]_?impl1\" { target { ! nvptx-*-* } } } }\n+! { dg-final { scan-assembler-times \"\\\\.weak \\\\.func \\\\(\\\\.param\\\\.u32 %value_out\\\\) impl1\" 2 { target nvptx-*-* } } }\n integer function impl1()\n implicit none\n !GCC$ ATTRIBUTES weak :: impl1\n end function\n \n ! 3.\n-! { dg-final { scan-assembler \"weak\\[^ \\t\\]*\\[ \\t\\]_?bar__\" } }\n+! { dg-final { scan-assembler \"weak\\[^ \\t\\]*\\[ \\t\\]_?bar__\" { target { ! nvptx-*-* } } } }\n+! { dg-final { scan-assembler-times \"\\\\.weak \\\\.func \\\\(\\\\.param\\\\.u32 %value_out\\\\) bar__\" 2 { target nvptx-*-* } } }\n integer function impl2() bind(c,name='bar__')\n implicit none\n !GCC$ ATTRIBUTES weak :: impl2"}]}