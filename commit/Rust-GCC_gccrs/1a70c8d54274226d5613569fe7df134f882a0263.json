{"sha": "1a70c8d54274226d5613569fe7df134f882a0263", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWE3MGM4ZDU0Mjc0MjI2ZDU2MTM1NjlmZTdkZjEzNGY4ODJhMDI2Mw==", "commit": {"author": {"name": "Maxim Kuvyrkov", "email": "maxim.kuvyrkov@linaro.org", "date": "2017-06-06T17:00:46Z"}, "committer": {"name": "Maxim Kuvyrkov", "email": "mkuvyrkov@gcc.gnu.org", "date": "2017-06-06T17:00:46Z"}, "message": "Add debug counter for loop array prefetching.\n\n\t* dbgcnt.def (prefetch): New debug counter.\n\t* tree-ssa-loop-prefetch.c (dbgcnt.h): New include.\n\t(schedule_prefetches): Stop issueing prefetches if debug counter\n\ttripped.\n\nChange-Id: Ia6160364735a889fb6d2370be21d98f87c0fe962\n\nFrom-SVN: r248924", "tree": {"sha": "cdde47417866f7ddef28e0e0e14d3165b6226876", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cdde47417866f7ddef28e0e0e14d3165b6226876"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a70c8d54274226d5613569fe7df134f882a0263", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a70c8d54274226d5613569fe7df134f882a0263", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a70c8d54274226d5613569fe7df134f882a0263", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a70c8d54274226d5613569fe7df134f882a0263/comments", "author": {"login": "maxim-kuvyrkov", "id": 12545699, "node_id": "MDQ6VXNlcjEyNTQ1Njk5", "avatar_url": "https://avatars.githubusercontent.com/u/12545699?v=4", "gravatar_id": "", "url": "https://api.github.com/users/maxim-kuvyrkov", "html_url": "https://github.com/maxim-kuvyrkov", "followers_url": "https://api.github.com/users/maxim-kuvyrkov/followers", "following_url": "https://api.github.com/users/maxim-kuvyrkov/following{/other_user}", "gists_url": "https://api.github.com/users/maxim-kuvyrkov/gists{/gist_id}", "starred_url": "https://api.github.com/users/maxim-kuvyrkov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/maxim-kuvyrkov/subscriptions", "organizations_url": "https://api.github.com/users/maxim-kuvyrkov/orgs", "repos_url": "https://api.github.com/users/maxim-kuvyrkov/repos", "events_url": "https://api.github.com/users/maxim-kuvyrkov/events{/privacy}", "received_events_url": "https://api.github.com/users/maxim-kuvyrkov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6c6b519a32c3431fa5fde89db585ddc32eb83da2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c6b519a32c3431fa5fde89db585ddc32eb83da2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c6b519a32c3431fa5fde89db585ddc32eb83da2"}], "stats": {"total": 13, "additions": 13, "deletions": 0}, "files": [{"sha": "c4801f0c97cce5ffde479ecce7bf01ba45d8a795", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a70c8d54274226d5613569fe7df134f882a0263/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a70c8d54274226d5613569fe7df134f882a0263/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1a70c8d54274226d5613569fe7df134f882a0263", "patch": "@@ -1,3 +1,10 @@\n+2017-06-06  Maxim Kuvyrkov  <maxim.kuvyrkov@linaro.org>\n+\n+        * dbgcnt.def (prefetch): New debug counter.\n+        * tree-ssa-loop-prefetch.c (dbgcnt.h): New include.\n+        (schedule_prefetches): Stop issueing prefetches if debug counter\n+        tripped.\n+\n 2017-06-06  Tom de Vries  <tom@codesourcery.com>\n \n \t* doc/sourcebuild.texi (Testsuites, C Language Testsuites,"}, {"sha": "6c6350836f9654b9955744531d1104699556703d", "filename": "gcc/dbgcnt.def", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a70c8d54274226d5613569fe7df134f882a0263/gcc%2Fdbgcnt.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a70c8d54274226d5613569fe7df134f882a0263/gcc%2Fdbgcnt.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdbgcnt.def?ref=1a70c8d54274226d5613569fe7df134f882a0263", "patch": "@@ -174,6 +174,7 @@ DEBUG_COUNTER (merged_ipa_icf)\n DEBUG_COUNTER (postreload_cse)\n DEBUG_COUNTER (pre)\n DEBUG_COUNTER (pre_insn)\n+DEBUG_COUNTER (prefetch)\n DEBUG_COUNTER (registered_jump_thread)\n DEBUG_COUNTER (sched2_func)\n DEBUG_COUNTER (sched_block)"}, {"sha": "60101417a4e36a1999a10264e1a2b87e4af09528", "filename": "gcc/tree-ssa-loop-prefetch.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a70c8d54274226d5613569fe7df134f882a0263/gcc%2Ftree-ssa-loop-prefetch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a70c8d54274226d5613569fe7df134f882a0263/gcc%2Ftree-ssa-loop-prefetch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-prefetch.c?ref=1a70c8d54274226d5613569fe7df134f882a0263", "patch": "@@ -48,6 +48,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"tree-inline.h\"\n #include \"tree-data-ref.h\"\n #include \"diagnostic-core.h\"\n+#include \"dbgcnt.h\"\n \n /* This pass inserts prefetch instructions to optimize cache usage during\n    accesses to arrays in loops.  It processes loops sequentially and:\n@@ -1058,6 +1059,10 @@ schedule_prefetches (struct mem_ref_group *groups, unsigned unroll_factor,\n \tif (2 * remaining_prefetch_slots < prefetch_slots)\n \t  continue;\n \n+\t/* Stop prefetching if debug counter is activated.  */\n+\tif (!dbg_cnt (prefetch))\n+\t  continue;\n+\n \tref->issue_prefetch_p = true;\n \n \tif (remaining_prefetch_slots <= prefetch_slots)"}]}