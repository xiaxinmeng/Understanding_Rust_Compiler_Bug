{"sha": "4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGU0YThjMjhmM2RhMDI2NGViNzZkZmYwZWZlMjFiNGI1Y2U2M2I4NA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2019-11-26T21:58:22Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2019-11-26T21:58:22Z"}, "message": "re PR c++/92648 (Handling of unknown attributes)\n\n\tPR c++/92648\n\t* parser.c (cp_parser_std_attribute): For unknown attributes,\n\tskip balanced token seq instead of trying to parse\n\tattribute-argument-clause as expression list.  Formatting fix.\n\n\t* g++.dg/cpp0x/gen-attrs-71.C: New test.\n\nFrom-SVN: r278737", "tree": {"sha": "64fc447a5a41dcfbfa6d66fa56da2a919eee8283", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/64fc447a5a41dcfbfa6d66fa56da2a919eee8283"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "05d6cb1a858151016dbd368fd8b0792f73423d19", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/05d6cb1a858151016dbd368fd8b0792f73423d19", "html_url": "https://github.com/Rust-GCC/gccrs/commit/05d6cb1a858151016dbd368fd8b0792f73423d19"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "a7c0bca9e312070ddefdb0ff07e30b8fb5b7686f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "patch": "@@ -1,5 +1,10 @@\n 2019-11-26  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/92648\n+\t* parser.c (cp_parser_std_attribute): For unknown attributes,\n+\tskip balanced token seq instead of trying to parse\n+\tattribute-argument-clause as expression list.  Formatting fix.\n+\n \tPR c++/61414\n \t* class.c (enum_to_min_precision): New hash_map.\n \t(enum_min_precision): New function."}, {"sha": "d0c9ff01d9ee30aaf11f9c79f80e777e9884904b", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "patch": "@@ -26629,6 +26629,15 @@ cp_parser_std_attribute (cp_parser *parser, tree attr_ns)\n       /* A GNU attribute that takes an identifier in parameter.  */\n       attr_flag = id_attr;\n \n+    if (as == NULL)\n+      {\n+\t/* For unknown attributes, just skip balanced tokens instead of\n+\t   trying to parse the arguments.  */\n+\tfor (size_t n = cp_parser_skip_balanced_tokens (parser, 1) - 1; n; --n)\n+\t  cp_lexer_consume_token (parser->lexer);\n+\treturn attribute;\n+      }\n+\n     vec = cp_parser_parenthesized_expression_list\n       (parser, attr_flag, /*cast_p=*/false,\n        /*allow_expansion_p=*/true,\n@@ -26637,7 +26646,7 @@ cp_parser_std_attribute (cp_parser *parser, tree attr_ns)\n       arguments = error_mark_node;\n     else\n       {\n-\tif (vec->is_empty())\n+\tif (vec->is_empty ())\n \t  /* e.g. [[attr()]].  */\n \t  error_at (token->location, \"parentheses must be omitted if \"\n \t\t    \"%qE attribute argument list is empty\","}, {"sha": "32ba76b21f76ef2ef69625b343b06c97c4276491", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "patch": "@@ -1,5 +1,8 @@\n 2019-11-26  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/92648\n+\t* g++.dg/cpp0x/gen-attrs-71.C: New test.\n+\n \tPR c++/61414\n \t* g++.dg/cpp0x/enum23.C: Remove xfail.\n \t* g++.dg/cpp0x/enum28.C: New test."}, {"sha": "7876a2fba30c4946a8a8d7af8b0f21807e9eeace", "filename": "gcc/testsuite/g++.dg/cpp0x/gen-attrs-71.C", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fgen-attrs-71.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fgen-attrs-71.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fgen-attrs-71.C?ref=4e4a8c28f3da0264eb76dff0efe21b4b5ce63b84", "patch": "@@ -0,0 +1,7 @@\n+// PR c++/92648\n+// { dg-do compile { target c++11 } }\n+\n+int a [[gnu::no_such_attribute(![!(!)!]!,;;)]];\t// { dg-warning \"ignored\" }\n+int b [[no_such_namespace::nonexisting_attribute(linear(c, d : 2), reduction(*:e), linear(uval (f)))]];\t// { dg-warning \"ignored\" }\n+int c [[gnu::nonexisting_attribute()]];\t// { dg-warning \"ignored\" }\n+int d [[gnu::another_nonexistent_attr(1,\"abcd\",g+6)]];\t// { dg-warning \"ignored\" }"}]}