{"sha": "1ca0c604b955bd2e9a2ae6165c8577044b803d34", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWNhMGM2MDRiOTU1YmQyZTlhMmFlNjE2NWM4NTc3MDQ0YjgwM2QzNA==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-07-11T19:37:48Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "1994-07-11T19:37:48Z"}, "message": "Compile most of cc1plus in the `cp' subdirector.\n\nFrom-SVN: r7710", "tree": {"sha": "b593f25727af849bc6ee40e560aca52fef4300c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b593f25727af849bc6ee40e560aca52fef4300c6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1ca0c604b955bd2e9a2ae6165c8577044b803d34", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ca0c604b955bd2e9a2ae6165c8577044b803d34", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1ca0c604b955bd2e9a2ae6165c8577044b803d34", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1ca0c604b955bd2e9a2ae6165c8577044b803d34/comments", "author": null, "committer": null, "parents": [{"sha": "b5890b315799572ece95bda30ecd522c499e3580", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5890b315799572ece95bda30ecd522c499e3580", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5890b315799572ece95bda30ecd522c499e3580"}], "stats": {"total": 50, "additions": 35, "deletions": 15}, "files": [{"sha": "9430d118fdbd82da2a534a20bc253c970e982a71", "filename": "gcc/make-cc1.com", "status": "modified", "additions": 35, "deletions": 15, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1ca0c604b955bd2e9a2ae6165c8577044b803d34/gcc%2Fmake-cc1.com", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1ca0c604b955bd2e9a2ae6165c8577044b803d34/gcc%2Fmake-cc1.com", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmake-cc1.com?ref=1ca0c604b955bd2e9a2ae6165c8577044b803d34", "patch": "@@ -32,6 +32,7 @@ $ CFLAGS =\t\"/Debug/noVerbos/CC1=\"\"-mpcc-alignment\"\"\"\n $! CFLAGS =\t\"/noOpt\"\t\t!uncomment for VAXC\n $ CINCL1 =\t\"/Incl=[]\"\t\t\t!stage 1 -I flags\n $ CINCL2 =\t\"/Incl=([],[.ginclude])\"\t!stage 2,3,... flags\n+$ CINCL_SUB =\t\"/Incl=([],[-],[-.ginclude])\"\t![.cp] flags\n $!\n $!\tLink options\n $!\n@@ -89,6 +90,7 @@ $DO_ALL = 0\n $DO_LINK = 0\n $DO_DEBUG = 0\n $DO_CC1PLUS = 0\n+$if f$trnlnm(\"cfile$\").nes.\"\" then  close/noLog cfile$\n $open cfile$ compilers.list\n $cinit:read cfile$ compilername/end=cinit_done\n $DO_'compilername'=0\n@@ -151,11 +153,11 @@ $if size.eq.0 then goto no_message\n $gas_message:\n $type sys$input\n \n-\tNote: GCC 2.0 treats external variables differently than GCC 1.40 does.\n-Before you use GCC 2.0, you should obtain a version of the assembler which \n-contains the patches to work with GCC 2.0 (GCC-AS 1.38 does not contain \n+\tNote: GCC 2.x treats external variables differently than GCC 1.x does.\n+Before you use GCC 2.x, you should obtain a version of the assembler which\n+contains the patches to work with GCC 2.x (GCC-AS 1.38 does not contain\n these patches - whatever comes after this probably will).  The assembler\n-in gcc-vms-1.40.tar.Z from prep does contain the proper patches.\n+in gcc-vms-1.42.tar.gz from prep does contain the proper patches.\n \n \tIf you do not update the assembler, the compiler will still work,\n but `extern const' variables will be treated as `extern'.  This will result\n@@ -166,7 +168,7 @@ $!\n $no_message:\n $!\n $!\n-$ if DO_DEBUG.eq.1 then LDFLAGS :='LDFLAGS'/debug\n+$ if DO_DEBUG.eq.1 then LDFLAGS = LDFLAGS + \"/Debug\"\n $!\n $if DO_LINK.eq.1 then goto compile_cc1\n $!\n@@ -206,8 +208,8 @@ $! First build a couple of header files from the machine description\n $! These are used by many of the source modules, so we build them now.\n $!\n $set verify\n-$ 'CC''CFLAGS' rtl.C\n-$ 'CC''CFLAGS' obstack.C\n+$ 'CC''CFLAGS' rtl.c\n+$ 'CC''CFLAGS' obstack.c\n $!'f$verify(0)\n $! Generate insn-attr.h\n $\tcall generate insn-attr.h\n@@ -220,6 +222,8 @@ $!\n $\tcall generate insn-attrtab.c \"rtlanal.obj,\"\n $set verify\n $ 'CC''CFLAGS' insn-attrtab.c\n+$ 'CC''CFLAGS' bc-emit.c\n+$ 'CC''CFLAGS' bc-optab.c\n $!'f$verify(0)\n $\tendif\n $!\n@@ -289,7 +293,8 @@ $cloop:read cfile$ compilername/end=cdone\n $! language specific modules\n $!\n $if (DO_ALL + DO_'compilername').eq.0 then goto cloop\n-$if DO_LINK.eq.0 then call compile 'compilername'-objs.opt \"obstack\"\n+$if DO_LINK.eq.0 then -\n+ call compile 'compilername'-objs.opt \"obstack,bc-emit,bc-optab\"\n $!\n $! CAUTION: If you want to link gcc-cc1* to the sharable image library\n $! VAXCRTL, see the notes in gcc.texinfo (or INSTALL) first.\n@@ -332,9 +337,20 @@ $flnm=f$element(i,\",\",line)\n $i=i+1\n $if flnm.eqs.\"\" then goto loop\n $if flnm.eqs.\",\" then goto loop\n-$if f$locate(flnm,\"''p2'\").nes.f$length(\"''p2'\") then goto loop1\n-$!\n-$if f$locate(\"-parse\",flnm).nes.f$length(flnm)\n+$if f$locate(flnm,p2).lt.f$length(p2) then goto loop1\n+$! check for front-end subdirectory: \"[.prfx]flnm\"\n+$prfx = \"\"\n+$k = f$locate(\"]\",flnm)\n+$if k.eq.1 then  goto loop1\t![]c-common for [.cp]\n+$if k.lt.f$length(flnm) then  prfx = f$extract(2,k-2,flnm)\n+$if k.lt.f$length(flnm) then  flnm = f$extract(k+1,99,flnm)\n+$ if prfx.nes.\"\"\n+$ then\tset default [.'prfx']\t!push\n+$\tsave_cflags = CFLAGS\n+$\tCFLAGS = CFLAGS - CINCL1 - CINCL2 + CINCL_SUB\n+$ endif\n+$!\n+$if f$locate(\"parse\",flnm).nes.f$length(flnm)\n $\tthen\n $\tif (f$search(\"''flnm'.C\") .eqs. \"\") then goto yes_bison\n $\tif (f$cvtime(f$file_attributes(\"''flnm'.Y\",\"RDT\")).les. -\n@@ -346,10 +362,10 @@ $\t 'BISON''BISON_FLAGS' 'flnm'.y\n $\t 'RENAME' 'flnm'_tab.c 'flnm'.c\n $\t 'RENAME' 'flnm'_tab.h 'flnm'.h\n $!'f$verify(0)\n-$\tif flnm.eqs.\"cp-parse\"\n+$\tif flnm.eqs.\"cp-parse\" .or. (prfx.eqs.\"cp\" .and. flnm.eqs.\"parse\")\n $\tthen\t\t! fgrep '#define YYEMPTY' cp-parse.c >>cp-parse.h\n-$\t\topen/Append jfile$ cp-parse.h\n-$\t\t'SEARCH'/Exact/Output=jfile$ cp-parse.c \"#define YYEMPTY\"\n+$\t\topen/Append jfile$ 'flnm'.h\n+$\t\t'SEARCH'/Exact/Output=jfile$ 'flnm'.c \"#define YYEMPTY\"\n $\t\tclose jfile$\n $\tendif\n $no_bison:\n@@ -361,9 +377,13 @@ $!\n $set verify\n $ 'CC''CFLAGS' 'flnm'.c\n $!'f$verify(0)\n+$ if prfx.nes.\"\"\n+$ then\tset default [-]\t\t!pop\n+$\tCFLAGS = save_CFLAGS\n+$ endif\n+$\n $goto loop1\n $!\n-$goto loop\n $!\n $! In case of error or abort, go here (In order to close file).\n $!"}]}