{"sha": "8e383849646654485307714640f89699bc6538ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGUzODM4NDk2NDY2NTQ0ODUzMDc3MTQ2NDBmODk2OTliYzY1MzhlZQ==", "commit": {"author": {"name": "Joern Rennecke", "email": "joern.rennecke@embecosm.com", "date": "2012-10-20T11:37:27Z"}, "committer": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "2012-10-20T11:37:27Z"}, "message": "emit-rtl.c (copy_delay_slot_insn): New function.\n\n2012-10-20  Joern Rennecke  <joern.rennecke@embecosm.com>\n            Richard Sandiford  <rdsandiford@googlemail.com>\n\n        * emit-rtl.c (copy_delay_slot_insn): New function.\n        * emit-rtl.h (copy_delay_slot_insn): Declare.\n        * reorg.c: Include \"emit-rtl.h\".\n        (steal_delay_list_from_target): Use copy_delay_slot_insn.\n        (fill_slots_from_thread, fill_simple_delay_slots): Likewise.\n\nCo-Authored-By: Richard Sandiford <rdsandiford@googlemail.com>\n\nFrom-SVN: r192633", "tree": {"sha": "9db85ce2d4f2bb9b45abc2d8446bb73af6a30c48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9db85ce2d4f2bb9b45abc2d8446bb73af6a30c48"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8e383849646654485307714640f89699bc6538ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e383849646654485307714640f89699bc6538ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e383849646654485307714640f89699bc6538ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e383849646654485307714640f89699bc6538ee/comments", "author": {"login": "amylaar", "id": 1663475, "node_id": "MDQ6VXNlcjE2NjM0NzU=", "avatar_url": "https://avatars.githubusercontent.com/u/1663475?v=4", "gravatar_id": "", "url": "https://api.github.com/users/amylaar", "html_url": "https://github.com/amylaar", "followers_url": "https://api.github.com/users/amylaar/followers", "following_url": "https://api.github.com/users/amylaar/following{/other_user}", "gists_url": "https://api.github.com/users/amylaar/gists{/gist_id}", "starred_url": "https://api.github.com/users/amylaar/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/amylaar/subscriptions", "organizations_url": "https://api.github.com/users/amylaar/orgs", "repos_url": "https://api.github.com/users/amylaar/repos", "events_url": "https://api.github.com/users/amylaar/events{/privacy}", "received_events_url": "https://api.github.com/users/amylaar/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4d84e22c4b0aca9cd2811a961b06c7510ef10b6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4d84e22c4b0aca9cd2811a961b06c7510ef10b6b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4d84e22c4b0aca9cd2811a961b06c7510ef10b6b"}], "stats": {"total": 41, "additions": 31, "deletions": 10}, "files": [{"sha": "44141a1c73607375c2e2122c7ee37779728fa4ab", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e383849646654485307714640f89699bc6538ee/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e383849646654485307714640f89699bc6538ee/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8e383849646654485307714640f89699bc6538ee", "patch": "@@ -1,3 +1,12 @@\n+2012-10-20  Joern Rennecke  <joern.rennecke@embecosm.com>\n+\t    Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\t* emit-rtl.c (copy_delay_slot_insn): New function.\n+\t* emit-rtl.h (copy_delay_slot_insn): Declare.\n+\t* reorg.c: Include \"emit-rtl.h\".\n+\t(steal_delay_list_from_target): Use copy_delay_slot_insn.\n+\t(fill_slots_from_thread, fill_simple_delay_slots): Likewise.\n+\n 2012-10-19  Jan Hubicka  <jh@suse.cz>\n \n \t* builtins.def (BUILT_IN_UNREACHABLE): Make ATTR_CONST_NORETURN_NOTHROW_LEAF_LIST."}, {"sha": "7d7b1dfb0a132133a586aa160a7ccb832e0091d0", "filename": "gcc/emit-rtl.c", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e383849646654485307714640f89699bc6538ee/gcc%2Femit-rtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e383849646654485307714640f89699bc6538ee/gcc%2Femit-rtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.c?ref=8e383849646654485307714640f89699bc6538ee", "patch": "@@ -1,8 +1,5 @@\n /* Emit RTL for the GCC expander.\n-   Copyright (C) 1987, 1988, 1992, 1993, 1994, 1995, 1996, 1997, 1998,\n-   1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,\n-   2010, 2011\n-   Free Software Foundation, Inc.\n+   Copyright (C) 1987, 1988, 1992-2012 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -5378,6 +5375,18 @@ copy_insn (rtx insn)\n   return copy_insn_1 (insn);\n }\n \n+/* Return a copy of INSN that can be used in a SEQUENCE delay slot,\n+   on that assumption that INSN itself remains in its original place.  */\n+\n+rtx\n+copy_delay_slot_insn (rtx insn)\n+{\n+  /* Copy INSN with its rtx_code, all its notes, location etc.  */\n+  insn = copy_rtx (insn);\n+  INSN_UID (insn) = cur_insn_uid++;\n+  return insn;\n+}\n+\n /* Initialize data structures and variables in this file\n    before generating rtl for each function.  */\n "}, {"sha": "cd0cbd0049bee75f14b18569ab3b161642dd64e4", "filename": "gcc/emit-rtl.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e383849646654485307714640f89699bc6538ee/gcc%2Femit-rtl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e383849646654485307714640f89699bc6538ee/gcc%2Femit-rtl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Femit-rtl.h?ref=8e383849646654485307714640f89699bc6538ee", "patch": "@@ -1,5 +1,5 @@\n /* Exported functions from emit-rtl.c\n-   Copyright (C) 2004, 2007, 2008, 2010 Free Software Foundation, Inc.\n+   Copyright (C) 2004, 2007, 2008, 2010, 2012 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -61,6 +61,7 @@ extern rtx gen_blockage (void);\n extern rtvec gen_rtvec (int, ...);\n extern rtx copy_insn_1 (rtx);\n extern rtx copy_insn (rtx);\n+extern rtx copy_delay_slot_insn (rtx);\n extern rtx gen_int_mode (HOST_WIDE_INT, enum machine_mode);\n extern rtx emit_copy_of_insn_after (rtx, rtx);\n extern void set_reg_attrs_from_value (rtx, rtx);"}, {"sha": "e07b8341ed4fbf7ffd91b030308831ac1d14035d", "filename": "gcc/reorg.c", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e383849646654485307714640f89699bc6538ee/gcc%2Freorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e383849646654485307714640f89699bc6538ee/gcc%2Freorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freorg.c?ref=8e383849646654485307714640f89699bc6538ee", "patch": "@@ -1,6 +1,6 @@\n /* Perform instruction reorganizations for delay slot filling.\n    Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000,\n-   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n+   2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2012\n    Free Software Foundation, Inc.\n    Contributed by Richard Kenner (kenner@vlsi1.ultra.nyu.edu).\n    Hacked by Michael Tiemann (tiemann@cygnus.com).\n@@ -134,6 +134,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"params.h\"\n #include \"target.h\"\n #include \"tree-pass.h\"\n+#include \"emit-rtl.h\"\n \n #ifdef DELAY_SLOTS\n \n@@ -1297,7 +1298,7 @@ steal_delay_list_from_target (rtx insn, rtx condition, rtx seq,\n \t{\n \t  if (must_annul)\n \t    used_annul = 1;\n-\t  temp = copy_rtx (trial);\n+\t  temp = copy_delay_slot_insn (trial);\n \t  INSN_FROM_TARGET_P (temp) = 1;\n \t  new_delay_list = add_to_delay_list (temp, new_delay_list);\n \t  total_slots_filled++;\n@@ -2369,7 +2370,8 @@ fill_simple_delay_slots (int non_jumps_p)\n \t      if (new_label)\n \t        {\n \t\t  delay_list\n-\t\t    = add_to_delay_list (copy_rtx (next_trial), delay_list);\n+\t\t    = add_to_delay_list (copy_delay_slot_insn (next_trial),\n+\t\t\t\t\t delay_list);\n \t\t  slots_filled++;\n \t\t  reorg_redirect_jump (trial, new_label);\n \n@@ -2793,7 +2795,7 @@ fill_slots_from_thread (rtx insn, rtx condition, rtx thread,\n \t\t  else\n \t\t    new_thread = next_active_insn (trial);\n \n-\t\t  temp = own_thread ? trial : copy_rtx (trial);\n+\t\t  temp = own_thread ? trial : copy_delay_slot_insn (trial);\n \t\t  if (thread_if_true)\n \t\t    INSN_FROM_TARGET_P (temp) = 1;\n \n@@ -2974,7 +2976,7 @@ fill_slots_from_thread (rtx insn, rtx condition, rtx thread,\n \t  else\n \t    new_thread = next_active_insn (trial);\n \n-\t  ninsn = own_thread ? trial : copy_rtx (trial);\n+\t  ninsn = own_thread ? trial : copy_delay_slot_insn (trial);\n \t  if (thread_if_true)\n \t    INSN_FROM_TARGET_P (ninsn) = 1;\n "}]}