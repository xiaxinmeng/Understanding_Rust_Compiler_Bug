{"sha": "abeab93869b150cb26b4267d14e3362dadb0a8be", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWJlYWI5Mzg2OWIxNTBjYjI2YjQyNjdkMTRlMzM2MmRhZGIwYThiZQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2009-06-11T20:11:59Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2009-06-11T20:11:59Z"}, "message": "re PR fortran/40402 (Problem with data statement involving structure constructors containing non-initialisation expressions)\n\n2009-06-11  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/40402\n\t* resolve.c (next_data_value): It is an error if the value is\n\tnot constant.\n\n2009-06-11  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/40402\n\t* gfortran.dg/data_value_1.f90: New test.\n\nFrom-SVN: r148396", "tree": {"sha": "84a4f811b1cf5dfc12a4245722cba5b630981ecf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/84a4f811b1cf5dfc12a4245722cba5b630981ecf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/abeab93869b150cb26b4267d14e3362dadb0a8be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abeab93869b150cb26b4267d14e3362dadb0a8be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/abeab93869b150cb26b4267d14e3362dadb0a8be", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/abeab93869b150cb26b4267d14e3362dadb0a8be/comments", "author": null, "committer": null, "parents": [{"sha": "5514b0f3df6c51607ad1bb941967aafe149c77b3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5514b0f3df6c51607ad1bb941967aafe149c77b3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5514b0f3df6c51607ad1bb941967aafe149c77b3"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "2f0ff9dee8cc7b0b685afb3373c84d62c67fcdad", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=abeab93869b150cb26b4267d14e3362dadb0a8be", "patch": "@@ -1,3 +1,9 @@\n+2009-06-11  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/40402\n+\t* resolve.c (next_data_value): It is an error if the value is\n+\tnot constant.\n+\n 2009-06-11  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/38718"}, {"sha": "04e03cc659b6c6ca9e9e3943bb3b7a09903ea6e3", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=abeab93869b150cb26b4267d14e3362dadb0a8be", "patch": "@@ -9852,9 +9852,12 @@ values;\n static gfc_try\n next_data_value (void)\n {\n-\n   while (mpz_cmp_ui (values.left, 0) == 0)\n     {\n+      if (!gfc_is_constant_expr (values.vnode->expr))\n+\tgfc_error (\"non-constant DATA value at %L\",\n+\t\t   &values.vnode->expr->where);\n+\n       if (values.vnode->next == NULL)\n \treturn FAILURE;\n "}, {"sha": "d49243f41d58d7684d2ce56be852a97ba1280e89", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=abeab93869b150cb26b4267d14e3362dadb0a8be", "patch": "@@ -1,3 +1,8 @@\n+2009-06-11  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/40402\n+\t* gfortran.dg/data_value_1.f90: New test.\n+\n 2009-06-11  Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n \n \tPR testsuite/39831"}, {"sha": "ea05a91d30d7482faeff9c02eec6173896c060d5", "filename": "gcc/testsuite/gfortran.dg/data_value_1.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_value_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/abeab93869b150cb26b4267d14e3362dadb0a8be/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_value_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdata_value_1.f90?ref=abeab93869b150cb26b4267d14e3362dadb0a8be", "patch": "@@ -0,0 +1,14 @@\n+! { dg-do compile }\n+! Test the fix for PR40402, in which it was not detected that X\n+! is not a constant and so the DATA statement did not have\n+! a constant value expression.\n+!\n+! Contributed by Philippe Marguinaud <philippe.marguinaud@meteo.fr>\n+!\n+      TYPE POINT\n+        REAL :: X \n+      ENDTYPE\n+      TYPE(POINT) :: P\n+      DATA P / POINT(1.+X) / ! { dg-error \"non-constant DATA value\" }\n+      print *, p\n+      END"}]}