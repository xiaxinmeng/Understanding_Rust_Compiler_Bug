{"sha": "2511b9c42ea969e71b3496b27321788546c3fdc8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjUxMWI5YzQyZWE5NjllNzFiMzQ5NmIyNzMyMTc4ODU0NmMzZmRjOA==", "commit": {"author": {"name": "Janis Johnson", "email": "janis@gcc.gnu.org", "date": "2001-12-04T00:54:21Z"}, "committer": {"name": "Janis Johnson", "email": "janis@gcc.gnu.org", "date": "2001-12-04T00:54:21Z"}, "message": "Test for __builtin_prefetch.\n\nFrom-SVN: r47584", "tree": {"sha": "d821e13ed0dcc291bf077d371f6ecee7eea01f3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d821e13ed0dcc291bf077d371f6ecee7eea01f3d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2511b9c42ea969e71b3496b27321788546c3fdc8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2511b9c42ea969e71b3496b27321788546c3fdc8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2511b9c42ea969e71b3496b27321788546c3fdc8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2511b9c42ea969e71b3496b27321788546c3fdc8/comments", "author": null, "committer": null, "parents": [{"sha": "868900245ea99d9bc0869227835d770ae2de6ac3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/868900245ea99d9bc0869227835d770ae2de6ac3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/868900245ea99d9bc0869227835d770ae2de6ac3"}], "stats": {"total": 59, "additions": 59, "deletions": 0}, "files": [{"sha": "0d32f16db3471f49197919b54ed2d8e93f1eb226", "filename": "gcc/testsuite/gcc.c-torture/execute/builtin-prefetch-1.c", "status": "added", "additions": 59, "deletions": 0, "changes": 59, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2511b9c42ea969e71b3496b27321788546c3fdc8/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fbuiltin-prefetch-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2511b9c42ea969e71b3496b27321788546c3fdc8/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fbuiltin-prefetch-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fbuiltin-prefetch-1.c?ref=2511b9c42ea969e71b3496b27321788546c3fdc8", "patch": "@@ -0,0 +1,59 @@\n+/* Test that __builtin_prefetch does no harm.\n+\n+   Prefetch using all valid combinations of rw and locality values.\n+   These must be compile-time constants.  */\n+\n+#define NO_TEMPORAL_LOCALITY 0\n+#define LOW_TEMPORAL_LOCALITY 1\n+#define MODERATE_TEMPORAL_LOCALITY 1\n+#define HIGH_TEMPORAL_LOCALITY 3\n+\n+#define WRITE_ACCESS 1\n+#define READ_ACCESS 0\n+\n+enum locality { none, low, moderate, high };\n+enum rw { read, write };\n+\n+int arr[10];\n+\n+void\n+good_const (int *p)\n+{\n+  __builtin_prefetch (p, 0, 0);\n+  __builtin_prefetch (p, 0, 1);\n+  __builtin_prefetch (p, 0, 2);\n+  __builtin_prefetch (p, READ_ACCESS, 3);\n+  __builtin_prefetch (p, 1, NO_TEMPORAL_LOCALITY);\n+  __builtin_prefetch (p, 1, LOW_TEMPORAL_LOCALITY);\n+  __builtin_prefetch (p, 1, MODERATE_TEMPORAL_LOCALITY);\n+  __builtin_prefetch (p, WRITE_ACCESS, HIGH_TEMPORAL_LOCALITY);\n+}\n+\n+void\n+good_enum (int *p)\n+{\n+    __builtin_prefetch (p, read, none);\n+    __builtin_prefetch (p, read, low);\n+    __builtin_prefetch (p, read, moderate);\n+    __builtin_prefetch (p, read, high);\n+    __builtin_prefetch (p, write, none);\n+    __builtin_prefetch (p, write, low);\n+    __builtin_prefetch (p, write, moderate);\n+    __builtin_prefetch (p, write, high);\n+}\n+\n+void\n+good_expr (int *p)\n+{\n+  __builtin_prefetch (p, 1 - 1, 6 - (2 * 3));\n+  __builtin_prefetch (p, 1 + 0, 1 + 2);\n+}\n+\n+int\n+main ()\n+{\n+  good_const (arr);\n+  good_enum (arr);\n+  good_expr (arr);\n+  exit (0);\n+}"}]}