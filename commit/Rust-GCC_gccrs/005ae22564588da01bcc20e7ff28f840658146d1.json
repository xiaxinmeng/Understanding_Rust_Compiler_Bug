{"sha": "005ae22564588da01bcc20e7ff28f840658146d1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDA1YWUyMjU2NDU4OGRhMDFiY2MyMGU3ZmYyOGY4NDA2NTgxNDZkMQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-08-07T09:55:42Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-08-07T09:55:42Z"}, "message": "[multiple changes]\n\n2009-08-07  Robert Dewar  <dewar@adacore.com>\n\n\t* sem_warn.adb (Warn_On_Unreferenced_Entity): Fix obvious typo.\n\n2009-08-07  Vincent Celier  <celier@adacore.com>\n\n\t* gnatcmd.adb (GNATCmd): If -U is not used, one and only one main is\n\tspecified on the command line and there are switches in the Compiler\n\tpackage of the project file, use these compilation switches to invoke\n\tthe tool.\n\n2009-08-07  Ben Brosgol  <brosgol@adacore.com>\n\n\t* gnat_ugn.texi: Wordsmithing edits at beginning of gnatcheck chapter.\n\n2009-08-07  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch10.adb (Analyze_Proper_Body): Indicate name of missing subunit\n\teven if not in main unit, to simplify debugging.\n\n2009-08-07  Arnaud Charlet  <charlet@adacore.com>\n\n\t* gcc-interface/Makefile.in: Fix handling of GCC_FOR_TARGET.\n\t* gcc-interface/Make-lang.in: Update dependencies.\n\nFrom-SVN: r150564", "tree": {"sha": "0a75069c46e75f42beca5f83a24b6caceb4197a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0a75069c46e75f42beca5f83a24b6caceb4197a7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/005ae22564588da01bcc20e7ff28f840658146d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/005ae22564588da01bcc20e7ff28f840658146d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/005ae22564588da01bcc20e7ff28f840658146d1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/005ae22564588da01bcc20e7ff28f840658146d1/comments", "author": null, "committer": null, "parents": [{"sha": "fb25a60d960ea0b6edf4c17ecf2e4aaf23aefe72", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb25a60d960ea0b6edf4c17ecf2e4aaf23aefe72", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb25a60d960ea0b6edf4c17ecf2e4aaf23aefe72"}], "stats": {"total": 333, "additions": 203, "deletions": 130}, "files": [{"sha": "0a1e0e20d026bd3144243018045950ddb9e43dc8", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=005ae22564588da01bcc20e7ff28f840658146d1", "patch": "@@ -1,3 +1,28 @@\n+2009-08-07  Robert Dewar  <dewar@adacore.com>\n+\n+\t* sem_warn.adb (Warn_On_Unreferenced_Entity): Fix obvious typo.\n+\n+2009-08-07  Vincent Celier  <celier@adacore.com>\n+\n+\t* gnatcmd.adb (GNATCmd): If -U is not used, one and only one main is\n+\tspecified on the command line and there are switches in the Compiler\n+\tpackage of the project file, use these compilation switches to invoke\n+\tthe tool.\n+\n+2009-08-07  Ben Brosgol  <brosgol@adacore.com>\n+\n+\t* gnat_ugn.texi: Wordsmithing edits at beginning of gnatcheck chapter.\n+\n+2009-08-07  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch10.adb (Analyze_Proper_Body): Indicate name of missing subunit\n+\teven if not in main unit, to simplify debugging.\n+\n+2009-08-07  Arnaud Charlet  <charlet@adacore.com>\n+\n+\t* gcc-interface/Makefile.in: Fix handling of GCC_FOR_TARGET.\n+\t* gcc-interface/Make-lang.in: Update dependencies.\n+\n 2009-08-07  Robert Dewar  <dewar@adacore.com>\n \n \t* types.ads: Minor reformatting"}, {"sha": "eec47d4c009df54b9fabdd120909b00b0c3372fd", "filename": "gcc/ada/gcc-interface/Make-lang.in", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgcc-interface%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgcc-interface%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMake-lang.in?ref=005ae22564588da01bcc20e7ff28f840658146d1", "patch": "@@ -3235,17 +3235,18 @@ ada/sem_ch13.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/nlists.adb ada/nmake.ads ada/nmake.adb ada/opt.ads ada/output.ads \\\n    ada/restrict.ads ada/rident.ads ada/rtsfind.ads ada/rtsfind.adb \\\n    ada/sem.ads ada/sem_aux.ads ada/sem_ch13.ads ada/sem_ch13.adb \\\n-   ada/sem_ch7.ads ada/sem_ch8.ads ada/sem_dist.ads ada/sem_eval.ads \\\n-   ada/sem_res.ads ada/sem_type.ads ada/sem_util.ads ada/sem_warn.ads \\\n-   ada/sinfo.ads ada/sinfo.adb ada/sinput.ads ada/snames.ads ada/stand.ads \\\n-   ada/stringt.ads ada/system.ads ada/s-exctab.ads ada/s-htable.ads \\\n-   ada/s-imenne.ads ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads \\\n-   ada/s-rident.ads ada/s-soflin.ads ada/s-stache.ads ada/s-stalib.ads \\\n-   ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads \\\n-   ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads ada/table.adb \\\n-   ada/targparm.ads ada/tbuild.ads ada/tbuild.adb ada/tree_io.ads \\\n-   ada/ttypes.ads ada/types.ads ada/uintp.ads ada/uintp.adb ada/uname.ads \\\n-   ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads ada/urealp.adb \n+   ada/sem_ch3.ads ada/sem_ch7.ads ada/sem_ch8.ads ada/sem_dist.ads \\\n+   ada/sem_eval.ads ada/sem_res.ads ada/sem_type.ads ada/sem_util.ads \\\n+   ada/sem_warn.ads ada/sinfo.ads ada/sinfo.adb ada/sinput.ads \\\n+   ada/snames.ads ada/stand.ads ada/stringt.ads ada/system.ads \\\n+   ada/s-exctab.ads ada/s-htable.ads ada/s-imenne.ads ada/s-memory.ads \\\n+   ada/s-os_lib.ads ada/s-parame.ads ada/s-rident.ads ada/s-soflin.ads \\\n+   ada/s-stache.ads ada/s-stalib.ads ada/s-stoele.ads ada/s-stoele.adb \\\n+   ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads \\\n+   ada/table.ads ada/table.adb ada/targparm.ads ada/tbuild.ads \\\n+   ada/tbuild.adb ada/tree_io.ads ada/ttypes.ads ada/types.ads \\\n+   ada/uintp.ads ada/uintp.adb ada/uname.ads ada/unchconv.ads \\\n+   ada/unchdeal.ads ada/urealp.ads ada/urealp.adb \n \n ada/sem_ch2.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/atree.ads ada/atree.adb \\"}, {"sha": "d454a5faead7953d46b5985c48bb766a3d9b6c70", "filename": "gcc/ada/gcc-interface/Makefile.in", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMakefile.in?ref=005ae22564588da01bcc20e7ff28f840658146d1", "patch": "@@ -2349,15 +2349,15 @@ install-gnatlib: ../stamp-gnatlib-$(RTSDIR)\n gnatlib: ../stamp-gnatlib1-$(RTSDIR) ../stamp-gnatlib2-$(RTSDIR)\n \t$(MAKE) -C $(RTSDIR) \\\n \t\tCC=\"`echo \\\"$(GCC_FOR_TARGET)\\\" \\\n-\t\t| sed -e 's,^\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'`\" \\\n+\t\t| sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'`\" \\\n \t        INCLUDES=\"$(INCLUDES_FOR_SUBDIR) -I./../..\" \\\n                 CFLAGS=\"$(GNATLIBCFLAGS_FOR_C)\" \\\n \t        FORCE_DEBUG_ADAFLAGS=\"$(FORCE_DEBUG_ADAFLAGS)\" \\\n \t\tsrcdir=$(fsrcdir) \\\n \t        -f ../Makefile $(LIBGNAT_OBJS)\n \t$(MAKE) -C $(RTSDIR) \\\n \t\tCC=\"`echo \\\"$(GCC_FOR_TARGET)\\\" \\\n-\t\t| sed -e 's,^\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'`\" \\\n+\t\t| sed -e 's,\\./xgcc,../../xgcc,' -e 's,-B\\./,-B../../,'`\" \\\n \t        ADA_INCLUDES=\"\" \\\n                 CFLAGS=\"$(GNATLIBCFLAGS)\" \\\n \t        ADAFLAGS=\"$(GNATLIBFLAGS)\" \\"}, {"sha": "698162201637d034a58072c1abbd576b233540ae", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 54, "deletions": 39, "changes": 93, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=005ae22564588da01bcc20e7ff28f840658146d1", "patch": "@@ -20689,7 +20689,8 @@ rules to be checked by @command{gnatcheck} (@pxref{gnatcheck Rule Options}).\n @end itemize\n \n @noindent\n-Either a @file{@var{filename}} or an @file{@var{arg_list_filename}} must be supplied.\n+Either a @file{@var{filename}} or an @file{@var{arg_list_filename}} must be\n+supplied.\n \n @menu\n * Format of the Report File::\n@@ -20709,18 +20710,18 @@ Either a @file{@var{filename}} or an @file{@var{arg_list_filename}} must be supp\n The @command{gnatcheck} tool outputs on @file{stdout} all messages concerning\n rule violations.\n It also creates a text file  that\n-contains the complete report of the last gnatcheck run. By default this file is\n-named named @file{^gnatcheck.out^GNATCHECK.OUT^} and it is located in the current\n-directory, @option{^-o^/OUTPUT^} option can be used to change the name and/or\n-location of the report file. This report contains:\n+contains the complete report of the last gnatcheck run. By default this file\n+is named named @file{^gnatcheck.out^GNATCHECK.OUT^} and it is located in the\n+current directory; the @option{^-o^/OUTPUT^} option can be used to change the\n+name and/or location of the report file. This report contains:\n @itemize @bullet\n @item date and time of @command{gnatcheck} run, the version of\n-the tool that has generated this report and the full paarmeters\n+the tool that has generated this report and the full parameters\n of the  @command{gnatcheck} invocation;\n-@item the list of enabled rules;\n-@item the total number of detected violations;\n-@item list of source files for that rule violations have been detected;\n-@item list of source files with no violations detected;\n+@item list of enabled rules;\n+@item total number of detected violations;\n+@item list of source files where rule violations have been detected;\n+@item list of source files where no violations have been detected.\n @end itemize\n \n @node General gnatcheck Switches\n@@ -20734,7 +20735,7 @@ The following switches control the general @command{gnatcheck} behavior\n @cindex @option{^-a^/ALL^} (@command{gnatcheck})\n @item ^-a^/ALL^\n Process all units including those with read-only ALI files such as\n-those from GNAT Run-Time library.\n+those from the GNAT Run-Time library.\n \n @ifclear vms\n @ignore\n@@ -20745,7 +20746,7 @@ Debug mode\n \n @cindex @option{-dd} (@command{gnatcheck})\n @item -dd\n-Progress indicator mode (for use in GPS)\n+Progress indicator mode (for use in GPS).\n @end ifclear\n \n @cindex @option{^-h^/HELP^} (@command{gnatcheck})\n@@ -20762,19 +20763,20 @@ instantiated.\n \n @cindex @option{^-log^/LOG^} (@command{gnatcheck})\n @item ^-log^/LOG^\n-Duplicate all the output sent to Stderr into a log file. The log file is\n-named @var{gnatcheck.log} and is located in the current directory.\n+Duplicate all the output sent to @file{stderr} into a log file. The log file\n+is named @file{gnatcheck.log} and is located in the current directory.\n \n @cindex @option{^-m^/DIAGNOSTIC_LIMIT^} (@command{gnatcheck})\n-@item ^-m@i{nnn}^/DIAGNOSTIC_LIMIT=@i{nnn}^\n-Maximum number of diagnoses to be sent to Stdout, @i{nnn} from o@dots{}1000,\n+@item ^-m@i{nnnn}^/DIAGNOSTIC_LIMIT=@i{nnnn}^\n+Maximum number of diagnostics to be sent to @file{stdout}, where @i{nnnn} is in\n+the range 0@dots{}1000;\n the default value is 500. Zero means that there is no limitation on\n-the number of diagnostic messages to be printed into Stdout.\n+the number of diagnostic messages to be output.\n \n @cindex @option{^-q^/QUIET^} (@command{gnatcheck})\n @item ^-q^/QUIET^\n-Quiet mode. All the diagnoses about rule violations are placed in the\n-@command{gnatcheck} report file only, without duplicating in @file{stdout}.\n+Quiet mode. All the diagnostics about rule violations are placed in the\n+@command{gnatcheck} report file only, without duplication on @file{stdout}.\n \n @cindex @option{^-s^/SHORT^} (@command{gnatcheck})\n @item ^-s^/SHORT^\n@@ -20787,11 +20789,11 @@ Include the compiler-style section in the report file\n \n @cindex @option{^-s2^/BY_RULES^} (@command{gnatcheck})\n @item ^-s2^/BY_RULES^\n-Include the section containing diagnoses ordered by rules in the report file\n+Include the section containing diagnostics ordered by rules in the report file\n \n @cindex @option{^-s3^/BY_FILES_BY_RULES^} (@command{gnatcheck})\n @item ^-s3^/BY_FILES_BY_RULES^\n-Include the section containing diagnoses ordered by files and then by rules\n+Include the section containing diagnostics ordered by files and then by rules\n in the report file\n \n @cindex @option{^-t^/TIME^} (@command{gnatcheck})\n@@ -20884,30 +20886,43 @@ the following rule identifiers and parameters:\n \n @table @option\n @item Restrictions\n-To record restrictions violations (that are performed by the compiler if the\n+To record restrictions violations (which are performed by the compiler if the\n pragma @code{Restrictions} or @code{Restriction_Warnings} are given),\n-use the rule named\n-@code{Restrictions} with the same parameters as pragma\n+use the @code{Restrictions} rule\n+with the same parameters as pragma\n @code{Restrictions} or @code{Restriction_Warnings}.\n \n @item Style_Checks\n-To record compiler style checks(@pxref{Style Checking}), use the rule named\n-@code{Style_Checks}. A parameter of this rule can be either @code{All_Checks},\n-which enables all the standard style checks that corresponds to @option{-gnatyy}\n-GNAT style check option, or a string that has exactly the same\n-structure and semantics as the @code{string_LITERAL} parameter of GNAT pragma\n-@code{Style_Checks} (for further information about this pragma,\n-@pxref{Pragma Style_Checks,,, gnat_rm, GNAT Reference Manual}). For example,\n-@code{+RStyle_Checks:O} rule option activates and adds to @command{gnatcheck}\n-output the compiler style check that corresponds to\n+To record compiler style checks (@pxref{Style Checking}), use the\n+@code{Style_Checks} rule.\n+This rule takes a parameter in one of the following forms:\n+@itemize\n+@item\n+@code{All_Checks},\n+which enables the standard style checks corresponding to the @option{-gnatyy}\n+GNAT style check option, or\n+\n+@item\n+a string with the same\n+structure and semantics as the @code{string_LITERAL} parameter of the\n+GNAT pragma @code{Style_Checks}\n+(for further information about this pragma,\n+@pxref{Pragma Style_Checks,,, gnat_rm, GNAT Reference Manual}).\n+@end itemize\n+\n+@noindent\n+For example, the\n+@code{+RStyle_Checks:O} rule option activates\n+the compiler style check that corresponds to\n @code{-gnatyO} style check option.\n \n @item Warnings\n-To record compiler warnings (@pxref{Warning Message Control}), use the rule\n-named @code{Warnings} with a parameter that is a valid\n-@i{static_string_expression} argument of GNAT pragma @code{Warnings}\n-(for further information about this pragma, @pxref{Pragma Warnings,,,\n-gnat_rm, GNAT Reference Manual}). Note, that in case of gnatcheck\n+To record compiler warnings (@pxref{Warning Message Control}), use the\n+@code{Warnings} rule with a parameter that is a valid\n+@i{static_string_expression} argument of the GNAT pragma @code{Warnings}\n+(for further information about this pragma,\n+@pxref{Pragma Warnings,,,gnat_rm, GNAT Reference Manual}).\n+Note that in case of gnatcheck\n 's' parameter, that corresponds to the GNAT @option{-gnatws} option, disables\n all the specific warnings, but not suppresses the warning mode,\n and 'e' parameter, corresponding to @option{-gnatwe} that means\n@@ -20999,7 +21014,7 @@ pragma Annotate (gnatcheck, @i{exemption_control}, @i{Rule_Name}, [@i{justificat\n @end smallexample\n \n @noindent\n-When a @command{gnatcheck} annotatation has more then four arguments,\n+When a @command{gnatcheck} annotation has more then four arguments,\n @command{gnatcheck} issues a warning and ignores the additional arguments.\n If the additional arguments do not follow the syntax above,\n @command{gnatcheck} emits a warning and ignores the annotation."}, {"sha": "42d08dcd48feeea076b8e72df2a94be977cbb5e2", "filename": "gcc/ada/gnatcmd.adb", "status": "modified", "additions": 106, "deletions": 76, "changes": 182, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgnatcmd.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fgnatcmd.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatcmd.adb?ref=005ae22564588da01bcc20e7ff28f840658146d1", "patch": "@@ -1308,10 +1308,8 @@ begin\n                                    Normalize_Pathname\n                                      (Command (Command'First .. Index));\n \n-                  PATH         : constant String :=\n-                                   Absolute_Dir &\n-                  Path_Separator &\n-                  Getenv (\"PATH\").all;\n+                  PATH : constant String :=\n+                           Absolute_Dir & Path_Separator & Getenv (\"PATH\").all;\n \n                begin\n                   Setenv (\"PATH\", PATH);\n@@ -1460,6 +1458,7 @@ begin\n \n    begin\n       if The_Command = Stack then\n+\n          --  Never call gnatstack with a prefix\n \n          Program := new String'(Command_List (The_Command).Unixcmd.all);\n@@ -1488,68 +1487,56 @@ begin\n          end loop;\n       end if;\n \n-      --  For BIND, CHECK, ELIM, FIND, LINK, LIST, PRETTY, STACK, STUB,\n-      --  METRIC ad  XREF, look for project file related switches.\n-\n-      if The_Command = Bind\n-        or else The_Command = Check\n-        or else The_Command = Sync\n-        or else The_Command = Elim\n-        or else The_Command = Find\n-        or else The_Command = Link\n-        or else The_Command = List\n-        or else The_Command = Xref\n-        or else The_Command = Pretty\n-        or else The_Command = Stack\n-        or else The_Command = Stub\n-        or else The_Command = Metric\n-      then\n-         case The_Command is\n-            when Bind =>\n-               Tool_Package_Name := Name_Binder;\n-               Packages_To_Check := Packages_To_Check_By_Binder;\n-            when Check =>\n-               Tool_Package_Name := Name_Check;\n-               Packages_To_Check := Packages_To_Check_By_Check;\n-            when Sync =>\n-               Tool_Package_Name := Name_Synchronize;\n-               Packages_To_Check := Packages_To_Check_By_Sync;\n-            when Elim =>\n-               Tool_Package_Name := Name_Eliminate;\n-               Packages_To_Check := Packages_To_Check_By_Eliminate;\n-            when Find =>\n-               Tool_Package_Name := Name_Finder;\n-               Packages_To_Check := Packages_To_Check_By_Finder;\n-            when Link =>\n-               Tool_Package_Name := Name_Linker;\n-               Packages_To_Check := Packages_To_Check_By_Linker;\n-            when List =>\n-               Tool_Package_Name := Name_Gnatls;\n-               Packages_To_Check := Packages_To_Check_By_Gnatls;\n-            when Metric =>\n-               Tool_Package_Name := Name_Metrics;\n-               Packages_To_Check := Packages_To_Check_By_Metric;\n-            when Pretty =>\n-               Tool_Package_Name := Name_Pretty_Printer;\n-               Packages_To_Check := Packages_To_Check_By_Pretty;\n-            when Stack =>\n-               Tool_Package_Name := Name_Stack;\n-               Packages_To_Check := Packages_To_Check_By_Stack;\n-            when Stub =>\n-               Tool_Package_Name := Name_Gnatstub;\n-               Packages_To_Check := Packages_To_Check_By_Gnatstub;\n-            when Xref =>\n-               Tool_Package_Name := Name_Cross_Reference;\n-               Packages_To_Check := Packages_To_Check_By_Xref;\n-            when others =>\n-               null;\n-         end case;\n+      --  For BIND, CHECK, ELIM, FIND, LINK, LIST, METRIC, PRETTY, STACK, STUB,\n+      --  SYNC and XREF, look for project file related switches.\n+\n+      case The_Command is\n+         when Bind =>\n+            Tool_Package_Name := Name_Binder;\n+            Packages_To_Check := Packages_To_Check_By_Binder;\n+         when Check =>\n+            Tool_Package_Name := Name_Check;\n+            Packages_To_Check := Packages_To_Check_By_Check;\n+         when Elim =>\n+            Tool_Package_Name := Name_Eliminate;\n+            Packages_To_Check := Packages_To_Check_By_Eliminate;\n+         when Find =>\n+            Tool_Package_Name := Name_Finder;\n+            Packages_To_Check := Packages_To_Check_By_Finder;\n+         when Link =>\n+            Tool_Package_Name := Name_Linker;\n+            Packages_To_Check := Packages_To_Check_By_Linker;\n+         when List =>\n+            Tool_Package_Name := Name_Gnatls;\n+            Packages_To_Check := Packages_To_Check_By_Gnatls;\n+         when Metric =>\n+            Tool_Package_Name := Name_Metrics;\n+            Packages_To_Check := Packages_To_Check_By_Metric;\n+         when Pretty =>\n+            Tool_Package_Name := Name_Pretty_Printer;\n+            Packages_To_Check := Packages_To_Check_By_Pretty;\n+         when Stack =>\n+            Tool_Package_Name := Name_Stack;\n+            Packages_To_Check := Packages_To_Check_By_Stack;\n+         when Stub =>\n+            Tool_Package_Name := Name_Gnatstub;\n+            Packages_To_Check := Packages_To_Check_By_Gnatstub;\n+         when Sync =>\n+            Tool_Package_Name := Name_Synchronize;\n+            Packages_To_Check := Packages_To_Check_By_Sync;\n+         when Xref =>\n+            Tool_Package_Name := Name_Cross_Reference;\n+            Packages_To_Check := Packages_To_Check_By_Xref;\n+         when others =>\n+            Tool_Package_Name := No_Name;\n+      end case;\n+\n+      if Tool_Package_Name /= No_Name then\n \n          --  Check that the switches are consistent. Detect project file\n          --  related switches.\n \n-         Inspect_Switches :\n-         declare\n+         Inspect_Switches : declare\n             Arg_Num : Positive := 1;\n             Argv    : String_Access;\n \n@@ -1909,29 +1896,72 @@ begin\n \n                Element : Package_Element;\n \n-               Default_Switches_Array : Array_Element_Id;\n+               Switches_Array : Array_Element_Id;\n \n                The_Switches : Prj.Variable_Value;\n                Current      : Prj.String_List_Id;\n                The_String   : String_Element;\n \n+               Main    : String_Access := null;\n+               Main_Id : Name_Id;\n+\n             begin\n                if Pkg /= No_Package then\n+\n+                  --  First, check if there is a single main specified.\n+\n+                  for J in 1  .. Last_Switches.Last loop\n+                     if Last_Switches.Table (J) (1) /= '-' then\n+                        if Main = null then\n+                           Main := Last_Switches.Table (J);\n+\n+                        else\n+                           Main := null;\n+                           exit;\n+                        end if;\n+                     end if;\n+                  end loop;\n+\n                   Element := Project_Tree.Packages.Table (Pkg);\n \n-                  Default_Switches_Array :=\n-                    Prj.Util.Value_Of\n-                      (Name      => Name_Default_Switches,\n-                       In_Arrays => Element.Decl.Arrays,\n-                       In_Tree   => Project_Tree);\n-                  The_Switches := Prj.Util.Value_Of\n-                    (Index     => Name_Ada,\n-                     Src_Index => 0,\n-                     In_Array  => Default_Switches_Array,\n-                     In_Tree   => Project_Tree);\n-\n-                  --  If there are switches specified in the package of the\n-                  --  project file corresponding to the tool, scan them.\n+                  --  If there is a single main and there is compilation\n+                  --  switches specified in the project file, use them.\n+\n+                  if Main /= null and then not All_Projects then\n+                     Name_Len := Main'Length;\n+                     Name_Buffer (1 .. Name_Len) := Main.all;\n+                     Canonical_Case_File_Name (Name_Buffer (1 .. Name_Len));\n+                     Main_Id := Name_Find;\n+\n+                     Switches_Array :=\n+                       Prj.Util.Value_Of\n+                         (Name      => Name_Switches,\n+                          In_Arrays => Element.Decl.Arrays,\n+                          In_Tree   => Project_Tree);\n+                     The_Switches := Prj.Util.Value_Of\n+                       (Index     => Main_Id,\n+                        Src_Index => 0,\n+                        In_Array  => Switches_Array,\n+                        In_Tree   => Project_Tree);\n+                  end if;\n+\n+                  --  Otherwise, get the Default_Switches (\"Ada\")\n+\n+                  if The_Switches.Kind = Undefined then\n+                     Switches_Array :=\n+                       Prj.Util.Value_Of\n+                         (Name      => Name_Default_Switches,\n+                          In_Arrays => Element.Decl.Arrays,\n+                          In_Tree   => Project_Tree);\n+                     The_Switches := Prj.Util.Value_Of\n+                       (Index     => Name_Ada,\n+                        Src_Index => 0,\n+                        In_Array  => Switches_Array,\n+                        In_Tree   => Project_Tree);\n+                  end if;\n+\n+                  --  If there are switches specified, put them in the\n+                  --  Carg_Switches table.\n \n                   case The_Switches.Kind is\n                      when Prj.Undefined =>"}, {"sha": "170f261a36e2b4521e3083b37554649e5fd3b6ea", "filename": "gcc/ada/sem_ch10.adb", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fsem_ch10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fsem_ch10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch10.adb?ref=005ae22564588da01bcc20e7ff28f840658146d1", "patch": "@@ -1747,6 +1747,8 @@ package body Sem_Ch10 is\n                  Error_Node => N);\n \n             --  Give message if we did not get the unit\n+            --  Emit warning even if missing subunit is not\n+            --  within main unit, to simplify debugging.\n \n             if Original_Operating_Mode = Generate_Code\n               and then Unum = No_Unit\n@@ -1755,7 +1757,7 @@ package body Sem_Ch10 is\n                Error_Msg_File_1 :=\n                  Get_File_Name (Subunit_Name, Subunit => True);\n                Error_Msg_N\n-                 (\"subunit$$ in file{ not found?\", N);\n+                 (\"subunit$$ in file{ not found?!!\", N);\n                Subunits_Missing := True;\n             end if;\n "}, {"sha": "407171f1d7b4266ed248530d76e5ade39c8d1141", "filename": "gcc/ada/sem_warn.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fsem_warn.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005ae22564588da01bcc20e7ff28f840658146d1/gcc%2Fada%2Fsem_warn.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_warn.adb?ref=005ae22564588da01bcc20e7ff28f840658146d1", "patch": "@@ -3966,7 +3966,7 @@ package body Sem_Warn is\n \n                   if Ekind (E) = E_In_Parameter\n                     or else not Referenced_As_LHS_Check_Spec (E)\n-                    or else Is_Scalar_Type (E)\n+                    or else Is_Scalar_Type (Etype (E))\n                   then\n                      if Present (Body_E) then\n                         E := Body_E;"}]}