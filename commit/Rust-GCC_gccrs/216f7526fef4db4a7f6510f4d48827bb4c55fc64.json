{"sha": "216f7526fef4db4a7f6510f4d48827bb4c55fc64", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjE2Zjc1MjZmZWY0ZGI0YTdmNjUxMGY0ZDQ4ODI3YmI0YzU1ZmM2NA==", "commit": {"author": {"name": "Tim Shen", "email": "timshen@google.com", "date": "2016-04-23T03:58:37Z"}, "committer": {"name": "Tim Shen", "email": "timshen@gcc.gnu.org", "date": "2016-04-23T03:58:37Z"}, "message": "re PR libstdc++/70745 (Wrong handling of regex_constant::match_not_eow and regex_constant::match_not_bow)\n\n\tPR libstdc++/70745\n\t* include/bits/regex_executor.tcc (_Executor<>::_M_word_boundary):\n\tFix the match_not_bow and match_not_eow behavior.\n\t* testsuite/28_regex/regression.cc: Add testcase.\n\nFrom-SVN: r235382", "tree": {"sha": "6ff3a147d66e5120aa632460f7333ace19ca6a52", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6ff3a147d66e5120aa632460f7333ace19ca6a52"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/216f7526fef4db4a7f6510f4d48827bb4c55fc64", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/216f7526fef4db4a7f6510f4d48827bb4c55fc64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/216f7526fef4db4a7f6510f4d48827bb4c55fc64", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/216f7526fef4db4a7f6510f4d48827bb4c55fc64/comments", "author": {"login": "timshen91", "id": 1157432, "node_id": "MDQ6VXNlcjExNTc0MzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1157432?v=4", "gravatar_id": "", "url": "https://api.github.com/users/timshen91", "html_url": "https://github.com/timshen91", "followers_url": "https://api.github.com/users/timshen91/followers", "following_url": "https://api.github.com/users/timshen91/following{/other_user}", "gists_url": "https://api.github.com/users/timshen91/gists{/gist_id}", "starred_url": "https://api.github.com/users/timshen91/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/timshen91/subscriptions", "organizations_url": "https://api.github.com/users/timshen91/orgs", "repos_url": "https://api.github.com/users/timshen91/repos", "events_url": "https://api.github.com/users/timshen91/events{/privacy}", "received_events_url": "https://api.github.com/users/timshen91/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ab0fc037f01de923b69f3c72c717af680ac6066f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab0fc037f01de923b69f3c72c717af680ac6066f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab0fc037f01de923b69f3c72c717af680ac6066f"}], "stats": {"total": 36, "additions": 28, "deletions": 8}, "files": [{"sha": "386e83285285245641a7f6bdb189fb8aaf600904", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/216f7526fef4db4a7f6510f4d48827bb4c55fc64/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/216f7526fef4db4a7f6510f4d48827bb4c55fc64/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=216f7526fef4db4a7f6510f4d48827bb4c55fc64", "patch": "@@ -1,3 +1,10 @@\n+2016-04-22  Tim Shen  <timshen@google.com>\n+\n+\tPR libstdc++/70745\n+\t* include/bits/regex_executor.tcc (_Executor<>::_M_word_boundary):\n+\tFix the match_not_bow and match_not_eow behavior.\n+\t* testsuite/28_regex/regression.cc: Add testcase.\n+\n 2016-04-20  Jonathan Wakely  <jwakely@redhat.com>\n \n \tPR libstdc++/69703"}, {"sha": "6bbcb1b4977d1df26a26d1d1ecce5b81c98e6095", "filename": "libstdc++-v3/include/bits/regex_executor.tcc", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/216f7526fef4db4a7f6510f4d48827bb4c55fc64/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex_executor.tcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/216f7526fef4db4a7f6510f4d48827bb4c55fc64/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex_executor.tcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fregex_executor.tcc?ref=216f7526fef4db4a7f6510f4d48827bb4c55fc64", "patch": "@@ -413,6 +413,11 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     bool _Executor<_BiIter, _Alloc, _TraitsT, __dfs_mode>::\n     _M_word_boundary() const\n     {\n+      if (_M_current == _M_begin && (_M_flags & regex_constants::match_not_bow))\n+\treturn false;\n+      if (_M_current == _M_end && (_M_flags & regex_constants::match_not_eow))\n+\treturn false;\n+\n       bool __left_is_word = false;\n       if (_M_current != _M_begin\n \t  || (_M_flags & regex_constants::match_prev_avail))\n@@ -424,13 +429,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       bool __right_is_word =\n         _M_current != _M_end && _M_is_word(*_M_current);\n \n-      if (__left_is_word == __right_is_word)\n-\treturn false;\n-      if (__left_is_word && !(_M_flags & regex_constants::match_not_eow))\n-\treturn true;\n-      if (__right_is_word && !(_M_flags & regex_constants::match_not_bow))\n-\treturn true;\n-      return false;\n+      return __left_is_word != __right_is_word;\n     }\n \n _GLIBCXX_END_NAMESPACE_VERSION"}, {"sha": "d367c8becc1e3c89b0c031af36ff9ea7d090ced4", "filename": "libstdc++-v3/testsuite/28_regex/regression.cc", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/216f7526fef4db4a7f6510f4d48827bb4c55fc64/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Fregression.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/216f7526fef4db4a7f6510f4d48827bb4c55fc64/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Fregression.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F28_regex%2Fregression.cc?ref=216f7526fef4db4a7f6510f4d48827bb4c55fc64", "patch": "@@ -45,14 +45,28 @@ test02()\n       \"/ghci\"\n     };\n   auto rx = std::regex(re_str, std::regex_constants::grep | std::regex_constants::icase);\n-  VERIFY(std::regex_search(\"/abcd\", rx));\n+  VERIFY(regex_search_debug(\"/abcd\", rx));\n+}\n+\n+void\n+test03()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  VERIFY(regex_match_debug(\"a.\", regex(R\"(a\\b.)\"), regex_constants::match_not_eow));\n+  VERIFY(regex_match_debug(\".a\", regex(R\"(.\\ba)\"), regex_constants::match_not_bow));\n+  VERIFY(regex_search_debug(\"a\", regex(R\"(^\\b)\")));\n+  VERIFY(regex_search_debug(\"a\", regex(R\"(\\b$)\")));\n+  VERIFY(!regex_search_debug(\"a\", regex(R\"(^\\b)\"), regex_constants::match_not_bow));\n+  VERIFY(!regex_search_debug(\"a\", regex(R\"(\\b$)\"), regex_constants::match_not_eow));\n }\n \n int\n main()\n {\n   test01();\n   test02();\n+  test03();\n   return 0;\n }\n "}]}