{"sha": "b11e7db7139c3e231d49611b9f0415d6f1333a69", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjExZTdkYjcxMzljM2UyMzFkNDk2MTFiOWYwNDE1ZDZmMTMzM2E2OQ==", "commit": {"author": {"name": "Ilya Verbin", "email": "ilya.verbin@intel.com", "date": "2015-09-07T15:25:43Z"}, "committer": {"name": "Ilya Verbin", "email": "iverbin@gcc.gnu.org", "date": "2015-09-07T15:25:43Z"}, "message": "intelmic-mkoffload.c (prepare_target_image): Handle all non-alphanumeric characters in the symbol name.\n\n\t* config/i386/intelmic-mkoffload.c (prepare_target_image): Handle all\n\tnon-alphanumeric characters in the symbol name.\n\nFrom-SVN: r227522", "tree": {"sha": "94692aee07d881debefcc1beaa65f0f50b7da793", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/94692aee07d881debefcc1beaa65f0f50b7da793"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b11e7db7139c3e231d49611b9f0415d6f1333a69", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b11e7db7139c3e231d49611b9f0415d6f1333a69", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b11e7db7139c3e231d49611b9f0415d6f1333a69", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b11e7db7139c3e231d49611b9f0415d6f1333a69/comments", "author": null, "committer": null, "parents": [{"sha": "12dee005f7e2d806f06657bca3dcc82f18a3224d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/12dee005f7e2d806f06657bca3dcc82f18a3224d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/12dee005f7e2d806f06657bca3dcc82f18a3224d"}], "stats": {"total": 14, "additions": 10, "deletions": 4}, "files": [{"sha": "62953292d0a82673a823735a9fc405d801ee8ad8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b11e7db7139c3e231d49611b9f0415d6f1333a69/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b11e7db7139c3e231d49611b9f0415d6f1333a69/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b11e7db7139c3e231d49611b9f0415d6f1333a69", "patch": "@@ -1,3 +1,8 @@\n+2015-09-07  Ilya Verbin  <ilya.verbin@intel.com>\n+\n+\t* config/i386/intelmic-mkoffload.c (prepare_target_image): Handle all\n+\tnon-alphanumeric characters in the symbol name.\n+\n 2015-09-07  Marek Polacek  <polacek@redhat.com>\n \n \tPR inline-asm/67448"}, {"sha": "4a7812c2499b4be33c881c70484dd2dfc095ba58", "filename": "gcc/config/i386/intelmic-mkoffload.c", "status": "modified", "additions": 5, "deletions": 4, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b11e7db7139c3e231d49611b9f0415d6f1333a69/gcc%2Fconfig%2Fi386%2Fintelmic-mkoffload.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b11e7db7139c3e231d49611b9f0415d6f1333a69/gcc%2Fconfig%2Fi386%2Fintelmic-mkoffload.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fintelmic-mkoffload.c?ref=b11e7db7139c3e231d49611b9f0415d6f1333a69", "patch": "@@ -453,17 +453,18 @@ prepare_target_image (const char *target_compiler, int argc, char **argv)\n   fork_execute (objcopy_argv[0], CONST_CAST (char **, objcopy_argv), false);\n \n   /* Objcopy has created symbols, containing the input file name with\n-     special characters replaced with '_'.  We are going to rename these\n-     new symbols.  */\n+     non-alphanumeric characters replaced by underscores.\n+     We are going to rename these new symbols.  */\n   size_t symbol_name_len = strlen (target_so_filename);\n   char *symbol_name = XALLOCAVEC (char, symbol_name_len + 1);\n-  for (size_t i = 0; i <= symbol_name_len; i++)\n+  for (size_t i = 0; i < symbol_name_len; i++)\n     {\n       char c = target_so_filename[i];\n-      if (c == '/' || c == '.' || c == '-')\n+      if (!ISALNUM (c))\n \tc = '_';\n       symbol_name[i] = c;\n     }\n+  symbol_name[symbol_name_len] = '\\0';\n \n   char *opt_for_objcopy[3];\n   opt_for_objcopy[0] = XALLOCAVEC (char, sizeof (\"_binary__start=\")"}]}