{"sha": "a7f36da37989019104e199ab78826bd929142818", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTdmMzZkYTM3OTg5MDE5MTA0ZTE5OWFiNzg4MjZiZDkyOTE0MjgxOA==", "commit": {"author": {"name": "DJ Delorie", "email": "dj@gcc.gnu.org", "date": "2003-06-01T18:55:15Z"}, "committer": {"name": "DJ Delorie", "email": "dj@gcc.gnu.org", "date": "2003-06-01T18:55:15Z"}, "message": "cppmacro.c (warn_of_redefinition): Handle cases where the two definitions have different numbers of tokens.\n\n* cppmacro.c (warn_of_redefinition): Handle cases where the two\ndefinitions have different numbers of tokens.\n\n* gcc.dg/cpp/redef3.c: New file.\n\nFrom-SVN: r67307", "tree": {"sha": "96669031e3b9ecf83c0e0e0b4fabc2f49db66e77", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/96669031e3b9ecf83c0e0e0b4fabc2f49db66e77"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7f36da37989019104e199ab78826bd929142818", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7f36da37989019104e199ab78826bd929142818", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7f36da37989019104e199ab78826bd929142818", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7f36da37989019104e199ab78826bd929142818/comments", "author": null, "committer": null, "parents": [{"sha": "8e2b6930e1d797225311e8774079519ae0043fb8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e2b6930e1d797225311e8774079519ae0043fb8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e2b6930e1d797225311e8774079519ae0043fb8"}], "stats": {"total": 40, "additions": 36, "deletions": 4}, "files": [{"sha": "654e36df1d8a0143510222bab3e9ce6f2c68cec0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f36da37989019104e199ab78826bd929142818/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f36da37989019104e199ab78826bd929142818/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a7f36da37989019104e199ab78826bd929142818", "patch": "@@ -1,3 +1,8 @@\n+2003-05-29  DJ Delorie  <dj@redhat.com>\n+\n+\t* cppmacro.c (warn_of_redefinition): Handle cases where the two\n+\tdefinitions have different numbers of tokens.\n+\n 2003-06-01  Andreas Jaeger  <aj@suse.de>\n \n \t* gen-protos.c (main): Readd unused attribute for argc."}, {"sha": "eba8c0032a3ada313adcea21d81deb989f1b2ec5", "filename": "gcc/cppmacro.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f36da37989019104e199ab78826bd929142818/gcc%2Fcppmacro.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f36da37989019104e199ab78826bd929142818/gcc%2Fcppmacro.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppmacro.c?ref=a7f36da37989019104e199ab78826bd929142818", "patch": "@@ -1275,10 +1275,12 @@ warn_of_redefinition (pfile, node, macro2)\n   if (CPP_OPTION (pfile, traditional))\n     return _cpp_expansions_different_trad (macro1, macro2);\n \n-  if (macro1->count == macro2->count)\n-    for (i = 0; i < macro1->count; i++)\n-      if (!_cpp_equiv_tokens (&macro1->exp.tokens[i], &macro2->exp.tokens[i]))\n-\treturn true;\n+  if (macro1->count != macro2->count)\n+    return true;\n+\n+  for (i = 0; i < macro1->count; i++)\n+    if (!_cpp_equiv_tokens (&macro1->exp.tokens[i], &macro2->exp.tokens[i]))\n+      return true;\n \n   return false;\n }"}, {"sha": "ee9f802816c23a692f99bce415a0997c17acfa30", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f36da37989019104e199ab78826bd929142818/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f36da37989019104e199ab78826bd929142818/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a7f36da37989019104e199ab78826bd929142818", "patch": "@@ -1,3 +1,7 @@\n+2003-06-01  Loren James Rittle  <ljrittle@acm.org>\n+\t\n+\t* gcc.dg/cpp/redef3.c: New file.\n+\n 2003-06-01  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \t* gcc.dg/i386-loop-3.c: New test."}, {"sha": "78ee71e659840fc267fa34fde3b7ebef19b0faca", "filename": "gcc/testsuite/gcc.dg/cpp/redef3.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7f36da37989019104e199ab78826bd929142818/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fredef3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7f36da37989019104e199ab78826bd929142818/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fredef3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fredef3.c?ref=a7f36da37989019104e199ab78826bd929142818", "patch": "@@ -0,0 +1,21 @@\n+/* Test for redefining macros with mismatch token count (and the oddity). */\n+\n+/* { dg-do preprocess } */\n+/* { dg-options \"-DC -DD=1 -DE\" } */\n+\n+#define A\n+#define A 1\n+#define B 2 3\n+#define B 2\n+#define C 1\n+#define D 1 2\n+#define E\n+\n+/* { dg-warning \"redefined\" \"redef A\"      { target *-*-* } 7  }\n+   { dg-warning \"redefined\" \"redef B\"      { target *-*-* } 9  }\n+   { dg-warning \"redefined\" \"redef D\"      { target *-*-* } 11 }\n+   { dg-warning \"redefined\" \"redef E\"      { target *-*-* } 12 }\n+   { dg-warning \"previous\"  \"prev def A\"   { target *-*-* } 6  }\n+   { dg-warning \"previous\"  \"prev def B\"   { target *-*-* } 8  }\n+   { dg-warning \"previous\"  \"prev def D/E\" { target *-*-* } 0  }\n+*/"}]}