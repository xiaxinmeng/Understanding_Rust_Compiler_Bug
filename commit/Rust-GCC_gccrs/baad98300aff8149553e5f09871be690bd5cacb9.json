{"sha": "baad98300aff8149553e5f09871be690bd5cacb9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmFhZDk4MzAwYWZmODE0OTU1M2U1ZjA5ODcxYmU2OTBiZDVjYWNiOQ==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2012-12-05T11:03:15Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2012-12-05T11:03:15Z"}, "message": "exp_dist.adb (Build_From_Any_Call, [...]): For a used-defined subtype, always go to the first subtype of the base type.\n\n2012-12-05  Thomas Quinot  <quinot@adacore.com>\n\n\t* exp_dist.adb (Build_From_Any_Call, Build_To_Any_Call,\n\tBuild_TypeCode_Call): For a used-defined subtype, always go to\n\tthe first subtype of the base type.\n\nFrom-SVN: r194206", "tree": {"sha": "b14fe004d6cc3426f32393b6c0b492a0da95aaa1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b14fe004d6cc3426f32393b6c0b492a0da95aaa1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/baad98300aff8149553e5f09871be690bd5cacb9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/baad98300aff8149553e5f09871be690bd5cacb9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/baad98300aff8149553e5f09871be690bd5cacb9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/baad98300aff8149553e5f09871be690bd5cacb9/comments", "author": null, "committer": null, "parents": [{"sha": "0f4be535527b871d60daa51840e511cb66df6a9d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f4be535527b871d60daa51840e511cb66df6a9d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f4be535527b871d60daa51840e511cb66df6a9d"}], "stats": {"total": 36, "additions": 32, "deletions": 4}, "files": [{"sha": "802b2dbdf4e55ae2f6ecf878a57ebdc26df82869", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/baad98300aff8149553e5f09871be690bd5cacb9/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/baad98300aff8149553e5f09871be690bd5cacb9/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=baad98300aff8149553e5f09871be690bd5cacb9", "patch": "@@ -1,3 +1,9 @@\n+2012-12-05  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* exp_dist.adb (Build_From_Any_Call, Build_To_Any_Call,\n+\tBuild_TypeCode_Call): For a used-defined subtype, always go to\n+\tthe first subtype of the base type.\n+\n 2012-12-05  Thomas Quinot  <quinot@adacore.com>\n \n \t* exp_dist.adb: Minor reformatting."}, {"sha": "7c7fbd06f5f0662c2d1d55c2e3944a7685c5c3db", "filename": "gcc/ada/exp_dist.adb", "status": "modified", "additions": 26, "deletions": 4, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/baad98300aff8149553e5f09871be690bd5cacb9/gcc%2Fada%2Fexp_dist.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/baad98300aff8149553e5f09871be690bd5cacb9/gcc%2Fada%2Fexp_dist.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_dist.adb?ref=baad98300aff8149553e5f09871be690bd5cacb9", "patch": "@@ -839,7 +839,7 @@ package body Exp_Dist is\n             Fnam : out Entity_Id);\n          --  Build TypeCode attribute function for Typ. Loc is the reference\n          --  location for generated nodes, Typ is the type for which the\n-         --  conversion function is generated. On return, Decl and Fnam contain\n+         --  typecode function is generated. On return, Decl and Fnam contain\n          --  the declaration and entity for the newly-created function.\n \n          procedure Build_Name_And_Repository_Id\n@@ -8453,6 +8453,14 @@ package body Exp_Dist is\n \n             if Sloc (U_Type) <= Standard_Location then\n                U_Type := Base_Type (U_Type);\n+\n+            --  For a user subtype, go to first subtype\n+\n+            elsif Comes_From_Source (U_Type)\n+              and then Nkind (Declaration_Node (U_Type))\n+                         = N_Subtype_Declaration\n+            then\n+               U_Type := First_Subtype (U_Type);\n             end if;\n \n             --  Check first for Boolean and Character. These are enumeration\n@@ -9261,6 +9269,14 @@ package body Exp_Dist is\n \n             if Sloc (U_Type) <= Standard_Location then\n                U_Type := Base_Type (U_Type);\n+\n+            --  For a user subtype, go to first subtype\n+\n+            elsif Comes_From_Source (U_Type)\n+              and then Nkind (Declaration_Node (U_Type))\n+                         = N_Subtype_Declaration\n+            then\n+               U_Type := First_Subtype (U_Type);\n             end if;\n \n             if Present (Fnam) then\n@@ -10045,6 +10061,14 @@ package body Exp_Dist is\n \n             if Sloc (U_Type) <= Standard_Location then\n                U_Type := Base_Type (U_Type);\n+\n+            --  For a user subtype, go to first subtype\n+\n+            elsif Comes_From_Source (U_Type)\n+              and then Nkind (Declaration_Node (U_Type))\n+                         = N_Subtype_Declaration\n+            then\n+               U_Type := First_Subtype (U_Type);\n             end if;\n \n             if No (Fnam) then\n@@ -10257,9 +10281,7 @@ package body Exp_Dist is\n             -- Return_Alias_TypeCode --\n             ---------------------------\n \n-            procedure Return_Alias_TypeCode\n-              (Base_TypeCode : Node_Id)\n-            is\n+            procedure Return_Alias_TypeCode (Base_TypeCode : Node_Id) is\n             begin\n                Add_TypeCode_Parameter (Base_TypeCode, Parameters);\n                Return_Constructed_TypeCode (RTE (RE_TC_Alias));"}]}