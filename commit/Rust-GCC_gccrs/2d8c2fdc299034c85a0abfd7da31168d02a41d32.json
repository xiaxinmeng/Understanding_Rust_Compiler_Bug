{"sha": "2d8c2fdc299034c85a0abfd7da31168d02a41d32", "node_id": "C_kwDOANBUbNoAKDJkOGMyZmRjMjk5MDM0Yzg1YTBhYmZkN2RhMzExNjhkMDJhNDFkMzI", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2022-12-17T14:48:03Z"}, "committer": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2022-12-31T16:16:30Z"}, "message": "modula-2,libgm2: Add undefined, dynamic_lookup to m2 libs links.\n\nThe libm2 libraries are cross-linked, which means that we need to allow\nsymbols to be undefined at link time and then to be found at runtime.\n\nThis is implemented on Darwin by adding -undefined, dynamic_lookup to\nthe link command.\n\nNOTE: It would probably be a better solution to rework the libraries\neither to combine those that have inter-dependencies, or to reorder\nthe layering so the there is a fixed dependency tree.\n\nSigned-off-by: Iain Sandoe <iain@sandoe.co.uk>\n\nlibgm2/ChangeLog:\n\n\t* configure: Regenerate.\n\t* configure.ac: Make a conditional for configurations targeting\n\tDarwin.\n\t* libm2cor/Makefile.am: Use -undefined,dynamic_lookup on Darwin.\n\t* libm2iso/Makefile.am: Likewise.\n\t* libm2log/Makefile.am: Likewise.\n\t* libm2pim/Makefile.am: Likewise\n\t* libm2min/Makefile.am: Likewise\n\t* libm2cor/Makefile.in: Regenerate.\n\t* libm2iso/Makefile.in: Regenerate.\n\t* libm2log/Makefile.in: Regenerate.\n\t* libm2min/Makefile.in: Regenerate.\n\t* libm2pim/Makefile.in: Regenerate.", "tree": {"sha": "2044edcc4744af3966ce5125fd17169b1e24677a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2044edcc4744af3966ce5125fd17169b1e24677a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2d8c2fdc299034c85a0abfd7da31168d02a41d32", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d8c2fdc299034c85a0abfd7da31168d02a41d32", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d8c2fdc299034c85a0abfd7da31168d02a41d32", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d8c2fdc299034c85a0abfd7da31168d02a41d32/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ebc41f9a817dbae01c7450cd33c1968318ce8df0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ebc41f9a817dbae01c7450cd33c1968318ce8df0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ebc41f9a817dbae01c7450cd33c1968318ce8df0"}], "stats": {"total": 105, "additions": 90, "deletions": 15}, "files": [{"sha": "8404b0e6e6dc1be685c4ecf7d1cb18475694ced0", "filename": "libgm2/configure", "status": "modified", "additions": 30, "deletions": 3, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Fconfigure?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -634,6 +634,8 @@ ac_subst_vars='am__EXEEXT_FALSE\n am__EXEEXT_TRUE\n LTLIBOBJS\n LIBOBJS\n+TARGET_DARWIN_FALSE\n+TARGET_DARWIN_TRUE\n BUILD_LOGLIB_FALSE\n BUILD_LOGLIB_TRUE\n BUILD_CORLIB_FALSE\n@@ -12698,7 +12700,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 12701 \"configure\"\n+#line 12703 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -12804,7 +12806,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 12807 \"configure\"\n+#line 12809 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -19508,7 +19510,7 @@ $as_echo \"$as_me: libgm2 has finished checking target libc and libm contents.\" >\n # All known M2_HOST_OS values.  This is the union of all host operating systems\n # supported by gm2.\n \n-M2_SUPPORTED_HOST_OS=\"aix freebsd hurd linux netbsd openbsd solaris windows\"\n+M2_SUPPORTED_HOST_OS=\"aix freebsd hurd linux netbsd openbsd solaris windows darwin\"\n \n M2_HOST_OS=unknown\n \n@@ -19523,6 +19525,19 @@ case ${host} in\n   *-*-gnu*)      M2_HOST_OS=hurd ;;\n esac\n \n+M2_TARGET_OS=unknown\n+\n+case ${target} in\n+  *-*-darwin*)   M2_TARGET_OS=darwin ;;\n+  *-*-freebsd*)  M2_TARGET_OS=freebsd ;;\n+  *-*-linux*)    M2_TARGET_OS=linux ;;\n+  *-*-netbsd*)\t M2_TARGET_OS=netbsd ;;\n+  *-*-openbsd*)  M2_TARGET_OS=openbsd ;;\n+  *-*-solaris2*) M2_TARGET_OS=solaris ;;\n+  *-*-aix*)      M2_TARGET_OS=aix ;;\n+  *-*-gnu*)      M2_TARGET_OS=hurd ;;\n+esac\n+\n # M2_HOST_OS=unknown\n if test x${M2_HOST_OS} = xunknown; then\n    { $as_echo \"$as_me:${as_lineno-$LINENO}: unsupported host, will build a minimal m2 library\" >&5\n@@ -19672,6 +19687,14 @@ else\n   BUILD_LOGLIB_FALSE=\n fi\n \n+ if test x$M2_TARGET_OS = xdarwin; then\n+  TARGET_DARWIN_TRUE=\n+  TARGET_DARWIN_FALSE='#'\n+else\n+  TARGET_DARWIN_TRUE='#'\n+  TARGET_DARWIN_FALSE=\n+fi\n+\n \n \n ac_config_files=\"$ac_config_files Makefile libm2min/Makefile libm2pim/Makefile libm2iso/Makefile libm2cor/Makefile libm2log/Makefile\"\n@@ -19841,6 +19864,10 @@ if test -z \"${BUILD_LOGLIB_TRUE}\" && test -z \"${BUILD_LOGLIB_FALSE}\"; then\n   as_fn_error $? \"conditional \\\"BUILD_LOGLIB\\\" was never defined.\n Usually this means the macro was only invoked conditionally.\" \"$LINENO\" 5\n fi\n+if test -z \"${TARGET_DARWIN_TRUE}\" && test -z \"${TARGET_DARWIN_FALSE}\"; then\n+  as_fn_error $? \"conditional \\\"TARGET_DARWIN\\\" was never defined.\n+Usually this means the macro was only invoked conditionally.\" \"$LINENO\" 5\n+fi\n \n : \"${CONFIG_STATUS=./config.status}\"\n ac_write_fail=0"}, {"sha": "0465b7c1caf5f52c8d75b1be8c04acff942bb226", "filename": "libgm2/configure.ac", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Fconfigure.ac?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -267,7 +267,7 @@ AC_MSG_NOTICE([libgm2 has finished checking target libc and libm contents.])\n # All known M2_HOST_OS values.  This is the union of all host operating systems\n # supported by gm2.\n \n-M2_SUPPORTED_HOST_OS=\"aix freebsd hurd linux netbsd openbsd solaris windows\"\n+M2_SUPPORTED_HOST_OS=\"aix freebsd hurd linux netbsd openbsd solaris windows darwin\"\n \n M2_HOST_OS=unknown\n \n@@ -282,6 +282,19 @@ case ${host} in\n   *-*-gnu*)      M2_HOST_OS=hurd ;;\n esac\n \n+M2_TARGET_OS=unknown\n+\n+case ${target} in\n+  *-*-darwin*)   M2_TARGET_OS=darwin ;;\n+  *-*-freebsd*)  M2_TARGET_OS=freebsd ;;\n+  *-*-linux*)    M2_TARGET_OS=linux ;;\n+  *-*-netbsd*)\t M2_TARGET_OS=netbsd ;;\n+  *-*-openbsd*)  M2_TARGET_OS=openbsd ;;\n+  *-*-solaris2*) M2_TARGET_OS=solaris ;;\n+  *-*-aix*)      M2_TARGET_OS=aix ;;\n+  *-*-gnu*)      M2_TARGET_OS=hurd ;;\n+esac\n+\n # M2_HOST_OS=unknown\n if test x${M2_HOST_OS} = xunknown; then\n    AC_MSG_NOTICE([unsupported host, will build a minimal m2 library])\n@@ -366,6 +379,7 @@ AM_CONDITIONAL([BUILD_PIMLIB], [test x$BUILD_PIMLIB = xtrue])\n AM_CONDITIONAL([BUILD_ISOLIB], [test x$BUILD_ISOLIB = xtrue])\n AM_CONDITIONAL([BUILD_CORLIB], [test x$BUILD_CORLIB = xtrue])\n AM_CONDITIONAL([BUILD_LOGLIB], [test x$BUILD_LOGLIB = xtrue])\n+AM_CONDITIONAL([TARGET_DARWIN], [test x$M2_TARGET_OS = xdarwin])\n \n AC_CONFIG_SRCDIR([Makefile.am])\n AC_CONFIG_FILES([Makefile libm2min/Makefile libm2pim/Makefile libm2iso/Makefile"}, {"sha": "076ac08cc3049e520007fd1016f09b5d233dd473", "filename": "libgm2/libm2cor/Makefile.am", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2cor%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2cor%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2cor%2FMakefile.am?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -114,7 +114,12 @@ libm2cordir = libm2cor\n libm2cor_la_DEPENDENCIES = SYSTEM.def $(addsuffix .lo, $(basename $(libm2cor_la_SOURCES)))\n libm2cor_la_CFLAGS = -I. -I.. -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -DBUILD_GM2_LIBS -I@srcdir@/../  -I@srcdir@/../libm2iso\n libm2cor_la_M2FLAGS = -I. -I$(GM2_SRC)/gm2-libs-coroutines -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -fm2-g -g\n-libm2cor_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+if TARGET_DARWIN\n+libm2cor_la_link_flags = -Wl,-undefined,dynamic_lookup\n+else\n+libm2cor_la_link_flags =\n+endif\n+libm2cor_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2cor_la_link_flags)\n BUILT_SOURCES = SYSTEM.def\n CLEANFILES = SYSTEM.def\n "}, {"sha": "cef367e008f923754ba6fda84f86aba43ea571d4", "filename": "libgm2/libm2cor/Makefile.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2cor%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2cor%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2cor%2FMakefile.in?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -463,7 +463,9 @@ FLAGS_TO_PASS = $(AM_MAKEFLAGS)\n @BUILD_CORLIB_TRUE@libm2cor_la_DEPENDENCIES = SYSTEM.def $(addsuffix .lo, $(basename $(libm2cor_la_SOURCES)))\n @BUILD_CORLIB_TRUE@libm2cor_la_CFLAGS = -I. -I.. -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -DBUILD_GM2_LIBS -I@srcdir@/../  -I@srcdir@/../libm2iso\n @BUILD_CORLIB_TRUE@libm2cor_la_M2FLAGS = -I. -I$(GM2_SRC)/gm2-libs-coroutines -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -fm2-g -g\n-@BUILD_CORLIB_TRUE@libm2cor_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+@BUILD_CORLIB_TRUE@@TARGET_DARWIN_FALSE@libm2cor_la_link_flags = \n+@BUILD_CORLIB_TRUE@@TARGET_DARWIN_TRUE@libm2cor_la_link_flags = -Wl,-undefined,dynamic_lookup\n+@BUILD_CORLIB_TRUE@libm2cor_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2cor_la_link_flags)\n @BUILD_CORLIB_TRUE@BUILT_SOURCES = SYSTEM.def\n @BUILD_CORLIB_TRUE@CLEANFILES = SYSTEM.def\n @BUILD_CORLIB_TRUE@M2LIBDIR = /m2/m2cor/"}, {"sha": "fc0e4f5bd1acdd1a6fe243807f02fe95714c6bd3", "filename": "libgm2/libm2iso/Makefile.am", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2iso%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2iso%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2iso%2FMakefile.am?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -187,7 +187,12 @@ libm2isodir = libm2iso\n libm2iso_la_DEPENDENCIES = SYSTEM.def $(addsuffix .lo, $(basename $(libm2iso_la_SOURCES)))\n libm2iso_la_CFLAGS = $(C_INCLUDES) -I. -I.. -I$(GM2_SRC)/gm2-libs-iso -I$(GM2_SRC)/gm2-libs -DBUILD_GM2_LIBS -I@srcdir@/../ -I../../../gcc -I$(GCC_DIR) -I$(GCC_DIR)/../include -I../../libgcc -I$(GCC_DIR)/../libgcc -I$(MULTIBUILDTOP)../../gcc/include\n libm2iso_la_M2FLAGS = -I. -Ilibm2iso -I$(GM2_SRC)/gm2-libs-iso -I$(GM2_SRC)/gm2-libs -fiso -fextended-opaque -fm2-g -g\n-libm2iso_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+if TARGET_DARWIN\n+libm2iso_la_link_flags = -Wl,-undefined,dynamic_lookup\n+else\n+libm2iso_la_link_flags =\n+endif\n+libm2iso_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2iso_la_link_flags)\n CLEANFILES = SYSTEM.def\n BUILT_SOURCES = SYSTEM.def\n "}, {"sha": "e628dd336310b96d4335e19acb89909dc64dad46", "filename": "libgm2/libm2iso/Makefile.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2iso%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2iso%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2iso%2FMakefile.in?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -563,7 +563,9 @@ FLAGS_TO_PASS = $(AM_MAKEFLAGS)\n @BUILD_ISOLIB_TRUE@libm2iso_la_DEPENDENCIES = SYSTEM.def $(addsuffix .lo, $(basename $(libm2iso_la_SOURCES)))\n @BUILD_ISOLIB_TRUE@libm2iso_la_CFLAGS = $(C_INCLUDES) -I. -I.. -I$(GM2_SRC)/gm2-libs-iso -I$(GM2_SRC)/gm2-libs -DBUILD_GM2_LIBS -I@srcdir@/../ -I../../../gcc -I$(GCC_DIR) -I$(GCC_DIR)/../include -I../../libgcc -I$(GCC_DIR)/../libgcc -I$(MULTIBUILDTOP)../../gcc/include\n @BUILD_ISOLIB_TRUE@libm2iso_la_M2FLAGS = -I. -Ilibm2iso -I$(GM2_SRC)/gm2-libs-iso -I$(GM2_SRC)/gm2-libs -fiso -fextended-opaque -fm2-g -g\n-@BUILD_ISOLIB_TRUE@libm2iso_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+@BUILD_ISOLIB_TRUE@@TARGET_DARWIN_FALSE@libm2iso_la_link_flags = \n+@BUILD_ISOLIB_TRUE@@TARGET_DARWIN_TRUE@libm2iso_la_link_flags = -Wl,-undefined,dynamic_lookup\n+@BUILD_ISOLIB_TRUE@libm2iso_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2iso_la_link_flags)\n @BUILD_ISOLIB_TRUE@CLEANFILES = SYSTEM.def\n @BUILD_ISOLIB_TRUE@BUILT_SOURCES = SYSTEM.def\n @BUILD_ISOLIB_TRUE@M2LIBDIR = /m2/m2iso/"}, {"sha": "f8261b9dc5a06ded5ee1d3f5671dc4007ec2df76", "filename": "libgm2/libm2log/Makefile.am", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2log%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2log%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2log%2FMakefile.am?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -132,7 +132,12 @@ libm2log_la_SOURCES = $(M2MODS) Break.c\n libm2log_la_DEPENDENCIES = ../libm2pim/SYSTEM.def $(addsuffix .lo, $(basename $(libm2log_la_SOURCES)))\n libm2log_la_CFLAGS = -I. -DBUILD_GM2_LIBS -I@srcdir@/../\n libm2log_la_M2FLAGS = -I../libm2pim -I$(GM2_SRC)/gm2-libs-pim -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso\n-libm2log_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+if TARGET_DARWIN\n+libm2log_la_link_flags = -Wl,-undefined,dynamic_lookup\n+else\n+libm2log_la_link_flags =\n+endif\n+libm2log_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2log_la_link_flags)\n BUILT_SOURCES = ../libm2pim/SYSTEM.def\n \n M2LIBDIR = /m2/m2log/"}, {"sha": "15e0a5fc2c61826820fc8a4f03d31d6cc6f74215", "filename": "libgm2/libm2log/Makefile.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2log%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2log%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2log%2FMakefile.in?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -471,7 +471,9 @@ FLAGS_TO_PASS = $(AM_MAKEFLAGS)\n @BUILD_LOGLIB_TRUE@libm2log_la_DEPENDENCIES = ../libm2pim/SYSTEM.def $(addsuffix .lo, $(basename $(libm2log_la_SOURCES)))\n @BUILD_LOGLIB_TRUE@libm2log_la_CFLAGS = -I. -DBUILD_GM2_LIBS -I@srcdir@/../\n @BUILD_LOGLIB_TRUE@libm2log_la_M2FLAGS = -I../libm2pim -I$(GM2_SRC)/gm2-libs-pim -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso\n-@BUILD_LOGLIB_TRUE@libm2log_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+@BUILD_LOGLIB_TRUE@@TARGET_DARWIN_FALSE@libm2log_la_link_flags = \n+@BUILD_LOGLIB_TRUE@@TARGET_DARWIN_TRUE@libm2log_la_link_flags = -Wl,-undefined,dynamic_lookup\n+@BUILD_LOGLIB_TRUE@libm2log_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2log_la_link_flags)\n @BUILD_LOGLIB_TRUE@BUILT_SOURCES = ../libm2pim/SYSTEM.def\n @BUILD_LOGLIB_TRUE@M2LIBDIR = /m2/m2log/\n all: $(BUILT_SOURCES)"}, {"sha": "4d7726662e7f61e471734b69e29d67fb4a6e8c8e", "filename": "libgm2/libm2min/Makefile.am", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2min%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2min%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2min%2FMakefile.am?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -106,7 +106,12 @@ libm2min_la_DEPENDENCIES = SYSTEM.def $(addsuffix .lo, $(basename $(libm2min_la_\n libm2min_la_CFLAGS = -I. -I$(GM2_SRC)/gm2-libs-min -I$(GM2_SRC)/gm2-libs\n libm2min_la_M2FLAGS = -I. -I$(GM2_SRC)/gm2-libs-min -I$(GM2_SRC)/gm2-libs -fno-exceptions \\\n    -fno-m2-plugin -fno-scaffold-dynamic -fno-scaffold-main\n-libm2min_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+if TARGET_DARWIN\n+libm2min_la_link_flags = -Wl,-undefined,dynamic_lookup\n+else\n+libm2min_la_link_flags =\n+endif\n+libm2min_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2min_la_link_flags)\n BUILT_SOURCES = SYSTEM.def\n CLEANFILES = SYSTEM.def\n "}, {"sha": "f831995998806ab5295b6ef44c25e09f82250ffb", "filename": "libgm2/libm2min/Makefile.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2min%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2min%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2min%2FMakefile.in?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -439,7 +439,9 @@ libm2min_la_CFLAGS = -I. -I$(GM2_SRC)/gm2-libs-min -I$(GM2_SRC)/gm2-libs\n libm2min_la_M2FLAGS = -I. -I$(GM2_SRC)/gm2-libs-min -I$(GM2_SRC)/gm2-libs -fno-exceptions \\\n    -fno-m2-plugin -fno-scaffold-dynamic -fno-scaffold-main\n \n-libm2min_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+@TARGET_DARWIN_FALSE@libm2min_la_link_flags = \n+@TARGET_DARWIN_TRUE@libm2min_la_link_flags = -Wl,-undefined,dynamic_lookup\n+libm2min_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2min_la_link_flags)\n BUILT_SOURCES = SYSTEM.def\n CLEANFILES = SYSTEM.def\n M2LIBDIR = /m2/m2min/"}, {"sha": "98c9ca14579150ff8017c2d0a40681ed9876f846", "filename": "libgm2/libm2pim/Makefile.am", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2pim%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2pim%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2pim%2FMakefile.am?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -33,7 +33,6 @@ slibdir = @slibdir@\n \n toolexeclibdir=@toolexeclibdir@\n toolexecdir=@toolexecdir@\n-GM2_FOR_TARGET=@GM2_FOR_TARGET@\n \n MULTIDIR := $(shell $(CC) $(CFLAGS) -print-multi-directory)\n MULTIOSDIR := $(shell $(CC) $(CFLAGS) -print-multi-os-directory)\n@@ -168,7 +167,12 @@ libm2pimdir = libm2pim\n libm2pim_la_DEPENDENCIES = SYSTEM.def $(addsuffix .lo, $(basename $(libm2pim_la_SOURCES)))\n libm2pim_la_CFLAGS = -I. -I.. -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -DBUILD_GM2_LIBS -I@srcdir@/../  -I@srcdir@/../libm2iso\n libm2pim_la_M2FLAGS = -I. -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -fm2-g -g\n-libm2pim_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+if TARGET_DARWIN\n+libm2pim_la_link_flags = -Wl,-undefined,dynamic_lookup\n+else\n+libm2pim_la_link_flags =\n+endif\n+libm2pim_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2pim_la_link_flags)\n BUILT_SOURCES = SYSTEM.def\n CLEANFILES = SYSTEM.def\n "}, {"sha": "ab05ca9fb495027c1e0cfd1c413190294c145ccc", "filename": "libgm2/libm2pim/Makefile.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2pim%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d8c2fdc299034c85a0abfd7da31168d02a41d32/libgm2%2Flibm2pim%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgm2%2Flibm2pim%2FMakefile.in?ref=2d8c2fdc299034c85a0abfd7da31168d02a41d32", "patch": "@@ -534,7 +534,9 @@ FLAGS_TO_PASS = $(AM_MAKEFLAGS)\n @BUILD_PIMLIB_TRUE@libm2pim_la_DEPENDENCIES = SYSTEM.def $(addsuffix .lo, $(basename $(libm2pim_la_SOURCES)))\n @BUILD_PIMLIB_TRUE@libm2pim_la_CFLAGS = -I. -I.. -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -DBUILD_GM2_LIBS -I@srcdir@/../  -I@srcdir@/../libm2iso\n @BUILD_PIMLIB_TRUE@libm2pim_la_M2FLAGS = -I. -I$(GM2_SRC)/gm2-libs -I$(GM2_SRC)/gm2-libs-iso -fm2-g -g\n-@BUILD_PIMLIB_TRUE@libm2pim_la_LINK = $(LINK) -version-info $(libtool_VERSION)\n+@BUILD_PIMLIB_TRUE@@TARGET_DARWIN_FALSE@libm2pim_la_link_flags = \n+@BUILD_PIMLIB_TRUE@@TARGET_DARWIN_TRUE@libm2pim_la_link_flags = -Wl,-undefined,dynamic_lookup\n+@BUILD_PIMLIB_TRUE@libm2pim_la_LINK = $(LINK) -version-info $(libtool_VERSION) $(libm2pim_la_link_flags)\n @BUILD_PIMLIB_TRUE@BUILT_SOURCES = SYSTEM.def\n @BUILD_PIMLIB_TRUE@CLEANFILES = SYSTEM.def\n @BUILD_PIMLIB_TRUE@M2LIBDIR = /m2/m2pim/"}]}