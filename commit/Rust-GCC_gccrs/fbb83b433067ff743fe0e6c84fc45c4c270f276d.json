{"sha": "fbb83b433067ff743fe0e6c84fc45c4c270f276d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmJiODNiNDMzMDY3ZmY3NDNmZTBlNmM4NGZjNDVjNGMyNzBmMjc2ZA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2001-10-23T11:50:50Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2001-10-23T11:50:50Z"}, "message": "i386.c (override_options): Default to minimum stack alignment when optimizing for code size.\n\n* config/i386/i386.c (override_options): Default to minimum\nstack alignment when optimizing for code size.\n* doc/invoke.texi (-mpreferred-stack-boundary): Document the\nchange.\n\nFrom-SVN: r46433", "tree": {"sha": "27041cf7f79a06096f0227a88d2cf26f16e1c4c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/27041cf7f79a06096f0227a88d2cf26f16e1c4c3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fbb83b433067ff743fe0e6c84fc45c4c270f276d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbb83b433067ff743fe0e6c84fc45c4c270f276d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fbb83b433067ff743fe0e6c84fc45c4c270f276d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fbb83b433067ff743fe0e6c84fc45c4c270f276d/comments", "author": null, "committer": null, "parents": [{"sha": "c6257c5d978a99ffc409664b03f696fce8c82e10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6257c5d978a99ffc409664b03f696fce8c82e10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c6257c5d978a99ffc409664b03f696fce8c82e10"}], "stats": {"total": 32, "additions": 21, "deletions": 11}, "files": [{"sha": "4db00904ef4fb6b0b24206e5af263e0bfef833ae", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbb83b433067ff743fe0e6c84fc45c4c270f276d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbb83b433067ff743fe0e6c84fc45c4c270f276d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fbb83b433067ff743fe0e6c84fc45c4c270f276d", "patch": "@@ -1,5 +1,10 @@\n 2001-10-23  Alexandre Oliva  <aoliva@redhat.com>\n \n+\t* config/i386/i386.c (override_options): Default to minimum\n+\tstack alignment when optimizing for code size.\n+\t* doc/invoke.texi (-mpreferred-stack-boundary): Document the\n+\tchange.\n+\n \t* config/i386/i386.c (override_options): Set upper limit of\n \t-mpreferred-stack-boundary to 12.\n "}, {"sha": "06dc3be823ecc1c18c08020834fad9bc9c071b40", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbb83b433067ff743fe0e6c84fc45c4c270f276d/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbb83b433067ff743fe0e6c84fc45c4c270f276d/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=fbb83b433067ff743fe0e6c84fc45c4c270f276d", "patch": "@@ -973,8 +973,12 @@ override_options ()\n     align_functions = 1 << abs (processor_target_table[ix86_cpu].align_func);\n \n   /* Validate -mpreferred-stack-boundary= value, or provide default.\n-     The default of 128 bits is for Pentium III's SSE __m128.  */\n-  ix86_preferred_stack_boundary = 128;\n+     The default of 128 bits is for Pentium III's SSE __m128, but we\n+     don't want additional code to keep the stack aligned when\n+     optimizing for code size.  */\n+  ix86_preferred_stack_boundary = (optimize_size\n+\t\t\t\t   ? TARGET_64BIT ? 64 : 32\n+\t\t\t\t   : 128);\n   if (ix86_preferred_stack_boundary_string)\n     {\n       i = atoi (ix86_preferred_stack_boundary_string);"}, {"sha": "1054c2bf3587faf29e3c6f314dafc43dc18ca772", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 10, "deletions": 9, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fbb83b433067ff743fe0e6c84fc45c4c270f276d/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fbb83b433067ff743fe0e6c84fc45c4c270f276d/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=fbb83b433067ff743fe0e6c84fc45c4c270f276d", "patch": "@@ -7587,12 +7587,13 @@ startup modules.\n @opindex mpreferred-stack-boundary\n Attempt to keep the stack boundary aligned to a 2 raised to @var{num}\n byte boundary.  If @option{-mpreferred-stack-boundary} is not specified,\n-the default is 4 (16 bytes or 128 bits).\n+the default is 4 (16 bytes or 128 bits), except when optimizing for code\n+size (@option{-Os}), in which case the default is the minimum correct\n+alignment (4 bytes for x86, and 8 bytes for x86-64).\n \n-The stack is required to be aligned on a 4 byte boundary.  On Pentium\n-and PentiumPro, @code{double} and @code{long double} values should be\n-aligned to an 8 byte boundary (see @option{-malign-double}) or suffer\n-significant run time performance penalties.  On Pentium III, the\n+On Pentium and PentiumPro, @code{double} and @code{long double} values\n+should be aligned to an 8 byte boundary (see @option{-malign-double}) or\n+suffer significant run time performance penalties.  On Pentium III, the\n Streaming SIMD Extension (SSE) data type @code{__m128} suffers similar\n penalties if it is not 16 byte aligned.\n \n@@ -7604,10 +7605,10 @@ stack boundary from a function compiled with a lower preferred stack\n boundary will most likely misalign the stack.  It is recommended that\n libraries that use callbacks always use the default setting.\n \n-This extra alignment does consume extra stack space.  Code that is sensitive\n-to stack space usage, such as embedded systems and operating system kernels,\n-may want to reduce the preferred alignment to\n-@option{-mpreferred-stack-boundary=2}.\n+This extra alignment does consume extra stack space, and generally\n+increases code size.  Code that is sensitive to stack space usage, such\n+as embedded systems and operating system kernels, may want to reduce the\n+preferred alignment to @option{-mpreferred-stack-boundary=2}.\n \n @item -mmmx\n @itemx -mno-mmx"}]}