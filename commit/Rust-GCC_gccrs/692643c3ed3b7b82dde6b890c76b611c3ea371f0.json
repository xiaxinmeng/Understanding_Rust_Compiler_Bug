{"sha": "692643c3ed3b7b82dde6b890c76b611c3ea371f0", "node_id": "C_kwDOANBUbNoAKDY5MjY0M2MzZWQzYjdiODJkZGU2Yjg5MGM3NmI2MTFjM2VhMzcxZjA", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-24T11:17:01Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-26T09:44:45Z"}, "message": "libstdc++: Refactor includes for unordered containers\n\nThis moves some #include directives to the relevant place. For example,\n<bits/hashtable_policy.h> needs <bits/stl_pair.h> so should include it\ndirectly instead of relying on <unordered_map> and <unordered_set> to do\nso first.\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/bits/functional_hash.h (__is_fast_hash): Add doxygen\n\tcomment.\n\t* include/bits/hashtable.h: Do not include <bits/stl_function.h>\n\there.\n\t* include/bits/hashtable_policy.h: Include <bits/stl_pair.h> and\n\t<bits/functional_hash.h>.\n\t* include/bits/unordered_map.h: Include required headers.\n\t* include/bits/unordered_set.h: Likewise.\n\t* include/std/unordered_map: Do not include headers for indirect\n\tdependencies.\n\t* include/std/unordered_set: Likewise.", "tree": {"sha": "ede86ab23bff44ec1cdc6d35ee48a3bdae1d7a1a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ede86ab23bff44ec1cdc6d35ee48a3bdae1d7a1a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/692643c3ed3b7b82dde6b890c76b611c3ea371f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/692643c3ed3b7b82dde6b890c76b611c3ea371f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/692643c3ed3b7b82dde6b890c76b611c3ea371f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/692643c3ed3b7b82dde6b890c76b611c3ea371f0/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "650eadd63022baf6993124d7e9b64141b908459a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/650eadd63022baf6993124d7e9b64141b908459a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/650eadd63022baf6993124d7e9b64141b908459a"}], "stats": {"total": 46, "additions": 24, "deletions": 22}, "files": [{"sha": "292c0ee03f783af4513f915888cb78bbe7da6611", "filename": "libstdc++-v3/include/bits/functional_hash.h", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffunctional_hash.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffunctional_hash.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Ffunctional_hash.h?ref=692643c3ed3b7b82dde6b890c76b611c3ea371f0", "patch": "@@ -280,10 +280,17 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n   /// @} group hashes\n \n-  // Hint about performance of hash functor. If not fast the hash-based\n-  // containers will cache the hash code.\n-  // Default behavior is to consider that hashers are fast unless specified\n-  // otherwise.\n+  /** Hint about performance of hash functions.\n+   *\n+   * If a given hash function object is not fast, the hash-based containers\n+   * will cache the hash code.\n+   * The default behavior is to consider that hashers are fast unless specified\n+   * otherwise.\n+   *\n+   * Users can specialize this for their own hash functions in order to force\n+   * caching of hash codes in unordered containers. Specializing this trait\n+   * affects the ABI of the unordered containers, so use it carefully.\n+   */\n   template<typename _Hash>\n     struct __is_fast_hash : public std::true_type\n     { };"}, {"sha": "29ec1192f32d5012de5c264a271c01d3460c0315", "filename": "libstdc++-v3/include/bits/hashtable.h", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fhashtable.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fhashtable.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fhashtable.h?ref=692643c3ed3b7b82dde6b890c76b611c3ea371f0", "patch": "@@ -34,11 +34,10 @@\n \n #include <bits/hashtable_policy.h>\n #include <bits/enable_special_members.h>\n+#include <bits/stl_function.h> // __has_is_transparent_t\n #if __cplusplus > 201402L\n # include <bits/node_handle.h>\n #endif\n-#include <bits/functional_hash.h>\n-#include <bits/stl_function.h> // equal_to, _Identity, _Select1st\n \n namespace std _GLIBCXX_VISIBILITY(default)\n {"}, {"sha": "1a259702f984afbe9cd3172f29cb76211177dc0c", "filename": "libstdc++-v3/include/bits/hashtable_policy.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fhashtable_policy.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fhashtable_policy.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fhashtable_policy.h?ref=692643c3ed3b7b82dde6b890c76b611c3ea371f0", "patch": "@@ -32,7 +32,9 @@\n #define _HASHTABLE_POLICY_H 1\n \n #include <tuple>\t\t// for std::tuple, std::forward_as_tuple\n+#include <bits/functional_hash.h> // for __is_fast_hash\n #include <bits/stl_algobase.h>\t// for std::min, std::is_permutation.\n+#include <bits/stl_pair.h>\t// for std::pair\n #include <ext/aligned_buffer.h>\t// for __gnu_cxx::__aligned_buffer\n #include <ext/alloc_traits.h>\t// for std::__alloc_rebind\n #include <ext/numeric_traits.h>\t// for __gnu_cxx::__int_traits"}, {"sha": "5a3e6f61af276e367e7c35a6186d01f11cb77b2a", "filename": "libstdc++-v3/include/bits/unordered_map.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Funordered_map.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Funordered_map.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Funordered_map.h?ref=692643c3ed3b7b82dde6b890c76b611c3ea371f0", "patch": "@@ -30,6 +30,11 @@\n #ifndef _UNORDERED_MAP_H\n #define _UNORDERED_MAP_H\n \n+#include <bits/hashtable.h>\n+#include <bits/allocator.h>\n+#include <bits/functional_hash.h> // hash\n+#include <bits/stl_function.h>    // equal_to\n+\n namespace std _GLIBCXX_VISIBILITY(default)\n {\n _GLIBCXX_BEGIN_NAMESPACE_VERSION"}, {"sha": "740bbafd4c9e7f4a6e77aa5be9371f9e4b276e96", "filename": "libstdc++-v3/include/bits/unordered_set.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Funordered_set.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fbits%2Funordered_set.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Funordered_set.h?ref=692643c3ed3b7b82dde6b890c76b611c3ea371f0", "patch": "@@ -30,6 +30,11 @@\n #ifndef _UNORDERED_SET_H\n #define _UNORDERED_SET_H\n \n+#include <bits/hashtable.h>\n+#include <bits/allocator.h>\n+#include <bits/functional_hash.h> // hash\n+#include <bits/stl_function.h>    // equal_to\n+\n namespace std _GLIBCXX_VISIBILITY(default)\n {\n _GLIBCXX_BEGIN_NAMESPACE_VERSION"}, {"sha": "b50ec2a8de249961ddce17ddbf93c5e354b44bd1", "filename": "libstdc++-v3/include/std/unordered_map", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fstd%2Funordered_map", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fstd%2Funordered_map", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Funordered_map?ref=692643c3ed3b7b82dde6b890c76b611c3ea371f0", "patch": "@@ -35,15 +35,7 @@\n # include <bits/c++0x_warning.h>\n #else\n \n-#include <type_traits>\n #include <initializer_list>\n-#include <bits/allocator.h>\n-#include <ext/alloc_traits.h>\n-#include <ext/aligned_buffer.h>\n-#include <bits/stl_pair.h>\n-#include <bits/stl_function.h> // equal_to, _Identity, _Select1st\n-#include <bits/functional_hash.h>\n-#include <bits/hashtable.h>\n #include <bits/unordered_map.h>\n #include <bits/range_access.h>\n #include <bits/erase_if.h>"}, {"sha": "edaa517635becb0049f393aba0c170b739190a85", "filename": "libstdc++-v3/include/std/unordered_set", "status": "modified", "additions": 0, "deletions": 8, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fstd%2Funordered_set", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/692643c3ed3b7b82dde6b890c76b611c3ea371f0/libstdc%2B%2B-v3%2Finclude%2Fstd%2Funordered_set", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Funordered_set?ref=692643c3ed3b7b82dde6b890c76b611c3ea371f0", "patch": "@@ -35,15 +35,7 @@\n # include <bits/c++0x_warning.h>\n #else\n \n-#include <type_traits>\n #include <initializer_list>\n-#include <bits/allocator.h>\n-#include <ext/alloc_traits.h>\n-#include <ext/aligned_buffer.h>\n-#include <bits/stl_pair.h>\n-#include <bits/stl_function.h> // equal_to, _Identity, _Select1st\n-#include <bits/functional_hash.h>\n-#include <bits/hashtable.h>\n #include <bits/unordered_set.h>\n #include <bits/range_access.h>\n #include <bits/erase_if.h>"}]}