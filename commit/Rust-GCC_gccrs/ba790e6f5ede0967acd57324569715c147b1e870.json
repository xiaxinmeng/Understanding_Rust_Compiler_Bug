{"sha": "ba790e6f5ede0967acd57324569715c147b1e870", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmE3OTBlNmY1ZWRlMDk2N2FjZDU3MzI0NTY5NzE1YzE0N2IxZTg3MA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2019-02-26T10:08:29Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2019-02-26T10:08:29Z"}, "message": "re PR target/89474 (ice in df_reg_chain_verify_unmarked, at df-scan.c:3995)\n\n\tPR target/89474\n\t* config/i386/i386.c (remove_partial_avx_dependency): Call\n\tdf_analyze etc. before creation of the v4sf_const0 pseudo, rather than\n\tafter changing possibly many instructions to use that pseudo.  Fix up\n\tinsertion of v4sf_const0 setter at the start of bb.\n\n\t* gcc.target/i386/pr89474.c: New test.\n\nFrom-SVN: r269206", "tree": {"sha": "8393a7a5c09cb97166aabc7f4b22e56b2a8fb7f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8393a7a5c09cb97166aabc7f4b22e56b2a8fb7f7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ba790e6f5ede0967acd57324569715c147b1e870", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba790e6f5ede0967acd57324569715c147b1e870", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba790e6f5ede0967acd57324569715c147b1e870", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba790e6f5ede0967acd57324569715c147b1e870/comments", "author": null, "committer": null, "parents": [{"sha": "d831b1ec037bc20b821e140205057f9c240663c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d831b1ec037bc20b821e140205057f9c240663c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d831b1ec037bc20b821e140205057f9c240663c7"}], "stats": {"total": 73, "additions": 56, "deletions": 17}, "files": [{"sha": "fdc72bbaef19669b28e260029c1864d5f71289fb", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ba790e6f5ede0967acd57324569715c147b1e870", "patch": "@@ -1,13 +1,19 @@\n+2019-02-26  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/89474\n+\t* config/i386/i386.c (remove_partial_avx_dependency): Call\n+\tdf_analyze etc. before creation of the v4sf_const0 pseudo, rather than\n+\tafter changing possibly many instructions to use that pseudo.  Fix up\n+\tinsertion of v4sf_const0 setter at the start of bb.\n+\n 2019-02-25  Sandra Loosemore  <sandra@codesourcery.com>\n \n \tPR c/80409\n-\n \t* doc/extend.texi (Variadic Pointer Args): New section.\n \n 2019-02-25  Sandra Loosemore  <sandra@codesourcery.com>\n \t    Martin Sebor  <msebor@gmail.com>\n \n-\t* c-family/c.opt (Wmissing-attributes): Clean up doc string.\n \t* common.opt (Wattribute-alias): Likewise.\n \t* doc/invoke.texi (Option Summary): List general form of\n \t-Wattribute-alias=.  List positive form of -Wmissing-attributes.\n@@ -18,8 +24,6 @@\n \n 2019-02-25  Paul A. Clarke  <pc@us.ibm.com>\n \n-[gcc]\n-\n \t* config/rs6000/emmintrin.h (_mm_cvtpd_epi32): Fix big endian.\n \t(_mm_cvtpd_ps): Likewise.\n \t(_mm_cvttpd_epi32): Likewise.\n@@ -31,7 +35,6 @@\n \tPR target/89339\n \t* config/rs6000/xmmintrin.h (_mm_movemask_pi8): Fix 32-bit.\n \n-\n 2019-02-25  Tamar Christina  <tamar.christina@arm.com>\n \n \tPR target/88530\n@@ -95,7 +98,6 @@\n \tvfmlalq_lane_high_f16, vfmlslq_lane_high_f16, vfmlalq_laneq_high_f16,\n \tvfmlslq_laneq_high_f16): ... To this.\n \n-\n 2019-02-25  Alexander Monakov  <amonakov@ispras.ru>\n \n \tPR rtl-optimization/86096"}, {"sha": "da8918c58016874b124c73f78e9ed981b74a1092", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=ba790e6f5ede0967acd57324569715c147b1e870", "patch": "@@ -1,3 +1,8 @@\n+2019-02-25  Sandra Loosemore  <sandra@codesourcery.com>\n+\t    Martin Sebor  <msebor@gmail.com>\n+\n+\t* c.opt (Wmissing-attributes): Clean up doc string.\n+\n 2019-02-25  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/89495"}, {"sha": "b8357a7db5d00d60de84a76564ac9404a98e9f65", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 24, "deletions": 11, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=ba790e6f5ede0967acd57324569715c147b1e870", "patch": "@@ -2835,7 +2835,14 @@ remove_partial_avx_dependency (void)\n \t    continue;\n \n \t  if (!v4sf_const0)\n-\t    v4sf_const0 = gen_reg_rtx (V4SFmode);\n+\t    {\n+\t      calculate_dominance_info (CDI_DOMINATORS);\n+\t      df_set_flags (DF_DEFER_INSN_RESCAN);\n+\t      df_chain_add_problem (DF_DU_CHAIN | DF_UD_CHAIN);\n+\t      df_md_add_problem ();\n+\t      df_analyze ();\n+\t      v4sf_const0 = gen_reg_rtx (V4SFmode);\n+\t    }\n \n \t  /* Convert PARTIAL_XMM_UPDATE_TRUE insns, DF -> SF, SF -> DF,\n \t     SI -> SF, SI -> DF, DI -> SF, DI -> DF, to vec_dup and\n@@ -2883,12 +2890,6 @@ remove_partial_avx_dependency (void)\n \n   if (v4sf_const0)\n     {\n-      calculate_dominance_info (CDI_DOMINATORS);\n-      df_set_flags (DF_DEFER_INSN_RESCAN);\n-      df_chain_add_problem (DF_DU_CHAIN | DF_UD_CHAIN);\n-      df_md_add_problem ();\n-      df_analyze ();\n-\n       /* (Re-)discover loops so that bb->loop_father can be used in the\n \t analysis below.  */\n       loop_optimizer_init (AVOID_CFG_MODIFICATIONS);\n@@ -2904,11 +2905,23 @@ remove_partial_avx_dependency (void)\n \tbb = get_immediate_dominator (CDI_DOMINATORS,\n \t\t\t\t      bb->loop_father->header);\n \n-      insn = BB_HEAD (bb);\n-      if (!NONDEBUG_INSN_P (insn))\n-\tinsn = next_nonnote_nondebug_insn (insn);\n       set = gen_rtx_SET (v4sf_const0, CONST0_RTX (V4SFmode));\n-      set_insn = emit_insn_before (set, insn);\n+\n+      insn = BB_HEAD (bb);\n+      while (insn && !NONDEBUG_INSN_P (insn))\n+\t{\n+\t  if (insn == BB_END (bb))\n+\t    {\n+\t      insn = NULL;\n+\t      break;\n+\t    }\n+\t  insn = NEXT_INSN (insn);\n+\t}\n+      if (insn == BB_HEAD (bb))\n+        set_insn = emit_insn_before (set, insn);\n+      else\n+\tset_insn = emit_insn_after (set,\n+\t\t\t\t    insn ? PREV_INSN (insn) : BB_END (bb));\n       df_insn_rescan (set_insn);\n       df_process_deferred_rescans ();\n       loop_optimizer_finalize ();"}, {"sha": "3c90c8df084518ad153182e1491a1ddb0f407af4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ba790e6f5ede0967acd57324569715c147b1e870", "patch": "@@ -1,3 +1,8 @@\n+2019-02-26  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/89474\n+\t* gcc.target/i386/pr89474.c: New test.\n+\n 2019-02-25  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/77754"}, {"sha": "7d0dd9eac42edfd4e01cfa84419a547190cfac6c", "filename": "gcc/testsuite/gcc.target/i386/pr89474.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr89474.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba790e6f5ede0967acd57324569715c147b1e870/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr89474.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr89474.c?ref=ba790e6f5ede0967acd57324569715c147b1e870", "patch": "@@ -0,0 +1,14 @@\n+/* PR target/89474 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -mavx\" } */\n+\n+int a;\n+void foo (double);\n+int baz (void);\n+\n+void\n+bar (void)\n+{\n+  while (baz ())\n+    foo (a);\n+}"}]}