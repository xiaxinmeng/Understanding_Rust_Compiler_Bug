{"sha": "6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmMxYmMyN2M1ZjEwNTJlMzYzZTY5ZmNhYmVlNDVlZjQ0ZDRiZGRlNQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2015-08-31T11:47:30Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2015-08-31T11:47:30Z"}, "message": "lto-streamer.h (lto_location_cache::cached_location::sysp): Add.\n\n2015-08-31  Richard Biener  <rguenther@suse.de>\n\n\t* lto-streamer.h (lto_location_cache::cached_location::sysp): Add.\n\t(lto_location_cache::current_sysp): Likewise.\n\t(output_block::current_sysp): Likewise.\n\t* lto-streamer-in.c (lto_location_cache::cmp_loc): Compare sysp.\n\t(lto_location_cache::apply_location_cache): Properly record\n\tsystem header locations.\n\t(lto_location_cache::input_location): Input whether a file\n\tis a system header.\n\t* lto-streamer-out.c (lto_output_location): Stream whether a file\n\tis a system header.\n\nFrom-SVN: r227338", "tree": {"sha": "72db555178b725e356d6e13b9f21e6cedd48abd2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/72db555178b725e356d6e13b9f21e6cedd48abd2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c25eec8ffd8605d473192faec7ef11b9abf7a10b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c25eec8ffd8605d473192faec7ef11b9abf7a10b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c25eec8ffd8605d473192faec7ef11b9abf7a10b"}], "stats": {"total": 37, "additions": 32, "deletions": 5}, "files": [{"sha": "deda8a42906789abec30c33ba12d07d6165a0652", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "patch": "@@ -1,3 +1,16 @@\n+2015-08-31  Richard Biener  <rguenther@suse.de>\n+\n+\t* lto-streamer.h (lto_location_cache::cached_location::sysp): Add.\n+\t(lto_location_cache::current_sysp): Likewise.\n+\t(output_block::current_sysp): Likewise.\n+\t* lto-streamer-in.c (lto_location_cache::cmp_loc): Compare sysp.\n+\t(lto_location_cache::apply_location_cache): Properly record\n+\tsystem header locations.\n+\t(lto_location_cache::input_location): Input whether a file\n+\tis a system header.\n+\t* lto-streamer-out.c (lto_output_location): Stream whether a file\n+\tis a system header.\n+\n 2015-08-31  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \tPR bootstrap/67363"}, {"sha": "07018ecb904c19b315f47134f9ea18e46dbc9232", "filename": "gcc/lto-streamer-in.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2Flto-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2Flto-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-in.c?ref=6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "patch": "@@ -171,6 +171,8 @@ lto_location_cache::cmp_loc (const void *pa, const void *pb)\n     }\n   if (a->file != b->file)\n     return strcmp (a->file, b->file);\n+  if (a->sysp != b->sysp)\n+    return a->sysp ? 1 : -1;\n   if (a->line != b->line)\n     return a->line - b->line;\n   return a->col - b->col;\n@@ -194,7 +196,7 @@ lto_location_cache::apply_location_cache ()\n \n       if (current_file != loc.file)\n \tlinemap_add (line_table, prev_file ? LC_RENAME : LC_ENTER,\n-\t\t     false, loc.file, loc.line);\n+\t\t     loc.sysp, loc.file, loc.line);\n       else if (current_line != loc.line)\n \t{\n \t  int max = loc.col;\n@@ -251,6 +253,7 @@ lto_location_cache::input_location (location_t *loc, struct bitpack_d *bp,\n   static const char *stream_file;\n   static int stream_line;\n   static int stream_col;\n+  static bool stream_sysp;\n   bool file_change, line_change, column_change;\n \n   gcc_assert (current_cache == this);\n@@ -268,7 +271,10 @@ lto_location_cache::input_location (location_t *loc, struct bitpack_d *bp,\n   column_change = bp_unpack_value (bp, 1);\n \n   if (file_change)\n-    stream_file = canon_file_name (bp_unpack_string (data_in, bp));\n+    {\n+      stream_file = canon_file_name (bp_unpack_string (data_in, bp));\n+      stream_sysp = bp_unpack_value (bp, 1);\n+    }\n \n   if (line_change)\n     stream_line = bp_unpack_var_len_unsigned (bp);\n@@ -280,13 +286,14 @@ lto_location_cache::input_location (location_t *loc, struct bitpack_d *bp,\n      streaming.  */\n      \n   if (current_file == stream_file && current_line == stream_line\n-      && current_col == stream_col)\n+      && current_col == stream_col && current_sysp == stream_sysp)\n     {\n       *loc = current_loc;\n       return;\n     }\n \n-  struct cached_location entry = {stream_file, loc, stream_line, stream_col};\n+  struct cached_location entry\n+    = {stream_file, loc, stream_line, stream_col, stream_sysp};\n   loc_cache.safe_push (entry);\n }\n "}, {"sha": "b6bc515201d8a4682d22d22778e6bced225aa38f", "filename": "gcc/lto-streamer-out.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2Flto-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2Flto-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-out.c?ref=6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "patch": "@@ -191,8 +191,12 @@ lto_output_location (struct output_block *ob, struct bitpack_d *bp,\n   bp_pack_value (bp, ob->current_col != xloc.column, 1);\n \n   if (ob->current_file != xloc.file)\n-    bp_pack_string (ob, bp, xloc.file, true);\n+    {\n+      bp_pack_string (ob, bp, xloc.file, true);\n+      bp_pack_value (bp, xloc.sysp, 1);\n+    }\n   ob->current_file = xloc.file;\n+  ob->current_sysp = xloc.sysp;\n \n   if (ob->current_line != xloc.line)\n     bp_pack_var_len_unsigned (bp, xloc.line);"}, {"sha": "21c41c5a6210f38dbb65f40302c1db9af2308c41", "filename": "gcc/lto-streamer.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2Flto-streamer.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6c1bc27c5f1052e363e69fcabee45ef44d4bdde5/gcc%2Flto-streamer.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer.h?ref=6c1bc27c5f1052e363e69fcabee45ef44d4bdde5", "patch": "@@ -345,6 +345,7 @@ class lto_location_cache\n     const char *file;\n     location_t *loc;\n     int line, col;\n+    bool sysp;\n   };\n \n   /* The location cache.  */\n@@ -364,6 +365,7 @@ class lto_location_cache\n   const char *current_file;\n   int current_line;\n   int current_col;\n+  bool current_sysp;\n   location_t current_loc;\n };\n \n@@ -711,6 +713,7 @@ struct output_block\n   const char *current_file;\n   int current_line;\n   int current_col;\n+  bool current_sysp;\n \n   /* Cache of nodes written in this section.  */\n   struct streamer_tree_cache_d *writer_cache;"}]}