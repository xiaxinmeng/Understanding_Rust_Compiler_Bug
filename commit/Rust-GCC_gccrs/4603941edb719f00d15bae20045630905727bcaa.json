{"sha": "4603941edb719f00d15bae20045630905727bcaa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDYwMzk0MWVkYjcxOWYwMGQxNWJhZTIwMDQ1NjMwOTA1NzI3YmNhYQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@linaro.org", "date": "2017-10-23T09:36:12Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2017-10-23T09:36:12Z"}, "message": "Use scalar_int/float_mode in brig_langhook_type_for_mode\n\nThis follows on from similar changes a couple of months ago and\nis needed when general modes have variable size.\n\n2017-10-23  Richard Sandiford  <richard.sandiford@linaro.org>\n\ngcc/brig/\n\t* brig-lang.c (brig_langhook_type_for_mode): Use scalar_int_mode\n\tand scalar_float_mode.\n\nFrom-SVN: r254000", "tree": {"sha": "bfb7676939994aab5c1c674368f4820813cc4dfd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bfb7676939994aab5c1c674368f4820813cc4dfd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4603941edb719f00d15bae20045630905727bcaa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4603941edb719f00d15bae20045630905727bcaa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4603941edb719f00d15bae20045630905727bcaa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4603941edb719f00d15bae20045630905727bcaa/comments", "author": null, "committer": null, "parents": [{"sha": "a85cf8e99049f4db8b5868b5df5ef201a9a7b2cb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a85cf8e99049f4db8b5868b5df5ef201a9a7b2cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a85cf8e99049f4db8b5868b5df5ef201a9a7b2cb"}], "stats": {"total": 18, "additions": 12, "deletions": 6}, "files": [{"sha": "01778599406c9a95c5239e05a2803162f96c044b", "filename": "gcc/brig/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4603941edb719f00d15bae20045630905727bcaa/gcc%2Fbrig%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4603941edb719f00d15bae20045630905727bcaa/gcc%2Fbrig%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbrig%2FChangeLog?ref=4603941edb719f00d15bae20045630905727bcaa", "patch": "@@ -1,3 +1,8 @@\n+2017-10-23  Richard Sandiford  <richard.sandiford@linaro.org>\n+\n+\t* brig-lang.c (brig_langhook_type_for_mode): Use scalar_int_mode\n+\tand scalar_float_mode.\n+\n 2017-10-09  Pekka J\u00e4\u00e4skel\u00e4inen  <pekka.jaaskelainen@parmance.com>\n \n \t* brigfrontend/brig-to-generic.cc: Support BRIG_KIND_NONE"}, {"sha": "cff605541d05b80bbe815699b5dc8cc1f36a24cf", "filename": "gcc/brig/brig-lang.c", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4603941edb719f00d15bae20045630905727bcaa/gcc%2Fbrig%2Fbrig-lang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4603941edb719f00d15bae20045630905727bcaa/gcc%2Fbrig%2Fbrig-lang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbrig%2Fbrig-lang.c?ref=4603941edb719f00d15bae20045630905727bcaa", "patch": "@@ -278,10 +278,11 @@ brig_langhook_type_for_mode (machine_mode mode, int unsignedp)\n       return NULL_TREE;\n     }\n \n-  enum mode_class mc = GET_MODE_CLASS (mode);\n-  if (mc == MODE_FLOAT)\n+  scalar_int_mode imode;\n+  scalar_float_mode fmode;\n+  if (is_int_mode (mode, &imode))\n     {\n-      switch (GET_MODE_BITSIZE (mode))\n+      switch (GET_MODE_BITSIZE (imode))\n \t{\n \tcase 32:\n \t  return float_type_node;\n@@ -290,15 +291,15 @@ brig_langhook_type_for_mode (machine_mode mode, int unsignedp)\n \tdefault:\n \t  /* We have to check for long double in order to support\n \t     i386 excess precision.  */\n-\t  if (mode == TYPE_MODE (long_double_type_node))\n+\t  if (imode == TYPE_MODE (long_double_type_node))\n \t    return long_double_type_node;\n \n \t  gcc_unreachable ();\n \t  return NULL_TREE;\n \t}\n     }\n-  else if (mc == MODE_INT)\n-    return brig_langhook_type_for_size(GET_MODE_BITSIZE(mode), unsignedp);\n+  else if (is_float_mode (mode, &fmode))\n+    return brig_langhook_type_for_size (GET_MODE_BITSIZE (fmode), unsignedp);\n   else\n     {\n       /* E.g., build_common_builtin_nodes () asks for modes/builtins"}]}