{"sha": "f1ec39c86c3a5523ec305cc05102ed1e6afbce9c", "node_id": "C_kwDOANBUbNoAKGYxZWMzOWM4NmMzYTU1MjNlYzMwNWNjMDUxMDJlZDFlNmFmYmNlOWM", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-11-25T13:41:50Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2021-11-26T13:55:12Z"}, "message": "d: fix ASAN in option processing\n\nFixes:\n\n==129444==ERROR: AddressSanitizer: global-buffer-overflow on address 0x00000666ca5c at pc 0x000000ef094b bp 0x7fffffff8180 sp 0x7fffffff8178\nREAD of size 4 at 0x00000666ca5c thread T0\n    #0 0xef094a in parse_optimize_options ../../gcc/d/d-attribs.cc:855\n    #1 0xef0d36 in d_handle_optimize_attribute ../../gcc/d/d-attribs.cc:916\n    #2 0xef107e in d_handle_optimize_attribute ../../gcc/d/d-attribs.cc:887\n    #3 0xff85b1 in decl_attributes(tree_node**, tree_node*, int, tree_node*) ../../gcc/attribs.c:829\n    #4 0xef2a91 in apply_user_attributes(Dsymbol*, tree_node*) ../../gcc/d/d-attribs.cc:427\n    #5 0xf7b7f3 in get_symbol_decl(Declaration*) ../../gcc/d/decl.cc:1346\n    #6 0xf87bc7 in get_symbol_decl(Declaration*) ../../gcc/d/decl.cc:967\n    #7 0xf87bc7 in DeclVisitor::visit(FuncDeclaration*) ../../gcc/d/decl.cc:808\n    #8 0xf83db5 in DeclVisitor::build_dsymbol(Dsymbol*) ../../gcc/d/decl.cc:146\n\nfor the following test-case: gcc/testsuite/gdc.dg/attr_optimize1.d.\n\ngcc/d/ChangeLog:\n\n\t* d-attribs.cc (parse_optimize_options): Check index before\n\taccessing cl_options.", "tree": {"sha": "b8f1896c813967bd86ac1a4fdccfb6d419fce87b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8f1896c813967bd86ac1a4fdccfb6d419fce87b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f1ec39c86c3a5523ec305cc05102ed1e6afbce9c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1ec39c86c3a5523ec305cc05102ed1e6afbce9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1ec39c86c3a5523ec305cc05102ed1e6afbce9c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1ec39c86c3a5523ec305cc05102ed1e6afbce9c/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2cadaa1f134beca5ec63544f185362c223bab590", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2cadaa1f134beca5ec63544f185362c223bab590", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2cadaa1f134beca5ec63544f185362c223bab590"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "1ec800526f7d0978ab513c21d80f2f57558dace2", "filename": "gcc/d/d-attribs.cc", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1ec39c86c3a5523ec305cc05102ed1e6afbce9c/gcc%2Fd%2Fd-attribs.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1ec39c86c3a5523ec305cc05102ed1e6afbce9c/gcc%2Fd%2Fd-attribs.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fd%2Fd-attribs.cc?ref=f1ec39c86c3a5523ec305cc05102ed1e6afbce9c", "patch": "@@ -852,7 +852,9 @@ parse_optimize_options (tree args)\n   unsigned j = 1;\n   for (unsigned i = 1; i < decoded_options_count; ++i)\n     {\n-      if (! (cl_options[decoded_options[i].opt_index].flags & CL_OPTIMIZATION))\n+      unsigned opt_index = decoded_options[i].opt_index;\n+      if (opt_index >= cl_options_count\n+\t  && ! (cl_options[opt_index].flags & CL_OPTIMIZATION))\n \t{\n \t  ret = false;\n \t  warning (OPT_Wattributes,"}]}