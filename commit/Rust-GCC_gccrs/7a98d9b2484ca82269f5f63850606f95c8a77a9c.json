{"sha": "7a98d9b2484ca82269f5f63850606f95c8a77a9c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2E5OGQ5YjI0ODRjYTgyMjY5ZjVmNjM4NTA2MDZmOTVjOGE3N2E5Yw==", "commit": {"author": {"name": "Kaveh R. Ghazi", "email": "ghazi@caip.rutgers.edu", "date": "2001-09-04T18:19:18Z"}, "committer": {"name": "Kaveh Ghazi", "email": "ghazi@gcc.gnu.org", "date": "2001-09-04T18:19:18Z"}, "message": "asprintf.c: Don't define USE_STDARG.\n\n\t* asprintf.c: Don't define USE_STDARG.  Use VPARAMS, VA_OPEN,\n\tVA_FIXEDARG & VA_CLOSE.\n\n\t* vasprintf.c: Check HAVE_STRING_H when including string.h.\n\t(checkit): Delete redundant prototype.  Add ATTRIBUTE_PRINTF_1.\n\tUse VA_OPEN, VA_FIXEDARG & VA_CLOSE.  Free allocated string.\n\nFrom-SVN: r45382", "tree": {"sha": "7713568cbdef36c81b9cfb7cd201c42fb338f89c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7713568cbdef36c81b9cfb7cd201c42fb338f89c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7a98d9b2484ca82269f5f63850606f95c8a77a9c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a98d9b2484ca82269f5f63850606f95c8a77a9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a98d9b2484ca82269f5f63850606f95c8a77a9c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a98d9b2484ca82269f5f63850606f95c8a77a9c/comments", "author": null, "committer": null, "parents": [{"sha": "9d6466593e9e7c8e241f93c7a158160be9440c39", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9d6466593e9e7c8e241f93c7a158160be9440c39", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9d6466593e9e7c8e241f93c7a158160be9440c39"}], "stats": {"total": 62, "additions": 25, "deletions": 37}, "files": [{"sha": "afeeaaf9bbb1a31933ba53e6abe7eaa0def220fc", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a98d9b2484ca82269f5f63850606f95c8a77a9c/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a98d9b2484ca82269f5f63850606f95c8a77a9c/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=7a98d9b2484ca82269f5f63850606f95c8a77a9c", "patch": "@@ -1,3 +1,12 @@\n+2001-09-04  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n+\n+\t* asprintf.c: Don't define USE_STDARG.  Use VPARAMS, VA_OPEN,\n+\tVA_FIXEDARG & VA_CLOSE.\n+\t\n+\t* vasprintf.c: Check HAVE_STRING_H when including string.h.\n+\t(checkit): Delete redundant prototype.  Add ATTRIBUTE_PRINTF_1.\n+\tUse VA_OPEN, VA_FIXEDARG & VA_CLOSE.  Free allocated string.\n+\n 2001-08-27  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* concat.c (concat): Use VPARAMS, VA_OPEN, VA_FIXEDARG & VA_CLOSE."}, {"sha": "e09af239ae7d6e45ff271e4bf3091c2634a00672", "filename": "libiberty/asprintf.c", "status": "modified", "additions": 6, "deletions": 22, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a98d9b2484ca82269f5f63850606f95c8a77a9c/libiberty%2Fasprintf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a98d9b2484ca82269f5f63850606f95c8a77a9c/libiberty%2Fasprintf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fasprintf.c?ref=7a98d9b2484ca82269f5f63850606f95c8a77a9c", "patch": "@@ -22,36 +22,20 @@ Boston, MA 02111-1307, USA.  */\n #include \"ansidecl.h\"\n #include \"libiberty.h\"\n \n-#if defined (ANSI_PROTOTYPES) || defined (ALMOST_STDC)\n-#define USE_STDARG\n-#endif\n-\n-#ifdef USE_STDARG\n+#ifdef ANSI_PROTOTYPES\n #include <stdarg.h>\n #else\n #include <varargs.h>\n #endif\n \n-/* VARARGS */\n-#ifdef USE_STDARG\n-int\n-asprintf (char **buf, const char *fmt, ...)\n-#else\n int\n-asprintf (buf, fmt, va_alist)\n-     char **buf;\n-     const char *fmt;\n-     va_dcl\n-#endif\n+asprintf VPARAMS ((char **buf, const char *fmt, ...))\n {\n   int status;\n-  va_list ap;\n-#ifdef USE_STDARG\n-  va_start (ap, fmt);\n-#else\n-  va_start (ap);\n-#endif\n+  VA_OPEN (ap, fmt);\n+  VA_FIXEDARG (ap, char **, buf);\n+  VA_FIXEDARG (ap, const char *, fmt);\n   status = vasprintf (buf, fmt, ap);\n-  va_end (ap);\n+  VA_CLOSE (ap);\n   return status;\n }"}, {"sha": "32faa84a4a2c609c22d7d126fa966c528ae90382", "filename": "libiberty/vasprintf.c", "status": "modified", "additions": 10, "deletions": 15, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7a98d9b2484ca82269f5f63850606f95c8a77a9c/libiberty%2Fvasprintf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7a98d9b2484ca82269f5f63850606f95c8a77a9c/libiberty%2Fvasprintf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fvasprintf.c?ref=7a98d9b2484ca82269f5f63850606f95c8a77a9c", "patch": "@@ -28,7 +28,9 @@ Boston, MA 02111-1307, USA.  */\n #include <varargs.h>\n #endif\n #include <stdio.h>\n+#ifdef HAVE_STRING_H\n #include <string.h>\n+#endif\n #ifdef HAVE_STDLIB_H\n #include <stdlib.h>\n #else\n@@ -142,29 +144,22 @@ vasprintf (result, format, args)\n }\n \n #ifdef TEST\n-static void checkit PARAMS ((const char *, ...));\n-\n-static void\n-checkit VPARAMS ((const char* format, ...))\n+static void ATTRIBUTE_PRINTF_1\n+checkit VPARAMS ((const char *format, ...))\n {\n-  va_list args;\n   char *result;\n-#ifndef ANSI_PROTOTYPES\n-  const char *format;\n-#endif\n-\n-  VA_START (args, format);\n-\n-#ifndef ANSI_PROTOTYPES\n-  format = va_arg (args, const char *);\n-#endif\n-\n+  VA_OPEN (args, format);\n+  VA_FIXEDARG (args, const char *, format);\n   vasprintf (&result, format, args);\n+  VA_CLOSE (args);\n+\n   if (strlen (result) < (size_t) global_total_width)\n     printf (\"PASS: \");\n   else\n     printf (\"FAIL: \");\n   printf (\"%d %s\\n\", global_total_width, result);\n+\n+  free (result);\n }\n \n extern int main PARAMS ((void));"}]}