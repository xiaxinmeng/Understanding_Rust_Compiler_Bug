{"sha": "70635f1e0498a195a36e1b49521bbac05fc9a363", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzA2MzVmMWUwNDk4YTE5NWEzNmUxYjQ5NTIxYmJhYzA1ZmM5YTM2Mw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2000-04-27T00:43:33Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2000-04-27T00:43:33Z"}, "message": "<<<<<<< ChangeLog\n2000-04-26  Jakub Jelinek  <jakub@redhat.com>\n\n\t* gcconfig.h (SPARC): Define ALIGNMENT to 8 for 64bit SPARC.\n\t(SPARC/LINUX): Use GC_SysVGetDataStart instead of LINUX_DATA_START\n\t- sparc glibc does not provide it.\n\t(SAVE_CALL_CHAIN, ASM_CLEAR_CODE): Define on sparc*-linux*.\n\tMake STACKBOTTOM depend on the wordsize.\n\t* os_dep.c (GC_SysVGetDataStart): Compile in on sparc*-linux*.\n\t(struct frame): Declare on sparc*-linux*.\n\t(GC_save_callers): Bias the frame pointers if needed (sparc64).\n\t* mach_dep.c (GC_save_regs_in_stack): Optimize on sparc32.\n\tImplement on sparc64.\n\t(GC_clear_stack_inner): Implement on sparc64.\n\t* gc_priv.h (GC_test_and_set): Implement for sparc.\n\t* linux_threads.c (GC_suspend_handler, GC_push_all_stacks): Use\n\nFrom-SVN: r33452", "tree": {"sha": "86e32819d7f591c74fbd972b3aec948512e9ec6b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/86e32819d7f591c74fbd972b3aec948512e9ec6b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/70635f1e0498a195a36e1b49521bbac05fc9a363", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/70635f1e0498a195a36e1b49521bbac05fc9a363", "html_url": "https://github.com/Rust-GCC/gccrs/commit/70635f1e0498a195a36e1b49521bbac05fc9a363", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/70635f1e0498a195a36e1b49521bbac05fc9a363/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f1acc01e2d1d2d83397d9283569638e5680b0304", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1acc01e2d1d2d83397d9283569638e5680b0304", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1acc01e2d1d2d83397d9283569638e5680b0304"}], "stats": {"total": 308, "additions": 206, "deletions": 102}, "files": [{"sha": "c2aa927082915c4edfdb2cacca292fde451b8ba0", "filename": "boehm-gc/ChangeLog", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2FChangeLog?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -1,3 +1,21 @@\n+<<<<<<< ChangeLog\n+2000-04-26  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* gcconfig.h (SPARC): Define ALIGNMENT to 8 for 64bit SPARC.\n+\t(SPARC/LINUX): Use GC_SysVGetDataStart instead of LINUX_DATA_START\n+\t- sparc glibc does not provide it.\n+\t(SAVE_CALL_CHAIN, ASM_CLEAR_CODE): Define on sparc*-linux*.\n+\tMake STACKBOTTOM depend on the wordsize.\n+\t* os_dep.c (GC_SysVGetDataStart): Compile in on sparc*-linux*.\n+\t(struct frame): Declare on sparc*-linux*.\n+\t(GC_save_callers): Bias the frame pointers if needed (sparc64).\n+\t* mach_dep.c (GC_save_regs_in_stack): Optimize on sparc32.\n+\tImplement on sparc64.\n+\t(GC_clear_stack_inner): Implement on sparc64.\n+\t* gc_priv.h (GC_test_and_set): Implement for sparc.\n+\t* linux_threads.c (GC_suspend_handler, GC_push_all_stacks): Use\n+\tGC_save_regs_in_stack on sparc.\n+\n 2000-04-23  Tom Tromey  <tromey@cygnus.com>\n \n \t* gcconfig.h (DYNAMIC_LOADING): Define for PPC Linux."}, {"sha": "9ea3aa4523c01abc66a1503dcc2d77c729e67dfd", "filename": "boehm-gc/Makefile.in", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2FMakefile.in?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -74,13 +74,11 @@ CXXINCLUDES = @CXXINCLUDES@\n DLLTOOL = @DLLTOOL@\n EXEEXT = @EXEEXT@\n INCLUDES = @INCLUDES@\n-LD = @LD@\n LIBTOOL = @LIBTOOL@\n LN_S = @LN_S@\n MAINT = @MAINT@\n MAKEINFO = @MAKEINFO@\n MY_CFLAGS = @MY_CFLAGS@\n-NM = @NM@\n OBJDUMP = @OBJDUMP@\n PACKAGE = @PACKAGE@\n RANLIB = @RANLIB@"}, {"sha": "879db9632fbf65dbcf22ef5772bb311997bc7fc6", "filename": "boehm-gc/aclocal.m4", "status": "modified", "additions": 8, "deletions": 5, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Faclocal.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Faclocal.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Faclocal.m4?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -307,7 +307,7 @@ LD=\"$LD\" LDFLAGS=\"$LDFLAGS\" LIBS=\"$LIBS\" \\\n LN_S=\"$LN_S\" NM=\"$NM\" RANLIB=\"$RANLIB\" \\\n DLLTOOL=\"$DLLTOOL\" AS=\"$AS\" OBJDUMP=\"$OBJDUMP\" \\\n ${CONFIG_SHELL-/bin/sh} $ac_aux_dir/ltconfig --no-reexec \\\n-$libtool_flags --no-verify $ac_aux_dir/ltmain.sh $host \\\n+$libtool_flags --no-verify $ac_aux_dir/ltmain.sh $lt_target \\\n || AC_MSG_ERROR([libtool configure failed])\n \n # Reload cache, that may have been modified by ltconfig\n@@ -339,6 +339,11 @@ AC_REQUIRE([AC_PROG_NM])dnl\n AC_REQUIRE([AC_PROG_LN_S])dnl\n dnl\n \n+case \"$target\" in\n+NONE) lt_target=\"$host\" ;;\n+*) lt_target=\"$target\" ;;\n+esac\n+\n # Check for any special flags to pass to ltconfig.\n libtool_flags=\"--cache-file=$cache_file\"\n test \"$enable_shared\" = no && libtool_flags=\"$libtool_flags --disable-shared\"\n@@ -357,7 +362,7 @@ test x\"$silent\" = xyes && libtool_flags=\"$libtool_flags --silent\"\n \n # Some flags need to be propagated to the compiler or linker for good\n # libtool support.\n-case \"$host\" in\n+case \"$lt_target\" in\n *-*-irix6*)\n   # Find out which ABI we are using.\n   echo '[#]line __oline__ \"configure\"' > conftest.$ac_ext\n@@ -573,7 +578,6 @@ else\n   AC_MSG_RESULT(no)\n fi\n test -z \"$LD\" && AC_MSG_ERROR([no acceptable ld found in \\$PATH])\n-AC_SUBST(LD)\n AC_PROG_LD_GNU\n ])\n \n@@ -619,14 +623,13 @@ else\n fi])\n NM=\"$ac_cv_path_NM\"\n AC_MSG_RESULT([$NM])\n-AC_SUBST(NM)\n ])\n \n # AC_CHECK_LIBM - check for math library\n AC_DEFUN(AC_CHECK_LIBM,\n [AC_REQUIRE([AC_CANONICAL_HOST])dnl\n LIBM=\n-case \"$host\" in\n+case \"$lt_target\" in\n *-*-beos* | *-*-cygwin*)\n   # These system don't have libm\n   ;;"}, {"sha": "5f3ab6553301cd496609b3f91fadbe563378e1a6", "filename": "boehm-gc/configure", "status": "modified", "additions": 76, "deletions": 64, "changes": 140, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fconfigure?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -57,6 +57,7 @@ program_suffix=NONE\n program_transform_name=s,x,x,\n silent=\n site=\n+sitefile=\n srcdir=\n target=NONE\n verbose=\n@@ -171,6 +172,7 @@ Configuration:\n   --help                  print this message\n   --no-create             do not create output files\n   --quiet, --silent       do not print \\`checking...' messages\n+  --site-file=FILE        use FILE as the site file\n   --version               print the version of autoconf that created configure\n Directory and file names:\n   --prefix=PREFIX         install architecture-independent files in PREFIX\n@@ -341,6 +343,11 @@ EOF\n   -site=* | --site=* | --sit=*)\n     site=\"$ac_optarg\" ;;\n \n+  -site-file | --site-file | --site-fil | --site-fi | --site-f)\n+    ac_prev=sitefile ;;\n+  -site-file=* | --site-file=* | --site-fil=* | --site-fi=* | --site-f=*)\n+    sitefile=\"$ac_optarg\" ;;\n+\n   -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)\n     ac_prev=srcdir ;;\n   -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)\n@@ -506,12 +513,16 @@ fi\n srcdir=`echo \"${srcdir}\" | sed 's%\\([^/]\\)/*$%\\1%'`\n \n # Prefer explicitly selected file to automatically selected ones.\n-if test -z \"$CONFIG_SITE\"; then\n-  if test \"x$prefix\" != xNONE; then\n-    CONFIG_SITE=\"$prefix/share/config.site $prefix/etc/config.site\"\n-  else\n-    CONFIG_SITE=\"$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site\"\n+if test -z \"$sitefile\"; then\n+  if test -z \"$CONFIG_SITE\"; then\n+    if test \"x$prefix\" != xNONE; then\n+      CONFIG_SITE=\"$prefix/share/config.site $prefix/etc/config.site\"\n+    else\n+      CONFIG_SITE=\"$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site\"\n+    fi\n   fi\n+else\n+  CONFIG_SITE=\"$sitefile\"\n fi\n for ac_site_file in $CONFIG_SITE; do\n   if test -r \"$ac_site_file\"; then\n@@ -599,7 +610,7 @@ else { echo \"configure: error: can not run $ac_config_sub\" 1>&2; exit 1; }\n fi\n \n echo $ac_n \"checking host system type\"\"... $ac_c\" 1>&6\n-echo \"configure:603: checking host system type\" >&5\n+echo \"configure:614: checking host system type\" >&5\n \n host_alias=$host\n case \"$host_alias\" in\n@@ -620,7 +631,7 @@ host_os=`echo $host | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n echo \"$ac_t\"\"$host\" 1>&6\n \n echo $ac_n \"checking target system type\"\"... $ac_c\" 1>&6\n-echo \"configure:624: checking target system type\" >&5\n+echo \"configure:635: checking target system type\" >&5\n \n target_alias=$target\n case \"$target_alias\" in\n@@ -638,7 +649,7 @@ target_os=`echo $target | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n echo \"$ac_t\"\"$target\" 1>&6\n \n echo $ac_n \"checking build system type\"\"... $ac_c\" 1>&6\n-echo \"configure:642: checking build system type\" >&5\n+echo \"configure:653: checking build system type\" >&5\n \n build_alias=$build\n case \"$build_alias\" in\n@@ -673,7 +684,7 @@ test \"$host_alias\" != \"$target_alias\" &&\n # SVR4 /usr/ucb/install, which tries to use the nonexistent group \"staff\"\n # ./install, which can be erroneously created by make from ./install.sh.\n echo $ac_n \"checking for a BSD compatible install\"\"... $ac_c\" 1>&6\n-echo \"configure:677: checking for a BSD compatible install\" >&5\n+echo \"configure:688: checking for a BSD compatible install\" >&5\n if test -z \"$INSTALL\"; then\n if eval \"test \\\"`echo '$''{'ac_cv_path_install'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -726,7 +737,7 @@ test -z \"$INSTALL_SCRIPT\" && INSTALL_SCRIPT='${INSTALL_PROGRAM}'\n test -z \"$INSTALL_DATA\" && INSTALL_DATA='${INSTALL} -m 644'\n \n echo $ac_n \"checking whether build environment is sane\"\"... $ac_c\" 1>&6\n-echo \"configure:730: checking whether build environment is sane\" >&5\n+echo \"configure:741: checking whether build environment is sane\" >&5\n # Just in case\n sleep 1\n echo timestamp > conftestfile\n@@ -783,7 +794,7 @@ test \"$program_suffix\" != NONE &&\n test \"$program_transform_name\" = \"\" && program_transform_name=\"s,x,x,\"\n \n echo $ac_n \"checking whether ${MAKE-make} sets \\${MAKE}\"\"... $ac_c\" 1>&6\n-echo \"configure:787: checking whether ${MAKE-make} sets \\${MAKE}\" >&5\n+echo \"configure:798: checking whether ${MAKE-make} sets \\${MAKE}\" >&5\n set dummy ${MAKE-make}; ac_make=`echo \"$2\" | sed 'y%./+-%__p_%'`\n if eval \"test \\\"`echo '$''{'ac_cv_prog_make_${ac_make}_set'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -816,12 +827,12 @@ else\n fi\n \n echo $ac_n \"checking for Cygwin environment\"\"... $ac_c\" 1>&6\n-echo \"configure:820: checking for Cygwin environment\" >&5\n+echo \"configure:831: checking for Cygwin environment\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_cygwin'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 825 \"configure\"\n+#line 836 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n@@ -832,7 +843,7 @@ int main() {\n return __CYGWIN__;\n ; return 0; }\n EOF\n-if { (eval echo configure:836: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:847: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_cygwin=yes\n else\n@@ -849,19 +860,19 @@ echo \"$ac_t\"\"$ac_cv_cygwin\" 1>&6\n CYGWIN=\n test \"$ac_cv_cygwin\" = yes && CYGWIN=yes\n echo $ac_n \"checking for mingw32 environment\"\"... $ac_c\" 1>&6\n-echo \"configure:853: checking for mingw32 environment\" >&5\n+echo \"configure:864: checking for mingw32 environment\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_mingw32'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 858 \"configure\"\n+#line 869 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n return __MINGW32__;\n ; return 0; }\n EOF\n-if { (eval echo configure:865: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:876: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_mingw32=yes\n else\n@@ -909,7 +920,7 @@ else { echo \"configure: error: can not run $ac_config_sub\" 1>&2; exit 1; }\n fi\n \n echo $ac_n \"checking host system type\"\"... $ac_c\" 1>&6\n-echo \"configure:913: checking host system type\" >&5\n+echo \"configure:924: checking host system type\" >&5\n \n host_alias=$host\n case \"$host_alias\" in\n@@ -933,7 +944,7 @@ echo \"$ac_t\"\"$host\" 1>&6\n \n PACKAGE=boehm-gc\n \n-VERSION=5.0a4\n+VERSION=5.0a6\n \n if test \"`cd $srcdir && pwd`\" != \"`pwd`\" && test -f $srcdir/config.status; then\n   { echo \"configure: error: source directory already configured; run \"make distclean\" there first\" 1>&2; exit 1; }\n@@ -943,7 +954,7 @@ fi\n \n missing_dir=`cd $ac_aux_dir && pwd`\n echo $ac_n \"checking for working aclocal\"\"... $ac_c\" 1>&6\n-echo \"configure:947: checking for working aclocal\" >&5\n+echo \"configure:958: checking for working aclocal\" >&5\n # Run test in a subshell; some versions of sh will print an error if\n # an executable is not found, even if stderr is redirected.\n # Redirect stdin to placate older versions of autoconf.  Sigh.\n@@ -956,7 +967,7 @@ else\n fi\n \n echo $ac_n \"checking for working autoconf\"\"... $ac_c\" 1>&6\n-echo \"configure:960: checking for working autoconf\" >&5\n+echo \"configure:971: checking for working autoconf\" >&5\n # Run test in a subshell; some versions of sh will print an error if\n # an executable is not found, even if stderr is redirected.\n # Redirect stdin to placate older versions of autoconf.  Sigh.\n@@ -969,7 +980,7 @@ else\n fi\n \n echo $ac_n \"checking for working automake\"\"... $ac_c\" 1>&6\n-echo \"configure:973: checking for working automake\" >&5\n+echo \"configure:984: checking for working automake\" >&5\n # Run test in a subshell; some versions of sh will print an error if\n # an executable is not found, even if stderr is redirected.\n # Redirect stdin to placate older versions of autoconf.  Sigh.\n@@ -982,7 +993,7 @@ else\n fi\n \n echo $ac_n \"checking for working autoheader\"\"... $ac_c\" 1>&6\n-echo \"configure:986: checking for working autoheader\" >&5\n+echo \"configure:997: checking for working autoheader\" >&5\n # Run test in a subshell; some versions of sh will print an error if\n # an executable is not found, even if stderr is redirected.\n # Redirect stdin to placate older versions of autoconf.  Sigh.\n@@ -995,7 +1006,7 @@ else\n fi\n \n echo $ac_n \"checking for working makeinfo\"\"... $ac_c\" 1>&6\n-echo \"configure:999: checking for working makeinfo\" >&5\n+echo \"configure:1010: checking for working makeinfo\" >&5\n # Run test in a subshell; some versions of sh will print an error if\n # an executable is not found, even if stderr is redirected.\n # Redirect stdin to placate older versions of autoconf.  Sigh.\n@@ -1021,7 +1032,7 @@ fi\n # Extract the first word of \"gcc\", so it can be a program name with args.\n set dummy gcc; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1025: checking for $ac_word\" >&5\n+echo \"configure:1036: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1051,7 +1062,7 @@ if test -z \"$CC\"; then\n   # Extract the first word of \"cc\", so it can be a program name with args.\n set dummy cc; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1055: checking for $ac_word\" >&5\n+echo \"configure:1066: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1100,7 +1111,7 @@ fi\n fi\n \n echo $ac_n \"checking whether we are using GNU C\"\"... $ac_c\" 1>&6\n-echo \"configure:1104: checking whether we are using GNU C\" >&5\n+echo \"configure:1115: checking whether we are using GNU C\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_gcc'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1109,7 +1120,7 @@ else\n   yes;\n #endif\n EOF\n-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1113: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1124: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n   ac_cv_prog_gcc=yes\n else\n   ac_cv_prog_gcc=no\n@@ -1124,7 +1135,7 @@ if test $ac_cv_prog_gcc = yes; then\n   ac_save_CFLAGS=\"$CFLAGS\"\n   CFLAGS=\n   echo $ac_n \"checking whether ${CC-cc} accepts -g\"\"... $ac_c\" 1>&6\n-echo \"configure:1128: checking whether ${CC-cc} accepts -g\" >&5\n+echo \"configure:1139: checking whether ${CC-cc} accepts -g\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_cc_g'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1161,7 +1172,7 @@ do\n # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n set dummy $ac_prog; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1165: checking for $ac_word\" >&5\n+echo \"configure:1176: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CXX'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1194,7 +1205,7 @@ test -n \"$CXX\" || CXX=\"gcc\"\n test -z \"$CXX\" && { echo \"configure: error: no acceptable c++ found in \\$PATH\" 1>&2; exit 1; }\n \n echo $ac_n \"checking whether we are using GNU C++\"\"... $ac_c\" 1>&6\n-echo \"configure:1198: checking whether we are using GNU C++\" >&5\n+echo \"configure:1209: checking whether we are using GNU C++\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_gxx'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1203,7 +1214,7 @@ else\n   yes;\n #endif\n EOF\n-if { ac_try='${CXX-g++} -E conftest.C'; { (eval echo configure:1207: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n+if { ac_try='${CXX-g++} -E conftest.C'; { (eval echo configure:1218: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n   ac_cv_prog_gxx=yes\n else\n   ac_cv_prog_gxx=no\n@@ -1218,7 +1229,7 @@ if test $ac_cv_prog_gxx = yes; then\n   ac_save_CXXFLAGS=\"$CXXFLAGS\"\n   CXXFLAGS=\n   echo $ac_n \"checking whether ${CXX-g++} accepts -g\"\"... $ac_c\" 1>&6\n-echo \"configure:1222: checking whether ${CXX-g++} accepts -g\" >&5\n+echo \"configure:1233: checking whether ${CXX-g++} accepts -g\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_cxx_g'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1251,7 +1262,7 @@ fi\n # NEWLIB_CONFIGURE, which doesn't work because that means that it will\n # be run before AC_CANONICAL_HOST.\n echo $ac_n \"checking build system type\"\"... $ac_c\" 1>&6\n-echo \"configure:1255: checking build system type\" >&5\n+echo \"configure:1266: checking build system type\" >&5\n \n build_alias=$build\n case \"$build_alias\" in\n@@ -1272,7 +1283,7 @@ echo \"$ac_t\"\"$build\" 1>&6\n # Extract the first word of \"${ac_tool_prefix}as\", so it can be a program name with args.\n set dummy ${ac_tool_prefix}as; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1276: checking for $ac_word\" >&5\n+echo \"configure:1287: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AS'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1304,7 +1315,7 @@ fi\n # Extract the first word of \"${ac_tool_prefix}ar\", so it can be a program name with args.\n set dummy ${ac_tool_prefix}ar; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1308: checking for $ac_word\" >&5\n+echo \"configure:1319: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AR'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1336,7 +1347,7 @@ fi\n # Extract the first word of \"${ac_tool_prefix}ranlib\", so it can be a program name with args.\n set dummy ${ac_tool_prefix}ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1340: checking for $ac_word\" >&5\n+echo \"configure:1351: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1368,7 +1379,7 @@ if test -n \"$ac_tool_prefix\"; then\n   # Extract the first word of \"ranlib\", so it can be a program name with args.\n set dummy ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1372: checking for $ac_word\" >&5\n+echo \"configure:1383: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1413,7 +1424,7 @@ fi\n # SVR4 /usr/ucb/install, which tries to use the nonexistent group \"staff\"\n # ./install, which can be erroneously created by make from ./install.sh.\n echo $ac_n \"checking for a BSD compatible install\"\"... $ac_c\" 1>&6\n-echo \"configure:1417: checking for a BSD compatible install\" >&5\n+echo \"configure:1428: checking for a BSD compatible install\" >&5\n if test -z \"$INSTALL\"; then\n if eval \"test \\\"`echo '$''{'ac_cv_path_install'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -1467,7 +1478,7 @@ test -z \"$INSTALL_DATA\" && INSTALL_DATA='${INSTALL} -m 644'\n \n \n echo $ac_n \"checking whether to enable maintainer-specific portions of Makefiles\"\"... $ac_c\" 1>&6\n-echo \"configure:1471: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n+echo \"configure:1482: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n     # Check whether --enable-maintainer-mode or --disable-maintainer-mode was given.\n if test \"${enable_maintainer_mode+set}\" = set; then\n   enableval=\"$enable_maintainer_mode\"\n@@ -1501,7 +1512,7 @@ if false; then\n   \n \n echo $ac_n \"checking for executable suffix\"\"... $ac_c\" 1>&6\n-echo \"configure:1505: checking for executable suffix\" >&5\n+echo \"configure:1516: checking for executable suffix\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_exeext'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1511,7 +1522,7 @@ else\n   rm -f conftest*\n   echo 'int main () { return 0; }' > conftest.$ac_ext\n   ac_cv_exeext=\n-  if { (eval echo configure:1515: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; }; then\n+  if { (eval echo configure:1526: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; }; then\n     for file in conftest.*; do\n       case $file in\n       *.c | *.o | *.obj | *.ilk | *.pdb) ;;\n@@ -1625,7 +1636,7 @@ fi\n # Extract the first word of \"ranlib\", so it can be a program name with args.\n set dummy ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1629: checking for $ac_word\" >&5\n+echo \"configure:1640: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1664,7 +1675,7 @@ ac_prog=ld\n if test \"$ac_cv_prog_gcc\" = yes; then\n   # Check if gcc -print-prog-name=ld gives a path.\n   echo $ac_n \"checking for ld used by GCC\"\"... $ac_c\" 1>&6\n-echo \"configure:1668: checking for ld used by GCC\" >&5\n+echo \"configure:1679: checking for ld used by GCC\" >&5\n   ac_prog=`($CC -print-prog-name=ld) 2>&5`\n   case \"$ac_prog\" in\n     # Accept absolute paths.\n@@ -1688,10 +1699,10 @@ echo \"configure:1668: checking for ld used by GCC\" >&5\n   esac\n elif test \"$with_gnu_ld\" = yes; then\n   echo $ac_n \"checking for GNU ld\"\"... $ac_c\" 1>&6\n-echo \"configure:1692: checking for GNU ld\" >&5\n+echo \"configure:1703: checking for GNU ld\" >&5\n else\n   echo $ac_n \"checking for non-GNU ld\"\"... $ac_c\" 1>&6\n-echo \"configure:1695: checking for non-GNU ld\" >&5\n+echo \"configure:1706: checking for non-GNU ld\" >&5\n fi\n if eval \"test \\\"`echo '$''{'ac_cv_path_LD'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -1725,9 +1736,8 @@ else\n   echo \"$ac_t\"\"no\" 1>&6\n fi\n test -z \"$LD\" && { echo \"configure: error: no acceptable ld found in \\$PATH\" 1>&2; exit 1; }\n-\n echo $ac_n \"checking if the linker ($LD) is GNU ld\"\"... $ac_c\" 1>&6\n-echo \"configure:1731: checking if the linker ($LD) is GNU ld\" >&5\n+echo \"configure:1741: checking if the linker ($LD) is GNU ld\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_gnu_ld'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1743,7 +1753,7 @@ echo \"$ac_t\"\"$ac_cv_prog_gnu_ld\" 1>&6\n \n \n echo $ac_n \"checking for BSD-compatible nm\"\"... $ac_c\" 1>&6\n-echo \"configure:1747: checking for BSD-compatible nm\" >&5\n+echo \"configure:1757: checking for BSD-compatible nm\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_NM'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1778,9 +1788,8 @@ fi\n NM=\"$ac_cv_path_NM\"\n echo \"$ac_t\"\"$NM\" 1>&6\n \n-\n echo $ac_n \"checking whether ln -s works\"\"... $ac_c\" 1>&6\n-echo \"configure:1784: checking whether ln -s works\" >&5\n+echo \"configure:1793: checking whether ln -s works\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_LN_S'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1801,6 +1810,11 @@ else\n fi\n \n \n+case \"$target\" in\n+NONE) lt_target=\"$host\" ;;\n+*) lt_target=\"$target\" ;;\n+esac\n+\n # Check for any special flags to pass to ltconfig.\n libtool_flags=\"--cache-file=$cache_file\"\n test \"$enable_shared\" = no && libtool_flags=\"$libtool_flags --disable-shared\"\n@@ -1821,11 +1835,11 @@ test x\"$silent\" = xyes && libtool_flags=\"$libtool_flags --silent\"\n \n # Some flags need to be propagated to the compiler or linker for good\n # libtool support.\n-case \"$host\" in\n+case \"$lt_target\" in\n *-*-irix6*)\n   # Find out which ABI we are using.\n-  echo '#line 1828 \"configure\"' > conftest.$ac_ext\n-  if { (eval echo configure:1829: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+  echo '#line 1842 \"configure\"' > conftest.$ac_ext\n+  if { (eval echo configure:1843: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n     case \"`/usr/bin/file conftest.o`\" in\n     *32-bit*)\n       LD=\"${LD-ld} -32\"\n@@ -1846,19 +1860,19 @@ case \"$host\" in\n   SAVE_CFLAGS=\"$CFLAGS\"\n   CFLAGS=\"$CFLAGS -belf\"\n   echo $ac_n \"checking whether the C compiler needs -belf\"\"... $ac_c\" 1>&6\n-echo \"configure:1850: checking whether the C compiler needs -belf\" >&5\n+echo \"configure:1864: checking whether the C compiler needs -belf\" >&5\n if eval \"test \\\"`echo '$''{'lt_cv_cc_needs_belf'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1855 \"configure\"\n+#line 1869 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n \n ; return 0; }\n EOF\n-if { (eval echo configure:1862: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:1876: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   lt_cv_cc_needs_belf=yes\n else\n@@ -1936,7 +1950,7 @@ LD=\"$LD\" LDFLAGS=\"$LDFLAGS\" LIBS=\"$LIBS\" \\\n LN_S=\"$LN_S\" NM=\"$NM\" RANLIB=\"$RANLIB\" \\\n DLLTOOL=\"$DLLTOOL\" AS=\"$AS\" OBJDUMP=\"$OBJDUMP\" \\\n ${CONFIG_SHELL-/bin/sh} $ac_aux_dir/ltconfig --no-reexec \\\n-$libtool_flags --no-verify $ac_aux_dir/ltmain.sh $host \\\n+$libtool_flags --no-verify $ac_aux_dir/ltmain.sh $lt_target \\\n || { echo \"configure: error: libtool configure failed\" 1>&2; exit 1; }\n \n # Reload cache, that may have been modified by ltconfig\n@@ -1974,7 +1988,7 @@ fi\n \n \n echo $ac_n \"checking whether to enable maintainer-specific portions of Makefiles\"\"... $ac_c\" 1>&6\n-echo \"configure:1978: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n+echo \"configure:1992: checking whether to enable maintainer-specific portions of Makefiles\" >&5\n     # Check whether --enable-maintainer-mode or --disable-maintainer-mode was given.\n if test \"${enable_maintainer_mode+set}\" = set; then\n   enableval=\"$enable_maintainer_mode\"\n@@ -2003,7 +2017,7 @@ if test \"x\" = \"y\"; then\n    \n \n echo $ac_n \"checking for executable suffix\"\"... $ac_c\" 1>&6\n-echo \"configure:2007: checking for executable suffix\" >&5\n+echo \"configure:2021: checking for executable suffix\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_exeext'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2013,7 +2027,7 @@ else\n   rm -f conftest*\n   echo 'int main () { return 0; }' > conftest.$ac_ext\n   ac_cv_exeext=\n-  if { (eval echo configure:2017: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; }; then\n+  if { (eval echo configure:2031: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; }; then\n     for file in conftest.*; do\n       case $file in\n       *.c | *.o | *.obj | *.ilk | *.pdb) ;;\n@@ -2036,7 +2050,7 @@ ac_exeext=$EXEEXT\n fi\n \n echo $ac_n \"checking for threads package to use\"\"... $ac_c\" 1>&6\n-echo \"configure:2040: checking for threads package to use\" >&5\n+echo \"configure:2054: checking for threads package to use\" >&5\n # Check whether --enable-threads or --disable-threads was given.\n if test \"${enable_threads+set}\" = set; then\n   enableval=\"$enable_threads\"\n@@ -2458,8 +2472,6 @@ s%@MAINTAINER_MODE_FALSE@%$MAINTAINER_MODE_FALSE%g\n s%@MAINT@%$MAINT%g\n s%@EXEEXT@%$EXEEXT%g\n s%@BOEHM_GC_CFLAGS@%$BOEHM_GC_CFLAGS%g\n-s%@LD@%$LD%g\n-s%@NM@%$NM%g\n s%@LN_S@%$LN_S%g\n s%@LIBTOOL@%$LIBTOOL%g\n s%@THREADLIB@%$THREADLIB%g"}, {"sha": "f26d485ea5741a959e4349e8d8ebc877de95b2a8", "filename": "boehm-gc/gc_priv.h", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fgc_priv.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fgc_priv.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fgc_priv.h?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -439,7 +439,7 @@ void GC_print_callers (/* struct callinfo info[NFRAMES] */);\n #  endif\n #  if defined(LINUX_THREADS) \n #   if defined(I386)|| defined(POWERPC) || defined(ALPHA) || defined(IA64) \\\n-    || defined(M68K)\n+    || defined(M68K) || defined(SPARC)\n #    include <pthread.h>\n #    define USE_SPIN_LOCK\n #    if defined(I386)\n@@ -465,6 +465,16 @@ void GC_print_callers (/* struct callinfo info[NFRAMES] */);\n        }\n #      define GC_CLEAR_DEFINED\n #    endif\n+#    ifdef SPARC\n+       inline static int GC_test_and_set(volatile unsigned int *addr) {\n+\t int oldval;\n+\n+\t __asm__ __volatile__(\"ldstub %1,%0\"\n+\t : \"=r\"(oldval), \"=m\"(*addr)\n+\t : \"m\"(*addr));\n+\t return oldval;\n+       }\n+#    endif\n #    ifdef M68K\n        /* Contributed by Tony Mantler.  I'm not sure how well it was\t*/\n        /* tested.\t\t\t\t\t\t\t*/"}, {"sha": "49b0fb03627ad70898008a04d0cd246f26b65d7f", "filename": "boehm-gc/gcconfig.h", "status": "modified", "additions": 18, "deletions": 7, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fgcconfig.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fgcconfig.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fgcconfig.h?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -326,8 +326,8 @@\n                     /*\t\t   RT\t      ==> IBM PC/RT\t\t*/\n                     /*\t\t   HP_PA      ==> HP9000/700 & /800\t*/\n                     /*\t\t\t\t  HP/UX\t\t\t*/\n-\t\t    /*\t\t   SPARC      ==> SPARC under SunOS\t*/\n-\t\t    /*\t\t\t(SUNOS4, SUNOS5,\t\t*/\n+\t\t    /*\t\t   SPARC      ==> SPARC\tv7/v8/v9\t*/\n+\t\t    /*\t\t\t(SUNOS4, SUNOS5, LINUX,\t\t*/\n \t\t    /*\t\t\t DRSNX variants)\t\t*/\n \t\t    /* \t\t   ALPHA      ==> DEC Alpha \t\t*/\n \t\t    /*\t\t\t(OSF1 and LINUX variants)\t*/\n@@ -595,7 +595,11 @@\n \n # ifdef SPARC\n #   define MACH_TYPE \"SPARC\"\n-#   define ALIGNMENT 4\t/* Required by hardware\t*/\n+#   if defined(__arch64__) || defined(__sparcv9)\n+#     define ALIGNMENT 8\n+#   else\n+#     define ALIGNMENT 4\t/* Required by hardware\t*/\n+#   endif\n #   define ALIGN_DOUBLE\n     extern int etext;\n #   ifdef SUNOS5\n@@ -656,15 +660,22 @@\n #   ifdef LINUX\n #     define OS_TYPE \"LINUX\"\n #     ifdef __ELF__\n-#       define LINUX_DATA_START\n #       define DYNAMIC_LOADING\n #     else\n-          Linux Sparc non elf ?\n+          Linux Sparc/a.out not supported\n #     endif\n+      extern int _etext;\n       extern int _end;\n #     define DATAEND (&_end)\n #     define SVR4\n-#     define STACKBOTTOM ((ptr_t) 0xf0000000)\n+#     ifdef __arch64__\n+#       define STACKBOTTOM ((ptr_t) 0x80000000000ULL)\n+#\tdefine DATASTART (ptr_t)GC_SysVGetDataStart(0x100000, &_etext)\n+#\tdefine CPP_WORDSZ 64\n+#     else\n+#       define STACKBOTTOM ((ptr_t) 0xf0000000)\n+#\tdefine DATASTART (ptr_t)GC_SysVGetDataStart(0x10000, &_etext)\n+#     endif\n #   endif\n #   ifdef OPENBSD\n #     define OS_TYPE \"OPENBSD\"\n@@ -1331,7 +1342,7 @@\n \t/* Use setjmp based hack to mark from callee-save registers. */\n #\tdefine USE_GENERIC_PUSH_REGS\n # endif\n-# if defined(SPARC) && !defined(LINUX)\n+# if defined(SPARC)\n #   define SAVE_CALL_CHAIN\n #   define ASM_CLEAR_CODE\t/* Stack clearing is crucial, and we \t*/\n \t\t\t\t/* include assembly code to do it well.\t*/"}, {"sha": "c3f19b8ec577b0f29edadff6a82aa413a3c86c79", "filename": "boehm-gc/linux_threads.c", "status": "modified", "additions": 10, "deletions": 2, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Flinux_threads.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Flinux_threads.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Flinux_threads.c?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -152,7 +152,7 @@ static inline ptr_t GC_linux_thread_top_of_stack(void)\n   return tos;\n }\n \n-#ifdef IA64\n+#if defined(SPARC) || defined(IA64)\n   extern word GC_save_regs_in_stack();\n #endif\n \n@@ -177,7 +177,11 @@ void GC_suspend_handler(int sig)\n     /* of a thread which holds the allocation lock in order\t*/\n     /* to stop the world.  Thus concurrent modification of the\t*/\n     /* data structure is impossible.\t\t\t\t*/\n-    me -> stack_ptr = (ptr_t)(&dummy);\n+#   ifdef SPARC\n+\tme -> stack_ptr = (ptr_t)GC_save_regs_in_stack();\n+#   else\n+\tme -> stack_ptr = (ptr_t)(&dummy);\n+#   endif\n #   ifdef IA64\n \tme -> backing_store_ptr = (ptr_t)GC_save_regs_in_stack();\n #   endif\n@@ -425,7 +429,11 @@ void GC_push_all_stacks()\n       for (p = GC_threads[i]; p != 0; p = p -> next) {\n         if (p -> flags & FINISHED) continue;\n         if (pthread_equal(p -> id, me)) {\n+#  ifdef SPARC\n+\t    lo = (ptr_t)GC_save_regs_in_stack();\n+#  else\n \t    lo = GC_approx_sp();\n+#  endif\n \t    IF_IA64(bs_hi = (ptr_t)GC_save_regs_in_stack();)\n \t} else {\n \t    lo = p -> stack_ptr;"}, {"sha": "2936fd7f992fe65284a22d68626c3afc454c5488", "filename": "boehm-gc/mach_dep.c", "status": "modified", "additions": 24, "deletions": 2, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fmach_dep.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fmach_dep.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fmach_dep.c?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -437,10 +437,16 @@ ptr_t cold_gc_frame;\n       asm(\"\t.globl\t_GC_save_regs_in_stack\");\n       asm(\"_GC_save_regs_in_stack:\");\n #   endif\n+#   if defined(__arch64__) || defined(__sparcv9)\n+    asm(\"\tsave\t%sp,-128,%sp\");\n+    asm(\"\tflushw\");\n+    asm(\"\tret\");\n+    asm(\"\trestore %sp,2047+128,%o0\");\n+#   else\n     asm(\"\tta\t0x3   ! ST_FLUSH_WINDOWS\");\n-    asm(\"\tmov\t%sp,%o0\");\n     asm(\"\tretl\");\n-    asm(\"\tnop\");\n+    asm(\"\tmov\t%sp,%o0\");\n+#endif\n #   ifdef SVR4\n       asm(\"\t.GC_save_regs_in_stack_end:\");\n       asm(\"\t.size GC_save_regs_in_stack,.GC_save_regs_in_stack_end-GC_save_regs_in_stack\");\n@@ -488,6 +494,21 @@ ptr_t cold_gc_frame;\n     asm(\"GC_clear_stack_inner:\");\n     asm(\".type GC_save_regs_in_stack,#function\");\n # endif\n+#if defined(__arch64__) || defined(__sparcv9)\n+  asm(\"mov %sp,%o2\");\t\t/* Save sp\t\t\t*/\n+  asm(\"add %sp,2047-8,%o3\");\t/* p = sp+bias-8\t\t*/\n+  asm(\"add %o1,-2047-192,%sp\");\t/* Move sp out of the way,\t*/\n+  \t\t\t\t/* so that traps still work.\t*/\n+  \t\t\t\t/* Includes some extra words\t*/\n+  \t\t\t\t/* so we can be sloppy below.\t*/\n+  asm(\"loop:\");\n+  asm(\"stx %g0,[%o3]\");\t\t/* *(long *)p = 0\t\t*/\n+  asm(\"cmp %o3,%o1\");\n+  asm(\"bgu,pt %xcc, loop\");\t/* if (p > limit) goto loop\t*/\n+    asm(\"add %o3,-8,%o3\");\t/* p -= 8 (delay slot) */\n+  asm(\"retl\");\n+    asm(\"mov %o2,%sp\");\t\t/* Restore sp., delay slot\t*/\n+#else\n   asm(\"mov %sp,%o2\");\t\t/* Save sp\t*/\n   asm(\"add %sp,-8,%o3\");\t/* p = sp-8\t*/\n   asm(\"clr %g1\");\t\t/* [g0,g1] = 0\t*/\n@@ -502,6 +523,7 @@ ptr_t cold_gc_frame;\n     asm(\"add %o3,-8,%o3\");\t/* p -= 8 (delay slot) */\n   asm(\"retl\");\n     asm(\"mov %o2,%sp\");\t\t/* Restore sp., delay slot\t*/\n+#endif\n   /* First argument = %o0 = return value */\n #   ifdef SVR4\n       asm(\"\t.GC_clear_stack_inner_end:\");"}, {"sha": "76e909f7971ee415fa4236b92a06281e37541c21", "filename": "boehm-gc/os_dep.c", "status": "modified", "additions": 41, "deletions": 19, "changes": 60, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fos_dep.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/70635f1e0498a195a36e1b49521bbac05fc9a363/boehm-gc%2Fos_dep.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fos_dep.c?ref=70635f1e0498a195a36e1b49521bbac05fc9a363", "patch": "@@ -1064,7 +1064,8 @@ void GC_register_data_segments()\n \n # else\n \n-# if (defined(SVR4) || defined(AUX) || defined(DGUX)) && !defined(PCR)\n+# if (defined(SVR4) || defined(AUX) || defined(DGUX) \\\n+      || (defined(LINUX) && defined(SPARC))) && !defined(PCR)\n char * GC_SysVGetDataStart(max_page_size, etext_addr)\n int max_page_size;\n int * etext_addr;\n@@ -2580,23 +2581,37 @@ struct hblk *h;\n  * Call stack save code for debugging.\n  * Should probably be in mach_dep.c, but that requires reorganization.\n  */\n-#if defined(SPARC) && !defined(LINUX)\n-#   if defined(SUNOS4)\n-#     include <machine/frame.h>\n-#   else\n-#     if defined (DRSNX)\n-#\tinclude <sys/sparc/frame.h>\n-#     else\n-#        if defined(OPENBSD)\n-#          include <frame.h>\n-#        else\n-#          include <sys/frame.h>\n-#        endif\n-#     endif\n-#   endif\n-#   if NARGS > 6\n+#if defined(SPARC)\n+#  if defined(LINUX)\n+struct frame {\n+\tlong\tfr_local[8];\n+\tlong\tfr_arg[6];\n+\tstruct frame *fr_savfp;\n+\tlong\tfr_savpc;\n+#    ifndef __arch64__\n+\tchar\t*fr_stret;\n+#    endif\n+\tlong\tfr_argd[6];\n+\tlong\tfr_argx[0];\n+};\n+#  else\n+#    if defined(SUNOS4)\n+#      include <machine/frame.h>\n+#    else\n+#      if defined (DRSNX)\n+#\t include <sys/sparc/frame.h>\n+#      else\n+#\t if defined(OPENBSD)\n+#\t   include <frame.h>\n+#\t else\n+#\t   include <sys/frame.h>\n+#\t endif\n+#      endif\n+#    endif\n+#  endif\n+#  if NARGS > 6\n \t--> We only know how to to get the first 6 arguments\n-#   endif\n+#  endif\n \n #ifdef SAVE_CALL_CHAIN\n /* Fill in the pc and argument information for up to NFRAMES of my\t*/\n@@ -2610,6 +2625,12 @@ struct hblk *h;\n #  define FR_SAVPC fr_savpc\n #endif\n \n+#if defined(SPARC) && (defined(__arch64__) || defined(__sparcv9))\n+#define BIAS 2047\n+#else\n+#define BIAS 0\n+#endif\n+\n void GC_save_callers (info) \n struct callinfo info[NFRAMES];\n {\n@@ -2620,8 +2641,9 @@ struct callinfo info[NFRAMES];\n \n   frame = (struct frame *) GC_save_regs_in_stack ();\n   \n-  for (fp = frame -> FR_SAVFP; fp != 0 && nframes < NFRAMES;\n-       fp = fp -> FR_SAVFP, nframes++) {\n+  for (fp = (struct frame *)((long) frame -> FR_SAVFP + BIAS);\n+       fp != 0 && nframes < NFRAMES;\n+       fp = (struct frame *)((long) fp -> FR_SAVFP + BIAS), nframes++) {\n       register int i;\n       \n       info[nframes].ci_pc = fp->FR_SAVPC;"}]}