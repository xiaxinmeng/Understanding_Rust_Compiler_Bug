{"sha": "54e34c358acefd04573881cb5db372423c1e8e9d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTRlMzRjMzU4YWNlZmQwNDU3Mzg4MWNiNWRiMzcyNDIzYzFlOGU5ZA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2010-09-09T15:07:21Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2010-09-09T15:07:21Z"}, "message": "tree-ssa-ccp.c (fold_const_aggregate_ref): Check that result of string folding is of integral type.\n\n\n\t* tree-ssa-ccp.c (fold_const_aggregate_ref): Check that result of\n\tstring folding is of integral type.\n\t* fortran.fortran-torture/compile/pr45598.f90: New test.\n\nFrom-SVN: r164111", "tree": {"sha": "26599e9e8b44b5ab012025bf37371c093d0ec20f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/26599e9e8b44b5ab012025bf37371c093d0ec20f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/54e34c358acefd04573881cb5db372423c1e8e9d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54e34c358acefd04573881cb5db372423c1e8e9d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54e34c358acefd04573881cb5db372423c1e8e9d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54e34c358acefd04573881cb5db372423c1e8e9d/comments", "author": null, "committer": null, "parents": [{"sha": "ba885ec559ca39e0dc23641dbbe67cc0072378f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba885ec559ca39e0dc23641dbbe67cc0072378f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba885ec559ca39e0dc23641dbbe67cc0072378f3"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "3b1225a3169186f03ead211ce6d189c138f23bf5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=54e34c358acefd04573881cb5db372423c1e8e9d", "patch": "@@ -1,3 +1,9 @@\n+2010-09-09  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR tree-optimization/45598\n+\t* tree-ssa-ccp.c (fold_const_aggregate_ref): Check that result of\n+\tstring folding is of integral type.\n+\n 2010-09-09  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* configure.ac (gnu_indirect_function): New test."}, {"sha": "2f0acf7a3fff5a4496527a5f40a2a4ccddce2e46", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=54e34c358acefd04573881cb5db372423c1e8e9d", "patch": "@@ -1,3 +1,8 @@\n+2010-09-08  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR tree-optimization/45598\n+\t* fortran.fortran-torture/compile/pr45598.f90: New test.\n+\n 2010-09-09  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* lib/target-supports-dg.exp (dg-require-ifunc): New."}, {"sha": "b8a883e533b790c24f7c940eeb7ad5af6340ee97", "filename": "gcc/testsuite/gfortran.fortran-torture/compile/pr45598.f90", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fpr45598.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fpr45598.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.fortran-torture%2Fcompile%2Fpr45598.f90?ref=54e34c358acefd04573881cb5db372423c1e8e9d", "patch": "@@ -0,0 +1,13 @@\n+program main\n+implicit none\n+character(len=10) :: digit_string = '123456789'\n+character :: digit_arr(10)\n+call copy(digit_string, digit_arr)\n+print '(1x, a1)',digit_arr(1:9)\n+contains\n+  subroutine copy(in, out)\n+    character, dimension(10) :: in, out\n+    out(1:10) = in(1:10)\n+  end subroutine copy\n+end program main\n+"}, {"sha": "60e2b55b71ccea040075cc176440136f6f4f0841", "filename": "gcc/tree-ssa-ccp.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2Ftree-ssa-ccp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/54e34c358acefd04573881cb5db372423c1e8e9d/gcc%2Ftree-ssa-ccp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-ccp.c?ref=54e34c358acefd04573881cb5db372423c1e8e9d", "patch": "@@ -1398,16 +1398,17 @@ fold_const_aggregate_ref (tree t)\n \t}\n \n       /* Fold read from constant string.  */\n-      if (TREE_CODE (ctor) == STRING_CST\n-\t  && TREE_CODE (idx) == INTEGER_CST)\n+      if (TREE_CODE (ctor) == STRING_CST)\n \t{\n \t  tree low_bound = array_ref_low_bound (t);\n \t  double_int low_bound_cst;\n \t  double_int index_cst;\n \t  double_int length_cst;\n \t  bool signed_p = TYPE_UNSIGNED (TREE_TYPE (idx));\n \n-\t  if (TREE_CODE (low_bound) != INTEGER_CST)\n+\t  if (TREE_CODE (idx) != INTEGER_CST\n+\t      || !INTEGRAL_TYPE_P (TREE_TYPE (t))\n+\t      || TREE_CODE (low_bound) != INTEGER_CST)\n \t    return NULL_TREE;\n \t  low_bound_cst = tree_to_double_int (low_bound);\n \t  index_cst = tree_to_double_int (idx);"}]}