{"sha": "9a25c5ce6e2677ae33ba489bd18335332f5e2560", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWEyNWM1Y2U2ZTI2NzdhZTMzYmE0ODliZDE4MzM1MzMyZjVlMjU2MA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2018-03-05T22:13:58Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-03-05T22:13:58Z"}, "message": "re PR target/84700 (ICE on 32-bit BE powerpc targets w/ -misel -O1)\n\n\tPR target/84700\n\t* combine.c (combine_simplify_rtx): Don't try to simplify if\n\tif_then_else_cond returned non-NULL, but either true_rtx or false_rtx\n\tare equal to x.\n\n\t* gcc.target/powerpc/pr84700.c: New test.\n\nFrom-SVN: r258263", "tree": {"sha": "c7c2c5cdf293033049f224f00c35f10f0d73b21d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c7c2c5cdf293033049f224f00c35f10f0d73b21d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a25c5ce6e2677ae33ba489bd18335332f5e2560", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a25c5ce6e2677ae33ba489bd18335332f5e2560", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a25c5ce6e2677ae33ba489bd18335332f5e2560", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a25c5ce6e2677ae33ba489bd18335332f5e2560/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "46cf7fa13bc81496856b23f9100d76b8bfbbb437", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46cf7fa13bc81496856b23f9100d76b8bfbbb437", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46cf7fa13bc81496856b23f9100d76b8bfbbb437"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "716e77abc99f2eb03d010ab70e30b4d882405b47", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9a25c5ce6e2677ae33ba489bd18335332f5e2560", "patch": "@@ -1,3 +1,10 @@\n+2018-03-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/84700\n+\t* combine.c (combine_simplify_rtx): Don't try to simplify if\n+\tif_then_else_cond returned non-NULL, but either true_rtx or false_rtx\n+\tare equal to x.\n+\n 2018-03-05  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* config/rs6000/rs6000.c (rs6000_loop_align): Don't align tiny loops"}, {"sha": "a4efd11703cf903a042fd2de9c1609c35e8250b1", "filename": "gcc/combine.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=9a25c5ce6e2677ae33ba489bd18335332f5e2560", "patch": "@@ -5734,7 +5734,11 @@ combine_simplify_rtx (rtx x, machine_mode op0_mode, int in_dest,\n \t  /* If everything is a comparison, what we have is highly unlikely\n \t     to be simpler, so don't use it.  */\n \t  && ! (COMPARISON_P (x)\n-\t\t&& (COMPARISON_P (true_rtx) || COMPARISON_P (false_rtx))))\n+\t\t&& (COMPARISON_P (true_rtx) || COMPARISON_P (false_rtx)))\n+\t  /* Similarly, if we end up with one of the expressions the same\n+\t     as the original, it is certainly not simpler.  */\n+\t  && ! rtx_equal_p (x, true_rtx)\n+\t  && ! rtx_equal_p (x, false_rtx))\n \t{\n \t  rtx cop1 = const0_rtx;\n \t  enum rtx_code cond_code = simplify_comparison (NE, &cond, &cop1);"}, {"sha": "ca2986b62210b829934e33600a4917590a6085ae", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9a25c5ce6e2677ae33ba489bd18335332f5e2560", "patch": "@@ -1,3 +1,8 @@\n+2018-03-05  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/84700\n+\t* gcc.target/powerpc/pr84700.c: New test.\n+\n 2018-03-05  Nathan Sidwell  <nathan@acm.org>\n \n \tPR c++/84702"}, {"sha": "c89094a56d3904d27d3f506540929ebe1ac57aeb", "filename": "gcc/testsuite/gcc.target/powerpc/pr84700.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr84700.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a25c5ce6e2677ae33ba489bd18335332f5e2560/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr84700.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr84700.c?ref=9a25c5ce6e2677ae33ba489bd18335332f5e2560", "patch": "@@ -0,0 +1,12 @@\n+/* PR target/84700 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -misel\" } */\n+\n+long long int\n+foo (long long int x)\n+{\n+  long long int a = x < 2;\n+  int b = a >= 0;\n+\n+  return a + ((x == 0) ? a : b);\n+}"}]}