{"sha": "ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWU4OTYwZTU1ODA4YWVlYjQxODNlYTA3YjNiYWQ3ZjY3ZmE2YjY0MA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2006-01-04T08:07:09Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2006-01-04T08:07:09Z"}, "message": "re PR c/25559 (Internal compiler error when specifying vector_size(2) of int)\n\n\tPR c/25559\n\t* c-common.c (handle_vector_size_attribute): Reject zero vector size\n\tas well as sizes not multiple of component size.\n\n\t* gcc.dg/pr25559.c: New test.\n\nFrom-SVN: r109316", "tree": {"sha": "3cac5cc0fee67f928ce2528c8de83b7102ca5f10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3cac5cc0fee67f928ce2528c8de83b7102ca5f10"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "434eba35c00fe13a817a4f799e8b6b1fcb1f8065", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/434eba35c00fe13a817a4f799e8b6b1fcb1f8065", "html_url": "https://github.com/Rust-GCC/gccrs/commit/434eba35c00fe13a817a4f799e8b6b1fcb1f8065"}], "stats": {"total": 31, "additions": 31, "deletions": 0}, "files": [{"sha": "8e2759752a0183d4e7f729cc44160659ae917b31", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "patch": "@@ -1,5 +1,9 @@\n 2006-01-04  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c/25559\n+\t* c-common.c (handle_vector_size_attribute): Reject zero vector size\n+\tas well as sizes not multiple of component size.\n+\n \tPR debug/25562\n \t* function.c (instantiate_expr): New function.\n \t(instantiate_decls_1, instantiate_decls): If DECL_HAS_VALUE_EXPR_P,"}, {"sha": "76e90962f9bcc0dfa81fb11ade1352991442653b", "filename": "gcc/c-common.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "patch": "@@ -5199,6 +5199,18 @@ handle_vector_size_attribute (tree *node, tree name, tree args,\n       return NULL_TREE;\n     }\n \n+  if (vecsize % tree_low_cst (TYPE_SIZE_UNIT (type), 1))\n+    {\n+      error (\"vector size not an integral multiple of component size\");\n+      return NULL;\n+    }\n+\n+  if (vecsize == 0)\n+    {\n+      error (\"zero vector size\");\n+      return NULL;\n+    }\n+\n   /* Calculate how many units fit in the vector.  */\n   nunits = vecsize / tree_low_cst (TYPE_SIZE_UNIT (type), 1);\n   if (nunits & (nunits - 1))"}, {"sha": "23350e1ca5549971263c30e1af7e87731eedec54", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "patch": "@@ -1,3 +1,8 @@\n+2006-01-04  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/25559\n+\t* gcc.dg/pr25559.c: New test.\n+\n 2006-01-03  Mark Mitchell  <mark@codesourcery.com>\n \n \tPR c++/25492"}, {"sha": "7879a1558b64b7c2b707a5c25b5fbea2ebd0f041", "filename": "gcc/testsuite/gcc.dg/pr25559.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2Ftestsuite%2Fgcc.dg%2Fpr25559.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee8960e55808aeeb4183ea07b3bad7f67fa6b640/gcc%2Ftestsuite%2Fgcc.dg%2Fpr25559.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr25559.c?ref=ee8960e55808aeeb4183ea07b3bad7f67fa6b640", "patch": "@@ -0,0 +1,10 @@\n+/* PR c/25559 */\n+/* { dg-do compile } */\n+\n+#define vs(n) __attribute__((vector_size (n)))\n+int vs (-1) a;\t\t\t/* { dg-warning \"attribute ignored\" } */\n+int vs (0) b;\t\t\t/* { dg-error \"zero vector size\" } */\n+int vs (1) c;\t\t\t/* { dg-error \"multiple of component size\" } */\n+int vs (sizeof (int) / 2) d;\t/* { dg-error \"multiple of component size\" } */\n+int vs (sizeof (int)) e;\n+int vs (sizeof (int) * 2) f;"}]}