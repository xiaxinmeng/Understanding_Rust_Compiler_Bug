{"sha": "9ebfd78bad3cde0cb92ae3261314546fce5e949e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWViZmQ3OGJhZDNjZGUwY2I5MmFlMzI2MTMxNDU0NmZjZTVlOTQ5ZQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2003-10-06T09:18:01Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2003-10-06T09:18:01Z"}, "message": "re PR rtl-optimization/12215 (ICE in make_label_edge with -fnon-call-exceptions -fno-gcse -O2)\n\n\tPR optimization/12215\n\t* cse.c (cse_set_around_loop): Emit the move at the beginning\n\tof the next basic block for trapping sets.\n\nFrom-SVN: r72141", "tree": {"sha": "aa7bff17dc2ec7053af2c62a9b55799585b49947", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aa7bff17dc2ec7053af2c62a9b55799585b49947"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ebfd78bad3cde0cb92ae3261314546fce5e949e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ebfd78bad3cde0cb92ae3261314546fce5e949e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ebfd78bad3cde0cb92ae3261314546fce5e949e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ebfd78bad3cde0cb92ae3261314546fce5e949e/comments", "author": null, "committer": null, "parents": [{"sha": "8c03ca00a652f280811502a22cde311ef72cb861", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c03ca00a652f280811502a22cde311ef72cb861", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c03ca00a652f280811502a22cde311ef72cb861"}], "stats": {"total": 58, "additions": 57, "deletions": 1}, "files": [{"sha": "a0112d2ca75da3ca1cf694a5aa178177b2d2007c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9ebfd78bad3cde0cb92ae3261314546fce5e949e", "patch": "@@ -1,3 +1,9 @@\n+2003-10-06  Eric Botcazou  <ebotcazou@libertysurf.fr>\n+\n+\tPR optimization/12215\n+\t* cse.c (cse_set_around_loop): Emit the move at the beginning\n+\tof the next basic block for trapping sets.\n+\n 2003-10-06  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \tPR optimization/11637"}, {"sha": "30355df5f79401615ed02bfff8ebfb510a906746", "filename": "gcc/cse.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2Fcse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2Fcse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcse.c?ref=9ebfd78bad3cde0cb92ae3261314546fce5e949e", "patch": "@@ -6666,7 +6666,15 @@ cse_set_around_loop (rtx x, rtx insn, rtx loop_start)\n \t\t\t      abort ();\n \t\t\t  }\n \t\t\telse\n-\t\t\t  emit_insn_after (move, p);\n+\t\t\t  {\n+\t\t\t    if (control_flow_insn_p (p))\n+\t\t\t      /* p can cause a control flow transfer so it\n+\t\t\t\t is the last insn of a basic block.  We can't\n+\t\t\t\t therefore use emit_insn_after.  */\n+\t\t\t      emit_insn_before (move, next_nonnote_insn (p));\n+\t\t\t    else\n+\t\t\t      emit_insn_after (move, p);\n+\t\t\t  }\n \t\t      }\n \t\t    break;\n \t\t  }"}, {"sha": "48761b7cb2cefb1794947abb63d69ead23a40177", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9ebfd78bad3cde0cb92ae3261314546fce5e949e", "patch": "@@ -1,3 +1,7 @@\n+2003-10-06  Wolfgang Bangerth  <bangerth@ticam.utexas.edu>\n+\n+\t* g++.dg/opt/cfg2.C: New test.\n+\n 2003-10-06  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \t* g++.dg/opt/float1.C: New test."}, {"sha": "229f4bc3a527d0dfa23d6a1ba073468c172d5ab2", "filename": "gcc/testsuite/g++.dg/opt/cfg2.C", "status": "added", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fcfg2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ebfd78bad3cde0cb92ae3261314546fce5e949e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fcfg2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fcfg2.C?ref=9ebfd78bad3cde0cb92ae3261314546fce5e949e", "patch": "@@ -0,0 +1,38 @@\n+// PR optimization/12215\n+// Origin: <nick@ilm.com>\n+// Reduced testcase by Wolfgang Bangerth <bangerth@ticam.utexas.edu>\n+\n+// This used to fail because the CSE pass destroyed the CFG in presence\n+// of trapping loads, which led to the deletion of basic blocks.\n+\n+// { dg-do compile }\n+// { dg-options \"-O2 -fno-gcse -fnon-call-exceptions\" }\n+\n+\n+struct B {\n+  ~B() throw() {}\n+};\n+\n+struct X {\n+  X(const char*, const B&);\n+  ~X() {}\n+};\n+\n+bool m();\n+void f(int &i, float &arg0);\n+\n+void g (const char **argv) {\n+  float val;\n+  int i = 1;\n+\n+  try {\n+    while ( i < 1 )\n+      {\n+        X arg(argv[i], B());\n+        if (m())\n+          throw(0);\n+\n+        f(i, val);\n+      }\n+  } catch (...) {}\n+}"}]}