{"sha": "1dcc82c2c7975d324ad401dc0797eb15463ce53e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWRjYzgyYzJjNzk3NWQzMjRhZDQwMWRjMDc5N2ViMTU0NjNjZTUzZQ==", "commit": {"author": {"name": "Doug Kwan", "email": "dougkwan@google.com", "date": "2010-04-08T08:41:50Z"}, "committer": {"name": "Doug Kwan", "email": "dougkwan@gcc.gnu.org", "date": "2010-04-08T08:41:50Z"}, "message": "configure.ac: Recognize gold and do not use its version number to test ld features.\n\n2010-04-07  Doug Kwan  <dougkwan@google.com>\n\n\t* configure.ac: Recognize gold and do not use its version number\n\tto test ld features.\n\t* configure: Regenerate.\n\nFrom-SVN: r158106", "tree": {"sha": "99f59f49e3cbfb4654e787f097d3a2998b286128", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/99f59f49e3cbfb4654e787f097d3a2998b286128"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1dcc82c2c7975d324ad401dc0797eb15463ce53e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1dcc82c2c7975d324ad401dc0797eb15463ce53e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1dcc82c2c7975d324ad401dc0797eb15463ce53e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1dcc82c2c7975d324ad401dc0797eb15463ce53e/comments", "author": {"login": "dougkwan", "id": 1399231, "node_id": "MDQ6VXNlcjEzOTkyMzE=", "avatar_url": "https://avatars.githubusercontent.com/u/1399231?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dougkwan", "html_url": "https://github.com/dougkwan", "followers_url": "https://api.github.com/users/dougkwan/followers", "following_url": "https://api.github.com/users/dougkwan/following{/other_user}", "gists_url": "https://api.github.com/users/dougkwan/gists{/gist_id}", "starred_url": "https://api.github.com/users/dougkwan/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dougkwan/subscriptions", "organizations_url": "https://api.github.com/users/dougkwan/orgs", "repos_url": "https://api.github.com/users/dougkwan/repos", "events_url": "https://api.github.com/users/dougkwan/events{/privacy}", "received_events_url": "https://api.github.com/users/dougkwan/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b0aef8a83c2d6deb4040c46b60f04f224894f058", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0aef8a83c2d6deb4040c46b60f04f224894f058", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0aef8a83c2d6deb4040c46b60f04f224894f058"}], "stats": {"total": 46, "additions": 42, "deletions": 4}, "files": [{"sha": "4eae83ac74a21458c9febadff28aff18c92360b4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dcc82c2c7975d324ad401dc0797eb15463ce53e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dcc82c2c7975d324ad401dc0797eb15463ce53e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1dcc82c2c7975d324ad401dc0797eb15463ce53e", "patch": "@@ -1,3 +1,9 @@\n+2010-04-08  Doug Kwan  <dougkwan@google.com>\n+\n+\t* configure.ac: Recognize gold and do not use its version number\n+\tto test ld features.\n+\t* configure: Regenerate.\n+\n 2010-04-08  Maxim Kuvyrkov  <maxim@codesourcery.com>\n \n \tPR middle-end/40815"}, {"sha": "c3ff39c7d32082c21cde71ff248209b8eba61970", "filename": "gcc/configure", "status": "modified", "additions": 19, "deletions": 2, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dcc82c2c7975d324ad401dc0797eb15463ce53e/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dcc82c2c7975d324ad401dc0797eb15463ce53e/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=1dcc82c2c7975d324ad401dc0797eb15463ce53e", "patch": "@@ -20609,6 +20609,19 @@ cat >>confdefs.h <<_ACEOF\n _ACEOF\n \n \n+# Check to see if we are using gold instead of ld\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether we are using gold\" >&5\n+$as_echo_n \"checking whether we are using gold... \" >&6; }\n+ld_is_gold=no\n+if test x$gcc_cv_ld != x; then\n+  if $gcc_cv_ld --version 2>/dev/null | sed 1q \\\n+     | grep \"GNU gold\" > /dev/null; then\n+    ld_is_gold=yes\n+  fi\n+fi\n+{ $as_echo \"$as_me:${as_lineno-$LINENO}: result: $ld_is_gold\" >&5\n+$as_echo \"$ld_is_gold\" >&6; }\n+\n ORIGINAL_LD_FOR_TARGET=$gcc_cv_ld\n \n case \"$ORIGINAL_LD_FOR_TARGET\" in\n@@ -21188,7 +21201,9 @@ $as_echo \"$gcc_cv_as_hidden\" >&6; }\n \n if test $in_tree_ld != yes ; then\n   ld_ver=`$gcc_cv_ld --version 2>/dev/null | sed 1q`\n-  if echo \"$ld_ver\" | grep GNU > /dev/null; then\n+  if test x\"$ld_is_gold\" = xyes; then\n+    gcc_cv_ld_hidden=yes\n+  elif echo \"$ld_ver\" | grep GNU > /dev/null; then\n     ld_vers=`echo $ld_ver | sed -n \\\n \t-e 's,^.*[\t ]\\([0-9][0-9]*\\.[0-9][0-9]*.*\\)$,\\1,p'`\n     ld_date=`echo $ld_ver | sed -n 's,^.*\\([2-9][0-9][0-9][0-9]\\)[-]*\\([01][0-9]\\)[-]*\\([0-3][0-9]\\).*$,\\1\\2\\3,p'`\n@@ -21785,7 +21800,9 @@ fi\n $as_echo \"$gcc_cv_as_comdat_group_percent\" >&6; }\n \n fi\n-if test $in_tree_ld = yes ; then\n+if test x\"$ld_is_gold\" = xyes; then\n+  comdat_group=yes\n+elif test $in_tree_ld = yes ; then\n   comdat_group=no\n   if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2 \\\n      && test $in_tree_ld_is_elf = yes; then"}, {"sha": "ea1a0405e901acc596c92c5fcbd7d94e35b47f82", "filename": "gcc/configure.ac", "status": "modified", "additions": 17, "deletions": 2, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1dcc82c2c7975d324ad401dc0797eb15463ce53e/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1dcc82c2c7975d324ad401dc0797eb15463ce53e/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=1dcc82c2c7975d324ad401dc0797eb15463ce53e", "patch": "@@ -1934,6 +1934,17 @@ AC_ARG_WITH(plugin-ld,\n AC_SUBST(ORIGINAL_PLUGIN_LD_FOR_TARGET)\n AC_DEFINE_UNQUOTED(PLUGIN_LD, \"$PLUGIN_LD\", [Specify plugin linker])\n \n+# Check to see if we are using gold instead of ld\n+AC_MSG_CHECKING(whether we are using gold)\n+ld_is_gold=no\n+if test x$gcc_cv_ld != x; then\n+  if $gcc_cv_ld --version 2>/dev/null | sed 1q \\\n+     | grep \"GNU gold\" > /dev/null; then\n+    ld_is_gold=yes\n+  fi\n+fi\n+AC_MSG_RESULT($ld_is_gold)\n+\n ORIGINAL_LD_FOR_TARGET=$gcc_cv_ld\n AC_SUBST(ORIGINAL_LD_FOR_TARGET)\n case \"$ORIGINAL_LD_FOR_TARGET\" in\n@@ -2122,7 +2133,9 @@ foobar:])\n changequote(,)dnl\n if test $in_tree_ld != yes ; then\n   ld_ver=`$gcc_cv_ld --version 2>/dev/null | sed 1q`\n-  if echo \"$ld_ver\" | grep GNU > /dev/null; then\n+  if test x\"$ld_is_gold\" = xyes; then\n+    gcc_cv_ld_hidden=yes\n+  elif echo \"$ld_ver\" | grep GNU > /dev/null; then\n     ld_vers=`echo $ld_ver | sed -n \\\n \t-e 's,^.*[\t ]\\([0-9][0-9]*\\.[0-9][0-9]*.*\\)$,\\1,p'`\n     ld_date=`echo $ld_ver | sed -n 's,^.*\\([2-9][0-9][0-9][0-9]\\)[-]*\\([01][0-9]\\)[-]*\\([0-3][0-9]\\).*$,\\1\\2\\3,p'`\n@@ -2441,7 +2454,9 @@ else\n    [elf,2,16,0], [--fatal-warnings],\n    [.section .text,\"axG\",%progbits,.foo,comdat])\n fi\n-if test $in_tree_ld = yes ; then\n+if test x\"$ld_is_gold\" = xyes; then\n+  comdat_group=yes\n+elif test $in_tree_ld = yes ; then\n   comdat_group=no\n   if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2 \\\n      && test $in_tree_ld_is_elf = yes; then"}]}