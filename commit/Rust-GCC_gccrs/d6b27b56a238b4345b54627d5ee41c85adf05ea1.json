{"sha": "d6b27b56a238b4345b54627d5ee41c85adf05ea1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDZiMjdiNTZhMjM4YjQzNDViNTQ2MjdkNWVlNDFjODVhZGYwNWVhMQ==", "commit": {"author": {"name": "Devang Patel", "email": "dpatel@apple.com", "date": "2005-10-06T00:47:21Z"}, "committer": {"name": "Devang Patel", "email": "dpatel@gcc.gnu.org", "date": "2005-10-06T00:47:21Z"}, "message": "re PR debug/23205 ([C++/unit-at-a-time] stabs debug info omitted for global const variables)\n\n       PR Debug/23205\n       * dbxout.c (dbxout_symbol): Check DECL_RTL_SET_P, after\n       handling constants. Check NAMESPACE_DECL context for constants.\n\n       * g++.dg/other/PR23205.C: New.\n\nFrom-SVN: r105028", "tree": {"sha": "1679f9c1b58000cf3ef376de40b984227982359c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1679f9c1b58000cf3ef376de40b984227982359c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d6b27b56a238b4345b54627d5ee41c85adf05ea1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6b27b56a238b4345b54627d5ee41c85adf05ea1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6b27b56a238b4345b54627d5ee41c85adf05ea1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6b27b56a238b4345b54627d5ee41c85adf05ea1/comments", "author": null, "committer": null, "parents": [{"sha": "2d99a2ffb1241a9c6d951918c71d5f9202c2bc23", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d99a2ffb1241a9c6d951918c71d5f9202c2bc23", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d99a2ffb1241a9c6d951918c71d5f9202c2bc23"}], "stats": {"total": 44, "additions": 37, "deletions": 7}, "files": [{"sha": "1ef72bc8c99d78adfc81d713284bca3b6f917164", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d6b27b56a238b4345b54627d5ee41c85adf05ea1", "patch": "@@ -1,3 +1,9 @@\n+2005-10-05  Devang Patel  <dpatel@apple.com>\n+\n+\tPR Debug/23205\n+\t* dbxout.c (dbxout_symbol): Check DECL_RTL_SET_P, after\n+\thandling constants. Check NAMESPACE_DECL context for constants.\n+\t\n 2005-10-05  Eric Christopher  <echristo@apple.com>\n \n \t* doc/md.texi (Standard Names): Fix name of pushm1 pattern."}, {"sha": "9ffced04c9bbd85d4f712538e12dedf0c5d56e08", "filename": "gcc/dbxout.c", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2Fdbxout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2Fdbxout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdbxout.c?ref=d6b27b56a238b4345b54627d5ee41c85adf05ea1", "patch": "@@ -2671,10 +2671,6 @@ dbxout_symbol (tree decl, int local ATTRIBUTE_UNUSED)\n       if (DECL_EXTERNAL (decl))\n \tbreak;\n \n-      decl_rtl = dbxout_expand_expr (decl);\n-      if (!decl_rtl)\n-\tDBXOUT_DECR_NESTING_AND_RETURN (0);\n-\n       /* If the variable is really a constant\n \t and not written in memory, inform the debugger.\n \n@@ -2684,7 +2680,8 @@ dbxout_symbol (tree decl, int local ATTRIBUTE_UNUSED)\n \t  && host_integerp (DECL_INITIAL (decl), 0)\n \t  && ! TREE_ASM_WRITTEN (decl)\n \t  && (DECL_CONTEXT (decl) == NULL_TREE\n-\t      || TREE_CODE (DECL_CONTEXT (decl)) == BLOCK)\n+\t      || TREE_CODE (DECL_CONTEXT (decl)) == BLOCK\n+\t      || TREE_CODE (DECL_CONTEXT (decl)) == NAMESPACE_DECL)\n \t  && TREE_PUBLIC (decl) == 0)\n \t{\n \t  /* The sun4 assembler does not grok this.  */\n@@ -2695,8 +2692,8 @@ dbxout_symbol (tree decl, int local ATTRIBUTE_UNUSED)\n \t      HOST_WIDE_INT ival = TREE_INT_CST_LOW (DECL_INITIAL (decl));\n \n \t      dbxout_begin_complex_stabs ();\n-\t      stabstr_I (DECL_NAME (decl));\n-\t      stabstr_S (\":c=i\");\n+\t      dbxout_symbol_name (decl, NULL, 'c');\n+\t      stabstr_S (\"=i\");\n \t      stabstr_D (ival);\n \t      dbxout_finish_complex_stabs (0, N_LSYM, 0, 0, 0);\n \t      DBXOUT_DECR_NESTING;\n@@ -2707,6 +2704,10 @@ dbxout_symbol (tree decl, int local ATTRIBUTE_UNUSED)\n \t}\n       /* else it is something we handle like a normal variable.  */\n \n+      decl_rtl = dbxout_expand_expr (decl);\n+      if (!decl_rtl)\n+\tDBXOUT_DECR_NESTING_AND_RETURN (0);\n+\n       decl_rtl = eliminate_regs (decl_rtl, 0, NULL_RTX);\n #ifdef LEAF_REG_REMAP\n       if (current_function_uses_only_leaf_regs)"}, {"sha": "be22aa9a9deee2545e32d5c46c541e0af36fa2db", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d6b27b56a238b4345b54627d5ee41c85adf05ea1", "patch": "@@ -1,3 +1,8 @@\n+2005-10-05  Devang Patel  <dpatel@apple.com>\n+\n+\tPR Debug/23205\n+\t* g++.dg/other/PR23205.C: New.\n+\t\n 2005-10-05  Richard Henderson  <rth@redhat.com>\n \n \tPR target/23602"}, {"sha": "6852f82f5ef62f076ce0f8e942c008b3cc071b18", "filename": "gcc/testsuite/g++.dg/other/PR23205.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2FPR23205.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6b27b56a238b4345b54627d5ee41c85adf05ea1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2FPR23205.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2FPR23205.C?ref=d6b27b56a238b4345b54627d5ee41c85adf05ea1", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-do compile } */\n+/* { dg-skip-if \"No stabs\" { mmix-*-* *-*-aix* *-*-netware* alpha*-*-* hppa*64*-*-* ia64-*-* } { \"*\" } { \"\" } } */\n+/* { dg-options \"-gstabs+ -fno-eliminate-unused-debug-types\" } */\n+\n+const int foobar = 4;\n+int foo ()\n+{\n+        return foobar + 1;\n+}\n+\n+int main()\n+{\n+        int i;\n+        i = foo();\n+        return i;\n+}\n+\n+/* { dg-final { scan-assembler \".stabs.*foobar:c=i\" } } */"}]}