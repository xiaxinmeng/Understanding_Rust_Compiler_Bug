{"sha": "76ba1222c5014b8f2d16efcd9696666b162a537a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzZiYTEyMjJjNTAxNGI4ZjJkMTZlZmNkOTY5NjY2NmIxNjJhNTM3YQ==", "commit": {"author": {"name": "Brooks Moses", "email": "bmoses@google.com", "date": "2013-06-06T21:17:36Z"}, "committer": {"name": "Brooks Moses", "email": "brooks@gcc.gnu.org", "date": "2013-06-06T21:17:36Z"}, "message": "validate_failures.py: Fix handling of summary lines with \"|\" characters or empty description fields.\n\n* testsuite-management/validate_failures.py: Fix handling of\nsummary lines with \"|\" characters or empty description fields.\n\nFrom-SVN: r199765", "tree": {"sha": "6d93fefba9e133e48405b6df1b47e920f2069759", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6d93fefba9e133e48405b6df1b47e920f2069759"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/76ba1222c5014b8f2d16efcd9696666b162a537a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76ba1222c5014b8f2d16efcd9696666b162a537a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/76ba1222c5014b8f2d16efcd9696666b162a537a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/76ba1222c5014b8f2d16efcd9696666b162a537a/comments", "author": {"login": "brooksmoses", "id": 5161118, "node_id": "MDQ6VXNlcjUxNjExMTg=", "avatar_url": "https://avatars.githubusercontent.com/u/5161118?v=4", "gravatar_id": "", "url": "https://api.github.com/users/brooksmoses", "html_url": "https://github.com/brooksmoses", "followers_url": "https://api.github.com/users/brooksmoses/followers", "following_url": "https://api.github.com/users/brooksmoses/following{/other_user}", "gists_url": "https://api.github.com/users/brooksmoses/gists{/gist_id}", "starred_url": "https://api.github.com/users/brooksmoses/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/brooksmoses/subscriptions", "organizations_url": "https://api.github.com/users/brooksmoses/orgs", "repos_url": "https://api.github.com/users/brooksmoses/repos", "events_url": "https://api.github.com/users/brooksmoses/events{/privacy}", "received_events_url": "https://api.github.com/users/brooksmoses/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "37684c463383390f1497f506c4cbf99c40b83cac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37684c463383390f1497f506c4cbf99c40b83cac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37684c463383390f1497f506c4cbf99c40b83cac"}], "stats": {"total": 34, "additions": 22, "deletions": 12}, "files": [{"sha": "1233e6acaea69ab3977f881f8910ea2363f27c7d", "filename": "contrib/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76ba1222c5014b8f2d16efcd9696666b162a537a/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76ba1222c5014b8f2d16efcd9696666b162a537a/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=76ba1222c5014b8f2d16efcd9696666b162a537a", "patch": "@@ -1,3 +1,8 @@\n+2013-06-06  Brooks Moses  <bmoses@google.com>\n+\n+\t* testsuite-management/validate_failures.py: Fix handling of\n+\tsummary lines with \"|\" characters or empty description fields.\n+\n 2013-05-24  Chung-Ju Wu  <jasonwucj@gmail.com>\n \n \t* download_prerequisites: Download isl and cloog conditionally."}, {"sha": "2779050468d739c5278fbb6c45f3cf51ff9d0cb1", "filename": "contrib/testsuite-management/validate_failures.py", "status": "modified", "additions": 17, "deletions": 12, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/76ba1222c5014b8f2d16efcd9696666b162a537a/contrib%2Ftestsuite-management%2Fvalidate_failures.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/76ba1222c5014b8f2d16efcd9696666b162a537a/contrib%2Ftestsuite-management%2Fvalidate_failures.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Ftestsuite-management%2Fvalidate_failures.py?ref=76ba1222c5014b8f2d16efcd9696666b162a537a", "patch": "@@ -119,20 +119,15 @@ class TestResult(object):\n \n   def __init__(self, summary_line, ordinal=-1):\n     try:\n-      self.attrs = ''\n-      if '|' in summary_line:\n-        (self.attrs, summary_line) = summary_line.split('|', 1)\n+      (self.attrs, summary_line) = SplitAttributesFromSummaryLine(summary_line)\n       try:\n         (self.state,\n          self.name,\n-         self.description) = re.match(r' *([A-Z]+):\\s*(\\S+)\\s+(.*)',\n+         self.description) = re.match(r'([A-Z]+):\\s*(\\S+)\\s*(.*)',\n                                       summary_line).groups()\n       except:\n         print 'Failed to parse summary line: \"%s\"' % summary_line\n         raise\n-      self.attrs = self.attrs.strip()\n-      self.state = self.state.strip()\n-      self.description = self.description.strip()\n       self.ordinal = ordinal\n     except ValueError:\n       Error('Cannot parse summary line \"%s\"' % summary_line)\n@@ -208,11 +203,20 @@ def IsComment(line):\n   return line.startswith('#')\n \n \n+def SplitAttributesFromSummaryLine(line):\n+  \"\"\"Splits off attributes from a summary line, if present.\"\"\"\n+  if '|' in line and not _VALID_TEST_RESULTS_REX.match(line):\n+    (attrs, line) = line.split('|', 1)\n+    attrs = attrs.strip()\n+  else:\n+    attrs = ''\n+  line = line.strip()\n+  return (attrs, line)\n+\n+\n def IsInterestingResult(line):\n   \"\"\"Return True if line is one of the summary lines we care about.\"\"\"\n-  if '|' in line:\n-    (_, line) = line.split('|', 1)\n-    line = line.strip()\n+  (_, line) = SplitAttributesFromSummaryLine(line)\n   return bool(_VALID_TEST_RESULTS_REX.match(line))\n \n \n@@ -416,8 +420,9 @@ def PerformComparison(expected, actual, ignore_missing_failures):\n   if not ignore_missing_failures and len(expected_vs_actual) > 0:\n     PrintSummary('Expected results not present in this build (fixed tests)'\n                  '\\n\\nNOTE: This is not a failure.  It just means that these '\n-                 'tests were expected\\nto fail, but they worked in this '\n-                 'configuration.\\n', expected_vs_actual)\n+                 'tests were expected\\nto fail, but either they worked in '\n+                 'this configuration or they were not\\npresent at all.\\n',\n+                 expected_vs_actual)\n \n   if tests_ok:\n     print '\\nSUCCESS: No unexpected failures.'"}]}