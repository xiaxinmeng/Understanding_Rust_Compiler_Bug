{"sha": "71b838d03533d1dbd94553f21ad4e8e439365d04", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzFiODM4ZDAzNTMzZDFkYmQ5NDU1M2YyMWFkNGU4ZTQzOTM2NWQwNA==", "commit": {"author": {"name": "Daniel Santos", "email": "daniel.santos@pobox.com", "date": "2017-04-10T17:45:35Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2017-04-10T17:45:35Z"}, "message": "re PR testsuite/79867 ([cygwin] LD_LIBRARY_PATH ignored, contaminating (nearly?) all test results)\n\n2017-04-10  Daniel Santos <daniel.santos@pobox.com>\n\n\tPR testsuite/79867\n\t* lib/target-libpath.exp: Merge in cygwin fix from libffi.\n\nFrom-SVN: r246813", "tree": {"sha": "fac67ccf1d4a59952e687e353f77d5264c3bff9c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fac67ccf1d4a59952e687e353f77d5264c3bff9c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71b838d03533d1dbd94553f21ad4e8e439365d04", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71b838d03533d1dbd94553f21ad4e8e439365d04", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71b838d03533d1dbd94553f21ad4e8e439365d04", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71b838d03533d1dbd94553f21ad4e8e439365d04/comments", "author": {"login": "daniel-santos", "id": 980562, "node_id": "MDQ6VXNlcjk4MDU2Mg==", "avatar_url": "https://avatars.githubusercontent.com/u/980562?v=4", "gravatar_id": "", "url": "https://api.github.com/users/daniel-santos", "html_url": "https://github.com/daniel-santos", "followers_url": "https://api.github.com/users/daniel-santos/followers", "following_url": "https://api.github.com/users/daniel-santos/following{/other_user}", "gists_url": "https://api.github.com/users/daniel-santos/gists{/gist_id}", "starred_url": "https://api.github.com/users/daniel-santos/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/daniel-santos/subscriptions", "organizations_url": "https://api.github.com/users/daniel-santos/orgs", "repos_url": "https://api.github.com/users/daniel-santos/repos", "events_url": "https://api.github.com/users/daniel-santos/events{/privacy}", "received_events_url": "https://api.github.com/users/daniel-santos/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "98a7a34e26ec1e809712dbbebb0193f2ac545018", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/98a7a34e26ec1e809712dbbebb0193f2ac545018", "html_url": "https://github.com/Rust-GCC/gccrs/commit/98a7a34e26ec1e809712dbbebb0193f2ac545018"}], "stats": {"total": 26, "additions": 26, "deletions": 0}, "files": [{"sha": "b87d0eeeddee369bd61c76b4008849091f1b164b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71b838d03533d1dbd94553f21ad4e8e439365d04/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71b838d03533d1dbd94553f21ad4e8e439365d04/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=71b838d03533d1dbd94553f21ad4e8e439365d04", "patch": "@@ -1,3 +1,8 @@\n+2017-04-10  Daniel Santos <daniel.santos@pobox.com>\n+\n+\tPR testsuite/79867\n+\t* lib/target-libpath.exp: Merge in cygwin fix from libffi.\n+\n 2017-04-10  Marek Polacek  <polacek@redhat.com>\n \n \tPR sanitizer/80348"}, {"sha": "b6d01b310164df58d285ce39b17c9c150885adbd", "filename": "gcc/testsuite/lib/target-libpath.exp", "status": "modified", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71b838d03533d1dbd94553f21ad4e8e439365d04/gcc%2Ftestsuite%2Flib%2Ftarget-libpath.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71b838d03533d1dbd94553f21ad4e8e439365d04/gcc%2Ftestsuite%2Flib%2Ftarget-libpath.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-libpath.exp?ref=71b838d03533d1dbd94553f21ad4e8e439365d04", "patch": "@@ -23,6 +23,7 @@ set orig_shlib_path_saved 0\n set orig_ld_library_path_32_saved 0\n set orig_ld_library_path_64_saved 0\n set orig_dyld_library_path_saved 0\n+set orig_path_saved 0\n set orig_gcc_exec_prefix_saved 0\n set orig_gcc_exec_prefix_checked 0\n \n@@ -55,6 +56,7 @@ proc set_ld_library_path_env_vars { } {\n   global orig_ld_library_path_32_saved\n   global orig_ld_library_path_64_saved\n   global orig_dyld_library_path_saved\n+  global orig_path_saved\n   global orig_gcc_exec_prefix_saved\n   global orig_gcc_exec_prefix_checked\n   global orig_ld_library_path\n@@ -63,6 +65,7 @@ proc set_ld_library_path_env_vars { } {\n   global orig_ld_library_path_32\n   global orig_ld_library_path_64\n   global orig_dyld_library_path\n+  global orig_path\n   global orig_gcc_exec_prefix\n   global env\n \n@@ -110,6 +113,10 @@ proc set_ld_library_path_env_vars { } {\n       set orig_dyld_library_path \"$env(DYLD_LIBRARY_PATH)\"\n       set orig_dyld_library_path_saved 1\n     }\n+    if [info exists env(PATH)] {\n+      set orig_path \"$env(PATH)\"\n+      set orig_path_saved 1\n+    }\n   }\n \n   # We need to set ld library path in the environment.  Currently,\n@@ -164,6 +171,13 @@ proc set_ld_library_path_env_vars { } {\n   } else {\n     setenv DYLD_LIBRARY_PATH \"$ld_library_path\"\n   }\n+  if { [istarget *-*-cygwin*] || [istarget *-*-mingw*] } {\n+    if { $orig_path_saved } {\n+      setenv PATH \"$ld_library_path:$orig_path\"\n+    } else {\n+      setenv PATH \"$ld_library_path\"\n+    }\n+  }\n \n   verbose -log \"LD_LIBRARY_PATH=[getenv LD_LIBRARY_PATH]\"\n   verbose -log \"LD_RUN_PATH=[getenv LD_RUN_PATH]\"\n@@ -201,12 +215,14 @@ proc restore_ld_library_path_env_vars { } {\n   global orig_ld_library_path_32_saved\n   global orig_ld_library_path_64_saved\n   global orig_dyld_library_path_saved\n+  global orig_path_saved\n   global orig_ld_library_path\n   global orig_ld_run_path\n   global orig_shlib_path\n   global orig_ld_library_path_32\n   global orig_ld_library_path_64\n   global orig_dyld_library_path\n+  global orig_path\n   global env\n \n   restore_gcc_exec_prefix_env_var\n@@ -245,6 +261,11 @@ proc restore_ld_library_path_env_vars { } {\n   } elseif [info exists env(DYLD_LIBRARY_PATH)] {\n     unsetenv DYLD_LIBRARY_PATH\n   }\n+  if { $orig_path_saved } {\n+    setenv PATH \"$orig_path\"\n+  } elseif [info exists env(PATH)] {\n+    unsetenv PATH\n+  }\n }\n \n #######################################"}]}