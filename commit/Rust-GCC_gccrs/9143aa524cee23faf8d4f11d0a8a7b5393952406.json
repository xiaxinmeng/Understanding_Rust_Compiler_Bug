{"sha": "9143aa524cee23faf8d4f11d0a8a7b5393952406", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTE0M2FhNTI0Y2VlMjNmYWY4ZDRmMTFkMGE4YTdiNTM5Mzk1MjQwNg==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2018-05-25T06:09:10Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2018-05-25T06:09:10Z"}, "message": "re PR fortran/85839 ([F2018] warn for obsolescent features)\n\n2018-05-25  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/85839\n\t* match.c (gfc_match_block_data): Call gfc_notify_std to warn about\n\tan obsolescent feature in Fortran 2018.\n\t(gfc_match_equivalence): Ditto.\n\t* resolve.c (resolve_common_blocks): Ditto.\n\t(gfc_resolve_forall): Ditto.\n\t* symbol.c (gfc_define_st_label): Ditto.\n\n\n2018-05-25  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/85839\n\t* gfortran.dg/f2018_obs.f90: New test case.\n\nFrom-SVN: r260705", "tree": {"sha": "5f54dc37f3d1a928a91c54559c5d1607004b9f9b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5f54dc37f3d1a928a91c54559c5d1607004b9f9b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9143aa524cee23faf8d4f11d0a8a7b5393952406", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9143aa524cee23faf8d4f11d0a8a7b5393952406", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9143aa524cee23faf8d4f11d0a8a7b5393952406", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9143aa524cee23faf8d4f11d0a8a7b5393952406/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "55157d5ed6df9a8eacd0e39c12c97fe7222f1172", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55157d5ed6df9a8eacd0e39c12c97fe7222f1172", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55157d5ed6df9a8eacd0e39c12c97fe7222f1172"}], "stats": {"total": 62, "additions": 62, "deletions": 0}, "files": [{"sha": "63d42976676aae2f163442ecb7b341eceebe9a05", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=9143aa524cee23faf8d4f11d0a8a7b5393952406", "patch": "@@ -1,3 +1,13 @@\n+2018-05-25  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/85839\n+\t* match.c (gfc_match_block_data): Call gfc_notify_std to warn about\n+\tan obsolescent feature in Fortran 2018.\n+\t(gfc_match_equivalence): Ditto.\n+\t* resolve.c (resolve_common_blocks): Ditto.\n+\t(gfc_resolve_forall): Ditto.\n+\t* symbol.c (gfc_define_st_label): Ditto.\n+\n 2018-05-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/85543"}, {"sha": "1ab0e0fad9a6392edb5aad7756753b7c654e8630", "filename": "gcc/fortran/match.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2Fmatch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2Fmatch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fmatch.c?ref=9143aa524cee23faf8d4f11d0a8a7b5393952406", "patch": "@@ -5259,6 +5259,10 @@ gfc_match_block_data (void)\n   gfc_symbol *sym;\n   match m;\n \n+  if (!gfc_notify_std (GFC_STD_F2018_OBS, \"BLOCK DATA construct at %L\",\n+      &gfc_current_locus))\n+    return MATCH_ERROR;\n+\n   if (gfc_match_eos () == MATCH_YES)\n     {\n       gfc_new_block = NULL;\n@@ -5575,6 +5579,9 @@ gfc_match_equivalence (void)\n \t}\n     }\n \n+  if (!gfc_notify_std (GFC_STD_F2018_OBS, \"EQUIVALENCE statement at %C\"))\n+    return MATCH_ERROR;\n+\n   return MATCH_YES;\n \n syntax:"}, {"sha": "3a0ff80ab89b7819ea6c0f9b3ce86b26047fde5a", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=9143aa524cee23faf8d4f11d0a8a7b5393952406", "patch": "@@ -997,6 +997,10 @@ resolve_common_blocks (gfc_symtree *common_root)\n \n   resolve_common_vars (common_root->n.common, true);\n \n+  if (!gfc_notify_std (GFC_STD_F2018_OBS, \"COMMON block at %L\",\n+\t\t       &common_root->n.common->where))\n+    return;\n+\n   /* The common name is a global name - in Fortran 2003 also if it has a\n      C binding name, since Fortran 2008 only the C binding name is a global\n      identifier.  */\n@@ -9930,6 +9934,9 @@ gfc_resolve_forall (gfc_code *code, gfc_namespace *ns, int forall_save)\n \n   old_nvar = nvar;\n \n+  if (!gfc_notify_std (GFC_STD_F2018_OBS, \"FORALL construct at %L\", &code->loc))\n+    return;\n+\n   /* Start to resolve a FORALL construct   */\n   if (forall_save == 0)\n     {"}, {"sha": "4f060633da113f8fbcf47a3b5216f4e09f8fe849", "filename": "gcc/fortran/symbol.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2Fsymbol.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ffortran%2Fsymbol.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fsymbol.c?ref=9143aa524cee23faf8d4f11d0a8a7b5393952406", "patch": "@@ -2725,6 +2725,10 @@ gfc_define_st_label (gfc_st_label *lp, gfc_sl_type type, locus *label_locus)\n \t\t\t\t  \"DO termination statement which is not END DO\"\n \t\t\t\t  \" or CONTINUE with label %d at %C\", labelno))\n \t    return;\n+\t  if (type == ST_LABEL_DO_TARGET\n+\t      && !gfc_notify_std (GFC_STD_F2018_OBS, \"Labeled DO statement \"\n+\t\t\t\t  \"at %L\", label_locus))\n+\t    return;\n \t  break;\n \n \tdefault:"}, {"sha": "59b230956e8242e33663baffaac879bf06ae0947", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9143aa524cee23faf8d4f11d0a8a7b5393952406", "patch": "@@ -1,3 +1,8 @@\n+2018-05-25  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/85839\n+\t* gfortran.dg/f2018_obs.f90: New test case.\n+\n 2018-05-24  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/85543"}, {"sha": "0a8dca9706a85bf84502c640ca94c3faa0d02af1", "filename": "gcc/testsuite/gfortran.dg/f2018_obs.f90", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ftestsuite%2Fgfortran.dg%2Ff2018_obs.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9143aa524cee23faf8d4f11d0a8a7b5393952406/gcc%2Ftestsuite%2Fgfortran.dg%2Ff2018_obs.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ff2018_obs.f90?ref=9143aa524cee23faf8d4f11d0a8a7b5393952406", "patch": "@@ -0,0 +1,29 @@\n+! { dg-do compile }\n+! { dg-options \"-std=f2018\" }\n+!\n+! PR 85839: [F2018] warn for obsolescent features\n+!\n+! Contributed by Janus Weil <janus@gcc.gnu.org>\n+\n+block data                           ! { dg-warning \"obsolescent feature\" }\n+  common /a/ y(3)                    ! { dg-warning \"obsolescent feature\" }\n+  data y /3*1./\n+end\n+\n+program f2018_obs\n+\n+  implicit none\n+  integer :: a(10),b(10),j(8),i\n+  real :: x(3)\n+  common /c/ x                       ! { dg-warning \"obsolescent feature\" }\n+\n+  equivalence (a(10),b(1))           ! { dg-warning \"obsolescent feature\" }\n+\n+  do 99 i=1,10\n+99 continue                          ! { dg-warning \"obsolescent feature\" }\n+\n+  j = (/ 0, 1, 2, 3, 4, 0, 6, 7  /)\n+  forall (i=1:8, j(i) /= 0)          ! { dg-warning \"obsolescent feature\" }\n+    j(i) = 0\n+  end forall\n+end"}]}