{"sha": "85d874975afa49098a9119c9fe61d104c2d50d1c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODVkODc0OTc1YWZhNDkwOThhOTExOWM5ZmU2MWQxMDRjMmQ1MGQxYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-10-30T08:08:01Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-10-30T08:08:01Z"}, "message": "re PR debug/54953 (New sra-1.c FAILs on powerpc)\n\n\tPR debug/54953\n\t* valtrack.h (DEBUG_TEMP_AFTER_WITH_REG_FORCE): New.\n\t* valtrack.c (dead_debug_insert_temp): Use emit_debug_insn_after\n\teven for where == DEBUG_TEMP_AFTER_WITH_REG_FORCE.\n\t* dce.c (word_dce_process_block, dce_process_block): Pass\n\tDEBUG_TEMP_AFTER_WITH_REG_FORCE if insn is needed and therefore\n\tnot going to be eliminated.\n\nFrom-SVN: r192978", "tree": {"sha": "f8f26e88fe761dcc00566b4a2b95688abb002871", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f8f26e88fe761dcc00566b4a2b95688abb002871"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85d874975afa49098a9119c9fe61d104c2d50d1c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85d874975afa49098a9119c9fe61d104c2d50d1c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85d874975afa49098a9119c9fe61d104c2d50d1c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85d874975afa49098a9119c9fe61d104c2d50d1c/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "d863d14312412121fc138f607258e7a86e72a7a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d863d14312412121fc138f607258e7a86e72a7a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d863d14312412121fc138f607258e7a86e72a7a8"}], "stats": {"total": 31, "additions": 26, "deletions": 5}, "files": [{"sha": "a27c0df5b5e5dc27d494c406ef11d7d2b6472021", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=85d874975afa49098a9119c9fe61d104c2d50d1c", "patch": "@@ -1,3 +1,13 @@\n+2012-10-30  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/54953\n+\t* valtrack.h (DEBUG_TEMP_AFTER_WITH_REG_FORCE): New.\n+\t* valtrack.c (dead_debug_insert_temp): Use emit_debug_insn_after\n+\teven for where == DEBUG_TEMP_AFTER_WITH_REG_FORCE.\n+\t* dce.c (word_dce_process_block, dce_process_block): Pass\n+\tDEBUG_TEMP_AFTER_WITH_REG_FORCE if insn is needed and therefore\n+\tnot going to be eliminated.\n+\n 2012-10-29  Lawrence Crowl  <crowl@google.com>\n \n \t* sbitmap.h (sbitmap_copy): Rename bitmap_copy."}, {"sha": "efc26222e7e9423024b309e2ee3d97ee3f0fdcd3", "filename": "gcc/dce.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2Fdce.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2Fdce.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdce.c?ref=85d874975afa49098a9119c9fe61d104c2d50d1c", "patch": "@@ -1,5 +1,5 @@\n /* RTL dead code elimination.\n-   Copyright (C) 2005, 2006, 2007, 2008, 2009, 2010, 2011\n+   Copyright (C) 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -880,7 +880,10 @@ word_dce_process_block (basic_block bb, bool redo_out,\n \n \t    for (def_rec = DF_INSN_DEFS (insn); *def_rec; def_rec++)\n \t      dead_debug_insert_temp (&debug, DF_REF_REGNO (*def_rec), insn,\n-\t\t\t\t      DEBUG_TEMP_BEFORE_WITH_VALUE);\n+\t\t\t\t      marked_insn_p (insn)\n+\t\t\t\t      && !control_flow_insn_p (insn)\n+\t\t\t\t      ? DEBUG_TEMP_AFTER_WITH_REG_FORCE\n+\t\t\t\t      : DEBUG_TEMP_BEFORE_WITH_VALUE);\n \t  }\n \n \tif (dump_file)\n@@ -981,7 +984,9 @@ dce_process_block (basic_block bb, bool redo_out, bitmap au,\n \tif (debug.used && !bitmap_empty_p (debug.used))\n \t  for (def_rec = DF_INSN_DEFS (insn); *def_rec; def_rec++)\n \t    dead_debug_insert_temp (&debug, DF_REF_REGNO (*def_rec), insn,\n-\t\t\t\t    DEBUG_TEMP_BEFORE_WITH_VALUE);\n+\t\t\t\t    needed && !control_flow_insn_p (insn)\n+\t\t\t\t    ? DEBUG_TEMP_AFTER_WITH_REG_FORCE\n+\t\t\t\t    : DEBUG_TEMP_BEFORE_WITH_VALUE);\n       }\n \n   dead_debug_local_finish (&debug, NULL);"}, {"sha": "c1de41c74e747c4aa58709fbf7323164754583af", "filename": "gcc/valtrack.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2Fvaltrack.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2Fvaltrack.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvaltrack.c?ref=85d874975afa49098a9119c9fe61d104c2d50d1c", "patch": "@@ -684,7 +684,8 @@ dead_debug_insert_temp (struct dead_debug_local *debug, unsigned int uregno,\n \t\t\t       DEBUG_EXPR_TREE_DECL (dval), breg,\n \t\t\t       VAR_INIT_STATUS_INITIALIZED);\n \n-  if (where == DEBUG_TEMP_AFTER_WITH_REG)\n+  if (where == DEBUG_TEMP_AFTER_WITH_REG\n+      || where == DEBUG_TEMP_AFTER_WITH_REG_FORCE)\n     bind = emit_debug_insn_after (bind, insn);\n   else\n     bind = emit_debug_insn_before (bind, insn);"}, {"sha": "a925e27a509ad3e07f9b9a42feacdcce888914fb", "filename": "gcc/valtrack.h", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2Fvaltrack.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85d874975afa49098a9119c9fe61d104c2d50d1c/gcc%2Fvaltrack.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvaltrack.h?ref=85d874975afa49098a9119c9fe61d104c2d50d1c", "patch": "@@ -131,7 +131,12 @@ enum debug_temp_where\n     /* Bind a newly-created debug temporary to a REG for UREGNO, and\n        insert the debug insn after INSN.  REG is expected to be set at\n        INSN.  */\n-    DEBUG_TEMP_AFTER_WITH_REG = 1\n+    DEBUG_TEMP_AFTER_WITH_REG = 1,\n+    /* Like DEBUG_TEMP_AFTER_WITH_REG, but force addition of a debug\n+       temporary even if there is just a single debug use.  This is used\n+       on regs that are becoming REG_DEAD on INSN and so uses of the\n+       reg later on are invalid.  */\n+    DEBUG_TEMP_AFTER_WITH_REG_FORCE = 2\n   };\n \n extern void dead_debug_global_init (struct dead_debug_global *, bitmap);"}]}