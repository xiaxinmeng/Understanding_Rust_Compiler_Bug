{"sha": "81435e80be7ece5ba2ed3851b04a0ec07da979fd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODE0MzVlODBiZTdlY2U1YmEyZWQzODUxYjA0YTBlYzA3ZGE5NzlmZA==", "commit": {"author": {"name": "Thomas Quinot", "email": "quinot@adacore.com", "date": "2011-12-02T14:56:34Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-12-02T14:56:34Z"}, "message": "sem_ch10.adb (Analyze_Compilation_Unit): For a library subprogram body that acts as spec...\n\n2011-12-02  Thomas Quinot  <quinot@adacore.com>\n\n\t* sem_ch10.adb (Analyze_Compilation_Unit): For a library subprogram\n\tbody that acts as spec, do not create a shallow copy of the context\n\tclause for the synthetized spec (instead, use the same list as\n\tin the body).\n\nFrom-SVN: r181918", "tree": {"sha": "90ef1ccbd37a1f6c8ed713b7e9967ce51dd65d7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/90ef1ccbd37a1f6c8ed713b7e9967ce51dd65d7b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/81435e80be7ece5ba2ed3851b04a0ec07da979fd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81435e80be7ece5ba2ed3851b04a0ec07da979fd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/81435e80be7ece5ba2ed3851b04a0ec07da979fd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/81435e80be7ece5ba2ed3851b04a0ec07da979fd/comments", "author": null, "committer": null, "parents": [{"sha": "414b312e6cb5355c3fe83472eee624adb14f2e0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/414b312e6cb5355c3fe83472eee624adb14f2e0f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/414b312e6cb5355c3fe83472eee624adb14f2e0f"}], "stats": {"total": 20, "additions": 19, "deletions": 1}, "files": [{"sha": "9ad5b1be173ee937077feda71c339c9f10717768", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81435e80be7ece5ba2ed3851b04a0ec07da979fd/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81435e80be7ece5ba2ed3851b04a0ec07da979fd/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=81435e80be7ece5ba2ed3851b04a0ec07da979fd", "patch": "@@ -1,3 +1,10 @@\n+2011-12-02  Thomas Quinot  <quinot@adacore.com>\n+\n+\t* sem_ch10.adb (Analyze_Compilation_Unit): For a library subprogram\n+\tbody that acts as spec, do not create a shallow copy of the context\n+\tclause for the synthetized spec (instead, use the same list as\n+\tin the body).\n+\n 2011-12-02  Bob Duff  <duff@adacore.com>\n \n \t* gnat_ugn.texi: Clarify usage of -p binder switch."}, {"sha": "27d9e45b93bb54507ec9e8104b7e6d9e30485a9a", "filename": "gcc/ada/sem_ch10.adb", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/81435e80be7ece5ba2ed3851b04a0ec07da979fd/gcc%2Fada%2Fsem_ch10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/81435e80be7ece5ba2ed3851b04a0ec07da979fd/gcc%2Fada%2Fsem_ch10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch10.adb?ref=81435e80be7ece5ba2ed3851b04a0ec07da979fd", "patch": "@@ -807,9 +807,20 @@ package body Sem_Ch10 is\n \n                   begin\n                      Set_Comes_From_Source_Default (False);\n+\n+                     --  Checks for redundant USE TYPE clauses have a special\n+                     --  exception for the synthetic spec we create here. This\n+                     --  special case relies on the two compilation units\n+                     --  sharing the same context clause.\n+\n+                     --  Note: We used to do a shallow copy (New_Copy_List),\n+                     --  which defeated those checks and also created malformed\n+                     --  trees (subtype mark shared by two distinct\n+                     --  N_Use_Type_Clause nodes) which crashed the compiler.\n+\n                      Lib_Unit :=\n                        Make_Compilation_Unit (Loc,\n-                         Context_Items => New_Copy_List (Context_Items (N)),\n+                         Context_Items => Context_Items (N),\n                          Unit =>\n                            Make_Subprogram_Declaration (Sloc (N),\n                              Specification =>"}]}