{"sha": "812a5d4b7e983a208446efe4c747c528228bcb28", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODEyYTVkNGI3ZTk4M2EyMDg0NDZlZmU0Yzc0N2M1MjgyMjhiY2IyOA==", "commit": {"author": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2009-08-10T17:10:50Z"}, "committer": {"name": "Manuel L\u00f3pez-Ib\u00e1\u00f1ez", "email": "manu@gcc.gnu.org", "date": "2009-08-10T17:10:50Z"}, "message": "dg.exp: Test also c-c++-common dir.\n\n2009-08-10  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n\ntestsuite/\n       * gcc.dg/dg.exp: Test also c-c++-common dir.\n       * g++.dg/dg.exp: Likewise.\n       * g++.dg/warn/Wconversion-real.C: Delete.\n       * gcc.dg/Wconversion-real.c: Move to ...\n       * c-c++-common/Wconversion-real.c: ... here.\n       * lib/target-supports.exp\n       (check_effective_target_c,check_effective_target_c++): New.\n\nFrom-SVN: r150627", "tree": {"sha": "352301eb3294920cdfe083b4364bd8e49419309a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/352301eb3294920cdfe083b4364bd8e49419309a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/812a5d4b7e983a208446efe4c747c528228bcb28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/812a5d4b7e983a208446efe4c747c528228bcb28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/812a5d4b7e983a208446efe4c747c528228bcb28", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/812a5d4b7e983a208446efe4c747c528228bcb28/comments", "author": null, "committer": null, "parents": [{"sha": "0159ec792b364e3b675d606ee66700a4c373bd1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0159ec792b364e3b675d606ee66700a4c373bd1f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0159ec792b364e3b675d606ee66700a4c373bd1f"}], "stats": {"total": 126, "additions": 40, "deletions": 86}, "files": [{"sha": "2f7c1b2d6c2e4ffbeb0a2a0f5e4d279b60781a3e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=812a5d4b7e983a208446efe4c747c528228bcb28", "patch": "@@ -1,3 +1,13 @@\n+2009-08-10  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n+\n+       * gcc.dg/dg.exp: Test also c-c++-common dir.\n+       * g++.dg/dg.exp: Likewise.\n+       * g++.dg/warn/Wconversion-real.C: Delete.\n+       * gcc.dg/Wconversion-real.c: Move to ...\n+       * c-c++-common/Wconversion-real.c: ... here.\n+       * lib/target-supports.exp\n+       (check_effective_target_c,check_effective_target_c++): New.\n+\t\n 2009-08-10  Daniel Kraft  <d@domob.eu>\n \n \tPR fortran/37425"}, {"sha": "464aab05579daf04f348bb3171d3af4d0d60e244", "filename": "gcc/testsuite/c-c++-common/Wconversion-real.c", "status": "renamed", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWconversion-real.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWconversion-real.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2FWconversion-real.c?ref=812a5d4b7e983a208446efe4c747c528228bcb28", "patch": "@@ -2,7 +2,8 @@\n \n /* { dg-do compile } */\n /* { dg-skip-if \"doubles are floats\" { \"avr-*-*\" } { \"*\" } { \"\" } } */\n-/* { dg-options \"-std=c99 -Wconversion\" } */\n+/* { dg-options \"-std=c99 -Wconversion\" { target c } } */\n+/* { dg-options \"-Wconversion\" { target c++ } } */\n /* { dg-require-effective-target large_double } */\n \n float  vfloat;", "previous_filename": "gcc/testsuite/gcc.dg/Wconversion-real.c"}, {"sha": "54fc225f4f8b90f37eb148b8cff2a4901be13d73", "filename": "gcc/testsuite/g++.dg/dg.exp", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdg.exp?ref=812a5d4b7e983a208446efe4c747c528228bcb28", "patch": "@@ -49,5 +49,9 @@ set tests [prune $tests $srcdir/$subdir/graphite/*]\n # Main loop.\n dg-runtest $tests \"\" $DEFAULT_CXXFLAGS\n \n+# C/C++ common tests.\n+dg-runtest [lsort [glob -nocomplain $srcdir/c-c++-common/*.\\[cSi\\]]] \\\n+\t\"\" \"\"\n+\n # All done.\n dg-finish"}, {"sha": "e69de29bb2d1d6434b8b29ae775ad8c2e48c5391", "filename": "gcc/testsuite/g++.dg/warn/Wconversion-real.C", "status": "modified", "additions": 0, "deletions": 85, "changes": 85, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWconversion-real.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWconversion-real.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fwarn%2FWconversion-real.C?ref=812a5d4b7e983a208446efe4c747c528228bcb28", "patch": "@@ -1,85 +0,0 @@\n-/* Test for diagnostics for Wconversion for floating-point.  \n-   C++ equivalent of gcc/testsuite/gcc.dg/Wconversion-real.c */\n-\n-/* { dg-do compile }\n-/* { dg-options \"-Wconversion\" } */\n-\n-float  vfloat;\n-double vdouble;\n-long double vlongdouble;\n-\n-void ffloat (float f);\n-void fdouble (double d);\n-void flongdouble (long double ld);\n-\n-void h (void)\n-{\n-  float f = 0;\n-  double d = 0;\n-  long double ld = 0;\n-\n-  ffloat (3.1); /* { dg-warning \"conversion\" } */\n-  vfloat = 3.1; /* { dg-warning \"conversion\" } */\n-  ffloat (3.1L); /* { dg-warning \"conversion\" } */\n-  vfloat = 3.1L;  /* { dg-warning \"conversion\" } */\n-  fdouble (3.1L); /* { dg-warning \"conversion\" \"\" { target large_long_double } } */\n-  vdouble = 3.1L; /* { dg-warning \"conversion\" \"\" { target large_long_double } } */\n-  ffloat (vdouble); /* { dg-warning \"conversion\" } */\n-  vfloat = vdouble; /* { dg-warning \"conversion\" } */\n-  ffloat (vlongdouble); /* { dg-warning \"conversion\" } */\n-  vfloat = vlongdouble; /* { dg-warning \"conversion\" } */\n-  fdouble (vlongdouble); /* { dg-warning \"conversion\" \"\" { target large_long_double } } */\n-  vdouble = vlongdouble; /* { dg-warning \"conversion\" \"\" { target large_long_double } } */\n-\n-\n-  ffloat ((float) 3.1); \n-  vfloat = (float) 3.1;\n-  ffloat ((float) 3.1L);\n-  vfloat = (float) 3.1L; \n-  fdouble ((double) 3.1L); \n-  vdouble = (double) 3.1L; \n-  ffloat ((float) vdouble); \n-  vfloat = (float) vdouble; \n-  ffloat ((float) vlongdouble); \n-  vfloat = (float) vlongdouble;\n-  fdouble ((double) vlongdouble);\n-  vdouble = (double) vlongdouble;\n-\n-\n-  ffloat (3.0);\n-  vfloat = 3.0;\n-  ffloat (3.1f);\n-  vfloat = 3.1f;\n-  ffloat (0.25L);\n-  vfloat = 0.25L;\n-\n-\n-  fdouble (3.0);\n-  vdouble = 3.0;\n-  fdouble (3.1f);\n-  vdouble = 3.1f;\n-  fdouble (0.25L);\n-  vdouble = 0.25L;\n-\n-  flongdouble (3.0);\n-  vlongdouble = 3.0;\n-  flongdouble (3.1f);\n-  vlongdouble = 3.1f;\n-  flongdouble (0.25L);\n-  vlongdouble = 0.25L;\n-\n-  ffloat (f);\n-  vfloat = f;\n-  fdouble (f);\n-  vdouble = f;\n-  fdouble (d);\n-  vdouble = d;\n-  flongdouble (f);\n-  vlongdouble = f;\n-  flongdouble (d);\n-  vlongdouble = d;\n-  flongdouble (ld);\n-  vlongdouble = ld;\n-}\n-\n-"}, {"sha": "3f71178f98ea2ec07729226dfc713cf71650cf8e", "filename": "gcc/testsuite/gcc.dg/dg.exp", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fgcc.dg%2Fdg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Fgcc.dg%2Fdg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdg.exp?ref=812a5d4b7e983a208446efe4c747c528228bcb28", "patch": "@@ -32,5 +32,9 @@ dg-init\n dg-runtest [lsort [glob -nocomplain $srcdir/$subdir/*.\\[cSi\\]]] \\\n \t\"\" $DEFAULT_CFLAGS\n \n+# C/C++ common tests.\n+dg-runtest [lsort [glob -nocomplain $srcdir/c-c++-common/*.\\[cSi\\]]] \\\n+\t\" -Wc++-compat \" \"\"\n+\n # All done.\n dg-finish"}, {"sha": "e2fef1894e81e990259479b237a2d53038620add", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/812a5d4b7e983a208446efe4c747c528228bcb28/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=812a5d4b7e983a208446efe4c747c528228bcb28", "patch": "@@ -3090,3 +3090,23 @@ proc check_effective_target_mpc_pow { } {\n \t}\n     }]\n }\n+\n+# Return 1 if the language for the compiler under test is C.\n+\n+proc check_effective_target_c { } {\n+ global tool\n+    if [string match $tool \"gcc\"] {\n+   return 1\n+    }\n+ return 0\n+}\n+\n+# Return 1 if the language for the compiler under test is C++.\n+\n+proc check_effective_target_c++ { } {\n+ global tool\n+    if [string match $tool \"g++\"] {\n+   return 1\n+    }\n+ return 0\n+}"}]}