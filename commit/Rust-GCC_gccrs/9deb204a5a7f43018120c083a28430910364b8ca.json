{"sha": "9deb204a5a7f43018120c083a28430910364b8ca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWRlYjIwNGE1YTdmNDMwMTgxMjBjMDgzYTI4NDMwOTEwMzY0YjhjYQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2006-01-26T22:29:12Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2006-01-26T22:29:12Z"}, "message": "re PR c++/16021 (Tests for container swap specialisations FAIL in debug mode)\n\n        PR c++/16021\n        * name-lookup.c (parse_using_directive): Require strong using to\n        name a nested namespace.\n\nFrom-SVN: r110282", "tree": {"sha": "493b0d86d9da80f50584013cbc785bd5680f3f01", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/493b0d86d9da80f50584013cbc785bd5680f3f01"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9deb204a5a7f43018120c083a28430910364b8ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9deb204a5a7f43018120c083a28430910364b8ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9deb204a5a7f43018120c083a28430910364b8ca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9deb204a5a7f43018120c083a28430910364b8ca/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9391bc0df99d799bb04e701e62f9a1e0786c9c14", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9391bc0df99d799bb04e701e62f9a1e0786c9c14", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9391bc0df99d799bb04e701e62f9a1e0786c9c14"}], "stats": {"total": 41, "additions": 26, "deletions": 15}, "files": [{"sha": "741d3de0a0e07651c9ce51df81c9d4cb7f014482", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=9deb204a5a7f43018120c083a28430910364b8ca", "patch": "@@ -1,3 +1,9 @@\n+2006-01-26  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/16021\n+\t* name-lookup.c (parse_using_directive): Require strong using to\n+\tname a nested namespace.\n+\n 2006-01-25  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \tRevert:"}, {"sha": "2f33b096d4e063ea06d77d8208a712e978e231f8", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=9deb204a5a7f43018120c083a28430910364b8ca", "patch": "@@ -3295,9 +3295,14 @@ parse_using_directive (tree namespace, tree attribs)\n \t  if (!toplevel_bindings_p ())\n \t    error (\"strong using only meaningful at namespace scope\");\n \t  else if (namespace != error_mark_node)\n-\t    DECL_NAMESPACE_ASSOCIATIONS (namespace)\n-\t      = tree_cons (current_namespace, 0,\n-\t\t\t   DECL_NAMESPACE_ASSOCIATIONS (namespace));\n+\t    {\n+\t      if (!is_ancestor (current_namespace, namespace))\n+\t\terror (\"current namespace %qD does not enclose strongly used namespace %qD\",\n+\t\t       current_namespace, namespace);\n+\t      DECL_NAMESPACE_ASSOCIATIONS (namespace)\n+\t\t= tree_cons (current_namespace, 0,\n+\t\t\t     DECL_NAMESPACE_ASSOCIATIONS (namespace));\n+\t    }\n \t}\n       else\n \twarning (OPT_Wattributes, \"%qD attribute directive ignored\", name);"}, {"sha": "a16fd6a50b973b81e50dbec175309326322e5a6b", "filename": "gcc/testsuite/g++.dg/lookup/strong-using-1.C", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-1.C?ref=9deb204a5a7f43018120c083a28430910364b8ca", "patch": "@@ -2,10 +2,10 @@\n \n // { dg-do compile }\n \n-namespace foo {\n-  template <class T> void swap(T, T);\n-}\n namespace fool {\n+  namespace foo {\n+    template <class T> void swap(T, T);\n+  }\n   using namespace foo __attribute__((strong));\n   template <class T> void swap(T);\n }"}, {"sha": "21e47cba014b39dffc9353eede793106f40c3304", "filename": "gcc/testsuite/g++.dg/lookup/strong-using-2.C", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-2.C?ref=9deb204a5a7f43018120c083a28430910364b8ca", "patch": "@@ -2,16 +2,16 @@\n \n // { dg-do compile }\n \n-namespace foo_impl {\n-  class T; // { dg-error \"T\" \"\" }\n-}\n-namespace bar_impl {\n-  class T; // { dg-error \"T\" \"\" }\n-}\n namespace foo {\n+  namespace foo_impl {\n+    class T; // { dg-error \"T\" \"\" }\n+  }\n   using namespace foo_impl __attribute__((strong));\n }\n namespace bar {\n+  namespace bar_impl {\n+    class T; // { dg-error \"T\" \"\" }\n+  }\n   using namespace bar_impl __attribute__((strong));\n   using namespace foo;\n }"}, {"sha": "9b4d3c3ffea0695313f1e9298280a897370c8367", "filename": "gcc/testsuite/g++.dg/lookup/strong-using-3.C", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9deb204a5a7f43018120c083a28430910364b8ca/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fstrong-using-3.C?ref=9deb204a5a7f43018120c083a28430910364b8ca", "patch": "@@ -2,10 +2,10 @@\n \n // { dg-do compile }\n \n-namespace foo {\n-  template <class T> void f(T, T);\n-}\n namespace bar {\n+  namespace foo {\n+    template <class T> void f(T, T);\n+  }\n   using namespace foo __attribute__((strong));\n   template <class T> void f(T);\n }"}]}