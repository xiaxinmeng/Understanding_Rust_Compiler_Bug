{"sha": "78a6d0e30d7950216dc0c5be5d65d0cbed13924c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzhhNmQwZTMwZDc5NTAyMTZkYzBjNWJlNWQ2NWQwY2JlZDEzOTI0Yw==", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2021-02-17T01:49:12Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2021-02-17T01:49:12Z"}, "message": "c++: Revert EXPR_LOCATION change to build_aggr_init_expr [PR96997]\n\nMy change in r10-7718 to make build_aggr_init_expr set EXPR_LOCATION\n(mimicking build_target_expr) causes the debuginfo regression PR96997.\nGiven that this change is mostly independent of the rest of the commit,\nand that the only fallout of reverting it is a less accurate error\nmessage location in a testcase introduced in the same commit, it seems\nthe best way forward is to just revert this part of the commit.\n\ngcc/cp/ChangeLog:\n\n\tPR debug/96997\n\tPR c++/94034\n\t* tree.c (build_aggr_init_expr): Revert r10-7718 change.\n\ngcc/testsuite/ChangeLog:\n\n\tPR debug/96997\n\tPR c++/94034\n\t* g++.dg/cpp1y/constexpr-nsdmi7b.C:  Adjust expected location of\n\t\"call to non-'constexpr' function\" error message.", "tree": {"sha": "0593d5591041d2a22a516d0ffc97593241e80c45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0593d5591041d2a22a516d0ffc97593241e80c45"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/78a6d0e30d7950216dc0c5be5d65d0cbed13924c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78a6d0e30d7950216dc0c5be5d65d0cbed13924c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/78a6d0e30d7950216dc0c5be5d65d0cbed13924c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/78a6d0e30d7950216dc0c5be5d65d0cbed13924c/comments", "author": null, "committer": null, "parents": [{"sha": "0e804ce39a22ca660f48893f9541f6a4d8a17e56", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0e804ce39a22ca660f48893f9541f6a4d8a17e56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0e804ce39a22ca660f48893f9541f6a4d8a17e56"}], "stats": {"total": 7, "additions": 2, "deletions": 5}, "files": [{"sha": "3c469750e9d0ee4d20576f408a4dfaed0ca01862", "filename": "gcc/cp/tree.c", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a6d0e30d7950216dc0c5be5d65d0cbed13924c/gcc%2Fcp%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a6d0e30d7950216dc0c5be5d65d0cbed13924c/gcc%2Fcp%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftree.c?ref=78a6d0e30d7950216dc0c5be5d65d0cbed13924c", "patch": "@@ -674,9 +674,6 @@ build_aggr_init_expr (tree type, tree init)\n   else\n     rval = init;\n \n-  if (location_t loc = EXPR_LOCATION (init))\n-    SET_EXPR_LOCATION (rval, loc);\n-\n   return rval;\n }\n "}, {"sha": "ec10ddd2be8ff4ba684627036c78bfa6b3654f84", "filename": "gcc/testsuite/g++.dg/cpp1y/constexpr-nsdmi7b.C", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/78a6d0e30d7950216dc0c5be5d65d0cbed13924c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fconstexpr-nsdmi7b.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/78a6d0e30d7950216dc0c5be5d65d0cbed13924c/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fconstexpr-nsdmi7b.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1y%2Fconstexpr-nsdmi7b.C?ref=78a6d0e30d7950216dc0c5be5d65d0cbed13924c", "patch": "@@ -20,8 +20,8 @@ bar()\n {\n   A a = foo();\n   a.p->n = 5;\n-  return a; // { dg-error \"non-.constexpr.\" }\n-}\n+  return a;\n+} // { dg-error \"non-.constexpr.\" }\n \n constexpr int\n baz()"}]}