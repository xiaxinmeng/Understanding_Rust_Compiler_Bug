{"sha": "dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0", "node_id": "C_kwDOANBUbNoAKGRjZjhmZTFlZWFiNjY4YTRkMjRiY2M0YmFhM2FkMTg1ZGJmMWI1ZTA", "commit": {"author": {"name": "Jonathan Yong", "email": "10walls@gmail.com", "date": "2022-01-15T13:24:33Z"}, "committer": {"name": "Jonathan Yong", "email": "10walls@gmail.com", "date": "2022-01-15T13:32:05Z"}, "message": "libgcc: Fix __gthr_i486_lock_cmp_xchg clobber for Windows\n\n2022-01-14  David  <gccbugzilla@limegreensocks.com>\n\nlibgcc/\n\t* config/i386/gthr-win32.c (__gthr_i486_lock_cmp_xchg):\n\tRemove inlined version, Windows 95 is no longer relevant.\n\t* config/i386/gthr-win32.h\n\t(__GTHREAD_I486_INLINE_LOCK_PRIMITIVES): unset.", "tree": {"sha": "739100c159b97fd54143bbf994ef53718df02cba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/739100c159b97fd54143bbf994ef53718df02cba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0/comments", "author": {"login": "jon-y", "id": 4688224, "node_id": "MDQ6VXNlcjQ2ODgyMjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4688224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jon-y", "html_url": "https://github.com/jon-y", "followers_url": "https://api.github.com/users/jon-y/followers", "following_url": "https://api.github.com/users/jon-y/following{/other_user}", "gists_url": "https://api.github.com/users/jon-y/gists{/gist_id}", "starred_url": "https://api.github.com/users/jon-y/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jon-y/subscriptions", "organizations_url": "https://api.github.com/users/jon-y/orgs", "repos_url": "https://api.github.com/users/jon-y/repos", "events_url": "https://api.github.com/users/jon-y/events{/privacy}", "received_events_url": "https://api.github.com/users/jon-y/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jon-y", "id": 4688224, "node_id": "MDQ6VXNlcjQ2ODgyMjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4688224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jon-y", "html_url": "https://github.com/jon-y", "followers_url": "https://api.github.com/users/jon-y/followers", "following_url": "https://api.github.com/users/jon-y/following{/other_user}", "gists_url": "https://api.github.com/users/jon-y/gists{/gist_id}", "starred_url": "https://api.github.com/users/jon-y/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jon-y/subscriptions", "organizations_url": "https://api.github.com/users/jon-y/orgs", "repos_url": "https://api.github.com/users/jon-y/repos", "events_url": "https://api.github.com/users/jon-y/events{/privacy}", "received_events_url": "https://api.github.com/users/jon-y/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "617db51d7ebef18912c158a890728e164f2d8927", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/617db51d7ebef18912c158a890728e164f2d8927", "html_url": "https://github.com/Rust-GCC/gccrs/commit/617db51d7ebef18912c158a890728e164f2d8927"}], "stats": {"total": 25, "additions": 2, "deletions": 23}, "files": [{"sha": "fad8f8aca1ee3b67f6eeac3415f2f91d9a4f7283", "filename": "libgcc/config/i386/gthr-win32.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0/libgcc%2Fconfig%2Fi386%2Fgthr-win32.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0/libgcc%2Fconfig%2Fi386%2Fgthr-win32.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Fi386%2Fgthr-win32.c?ref=dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0", "patch": "@@ -31,8 +31,6 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n #ifndef __GTHREAD_HIDE_WIN32API\n # define __GTHREAD_HIDE_WIN32API 1\n #endif\n-#undef  __GTHREAD_I486_INLINE_LOCK_PRIMITIVES\n-#define __GTHREAD_I486_INLINE_LOCK_PRIMITIVES\n #include \"gthr-win32.h\"\n \n /* Windows32 threads specific definitions. The windows32 threading model"}, {"sha": "6f70e9b9deab9722d42c3382abb070099c76eeb5", "filename": "libgcc/config/i386/gthr-win32.h", "status": "modified", "additions": 2, "deletions": 21, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0/libgcc%2Fconfig%2Fi386%2Fgthr-win32.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0/libgcc%2Fconfig%2Fi386%2Fgthr-win32.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fconfig%2Fi386%2Fgthr-win32.h?ref=dcf8fe1eeab668a4d24bcc4baa3ad185dbf1b5e0", "patch": "@@ -374,28 +374,9 @@ extern int _CRT_MT;\n extern int __mingwthr_key_dtor (unsigned long, void (*) (void *));\n #endif /* _WIN32 && !__CYGWIN__ */\n \n-/* The Windows95 kernel does not export InterlockedCompareExchange.\n-   This provides a substitute.   When building apps that reference\n-   gthread_mutex_try_lock, the  __GTHREAD_I486_INLINE_LOCK_PRIMITIVES\n-   macro  must be defined if Windows95 is a target.  Currently\n-   gthread_mutex_try_lock is not referenced by libgcc or libstdc++.  */\n-#ifdef __GTHREAD_I486_INLINE_LOCK_PRIMITIVES\n-static inline long\n-__gthr_i486_lock_cmp_xchg(long *__dest, long __xchg, long __comperand)\n-{\n-  long result;\n-  __asm__ __volatile__ (\"\\n\\\n-\tlock\\n\\\n-\tcmpxchg{l} {%4, %1|%1, %4}\\n\"\n-\t: \"=a\" (result), \"=m\" (*__dest)\n-\t: \"0\" (__comperand), \"m\" (*__dest), \"r\" (__xchg)\n-\t: \"cc\");\n-  return result;\n-}\n-#define __GTHR_W32_InterlockedCompareExchange __gthr_i486_lock_cmp_xchg\n-#else  /* __GTHREAD_I486_INLINE_LOCK_PRIMITIVES */\n+/* __GTHR_W32_InterlockedCompareExchange is left over from win95,\n+   which did not support InterlockedCompareExchange. */\n #define __GTHR_W32_InterlockedCompareExchange InterlockedCompareExchange\n-#endif /* __GTHREAD_I486_INLINE_LOCK_PRIMITIVES */\n \n static inline int\n __gthread_active_p (void)"}]}