{"sha": "877ef6287904af71c811883a7a6e985ca10281ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODc3ZWY2Mjg3OTA0YWY3MWM4MTE4ODNhN2E2ZTk4NWNhMTAyODFlYw==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2019-06-20T11:56:50Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2019-06-20T11:56:50Z"}, "message": "re PR fortran/90937 (ICE: in gfc_get_symbol_decl, at fortran/trans-decl.c:1538)\n\n2019-06-20  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/90937\n\t* trans-types.c (get_formal_from_actual_arglist): Get symbol from\n\tcurrent namespace so it will be freed later.  If symbol is of type\n\tcharacter, get an empty character length.\n\n2019-06-20  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR fortran/90937\n\t* gfortran.dg/external_procedure_4.f90: New test.\n\nFrom-SVN: r272506", "tree": {"sha": "d4708a67002a1d913d41760bb9133963403c464d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d4708a67002a1d913d41760bb9133963403c464d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/877ef6287904af71c811883a7a6e985ca10281ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/877ef6287904af71c811883a7a6e985ca10281ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/877ef6287904af71c811883a7a6e985ca10281ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/877ef6287904af71c811883a7a6e985ca10281ec/comments", "author": null, "committer": null, "parents": [{"sha": "1194e1971ac9ab84b633ee14c5a77f0e475990ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1194e1971ac9ab84b633ee14c5a77f0e475990ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1194e1971ac9ab84b633ee14c5a77f0e475990ab"}], "stats": {"total": 45, "additions": 40, "deletions": 5}, "files": [{"sha": "30bf112bdabe74076e771cd98ddff5f2f4afe8c6", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=877ef6287904af71c811883a7a6e985ca10281ec", "patch": "@@ -1,7 +1,14 @@\n+2019-06-20  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/90937\n+\t* trans-types.c (get_formal_from_actual_arglist): Get symbol from\n+\tcurrent namespace so it will be freed later.  If symbol is of type\n+\tcharacter, get an empty character length.\n+\n 2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/69499\n-\t* match.c (gfc_match_select_type):  SELECT TYPE is an executable \n+\t* match.c (gfc_match_select_type):  SELECT TYPE is an executable\n \tstatement, and cannot appear in MODULE or SUBMODULE scope.\n \n 2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n@@ -18,7 +25,7 @@\n \n 2019-06-19  Jim MacArthur  <jim.macarthur@codethink.co.uk>\n \t    Mark Eggleston  <mark.eggleston@codethink.com>\n-\t\n+\n \tPR fortran/89103\n \t* gfortran.texi: Add -fdec-blank-format-item\n \t* invoke.texi: Add option to list of options.\n@@ -105,7 +112,7 @@\n \n \tPR fortran/90002\n \t* array.c (gfc_free_array_spec): When freeing an array-spec, avoid\n-\tan ICE for assumed-shape coarrays \n+\tan ICE for assumed-shape coarrays.\n \n 2019-06-08  Paul Thomas  <pault@gcc.gnu.org>\n "}, {"sha": "1dbb842a1c417906e5f9b961e85eeb84beea2a32", "filename": "gcc/fortran/trans-types.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ffortran%2Ftrans-types.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ffortran%2Ftrans-types.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-types.c?ref=877ef6287904af71c811883a7a6e985ca10281ec", "patch": "@@ -2997,14 +2997,18 @@ get_formal_from_actual_arglist (gfc_symbol *sym, gfc_actual_arglist *actual_args\n       if (a->expr)\n \t{\n \t  snprintf (name, GFC_MAX_SYMBOL_LEN, \"_formal_%d\", var_num ++);\n-\t  gfc_get_symbol (name, NULL, &s);\n+\t  gfc_get_symbol (name, gfc_current_ns, &s);\n \t  if (a->expr->ts.type == BT_PROCEDURE)\n \t    {\n \t      s->attr.flavor = FL_PROCEDURE;\n \t    }\n \t  else\n \t    {\n \t      s->ts = a->expr->ts;\n+\n+\t      if (s->ts.type == BT_CHARACTER)\n+\t\t  s->ts.u.cl = gfc_get_charlen ();\n+\n \t      s->ts.deferred = 0;\n \t      s->ts.is_iso_c = 0;\n \t      s->ts.is_c_interop = 0;"}, {"sha": "c91f8ed98a252d12e2ba49719675f7007c1bd0b1", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=877ef6287904af71c811883a7a6e985ca10281ec", "patch": "@@ -1,3 +1,8 @@\n+2019-06-20  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR fortran/90937\n+\t* gfortran.dg/external_procedure_4.f90: New test.\n+\n 2019-06-20  Tom de Vries  <tdevries@suse.de>\n \n \t* gcc.dg/pr90866-2.c: Require global_constructor.\n@@ -118,7 +123,7 @@\n \tPR fortran/89103\n \t* gfortran.dg/dec_format_empty_item_1.f: New test.\n \t* gfortran.dg/dec_format_empty_item_2.f: New test.\n-\t* gfortran.dg/dec_format_empty_item_3.f: New test. \n+\t* gfortran.dg/dec_format_empty_item_3.f: New test.\n \n 2019-06-19  Kugan Vivekanandarajah  <kugan.vivekanandarajah@linaro.org>\n "}, {"sha": "403f1732e26de4336036841462f07fd4c761a442", "filename": "gcc/testsuite/gfortran.dg/external_procedure_4.f90", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fexternal_procedure_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/877ef6287904af71c811883a7a6e985ca10281ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fexternal_procedure_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fexternal_procedure_4.f90?ref=877ef6287904af71c811883a7a6e985ca10281ec", "patch": "@@ -0,0 +1,19 @@\n+! { dg-do compile }\n+! PR fortran/90937 - this used to cause an ICE.\n+! Original test case by Toon Moene.\n+subroutine lfidiff\n+\n+   implicit none\n+\n+   contains \n+\n+      subroutine grlfi(cdnom)\n+\n+         character(len=*) cdnom(:)\n+         character(len=len(cdnom)) clnoma\n+\n+         call lficas(clnoma)\n+\n+      end subroutine grlfi\n+\n+end subroutine lfidiff"}]}