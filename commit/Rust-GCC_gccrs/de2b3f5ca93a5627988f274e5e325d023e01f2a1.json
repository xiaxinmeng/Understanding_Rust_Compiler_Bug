{"sha": "de2b3f5ca93a5627988f274e5e325d023e01f2a1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGUyYjNmNWNhOTNhNTYyNzk4OGYyNzRlNWUzMjVkMDIzZTAxZjJhMQ==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2017-03-23T14:55:48Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2017-03-23T14:55:48Z"}, "message": "[ARM] PR target/71436: Restrict *load_multiple pattern till after LRA\n\n\tPR target/71436\n\t* config/arm/arm.md (*load_multiple): Add reload_completed to\n\tmatching condition.\n\n\t* gcc.c-torture/compile/pr71436.c: New test.\n\nFrom-SVN: r246419", "tree": {"sha": "db67b3141ce9a6dd484355088107db04d452f91a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/db67b3141ce9a6dd484355088107db04d452f91a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/de2b3f5ca93a5627988f274e5e325d023e01f2a1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de2b3f5ca93a5627988f274e5e325d023e01f2a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de2b3f5ca93a5627988f274e5e325d023e01f2a1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de2b3f5ca93a5627988f274e5e325d023e01f2a1/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2e6315ef8c8a0f607fe86c7b7cf7d89549caa1e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e6315ef8c8a0f607fe86c7b7cf7d89549caa1e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e6315ef8c8a0f607fe86c7b7cf7d89549caa1e9"}], "stats": {"total": 51, "additions": 50, "deletions": 1}, "files": [{"sha": "98254eb4c80651fc874845020578ae29043660e9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=de2b3f5ca93a5627988f274e5e325d023e01f2a1", "patch": "@@ -1,3 +1,9 @@\n+2017-03-23  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR target/71436\n+\t* config/arm/arm.md (*load_multiple): Add reload_completed to\n+\tmatching condition.\n+\n 2017-03-23  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n             Richard Biener  <rguenth@suse.com>\n "}, {"sha": "71cc109e102255f36f26e449c5ae23f1188872b6", "filename": "gcc/config/arm/arm.md", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2Fconfig%2Farm%2Farm.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2Fconfig%2Farm%2Farm.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.md?ref=de2b3f5ca93a5627988f274e5e325d023e01f2a1", "patch": "@@ -11832,12 +11832,15 @@\n \n ;; Patterns in ldmstm.md don't cover more than 4 registers. This pattern covers\n ;; large lists without explicit writeback generated for APCS_FRAME epilogue.\n+;; The operands are validated through the load_multiple_operation\n+;; match_parallel predicate rather than through constraints so enable it only\n+;; after reload.\n (define_insn \"*load_multiple\"\n   [(match_parallel 0 \"load_multiple_operation\"\n     [(set (match_operand:SI 2 \"s_register_operand\" \"=rk\")\n           (mem:SI (match_operand:SI 1 \"s_register_operand\" \"rk\")))\n         ])]\n-  \"TARGET_32BIT\"\n+  \"TARGET_32BIT && reload_completed\"\n   \"*\n   {\n     arm_output_multireg_pop (operands, /*return_pc=*/false,"}, {"sha": "14b751620388515ea6301e27e3f94dadd94e02f2", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=de2b3f5ca93a5627988f274e5e325d023e01f2a1", "patch": "@@ -1,3 +1,8 @@\n+2017-03-23  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR target/71436\n+\t* gcc.c-torture/compile/pr71436.c: New test.\n+\n 2017-03-23  Bill Schmidt  <wschmidt@linux.vnet.ibm.com>\n             Richard Biener  <rguenther@suse.de>\n "}, {"sha": "ab08d5d369c769fc9e411238fcf1379705e576f2", "filename": "gcc/testsuite/gcc.c-torture/compile/pr71436.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr71436.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de2b3f5ca93a5627988f274e5e325d023e01f2a1/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr71436.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr71436.c?ref=de2b3f5ca93a5627988f274e5e325d023e01f2a1", "patch": "@@ -0,0 +1,35 @@\n+/* PR target/71436.  */\n+\n+#pragma pack(1)\n+struct S0\n+{\n+  volatile int f0;\n+  short f2;\n+};\n+\n+void foo (struct S0 *);\n+int a, d;\n+static struct S0 b[5];\n+static struct S0 c;\n+void fn1 ();\n+void\n+main ()\n+{\n+  {\n+    struct S0 e;\n+    for (; d; fn1 ())\n+      {\n+        {\n+          a = 3;\n+          for (; a >= 0; a -= 1)\n+            {\n+              {\n+                e = c;\n+              }\n+              b[a] = e;\n+            }\n+        }\n+      }\n+  }\n+  foo (b);\n+}"}]}