{"sha": "a46cde680750f08984a35106e74d415a50e82991", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQ2Y2RlNjgwNzUwZjA4OTg0YTM1MTA2ZTc0ZDQxNWE1MGU4Mjk5MQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-12-02T15:41:17Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-12-02T15:41:17Z"}, "message": "[multiple changes]\n\n2011-12-02  Javier Miranda  <miranda@adacore.com>\n\n\t* sem_ch3.adb (Constrain_Access): Undo previous\n\tpatch for this routine. Required since the RM rule 3.7.1(7/3)\n\tapplies to all access types.\n\n2011-12-02  Bob Duff  <duff@adacore.com>\n\n\t* sem_ch6.adb: Minor comment fix.\n\nFrom-SVN: r181926", "tree": {"sha": "14d4af4bcc4645b6d12ca16c261f6082f25cba41", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/14d4af4bcc4645b6d12ca16c261f6082f25cba41"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a46cde680750f08984a35106e74d415a50e82991", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a46cde680750f08984a35106e74d415a50e82991", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a46cde680750f08984a35106e74d415a50e82991", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a46cde680750f08984a35106e74d415a50e82991/comments", "author": null, "committer": null, "parents": [{"sha": "d0234c7ea568a43931259a649dfc1bb2bf6e4d93", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d0234c7ea568a43931259a649dfc1bb2bf6e4d93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d0234c7ea568a43931259a649dfc1bb2bf6e4d93"}], "stats": {"total": 39, "additions": 27, "deletions": 12}, "files": [{"sha": "8838582bd22c067b30f8b55bc3292a1a8a7907f9", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a46cde680750f08984a35106e74d415a50e82991/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a46cde680750f08984a35106e74d415a50e82991/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=a46cde680750f08984a35106e74d415a50e82991", "patch": "@@ -1,3 +1,13 @@\n+2011-12-02  Javier Miranda  <miranda@adacore.com>\n+\n+\t* sem_ch3.adb (Constrain_Access): Undo previous\n+\tpatch for this routine. Required since the RM rule 3.7.1(7/3)\n+\tapplies to all access types.\n+\n+2011-12-02  Bob Duff  <duff@adacore.com>\n+\n+\t* sem_ch6.adb: Minor comment fix.\n+\n 2011-12-02  Joel Sherrill <joel.sherrill@oarcorp.com>\n \n \t* s-tpopsp-rtems.adb: Use ATCB_Key rather than RTEMS_Ada_Self variable"}, {"sha": "e7b5327c430dfefda6c44004f8f31147c7152dcf", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 16, "deletions": 11, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a46cde680750f08984a35106e74d415a50e82991/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a46cde680750f08984a35106e74d415a50e82991/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=a46cde680750f08984a35106e74d415a50e82991", "patch": "@@ -10694,18 +10694,24 @@ package body Sem_Ch3 is\n             return;\n          end if;\n \n-         if Ekind (T) = E_General_Access_Type\n+         --  Enforce rule that the constraint is illegal if there is an\n+         --  unconstrained view of the designated type. This means that the\n+         --  partial view (either a private type declaration or a derivation\n+         --  from a private type) has no discriminants. (Defect Report\n+         --  8652/0008, Technical Corrigendum 1, checked by ACATS B371001).\n+\n+         --  Rule updated for Ada 2005: the private type is said to have\n+         --  a constrained partial view, given that objects of the type\n+         --  can be declared. Furthermore, the rule applies to all access\n+         --  types, unlike the rule concerning default discriminants (see\n+         --  RM 3.7.1(7/3))\n+\n+         if (Ekind (T) = E_General_Access_Type\n+              or else Ada_Version >= Ada_2005)\n            and then Has_Private_Declaration (Desig_Type)\n            and then In_Open_Scopes (Scope (Desig_Type))\n            and then Has_Discriminants (Desig_Type)\n          then\n-            --  Enforce rule that the constraint is illegal if there is\n-            --  an unconstrained view of the designated type. This means\n-            --  that the partial view (either a private type declaration or\n-            --  a derivation from a private type) has no discriminants.\n-            --  (Defect Report 8652/0008, Technical Corrigendum 1, checked\n-            --  by ACATS B371001).\n-\n             declare\n                Pack  : constant Node_Id :=\n                          Unit_Declaration_Node (Scope (Desig_Type));\n@@ -10733,9 +10739,8 @@ package body Sem_Ch3 is\n                      then\n                         if No (Discriminant_Specifications (Decl)) then\n                            Error_Msg_N\n-                            (\"cannot constrain general access type if \" &\n-                               \"designated type has constrained partial view\",\n-                                S);\n+                            (\"cannot constrain access type if designated \" &\n+                               \"type has constrained partial view\", S);\n                         end if;\n \n                         exit;"}, {"sha": "903950d8f8d3752d89ed74a8ec59109e6333954d", "filename": "gcc/ada/sem_ch6.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a46cde680750f08984a35106e74d415a50e82991/gcc%2Fada%2Fsem_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a46cde680750f08984a35106e74d415a50e82991/gcc%2Fada%2Fsem_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch6.adb?ref=a46cde680750f08984a35106e74d415a50e82991", "patch": "@@ -8936,7 +8936,7 @@ package body Sem_Ch6 is\n                               Set_Is_Immediately_Visible (E, False);\n                            else\n                               --  Work done in Override_Dispatching_Operation,\n-                              --  so nothing else need to be done here.\n+                              --  so nothing else needs to be done here.\n \n                               null;\n                            end if;"}]}