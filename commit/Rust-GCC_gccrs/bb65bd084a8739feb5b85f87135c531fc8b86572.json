{"sha": "bb65bd084a8739feb5b85f87135c531fc8b86572", "node_id": "C_kwDOANBUbNoAKGJiNjViZDA4NGE4NzM5ZmViNWI4NWY4NzEzNWM1MzFmYzhiODY1NzI", "commit": {"author": {"name": "Takayuki 'January June' Suwa", "email": "jjsuwa_sys3175@yahoo.co.jp", "date": "2023-01-12T04:25:58Z"}, "committer": {"name": "Max Filippov", "email": "jcmvbkbc@gmail.com", "date": "2023-01-12T12:44:06Z"}, "message": "xtensa: Tune \"*btrue\" insn pattern\n\nThis branch instruction has short encoding if EQ/NE comparison against\nimmediate zero when the Code Density Option is enabled, but its \"length\"\nattribute was only for normal encoding.  This patch fixes it.\n\nThis patch also prevents undesireable replacement the comparison immediate\nzero of the instruction (short encoding, as mentioned above) with a\nregister that has value of zero (normal encoding) by the postreload pass.\n\ngcc/ChangeLog:\n\n\t* config/xtensa/xtensa.md (*btrue):\n\tCorrect value of the attribute \"length\" that depends on\n\tTARGET_DENSITY and operands, and add '?' character to the register\n\tconstraint of the compared operand.", "tree": {"sha": "bc4b89e951591dc80211252ad4198caca507066e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bc4b89e951591dc80211252ad4198caca507066e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb65bd084a8739feb5b85f87135c531fc8b86572", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb65bd084a8739feb5b85f87135c531fc8b86572", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb65bd084a8739feb5b85f87135c531fc8b86572", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb65bd084a8739feb5b85f87135c531fc8b86572/comments", "author": {"login": "jjsuwa-sys3175", "id": 73290592, "node_id": "MDQ6VXNlcjczMjkwNTky", "avatar_url": "https://avatars.githubusercontent.com/u/73290592?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jjsuwa-sys3175", "html_url": "https://github.com/jjsuwa-sys3175", "followers_url": "https://api.github.com/users/jjsuwa-sys3175/followers", "following_url": "https://api.github.com/users/jjsuwa-sys3175/following{/other_user}", "gists_url": "https://api.github.com/users/jjsuwa-sys3175/gists{/gist_id}", "starred_url": "https://api.github.com/users/jjsuwa-sys3175/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jjsuwa-sys3175/subscriptions", "organizations_url": "https://api.github.com/users/jjsuwa-sys3175/orgs", "repos_url": "https://api.github.com/users/jjsuwa-sys3175/repos", "events_url": "https://api.github.com/users/jjsuwa-sys3175/events{/privacy}", "received_events_url": "https://api.github.com/users/jjsuwa-sys3175/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jcmvbkbc", "id": 166731, "node_id": "MDQ6VXNlcjE2NjczMQ==", "avatar_url": "https://avatars.githubusercontent.com/u/166731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jcmvbkbc", "html_url": "https://github.com/jcmvbkbc", "followers_url": "https://api.github.com/users/jcmvbkbc/followers", "following_url": "https://api.github.com/users/jcmvbkbc/following{/other_user}", "gists_url": "https://api.github.com/users/jcmvbkbc/gists{/gist_id}", "starred_url": "https://api.github.com/users/jcmvbkbc/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jcmvbkbc/subscriptions", "organizations_url": "https://api.github.com/users/jcmvbkbc/orgs", "repos_url": "https://api.github.com/users/jcmvbkbc/repos", "events_url": "https://api.github.com/users/jcmvbkbc/events{/privacy}", "received_events_url": "https://api.github.com/users/jcmvbkbc/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "dc22cf461278ace754042d9388a62afb002dfa0e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dc22cf461278ace754042d9388a62afb002dfa0e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dc22cf461278ace754042d9388a62afb002dfa0e"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "b4989832169c7c23309e99f34a3fb01718a3d2ce", "filename": "gcc/config/xtensa/xtensa.md", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb65bd084a8739feb5b85f87135c531fc8b86572/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb65bd084a8739feb5b85f87135c531fc8b86572/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.md?ref=bb65bd084a8739feb5b85f87135c531fc8b86572", "patch": "@@ -1679,7 +1679,7 @@\n   [(set (pc)\n \t(if_then_else (match_operator 3 \"branch_operator\"\n \t\t\t[(match_operand:SI 0 \"register_operand\" \"r,r\")\n-\t\t\t (match_operand:SI 1 \"branch_operand\" \"K,r\")])\n+\t\t\t (match_operand:SI 1 \"branch_operand\" \"K,?r\")])\n \t\t      (label_ref (match_operand 2 \"\" \"\"))\n \t\t      (pc)))]\n   \"\"\n@@ -1688,7 +1688,14 @@\n }\n   [(set_attr \"type\"\t\"jump,jump\")\n    (set_attr \"mode\"\t\"none\")\n-   (set_attr \"length\"\t\"3,3\")])\n+   (set (attr \"length\")\n+        (if_then_else (match_test \"TARGET_DENSITY\n+\t\t\t\t   && CONST_INT_P (operands[1])\n+\t\t\t\t   && INTVAL (operands[1]) == 0\n+\t\t\t\t   && (GET_CODE (operands[3]) == EQ\n+\t\t\t\t       || GET_CODE (operands[3]) == NE)\")\n+                      (const_int 2)\n+                      (const_int 3)))])\n \n (define_insn \"*ubtrue\"\n   [(set (pc)"}]}