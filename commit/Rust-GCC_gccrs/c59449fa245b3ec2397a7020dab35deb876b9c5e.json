{"sha": "c59449fa245b3ec2397a7020dab35deb876b9c5e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzU5NDQ5ZmEyNDViM2VjMjM5N2E3MDIwZGFiMzVkZWI4NzZiOWM1ZQ==", "commit": {"author": {"name": "Richard Guenther", "email": "rguenther@suse.de", "date": "2010-01-08T16:57:59Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2010-01-08T16:57:59Z"}, "message": "re PR lto/42528 (ICE with -flto and -fsigned-char)\n\n2010-01-08  Richard Guenther  <rguenther@suse.de>\n\n\tPR lto/42528\n\t* c.opt (fsigned-char): Also let LTO handle this option.\n\t(funsigned-char): Likewise.\n\n\tlto/\n\t* lto-lang.c (lto_handle_option): Handle -f[un]signed-char.\n\t(lto_init): Do not init char_type_node in a standard way\n\tbut according to flag_signed_char.\n\n\t* gcc.dg/lto/20100103-1_0.c: New testcase.\n\t* gcc.dg/lto/20100103-2_0.c: Likewise.\n\nFrom-SVN: r155740", "tree": {"sha": "277fb6ae3b56b939e10755bbdebd16395350b1a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/277fb6ae3b56b939e10755bbdebd16395350b1a0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c59449fa245b3ec2397a7020dab35deb876b9c5e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c59449fa245b3ec2397a7020dab35deb876b9c5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c59449fa245b3ec2397a7020dab35deb876b9c5e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c59449fa245b3ec2397a7020dab35deb876b9c5e/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c8ae061371b68ca6a1887f502f3ebebee28ff64f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8ae061371b68ca6a1887f502f3ebebee28ff64f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8ae061371b68ca6a1887f502f3ebebee28ff64f"}], "stats": {"total": 56, "additions": 53, "deletions": 3}, "files": [{"sha": "4f7f36f8048609c10ddc52de5ad21d7cac55ab4e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c59449fa245b3ec2397a7020dab35deb876b9c5e", "patch": "@@ -1,3 +1,9 @@\n+2010-01-08  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR lto/42528\n+\t* c.opt (fsigned-char): Also let LTO handle this option.\n+\t(funsigned-char): Likewise.\n+\n 2010-01-07  Richard Guenther  <rguenther@suse.de>\n \n \t* gimple.h (gss_for_code): Wrap gcc_assert in ENABLE_CHECKING."}, {"sha": "bdf9531ad80499869c59194a2bf9cfdce775f5f8", "filename": "gcc/c.opt", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Fc.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Fc.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc.opt?ref=c59449fa245b3ec2397a7020dab35deb876b9c5e", "patch": "@@ -769,7 +769,7 @@ C ObjC C++ ObjC++\n When \\\"signed\\\" or \\\"unsigned\\\" is not given make the bitfield signed\n \n fsigned-char\n-C ObjC C++ ObjC++\n+C ObjC C++ ObjC++ LTO\n Make \\\"char\\\" signed by default\n \n fsquangle\n@@ -802,7 +802,7 @@ C ObjC C++ ObjC++\n When \\\"signed\\\" or \\\"unsigned\\\" is not given make the bitfield unsigned\n \n funsigned-char\n-C ObjC C++ ObjC++\n+C ObjC C++ ObjC++ LTO\n Make \\\"char\\\" unsigned by default\n \n fuse-cxa-atexit"}, {"sha": "5e52527a29f4384fcc4cde1e8537586b18e6beae", "filename": "gcc/lto/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Flto%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Flto%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2FChangeLog?ref=c59449fa245b3ec2397a7020dab35deb876b9c5e", "patch": "@@ -1,3 +1,10 @@\n+2010-01-08  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR lto/42528\n+\t* lto-lang.c (lto_handle_option): Handle -f[un]signed-char.\n+\t(lto_init): Do not init char_type_node in a standard way\n+\tbut according to flag_signed_char.\n+\n 2010-01-03  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR lto/41564"}, {"sha": "05577a29371f1a1c08f8c6c90251d11b64cc539e", "filename": "gcc/lto/lto-lang.c", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Flto%2Flto-lang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Flto%2Flto-lang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2Flto-lang.c?ref=c59449fa245b3ec2397a7020dab35deb876b9c5e", "patch": "@@ -632,6 +632,14 @@ lto_handle_option (size_t scode, const char *arg, int value ATTRIBUTE_UNUSED)\n       warn_psabi = value;\n       break;\n \n+    case OPT_fsigned_char:\n+      flag_signed_char = value;\n+      break;\n+\n+    case OPT_funsigned_char:\n+      flag_signed_char = !value;\n+      break;\n+\n     default:\n       break;\n     }\n@@ -1036,8 +1044,11 @@ lto_init (void)\n   /* Share char_type_node with whatever would be the default for the target.\n      char_type_node will be used for internal types such as\n      va_list_type_node but will not be present in the lto stream.  */\n+  /* ???  This breaks the more common case of consistent but non-standard\n+     setting of flag_signed_char, so share according to flag_signed_char.\n+     See PR42528.  */\n   char_type_node\n-    = DEFAULT_SIGNED_CHAR ? signed_char_type_node : unsigned_char_type_node;\n+    = flag_signed_char ? signed_char_type_node : unsigned_char_type_node;\n \n   /* Tell the middle end what type to use for the size of objects.  */\n   if (strcmp (SIZE_TYPE, \"unsigned int\") == 0)"}, {"sha": "f21a58379effabedcfac72c46aa1e5a5df953310", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c59449fa245b3ec2397a7020dab35deb876b9c5e", "patch": "@@ -1,3 +1,9 @@\n+2010-01-08  Richard Guenther  <rguenther@suse.de>\n+\n+\tPR lto/42528\n+\t* gcc.dg/lto/20100103-1_0.c: New testcase.\n+\t* gcc.dg/lto/20100103-2_0.c: Likewise.\n+\n 2010-01-08  Tobias Burnus  <burnus@net-b.de\n \n \tPR/fortran 25829"}, {"sha": "8e1b48417612aa909331378636e409ac40bce890", "filename": "gcc/testsuite/gcc.dg/lto/20100103-1_0.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20100103-1_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20100103-1_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20100103-1_0.c?ref=c59449fa245b3ec2397a7020dab35deb876b9c5e", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-lto-do link } */\n+/* { dg-lto-options {{-funsigned-char -flto} {-fsigned-char -flto}} } */\n+\n+char *foo;\n+int main()\n+{\n+  foo = \"bar\";\n+}"}, {"sha": "1fb6a7b3e2aba3ffcf13ecda84442f3e281c4350", "filename": "gcc/testsuite/gcc.dg/lto/20100103-2_0.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20100103-2_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c59449fa245b3ec2397a7020dab35deb876b9c5e/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20100103-2_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2F20100103-2_0.c?ref=c59449fa245b3ec2397a7020dab35deb876b9c5e", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-lto-do link } */\n+/* { dg-lto-options {{-O -flto -funsigned-char} {-O -flto -fsigned-char}} } */\n+\n+char p[32] = \"\";\n+int main ()\n+{\n+  if (__builtin___strcpy_chk (p + 1, \"vwxyz\",\n+\t\t\t      __builtin_object_size (p + 1, 0)) != p + 1)\n+    __builtin_abort ();\n+  return 0;\n+} \n+"}]}