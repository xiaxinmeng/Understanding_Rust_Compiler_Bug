{"sha": "e4905f11852d722cd711b53a5626245528ace1d2", "node_id": "C_kwDOANBUbNoAKGU0OTA1ZjExODUyZDcyMmNkNzExYjUzYTU2MjYyNDU1MjhhY2UxZDI", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-11T15:35:45Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2022-05-13T12:32:22Z"}, "message": "libstdc++: Add macros for the inline namespace std::_V2\n\nUse macros to open and close the inline namespace _V2 that is used for\nABI versioning of individual components such as chrono::system_clock.\n\nThis allows the namespace to be hidden in the docs generated by Doxygen,\nso that we document std::foo instead of std::_V2::foo.\n\nThis also makes it easy to remove that namespace entirely for the\ngnu-versioned-namespace build, where everything is already versioned as\nstd::__8 and there are no backwards compatibility guarantees.\n\nlibstdc++-v3/ChangeLog:\n\n\t* doc/doxygen/user.cfg.in (PREDEFINED): Expand new macros to\n\tnothing.\n\t* include/bits/c++config (_GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE)\n\t(_GLIBCXX_END_INLINE_ABI_NAMESPACE): Define new macros.\n\t* include/bits/algorithmfwd.h (_V2::__rotate): Use new macros\n\tfor the namespace.\n\t* include/bits/chrono.h (chrono::_V2::system_clock): Likewise.\n\t* include/bits/stl_algo.h (_V2::__rotate): Likewise.\n\t* include/std/condition_variable (_V2::condition_variable_any):\n\tLikewise.\n\t* include/std/system_error (_V2::error_category): Likewise.", "tree": {"sha": "715f08b60d0bae7d829a8de1577ea4b7200f6e6a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/715f08b60d0bae7d829a8de1577ea4b7200f6e6a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4905f11852d722cd711b53a5626245528ace1d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4905f11852d722cd711b53a5626245528ace1d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4905f11852d722cd711b53a5626245528ace1d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4905f11852d722cd711b53a5626245528ace1d2/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4163b0be816f596147fa9a2732fc652e4ea9572c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4163b0be816f596147fa9a2732fc652e4ea9572c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4163b0be816f596147fa9a2732fc652e4ea9572c"}], "stats": {"total": 46, "additions": 28, "deletions": 18}, "files": [{"sha": "2dbed727013d9da841ff8752ed4a727eb2d169e2", "filename": "libstdc++-v3/doc/doxygen/user.cfg.in", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Fdoc%2Fdoxygen%2Fuser.cfg.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Fdoc%2Fdoxygen%2Fuser.cfg.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fdoc%2Fdoxygen%2Fuser.cfg.in?ref=e4905f11852d722cd711b53a5626245528ace1d2", "patch": "@@ -2347,6 +2347,8 @@ PREDEFINED             = __cplusplus=202002L \\\n                          \"_GLIBCXX_END_NAMESPACE_CONTAINER= \" \\\n                          \"_GLIBCXX_END_NAMESPACE_CXX11= \" \\\n                          \"_GLIBCXX_END_NAMESPACE_LDBL= \" \\\n+\t\t\t \"-D_GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(X)= \" \\\n+\t\t\t \"-D_GLIBCXX_END_INLINE_ABI_NAMESPACE(X)= \" \\\n                          \"_GLIBCXX_TEMPLATE_ARGS=...  \" \\\n                          \"_GLIBCXX_DEPRECATED= \" \\\n                          \"_GLIBCXX_DEPRECATED_SUGGEST(E)= \" \\"}, {"sha": "aacc34e09e871667b5f4a2274892856103ee9282", "filename": "libstdc++-v3/include/bits/algorithmfwd.h", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Falgorithmfwd.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Falgorithmfwd.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Falgorithmfwd.h?ref=e4905f11852d722cd711b53a5626245528ace1d2", "patch": "@@ -601,13 +601,14 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     _OIter\n     reverse_copy(_BIter, _BIter, _OIter);\n \n-  inline namespace _V2\n-  {\n-    template<typename _FIter>\n-      _GLIBCXX20_CONSTEXPR\n-      _FIter\n-      rotate(_FIter, _FIter, _FIter);\n-  }\n+_GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(_V2)\n+\n+  template<typename _FIter>\n+    _GLIBCXX20_CONSTEXPR\n+    _FIter\n+    rotate(_FIter, _FIter, _FIter);\n+\n+_GLIBCXX_END_INLINE_ABI_NAMESPACE(_V2)\n \n   template<typename _FIter, typename _OIter>\n     _GLIBCXX20_CONSTEXPR"}, {"sha": "150b0bc5834384a290bc58b900bce198022fe7a0", "filename": "libstdc++-v3/include/bits/c++config", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fc%2B%2Bconfig", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fc%2B%2Bconfig", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fc%2B%2Bconfig?ref=e4905f11852d722cd711b53a5626245528ace1d2", "patch": "@@ -345,13 +345,16 @@ namespace __gnu_cxx\n # define _GLIBCXX_DEFAULT_ABI_TAG\n #endif\n \n-// Defined if inline namespaces are used for versioning.\n+// Non-zero if inline namespaces are used for versioning the entire library.\n #define _GLIBCXX_INLINE_VERSION \n \n-// Inline namespace for symbol versioning.\n #if _GLIBCXX_INLINE_VERSION\n+// Inline namespace for symbol versioning of (nearly) everything in std.\n # define _GLIBCXX_BEGIN_NAMESPACE_VERSION namespace __8 {\n # define _GLIBCXX_END_NAMESPACE_VERSION }\n+// Unused when everything in std is versioned anyway.\n+# define _GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(X)\n+# define _GLIBCXX_END_INLINE_ABI_NAMESPACE(X)\n \n namespace std\n {\n@@ -376,8 +379,12 @@ _GLIBCXX_END_NAMESPACE_VERSION\n }\n \n #else\n+// Unused.\n # define _GLIBCXX_BEGIN_NAMESPACE_VERSION\n # define _GLIBCXX_END_NAMESPACE_VERSION\n+// Used to version individual components, e.g. std::_V2::error_category.\n+# define _GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(X) inline namespace X {\n+# define _GLIBCXX_END_INLINE_ABI_NAMESPACE(X)   } // inline namespace X\n #endif\n \n // Inline namespaces for special modes: debug, parallel."}, {"sha": "745f9a8135765c96d4f0e3ea09ed0f864c6fde02", "filename": "libstdc++-v3/include/bits/chrono.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchrono.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchrono.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchrono.h?ref=e4905f11852d722cd711b53a5626245528ace1d2", "patch": "@@ -1099,7 +1099,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     // compatibility definitions for previous versions.  At some\n     // point, when these clocks settle down, the inlined namespaces\n     // can be removed.  XXX GLIBCXX_ABI Deprecated\n-    inline namespace _V2 {\n+_GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(_V2)\n \n     /**\n      *  @brief System clock.\n@@ -1171,7 +1171,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     */\n     using high_resolution_clock = system_clock;\n \n-    } // end inline namespace _V2\n+_GLIBCXX_END_INLINE_ABI_NAMESPACE(_V2)\n \n #if __cplusplus >= 202002L\n     /// @addtogroup chrono"}, {"sha": "6619ff7bf1d6d777dde9c2fd51c284ef06e16cfe", "filename": "libstdc++-v3/include/bits/stl_algo.h", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_algo.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_algo.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fstl_algo.h?ref=e4905f11852d722cd711b53a5626245528ace1d2", "patch": "@@ -1190,8 +1190,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       return __m;\n     }\n \n-  inline namespace _V2\n-  {\n+_GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(_V2)\n \n   /// This is a helper function for the rotate algorithm.\n   template<typename _ForwardIterator>\n@@ -1398,7 +1397,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \t\t\t   std::__iterator_category(__first));\n     }\n \n-  } // namespace _V2\n+_GLIBCXX_END_INLINE_ABI_NAMESPACE(_V2)\n \n   /**\n    *  @brief Copy a sequence, rotating its elements."}, {"sha": "06c4ff9ebddd558ac9f6322c5ada24728bd39b47", "filename": "libstdc++-v3/include/std/condition_variable", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fcondition_variable", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fcondition_variable", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fcondition_variable?ref=e4905f11852d722cd711b53a5626245528ace1d2", "patch": "@@ -234,7 +234,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     void (*_M_cb)(void*);\n   };\n \n-  inline namespace _V2 {\n+_GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(_V2)\n \n   /// condition_variable_any\n   // Like above, but mutex is not required to have try_lock.\n@@ -439,7 +439,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n #endif\n   };\n \n-  } // end inline namespace\n+_GLIBCXX_END_INLINE_ABI_NAMESPACE(_V2)\n \n   /// @} group condition_variables\n _GLIBCXX_END_NAMESPACE_VERSION"}, {"sha": "dcef94e16e24214f5fedd30a44061aaea4743315", "filename": "libstdc++-v3/include/std/system_error", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fsystem_error", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4905f11852d722cd711b53a5626245528ace1d2/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fsystem_error", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fsystem_error?ref=e4905f11852d722cd711b53a5626245528ace1d2", "patch": "@@ -77,7 +77,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n #endif // C++17\n   /// @}\n \n-  inline namespace _V2 {\n+_GLIBCXX_BEGIN_INLINE_ABI_NAMESPACE(_V2)\n \n   /** @addtogroup diagnostics\n    * @{\n@@ -168,7 +168,8 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n   _GLIBCXX_CONST const error_category& system_category() noexcept;\n \n   /// @}\n-  } // end inline namespace\n+\n+_GLIBCXX_END_INLINE_ABI_NAMESPACE(_V2)\n \n   /** @addtogroup diagnostics\n    * @{"}]}