{"sha": "fd9852dfcd30f19bbf873debfaacbc454f8749a4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmQ5ODUyZGZjZDMwZjE5YmJmODczZGViZmFhY2JjNDU0Zjg3NDlhNA==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2010-10-19T22:58:11Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2010-10-19T22:58:11Z"}, "message": "re PR c++/46046 (internal compiler error with SFINAE expression in a template inside a template)\n\n/cp\n2010-10-19  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/46046\n\t* pt.c (add_to_template_args): Check extra_args for error_mark_node.\n\t(coerce_template_parms): Likewise for args.\n\n/testsuite\n2010-10-19  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/46046\n\t* g++.dg/template/crash104.C: New.\n\nFrom-SVN: r165708", "tree": {"sha": "60b2f6fd03268132254949332f9a28e47f108389", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/60b2f6fd03268132254949332f9a28e47f108389"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fd9852dfcd30f19bbf873debfaacbc454f8749a4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd9852dfcd30f19bbf873debfaacbc454f8749a4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fd9852dfcd30f19bbf873debfaacbc454f8749a4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fd9852dfcd30f19bbf873debfaacbc454f8749a4/comments", "author": null, "committer": null, "parents": [{"sha": "ad0c4c363dc8a34f5284c1f8c43847451d4e7a21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad0c4c363dc8a34f5284c1f8c43847451d4e7a21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad0c4c363dc8a34f5284c1f8c43847451d4e7a21"}], "stats": {"total": 125, "additions": 83, "deletions": 42}, "files": [{"sha": "8a084dfe9ae3a9445aae17969c296b70f875fd6f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 35, "deletions": 28, "changes": 63, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=fd9852dfcd30f19bbf873debfaacbc454f8749a4", "patch": "@@ -1,3 +1,9 @@\n+2010-10-19  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/46046\n+\t* pt.c (add_to_template_args): Check extra_args for error_mark_node.\n+\t(coerce_template_parms): Likewise for args.\n+\n 2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \tImplemented parsing @synthesize and @dynamic for Objective-C++.\n@@ -6,15 +12,15 @@\n \t(cp_parser_objc_at_dynamic_declaration): New.\n \t(cp_parser_objc_at_synthesize_declaration): New.\n \n-2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\t\n+2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \t* parser.c (cp_parser_objc_identifier_list): Check the return\n \tvalue of cp_parser_identifier and react if it is error_mark_node.\n \n 2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from apple/trunk branch on FSF servers.\n-\t\n+\n \t2005-03-01 Fariborz Jahanian <fjahanian@apple.com>\n \n         Radar 4451818\n@@ -27,36 +33,36 @@\n \tRadar 4330422\n \t* typeck.c (comp_ptr_ttypes_real): Remove the hack. un-volatize the\n \tartiificially 'volatized' type before doing pointer comparison.\n-\t\n+\n 2010-10-18  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/46015\n \t* semantics.c (finish_goto_stmt): Call mark_rvalue_use on computed\n \tgoto destination.\n \n 2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from apple/trunk branch on FSF servers.\n \n \t2006-04-19 Fariborz Jahanian <fjahanian@apple.com>\n \n         Radar 4516785\n \t* parser.c (cp_parser_simple_type_specifier): Don't lookup for\n \tobjc object types if type is scope qualified.\n-\t\n+\n 2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from apple/trunk branch on FSF servers.\n-\t\n+\n \t2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n \n         Radar 4133425\n \t* lex.c (unqualified_name_lookup_error): Issue diagnostic\n \tfor private 'ivar' access.\n-\t\n+\n 2010-10-17  Iain Sandoe  <iains@gcc.gnu.org>\n \n-\t* parser.c (cp_parser_objc_visibility_spec): Update to use visibility \n+\t* parser.c (cp_parser_objc_visibility_spec): Update to use visibility\n \tenum, and handle @package.\n \n 2010-10-15  Jason Merrill  <jason@redhat.com>\n@@ -67,12 +73,12 @@\n \n 2010-10-14  Iain Sandoe  <iains@gcc.gnu.org>\n \n-\tmerge from FSF apple 'trunk' branch. \n+\tmerge from FSF apple 'trunk' branch.\n \t2006 Fariborz Jahanian <fjahanian@apple.com>\n-\t\n+\n \tRadars 4436866, 4505126, 4506903, 4517826\n \t* typeck.c (finish_class_member_access_expr): Handle CLASS.property\n-\tsyntax. \n+\tsyntax.\n \t(cp_build_modify_expr): Likewise.\n \t* parser.c (cp_parser_objc_method_prototype_list): Handle @property.\n \t(cp_parser_objc_method_definition_list): Likewise.\n@@ -160,7 +166,7 @@\n \t(value_dependent_expression_p): Added case for AT_ENCODE_EXPR.\n \t(type_dependent_expression_p): Added case for AT_ENCODE_EXPR.\n \t* parser.c (cp_parser_objc_encode_expression): Updated comment.\n-\t\n+\n 2010-10-07  Nicola Pero  <nicola@nicola.brainstorm.co.uk>\n \n \tMerge from apple/trunk branch on FSF servers.\n@@ -181,19 +187,19 @@\n \tMerge from apple/trunk branch on FSF servers.\n \t* cp-tree.def: Added AT_ENCODE_EXPR here instead of to the no\n \tlonger existing gcc/c-common.def.\n-\t\n+\n \t2005-12-14  Fariborz Jahanian <fjahanian@apple.com>\n \n \tRadar 4278774\n \t* pt.c (tsubst_copy_and_build): Instantiate @endcode(T).\n-\t* parser.c (cp_parser_objc_encode_expression): Build a templatized \n+\t* parser.c (cp_parser_objc_encode_expression): Build a templatized\n \tparse tree for @encode(T).\n \n \t2005-12-14  Fariborz Jahanian <fjahanian@apple.com>\n \n \tRadar 4278774\n \t* c-common.def: Add new expression code AT_ENCODE_EXPR.\n-\t\n+\n 2010-10-06  Eric Botcazou  <ebotcazou@adacore.com>\n \n \tPR c++/45908\n@@ -229,9 +235,9 @@\n \t(cp_parser_objc_method_definition_list): Same change.\n \n 2010-10-05  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from apple/trunk branch on FSF servers:\n-\t\n+\n \t2005-10-17  Fariborz Jahanian <fjahanian@apple.com>\n \n \tRadar 4290840\n@@ -257,14 +263,14 @@\n \tRadar 4093475\n \t* parser.c (cp_parser_objc_interstitial_code): Catch stray\n \t'{' and '}' tokens and issue appropriate errors.\n-\t\n+\n \t2005-08-02  Ziemowit Laski  <zlaski@apple.com>\n \n \tRadar 4185810\n \t(cp_parser_statement_seq_opt): In addition to '}' and\n \tend-of-file, a statement sequence may also be terminated\n \tby a stray '@end'.\n-\t\n+\n 2010-10-05  Joseph Myers  <joseph@codesourcery.com>\n \n \t* cp-tree.h (cxx_print_error_function,\n@@ -298,7 +304,7 @@\n \tRadar 4386773\n \t* cp/parser.c (cp_parser_objc_interstitial_code): For\n \t@optional/@required set the optional/required flag.\n-\t\n+\n 2010-09-30  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \t* parser.c (cp_lexer_get_preprocessor_token): Tidied up comments\n@@ -341,11 +347,11 @@\n \t(cp_build_addr_expr_1): Likewise.\n \n 2010-09-28  Iain Sandoe  <iains@gcc.gnu.org>\n-\t\n+\n \tPartially merged from apple/trunk branch on FSF servers:\n \t2006-04-26 Fariborz Jahanian <fjahanian@apple.com>\n \tRadar 3803157 (method attributes)\n-\t\n+\n \t* parser.c (cp_parser_objc_method_keyword_params): Handle attributes.\n \t(cp_parser_objc_method_tail_params_opt): Likewise.\n \t(cp_parser_objc_method_signature): Likewise.\n@@ -392,7 +398,7 @@\n 2010-09-27  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \tMerge from apple/trunk branch on FSF servers:\n-\t\n+\n \t2005-12-15  Fariborz Jahanian <fjahanian@apple.com>\n \n \tRadar 4229905\n@@ -404,19 +410,20 @@\n \tRadar 4175534\n \t* call.c (standard_conversion): Do not issue warnings when\n \tcomparing ObjC pointer types.\n-\t\n+\n \t2005-06-22  Ziemowit Laski  <zlaski@apple.com>\n \n \tRadar 4154928\n \t* call.c (standard_conversion): Allow for a pointer conversion\n \tbetween any two ObjC pointer types.\n \t* typeck.c (composite_pointer_type): Determine common type\n \tfor two ObjC pointer types.\n-\t\n+\n 2010-09-24  Jan Hubicka  <jh@suse.cz>\n \n \t* decl.c (finish_function): Use decl_replaceable_p\n-\t* method.c (make_alias_for_thunk): Update call of cgraph_same_body_alias.\n+\t* method.c (make_alias_for_thunk): Update call of\n+\tcgraph_same_body_alias.\n \n 2010-09-24  Jason Merrill  <jason@redhat.com>\n "}, {"sha": "85a5ea51132102438a9b891d3819c8677017f3c8", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=fd9852dfcd30f19bbf873debfaacbc454f8749a4", "patch": "@@ -490,7 +490,7 @@ add_to_template_args (tree args, tree extra_args)\n   int i;\n   int j;\n \n-  if (args == NULL_TREE)\n+  if (args == NULL_TREE || extra_args == error_mark_node)\n     return extra_args;\n \n   extra_depth = TMPL_ARGS_DEPTH (extra_args);\n@@ -5970,6 +5970,9 @@ coerce_template_parms (tree parms,\n      parameters.  */\n   int variadic_p = 0;\n \n+  if (args == error_mark_node)\n+    return error_mark_node;\n+\n   nparms = TREE_VEC_LENGTH (parms);\n \n   /* Determine if there are any parameter packs.  */"}, {"sha": "a7241cc1ab53cb0a7764d677a261393b3cac53a0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 18, "deletions": 13, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fd9852dfcd30f19bbf873debfaacbc454f8749a4", "patch": "@@ -1,3 +1,8 @@\n+2010-10-19  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+        PR c++/46046\n+        * g++.dg/template/crash104.C: New.\n+\n 2010-10-19  Richard Henderson  <rth@redhat.com>\n \n \t* gcc.target/i386/fma3-fma.c: New.\n@@ -10,7 +15,7 @@\n \t* gcc.dg/ipa/ipa-pta-10.c:\u00a0Adjust.\n \n 2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from 'apple/trunk' branch on FSF servers.\n \n \t2006-03-16 Fariborz Jahanian <fjahanian@apple.com>\n@@ -28,31 +33,31 @@\n \t* obj-c++.dg/property/dynamic-1.mm: New.\n \t* obj-c++.dg/property/synthesize-1.mm: New.\n \n-2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\t\n+2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \t* objc.dg/at-class-1.m: New.\n-\t* objc.dg/at-class-1.mm: New.\t\n-\t\n+\t* objc.dg/at-class-1.mm: New.\n+\n 2010-10-18  Steve Ellcey  <sje@cup.hp.com>\n \n \t* gcc.c-torture/compile/920625-1.c: Remove dg-prune-output lines.\n \n 2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from 'apple/trunk' branch on FSF servers.\n \n \t2006-01-17  Fariborz Jahanian <fjahanian@apple.com>\n \n \tRadar 4407151\n \t* obj-c++.dg/template-7.mm: New.\n-\t\n+\n 2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n \n \t* objc.dg/proto-qual-1.m: Adjust test for GNU runtime to match\n \tbugfix.\n \n 2010-10-18  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from 'apple/trunk' branch on FSF servers.\n \n \t2005-03-01 Fariborz Jahanian <fjahanian@apple.com>\n@@ -75,7 +80,7 @@\n \t* objc.dg/try-catch-11.m: New\n \t* objc.dg/try-catch-12.m: New\n \t* objc.dg/try-catch-13.m: New\n-\t\n+\n 2010-10-18  Richard Henderson  <rth@redhat.com>\n \n \t* gcc.target/ia64/20101014.c: Fix double-paste of test case.\n@@ -115,24 +120,24 @@\n \t* gcc.c-torture/execute/pr46019.c: New test.\n \n 2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from 'apple/trunk' branch on FSF servers.\n-\t\n+\n \t2006-04-19 Fariborz Jahanian <fjahanian@apple.com>\n \n \tRadar 4516785\n \t* obj-c++.dg/method-namespace-2.mm: New.\n-\t\n+\n 2010-10-17  Nicola Pero  <nicola.pero@meta-innovation.com>\n-\t\n+\n \tMerge from 'apple/trunk' branch on FSF servers.\n \n \t2006-03-27 Fariborz Jahanian <fjahanian@apple.com>\n \n \tRadar 4133425\n \t* objc.dg/private-1.m: Test modified.\n \t* obj-c++.dg/private-1.mm: Test modified.\n-\t\n+\n 2010-10-17  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR testsuite/45987"}, {"sha": "097c46982cb73861e4cd68a92a09ce9441002dca", "filename": "gcc/testsuite/g++.dg/template/crash104.C", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash104.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fd9852dfcd30f19bbf873debfaacbc454f8749a4/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash104.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash104.C?ref=fd9852dfcd30f19bbf873debfaacbc454f8749a4", "patch": "@@ -0,0 +1,26 @@\n+// PR c++/46046\n+\n+template <class T>\n+    struct foo\n+{\n+    template <class U, class V = void>\n+        struct type\n+    {};\n+\n+    template <class V>\n+        struct type<\n+            typename T::template some_type<int>,\n+            V\n+        >\n+    {};\n+};\n+\n+template <class T>\n+    class bar\n+{};\n+\n+int main()\n+{\n+  typedef foo<bar<int> > cont;\n+  cont::type<char> obj; // { dg-error \"cannot be defined\" }\n+}"}]}