{"sha": "b29def532d9dff6bd72e19863cf34afc841f2e27", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjI5ZGVmNTMyZDlkZmY2YmQ3MmUxOTg2M2NmMzRhZmM4NDFmMmUyNw==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-17T12:26:10Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-17T12:26:10Z"}, "message": "[multiple changes]\n\n2010-06-17  Robert Dewar  <dewar@adacore.com>\n\n\t* exp_ch3.adb, exp_ch6.adb, exp_smem.adb, exp_util.adb: Use Ekind_In.\n\t* layout.adb, freeze.adb: Use Make_Temporary.\n\n2010-06-17  Jerome Lambourg  <lambourg@adacore.com>\n\n\t* exp_ch11.adb (Expand_N_Raise_Statement): Expand raise statements in\n\t.NET/JVM normally as this is now perfectly supported by the backend.\n\n2010-06-17  Pascal Obry  <obry@adacore.com>\n\n\t* gnat_rm.texi: Fix minor typo, remove duplicate blank lines.\n\n2010-06-17  Vincent Celier  <celier@adacore.com>\n\n\t* make.adb (Collect_Arguments_And_Compile): Create include path file\n\tonly when -x is specified.\n\t(Gnatmake): Ditto\n\t* opt.ads (Use_Include_Path_File): New Boolean flag, initialized to\n\tFalse.\n\t* prj-env.adb (Set_Ada_Paths): New Boolean parameters Include_Path and\n\tObjects_Path, defaulted to True. Only create include path file if\n\tInclude_Path is True, only create objects path file if Objects_Path is\n\tTrue.\n\t* prj-env.ads (Set_Ada_Paths): New Boolean parameters Include_Path and\n\tObjects_Path, defaulted to True.\n\t* switch-m.adb (Scan_Make_Switches): Set Use_Include_Path_File to True\n\twhen -x is used.\n\n2010-06-17  Ed Schonberg  <schonberg@adacore.com>\n\n\t* exp_disp.adb (Build_Interface_Thunk): Use base type of formal to\n\tdetermine whether it has the controlling type, when the formal is an\n\taccess parameter.\n\n2010-06-17  Eric Botcazou  <ebotcazou@adacore.com>\n\n\t* s-crtl.ads (ssize_t): New type.\n\t(read): Fix signature.\n\t(write): Likewise.\n\t* g-socthi.ads: Add 'with System.CRTL' clause.  Remove ssize_t and\n\t'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n\t(C_Sendmsg): Likewise.\n\t* g-socthi.adb (Syscall_Recvmsg): Likewise.\n\t(Syscall_Sendmsg): Likewise.\n\t(C_Recvmsg): Likewise.\n\t(C_Sendmsg): Likewise.\n\t* g-socthi-mingw.ads: Add 'with System.CRTL' clause.  Remove ssize_t\n\tand 'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n\t(C_Sendmsg): Likewise.\n\t* g-socthi-mingw.adb (C_Recvmsg): Likewise.\n\t(C_Sendmsg): Likewise.\n\t* g-socthi-vms.ads: Add 'with System.CRTL' clause.  Remove ssize_t and\n\t'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n\t(C_Sendmsg): Likewise.\n\t* g-socthi-vms.adb (C_Recvmsg): Likewise.\n\t(C_Sendmsg): Likewise.\n\t* g-socthi-vxworks.ads Add 'with System.CRTL' clause.  Remove ssize_t\n\tand 'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n\t(C_Sendmsg): Likewise.\n\t* g-socthi-vxworks.adb (C_Recvmsg): Likewise.\n\t(C_Sendmsg): Likewise.\n\t* g-sercom-linux.adb (Read): Use correct types to call 'read'.\n\t(Write): Likewise to call 'write'.\n\t* s-os_lib.adb (Read): Use correct type to call System.CRTL.read.\n\t(Write): Use correct type to call System.CRTL.write.\n\t* s-tasdeb.adb (Write): Likewise.\n\n2010-06-17  Vincent Celier  <celier@adacore.com>\n\n\t* prj-proc.adb (Copy_Package_Declarations): Change argument name\n\tNaming_Restricted to Restricted. If Restricted is True, do not copy the\n\tvalue of attribute Linker_Options.\n\nFrom-SVN: r160905", "tree": {"sha": "ecc5a2780220e50090dbcb7bf568dc7f8e0391de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ecc5a2780220e50090dbcb7bf568dc7f8e0391de"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b29def532d9dff6bd72e19863cf34afc841f2e27", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b29def532d9dff6bd72e19863cf34afc841f2e27", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b29def532d9dff6bd72e19863cf34afc841f2e27", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b29def532d9dff6bd72e19863cf34afc841f2e27/comments", "author": null, "committer": null, "parents": [{"sha": "bd2e63a1c4d4159f576c31bee9e4090919462aa5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd2e63a1c4d4159f576c31bee9e4090919462aa5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd2e63a1c4d4159f576c31bee9e4090919462aa5"}], "stats": {"total": 460, "additions": 266, "deletions": 194}, "files": [{"sha": "9a028fd6942bfa91b4a582927f42ed2430b4ec2b", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 79, "deletions": 0, "changes": 79, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -1,3 +1,82 @@\n+2010-06-17  Robert Dewar  <dewar@adacore.com>\n+\n+\t* exp_ch3.adb, exp_ch6.adb, exp_smem.adb, exp_util.adb: Use Ekind_In.\n+\t* layout.adb, freeze.adb: Use Make_Temporary.\n+\n+2010-06-17  Jerome Lambourg  <lambourg@adacore.com>\n+\n+\t* exp_ch11.adb (Expand_N_Raise_Statement): Expand raise statements in\n+\t.NET/JVM normally as this is now perfectly supported by the backend.\n+\n+2010-06-17  Pascal Obry  <obry@adacore.com>\n+\n+\t* gnat_rm.texi: Fix minor typo, remove duplicate blank lines.\n+\n+2010-06-17  Vincent Celier  <celier@adacore.com>\n+\n+\t* make.adb (Collect_Arguments_And_Compile): Create include path file\n+\tonly when -x is specified.\n+\t(Gnatmake): Ditto\n+\t* opt.ads (Use_Include_Path_File): New Boolean flag, initialized to\n+\tFalse.\n+\t* prj-env.adb (Set_Ada_Paths): New Boolean parameters Include_Path and\n+\tObjects_Path, defaulted to True. Only create include path file if\n+\tInclude_Path is True, only create objects path file if Objects_Path is\n+\tTrue.\n+\t* prj-env.ads (Set_Ada_Paths): New Boolean parameters Include_Path and\n+\tObjects_Path, defaulted to True.\n+\t* switch-m.adb (Scan_Make_Switches): Set Use_Include_Path_File to True\n+\twhen -x is used.\n+\n+2010-06-17  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* exp_disp.adb (Build_Interface_Thunk): Use base type of formal to\n+\tdetermine whether it has the controlling type, when the formal is an\n+\taccess parameter.\n+\n+2010-06-17  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* s-crtl.ads (ssize_t): New type.\n+\t(read): Fix signature.\n+\t(write): Likewise.\n+\t* g-socthi.ads: Add 'with System.CRTL' clause.  Remove ssize_t and\n+\t'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n+\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n+\t(C_Sendmsg): Likewise.\n+\t* g-socthi.adb (Syscall_Recvmsg): Likewise.\n+\t(Syscall_Sendmsg): Likewise.\n+\t(C_Recvmsg): Likewise.\n+\t(C_Sendmsg): Likewise.\n+\t* g-socthi-mingw.ads: Add 'with System.CRTL' clause.  Remove ssize_t\n+\tand 'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n+\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n+\t(C_Sendmsg): Likewise.\n+\t* g-socthi-mingw.adb (C_Recvmsg): Likewise.\n+\t(C_Sendmsg): Likewise.\n+\t* g-socthi-vms.ads: Add 'with System.CRTL' clause.  Remove ssize_t and\n+\t'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n+\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n+\t(C_Sendmsg): Likewise.\n+\t* g-socthi-vms.adb (C_Recvmsg): Likewise.\n+\t(C_Sendmsg): Likewise.\n+\t* g-socthi-vxworks.ads Add 'with System.CRTL' clause.  Remove ssize_t\n+\tand 'use type' directive for C.size_t, add one for System.CRTL.ssize_t.\n+\t(C_Recvmsg): Replace ssize_t with System.CRTL.ssize_t.\n+\t(C_Sendmsg): Likewise.\n+\t* g-socthi-vxworks.adb (C_Recvmsg): Likewise.\n+\t(C_Sendmsg): Likewise.\n+\t* g-sercom-linux.adb (Read): Use correct types to call 'read'.\n+\t(Write): Likewise to call 'write'.\n+\t* s-os_lib.adb (Read): Use correct type to call System.CRTL.read.\n+\t(Write): Use correct type to call System.CRTL.write.\n+\t* s-tasdeb.adb (Write): Likewise.\n+\n+2010-06-17  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-proc.adb (Copy_Package_Declarations): Change argument name\n+\tNaming_Restricted to Restricted. If Restricted is True, do not copy the\n+\tvalue of attribute Linker_Options.\n+\n 2010-06-17  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/trans.c (push_stack, pop_stack): Delete."}, {"sha": "fb458a66576100ececa2f4a73779cd134f61c93c", "filename": "gcc/ada/exp_ch11.adb", "status": "modified", "additions": 0, "deletions": 11, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_ch11.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_ch11.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch11.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -1551,17 +1551,6 @@ package body Exp_Ch11 is\n          end if;\n       end if;\n \n-      --  There is no expansion needed for statement \"raise <exception>;\" when\n-      --  compiling for the JVM since the JVM has a built-in exception\n-      --  mechanism. However we need to keep the expansion for \"raise;\"\n-      --  statements. See 4jexcept.ads for details.\n-\n-      --  What is .NET status, either code or comment is wrong here ???\n-\n-      if Present (Name (N)) and then VM_Target /= No_VM then\n-         return;\n-      end if;\n-\n       --  Case of name present, in this case we expand raise name to\n \n       --    Raise_Exception (name'Identity, location_string);"}, {"sha": "5c2ee82e2e37402f9bafc31c709e73c59ef059bf", "filename": "gcc/ada/exp_ch3.adb", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch3.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -6221,9 +6221,7 @@ package body Exp_Ch3 is\n \n       --  See GNAT Pool packages in the Run-Time for more details\n \n-      elsif Ekind (Def_Id) = E_Access_Type\n-        or else Ekind (Def_Id) = E_General_Access_Type\n-      then\n+      elsif Ekind_In (Def_Id, E_Access_Type, E_General_Access_Type) then\n          declare\n             Loc         : constant Source_Ptr := Sloc (N);\n             Desig_Type  : constant Entity_Id  := Designated_Type (Def_Id);"}, {"sha": "49a0a0f5d4c4e4f7c494c442d1af1eb2e8debbc2", "filename": "gcc/ada/exp_ch6.adb", "status": "modified", "additions": 4, "deletions": 8, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_ch6.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_ch6.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch6.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -2941,9 +2941,8 @@ package body Exp_Ch6 is\n          return;\n       end if;\n \n-      if Ekind (Subp) = E_Function\n-        or else Ekind (Subp) = E_Procedure\n-      then\n+      if Ekind_In (Subp, E_Function, E_Procedure) then\n+\n          --  We perform two simple optimization on calls:\n \n          --  a) replace calls to null procedures unconditionally;\n@@ -4338,9 +4337,7 @@ package body Exp_Ch6 is\n       --  For a procedure, we add a return for all possible syntactic ends of\n       --  the subprogram.\n \n-      if Ekind (Spec_Id) = E_Procedure\n-        or else Ekind (Spec_Id) = E_Generic_Procedure\n-      then\n+      if Ekind_In (Spec_Id, E_Procedure, E_Generic_Procedure) then\n          Add_Return (Statements (H));\n \n          if Present (Exception_Handlers (H)) then\n@@ -4707,8 +4704,7 @@ package body Exp_Ch6 is\n       --  foreign convention or whose result type has a foreign convention\n       --  never qualify.\n \n-      if Ekind (E) = E_Function\n-        or else Ekind (E) = E_Generic_Function\n+      if Ekind_In (E, E_Function, E_Generic_Function)\n         or else (Ekind (E) = E_Subprogram_Type\n                   and then Etype (E) /= Standard_Void_Type)\n       then"}, {"sha": "66ab8134622211b74339fa9a0ba7517b0b7a5a6f", "filename": "gcc/ada/exp_disp.adb", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_disp.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_disp.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_disp.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -1533,20 +1533,22 @@ package body Exp_Disp is\n       Formal        := First (Formals);\n       while Present (Formal) loop\n \n-         --  Handle concurrent types\n+         --  If the parent is a constrained discriminated type, then the\n+         --  primitive operation will have been defined on a first subtype.\n+         --  For proper matching with controlling type, use base type.\n \n          if Ekind (Target_Formal) = E_In_Parameter\n            and then Ekind (Etype (Target_Formal)) = E_Anonymous_Access_Type\n          then\n-            Ftyp := Directly_Designated_Type (Etype (Target_Formal));\n+            Ftyp :=\n+              Base_Type (Directly_Designated_Type (Etype (Target_Formal)));\n          else\n-            --  If the parent is a constrained discriminated type, then the\n-            --  primitive operation will have been defined on a first subtype.\n-            --  For proper matching with controlling type, use base type.\n-\n             Ftyp := Base_Type (Etype (Target_Formal));\n          end if;\n \n+         --  For concurrent types, the relevant info is on the corresponding_\n+         --  record type.\n+\n          if Is_Concurrent_Type (Ftyp) then\n             Ftyp := Corresponding_Record_Type (Ftyp);\n          end if;"}, {"sha": "f2cbfd083c97a30e91e8675c51a25f32b45022e6", "filename": "gcc/ada/exp_smem.adb", "status": "modified", "additions": 2, "deletions": 5, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_smem.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_smem.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_smem.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1998-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1998-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -270,10 +270,7 @@ package body Exp_Smem is\n          return False;\n \n       else\n-         if Ekind (Formal) = E_Out_Parameter\n-              or else\n-            Ekind (Formal) = E_In_Out_Parameter\n-         then\n+         if Ekind_In (Formal, E_Out_Parameter, E_In_Out_Parameter) then\n             Insert_Node := Call;\n             return True;\n          else"}, {"sha": "07771c810923f2a997c1c98acf3490b8fe3168cf", "filename": "gcc/ada/exp_util.adb", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fexp_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_util.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -2107,9 +2107,7 @@ package body Exp_Util is\n    begin\n       --  Only consider record types\n \n-      if Ekind (Typ) /= E_Record_Type\n-        and then Ekind (Typ) /= E_Record_Subtype\n-      then\n+      if not Ekind_In (Typ, E_Record_Type, E_Record_Subtype) then\n          return False;\n       end if;\n \n@@ -4406,9 +4404,7 @@ package body Exp_Util is\n             --  already rewritten a variable node with a constant as\n             --  a result of an earlier Force_Evaluation call.\n \n-            if Ekind (Entity (N)) = E_Constant\n-              or else Ekind (Entity (N)) = E_In_Parameter\n-            then\n+            if Ekind_In (Entity (N), E_Constant, E_In_Parameter) then\n                return True;\n \n             --  Functions are not side effect free"}, {"sha": "553a80ac3249ab92d6c40f180e788b262d2f4c98", "filename": "gcc/ada/freeze.adb", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Ffreeze.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Ffreeze.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ffreeze.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -1145,10 +1145,7 @@ package body Freeze is\n       if Nkind_In (Par, N_Object_Declaration, N_Assignment_Statement)\n         and then Comes_From_Source (Par)\n       then\n-         Temp :=\n-           Make_Defining_Identifier (Loc,\n-             New_Internal_Name ('T'));\n-\n+         Temp := Make_Temporary (Loc, 'T', E);\n          New_N :=\n            Make_Object_Declaration (Loc,\n              Defining_Identifier => Temp,\n@@ -5419,8 +5416,7 @@ package body Freeze is\n             --  involve secondary stack expansion.\n \n             else\n-               Dnam :=\n-                 Make_Defining_Identifier (Loc, New_Internal_Name ('D'));\n+               Dnam := Make_Temporary (Loc, 'D');\n \n                Dbody :=\n                  Make_Subprogram_Body (Loc,"}, {"sha": "3432f86b3d93c1edcac1d38fdc0143e59ec12d63", "filename": "gcc/ada/g-sercom-linux.adb", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-sercom-linux.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-sercom-linux.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-sercom-linux.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -158,8 +158,8 @@ package body GNAT.Serial_Communications is\n       Buffer : out Stream_Element_Array;\n       Last   : out Stream_Element_Offset)\n    is\n-      Len : constant int := Buffer'Length;\n-      Res : int;\n+      Len : constant size_t := Buffer'Length;\n+      Res : ssize_t;\n \n    begin\n       if Port.H = null then\n@@ -264,20 +264,21 @@ package body GNAT.Serial_Communications is\n      (Port   : in out Serial_Port;\n       Buffer : Stream_Element_Array)\n    is\n-      Len : constant int := Buffer'Length;\n-      Res : int;\n+      Len : constant size_t := Buffer'Length;\n+      Res : ssize_t;\n \n    begin\n       if Port.H = null then\n          Raise_Error (\"write: port not opened\", 0);\n       end if;\n \n       Res := write (int (Port.H.all), Buffer'Address, Len);\n-      pragma Assert (Res = Len);\n \n       if Res = -1 then\n          Raise_Error (\"write failed\");\n       end if;\n+\n+      pragma Assert (size_t (Res) = Len);\n    end Write;\n \n    -----------"}, {"sha": "ba4a3deb7750b7a678d32c829de36d73481d86d0", "filename": "gcc/ada/g-socthi-mingw.adb", "status": "modified", "additions": 26, "deletions": 22, "changes": 48, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-mingw.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-mingw.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi-mingw.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -269,7 +269,7 @@ package body GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n       Res   : C.int;\n       Count : C.int := 0;\n@@ -287,19 +287,20 @@ package body GNAT.Sockets.Thin is\n       --  not available in all versions of Windows. So, we use C_Recv instead.\n \n       for J in Iovec'Range loop\n-         Res := C_Recv\n-           (S,\n-            Iovec (J).Base.all'Address,\n-            C.int (Iovec (J).Length),\n-            Flags);\n+         Res :=\n+           C_Recv\n+            (S,\n+             Iovec (J).Base.all'Address,\n+             C.int (Iovec (J).Length),\n+             Flags);\n \n          if Res < 0 then\n-            return ssize_t (Res);\n+            return System.CRTL.ssize_t (Res);\n          else\n             Count := Count + Res;\n          end if;\n       end loop;\n-      return ssize_t (Count);\n+      return System.CRTL.ssize_t (Count);\n    end C_Recvmsg;\n \n    --------------\n@@ -369,10 +370,11 @@ package body GNAT.Sockets.Thin is\n \n                --  Check out-of-band data\n \n-               Length := C_Recvfrom\n-                 (S, Buffer'Address, 1, Flag,\n-                  From    => System.Null_Address,\n-                  Fromlen => Fromlen'Unchecked_Access);\n+               Length :=\n+                 C_Recvfrom\n+                  (S, Buffer'Address, 1, Flag,\n+                   From    => System.Null_Address,\n+                   Fromlen => Fromlen'Unchecked_Access);\n                --  Is Fromlen necessary if From is Null_Address???\n \n                --  If the signal is not an out-of-band data, then it\n@@ -404,7 +406,7 @@ package body GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n       Res   : C.int;\n       Count : C.int := 0;\n@@ -423,21 +425,23 @@ package body GNAT.Sockets.Thin is\n       --  instead.\n \n       for J in Iovec'Range loop\n-         Res := C_Sendto\n-           (S,\n-            Iovec (J).Base.all'Address,\n-            C.int (Iovec (J).Length),\n-            Flags => Flags,\n-            To    => MH.Msg_Name,\n-            Tolen => C.int (MH.Msg_Namelen));\n+         Res :=\n+           C_Sendto\n+            (S,\n+             Iovec (J).Base.all'Address,\n+             C.int (Iovec (J).Length),\n+             Flags => Flags,\n+             To    => MH.Msg_Name,\n+             Tolen => C.int (MH.Msg_Namelen));\n \n          if Res < 0 then\n-            return ssize_t (Res);\n+            return System.CRTL.ssize_t (Res);\n          else\n             Count := Count + Res;\n          end if;\n       end loop;\n-      return ssize_t (Count);\n+\n+      return System.CRTL.ssize_t (Count);\n    end C_Sendmsg;\n \n    --------------"}, {"sha": "bc1f256497ee75490f0b8fbb971201ca0d1c3ae5", "filename": "gcc/ada/g-socthi-mingw.ads", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-mingw.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-mingw.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi-mingw.ads?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -42,17 +42,15 @@ with Interfaces.C.Strings;\n with GNAT.Sockets.Thin_Common;\n \n with System;\n+with System.CRTL;\n \n package GNAT.Sockets.Thin is\n \n    use Thin_Common;\n \n    package C renames Interfaces.C;\n \n-   use type C.size_t;\n-   type ssize_t is range -(2 ** (C.size_t'Size - 1))\n-     .. +(2 ** (C.size_t'Size - 1) - 1);\n-   --  Signed type of the same size as size_t\n+   use type System.CRTL.ssize_t;\n \n    function Socket_Errno return Integer;\n    --  Returns last socket error number\n@@ -146,7 +144,7 @@ package GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Select\n      (Nfds      : C.int;\n@@ -158,7 +156,7 @@ package GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Sendto\n      (S     : C.int;"}, {"sha": "1331821446fdb9030ec59f4b9aa32abd562a983e", "filename": "gcc/ada/g-socthi-vms.adb", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vms.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vms.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi-vms.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -292,7 +292,7 @@ package body GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n       Res : C.int;\n \n@@ -314,7 +314,7 @@ package body GNAT.Sockets.Thin is\n \n       GNAT_Msg := Msghdr (VMS_Msg);\n \n-      return ssize_t (Res);\n+      return System.CRTL.ssize_t (Res);\n    end C_Recvmsg;\n \n    ---------------\n@@ -324,7 +324,7 @@ package body GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n       Res : C.int;\n \n@@ -346,7 +346,7 @@ package body GNAT.Sockets.Thin is\n \n       GNAT_Msg := Msghdr (VMS_Msg);\n \n-      return ssize_t (Res);\n+      return System.CRTL.ssize_t (Res);\n    end C_Sendmsg;\n \n    --------------"}, {"sha": "3a443ac652d5997412c8733412a7705f182bdf93", "filename": "gcc/ada/g-socthi-vms.ads", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vms.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vms.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi-vms.ads?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -43,6 +43,7 @@ with GNAT.OS_Lib;\n with GNAT.Sockets.Thin_Common;\n \n with System;\n+with System.CRTL;\n \n package GNAT.Sockets.Thin is\n \n@@ -52,10 +53,7 @@ package GNAT.Sockets.Thin is\n \n    package C renames Interfaces.C;\n \n-   use type C.size_t;\n-   type ssize_t is range -(2 ** (C.size_t'Size - 1))\n-     .. +(2 ** (C.size_t'Size - 1) - 1);\n-   --  Signed type of the same size as size_t\n+   use type System.CRTL.ssize_t;\n \n    function Socket_Errno return Integer renames GNAT.OS_Lib.Errno;\n    --  Returns last socket error number\n@@ -149,7 +147,7 @@ package GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Select\n      (Nfds      : C.int;\n@@ -161,7 +159,7 @@ package GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Sendto\n      (S     : C.int;"}, {"sha": "8c119661ed4cf9786c0a4ed5a52b002743da8305", "filename": "gcc/ada/g-socthi-vxworks.adb", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vxworks.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vxworks.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi-vxworks.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -309,7 +309,7 @@ package body GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n       Res : C.int;\n \n@@ -323,7 +323,7 @@ package body GNAT.Sockets.Thin is\n          delay Quantum;\n       end loop;\n \n-      return ssize_t (Res);\n+      return System.CRTL.ssize_t (Res);\n    end C_Recvmsg;\n \n    ---------------\n@@ -333,7 +333,7 @@ package body GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n       Res : C.int;\n \n@@ -347,7 +347,7 @@ package body GNAT.Sockets.Thin is\n          delay Quantum;\n       end loop;\n \n-      return ssize_t (Res);\n+      return System.CRTL.ssize_t (Res);\n    end C_Sendmsg;\n \n    --------------"}, {"sha": "64cc87668ce2a54320a965535e9fd8b4630ab261", "filename": "gcc/ada/g-socthi-vxworks.ads", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vxworks.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi-vxworks.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi-vxworks.ads?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -43,17 +43,15 @@ with GNAT.OS_Lib;\n with GNAT.Sockets.Thin_Common;\n \n with System;\n+with System.CRTL;\n \n package GNAT.Sockets.Thin is\n \n    use Thin_Common;\n \n    package C renames Interfaces.C;\n \n-   use type C.size_t;\n-   type ssize_t is range -(2 ** (C.size_t'Size - 1))\n-     .. +(2 ** (C.size_t'Size - 1) - 1);\n-   --  Signed type of the same size as size_t\n+   use type System.CRTL.ssize_t;\n \n    function Socket_Errno return Integer renames GNAT.OS_Lib.Errno;\n    --  Returns last socket error number\n@@ -147,7 +145,7 @@ package GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Select\n      (Nfds      : C.int;\n@@ -159,7 +157,7 @@ package GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Sendto\n      (S     : C.int;"}, {"sha": "301d8be45d4f9be2b39add868f3edfe2392f1eee", "filename": "gcc/ada/g-socthi.adb", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -95,13 +95,13 @@ package body GNAT.Sockets.Thin is\n    function Syscall_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n    pragma Import (C, Syscall_Recvmsg, \"recvmsg\");\n \n    function Syscall_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n    pragma Import (C, Syscall_Sendmsg, \"sendmsg\");\n \n    function Syscall_Sendto\n@@ -307,15 +307,15 @@ package body GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n-      Res : ssize_t;\n+      Res : System.CRTL.ssize_t;\n \n    begin\n       loop\n          Res := Syscall_Recvmsg (S, Msg, Flags);\n          exit when SOSC.Thread_Blocking_IO\n-           or else Res /= ssize_t (Failure)\n+           or else Res /= System.CRTL.ssize_t (Failure)\n            or else Non_Blocking_Socket (S)\n            or else Errno /= SOSC.EWOULDBLOCK;\n          delay Quantum;\n@@ -331,15 +331,15 @@ package body GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t\n+      Flags : C.int) return System.CRTL.ssize_t\n    is\n-      Res : ssize_t;\n+      Res : System.CRTL.ssize_t;\n \n    begin\n       loop\n          Res := Syscall_Sendmsg (S, Msg, Flags);\n          exit when SOSC.Thread_Blocking_IO\n-           or else Res /= ssize_t (Failure)\n+           or else Res /= System.CRTL.ssize_t (Failure)\n            or else Non_Blocking_Socket (S)\n            or else Errno /= SOSC.EWOULDBLOCK;\n          delay Quantum;"}, {"sha": "32013c35e7fadf5e85f6b1e1c457524d22da8777", "filename": "gcc/ada/g-socthi.ads", "status": "modified", "additions": 4, "deletions": 6, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fg-socthi.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-socthi.ads?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -43,6 +43,7 @@ with GNAT.OS_Lib;\n with GNAT.Sockets.Thin_Common;\n \n with System;\n+with System.CRTL;\n \n package GNAT.Sockets.Thin is\n \n@@ -54,10 +55,7 @@ package GNAT.Sockets.Thin is\n \n    package C renames Interfaces.C;\n \n-   use type C.size_t;\n-   type ssize_t is range -(2 ** (C.size_t'Size - 1))\n-     .. +(2 ** (C.size_t'Size - 1) - 1);\n-   --  Signed type of the same size as size_t\n+   use type System.CRTL.ssize_t;\n \n    function Socket_Errno return Integer renames GNAT.OS_Lib.Errno;\n    --  Returns last socket error number\n@@ -148,7 +146,7 @@ package GNAT.Sockets.Thin is\n    function C_Recvmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Select\n      (Nfds      : C.int;\n@@ -160,7 +158,7 @@ package GNAT.Sockets.Thin is\n    function C_Sendmsg\n      (S     : C.int;\n       Msg   : System.Address;\n-      Flags : C.int) return ssize_t;\n+      Flags : C.int) return System.CRTL.ssize_t;\n \n    function C_Sendto\n      (S     : C.int;"}, {"sha": "99811c7b2d08acfc6d875bb8040e6c83f55f6612", "filename": "gcc/ada/gnat_rm.texi", "status": "modified", "additions": 1, "deletions": 9, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fgnat_rm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fgnat_rm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_rm.texi?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -3967,8 +3967,6 @@ inlining (-gnatN option set) are accepted and legality-checked\n by the compiler, but are ignored at run-time even if postcondition\n checking is enabled.\n \n-\n-\n @node Pragma Profile (Ravenscar)\n @unnumberedsec Pragma Profile (Ravenscar)\n @findex Ravenscar\n@@ -5946,7 +5944,7 @@ end record;\n @end smallexample\n \n @noindent\n-will have a size of 40 (that is @code{Rec'Size} will be 40.  The\n+will have a size of 40 (that is @code{Rec'Size} will be 40).  The\n alignment will be 4, because of the\n integer field, and so the default size of record objects for this type\n will be 64 (8 bytes).\n@@ -6575,7 +6573,6 @@ For example:\n   for Y'Address use X'Address;>>\n @end smallexample\n \n-\n @sp 1\n @cartouche\n An implementation need not support a specification for the @code{Size}\n@@ -12225,8 +12222,6 @@ types are @code{Wide_Character} and @code{Wide_String} instead of\n @code{Character} and @code{String}.\n @end table\n \n-\n-\n @node The Implementation of Standard I/O\n @chapter The Implementation of Standard I/O\n \n@@ -15822,7 +15817,6 @@ If any of these conditions are violated, the aggregate will be built in\n a temporary (created either by the front-end or the code generator) and then\n that temporary will be copied onto the target.\n \n-\n @node The Size of Discriminated Records with Default Discriminants\n @section The Size of Discriminated Records with Default Discriminants\n \n@@ -15939,7 +15933,6 @@ machines that are not fully compliant with this standard, such as Alpha, the\n behavior (although at the cost of a significant performance penalty), so\n infinite and and NaN values are properly generated.\n \n-\n @node Project File Reference\n @chapter Project File Reference\n \n@@ -16647,7 +16640,6 @@ value is a path name that designates a file that contains configuration pragmas\n to be used in every build of an executable. If both local and global\n configuration pragmas are specified, a compilation makes use of both sets.\n \n-\n @item Executable\n This is an associative array attribute. Its domain is\n a set of main source file names. Its range is a simple string that specifies"}, {"sha": "6ccef514253e37e1dafa58d0e903526ec28c0d6d", "filename": "gcc/ada/layout.adb", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Flayout.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Flayout.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flayout.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -3119,11 +3119,7 @@ package body Layout is\n       Make_Func : Boolean   := False) return Dynamic_SO_Ref\n    is\n       Loc  : constant Source_Ptr := Sloc (Ins_Type);\n-\n-      K : constant Entity_Id :=\n-            Make_Defining_Identifier (Loc,\n-              Chars => New_Internal_Name ('K'));\n-\n+      K    : constant Entity_Id := Make_Temporary (Loc, 'K');\n       Decl : Node_Id;\n \n       Vtype_Primary_View : Entity_Id;"}, {"sha": "82d4e9f2edd86809685213f290e44355b77de6f4", "filename": "gcc/ada/make.adb", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fmake.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fmake.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmake.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -2723,7 +2723,8 @@ package body Make is\n                Prj.Env.Set_Ada_Paths\n                  (Arguments_Project,\n                   Project_Tree,\n-                  Including_Libraries => True);\n+                  Including_Libraries => True,\n+                  Include_Path        => Use_Include_Path_File);\n \n                if not Unique_Compile\n                  and then MLib.Tgt.Support_For_Libraries /= Prj.None\n@@ -6026,7 +6027,8 @@ package body Make is\n                   --  and all the object directories in ADA_OBJECTS_PATH,\n                   --  except those of library projects.\n \n-                  Prj.Env.Set_Ada_Paths (Main_Project, Project_Tree, False);\n+                  Prj.Env.Set_Ada_Paths\n+                    (Main_Project, Project_Tree, Use_Include_Path_File);\n \n                   --  If switch -C was specified, create a binder mapping file\n \n@@ -6253,7 +6255,11 @@ package body Make is\n \n                   --  Put the object directories in ADA_OBJECTS_PATH\n \n-                  Prj.Env.Set_Ada_Paths (Main_Project, Project_Tree, False);\n+                  Prj.Env.Set_Ada_Paths\n+                    (Main_Project,\n+                     Project_Tree,\n+                     Including_Libraries => False,\n+                     Include_Path        => False);\n \n                   --  Check for attributes Linker'Linker_Options in projects\n                   --  other than the main project"}, {"sha": "562e6ab5e761f73e4e33fed25ce416bd15b41989", "filename": "gcc/ada/opt.ads", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fopt.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fopt.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fopt.ads?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -1229,6 +1229,11 @@ package Opt is\n    --  set True, and upper half characters in the source indicate the start of\n    --  a wide character sequence. Set by -gnatW or -W switches.\n \n+   Use_Include_Path_File : Boolean := False;\n+   --  GNATMAKE, GPRBUILD\n+   --  When True, create a source search path file, even when a mapping file\n+   --  is used.\n+\n    Usage_Requested : Boolean := False;\n    --  GNAT, GNATBIND, GNATMAKE\n    --  Set to True if -h (-gnath for the compiler) switch encountered"}, {"sha": "39bda01987efbe034edf79567a380d9ad9ca3a9b", "filename": "gcc/ada/prj-env.adb", "status": "modified", "additions": 31, "deletions": 26, "changes": 57, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fprj-env.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fprj-env.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-env.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -1498,7 +1498,9 @@ package body Prj.Env is\n    procedure Set_Ada_Paths\n      (Project             : Project_Id;\n       In_Tree             : Project_Tree_Ref;\n-      Including_Libraries : Boolean)\n+      Including_Libraries : Boolean;\n+      Include_Path        : Boolean := True;\n+      Objects_Path        : Boolean := True)\n \n    is\n       Source_Paths : Source_Path_Table.Instance;\n@@ -1570,7 +1572,7 @@ package body Prj.Env is\n       --  If it is the first time we call this procedure for this project,\n       --  compute the source path and/or the object path.\n \n-      if Project.Include_Path_File = No_Path then\n+      if Include_Path and then Project.Include_Path_File = No_Path then\n          Source_Path_Table.Init (Source_Paths);\n          Process_Source_Dirs := True;\n          Create_New_Path_File\n@@ -1580,15 +1582,15 @@ package body Prj.Env is\n       --  For the object path, we make a distinction depending on\n       --  Including_Libraries.\n \n-      if Including_Libraries then\n+      if Objects_Path and Including_Libraries then\n          if Project.Objects_Path_File_With_Libs = No_Path then\n             Object_Path_Table.Init (Object_Paths);\n             Process_Object_Dirs := True;\n             Create_New_Path_File\n               (In_Tree, Object_FD, Project.Objects_Path_File_With_Libs);\n          end if;\n \n-      else\n+      elsif Objects_Path then\n          if Project.Objects_Path_File_Without_Libs = No_Path then\n             Object_Path_Table.Init (Object_Paths);\n             Process_Object_Dirs := True;\n@@ -1662,7 +1664,8 @@ package body Prj.Env is\n       --  Set the env vars, if they need to be changed, and set the\n       --  corresponding flags.\n \n-      if In_Tree.Private_Part.Current_Source_Path_File /=\n+      if Include_Path and then\n+         In_Tree.Private_Part.Current_Source_Path_File /=\n            Project.Include_Path_File\n       then\n          In_Tree.Private_Part.Current_Source_Path_File :=\n@@ -1672,28 +1675,30 @@ package body Prj.Env is\n             Get_Name_String (In_Tree.Private_Part.Current_Source_Path_File));\n       end if;\n \n-      if Including_Libraries then\n-         if In_Tree.Private_Part.Current_Object_Path_File /=\n-            Project.Objects_Path_File_With_Libs\n-         then\n-            In_Tree.Private_Part.Current_Object_Path_File :=\n-              Project.Objects_Path_File_With_Libs;\n-            Set_Path_File_Var\n-              (Project_Objects_Path_File,\n-               Get_Name_String\n-                 (In_Tree.Private_Part.Current_Object_Path_File));\n-         end if;\n+      if Objects_Path then\n+         if Including_Libraries then\n+            if In_Tree.Private_Part.Current_Object_Path_File /=\n+              Project.Objects_Path_File_With_Libs\n+            then\n+               In_Tree.Private_Part.Current_Object_Path_File :=\n+                 Project.Objects_Path_File_With_Libs;\n+               Set_Path_File_Var\n+                 (Project_Objects_Path_File,\n+                  Get_Name_String\n+                    (In_Tree.Private_Part.Current_Object_Path_File));\n+            end if;\n \n-      else\n-         if In_Tree.Private_Part.Current_Object_Path_File /=\n-            Project.Objects_Path_File_Without_Libs\n-         then\n-            In_Tree.Private_Part.Current_Object_Path_File :=\n-              Project.Objects_Path_File_Without_Libs;\n-            Set_Path_File_Var\n-              (Project_Objects_Path_File,\n-               Get_Name_String\n-                 (In_Tree.Private_Part.Current_Object_Path_File));\n+         else\n+            if In_Tree.Private_Part.Current_Object_Path_File /=\n+              Project.Objects_Path_File_Without_Libs\n+            then\n+               In_Tree.Private_Part.Current_Object_Path_File :=\n+                 Project.Objects_Path_File_Without_Libs;\n+               Set_Path_File_Var\n+                 (Project_Objects_Path_File,\n+                  Get_Name_String\n+                    (In_Tree.Private_Part.Current_Object_Path_File));\n+            end if;\n          end if;\n       end if;\n "}, {"sha": "9dcde3280385b408613610e9fce895d8915152a9", "filename": "gcc/ada/prj-env.ads", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fprj-env.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fprj-env.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-env.ads?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -94,7 +94,9 @@ package Prj.Env is\n    procedure Set_Ada_Paths\n      (Project             : Project_Id;\n       In_Tree             : Project_Tree_Ref;\n-      Including_Libraries : Boolean);\n+      Including_Libraries : Boolean;\n+      Include_Path        : Boolean := True;\n+      Objects_Path        : Boolean := True);\n    --  Set the environment variables for additional project path files, after\n    --  creating the path files if necessary.\n "}, {"sha": "5859a8afe823b4bba6ab9f7d02f066b34f296871", "filename": "gcc/ada/prj-proc.adb", "status": "modified", "additions": 35, "deletions": 30, "changes": 65, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fprj-proc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fprj-proc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-proc.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -87,15 +87,15 @@ package body Prj.Proc is\n    --  based languages)\n \n    procedure Copy_Package_Declarations\n-     (From              : Declarations;\n-      To                : in out Declarations;\n-      New_Loc           : Source_Ptr;\n-      Naming_Restricted : Boolean;\n-      In_Tree           : Project_Tree_Ref);\n+     (From       : Declarations;\n+      To         : in out Declarations;\n+      New_Loc    : Source_Ptr;\n+      Restricted : Boolean;\n+      In_Tree    : Project_Tree_Ref);\n    --  Copy a package declaration From to To for a renamed package. Change the\n-   --  locations of all the attributes to New_Loc. When Naming_Restricted is\n-   --  True, do not copy attributes Body, Spec, Implementation and\n-   --  Specification.\n+   --  locations of all the attributes to New_Loc. When Restricted is\n+   --  True, do not copy attributes Body, Spec, Implementation, Specification\n+   --  and Linker_Options.\n \n    function Expression\n      (Project                : Project_Id;\n@@ -314,11 +314,11 @@ package body Prj.Proc is\n    -------------------------------\n \n    procedure Copy_Package_Declarations\n-     (From              : Declarations;\n-      To                : in out Declarations;\n-      New_Loc           : Source_Ptr;\n-      Naming_Restricted : Boolean;\n-      In_Tree           : Project_Tree_Ref)\n+     (From       : Declarations;\n+      To         : in out Declarations;\n+      New_Loc    : Source_Ptr;\n+      Restricted : Boolean;\n+      In_Tree    : Project_Tree_Ref)\n    is\n       V1  : Variable_Id;\n       V2  : Variable_Id      := No_Variable;\n@@ -346,6 +346,12 @@ package body Prj.Proc is\n          Var := In_Tree.Variable_Elements.Table (V1);\n          V1  := Var.Next;\n \n+         --  Do not copy the value of attribute inker_Options if Restricted\n+\n+         if Restricted and then Var.Name = Snames.Name_Linker_Options then\n+            Var.Value.Values := Nil_String;\n+         end if;\n+\n          --  Remove the Next component\n \n          Var.Next := No_Variable;\n@@ -376,16 +382,16 @@ package body Prj.Proc is\n          Arr := In_Tree.Arrays.Table (A1);\n          A1  := Arr.Next;\n \n-         if not Naming_Restricted or else\n-           (Arr.Name /= Snames.Name_Body\n-             and then Arr.Name /= Snames.Name_Spec\n-             and then Arr.Name /= Snames.Name_Implementation\n-             and then Arr.Name /= Snames.Name_Specification)\n+         if not Restricted\n+           or else\n+             (Arr.Name /= Snames.Name_Body           and then\n+              Arr.Name /= Snames.Name_Spec           and then\n+              Arr.Name /= Snames.Name_Implementation and then\n+              Arr.Name /= Snames.Name_Specification)\n          then\n             --  Remove the Next component\n \n             Arr.Next := No_Array;\n-\n             Array_Table.Increment_Last (In_Tree.Arrays);\n \n             --  Create new Array declaration\n@@ -1445,15 +1451,15 @@ package body Prj.Proc is\n                            --  renaming declaration.\n \n                            Copy_Package_Declarations\n-                             (From              =>\n+                             (From       =>\n                                 In_Tree.Packages.Table (Renamed_Package).Decl,\n-                              To                =>\n+                              To         =>\n                                 In_Tree.Packages.Table (New_Pkg).Decl,\n-                              New_Loc           =>\n+                              New_Loc    =>\n                                 Location_Of\n                                   (Current_Item, From_Project_Node_Tree),\n-                              Naming_Restricted => False,\n-                              In_Tree           => In_Tree);\n+                              Restricted => False,\n+                              In_Tree    => In_Tree);\n                         end;\n \n                      --  Standard package declaration, not renaming\n@@ -2621,13 +2627,12 @@ package body Prj.Proc is\n                            Next   => Project.Decl.Packages);\n                         Project.Decl.Packages := Current_Pkg;\n                         Copy_Package_Declarations\n-                          (From              => Element.Decl,\n-                           To                =>\n+                          (From       => Element.Decl,\n+                           To         =>\n                              In_Tree.Packages.Table (Current_Pkg).Decl,\n-                           New_Loc           => No_Location,\n-                           Naming_Restricted =>\n-                             Element.Name = Snames.Name_Naming,\n-                           In_Tree           => In_Tree);\n+                           New_Loc    => No_Location,\n+                           Restricted => True,\n+                           In_Tree    => In_Tree);\n                      end if;\n \n                      Extended_Pkg := Element.Next;"}, {"sha": "345e9a570ea93357038a8e361f0de294a16545e4", "filename": "gcc/ada/s-crtl.ads", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fs-crtl.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fs-crtl.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-crtl.ads?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -59,6 +59,9 @@ package System.CRTL is\n \n    type size_t is mod 2 ** Standard'Address_Size;\n \n+   type ssize_t is range -(2 ** (Standard'Address_Size - 1))\n+                      .. +(2 ** (Standard'Address_Size - 1)) - 1;\n+\n    type Filename_Encoding is (UTF8, ASCII_8bits, Unspecified);\n    for Filename_Encoding use (UTF8 => 0, ASCII_8bits => 1, Unspecified => 2);\n    pragma Convention (C, Filename_Encoding);\n@@ -187,10 +190,10 @@ package System.CRTL is\n    function close (fd : int) return int;\n    pragma Import (C, close, \"close\");\n \n-   function read (fd : int; buffer : chars; nbytes : int) return int;\n+   function read (fd : int; buffer : chars; count : size_t) return ssize_t;\n    pragma Import (C, read, \"read\");\n \n-   function write (fd : int; buffer : chars; nbytes : int) return int;\n+   function write (fd : int; buffer : chars; count : size_t) return ssize_t;\n    pragma Import (C, write, \"write\");\n \n end System.CRTL;"}, {"sha": "c7ca149ab687b996a7582a04ac36b11f4f0fe9b7", "filename": "gcc/ada/s-os_lib.adb", "status": "modified", "additions": 10, "deletions": 4, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fs-os_lib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fs-os_lib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-os_lib.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -2309,8 +2309,11 @@ package body System.OS_Lib is\n       N  : Integer) return Integer\n    is\n    begin\n-      return Integer (System.CRTL.read\n-        (System.CRTL.int (FD), System.CRTL.chars (A), System.CRTL.int (N)));\n+      return\n+        Integer (System.CRTL.read\n+                   (System.CRTL.int (FD),\n+                    System.CRTL.chars (A),\n+                    System.CRTL.size_t (N)));\n    end Read;\n \n    -----------------\n@@ -2718,8 +2721,11 @@ package body System.OS_Lib is\n       N  : Integer) return Integer\n    is\n    begin\n-      return Integer (System.CRTL.write\n-        (System.CRTL.int (FD), System.CRTL.chars (A), System.CRTL.int (N)));\n+      return\n+        Integer (System.CRTL.write\n+                   (System.CRTL.int (FD),\n+                    System.CRTL.chars (A),\n+                    System.CRTL.size_t (N)));\n    end Write;\n \n end System.OS_Lib;"}, {"sha": "ccc81d9d53bebe71d0798be4705ad755629fbbf9", "filename": "gcc/ada/s-tasdeb.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fs-tasdeb.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fs-tasdeb.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-tasdeb.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -362,10 +362,11 @@ package body System.Tasking.Debug is\n    -----------\n \n    procedure Write (Fd : Integer; S : String; Count : Integer) is\n-      Discard : Integer;\n+      Discard : System.CRTL.ssize_t;\n       pragma Unreferenced (Discard);\n    begin\n-      Discard := System.CRTL.write (Fd, S (S'First)'Address, Count);\n+      Discard := System.CRTL.write (Fd, S (S'First)'Address,\n+                                    System.CRTL.size_t (Count));\n       --  Is it really right to ignore write errors here ???\n    end Write;\n "}, {"sha": "49c624ad68ee48fa4d4a7af8512e8378780e05af", "filename": "gcc/ada/switch-m.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fswitch-m.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b29def532d9dff6bd72e19863cf34afc841f2e27/gcc%2Fada%2Fswitch-m.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-m.adb?ref=b29def532d9dff6bd72e19863cf34afc841f2e27", "patch": "@@ -839,6 +839,7 @@ package body Switch.M is\n \n                when 'x' =>\n                   External_Unit_Compilation_Allowed := True;\n+                  Use_Include_Path_File := True;\n \n                   --  Processing for z switch\n "}]}