{"sha": "9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWY0N2EyNGU3OWZiZDBiNzNmNjU0NDRjOGMzOWQ3ODNlMzZmM2EyOA==", "commit": {"author": {"name": "Martin Thuresson", "email": "martinthuresson@gcc.gnu.org", "date": "2011-05-13T15:57:20Z"}, "committer": {"name": "Martin Thuresson", "email": "martinthuresson@gcc.gnu.org", "date": "2011-05-13T15:57:20Z"}, "message": "re PR gcov-profile/47793 (Relative path in fprofile-use turns into absolute path)\n\n2011-05-13  Martin Thuresson  <martint@google.com>\n\n\tPR gcov-profile/47793\n\t* libgcov.c (gcov_exit): Support relative profile paths.\n\t* doc/invoke.texi (-fprofile-dir): Update for above change.\n\n2011-05-13  Martin Thuresson  <martint@google.com>\n\n\tPR gcov-profile/47793\n\t* gcc.dg/pr47793.c: New.\n\nFrom-SVN: r173735", "tree": {"sha": "e6b3ff6bf898673cb3abd4a4ddabd51b7ba3484f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e6b3ff6bf898673cb3abd4a4ddabd51b7ba3484f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/comments", "author": null, "committer": null, "parents": [{"sha": "b8a71aedd80dc9c0212da116defa88b178d11e0b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b8a71aedd80dc9c0212da116defa88b178d11e0b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b8a71aedd80dc9c0212da116defa88b178d11e0b"}], "stats": {"total": 31, "additions": 28, "deletions": 3}, "files": [{"sha": "b8ee6d38d8b0ef486b34b5610bf47f9891087e3f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "patch": "@@ -1,3 +1,9 @@\n+2011-05-13  Martin Thuresson  <martint@google.com>\n+\n+\tPR gcov-profile/47793\n+\t* libgcov.c (gcov_exit): Support relative profile paths.\n+\t* doc/invoke.texi (-fprofile-dir): Update for above change.\n+\n 2011-05-13  Richard Guenther  <rguenther@suse.de>\n \n \t* gimple.c (gimple_canonical_types_compatible_p): Do not use\n@@ -102,6 +108,7 @@\n \t* configure.ac: Use AS_HELP_STRING throughout.\n \t* configure: Regenerate.\n \n+>>>>>>> .r173734\n 2011-05-12  H.J. Lu  <hongjiu.lu@intel.com>\n \n \t* config/i386/i386.c (ix86_save_reg): Change maybe_eh_return to bool."}, {"sha": "aee1e6b1fc36a9c38e22e855ca24ed68d9ba3c1e", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "patch": "@@ -7751,7 +7751,7 @@ Set the directory to search for the profile data files in to @var{path}.\n This option affects only the profile data generated by\n @option{-fprofile-generate}, @option{-ftest-coverage}, @option{-fprofile-arcs}\n and used by @option{-fprofile-use} and @option{-fbranch-probabilities}\n-and its related options.\n+and its related options.  Both absolute and relative paths can be used.\n By default, GCC will use the current directory as @var{path}, thus the\n profile data file will appear in the same directory as the object file.\n "}, {"sha": "b39ef49343f5c44283e19cfdb3dafd6936890781", "filename": "gcc/libgcov.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Flibgcov.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Flibgcov.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flibgcov.c?ref=9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "patch": "@@ -283,8 +283,9 @@ gcov_exit (void)\n \t      }\n         }\n       /* Update complete filename with stripped original. */\n-      if (!IS_DIR_SEPARATOR (*fname) && !HAS_DRIVE_SPEC(fname))\n-\t{\n+      if (prefix_length != 0 && !IS_DIR_SEPARATOR (*fname))\n+        {\n+          /* If prefix is given, add directory separator.  */\n \t  strcpy (gi_filename_up, \"/\");\n \t  strcpy (gi_filename_up + 1, fname);\n \t}"}, {"sha": "9340d919f58847e0c449b20e0f6751dce22c970a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "patch": "@@ -1,3 +1,8 @@\n+2011-05-13  Martin Thuresson  <martint@google.com>\n+\n+\tPR gcov-profile/47793\n+\t* gcc.dg/pr47793.c: New.\n+\n 2011-05-12  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/48975"}, {"sha": "da6b6eab64626466fd6c047667a8cd6329c0df29", "filename": "gcc/testsuite/gcc.dg/pr47793.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Ftestsuite%2Fgcc.dg%2Fpr47793.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f47a24e79fbd0b73f65444c8c39d783e36f3a28/gcc%2Ftestsuite%2Fgcc.dg%2Fpr47793.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr47793.c?ref=9f47a24e79fbd0b73f65444c8c39d783e36f3a28", "patch": "@@ -0,0 +1,12 @@\n+/* Bug pr47793: Allow relative paths in profile-generate.  */\n+/* { dg-do run } */\n+/* { dg-options \"-O -fprofile-generate=./\" } */\n+/* { dg-final { scan-file pr47793.gcda \".\"} } */\n+\n+int\n+main(void)\n+{\n+  return 0;\n+}\n+\n+/* { dg-final { cleanup-coverage-files } } */"}]}