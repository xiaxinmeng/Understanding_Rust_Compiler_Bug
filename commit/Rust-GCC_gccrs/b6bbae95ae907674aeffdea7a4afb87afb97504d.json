{"sha": "b6bbae95ae907674aeffdea7a4afb87afb97504d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjZiYmFlOTVhZTkwNzY3NGFlZmZkZWE3YTRhZmI4N2FmYjk3NTA0ZA==", "commit": {"author": {"name": "Geoffrey Keating", "email": "geoffk@apple.com", "date": "2007-10-09T23:22:02Z"}, "committer": {"name": "Geoffrey Keating", "email": "geoffk@gcc.gnu.org", "date": "2007-10-09T23:22:02Z"}, "message": "inclhack.def (darwin_externc): New.\n\n\t* inclhack.def (darwin_externc): New.\n\t* fixincl.x: Regenerate.\n\t* tests/base/mach-o/swap.h: New.\n\nFrom-SVN: r129188", "tree": {"sha": "e3e08b9ed5c05eba9e1eba811c389ff072a90d53", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e3e08b9ed5c05eba9e1eba811c389ff072a90d53"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b6bbae95ae907674aeffdea7a4afb87afb97504d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6bbae95ae907674aeffdea7a4afb87afb97504d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6bbae95ae907674aeffdea7a4afb87afb97504d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6bbae95ae907674aeffdea7a4afb87afb97504d/comments", "author": {"login": "geoffk01", "id": 31905243, "node_id": "MDQ6VXNlcjMxOTA1MjQz", "avatar_url": "https://avatars.githubusercontent.com/u/31905243?v=4", "gravatar_id": "", "url": "https://api.github.com/users/geoffk01", "html_url": "https://github.com/geoffk01", "followers_url": "https://api.github.com/users/geoffk01/followers", "following_url": "https://api.github.com/users/geoffk01/following{/other_user}", "gists_url": "https://api.github.com/users/geoffk01/gists{/gist_id}", "starred_url": "https://api.github.com/users/geoffk01/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/geoffk01/subscriptions", "organizations_url": "https://api.github.com/users/geoffk01/orgs", "repos_url": "https://api.github.com/users/geoffk01/repos", "events_url": "https://api.github.com/users/geoffk01/events{/privacy}", "received_events_url": "https://api.github.com/users/geoffk01/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c3b07ec29f81ef3c0a392c5989ae825b2f7c8195", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c3b07ec29f81ef3c0a392c5989ae825b2f7c8195", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c3b07ec29f81ef3c0a392c5989ae825b2f7c8195"}], "stats": {"total": 119, "additions": 114, "deletions": 5}, "files": [{"sha": "79b8fccbc74908ec8a570ade52a5870b2c6c2b34", "filename": "fixincludes/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2FChangeLog?ref=b6bbae95ae907674aeffdea7a4afb87afb97504d", "patch": "@@ -1,3 +1,9 @@\n+2007-10-09  Geoffrey Keating  <geoffk@apple.com>\n+\n+\t* inclhack.def (darwin_externc): New.\n+\t* fixincl.x: Regenerate.\n+\t* tests/base/mach-o/swap.h: New.\n+\n 2007-08-03  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* inclhack.def (solaris_math_5, solaris_math_6, solaris_math_7):"}, {"sha": "599bb21d8a33324acd1621e48aa401e0e75fb268", "filename": "fixincludes/fixincl.x", "status": "modified", "additions": 56, "deletions": 5, "changes": 61, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2Ffixincl.x", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2Ffixincl.x", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Ffixincl.x?ref=b6bbae95ae907674aeffdea7a4afb87afb97504d", "patch": "@@ -2,11 +2,11 @@\n  * \n  * DO NOT EDIT THIS FILE   (fixincl.x)\n  * \n- * It has been AutoGen-ed  Friday August  3, 2007 at 09:50:46 PM EDT\n+ * It has been AutoGen-ed  Monday October  8, 2007 at 12:36:37 PM PDT\n  * From the definitions    inclhack.def\n  * and the template file   fixincl\n  */\n-/* DO NOT SVN-MERGE THIS FILE, EITHER Fri Aug  3 21:50:46 EDT 2007\n+/* DO NOT SVN-MERGE THIS FILE, EITHER Mon Oct  8 12:36:37 PDT 2007\n  *\n  * You must regenerate it.  Use the ./genfixes script.\n  *\n@@ -15,7 +15,7 @@\n  * certain ANSI-incompatible system header files which are fixed to work\n  * correctly with ANSI C and placed in a directory that GNU C will search.\n  *\n- * This file contains 208 fixup descriptions.\n+ * This file contains 209 fixup descriptions.\n  *\n  * See README for more information.\n  *\n@@ -1877,6 +1877,51 @@ extern \\\"C\\\" {\\n\\\n #endif\\n\",\n     (char*)NULL };\n \n+/* * * * * * * * * * * * * * * * * * * * * * * * * *\n+ *\n+ *  Description of Darwin_Externc fix\n+ */\n+tSCC zDarwin_ExterncName[] =\n+     \"darwin_externc\";\n+\n+/*\n+ *  File name selection pattern\n+ */\n+tSCC zDarwin_ExterncList[] =\n+  \"mach-o/swap.h\\0mach/mach_time.h\\0mach/mach_traps.h\\0mach/message.h\\0mach/mig.h\\0mach/semaphore.h\\0\";\n+/*\n+ *  Machine/OS name selection pattern\n+ */\n+tSCC* apzDarwin_ExterncMachs[] = {\n+        \"*-*-darwin*\",\n+        (const char*)NULL };\n+\n+/*\n+ *  content bypass pattern - skip fix if pattern found\n+ */\n+tSCC zDarwin_ExterncBypass0[] =\n+       \"extern \\\"C\\\"\";\n+tSCC zDarwin_ExterncBypass1[] =\n+       \"__BEGIN_DECLS\";\n+\n+#define    DARWIN_EXTERNC_TEST_CT  2\n+static tTestDesc aDarwin_ExterncTests[] = {\n+  { TT_NEGREP,   zDarwin_ExterncBypass0, (regex_t*)NULL },\n+  { TT_NEGREP,   zDarwin_ExterncBypass1, (regex_t*)NULL }, };\n+\n+/*\n+ *  Fix Command Arguments for Darwin_Externc\n+ */\n+static const char* apzDarwin_ExterncPatch[] = {\n+    \"wrap\",\n+    \"#ifdef __cplusplus\\n\\\n+extern \\\"C\\\" {\\n\\\n+#endif\\n\",\n+    \"#ifdef __cplusplus\\n\\\n+}\\n\\\n+#endif\\n\",\n+    (char*)NULL };\n+\n /* * * * * * * * * * * * * * * * * * * * * * * * * *\n  *\n  *  Description of Darwin_Gcc4_Breakage fix\n@@ -8456,9 +8501,9 @@ static const char* apzX11_SprintfPatch[] = {\n  *\n  *  List of all fixes\n  */\n-#define REGEX_COUNT          250\n+#define REGEX_COUNT          252\n #define MACH_LIST_SIZE_LIMIT 261\n-#define FIX_COUNT            208\n+#define FIX_COUNT            209\n \n /*\n  *  Enumerate the fixes\n@@ -8506,6 +8551,7 @@ typedef enum {\n     CTRL_QUOTES_DEF_FIXIDX,\n     CTRL_QUOTES_USE_FIXIDX,\n     CXX_UNREADY_FIXIDX,\n+    DARWIN_EXTERNC_FIXIDX,\n     DARWIN_GCC4_BREAKAGE_FIXIDX,\n     DARWIN_PRIVATE_EXTERN_FIXIDX,\n     DEC_INTERN_ASM_FIXIDX,\n@@ -8885,6 +8931,11 @@ tFixDesc fixDescList[ FIX_COUNT ] = {\n      CXX_UNREADY_TEST_CT, FD_MACH_ONLY | FD_SUBROUTINE,\n      aCxx_UnreadyTests,   apzCxx_UnreadyPatch, 0 },\n \n+  {  zDarwin_ExterncName,    zDarwin_ExterncList,\n+     apzDarwin_ExterncMachs,\n+     DARWIN_EXTERNC_TEST_CT, FD_MACH_ONLY | FD_SUBROUTINE,\n+     aDarwin_ExterncTests,   apzDarwin_ExterncPatch, 0 },\n+\n   {  zDarwin_Gcc4_BreakageName,    zDarwin_Gcc4_BreakageList,\n      apzDarwin_Gcc4_BreakageMachs,\n      DARWIN_GCC4_BREAKAGE_TEST_CT, FD_MACH_ONLY | FD_SUBROUTINE,"}, {"sha": "08989c9e750c02e6f37e506c8ac4ae0a31508e5c", "filename": "fixincludes/inclhack.def", "status": "modified", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2Finclhack.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2Finclhack.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Finclhack.def?ref=b6bbae95ae907674aeffdea7a4afb87afb97504d", "patch": "@@ -1166,6 +1166,32 @@ fix = {\n };\n \n \n+/*\n+ *  On darwin8 and earlier, mach-o/swap.h isn't properly guarded\n+ *  by 'extern \"C\"'.  On darwin7 some mach/ headers aren't properly guarded.\n+ */\n+fix = {\n+  hackname  = darwin_externc;\n+  mach      = \"*-*-darwin*\";\n+  files     = mach-o/swap.h;\n+  files     = mach/mach_time.h;\n+  files     = mach/mach_traps.h;\n+  files     = mach/message.h;\n+  files     = mach/mig.h;\n+  files     = mach/semaphore.h;\n+  bypass    = \"extern \\\"C\\\"\";\n+  bypass    = \"__BEGIN_DECLS\";\n+  c_fix     = wrap;\n+  c_fix_arg = \"#ifdef __cplusplus\\n\"\n+              \"extern \\\"C\\\" {\\n\"\n+              \"#endif\\n\";\n+  c_fix_arg = \"#ifdef __cplusplus\\n\"\n+              \"}\\n\"\n+              \"#endif\\n\";\n+  test_text = \"extern void swap_fat_header();\\n\";\n+};\n+\n+\n /*\n  * AvailabilityMacros.h on Darwin breaks with GCC 4.0, because of\n  * bad __GNUC__ tests."}, {"sha": "1bc65d4c86a7bb1b58a5837409277b42ed121927", "filename": "fixincludes/tests/base/mach-o/swap.h", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2Ftests%2Fbase%2Fmach-o%2Fswap.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6bbae95ae907674aeffdea7a4afb87afb97504d/fixincludes%2Ftests%2Fbase%2Fmach-o%2Fswap.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Ftests%2Fbase%2Fmach-o%2Fswap.h?ref=b6bbae95ae907674aeffdea7a4afb87afb97504d", "patch": "@@ -0,0 +1,26 @@\n+/*  DO NOT EDIT THIS FILE.\n+\n+    It has been auto-edited by fixincludes from:\n+\n+\t\"fixinc/tests/inc/mach-o/swap.h\"\n+\n+    This had to be done to correct non-standard usages in the\n+    original, manufacturer supplied header file.  */\n+\n+#ifndef FIXINC_WRAP_MACH_O_SWAP_H_DARWIN_EXTERNC\n+#define FIXINC_WRAP_MACH_O_SWAP_H_DARWIN_EXTERNC 1\n+\n+#ifdef __cplusplus\n+extern \"C\" {\n+#endif\n+\n+\n+#if defined( DARWIN_EXTERNC_CHECK )\n+extern void swap_fat_header();\n+\n+#endif  /* DARWIN_EXTERNC_CHECK */\n+#ifdef __cplusplus\n+}\n+#endif\n+\n+#endif  /* FIXINC_WRAP_MACH_O_SWAP_H_DARWIN_EXTERNC */"}]}