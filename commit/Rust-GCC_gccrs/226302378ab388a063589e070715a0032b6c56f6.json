{"sha": "226302378ab388a063589e070715a0032b6c56f6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjI2MzAyMzc4YWIzODhhMDYzNTg5ZTA3MDcxNWEwMDMyYjZjNTZmNg==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2007-09-26T10:44:26Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-09-26T10:44:26Z"}, "message": "gnatbind.adb: If there are several ALI files specified and there is a main program to bind...\n\n2007-09-26  Vincent Celier  <celier@adacore.com>\n\n\t* gnatbind.adb: If there are several ALI files specified and there is\n\ta main program to bind, the first ALI is expected to contain the main\n\tsubprogram and the names of the binder generated files will be derived\n\tfrom the first ALI file name.\n\t(Gnatbind): Fix insertion character in invocation of Error_Msg\n\nFrom-SVN: r128793", "tree": {"sha": "9de288085d47932d60eac2b2ca05b2b741d4d76d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9de288085d47932d60eac2b2ca05b2b741d4d76d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/226302378ab388a063589e070715a0032b6c56f6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/226302378ab388a063589e070715a0032b6c56f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/226302378ab388a063589e070715a0032b6c56f6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/226302378ab388a063589e070715a0032b6c56f6/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "37d54b99bf0547aaf22ba1929c81354c7ea89514", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37d54b99bf0547aaf22ba1929c81354c7ea89514", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37d54b99bf0547aaf22ba1929c81354c7ea89514"}], "stats": {"total": 19, "additions": 18, "deletions": 1}, "files": [{"sha": "8a166991c5c00dbc1c74dcd44993998139885348", "filename": "gcc/ada/gnatbind.adb", "status": "modified", "additions": 18, "deletions": 1, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/226302378ab388a063589e070715a0032b6c56f6/gcc%2Fada%2Fgnatbind.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/226302378ab388a063589e070715a0032b6c56f6/gcc%2Fada%2Fgnatbind.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatbind.adb?ref=226302378ab388a063589e070715a0032b6c56f6", "patch": "@@ -64,6 +64,10 @@ procedure Gnatbind is\n    Main_Lib_File : File_Name_Type;\n    --  Current main library file\n \n+   First_Main_Lib_File : File_Name_Type := No_File;\n+   --  The first library file, that should be a main subprogram if neither -n\n+   --  nor -z are used.\n+\n    Std_Lib_File : File_Name_Type;\n    --  Standard library\n \n@@ -593,6 +597,10 @@ begin\n       while More_Lib_Files loop\n          Main_Lib_File := Next_Main_Lib_File;\n \n+         if First_Main_Lib_File = No_File then\n+            First_Main_Lib_File := Main_Lib_File;\n+         end if;\n+\n          if Verbose_Mode then\n             if Check_Only then\n                Write_Str (\"Checking: \");\n@@ -683,14 +691,23 @@ begin\n \n       Set_Source_Table;\n \n+      --  If there is main program to bind, set Main_Lib_File to the first\n+      --  library file, and the name from which to derive the binder generate\n+      --  file to the first ALI file.\n+\n+      if Bind_Main_Program then\n+         Main_Lib_File := First_Main_Lib_File;\n+         Set_Current_File_Name_Index (To => 1);\n+      end if;\n+\n       --  Check that main library file is a suitable main program\n \n       if Bind_Main_Program\n         and then ALIs.Table (ALIs.First).Main_Program = None\n         and then not No_Main_Subprogram\n       then\n          Error_Msg_File_1 := Main_Lib_File;\n-         Error_Msg (\"% does not contain a unit that can be a main program\");\n+         Error_Msg (\"{ does not contain a unit that can be a main program\");\n       end if;\n \n       --  Perform consistency and correctness checks"}]}