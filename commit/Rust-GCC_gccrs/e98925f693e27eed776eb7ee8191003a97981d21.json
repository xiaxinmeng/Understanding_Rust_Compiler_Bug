{"sha": "e98925f693e27eed776eb7ee8191003a97981d21", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTk4OTI1ZjY5M2UyN2VlZDc3NmViN2VlODE5MTAwM2E5Nzk4MWQyMQ==", "commit": {"author": {"name": "Jiangning Liu", "email": "jiangning.liu@arm.com", "date": "2011-11-04T16:50:04Z"}, "committer": {"name": "Joey Ye", "email": "jye2@gcc.gnu.org", "date": "2011-11-04T16:50:04Z"}, "message": "re PR rtl-optimization/38644 (Optimization flag -O1 -fschedule-insns2 causes wrong code)\n\n2011-11-04  Jiangning Liu  <jiangning.liu@arm.com>\n\n\tPR rtl-optimization/38644\n\t* config/arm/arm.c (thumb1_expand_epilogue): Add memory barrier\n\tfor epilogue having stack adjustment.\n\n\ttestcase:\n\t* gcc.target/arm/stack-red-zone.c: New.\n\nFrom-SVN: r180964", "tree": {"sha": "ceaffa105c789fb7507175295cf5c3c25f297eaf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ceaffa105c789fb7507175295cf5c3c25f297eaf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e98925f693e27eed776eb7ee8191003a97981d21", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e98925f693e27eed776eb7ee8191003a97981d21", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e98925f693e27eed776eb7ee8191003a97981d21", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e98925f693e27eed776eb7ee8191003a97981d21/comments", "author": null, "committer": null, "parents": [{"sha": "92b4d64cd44cbf3ecdc9be35099ed8692e3fc7ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/92b4d64cd44cbf3ecdc9be35099ed8692e3fc7ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/92b4d64cd44cbf3ecdc9be35099ed8692e3fc7ab"}], "stats": {"total": 25, "additions": 25, "deletions": 0}, "files": [{"sha": "2c2c15448584f0bd2a32c45121f6b07316952ac5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e98925f693e27eed776eb7ee8191003a97981d21", "patch": "@@ -1,3 +1,9 @@\n+2011-11-04  Jiangning Liu  <jiangning.liu@arm.com>\n+\n+\tPR rtl-optimization/38644\n+\t* config/arm/arm.c (thumb1_expand_epilogue): Add memory barrier\n+\tfor epilogue having stack adjustment.\n+\n 2011-11-04  Georg-Johann Lay  <avr@gjlay.de>\n \n \tPR target/50931"}, {"sha": "6ef6f62d28d0bea798cf314f9b141b7dd8d25308", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=e98925f693e27eed776eb7ee8191003a97981d21", "patch": "@@ -22216,6 +22216,8 @@ thumb1_expand_epilogue (void)\n   gcc_assert (amount >= 0);\n   if (amount)\n     {\n+      emit_insn (gen_blockage ());\n+\n       if (amount < 512)\n \temit_insn (gen_addsi3 (stack_pointer_rtx, stack_pointer_rtx,\n \t\t\t       GEN_INT (amount)));"}, {"sha": "f47a503822c8de8c5c1768d92d08b2261d79160d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e98925f693e27eed776eb7ee8191003a97981d21", "patch": "@@ -1,3 +1,8 @@\n+2011-11-04  Jiangning Liu  <jiangning.liu@arm.com>\n+\n+\tPR rtl-optimization/38644\n+\t* gcc.target/arm/stack-red-zone.c: New.\n+\n 2011-11-04  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/48420"}, {"sha": "b9f0f99371ef13ae8fd42cadfdcb457502522206", "filename": "gcc/testsuite/gcc.target/arm/stack-red-zone.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fstack-red-zone.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e98925f693e27eed776eb7ee8191003a97981d21/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fstack-red-zone.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fstack-red-zone.c?ref=e98925f693e27eed776eb7ee8191003a97981d21", "patch": "@@ -0,0 +1,12 @@\n+/* No stack red zone.  PR38644.  */\n+/* { dg-options \"-mthumb -O2\" } */\n+/* { dg-final { scan-assembler \"ldrb\\[^\\n\\]*\\\\n\\[\\t \\]*add\\[\\t \\]*sp\" } } */\n+\n+extern int doStreamReadBlock (int *, char *, int size, int);\n+\n+char readStream (int *s)\n+{\n+       char c = 0;\n+       doStreamReadBlock (s, &c, 1, *s);\n+       return c;\n+}"}]}