{"sha": "5662d5333acd122c452c6f1a69e180d5c1ed1efe", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTY2MmQ1MzMzYWNkMTIyYzQ1MmM2ZjFhNjllMTgwZDVjMWVkMWVmZQ==", "commit": {"author": {"name": "Bryce McKinlay", "email": "bryce@albatross.co.nz", "date": "2000-11-29T04:53:37Z"}, "committer": {"name": "Bryce McKinlay", "email": "bryce@gcc.gnu.org", "date": "2000-11-29T04:53:37Z"}, "message": "natSystem.cc (init_properties): Set user.language and user.region.\n\n2000-11-29  Bryce McKinlay  <bryce@albatross.co.nz>\n\n\t* java/lang/natSystem.cc (init_properties): Set user.language and\n\tuser.region.\n\t* configure.in: Check for setlocale.\n\t* configure: Rebuilt.\n\t* include/config.h.in: Rebuilt.\n\nFrom-SVN: r37842", "tree": {"sha": "3c6a848f28f77b64bcb40a956df2db902c406ab7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3c6a848f28f77b64bcb40a956df2db902c406ab7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5662d5333acd122c452c6f1a69e180d5c1ed1efe", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5662d5333acd122c452c6f1a69e180d5c1ed1efe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5662d5333acd122c452c6f1a69e180d5c1ed1efe", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5662d5333acd122c452c6f1a69e180d5c1ed1efe/comments", "author": null, "committer": null, "parents": [{"sha": "56f8f4fb753b4583b7041f65616b417231cb7c7b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56f8f4fb753b4583b7041f65616b417231cb7c7b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56f8f4fb753b4583b7041f65616b417231cb7c7b"}], "stats": {"total": 47, "additions": 43, "deletions": 4}, "files": [{"sha": "5e6212f174d115e3544b8a0ae099da31bedd2e0d", "filename": "libjava/ChangeLog", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=5662d5333acd122c452c6f1a69e180d5c1ed1efe", "patch": "@@ -1,11 +1,19 @@\n+2000-11-29  Bryce McKinlay  <bryce@albatross.co.nz>\n+\n+\t* java/lang/natSystem.cc (init_properties): Set user.language and\n+\tuser.region.\n+\t* configure.in: Check for setlocale.\n+\t* configure: Rebuilt.\n+\t* include/config.h.in: Rebuilt.\n+\n 2000-11-28  Warren Levy  <warrenl@cygnus.com>\n \n \t* java/text/DateFormatSymbols.java (zoneStringsDefault): Added\n \tmore time zone entries.\n \t* java/text/SimpleDateFormat.java (format): Added case for\n \tTIMEZONE_FIELD.\n \n-2000-11-28  Bryce McKinlay  <bryce@abatross.co.nz>\n+2000-11-28  Bryce McKinlay  <bryce@albatross.co.nz>\n \n \t* java/io/DataInputStream.java: Merge classpath docs. Call in.read()\n \tdirectly rather than read() in all cases. Make primitive read "}, {"sha": "fdf7282ea2ee0641508694efad16f64f166480b4", "filename": "libjava/configure", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure?ref=5662d5333acd122c452c6f1a69e180d5c1ed1efe", "patch": "@@ -3398,7 +3398,7 @@ else\n fi\n done\n \n-   for ac_func in iconv nl_langinfo\n+   for ac_func in iconv nl_langinfo setlocale\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n echo \"configure:3405: checking for $ac_func\" >&5"}, {"sha": "edf35b48585c0d3eed0a4cd43bb2ef7756a6146d", "filename": "libjava/configure.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure.in?ref=5662d5333acd122c452c6f1a69e180d5c1ed1efe", "patch": "@@ -405,7 +405,7 @@ else\n    AC_CHECK_FUNCS(strerror ioctl select fstat open fsync sleep)\n    AC_CHECK_FUNCS(gmtime_r localtime_r readdir_r getpwuid_r getcwd)\n    AC_CHECK_FUNCS(access stat mkdir rename rmdir unlink realpath)\n-   AC_CHECK_FUNCS(iconv nl_langinfo)\n+   AC_CHECK_FUNCS(iconv nl_langinfo setlocale)\n    AC_CHECK_FUNCS(inet_aton inet_addr, break)\n    AC_CHECK_FUNCS(inet_pton uname inet_ntoa)\n    AC_CHECK_FUNCS(backtrace fork execvp pipe)"}, {"sha": "93edd56111d65ddbaf542880aec24174c48e581c", "filename": "libjava/include/config.h.in", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Finclude%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Finclude%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2Fconfig.h.in?ref=5662d5333acd122c452c6f1a69e180d5c1ed1efe", "patch": "@@ -25,6 +25,9 @@\n /* Define if you have the ANSI C header files.  */\n #undef STDC_HEADERS\n \n+/* Define if the X Window System is missing or not being used.  */\n+#undef X_DISPLAY_MISSING\n+\n /* Define this if you want runtime debugging enabled.  */\n #undef DEBUG\n \n@@ -263,6 +266,9 @@\n /* Define if you have the select function.  */\n #undef HAVE_SELECT\n \n+/* Define if you have the setlocale function.  */\n+#undef HAVE_SETLOCALE\n+\n /* Define if you have the sleep function.  */\n #undef HAVE_SLEEP\n "}, {"sha": "a987e8d5ef04c60ff5129c7aff6f9828129e72c7", "filename": "libjava/java/lang/natSystem.cc", "status": "modified", "additions": 26, "deletions": 1, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Fjava%2Flang%2FnatSystem.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5662d5333acd122c452c6f1a69e180d5c1ed1efe/libjava%2Fjava%2Flang%2FnatSystem.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatSystem.cc?ref=5662d5333acd122c452c6f1a69e180d5c1ed1efe", "patch": "@@ -339,6 +339,31 @@ java::lang::System::init_properties (void)\n #endif /* HAVE_UNISTD_H */\n #endif /* HAVE_GETCWD */\n \n+  // Set user locale properties based on setlocale()\n+#ifdef HAVE_SETLOCALE\n+  char *locale = setlocale (LC_ALL, \"\");\n+  if (locale && strlen (locale) >= 2)\n+    {\n+      char buf[3];\n+      buf[2] = '\\0';\n+      // copy the first two chars to user.language\n+      strncpy (buf, locale, 2);\n+      SET (\"user.language\", buf);\n+      // if the next char is a '_', copy the two after that to user.region\n+      locale += 2;\n+      if (locale[0] == '_')\n+        {\n+\t  locale++;\n+\t  strncpy (buf, locale, 2);\n+\t  SET (\"user.region\", buf);\n+        }\n+    }\n+  else\n+#endif /* HAVE_SETLOCALE */\n+    {\n+      SET (\"user.language\", \"en\");\n+    }  \n+\n   // Set some properties according to whatever was compiled in with\n   // `-D'.\n   for (int i = 0; _Jv_Compiler_Properties[i]; ++i)\n@@ -382,7 +407,7 @@ java::lang::System::init_properties (void)\n \t  sb->append ((jchar) ';');\n #else\n \t  sb->append ((jchar) ':');\n-#endif;\n+#endif\n \t}\n       if (cp != NULL)\n \tsb->append (cp);"}]}