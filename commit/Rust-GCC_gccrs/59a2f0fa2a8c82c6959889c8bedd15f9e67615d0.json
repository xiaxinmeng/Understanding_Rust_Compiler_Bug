{"sha": "59a2f0fa2a8c82c6959889c8bedd15f9e67615d0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTlhMmYwZmEyYThjODJjNjk1OTg4OWM4YmVkZDE1ZjllNjc2MTVkMA==", "commit": {"author": {"name": "Alan Lawrence", "email": "alan.lawrence@arm.com", "date": "2016-01-14T16:19:59Z"}, "committer": {"name": "Alan Lawrence", "email": "alalaw01@gcc.gnu.org", "date": "2016-01-14T16:19:59Z"}, "message": "[MIPS] Migrate reduction optabs in mips-ps-3d.md\n\n\t* config/mips/mips-ps-3d.md (reduc_splus_v2sf): Remove.\n\t(reduc_plus_scal_v2sf): New.\n\t(reduc_smax_v2sf): Rename to...\n\t(reduc_smax_scal_v2sf): ...here, make result SFmode, add vec_extract.\n\t(reduc_smin_v2sf): Rename to...\n\t(reduc_smin_scal_v2sf): ...here, make result SFmode, add vec_extract.\n\nFrom-SVN: r232371", "tree": {"sha": "2b6fa7d7da19b905cca892a607b8a26ccd29462f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2b6fa7d7da19b905cca892a607b8a26ccd29462f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0/comments", "author": null, "committer": null, "parents": [{"sha": "a7ccb9e72266f4cd82801166008b0b98cd25c773", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7ccb9e72266f4cd82801166008b0b98cd25c773", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7ccb9e72266f4cd82801166008b0b98cd25c773"}], "stats": {"total": 43, "additions": 31, "deletions": 12}, "files": [{"sha": "299b546d503d14942d740b23e6be164910f17234", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=59a2f0fa2a8c82c6959889c8bedd15f9e67615d0", "patch": "@@ -1,3 +1,12 @@\n+2016-01-14  Alan Lawrence  <alan.lawrence@arm.com>\n+\n+\t* config/mips/mips-ps-3d.md (reduc_splus_v2sf): Remove.\n+\t(reduc_plus_scal_v2sf): New.\n+\t(reduc_smax_v2sf): Rename to...\n+\t(reduc_smax_scal_v2sf): ...here, make result SFmode, add vec_extract.\n+\t(reduc_smin_v2sf): Rename to...\n+\t(reduc_smin_scal_v2sf): ...here, make result SFmode, add vec_extract.\n+\n 2016-01-14  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* alias.c (compare_base_symbol_refs): New function."}, {"sha": "3da85090da5825c7978b8fef046041ed12b52e82", "filename": "gcc/config/mips/mips-ps-3d.md", "status": "modified", "additions": 22, "deletions": 12, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0/gcc%2Fconfig%2Fmips%2Fmips-ps-3d.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59a2f0fa2a8c82c6959889c8bedd15f9e67615d0/gcc%2Fconfig%2Fmips%2Fmips-ps-3d.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips-ps-3d.md?ref=59a2f0fa2a8c82c6959889c8bedd15f9e67615d0", "patch": "@@ -371,13 +371,17 @@\n   [(set_attr \"type\" \"fadd\")\n    (set_attr \"mode\" \"SF\")])\n \n-(define_insn \"reduc_splus_v2sf\"\n-  [(set (match_operand:V2SF 0 \"register_operand\" \"=f\")\n-\t(unspec:V2SF [(match_operand:V2SF 1 \"register_operand\" \"f\")\n-\t\t      (match_dup 1)]\n-\t\t     UNSPEC_ADDR_PS))]\n+(define_expand \"reduc_plus_scal_v2sf\"\n+  [(match_operand:SF 0 \"register_operand\" \"=f\")\n+   (match_operand:V2SF 1 \"register_operand\" \"f\")]\n   \"TARGET_HARD_FLOAT && TARGET_MIPS3D\"\n-  \"\")\n+  {\n+    rtx temp = gen_reg_rtx (V2SFmode);\n+    emit_insn (gen_mips_addr_ps (temp, operands[1], operands[1]));\n+    rtx lane = BYTES_BIG_ENDIAN ? const1_rtx : const0_rtx;\n+    emit_insn (gen_vec_extractv2sf (operands[0], temp, lane));\n+    DONE;\n+  })\n \n ; cvt.pw.ps - Floating Point Convert Paired Single to Paired Word\n (define_insn \"mips_cvt_pw_ps\"\n@@ -745,20 +749,26 @@\n   DONE;\n })\n \n-(define_expand \"reduc_smin_v2sf\"\n-  [(match_operand:V2SF 0 \"register_operand\")\n+(define_expand \"reduc_smin_scal_v2sf\"\n+  [(match_operand:SF 0 \"register_operand\")\n    (match_operand:V2SF 1 \"register_operand\")]\n   \"TARGET_HARD_FLOAT && TARGET_PAIRED_SINGLE_FLOAT\"\n {\n-  mips_expand_vec_reduc (operands[0], operands[1], gen_sminv2sf3);\n+  rtx temp = gen_reg_rtx (V2SFmode);\n+  mips_expand_vec_reduc (temp, operands[1], gen_sminv2sf3);\n+  rtx lane = BYTES_BIG_ENDIAN ? const1_rtx : const0_rtx;\n+  emit_insn (gen_vec_extractv2sf (operands[0], temp, lane));\n   DONE;\n })\n \n-(define_expand \"reduc_smax_v2sf\"\n-  [(match_operand:V2SF 0 \"register_operand\")\n+(define_expand \"reduc_smax_scal_v2sf\"\n+  [(match_operand:SF 0 \"register_operand\")\n    (match_operand:V2SF 1 \"register_operand\")]\n   \"TARGET_HARD_FLOAT && TARGET_PAIRED_SINGLE_FLOAT\"\n {\n-  mips_expand_vec_reduc (operands[0], operands[1], gen_smaxv2sf3);\n+  rtx temp = gen_reg_rtx (V2SFmode);\n+  mips_expand_vec_reduc (temp, operands[1], gen_smaxv2sf3);\n+  rtx lane = BYTES_BIG_ENDIAN ? const1_rtx : const0_rtx;\n+  emit_insn (gen_vec_extractv2sf (operands[0], temp, lane));\n   DONE;\n })"}]}