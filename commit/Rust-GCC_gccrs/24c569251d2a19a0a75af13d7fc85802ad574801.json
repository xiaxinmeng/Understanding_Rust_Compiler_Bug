{"sha": "24c569251d2a19a0a75af13d7fc85802ad574801", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjRjNTY5MjUxZDJhMTlhMGE3NWFmMTNkN2ZjODU4MDJhZDU3NDgwMQ==", "commit": {"author": {"name": "Marcus Shawcroft", "email": "marcus.shawcroft@arm.com", "date": "2013-10-03T10:54:36Z"}, "committer": {"name": "Marcus Shawcroft", "email": "mshawcroft@gcc.gnu.org", "date": "2013-10-03T10:54:36Z"}, "message": "[AArch64] Fix PR58460\n\nPR58460, the add and sub shifted register instruction forms in AArch64\ndo not permit the stack register.  This patch removes k constraint\nfrom the relevant patterns and adds reduced form of the test case.\n\nFrom-SVN: r203157", "tree": {"sha": "92b06892e5bf6395636e47d54e10b35a6f92734f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/92b06892e5bf6395636e47d54e10b35a6f92734f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/24c569251d2a19a0a75af13d7fc85802ad574801", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24c569251d2a19a0a75af13d7fc85802ad574801", "html_url": "https://github.com/Rust-GCC/gccrs/commit/24c569251d2a19a0a75af13d7fc85802ad574801", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/24c569251d2a19a0a75af13d7fc85802ad574801/comments", "author": {"login": "mshawcroft", "id": 6357566, "node_id": "MDQ6VXNlcjYzNTc1NjY=", "avatar_url": "https://avatars.githubusercontent.com/u/6357566?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mshawcroft", "html_url": "https://github.com/mshawcroft", "followers_url": "https://api.github.com/users/mshawcroft/followers", "following_url": "https://api.github.com/users/mshawcroft/following{/other_user}", "gists_url": "https://api.github.com/users/mshawcroft/gists{/gist_id}", "starred_url": "https://api.github.com/users/mshawcroft/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mshawcroft/subscriptions", "organizations_url": "https://api.github.com/users/mshawcroft/orgs", "repos_url": "https://api.github.com/users/mshawcroft/repos", "events_url": "https://api.github.com/users/mshawcroft/events{/privacy}", "received_events_url": "https://api.github.com/users/mshawcroft/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2ab8f063e9957882ce55f8585694a140486eae03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ab8f063e9957882ce55f8585694a140486eae03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ab8f063e9957882ce55f8585694a140486eae03"}], "stats": {"total": 68, "additions": 59, "deletions": 9}, "files": [{"sha": "fd3903bd678e13313740f1090cbdf6a4c59064bc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=24c569251d2a19a0a75af13d7fc85802ad574801", "patch": "@@ -1,3 +1,13 @@\n+2013-10-03  Marcus Shawcroft  <marcus.shawcroft@arm.com>\n+\n+\tPR target/58460\n+\t* config/aarch64/aarch64.md (*adds_mul_imm_<mode>)\n+\t(*subs_mul_imm_<mode>)\n+\t(*add_<shift>_<mode>, *add_<shift>_si_uxtw,*add_mul_imm_<mode>)\n+\t(*sub_<shift>_<mode>)\n+\t(*sub_<shift>_si_uxtw,*sub_mul_imm_<mode>, *sub_mul_imm_si_uxtw):\n+\tRemove k constraint.\n+\n 2013-10-03  Ian Bolton  <ian.bolton@arm.com>\n \n \t* config/aarch64/aarch64.c (aarch64_secondary_reload): Remove legacy"}, {"sha": "f3e004b6c3e300e4769bf9f8b49596282b42906b", "filename": "gcc/config/aarch64/aarch64.md", "status": "modified", "additions": 9, "deletions": 9, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2Fconfig%2Faarch64%2Faarch64.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2Fconfig%2Faarch64%2Faarch64.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.md?ref=24c569251d2a19a0a75af13d7fc85802ad574801", "patch": "@@ -1365,7 +1365,7 @@\n \t (plus:GPI (mult:GPI\n \t\t    (match_operand:GPI 1 \"register_operand\" \"r\")\n \t\t    (match_operand:QI 2 \"aarch64_pwr_2_<mode>\" \"n\"))\n-\t\t   (match_operand:GPI 3 \"register_operand\" \"rk\"))\n+\t\t   (match_operand:GPI 3 \"register_operand\" \"r\"))\n \t (const_int 0)))\n    (set (match_operand:GPI 0 \"register_operand\" \"=r\")\n \t(plus:GPI (mult:GPI (match_dup 1) (match_dup 2))\n@@ -1380,7 +1380,7 @@\n (define_insn \"*subs_mul_imm_<mode>\"\n   [(set (reg:CC_NZ CC_REGNUM)\n \t(compare:CC_NZ\n-\t (minus:GPI (match_operand:GPI 1 \"register_operand\" \"rk\")\n+\t (minus:GPI (match_operand:GPI 1 \"register_operand\" \"r\")\n \t\t    (mult:GPI\n \t\t     (match_operand:GPI 2 \"register_operand\" \"r\")\n \t\t     (match_operand:QI 3 \"aarch64_pwr_2_<mode>\" \"n\")))\n@@ -1500,7 +1500,7 @@\n )\n \n (define_insn \"*add_<shift>_<mode>\"\n-  [(set (match_operand:GPI 0 \"register_operand\" \"=rk\")\n+  [(set (match_operand:GPI 0 \"register_operand\" \"=r\")\n \t(plus:GPI (ASHIFT:GPI (match_operand:GPI 1 \"register_operand\" \"r\")\n \t\t\t      (match_operand:QI 2 \"aarch64_shift_imm_<mode>\" \"n\"))\n \t\t  (match_operand:GPI 3 \"register_operand\" \"r\")))]\n@@ -1513,7 +1513,7 @@\n \n ;; zero_extend version of above\n (define_insn \"*add_<shift>_si_uxtw\"\n-  [(set (match_operand:DI 0 \"register_operand\" \"=rk\")\n+  [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n \t(zero_extend:DI\n \t (plus:SI (ASHIFT:SI (match_operand:SI 1 \"register_operand\" \"r\")\n \t\t             (match_operand:QI 2 \"aarch64_shift_imm_si\" \"n\"))\n@@ -1526,7 +1526,7 @@\n )\n \n (define_insn \"*add_mul_imm_<mode>\"\n-  [(set (match_operand:GPI 0 \"register_operand\" \"=rk\")\n+  [(set (match_operand:GPI 0 \"register_operand\" \"=r\")\n \t(plus:GPI (mult:GPI (match_operand:GPI 1 \"register_operand\" \"r\")\n \t\t\t    (match_operand:QI 2 \"aarch64_pwr_2_<mode>\" \"n\"))\n \t\t  (match_operand:GPI 3 \"register_operand\" \"r\")))]\n@@ -1873,7 +1873,7 @@\n )\n \n (define_insn \"*sub_<shift>_<mode>\"\n-  [(set (match_operand:GPI 0 \"register_operand\" \"=rk\")\n+  [(set (match_operand:GPI 0 \"register_operand\" \"=r\")\n \t(minus:GPI (match_operand:GPI 3 \"register_operand\" \"r\")\n \t\t   (ASHIFT:GPI\n \t\t    (match_operand:GPI 1 \"register_operand\" \"r\")\n@@ -1887,7 +1887,7 @@\n \n ;; zero_extend version of above\n (define_insn \"*sub_<shift>_si_uxtw\"\n-  [(set (match_operand:DI 0 \"register_operand\" \"=rk\")\n+  [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n \t(zero_extend:DI\n          (minus:SI (match_operand:SI 3 \"register_operand\" \"r\")\n \t\t   (ASHIFT:SI\n@@ -1901,7 +1901,7 @@\n )\n \n (define_insn \"*sub_mul_imm_<mode>\"\n-  [(set (match_operand:GPI 0 \"register_operand\" \"=rk\")\n+  [(set (match_operand:GPI 0 \"register_operand\" \"=r\")\n \t(minus:GPI (match_operand:GPI 3 \"register_operand\" \"r\")\n \t\t   (mult:GPI\n \t\t    (match_operand:GPI 1 \"register_operand\" \"r\")\n@@ -1915,7 +1915,7 @@\n \n ;; zero_extend version of above\n (define_insn \"*sub_mul_imm_si_uxtw\"\n-  [(set (match_operand:DI 0 \"register_operand\" \"=rk\")\n+  [(set (match_operand:DI 0 \"register_operand\" \"=r\")\n \t(zero_extend:DI\n          (minus:SI (match_operand:SI 3 \"register_operand\" \"r\")\n \t\t   (mult:SI"}, {"sha": "44628c5e189b1e5b3725aa5377fac4bafbf1f805", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=24c569251d2a19a0a75af13d7fc85802ad574801", "patch": "@@ -1,3 +1,8 @@\n+2013-10-03  Marcus Shawcroft  <marcus.shawcroft@arm.com>\n+\n+\tPR target/58460\n+\t* gcc.target/aarch64/pr58460.c: New file.\n+\n 2013-10-02  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/58593"}, {"sha": "a7e149a371c4088a626305540c83787b4d61de85", "filename": "gcc/testsuite/gcc.target/aarch64/pr58460.c", "status": "added", "additions": 35, "deletions": 0, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpr58460.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/24c569251d2a19a0a75af13d7fc85802ad574801/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpr58460.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fpr58460.c?ref=24c569251d2a19a0a75af13d7fc85802ad574801", "patch": "@@ -0,0 +1,35 @@\n+/* { dg-do run } */\n+/* { dg-options \"-O\" } */\n+extern unsigned long x1;\n+\n+char *\n+f (char *a, char *b)\n+{\n+  return a;\n+}\n+\n+int\n+g (char *a)\n+{\n+  return 2;\n+}\n+\n+void\n+h (char *p[])\n+{\n+  char n[x1][512];\n+  char *l = f (p[1], \" \");\n+  if (g (p[0]))\n+    n[0][0] = '\\0';\n+  while (l && *l)\n+    {\n+    }\n+}\n+\n+unsigned long x1;\n+\n+int\n+main ()\n+{\n+  return 0;\n+}"}]}