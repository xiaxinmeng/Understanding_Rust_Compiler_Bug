{"sha": "fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmIyZjhjZjgzNmQzNDg5ZjcxM2MwYzE0MTZmN2YwOTVlMzdjZjM5Yw==", "commit": {"author": {"name": "Jie Zhang", "email": "jie@codesourcery.com", "date": "2010-07-12T14:02:08Z"}, "committer": {"name": "Jie Zhang", "email": "jiez@gcc.gnu.org", "date": "2010-07-12T14:02:08Z"}, "message": "arm.c (arm_get_frame_offsets): Don't use r3 to align the stack when it's going to be saved.\n\n\t* config/arm/arm.c (arm_get_frame_offsets): Don't use r3 to\n\talign the stack when it's going to be saved.\n\n\ttestsuite/\n\t* gcc.target/arm/interrupt-1.c: New test.\n\t* gcc.target/arm/interrupt-2.c: New test.\n\nFrom-SVN: r162078", "tree": {"sha": "d8776bab6b4808afc4d86db6d527b2b21f0c5025", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d8776bab6b4808afc4d86db6d527b2b21f0c5025"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/comments", "author": null, "committer": null, "parents": [{"sha": "f457c53d3c25e4142adb7b52d3a2705068db1f26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f457c53d3c25e4142adb7b52d3a2705068db1f26", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f457c53d3c25e4142adb7b52d3a2705068db1f26"}], "stats": {"total": 62, "additions": 61, "deletions": 1}, "files": [{"sha": "5a446a9da0843ff2e25f31f5cff9ce22547157b8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "patch": "@@ -1,3 +1,8 @@\n+2010-07-12  Jie Zhang  <jie@codesourcery.com>\n+\n+\t* config/arm/arm.c (arm_get_frame_offsets): Don't use r3 to\n+\talign the stack when it's going to be saved.\n+\n 2010-07-12  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \tPR pch/14940"}, {"sha": "aa0f9cc7590c9fe8041f6fe54257eb7a4aaaa269", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "patch": "@@ -14691,7 +14691,8 @@ arm_get_frame_offsets (void)\n \t     generates better code on Thumb-2 by avoiding the need to\n \t     use 32-bit push/pop instructions.  */\n \t  if (!crtl->tail_call_emit\n-\t      && arm_size_return_regs () <= 12)\n+\t      && arm_size_return_regs () <= 12\n+\t      && (offsets->saved_regs_mask & (1 << 3)) == 0)\n \t    {\n \t      reg = 3;\n \t    }"}, {"sha": "7d0fb14c001967ef6e1766f333812ef623d22ef8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "patch": "@@ -1,3 +1,8 @@\n+2010-07-12  Jie Zhang  <jie@codesourcery.com>\n+\n+\t* gcc.target/arm/interrupt-1.c: New test.\n+\t* gcc.target/arm/interrupt-2.c: New test.\n+\n 2010-07-12  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \t* gcc.dg/pr42427.c: Require c99_runtime."}, {"sha": "18379de33d0f6733df4da48bf4ab82d751caf7fe", "filename": "gcc/testsuite/gcc.target/arm/interrupt-1.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Finterrupt-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Finterrupt-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Finterrupt-1.c?ref=fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "patch": "@@ -0,0 +1,23 @@\n+/* Verify that prologue and epilogue are correct for functions with\n+   __attribute__ ((interrupt)).  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O0\" } */\n+\n+/* This test is not valid when -mthumb.  We just cheat.  */\n+#ifndef __thumb__\n+extern void bar (int);\n+extern void foo (void) __attribute__ ((interrupt(\"IRQ\")));\n+\n+void foo ()\n+{\n+  bar (0);\n+}\n+#else\n+void foo ()\n+{\n+  asm (\"stmfd\\tsp!, {r0, r1, r2, r3, r4, fp, ip, lr}\");\n+  asm (\"ldmfd\\tsp!, {r0, r1, r2, r3, r4, fp, ip, pc}^\");\n+}\n+#endif\n+/* { dg-final { scan-assembler \"stmfd\\tsp!, {r0, r1, r2, r3, r4, fp, ip, lr}\" } } */\n+/* { dg-final { scan-assembler \"ldmfd\\tsp!, {r0, r1, r2, r3, r4, fp, ip, pc}\\\\^\" } } */"}, {"sha": "b979bf17e8a1d077ada035cf294854f3d740492d", "filename": "gcc/testsuite/gcc.target/arm/interrupt-2.c", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Finterrupt-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fb2f8cf836d3489f713c0c1416f7f095e37cf39c/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Finterrupt-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Finterrupt-2.c?ref=fb2f8cf836d3489f713c0c1416f7f095e37cf39c", "patch": "@@ -0,0 +1,26 @@\n+/* Verify that prologue and epilogue are correct for functions with\n+   __attribute__ ((interrupt)).  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1\" } */\n+\n+/* This test is not valid when -mthum.  We just cheat.  */\n+#ifndef __thumb__\n+extern void bar (int);\n+extern void test (void) __attribute__((__interrupt__));\n+\n+int foo;\n+void test()\n+{\n+  funcptrs(foo);\n+  foo = 0;\n+}\n+#else\n+void test ()\n+{\n+  asm (\"stmfd\\tsp!, {r0, r1, r2, r3, r4, r5, ip, lr}\");\n+  asm (\"ldmfd\\tsp!, {r0, r1, r2, r3, r4, r5, ip, pc}^\");\n+}\n+#endif\n+\n+/* { dg-final { scan-assembler \"stmfd\\tsp!, {r0, r1, r2, r3, r4, r5, ip, lr}\" } } */\n+/* { dg-final { scan-assembler \"ldmfd\\tsp!, {r0, r1, r2, r3, r4, r5, ip, pc}\\\\^\" } } */"}]}