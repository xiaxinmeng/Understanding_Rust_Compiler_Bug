{"sha": "4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGMwYWI2OWQzYjY4MWMzZjliMDdlZTI5Zjc0NTJiZjJmYjYwYjc1YQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-04-20T17:04:10Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2010-04-20T17:04:10Z"}, "message": "dwarf2out.c (AT_linkage_name): Define.\n\n\t* dwarf2out.c (AT_linkage_name): Define.\n\t(clone_as_declaration): Handle DW_AT_linkage_name.\n\t(add_name_and_src_coords_attributes): Use AT_linkage_name instead\n\tof DW_AT_MIPS_linkage_name.\n\t(move_linkage_attr): Likewise.\n\t(dwarf2out_finish): Likewise.\n\nFrom-SVN: r158568", "tree": {"sha": "809840513fcde1cc2295342b7c5db3395f6f13eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/809840513fcde1cc2295342b7c5db3395f6f13eb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a/comments", "author": null, "committer": null, "parents": [{"sha": "94e85e0ae88fee653abdfe33244da282dd44184d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94e85e0ae88fee653abdfe33244da282dd44184d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94e85e0ae88fee653abdfe33244da282dd44184d"}], "stats": {"total": 29, "additions": 22, "deletions": 7}, "files": [{"sha": "971fccb7d436e6b508324558e1a9545e7cb31e75", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a", "patch": "@@ -1,9 +1,18 @@\n+2010-04-20  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* dwarf2out.c (AT_linkage_name): Define.\n+\t(clone_as_declaration): Handle DW_AT_linkage_name.\n+\t(add_name_and_src_coords_attributes): Use AT_linkage_name instead\n+\tof DW_AT_MIPS_linkage_name.\n+\t(move_linkage_attr): Likewise.\n+\t(dwarf2out_finish): Likewise.\n+\n 2010-04-20  Xinliang David Li  <davidxl@gcc.gnu.org>\n \n \tPR middle-end/41952\n \t* fold-const.c (fold_comparison): New folding rule. \n \n-2010-04-20  Anatoly Sokolov  <aesok@post.ru\n+2010-04-20  Anatoly Sokolov  <aesok@post.ru>\n \n \t* double-int.h (double_int_setbit): Declare.\n \t* double-int.c (double_int_setbit): New function."}, {"sha": "cfacf96a62bbd7a8c0ca3e032739dece7e8dd8bd", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 12, "deletions": 6, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=4c0ab69d3b681c3f9b07ee29f7452bf2fb60b75a", "patch": "@@ -5710,8 +5710,7 @@ static GTY(()) comdat_type_node *comdat_type_list;\n static GTY(()) limbo_die_node *limbo_die_list;\n \n /* A list of DIEs for which we may have to generate\n-   DW_AT_MIPS_linkage_name once their DECL_ASSEMBLER_NAMEs are\n-   set.  */\n+   DW_AT_{,MIPS_}linkage_name once their DECL_ASSEMBLER_NAMEs are set.  */\n static GTY(()) limbo_die_node *deferred_asm_name;\n \n /* Filenames referenced by this compilation unit.  */\n@@ -6273,6 +6272,12 @@ static void gen_remaining_tmpl_value_param_die_attribute (void);\n #define DEBUG_MACINFO_SECTION_LABEL     \"Ldebug_macinfo\"\n #endif\n \n+/* Mangled name attribute to use.  This used to be a vendor extension\n+   until DWARF 4 standardized it.  */\n+#define AT_linkage_name \\\n+  (dwarf_version >= 4 ? DW_AT_linkage_name : DW_AT_MIPS_linkage_name)\n+\n+\n /* Definitions of defaults for formats and names of various special\n    (artificial) labels which may be generated within this file (when the -g\n    options is used and DWARF2_DEBUGGING_INFO is in effect.\n@@ -9331,6 +9336,7 @@ clone_as_declaration (dw_die_ref die)\n         case DW_AT_name:\n         case DW_AT_type:\n         case DW_AT_virtuality:\n+        case DW_AT_linkage_name:\n         case DW_AT_MIPS_linkage_name:\n           add_dwarf_attr (clone, a);\n           break;\n@@ -16769,7 +16775,7 @@ add_name_and_src_coords_attributes (dw_die_ref die, tree decl)\n \t      deferred_asm_name = asm_name;\n \t    }\n \t  else if (DECL_ASSEMBLER_NAME (decl) != DECL_NAME (decl))\n-\t    add_AT_string (die, DW_AT_MIPS_linkage_name,\n+\t    add_AT_string (die, AT_linkage_name,\n \t\t\t   IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (decl)));\n \t}\n     }\n@@ -21139,7 +21145,7 @@ htab_ct_eq (const void *of1, const void *of2)\n                     DWARF_TYPE_SIGNATURE_SIZE));\n }\n \n-/* Move a DW_AT_MIPS_linkage_name attribute just added to dw_die_ref\n+/* Move a DW_AT_{,MIPS_}linkage_name attribute just added to dw_die_ref\n    to the location it would have been added, should we know its\n    DECL_ASSEMBLER_NAME when we added other attributes.  This will\n    probably improve compactness of debug info, removing equivalent\n@@ -21152,7 +21158,7 @@ move_linkage_attr (dw_die_ref die)\n   unsigned ix = VEC_length (dw_attr_node, die->die_attr);\n   dw_attr_node linkage = *VEC_index (dw_attr_node, die->die_attr, ix - 1);\n \n-  gcc_assert (linkage.dw_attr == DW_AT_MIPS_linkage_name);\n+  gcc_assert (linkage.dw_attr == AT_linkage_name);\n \n   while (--ix > 0)\n     {\n@@ -21386,7 +21392,7 @@ dwarf2out_finish (const char *filename)\n       tree decl = node->created_for;\n       if (DECL_ASSEMBLER_NAME (decl) != DECL_NAME (decl))\n \t{\n-\t  add_AT_string (node->die, DW_AT_MIPS_linkage_name,\n+\t  add_AT_string (node->die, AT_linkage_name,\n \t\t\t IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (decl)));\n \t  move_linkage_attr (node->die);\n \t}"}]}