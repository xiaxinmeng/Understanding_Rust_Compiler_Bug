{"sha": "e3371908b30b254f79f735abf66a8d17c188988a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTMzNzE5MDhiMzBiMjU0Zjc5ZjczNWFiZjY2YThkMTdjMTg4OTg4YQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2019-12-18T09:51:14Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2019-12-18T09:51:14Z"}, "message": "trans.c (Pragma_to_gnu): Push a diagnostics state for pragma Warnings (Off) before turning off all the...\n\n\t* gcc-interface/trans.c (Pragma_to_gnu) <Pragma_Warnings>: Push a\n\tdiagnostics state for pragma Warnings (Off) before turning off all\n\tthe warnings and only pop it for pragma Warnings (On).\n\nFrom-SVN: r279519", "tree": {"sha": "f3a8d751e055aaec4d0e6e9be6f90ecc73b67dc4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f3a8d751e055aaec4d0e6e9be6f90ecc73b67dc4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e3371908b30b254f79f735abf66a8d17c188988a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3371908b30b254f79f735abf66a8d17c188988a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e3371908b30b254f79f735abf66a8d17c188988a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e3371908b30b254f79f735abf66a8d17c188988a/comments", "author": null, "committer": null, "parents": [{"sha": "d4a45898bc44a87f076485da44912df8c461bc64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d4a45898bc44a87f076485da44912df8c461bc64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d4a45898bc44a87f076485da44912df8c461bc64"}], "stats": {"total": 45, "additions": 44, "deletions": 1}, "files": [{"sha": "bfc838f48f2fb2738941628501c75e8fc8befb03", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=e3371908b30b254f79f735abf66a8d17c188988a", "patch": "@@ -1,3 +1,9 @@\n+2019-12-18  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/trans.c (Pragma_to_gnu) <Pragma_Warnings>: Push a\n+\tdiagnostics state for pragma Warnings (Off) before turning off all\n+\tthe warnings and only pop it for pragma Warnings (On).\n+\n 2019-12-18  Justin Squirek  <squirek@adacore.com>\n \n \t* sem_ch6.adb (Analyze_Function_Return): Modify handling of"}, {"sha": "5f87bc3dca8b0fee27cf913486d29d24f81a0638", "filename": "gcc/ada/gcc-interface/trans.c", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Fada%2Fgcc-interface%2Ftrans.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Ftrans.c?ref=e3371908b30b254f79f735abf66a8d17c188988a", "patch": "@@ -1975,7 +1975,21 @@ Pragma_to_gnu (Node_Id gnat_node)\n \t        gnat_expr = Expression (Next (gnat_temp));\n \t      }\n \t    else\n-\t      gnat_expr = Empty;\n+\t      {\n+\t\tgnat_expr = Empty;\n+\n+\t\t/* For pragma Warnings (Off), we save the current state...  */\n+\t\tif (kind == DK_IGNORED)\n+\t\t  diagnostic_push_diagnostics (global_dc, location);\n+\n+\t\t/* ...so that, for pragma Warnings (On), we do not enable all\n+\t\t   the warnings but just restore the previous state.  */\n+\t\telse\n+\t\t  {\n+\t\t    diagnostic_pop_diagnostics (global_dc, location);\n+\t\t    break;\n+\t\t  }\n+\t      }\n \n \t    imply = false;\n \t  }"}, {"sha": "a0b25efde5ba9d51af6fe0b33c42d5f69ff98f54", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e3371908b30b254f79f735abf66a8d17c188988a", "patch": "@@ -1,3 +1,7 @@\n+2019-12-18  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/warn32.adb: New test.\n+\n 2019-12-17  Martin Sebor  <msebor@redhat.com>\n \n \tPR c++/61339"}, {"sha": "e3ffefb47ceadbf7e6335d2c31f87ddd72fcc067", "filename": "gcc/testsuite/gnat.dg/warn32.adb", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn32.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e3371908b30b254f79f735abf66a8d17c188988a/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn32.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn32.adb?ref=e3371908b30b254f79f735abf66a8d17c188988a", "patch": "@@ -0,0 +1,19 @@\n+--  { dg-do compile }\n+--  { dg-options \"-O -gnatn -Winline -cargs --param max-inline-insns-single=50 -margs\" }\n+\n+with Ada.Containers.Vectors;\n+with Ada.Strings.Unbounded; use Ada.Strings.Unbounded;\n+with Ada.Text_IO;\n+\n+procedure Warn32 is\n+  type Selected_Block_T is record\n+    Contents  : Unbounded_String;\n+    File_Name : Unbounded_String;\n+  end record;\n+\n+  pragma Warnings (Off, \"-Winline\");\n+  package Selected_Block_List is\n+    new Ada.Containers.Vectors (Natural, Selected_Block_T);\n+begin\n+  Ada.Text_Io.Put_Line (\"Hello World!\");\n+end;"}]}