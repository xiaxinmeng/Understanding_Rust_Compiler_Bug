{"sha": "d8468b976bb2721c32368e2a80591e77ca49250f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDg0NjhiOTc2YmIyNzIxYzMyMzY4ZTJhODA1OTFlNzdjYTQ5MjUwZg==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2019-12-16T10:33:45Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-12-16T10:33:45Z"}, "message": "[Ada] Small consistency fix for Volatile_Full_Access objects\n\n2019-12-16  Eric Botcazou  <ebotcazou@adacore.com>\n\ngcc/ada/\n\n\t* sem_util.adb (Is_Atomic_Or_VFA_Object): Also return true for\n\tcomponents whose type is Volatile_Full_Access or which are\n\tsubject to the aspect/pragma individually.\n\t* sem_util.ads (Is_Atomic_Object_Entity): Small comment fix.\n\nFrom-SVN: r279420", "tree": {"sha": "d7fd7ad92d568545f6796febd4fa09361ad9e870", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d7fd7ad92d568545f6796febd4fa09361ad9e870"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d8468b976bb2721c32368e2a80591e77ca49250f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8468b976bb2721c32368e2a80591e77ca49250f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d8468b976bb2721c32368e2a80591e77ca49250f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8468b976bb2721c32368e2a80591e77ca49250f/comments", "author": null, "committer": null, "parents": [{"sha": "bee69f33688293b0c5afdf737d03aca12a8fccb4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bee69f33688293b0c5afdf737d03aca12a8fccb4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bee69f33688293b0c5afdf737d03aca12a8fccb4"}], "stats": {"total": 58, "additions": 51, "deletions": 7}, "files": [{"sha": "95e195d89f0bde713989e2523c7a81f216a8db48", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8468b976bb2721c32368e2a80591e77ca49250f/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8468b976bb2721c32368e2a80591e77ca49250f/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=d8468b976bb2721c32368e2a80591e77ca49250f", "patch": "@@ -1,3 +1,10 @@\n+2019-12-16  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* sem_util.adb (Is_Atomic_Or_VFA_Object): Also return true for\n+\tcomponents whose type is Volatile_Full_Access or which are\n+\tsubject to the aspect/pragma individually.\n+\t* sem_util.ads (Is_Atomic_Object_Entity): Small comment fix.\n+\n 2019-12-16  Yannick Moy  <moy@adacore.com>\n \n \t* exp_ch6.adb: Fix comment."}, {"sha": "2c4ff68c9abc281a6ad0212b75fcfb4c927a4321", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 43, "deletions": 6, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8468b976bb2721c32368e2a80591e77ca49250f/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8468b976bb2721c32368e2a80591e77ca49250f/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=d8468b976bb2721c32368e2a80591e77ca49250f", "patch": "@@ -13788,13 +13788,50 @@ package body Sem_Util is\n    -----------------------------\n \n    function Is_Atomic_Or_VFA_Object (N : Node_Id) return Boolean is\n+      function Is_VFA_Object (N : Node_Id) return Boolean;\n+      --  Determine whether arbitrary node N denotes a reference to an object\n+      --  which is Volatile_Full_Access. Modelled on Is_Atomic_Object above.\n+\n+      function Is_VFA_Object_Entity (Id : Entity_Id) return Boolean;\n+      --  Determine whether arbitrary entity Id denotes an object which is\n+      --  Volatile_Full_Access. Modelled on Is_Atomic_Object_Entity above.\n+\n+      ---------------------\n+      --  Is_VFA_Object  --\n+      ---------------------\n+\n+      function Is_VFA_Object (N : Node_Id) return Boolean is\n+      begin\n+         if Is_Entity_Name (N) then\n+            return Is_VFA_Object_Entity (Entity (N));\n+\n+         elsif Nkind (N) = N_Indexed_Component then\n+            return Is_Volatile_Full_Access (Etype (N));\n+\n+         elsif Nkind (N) = N_Selected_Component then\n+            return\n+              Is_Volatile_Full_Access (Etype (N))\n+                or else Is_Volatile_Full_Access (Entity (Selector_Name (N)));\n+         end if;\n+\n+         return False;\n+      end Is_VFA_Object;\n+\n+      ----------------------------\n+      --  Is_VFA_Object_Entity  --\n+      ----------------------------\n+\n+      function Is_VFA_Object_Entity (Id : Entity_Id) return Boolean is\n+      begin\n+         return\n+           Is_Object (Id)\n+             and then (Is_Volatile_Full_Access (Id)\n+                         or else\n+                       Is_Volatile_Full_Access (Etype (Id)));\n+      end Is_VFA_Object_Entity;\n+\n    begin\n-      return Is_Atomic_Object (N)\n-        or else (Is_Entity_Name (N)\n-                   and then Is_Object (Entity (N))\n-                   and then (Is_Volatile_Full_Access (Entity (N))\n-                                or else\n-                             Is_Volatile_Full_Access (Etype (Entity (N)))));\n+      return Is_Atomic_Object (N) or else Is_VFA_Object (N);\n    end Is_Atomic_Or_VFA_Object;\n \n    ----------------------"}, {"sha": "a665b5e9a309519ed12d91ea19294bc41138fc41", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d8468b976bb2721c32368e2a80591e77ca49250f/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d8468b976bb2721c32368e2a80591e77ca49250f/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=d8468b976bb2721c32368e2a80591e77ca49250f", "patch": "@@ -1535,7 +1535,7 @@ package Sem_Util is\n \n    function Is_Atomic_Object_Entity (Id : Entity_Id) return Boolean;\n    --  Determine whether arbitrary entity Id denotes an atomic object as per\n-   --  Ada RM C.6(12).\n+   --  Ada RM C.6(7).\n \n    function Is_Atomic_Or_VFA_Object (N : Node_Id) return Boolean;\n    --  Determine whether arbitrary node N denotes a reference to an object"}]}