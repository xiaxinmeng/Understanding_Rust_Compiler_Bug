{"sha": "589520b621afc3583a6bea2aeadae3825c82211e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTg5NTIwYjYyMWFmYzM1ODNhNmJlYTJhZWFkYWUzODI1YzgyMjExZQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2009-11-13T18:55:07Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2009-11-13T18:55:07Z"}, "message": "ipa.c (function_and_variable_visibility): Clear COMDAT on functions when to PUBLIC is set.\n\n\n\t* ipa.c (function_and_variable_visibility): Clear COMDAT on functions\n\twhen to PUBLIC is set.\n\nFrom-SVN: r154167", "tree": {"sha": "dcd86629c1ccc4e4d990f1f96a5d56b4fa507e3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dcd86629c1ccc4e4d990f1f96a5d56b4fa507e3e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/589520b621afc3583a6bea2aeadae3825c82211e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/589520b621afc3583a6bea2aeadae3825c82211e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/589520b621afc3583a6bea2aeadae3825c82211e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/589520b621afc3583a6bea2aeadae3825c82211e/comments", "author": null, "committer": null, "parents": [{"sha": "5b6dad5d8fbc79a1029f55e565336df4b74ed3c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5b6dad5d8fbc79a1029f55e565336df4b74ed3c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5b6dad5d8fbc79a1029f55e565336df4b74ed3c6"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "f2a0da5078f75d2b0549d0e2da6c037aa3014e50", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/589520b621afc3583a6bea2aeadae3825c82211e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/589520b621afc3583a6bea2aeadae3825c82211e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=589520b621afc3583a6bea2aeadae3825c82211e", "patch": "@@ -1,3 +1,8 @@\n+2009-11-13  Jan Hubicka  <jh@suse.cz>\n+\n+\t* ipa.c (function_and_variable_visibility): Clear COMDAT on functions\n+\twhen to PUBLIC is set.\n+\n 2009-11-13  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/42029"}, {"sha": "6234e662e5e1719a8ce24b9c887e8c0ae23fb378", "filename": "gcc/ipa.c", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/589520b621afc3583a6bea2aeadae3825c82211e/gcc%2Fipa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/589520b621afc3583a6bea2aeadae3825c82211e/gcc%2Fipa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa.c?ref=589520b621afc3583a6bea2aeadae3825c82211e", "patch": "@@ -292,6 +292,12 @@ function_and_variable_visibility (bool whole_program)\n \n   for (node = cgraph_nodes; node; node = node->next)\n     {\n+      /* C++ FE on lack of COMDAT support create local COMDAT functions\n+\t (that ought to be shared but can not due to object format\n+\t limitations).  It is neccesary to keep the flag to make rest of C++ FE\n+\t happy.  Clear the flag here to avoid confusion in middle-end.  */\n+      if (DECL_COMDAT (node->decl) && !TREE_PUBLIC (node->decl))\n+        DECL_COMDAT (node->decl) = 0;\n       gcc_assert ((!DECL_WEAK (node->decl) && !DECL_COMDAT (node->decl))\n       \t          || TREE_PUBLIC (node->decl) || DECL_EXTERNAL (node->decl));\n       if (cgraph_externally_visible_p (node, whole_program))"}]}