{"sha": "d47e3adf1d1100661aa25c0668575c649a690b4a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDQ3ZTNhZGYxZDExMDA2NjFhYTI1YzA2Njg1NzVjNjQ5YTY5MGI0YQ==", "commit": {"author": {"name": "Lee Millward", "email": "lee.millward@codesourcery.com", "date": "2006-08-15T17:21:09Z"}, "committer": {"name": "Lee Millward", "email": "lmillward@gcc.gnu.org", "date": "2006-08-15T17:21:09Z"}, "message": "re PR c++/28594 (ICE with invalid template parameter)\n\n\tPR c++/28594\n\t* pt.c (process_template_parm): Robustify.\n\t* g++.dg/template/void6.C: New test.\n\nFrom-SVN: r116160", "tree": {"sha": "6f94e361b433416c5300723a2b281d3b4f0daf3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6f94e361b433416c5300723a2b281d3b4f0daf3e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d47e3adf1d1100661aa25c0668575c649a690b4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d47e3adf1d1100661aa25c0668575c649a690b4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d47e3adf1d1100661aa25c0668575c649a690b4a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d47e3adf1d1100661aa25c0668575c649a690b4a/comments", "author": null, "committer": null, "parents": [{"sha": "b0faa35c0ffce50dce634a21a4997dfd08a74e32", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0faa35c0ffce50dce634a21a4997dfd08a74e32", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0faa35c0ffce50dce634a21a4997dfd08a74e32"}], "stats": {"total": 30, "additions": 24, "deletions": 6}, "files": [{"sha": "53efac925404831f1169ca94c70c45c3a76973e8", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d47e3adf1d1100661aa25c0668575c649a690b4a", "patch": "@@ -1,3 +1,8 @@\n+2006-08-15  Lee Millward  <lee.millward@codesourcery.com>\n+\n+\tPR c++/28594\n+\t* pt.c (process_template_parm): Robustify.\n+\t\n 2006-08-14  Steve Ellcey  <sje@cup.hp.com>\n \n \tPR c++/28288"}, {"sha": "4c2b45a5a69dfb106e5aceeaf4419c371946a22f", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=d47e3adf1d1100661aa25c0668575c649a690b4a", "patch": "@@ -2352,19 +2352,24 @@ process_template_parm (tree list, tree parm, bool is_non_type)\n {\n   tree decl = 0;\n   tree defval;\n-  int idx;\n+  int idx = 0;\n \n   gcc_assert (TREE_CODE (parm) == TREE_LIST);\n   defval = TREE_PURPOSE (parm);\n \n   if (list)\n     {\n-      tree p = TREE_VALUE (tree_last (list));\n+      tree p = tree_last (list);\n+\n+      if (p && p != error_mark_node)\n+        {\n+          p = TREE_VALUE (p);\n+          if (TREE_CODE (p) == TYPE_DECL || TREE_CODE (p) == TEMPLATE_DECL)\n+            idx = TEMPLATE_TYPE_IDX (TREE_TYPE (p));\n+          else\n+            idx = TEMPLATE_PARM_IDX (DECL_INITIAL (p));\n+        }\n \n-      if (TREE_CODE (p) == TYPE_DECL || TREE_CODE (p) == TEMPLATE_DECL)\n-\tidx = TEMPLATE_TYPE_IDX (TREE_TYPE (p));\n-      else\n-\tidx = TEMPLATE_PARM_IDX (DECL_INITIAL (p));\n       ++idx;\n     }\n   else"}, {"sha": "030212f05e4b4cc79d9d0adace10ebfd771b4c4d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d47e3adf1d1100661aa25c0668575c649a690b4a", "patch": "@@ -1,3 +1,8 @@\n+2006-08-15  Lee Millward  <lee.millward@codesourcery.com>\n+\n+\tPR c++/28594\n+\t* g++.dg/template/void6.C: New test.\n+\t\n 2006-08-15  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \tPR c/28649"}, {"sha": "2d5f7ead184fff123f4efd89df2dd0b9c4950249", "filename": "gcc/testsuite/g++.dg/template/void6.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fvoid6.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d47e3adf1d1100661aa25c0668575c649a690b4a/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fvoid6.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fvoid6.C?ref=d47e3adf1d1100661aa25c0668575c649a690b4a", "patch": "@@ -0,0 +1,3 @@\n+//PR c++/28594\n+\n+template<void, int> struct A; // { dg-error \"not a valid type\" }"}]}