{"sha": "d1783ae53cfc5cea69de151a4df63dead33a0386", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDE3ODNhZTUzY2ZjNWNlYTY5ZGUxNTFhNGRmNjNkZWFkMzNhMDM4Ng==", "commit": {"author": {"name": "Kai Tietz", "email": "ktietz@redhat.com", "date": "2015-02-27T10:44:43Z"}, "committer": {"name": "Kai Tietz", "email": "ktietz@gcc.gnu.org", "date": "2015-02-27T10:44:43Z"}, "message": "re PR c/35330 (ICE with invalid pragma weak)\n\n2015-02-27  Kai Tietz  <ktietz@redhat.com>\n\n\tPR c/35330\n\t* c-pragma.c (handle_pragma_weak): Do not try to create\n\tweak/alias of declarations not being function, or variable\n\tdeclarations.\n\n2015-02-27  Kai Tietz  <ktietz@redhat.com>\n\n\tPR c/35330\n\t* gcc.dg/weak/weak-17.c: New file.\n\nFrom-SVN: r221053", "tree": {"sha": "cccd444baeb8f19701371b711edd405a31aae37f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cccd444baeb8f19701371b711edd405a31aae37f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d1783ae53cfc5cea69de151a4df63dead33a0386", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1783ae53cfc5cea69de151a4df63dead33a0386", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d1783ae53cfc5cea69de151a4df63dead33a0386", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1783ae53cfc5cea69de151a4df63dead33a0386/comments", "author": null, "committer": null, "parents": [{"sha": "1310f119efaa7248016bcab2b3da6b83fc689c2d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1310f119efaa7248016bcab2b3da6b83fc689c2d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1310f119efaa7248016bcab2b3da6b83fc689c2d"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "ca5a412fad920919b4f78dab1f419f0e56b6fe39", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=d1783ae53cfc5cea69de151a4df63dead33a0386", "patch": "@@ -1,3 +1,10 @@\n+2015-02-27  Kai Tietz  <ktietz@redhat.com>\n+\n+\tPR c/35330\n+\t* c-pragma.c (handle_pragma_weak): Do not try to create\n+\tweak/alias of declarations not being function, or variable\n+\tdeclarations.\n+\n 2015-02-24  Thomas Schwinge  <thomas@codesourcery.com>\n \n \tPR libgomp/64625"}, {"sha": "6894f0e7c3d1ea932ff05f370680be3d18dfcf94", "filename": "gcc/c-family/c-pragma.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Fc-family%2Fc-pragma.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Fc-family%2Fc-pragma.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-pragma.c?ref=d1783ae53cfc5cea69de151a4df63dead33a0386", "patch": "@@ -392,6 +392,9 @@ handle_pragma_weak (cpp_reader * ARG_UNUSED (dummy))\n   decl = identifier_global_value (name);\n   if (decl && DECL_P (decl))\n     {\n+      if (!VAR_OR_FUNCTION_DECL_P (decl))\n+\tGCC_BAD2 (\"%<#pragma weak%> declaration of %q+D not allowed,\"\n+\t\t  \" ignored\", decl);\n       apply_pragma_weak (decl, value);\n       if (value)\n \t{"}, {"sha": "5ca86b107f89e8d8a651690437cb763785e14e20", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d1783ae53cfc5cea69de151a4df63dead33a0386", "patch": "@@ -1,3 +1,8 @@\n+2015-02-27  Kai Tietz  <ktietz@redhat.com>\n+\n+\tPR c/35330\n+\t* gcc.dg/weak/weak-17.c: New file.\n+\n 2015-02-27  Richard Biener  <rguenther@suse.de>\n \n \tPR lto/65193"}, {"sha": "b4bda9bc0cbadc675219af83e62216480a61a370", "filename": "gcc/testsuite/gcc.dg/weak/weak-17.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Ftestsuite%2Fgcc.dg%2Fweak%2Fweak-17.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1783ae53cfc5cea69de151a4df63dead33a0386/gcc%2Ftestsuite%2Fgcc.dg%2Fweak%2Fweak-17.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fweak%2Fweak-17.c?ref=d1783ae53cfc5cea69de151a4df63dead33a0386", "patch": "@@ -0,0 +1,5 @@\n+/* { dg-do compile } */\n+/* { dg-require-weak \"\" } */\n+#pragma weak int = foo\n+\n+/* { dg-warning \"declaration of\" \"weak\" { target *-*-* } 0 } */"}]}