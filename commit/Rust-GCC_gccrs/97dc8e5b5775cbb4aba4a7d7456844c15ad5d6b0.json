{"sha": "97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTdkYzhlNWI1Nzc1Y2JiNGFiYTRhN2Q3NDU2ODQ0YzE1YWQ1ZDZiMA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2007-08-23T23:27:34Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2007-08-23T23:27:34Z"}, "message": "re PR c++/32898 (Definition of variable N::i outside namespace N not rejected)\n\n\tPR c++/32898\n\t* name-lookup.c (set_decl_namespace): lookup_qualified_name failure\n\tis error_mark_node rather than NULL_TREE.\n\t* pt.c (check_explicit_specialization): Likewise.\n\n\t* g++.dg/lookup/ns3.C: New test.\n\nFrom-SVN: r127749", "tree": {"sha": "678f401110fa2b1d462caa8ea4f40e088161b2d8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/678f401110fa2b1d462caa8ea4f40e088161b2d8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9b21a3805360cf92d94c3767743f85f992f8293d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9b21a3805360cf92d94c3767743f85f992f8293d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9b21a3805360cf92d94c3767743f85f992f8293d"}], "stats": {"total": 19, "additions": 17, "deletions": 2}, "files": [{"sha": "e39c0a1b695e061d039ca66e79e7cd4aab8ebd3d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "patch": "@@ -1,5 +1,10 @@\n 2007-08-24  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/32898\n+\t* name-lookup.c (set_decl_namespace): lookup_qualified_name failure\n+\tis error_mark_node rather than NULL_TREE.\n+\t* pt.c (check_explicit_specialization): Likewise.\n+\n \tPR c++/31941\n \t* error.c (resolve_virtual_fun_from_obj_type_ref): Handle\n \tTARGET_VTABLE_USES_DESCRIPTORS targets properly."}, {"sha": "c6628aa49105c3025eb657afd162f3aced3eb995", "filename": "gcc/cp/name-lookup.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Fcp%2Fname-lookup.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Fcp%2Fname-lookup.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fname-lookup.c?ref=97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "patch": "@@ -2970,7 +2970,7 @@ set_decl_namespace (tree decl, tree scope, bool friendp)\n \n   /* See whether this has been declared in the namespace.  */\n   old = lookup_qualified_name (scope, DECL_NAME (decl), false, true);\n-  if (!old)\n+  if (old == error_mark_node)\n     /* No old declaration at all.  */\n     goto complain;\n   if (!is_overloaded_fn (decl))"}, {"sha": "2594e7d11805978630bf007629d92e8640003308", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "patch": "@@ -1980,7 +1980,7 @@ check_explicit_specialization (tree declarator,\n \t\t context.  */\n \t      fns = lookup_qualified_name (CP_DECL_CONTEXT (decl), dname,\n \t\t\t\t\t   false, true);\n-\t      if (!fns || !is_overloaded_fn (fns))\n+\t      if (fns == error_mark_node || !is_overloaded_fn (fns))\n \t\t{\n \t\t  error (\"%qD is not a template function\", dname);\n \t\t  fns = error_mark_node;\n@@ -2215,6 +2215,8 @@ check_explicit_specialization (tree declarator,\n               /* This specialization has the same linkage and visibility as\n                  the function template it specializes.  */\n               TREE_PUBLIC (decl) = TREE_PUBLIC (tmpl_func);\n+\t      if (! TREE_PUBLIC (decl) && DECL_INTERFACE_KNOWN (tmpl_func))\n+\t\tDECL_INTERFACE_KNOWN (decl) = 1;\n               DECL_THIS_STATIC (decl) = DECL_THIS_STATIC (tmpl_func);\n               if (DECL_VISIBILITY_SPECIFIED (tmpl_func))\n                 {"}, {"sha": "5c35247763519b293e2a598b71fdfb79728547b8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "patch": "@@ -1,5 +1,8 @@\n 2007-08-24  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/32898\n+\t* g++.dg/lookup/ns3.C: New test.\n+\n \t* gfortran.dg/assumed_charlen_sharing.f90: New test.\n \n \tPR c++/31941"}, {"sha": "144cba73daee4bf5255c655a1fd73588b355842a", "filename": "gcc/testsuite/g++.dg/lookup/ns3.C", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fns3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fns3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flookup%2Fns3.C?ref=97dc8e5b5775cbb4aba4a7d7456844c15ad5d6b0", "patch": "@@ -0,0 +1,5 @@\n+// PR c++/32898\n+\n+namespace N { }\n+\n+int N::i;\t// { dg-error \"should have been declared inside\" }"}]}