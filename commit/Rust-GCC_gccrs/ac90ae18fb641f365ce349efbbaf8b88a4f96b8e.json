{"sha": "ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWM5MGFlMThmYjY0MWYzNjVjZTM0OWVmYmJhZjhiODhhNGY5NmI4ZQ==", "commit": {"author": {"name": "Douglas Gregor", "email": "doug.gregor@gmail.com", "date": "2008-01-15T20:56:55Z"}, "committer": {"name": "Doug Gregor", "email": "dgregor@gcc.gnu.org", "date": "2008-01-15T20:56:55Z"}, "message": "re PR c++/34399 (ICE on invalid friend declaration of variadic template)\n\n2008-01-15  Douglas Gregor  <doug.gregor@gmail.com>\n\n\tPR c++/34399\n\t* friend.c (do_friend): Don't query TYPE_BEING_DEFINED unless we\n\tknow we have a class type.\n\n2008-01-15  Douglas Gregor  <doug.gregor@gmail.com>\n\n\tPR c++/34399\n\t* g++.dg/cpp0x/vt-34399.C: New.\n\t* g++.dg/template/friend50.C: New.\n\nFrom-SVN: r131552", "tree": {"sha": "19c08d70ffa14c0253e456831aa45704e81af591", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/19c08d70ffa14c0253e456831aa45704e81af591"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/comments", "author": {"login": "DougGregor", "id": 989428, "node_id": "MDQ6VXNlcjk4OTQyOA==", "avatar_url": "https://avatars.githubusercontent.com/u/989428?v=4", "gravatar_id": "", "url": "https://api.github.com/users/DougGregor", "html_url": "https://github.com/DougGregor", "followers_url": "https://api.github.com/users/DougGregor/followers", "following_url": "https://api.github.com/users/DougGregor/following{/other_user}", "gists_url": "https://api.github.com/users/DougGregor/gists{/gist_id}", "starred_url": "https://api.github.com/users/DougGregor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/DougGregor/subscriptions", "organizations_url": "https://api.github.com/users/DougGregor/orgs", "repos_url": "https://api.github.com/users/DougGregor/repos", "events_url": "https://api.github.com/users/DougGregor/events{/privacy}", "received_events_url": "https://api.github.com/users/DougGregor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "44b962f21cf33a2215e596f5d8b78aff9ae94daf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44b962f21cf33a2215e596f5d8b78aff9ae94daf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/44b962f21cf33a2215e596f5d8b78aff9ae94daf"}], "stats": {"total": 33, "additions": 32, "deletions": 1}, "files": [{"sha": "cb78daa5d5537d0eec6e8a2ff75a7851c5ded468", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "patch": "@@ -1,3 +1,9 @@\n+2008-01-15  Douglas Gregor  <doug.gregor@gmail.com>\n+\n+\tPR c++/34399\n+\t* friend.c (do_friend): Don't query TYPE_BEING_DEFINED unless we\n+\tknow we have a class type.\n+\n 2008-01-15  Douglas Gregor  <doug.gregor@gmail.com>\n \n \tPR c++/34751"}, {"sha": "094501b109a3762ea5bb61beaf68a6f47663fd92", "filename": "gcc/cp/friend.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Fcp%2Ffriend.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Fcp%2Ffriend.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ffriend.c?ref=ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "patch": "@@ -468,7 +468,7 @@ do_friend (tree ctype, tree declarator, tree decl,\n \t the process of being defined.  */\n       if (class_template_depth\n \t  || COMPLETE_TYPE_P (ctype)\n-\t  || TYPE_BEING_DEFINED (ctype))\n+\t  || (CLASS_TYPE_P (ctype) && TYPE_BEING_DEFINED (ctype)))\n \t{\n \t  if (DECL_TEMPLATE_INFO (decl))\n \t    /* DECL is a template specialization.  No need to"}, {"sha": "c9d0e6a6923dc8f6f37a02f672e580dff3428b02", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "patch": "@@ -1,3 +1,9 @@\n+2008-01-15  Douglas Gregor  <doug.gregor@gmail.com>\n+\n+\tPR c++/34399\n+\t* g++.dg/cpp0x/vt-34399.C: New.\n+\t* g++.dg/template/friend50.C: New.\n+\n 2008-01-15  Douglas Gregor  <doug.gregor@gmail.com>\n \n \tPR c++/34751"}, {"sha": "542fae586ca8a3336952b8b493d09a0a7524e94c", "filename": "gcc/testsuite/g++.dg/cpp0x/vt-34399.C", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvt-34399.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvt-34399.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvt-34399.C?ref=ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "patch": "@@ -0,0 +1,10 @@\n+// { dg-options \"-std=c++0x\" }\n+template<int...> struct A\n+{\n+  void foo();\n+};\n+\n+struct B\n+{\n+  template<int N> friend void A<N>::A::foo(); // { dg-error \"declared as friend\" }\n+};"}, {"sha": "93c429ab161c0812c7a807ca3cba7d9a40dadaf8", "filename": "gcc/testsuite/g++.dg/template/friend50.C", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend50.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac90ae18fb641f365ce349efbbaf8b88a4f96b8e/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend50.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend50.C?ref=ac90ae18fb641f365ce349efbbaf8b88a4f96b8e", "patch": "@@ -0,0 +1,9 @@\n+// PR c++/34399\n+template<int> struct X\n+{\n+  void foo();\n+};\n+\n+struct Y {\n+  template<long N> friend void X<N>::X::foo(); // { dg-error \"declared as friend\" }\n+};"}]}