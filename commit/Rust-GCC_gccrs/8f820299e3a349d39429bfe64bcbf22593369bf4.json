{"sha": "8f820299e3a349d39429bfe64bcbf22593369bf4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGY4MjAyOTllM2EzNDlkMzk0MjliZmU2NGJjYmYyMjU5MzM2OWJmNA==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@wolery.cumb.org", "date": "2000-09-11T05:44:51Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2000-09-11T05:44:51Z"}, "message": "varasm.c (make_decl_rtl): Restore leading star on DECL_ASSEMBLER_NAME set for decls with an asmspec.\n\n\t* varasm.c (make_decl_rtl): Restore leading star on\n\tDECL_ASSEMBLER_NAME set for decls with an asmspec.\n\t* gcc.dg/asm-names.c: New test.\n\nFrom-SVN: r36309", "tree": {"sha": "140d683aaf2a58cbce1b0d42cae3e952ee21331c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/140d683aaf2a58cbce1b0d42cae3e952ee21331c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8f820299e3a349d39429bfe64bcbf22593369bf4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f820299e3a349d39429bfe64bcbf22593369bf4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8f820299e3a349d39429bfe64bcbf22593369bf4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f820299e3a349d39429bfe64bcbf22593369bf4/comments", "author": null, "committer": null, "parents": [{"sha": "4337bc937caa26789f01e16d3eaa7ddd72c9558a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4337bc937caa26789f01e16d3eaa7ddd72c9558a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4337bc937caa26789f01e16d3eaa7ddd72c9558a"}], "stats": {"total": 42, "additions": 40, "deletions": 2}, "files": [{"sha": "f4164e545c66aff1a782de016ac363d53ee0651b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8f820299e3a349d39429bfe64bcbf22593369bf4", "patch": "@@ -1,3 +1,8 @@\n+2000-09-10  Zack Weinberg  <zack@wolery.cumb.org>\n+\n+\t* varasm.c (make_decl_rtl): Restore leading star on\n+\tDECL_ASSEMBLER_NAME set for decls with an asmspec. \n+\n 2000-09-10  Zack Weinberg  <zack@wolery.cumb.org>\n \n \t* c-pragma.c (handle_pragma_pack): Correct parsing logic so it"}, {"sha": "73b488939caa48523a105af33cd7b53adea8e5c3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8f820299e3a349d39429bfe64bcbf22593369bf4", "patch": "@@ -1,3 +1,7 @@\n+2000-09-10  Zack Weinberg  <zack@wolery.cumb.org>\n+\n+\t* gcc.dg/asm-names.c: New test.\n+\n 2000-09-09  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcc.dg/cpp/tr-warn6.c: New test"}, {"sha": "f02f08f31de9edcc6449e924b1fcbdcfd56228f5", "filename": "gcc/testsuite/gcc.dg/asm-names.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2Ftestsuite%2Fgcc.dg%2Fasm-names.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2Ftestsuite%2Fgcc.dg%2Fasm-names.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fasm-names.c?ref=8f820299e3a349d39429bfe64bcbf22593369bf4", "patch": "@@ -0,0 +1,23 @@\n+/* The name specified by an asm(\"...\") suffix on a declaration is not\n+   to have an underscore prefixed, even if normal symbols are.\n+   Problem reported by Krister Walfridsson <cato@df.lth.se>.  */\n+\n+/* { dg-do link } */\n+/* { dg-options \"-fleading-underscore\" } */\n+\n+extern void frobnicate (void) asm (\"___frob14\");  /* three underscores */\n+\n+void __frob14 (void) {} /* two underscores */\n+\n+int\n+main (void)\n+{\n+  frobnicate ();\n+  return 0;\n+}\n+\n+/* In case built where the runtime expects no leading underscore on\n+   main(). */\n+extern int xmain (void) asm (\"main\");\n+\n+int xmain (void) { return main(); }"}, {"sha": "af76b15560b9c7f46e05790b1f7f42ea140e2331", "filename": "gcc/varasm.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8f820299e3a349d39429bfe64bcbf22593369bf4/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=8f820299e3a349d39429bfe64bcbf22593369bf4", "patch": "@@ -710,8 +710,14 @@ make_decl_rtl (decl, asmspec, top_level)\n \n   reg_number = decode_reg_name (asmspec);\n   if (reg_number == -2)\n-    /* ASMSPEC is given, and not the name of a register.  */\n-    new_name = asmspec;\n+    {\n+      /* ASMSPEC is given, and not the name of a register.  Mark the\n+\t name with a star so assemble_name won't munge it.  */\n+      char *starred = alloca (strlen (asmspec) + 2);\n+      starred[0] = '*';\n+      strcpy (starred + 1, asmspec);\n+      new_name = starred;\n+    }\n \n   if (TREE_CODE (decl) != FUNCTION_DECL && DECL_REGISTER (decl))\n     {"}]}