{"sha": "84083a711ee6b84f42a6d33c45784d660cf4f514", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQwODNhNzExZWU2Yjg0ZjQyYTZkMzNjNDU3ODRkNjYwY2Y0ZjUxNA==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2019-03-13T19:52:23Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2019-03-13T19:52:23Z"}, "message": "re PR fortran/89601 ([PDT] ICE: Segmentation fault (in resolve_component))\n\nfix PR 89601\n\n2019-03-13  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/89601\n\t* decl.c (gfc_match_formal_arglist): Reject empty type parameter lists.\n\t(gfc_match_derived_decl): Mark as PDT only if type parameter list was\n\tmatched successfully.\n\n2019-03-13  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/89601\n\t* gfortran.dg/pdt_16.f03: Modified to avoid follow-up errors.\n\t* gfortran.dg/pdt_30.f90: New test case.\n\nFrom-SVN: r269658", "tree": {"sha": "eb0549546cb336b5c75457cd64c13649bebc9a5a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eb0549546cb336b5c75457cd64c13649bebc9a5a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84083a711ee6b84f42a6d33c45784d660cf4f514", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84083a711ee6b84f42a6d33c45784d660cf4f514", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84083a711ee6b84f42a6d33c45784d660cf4f514", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84083a711ee6b84f42a6d33c45784d660cf4f514/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "cbfa3ec327c44491ec9c141c6476ba1d6df639e9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cbfa3ec327c44491ec9c141c6476ba1d6df639e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cbfa3ec327c44491ec9c141c6476ba1d6df639e9"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "281c29f0a6670ad0b21666eba5d6c6b87af0566a", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=84083a711ee6b84f42a6d33c45784d660cf4f514", "patch": "@@ -1,3 +1,10 @@\n+2019-03-13  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/89601\n+\t* decl.c (gfc_match_formal_arglist): Reject empty type parameter lists.\n+\t(gfc_match_derived_decl): Mark as PDT only if type parameter list was\n+\tmatched successfully.\n+\n 2019-03-13  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/66695"}, {"sha": "749faf9fabefccad11d5b95fe3b1303a56e5bcd9", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 12, "deletions": 2, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=84083a711ee6b84f42a6d33c45784d660cf4f514", "patch": "@@ -6275,7 +6275,16 @@ gfc_match_formal_arglist (gfc_symbol *progname, int st_flag,\n     }\n \n   if (gfc_match_char (')') == MATCH_YES)\n-    goto ok;\n+  {        \n+    if (typeparam)\n+      {\n+\tgfc_error_now (\"A type parameter list is required at %C\");\n+\tm = MATCH_ERROR;\n+\tgoto cleanup;\n+      }\n+    else\n+      goto ok;\n+  }\n \n   for (;;)\n     {\n@@ -10217,13 +10226,14 @@ gfc_match_derived_decl (void)\n       m = gfc_match_formal_arglist (sym, 0, 0, true);\n       if (m != MATCH_YES)\n \tgfc_error_recovery ();\n+      else\n+\tsym->attr.pdt_template = 1;\n       m = gfc_match_eos ();\n       if (m != MATCH_YES)\n \t{\n \t  gfc_error_recovery ();\n \t  gfc_error_now (\"Garbage after PARAMETERIZED TYPE declaration at %C\");\n \t}\n-      sym->attr.pdt_template = 1;\n     }\n \n   if (extended && !sym->components)"}, {"sha": "afb61b42d81f6febe4439796e30e87bc31e41b69", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=84083a711ee6b84f42a6d33c45784d660cf4f514", "patch": "@@ -1,3 +1,9 @@\n+2019-03-13  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/89601\n+\t* gfortran.dg/pdt_16.f03: Modified to avoid follow-up errors.\n+\t* gfortran.dg/pdt_30.f90: New test case.\n+\n 2019-03-13  Marek Polacek  <polacek@redhat.com>\n \n \tPR c++/88979 - further P0634 fix for constructors."}, {"sha": "22c6b83a084297a3e621d73442cff3f9580ad8c6", "filename": "gcc/testsuite/gfortran.dg/pdt_16.f03", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ftestsuite%2Fgfortran.dg%2Fpdt_16.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ftestsuite%2Fgfortran.dg%2Fpdt_16.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpdt_16.f03?ref=84083a711ee6b84f42a6d33c45784d660cf4f514", "patch": "@@ -12,7 +12,6 @@ module m\n program p\n    type t(a                  ! { dg-error \"Expected parameter list\" }\n       integer, kind :: a\n-      real(a) :: x\n    end type\n    type u(a, a)              ! { dg-error \"Duplicate name\" }\n       integer, kind :: a     ! { dg-error \"already declared\" }"}, {"sha": "47f7c7754656448ef4ce88e69c5ea10071f33a3e", "filename": "gcc/testsuite/gfortran.dg/pdt_30.f90", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ftestsuite%2Fgfortran.dg%2Fpdt_30.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84083a711ee6b84f42a6d33c45784d660cf4f514/gcc%2Ftestsuite%2Fgfortran.dg%2Fpdt_30.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpdt_30.f90?ref=84083a711ee6b84f42a6d33c45784d660cf4f514", "patch": "@@ -0,0 +1,17 @@\n+! { dg-do compile }\n+!\n+! PR 89601: [8/9 Regression] [PDT] ICE: Segmentation fault (in resolve_component)\n+!\n+! Contributed by Arseny Solokha <asolokha@gmx.com>\n+\n+program vw\n+  interface\n+     real function ul (ki)\n+       real :: ki\n+     end function ul\n+  end interface\n+  type :: q8 ()  ! { dg-error \"A type parameter list is required\" }\n+     procedure (ul), pointer, nopass :: pj\n+  end type q8\n+  type (q8) :: ki\n+end program vw"}]}