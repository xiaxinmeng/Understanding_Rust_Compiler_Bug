{"sha": "c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzIwZmRiOTE3ZmZmNWYzMjYyZWU4ZTNjZTI3Mzg0NTU3YWU3NGVlMg==", "commit": {"author": {"name": "Janne Blomqvist", "email": "jb@gcc.gnu.org", "date": "2013-11-10T20:34:29Z"}, "committer": {"name": "Janne Blomqvist", "email": "jb@gcc.gnu.org", "date": "2013-11-10T20:34:29Z"}, "message": "Set close-on-exec flag when opening files.\n\n2013-11-10  Janne Blomqvist  <jb@gcc.gnu.org>\n\n\t* configure.ac: Check presence of mkostemp.\n\t* io/unix.c (set_close_on_exec): New function.\n\t(tempfile_open): Use mkostemp and O_CLOEXEC if available, fallback\n\tto calling set_close_on_exec.\n\t(regular_file): Add O_CLOEXEC to flags if defined.\n\t(open_external): Call set_close_on_exec if O_CLOEXEC is not\n\tdefined.\n\t* config.h.in: Regenerated.\n\t* configure: Regenerated.\n\t* Makefile.in: Regenerated.\n\t* aclocal.m4: Regenerated.\n\nFrom-SVN: r204654", "tree": {"sha": "25502b48dbfb346acf48c054900baac6f9b389c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25502b48dbfb346acf48c054900baac6f9b389c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/comments", "author": null, "committer": null, "parents": [{"sha": "8d4483387811bad11f6d7650ac3e73347e88e117", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d4483387811bad11f6d7650ac3e73347e88e117", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d4483387811bad11f6d7650ac3e73347e88e117"}], "stats": {"total": 202, "additions": 142, "deletions": 60}, "files": [{"sha": "2ccaa3dfe4fbb7e4291038dcde12fa4c88d70c4a", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "patch": "@@ -1,3 +1,17 @@\n+2013-11-10  Janne Blomqvist  <jb@gcc.gnu.org>\n+\n+\t* configure.ac: Check presence of mkostemp.\n+\t* io/unix.c (set_close_on_exec): New function.\n+\t(tempfile_open): Use mkostemp and O_CLOEXEC if available, fallback\n+\tto calling set_close_on_exec.\n+\t(regular_file): Add O_CLOEXEC to flags if defined.\n+\t(open_external): Call set_close_on_exec if O_CLOEXEC is not\n+\tdefined.\n+\t* config.h.in: Regenerated.\n+\t* configure: Regenerated.\n+\t* Makefile.in: Regenerated.\n+\t* aclocal.m4: Regenerated.\n+\n 2013-10-01  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/55469"}, {"sha": "62b9f7abffa97e706cab150798e9b2283929ca18", "filename": "libgfortran/Makefile.in", "status": "modified", "additions": 25, "deletions": 18, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FMakefile.in?ref=c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "patch": "@@ -1,9 +1,9 @@\n-# Makefile.in generated by automake 1.11.1 from Makefile.am.\n+# Makefile.in generated by automake 1.11.3 from Makefile.am.\n # @configure_input@\n \n # Copyright (C) 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002,\n-# 2003, 2004, 2005, 2006, 2007, 2008, 2009  Free Software Foundation,\n-# Inc.\n+# 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011 Free Software\n+# Foundation, Inc.\n # This Makefile.in is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n@@ -87,6 +87,12 @@ am__nobase_list = $(am__nobase_strip_setup); \\\n am__base_list = \\\n   sed '$$!N;$$!N;$$!N;$$!N;$$!N;$$!N;$$!N;s/\\n/ /g' | \\\n   sed '$$!N;$$!N;$$!N;$$!N;s/\\n/ /g'\n+am__uninstall_files_from_dir = { \\\n+  test -z \"$$files\" \\\n+    || { test ! -d \"$$dir\" && test ! -f \"$$dir\" && test ! -r \"$$dir\"; } \\\n+    || { echo \" ( cd '$$dir' && rm -f\" $$files \")\"; \\\n+         $(am__cd) \"$$dir\" && rm -f $$files; }; \\\n+  }\n am__installdirs = \"$(DESTDIR)$(cafexeclibdir)\" \\\n \t\"$(DESTDIR)$(myexeclibdir)\" \"$(DESTDIR)$(toolexeclibdir)\" \\\n \t\"$(DESTDIR)$(toolexeclibdir)\"\n@@ -1276,7 +1282,7 @@ all: $(BUILT_SOURCES) config.h\n \n .SUFFIXES:\n .SUFFIXES: .F90 .c .f90 .lo .o .obj\n-am--refresh:\n+am--refresh: Makefile\n \t@:\n $(srcdir)/Makefile.in: @MAINTAINER_MODE_TRUE@ $(srcdir)/Makefile.am  $(am__configure_deps)\n \t@for dep in $?; do \\\n@@ -1312,10 +1318,8 @@ $(ACLOCAL_M4): @MAINTAINER_MODE_TRUE@ $(am__aclocal_m4_deps)\n $(am__aclocal_m4_deps):\n \n config.h: stamp-h1\n-\t@if test ! -f $@; then \\\n-\t  rm -f stamp-h1; \\\n-\t  $(MAKE) $(AM_MAKEFLAGS) stamp-h1; \\\n-\telse :; fi\n+\t@if test ! -f $@; then rm -f stamp-h1; else :; fi\n+\t@if test ! -f $@; then $(MAKE) $(AM_MAKEFLAGS) stamp-h1; else :; fi\n \n stamp-h1: $(srcdir)/config.h.in $(top_builddir)/config.status\n \t@rm -f stamp-h1\n@@ -1422,11 +1426,11 @@ clean-toolexeclibLTLIBRARIES:\n \t  echo \"rm -f \\\"$${dir}/so_locations\\\"\"; \\\n \t  rm -f \"$${dir}/so_locations\"; \\\n \tdone\n-libcaf_single.la: $(libcaf_single_la_OBJECTS) $(libcaf_single_la_DEPENDENCIES) \n+libcaf_single.la: $(libcaf_single_la_OBJECTS) $(libcaf_single_la_DEPENDENCIES) $(EXTRA_libcaf_single_la_DEPENDENCIES) \n \t$(libcaf_single_la_LINK) -rpath $(cafexeclibdir) $(libcaf_single_la_OBJECTS) $(libcaf_single_la_LIBADD) $(LIBS)\n-libgfortran.la: $(libgfortran_la_OBJECTS) $(libgfortran_la_DEPENDENCIES) \n+libgfortran.la: $(libgfortran_la_OBJECTS) $(libgfortran_la_DEPENDENCIES) $(EXTRA_libgfortran_la_DEPENDENCIES) \n \t$(libgfortran_la_LINK) -rpath $(toolexeclibdir) $(libgfortran_la_OBJECTS) $(libgfortran_la_LIBADD) $(LIBS)\n-libgfortranbegin.la: $(libgfortranbegin_la_OBJECTS) $(libgfortranbegin_la_DEPENDENCIES) \n+libgfortranbegin.la: $(libgfortranbegin_la_OBJECTS) $(libgfortranbegin_la_DEPENDENCIES) $(EXTRA_libgfortranbegin_la_DEPENDENCIES) \n \t$(libgfortranbegin_la_LINK) -rpath $(myexeclibdir) $(libgfortranbegin_la_OBJECTS) $(libgfortranbegin_la_LIBADD) $(LIBS)\n \n mostlyclean-compile:\n@@ -5686,9 +5690,7 @@ uninstall-toolexeclibDATA:\n \t@$(NORMAL_UNINSTALL)\n \t@list='$(toolexeclib_DATA)'; test -n \"$(toolexeclibdir)\" || list=; \\\n \tfiles=`for p in $$list; do echo $$p; done | sed -e 's|^.*/||'`; \\\n-\ttest -n \"$$files\" || exit 0; \\\n-\techo \" ( cd '$(DESTDIR)$(toolexeclibdir)' && rm -f\" $$files \")\"; \\\n-\tcd \"$(DESTDIR)$(toolexeclibdir)\" && rm -f $$files\n+\tdir='$(DESTDIR)$(toolexeclibdir)'; $(am__uninstall_files_from_dir)\n \n ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)\n \tlist='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \\\n@@ -5760,10 +5762,15 @@ install-am: all-am\n \n installcheck: installcheck-am\n install-strip:\n-\t$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM=\"$(INSTALL_STRIP_PROGRAM)\" \\\n-\t  install_sh_PROGRAM=\"$(INSTALL_STRIP_PROGRAM)\" INSTALL_STRIP_FLAG=-s \\\n-\t  `test -z '$(STRIP)' || \\\n-\t    echo \"INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'\"` install\n+\tif test -z '$(STRIP)'; then \\\n+\t  $(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM=\"$(INSTALL_STRIP_PROGRAM)\" \\\n+\t    install_sh_PROGRAM=\"$(INSTALL_STRIP_PROGRAM)\" INSTALL_STRIP_FLAG=-s \\\n+\t      install; \\\n+\telse \\\n+\t  $(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM=\"$(INSTALL_STRIP_PROGRAM)\" \\\n+\t    install_sh_PROGRAM=\"$(INSTALL_STRIP_PROGRAM)\" INSTALL_STRIP_FLAG=-s \\\n+\t    \"INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'\" install; \\\n+\tfi\n mostlyclean-generic:\n \n clean-generic:"}, {"sha": "351be9d255ab932d679f68a0270998a6b7c1c0b8", "filename": "libgfortran/aclocal.m4", "status": "modified", "additions": 47, "deletions": 27, "changes": 74, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Faclocal.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Faclocal.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Faclocal.m4?ref=c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "patch": "@@ -1,7 +1,8 @@\n-# generated automatically by aclocal 1.11.1 -*- Autoconf -*-\n+# generated automatically by aclocal 1.11.3 -*- Autoconf -*-\n \n # Copyright (C) 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004,\n-# 2005, 2006, 2007, 2008, 2009  Free Software Foundation, Inc.\n+# 2005, 2006, 2007, 2008, 2009, 2010, 2011 Free Software Foundation,\n+# Inc.\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n@@ -19,12 +20,15 @@ You have another version of autoconf.  It may work, but is not guaranteed to.\n If you have problems, you may need to regenerate the build system entirely.\n To do so, use the procedure documented by the package, typically `autoreconf'.])])\n \n-# Copyright (C) 2002, 2003, 2005, 2006, 2007, 2008  Free Software Foundation, Inc.\n+# Copyright (C) 2002, 2003, 2005, 2006, 2007, 2008, 2011 Free Software\n+# Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n+# serial 1\n+\n # AM_AUTOMAKE_VERSION(VERSION)\n # ----------------------------\n # Automake X.Y traces this macro to ensure aclocal.m4 has been\n@@ -34,7 +38,7 @@ AC_DEFUN([AM_AUTOMAKE_VERSION],\n [am__api_version='1.11'\n dnl Some users find AM_AUTOMAKE_VERSION and mistake it for a way to\n dnl require some minimum version.  Point them to the right macro.\n-m4_if([$1], [1.11.1], [],\n+m4_if([$1], [1.11.3], [],\n       [AC_FATAL([Do not call $0, use AM_INIT_AUTOMAKE([$1]).])])dnl\n ])\n \n@@ -50,19 +54,21 @@ m4_define([_AM_AUTOCONF_VERSION], [])\n # Call AM_AUTOMAKE_VERSION and AM_AUTOMAKE_VERSION so they can be traced.\n # This function is AC_REQUIREd by AM_INIT_AUTOMAKE.\n AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],\n-[AM_AUTOMAKE_VERSION([1.11.1])dnl\n+[AM_AUTOMAKE_VERSION([1.11.3])dnl\n m4_ifndef([AC_AUTOCONF_VERSION],\n   [m4_copy([m4_PACKAGE_VERSION], [AC_AUTOCONF_VERSION])])dnl\n _AM_AUTOCONF_VERSION(m4_defn([AC_AUTOCONF_VERSION]))])\n \n # AM_AUX_DIR_EXPAND                                         -*- Autoconf -*-\n \n-# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.\n+# Copyright (C) 2001, 2003, 2005, 2011 Free Software Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n+# serial 1\n+\n # For projects using AC_CONFIG_AUX_DIR([foo]), Autoconf sets\n # $ac_aux_dir to `$srcdir/foo'.  In other projects, it is set to\n # `$srcdir', `$srcdir/..', or `$srcdir/../..'.\n@@ -144,14 +150,14 @@ AC_CONFIG_COMMANDS_PRE(\n Usually this means the macro was only invoked conditionally.]])\n fi])])\n \n-# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2009\n-# Free Software Foundation, Inc.\n+# Copyright (C) 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2009,\n+# 2010, 2011 Free Software Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n-# serial 10\n+# serial 12\n \n # There are a few dirty hacks below to avoid letting `AC_PROG_CC' be\n # written in clear, in which case automake, when reading aclocal.m4,\n@@ -191,6 +197,7 @@ AC_CACHE_CHECK([dependency style of $depcc],\n   # instance it was reported that on HP-UX the gcc test will end up\n   # making a dummy file named `D' -- because `-MD' means `put the output\n   # in D'.\n+  rm -rf conftest.dir\n   mkdir conftest.dir\n   # Copy depcomp to subdir because otherwise we won't find it if we're\n   # using a relative directory.\n@@ -255,7 +262,7 @@ AC_CACHE_CHECK([dependency style of $depcc],\n \tbreak\n       fi\n       ;;\n-    msvisualcpp | msvcmsys)\n+    msvc7 | msvc7msys | msvisualcpp | msvcmsys)\n       # This compiler won't grok `-c -o', but also, the minuso test has\n       # not run yet.  These depmodes are late enough in the game, and\n       # so weak that their functioning should not be impacted.\n@@ -320,10 +327,13 @@ AC_DEFUN([AM_DEP_TRACK],\n if test \"x$enable_dependency_tracking\" != xno; then\n   am_depcomp=\"$ac_aux_dir/depcomp\"\n   AMDEPBACKSLASH='\\'\n+  am__nodep='_no'\n fi\n AM_CONDITIONAL([AMDEP], [test \"x$enable_dependency_tracking\" != xno])\n AC_SUBST([AMDEPBACKSLASH])dnl\n _AM_SUBST_NOTMAKE([AMDEPBACKSLASH])dnl\n+AC_SUBST([am__nodep])dnl\n+_AM_SUBST_NOTMAKE([am__nodep])dnl\n ])\n \n # Generate code to set up dependency tracking.              -*- Autoconf -*-\n@@ -545,12 +555,15 @@ for _am_header in $config_headers :; do\n done\n echo \"timestamp for $_am_arg\" >`AS_DIRNAME([\"$_am_arg\"])`/stamp-h[]$_am_stamp_count])\n \n-# Copyright (C) 2001, 2003, 2005, 2008  Free Software Foundation, Inc.\n+# Copyright (C) 2001, 2003, 2005, 2008, 2011 Free Software Foundation,\n+# Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n+# serial 1\n+\n # AM_PROG_INSTALL_SH\n # ------------------\n # Define $install_sh.\n@@ -569,8 +582,8 @@ AC_SUBST(install_sh)])\n # Add --enable-maintainer-mode option to configure.         -*- Autoconf -*-\n # From Jim Meyering\n \n-# Copyright (C) 1996, 1998, 2000, 2001, 2002, 2003, 2004, 2005, 2008\n-# Free Software Foundation, Inc.\n+# Copyright (C) 1996, 1998, 2000, 2001, 2002, 2003, 2004, 2005, 2008,\n+# 2011 Free Software Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n@@ -590,7 +603,7 @@ AC_DEFUN([AM_MAINTAINER_MODE],\n        [disable], [m4_define([am_maintainer_other], [enable])],\n        [m4_define([am_maintainer_other], [enable])\n         m4_warn([syntax], [unexpected argument to AM@&t@_MAINTAINER_MODE: $1])])\n-AC_MSG_CHECKING([whether to am_maintainer_other maintainer-specific portions of Makefiles])\n+AC_MSG_CHECKING([whether to enable maintainer-specific portions of Makefiles])\n   dnl maintainer-mode's default is 'disable' unless 'enable' is passed\n   AC_ARG_ENABLE([maintainer-mode],\n [  --][am_maintainer_other][-maintainer-mode  am_maintainer_other make rules and dependencies not useful\n@@ -736,12 +749,15 @@ else\n fi\n ])\n \n-# Copyright (C) 2003, 2004, 2005, 2006  Free Software Foundation, Inc.\n+# Copyright (C) 2003, 2004, 2005, 2006, 2011 Free Software Foundation,\n+# Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n+# serial 1\n+\n # AM_PROG_MKDIR_P\n # ---------------\n # Check for `mkdir -p'.\n@@ -764,27 +780,28 @@ esac\n \n # Helper functions for option handling.                     -*- Autoconf -*-\n \n-# Copyright (C) 2001, 2002, 2003, 2005, 2008  Free Software Foundation, Inc.\n+# Copyright (C) 2001, 2002, 2003, 2005, 2008, 2010 Free Software\n+# Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n-# serial 4\n+# serial 5\n \n # _AM_MANGLE_OPTION(NAME)\n # -----------------------\n AC_DEFUN([_AM_MANGLE_OPTION],\n [[_AM_OPTION_]m4_bpatsubst($1, [[^a-zA-Z0-9_]], [_])])\n \n # _AM_SET_OPTION(NAME)\n-# ------------------------------\n+# --------------------\n # Set option NAME.  Presently that only means defining a flag for this option.\n AC_DEFUN([_AM_SET_OPTION],\n [m4_define(_AM_MANGLE_OPTION([$1]), 1)])\n \n # _AM_SET_OPTIONS(OPTIONS)\n-# ----------------------------------\n+# ------------------------\n # OPTIONS is a space-separated list of Automake options.\n AC_DEFUN([_AM_SET_OPTIONS],\n [m4_foreach_w([_AM_Option], [$1], [_AM_SET_OPTION(_AM_Option)])])\n@@ -860,12 +877,14 @@ Check your system clock])\n fi\n AC_MSG_RESULT(yes)])\n \n-# Copyright (C) 2001, 2003, 2005  Free Software Foundation, Inc.\n+# Copyright (C) 2001, 2003, 2005, 2011 Free Software Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n+# serial 1\n+\n # AM_PROG_INSTALL_STRIP\n # ---------------------\n # One issue with vendor `install' (even GNU) is that you can't\n@@ -888,13 +907,13 @@ fi\n INSTALL_STRIP_PROGRAM=\"\\$(install_sh) -c -s\"\n AC_SUBST([INSTALL_STRIP_PROGRAM])])\n \n-# Copyright (C) 2006, 2008  Free Software Foundation, Inc.\n+# Copyright (C) 2006, 2008, 2010 Free Software Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n # with or without modifications, as long as this notice is preserved.\n \n-# serial 2\n+# serial 3\n \n # _AM_SUBST_NOTMAKE(VARIABLE)\n # ---------------------------\n@@ -903,13 +922,13 @@ AC_SUBST([INSTALL_STRIP_PROGRAM])])\n AC_DEFUN([_AM_SUBST_NOTMAKE])\n \n # AM_SUBST_NOTMAKE(VARIABLE)\n-# ---------------------------\n+# --------------------------\n # Public sister of _AM_SUBST_NOTMAKE.\n AC_DEFUN([AM_SUBST_NOTMAKE], [_AM_SUBST_NOTMAKE($@)])\n \n # Check how to create a tarball.                            -*- Autoconf -*-\n \n-# Copyright (C) 2004, 2005  Free Software Foundation, Inc.\n+# Copyright (C) 2004, 2005, 2012 Free Software Foundation, Inc.\n #\n # This file is free software; the Free Software Foundation\n # gives unlimited permission to copy and/or distribute it,\n@@ -931,10 +950,11 @@ AC_DEFUN([AM_SUBST_NOTMAKE], [_AM_SUBST_NOTMAKE($@)])\n # a tarball read from stdin.\n #     $(am__untar) < result.tar\n AC_DEFUN([_AM_PROG_TAR],\n-[# Always define AMTAR for backward compatibility.\n-AM_MISSING_PROG([AMTAR], [tar])\n+[# Always define AMTAR for backward compatibility.  Yes, it's still used\n+# in the wild :-(  We should find a proper way to deprecate it ...\n+AC_SUBST([AMTAR], ['$${TAR-tar}'])\n m4_if([$1], [v7],\n-     [am__tar='${AMTAR} chof - \"$$tardir\"'; am__untar='${AMTAR} xf -'],\n+     [am__tar='$${TAR-tar} chof - \"$$tardir\"' am__untar='$${TAR-tar} xf -'],\n      [m4_case([$1], [ustar],, [pax],,\n               [m4_fatal([Unknown tar format])])\n AC_MSG_CHECKING([how to create a $1 tar archive])"}, {"sha": "74cf35c1e403533c8571828a0d9ba02004ed19a4", "filename": "libgfortran/config.h.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fconfig.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fconfig.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fconfig.h.in?ref=c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "patch": "@@ -606,6 +606,9 @@\n /* Define if you have __mingw_snprintf. */\n #undef HAVE_MINGW_SNPRINTF\n \n+/* Define to 1 if you have the `mkostemp' function. */\n+#undef HAVE_MKOSTEMP\n+\n /* Define to 1 if you have the `mkstemp' function. */\n #undef HAVE_MKSTEMP\n "}, {"sha": "e7469078075862cff50c3f9d996190fc4c27c366", "filename": "libgfortran/configure", "status": "modified", "additions": 15, "deletions": 8, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fconfigure?ref=c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "patch": "@@ -654,6 +654,7 @@ CPP\n am__fastdepCC_FALSE\n am__fastdepCC_TRUE\n CCDEPMODE\n+am__nodep\n AMDEPBACKSLASH\n AMDEP_FALSE\n AMDEP_TRUE\n@@ -2596,6 +2597,7 @@ as_fn_append ac_func_list \" umask\"\n as_fn_append ac_func_list \" getegid\"\n as_fn_append ac_func_list \" secure_getenv\"\n as_fn_append ac_func_list \" __secure_getenv\"\n+as_fn_append ac_func_list \" mkostemp\"\n as_fn_append ac_header_list \" math.h\"\n # Check that the precious variables saved in the cache have kept the same\n # value.\n@@ -3386,11 +3388,11 @@ MAKEINFO=${MAKEINFO-\"${am_missing_run}makeinfo\"}\n \n # We need awk for the \"check\" target.  The system \"awk\" is bad on\n # some platforms.\n-# Always define AMTAR for backward compatibility.\n+# Always define AMTAR for backward compatibility.  Yes, it's still used\n+# in the wild :-(  We should find a proper way to deprecate it ...\n+AMTAR='$${TAR-tar}'\n \n-AMTAR=${AMTAR-\"${am_missing_run}tar\"}\n-\n-am__tar='${AMTAR} chof - \"$$tardir\"'; am__untar='${AMTAR} xf -'\n+am__tar='$${TAR-tar} chof - \"$$tardir\"' am__untar='$${TAR-tar} xf -'\n \n \n \n@@ -3523,6 +3525,7 @@ fi\n if test \"x$enable_dependency_tracking\" != xno; then\n   am_depcomp=\"$ac_aux_dir/depcomp\"\n   AMDEPBACKSLASH='\\'\n+  am__nodep='_no'\n fi\n  if test \"x$enable_dependency_tracking\" != xno; then\n   AMDEP_TRUE=\n@@ -4340,6 +4343,7 @@ else\n   # instance it was reported that on HP-UX the gcc test will end up\n   # making a dummy file named `D' -- because `-MD' means `put the output\n   # in D'.\n+  rm -rf conftest.dir\n   mkdir conftest.dir\n   # Copy depcomp to subdir because otherwise we won't find it if we're\n   # using a relative directory.\n@@ -4399,7 +4403,7 @@ else\n \tbreak\n       fi\n       ;;\n-    msvisualcpp | msvcmsys)\n+    msvc7 | msvc7msys | msvisualcpp | msvcmsys)\n       # This compiler won't grok `-c -o', but also, the minuso test has\n       # not run yet.  These depmodes are late enough in the game, and\n       # so weak that their functioning should not be impacted.\n@@ -5515,6 +5519,7 @@ else\n   # instance it was reported that on HP-UX the gcc test will end up\n   # making a dummy file named `D' -- because `-MD' means `put the output\n   # in D'.\n+  rm -rf conftest.dir\n   mkdir conftest.dir\n   # Copy depcomp to subdir because otherwise we won't find it if we're\n   # using a relative directory.\n@@ -5574,7 +5579,7 @@ else\n \tbreak\n       fi\n       ;;\n-    msvisualcpp | msvcmsys)\n+    msvc7 | msvc7msys | msvisualcpp | msvcmsys)\n       # This compiler won't grok `-c -o', but also, the minuso test has\n       # not run yet.  These depmodes are late enough in the game, and\n       # so weak that their functioning should not be impacted.\n@@ -12337,7 +12342,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 12340 \"configure\"\n+#line 12345 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -12443,7 +12448,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 12446 \"configure\"\n+#line 12451 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -16586,6 +16591,8 @@ done\n \n \n \n+\n+\n \n \n "}, {"sha": "6417373404f8f5bed57880a2fff0bee49373d5d5", "filename": "libgfortran/configure.ac", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fconfigure.ac?ref=c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "patch": "@@ -280,7 +280,7 @@ else\n    strcasestr getrlimit gettimeofday stat fstat lstat getpwuid vsnprintf dup \\\n    getcwd localtime_r gmtime_r getpwuid_r ttyname_r clock_gettime \\\n    readlink getgid getpid getppid getuid geteuid umask getegid \\\n-   secure_getenv __secure_getenv)\n+   secure_getenv __secure_getenv mkostemp)\n fi\n \n # Check strerror_r, cannot be above as versions with two and three arguments exist"}, {"sha": "8a84ae4eef36ac0d235a71d3350d3524807cfd38", "filename": "libgfortran/io/unix.c", "status": "modified", "additions": 37, "deletions": 6, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fio%2Funix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c20fdb917fff5f3262ee8e3ce27384557ae74ee2/libgfortran%2Fio%2Funix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Funix.c?ref=c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "patch": "@@ -1070,6 +1070,20 @@ unpack_filename (char *cstring, const char *fstring, int len)\n }\n \n \n+/* Set the close-on-exec flag for an existing fd, if the system\n+   supports such.  */\n+\n+static void __attribute__ ((unused))\n+set_close_on_exec (int fd __attribute__ ((unused)))\n+{\n+  /* Mingw does not define F_SETFD.  */\n+#if defined(F_SETFD) && defined(FD_CLOEXEC)\n+  if (fd >= 0)\n+    fcntl(fd, F_SETFD, FD_CLOEXEC);\n+#endif\n+}\n+\n+\n /* Helper function for tempfile(). Tries to open a temporary file in\n    the directory specified by tempdir. If successful, the file name is\n    stored in fname and the descriptor returned. Returns -1 on\n@@ -1109,7 +1123,12 @@ tempfile_open (const char *tempdir, char **fname)\n   mode_mask = umask (S_IXUSR | S_IRWXG | S_IRWXO);\n #endif\n \n+#if defined(HAVE_MKOSTEMP) && defined(O_CLOEXEC)\n+  fd = mkostemp (template, O_RDWR | O_CREAT | O_EXCL | O_CLOEXEC);\n+#else\n   fd = mkstemp (template);\n+  set_close_on_exec (fd);\n+#endif\n \n #ifdef HAVE_UMASK\n   (void) umask (mode_mask);\n@@ -1119,6 +1138,13 @@ tempfile_open (const char *tempdir, char **fname)\n   fd = -1;\n   int count = 0;\n   size_t slashlen = strlen (slash);\n+  int flags = O_RDWR | O_CREAT | O_EXCL;\n+#if defined(HAVE_CRLF) && defined(O_BINARY)\n+  flags |= O_BINARY;\n+#endif\n+#ifdef O_CLOEXEC\n+  flags |= O_CLOEXEC;\n+#endif\n   do\n     {\n       snprintf (template, tempdirlen + 23, \"%s%sgfortrantmpaaaXXXXXX\", \n@@ -1142,14 +1168,12 @@ tempfile_open (const char *tempdir, char **fname)\n \tcontinue;\n       }\n \n-#if defined(HAVE_CRLF) && defined(O_BINARY)\n-      fd = open (template, O_RDWR | O_CREAT | O_EXCL | O_BINARY,\n-\t\t S_IRUSR | S_IWUSR);\n-#else\n-      fd = open (template, O_RDWR | O_CREAT | O_EXCL, S_IRUSR | S_IWUSR);\n-#endif\n+      fd = open (template, flags, S_IRUSR | S_IWUSR);\n     }\n   while (fd == -1 && errno == EEXIST);\n+#ifndef O_CLOEXEC\n+  set_close_on_exec (fd);\n+#endif\n #endif /* HAVE_MKSTEMP */\n \n   *fname = template;\n@@ -1323,6 +1347,10 @@ regular_file (st_parameter_open *opp, unit_flags *flags)\n   crflag |= O_BINARY;\n #endif\n \n+#ifdef O_CLOEXEC\n+  crflag |= O_CLOEXEC;\n+#endif\n+\n   mode = S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH | S_IWOTH;\n   fd = open (path, rwflag | crflag, mode);\n   if (flags->action != ACTION_UNSPECIFIED)\n@@ -1386,6 +1414,9 @@ open_external (st_parameter_open *opp, unit_flags *flags)\n       /* regular_file resets flags->action if it is ACTION_UNSPECIFIED and\n        * if it succeeds */\n       fd = regular_file (opp, flags);\n+#ifndef O_CLOEXEC\n+      set_close_on_exec (fd);\n+#endif\n     }\n \n   if (fd < 0)"}]}