{"sha": "227e9f621bc5717783ef410e3ea7ee95f5227ea0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjI3ZTlmNjIxYmM1NzE3NzgzZWY0MTBlM2VhN2VlOTVmNTIyN2VhMA==", "commit": {"author": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "2006-08-29T15:52:54Z"}, "committer": {"name": "Joern Rennecke", "email": "amylaar@gcc.gnu.org", "date": "2006-08-29T15:52:54Z"}, "message": "re PR tree-optimization/17506 (warning about uninitialized variable points to wrong location)\n\ngcc:\n\n2006-08-29  Nathan Sidwell  <nathan@codesourcery.com>\n\t    J\"orn Rennecke  <joern.rennecke@st.com>\n\n\tPR tree-optimization/17506\n\t* tree-ssa.c (warn_uninit): If warning about a location outside of\n\tthe current function, note where the variable was declared.\n\ntestsuite:\n\n2006-08-29  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n\t    Kazu Hirata  <kazu@codesourcery.com>\n\n\tPR tree-optimization/17506\n\t* gcc.dg/pr17506.c: New.\n\nFrom-SVN: r116564", "tree": {"sha": "7c990387a481812ec429ef6fcf7b9d2e03aebf82", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7c990387a481812ec429ef6fcf7b9d2e03aebf82"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/227e9f621bc5717783ef410e3ea7ee95f5227ea0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/227e9f621bc5717783ef410e3ea7ee95f5227ea0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/227e9f621bc5717783ef410e3ea7ee95f5227ea0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/227e9f621bc5717783ef410e3ea7ee95f5227ea0/comments", "author": null, "committer": null, "parents": [{"sha": "2d9493a481c8a6238f67df5e828a1634862b27ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d9493a481c8a6238f67df5e828a1634862b27ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d9493a481c8a6238f67df5e828a1634862b27ee"}], "stats": {"total": 45, "additions": 44, "deletions": 1}, "files": [{"sha": "faf7f8b008404d202a591d11a81531dff5d61d70", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=227e9f621bc5717783ef410e3ea7ee95f5227ea0", "patch": "@@ -1,3 +1,10 @@\n+2006-08-29  Nathan Sidwell  <nathan@codesourcery.com>\n+\t    J\"orn Rennecke  <joern.rennecke@st.com>\n+\n+\tPR tree-optimization/17506\n+\t* tree-ssa.c (warn_uninit): If warning about a location outside of\n+\tthe current function, note where the variable was declared.\n+\n 2006-08-28  Zdenek Dvorak <dvorakz@suse.cz>\n \n \tPR tree-optimization/28411"}, {"sha": "5c2b9f4c518074b47c11f96a56fc53a8ece8a80d", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=227e9f621bc5717783ef410e3ea7ee95f5227ea0", "patch": "@@ -1,3 +1,9 @@\n+2006-08-29  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n+\t    Kazu Hirata  <kazu@codesourcery.com>\n+\n+\tPR tree-optimization/17506\n+\t* gcc.dg/pr17506.c: New.\n+\n 2006-08-29  J\"orn Rennecke  <joern.rennecke@st.com>\n \n \tPR c++/28139"}, {"sha": "44fb90cc770ae8fcc5f04af4b0989303964e8f08", "filename": "gcc/testsuite/gcc.dg/pr17506.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2Ftestsuite%2Fgcc.dg%2Fpr17506.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2Ftestsuite%2Fgcc.dg%2Fpr17506.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr17506.c?ref=227e9f621bc5717783ef410e3ea7ee95f5227ea0", "patch": "@@ -0,0 +1,24 @@\n+/* PR tree-optimization/17506\n+   We issue an uninitialized variable warning at a wrong location at\n+   line 11, which is very confusing.  Make sure we print out a note to\n+   make it less confusing.  */\n+/* { dg-do compile } */\n+/* { dg-options \"-O1 -Wuninitialized\" } */\n+\n+inline int\n+foo (int i)\n+{\n+  if (i) /* { dg-warning \"used uninitialized in this function\" } */\n+    return 1;\n+  return 0;\n+}\n+\n+void baz (void);\n+\n+void\n+bar (void)\n+{\n+  int j; /* { dg-error \"note: 'j' was declared here\" } */\n+  for (; foo (j); ++j)\n+    baz ();\n+}"}, {"sha": "f922e8254445db516f273e761c644713f1975b66", "filename": "gcc/tree-ssa.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2Ftree-ssa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/227e9f621bc5717783ef410e3ea7ee95f5227ea0/gcc%2Ftree-ssa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa.c?ref=227e9f621bc5717783ef410e3ea7ee95f5227ea0", "patch": "@@ -1154,7 +1154,7 @@ warn_uninit (tree t, const char *gmsgid, void *data)\n   tree var = SSA_NAME_VAR (t);\n   tree def = SSA_NAME_DEF_STMT (t);\n   tree context = (tree) data;\n-  location_t * locus;\n+  location_t *locus, *fun_locus;\n \n   /* Default uses (indicated by an empty definition statement),\n      are uninitialized.  */\n@@ -1178,6 +1178,12 @@ warn_uninit (tree t, const char *gmsgid, void *data)\n \t   ? EXPR_LOCUS (context)\n \t   : &DECL_SOURCE_LOCATION (var));\n   warning (0, gmsgid, locus, var);\n+  fun_locus = &DECL_SOURCE_LOCATION (cfun->decl);\n+  if (locus->file != fun_locus->file\n+      || locus->line < fun_locus->line\n+      || locus->line > cfun->function_end_locus.line)\n+    inform (\"%J%qD was declared here\", var, var);\n+\n   TREE_NO_WARNING (var) = 1;\n }\n    "}]}