{"sha": "5d3983bca523f337333cf6f749d6489014264572", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWQzOTgzYmNhNTIzZjMzNzMzM2NmNmY3NDlkNjQ4OTAxNDI2NDU3Mg==", "commit": {"author": {"name": "Bob Duff", "email": "duff@adacore.com", "date": "2019-12-12T10:02:27Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-12-12T10:02:27Z"}, "message": "[Ada] Crash on Descriptor_Size attribute\n\n2019-12-12  Bob Duff  <duff@adacore.com>\n\ngcc/ada/\n\n\t* sem_attr.adb (Eval_Attribute): Never mark T'Descriptor_Size as\n\tstatic, even if T is a static subtype, because otherwise we will\n\trequest the value of the attribute, which will crash because we\n\thave not evaluated it.\n\nFrom-SVN: r279287", "tree": {"sha": "a09ae129b6d08211ec36b6e7fd8821bccfe9c6b6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a09ae129b6d08211ec36b6e7fd8821bccfe9c6b6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5d3983bca523f337333cf6f749d6489014264572", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d3983bca523f337333cf6f749d6489014264572", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d3983bca523f337333cf6f749d6489014264572", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d3983bca523f337333cf6f749d6489014264572/comments", "author": {"login": "bobduff", "id": 29099567, "node_id": "MDQ6VXNlcjI5MDk5NTY3", "avatar_url": "https://avatars.githubusercontent.com/u/29099567?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bobduff", "html_url": "https://github.com/bobduff", "followers_url": "https://api.github.com/users/bobduff/followers", "following_url": "https://api.github.com/users/bobduff/following{/other_user}", "gists_url": "https://api.github.com/users/bobduff/gists{/gist_id}", "starred_url": "https://api.github.com/users/bobduff/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bobduff/subscriptions", "organizations_url": "https://api.github.com/users/bobduff/orgs", "repos_url": "https://api.github.com/users/bobduff/repos", "events_url": "https://api.github.com/users/bobduff/events{/privacy}", "received_events_url": "https://api.github.com/users/bobduff/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c2f3e1a3e369fe549fa76e9821d2e17bc3d55dc7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2f3e1a3e369fe549fa76e9821d2e17bc3d55dc7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2f3e1a3e369fe549fa76e9821d2e17bc3d55dc7"}], "stats": {"total": 10, "additions": 10, "deletions": 0}, "files": [{"sha": "4ad9092bd3a9be879e0a0b8407094bf86bf71ba0", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d3983bca523f337333cf6f749d6489014264572/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d3983bca523f337333cf6f749d6489014264572/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=5d3983bca523f337333cf6f749d6489014264572", "patch": "@@ -1,3 +1,10 @@\n+2019-12-12  Bob Duff  <duff@adacore.com>\n+\n+\t* sem_attr.adb (Eval_Attribute): Never mark T'Descriptor_Size as\n+\tstatic, even if T is a static subtype, because otherwise we will\n+\trequest the value of the attribute, which will crash because we\n+\thave not evaluated it.\n+\n 2019-12-12  Ed Schonberg  <schonberg@adacore.com>\n \n \t* exp_ch5.adb (Expand_N_Assognment_Statement): Extend the"}, {"sha": "0cd8e083899985807e71badf5ab1d248254ec27b", "filename": "gcc/ada/sem_attr.adb", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5d3983bca523f337333cf6f749d6489014264572/gcc%2Fada%2Fsem_attr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5d3983bca523f337333cf6f749d6489014264572/gcc%2Fada%2Fsem_attr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_attr.adb?ref=5d3983bca523f337333cf6f749d6489014264572", "patch": "@@ -7852,6 +7852,8 @@ package body Sem_Attr is\n \n       --  is legal, since here this expression appears in a statically\n       --  unevaluated position, so it does not actually raise an exception.\n+      --\n+      --  T'Descriptor_Size is never static, even if T is static.\n \n       if Is_Scalar_Type (P_Entity)\n         and then (not Is_Generic_Type (P_Entity))\n@@ -7865,6 +7867,7 @@ package body Sem_Attr is\n           (No (E2)\n             or else (Is_Static_Expression (E2)\n                       and then Is_Scalar_Type (Etype (E1))))\n+        and then Id /= Attribute_Descriptor_Size\n       then\n          Static := True;\n          Set_Is_Static_Expression (N, True);"}]}