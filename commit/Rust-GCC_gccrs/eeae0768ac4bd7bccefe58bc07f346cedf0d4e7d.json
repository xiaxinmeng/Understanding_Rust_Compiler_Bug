{"sha": "eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWVhZTA3NjhhYzRiZDdiY2NlZmU1OGJjMDdmMzQ2Y2VkZjBkNGU3ZA==", "commit": {"author": {"name": "Roger Sayle", "email": "roger@eyesopen.com", "date": "2004-12-12T22:33:00Z"}, "committer": {"name": "Roger Sayle", "email": "sayle@gcc.gnu.org", "date": "2004-12-12T22:33:00Z"}, "message": "re PR middle-end/12454 (large number of if ();else if cause)\n\n\n\tPR middle-end/12454\n\t* cp-gimplify.c (gimplify_if_stmt): Optimize the case where the\n\tcondition is a constant and the unexecuted clause is empty.\n\nFrom-SVN: r92067", "tree": {"sha": "294ffedba611547c46c5786e5e3325797cbf6763", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/294ffedba611547c46c5786e5e3325797cbf6763"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d/comments", "author": null, "committer": null, "parents": [{"sha": "d9f235fcf81e7dc146af573e603e6a2b5959c4a2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9f235fcf81e7dc146af573e603e6a2b5959c4a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9f235fcf81e7dc146af573e603e6a2b5959c4a2"}], "stats": {"total": 16, "additions": 14, "deletions": 2}, "files": [{"sha": "55b467c7db07e37f03a31e8f74a1b34883be6f5d", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d", "patch": "@@ -1,3 +1,9 @@\n+2004-12-12  Roger Sayle  <roger@eyesopen.com>\n+\n+\tPR middle-end/12454\n+\t* cp-gimplify.c (gimplify_if_stmt): Optimize the case where the\n+\tcondition is a constant and the unexecuted clause is empty.\n+\n 2004-12-10  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \tPR c++/18731"}, {"sha": "4f38739f1c10faf69b6df537ee81a433944361bc", "filename": "gcc/cp/cp-gimplify.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d/gcc%2Fcp%2Fcp-gimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d/gcc%2Fcp%2Fcp-gimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-gimplify.c?ref=eeae0768ac4bd7bccefe58bc07f346cedf0d4e7d", "patch": "@@ -85,9 +85,10 @@ genericize_eh_spec_block (tree *stmt_p)\n static void\n gimplify_if_stmt (tree *stmt_p)\n {\n-  tree stmt, then_, else_;\n+  tree stmt, cond, then_, else_;\n \n   stmt = *stmt_p;\n+  cond = IF_COND (stmt);\n   then_ = THEN_CLAUSE (stmt);\n   else_ = ELSE_CLAUSE (stmt);\n \n@@ -96,7 +97,12 @@ gimplify_if_stmt (tree *stmt_p)\n   if (!else_)\n     else_ = build_empty_stmt ();\n \n-  stmt = build3 (COND_EXPR, void_type_node, IF_COND (stmt), then_, else_);\n+  if (integer_nonzerop (cond) && !TREE_SIDE_EFFECTS (else_))\n+    stmt = then_;\n+  else if (integer_zerop (cond) && !TREE_SIDE_EFFECTS (then_))\n+    stmt = else_;\n+  else\n+    stmt = build3 (COND_EXPR, void_type_node, cond, then_, else_);\n   *stmt_p = stmt;\n }\n "}]}