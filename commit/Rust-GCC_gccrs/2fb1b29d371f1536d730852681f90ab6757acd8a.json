{"sha": "2fb1b29d371f1536d730852681f90ab6757acd8a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmZiMWIyOWQzNzFmMTUzNmQ3MzA4NTI2ODFmOTBhYjY3NTdhY2Q4YQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2019-05-24T13:00:26Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2019-05-24T13:00:26Z"}, "message": "Fix broken shared_ptr test\n\n\t* testsuite/20_util/shared_ptr/cons/alias-rval.cc: Fix test.\n\t* testsuite/20_util/shared_ptr/cons/alias.cc: Remove unused function.\n\nFrom-SVN: r271603", "tree": {"sha": "94a47c276f69450a823c5ac15a657898ce1fd92f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/94a47c276f69450a823c5ac15a657898ce1fd92f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2fb1b29d371f1536d730852681f90ab6757acd8a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2fb1b29d371f1536d730852681f90ab6757acd8a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2fb1b29d371f1536d730852681f90ab6757acd8a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2fb1b29d371f1536d730852681f90ab6757acd8a/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "245254b8bb4a4933a9e10439bd31debd48843b54", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/245254b8bb4a4933a9e10439bd31debd48843b54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/245254b8bb4a4933a9e10439bd31debd48843b54"}], "stats": {"total": 27, "additions": 16, "deletions": 11}, "files": [{"sha": "0a83bd3252ca35cd6290212bde238d984d377505", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2fb1b29d371f1536d730852681f90ab6757acd8a/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2fb1b29d371f1536d730852681f90ab6757acd8a/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=2fb1b29d371f1536d730852681f90ab6757acd8a", "patch": "@@ -1,3 +1,8 @@\n+2019-05-24  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\t* testsuite/20_util/shared_ptr/cons/alias-rval.cc: Fix test.\n+\t* testsuite/20_util/shared_ptr/cons/alias.cc: Remove unused function.\n+\n 2019-05-23  Jonathan Wakely  <jwakely@redhat.com>\n \n \t* testsuite/20_util/function_objects/invoke/1.cc: Move C++17-specific"}, {"sha": "f0b0d9cf9ffd3a88ebf16b826ae2ca79161389c7", "filename": "libstdc++-v3/testsuite/20_util/shared_ptr/cons/alias-rval.cc", "status": "modified", "additions": 11, "deletions": 9, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2fb1b29d371f1536d730852681f90ab6757acd8a/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fshared_ptr%2Fcons%2Falias-rval.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2fb1b29d371f1536d730852681f90ab6757acd8a/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fshared_ptr%2Fcons%2Falias-rval.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fshared_ptr%2Fcons%2Falias-rval.cc?ref=2fb1b29d371f1536d730852681f90ab6757acd8a", "patch": "@@ -37,8 +37,6 @@ struct B : A\n   A a;\n };\n \n-void deletefunc(A* p) { delete p; }\n-\n // 20.6.6.2.1 shared_ptr constructors [util.smartptr.shared.const]\n \n // Aliasing constructors\n@@ -63,29 +61,33 @@ test01()\n void\n test02()\n {\n-  std::shared_ptr<A> a(new A);\n+  A* ptr = new A;\n+  ptr->i = 100;\n+  std::shared_ptr<A> a(ptr);\n   std::shared_ptr<int> i1(std::move(a), &a->i);\n   VERIFY( i1.use_count() == 1 );\n-  VERIFY( i1 != nullptr );\n+  VERIFY( *i1 == 100 );\n   VERIFY( a.use_count() == 0 );\n   VERIFY( a == nullptr );\n \n   std::shared_ptr<int> i2(i1);\n   VERIFY( i2.use_count() == 2 );\n-  VERIFY( i2.get() == &a->i );\n+  VERIFY( i2.get() == &ptr->i );\n }\n \n void\n test03()\n {\n   std::shared_ptr<B> b1(new B);\n+  b1->i = 100;\n+  b1->a.i = 200;\n   std::shared_ptr<B> b2(b1);\n   std::shared_ptr<A> a1(std::move(b1), b1.get());\n-  std::shared_ptr<A> a2(b2, &b2->a);\n+  std::shared_ptr<A> a2(std::move(b2), &b2->a);\n+  VERIFY( a1.use_count() == 2 );\n   VERIFY( a2.use_count() == 2 );\n-  VERIFY( a1 != nullptr );\n-  VERIFY( a2 != nullptr );\n-  VERIFY( a1 != a2 );\n+  VERIFY( a1->i == 100 );\n+  VERIFY( a2->i == 200 );\n   VERIFY( b1.use_count() == 0 );\n   VERIFY( b2.use_count() == 0 );\n   VERIFY( b1 == nullptr );"}, {"sha": "8dbb7af638c75fe082593bd80933bfb076c0a151", "filename": "libstdc++-v3/testsuite/20_util/shared_ptr/cons/alias.cc", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2fb1b29d371f1536d730852681f90ab6757acd8a/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fshared_ptr%2Fcons%2Falias.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2fb1b29d371f1536d730852681f90ab6757acd8a/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fshared_ptr%2Fcons%2Falias.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F20_util%2Fshared_ptr%2Fcons%2Falias.cc?ref=2fb1b29d371f1536d730852681f90ab6757acd8a", "patch": "@@ -36,8 +36,6 @@ struct B : A\n   A a;\n };\n \n-void deletefunc(A* p) { delete p; }\n-\n // 20.6.6.2.1 shared_ptr constructors [util.smartptr.shared.const]\n \n // Aliasing constructors"}]}