{"sha": "51020892466d37f71ee13137bdadcbb32545c55d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTEwMjA4OTI0NjZkMzdmNzFlZTEzMTM3YmRhZGNiYjMyNTQ1YzU1ZA==", "commit": {"author": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2017-01-11T10:35:31Z"}, "committer": {"name": "Martin Jambor", "email": "jamborm@gcc.gnu.org", "date": "2017-01-11T10:35:31Z"}, "message": "[hsa] Fix hsa function cloning test\n\n2017-01-11  Martin Jambor  <mjambor@suse.cz>\n\n\t* hsa.c (hsa_callable_function_p): Revert addition of DECL_ARTIFICIAL\n\ttest.\n\t* ipa-hsa.c (process_hsa_functions): Only duplicate non-artificial\n\tdecorated functions.\n\nFrom-SVN: r244308", "tree": {"sha": "f2d05c5ca8dd4a860cc74dd72658a92146d66d22", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f2d05c5ca8dd4a860cc74dd72658a92146d66d22"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/51020892466d37f71ee13137bdadcbb32545c55d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51020892466d37f71ee13137bdadcbb32545c55d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51020892466d37f71ee13137bdadcbb32545c55d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51020892466d37f71ee13137bdadcbb32545c55d/comments", "author": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "80c74722bc934e376b06fa2e59925cb134202266", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80c74722bc934e376b06fa2e59925cb134202266", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80c74722bc934e376b06fa2e59925cb134202266"}], "stats": {"total": 17, "additions": 12, "deletions": 5}, "files": [{"sha": "3c8f977e317d95da3f1a15bea3f1747e7c8c0b82", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51020892466d37f71ee13137bdadcbb32545c55d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51020892466d37f71ee13137bdadcbb32545c55d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=51020892466d37f71ee13137bdadcbb32545c55d", "patch": "@@ -1,3 +1,10 @@\n+2017-01-11  Martin Jambor  <mjambor@suse.cz>\n+\n+\t* hsa.c (hsa_callable_function_p): Revert addition of DECL_ARTIFICIAL\n+\ttest.\n+\t* ipa-hsa.c (process_hsa_functions): Only duplicate non-artificial\n+\tdecorated functions.\n+\n 2017-01-11  Richard Biener  <rguenther@suse.de>\n \n \t* tree-vrp.c (evrp_dom_walker::before_dom_children): Also"}, {"sha": "2035ce446a15f14bd9fa0ddb9b29bebb1032957b", "filename": "gcc/hsa.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51020892466d37f71ee13137bdadcbb32545c55d/gcc%2Fhsa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51020892466d37f71ee13137bdadcbb32545c55d/gcc%2Fhsa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fhsa.c?ref=51020892466d37f71ee13137bdadcbb32545c55d", "patch": "@@ -90,10 +90,7 @@ bool\n hsa_callable_function_p (tree fndecl)\n {\n   return (lookup_attribute (\"omp declare target\", DECL_ATTRIBUTES (fndecl))\n-\t  && !lookup_attribute (\"oacc function\", DECL_ATTRIBUTES (fndecl))\n-\t  /* At this point, this is enough to identify clones for\n-\t     parallel, which for HSA would need to be kernels anyway.  */\n-\t  && !DECL_ARTIFICIAL (fndecl));\n+\t  && !lookup_attribute (\"oacc function\", DECL_ATTRIBUTES (fndecl)));\n }\n \n /* Allocate HSA structures that are are used when dealing with different"}, {"sha": "6a3f660672e7d234962d6f21dae8897836c335c6", "filename": "gcc/ipa-hsa.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51020892466d37f71ee13137bdadcbb32545c55d/gcc%2Fipa-hsa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51020892466d37f71ee13137bdadcbb32545c55d/gcc%2Fipa-hsa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-hsa.c?ref=51020892466d37f71ee13137bdadcbb32545c55d", "patch": "@@ -100,7 +100,10 @@ process_hsa_functions (void)\n \t\t     clone->name (),\n \t\t     s->m_kind == HSA_KERNEL ? \"kernel\" : \"function\");\n \t}\n-      else if (hsa_callable_function_p (node->decl))\n+      else if (hsa_callable_function_p (node->decl)\n+\t       /* At this point, this is enough to identify clones for\n+\t\t  parallel, which for HSA would need to be kernels anyway.  */\n+\t       && !DECL_ARTIFICIAL (node->decl))\n \t{\n \t  if (!check_warn_node_versionable (node))\n \t    continue;"}]}