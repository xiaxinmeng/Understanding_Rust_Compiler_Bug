{"sha": "005537dfed601a7ec39b4d40f9d0e3bc954f167f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDA1NTM3ZGZlZDYwMWE3ZWMzOWI0ZDQwZjlkMGUzYmM5NTRmMTY3Zg==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "1999-10-13T17:09:18Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "1999-10-13T17:09:18Z"}, "message": "Simplified GC interface and other goodies.\n\nFrom-SVN: r29946", "tree": {"sha": "618d754ad605b42a6cdca53980a97a361d152aa9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/618d754ad605b42a6cdca53980a97a361d152aa9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/005537dfed601a7ec39b4d40f9d0e3bc954f167f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/005537dfed601a7ec39b4d40f9d0e3bc954f167f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/005537dfed601a7ec39b4d40f9d0e3bc954f167f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/005537dfed601a7ec39b4d40f9d0e3bc954f167f/comments", "author": null, "committer": null, "parents": [{"sha": "1f1479dc91216e63870c59ad48fdbb0b1c060d82", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f1479dc91216e63870c59ad48fdbb0b1c060d82", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1f1479dc91216e63870c59ad48fdbb0b1c060d82"}], "stats": {"total": 1700, "additions": 706, "deletions": 994}, "files": [{"sha": "7b6b91867e1fb573bfbf19eac1f068f8e7868080", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -1750,7 +1750,7 @@ s-output : $(md_file) genoutput $(srcdir)/move-if-change\n \t$(SHELL) $(srcdir)/move-if-change tmp-output.c insn-output.c\n \ttouch s-output\n \n-genrtl.o : genrtl.c $(CONFIG_H) $(RTL_H) system.h\n+genrtl.o : genrtl.c $(CONFIG_H) $(RTL_H) system.h ggc.h\n genrtl.c genrtl.h : s-genrtl\n \t@true\t# force gnu make to recheck modification times.\n "}, {"sha": "aec704a5c5cc228664d367064ef868eedcccdb28", "filename": "gcc/config.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -324,6 +324,9 @@\n /* Define if you have the sysconf function.  */\n #undef HAVE_SYSCONF\n \n+/* Define if you have the valloc function.  */\n+#undef HAVE_VALLOC\n+\n /* Define if you have the <argz.h> header file.  */\n #undef HAVE_ARGZ_H\n "}, {"sha": "82e392253ae29ace93ce61c2500679589ac77d70", "filename": "gcc/configure", "status": "modified", "additions": 228, "deletions": 215, "changes": 443, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -1,4 +1,4 @@\n-#! /bin/sh \n+#! /bin/sh\n \n # Guess values for system-dependent variables and create Makefiles.\n # Generated automatically using autoconf version 2.13 \n@@ -91,6 +91,7 @@ program_suffix=NONE\n program_transform_name=s,x,x,\n silent=\n site=\n+sitefile=\n srcdir=\n target=NONE\n verbose=\n@@ -205,6 +206,7 @@ Configuration:\n   --help                  print this message\n   --no-create             do not create output files\n   --quiet, --silent       do not print \\`checking...' messages\n+  --site-file=FILE        use FILE as the site file\n   --version               print the version of autoconf that created configure\n Directory and file names:\n   --prefix=PREFIX         install architecture-independent files in PREFIX\n@@ -375,6 +377,11 @@ EOF\n   -site=* | --site=* | --sit=*)\n     site=\"$ac_optarg\" ;;\n \n+  -site-file | --site-file | --site-fil | --site-fi | --site-f)\n+    ac_prev=sitefile ;;\n+  -site-file=* | --site-file=* | --site-fil=* | --site-fi=* | --site-f=*)\n+    sitefile=\"$ac_optarg\" ;;\n+\n   -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)\n     ac_prev=srcdir ;;\n   -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)\n@@ -540,12 +547,16 @@ fi\n srcdir=`echo \"${srcdir}\" | sed 's%\\([^/]\\)/*$%\\1%'`\n \n # Prefer explicitly selected file to automatically selected ones.\n-if test -z \"$CONFIG_SITE\"; then\n-  if test \"x$prefix\" != xNONE; then\n-    CONFIG_SITE=\"$prefix/share/config.site $prefix/etc/config.site\"\n-  else\n-    CONFIG_SITE=\"$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site\"\n+if test -z \"$sitefile\"; then\n+  if test -z \"$CONFIG_SITE\"; then\n+    if test \"x$prefix\" != xNONE; then\n+      CONFIG_SITE=\"$prefix/share/config.site $prefix/etc/config.site\"\n+    else\n+      CONFIG_SITE=\"$ac_default_prefix/share/config.site $ac_default_prefix/etc/config.site\"\n+    fi\n   fi\n+else\n+  CONFIG_SITE=\"$sitefile\"\n fi\n for ac_site_file in $CONFIG_SITE; do\n   if test -r \"$ac_site_file\"; then\n@@ -600,7 +611,7 @@ copy=cp\n # - two terminals occur directly after each other\n # - the path contains an element with a dot in it\n echo $ac_n \"checking LIBRARY_PATH variable\"\"... $ac_c\" 1>&6\n-echo \"configure:604: checking LIBRARY_PATH variable\" >&5\n+echo \"configure:615: checking LIBRARY_PATH variable\" >&5\n case ${LIBRARY_PATH} in\n   [:\\;]* | *[:\\;] | *[:\\;][:\\;]* |  *[:\\;]. | .[:\\;]*| . | *[:\\;].[:\\;]* )\n     library_path_setting=\"contains current directory\"\n@@ -625,7 +636,7 @@ fi\n # - two terminals occur directly after each other\n # - the path contains an element with a dot in it\n echo $ac_n \"checking GCC_EXEC_PREFIX variable\"\"... $ac_c\" 1>&6\n-echo \"configure:629: checking GCC_EXEC_PREFIX variable\" >&5\n+echo \"configure:640: checking GCC_EXEC_PREFIX variable\" >&5\n case ${GCC_EXEC_PREFIX} in\n   [:\\;]* | *[:\\;] | *[:\\;][:\\;]* |  *[:\\;]. | .[:\\;]*| . | *[:\\;].[:\\;]* )\n     gcc_exec_prefix_setting=\"contains current directory\"\n@@ -948,7 +959,7 @@ else { echo \"configure: error: can not run $ac_config_sub\" 1>&2; exit 1; }\n fi\n \n echo $ac_n \"checking host system type\"\"... $ac_c\" 1>&6\n-echo \"configure:952: checking host system type\" >&5\n+echo \"configure:963: checking host system type\" >&5\n \n host_alias=$host\n case \"$host_alias\" in\n@@ -969,7 +980,7 @@ host_os=`echo $host | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n echo \"$ac_t\"\"$host\" 1>&6\n \n echo $ac_n \"checking target system type\"\"... $ac_c\" 1>&6\n-echo \"configure:973: checking target system type\" >&5\n+echo \"configure:984: checking target system type\" >&5\n \n target_alias=$target\n case \"$target_alias\" in\n@@ -987,7 +998,7 @@ target_os=`echo $target | sed 's/^\\([^-]*\\)-\\([^-]*\\)-\\(.*\\)$/\\3/'`\n echo \"$ac_t\"\"$target\" 1>&6\n \n echo $ac_n \"checking build system type\"\"... $ac_c\" 1>&6\n-echo \"configure:991: checking build system type\" >&5\n+echo \"configure:1002: checking build system type\" >&5\n \n build_alias=$build\n case \"$build_alias\" in\n@@ -1014,7 +1025,7 @@ test \"$host_alias\" != \"$target_alias\" &&\n # Extract the first word of \"gcc\", so it can be a program name with args.\n set dummy gcc; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1018: checking for $ac_word\" >&5\n+echo \"configure:1029: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1044,7 +1055,7 @@ if test -z \"$CC\"; then\n   # Extract the first word of \"cc\", so it can be a program name with args.\n set dummy cc; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1048: checking for $ac_word\" >&5\n+echo \"configure:1059: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1095,7 +1106,7 @@ fi\n       # Extract the first word of \"cl\", so it can be a program name with args.\n set dummy cl; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1099: checking for $ac_word\" >&5\n+echo \"configure:1110: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_CC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1127,7 +1138,7 @@ fi\n fi\n \n echo $ac_n \"checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works\"\"... $ac_c\" 1>&6\n-echo \"configure:1131: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works\" >&5\n+echo \"configure:1142: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works\" >&5\n \n ac_ext=c\n # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.\n@@ -1138,12 +1149,12 @@ cross_compiling=$ac_cv_prog_cc_cross\n \n cat > conftest.$ac_ext << EOF\n \n-#line 1142 \"configure\"\n+#line 1153 \"configure\"\n #include \"confdefs.h\"\n \n main(){return(0);}\n EOF\n-if { (eval echo configure:1147: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:1158: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   ac_cv_prog_cc_works=yes\n   # If we can't run a trivial program, we are probably using a cross compiler.\n   if (./conftest; exit) 2>/dev/null; then\n@@ -1169,12 +1180,12 @@ if test $ac_cv_prog_cc_works = no; then\n   { echo \"configure: error: installation or configuration problem: C compiler cannot create executables.\" 1>&2; exit 1; }\n fi\n echo $ac_n \"checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler\"\"... $ac_c\" 1>&6\n-echo \"configure:1173: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler\" >&5\n+echo \"configure:1184: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler\" >&5\n echo \"$ac_t\"\"$ac_cv_prog_cc_cross\" 1>&6\n cross_compiling=$ac_cv_prog_cc_cross\n \n echo $ac_n \"checking whether we are using GNU C\"\"... $ac_c\" 1>&6\n-echo \"configure:1178: checking whether we are using GNU C\" >&5\n+echo \"configure:1189: checking whether we are using GNU C\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_gcc'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1183,7 +1194,7 @@ else\n   yes;\n #endif\n EOF\n-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1187: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1198: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then\n   ac_cv_prog_gcc=yes\n else\n   ac_cv_prog_gcc=no\n@@ -1202,7 +1213,7 @@ ac_test_CFLAGS=\"${CFLAGS+set}\"\n ac_save_CFLAGS=\"$CFLAGS\"\n CFLAGS=\n echo $ac_n \"checking whether ${CC-cc} accepts -g\"\"... $ac_c\" 1>&6\n-echo \"configure:1206: checking whether ${CC-cc} accepts -g\" >&5\n+echo \"configure:1217: checking whether ${CC-cc} accepts -g\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_cc_g'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1234,15 +1245,15 @@ else\n fi\n \n echo $ac_n \"checking for long double\"\"... $ac_c\" 1>&6\n-echo \"configure:1238: checking for long double\" >&5\n+echo \"configure:1249: checking for long double\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_c_long_double'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$GCC\" = yes; then\n   gcc_cv_c_long_double=yes\n else\n cat > conftest.$ac_ext <<EOF\n-#line 1246 \"configure\"\n+#line 1257 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n@@ -1252,7 +1263,7 @@ long double foo = 0.0;\n switch (0) case 0: case (sizeof(long double) >= sizeof(double)):;\n ; return 0; }\n EOF\n-if { (eval echo configure:1256: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:1267: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   gcc_cv_c_long_double=yes\n else\n@@ -1285,7 +1296,7 @@ fi\n \n \n echo $ac_n \"checking whether ${MAKE-make} sets \\${MAKE}\"\"... $ac_c\" 1>&6\n-echo \"configure:1289: checking whether ${MAKE-make} sets \\${MAKE}\" >&5\n+echo \"configure:1300: checking whether ${MAKE-make} sets \\${MAKE}\" >&5\n set dummy ${MAKE-make}; ac_make=`echo \"$2\" | sed 'y%./+-%__p_%'`\n if eval \"test \\\"`echo '$''{'ac_cv_prog_make_${ac_make}_set'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -1313,7 +1324,7 @@ fi\n \n \n echo $ac_n \"checking whether a default assembler was specified\"\"... $ac_c\" 1>&6\n-echo \"configure:1317: checking whether a default assembler was specified\" >&5\n+echo \"configure:1328: checking whether a default assembler was specified\" >&5\n if test x\"${DEFAULT_ASSEMBLER+set}\" = x\"set\"; then\n     if test x\"$gas_flag\" = x\"no\"; then\n     \techo \"$ac_t\"\"yes ($DEFAULT_ASSEMBLER)\" 1>&6\n@@ -1325,7 +1336,7 @@ else\n fi\n \n echo $ac_n \"checking whether a default linker was specified\"\"... $ac_c\" 1>&6\n-echo \"configure:1329: checking whether a default linker was specified\" >&5\n+echo \"configure:1340: checking whether a default linker was specified\" >&5\n if test x\"${DEFAULT_LINKER+set}\" = x\"set\"; then\n     if test x\"$gnu_ld_flag\" = x\"no\"; then\n \techo \"$ac_t\"\"yes ($DEFAULT_LINKER)\" 1>&6\n@@ -1342,7 +1353,7 @@ do\n # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n set dummy $ac_prog; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1346: checking for $ac_word\" >&5\n+echo \"configure:1357: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_AWK'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1374,7 +1385,7 @@ done\n # Extract the first word of \"flex\", so it can be a program name with args.\n set dummy flex; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1378: checking for $ac_word\" >&5\n+echo \"configure:1389: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_LEX'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1408,15 +1419,15 @@ then\n   *) ac_lib=l ;;\n   esac\n   echo $ac_n \"checking for yywrap in -l$ac_lib\"\"... $ac_c\" 1>&6\n-echo \"configure:1412: checking for yywrap in -l$ac_lib\" >&5\n+echo \"configure:1423: checking for yywrap in -l$ac_lib\" >&5\n ac_lib_var=`echo $ac_lib'_'yywrap | sed 'y%./+-%__p_%'`\n if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-l$ac_lib  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 1420 \"configure\"\n+#line 1431 \"configure\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -1427,7 +1438,7 @@ int main() {\n yywrap()\n ; return 0; }\n EOF\n-if { (eval echo configure:1431: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:1442: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_lib_$ac_lib_var=yes\"\n else\n@@ -1450,7 +1461,7 @@ fi\n fi\n \n echo $ac_n \"checking whether ln works\"\"... $ac_c\" 1>&6\n-echo \"configure:1454: checking whether ln works\" >&5\n+echo \"configure:1465: checking whether ln works\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_prog_LN'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1482,7 +1493,7 @@ else\n fi\n \n echo $ac_n \"checking whether ln -s works\"\"... $ac_c\" 1>&6\n-echo \"configure:1486: checking whether ln -s works\" >&5\n+echo \"configure:1497: checking whether ln -s works\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_prog_LN_S'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1514,19 +1525,19 @@ else\n fi\n \n echo $ac_n \"checking for volatile\"\"... $ac_c\" 1>&6\n-echo \"configure:1518: checking for volatile\" >&5\n+echo \"configure:1529: checking for volatile\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_c_volatile'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1523 \"configure\"\n+#line 1534 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n volatile int foo;\n ; return 0; }\n EOF\n-if { (eval echo configure:1530: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:1541: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   gcc_cv_c_volatile=yes\n else\n@@ -1549,7 +1560,7 @@ fi\n # Extract the first word of \"ranlib\", so it can be a program name with args.\n set dummy ranlib; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1553: checking for $ac_word\" >&5\n+echo \"configure:1564: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1581,7 +1592,7 @@ do\n # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n set dummy $ac_prog; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:1585: checking for $ac_word\" >&5\n+echo \"configure:1596: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_YACC'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -1622,7 +1633,7 @@ test -n \"$YACC\" || YACC=\"yacc\"\n # SVR4 /usr/ucb/install, which tries to use the nonexistent group \"staff\"\n # ./install, which can be erroneously created by make from ./install.sh.\n echo $ac_n \"checking for a BSD compatible install\"\"... $ac_c\" 1>&6\n-echo \"configure:1626: checking for a BSD compatible install\" >&5\n+echo \"configure:1637: checking for a BSD compatible install\" >&5\n if test -z \"$INSTALL\"; then\n if eval \"test \\\"`echo '$''{'ac_cv_path_install'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n@@ -1673,7 +1684,7 @@ test -z \"$INSTALL_DATA\" && INSTALL_DATA='${INSTALL} -m 644'\n \n \n echo $ac_n \"checking how to run the C preprocessor\"\"... $ac_c\" 1>&6\n-echo \"configure:1677: checking how to run the C preprocessor\" >&5\n+echo \"configure:1688: checking how to run the C preprocessor\" >&5\n # On Suns, sometimes $CPP names a directory.\n if test -n \"$CPP\" && test -d \"$CPP\"; then\n   CPP=\n@@ -1688,13 +1699,13 @@ else\n   # On the NeXT, cc -E runs the code through the compiler's parser,\n   # not just through cpp.\n   cat > conftest.$ac_ext <<EOF\n-#line 1692 \"configure\"\n+#line 1703 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:1698: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:1709: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -1705,13 +1716,13 @@ else\n   rm -rf conftest*\n   CPP=\"${CC-cc} -E -traditional-cpp\"\n   cat > conftest.$ac_ext <<EOF\n-#line 1709 \"configure\"\n+#line 1720 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:1715: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:1726: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -1722,13 +1733,13 @@ else\n   rm -rf conftest*\n   CPP=\"${CC-cc} -nologo -E\"\n   cat > conftest.$ac_ext <<EOF\n-#line 1726 \"configure\"\n+#line 1737 \"configure\"\n #include \"confdefs.h\"\n #include <assert.h>\n Syntax Error\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:1732: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:1743: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   :\n@@ -1753,20 +1764,20 @@ fi\n echo \"$ac_t\"\"$CPP\" 1>&6\n \n echo $ac_n \"checking for ANSI C header files\"\"... $ac_c\" 1>&6\n-echo \"configure:1757: checking for ANSI C header files\" >&5\n+echo \"configure:1768: checking for ANSI C header files\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_stdc'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1762 \"configure\"\n+#line 1773 \"configure\"\n #include \"confdefs.h\"\n #include <stdlib.h>\n #include <stdarg.h>\n #include <string.h>\n #include <float.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:1770: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:1781: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -1783,7 +1794,7 @@ rm -f conftest*\n if test $ac_cv_header_stdc = yes; then\n   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.\n cat > conftest.$ac_ext <<EOF\n-#line 1787 \"configure\"\n+#line 1798 \"configure\"\n #include \"confdefs.h\"\n #include <string.h>\n EOF\n@@ -1801,7 +1812,7 @@ fi\n if test $ac_cv_header_stdc = yes; then\n   # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.\n cat > conftest.$ac_ext <<EOF\n-#line 1805 \"configure\"\n+#line 1816 \"configure\"\n #include \"confdefs.h\"\n #include <stdlib.h>\n EOF\n@@ -1822,7 +1833,7 @@ if test \"$cross_compiling\" = yes; then\n   :\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1826 \"configure\"\n+#line 1837 \"configure\"\n #include \"confdefs.h\"\n #include <ctype.h>\n #define ISLOWER(c) ('a' <= (c) && (c) <= 'z')\n@@ -1833,7 +1844,7 @@ if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);\n exit (0); }\n \n EOF\n-if { (eval echo configure:1837: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:1848: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   :\n else\n@@ -1857,12 +1868,12 @@ EOF\n fi\n \n echo $ac_n \"checking whether time.h and sys/time.h may both be included\"\"... $ac_c\" 1>&6\n-echo \"configure:1861: checking whether time.h and sys/time.h may both be included\" >&5\n+echo \"configure:1872: checking whether time.h and sys/time.h may both be included\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_time'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1866 \"configure\"\n+#line 1877 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <sys/time.h>\n@@ -1871,7 +1882,7 @@ int main() {\n struct tm *tp;\n ; return 0; }\n EOF\n-if { (eval echo configure:1875: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:1886: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_header_time=yes\n else\n@@ -1892,20 +1903,20 @@ EOF\n fi\n \n echo $ac_n \"checking whether string.h and strings.h may both be included\"\"... $ac_c\" 1>&6\n-echo \"configure:1896: checking whether string.h and strings.h may both be included\" >&5\n+echo \"configure:1907: checking whether string.h and strings.h may both be included\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_header_string'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1901 \"configure\"\n+#line 1912 \"configure\"\n #include \"confdefs.h\"\n #include <string.h>\n #include <strings.h>\n int main() {\n \n ; return 0; }\n EOF\n-if { (eval echo configure:1909: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:1920: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   gcc_cv_header_string=yes\n else\n@@ -1926,12 +1937,12 @@ EOF\n fi\n \n echo $ac_n \"checking for sys/wait.h that is POSIX.1 compatible\"\"... $ac_c\" 1>&6\n-echo \"configure:1930: checking for sys/wait.h that is POSIX.1 compatible\" >&5\n+echo \"configure:1941: checking for sys/wait.h that is POSIX.1 compatible\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_sys_wait_h'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1935 \"configure\"\n+#line 1946 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <sys/wait.h>\n@@ -1947,7 +1958,7 @@ wait (&s);\n s = WIFEXITED (s) ? WEXITSTATUS (s) : 1;\n ; return 0; }\n EOF\n-if { (eval echo configure:1951: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:1962: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_header_sys_wait_h=yes\n else\n@@ -1974,17 +1985,17 @@ for ac_hdr in limits.h stddef.h string.h strings.h stdlib.h time.h \\\n do\n ac_safe=`echo \"$ac_hdr\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for $ac_hdr\"\"... $ac_c\" 1>&6\n-echo \"configure:1978: checking for $ac_hdr\" >&5\n+echo \"configure:1989: checking for $ac_hdr\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 1983 \"configure\"\n+#line 1994 \"configure\"\n #include \"confdefs.h\"\n #include <$ac_hdr>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:1988: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:1999: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -2014,17 +2025,17 @@ done\n # Check for thread headers.\n ac_safe=`echo \"thread.h\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for thread.h\"\"... $ac_c\" 1>&6\n-echo \"configure:2018: checking for thread.h\" >&5\n+echo \"configure:2029: checking for thread.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2023 \"configure\"\n+#line 2034 \"configure\"\n #include \"confdefs.h\"\n #include <thread.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2028: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2039: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -2048,17 +2059,17 @@ fi\n \n ac_safe=`echo \"pthread.h\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for pthread.h\"\"... $ac_c\" 1>&6\n-echo \"configure:2052: checking for pthread.h\" >&5\n+echo \"configure:2063: checking for pthread.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2057 \"configure\"\n+#line 2068 \"configure\"\n #include \"confdefs.h\"\n #include <pthread.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2062: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2073: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -2085,7 +2096,7 @@ fi\n # Extract the first word of \"gnatbind\", so it can be a program name with args.\n set dummy gnatbind; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:2089: checking for $ac_word\" >&5\n+echo \"configure:2100: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_prog_gnat'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -2118,12 +2129,12 @@ fi\n \n \n echo $ac_n \"checking for preprocessor stringizing operator\"\"... $ac_c\" 1>&6\n-echo \"configure:2122: checking for preprocessor stringizing operator\" >&5\n+echo \"configure:2133: checking for preprocessor stringizing operator\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_stringize'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2127 \"configure\"\n+#line 2138 \"configure\"\n #include \"confdefs.h\"\n \n #define x(y) #y\n@@ -2156,20 +2167,20 @@ echo \"$ac_t\"\"${ac_cv_c_stringize}\" 1>&6\n # Use <inttypes.h> only if it exists,\n # doesn't clash with <sys/types.h>, and declares intmax_t.\n echo $ac_n \"checking for inttypes.h\"\"... $ac_c\" 1>&6\n-echo \"configure:2160: checking for inttypes.h\" >&5\n+echo \"configure:2171: checking for inttypes.h\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_header_inttypes_h'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2165 \"configure\"\n+#line 2176 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <inttypes.h>\n int main() {\n intmax_t i = -1;\n ; return 0; }\n EOF\n-if { (eval echo configure:2173: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:2184: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   gcc_cv_header_inttypes_h=yes\n else\n@@ -2192,15 +2203,15 @@ fi\n for ac_func in strtoul bsearch strerror putenv popen bcopy bzero bcmp \\\n \tindex rindex strchr strrchr kill getrlimit setrlimit atoll atoq \\\n \tsysconf isascii gettimeofday strsignal putc_unlocked fputc_unlocked \\\n-\tfputs_unlocked getrusage\n+\tfputs_unlocked getrusage valloc\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:2199: checking for $ac_func\" >&5\n+echo \"configure:2210: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2204 \"configure\"\n+#line 2215 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -2223,7 +2234,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2227: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2238: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -2252,12 +2263,12 @@ done\n #AC_CHECK_TYPE(wchar_t, unsigned int)\n \n echo $ac_n \"checking for vprintf\"\"... $ac_c\" 1>&6\n-echo \"configure:2256: checking for vprintf\" >&5\n+echo \"configure:2267: checking for vprintf\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_vprintf'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2261 \"configure\"\n+#line 2272 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char vprintf(); below.  */\n@@ -2280,7 +2291,7 @@ vprintf();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2284: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2295: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_vprintf=yes\"\n else\n@@ -2304,12 +2315,12 @@ fi\n \n if test \"$ac_cv_func_vprintf\" != yes; then\n echo $ac_n \"checking for _doprnt\"\"... $ac_c\" 1>&6\n-echo \"configure:2308: checking for _doprnt\" >&5\n+echo \"configure:2319: checking for _doprnt\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func__doprnt'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2313 \"configure\"\n+#line 2324 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char _doprnt(); below.  */\n@@ -2332,7 +2343,7 @@ _doprnt();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2336: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2347: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func__doprnt=yes\"\n else\n@@ -2368,15 +2379,15 @@ fi\n \n \n echo $ac_n \"checking whether the printf functions support %p\"\"... $ac_c\" 1>&6\n-echo \"configure:2372: checking whether the printf functions support %p\" >&5\n+echo \"configure:2383: checking whether the printf functions support %p\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_func_printf_ptr'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n   gcc_cv_func_printf_ptr=no\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2380 \"configure\"\n+#line 2391 \"configure\"\n #include \"confdefs.h\"\n #include <stdio.h>\n \n@@ -2389,7 +2400,7 @@ main()\n   exit (p != q);\n }\n EOF\n-if { (eval echo configure:2393: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2404: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   gcc_cv_func_printf_ptr=yes\n else\n@@ -2422,12 +2433,12 @@ case \"${host}\" in\n   ;;\n esac\n echo $ac_n \"checking for pid_t\"\"... $ac_c\" 1>&6\n-echo \"configure:2426: checking for pid_t\" >&5\n+echo \"configure:2437: checking for pid_t\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_type_pid_t'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2431 \"configure\"\n+#line 2442 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #if STDC_HEADERS\n@@ -2456,17 +2467,17 @@ fi\n \n ac_safe=`echo \"vfork.h\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for vfork.h\"\"... $ac_c\" 1>&6\n-echo \"configure:2460: checking for vfork.h\" >&5\n+echo \"configure:2471: checking for vfork.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2465 \"configure\"\n+#line 2476 \"configure\"\n #include \"confdefs.h\"\n #include <vfork.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2470: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2481: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -2491,18 +2502,18 @@ else\n fi\n \n echo $ac_n \"checking for working vfork\"\"... $ac_c\" 1>&6\n-echo \"configure:2495: checking for working vfork\" >&5\n+echo \"configure:2506: checking for working vfork\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_vfork_works'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n   echo $ac_n \"checking for vfork\"\"... $ac_c\" 1>&6\n-echo \"configure:2501: checking for vfork\" >&5\n+echo \"configure:2512: checking for vfork\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_vfork'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2506 \"configure\"\n+#line 2517 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char vfork(); below.  */\n@@ -2525,7 +2536,7 @@ vfork();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2529: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2540: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_vfork=yes\"\n else\n@@ -2547,7 +2558,7 @@ fi\n ac_cv_func_vfork_works=$ac_cv_func_vfork\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2551 \"configure\"\n+#line 2562 \"configure\"\n #include \"confdefs.h\"\n /* Thanks to Paul Eggert for this test.  */\n #include <stdio.h>\n@@ -2642,7 +2653,7 @@ main() {\n   }\n }\n EOF\n-if { (eval echo configure:2646: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2657: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_func_vfork_works=yes\n else\n@@ -2668,17 +2679,17 @@ for ac_hdr in unistd.h\n do\n ac_safe=`echo \"$ac_hdr\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for $ac_hdr\"\"... $ac_c\" 1>&6\n-echo \"configure:2672: checking for $ac_hdr\" >&5\n+echo \"configure:2683: checking for $ac_hdr\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2677 \"configure\"\n+#line 2688 \"configure\"\n #include \"confdefs.h\"\n #include <$ac_hdr>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:2682: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:2693: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -2707,12 +2718,12 @@ done\n for ac_func in getpagesize\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:2711: checking for $ac_func\" >&5\n+echo \"configure:2722: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2716 \"configure\"\n+#line 2727 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -2735,7 +2746,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:2739: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:2750: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -2760,15 +2771,15 @@ fi\n done\n \n echo $ac_n \"checking for working mmap\"\"... $ac_c\" 1>&6\n-echo \"configure:2764: checking for working mmap\" >&5\n+echo \"configure:2775: checking for working mmap\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_mmap_fixed_mapped'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n   ac_cv_func_mmap_fixed_mapped=no\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2772 \"configure\"\n+#line 2783 \"configure\"\n #include \"confdefs.h\"\n \n /* Thanks to Mike Haertel and Jim Avera for this test.\n@@ -2908,7 +2919,7 @@ main()\n }\n \n EOF\n-if { (eval echo configure:2912: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:2923: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_func_mmap_fixed_mapped=yes\n else\n@@ -2936,12 +2947,12 @@ for ac_func in bcopy bzero bcmp \\\n \tstrsignal putc_unlocked fputs_unlocked strstr\n do\n echo $ac_n \"checking whether $ac_func must be declared\"\"... $ac_c\" 1>&6\n-echo \"configure:2940: checking whether $ac_func must be declared\" >&5\n+echo \"configure:2951: checking whether $ac_func must be declared\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_decl_needed_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 2945 \"configure\"\n+#line 2956 \"configure\"\n #include \"confdefs.h\"\n \n #include <stdio.h>\n@@ -2974,7 +2985,7 @@ int main() {\n char *(*pfn) = (char *(*)) $ac_func\n ; return 0; }\n EOF\n-if { (eval echo configure:2978: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:2989: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   eval \"gcc_cv_decl_needed_$ac_func=no\"\n else\n@@ -3003,12 +3014,12 @@ done\n for ac_func in malloc realloc calloc free\n do\n echo $ac_n \"checking whether $ac_func must be declared\"\"... $ac_c\" 1>&6\n-echo \"configure:3007: checking whether $ac_func must be declared\" >&5\n+echo \"configure:3018: checking whether $ac_func must be declared\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_decl_needed_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3012 \"configure\"\n+#line 3023 \"configure\"\n #include \"confdefs.h\"\n \n #include <stdio.h>\n@@ -3044,7 +3055,7 @@ int main() {\n char *(*pfn) = (char *(*)) $ac_func\n ; return 0; }\n EOF\n-if { (eval echo configure:3048: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3059: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   eval \"gcc_cv_decl_needed_$ac_func=no\"\n else\n@@ -3073,12 +3084,12 @@ done\n for ac_func in getrlimit setrlimit getrusage\n do\n echo $ac_n \"checking whether $ac_func must be declared\"\"... $ac_c\" 1>&6\n-echo \"configure:3077: checking whether $ac_func must be declared\" >&5\n+echo \"configure:3088: checking whether $ac_func must be declared\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_decl_needed_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3082 \"configure\"\n+#line 3093 \"configure\"\n #include \"confdefs.h\"\n \n #include <stdio.h>\n@@ -3115,7 +3126,7 @@ int main() {\n char *(*pfn) = (char *(*)) $ac_func\n ; return 0; }\n EOF\n-if { (eval echo configure:3119: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3130: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   eval \"gcc_cv_decl_needed_$ac_func=no\"\n else\n@@ -3142,12 +3153,12 @@ done\n \n \n echo $ac_n \"checking for sys_siglist declaration in signal.h or unistd.h\"\"... $ac_c\" 1>&6\n-echo \"configure:3146: checking for sys_siglist declaration in signal.h or unistd.h\" >&5\n+echo \"configure:3157: checking for sys_siglist declaration in signal.h or unistd.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_decl_sys_siglist'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3151 \"configure\"\n+#line 3162 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #include <signal.h>\n@@ -3159,7 +3170,7 @@ int main() {\n char *msg = *(sys_siglist + 1);\n ; return 0; }\n EOF\n-if { (eval echo configure:3163: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3174: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_decl_sys_siglist=yes\n else\n@@ -3182,12 +3193,12 @@ fi\n \n # mkdir takes a single argument on some systems. \n echo $ac_n \"checking if mkdir takes one argument\"\"... $ac_c\" 1>&6\n-echo \"configure:3186: checking if mkdir takes one argument\" >&5\n+echo \"configure:3197: checking if mkdir takes one argument\" >&5\n if eval \"test \\\"`echo '$''{'gcc_cv_mkdir_takes_one_arg'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 3191 \"configure\"\n+#line 3202 \"configure\"\n #include \"confdefs.h\"\n \n #include <sys/types.h>\n@@ -3204,7 +3215,7 @@ int main() {\n mkdir (\"foo\", 0);\n ; return 0; }\n EOF\n-if { (eval echo configure:3208: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:3219: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   gcc_cv_mkdir_takes_one_arg=no\n else\n@@ -5968,7 +5979,7 @@ for machine in $build $host $target; do\n                 xmake_file=sparc/x-sysv4\n                 extra_parts=\"crt1.o crti.o crtn.o gmon.o crtbegin.o crtend.o\"\n                 case $machine in\n-                *-*-solaris2.[0-4])\n+                *-*-solaris2.0-4)\n                         float_format=i128\n                 ;;\n                 *)\n@@ -6278,7 +6289,7 @@ for machine in $build $host $target; do\n \n \t\t\t# Distinguish cores, and major variants\n \t\t\t# arm7m doesn't exist, but D & I don't affect code\n-                       xarm[23678] | xarm250 | xarm[67][01]0 \\\n+\t\t\txarm[23678] | xarm250 | xarm[67][01]0 \\\n \t\t\t| xarm7m | xarm7dm | xarm7dmi | xarm7tdmi \\\n \t\t\t| xarm7100 | xarm7500 | xarm7500fe | xarm810 \\\n \t\t\t| xstrongarm | xstrongarm110 | xstrongarm1100)\n@@ -6641,15 +6652,15 @@ fi\n \n \n         echo $ac_n \"checking for strerror in -lcposix\"\"... $ac_c\" 1>&6\n-echo \"configure:6636: checking for strerror in -lcposix\" >&5\n+echo \"configure:6656: checking for strerror in -lcposix\" >&5\n ac_lib_var=`echo cposix'_'strerror | sed 'y%./+-%__p_%'`\n if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-lcposix  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 6644 \"configure\"\n+#line 6664 \"configure\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -6660,7 +6671,7 @@ int main() {\n strerror()\n ; return 0; }\n EOF\n-if { (eval echo configure:6655: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6675: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_lib_$ac_lib_var=yes\"\n else\n@@ -6683,12 +6694,12 @@ fi\n   \n \n echo $ac_n \"checking for working const\"\"... $ac_c\" 1>&6\n-echo \"configure:6678: checking for working const\" >&5\n+echo \"configure:6698: checking for working const\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_const'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6683 \"configure\"\n+#line 6703 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n@@ -6737,7 +6748,7 @@ ccp = (char const *const *) p;\n \n ; return 0; }\n EOF\n-if { (eval echo configure:6732: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:6752: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_c_const=yes\n else\n@@ -6758,21 +6769,21 @@ EOF\n fi\n \n echo $ac_n \"checking for inline\"\"... $ac_c\" 1>&6\n-echo \"configure:6753: checking for inline\" >&5\n+echo \"configure:6773: checking for inline\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_inline'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_cv_c_inline=no\n for ac_kw in inline __inline__ __inline; do\n   cat > conftest.$ac_ext <<EOF\n-#line 6760 \"configure\"\n+#line 6780 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n } $ac_kw foo() {\n ; return 0; }\n EOF\n-if { (eval echo configure:6767: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n+if { (eval echo configure:6787: \\\"$ac_compile\\\") 1>&5; (eval $ac_compile) 2>&5; }; then\n   rm -rf conftest*\n   ac_cv_c_inline=$ac_kw; break\n else\n@@ -6798,12 +6809,12 @@ EOF\n esac\n \n echo $ac_n \"checking for off_t\"\"... $ac_c\" 1>&6\n-echo \"configure:6793: checking for off_t\" >&5\n+echo \"configure:6813: checking for off_t\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_type_off_t'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6798 \"configure\"\n+#line 6818 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #if STDC_HEADERS\n@@ -6831,12 +6842,12 @@ EOF\n fi\n \n echo $ac_n \"checking for size_t\"\"... $ac_c\" 1>&6\n-echo \"configure:6826: checking for size_t\" >&5\n+echo \"configure:6846: checking for size_t\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_type_size_t'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6831 \"configure\"\n+#line 6851 \"configure\"\n #include \"confdefs.h\"\n #include <sys/types.h>\n #if STDC_HEADERS\n@@ -6866,19 +6877,19 @@ fi\n # The Ultrix 4.2 mips builtin alloca declared by alloca.h only works\n # for constant arguments.  Useless!\n echo $ac_n \"checking for working alloca.h\"\"... $ac_c\" 1>&6\n-echo \"configure:6861: checking for working alloca.h\" >&5\n+echo \"configure:6881: checking for working alloca.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_alloca_h'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6866 \"configure\"\n+#line 6886 \"configure\"\n #include \"confdefs.h\"\n #include <alloca.h>\n int main() {\n char *p = alloca(2 * sizeof(int));\n ; return 0; }\n EOF\n-if { (eval echo configure:6873: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6893: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_header_alloca_h=yes\n else\n@@ -6899,12 +6910,12 @@ EOF\n fi\n \n echo $ac_n \"checking for alloca\"\"... $ac_c\" 1>&6\n-echo \"configure:6894: checking for alloca\" >&5\n+echo \"configure:6914: checking for alloca\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_alloca_works'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6899 \"configure\"\n+#line 6919 \"configure\"\n #include \"confdefs.h\"\n \n #ifdef __GNUC__\n@@ -6932,7 +6943,7 @@ int main() {\n char *p = (char *) alloca(1);\n ; return 0; }\n EOF\n-if { (eval echo configure:6927: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:6947: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   ac_cv_func_alloca_works=yes\n else\n@@ -6964,12 +6975,12 @@ EOF\n \n \n echo $ac_n \"checking whether alloca needs Cray hooks\"\"... $ac_c\" 1>&6\n-echo \"configure:6959: checking whether alloca needs Cray hooks\" >&5\n+echo \"configure:6979: checking whether alloca needs Cray hooks\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_os_cray'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6964 \"configure\"\n+#line 6984 \"configure\"\n #include \"confdefs.h\"\n #if defined(CRAY) && ! defined(CRAY2)\n webecray\n@@ -6994,12 +7005,12 @@ echo \"$ac_t\"\"$ac_cv_os_cray\" 1>&6\n if test $ac_cv_os_cray = yes; then\n for ac_func in _getb67 GETB67 getb67; do\n   echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:6989: checking for $ac_func\" >&5\n+echo \"configure:7009: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 6994 \"configure\"\n+#line 7014 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -7022,7 +7033,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:7017: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7037: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -7049,15 +7060,15 @@ done\n fi\n \n echo $ac_n \"checking stack direction for C alloca\"\"... $ac_c\" 1>&6\n-echo \"configure:7044: checking stack direction for C alloca\" >&5\n+echo \"configure:7064: checking stack direction for C alloca\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_c_stack_direction'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   if test \"$cross_compiling\" = yes; then\n   ac_cv_c_stack_direction=0\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7052 \"configure\"\n+#line 7072 \"configure\"\n #include \"confdefs.h\"\n find_stack_direction ()\n {\n@@ -7076,7 +7087,7 @@ main ()\n   exit (find_stack_direction() < 0);\n }\n EOF\n-if { (eval echo configure:7071: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n+if { (eval echo configure:7091: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null\n then\n   ac_cv_c_stack_direction=1\n else\n@@ -7103,17 +7114,17 @@ unistd.h sys/param.h\n do\n ac_safe=`echo \"$ac_hdr\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for $ac_hdr\"\"... $ac_c\" 1>&6\n-echo \"configure:7098: checking for $ac_hdr\" >&5\n+echo \"configure:7118: checking for $ac_hdr\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7103 \"configure\"\n+#line 7123 \"configure\"\n #include \"confdefs.h\"\n #include <$ac_hdr>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:7108: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:7128: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -7143,12 +7154,12 @@ done\n strdup __argz_count __argz_stringify __argz_next\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:7138: checking for $ac_func\" >&5\n+echo \"configure:7158: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7143 \"configure\"\n+#line 7163 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -7171,7 +7182,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:7166: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7186: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -7200,12 +7211,12 @@ done\n      for ac_func in stpcpy\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:7195: checking for $ac_func\" >&5\n+echo \"configure:7215: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7200 \"configure\"\n+#line 7220 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -7228,7 +7239,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:7223: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7243: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -7262,19 +7273,19 @@ EOF\n \n    if test $ac_cv_header_locale_h = yes; then\n     echo $ac_n \"checking for LC_MESSAGES\"\"... $ac_c\" 1>&6\n-echo \"configure:7257: checking for LC_MESSAGES\" >&5\n+echo \"configure:7277: checking for LC_MESSAGES\" >&5\n if eval \"test \\\"`echo '$''{'am_cv_val_LC_MESSAGES'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7262 \"configure\"\n+#line 7282 \"configure\"\n #include \"confdefs.h\"\n #include <locale.h>\n int main() {\n return LC_MESSAGES\n ; return 0; }\n EOF\n-if { (eval echo configure:7269: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7289: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   am_cv_val_LC_MESSAGES=yes\n else\n@@ -7295,7 +7306,7 @@ EOF\n     fi\n   fi\n    echo $ac_n \"checking whether NLS is requested\"\"... $ac_c\" 1>&6\n-echo \"configure:7290: checking whether NLS is requested\" >&5\n+echo \"configure:7310: checking whether NLS is requested\" >&5\n         # Check whether --enable-nls or --disable-nls was given.\n if test \"${enable_nls+set}\" = set; then\n   enableval=\"$enable_nls\"\n@@ -7315,7 +7326,7 @@ fi\n EOF\n \n       echo $ac_n \"checking whether included gettext is requested\"\"... $ac_c\" 1>&6\n-echo \"configure:7310: checking whether included gettext is requested\" >&5\n+echo \"configure:7330: checking whether included gettext is requested\" >&5\n       # Check whether --with-included-gettext or --without-included-gettext was given.\n if test \"${with_included_gettext+set}\" = set; then\n   withval=\"$with_included_gettext\"\n@@ -7334,17 +7345,17 @@ fi\n \n \tac_safe=`echo \"libintl.h\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for libintl.h\"\"... $ac_c\" 1>&6\n-echo \"configure:7329: checking for libintl.h\" >&5\n+echo \"configure:7349: checking for libintl.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7334 \"configure\"\n+#line 7354 \"configure\"\n #include \"confdefs.h\"\n #include <libintl.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:7339: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:7359: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -7361,19 +7372,19 @@ fi\n if eval \"test \\\"`echo '$ac_cv_header_'$ac_safe`\\\" = yes\"; then\n   echo \"$ac_t\"\"yes\" 1>&6\n   echo $ac_n \"checking for gettext in libc\"\"... $ac_c\" 1>&6\n-echo \"configure:7356: checking for gettext in libc\" >&5\n+echo \"configure:7376: checking for gettext in libc\" >&5\n if eval \"test \\\"`echo '$''{'gt_cv_func_gettext_libc'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7361 \"configure\"\n+#line 7381 \"configure\"\n #include \"confdefs.h\"\n #include <libintl.h>\n int main() {\n return (int) gettext (\"\")\n ; return 0; }\n EOF\n-if { (eval echo configure:7368: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7388: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   gt_cv_func_gettext_libc=yes\n else\n@@ -7389,15 +7400,15 @@ echo \"$ac_t\"\"$gt_cv_func_gettext_libc\" 1>&6\n \n \t   if test \"$gt_cv_func_gettext_libc\" != \"yes\"; then\n \t     echo $ac_n \"checking for bindtextdomain in -lintl\"\"... $ac_c\" 1>&6\n-echo \"configure:7384: checking for bindtextdomain in -lintl\" >&5\n+echo \"configure:7404: checking for bindtextdomain in -lintl\" >&5\n ac_lib_var=`echo intl'_'bindtextdomain | sed 'y%./+-%__p_%'`\n if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-lintl  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 7392 \"configure\"\n+#line 7412 \"configure\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -7408,7 +7419,7 @@ int main() {\n bindtextdomain()\n ; return 0; }\n EOF\n-if { (eval echo configure:7403: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7423: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_lib_$ac_lib_var=yes\"\n else\n@@ -7424,20 +7435,20 @@ fi\n if eval \"test \\\"`echo '$ac_cv_lib_'$ac_lib_var`\\\" = yes\"; then\n   echo \"$ac_t\"\"yes\" 1>&6\n   echo $ac_n \"checking for gettext in libintl\"\"... $ac_c\" 1>&6\n-echo \"configure:7419: checking for gettext in libintl\" >&5\n+echo \"configure:7439: checking for gettext in libintl\" >&5\n if eval \"test \\\"`echo '$''{'gt_cv_func_gettext_libintl'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   echo $ac_n \"checking for gettext in -lintl\"\"... $ac_c\" 1>&6\n-echo \"configure:7424: checking for gettext in -lintl\" >&5\n+echo \"configure:7444: checking for gettext in -lintl\" >&5\n ac_lib_var=`echo intl'_'gettext | sed 'y%./+-%__p_%'`\n if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-lintl  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 7432 \"configure\"\n+#line 7452 \"configure\"\n #include \"confdefs.h\"\n /* Override any gcc2 internal prototype to avoid an error.  */\n /* We use char because int might match the return type of a gcc2\n@@ -7448,7 +7459,7 @@ int main() {\n gettext()\n ; return 0; }\n EOF\n-if { (eval echo configure:7443: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7463: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_lib_$ac_lib_var=yes\"\n else\n@@ -7487,7 +7498,7 @@ EOF\n \t      # Extract the first word of \"msgfmt\", so it can be a program name with args.\n set dummy msgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7482: checking for $ac_word\" >&5\n+echo \"configure:7502: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_MSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7521,12 +7532,12 @@ fi\n \t\tfor ac_func in dcgettext\n do\n echo $ac_n \"checking for $ac_func\"\"... $ac_c\" 1>&6\n-echo \"configure:7516: checking for $ac_func\" >&5\n+echo \"configure:7536: checking for $ac_func\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_$ac_func'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7521 \"configure\"\n+#line 7541 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char $ac_func(); below.  */\n@@ -7549,7 +7560,7 @@ $ac_func();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:7544: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7564: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_$ac_func=yes\"\n else\n@@ -7576,7 +7587,7 @@ done\n \t\t# Extract the first word of \"gmsgfmt\", so it can be a program name with args.\n set dummy gmsgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7571: checking for $ac_word\" >&5\n+echo \"configure:7591: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7612,7 +7623,7 @@ fi\n \t\t# Extract the first word of \"xgettext\", so it can be a program name with args.\n set dummy xgettext; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7607: checking for $ac_word\" >&5\n+echo \"configure:7627: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7644,15 +7655,15 @@ else\n fi\n \n \t\tcat > conftest.$ac_ext <<EOF\n-#line 7639 \"configure\"\n+#line 7659 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n extern int _nl_msg_cat_cntr;\n \t\t\t       return _nl_msg_cat_cntr\n ; return 0; }\n EOF\n-if { (eval echo configure:7647: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7667: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   CATOBJEXT=.gmo\n \t\t   DATADIRNAME=share\n@@ -7675,7 +7686,7 @@ fi\n \n         if test \"$CATOBJEXT\" = \"NONE\"; then\n \t  echo $ac_n \"checking whether catgets can be used\"\"... $ac_c\" 1>&6\n-echo \"configure:7670: checking whether catgets can be used\" >&5\n+echo \"configure:7690: checking whether catgets can be used\" >&5\n \t  # Check whether --with-catgets or --without-catgets was given.\n if test \"${with_catgets+set}\" = set; then\n   withval=\"$with_catgets\"\n@@ -7688,22 +7699,22 @@ fi\n \n \t  if test \"$nls_cv_use_catgets\" = \"yes\"; then\n \t    \t    echo $ac_n \"checking for main in -li\"\"... $ac_c\" 1>&6\n-echo \"configure:7683: checking for main in -li\" >&5\n+echo \"configure:7703: checking for main in -li\" >&5\n ac_lib_var=`echo i'_'main | sed 'y%./+-%__p_%'`\n if eval \"test \\\"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   ac_save_LIBS=\"$LIBS\"\n LIBS=\"-li  $LIBS\"\n cat > conftest.$ac_ext <<EOF\n-#line 7691 \"configure\"\n+#line 7711 \"configure\"\n #include \"confdefs.h\"\n \n int main() {\n main()\n ; return 0; }\n EOF\n-if { (eval echo configure:7698: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7718: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_lib_$ac_lib_var=yes\"\n else\n@@ -7731,12 +7742,12 @@ else\n fi\n \n \t    echo $ac_n \"checking for catgets\"\"... $ac_c\" 1>&6\n-echo \"configure:7726: checking for catgets\" >&5\n+echo \"configure:7746: checking for catgets\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_func_catgets'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 7731 \"configure\"\n+#line 7751 \"configure\"\n #include \"confdefs.h\"\n /* System header to define __stub macros and hopefully few prototypes,\n     which can conflict with char catgets(); below.  */\n@@ -7759,7 +7770,7 @@ catgets();\n \n ; return 0; }\n EOF\n-if { (eval echo configure:7754: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n+if { (eval echo configure:7774: \\\"$ac_link\\\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then\n   rm -rf conftest*\n   eval \"ac_cv_func_catgets=yes\"\n else\n@@ -7781,7 +7792,7 @@ EOF\n \t       # Extract the first word of \"gencat\", so it can be a program name with args.\n set dummy gencat; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7776: checking for $ac_word\" >&5\n+echo \"configure:7796: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_GENCAT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7817,7 +7828,7 @@ fi\n \t\t # Extract the first word of \"gmsgfmt\", so it can be a program name with args.\n set dummy gmsgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7812: checking for $ac_word\" >&5\n+echo \"configure:7832: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7854,7 +7865,7 @@ fi\n \t\t   # Extract the first word of \"msgfmt\", so it can be a program name with args.\n set dummy msgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7849: checking for $ac_word\" >&5\n+echo \"configure:7869: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7889,7 +7900,7 @@ fi\n \t\t # Extract the first word of \"xgettext\", so it can be a program name with args.\n set dummy xgettext; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7884: checking for $ac_word\" >&5\n+echo \"configure:7904: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7947,7 +7958,7 @@ fi\n         # Extract the first word of \"msgfmt\", so it can be a program name with args.\n set dummy msgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7942: checking for $ac_word\" >&5\n+echo \"configure:7962: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_MSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -7981,7 +7992,7 @@ fi\n         # Extract the first word of \"gmsgfmt\", so it can be a program name with args.\n set dummy gmsgfmt; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:7976: checking for $ac_word\" >&5\n+echo \"configure:7996: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -8017,7 +8028,7 @@ fi\n         # Extract the first word of \"xgettext\", so it can be a program name with args.\n set dummy xgettext; ac_word=$2\n echo $ac_n \"checking for $ac_word\"\"... $ac_c\" 1>&6\n-echo \"configure:8012: checking for $ac_word\" >&5\n+echo \"configure:8032: checking for $ac_word\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_path_XGETTEXT'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n@@ -8110,7 +8121,7 @@ fi\n        LINGUAS=\n      else\n        echo $ac_n \"checking for catalogs to be installed\"\"... $ac_c\" 1>&6\n-echo \"configure:8105: checking for catalogs to be installed\" >&5\n+echo \"configure:8125: checking for catalogs to be installed\" >&5\n        NEW_LINGUAS=\n        for lang in ${LINGUAS=$ALL_LINGUAS}; do\n          case \"$ALL_LINGUAS\" in\n@@ -8138,17 +8149,17 @@ echo \"configure:8105: checking for catalogs to be installed\" >&5\n    if test \"$CATOBJEXT\" = \".cat\"; then\n      ac_safe=`echo \"linux/version.h\" | sed 'y%./+-%__p_%'`\n echo $ac_n \"checking for linux/version.h\"\"... $ac_c\" 1>&6\n-echo \"configure:8133: checking for linux/version.h\" >&5\n+echo \"configure:8153: checking for linux/version.h\" >&5\n if eval \"test \\\"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\\\" = set\"; then\n   echo $ac_n \"(cached) $ac_c\" 1>&6\n else\n   cat > conftest.$ac_ext <<EOF\n-#line 8138 \"configure\"\n+#line 8158 \"configure\"\n #include \"confdefs.h\"\n #include <linux/version.h>\n EOF\n ac_try=\"$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out\"\n-{ (eval echo configure:8143: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n+{ (eval echo configure:8163: \\\"$ac_try\\\") 1>&5; (eval $ac_try) 2>&5; }\n ac_err=`grep -v '^ *+' conftest.out | grep -v \"^conftest.${ac_ext}\\$\"`\n if test -z \"$ac_err\"; then\n   rm -rf conftest*\n@@ -8223,7 +8234,7 @@ fi\n \n \n echo $ac_n \"checking whether windows registry support is requested\"\"... $ac_c\" 1>&6\n-echo \"configure:8218: checking whether windows registry support is requested\" >&5\n+echo \"configure:8238: checking whether windows registry support is requested\" >&5\n if test x$enable_win32_registry != xno; then\n   cat >> confdefs.h <<\\EOF\n #define ENABLE_WIN32_REGISTRY 1\n@@ -8252,7 +8263,7 @@ esac\n \n if test x$enable_win32_registry != xno; then\n   echo $ac_n \"checking registry key on windows hosts\"\"... $ac_c\" 1>&6\n-echo \"configure:8247: checking registry key on windows hosts\" >&5\n+echo \"configure:8267: checking registry key on windows hosts\" >&5\n   cat >> confdefs.h <<EOF\n #define WIN32_REGISTRY_KEY \"$gcc_cv_win32_registry_key\"\n EOF\n@@ -8428,7 +8439,7 @@ fi\n \n # Figure out what assembler alignment features are present.\n echo $ac_n \"checking assembler alignment features\"\"... $ac_c\" 1>&6\n-echo \"configure:8423: checking assembler alignment features\" >&5\n+echo \"configure:8443: checking assembler alignment features\" >&5\n gcc_cv_as=\n gcc_cv_as_alignment_features=\n gcc_cv_as_gas_srcdir=`echo $srcdir | sed -e 's,/gcc$,,'`/gas\n@@ -8549,7 +8560,7 @@ fi\n echo \"$ac_t\"\"$gcc_cv_as_alignment_features\" 1>&6\n \n echo $ac_n \"checking assembler subsection support\"\"... $ac_c\" 1>&6\n-echo \"configure:8544: checking assembler subsection support\" >&5\n+echo \"configure:8564: checking assembler subsection support\" >&5\n gcc_cv_as_subsections=\n if test x$gcc_cv_as != x; then\n \t# Check if we have .subsection\n@@ -8591,7 +8602,7 @@ echo \"$ac_t\"\"$gcc_cv_as_subsections\" 1>&6\n case \"$target\" in \n   sparc*-*-*)\n     echo $ac_n \"checking assembler .register pseudo-op support\"\"... $ac_c\" 1>&6\n-echo \"configure:8586: checking assembler .register pseudo-op support\" >&5\n+echo \"configure:8606: checking assembler .register pseudo-op support\" >&5\n     gcc_cv_as_register_pseudo_op=\n     if test x$gcc_cv_as != x; then\n \t# Check if we have .register\n@@ -8608,7 +8619,7 @@ EOF\n     echo \"$ac_t\"\"$gcc_cv_as_register_pseudo_op\" 1>&6\n \n     echo $ac_n \"checking assembler offsetable %lo() support\"\"... $ac_c\" 1>&6\n-echo \"configure:8603: checking assembler offsetable %lo() support\" >&5\n+echo \"configure:8623: checking assembler offsetable %lo() support\" >&5\n     gcc_cv_as_offsetable_lo10=\n     if test x$gcc_cv_as != x; then\n \t# Check if assembler has offsetable %lo()\n@@ -8645,7 +8656,7 @@ EOF\n \n   i[34567]86-*-*)\n     echo $ac_n \"checking assembler instructions\"\"... $ac_c\" 1>&6\n-echo \"configure:8640: checking assembler instructions\" >&5\n+echo \"configure:8660: checking assembler instructions\" >&5\n     gcc_cv_as_instructions=\n     if test x$gcc_cv_as != x; then\n \tset \"filds fists\" \"filds mem; fists mem\"\n@@ -8745,6 +8756,8 @@ esac\n else\n   if test $ac_cv_func_mmap_fixed_mapped = yes; then\n   GGC=ggc-page\n+elif test $ac_cv_func_valloc = yes; then\n+  GGC=ggc-page\n else\n   GGC=ggc-simple\n fi"}, {"sha": "e4c5d586aa49be3c50f8e4d7c24ba8957fffe674", "filename": "gcc/configure.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.in?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -368,7 +368,7 @@ fi\n AC_CHECK_FUNCS(strtoul bsearch strerror putenv popen bcopy bzero bcmp \\\n \tindex rindex strchr strrchr kill getrlimit setrlimit atoll atoq \\\n \tsysconf isascii gettimeofday strsignal putc_unlocked fputc_unlocked \\\n-\tfputs_unlocked getrusage)\n+\tfputs_unlocked getrusage valloc)\n \n # Make sure wchar_t is available\n #AC_CHECK_TYPE(wchar_t, unsigned int)\n@@ -4456,6 +4456,8 @@ AC_ARG_WITH(gc,\n esac],\n [if test $ac_cv_func_mmap_fixed_mapped = yes; then\n   GGC=ggc-page\n+elif test $ac_cv_func_valloc = yes; then\n+  GGC=ggc-page\n else\n   GGC=ggc-simple\n fi])"}, {"sha": "3aa0d998ceb525bf05c2891fd4f1f797a2b75491", "filename": "gcc/ggc-common.c", "status": "modified", "additions": 25, "deletions": 5, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fggc-common.c?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -268,21 +268,18 @@ ggc_mark_rtx_children (r)\n \t  ggc_mark_rtvec (XVEC (r, i));\n \t  break;\n \tcase 'S': case 's':\n-\t  ggc_mark_string_if_gcable (XSTR (r, i));\n+\t  ggc_mark_if_gcable (XSTR (r, i));\n \t  break;\n \t}\n     }\n }\n \n void\n-ggc_mark_rtvec (v)\n+ggc_mark_rtvec_children (v)\n      rtvec v;\n {\n   int i;\n \n-  if (v == NULL || ggc_set_mark_rtvec (v))\n-    return;\n-\n   i = GET_NUM_ELEM (v);\n   while (--i >= 0)\n     ggc_mark_rtx (RTVEC_ELT (v, i));\n@@ -451,3 +448,26 @@ ggc_mark_tree_hash_table (ht)\n   hash_traverse (ht, ggc_mark_tree_hash_table_entry, /*info=*/0);\n }\n \n+/* Allocation wrappers.  */\n+\n+char *\n+ggc_alloc_string (contents, length)\n+     const char *contents;\n+     int length;\n+{\n+  char *string;\n+\n+  if (length < 0)\n+    {\n+      if (contents == NULL)\n+\treturn NULL;\n+      length = strlen (contents);\n+    }\n+\n+  string = (char *) ggc_alloc_obj (length + 1, 0);\n+  if (contents != NULL)\n+    memcpy (string, contents, length);\n+  string[length] = 0;\n+\n+  return string;\n+}"}, {"sha": "e05107ec8db095493a37f8fbee05348c6e9acb98", "filename": "gcc/ggc-none.c", "status": "modified", "additions": 8, "deletions": 23, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-none.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-none.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fggc-none.c?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -35,28 +35,13 @@\n /* For now, keep using the old obstack scheme in the gen* programs.  */\n int ggc_p = 0;\n \n-rtx\n-ggc_alloc_rtx (nslots)\n-     int nslots;\n+void *\n+ggc_alloc_obj (size, zero)\n+     size_t size;\n+     int zero;\n {\n-  int size = sizeof(struct rtx_def) + (nslots - 1) * sizeof(rtunion);\n-  rtx n;\n-\n-  n = (rtx) xmalloc (size);\n-  bzero ((char *) n, size);\n-\n-  return n;\n-}\n-\n-rtvec\n-ggc_alloc_rtvec (nelt)\n-     int nelt;\n-{\n-  int size = sizeof (struct rtvec_def) + (nelt - 1) * sizeof (rtx);\n-  rtvec v;\n-\n-  v = (rtvec) xmalloc (size);\n-  bzero ((char *) v, size);\n-\n-  return v;\n+  void *p = xmalloc (size);\n+  if (zero)\n+    memset (p, 0, size);\n+  return p;\n }"}, {"sha": "048d130e07f5c06cd4025bfe408220f754c70199", "filename": "gcc/ggc-page.c", "status": "modified", "additions": 75, "deletions": 145, "changes": 220, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-page.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-page.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fggc-page.c?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -27,7 +27,9 @@\n #include \"flags.h\"\n #include \"ggc.h\"\n \n+#ifdef HAVE_MMAP\n #include <sys/mman.h>\n+#endif\n \n \n /* Stategy: \n@@ -111,10 +113,10 @@ char *empty_string;\n    significant PAGE_L2_BITS and PAGE_L1_BITS are the second and first\n    index values in the lookup table, respectively.  \n \n-   The topmost leftover bits, if any, are ignored.  For 32-bit\n-   architectures and the settings below, there are no leftover bits.\n-   For architectures with wider pointers, the lookup tree points to a\n-   list of pages, which must be scanned to find the correct one.  */\n+   For 32-bit architectures and the settings below, there are no\n+   leftover bits.  For architectures with wider pointers, the lookup\n+   tree points to a list of pages, which must be scanned to find the\n+   correct one.  */\n \n #define PAGE_L1_BITS\t(8)\n #define PAGE_L2_BITS\t(32 - PAGE_L1_BITS - G.lg_pagesize)\n@@ -178,8 +180,8 @@ typedef page_entry **page_table[PAGE_L1_SIZE];\n \n #else\n \n-/* On 64-bit hosts, we use two level page tables plus a linked list\n-   that disambiguates the top 32-bits.  There will almost always be\n+/* On 64-bit hosts, we use the same two level page tables plus a linked\n+   list that disambiguates the top 32-bits.  There will almost always be\n    exactly one entry in the list.  */\n typedef struct page_table_chain\n {\n@@ -221,7 +223,7 @@ static struct globals\n   unsigned char context_depth;\n \n   /* A file descriptor open to /dev/zero for reading.  */\n-#ifndef MAP_ANONYMOUS\n+#if defined (HAVE_MMAP) && !defined(MAP_ANONYMOUS)\n   int dev_zero_fd;\n #endif\n \n@@ -258,16 +260,13 @@ static struct globals\n #define GGC_MIN_LAST_ALLOCATED (4 * 1024 * 1024)\n \n \f\n-static page_entry *** ggc_lookup_page_table PROTO ((void));\n static int ggc_allocated_p PROTO ((const void *));\n-static page_entry *lookup_page_table_entry PROTO ((void *));\n+static page_entry *lookup_page_table_entry PROTO ((const void *));\n static void set_page_table_entry PROTO ((void *, page_entry *));\n static char *alloc_anon PROTO ((char *, size_t));\n static struct page_entry * alloc_page PROTO ((unsigned));\n static void free_page PROTO ((struct page_entry *));\n static void release_pages PROTO ((void));\n-static void *alloc_obj PROTO ((size_t, int));\n-static int mark_obj PROTO ((void *));\n static void clear_marks PROTO ((void));\n static void sweep_pages PROTO ((void));\n \n@@ -278,37 +277,31 @@ static void poison_pages PROTO ((void));\n \n void debug_print_page_list PROTO ((int));\n \f\n-/* Returns the lookup table appropriate for looking up P.  */\n+/* Returns non-zero if P was allocated in GC'able memory.  */\n \n-static inline page_entry ***\n-ggc_lookup_page_table ()\n+static inline int\n+ggc_allocated_p (p)\n+     const void *p;\n {\n   page_entry ***base;\n+  size_t L1, L2;\n \n #if HOST_BITS_PER_PTR <= 32\n   base = &G.lookup[0];\n #else\n   page_table table = G.lookup;\n   size_t high_bits = (size_t) p & ~ (size_t) 0xffffffff;\n-  while (table->high_bits != high_bits)\n-    table = table->next;\n+  while (1)\n+    {\n+      if (table == NULL)\n+\treturn 0;\n+      if (table->high_bits == high_bits)\n+\tbreak;\n+      table = table->next;\n+    }\n   base = &table->table[0];\n #endif\n \n-  return base;\n-}\n-\n-/* Returns non-zero if P was allocated in GC'able memory.  */\n-\n-static inline int\n-ggc_allocated_p (p)\n-     const void *p;\n-{\n-  page_entry ***base;\n-  size_t L1, L2;\n-\n-  base = ggc_lookup_page_table ();\n-\n   /* Extract the level 1 and 2 indicies.  */\n   L1 = LOOKUP_L1 (p);\n   L2 = LOOKUP_L2 (p);\n@@ -321,12 +314,20 @@ ggc_allocated_p (p)\n \n static inline page_entry *\n lookup_page_table_entry(p)\n-     void *p;\n+     const void *p;\n {\n   page_entry ***base;\n   size_t L1, L2;\n \n-  base = ggc_lookup_page_table ();\n+#if HOST_BITS_PER_PTR <= 32\n+  base = &G.lookup[0];\n+#else\n+  page_table table = G.lookup;\n+  size_t high_bits = (size_t) p & ~ (size_t) 0xffffffff;\n+  while (table->high_bits != high_bits)\n+    table = table->next;\n+  base = &table->table[0];\n+#endif\n \n   /* Extract the level 1 and 2 indicies.  */\n   L1 = LOOKUP_L1 (p);\n@@ -407,11 +408,12 @@ poison (start, len)\n    (if non-null).  */\n static inline char *\n alloc_anon (pref, size)\n-     char *pref;\n+     char *pref ATTRIBUTE_UNUSED;\n      size_t size;\n {\n   char *page;\n \n+#ifdef HAVE_MMAP\n #ifdef MAP_ANONYMOUS\n   page = (char *) mmap (pref, size, PROT_READ | PROT_WRITE,\n \t\t\tMAP_PRIVATE | MAP_ANONYMOUS, -1, 0);\n@@ -424,6 +426,16 @@ alloc_anon (pref, size)\n       fputs (\"Virtual memory exhausted!\\n\", stderr);\n       exit(1);\n     }\n+#else\n+#ifdef HAVE_VALLOC\n+  page = (char *) valloc (size);\n+  if (!page)\n+    {\n+      fputs (\"Virtual memory exhausted!\\n\", stderr);\n+      exit(1);\n+    }\n+#endif /* HAVE_VALLOC */\n+#endif /* HAVE_MMAP */\n \n   return page;\n }\n@@ -522,6 +534,7 @@ free_page (entry)\n static inline void\n release_pages ()\n {\n+#ifdef HAVE_MMAP\n   page_entry *p, *next;\n   char *start;\n   size_t len;\n@@ -553,6 +566,19 @@ release_pages ()\n     }\n \n   munmap (start, len);\n+#else\n+#ifdef HAVE_VALLOC\n+  page_entry *p, *next;\n+\n+  for (p = G.free_pages; p ; p = next)\n+    {\n+      next = p->next;\n+      free (p->page);\n+      free (p);\n+    }\n+#endif /* HAVE_VALLOC */\n+#endif /* HAVE_MMAP */\n+\n   G.free_pages = NULL;\n }\n \n@@ -582,8 +608,8 @@ static unsigned char const size_lookup[257] =\n \n /* Allocate a chunk of memory of SIZE bytes.  If ZERO is non-zero, the\n    memory is zeroed; otherwise, its contents are undefined.  */\n-static void *\n-alloc_obj (size, zero)\n+void *\n+ggc_alloc_obj (size, zero)\n      size_t size;\n      int zero;\n {\n@@ -700,8 +726,8 @@ alloc_obj (size, zero)\n /* If P is not marked, marks it and returns 0.  Otherwise returns 1.\n    P must have been allocated by the GC allocator; it mustn't point to\n    static objects, stack variables, or memory allocated with malloc.  */\n-static int\n-mark_obj (p)\n+int\n+ggc_set_mark (p)\n      void *p;\n {\n   page_entry *entry;\n@@ -738,6 +764,13 @@ mark_obj (p)\n   return 0;\n }\n \n+void\n+ggc_mark_if_gcable (p)\n+     void *p;\n+{\n+  if (p && ggc_allocated_p (p))\n+    ggc_set_mark (p);\n+}\n \f\n /* Initialize the ggc-mmap allocator.  */\n void\n@@ -746,7 +779,7 @@ init_ggc ()\n   G.pagesize = getpagesize();\n   G.lg_pagesize = exact_log2 (G.pagesize);\n \n-#ifndef MAP_ANONYMOUS\n+#if defined (HAVE_MMAP) && !defined(MAP_ANONYMOUS)\n   G.dev_zero_fd = open (\"/dev/zero\", O_RDONLY);\n   if (G.dev_zero_fd == -1)\n     abort ();\n@@ -812,64 +845,6 @@ ggc_pop_context ()\n \t}\n     }\n }\n-\n-\n-struct rtx_def *\n-ggc_alloc_rtx (nslots)\n-     int nslots;\n-{\n-  return (struct rtx_def *) \n-    alloc_obj (sizeof (struct rtx_def) + (nslots - 1) * sizeof (rtunion), 1);\n-}\n-\n-\n-struct rtvec_def *\n-ggc_alloc_rtvec (nelt)\n-     int nelt;\n-{\n-  return (struct rtvec_def *)\n-    alloc_obj (sizeof (struct rtvec_def) + (nelt - 1) * sizeof (rtx), 1);\n-}\n-\n-\n-union tree_node *\n-ggc_alloc_tree (length)\n-     int length;\n-{\n-  return (union tree_node *) alloc_obj (length, 1);\n-}\n-\n-\n-char *\n-ggc_alloc_string (contents, length)\n-     const char *contents;\n-     int length;\n-{\n-  char *string;\n-\n-  if (length < 0)\n-    {\n-      if (contents == NULL)\n-\treturn NULL;\n-      length = strlen (contents);\n-    }\n-\n-  string = (char *) alloc_obj (length + 1, 0);\n-  if (contents != NULL)\n-    memcpy (string, contents, length);\n-  string[length] = 0;\n-\n-  return string;\n-}\n-\n-\n-void *\n-ggc_alloc (size)\n-     size_t size;\n-{\n-  return alloc_obj (size, 0);\n-}\n-\n \f\n static inline void\n clear_marks ()\n@@ -1072,54 +1047,9 @@ ggc_collect ()\n   time = get_run_time () - time;\n   gc_time += time;\n \n-  time = (time + 500) / 1000;\n   if (!quiet_flag)\n-    fprintf (stderr, \"%luk in %d.%03d}\", \n-\t     (unsigned long) G.allocated / 1024, time / 1000, time % 1000);\n-}\n-\n-\n-int\n-ggc_set_mark_rtx (r)\n-     rtx r;\n-{\n-  return mark_obj (r);\n-}\n-\n-int\n-ggc_set_mark_rtvec (v)\n-     rtvec v;\n-{\n-  return mark_obj (v);\n-}\n-\n-int\n-ggc_set_mark_tree (t)\n-     tree t;\n-{\n-  return mark_obj (t);\n-}\n-\n-void\n-ggc_mark_string (s)\n-     char *s;\n-{\n-  if (s)\n-    mark_obj (s);\n-}\n-\n-void\n-ggc_mark_string_if_gcable (s)\n-     char *s;\n-{\n-  if (s && ggc_allocated_p (s))\n-    mark_obj (s);\n-}\n-\n-void \n-ggc_mark (p)\n-     void *p;\n-{\n-  if (p)\n-    mark_obj (p);\n+    {\n+      fprintf (stderr, \"%luk in %.3f}\", \n+\t       (unsigned long) G.allocated / 1024, time * 1e-6);\n+    }\n }"}, {"sha": "f665487cd5331a024e4ff3341a12206b7ff4dc6c", "filename": "gcc/ggc-simple.c", "status": "modified", "additions": 304, "deletions": 568, "changes": 872, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-simple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc-simple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fggc-simple.c?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -28,69 +28,74 @@\n #include \"hash.h\"\n #include \"ggc.h\"\n \n+#ifndef offsetof\n+#define offsetof(TYPE, MEMBER)\t((size_t) &((TYPE *)0)->MEMBER)\n+#endif\n+\n /* Debugging flags.  */\n \n /* Zap memory before freeing to catch dangling pointers.  */\n #define GGC_POISON\n \n-/* Log alloc and release.  Don't enable this unless you want a\n-   really really lot of data.  */\n-#undef GGC_DUMP\n+/* Collect statistics on how bushy the search tree is.  */\n+#undef GGC_BALANCE\n \n-/* Some magic tags for strings and anonymous memory, hoping to catch\n-   certain errors wrt marking memory.  */\n+/* Perform collection every time ggc_collect is invoked.  Otherwise,\n+   collection is performed only when a significant amount of memory\n+   has been allocated since the last collection.  */\n+#undef GGC_ALWAYS_COLLECT\n \n-#define IS_MARKED(X)\t\t((X) & 1)\n-#define IGNORE_MARK(X)\t\t((X) & -2)\n+/* Always verify that the to-be-marked memory is collectable.  */\n+#undef GGC_ALWAYS_VERIFY\n \n-#define GGC_STRING_MAGIC\t((unsigned int)0xa1b2c3d4)\n-#define GGC_STRING_MAGIC_MARK\t((unsigned int)0xa1b2c3d4 | 1)\n-\n-#define GGC_ANY_MAGIC\t\t((unsigned int)0xa9bacbdc)\n-#define GGC_ANY_MAGIC_MARK\t((unsigned int)0xa9bacbdc | 1)\n+#ifdef ENABLE_CHECKING\n+#define GGC_POISON\n+#define GGC_ALWAYS_COLLECT\n+#define GGC_ALWAYS_VERIFY\n+#endif\n \n /* Constants for general use.  */\n \n char *empty_string;\n+extern int gc_time;\n \n-/* Global lists of roots, rtxs, and trees.  */\n+#ifndef HOST_BITS_PER_PTR\n+#define HOST_BITS_PER_PTR  HOST_BITS_PER_LONG\n+#endif\n \n-struct ggc_rtx\n-{\n-  struct ggc_rtx *chain;\n-  struct rtx_def rtx;\n-};\n+/* We'd like a balanced tree, but we don't really want to pay for the\n+   cost of keeping the tree balanced.  We'll settle for the next best\n+   thing -- nearly balanced.\n \n-struct ggc_rtvec\n-{\n-  struct ggc_rtvec *chain;\n-  struct rtvec_def vec;\n-};\n+   In this context, the most natural key is the node pointer itself,\n+   but due to the way memory managers work, we'd be virtually certain\n+   to wind up with a completely degenerate straight line.  What's needed\n+   is to make something more variable, and yet predictable, be more\n+   significant in the comparison.\n \n-struct ggc_tree\n-{\n-  struct ggc_tree *chain;\n-  union tree_node tree;\n-};\n+   The handiest source of variability is the low bits of the pointer\n+   value itself.  Any sort of bit/byte swap would do, but such machine\n+   specific operations are not handy, and we don't want to put that much\n+   effort into it.  */\n \n-struct ggc_string\n-{\n-  struct ggc_string *chain;\n-  unsigned int magic_mark;\n-  char string[1];\n-};\n+#define PTR_KEY(p)\t((size_t)p << (HOST_BITS_PER_PTR - 8)\t\t    \\\n+\t\t\t | ((size_t)p & 0xff00) << (HOST_BITS_PER_PTR - 24) \\\n+\t\t\t | (size_t)p >> 16)\n \n-/* A generic allocation, with an external mark bit.  */\n+/* GC'able memory; a node in a binary search tree.  */\n \n-struct ggc_any\n+struct ggc_mem\n {\n-  struct ggc_any *chain;\n-  unsigned int magic_mark;\n+  /* A combination of the standard left/right nodes, indexable by `<'.  */\n+  struct ggc_mem *sub[2];\n+\n+  unsigned int mark : 1;\n+  unsigned int context : 7;\n+  unsigned int size : 24;\n \n   /* Make sure the data is reasonably aligned.  */\n   union {\n-    char c;\n-    HOST_WIDE_INT i;\n+    HOST_WIDEST_INT i;\n #ifdef HAVE_LONG_DOUBLE\n     long double d;\n #else\n@@ -99,642 +104,373 @@ struct ggc_any\n   } u;\n };\n \n-struct ggc_status\n+static struct globals\n {\n-  struct ggc_status *next;\n-  struct ggc_rtx *rtxs;\n-  struct ggc_rtvec *vecs;\n-  struct ggc_tree *trees;\n-  struct ggc_string *strings;\n-  struct ggc_any *anys;\n-  size_t bytes_alloced_since_gc;\n-};\n+  /* Root of the object tree.  */\n+  struct ggc_mem *root;\n \n-/* A chain of GGC contexts.  The currently active context is at the\n-   front of the chain.  */\n-static struct ggc_status *ggc_chain;\n+  /* Data bytes currently allocated.  */\n+  size_t allocated;\n \n-/* The table of all allocated strings.  Only valid during collection.  */\n-static varray_type ggc_allocated_strings;\n-static size_t ggc_strings_used;\n+  /* Data objects currently allocated.  */\n+  size_t objects;\n \n-/* Some statistics.  */\n+  /* Data bytes allocated at time of last GC.  */\n+  size_t allocated_last_gc;\n \n-static int n_rtxs_collected;\n-static int n_vecs_collected;\n-static int n_trees_collected;\n-static int n_strings_collected;\n-static int n_anys_collected;\n-extern int gc_time;\n+  /* Current context level.  */\n+  int context;\n+} G;\n \n-#ifdef GGC_DUMP\n-static FILE *dump;\n-#endif\n-\n-/* Local function prototypes.  */\n+/* Skip garbage collection if the current allocation is not at least\n+   this factor times the allocation at the end of the last collection.\n+   In other words, total allocation must expand by (this factor minus\n+   one) before collection is performed.  */\n+#define GGC_MIN_EXPAND_FOR_GC (1.3)\n \n-static void ggc_free_rtx PROTO ((struct ggc_rtx *r));\n-static void ggc_free_rtvec PROTO ((struct ggc_rtvec *v));\n-static void ggc_free_tree PROTO ((struct ggc_tree *t));\n-static void ggc_free_string PROTO ((struct ggc_string *s));\n-static void ggc_free_any PROTO ((struct ggc_any *a));\n-static int ggc_compare_addresses PROTO ((const void *, const void *));\n+/* Bound `allocated_last_gc' to 4MB, to prevent the memory expansion\n+   test from triggering too often when the heap is small.  */\n+#define GGC_MIN_LAST_ALLOCATED (4 * 1024 * 1024)\n \n-/* Called once to initialize the garbage collector.  */\n+/* Local function prototypes.  */\n \n-void \n-init_ggc PROTO ((void))\n-{\n-  /* Initialize the global context.  */\n-  ggc_push_context ();\n+static void tree_insert PROTO ((struct ggc_mem *));\n+static int tree_lookup PROTO ((struct ggc_mem *));\n+static void clear_marks PROTO ((struct ggc_mem *));\n+static void sweep_objs PROTO ((struct ggc_mem **));\n+static void ggc_pop_context_1 PROTO ((struct ggc_mem *, int));\n \n-#ifdef GGC_DUMP\n-  dump = fopen (\"zgcdump\", \"w\");\n-  setlinebuf (dump);\n+#ifdef GGC_BALANCE\n+extern void debug_ggc_balance PROTO ((void));\n+static void tally_leaves PROTO ((struct ggc_mem *, int, size_t *, size_t *));\n #endif\n \n-  empty_string = ggc_alloc_string (\"\", 0);\n-  ggc_add_string_root (&empty_string, 1);\n-}\n-\n-/* Start a new GGC context.  Memory allocated in previous contexts\n-   will not be collected while the new context is active.  */\n-\n-void\n-ggc_push_context PROTO ((void))\n-{\n-  struct ggc_status *gs = (struct ggc_status *) xcalloc (1, sizeof (*gs));\n-  gs->next = ggc_chain;\n-  ggc_chain = gs;\n-}\n-\n-/* Finish a GC context.  Any uncollected memory in the new context\n-   will be merged with the old context.  */\n+/* Insert V into the search tree.  */\n \n-void \n-ggc_pop_context PROTO ((void))\n+static inline void\n+tree_insert (v)\n+     struct ggc_mem *v;\n {\n-  struct ggc_rtx *r;\n-  struct ggc_rtvec *v;\n-  struct ggc_tree *t;\n-  struct ggc_string *s;\n-  struct ggc_any *a;\n-  struct ggc_status *gs;\n-\n-  gs = ggc_chain;\n+  size_t v_key = PTR_KEY (v);\n+  struct ggc_mem *p, **pp;\n \n-  r = gs->rtxs;\n-  if (r)\n-    {\n-      while (r->chain)\n-\tr = r->chain;\n-      r->chain = gs->next->rtxs;\n-      gs->next->rtxs = gs->rtxs;\n-    }\n-      \n-  v = gs->vecs;\n-  if (v)\n+  for (pp = &G.root, p = *pp; p ; p = *pp)\n     {\n-      while (v->chain)\n-\tv = v->chain;\n-      v->chain = gs->next->vecs;\n-      gs->next->vecs = gs->vecs;\n+      size_t p_key = PTR_KEY (p);\n+      pp = &p->sub[v_key < p_key];\n     }\n+  *pp = v;\n+}\n \n-  t = gs->trees;\n-  if (t)\n-    {\n-      while (t->chain)\n-\tt = t->chain;\n-      t->chain = gs->next->trees;\n-      gs->next->trees = gs->trees;\n-    }\n+/* Return true if V is in the tree.  */\n \n-  s = gs->strings;\n-  if (s)\n-    {\n-      while (s->chain)\n-\ts = s->chain;\n-      s->chain = gs->next->strings;\n-      gs->next->strings = gs->strings;\n-    }\n+static inline int\n+tree_lookup (v)\n+     struct ggc_mem *v;\n+{\n+  size_t v_key = PTR_KEY (v);\n+  struct ggc_mem *p = G.root;\n \n-  a = gs->anys;\n-  if (a)\n+  while (p)\n     {\n-     while (a->chain)\n-       a = a->chain;\n-      a->chain = gs->next->anys;\n-      gs->next->anys = gs->anys;\n+      size_t p_key = PTR_KEY (p);\n+      if (p == v)\n+\treturn 1;\n+      p = p->sub[v_key < p_key];\n     }\n \n-  gs->next->bytes_alloced_since_gc += gs->bytes_alloced_since_gc;\n-\n-  ggc_chain = gs->next;\n-  free (gs);\n+  return 0;\n }\n \n-/* These allocators are dreadfully simple, with no caching whatsoever so\n-   that Purify-like tools that do allocation versioning can catch errors.\n-   This collector is never going to go fast anyway.  */\n+/* Alloc SIZE bytes of GC'able memory.  If ZERO, clear the memory.  */\n \n-rtx\n-ggc_alloc_rtx (nslots)\n-     int nslots;\n+void *\n+ggc_alloc_obj (size, zero)\n+     size_t size;\n+     int zero;\n {\n-  struct ggc_rtx *n;\n-  int size = sizeof(*n) + (nslots-1) * sizeof(rtunion);\n+  struct ggc_mem *x;\n \n-  n = (struct ggc_rtx *) xcalloc (1, size);\n-  n->chain = ggc_chain->rtxs;\n-  ggc_chain->rtxs = n;\n+  x = (struct ggc_mem *) xmalloc (offsetof (struct ggc_mem, u) + size);\n+  x->sub[0] = NULL;\n+  x->sub[1] = NULL;\n+  x->mark = 0;\n+  x->context = G.context;\n+  x->size = size;\n \n-#ifdef GGC_DUMP\n-  fprintf (dump, \"alloc rtx %p\\n\", &n->rtx);\n-#endif\n+  if (zero)\n+    memset (&x->u, 0, size);\n \n-  ggc_chain->bytes_alloced_since_gc += size;\n+  tree_insert (x);\n+  G.allocated += size;\n+  G.objects += 1;\n \n-  return &n->rtx;\n+  return &x->u;\n }\n \n-rtvec\n-ggc_alloc_rtvec (nelt)\n-     int nelt;\n-{\n-  struct ggc_rtvec *v;\n-  int size = sizeof (*v) + (nelt - 1) * sizeof (rtx);\n-\n-  v = (struct ggc_rtvec *) xcalloc (1, size);\n-  v->chain = ggc_chain->vecs;\n-  ggc_chain->vecs = v;\n-\n-#ifdef GGC_DUMP\n-  fprintf(dump, \"alloc vec %p\\n\", &v->vec);\n-#endif\n-\n-  ggc_chain->bytes_alloced_since_gc += size;\n-\n-  return &v->vec;\n-}\n+/* Mark a node.  */\n \n-tree\n-ggc_alloc_tree (length)\n-     int length;\n+int\n+ggc_set_mark (p)\n+     void *p;\n {\n-  struct ggc_tree *n;\n-  int size = sizeof(*n) - sizeof(n->tree) + length;\n-\n-  n = (struct ggc_tree *) xcalloc (1, size);\n-  n->chain = ggc_chain->trees;\n-  ggc_chain->trees = n;\n+  struct ggc_mem *x;\n \n-#ifdef GGC_DUMP\n-  fprintf(dump, \"alloc tree %p\\n\", &n->tree);\n+  x = (struct ggc_mem *) ((char *)p - offsetof (struct ggc_mem, u));\n+#ifdef GGC_ALWAYS_VERIFY\n+  if (! tree_lookup (x))\n+    abort ();\n #endif\n \n-  ggc_chain->bytes_alloced_since_gc += size;\n-\n-  return &n->tree;\n-}\n-\n-char *\n-ggc_alloc_string (contents, length)\n-     const char *contents;\n-     int length;\n-{\n-  struct ggc_string *s;\n-  int size;\n-\n-  if (length < 0)\n-    {\n-      if (contents == NULL)\n-\treturn NULL;\n-      length = strlen (contents);\n-    }\n-\n-  size = (s->string - (char *)s) + length + 1;\n-  s = (struct ggc_string *) xmalloc (size);\n-  s->chain = ggc_chain->strings;\n-  s->magic_mark = GGC_STRING_MAGIC;\n-  ggc_chain->strings = s;\n-\n-  if (contents)\n-    memcpy (s->string, contents, length);\n-  s->string[length] = 0;\n-\n-#ifdef GGC_DUMP\n-  fprintf(dump, \"alloc string %p\\n\", &s->string);\n-#endif\n+  if (x->mark)\n+    return 1;\n \n-  ggc_chain->bytes_alloced_since_gc += size;\n+  x->mark = 1;\n+  G.allocated += x->size;\n+  G.objects += 1;\n \n-  return s->string;\n+  return 0;\n }\n \n-/* Like xmalloc, but allocates GC-able memory.  */\n-\n-void *\n-ggc_alloc (bytes)\n-     size_t bytes;\n+void\n+ggc_mark_if_gcable (p)\n+     void *p;\n {\n-  struct ggc_any *a;\n+  struct ggc_mem *x;\n \n-  if (bytes == 0)\n-    bytes = 1;\n-  bytes += (&((struct ggc_any *) 0)->u.c - (char *) 0);\n+  if (p == NULL)\n+    return;\n \n-  a = (struct ggc_any *) xmalloc (bytes);\n-  a->chain = ggc_chain->anys;\n-  a->magic_mark = GGC_ANY_MAGIC;\n-  ggc_chain->anys = a;\n+  x = (struct ggc_mem *) ((char *)p - offsetof (struct ggc_mem, u));\n+  if (! tree_lookup (x))\n+    return;\n \n-  ggc_chain->bytes_alloced_since_gc += bytes;\n+  if (x->mark)\n+    return;\n \n-  return &a->u;\n+  x->mark = 1;\n+  G.allocated += x->size;\n+  G.objects += 1;\n }\n \n-/* Freeing a bit of rtl is as simple as calling free.  */\n-\n-static inline void\n-ggc_free_rtx (r)\n-     struct ggc_rtx *r;\n+static void\n+clear_marks (x)\n+     struct ggc_mem *x;\n {\n-#ifdef GGC_DUMP\n-  fprintf (dump, \"collect rtx %p\\n\", &r->rtx);\n-#endif\n-#ifdef GGC_POISON\n-  memset (r, 0xAA, sizeof(*r) + ((GET_RTX_LENGTH (r->rtx.code) -1)\n-\t\t\t\t * sizeof(rtunion)));\n-#endif\n-\n-  free (r);\n+  x->mark = 0;\n+  if (x->sub[0])\n+    clear_marks (x->sub[0]);\n+  if (x->sub[1])\n+    clear_marks (x->sub[1]);\n }\n \n-/* Freeing an rtvec is as simple as calling free.  */\n-\n-static inline void\n-ggc_free_rtvec (v)\n-     struct ggc_rtvec *v;\n+static void\n+sweep_objs (root)\n+     struct ggc_mem **root;\n {\n-#ifdef GGC_DUMP\n-  fprintf(dump, \"collect vec %p\\n\", &v->vec);\n-#endif\n-#ifdef GGC_POISON\n-  memset (v, 0xBB, sizeof (*v) + ((GET_NUM_ELEM (&v->vec) - 1)\n-\t\t\t\t  * sizeof (rtx)));\n-#endif\n+  struct ggc_mem *x = *root;\n+  if (!x)\n+    return;\n \n-  free (v);\n-}\n+  sweep_objs (&x->sub[0]);\n+  sweep_objs (&x->sub[1]);\n \n-/* Freeing a tree node is almost, but not quite, as simple as calling free.\n-   Mostly we need to let the language clean up its lang_specific bits.  */\n+  if (! x->mark && x->context >= G.context)\n+    {\n+      struct ggc_mem *l, *r;\n+\n+      l = x->sub[0];\n+      r = x->sub[1];\n+      if (!l)\n+\t*root = r;\n+      else if (!r)\n+\t*root = l;\n+      else if (!l->sub[1])\n+\t{\n+\t  *root = l;\n+\t  l->sub[1] = r;\n+\t}\n+      else if (!r->sub[0])\n+\t{\n+\t  *root = r;\n+\t  r->sub[0] = l;\n+\t}\n+      else\n+\t{\n+\t  *root = l;\n+\t  do {\n+\t    root = &l->sub[1];\n+\t  } while ((l = *root) != NULL);\n+\t  *root = r;\n+\t}\n \n-static inline void\n-ggc_free_tree (t)\n-     struct ggc_tree *t;\n-{\n-#ifdef GGC_DUMP\n-  fprintf (dump, \"collect tree %p\\n\", &t->tree);\n-#endif\n #ifdef GGC_POISON\n-  memset(&t->tree.common, 0xCC, sizeof(t->tree.common));\n+      memset (&x->u, 0xA5, x->size);\n #endif\n \n-  free (t);\n+      free (x);\n+    }\n }\n \n-/* Freeing a string is as simple as calling free.  */\n+/* The top level mark-and-sweep routine.  */\n \n-static inline void\n-ggc_free_string (s)\n-     struct ggc_string *s;\n+void\n+ggc_collect ()\n {\n-#ifdef GGC_DUMP\n-  fprintf(dump, \"collect string %p\\n\", s->string);\n-#endif\n-#ifdef GGC_POISON\n-  s->magic_mark = 0xDDDDDDDD;\n-  s->string[0] = 0xDD;\n+  int time;\n+\n+#ifndef GGC_ALWAYS_COLLECT\n+  if (G.allocated < GGC_MIN_EXPAND_FOR_GC * G.allocated_last_gc)\n+    return;\n #endif\n \n-  free (s);\n-}\n+#ifdef GGC_BALANCE\n+  debug_ggc_balance ();\n+#endif\n \n-/* Freeing anonymous memory is as simple as calling free.  */\n+  time = get_run_time ();\n+  if (!quiet_flag)\n+    fprintf (stderr, \" {GC %luk -> \", (unsigned long)G.allocated / 1024);\n \n-static inline void\n-ggc_free_any (a)\n-     struct ggc_any *a;\n-{\n-#ifdef GGC_DUMP\n-  fprintf(dump, \"collect mem %p\\n\", &a->u);\n-#endif\n-#ifdef GGC_POISON\n-  a->magic_mark = 0xEEEEEEEE;\n-#endif\n+  G.allocated = 0;\n+  G.objects = 0;\n \n-  free (a);\n-}\n+  clear_marks (G.root);\n+  ggc_mark_roots ();\n+  sweep_objs (&G.root);\n \n-/* Mark a node.  */\n+  G.allocated_last_gc = G.allocated;\n+  if (G.allocated_last_gc < GGC_MIN_LAST_ALLOCATED)\n+    G.allocated_last_gc = GGC_MIN_LAST_ALLOCATED;\n \n-int\n-ggc_set_mark_rtx (r)\n-     rtx r;\n-{\n-  int marked = r->gc_mark;\n-  if (! marked)\n-    r->gc_mark = 1;\n-  return marked;\n-}\n+  time = get_run_time () - time;\n+  gc_time += time;\n \n-int\n-ggc_set_mark_rtvec (v)\n-     rtvec v;\n-{\n-  int marked = v->gc_mark;\n-  if (! marked)\n-    v->gc_mark = 1;\n-  return marked;\n-}\n+  if (!quiet_flag)\n+    {\n+      fprintf (stderr, \"%luk in %.3f}\", \n+\t       (unsigned long) G.allocated / 1024, time * 1e-6);\n+    }\n \n-int\n-ggc_set_mark_tree (t)\n-     tree t;\n-{\n-  int marked = t->common.gc_mark;\n-  if (! marked)\n-    t->common.gc_mark = 1;\n-  return marked;\n+#ifdef GGC_BALANCE\n+  debug_ggc_balance ();\n+#endif\n }\n \n-/* Compare the pointers pointed to by A1 and A2.  Used as a callback\n-   for qsort/bsearch.  */\n+/* Called once to initialize the garbage collector.  */\n \n-static int\n-ggc_compare_addresses (a1, a2)\n-     const void *a1;\n-     const void *a2;\n+void \n+init_ggc ()\n {\n-  const char *c1 = *((const char **) a1);\n-  const char *c2 = *((const char **) a2);\n+  G.allocated_last_gc = GGC_MIN_LAST_ALLOCATED;\n \n-  if (c1 < c2)\n-    return -1;\n-  else if (c1 > c2)\n-    return 1;\n-  else\n-    return 0;\n+  empty_string = ggc_alloc_string (\"\", 0);\n+  ggc_add_string_root (&empty_string, 1);\n }\n \n+/* Start a new GGC context.  Memory allocated in previous contexts\n+   will not be collected while the new context is active.  */\n+\n void\n-ggc_mark_string (s)\n-     char *s;\n+ggc_push_context ()\n {\n-  const ptrdiff_t d = (((struct ggc_string *) 0)->string - (char *) 0);\n-  struct ggc_string *gs;\n+  G.context++;\n \n-  if (s == NULL)\n-    return;\n-\n-  gs = (struct ggc_string *)(s - d);\n-  if (IGNORE_MARK (gs->magic_mark) != GGC_STRING_MAGIC)\n-    return;   /* abort? */\n-  gs->magic_mark = GGC_STRING_MAGIC_MARK;\n+  /* We only allocated 7 bits in the node for the context.  This\n+     should be more than enough.  */\n+  if (G.context >= 128)\n+    abort ();\n }\n \n+/* Finish a GC context.  Any uncollected memory in the new context\n+   will be merged with the old context.  */\n \n-void\n-ggc_mark_string_if_gcable (s)\n-     char *s;\n+void \n+ggc_pop_context ()\n {\n-  if (s && !bsearch (&s, \n-\t\t     &VARRAY_CHAR_PTR (ggc_allocated_strings, 0),\n-\t\t     ggc_strings_used, sizeof (char *),\n-\t\t     ggc_compare_addresses))\n-    return;\n-\n-  ggc_mark_string (s);\n+  G.context--;\n+  if (G.root)\n+    ggc_pop_context_1 (G.root, G.context);\n }\n \n-\n-/* Mark P, allocated with ggc_alloc.  */\n-\n-void\n-ggc_mark (p)\n-     void *p;\n+static void\n+ggc_pop_context_1 (x, c)\n+     struct ggc_mem *x;\n+     int c;\n {\n-  const ptrdiff_t d = (&((struct ggc_any *) 0)->u.c - (char *) 0);\n-  struct ggc_any *a;\n-\n-  if (p == NULL)\n-    return;\n-\n-  a = (struct ggc_any *) (((char*) p) - d);\n-  if (IGNORE_MARK (a->magic_mark) != GGC_ANY_MAGIC)\n-    abort ();\n-  a->magic_mark = GGC_ANY_MAGIC_MARK;\n+  if (x->context > c)\n+    x->context = c;\n+  if (x->sub[0])\n+    ggc_pop_context_1 (x->sub[0], c);\n+  if (x->sub[1])\n+    ggc_pop_context_1 (x->sub[1], c);\n }\n \n-/* The top level mark-and-sweep routine.  */\n+/* Dump a tree.  */\n \n void\n-ggc_collect ()\n+debug_ggc_tree (p, indent)\n+     struct ggc_mem *p;\n+     int indent;\n {\n-  struct ggc_rtx *r, **rp;\n-  struct ggc_rtvec *v, **vp;\n-  struct ggc_tree *t, **tp;\n-  struct ggc_string *s, **sp;\n-  struct ggc_status *gs;\n-  struct ggc_any *a, **ap;\n-  int time, n_rtxs, n_trees, n_vecs, n_strings, n_anys;\n-\n-#if !defined(ENABLE_CHECKING)\n-  /* See if it's even worth our while.  */\n-  if (ggc_chain->bytes_alloced_since_gc < 4*1024*1024)\n-    return;\n-#endif\n-\n-  if (!quiet_flag)\n-    fputs (\" {GC \", stderr);\n-\n-  time = get_run_time ();\n-\n-  /* Set up the table of allocated strings.  */\n-  VARRAY_CHAR_PTR_INIT (ggc_allocated_strings, 1024, \"allocated strings\");\n-  ggc_strings_used = 0;\n-\n-  /* Clean out all of the GC marks.  */\n-  for (gs = ggc_chain; gs; gs = gs->next)\n-    {\n-      for (r = gs->rtxs; r != NULL; r = r->chain)\n-\tr->rtx.gc_mark = 0;\n-      for (v = gs->vecs; v != NULL; v = v->chain)\n-\tv->vec.gc_mark = 0;\n-      for (t = gs->trees; t != NULL; t = t->chain)\n-\tt->tree.common.gc_mark = 0;\n-      for (s = gs->strings; s != NULL; s = s->chain)\n-\t{\n-\t  s->magic_mark = GGC_STRING_MAGIC;\n-\t  if (ggc_strings_used == ggc_allocated_strings->num_elements)\n-\t    VARRAY_GROW (ggc_allocated_strings, 2 * ggc_strings_used);\n-\t  VARRAY_CHAR_PTR (ggc_allocated_strings, ggc_strings_used)\n-\t    = &s->string[0];\n-\t  ++ggc_strings_used;\n-\t}\n-      for (a = gs->anys; a != NULL; a = a->chain)\n-\ta->magic_mark = GGC_ANY_MAGIC;\n-    }\n-\n-  /* Sort the allocated string table.  */\n-  qsort (&VARRAY_CHAR_PTR (ggc_allocated_strings, 0),\n-\t ggc_strings_used, sizeof (char *),\n-\t ggc_compare_addresses);\n-\n-  ggc_mark_roots ();\n+  int i;\n \n-  /* Free the string table.  */\n-  VARRAY_FREE (ggc_allocated_strings);\n-\n-  /* Sweep the resulting dead nodes.  */\n-\n-  /* The RTXs.  */\n-\n-  rp = &ggc_chain->rtxs;\n-  r = ggc_chain->rtxs;\n-  n_rtxs = 0;\n-  while (r != NULL)\n+  if (!p)\n     {\n-      struct ggc_rtx *chain = r->chain;\n-      if (!r->rtx.gc_mark)\n-        {\n-\t  ggc_free_rtx (r);\n-\t  *rp = chain;\n-\t  n_rtxs++;\n-        }\n-      else\n-\trp = &r->chain;\n-      r = chain;\n+      fputs (\"(nil)\\n\", stderr);\n+      return;\n     }\n-  *rp = NULL;\n-  n_rtxs_collected += n_rtxs;\n \n-  /* The vectors.  */\n+  if (p->sub[0])\n+    debug_ggc_tree (p->sub[0], indent + 1);\n \n-  vp = &ggc_chain->vecs;\n-  v = ggc_chain->vecs;\n-  n_vecs = 0;\n-  while (v != NULL)\n-    {\n-      struct ggc_rtvec *chain = v->chain;\n-      if (!v->vec.gc_mark)\n-        {\n-\t  ggc_free_rtvec (v);\n-\t  *vp = chain;\n-\t  n_vecs++;\n-        }\n-      else\n-\tvp = &v->chain;\n-      v = chain;\n-    }\n-  *vp = NULL;\n-  n_vecs_collected += n_vecs;\n-\n-  /* The trees.  */\n-\n-  tp = &ggc_chain->trees;\n-  t = ggc_chain->trees;\n-  n_trees = 0;\n-  while (t != NULL)\n-    {\n-      struct ggc_tree *chain = t->chain;\n-      if (!t->tree.common.gc_mark)\n-        {\n-\t  ggc_free_tree (t);\n-\t  *tp = chain;\n-\t  n_trees++;\n-        }\n-      else\n-\ttp = &t->chain;\n-      t = chain;\n-    }\n-  *tp = NULL;\n-  n_trees_collected += n_trees;\n-\n-  /* The strings.  */\n+  for (i = 0; i < indent; ++i)\n+    putc (' ', stderr);\n+  fprintf (stderr, \"%lx %p\\n\", PTR_KEY (p), p);\n+ \n+  if (p->sub[1])\n+    debug_ggc_tree (p->sub[1], indent + 1);\n+}\n \n-  sp = &ggc_chain->strings;\n-  s = ggc_chain->strings;\n-  n_strings = 0;\n-  while (s != NULL)\n-    {\n-      struct ggc_string *chain = s->chain;\n-      if (! IS_MARKED (s->magic_mark))\n-        {\n-\t  ggc_free_string (s);\n-\t  *sp = chain;\n-\t  n_strings++;\n-        }\n-      else\n-\tsp = &s->chain;\n-      s = chain;\n-    }\n-  *sp = NULL;\n-  n_strings_collected += n_strings;\n+#ifdef GGC_BALANCE\n+/* Collect tree balance metrics  */\n \n-  /* The generic data.  */\n+#include <math.h>\n \n-  ap = &ggc_chain->anys;\n-  a = ggc_chain->anys;\n-  n_anys = 0;\n-  while (a != NULL)\n-    {\n-      struct ggc_any *chain = a->chain;\n-      if (! IS_MARKED (a->magic_mark))\n-\t{\n-\t  ggc_free_any (a);\n-\t  *ap = chain;\n-\t  n_anys++;\n-\t}\n-      else\n-\tap = &a->chain;\n-      a = chain;\n-    }\n-  n_anys_collected += n_anys;\n+void\n+debug_ggc_balance ()\n+{\n+  size_t nleaf, sumdepth;\n \n-  ggc_chain->bytes_alloced_since_gc = 0;\n+  nleaf = sumdepth = 0;\n+  tally_leaves (G.root, 0, &nleaf, &sumdepth);\n \n-  time = get_run_time () - time;\n-  gc_time += time;\n-\n-  if (!quiet_flag)\n-    {\n-      time = (time + 500) / 1000;\n-      fprintf (stderr, \"%dr,%dv,%dt,%ds,%da %d.%03d}\", n_rtxs, n_vecs, \n-\t       n_trees, n_strings, n_anys, time / 1000, time % 1000);\n-    }\n+  fprintf (stderr, \" {B %.2f,%.1f,%.1f}\",\n+\t   /* In a balanced tree, leaf/node should approach 1/2.  */\n+\t   (float)nleaf / (float)G.objects,\n+\t   /* In a balanced tree, average leaf depth should approach lg(n).  */\n+\t   (float)sumdepth / (float)nleaf,\n+\t   log ((double) G.objects) / M_LN2);\n }\n \n-#if 0\n-/* GDB really should have a memory search function.  Since this is just\n-   for initial debugging, I won't even pretend to get the __data_start\n-   to work on any but alpha-dec-linux-gnu.  */\n-static void **\n-search_data(void **start, void *target)\n+static void\n+tally_leaves (x, depth, nleaf, sumdepth)\n+     struct ggc_mem *x;\n+     int depth;\n+     size_t *nleaf;\n+     size_t *sumdepth;\n {\n-  extern void *__data_start[];\n-  void **_end = (void **)sbrk(0);\n-\n-  if (start == NULL)\n-    start = __data_start;\n-  while (start < _end)\n+  if (! x->sub[0] && !x->sub[1])\n+    {\n+      *nleaf += 1;\n+      *sumdepth += depth;\n+    }\n+  else\n     {\n-      if (*start == target)\n-        return start;\n-      start++;\n+      if (x->sub[0])\n+\ttally_leaves (x->sub[0], depth + 1, nleaf, sumdepth);\n+      if (x->sub[1])\n+\ttally_leaves (x->sub[1], depth + 1, nleaf, sumdepth);\n     }\n-  return NULL;\n }\n #endif"}, {"sha": "b2cfb279a5c6dfbf427b0bb4a38c25a345030a09", "filename": "gcc/ggc.h", "status": "modified", "additions": 56, "deletions": 27, "changes": 83, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Fggc.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fggc.h?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -56,34 +56,52 @@ void ggc_del_root PROTO ((void *base));\n \n /* Mark nodes from the gc_add_root callback.  These functions follow\n    pointers to mark other objects too.  */\n-extern void ggc_mark_rtvec PROTO ((struct rtvec_def *));\n extern void ggc_mark_tree_varray PROTO ((struct varray_head_tag *));\n extern void ggc_mark_tree_hash_table PROTO ((struct hash_table *));\n-extern void ggc_mark_string PROTO ((char *));\n-extern void ggc_mark PROTO ((void *));\n extern void ggc_mark_roots PROTO((void));\n \n extern void ggc_mark_rtx_children PROTO ((struct rtx_def *));\n+extern void ggc_mark_rtvec_children PROTO ((struct rtvec_def *));\n extern void ggc_mark_tree_children PROTO ((union tree_node *));\n \n-/* Mark the string, but only if it was allocated in collectable\n-   memory.  */\n-extern void ggc_mark_string_if_gcable PROTO ((char *));\n+#define ggc_mark_rtx(EXPR)\t\t\t\\\n+  do {\t\t\t\t\t\t\\\n+    rtx r__ = (EXPR);\t\t\t\t\\\n+    if (r__ != NULL && ! ggc_set_mark (r__))\t\\\n+      ggc_mark_rtx_children (r__);\t\t\\\n+  } while (0)\n+\n+#define ggc_mark_tree(EXPR)\t\t\t\\\n+  do {\t\t\t\t\t\t\\\n+    tree t__ = (EXPR);\t\t\t\t\\\n+    if (t__ != NULL && ! ggc_set_mark (t__))\t\\\n+      ggc_mark_tree_children (t__);\t\t\\\n+  } while (0)\n \n-#define ggc_mark_rtx(RTX_EXPR)\t\t\t\t\\\n-  do {\t\t\t\t\t\t\t\\\n-    rtx r__ = (RTX_EXPR);\t\t\t\t\\\n-    if (r__ != NULL && ! ggc_set_mark_rtx (r__))\t\\\n-      ggc_mark_rtx_children (r__);\t\t\t\\\n+#define ggc_mark_rtvec(EXPR)\t\t\t\\\n+  do {\t\t\t\t\t\t\\\n+    rtvec v__ = (EXPR);\t\t\t\t\\\n+    if (v__ != NULL && ! ggc_set_mark (v__))\t\\\n+      ggc_mark_rtvec_children (v__);\t\t\\\n   } while (0)\n \n-#define ggc_mark_tree(TREE_EXPR)\t\t\t\\\n-  do {\t\t\t\t\t\t\t\\\n-    tree t__ = (TREE_EXPR);\t\t\t\t\\\n-    if (t__ != NULL && ! ggc_set_mark_tree (t__))\t\\\n-      ggc_mark_tree_children (t__);\t\t\t\\\n+#define ggc_mark_string(EXPR)\t\t\t\\\n+  do {\t\t\t\t\t\t\\\n+    char *s__ = (EXPR);\t\t\t\t\\\n+    if (s__ != NULL)\t\t\t\t\\\n+      ggc_set_mark (s__);\t\t\t\\\n   } while (0)\n \n+#define ggc_mark(EXPR)\t\t\t\t\\\n+  do {\t\t\t\t\t\t\\\n+    void *a__ = (EXPR);\t\t\t\t\\\n+    if (a__ != NULL)\t\t\t\t\\\n+      ggc_set_mark (a__);\t\t\t\\\n+  } while (0)\n+\n+/* Mark, but only if it was allocated in collectable memory.  */\n+extern void ggc_mark_if_gcable PROTO ((void *));\n+\n /* A GC implementation must provide these functions.  */\n \n /* Initialize the garbage collector.   */\n@@ -98,24 +116,35 @@ extern void ggc_push_context PROTO ((void));\n extern void ggc_pop_context PROTO ((void));\n \n /* Allocation.  */\n-struct rtx_def *ggc_alloc_rtx PROTO ((int nslots));\n-struct rtvec_def *ggc_alloc_rtvec PROTO ((int nelt));\n-union tree_node *ggc_alloc_tree PROTO ((int length));\n+\n+/* The internal primitive.  */\n+void *ggc_alloc_obj PROTO ((size_t, int));\n+\n+#define ggc_alloc_rtx(NSLOTS)\t\t\t\t\t\t     \\\n+  ((struct rtx_def *) ggc_alloc_obj (sizeof (struct rtx_def)\t\t     \\\n+\t\t\t\t     + ((NSLOTS) - 1) * sizeof (rtunion), 1))\n+\n+#define ggc_alloc_rtvec(NELT)\t\t\t\t\t\t  \\\n+  ((struct rtvec_def *) ggc_alloc_obj (sizeof (struct rtvec_def)\t  \\\n+\t\t\t\t       + ((NELT) - 1) * sizeof (rtx), 1))\n+\n+#define ggc_alloc_tree(LENGTH)\t\t\t\t\\\n+  ((union tree_node *) ggc_alloc_obj ((LENGTH), 1))\n+\n+#define ggc_alloc(SIZE)  ggc_alloc_obj((SIZE), 0)\n+\n char *ggc_alloc_string PROTO ((const char *contents, int length));\n-void *ggc_alloc PROTO ((size_t));\n \n /* Invoke the collector.  This is really just a hint, but in the case of\n    the simple collector, the only time it will happen.  */\n void ggc_collect PROTO ((void));\n \n /* Actually set the mark on a particular region of memory, but don't\n-   follow pointers.  These functions are called by ggc_mark_*.  They\n-   return zero if the object was not previously marked; they return\n-   non-zero if the object was already marked, or if, for any other\n-   reason, pointers in this data structure should not be traversed.  */\n-int ggc_set_mark_rtx PROTO ((struct rtx_def *));\n-int ggc_set_mark_rtvec PROTO ((struct rtvec_def *));\n-int ggc_set_mark_tree PROTO ((union tree_node *));\n+   follow pointers.  This function is called by ggc_mark_*.  It\n+   returns zero if the object was not previously marked; non-zero if\n+   the object was already marked, or if, for any other reason,\n+   pointers in this data structure should not be traversed.  */\n+int ggc_set_mark PROTO ((void *));\n \n /* Callbacks to the languages.  */\n "}, {"sha": "a234b62b6cf2feeeaf8c4fd8d383ef72e0987fe0", "filename": "gcc/rtl.h", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Frtl.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Frtl.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frtl.h?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -102,18 +102,15 @@ typedef struct rtx_def\n {\n #ifdef ONLY_INT_FIELDS\n #ifdef CODE_FIELD_BUG\n-  unsigned int code : 15;\n+  unsigned int code : 16;\n #else\n   unsigned short code;\n #endif\n #else\n   /* The kind of expression this is.  */\n-  enum rtx_code code : 15;\n+  enum rtx_code code : 16;\n #endif\n \n-  /* Used by the garbage collector.  */\n-  unsigned gc_mark : 1;\n-\n   /* The kind of value the expression has.  */\n #ifdef ONLY_INT_FIELDS\n   int mode : 8;\n@@ -207,7 +204,6 @@ typedef struct rtx_def\n \n typedef struct rtvec_def{\n   int num_elem;\t\t/* number of elements */\n-  int gc_mark;\n   struct rtx_def *elem[1];\n } *rtvec;\n "}, {"sha": "0c181a4e87bb525615470cc20745d3dd09bac7f2", "filename": "gcc/tree.h", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Ftree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/005537dfed601a7ec39b4d40f9d0e3bc954f167f/gcc%2Ftree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.h?ref=005537dfed601a7ec39b4d40f9d0e3bc954f167f", "patch": "@@ -203,9 +203,7 @@ struct tree_common\n   unsigned lang_flag_5 : 1;\n   unsigned lang_flag_6 : 1;\n \n-  unsigned gc_mark : 1;\n-\n-  /* There is room for two more flags.  */\n+  /* There is room for three more flags.  */\n };\n \n /* The following table lists the uses of each of the above flags and"}]}