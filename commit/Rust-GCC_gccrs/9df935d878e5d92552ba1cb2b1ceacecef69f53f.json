{"sha": "9df935d878e5d92552ba1cb2b1ceacecef69f53f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWRmOTM1ZDg3OGU1ZDkyNTUyYmExY2IyYjFjZWFjZWNlZjY5ZjUzZg==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2005-02-03T15:26:29Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2005-02-03T15:26:29Z"}, "message": "re PR tree-optimization/19768 (ICE: SSA_NAME_OCCURS_IN_ABNORMAL_PHI should be set)\n\n2005-02-03  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR tree-opt/19768\n        * g++.dg/opt/pr19768.C: New test.\n\n2005-02-03  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR tree-opt/19768\n        * tree-ssa-dse.c (fix_phi_uses): Update the occurs in abnormal\n        phi flag if the phi is abnormal.\n\nFrom-SVN: r94660", "tree": {"sha": "8d0cb048bbf0e64849c2cdd95b38cf3e6d525b61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8d0cb048bbf0e64849c2cdd95b38cf3e6d525b61"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9df935d878e5d92552ba1cb2b1ceacecef69f53f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9df935d878e5d92552ba1cb2b1ceacecef69f53f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9df935d878e5d92552ba1cb2b1ceacecef69f53f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9df935d878e5d92552ba1cb2b1ceacecef69f53f/comments", "author": null, "committer": null, "parents": [{"sha": "da99298d7f41f4f40cc76b9767b22825c3105019", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da99298d7f41f4f40cc76b9767b22825c3105019", "html_url": "https://github.com/Rust-GCC/gccrs/commit/da99298d7f41f4f40cc76b9767b22825c3105019"}], "stats": {"total": 55, "additions": 53, "deletions": 2}, "files": [{"sha": "c7b41ad29ef1a3c6750256989e905ac3dbd5e4d1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9df935d878e5d92552ba1cb2b1ceacecef69f53f", "patch": "@@ -1,3 +1,9 @@\n+2005-02-03  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR tree-opt/19768\n+\t* tree-ssa-dse.c (fix_phi_uses): Update the occurs in abnormal\n+\tphi flag if the phi is abnormal.\n+\n 2005-02-03  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \tPR tree-opt/19736"}, {"sha": "608b077b2337b75595cb4b18fedb17fcc7409072", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9df935d878e5d92552ba1cb2b1ceacecef69f53f", "patch": "@@ -1,3 +1,8 @@\n+2005-02-03  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR tree-opt/19768\n+\t* g++.dg/opt/pr19768.C: New test.\n+\n 2005-02-03  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \tPR tree-opt/19736"}, {"sha": "376ca99384213ee1c566e2ecafdd4f441c44d268", "filename": "gcc/testsuite/g++.dg/opt/pr19768.C", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr19768.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr19768.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fopt%2Fpr19768.C?ref=9df935d878e5d92552ba1cb2b1ceacecef69f53f", "patch": "@@ -0,0 +1,29 @@\n+//  PR tree-opt/19768\n+// tree DSE was removing one store to LL.currentLevel\n+//  but forgot that since the vop was in an abnormal PHI\n+//  that we have to update the SSA_NAME which we propagate\n+//  into the abnormal PHI\n+\n+// { dg-do compile }\n+// { dg-options \"-O\" }\n+\n+struct LeveLogger\n+{\n+  int currentLevel;\n+};\n+extern LeveLogger LL;\n+struct gg\n+{\n+  ~gg ( void )\n+    { LL.currentLevel = 1; }\n+};\n+void f(void);\n+void g ( void )\n+{\n+  gg sll;\n+  {\n+    gg sll;\n+    f();\n+  }\n+  f();\n+}"}, {"sha": "625e1d1fa8fbc50395233430c28db83e80f7f6ac", "filename": "gcc/tree-ssa-dse.c", "status": "modified", "additions": 13, "deletions": 2, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2Ftree-ssa-dse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9df935d878e5d92552ba1cb2b1ceacecef69f53f/gcc%2Ftree-ssa-dse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-dse.c?ref=9df935d878e5d92552ba1cb2b1ceacecef69f53f", "patch": "@@ -134,7 +134,13 @@ fix_phi_uses (tree phi, tree stmt)\n   def_operand_p def_p;\n   ssa_op_iter iter;\n   int i;\n-\n+  edge e;\n+  edge_iterator ei;\n+  \n+  FOR_EACH_EDGE (e, ei, PHI_BB (phi)->preds) \n+  if (e->flags & EDGE_ABNORMAL)\n+    break;\n+  \n   get_stmt_operands (stmt);\n \n   FOR_EACH_SSA_MAYDEF_OPERAND (def_p, use_p, stmt, iter)\n@@ -146,7 +152,12 @@ fix_phi_uses (tree phi, tree stmt)\n \t them with the appropriate V_MAY_DEF_OP.  */\n       for (i = 0; i < PHI_NUM_ARGS (phi); i++)\n \tif (v_may_def == PHI_ARG_DEF (phi, i))\n-\t  SET_PHI_ARG_DEF (phi, i, v_may_use);\n+\t  {\n+\t    SET_PHI_ARG_DEF (phi, i, v_may_use);\n+\t    /* Update if the new phi argument is an abnormal phi.  */\n+\t    if (e != NULL)\n+\t      SSA_NAME_OCCURS_IN_ABNORMAL_PHI (v_may_use) = 1;\n+\t  }\n     }\n }\n "}]}