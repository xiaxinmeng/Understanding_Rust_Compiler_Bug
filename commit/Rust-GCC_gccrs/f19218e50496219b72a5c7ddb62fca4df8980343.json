{"sha": "f19218e50496219b72a5c7ddb62fca4df8980343", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjE5MjE4ZTUwNDk2MjE5YjcyYTVjN2RkYjYyZmNhNGRmODk4MDM0Mw==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2006-10-13T04:09:41Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2006-10-13T04:09:41Z"}, "message": "re PR c++/29318 (ICE: type_info of pointer to VLA)\n\n\tPR c++/29318\n\t* rtti.c (get_tinfo_decl): Refuse to create type info objects for\n\tvariably modified types.\n\tPR c++/29318\n\t* g++.dg/ext/vla4.C: New test.\n\nFrom-SVN: r117683", "tree": {"sha": "257c51d7abb705650f8b91249be8c8381872aeda", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/257c51d7abb705650f8b91249be8c8381872aeda"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f19218e50496219b72a5c7ddb62fca4df8980343", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f19218e50496219b72a5c7ddb62fca4df8980343", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f19218e50496219b72a5c7ddb62fca4df8980343", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f19218e50496219b72a5c7ddb62fca4df8980343/comments", "author": null, "committer": null, "parents": [{"sha": "fc6fabdfda0a578edcef2a91400e083d0d6b4c7a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fc6fabdfda0a578edcef2a91400e083d0d6b4c7a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fc6fabdfda0a578edcef2a91400e083d0d6b4c7a"}], "stats": {"total": 37, "additions": 34, "deletions": 3}, "files": [{"sha": "18958d46baba4ece818fa90a63bc9506a0795d8a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f19218e50496219b72a5c7ddb62fca4df8980343", "patch": "@@ -1,3 +1,9 @@\n+2006-10-12  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/29318\n+\t* rtti.c (get_tinfo_decl): Refuse to create type info objects for\n+\tvariably modified types.\n+\n 2006-10-12 Lee Millward <lee.millward@codesourcery.com>\n \n        PR c++/27961"}, {"sha": "0cb825dd1997ad4edec4975908938a6c5b08b84f", "filename": "gcc/cp/rtti.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Fcp%2Frtti.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Fcp%2Frtti.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Frtti.c?ref=f19218e50496219b72a5c7ddb62fca4df8980343", "patch": "@@ -342,11 +342,10 @@ get_tinfo_decl (tree type)\n   tree name;\n   tree d;\n \n-  if (COMPLETE_TYPE_P (type)\n-      && TREE_CODE (TYPE_SIZE (type)) != INTEGER_CST)\n+  if (variably_modified_type_p (type, /*fn=*/NULL_TREE))\n     {\n       error (\"cannot create type information for type %qT because \"\n-\t     \"its size is variable\",\n+\t     \"it involves types of variable size\",\n \t     type);\n       return error_mark_node;\n     }"}, {"sha": "7952579c81da11f4c13f777782e46053ab690638", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f19218e50496219b72a5c7ddb62fca4df8980343", "patch": "@@ -1,3 +1,8 @@\n+2006-10-12  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/29318\n+\t* g++.dg/ext/vla4.C: New test.\n+\n 2006-10-12 Lee Millward <lee.millward@codesourcery.com>\n \n        PR c++/27961"}, {"sha": "8b7f38f8ba80f21bda926d0ee840f81918662eba", "filename": "gcc/testsuite/g++.dg/ext/vla4.C", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvla4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19218e50496219b72a5c7ddb62fca4df8980343/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvla4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvla4.C?ref=f19218e50496219b72a5c7ddb62fca4df8980343", "patch": "@@ -0,0 +1,21 @@\n+// PR c++/29318\n+// { dg-options \"\" }\n+\n+#include <typeinfo>\n+\n+void f(int i) {\n+  try {\n+    int a[i];\n+    throw &a; // { dg-error \"variable size\" }\n+  } catch (int (&)[i]) { // { dg-error \"variable size\" }\n+  }\n+}\n+\n+int main()\n+{\n+  int i = 5;\n+  int va[i];\n+  const std::type_info& info(typeid(&va)); // { dg-error \"variable size\" }\n+\n+  return 0;\n+}"}]}