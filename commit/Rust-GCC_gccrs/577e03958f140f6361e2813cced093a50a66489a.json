{"sha": "577e03958f140f6361e2813cced093a50a66489a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTc3ZTAzOTU4ZjE0MGY2MzYxZTI4MTNjY2VkMDkzYTUwYTY2NDg5YQ==", "commit": {"author": {"name": "Andreas Schwab", "email": "schwab@linux-m68k.org", "date": "2012-05-21T18:43:27Z"}, "committer": {"name": "Andreas Schwab", "email": "schwab@gcc.gnu.org", "date": "2012-05-21T18:43:27Z"}, "message": "m68k.md (*clzsi2_cf): Renamed from clzsi2.\n\n* config/m68k/m68k.md (*clzsi2_cf): Renamed from clzsi2.  Call\nCC_STATUS_INIT.\n(clzsi2): New expander.\n(*clzsi2_68k): New insn.\n* config/m68k/m68k.h: Update comment about\nCLZ_DEFINED_VALUE_AT_ZERO.\n\nFrom-SVN: r187731", "tree": {"sha": "d24e1b502f84d74ee1c74d605084deef86023b02", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d24e1b502f84d74ee1c74d605084deef86023b02"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/577e03958f140f6361e2813cced093a50a66489a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/577e03958f140f6361e2813cced093a50a66489a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/577e03958f140f6361e2813cced093a50a66489a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/577e03958f140f6361e2813cced093a50a66489a/comments", "author": {"login": "andreas-schwab", "id": 2175493, "node_id": "MDQ6VXNlcjIxNzU0OTM=", "avatar_url": "https://avatars.githubusercontent.com/u/2175493?v=4", "gravatar_id": "", "url": "https://api.github.com/users/andreas-schwab", "html_url": "https://github.com/andreas-schwab", "followers_url": "https://api.github.com/users/andreas-schwab/followers", "following_url": "https://api.github.com/users/andreas-schwab/following{/other_user}", "gists_url": "https://api.github.com/users/andreas-schwab/gists{/gist_id}", "starred_url": "https://api.github.com/users/andreas-schwab/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/andreas-schwab/subscriptions", "organizations_url": "https://api.github.com/users/andreas-schwab/orgs", "repos_url": "https://api.github.com/users/andreas-schwab/repos", "events_url": "https://api.github.com/users/andreas-schwab/events{/privacy}", "received_events_url": "https://api.github.com/users/andreas-schwab/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "83e1a7f080f91f7cc1bb7916cd15779f685c7697", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83e1a7f080f91f7cc1bb7916cd15779f685c7697", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83e1a7f080f91f7cc1bb7916cd15779f685c7697"}], "stats": {"total": 38, "additions": 34, "deletions": 4}, "files": [{"sha": "d7216e5aeb219f4c237143c91b7116ee37bccdd8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/577e03958f140f6361e2813cced093a50a66489a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/577e03958f140f6361e2813cced093a50a66489a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=577e03958f140f6361e2813cced093a50a66489a", "patch": "@@ -1,3 +1,12 @@\n+2012-05-21  Andreas Schwab  <schwab@linux-m68k.org>\n+\n+\t* config/m68k/m68k.md (*clzsi2_cf): Renamed from clzsi2.  Call\n+\tCC_STATUS_INIT.\n+\t(clzsi2): New expander.\n+\t(*clzsi2_68k): New insn.\n+\t* config/m68k/m68k.h: Update comment about\n+\tCLZ_DEFINED_VALUE_AT_ZERO.\n+\n 2012-05-21  Aldy Hernandez  <aldyh@redhat.com>\n \n \t* gimple.h (gimple_set_in_transaction): Remove."}, {"sha": "b8d8d9ce922ea91beb768268fe0685e19ff189c8", "filename": "gcc/config/m68k/m68k.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/577e03958f140f6361e2813cced093a50a66489a/gcc%2Fconfig%2Fm68k%2Fm68k.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/577e03958f140f6361e2813cced093a50a66489a/gcc%2Fconfig%2Fm68k%2Fm68k.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Fm68k.h?ref=577e03958f140f6361e2813cced093a50a66489a", "patch": "@@ -1,6 +1,6 @@\n /* Definitions of target machine for GCC for Motorola 680x0/ColdFire.\n    Copyright (C) 1987, 1988, 1993, 1994, 1995, 1996, 1997, 1998, 1999,\n-   2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011\n+   2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -698,7 +698,7 @@ __transfer_from_trampoline ()\t\t\t\t\t\\\n \n #define TRULY_NOOP_TRUNCATION(OUTPREC, INPREC) 1\n \n-/* The ColdFire FF1 instruction returns 32 for zero. */\n+/* The 68020 BFFFO and ColdFire FF1 instructions return 32 for zero. */\n #define CLZ_DEFINED_VALUE_AT_ZERO(MODE, VALUE) ((VALUE) = 32, 1)\n \n #define STORE_FLAG_VALUE (-1)"}, {"sha": "0225b7ef2ed73050a33111ec10aedf4346f47c95", "filename": "gcc/config/m68k/m68k.md", "status": "modified", "additions": 23, "deletions": 2, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/577e03958f140f6361e2813cced093a50a66489a/gcc%2Fconfig%2Fm68k%2Fm68k.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/577e03958f140f6361e2813cced093a50a66489a/gcc%2Fconfig%2Fm68k%2Fm68k.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fm68k%2Fm68k.md?ref=577e03958f140f6361e2813cced093a50a66489a", "patch": "@@ -4467,12 +4467,33 @@\n \f\n ;; bit indexing instructions\n \n+(define_expand \"clzsi2\"\n+  [(set (match_operand:SI 0 \"register_operand\" \"\")\n+        (clz:SI (match_operand:SI 1 \"general_operand\" \"\")))]\n+  \"ISA_HAS_FF1 || (TARGET_68020 && TARGET_BITFIELD)\"\n+{\n+  if (ISA_HAS_FF1)\n+    operands[1] = force_reg (SImode, operands[1]);\n+})\n+\n+(define_insn \"*clzsi2_68k\"\n+  [(set (match_operand:SI 0 \"register_operand\" \"=d\")\n+        (clz:SI (match_operand:SI 1 \"general_operand\" \"do\")))]\n+  \"TARGET_68020 && TARGET_BITFIELD\"\n+{\n+  CC_STATUS_INIT;\n+  return \"bfffo %1{#0:#0},%0\";\n+})\n+\n ;; ColdFire ff1 instruction implements clz.\n-(define_insn \"clzsi2\"\n+(define_insn \"*clzsi2_cf\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=d\")\n  \t(clz:SI (match_operand:SI 1 \"register_operand\" \"0\")))]\n   \"ISA_HAS_FF1\"\n-  \"ff1 %0\"\n+{\n+  CC_STATUS_INIT;\n+  return \"ff1 %0\";\n+}\n   [(set_attr \"type\" \"ext\")])\n \f\n ;; one complement instructions"}]}