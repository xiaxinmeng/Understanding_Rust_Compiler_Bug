{"sha": "ad5780142a62bf2937d21341b3c488c9d143449f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWQ1NzgwMTQyYTYyYmYyOTM3ZDIxMzQxYjNjNDg4YzlkMTQzNDQ5Zg==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "1997-04-13T22:45:30Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "1997-04-13T22:45:30Z"}, "message": "Get the modes right when setting reg_values for a reg to reg copy\n\nFrom-SVN: r13896", "tree": {"sha": "7e3c13a6a971905e2f3f5b4656d042335e7e8a24", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7e3c13a6a971905e2f3f5b4656d042335e7e8a24"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ad5780142a62bf2937d21341b3c488c9d143449f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad5780142a62bf2937d21341b3c488c9d143449f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ad5780142a62bf2937d21341b3c488c9d143449f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ad5780142a62bf2937d21341b3c488c9d143449f/comments", "author": null, "committer": null, "parents": [{"sha": "3e42d56b4b6fa2d03a6bd52e7135df62e12a3385", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e42d56b4b6fa2d03a6bd52e7135df62e12a3385", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e42d56b4b6fa2d03a6bd52e7135df62e12a3385"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "702ebd812a18923734ef105097a8dc8e43bb9e92", "filename": "gcc/reload1.c", "status": "modified", "additions": 23, "deletions": 1, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ad5780142a62bf2937d21341b3c488c9d143449f/gcc%2Freload1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ad5780142a62bf2937d21341b3c488c9d143449f/gcc%2Freload1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freload1.c?ref=ad5780142a62bf2937d21341b3c488c9d143449f", "patch": "@@ -8215,7 +8215,29 @@ reload_cse_record_set (set, body)\n       /* This is an assignment to a register.  Update the value we\n          have stored for the register.  */\n       if (sreg >= 0)\n-\treg_values[dreg] = reg_values[sreg];\n+\t{\n+\t  rtx x;\n+\n+\t  /* This is a copy from one register to another.  Any values\n+\t     which were valid for SREG are now valid for DREG.  If the\n+\t     mode changes, we use gen_lowpart_common to extract only\n+\t     the part of the value that is copied.  */\n+\t  reg_values[dreg] = 0;\n+\t  for (x = reg_values[sreg]; x; x = XEXP (x, 1))\n+\t    {\n+\t      rtx tmp;\n+\n+\t      if (XEXP (x, 0) == 0)\n+\t\tcontinue;\n+\t      if (dest_mode == GET_MODE (XEXP (x, 0)))\n+\t\ttmp = XEXP (x, 0);\n+\t      else\n+\t\ttmp = gen_lowpart_common (dest_mode, XEXP (x, 0));\n+\t      if (tmp)\n+\t\treg_values[dreg] = gen_rtx (EXPR_LIST, dest_mode, tmp,\n+\t\t\t\t\t    reg_values[dreg]);\n+\t    }\t      \n+\t}\n       else\n \treg_values[dreg] = gen_rtx (EXPR_LIST, dest_mode, src, NULL_RTX);\n "}]}