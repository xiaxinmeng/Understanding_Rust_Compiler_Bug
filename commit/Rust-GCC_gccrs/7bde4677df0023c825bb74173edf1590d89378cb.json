{"sha": "7bde4677df0023c825bb74173edf1590d89378cb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2JkZTQ2NzdkZjAwMjNjODI1YmI3NDE3M2VkZjE1OTBkODkzNzhjYg==", "commit": {"author": {"name": "Samuel Tardieu", "email": "sam@rfc1149.net", "date": "2007-11-28T20:48:10Z"}, "committer": {"name": "Samuel Tardieu", "email": "sam@gcc.gnu.org", "date": "2007-11-28T20:48:10Z"}, "message": "re PR ada/22559 (Bug box, Program_Error at sinput.adb:404, derived fixed-point type)\n\n    gcc/ada/\n\tPR ada/22559\n\t* sem_ch3.adb (Build_Derived_Numeric_Type): Do not set RM_Size on\n\ta derived ordinary fixed point type.\n\n\t* sem_ch13.adb (Analyze_Attribute_Definition_Clause): Recompute\n\tRM_Size when a Small clause is found.\n\n    gcc/testsuite/\n\tPR ada/22559\n\t* gnat.dg/specs/delta_small.ads: New test.\n\nFrom-SVN: r130498", "tree": {"sha": "c06a4a590ed41cead072d30c539186bc583af1cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c06a4a590ed41cead072d30c539186bc583af1cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7bde4677df0023c825bb74173edf1590d89378cb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bde4677df0023c825bb74173edf1590d89378cb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7bde4677df0023c825bb74173edf1590d89378cb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bde4677df0023c825bb74173edf1590d89378cb/comments", "author": {"login": "samueltardieu", "id": 44656, "node_id": "MDQ6VXNlcjQ0NjU2", "avatar_url": "https://avatars.githubusercontent.com/u/44656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samueltardieu", "html_url": "https://github.com/samueltardieu", "followers_url": "https://api.github.com/users/samueltardieu/followers", "following_url": "https://api.github.com/users/samueltardieu/following{/other_user}", "gists_url": "https://api.github.com/users/samueltardieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/samueltardieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samueltardieu/subscriptions", "organizations_url": "https://api.github.com/users/samueltardieu/orgs", "repos_url": "https://api.github.com/users/samueltardieu/repos", "events_url": "https://api.github.com/users/samueltardieu/events{/privacy}", "received_events_url": "https://api.github.com/users/samueltardieu/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5a21849883efce34b55216109644da8ab8b16fcd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5a21849883efce34b55216109644da8ab8b16fcd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5a21849883efce34b55216109644da8ab8b16fcd"}], "stats": {"total": 26, "additions": 24, "deletions": 2}, "files": [{"sha": "b201afb7376cfba6870c65fdccd9a9a96a7b43d6", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=7bde4677df0023c825bb74173edf1590d89378cb", "patch": "@@ -22,6 +22,13 @@\n \tSignal an error when attribute argument is a fixed-point value of\n \tan unknown type.\n \n+\tPR ada/22559\n+\t* sem_ch3.adb (Build_Derived_Numeric_Type): Do not set RM_Size on\n+\ta derived ordinary fixed point type.\n+\n+\t* sem_ch13.adb (Analyze_Attribute_Definition_Clause): Recompute\n+\tRM_Size when a Small clause is found.\n+\n 2007-11-26  Andreas Krebbel  <krebbel1@de.ibm.com>\n \n         PR 34081/C++"}, {"sha": "18670d3941e1e91b7bee1064b81437aa36605d76", "filename": "gcc/ada/sem_ch13.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Fada%2Fsem_ch13.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Fada%2Fsem_ch13.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch13.adb?ref=7bde4677df0023c825bb74173edf1590d89378cb", "patch": "@@ -29,6 +29,7 @@ with Einfo;    use Einfo;\n with Errout;   use Errout;\n with Exp_Tss;  use Exp_Tss;\n with Exp_Util; use Exp_Util;\n+with Layout;   use Layout;\n with Lib;      use Lib;\n with Lib.Xref; use Lib.Xref;\n with Namet;    use Namet;\n@@ -1375,6 +1376,7 @@ package body Sem_Ch13 is\n                Set_Has_Small_Clause (U_Ent);\n                Set_Has_Small_Clause (Implicit_Base);\n                Set_Has_Non_Standard_Rep (Implicit_Base);\n+               Set_Discrete_RM_Size (U_Ent);\n             end if;\n          end Small;\n "}, {"sha": "5c61d00943f6892011e792dc4a889e14c8c6801a", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=7bde4677df0023c825bb74173edf1590d89378cb", "patch": "@@ -4950,11 +4950,12 @@ package body Sem_Ch3 is\n       Set_Etype          (Implicit_Base, Parent_Base);\n       Set_Ekind          (Implicit_Base, Ekind          (Parent_Base));\n       Set_Size_Info      (Implicit_Base,                 Parent_Base);\n-      Set_RM_Size        (Implicit_Base, RM_Size        (Parent_Base));\n       Set_First_Rep_Item (Implicit_Base, First_Rep_Item (Parent_Base));\n       Set_Parent         (Implicit_Base, Parent (Derived_Type));\n \n-      if Is_Discrete_Or_Fixed_Point_Type (Parent_Base) then\n+      if Is_Discrete_Type (Parent_Base) or else\n+        Is_Decimal_Fixed_Point_Type (Parent_Base)\n+      then\n          Set_RM_Size (Implicit_Base, RM_Size (Parent_Base));\n       end if;\n "}, {"sha": "52ceea2d0e89c86981e60f5ac4c6c074a042c15e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7bde4677df0023c825bb74173edf1590d89378cb", "patch": "@@ -9,6 +9,9 @@\n \tPR ada/32792\n \t* gnat.dg/specs/integer_value.ads: New test.\n \n+\tPR ada/22559\n+\t* gnat.dg/specs/delta_small.ads: New test.\n+\n 2007-11-28  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/34140"}, {"sha": "3ff742631319f8c0d35ea87ba9f39c188044a600", "filename": "gcc/testsuite/gnat.dg/specs/delta_small.ads", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fdelta_small.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7bde4677df0023c825bb74173edf1590d89378cb/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fdelta_small.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Fdelta_small.ads?ref=7bde4677df0023c825bb74173edf1590d89378cb", "patch": "@@ -0,0 +1,9 @@\n+-- { dg-do compile }\n+\n+package Delta_Small is\n+   type T is delta 0.1 range -0.8 .. 0.8;\n+   for T'Small use 0.1;\n+   for T'Size use 4;\n+   type T2 is new T range -0.4 .. 0.4;\n+   for T2'Small use 0.0625;\n+end Delta_Small;"}]}