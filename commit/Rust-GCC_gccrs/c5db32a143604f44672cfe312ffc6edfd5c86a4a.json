{"sha": "c5db32a143604f44672cfe312ffc6edfd5c86a4a", "node_id": "C_kwDOANBUbNoAKGM1ZGIzMmExNDM2MDRmNDQ2NzJjZmUzMTJmZmM2ZWRmZDVjODZhNGE", "commit": {"author": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2022-03-29T08:31:51Z"}, "committer": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2022-03-29T10:55:35Z"}, "message": "[nvptx] Add march alias for misa\n\nThe target option misa has the following description:\n...\n$ gcc --target-help 2>&1 | grep misa\n  -misa=                      Specify the PTX ISA target architecture to use.\n...\n\nThe name misa is somewhat poorly chosen.  It suggests that for a use\n-misa=sm_30, sm_30 is the name of a specific Instruction Set Architecture.\nInstead, sm_30 is the name of a specific target architecture in the generic\nPTX Instruction Set Architecture.\n\nFuthermore, there's mptx, which also has ISA in the description:\n...\n  -mptx=                      Specify the PTX ISA version to use.\n...\n\nAdd the more intuitive alias march for misa:\n...\n$ gcc --target-help 2>&1 | grep march\n  -march=                     Alias:  Same as -misa=.\n...\n\nTested on nvptx.\n\ngcc/ChangeLog:\n\n2022-03-29  Tom de Vries  <tdevries@suse.de>\n\n\t* config/nvptx/nvptx.opt (march): Add alias of misa.\n\ngcc/testsuite/ChangeLog:\n\n2022-03-29  Tom de Vries  <tdevries@suse.de>\n\n\t* gcc.target/nvptx/main.c: New test.\n\t* gcc.target/nvptx/march.c: New test.", "tree": {"sha": "c9c3bb84b6a465d45ecae18cdd446a559ea11691", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c9c3bb84b6a465d45ecae18cdd446a559ea11691"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c5db32a143604f44672cfe312ffc6edfd5c86a4a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5db32a143604f44672cfe312ffc6edfd5c86a4a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c5db32a143604f44672cfe312ffc6edfd5c86a4a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c5db32a143604f44672cfe312ffc6edfd5c86a4a/comments", "author": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "committer": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "06ff470638c6c632a6b5b0000b0db0f01bbb9cbc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06ff470638c6c632a6b5b0000b0db0f01bbb9cbc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06ff470638c6c632a6b5b0000b0db0f01bbb9cbc"}], "stats": {"total": 16, "additions": 16, "deletions": 0}, "files": [{"sha": "b5d0170e9e9331fa7facd2437d360e380b71f46e", "filename": "gcc/config/nvptx/nvptx.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c5db32a143604f44672cfe312ffc6edfd5c86a4a/gcc%2Fconfig%2Fnvptx%2Fnvptx.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c5db32a143604f44672cfe312ffc6edfd5c86a4a/gcc%2Fconfig%2Fnvptx%2Fnvptx.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnvptx%2Fnvptx.opt?ref=c5db32a143604f44672cfe312ffc6edfd5c86a4a", "patch": "@@ -56,6 +56,10 @@ misa=\n Target RejectNegative ToLower Joined Enum(ptx_isa) Var(ptx_isa_option) Init(PTX_ISA_SM30)\n Specify the PTX ISA target architecture to use.\n \n+march=\n+Target RejectNegative Joined Alias(misa=)\n+Alias:\n+\n Enum\n Name(ptx_version) Type(int)\n Known PTX ISA versions (for use with the -mptx= option):"}, {"sha": "3af2b575842477c9f3ad7d0c9f955dd988c533d6", "filename": "gcc/testsuite/gcc.target/nvptx/main.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c5db32a143604f44672cfe312ffc6edfd5c86a4a/gcc%2Ftestsuite%2Fgcc.target%2Fnvptx%2Fmain.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c5db32a143604f44672cfe312ffc6edfd5c86a4a/gcc%2Ftestsuite%2Fgcc.target%2Fnvptx%2Fmain.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fnvptx%2Fmain.c?ref=c5db32a143604f44672cfe312ffc6edfd5c86a4a", "patch": "@@ -0,0 +1,7 @@\n+/* { dg-do link } */\n+\n+int\n+main (void)\n+{\n+  return 0;\n+}"}, {"sha": "ec91f21c903a848bc93bb3ca11f4aa27f4a6181a", "filename": "gcc/testsuite/gcc.target/nvptx/march.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c5db32a143604f44672cfe312ffc6edfd5c86a4a/gcc%2Ftestsuite%2Fgcc.target%2Fnvptx%2Fmarch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c5db32a143604f44672cfe312ffc6edfd5c86a4a/gcc%2Ftestsuite%2Fgcc.target%2Fnvptx%2Fmarch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fnvptx%2Fmarch.c?ref=c5db32a143604f44672cfe312ffc6edfd5c86a4a", "patch": "@@ -0,0 +1,5 @@\n+/* { dg-options \"-march=sm_30\"} */\n+\n+#include \"main.c\"\n+\n+/* { dg-final { scan-assembler-times \"\\\\.target\\tsm_30\" 1 } } */"}]}