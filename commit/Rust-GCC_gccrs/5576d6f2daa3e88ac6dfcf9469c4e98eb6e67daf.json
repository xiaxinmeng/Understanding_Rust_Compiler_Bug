{"sha": "5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTU3NmQ2ZjJkYWEzZTg4YWM2ZGZjZjk0NjljNGU5OGViNmU2N2RhZg==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2007-11-16T00:11:47Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2007-11-16T00:11:47Z"}, "message": "tree-ssa-structalias.c (ipa_pta_execute): Rename 'cfun' to 'func'.\n\n\t* tree-ssa-structalias.c (ipa_pta_execute): Rename 'cfun' to\n\t'func'. \n\t* tree-parloops.c (create_loop_fn): Use set_cfun.\n\t* gengtype.c (open_base_files): Emit #undef cfun.\n\t* ipa-struct-reorg.c (do_reorg_1): Use set_cfun.\n\t* function.h (cfun): New define.\n\t* function.c: Undefine cfun.\n\nFrom-SVN: r130213", "tree": {"sha": "672e864a197fe1e491117b7d173a827a5d262941", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/672e864a197fe1e491117b7d173a827a5d262941"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/comments", "author": null, "committer": null, "parents": [{"sha": "506af7a420bd9f4016bbbfc1d126ab835764b0ac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/506af7a420bd9f4016bbbfc1d126ab835764b0ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/506af7a420bd9f4016bbbfc1d126ab835764b0ac"}], "stats": {"total": 34, "additions": 28, "deletions": 6}, "files": [{"sha": "7c00d0b5f394a4a642e0758841d605b96776b9e8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "patch": "@@ -1,3 +1,13 @@\n+2007-11-07  Tom Tromey  <tromey@redhat.com>\n+\n+\t* tree-ssa-structalias.c (ipa_pta_execute): Rename 'cfun' to\n+\t'func'. \n+\t* tree-parloops.c (create_loop_fn): Use set_cfun.\n+\t* gengtype.c (open_base_files): Emit #undef cfun.\n+\t* ipa-struct-reorg.c (do_reorg_1): Use set_cfun.\n+\t* function.h (cfun): New define.\n+\t* function.c: Undefine cfun.\n+\n 2007-11-07  Eric B. Weddington  <eweddington@cso.atmel.com>\n \n \t* config/avr/avr.c (avr_mcu_types): Add attiny88."}, {"sha": "f549c777101fa5db9d6d4766a5b260a629cef518", "filename": "gcc/function.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "patch": "@@ -66,6 +66,9 @@ along with GCC; see the file COPYING3.  If not see\n #include \"timevar.h\"\n #include \"vecprim.h\"\n \n+/* So we can assign to cfun in this file.  */\n+#undef cfun\n+\n #ifndef LOCAL_ALIGNMENT\n #define LOCAL_ALIGNMENT(TYPE, ALIGNMENT) ALIGNMENT\n #endif"}, {"sha": "ff71c9ab516c73312aa2bfe6de8f946293c5a189", "filename": "gcc/function.h", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ffunction.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ffunction.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.h?ref=5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "patch": "@@ -466,6 +466,11 @@ struct function GTY(())\n /* The function currently being compiled.  */\n extern GTY(()) struct function *cfun;\n \n+/* In order to ensure that cfun is not set directly, we redefine it so\n+   that it is not an lvalue.  Rather than assign to cfun, use\n+   push_cfun or set_cfun.  */\n+#define cfun (cfun + 0)\n+\n /* Pointer to chain of `struct function' for containing functions.  */\n extern GTY(()) struct function *outer_function_chain;\n "}, {"sha": "ca7d5b411cd843652f195458d217eea1d609e928", "filename": "gcc/gengtype.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Fgengtype.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Fgengtype.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgengtype.c?ref=5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "patch": "@@ -1543,6 +1543,10 @@ open_base_files (void)\n     gtype_desc_c = create_file (\"GCC\", \"gtype-desc.c\");\n     for (ifp = ifiles; *ifp; ifp++)\n       oprintf (gtype_desc_c, \"#include \\\"%s\\\"\\n\", *ifp);\n+\n+    /* Make sure we handle \"cfun\" specially.  */\n+    oprintf (gtype_desc_c, \"\\n/* See definition in function.h.  */\\n\");\n+    oprintf (gtype_desc_c, \"#undef cfun\\n\");\n   }\n }\n "}, {"sha": "1985cec5e2a693b3b8fbe1483c4b5df6b83c727f", "filename": "gcc/ipa-struct-reorg.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Fipa-struct-reorg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Fipa-struct-reorg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-struct-reorg.c?ref=5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "patch": "@@ -3628,7 +3628,7 @@ do_reorg_1 (void)\n \tpop_cfun ();\n       }\n \n-  cfun = NULL;\n+  set_cfun (NULL);\n }\n \n /* This function creates new global struct variables."}, {"sha": "afa2ed523e1ec58e3c4a4fc2a24e1d64a3931116", "filename": "gcc/tree-parloops.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ftree-parloops.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ftree-parloops.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-parloops.c?ref=5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "patch": "@@ -1,5 +1,5 @@\n /* Loop autoparallelization.\n-   Copyright (C) 2006 Free Software Foundation, Inc.\n+   Copyright (C) 2006, 2007 Free Software Foundation, Inc.\n    Contributed by Sebastian Pop <pop@cri.ensmp.fr> and\n    Zdenek Dvorak <dvorakz@suse.cz>.\n \n@@ -1252,7 +1252,7 @@ create_loop_fn (void)\n \n   /* The call to allocate_struct_function clobbers CFUN, so we need to restore\n      it.  */\n-  cfun = act_cfun;\n+  set_cfun (act_cfun);\n \n   return decl;\n }"}, {"sha": "b175d252608146a56d2ad7aa2f9f65654c78e3b5", "filename": "gcc/tree-ssa-structalias.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ftree-ssa-structalias.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf/gcc%2Ftree-ssa-structalias.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-structalias.c?ref=5576d6f2daa3e88ac6dfcf9469c4e98eb6e67daf", "patch": "@@ -5561,17 +5561,17 @@ ipa_pta_execute (void)\n     {\n       if (node->analyzed && cgraph_is_master_clone (node))\n \t{\n-\t  struct function *cfun = DECL_STRUCT_FUNCTION (node->decl);\n+\t  struct function *func = DECL_STRUCT_FUNCTION (node->decl);\n \t  basic_block bb;\n \t  tree old_func_decl = current_function_decl;\n \t  if (dump_file)\n \t    fprintf (dump_file,\n \t\t     \"Generating constraints for %s\\n\",\n \t\t     cgraph_node_name (node));\n-\t  push_cfun (cfun);\n+\t  push_cfun (func);\n \t  current_function_decl = node->decl;\n \n-\t  FOR_EACH_BB_FN (bb, cfun)\n+\t  FOR_EACH_BB_FN (bb, func)\n \t    {\n \t      block_stmt_iterator bsi;\n \t      tree phi;"}]}