{"sha": "f58b8cd70ec2c2a6affed7de996d266998352322", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjU4YjhjZDcwZWMyYzJhNmFmZmVkN2RlOTk2ZDI2Njk5ODM1MjMyMg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2015-10-29T13:12:45Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2015-10-29T13:12:45Z"}, "message": "re PR c++/67845 (ICE on invalid use of const qualifier on x86_64-linux-gnu in merge_types, at cp/typeck.c:854)\n\n/cp\n2015-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/67845\n\t* decl.c (grokfndecl): In case of erroneous cv-qualified non-member\n\tfunctions consistently reset TREE_TYPE (decl) too.\n\n/testsuite\n2015-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/67845\n\t* g++.dg/other/cv_func4.C: New.\n\nFrom-SVN: r229523", "tree": {"sha": "c5f8fdf72661f4b38ac0df96db69c144f05c6a87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c5f8fdf72661f4b38ac0df96db69c144f05c6a87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f58b8cd70ec2c2a6affed7de996d266998352322", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f58b8cd70ec2c2a6affed7de996d266998352322", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f58b8cd70ec2c2a6affed7de996d266998352322", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f58b8cd70ec2c2a6affed7de996d266998352322/comments", "author": null, "committer": null, "parents": [{"sha": "5148d2e38fa5ff6427fca48cb592ca34a46af3f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5148d2e38fa5ff6427fca48cb592ca34a46af3f9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5148d2e38fa5ff6427fca48cb592ca34a46af3f9"}], "stats": {"total": 22, "additions": 22, "deletions": 0}, "files": [{"sha": "a85166b757dd619a230ed2cf97ff707220ec6074", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f58b8cd70ec2c2a6affed7de996d266998352322", "patch": "@@ -1,3 +1,9 @@\n+2015-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/67845\n+\t* decl.c (grokfndecl): In case of erroneous cv-qualified non-member\n+\tfunctions consistently reset TREE_TYPE (decl) too.\n+\n 2015-10-28  Jason Merrill  <jason@redhat.com>\n \n \tDR 1518"}, {"sha": "c5ceb5a2d6f3898395575c62b5ab297ba6696620", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=f58b8cd70ec2c2a6affed7de996d266998352322", "patch": "@@ -7998,6 +7998,11 @@ grokfndecl (tree ctype,\n   DECL_EXTERNAL (decl) = 1;\n   if (TREE_CODE (type) == FUNCTION_TYPE)\n     {\n+      if (quals || rqual)\n+\tTREE_TYPE (decl) = apply_memfn_quals (TREE_TYPE (decl),\n+\t\t\t\t\t      TYPE_UNQUALIFIED,\n+\t\t\t\t\t      REF_QUAL_NONE);\n+\n       if (quals)\n \t{\n \t  error (ctype"}, {"sha": "77a736fe064028e80ea733627ae61c10fbedd232", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f58b8cd70ec2c2a6affed7de996d266998352322", "patch": "@@ -1,3 +1,8 @@\n+2015-10-29  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/67845\n+\t* g++.dg/other/cv_func4.C: New.\n+\n 2015-10-29  Richard Biener  <rguenther@suse.de>\n \n \tPR middle-end/56956"}, {"sha": "df4f19eb51a2c0cf06c299d67fb8235f0d31c26d", "filename": "gcc/testsuite/g++.dg/other/cv_func4.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func4.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58b8cd70ec2c2a6affed7de996d266998352322/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func4.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fcv_func4.C?ref=f58b8cd70ec2c2a6affed7de996d266998352322", "patch": "@@ -0,0 +1,6 @@\n+// PR c++/67845\n+\n+typedef void F () const;\n+\n+F foo;  // { dg-error \"cv-qualifier\" }\n+void foo ();"}]}