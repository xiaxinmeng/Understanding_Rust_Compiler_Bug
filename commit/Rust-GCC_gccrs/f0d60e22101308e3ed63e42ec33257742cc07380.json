{"sha": "f0d60e22101308e3ed63e42ec33257742cc07380", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjBkNjBlMjIxMDEzMDhlM2VkNjNlNDJlYzMzMjU3NzQyY2MwNzM4MA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2005-10-10T14:41:52Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2005-10-10T14:41:52Z"}, "message": "re PR c++/24139 (Rejects definition of member of specialized inner class)\n\n\tPR c++/24139\n\t* decl.c (grokdeclarator): Do not require template parameter lists\n\tfor explicitly specialized class.\n\t* error.c (dump_aggr_type): Do not dump template arguments for\n\tnon-primary specializations.\n\t(dump_function_name): Likewise.\n\tPR c++/24139\n\t* g++.dg/template/spec27.C: New test.\n\nFrom-SVN: r105172", "tree": {"sha": "cb163c410364b6ab4bc35b3a454234d937f3e087", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cb163c410364b6ab4bc35b3a454234d937f3e087"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f0d60e22101308e3ed63e42ec33257742cc07380", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0d60e22101308e3ed63e42ec33257742cc07380", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f0d60e22101308e3ed63e42ec33257742cc07380", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0d60e22101308e3ed63e42ec33257742cc07380/comments", "author": null, "committer": null, "parents": [{"sha": "e0b923193a67f9a644cfab03fa8a40f0a43b5db3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0b923193a67f9a644cfab03fa8a40f0a43b5db3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0b923193a67f9a644cfab03fa8a40f0a43b5db3"}], "stats": {"total": 54, "additions": 45, "deletions": 9}, "files": [{"sha": "87d52996bf9580fa5de5e2007443b6a698c53b6c", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f0d60e22101308e3ed63e42ec33257742cc07380", "patch": "@@ -1,3 +1,17 @@\n+2005-10-10  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/24139\n+\t* decl.c (grokdeclarator): Do not require template parameter lists\n+\tfor explicitly specialized class.\n+\t* error.c (dump_aggr_type): Do not dump template arguments for\n+\tnon-primary specializations.\n+\t(dump_function_name): Likewise.\n+\n+\tPR c++/24275\n+\t* pt.c (instantiate_decl): Instantiate the initializer of\n+\ta static data member in the namespace containing the class\n+\tcontaining the static data member.\n+\n 2005-10-08  James A. Morrison  <phython@gcc.gnu.org>\n \n \tPR c++/22172"}, {"sha": "91d76ba62164509996fe45caed273775806e6c10", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=f0d60e22101308e3ed63e42ec33257742cc07380", "patch": "@@ -7551,9 +7551,13 @@ grokdeclarator (const cp_declarator *declarator,\n \n \t     is correct; there shouldn't be a `template <>' for the\n \t     definition of `S<int>::f'.  */\n-\t  if (CLASSTYPE_TEMPLATE_INFO (t)\n-\t      && (CLASSTYPE_TEMPLATE_INSTANTIATION (t)\n-\t\t  || uses_template_parms (CLASSTYPE_TI_ARGS (t)))\n+\t  if (CLASSTYPE_TEMPLATE_SPECIALIZATION (t)\n+\t      && !any_dependent_template_arguments_p (CLASSTYPE_TI_ARGS (t)))\n+\t    /* T is an explicit (not partial) specialization.  All\n+\t       containing classes must therefore also be explicitly\n+\t       specialized.  */\n+\t    break;\n+\t  if ((CLASSTYPE_USE_TEMPLATE (t) || CLASSTYPE_IS_TEMPLATE (t))\n \t      && PRIMARY_TEMPLATE_P (CLASSTYPE_TI_TEMPLATE (t)))\n \t    template_count += 1;\n "}, {"sha": "1b70bbbb0fb8fb965038963ce286c1ff5a022a63", "filename": "gcc/cp/error.c", "status": "modified", "additions": 2, "deletions": 6, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Fcp%2Ferror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Fcp%2Ferror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ferror.c?ref=f0d60e22101308e3ed63e42ec33257742cc07380", "patch": "@@ -437,9 +437,7 @@ dump_aggr_type (tree t, int flags)\n       typdef = !DECL_ARTIFICIAL (name);\n       tmplate = !typdef && TREE_CODE (t) != ENUMERAL_TYPE\n \t\t&& TYPE_LANG_SPECIFIC (t) && CLASSTYPE_TEMPLATE_INFO (t)\n-\t\t&& (CLASSTYPE_TEMPLATE_SPECIALIZATION (t)\n-\t\t    || TREE_CODE (CLASSTYPE_TI_TEMPLATE (t)) != TEMPLATE_DECL\n-\t\t    || DECL_TEMPLATE_SPECIALIZATION (CLASSTYPE_TI_TEMPLATE (t))\n+\t\t&& (TREE_CODE (CLASSTYPE_TI_TEMPLATE (t)) != TEMPLATE_DECL\n \t\t    || PRIMARY_TEMPLATE_P (CLASSTYPE_TI_TEMPLATE (t)));\n       dump_scope (CP_DECL_CONTEXT (name), flags | TFF_SCOPE);\n       if (tmplate)\n@@ -1182,9 +1180,7 @@ dump_function_name (tree t, int flags)\n \n   if (DECL_TEMPLATE_INFO (t)\n       && !DECL_FRIEND_PSEUDO_TEMPLATE_INSTANTIATION (t)\n-      && (DECL_TEMPLATE_SPECIALIZATION (t)\n-\t  || TREE_CODE (DECL_TI_TEMPLATE (t)) != TEMPLATE_DECL\n-\t  || DECL_TEMPLATE_SPECIALIZATION (DECL_TI_TEMPLATE (t))\n+      && (TREE_CODE (DECL_TI_TEMPLATE (t)) != TEMPLATE_DECL\n \t  || PRIMARY_TEMPLATE_P (DECL_TI_TEMPLATE (t))))\n     dump_template_parms (DECL_TEMPLATE_INFO (t), !DECL_USE_TEMPLATE (t), flags);\n }"}, {"sha": "fac40d68119f4e3a9f55d2e71af9a94b5a39e415", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f0d60e22101308e3ed63e42ec33257742cc07380", "patch": "@@ -1,3 +1,11 @@\n+2005-10-10  Mark Mitchell  <mark@codesourcery.com>\n+\n+\tPR c++/24139\n+\t* g++.dg/template/spec27.C: New test. \n+\n+\tPR c++/24275\n+\t* g++.dg/template/static19.C: New test.\n+\n 2005-10-09  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \t* gcc.dg/20050922-1.c: Skip on Solaris 2.5.1 to 9."}, {"sha": "a31adadd3e6112c506cc9816910810b8ceb7da5a", "filename": "gcc/testsuite/g++.dg/template/spec27.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec27.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f0d60e22101308e3ed63e42ec33257742cc07380/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec27.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fspec27.C?ref=f0d60e22101308e3ed63e42ec33257742cc07380", "patch": "@@ -0,0 +1,14 @@\n+// PR c++/24139\n+\n+template<typename T>\n+struct O {\n+  struct I;\n+};\n+\n+template<>\n+struct O<int>::I\n+{\n+  I();\n+};\n+\n+O<int>::I::I() {}"}]}