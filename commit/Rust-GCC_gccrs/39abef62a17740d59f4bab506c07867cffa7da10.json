{"sha": "39abef62a17740d59f4bab506c07867cffa7da10", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzlhYmVmNjJhMTc3NDBkNTlmNGJhYjUwNmMwNzg2N2NmZmE3ZGExMA==", "commit": {"author": {"name": "Louis Krupp", "email": "louis.krupp@zoho.com", "date": "2016-09-22T07:07:53Z"}, "committer": {"name": "Louis Krupp", "email": "lkrupp@gcc.gnu.org", "date": "2016-09-22T07:07:53Z"}, "message": "re PR fortran/66107 (ICE on missing parameter value for initialisation (segfault))\n\n2016-09-21  Louis Krupp  <louis.krupp@zoho.com>\n\n\tPR fortran/66107\n\t* gfortran.dg/pr66107.f90: New test.\n\n2016-09-21  Louis Krupp  <louis.krupp@zoho.com>\n\n\tPR fortran/66107\n\t* decl.c (add_init_expr_to_sym): Catch variable character length\n\tin parameter array.\n\nFrom-SVN: r240341", "tree": {"sha": "f65cfe904fdcb00478322717cba41c638b665976", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f65cfe904fdcb00478322717cba41c638b665976"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/39abef62a17740d59f4bab506c07867cffa7da10", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39abef62a17740d59f4bab506c07867cffa7da10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/39abef62a17740d59f4bab506c07867cffa7da10", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/39abef62a17740d59f4bab506c07867cffa7da10/comments", "author": null, "committer": null, "parents": [{"sha": "41501d1ae708f6977d957b61f797fda15ce33f0b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/41501d1ae708f6977d957b61f797fda15ce33f0b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/41501d1ae708f6977d957b61f797fda15ce33f0b"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "971c34838148342c8b75f742324827929ed0222a", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=39abef62a17740d59f4bab506c07867cffa7da10", "patch": "@@ -1,3 +1,9 @@\n+2016-09-21  Louis Krupp  <louis.krupp@zoho.com>\n+\n+\tPR fortran/66107\n+\t* decl.c (add_init_expr_to_sym): Catch variable character length\n+\tin parameter array.\n+\n 2016-09-21  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/77657"}, {"sha": "2982e86bac043c5402369708397b7e710e401a69", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=39abef62a17740d59f4bab506c07867cffa7da10", "patch": "@@ -1672,7 +1672,18 @@ add_init_expr_to_sym (const char *name, gfc_expr **initp, locus *var_locus)\n \t\t  else if (init->expr_type == EXPR_ARRAY)\n \t\t    {\n \t\t      if (init->ts.u.cl)\n-\t\t\tclen = mpz_get_si (init->ts.u.cl->length->value.integer);\n+\t\t\t{\n+\t\t\t  const gfc_expr *length = init->ts.u.cl->length;\n+\t\t\t  if (length->expr_type != EXPR_CONSTANT)\n+\t\t\t    {\n+\t\t\t      gfc_error (\"Cannot initialize parameter array \"\n+\t\t\t\t\t \"at %L \"\n+\t\t\t\t\t \"with variable length elements\",\n+\t\t\t\t\t &sym->declared_at);\n+\t\t\t      return false;\n+\t\t\t    }\n+\t\t\t  clen = mpz_get_si (length->value.integer);\n+\t\t\t}\n \t\t      else if (init->value.constructor)\n \t\t\t{\n \t\t\t  gfc_constructor *c;"}, {"sha": "e6480d85374b3f086cc5b3dc262075c6c5e85602", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=39abef62a17740d59f4bab506c07867cffa7da10", "patch": "@@ -1,3 +1,8 @@\n+2016-09-21  Louis Krupp  <louis.krupp@zoho.com>\n+\n+\tPR fortran/66107\n+\t* gfortran.dg/pr66107.f90: New test.\n+\n 2016-09-21  Ian Lance Taylor  <iant@golang.org>\n \n \t* go.go-torture/execute/map-1.go: Replace old map deletion syntax"}, {"sha": "5127efaeed31856eddd0f494712876fc39fda349", "filename": "gcc/testsuite/gfortran.dg/pr66107.f90", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr66107.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/39abef62a17740d59f4bab506c07867cffa7da10/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr66107.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr66107.f90?ref=39abef62a17740d59f4bab506c07867cffa7da10", "patch": "@@ -0,0 +1,6 @@\n+! { dg-do compile }\n+! PR fortran/66107\n+subroutine p\n+ integer n\n+ character(*), parameter :: z(1) = [character(len=n) :: 'x'] ! { dg-error \"Cannot initialize parameter array at .1. with variable length elements\" }\n+end subroutine"}]}