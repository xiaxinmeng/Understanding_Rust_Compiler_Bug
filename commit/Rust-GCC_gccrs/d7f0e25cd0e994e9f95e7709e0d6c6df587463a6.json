{"sha": "d7f0e25cd0e994e9f95e7709e0d6c6df587463a6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDdmMGUyNWNkMGU5OTRlOWY5NWU3NzA5ZTBkNmM2ZGY1ODc0NjNhNg==", "commit": {"author": {"name": "Zdenek Dvorak", "email": "dvorakz@suse.cz", "date": "2005-09-13T07:33:49Z"}, "committer": {"name": "Zdenek Dvorak", "email": "rakdver@gcc.gnu.org", "date": "2005-09-13T07:33:49Z"}, "message": "re PR tree-optimization/23817 (ICE in check_loop_closed_ssa_use, at tree-ssa-loop-manip.c:398)\n\n\tPR tree-optimize/23817\n\t* tree-cfg.c (tree_merge_blocks): Preserve loop closed ssa.\n\nFrom-SVN: r104218", "tree": {"sha": "f9a56ea6be2456fbafe9f55bdd37a21e1c6bb92f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f9a56ea6be2456fbafe9f55bdd37a21e1c6bb92f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6/comments", "author": null, "committer": null, "parents": [{"sha": "7823229bc310fe007b397365afe17ee5e039a3af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7823229bc310fe007b397365afe17ee5e039a3af", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7823229bc310fe007b397365afe17ee5e039a3af"}], "stats": {"total": 18, "additions": 16, "deletions": 2}, "files": [{"sha": "e1900f9377a81dd3489928b684307a6106c16a3b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d7f0e25cd0e994e9f95e7709e0d6c6df587463a6", "patch": "@@ -1,3 +1,8 @@\n+2005-09-13  Zdenek Dvorak  <dvorakz@suse.cz>\n+\n+\tPR tree-optimize/23817\n+\t* tree-cfg.c (tree_merge_blocks): Preserve loop closed ssa.\n+\n 2005-09-13  Alan Modra  <amodra@bigpond.net.au>\n \n \tPR target/23774"}, {"sha": "d5d466edf49f6b9021731d772623e490fbc65256", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d7f0e25cd0e994e9f95e7709e0d6c6df587463a6/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=d7f0e25cd0e994e9f95e7709e0d6c6df587463a6", "patch": "@@ -1314,8 +1314,17 @@ tree_merge_blocks (basic_block a, basic_block b)\n     {\n       tree def = PHI_RESULT (phi), use = PHI_ARG_DEF (phi, 0);\n       tree copy;\n-      \n-      if (!may_propagate_copy (def, use))\n+      bool may_replace_uses = may_propagate_copy (def, use);\n+\n+      /* In case we have loops to care about, do not propagate arguments of\n+\t loop closed ssa phi nodes.  */\n+      if (current_loops\n+\t  && is_gimple_reg (def)\n+\t  && TREE_CODE (use) == SSA_NAME\n+\t  && a->loop_father != b->loop_father)\n+\tmay_replace_uses = false;\n+\n+      if (!may_replace_uses)\n \t{\n \t  gcc_assert (is_gimple_reg (def));\n "}]}