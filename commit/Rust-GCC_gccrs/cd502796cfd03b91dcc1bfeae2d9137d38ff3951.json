{"sha": "cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2Q1MDI3OTZjZmQwM2I5MWRjYzFiZmVhZTJkOTEzN2QzOGZmMzk1MQ==", "commit": {"author": {"name": "Tom Honermann", "email": "tom@honermann.net", "date": "2019-11-29T17:43:51Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2019-11-29T17:43:51Z"}, "message": "libstdc++: P1423R3 char8_t remediation (4/4)\n\nNew tests\n\nThis patch adds new tests to validate new deleted overloads of wchar_t,\nchar8_t, char16_t, and char32_t for ordinary and wide formatted character and\nstring ostream inserters.\n\nAdditionally, new tests are added to validate invocations of u8path with\nsequences of char8_t for both the C++17 and filesystem TS implementations.\n\n2019-11-29  Tom Honermann  <tom@honermann.net>\n\n\tNew tests\n\t* testsuite/27_io/basic_ostream/inserters_character/char/deleted.cc:\n\tNew test to validate deleted overloads of character and string\n\tinserters for narrow ostreams.\n\t* testsuite/27_io/basic_ostream/inserters_character/wchar_t/deleted.cc:\n\tNew test to validate deleted overloads of character and string\n\tinserters for wide ostreams.\n\t* testsuite/27_io/filesystem/path/factory/u8path-char8_t.cc: New test\n\tto validate u8path invocations with sequences of char8_t.\n\t* testsuite/experimental/filesystem/path/factory/u8path-char8_t.cc:\n\tNew test to validate u8path invocations with sequences of char8_t.\n\nFrom-SVN: r278858", "tree": {"sha": "061823412141322e3db5f69e88c015be0d09553f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/061823412141322e3db5f69e88c015be0d09553f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/comments", "author": {"login": "tahonermann", "id": 2211804, "node_id": "MDQ6VXNlcjIyMTE4MDQ=", "avatar_url": "https://avatars.githubusercontent.com/u/2211804?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tahonermann", "html_url": "https://github.com/tahonermann", "followers_url": "https://api.github.com/users/tahonermann/followers", "following_url": "https://api.github.com/users/tahonermann/following{/other_user}", "gists_url": "https://api.github.com/users/tahonermann/gists{/gist_id}", "starred_url": "https://api.github.com/users/tahonermann/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tahonermann/subscriptions", "organizations_url": "https://api.github.com/users/tahonermann/orgs", "repos_url": "https://api.github.com/users/tahonermann/repos", "events_url": "https://api.github.com/users/tahonermann/events{/privacy}", "received_events_url": "https://api.github.com/users/tahonermann/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2b68cdc7e57bc632acba95a1e798493288f0e131", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b68cdc7e57bc632acba95a1e798493288f0e131", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b68cdc7e57bc632acba95a1e798493288f0e131"}], "stats": {"total": 210, "additions": 210, "deletions": 0}, "files": [{"sha": "5cc6aacc0163d62d3f80bc2b3e47412b1bdfc1d5", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "patch": "@@ -1,5 +1,17 @@\n 2019-11-29  Tom Honermann  <tom@honermann.net>\n \n+\tNew tests\n+\t* testsuite/27_io/basic_ostream/inserters_character/char/deleted.cc:\n+\tNew test to validate deleted overloads of character and string\n+\tinserters for narrow ostreams.\n+\t* testsuite/27_io/basic_ostream/inserters_character/wchar_t/deleted.cc:\n+\tNew test to validate deleted overloads of character and string\n+\tinserters for wide ostreams.\n+\t* testsuite/27_io/filesystem/path/factory/u8path-char8_t.cc: New test\n+\tto validate u8path invocations with sequences of char8_t.\n+\t* testsuite/experimental/filesystem/path/factory/u8path-char8_t.cc:\n+\tNew test to validate u8path invocations with sequences of char8_t.\n+\n \tUpdates to existing tests\n \t* testsuite/experimental/feat-char8_t.cc: Updated the expected\n \t__cpp_lib_char8_t feature test macro value."}, {"sha": "f2eb538f42e5b954fdcc6d87fa6a59c5f65aa51e", "filename": "libstdc++-v3/testsuite/27_io/basic_ostream/inserters_character/char/deleted.cc", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_ostream%2Finserters_character%2Fchar%2Fdeleted.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_ostream%2Finserters_character%2Fchar%2Fdeleted.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_ostream%2Finserters_character%2Fchar%2Fdeleted.cc?ref=cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "patch": "@@ -0,0 +1,43 @@\n+// Copyright (C) 2019 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// 29.7.2 Header <ostream> synopsys; deleted character inserters.\n+\n+// Test character inserters defined as deleted by P1423.\n+\n+// { dg-options \"-std=gnu++2a\" }\n+// { dg-do compile { target c++2a } }\n+\n+#include <ostream>\n+\n+void test_character_inserters(std::ostream &os)\n+{\n+  os << 'x';   // ok.\n+  os << L'x';  // { dg-error \"use of deleted function\" }\n+  os << u8'x'; // { dg-error \"use of deleted function\" }\n+  os << u'x';  // { dg-error \"use of deleted function\" }\n+  os << U'x';  // { dg-error \"use of deleted function\" }\n+}\n+\n+void test_string_inserters(std::ostream &os)\n+{\n+  os << \"text\";  // ok.\n+  os << L\"text\";  // { dg-error \"use of deleted function\" }\n+  os << u8\"text\"; // { dg-error \"use of deleted function\" }\n+  os << u\"text\";  // { dg-error \"use of deleted function\" }\n+  os << U\"text\";  // { dg-error \"use of deleted function\" }\n+}"}, {"sha": "1422a01aab3667ddcfd76d48d8d40d9ecb4cd488", "filename": "libstdc++-v3/testsuite/27_io/basic_ostream/inserters_character/wchar_t/deleted.cc", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_ostream%2Finserters_character%2Fwchar_t%2Fdeleted.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_ostream%2Finserters_character%2Fwchar_t%2Fdeleted.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Fbasic_ostream%2Finserters_character%2Fwchar_t%2Fdeleted.cc?ref=cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "patch": "@@ -0,0 +1,43 @@\n+// Copyright (C) 2019 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// 29.7.2 Header <ostream> synopsys; deleted character inserters.\n+\n+// Test wide character inserters defined as deleted by P1423.\n+\n+// { dg-options \"-std=gnu++2a\" }\n+// { dg-do compile { target c++2a } }\n+\n+#include <ostream>\n+\n+void test_character_inserters(std::wostream &os)\n+{\n+  os << 'x';   // ok.\n+  os << L'x';  // ok.\n+  os << u8'x'; // { dg-error \"use of deleted function\" }\n+  os << u'x';  // { dg-error \"use of deleted function\" }\n+  os << U'x';  // { dg-error \"use of deleted function\" }\n+}\n+\n+void test_string_inserters(std::wostream &os)\n+{\n+  os << \"text\";   // ok.\n+  os << L\"text\";  // ok.\n+  os << u8\"text\"; // { dg-error \"use of deleted function\" }\n+  os << u\"text\";  // { dg-error \"use of deleted function\" }\n+  os << U\"text\";  // { dg-error \"use of deleted function\" }\n+}"}, {"sha": "867ee5b38565bfea5bcbfee7690fcccc29780677", "filename": "libstdc++-v3/testsuite/27_io/filesystem/path/factory/u8path-char8_t.cc", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Fpath%2Ffactory%2Fu8path-char8_t.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Fpath%2Ffactory%2Fu8path-char8_t.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Fpath%2Ffactory%2Fu8path-char8_t.cc?ref=cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "patch": "@@ -0,0 +1,60 @@\n+// Copyright (C) 2019 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-std=gnu++17 -fchar8_t\" }\n+// { dg-do run { target c++17 } }\n+\n+#include <filesystem>\n+#include <string_view>\n+#include <testsuite_hooks.h>\n+\n+namespace fs = std::filesystem;\n+\n+void\n+test01()\n+{\n+  fs::path p = fs::u8path(u8\"\");\n+  VERIFY( p.empty() );\n+\n+  p = fs::u8path(u8\"filename1\");\n+  VERIFY( p.u8string() == u8\"filename1\" );\n+\n+  p = fs::u8path(u8\"\\xf0\\x9d\\x84\\x9e\");\n+  VERIFY( p.u8string() == u8\"\\U0001D11E\" );\n+\n+  std::u8string s1 = u8\"filename2\";\n+  p = fs::u8path(s1);\n+  VERIFY( p.u8string() == u8\"filename2\" );\n+\n+  std::u8string s2 = u8\"filename3\";\n+  p = fs::u8path(s2.begin(), s2.end());\n+  VERIFY( p.u8string() == u8\"filename3\" );\n+\n+  std::u8string_view sv1{ s1 };\n+  p = fs::u8path(sv1);\n+  VERIFY( p.u8string() == u8\"filename2\" );\n+\n+  std::u8string_view sv2{ s2 };\n+  p = fs::u8path(sv2.begin(), sv2.end());\n+  VERIFY( p.u8string() == u8\"filename3\" );\n+}\n+\n+int\n+main()\n+{\n+  test01();\n+}"}, {"sha": "dc509c3f912f3feb3a34cbe0a462ef2aab44f784", "filename": "libstdc++-v3/testsuite/experimental/filesystem/path/factory/u8path-char8_t.cc", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Ffilesystem%2Fpath%2Ffactory%2Fu8path-char8_t.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cd502796cfd03b91dcc1bfeae2d9137d38ff3951/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Ffilesystem%2Fpath%2Ffactory%2Fu8path-char8_t.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fexperimental%2Ffilesystem%2Fpath%2Ffactory%2Fu8path-char8_t.cc?ref=cd502796cfd03b91dcc1bfeae2d9137d38ff3951", "patch": "@@ -0,0 +1,52 @@\n+// Copyright (C) 2019 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-lstdc++fs -fchar8_t\" }\n+// { dg-do run { target c++11 } }\n+// { dg-require-filesystem-ts \"\" }\n+\n+#include <experimental/filesystem>\n+#include <testsuite_hooks.h>\n+\n+namespace fs = std::experimental::filesystem;\n+\n+void\n+test01()\n+{\n+  fs::path p = fs::u8path(u8\"\");\n+  VERIFY( p.empty() );\n+\n+  p = fs::u8path(u8\"filename1\");\n+  VERIFY( p.u8string() == u8\"filename1\" );\n+\n+  p = fs::u8path(u8\"\\xf0\\x9d\\x84\\x9e\");\n+  VERIFY( p.u8string() == u8\"\\U0001D11E\" );\n+\n+  std::u8string s1 = u8\"filename2\";\n+  p = fs::u8path(s1);\n+  VERIFY( p.u8string() == u8\"filename2\" );\n+\n+  std::u8string s2 = u8\"filename3\";\n+  p = fs::u8path(s2.begin(), s2.end());\n+  VERIFY( p.u8string() == u8\"filename3\" );\n+}\n+\n+int\n+main()\n+{\n+  test01();\n+}"}]}