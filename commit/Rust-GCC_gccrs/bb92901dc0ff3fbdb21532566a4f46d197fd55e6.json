{"sha": "bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmI5MjkwMWRjMGZmM2ZiZGIyMTUzMjU2NmE0ZjQ2ZDE5N2ZkNTVlNg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2000-11-28T10:31:09Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2000-11-28T10:31:09Z"}, "message": "parse.y (base_class.1): Produce a _TYPE not a _DECL.\n\ncp:\n\t* parse.y (base_class.1): Produce a _TYPE not a _DECL.\n\t* semantics.c (finish_base_specifier): Accept a _TYPE not a\n\t_DECL.\ntestsuite:\n\t* g++.old-deja/g++.other/base1.C: New test.\n\nFrom-SVN: r37817", "tree": {"sha": "6d5658cba4a32592b02ffd5c3b7cf207e789b6be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6d5658cba4a32592b02ffd5c3b7cf207e789b6be"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/comments", "author": null, "committer": null, "parents": [{"sha": "2f3608c33e4b7787fb460981463958df9caf387e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f3608c33e4b7787fb460981463958df9caf387e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f3608c33e4b7787fb460981463958df9caf387e"}], "stats": {"total": 59, "additions": 42, "deletions": 17}, "files": [{"sha": "e0c75484634f9da28b8765de390ef2a8eb781305", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "patch": "@@ -1,3 +1,9 @@\n+2000-11-28  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* parse.y (base_class.1): Produce a _TYPE not a _DECL.\n+\t* semantics.c (finish_base_specifier): Accept a _TYPE not a\n+\t_DECL.\n+\n 2000-11-28  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* spew.c (yyerror): Cope if yylval.ttype is NULL."}, {"sha": "4c03dc74c03023dee59dc44ba3db68861caa35f1", "filename": "gcc/cp/parse.y", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Fcp%2Fparse.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Fcp%2Fparse.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparse.y?ref=bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "patch": "@@ -2460,13 +2460,10 @@ base_class:\n \n base_class.1:\n \t  typename_sub\n-\t\t{ if ($$ == error_mark_node)\n-\t\t    ;\n-                  else if (!TYPE_P ($$))\n-\t\t    $$ = error_mark_node;\n-\t\t  else \n-\t\t    $$ = TYPE_MAIN_DECL ($1); }\n+\t\t{ if (!TYPE_P ($$))\n+\t\t    $$ = error_mark_node; }\n \t| nonnested_type\n+\t\t{ $$ = TREE_TYPE ($$); }\n \t;\n \n base_class_access_list:"}, {"sha": "8502eeff1021a7678dd9a1b9cdfea3d9a7f04d13", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 9, "deletions": 11, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "patch": "@@ -2068,21 +2068,19 @@ finish_base_specifier (access_specifier, base_class)\n      tree access_specifier;\n      tree base_class;\n {\n-  tree type;\n   tree result;\n \n-  if (base_class == NULL_TREE)\n-    {\n-      error (\"invalid base class\");\n-      type = error_mark_node;\n-    }\n-  else\n-    type = TREE_TYPE (base_class);\n-\n-  if (! is_aggr_type (type, 1))\n+  if (! is_aggr_type (base_class, 1))\n     result = NULL_TREE;\n   else\n-    result = build_tree_list (access_specifier, type);\n+    {\n+      if (CP_TYPE_QUALS (base_class) != 0)\n+        {\n+          cp_error (\"base class `%T' has cv qualifiers\", base_class);\n+          base_class = TYPE_MAIN_VARIANT (base_class);\n+        }\n+      result = build_tree_list (access_specifier, base_class);\n+    }\n \n   return result;\n }"}, {"sha": "f60af3fdc8203ff9e4287f26c90592d5b3846782", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "patch": "@@ -1,3 +1,7 @@\n+2000-11-28  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.old-deja/g++.other/base1.C: New test.\n+\n 2000-11-28  Nathan Sidwell  <nathan@codesourcery.com>\n \n \t* g++.old-deja/g++.other/parse2.C: New test."}, {"sha": "ace821c4e5c05529abce2393046ac4ed45939554", "filename": "gcc/testsuite/g++.old-deja/g++.other/base1.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fbase1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bb92901dc0ff3fbdb21532566a4f46d197fd55e6/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fbase1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fbase1.C?ref=bb92901dc0ff3fbdb21532566a4f46d197fd55e6", "patch": "@@ -0,0 +1,20 @@\n+// Build don't link:\n+\n+// Copyright (C) 2000 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 25 Nov 2000 <nathan@codesourcery.com>\n+\n+// We lost information about which base wasn't an aggregate type, plus we\n+// allowed cv qualifed bases via typedefs.\n+\n+typedef int I;\n+typedef int cI;\n+\n+struct A {};\n+\n+typedef const A cA;\n+typedef A pA;\n+\n+struct B : I {};  // ERROR - not an aggregate\n+struct C : cI {}; // ERROR - not an aggregate\n+struct D : cA {}; // ERROR - cv qualified\n+struct E : pA {};"}]}