{"sha": "796f5220c808bc37adbd1081476589ab1a5d7ac3", "node_id": "C_kwDOANBUbNoAKDc5NmY1MjIwYzgwOGJjMzdhZGJkMTA4MTQ3NjU4OWFiMWE1ZDdhYzM", "commit": {"author": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2022-03-08T17:46:40Z"}, "committer": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2022-03-08T17:50:51Z"}, "message": "arm: MVE: Relax addressing modes for full loads and stores\n\nThis patch relaxes the addressing modes for the mve full load and stores (by\nfull loads and stores I mean non-widening or narrowing loads and stores resp).\nThe code before was requiring a LO_REGNUM for these, where this is only a\nrequirement if the load is widening or the store narrowing.\n\ngcc/ChangeLog:\n\n\tPR target/104790\n\t* config/arm/arm.h (MVE_STN_LDW_MODE): New MACRO.\n\t* config/arm/arm.cc (mve_vector_mem_operand): Relax constraint on base\n\tregister for non widening loads or narrowing stores.", "tree": {"sha": "6aced8f7717aec1f6bc765875b7c90d201a91b38", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6aced8f7717aec1f6bc765875b7c90d201a91b38"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/796f5220c808bc37adbd1081476589ab1a5d7ac3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/796f5220c808bc37adbd1081476589ab1a5d7ac3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/796f5220c808bc37adbd1081476589ab1a5d7ac3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/796f5220c808bc37adbd1081476589ab1a5d7ac3/comments", "author": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "6319391d5634ceb07abfadfaabee25e403f5110a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6319391d5634ceb07abfadfaabee25e403f5110a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6319391d5634ceb07abfadfaabee25e403f5110a"}], "stats": {"total": 29, "additions": 17, "deletions": 12}, "files": [{"sha": "e062361b985752f00be0013caf66ebde4dae2d1c", "filename": "gcc/config/arm/arm.cc", "status": "modified", "additions": 13, "deletions": 12, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/796f5220c808bc37adbd1081476589ab1a5d7ac3/gcc%2Fconfig%2Farm%2Farm.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/796f5220c808bc37adbd1081476589ab1a5d7ac3/gcc%2Fconfig%2Farm%2Farm.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.cc?ref=796f5220c808bc37adbd1081476589ab1a5d7ac3", "patch": "@@ -13521,27 +13521,28 @@ mve_vector_mem_operand (machine_mode mode, rtx op, bool strict)\n \t  case E_V16QImode:\n \t  case E_V8QImode:\n \t  case E_V4QImode:\n-\t    if (abs (val) <= 127)\n-\t      return (reg_no < LAST_ARM_REGNUM && reg_no != SP_REGNUM)\n-\t\t|| reg_no >= FIRST_PSEUDO_REGISTER;\n-\t    return FALSE;\n+\t    if (abs (val) > 127)\n+\t      return FALSE;\n+\t    break;\n \t  case E_V8HImode:\n \t  case E_V8HFmode:\n \t  case E_V4HImode:\n \t  case E_V4HFmode:\n-\t    if (val % 2 == 0 && abs (val) <= 254)\n-\t      return reg_no <= LAST_LO_REGNUM\n-\t\t|| reg_no >= FIRST_PSEUDO_REGISTER;\n-\t    return FALSE;\n+\t    if (val % 2 != 0 || abs (val) > 254)\n+\t      return FALSE;\n+\t    break;\n \t  case E_V4SImode:\n \t  case E_V4SFmode:\n-\t    if (val % 4 == 0 && abs (val) <= 508)\n-\t      return (reg_no < LAST_ARM_REGNUM && reg_no != SP_REGNUM)\n-\t\t|| reg_no >= FIRST_PSEUDO_REGISTER;\n-\t    return FALSE;\n+\t    if (val % 4 != 0 || abs (val) > 508)\n+\t      return FALSE;\n+\t    break;\n \t  default:\n \t    return FALSE;\n \t}\n+      return reg_no >= FIRST_PSEUDO_REGISTER\n+\t|| (MVE_STN_LDW_MODE (mode)\n+\t    ? reg_no <= LAST_LO_REGNUM\n+\t    : (reg_no < LAST_ARM_REGNUM && reg_no != SP_REGNUM));\n     }\n   return FALSE;\n }"}, {"sha": "f479540812a76e593bd1d55d9ac591cc9f8f8d07", "filename": "gcc/config/arm/arm.h", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/796f5220c808bc37adbd1081476589ab1a5d7ac3/gcc%2Fconfig%2Farm%2Farm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/796f5220c808bc37adbd1081476589ab1a5d7ac3/gcc%2Fconfig%2Farm%2Farm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.h?ref=796f5220c808bc37adbd1081476589ab1a5d7ac3", "patch": "@@ -1099,6 +1099,10 @@ extern const int arm_arch_cde_coproc_bits[];\n   ((MODE) == V2DImode ||(MODE) == V4SImode || (MODE) == V8HImode \\\n    || (MODE) == V16QImode)\n \n+/* Modes used in MVE's narrowing stores or widening loads.  */\n+#define MVE_STN_LDW_MODE(MODE) \\\n+  ((MODE) == V4QImode || (MODE) == V8QImode || (MODE) == V4HImode)\n+\n #define VALID_MVE_SF_MODE(MODE) \\\n   ((MODE) == V8HFmode || (MODE) == V4SFmode || (MODE) == V2DFmode)\n "}]}