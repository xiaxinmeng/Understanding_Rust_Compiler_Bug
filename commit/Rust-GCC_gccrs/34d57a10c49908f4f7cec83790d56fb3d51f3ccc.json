{"sha": "34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzRkNTdhMTBjNDk5MDhmNGY3Y2VjODM3OTBkNTZmYjNkNTFmM2NjYw==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2017-04-20T18:02:05Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2017-04-20T18:02:05Z"}, "message": "PR c++/80473 allow suppressing notes about over-aligned new\n\ngcc/cp:\n\n\tPR c++/80473\n\t* init.c (build_new_1): Suppress notes about over-aligned new when\n\tthe warning is suppressed.\n\ngcc/testsuite:\n\n\tPR c++/80473\n\t* g++.dg/diagnostic/pr80473.C: New test.\n\nFrom-SVN: r247033", "tree": {"sha": "8c4cdf8a858e2c294dc570a7077391e44a7aefa4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8c4cdf8a858e2c294dc570a7077391e44a7aefa4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2260d19d4be6218c0dfffe6f87fc7665a09d5ba5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2260d19d4be6218c0dfffe6f87fc7665a09d5ba5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2260d19d4be6218c0dfffe6f87fc7665a09d5ba5"}], "stats": {"total": 43, "additions": 36, "deletions": 7}, "files": [{"sha": "5e14c411b71959b7f71e41daf53bb7b1dff6ff62", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "patch": "@@ -1,3 +1,9 @@\n+2017-04-20  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR c++/80473\n+\t* init.c (build_new_1): Suppress notes about over-aligned new when\n+\tthe warning is suppressed.\n+\n 2017-04-20  Volker Reichelt  <v.reichelt@netcologne.de>\n \n \t* parser.c (cp_parser_member_declaration): Add warning with fixit"}, {"sha": "e9c39ff25e6df09d8bedb454e6949a323ba2e7ed", "filename": "gcc/cp/init.c", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "patch": "@@ -3126,13 +3126,15 @@ build_new_1 (vec<tree, va_gc> **placement, tree type, tree nelts,\n \t  || CP_DECL_CONTEXT (alloc_fn) == global_namespace)\n       && !aligned_allocation_fn_p (alloc_fn))\n     {\n-      warning (OPT_Waligned_new_, \"%<new%> of type %qT with extended \"\n-\t       \"alignment %d\", elt_type, TYPE_ALIGN_UNIT (elt_type));\n-      inform (input_location, \"uses %qD, which does not have an alignment \"\n-\t      \"parameter\", alloc_fn);\n-      if (!aligned_new_threshold)\n-\tinform (input_location, \"use %<-faligned-new%> to enable C++17 \"\n-\t\t\t\t\"over-aligned new support\");\n+      if (warning (OPT_Waligned_new_, \"%<new%> of type %qT with extended \"\n+\t\t   \"alignment %d\", elt_type, TYPE_ALIGN_UNIT (elt_type)))\n+\t{\n+\t  inform (input_location, \"uses %qD, which does not have an alignment \"\n+\t\t  \"parameter\", alloc_fn);\n+\t  if (!aligned_new_threshold)\n+\t    inform (input_location, \"use %<-faligned-new%> to enable C++17 \"\n+\t\t\t\t    \"over-aligned new support\");\n+\t}\n     }\n \n   /* If we found a simple case of PLACEMENT_EXPR above, then copy it"}, {"sha": "2db33222a390a676c6a5a24eace9d52d48483b6a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "patch": "@@ -1,3 +1,8 @@\n+2017-04-20  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR c++/80473\n+\t* g++.dg/diagnostic/pr80473.C: New test.\n+\n 2017-04-20  Volker Reichelt  <v.reichelt@netcologne.de>\n \n \t* g++.dg/warn/Wextra-semi.C: New test."}, {"sha": "87212130e938a5accaa52004be2b1ed849a389c1", "filename": "gcc/testsuite/g++.dg/diagnostic/pr80473.C", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fpr80473.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34d57a10c49908f4f7cec83790d56fb3d51f3ccc/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fpr80473.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdiagnostic%2Fpr80473.C?ref=34d57a10c49908f4f7cec83790d56fb3d51f3ccc", "patch": "@@ -0,0 +1,16 @@\n+// { dg-options \"-Wall -w\" }\n+// { dg-do compile { target c++11 } }\n+// { dg-bogus \"over-aligned new\" \"PR c++/80473\" { target *-*-* } 0 }\n+\n+template<typename T> T&& declval();\n+\n+template<typename T, typename U, typename = void>\n+struct is_constructible { enum { value = 0 }; };\n+\n+template<typename T, typename U>\n+struct is_constructible<T, U, decltype(::new T(declval<U>()), void())>\n+{ enum { value = 1 }; };\n+\n+struct alignas(64) A { int i; };\n+\n+constexpr bool b = is_constructible<A, A>::value;"}]}