{"sha": "9ba64a4a382e7d01caf84b02a6a839cdf168133b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWJhNjRhNGEzODJlN2QwMWNhZjg0YjAyYTZhODM5Y2RmMTY4MTMzYg==", "commit": {"author": {"name": "Sebastian Pop", "email": "pop@cri.ensmp.fr", "date": "2004-11-12T00:13:06Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2004-11-12T00:13:06Z"}, "message": "re PR middle-end/18005 (ICE with simple loop with VLA)\n\n\n\t* tree-data-ref.c (analyze_subscript_affine_affine): Correctly\n\tcompute the first overlapping iterations.\n\n\tPR middle-end/18005\n\t* tree-data-ref.c (estimate_niter_from_size_of_data): Ensure\n\tthat arguments of EXACT_DIV_EXPR are INTEGER_CST.\n\nFrom-SVN: r90510", "tree": {"sha": "cedabec28787948d73190a83bfd0ca0b29d95d61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cedabec28787948d73190a83bfd0ca0b29d95d61"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ba64a4a382e7d01caf84b02a6a839cdf168133b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ba64a4a382e7d01caf84b02a6a839cdf168133b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ba64a4a382e7d01caf84b02a6a839cdf168133b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ba64a4a382e7d01caf84b02a6a839cdf168133b/comments", "author": null, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f41f5287c2d75685050ff1772a319f6b301e87e6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f41f5287c2d75685050ff1772a319f6b301e87e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f41f5287c2d75685050ff1772a319f6b301e87e6"}], "stats": {"total": 31, "additions": 26, "deletions": 5}, "files": [{"sha": "3ed9d24c5ff1544e5c1168b4cb2bc92a5c849399", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ba64a4a382e7d01caf84b02a6a839cdf168133b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ba64a4a382e7d01caf84b02a6a839cdf168133b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9ba64a4a382e7d01caf84b02a6a839cdf168133b", "patch": "@@ -1,3 +1,14 @@\n+2004-11-12  Sebastian Pop  <pop@cri.ensmp.fr>\n+\n+\t* tree-data-ref.c (analyze_subscript_affine_affine): Correctly\n+\tcompute the first overlapping iterations.\n+\n+2004-11-12  Sebastian Pop  <pop@cri.ensmp.fr>\n+\n+\tPR middle-end/18005\n+\t* tree-data-ref.c (estimate_niter_from_size_of_data): Ensure \n+\tthat arguments of EXACT_DIV_EXPR are INTEGER_CST.\n+\n 2004-11-12  Steven Bosscher  <stevenb@suse.de>\n \n \tPR tree-optimization/18419"}, {"sha": "718059fffd848035d6f39fc8739df94fd0d45fad", "filename": "gcc/tree-data-ref.c", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ba64a4a382e7d01caf84b02a6a839cdf168133b/gcc%2Ftree-data-ref.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ba64a4a382e7d01caf84b02a6a839cdf168133b/gcc%2Ftree-data-ref.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-data-ref.c?ref=9ba64a4a382e7d01caf84b02a6a839cdf168133b", "patch": "@@ -513,11 +513,12 @@ estimate_niter_from_size_of_data (struct loop *loop,\n   array_size = TYPE_SIZE (TREE_TYPE (opnd0));\n   element_size = TYPE_SIZE (TREE_TYPE (TREE_TYPE (opnd0)));\n   if (array_size == NULL_TREE \n-      || element_size == NULL_TREE)\n+      || TREE_CODE (array_size) != INTEGER_CST\n+      || TREE_CODE (element_size) != INTEGER_CST)\n     return;\n \n   data_size = fold (build2 (EXACT_DIV_EXPR, integer_type_node, \n-\t\t\t   array_size, element_size));\n+\t\t\t    array_size, element_size));\n \n   if (init != NULL_TREE\n       && step != NULL_TREE\n@@ -1435,12 +1436,21 @@ analyze_subscript_affine_affine (tree chrec_a,\n \n \t\t  if (j1 > 0)\n \t\t    {\n-\t\t      int last_conflict;\n+\t\t      int last_conflict, min_multiple;\n \t\t      tau1 = MAX (tau1, CEIL (-j0, j1));\n \t\t      tau2 = MIN (tau2, FLOOR_DIV (niter - j0, j1));\n \n-\t\t      x0 = (i1 * tau1 + i0) % i1;\n-\t\t      y0 = (j1 * tau1 + j0) % j1;\n+\t\t      x0 = i1 * tau1 + i0;\n+\t\t      y0 = j1 * tau1 + j0;\n+\n+\t\t      /* At this point (x0, y0) is one of the\n+\t\t\t solutions to the Diophantine equation.  The\n+\t\t\t next step has to compute the smallest\n+\t\t\t positive solution: the first conflicts.  */\n+\t\t      min_multiple = MIN (x0 / i1, y0 / j1);\n+\t\t      x0 -= i1 * min_multiple;\n+\t\t      y0 -= j1 * min_multiple;\n+\n \t\t      tau1 = (x0 - i0)/i1;\n \t\t      last_conflict = tau2 - tau1;\n "}]}