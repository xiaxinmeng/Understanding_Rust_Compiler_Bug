{"sha": "ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmE5YTg2MjViMGE3ZWRkYjIzN2QxNDBlODlkZGI3OGFmZDFlMzUzOQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2018-10-19T07:17:20Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2018-10-19T07:17:20Z"}, "message": "cfgexpand.c (expand_one_var): Use specific wording in error message for non-local frame variables.\n\n\t* cfgexpand.c (expand_one_var): Use specific wording in error message\n\tfor non-local frame variables.\n\t* stor-layout.c (layout_decl): Do not issue a warning for them.\n\nFrom-SVN: r265305", "tree": {"sha": "5de81f3816c8f5b37652cdeee06c9657d98e97e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5de81f3816c8f5b37652cdeee06c9657d98e97e1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/comments", "author": null, "committer": null, "parents": [{"sha": "079c81d010e3303c8fdbc4669bf3907fe7a37052", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/079c81d010e3303c8fdbc4669bf3907fe7a37052", "html_url": "https://github.com/Rust-GCC/gccrs/commit/079c81d010e3303c8fdbc4669bf3907fe7a37052"}], "stats": {"total": 45, "additions": 42, "deletions": 3}, "files": [{"sha": "88ec6863128fdaa32cbd91b605e3f34b2a842330", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "patch": "@@ -1,3 +1,9 @@\n+2018-10-19  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* cfgexpand.c (expand_one_var): Use specific wording in error message\n+\tfor non-local frame variables.\n+\t* stor-layout.c (layout_decl): Do not issue a warning for them.\n+\n 2018-10-19  Robin Dapp  <rdapp@linux.ibm.com>\n \n \t* haifa-sched.c (priority): Add force_recompute parameter."}, {"sha": "9d1eab6dfe2ef7c254a550fb781ca300f7a79f38", "filename": "gcc/cfgexpand.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Fcfgexpand.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Fcfgexpand.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgexpand.c?ref=ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "patch": "@@ -1674,7 +1674,12 @@ expand_one_var (tree var, bool toplevel, bool really_expand)\n       /* Reject variables which cover more than half of the address-space.  */\n       if (really_expand)\n \t{\n-\t  error (\"size of variable %q+D is too large\", var);\n+\t  if (DECL_NONLOCAL_FRAME (var))\n+\t    error_at (DECL_SOURCE_LOCATION (current_function_decl),\n+\t\t      \"total size of local objects is too large\");\n+\t  else\n+\t    error_at (DECL_SOURCE_LOCATION (var),\n+\t\t      \"size of variable %q+D is too large\", var);\n \t  expand_one_error_var (var);\n \t}\n     }"}, {"sha": "42df257556895a800decd901c16ea2a906c37942", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "patch": "@@ -755,8 +755,8 @@ layout_decl (tree decl, unsigned int known_align)\n     DECL_SIZE_UNIT (decl) = variable_size (DECL_SIZE_UNIT (decl));\n \n   /* If requested, warn about definitions of large data objects.  */\n-  if ((code == VAR_DECL || code == PARM_DECL)\n-      && ! DECL_EXTERNAL (decl))\n+  if ((code == PARM_DECL || (code == VAR_DECL && !DECL_NONLOCAL_FRAME (decl)))\n+      && !DECL_EXTERNAL (decl))\n     {\n       tree size = DECL_SIZE_UNIT (decl);\n "}, {"sha": "edceccd0c3e1c31f9b39dcb4672d4c0e8d09f476", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "patch": "@@ -1,3 +1,7 @@\n+2018-10-19  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/frame_overflow2.adb: New test.\n+\n 2018-10-18  H.J. Lu  <hongjiu.lu@intel.com>\n \n \tPR target/72782"}, {"sha": "64f0194c9643c0880de0a2b09b3696db59814277", "filename": "gcc/testsuite/gnat.dg/frame_overflow2.adb", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Ftestsuite%2Fgnat.dg%2Fframe_overflow2.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ba9a8625b0a7eddb237d140e89ddb78afd1e3539/gcc%2Ftestsuite%2Fgnat.dg%2Fframe_overflow2.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fframe_overflow2.adb?ref=ba9a8625b0a7eddb237d140e89ddb78afd1e3539", "patch": "@@ -0,0 +1,24 @@\n+-- { dg-do compile }\n+\n+with System;\n+\n+procedure Frame_Overflow2 is -- { dg-error \"too large\" }\n+\n+  type Index_T is range 1 .. 2**(System.Word_Size - 1) - 1;\n+\n+  type SetArray is array (Index_T) of Boolean;\n+\n+  type Set is record\n+    Store: SetArray := (Others => False);\n+  end record;\n+\n+  Phi: constant Set := (Store => (Others => False));\n+\n+  function F return Set is\n+  begin\n+    return Phi;\n+  end;\n+\n+begin\n+  null;\n+end;"}]}