{"sha": "4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGU2MDUxNWY5YTZjYjdhNmMyZmQ1OWE5ZTNhMTYwMWE5MjlkZWI5Mg==", "commit": {"author": {"name": "Steve Ellcey", "email": "sje@cup.hp.com", "date": "2006-09-20T16:41:12Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2006-09-20T16:41:12Z"}, "message": "re PR target/28574 (switch statement points to unreferenced label at -O2)\n\n\tPR target/28574\n\t* ifcvt.c (dead_or_predicable): Don't predicate then blocks\n\twith tablejumps in them.\n\nFrom-SVN: r117084", "tree": {"sha": "6e044ba861af2f20d86a11086e84eb3657abdfd5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6e044ba861af2f20d86a11086e84eb3657abdfd5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92/comments", "author": null, "committer": null, "parents": [{"sha": "d7f245b19d871058abf50fc7c1cd734720f347a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d7f245b19d871058abf50fc7c1cd734720f347a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d7f245b19d871058abf50fc7c1cd734720f347a7"}], "stats": {"total": 87, "additions": 87, "deletions": 0}, "files": [{"sha": "640c4b9aa32a76e3f4df8309e3879a8676ae751e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92", "patch": "@@ -1,3 +1,9 @@\n+2006-09-20  Steve Ellcey  <sje@cup.hp.com>\n+\n+\tPR target/28574\n+\t* ifcvt.c (dead_or_predicable): Don't predicate then blocks\n+\twith tablejumps in them.\n+\n 2006-09-20  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/28046"}, {"sha": "41da0b3af16da59827377cee347c316deab7373d", "filename": "gcc/ifcvt.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92/gcc%2Fifcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92/gcc%2Fifcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fifcvt.c?ref=4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92", "patch": "@@ -3560,6 +3560,13 @@ dead_or_predicable (basic_block test_bb, basic_block merge_bb,\n   head = BB_HEAD (merge_bb);\n   end = BB_END (merge_bb);\n \n+  /* If merge_bb ends with a tablejump, predicating/moving insn's\n+     into test_bb and then deleting merge_bb will result in the jumptable\n+     that follows merge_bb being removed along with merge_bb and then we\n+     get an unresolved reference to the jumptable.  */\n+  if (tablejump_p (end, NULL, NULL))\n+    return FALSE;\n+\n   if (LABEL_P (head))\n     head = NEXT_INSN (head);\n   if (NOTE_P (head))"}, {"sha": "f5ff6c01db4dd4e41cbbbd368034b1f431760c94", "filename": "gcc/testsuite/gcc.dg/pr28574.c", "status": "added", "additions": 74, "deletions": 0, "changes": 74, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92/gcc%2Ftestsuite%2Fgcc.dg%2Fpr28574.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92/gcc%2Ftestsuite%2Fgcc.dg%2Fpr28574.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr28574.c?ref=4e60515f9a6cb7a6c2fd59a9e3a1601a929deb92", "patch": "@@ -0,0 +1,74 @@\n+/* On IA64 This test resulted in a missing jumptable and an undefined\n+   reference    to a label.  Make sure we can compile and link it with\n+   no undefs at -O2.  */\n+\n+/* { dg-do link } */\n+/* { dg-options \"-O2\" } */\n+\n+typedef enum yasm_module_type {\n+    YASM_MODULE_ARCH = 0,\n+    YASM_MODULE_DBGFMT,\n+    YASM_MODULE_OBJFMT,\n+    YASM_MODULE_LISTFMT,\n+    YASM_MODULE_OPTIMIZER\n+} yasm_module_type;\n+\n+struct yasm_module {\n+    const char *name;\n+};\n+\n+typedef struct yasm_module yasm_arch_module;\n+typedef struct yasm_module yasm_dbgfmt_module;\n+typedef struct yasm_module yasm_objfmt_module;\n+typedef struct yasm_module yasm_listfmt_module;\n+typedef struct yasm_module yasm_optimizer_module;\n+\n+typedef struct module {\n+    void *data;\n+} module;\n+\n+static struct {\n+    module *m;\n+    int n;\n+} module_types[] = {\n+ {},\n+};\n+\n+void\n+yasm_list_modules(yasm_module_type type,\n+                  void (*printfunc) (const char *name))\n+{\n+    int i;\n+    module *modules = module_types[type].m;\n+    yasm_arch_module *arch;\n+    yasm_dbgfmt_module *dbgfmt;\n+    yasm_objfmt_module *objfmt;\n+    yasm_listfmt_module *listfmt;\n+    yasm_optimizer_module *optimizer;\n+\n+    for (i=0; i<2; i++) {\n+        switch (type) {\n+            case YASM_MODULE_ARCH:\n+                arch = modules[i].data;\n+                printfunc(arch->name);\n+                break;\n+            case YASM_MODULE_DBGFMT:\n+                dbgfmt = modules[i].data;\n+                printfunc(dbgfmt->name);\n+                break;\n+            case YASM_MODULE_OBJFMT:\n+                objfmt = modules[i].data;\n+                printfunc(objfmt->name);\n+                break;\n+            case YASM_MODULE_LISTFMT:\n+                listfmt = modules[i].data;\n+                printfunc(listfmt->name);\n+                break;\n+            case YASM_MODULE_OPTIMIZER:\n+                optimizer = modules[i].data;\n+                printfunc(optimizer->name);\n+        }\n+    }\n+}\n+\n+main() {}"}]}