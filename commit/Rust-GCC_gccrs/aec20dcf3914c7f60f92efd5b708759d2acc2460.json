{"sha": "aec20dcf3914c7f60f92efd5b708759d2acc2460", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWVjMjBkY2YzOTE0YzdmNjBmOTJlZmQ1YjcwODc1OWQyYWNjMjQ2MA==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2014-07-29T17:30:25Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2014-07-29T17:30:25Z"}, "message": "re PR libstdc++/61946 (rope construction, passing allocator referenct without const)\n\n\tPR libstdc++/61946\n\t* include/ext/rope (rope::rope(char_producer<_CharT>*, size_t, bool,\n\tconst allocator_type&)): Pass non-const allocator to\n\t_S_new_RopeFunction.\n\t* testsuite/ext/rope/61946.cc: New.\n\nFrom-SVN: r213220", "tree": {"sha": "fcecc3c812af3319476dfdf300143ec4bdc5c1d9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fcecc3c812af3319476dfdf300143ec4bdc5c1d9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aec20dcf3914c7f60f92efd5b708759d2acc2460", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aec20dcf3914c7f60f92efd5b708759d2acc2460", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aec20dcf3914c7f60f92efd5b708759d2acc2460", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aec20dcf3914c7f60f92efd5b708759d2acc2460/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "212c47b4def1116c3822b6072dcb561be76d6cd3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/212c47b4def1116c3822b6072dcb561be76d6cd3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/212c47b4def1116c3822b6072dcb561be76d6cd3"}], "stats": {"total": 46, "additions": 43, "deletions": 3}, "files": [{"sha": "42cfa7bcf528fe5844488f785db027e972a5f624", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aec20dcf3914c7f60f92efd5b708759d2acc2460/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aec20dcf3914c7f60f92efd5b708759d2acc2460/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=aec20dcf3914c7f60f92efd5b708759d2acc2460", "patch": "@@ -1,3 +1,11 @@\n+2014-07-29  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/61946\n+\t* include/ext/rope (rope::rope(char_producer<_CharT>*, size_t, bool,\n+\tconst allocator_type&)): Pass non-const allocator to\n+\t_S_new_RopeFunction.\n+\t* testsuite/ext/rope/61946.cc: New.\n+\n 2014-07-29  Ed Smith-Rowland  <3dw4rd@verizon.net>\n \n \tPR libstdc++/60037 - SIGFPE in std::generate_canonical<unsigned int...>"}, {"sha": "147b335a8b845e26a7995b889603a402662af89c", "filename": "libstdc++-v3/include/ext/rope", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aec20dcf3914c7f60f92efd5b708759d2acc2460/libstdc%2B%2B-v3%2Finclude%2Fext%2Frope", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aec20dcf3914c7f60f92efd5b708759d2acc2460/libstdc%2B%2B-v3%2Finclude%2Fext%2Frope", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fext%2Frope?ref=aec20dcf3914c7f60f92efd5b708759d2acc2460", "patch": "@@ -1544,7 +1544,7 @@ protected:\n       typedef typename _Base::allocator_type allocator_type;\n       using _Base::_M_tree_ptr;\n       using _Base::get_allocator;\n-      using _Base::_M_get_allocator;      \n+      using _Base::_M_get_allocator;\n       typedef __GC_CONST _CharT* _Cstrptr;\n       \n       static _CharT _S_empty_c_str[1];\n@@ -1876,8 +1876,9 @@ protected:\n \t   const allocator_type& __a = allocator_type())\n       : _Base(__a)\n       {\n-\tthis->_M_tree_ptr = (0 == __len) ?\n-\t  0 : _S_new_RopeFunction(__fn, __len, __delete_fn, __a);\n+\tthis->_M_tree_ptr = (0 == __len)\n+\t  ? 0\n+\t  : _S_new_RopeFunction(__fn, __len, __delete_fn, _M_get_allocator());\n       }\n \n       rope(const rope& __x, const allocator_type& __a = allocator_type())"}, {"sha": "ba73b4856671de8b652d084b94366f8fbaf3dbac", "filename": "libstdc++-v3/testsuite/ext/rope/61946.cc", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aec20dcf3914c7f60f92efd5b708759d2acc2460/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Frope%2F61946.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aec20dcf3914c7f60f92efd5b708759d2acc2460/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Frope%2F61946.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Frope%2F61946.cc?ref=aec20dcf3914c7f60f92efd5b708759d2acc2460", "patch": "@@ -0,0 +1,31 @@\n+// Copyright (C) 2014 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-do compile }\n+\n+#include <ext/rope>\n+\n+struct empty_char_prod : __gnu_cxx::char_producer<char>\n+{\n+  virtual void operator()(size_t, size_t, char*) {}\n+};\n+\n+int main ()\n+{\n+  empty_char_prod* ecp = new empty_char_prod;\n+  __gnu_cxx::crope excrope( ecp, 10L, true );\n+}"}]}