{"sha": "8982b5535c2762f566fd15e5862acf4702a78690", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODk4MmI1NTM1YzI3NjJmNTY2ZmQxNWU1ODYyYWNmNDcwMmE3ODY5MA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-01-14T06:00:48Z"}, "committer": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2020-01-14T16:57:34Z"}, "message": "\tPR c++/92594 - ICE with inherited trivial default ctor.\n\nHere we were getting confused about whether or not pod_tuple has a trivial\ndefault constructor.  bar inherits the trivial e default constructor; the\neffect of calling that inherited constructor is equivalent to calling a\ndefaulted default constructor in bar, so let's treat it as such.\n\n\t* method.c (trivial_fn_p): Treat an inherited default constructor\n\tlike a normal default constructor.", "tree": {"sha": "bdf5240ab2329c992d6e6874ce0dd91feee6edf5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bdf5240ab2329c992d6e6874ce0dd91feee6edf5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8982b5535c2762f566fd15e5862acf4702a78690", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8982b5535c2762f566fd15e5862acf4702a78690", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8982b5535c2762f566fd15e5862acf4702a78690", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8982b5535c2762f566fd15e5862acf4702a78690/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "80de0002429c74626198cefa168c3081c9d90566", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80de0002429c74626198cefa168c3081c9d90566", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80de0002429c74626198cefa168c3081c9d90566"}], "stats": {"total": 24, "additions": 23, "deletions": 1}, "files": [{"sha": "3fd35b437b43a020d8f95577a03fdff4f5d86663", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8982b5535c2762f566fd15e5862acf4702a78690/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8982b5535c2762f566fd15e5862acf4702a78690/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=8982b5535c2762f566fd15e5862acf4702a78690", "patch": "@@ -1,5 +1,9 @@\n 2020-01-14  Jason Merrill  <jason@redhat.com>\n \n+\tPR c++/92594 - ICE with inherited trivial default ctor.\n+\t* method.c (trivial_fn_p): Treat an inherited default constructor\n+\tlike a normal default constructor.\n+\n \tPR c++/92009 - ICE with punning of typeid.\n \t* rtti.c (get_tinfo_desc): Call xref_basetypes.\n \t* constexpr.c (cxx_fold_indirect_ref): Don't strip"}, {"sha": "e20a88febdccc130045ad43fc623aba0b921cbe6", "filename": "gcc/cp/method.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8982b5535c2762f566fd15e5862acf4702a78690/gcc%2Fcp%2Fmethod.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8982b5535c2762f566fd15e5862acf4702a78690/gcc%2Fcp%2Fmethod.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fmethod.c?ref=8982b5535c2762f566fd15e5862acf4702a78690", "patch": "@@ -458,7 +458,12 @@ trivial_fn_p (tree fn)\n   /* If fn is a clone, get the primary variant.  */\n   if (tree prim = DECL_CLONED_FUNCTION (fn))\n     fn = prim;\n-  return type_has_trivial_fn (DECL_CONTEXT (fn), special_function_p (fn));\n+  special_function_kind sfk = special_function_p (fn);\n+  /* An inherited default constructor is equivalent to a non-inherited default\n+     constructor, so let it be trivial.  */\n+  if (sfk == sfk_inheriting_constructor && default_ctor_p (fn))\n+    sfk = sfk_constructor;\n+  return type_has_trivial_fn (DECL_CONTEXT (fn), sfk);\n }\n \n /* PARM is a PARM_DECL for a function which we want to forward to another"}, {"sha": "9afc0e9e5360b01c3cfa3f09df9a4d432791d17c", "filename": "gcc/testsuite/g++.dg/cpp0x/inh-ctor34.C", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8982b5535c2762f566fd15e5862acf4702a78690/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finh-ctor34.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8982b5535c2762f566fd15e5862acf4702a78690/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finh-ctor34.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finh-ctor34.C?ref=8982b5535c2762f566fd15e5862acf4702a78690", "patch": "@@ -0,0 +1,13 @@\n+// PR c++/92594\n+// { dg-do compile { target c++11 } }\n+\n+template <typename _Head> struct tuple {\n+  tuple() : _M_head_impl() {}\n+  _Head _M_head_impl;\n+};\n+template <typename type0> struct pod_tuple { type0 _head; };\n+struct e {};\n+struct bar : e {\n+  using e::e;\n+};\n+int main() { tuple<pod_tuple<bar>> a; }"}]}