{"sha": "7fa6a965355c27a6e493bdcfd285ac622137bf0a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2ZhNmE5NjUzNTVjMjdhNmU0OTNiZGNmZDI4NWFjNjIyMTM3YmYwYQ==", "commit": {"author": {"name": "Prathamesh Kulkarni", "email": "prathamesh.kulkarni@linaro.org", "date": "2016-11-26T10:41:55Z"}, "committer": {"name": "Prathamesh Kulkarni", "email": "prathamesh3492@gcc.gnu.org", "date": "2016-11-26T10:41:55Z"}, "message": "tree.c (build_common_tree_nodes): Initialize ptrdiff_type_node.\n\n2016-11-26  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n\n\t* tree.c (build_common_tree_nodes): Initialize ptrdiff_type_node.\n\t(free_lang_data): Remove assignment to ptrdiff_type_node.\nc-family/\n\t* c-common.c (c_common_nodes_and_builtins): Remove initialization of\n\tptrdiff_type_node.\nlto/\n\t* lto-lang.c (lto_init): Remove initialization of ptrdiff_type_node.\n\nFrom-SVN: r242888", "tree": {"sha": "7fb3110a0d8aafa53f91252bb17aee4308e78f9b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7fb3110a0d8aafa53f91252bb17aee4308e78f9b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7fa6a965355c27a6e493bdcfd285ac622137bf0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fa6a965355c27a6e493bdcfd285ac622137bf0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fa6a965355c27a6e493bdcfd285ac622137bf0a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fa6a965355c27a6e493bdcfd285ac622137bf0a/comments", "author": null, "committer": null, "parents": [{"sha": "55ab8dbf4dcf12dbc1d11526245c8240a69ea120", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55ab8dbf4dcf12dbc1d11526245c8240a69ea120", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55ab8dbf4dcf12dbc1d11526245c8240a69ea120"}], "stats": {"total": 43, "additions": 38, "deletions": 5}, "files": [{"sha": "80124c2091011ff4a1f03037619b1348a8a9cd23", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7fa6a965355c27a6e493bdcfd285ac622137bf0a", "patch": "@@ -1,3 +1,8 @@\n+2016-11-26  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n+\n+\t* tree.c (build_common_tree_nodes): Initialize ptrdiff_type_node.\n+\t(free_lang_data): Remove assignment to ptrdiff_type_node.\n+\n 2016-11-25  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR rtl-optimization/78526"}, {"sha": "183493d6e3ac33f6d6a3879d7976ceffd1592b23", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=7fa6a965355c27a6e493bdcfd285ac622137bf0a", "patch": "@@ -1,3 +1,8 @@\n+2016-11-26  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n+\n+\t* c-common.c (c_common_nodes_and_builtins): Remove initialization of\n+\tptrdiff_type_node;\n+\n 2016-11-23  James Greenhalgh  <james.greenhalgh@arm.com>\n \n \t* c-common.c (excess_precision_mode_join): New."}, {"sha": "0749361fb4414e3197ff38638b0fd8655e2c8ae8", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=7fa6a965355c27a6e493bdcfd285ac622137bf0a", "patch": "@@ -4475,8 +4475,6 @@ c_common_nodes_and_builtins (void)\n \n   default_function_type\n     = build_varargs_function_type_list (integer_type_node, NULL_TREE);\n-  ptrdiff_type_node\n-    = TREE_TYPE (identifier_global_value (get_identifier (PTRDIFF_TYPE)));\n   unsigned_ptrdiff_type_node = c_common_unsigned_type (ptrdiff_type_node);\n \n   lang_hooks.decls.pushdecl"}, {"sha": "7957b2b7deff65d16707470cc89a14b33d8487ab", "filename": "gcc/lto/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Flto%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Flto%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2FChangeLog?ref=7fa6a965355c27a6e493bdcfd285ac622137bf0a", "patch": "@@ -1,3 +1,7 @@\n+2016-11-26  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n+\n+\t* lto-lang.c (lto_init): Remove initialization of ptrdiff_type_node.\n+\n 2016-11-23  Richard Biener  <rguenther@suse.de>\n \n \tPR lto/78472"}, {"sha": "58f6e0c747ef5941fe3e2c6d65ecaee301b12625", "filename": "gcc/lto/lto-lang.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Flto%2Flto-lang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Flto%2Flto-lang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto%2Flto-lang.c?ref=7fa6a965355c27a6e493bdcfd285ac622137bf0a", "patch": "@@ -1271,8 +1271,6 @@ lto_init (void)\n   gcc_assert (TYPE_MAIN_VARIANT (const_tm_ptr_type_node)\n \t      == const_ptr_type_node);\n \n-  ptrdiff_type_node = integer_type_node;\n-\n   lto_build_c_type_nodes ();\n   gcc_assert (va_list_type_node);\n "}, {"sha": "0f0e6753b19bcf027594a1b49144d6d8fc250c3b", "filename": "gcc/tree.c", "status": "modified", "additions": 24, "deletions": 1, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fa6a965355c27a6e493bdcfd285ac622137bf0a/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=7fa6a965355c27a6e493bdcfd285ac622137bf0a", "patch": "@@ -6006,7 +6006,6 @@ free_lang_data (void)\n   free_lang_data_in_cgraph ();\n \n   /* Create gimple variants for common types.  */\n-  ptrdiff_type_node = integer_type_node;\n   fileptr_type_node = ptr_type_node;\n   const_tm_ptr_type_node = const_ptr_type_node;\n \n@@ -10314,6 +10313,30 @@ build_common_tree_nodes (bool signed_char)\n \tgcc_unreachable ();\n     }\n \n+  /* Define what type to use for ptrdiff_t.  */\n+  if (strcmp (PTRDIFF_TYPE, \"int\") == 0)\n+    ptrdiff_type_node = integer_type_node;\n+  else if (strcmp (PTRDIFF_TYPE, \"long int\") == 0)\n+    ptrdiff_type_node = long_integer_type_node;\n+  else if (strcmp (PTRDIFF_TYPE, \"long long int\") == 0)\n+    ptrdiff_type_node = long_long_integer_type_node;\n+  else if (strcmp (PTRDIFF_TYPE, \"short int\") == 0)\n+    ptrdiff_type_node = short_integer_type_node;\n+  else\n+    {\n+      ptrdiff_type_node = NULL_TREE;\n+      for (int i = 0; i < NUM_INT_N_ENTS; i++)\n+\tif (int_n_enabled_p[i])\n+\t  {\n+\t    char name[50];\n+\t    sprintf (name, \"__int%d\", int_n_data[i].bitsize);\n+\t    if (strcmp (name, PTRDIFF_TYPE) == 0)\n+\t      ptrdiff_type_node = int_n_trees[i].signed_type;\n+\t  }\n+      if (ptrdiff_type_node == NULL_TREE)\n+\tgcc_unreachable ();\n+    }\n+\n   /* Fill in the rest of the sized types.  Reuse existing type nodes\n      when possible.  */\n   intQI_type_node = make_or_reuse_type (GET_MODE_BITSIZE (QImode), 0);"}]}