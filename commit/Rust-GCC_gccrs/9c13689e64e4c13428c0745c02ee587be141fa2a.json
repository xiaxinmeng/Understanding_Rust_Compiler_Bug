{"sha": "9c13689e64e4c13428c0745c02ee587be141fa2a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWMxMzY4OWU2NGU0YzEzNDI4YzA3NDVjMDJlZTU4N2JlMTQxZmEyYQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2018-07-25T12:10:13Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2018-07-25T12:10:13Z"}, "message": "re PR lto/86654 (ICE in gen_member_die, at dwarf2out.c:24933)\n\n2018-07-25  Richard Biener  <rguenther@suse.de>\n\n\tPR debug/86654\n\t* dwarf2out.c (dwarf2out_decl): Do not handle nested functions\n\tspecial wrt context_die late.\n\t(gen_subprogram_die): Re-use DIEs in local scope.\n\nFrom-SVN: r262965", "tree": {"sha": "e090c5ebf71c21304c1c60a573bbb118b915ed0b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e090c5ebf71c21304c1c60a573bbb118b915ed0b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9c13689e64e4c13428c0745c02ee587be141fa2a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c13689e64e4c13428c0745c02ee587be141fa2a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9c13689e64e4c13428c0745c02ee587be141fa2a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c13689e64e4c13428c0745c02ee587be141fa2a/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a9d49e9681cb68b6ead50c0c526d2b3d84bd3dd9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a9d49e9681cb68b6ead50c0c526d2b3d84bd3dd9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a9d49e9681cb68b6ead50c0c526d2b3d84bd3dd9"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "202b43b4fc34a83c1f5237c5d09a65edbb76f57d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c13689e64e4c13428c0745c02ee587be141fa2a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c13689e64e4c13428c0745c02ee587be141fa2a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9c13689e64e4c13428c0745c02ee587be141fa2a", "patch": "@@ -1,3 +1,10 @@\n+2018-07-25  Richard Biener  <rguenther@suse.de>\n+\n+\tPR debug/86654\n+\t* dwarf2out.c (dwarf2out_decl): Do not handle nested functions\n+\tspecial wrt context_die late.\n+\t(gen_subprogram_die): Re-use DIEs in local scope.\n+\n 2018-07-25  Richard Sandiford  <richard.sandiford@arm.com>\n \n \tPR tree-optimization/86644"}, {"sha": "208f2e97e7cd577d6634e2f0c3f56197a7052150", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c13689e64e4c13428c0745c02ee587be141fa2a/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c13689e64e4c13428c0745c02ee587be141fa2a/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=9c13689e64e4c13428c0745c02ee587be141fa2a", "patch": "@@ -22766,6 +22766,7 @@ gen_subprogram_die (tree decl, dw_die_ref context_die)\n \t     */\n \t    || (old_die->die_parent\n \t\t&& old_die->die_parent->die_tag == DW_TAG_module)\n+\t    || local_scope_p (old_die->die_parent)\n \t    || context_die == NULL)\n \t   && (DECL_ARTIFICIAL (decl)\n \t       || (get_AT_file (old_die, DW_AT_decl_file) == file_index\n@@ -26702,8 +26703,11 @@ dwarf2out_decl (tree decl)\n     case FUNCTION_DECL:\n       /* If we're a nested function, initially use a parent of NULL; if we're\n \t a plain function, this will be fixed up in decls_for_scope.  If\n-\t we're a method, it will be ignored, since we already have a DIE.  */\n-      if (decl_function_context (decl)\n+\t we're a method, it will be ignored, since we already have a DIE.\n+\t Avoid doing this late though since clones of class methods may\n+\t otherwise end up in limbo and create type DIEs late.  */\n+      if (early_dwarf\n+\t  && decl_function_context (decl)\n \t  /* But if we're in terse mode, we don't care about scope.  */\n \t  && debug_info_level > DINFO_LEVEL_TERSE)\n \tcontext_die = NULL;"}]}