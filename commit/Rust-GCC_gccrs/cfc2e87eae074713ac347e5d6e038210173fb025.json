{"sha": "cfc2e87eae074713ac347e5d6e038210173fb025", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2ZjMmU4N2VhZTA3NDcxM2FjMzQ3ZTVkNmUwMzgyMTAxNzNmYjAyNQ==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1999-06-28T07:24:42Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1999-06-28T07:24:42Z"}, "message": "Opps.  Wrong file the first time.\n\nFrom-SVN: r27813", "tree": {"sha": "13fbfebef9fe9574ba973a9a6ccb79781a60844a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/13fbfebef9fe9574ba973a9a6ccb79781a60844a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cfc2e87eae074713ac347e5d6e038210173fb025", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cfc2e87eae074713ac347e5d6e038210173fb025", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cfc2e87eae074713ac347e5d6e038210173fb025", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cfc2e87eae074713ac347e5d6e038210173fb025/comments", "author": null, "committer": null, "parents": [{"sha": "da621fd225057cb3746132dca0c2a4220e5ea8a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/da621fd225057cb3746132dca0c2a4220e5ea8a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/da621fd225057cb3746132dca0c2a4220e5ea8a8"}], "stats": {"total": 68, "additions": 46, "deletions": 22}, "files": [{"sha": "3b1342f29b548daf6bb4f765489dd8089968d7c4", "filename": "gcc/testsuite/gcc.c-torture/execute/990628-1.c", "status": "modified", "additions": 46, "deletions": 22, "changes": 68, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cfc2e87eae074713ac347e5d6e038210173fb025/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F990628-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cfc2e87eae074713ac347e5d6e038210173fb025/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F990628-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F990628-1.c?ref=cfc2e87eae074713ac347e5d6e038210173fb025", "patch": "@@ -1,30 +1,54 @@\n-#define TP_BSIZE 64\n+#include <stdlib.h>\n \n-char\tbuf[2*TP_BSIZE];\n-char\t(*nextblock)[TP_BSIZE] = (char (*)[TP_BSIZE]) buf;\n+struct {\n+    long sqlcode;\n+} sqlca;\n \n-union u_test {\n-\tchar dummy[TP_BSIZE];\n-\tstruct s_test {\n-\t\tint a;\n-\t\tint b;\n-\t\tint c;\n-\t} s_test;\n-};\n \n-main(int argc, char **argv)\n+struct data_record {\n+    int dummy;\n+    int a[100];\n+} *data_ptr, data_tmp;\n+\n+\n+int\n+num_records()\n {\n-\tint i;\n-\tchar dp[TP_BSIZE];\n+    return 1;\n+}\n+\n \n-\tfor (i = 0; i < 2*TP_BSIZE; i++)\n-\t\tbuf[i] = '.';\n-\tfor (i = 0; i < TP_BSIZE; i++)\n-\t\tdp[i] = 'a';\n+void\n+fetch()\n+{\n+    static int fetch_count;\n+\n+    memset(&data_tmp, 0x55, sizeof(data_tmp));\n+    sqlca.sqlcode = (++fetch_count > 1 ? 100 : 0);\n+}\n \n-\t*(union u_test *)(*(nextblock)++) = *(union u_test *)dp;\n \n-\tfor (i = 0; i < 2*TP_BSIZE; i++)\n-\t\tprintf(\"%c%s\", buf[i], (i % 64) == 63 ? \"\\n\" : \"\");\n-\texit(0);\n+void\n+load_data() {\n+    struct data_record *p;\n+    int num = num_records();\n+\n+    data_ptr = malloc(num * sizeof(struct data_record));\n+    memset(data_ptr, 0xaa, num * sizeof(struct data_record));\n+\n+    fetch();\n+    p = data_ptr;\n+    while (sqlca.sqlcode == 0) {\n+        *p++ = data_tmp;\n+        fetch();\n+    }\n+}\n+\n+\n+main()\n+{\n+    load_data();\n+    if (data_ptr[0].dummy != 0x55555555)\n+      abort ();\n+    exit (0);\n }"}]}