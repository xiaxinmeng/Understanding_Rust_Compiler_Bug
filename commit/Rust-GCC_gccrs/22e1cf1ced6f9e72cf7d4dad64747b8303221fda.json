{"sha": "22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjJlMWNmMWNlZDZmOWU3MmNmN2Q0ZGFkNjQ3NDdiODMwMzIyMWZkYQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2014-07-02T15:23:56Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2014-07-02T15:23:56Z"}, "message": "c-decl.c (duplicate_decls): CLear DECL_STRUCT_FUNCTION before releasing symbol.\n\n\t* c-decl.c (duplicate_decls): CLear DECL_STRUCT_FUNCTION before\n\treleasing symbol.\n\n\t* gcc.c-torture/compile/section.c: New testcase.\n\nCo-Authored-By: Chen Gang <gang.chen.5i5j@gmail.com>\n\nFrom-SVN: r212234", "tree": {"sha": "aa99241265ddf88291e648e9f877d111090e5833", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aa99241265ddf88291e648e9f877d111090e5833"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/comments", "author": null, "committer": null, "parents": [{"sha": "9490fda67a801ad2618849b2d3a60b920d3713ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9490fda67a801ad2618849b2d3a60b920d3713ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9490fda67a801ad2618849b2d3a60b920d3713ca"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "68abca4dfb1ef9eebf6e5f5d4d08b1feaced4448", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "patch": "@@ -1,3 +1,9 @@\n+2014-07-02  Jan Hubicka  <hubicka@ucw.cz>\n+\t    Chen Gang <gang.chen.5i5j@gmail.com>\n+\n+\t* c-decl.c (duplicate_decls): CLear DECL_STRUCT_FUNCTION before\n+\treleasing symbol.\n+\n 2014-07-01  Marek Polacek  <polacek@redhat.com>\n \n \t* c-typeck.c (convert_for_assignment): Pass OPT_Wint_conversion"}, {"sha": "3dec90b23ed52edfdbbafd156b38cec4234ebbe3", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "patch": "@@ -2575,7 +2575,14 @@ duplicate_decls (tree newdecl, tree olddecl)\n \n   merge_decls (newdecl, olddecl, newtype, oldtype);\n \n-  /* The NEWDECL will no longer be needed.  */\n+  /* The NEWDECL will no longer be needed.\n+\n+     Before releasing the node, be sure to remove function from symbol\n+     table that might have been inserted there to record comdat group.\n+     Be sure to however do not free DECL_STRUCT_FUNCTION because this\n+     structure is shared in between NEWDECL and OLDECL.  */\n+  if (TREE_CODE (newdecl) == FUNCTION_DECL)\n+    DECL_STRUCT_FUNCTION (newdecl) = NULL;\n   if (TREE_CODE (newdecl) == FUNCTION_DECL\n       || TREE_CODE (newdecl) == VAR_DECL)\n     {"}, {"sha": "286898309fa25d3588d99c4c7b8de563398c4c82", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "patch": "@@ -1,3 +1,8 @@\n+2014-07-02  Jan Hubicka  <hubicka@ucw.cz>\n+\t    Chen Gang <gang.chen.5i5j@gmail.com>\n+\n+\t* gcc.c-torture/compile/section.c: New testcase.\n+ \n 2014-07-02  Christian Bruel  <christian.bruel@st.com>\n \n \tPR target/29349"}, {"sha": "1e8d094068c61444b003e5d2e61e92af6fb63863", "filename": "gcc/testsuite/gcc.c-torture/compile/section.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fsection.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22e1cf1ced6f9e72cf7d4dad64747b8303221fda/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fsection.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fsection.c?ref=22e1cf1ced6f9e72cf7d4dad64747b8303221fda", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+\n+/* { dg-require-effective-target named_sections } */\n+extern int __attribute__ ((__section__(\".init.text\"))) elv_register(void)\n+{\n+ return 0;\n+}\n+extern typeof(elv_register) elv_register;"}]}