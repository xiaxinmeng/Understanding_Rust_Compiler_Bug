{"sha": "df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGYxZjczMTVjN2ZiYWQxZmEyNGU0YmYwNDkwZTQyYTljYzA5MGRkYQ==", "commit": {"author": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2011-05-24T15:31:12Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2011-05-24T15:31:12Z"}, "message": "re PR target/49133 (modification of aliased __m128d miscompiles)\n\n\tPR target/49133\n\t* config/i386/sse.md (sse2_loadhpd): Remove shufpd alternative.\n\ntestsuite/ChangeLog:\n\n\tPR target/49133\n\t* g++.dg/other/pr49133.C: New test.\n\nFrom-SVN: r174122", "tree": {"sha": "d41e6208245b29ca5a23d1fe3357c55118a03276", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d41e6208245b29ca5a23d1fe3357c55118a03276"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "html_url": "https://github.com/Rust-GCC/gccrs/commit/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/comments", "author": null, "committer": null, "parents": [{"sha": "9fb38494a969437a79eec4757cb600081fa92b39", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9fb38494a969437a79eec4757cb600081fa92b39", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9fb38494a969437a79eec4757cb600081fa92b39"}], "stats": {"total": 66, "additions": 55, "deletions": 11}, "files": [{"sha": "3e4b663696bd2c395a413efe09981c4d4ffe368a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "patch": "@@ -1,3 +1,8 @@\n+2011-05-24  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/49133\n+\t* config/i386/sse.md (sse2_loadhpd): Remove shufpd alternative.\n+\n 2011-05-24  Eric Botcazou  <ebotcazou@adacore.com>\n \t    Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n "}, {"sha": "2bffb096f2a79233bc5a07634278c6c074eed0c1", "filename": "gcc/config/i386/sse.md", "status": "modified", "additions": 8, "deletions": 10, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2Fconfig%2Fi386%2Fsse.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2Fconfig%2Fi386%2Fsse.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsse.md?ref=df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "patch": "@@ -4270,30 +4270,28 @@\n ;; see comment above inline_secondary_memory_needed function in i386.c\n (define_insn \"sse2_loadhpd\"\n   [(set (match_operand:V2DF 0 \"nonimmediate_operand\"\n-\t  \"=x,x,x,x,x,o,o ,o\")\n+\t  \"=x,x,x,x,o,o ,o\")\n \t(vec_concat:V2DF\n \t  (vec_select:DF\n \t    (match_operand:V2DF 1 \"nonimmediate_operand\"\n-\t  \" 0,x,0,x,x,0,0 ,0\")\n+\t  \" 0,x,0,x,0,0 ,0\")\n \t    (parallel [(const_int 0)]))\n \t  (match_operand:DF 2 \"nonimmediate_operand\"\n-\t  \" m,m,x,x,0,x,*f,r\")))]\n+\t  \" m,m,x,x,x,*f,r\")))]\n   \"TARGET_SSE2 && !(MEM_P (operands[1]) && MEM_P (operands[2]))\"\n   \"@\n    movhpd\\t{%2, %0|%0, %2}\n    vmovhpd\\t{%2, %1, %0|%0, %1, %2}\n    unpcklpd\\t{%2, %0|%0, %2}\n    vunpcklpd\\t{%2, %1, %0|%0, %1, %2}\n-   shufpd\\t{$1, %1, %0|%0, %1, 1}\n    #\n    #\n    #\"\n-  [(set_attr \"isa\" \"noavx,avx,noavx,avx,noavx,base,base,base\")\n-   (set_attr \"type\" \"ssemov,ssemov,sselog,sselog,sselog,ssemov,fmov,imov\")\n-   (set_attr \"prefix_data16\" \"1,*,*,*,*,*,*,*\")\n-   (set_attr \"length_immediate\" \"*,*,*,*,1,*,*,*\")\n-   (set_attr \"prefix\" \"orig,vex,orig,vex,orig,*,*,*\")\n-   (set_attr \"mode\" \"V1DF,V1DF,V2DF,V2DF,V2DF,DF,DF,DF\")])\n+  [(set_attr \"isa\" \"noavx,avx,noavx,avx,base,base,base\")\n+   (set_attr \"type\" \"ssemov,ssemov,sselog,sselog,ssemov,fmov,imov\")\n+   (set_attr \"prefix_data16\" \"1,*,*,*,*,*,*\")\n+   (set_attr \"prefix\" \"orig,vex,orig,vex,*,*,*\")\n+   (set_attr \"mode\" \"V1DF,V1DF,V2DF,V2DF,DF,DF,DF\")])\n \n (define_split\n   [(set (match_operand:V2DF 0 \"memory_operand\" \"\")"}, {"sha": "bdc0f3e642204f0f2bbc9eb70fefeeb89d8ee4eb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "patch": "@@ -1,3 +1,8 @@\n+2011-05-24  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/49133\n+\t* g++.dg/other/pr49133.C: New test.\n+\n 2011-05-24  Uros Bizjak <ubizjak@gmail.com>\n \t    Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n@@ -450,7 +455,7 @@\n \n 2011-05-08  Ville Voutilainen  <ville.voutilainen@gmail.com>\n \n-        * g++.dg/inherit/virtual9.C: New.\n+\t* g++.dg/inherit/virtual9.C: New.\n \n 2011-05-09  Dodji Seketeli  <dodji@redhat.com>\n "}, {"sha": "a59687f9c742a6e95029e42385cdd27d2ba37622", "filename": "gcc/testsuite/g++.dg/other/pr49133.C", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr49133.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/df1f7315c7fbad1fa24e4bf0490e42a9cc090dda/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr49133.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Fpr49133.C?ref=df1f7315c7fbad1fa24e4bf0490e42a9cc090dda", "patch": "@@ -0,0 +1,36 @@\n+/* { dg-do run { target i?86-*-* x86_64-*-* } } */\n+/* { dg-options \"-O2 -msse2\" } */\n+/* { dg-require-effective-target sse2_runtime } */\n+\n+#include <xmmintrin.h>\n+\n+extern \"C\" void abort ();\n+\n+typedef double double_a __attribute__((__may_alias__));\n+\n+struct V\n+{\n+  __m128d data;\n+};\n+\n+int\n+main()\n+{\n+  V a;\n+  __m128d b;\n+\n+  b = _mm_set_pd (1., 0.);\n+  a.data = _mm_set_pd (1., 0.);\n+  a.data = _mm_add_pd (a.data,\n+\t\t       _mm_and_pd (_mm_cmpeq_pd (a.data, _mm_set1_pd (0.)),\n+\t\t\t\t   _mm_set1_pd (2.)));\n+  reinterpret_cast<double_a *>(&a.data)[1] += 1.;\n+  b = _mm_add_pd (b, _mm_and_pd (_mm_cmpeq_pd (b, _mm_set1_pd (0.)),\n+\t\t\t\t _mm_set1_pd (1.)));\n+  b = _mm_add_pd (b, _mm_and_pd (_mm_cmpeq_pd (b, _mm_set1_pd (1.)),\n+\t\t\t\t _mm_set1_pd (1.)));\n+  if (_mm_movemask_pd (_mm_cmpeq_pd (a.data, b)) != 0x3)\n+    abort();\n+\n+  return 0;\n+}"}]}