{"sha": "7f2a9982659c7963ff213722e1feabbd7563118e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2YyYTk5ODI2NTljNzk2M2ZmMjEzNzIyZTFmZWFiYmQ3NTYzMTE4ZQ==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@gmail.com", "date": "2008-12-30T16:27:29Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2008-12-30T16:27:29Z"}, "message": "re PR tree-optimization/38661 (ICE: vector VEC(constructor_elt,base) push domain error, in build_constructors at tree-switch-conversion.c:450)\n\n2008-12-30  Andrew Pinski  <pinskia@gmail.com>\n\n        PR middle-end/38661\n        * tree-switch-conversion.c (build_constructors): Test for wrapping of\n        pos case.\n\n2008-12-30  Andrew Pinski  <pinskia@gmail.com>\n\n        PR middle-end/38661\n        * gcc.c-torture/compile/pr38661.c: New testcase. \n        * gcc.c-torture/compile/pr38661-1.c: New testcase.\n\nFrom-SVN: r142964", "tree": {"sha": "e674523d6521e2e5ad5b3539aabdd14810d1673a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e674523d6521e2e5ad5b3539aabdd14810d1673a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7f2a9982659c7963ff213722e1feabbd7563118e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f2a9982659c7963ff213722e1feabbd7563118e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f2a9982659c7963ff213722e1feabbd7563118e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f2a9982659c7963ff213722e1feabbd7563118e/comments", "author": {"login": "pinskia", "id": 8496799, "node_id": "MDQ6VXNlcjg0OTY3OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/8496799?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pinskia", "html_url": "https://github.com/pinskia", "followers_url": "https://api.github.com/users/pinskia/followers", "following_url": "https://api.github.com/users/pinskia/following{/other_user}", "gists_url": "https://api.github.com/users/pinskia/gists{/gist_id}", "starred_url": "https://api.github.com/users/pinskia/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pinskia/subscriptions", "organizations_url": "https://api.github.com/users/pinskia/orgs", "repos_url": "https://api.github.com/users/pinskia/repos", "events_url": "https://api.github.com/users/pinskia/events{/privacy}", "received_events_url": "https://api.github.com/users/pinskia/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "000020907344fccdd11036944874d80d137557df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/000020907344fccdd11036944874d80d137557df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/000020907344fccdd11036944874d80d137557df"}], "stats": {"total": 35, "additions": 33, "deletions": 2}, "files": [{"sha": "89d19b09a17cc5160c68938fd555471b9355ca5c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7f2a9982659c7963ff213722e1feabbd7563118e", "patch": "@@ -1,3 +1,9 @@\n+2008-12-30  Andrew Pinski  <pinskia@gmail.com>\n+\n+\tPR middle-end/38661\n+\t* tree-switch-conversion.c (build_constructors): Test for wrapping of\n+\tpos case.\n+\n 2008-12-30  Steven Bosscher  <steven@gcc.gnu.org>\n \n \tPR middle-end/38584"}, {"sha": "81e86b30a1cb433cc569431e99f28eccd81fcd9b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7f2a9982659c7963ff213722e1feabbd7563118e", "patch": "@@ -1,3 +1,9 @@\n+2008-12-30  Andrew Pinski  <pinskia@gmail.com>\n+\n+\tPR middle-end/38661\n+\t* gcc.c-torture/compile/pr38661.c: New testcase.\n+\t* gcc.c-torture/compile/pr38661-1.c: New testcase.\n+\n 2008-12-30  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/38564"}, {"sha": "065f12010a73e610bc417dfc5a9b56a416d0f837", "filename": "gcc/testsuite/gcc.c-torture/compile/pr38661-1.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr38661-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr38661-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr38661-1.c?ref=7f2a9982659c7963ff213722e1feabbd7563118e", "patch": "@@ -0,0 +1,9 @@\n+/* We used to ICE because we would wrap INT_MAX\n+   into INT_MIN while doing the switch converison. */\n+\n+const char *func(int val) {\n+ switch (val) {\n+   case - __INT_MAX__ -1 : return \"foo\";\n+   default: return \"\";\n+ }\n+}"}, {"sha": "5d243c6be51dcc91e3b87649f4504f133f519e9f", "filename": "gcc/testsuite/gcc.c-torture/compile/pr38661.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr38661.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr38661.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fcompile%2Fpr38661.c?ref=7f2a9982659c7963ff213722e1feabbd7563118e", "patch": "@@ -0,0 +1,9 @@\n+/* We used to ICE because we would wrap INT_MAX\n+   into INT_MIN while doing the switch converison. */\n+\n+const char *func(int val) {\n+ switch (val) {\n+   case __INT_MAX__: return \"foo\";\n+   default: return \"\";\n+ }\n+}"}, {"sha": "dba0c6f3de357c94afe92e043ef7b67888216907", "filename": "gcc/tree-switch-conversion.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftree-switch-conversion.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f2a9982659c7963ff213722e1feabbd7563118e/gcc%2Ftree-switch-conversion.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-switch-conversion.c?ref=7f2a9982659c7963ff213722e1feabbd7563118e", "patch": "@@ -440,9 +440,10 @@ build_constructors (gimple swtch)\n \t{\n \t  gimple phi = gsi_stmt (gsi);\n \t  tree val = PHI_ARG_DEF_FROM_EDGE (phi, e);\n+\t  tree low = CASE_LOW (cs);\n \t  pos = CASE_LOW (cs);\n \n-\t  while (!tree_int_cst_lt (high, pos))\n+\t  do \n \t    {\n \t      constructor_elt *elt;\n \n@@ -452,7 +453,7 @@ build_constructors (gimple swtch)\n \t      elt->value = val;\n \n \t      pos = int_const_binop (PLUS_EXPR, pos, integer_one_node, 0);\n-\t    }\n+\t    } while (!tree_int_cst_lt (high, pos) && tree_int_cst_lt (low, pos));\n \t  j++;\n \t}\n     }"}]}