{"sha": "40b6bff965d004095b06ad3827e8221ae5bcc25e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDBiNmJmZjk2NWQwMDQwOTViMDZhZDM4MjdlODIyMWFlNWJjYzI1ZQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2017-01-27T13:56:59Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2017-01-27T13:56:59Z"}, "message": "re PR tree-optimization/79245 (Inefficient loop distribution to memcpy)\n\n2017-01-27  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/79245\n\t* tree-loop-distribution.c (distribute_loop): Apply cost\n\tmodeling also to detected patterns.\n\n\t* gcc.dg/tree-ssa/ldist-23.c: XFAIL.\n\t* gcc.dg/tree-ssa/ldist-25.c: New testcase.\n\nFrom-SVN: r244976", "tree": {"sha": "6a577a4fc19836a6e400bff7742ec6ea1a480f79", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6a577a4fc19836a6e400bff7742ec6ea1a480f79"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40b6bff965d004095b06ad3827e8221ae5bcc25e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40b6bff965d004095b06ad3827e8221ae5bcc25e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40b6bff965d004095b06ad3827e8221ae5bcc25e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40b6bff965d004095b06ad3827e8221ae5bcc25e/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b2f8892e35a0faa8a3c52da0eda13c12ddb76cc4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2f8892e35a0faa8a3c52da0eda13c12ddb76cc4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2f8892e35a0faa8a3c52da0eda13c12ddb76cc4"}], "stats": {"total": 45, "additions": 41, "deletions": 4}, "files": [{"sha": "3ed05643df37029562057c12147ff747481ce89f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=40b6bff965d004095b06ad3827e8221ae5bcc25e", "patch": "@@ -1,3 +1,9 @@\n+2017-01-27  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/79245\n+\t* tree-loop-distribution.c (distribute_loop): Apply cost\n+\tmodeling also to detected patterns.\n+\n 2017-01-27  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/71433"}, {"sha": "5a68e58f028cb44a7b11e565d646c57dd7c046c6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=40b6bff965d004095b06ad3827e8221ae5bcc25e", "patch": "@@ -1,3 +1,9 @@\n+2017-01-27  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/79245\n+\t* gcc.dg/tree-ssa/ldist-23.c: XFAIL.\n+\t* gcc.dg/tree-ssa/ldist-25.c: New testcase.\n+\n 2017-01-27  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/79199"}, {"sha": "74701b434d5c432b1208dac032f87256f9be445d", "filename": "gcc/testsuite/gcc.dg/tree-ssa/ldist-23.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fldist-23.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fldist-23.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fldist-23.c?ref=40b6bff965d004095b06ad3827e8221ae5bcc25e", "patch": "@@ -29,5 +29,6 @@ int main()\n   return 0;\n }\n \n-/* { dg-final { scan-tree-dump \"split to 1 loops and 1 library call\" \"ldist\" } } */\n-/* { dg-final { scan-tree-dump \"generated memcpy\" \"ldist\" } } */\n+/* XFAILed due to the fix for PR79245.  */\n+/* { dg-final { scan-tree-dump \"split to 1 loops and 1 library call\" \"ldist\" { xfail *-*-* } } } */\n+/* { dg-final { scan-tree-dump \"generated memcpy\" \"ldist\" { xfail *-*-* }  } } */"}, {"sha": "699bf38ab039a98f5a6b6a5ed605e2d41dcc29b9", "filename": "gcc/testsuite/gcc.dg/tree-ssa/ldist-25.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fldist-25.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fldist-25.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fldist-25.c?ref=40b6bff965d004095b06ad3827e8221ae5bcc25e", "patch": "@@ -0,0 +1,25 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -ftree-loop-distribute-patterns -fdump-tree-ldist-details\" } */\n+\n+#define k 1335\n+double a[k][k];\n+double b[k][k];\n+double c[k][k];\n+\n+int x;\n+int y;\n+\n+void\n+foo (void)\n+{\n+  for (int j = 0; j < x; j++)\n+    {\n+      for (int i = 0; i < y; i++)\n+\t{\n+\t  c[j][i] = b[j][i] - a[j][i];\n+\t  a[j][i] = b[j][i];\n+\t}\n+    }\n+}\n+\n+/* { dg-final { scan-tree-dump \"Loop . is the same\" \"ldist\" } } */"}, {"sha": "0fec1d6121ce0c510ad959d61f1a1744527d7c6f", "filename": "gcc/tree-loop-distribution.c", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftree-loop-distribution.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40b6bff965d004095b06ad3827e8221ae5bcc25e/gcc%2Ftree-loop-distribution.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-loop-distribution.c?ref=40b6bff965d004095b06ad3827e8221ae5bcc25e", "patch": "@@ -1548,8 +1548,7 @@ distribute_loop (struct loop *loop, vec<gimple *> stmts,\n       for (int j = i + 1;\n \t   partitions.iterate (j, &partition); ++j)\n \t{\n-\t  if (!partition_builtin_p (partition)\n-\t      && similar_memory_accesses (rdg, into, partition))\n+\t  if (similar_memory_accesses (rdg, into, partition))\n \t    {\n \t      if (dump_file && (dump_flags & TDF_DETAILS))\n \t\t{"}]}