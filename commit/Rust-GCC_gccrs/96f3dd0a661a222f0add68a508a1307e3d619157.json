{"sha": "96f3dd0a661a222f0add68a508a1307e3d619157", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTZmM2RkMGE2NjFhMjIyZjBhZGQ2OGE1MDhhMTMwN2UzZDYxOTE1Nw==", "commit": {"author": {"name": "Mike Frysinger", "email": "vapier@gentoo.org", "date": "2015-10-26T18:32:41Z"}, "committer": {"name": "Mike Frysinger", "email": "vapier@gcc.gnu.org", "date": "2015-10-26T18:32:41Z"}, "message": "libjava: fix locale handling when sorting JNI methods\n\nWhen building under LANG=cs_CZ.UTF-8, the JNI method check fails:\n\n/bin/bash ../../scripts/check_jni_methods.sh\nFound a problem with the JNI methods declared and implemented.\n(<) missing in implementation, (>) missing in header files\n> Java_gnu_java_awt_peer_gtk_GtkClipboard_advertiseContent\n> Java_gnu_java_awt_peer_gtk_GtkClipboard_initNativeState\n... lots more ...\n\nWhile the sed commands are run under LC_ALL=C, the two sort commands are\nnot, and they end up producing unexpected output (for the test).  Once we\nrun both under LC_ALL=C, the check passes.  While we're here, we can also\ncombine latter the `sort|uniq` into `sort -u` to match the earlier code.\n\nURL: https://bugs.gentoo.org/563710\nReported-by: Miroslav \u0160ulc <fordfrog@gentoo.org>\n\nFrom-SVN: r229388", "tree": {"sha": "02da245dbfe8364957f88cb6c681100bc38828c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/02da245dbfe8364957f88cb6c681100bc38828c7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/96f3dd0a661a222f0add68a508a1307e3d619157", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96f3dd0a661a222f0add68a508a1307e3d619157", "html_url": "https://github.com/Rust-GCC/gccrs/commit/96f3dd0a661a222f0add68a508a1307e3d619157", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96f3dd0a661a222f0add68a508a1307e3d619157/comments", "author": {"login": "vapier", "id": 176950, "node_id": "MDQ6VXNlcjE3Njk1MA==", "avatar_url": "https://avatars.githubusercontent.com/u/176950?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vapier", "html_url": "https://github.com/vapier", "followers_url": "https://api.github.com/users/vapier/followers", "following_url": "https://api.github.com/users/vapier/following{/other_user}", "gists_url": "https://api.github.com/users/vapier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vapier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vapier/subscriptions", "organizations_url": "https://api.github.com/users/vapier/orgs", "repos_url": "https://api.github.com/users/vapier/repos", "events_url": "https://api.github.com/users/vapier/events{/privacy}", "received_events_url": "https://api.github.com/users/vapier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "15c918bc7645580d6e48fdcab77fc6a2a3347daf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15c918bc7645580d6e48fdcab77fc6a2a3347daf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15c918bc7645580d6e48fdcab77fc6a2a3347daf"}], "stats": {"total": 9, "additions": 7, "deletions": 2}, "files": [{"sha": "fa49ad59bed83d5beab7efc88b5f16367330afff", "filename": "libjava/classpath/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96f3dd0a661a222f0add68a508a1307e3d619157/libjava%2Fclasspath%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96f3dd0a661a222f0add68a508a1307e3d619157/libjava%2Fclasspath%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2FChangeLog?ref=96f3dd0a661a222f0add68a508a1307e3d619157", "patch": "@@ -1,3 +1,8 @@\n+2015-10-26  Mike Frysinger  <vapier@gentoo.org>\n+\n+\t* scripts/check_jni_methods.sh.in: Run sort with LC_ALL=C, and\n+\tcombine `sort|uniq` into `sort -u`.\n+\n 2015-08-11  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* configure.ac (tools/gjdoc): Depend on CREATE_WRAPPERS."}, {"sha": "fb9d104e3d0b3de29cb3f3d854737085ce0ca6de", "filename": "libjava/classpath/scripts/check_jni_methods.sh.in", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96f3dd0a661a222f0add68a508a1307e3d619157/libjava%2Fclasspath%2Fscripts%2Fcheck_jni_methods.sh.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96f3dd0a661a222f0add68a508a1307e3d619157/libjava%2Fclasspath%2Fscripts%2Fcheck_jni_methods.sh.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Fscripts%2Fcheck_jni_methods.sh.in?ref=96f3dd0a661a222f0add68a508a1307e3d619157", "patch": "@@ -14,7 +14,7 @@ grep -h '^JNIEXPORT .* Java_' @abs_top_srcdir@/include/*.h | \\\n         LC_ALL=C sed -e 's,.*JNICALL \\(Java_[a-z_A-Z0-9]*\\).*$,\\1,' > $TMPFILE\n grep -h '^JNIEXPORT .* Java_' @abs_top_builddir@/include/*.h | \\\n         LC_ALL=C sed -e 's,.*JNICALL \\(Java_[a-z_A-Z0-9]*\\).*$,\\1,' >> $TMPFILE\n-sort -u $TMPFILE > $TMPFILE4\n+LC_ALL=C sort -u $TMPFILE > $TMPFILE4\n mv $TMPFILE4 $TMPFILE\n \n # Find all methods in the JNI C source files.\n@@ -31,7 +31,7 @@ find @abs_top_srcdir@/native/jni -name \\*.cpp | \\\n \tcut -f4 -d\\  | \\\n         LC_ALL=C sed -e 's,^\\JNIEXPORT .* JNICALL \\(Java_[a-z_A-Z0-9]*\\).*$,\\1,' >> $TMPFILE2\n mv $TMPFILE2 $TMPFILE3\n-sort $TMPFILE3 | uniq > $TMPFILE2\n+LC_ALL=C sort -u $TMPFILE3 > $TMPFILE2\n rm $TMPFILE3\n \n # Write temporary ignore file."}]}