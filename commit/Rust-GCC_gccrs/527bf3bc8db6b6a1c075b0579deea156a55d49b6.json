{"sha": "527bf3bc8db6b6a1c075b0579deea156a55d49b6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTI3YmYzYmM4ZGI2YjZhMWMwNzViMDU3OWRlZWExNTZhNTVkNDliNg==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-08-10T06:18:13Z"}, "committer": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-08-10T06:18:13Z"}, "message": "Fix remove_predictions_associated_with_edge\n\nremove_predictions_associated_with_edge currently calls filter_predicitons\npassing it equal_edge_p. Becase filter_predictions removes all edges where\nfilter returns false, the function does exact oposite. Fixed thus.\n\nBootstrapped/regtested x86_64-linux.\n\ngcc/ChangeLog:\n\n2020-08-02  Jan Hubicka  <hubicka@ucw.cz>\n\n\t* predict.c (filter_predictions): Document semantics of filter.\n\t(equal_edge_p): Rename to ...\n\t(not_equal_edge_p): ... this; reverse semantics.\n\t(remove_predictions_associated_with_edge): Fix.", "tree": {"sha": "9a0ba41ad3e43ad9dc92ccab372e2edd1981445e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9a0ba41ad3e43ad9dc92ccab372e2edd1981445e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/527bf3bc8db6b6a1c075b0579deea156a55d49b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/527bf3bc8db6b6a1c075b0579deea156a55d49b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/527bf3bc8db6b6a1c075b0579deea156a55d49b6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/527bf3bc8db6b6a1c075b0579deea156a55d49b6/comments", "author": null, "committer": null, "parents": [{"sha": "5fb34b41a7979c8445ad5a28614a440458fd4285", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fb34b41a7979c8445ad5a28614a440458fd4285", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fb34b41a7979c8445ad5a28614a440458fd4285"}], "stats": {"total": 15, "additions": 8, "deletions": 7}, "files": [{"sha": "2164a06e0837c02c3b015a6ca68fa8abbb3ea28e", "filename": "gcc/predict.c", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/527bf3bc8db6b6a1c075b0579deea156a55d49b6/gcc%2Fpredict.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/527bf3bc8db6b6a1c075b0579deea156a55d49b6/gcc%2Fpredict.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpredict.c?ref=527bf3bc8db6b6a1c075b0579deea156a55d49b6", "patch": "@@ -595,10 +595,11 @@ gimple_predict_edge (edge e, enum br_predictor predictor, int probability)\n     }\n }\n \n-/* Filter edge predictions PREDS by a function FILTER.  DATA are passed\n-   to the filter function.  */\n+/* Filter edge predictions PREDS by a function FILTER: if FILTER return false\n+   the prediction is removed.\n+   DATA are passed to the filter function.  */\n \n-void\n+static void\n filter_predictions (edge_prediction **preds,\n \t\t    bool (*filter) (edge_prediction *, void *), void *data)\n {\n@@ -627,10 +628,10 @@ filter_predictions (edge_prediction **preds,\n /* Filter function predicate that returns true for a edge predicate P\n    if its edge is equal to DATA.  */\n \n-bool\n-equal_edge_p (edge_prediction *p, void *data)\n+static bool\n+not_equal_edge_p (edge_prediction *p, void *data)\n {\n-  return p->ep_edge == (edge)data;\n+  return p->ep_edge != (edge)data;\n }\n \n /* Remove all predictions on given basic block that are attached\n@@ -642,7 +643,7 @@ remove_predictions_associated_with_edge (edge e)\n     return;\n \n   edge_prediction **preds = bb_predictions->get (e->src);\n-  filter_predictions (preds, equal_edge_p, e);\n+  filter_predictions (preds, not_equal_edge_p, e);\n }\n \n /* Clears the list of predictions stored for BB.  */"}]}