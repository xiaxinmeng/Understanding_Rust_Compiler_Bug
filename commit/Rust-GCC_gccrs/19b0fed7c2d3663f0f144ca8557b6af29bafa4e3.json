{"sha": "19b0fed7c2d3663f0f144ca8557b6af29bafa4e3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTliMGZlZDdjMmQzNjYzZjBmMTQ0Y2E4NTU3YjZhZjI5YmFmYTRlMw==", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2020-09-08T07:42:03Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2020-09-08T11:43:35Z"}, "message": "PR tree-optimization/96967 - cast label range to type of switch operand\n\n\tPR tree-optimization/96967\n\t* tree-vrp.c (find_case_label_range): Cast label range to\n\ttype of switch operand.", "tree": {"sha": "2c915de9b5b8119ea1c054d201a63783dd613884", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2c915de9b5b8119ea1c054d201a63783dd613884"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b75863a88ececd4fcce9e3b35df8d91b82cf4fc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b75863a88ececd4fcce9e3b35df8d91b82cf4fc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b75863a88ececd4fcce9e3b35df8d91b82cf4fc5"}], "stats": {"total": 38, "additions": 38, "deletions": 0}, "files": [{"sha": "249dfc7fa11b122d25a50d2882ecef20ba45b475", "filename": "gcc/testsuite/gcc.dg/tree-ssa/pr96967.c", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr96967.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr96967.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fpr96967.c?ref=19b0fed7c2d3663f0f144ca8557b6af29bafa4e3", "patch": "@@ -0,0 +1,36 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fshort-enums\" } */\n+\n+enum re {\n+  o3,\n+};\n+\n+int\n+uj (int mq, enum re dn)\n+{\n+  enum re nr = mq;\n+\n+  switch (nr)\n+    {\n+    case 4:\n+      if (dn == 0)\n+        goto wdev_inactive_unlock;\n+      break;\n+\n+    default:\n+      break;\n+    }\n+\n+  switch (nr)\n+    {\n+    case 0:\n+    case 4:\n+      return 0;\n+\n+    default:\n+      break;\n+    }\n+\n+ wdev_inactive_unlock:\n+  return 1;\n+}"}, {"sha": "b493e4023821cc5e85fe57015ed1535a810d5f48", "filename": "gcc/tree-vrp.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3/gcc%2Ftree-vrp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19b0fed7c2d3663f0f144ca8557b6af29bafa4e3/gcc%2Ftree-vrp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vrp.c?ref=19b0fed7c2d3663f0f144ca8557b6af29bafa4e3", "patch": "@@ -3828,6 +3828,8 @@ find_case_label_range (gswitch *switch_stmt, const irange *range_of_op)\n       tree case_high\n \t= CASE_HIGH (label) ? CASE_HIGH (label) : CASE_LOW (label);\n       int_range_max label_range (CASE_LOW (label), case_high);\n+      if (!types_compatible_p (label_range.type (), range_of_op->type ()))\n+\trange_cast (label_range, range_of_op->type ());\n       label_range.intersect (range_of_op);\n       if (label_range == *range_of_op)\n \treturn label;"}]}