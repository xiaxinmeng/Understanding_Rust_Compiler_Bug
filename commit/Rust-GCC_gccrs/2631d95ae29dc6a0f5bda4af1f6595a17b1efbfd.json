{"sha": "2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjYzMWQ5NWFlMjlkYzZhMGY1YmRhNGFmMWY2NTk1YTE3YjFlZmJmZA==", "commit": {"author": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2020-07-23T13:02:15Z"}, "committer": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2020-07-23T13:02:15Z"}, "message": "libomp: Add omp_depend_kind to omp_lib.{f90,h}\n\ngcc/fortran/ChangeLog:\n\n\t* intrinsic.texi (OMP_LIB_KINDS): Add omp_depend_kind.\n\nlibgomp/ChangeLog:\n\n\t* configure.ac: Add OMP_DEPEND_KIND and OMP_INT128_SIZE.\n\t* libgomp_f.h.in (omp_check_defines): Check whether\n\tsizeof of determined Fortran kind and C typedef match.\n\t* omp_lib.f90.in: Add omp_depened_kind.\n\t* omp_lib.h.in: Likewise; fix omp_alloctrait_key_kind.\n\t* configure: Regenerate.\n\t* Makefile.in: Regenerate.\n\t* testsuite/Makefile.in: Regenerate.", "tree": {"sha": "688ad21110bf1c7827bbe2d746b13c5606e62019", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/688ad21110bf1c7827bbe2d746b13c5606e62019"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0c111868b791a5251de7a59362e15c51cd35362b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c111868b791a5251de7a59362e15c51cd35362b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0c111868b791a5251de7a59362e15c51cd35362b"}], "stats": {"total": 57, "additions": 53, "deletions": 4}, "files": [{"sha": "6268feca70cd9067ada65b7bd28f7aa4523f766f", "filename": "gcc/fortran/intrinsic.texi", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/gcc%2Ffortran%2Fintrinsic.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/gcc%2Ffortran%2Fintrinsic.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fintrinsic.texi?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -15317,6 +15317,7 @@ named constants:\n @item @code{omp_allocator_handle_kind}\n @item @code{omp_alloctrait_key_kind}\n @item @code{omp_alloctrait_val_kind}\n+@item @code{omp_depend_kind}\n @item @code{omp_lock_kind}\n @item @code{omp_lock_hint_kind}\n @item @code{omp_nest_lock_kind}"}, {"sha": "8418af977d48b4756ab540ab82317998326d2c28", "filename": "libgomp/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FMakefile.in?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -421,6 +421,7 @@ NM = @NM@\n NMEDIT = @NMEDIT@\n OBJDUMP = @OBJDUMP@\n OBJEXT = @OBJEXT@\n+OMP_DEPEND_KIND = @OMP_DEPEND_KIND@\n OMP_LOCK_25_ALIGN = @OMP_LOCK_25_ALIGN@\n OMP_LOCK_25_KIND = @OMP_LOCK_25_KIND@\n OMP_LOCK_25_SIZE = @OMP_LOCK_25_SIZE@"}, {"sha": "937d5d6a591e2464ce2de65fdfe0824dd7e1e0f8", "filename": "libgomp/configure", "status": "modified", "additions": 27, "deletions": 2, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfigure?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -635,6 +635,7 @@ am__EXEEXT_TRUE\n LTLIBOBJS\n LIBOBJS\n get_gcc_base_ver\n+OMP_DEPEND_KIND\n OMP_NEST_LOCK_25_KIND\n OMP_LOCK_25_KIND\n OMP_NEST_LOCK_25_ALIGN\n@@ -11434,7 +11435,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11437 \"configure\"\n+#line 11438 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -11540,7 +11541,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11543 \"configure\"\n+#line 11544 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -16968,6 +16969,20 @@ if ac_fn_c_compute_int \"$LINENO\" \"sizeof (__INTPTR_TYPE__)\" \"INTPTR_T_KIND\"\n fi\n \n \n+if ac_fn_c_compute_int \"$LINENO\" \"sizeof (__int128)\" \"OMP_INT128_SIZE\"        \"\"; then :\n+\n+else\n+  OMP_INT128_SIZE=0\n+fi\n+\n+\n+if ac_fn_c_compute_int \"$LINENO\" \"2*sizeof (__INTPTR_TYPE__)\" \"OMP_DEPEND_KIND\"        \"\"; then :\n+\n+else\n+  OMP_DEPEND_KIND=0\n+fi\n+\n+\n if ac_fn_c_compute_int \"$LINENO\" \"sizeof (omp_lock_t)\" \"OMP_LOCK_SIZE\"        \"\"; then :\n \n else\n@@ -17034,6 +17049,16 @@ fi\n if test $OMP_NEST_LOCK_25_SIZE -gt 8 || test $OMP_NEST_LOCK_25_ALIGN -gt $OMP_NEST_LOCK_25_SIZE; then\n   OMP_NEST_LOCK_25_KIND=8\n fi\n+if test $OMP_DEPEND_KIND -eq 16; then\n+  if test $OMP_INT128_SIZE -ne 16; then\n+    as_fn_error $? \"unsupported system, cannot find Fortran int kind=16, needed for omp_depend_kind\" \"$LINENO\" 5\n+  fi\n+else\n+  if test $OMP_DEPEND_KIND -ne 8; then\n+    as_fn_error $? \"unsupported system, cannot find Fortran integer kind for omp_depend_kind\" \"$LINENO\" 5\n+  fi\n+fi\n+\n \n \n "}, {"sha": "e4f30cbb0829814b935f8f54c7d44daab2561b30", "filename": "libgomp/configure.ac", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fconfigure.ac?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -396,6 +396,9 @@ for i in $config_path; do\n done\n \n _AC_COMPUTE_INT([sizeof (__INTPTR_TYPE__)], [INTPTR_T_KIND])\n+_AC_COMPUTE_INT([sizeof (__int128)], [OMP_INT128_SIZE],,[OMP_INT128_SIZE=0])\n+_AC_COMPUTE_INT([2*sizeof (__INTPTR_TYPE__)], [OMP_DEPEND_KIND],,\n+\t\t[OMP_DEPEND_KIND=0])\n _AC_COMPUTE_INT([sizeof (omp_lock_t)], [OMP_LOCK_SIZE],,\n   [AC_MSG_ERROR([unsupported system, cannot find sizeof (omp_lock_t)])])\n _AC_COMPUTE_INT([__alignof (omp_lock_t)], [OMP_LOCK_ALIGN])\n@@ -428,6 +431,15 @@ fi\n if test $OMP_NEST_LOCK_25_SIZE -gt 8 || test $OMP_NEST_LOCK_25_ALIGN -gt $OMP_NEST_LOCK_25_SIZE; then\n   OMP_NEST_LOCK_25_KIND=8\n fi\n+if test $OMP_DEPEND_KIND -eq 16; then\n+  if test $OMP_INT128_SIZE -ne 16; then\n+    AC_MSG_ERROR([unsupported system, cannot find Fortran int kind=16, needed for omp_depend_kind])\n+  fi\n+else\n+  if test $OMP_DEPEND_KIND -ne 8; then\n+    AC_MSG_ERROR([unsupported system, cannot find Fortran integer kind for omp_depend_kind])\n+  fi\n+fi\n \n AC_SUBST(INTPTR_T_KIND)\n AC_SUBST(OMP_LOCK_SIZE)\n@@ -442,6 +454,7 @@ AC_SUBST(OMP_NEST_LOCK_25_SIZE)\n AC_SUBST(OMP_NEST_LOCK_25_ALIGN)\n AC_SUBST(OMP_LOCK_25_KIND)\n AC_SUBST(OMP_NEST_LOCK_25_KIND)\n+AC_SUBST(OMP_DEPEND_KIND)\n CFLAGS=\"$save_CFLAGS\"\n \n # Determine what GCC version number to use in filesystem paths."}, {"sha": "d629503b8da389da2e5e49c43a895b41e138ce3c", "filename": "libgomp/libgomp_f.h.in", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Flibgomp_f.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Flibgomp_f.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Flibgomp_f.h.in?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -79,7 +79,12 @@ omp_check_defines (void)\n \t     || @OMP_NEST_LOCK_SIZE@ != sizeof (omp_nest_lock_t)\n \t     || @OMP_NEST_LOCK_ALIGN@ != __alignof (omp_nest_lock_t)\n \t     || @OMP_LOCK_KIND@ != sizeof (*(omp_lock_arg_t) 0)\n-\t     || @OMP_NEST_LOCK_KIND@ != sizeof (*(omp_nest_lock_arg_t) 0))\n+\t     || @OMP_NEST_LOCK_KIND@ != sizeof (*(omp_nest_lock_arg_t) 0)\n+\t     || @INTPTR_T_KIND@ != sizeof (omp_allocator_handle_t)\n+\t     || 4 != sizeof (omp_alloctrait_key_t)\n+\t     || @INTPTR_T_KIND@ != sizeof (omp_alloctrait_value_t)\n+\t     || @INTPTR_T_KIND@ != sizeof (omp_memspace_handle_t)\n+\t     || @OMP_DEPEND_KIND@ != sizeof (omp_depend_t))\n \t    ? -1 : 1] __attribute__ ((__unused__));\n   char test2[(@OMP_LOCK_25_SIZE@ != sizeof (omp_lock_25_t)\n \t     || @OMP_LOCK_25_ALIGN@ != __alignof (omp_lock_25_t)"}, {"sha": "3ec31ac1f1ff8996f06bd7e68bd46de768f40cae", "filename": "libgomp/omp_lib.f90.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fomp_lib.f90.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fomp_lib.f90.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fomp_lib.f90.in?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -38,6 +38,7 @@\n         integer, parameter :: omp_alloctrait_key_kind = c_int\n         integer, parameter :: omp_alloctrait_val_kind = c_intptr_t\n         integer, parameter :: omp_memspace_handle_kind = c_intptr_t\n+        integer, parameter :: omp_depend_kind = @OMP_DEPEND_KIND@\n         integer (omp_sched_kind), parameter :: omp_sched_static = 1\n         integer (omp_sched_kind), parameter :: omp_sched_dynamic = 2\n         integer (omp_sched_kind), parameter :: omp_sched_guided = 3"}, {"sha": "26dbe03a629b912e6b3f9b6cffd745aac2c2b445", "filename": "libgomp/omp_lib.h.in", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fomp_lib.h.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Fomp_lib.h.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fomp_lib.h.in?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -26,6 +26,8 @@\n       integer omp_lock_kind, omp_nest_lock_kind, openmp_version\n       parameter (omp_lock_kind = @OMP_LOCK_KIND@)\n       parameter (omp_nest_lock_kind = @OMP_NEST_LOCK_KIND@)\n+      integer omp_depend_kind\n+      parameter (omp_depend_kind = @OMP_DEPEND_KIND@)\n       integer omp_sched_kind\n       parameter (omp_sched_kind = 4)\n       integer (omp_sched_kind) omp_sched_static, omp_sched_dynamic\n@@ -81,7 +83,7 @@\n       integer omp_allocator_handle_kind, omp_alloctrait_key_kind\n       integer omp_alloctrait_val_kind, omp_memspace_handle_kind\n       parameter (omp_allocator_handle_kind = @INTPTR_T_KIND@)\n-      parameter (omp_alloctrait_key_kind = @INTPTR_T_KIND@)\n+      parameter (omp_alloctrait_key_kind = 4)\n       parameter (omp_alloctrait_val_kind = @INTPTR_T_KIND@)\n       parameter (omp_memspace_handle_kind = @INTPTR_T_KIND@)\n       integer (omp_alloctrait_key_kind) omp_atk_sync_hint"}, {"sha": "58ba1f319b0739d107ba3248e6defe42103401cf", "filename": "libgomp/testsuite/Makefile.in", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Ftestsuite%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd/libgomp%2Ftestsuite%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2FMakefile.in?ref=2631d95ae29dc6a0f5bda4af1f6595a17b1efbfd", "patch": "@@ -186,6 +186,7 @@ NM = @NM@\n NMEDIT = @NMEDIT@\n OBJDUMP = @OBJDUMP@\n OBJEXT = @OBJEXT@\n+OMP_DEPEND_KIND = @OMP_DEPEND_KIND@\n OMP_LOCK_25_ALIGN = @OMP_LOCK_25_ALIGN@\n OMP_LOCK_25_KIND = @OMP_LOCK_25_KIND@\n OMP_LOCK_25_SIZE = @OMP_LOCK_25_SIZE@"}]}