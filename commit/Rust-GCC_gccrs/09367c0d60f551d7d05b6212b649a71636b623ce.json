{"sha": "09367c0d60f551d7d05b6212b649a71636b623ce", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDkzNjdjMGQ2MGY1NTFkN2QwNWI2MjEyYjY0OWE3MTYzNmI2MjNjZQ==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-10-25T16:35:24Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-10-25T16:35:24Z"}, "message": "Don't permit close of receive-only channel.\n\nBetter panic on attempt to close nil channel.\n\nFrom-SVN: r180437", "tree": {"sha": "c10e4945a3688d1e9989fda3872cb8d6ba04f4e3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c10e4945a3688d1e9989fda3872cb8d6ba04f4e3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/09367c0d60f551d7d05b6212b649a71636b623ce", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09367c0d60f551d7d05b6212b649a71636b623ce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/09367c0d60f551d7d05b6212b649a71636b623ce", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/09367c0d60f551d7d05b6212b649a71636b623ce/comments", "author": null, "committer": null, "parents": [{"sha": "0d53e34681bfbb0849726ee8d3b17cf330a33a76", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d53e34681bfbb0849726ee8d3b17cf330a33a76", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d53e34681bfbb0849726ee8d3b17cf330a33a76"}], "stats": {"total": 5, "additions": 5, "deletions": 0}, "files": [{"sha": "cdf2bad09f3c7e61389b317b61a42a5e43625572", "filename": "gcc/go/gofrontend/expressions.cc", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09367c0d60f551d7d05b6212b649a71636b623ce/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09367c0d60f551d7d05b6212b649a71636b623ce/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc?ref=09367c0d60f551d7d05b6212b649a71636b623ce", "patch": "@@ -8153,6 +8153,8 @@ Builtin_call_expression::do_check_types(Gogo*)\n \t{\n \t  if (this->one_arg()->type()->channel_type() == NULL)\n \t    this->report_error(_(\"argument must be channel\"));\n+\t  else if (!this->one_arg()->type()->channel_type()->may_send())\n+\t    this->report_error(_(\"cannot close receive-only channel\"));\n \t}\n       break;\n "}, {"sha": "778eab3d7d8f2bc41622bdc1a51ac1aaecb289cc", "filename": "libgo/runtime/go-close.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/09367c0d60f551d7d05b6212b649a71636b623ce/libgo%2Fruntime%2Fgo-close.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/09367c0d60f551d7d05b6212b649a71636b623ce/libgo%2Fruntime%2Fgo-close.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgo%2Fruntime%2Fgo-close.c?ref=09367c0d60f551d7d05b6212b649a71636b623ce", "patch": "@@ -16,6 +16,9 @@ __go_builtin_close (struct __go_channel *channel)\n {\n   int i;\n \n+  if (channel == NULL)\n+    __go_panic_msg (\"close of nil channel\");\n+\n   i = pthread_mutex_lock (&channel->lock);\n   __go_assert (i == 0);\n "}]}