{"sha": "b10d44efe5bb64662a55fe74696b8c2ca2d17303", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjEwZDQ0ZWZlNWJiNjQ2NjJhNTVmZTc0Njk2YjhjMmNhMmQxNzMwMw==", "commit": {"author": {"name": "Vladimir Makarov", "email": "vmakarov@redhat.com", "date": "2016-08-05T21:31:31Z"}, "committer": {"name": "Vladimir Makarov", "email": "vmakarov@gcc.gnu.org", "date": "2016-08-05T21:31:31Z"}, "message": "re PR rtl-optimization/69847 (Spec 2006 403.gcc slows down with -mlra vs. reload on PowerPC)\n\n2016-08-05  Vladimir Makarov  <vmakarov@redhat.com>\n\n\tPR rtl-optimization/69847\n\t* lra-constraints.c (process_invariant_for_inheritance): Save\n\tpattern instead of src.\n\t(remove_inheritance_pseudos): Use the pattern.  Add assert.\n\nFrom-SVN: r239180", "tree": {"sha": "711ec7aceb96e371bd7b3c1a2aeff512b0f69d87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/711ec7aceb96e371bd7b3c1a2aeff512b0f69d87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b10d44efe5bb64662a55fe74696b8c2ca2d17303", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b10d44efe5bb64662a55fe74696b8c2ca2d17303", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b10d44efe5bb64662a55fe74696b8c2ca2d17303", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b10d44efe5bb64662a55fe74696b8c2ca2d17303/comments", "author": {"login": "vnmakarov", "id": 9855671, "node_id": "MDQ6VXNlcjk4NTU2NzE=", "avatar_url": "https://avatars.githubusercontent.com/u/9855671?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vnmakarov", "html_url": "https://github.com/vnmakarov", "followers_url": "https://api.github.com/users/vnmakarov/followers", "following_url": "https://api.github.com/users/vnmakarov/following{/other_user}", "gists_url": "https://api.github.com/users/vnmakarov/gists{/gist_id}", "starred_url": "https://api.github.com/users/vnmakarov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vnmakarov/subscriptions", "organizations_url": "https://api.github.com/users/vnmakarov/orgs", "repos_url": "https://api.github.com/users/vnmakarov/repos", "events_url": "https://api.github.com/users/vnmakarov/events{/privacy}", "received_events_url": "https://api.github.com/users/vnmakarov/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9dcd84ec7a7579bb062ef4768810a9d4dc9c3ca2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9dcd84ec7a7579bb062ef4768810a9d4dc9c3ca2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9dcd84ec7a7579bb062ef4768810a9d4dc9c3ca2"}], "stats": {"total": 13, "additions": 11, "deletions": 2}, "files": [{"sha": "67ec6224a8afd32b4813c967e8e9ff5cdfeb0bcf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b10d44efe5bb64662a55fe74696b8c2ca2d17303/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b10d44efe5bb64662a55fe74696b8c2ca2d17303/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b10d44efe5bb64662a55fe74696b8c2ca2d17303", "patch": "@@ -1,3 +1,10 @@\n+2016-08-05  Vladimir Makarov  <vmakarov@redhat.com>\n+\n+\tPR rtl-optimization/69847\n+\t* lra-constraints.c (process_invariant_for_inheritance): Save\n+\tpattern instead of src.\n+\t(remove_inheritance_pseudos): Use the pattern.  Add assert.\n+\n 2016-08-05  David Malcolm  <dmalcolm@redhat.com>\n \n \t* input.c (string_concat::string_concat): New constructor."}, {"sha": "880eee0890d7e7d9e69e713f2eb475942430d185", "filename": "gcc/lra-constraints.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b10d44efe5bb64662a55fe74696b8c2ca2d17303/gcc%2Flra-constraints.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b10d44efe5bb64662a55fe74696b8c2ca2d17303/gcc%2Flra-constraints.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-constraints.c?ref=b10d44efe5bb64662a55fe74696b8c2ca2d17303", "patch": "@@ -5475,7 +5475,7 @@ process_invariant_for_inheritance (rtx dst_reg, rtx invariant_rtx)\n \t\t\t\t\tcl, \"invariant inheritance\");\n \t  bitmap_set_bit (&lra_inheritance_pseudos, REGNO (new_reg));\n \t  bitmap_set_bit (&check_only_regs, REGNO (new_reg));\n-\t  lra_reg_info[REGNO (new_reg)].restore_rtx = invariant_rtx;\n+\t  lra_reg_info[REGNO (new_reg)].restore_rtx = PATTERN (insn);\n \t  start_sequence ();\n \t  lra_emit_move (new_reg, dst_reg);\n \t  new_insns = get_insns ();\n@@ -6343,9 +6343,11 @@ remove_inheritance_pseudos (bitmap remove_pseudos)\n \t\t  start_sequence ();\n \t\t  /* We can not just change the source.  It might be\n \t\t     an insn different from the move.  */\n-\t\t  lra_emit_move (SET_DEST (set), lra_reg_info[sregno].restore_rtx);\n+\t\t  emit_insn (lra_reg_info[sregno].restore_rtx);\n \t\t  rtx_insn *new_insns = get_insns ();\n \t\t  end_sequence ();\n+\t\t  lra_assert (single_set (new_insns) != NULL\n+\t\t\t      && SET_DEST (set) == SET_DEST (single_set (new_insns)));\n \t\t  lra_process_new_insns (curr_insn, NULL, new_insns,\n \t\t\t\t\t \"Changing reload<-invariant inheritance\");\n \t\t  delete_move_and_clobber (curr_insn, dregno);"}]}