{"sha": "9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWFjM2IxYmVjN2I1OGM2YWQ0YTc2NzgyYjExMTZkZmI1ZjRjZDBjNg==", "commit": {"author": {"name": "Neil Booth", "email": "neil@daikokuya.demon.co.uk", "date": "2002-04-21T16:17:55Z"}, "committer": {"name": "Neil Booth", "email": "neil@gcc.gnu.org", "date": "2002-04-21T16:17:55Z"}, "message": "cppmacro.c (funlike_invocation_p): Don't step back over CPP_EOF.\n\n\t* cppmacro.c (funlike_invocation_p): Don't step back over CPP_EOF.\ntestsuite:\n\t* gcc.dg/cpp/endif.h, gcc.dg/cpp/endif.c: New tests.\n\nFrom-SVN: r52586", "tree": {"sha": "249f1d8f5adab5ad3e3c0bdc851bb1799c3102f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/249f1d8f5adab5ad3e3c0bdc851bb1799c3102f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/comments", "author": null, "committer": null, "parents": [{"sha": "d8b85ae5975987fbac892ed4350d860b3abef533", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d8b85ae5975987fbac892ed4350d860b3abef533", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d8b85ae5975987fbac892ed4350d860b3abef533"}], "stats": {"total": 41, "additions": 35, "deletions": 6}, "files": [{"sha": "f7a6c68907de6881a997bc31893c6e81055ff0fa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "patch": "@@ -1,3 +1,8 @@\n+2002-04-21  Neil Booth  <neil@daikokuya.demon.co.uk>\n+\n+\t* cppmacro.c (funlike_invocation_p): Don't step back\n+\tover CPP_EOF.\n+\n 2002-04-21  David Edelsohn  <edelsohn@gnu.org>\n \n \t* config/rs6000/rs6000.c (output_profile_hook): Do not increment"}, {"sha": "d39bd45ff255af7731a9653d309112cfddadd974", "filename": "gcc/cppmacro.c", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Fcppmacro.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Fcppmacro.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppmacro.c?ref=9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "patch": "@@ -632,12 +632,17 @@ funlike_invocation_p (pfile, node)\n       return collect_args (pfile, node);\n     }\n \n-  /* Back up.  We may have skipped padding, in which case backing up\n-     more than one token when expanding macros is in general too\n-     difficult.  We re-insert it in its own context.  */\n-  _cpp_backup_tokens (pfile, 1);\n-  if (padding)\n-    push_token_context (pfile, NULL, padding, 1);\n+  /* CPP_EOF can be the end of macro arguments, or the end of the\n+     file.  We mustn't back up over the latter.  Ugh.  */\n+  if (token->type != CPP_EOF || token == &pfile->eof)\n+    {\n+      /* Back up.  We may have skipped padding, in which case backing\n+\t up more than one token when expanding macros is in general\n+\t too difficult.  We re-insert it in its own context.  */\n+      _cpp_backup_tokens (pfile, 1);\n+      if (padding)\n+\tpush_token_context (pfile, NULL, padding, 1);\n+    }\n \n   return NULL;\n }"}, {"sha": "8c5385f86681aa50930ef9cd353cc84d5d9a83c6", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "patch": "@@ -1,3 +1,7 @@\n+2002-04-21  Neil Booth  <neil@daikokuya.demon.co.uk>\n+\n+\t* gcc.dg/cpp/endif.h, gcc.dg/cpp/endif.c: New tests.\n+\n 2002-04-21  Franz Sirl  <Franz.Sirl-kernel@lauterbach.com>\n \n \t* gcc.c-torture/execute/20000906-1.x: Delete."}, {"sha": "efea52c46c25427fb1cbb4ce6a1d03fdf392e552", "filename": "gcc/testsuite/gcc.dg/cpp/endif.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fendif.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fendif.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fendif.c?ref=9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "patch": "@@ -0,0 +1,14 @@\n+/* Copyright (C) 2002 Free Software Foundation, Inc.  */\n+\n+/* { dg-do preprocess } */\n+\n+/* Test case for PR preprocessor/6386 by Andreas Schwab.  We'd back up\n+   over the CPP_EOF token (indicating not a funlike macro invocation)\n+   in the header file, which would then be passed through as a real\n+   EOF, leading to an early exit (and therefore bogus complaint about\n+   unterminated #if).  */\n+\n+#define S(x)\n+#if 1\n+#include \"endif.h\"\n+#endif"}, {"sha": "37622491df3f4aa9c9d05a03275ae5d5f5263bef", "filename": "gcc/testsuite/gcc.dg/cpp/endif.h", "status": "added", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fendif.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fendif.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fendif.h?ref=9ac3b1bec7b58c6ad4a76782b1116dfb5f4cd0c6", "patch": "@@ -0,0 +1 @@\n+S"}]}