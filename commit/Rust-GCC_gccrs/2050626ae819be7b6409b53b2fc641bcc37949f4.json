{"sha": "2050626ae819be7b6409b53b2fc641bcc37949f4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjA1MDYyNmFlODE5YmU3YjY0MDliNTNiMmZjNjQxYmNjMzc5NDlmNA==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2015-11-13T00:14:32Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2015-11-13T00:14:32Z"}, "message": "re PR fortran/68318 (ICE on duplicate entry declarations)\n\n2015-11-12  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/68318\n\t* decl.c (get_proc_name): Increment reference count for ENTRY.\n\tWhile here, fix comment and use postfix ++ for consistency.\n\n2015-11-12  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/68318\n\t* gfortran.dg/pr68318_1.f90: New test.\n\t* gfortran.dg/pr68318_2.f90: Ditto.\n\nFrom-SVN: r230278", "tree": {"sha": "266afc73a4ebb97826028912318f59d8755bbc21", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/266afc73a4ebb97826028912318f59d8755bbc21"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2050626ae819be7b6409b53b2fc641bcc37949f4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2050626ae819be7b6409b53b2fc641bcc37949f4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2050626ae819be7b6409b53b2fc641bcc37949f4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2050626ae819be7b6409b53b2fc641bcc37949f4/comments", "author": null, "committer": null, "parents": [{"sha": "be561c63f445cc8caa2aaa06f254d70a532bff03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be561c63f445cc8caa2aaa06f254d70a532bff03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be561c63f445cc8caa2aaa06f254d70a532bff03"}], "stats": {"total": 57, "additions": 55, "deletions": 2}, "files": [{"sha": "4910f077e8459a4e568a6b575dd4a22321b0c92e", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=2050626ae819be7b6409b53b2fc641bcc37949f4", "patch": "@@ -1,3 +1,9 @@\n+2015-11-12  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/68318\n+\t* decl.c (get_proc_name): Increment reference count for ENTRY.\n+\tWhile here, fix comment and use postfix ++ for consistency.\n+\n 2015-11-11  Andrew MacLeod  <amacleod@redhat.com>\n \n \t* array.c: Remove unused header files."}, {"sha": "c10557e968cf9902ba3366fb73970fa964041e95", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=2050626ae819be7b6409b53b2fc641bcc37949f4", "patch": "@@ -925,6 +925,7 @@ get_proc_name (const char *name, gfc_symbol **result, bool module_fcn_entry)\n \t  gfc_find_sym_tree (name, gfc_current_ns, 0, &st);\n \t  st->n.sym = *result;\n \t  st = gfc_get_unique_symtree (gfc_current_ns);\n+\t  sym->refs++;\n \t  st->n.sym = sym;\n \t}\n     }\n@@ -971,7 +972,7 @@ get_proc_name (const char *name, gfc_symbol **result, bool module_fcn_entry)\n       /* Trap another encompassed procedure with the same name.  All\n \t these conditions are necessary to avoid picking up an entry\n \t whose name clashes with that of the encompassing procedure;\n-\t this is handled using gsymbols to register unique,globally\n+\t this is handled using gsymbols to register unique, globally\n \t accessible names.  */\n       if (sym->attr.flavor != 0\n \t  && sym->attr.proc != 0\n@@ -9051,7 +9052,7 @@ gfc_match_final_decl (void)\n \n       /* Add this symbol to the list of finalizers.  */\n       gcc_assert (block->f2k_derived);\n-      ++sym->refs;\n+      sym->refs++;\n       f = XCNEW (gfc_finalizer);\n       f->proc_sym = sym;\n       f->proc_tree = NULL;"}, {"sha": "6531a10068e04f9a3b5ec0c6849c7fcb5efcd899", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2050626ae819be7b6409b53b2fc641bcc37949f4", "patch": "@@ -1,3 +1,9 @@\n+2015-11-12  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/68318\n+\t* gfortran.dg/pr68318_1.f90: New test.\n+\t* gfortran.dg/pr68318_2.f90: Ditto.\n+\n 2015-11-12  James Norris  <jnorris@codesourcery.com>\n \t    Joseph Myers  <joseph@codesourcery.com>\n "}, {"sha": "1a3d59402f67f93870c01ada51af58597f1949cc", "filename": "gcc/testsuite/gfortran.dg/pr68318_1.f90", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68318_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68318_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68318_1.f90?ref=2050626ae819be7b6409b53b2fc641bcc37949f4", "patch": "@@ -0,0 +1,18 @@\n+! { dg-do compile }\n+! { dg-options \"-O0\"\n+! PR fortran/68318\n+! Original code submitted by Gerhard Steinmetz\n+! <gerhard dot steinmetz dot fortran at t-online dot de>\n+!\n+module m\n+   implicit none\n+contains\n+   subroutine s1\n+   entry e        ! { dg-error \"(2)\" }\n+   end\n+   subroutine s2\n+   entry e        ! { dg-error \"is already defined\" }\n+   end\n+end module\n+! { dg-prune-output \"Duplicate ENTRY attribute specified\" }\n+"}, {"sha": "451b28f2a479d3aa9eb2288038a11bf04a4c7e3e", "filename": "gcc/testsuite/gfortran.dg/pr68318_2.f90", "status": "added", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68318_2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2050626ae819be7b6409b53b2fc641bcc37949f4/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68318_2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr68318_2.f90?ref=2050626ae819be7b6409b53b2fc641bcc37949f4", "patch": "@@ -0,0 +1,22 @@\n+! { dg-do compile }\n+! PR fortran/68318\n+! Original code submitted by Gerhard Steinmetz\n+! <gerhard dot steinmetz dot fortran at t-online dot de>\n+!\n+module m1\n+   implicit none\n+contains\n+   subroutine s1\n+   entry e\n+   end\n+end module\n+\n+module m2\n+   use m1         ! { dg-error \"(2)\" }\n+   implicit none\n+contains\n+   subroutine s2\n+   entry e        ! { dg-error \"is already defined\" }\n+   end\n+end module\n+! { dg-prune-output \"Cannot change attribute\" }"}]}