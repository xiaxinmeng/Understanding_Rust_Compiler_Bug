{"sha": "8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGUyYmU1YWVmY2M3OGIyMTNjMmY0NGU1MGNiZWMyYzc5OWY0MGY4Yg==", "commit": {"author": {"name": "Maciej W. Rozycki", "email": "macro@imgtec.com", "date": "2016-11-16T21:05:01Z"}, "committer": {"name": "Maciej W. Rozycki", "email": "macro@gcc.gnu.org", "date": "2016-11-16T21:05:01Z"}, "message": "microMIPS/GCC: Fix PIC call relaxation\n\n\tgcc/\n\t* config/mips/mips.c (mips_output_jump): Output R_MICROMIPS_JALR\n\trather than R_MIPS_JALR relocation in microMIPS code.  Do not\n\tcancel short delay slots in PIC call relaxation.\n\n\tgcc/testsuite/\n\t* gcc.target/mips/call-1.c (dg-options): Add `-mno-micromips'.\n\t(dg-final): Remove microMIPS JALRS mnemonic matching.\n\t* gcc.target/mips/call-2.c (dg-options): Add `-mno-micromips'.\n\t(dg-final): Remove microMIPS JALRS mnemonic matching.\n\t* gcc.target/mips/call-3.c (dg-options): Add `-mno-micromips'.\n\t(dg-final): Remove microMIPS JALRS mnemonic matching.\n\t* gcc.target/mips/call-4.c (dg-options): Add `-mno-micromips'.\n\t* gcc.target/mips/call-5.c (dg-options): Add `-mno-micromips'.\n\t* gcc.target/mips/call-6.c (dg-options): Add `-mno-micromips'.\n\t* gcc.target/mips/call-1u.c: New test case.\n\t* gcc.target/mips/call-2u.c: New test case.\n\t* gcc.target/mips/call-3u.c: New test case.\n\t* gcc.target/mips/call-4u.c: New test case.\n\t* gcc.target/mips/call-5u.c: New test case.\n\t* gcc.target/mips/call-6u.c: New test case.\n\nFrom-SVN: r242512", "tree": {"sha": "08e0b5bf62873cee3510eb0f3d5cc057e25b7fd5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/08e0b5bf62873cee3510eb0f3d5cc057e25b7fd5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/comments", "author": null, "committer": null, "parents": [{"sha": "3549e181bd89b7f8a978cae9f55679c4ccd9a010", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3549e181bd89b7f8a978cae9f55679c4ccd9a010", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3549e181bd89b7f8a978cae9f55679c4ccd9a010"}], "stats": {"total": 248, "additions": 231, "deletions": 17}, "files": [{"sha": "4e437f0bb670d6c590473460a97a5e8b04eb04a8", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,3 +1,9 @@\n+2016-11-16  Maciej W. Rozycki  <macro@imgtec.com>\n+\n+\t* config/mips/mips.c (mips_output_jump): Output R_MICROMIPS_JALR\n+\trather than R_MIPS_JALR relocation in microMIPS code.  Do not\n+\tcancel short delay slots in PIC call relaxation.\n+\n 2016-11-16  Thomas Preud'homme  <thomas.preudhomme@arm.com>\n \n \t* config/arm/arm.md (arm_addsi3): Add alternative for addition of"}, {"sha": "d6464c504302130589e61a4cf6a11629b30dfad6", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 3, "deletions": 6, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -13618,12 +13618,9 @@ mips_output_jump (rtx *operands, int target_opno, int size_opno, bool link_p)\n \ts += sprintf (s, \".option\\tpic0\\n\\t\");\n \n       if (reg_p && mips_get_pic_call_symbol (operands, size_opno))\n-\t{\n-\t  s += sprintf (s, \"%%*.reloc\\t1f,R_MIPS_JALR,%%%d\\n1:\\t\", size_opno);\n-\t  /* Not sure why this shouldn't permit a short delay but it did not\n-\t     allow it before so we still don't allow it.  */\n-\t  short_delay = \"\";\n-\t}\n+\ts += sprintf (s, \"%%*.reloc\\t1f,%s,%%%d\\n1:\\t\",\n+\t\t      TARGET_MICROMIPS ? \"R_MICROMIPS_JALR\" : \"R_MIPS_JALR\",\n+\t\t      size_opno);\n       else\n \ts += sprintf (s, \"%%*\");\n "}, {"sha": "0677079fb2b8f29c7c6bdd74a3e40391a1623b28", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,3 +1,21 @@\n+2016-11-16  Maciej W. Rozycki  <macro@imgtec.com>\n+\n+\t* gcc.target/mips/call-1.c (dg-options): Add `-mno-micromips'.\n+\t(dg-final): Remove microMIPS JALRS mnemonic matching.\n+\t* gcc.target/mips/call-2.c (dg-options): Add `-mno-micromips'.\n+\t(dg-final): Remove microMIPS JALRS mnemonic matching.\n+\t* gcc.target/mips/call-3.c (dg-options): Add `-mno-micromips'.\n+\t(dg-final): Remove microMIPS JALRS mnemonic matching.\n+\t* gcc.target/mips/call-4.c (dg-options): Add `-mno-micromips'.\n+\t* gcc.target/mips/call-5.c (dg-options): Add `-mno-micromips'.\n+\t* gcc.target/mips/call-6.c (dg-options): Add `-mno-micromips'.\n+\t* gcc.target/mips/call-1u.c: New test case.\n+\t* gcc.target/mips/call-2u.c: New test case.\n+\t* gcc.target/mips/call-3u.c: New test case.\n+\t* gcc.target/mips/call-4u.c: New test case.\n+\t* gcc.target/mips/call-5u.c: New test case.\n+\t* gcc.target/mips/call-6u.c: New test case.\n+\n 2016-11-16  Thomas Preud'homme  <thomas.preudhomme@arm.com>\n \n \t* gcc.target/arm/empty_fiq_handler.c: New test."}, {"sha": "9516e7ea89b0590906cab523b01fdee0e55f9c7f", "filename": "gcc/testsuite/gcc.target/mips/call-1.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-1.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,8 +1,8 @@\n-/* { dg-options \"-mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=32\" } */\n+/* { dg-options \"-mno-micromips -mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=32\" } */\n /* { dg-skip-if \"requires -foptimize-sibling-calls\" { *-*-* } { \"-O0\" } { \"\" } } */\n-/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal\\n1:\\tjalrc?s?\\t\" } } */\n-/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal2\\n1:\\tjalrc?s?\\t\" } } */\n-/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,staticfunc\\n1:\\tjalrc?s?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal\\n1:\\tjalrc?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal2\\n1:\\tjalrc?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,staticfunc\\n1:\\tjalrc?\\t\" } } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,tail\\n1:\\tjrc?\\t\" } } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,tail2\\n1:\\tjrc?\\t\" } } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,tail3\\n1:\\tjrc?\\t\" } } */"}, {"sha": "d9700e26aee60b1dc2db70f238227e62785a3b83", "filename": "gcc/testsuite/gcc.target/mips/call-1u.c", "status": "added", "additions": 51, "deletions": 0, "changes": 51, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-1u.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-1u.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-1u.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -0,0 +1,51 @@\n+/* { dg-options \"-mmicromips -mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=32\" } */\n+/* { dg-skip-if \"requires -foptimize-sibling-calls\" { *-*-* } { \"-O0\" } { \"\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,normal\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,normal2\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,staticfunc\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail\\n1:\\tjrc?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail2\\n1:\\tjrc?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail3\\n1:\\tjrc?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail4\\n1:\\tjrc?\\t\" } } */\n+\n+__attribute__ ((noinline)) static void staticfunc () { asm (\"\"); }\n+int normal ();\n+void normal2 ();\n+\n+int\n+NOMIPS16 f (int *p)\n+{\n+  *p = normal ();\n+  normal2 ();\n+  staticfunc ();\n+  return 1;\n+}\n+\n+int tail ();\n+\n+int\n+NOMIPS16 h ()\n+{\n+  return tail ();\n+}\n+\n+void tail2 ();\n+\n+NOMIPS16 void g ()\n+{\n+  tail2 ();\n+}\n+\n+__attribute__ ((visibility (\"hidden\"))) void tail3 ();\n+\n+NOMIPS16 void j ()\n+{\n+  tail3 ();\n+}\n+\n+__attribute__ ((noinline)) static void tail4 () { asm (\"\"); }\n+\n+NOMIPS16 void k ()\n+{\n+  tail4 ();\n+}"}, {"sha": "916cc7b46503b2632baf56faf952df03b211be10", "filename": "gcc/testsuite/gcc.target/mips/call-2.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-2.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,6 +1,6 @@\n /* See through some simple data-flow.  */\n-/* { dg-options \"-mrelax-pic-calls\" } */\n-/* { dg-final { scan-assembler-times \"\\\\.reloc\\t1f,R_MIPS_JALR,g\\n1:\\tjalrc?s?\\t\" 2 } } */\n+/* { dg-options \"-mno-micromips -mrelax-pic-calls\" } */\n+/* { dg-final { scan-assembler-times \"\\\\.reloc\\t1f,R_MIPS_JALR,g\\n1:\\tjalrc?\\t\" 2 } } */\n \n extern void g (void);\n "}, {"sha": "4f5903057e2c2c7c42742c665e623d844792b824", "filename": "gcc/testsuite/gcc.target/mips/call-2u.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-2u.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-2u.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-2u.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -0,0 +1,13 @@\n+/* See through some simple data-flow.  */\n+/* { dg-options \"-mmicromips -mrelax-pic-calls\" } */\n+/* { dg-final { scan-assembler-times \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,g\\n1:\\tjalrs?\\t\" 2 } } */\n+\n+extern void g (void);\n+\n+int\n+NOMIPS16 f ()\n+{\n+  g ();\n+  g ();\n+  return 1;\n+}"}, {"sha": "c52bc74d12bc78f73e76a48bef209a31730f42b2", "filename": "gcc/testsuite/gcc.target/mips/call-3.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-3.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,5 +1,5 @@\n-/* { dg-options \"-mrelax-pic-calls -mno-shared\" } */\n-/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,g\\n1:\\tjalrc?s?\\t\" } } */\n+/* { dg-options \"-mno-micromips -mrelax-pic-calls -mno-shared\" } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,g\\n1:\\tjalrc?\\t\" } } */\n /* { dg-require-visibility \"\" } */\n \n __attribute__ ((visibility (\"hidden\"))) void g ();"}, {"sha": "f8d557d27c56aa28a66ee9f9b42e79bcd1ac6933", "filename": "gcc/testsuite/gcc.target/mips/call-3u.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-3u.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-3u.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-3u.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -0,0 +1,12 @@\n+/* { dg-options \"-mmicromips -mrelax-pic-calls -mno-shared\" } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,g\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-require-visibility \"\" } */\n+\n+__attribute__ ((visibility (\"hidden\"))) void g ();\n+\n+int\n+NOMIPS16 f ()\n+{\n+  g ();\n+  return 1;\n+}"}, {"sha": "eb79d0d2a2519ab169cd87da578795941da5fae5", "filename": "gcc/testsuite/gcc.target/mips/call-4.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-4.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,5 +1,5 @@\n /* See through some simple data-flow.  */\n-/* { dg-options \"-mrelax-pic-calls\" } */\n+/* { dg-options \"-mno-micromips -mrelax-pic-calls\" } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,g\\n1:\\tjalrc?\\t\" } } */\n \n extern void g (void);"}, {"sha": "70bc3993033ec198d171b43360e8e39c7e116aac", "filename": "gcc/testsuite/gcc.target/mips/call-4u.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-4u.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-4u.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-4u.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -0,0 +1,12 @@\n+/* See through some simple data-flow.  */\n+/* { dg-options \"-mmicromips -mrelax-pic-calls\" } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,g\\n1:\\tjalrs?\\t\" } } */\n+\n+extern void g (void);\n+\n+int\n+NOMIPS16 f (int i)\n+{\n+  while (i--)\n+    g ();\n+}"}, {"sha": "822dc77bc9166ae6a7fbf3e4c9e9915bae9991ef", "filename": "gcc/testsuite/gcc.target/mips/call-5.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-5.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,6 +1,6 @@\n /* Like call-1.c, but for n32.  We cannot use sibling calls for tail and tail2\n    in this case (PR target/57260).  */\n-/* { dg-options \"-mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=n32\" } */\n+/* { dg-options \"-mno-micromips -mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=n32\" } */\n /* { dg-skip-if \"requires -foptimize-sibling-calls\" { *-*-* } { \"-O0\" } { \"\" } } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal\\n1:\\tjalrc?\\t\" } } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal2\\n1:\\tjalrc?\\t\" } } */"}, {"sha": "e98c059599dc747e98b2f5afb3cae452e091527e", "filename": "gcc/testsuite/gcc.target/mips/call-5u.c", "status": "added", "additions": 53, "deletions": 0, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-5u.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-5u.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-5u.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -0,0 +1,53 @@\n+/* Like call-1.c, but for n32.  We cannot use sibling calls for tail and tail2\n+   in this case (PR target/57260).  */\n+/* { dg-options \"-mmicromips -mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=n32\" } */\n+/* { dg-skip-if \"requires -foptimize-sibling-calls\" { *-*-* } { \"-O0\" } { \"\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,normal\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,normal2\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,staticfunc\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail2\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail3\\n1:\\tjrc?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail4\\n1:\\tjrc?\\t\" } } */\n+\n+__attribute__ ((noinline)) static void staticfunc () { asm (\"\"); }\n+int normal ();\n+void normal2 ();\n+\n+int\n+NOMIPS16 f (int *p)\n+{\n+  *p = normal ();\n+  normal2 ();\n+  staticfunc ();\n+  return 1;\n+}\n+\n+int tail ();\n+\n+int\n+NOMIPS16 h ()\n+{\n+  return tail ();\n+}\n+\n+void tail2 ();\n+\n+NOMIPS16 void g ()\n+{\n+  tail2 ();\n+}\n+\n+__attribute__ ((visibility (\"hidden\"))) void tail3 ();\n+\n+NOMIPS16 void j ()\n+{\n+  tail3 ();\n+}\n+\n+__attribute__ ((noinline)) static void tail4 () { asm (\"\"); }\n+\n+NOMIPS16 void k ()\n+{\n+  tail4 ();\n+}"}, {"sha": "0267751773feed5f98baf9b8bc8c96abe6ebfbf3", "filename": "gcc/testsuite/gcc.target/mips/call-6.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-6.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -1,5 +1,5 @@\n /* Like call-5.c, but for n64.  */\n-/* { dg-options \"-mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=64\" } */\n+/* { dg-options \"-mno-micromips -mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=64\" } */\n /* { dg-skip-if \"requires -foptimize-sibling-calls\" { *-*-* } { \"-O0\" } { \"\" } } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal\\n1:\\tjalrc?\\t\" } } */\n /* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MIPS_JALR,normal2\\n1:\\tjalrc?\\t\" } } */"}, {"sha": "5d3b15ebf3522601f5d78c4a4d400d61d638dbbe", "filename": "gcc/testsuite/gcc.target/mips/call-6u.c", "status": "added", "additions": 52, "deletions": 0, "changes": 52, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-6u.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e2be5aefcc78b213c2f44e50cbec2c799f40f8b/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-6u.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Fcall-6u.c?ref=8e2be5aefcc78b213c2f44e50cbec2c799f40f8b", "patch": "@@ -0,0 +1,52 @@\n+/* Like call-5.c, but for n64.  */\n+/* { dg-options \"-mmicromips -mrelax-pic-calls -mshared -foptimize-sibling-calls -mabi=64\" } */\n+/* { dg-skip-if \"requires -foptimize-sibling-calls\" { *-*-* } { \"-O0\" } { \"\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,normal\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,normal2\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,staticfunc\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail2\\n1:\\tjalrs?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail3\\n1:\\tjrc?\\t\" } } */\n+/* { dg-final { scan-assembler \"\\\\.reloc\\t1f,R_MICROMIPS_JALR,tail4\\n1:\\tjrc?\\t\" } } */\n+\n+__attribute__ ((noinline)) static void staticfunc () { asm (\"\"); }\n+int normal ();\n+void normal2 ();\n+\n+int\n+NOMIPS16 f (int *p)\n+{\n+  *p = normal ();\n+  normal2 ();\n+  staticfunc ();\n+  return 1;\n+}\n+\n+int tail ();\n+\n+int\n+NOMIPS16 h ()\n+{\n+  return tail ();\n+}\n+\n+void tail2 ();\n+\n+NOMIPS16 void g ()\n+{\n+  tail2 ();\n+}\n+\n+__attribute__ ((visibility (\"hidden\"))) void tail3 ();\n+\n+NOMIPS16 void j ()\n+{\n+  tail3 ();\n+}\n+\n+__attribute__ ((noinline)) static void tail4 () { asm (\"\"); }\n+\n+NOMIPS16 void k ()\n+{\n+  tail4 ();\n+}"}]}