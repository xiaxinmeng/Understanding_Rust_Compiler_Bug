{"sha": "d904008df267cbcc01bd6edf98fa0789fb6e94da", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDkwNDAwOGRmMjY3Y2JjYzAxYmQ2ZWRmOThmYTA3ODlmYjZlOTRkYQ==", "commit": {"author": {"name": "YunQiang Su", "email": "yunqiang.su@cipunited.com", "date": "2021-08-28T11:39:04Z"}, "committer": {"name": "YunQiang Su", "email": "syq@debian.org", "date": "2021-08-31T01:38:46Z"}, "message": "MIPS: add .module mipsREV to all output asm file\n\nCurrently, the asm output file for MIPS has no rev info.\nIt can make some trouble, for example:\n  assembler is mips1 by default,\n  gcc is fpxx by default.\nTo assemble the output of gcc -S, we have to pass -mips2\nto assembler.\n\ngcc/ChangeLog:\n\n\t* config/mips/mips.c (mips_module_isa_name): New.\n\t  mips_file_start: add .module mipsREV to all asm output", "tree": {"sha": "c4961b4cc58ff2c4383b262de6c0656fd9b99bbc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c4961b4cc58ff2c4383b262de6c0656fd9b99bbc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d904008df267cbcc01bd6edf98fa0789fb6e94da", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d904008df267cbcc01bd6edf98fa0789fb6e94da", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d904008df267cbcc01bd6edf98fa0789fb6e94da", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d904008df267cbcc01bd6edf98fa0789fb6e94da/comments", "author": null, "committer": {"login": "wzssyqa", "id": 163337, "node_id": "MDQ6VXNlcjE2MzMzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/163337?v=4", "gravatar_id": "", "url": "https://api.github.com/users/wzssyqa", "html_url": "https://github.com/wzssyqa", "followers_url": "https://api.github.com/users/wzssyqa/followers", "following_url": "https://api.github.com/users/wzssyqa/following{/other_user}", "gists_url": "https://api.github.com/users/wzssyqa/gists{/gist_id}", "starred_url": "https://api.github.com/users/wzssyqa/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/wzssyqa/subscriptions", "organizations_url": "https://api.github.com/users/wzssyqa/orgs", "repos_url": "https://api.github.com/users/wzssyqa/repos", "events_url": "https://api.github.com/users/wzssyqa/events{/privacy}", "received_events_url": "https://api.github.com/users/wzssyqa/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4ecfc7e3debac53a30558d7ae33e8cdfdf351466", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ecfc7e3debac53a30558d7ae33e8cdfdf351466", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ecfc7e3debac53a30558d7ae33e8cdfdf351466"}], "stats": {"total": 41, "additions": 41, "deletions": 0}, "files": [{"sha": "a7087ec0a90bcc105fea14f585680e367e1d3709", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d904008df267cbcc01bd6edf98fa0789fb6e94da/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d904008df267cbcc01bd6edf98fa0789fb6e94da/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=d904008df267cbcc01bd6edf98fa0789fb6e94da", "patch": "@@ -9841,6 +9841,44 @@ mips_mdebug_abi_name (void)\n     }\n }\n \n+static const char *\n+mips_module_isa_name ()\n+{\n+  switch (mips_isa)\n+    {\n+    case MIPS_ISA_MIPS1:\n+      return \"mips1\";\n+    case MIPS_ISA_MIPS2:\n+      return \"mips2\";\n+    case MIPS_ISA_MIPS3:\n+      return \"mips3\";\n+    case MIPS_ISA_MIPS4:\n+      return \"mips4\";\n+    case MIPS_ISA_MIPS32:\n+      return \"mips32\";\n+    case MIPS_ISA_MIPS32R2:\n+      return \"mips32r2\";\n+    case MIPS_ISA_MIPS32R3:\n+      return \"mips32r3\";\n+    case MIPS_ISA_MIPS32R5:\n+      return \"mips32r5\";\n+    case MIPS_ISA_MIPS32R6:\n+      return \"mips32r6\";\n+    case MIPS_ISA_MIPS64:\n+      return \"mips64\";\n+    case MIPS_ISA_MIPS64R2:\n+      return \"mips64r2\";\n+    case MIPS_ISA_MIPS64R3:\n+      return \"mips64r3\";\n+    case MIPS_ISA_MIPS64R5:\n+      return \"mips64r5\";\n+    case MIPS_ISA_MIPS64R6:\n+      return \"mips64r6\";\n+    default:\n+      gcc_unreachable ();\n+    }\n+}\n+\n /* Implement TARGET_ASM_FILE_START.  */\n \n static void\n@@ -9873,6 +9911,9 @@ mips_file_start (void)\n \t     mips_nan == MIPS_IEEE_754_2008 ? \"2008\" : \"legacy\");\n \n #ifdef HAVE_AS_DOT_MODULE\n+  fprintf (asm_out_file, \"\\t.module\\t%s\\n\",\n+\t   mips_module_isa_name ());\n+\n   /* Record the FP ABI.  See below for comments.  */\n   if (TARGET_NO_FLOAT)\n #ifdef HAVE_AS_GNU_ATTRIBUTE"}]}