{"sha": "3dfe4883e7b0dec116a927968f8fe60500f03c35", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2RmZTQ4ODNlN2IwZGVjMTE2YTkyNzk2OGY4ZmU2MDUwMGYwM2MzNQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-01-06T10:30:54Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-01-06T10:30:54Z"}, "message": "[multiple changes]\n\n2015-01-06  Pascal Obry  <obry@adacore.com>\n\n\t* bindgen.adb: Minor style fix.\n\n2015-01-06  Robert Dewar  <dewar@adacore.com>\n\n\t* sem_util.ads, sem_util.adb: Minor reformatting.\n\n2015-01-06  Vincent Celier  <celier@adacore.com>\n\n\t* prj-conf.adb (Parse_Project_And_Apply_Config): Reset incomplete\n\twith flags before parsing the projects.\n\t* prj-err.adb (Error_Msg): Do nothing if there are incomplete withs.\n\t* prj-part.adb (Post_Parse_Context_Clause): Set Incomplete_Withs\n\tto True in the flags, when Ignore_Missing_With is True and an\n\timported project cannot be found.\n\t* prj-proc.adb (Expression): When there are incomplete withs and\n\ta variable or attribute is not found, set the variable/attribute\n\tto unknown.\n\t* prj.ads (Processing_Flags): New flag Incomplete_Withs,\n\tdefaulted to False.\n\n2015-01-06  Vasiliy Fofanov  <fofanov@adacore.com>\n\n\t* prj-proc.adb, prj-part.adb, prj.adb, prj.ads, prj-conf.adb,\n\tprj-err.adb: Add new switch --no-command-line.\n\nFrom-SVN: r219252", "tree": {"sha": "c895f7df1a184cfc7034b830555d10913c43d454", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c895f7df1a184cfc7034b830555d10913c43d454"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3dfe4883e7b0dec116a927968f8fe60500f03c35", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dfe4883e7b0dec116a927968f8fe60500f03c35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3dfe4883e7b0dec116a927968f8fe60500f03c35", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3dfe4883e7b0dec116a927968f8fe60500f03c35/comments", "author": null, "committer": null, "parents": [{"sha": "59e9bc0b6ff7d00bd56a5b4767014b6529bf820b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59e9bc0b6ff7d00bd56a5b4767014b6529bf820b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59e9bc0b6ff7d00bd56a5b4767014b6529bf820b"}], "stats": {"total": 111, "additions": 87, "deletions": 24}, "files": [{"sha": "19d6eb08761ba3573db45fc341b9da11c3daa09a", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -1,3 +1,30 @@\n+2015-01-06  Pascal Obry  <obry@adacore.com>\n+\n+\t* bindgen.adb: Minor style fix.\n+\n+2015-01-06  Robert Dewar  <dewar@adacore.com>\n+\n+\t* sem_util.ads, sem_util.adb: Minor reformatting.\n+\n+2015-01-06  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-conf.adb (Parse_Project_And_Apply_Config): Reset incomplete\n+\twith flags before parsing the projects.\n+\t* prj-err.adb (Error_Msg): Do nothing if there are incomplete withs.\n+\t* prj-part.adb (Post_Parse_Context_Clause): Set Incomplete_Withs\n+\tto True in the flags, when Ignore_Missing_With is True and an\n+\timported project cannot be found.\n+\t* prj-proc.adb (Expression): When there are incomplete withs and\n+\ta variable or attribute is not found, set the variable/attribute\n+\tto unknown.\n+\t* prj.ads (Processing_Flags): New flag Incomplete_Withs,\n+\tdefaulted to False.\n+\n+2015-01-06  Vasiliy Fofanov  <fofanov@adacore.com>\n+\n+\t* prj-proc.adb, prj-part.adb, prj.adb, prj.ads, prj-conf.adb,\n+\tprj-err.adb: Add new switch --no-command-line.\n+\n 2015-01-06  Ed Schonberg  <schonberg@adacore.com>\n \n \t* sem_ch12.adb: Sloc of wrapper is that of instantiation."}, {"sha": "9f4f105dddd3f0f0d7c638b3dc0402c20a75a612", "filename": "gcc/ada/bindgen.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fbindgen.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fbindgen.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fbindgen.adb?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -941,7 +941,7 @@ package body Bindgen is\n          WBI (\"      System.Elaboration_Allocators.Mark_End_Of_Elaboration;\");\n       end if;\n \n-      --  From this point, no new dispatching domain can be created.\n+      --  From this point, no new dispatching domain can be created\n \n       if Dispatching_Domains_Used then\n          WBI (\"      Freeze_Dispatching_Domains;\");"}, {"sha": "ba1a8f2a9a420810955e2849b293dca32da896ec", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -19247,6 +19247,13 @@ status if at least one test fails or crashes. @var{val} can be either\n Suppresses comment line containing file name and line number of corresponding\n subprograms in test skeletons.\n \n+@item --no-command-line\n+@cindex @option{--no-command-line} (@command{gnattest})\n+Don't add command line support to test driver. Note that regardless of this\n+switch, @command{gnattest} will automatically refrain from adding command\n+line support if it detects that the selected run-time doesn't provide\n+this capability.\n+\n \n @item --separates\n @cindex @option{--separates} (@command{gnattest})"}, {"sha": "4ab035d1ef347be1e3e9880513bddf90f2dffee6", "filename": "gcc/ada/prj-conf.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-conf.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-conf.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-conf.adb?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -1652,6 +1652,8 @@ package body Prj.Conf is\n \n       --  Parse the user project tree\n \n+      Project_Node_Tree.Incomplete_With := False;\n+      Env.Flags.Incomplete_Withs := False;\n       Prj.Initialize (Project_Tree);\n \n       Main_Project := No_Project;"}, {"sha": "e6e6dd3b8e5cbc98b5596c5fdf1c8603b2e0619b", "filename": "gcc/ada/prj-err.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-err.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-err.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-err.adb?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2002-2011, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2002-2014, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -72,6 +72,10 @@ package body Prj.Err is\n       Real_Location : Source_Ptr := Location;\n \n    begin\n+      if Flags.Incomplete_Withs then\n+         return;\n+      end if;\n+\n       --  Display the error message in the traces so that it appears in the\n       --  correct location in the traces (otherwise error messages are only\n       --  displayed at the end and it is difficult to see when they were"}, {"sha": "c4cf2da8c886f207c36ca746cb56f5c28ff4f595", "filename": "gcc/ada/prj-part.adb", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-part.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-part.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-part.adb?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -895,6 +895,7 @@ package body Prj.Part is\n             if Imported_Path_Name_Id = No_Path then\n                if Env.Flags.Ignore_Missing_With then\n                   In_Tree.Incomplete_With := True;\n+                  Env.Flags.Incomplete_Withs := True;\n \n                else\n                   --  The project file cannot be found"}, {"sha": "ac2cc66ce3125954462f2ea859828aeabef05c42", "filename": "gcc/ada/prj-proc.adb", "status": "modified", "additions": 16, "deletions": 4, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-proc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj-proc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-proc.adb?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -819,11 +819,23 @@ package body Prj.Proc is\n \n                      end if;\n \n-                     pragma Assert (The_Variable_Id /= No_Variable,\n-                                      \"variable or attribute not found\");\n+                     if From_Project_Node_Tree.Incomplete_With then\n+                        if The_Variable_Id = No_Variable then\n+                           The_Variable := Nil_Variable_Value;\n+                        else\n+                           The_Variable :=\n+                             Shared.Variable_Elements.Table\n+                               (The_Variable_Id).Value;\n+                        end if;\n \n-                     The_Variable :=\n-                       Shared.Variable_Elements.Table (The_Variable_Id).Value;\n+                     else\n+                        pragma Assert (The_Variable_Id /= No_Variable,\n+                                       \"variable or attribute not found\");\n+\n+                        The_Variable :=\n+                          Shared.Variable_Elements.Table\n+                            (The_Variable_Id).Value;\n+                     end if;\n \n                   else\n "}, {"sha": "9da0f4485646c5e3f78936a1889a89e06fd7e8a7", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -1934,7 +1934,8 @@ package body Prj is\n          Require_Obj_Dirs           => Require_Obj_Dirs,\n          Allow_Invalid_External     => Allow_Invalid_External,\n          Missing_Source_Files       => Missing_Source_Files,\n-         Ignore_Missing_With        => Ignore_Missing_With);\n+         Ignore_Missing_With        => Ignore_Missing_With,\n+         Incomplete_Withs           => False);\n    end Create_Flags;\n \n    ------------"}, {"sha": "935f3de510f3bc99b5bc4c53ebc51cdb631c7cf1", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -2051,6 +2051,11 @@ private\n       Allow_Invalid_External     : Error_Warning;\n       Missing_Source_Files       : Error_Warning;\n       Ignore_Missing_With        : Boolean;\n+\n+      Incomplete_Withs           : Boolean := False;\n+      --  This flag is set to True when the projects are parsed while ignoring\n+      --  missing withed project and some withed projects are not found.\n+\n    end record;\n \n    Gprbuild_Flags   : constant Processing_Flags :=\n@@ -2063,7 +2068,8 @@ private\n                          Require_Obj_Dirs           => Error,\n                          Allow_Invalid_External     => Error,\n                          Missing_Source_Files       => Error,\n-                         Ignore_Missing_With        => False);\n+                         Ignore_Missing_With        => False,\n+                         Incomplete_Withs           => False);\n \n    Gprinstall_Flags : constant Processing_Flags :=\n                         (Report_Error               => null,\n@@ -2075,7 +2081,8 @@ private\n                          Require_Obj_Dirs           => Silent,\n                          Allow_Invalid_External     => Error,\n                          Missing_Source_Files       => Error,\n-                         Ignore_Missing_With        => False);\n+                         Ignore_Missing_With        => False,\n+                         Incomplete_Withs           => False);\n \n    Gprclean_Flags   : constant Processing_Flags :=\n                         (Report_Error               => null,\n@@ -2087,7 +2094,8 @@ private\n                          Require_Obj_Dirs           => Warning,\n                          Allow_Invalid_External     => Error,\n                          Missing_Source_Files       => Error,\n-                         Ignore_Missing_With        => False);\n+                         Ignore_Missing_With        => False,\n+                         Incomplete_Withs           => False);\n \n    Gprexec_Flags    : constant Processing_Flags :=\n                         (Report_Error               => null,\n@@ -2099,7 +2107,8 @@ private\n                          Require_Obj_Dirs           => Silent,\n                          Allow_Invalid_External     => Error,\n                          Missing_Source_Files       => Silent,\n-                         Ignore_Missing_With        => False);\n+                         Ignore_Missing_With        => False,\n+                         Incomplete_Withs           => False);\n \n    Gnatmake_Flags   : constant Processing_Flags :=\n                         (Report_Error               => null,\n@@ -2111,6 +2120,7 @@ private\n                          Require_Obj_Dirs           => Error,\n                          Allow_Invalid_External     => Error,\n                          Missing_Source_Files       => Error,\n-                         Ignore_Missing_With        => False);\n+                         Ignore_Missing_With        => False,\n+                         Incomplete_Withs           => False);\n \n end Prj;"}, {"sha": "b0fcc17da47abd5dbe47b7c493960b85fa8cfc65", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 10, "deletions": 11, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -5065,23 +5065,22 @@ package body Sem_Util is\n          end if;\n       end Select_Node;\n \n-   --  Start of processing for Designate_Next_Unit\n+   --  Start of processing for Designate_Same_Unit\n \n    begin\n-      if (K1 = N_Identifier or else K1 = N_Defining_Identifier)\n+      if Nkind_In (K1, N_Identifier, N_Defining_Identifier)\n            and then\n-         (K2 = N_Identifier or else K2 = N_Defining_Identifier)\n+         Nkind_In (K2, N_Identifier, N_Defining_Identifier)\n       then\n          return Chars (Name1) = Chars (Name2);\n \n-      elsif\n-         (K1 = N_Expanded_Name      or else\n-          K1 = N_Selected_Component or else\n-          K1 = N_Defining_Program_Unit_Name)\n-        and then\n-         (K2 = N_Expanded_Name      or else\n-          K2 = N_Selected_Component or else\n-          K2 = N_Defining_Program_Unit_Name)\n+      elsif Nkind_In (K1, N_Expanded_Name,\n+                          N_Selected_Component,\n+                          N_Defining_Program_Unit_Name)\n+              and then\n+            Nkind_In (K2, N_Expanded_Name,\n+                          N_Selected_Component,\n+                          N_Defining_Program_Unit_Name)\n       then\n          return\n            (Chars (Select_Node (Name1)) = Chars (Select_Node (Name2)))"}, {"sha": "040a7d65d4e64ce642d8013a8d5de8b3db5f270a", "filename": "gcc/ada/sem_util.ads", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fsem_util.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3dfe4883e7b0dec116a927968f8fe60500f03c35/gcc%2Fada%2Fsem_util.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.ads?ref=3dfe4883e7b0dec116a927968f8fe60500f03c35", "patch": "@@ -504,7 +504,7 @@ package Sem_Util is\n    function Designate_Same_Unit\n      (Name1 : Node_Id;\n       Name2 : Node_Id) return  Boolean;\n-   --  Return true if Name1 and Name2 designate the same unit name; each of\n+   --  Returns True if Name1 and Name2 designate the same unit name; each of\n    --  these names is supposed to be a selected component name, an expanded\n    --  name, a defining program unit name or an identifier.\n "}]}