{"sha": "22f309bc29de788fc686f9f98b194996b109b218", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjJmMzA5YmMyOWRlNzg4ZmM2ODZmOWY5OGIxOTQ5OTZiMTA5YjIxOA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2018-12-04T19:28:27Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2018-12-04T19:28:27Z"}, "message": "PR c++/88184 - ICE when treating name as template-name.\n\n\t* pt.c (lookup_template_function): Always build the TEMPLATE_ID_EXPR\n\twith unknown_type_node.\n\n\t* g++.dg/cpp2a/fn-template17.C: New test.\n\t* g++.dg/cpp2a/fn-template18.C: New test.\n\nFrom-SVN: r266793", "tree": {"sha": "ae92c44804ef6e3454a3d4b9ac406f6df3bb129e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae92c44804ef6e3454a3d4b9ac406f6df3bb129e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/22f309bc29de788fc686f9f98b194996b109b218", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22f309bc29de788fc686f9f98b194996b109b218", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22f309bc29de788fc686f9f98b194996b109b218", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22f309bc29de788fc686f9f98b194996b109b218/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "de117207d722031db5db9a1efafcda900ea14f77", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de117207d722031db5db9a1efafcda900ea14f77", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de117207d722031db5db9a1efafcda900ea14f77"}], "stats": {"total": 64, "additions": 57, "deletions": 7}, "files": [{"sha": "d43d6132d3401b409cf5158f2a8fdbe83bc8c458", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=22f309bc29de788fc686f9f98b194996b109b218", "patch": "@@ -1,3 +1,9 @@\n+2018-12-04  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/88184 - ICE when treating name as template-name.\n+\t* pt.c (lookup_template_function): Always build the TEMPLATE_ID_EXPR\n+\twith unknown_type_node.\n+\n 2018-12-04  Julian Brown  <julian@codesourcery.com>\n \n \t* parser.c (cp_parser_oacc_wait_list): Fix error message and avoid"}, {"sha": "78addc6c1c2e2566d160e9cac3c4490860e2b8f9", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=22f309bc29de788fc686f9f98b194996b109b218", "patch": "@@ -9068,8 +9068,6 @@ add_pending_template (tree d)\n tree\n lookup_template_function (tree fns, tree arglist)\n {\n-  tree type;\n-\n   if (fns == error_mark_node || arglist == error_mark_node)\n     return error_mark_node;\n \n@@ -9090,11 +9088,7 @@ lookup_template_function (tree fns, tree arglist)\n       return fns;\n     }\n \n-  type = TREE_TYPE (fns);\n-  if (TREE_CODE (fns) == OVERLOAD || !type)\n-    type = unknown_type_node;\n-\n-  return build2 (TEMPLATE_ID_EXPR, type, fns, arglist);\n+  return build2 (TEMPLATE_ID_EXPR, unknown_type_node, fns, arglist);\n }\n \n /* Within the scope of a template class S<T>, the name S gets bound"}, {"sha": "887705e2503f499b45358397c225bc4863e83afe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=22f309bc29de788fc686f9f98b194996b109b218", "patch": "@@ -1,3 +1,9 @@\n+2018-12-04  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c++/88184 - ICE when treating name as template-name.\n+\t* g++.dg/cpp2a/fn-template17.C: New test.\n+\t* g++.dg/cpp2a/fn-template18.C: New test.\n+\n 2018-12-04  David Edelsohn  <dje.gcc@gmail.com>\n \n \t* gcc.dg/live-patching-2.c: Require LTO."}, {"sha": "f0d2410768263f7109f439640abaeca8d6f1028f", "filename": "gcc/testsuite/g++.dg/cpp2a/fn-template17.C", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Ffn-template17.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Ffn-template17.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Ffn-template17.C?ref=22f309bc29de788fc686f9f98b194996b109b218", "patch": "@@ -0,0 +1,21 @@\n+// PR c++/88184\n+// { dg-do compile }\n+// { dg-options \"-std=c++2a -fchecking=2\" }\n+\n+namespace A\n+{\n+  void f ();\n+}\n+\n+using A::f;\n+\n+template <typename T> void g ()\n+{\n+  f<T> (); // { dg-error \"no matching function for call\" }\n+}\n+\n+void\n+fn ()\n+{\n+  g<int>();\n+}"}, {"sha": "7fe5e89ace3e3cd34c5cef2e9b091fe308068609", "filename": "gcc/testsuite/g++.dg/cpp2a/fn-template18.C", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Ffn-template18.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/22f309bc29de788fc686f9f98b194996b109b218/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Ffn-template18.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp2a%2Ffn-template18.C?ref=22f309bc29de788fc686f9f98b194996b109b218", "patch": "@@ -0,0 +1,23 @@\n+// PR c++/88184\n+// { dg-do compile }\n+// { dg-options \"-std=c++2a -fchecking=2\" }\n+\n+namespace A\n+{\n+  void f ();\n+  void f (int);\n+  void f (int, int);\n+}\n+\n+using A::f;\n+\n+template <typename T> void g ()\n+{\n+  f<T> (); // { dg-error \"no matching function for call\" }\n+}\n+\n+void\n+fn ()\n+{\n+  g<int>();\n+}"}]}