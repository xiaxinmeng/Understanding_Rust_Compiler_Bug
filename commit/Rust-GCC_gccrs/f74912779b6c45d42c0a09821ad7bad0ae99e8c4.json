{"sha": "f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjc0OTEyNzc5YjZjNDVkNDJjMGEwOTgyMWFkN2JhZDBhZTk5ZThjNA==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2014-01-24T20:08:20Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2014-01-24T20:08:20Z"}, "message": "re PR libstdc++/59548 (Abort after copying std::unordered_map in debug mode)\n\n\tPR libstdc++/59548\n\t* include/debug/safe_base.h (_Safe_sequence_base): Define copy\n\tconstructor to prevent it being implicitly defined as deleted, but\n\tdo not copy anything.\n\t* include/debug/safe_unordered_base.h (_Safe_unordered_container_base):\n\tDefine copy and move constructors similar to _Safe_sequence_base's.\n\t* testsuite/23_containers/unordered_map/59548.cc: New.\n\nFrom-SVN: r207059", "tree": {"sha": "9d1ffb6717b8ccecd48672b9346daff8cbf42aaa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9d1ffb6717b8ccecd48672b9346daff8cbf42aaa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "233aedf4c30248e5504afca2e421e22c3b33c96c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/233aedf4c30248e5504afca2e421e22c3b33c96c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/233aedf4c30248e5504afca2e421e22c3b33c96c"}], "stats": {"total": 59, "additions": 58, "deletions": 1}, "files": [{"sha": "30e4f22b8c82ae67020a93db71a3dd1ff12ee751", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "patch": "@@ -1,3 +1,13 @@\n+2014-01-24  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/59548\n+\t* include/debug/safe_base.h (_Safe_sequence_base): Define copy\n+\tconstructor to prevent it being implicitly defined as deleted, but\n+\tdo not copy anything.\n+\t* include/debug/safe_unordered_base.h (_Safe_unordered_container_base):\n+\tDefine copy and move constructors similar to _Safe_sequence_base's.\n+\t* testsuite/23_containers/unordered_map/59548.cc: New.\n+\n 2014-01-23  Bernhard Reutner-Fischer  <aldot@gcc.gnu.org>\n \t    Steve Ellcey  <sellcey@mips.com>\n "}, {"sha": "631ac773ddb45048d2857c425ba2e689a93e24ae", "filename": "libstdc++-v3/include/debug/safe_base.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fsafe_base.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fsafe_base.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fsafe_base.h?ref=f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "patch": "@@ -193,6 +193,9 @@ namespace __gnu_debug\n     { }\n \n #if __cplusplus >= 201103L\n+    _Safe_sequence_base(const _Safe_sequence_base&) noexcept\n+      : _Safe_sequence_base() { }\n+\n     _Safe_sequence_base(_Safe_sequence_base&& __x) noexcept\n       : _Safe_sequence_base()\n     { _M_swap(__x); }"}, {"sha": "bbb274f34e4fae896c55cdf71c3fc2c0c6872080", "filename": "libstdc++-v3/include/debug/safe_unordered_base.h", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fsafe_unordered_base.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fsafe_unordered_base.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fdebug%2Fsafe_unordered_base.h?ref=f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "patch": "@@ -133,9 +133,19 @@ namespace __gnu_debug\n   protected:\n     // Initialize with a version number of 1 and no iterators\n     _Safe_unordered_container_base()\n-    : _M_local_iterators(0), _M_const_local_iterators(0)\n+    : _M_local_iterators(nullptr), _M_const_local_iterators(nullptr)\n     { }\n \n+    // Initialize with a version number of 1 and no iterators\n+    _Safe_unordered_container_base(const _Safe_unordered_container_base&)\n+    noexcept\n+    : _Safe_unordered_container_base() { }\n+\n+    _Safe_unordered_container_base(_Safe_unordered_container_base&& __x)\n+    noexcept\n+    : _Safe_unordered_container_base()\n+    { this->_M_swap(__x); }\n+\n     /** Notify all iterators that reference this container that the\n \tcontainer is being destroyed. */\n     ~_Safe_unordered_container_base()"}, {"sha": "1e81bb74110cc93a63c5fc91d8fa9f857b0aaf67", "filename": "libstdc++-v3/testsuite/23_containers/unordered_map/59548.cc", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_map%2F59548.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f74912779b6c45d42c0a09821ad7bad0ae99e8c4/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_map%2F59548.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F23_containers%2Funordered_map%2F59548.cc?ref=f74912779b6c45d42c0a09821ad7bad0ae99e8c4", "patch": "@@ -0,0 +1,34 @@\n+// { dg-options \"-std=gnu++11\" }\n+// { dg-do compile }\n+// { dg-require-debug-mode \"\" }\n+\n+// Copyright (C) 2014 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// libstdc++/59548\n+\n+#include <unordered_map>\n+\n+int main()\n+{\n+  std::unordered_map<int,int> foo{ {0,1} };\n+  auto i = foo.begin();\n+  {\n+    auto bar = foo;\n+  }\n+  return i->first;\n+}"}]}