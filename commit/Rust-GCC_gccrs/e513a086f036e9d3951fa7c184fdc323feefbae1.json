{"sha": "e513a086f036e9d3951fa7c184fdc323feefbae1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTUxM2EwODZmMDM2ZTlkMzk1MWZhN2MxODRmZGMzMjNmZWVmYmFlMQ==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2008-07-19T18:27:00Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2008-07-19T18:27:00Z"}, "message": "re PR fortran/36342 (Missing file name in compilation diagnostics of preprocessed fortran source)\n\n2008-07-19  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/36342\n        * scanner.c (load_file): Add argument to destinguish between\n        true filename and displayed filename.\n        (include_line,gfc_new_file): Adapt accordingly.\n\nFrom-SVN: r137985", "tree": {"sha": "a24c5d579b633edb0a84159e588ab12be43092d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a24c5d579b633edb0a84159e588ab12be43092d5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e513a086f036e9d3951fa7c184fdc323feefbae1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e513a086f036e9d3951fa7c184fdc323feefbae1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e513a086f036e9d3951fa7c184fdc323feefbae1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e513a086f036e9d3951fa7c184fdc323feefbae1/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "953316147f5c41b3a0822ca63b39ea4ce2d942cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/953316147f5c41b3a0822ca63b39ea4ce2d942cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/953316147f5c41b3a0822ca63b39ea4ce2d942cd"}], "stats": {"total": 24, "additions": 17, "deletions": 7}, "files": [{"sha": "dc592eda24bfefa2011c87764b1f71ea516dee35", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e513a086f036e9d3951fa7c184fdc323feefbae1/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e513a086f036e9d3951fa7c184fdc323feefbae1/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=e513a086f036e9d3951fa7c184fdc323feefbae1", "patch": "@@ -1,3 +1,10 @@\n+2008-07-19  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/36342\n+\t* scanner.c (load_file): Add argument to destinguish between\n+\ttrue filename and displayed filename.\n+\t(include_line,gfc_new_file): Adapt accordingly.\n+\n 2008-07-19  Tobias Burnus  <burnus@net-b.de>\n \n \t* check.c (gfc_check_cshift,gfc_check_eoshift,gfc_check_unpack): Add rank"}, {"sha": "3087c62e41b7fed395272f863c4cd04ffab2f7db", "filename": "gcc/fortran/scanner.c", "status": "modified", "additions": 10, "deletions": 7, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e513a086f036e9d3951fa7c184fdc323feefbae1/gcc%2Ffortran%2Fscanner.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e513a086f036e9d3951fa7c184fdc323feefbae1/gcc%2Ffortran%2Fscanner.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fscanner.c?ref=e513a086f036e9d3951fa7c184fdc323feefbae1", "patch": "@@ -1672,7 +1672,7 @@ preprocessor_line (gfc_char_t *c)\n }\n \n \n-static try load_file (const char *, bool);\n+static try load_file (const char *, const char *, bool);\n \n /* include_line()-- Checks a line buffer to see if it is an include\n    line.  If so, we call load_file() recursively to load the included\n@@ -1743,7 +1743,7 @@ include_line (gfc_char_t *line)\n \t\t   read by anything else.  */\n \n   filename = gfc_widechar_to_char (begin, -1);\n-  load_file (filename, false);\n+  load_file (filename, NULL, false);\n   gfc_free (filename);\n   return true;\n }\n@@ -1752,14 +1752,17 @@ include_line (gfc_char_t *line)\n /* Load a file into memory by calling load_line until the file ends.  */\n \n static try\n-load_file (const char *filename, bool initial)\n+load_file (const char *realfilename, const char *displayedname, bool initial)\n {\n   gfc_char_t *line;\n   gfc_linebuf *b;\n   gfc_file *f;\n   FILE *input;\n   int len, line_len;\n   bool first_line;\n+  const char *filename;\n+\n+  filename = displayedname ? displayedname : realfilename;\n \n   for (f = current_file; f; f = f->up)\n     if (strcmp (filename, f->filename) == 0)\n@@ -1776,7 +1779,7 @@ load_file (const char *filename, bool initial)\n \t  gfc_src_file = NULL;\n \t}\n       else\n-\tinput = gfc_open_file (filename);\n+\tinput = gfc_open_file (realfilename);\n       if (input == NULL)\n \t{\n \t  gfc_error_now (\"Can't open file '%s'\", filename);\n@@ -1785,7 +1788,7 @@ load_file (const char *filename, bool initial)\n     }\n   else\n     {\n-      input = gfc_open_included_file (filename, false, false);\n+      input = gfc_open_included_file (realfilename, false, false);\n       if (input == NULL)\n \t{\n \t  gfc_error_now (\"Can't open included file '%s'\", filename);\n@@ -1927,10 +1930,10 @@ gfc_new_file (void)\n     {\n       result = gfc_cpp_preprocess (gfc_source_file);\n       if (!gfc_cpp_preprocess_only ())\n-        result = load_file (gfc_cpp_temporary_file (), true);\n+        result = load_file (gfc_cpp_temporary_file (), gfc_source_file, true);\n     }\n   else\n-    result = load_file (gfc_source_file, true);\n+    result = load_file (gfc_source_file, NULL, true);\n \n   gfc_current_locus.lb = line_head;\n   gfc_current_locus.nextc = (line_head == NULL) ? NULL : line_head->line;"}]}