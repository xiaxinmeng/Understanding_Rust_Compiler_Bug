{"sha": "b6ab9ecd550227684643b41e9e33a4d3466724d8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjZhYjllY2Q1NTAyMjc2ODQ2NDNiNDFlOWUzM2E0ZDM0NjY3MjRkOA==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2020-06-15T13:31:26Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2020-06-15T13:31:26Z"}, "message": "libstdc++: Update value of __cpp_lib_constexpr_char_traits for C++20\n\nAlthough not required by SD-6 or the C++20 draft, we define the macro\n__cpp_lib_constexpr_char_traits to indicate support for P0432R1. This\nupdates the value in C++20 mode for the P1032R1 changes to char_traits.\n\n\t* include/bits/char_traits.h (__cpp_lib_constexpr_char_traits):\n\tUpdate value for C++20.\n\t* include/std/version (__cpp_lib_constexpr_char_traits): Likewise.\n\t* testsuite/21_strings/char_traits/requirements/constexpr_functions_c++17.cc:\n\tUpdate expected value.\n\t* testsuite/21_strings/char_traits/requirements/constexpr_functions_c++20.cc:\n\tLikewise.", "tree": {"sha": "869d4eb674c389edb6fad85d6e0b3b6bbda57394", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/869d4eb674c389edb6fad85d6e0b3b6bbda57394"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b6ab9ecd550227684643b41e9e33a4d3466724d8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6ab9ecd550227684643b41e9e33a4d3466724d8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b6ab9ecd550227684643b41e9e33a4d3466724d8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b6ab9ecd550227684643b41e9e33a4d3466724d8/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "eb11134d0c4e4db623aefe433c9613632ef8618e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eb11134d0c4e4db623aefe433c9613632ef8618e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eb11134d0c4e4db623aefe433c9613632ef8618e"}], "stats": {"total": 21, "additions": 16, "deletions": 5}, "files": [{"sha": "84c2d1b7ff2fedda0fe22a8746833bb0af0a07ae", "filename": "libstdc++-v3/include/bits/char_traits.h", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchar_traits.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchar_traits.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fchar_traits.h?ref=b6ab9ecd550227684643b41e9e33a4d3466724d8", "patch": "@@ -236,7 +236,14 @@ namespace std _GLIBCXX_VISIBILITY(default)\n _GLIBCXX_BEGIN_NAMESPACE_VERSION\n \n #if __cplusplus >= 201703L\n-#define __cpp_lib_constexpr_char_traits 201611\n+\n+#if __cplusplus == 201703L\n+// Unofficial macro indicating P0426R1 support\n+# define __cpp_lib_constexpr_char_traits 201611L\n+#else\n+// Also support P1032R1 in C++20\n+# define __cpp_lib_constexpr_char_traits 201811L\n+#endif\n \n   /**\n    *  @brief Determine whether the characters of a NULL-terminated"}, {"sha": "f64aff4f52016b1394c783da818a7eb114de426b", "filename": "libstdc++-v3/include/std/version", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fversion", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fversion", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fversion?ref=b6ab9ecd550227684643b41e9e33a4d3466724d8", "patch": "@@ -127,7 +127,7 @@\n #define __cpp_lib_boyer_moore_searcher 201603\n #define __cpp_lib_chrono 201611\n #define __cpp_lib_clamp 201603\n-#define __cpp_lib_constexpr_char_traits 201611\n+#define __cpp_lib_constexpr_char_traits 201611L\n #define __cpp_lib_enable_shared_from_this 201603\n #define __cpp_lib_execution 201902L // FIXME: should be 201603L\n #define __cpp_lib_filesystem 201703\n@@ -192,16 +192,18 @@\n \n #if _GLIBCXX_HOSTED\n #undef __cpp_lib_array_constexpr\n+#undef __cpp_lib_constexpr_char_traits\n #define __cpp_lib_array_constexpr 201811L\n #define __cpp_lib_assume_aligned 201811L\n #define __cpp_lib_bind_front 201907L\n // FIXME: #define __cpp_lib_execution 201902L\n #define __cpp_lib_integer_comparison_functions 202002L\n #define __cpp_lib_constexpr_algorithms 201806L\n+#define __cpp_lib_constexpr_char_traits 201811L\n #define __cpp_lib_constexpr_complex 201711L\n #define __cpp_lib_constexpr_dynamic_alloc 201907L\n #define __cpp_lib_constexpr_functional 201907L\n-# define __cpp_lib_constexpr_iterator 201811L\n+#define __cpp_lib_constexpr_iterator 201811L\n #define __cpp_lib_constexpr_memory 201811L\n #define __cpp_lib_constexpr_numeric 201911L\n #define __cpp_lib_constexpr_string_view 201811L"}, {"sha": "55dcba48db65475ee6b7f81dbb948085d0c261c3", "filename": "libstdc++-v3/testsuite/21_strings/char_traits/requirements/constexpr_functions_c++17.cc", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fchar_traits%2Frequirements%2Fconstexpr_functions_c%2B%2B17.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fchar_traits%2Frequirements%2Fconstexpr_functions_c%2B%2B17.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fchar_traits%2Frequirements%2Fconstexpr_functions_c%2B%2B17.cc?ref=b6ab9ecd550227684643b41e9e33a4d3466724d8", "patch": "@@ -75,8 +75,10 @@ template<typename CT>\n \n #ifndef __cpp_lib_constexpr_char_traits\n # error Feature-test macro for constexpr char_traits is missing\n-#elif __cpp_lib_constexpr_char_traits != 201611\n+#elif __cpp_lib_constexpr_char_traits < 201611\n # error Feature-test macro for constexpr char_traits has the wrong value\n+#elif __cpp_lib_constexpr_char_traits > 201611 && __cplusplus == 201703\n+# error Feature-test macro for constexpr char_traits has wrong value for C++17\n #endif\n \n static_assert( test_assign<std::char_traits<char>>() );"}, {"sha": "63c7c9cbb575f9217578ede19fb50ed819350d92", "filename": "libstdc++-v3/testsuite/21_strings/char_traits/requirements/constexpr_functions_c++20.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fchar_traits%2Frequirements%2Fconstexpr_functions_c%2B%2B20.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b6ab9ecd550227684643b41e9e33a4d3466724d8/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fchar_traits%2Frequirements%2Fconstexpr_functions_c%2B%2B20.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fchar_traits%2Frequirements%2Fconstexpr_functions_c%2B%2B20.cc?ref=b6ab9ecd550227684643b41e9e33a4d3466724d8", "patch": "@@ -32,7 +32,7 @@ template<typename CT>\n \n #ifndef __cpp_lib_constexpr_char_traits\n # error Feature-test macro for constexpr char_traits is missing\n-#elif __cpp_lib_constexpr_char_traits != 201611\n+#elif __cpp_lib_constexpr_char_traits != 201811\n # error Feature-test macro for constexpr char_traits has the wrong value\n #endif\n "}]}