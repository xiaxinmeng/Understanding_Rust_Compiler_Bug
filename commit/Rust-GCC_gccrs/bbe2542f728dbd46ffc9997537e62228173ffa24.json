{"sha": "bbe2542f728dbd46ffc9997537e62228173ffa24", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmJlMjU0MmY3MjhkYmQ0NmZmYzk5OTc1MzdlNjIyMjgxNzNmZmEyNA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2014-08-01T06:16:07Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2014-08-01T06:16:07Z"}, "message": "Don't run cproj-fails-with-broken-glibc for broken glibc\n\n2014-08-01  Tom de Vries  <tom@codesourcery.com>\n\n\t* lib/target-supports.exp (check_effective_target_glibc)\n\t(check_effective_target_glibc_2_12_or_later)\n\t(check_effective_target_not_glibc_2_11_or_earlier): New proc.\n\t* gcc.dg/cproj-fails-with-broken-glibc.c: Require effective target\n\tnot_glibc_2_11_or_earlier.\n\nFrom-SVN: r213403", "tree": {"sha": "3c8a69ed33bf1cb1e461031d831281b630a1e76b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3c8a69ed33bf1cb1e461031d831281b630a1e76b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bbe2542f728dbd46ffc9997537e62228173ffa24", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbe2542f728dbd46ffc9997537e62228173ffa24", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bbe2542f728dbd46ffc9997537e62228173ffa24", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bbe2542f728dbd46ffc9997537e62228173ffa24/comments", "author": null, "committer": null, "parents": [{"sha": "649aa8c1830b0ed5693922a575ecee7d3277e1b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/649aa8c1830b0ed5693922a575ecee7d3277e1b2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/649aa8c1830b0ed5693922a575ecee7d3277e1b2"}], "stats": {"total": 47, "additions": 47, "deletions": 0}, "files": [{"sha": "37b42b390063f1381b9ae42f3cf3618a2ea87075", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbe2542f728dbd46ffc9997537e62228173ffa24/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbe2542f728dbd46ffc9997537e62228173ffa24/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=bbe2542f728dbd46ffc9997537e62228173ffa24", "patch": "@@ -1,3 +1,11 @@\n+2014-08-01  Tom de Vries  <tom@codesourcery.com>\n+\n+\t* lib/target-supports.exp (check_effective_target_glibc)\n+\t(check_effective_target_glibc_2_12_or_later)\n+\t(check_effective_target_not_glibc_2_11_or_earlier): New proc.\n+\t* gcc.dg/cproj-fails-with-broken-glibc.c: Require effective target\n+\tnot_glibc_2_11_or_earlier.\n+\n 2014-07-31  Tom de Vries  <tom@codesourcery.com>\n \n \t* gcc.dg/pr51879-7.c: Remove superfluous declaration of bar."}, {"sha": "1df29f912fcef0324d5e914b0544e7f8a97ef69b", "filename": "gcc/testsuite/gcc.dg/cproj-fails-with-broken-glibc.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbe2542f728dbd46ffc9997537e62228173ffa24/gcc%2Ftestsuite%2Fgcc.dg%2Fcproj-fails-with-broken-glibc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbe2542f728dbd46ffc9997537e62228173ffa24/gcc%2Ftestsuite%2Fgcc.dg%2Fcproj-fails-with-broken-glibc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcproj-fails-with-broken-glibc.c?ref=bbe2542f728dbd46ffc9997537e62228173ffa24", "patch": "@@ -11,6 +11,7 @@\n /* { dg-options \"-fno-builtin-cproj\" } */\n /* { dg-add-options c99_runtime } */\n /* { dg-require-effective-target c99_runtime } */\n+/* { dg-require-effective-target not_glibc_2_11_or_earlier } */\n \n extern void abort(void);\n extern void exit(int);"}, {"sha": "cbe29307c28ae0f0aecc9f9a36e82a1b808a77f4", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 38, "deletions": 0, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bbe2542f728dbd46ffc9997537e62228173ffa24/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bbe2542f728dbd46ffc9997537e62228173ffa24/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=bbe2542f728dbd46ffc9997537e62228173ffa24", "patch": "@@ -5038,6 +5038,44 @@ proc check_effective_target_newlib {} {\n     }]\n }\n \n+# Return true if this is a glibc target.\n+\n+proc check_effective_target_glibc {} {\n+    return [check_no_compiler_messages glibc object {\n+\t#include <features.h>\n+\t#if !(defined (__GLIBC__) && defined (__GLIBC_MINOR__))\n+\t#error FOO\n+\t#endif\n+    }]\n+}\n+\n+# Return true if this is a glibc 2.12 or later target.\n+\n+proc check_effective_target_glibc_2_12_or_later {} {\n+    return [check_no_compiler_messages glibc_2_12_or_later object {\n+\t#include <features.h>\n+\t#if !(defined (__GLIBC__) && defined (__GLIBC_MINOR__) \\\n+              && __GLIBC_PREREQ(2,12))\n+\t#error FOO\n+\t#endif\n+    }]\n+}\n+\n+# Return true if this is a not a glibc 2.11 or earlier target.\n+\n+proc check_effective_target_not_glibc_2_11_or_earlier {} {\n+\n+    if { ![check_effective_target_glibc] } {\n+\treturn 1\n+    }\n+    \n+    if { [check_effective_target_glibc_2_12_or_later] } {\n+\treturn 1\n+    }\n+\n+    return 0\n+}\n+\n # Return true if this is NOT a Bionic target.\n \n proc check_effective_target_non_bionic {} {"}]}