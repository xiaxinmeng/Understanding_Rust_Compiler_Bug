{"sha": "ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWU2Yjg2NjZjOTU3ZWExNmJjNDRmZDRkNGQ0MjViMGRiOGQ2YmQ4NQ==", "commit": {"author": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2015-01-08T09:05:06Z"}, "committer": {"name": "Kaz Kojima", "email": "kkojima@gcc.gnu.org", "date": "2015-01-08T09:05:06Z"}, "message": "re PR target/64533 ([SH] alloca generates unsafe code)\n\nPR target/64533\n* config/sh/sh.md (*addsi3_compact): Use u constraint instead\nof r for the second alternative of the destination operand.\n\nFrom-SVN: r219338", "tree": {"sha": "23742a49cff41f90ee9cbce15326654149a49dbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/23742a49cff41f90ee9cbce15326654149a49dbf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85/comments", "author": null, "committer": null, "parents": [{"sha": "946695b779e0ca8c6cb9eabe109465b6c0b599a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/946695b779e0ca8c6cb9eabe109465b6c0b599a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/946695b779e0ca8c6cb9eabe109465b6c0b599a8"}], "stats": {"total": 11, "additions": 9, "deletions": 2}, "files": [{"sha": "55ffb7b7ad34ec42b9c65364b7be935dd5d88659", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "patch": "@@ -1,3 +1,9 @@\n+2015-01-08  Kaz Kojima  <kkojima@gcc.gnu.org>\n+\n+\tPR target/64533\n+\t* config/sh/sh.md (*addsi3_compact): Use u constraint instead\n+\tof r for the second alternative of the destination operand.\n+\n 2015-01-07  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \tPR target/36557"}, {"sha": "6e0b97f2fddde865b525a3874acb845419bfea84", "filename": "gcc/config/sh/sh.md", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85/gcc%2Fconfig%2Fsh%2Fsh.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85/gcc%2Fconfig%2Fsh%2Fsh.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fsh%2Fsh.md?ref=ae6b8666c957ea16bc44fd4d4d425b0db8d6bd85", "patch": "@@ -2061,9 +2061,10 @@\n ;; The problem is that LRA expects something like\n ;;    (set rA (plus rB (const_int N)))\n ;; to work.  We can do that, but we have to split out an additional reg-reg\n-;; copy before the actual add insn.\n+;; copy before the actual add insn.  Use u constraint for that case to avoid\n+;; the invalid value in the stack pointer.\n (define_insn_and_split \"*addsi3_compact\"\n-  [(set (match_operand:SI 0 \"arith_reg_dest\" \"=r,&r\")\n+  [(set (match_operand:SI 0 \"arith_reg_dest\" \"=r,&u\")\n \t(plus:SI (match_operand:SI 1 \"arith_operand\" \"%0,r\")\n \t\t (match_operand:SI 2 \"arith_or_int_operand\" \"rI08,rn\")))]\n   \"TARGET_SH1"}]}