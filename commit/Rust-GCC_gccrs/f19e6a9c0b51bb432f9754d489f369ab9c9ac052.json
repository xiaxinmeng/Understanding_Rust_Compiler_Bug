{"sha": "f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjE5ZTZhOWMwYjUxYmI0MzJmOTc1NGQ0ODlmMzY5YWI5YzlhYzA1Mg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-04-19T16:32:02Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-04-19T16:32:02Z"}, "message": "re PR debug/80461 (ICE in modified_type_die, at dwarf2out.c:12566)\n\n\tPR debug/80461\n\t* dwarf2out.c (modified_type_die, gen_type_die_with_usage):\n\tCheck for t with zero TYPE_QUALS_NO_ADDR_SPACE.\n\n\t* g++.dg/debug/pr80461.C: New test.\n\nFrom-SVN: r247002", "tree": {"sha": "f4d4845cd009ac8566bc78439f6aebb91075984a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f4d4845cd009ac8566bc78439f6aebb91075984a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "541035a63b8adc3900ca0d335382c2808228f191", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/541035a63b8adc3900ca0d335382c2808228f191", "html_url": "https://github.com/Rust-GCC/gccrs/commit/541035a63b8adc3900ca0d335382c2808228f191"}], "stats": {"total": 67, "additions": 59, "deletions": 8}, "files": [{"sha": "6b17e9a8b877501e66d651c45c6c8e7ded058915", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "patch": "@@ -1,5 +1,9 @@\n 2017-04-19  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/80461\n+\t* dwarf2out.c (modified_type_die, gen_type_die_with_usage):\n+\tCheck for t with zero TYPE_QUALS_NO_ADDR_SPACE.\n+\n \tPR debug/80436\n \t* tree-ssa-loop-manip.c (find_uses_to_rename_def): Ignore debug uses.\n "}, {"sha": "98c51576ec2ac43e6d5f13613ee2aa9713ba651a", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "patch": "@@ -12690,7 +12690,9 @@ modified_type_die (tree type, int cv_quals, bool reverse,\n \t     but try to canonicalize.  */\n \t  tree main = TYPE_MAIN_VARIANT (type);\n \t  for (tree t = main; t; t = TYPE_NEXT_VARIANT (t))\n-\t    if (check_base_type (t, main) && check_lang_type (t, type))\n+\t    if (TYPE_QUALS_NO_ADDR_SPACE (t) == 0\n+\t\t&& check_base_type (t, main)\n+\t\t&& check_lang_type (t, type))\n \t      return lookup_type_die (t);\n \t  return lookup_type_die (type);\n \t}\n@@ -24580,13 +24582,13 @@ gen_type_die_with_usage (tree type, dw_die_ref context_die,\n \t but try to canonicalize.  */\n       tree main = TYPE_MAIN_VARIANT (type);\n       for (tree t = main; t; t = TYPE_NEXT_VARIANT (t))\n-\t{\n-\t  if (check_base_type (t, main) && check_lang_type (t, type))\n-\t    {\n-\t      type = t;\n-\t      break;\n-\t    }\n-\t}\n+\tif (TYPE_QUALS_NO_ADDR_SPACE (t) == 0\n+\t    && check_base_type (t, main)\n+\t    && check_lang_type (t, type))\n+\t  {\n+\t    type = t;\n+\t    break;\n+\t  }\n     }\n   else if (TREE_CODE (type) != VECTOR_TYPE\n \t   && TREE_CODE (type) != ARRAY_TYPE)"}, {"sha": "048541d310740c359a4ee001372202037a828fdc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "patch": "@@ -1,5 +1,8 @@\n 2017-04-19  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/80461\n+\t* g++.dg/debug/pr80461.C: New test.\n+\n \tPR c++/80459\n \t* c-c++-common/opaque-vector.c (SIZEOF_MAXINT): Define.\n \t(f): Don't test long double vectors if __SIZEOF_LONG_DOUBLE__"}, {"sha": "df7b4229ddf36ae83ca7ad7c2cea924c1c4b6fe3", "filename": "gcc/testsuite/g++.dg/debug/pr80461.C", "status": "added", "additions": 42, "deletions": 0, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fpr80461.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f19e6a9c0b51bb432f9754d489f369ab9c9ac052/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fpr80461.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fdebug%2Fpr80461.C?ref=f19e6a9c0b51bb432f9754d489f369ab9c9ac052", "patch": "@@ -0,0 +1,42 @@\n+// PR debug/80461\n+// { dg-do compile }\n+// { dg-options \"-g -O\" }\n+\n+template <typename> class A;\n+struct B\n+{\n+  template <typename T, typename U>\n+  static bool foo (U T::*) {}\n+};\n+template <typename, typename> class J;\n+template <typename T, typename U, typename V, typename... W>\n+class J<V (W...), U T::*> : public J<void(), U T::*> {};\n+template <typename T, typename U, typename... W>\n+class J<void(W...), U T::*> : public B {};\n+template <typename V, typename... W> struct A<V (W...)>\n+{\n+  template <typename, typename> using K = int;\n+  template <typename L, typename = K<int, void>, typename = K<int, void>> A (L);\n+};\n+template <typename V, typename... W>\n+template <typename L, typename, typename>\n+A<V (W...)>::A (L x) { J<V (), L>::foo (x); }\n+struct N;\n+volatile int v;\n+\n+template <class O, class P>\n+void\n+bar ()\n+{\n+  O q;\n+  A<P> f = q;\n+  v++;\n+}\n+\n+void\n+baz ()\n+{\n+  bar<int (N::*) (...) &, int()> ();\n+  bar<int (N::*) (...) const &, int()> ();\n+  bar<int (N::*) (...) volatile &, int()> ();\n+}"}]}