{"sha": "639e8522c050cd9b814bc1a085f38b0418a8759a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjM5ZTg1MjJjMDUwY2Q5YjgxNGJjMWEwODVmMzhiMDQxOGE4NzU5YQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2018-03-13T08:03:28Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2018-03-13T08:03:28Z"}, "message": "re PR target/84786 ([miscompilation] vunpcklpd accessing xmm16-22 targeting KNL)\n\n\tPR target/84786\n\t* config/i386/sse.md (sse2_loadhpd): Use Yv constraint rather than v\n\ton the last operand.\n\n\t* gcc.target/i386/avx512f-pr84786-1.c: New test.\n\t* gcc.target/i386/avx512f-pr84786-2.c: New test.\n\nFrom-SVN: r258475", "tree": {"sha": "8860eca4d4a300d9932ddd494a2ec53b2dde432b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8860eca4d4a300d9932ddd494a2ec53b2dde432b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/639e8522c050cd9b814bc1a085f38b0418a8759a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/639e8522c050cd9b814bc1a085f38b0418a8759a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/639e8522c050cd9b814bc1a085f38b0418a8759a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/639e8522c050cd9b814bc1a085f38b0418a8759a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "1f4e9d223c77811423b292d7c5862b14153c366f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f4e9d223c77811423b292d7c5862b14153c366f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1f4e9d223c77811423b292d7c5862b14153c366f"}], "stats": {"total": 55, "additions": 52, "deletions": 3}, "files": [{"sha": "1bbeaff0c447cb81696f10470dbfa859bca4390a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=639e8522c050cd9b814bc1a085f38b0418a8759a", "patch": "@@ -1,5 +1,9 @@\n 2018-03-13  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR target/84786\n+\t* config/i386/sse.md (sse2_loadhpd): Use Yv constraint rather than v\n+\ton the last operand.\n+\n \tPR c++/84704\n \t* tree.c (stabilize_reference_1): Return save_expr (e) for\n \tSTATEMENT_LIST even if it doesn't have side-effects."}, {"sha": "bd287322252097c32be391f5bf40259bfdbc9613", "filename": "gcc/config/i386/sse.md", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Fconfig%2Fi386%2Fsse.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Fconfig%2Fi386%2Fsse.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fsse.md?ref=639e8522c050cd9b814bc1a085f38b0418a8759a", "patch": "@@ -9022,14 +9022,14 @@\n ;; see comment above inline_secondary_memory_needed function in i386.c\n (define_insn \"sse2_loadhpd\"\n   [(set (match_operand:V2DF 0 \"nonimmediate_operand\"\n-\t  \"=x,v,x,v,o,o ,o\")\n+\t  \"=x,v,x,v ,o,o ,o\")\n \t(vec_concat:V2DF\n \t  (vec_select:DF\n \t    (match_operand:V2DF 1 \"nonimmediate_operand\"\n-\t  \" 0,v,0,v,0,0 ,0\")\n+\t  \" 0,v,0,v ,0,0 ,0\")\n \t    (parallel [(const_int 0)]))\n \t  (match_operand:DF 2 \"nonimmediate_operand\"\n-\t  \" m,m,x,v,x,*f,r\")))]\n+\t  \" m,m,x,Yv,x,*f,r\")))]\n   \"TARGET_SSE2 && !(MEM_P (operands[1]) && MEM_P (operands[2]))\"\n   \"@\n    movhpd\\t{%2, %0|%0, %2}"}, {"sha": "faa6e338d309cbf3163da5262bd677fe7ed18e8e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=639e8522c050cd9b814bc1a085f38b0418a8759a", "patch": "@@ -1,5 +1,9 @@\n 2018-03-13  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR target/84786\n+\t* gcc.target/i386/avx512f-pr84786-1.c: New test.\n+\t* gcc.target/i386/avx512f-pr84786-2.c: New test.\n+\n \tPR c++/84808\n \t* g++.dg/cpp1y/constexpr-84808.C: New test.\n "}, {"sha": "d20a672593826dc3dcb672171659716b9ae4067f", "filename": "gcc/testsuite/gcc.target/i386/avx512f-pr84786-1.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr84786-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr84786-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr84786-1.c?ref=639e8522c050cd9b814bc1a085f38b0418a8759a", "patch": "@@ -0,0 +1,25 @@\n+/* PR target/84786 */\n+/* { dg-do run { target { ! ia32 } } } */\n+/* { dg-options \"-mavx512f -mno-avx512vl -O2\" } */\n+/* { dg-require-effective-target avx512f } */\n+\n+#include \"avx512f-check.h\"\n+\n+typedef double V __attribute__((vector_size (16)));\n+\n+__attribute__((noipa)) V\n+foo (V x, double y)\n+{\n+  register double z __asm (\"xmm18\");\n+  asm volatile (\"\" : \"=v\" (z) : \"0\" (y));\n+  x[1] = z;\n+  return x;\n+}\n+\n+static void\n+avx512f_test (void)\n+{\n+  V a = foo ((V) { 1.0, 2.0 }, 3.0);\n+  if (a[0] != 1.0 || a[1] != 3.0)\n+    abort ();\n+}"}, {"sha": "1e6e5b19fc76d895fd00bb921d461f696c1a59f0", "filename": "gcc/testsuite/gcc.target/i386/avx512f-pr84786-2.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr84786-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/639e8522c050cd9b814bc1a085f38b0418a8759a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr84786-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Favx512f-pr84786-2.c?ref=639e8522c050cd9b814bc1a085f38b0418a8759a", "patch": "@@ -0,0 +1,16 @@\n+/* PR target/84786 */\n+/* { dg-do compile { target { ! ia32 } } } */\n+/* { dg-options \"-mavx512f -mno-avx512vl -O2\" } */\n+\n+typedef double V __attribute__((vector_size (16)));\n+\n+__attribute__((noipa)) V\n+foo (V x, double y)\n+{\n+  register double z __asm (\"xmm18\");\n+  asm volatile (\"\" : \"=v\" (z) : \"0\" (y));\n+  x[1] = z;\n+  return x;\n+}\n+\n+/* { dg-final { scan-assembler-not \"vunpcklpd\\[\\^\\n\\r]*xmm(1\\[6-9]|\\[23]\\[0-9])\" } } */"}]}