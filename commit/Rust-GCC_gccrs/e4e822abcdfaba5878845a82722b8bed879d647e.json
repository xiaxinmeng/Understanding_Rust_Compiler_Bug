{"sha": "e4e822abcdfaba5878845a82722b8bed879d647e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTRlODIyYWJjZGZhYmE1ODc4ODQ1YTgyNzIyYjhiZWQ4NzlkNjQ3ZQ==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2017-07-16T16:28:57Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2017-07-16T16:28:57Z"}, "message": "asan.c (create_cond_insert_point): Avoid use of REG_BR_PROB_BASE fixpoint arithmetics.\n\n\t* asan.c (create_cond_insert_point): Avoid use of REG_BR_PROB_BASE\n\tfixpoint arithmetics.\n\nFrom-SVN: r250240", "tree": {"sha": "69e818d236239a41c91720468efd0966c3674321", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/69e818d236239a41c91720468efd0966c3674321"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4e822abcdfaba5878845a82722b8bed879d647e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4e822abcdfaba5878845a82722b8bed879d647e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4e822abcdfaba5878845a82722b8bed879d647e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4e822abcdfaba5878845a82722b8bed879d647e/comments", "author": null, "committer": null, "parents": [{"sha": "5fa396ad6cd48bc44e6754096fe71febc2a77983", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5fa396ad6cd48bc44e6754096fe71febc2a77983", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5fa396ad6cd48bc44e6754096fe71febc2a77983"}], "stats": {"total": 17, "additions": 10, "deletions": 7}, "files": [{"sha": "f17ed1fe91d51cb7128747174eac500792970cc2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4e822abcdfaba5878845a82722b8bed879d647e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4e822abcdfaba5878845a82722b8bed879d647e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e4e822abcdfaba5878845a82722b8bed879d647e", "patch": "@@ -1,3 +1,8 @@\n+2017-07-16  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\t* asan.c (create_cond_insert_point): Avoid use of REG_BR_PROB_BASE\n+\tfixpoint arithmetics.\n+\n 2017-07-16  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* profile-count.h (profile_probability::from_reg_br_prob_note,"}, {"sha": "5f9275f6425a1c29b11b2873edd599716c61f7dc", "filename": "gcc/asan.c", "status": "modified", "additions": 5, "deletions": 7, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4e822abcdfaba5878845a82722b8bed879d647e/gcc%2Fasan.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4e822abcdfaba5878845a82722b8bed879d647e/gcc%2Fasan.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fasan.c?ref=e4e822abcdfaba5878845a82722b8bed879d647e", "patch": "@@ -1798,21 +1798,19 @@ create_cond_insert_point (gimple_stmt_iterator *iter,\n \n   /* Set up the newly created 'then block'.  */\n   e = make_edge (cond_bb, then_bb, EDGE_TRUE_VALUE);\n-  int fallthrough_probability\n+  profile_probability fallthrough_probability\n     = then_more_likely_p\n-    ? PROB_VERY_UNLIKELY\n-    : PROB_ALWAYS - PROB_VERY_UNLIKELY;\n-  e->probability = profile_probability::from_reg_br_prob_base\n-\t\t(PROB_ALWAYS - fallthrough_probability);\n+    ? profile_probability::very_unlikely ()\n+    : profile_probability::very_likely ();\n+  e->probability = fallthrough_probability.invert ();\n   if (create_then_fallthru_edge)\n     make_single_succ_edge (then_bb, fallthru_bb, EDGE_FALLTHRU);\n \n   /* Set up the fallthrough basic block.  */\n   e = find_edge (cond_bb, fallthru_bb);\n   e->flags = EDGE_FALSE_VALUE;\n   e->count = cond_bb->count;\n-  e->probability\n-\t = profile_probability::from_reg_br_prob_base (fallthrough_probability);\n+  e->probability = fallthrough_probability;\n \n   /* Update dominance info for the newly created then_bb; note that\n      fallthru_bb's dominance info has already been updated by"}]}