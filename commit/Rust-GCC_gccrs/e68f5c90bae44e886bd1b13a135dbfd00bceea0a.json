{"sha": "e68f5c90bae44e886bd1b13a135dbfd00bceea0a", "node_id": "C_kwDOANBUbNoAKGU2OGY1YzkwYmFlNDRlODg2YmQxYjEzYTEzNWRiZmQwMGJjZWVhMGE", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-04-05T07:51:32Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2022-04-05T07:54:46Z"}, "message": "c/105151 - move early walloca pass\n\nWhen the walloca pass gained support for ranger the early pass\nwas not moved to a place where SSA form is available but remained\nin the lowering pipeline.  For the testcase in this bug this is\na problem because for errorneous input we still run the lowering\npipeline but here have broken SSA form which ranger does not like.\nThe solution is to rectify the mistake with using ranger without\nSSA form and move the pass which solves both issues.\n\n2022-04-05  Richard Biener  <rguenther@suse.de>\n\n\tPR c/105151\n\t* passes.def (pass_walloca): Move early instance into\n\tpass_build_ssa_passes to make SSA form available.\n\n\t* gcc.dg/gimplefe-error-14.c: New testcase.", "tree": {"sha": "b8f7bacc12e0f609e27f4ace51990b4ff3016389", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8f7bacc12e0f609e27f4ace51990b4ff3016389"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e68f5c90bae44e886bd1b13a135dbfd00bceea0a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e68f5c90bae44e886bd1b13a135dbfd00bceea0a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e68f5c90bae44e886bd1b13a135dbfd00bceea0a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e68f5c90bae44e886bd1b13a135dbfd00bceea0a/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2874772c4b597daa66ace0ef28b401d597307a03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2874772c4b597daa66ace0ef28b401d597307a03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2874772c4b597daa66ace0ef28b401d597307a03"}], "stats": {"total": 10, "additions": 9, "deletions": 1}, "files": [{"sha": "375d3d62d519329d62b4ba0ccd994503ac14710b", "filename": "gcc/passes.def", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e68f5c90bae44e886bd1b13a135dbfd00bceea0a/gcc%2Fpasses.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e68f5c90bae44e886bd1b13a135dbfd00bceea0a/gcc%2Fpasses.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fpasses.def?ref=e68f5c90bae44e886bd1b13a135dbfd00bceea0a", "patch": "@@ -45,7 +45,6 @@ along with GCC; see the file COPYING3.  If not see\n   NEXT_PASS (pass_warn_function_return);\n   NEXT_PASS (pass_coroutine_early_expand_ifns);\n   NEXT_PASS (pass_expand_omp);\n-  NEXT_PASS (pass_walloca, /*strict_mode_p=*/true);\n   NEXT_PASS (pass_build_cgraph_edges);\n   TERMINATE_PASS_LIST (all_lowering_passes)\n \n@@ -57,6 +56,7 @@ along with GCC; see the file COPYING3.  If not see\n   PUSH_INSERT_PASSES_WITHIN (pass_build_ssa_passes)\n       NEXT_PASS (pass_fixup_cfg);\n       NEXT_PASS (pass_build_ssa);\n+      NEXT_PASS (pass_walloca, /*strict_mode_p=*/true);\n       NEXT_PASS (pass_warn_printf);\n       NEXT_PASS (pass_warn_nonnull_compare);\n       NEXT_PASS (pass_early_warn_uninitialized);"}, {"sha": "3e1a13219b17f337f2440265a2162056d92798d6", "filename": "gcc/testsuite/gcc.dg/gimplefe-error-14.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e68f5c90bae44e886bd1b13a135dbfd00bceea0a/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-error-14.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e68f5c90bae44e886bd1b13a135dbfd00bceea0a/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-error-14.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-error-14.c?ref=e68f5c90bae44e886bd1b13a135dbfd00bceea0a", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-fgimple\" } */\n+\n+int __GIMPLE () foo ()\n+{\n+  int _1;\n+  return a_1(D);  /* { dg-error \"cannot have default definition\" } */\n+}"}]}