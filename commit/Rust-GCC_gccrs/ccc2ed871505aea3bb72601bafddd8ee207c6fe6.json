{"sha": "ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2NjMmVkODcxNTA1YWVhM2JiNzI2MDFiYWZkZGQ4ZWUyMDdjNmZlNg==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2008-04-25T21:14:49Z"}, "committer": {"name": "Daniel Franke", "email": "dfranke@gcc.gnu.org", "date": "2008-04-25T21:14:49Z"}, "message": "re PR fortran/35156 ([patch] Deprecate -M<dir>)\n\n2008-04-25  Tobias Burnus  <burnus@net-b.de>\n            Daniel Franke <franke.daniel@gmail.com>\n\n\tPR fortran/35156\n        * gfortranspec.c (lang_specific_driver): Deprecate\n        -M option; fix ICE when \"-M\" is last argument and\n        make \"-M<dir>\" work.\n        * options.c (gfc_handle_module_path_options):\n        Use -J instead of -M in error messages.\n        * invoke.texi: Mark -M as depecated.\n\n\nCo-Authored-By: Daniel Franke <franke.daniel@gmail.com>\n\nFrom-SVN: r134680", "tree": {"sha": "ab0258ef4021fd15bb79fb4dc786a3244d298772", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab0258ef4021fd15bb79fb4dc786a3244d298772"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9ae83b845687ff04cd89613745214f43b6700626", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ae83b845687ff04cd89613745214f43b6700626", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ae83b845687ff04cd89613745214f43b6700626"}], "stats": {"total": 49, "additions": 32, "deletions": 17}, "files": [{"sha": "b469063990e32ee83ebb389c131516d4454ea84b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "patch": "@@ -1,3 +1,14 @@\n+2008-04-25  Tobias Burnus  <burnus@net-b.de>\n+\t    Daniel Franke <franke.daniel@gmail.com>\n+\n+\tPR fortran/35156\n+\t* gfortranspec.c (lang_specific_driver): Deprecate\n+\t-M option; fix ICE when \"-M\" is last argument and\n+\tmake \"-M<dir>\" work.\n+\t* options.c (gfc_handle_module_path_options): \n+\tUse -J instead of -M in error messages.\n+\t* invoke.texi: Mark -M as depecated.\n+\n 2008-04-23  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \t    Francois-Xavier Coudert  <fxcoudert@gcc.gnu.org>\n "}, {"sha": "4a7d02f11ebfd215cfc8877cf7cf14e36fe032a1", "filename": "gcc/fortran/gfortranspec.c", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2Fgfortranspec.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2Fgfortranspec.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fgfortranspec.c?ref=ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "patch": "@@ -429,18 +429,27 @@ For more information about these matters, see the file named COPYING\\n\\n\"));\n \t{\n \t  char *p;\n \n+\t  fprintf (stderr, _(\"Warning: Using -M <directory> is deprecated, \"\n+\t           \"use -J instead\\n\"));\n \t  if (argv[i][2] == '\\0')\n \t    {\n-\t      p = XNEWVEC (char, strlen (argv[i + 1]) + 2);\n-\t      p[0] = '-';\n-\t      p[1] = 'J';\n-\t      strcpy (&p[2], argv[i + 1]);\n-\t      i++;\n+\t      if (i+1 < argc)\n+\t\t{\n+\t\t  p = XNEWVEC (char, strlen (argv[i + 1]) + 3);\n+\t\t  p[0] = '-';\n+\t\t  p[1] = 'J';\n+\t\t  strcpy (&p[2], argv[i + 1]);\n+\t\t  i++;\n+\t\t}\n+\t      else\n+\t\tfatal (\"argument to '%s' missing\", argv[i]);\n \t    }\n \t  else\n \t    {\n \t      p = XNEWVEC (char, strlen (argv[i]) + 1);\n-\t      strcpy (p, argv[i]);\n+\t      p[0] = '-';\n+\t      p[1] = 'J';\n+\t      strcpy (&p[2], argv[i] + 2);\n \t    }\n \t  append_arg (p);\n \t  continue;"}, {"sha": "712aa2140c31e9d4fdc1614528697ae51e0f27d8", "filename": "gcc/fortran/invoke.texi", "status": "modified", "additions": 3, "deletions": 4, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finvoke.texi?ref=ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "patch": "@@ -633,10 +633,10 @@ compiled modules are required by a @code{USE} statement.\n gcc,Using the GNU Compiler Collection (GCC)}, for information on the\n @option{-I} option.\n \n-@item -M@var{dir}\n @item -J@var{dir}\n-@opindex @code{M}@var{dir}\n+@item -M@var{dir}\n @opindex @code{J}@var{dir}\n+@opindex @code{M}@var{dir}\n @cindex paths, search\n @cindex module search path\n This option specifies where to put @file{.mod} files for compiled modules.\n@@ -645,8 +645,7 @@ statement.\n \n The default is the current directory.\n \n-@option{-J} is an alias for @option{-M} to avoid conflicts with existing\n-GCC options.\n+@option{-M} is deprecated to avoid conflicts with existing GCC options.\n \n @item -fintrinsic-modules-path @var{dir}\n @opindex @code{fintrinsic-modules-path} @var{dir}"}, {"sha": "a1020bf35d48bdac970157d63c4eb0c499f1dc44", "filename": "gcc/fortran/options.c", "status": "modified", "additions": 3, "deletions": 7, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2Foptions.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ccc2ed871505aea3bb72601bafddd8ee207c6fe6/gcc%2Ffortran%2Foptions.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Foptions.c?ref=ccc2ed871505aea3bb72601bafddd8ee207c6fe6", "patch": "@@ -391,10 +391,7 @@ gfc_handle_module_path_options (const char *arg)\n {\n \n   if (gfc_option.module_dir != NULL)\n-    gfc_fatal_error (\"gfortran: Only one -M option allowed\");\n-\n-  if (arg == NULL)\n-    gfc_fatal_error (\"gfortran: Directory required after -M\");\n+    gfc_fatal_error (\"gfortran: Only one -J option allowed\");\n \n   gfc_option.module_dir = (char *) gfc_getmem (strlen (arg) + 2);\n   strcpy (gfc_option.module_dir, arg);\n@@ -718,14 +715,13 @@ gfc_handle_option (size_t scode, const char *arg, int value)\n       break;\n \n     case OPT_J:\n-    case OPT_M:\n       gfc_handle_module_path_options (arg);\n       break;\n-    \n+\n     case OPT_fsign_zero:\n       gfc_option.flag_sign_zero = value;\n       break;\n-    \n+\n     case OPT_ffpe_trap_:\n       gfc_handle_fpe_trap_option (arg);\n       break;"}]}