{"sha": "3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2E2MGYzMmJkZWU0M2RjYWRhYzIxZjRlNTFjZTBjNDNkN2FhODRhMw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2013-05-13T07:46:53Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2013-05-13T07:46:53Z"}, "message": "re PR tree-optimization/57230 (tree-ssa-strlen incorrectly optimizes a strlen to 0)\n\n\tPR tree-optimization/57230\n\t* tree-ssa-strlen.c (handle_char_store): Add missing integer_zerop\n\tcheck.\n\n\t* gcc.dg/strlenopt-23.c: New test.\n\nFrom-SVN: r198813", "tree": {"sha": "cae85acf0ab04899986e663a8d8d8a547e8e19d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cae85acf0ab04899986e663a8d8d8a547e8e19d7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2710a27af098557e37d3d131fa5a43dbfddab408", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2710a27af098557e37d3d131fa5a43dbfddab408", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2710a27af098557e37d3d131fa5a43dbfddab408"}], "stats": {"total": 28, "additions": 27, "deletions": 1}, "files": [{"sha": "2d1bbeaeb3a7604a2219accb429dc746b1cc01fd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "patch": "@@ -1,3 +1,9 @@\n+2013-05-13  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/57230\n+\t* tree-ssa-strlen.c (handle_char_store): Add missing integer_zerop\n+\tcheck.\n+\n 2013-05-12  Joern Rennecke  <joern.rennecke@embecosm.com>\n \n \t* config/epiphany/epiphany.c (epiphany_init): Check size of"}, {"sha": "52ccf1a2653c990cb0faa5a4f166b7260536531f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "patch": "@@ -1,3 +1,8 @@\n+2013-05-13  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR tree-optimization/57230\n+\t* gcc.dg/strlenopt-23.c: New test.\n+\n 2013-05-12  Oleg Endo  <olegendo@gcc.gnu.org>\n \n \tPR target/57108"}, {"sha": "75dab2ae0bb91aa508dd051a21a33192331f1d94", "filename": "gcc/testsuite/gcc.dg/strlenopt-23.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2Ftestsuite%2Fgcc.dg%2Fstrlenopt-23.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2Ftestsuite%2Fgcc.dg%2Fstrlenopt-23.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fstrlenopt-23.c?ref=3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "patch": "@@ -0,0 +1,15 @@\n+/* PR tree-optimization/57230 */\n+/* { dg-do run } */\n+/* { dg-options \"-O2\" } */\n+\n+#include \"strlenopt.h\"\n+\n+int\n+main ()\n+{\n+  char p[] = \"hello world\";\n+  p[0] = (char) (strlen (p) - 1);\n+  if (strlen (p) != 11)\n+    abort ();\n+  return 0;\n+}"}, {"sha": "4b6cfda5db2adc5c733b3d57087cac90fc91a758", "filename": "gcc/tree-ssa-strlen.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2Ftree-ssa-strlen.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3/gcc%2Ftree-ssa-strlen.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-strlen.c?ref=3a60f32bdee43dcadac21f4e51ce0c43d7aa84a3", "patch": "@@ -1703,7 +1703,7 @@ handle_char_store (gimple_stmt_iterator *gsi)\n \t       its length may be decreased.  */\n \t    adjust_last_stmt (si, stmt, false);\n \t}\n-      else if (si != NULL)\n+      else if (si != NULL && integer_zerop (gimple_assign_rhs1 (stmt)))\n \t{\n \t  si = unshare_strinfo (si);\n \t  si->length = build_int_cst (size_type_node, 0);"}]}