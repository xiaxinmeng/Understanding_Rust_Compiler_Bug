{"sha": "a046033ea0ba97314265933bc48124574db2d62a", "node_id": "C_kwDOANBUbNoAKGEwNDYwMzNlYTBiYTk3MzE0MjY1OTMzYmM0ODEyNDU3NGRiMmQ2MmE", "commit": {"author": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2022-02-23T14:58:59Z"}, "committer": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2022-02-24T08:19:01Z"}, "message": "[nvptx] Add missing t-omp-device isas\n\nIn t-omp-device we list isas that can be used in omp declare variant like so:\n...\n  #pragma omp declare variant (f30) match (device={isa(\"sm_30\")})\n...\nand in nvptx_omp_device_kind_arch_isa we handle them.\n\nUpdate both to reflect the current list of isas.\n\nTested on x86_64-linux with nvptx accelerator.\n\ngcc/ChangeLog:\n\n2022-02-23  Tom de Vries  <tdevries@suse.de>\n\n\t* config/nvptx/nvptx.cc (nvptx_omp_device_kind_arch_isa): Handle\n\tsm_70, sm_75 and sm_80.\n\t* config/nvptx/t-omp-device: Add sm_53, sm_70, sm_75 and sm_80.\n\nCo-Authored-By: Tobias Burnus <tobias@codesourcery.com>", "tree": {"sha": "5eea8b54941ff62e333d1f88fb20e69981842d15", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5eea8b54941ff62e333d1f88fb20e69981842d15"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a046033ea0ba97314265933bc48124574db2d62a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a046033ea0ba97314265933bc48124574db2d62a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a046033ea0ba97314265933bc48124574db2d62a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a046033ea0ba97314265933bc48124574db2d62a/comments", "author": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "committer": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c982d02ffe26fcd07280bf0f35f90df9be00716e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c982d02ffe26fcd07280bf0f35f90df9be00716e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c982d02ffe26fcd07280bf0f35f90df9be00716e"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "b9451c2ed0905ad91f6c7e15b432147b78054fbd", "filename": "gcc/config/nvptx/nvptx.cc", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a046033ea0ba97314265933bc48124574db2d62a/gcc%2Fconfig%2Fnvptx%2Fnvptx.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a046033ea0ba97314265933bc48124574db2d62a/gcc%2Fconfig%2Fnvptx%2Fnvptx.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnvptx%2Fnvptx.cc?ref=a046033ea0ba97314265933bc48124574db2d62a", "patch": "@@ -6181,7 +6181,13 @@ nvptx_omp_device_kind_arch_isa (enum omp_device_kind_arch_isa trait,\n       if (strcmp (name, \"sm_35\") == 0)\n \treturn TARGET_SM35 && !TARGET_SM53;\n       if (strcmp (name, \"sm_53\") == 0)\n-\treturn TARGET_SM53;\n+\treturn TARGET_SM53 && !TARGET_SM70;\n+      if (strcmp (name, \"sm_70\") == 0)\n+\treturn TARGET_SM70 && !TARGET_SM75;\n+      if (strcmp (name, \"sm_75\") == 0)\n+\treturn TARGET_SM75 && !TARGET_SM80;\n+      if (strcmp (name, \"sm_80\") == 0)\n+\treturn TARGET_SM80;\n       return 0;\n     default:\n       gcc_unreachable ();"}, {"sha": "4228218a42480e4eb75230e428923cae5c18e482", "filename": "gcc/config/nvptx/t-omp-device", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a046033ea0ba97314265933bc48124574db2d62a/gcc%2Fconfig%2Fnvptx%2Ft-omp-device", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a046033ea0ba97314265933bc48124574db2d62a/gcc%2Fconfig%2Fnvptx%2Ft-omp-device", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fnvptx%2Ft-omp-device?ref=a046033ea0ba97314265933bc48124574db2d62a", "patch": "@@ -1,4 +1,4 @@\n omp-device-properties-nvptx: $(srcdir)/config/nvptx/nvptx.cc\n \techo kind: gpu > $@\n \techo arch: nvptx >> $@\n-\techo isa: sm_30 sm_35 >> $@\n+\techo isa: sm_30 sm_35 sm_53 sm_70 sm_75 sm_80 >> $@"}]}