{"sha": "f75036994f9d6945265d02cb29de502d6d7d538d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Zjc1MDM2OTk0ZjlkNjk0NTI2NWQwMmNiMjlkZTUwMmQ2ZDdkNTM4ZA==", "commit": {"author": {"name": "Kugan Vivekanandarajah", "email": "kuganv@linaro.org", "date": "2016-10-21T20:13:55Z"}, "committer": {"name": "Kugan Vivekanandarajah", "email": "kugan@gcc.gnu.org", "date": "2016-10-21T20:13:55Z"}, "message": "ADDR_EXPR and nonnull\n\nADDR_EXPR and nonnull\ngcc/ChangeLog:\n\n2016-10-21  Kugan Vivekanandarajah  <kuganv@linaro.org>\n\n\t* ipa-prop.c (ipa_compute_jump_functions_for_edge): Create nonzero\n\tvalue range for pointers in more cases.\n\ngcc/testsuite/ChangeLog:\n\n2016-10-21  Kugan Vivekanandarajah  <kuganv@linaro.org>\n\n\t* gcc.dg/ipa/vrp5.c: New test.\n\t* gcc.dg/ipa/vrp6.c: New test.\n\nFrom-SVN: r241428", "tree": {"sha": "cb421f8cf6590fce9a7ae6c57b2f3ba94212cd4b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cb421f8cf6590fce9a7ae6c57b2f3ba94212cd4b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f75036994f9d6945265d02cb29de502d6d7d538d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f75036994f9d6945265d02cb29de502d6d7d538d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f75036994f9d6945265d02cb29de502d6d7d538d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f75036994f9d6945265d02cb29de502d6d7d538d/comments", "author": null, "committer": null, "parents": [{"sha": "e597e0533d69081e6d6b01ca19f2924c1b8307ff", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e597e0533d69081e6d6b01ca19f2924c1b8307ff", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e597e0533d69081e6d6b01ca19f2924c1b8307ff"}], "stats": {"total": 86, "additions": 86, "deletions": 0}, "files": [{"sha": "fd28129e448c5c2b0aa1ae4bad455b6f238eb7d3", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f75036994f9d6945265d02cb29de502d6d7d538d", "patch": "@@ -1,3 +1,8 @@\n+2016-10-21  Kugan Vivekanandarajah  <kuganv@linaro.org>\n+\n+\t* ipa-prop.c (ipa_compute_jump_functions_for_edge): Create nonzero\n+\tvalue range for pointers in more cases.\n+\n 2016-10-21  Wilco Dijkstra  <wdijkstr@arm.com>\n \n \t* config/aarch64/aarch64.c (aarch64_add_constant_internal):"}, {"sha": "16298703fa695e5efc84f45aa5f3d6c1719ec1e9", "filename": "gcc/ipa-prop.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Fipa-prop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Fipa-prop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-prop.c?ref=f75036994f9d6945265d02cb29de502d6d7d538d", "patch": "@@ -1670,9 +1670,17 @@ ipa_compute_jump_functions_for_edge (struct ipa_func_body_info *fbi,\n \n       if (POINTER_TYPE_P (TREE_TYPE (arg)))\n \t{\n+\t  bool addr_nonzero = false;\n+\t  bool strict_overflow = false;\n+\n \t  if (TREE_CODE (arg) == SSA_NAME\n \t      && param_type\n \t      && get_ptr_nonnull (arg))\n+\t    addr_nonzero = true;\n+\t  else if (tree_single_nonzero_warnv_p (arg, &strict_overflow))\n+\t    addr_nonzero = true;\n+\n+\t  if (addr_nonzero)\n \t    {\n \t      jfunc->vr_known = true;\n \t      jfunc->m_vr.type = VR_ANTI_RANGE;"}, {"sha": "62aa521b596e7044c714bec7da2d8b2819706b7c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f75036994f9d6945265d02cb29de502d6d7d538d", "patch": "@@ -1,3 +1,8 @@\n+2016-10-21  Kugan Vivekanandarajah  <kuganv@linaro.org>\n+\n+\t* gcc.dg/ipa/vrp5.c: New test.\n+\t* gcc.dg/ipa/vrp6.c: New test.\n+\n 2016-10-21  Wilco Dijkstra  <wdijkstr@arm.com>\n \n \t* gcc.target/aarch64/test_frame_17.c: New test."}, {"sha": "571798dab511f5400881b45b6ee1770e8d0b8967", "filename": "gcc/testsuite/gcc.dg/ipa/vrp5.c", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fvrp5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fvrp5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fvrp5.c?ref=f75036994f9d6945265d02cb29de502d6d7d538d", "patch": "@@ -0,0 +1,34 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-ipa-cp-details -fdump-tree-vrp1\" } */\n+\n+static __attribute__((noinline, noclone))\n+int foo (int *p)\n+{\n+  if (!p)\n+    return 0;\n+  *p = 1;\n+}\n+\n+struct st\n+{\n+  int a;\n+  int b;\n+};\n+\n+int arr1[10];\n+int a;\n+int bar (struct st *s)\n+{\n+  int arr2[10];\n+  int b;\n+  if (!s)\n+    return 0;\n+  foo (&s->a);\n+  foo (&a);\n+  foo (&b);\n+  foo (&arr1[1]);\n+  foo (&arr2[1]);\n+}\n+\n+/* { dg-final { scan-ipa-dump \"Setting nonnull for 0\" \"cp\" } } */\n+/* { dg-final { scan-tree-dump-times \"if\" 1 \"vrp1\" } } */"}, {"sha": "971db44344207576426f91fa92f4941306063f8f", "filename": "gcc/testsuite/gcc.dg/ipa/vrp6.c", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fvrp6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f75036994f9d6945265d02cb29de502d6d7d538d/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fvrp6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fvrp6.c?ref=f75036994f9d6945265d02cb29de502d6d7d538d", "patch": "@@ -0,0 +1,34 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-ipa-cp-details -fdump-tree-vrp1\" } */\n+\n+static __attribute__((noinline, noclone))\n+int foo (int *p)\n+{\n+  if (!p)\n+    return 0;\n+  *p = 1;\n+}\n+\n+struct st\n+{\n+  int a;\n+  int b;\n+};\n+\n+struct st s2;\n+int a;\n+int bar (struct st *s)\n+{\n+  struct st s3;\n+  int b;\n+  if (!s)\n+    return 0;\n+  foo (&s->a);\n+  foo (&s2.a);\n+  foo (&s3.a);\n+  foo (&a);\n+  foo (&b);\n+}\n+\n+/* { dg-final { scan-ipa-dump \"Setting nonnull for 0\" \"cp\" } } */\n+/* { dg-final { scan-tree-dump-times \"if\" 1 \"vrp1\" } } */"}]}