{"sha": "9302e6e54c6bdbe354924f249ce1edac6847b467", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTMwMmU2ZTU0YzZiZGJlMzU0OTI0ZjI0OWNlMWVkYWM2ODQ3YjQ2Nw==", "commit": {"author": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-09-16T06:03:16Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1997-09-16T06:03:16Z"}, "message": "More formatting fixes.\n\nFrom-SVN: r15476", "tree": {"sha": "7abad4a6a5c88574536d22b1e68e1c8ac8f56cb1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7abad4a6a5c88574536d22b1e68e1c8ac8f56cb1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9302e6e54c6bdbe354924f249ce1edac6847b467", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9302e6e54c6bdbe354924f249ce1edac6847b467", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9302e6e54c6bdbe354924f249ce1edac6847b467", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9302e6e54c6bdbe354924f249ce1edac6847b467/comments", "author": null, "committer": null, "parents": [{"sha": "07f7a41accaa355bda5ce5cf5e90a16a0c6607a6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07f7a41accaa355bda5ce5cf5e90a16a0c6607a6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07f7a41accaa355bda5ce5cf5e90a16a0c6607a6"}], "stats": {"total": 735, "additions": 40, "deletions": 695}, "files": [{"sha": "4107661a99c3d2149d9ca7db306dbdd916b62d70", "filename": "gcc/config/v850/v850.md", "status": "modified", "additions": 40, "deletions": 695, "changes": 735, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9302e6e54c6bdbe354924f249ce1edac6847b467/gcc%2Fconfig%2Fv850%2Fv850.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9302e6e54c6bdbe354924f249ce1edac6847b467/gcc%2Fconfig%2Fv850%2Fv850.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fv850%2Fv850.md?ref=9302e6e54c6bdbe354924f249ce1edac6847b467", "patch": "@@ -341,6 +341,8 @@\n    (set_attr \"cc\" \"none_0hit\")\n    (set_attr \"type\" \"mult\")])\n \n+;; ??? Sign extending constants isn't valid.  Fix?\n+\n (define_insn \"*mulhisi3_internal2\"\n   [(set (match_operand:SI 0 \"register_operand\" \"=r,r\")\n \t(mult:SI\n@@ -1083,356 +1085,25 @@\n ;; HELPER INSTRUCTIONS for saving the prologue and epilog registers\n ;; ----------------------------------------------------------------------\n \n-;; Save r2, r20-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r2_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -64)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 2))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 20))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 21))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -40))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -44))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -48))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -52))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -56))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -60))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r2_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r20-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r20_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -60)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 20))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 21))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -40))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -44))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -48))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -52))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -56))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r20_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r21-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r21_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -56)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 21))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -40))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -44))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -48))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -52))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r21_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r22-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r22_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -52)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -40))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -44))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -48))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r22_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r23-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r23_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -48)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -40))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -44))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r23_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r24-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r24_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -44)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -40))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r24_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r25-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r25_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -40)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r25_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r26-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r26_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -36)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r26_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r27-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r27_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -32)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r27_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r28-r29, r31, and create 16 byte register call area\n-(define_insn \"save_r28_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -28)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r28_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r29, r31, and create 16 byte register call area\n-(define_insn \"save_r29_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -24)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 29))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r29_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r31, and create 16 byte register call area\n-(define_insn \"save_r31\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -20)))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 31))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r31,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r2, r20-r29\n-(define_insn \"save_r2_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -44)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 2))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 20))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 21))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -40))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r2_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n+;; This pattern will match a stack adjust RTX followed by any number of push\n+;; RTXs.  These RTXs will then be turned into a suitable call to a worker\n+;; function.\n+\n+(define_insn \"\"\n+ [(match_parallel 0 \"pattern_is_ok_for_prologue\"\n+   [(set (reg:SI 3)\n+\t (plus:SI (reg:SI 3) (match_operand:SI 1 \"immediate_operand\" \"i\")))\n+    (set (mem:SI\n+\t   (plus:SI (reg:SI 3) (match_operand:SI 2 \"immediate_operand\" \"i\")))\n+\t (match_operand:SI 3 \"register_is_ok_for_epilogue\" \"r\"))])]\n+ \"TARGET_PROLOG_FUNCTION\"\n+ \"* return construct_save_jarl (operands[0]);\n+ \"\n+ [(set_attr \"length\" \"4\")\n+  (set_attr \"cc\"     \"clobber\")\n+ ]\n+)\n \n-;; Save r20-r29\n-(define_insn \"save_r20_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -40)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 20))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 21))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -36))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r20_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r21-r29\n-(define_insn \"save_r21_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -36)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 21))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -32))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r21_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r22-r29\n-(define_insn \"save_r22_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -32)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 22))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -28))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r22_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r23-r29\n-(define_insn \"save_r23_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -28)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 23))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -24))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r23_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r24-r29\n-(define_insn \"save_r24_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -24)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 24))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -20))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r24_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r25-r29\n-(define_insn \"save_r25_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -20)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 25))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -16))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r25_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r26-r29\n-(define_insn \"save_r26_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -16)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 26))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -12))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r26_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r27-r29\n-(define_insn \"save_r27_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -12)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 27))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -8))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r27_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r28-r29\n-(define_insn \"save_r28_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -8)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 28))\n-   (set (mem:SI (plus:SI (reg:SI 3) (const_int -4))) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r28_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Save r29\n-(define_insn \"save_r29\"\n-  [(set (reg:SI 3) (plus:SI (reg:SI 3) (const_int -4)))\n-   (set (mem:SI (reg:SI 3)) (reg:SI 29))\n-   (clobber (reg:SI 10))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jarl __save_r29,r10\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n \n ;; Initialize an interrupt function.  Do not depend on TARGET_PROLOG_FUNCTION.\n (define_insn \"save_interrupt\"\n@@ -1446,6 +1117,7 @@\n   [(set_attr \"length\" \"12\")\n    (set_attr \"cc\" \"clobber\")])\n \n+\n ;; Save all registers except for the registers saved in save_interrupt when\n ;; an interrupt function makes a call.\n ;; UNSPEC_VOLATILE is considered to use and clobber all hard registers and\n@@ -1460,356 +1132,28 @@\n   [(set_attr \"length\" \"4\")\n    (set_attr \"cc\" \"clobber\")])\n \n-;; Restore r2, r20-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r2_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 64)))\n-   (set (reg:SI 2) (mem:SI (plus:SI (reg:SI 3) (const_int 60))))\n-   (set (reg:SI 20) (mem:SI (plus:SI (reg:SI 3) (const_int 56))))\n-   (set (reg:SI 21) (mem:SI (plus:SI (reg:SI 3) (const_int 52))))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 48))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 44))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r2_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r20-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r20_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 60)))\n-   (set (reg:SI 20) (mem:SI (plus:SI (reg:SI 3) (const_int 56))))\n-   (set (reg:SI 21) (mem:SI (plus:SI (reg:SI 3) (const_int 52))))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 48))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 44))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r20_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r21-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r21_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 56)))\n-   (set (reg:SI 21) (mem:SI (plus:SI (reg:SI 3) (const_int 52))))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 48))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 44))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r21_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r22-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r22_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 52)))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 48))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 44))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r22_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r23-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r23_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 48)))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 44))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r23_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r24-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r24_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 44)))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r24_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r25-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r25_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 40)))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r25_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r26-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r26_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 36)))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r26_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r27-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r27_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 32)))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r27_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r28-r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r28_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 28)))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r28_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r29, r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r29_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 24)))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r29_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r31, eliminate 16 byte register call area, and return to user\n-(define_insn \"restore_r31\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 20)))\n-   (set (reg:SI 31) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r31\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n \n-;; Restore r2, r20-r29, and return to user\n-(define_insn \"restore_r2_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 48)))\n-   (set (reg:SI 2) (mem:SI (plus:SI (reg:SI 3) (const_int 44))))\n-   (set (reg:SI 20) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 21) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r2_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n \n-;; Restore r20-r29, and return to user\n-(define_insn \"restore_r20_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 44)))\n-   (set (reg:SI 20) (mem:SI (plus:SI (reg:SI 3) (const_int 40))))\n-   (set (reg:SI 21) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r20_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n \n-;; Restore r21-r29, and return to user\n-(define_insn \"restore_r21_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 40)))\n-   (set (reg:SI 21) (mem:SI (plus:SI (reg:SI 3) (const_int 36))))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r21_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n+;; This pattern will match a return RTX followed by any number of pop RTXs\n+;; and possible a stack adjustment as well.  These RTXs will be turned into\n+;; a suitable call to a worker function.\n \n-;; Restore r22-r29, and return to user\n-(define_insn \"restore_r22_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 36)))\n-   (set (reg:SI 22) (mem:SI (plus:SI (reg:SI 3) (const_int 32))))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r22_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r23-r29, and return to user\n-(define_insn \"restore_r23_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 32)))\n-   (set (reg:SI 23) (mem:SI (plus:SI (reg:SI 3) (const_int 28))))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r23_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r24-r29, and return to user\n-(define_insn \"restore_r24_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 28)))\n-   (set (reg:SI 24) (mem:SI (plus:SI (reg:SI 3) (const_int 24))))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r24_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r25-r29, and return to user\n-(define_insn \"restore_r25_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 24)))\n-   (set (reg:SI 25) (mem:SI (plus:SI (reg:SI 3) (const_int 20))))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r25_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r26-r29, and return to user\n-(define_insn \"restore_r26_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 20)))\n-   (set (reg:SI 26) (mem:SI (plus:SI (reg:SI 3) (const_int 16))))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r26_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r27-r29, and return to user\n-(define_insn \"restore_r27_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 16)))\n-   (set (reg:SI 27) (mem:SI (plus:SI (reg:SI 3) (const_int 12))))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r27_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r28-r29, and return to user\n-(define_insn \"restore_r28_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 12)))\n-   (set (reg:SI 28) (mem:SI (plus:SI (reg:SI 3) (const_int 8))))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r28_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n-\n-;; Restore r29, and return to user\n-(define_insn \"restore_r29\"\n-  [(return)\n-   (set (reg:SI 3) (plus:SI (reg:SI 3) (const_int 8)))\n-   (set (reg:SI 29) (mem:SI (plus:SI (reg:SI 3) (const_int 4))))]\n-  \"TARGET_PROLOG_FUNCTION\"\n-  \"jr __return_r29\"\n-  [(set_attr \"length\" \"4\")\n-   (set_attr \"cc\" \"clobber\")])\n+(define_insn \"\"\n+[(match_parallel 0 \"pattern_is_ok_for_epilogue\"\n+   [(return)\n+    (set (reg:SI 3)\n+\t (plus:SI (reg:SI 3) (match_operand:SI 1 \"immediate_operand\" \"i\")))\n+    (set (match_operand:SI 2 \"register_is_ok_for_epilogue\" \"r\")\n+\t (mem:SI (plus:SI (reg:SI 3)\n+\t\t\t  (match_operand:SI 3 \"immediate_operand\" \"i\"))))])]\n+ \"TARGET_PROLOG_FUNCTION && TARGET_V850\"\n+ \"* return construct_restore_jr (operands[0]);\n+ \"\n+ [(set_attr \"length\" \"4\")\n+  (set_attr \"cc\"     \"clobber\")\n+ ]\n+)\n \n ;; Restore r1, r5, r10, and return from the interrupt\n (define_insn \"restore_interrupt\"\n@@ -1848,3 +1192,4 @@\n   \"jarl __save_r6_r9,r10\"\n   [(set_attr \"length\" \"4\")\n    (set_attr \"cc\" \"clobber\")])\n+"}]}