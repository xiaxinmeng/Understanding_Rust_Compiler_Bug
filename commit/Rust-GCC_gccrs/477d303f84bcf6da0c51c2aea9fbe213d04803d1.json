{"sha": "477d303f84bcf6da0c51c2aea9fbe213d04803d1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDc3ZDMwM2Y4NGJjZjZkYTBjNTFjMmFlYTlmYmUyMTNkMDQ4MDNkMQ==", "commit": {"author": {"name": "Ray Essick", "email": "essick@ddna.labs.mot.com", "date": "2000-08-18T21:11:23Z"}, "committer": {"name": "Nick Clifton", "email": "nickc@gcc.gnu.org", "date": "2000-08-18T21:11:23Z"}, "message": "Only allow allow rotations by a constant amount.\n\nDo not generate ROTL instruction.\n\nFrom-SVN: r35797", "tree": {"sha": "25614ba13be37ceb968c37226e5bcc8833028044", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25614ba13be37ceb968c37226e5bcc8833028044"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/477d303f84bcf6da0c51c2aea9fbe213d04803d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/477d303f84bcf6da0c51c2aea9fbe213d04803d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/477d303f84bcf6da0c51c2aea9fbe213d04803d1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/477d303f84bcf6da0c51c2aea9fbe213d04803d1/comments", "author": null, "committer": null, "parents": [{"sha": "7d2950e52384ed32ca712f28460645d8ca35c97f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d2950e52384ed32ca712f28460645d8ca35c97f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d2950e52384ed32ca712f28460645d8ca35c97f"}], "stats": {"total": 31, "additions": 23, "deletions": 8}, "files": [{"sha": "53183a03616909f627bf2133b992ec12385446ac", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/477d303f84bcf6da0c51c2aea9fbe213d04803d1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/477d303f84bcf6da0c51c2aea9fbe213d04803d1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=477d303f84bcf6da0c51c2aea9fbe213d04803d1", "patch": "@@ -1,3 +1,8 @@\n+2000-08-18  Ray Essick <essick@ddna.labs.mot.com> & Nick Clifton  <nickc@redhat.com>\n+\n+\t* config/mcore/mcore.md (rotlsi3): Allow allow rotations by a\n+\tconstant amount.  Do not generate ROTL instruction.\n+\n Fri Aug 18 16:22:20 2000  Alexandre Oliva  <aoliva@redhat.com>\n \n \t* config/sh/elf.h: Do not include sh/sh.h."}, {"sha": "fa659a304981914dad88da2472c84ec1ff6e37c9", "filename": "gcc/config/mcore/mcore.md", "status": "modified", "additions": 18, "deletions": 8, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/477d303f84bcf6da0c51c2aea9fbe213d04803d1/gcc%2Fconfig%2Fmcore%2Fmcore.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/477d303f84bcf6da0c51c2aea9fbe213d04803d1/gcc%2Fconfig%2Fmcore%2Fmcore.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmcore%2Fmcore.md?ref=477d303f84bcf6da0c51c2aea9fbe213d04803d1", "patch": "@@ -505,15 +505,25 @@\n ;; Shifts and rotates\n ;; -------------------------------------------------------------------------\n \n-;;; ??? The reg case may never match.\n-(define_insn \"rotlsi3\"\n-  [(set (match_operand:SI 0 \"mcore_arith_reg_operand\" \"=r,r\")\n-\t(rotate:SI (match_operand:SI 1 \"mcore_arith_reg_operand\" \"0,0\")\n-\t\t     (match_operand:SI 2 \"mcore_arith_K_operand_not_0\" \"r,K\")))]\n+;; Only allow these if the shift count is a convenient constant.\n+(define_expand \"rotlsi3\"\n+  [(set (match_operand:SI            0 \"mcore_arith_reg_operand\" \"\")\n+\t(rotate:SI (match_operand:SI 1 \"mcore_arith_reg_operand\" \"\")\n+\t\t   (match_operand:SI 2 \"nonmemory_operand\" \"\")))]\n+  \"\"\n+  \"if (! mcore_literal_K_operand (operands[2], SImode))\n+\t FAIL;\n+  \")\n+\n+;; We can only do constant rotates, which is what this pattern provides.\n+;; The combiner will put it together for us when we do:\n+;;\t(x << N) | (x >> (32 - N))\n+(define_insn \"\"\n+  [(set (match_operand:SI              0 \"mcore_arith_reg_operand\" \"=r\")\n+\t(rotate:SI (match_operand:SI   1 \"mcore_arith_reg_operand\"  \"0\")\n+\t\t     (match_operand:SI 2 \"mcore_literal_K_operand\"  \"K\")))]\n   \"\"\n-  \"@\n-\trotl\t%0,%2\n-\trotli\t%0,%2\"\n+  \"rotli\t%0,%2\"\n   [(set_attr \"type\" \"shift\")])\n \n (define_insn \"ashlsi3\""}]}