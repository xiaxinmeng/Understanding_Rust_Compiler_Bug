{"sha": "db761fee4caf7ceb652dc6224428a675de7b1cb3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGI3NjFmZWU0Y2FmN2NlYjY1MmRjNjIyNDQyOGE2NzVkZTdiMWNiMw==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-01-06T09:32:06Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2015-01-06T09:32:06Z"}, "message": "[multiple changes]\n\n2015-01-06  Robert Dewar  <dewar@adacore.com>\n\n\t* namet.ads: Document use of Boolean2 for No_Use_Of_Entity.\n\t* restrict.ads (No_Use_Of_Entity): New table.\n\t* sem_prag.adb (Process_Restrictions_Or_Restriction_Warnings):\n\tIgnore No_Use_Of_Entity (will be processed in parser).\n\t* snames.ads-tmpl: Add entry for Name_No_Use_Of_Entity.\n\n2015-01-06  Vincent Celier  <celier@adacore.com>\n\n\t* prj-tree.adb (Imported_Or_Extended_Project_Of): Do not try\n\tto check for an extended project, if a project does not have\n\tyet a project declaration.\n\nFrom-SVN: r219235", "tree": {"sha": "4ce7582ec4634a5419c981577947c74f23805fb9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4ce7582ec4634a5419c981577947c74f23805fb9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/db761fee4caf7ceb652dc6224428a675de7b1cb3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db761fee4caf7ceb652dc6224428a675de7b1cb3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db761fee4caf7ceb652dc6224428a675de7b1cb3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db761fee4caf7ceb652dc6224428a675de7b1cb3/comments", "author": null, "committer": null, "parents": [{"sha": "0566484a15d36465693a4afb06538d63925579b4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0566484a15d36465693a4afb06538d63925579b4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0566484a15d36465693a4afb06538d63925579b4"}], "stats": {"total": 91, "additions": 84, "deletions": 7}, "files": [{"sha": "a64555ef5f932cc2142e8ec8d26036ab4fe9b40d", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=db761fee4caf7ceb652dc6224428a675de7b1cb3", "patch": "@@ -1,3 +1,17 @@\n+2015-01-06  Robert Dewar  <dewar@adacore.com>\n+\n+\t* namet.ads: Document use of Boolean2 for No_Use_Of_Entity.\n+\t* restrict.ads (No_Use_Of_Entity): New table.\n+\t* sem_prag.adb (Process_Restrictions_Or_Restriction_Warnings):\n+\tIgnore No_Use_Of_Entity (will be processed in parser).\n+\t* snames.ads-tmpl: Add entry for Name_No_Use_Of_Entity.\n+\n+2015-01-06  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-tree.adb (Imported_Or_Extended_Project_Of): Do not try\n+\tto check for an extended project, if a project does not have\n+\tyet a project declaration.\n+\n 2015-01-06  Pierre-Marie Derodat  <derodat@adacore.com>\n \n \t* scos.ads: Update documentation about the SCO table build"}, {"sha": "6074575070cc0ce1da80f5cf787092d3fadd56f1", "filename": "gcc/ada/namet.ads", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fnamet.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fnamet.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fnamet.ads?ref=db761fee4caf7ceb652dc6224428a675de7b1cb3", "patch": "@@ -131,7 +131,11 @@ package Namet is\n --      The Boolean1 field is used to mark address clauses to optimize the\n --      performance of the Exp_Util.Following_Address_Clause function.\n \n---      The Boolean2/Boolean3 fields are not used\n+--      The Boolean2 field is used to mark simple names that appear in\n+--      Restriction[_Warning]s pragmas for No_Use_Of_Entity. This avoids most\n+--      unnecessary searches of the No_Use_Of_Entity table.\n+\n+--      The Boolean3 field is not used\n \n --    In the binder, we have the following uses:\n "}, {"sha": "75def1c06efed494fa38451445100a548976bc2e", "filename": "gcc/ada/prj-tree.adb", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fprj-tree.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fprj-tree.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-tree.adb?ref=db761fee4caf7ceb652dc6224428a675de7b1cb3", "patch": "@@ -1151,6 +1151,7 @@ package body Prj.Tree is\n    is\n       With_Clause : Project_Node_Id;\n       Result      : Project_Node_Id := Empty_Node;\n+      Decl        : Project_Node_Id;\n \n    begin\n       --  First check all the imported projects\n@@ -1167,9 +1168,14 @@ package body Prj.Tree is\n                return Result;\n             end if;\n \n-            Result :=\n-              Extended_Project_Of\n-                (Project_Declaration_Of (Result, In_Tree), In_Tree);\n+            Decl := Project_Declaration_Of (Result, In_Tree);\n+\n+            --  Do not try to check for an extended project, if the project\n+            --  does not have yet a project declaration.\n+\n+            exit when Decl = Empty_Node;\n+\n+            Result := Extended_Project_Of (Decl, In_Tree);\n          end loop;\n \n          With_Clause := Next_With_Clause_Of (With_Clause, In_Tree);"}, {"sha": "a25dceed1c543ae0214d44b36b66b4c00dadf03a", "filename": "gcc/ada/restrict.ads", "status": "modified", "additions": 43, "deletions": 2, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Frestrict.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Frestrict.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frestrict.ads?ref=db761fee4caf7ceb652dc6224428a675de7b1cb3", "patch": "@@ -51,8 +51,8 @@ package Restrict is\n    --  set from package Standard by the processing in Targparm.\n \n    Restriction_Profile_Name : array (All_Restrictions) of Profile_Name;\n-   --  Entries in this array are valid only if the corresponding restriction\n-   --  in Restrictions set. The value is the corresponding profile name if the\n+   --  Entries in this array are valid only if the corresponding restriction in\n+   --  Restrictions is set. The value is the corresponding profile name if the\n    --  restriction was set by a Profile or Profile_Warnings pragma. The value\n    --  is No_Profile in all other cases.\n \n@@ -148,6 +148,10 @@ package Restrict is\n       SPARK_05                           => True,\n       others                             => False);\n \n+   --------------------------\n+   -- No_Dependences Table --\n+   --------------------------\n+\n    --  The following table records entries made by Restrictions pragmas\n    --  that specify a parameter for No_Dependence. Each such pragma makes\n    --  an entry in this table.\n@@ -179,6 +183,43 @@ package Restrict is\n      Table_Increment      => 200,\n      Table_Name           => \"Name_No_Dependences\");\n \n+   ----------------------------\n+   -- No_Use_Of_Entity Table --\n+   ----------------------------\n+\n+   --  The following table records entries made by Restrictions pragmas\n+   --  that specify a parameter for No_Use_Of_Entity. Each such pragma makes\n+   --  an entry in this table.\n+\n+   --  Note: we have chosen to implement this restriction in the \"syntactic\"\n+   --  form, where we allow arbitrary fully qualified names to be specified.\n+\n+   type NE_Entry is record\n+      Entity : Node_Id;\n+      --  The entity parameter from the No_Use_Of_Entity pragma. This is in\n+      --  the form of a selected component, since that is the way the parser\n+      --  processes it, and we don't further analyze it.\n+\n+      Warn : Boolean;\n+      --  True if from Restriction_Warnings, False if from Restrictions\n+\n+      Profile : Profile_Name;\n+      --  Set to name of profile from which No_Use_Of_Entity entry came, or to\n+      --  No_Profile if a pragma Restriction set the No_Use_Of_Entity entry.\n+   end record;\n+\n+   package No_Use_Of_Entity is new Table.Table (\n+     Table_Component_Type => NE_Entry,\n+     Table_Index_Type     => Int,\n+     Table_Low_Bound      => 0,\n+     Table_Initial        => 200,\n+     Table_Increment      => 200,\n+     Table_Name           => \"Name_No_Use_Of_Entity\");\n+\n+   --  Note that in addition to making an entry in this table, we also set the\n+   --  Boolean2 flag of the Name_Table entry for the simple name of the entity.\n+   --  This is used to avoid most useless searches of this table.\n+\n    -----------------\n    -- Subprograms --\n    -----------------"}, {"sha": "2c4d531f9e0c863ee6f793d84084c7655febc519", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=db761fee4caf7ceb652dc6224428a675de7b1cb3", "patch": "@@ -8857,7 +8857,7 @@ package body Sem_Prag is\n                   raise Pragma_Exit;\n                end if;\n \n-            --  Case of No_Specification_Of_Aspect => Identifier.\n+            --  Case of No_Specification_Of_Aspect => aspect-identifier\n \n             elsif Id = Name_No_Specification_Of_Aspect then\n                declare\n@@ -8877,6 +8877,8 @@ package body Sem_Prag is\n                   end if;\n                end;\n \n+            --  Case of No_Use_Of_Attribute => attribute-identifier\n+\n             elsif Id = Name_No_Use_Of_Attribute then\n                if Nkind (Expr) /= N_Identifier\n                  or else not Is_Attribute_Name (Chars (Expr))\n@@ -8887,6 +8889,15 @@ package body Sem_Prag is\n                   Set_Restriction_No_Use_Of_Attribute (Expr, Warn);\n                end if;\n \n+            --  Case of No_Use_Of_Entity => fully-qualified-name. Note that the\n+            --  parser already processed this case commpletely, including error\n+            --  checking and making an entry in the No_Use_Of_Entity table.\n+\n+            elsif Id = Name_No_Use_Of_Entity then\n+               null;\n+\n+            --  Case of No_Use_Of_Pragma => pragma-identifier\n+\n             elsif Id = Name_No_Use_Of_Pragma then\n                if Nkind (Expr) /= N_Identifier\n                  or else not Is_Pragma_Name (Chars (Expr))"}, {"sha": "673a7530cd203b48cdfd0d5fb394be461b8ce33d", "filename": "gcc/ada/snames.ads-tmpl", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fsnames.ads-tmpl", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db761fee4caf7ceb652dc6224428a675de7b1cb3/gcc%2Fada%2Fsnames.ads-tmpl", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsnames.ads-tmpl?ref=db761fee4caf7ceb652dc6224428a675de7b1cb3", "patch": "@@ -751,6 +751,7 @@ package Snames is\n    Name_No_Task_Attributes             : constant Name_Id := N + $;\n    Name_No_Task_Attributes_Package     : constant Name_Id := N + $;\n    Name_No_Use_Of_Attribute            : constant Name_Id := N + $;\n+   Name_No_Use_Of_Entity               : constant Name_Id := N + $;\n    Name_No_Use_Of_Pragma               : constant Name_Id := N + $;\n    Name_No_Unroll                      : constant Name_Id := N + $;\n    Name_No_Vector                      : constant Name_Id := N + $;"}]}