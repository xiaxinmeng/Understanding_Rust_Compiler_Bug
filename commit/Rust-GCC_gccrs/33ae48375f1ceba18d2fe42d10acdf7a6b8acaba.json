{"sha": "33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzNhZTQ4Mzc1ZjFjZWJhMThkMmZlNDJkMTBhY2RmN2E2YjhhY2FiYQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2008-01-03T17:58:26Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2008-01-03T17:58:26Z"}, "message": "re PR preprocessor/34602 (Internal error with invalid #line directive)\n\nlibcpp\n\tPR preprocessor/34602.\n\t* directives.c (do_line): Don't try to spell EOF token.\n\t(do_linemarker): Add comment.\ngcc/testsuite\n\tPR preprocessor/34602:\n\t* gcc.dg/cpp/pr34602.c: New file.\n\nFrom-SVN: r131304", "tree": {"sha": "c6771e54be61d92ae4c113b997d5d553a15c2866", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c6771e54be61d92ae4c113b997d5d553a15c2866"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/comments", "author": null, "committer": null, "parents": [{"sha": "cac67c0835c7cf87ca6bb62b5fab0a781ac006b4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cac67c0835c7cf87ca6bb62b5fab0a781ac006b4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cac67c0835c7cf87ca6bb62b5fab0a781ac006b4"}], "stats": {"total": 30, "additions": 26, "deletions": 4}, "files": [{"sha": "962dc97e6f948a8deb069ae8bb18844151be849f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "patch": "@@ -1,3 +1,8 @@\n+2008-01-03  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR preprocessor/34602:\n+\t* gcc.dg/cpp/pr34602.c: New file.\n+\n 2008-01-03  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/29484"}, {"sha": "343c0917aeed10cc4425076c86d5ecd135f6ae9e", "filename": "gcc/testsuite/gcc.dg/cpp/pr34602.c", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpr34602.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpr34602.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fcpp%2Fpr34602.c?ref=33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "patch": "@@ -0,0 +1,6 @@\n+/* PR preprocessor/34602 - no internal error trying to spell EOF.  */\n+/* { dg-do preprocess } */\n+\n+/* { dg-error \"unexpected end\" \"\" { target *-*-* } 6 } */\n+\n+#line"}, {"sha": "335686f16fc03f98e6272d0a21926f71180b08a1", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "patch": "@@ -1,3 +1,9 @@\n+2008-01-03  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR preprocessor/34602.\n+\t* directives.c (do_line): Don't try to spell EOF token.\n+\t(do_linemarker): Add comment.\n+\n 2007-12-11  DJ Delorie  <dj@redhat.com>\n \n \t* charset.c (convert_using_iconv): Close out any shift states,"}, {"sha": "6e2e55c53899330c4a83fc517bb6761a56cc8ccd", "filename": "libcpp/directives.c", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/libcpp%2Fdirectives.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/33ae48375f1ceba18d2fe42d10acdf7a6b8acaba/libcpp%2Fdirectives.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Fdirectives.c?ref=33ae48375f1ceba18d2fe42d10acdf7a6b8acaba", "patch": "@@ -1,7 +1,7 @@\n /* CPP Library. (Directive handling.)\n    Copyright (C) 1986, 1987, 1989, 1992, 1993, 1994, 1995, 1996, 1997, 1998,\n    1999, 2000, 2001, 2002, 2003, 2004, 2005,\n-   2007 Free Software Foundation, Inc.\n+   2007, 2008 Free Software Foundation, Inc.\n    Contributed by Per Bothner, 1994-95.\n    Based on CCCP program by Paul Rubin, June 1986\n    Adapted to ANSI C, Richard Stallman, Jan 1987\n@@ -864,9 +864,12 @@ do_line (cpp_reader *pfile)\n       || strtoul_for_line (token->val.str.text, token->val.str.len,\n \t\t\t   &new_lineno))\n     {\n-      cpp_error (pfile, CPP_DL_ERROR,\n-\t\t \"\\\"%s\\\" after #line is not a positive integer\",\n-\t\t cpp_token_as_text (pfile, token));\n+      if (token->type == CPP_EOF)\n+\tcpp_error (pfile, CPP_DL_ERROR, \"unexpected end of file after #line\");\n+      else\n+\tcpp_error (pfile, CPP_DL_ERROR,\n+\t\t   \"\\\"%s\\\" after #line is not a positive integer\",\n+\t\t   cpp_token_as_text (pfile, token));\n       return;\n     }\n \n@@ -920,6 +923,8 @@ do_linemarker (cpp_reader *pfile)\n       || strtoul_for_line (token->val.str.text, token->val.str.len,\n \t\t\t   &new_lineno))\n     {\n+      /* Unlike #line, there does not seem to be a way to get an EOF\n+\t here.  So, it should be safe to always spell the token.  */\n       cpp_error (pfile, CPP_DL_ERROR,\n \t\t \"\\\"%s\\\" after # is not a positive integer\",\n \t\t cpp_token_as_text (pfile, token));"}]}