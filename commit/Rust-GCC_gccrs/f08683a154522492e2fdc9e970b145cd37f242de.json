{"sha": "f08683a154522492e2fdc9e970b145cd37f242de", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjA4NjgzYTE1NDUyMjQ5MmUyZmRjOWU5NzBiMTQ1Y2QzN2YyNDJkZQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-02-09T14:06:58Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-02-09T14:06:58Z"}, "message": "re PR c++/79429 (ICE in add_stmt, at cp/semantics.c:385)\n\n\tPR c++/79429\n\t* parser.c (cp_parser_omp_ordered): Don't check for non-pragma_stmt\n\tnon-pragma_compound context here.\n\t(cp_parser_omp_target): Likewise.\n\t(cp_parser_pragma): Don't call push_omp_privatization_clauses and\n\tparsing for ordered and target omp pragmas in non-pragma_stmt\n\tnon-pragma_compound contexts.\n\n\t* c-c++-common/gomp/pr79429.c: New test.\n\t* g++.dg/gomp/pr79429.C: New test.\n\nFrom-SVN: r245303", "tree": {"sha": "29a9970700dafea0da06c1d96c659c945c33a8a6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/29a9970700dafea0da06c1d96c659c945c33a8a6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f08683a154522492e2fdc9e970b145cd37f242de", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f08683a154522492e2fdc9e970b145cd37f242de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f08683a154522492e2fdc9e970b145cd37f242de", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f08683a154522492e2fdc9e970b145cd37f242de/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "56f71478487174d7bacbe51a9c35d23257db905e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56f71478487174d7bacbe51a9c35d23257db905e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56f71478487174d7bacbe51a9c35d23257db905e"}], "stats": {"total": 36, "additions": 22, "deletions": 14}, "files": [{"sha": "6639fbdab9eeda653774370615aaa3738200360f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f08683a154522492e2fdc9e970b145cd37f242de", "patch": "@@ -1,5 +1,13 @@\n 2017-02-09  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/79429\n+\t* parser.c (cp_parser_omp_ordered): Don't check for non-pragma_stmt\n+\tnon-pragma_compound context here.\n+\t(cp_parser_omp_target): Likewise.\n+\t(cp_parser_pragma): Don't call push_omp_privatization_clauses and\n+\tparsing for ordered and target omp pragmas in non-pragma_stmt\n+\tnon-pragma_compound contexts.\n+\n \tPR c/79431\n \t* parser.c (cp_parser_oacc_declare): Formatting fix.\n \t(cp_parser_omp_declare_target): Don't invoke symtab_node::get on"}, {"sha": "aadf44d0a609ef64181b24276aa149ccdd7c082e", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 4, "deletions": 14, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=f08683a154522492e2fdc9e970b145cd37f242de", "patch": "@@ -34934,13 +34934,6 @@ cp_parser_omp_ordered (cp_parser *parser, cp_token *pragma_tok,\n {\n   location_t loc = pragma_tok->location;\n \n-  if (context != pragma_stmt && context != pragma_compound)\n-    {\n-      cp_parser_error (parser, \"expected declaration specifiers\");\n-      cp_parser_skip_to_pragma_eol (parser, pragma_tok);\n-      return false;\n-    }\n-\n   if (cp_lexer_next_token_is (parser->lexer, CPP_NAME))\n     {\n       tree id = cp_lexer_peek_token (parser->lexer)->u.value;\n@@ -35846,13 +35839,6 @@ cp_parser_omp_target (cp_parser *parser, cp_token *pragma_tok,\n {\n   tree *pc = NULL, stmt;\n \n-  if (context != pragma_stmt && context != pragma_compound)\n-    {\n-      cp_parser_error (parser, \"expected declaration specifiers\");\n-      cp_parser_skip_to_pragma_eol (parser, pragma_tok);\n-      return false;\n-    }\n-\n   if (cp_lexer_next_token_is (parser->lexer, CPP_NAME))\n     {\n       tree id = cp_lexer_peek_token (parser->lexer)->u.value;\n@@ -38283,12 +38269,16 @@ cp_parser_pragma (cp_parser *parser, enum pragma_context context, bool *if_p)\n       return true;\n \n     case PRAGMA_OMP_ORDERED:\n+      if (context != pragma_stmt && context != pragma_compound)\n+\tgoto bad_stmt;\n       stmt = push_omp_privatization_clauses (false);\n       ret = cp_parser_omp_ordered (parser, pragma_tok, context, if_p);\n       pop_omp_privatization_clauses (stmt);\n       return ret;\n \n     case PRAGMA_OMP_TARGET:\n+      if (context != pragma_stmt && context != pragma_compound)\n+\tgoto bad_stmt;\n       stmt = push_omp_privatization_clauses (false);\n       ret = cp_parser_omp_target (parser, pragma_tok, context, if_p);\n       pop_omp_privatization_clauses (stmt);"}, {"sha": "8a64e729df7245483522154af7d4a0acda319fb3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f08683a154522492e2fdc9e970b145cd37f242de", "patch": "@@ -1,5 +1,9 @@\n 2017-02-09  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR c++/79429\n+\t* c-c++-common/gomp/pr79429.c: New test.\n+\t* g++.dg/gomp/pr79429.C: New test.\n+\n \tPR c/79431\n \t* c-c++-common/gomp/pr79431.c: New test.\n "}, {"sha": "c9a54d5e08dbf17e7897c3a67e6f6d9801ca7ac7", "filename": "gcc/testsuite/c-c++-common/gomp/pr79429.c", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgomp%2Fpr79429.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgomp%2Fpr79429.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fgomp%2Fpr79429.c?ref=f08683a154522492e2fdc9e970b145cd37f242de", "patch": "@@ -0,0 +1,3 @@\n+/* PR c++/79429 */\n+\n+#pragma omp target /* { dg-error \"expected declaration specifiers\" } */"}, {"sha": "8ecbcd389632e276299ae88e36aaa325b6b5293c", "filename": "gcc/testsuite/g++.dg/gomp/pr79429.C", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr79429.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f08683a154522492e2fdc9e970b145cd37f242de/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr79429.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fgomp%2Fpr79429.C?ref=f08683a154522492e2fdc9e970b145cd37f242de", "patch": "@@ -0,0 +1,3 @@\n+// PR c++/79429\n+\n+#pragma omp ordered // { dg-error \"expected declaration specifiers\" }"}]}