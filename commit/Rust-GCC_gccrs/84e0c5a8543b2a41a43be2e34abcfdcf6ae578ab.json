{"sha": "84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODRlMGM1YTg1NDNiMmE0MWE0M2JlMmUzNGFiY2ZkY2Y2YWU1NzhhYg==", "commit": {"author": {"name": "Bruce Korb", "email": "korbb@gcc.gnu.org", "date": "1998-05-29T14:54:55Z"}, "committer": {"name": "Bruce Korb", "email": "korbb@gcc.gnu.org", "date": "1998-05-29T14:54:55Z"}, "message": "fixes from six months of fixincludes hacking\n\nFrom-SVN: r20140", "tree": {"sha": "8a82be9acd2a3bf1bda467acf21d85df04d61e24", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8a82be9acd2a3bf1bda467acf21d85df04d61e24"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab/comments", "author": null, "committer": null, "parents": [{"sha": "e23afa25113fb191e560862dc5f910eafe9f0d9b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e23afa25113fb191e560862dc5f910eafe9f0d9b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e23afa25113fb191e560862dc5f910eafe9f0d9b"}], "stats": {"total": 151, "additions": 131, "deletions": 20}, "files": [{"sha": "1cd194e1a122afa73ded284a5bc46ea2527ed675", "filename": "contrib/fixinc/inclhack.def", "status": "modified", "additions": 115, "deletions": 10, "changes": 125, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab/contrib%2Ffixinc%2Finclhack.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab/contrib%2Ffixinc%2Finclhack.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Ffixinc%2Finclhack.def?ref=84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab", "patch": "@@ -171,14 +171,42 @@ fix = {\n fix = {\n     hackname = badquote;\n     files    = sundev/vuid_event.h;\n-    /*\n-     *  The following uglitude is to allow an apostrophe inside\n-     *  of a single quote quoted string in a shell command line.\n-     */\n     sed      = \"s/doesn't/does not/\";\n };\n \n \n+/*\n+ *  Fix #defines under Alpha OSF/1:\n+ *  The following files contain '#pragma extern_prefix \"_FOO\"' followed by\n+ *  a '#define something(x,y,z) _FOOsomething(x,y,z)'.  The intent of these\n+ *  statements is to reduce namespace pollution.  While these macros work\n+ *  properly in most cases, they don't allow you to take a pointer to the\n+ *  \"something\" being modified.  To get around this limitation, change these\n+ *  statements to be of the form '#define something _FOOsomething'.\n+ */\n+fix = {\n+    hackname = bad_lval;\n+    select   = \"^[ \\t]*#[ \\t]*pragma[ \\t]extern_prefix\";\n+    files    = libgen.h;\n+    files    = dirent.h;\n+    files    = ftw.h;\n+    files    = grp.h;\n+    files    = ndbm.h;\n+    files    = pthread.h;\n+    files    = pwd.h;\n+    files    = signal.h;\n+    files    = standards.h;\n+    files    = stdlib.h;\n+    files    = string.h;\n+    files    = stropts.h;\n+    files    = time.h;\n+    files    = unistd.h;\n+    sed      =\n+        \"s/^[ \\t]*#[ \\t]*define[ \\t]*\\\\([^(]*\\\\)\\\\(([^)]*)\\\\)[ \\t]*\"\n+               \"\\\\(_.\\\\)\\\\1\\\\2[ \\t]*$/#define \\\\1 \\\\3\\\\1/\";\n+};\n+\n+\n /*\n  *  check for broken assert.h that needs stdio.h\n  */\n@@ -223,7 +251,7 @@ fix = {\n \n \n /*\n- *  And also with the HP-UX 10 sys/pci.h file\n+ *  And also with the HP-UX 10 and HP-UX 11 sys/pci.h file\n  */\n fix = {\n     hackname = cxx_cmnt_hpux;\n@@ -312,8 +340,14 @@ fix = {\n      *  and '0' lies the character '/'.  This will *NOT*\n      *  match '#endif / * foo * /', but it also wont match\n      *  '#endif / done' either.\n+     *\n+     *  We use the pattern [!-.0-z{|}~] instead of [^/ \\t] to match a noncomment\n+     *  following #else or #endif because some buggy egreps think [^/] matches\n+     *  newline, and they thus think `#else ' matches\n+     *  `#e[ndiflse]*[ \\t]+[^/ \\t]'.\n+     *  [!-.0-~] does not work properly on AIX 4.1.\n      */\n-    select   = \"^[ \\t]*#[ \\t]*endif[ \\t]+[!-.0-~]\";\n+    select   = \"^[ \\t]*#[ \\t]*endif[ \\t]+[!-.0-z\\{\\|\\}\\~]\";\n \n     /*\n      *  First, join the continued input lines.\n@@ -362,12 +396,11 @@ fix = {\n \n \n /*\n- *  assert.h and sys/mman.h on HP/UX are not C++ ready,\n+ *  sys/mman.h on HP/UX is not C++ ready,\n  *  even though NO_IMPLICIT_EXTERN_C is defined on HP/UX.\n  */\n fix = {\n     hackname = hpux_cxx_unready;\n-    files    = assert.h;\n     files    = sys/mman.h;\n     bypass = '\"C\"|__BEGIN_DECLS';\n \n@@ -560,6 +593,20 @@ fix = {\n };\n \n   \n+/*\n+ * Fix nested comments in Motorola's <limits.h> and <sys/limits.h>\n+ */\n+fix = {\n+    hackname = motorola_nested;\n+    files    = limits.h\n+    files    = sys/limits.h;\n+    sed = \"s@^\\\\(#undef[ \\t][ \\t]*PIPE_BUF[ \\t]*\"\n+                   \"/\\\\* max # bytes atomic in write to a\\\\)$@\\\\1 */@\";\n+    sed = \"s@\\\\(/\\\\*#define\\tHUGE_VAL\\t3.40282346638528860e+38 \\\\)\"\n+          \"\\\\(/\\\\*error value returned by Math lib\\\\*/\\\\)$@\\\\1*/ \\\\2@\";\n+};\n+\n+  \n /*\n  * Fixing nested comments in ISC <sys/limits.h>\n  */\n@@ -609,6 +656,7 @@ fix = {\n  *  comment.  Fortunately, HP/UX already uses #ifndefs in limits.h; if\n  *  we find a #ifndef FLT_MIN we assume that all the required #ifndefs\n  *  are there, and we do not add them ourselves.\n+ *  Also fix a nested comment problem in sys/limits.h on Motorola sysV68 R3V7.1\n  */\n fix = {\n     hackname = limits_ifndefs;\n@@ -627,6 +675,7 @@ fix = {\n     sed  = \"/[ \\t]DBL_MAX[ \\t]/a\\\\\\n#endif\\n\";\n     sed  = \"/[ \\t]DBL_DIG[ \\t]/i\\\\\\n#ifndef DBL_DIG\\n\";\n     sed  = \"/[ \\t]DBL_DIG[ \\t]/a\\\\\\n#endif\\n\";\n+    sed  = \"/^\\\\(\\\\/\\\\*#define\\tHUGE_VAL\\t3\\\\.[0-9e+]* *\\\\)\\\\/\\\\*/s//\\\\1/\";\n };\n \n \n@@ -896,7 +945,7 @@ fix = {\n           '{' \"\\\\\\n\"\n           \"\\treturn fabs (hypot (x, y));\\\\\\n\"\n           '}' \"\\\\\\n\"\n-          '#define hypot\tfake_hypot' \"\\n\";\n+          \"#define hypot\\tfake_hypot\\n\";\n };\n \n \n@@ -1814,6 +1863,7 @@ fix = {\n     hackname = systypes_for_aix;\n     files    = sys/types.h;\n     select   = \"typedef[ \\t][ \\t]*[A-Za-z_][ \\tA-Za-z_]*[ \\t]size_t\";\n+    bypass   = \"_GCC_SIZE_T\";\n \n     sed    = \"/typedef[ \\t][ \\t]*[A-Za-z_][ \\tA-Za-z_]*[ \\t]size_t/i\\\\\\n\"\n                  \"#ifndef _GCC_SIZE_T\\\\\\n\"\n@@ -1841,7 +1891,7 @@ fix = {\n     sed = \"s/^\\\\(\\tstrncmp()\\\\),\\\\n\\\\(\\tstrlen(),\\\\)$/\\\\1;\\\\\\n\"\n           \"extern unsigned int\\\\\\n\\\\2/\";\n     sed = \"/^extern int$/N\";\n-    sed = 's/^extern int\\(\\n\tstrlen(),\\)/extern size_t\\1/';\n+    sed = \"s/^extern int\\\\(\\\\n\\tstrlen(),\\\\)/extern size_t\\\\1/\";\n };\n \n \n@@ -2192,4 +2242,59 @@ fix = {\n };\n \n \n+/*\n+ *  Purge some HP-UX 11 files that are only borken after they are \"fixed\".\n+ */\n+fix = {\n+    hackname = zzz_ki_iface;\n+    files    = sys/ki_iface.h;\n+    select   = 'These definitions are for HP Internal developers';\n+    shell    = \"cat > /dev/null ; rm -f $file\";\n+};\n+\n+\n+/*\n+ *  Purge some HP-UX 11 files that are only borken after they are \"fixed\".\n+ */\n+fix = {\n+    hackname = zzz_ki;\n+    files    = sys/ki.h;\n+    select   = '11.00 HP-UX LP64';\n+    shell    = \"cat > /dev/null ; rm -f $file\";\n+};\n+\n+\n+/*\n+ *  Purge some HP-UX 11 files that are only borken after they are \"fixed\".\n+ */\n+fix = {\n+    hackname = zzz_ki_calls;\n+    files    = sys/ki_calls.h;\n+    select   = 'KI_MAX_PROCS is an arbitrary number';\n+    shell    = \"cat > /dev/null ; rm -f $file\";\n+};\n+\n+\n+/*\n+ *  Purge some HP-UX 11 files that are only borken after they are \"fixed\".\n+ */\n+fix = {\n+    hackname = zzz_ki_defs;\n+    files    = sys/ki_defs.h;\n+    select   = 'Kernel Instrumentation Definitions';\n+    shell    = \"cat > /dev/null ; rm -f $file\";\n+};\n+\n+\n+/*\n+ *  Purge some HP-UX 11 files that are only borken after they are \"fixed\".\n+ */\n+fix = {\n+    hackname = zzz_time;\n+    files    = sys/time.h;\n+    select   = 'For CASPEC, look in';\n+    shell    = \"cat > /dev/null ; rm -f $file\";\n+};\n+\n+\n /*EOF*/"}, {"sha": "1e2a47ab72f109bb44660412404cb2d52c5bde92", "filename": "contrib/fixinc/mkfixinc.sh", "status": "modified", "additions": 16, "deletions": 10, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab/contrib%2Ffixinc%2Fmkfixinc.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab/contrib%2Ffixinc%2Fmkfixinc.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Ffixinc%2Fmkfixinc.sh?ref=84e0c5a8543b2a41a43be2e34abcfdcf6ae578ab", "patch": "@@ -1,9 +1,15 @@\n #! /bin/sh\n \n machine=$1\n-destdir=$2\n+dest=$2\n \n-#    *-*-linux-* | \\\n+if test -z \"$dest\"\n+then\n+     echo \"No destination directory specified\"\n+     exit 1\n+fi\n+\n+echo constructing $dest for $machine\n \n case $machine in\n     alpha*-dec-vms* | \\\n@@ -34,9 +40,9 @@ case $machine in\n     powerpcle-*-winnt*  | \\\n     powerpcle-*-pe | \\\n     powerpcle-*-cygwin32  | \\\n+    *-*-linux-* | \\\n     *-*-gnu*    )\n-\t\techo fixinc for $machine disabled\n-        fixincludes=\n+        fixincludes=`basename $dest`\n         ;;\n \n     i[34567]86-dg-dgux* | \\\n@@ -71,7 +77,6 @@ case $machine in\n         fixincludes=fixinc.winnt\n         ;;\n \n-    alpha*-*-linux-gnulibc1* | \\\n     alpha*-*-netbsd* | \\\n     arm-*-netbsd* | \\\n     i[34567]86-*-freebsdelf* | \\\n@@ -88,14 +93,13 @@ case $machine in\n         ;;\n \n     *)\n-        fixincludes=generated\n+        fixincludes=`basename $dest`\n         ;;\n esac\n \n if test -z \"$fixincludes\"\n then\n-\t$MAKE install DESTDIR=$destdir\n-    cat > $destdir/fixinc.sh  <<-\t_EOF_\n+    cat > $dest  <<-\t_EOF_\n \t#! /bin/sh\n \texit 0\n \t_EOF_\n@@ -104,10 +108,12 @@ fi\n \n if test -f \"$fixincludes\"\n then\n-    cp $fixincludes $destdir/fixinc.sh\n+    echo copying $fixincludes to $dest\n+    cp $fixincludes $dest\n     exit 0\n fi\n \n-$MAKE install DESTDIR=$destdir\n+echo $MAKE install DESTDIR=`dirname $dest`\n+$MAKE install DESTDIR=`dirname $dest`\n \n exit 1"}]}