{"sha": "773d3c6477d7075ceeb01e4c910be24361ff6dcf", "node_id": "C_kwDOANBUbNoAKDc3M2QzYzY0NzdkNzA3NWNlZWIwMWU0YzkxMGJlMjQzNjFmZjZkY2Y", "commit": {"author": {"name": "mxlol233", "email": "mxlol233@outlook.com", "date": "2023-02-16T11:38:42Z"}, "committer": {"name": "CohenArthur", "email": "arthur.cohen@embecosm.com", "date": "2023-02-20T12:51:18Z"}, "message": "Add feature gate for \"rustc_attri\".\n\nThis commit implemented a basic feature gate to check some attributes\nfor `rustc_attri`.\n\ngcc/rust/ChangeLog:\n\n\t* checks/errors/rust-feature-gate.cc: Add implementations\n\tfor `rustc_attri`.\n\t* checks/errors/rust-feature-gate.h: Likewise.\n\ngcc/testsuite/ChangeLog:\n\n\t* rust/compile/builtin_macro_compile_error.rs: Add\n\tcrate feature `rustc_attri`.\n\t* rust/compile/builtin_macro_concat.rs: Likewise.\n\t* rust/compile/builtin_macro_eager1.rs: Likewise.\n\t* rust/compile/builtin_macro_eager2.rs: Likewise.\n\t* rust/compile/builtin_macro_env.rs: Likewise.\n\t* rust/compile/builtin_macro_include_bytes.rs:\n\tLikewise.\n\t* rust/compile/builtin_macro_include_str.rs:\n\tLikewise.\n\t* rust/compile/builtin_macro_not_found.rs:\n\tLikewise.\n\t* rust/compile/builtin_macro_recurse2.rs:\n\tLikewise.\n\t* rust/compile/feature_rust_attri0.rs:New file.\n\t* rust/compile/feature_rust_attri1.rs:New file.\n\t* rust/compile/include_empty.rs:Add crate feature\n\t`rustc_attri`.\n\t* rust/compile/issue-1830_bytes.rs:Likewise.\n\t* rust/compile/issue-1830_str.rs:Likewise.\n\t* rust/compile/macro42.rs:Likewise.\n\t* rust/execute/torture/builtin_macro_cfg.rs:\n\tLikewise.\n\t* rust/execute/torture/builtin_macro_concat.rs:\n\tLikewise.\n\t* rust/execute/torture/builtin_macro_env.rs:\n\tLikewise.\n\t* rust/execute/torture/builtin_macro_include_bytes.rs:\n\tLikewise.\n\t* rust/execute/torture/builtin_macro_include_str.rs:\n\tLikewise.\n\t* rust/execute/torture/builtin_macro_line.rs:\n\tLikewise.\n\t* rust/execute/torture/builtin_macros1.rs:\n\tLikewise.\n\t* rust/execute/torture/builtin_macros3.rs:\n\tLikewise.\n\t* rust/execute/torture/macros29.rs:Likewise.\n\t* rust/execute/torture/macros30.rs:Likewise.\n\t* rust/execute/torture/macros31.rs:Likewise.\n\nSigned-off-by: Xiao Ma <mxlol233@outlook.com>", "tree": {"sha": "eb63ea70e3d4a6050107b0ab66a75b8e78da6f33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/eb63ea70e3d4a6050107b0ab66a75b8e78da6f33"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/773d3c6477d7075ceeb01e4c910be24361ff6dcf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/773d3c6477d7075ceeb01e4c910be24361ff6dcf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/773d3c6477d7075ceeb01e4c910be24361ff6dcf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/773d3c6477d7075ceeb01e4c910be24361ff6dcf/comments", "author": {"login": "TuringKi", "id": 9394223, "node_id": "MDQ6VXNlcjkzOTQyMjM=", "avatar_url": "https://avatars.githubusercontent.com/u/9394223?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TuringKi", "html_url": "https://github.com/TuringKi", "followers_url": "https://api.github.com/users/TuringKi/followers", "following_url": "https://api.github.com/users/TuringKi/following{/other_user}", "gists_url": "https://api.github.com/users/TuringKi/gists{/gist_id}", "starred_url": "https://api.github.com/users/TuringKi/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TuringKi/subscriptions", "organizations_url": "https://api.github.com/users/TuringKi/orgs", "repos_url": "https://api.github.com/users/TuringKi/repos", "events_url": "https://api.github.com/users/TuringKi/events{/privacy}", "received_events_url": "https://api.github.com/users/TuringKi/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "15ca76ea868ccb9dbb0bd1a77f9b13746220499f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15ca76ea868ccb9dbb0bd1a77f9b13746220499f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15ca76ea868ccb9dbb0bd1a77f9b13746220499f"}], "stats": {"total": 135, "additions": 127, "deletions": 8}, "files": [{"sha": "9b2f025689f1f67b14993d4720989ad8b939f194", "filename": "gcc/rust/checks/errors/rust-feature-gate.cc", "status": "modified", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Frust%2Fchecks%2Ferrors%2Frust-feature-gate.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Frust%2Fchecks%2Ferrors%2Frust-feature-gate.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fchecks%2Ferrors%2Frust-feature-gate.cc?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -105,4 +105,54 @@ FeatureGate::visit (AST::ExternBlock &block)\n     }\n }\n \n+void\n+FeatureGate::check_rustc_attri (const std::vector<AST::Attribute> &attributes)\n+{\n+  for (const AST::Attribute &attr : attributes)\n+    {\n+      auto name = attr.get_path ().as_string ();\n+      if (name.rfind (\"rustc_\", 0) == 0)\n+\t{\n+\t  gate (Feature::Name::RUSTC_ATTRS, attr.get_locus (),\n+\t\t\"internal implementation detail\");\n+\t}\n+    }\n+}\n+\n+void\n+FeatureGate::visit (AST::MacroRulesDefinition &rules_def)\n+{\n+  check_rustc_attri (rules_def.get_outer_attrs ());\n+}\n+\n+void\n+FeatureGate::visit (AST::InherentImpl &impl)\n+{\n+  for (const auto &item : impl.get_impl_items ())\n+    {\n+      item->accept_vis (*this);\n+    }\n+}\n+\n+void\n+FeatureGate::visit (AST::TraitImpl &impl)\n+{\n+  for (const auto &item : impl.get_impl_items ())\n+    {\n+      item->accept_vis (*this);\n+    }\n+}\n+\n+void\n+FeatureGate::visit (AST::Method &method)\n+{\n+  check_rustc_attri (method.get_outer_attrs ());\n+}\n+\n+void\n+FeatureGate::visit (AST::Function &function)\n+{\n+  check_rustc_attri (function.get_outer_attrs ());\n+}\n+\n } // namespace Rust\n\\ No newline at end of file"}, {"sha": "2bdf4196a3738cad5d5fa3e9a184b6b1ff8e5dc9", "filename": "gcc/rust/checks/errors/rust-feature-gate.h", "status": "modified", "additions": 6, "deletions": 7, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Frust%2Fchecks%2Ferrors%2Frust-feature-gate.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Frust%2Fchecks%2Ferrors%2Frust-feature-gate.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Fchecks%2Ferrors%2Frust-feature-gate.h?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -25,8 +25,6 @@\n \n namespace Rust {\n \n-struct Feature;\n-\n class FeatureGate : public AST::ASTVisitor\n {\n public:\n@@ -109,14 +107,14 @@ class FeatureGate : public AST::ASTVisitor\n   void visit (AST::TypeParam &param) override {}\n   void visit (AST::LifetimeWhereClauseItem &item) override {}\n   void visit (AST::TypeBoundWhereClauseItem &item) override {}\n-  void visit (AST::Method &method) override {}\n+  void visit (AST::Method &method) override;\n   void visit (AST::Module &module) override {}\n   void visit (AST::ExternCrate &crate) override {}\n   void visit (AST::UseTreeGlob &use_tree) override {}\n   void visit (AST::UseTreeList &use_tree) override {}\n   void visit (AST::UseTreeRebind &use_tree) override {}\n   void visit (AST::UseDeclaration &use_decl) override {}\n-  void visit (AST::Function &function) override {}\n+  void visit (AST::Function &function) override;\n   void visit (AST::TypeAlias &type_alias) override {}\n   void visit (AST::StructStruct &struct_item) override {}\n   void visit (AST::TupleStruct &tuple_struct) override {}\n@@ -133,15 +131,15 @@ class FeatureGate : public AST::ASTVisitor\n   void visit (AST::TraitItemConst &item) override {}\n   void visit (AST::TraitItemType &item) override {}\n   void visit (AST::Trait &trait) override {}\n-  void visit (AST::InherentImpl &impl) override {}\n-  void visit (AST::TraitImpl &impl) override {}\n+  void visit (AST::InherentImpl &impl) override;\n+  void visit (AST::TraitImpl &impl) override;\n   void visit (AST::ExternalStaticItem &item) override {}\n   void visit (AST::ExternalFunctionItem &item) override {}\n   void visit (AST::ExternBlock &block) override;\n   void visit (AST::MacroMatchFragment &match) override {}\n   void visit (AST::MacroMatchRepetition &match) override {}\n   void visit (AST::MacroMatcher &matcher) override {}\n-  void visit (AST::MacroRulesDefinition &rules_def) override {}\n+  void visit (AST::MacroRulesDefinition &rules_def) override;\n   void visit (AST::MacroInvocation &macro_invoc) override {}\n   void visit (AST::MetaItemPath &meta_item) override {}\n   void visit (AST::MetaItemSeq &meta_item) override {}\n@@ -191,6 +189,7 @@ class FeatureGate : public AST::ASTVisitor\n \n private:\n   void gate (Feature::Name name, Location loc, const std::string &error_msg);\n+  void check_rustc_attri (const std::vector<AST::Attribute> &attributes);\n   std::set<Feature::Name> valid_features;\n };\n } // namespace Rust"}, {"sha": "b08f67f4fe6151a5a2b821b006790c17ecf2b739", "filename": "gcc/testsuite/rust/compile/builtin_macro_compile_error.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_compile_error.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_compile_error.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_compile_error.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! compile_error {\n   () => {{}};"}, {"sha": "28c84241129f3619610e42f31262349029db00c1", "filename": "gcc/testsuite/rust/compile/builtin_macro_concat.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_concat.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_concat.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_concat.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! concat {\n     () => {{}};"}, {"sha": "65a80fda62ef21a1b6488483d2b9f7294b3037be", "filename": "gcc/testsuite/rust/compile/builtin_macro_eager1.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_eager1.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_eager1.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_eager1.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,5 @@\n // { dg-additional-options \"-fdump-tree-gimple\" }\n+#![feature(rustc_attrs)]\n \n #[rustc_builtin_macro]\n macro_rules! concat {"}, {"sha": "70a92d5b04100e1741a161e622c5bd83b722c4e0", "filename": "gcc/testsuite/rust/compile/builtin_macro_eager2.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_eager2.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_eager2.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_eager2.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! env {\n     () => {};"}, {"sha": "83d3c2d6b28b75326335f0d837eda25021d556ed", "filename": "gcc/testsuite/rust/compile/builtin_macro_env.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_env.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_env.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_env.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! env {\n   () => {{}};"}, {"sha": "9972c10b49a4fa2039d10f6257721f19af560c66", "filename": "gcc/testsuite/rust/compile/builtin_macro_include_bytes.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_include_bytes.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_include_bytes.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_include_bytes.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! include_bytes {\n   () => {{}};"}, {"sha": "d6d7a76856f43ae0b30537addaf24a5985402621", "filename": "gcc/testsuite/rust/compile/builtin_macro_include_str.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_include_str.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_include_str.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_include_str.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! include_str {\n   () => {{}};"}, {"sha": "5ba7fc08a18655d9c19fd6ff66f3b29d5558686c", "filename": "gcc/testsuite/rust/compile/builtin_macro_not_found.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_not_found.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_not_found.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_not_found.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! crabby_crab_carb { // { dg-error \"cannot find a built-in macro with name .crabby_crab_carb.\" }\n     () => {{}};"}, {"sha": "2e73ab54fb6032c43cf59421ca84c7afa6861dd6", "filename": "gcc/testsuite/rust/compile/builtin_macro_recurse2.rs", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_recurse2.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_recurse2.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fbuiltin_macro_recurse2.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,5 @@\n // { dg-additional-options \"-fdump-tree-gimple\" }\n+#![feature(rustc_attrs)]\n \n #[rustc_builtin_macro]\n macro_rules! concat {"}, {"sha": "9c11f561b5b65504d9a969dd141394828e1e56d6", "filename": "gcc/testsuite/rust/compile/feature_rust_attri0.rs", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Ffeature_rust_attri0.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Ffeature_rust_attri0.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Ffeature_rust_attri0.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -0,0 +1,11 @@\n+#[rustc_builtin_macro] //{ dg-error \"internal implementation detail. \" \"\" { target *-*-* }  }\n+macro_rules! line {\n+    () => {{}};\n+}\n+\n+fn main() -> i32 {\n+    let a = line!();\n+    print(a);\n+\n+    0\n+}"}, {"sha": "ec4e7d5be543bdd79ef153e34bb3da7358772154", "filename": "gcc/testsuite/rust/compile/feature_rust_attri1.rs", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Ffeature_rust_attri1.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Ffeature_rust_attri1.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Ffeature_rust_attri1.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -0,0 +1,13 @@\n+\n+pub struct NotI8(i8);\n+\n+impl NotI8 {\n+    #[rustc_inherit_overflow_checks] //{ dg-error \"internal implementation detail\" \"\" { target *-*-* }  }\n+    pub fn add(self, other: NotI8) -> NotI8 {\n+        NotI8(self.0 + other.0)\n+    }\n+}\n+\n+fn main() -> i32 {\n+    0\n+}"}, {"sha": "02c2d2e18559d90476558c78a842ad0c22e5732d", "filename": "gcc/testsuite/rust/compile/include_empty.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Finclude_empty.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Finclude_empty.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Finclude_empty.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! include {\n     () => {};"}, {"sha": "24b69334deee9f9ff95c4713ab845d87435ed8fd", "filename": "gcc/testsuite/rust/compile/issue-1830_bytes.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1830_bytes.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1830_bytes.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1830_bytes.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! include_bytes {\n     () => {{}};"}, {"sha": "ce4a6a94118f2108d5e5a26424d96e487255f7eb", "filename": "gcc/testsuite/rust/compile/issue-1830_str.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1830_str.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1830_str.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1830_str.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,3 +1,5 @@\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! include_str {\n     () => {{}};"}, {"sha": "b3fbf6d6eb9b10760c0ce2049453015343f5c7ec", "filename": "gcc/testsuite/rust/compile/macro42.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fmacro42.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fcompile%2Fmacro42.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fmacro42.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-additional-options \"-w -frust-cfg=A\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! cfg {\n     () => {{}};"}, {"sha": "92343e566123658af89fd72b7a789e4d20649814", "filename": "gcc/testsuite/rust/execute/torture/builtin_macro_cfg.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_cfg.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_cfg.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_cfg.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,5 +1,7 @@\n // { dg-additional-options \"-w -frust-cfg=A\" }\n // { dg-output \"A\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! cfg {\n     () => {{}};"}, {"sha": "2470b7559cb9b3cb444db7050cda134669c21db9", "filename": "gcc/testsuite/rust/execute/torture/builtin_macro_concat.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_concat.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_concat.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_concat.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-output \"\\r*\\ntest10btrue2.15\\r*\\ntest10bfalse2.151\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! concat {\n     () => {{}};"}, {"sha": "5bad4dee63c1a1700601f2bcc925e07047438964", "filename": "gcc/testsuite/rust/execute/torture/builtin_macro_env.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_env.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_env.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_env.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,5 +1,7 @@\n // { dg-output \"VALUE\\r*\\nVALUE\\r*\\n\" }\n // { dg-set-compiler-env-var ENV_MACRO_TEST \"VALUE\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! env {\n     () => {{}};"}, {"sha": "19a1faff11cc8941909f59faf67978c220ce1554", "filename": "gcc/testsuite/rust/execute/torture/builtin_macro_include_bytes.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_include_bytes.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_include_bytes.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_include_bytes.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-output \"104\\r*\\n33\\r*\\n1\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! include_bytes {\n     () => {{}};"}, {"sha": "a65639dcba1fd940dae375691662badd53568e7e", "filename": "gcc/testsuite/rust/execute/torture/builtin_macro_include_str.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_include_str.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_include_str.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_include_str.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-output \"hello, include!\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! include_str {\n     () => {{}};"}, {"sha": "dd7dd4e5f5bb89849a30bdb7b5b61b5adb3193ae", "filename": "gcc/testsuite/rust/execute/torture/builtin_macro_line.rs", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_line.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_line.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macro_line.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n-// { dg-output \"18\\r*\\n21\\r*\\n\" }\n+// { dg-output \"20\\r*\\n23\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n extern \"C\" {\n     fn printf(fmt: *const i8, ...);\n }"}, {"sha": "f5dcbd6423c5f1e4f2f44b53e5eee22d2a036a37", "filename": "gcc/testsuite/rust/execute/torture/builtin_macros1.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macros1.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macros1.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macros1.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-output \"rust/execute/torture/builtin_macros1.rs\\r*\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! file {\n     () => {{}};"}, {"sha": "85a0c6db70561a96b94192543a32283836b2ae61", "filename": "gcc/testsuite/rust/execute/torture/builtin_macros3.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macros3.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macros3.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fbuiltin_macros3.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-output \"14\\r*\\n42\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! column {\n     () => {{}};"}, {"sha": "817ac67e675715273e3bd60126080cb565a9e8bd", "filename": "gcc/testsuite/rust/execute/torture/macros29.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros29.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros29.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros29.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-output \"1\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! concat {\n     () => {{}};"}, {"sha": "4dd0a5531d4eadfb5a4ca952ede8cdd2bdc652b3", "filename": "gcc/testsuite/rust/execute/torture/macros30.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros30.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros30.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros30.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,4 +1,6 @@\n // { dg-output \"1\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! concat {\n     () => {{}};"}, {"sha": "0a256c36a4fcdd736764ecb13d2564f137174843", "filename": "gcc/testsuite/rust/execute/torture/macros31.rs", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros31.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/773d3c6477d7075ceeb01e4c910be24361ff6dcf/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros31.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fexecute%2Ftorture%2Fmacros31.rs?ref=773d3c6477d7075ceeb01e4c910be24361ff6dcf", "patch": "@@ -1,5 +1,7 @@\n // { dg-additional-options \"-w -frust-cfg=A\" }\n // { dg-output \"A\\r*\\nB\\r*\\n\" }\n+#![feature(rustc_attrs)]\n+\n #[rustc_builtin_macro]\n macro_rules! cfg {\n     () => {{}};"}]}