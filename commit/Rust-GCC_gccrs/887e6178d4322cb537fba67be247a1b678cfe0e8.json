{"sha": "887e6178d4322cb537fba67be247a1b678cfe0e8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODg3ZTYxNzhkNDMyMmNiNTM3ZmJhNjdiZTI0N2ExYjY3OGNmZTBlOA==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2008-10-24T02:44:26Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2008-10-24T02:44:26Z"}, "message": "re PR java/35485 (libjava is disabled by default)\n\n        PR target/35485\n        * configure.ac: AIX threads are Posix threads.\n        Set signal handler to aix-signal.h\n        * configure: Regenerate.\n        * classpath/native/fdlibm/fdlibm.h: Undef hz.\n        * include/aix-signal.h: New file.\n        * sysdep/powerpc/locks.h: Avoid GNU Assembler syntax.\n\nFrom-SVN: r141335", "tree": {"sha": "cdff866a281ed7a6ebc131100612f4a22c136c64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cdff866a281ed7a6ebc131100612f4a22c136c64"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/887e6178d4322cb537fba67be247a1b678cfe0e8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/887e6178d4322cb537fba67be247a1b678cfe0e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/887e6178d4322cb537fba67be247a1b678cfe0e8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/887e6178d4322cb537fba67be247a1b678cfe0e8/comments", "author": null, "committer": null, "parents": [{"sha": "dec014a92e97c6bdd72ed0406f9b245319189d33", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dec014a92e97c6bdd72ed0406f9b245319189d33", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dec014a92e97c6bdd72ed0406f9b245319189d33"}], "stats": {"total": 94, "additions": 83, "deletions": 11}, "files": [{"sha": "d6687afcb4539a9ea3b7130a91cf9717f056893e", "filename": "libjava/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=887e6178d4322cb537fba67be247a1b678cfe0e8", "patch": "@@ -1,3 +1,13 @@\n+2008-10-23  David Edelsohn  <edelsohn@gnu.org>\n+\n+\tPR target/35485\n+\t* configure.ac: AIX threads are Posix threads.\n+\tSet signal handler to aix-signal.h\n+\t* configure: Regenerate.\n+\t* classpath/native/fdlibm/fdlibm.h: Undef hz.\n+\t* include/aix-signal.h: New file.\n+\t* sysdep/powerpc/locks.h: Avoid GNU Assembler syntax.\n+\n 2008-10-22  Matthias Klose  <doko@ubuntu.com>\n \n \tImport GNU Classpath (libgcj-import-20081021)."}, {"sha": "fc10ecc9ce481256534edc6c91176b44ac3d3277", "filename": "libjava/classpath/native/fdlibm/fdlibm.h", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fclasspath%2Fnative%2Ffdlibm%2Ffdlibm.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fclasspath%2Fnative%2Ffdlibm%2Ffdlibm.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fclasspath%2Fnative%2Ffdlibm%2Ffdlibm.h?ref=887e6178d4322cb537fba67be247a1b678cfe0e8", "patch": "@@ -24,6 +24,14 @@\n #include <config.h>\n #include <stdlib.h>\n \n+/*\n+ * AIX includes a header that defines hz,\n+ * which conflicts with an fdlibm variable in some functions.\n+ */\n+#ifdef _AIX\n+#undef hz\n+#endif\n+\n /* GCJ LOCAL: Include files.  */\n #include \"ieeefp.h\"\n /* CLASSPATH LOCAL: */"}, {"sha": "225ffa6d32f498b540160a68232a791fb5550037", "filename": "libjava/configure", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure?ref=887e6178d4322cb537fba67be247a1b678cfe0e8", "patch": "@@ -20711,7 +20711,7 @@ case \"$THREADS\" in\n  no | none | single)\n     THREADS=none\n     ;;\n- posix | posix95 | pthreads)\n+ aix | posix | posix95 | pthreads)\n     THREADS=posix\n     case \"$host\" in\n      *-*-linux*)\n@@ -27510,6 +27510,9 @@ case \"${host}\" in\n  powerpc*-*-darwin* | i?86-*-darwin9* | x86_64-*-darwin9*)\n     SIGNAL_HANDLER=include/darwin-signal.h\n     ;;\n+ powerpc*-*-aix*)\n+    SIGNAL_HANDLER=include/aix-signal.h\n+    ;;\n  *)\n     SIGNAL_HANDLER=include/default-signal.h\n     ;;"}, {"sha": "db131b68027a98ba0aabac47d504965841b4758e", "filename": "libjava/configure.ac", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure.ac?ref=887e6178d4322cb537fba67be247a1b678cfe0e8", "patch": "@@ -938,7 +938,7 @@ case \"$THREADS\" in\n  no | none | single)\n     THREADS=none\n     ;;\n- posix | posix95 | pthreads)\n+ aix | posix | posix95 | pthreads)\n     THREADS=posix\n     case \"$host\" in\n      *-*-linux*)\n@@ -1634,6 +1634,9 @@ case \"${host}\" in\n  powerpc*-*-darwin* | i?86-*-darwin9* | x86_64-*-darwin9*)\n     SIGNAL_HANDLER=include/darwin-signal.h\n     ;;\n+ powerpc*-*-aix*)\n+    SIGNAL_HANDLER=include/aix-signal.h\n+    ;;\n  *)\n     SIGNAL_HANDLER=include/default-signal.h\n     ;;"}, {"sha": "abf37229235a1862cde65282015e37867c945107", "filename": "libjava/include/aix-signal.h", "status": "added", "additions": 50, "deletions": 0, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Finclude%2Faix-signal.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Finclude%2Faix-signal.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Finclude%2Faix-signal.h?ref=887e6178d4322cb537fba67be247a1b678cfe0e8", "patch": "@@ -0,0 +1,50 @@\n+/* aix-signal.h - Catch runtime signals and turn them into exceptions,\n+   on a Darwin system.  */\n+\n+/* Copyright (C) 2008  Free Software Foundation\n+\n+   This file is part of libgcj.\n+\n+This software is copyrighted work licensed under the terms of the\n+Libgcj License.  Please consult the file \"LIBGCJ_LICENSE\" for\n+details.  */\n+\n+/* This file is really more of a specification.  The rest of the system\n+   should be arranged so that this Just Works.  */\n+\n+#ifndef JAVA_SIGNAL_H\n+# define JAVA_SIGNAL_H 1\n+\n+#include <sys/types.h>\n+#include <sys/signal.h>\n+\n+typedef void (* SIG_PF)(int);\n+\n+# define HANDLE_SEGV 1\n+# undef HANDLE_FPE\n+\n+# define SIGNAL_HANDLER(_name)\t\t\t\t\t\\\n+  static void _name (int _dummy __attribute__ ((unused)))\n+\n+# define MAKE_THROW_FRAME(_exception)\n+\n+# define INIT_SEGV\t\t\t\t\\\n+  do {\t\t\t\t\t\t\\\n+      struct sigaction sa;\t\t\t\\\n+      sa.sa_handler = catch_segv;\t\t\\\n+      sigemptyset (&sa.sa_mask);\t\t\\\n+      sa.sa_flags = SA_NODEFER;\t\t\t\\\n+      sigaction (SIGBUS, &sa, NULL);\t\t\\\n+      sigaction (SIGSEGV, &sa, NULL);\t\t\\\n+    } while (0)\n+\n+# define INIT_FPE\t\t\t\t\\\n+  do {\t\t\t\t\t\t\\\n+      struct sigaction sa;\t\t\t\\\n+      sa.sa_handler = catch_fpe;\t\t\\\n+      sigemptyset (&sa.sa_mask);\t\t\\\n+      sa.sa_flags = SA_NODEFER;\t\t\t\\\n+      sigaction (SIGFPE, &sa, NULL);\t\t\\\n+    } while (0)\n+\n+#endif /* JAVA_SIGNAL_H */"}, {"sha": "2e9eb0eb36c87d96803c606f834bcf594e295937", "filename": "libjava/sysdep/powerpc/locks.h", "status": "modified", "additions": 7, "deletions": 9, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fsysdep%2Fpowerpc%2Flocks.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/887e6178d4322cb537fba67be247a1b678cfe0e8/libjava%2Fsysdep%2Fpowerpc%2Flocks.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fsysdep%2Fpowerpc%2Flocks.h?ref=887e6178d4322cb537fba67be247a1b678cfe0e8", "patch": "@@ -1,6 +1,6 @@\n // locks.h - Thread synchronization primitives. PowerPC implementation.\n \n-/* Copyright (C) 2002  Free Software Foundation\n+/* Copyright (C) 2002,2008  Free Software Foundation\n \n    This file is part of libgcj.\n \n@@ -33,12 +33,11 @@ compare_and_swap (volatile obj_addr_t *addr, obj_addr_t old,\n   obj_addr_t ret;\n \n   __asm__ __volatile__ (\n-\t   \"0:    \" _LARX \"%0,0,%1 \\n\"\n+\t   \"      \" _LARX \"%0,0,%1 \\n\"\n \t   \"      xor. %0,%3,%0\\n\"\n-\t   \"      bne 1f\\n\"\n+\t   \"      bne $+12\\n\"\n \t   \"      \" _STCX \"%2,0,%1\\n\"\n-\t   \"      bne- 0b\\n\"\n-\t   \"1:   \\n\"\n+\t   \"      bne- $-16\\n\"\n \t: \"=&r\" (ret)\n \t: \"r\" (addr), \"r\" (new_val), \"r\" (old)\n \t: \"cr0\", \"memory\");\n@@ -67,12 +66,11 @@ compare_and_swap_release (volatile obj_addr_t *addr, obj_addr_t old,\n   __asm__ __volatile__ (\"sync\" : : : \"memory\");\n \n   __asm__ __volatile__ (\n-\t   \"0:    \" _LARX \"%0,0,%1 \\n\"\n+\t   \"      \" _LARX \"%0,0,%1 \\n\"\n \t   \"      xor. %0,%3,%0\\n\"\n-\t   \"      bne 1f\\n\"\n+\t   \"      bne $+12\\n\"\n \t   \"      \" _STCX \"%2,0,%1\\n\"\n-\t   \"      bne- 0b\\n\"\n-\t   \"1:   \\n\"\n+\t   \"      bne- $-16\\n\"\n \t: \"=&r\" (ret)\n \t: \"r\" (addr), \"r\" (new_val), \"r\" (old)\n \t: \"cr0\", \"memory\");"}]}