{"sha": "c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzE2YWM5OGVhOWNkZGI0NzI1ZGQ1YzZkMDEwYmRlYWFjMTRkMWEyNQ==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2018-10-08T09:11:03Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2018-10-08T09:11:03Z"}, "message": "re PR fortran/86372 (Segfault on ASSOCIATE statement with CHARACTER variable)\n\n2018-10-08  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/86372\n\t* trans-stmt.c (trans_associate_var): Character associate names\n\twith variable string length do not have to be deferred length\n\tfor the string length to be set, if variable.\n\n2018-10-08  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/86372\n\t* gfortran.dg/associate_41.f90: New test.\n\nFrom-SVN: r264915", "tree": {"sha": "c41120f5224f3a10a68aed3140ae1ffa65488929", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c41120f5224f3a10a68aed3140ae1ffa65488929"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25/comments", "author": null, "committer": null, "parents": [{"sha": "a52cdecf114f4f1e5acbdeeb28b9381875a4b9a8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a52cdecf114f4f1e5acbdeeb28b9381875a4b9a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a52cdecf114f4f1e5acbdeeb28b9381875a4b9a8"}], "stats": {"total": 26, "additions": 25, "deletions": 1}, "files": [{"sha": "6256e3fa805f699c6330f2a8cfe1024670500f01", "filename": "gcc/fortran/trans-stmt.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25/gcc%2Ffortran%2Ftrans-stmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25/gcc%2Ffortran%2Ftrans-stmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-stmt.c?ref=c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25", "patch": "@@ -1885,7 +1885,6 @@ trans_associate_var (gfc_symbol *sym, gfc_wrapped_block *block)\n \t}\n \n       if (sym->ts.type == BT_CHARACTER\n-\t  && sym->ts.deferred\n \t  && !sym->attr.select_type_temporary\n \t  && VAR_P (sym->ts.u.cl->backend_decl)\n \t  && se.string_length != sym->ts.u.cl->backend_decl)"}, {"sha": "9177582a5fcbce85f305b811d5fa000047bf2844", "filename": "gcc/testsuite/gfortran.dg/associate_41.f90", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_41.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_41.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fassociate_41.f90?ref=c16ac98ea9cddb4725dd5c6d010bdeaac14d1a25", "patch": "@@ -0,0 +1,25 @@\n+! { dg-do run }\n+!\n+! Test the fix for PR86372 in which the associate name string length was\n+! not being set, thereby causing a segfault.\n+!\n+! Contributed by Janus Weil  <janus@gcc.gnu.org>\n+!\n+program xxx\n+\n+   character(len=50) :: s\n+\n+   s = repeat ('*', len(s))\n+   call sub(s)\n+   if (s .ne. '**'//'123'//repeat ('*', len(s) - 5)) stop 1\n+\n+contains\n+\n+   subroutine sub(str)\n+      character(len=*), intent(inout) :: str\n+      associate (substr => str(3:5))\n+         substr = '123'\n+      end associate\n+   end subroutine\n+\n+end"}]}