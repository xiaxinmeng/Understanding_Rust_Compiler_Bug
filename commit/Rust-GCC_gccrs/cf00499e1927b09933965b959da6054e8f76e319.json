{"sha": "cf00499e1927b09933965b959da6054e8f76e319", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2YwMDQ5OWUxOTI3YjA5OTMzOTY1Yjk1OWRhNjA1NGU4Zjc2ZTMxOQ==", "commit": {"author": {"name": "John David Anglin", "email": "dave.anglin@nrc-cnrc.gc.ca", "date": "2010-08-08T15:04:38Z"}, "committer": {"name": "John David Anglin", "email": "danglin@gcc.gnu.org", "date": "2010-08-08T15:04:38Z"}, "message": "re PR boehm-gc/34544 (pthread_default_stacksize_np failed.)\n\n\tPR boehm-gc/34544\n\t* gthr-posix.h (__gthread_start): Delete.\n\t(__gthread_active_init): Use pthread_default_stacksize_np instead of\n\tpthread_create to determine if hpux pthreads are active.\n\t* gthr-posix95.h (__gthread_start): Delete.\n\t(__gthread_active_init): Likewise use pthread_default_stacksize_np.\n\nFrom-SVN: r163003", "tree": {"sha": "27d3b82d21dd8bcbe0c49eef67e5a230f30cba82", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/27d3b82d21dd8bcbe0c49eef67e5a230f30cba82"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cf00499e1927b09933965b959da6054e8f76e319", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf00499e1927b09933965b959da6054e8f76e319", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cf00499e1927b09933965b959da6054e8f76e319", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cf00499e1927b09933965b959da6054e8f76e319/comments", "author": null, "committer": null, "parents": [{"sha": "71234632dd6ff182f7ce6ed2fe250d3f40038c81", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71234632dd6ff182f7ce6ed2fe250d3f40038c81", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71234632dd6ff182f7ce6ed2fe250d3f40038c81"}], "stats": {"total": 49, "additions": 15, "deletions": 34}, "files": [{"sha": "e4ce02754ac7be0068083ba8225cb6c50e1cb10c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf00499e1927b09933965b959da6054e8f76e319/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf00499e1927b09933965b959da6054e8f76e319/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cf00499e1927b09933965b959da6054e8f76e319", "patch": "@@ -1,3 +1,12 @@\n+2010-08-08  John David Anglin  <dave.anglin@nrc-cnrc.gc.ca>\n+\n+\tPR boehm-gc/34544\n+\t* gthr-posix.h (__gthread_start): Delete.\n+\t(__gthread_active_init): Use pthread_default_stacksize_np instead of\n+\tpthread_create to determine if hpux pthreads are active.\n+\t* gthr-posix95.h (__gthread_start): Delete.\n+\t(__gthread_active_init): Likewise use pthread_default_stacksize_np.\n+\n 2010-08-08  Kai Tietz  <kai.tietz@onevision.com>\n \n \t* config/i386/mingw32.h ((EXTRA_OS_CPP_BUILTINS): Define"}, {"sha": "f7f240f5275fcc144bfb3dbb2b5ce808e7cec5ad", "filename": "gcc/gthr-posix.h", "status": "modified", "additions": 3, "deletions": 17, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf00499e1927b09933965b959da6054e8f76e319/gcc%2Fgthr-posix.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf00499e1927b09933965b959da6054e8f76e319/gcc%2Fgthr-posix.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgthr-posix.h?ref=cf00499e1927b09933965b959da6054e8f76e319", "patch": "@@ -273,32 +273,18 @@ __gthread_active_p (void)\n \n static volatile int __gthread_active = -1;\n \n-static void *\n-__gthread_start (void *__arg __attribute__((unused)))\n-{\n-  return NULL;\n-}\n-\n static void __gthread_active_init (void) __attribute__((noinline));\n static void\n __gthread_active_init (void)\n {\n   static pthread_mutex_t __gthread_active_mutex = PTHREAD_MUTEX_INITIALIZER;\n-  pthread_t __t;\n-  pthread_attr_t __a;\n-  int __result;\n+  size_t __s;\n \n   __gthrw_(pthread_mutex_lock) (&__gthread_active_mutex);\n   if (__gthread_active < 0)\n     {\n-      __gthrw_(pthread_attr_init) (&__a);\n-      __gthrw_(pthread_attr_setdetachstate) (&__a, PTHREAD_CREATE_DETACHED);\n-      __result = __gthrw_(pthread_create) (&__t, &__a, __gthread_start, NULL);\n-      if (__result != ENOSYS)\n-\t__gthread_active = 1;\n-      else\n-\t__gthread_active = 0;\n-      __gthrw_(pthread_attr_destroy) (&__a);\n+      pthread_default_stacksize_np (0, &__s);\n+      __gthread_active = __s ? 1 : 0;\n     }\n   __gthrw_(pthread_mutex_unlock) (&__gthread_active_mutex);\n }"}, {"sha": "d0e0f995f1bb14d3cff989375cad62d491c6f666", "filename": "gcc/gthr-posix95.h", "status": "modified", "additions": 3, "deletions": 17, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cf00499e1927b09933965b959da6054e8f76e319/gcc%2Fgthr-posix95.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cf00499e1927b09933965b959da6054e8f76e319/gcc%2Fgthr-posix95.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgthr-posix95.h?ref=cf00499e1927b09933965b959da6054e8f76e319", "patch": "@@ -197,32 +197,18 @@ __gthread_active_p (void)\n \n static volatile int __gthread_active = -1;\n \n-static void *\n-__gthread_start (void *arg __attribute__((unused)))\n-{\n-  return NULL;\n-}\n-\n static void __gthread_active_init (void) __attribute__((noinline));\n static void\n __gthread_active_init (void)\n {\n   static pthread_mutex_t __gthread_active_mutex = PTHREAD_MUTEX_INITIALIZER;\n-  pthread_t t;\n-  pthread_attr_t a;\n-  int result;\n+  size_t __s;\n \n   __gthrw_(pthread_mutex_lock) (&__gthread_active_mutex);\n   if (__gthread_active < 0)\n     {\n-      __gthrw_(pthread_attr_init) (&a);\n-      __gthrw_(pthread_attr_setdetachstate) (&a, PTHREAD_CREATE_DETACHED);\n-      result = __gthrw_(pthread_create) (&t, &a, __gthread_start, NULL);\n-      if (result != ENOSYS)\n-\t__gthread_active = 1;\n-      else\n-\t__gthread_active = 0;\n-      __gthrw_(pthread_attr_destroy) (&a);\n+      pthread_default_stacksize_np (0, &__s);\n+      __gthread_active = __s ? 1 : 0;\n     }\n   __gthrw_(pthread_mutex_unlock) (&__gthread_active_mutex);\n }"}]}