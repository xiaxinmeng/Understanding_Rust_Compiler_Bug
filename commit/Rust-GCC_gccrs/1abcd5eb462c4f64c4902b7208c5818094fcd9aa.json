{"sha": "1abcd5eb462c4f64c4902b7208c5818094fcd9aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWFiY2Q1ZWI0NjJjNGY2NGM0OTAyYjcyMDhjNTgxODA5NGZjZDlhYQ==", "commit": {"author": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2013-01-11T16:43:49Z"}, "committer": {"name": "Andreas Krebbel", "email": "krebbel@gcc.gnu.org", "date": "2013-01-11T16:43:49Z"}, "message": "re PR rtl-optimization/55719 (ICE: Segmentation fault)\n\n2013-01-11  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n\n\tPR target/55719\n\t* config/s390/s390.c (s390_preferred_reload_class): Do not return\n\tNO_REGS for larl operands.\n\t(s390_reload_larl_operand): Use s390_load_address instead of\n\temit_move_insn.\n\n2013-01-11  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n\n\tPR target/55719\n\t* gcc.target/s390/pr55719.c: New testcase.\n\nFrom-SVN: r195109", "tree": {"sha": "209eef02337ad23839d03aa0a337cf669e303aa1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/209eef02337ad23839d03aa0a337cf669e303aa1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1abcd5eb462c4f64c4902b7208c5818094fcd9aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1abcd5eb462c4f64c4902b7208c5818094fcd9aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1abcd5eb462c4f64c4902b7208c5818094fcd9aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1abcd5eb462c4f64c4902b7208c5818094fcd9aa/comments", "author": null, "committer": null, "parents": [{"sha": "980d0812968529871862dc695ec3b013204e12dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/980d0812968529871862dc695ec3b013204e12dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/980d0812968529871862dc695ec3b013204e12dd"}], "stats": {"total": 33, "additions": 30, "deletions": 3}, "files": [{"sha": "238ec2f4b1dd2fca81109397077e4c5f207f01e7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abcd5eb462c4f64c4902b7208c5818094fcd9aa/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abcd5eb462c4f64c4902b7208c5818094fcd9aa/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1abcd5eb462c4f64c4902b7208c5818094fcd9aa", "patch": "@@ -1,3 +1,11 @@\n+2013-01-11  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n+\n+\tPR target/55719\n+\t* config/s390/s390.c (s390_preferred_reload_class): Do not return\n+\tNO_REGS for larl operands.\n+\t(s390_reload_larl_operand): Use s390_load_address instead of\n+\temit_move_insn.\n+\n 2013-01-11  Richard Biener  <rguenther@suse.de>\n \n \t* tree-cfg.c (verify_node_sharing_1): Split out from ..."}, {"sha": "7e87dcd547d2ffa6cfdf241707189bf21a8dd738", "filename": "gcc/config/s390/s390.c", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abcd5eb462c4f64c4902b7208c5818094fcd9aa/gcc%2Fconfig%2Fs390%2Fs390.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abcd5eb462c4f64c4902b7208c5818094fcd9aa/gcc%2Fconfig%2Fs390%2Fs390.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fs390%2Fs390.c?ref=1abcd5eb462c4f64c4902b7208c5818094fcd9aa", "patch": "@@ -2978,9 +2978,23 @@ s390_preferred_reload_class (rtx op, reg_class_t rclass)\n \t it is most likely being used as an address, so\n \t prefer ADDR_REGS.  If 'class' is not a superset\n \t of ADDR_REGS, e.g. FP_REGS, reject this reload.  */\n+      case CONST:\n+\t/* A larl operand with odd addend will get fixed via secondary\n+\t   reload.  So don't request it to be pushed into literal\n+\t   pool.  */\n+\tif (TARGET_CPU_ZARCH\n+\t    && GET_CODE (XEXP (op, 0)) == PLUS\n+\t    && GET_CODE (XEXP (XEXP(op, 0), 0)) == SYMBOL_REF\n+\t    && GET_CODE (XEXP (XEXP(op, 0), 1)) == CONST_INT)\n+\t  {\n+\t    if (reg_class_subset_p (ADDR_REGS, rclass))\n+\t      return ADDR_REGS;\n+\t    else\n+\t      return NO_REGS;\n+\t  }\n+\t/* fallthrough */\n       case LABEL_REF:\n       case SYMBOL_REF:\n-      case CONST:\n \tif (!legitimate_reload_constant_p (op))\n           return NO_REGS;\n \t/* fallthrough */\n@@ -3061,7 +3075,7 @@ s390_reload_larl_operand (rtx reg, rtx addr, rtx scratch)\n \temit_move_insn (scratch, symref);\n \n       /* Increment the address using la in order to avoid clobbering cc.  */\n-      emit_move_insn (reg, gen_rtx_PLUS (Pmode, scratch, const1_rtx));\n+      s390_load_address (reg, gen_rtx_PLUS (Pmode, scratch, const1_rtx));\n     }\n }\n "}, {"sha": "2d463399120a8ea0346c1df7d84c85c8611ce0dc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1abcd5eb462c4f64c4902b7208c5818094fcd9aa/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1abcd5eb462c4f64c4902b7208c5818094fcd9aa/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1abcd5eb462c4f64c4902b7208c5818094fcd9aa", "patch": "@@ -1,4 +1,9 @@\n-2012-01-11  Richard Guenther  <rguenther@suse.de>\n+2013-01-11  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n+\n+\tPR target/55719\n+\t* gcc.target/s390/pr55719.c: New testcase.\n+\n+2013-01-11  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/44061\n \t* gcc.dg/pr44061.c: New testcase."}]}