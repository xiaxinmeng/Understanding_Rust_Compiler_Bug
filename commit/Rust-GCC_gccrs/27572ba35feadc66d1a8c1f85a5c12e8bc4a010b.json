{"sha": "27572ba35feadc66d1a8c1f85a5c12e8bc4a010b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjc1NzJiYTM1ZmVhZGM2NmQxYThjMWY4NWE1YzEyZThiYzRhMDEwYg==", "commit": {"author": {"name": "Yannick Moy", "email": "moy@adacore.com", "date": "2019-07-10T09:01:53Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-10T09:01:53Z"}, "message": "[Ada] Allow multiple units per file in GNATprove\n\nFor analysis tools that rely on information generated in ALI files, but\ndo not generate object files, the frontend did not generate the special\nextension names like file~2.ali for unit 2 in the file. This is needed\nto be able to analyze files with multiple units. Now fixed.\n\nThere is no impact on compilation.\n\n2019-07-10  Yannick Moy  <moy@adacore.com>\n\ngcc/ada/\n\n\t* osint-c.adb (Set_File_Name): Always add extension for multiple\n\tunits per file mode.\n\nFrom-SVN: r273339", "tree": {"sha": "62870c05e46a075faf6782da3e97ad23f66a96e2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/62870c05e46a075faf6782da3e97ad23f66a96e2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b/comments", "author": {"login": "yannickmoy", "id": 859440, "node_id": "MDQ6VXNlcjg1OTQ0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/859440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yannickmoy", "html_url": "https://github.com/yannickmoy", "followers_url": "https://api.github.com/users/yannickmoy/followers", "following_url": "https://api.github.com/users/yannickmoy/following{/other_user}", "gists_url": "https://api.github.com/users/yannickmoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/yannickmoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yannickmoy/subscriptions", "organizations_url": "https://api.github.com/users/yannickmoy/orgs", "repos_url": "https://api.github.com/users/yannickmoy/repos", "events_url": "https://api.github.com/users/yannickmoy/events{/privacy}", "received_events_url": "https://api.github.com/users/yannickmoy/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "9ab234e531354d939c2105e8005153d7554f7cdd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9ab234e531354d939c2105e8005153d7554f7cdd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9ab234e531354d939c2105e8005153d7554f7cdd"}], "stats": {"total": 35, "additions": 20, "deletions": 15}, "files": [{"sha": "2e5739892570f7b7cd4eae2e0a930e1d5e8bfeeb", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=27572ba35feadc66d1a8c1f85a5c12e8bc4a010b", "patch": "@@ -1,3 +1,8 @@\n+2019-07-10  Yannick Moy  <moy@adacore.com>\n+\n+\t* osint-c.adb (Set_File_Name): Always add extension for multiple\n+\tunits per file mode.\n+\n 2019-07-10  Corentin Gay  <gay@adacore.com>\n \n \t* sysdep.c: Put include directive for 'vxWorks.h' before any"}, {"sha": "9fb9ee3c170938ec7c1c5bdf1f132f338d08b4ea", "filename": "gcc/ada/osint-c.adb", "status": "modified", "additions": 15, "deletions": 15, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b/gcc%2Fada%2Fosint-c.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/27572ba35feadc66d1a8c1f85a5c12e8bc4a010b/gcc%2Fada%2Fosint-c.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fosint-c.adb?ref=27572ba35feadc66d1a8c1f85a5c12e8bc4a010b", "patch": "@@ -385,6 +385,21 @@ package body Osint.C is\n          end if;\n       end loop;\n \n+      --  If we are in multiple-units-per-file mode, then add a ~nnn extension\n+      --  to the name.\n+\n+      if Multiple_Unit_Index /= 0 then\n+         declare\n+            Exten : constant String := Name_Buffer (Dot_Index .. Name_Len);\n+         begin\n+            Name_Len := Dot_Index - 1;\n+            Add_Char_To_Name_Buffer (Multi_Unit_Index_Character);\n+            Add_Nat_To_Name_Buffer (Multiple_Unit_Index);\n+            Dot_Index := Name_Len + 1;\n+            Add_Str_To_Name_Buffer (Exten);\n+         end;\n+      end if;\n+\n       --  Make sure that the output file name matches the source file name.\n       --  To compare them, remove file name directories and extensions.\n \n@@ -395,21 +410,6 @@ package body Osint.C is\n \n          Name_Buffer (Dot_Index) := '.';\n \n-         --  If we are in multiple unit per file mode, then add ~nnn\n-         --  extension to the name before doing the comparison.\n-\n-         if Multiple_Unit_Index /= 0 then\n-            declare\n-               Exten : constant String := Name_Buffer (Dot_Index .. Name_Len);\n-            begin\n-               Name_Len := Dot_Index - 1;\n-               Add_Char_To_Name_Buffer (Multi_Unit_Index_Character);\n-               Add_Nat_To_Name_Buffer (Multiple_Unit_Index);\n-               Dot_Index := Name_Len + 1;\n-               Add_Str_To_Name_Buffer (Exten);\n-            end;\n-         end if;\n-\n          --  Remove extension preparing to replace it\n \n          declare"}]}