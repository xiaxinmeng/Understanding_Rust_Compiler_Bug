{"sha": "6350c02cb6a7cdbd69403046fe466a9ea1367934", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjM1MGMwMmNiNmE3Y2RiZDY5NDAzMDQ2ZmU0NjZhOWVhMTM2NzkzNA==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@bigpond.net.au", "date": "2003-09-11T23:54:40Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2003-09-11T23:54:40Z"}, "message": "prep_cif.c (initialize_aggregate): Include tail padding in structure size.\n\n\t* src/prep_cif.c (initialize_aggregate): Include tail padding in\n\tstructure size.\n\t* src/powerpc/linux64_closure.S (ffi_closure_LINUX64): Correct\n\tplacement of float result.\n\t* testsuite/libffi.special/unwindtest.cc (closure_test_fn1): Correct\n\tcast of \"resp\" for big-endian 64 bit machines.\n\nFrom-SVN: r71323", "tree": {"sha": "04f3459481dd95299d45c55d0dfb47440783644e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/04f3459481dd95299d45c55d0dfb47440783644e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6350c02cb6a7cdbd69403046fe466a9ea1367934", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6350c02cb6a7cdbd69403046fe466a9ea1367934", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6350c02cb6a7cdbd69403046fe466a9ea1367934", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6350c02cb6a7cdbd69403046fe466a9ea1367934/comments", "author": null, "committer": null, "parents": [{"sha": "fe27b7cc414a7b57ef801872157b596f4f39c1f6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe27b7cc414a7b57ef801872157b596f4f39c1f6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe27b7cc414a7b57ef801872157b596f4f39c1f6"}], "stats": {"total": 24, "additions": 21, "deletions": 3}, "files": [{"sha": "15f9c6d54170e296512cf97cfab244a527eeac74", "filename": "libffi/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2FChangeLog?ref=6350c02cb6a7cdbd69403046fe466a9ea1367934", "patch": "@@ -1,3 +1,12 @@\n+2003-09-12  Alan Modra  <amodra@bigpond.net.au>\n+\n+\t* src/prep_cif.c (initialize_aggregate): Include tail padding in\n+\tstructure size.\n+\t* src/powerpc/linux64_closure.S (ffi_closure_LINUX64): Correct\n+\tplacement of float result.\n+\t* testsuite/libffi.special/unwindtest.cc (closure_test_fn1): Correct\n+\tcast of \"resp\" for big-endian 64 bit machines.\n+\n 2003-09-11  Alan Modra  <amodra@bigpond.net.au>\n \n \t* src/types.c (double, longdouble): Merge identical SH and ARM"}, {"sha": "2d44d67c20faa5ad0685a18309c87d7074e7647c", "filename": "libffi/src/powerpc/linux64_closure.S", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2Fsrc%2Fpowerpc%2Flinux64_closure.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2Fsrc%2Fpowerpc%2Flinux64_closure.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fpowerpc%2Flinux64_closure.S?ref=6350c02cb6a7cdbd69403046fe466a9ea1367934", "patch": "@@ -97,7 +97,7 @@ ffi_closure_LINUX64:\n \taddi %r1, %r1, 224\n \tblr\n # case FFI_TYPE_FLOAT\n-\tlfs %f1, 112+4(%r1)\n+\tlfs %f1, 112+0(%r1)\n \tmtlr %r0\n \taddi %r1, %r1, 224\n \tblr"}, {"sha": "d60d98ee9f5cd5bbde8bbf4ada06dd86b9f408de", "filename": "libffi/src/prep_cif.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2Fsrc%2Fprep_cif.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2Fsrc%2Fprep_cif.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Fsrc%2Fprep_cif.c?ref=6350c02cb6a7cdbd69403046fe466a9ea1367934", "patch": "@@ -64,6 +64,15 @@ static ffi_status initialize_aggregate(/*@out@*/ ffi_type *arg)\n       ptr++;\n     }\n \n+  /* Structure size includes tail padding.  This is important for\n+     structures that fit in one register on ABIs like the PowerPC64\n+     Linux ABI that right justify small structs in a register.\n+     It's also needed for nested structure layout, for example\n+     struct A { long a; char b; }; struct B { struct A x; char y; };\n+     should find y at an offset of 2*sizeof(long) and result in a\n+     total size of 3*sizeof(long).  */\n+  arg->size = ALIGN (arg->size, arg->alignment);\n+\n   if (arg->size == 0)\n     return FFI_BAD_TYPEDEF;\n   else"}, {"sha": "b6be367857a478283d4487af058c64183be63f5b", "filename": "libffi/testsuite/libffi.special/unwindtest.cc", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2Ftestsuite%2Flibffi.special%2Funwindtest.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6350c02cb6a7cdbd69403046fe466a9ea1367934/libffi%2Ftestsuite%2Flibffi.special%2Funwindtest.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libffi%2Ftestsuite%2Flibffi.special%2Funwindtest.cc?ref=6350c02cb6a7cdbd69403046fe466a9ea1367934", "patch": "@@ -37,9 +37,9 @@ void closure_test_fn1(ffi_cif* cif,void* resp,void** args,\n     \t   (int)(*(int *)args[10]), (int)(*(float *)args[11]),\n     \t   (int)*(int *)args[12], (int)(*(int *)args[13]),\n     \t   (int)(*(int *)args[14]), *(int *)args[15],\n-    \t   (int)(long)userdata, *(int*)resp);\n+    \t   (int)(long)userdata, (int)*(ffi_arg*)resp);\n     \n-    throw *(int*)resp;\n+    throw (int)*(ffi_arg*)resp;\n }\n \n typedef int (*closure_test_type1)(float, float, float, float, signed short, "}]}