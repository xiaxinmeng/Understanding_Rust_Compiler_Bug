{"sha": "3613c7abfa4392fd47d5078eb2261ad763772d2e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzYxM2M3YWJmYTQzOTJmZDQ3ZDUwNzhlYjIyNjFhZDc2Mzc3MmQyZQ==", "commit": {"author": {"name": "Andrew Pinski", "email": "andrew_pinski@playstation.sony.com", "date": "2007-05-28T19:43:10Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2007-05-28T19:43:10Z"}, "message": "re PR tree-optimization/32100 (vrp bitfield miscompilation)\n\n2007-05-28  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/32100\n        * fold-const.c (tree_expr_nonnegative_warnv_p): Don't\n        return true when truth_value_p is true and the type\n        is of signed:1.\n\n2007-05-28  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR tree-opt/32100\n         * gcc.c-torture/execute/vrp-7.c: New test.\n\nFrom-SVN: r125139", "tree": {"sha": "115b6795f44871b452f47fbbb8f7221a4041f1d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/115b6795f44871b452f47fbbb8f7221a4041f1d5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3613c7abfa4392fd47d5078eb2261ad763772d2e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3613c7abfa4392fd47d5078eb2261ad763772d2e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3613c7abfa4392fd47d5078eb2261ad763772d2e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3613c7abfa4392fd47d5078eb2261ad763772d2e/comments", "author": null, "committer": null, "parents": [{"sha": "3366c30b7fc1404833d54aaeb54de57ca7a16e16", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3366c30b7fc1404833d54aaeb54de57ca7a16e16", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3366c30b7fc1404833d54aaeb54de57ca7a16e16"}], "stats": {"total": 43, "additions": 40, "deletions": 3}, "files": [{"sha": "0b3424925b94ce614e2f9496436c6898500149e0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3613c7abfa4392fd47d5078eb2261ad763772d2e", "patch": "@@ -1,3 +1,10 @@\n+2007-05-28  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/32100\n+\t* fold-const.c (tree_expr_nonnegative_warnv_p): Don't\n+\treturn true when truth_value_p is true and the type\n+\tis of signed:1.\n+\n 2007-05-28  Gerald Pfeifer  <gerald@pfeifer.com>\n \n \t* doc/install.texi (Prerequisites): We no longer require Autoconf"}, {"sha": "01ce961ebd9abd78cd6f0dd5c71ecff313133886", "filename": "gcc/fold-const.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2Ffold-const.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2Ffold-const.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffold-const.c?ref=3613c7abfa4392fd47d5078eb2261ad763772d2e", "patch": "@@ -13485,9 +13485,14 @@ tree_expr_nonnegative_warnv_p (tree t, bool *strict_overflow_p)\n       /* ... fall through ...  */\n \n     default:\n-      if (truth_value_p (TREE_CODE (t)))\n-\t/* Truth values evaluate to 0 or 1, which is nonnegative.  */\n-\treturn true;\n+      {\n+\ttree type = TREE_TYPE (t);\n+\tif ((TYPE_PRECISION (type) != 1 || TYPE_UNSIGNED (type))\n+\t    && truth_value_p (TREE_CODE (t)))\n+\t  /* Truth values evaluate to 0 or 1, which is nonnegative unless we\n+             have a signed:1 type (where the value is -1 and 0).  */\n+\t  return true;\n+      }\n     }\n \n   /* We don't know sign of `t', so be conservative and return false.  */"}, {"sha": "2e546eb2c021eb8bd07d0bbe2a0578ec1d113458", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3613c7abfa4392fd47d5078eb2261ad763772d2e", "patch": "@@ -1,3 +1,8 @@\n+2007-05-28  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR tree-opt/32100\n+\t* gcc.c-torture/execute/vrp-7.c: New test.\n+\t \n 2007-05-28  Brooks Moses  <brooks.moses@codesourcery.com>\n \n \t* gfortran.dg/transfer_simplify_4.f90: New test."}, {"sha": "b4c9e62d449e006dad37c909640f4f80cbbdc720", "filename": "gcc/testsuite/gcc.c-torture/execute/vrp-7.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fvrp-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3613c7abfa4392fd47d5078eb2261ad763772d2e/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fvrp-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fvrp-7.c?ref=3613c7abfa4392fd47d5078eb2261ad763772d2e", "patch": "@@ -0,0 +1,20 @@\n+\n+void abort (void);\n+\n+struct T\n+{\n+  int b : 1;\n+} t;\n+\n+void __attribute__((noinline)) foo (int f)\n+{\n+  t.b = (f & 0x10) ? 1 : 0;\n+}\n+\n+int main (void)\n+{\n+  foo (0x10);\n+  if (!t.b)\n+    abort ();\n+  return 0;\n+}"}]}