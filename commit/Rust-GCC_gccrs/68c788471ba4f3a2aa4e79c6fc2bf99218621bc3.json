{"sha": "68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjhjNzg4NDcxYmE0ZjNhMmFhNGU3OWM2ZmMyYmY5OTIxODYyMWJjMw==", "commit": {"author": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@users.sourceforge.net", "date": "2003-09-19T14:08:00Z"}, "committer": {"name": "Kriang Lerdsuwanakij", "email": "lerdsuwa@gcc.gnu.org", "date": "2003-09-19T14:08:00Z"}, "message": "re PR c++/495 (ICE in in lookup_template_class, at cp/pt.c:3961)\n\n\tPR c++/495\n\t* pt.c (tsubst_friend_class): Only use innermost template\n\targuments for the injected friend class template.\n\n\t* g++.dg/template/friend24.C: New test.\n\nFrom-SVN: r71574", "tree": {"sha": "d12f6f7ece81be97d1ded812e91f6979f2fe7b6e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d12f6f7ece81be97d1ded812e91f6979f2fe7b6e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/comments", "author": null, "committer": null, "parents": [{"sha": "472b0fbcf737e5a4211b70d65ea9e386c9d9eeef", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/472b0fbcf737e5a4211b70d65ea9e386c9d9eeef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/472b0fbcf737e5a4211b70d65ea9e386c9d9eeef"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "a18706b38c4251f8f69db10fb2a696a81905cdfc", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "patch": "@@ -1,3 +1,9 @@\n+2003-09-19  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/495\n+\t* pt.c (tsubst_friend_class): Only use innermost template\n+\targuments for the injected friend class template.\n+\n 2003-09-19  Nathan Sidwell  <nathan@codesourcery.com>\n \n \tPR c++/12332"}, {"sha": "5e5af5b4c488c2aee612c74f12c5f8df768c3568", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "patch": "@@ -5001,6 +5001,8 @@ tsubst_friend_class (tree friend_tmpl, tree args)\n       DECL_USE_TEMPLATE (tmpl) = 0;\n       DECL_TEMPLATE_INFO (tmpl) = NULL_TREE;\n       CLASSTYPE_USE_TEMPLATE (TREE_TYPE (tmpl)) = 0;\n+      CLASSTYPE_TI_ARGS (TREE_TYPE (tmpl))\n+\t= INNERMOST_TEMPLATE_ARGS (CLASSTYPE_TI_ARGS (TREE_TYPE (tmpl)));\n \n       /* Inject this template into the global scope.  */\n       friend_type = TREE_TYPE (pushdecl_top_level (tmpl));"}, {"sha": "77a2c4bd7aa04939de57f3fa9f127f76ef51b597", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "patch": "@@ -1,3 +1,8 @@\n+2003-09-19  Kriang Lerdsuwanakij  <lerdsuwa@users.sourceforge.net>\n+\n+\tPR c++/495\n+\t* g++.dg/template/friend24.C: New test.\n+\n 2003-09-19  Nathan Sidwell  <nathan@codesourcery.com>\n \n \tPR c++/12332"}, {"sha": "5db4d31e721462b4fc6efa7efa7fabc654b1c99d", "filename": "gcc/testsuite/g++.dg/template/friend24.C", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend24.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/68c788471ba4f3a2aa4e79c6fc2bf99218621bc3/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend24.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Ffriend24.C?ref=68c788471ba4f3a2aa4e79c6fc2bf99218621bc3", "patch": "@@ -0,0 +1,27 @@\n+// { dg-do compile }\n+\n+// Origin: Wolfgang Bangerth <bangerth@ticam.utexas.edu>\n+\n+// PR c++/495: Fail to locate primary class template that is\n+// injected by friend declaration.\n+\n+template <int N> struct X\n+{\n+  template <int dim> friend struct Y;\n+};\n+\n+X<2> x;\n+\n+template <int dim> struct Y\n+{\n+  void f (Y);\n+  void g (Y);\n+};\n+\n+template <int dim> void Y<dim>::f (Y)\n+{\n+}\n+\n+template <int dim> void Y<dim>::g (Y<dim>)\n+{\n+}"}]}