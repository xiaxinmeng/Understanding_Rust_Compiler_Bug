{"sha": "b2ec1738df672b44576efb62f57dabc381eef753", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjJlYzE3MzhkZjY3MmI0NDU3NmVmYjYyZjU3ZGFiYzM4MWVlZjc1Mw==", "commit": {"author": {"name": "David Daney", "email": "ddaney@avtrex.com", "date": "2007-09-09T23:31:35Z"}, "committer": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2007-09-09T23:31:35Z"}, "message": "re PR c++/33324 (ICE on new array of objects with virtual destructors.)\n\n\tPR c++/33324\n\t* init.c (build_new_1):  Use POINTER_PLUS_EXPR instead of MINUS_EXPR\n\tto calculate cookie_ptr.\n\nFrom-SVN: r128312", "tree": {"sha": "9e68a01a7bc706a81ce7f19b40b1824f08e05a1f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9e68a01a7bc706a81ce7f19b40b1824f08e05a1f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b2ec1738df672b44576efb62f57dabc381eef753", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2ec1738df672b44576efb62f57dabc381eef753", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2ec1738df672b44576efb62f57dabc381eef753", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2ec1738df672b44576efb62f57dabc381eef753/comments", "author": null, "committer": null, "parents": [{"sha": "dd735081f0dd7285863033d59a1c550fee7b8599", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd735081f0dd7285863033d59a1c550fee7b8599", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd735081f0dd7285863033d59a1c550fee7b8599"}], "stats": {"total": 12, "additions": 10, "deletions": 2}, "files": [{"sha": "cdbffb1e0702329b861ae96ed1d510d96ab6d236", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2ec1738df672b44576efb62f57dabc381eef753/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2ec1738df672b44576efb62f57dabc381eef753/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=b2ec1738df672b44576efb62f57dabc381eef753", "patch": "@@ -1,3 +1,9 @@\n+2007-09-09  David Daney  <ddaney@avtrex.com>\n+\n+\tPR c++/33324\n+\t* init.c (build_new_1):  Use POINTER_PLUS_EXPR instead of MINUS_EXPR\n+\tto calculate cookie_ptr.\n+\n 2007-09-08  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/33342"}, {"sha": "cafc721710701136bcfa8f821465dea925916555", "filename": "gcc/cp/init.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2ec1738df672b44576efb62f57dabc381eef753/gcc%2Fcp%2Finit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2ec1738df672b44576efb62f57dabc381eef753/gcc%2Fcp%2Finit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Finit.c?ref=b2ec1738df672b44576efb62f57dabc381eef753", "patch": "@@ -1930,8 +1930,10 @@ build_new_1 (tree placement, tree type, tree nelts, tree init,\n       if (targetm.cxx.cookie_has_size ())\n \t{\n \t  /* Also store the element size.  */\n-\t  cookie_ptr = build2 (MINUS_EXPR, build_pointer_type (sizetype),\n-\t\t\t       cookie_ptr, size_in_bytes (sizetype));\n+\t  cookie_ptr = build2 (POINTER_PLUS_EXPR, size_ptr_type, cookie_ptr,\n+\t\t\t       fold_build1 (NEGATE_EXPR, sizetype,\n+\t\t\t\t\t    size_in_bytes (sizetype)));\n+\n \t  cookie = build_indirect_ref (cookie_ptr, NULL);\n \t  cookie = build2 (MODIFY_EXPR, sizetype, cookie,\n \t\t\t   size_in_bytes(elt_type));"}]}