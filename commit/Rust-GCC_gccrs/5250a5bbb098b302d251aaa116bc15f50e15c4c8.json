{"sha": "5250a5bbb098b302d251aaa116bc15f50e15c4c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTI1MGE1YmJiMDk4YjMwMmQyNTFhYWExMTZiYzE1ZjUwZTE1YzRjOA==", "commit": {"author": {"name": "Senthil Kumar Selvaraj", "email": "senthil_kumar.selvaraj@atmel.com", "date": "2016-08-10T12:35:57Z"}, "committer": {"name": "Senthil Kumar Selvaraj", "email": "saaadhu@gcc.gnu.org", "date": "2016-08-10T12:35:57Z"}, "message": "Fix PR 71873 - ICE in push_reload\n\nExtend computation of subreg_in_class to constants and plus expressions \ninside SUBREGs, before recursively calling push_reload. SYMBOL_REFs are\nalso CONSTANT_P, so remove explicit handling of SYMBOL_REFs.\n\ngcc/ChangeLog\n\n\tPR target/71873\n\t* reload.c (push_reload): Compute subreg_in_class for\n\tsubregs of constants and plus expressions. Remove special\n\thandling of SYMBOL_REFs.\n\ngcc/testsuite/ChangeLog\n\n\tPR target/71873\n\t* gcc.target/avr/pr71873.c: New test.\n\nFrom-SVN: r239321", "tree": {"sha": "697a185a5ee8b6cffb31b6903f1e506ae94bca32", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/697a185a5ee8b6cffb31b6903f1e506ae94bca32"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5250a5bbb098b302d251aaa116bc15f50e15c4c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5250a5bbb098b302d251aaa116bc15f50e15c4c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5250a5bbb098b302d251aaa116bc15f50e15c4c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5250a5bbb098b302d251aaa116bc15f50e15c4c8/comments", "author": null, "committer": {"login": "saaadhu", "id": 532256, "node_id": "MDQ6VXNlcjUzMjI1Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/532256?v=4", "gravatar_id": "", "url": "https://api.github.com/users/saaadhu", "html_url": "https://github.com/saaadhu", "followers_url": "https://api.github.com/users/saaadhu/followers", "following_url": "https://api.github.com/users/saaadhu/following{/other_user}", "gists_url": "https://api.github.com/users/saaadhu/gists{/gist_id}", "starred_url": "https://api.github.com/users/saaadhu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/saaadhu/subscriptions", "organizations_url": "https://api.github.com/users/saaadhu/orgs", "repos_url": "https://api.github.com/users/saaadhu/repos", "events_url": "https://api.github.com/users/saaadhu/events{/privacy}", "received_events_url": "https://api.github.com/users/saaadhu/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c4e9cff61cfdad1a86927019df6bf27abef2709f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c4e9cff61cfdad1a86927019df6bf27abef2709f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c4e9cff61cfdad1a86927019df6bf27abef2709f"}], "stats": {"total": 45, "additions": 44, "deletions": 1}, "files": [{"sha": "17fa9faa002b2106c6f6003fbb949fb81c86b76e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=5250a5bbb098b302d251aaa116bc15f50e15c4c8", "patch": "@@ -1,3 +1,10 @@\n+2016-08-10  Senthil Kumar Selvaraj  <senthil_kumar.selvaraj@atmel.com>\n+\n+\tPR target/71873\n+\t* reload.c (push_reload): Compute subreg_in_class for\n+\tsubregs of constants and plus expressions. Remove special\n+\thandling of SYMBOL_REFs.\n+\n 2016-08-10  Alan Modra  <amodra@gmail.com>\n \n \tPR target/71680"}, {"sha": "afdd56dfeca86ce35b0e96b2c29f2ed8e4e2f651", "filename": "gcc/reload.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2Freload.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2Freload.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Freload.c?ref=5250a5bbb098b302d251aaa116bc15f50e15c4c8", "patch": "@@ -1141,7 +1141,8 @@ push_reload (rtx in, rtx out, rtx *inloc, rtx *outloc,\n \t\t\t\t\t\t   SUBREG_BYTE (in),\n \t\t\t\t\t\t   GET_MODE (in)),\n \t\t\t      REGNO (SUBREG_REG (in)));\n-      else if (GET_CODE (SUBREG_REG (in)) == SYMBOL_REF)\n+      else if (CONSTANT_P (SUBREG_REG (in))\n+               || GET_CODE (SUBREG_REG (in)) == PLUS)\n \tsubreg_in_class = find_valid_class_1 (inmode,\n \t\t\t\t\t      GET_MODE (SUBREG_REG (in)),\n \t\t\t\t\t      rclass);"}, {"sha": "c9a4eedfb2643df54261e46eb0af3c312d3a69b9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5250a5bbb098b302d251aaa116bc15f50e15c4c8", "patch": "@@ -1,3 +1,8 @@\n+2016-08-10  Senthil Kumar Selvaraj  <senthil_kumar.selvaraj@atmel.com>\n+\n+\tPR target/71873\n+\t* gcc.target/avr/pr71873.c: New test.\n+\n 2016-08-09  Martin Liska  <mliska@suse.cz>\n \n \t* g++.dg/gcov/gcov-dump-1.C: New test."}, {"sha": "0791d921a4276c9fe7685b65de3ea16249d6a37a", "filename": "gcc/testsuite/gcc.target/avr/pr71873.c", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2Ftestsuite%2Fgcc.target%2Favr%2Fpr71873.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5250a5bbb098b302d251aaa116bc15f50e15c4c8/gcc%2Ftestsuite%2Fgcc.target%2Favr%2Fpr71873.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Favr%2Fpr71873.c?ref=5250a5bbb098b302d251aaa116bc15f50e15c4c8", "patch": "@@ -0,0 +1,30 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-Os -fcaller-saves\" } */\n+\n+#include <stdint.h>\n+\n+typedef struct {\n+  uint8_t x;\n+  uint32_t y;\n+} A;\n+\n+A a;\n+\n+extern int bar(int);\n+extern int foo (char *s, ...);\n+\n+extern uint8_t param;\n+extern uint8_t h,m,s,ld,lm;\n+extern uint16_t d;\n+\n+void gps_parse_string(int z)\n+{\n+  while (bar(z))\n+  {\n+    switch (param)\n+    {\n+      case 0: foo(\"a\", &h, &m, &s, &d); break;\n+      case 1: foo(\"d\", &ld, &lm, &a.y); break;\n+    }\n+  }\n+}"}]}