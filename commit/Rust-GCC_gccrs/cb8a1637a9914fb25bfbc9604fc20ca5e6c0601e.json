{"sha": "cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2I4YTE2MzdhOTkxNGZiMjViZmJjOTYwNGZjMjBjYTVlNmMwNjAxZQ==", "commit": {"author": {"name": "David Holsgrove", "email": "david.holsgrove@xilinx.com", "date": "2013-03-03T17:34:50Z"}, "committer": {"name": "Michael Eager", "email": "eager@gcc.gnu.org", "date": "2013-03-03T17:34:50Z"}, "message": "Support -mxl-reorder and swap instructions.\n\n\t*  config/microblaze/microblaze.c:\n\tCheck mcpu, pcmp requirement and set TARGET_REORDER to 0 if not met.\n\t*  config/microblaze/microblaze.h: Add -mxl-reorder to DRIVER_SELF_SPECS\n\t*  config/microblaze/microblaze.md: New bswapsi2 and bswaphi2\n\tinstructions emitted if TARGET_REORDER\n\t*  config/microblaze/microblaze.opt: New option -mxl-reorder set to 1 \n\tor 0 for -m/-mno case, but initialises as 2 to detect default use case \n\tseparately\n\nFrom-SVN: r196415", "tree": {"sha": "ab7b0af8c6ebc318739b095e0cbb35ee1fe707eb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab7b0af8c6ebc318739b095e0cbb35ee1fe707eb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/comments", "author": {"login": "davidholsgrove", "id": 4031547, "node_id": "MDQ6VXNlcjQwMzE1NDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4031547?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidholsgrove", "html_url": "https://github.com/davidholsgrove", "followers_url": "https://api.github.com/users/davidholsgrove/followers", "following_url": "https://api.github.com/users/davidholsgrove/following{/other_user}", "gists_url": "https://api.github.com/users/davidholsgrove/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidholsgrove/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidholsgrove/subscriptions", "organizations_url": "https://api.github.com/users/davidholsgrove/orgs", "repos_url": "https://api.github.com/users/davidholsgrove/repos", "events_url": "https://api.github.com/users/davidholsgrove/events{/privacy}", "received_events_url": "https://api.github.com/users/davidholsgrove/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "ab68a73ede62fbcbb3abd07879838ebe81fdd484", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab68a73ede62fbcbb3abd07879838ebe81fdd484", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab68a73ede62fbcbb3abd07879838ebe81fdd484"}], "stats": {"total": 45, "additions": 45, "deletions": 0}, "files": [{"sha": "dabc79ad32e1518eace0cfd5b0287f594f597bd7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "patch": "@@ -1,3 +1,14 @@\n+2013-03-02  David Holsgrove <david.holsgrove@xilinx.com>\n+\n+\t*  config/microblaze/microblaze.c:\n+\tCheck mcpu, pcmp requirement and set TARGET_REORDER to 0 if not met.\n+\t*  config/microblaze/microblaze.h: Add -mxl-reorder to DRIVER_SELF_SPECS\n+\t*  config/microblaze/microblaze.md: New bswapsi2 and bswaphi2\n+\tinstructions emitted if TARGET_REORDER\n+\t*  config/microblaze/microblaze.opt: New option -mxl-reorder set to 1 \n+\tor 0 for -m/-mno case, but initialises as 2 to detect default use case \n+\tseparately\n+\n 2013-03-01  Xinliang David Li  <davidxl@google.com>\n \n \t* tree-ssa-uninit.c (compute_control_dep_chain): Limit post-dom"}, {"sha": "8458253253ca48eecf997a1c600766a42e704954", "filename": "gcc/config/microblaze/microblaze.c", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c?ref=cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "patch": "@@ -1380,6 +1380,21 @@ microblaze_option_override (void)\n         microblaze_has_clz = 0;\n     }\n \n+  /* TARGET_REORDER defaults to 2 if -mxl-reorder not specified.  */\n+  ver = MICROBLAZE_VERSION_COMPARE (microblaze_select_cpu, \"v8.30.a\");\n+  if (ver < 0)\n+    {\n+        if (TARGET_REORDER == 1)\n+          warning (0, \"-mxl-reorder can be used only with -mcpu=v8.30.a or greater\");\n+        TARGET_REORDER = 0;\n+    }\n+  else if ((ver == 0) && !TARGET_PATTERN_COMPARE)\n+    {\n+        if (TARGET_REORDER == 1)\n+          warning (0, \"-mxl-reorder requires -mxl-pattern-compare for -mcpu=v8.30.a\");\n+        TARGET_REORDER = 0;\n+    }\n+\n   if (TARGET_MULTIPLY_HIGH && TARGET_SOFT_MUL)\n     error (\"-mxl-multiply-high requires -mno-xl-soft-mul\");\n "}, {"sha": "23ed16e4f6c14b04ee5b0d66d41cccc506bdd569", "filename": "gcc/config/microblaze/microblaze.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h?ref=cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "patch": "@@ -78,6 +78,7 @@ extern enum pipeline_type microblaze_pipe;\n \t\"%{mno-xl-barrel-shift:%<mxl-barrel-shift}\", \t\\\n \t\"%{mno-xl-pattern-compare:%<mxl-pattern-compare}\", \\\n \t\"%{mxl-soft-div:%<mno-xl-soft-div}\", \t\t\\\n+\t\"%{mxl-reorder:%<mno-xl-reorder}\", \t\t\\\n \t\"%{msoft-float:%<mhard-float}\"\n \n /* Tell collect what flags to pass to nm.  */"}, {"sha": "9f177331389af910c88781dcc83b6bef0eb17eeb", "filename": "gcc/config/microblaze/microblaze.md", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.md?ref=cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "patch": "@@ -353,6 +353,20 @@\n (automata_option \"time\")\n (automata_option \"progress\")\n \n+(define_insn \"bswapsi2\"\n+  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n+        (bswap:SI (match_operand:SI 1 \"register_operand\" \"r\")))]\n+  \"TARGET_REORDER\"\n+  \"swapb %0, %1\"\n+)\n+\n+(define_insn \"bswaphi2\"\n+  [(set (match_operand:HI 0 \"register_operand\" \"=r\")\n+        (bswap:HI (match_operand:HI 1 \"register_operand\" \"r\")))]\n+  \"TARGET_REORDER\"\n+  \"swaph %0, %1\"\n+)\n+\n ;;----------------------------------------------------------------\n ;; Microblaze delay slot description\n ;;----------------------------------------------------------------"}, {"sha": "a659166372a6b7a802e782cbe3a574183c3fd8ab", "filename": "gcc/config/microblaze/microblaze.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.opt?ref=cb8a1637a9914fb25bfbc9604fc20ca5e6c0601e", "patch": "@@ -67,6 +67,10 @@ mxl-soft-mul\n Target Mask(SOFT_MUL)\n Use the soft multiply emulation (default)\n \n+mxl-reorder\n+Target Var(TARGET_REORDER) Init(2)\n+Use reorder instructions (swap and byte reversed load/store) (default)\n+\n mxl-soft-div\n Target Mask(SOFT_DIV)\n Use the software emulation for divides (default)"}]}