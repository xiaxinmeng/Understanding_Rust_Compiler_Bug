{"sha": "914a7297d61d49378cbeb63a8f5b9384c5dc824f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTE0YTcyOTdkNjFkNDkzNzhjYmViNjNhOGY1YjkzODRjNWRjODI0Zg==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2002-10-19T04:36:30Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2002-10-19T04:36:30Z"}, "message": "rs6000.md (movdf_hardfloat32): Order alternatives consistently.\n\n        * rs6000.md (movdf_hardfloat32): Order alternatives consistently.\n        Use length of 4 not *.\n        (movdf_hardfloat64): Same.  Support DFmode moves to/from CTR/LR.\n        (movdf_softfloat64): Likewise.\n        (movdi_internal32): Use length of 4 not *.\n        (movti_power): Same.\n        (ctrsi, ctrdi): Same.\n\nFrom-SVN: r58299", "tree": {"sha": "e299dc54a3a0edbee97b9e0680e2625bdf83184a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e299dc54a3a0edbee97b9e0680e2625bdf83184a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/914a7297d61d49378cbeb63a8f5b9384c5dc824f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/914a7297d61d49378cbeb63a8f5b9384c5dc824f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/914a7297d61d49378cbeb63a8f5b9384c5dc824f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/914a7297d61d49378cbeb63a8f5b9384c5dc824f/comments", "author": null, "committer": null, "parents": [{"sha": "4a7510cb22da4809d18e3bb3fc453cf671d6926a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4a7510cb22da4809d18e3bb3fc453cf671d6926a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4a7510cb22da4809d18e3bb3fc453cf671d6926a"}], "stats": {"total": 82, "additions": 48, "deletions": 34}, "files": [{"sha": "6b48dde74ea90c7bca5735adbf7b936d2a98c753", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/914a7297d61d49378cbeb63a8f5b9384c5dc824f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/914a7297d61d49378cbeb63a8f5b9384c5dc824f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=914a7297d61d49378cbeb63a8f5b9384c5dc824f", "patch": "@@ -1,3 +1,13 @@\n+2002-10-18  David Edelsohn  <edelsohn@gnu.org>\n+\n+\t* rs6000.md (movdf_hardfloat32): Order alternatives consistently.\n+\tUse length of 4 not *.\n+\t(movdf_hardfloat64): Same.  Support DFmode moves to/from CTR/LR.\n+\t(movdf_softfloat64): Likewise.\n+\t(movdi_internal32): Use length of 4 not *.\n+\t(movti_power): Same.\n+\t(ctrsi, ctrdi): Same.\n+\n 2002-10-18  Zack Weinberg  <zack@codesourcery.com>\n \n \t* c-decl.c (start_decl): Point users of the old initialized-"}, {"sha": "749b881f6dfd73b9ee3799e65e3b299ba8394d61", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 38, "deletions": 34, "changes": 72, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/914a7297d61d49378cbeb63a8f5b9384c5dc824f/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/914a7297d61d49378cbeb63a8f5b9384c5dc824f/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=914a7297d61d49378cbeb63a8f5b9384c5dc824f", "patch": "@@ -8541,8 +8541,8 @@\n ;; The \"??\" is a kludge until we can figure out a more reasonable way\n ;; of handling these non-offsettable values.\n (define_insn \"*movdf_hardfloat32\"\n-  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=!r,??r,m,!r,!r,!r,f,f,m\")\n-\t(match_operand:DF 1 \"input_operand\" \"r,m,r,G,H,F,f,m,f\"))]\n+  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=!r,??r,m,f,f,m,!r,!r,!r\")\n+\t(match_operand:DF 1 \"input_operand\" \"r,m,r,f,m,f,G,H,F\"))]\n   \"! TARGET_POWERPC64 && TARGET_HARD_FLOAT && TARGET_FPRS\n    && (gpc_reg_operand (operands[0], DFmode)\n        || gpc_reg_operand (operands[1], DFmode))\"\n@@ -8619,19 +8619,19 @@\n \t  return \\\"\\\";\n \t}\n     case 3:\n+      return \\\"fmr %0,%1\\\";\n     case 4:\n+      return \\\"lfd%U1%X1 %0,%1\\\";\n     case 5:\n-      return \\\"#\\\";\n+      return \\\"stfd%U0%X0 %1,%0\\\";\n     case 6:\n-      return \\\"fmr %0,%1\\\";\n     case 7:\n-      return \\\"lfd%U1%X1 %0,%1\\\";\n     case 8:\n-      return \\\"stfd%U0%X0 %1,%0\\\";\n+      return \\\"#\\\";\n     }\n }\"\n-  [(set_attr \"type\" \"*,load,store,*,*,*,fp,fpload,fpstore\")\n-   (set_attr \"length\" \"8,16,16,8,12,16,*,*,*\")])\n+  [(set_attr \"type\" \"*,load,store,fp,fpload,fpstore,*,*,*\")\n+   (set_attr \"length\" \"8,16,16,4,4,4,8,12,16\")])\n \n (define_insn \"*movdf_softfloat32\"\n   [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=r,r,m,r,r,r\")\n@@ -8675,39 +8675,43 @@\n    (set_attr \"length\" \"8,8,8,8,12,16\")])\n \n (define_insn \"*movdf_hardfloat64\"\n-  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=!r,??r,m,!r,!r,!r,f,f,m\")\n-\t(match_operand:DF 1 \"input_operand\" \"r,m,r,G,H,F,f,m,f\"))]\n+  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=!r,??r,m,f,f,m,!cl,!r,!r,!r,!r\")\n+\t(match_operand:DF 1 \"input_operand\" \"r,m,r,f,m,f,r,h,G,H,F\"))]\n   \"TARGET_POWERPC64 && TARGET_HARD_FLOAT && TARGET_FPRS\n    && (gpc_reg_operand (operands[0], DFmode)\n        || gpc_reg_operand (operands[1], DFmode))\"\n   \"@\n    mr %0,%1\n    ld%U1%X1 %0,%1\n    std%U0%X0 %1,%0\n-   #\n-   #\n-   #\n    fmr %0,%1\n    lfd%U1%X1 %0,%1\n-   stfd%U0%X0 %1,%0\"\n-  [(set_attr \"type\" \"*,load,store,*,*,*,fp,fpload,fpstore\")\n-   (set_attr \"length\" \"4,4,4,8,12,16,4,4,4\")])\n+   stfd%U0%X0 %1,%0\n+   mt%0 %1\n+   mf%1 %0\n+   #\n+   #\n+   #\"\n+  [(set_attr \"type\" \"*,load,store,fp,fpload,fpstore,mtjmpr,*,*,*,*\")\n+   (set_attr \"length\" \"4,4,4,4,4,4,4,4,8,12,16\")])\n \n (define_insn \"*movdf_softfloat64\"\n-  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=r,r,m,r,r,r\")\n-\t(match_operand:DF 1 \"input_operand\" \"r,m,r,G,H,F\"))]\n+  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=r,cl,r,r,m,r,r,r\")\n+\t(match_operand:DF 1 \"input_operand\" \"r,r,h,m,r,G,H,F\"))]\n   \"TARGET_POWERPC64 && (TARGET_SOFT_FLOAT || !TARGET_FPRS)\n    && (gpc_reg_operand (operands[0], DFmode)\n        || gpc_reg_operand (operands[1], DFmode))\"\n   \"@\n    mr %0,%1\n+   mt%0 %1\n+   mf%1 %0\n    ld%U1%X1 %0,%1\n    std%U0%X0 %1,%0\n    #\n    #\n    #\"\n-  [(set_attr \"type\" \"*,load,store,*,*,*\")\n-   (set_attr \"length\" \"*,*,*,8,12,16\")])\n+  [(set_attr \"type\" \"*,*,*,load,store,*,*,*\")\n+   (set_attr \"length\" \"4,4,4,4,4,8,12,16\")])\n \f\n (define_expand \"movtf\"\n   [(set (match_operand:TF 0 \"general_operand\" \"\")\n@@ -9026,7 +9030,7 @@\n     }\n }\"\n   [(set_attr \"type\" \"*,load,store,fp,fpload,fpstore,*,*,*,*,*\")\n-   (set_attr \"length\" \"8,8,8,*,*,*,8,12,8,12,16\")])\n+   (set_attr \"length\" \"8,8,8,4,4,4,8,12,8,12,16\")])\n \n (define_split\n   [(set (match_operand:DI 0 \"gpc_reg_operand\" \"\")\n@@ -9241,7 +9245,7 @@\n     }\n }\"\n   [(set_attr \"type\" \"store,store,*,load,load\")\n-   (set_attr \"length\" \"*,16,16,*,16\")])\n+   (set_attr \"length\" \"4,16,16,4,16\")])\n \n (define_insn \"*movti_string\"\n   [(set (match_operand:TI 0 \"reg_or_mem_operand\" \"=m,????r,????r\")\n@@ -14153,7 +14157,7 @@\n     return \\\"bdz $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrsi_internal2\"\n   [(set (pc)\n@@ -14177,7 +14181,7 @@\n     return \\\"{bdn|bdnz} $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrdi_internal1\"\n   [(set (pc)\n@@ -14201,7 +14205,7 @@\n     return \\\"bdz $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrdi_internal2\"\n   [(set (pc)\n@@ -14225,7 +14229,7 @@\n     return \\\"{bdn|bdnz} $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n ;; Similar, but we can use GE since we have a REG_NONNEG.\n \n@@ -14251,7 +14255,7 @@\n     return \\\"bdz $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrsi_internal4\"\n   [(set (pc)\n@@ -14275,7 +14279,7 @@\n     return \\\"{bdn|bdnz} $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrdi_internal3\"\n   [(set (pc)\n@@ -14299,7 +14303,7 @@\n     return \\\"bdz $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrdi_internal4\"\n   [(set (pc)\n@@ -14323,7 +14327,7 @@\n     return \\\"{bdn|bdnz} $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n ;; Similar but use EQ\n \n@@ -14349,7 +14353,7 @@\n     return \\\"{bdn|bdnz} $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrsi_internal6\"\n   [(set (pc)\n@@ -14373,7 +14377,7 @@\n     return \\\"bdz $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrdi_internal5\"\n   [(set (pc)\n@@ -14397,7 +14401,7 @@\n     return \\\"{bdn|bdnz} $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n (define_insn \"*ctrdi_internal6\"\n   [(set (pc)\n@@ -14421,7 +14425,7 @@\n     return \\\"bdz $+8\\;b %l0\\\";\n }\"\n   [(set_attr \"type\" \"branch\")\n-   (set_attr \"length\" \"*,12,16\")])\n+   (set_attr \"length\" \"4,12,16\")])\n \n ;; Now the splitters if we could not allocate the CTR register\n "}]}