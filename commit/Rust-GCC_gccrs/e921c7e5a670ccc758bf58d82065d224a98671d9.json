{"sha": "e921c7e5a670ccc758bf58d82065d224a98671d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTkyMWM3ZTVhNjcwY2NjNzU4YmY1OGQ4MjA2NWQyMjRhOTg2NzFkOQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2017-10-25T00:27:10Z"}, "committer": {"name": "Jonathan Wakely", "email": "redi@gcc.gnu.org", "date": "2017-10-25T00:27:10Z"}, "message": "PR libstdc++/82706 fix test for case where operations succeed\n\n\tPR libstdc++/82706\n\t* testsuite/27_io/filesystem/operations/permissions.cc: Fix test.\n\nFrom-SVN: r254067", "tree": {"sha": "225436b18b34036a655f3e3fbfc60b0660be0627", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/225436b18b34036a655f3e3fbfc60b0660be0627"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e921c7e5a670ccc758bf58d82065d224a98671d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e921c7e5a670ccc758bf58d82065d224a98671d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e921c7e5a670ccc758bf58d82065d224a98671d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e921c7e5a670ccc758bf58d82065d224a98671d9/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "03ca5c55f9d12eba4f4adb1dfaddfb079cbe6b42", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03ca5c55f9d12eba4f4adb1dfaddfb079cbe6b42", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03ca5c55f9d12eba4f4adb1dfaddfb079cbe6b42"}], "stats": {"total": 19, "additions": 16, "deletions": 3}, "files": [{"sha": "dadec85c093f86b6e4d5de93ece68de8c92a0d88", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e921c7e5a670ccc758bf58d82065d224a98671d9/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e921c7e5a670ccc758bf58d82065d224a98671d9/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=e921c7e5a670ccc758bf58d82065d224a98671d9", "patch": "@@ -1,3 +1,8 @@\n+2017-10-25  Jonathan Wakely  <jwakely@redhat.com>\n+\n+\tPR libstdc++/82706\n+\t* testsuite/27_io/filesystem/operations/permissions.cc: Fix test.\n+\n 2017-10-24  Fran\u00e7ois Dumont  <fdumont@gcc.gnu.org>\n \n \t* testsuite/lib/libstdc++.exp (check_v3_target_normal_mode): Add"}, {"sha": "e190e8862300610b24ee2471fa826253dcb15b68", "filename": "libstdc++-v3/testsuite/27_io/filesystem/operations/permissions.cc", "status": "modified", "additions": 11, "deletions": 3, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e921c7e5a670ccc758bf58d82065d224a98671d9/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Foperations%2Fpermissions.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e921c7e5a670ccc758bf58d82065d224a98671d9/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Foperations%2Fpermissions.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F27_io%2Ffilesystem%2Foperations%2Fpermissions.cc?ref=e921c7e5a670ccc758bf58d82065d224a98671d9", "patch": "@@ -86,21 +86,29 @@ test03()\n   create_symlink(f.path, p);\n \n   std::error_code ec = make_error_code(std::errc::no_such_file_or_directory);\n-  std::error_code ec2 = make_error_code(std::errc::invalid_argument);\n   permissions(p, perms::owner_all,\n \t      perm_options::replace|perm_options::nofollow, ec);\n+  bool caught = false;\n+  std::error_code ec2;\n   try\n   {\n     permissions(p, perms::owner_all,\n \t\tperm_options::replace|perm_options::nofollow);\n   }\n   catch (const std::filesystem::filesystem_error& ex)\n   {\n+    caught = true;\n     ec2 = ex.code();\n     VERIFY( ex.path1() == p );\n   }\n   // Both calls should succeed, or both should fail with same error:\n-  VERIFY( ec == ec2 );\n+  if (ec)\n+  {\n+    VERIFY( caught );\n+    VERIFY( ec == ec2 );\n+  }\n+  else\n+    VERIFY( !caught );\n \n   remove(p);\n }\n@@ -114,9 +122,9 @@ test04()\n   create_symlink(__gnu_test::nonexistent_path(), p);\n \n   std::error_code ec = make_error_code(std::errc::no_such_file_or_directory);\n-  std::error_code ec2 = make_error_code(std::errc::invalid_argument);\n   permissions(p, perms::owner_all, ec);\n   VERIFY( ec );\n+  std::error_code ec2;\n   try\n   {\n     permissions(p, perms::owner_all);"}]}