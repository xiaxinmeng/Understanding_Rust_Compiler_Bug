{"sha": "0d83bf5afb378b14c59c1dd88561b824c630bc54", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGQ4M2JmNWFmYjM3OGIxNGM1OWMxZGQ4ODU2MWI4MjRjNjMwYmM1NA==", "commit": {"author": {"name": "Simon Baldwin", "email": "simonb@google.com", "date": "2007-04-23T21:48:37Z"}, "committer": {"name": "Simon Baldwin", "email": "simonb@gcc.gnu.org", "date": "2007-04-23T21:48:37Z"}, "message": "decl.c (grokparms): Added new error for duplicate function parameters names in function prototypes...\n\n\t* cp/decl.c (grokparms): Added new error for duplicate function\n\tparameters names in function prototypes, to match gcc behavior.\n\n\t* testsuite/g++.dg/other/error15.C: New.\n\t* testsuite/g++.dg/cpp0x/variadic-ex9.C: Renamed function parameter to\n\tavoid triggering a \"multiple parameters named\" error.\n\nFrom-SVN: r124083", "tree": {"sha": "4fc1d9e8258125d7d0b0557b043802a87f590779", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4fc1d9e8258125d7d0b0557b043802a87f590779"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0d83bf5afb378b14c59c1dd88561b824c630bc54", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d83bf5afb378b14c59c1dd88561b824c630bc54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0d83bf5afb378b14c59c1dd88561b824c630bc54", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0d83bf5afb378b14c59c1dd88561b824c630bc54/comments", "author": null, "committer": null, "parents": [{"sha": "22099c59a2bcec314301e79cac0488274d3f5f36", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/22099c59a2bcec314301e79cac0488274d3f5f36", "html_url": "https://github.com/Rust-GCC/gccrs/commit/22099c59a2bcec314301e79cac0488274d3f5f36"}], "stats": {"total": 84, "additions": 83, "deletions": 1}, "files": [{"sha": "f3eb5debfd4695f1bbf149cd0d2f17d64849ff56", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=0d83bf5afb378b14c59c1dd88561b824c630bc54", "patch": "@@ -1,3 +1,8 @@\n+2007-04-23  Simon Baldwin  <simonb@google.com>\n+\n+\t* decl.c (grokparms): Added new error for duplicate function\n+\tparameters names in function prototypes, to match gcc behavior.\n+\n 2007-04-23  Jan Hubicka  <jh@suse.cz>\n \n \t* cp/decl2.c (finish_objects): Do not call target constructor/destructor"}, {"sha": "de5338bbc1641ecd48613a1bc3d3e6270a59ee15", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=0d83bf5afb378b14c59c1dd88561b824c630bc54", "patch": "@@ -52,6 +52,7 @@ Boston, MA 02110-1301, USA.  */\n #include \"debug.h\"\n #include \"timevar.h\"\n #include \"tree-flow.h\"\n+#include \"pointer-set.h\"\n \n static tree grokparms (cp_parameter_declarator *, tree *);\n static const char *redeclaration_error_message (tree, tree);\n@@ -8898,6 +8899,7 @@ grokparms (cp_parameter_declarator *first_parm, tree *parms)\n   int ellipsis = !first_parm || first_parm->ellipsis_p;\n   cp_parameter_declarator *parm;\n   int any_error = 0;\n+  struct pointer_set_t *unique_decls = pointer_set_create ();\n \n   for (parm = first_parm; parm != NULL; parm = parm->next)\n     {\n@@ -8982,6 +8984,14 @@ grokparms (cp_parameter_declarator *first_parm, tree *parms)\n           && parm->next)\n         error (\"parameter packs must be at the end of the parameter list\");\n \n+      if (DECL_NAME (decl))\n+        {\n+          if (pointer_set_contains (unique_decls, DECL_NAME (decl)))\n+            error (\"multiple parameters named %qD\", DECL_NAME (decl));\n+          else\n+            pointer_set_insert (unique_decls, DECL_NAME (decl));\n+        }\n+\n       TREE_CHAIN (decl) = decls;\n       decls = decl;\n       result = tree_cons (init, type, result);\n@@ -8992,6 +9002,7 @@ grokparms (cp_parameter_declarator *first_parm, tree *parms)\n     result = chainon (result, void_list_node);\n   *parms = decls;\n \n+  pointer_set_destroy (unique_decls);\n   return result;\n }\n "}, {"sha": "5c9223922bba5c0a3e2e59d1c0fa8d5581d4e373", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=0d83bf5afb378b14c59c1dd88561b824c630bc54", "patch": "@@ -1,3 +1,9 @@\n+2007-04-23  Simon Baldwin  <simonb@google.com>\n+\n+\t* g++.dg/other/error15.C: New.\n+\t* g++.dg/cpp0x/variadic-ex9.C: Renamed function parameter to avoid\n+\ttriggering a \"multiple parameters named\" error.\n+\n 2007-04-23  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/31618"}, {"sha": "74215c99727c1e55a6638d73c29002438e6bbf23", "filename": "gcc/testsuite/g++.dg/cpp0x/variadic-ex9.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic-ex9.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic-ex9.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Fvariadic-ex9.C?ref=0d83bf5afb378b14c59c1dd88561b824c630bc54", "patch": "@@ -1,7 +1,7 @@\n // { dg-options \"-std=gnu++0x\" }\n template<typename... Args>              char& f(Args... args);         // #1\n template<typename T1, typename... Args> short& f(T1 a1, Args... args); // #2\n-template<typename T1, typename T2>      int& f(T1 a2, T2 a2);          // #3\n+template<typename T1, typename T2>      int& f(T1 a2, T2 a3);          // #3\n \n void g() {\n   char& x = f();                      // calls #1"}, {"sha": "0a5bae1b3c0b70872cad9208f4f6771c35076386", "filename": "gcc/testsuite/g++.dg/other/error15.C", "status": "added", "additions": 60, "deletions": 0, "changes": 60, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror15.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0d83bf5afb378b14c59c1dd88561b824c630bc54/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror15.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fother%2Ferror15.C?ref=0d83bf5afb378b14c59c1dd88561b824c630bc54", "patch": "@@ -0,0 +1,60 @@\n+// Test that duplicate function parameters are found in declarations.\n+\n+extern void g0 (int a, int b);\n+extern void g1 (int a, float b);\n+\n+extern void f0 (int a,\n+                int a);  // { dg-error \"multiple parameters named 'a'\" }\n+extern void f1 (int a,\n+                float a);  // { dg-error \"multiple parameters named 'a'\" }\n+extern void f3 (int a, int b, int c,\n+                int a);  // { dg-error \"multiple parameters named 'a'\" }\n+extern void f4 (int a, int b, int c,\n+                int a,\n+                int a);  // { dg-error \"multiple parameters named 'a'\" }\n+extern void f5 (int a, int b, int c, int d, int e, int f, int g, int h,\n+                int a,\n+                int i, int j, int k, int l, int m, int n, int o, int p,\n+                int q, int r, int s, int t, int u, int v, int w, int x, int y,\n+                int z);  // { dg-error \"multiple parameters named 'a'\" }\n+\n+extern void f6 (int a, int, int, int, int, int, int, int, int, int, int,\n+                int a,\n+                int, int, int, int, int, int, int, int, int, int, int,\n+                float, float, float, float, float, float, float, float,\n+                int);  // { dg-error \"multiple parameters named 'a'\" }\n+\n+extern void f7 (void (*a)(int),\n+                void (*a)(int));  // { dg-error \"multiple parameters named 'a'\" }\n+extern void f8 (float (*a)(int),\n+                int (*a)(float));  // { dg-error \"multiple parameters named 'a'\" }\n+\n+extern void f9 (int a,\n+                int a,\n+                int a);\n+// { dg-error \"multiple parameters named 'a'\" \"\" { target *-*-* } 34 }\n+\n+extern void f10 (int a,\n+                 int b,\n+                 int c,\n+                 int c,\n+                 int b,\n+                 int a);\n+// { dg-error \"multiple parameters named 'a'\" \"\" { target *-*-* } 42 }\n+// { dg-error \"multiple parameters named 'b'\" \"\" { target *-*-* } 42 }\n+// { dg-error \"multiple parameters named 'c'\" \"\" { target *-*-* } 42 }\n+\n+class C1 {\n+ public:\n+  void C1_g0 (int a, int b);\n+  void C1_f0 (int a,\n+              int a);  // { dg-error \"multiple parameters named 'a'\" }\n+};\n+\n+template <class T>\n+class C2 {\n+ public:\n+  void C2_g0 (T a, T b);\n+  void C2_f0 (T a,\n+              T a);  // { dg-error \"multiple parameters named 'a'\" }\n+};"}]}