{"sha": "ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWU2ZjJhMWM4ZjNlMzdlYjgyNTI3ZTUyYjg5NjFkYWEyYmI3ZTY1Mg==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@codesourcery.com", "date": "2001-09-05T17:48:26Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2001-09-05T17:48:26Z"}, "message": "function.c (ggc_mark_struct_function): Mark f->outer.\n\n\t* function.c (ggc_mark_struct_function): Mark f->outer.\n\t* toplev.c (rest_of_compilation): Clear DECL_SAVED_INSNS here...\n\t* integrate.c (output_inline_function): ... not here.\n\nFrom-SVN: r45419", "tree": {"sha": "97c534b8bbefaf5aa35ed9ba21f1d2ca66906f42", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/97c534b8bbefaf5aa35ed9ba21f1d2ca66906f42"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/comments", "author": null, "committer": null, "parents": [{"sha": "c946ec44f8df9914de1f6719db783a2b62be4fd7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c946ec44f8df9914de1f6719db783a2b62be4fd7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c946ec44f8df9914de1f6719db783a2b62be4fd7"}], "stats": {"total": 24, "additions": 18, "deletions": 6}, "files": [{"sha": "259a22a7ef09c3da6ecb38fde24d2ff318114686", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "patch": "@@ -1,3 +1,9 @@\n+2001-09-05  Zack Weinberg  <zack@codesourcery.com>\n+\n+\t* function.c (ggc_mark_struct_function): Mark f->outer.\n+\t* toplev.c (rest_of_compilation): Clear DECL_SAVED_INSNS here...\n+\t* integrate.c (output_inline_function): ... not here.\n+\n Wed Sep  5 17:28:49 CEST 2001  Jan Hubicka  <jh@suse.cz>\n \n \t* profile.c (branch_prob): Call add_noreturn_fake_exit_edges."}, {"sha": "f2beb9f4373a88b3c88775aee431e426277aa657", "filename": "gcc/function.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "patch": "@@ -7706,6 +7706,8 @@ ggc_mark_struct_function (f)\n     ggc_mark_rtvec ((rtvec) f->original_arg_vector);\n   if (f->original_decl_initial)\n     ggc_mark_tree (f->original_decl_initial);\n+  if (f->outer)\n+    ggc_mark_struct_function (f->outer);\n }\n \n /* Called once, at initialization, to initialize function.c.  */"}, {"sha": "cdf368e8215d5e8c9d883efa6a5fee6b1ee7f211", "filename": "gcc/integrate.c", "status": "modified", "additions": 3, "deletions": 5, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2Fintegrate.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2Fintegrate.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fintegrate.c?ref=ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "patch": "@@ -2899,13 +2899,11 @@ output_inline_function (fndecl)\n      before it gets mangled by optimization.  */\n   (*debug_hooks->outlining_inline_function) (fndecl);\n \n-  /* Compile this function all the way down to assembly code.  */\n+  /* Compile this function all the way down to assembly code.  As a\n+     side effect this destroys the saved RTL representation, but\n+     that's okay, because we don't need to inline this anymore.  */\n   rest_of_compilation (fndecl);\n-\n-  /* We can't inline this anymore; rest_of_compilation destroyed the\n-     data structures describing the function.  */\n   DECL_INLINE (fndecl) = 0;\n-  DECL_SAVED_INSNS (fndecl) = 0;\n \n   cfun = old_cfun;\n   current_function_decl = old_cfun ? old_cfun->decl : 0;"}, {"sha": "f9f02f3f937a0b0492ebd80f35d5e13dc9ed391e", "filename": "gcc/toplev.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=ae6f2a1c8f3e37eb82527e52b8961daa2bb7e652", "patch": "@@ -3773,7 +3773,13 @@ rest_of_compilation (decl)\n   /* We're done with this function.  Free up memory if we can.  */\n   free_after_parsing (cfun);\n   if (! DECL_DEFER_OUTPUT (decl))\n-    free_after_compilation (cfun);\n+    {\n+      free_after_compilation (cfun);\n+\n+      /* Clear integrate.c's pointer to the cfun structure we just\n+\t destroyed.  */\n+      DECL_SAVED_INSNS (decl) = 0;\n+    }\n   cfun = 0;\n \n   ggc_collect ();"}]}