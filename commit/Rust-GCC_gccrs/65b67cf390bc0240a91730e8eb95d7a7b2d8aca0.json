{"sha": "65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjViNjdjZjM5MGJjMDI0MGE5MTczMGU4ZWI5NWQ3YTdiMmQ4YWNhMA==", "commit": {"author": {"name": "Tobias Burnus", "email": "tobias@codesourcery.com", "date": "2019-10-08T12:30:44Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2019-10-08T12:30:44Z"}, "message": "Fortran - fix OpenMP 'target simd'\n\n\tgcc/fortran/\n\t* parse.c (parse_executable): Add missing ST_OMP_TARGET_SIMD.\n\n\tlibgomp/\n\t* testsuite/libgomp.fortran/target-simd.f90: New.\n\nFrom-SVN: r276698", "tree": {"sha": "b10fb9025ed0c26d31a8bc2f3390aa3f8cfba6de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b10fb9025ed0c26d31a8bc2f3390aa3f8cfba6de"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "07f37a7fd4b84f996264b7498c55ac333efd4db9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07f37a7fd4b84f996264b7498c55ac333efd4db9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07f37a7fd4b84f996264b7498c55ac333efd4db9"}], "stats": {"total": 35, "additions": 35, "deletions": 0}, "files": [{"sha": "b5bef54a29733c53f44e2c72e489814f1e63f53d", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "patch": "@@ -1,3 +1,7 @@\n+2019-10-08  Tobias Burnus  <tobias@codesourcery.com>\n+\n+\t* parse.c (parse_executable): Add missing ST_OMP_TARGET_SIMD.\n+\n 2019-10-08  Tobias Burnus  <tobias@codesourcery.com>\n \n \t* match.h (gfc_match_omp_eos_error): Renamed from gfc_match_omp_eos."}, {"sha": "15f6bf2937c4a18bf33881254afe181006110904", "filename": "gcc/fortran/parse.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/gcc%2Ffortran%2Fparse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/gcc%2Ffortran%2Fparse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fparse.c?ref=65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "patch": "@@ -5534,6 +5534,7 @@ parse_executable (gfc_statement st)\n \tcase ST_OMP_SIMD:\n \tcase ST_OMP_TARGET_PARALLEL_DO:\n \tcase ST_OMP_TARGET_PARALLEL_DO_SIMD:\n+\tcase ST_OMP_TARGET_SIMD:\n \tcase ST_OMP_TARGET_TEAMS_DISTRIBUTE:\n \tcase ST_OMP_TARGET_TEAMS_DISTRIBUTE_PARALLEL_DO:\n \tcase ST_OMP_TARGET_TEAMS_DISTRIBUTE_PARALLEL_DO_SIMD:"}, {"sha": "67d5737e5e8bb9e57a06bfcdd953a9f5c67c4ded", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "patch": "@@ -1,3 +1,7 @@\n+2019-10-08  Tobias Burnus  <tobias@codesourcery.com>\n+\n+\t* gfortran.dg/gomp/target-simd.f90: New.\n+\n 2019-10-02  Julian Brown  <julian@codesourcery.com>\n \t    Cesar Philippidis  <cesar@codesourcery.com>\n "}, {"sha": "d49ae74af8fdc2fe23e30264d4df4ae0497a24ff", "filename": "libgomp/testsuite/libgomp.fortran/target-simd.f90", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/libgomp%2Ftestsuite%2Flibgomp.fortran%2Ftarget-simd.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/65b67cf390bc0240a91730e8eb95d7a7b2d8aca0/libgomp%2Ftestsuite%2Flibgomp.fortran%2Ftarget-simd.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Ftarget-simd.f90?ref=65b67cf390bc0240a91730e8eb95d7a7b2d8aca0", "patch": "@@ -0,0 +1,26 @@\n+! { dg-do run }\n+\n+program test\n+  implicit none\n+  real, allocatable :: a(:), b(:)\n+  integer :: i\n+\n+  a = [(i, i = 1, 100)]\n+  allocate(b, mold=a)\n+  b = 0\n+\n+  !$omp target simd map(to:a) map(from:b)\n+  do i = 0, size(a)\n+    b(i) = 5.0 * a(i)\n+  end do\n+\n+  if (any (b - 5.0 *a > 10.0*epsilon(a))) call abort()\n+\n+  !$omp target simd map(to:a) map(from:b)\n+  do i = 0, size(a)\n+    b(i) = 2.0 * a(i)\n+  end do\n+  !$omp end target simd\n+\n+  if (any (b - 2.0 *a > 10.0*epsilon(a))) call abort()\n+end program test"}]}