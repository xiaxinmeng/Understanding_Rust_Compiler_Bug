{"sha": "4b5337e60efa264137d1a65e12c612cb50e98b42", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGI1MzM3ZTYwZWZhMjY0MTM3ZDFhNjVlMTJjNjEyY2I1MGU5OGI0Mg==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2014-08-15T07:51:35Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2014-08-15T07:51:35Z"}, "message": "data-streamer.h (streamer_string_index, [...]): Remove.\n\n2014-08-15  Richard Biener  <rguenther@suse.de>\n\n\t* data-streamer.h (streamer_string_index, string_for_index):\n\tRemove.\n\t* data-streamer-out.c (streamer_string_index): Make static.\n\t* data-streamer-in.c (string_for_index): Likewise.\n\t* lto-streamer-out.c (lto_output_location): Use bp_pack_string.\n\t* lto-streamer-in.c (lto_input_location): Use bp_unpack_string.\n\nFrom-SVN: r214007", "tree": {"sha": "20b43de3f2a32065f638708f880e84e66d33080b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/20b43de3f2a32065f638708f880e84e66d33080b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b5337e60efa264137d1a65e12c612cb50e98b42", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b5337e60efa264137d1a65e12c612cb50e98b42", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b5337e60efa264137d1a65e12c612cb50e98b42", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b5337e60efa264137d1a65e12c612cb50e98b42/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6e2028ff0f24561125d465b3c8d6acc88d4d82dc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e2028ff0f24561125d465b3c8d6acc88d4d82dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e2028ff0f24561125d465b3c8d6acc88d4d82dc"}], "stats": {"total": 27, "additions": 13, "deletions": 14}, "files": [{"sha": "3134daa6f0a83d01981de0e5c9fd8d0ed36ac570", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4b5337e60efa264137d1a65e12c612cb50e98b42", "patch": "@@ -1,3 +1,12 @@\n+2014-08-15  Richard Biener  <rguenther@suse.de>\n+\n+\t* data-streamer.h (streamer_string_index, string_for_index):\n+\tRemove.\n+\t* data-streamer-out.c (streamer_string_index): Make static.\n+\t* data-streamer-in.c (string_for_index): Likewise.\n+\t* lto-streamer-out.c (lto_output_location): Use bp_pack_string.\n+\t* lto-streamer-in.c (lto_input_location): Use bp_unpack_string.\n+\n 2014-08-15  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/62031"}, {"sha": "ea1628c30dcf962b2fddbbebcb024545d0403fca", "filename": "gcc/data-streamer-in.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Fdata-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Fdata-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdata-streamer-in.c?ref=4b5337e60efa264137d1a65e12c612cb50e98b42", "patch": "@@ -36,7 +36,7 @@ along with GCC; see the file COPYING3.  If not see\n /* Read a string from the string table in DATA_IN using input block\n    IB.  Write the length to RLEN.  */\n \n-const char *\n+static const char *\n string_for_index (struct data_in *data_in, unsigned int loc, unsigned int *rlen)\n {\n   unsigned int len;"}, {"sha": "4b904767b231fdfa0753326e5b8c26ddf6583af5", "filename": "gcc/data-streamer-out.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Fdata-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Fdata-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdata-streamer-out.c?ref=4b5337e60efa264137d1a65e12c612cb50e98b42", "patch": "@@ -81,7 +81,7 @@ lto_append_block (struct lto_output_stream *obs)\n    When PERSISTENT is set, the string S is supposed to not change during\n    duration of the OB and thus OB can keep pointer into it.  */\n \n-unsigned\n+static unsigned\n streamer_string_index (struct output_block *ob, const char *s, unsigned int len,\n \t\t       bool persistent)\n {"}, {"sha": "eb3709ab550b2f97b743a04cd62018b69281d559", "filename": "gcc/data-streamer.h", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Fdata-streamer.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Fdata-streamer.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdata-streamer.h?ref=4b5337e60efa264137d1a65e12c612cb50e98b42", "patch": "@@ -57,8 +57,6 @@ void streamer_write_hwi (struct output_block *, HOST_WIDE_INT);\n void streamer_write_gcov_count (struct output_block *, gcov_type);\n void streamer_write_string (struct output_block *, struct lto_output_stream *,\n \t\t\t    const char *, bool);\n-unsigned streamer_string_index (struct output_block *, const char *,\n-\t\t\t\tunsigned int, bool);\n void streamer_write_string_with_length (struct output_block *,\n \t\t\t\t\tstruct lto_output_stream *,\n \t\t\t\t\tconst char *, unsigned int, bool);\n@@ -74,7 +72,6 @@ void streamer_write_data_stream (struct lto_output_stream *, const void *,\n \t\t\t\t size_t);\n \n /* In data-streamer-in.c  */\n-const char *string_for_index (struct data_in *, unsigned int, unsigned int *);\n const char *streamer_read_string (struct data_in *, struct lto_input_block *);\n const char *streamer_read_indexed_string (struct data_in *,\n \t\t\t\t\t  struct lto_input_block *,"}, {"sha": "f6488d84b2a5071a3199beff9eb6a3dd8a5658af", "filename": "gcc/lto-streamer-in.c", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Flto-streamer-in.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Flto-streamer-in.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-in.c?ref=4b5337e60efa264137d1a65e12c612cb50e98b42", "patch": "@@ -154,7 +154,6 @@ lto_input_location (struct bitpack_d *bp, struct data_in *data_in)\n   static int current_line;\n   static int current_col;\n   bool file_change, line_change, column_change;\n-  unsigned len;\n   bool prev_file = current_file != NULL;\n \n   if (bp_unpack_value (bp, 1))\n@@ -165,10 +164,7 @@ lto_input_location (struct bitpack_d *bp, struct data_in *data_in)\n   column_change = bp_unpack_value (bp, 1);\n \n   if (file_change)\n-    current_file = canon_file_name\n-\t\t     (string_for_index (data_in,\n-\t\t\t\t\tbp_unpack_var_len_unsigned (bp),\n-\t\t\t\t\t&len));\n+    current_file = canon_file_name (bp_unpack_string (data_in, bp));\n \n   if (line_change)\n     current_line = bp_unpack_var_len_unsigned (bp);"}, {"sha": "1dc37efc2b89ce77452a14d3189da886a99441f8", "filename": "gcc/lto-streamer-out.c", "status": "modified", "additions": 1, "deletions": 4, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Flto-streamer-out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b5337e60efa264137d1a65e12c612cb50e98b42/gcc%2Flto-streamer-out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-streamer-out.c?ref=4b5337e60efa264137d1a65e12c612cb50e98b42", "patch": "@@ -189,10 +189,7 @@ lto_output_location (struct output_block *ob, struct bitpack_d *bp,\n   bp_pack_value (bp, ob->current_col != xloc.column, 1);\n \n   if (ob->current_file != xloc.file)\n-    bp_pack_var_len_unsigned (bp,\n-\t                      streamer_string_index (ob, xloc.file,\n-\t\t\t\t\t\t     strlen (xloc.file) + 1,\n-\t\t\t\t\t\t     true));\n+    bp_pack_string (ob, bp, xloc.file, true);\n   ob->current_file = xloc.file;\n \n   if (ob->current_line != xloc.line)"}]}