{"sha": "f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjE2NjQxM2FlMGUzZGQ3NmJjOGM4M2Q5ODY1YmNmZjIwZDU2MjNhYQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-12T13:27:47Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-10-12T13:27:47Z"}, "message": "[multiple changes]\n\n2010-10-12  Vincent Celier  <celier@adacore.com>\n\n\t* prj-nmsc.adb (Add_Source): Put source in hash table Source_Files_HT\n\t(Process_Exceptions_File_Based): Use hash table Source_Files_HT, instead\n\tof iterating through all sources of the project.\n\t* prj.adb (Free): Reset hash table Source_Files_HT\n\t(Reset): Reset hash table Source_Files_HT\n\t* prj.ads (Source_Data): New component Next_With_File_Name\n\t(Source_Files_Htable): New hash table\n\t(Project_Tree_Data): New component Source_Files_HT\n\n2010-10-12  Tristan Gingold  <gingold@adacore.com>\n\n\t* g-trasym-vms-ia64.adb: Use the documented API.\n\t* gcc-interface/Makefile.in: Always set NO_REORDER_ADAFLAGS.\n\t* gcc-interface/Make-lang.in: Update dependencies.\n\nFrom-SVN: r165377", "tree": {"sha": "aadcfaffb243a9d9f6f05b2277180fd10c5f47fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aadcfaffb243a9d9f6f05b2277180fd10c5f47fe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/comments", "author": null, "committer": null, "parents": [{"sha": "d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d80ee77c1eff34e01d2110cd29d450d8f8427ac8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d80ee77c1eff34e01d2110cd29d450d8f8427ac8"}], "stats": {"total": 362, "additions": 230, "deletions": 132}, "files": [{"sha": "3fd613afd5fba6a54469a3b784275568b6c4b51e", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "patch": "@@ -1,3 +1,20 @@\n+2010-10-12  Vincent Celier  <celier@adacore.com>\n+\n+\t* prj-nmsc.adb (Add_Source): Put source in hash table Source_Files_HT\n+\t(Process_Exceptions_File_Based): Use hash table Source_Files_HT, instead\n+\tof iterating through all sources of the project.\n+\t* prj.adb (Free): Reset hash table Source_Files_HT\n+\t(Reset): Reset hash table Source_Files_HT\n+\t* prj.ads (Source_Data): New component Next_With_File_Name\n+\t(Source_Files_Htable): New hash table\n+\t(Project_Tree_Data): New component Source_Files_HT\n+\n+2010-10-12  Tristan Gingold  <gingold@adacore.com>\n+\n+\t* g-trasym-vms-ia64.adb: Use the documented API.\n+\t* gcc-interface/Makefile.in: Always set NO_REORDER_ADAFLAGS.\n+\t* gcc-interface/Make-lang.in: Update dependencies.\n+\n 2010-10-12  Thomas Quinot  <quinot@adacore.com>\n \n \t* rtsfind.ads, exp_dist.adb, exp_dist.ads (Build_General_Calling_Stubs,"}, {"sha": "a3ddf04c407d2d3f3c5ff481bf59954daf922023", "filename": "gcc/ada/g-trasym-vms-ia64.adb", "status": "modified", "additions": 128, "deletions": 69, "changes": 197, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fg-trasym-vms-ia64.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fg-trasym-vms-ia64.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-trasym-vms-ia64.adb?ref=f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---         Copyright (C) 2005-2009, Free Software Foundation, Inc.          --\n+--         Copyright (C) 2005-2010, Free Software Foundation, Inc.          --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -39,9 +39,6 @@ with System.Traceback_Entries;\n \n package body GNAT.Traceback.Symbolic is\n \n-   pragma Warnings (Off); --  ??? needs comment\n-   pragma Linker_Options (\"--for-linker=sys$library:trace.exe\");\n-\n    use System;\n    use System.Aux_DEC;\n    use System.Traceback_Entries;\n@@ -67,16 +64,43 @@ package body GNAT.Traceback.Symbolic is\n \n    subtype Cond_Value_Type is Unsigned_Longword;\n \n-   function Symbolize\n-     (Current_PC    : Address;\n-      Filename_Dsc  : Address;\n-      Library_Dsc   : Address;\n-      Record_Number : Address;\n-      Image_Dsc     : Address;\n-      Module_Dsc    : Address;\n-      Routine_Dsc   : Address;\n-      Line_Number   : Address;\n-      Relative_PC   : Address) return Cond_Value_Type;\n+   --  TBK_API_PARAM as defined in TBKDEF.\n+   type Tbk_Api_Param is record\n+      Length              : Unsigned_Word;\n+      T_Type              : Unsigned_Byte;\n+      Version             : Unsigned_Byte;\n+      Reserveda           : Unsigned_Longword;\n+      Faulting_Pc         : Address;\n+      Faulting_Fp         : Address;\n+      Filename_Desc       : Address;\n+      Library_Module_Desc : Address;\n+      Record_Number       : Address;\n+      Image_Desc          : Address;\n+      Module_Desc         : Address;\n+      Routine_Desc        : Address;\n+      Listing_Lineno      : Address;\n+      Rel_Pc              : Address;\n+      Image_Base_Addr     : Address;\n+      Module_Base_Addr    : Address;\n+      Malloc_Rtn          : Address;\n+      Free_Rtn            : Address;\n+      Symbolize_Flags     : Address;\n+      Reserved0           : Unsigned_Quadword;\n+      Reserved1           : Unsigned_Quadword;\n+      Reserved2           : Unsigned_Quadword;\n+   end record;\n+   pragma Convention (C, Tbk_Api_Param);\n+\n+   K_Version : constant Unsigned_Byte := 1;\n+   --  Current API version.\n+   K_Length  : constant Unsigned_Word := 152;\n+   --  Length of the parameter.\n+\n+   pragma Compile_Time_Error (Tbk_Api_Param'Size = K_Length * 8,\n+                              \"Bad length for tbk_api_param\");\n+   --  Sanity check.\n+\n+   function Symbolize (Param : Address) return Cond_Value_Type;\n    pragma Import (C, Symbolize, \"TBK$I64_SYMBOLIZE\");\n \n    function Decode_Ada_Name (Encoded_Name : String) return String;\n@@ -173,20 +197,16 @@ package body GNAT.Traceback.Symbolic is\n    ------------------------\n \n    function Symbolic_Traceback (Traceback : Tracebacks_Array) return String is\n+      Param         : Tbk_Api_Param;\n       Status        : Cond_Value_Type;\n-      Filename_Name : Var_String;\n-      Filename_Dsc  : Descriptor64;\n-      Library_Name  : Var_String;\n-      Library_Dsc   : Descriptor64;\n-      Record_Number : Integer_64;\n+      Record_Number : Unsigned_Longword;\n       Image_Name    : Var_String;\n       Image_Dsc     : Descriptor64;\n       Module_Name   : Var_String;\n       Module_Dsc    : Descriptor64;\n       Routine_Name  : Var_String;\n       Routine_Dsc   : Descriptor64;\n-      Line_Number   : Integer_64;\n-      Relative_PC   : Integer_64;\n+      Line_Number   : Unsigned_Longword;\n       Res           : String (1 .. 256 * Traceback'Length);\n       Len           : Integer;\n \n@@ -201,68 +221,107 @@ package body GNAT.Traceback.Symbolic is\n \n       System.Soft_Links.Lock_Task.all;\n \n-      Setup_Descriptor64_Vs (Filename_Dsc, Filename_Name'Address);\n-      Setup_Descriptor64_Vs (Library_Dsc, Library_Name'Address);\n+      --  Initialize descriptors\n+\n       Setup_Descriptor64_Vs (Image_Dsc, Image_Name'Address);\n       Setup_Descriptor64_Vs (Module_Dsc, Module_Name'Address);\n       Setup_Descriptor64_Vs (Routine_Dsc, Routine_Name'Address);\n \n       for J in Traceback'Range loop\n-         Status := Symbolize\n-           (PC_For (Traceback (J)),\n-            Filename_Dsc'Address,\n-            Library_Dsc'Address,\n-            Record_Number'Address,\n-            Image_Dsc'Address,\n-            Module_Dsc'Address,\n-            Routine_Dsc'Address,\n-            Line_Number'Address,\n-            Relative_PC'Address);\n-\n-         declare\n-            First : Integer := Len + 1;\n-            Last  : Integer := First + 80 - 1;\n-            Pos   : Integer;\n-\n-            Routine_Name_D : String :=\n-                               Decode_Ada_Name\n-                                 (Routine_Name.Buf\n+         --  Initialize fields in case they are not written\n+\n+         Record_Number := 0;\n+         Line_Number := 0;\n+         Image_Name.Curlen := 0;\n+         Module_Name.Curlen := 0;\n+         Routine_Name.Curlen := 0;\n+\n+         --  Symbolize\n+\n+         Param := (Length              => K_Length,\n+                   T_Type              => 0,\n+                   Version             => K_Version,\n+                   Reserveda           => 0,\n+                   Faulting_Pc         => PC_For (Traceback (J)),\n+                   Faulting_Fp         => 0,\n+                   Filename_Desc       => Null_Address,\n+                   Library_Module_Desc => Null_Address,\n+                   Record_Number => Record_Number'Address,\n+                   Image_Desc       => Image_Dsc'Address,\n+                   Module_Desc      => Module_Dsc'Address,\n+                   Routine_Desc     => Routine_Dsc'Address,\n+                   Listing_Lineno   => Line_Number'Address,\n+                   Rel_Pc           => Null_Address,\n+                   Image_Base_Addr  => Null_Address,\n+                   Module_Base_Addr => Null_Address,\n+                   Malloc_Rtn       => Null_Address,\n+                   Free_Rtn         => Null_Address,\n+                   Symbolize_Flags  => Null_Address,\n+                   Reserved0        => (0, 0),\n+                   Reserved1        => (0, 0),\n+                   Reserved2        => (0, 0));\n+\n+         Status := Symbolize (Param'Address);\n+\n+         if (Status rem 2) = 1 then\n+\n+            --  Success\n+\n+            if Line_Number = 0 then\n+               --  As GCC doesn't emit source file correlation, use record\n+               --  number of line number is not set\n+\n+               Line_Number := Record_Number;\n+            end if;\n+\n+            declare\n+               First : constant Integer := Len + 1;\n+               Last  : Integer := First + 80 - 1;\n+               Pos   : Integer;\n+\n+               Routine_Name_D : constant String :=\n+                 Decode_Ada_Name (Routine_Name.Buf\n                                     (1 .. Natural (Routine_Name.Curlen)));\n \n-         begin\n-            Res (First .. Last) := (others => ' ');\n+               Lineno : constant String :=\n+                 Unsigned_Longword'Image (Line_Number);\n \n-            Res (First .. First + Natural (Image_Name.Curlen) - 1) :=\n-              Image_Name.Buf (1 .. Natural (Image_Name.Curlen));\n+            begin\n+               Res (First .. Last) := (others => ' ');\n \n-            Res (First + 10 ..\n-                 First + 10 + Natural (Module_Name.Curlen) - 1) :=\n-              Module_Name.Buf (1 .. Natural (Module_Name.Curlen));\n+               Res (First .. First + Natural (Image_Name.Curlen) - 1) :=\n+                 Image_Name.Buf (1 .. Natural (Image_Name.Curlen));\n \n-            Res (First + 30 ..\n-                 First + 30 + Routine_Name_D'Length - 1) :=\n-              Routine_Name_D;\n+               Res (First + 10 ..\n+                      First + 10 + Natural (Module_Name.Curlen) - 1) :=\n+                 Module_Name.Buf (1 .. Natural (Module_Name.Curlen));\n \n-            --  If routine name doesn't fit 20 characters, output\n-            --  the line number on next line at 50th position\n+               Res (First + 30 ..\n+                      First + 30 + Routine_Name_D'Length - 1) :=\n+                 Routine_Name_D;\n \n-            if Routine_Name_D'Length > 20 then\n-               Pos := First + 30 + Routine_Name_D'Length;\n-               Res (Pos) := ASCII.LF;\n-               Last := Pos + 80;\n-               Res (Pos + 1 .. Last) := (others => ' ');\n-               Pos := Pos + 51;\n-            else\n-               Pos := First + 50;\n-            end if;\n+               --  If routine name doesn't fit 20 characters, output\n+               --  the line number on next line at 50th position\n \n-            Res (Pos ..\n-                 Pos + Integer_64'Image (Line_Number)'Length - 1) :=\n-              Integer_64'Image (Line_Number);\n+               if Routine_Name_D'Length > 20 then\n+                  Pos := First + 30 + Routine_Name_D'Length;\n+                  Res (Pos) := ASCII.LF;\n+                  Last := Pos + 80;\n+                  Res (Pos + 1 .. Last) := (others => ' ');\n+                  Pos := Pos + 51;\n+               else\n+                  Pos := First + 50;\n+               end if;\n \n-            Res (Last) := ASCII.LF;\n-            Len := Last;\n-         end;\n+               Res (Pos .. Pos + Lineno'Length - 1) := Lineno;\n+\n+               Res (Last) := ASCII.LF;\n+               Len := Last;\n+            end;\n+         else\n+            Res (Len + 1 .. Len + 6) := \"ERROR\" & ASCII.LF;\n+            Len := Len + 6;\n+         end if;\n       end loop;\n \n       System.Soft_Links.Unlock_Task.all;"}, {"sha": "aa8403ea7acec532261efda1ca296033da2ef49c", "filename": "gcc/ada/gcc-interface/Make-lang.in", "status": "modified", "additions": 53, "deletions": 49, "changes": 102, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fgcc-interface%2FMake-lang.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fgcc-interface%2FMake-lang.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMake-lang.in?ref=f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "patch": "@@ -1385,11 +1385,12 @@ ada/back_end.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/sinfo.adb ada/sinput.ads ada/sinput.adb ada/snames.ads \\\n    ada/stand.ads ada/stringt.ads ada/switch.ads ada/switch-c.ads \\\n    ada/system.ads ada/s-exctab.ads ada/s-htable.ads ada/s-imenne.ads \\\n-   ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads ada/s-stalib.ads \\\n-   ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads \\\n-   ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads ada/table.adb \\\n-   ada/tree_io.ads ada/types.ads ada/uintp.ads ada/uintp.adb ada/uname.ads \\\n-   ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n+   ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads ada/s-secsta.ads \\\n+   ada/s-stalib.ads ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads \\\n+   ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads \\\n+   ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads ada/uintp.adb \\\n+   ada/uname.ads ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads \\\n+   ada/widechar.ads \n \n ada/bcheck.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/ali.ads ada/ali-util.ads ada/ali-util.adb \\\n@@ -2721,13 +2722,13 @@ ada/lib-load.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/stringt.ads ada/style.ads ada/styleg.ads ada/styleg.adb \\\n    ada/stylesw.ads ada/system.ads ada/s-crc32.ads ada/s-crc32.adb \\\n    ada/s-exctab.ads ada/s-htable.ads ada/s-imenne.ads ada/s-memory.ads \\\n-   ada/s-os_lib.ads ada/s-parame.ads ada/s-rident.ads ada/s-soflin.ads \\\n-   ada/s-stache.ads ada/s-stalib.ads ada/s-stoele.ads ada/s-stoele.adb \\\n-   ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads ada/s-utf_32.ads \\\n-   ada/s-wchcon.ads ada/table.ads ada/table.adb ada/tbuild.ads \\\n-   ada/tbuild.adb ada/tree_io.ads ada/types.ads ada/uintp.ads \\\n-   ada/uintp.adb ada/uname.ads ada/unchconv.ads ada/unchdeal.ads \\\n-   ada/urealp.ads ada/widechar.ads \n+   ada/s-os_lib.ads ada/s-parame.ads ada/s-rident.ads ada/s-secsta.ads \\\n+   ada/s-soflin.ads ada/s-stache.ads ada/s-stalib.ads ada/s-stoele.ads \\\n+   ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads \\\n+   ada/s-utf_32.ads ada/s-wchcon.ads ada/table.ads ada/table.adb \\\n+   ada/tbuild.ads ada/tbuild.adb ada/tree_io.ads ada/types.ads \\\n+   ada/uintp.ads ada/uintp.adb ada/uname.ads ada/unchconv.ads \\\n+   ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n \n ada/lib-util.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/debug.ads ada/hostparm.ads \\\n@@ -2758,12 +2759,13 @@ ada/lib-writ.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/styleg.ads ada/styleg.adb ada/stylesw.ads ada/system.ads \\\n    ada/s-casuti.ads ada/s-crc32.ads ada/s-crc32.adb ada/s-exctab.ads \\\n    ada/s-htable.ads ada/s-imenne.ads ada/s-memory.ads ada/s-os_lib.ads \\\n-   ada/s-parame.ads ada/s-rident.ads ada/s-soflin.ads ada/s-stache.ads \\\n-   ada/s-stalib.ads ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads \\\n-   ada/s-traent.ads ada/s-unstyp.ads ada/s-utf_32.ads ada/s-wchcon.ads \\\n-   ada/table.ads ada/table.adb ada/tbuild.ads ada/tbuild.adb \\\n-   ada/tree_io.ads ada/types.ads ada/uintp.ads ada/uintp.adb ada/uname.ads \\\n-   ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n+   ada/s-parame.ads ada/s-rident.ads ada/s-secsta.ads ada/s-soflin.ads \\\n+   ada/s-stache.ads ada/s-stalib.ads ada/s-stoele.ads ada/s-stoele.adb \\\n+   ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads ada/s-utf_32.ads \\\n+   ada/s-wchcon.ads ada/table.ads ada/table.adb ada/tbuild.ads \\\n+   ada/tbuild.adb ada/tree_io.ads ada/types.ads ada/uintp.ads \\\n+   ada/uintp.adb ada/uname.ads ada/unchconv.ads ada/unchdeal.ads \\\n+   ada/urealp.ads ada/widechar.ads \n \n ada/lib-xref.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/aspects.ads ada/atree.ads \\\n@@ -2780,10 +2782,10 @@ ada/lib-xref.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/sinfo.adb ada/sinput.ads ada/sinput.adb ada/snames.ads \\\n    ada/stand.ads ada/stringt.ads ada/system.ads ada/s-exctab.ads \\\n    ada/s-htable.ads ada/s-imenne.ads ada/s-memory.ads ada/s-os_lib.ads \\\n-   ada/s-parame.ads ada/s-rident.ads ada/s-stalib.ads ada/s-stoele.ads \\\n-   ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads \\\n-   ada/s-wchcon.ads ada/table.ads ada/table.adb ada/tree_io.ads \\\n-   ada/types.ads ada/uintp.ads ada/uintp.adb ada/uname.ads \\\n+   ada/s-parame.ads ada/s-rident.ads ada/s-secsta.ads ada/s-stalib.ads \\\n+   ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads \\\n+   ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads ada/table.adb \\\n+   ada/tree_io.ads ada/types.ads ada/uintp.ads ada/uintp.adb ada/uname.ads \\\n    ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n \n ada/lib.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads ada/a-uncdea.ads \\\n@@ -2956,12 +2958,12 @@ ada/par_sco.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/scos.ads ada/sinfo.ads ada/sinfo.adb ada/sinput.ads ada/sinput.adb \\\n    ada/snames.ads ada/stand.ads ada/stringt.ads ada/system.ads \\\n    ada/s-exctab.ads ada/s-htable.ads ada/s-htable.adb ada/s-imenne.ads \\\n-   ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads ada/s-stalib.ads \\\n-   ada/s-stoele.ads ada/s-stoele.adb ada/s-strhas.ads ada/s-string.ads \\\n-   ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads \\\n-   ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads ada/uintp.adb \\\n-   ada/uname.ads ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads \\\n-   ada/widechar.ads \n+   ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads ada/s-secsta.ads \\\n+   ada/s-stalib.ads ada/s-stoele.ads ada/s-stoele.adb ada/s-strhas.ads \\\n+   ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads \\\n+   ada/table.ads ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads \\\n+   ada/uintp.adb ada/uname.ads ada/unchconv.ads ada/unchdeal.ads \\\n+   ada/urealp.ads ada/widechar.ads \n \n ada/prep.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/casing.ads ada/csets.ads \\\n@@ -3877,11 +3879,12 @@ ada/sem_elim.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/sinfo.adb ada/sinput.ads ada/sinput.adb ada/snames.ads \\\n    ada/stand.ads ada/stringt.ads ada/system.ads ada/s-exctab.ads \\\n    ada/s-htable.ads ada/s-htable.adb ada/s-imenne.ads ada/s-memory.ads \\\n-   ada/s-os_lib.ads ada/s-parame.ads ada/s-stalib.ads ada/s-strhas.ads \\\n-   ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads \\\n-   ada/table.ads ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads \\\n-   ada/uintp.adb ada/uname.ads ada/unchconv.ads ada/unchdeal.ads \\\n-   ada/urealp.ads ada/widechar.ads \n+   ada/s-os_lib.ads ada/s-parame.ads ada/s-secsta.ads ada/s-stalib.ads \\\n+   ada/s-stoele.ads ada/s-stoele.adb ada/s-strhas.ads ada/s-string.ads \\\n+   ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads \\\n+   ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads ada/uintp.adb \\\n+   ada/uname.ads ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads \\\n+   ada/widechar.ads \n \n ada/sem_eval.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/aspects.ads ada/atree.ads \\\n@@ -4210,11 +4213,11 @@ ada/sinput-l.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/style.ads ada/styleg.ads ada/styleg.adb ada/stylesw.ads \\\n    ada/system.ads ada/s-crc32.ads ada/s-crc32.adb ada/s-exctab.ads \\\n    ada/s-imenne.ads ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads \\\n-   ada/s-soflin.ads ada/s-stache.ads ada/s-stalib.ads ada/s-stoele.ads \\\n-   ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads \\\n-   ada/s-utf_32.ads ada/s-wchcon.ads ada/table.ads ada/table.adb \\\n-   ada/tree_io.ads ada/types.ads ada/uintp.ads ada/unchconv.ads \\\n-   ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n+   ada/s-secsta.ads ada/s-soflin.ads ada/s-stache.ads ada/s-stalib.ads \\\n+   ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads \\\n+   ada/s-unstyp.ads ada/s-utf_32.ads ada/s-wchcon.ads ada/table.ads \\\n+   ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads \\\n+   ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n \n ada/sinput.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/aspects.ads ada/atree.ads \\\n@@ -4422,12 +4425,12 @@ ada/treepr.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/sinput.ads ada/sinput.adb ada/snames.ads ada/stand.ads \\\n    ada/stringt.ads ada/system.ads ada/s-exctab.ads ada/s-htable.ads \\\n    ada/s-imenne.ads ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads \\\n-   ada/s-soflin.ads ada/s-stache.ads ada/s-stalib.ads ada/s-stoele.ads \\\n-   ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads \\\n-   ada/s-wchcon.ads ada/table.ads ada/table.adb ada/tree_io.ads \\\n-   ada/treepr.ads ada/treepr.adb ada/treeprs.ads ada/types.ads \\\n-   ada/uintp.ads ada/uintp.adb ada/uname.ads ada/unchconv.ads \\\n-   ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n+   ada/s-secsta.ads ada/s-soflin.ads ada/s-stache.ads ada/s-stalib.ads \\\n+   ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads ada/s-traent.ads \\\n+   ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads ada/table.adb \\\n+   ada/tree_io.ads ada/treepr.ads ada/treepr.adb ada/treeprs.ads \\\n+   ada/types.ads ada/uintp.ads ada/uintp.adb ada/uname.ads \\\n+   ada/unchconv.ads ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n \n ada/treeprs.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/debug.ads ada/hostparm.ads \\\n@@ -4469,11 +4472,12 @@ ada/uname.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/opt.ads ada/output.ads ada/sinfo.ads ada/sinfo.adb ada/sinput.ads \\\n    ada/sinput.adb ada/snames.ads ada/stand.ads ada/stringt.ads \\\n    ada/system.ads ada/s-exctab.ads ada/s-htable.ads ada/s-imenne.ads \\\n-   ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads ada/s-stalib.ads \\\n-   ada/s-string.ads ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads \\\n-   ada/table.ads ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads \\\n-   ada/uintp.adb ada/uname.ads ada/uname.adb ada/unchconv.ads \\\n-   ada/unchdeal.ads ada/urealp.ads ada/widechar.ads \n+   ada/s-memory.ads ada/s-os_lib.ads ada/s-parame.ads ada/s-secsta.ads \\\n+   ada/s-stalib.ads ada/s-stoele.ads ada/s-stoele.adb ada/s-string.ads \\\n+   ada/s-traent.ads ada/s-unstyp.ads ada/s-wchcon.ads ada/table.ads \\\n+   ada/table.adb ada/tree_io.ads ada/types.ads ada/uintp.ads ada/uintp.adb \\\n+   ada/uname.ads ada/uname.adb ada/unchconv.ads ada/unchdeal.ads \\\n+   ada/urealp.ads ada/widechar.ads \n \n ada/urealp.o : ada/ada.ads ada/a-except.ads ada/a-unccon.ads \\\n    ada/a-uncdea.ads ada/alloc.ads ada/debug.ads ada/gnat.ads \\"}, {"sha": "4b64766512b18c3805377f6ba1e7a6948790527f", "filename": "gcc/ada/gcc-interface/Makefile.in", "status": "modified", "additions": 1, "deletions": 7, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fgcc-interface%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2FMakefile.in?ref=f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "patch": "@@ -2724,15 +2724,9 @@ s-tasdeb.o  : s-tasdeb.adb s-tasdeb.ads\n \t      $< $(OUTPUT_OPTION)\n \n # force no function reordering on a-except.o because of the exclusion bounds\n-# mechanism (see the source file for more detailed information). However we\n-# can do that only when building the runtime (not the compiler) because the\n-# -fno-toplevel-reorder option exists only in GCC 4.2 and above.\n+# mechanism (see the source file for more detailed information).\n \n-ifneq (,$(findstring xgcc,$(CC)))\n NO_REORDER_ADAFLAGS=-fno-toplevel-reorder\n-else\n-NO_REORDER_ADAFLAGS=\n-endif\n \n # force debugging information on a-except.o so that it is always\n # possible to set conditional breakpoints on exceptions."}, {"sha": "c41b59de5b32dffa9a47f5e57bce852313f5bb7d", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "patch": "@@ -867,6 +867,10 @@ package body Prj.Nmsc is\n          Source_Paths_Htable.Set (Data.Tree.Source_Paths_HT, Path.Name, Id);\n       end if;\n \n+      Id.Next_With_File_Name :=\n+        Source_Files_Htable.Get (Data.Tree.Source_Files_HT, File_Name);\n+      Source_Files_Htable.Set (Data.Tree.Source_Files_HT, File_Name, Id);\n+\n       if Index /= 0 then\n          Project.Has_Multi_Unit_Sources := True;\n       end if;\n@@ -3016,7 +3020,6 @@ package body Prj.Nmsc is\n          Element        : String_Element;\n          File_Name      : File_Name_Type;\n          Source         : Source_Id;\n-         Iter           : Source_Iterator;\n \n       begin\n          case Kind is\n@@ -3046,11 +3049,13 @@ package body Prj.Nmsc is\n                Element   := Data.Tree.String_Elements.Table (Element_Id);\n                File_Name := Canonical_Case_File_Name (Element.Value);\n \n-               Iter := For_Each_Source (Data.Tree, Project);\n+               Source := Source_Files_Htable.Get\n+                 (Data.Tree.Source_Files_HT, File_Name);\n+\n+               while Source /= No_Source\n+                     and then Source.Project /= Project\n                loop\n-                  Source := Prj.Element (Iter);\n-                  exit when Source = No_Source or else Source.File = File_Name;\n-                  Next (Iter);\n+                  Source := Source.Next_With_File_Name;\n                end loop;\n \n                if Source = No_Source then"}, {"sha": "bd929cc5a87c1fc7637b6af70b7b829e6934c6fb", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "patch": "@@ -876,6 +876,7 @@ package body Prj is\n          Array_Table.Free (Tree.Arrays);\n          Package_Table.Free (Tree.Packages);\n          Source_Paths_Htable.Reset (Tree.Source_Paths_HT);\n+         Source_Files_Htable.Reset (Tree.Source_Files_HT);\n \n          Free_List (Tree.Projects, Free_Project => True);\n          Free_Units (Tree.Units_HT);\n@@ -904,6 +905,7 @@ package body Prj is\n       Array_Table.Init              (Tree.Arrays);\n       Package_Table.Init            (Tree.Packages);\n       Source_Paths_Htable.Reset     (Tree.Source_Paths_HT);\n+      Source_Files_Htable.Reset     (Tree.Source_Files_HT);\n       Replaced_Source_HTable.Reset  (Tree.Replaced_Sources);\n \n       Tree.Replaced_Source_Number := 0;"}, {"sha": "7039a81c3476f1c3a37cf08ac3764358401d2bfa", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 19, "deletions": 2, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f166413ae0e3dd76bc8c83d9865bcff20d5623aa/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=f166413ae0e3dd76bc8c83d9865bcff20d5623aa", "patch": "@@ -770,6 +770,10 @@ package Prj is\n \n       Next_In_Lang : Source_Id := No_Source;\n       --  Link to another source of the same language in the same project\n+\n+      Next_With_File_Name    : Source_Id := No_Source;\n+      --  Link to another source with the same base file name\n+\n    end record;\n \n    No_Source_Data : constant Source_Data :=\n@@ -803,7 +807,17 @@ package Prj is\n                        Switches_TS            => Empty_Time_Stamp,\n                        Naming_Exception       => False,\n                        Duplicate_Unit         => False,\n-                       Next_In_Lang           => No_Source);\n+                       Next_In_Lang           => No_Source,\n+                       Next_With_File_Name    => No_Source);\n+\n+   package Source_Files_Htable is new Simple_HTable\n+     (Header_Num => Header_Num,\n+      Element    => Source_Id,\n+      No_Element => No_Source,\n+      Key        => File_Name_Type,\n+      Hash       => Hash,\n+      Equal      => \"=\");\n+   --  Mapping of source file names to source ids\n \n    package Source_Paths_Htable is new Simple_HTable\n      (Header_Num => Header_Num,\n@@ -1367,7 +1381,10 @@ package Prj is\n          --  The number of entries in Replaced_Sources\n \n          Units_HT : Units_Htable.Instance;\n-         --  Unit name to Unit_Index (and from there so Source_Id)\n+         --  Unit name to Unit_Index (and from there to Source_Id)\n+\n+         Source_Files_HT        : Source_Files_Htable.Instance;\n+         --  Base source file names to Source_Id list.\n \n          Source_Paths_HT : Source_Paths_Htable.Instance;\n          --  Full path to Source_Id"}]}