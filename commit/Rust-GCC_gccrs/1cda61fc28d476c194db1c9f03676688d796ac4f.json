{"sha": "1cda61fc28d476c194db1c9f03676688d796ac4f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWNkYTYxZmMyOGQ0NzZjMTk0ZGIxYzlmMDM2NzY2ODhkNzk2YWM0Zg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-04-18T16:58:48Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-04-18T16:58:48Z"}, "message": "re PR debug/80263 (gcc's internal type \"sizetype\" leaks out as base type name in the DWARF info)\n\n\tPR debug/80263\n\t* dwarf2out.c (modified_type_die): Try harder not to emit internal\n\tsizetype type into debug info.\n\n\t* gcc.dg/debug/dwarf2/pr80263.c: New test.\n\nFrom-SVN: r246973", "tree": {"sha": "7d7c30c08618b11ab4c161ae199435cc50039333", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d7c30c08618b11ab4c161ae199435cc50039333"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1cda61fc28d476c194db1c9f03676688d796ac4f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cda61fc28d476c194db1c9f03676688d796ac4f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1cda61fc28d476c194db1c9f03676688d796ac4f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1cda61fc28d476c194db1c9f03676688d796ac4f/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "19970253373d37faecea458bd9f511c9cb3ed6e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19970253373d37faecea458bd9f511c9cb3ed6e7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19970253373d37faecea458bd9f511c9cb3ed6e7"}], "stats": {"total": 47, "additions": 37, "deletions": 10}, "files": [{"sha": "38c0d301765751ab6f0bee469e443f1442140788", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1cda61fc28d476c194db1c9f03676688d796ac4f", "patch": "@@ -1,3 +1,9 @@\n+2017-04-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/80263\n+\t* dwarf2out.c (modified_type_die): Try harder not to emit internal\n+\tsizetype type into debug info.\n+\n 2017-04-18  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/80099"}, {"sha": "27fb9f0519361a90fdf0a3ac763123d93063556f", "filename": "gcc/dwarf2out.c", "status": "modified", "additions": 19, "deletions": 10, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2Fdwarf2out.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2Fdwarf2out.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdwarf2out.c?ref=1cda61fc28d476c194db1c9f03676688d796ac4f", "patch": "@@ -12464,20 +12464,29 @@ modified_type_die (tree type, int cv_quals, bool reverse,\n      this type.  */\n   qualified_type = get_qualified_type (type, cv_quals);\n \n-  if (qualified_type == sizetype\n-      && TYPE_NAME (qualified_type)\n-      && TREE_CODE (TYPE_NAME (qualified_type)) == TYPE_DECL)\n+  if (qualified_type == sizetype)\n     {\n-      tree t = TREE_TYPE (TYPE_NAME (qualified_type));\n+      /* Try not to expose the internal sizetype type's name.  */\n+      if (TYPE_NAME (qualified_type)\n+\t  && TREE_CODE (TYPE_NAME (qualified_type)) == TYPE_DECL)\n+\t{\n+\t  tree t = TREE_TYPE (TYPE_NAME (qualified_type));\n \n-      gcc_checking_assert (TREE_CODE (t) == INTEGER_TYPE\n-\t\t\t   && TYPE_PRECISION (t)\n-\t\t\t   == TYPE_PRECISION (qualified_type)\n-\t\t\t   && TYPE_UNSIGNED (t)\n-\t\t\t   == TYPE_UNSIGNED (qualified_type));\n-      qualified_type = t;\n+\t  gcc_checking_assert (TREE_CODE (t) == INTEGER_TYPE\n+\t\t\t       && (TYPE_PRECISION (t)\n+\t\t\t\t   == TYPE_PRECISION (qualified_type))\n+\t\t\t       && (TYPE_UNSIGNED (t)\n+\t\t\t\t   == TYPE_UNSIGNED (qualified_type)));\n+\t  qualified_type = t;\n+\t}\n+      else if (qualified_type == sizetype\n+\t       && TREE_CODE (sizetype) == TREE_CODE (size_type_node)\n+\t       && TYPE_PRECISION (sizetype) == TYPE_PRECISION (size_type_node)\n+\t       && TYPE_UNSIGNED (sizetype) == TYPE_UNSIGNED (size_type_node))\n+\tqualified_type = size_type_node;\n     }\n \n+\n   /* If we do, then we can just use its DIE, if it exists.  */\n   if (qualified_type)\n     {"}, {"sha": "4157094c399095f32d58a0e12a5528970b7ff1cb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1cda61fc28d476c194db1c9f03676688d796ac4f", "patch": "@@ -1,3 +1,8 @@\n+2017-04-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/80263\n+\t* gcc.dg/debug/dwarf2/pr80263.c: New test.\n+\n 2017-04-18  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/80099"}, {"sha": "57633b4f0ebe4a4d1d11839f35127d2cd176d4d7", "filename": "gcc/testsuite/gcc.dg/debug/dwarf2/pr80263.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr80263.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1cda61fc28d476c194db1c9f03676688d796ac4f/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr80263.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdebug%2Fdwarf2%2Fpr80263.c?ref=1cda61fc28d476c194db1c9f03676688d796ac4f", "patch": "@@ -0,0 +1,7 @@\n+/* PR debug/80263 */\n+/* { dg-do compile } */\n+/* { dg-options \"-g -dA\" } */\n+\n+char array[1];\n+\n+/* { dg-final { scan-assembler-not {\\msizetype} } } */"}]}