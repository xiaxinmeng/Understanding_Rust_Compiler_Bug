{"sha": "35e530c58faddb546dcdcb83d626499c169b0320", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzVlNTMwYzU4ZmFkZGI1NDZkY2RjYjgzZDYyNjQ5OWMxNjliMDMyMA==", "commit": {"author": {"name": "Jason Merrill", "email": "merrill@gnu.org", "date": "1995-01-24T02:52:44Z"}, "committer": {"name": "Jason Merrill", "email": "merrill@gnu.org", "date": "1995-01-24T02:52:44Z"}, "message": "Improve PA shlib support\n\nFrom-SVN: r8792", "tree": {"sha": "ab10d48bf9d3e30c783cdeb6f692fef21e3005aa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ab10d48bf9d3e30c783cdeb6f692fef21e3005aa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/35e530c58faddb546dcdcb83d626499c169b0320", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35e530c58faddb546dcdcb83d626499c169b0320", "html_url": "https://github.com/Rust-GCC/gccrs/commit/35e530c58faddb546dcdcb83d626499c169b0320", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/35e530c58faddb546dcdcb83d626499c169b0320/comments", "author": null, "committer": null, "parents": [{"sha": "b744bb36629d62e8ddd36c6fbb00fb9ba7a59e88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b744bb36629d62e8ddd36c6fbb00fb9ba7a59e88", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b744bb36629d62e8ddd36c6fbb00fb9ba7a59e88"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "be28cc64529e3f71878ac220ff2c109194d56f1b", "filename": "gcc/collect2.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35e530c58faddb546dcdcb83d626499c169b0320/gcc%2Fcollect2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35e530c58faddb546dcdcb83d626499c169b0320/gcc%2Fcollect2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcollect2.c?ref=35e530c58faddb546dcdcb83d626499c169b0320", "patch": "@@ -1182,16 +1182,18 @@ main (argc, argv)\n \tp = q;\n       }\n \n-#ifdef LD_INIT_SWITCH\n   /* Tell the linker that we have initializer and finalizer functions.  */\n   if (shared_obj)\n     {\n+#ifdef LD_INIT_SWITCH\n       *ld2++ = LD_INIT_SWITCH;\n       *ld2++ = \"_GLOBAL__DI\";\n+#endif\n+#ifdef LD_FINI_SWITCH\n       *ld2++ = LD_FINI_SWITCH;\n       *ld2++ = \"_GLOBAL__DD\";\n-    }\n #endif\n+    }\n \n   *c_ptr++ = c_file;\n   *c_ptr = *ld1 = *ld2 = (char *)0;\n@@ -1777,13 +1779,17 @@ scan_prog_file (prog_name, which_pass)\n \tcase 3:\n \t  if (which_pass != PASS_LIB)\n \t    fatal (\"init function found in object %s\", prog_name);\n+#ifndef LD_INIT_SWITCH\n \t  add_to_list (&constructors, name);\n+#endif\n \t  break;\n \n \tcase 4:\n \t  if (which_pass != PASS_LIB)\n-\t    fatal (\"init function found in object %s\", prog_name);\n+\t    fatal (\"fini function found in object %s\", prog_name);\n+#ifndef LD_FINI_SWITCH\n \t  add_to_list (&destructors, name);\n+#endif\n \t  break;\n \n \tdefault:\t\t/* not a constructor or destructor */"}, {"sha": "5ac0477ad22dbd2de8e1bc7858015f4c0ec7ca18", "filename": "gcc/config/pa/pa.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/35e530c58faddb546dcdcb83d626499c169b0320/gcc%2Fconfig%2Fpa%2Fpa.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/35e530c58faddb546dcdcb83d626499c169b0320/gcc%2Fconfig%2Fpa%2Fpa.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fpa%2Fpa.h?ref=35e530c58faddb546dcdcb83d626499c169b0320", "patch": "@@ -252,6 +252,8 @@ do {\t\t\t\t\t\t\t\t\\\n   else\t\t\t\t\t\t\t\t\\\n     PTR = 0;\t\t\t\t\t\t\t\\\n } while (0)\n+\n+#define LD_INIT_SWITCH \"+I\"\n \f\n /* target machine storage layout */\n "}]}