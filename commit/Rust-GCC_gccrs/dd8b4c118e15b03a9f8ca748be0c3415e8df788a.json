{"sha": "dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQ4YjRjMTE4ZTE1YjAzYTlmOGNhNzQ4YmUwYzM0MTVlOGRmNzg4YQ==", "commit": {"author": {"name": "Hristian Kirtchev", "email": "kirtchev@adacore.com", "date": "2019-07-11T08:01:49Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2019-07-11T08:01:49Z"}, "message": "[Ada] Link error due to negated intrinsic comparison\n\nThis patch corrects the resolution of operator \"not\" when the expression\nbeing negated is an equality operator to prevent the transformation of\nan intrinsic equality operator into a function call.\n\n2019-07-11  Hristian Kirtchev  <kirtchev@adacore.com>\n\ngcc/ada/\n\n\t* sem_res.adb (Resolve_Op_Not): Do not rewrite an equality\n\toperator into a function call when the operator is intrinsic.\n\ngcc/testsuite/\n\n\t* gnat.dg/equal9.adb: New testcase.\n\nFrom-SVN: r273385", "tree": {"sha": "ad86ed3a16f65bf6b64c9bc8d0a23a629d89ab72", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ad86ed3a16f65bf6b64c9bc8d0a23a629d89ab72"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/comments", "author": {"login": "kirtchev-adacore", "id": 60669983, "node_id": "MDQ6VXNlcjYwNjY5OTgz", "avatar_url": "https://avatars.githubusercontent.com/u/60669983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kirtchev-adacore", "html_url": "https://github.com/kirtchev-adacore", "followers_url": "https://api.github.com/users/kirtchev-adacore/followers", "following_url": "https://api.github.com/users/kirtchev-adacore/following{/other_user}", "gists_url": "https://api.github.com/users/kirtchev-adacore/gists{/gist_id}", "starred_url": "https://api.github.com/users/kirtchev-adacore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kirtchev-adacore/subscriptions", "organizations_url": "https://api.github.com/users/kirtchev-adacore/orgs", "repos_url": "https://api.github.com/users/kirtchev-adacore/repos", "events_url": "https://api.github.com/users/kirtchev-adacore/events{/privacy}", "received_events_url": "https://api.github.com/users/kirtchev-adacore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e2a2d49440c8f8253d15054b6147810a88a10242", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2a2d49440c8f8253d15054b6147810a88a10242", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2a2d49440c8f8253d15054b6147810a88a10242"}], "stats": {"total": 44, "additions": 42, "deletions": 2}, "files": [{"sha": "9d5a50f163f66d2bae71d49376dc1ca40f28411b", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "patch": "@@ -1,3 +1,8 @@\n+2019-07-11  Hristian Kirtchev  <kirtchev@adacore.com>\n+\n+\t* sem_res.adb (Resolve_Op_Not): Do not rewrite an equality\n+\toperator into a function call when the operator is intrinsic.\n+\n 2019-07-11  Thomas Quinot  <quinot@adacore.com>\n \n \t* sem_prag.adb (Analyze_Pragma, case pragma Check): Do not call"}, {"sha": "c17b28d2a5e49fb9144beaa12dbe625abf229528", "filename": "gcc/ada/sem_res.adb", "status": "modified", "additions": 7, "deletions": 2, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Fada%2Fsem_res.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Fada%2Fsem_res.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_res.adb?ref=dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "patch": "@@ -10091,15 +10091,20 @@ package body Sem_Res is\n \n          declare\n             Opnd : constant Node_Id := Right_Opnd (N);\n+            Op_Id : Entity_Id;\n+\n          begin\n             if B_Typ = Standard_Boolean\n               and then Nkind_In (Opnd, N_Op_Eq, N_Op_Ne)\n               and then Is_Overloaded (Opnd)\n             then\n                Resolve_Equality_Op (Opnd, B_Typ);\n+               Op_Id := Entity (Opnd);\n \n-               if Ekind (Entity (Opnd)) = E_Function then\n-                  Rewrite_Operator_As_Call (Opnd, Entity (Opnd));\n+               if Ekind (Op_Id) = E_Function\n+                 and then not Is_Intrinsic_Subprogram (Op_Id)\n+               then\n+                  Rewrite_Operator_As_Call (Opnd, Op_Id);\n                end if;\n \n                if not Inside_A_Generic or else Is_Entity_Name (Opnd) then"}, {"sha": "a761f79f7a2fd4fdc2e8f2039c6e3d3050919891", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "patch": "@@ -1,3 +1,7 @@\n+2019-07-11  Hristian Kirtchev  <kirtchev@adacore.com>\n+\n+\t* gnat.dg/equal9.adb: New testcase.\n+\n 2019-07-11  Thomas Quinot  <quinot@adacore.com>\n \n \t* gnat.dg/scos1.adb: New testcase."}, {"sha": "aa60d5b389569bc5eefdd556066161b5b4370bb7", "filename": "gcc/testsuite/gnat.dg/equal9.adb", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Ftestsuite%2Fgnat.dg%2Fequal9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd8b4c118e15b03a9f8ca748be0c3415e8df788a/gcc%2Ftestsuite%2Fgnat.dg%2Fequal9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fequal9.adb?ref=dd8b4c118e15b03a9f8ca748be0c3415e8df788a", "patch": "@@ -0,0 +1,26 @@\n+--  { dg-do run }\n+\n+with Ada.Text_IO; use Ada.Text_IO;\n+with System;      use System;\n+\n+procedure Equal9 is\n+   Val : Address := Null_Address;\n+begin\n+   if Val = Null_Address then\n+      Put_Line (\"= OK\");\n+   else\n+      raise Program_Error;\n+   end if;\n+\n+   if Val /= Null_Address then\n+      raise Program_Error;\n+   else\n+      Put_Line (\"/= OK\");\n+   end if;\n+\n+   if not (Val = Null_Address) then\n+      raise Program_Error;\n+   else\n+      Put_Line (\"not = OK\");\n+   end if;\n+end Equal9;"}]}