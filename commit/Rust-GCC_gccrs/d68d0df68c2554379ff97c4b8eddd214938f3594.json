{"sha": "d68d0df68c2554379ff97c4b8eddd214938f3594", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDY4ZDBkZjY4YzI1NTQzNzlmZjk3YzRiOGVkZGQyMTQ5MzhmMzU5NA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2017-09-22T20:20:25Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2017-09-22T20:20:25Z"}, "message": "re PR bootstrap/81926 (go/parse.o differs between stage2 and stage3)\n\n\tPR bootstrap/81926\n\t* cp-objcp-common.c (cp_get_debug_type): Do only one lookup.\n\nFrom-SVN: r253109", "tree": {"sha": "64126ac13ada2e7fada1d568beda9eb54e09c681", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/64126ac13ada2e7fada1d568beda9eb54e09c681"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d68d0df68c2554379ff97c4b8eddd214938f3594", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d68d0df68c2554379ff97c4b8eddd214938f3594", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d68d0df68c2554379ff97c4b8eddd214938f3594", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d68d0df68c2554379ff97c4b8eddd214938f3594/comments", "author": null, "committer": null, "parents": [{"sha": "a93952d2bee108c94f802aa14be0348bcf4bcb29", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a93952d2bee108c94f802aa14be0348bcf4bcb29", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a93952d2bee108c94f802aa14be0348bcf4bcb29"}], "stats": {"total": 15, "additions": 10, "deletions": 5}, "files": [{"sha": "58e6f25ff204c499ccf18827fd113ca507ceee6a", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d68d0df68c2554379ff97c4b8eddd214938f3594/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d68d0df68c2554379ff97c4b8eddd214938f3594/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=d68d0df68c2554379ff97c4b8eddd214938f3594", "patch": "@@ -1,3 +1,8 @@\n+2017-09-22  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\tPR bootstrap/81926\n+\t* cp-objcp-common.c (cp_get_debug_type): Do only one lookup.\n+\n 2017-09-22  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR sanitizer/81929"}, {"sha": "267fcca7319e6c253574538552f21d203752eb53", "filename": "gcc/cp/cp-objcp-common.c", "status": "modified", "additions": 5, "deletions": 5, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d68d0df68c2554379ff97c4b8eddd214938f3594/gcc%2Fcp%2Fcp-objcp-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d68d0df68c2554379ff97c4b8eddd214938f3594/gcc%2Fcp%2Fcp-objcp-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcp-objcp-common.c?ref=d68d0df68c2554379ff97c4b8eddd214938f3594", "patch": "@@ -162,13 +162,13 @@ cp_get_debug_type (const_tree type)\n \t types on the fly for the debug info only, they would not be attached\n \t to any GC root and always be swept, so we would make the contents of\n \t the debug info depend on the collection points.  */\n-      struct tree_map in, *h;\n+      struct tree_map in, *h, **slot;\n \n       in.base.from = CONST_CAST_TREE (type);\n       in.hash = htab_hash_pointer (type);\n-      h = debug_type_hash->find_with_hash (&in, in.hash);\n-      if (h)\n-\treturn h->to;\n+      slot = debug_type_hash->find_slot_with_hash (&in, in.hash, INSERT);\n+      if (*slot)\n+\treturn (*slot)->to;\n \n       tree t = build_offset_type (TYPE_PTRMEMFUNC_OBJECT_TYPE (type),\n \t\t\t\t  TREE_TYPE (TYPE_PTRMEMFUNC_FN_TYPE (type)));\n@@ -177,7 +177,7 @@ cp_get_debug_type (const_tree type)\n       h->base.from = CONST_CAST_TREE (type);\n       h->hash = htab_hash_pointer (type);\n       h->to = t;\n-      *debug_type_hash->find_slot_with_hash (h, h->hash, INSERT) = h;\n+      *slot = h;\n \n       return t;\n     }"}]}