{"sha": "30a7199a198072cc5026ba878c2c9d15842e07dc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzBhNzE5OWExOTgwNzJjYzUwMjZiYTg3OGMyYzlkMTU4NDJlMDdkYw==", "commit": {"author": {"name": "Trevor Saunders", "email": "tbsaunde+gcc@tbsaunde.org", "date": "2016-07-28T11:01:39Z"}, "committer": {"name": "Trevor Saunders", "email": "tbsaunde@gcc.gnu.org", "date": "2016-07-28T11:01:39Z"}, "message": "haifa-sched.c: make twins a auto_vec<rtx_insn *>\n\ngcc/ChangeLog:\n\n2016-07-28  Trevor Saunders  <tbsaunde+gcc@tbsaunde.org>\n\n\t* haifa-sched.c (add_to_speculative_block): Make twins a vector.\n\nFrom-SVN: r238813", "tree": {"sha": "1e665b4611641a6136e583aae8aacf3b733af2da", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1e665b4611641a6136e583aae8aacf3b733af2da"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/30a7199a198072cc5026ba878c2c9d15842e07dc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30a7199a198072cc5026ba878c2c9d15842e07dc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30a7199a198072cc5026ba878c2c9d15842e07dc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30a7199a198072cc5026ba878c2c9d15842e07dc/comments", "author": null, "committer": null, "parents": [{"sha": "246af050e7d8a91b14dc00f277a8c549260e2168", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/246af050e7d8a91b14dc00f277a8c549260e2168", "html_url": "https://github.com/Rust-GCC/gccrs/commit/246af050e7d8a91b14dc00f277a8c549260e2168"}], "stats": {"total": 29, "additions": 12, "deletions": 17}, "files": [{"sha": "41549962c141ee70505ae46ed215fe95a8d9f051", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30a7199a198072cc5026ba878c2c9d15842e07dc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30a7199a198072cc5026ba878c2c9d15842e07dc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=30a7199a198072cc5026ba878c2c9d15842e07dc", "patch": "@@ -1,3 +1,7 @@\n+2016-07-28  Trevor Saunders  <tbsaunde+gcc@tbsaunde.org>\n+\n+\t* haifa-sched.c (add_to_speculative_block): Make twins a vector.\n+\n 2016-07-28  Trevor Saunders  <tbsaunde+gcc@tbsaunde.org>\n \n \t* store-motion.c (struct st_expr): Make pattern_regs a vector."}, {"sha": "93b7089f710e80dd45ebe04c8b45f5296ffba91c", "filename": "gcc/haifa-sched.c", "status": "modified", "additions": 8, "deletions": 17, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30a7199a198072cc5026ba878c2c9d15842e07dc/gcc%2Fhaifa-sched.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30a7199a198072cc5026ba878c2c9d15842e07dc/gcc%2Fhaifa-sched.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fhaifa-sched.c?ref=30a7199a198072cc5026ba878c2c9d15842e07dc", "patch": "@@ -7991,7 +7991,7 @@ add_to_speculative_block (rtx_insn *insn)\n   ds_t ts;\n   sd_iterator_def sd_it;\n   dep_t dep;\n-  rtx_insn_list *twins = NULL;\n+  auto_vec<rtx_insn *, 10> twins;\n \n   ts = TODO_SPEC (insn);\n   gcc_assert (!(ts & ~BE_IN_SPEC));\n@@ -8060,7 +8060,7 @@ add_to_speculative_block (rtx_insn *insn)\n         fprintf (spec_info->dump, \";;\\t\\tGenerated twin insn : %d/rec%d\\n\",\n                  INSN_UID (twin), rec->index);\n \n-      twins = alloc_INSN_LIST (twin, twins);\n+      twins.safe_push (twin);\n \n       /* Add dependences between TWIN and all appropriate\n \t instructions from REC.  */\n@@ -8099,23 +8099,14 @@ add_to_speculative_block (rtx_insn *insn)\n \n   /* We couldn't have added the dependencies between INSN and TWINS earlier\n      because that would make TWINS appear in the INSN_BACK_DEPS (INSN).  */\n-  while (twins)\n+  unsigned int i;\n+  rtx_insn *twin;\n+  FOR_EACH_VEC_ELT_REVERSE (twins, i, twin)\n     {\n-      rtx_insn *twin;\n-      rtx_insn_list *next_node;\n-\n-      twin = twins->insn ();\n-\n-      {\n-\tdep_def _new_dep, *new_dep = &_new_dep;\n+      dep_def _new_dep, *new_dep = &_new_dep;\n \n-\tinit_dep (new_dep, insn, twin, REG_DEP_OUTPUT);\n-\tsd_add_dep (new_dep, false);\n-      }\n-\n-      next_node = twins->next ();\n-      free_INSN_LIST_node (twins);\n-      twins = next_node;\n+      init_dep (new_dep, insn, twin, REG_DEP_OUTPUT);\n+      sd_add_dep (new_dep, false);\n     }\n \n   calc_priorities (priorities_roots);"}]}