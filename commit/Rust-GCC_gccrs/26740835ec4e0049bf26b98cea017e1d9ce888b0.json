{"sha": "26740835ec4e0049bf26b98cea017e1d9ce888b0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjY3NDA4MzVlYzRlMDA0OWJmMjZiOThjZWEwMTdlMWQ5Y2U4ODhiMA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2011-06-04T16:20:36Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2011-06-04T16:20:36Z"}, "message": "re PR lto/48954 (ICE: SIGSEGV in bitmap_count_bits (bitmap.c:719) with -O2 -flto -fno-early-inlining -fkeep-inline-functions)\n\n\n\tPR lto/48954\n\t* lto-cgraph.c (output_node_opt_summary): Handle NULL skip args bitmaps.\n\t* g++.dg/torture/pr48954.C: New testcase.\n\nFrom-SVN: r174644", "tree": {"sha": "08154b04ddcdd9c66f3ff68d546a4ce4f075c4d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/08154b04ddcdd9c66f3ff68d546a4ce4f075c4d5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/26740835ec4e0049bf26b98cea017e1d9ce888b0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26740835ec4e0049bf26b98cea017e1d9ce888b0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26740835ec4e0049bf26b98cea017e1d9ce888b0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26740835ec4e0049bf26b98cea017e1d9ce888b0/comments", "author": null, "committer": null, "parents": [{"sha": "014ab419efc12a59efebd2720d79e1c055675c85", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/014ab419efc12a59efebd2720d79e1c055675c85", "html_url": "https://github.com/Rust-GCC/gccrs/commit/014ab419efc12a59efebd2720d79e1c055675c85"}], "stats": {"total": 64, "additions": 56, "deletions": 8}, "files": [{"sha": "5fdd07ca2cfa636d8f557b48ea74372d5c166367", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=26740835ec4e0049bf26b98cea017e1d9ce888b0", "patch": "@@ -1,3 +1,8 @@\n+2011-06-04  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR lto/48954\n+\t* lto-cgraph.c (output_node_opt_summary): Handle NULL skip args bitmaps.\n+\n 2011-06-04  Jonathan Wakely  <jwakely.gcc@gmail.com>\n \n \t* doc/invoke.texi: Document -Wdelete-non-virtual-dtor."}, {"sha": "3b1115b53f63babf4ac8c89f954fd287bc99ef6e", "filename": "gcc/lto-cgraph.c", "status": "modified", "additions": 18, "deletions": 8, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2Flto-cgraph.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2Flto-cgraph.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-cgraph.c?ref=26740835ec4e0049bf26b98cea017e1d9ce888b0", "patch": "@@ -1598,14 +1598,24 @@ output_node_opt_summary (struct output_block *ob,\n   int i;\n   struct cgraph_edge *e;\n \n-  lto_output_uleb128_stream (ob->main_stream,\n-\t\t\t     bitmap_count_bits (node->clone.args_to_skip));\n-  EXECUTE_IF_SET_IN_BITMAP (node->clone.args_to_skip, 0, index, bi)\n-    lto_output_uleb128_stream (ob->main_stream, index);\n-  lto_output_uleb128_stream (ob->main_stream,\n-\t\t\t     bitmap_count_bits (node->clone.combined_args_to_skip));\n-  EXECUTE_IF_SET_IN_BITMAP (node->clone.combined_args_to_skip, 0, index, bi)\n-    lto_output_uleb128_stream (ob->main_stream, index);\n+  if (node->clone.args_to_skip)\n+    {\n+      lto_output_uleb128_stream (ob->main_stream,\n+\t\t\t\t bitmap_count_bits (node->clone.args_to_skip));\n+      EXECUTE_IF_SET_IN_BITMAP (node->clone.args_to_skip, 0, index, bi)\n+\tlto_output_uleb128_stream (ob->main_stream, index);\n+    }\n+  else\n+    lto_output_uleb128_stream (ob->main_stream, 0);\n+  if (node->clone.combined_args_to_skip)\n+    {\n+      lto_output_uleb128_stream (ob->main_stream,\n+\t\t\t\t bitmap_count_bits (node->clone.combined_args_to_skip));\n+      EXECUTE_IF_SET_IN_BITMAP (node->clone.combined_args_to_skip, 0, index, bi)\n+\tlto_output_uleb128_stream (ob->main_stream, index);\n+    }\n+  else\n+    lto_output_uleb128_stream (ob->main_stream, 0);\n   lto_output_uleb128_stream (ob->main_stream,\n \t\t             VEC_length (ipa_replace_map_p, node->clone.tree_map));\n   FOR_EACH_VEC_ELT (ipa_replace_map_p, node->clone.tree_map, i, map)"}, {"sha": "b88637cbddc6dc818326246c6baa91940258fc90", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=26740835ec4e0049bf26b98cea017e1d9ce888b0", "patch": "@@ -1,3 +1,8 @@\n+2011-06-04  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR lto/48954\n+\t* g++.dg/torture/pr48954.C: New testcase.\n+\n 2011-06-04  Jonathan Wakely  <jwakely.gcc@gmail.com>\n \n \t* testsuite/g++.dg/warn/delete-non-virtual-dtor.C: New."}, {"sha": "1af03289b24fe5f82fa93b8b90972bbe5667d9b0", "filename": "gcc/testsuite/g++.dg/torture/pr48954.C", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr48954.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/26740835ec4e0049bf26b98cea017e1d9ce888b0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr48954.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr48954.C?ref=26740835ec4e0049bf26b98cea017e1d9ce888b0", "patch": "@@ -0,0 +1,28 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -flto -fno-early-inlining -fkeep-inline-functions\" } */\n+struct A\n+{\n+  virtual void foo () = 0;\n+};\n+\n+struct B : A {};\n+struct C : A {};\n+\n+struct D: C, B\n+{\n+  void foo () {}\n+};\n+\n+static inline void\n+bar (B *b)\n+{\n+  b->foo ();\n+}\n+\n+int\n+main ()\n+{\n+  D d;\n+  for (;;)\n+    bar (&d);\n+}"}]}