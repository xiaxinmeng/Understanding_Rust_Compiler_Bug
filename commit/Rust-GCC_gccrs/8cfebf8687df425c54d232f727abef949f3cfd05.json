{"sha": "8cfebf8687df425c54d232f727abef949f3cfd05", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGNmZWJmODY4N2RmNDI1YzU0ZDIzMmY3MjdhYmVmOTQ5ZjNjZmQwNQ==", "commit": {"author": {"name": "Steve Ellcey", "email": "sellcey@imgtec.com", "date": "2014-11-06T22:29:39Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2014-11-06T22:29:39Z"}, "message": "config.gcc (mips*-mti-linux*): Remove gnu_ld and gas assignments.\n\n2014-11-06  Steve Ellcey  <sellcey@imgtec.com>\n\n\t* config.gcc (mips*-mti-linux*): Remove gnu_ld and gas assignments.\n\tSet default_mips_arch and default_mips_abi instead of tm_defines.\n\t(mips*-*-linux*): Set default_mips_arch and default_mips_abi instead\n\tof tm_defines.\n\t(mips*-*-*): Check with_arch and with_abi.  Set tm_defines.\n\t* config/mips/mips.h (STANDARD_STARTFILE_PREFIX_1): Set default\n\tbased on MIPS_ABI_DEFAULT.\n\t(STANDARD_STARTFILE_PREFIX_2): Ditto.\n\nFrom-SVN: r217203", "tree": {"sha": "13c38118d13df2f9865da3d3d011e7f3396b8294", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/13c38118d13df2f9865da3d3d011e7f3396b8294"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8cfebf8687df425c54d232f727abef949f3cfd05", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cfebf8687df425c54d232f727abef949f3cfd05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8cfebf8687df425c54d232f727abef949f3cfd05", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cfebf8687df425c54d232f727abef949f3cfd05/comments", "author": null, "committer": null, "parents": [{"sha": "be5ffc59ad88c5cd1cf6f568ec73001228cf28d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/be5ffc59ad88c5cd1cf6f568ec73001228cf28d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/be5ffc59ad88c5cd1cf6f568ec73001228cf28d5"}], "stats": {"total": 58, "additions": 51, "deletions": 7}, "files": [{"sha": "3ed47a8c6f8833c9d163fe5fc06b4f1e4002e54a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cfebf8687df425c54d232f727abef949f3cfd05/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cfebf8687df425c54d232f727abef949f3cfd05/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8cfebf8687df425c54d232f727abef949f3cfd05", "patch": "@@ -1,3 +1,14 @@\n+2014-11-06  Steve Ellcey  <sellcey@imgtec.com>\n+\n+\t* config.gcc (mips*-mti-linux*): Remove gnu_ld and gas assignments.\n+\tSet default_mips_arch and default_mips_abi instead of tm_defines.\n+\t(mips*-*-linux*): Set default_mips_arch and default_mips_abi instead\n+\tof tm_defines.\n+\t(mips*-*-*): Check with_arch and with_abi.  Set tm_defines.\n+\t* config/mips/mips.h (STANDARD_STARTFILE_PREFIX_1): Set default\n+\tbased on MIPS_ABI_DEFAULT.\n+\t(STANDARD_STARTFILE_PREFIX_2): Ditto.\n+\n 2014-11-06  Joseph Myers  <joseph@codesourcery.com>\n \n \t* doc/invoke.texi (-std=c99, -std=c11): Don't refer to corner"}, {"sha": "f1bfb6567467634917611a5b58c6490acc8bb052", "filename": "gcc/config.gcc", "status": "modified", "additions": 30, "deletions": 7, "changes": 37, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cfebf8687df425c54d232f727abef949f3cfd05/gcc%2Fconfig.gcc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cfebf8687df425c54d232f727abef949f3cfd05/gcc%2Fconfig.gcc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.gcc?ref=8cfebf8687df425c54d232f727abef949f3cfd05", "patch": "@@ -1952,30 +1952,30 @@ mips*-*-linux*)\t\t\t\t# Linux MIPS, either endian.\n \textra_options=\"${extra_options} linux-android.opt\"\n \tcase ${target} in\n \t\tmipsisa32r2*)\n-\t\t\ttm_defines=\"${tm_defines} MIPS_ISA_DEFAULT=33\"\n+\t\t\tdefault_mips_arch=mips32r2\n \t\t\t;;\n \t\tmipsisa32*)\n-\t\t\ttm_defines=\"${tm_defines} MIPS_ISA_DEFAULT=32\"\n+\t\t\tdefault_mips_arch=mips32\n \t\t\t;;\n \t\tmips64el-st-linux-gnu)\n-\t\t\ttm_defines=\"${tm_defines} MIPS_ABI_DEFAULT=ABI_N32\"\n+\t\t\tdefault_mips_abi=n32\n \t\t\ttm_file=\"${tm_file} mips/st.h\"\n \t\t\ttmake_file=\"${tmake_file} mips/t-st\"\n \t\t\tenable_mips_multilibs=\"yes\"\n \t\t\t;;\n \t\tmips64octeon*-*-linux*)\n-\t\t\ttm_defines=\"${tm_defines} MIPS_ABI_DEFAULT=ABI_N32\"\n+\t\t\tdefault_mips_abi=n32\n \t\t\ttm_defines=\"${tm_defines} MIPS_CPU_STRING_DEFAULT=\\\\\\\"octeon\\\\\\\"\"\n \t\t\ttarget_cpu_default=MASK_SOFT_FLOAT_ABI\n \t\t\tenable_mips_multilibs=\"yes\"\n \t\t\t;;\n \t\tmipsisa64r2*-*-linux*)\n-\t\t\ttm_defines=\"${tm_defines} MIPS_ABI_DEFAULT=ABI_N32\"\n-\t\t\ttm_defines=\"${tm_defines} MIPS_ISA_DEFAULT=65\"\n+\t\t\tdefault_mips_abi=n32\n+\t\t\tdefault_mips_arch=mips64r2\n \t\t\tenable_mips_multilibs=\"yes\"\n \t\t\t;;\n \t\tmips64*-*-linux* | mipsisa64*-*-linux*)\n-\t\t\ttm_defines=\"${tm_defines} MIPS_ABI_DEFAULT=ABI_N32\"\n+\t\t\tdefault_mips_abi=n32\n \t\t\tenable_mips_multilibs=\"yes\"\n \t\t\t;;\n \tesac\n@@ -4120,6 +4120,29 @@ case ${target} in\n \t\t\t\ttm_defines=\"TARGET_ENDIAN_DEFAULT=0 $tm_defines\"\n \t\t\t\t;;\n \t\tesac\n+\t\tif test x$with_arch != x; then\n+\t\t\tdefault_mips_arch=$with_arch\n+\t\tfi\n+\t\tif test x$with_abi != x; then\n+\t\t\tdefault_mips_abi=$with_abi\n+\t\tfi\n+\t\tcase ${default_mips_arch} in\n+\t\t    mips1)    tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=1\" ;;\n+\t\t    mips2)    tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=2\" ;;\n+\t\t    mips3)    tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=3\" ;;\n+\t\t    mips4)    tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=4\" ;;\n+\t\t    mips32)   tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=32\" ;;\n+\t\t    mips32r2) tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=33\" ;;\n+\t\t    mips64)   tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=64\" ;;\n+\t\t    mips64r2) tm_defines=\"$tm_defines MIPS_ISA_DEFAULT=65\" ;;\n+\t\tesac\n+\t\tcase ${default_mips_abi} in\n+\t\t    32)   tm_defines=\"$tm_defines MIPS_ABI_DEFAULT=ABI_32\" ;;\n+\t\t    o64)  tm_defines=\"$tm_defines MIPS_ABI_DEFAULT=ABI_O64\" ;;\n+\t\t    n32)  tm_defines=\"$tm_defines MIPS_ABI_DEFAULT=ABI_N32\" ;;\n+\t\t    64)   tm_defines=\"$tm_defines MIPS_ABI_DEFAULT=ABI_64\" ;;\n+\t\t    eabi) tm_defines=\"$tm_defines MIPS_ABI_DEFAULT=ABI_EABI\" ;;\n+\t\tesac\n \t\ttmake_file=\"mips/t-mips $tmake_file\"\n \t\t;;\n "}, {"sha": "dd67f11fe032e003c7d5feebb99018ca7aa100e1", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cfebf8687df425c54d232f727abef949f3cfd05/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cfebf8687df425c54d232f727abef949f3cfd05/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=8cfebf8687df425c54d232f727abef949f3cfd05", "patch": "@@ -3006,3 +3006,13 @@ extern GTY(()) struct target_globals *mips16_globals;\n    with arguments ARGS.  */\n #define PMODE_INSN(NAME, ARGS) \\\n   (Pmode == SImode ? NAME ## _si ARGS : NAME ## _di ARGS)\n+\n+/* If we are *not* using multilibs and the default ABI is not ABI_32 we\n+   need to change these from /lib and /usr/lib.  */\n+#if MIPS_ABI_DEFAULT == ABI_N32\n+#define STANDARD_STARTFILE_PREFIX_1 \"/lib32/\"\n+#define STANDARD_STARTFILE_PREFIX_2 \"/usr/lib32/\"\n+#elif MIPS_ABI_DEFAULT == ABI_64\n+#define STANDARD_STARTFILE_PREFIX_1 \"/lib64/\"\n+#define STANDARD_STARTFILE_PREFIX_2 \"/usr/lib64/\"\n+#endif"}]}