{"sha": "d1d46f9f70fff00e39f71183909f37605a113b3f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDFkNDZmOWY3MGZmZjAwZTM5ZjcxMTgzOTA5ZjM3NjA1YTExM2IzZg==", "commit": {"author": {"name": "Mike Stump", "email": "mikestump@comcast.net", "date": "2011-02-21T21:38:21Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2011-02-21T21:38:21Z"}, "message": "re PR target/47822 (Multiple test suite failures due to revision 170321)\n\n\tPR target/47822\n\t* config/darwin-protos.h (darwin_init_cfstring_builtins): Return a\n\ttree so we can get save the type.\n\t* config/i386/darwin.h (SUBTARGET_INIT_BUILTINS): Reserve builtin slot\n\tfor CFString instead of trying to use past the end of the builtins.\n\t* config/i386/i386.c (IX86_BUILTIN_CFSTRING): Likewise.\n\t* config/rs6000/rs6000-builtin.def (RS6000_BUILTIN_CFSTRING): Likewise.\n\t* config/rs6000/darwin.h (SUBTARGET_INIT_BUILTINS): Likewise.\n\t* config/darwin.c (DARWIN_BUILTIN_CFSTRINGMAKECONSTANTSTRING):\n\tRename to darwin_builtin_cfstring.\n\t(darwin_init_cfstring_builtins): Return the built type.\n\nFrom-SVN: r170376", "tree": {"sha": "3a09989bc2b7ebdaa2146f5f3b8aa2731fc84b6f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3a09989bc2b7ebdaa2146f5f3b8aa2731fc84b6f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d1d46f9f70fff00e39f71183909f37605a113b3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1d46f9f70fff00e39f71183909f37605a113b3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d1d46f9f70fff00e39f71183909f37605a113b3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d1d46f9f70fff00e39f71183909f37605a113b3f/comments", "author": null, "committer": null, "parents": [{"sha": "23e0d9301971df49e1b283e948a548faf0d3facd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e0d9301971df49e1b283e948a548faf0d3facd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23e0d9301971df49e1b283e948a548faf0d3facd"}], "stats": {"total": 44, "additions": 34, "deletions": 10}, "files": [{"sha": "1bb112ff701546a443e95a54be78a374291f86f5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d1d46f9f70fff00e39f71183909f37605a113b3f", "patch": "@@ -1,3 +1,17 @@\n+2011-02-21  Mike Stump  <mikestump@comcast.net>\n+\n+\tPR target/47822\n+\t* config/darwin-protos.h (darwin_init_cfstring_builtins): Return a\n+\ttree so we can get save the type.\n+\t* config/i386/darwin.h (SUBTARGET_INIT_BUILTINS): Reserve builtin slot\n+\tfor CFString instead of trying to use past the end of the builtins.\n+\t* config/i386/i386.c (IX86_BUILTIN_CFSTRING): Likewise.\n+\t* config/rs6000/rs6000-builtin.def (RS6000_BUILTIN_CFSTRING): Likewise.\n+\t* config/rs6000/darwin.h (SUBTARGET_INIT_BUILTINS): Likewise.\n+\t* config/darwin.c (DARWIN_BUILTIN_CFSTRINGMAKECONSTANTSTRING):\n+\tRename to darwin_builtin_cfstring.\n+\t(darwin_init_cfstring_builtins): Return the built type.\n+\n 2011-02-21  Uros Bizjak  <ubizjak@gmail.com>\n \n \tPR target/47840"}, {"sha": "4a9961119c58f82a5bf6672a8bfb7834178f1028", "filename": "gcc/config/darwin-protos.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fdarwin-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fdarwin-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin-protos.h?ref=d1d46f9f70fff00e39f71183909f37605a113b3f", "patch": "@@ -110,7 +110,7 @@ extern void darwin_asm_output_aligned_decl_common (FILE *, tree, const char *,\n extern bool darwin_binds_local_p (const_tree);\n extern void darwin_cpp_builtins (struct cpp_reader *);\n \n-extern void darwin_init_cfstring_builtins (unsigned);\n+extern tree darwin_init_cfstring_builtins (unsigned);\n extern tree darwin_fold_builtin (tree, int, tree *, bool);\n extern tree darwin_objc_construct_string (tree);\n extern bool darwin_cfstring_p (tree);"}, {"sha": "5e358b13f09de675bdc7ec62d013025e7c3a8453", "filename": "gcc/config/darwin.c", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fdarwin.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fdarwin.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.c?ref=d1d46f9f70fff00e39f71183909f37605a113b3f", "patch": "@@ -3001,7 +3001,7 @@ static GTY(()) tree pccfstring_type_node = NULL_TREE;\n static GTY(()) tree pcint_type_node = NULL_TREE;\n static GTY(()) tree pcchar_type_node = NULL_TREE;\n \n-static enum built_in_function DARWIN_BUILTIN_CFSTRINGMAKECONSTANTSTRING;\n+static enum built_in_function darwin_builtin_cfstring;\n \n /* Store all constructed constant CFStrings in a hash table so that\n    they get uniqued properly.  */\n@@ -3031,14 +3031,14 @@ add_builtin_field_decl (tree type, const char *name, tree **chain)\n   return field;\n }\n \n-void\n-darwin_init_cfstring_builtins (unsigned first_avail)\n+tree\n+darwin_init_cfstring_builtins (unsigned builtin_cfstring)\n {\n   tree cfsfun, fields, pccfstring_ftype_pcchar;\n   tree *chain = NULL;\n \n-  DARWIN_BUILTIN_CFSTRINGMAKECONSTANTSTRING = \n-\t\t\t(enum built_in_function) first_avail;\n+  darwin_builtin_cfstring = \n+    (enum built_in_function) builtin_cfstring;\n   \n   /* struct __builtin_CFString {\n        const int *isa;\t\t(will point at\n@@ -3084,7 +3084,7 @@ darwin_init_cfstring_builtins (unsigned first_avail)\n   DECL_LANG_SPECIFIC (cfsfun) = NULL;\n   (*lang_hooks.dup_lang_specific_decl) (cfsfun);\n   DECL_BUILT_IN_CLASS (cfsfun) = BUILT_IN_MD;\n-  DECL_FUNCTION_CODE (cfsfun) = DARWIN_BUILTIN_CFSTRINGMAKECONSTANTSTRING;\n+  DECL_FUNCTION_CODE (cfsfun) = darwin_builtin_cfstring;\n   lang_hooks.builtin_function (cfsfun);\n \n   /* extern int __CFConstantStringClassReference[];  */\n@@ -3100,6 +3100,8 @@ darwin_init_cfstring_builtins (unsigned first_avail)\n   \n   /* Initialize the hash table used to hold the constant CFString objects.  */\n   cfstring_htab = htab_create_ggc (31, cfstring_hash, cfstring_eq, NULL);\n+\n+  return cfstring_type_node;\n }\n \n tree\n@@ -3108,7 +3110,7 @@ darwin_fold_builtin (tree fndecl, int n_args, tree *argp,\n {\n   unsigned int fcode = DECL_FUNCTION_CODE (fndecl);\n   \n-  if (fcode == DARWIN_BUILTIN_CFSTRINGMAKECONSTANTSTRING)\n+  if (fcode == darwin_builtin_cfstring)\n     {\n       if (!darwin_constant_cfstrings)\n \t{"}, {"sha": "934ab4b823424d4f175742b7633b3492691d19a9", "filename": "gcc/config/i386/darwin.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fi386%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fi386%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fdarwin.h?ref=d1d46f9f70fff00e39f71183909f37605a113b3f", "patch": "@@ -308,7 +308,8 @@ do {\t\t\t\t\t\t\t\t\t\\\n #undef  SUBTARGET_INIT_BUILTINS\n #define SUBTARGET_INIT_BUILTINS\t\t\t\t\t\\\n do {\t\t\t\t\t\t\t\t\\\n-  darwin_init_cfstring_builtins ((unsigned) (IX86_BUILTIN_MAX));\\\n+  ix86_builtins[(int) IX86_BUILTIN_CFSTRING]\t\t\t\\\n+    = darwin_init_cfstring_builtins ((unsigned) (IX86_BUILTIN_CFSTRING));\t\\\n   darwin_rename_builtins ();\t\t\t\t\t\\\n } while(0)\n "}, {"sha": "aa59adacd5e7aba0a7662132f7aa0a4058662caa", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=d1d46f9f70fff00e39f71183909f37605a113b3f", "patch": "@@ -24337,6 +24337,9 @@ enum ix86_builtins\n   IX86_BUILTIN_CVTPS2PH,\n   IX86_BUILTIN_CVTPS2PH256,\n \n+  /* CFString built-in for darwin */\n+  IX86_BUILTIN_CFSTRING,\n+\n   IX86_BUILTIN_MAX\n };\n "}, {"sha": "244da0065dfc1a9f5da8a015d5d09acded6d9b11", "filename": "gcc/config/rs6000/darwin.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Frs6000%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fdarwin.h?ref=d1d46f9f70fff00e39f71183909f37605a113b3f", "patch": "@@ -433,5 +433,6 @@ extern int darwin_emit_branch_islands;\n #define SUBTARGET_INIT_BUILTINS\t\t\t\t\t\t\\\n do {\t\t\t\t\t\t\t\t\t\\\n   darwin_patch_builtins ();\t\t\t\t\t\t\\\n-  darwin_init_cfstring_builtins ((unsigned) (RS6000_BUILTIN_COUNT));\t\\\n+  rs6000_builtin_decls[(unsigned) (RS6000_BUILTIN_CFSTRING)]\t\t\\\n+    = darwin_init_cfstring_builtins ((unsigned) (RS6000_BUILTIN_CFSTRING)); \\\n } while(0)"}, {"sha": "7bd6b20fa0707d50aac2c432b601f67395b5f19a", "filename": "gcc/config/rs6000/rs6000-builtin.def", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Frs6000%2Frs6000-builtin.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d1d46f9f70fff00e39f71183909f37605a113b3f/gcc%2Fconfig%2Frs6000%2Frs6000-builtin.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000-builtin.def?ref=d1d46f9f70fff00e39f71183909f37605a113b3f", "patch": "@@ -1015,3 +1015,6 @@ RS6000_BUILTIN(RS6000_BUILTIN_RECIPF,\t\t\tRS6000_BTC_FP_PURE)\n RS6000_BUILTIN(RS6000_BUILTIN_RSQRTF,\t\t\tRS6000_BTC_FP_PURE)\n RS6000_BUILTIN(RS6000_BUILTIN_RSQRT,\t\t\tRS6000_BTC_FP_PURE)\n RS6000_BUILTIN(RS6000_BUILTIN_BSWAP_HI,\t\t\tRS6000_BTC_CONST)\n+\n+/* Darwin CfString builtin.  */\n+RS6000_BUILTIN(RS6000_BUILTIN_CFSTRING,\t\t\tRS6000_BTC_MISC)"}]}