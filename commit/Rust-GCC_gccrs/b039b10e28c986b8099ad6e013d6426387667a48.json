{"sha": "b039b10e28c986b8099ad6e013d6426387667a48", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjAzOWIxMGUyOGM5ODZiODA5OWFkNmUwMTNkNjQyNjM4NzY2N2E0OA==", "commit": {"author": {"name": "Samuel Tardieu", "email": "sam@rfc1149.net", "date": "2008-04-14T12:11:06Z"}, "committer": {"name": "Samuel Tardieu", "email": "sam@gcc.gnu.org", "date": "2008-04-14T12:11:06Z"}, "message": "re PR ada/16098 (Illegal program not detected, RM 13.1(6))\n\n    gcc/ada/\n\tPR ada/16098\n\t* sem_prag.adb (Error_Pragma_Ref): New.\n\t(Process_Convention): Specialized message for non-local\n\tsubprogram renaming. Detect the problem in homonyms as well.\n\n    gcc/testsuite/\n\tPR ada/16098\n\t* gnat.dg/specs/renamings.ads: New.\n\nFrom-SVN: r134262", "tree": {"sha": "3f275bf15cb26d5dd46bb90a5dd417c790a7ed3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3f275bf15cb26d5dd46bb90a5dd417c790a7ed3d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b039b10e28c986b8099ad6e013d6426387667a48", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b039b10e28c986b8099ad6e013d6426387667a48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b039b10e28c986b8099ad6e013d6426387667a48", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b039b10e28c986b8099ad6e013d6426387667a48/comments", "author": {"login": "samueltardieu", "id": 44656, "node_id": "MDQ6VXNlcjQ0NjU2", "avatar_url": "https://avatars.githubusercontent.com/u/44656?v=4", "gravatar_id": "", "url": "https://api.github.com/users/samueltardieu", "html_url": "https://github.com/samueltardieu", "followers_url": "https://api.github.com/users/samueltardieu/followers", "following_url": "https://api.github.com/users/samueltardieu/following{/other_user}", "gists_url": "https://api.github.com/users/samueltardieu/gists{/gist_id}", "starred_url": "https://api.github.com/users/samueltardieu/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/samueltardieu/subscriptions", "organizations_url": "https://api.github.com/users/samueltardieu/orgs", "repos_url": "https://api.github.com/users/samueltardieu/repos", "events_url": "https://api.github.com/users/samueltardieu/events{/privacy}", "received_events_url": "https://api.github.com/users/samueltardieu/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cb572b755dcc64f8e5581f8734e5b1034381d41b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cb572b755dcc64f8e5581f8734e5b1034381d41b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cb572b755dcc64f8e5581f8734e5b1034381d41b"}], "stats": {"total": 55, "additions": 55, "deletions": 0}, "files": [{"sha": "cdfcdfe4f9fdd8c1e4d2c974dfc58fcad4141216", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b039b10e28c986b8099ad6e013d6426387667a48", "patch": "@@ -1,3 +1,10 @@\n+2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n+\n+\tPR ada/16098\n+\t* sem_prag.adb (Error_Pragma_Ref): New.\n+\t(Process_Convention): Specialized message for non-local\n+\tsubprogram renaming. Detect the problem in homonyms as well.\n+\n 2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n \n \tPR ada/15915"}, {"sha": "8a9a2e91f1107116ff63dc62f5c42500c880293f", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=b039b10e28c986b8099ad6e013d6426387667a48", "patch": "@@ -521,6 +521,13 @@ package body Sem_Prag is\n       --  reference the identifier. After placing the message, Pragma_Exit\n       --  is raised.\n \n+      procedure Error_Pragma_Ref (Msg : String; Ref : Entity_Id);\n+      pragma No_Return (Error_Pragma_Ref);\n+      --  Outputs error message for current pragma. The message may contain\n+      --  a % that will be replaced with the pragma name. The parameter Ref\n+      --  must be an entity whose name can be referenced by & and sloc by #.\n+      --  After placing the message, Pragma_Exit is raised.\n+\n       function Find_Lib_Unit_Name return Entity_Id;\n       --  Used for a library unit pragma to find the entity to which the\n       --  library unit pragma applies, returns the entity found.\n@@ -1700,6 +1707,18 @@ package body Sem_Prag is\n          raise Pragma_Exit;\n       end Error_Pragma_Arg_Ident;\n \n+      ----------------------\n+      -- Error_Pragma_Ref --\n+      ----------------------\n+\n+      procedure Error_Pragma_Ref (Msg : String; Ref : Entity_Id) is\n+      begin\n+         Error_Msg_Name_1 := Pname;\n+         Error_Msg_Sloc   := Sloc (Ref);\n+         Error_Msg_NE (Msg, N, Ref);\n+         raise Pragma_Exit;\n+      end Error_Pragma_Ref;\n+\n       ------------------------\n       -- Find_Lib_Unit_Name --\n       ------------------------\n@@ -2414,6 +2433,10 @@ package body Sem_Prag is\n             if Nkind (Parent (Declaration_Node (E))) =\n                                        N_Subprogram_Renaming_Declaration\n             then\n+               if Scope (E) /= Scope (Alias (E)) then\n+                  Error_Pragma_Ref\n+                    (\"cannot apply pragma% to non-local renaming&#\", E);\n+               end if;\n                E := Alias (E);\n \n             elsif Nkind (Parent (E)) = N_Full_Type_Declaration\n@@ -2547,6 +2570,12 @@ package body Sem_Prag is\n                  and then Nkind (Original_Node (Parent (E1))) /=\n                    N_Full_Type_Declaration\n                then\n+                  if Present (Alias (E1))\n+                    and then Scope (E1) /= Scope (Alias (E1))\n+                  then\n+                     Error_Pragma_Ref\n+                       (\"cannot apply pragma% to non-local renaming&#\", E1);\n+                  end if;\n                   Set_Convention_From_Pragma (E1);\n \n                   if Prag_Id = Pragma_Import then"}, {"sha": "5bb51e82d8ce55f18fa77338759c9b6c6b66b887", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b039b10e28c986b8099ad6e013d6426387667a48", "patch": "@@ -1,3 +1,8 @@\n+2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n+\n+\tPR ada/16098\n+\t* gnat.dg/specs/renamings.ads: New.\n+\n 2008-04-14  Samuel Tardieu  <sam@rfc1149.net>\n \n \tPR ada/15915"}, {"sha": "3b90827e9fb5bd043f48bb0d3103124b8cf1d7e1", "filename": "gcc/testsuite/gnat.dg/specs/renamings.ads", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Frenamings.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b039b10e28c986b8099ad6e013d6426387667a48/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Frenamings.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Frenamings.ads?ref=b039b10e28c986b8099ad6e013d6426387667a48", "patch": "@@ -0,0 +1,14 @@\n+package Renamings is\n+\n+   package Inner is\n+      procedure PI (X : Integer);\n+   end Inner;\n+\n+   procedure P (X : Integer) renames Inner.PI;\n+   procedure P (X : Float);\n+   pragma Convention (C, P); -- { dg-error \"non-local renaming\" }\n+\n+   procedure Q (X : Float);\n+   procedure Q (X : Integer) renames Inner.PI;\n+   pragma Convention (C, Q); -- { dg-error \"non-local renaming\" }\n+end Renamings;"}]}