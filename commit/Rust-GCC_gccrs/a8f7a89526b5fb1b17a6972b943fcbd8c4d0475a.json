{"sha": "a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YThmN2E4OTUyNmI1ZmIxYjE3YTY5NzJiOTQzZmNiZDhjNGQwNDc1YQ==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@linux.vnet.ibm.com", "date": "2016-07-19T03:31:48Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "2016-07-19T03:31:48Z"}, "message": "re PR target/71493 (accidental ABI change for structure return on PowerPC)\n\n[gcc]\n2016-07-18  Michael Meissner  <meissner@linux.vnet.ibm.com>\n\n\tPR target/71493\n\t* config/rs6000/rs6000.c (rs6000_function_value): Fix\n\tunintentional System V.4 structure return breakage for structures\n\twith a single floating point element.\n\n[gcc/testsuite]\n2016-07-18  Michael Meissner  <meissner@linux.vnet.ibm.com>\n\n\tPR target/71493\n\t* gcc.target/powerpc/pr71493-1.c: New test.\n\t* gcc.target/powerpc/pr71493-2.c: Likewise.\n\nFrom-SVN: r238454", "tree": {"sha": "9345e6cb30397421d5a3ef7234f62044e1181b10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9345e6cb30397421d5a3ef7234f62044e1181b10"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/comments", "author": null, "committer": null, "parents": [{"sha": "40d9a67476003291aad8127a51aaece2b6862fac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40d9a67476003291aad8127a51aaece2b6862fac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40d9a67476003291aad8127a51aaece2b6862fac"}], "stats": {"total": 42, "additions": 41, "deletions": 1}, "files": [{"sha": "5d7c09912a4eacedbd54d86fb6c6db652ccfce76", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "patch": "@@ -1,3 +1,10 @@\n+2016-07-18  Michael Meissner  <meissner@linux.vnet.ibm.com>\n+\n+\tPR target/71493\n+\t* config/rs6000/rs6000.c (rs6000_function_value): Fix\n+\tunintentional System V.4 structure return breakage for structures\n+\twith a single floating point element.\n+\n 2016-07-18  Yuri Rumyantsev  <ysrumyan@gmail.com>\n \n \tPR tree-optimization/71734"}, {"sha": "6fe94d5084c07d79bbad1d2d6bf5b8ac1ed87d67", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "patch": "@@ -35467,7 +35467,8 @@ rs6000_function_value (const_tree valtype,\n   if (DECIMAL_FLOAT_MODE_P (mode) && TARGET_HARD_FLOAT && TARGET_FPRS)\n     /* _Decimal128 must use an even/odd register pair.  */\n     regno = (mode == TDmode) ? FP_ARG_RETURN + 1 : FP_ARG_RETURN;\n-  else if (SCALAR_FLOAT_MODE_NOT_VECTOR_P (mode) && TARGET_HARD_FLOAT && TARGET_FPRS\n+  else if (SCALAR_FLOAT_TYPE_P (valtype) && TARGET_HARD_FLOAT && TARGET_FPRS\n+\t   && !FLOAT128_VECTOR_P (mode)\n \t   && ((TARGET_SINGLE_FLOAT && (mode == SFmode)) || TARGET_DOUBLE_FLOAT))\n     regno = FP_ARG_RETURN;\n   else if (TREE_CODE (valtype) == COMPLEX_TYPE"}, {"sha": "2dd59609bdd8abea74a3c4181d67b49c5a91b948", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "patch": "@@ -1,3 +1,9 @@\n+2016-07-18  Michael Meissner  <meissner@linux.vnet.ibm.com>\n+\n+\tPR target/71493\n+\t* gcc.target/powerpc/pr71493-1.c: New test.\n+\t* gcc.target/powerpc/pr71493-2.c: Likewise.\n+\n 2016-07-18  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c++/71835"}, {"sha": "9ec9da0fbed4ea7c2edd0411414b52ab118d4512", "filename": "gcc/testsuite/gcc.target/powerpc/pr71493-1.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr71493-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr71493-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr71493-1.c?ref=a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile { target { powerpc*-*-linux* && ilp32 } } } */\n+/* { dg-options \"-O2 -msvr4-struct-return\" } */\n+\n+struct S1 { float f; };\n+\n+struct S1 foo1 (void)\n+{\n+  struct S1 s = { 1.0f };\n+  return s;\n+}\n+\n+/* { dg-final { scan-assembler     \"lwz\" } } */\n+/* { dg-final { scan-assembler-not \"lfs\" } } */"}, {"sha": "e9184a605bef4399f6e66dff619910812c873567", "filename": "gcc/testsuite/gcc.target/powerpc/pr71493-2.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr71493-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr71493-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr71493-2.c?ref=a8f7a89526b5fb1b17a6972b943fcbd8c4d0475a", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile { target { powerpc*-*-linux* && ilp32 } } } */\n+/* { dg-options \"-O2 -msvr4-struct-return\" } */\n+\n+struct S2 { double d; };\n+\n+struct S2 foo2 (void)\n+{\n+  struct S2 s = { 1.0 };\n+  return s;\n+}\n+\n+/* { dg-final { scan-assembler     \"lwz\" } } */\n+/* { dg-final { scan-assembler-not \"lfd\" } } */"}]}