{"sha": "201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjAxZmEwYjNhMGE0YWFmNTNlYzBiY2QxNTRmNDBlMmY2M2E4ZDk2MA==", "commit": {"author": {"name": "Jiong Wang", "email": "jiong.wang@arm.com", "date": "2015-08-06T16:02:16Z"}, "committer": {"name": "Jiong Wang", "email": "jiwang@gcc.gnu.org", "date": "2015-08-06T16:02:16Z"}, "message": "[AArch64] Tighten direct call pattern for sibcall to repair -fno-plt\n\n2015-08-06  Jiong Wang  <jiong.wang@arm.com>\n\ngcc/\n  * config/aarch64/constraints.md (Usf): Add the test of\n  aarch64_is_noplt_call_p.\n\ngcc/testsuite/\n  * gcc.target/aarch64/noplt_3.c: New testcase.\n\nFrom-SVN: r226682", "tree": {"sha": "ad6616b323a6c79aa67122fe5416dae671ebc3af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ad6616b323a6c79aa67122fe5416dae671ebc3af"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "html_url": "https://github.com/Rust-GCC/gccrs/commit/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/comments", "author": null, "committer": null, "parents": [{"sha": "b60d63cbaee16a95790c09dd6c23e346639ee180", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b60d63cbaee16a95790c09dd6c23e346639ee180", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b60d63cbaee16a95790c09dd6c23e346639ee180"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "795867a165640ee2e3aa4aa8e1ce3d3e15a8cccc", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "patch": "@@ -1,3 +1,8 @@\n+2015-08-06  Jiong Wang  <jiong.wang@arm.com>\n+\n+\t* config/aarch64/constraints.md (Usf): Add the test of\n+\taarch64_is_noplt_call_p.\n+\n 2015-08-06  Jiong Wang  <jiong.wang@arm.com>\n \n \t* config/aarch64/aarch64-protos.h (aarch64_is_noplt_call_p): New declaration."}, {"sha": "9dc21089154b1f44cbbd24681a710a3752b4ff2c", "filename": "gcc/config/aarch64/constraints.md", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2Fconfig%2Faarch64%2Fconstraints.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2Fconfig%2Faarch64%2Fconstraints.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Fconstraints.md?ref=201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "patch": "@@ -101,8 +101,9 @@\n        (match_test \"(unsigned HOST_WIDE_INT) ival < 64\")))\n \n (define_constraint \"Usf\"\n-  \"@internal Usf is a symbol reference.\"\n-  (match_code \"symbol_ref\"))\n+  \"@internal Usf is a symbol reference under the context where plt stub allowed.\"\n+  (and (match_code \"symbol_ref\")\n+       (match_test \"!aarch64_is_noplt_call_p (op)\")))\n \n (define_constraint \"UsM\"\n   \"@internal"}, {"sha": "0cd004b4c1d29ecc17aef3176eff5e55a13f7c10", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "patch": "@@ -1,3 +1,7 @@\n+2015-08-06  Jiong Wang  <jiong.wang@arm.com>\n+\n+\t* gcc.target/aarch64/noplt_3.c: New testcase.\n+\n 2015-08-06  Jiong Wang  <jiong.wang@arm.com>\n \n \t* gcc.target/aarch64/noplt_1.c: New testcase."}, {"sha": "c1993b670a6227eabd3175dc4de4dd01169c9c69", "filename": "gcc/testsuite/gcc.target/aarch64/noplt_3.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fnoplt_3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fnoplt_3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fnoplt_3.c?ref=201fa0b3a0a4aaf53ec0bcd154f40e2f63a8d960", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fpic -fno-plt\" } */\n+/* { dg-skip-if \"-mcmodel=large, no support for -fpic\" { aarch64-*-* }  { \"-mcmodel=large\" } { \"\" } } */\n+\n+int dec (int);\n+\n+int\n+cal (int a)\n+{\n+  return dec (a);\n+}\n+\n+void\n+cal_novalue (int a)\n+{\n+  dec (a);\n+}\n+\n+/* { dg-final { scan-assembler-times \"#:got:\" 2 { target { aarch64_tiny || aarch64_small } } } } */\n+/* { dg-final { scan-assembler-times \"#:got_lo12:\" 2 { target aarch64_small } } } */"}]}