{"sha": "95aeda79481084e8b7f3900958236e331c7e1903", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTVhZWRhNzk0ODEwODRlOGI3ZjM5MDA5NTgyMzZlMzMxYzdlMTkwMw==", "commit": {"author": {"name": "Gary Dismukes", "email": "dismukes@adacore.com", "date": "2011-10-13T10:39:15Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2011-10-13T10:39:15Z"}, "message": "exp_ch5.adb (Expand_N_Loop_Statement): For the transformation of a for loop for an enumeration type with an...\n\n2011-10-13  Gary Dismukes  <dismukes@adacore.com>\n\n\t* exp_ch5.adb (Expand_N_Loop_Statement): For the transformation\n\tof a for loop for an enumeration type with an enumeration rep\n\tclause, which involves moving the original loop parameter into\n\ta nested block, the loop parameter's entity must be removed from\n\tthe entity list of the loop scope.\n\nFrom-SVN: r179904", "tree": {"sha": "edfc743c58e19831d1b0256b949b3dcd247e3290", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/edfc743c58e19831d1b0256b949b3dcd247e3290"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/95aeda79481084e8b7f3900958236e331c7e1903", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95aeda79481084e8b7f3900958236e331c7e1903", "html_url": "https://github.com/Rust-GCC/gccrs/commit/95aeda79481084e8b7f3900958236e331c7e1903", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95aeda79481084e8b7f3900958236e331c7e1903/comments", "author": {"login": "dismukes", "id": 50880541, "node_id": "MDQ6VXNlcjUwODgwNTQx", "avatar_url": "https://avatars.githubusercontent.com/u/50880541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dismukes", "html_url": "https://github.com/dismukes", "followers_url": "https://api.github.com/users/dismukes/followers", "following_url": "https://api.github.com/users/dismukes/following{/other_user}", "gists_url": "https://api.github.com/users/dismukes/gists{/gist_id}", "starred_url": "https://api.github.com/users/dismukes/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dismukes/subscriptions", "organizations_url": "https://api.github.com/users/dismukes/orgs", "repos_url": "https://api.github.com/users/dismukes/repos", "events_url": "https://api.github.com/users/dismukes/events{/privacy}", "received_events_url": "https://api.github.com/users/dismukes/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "200b7162a55a430b8fefedd5a0f9770cfb02a2e1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/200b7162a55a430b8fefedd5a0f9770cfb02a2e1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/200b7162a55a430b8fefedd5a0f9770cfb02a2e1"}], "stats": {"total": 22, "additions": 22, "deletions": 0}, "files": [{"sha": "d6c30b39cfa7317972da115078dee19fce60c39e", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/95aeda79481084e8b7f3900958236e331c7e1903/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/95aeda79481084e8b7f3900958236e331c7e1903/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=95aeda79481084e8b7f3900958236e331c7e1903", "patch": "@@ -1,3 +1,11 @@\n+2011-10-13  Gary Dismukes  <dismukes@adacore.com>\n+\n+\t* exp_ch5.adb (Expand_N_Loop_Statement): For the transformation\n+\tof a for loop for an enumeration type with an enumeration rep\n+\tclause, which involves moving the original loop parameter into\n+\ta nested block, the loop parameter's entity must be removed from\n+\tthe entity list of the loop scope.\n+\n 2011-10-13  Bob Duff  <duff@adacore.com>\n \n \t* exp_ch6.ads (BIP_Storage_Pool): New \"extra implicit parameter\""}, {"sha": "75aa2a5ffa2fa34c72cbe230c674364a0aefa50b", "filename": "gcc/ada/exp_ch5.adb", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/95aeda79481084e8b7f3900958236e331c7e1903/gcc%2Fada%2Fexp_ch5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/95aeda79481084e8b7f3900958236e331c7e1903/gcc%2Fada%2Fexp_ch5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch5.adb?ref=95aeda79481084e8b7f3900958236e331c7e1903", "patch": "@@ -3458,6 +3458,20 @@ package body Exp_Ch5 is\n                            Statements => Statements (N)))),\n \n                    End_Label => End_Label (N)));\n+\n+               --  The loop parameter's entity must be removed from the loop\n+               --  scope's entity list, since itw will now be located in the\n+               --  new block scope. Any other entities already associated with\n+               --  the loop scope, such as the loop parameter's subtype, will\n+               --  remain there.\n+\n+               pragma Assert (First_Entity (Scope (Loop_Id)) = Loop_Id);\n+\n+               Set_First_Entity (Scope (Loop_Id), Next_Entity (Loop_Id));\n+               if Last_Entity (Scope (Loop_Id)) = Loop_Id then\n+                  Set_Last_Entity (Scope (Loop_Id), Empty);\n+               end if;\n+\n                Analyze (N);\n \n             --  Nothing to do with other cases of for loops"}]}