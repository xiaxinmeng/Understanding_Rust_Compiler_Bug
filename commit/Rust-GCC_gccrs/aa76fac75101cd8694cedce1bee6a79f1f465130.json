{"sha": "aa76fac75101cd8694cedce1bee6a79f1f465130", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWE3NmZhYzc1MTAxY2Q4Njk0Y2VkY2UxYmVlNmE3OWYxZjQ2NTEzMA==", "commit": {"author": {"name": "Justin Squirek", "email": "squirek@adacore.com", "date": "2018-05-28T08:53:00Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-05-28T08:53:00Z"}, "message": "[Ada] Misleading warning on unresolvable package name\n\nThis patch fixes an issue whereby the compiler misidentified a package name\ncontaining the name of a standard runtime package as said package - leading to\nand improper error message prompting the user to \"With\" a package already in\nscope.\n\n2018-05-28  Justin Squirek  <squirek@adacore.com>\n\ngcc/ada/\n\n\t* sem_ch8.adb (Find_Expanded_Name): Add extra guard to make sure the\n\tmisresolved package name is not a case of mistaken identity.\n\ngcc/testsuite/\n\n\t* gnat.dg/warn15-core-main.adb, gnat.dg/warn15-core.ads,\n\tgnat.dg/warn15-interfaces.ads, gnat.dg/warn15.ads: New testcase.\n\nFrom-SVN: r260817", "tree": {"sha": "0c3c851ed4519cebdb529dfb48467417b4fe6bb2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c3c851ed4519cebdb529dfb48467417b4fe6bb2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/aa76fac75101cd8694cedce1bee6a79f1f465130", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa76fac75101cd8694cedce1bee6a79f1f465130", "html_url": "https://github.com/Rust-GCC/gccrs/commit/aa76fac75101cd8694cedce1bee6a79f1f465130", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/aa76fac75101cd8694cedce1bee6a79f1f465130/comments", "author": {"login": "AdaDoom3", "id": 3445599, "node_id": "MDQ6VXNlcjM0NDU1OTk=", "avatar_url": "https://avatars.githubusercontent.com/u/3445599?v=4", "gravatar_id": "", "url": "https://api.github.com/users/AdaDoom3", "html_url": "https://github.com/AdaDoom3", "followers_url": "https://api.github.com/users/AdaDoom3/followers", "following_url": "https://api.github.com/users/AdaDoom3/following{/other_user}", "gists_url": "https://api.github.com/users/AdaDoom3/gists{/gist_id}", "starred_url": "https://api.github.com/users/AdaDoom3/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/AdaDoom3/subscriptions", "organizations_url": "https://api.github.com/users/AdaDoom3/orgs", "repos_url": "https://api.github.com/users/AdaDoom3/repos", "events_url": "https://api.github.com/users/AdaDoom3/events{/privacy}", "received_events_url": "https://api.github.com/users/AdaDoom3/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e740ff85bd5f9924128d67db1bb66b6a0ba23518", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e740ff85bd5f9924128d67db1bb66b6a0ba23518", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e740ff85bd5f9924128d67db1bb66b6a0ba23518"}], "stats": {"total": 34, "additions": 33, "deletions": 1}, "files": [{"sha": "10b2c21fa38541634f35a33bf711752b90ab40f1", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=aa76fac75101cd8694cedce1bee6a79f1f465130", "patch": "@@ -1,3 +1,8 @@\n+2018-05-28  Justin Squirek  <squirek@adacore.com>\n+\n+\t* sem_ch8.adb (Find_Expanded_Name): Add extra guard to make sure the\n+\tmisresolved package name is not a case of mistaken identity.\n+\n 2018-05-28  Yannick Moy  <moy@adacore.com>\n \n \t* sem_res.adb (Resolve_Range): Re-resolve the low bound of a range in"}, {"sha": "1716cc476669e9e23b1212bca703051f15074026", "filename": "gcc/ada/sem_ch8.adb", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Fada%2Fsem_ch8.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Fada%2Fsem_ch8.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch8.adb?ref=aa76fac75101cd8694cedce1bee6a79f1f465130", "patch": "@@ -6336,7 +6336,11 @@ package body Sem_Ch8 is\n                --  If this is a selection from Ada, System or Interfaces, then\n                --  we assume a missing with for the corresponding package.\n \n-               if Is_Known_Unit (N) then\n+               if Is_Known_Unit (N)\n+                 and then not (Present (Entity (Prefix (N)))\n+                                and then Scope (Entity (Prefix (N))) /=\n+                                           Standard_Standard)\n+               then\n                   if not Error_Posted (N) then\n                      Error_Msg_Node_2 := Selector;\n                      Error_Msg_N -- CODEFIX"}, {"sha": "8c3f007bc614ea6d4a88874e3ac8c4e83eac600c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=aa76fac75101cd8694cedce1bee6a79f1f465130", "patch": "@@ -1,3 +1,8 @@\n+2018-05-28  Justin Squirek  <squirek@adacore.com>\n+\n+\t* gnat.dg/warn15-core-main.adb, gnat.dg/warn15-core.ads,\n+\tgnat.dg/warn15-interfaces.ads, gnat.dg/warn15.ads: New testcase.\n+\n 2018-05-27  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \t* gfortran.dg/data_stmt_pointer.f90: new test."}, {"sha": "9caa1b9d36488b3ec761879a584a77384f2ceefb", "filename": "gcc/testsuite/gnat.dg/warn15-core-main.adb", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-core-main.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-core-main.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-core-main.adb?ref=aa76fac75101cd8694cedce1bee6a79f1f465130", "patch": "@@ -0,0 +1,9 @@\n+--  { dg-do compile }\n+\n+with Interfaces.C;\n+\n+procedure Warn15.Core.Main is\n+   use type Interfaces.C.unsigned;  --  { dg-error \"\\\"C\\\" not declared in \\\"Interfaces\\\"\" }\n+begin\n+   null;\n+end Warn15.Core.Main;"}, {"sha": "eadcc3835e24201cf10f72cf7caaaead7f77e3e3", "filename": "gcc/testsuite/gnat.dg/warn15-core.ads", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-core.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-core.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-core.ads?ref=aa76fac75101cd8694cedce1bee6a79f1f465130", "patch": "@@ -0,0 +1,4 @@\n+with Warn15.Interfaces;\n+\n+package Warn15.Core is\n+end Warn15.Core;"}, {"sha": "fa8f46a4256d277372bfc495eb8b901fc3658696", "filename": "gcc/testsuite/gnat.dg/warn15-interfaces.ads", "status": "added", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-interfaces.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-interfaces.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15-interfaces.ads?ref=aa76fac75101cd8694cedce1bee6a79f1f465130", "patch": "@@ -0,0 +1,3 @@\n+package Warn15.Interfaces is\n+end Warn15.Interfaces;\n+"}, {"sha": "4b011b4a758ff1910c5a86915c15c2d6e540a4ba", "filename": "gcc/testsuite/gnat.dg/warn15.ads", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/aa76fac75101cd8694cedce1bee6a79f1f465130/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fwarn15.ads?ref=aa76fac75101cd8694cedce1bee6a79f1f465130", "patch": "@@ -0,0 +1,2 @@\n+package Warn15 is\n+end Warn15;"}]}