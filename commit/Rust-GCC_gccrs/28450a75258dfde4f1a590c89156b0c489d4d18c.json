{"sha": "28450a75258dfde4f1a590c89156b0c489d4d18c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mjg0NTBhNzUyNThkZmRlNGYxYTU5MGM4OTE1NmIwYzQ4OWQ0ZDE4Yw==", "commit": {"author": {"name": "Ed Schonberg", "email": "schonberg@adacore.com", "date": "2009-04-15T08:37:21Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2009-04-15T08:37:21Z"}, "message": "sem_ch3.adb (Analyze_Type_Declaration): Create freeze node for access type even if...\n\n2009-04-15  Ed Schonberg  <schonberg@adacore.com>\n\n\t* sem_ch3.adb (Analyze_Type_Declaration): Create freeze node for access\n\ttype even if the designated type comes from a limited_with clause, to\n\tensure that the symbol for the finalization list of the access type is\n\tcreated.\n\nFrom-SVN: r146081", "tree": {"sha": "971ee2e5a6f70cb1ad95879ad77ee5c2f2c3b28a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/971ee2e5a6f70cb1ad95879ad77ee5c2f2c3b28a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/28450a75258dfde4f1a590c89156b0c489d4d18c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28450a75258dfde4f1a590c89156b0c489d4d18c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/28450a75258dfde4f1a590c89156b0c489d4d18c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/28450a75258dfde4f1a590c89156b0c489d4d18c/comments", "author": {"login": "Edschonberg", "id": 6352375, "node_id": "MDQ6VXNlcjYzNTIzNzU=", "avatar_url": "https://avatars.githubusercontent.com/u/6352375?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Edschonberg", "html_url": "https://github.com/Edschonberg", "followers_url": "https://api.github.com/users/Edschonberg/followers", "following_url": "https://api.github.com/users/Edschonberg/following{/other_user}", "gists_url": "https://api.github.com/users/Edschonberg/gists{/gist_id}", "starred_url": "https://api.github.com/users/Edschonberg/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Edschonberg/subscriptions", "organizations_url": "https://api.github.com/users/Edschonberg/orgs", "repos_url": "https://api.github.com/users/Edschonberg/repos", "events_url": "https://api.github.com/users/Edschonberg/events{/privacy}", "received_events_url": "https://api.github.com/users/Edschonberg/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4ff626092ebbea4bceccc9f9fba0bb35b9d22808", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4ff626092ebbea4bceccc9f9fba0bb35b9d22808", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4ff626092ebbea4bceccc9f9fba0bb35b9d22808"}], "stats": {"total": 19, "additions": 18, "deletions": 1}, "files": [{"sha": "d6b4fa813e5c0a11e16e2eb0e79920d57b87e209", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28450a75258dfde4f1a590c89156b0c489d4d18c/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28450a75258dfde4f1a590c89156b0c489d4d18c/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=28450a75258dfde4f1a590c89156b0c489d4d18c", "patch": "@@ -1,3 +1,10 @@\n+2009-04-15  Ed Schonberg  <schonberg@adacore.com>\n+\n+\t* sem_ch3.adb (Analyze_Type_Declaration): Create freeze node for access\n+\ttype even if the designated type comes from a limited_with clause, to\n+\tensure that the symbol for the finalization list of the access type is\n+\tcreated.\n+\n 2009-04-10  Robert Dewar  <dewar@adacore.com>\n \n \t* sem_warn.ads, sem_warn.adb (Check_Low_Bound_Tested): Catch more cases"}, {"sha": "620be02a3157153e5e9d82d17eb664bad74cd1c7", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 11, "deletions": 1, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/28450a75258dfde4f1a590c89156b0c489d4d18c/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/28450a75258dfde4f1a590c89156b0c489d4d18c/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=28450a75258dfde4f1a590c89156b0c489d4d18c", "patch": "@@ -4002,7 +4002,17 @@ package body Sem_Ch3 is\n             Set_First_Subtype_Link (Freeze_Node (B), T);\n          end if;\n \n-         if not From_With_Type (T) then\n+         --  A type that is imported through a limited_with clause cannot\n+         --  generate any code, and thus need not be frozen. However, an\n+         --  access type with an imported designated type needs a finalization\n+         --  list, which may be referenced in some other package that has\n+         --  non-limited visibility on the designated type. Thus we must\n+         --  create the finalization list at the point the access type is\n+         --  frozen, to prevent unsatisfied references at link time.\n+\n+         if not From_With_Type (T)\n+           or else Is_Access_Type (T)\n+         then\n             Set_Has_Delayed_Freeze (T);\n          end if;\n       end;"}]}