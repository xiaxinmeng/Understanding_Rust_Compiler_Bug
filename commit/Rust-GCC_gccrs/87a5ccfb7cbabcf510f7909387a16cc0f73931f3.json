{"sha": "87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODdhNWNjZmI3Y2JhYmNmNTEwZjc5MDkzODdhMTZjYzBmNzM5MzFmMw==", "commit": {"author": {"name": "Joseph Myers", "email": "joseph@codesourcery.com", "date": "2018-10-29T14:31:20Z"}, "committer": {"name": "Julian Brown", "email": "jules@gcc.gnu.org", "date": "2018-10-29T14:31:20Z"}, "message": "[OpenACC] Support C++ \"this\" in OpenACC directives\n\n2018-10-29  Joseph Myers  <joseph@codesourcery.com>\n\t    Julian Brown  <julian@codesourcery.com>\n\n\t* semantics.c (handle_omp_array_sections_1): Allow array sections with\n\t\"this\" pointer for OpenACC.\n\nCo-Authored-By: Julian Brown <julian@codesourcery.com>\n\nFrom-SVN: r265591", "tree": {"sha": "1427799828cfe5acd429f9f6512bd95c631c1afc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1427799828cfe5acd429f9f6512bd95c631c1afc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/comments", "author": {"login": "jsm28", "id": 10537793, "node_id": "MDQ6VXNlcjEwNTM3Nzkz", "avatar_url": "https://avatars.githubusercontent.com/u/10537793?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jsm28", "html_url": "https://github.com/jsm28", "followers_url": "https://api.github.com/users/jsm28/followers", "following_url": "https://api.github.com/users/jsm28/following{/other_user}", "gists_url": "https://api.github.com/users/jsm28/gists{/gist_id}", "starred_url": "https://api.github.com/users/jsm28/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jsm28/subscriptions", "organizations_url": "https://api.github.com/users/jsm28/orgs", "repos_url": "https://api.github.com/users/jsm28/repos", "events_url": "https://api.github.com/users/jsm28/events{/privacy}", "received_events_url": "https://api.github.com/users/jsm28/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5d8c32cb86043e388fddc9833d9c2cd90ed05284", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5d8c32cb86043e388fddc9833d9c2cd90ed05284", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5d8c32cb86043e388fddc9833d9c2cd90ed05284"}], "stats": {"total": 58, "additions": 57, "deletions": 1}, "files": [{"sha": "9130b8663d3fef771834110e0f35c87d36653216", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "patch": "@@ -1,3 +1,10 @@\n+2018-10-29  Joseph Myers  <joseph@codesourcery.com>\n+\t    Julian Brown  <julian@codesourcery.com>\n+\n+        PR c++/66053\n+        * semantics.c (handle_omp_array_sections_1): Allow array\n+        sections with \"this\" pointer for OpenACC.\n+\n 2018-10-25  Jason Merrill  <jason@redhat.com>\n \n \t* parser.c (cp_parser_sizeof_operand): Remove redundant use of"}, {"sha": "4c053655e00945e94e7d43462595e9cf7c86dec5", "filename": "gcc/cp/semantics.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/gcc%2Fcp%2Fsemantics.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/gcc%2Fcp%2Fsemantics.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fsemantics.c?ref=87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "patch": "@@ -4600,7 +4600,8 @@ handle_omp_array_sections_1 (tree c, tree t, vec<tree> &types,\n \t\t      omp_clause_code_name[OMP_CLAUSE_CODE (c)]);\n \t  return error_mark_node;\n \t}\n-      else if (TREE_CODE (t) == PARM_DECL\n+      else if (ort == C_ORT_OMP\n+\t       && TREE_CODE (t) == PARM_DECL\n \t       && DECL_ARTIFICIAL (t)\n \t       && DECL_NAME (t) == this_identifier)\n \t{"}, {"sha": "81fae2fb9802725d547e4c434e94e52f6b0c93d7", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "patch": "@@ -1,3 +1,8 @@\n+2018-10-29  Joseph Myers  <joseph@codesourcery.com>\n+\t    Julian Brown  <julian@codesourcery.com>\n+\n+\t* testsuite/libgomp.oacc-c++/this.C: New.\n+\n 2018-09-18  Cesar Philippidis  <cesar@codesourcery.com>\n \n \t* plugin/plugin-nvptx.c (struct cuda_map): New."}, {"sha": "510c690cf871baa5354aad7f7cd4e3ee452ba12b", "filename": "libgomp/testsuite/libgomp.oacc-c++/this.C", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/libgomp%2Ftestsuite%2Flibgomp.oacc-c%2B%2B%2Fthis.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/87a5ccfb7cbabcf510f7909387a16cc0f73931f3/libgomp%2Ftestsuite%2Flibgomp.oacc-c%2B%2B%2Fthis.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.oacc-c%2B%2B%2Fthis.C?ref=87a5ccfb7cbabcf510f7909387a16cc0f73931f3", "patch": "@@ -0,0 +1,43 @@\n+#include <cstdlib>\n+#include <iostream>\n+using namespace std;\n+\n+class test {\n+  public:\n+  int a;\n+\n+  test ()\n+  {\n+    a = -1;\n+#pragma acc enter data copyin (this[0:1])\n+  }\n+\n+  ~test ()\n+  {\n+#pragma acc exit data delete (this[0:1])\n+  }\n+\n+  void set (int i)\n+  {\n+    a = i;\n+#pragma acc update device (this[0:1])\n+  }\n+\n+  int get ()\n+  {\n+#pragma acc update host (this[0:1])\n+    return a;\n+  }\n+};\n+\n+int\n+main ()\n+{\n+  test t;\n+\n+  t.set (4);\n+  if (t.get () != 4)\n+    abort ();\n+\n+  return 0;\n+}"}]}