{"sha": "1408479363d5f34b306c75f60a6dfbdeb5be0544", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTQwODQ3OTM2M2Q1ZjM0YjMwNmM3NWY2MGE2ZGZiZGViNWJlMDU0NA==", "commit": {"author": {"name": "Kyrylo Tkachov", "email": "kyrylo.tkachov@arm.com", "date": "2015-12-16T10:01:48Z"}, "committer": {"name": "Kyrylo Tkachov", "email": "ktkachov@gcc.gnu.org", "date": "2015-12-16T10:01:48Z"}, "message": "[ARM] PR target/68648: Fold NOT of CONST_INT in andsi_iorsi3_notsi splitter\n\n\tPR target/68648\n\t* config/arm/arm.md (*andsi_iorsi3_notsi): Try to simplify\n\tthe complement of operands[3] during splitting.\n\n\t* gcc.c-torture/execute/pr68648.c: New test.\n\nFrom-SVN: r231675", "tree": {"sha": "dba267cf5d95099eab31b0951cf42f4c2cf58f14", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dba267cf5d95099eab31b0951cf42f4c2cf58f14"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1408479363d5f34b306c75f60a6dfbdeb5be0544", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1408479363d5f34b306c75f60a6dfbdeb5be0544", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1408479363d5f34b306c75f60a6dfbdeb5be0544", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1408479363d5f34b306c75f60a6dfbdeb5be0544/comments", "author": {"login": "ktkachov-arm", "id": 74917949, "node_id": "MDQ6VXNlcjc0OTE3OTQ5", "avatar_url": "https://avatars.githubusercontent.com/u/74917949?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ktkachov-arm", "html_url": "https://github.com/ktkachov-arm", "followers_url": "https://api.github.com/users/ktkachov-arm/followers", "following_url": "https://api.github.com/users/ktkachov-arm/following{/other_user}", "gists_url": "https://api.github.com/users/ktkachov-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/ktkachov-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ktkachov-arm/subscriptions", "organizations_url": "https://api.github.com/users/ktkachov-arm/orgs", "repos_url": "https://api.github.com/users/ktkachov-arm/repos", "events_url": "https://api.github.com/users/ktkachov-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/ktkachov-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8155f4d8cfd834e7cf1151a41fe0773477504f48", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8155f4d8cfd834e7cf1151a41fe0773477504f48", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8155f4d8cfd834e7cf1151a41fe0773477504f48"}], "stats": {"total": 49, "additions": 47, "deletions": 2}, "files": [{"sha": "464558f51e47b3897e33693c4ea7970c8b9a2a1a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=1408479363d5f34b306c75f60a6dfbdeb5be0544", "patch": "@@ -1,3 +1,9 @@\n+2015-12-16  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR target/68648\n+\t* config/arm/arm.md (*andsi_iorsi3_notsi): Try to simplify\n+\tthe complement of operands[3] during splitting.\n+\n 2015-12-16  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/68892"}, {"sha": "26833613edf4a8ceb86c211ae19731a543369bba", "filename": "gcc/config/arm/arm.md", "status": "modified", "additions": 16, "deletions": 2, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2Fconfig%2Farm%2Farm.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2Fconfig%2Farm%2Farm.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.md?ref=1408479363d5f34b306c75f60a6dfbdeb5be0544", "patch": "@@ -3228,8 +3228,22 @@\n   \"#\"   ; \"orr%?\\\\t%0, %1, %2\\;bic%?\\\\t%0, %0, %3\"\n   \"&& reload_completed\"\n   [(set (match_dup 0) (ior:SI (match_dup 1) (match_dup 2)))\n-   (set (match_dup 0) (and:SI (not:SI (match_dup 3)) (match_dup 0)))]\n-  \"\"\n+   (set (match_dup 0) (and:SI (match_dup 4) (match_dup 5)))]\n+  {\n+     /* If operands[3] is a constant make sure to fold the NOT into it\n+\tto avoid creating a NOT of a CONST_INT.  */\n+    rtx not_rtx = simplify_gen_unary (NOT, SImode, operands[3], SImode);\n+    if (CONST_INT_P (not_rtx))\n+      {\n+\toperands[4] = operands[0];\n+\toperands[5] = not_rtx;\n+      }\n+    else\n+      {\n+\toperands[5] = operands[0];\n+\toperands[4] = not_rtx;\n+      }\n+  }\n   [(set_attr \"length\" \"8\")\n    (set_attr \"ce_count\" \"2\")\n    (set_attr \"predicable\" \"yes\")"}, {"sha": "d90d43c920fd3403732c4375586a40729a2e3121", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1408479363d5f34b306c75f60a6dfbdeb5be0544", "patch": "@@ -1,3 +1,8 @@\n+2015-12-16  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n+\n+\tPR target/68648\n+\t* gcc.c-torture/execute/pr68648.c: New test.\n+\n 2015-12-16  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/68892"}, {"sha": "fc66806a99a0abef7bd517ae2f5200b387e69ce4", "filename": "gcc/testsuite/gcc.c-torture/execute/pr68648.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr68648.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1408479363d5f34b306c75f60a6dfbdeb5be0544/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr68648.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr68648.c?ref=1408479363d5f34b306c75f60a6dfbdeb5be0544", "patch": "@@ -0,0 +1,20 @@\n+int __attribute__ ((noinline))\n+foo (void)\n+{\n+  return 123;\n+}\n+\n+int __attribute__ ((noinline))\n+bar (void)\n+{\n+  int c = 1;\n+  c |= 4294967295 ^ (foo () | 4073709551608);\n+  return c;\n+}\n+\n+int\n+main ()\n+{\n+  if (bar () != 0x83fd4005)\n+    __builtin_abort ();\n+}"}]}