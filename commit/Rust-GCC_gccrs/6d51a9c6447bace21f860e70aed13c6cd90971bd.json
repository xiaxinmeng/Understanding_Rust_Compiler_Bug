{"sha": "6d51a9c6447bace21f860e70aed13c6cd90971bd", "node_id": "C_kwDOANBUbNoAKDZkNTFhOWM2NDQ3YmFjZTIxZjg2MGU3MGFlZDEzYzZjZDkwOTcxYmQ", "commit": {"author": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2022-01-14T13:02:10Z"}, "committer": {"name": "Kewen Lin", "email": "linkw@linux.ibm.com", "date": "2022-01-14T13:02:10Z"}, "message": "vect: Check partial vector param for supports_partial_vectors [PR104015]\n\nAs described in PR104015, the function partial_vectors_supported_p\nmainly checks optabs for partial vectors support query, but we\nstill have one parameter param_vect_partial_vector_usage to control\nthe capability.\n\nPower9 introduces vector with length instructions (for\nlen_load/len_store) but we don't enable partial vector on it by\ndefault. It should be considered as not supporting partial vector by\ndefault. This fix is to make the flag supports_partial_vectors check\nparam_vect_partial_vector_usage accordingly.\n\ngcc/ChangeLog:\n\n\tPR tree-optimization/104015\n\t* tree-vect-loop.c (vect_analyze_loop): Check\n\tparam_vect_partial_vector_usage for supports_partial_vectors.", "tree": {"sha": "252cc39da96aca2c6663a36e3e49977481118a5c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/252cc39da96aca2c6663a36e3e49977481118a5c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d51a9c6447bace21f860e70aed13c6cd90971bd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d51a9c6447bace21f860e70aed13c6cd90971bd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d51a9c6447bace21f860e70aed13c6cd90971bd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d51a9c6447bace21f860e70aed13c6cd90971bd/comments", "author": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jedilyn", "id": 38515402, "node_id": "MDQ6VXNlcjM4NTE1NDAy", "avatar_url": "https://avatars.githubusercontent.com/u/38515402?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jedilyn", "html_url": "https://github.com/jedilyn", "followers_url": "https://api.github.com/users/jedilyn/followers", "following_url": "https://api.github.com/users/jedilyn/following{/other_user}", "gists_url": "https://api.github.com/users/jedilyn/gists{/gist_id}", "starred_url": "https://api.github.com/users/jedilyn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jedilyn/subscriptions", "organizations_url": "https://api.github.com/users/jedilyn/orgs", "repos_url": "https://api.github.com/users/jedilyn/repos", "events_url": "https://api.github.com/users/jedilyn/events{/privacy}", "received_events_url": "https://api.github.com/users/jedilyn/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "de196e5dd8ea4d0ed01a8c265afdd3676e27545b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de196e5dd8ea4d0ed01a8c265afdd3676e27545b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de196e5dd8ea4d0ed01a8c265afdd3676e27545b"}], "stats": {"total": 3, "additions": 2, "deletions": 1}, "files": [{"sha": "1dbdb9e5fa0788d48dcb39c5b5f09b49cbc3e819", "filename": "gcc/tree-vect-loop.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d51a9c6447bace21f860e70aed13c6cd90971bd/gcc%2Ftree-vect-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d51a9c6447bace21f860e70aed13c6cd90971bd/gcc%2Ftree-vect-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-loop.c?ref=6d51a9c6447bace21f860e70aed13c6cd90971bd", "patch": "@@ -3051,7 +3051,8 @@ vect_analyze_loop (class loop *loop, vec_info_shared *shared)\n   vector_modes[0] = autodetected_vector_mode;\n   mode_i = 0;\n \n-  bool supports_partial_vectors = partial_vectors_supported_p ();\n+  bool supports_partial_vectors =\n+    partial_vectors_supported_p () && param_vect_partial_vector_usage != 0;\n   poly_uint64 first_vinfo_vf = LOOP_VINFO_VECT_FACTOR (first_loop_vinfo);\n \n   while (1)"}]}