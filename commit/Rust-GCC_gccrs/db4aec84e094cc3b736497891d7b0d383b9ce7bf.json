{"sha": "db4aec84e094cc3b736497891d7b0d383b9ce7bf", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGI0YWVjODRlMDk0Y2MzYjczNjQ5Nzg5MWQ3YjBkMzgzYjljZTdiZg==", "commit": {"author": {"name": "Steve Ellcey", "email": "sellcey@imgtec.com", "date": "2015-12-14T23:56:28Z"}, "committer": {"name": "Steve Ellcey", "email": "sje@gcc.gnu.org", "date": "2015-12-14T23:56:28Z"}, "message": "mips.c (mips_promote_function_mode): New function.\n\n2015-12-14  Steve Ellcey  <sellcey@imgtec.com>\n\n\t* config/mips/mips.c (mips_promote_function_mode): New function.\n\t(TARGET_PROMOTE_FUNCTION_MODE): Define as above function.\n\t(TARGET_PROMOTE_PROTOTYPES): Remove.\n\nFrom-SVN: r231634", "tree": {"sha": "c43bf905dfb5d30081601635a99a766a2d3d73b2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c43bf905dfb5d30081601635a99a766a2d3d73b2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/db4aec84e094cc3b736497891d7b0d383b9ce7bf", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db4aec84e094cc3b736497891d7b0d383b9ce7bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db4aec84e094cc3b736497891d7b0d383b9ce7bf", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db4aec84e094cc3b736497891d7b0d383b9ce7bf/comments", "author": null, "committer": null, "parents": [{"sha": "fa583f9e654fb4c7137a869d767858534f0bb535", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fa583f9e654fb4c7137a869d767858534f0bb535", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fa583f9e654fb4c7137a869d767858534f0bb535"}], "stats": {"total": 37, "additions": 33, "deletions": 4}, "files": [{"sha": "c90899e4c0d31fa4aee9e4f2314f1276978dac88", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db4aec84e094cc3b736497891d7b0d383b9ce7bf/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db4aec84e094cc3b736497891d7b0d383b9ce7bf/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=db4aec84e094cc3b736497891d7b0d383b9ce7bf", "patch": "@@ -1,3 +1,9 @@\n+2015-12-14  Steve Ellcey  <sellcey@imgtec.com>\n+\n+\t* config/mips/mips.c (mips_promote_function_mode): New function.\n+\t(TARGET_PROMOTE_FUNCTION_MODE): Define as above function.\n+\t(TARGET_PROMOTE_PROTOTYPES): Remove.\n+\n 2015-12-14  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/68309"}, {"sha": "7744d1933372956fc8206c2f2a4070a494a7a86f", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 27, "deletions": 4, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/db4aec84e094cc3b736497891d7b0d383b9ce7bf/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/db4aec84e094cc3b736497891d7b0d383b9ce7bf/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=db4aec84e094cc3b736497891d7b0d383b9ce7bf", "patch": "@@ -19906,6 +19906,32 @@ mips_ira_change_pseudo_allocno_class (int regno, reg_class_t allocno_class)\n     return GR_REGS;\n   return allocno_class;\n }\n+\n+/* Implement TARGET_PROMOTE_FUNCTION_MODE */\n+\n+/* This function is equivalent to default_promote_function_mode_always_promote\n+   except that it returns a promoted mode even if type is NULL_TREE.  This is\n+   needed by libcalls which have no type (only a mode) such as fixed conversion\n+   routines that take a signed or unsigned char/short argument and convert it\n+   to a fixed type.  */\n+\n+static machine_mode\n+mips_promote_function_mode (const_tree type ATTRIBUTE_UNUSED,\n+                            machine_mode mode,\n+                            int *punsignedp ATTRIBUTE_UNUSED,\n+                            const_tree fntype ATTRIBUTE_UNUSED,\n+                            int for_return ATTRIBUTE_UNUSED)\n+{\n+  int unsignedp;\n+\n+  if (type != NULL_TREE)\n+    return promote_mode (type, mode, punsignedp);\n+\n+  unsignedp = *punsignedp;\n+  PROMOTE_MODE (mode, unsignedp, type);\n+  *punsignedp = unsignedp;\n+  return mode;\n+}\n \f\n /* Initialize the GCC target structure.  */\n #undef TARGET_ASM_ALIGNED_HI_OP\n@@ -20010,10 +20036,7 @@ mips_ira_change_pseudo_allocno_class (int regno, reg_class_t allocno_class)\n #define TARGET_GIMPLIFY_VA_ARG_EXPR mips_gimplify_va_arg_expr\n \n #undef  TARGET_PROMOTE_FUNCTION_MODE\n-#define TARGET_PROMOTE_FUNCTION_MODE default_promote_function_mode_always_promote\n-#undef TARGET_PROMOTE_PROTOTYPES\n-#define TARGET_PROMOTE_PROTOTYPES hook_bool_const_tree_true\n-\n+#define TARGET_PROMOTE_FUNCTION_MODE mips_promote_function_mode\n #undef TARGET_FUNCTION_VALUE\n #define TARGET_FUNCTION_VALUE mips_function_value\n #undef TARGET_LIBCALL_VALUE"}]}