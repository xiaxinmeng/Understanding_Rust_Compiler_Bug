{"sha": "7fd82d528e715fabf3688346250d47c20f149665", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2ZkODJkNTI4ZTcxNWZhYmYzNjg4MzQ2MjUwZDQ3YzIwZjE0OTY2NQ==", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2016-08-12T16:07:40Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@gcc.gnu.org", "date": "2016-08-12T16:07:40Z"}, "message": "Fix PR middle-end/71654 (missed shortening of a compare)\n\ngcc/ChangeLog:\n\n\tPR middle-end/71654\n\t* match.pd ((T)A CMP (T)B -> A CMP B): Allow (T)A to be a\n\tsign-changing cast from a shorter unsigned type to a wider\n\tsigned type.\n\ngcc/testsuite/ChangeLog:\n\n\tPR middle-end/71654\n\t* gcc.dg/c-c++-common/pr71654.c: New test.\n\t* gcc.dg/tree-ssa/vrp23: Add -fno-tree-forwprop to\n\tdg-options.\n\t* gcc.dg/tree-ssa/vrp24: Likewise.\n\nFrom-SVN: r239421", "tree": {"sha": "c1db4a73282537a4a6550488a4eab0f1005536cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c1db4a73282537a4a6550488a4eab0f1005536cc"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7fd82d528e715fabf3688346250d47c20f149665", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fd82d528e715fabf3688346250d47c20f149665", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7fd82d528e715fabf3688346250d47c20f149665", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7fd82d528e715fabf3688346250d47c20f149665/comments", "author": null, "committer": null, "parents": [{"sha": "2f1364c2b325eec008bf461a0d77264618a9afe8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f1364c2b325eec008bf461a0d77264618a9afe8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f1364c2b325eec008bf461a0d77264618a9afe8"}], "stats": {"total": 51, "additions": 48, "deletions": 3}, "files": [{"sha": "7a1d691d9729bccfd739fc91947a817d064c46cd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fd82d528e715fabf3688346250d47c20f149665/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fd82d528e715fabf3688346250d47c20f149665/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7fd82d528e715fabf3688346250d47c20f149665", "patch": "@@ -1,3 +1,10 @@\n+2016-08-12  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\tPR middle-end/71654\n+\t* match.pd ((T)A CMP (T)B -> A CMP B): Allow (T)A to be a\n+\tsign-changing cast from a shorter unsigned type to a wider\n+\tsigned type.\n+\n 2016-08-12  Jakub Jelinek  <jakub@redhat.com>\n \n \t* config/i386/sse.md (avx512dq_vextract<shuffletype>64x2_1_maskm,"}, {"sha": "da87b027b626158dc2844ddb90a6b9e80f47610b", "filename": "gcc/match.pd", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=7fd82d528e715fabf3688346250d47c20f149665", "patch": "@@ -2350,7 +2350,9 @@ DEFINE_INT_AND_FLOAT_ROUND_FN (RINT)\n     (if (TYPE_PRECISION (TREE_TYPE (@0)) > TYPE_PRECISION (TREE_TYPE (@00)))\n      /* If possible, express the comparison in the shorter mode.  */\n      (if ((cmp == EQ_EXPR || cmp == NE_EXPR\n-\t   || TYPE_UNSIGNED (TREE_TYPE (@0)) == TYPE_UNSIGNED (TREE_TYPE (@00)))\n+\t   || TYPE_UNSIGNED (TREE_TYPE (@0)) == TYPE_UNSIGNED (TREE_TYPE (@00))\n+\t   || (!TYPE_UNSIGNED (TREE_TYPE (@0))\n+\t       && TYPE_UNSIGNED (TREE_TYPE (@00))))\n \t  && (types_match (TREE_TYPE (@10), TREE_TYPE (@00))\n \t      || ((TYPE_PRECISION (TREE_TYPE (@00))\n \t\t   >= TYPE_PRECISION (TREE_TYPE (@10)))"}, {"sha": "89071d2882f9503241ed75fe3222b323f0cdebe0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7fd82d528e715fabf3688346250d47c20f149665", "patch": "@@ -1,3 +1,11 @@\n+2016-08-12  Patrick Palka  <ppalka@gcc.gnu.org>\n+\n+\tPR middle-end/71654\n+\t* gcc.dg/c-c++-common/pr71654.c: New test.\n+\t* gcc.dg/tree-ssa/vrp23: Add -fno-tree-forwprop to\n+\tdg-options.\n+\t* gcc.dg/tree-ssa/vrp24: Likewise.\n+\n 2016-08-12  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/67410"}, {"sha": "2942493af67793ef513df5766b6f6494d6894b21", "filename": "gcc/testsuite/c-c++-common/pr71654.c", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr71654.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr71654.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr71654.c?ref=7fd82d528e715fabf3688346250d47c20f149665", "patch": "@@ -0,0 +1,28 @@\n+/* PR middle-end/71654  */\n+/* { dg-do link }  */\n+/* { dg-options \"-O2\" }  */\n+\n+unsigned char i0, i1;\n+\n+void foo (void);\n+\n+int\n+main (void)\n+{\n+  int j = i0;\n+  if (j < 4)\n+    {\n+      if (i0 & 4)\n+        foo ();\n+    }\n+\n+  unsigned int k = i1;\n+  if (k < 8)\n+    {\n+      if (i1 & 8)\n+        foo ();\n+    }\n+\n+  return 0;\n+}\n+"}, {"sha": "ae68c090f77b4b006a07e6408c068918a4223768", "filename": "gcc/testsuite/gcc.dg/tree-ssa/vrp23.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp23.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp23.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp23.c?ref=7fd82d528e715fabf3688346250d47c20f149665", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O2 -fdump-tree-vrp1-details\" } */\n+/* { dg-options \"-O2 -fno-tree-forwprop -fdump-tree-vrp1-details\" } */\n \n void aa (void);\n void aos (void);"}, {"sha": "853ee21bb8f515099c1205f1b21266129b250606", "filename": "gcc/testsuite/gcc.dg/tree-ssa/vrp24.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp24.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7fd82d528e715fabf3688346250d47c20f149665/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp24.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fvrp24.c?ref=7fd82d528e715fabf3688346250d47c20f149665", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O2 -fdump-tree-vrp1-details\" } */\n+/* { dg-options \"-O2 -fno-tree-forwprop -fdump-tree-vrp1-details\" } */\n \n \n struct rtx_def;"}]}