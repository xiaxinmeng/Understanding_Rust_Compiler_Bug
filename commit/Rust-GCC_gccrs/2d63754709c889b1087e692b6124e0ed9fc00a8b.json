{"sha": "2d63754709c889b1087e692b6124e0ed9fc00a8b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmQ2Mzc1NDcwOWM4ODliMTA4N2U2OTJiNjEyNGUwZWQ5ZmMwMGE4Yg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2005-05-27T14:23:47Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2005-05-27T14:23:47Z"}, "message": "re PR c++/21681 (ICE with nested types in template)\n\ncp:\n\tPR c++/21681\n\t* parser.c (cp_parser_late_parsing_for_member): Disable access\n\tchecking for template functions.\ntestsuite:\n\tPR c++/21681\n\t* g++.dg/parse/template16.C: New.\n\nFrom-SVN: r100252", "tree": {"sha": "4a34200c877704b6f8d086c4ee4600ed409e379b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4a34200c877704b6f8d086c4ee4600ed409e379b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2d63754709c889b1087e692b6124e0ed9fc00a8b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d63754709c889b1087e692b6124e0ed9fc00a8b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2d63754709c889b1087e692b6124e0ed9fc00a8b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2d63754709c889b1087e692b6124e0ed9fc00a8b/comments", "author": null, "committer": null, "parents": [{"sha": "a0ef884f73d791abd09ca3f5a9ccf725ead5fe39", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0ef884f73d791abd09ca3f5a9ccf725ead5fe39", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0ef884f73d791abd09ca3f5a9ccf725ead5fe39"}], "stats": {"total": 34, "additions": 34, "deletions": 0}, "files": [{"sha": "6f290053f2789f06de341dd9b491b3e9374e53c6", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=2d63754709c889b1087e692b6124e0ed9fc00a8b", "patch": "@@ -1,3 +1,9 @@\n+2005-05-27  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/21681\n+\t* parser.c (cp_parser_late_parsing_for_member): Disable access\n+\tchecking for template functions.\n+\n 2005-05-26  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \tPR c++/21768"}, {"sha": "7f39c91a95a1e7af4fd16b42d125107caaae78a5", "filename": "gcc/cp/parser.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Fcp%2Fparser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Fcp%2Fparser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fparser.c?ref=2d63754709c889b1087e692b6124e0ed9fc00a8b", "patch": "@@ -15486,6 +15486,7 @@ cp_parser_late_parsing_for_member (cp_parser* parser, tree member_function)\n       if (function_scope)\n \tpush_function_context_to (function_scope);\n \n+      \n       /* Push the body of the function onto the lexer stack.  */\n       cp_parser_push_lexer_for_tokens (parser, tokens);\n \n@@ -15494,10 +15495,17 @@ cp_parser_late_parsing_for_member (cp_parser* parser, tree member_function)\n       start_preparsed_function (member_function, NULL_TREE,\n \t\t\t\tSF_PRE_PARSED | SF_INCLASS_INLINE);\n \n+      /* Don't do access checking if it is a templated function.  */\n+      if (processing_template_decl)\n+\tpush_deferring_access_checks (dk_no_check);\n+      \n       /* Now, parse the body of the function.  */\n       cp_parser_function_definition_after_declarator (parser,\n \t\t\t\t\t\t      /*inline_p=*/true);\n \n+      if (processing_template_decl)\n+\tpop_deferring_access_checks ();\n+      \n       /* Leave the scope of the containing function.  */\n       if (function_scope)\n \tpop_function_context_from (function_scope);"}, {"sha": "c424bf5f0a1ceb7ea452ffc2c53f80d4aee38995", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2d63754709c889b1087e692b6124e0ed9fc00a8b", "patch": "@@ -1,3 +1,8 @@\n+2005-05-27  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\tPR c++/21681\n+\t* g++.dg/parse/template16.C: New.\n+\n 2005-05-27  Andreas Jaeger  <aj@suse.de>\n \n \t* gcc.dg/setjmp-2.c: Only run in 32-bit."}, {"sha": "bc41b0f45910ebb395222cb861776c2d3f2f900f", "filename": "gcc/testsuite/g++.dg/parse/template16.C", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate16.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2d63754709c889b1087e692b6124e0ed9fc00a8b/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate16.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fparse%2Ftemplate16.C?ref=2d63754709c889b1087e692b6124e0ed9fc00a8b", "patch": "@@ -0,0 +1,15 @@\n+// Copyright (C) 2005 Free Software Foundation, Inc.\n+// Contributed by Nathan Sidwell 26 May 2005 <nathan@codesourcery.com>\n+\n+// Origin:Volker Reichelt reichelt@gcc.gnu.org\n+// PR 21681. ICE with inappropriate access check.\n+\n+template<int X> struct A;\n+\n+struct B\n+{\n+    template<int N> void foo()\n+    {\n+        A<N>::X::Y;\n+    }\n+};"}]}