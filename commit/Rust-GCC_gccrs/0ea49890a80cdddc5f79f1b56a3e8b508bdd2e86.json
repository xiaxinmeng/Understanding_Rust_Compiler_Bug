{"sha": "0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGVhNDk4OTBhODBjZGRkYzVmNzlmMWI1NmEzZThiNTA4YmRkMmU4Ng==", "commit": {"author": {"name": "Frank Ch. Eigler", "email": "fche@redhat.com", "date": "2005-06-14T19:12:24Z"}, "committer": {"name": "Frank Ch. Eigler", "email": "fche@gcc.gnu.org", "date": "2005-06-14T19:12:24Z"}, "message": "re PR libmudflap/21023 (mudflap reports errors for external array variable with no size specified)\n\n2005-06-14  Frank Ch. Eigler  <fche@redhat.com>\n\n\tPR mudflap/21023\n\t* tree-mudflap.c (mudflap_finish_file): Exclude non-public\n\trather than static objects (!) from libmudflap registration.\n\n\t* testsuite/libmudflap.c/externs.exp, externs-{1,2}.c: New test files.\n\t* testsuite/libmudflap.c/cfrags.exp: Bypass new sources.\n\nFrom-SVN: r100950", "tree": {"sha": "f6e6325380fda0d3045ff8cc52f110a6f9949dee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f6e6325380fda0d3045ff8cc52f110a6f9949dee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/comments", "author": {"login": "fche", "id": 588885, "node_id": "MDQ6VXNlcjU4ODg4NQ==", "avatar_url": "https://avatars.githubusercontent.com/u/588885?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fche", "html_url": "https://github.com/fche", "followers_url": "https://api.github.com/users/fche/followers", "following_url": "https://api.github.com/users/fche/following{/other_user}", "gists_url": "https://api.github.com/users/fche/gists{/gist_id}", "starred_url": "https://api.github.com/users/fche/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fche/subscriptions", "organizations_url": "https://api.github.com/users/fche/orgs", "repos_url": "https://api.github.com/users/fche/repos", "events_url": "https://api.github.com/users/fche/events{/privacy}", "received_events_url": "https://api.github.com/users/fche/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7666af8941bb4826038df099f5eef0f2a23784bc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7666af8941bb4826038df099f5eef0f2a23784bc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7666af8941bb4826038df099f5eef0f2a23784bc"}], "stats": {"total": 76, "additions": 74, "deletions": 2}, "files": [{"sha": "023b85db8844eb5ef99a3d694ab1a594f5760b31", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "patch": "@@ -1,3 +1,9 @@\n+2005-06-14  Frank Ch. Eigler  <fche@redhat.com>\n+\n+\tPR mudflap/21023\n+\t* tree-mudflap.c (mudflap_finish_file): Exclude non-public\n+\trather than static objects (!) from libmudflap registration.\n+\n 2005-06-14  Richard Sandiford  <richard@codesourcery.com>\n \n \t* opt-functions.awk (global_state_p, needs_state_p, static_var): New."}, {"sha": "1ed0159fed5ea3d136bfac405ce6f7d9135e7c45", "filename": "gcc/tree-mudflap.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/gcc%2Ftree-mudflap.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/gcc%2Ftree-mudflap.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-mudflap.c?ref=0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "patch": "@@ -1257,7 +1257,7 @@ mudflap_finish_file (void)\n              Perform registration for non-static objects regardless of\n              TREE_USED or TREE_ADDRESSABLE, because they may be used\n              from other compilation units.  */\n-          if (TREE_STATIC (obj) && ! TREE_ADDRESSABLE (obj))\n+          if (! TREE_PUBLIC (obj) && ! TREE_ADDRESSABLE (obj))\n             continue;\n \n           if (! COMPLETE_TYPE_P (TREE_TYPE (obj)))"}, {"sha": "4e0525c2f11227a8f848dbfdd0fafa191070d6db", "filename": "libmudflap/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2FChangeLog?ref=0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "patch": "@@ -1,3 +1,9 @@\n+2005-06-14  Frank Ch. Eigler  <fche@redhat.com>\n+\n+\tPR mudflap/21023\n+\t* testsuite/libmudflap.c/externs.exp, externs-{1,2}.c: New test files.\n+\t* testsuite/libmudflap.c/cfrags.exp: Bypass new sources.\n+\n 2005-06-14  Frank Ch. Eigler  <fche@redhat.com>\n \n \tPR libmudflap/21094"}, {"sha": "577a4cc80c9c4012e3d5149e3486816c5ec4017d", "filename": "libmudflap/testsuite/libmudflap.c/cfrags.exp", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fcfrags.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fcfrags.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fcfrags.exp?ref=0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "patch": "@@ -5,7 +5,11 @@ dg-init\n \n global srcdir\n foreach flags [list {} {-static} {-O2} {-O3}] {\n-    foreach srcfile [lsort [glob -nocomplain ${srcdir}/libmudflap.c/*.c]] {\n+    foreach srcfile [lsort [glob -nocomplain \\\n+                            ${srcdir}/libmudflap.c/*frag.c \\\n+                            ${srcdir}/libmudflap.c/heap*.c \\\n+                            ${srcdir}/libmudflap.c/hook*.c \\\n+                            ${srcdir}/libmudflap.c/pass*.c]] {\n \tset bsrc [file tail $srcfile]\n \tsetenv MUDFLAP_OPTIONS \"-viol-segv\"\n \tdg-runtest $srcfile $flags \"-fmudflap -lmudflap\""}, {"sha": "552801d4b408b02c1bb2b64e5c0d63b377c51bd8", "filename": "libmudflap/testsuite/libmudflap.c/externs-1.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns-1.c?ref=0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "patch": "@@ -0,0 +1,14 @@\n+typedef struct { char *name; } dummy;\n+extern dummy d[];\n+\n+int\n+main (void)\n+{\n+  dummy *pd = d;\n+\n+  while (pd->name)\n+    {\n+      printf (\"%s\\n\", pd->name);\n+      pd++;\n+    }\n+}"}, {"sha": "cecf6253a6aa83b325806ab35eef1def0eb6e223", "filename": "libmudflap/testsuite/libmudflap.c/externs-2.c", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns-2.c?ref=0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "patch": "@@ -0,0 +1,2 @@\n+typedef struct { char *name; } dummy;\n+dummy d[] = { {\"a\"}, {0} };"}, {"sha": "e97e0b684e4acaf6f6439a5c092b6a20c9573117", "filename": "libmudflap/testsuite/libmudflap.c/externs.exp", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.c%2Fexterns.exp?ref=0ea49890a80cdddc5f79f1b56a3e8b508bdd2e86", "patch": "@@ -0,0 +1,40 @@\n+libmudflap-init c\n+dg-init\n+\n+global srcdir subdir\n+\n+foreach flags [list {} {-static} {-O2} {-O3}] {\n+    set l1 [libmudflap_target_compile \"$srcdir/$subdir/externs-1.c\" \"externs-1.o\" object {additional_flags=-fmudflap}]\n+    set test \"externs-1 compilation ${flags}\"\n+    if [string match \"*mudflap cannot track unknown size extern *d*\" $l1] { pass $test } { fail $test }\n+\n+    set l2 [libmudflap_target_compile \"$srcdir/$subdir/externs-2.c\" \"externs-2.o\" object {additional_flags=-fmudflap}]\n+    set test \"externs-2 compilation ${flags}\"\n+    if [string match \"\" $l2]  { pass $test } { fail $test }\n+\n+    set l3 [libmudflap_target_compile \"externs-1.o externs-2.o\" \"externs-12.exe\" executable {additional_flags=-fmudflap additional_flags=-lmudflap}]\n+    set test \"externs-12 linkage ${flags}\"\n+    if [string match \"\" $l3]  { pass $test } { fail $test }\n+\n+    set l4 [libmudflap_target_compile \"externs-2.o externs-1.o\" \"externs-21.exe\" executable {additional_flags=-fmudflap additional_flags=-lmudflap}]\n+    set test \"externs-21 linkage ${flags}\"\n+    if [string match \"\" $l3]  { pass $test } { fail $test }\n+\n+    setenv MUDFLAP_OPTIONS \"-viol-segv\"\n+\n+    remote_spawn host \"./externs-12.exe\"\n+    set l5 [remote_wait host 10]\n+    set test \"externs-12 execution ${flags}\"\n+    if {[lindex $l5 0] == 0}  { pass $test } { fail $test }\n+\n+    remote_spawn host \"./externs-21.exe\"\n+    set l6 [remote_wait host 10]\n+    set test \"externs-21 execution ${flags}\"\n+    if {[lindex $l6 0] == 0}  { pass $test } { fail $test }\n+\n+    foreach f [glob -nocomplain \"externs-*\"] {\n+       remote_file build delete $f\n+    }\n+}\n+\n+dg-finish"}]}