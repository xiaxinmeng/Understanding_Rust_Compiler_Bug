{"sha": "d157d9782201b9cd3b795add94e350506bc7d7e6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDE1N2Q5NzgyMjAxYjljZDNiNzk1YWRkOTRlMzUwNTA2YmM3ZDdlNg==", "commit": {"author": {"name": "Tobias Schl\u00fcter", "email": "tobias.schlueter@physik.uni-muenchen.de", "date": "2004-07-15T18:43:50Z"}, "committer": {"name": "Tobias Schl\u00fcter", "email": "tobi@gcc.gnu.org", "date": "2004-07-15T18:43:50Z"}, "message": "re PR fortran/15129 (assumed size characters passed to subroutines incorrect)\n\nfortran/\nPR fortran/15129\n* trans-decl.c (gfc_build_function_decl): Create a new chardecl\nfor every assumed length character dummy argument.\n\ntestsuite/\nPR fortran/15129\n* gfortran.dg/pr15129.f90: New test.\n\nFrom-SVN: r84769", "tree": {"sha": "c4e4a7d1156338b62ca24aa663b9a89e1ea4e68d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c4e4a7d1156338b62ca24aa663b9a89e1ea4e68d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d157d9782201b9cd3b795add94e350506bc7d7e6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d157d9782201b9cd3b795add94e350506bc7d7e6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d157d9782201b9cd3b795add94e350506bc7d7e6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d157d9782201b9cd3b795add94e350506bc7d7e6/comments", "author": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "committer": {"login": "TobiSchluter", "id": 11887541, "node_id": "MDQ6VXNlcjExODg3NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/11887541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TobiSchluter", "html_url": "https://github.com/TobiSchluter", "followers_url": "https://api.github.com/users/TobiSchluter/followers", "following_url": "https://api.github.com/users/TobiSchluter/following{/other_user}", "gists_url": "https://api.github.com/users/TobiSchluter/gists{/gist_id}", "starred_url": "https://api.github.com/users/TobiSchluter/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TobiSchluter/subscriptions", "organizations_url": "https://api.github.com/users/TobiSchluter/orgs", "repos_url": "https://api.github.com/users/TobiSchluter/repos", "events_url": "https://api.github.com/users/TobiSchluter/events{/privacy}", "received_events_url": "https://api.github.com/users/TobiSchluter/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "fdb510e7d6764f80d14dfd71dc56cce1b7c9b9f0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fdb510e7d6764f80d14dfd71dc56cce1b7c9b9f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fdb510e7d6764f80d14dfd71dc56cce1b7c9b9f0"}], "stats": {"total": 44, "additions": 43, "deletions": 1}, "files": [{"sha": "2667cb83160beb65f335e139fd97c8d331bb26c4", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=d157d9782201b9cd3b795add94e350506bc7d7e6", "patch": "@@ -1,3 +1,9 @@\n+2004-07-15  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n+\n+\tPR fortran/15129\n+\t* trans-decl.c (gfc_build_function_decl): Create a new chardecl\n+\tfor every assumed length character dummy argument.\n+\n 2004-07-15  Tobias Schlueter  <tobias.schlueter@physik.uni-muenchen.de>\n \n  \tPR fortran/15324"}, {"sha": "f7cfd9785ca703829544bb957891acb32b19aadc", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=d157d9782201b9cd3b795add94e350506bc7d7e6", "patch": "@@ -1180,7 +1180,25 @@ gfc_build_function_decl (gfc_symbol * sym)\n           if (!f->sym->ts.cl->length)\n \t    {\n \t      TREE_USED (length) = 1;\n-\t      f->sym->ts.cl->backend_decl = length;\n+\t      if (!f->sym->ts.cl->backend_decl)\n+\t\tf->sym->ts.cl->backend_decl = length;\n+\t      else\n+\t\t{\n+\t\t  /* there is already another variable using this\n+\t\t     gfc_charlen node, build a new one for this variable\n+\t\t     and chain it into the list of gfc_charlens.\n+\t\t     This happens for e.g. in the case\n+\t\t     CHARACTER(*)::c1,c2\n+\t\t     since CHARACTER declarations on the same line share\n+\t\t     the same gfc_charlen node.  */\n+\t\t  gfc_charlen *cl;\n+\t\t  \n+\t\t  cl = gfc_get_charlen ();\n+\t\t  cl->backend_decl = length;\n+\t\t  cl->next = f->sym->ts.cl->next;\n+\t\t  f->sym->ts.cl->next = cl;\n+\t\t  f->sym->ts.cl = cl;\n+\t\t}\n \t    }\n \n           parm = TREE_CHAIN (parm);"}, {"sha": "bab21110c6d0e7870e53140bc02b65c5581b7ebe", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d157d9782201b9cd3b795add94e350506bc7d7e6", "patch": "@@ -3,6 +3,9 @@\n \tPR fortran/15324\n \t* gfortran.dg/pr15324.f90: New test.\n \n+\tPR fortran/15129\n+\t* gfortran.dg/pr15129.f90: New test.\n+\n 2004-07-14  Mike Stump  <mrs@apple.com>\n \n \t* gcc.dg/20020426-2.c: Improve type safety wrt unsignedness."}, {"sha": "f9a277cb7e8cebf1d3f51d2441715649623975db", "filename": "gcc/testsuite/gfortran.dg/pr15129.f90", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr15129.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d157d9782201b9cd3b795add94e350506bc7d7e6/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr15129.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr15129.f90?ref=d157d9782201b9cd3b795add94e350506bc7d7e6", "patch": "@@ -0,0 +1,15 @@\n+! { dg-do run }\n+! PR 15129: we used to share the character length between A and B in the \n+! subroutine.\n+CHARACTER*10 A\n+CHARACTER*8 B\n+A = 'gfortran'\n+B = 'rocks!'\n+CALL T(A,B)\n+contains\n+SUBROUTINE T(A,B)\n+CHARACTER*(*) A,B\n+if(len(a)/=10) call abort()\n+if(len(b)/=8) call abort()\n+END SUBROUTINE\n+end"}]}