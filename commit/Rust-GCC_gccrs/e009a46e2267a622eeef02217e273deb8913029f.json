{"sha": "e009a46e2267a622eeef02217e273deb8913029f", "node_id": "C_kwDOANBUbNoAKGUwMDlhNDZlMjI2N2E2MjJlZWVmMDIyMTdlMjczZGViODkxMzAyOWY", "commit": {"author": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-05-30T14:01:42Z"}, "committer": {"name": "Arthur Cohen", "email": "arthur.cohen@embecosm.com", "date": "2022-05-30T14:38:31Z"}, "message": "docker: Add commit information to Docker image", "tree": {"sha": "c77499867a9bb208dfbcfd20170297c10b807628", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c77499867a9bb208dfbcfd20170297c10b807628"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e009a46e2267a622eeef02217e273deb8913029f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e009a46e2267a622eeef02217e273deb8913029f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e009a46e2267a622eeef02217e273deb8913029f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e009a46e2267a622eeef02217e273deb8913029f/comments", "author": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "committer": {"login": "CohenArthur", "id": 43524065, "node_id": "MDQ6VXNlcjQzNTI0MDY1", "avatar_url": "https://avatars.githubusercontent.com/u/43524065?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CohenArthur", "html_url": "https://github.com/CohenArthur", "followers_url": "https://api.github.com/users/CohenArthur/followers", "following_url": "https://api.github.com/users/CohenArthur/following{/other_user}", "gists_url": "https://api.github.com/users/CohenArthur/gists{/gist_id}", "starred_url": "https://api.github.com/users/CohenArthur/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CohenArthur/subscriptions", "organizations_url": "https://api.github.com/users/CohenArthur/orgs", "repos_url": "https://api.github.com/users/CohenArthur/repos", "events_url": "https://api.github.com/users/CohenArthur/events{/privacy}", "received_events_url": "https://api.github.com/users/CohenArthur/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "7a94948e65db2fef6fd93c94e70ead168b71513d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7a94948e65db2fef6fd93c94e70ead168b71513d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7a94948e65db2fef6fd93c94e70ead168b71513d"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "da97edacb9e802ea205f9d35409c24df05653d3c", "filename": "Dockerfile", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e009a46e2267a622eeef02217e273deb8913029f/Dockerfile", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e009a46e2267a622eeef02217e273deb8913029f/Dockerfile", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/Dockerfile?ref=e009a46e2267a622eeef02217e273deb8913029f", "patch": "@@ -44,7 +44,8 @@ RUN apt-get update; \\\n     xz-utils \\\n     zlib1g-dev \\\n     flex \\\n-    bison\n+    bison \\\n+    git\n \n ADD . /usr/src/gcc\n RUN /bin/sh -c set -ex; \\\n@@ -58,6 +59,9 @@ RUN /bin/sh -c set -ex; \\\n     cd /root; \\\n     rm -rf /usr/src/gcc\n \n+RUN cd /usr/src/gcc; \\\n+  git log -1 --format=\"%h\" > /GCCRS_BUILD; \\\n+\n RUN /bin/sh -c set -ex; \\\n     echo '/usr/local/lib64' > /etc/ld.so.conf.d/local-lib64.conf; \\\n     ldconfig -v\n@@ -69,6 +73,7 @@ RUN /bin/sh -c set -ex; \\\n \n FROM rust:latest\n COPY --from=gcc-builder /usr/ /usr/\n+COPY --from=gcc-builder /GCCRS_BUILD /GCCRS_BUILD\n RUN cargo install --git https://github.com/Rust-GCC/cargo-gccrs cargo-gccrs\n \n CMD [\"bash\"]"}]}