{"sha": "6d760a0197ece131619ac88f0fe34ce452fd774c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQ3NjBhMDE5N2VjZTEzMTYxOWFjODhmMGZlMzRjZTQ1MmZkNzc0Yw==", "commit": {"author": {"name": "Tom de Vries", "email": "tdevries@suse.de", "date": "2018-11-27T08:26:04Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2018-11-27T08:26:04Z"}, "message": "[libbacktrace] Don't point to released memory in backtrace_vector_release\n\nWhen backtrace_vector_release is called with vec.size == 0, it releases the\nmemory pointed at by vec.base.\n\nSet vec.base set to NULL if vec.size == 0 to ensure we don't point to released\nmemory.\n\nBootstrapped and reg-tested on x86_64.\n\n2018-11-27  Tom de Vries  <tdevries@suse.de>\n\n\t* mmap.c (backtrace_vector_release): Same.\n\t* unittest.c (test1): Add check.\n\nFrom-SVN: r266505", "tree": {"sha": "766ea0b74a27945cf9a88eabcf6775774905a7d5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/766ea0b74a27945cf9a88eabcf6775774905a7d5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d760a0197ece131619ac88f0fe34ce452fd774c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d760a0197ece131619ac88f0fe34ce452fd774c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d760a0197ece131619ac88f0fe34ce452fd774c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d760a0197ece131619ac88f0fe34ce452fd774c/comments", "author": {"login": "vries", "id": 4057235, "node_id": "MDQ6VXNlcjQwNTcyMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/4057235?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vries", "html_url": "https://github.com/vries", "followers_url": "https://api.github.com/users/vries/followers", "following_url": "https://api.github.com/users/vries/following{/other_user}", "gists_url": "https://api.github.com/users/vries/gists{/gist_id}", "starred_url": "https://api.github.com/users/vries/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vries/subscriptions", "organizations_url": "https://api.github.com/users/vries/orgs", "repos_url": "https://api.github.com/users/vries/repos", "events_url": "https://api.github.com/users/vries/events{/privacy}", "received_events_url": "https://api.github.com/users/vries/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0c155f24a945a55c37a963f64e89870f60543e64", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0c155f24a945a55c37a963f64e89870f60543e64", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0c155f24a945a55c37a963f64e89870f60543e64"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "e7fdfd8e9403a44a8eae79f25842577d6debbca8", "filename": "libbacktrace/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d760a0197ece131619ac88f0fe34ce452fd774c/libbacktrace%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d760a0197ece131619ac88f0fe34ce452fd774c/libbacktrace%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libbacktrace%2FChangeLog?ref=6d760a0197ece131619ac88f0fe34ce452fd774c", "patch": "@@ -1,3 +1,8 @@\n+2018-11-27  Tom de Vries  <tdevries@suse.de>\n+\n+\t* mmap.c (backtrace_vector_release): Same.\n+\t* unittest.c (test1): Add check.\n+\n 2018-11-27  Tom de Vries  <tdevries@suse.de>\n \n \t* alloc.c (backtrace_vector_release): Handle vec->size == 0 using free"}, {"sha": "9f896a1bb9986613a743750d5c7ab48674a1c296", "filename": "libbacktrace/mmap.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d760a0197ece131619ac88f0fe34ce452fd774c/libbacktrace%2Fmmap.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d760a0197ece131619ac88f0fe34ce452fd774c/libbacktrace%2Fmmap.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libbacktrace%2Fmmap.c?ref=6d760a0197ece131619ac88f0fe34ce452fd774c", "patch": "@@ -321,5 +321,7 @@ backtrace_vector_release (struct backtrace_state *state,\n   backtrace_free (state, (char *) vec->base + aligned, alc,\n \t\t  error_callback, data);\n   vec->alc = 0;\n+  if (vec->size == 0)\n+    vec->base = NULL;\n   return 1;\n }"}, {"sha": "3471d78488d16756cbdb876890fe01a6753f3cb0", "filename": "libbacktrace/unittest.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d760a0197ece131619ac88f0fe34ce452fd774c/libbacktrace%2Funittest.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d760a0197ece131619ac88f0fe34ce452fd774c/libbacktrace%2Funittest.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libbacktrace%2Funittest.c?ref=6d760a0197ece131619ac88f0fe34ce452fd774c", "patch": "@@ -69,7 +69,7 @@ test1 (void)\n \n   count = 0;\n   res = backtrace_vector_release (state, &vec, error_callback, NULL);\n-  failed = res != 1 || count != 0;\n+  failed = res != 1 || count != 0 || vec.base != NULL;\n \n   printf (\"%s: unittest backtrace_vector_release size == 0\\n\",\n \t  failed ? \"FAIL\": \"PASS\");"}]}