{"sha": "01d42eb543ba46aa8329ac3d5dee753a80472327", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDFkNDJlYjU0M2JhNDZhYTgzMjlhYzNkNWRlZTc1M2E4MDQ3MjMyNw==", "commit": {"author": {"name": "Kai Tietz", "email": "kai.tietz@onevision.com", "date": "2010-04-24T12:24:33Z"}, "committer": {"name": "Kai Tietz", "email": "ktietz@gcc.gnu.org", "date": "2010-04-24T12:24:33Z"}, "message": "unix.c (tempfile): Correct logic for mktemp case.\n\n2010-04-24  Kai Tietz  <kai.tietz@onevision.com>\n\n        PR/43844\n        * io/unix.c (tempfile): Correct logic for mktemp case.\n\nFrom-SVN: r158686", "tree": {"sha": "8c691a6017f485114b88368272910fc7ea89c6c0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8c691a6017f485114b88368272910fc7ea89c6c0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/01d42eb543ba46aa8329ac3d5dee753a80472327", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01d42eb543ba46aa8329ac3d5dee753a80472327", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01d42eb543ba46aa8329ac3d5dee753a80472327", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01d42eb543ba46aa8329ac3d5dee753a80472327/comments", "author": null, "committer": null, "parents": [{"sha": "a3ba29377f13a923aafa90c3df852a235986e58a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a3ba29377f13a923aafa90c3df852a235986e58a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a3ba29377f13a923aafa90c3df852a235986e58a"}], "stats": {"total": 22, "additions": 14, "deletions": 8}, "files": [{"sha": "2c38ba39af1a5c8846a417fddd59110e0dc4adec", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01d42eb543ba46aa8329ac3d5dee753a80472327/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01d42eb543ba46aa8329ac3d5dee753a80472327/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=01d42eb543ba46aa8329ac3d5dee753a80472327", "patch": "@@ -1,3 +1,8 @@\n+2010-04-24  Kai Tietz  <kai.tietz@onevision.com>\n+\n+\tPR/43844\n+\t* io/unix.c (tempfile): Correct logic for mktemp case.\n+\n 2010-04-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/39997"}, {"sha": "b3bd438c32dd6db7643dec2478d117cd730a4f2a", "filename": "libgfortran/io/unix.c", "status": "modified", "additions": 9, "deletions": 8, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/01d42eb543ba46aa8329ac3d5dee753a80472327/libgfortran%2Fio%2Funix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/01d42eb543ba46aa8329ac3d5dee753a80472327/libgfortran%2Fio%2Funix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Funix.c?ref=01d42eb543ba46aa8329ac3d5dee753a80472327", "patch": "@@ -889,25 +889,26 @@ tempfile (st_parameter_open *opp)\n \n   template = get_mem (strlen (tempdir) + 20);\n \n-  sprintf (template, \"%s/gfortrantmpXXXXXX\", tempdir);\n-\n #ifdef HAVE_MKSTEMP\n+  sprintf (template, \"%s/gfortrantmpXXXXXX\", tempdir);\n \n   fd = mkstemp (template);\n \n #else /* HAVE_MKSTEMP */\n-\n-  if (mktemp (template))\n-    do\n+  fd = -1;\n+  do\n+    {\n+      sprintf (template, \"%s/gfortrantmpXXXXXX\", tempdir);\n+      if (!mktemp (template))\n+\tbreak;\n #if defined(HAVE_CRLF) && defined(O_BINARY)\n       fd = open (template, O_RDWR | O_CREAT | O_EXCL | O_BINARY,\n \t\t S_IREAD | S_IWRITE);\n #else\n       fd = open (template, O_RDWR | O_CREAT | O_EXCL, S_IREAD | S_IWRITE);\n #endif\n-    while (!(fd == -1 && errno == EEXIST) && mktemp (template));\n-  else\n-    fd = -1;\n+    }\n+  while (fd == -1 && errno == EEXIST);\n \n #endif /* HAVE_MKSTEMP */\n "}]}