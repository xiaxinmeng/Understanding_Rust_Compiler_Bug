{"sha": "48f544ad5c98b668d8d345eaafcf09cc0bd44635", "node_id": "C_kwDOANBUbNoAKDQ4ZjU0NGFkNWM5OGI2NjhkOGQzNDVlYWFmY2YwOWNjMGJkNDQ2MzU", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2023-01-21T23:19:57Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2023-01-21T23:23:19Z"}, "message": "fortran: [PR102595]\n\n\tPR fortran/102595\n\ngcc/fortran/ChangeLog:\n\n\t* data.cc (gfc_assign_data_value): Remove check for PARAMETER in DATA.\n\t* primary.cc (match_variable): Add check for PARAMETER in DATA.\n\ngcc/testsuite/ChangeLog:\n\n\t* gfortran.dg/pr88048.f90: Adjust for changed error message.\n\t* gfortran.dg/parameter_data0.f90: New test.", "tree": {"sha": "49ad97c23b0cdbe5d5d3b5ac8945f48133a7eaf5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/49ad97c23b0cdbe5d5d3b5ac8945f48133a7eaf5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/48f544ad5c98b668d8d345eaafcf09cc0bd44635", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48f544ad5c98b668d8d345eaafcf09cc0bd44635", "html_url": "https://github.com/Rust-GCC/gccrs/commit/48f544ad5c98b668d8d345eaafcf09cc0bd44635", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/48f544ad5c98b668d8d345eaafcf09cc0bd44635/comments", "author": null, "committer": null, "parents": [{"sha": "046dc9d0d4683bab99d28983d8841ba3c56ef744", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/046dc9d0d4683bab99d28983d8841ba3c56ef744", "html_url": "https://github.com/Rust-GCC/gccrs/commit/046dc9d0d4683bab99d28983d8841ba3c56ef744"}], "stats": {"total": 25, "additions": 15, "deletions": 10}, "files": [{"sha": "d29eb12c1b16a7bc11d7b3ed54c372b4c8e16530", "filename": "gcc/fortran/data.cc", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ffortran%2Fdata.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ffortran%2Fdata.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdata.cc?ref=48f544ad5c98b668d8d345eaafcf09cc0bd44635", "patch": "@@ -244,13 +244,6 @@ gfc_assign_data_value (gfc_expr *lvalue, gfc_expr *rvalue, mpz_t index,\n \t\t    \"array-element nor a scalar-structure-component\";\n \n   symbol = lvalue->symtree->n.sym;\n-  if (symbol->attr.flavor == FL_PARAMETER)\n-    {\n-      gfc_error (\"PARAMETER %qs shall not appear in a DATA statement at %L\",\n-\t\t symbol->name, &lvalue->where);\n-      return false;\n-    }\n-\n   init = symbol->value;\n   last_ts = &symbol->ts;\n   last_con = NULL;"}, {"sha": "28ce5fea8656b8af4153381bb72e7abf29d5fc8e", "filename": "gcc/fortran/primary.cc", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ffortran%2Fprimary.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ffortran%2Fprimary.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fprimary.cc?ref=48f544ad5c98b668d8d345eaafcf09cc0bd44635", "patch": "@@ -4076,8 +4076,14 @@ match_variable (gfc_expr **result, int equiv_flag, int host_flag)\n \t  gfc_error (\"Named constant at %C in an EQUIVALENCE\");\n \t  return MATCH_ERROR;\n \t}\n-      /* Otherwise this is checked for and an error given in the\n-\t variable definition context checks.  */\n+      if (gfc_in_match_data())\n+\t{\n+\t  gfc_error (\"PARAMETER %qs shall not appear in a DATA statement at %C\",\n+\t\t      sym->name);\n+\t  return MATCH_ERROR;\n+\t}\n+\t/* Otherwise this is checked for an error given in the\n+\t   variable definition context checks.  */\n       break;\n \n     case FL_PROCEDURE:"}, {"sha": "4f1da9ea42e21c2e17e79721b60247c82e4610c6", "filename": "gcc/testsuite/gfortran.dg/parameter_data0.f90", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_data0.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_data0.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fparameter_data0.f90?ref=48f544ad5c98b668d8d345eaafcf09cc0bd44635", "patch": "@@ -0,0 +1,6 @@\n+! { dg-do compile }\n+! PR fortran/102595  Similar to 88048 with a zero sized array\n+program p\n+   complex, parameter:: x(0) = 2\n+   data x%im /3.0/ ! { dg-error \"shall not appear in a DATA statement\" }\n+end"}, {"sha": "ad82d45881c69f33aeac00f7bf59fb904f9d6721", "filename": "gcc/testsuite/gfortran.dg/pr88048.f90", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr88048.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/48f544ad5c98b668d8d345eaafcf09cc0bd44635/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr88048.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr88048.f90?ref=48f544ad5c98b668d8d345eaafcf09cc0bd44635", "patch": "@@ -2,6 +2,6 @@\n ! PR fortran/88048\n program p\n    integer, parameter :: a(2) = 1\n-   data a(2) /a(1)/                 ! { dg-error \"definable entity\" }\n+   data a(2) /a(1)/  ! { dg-error \"shall not appear in a DATA statement\" }\n    print *, a\n end"}]}