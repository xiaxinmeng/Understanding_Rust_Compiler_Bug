{"sha": "c76d9edb09d262a3badc87d5583abcfbc2e94854", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzc2ZDllZGIwOWQyNjJhM2JhZGM4N2Q1NTgzYWJjZmJjMmU5NDg1NA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2018-04-26T07:30:55Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2018-04-26T07:30:55Z"}, "message": "tree-vect-data-refs.c (vect_get_data_access_cost): Get prologue cost vector and pass it to vect_get_load_cost.\n\n2018-04-26  Richard Biener  <rguenther@suse.de>\n\n\t* tree-vect-data-refs.c (vect_get_data_access_cost): Get\n\tprologue cost vector and pass it to vect_get_load_cost.\n\t(vect_get_peeling_costs_all_drs): Likewise.\n\t(vect_peeling_hash_get_lowest_cost): Likewise.\n\t(vect_enhance_data_refs_alignment): Likewise.\n\nFrom-SVN: r259668", "tree": {"sha": "974303877994e8439797d9636221dc41b72164ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/974303877994e8439797d9636221dc41b72164ae"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c76d9edb09d262a3badc87d5583abcfbc2e94854", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c76d9edb09d262a3badc87d5583abcfbc2e94854", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c76d9edb09d262a3badc87d5583abcfbc2e94854", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c76d9edb09d262a3badc87d5583abcfbc2e94854/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bde84d51205c49afc0379757aa51bdb17a4eca10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bde84d51205c49afc0379757aa51bdb17a4eca10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bde84d51205c49afc0379757aa51bdb17a4eca10"}], "stats": {"total": 27, "additions": 20, "deletions": 7}, "files": [{"sha": "61324440b068e79b2acd84cb84654791cbeff91d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c76d9edb09d262a3badc87d5583abcfbc2e94854/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c76d9edb09d262a3badc87d5583abcfbc2e94854/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c76d9edb09d262a3badc87d5583abcfbc2e94854", "patch": "@@ -1,3 +1,11 @@\n+2018-04-26  Richard Biener  <rguenther@suse.de>\n+\n+\t* tree-vect-data-refs.c (vect_get_data_access_cost): Get\n+\tprologue cost vector and pass it to vect_get_load_cost.\n+\t(vect_get_peeling_costs_all_drs): Likewise.\n+\t(vect_peeling_hash_get_lowest_cost): Likewise.\n+\t(vect_enhance_data_refs_alignment): Likewise.\n+\n 2018-04-26  Richard Biener  <rguenther@suse.de>\n \n \tPR middle-end/85450"}, {"sha": "df362b0e1c5cd9ec4709c93ce9848101c0ee07f1", "filename": "gcc/tree-vect-data-refs.c", "status": "modified", "additions": 12, "deletions": 7, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c76d9edb09d262a3badc87d5583abcfbc2e94854/gcc%2Ftree-vect-data-refs.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c76d9edb09d262a3badc87d5583abcfbc2e94854/gcc%2Ftree-vect-data-refs.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-data-refs.c?ref=c76d9edb09d262a3badc87d5583abcfbc2e94854", "patch": "@@ -1253,7 +1253,8 @@ static void\n vect_get_data_access_cost (struct data_reference *dr,\n                            unsigned int *inside_cost,\n                            unsigned int *outside_cost,\n-\t\t\t   stmt_vector_for_cost *body_cost_vec)\n+\t\t\t   stmt_vector_for_cost *body_cost_vec,\n+\t\t\t   stmt_vector_for_cost *prologue_cost_vec)\n {\n   gimple *stmt = DR_STMT (dr);\n   stmt_vec_info stmt_info = vinfo_for_stmt (stmt);\n@@ -1267,7 +1268,7 @@ vect_get_data_access_cost (struct data_reference *dr,\n \n   if (DR_IS_READ (dr))\n     vect_get_load_cost (dr, ncopies, true, inside_cost, outside_cost,\n-\t\t\tNULL, body_cost_vec, false);\n+\t\t\tprologue_cost_vec, body_cost_vec, false);\n   else\n     vect_get_store_cost (dr, ncopies, inside_cost, body_cost_vec);\n \n@@ -1376,6 +1377,7 @@ vect_get_peeling_costs_all_drs (vec<data_reference_p> datarefs,\n \t\t\t\tunsigned int *inside_cost,\n \t\t\t\tunsigned int *outside_cost,\n \t\t\t\tstmt_vector_for_cost *body_cost_vec,\n+\t\t\t\tstmt_vector_for_cost *prologue_cost_vec,\n \t\t\t\tunsigned int npeel,\n \t\t\t\tbool unknown_misalignment)\n {\n@@ -1410,7 +1412,7 @@ vect_get_peeling_costs_all_drs (vec<data_reference_p> datarefs,\n       else\n \tvect_update_misalignment_for_peel (dr, dr0, npeel);\n       vect_get_data_access_cost (dr, inside_cost, outside_cost,\n-\t\t\t\t body_cost_vec);\n+\t\t\t\t body_cost_vec, prologue_cost_vec);\n       SET_DR_MISALIGNMENT (dr, save_misalignment);\n     }\n }\n@@ -1437,7 +1439,8 @@ vect_peeling_hash_get_lowest_cost (_vect_peel_info **slot,\n \n   vect_get_peeling_costs_all_drs (LOOP_VINFO_DATAREFS (loop_vinfo),\n \t\t\t\t  elem->dr, &inside_cost, &outside_cost,\n-\t\t\t\t  &body_cost_vec, elem->npeel, false);\n+\t\t\t\t  &body_cost_vec, &prologue_cost_vec,\n+\t\t\t\t  elem->npeel, false);\n \n   body_cost_vec.release ();\n \n@@ -1867,7 +1870,7 @@ vect_enhance_data_refs_alignment (loop_vec_info loop_vinfo)\n       vect_get_peeling_costs_all_drs (datarefs, dr0,\n \t\t\t\t      &load_inside_cost,\n \t\t\t\t      &load_outside_cost,\n-\t\t\t\t      &dummy, estimated_npeels, true);\n+\t\t\t\t      &dummy, &dummy, estimated_npeels, true);\n       dummy.release ();\n \n       if (first_store)\n@@ -1876,7 +1879,8 @@ vect_enhance_data_refs_alignment (loop_vec_info loop_vinfo)\n \t  vect_get_peeling_costs_all_drs (datarefs, first_store,\n \t\t\t\t\t  &store_inside_cost,\n \t\t\t\t\t  &store_outside_cost,\n-\t\t\t\t\t  &dummy, estimated_npeels, true);\n+\t\t\t\t\t  &dummy, &dummy,\n+\t\t\t\t\t  estimated_npeels, true);\n \t  dummy.release ();\n \t}\n       else\n@@ -1965,7 +1969,8 @@ vect_enhance_data_refs_alignment (loop_vec_info loop_vinfo)\n       stmt_vector_for_cost dummy;\n       dummy.create (2);\n       vect_get_peeling_costs_all_drs (datarefs, NULL, &nopeel_inside_cost,\n-\t\t\t\t      &nopeel_outside_cost, &dummy, 0, false);\n+\t\t\t\t      &nopeel_outside_cost, &dummy, &dummy,\n+\t\t\t\t      0, false);\n       dummy.release ();\n \n       /* Add epilogue costs.  As we do not peel for alignment here, no prologue"}]}