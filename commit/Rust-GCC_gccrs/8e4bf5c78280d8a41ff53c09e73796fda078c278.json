{"sha": "8e4bf5c78280d8a41ff53c09e73796fda078c278", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGU0YmY1Yzc4MjgwZDhhNDFmZjUzYzA5ZTczNzk2ZmRhMDc4YzI3OA==", "commit": {"author": {"name": "Kenneth Zadeck", "email": "zadeck@naturalbridge.com", "date": "2007-09-05T13:23:32Z"}, "committer": {"name": "Kenneth Zadeck", "email": "zadeck@gcc.gnu.org", "date": "2007-09-05T13:23:32Z"}, "message": "regrename.c (rerename_optimize): Use deferred rescanning and insert explicit calls to rescan insns when changed.\n\n2007-09-05  Kenneth Zadeck <zadeck@naturalbridge.com>\n\n\t* regrename.c (rerename_optimize):  Use deferred rescanning and\n\tinsert explicit calls to rescan insns when changed.\n\nFrom-SVN: r128129", "tree": {"sha": "6e0191f285ef391455b267bddc687c2d26c616ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6e0191f285ef391455b267bddc687c2d26c616ca"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8e4bf5c78280d8a41ff53c09e73796fda078c278", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e4bf5c78280d8a41ff53c09e73796fda078c278", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e4bf5c78280d8a41ff53c09e73796fda078c278", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e4bf5c78280d8a41ff53c09e73796fda078c278/comments", "author": {"login": "zadeck", "id": 42682403, "node_id": "MDQ6VXNlcjQyNjgyNDAz", "avatar_url": "https://avatars.githubusercontent.com/u/42682403?v=4", "gravatar_id": "", "url": "https://api.github.com/users/zadeck", "html_url": "https://github.com/zadeck", "followers_url": "https://api.github.com/users/zadeck/followers", "following_url": "https://api.github.com/users/zadeck/following{/other_user}", "gists_url": "https://api.github.com/users/zadeck/gists{/gist_id}", "starred_url": "https://api.github.com/users/zadeck/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/zadeck/subscriptions", "organizations_url": "https://api.github.com/users/zadeck/orgs", "repos_url": "https://api.github.com/users/zadeck/repos", "events_url": "https://api.github.com/users/zadeck/events{/privacy}", "received_events_url": "https://api.github.com/users/zadeck/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a48b501cb5f9255780d5570c32a2823d9097f36b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a48b501cb5f9255780d5570c32a2823d9097f36b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a48b501cb5f9255780d5570c32a2823d9097f36b"}], "stats": {"total": 16, "additions": 11, "deletions": 5}, "files": [{"sha": "764216d7531e52ddacaf585d730e33fd88e20d02", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e4bf5c78280d8a41ff53c09e73796fda078c278/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e4bf5c78280d8a41ff53c09e73796fda078c278/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8e4bf5c78280d8a41ff53c09e73796fda078c278", "patch": "@@ -1,3 +1,8 @@\n+2007-09-05  Kenneth Zadeck <zadeck@naturalbridge.com>\n+\n+\t* regrename.c (rerename_optimize):  Use deferred rescanning and\n+\tinsert explicit calls to rescan insns when changed.\n+\t\n 2007-09-05  Jan Hubicka  <jh@suse.cz>\n \n \t* optabs.c (libfunc_entry): Change optab to integer."}, {"sha": "a15d675f4c5d2cb758f3365e82ea0b7eba092795", "filename": "gcc/regrename.c", "status": "modified", "additions": 6, "deletions": 5, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e4bf5c78280d8a41ff53c09e73796fda078c278/gcc%2Fregrename.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e4bf5c78280d8a41ff53c09e73796fda078c278/gcc%2Fregrename.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fregrename.c?ref=8e4bf5c78280d8a41ff53c09e73796fda078c278", "patch": "@@ -184,8 +184,8 @@ regrename_optimize (void)\n   df_set_flags (DF_LR_RUN_DCE);\n   df_note_add_problem ();\n   df_analyze ();\n-  df_set_flags (DF_NO_INSN_RESCAN);\n-  \n+  df_set_flags (DF_DEFER_INSN_RESCAN);\n+\n   memset (tick, 0, sizeof tick);\n \n   gcc_obstack_init (&rename_obstack);\n@@ -345,8 +345,6 @@ regrename_optimize (void)\n     }\n \n   obstack_free (&rename_obstack, NULL);\n-  df_clear_flags (DF_NO_INSN_RESCAN);\n-  df_insn_rescan_all ();\n \n   if (dump_file)\n     fputc ('\\n', dump_file);\n@@ -364,6 +362,7 @@ do_replace (struct du_chain *chain, int reg)\n       if (regno >= FIRST_PSEUDO_REGISTER)\n \tORIGINAL_REGNO (*chain->loc) = regno;\n       REG_ATTRS (*chain->loc) = attr;\n+      df_insn_rescan (chain->insn);\n       chain = chain->next_use;\n     }\n }\n@@ -815,9 +814,11 @@ build_def_use (basic_block bb)\n \t\t    OP_IN, 0);\n \n \t  for (i = 0; i < recog_data.n_dups; i++)\n-\t    *recog_data.dup_loc[i] = old_dups[i];\n+\t    *recog_data.dup_loc[i] = copy_rtx (old_dups[i]);\n \t  for (i = 0; i < n_ops; i++)\n \t    *recog_data.operand_loc[i] = old_operands[i];\n+\t  if (recog_data.n_dups)\n+\t    df_insn_rescan (insn);\n \n \t  /* Step 2B: Can't rename function call argument registers.  */\n \t  if (CALL_P (insn) && CALL_INSN_FUNCTION_USAGE (insn))"}]}