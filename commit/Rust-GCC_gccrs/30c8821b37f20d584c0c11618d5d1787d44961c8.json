{"sha": "30c8821b37f20d584c0c11618d5d1787d44961c8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzBjODgyMWIzN2YyMGQ1ODRjMGMxMTYxOGQ1ZDE3ODdkNDQ5NjFjOA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2016-08-13T08:04:46Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-08-13T08:04:46Z"}, "message": "tree-ssa-forwprop.c (pass_forwprop::execute): Propagate into PHIs and update the lattice for its def.\n\n2016-08-13  Richard Biener  <rguenther@suse.de>\n\n\t* tree-ssa-forwprop.c (pass_forwprop::execute): Propagate\n\tinto PHIs and update the lattice for its def.\n\nFrom-SVN: r239444", "tree": {"sha": "8037fa2ccfb72a14c6220f22d6faf7c2b45297f3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8037fa2ccfb72a14c6220f22d6faf7c2b45297f3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/30c8821b37f20d584c0c11618d5d1787d44961c8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30c8821b37f20d584c0c11618d5d1787d44961c8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/30c8821b37f20d584c0c11618d5d1787d44961c8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/30c8821b37f20d584c0c11618d5d1787d44961c8/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "82b709f9c4c9b21761a44a08db43524efa40dcd5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82b709f9c4c9b21761a44a08db43524efa40dcd5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82b709f9c4c9b21761a44a08db43524efa40dcd5"}], "stats": {"total": 34, "additions": 34, "deletions": 0}, "files": [{"sha": "a3ffe871b410c286aa6ef41d80191d1cdf19c70b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30c8821b37f20d584c0c11618d5d1787d44961c8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30c8821b37f20d584c0c11618d5d1787d44961c8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=30c8821b37f20d584c0c11618d5d1787d44961c8", "patch": "@@ -1,3 +1,8 @@\n+2016-08-13  Richard Biener  <rguenther@suse.de>\n+\n+\t* tree-ssa-forwprop.c (pass_forwprop::execute): Propagate\n+\tinto PHIs and update the lattice for its def.\n+\n 2016-08-12  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/71512"}, {"sha": "736b841bc90207ae5900b9dc80e9edad0f446ed4", "filename": "gcc/tree-ssa-forwprop.c", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/30c8821b37f20d584c0c11618d5d1787d44961c8/gcc%2Ftree-ssa-forwprop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/30c8821b37f20d584c0c11618d5d1787d44961c8/gcc%2Ftree-ssa-forwprop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-forwprop.c?ref=30c8821b37f20d584c0c11618d5d1787d44961c8", "patch": "@@ -2107,6 +2107,35 @@ pass_forwprop::execute (function *fun)\n       gimple_stmt_iterator gsi;\n       basic_block bb = BASIC_BLOCK_FOR_FN (fun, postorder[i]);\n \n+      /* Propagate into PHIs and record degenerate ones in the lattice.  */\n+      for (gphi_iterator si = gsi_start_phis (bb); !gsi_end_p (si);\n+\t   gsi_next (&si))\n+\t{\n+\t  gphi *phi = si.phi ();\n+\t  tree res = gimple_phi_result (phi);\n+\t  if (virtual_operand_p (res))\n+\t    continue;\n+\n+\t  use_operand_p use_p;\n+\t  ssa_op_iter it;\n+\t  tree first = NULL_TREE;\n+\t  bool all_same = true;\n+\t  FOR_EACH_PHI_ARG (use_p, phi, it, SSA_OP_USE)\n+\t    {\n+\t      tree use = USE_FROM_PTR (use_p);\n+\t      tree tem = fwprop_ssa_val (use);\n+\t      if (! first)\n+\t\tfirst = tem;\n+\t      else if (! operand_equal_p (first, tem, 0))\n+\t\tall_same = false;\n+\t      if (tem != use\n+\t\t  && may_propagate_copy (use, tem))\n+\t\tpropagate_value (use_p, tem);\n+\t    }\n+\t  if (all_same)\n+\t    fwprop_set_lattice_val (res, first);\n+\t}\n+\n       /* Apply forward propagation to all stmts in the basic-block.\n \t Note we update GSI within the loop as necessary.  */\n       for (gsi = gsi_start_bb (bb); !gsi_end_p (gsi); )"}]}