{"sha": "4b8174ff7aa7e610985d6eb0e54b1c1256121723", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGI4MTc0ZmY3YWE3ZTYxMDk4NWQ2ZWIwZTU0YjFjMTI1NjEyMTcyMw==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2003-08-19T06:15:09Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2003-08-19T06:15:09Z"}, "message": "re PR target/11924 (mips64-linux o32 accesses to certain file-local data incorrectly generated)\n\n\tPR target/11924\n\t* config/mips/mips.c (INTERNAL_SYMBOL_P): New macro.\n\t(mips_classify_symbol, m16_usym8_4, m16_usym5_4): Use it.\n\nFrom-SVN: r70556", "tree": {"sha": "b36adeac4a3ea19acceabcfbf4fce6a5fc96be3a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b36adeac4a3ea19acceabcfbf4fce6a5fc96be3a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b8174ff7aa7e610985d6eb0e54b1c1256121723", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b8174ff7aa7e610985d6eb0e54b1c1256121723", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b8174ff7aa7e610985d6eb0e54b1c1256121723", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b8174ff7aa7e610985d6eb0e54b1c1256121723/comments", "author": null, "committer": null, "parents": [{"sha": "622adc7e1d0dd764163518b15256f3ac381e407f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/622adc7e1d0dd764163518b15256f3ac381e407f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/622adc7e1d0dd764163518b15256f3ac381e407f"}], "stats": {"total": 21, "additions": 12, "deletions": 9}, "files": [{"sha": "039df7454c30260f9ba663dda1bda9782d503669", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b8174ff7aa7e610985d6eb0e54b1c1256121723/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b8174ff7aa7e610985d6eb0e54b1c1256121723/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4b8174ff7aa7e610985d6eb0e54b1c1256121723", "patch": "@@ -1,3 +1,9 @@\n+2003-08-19  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\tPR target/11924\n+\t* config/mips/mips.c (INTERNAL_SYMBOL_P): New macro.\n+\t(mips_classify_symbol, m16_usym8_4, m16_usym5_4): Use it.\n+\n 2003-08-18  Matt Kraai  <kraai@alumni.cmu.edu>\n \n \tPR c/11207"}, {"sha": "e90282161509aac72cba5b7d9feedbac291a996b", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b8174ff7aa7e610985d6eb0e54b1c1256121723/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b8174ff7aa7e610985d6eb0e54b1c1256121723/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=4b8174ff7aa7e610985d6eb0e54b1c1256121723", "patch": "@@ -75,6 +75,9 @@ enum internal_test {\n #define SINGLE_WORD_MODE_P(MODE) \\\n   ((MODE) != BLKmode && GET_MODE_SIZE (MODE) <= UNITS_PER_WORD)\n \n+/* True if the given SYMBOL_REF is for an internally-generated symbol.  */\n+#define INTERNAL_SYMBOL_P(SYM) \\\n+  (XSTR (SYM, 0)[0] == '*' && XSTR (SYM, 0)[1] == LOCAL_LABEL_PREFIX[0])\n \n /* Classifies a non-literal integer constant.\n \n@@ -857,9 +860,7 @@ mips_classify_symbol (rtx x)\n       return SYMBOL_GENERAL;\n     }\n \n-  if (XSTR (x, 0)[0] == '*'\n-      && strncmp (XSTR (x, 0) + 1, LOCAL_LABEL_PREFIX,\n-\t\t  sizeof LOCAL_LABEL_PREFIX - 1) == 0)\n+  if (INTERNAL_SYMBOL_P (x))\n     {\n       /* The symbol is a local label.  For TARGET_MIPS16, SYMBOL_REF_FLAG\n \t will be set if the symbol refers to a string in the current\n@@ -2086,9 +2087,7 @@ m16_usym8_4 (rtx op, enum machine_mode mode ATTRIBUTE_UNUSED)\n   if (GET_CODE (op) == SYMBOL_REF\n       && SYMBOL_REF_FLAG (op)\n       && cfun->machine->insns_len > 0\n-      && XSTR (op, 0)[0] == '*'\n-      && strncmp (XSTR (op, 0) + 1, LOCAL_LABEL_PREFIX,\n-\t\t  sizeof LOCAL_LABEL_PREFIX - 1) == 0\n+      && INTERNAL_SYMBOL_P (op)\n       && (cfun->machine->insns_len + get_pool_size () + mips_string_length\n \t  < 4 * 0x100))\n     {\n@@ -2111,9 +2110,7 @@ m16_usym5_4 (rtx op, enum machine_mode mode ATTRIBUTE_UNUSED)\n   if (GET_CODE (op) == SYMBOL_REF\n       && SYMBOL_REF_FLAG (op)\n       && cfun->machine->insns_len > 0\n-      && XSTR (op, 0)[0] == '*'\n-      && strncmp (XSTR (op, 0) + 1, LOCAL_LABEL_PREFIX,\n-\t\t  sizeof LOCAL_LABEL_PREFIX - 1) == 0\n+      && INTERNAL_SYMBOL_P (op)\n       && (cfun->machine->insns_len + get_pool_size () + mips_string_length\n \t  < 4 * 0x20))\n     {"}]}