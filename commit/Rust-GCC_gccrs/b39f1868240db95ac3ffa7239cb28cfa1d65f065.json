{"sha": "b39f1868240db95ac3ffa7239cb28cfa1d65f065", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjM5ZjE4NjgyNDBkYjk1YWMzZmZhNzIzOWNiMjhjZmExZDY1ZjA2NQ==", "commit": {"author": {"name": "Andrew Ruder", "email": "aeruder@ksu.edu", "date": "2004-01-10T05:47:42Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2004-01-10T05:47:42Z"}, "message": "re PR libobjc/11904 (Problem in sarray_free() function.)\n\n2004-01-09  Andrew Ruder  <aeruder@ksu.edu>\n\n        PR libobjc/11904\n        * sarray.c (sarray_free): Free array->is_copy_of latter.\n\nFrom-SVN: r75630", "tree": {"sha": "419424213290780261e61d34372cbb43fd5f3c70", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/419424213290780261e61d34372cbb43fd5f3c70"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b39f1868240db95ac3ffa7239cb28cfa1d65f065", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b39f1868240db95ac3ffa7239cb28cfa1d65f065", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b39f1868240db95ac3ffa7239cb28cfa1d65f065", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b39f1868240db95ac3ffa7239cb28cfa1d65f065/comments", "author": null, "committer": null, "parents": [{"sha": "f01519dd00355e65f34b40acc82457dcdeedf3d6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f01519dd00355e65f34b40acc82457dcdeedf3d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f01519dd00355e65f34b40acc82457dcdeedf3d6"}], "stats": {"total": 12, "additions": 9, "deletions": 3}, "files": [{"sha": "b9913926b7433a9fe8b092993c48d58d5a3e9c02", "filename": "libobjc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b39f1868240db95ac3ffa7239cb28cfa1d65f065/libobjc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b39f1868240db95ac3ffa7239cb28cfa1d65f065/libobjc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2FChangeLog?ref=b39f1868240db95ac3ffa7239cb28cfa1d65f065", "patch": "@@ -1,3 +1,8 @@\n+2004-01-09  Andrew Ruder  <aeruder@ksu.edu>\n+\n+\tPR libobjc/11904\n+\t* sarray.c (sarray_free): Free array->is_copy_of latter.\n+\n 2003-12-01  Zack Weinberg  <zack@codesourcery.com>\n \n \tPR 11433"}, {"sha": "c37633ba33e73d6ae5234a0594eba6e55b533897", "filename": "libobjc/sarray.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b39f1868240db95ac3ffa7239cb28cfa1d65f065/libobjc%2Fsarray.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b39f1868240db95ac3ffa7239cb28cfa1d65f065/libobjc%2Fsarray.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libobjc%2Fsarray.c?ref=b39f1868240db95ac3ffa7239cb28cfa1d65f065", "patch": "@@ -402,9 +402,6 @@ sarray_free (struct sarray *array) {\n #else\n   old_buckets = array->buckets;\n #endif\n-  \n-  if ((array->is_copy_of) && ((array->is_copy_of->ref_count - 1) == 0))\n-    sarray_free (array->is_copy_of);\n \n   /* Free all entries that do not point to empty_bucket */\n   for (counter = 0; counter <= old_max_index; counter++ ) {\n@@ -462,6 +459,10 @@ sarray_free (struct sarray *array) {\n \n #endif\n   \n+  /* If this is a copy, go ahead and decrement/deallocate the original */\n+  if (array->is_copy_of)\n+    sarray_free (array->is_copy_of);\n+\n   /* free array */\n   sarray_free_garbage (array);\n }"}]}