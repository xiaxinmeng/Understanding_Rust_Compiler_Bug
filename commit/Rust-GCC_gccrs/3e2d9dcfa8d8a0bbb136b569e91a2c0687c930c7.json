{"sha": "3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2UyZDlkY2ZhOGQ4YTBiYmIxMzZiNTY5ZTkxYTJjMDY4N2M5MzBjNw==", "commit": {"author": {"name": "Ramana Radhakrishnan", "email": "ramana.radhakrishnan@arm.com", "date": "2009-08-24T09:03:35Z"}, "committer": {"name": "Ramana Radhakrishnan", "email": "ramana@gcc.gnu.org", "date": "2009-08-24T09:03:35Z"}, "message": "combine cmps with shifts\n\n\n2009-08-24  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>\n\n       * gcc.target/arm/combine-cmp-shift.c: New test.\n\n2009-08-24  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>\n\n       * config/arm/arm.c (arm_select_cc_mode): Handle subreg.\n\nFrom-SVN: r151050", "tree": {"sha": "8ae627b9aadc4ebbe7fd0082ea16a0de542345e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ae627b9aadc4ebbe7fd0082ea16a0de542345e7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/comments", "author": null, "committer": null, "parents": [{"sha": "54f52b81641ce93ebb60a8d62f09ece24b1fa946", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/54f52b81641ce93ebb60a8d62f09ece24b1fa946", "html_url": "https://github.com/Rust-GCC/gccrs/commit/54f52b81641ce93ebb60a8d62f09ece24b1fa946"}], "stats": {"total": 29, "additions": 27, "deletions": 2}, "files": [{"sha": "fc6fa1ece8f438761d5d5fd464f47305a488fdbd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "patch": "@@ -1,3 +1,7 @@\n+2009-08-24  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>\n+\n+       * config/arm/arm.c (arm_select_cc_mode): Handle subreg.\n+\n 2009-08-24  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>\n \n         * config/arm/vfp.md (*arm_movdi_vfp): Mark as predicable."}, {"sha": "0d53896aee0837effa2c376b2ed7b160ac98e99a", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "patch": "@@ -9504,15 +9504,17 @@ arm_select_cc_mode (enum rtx_code op, rtx x, rtx y)\n \n   /* A compare with a shifted operand.  Because of canonicalization, the\n      comparison will have to be swapped when we emit the assembler.  */\n-  if (GET_MODE (y) == SImode && GET_CODE (y) == REG\n+  if (GET_MODE (y) == SImode \n+      && (REG_P (y) || (GET_CODE (y) == SUBREG))\n       && (GET_CODE (x) == ASHIFT || GET_CODE (x) == ASHIFTRT\n \t  || GET_CODE (x) == LSHIFTRT || GET_CODE (x) == ROTATE\n \t  || GET_CODE (x) == ROTATERT))\n     return CC_SWPmode;\n \n   /* This operation is performed swapped, but since we only rely on the Z\n      flag we don't need an additional mode.  */\n-  if (GET_MODE (y) == SImode && REG_P (y)\n+  if (GET_MODE (y) == SImode \n+      && (REG_P (y) || (GET_CODE (y) == SUBREG))\n       && GET_CODE (x) == NEG\n       && (op ==\tEQ || op == NE))\n     return CC_Zmode;"}, {"sha": "3716a9058ba9eb5ba915dee56c9d88552aa8c281", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "patch": "@@ -1,3 +1,7 @@\n+2009-08-11  Ramana Radhakrishnan  <ramana.radhakrishnan@arm.com>\n+\n+       * gcc.target/arm/combine-cmp-shift.c: New test.\n+\n 2009-08-24  Kai Tietz  <kai.tietz@onevision.com>\n \n \t*gcc.dg/format/ms-format1.c: Add new cases for I32"}, {"sha": "1cacc29c83323a113a91fc02b354c59fa921ba7d", "filename": "gcc/testsuite/gcc.target/arm/combine-cmp-shift.c", "status": "added", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcombine-cmp-shift.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcombine-cmp-shift.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farm%2Fcombine-cmp-shift.c?ref=3e2d9dcfa8d8a0bbb136b569e91a2c0687c930c7", "patch": "@@ -0,0 +1,15 @@\n+/* { dg-options \"-O2 -mcpu=cortex-a8\" }  */\n+/* { dg-final { scan-assembler \"cmp\\tr\\[0-9\\]*, r\\[0-9\\]*, asr #31\" } } */\n+\n+typedef int SItype __attribute__ ((mode (SI)));\n+typedef int DItype __attribute__ ((mode (DI)));\n+void abort (void);\n+\n+SItype\n+__mulvsi3 (SItype a, SItype b)\n+{\n+  const DItype w = (DItype) a * (DItype) b;\n+  if ((SItype) (w >> (4 * 8)) != (SItype) w >> ((4 * 8) - 1))\n+    abort ();\n+  return w;\n+}"}]}