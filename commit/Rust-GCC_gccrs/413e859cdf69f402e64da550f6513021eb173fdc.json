{"sha": "413e859cdf69f402e64da550f6513021eb173fdc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDEzZTg1OWNkZjY5ZjQwMmU2NGRhNTUwZjY1MTMwMjFlYjE3M2ZkYw==", "commit": {"author": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2016-12-18T11:03:41Z"}, "committer": {"name": "Janus Weil", "email": "janus@gcc.gnu.org", "date": "2016-12-18T11:03:41Z"}, "message": "re PR fortran/78592 (ICE in gfc_find_specific_dtio_proc, at fortran/interface.c:4939)\n\n2016-12-18  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/78592\n\t* interfac.c (gfc_find_specific_dtio_proc): Fixup for r243005, making\n\tsure that the generic list is followed through until the end.\n\n2016-12-18  Janus Weil  <janus@gcc.gnu.org>\n\n\tPR fortran/78592\n\t* gfortran.dg/dtio_21.f90: New test.\n\nFrom-SVN: r243783", "tree": {"sha": "610ec5bf1dbceb85fb2160fc5250ebdadbf9d45a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/610ec5bf1dbceb85fb2160fc5250ebdadbf9d45a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/413e859cdf69f402e64da550f6513021eb173fdc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/413e859cdf69f402e64da550f6513021eb173fdc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/413e859cdf69f402e64da550f6513021eb173fdc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/413e859cdf69f402e64da550f6513021eb173fdc/comments", "author": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "janusw", "id": 484108, "node_id": "MDQ6VXNlcjQ4NDEwOA==", "avatar_url": "https://avatars.githubusercontent.com/u/484108?v=4", "gravatar_id": "", "url": "https://api.github.com/users/janusw", "html_url": "https://github.com/janusw", "followers_url": "https://api.github.com/users/janusw/followers", "following_url": "https://api.github.com/users/janusw/following{/other_user}", "gists_url": "https://api.github.com/users/janusw/gists{/gist_id}", "starred_url": "https://api.github.com/users/janusw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/janusw/subscriptions", "organizations_url": "https://api.github.com/users/janusw/orgs", "repos_url": "https://api.github.com/users/janusw/repos", "events_url": "https://api.github.com/users/janusw/events{/privacy}", "received_events_url": "https://api.github.com/users/janusw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "ab5d223376e8ef78ee7d5266cae80a9587ffb80e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab5d223376e8ef78ee7d5266cae80a9587ffb80e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab5d223376e8ef78ee7d5266cae80a9587ffb80e"}], "stats": {"total": 65, "additions": 53, "deletions": 12}, "files": [{"sha": "693d51fd5ba07fc8b5a8278d6d65e6f4a437ca7e", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=413e859cdf69f402e64da550f6513021eb173fdc", "patch": "@@ -1,9 +1,13 @@\n+2016-12-18  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/78592\n+\t* interfac.c (gfc_find_specific_dtio_proc): Fixup for r243005, making\n+\tsure that the generic list is followed through until the end.\n+\n 2016-12-17  Thomas Koenig  <tkoenig@gcc.gnu.org>\n \n \tPR fortran/78239\n-\t* decl.c (char_len_param_value):  Actually commit\n-\tprevious change.\n-\n+\t* decl.c (char_len_param_value): Actually commit previous change.\n \n 2016-12-17  Thomas Koenig  <tkoenig@gcc.gnu.org>\n "}, {"sha": "6264aba39164f4e6489453d4a2922a01c241fd6a", "filename": "gcc/fortran/interface.c", "status": "modified", "additions": 11, "deletions": 9, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ffortran%2Finterface.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ffortran%2Finterface.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Finterface.c?ref=413e859cdf69f402e64da550f6513021eb173fdc", "patch": "@@ -4949,17 +4949,19 @@ gfc_find_specific_dtio_proc (gfc_symbol *derived, bool write, bool formatted)\n \t  && tb_io_st->n.sym->generic)\n \t{\n \t  for (gfc_interface *intr = tb_io_st->n.sym->generic;\n-\t       intr && intr->sym && intr->sym->formal;\n-\t       intr = intr->next)\n+\t       intr && intr->sym; intr = intr->next)\n \t    {\n-\t      gfc_symbol *fsym = intr->sym->formal->sym;\n-\t      if ((fsym->ts.type == BT_CLASS\n-\t\t   && CLASS_DATA (fsym)->ts.u.derived == extended)\n-\t\t  || (fsym->ts.type == BT_DERIVED\n-\t\t      && fsym->ts.u.derived == extended))\n+\t      if (intr->sym->formal)\n \t\t{\n-\t\t  dtio_sub = intr->sym;\n-\t\t  break;\n+\t\t  gfc_symbol *fsym = intr->sym->formal->sym;\n+\t\t  if ((fsym->ts.type == BT_CLASS\n+\t\t      && CLASS_DATA (fsym)->ts.u.derived == extended)\n+\t\t      || (fsym->ts.type == BT_DERIVED\n+\t\t\t  && fsym->ts.u.derived == extended))\n+\t\t    {\n+\t\t      dtio_sub = intr->sym;\n+\t\t      break;\n+\t\t    }\n \t\t}\n \t    }\n \t}"}, {"sha": "6583316bbf4f7fd5c8294ad187daaf4d4634f18b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=413e859cdf69f402e64da550f6513021eb173fdc", "patch": "@@ -1,3 +1,8 @@\n+2016-12-18  Janus Weil  <janus@gcc.gnu.org>\n+\n+\tPR fortran/78592\n+\t* gfortran.dg/dtio_21.f90: New test.\n+\n 2016-12-17  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/78746"}, {"sha": "8bfe3aa4367a11bb8393d343f9909fec6d4ac515", "filename": "gcc/testsuite/gfortran.dg/dtio_21.f90", "status": "added", "additions": 30, "deletions": 0, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ftestsuite%2Fgfortran.dg%2Fdtio_21.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/413e859cdf69f402e64da550f6513021eb173fdc/gcc%2Ftestsuite%2Fgfortran.dg%2Fdtio_21.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdtio_21.f90?ref=413e859cdf69f402e64da550f6513021eb173fdc", "patch": "@@ -0,0 +1,30 @@\n+! { dg-do compile }\n+!\n+! PR 78592: [7 Regression] ICE in gfc_find_specific_dtio_proc, at fortran/interface.c:4939\n+!\n+! Contributed by Mikael Morin <morin-mikael@orange.fr>\n+\n+program p\n+   type t\n+   end type\n+   type(t) :: z\n+   type, extends(t) :: t2\n+   end type\n+   class(t2), allocatable :: z2\n+   interface write(formatted)\n+      procedure wf2\n+      module procedure wf   ! { dg-error \"is neither function nor subroutine\" }\n+   end interface\n+   print *, z\n+   allocate(z2)\n+   print *, z2\n+  contains\n+   subroutine wf2(this, a, b, c, d, e)\n+      class(t2), intent(in) :: this\n+      integer, intent(in) :: a\n+      character, intent(in) :: b\n+      integer, intent(in) :: c(:)\n+      integer, intent(out) :: d\n+      character, intent(inout) :: e\n+   end subroutine wf2\n+end"}]}