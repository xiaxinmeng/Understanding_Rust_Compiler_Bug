{"sha": "a8a89b743d7f22120969402642b2375537c67243", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YThhODliNzQzZDdmMjIxMjA5Njk0MDI2NDJiMjM3NTUzN2M2NzI0Mw==", "commit": {"author": {"name": "Javier Miranda", "email": "miranda@adacore.com", "date": "2014-05-21T12:54:18Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-05-21T12:54:18Z"}, "message": "sem_ch3.adb (Build_Derived_Record_Type): Initialize Parent_Base to the full view of the parent type when...\n\n2014-05-21  Javier Miranda  <miranda@adacore.com>\n\n\t* sem_ch3.adb (Build_Derived_Record_Type): Initialize Parent_Base\n\tto the full view of the parent type when processing a derived type\n\twhich is the full view of a private type not defined in a generic\n\tunit which is derived from a private type with discriminants\n\twhose full view is a non-tagged record type.\n\nFrom-SVN: r210699", "tree": {"sha": "f93d17de84149a9537b9bf0cfa91199fff07ad7f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f93d17de84149a9537b9bf0cfa91199fff07ad7f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a8a89b743d7f22120969402642b2375537c67243", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8a89b743d7f22120969402642b2375537c67243", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8a89b743d7f22120969402642b2375537c67243", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8a89b743d7f22120969402642b2375537c67243/comments", "author": {"login": "miranda-adacore", "id": 54413934, "node_id": "MDQ6VXNlcjU0NDEzOTM0", "avatar_url": "https://avatars.githubusercontent.com/u/54413934?v=4", "gravatar_id": "", "url": "https://api.github.com/users/miranda-adacore", "html_url": "https://github.com/miranda-adacore", "followers_url": "https://api.github.com/users/miranda-adacore/followers", "following_url": "https://api.github.com/users/miranda-adacore/following{/other_user}", "gists_url": "https://api.github.com/users/miranda-adacore/gists{/gist_id}", "starred_url": "https://api.github.com/users/miranda-adacore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/miranda-adacore/subscriptions", "organizations_url": "https://api.github.com/users/miranda-adacore/orgs", "repos_url": "https://api.github.com/users/miranda-adacore/repos", "events_url": "https://api.github.com/users/miranda-adacore/events{/privacy}", "received_events_url": "https://api.github.com/users/miranda-adacore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "95bc61b2e3158874bbf8c026961e031fbcdb3520", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95bc61b2e3158874bbf8c026961e031fbcdb3520", "html_url": "https://github.com/Rust-GCC/gccrs/commit/95bc61b2e3158874bbf8c026961e031fbcdb3520"}], "stats": {"total": 22, "additions": 22, "deletions": 0}, "files": [{"sha": "9c47f98ad7d0dd1bc2e973fdf075d16bc5697334", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8a89b743d7f22120969402642b2375537c67243/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8a89b743d7f22120969402642b2375537c67243/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=a8a89b743d7f22120969402642b2375537c67243", "patch": "@@ -1,3 +1,11 @@\n+2014-05-21  Javier Miranda  <miranda@adacore.com>\n+\n+\t* sem_ch3.adb (Build_Derived_Record_Type): Initialize Parent_Base\n+\tto the full view of the parent type when processing a derived type\n+\twhich is the full view of a private type not defined in a generic\n+\tunit which is derived from a private type with discriminants\n+\twhose full view is a non-tagged record type.\n+\n 2014-05-21  Javier Miranda  <miranda@adacore.com>\n \n \t* exp_ch4.adb (Expand_Allocator_Expression.Apply_Accessibility_Check):"}, {"sha": "969674a1dd294d337094671ebc73c7c1d7cd5613", "filename": "gcc/ada/sem_ch3.adb", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a8a89b743d7f22120969402642b2375537c67243/gcc%2Fada%2Fsem_ch3.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a8a89b743d7f22120969402642b2375537c67243/gcc%2Fada%2Fsem_ch3.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch3.adb?ref=a8a89b743d7f22120969402642b2375537c67243", "patch": "@@ -7453,6 +7453,20 @@ package body Sem_Ch3 is\n         and then Has_Discriminants (Parent_Type)\n       then\n          Parent_Base := Base_Type (Full_View (Parent_Type));\n+\n+      --  Handle a derived type which is the full view of a private type not\n+      --  defined in a generic unit which is derived from a private type with\n+      --  discriminants whose full view is a non-tagged record type.\n+\n+      elsif not Inside_A_Generic\n+        and then Ekind (Parent_Type) = E_Private_Type\n+        and then Has_Discriminants (Parent_Type)\n+        and then Present (Full_View (Parent_Type))\n+        and then Is_Record_Type (Full_View (Parent_Type))\n+        and then not Is_Tagged_Type (Full_View (Parent_Type))\n+        and then Has_Private_Declaration (Derived_Type)\n+      then\n+         Parent_Base := Base_Type (Full_View (Parent_Type));\n       else\n          Parent_Base := Base_Type (Parent_Type);\n       end if;"}]}