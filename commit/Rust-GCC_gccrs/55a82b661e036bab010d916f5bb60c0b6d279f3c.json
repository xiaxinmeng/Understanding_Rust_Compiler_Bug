{"sha": "55a82b661e036bab010d916f5bb60c0b6d279f3c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTVhODJiNjYxZTAzNmJhYjAxMGQ5MTZmNWJiNjBjMGI2ZDI3OWYzYw==", "commit": {"author": {"name": "Martin Sebor", "email": "msebor@redhat.com", "date": "2016-03-07T17:01:44Z"}, "committer": {"name": "Martin Sebor", "email": "msebor@gcc.gnu.org", "date": "2016-03-07T17:01:44Z"}, "message": "Add style checks to check_GNU_style.sh.\n\ngcc/contrib/ChangeLog:\n2016-03-07  Martin Sebor  <msebor@redhat.com>\n\n\t* check_GNU_style.sh (color): New global variable.\n\tAdd checks for trailing operators and spaces before left brackets.\n\tTightened up a check for a trailing left curly brace.\n\t(g, ag, vg): Use color.\n\t(col): Don't complain about excessively long lines with DejaGnu\n\tdirectives.\n\nFrom-SVN: r234035", "tree": {"sha": "504ef735be3e4a39b29f39608ed088cd28f85a3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/504ef735be3e4a39b29f39608ed088cd28f85a3b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/55a82b661e036bab010d916f5bb60c0b6d279f3c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55a82b661e036bab010d916f5bb60c0b6d279f3c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/55a82b661e036bab010d916f5bb60c0b6d279f3c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/55a82b661e036bab010d916f5bb60c0b6d279f3c/comments", "author": {"login": "msebor", "id": 381149, "node_id": "MDQ6VXNlcjM4MTE0OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/381149?v=4", "gravatar_id": "", "url": "https://api.github.com/users/msebor", "html_url": "https://github.com/msebor", "followers_url": "https://api.github.com/users/msebor/followers", "following_url": "https://api.github.com/users/msebor/following{/other_user}", "gists_url": "https://api.github.com/users/msebor/gists{/gist_id}", "starred_url": "https://api.github.com/users/msebor/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/msebor/subscriptions", "organizations_url": "https://api.github.com/users/msebor/orgs", "repos_url": "https://api.github.com/users/msebor/repos", "events_url": "https://api.github.com/users/msebor/events{/privacy}", "received_events_url": "https://api.github.com/users/msebor/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b7b528a43b115446011dffec7dca81be302018c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b7b528a43b115446011dffec7dca81be302018c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b7b528a43b115446011dffec7dca81be302018c6"}], "stats": {"total": 47, "additions": 34, "deletions": 13}, "files": [{"sha": "54f9d5e72b225faf559040f4756b7c735c9f6343", "filename": "contrib/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55a82b661e036bab010d916f5bb60c0b6d279f3c/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55a82b661e036bab010d916f5bb60c0b6d279f3c/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=55a82b661e036bab010d916f5bb60c0b6d279f3c", "patch": "@@ -1,3 +1,12 @@\n+2016-03-07  Martin Sebor  <msebor@redhat.com>\n+\n+\t* check_GNU_style.sh (color): New global variable.\n+\tAdd checks for trailing operators and spaces before left brackets.\n+\tTightened up a check for a trailing left curly brace.\n+\t(g, ag, vg): Use color.\n+\t(col): Don't complain about excessively long lines with DejaGnu\n+\tdirectives.\n+\n 2016-03-06  Trevor Saunders  <tbsaunde+gcc@tbsaunde.org>\n \n \t* mklog: Look for the ChangeLog file in $cwd."}, {"sha": "fbf6cb2465d27009ee598c31a1166fd1474269f7", "filename": "contrib/check_GNU_style.sh", "status": "modified", "additions": 25, "deletions": 13, "changes": 38, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/55a82b661e036bab010d916f5bb60c0b6d279f3c/contrib%2Fcheck_GNU_style.sh", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/55a82b661e036bab010d916f5bb60c0b6d279f3c/contrib%2Fcheck_GNU_style.sh", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fcheck_GNU_style.sh?ref=55a82b661e036bab010d916f5bb60c0b6d279f3c", "patch": "@@ -1,7 +1,7 @@\n #!/bin/sh\n \n # Checks some of the GNU style formatting rules in a set of patches.\n-# Copyright (C) 2010, 2012  Free Software Foundation, Inc.\n+# Copyright (C) 2010, 2012, 2016  Free Software Foundation, Inc.\n # Contributed by Sebastian Pop <sebastian.pop@amd.com>\n \n # This program is free software; you can redistribute it and/or modify\n@@ -15,8 +15,11 @@\n # GNU General Public License for more details.\n \n # You should have received a copy of the GNU General Public License\n-# along with this program; if not, write to the Free Software\n-# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\n+# along with this program; if not, see the file COPYING3.  If not,\n+# see <http://www.gnu.org/licenses/>.\n+\n+# Set to empty in the environment to override.\n+: ${color:---color=always}\n \n usage() {\n     cat <<EOF\n@@ -100,7 +103,7 @@ g (){\n \n     local found=false\n     cat $inp \\\n-\t| egrep --color=always -- \"$arg\" \\\n+\t| egrep $color -- \"$arg\" \\\n \t> \"$tmp\" && found=true\n \n     if $found; then\n@@ -117,8 +120,8 @@ ag (){\n \n     local found=false\n     cat $inp \\\n-\t| egrep --color=always -- \"$arg1\" \\\n-\t| egrep --color=always -- \"$arg2\" \\\n+\t| egrep $color -- \"$arg1\" \\\n+\t| egrep $color -- \"$arg2\" \\\n \t> \"$tmp\" && found=true\n \n     if $found; then\n@@ -136,7 +139,7 @@ vg (){\n     local found=false\n     cat $inp \\\n \t| egrep -v -- \"$varg\" \\\n-\t| egrep --color=always -- \"$arg\" \\\n+\t| egrep $color -- \"$arg\" \\\n \t> \"$tmp\" && found=true\n \n     if $found; then\n@@ -171,10 +174,11 @@ col (){\n \t# Expand tabs to spaces according to tab positions.\n \t# Keep long lines, make short lines empty.  Print the part past 80 chars\n \t# in red.\n+        # Don't complain about dg-xxx directives in tests.\n \tcat \"$tmp\" \\\n \t    | sed 's/^[0-9]*:+//' \\\n \t    | expand \\\n-\t    | awk '{ \\\n+\t    | awk '$0 !~ /{[[:space:]]*dg-(error|warning|message)[[:space:]]/ { \\\n \t\t     if (length($0) > 80) \\\n \t\t       printf \"%s\\033[1;31m%s\\033[0m\\n\", \\\n \t\t\t      substr($0,1,80), \\\n@@ -201,6 +205,7 @@ col (){\n     done\n }\n \n+\n col 'Lines should not exceed 80 characters.'\n \n g 'Blocks of 8 spaces should be replaced with tabs.' \\\n@@ -221,13 +226,20 @@ g 'Dot, space, space, end of comment.' \\\n g 'Sentences should end with a dot.  Dot, space, space, end of the comment.' \\\n     '[[:alnum:]][[:blank:]]*\\*/'\n \n-vg 'There should be exactly one space between function name and parentheses.' \\\n+vg 'There should be exactly one space between function name and parenthesis.' \\\n     '\\#define' \\\n     '[[:alnum:]]([[:blank:]]{2,})?\\('\n \n-g 'There should be no space before closing parentheses.' \\\n+g 'There should be no space before a left square bracket.' \\\n+   '[[:alnum:]][[:blank:]]+\\['\n+\n+g 'There should be no space before closing parenthesis.' \\\n     '[[:graph:]][[:blank:]]+\\)'\n \n-ag 'Braces should be on a separate line.' \\\n-    '\\{' \\\n-    'if[[:blank:]]\\(|while[[:blank:]]\\(|switch[[:blank:]]\\('\n+# This will give false positives for C99 compound literals.\n+g 'Braces should be on a separate line.' \\\n+    '(\\)|else)[[:blank:]]*{'\n+\n+# Does this apply to definition of aggregate objects?\n+g 'Trailing operator.' \\\n+  '(([^a-zA-Z_]\\*)|([-%<=&|^?])|([^*]/)|([^:][+]))$'"}]}