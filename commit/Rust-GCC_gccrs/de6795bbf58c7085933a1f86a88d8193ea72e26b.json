{"sha": "de6795bbf58c7085933a1f86a88d8193ea72e26b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGU2Nzk1YmJmNThjNzA4NTkzM2ExZjg2YTg4ZDgxOTNlYTcyZTI2Yg==", "commit": {"author": {"name": "liuhongt", "email": "hongtao.liu@intel.com", "date": "2021-09-02T04:49:46Z"}, "committer": {"name": "liuhongt", "email": "hongtao.liu@intel.com", "date": "2021-09-03T05:04:41Z"}, "message": "Remove macro check for __AMX_BF16/INT8/TILE__ in header file.\n\ngcc/ChangeLog:\n\n\tPR target/102166\n\t* config/i386/amxbf16intrin.h : Remove macro check for __AMX_BF16__.\n\t* config/i386/amxint8intrin.h : Remove macro check for __AMX_INT8__.\n\t* config/i386/amxtileintrin.h : Remove macro check for __AMX_TILE__.\n\ngcc/testsuite/ChangeLog:\n\n\tPR target/102166\n\t* g++.target/i386/pr102166.C: New test.", "tree": {"sha": "bfa2743cb55f8bf4f095283bfdb97df718a30fcb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/bfa2743cb55f8bf4f095283bfdb97df718a30fcb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/de6795bbf58c7085933a1f86a88d8193ea72e26b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de6795bbf58c7085933a1f86a88d8193ea72e26b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de6795bbf58c7085933a1f86a88d8193ea72e26b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de6795bbf58c7085933a1f86a88d8193ea72e26b/comments", "author": {"login": "algebra84", "id": 22926165, "node_id": "MDQ6VXNlcjIyOTI2MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algebra84", "html_url": "https://github.com/algebra84", "followers_url": "https://api.github.com/users/algebra84/followers", "following_url": "https://api.github.com/users/algebra84/following{/other_user}", "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}", "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions", "organizations_url": "https://api.github.com/users/algebra84/orgs", "repos_url": "https://api.github.com/users/algebra84/repos", "events_url": "https://api.github.com/users/algebra84/events{/privacy}", "received_events_url": "https://api.github.com/users/algebra84/received_events", "type": "User", "site_admin": false}, "committer": {"login": "algebra84", "id": 22926165, "node_id": "MDQ6VXNlcjIyOTI2MTY1", "avatar_url": "https://avatars.githubusercontent.com/u/22926165?v=4", "gravatar_id": "", "url": "https://api.github.com/users/algebra84", "html_url": "https://github.com/algebra84", "followers_url": "https://api.github.com/users/algebra84/followers", "following_url": "https://api.github.com/users/algebra84/following{/other_user}", "gists_url": "https://api.github.com/users/algebra84/gists{/gist_id}", "starred_url": "https://api.github.com/users/algebra84/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/algebra84/subscriptions", "organizations_url": "https://api.github.com/users/algebra84/orgs", "repos_url": "https://api.github.com/users/algebra84/repos", "events_url": "https://api.github.com/users/algebra84/events{/privacy}", "received_events_url": "https://api.github.com/users/algebra84/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "9f7c2bad52e51ec88a71c0d50826bfa2e6f44b15", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f7c2bad52e51ec88a71c0d50826bfa2e6f44b15", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f7c2bad52e51ec88a71c0d50826bfa2e6f44b15"}], "stats": {"total": 26, "additions": 23, "deletions": 3}, "files": [{"sha": "1d60e8e609f4ba8badaac6df35b2e28a9cd551b2", "filename": "gcc/config/i386/amxbf16intrin.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Fconfig%2Fi386%2Famxbf16intrin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Fconfig%2Fi386%2Famxbf16intrin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Famxbf16intrin.h?ref=de6795bbf58c7085933a1f86a88d8193ea72e26b", "patch": "@@ -34,7 +34,7 @@\n #define __DISABLE_AMX_BF16__\n #endif /* __AMX_BF16__ */\n \n-#if defined(__x86_64__) && defined(__AMX_BF16__)\n+#if defined(__x86_64__)\n #define _tile_dpbf16ps_internal(dst,src1,src2)\t\t\t\t\t\\\n   __asm__ volatile\\\n   (\"{tdpbf16ps\\t%%tmm\"#src2\", %%tmm\"#src1\", %%tmm\"#dst\"|tdpbf16ps\\t%%tmm\"#dst\", %%tmm\"#src1\", %%tmm\"#src2\"}\" ::)"}, {"sha": "dbb7b6cc5adff2ea16cec8ce194f7b735cdbfdf7", "filename": "gcc/config/i386/amxint8intrin.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Fconfig%2Fi386%2Famxint8intrin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Fconfig%2Fi386%2Famxint8intrin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Famxint8intrin.h?ref=de6795bbf58c7085933a1f86a88d8193ea72e26b", "patch": "@@ -34,7 +34,7 @@\n #define __DISABLE_AMX_INT8__\n #endif /* __AMX_INT8__ */\n \n-#if defined(__x86_64__) && defined(__AMX_INT8__)\n+#if defined(__x86_64__)\n #define _tile_int8_dp_internal(name,dst,src1,src2)\t\t\t\t\t\\\n   __asm__ volatile\t\t\t\t\t\t\t\\\n   (\"{\"#name\"\\t%%tmm\"#src2\", %%tmm\"#src1\", %%tmm\"#dst\"|\"#name\"\\t%%tmm\"#dst\", %%tmm\"#src1\", %%tmm\"#src2\"}\" ::)"}, {"sha": "75d784ad16031a63d922db711628f68e883ccc86", "filename": "gcc/config/i386/amxtileintrin.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Fconfig%2Fi386%2Famxtileintrin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Fconfig%2Fi386%2Famxtileintrin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Famxtileintrin.h?ref=de6795bbf58c7085933a1f86a88d8193ea72e26b", "patch": "@@ -34,7 +34,7 @@\n #define __DISABLE_AMX_TILE__\n #endif /* __AMX_TILE__ */\n \n-#if defined(__x86_64__) && defined(__AMX_TILE__)\n+#if defined(__x86_64__)\n extern __inline void\n __attribute__((__gnu_inline__, __always_inline__, __artificial__))\n _tile_loadconfig (const void *__config)"}, {"sha": "751cd2c6d26fd8cef6c2a8c2486074a7957ba259", "filename": "gcc/testsuite/g++.target/i386/pr102166.C", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr102166.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/de6795bbf58c7085933a1f86a88d8193ea72e26b/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr102166.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.target%2Fi386%2Fpr102166.C?ref=de6795bbf58c7085933a1f86a88d8193ea72e26b", "patch": "@@ -0,0 +1,20 @@\n+/* PR target/102166 */\n+/* { dg-do compile { target { ! ia32 } } } */\n+/* { dg-options \"-O2 -std=c++14\" } */\n+\n+#include<immintrin.h>\n+__attribute__((target(\"amx-tile\"))) void amx()\n+{\n+  _tile_loadd(0, 0, 0);\n+  _tile_release();\n+}\n+\n+__attribute__((target(\"amx-int8\"))) void amxint8()\n+{\n+  _tile_dpbssd(0, 1, 2);\n+}\n+\n+__attribute__((target(\"amx-bf16\"))) void amxbf16()\n+{\n+  _tile_dpbf16ps (0, 1, 2);\n+}"}]}