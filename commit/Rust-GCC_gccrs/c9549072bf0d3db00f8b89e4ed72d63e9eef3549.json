{"sha": "c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk1NDkwNzJiZjBkM2RiMDBmOGI4OWU0ZWQ3MmQ2M2U5ZWVmMzU0OQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2010-05-26T17:57:30Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2010-05-26T17:57:30Z"}, "message": "gimple.c (gimple_types_compatible_p): Return 0 for aggregate and pointer types if they have different alignment or mode.\n\n\t* gimple.c (gimple_types_compatible_p): Return 0 for aggregate and\n\tpointer types if they have different alignment or mode.\n\nFrom-SVN: r159896", "tree": {"sha": "e7de8d484424021858dfc03cb0ea221d07c05c0b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e7de8d484424021858dfc03cb0ea221d07c05c0b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/comments", "author": null, "committer": null, "parents": [{"sha": "db94b0d8594de05c65ace54404d25739965162c7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/db94b0d8594de05c65ace54404d25739965162c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/db94b0d8594de05c65ace54404d25739965162c7"}], "stats": {"total": 53, "additions": 51, "deletions": 2}, "files": [{"sha": "4769643540339fc5d291406902f8610febcee4d9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "patch": "@@ -1,3 +1,8 @@\n+2010-05-26  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gimple.c (gimple_types_compatible_p): Return 0 for aggregate and\n+\tpointer types if they have different alignment or mode.\n+\n 2010-05-26  Anatoly Sokolov  <aesok@post.ru>\n \n \t* config/sparc/sparc.h (FUNCTION_VALUE, FUNCTION_OUTGOING_VALUE,"}, {"sha": "759caf2e0c320569db8952e3fb90068e2e7b2242", "filename": "gcc/gimple.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Fgimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Fgimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple.c?ref=c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "patch": "@@ -3299,8 +3299,7 @@ gimple_types_compatible_p (tree t1, tree t2)\n   if (TREE_CODE (t1) == VOID_TYPE)\n     return 1;\n \n-  /* For numerical types do some simple checks before doing three\n-     hashtable queries.  */\n+  /* Do some simple checks before doing three hashtable queries.  */\n   if (INTEGRAL_TYPE_P (t1)\n       || SCALAR_FLOAT_TYPE_P (t1)\n       || FIXED_POINT_TYPE_P (t1)\n@@ -3334,6 +3333,14 @@ gimple_types_compatible_p (tree t1, tree t2)\n       /* For integral types fall thru to more complex checks.  */\n     }\n \n+  else if (AGGREGATE_TYPE_P (t1) || POINTER_TYPE_P (t1))\n+    {\n+      /* Can't be the same type if they have different alignment or mode.  */\n+      if (TYPE_ALIGN (t1) != TYPE_ALIGN (t2)\n+\t  || TYPE_MODE (t1) != TYPE_MODE (t2))\n+\treturn 0;\n+    }\n+\n   /* If the hash values of t1 and t2 are different the types can't\n      possibly be the same.  This helps keeping the type-pair hashtable\n      small, only tracking comparisons for hash collisions.  */"}, {"sha": "d8a28db0787f86755231241a2f116960f16ff137", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "patch": "@@ -1,3 +1,8 @@\n+2010-05-26  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/lto10.adb: New test.\n+\t* gnat.dg/lto10_pkg.ads: New helper.\n+\n 2010-05-26  Kai Tietz  <kai.tietz@onevision.com>\n \n \t* lib/target-supports.exp (check_effective_target_int128): New"}, {"sha": "647ed0063e7b417fbd7e19f44c020a15d8e8124e", "filename": "gcc/testsuite/gnat.dg/lto10.adb", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Ftestsuite%2Fgnat.dg%2Flto10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Ftestsuite%2Fgnat.dg%2Flto10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Flto10.adb?ref=c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "patch": "@@ -0,0 +1,14 @@\n+-- { dg-do run }\n+-- { dg-options \"-flto\" { target lto } }\n+\n+with Lto10_Pkg; use Lto10_Pkg;\n+\n+procedure Lto10 is\n+   A : Integer := Minus_One;\n+   Pos : Position;\n+begin\n+   Pos := Pix.Pos;\n+   if A /= Minus_One then\n+      raise Program_Error;\n+   end if;\n+end;"}, {"sha": "9be6a78c9c616586554c52c94a4e22387473f5cd", "filename": "gcc/testsuite/gnat.dg/lto10_pkg.ads", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Ftestsuite%2Fgnat.dg%2Flto10_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9549072bf0d3db00f8b89e4ed72d63e9eef3549/gcc%2Ftestsuite%2Fgnat.dg%2Flto10_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Flto10_pkg.ads?ref=c9549072bf0d3db00f8b89e4ed72d63e9eef3549", "patch": "@@ -0,0 +1,18 @@\n+package Lto10_Pkg is\n+\n+   type U16 is mod 2 ** 16;\n+\n+   type Position is record\n+      X, Y, Z : U16;\n+   end record;\n+   for Position'Size use 48;\n+\n+   type Pixel is record\n+      Pos : Position;\n+   end record;\n+   pragma Pack (Pixel);\n+\n+   Minus_One : Integer := -1;\n+   Pix : Pixel := (Pos => (X => 0, Y => 0, Z => 0));\n+\n+end Lto10_Pkg;"}]}