{"sha": "b2469a9bbb9c5390c8fc08dba85a41a86301d441", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjI0NjlhOWJiYjljNTM5MGM4ZmMwOGRiYTg1YTQxYTg2MzAxZDQ0MQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2010-02-05T22:17:09Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2010-02-05T22:17:09Z"}, "message": "re PR c++/42870 (__attribute__ ((dllexport)) produces broken linkage)\n\n\tPR c++/42870\n\t* config/i386/cygming.h (ASM_OUTPUT_DEF_FROM_DECLS): Call\n\ti386_pe_maybe_record_exported_symbol.\n\nFrom-SVN: r156529", "tree": {"sha": "a4aea5e524eeaed258fc573ff1435860cfba78cb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a4aea5e524eeaed258fc573ff1435860cfba78cb"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b2469a9bbb9c5390c8fc08dba85a41a86301d441", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2469a9bbb9c5390c8fc08dba85a41a86301d441", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b2469a9bbb9c5390c8fc08dba85a41a86301d441", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b2469a9bbb9c5390c8fc08dba85a41a86301d441/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bc23518671eb6d05ac19c4d2be738ba991ae9233", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc23518671eb6d05ac19c4d2be738ba991ae9233", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc23518671eb6d05ac19c4d2be738ba991ae9233"}], "stats": {"total": 31, "additions": 31, "deletions": 0}, "files": [{"sha": "c9709125689165f3801313d400ab7cf91925e3a2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b2469a9bbb9c5390c8fc08dba85a41a86301d441", "patch": "@@ -1,3 +1,9 @@\n+2010-02-03  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/42870\n+\t* config/i386/cygming.h (ASM_OUTPUT_DEF_FROM_DECLS): Call\n+\ti386_pe_maybe_record_exported_symbol.\n+\n 2010-02-05  Steve Ellcey  <sje@cup.hp.com>\n \n \tPR target/42924"}, {"sha": "54a61d7a1bcc0bd14509f185419da15b876eebd4", "filename": "gcc/config/i386/cygming.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2Fconfig%2Fi386%2Fcygming.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2Fconfig%2Fi386%2Fcygming.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fcygming.h?ref=b2469a9bbb9c5390c8fc08dba85a41a86301d441", "patch": "@@ -361,6 +361,7 @@ do {\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       const char *alias\t\t\t\t\t\t\t\\\n \t= IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (DECL));\t\t\\\n+      i386_pe_maybe_record_exported_symbol (DECL, alias, 0);\t\t\\\n       if (TREE_CODE (DECL) == FUNCTION_DECL)\t\t\t\t\\\n \ti386_pe_declare_function_type (STREAM, alias,\t\t\t\\\n \t\t\t\t       TREE_PUBLIC (DECL));\t\t\\"}, {"sha": "f7a43f55f6adc70ca5a3802541203f4d59a28416", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=b2469a9bbb9c5390c8fc08dba85a41a86301d441", "patch": "@@ -1,3 +1,8 @@\n+2010-02-03  Jason Merrill  <jason@redhat.com>\n+\n+\tPR c++/42870\n+\t* g++.dg/ext/dllexport3.C: New.\n+\n 2010-02-05  Ozkan Sezer  <sezeroz@gmail.com>\n \n \t* gcc.dg/format/ms-format3.c: New test for specific MS types."}, {"sha": "a47a5e07760fced9491e518ed47664eb38d803c0", "filename": "gcc/testsuite/g++.dg/ext/dllexport3.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdllexport3.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b2469a9bbb9c5390c8fc08dba85a41a86301d441/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdllexport3.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fdllexport3.C?ref=b2469a9bbb9c5390c8fc08dba85a41a86301d441", "patch": "@@ -0,0 +1,19 @@\n+// PR c++/42870\n+// { dg-do compile { target i?86-*-cygwin *-*-mingw* } }\n+// { dg-final { scan-assembler \"-export:_ZN2SaD1Ev\" } }\n+\n+#define ATTRIBUTE __attribute__ ((dllexport))\n+class ATTRIBUTE Sa {\n+ public:\n+  Sa()\n+    {}\n+  ~Sa();\n+};\n+ATTRIBUTE Sa::~Sa()\n+{return;}\n+\n+bool DllMain(void *a,void*b,int)\n+{\n+  Sa s;\n+  return true;\n+}"}]}