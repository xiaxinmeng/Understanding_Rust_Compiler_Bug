{"sha": "feeb0d68f1c7085199c3734e6517a3a4b58309ef", "node_id": "C_kwDOANBUbNoAKGZlZWIwZDY4ZjFjNzA4NTE5OWMzNzM0ZTY1MTdhM2E0YjU4MzA5ZWY", "commit": {"author": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2022-11-22T17:22:03Z"}, "committer": {"name": "Martin Jambor", "email": "mjambor@suse.cz", "date": "2022-11-22T17:29:06Z"}, "message": "ipa-cp: Do not consider useless aggregate constants\n\nWhen building vectors of known aggregate values, there is no point in\nincluding those for parameters which are not used in any way\nwhatsoever.  This patch avoids that together with also other kinds of\nconstants.\n\ngcc/ChangeLog:\n\n2022-11-13  Martin Jambor  <mjambor@suse.cz>\n\n\t* ipa-cp.cc (push_agg_values_from_edge): Do not consider constants\n\tin unused aggregate parameters.", "tree": {"sha": "6757f67a12d3ba4459d41d8c46465feabcb4cb05", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6757f67a12d3ba4459d41d8c46465feabcb4cb05"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/feeb0d68f1c7085199c3734e6517a3a4b58309ef", "comment_count": 0, "verification": {"verified": true, "reason": "valid", "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE5elVTFt/d09Vsoczv2PBvD+kNUAFAmN9BuIACgkQv2PBvD+k\nNUCJbQ/+KGYFarmqWOepbp2C0dDYWrMH0NllauKh2rg9Sj+CKP+cZ5JpT6jsmrMI\nX0zwc6g9Xh42FcuRl9UFS6rWZUV/JcS+JtGVnzPotJR+H0/RfDkrnxwsGicpNEoG\nBgNANjnc7fs/HXS7QB6+N9LD7D2Q5Yt+ruwVog50J2nFm7H9TPE0h6mV+pgqbLQl\ntRQA45bxwekHKelyiiHlfKnnBNf3QTmfqBTU2kIarRJFrpFTMA4lJ8pJaeAMwf8N\nsDSolq8pRzso8LS7Anb/fM0WjXDTGMZGTZl8dbEU5FL0tp7ADz3SBi7QgzqbAdNC\nxKO64ipNnZJ0GGDF6v/fYSyV0/7kwLyrc0QmqibC6sar/zWsLDxJD6/2mKnSAaGu\nLlO8BmMgqQ5zn9BGn//2nxSvnvSOeyh4lTOmSnXcZy2i7MHLSzegn4bEuhsn4C8s\nIv0jMQNUFW5/L9cpfob/tqSDskW2eyHtA7PUjscKmohvln1IktEHHIM8l7l51+vb\n8nEQs4PxYdUHamPEvyQqKZsOPCZOObxio8HoWiTplxwVhZ+FJBtsZgra6ScwX/CO\nIohVNvF3vvN8DDKS/N0vzzXltzmgGojzPO8/QCqzn6se8Epe9KKU5d08BO7tVVFa\nK3od0ODnsnEdHIsKjnKHWKK63cS+7uCM3CYumMq/rjMn/c+O+oM=\n=+s61\n-----END PGP SIGNATURE-----", "payload": "tree 6757f67a12d3ba4459d41d8c46465feabcb4cb05\nparent c826a041081bfe9171353159a41da29b4667cdc0\nauthor Martin Jambor <mjambor@suse.cz> 1669137723 +0100\ncommitter Martin Jambor <mjambor@suse.cz> 1669138146 +0100\n\nipa-cp: Do not consider useless aggregate constants\n\nWhen building vectors of known aggregate values, there is no point in\nincluding those for parameters which are not used in any way\nwhatsoever.  This patch avoids that together with also other kinds of\nconstants.\n\ngcc/ChangeLog:\n\n2022-11-13  Martin Jambor  <mjambor@suse.cz>\n\n\t* ipa-cp.cc (push_agg_values_from_edge): Do not consider constants\n\tin unused aggregate parameters.\n"}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/feeb0d68f1c7085199c3734e6517a3a4b58309ef", "html_url": "https://github.com/Rust-GCC/gccrs/commit/feeb0d68f1c7085199c3734e6517a3a4b58309ef", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/feeb0d68f1c7085199c3734e6517a3a4b58309ef/comments", "author": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jamborm", "id": 2180070, "node_id": "MDQ6VXNlcjIxODAwNzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2180070?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jamborm", "html_url": "https://github.com/jamborm", "followers_url": "https://api.github.com/users/jamborm/followers", "following_url": "https://api.github.com/users/jamborm/following{/other_user}", "gists_url": "https://api.github.com/users/jamborm/gists{/gist_id}", "starred_url": "https://api.github.com/users/jamborm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jamborm/subscriptions", "organizations_url": "https://api.github.com/users/jamborm/orgs", "repos_url": "https://api.github.com/users/jamborm/repos", "events_url": "https://api.github.com/users/jamborm/events{/privacy}", "received_events_url": "https://api.github.com/users/jamborm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c826a041081bfe9171353159a41da29b4667cdc0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c826a041081bfe9171353159a41da29b4667cdc0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c826a041081bfe9171353159a41da29b4667cdc0"}], "stats": {"total": 6, "additions": 5, "deletions": 1}, "files": [{"sha": "d5230c7c5e6b150f7ac9e1a1445178239dc67c39", "filename": "gcc/ipa-cp.cc", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/feeb0d68f1c7085199c3734e6517a3a4b58309ef/gcc%2Fipa-cp.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/feeb0d68f1c7085199c3734e6517a3a4b58309ef/gcc%2Fipa-cp.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-cp.cc?ref=feeb0d68f1c7085199c3734e6517a3a4b58309ef", "patch": "@@ -5785,7 +5785,8 @@ push_agg_values_from_edge (struct cgraph_edge *cs,\n \t}\n \n       ipcp_param_lattices *plats = ipa_get_parm_lattices (dest_info, index);\n-      if (plats->aggs_bottom)\n+      if (!ipa_is_param_used (dest_info, index)\n+\t  || plats->aggs_bottom)\n \tcontinue;\n       push_agg_values_for_index_from_edge (cs, index, res,\n \t\t\t\t\t   optimize_self_recursion ? interim\n@@ -6151,6 +6152,9 @@ decide_whether_version_node (struct cgraph_node *node)\n \n   for (i = 0; i < count;i++)\n     {\n+      if (!ipa_is_param_used (info, i))\n+\tcontinue;\n+\n       class ipcp_param_lattices *plats = ipa_get_parm_lattices (info, i);\n       ipcp_lattice<tree> *lat = &plats->itself;\n       ipcp_lattice<ipa_polymorphic_call_context> *ctxlat = &plats->ctxlat;"}]}