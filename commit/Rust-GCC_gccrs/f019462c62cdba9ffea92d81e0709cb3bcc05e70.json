{"sha": "f019462c62cdba9ffea92d81e0709cb3bcc05e70", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjAxOTQ2MmM2MmNkYmE5ZmZlYTkyZDgxZTA3MDljYjNiY2MwNWU3MA==", "commit": {"author": {"name": "Jan Kratochvil", "email": "jan.kratochvil@redhat.com", "date": "2011-06-13T22:32:40Z"}, "committer": {"name": "Jan Kratochvil", "email": "jkratoch@gcc.gnu.org", "date": "2011-06-13T22:32:40Z"}, "message": "demangle.h (DMGL_RET_POSTFIX): Extend the comment.\n\ninclude/\n\t* demangle.h (DMGL_RET_POSTFIX): Extend the comment.\n\t(DMGL_RET_DROP): New.\n\nlibiberty/\n\t* cp-demangle.c (d_print_comp) <DEMANGLE_COMPONENT_FUNCTION_TYPE>: Do\n\tnot pass DMGL_RET_POSTFIX or DMGL_RET_DROP.  Support DMGL_RET_DROP.\n\t* testsuite/demangle-expected: New testcases for --ret-drop.\n\t* testsuite/test-demangle.c: Document --ret-drop in a comment.\n\t(main): New variable ret_drop, fill it, call cplus_demangle with it.\n\nFrom-SVN: r175000", "tree": {"sha": "24049e95658da009e3b8bd1958b7b0ead304b317", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/24049e95658da009e3b8bd1958b7b0ead304b317"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f019462c62cdba9ffea92d81e0709cb3bcc05e70", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f019462c62cdba9ffea92d81e0709cb3bcc05e70", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f019462c62cdba9ffea92d81e0709cb3bcc05e70", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f019462c62cdba9ffea92d81e0709cb3bcc05e70/comments", "author": {"login": "jankratochvil", "id": 1223939, "node_id": "MDQ6VXNlcjEyMjM5Mzk=", "avatar_url": "https://avatars.githubusercontent.com/u/1223939?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jankratochvil", "html_url": "https://github.com/jankratochvil", "followers_url": "https://api.github.com/users/jankratochvil/followers", "following_url": "https://api.github.com/users/jankratochvil/following{/other_user}", "gists_url": "https://api.github.com/users/jankratochvil/gists{/gist_id}", "starred_url": "https://api.github.com/users/jankratochvil/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jankratochvil/subscriptions", "organizations_url": "https://api.github.com/users/jankratochvil/orgs", "repos_url": "https://api.github.com/users/jankratochvil/repos", "events_url": "https://api.github.com/users/jankratochvil/events{/privacy}", "received_events_url": "https://api.github.com/users/jankratochvil/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "743a99db07908cbc7690ed1fb7c30f8d9e208a8e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/743a99db07908cbc7690ed1fb7c30f8d9e208a8e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/743a99db07908cbc7690ed1fb7c30f8d9e208a8e"}], "stats": {"total": 64, "additions": 55, "deletions": 9}, "files": [{"sha": "fa0dfac51f3993d9b06d570e350e03e480e4cf4d", "filename": "include/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f019462c62cdba9ffea92d81e0709cb3bcc05e70/include%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f019462c62cdba9ffea92d81e0709cb3bcc05e70/include%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/include%2FChangeLog?ref=f019462c62cdba9ffea92d81e0709cb3bcc05e70", "patch": "@@ -1,3 +1,8 @@\n+2011-06-13  Jan Kratochvil  <jan.kratochvil@redhat.com>\n+\n+\t* demangle.h (DMGL_RET_POSTFIX): Extend the comment.\n+\t(DMGL_RET_DROP): New.\n+\n 2011-04-30  Jakub Jelinek  <jakub@redhat.com>\n \n \t* dwarf2.h (DW_OP_GNU_const_type, DW_OP_GNU_regval_type,"}, {"sha": "53f6c54f52466b0e8073b3b5e208d66668359d1c", "filename": "include/demangle.h", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f019462c62cdba9ffea92d81e0709cb3bcc05e70/include%2Fdemangle.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f019462c62cdba9ffea92d81e0709cb3bcc05e70/include%2Fdemangle.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/include%2Fdemangle.h?ref=f019462c62cdba9ffea92d81e0709cb3bcc05e70", "patch": "@@ -45,7 +45,13 @@ extern \"C\" {\n #define DMGL_VERBOSE\t (1 << 3)\t/* Include implementation details.  */\n #define DMGL_TYPES\t (1 << 4)\t/* Also try to demangle type encodings.  */\n #define DMGL_RET_POSTFIX (1 << 5)       /* Print function return types (when\n-                                           present) after function signature */\n+\t\t\t\t\t   present) after function signature.\n+\t\t\t\t\t   It applies only to the toplevel\n+\t\t\t\t\t   function type.  */\n+#define DMGL_RET_DROP\t (1 << 6)       /* Suppress printing function return\n+\t\t\t\t\t   types, even if present.  It applies\n+\t\t\t\t\t   only to the toplevel function type.\n+\t\t\t\t\t   */\n \n #define DMGL_AUTO\t (1 << 8)\n #define DMGL_GNU\t (1 << 9)"}, {"sha": "8e1fa521db61f44c1b2f72fd9eda867ef2767e49", "filename": "libiberty/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2FChangeLog?ref=f019462c62cdba9ffea92d81e0709cb3bcc05e70", "patch": "@@ -1,3 +1,11 @@\n+2011-06-13  Jan Kratochvil  <jan.kratochvil@redhat.com>\n+\n+\t* cp-demangle.c (d_print_comp) <DEMANGLE_COMPONENT_FUNCTION_TYPE>: Do\n+\tnot pass DMGL_RET_POSTFIX or DMGL_RET_DROP.  Support DMGL_RET_DROP.\n+\t* testsuite/demangle-expected: New testcases for --ret-drop.\n+\t* testsuite/test-demangle.c: Document --ret-drop in a comment.\n+\t(main): New variable ret_drop, fill it, call cplus_demangle with it.\n+\n 2011-06-13  Jan Kratochvil  <jan.kratochvil@redhat.com>\n \n \t* cp-demangle.c (struct d_print_info): Remove field options."}, {"sha": "da6d7979f2c44348e38f9523cc17a3d361400f6a", "filename": "libiberty/cp-demangle.c", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2Fcp-demangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2Fcp-demangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Fcp-demangle.c?ref=f019462c62cdba9ffea92d81e0709cb3bcc05e70", "patch": "@@ -3917,10 +3917,12 @@ d_print_comp (struct d_print_info *dpi, int options,\n     case DEMANGLE_COMPONENT_FUNCTION_TYPE:\n       {\n \tif ((options & DMGL_RET_POSTFIX) != 0)\n-\t  d_print_function_type (dpi, options, dc, dpi->modifiers);\n+\t  d_print_function_type (dpi,\n+\t\t\t\t options & ~(DMGL_RET_POSTFIX | DMGL_RET_DROP),\n+\t\t\t\t dc, dpi->modifiers);\n \n \t/* Print return type if present */\n-\tif (d_left (dc) != NULL)\n+\tif (d_left (dc) != NULL && (options & DMGL_RET_DROP) == 0)\n \t  {\n \t    struct d_print_mod dpm;\n \n@@ -3932,7 +3934,8 @@ d_print_comp (struct d_print_info *dpi, int options,\n \t    dpm.printed = 0;\n \t    dpm.templates = dpi->templates;\n \n-\t    d_print_comp (dpi, options, d_left (dc));\n+\t    d_print_comp (dpi, options & ~(DMGL_RET_POSTFIX | DMGL_RET_DROP),\n+\t\t\t  d_left (dc));\n \n \t    dpi->modifiers = dpm.next;\n \n@@ -3946,7 +3949,9 @@ d_print_comp (struct d_print_info *dpi, int options,\n \t  }\n \n \tif ((options & DMGL_RET_POSTFIX) == 0)\n-\t  d_print_function_type (dpi, options, dc, dpi->modifiers);\n+\t  d_print_function_type (dpi,\n+\t\t\t\t options & ~(DMGL_RET_POSTFIX | DMGL_RET_DROP),\n+\t\t\t\t dc, dpi->modifiers);\n \n \treturn;\n       }"}, {"sha": "63a3e24ba4193799b92282a15054bc3abb2c6081", "filename": "libiberty/testsuite/demangle-expected", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2Ftestsuite%2Fdemangle-expected", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2Ftestsuite%2Fdemangle-expected", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Ftestsuite%2Fdemangle-expected?ref=f019462c62cdba9ffea92d81e0709cb3bcc05e70", "patch": "@@ -3959,6 +3959,24 @@ f(decltype(nullptr))\n --format=gnu-v3\n _ZN5aaaaa6bbbbbb5cccccIN23ddddddddddddddddddddddd3eeeENS2_4ffff16ggggggggggggggggENS0_9hhhhhhhhhES6_S6_S6_S6_S6_S6_S6_EE\n aaaaa::bbbbbb::ccccc<ddddddddddddddddddddddd::eee, ddddddddddddddddddddddd::ffff::gggggggggggggggg, aaaaa::bbbbbb::hhhhhhhhh, aaaaa::bbbbbb::hhhhhhhhh, aaaaa::bbbbbb::hhhhhhhhh, aaaaa::bbbbbb::hhhhhhhhh, aaaaa::bbbbbb::hhhhhhhhh, aaaaa::bbbbbb::hhhhhhhhh, aaaaa::bbbbbb::hhhhhhhhh, aaaaa::bbbbbb::hhhhhhhhh>\n+--format=gnu-v3\n+_Z5outerIsEcPFilE\n+char outer<short>(int (*)(long))\n+--format=gnu-v3\n+_Z5outerPFsiEl\n+outer(short (*)(int), long)\n+--format=gnu-v3\n+_Z6outer2IsEPFilES1_\n+int (*outer2<short>(int (*)(long)))(long)\n+--format=gnu-v3 --ret-drop\n+_Z5outerIsEcPFilE\n+outer<short>(int (*)(long))\n+--format=gnu-v3 --ret-drop\n+_Z5outerPFsiEl\n+outer(short (*)(int), long)\n+--format=gnu-v3 --ret-drop\n+_Z6outer2IsEPFilES1_\n+outer2<short>(int (*)(long))\n #\n # Ada (GNAT) tests.\n #"}, {"sha": "11d9729999b80259cb82189012d08bd449e58f5f", "filename": "libiberty/testsuite/test-demangle.c", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2Ftestsuite%2Ftest-demangle.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f019462c62cdba9ffea92d81e0709cb3bcc05e70/libiberty%2Ftestsuite%2Ftest-demangle.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libiberty%2Ftestsuite%2Ftest-demangle.c?ref=f019462c62cdba9ffea92d81e0709cb3bcc05e70", "patch": "@@ -159,6 +159,7 @@ exp: %s\\n\",\n                          output is an integer representing ctor_kind.\n      --is-v3-dtor        Likewise, but for dtors.\n      --ret-postfix       Passes the DMGL_RET_POSTFIX option\n+     --ret-drop          Passes the DMGL_RET_DROP option\n \n    For compatibility, just in case it matters, the options line may be\n    empty, to mean --format=auto.  If it doesn't start with --, then it\n@@ -174,7 +175,7 @@ main(argc, argv)\n   int no_params;\n   int is_v3_ctor;\n   int is_v3_dtor;\n-  int ret_postfix;\n+  int ret_postfix, ret_drop;\n   struct line format;\n   struct line input;\n   struct line expect;\n@@ -209,6 +210,7 @@ main(argc, argv)\n \n       no_params = 0;\n       ret_postfix = 0;\n+      ret_drop = 0;\n       is_v3_ctor = 0;\n       is_v3_dtor = 0;\n       if (format.data[0] == '\\0')\n@@ -265,6 +267,8 @@ main(argc, argv)\n \t\tis_v3_dtor = 1;\n \t      else if (strcmp (opt, \"--ret-postfix\") == 0)\n \t\tret_postfix = 1;\n+\t      else if (strcmp (opt, \"--ret-drop\") == 0)\n+\t\tret_drop = 1;\n \t      else\n \t\t{\n \t\t  printf (\"FAIL at line %d: unrecognized option %s\\n\",\n@@ -307,9 +311,9 @@ main(argc, argv)\n \n       cplus_demangle_set_style (style);\n \n-      result = cplus_demangle (inp,\n-\t\t\t       DMGL_PARAMS|DMGL_ANSI|DMGL_TYPES\n-\t\t\t       |(ret_postfix ? DMGL_RET_POSTFIX : 0));\n+      result = cplus_demangle (inp, (DMGL_PARAMS | DMGL_ANSI | DMGL_TYPES\n+\t\t\t\t     | (ret_postfix ? DMGL_RET_POSTFIX : 0)\n+\t\t\t\t     | (ret_drop ? DMGL_RET_DROP : 0)));\n \n       if (result\n \t  ? strcmp (result, expect.data)"}]}