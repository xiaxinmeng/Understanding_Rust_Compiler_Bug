{"sha": "af5513e96b5539e4b3368050ba9064bb41b391f2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWY1NTEzZTk2YjU1MzllNGIzMzY4MDUwYmE5MDY0YmI0MWIzOTFmMg==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-03-02T18:43:56Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@gcc.gnu.org", "date": "2015-03-02T18:43:56Z"}, "message": "re PR lto/65276 (LTO: ICE add_type_duplicate, at ipa-devirt.c:1462)\n\n\tPR lto/65276\n\t* ipa-devirt.c (add_type_duplicate): Remove odr_violated assert\n\twhen checking TYPE_BINFO.\n\nCo-Authored-By: Aldy Hernandez <aldyh@redhat.com>\n\nFrom-SVN: r221121", "tree": {"sha": "7856a547196c8fe41b28857deededf53470e3272", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7856a547196c8fe41b28857deededf53470e3272"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/af5513e96b5539e4b3368050ba9064bb41b391f2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af5513e96b5539e4b3368050ba9064bb41b391f2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/af5513e96b5539e4b3368050ba9064bb41b391f2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/af5513e96b5539e4b3368050ba9064bb41b391f2/comments", "author": null, "committer": null, "parents": [{"sha": "7727f8f2c0e1a68851b646ad124d46a4dfb3be5d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7727f8f2c0e1a68851b646ad124d46a4dfb3be5d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7727f8f2c0e1a68851b646ad124d46a4dfb3be5d"}], "stats": {"total": 103, "additions": 102, "deletions": 1}, "files": [{"sha": "da14db851574a406a25c7534e6bc16c1d243dade", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=af5513e96b5539e4b3368050ba9064bb41b391f2", "patch": "@@ -1,3 +1,10 @@\n+2015-03-02  Jan Hubicka  <hubicka@ucw.cz>\n+\t    Aldy Hernandez  <aldyh@redhat.com>\n+\n+\tPR lto/65276\n+\t* ipa-devirt.c (add_type_duplicate): Remove odr_violated assert\n+\twhen checking TYPE_BINFO.\n+\n 2015-03-02  Richard Biener  <rguenther@suse.de>\n \n \tPR ipa/65270"}, {"sha": "fe29932c3e0efb64f43b44b723d6b5a333a579dd", "filename": "gcc/ipa-devirt.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2Fipa-devirt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2Fipa-devirt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-devirt.c?ref=af5513e96b5539e4b3368050ba9064bb41b391f2", "patch": "@@ -1459,7 +1459,6 @@ add_type_duplicate (odr_type val, tree type)\n \t\t\t&& polymorphic_type_binfo_p (TYPE_BINFO (type1))\n \t\t           != polymorphic_type_binfo_p (TYPE_BINFO (type2))))\n \t\t  {\n-\t\t    gcc_assert (val->odr_violated);\n \t\t    base_mismatch = true;\n \t\t    break;\n \t\t  }"}, {"sha": "c8e96999dc0cf19c509fe9610db12b3af3c1604c", "filename": "gcc/testsuite/g++.dg/lto/pr65276_0.C", "status": "added", "additions": 61, "deletions": 0, "changes": 61, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr65276_0.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr65276_0.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr65276_0.C?ref=af5513e96b5539e4b3368050ba9064bb41b391f2", "patch": "@@ -0,0 +1,61 @@\n+// { dg-lto-do link }\n+// { dg-lto-options {{-flto -O0 -std=c++11}} }\n+\n+/* pr65276_0.C should get compiled with -O0, while the _1.C file\n+   should get compiled with -O2, and the entire thing should be linked\n+   with -O0.  Test that we don't get an ICE.  */\n+\n+extern \"C++\"\n+{\n+  namespace std\n+  {\n+    class exception\n+    {\n+    public:\n+      virtual ~ exception () noexcept;\n+    };\n+  }\n+}\n+namespace std\n+{\n+  struct __cow_string\n+  {\n+    union\n+    {\n+      const char *_M_p;\n+      char _M_bytes[sizeof (const char *)];\n+    };\n+  };\n+  class runtime_error:public exception\n+  {\n+    __cow_string _M_msg;\n+  };\n+}\n+namespace std\n+{\n+  class system_error:public std::runtime_error\n+  {\n+  };\n+  enum _Ios_Fmtflags\n+  {\n+  };\n+  inline constexpr _Ios_Fmtflags operator& (_Ios_Fmtflags __a,\n+                                            _Ios_Fmtflags __b)\n+  {\n+    return _Ios_Fmtflags ();\n+  }\n+  enum _Ios_Openmode\n+  {\n+  };\n+  class ios_base\n+  {\n+  public:\n+    class __attribute ((__abi_tag__ (\"cxx11\"))) failure:public system_error\n+    {\n+    };\n+    class Init\n+    {\n+    };\n+  };\n+  static ios_base::Init __ioinit;\n+}"}, {"sha": "ee49752f0f502d006f3a0c5d925e0d642e4b105a", "filename": "gcc/testsuite/g++.dg/lto/pr65276_1.C", "status": "added", "additions": 34, "deletions": 0, "changes": 34, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr65276_1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/af5513e96b5539e4b3368050ba9064bb41b391f2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr65276_1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Flto%2Fpr65276_1.C?ref=af5513e96b5539e4b3368050ba9064bb41b391f2", "patch": "@@ -0,0 +1,34 @@\n+// { dg-options \"-O2\" }\n+#pragma implementation\n+#pragma interface\n+extern \"C++\"\n+{\n+  namespace std\n+  {\n+    class exception\n+    {\n+    public:\n+      virtual ~ exception () noexcept;\n+    };\n+  }\n+}\n+namespace std\n+{\n+  struct __cow_string\n+  {\n+    union\n+    {\n+      const char *_M_p;\n+      char _M_bytes[sizeof (const char *)];\n+    };\n+  };\n+  class runtime_error:public exception\n+  {\n+    __cow_string _M_msg;\n+  };\n+}\n+\n+int main()\n+{\n+  return 0;\n+}"}]}