{"sha": "a1d2b16202601e597fac1c0e6af6ee8cd09b52c0", "node_id": "C_kwDOANBUbNoAKGExZDJiMTYyMDI2MDFlNTk3ZmFjMWMwZTZhZjZlZThjZDA5YjUyYzA", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2021-11-12T17:05:13Z"}, "committer": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2021-11-16T19:44:51Z"}, "message": "configure, Darwin: Set appropriate defaults for host-shared.\n\nDarwin x86_64 and aarch64 platforms are PIC (shared) by default,\nand user-space code must be built in this mode.  The patch\nensures that this is set correctly and applies a default when\n--enable-host-shared is not set.\n\nSigned-off-by: Iain Sandoe <iain@sandoe.co.uk>\n\nChangeLog:\n\n\t* configure: Regenerate.\n\t* configure.ac: Ensure that PIC (shared) defaults are set\n\tcorrectly for Darwin.", "tree": {"sha": "36caf4313d284a18fe291c6e089a1c7733aadca8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/36caf4313d284a18fe291c6e089a1c7733aadca8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e4641191287ca613529d78a906afe4f029c1c3cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4641191287ca613529d78a906afe4f029c1c3cd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4641191287ca613529d78a906afe4f029c1c3cd"}], "stats": {"total": 31, "additions": 29, "deletions": 2}, "files": [{"sha": "3062495da31ff15d1c69f03d23615e0de6f4d417", "filename": "configure", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0/configure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0/configure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure?ref=a1d2b16202601e597fac1c0e6af6ee8cd09b52c0", "patch": "@@ -8447,8 +8447,20 @@ fi\n # Check whether --enable-host-shared was given.\n if test \"${enable_host_shared+set}\" = set; then :\n   enableval=$enable_host_shared; host_shared=$enableval\n+ case $target in\n+   x86_64-*-darwin* | aarch64-*-darwin*)\n+     if test x$host_shared != xyes ; then\n+       # PIC is the default, and actually cannot be switched off.\n+       echo configure.ac: warning: PIC code is required for the configured target, host-shared setting ignored. 1>&2\n+       host_shared=yes\n+     fi ;;\n+  *) ;;\n+ esac\n else\n-  host_shared=no\n+  case $target in\n+  x86_64-*-darwin* | aarch64-*-darwin*) host_shared=yes ;;\n+  *) host_shared=no ;;\n+ esac\n fi\n \n \n@@ -10083,6 +10095,8 @@ done\n \n \n \n+\n+\n # Generate default definitions for YACC, M4, LEX and other programs that run\n # on the build machine.  These are used if the Makefile can't locate these\n # programs in objdir."}, {"sha": "bed60bcaf72cc651cc09876bc0d9e509b41260e8", "filename": "configure.ac", "status": "modified", "additions": 14, "deletions": 1, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0/configure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a1d2b16202601e597fac1c0e6af6ee8cd09b52c0/configure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/configure.ac?ref=a1d2b16202601e597fac1c0e6af6ee8cd09b52c0", "patch": "@@ -1859,7 +1859,20 @@ AC_SUBST(extra_linker_plugin_flags)\n AC_ARG_ENABLE(host-shared,\n [AS_HELP_STRING([--enable-host-shared],\n \t\t[build host code as shared libraries])],\n-[host_shared=$enableval], [host_shared=no])\n+[host_shared=$enableval\n+ case $target in\n+   x86_64-*-darwin* | aarch64-*-darwin*)\n+     if test x$host_shared != xyes ; then\n+       # PIC is the default, and actually cannot be switched off.\n+       echo configure.ac: warning: PIC code is required for the configured target, host-shared setting ignored. 1>&2\n+       host_shared=yes\n+     fi ;;\n+  *) ;;\n+ esac],\n+[case $target in\n+  x86_64-*-darwin* | aarch64-*-darwin*) host_shared=yes ;;\n+  *) host_shared=no ;;\n+ esac])\n AC_SUBST(host_shared)\n \n # By default, C and C++ are the only stage 1 languages."}]}