{"sha": "46eeda17171bc5a3b2877d4c470465ff284713a7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDZlZWRhMTcxNzFiYzVhM2IyODc3ZDRjNDcwNDY1ZmYyODQ3MTNhNw==", "commit": {"author": {"name": "Doug Evans", "email": "dje@gnu.org", "date": "1994-02-26T18:07:52Z"}, "committer": {"name": "Doug Evans", "email": "dje@gnu.org", "date": "1994-02-26T18:07:52Z"}, "message": "fixincludes: Fix including of machine/r3_cpu.h and machine/r4_cpu.h in machine/cpu.h on...\n\n* fixincludes: Fix including of machine/r3_cpu.h and machine/r4_cpu.h\nin machine/cpu.h on Ultrix 4.3.\n\nFrom-SVN: r6628", "tree": {"sha": "836b4bd3ba5b48622700b0cb9846bcba4f4737c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/836b4bd3ba5b48622700b0cb9846bcba4f4737c4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/46eeda17171bc5a3b2877d4c470465ff284713a7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46eeda17171bc5a3b2877d4c470465ff284713a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46eeda17171bc5a3b2877d4c470465ff284713a7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46eeda17171bc5a3b2877d4c470465ff284713a7/comments", "author": null, "committer": null, "parents": [{"sha": "818a0d4e44eca1ebbe1ecb75863b7e5842d66e8c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/818a0d4e44eca1ebbe1ecb75863b7e5842d66e8c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/818a0d4e44eca1ebbe1ecb75863b7e5842d66e8c"}], "stats": {"total": 11, "additions": 8, "deletions": 3}, "files": [{"sha": "0b6ea512a33de628c703ae5447155bcdce428d7c", "filename": "gcc/fixincludes", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46eeda17171bc5a3b2877d4c470465ff284713a7/gcc%2Ffixincludes", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46eeda17171bc5a3b2877d4c470465ff284713a7/gcc%2Ffixincludes", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixincludes?ref=46eeda17171bc5a3b2877d4c470465ff284713a7", "patch": "@@ -583,6 +583,7 @@ if [ -r ${LIB}/$file ]; then\n fi\n \n # Check for superfluous `static' (in Ultrix 4.2)\n+# On Ultrix 4.3, includes of other files (r3_cpu.h,r4_cpu.h) is broken.\n file=machine/cpu.h\n if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n   mkdir ${LIB}/machine 2>/dev/null\n@@ -592,16 +593,20 @@ if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n fi\n \n if [ -r ${LIB}/$file ]; then\n-  echo Fixing $file, superfluous static\n-  sed -e 's/^static struct tlb_pid_state/struct tlb_pid_state/' ${LIB}/$file > ${LIB}/${file}.sed\n+  echo Fixing $file, superfluous static and broken includes of other files.\n+  sed -e 's/^static struct tlb_pid_state/struct tlb_pid_state/' \\\n+      -e 's/^#include \"r3_cpu\\.h\"$/#include <machine\\/r3_cpu\\.h>/' \\\n+      -e 's/^#include \"r4_cpu\\.h\"$/#include <machine\\/r4_cpu\\.h>/' \\\n+      ${LIB}/$file > ${LIB}/${file}.sed\n   rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n   if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n     rm ${LIB}/$file\n   else\n # This file has an alternative name, mips/cpu.h.  Fix that name, too.\n     if cmp machine/cpu.h mips/cpu.h > /dev/null 2>&1; then\n       mkdir ${LIB}/mips 2>&-\n-      ln ${LIB}/$file ${LIB}/mips/cpu.h \n+# Don't remove the file first, they may be the same file!\n+      ln ${LIB}/$file ${LIB}/mips/cpu.h > /dev/null 2>&1\n     fi\n   fi\n fi"}]}