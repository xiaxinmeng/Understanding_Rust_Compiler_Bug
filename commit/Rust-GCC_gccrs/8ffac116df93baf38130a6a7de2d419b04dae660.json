{"sha": "8ffac116df93baf38130a6a7de2d419b04dae660", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGZmYWMxMTZkZjkzYmFmMzgxMzBhNmE3ZGUyZDQxOWIwNGRhZTY2MA==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2011-04-02T09:38:22Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2011-04-02T09:38:22Z"}, "message": "utils2.c (build_allocator): In the unconstrained array type case...\n\n\t* gcc-interface/utils2.c (build_allocator): In the unconstrained array\n\ttype case, do not strip a padding type around the array type.\n\nFrom-SVN: r171888", "tree": {"sha": "42940b22d690719ccf797ddfd601469fcfa24885", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/42940b22d690719ccf797ddfd601469fcfa24885"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8ffac116df93baf38130a6a7de2d419b04dae660", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ffac116df93baf38130a6a7de2d419b04dae660", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ffac116df93baf38130a6a7de2d419b04dae660", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ffac116df93baf38130a6a7de2d419b04dae660/comments", "author": null, "committer": null, "parents": [{"sha": "de9528f0291faf10d65dd7b00f7101005c2ee38a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de9528f0291faf10d65dd7b00f7101005c2ee38a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de9528f0291faf10d65dd7b00f7101005c2ee38a"}], "stats": {"total": 38, "additions": 26, "deletions": 12}, "files": [{"sha": "8f164e542d289704bd74d948baca1cfbc863609e", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=8ffac116df93baf38130a6a7de2d419b04dae660", "patch": "@@ -1,3 +1,8 @@\n+2011-04-02  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gcc-interface/utils2.c (build_allocator): In the unconstrained array\n+\ttype case, do not strip a padding type around the array type.\n+\n 2011-04-02  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/utils.c (update_pointer_to): Finalize named pointer"}, {"sha": "240d3459d107a2e331359bd714fcd75c8226f38a", "filename": "gcc/ada/gcc-interface/utils2.c", "status": "modified", "additions": 3, "deletions": 12, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Fada%2Fgcc-interface%2Futils2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Fada%2Fgcc-interface%2Futils2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Futils2.c?ref=8ffac116df93baf38130a6a7de2d419b04dae660", "patch": "@@ -2135,17 +2135,9 @@ build_allocator (tree type, tree init, tree result_type, Entity_Id gnat_proc,\n \t\t\t\t\t  gnat_proc, gnat_pool, gnat_node);\n       storage = convert (storage_ptr_type, gnat_protect_expr (storage));\n \n-      if (TYPE_IS_PADDING_P (type))\n-\t{\n-\t  type = TREE_TYPE (TYPE_FIELDS (type));\n-\t  if (init)\n-\t    init = convert (type, init);\n-\t}\n-\n-      /* If there is an initializing expression, make a constructor for\n-\t the entire object including the bounds and copy it into the\n-\t object.  If there is no initializing expression, just set the\n-\t bounds.  */\n+      /* If there is an initializing expression, then make a constructor for\n+\t the entire object including the bounds and copy it into the object.\n+\t If there is no initializing expression, just set the bounds.  */\n       if (init)\n \t{\n \t  VEC(constructor_elt,gc) *v = VEC_alloc (constructor_elt, gc, 2);\n@@ -2154,7 +2146,6 @@ build_allocator (tree type, tree init, tree result_type, Entity_Id gnat_proc,\n \t\t\t\t  build_template (template_type, type, init));\n \t  CONSTRUCTOR_APPEND_ELT (v, DECL_CHAIN (TYPE_FIELDS (storage_type)),\n \t\t\t\t  init);\n-\n \t  return convert\n \t    (result_type,\n \t     build2 (COMPOUND_EXPR, storage_ptr_type,"}, {"sha": "dff95d8fdd3ea06d8f53d5660ce5d3344c0cd93c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8ffac116df93baf38130a6a7de2d419b04dae660", "patch": "@@ -1,3 +1,7 @@\n+2011-04-02  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/specs/aggr2.ads: New test.\n+\n 2011-04-02  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gnat.dg/debug2.ad[sb]: New test."}, {"sha": "8f7ea871733cc7fe4d3f9cc1d230bb8a92a7b579", "filename": "gcc/testsuite/gnat.dg/specs/aggr2.ads", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Faggr2.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8ffac116df93baf38130a6a7de2d419b04dae660/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Faggr2.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fspecs%2Faggr2.ads?ref=8ffac116df93baf38130a6a7de2d419b04dae660", "patch": "@@ -0,0 +1,14 @@\n+--  { dg-do compile }\n+\n+package Aggr2 is\n+\n+   type Buffer is array (Positive range <>) of Boolean;\n+   for Buffer'Alignment use 4;\n+\n+   type Buffer_Ptr is access Buffer;\n+\n+   subtype My_Buffer is Buffer (1 .. 2);\n+\n+   P : Buffer_Ptr := new My_Buffer'(Others => False);\n+\n+end Aggr2;"}]}