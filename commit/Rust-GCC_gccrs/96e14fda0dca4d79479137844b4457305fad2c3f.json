{"sha": "96e14fda0dca4d79479137844b4457305fad2c3f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTZlMTRmZGEwZGNhNGQ3OTQ3OTEzNzg0NGI0NDU3MzA1ZmFkMmMzZg==", "commit": {"author": {"name": "Peter Bergner", "email": "bergner@linux.ibm.com", "date": "2018-12-07T17:33:55Z"}, "committer": {"name": "Peter Bergner", "email": "bergner@gcc.gnu.org", "date": "2018-12-07T17:33:55Z"}, "message": "re PR target/87496 (ICE in aggregate_value_p at gcc/function.c:2046)\n\ngcc/\n\tPR target/87496\n\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Disallow\n\t-mabi=ieeelongdouble and -mabi=ibmlongdouble without -mlong-double-128.\n\tDo not error for -mabi=ibmlongdouble and no ISA 2.06 support.\n\t* doc/invoke.texi: Document -mabi=ibmlongdouble and -mabi=ieeelongdouble\n\trequire -mlong-double-128.\n\ngcc/testsuite/\n\tPR target/87496\n\t* gcc.target/powerpc/pr87496.c: Rename from this...\n\t* gcc.target/powerpc/pr87496-1.c: ...to this.  Update comment.\n\t* gcc.target/powerpc/pr87496-2.c: New test.\n\t* gcc.target/powerpc/pr87496-3.c: New test.\n\nFrom-SVN: r266899", "tree": {"sha": "600f036f88b46bb7e857bc7900c284751fc5037b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/600f036f88b46bb7e857bc7900c284751fc5037b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/96e14fda0dca4d79479137844b4457305fad2c3f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96e14fda0dca4d79479137844b4457305fad2c3f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/96e14fda0dca4d79479137844b4457305fad2c3f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96e14fda0dca4d79479137844b4457305fad2c3f/comments", "author": {"login": "peter-bergner", "id": 17504345, "node_id": "MDQ6VXNlcjE3NTA0MzQ1", "avatar_url": "https://avatars.githubusercontent.com/u/17504345?v=4", "gravatar_id": "", "url": "https://api.github.com/users/peter-bergner", "html_url": "https://github.com/peter-bergner", "followers_url": "https://api.github.com/users/peter-bergner/followers", "following_url": "https://api.github.com/users/peter-bergner/following{/other_user}", "gists_url": "https://api.github.com/users/peter-bergner/gists{/gist_id}", "starred_url": "https://api.github.com/users/peter-bergner/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/peter-bergner/subscriptions", "organizations_url": "https://api.github.com/users/peter-bergner/orgs", "repos_url": "https://api.github.com/users/peter-bergner/repos", "events_url": "https://api.github.com/users/peter-bergner/events{/privacy}", "received_events_url": "https://api.github.com/users/peter-bergner/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "886f092f59d8a903fb5b99e757df5e4523dae825", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/886f092f59d8a903fb5b99e757df5e4523dae825", "html_url": "https://github.com/Rust-GCC/gccrs/commit/886f092f59d8a903fb5b99e757df5e4523dae825"}], "stats": {"total": 58, "additions": 52, "deletions": 6}, "files": [{"sha": "f99d9ddbca2a5b3c89e7395c77e2c8f5cdc17752", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=96e14fda0dca4d79479137844b4457305fad2c3f", "patch": "@@ -1,3 +1,12 @@\n+2018-12-07  Peter Bergner  <bergner@linux.ibm.com>\n+\n+\tPR target/87496\n+\t* config/rs6000/rs6000.c (rs6000_option_override_internal): Disallow\n+\t-mabi=ieeelongdouble and -mabi=ibmlongdouble without -mlong-double-128.\n+\tDo not error for -mabi=ibmlongdouble and no ISA 2.06 support.\n+\t* doc/invoke.texi: Document -mabi=ibmlongdouble and -mabi=ieeelongdouble\n+\trequire -mlong-double-128.\n+\n 2018-12-07  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* config/aarch64/aarch64.c (aarch64_tuning_override_functions): Add"}, {"sha": "cd3fdd060afd1759e5629fd1eee0a99d9557f827", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=96e14fda0dca4d79479137844b4457305fad2c3f", "patch": "@@ -4282,6 +4282,13 @@ rs6000_option_override_internal (bool global_init_p)\n     }\n   else if (rs6000_long_double_type_size == 128)\n     rs6000_long_double_type_size = FLOAT_PRECISION_TFmode;\n+  else if (global_options_set.x_rs6000_ieeequad)\n+    {\n+      if (global_options.x_rs6000_ieeequad)\n+\terror (\"%qs requires %qs\", \"-mabi=ieeelongdouble\", \"-mlong-double-128\");\n+      else\n+\terror (\"%qs requires %qs\", \"-mabi=ibmlongdouble\", \"-mlong-double-128\");\n+    }\n \n   /* Set -mabi=ieeelongdouble on some old targets.  In the future, power server\n      systems will also set long double to be IEEE 128-bit.  AIX and Darwin\n@@ -4293,7 +4300,8 @@ rs6000_option_override_internal (bool global_init_p)\n \n   else\n     {\n-      if (!TARGET_POPCNTD || !TARGET_VSX)\n+      if (global_options.x_rs6000_ieeequad\n+\t  && (!TARGET_POPCNTD || !TARGET_VSX))\n \terror (\"%qs requires full ISA 2.06 support\", \"-mabi=ieeelongdouble\");\n \n       if (rs6000_ieeequad != TARGET_IEEEQUAD_DEFAULT && TARGET_LONG_DOUBLE_128)"}, {"sha": "dd262b60d88c8e1be8cc021848832fd2a04d5dc9", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=96e14fda0dca4d79479137844b4457305fad2c3f", "patch": "@@ -23932,15 +23932,17 @@ Change the current ABI to use IBM extended-precision long double.\n This is not likely to work if your system defaults to using IEEE\n extended-precision long double.  If you change the long double type\n from IEEE extended-precision, the compiler will issue a warning unless\n-you use the @option{-Wno-psabi} option.\n+you use the @option{-Wno-psabi} option.  Requires @option{-mlong-double-128}\n+to be enabled.\n \n @item -mabi=ieeelongdouble\n @opindex mabi=ieeelongdouble\n Change the current ABI to use IEEE extended-precision long double.\n This is not likely to work if your system defaults to using IBM\n extended-precision long double.  If you change the long double type\n from IBM extended-precision, the compiler will issue a warning unless\n-you use the @option{-Wno-psabi} option.\n+you use the @option{-Wno-psabi} option.  Requires @option{-mlong-double-128}\n+to be enabled.\n \n @item -mabi=elfv1\n @opindex mabi=elfv1\n@@ -25201,15 +25203,17 @@ Change the current ABI to use IBM extended-precision long double.\n This is not likely to work if your system defaults to using IEEE\n extended-precision long double.  If you change the long double type\n from IEEE extended-precision, the compiler will issue a warning unless\n-you use the @option{-Wno-psabi} option.\n+you use the @option{-Wno-psabi} option.  Requires @option{-mlong-double-128}\n+to be enabled.\n \n @item -mabi=ieeelongdouble\n @opindex mabi=ieeelongdouble\n Change the current ABI to use IEEE extended-precision long double.\n This is not likely to work if your system defaults to using IBM\n extended-precision long double.  If you change the long double type\n from IBM extended-precision, the compiler will issue a warning unless\n-you use the @option{-Wno-psabi} option.\n+you use the @option{-Wno-psabi} option.  Requires @option{-mlong-double-128}\n+to be enabled.\n \n @item -mabi=elfv1\n @opindex mabi=elfv1"}, {"sha": "58b0ef3f1c032636baaa659a3ada1a63f5b7d7d9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=96e14fda0dca4d79479137844b4457305fad2c3f", "patch": "@@ -1,3 +1,11 @@\n+2018-12-07  Peter Bergner  <bergner@linux.ibm.com>\n+\n+\tPR target/87496\n+\t* gcc.target/powerpc/pr87496.c: Rename from this...\n+\t* gcc.target/powerpc/pr87496-1.c: ...to this.  Update comment.\n+\t* gcc.target/powerpc/pr87496-2.c: New test.\n+\t* gcc.target/powerpc/pr87496-3.c: New test.\n+\n 2018-12-07  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* gcc.target/aarch64/sve/override_sve_width_1.c: New test."}, {"sha": "37ca8bb979a7441ddd4eaabdeb85ca68ffc36905", "filename": "gcc/testsuite/gcc.target/powerpc/pr87496-1.c", "status": "renamed", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-1.c?ref=96e14fda0dca4d79479137844b4457305fad2c3f", "patch": "@@ -1,4 +1,4 @@\n-/* PR target/87496.c */\n+/* PR target/87496 */\n /* { dg-do compile { target { powerpc*-*-* && lp64 } } } */\n /* { dg-skip-if \"\" { powerpc*-*-darwin* } } */\n /* { dg-skip-if \"do not override -mcpu\" { powerpc*-*-* } { \"-mcpu=*\" } { \"-mcpu=power7\" } } */", "previous_filename": "gcc/testsuite/gcc.target/powerpc/pr87496.c"}, {"sha": "032c9549e4ab3947d12598e8e99f0ea6fb6f8c17", "filename": "gcc/testsuite/gcc.target/powerpc/pr87496-2.c", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-2.c?ref=96e14fda0dca4d79479137844b4457305fad2c3f", "patch": "@@ -0,0 +1,9 @@\n+/* PR target/87496 */\n+/* { dg-do compile { target { powerpc*-*-* } } } */\n+/* { dg-skip-if \"\" { powerpc*-*-darwin* } } */\n+/* { dg-skip-if \"do not override -mcpu\" { powerpc*-*-* } { \"-mcpu=*\" } { \"-mcpu=power7\" } } */\n+/* { dg-options \"-O2 -mcpu=power7 -mabi=ieeelongdouble -mlong-double-64 -Wno-psabi\" } */\n+\n+int i;\n+\n+/* { dg-error \"'-mabi=ieeelongdouble' requires '-mlong-double-128'\" \"PR87496\" { target *-*-* } 0 } */"}, {"sha": "1be39975f64ab1b3ccb1ec5a697fe5fe9d4541a4", "filename": "gcc/testsuite/gcc.target/powerpc/pr87496-3.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/96e14fda0dca4d79479137844b4457305fad2c3f/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fpowerpc%2Fpr87496-3.c?ref=96e14fda0dca4d79479137844b4457305fad2c3f", "patch": "@@ -0,0 +1,8 @@\n+/* PR target/87496 */\n+/* { dg-do compile { target { powerpc*-*-* } } } */\n+/* { dg-skip-if \"\" { powerpc*-*-darwin* } } */\n+/* { dg-options \"-O2 -mabi=ibmlongdouble -mlong-double-64 -Wno-psabi\" } */\n+\n+int i;\n+\n+/* { dg-error \"'-mabi=ibmlongdouble' requires '-mlong-double-128'\" \"PR87496\" { target *-*-* } 0 } */"}]}