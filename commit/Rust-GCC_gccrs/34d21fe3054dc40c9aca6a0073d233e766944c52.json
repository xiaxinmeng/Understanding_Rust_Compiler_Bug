{"sha": "34d21fe3054dc40c9aca6a0073d233e766944c52", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzRkMjFmZTMwNTRkYzQwYzlhY2E2YTAwNzNkMjMzZTc2Njk0NGM1Mg==", "commit": {"author": {"name": "Richard Kenner", "email": "kenner@vlsi1.ultra.nyu.edu", "date": "2003-04-18T22:39:23Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2003-04-18T22:39:23Z"}, "message": "function.c (purge_addressof_1): For ADDRESSOF...\n\n\t* function.c (purge_addressof_1): For ADDRESSOF, see if SUB is a\n\thard or virtual register and copy into pseudo if replacement fails.\n\nFrom-SVN: r65798", "tree": {"sha": "b8a2291cd0a9b39efe82cabad278ef627235fda0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8a2291cd0a9b39efe82cabad278ef627235fda0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34d21fe3054dc40c9aca6a0073d233e766944c52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34d21fe3054dc40c9aca6a0073d233e766944c52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34d21fe3054dc40c9aca6a0073d233e766944c52", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34d21fe3054dc40c9aca6a0073d233e766944c52/comments", "author": null, "committer": null, "parents": [{"sha": "dd4ff203fa1c9f63d013a3770789cb568e3b8253", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd4ff203fa1c9f63d013a3770789cb568e3b8253", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd4ff203fa1c9f63d013a3770789cb568e3b8253"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "a4681a711150769dd24867d882d758f2860cfb14", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34d21fe3054dc40c9aca6a0073d233e766944c52/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34d21fe3054dc40c9aca6a0073d233e766944c52/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=34d21fe3054dc40c9aca6a0073d233e766944c52", "patch": "@@ -1,6 +1,9 @@\n 2003-04-18  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n-\t* cfgcleanup.c (flow_find_cross_jump): Use INSN_P,not active_insn_p.\n+\t* function.c (purge_addressof_1): For ADDRESSOF, see if SUB is a\n+\thard or virtual register and copy into pseudo if replacement fails.\n+\n+\t* cfgcleanup.c (flow_find_cross_jump): Use INSN_P, not active_insn_p.\n \n \t* expmed.c (mask_rtx): Avoid undefined shifts for BITSIZE of 0.\n "}, {"sha": "b75a07e15a6f8c4453a5ad366c06c4c6edd73a7b", "filename": "gcc/function.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34d21fe3054dc40c9aca6a0073d233e766944c52/gcc%2Ffunction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34d21fe3054dc40c9aca6a0073d233e766944c52/gcc%2Ffunction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffunction.c?ref=34d21fe3054dc40c9aca6a0073d233e766944c52", "patch": "@@ -3052,7 +3052,15 @@ purge_addressof_1 (loc, insn, force, store, may_postpone, ht)\n \treturn true;\n \n       start_sequence ();\n-      sub = force_operand (sub, NULL_RTX);\n+\n+      /* If SUB is a or virtual register, try it as a pseudo-register. \n+\t Otherwise, perhaps SUB is an expression, so generate code to compute\n+\t it.  */\n+      if (GET_CODE (sub) == REG && REGNO (sub) <= LAST_VIRTUAL_REGISTER)\n+\tsub = copy_to_reg (sub);\n+      else\n+\tsub = force_operand (sub, NULL_RTX);\n+\n       if (! validate_change (insn, loc, sub, 0)\n \t  && ! validate_replace_rtx (x, sub, insn))\n \tabort ();"}]}