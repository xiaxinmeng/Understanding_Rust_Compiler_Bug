{"sha": "56b5d3b48bce83cd429befde35933f5105df21e2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTZiNWQzYjQ4YmNlODNjZDQyOWJlZmRlMzU5MzNmNTEwNWRmMjFlMg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-08-15T00:15:12Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-08-15T00:15:12Z"}, "message": "re PR libstdc++/58163 ([C++11] Pedantic assert on str[str.size()] is wrong in C++11)\n\n2013-08-14  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR libstdc++/58163\n\t* include/bits/basic_string.h (basic_string<>::operator[]): Fix\n\t_GLIBCXX_DEBUG_PEDASSERT check vs C++11.\n\t* include/ext/vstring.h: Likewise.\n\t* testsuite/21_strings/basic_string/element_access/char/58163.cc:\n\tNew.\n\t* testsuite/21_strings/basic_string/element_access/wchar_t/58163.cc:\n\tLikewise.\n\t* testsuite/ext/vstring/element_access/char/58163.cc: Likewise.\n\t* testsuite/ext/vstring/element_access/wchar_t/58163.cc: Likewise.\n\nFrom-SVN: r201755", "tree": {"sha": "00fc9c8d2a7b382b142a966c9bce9fcdbaef0e0f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/00fc9c8d2a7b382b142a966c9bce9fcdbaef0e0f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/56b5d3b48bce83cd429befde35933f5105df21e2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56b5d3b48bce83cd429befde35933f5105df21e2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56b5d3b48bce83cd429befde35933f5105df21e2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56b5d3b48bce83cd429befde35933f5105df21e2/comments", "author": null, "committer": null, "parents": [{"sha": "715a572a8a19d90b8dc02601adbae32a1a78652d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/715a572a8a19d90b8dc02601adbae32a1a78652d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/715a572a8a19d90b8dc02601adbae32a1a78652d"}], "stats": {"total": 186, "additions": 180, "deletions": 6}, "files": [{"sha": "8fea147546827202b31e821a32fc2530d5e42194", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=56b5d3b48bce83cd429befde35933f5105df21e2", "patch": "@@ -1,3 +1,16 @@\n+2013-08-14  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR libstdc++/58163\n+\t* include/bits/basic_string.h (basic_string<>::operator[]): Fix\n+\t_GLIBCXX_DEBUG_PEDASSERT check vs C++11.\n+\t* include/ext/vstring.h: Likewise.\n+\t* testsuite/21_strings/basic_string/element_access/char/58163.cc:\n+\tNew.\n+\t* testsuite/21_strings/basic_string/element_access/wchar_t/58163.cc:\n+\tLikewise.\n+\t* testsuite/ext/vstring/element_access/char/58163.cc: Likewise.\n+\t* testsuite/ext/vstring/element_access/wchar_t/58163.cc: Likewise.\n+\n 2013-08-14  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* src/c++98/compatibility.cc (_ZTIe): Use"}, {"sha": "c8723ededd9a9242a545961173eeb8a0617448b9", "filename": "libstdc++-v3/include/bits/basic_string.h", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fbits%2Fbasic_string.h?ref=56b5d3b48bce83cd429befde35933f5105df21e2", "patch": "@@ -842,10 +842,11 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       reference\n       operator[](size_type __pos)\n       {\n-        // allow pos == size() as v3 extension:\n+        // Allow pos == size() both in C++98 mode, as v3 extension,\n+\t// and in C++11 mode.\n \t_GLIBCXX_DEBUG_ASSERT(__pos <= size());\n-        // but be strict in pedantic mode:\n-\t_GLIBCXX_DEBUG_PEDASSERT(__pos < size());\n+        // In pedantic mode be strict in C++98 mode.\n+\t_GLIBCXX_DEBUG_PEDASSERT(__cplusplus >= 201103L || __pos < size());\n \t_M_leak();\n \treturn _M_data()[__pos];\n       }"}, {"sha": "85322130cf9146a53b12935783aca9c6d71a8f42", "filename": "libstdc++-v3/include/ext/vstring.h", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Finclude%2Fext%2Fvstring.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Finclude%2Fext%2Fvstring.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fext%2Fvstring.h?ref=56b5d3b48bce83cd429befde35933f5105df21e2", "patch": "@@ -557,10 +557,12 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n       reference\n       operator[](size_type __pos)\n       {\n-        // allow pos == size() as v3 extension:\n+        // Allow pos == size() both in C++98 mode, as v3 extension,\n+\t// and in C++11 mode.\n \t_GLIBCXX_DEBUG_ASSERT(__pos <= this->size());\n-        // but be strict in pedantic mode:\n-\t_GLIBCXX_DEBUG_PEDASSERT(__pos < this->size());\n+        // In pedantic mode be strict in C++98 mode.\n+\t_GLIBCXX_DEBUG_PEDASSERT(__cplusplus >= 201103L\n+\t\t\t\t || __pos < this->size());\n \tthis->_M_leak();\n \treturn this->_M_data()[__pos];\n       }"}, {"sha": "ea42027960bd7f401ee85e0854dc285b293b941e", "filename": "libstdc++-v3/testsuite/21_strings/basic_string/element_access/char/58163.cc", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Felement_access%2Fchar%2F58163.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Felement_access%2Fchar%2F58163.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Felement_access%2Fchar%2F58163.cc?ref=56b5d3b48bce83cd429befde35933f5105df21e2", "patch": "@@ -0,0 +1,39 @@\n+// Copyright (C) 2013 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-std=gnu++11 -D_GLIBCXX_DEBUG_PEDANTIC\" }\n+\n+#include <string>\n+#include <testsuite_hooks.h>\n+\n+// PR c++/58163\n+void test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  const std::string cs;\n+        std::string  s;\n+\n+  VERIFY( cs[0] == '\\0' );\n+  VERIFY(  s[0] == '\\0' );\n+}\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}, {"sha": "a52390810e3f3580fe1e18262a345ed653551aa6", "filename": "libstdc++-v3/testsuite/21_strings/basic_string/element_access/wchar_t/58163.cc", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Felement_access%2Fwchar_t%2F58163.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Felement_access%2Fwchar_t%2F58163.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2F21_strings%2Fbasic_string%2Felement_access%2Fwchar_t%2F58163.cc?ref=56b5d3b48bce83cd429befde35933f5105df21e2", "patch": "@@ -0,0 +1,39 @@\n+// Copyright (C) 2013 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-std=gnu++11 -D_GLIBCXX_DEBUG_PEDANTIC\" }\n+\n+#include <string>\n+#include <testsuite_hooks.h>\n+\n+// PR c++/58163\n+void test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  const std::wstring cs;\n+        std::wstring  s;\n+\n+  VERIFY( cs[0] == L'\\0' );\n+  VERIFY(  s[0] == L'\\0' );\n+}\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}, {"sha": "cd58be56378c163b32903c0c47f1f7fb0d6e10ee", "filename": "libstdc++-v3/testsuite/ext/vstring/element_access/char/58163.cc", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Felement_access%2Fchar%2F58163.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Felement_access%2Fchar%2F58163.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Felement_access%2Fchar%2F58163.cc?ref=56b5d3b48bce83cd429befde35933f5105df21e2", "patch": "@@ -0,0 +1,40 @@\n+// Copyright (C) 2013 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-std=gnu++11 -D_GLIBCXX_DEBUG_PEDANTIC\" }\n+// { dg-require-string-conversions \"\" }\n+\n+#include <ext/vstring.h>\n+#include <testsuite_hooks.h>\n+\n+// PR c++/58163\n+void test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  const __gnu_cxx::__vstring cs;\n+        __gnu_cxx::__vstring  s;\n+\n+  VERIFY( cs[0] == '\\0' );\n+  VERIFY(  s[0] == '\\0' );\n+}\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}, {"sha": "29ca38eea97a0e78e51d7b212170f2cbf8d886ae", "filename": "libstdc++-v3/testsuite/ext/vstring/element_access/wchar_t/58163.cc", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Felement_access%2Fwchar_t%2F58163.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/56b5d3b48bce83cd429befde35933f5105df21e2/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Felement_access%2Fwchar_t%2F58163.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fext%2Fvstring%2Felement_access%2Fwchar_t%2F58163.cc?ref=56b5d3b48bce83cd429befde35933f5105df21e2", "patch": "@@ -0,0 +1,40 @@\n+// Copyright (C) 2013 Free Software Foundation, Inc.\n+//\n+// This file is part of the GNU ISO C++ Library.  This library is free\n+// software; you can redistribute it and/or modify it under the\n+// terms of the GNU General Public License as published by the\n+// Free Software Foundation; either version 3, or (at your option)\n+// any later version.\n+//\n+// This library is distributed in the hope that it will be useful,\n+// but WITHOUT ANY WARRANTY; without even the implied warranty of\n+// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n+// GNU General Public License for more details.\n+//\n+// You should have received a copy of the GNU General Public License along\n+// with this library; see the file COPYING3.  If not see\n+// <http://www.gnu.org/licenses/>.\n+\n+// { dg-options \"-std=gnu++11 -D_GLIBCXX_DEBUG_PEDANTIC\" }\n+// { dg-require-string-conversions \"\" }\n+\n+#include <ext/vstring.h>\n+#include <testsuite_hooks.h>\n+\n+// PR c++/58163\n+void test01()\n+{\n+  bool test __attribute__((unused)) = true;\n+\n+  const __gnu_cxx::__wvstring cs;\n+        __gnu_cxx::__wvstring  s;\n+\n+  VERIFY( cs[0] == L'\\0' );\n+  VERIFY(  s[0] == L'\\0' );\n+}\n+\n+int main()\n+{\n+  test01();\n+  return 0;\n+}"}]}