{"sha": "6cedf92249d5a183471723129c3d436fde95b0a0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmNlZGY5MjI0OWQ1YTE4MzQ3MTcyMzEyOWMzZDQzNmZkZTk1YjBhMA==", "commit": {"author": {"name": "Ilya Enkovich", "email": "enkovich.gnu@gmail.com", "date": "2016-03-22T12:31:12Z"}, "committer": {"name": "Ilya Enkovich", "email": "ienkovich@gcc.gnu.org", "date": "2016-03-22T12:31:12Z"}, "message": "re PR target/70290 (-mavx512vl breaks parsing of C++ vector condition)\n\ngcc/cp/\n\n\tPR target/70290\n\t* call.c (build_conditional_expr_1): Always use original\n\tcondition type for vector type checks and build.\n\ngcc/testsuite/\n\n\tPR target/70290\n\t* g++.dg/ext/pr70290.C: New test.\n\nFrom-SVN: r234399", "tree": {"sha": "25ecd0ecfaf535603f0e23b2a375dbf54294138c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/25ecd0ecfaf535603f0e23b2a375dbf54294138c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6cedf92249d5a183471723129c3d436fde95b0a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6cedf92249d5a183471723129c3d436fde95b0a0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6cedf92249d5a183471723129c3d436fde95b0a0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6cedf92249d5a183471723129c3d436fde95b0a0/comments", "author": null, "committer": null, "parents": [{"sha": "7d36fe985ca74f7f0d26be60d0bd1bf9d3b2c35a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7d36fe985ca74f7f0d26be60d0bd1bf9d3b2c35a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7d36fe985ca74f7f0d26be60d0bd1bf9d3b2c35a"}], "stats": {"total": 30, "additions": 29, "deletions": 1}, "files": [{"sha": "6557f9096352284e9f2c96e2386216aaa5a46af7", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=6cedf92249d5a183471723129c3d436fde95b0a0", "patch": "@@ -1,3 +1,8 @@\n+2016-03-22  Ilya Enkovich  <enkovich.gnu@gmail.com>\n+\n+\t* call.c (build_conditional_expr_1): Always use original\n+\tcondition type for vector type checks and build.\n+\n 2016-03-22  Patrick Palka  <ppalka@gcc.gnu.org>\n \n \tPR c++/70096"}, {"sha": "ed234904a63de40d13e0a087f0929ca60c1b3dc9", "filename": "gcc/cp/call.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=6cedf92249d5a183471723129c3d436fde95b0a0", "patch": "@@ -4634,6 +4634,8 @@ build_conditional_expr_1 (location_t loc, tree arg1, tree arg2, tree arg3,\n \n   if (VECTOR_INTEGER_TYPE_P (TREE_TYPE (arg1)))\n     {\n+      tree arg1_type = TREE_TYPE (arg1);\n+\n       /* If arg1 is another cond_expr choosing between -1 and 0,\n \t then we can use its comparison.  It may help to avoid\n \t additional comparison, produce more accurate diagnostics\n@@ -4653,7 +4655,6 @@ build_conditional_expr_1 (location_t loc, tree arg1, tree arg2, tree arg3,\n \t  || error_operand_p (arg3))\n \treturn error_mark_node;\n \n-      tree arg1_type = TREE_TYPE (arg1);\n       arg2_type = TREE_TYPE (arg2);\n       arg3_type = TREE_TYPE (arg3);\n "}, {"sha": "49f9e080c84eef9cadeab3443800904917a78a94", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6cedf92249d5a183471723129c3d436fde95b0a0", "patch": "@@ -1,3 +1,7 @@\n+2016-03-22  Ilya Enkovich  <enkovich.gnu@gmail.com>\n+\n+\t* g++.dg/ext/pr70290.C: New test.\n+\n 2016-03-22  Kirill Yukhin  <kirill.yukhin@intel.com>\n \n \tPR target/70325"}, {"sha": "6de13ce8390118e8d618fc062a647d95e5d059a3", "filename": "gcc/testsuite/g++.dg/ext/pr70290.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fpr70290.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6cedf92249d5a183471723129c3d436fde95b0a0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fpr70290.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fpr70290.C?ref=6cedf92249d5a183471723129c3d436fde95b0a0", "patch": "@@ -0,0 +1,18 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-mavx512vl\" { target { i?86-*-* x86_64-*-* } } } */\n+\n+typedef int vec __attribute__((vector_size(32)));\n+\n+vec\n+test1 (vec x,vec y)\n+{\n+  return (x < y) ? 1 : 0;\n+}\n+\n+vec\n+test2 (vec x,vec y)\n+{\n+  vec zero = { };\n+  vec one = zero + 1;\n+  return (x < y) ? one : zero;\n+}"}]}