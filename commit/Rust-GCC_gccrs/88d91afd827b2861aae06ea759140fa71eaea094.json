{"sha": "88d91afd827b2861aae06ea759140fa71eaea094", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODhkOTFhZmQ4MjdiMjg2MWFhZTA2ZWE3NTkxNDBmYTcxZWFlYTA5NA==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2015-06-08T08:57:50Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2015-06-08T08:57:50Z"}, "message": "Don't dump low gimple functions in gimple dump\n\n2015-06-08  Tom de Vries  <tom@codesourcery.com>\n\n\tPR tree-optimization/66436\n\t* cgraphunit.c (cgraph_node::analyze): Don't dump function to gimple\n\tdump file.\n\t* gimplify.c: Add tree-dump.h include.\n\t(gimplify_function_tree): Dump function to gimple dump file.\n\t* stor-layout.c (finalize_size_functions): Don't dump function to gimple\n\tdump file.\n\n\t* gcc.dg/gomp/dump-new-function-2.c: New test.\n\t* gcc.dg/gomp/dump-new-function-3.c: Same.\n\t* gcc.dg/gomp/dump-new-function.c: Same.\n\nFrom-SVN: r224210", "tree": {"sha": "269318fd2635157cff1bc621d3c3afc0f579cbaa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/269318fd2635157cff1bc621d3c3afc0f579cbaa"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88d91afd827b2861aae06ea759140fa71eaea094", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88d91afd827b2861aae06ea759140fa71eaea094", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88d91afd827b2861aae06ea759140fa71eaea094", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88d91afd827b2861aae06ea759140fa71eaea094/comments", "author": null, "committer": null, "parents": [{"sha": "9452ef0663208d3908cbec66f1521b1f9e82d14a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9452ef0663208d3908cbec66f1521b1f9e82d14a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9452ef0663208d3908cbec66f1521b1f9e82d14a"}], "stats": {"total": 71, "additions": 69, "deletions": 2}, "files": [{"sha": "a6d3a1ee24ddf25c30337aa2a05ca74c0db41802", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -1,3 +1,13 @@\n+2015-06-08  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR tree-optimization/66436\n+\t* cgraphunit.c (cgraph_node::analyze): Don't dump function to gimple\n+\tdump file.\n+\t* gimplify.c: Add tree-dump.h include.\n+\t(gimplify_function_tree): Dump function to gimple dump file.\n+\t* stor-layout.c (finalize_size_functions): Don't dump function to gimple\n+\tdump file.\n+\n 2015-06-08  Tom de Vries  <tom@codesourcery.com>\n \n \tPR tree-optimization/66435"}, {"sha": "c1da9880d73cd4b45909ff0f84f1a1d5a5fda903", "filename": "gcc/cgraphunit.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Fcgraphunit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Fcgraphunit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcgraphunit.c?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -652,7 +652,6 @@ cgraph_node::analyze (void)\n \t body.  */\n       if (!gimple_has_body_p (decl))\n \tgimplify_function_tree (decl);\n-      dump_function (TDI_generic, decl);\n \n       /* Lower the function.  */\n       if (!lowered)"}, {"sha": "6d4618afee4e82547c3a4575cacace2f102c416e", "filename": "gcc/gimplify.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -82,6 +82,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"gimple-low.h\"\n #include \"cilk.h\"\n #include \"gomp-constants.h\"\n+#include \"tree-dump.h\"\n \n #include \"langhooks-def.h\"\t/* FIXME: for lhd_set_decl_assembler_name */\n #include \"tree-pass.h\"\t\t/* FIXME: only for PROP_gimple_any */\n@@ -9444,6 +9445,8 @@ gimplify_function_tree (tree fndecl)\n   cfun->curr_properties |= PROP_gimple_any;\n \n   pop_cfun ();\n+\n+  dump_function (TDI_generic, fndecl);\n }\n \n /* Return a dummy expression of type TYPE in order to keep going after an"}, {"sha": "09b95a4c2c3d25bc4a2d9cd298d4ecc43a82548f", "filename": "gcc/stor-layout.c", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Fstor-layout.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Fstor-layout.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fstor-layout.c?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -316,7 +316,6 @@ finalize_size_functions (void)\n       set_cfun (NULL);\n       dump_function (TDI_original, fndecl);\n       gimplify_function_tree (fndecl);\n-      dump_function (TDI_generic, fndecl);\n       cgraph_node::finalize_function (fndecl, false);\n     }\n "}, {"sha": "3231e7db46352b921fb2888dbbabdec5c1a0c4e5", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -1,3 +1,10 @@\n+2015-06-08  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR tree-optimization/66436\n+\t* gcc.dg/gomp/dump-new-function-2.c: New test.\n+\t* gcc.dg/gomp/dump-new-function-3.c: Same.\n+\t* gcc.dg/gomp/dump-new-function.c: Same.\n+\n 2015-06-08  Tom de Vries  <tom@codesourcery.com>\n \n \tPR tree-optimization/66435"}, {"sha": "627d0676ce3336ff846a2b9d509f48d0916a5487", "filename": "gcc/testsuite/gcc.dg/gomp/dump-new-function-2.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function-2.c?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fopenmp -fdump-tree-gimple\" } */\n+\n+void __attribute__((noinline))\n+baz (int *p)\n+{\n+}\n+\n+void\n+foo (void)\n+{\n+  int p[2];\n+  p[0] = 1;\n+  p[1] = 3;\n+  #pragma omp task firstprivate (p)\n+    baz (p);\n+}\n+\n+/* Check that new function does not end up in gimple dump.  */\n+/* { dg-final { scan-tree-dump-not \"foo\\\\._omp_cpyfn\\\\.1 \\\\(struct\" \"gimple\" } } */"}, {"sha": "1854179eded0f90d6dfaadef7fade51ebf2f400d", "filename": "gcc/testsuite/gcc.dg/gomp/dump-new-function-3.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function-3.c?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -0,0 +1,13 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -ftree-parallelize-loops=2 -fdump-tree-gimple\" } */\n+\n+void\n+foo (int *__restrict a, int *__restrict b, int *__restrict c)\n+{\n+  int i;\n+  for (i = 0; i < 1000; ++i)\n+    c[i] = a[i] + b[i];\n+}\n+\n+/* Check that new function does not end up in gimple dump.  */\n+/* { dg-final { scan-tree-dump-not \"foo\\\\._loopfn\\\\.0\" \"gimple\" } } */"}, {"sha": "2814260cf37e21691cac77d56a6f3d9a236b414d", "filename": "gcc/testsuite/gcc.dg/gomp/dump-new-function.c", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88d91afd827b2861aae06ea759140fa71eaea094/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fdump-new-function.c?ref=88d91afd827b2861aae06ea759140fa71eaea094", "patch": "@@ -0,0 +1,16 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fopenmp -fdump-tree-gimple\" } */\n+\n+int\n+main (void)\n+{\n+#pragma omp parallel\n+  {\n+    extern void foo (void);\n+    foo ();\n+  }\n+  return 0;\n+}\n+\n+/* Check that new function does not end up in gimple dump.  */\n+/* { dg-final { scan-tree-dump-not \"main\\\\._omp_fn\\\\.0\" \"gimple\" } } */"}]}