{"sha": "155b14a87e5f8fbb3d6f63a69f521d92a4b40347", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTU1YjE0YTg3ZTVmOGZiYjNkNmY2M2E2OWY1MjFkOTJhNGI0MDM0Nw==", "commit": {"author": {"name": "Denis Chertykov", "email": "denisc@gcc.gnu.org", "date": "2000-09-20T18:01:20Z"}, "committer": {"name": "Denis Chertykov", "email": "denisc@gcc.gnu.org", "date": "2000-09-20T18:01:20Z"}, "message": "avr.c (adjust_insn_length): Adjust lengths of `reload_in*' insns.\n\n\t* config/avr/avr.c (adjust_insn_length): Adjust lengths of\n\t`reload_in*' insns.\n\n\t* config/avr/avr.md (neghi2): Add alternative for input and output\n\toperands in different registers, as in negsi2.\n\t(*negsi2): Remove '*' from the name.  Use \"movw\" if available.\n\nFrom-SVN: r36552", "tree": {"sha": "fc9f09cbd256d265daaafdbe9e067920d0aa4037", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc9f09cbd256d265daaafdbe9e067920d0aa4037"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/155b14a87e5f8fbb3d6f63a69f521d92a4b40347", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/155b14a87e5f8fbb3d6f63a69f521d92a4b40347", "html_url": "https://github.com/Rust-GCC/gccrs/commit/155b14a87e5f8fbb3d6f63a69f521d92a4b40347", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/155b14a87e5f8fbb3d6f63a69f521d92a4b40347/comments", "author": null, "committer": null, "parents": [{"sha": "0370fea18d5dd67baf054f40772ef848aa6bfb42", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0370fea18d5dd67baf054f40772ef848aa6bfb42", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0370fea18d5dd67baf054f40772ef848aa6bfb42"}], "stats": {"total": 61, "additions": 52, "deletions": 9}, "files": [{"sha": "b4b3480732c0c5fd7b02eac08cc006612d29cdf5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/155b14a87e5f8fbb3d6f63a69f521d92a4b40347/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/155b14a87e5f8fbb3d6f63a69f521d92a4b40347/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=155b14a87e5f8fbb3d6f63a69f521d92a4b40347", "patch": "@@ -1,3 +1,14 @@\n+Wed Sep 20 21:44:31 2000  Denis Chertykov  <denisc@overta.ru>\n+\n+\t* config/avr/avr.c (adjust_insn_length): Adjust lengths of\n+\t`reload_in*' insns.\n+\n+2000-09-19  Marek Michalkiewicz  <marekm@linux.org.pl>\n+\n+\t* config/avr/avr.md (neghi2): Add alternative for input and output\n+\toperands in different registers, as in negsi2.\n+\t(*negsi2): Remove '*' from the name.  Use \"movw\" if available.\n+\n 2000-09-19  Jim Wilson  <wilson@cygnus.com>\n \n \t* config/ia64/crtbegin.asm (__dso_handle): Delete use of"}, {"sha": "baeed017952739f71e49e3551e4fbdcd2cc57fda", "filename": "gcc/config/avr/avr.c", "status": "modified", "additions": 27, "deletions": 1, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/155b14a87e5f8fbb3d6f63a69f521d92a4b40347/gcc%2Fconfig%2Favr%2Favr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/155b14a87e5f8fbb3d6f63a69f521d92a4b40347/gcc%2Fconfig%2Favr%2Favr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.c?ref=155b14a87e5f8fbb3d6f63a69f521d92a4b40347", "patch": "@@ -3509,6 +3509,7 @@ adjust_insn_length (insn, len)\n {\n   rtx patt = PATTERN (insn);\n   rtx set;\n+\n   if (GET_CODE (patt) == SET)\n     {\n       rtx op[10];\n@@ -3577,9 +3578,34 @@ adjust_insn_length (insn, len)\n   if (set)\n     {\n       rtx op[10];\n+\n       op[1] = SET_SRC (set);\n       op[0] = SET_DEST (set);\n-      if (GET_CODE (op[1]) == ASHIFT\n+\n+      if (GET_CODE (patt) == PARALLEL\n+\t  && general_operand (op[1], VOIDmode)\n+\t  && general_operand (op[0], VOIDmode))\n+\t{\n+\t  if (XVECLEN (patt, 0) == 2)\n+\t    op[2] = XVECEXP (patt, 0, 1);\n+\n+\t  switch (GET_MODE (op[0]))\n+\t    {\n+\t    case QImode:\n+\t      len = 2;\n+\t      break;\n+\t    case HImode:\n+\t      output_reload_inhi (insn, op, &len);\n+\t      break;\n+\t    case SImode:\n+\t    case SFmode:\n+\t      output_reload_insisf (insn, op, &len);\n+\t      break;\n+\t    default:\n+\t      break;\n+\t    }\n+\t}\n+      else if (GET_CODE (op[1]) == ASHIFT\n \t  || GET_CODE (op[1]) == ASHIFTRT\n \t  || GET_CODE (op[1]) == LSHIFTRT)\n \t{"}, {"sha": "98694a37397f86f8e797634935b7887c2e59f1ff", "filename": "gcc/config/avr/avr.md", "status": "modified", "additions": 14, "deletions": 8, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/155b14a87e5f8fbb3d6f63a69f521d92a4b40347/gcc%2Fconfig%2Favr%2Favr.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/155b14a87e5f8fbb3d6f63a69f521d92a4b40347/gcc%2Fconfig%2Favr%2Favr.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.md?ref=155b14a87e5f8fbb3d6f63a69f521d92a4b40347", "patch": "@@ -1006,24 +1006,30 @@\n    (set_attr \"cc\" \"set_zn\")])\n \n (define_insn \"neghi2\"\n-  [(set (match_operand:HI 0 \"register_operand\" \"=!d,r\")\n-\t(neg:HI (match_operand:HI 1 \"register_operand\" \"0,0\")))]\n+  [(set (match_operand:HI 0 \"register_operand\"       \"=!d,r,&r\")\n+\t(neg:HI (match_operand:HI 1 \"register_operand\" \"0,0,r\")))]\n   \"\"\n   \"@\n \tcom %B0\\;neg %A0\\;sbci %B0,lo8(-1)\n-\tcom %B0\\;neg %A0\\;sbc %B0,__zero_reg__\\;inc %B0\"\n-  [(set_attr \"length\" \"3,4\")\n-   (set_attr \"cc\" \"set_czn,set_n\")])\n+\tcom %B0\\;neg %A0\\;sbc %B0,__zero_reg__\\;inc %B0\n+\tclr %A0\\;clr %B0\\;sub %A0,%A1\\;sbc %B0,%B1\"\n+  [(set_attr \"length\" \"3,4,4\")\n+   (set_attr \"cc\" \"set_czn,set_n,set_czn\")])\n \n-(define_insn \"*negsi2\"\n+(define_insn \"negsi2\"\n   [(set (match_operand:SI 0 \"register_operand\"       \"=!d,r,&r\")\n \t(neg:SI (match_operand:SI 1 \"register_operand\" \"0,0,r\")))]\n   \"\"\n   \"@\n \tcom %D0\\;com %C0\\;com %B0\\;neg %A0\\;sbci %B0,lo8(-1)\\;sbci %C0,lo8(-1)\\;sbci %D0,lo8(-1)\n \tcom %D0\\;com %C0\\;com %B0\\;com %A0\\;adc %A0,__zero_reg__\\;adc %B0,__zero_reg__\\;adc %C0,__zero_reg__\\;adc %D0,__zero_reg__\n-\tclr %A0\\;clr %B0\\;clr %C0\\;clr %D0\\;sub %A0,%A1\\;sbc %B0,%B1\\;sbc %C0,%C1\\;sbc %D0,%D1\"\n-  [(set_attr \"length\" \"7,8,8\")\n+\tclr %A0\\;clr %B0\\;{clr %C0\\;clr %D0|movw %C0,%A0}\\;sub %A0,%A1\\;sbc %B0,%B1\\;sbc %C0,%C1\\;sbc %D0,%D1\"\n+  [(set_attr_alternative \"length\"\n+\t\t\t [(const_int 7)\n+\t\t\t  (const_int 8)\n+\t\t\t  (if_then_else (eq_attr \"mcu_enhanced\" \"yes\")\n+\t\t\t\t\t(const_int 7)\n+\t\t\t\t\t(const_int 8))])\n    (set_attr \"cc\" \"set_czn,set_n,set_czn\")])\n \n (define_insn \"negsf2\""}]}