{"sha": "ed481942e3c90b596b22b5001010a87a505829d5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWQ0ODE5NDJlM2M5MGI1OTZiMjJiNTAwMTAxMGE4N2E1MDU4MjlkNQ==", "commit": {"author": {"name": "Doug Gilmore", "email": "doug.gilmore@imgtec.com", "date": "2016-09-23T15:48:01Z"}, "committer": {"name": "Matthew Fortune", "email": "mpf@gcc.gnu.org", "date": "2016-09-23T15:48:01Z"}, "message": "Ensure points-to information is maintained for prefetch.\n\ngcc/\n        PR tree-optimization/77654\n        * tree-ssa-alias.c (issue_prefetch_ref): Add call\n        to duplicate_ssa_name_ptr_info.\n\nFrom-SVN: r240439", "tree": {"sha": "41b7dc7c48c0ed95a1bd38260399aefda4978939", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/41b7dc7c48c0ed95a1bd38260399aefda4978939"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ed481942e3c90b596b22b5001010a87a505829d5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed481942e3c90b596b22b5001010a87a505829d5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ed481942e3c90b596b22b5001010a87a505829d5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ed481942e3c90b596b22b5001010a87a505829d5/comments", "author": {"login": "douggilmore", "id": 10520494, "node_id": "MDQ6VXNlcjEwNTIwNDk0", "avatar_url": "https://avatars.githubusercontent.com/u/10520494?v=4", "gravatar_id": "", "url": "https://api.github.com/users/douggilmore", "html_url": "https://github.com/douggilmore", "followers_url": "https://api.github.com/users/douggilmore/followers", "following_url": "https://api.github.com/users/douggilmore/following{/other_user}", "gists_url": "https://api.github.com/users/douggilmore/gists{/gist_id}", "starred_url": "https://api.github.com/users/douggilmore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/douggilmore/subscriptions", "organizations_url": "https://api.github.com/users/douggilmore/orgs", "repos_url": "https://api.github.com/users/douggilmore/repos", "events_url": "https://api.github.com/users/douggilmore/events{/privacy}", "received_events_url": "https://api.github.com/users/douggilmore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "0af06385d3f521d4afc501b7ddc75d94120e17a1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0af06385d3f521d4afc501b7ddc75d94120e17a1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0af06385d3f521d4afc501b7ddc75d94120e17a1"}], "stats": {"total": 18, "additions": 18, "deletions": 0}, "files": [{"sha": "6262f035fd238b5c44586221d3784cb836e35e9a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed481942e3c90b596b22b5001010a87a505829d5/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed481942e3c90b596b22b5001010a87a505829d5/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ed481942e3c90b596b22b5001010a87a505829d5", "patch": "@@ -1,3 +1,9 @@\n+2016-09-23  Doug Gilmore  <doug.gilmore@imgtec.com>\n+\n+\tPR tree-optimization/77654\n+\t* tree-ssa-alias.c (issue_prefetch_ref): Add call\n+\tto duplicate_ssa_name_ptr_info.\n+\n 2016-09-23  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR preprocessor/77672"}, {"sha": "056815de9e1fbdcc00e43ab896003c1958f08ebf", "filename": "gcc/tree-ssa-loop-prefetch.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ed481942e3c90b596b22b5001010a87a505829d5/gcc%2Ftree-ssa-loop-prefetch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ed481942e3c90b596b22b5001010a87a505829d5/gcc%2Ftree-ssa-loop-prefetch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-prefetch.c?ref=ed481942e3c90b596b22b5001010a87a505829d5", "patch": "@@ -39,6 +39,7 @@ along with GCC; see the file COPYING3.  If not see\n #include \"tree-ssa-loop-manip.h\"\n #include \"tree-ssa-loop-niter.h\"\n #include \"tree-ssa-loop.h\"\n+#include \"ssa.h\"\n #include \"tree-into-ssa.h\"\n #include \"cfgloop.h\"\n #include \"tree-scalar-evolution.h\"\n@@ -1160,6 +1161,17 @@ issue_prefetch_ref (struct mem_ref *ref, unsigned unroll_factor, unsigned ahead)\n           addr = force_gimple_operand_gsi (&bsi, unshare_expr (addr), true,\n \t\t\t\t\t   NULL, true, GSI_SAME_STMT);\n       }\n+\n+      if (TREE_CODE (addr_base) == SSA_NAME\n+\t  && TREE_CODE (addr) == SSA_NAME)\n+\t{\n+\t  duplicate_ssa_name_ptr_info (addr, SSA_NAME_PTR_INFO (addr_base));\n+\t  /* As this isn't a plain copy we have to reset alignment\n+\t     information.  */\n+\t  if (SSA_NAME_PTR_INFO (addr))\n+\t    mark_ptr_info_alignment_unknown (SSA_NAME_PTR_INFO (addr));\n+\t}\n+\n       /* Create the prefetch instruction.  */\n       prefetch = gimple_build_call (builtin_decl_explicit (BUILT_IN_PREFETCH),\n \t\t\t\t    3, addr, write_p, local);"}]}