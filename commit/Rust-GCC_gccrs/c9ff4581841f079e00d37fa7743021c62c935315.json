{"sha": "c9ff4581841f079e00d37fa7743021c62c935315", "node_id": "C_kwDOANBUbNoAKGM5ZmY0NTgxODQxZjA3OWUwMGQzN2ZhNzc0MzAyMWM2MmM5MzUzMTU", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2021-10-18T11:54:34Z"}, "committer": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2021-10-18T13:18:03Z"}, "message": "Reduce the number of aligned_access_p calls\n\nThis uses the computed alignment scheme in vectorizable_store\nmuch like vectorizable_load does instead of re-querying\nit via aligned_access_p.\n\n2021-10-18  Richard Biener  <rguenther@suse.de>\n\n\t* tree-vect-stmts.c (vectorizable_store): Use the\n\tcomputed alignment scheme instead of querying\n\taligned_access_p.", "tree": {"sha": "b12f22eb30c89b2ff54a76df24756c7563219a3e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b12f22eb30c89b2ff54a76df24756c7563219a3e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c9ff4581841f079e00d37fa7743021c62c935315", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9ff4581841f079e00d37fa7743021c62c935315", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c9ff4581841f079e00d37fa7743021c62c935315", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9ff4581841f079e00d37fa7743021c62c935315/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b0ea7a8409aa4afd0b0fd874b232766a758c0bc6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b0ea7a8409aa4afd0b0fd874b232766a758c0bc6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b0ea7a8409aa4afd0b0fd874b232766a758c0bc6"}], "stats": {"total": 11, "additions": 7, "deletions": 4}, "files": [{"sha": "07123a2970f355e75e4542b323d25e027cd76bbd", "filename": "gcc/tree-vect-stmts.c", "status": "modified", "additions": 7, "deletions": 4, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9ff4581841f079e00d37fa7743021c62c935315/gcc%2Ftree-vect-stmts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9ff4581841f079e00d37fa7743021c62c935315/gcc%2Ftree-vect-stmts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-stmts.c?ref=c9ff4581841f079e00d37fa7743021c62c935315", "patch": "@@ -8213,8 +8213,11 @@ vectorizable_store (vec_info *vinfo,\n \t\tvec_oprnd = result_chain[i];\n \n \t      align = known_alignment (DR_TARGET_ALIGNMENT (first_dr_info));\n-\t      if (aligned_access_p (first_dr_info, vectype))\n-\t\tmisalign = 0;\n+\t      if (alignment_support_scheme == dr_aligned)\n+\t\t{\n+\t\t  gcc_assert (aligned_access_p (first_dr_info, vectype));\n+\t\t  misalign = 0;\n+\t\t}\n \t      else if (dr_misalignment (first_dr_info, vectype)\n \t\t       == DR_MISALIGNMENT_UNKNOWN)\n \t\t{\n@@ -8299,8 +8302,8 @@ vectorizable_store (vec_info *vinfo,\n \t\t\t\t\t  dataref_offset\n \t\t\t\t\t  ? dataref_offset\n \t\t\t\t\t  : build_int_cst (ref_type, 0));\n-\t\t  if (aligned_access_p (first_dr_info, vectype))\n-\t\t    ;\n+\t\t  if (alignment_support_scheme == dr_aligned)\n+\t\t    gcc_assert (aligned_access_p (first_dr_info, vectype));\n \t\t  else\n \t\t    TREE_TYPE (data_ref)\n \t\t      = build_aligned_type (TREE_TYPE (data_ref),"}]}