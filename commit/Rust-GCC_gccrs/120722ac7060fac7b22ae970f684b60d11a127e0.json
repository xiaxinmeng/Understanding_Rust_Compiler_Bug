{"sha": "120722ac7060fac7b22ae970f684b60d11a127e0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTIwNzIyYWM3MDYwZmFjN2IyMmFlOTcwZjY4NGI2MGQxMWExMjdlMA==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@markmitchell.com", "date": "1998-05-27T19:11:36Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "1998-05-27T19:11:36Z"}, "message": "decl.c (shadow_label): Don't treat decls as identifiers.\n\n\t* decl.c (shadow_label): Don't treat decls as identifiers.\n\t(maybe_push_to_top_level): Clear shadowed_labels.\n\t* pt.c (instantiate_decl): Reset lineno and filename after calling\n\tregenerate_decl_from_template.\n\nFrom-SVN: r20093", "tree": {"sha": "2cdd3bab6c39b411dab4327a60c2f1cb0c70dd10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2cdd3bab6c39b411dab4327a60c2f1cb0c70dd10"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/120722ac7060fac7b22ae970f684b60d11a127e0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/120722ac7060fac7b22ae970f684b60d11a127e0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/120722ac7060fac7b22ae970f684b60d11a127e0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/120722ac7060fac7b22ae970f684b60d11a127e0/comments", "author": null, "committer": null, "parents": [{"sha": "b608647a8a9b759f5f54f9bc5a17096df6ef2f3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b608647a8a9b759f5f54f9bc5a17096df6ef2f3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b608647a8a9b759f5f54f9bc5a17096df6ef2f3b"}], "stats": {"total": 39, "additions": 36, "deletions": 3}, "files": [{"sha": "70caa2dd9d8e9fc9cd66ac1bbcecc9a772b97028", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=120722ac7060fac7b22ae970f684b60d11a127e0", "patch": "@@ -1,5 +1,11 @@\n 1998-05-27  Mark Mitchell  <mark@markmitchell.com>\n \n+\t* decl.c (shadow_label): Don't treat decls as identifiers.\n+\t(maybe_push_to_top_level): Clear shadowed_labels.\n+\n+\t* pt.c (instantiate_decl): Reset lineno and filename after calling\n+\tregenerate_decl_from_template. \n+\n \t* decl.c (grokdeclarator): Don't try to use TYPE_OBSTACK on an\n \terror_mark_node.\n "}, {"sha": "fd5fcfacf68ef718690e20ed982518ab5d0a4603", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=120722ac7060fac7b22ae970f684b60d11a127e0", "patch": "@@ -1992,6 +1992,7 @@ maybe_push_to_top_level (pseudo)\n   current_lang_name = lang_name_cplusplus;\n   strict_prototype = strict_prototypes_lang_cplusplus;\n   named_labels = NULL_TREE;\n+  shadowed_labels = NULL_TREE;\n   minimal_parse_mode = 0;\n   previous_class_type = previous_class_values = NULL_TREE;\n   processing_specialization = 0;\n@@ -4106,7 +4107,6 @@ shadow_label (name)\n     {\n       shadowed_labels = tree_cons (NULL_TREE, decl, shadowed_labels);\n       SET_IDENTIFIER_LABEL_VALUE (name, NULL_TREE);\n-      SET_IDENTIFIER_LABEL_VALUE (decl, NULL_TREE);\n     }\n \n   return lookup_label (name);"}, {"sha": "e13135c66c8c42dec96c8ddfbc4abed239ed23ba", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=120722ac7060fac7b22ae970f684b60d11a127e0", "patch": "@@ -7158,11 +7158,13 @@ instantiate_decl (d)\n       goto out;\n     }\n \n+  regenerate_decl_from_template (d, td);\n+\n+  /* We already set the file and line above.  Reset them now in case\n+     they changed as a result of calling regenerate_decl_from_template.  */\n   lineno = DECL_SOURCE_LINE (d);\n   input_filename = DECL_SOURCE_FILE (d);\n \n-  regenerate_decl_from_template (d, td);\n-\n   if (TREE_CODE (d) == VAR_DECL)\n     {\n       DECL_IN_AGGR_P (d) = 0;"}, {"sha": "964d1d7afc354f22fd2543ce260420880f57b8a0", "filename": "gcc/testsuite/g++.old-deja/g++.pt/label1.C", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Flabel1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/120722ac7060fac7b22ae970f684b60d11a127e0/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Flabel1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.pt%2Flabel1.C?ref=120722ac7060fac7b22ae970f684b60d11a127e0", "patch": "@@ -0,0 +1,25 @@\n+// Build don't link:\n+\n+template <class T>\n+struct S {};\n+\n+template <class T>\n+inline void g(T t)\n+{\n+ here:\n+  S<T> st;\n+  goto here;\n+}\n+\n+template <class T>\n+void f(T t)\n+{\n+ here:\n+  g(t);\n+  goto here;\n+}\n+\n+void h()\n+{\n+  f(3);\n+}"}]}