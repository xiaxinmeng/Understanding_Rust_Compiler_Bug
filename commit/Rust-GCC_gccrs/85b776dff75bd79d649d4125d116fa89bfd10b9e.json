{"sha": "85b776dff75bd79d649d4125d116fa89bfd10b9e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODViNzc2ZGZmNzViZDc5ZDY0OWQ0MTI1ZDExNmZhODliZmQxMGI5ZQ==", "commit": {"author": {"name": "Alan Modra", "email": "amodra@bigpond.net.au", "date": "2004-08-21T01:40:00Z"}, "committer": {"name": "Alan Modra", "email": "amodra@gcc.gnu.org", "date": "2004-08-21T01:40:00Z"}, "message": "linux64.h (DOT_SYMBOLS): Define.\n\n\t* config/rs6000/linux64.h (DOT_SYMBOLS): Define.\n\t(CRT_CALL_STATIC_FUNCTION): Define !DOT_SYMBOLS version.\n\t(ASM_DECLARE_FUNCTION_SIZE): Modify for !DOT_SYMBOLS.\n\t(ASM_OUTPUT_SOURCE_LINE, DBX_OUTPUT_BRAC, DBX_OUTPUT_NFUN): Likewise.\n\t(RS6000_ABI_NAME): Define as \"linux\".\n\t(SUBSUBTARGET_OVERRIDE_OPTIONS): Set dot_symbols.\n\t* config/rs6000/sysv4.h (SUBTARGET_OVERRIDE_OPTIONS): Select\n\tABI_AIX when rs6000_abi_name is \"linux\" and TARGET_64BIT.\n\t* config/rs6000/rs6000-protos.h (rs6000_output_function_entry): Decl.\n\t* config/rs6000/rs6000.c (dot_symbols): New global var.\n\t(rs6000_output_function_entry): New function, modified for\n\t!DOT_SYMBOLS..\n\t(print_operand <case 'z'>): ..extracted from here.\n\t(rs6000_assemble_visibility): Modify for !DOT_SYMBOLS.\n\t(rs6000_output_function_epilogue): Likewise.\n\t(rs6000_elf_declare_function_name): Likewise.\n\t* config/rs6000/rs6000.h (DOT_SYMBOLS): Define.\n\t(ASM_WEAKEN_DECL, ASM_OUTPUT_DEF_FROM_DECLS): Modify for !DOT_SYMBOLS.\n\t* configure.ac (HAVE_LD_NO_DOT_SYMS): Add new AC_DEFINE.\n\t* configure: Regenerate.\n\t* config.in: Regenerate.\n\nFrom-SVN: r86354", "tree": {"sha": "59847964b19ce34a89d09442325d0bd276be829e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/59847964b19ce34a89d09442325d0bd276be829e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/85b776dff75bd79d649d4125d116fa89bfd10b9e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85b776dff75bd79d649d4125d116fa89bfd10b9e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/85b776dff75bd79d649d4125d116fa89bfd10b9e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/85b776dff75bd79d649d4125d116fa89bfd10b9e/comments", "author": null, "committer": null, "parents": [{"sha": "eba6cfb6b5694f15f880827805ca7d0b0907c60d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eba6cfb6b5694f15f880827805ca7d0b0907c60d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eba6cfb6b5694f15f880827805ca7d0b0907c60d"}], "stats": {"total": 481, "additions": 349, "deletions": 132}, "files": [{"sha": "3af5733f797456d7fd2d12795380090e395f5170", "filename": "gcc/ChangeLog", "status": "modified", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -1,3 +1,27 @@\n+2004-08-21  Alan Modra  <amodra@bigpond.net.au>\n+\n+\t* config/rs6000/linux64.h (DOT_SYMBOLS): Define.\n+\t(CRT_CALL_STATIC_FUNCTION): Define !DOT_SYMBOLS version.\n+\t(ASM_DECLARE_FUNCTION_SIZE): Modify for !DOT_SYMBOLS.\n+\t(ASM_OUTPUT_SOURCE_LINE, DBX_OUTPUT_BRAC, DBX_OUTPUT_NFUN): Likewise.\n+\t(RS6000_ABI_NAME): Define as \"linux\".\n+\t(SUBSUBTARGET_OVERRIDE_OPTIONS): Set dot_symbols.\n+\t* config/rs6000/sysv4.h (SUBTARGET_OVERRIDE_OPTIONS): Select\n+\tABI_AIX when rs6000_abi_name is \"linux\" and TARGET_64BIT.\n+\t* config/rs6000/rs6000-protos.h (rs6000_output_function_entry): Decl.\n+\t* config/rs6000/rs6000.c (dot_symbols): New global var.\n+\t(rs6000_output_function_entry): New function, modified for\n+\t!DOT_SYMBOLS..\n+\t(print_operand <case 'z'>): ..extracted from here.\n+\t(rs6000_assemble_visibility): Modify for !DOT_SYMBOLS.\n+\t(rs6000_output_function_epilogue): Likewise.\n+\t(rs6000_elf_declare_function_name): Likewise.\n+\t* config/rs6000/rs6000.h (DOT_SYMBOLS): Define.\n+\t(ASM_WEAKEN_DECL, ASM_OUTPUT_DEF_FROM_DECLS): Modify for !DOT_SYMBOLS.\n+\t* configure.ac (HAVE_LD_NO_DOT_SYMS): Add new AC_DEFINE.\n+\t* configure: Regenerate.\n+\t* config.in: Regenerate.\n+\n 2004-08-20  Mark Mitchell  <mark@codesourcery.com>\n \n \t* reload.c (find_reloads_address): Fix thinko in previous change."}, {"sha": "61f5ec21207e6e4500d79727ecf9cf886a903c35", "filename": "gcc/config.in", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -351,6 +351,9 @@\n /* Define if your linker supports --eh-frame-hdr option. */\n #undef HAVE_LD_EH_FRAME_HDR\n \n+/* Define if your PowerPC64 linker only needs function descriptor syms. */\n+#undef HAVE_LD_NO_DOT_SYMS\n+\n /* Define if your linker supports -pie option. */\n #undef HAVE_LD_PIE\n "}, {"sha": "f87f10ebfb1170ccd9102908d3668eaa6f5ceccf", "filename": "gcc/config/rs6000/linux64.h", "status": "modified", "additions": 32, "deletions": 18, "changes": 50, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Flinux64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Flinux64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Flinux64.h?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -50,14 +50,21 @@\n #undef\tTARGET_AIX\n #define\tTARGET_AIX TARGET_64BIT\n \n+#ifdef HAVE_LD_NO_DOT_SYMS\n+/* New ABI uses a local sym for the function entry point.  */\n+extern int dot_symbols;\n+#undef DOT_SYMBOLS\n+#define DOT_SYMBOLS dot_symbols\n+#endif\n+\n #undef PROCESSOR_DEFAULT64\n #define PROCESSOR_DEFAULT64 PROCESSOR_PPC630\n \n #undef\tTARGET_RELOCATABLE\n #define\tTARGET_RELOCATABLE (!TARGET_64BIT && (target_flags & MASK_RELOCATABLE))\n \n #undef\tRS6000_ABI_NAME\n-#define\tRS6000_ABI_NAME (TARGET_64BIT ? \"aixdesc\" : \"sysv\")\n+#define\tRS6000_ABI_NAME \"linux\"\n \n #define INVALID_64BIT \"-m%s not supported in this configuration\"\n #define INVALID_32BIT INVALID_64BIT\n@@ -75,6 +82,7 @@\n \t      rs6000_current_abi = ABI_AIX;\t\t\t\\\n \t      error (INVALID_64BIT, \"call\");\t\t\t\\\n \t    }\t\t\t\t\t\t\t\\\n+\t  dot_symbols = !strcmp (rs6000_abi_name, \"aixdesc\");\t\\\n \t  if (target_flags & MASK_RELOCATABLE)\t\t\t\\\n \t    {\t\t\t\t\t\t\t\\\n \t      target_flags &= ~MASK_RELOCATABLE;\t\t\\\n@@ -386,11 +394,19 @@\n    object files, each potentially with a different TOC pointer.  For\n    that reason, place a nop after the call so that the linker can\n    restore the TOC pointer if a TOC adjusting call stub is needed.  */\n+#if DOT_SYMBOLS\n #define CRT_CALL_STATIC_FUNCTION(SECTION_OP, FUNC)\t\\\n   asm (SECTION_OP \"\\n\"\t\t\t\t\t\\\n \"\tbl .\" #FUNC \"\\n\"\t\t\t\t\\\n \"\tnop\\n\"\t\t\t\t\t\t\\\n \"\t.previous\");\n+#else\n+#define CRT_CALL_STATIC_FUNCTION(SECTION_OP, FUNC)\t\\\n+  asm (SECTION_OP \"\\n\"\t\t\t\t\t\\\n+\"\tbl \" #FUNC \"\\n\"\t\t\t\t\t\\\n+\"\tnop\\n\"\t\t\t\t\t\t\\\n+\"\t.previous\");\n+#endif\n #endif\n \n /* FP save and restore routines.  */\n@@ -415,13 +431,11 @@\n       if (!flag_inhibit_size_directive)\t\t\t\t\t\\\n \t{\t\t\t\t\t\t\t\t\\\n \t  fputs (\"\\t.size\\t\", (FILE));\t\t\t\t\t\\\n-\t  if (TARGET_64BIT)\t\t\t\t\t\t\\\n+\t  if (TARGET_64BIT && DOT_SYMBOLS)\t\t\t\t\\\n \t    putc ('.', (FILE));\t\t\t\t\t\t\\\n \t  assemble_name ((FILE), (FNAME));\t\t\t\t\\\n \t  fputs (\",.-\", (FILE));\t\t\t\t\t\\\n-\t  if (TARGET_64BIT)\t\t\t\t\t\t\\\n-\t    putc ('.', (FILE));\t\t\t\t\t\t\\\n-\t  assemble_name ((FILE), (FNAME));\t\t\t\t\\\n+\t  rs6000_output_function_entry (FILE, FNAME);\t\t\t\\\n \t  putc ('\\n', (FILE));\t\t\t\t\t\t\\\n \t}\t\t\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n@@ -465,14 +479,13 @@\n do\t\t\t\t\t\t\t\t\t\\\n   {\t\t\t\t\t\t\t\t\t\\\n     char temp[256];\t\t\t\t\t\t\t\\\n+    const char *s;\t\t\t\t\t\t\t\\\n     ASM_GENERATE_INTERNAL_LABEL (temp, \"LM\", COUNTER);\t\t\t\\\n     fprintf (FILE, \"\\t.stabn 68,0,%d,\", LINE);\t\t\t\t\\\n     assemble_name (FILE, temp);\t\t\t\t\t\t\\\n     putc ('-', FILE);\t\t\t\t\t\t\t\\\n-    if (TARGET_64BIT)\t\t\t\t\t\t\t\\\n-      putc ('.', FILE);\t\t\t\t\t\t\t\\\n-    assemble_name (FILE,\t\t\t\t\t\t\\\n-\t\t   XSTR (XEXP (DECL_RTL (current_function_decl), 0), 0));\\\n+    s = XSTR (XEXP (DECL_RTL (current_function_decl), 0), 0);\t\t\\\n+    rs6000_output_function_entry (FILE, s);\t\t\t\t\\\n     putc ('\\n', FILE);\t\t\t\t\t\t\t\\\n     (*targetm.asm_out.internal_label) (FILE, \"LM\", COUNTER);\t\t\\\n   }\t\t\t\t\t\t\t\t\t\\\n@@ -482,19 +495,20 @@ while (0)\n #define DBX_OUTPUT_BRAC(FILE, NAME, BRAC) \\\n   do\t\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n-      const char *flab;\t\t\t\t\t\t\t\\\n+      const char *s;\t\t\t\t\t\t\t\\\n       fprintf (FILE, \"%s%d,0,0,\", ASM_STABN_OP, BRAC);\t\t\t\\\n       assemble_name (FILE, NAME);\t\t\t\t\t\\\n       putc ('-', FILE);\t\t\t\t\t\t\t\\\n       if (current_function_func_begin_label != NULL_TREE)\t\t\\\n-\tflab = IDENTIFIER_POINTER (current_function_func_begin_label);\t\\\n+\t{\t\t\t\t\t\t\t\t\\\n+\t  s = IDENTIFIER_POINTER (current_function_func_begin_label);\t\\\n+\t  assemble_name (FILE, s);\t\t\t\t\t\\\n+\t}\t\t\t\t\t\t\t\t\\\n       else\t\t\t\t\t\t\t\t\\\n \t{\t\t\t\t\t\t\t\t\\\n-\t  if (TARGET_64BIT)\t\t\t\t\t\t\\\n-\t    putc ('.', FILE);\t\t\t\t\t\t\\\n-\t  flab = XSTR (XEXP (DECL_RTL (current_function_decl), 0), 0);\t\\\n+\t  s = XSTR (XEXP (DECL_RTL (current_function_decl), 0), 0);\t\\\n+\t  rs6000_output_function_entry (FILE, s);\t\t\t\\\n \t}\t\t\t\t\t\t\t\t\\\n-      assemble_name (FILE, flab);\t\t\t\t\t\\\n       putc ('\\n', FILE);\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   while (0)\n@@ -506,12 +520,12 @@ while (0)\n #define\tDBX_OUTPUT_NFUN(FILE, LSCOPE, DECL)\t\t\t\t\\\n   do\t\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n+      const char *s;\t\t\t\t\t\t\t\\\n       fprintf (FILE, \"%s\\\"\\\",%d,0,0,\", ASM_STABS_OP, N_FUN);\t\t\\\n       assemble_name (FILE, LSCOPE);\t\t\t\t\t\\\n       putc ('-', FILE);\t\t\t\t\t\t\t\\\n-      if (TARGET_64BIT)\t\t\t\t\t\t\t\\\n-        putc ('.', FILE);\t\t\t\t\t\t\\\n-      assemble_name (FILE, XSTR (XEXP (DECL_RTL (DECL), 0), 0));\t\\\n+      s = XSTR (XEXP (DECL_RTL (current_function_decl), 0), 0);\t\t\\\n+      rs6000_output_function_entry (FILE, s);\t\t\t\t\\\n       putc ('\\n', FILE);\t\t\t\t\t\t\\\n     }\t\t\t\t\t\t\t\t\t\\\n   while (0)"}, {"sha": "962affe5ec03b21a4b818649d85fed69239a7a84", "filename": "gcc/config/rs6000/rs6000-protos.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Frs6000-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Frs6000-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000-protos.h?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -113,6 +113,7 @@ extern enum reg_class secondary_reload_class (enum reg_class,\n extern int ccr_bit (rtx, int);\n extern int extract_MB (rtx);\n extern int extract_ME (rtx);\n+extern void rs6000_output_function_entry (FILE *, const char *);\n extern void print_operand (FILE *, rtx, int);\n extern void print_operand_address (FILE *, rtx);\n extern enum rtx_code rs6000_reverse_condition (enum machine_mode,"}, {"sha": "528d5e6cdbbd3b7a0437583941abc158a2ebb323", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 63, "deletions": 44, "changes": 107, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -213,6 +213,9 @@ enum rs6000_abi rs6000_current_abi;\n /* ABI string from -mabi= option.  */\n const char *rs6000_abi_string;\n \n+/* Whether to use variant of AIX ABI for PowerPC64 Linux.  */\n+int dot_symbols;\n+\n /* Debug flags */\n const char *rs6000_debug_name;\n int rs6000_debug_stack;\t\t/* debug stack applications */\n@@ -9791,6 +9794,36 @@ rs6000_get_some_local_dynamic_name_1 (rtx *px, void *data ATTRIBUTE_UNUSED)\n   return 0;\n }\n \n+/* Write out a function code label.  */\n+\n+void\n+rs6000_output_function_entry (FILE *file, const char *fname)\n+{\n+  if (fname[0] != '.')\n+    {\n+      switch (DEFAULT_ABI)\n+\t{\n+\tdefault:\n+\t  abort ();\n+\n+\tcase ABI_AIX:\n+\t  if (DOT_SYMBOLS)\n+\t    putc ('.', file);\n+\t  else\n+\t    ASM_OUTPUT_INTERNAL_LABEL_PREFIX (file, \"L.\");\n+\t  break;\n+\n+\tcase ABI_V4:\n+\tcase ABI_DARWIN:\n+\t  break;\n+\t}\n+    }\n+  if (TARGET_AIX)\n+    RS6000_OUTPUT_BASENAME (file, fname);\n+  else\n+    assemble_name (file, fname);\n+}\n+\n /* Print an operand.  Recognize special options, documented below.  */\n \n #if TARGET_ELF\n@@ -10323,23 +10356,7 @@ print_operand (FILE *file, rtx x, int code)\n       if (SYMBOL_REF_DECL (x))\n         mark_decl_referenced (SYMBOL_REF_DECL (x));\n \n-      if (XSTR (x, 0)[0] != '.')\n-\t{\n-\t  switch (DEFAULT_ABI)\n-\t    {\n-\t    default:\n-\t      abort ();\n-\n-\t    case ABI_AIX:\n-\t      putc ('.', file);\n-\t      break;\n-\n-\t    case ABI_V4:\n-\t    case ABI_DARWIN:\n-\t      break;\n-\t    }\n-\t}\n-      /* For macho, we need to check it see if we need a stub.  */\n+      /* For macho, check to see if we need a stub.  */\n       if (TARGET_MACHO)\n \t{\n \t  const char *name = XSTR (x, 0);\n@@ -10350,10 +10367,10 @@ print_operand (FILE *file, rtx x, int code)\n #endif\n \t  assemble_name (file, name);\n \t}\n-     else if (TARGET_AIX)\n-\tRS6000_OUTPUT_BASENAME (file, XSTR (x, 0));\n-      else\n+      else if (!DOT_SYMBOLS)\n \tassemble_name (file, XSTR (x, 0));\n+      else\n+\trs6000_output_function_entry (file, XSTR (x, 0));\n       return;\n \n     case 'Z':\n@@ -10609,7 +10626,9 @@ rs6000_assemble_visibility (tree decl, int vis)\n {\n   /* Functions need to have their entry point symbol visibility set as\n      well as their descriptor symbol visibility.  */\n-  if (DEFAULT_ABI == ABI_AIX && TREE_CODE (decl) == FUNCTION_DECL)\n+  if (DEFAULT_ABI == ABI_AIX\n+      && DOT_SYMBOLS\n+      && TREE_CODE (decl) == FUNCTION_DECL)\n     {\n       static const char * const visibility_types[] = {\n         NULL, \"internal\", \"hidden\", \"protected\"\n@@ -14219,17 +14238,12 @@ rs6000_output_function_epilogue (FILE *file,\n       /* Offset from start of code to tb table.  */\n       fputs (\"\\t.long \", file);\n       ASM_OUTPUT_INTERNAL_LABEL_PREFIX (file, \"LT\");\n-#if TARGET_AIX\n-      RS6000_OUTPUT_BASENAME (file, fname);\n-#else\n-      assemble_name (file, fname);\n-#endif\n-      fputs (\"-.\", file);\n-#if TARGET_AIX\n-      RS6000_OUTPUT_BASENAME (file, fname);\n-#else\n-      assemble_name (file, fname);\n-#endif\n+      if (TARGET_AIX)\n+\tRS6000_OUTPUT_BASENAME (file, fname);\n+      else\n+\tassemble_name (file, fname);\n+      putc ('-', file);\n+      rs6000_output_function_entry (file, fname);\n       putc ('\\n', file);\n \n       /* Interrupt handler mask.  */\n@@ -16802,22 +16816,27 @@ rs6000_elf_declare_function_name (FILE *file, const char *name, tree decl)\n       fputs (\"\\t.section\\t\\\".opd\\\",\\\"aw\\\"\\n\\t.align 3\\n\", file);\n       ASM_OUTPUT_LABEL (file, name);\n       fputs (DOUBLE_INT_ASM_OP, file);\n-      putc ('.', file);\n-      assemble_name (file, name);\n-      fputs (\",.TOC.@tocbase,0\\n\\t.previous\\n\\t.size\\t\", file);\n-      assemble_name (file, name);\n-      fputs (\",24\\n\\t.type\\t.\", file);\n-      assemble_name (file, name);\n-      fputs (\",@function\\n\", file);\n-      if (TREE_PUBLIC (decl) && ! DECL_WEAK (decl))\n+      rs6000_output_function_entry (file, name);\n+      fputs (\",.TOC.@tocbase,0\\n\\t.previous\\n\", file);\n+      if (DOT_SYMBOLS)\n \t{\n-\t  fputs (\"\\t.globl\\t.\", file);\n+\t  fputs (\"\\t.size\\t\", file);\n \t  assemble_name (file, name);\n-\t  putc ('\\n', file);\n+\t  fputs (\",24\\n\\t.type\\t.\", file);\n+\t  assemble_name (file, name);\n+\t  fputs (\",@function\\n\", file);\n+\t  if (TREE_PUBLIC (decl) && ! DECL_WEAK (decl))\n+\t    {\n+\t      fputs (\"\\t.globl\\t.\", file);\n+\t      assemble_name (file, name);\n+\t      putc ('\\n', file);\n+\t    }\n \t}\n+      else\n+\tASM_OUTPUT_TYPE_DIRECTIVE (file, name, \"function\");\n       ASM_DECLARE_RESULT (file, DECL_RESULT (decl));\n-      putc ('.', file);\n-      ASM_OUTPUT_LABEL (file, name);\n+      rs6000_output_function_entry (file, name);\n+      fputs (\":\\n\", file);\n       return;\n     }\n "}, {"sha": "46626ca1c4c4f8d7f5b5fa636b87538c0ec377f0", "filename": "gcc/config/rs6000/rs6000.h", "status": "modified", "additions": 8, "deletions": 4, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Frs6000.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Frs6000.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.h?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -40,6 +40,10 @@\n #define TARGET_AIX 0\n #endif\n \n+/* Control whether function entry points use a \"dot\" symbol when\n+   ABI_AIX.  */\n+#define DOT_SYMBOLS 1\n+\n /* Default string to use for cpu if not specified.  */\n #ifndef TARGET_CPU_DEFAULT\n #define TARGET_CPU_DEFAULT ((char *)0)\n@@ -2246,9 +2250,9 @@ extern int toc_initialized;\n   do\t\t\t\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\t\t\t\\\n       fputs (\"\\t.weak\\t\", (FILE));\t\t\t\t\t\\\n-      RS6000_OUTPUT_BASENAME ((FILE), (NAME)); \t\t\t\\\n+      RS6000_OUTPUT_BASENAME ((FILE), (NAME)); \t\t\t\t\\\n       if ((DECL) && TREE_CODE (DECL) == FUNCTION_DECL\t\t\t\\\n-\t  && DEFAULT_ABI == ABI_AIX)\t\t\t\t\t\\\n+\t  && DEFAULT_ABI == ABI_AIX && DOT_SYMBOLS)\t\t\t\\\n \t{\t\t\t\t\t\t\t\t\\\n \t  if (TARGET_XCOFF)\t\t\t\t\t\t\\\n \t    fputs (\"[DS]\", (FILE));\t\t\t\t\t\\\n@@ -2260,7 +2264,7 @@ extern int toc_initialized;\n \t{\t\t\t\t\t\t\t\t\\\n \t  ASM_OUTPUT_DEF ((FILE), (NAME), (VAL));\t\t\t\\\n \t  if ((DECL) && TREE_CODE (DECL) == FUNCTION_DECL\t\t\\\n-\t      && DEFAULT_ABI == ABI_AIX)\t\t\t\t\\\n+\t      && DEFAULT_ABI == ABI_AIX && DOT_SYMBOLS)\t\t\t\\\n \t    {\t\t\t\t\t\t\t\t\\\n \t      fputs (\"\\t.set\\t.\", (FILE));\t\t\t\t\\\n \t      RS6000_OUTPUT_BASENAME ((FILE), (NAME));\t\t\t\\\n@@ -2281,7 +2285,7 @@ extern int toc_initialized;\n       const char *alias = XSTR (XEXP (DECL_RTL (DECL), 0), 0);\t\t\\\n       const char *name = IDENTIFIER_POINTER (TARGET);\t\t\t\\\n       if (TREE_CODE (DECL) == FUNCTION_DECL\t\t\t\t\\\n-\t  && DEFAULT_ABI == ABI_AIX)\t\t\t\t\t\\\n+\t  && DEFAULT_ABI == ABI_AIX && DOT_SYMBOLS)\t\t\t\\\n \t{\t\t\t\t\t\t\t\t\\\n \t  if (TREE_PUBLIC (DECL))\t\t\t\t\t\\\n \t    {\t\t\t\t\t\t\t\t\\"}, {"sha": "75be99e344eca4f40b261035b544927313c9fb31", "filename": "gcc/config/rs6000/sysv4.h", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Fsysv4.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfig%2Frs6000%2Fsysv4.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Fsysv4.h?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -194,7 +194,12 @@ do {\t\t\t\t\t\t\t\t\t\\\n   else if (!strcmp (rs6000_abi_name, \"freebsd\"))\t\t\t\\\n     rs6000_current_abi = ABI_V4;\t\t\t\t\t\\\n   else if (!strcmp (rs6000_abi_name, \"linux\"))\t\t\t\t\\\n-    rs6000_current_abi = ABI_V4;\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\t\\\n+      if (TARGET_64BIT)\t\t\t\t\t\t\t\\\n+\trs6000_current_abi = ABI_AIX;\t\t\t\t\t\\\n+      else\t\t\t\t\t\t\t\t\\\n+\trs6000_current_abi = ABI_V4;\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\t\t\t\\\n   else if (!strcmp (rs6000_abi_name, \"gnu\"))\t\t\t\t\\\n     rs6000_current_abi = ABI_V4;\t\t\t\t\t\\\n   else if (!strcmp (rs6000_abi_name, \"netbsd\"))\t\t\t\t\\"}, {"sha": "f7e2f303e7287635411156ee8554386f28181c3d", "filename": "gcc/configure", "status": "modified", "additions": 171, "deletions": 65, "changes": 236, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -1030,7 +1030,7 @@ esac\n     else\n       echo \"$as_me: WARNING: no configuration information is in $ac_dir\" >&2\n     fi\n-    cd \"$ac_popdir\"\n+    cd $ac_popdir\n   done\n fi\n \n@@ -2379,7 +2379,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2437,7 +2438,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2553,7 +2555,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2607,7 +2610,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2652,7 +2656,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -2696,7 +2701,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3102,7 +3108,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3173,7 +3180,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3232,7 +3240,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3298,7 +3307,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3368,7 +3378,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3438,7 +3449,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3508,7 +3520,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3579,7 +3592,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3651,7 +3665,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3724,7 +3739,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3774,7 +3790,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -3832,7 +3849,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4044,7 +4062,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4214,7 +4233,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -4277,7 +4297,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5242,7 +5263,7 @@ if test \"${gcc_cv_prog_makeinfo_modern+set}\" = set; then\n else\n     ac_prog_version=`$MAKEINFO --version 2>&1 |\n                    sed -n 's/^.*GNU texinfo.* \\([0-9][0-9.]*\\).*$/\\1/p'`\n-  echo \"configure:5245: version of makeinfo is $ac_prog_version\" >&5\n+  echo \"configure:5266: version of makeinfo is $ac_prog_version\" >&5\n   case $ac_prog_version in\n     '')     gcc_cv_prog_makeinfo_modern=no;;\n     4.[2-9]*)\n@@ -5497,7 +5518,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5567,7 +5589,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5732,7 +5755,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5793,7 +5817,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -5863,7 +5888,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6137,7 +6163,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6210,7 +6237,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6251,7 +6279,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6453,7 +6482,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6527,7 +6557,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6581,7 +6612,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6659,7 +6691,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6713,7 +6746,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6781,7 +6815,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -6911,7 +6946,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7032,7 +7068,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7383,7 +7420,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7500,7 +7538,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7612,7 +7651,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -7770,7 +7810,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8139,7 +8180,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8189,7 +8231,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8264,7 +8307,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8338,7 +8382,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8440,7 +8485,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8525,7 +8571,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8594,7 +8641,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8663,7 +8711,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8746,7 +8795,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8822,7 +8872,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -8888,7 +8939,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9024,7 +9076,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9107,7 +9160,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9397,7 +9451,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9666,7 +9721,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -9720,7 +9776,8 @@ if { (eval echo \"$as_me:$LINENO: \\\"$ac_link\\\"\") >&5\n   cat conftest.err >&5\n   echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n   (exit $ac_status); } &&\n-\t { ac_try='test -z \"$ac_c_werror_flag\"\t\t\t || test ! -s conftest.err'\n+\t { ac_try='test -z \"$ac_c_werror_flag\"\n+\t\t\t || test ! -s conftest.err'\n   { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n   (eval $ac_try) 2>&5\n   ac_status=$?\n@@ -12049,6 +12106,56 @@ _ACEOF\n \n fi\n \n+case \"$target\" in\n+  powerpc64*-*-linux*)\n+    echo \"$as_me:$LINENO: checking linker support for omitting dot symbols\" >&5\n+echo $ECHO_N \"checking linker support for omitting dot symbols... $ECHO_C\" >&6\n+if test \"${gcc_cv_ld_no_dot_syms+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  gcc_cv_ld_no_dot_syms=no\n+    if test $in_tree_ld = yes ; then\n+      if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2; then\n+        gcc_cv_ld_no_dot_syms=yes\n+      fi\n+    elif test x$gcc_cv_as != x -a x$gcc_cv_ld != x ; then\n+      cat > conftest1.s <<EOF\n+\t.text\n+\tbl .foo\n+EOF\n+      cat > conftest2.s <<EOF\n+\t.section \".opd\",\"aw\"\n+\t.align 3\n+\t.globl foo\n+\t.type foo,@function\n+foo:\n+\t.quad .LEfoo,.TOC.@tocbase,0\n+\t.text\n+.LEfoo:\n+\tblr\n+\t.size foo,.-.LEfoo\n+EOF\n+      if $gcc_cv_as -a64 -o conftest1.o conftest1.s > /dev/null 2>&1 \\\n+         && $gcc_cv_as -a64 -o conftest2.o conftest2.s > /dev/null 2>&1 \\\n+         && $gcc_cv_ld -melf64ppc -o conftest conftest1.o conftest2.o > /dev/null 2>&1; then\n+        gcc_cv_ld_no_dot_syms=yes\n+      fi\n+      rm -f conftest conftest1.o conftest2.o conftest1.s conftest2.s\n+    fi\n+\n+fi\n+echo \"$as_me:$LINENO: result: $gcc_cv_ld_no_dot_syms\" >&5\n+echo \"${ECHO_T}$gcc_cv_ld_no_dot_syms\" >&6\n+    if test x\"$gcc_cv_ld_no_dot_syms\" = xyes; then\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define HAVE_LD_NO_DOT_SYMS 1\n+_ACEOF\n+\n+    fi\n+    ;;\n+esac\n+\n if test x$with_sysroot = x && test x$host = x$target \\\n    && test \"$prefix\" != \"/usr\" && test \"x$prefix\" != \"x$local_prefix\" ; then\n \n@@ -13417,6 +13524,11 @@ esac\n \n \n \n+  if test x\"$ac_file\" != x-; then\n+    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n+echo \"$as_me: creating $ac_file\" >&6;}\n+    rm -f \"$ac_file\"\n+  fi\n   # Let's still pretend it is `configure' which instantiates (i.e., don't\n   # use $as_me), people would be surprised to read:\n   #    /* config.h.  Generated by config.status.  */\n@@ -13455,12 +13567,6 @@ echo \"$as_me: error: cannot find input file: $f\" >&2;}\n \t fi;;\n       esac\n     done` || { (exit 1); exit 1; }\n-\n-  if test x\"$ac_file\" != x-; then\n-    { echo \"$as_me:$LINENO: creating $ac_file\" >&5\n-echo \"$as_me: creating $ac_file\" >&6;}\n-    rm -f \"$ac_file\"\n-  fi\n _ACEOF\n cat >>$CONFIG_STATUS <<_ACEOF\n   sed \"$ac_vpsub"}, {"sha": "db368f3c36f687a1886f7737aab8b936bb02470b", "filename": "gcc/configure.ac", "status": "modified", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/85b776dff75bd79d649d4125d116fa89bfd10b9e/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=85b776dff75bd79d649d4125d116fa89bfd10b9e", "patch": "@@ -2854,6 +2854,47 @@ if test x\"$gcc_cv_ld_as_needed\" = xyes; then\n [Define if your linker supports --as-needed and --no-as-needed options.])\n fi\n \n+case \"$target\" in\n+  powerpc64*-*-linux*)\n+    AC_CACHE_CHECK(linker support for omitting dot symbols,\n+    gcc_cv_ld_no_dot_syms,\n+    [gcc_cv_ld_no_dot_syms=no\n+    if test $in_tree_ld = yes ; then\n+      if test \"$gcc_cv_gld_major_version\" -eq 2 -a \"$gcc_cv_gld_minor_version\" -ge 16 -o \"$gcc_cv_gld_major_version\" -gt 2; then\n+        gcc_cv_ld_no_dot_syms=yes\n+      fi\n+    elif test x$gcc_cv_as != x -a x$gcc_cv_ld != x ; then\n+      cat > conftest1.s <<EOF\n+\t.text\n+\tbl .foo\n+EOF\n+      cat > conftest2.s <<EOF\n+\t.section \".opd\",\"aw\"\n+\t.align 3\n+\t.globl foo\n+\t.type foo,@function\n+foo:\n+\t.quad .LEfoo,.TOC.@tocbase,0\n+\t.text\n+.LEfoo:\n+\tblr\n+\t.size foo,.-.LEfoo\n+EOF\n+      if $gcc_cv_as -a64 -o conftest1.o conftest1.s > /dev/null 2>&1 \\\n+         && $gcc_cv_as -a64 -o conftest2.o conftest2.s > /dev/null 2>&1 \\\n+         && $gcc_cv_ld -melf64ppc -o conftest conftest1.o conftest2.o > /dev/null 2>&1; then\n+        gcc_cv_ld_no_dot_syms=yes\n+      fi\n+      rm -f conftest conftest1.o conftest2.o conftest1.s conftest2.s\n+    fi\n+    ])\n+    if test x\"$gcc_cv_ld_no_dot_syms\" = xyes; then\n+      AC_DEFINE(HAVE_LD_NO_DOT_SYMS, 1,\n+    [Define if your PowerPC64 linker only needs function descriptor syms.])\n+    fi\n+    ;;\n+esac\n+\n if test x$with_sysroot = x && test x$host = x$target \\\n    && test \"$prefix\" != \"/usr\" && test \"x$prefix\" != \"x$local_prefix\" ; then\n   AC_DEFINE_UNQUOTED(PREFIX_INCLUDE_DIR, \"$prefix/include\","}]}