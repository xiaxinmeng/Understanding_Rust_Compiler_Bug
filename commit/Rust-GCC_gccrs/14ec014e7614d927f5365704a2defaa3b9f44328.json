{"sha": "14ec014e7614d927f5365704a2defaa3b9f44328", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTRlYzAxNGU3NjE0ZDkyN2Y1MzY1NzA0YTJkZWZhYTNiOWY0NDMyOA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-12-22T18:04:18Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-12-22T18:04:18Z"}, "message": "re PR debug/83550 (Bad location of DW_TAG_structure_type with forward declaration since r224161)\n\n\tPR debug/83550\n\t* c-decl.c (finish_struct): Set DECL_SOURCE_LOCATION on\n\tTYPE_STUB_DECL and call rest_of_type_compilation before processing\n\tincomplete vars rather than after it.\n\n\t* c-c++-common/dwarf2/pr83550.c: New test.\n\nFrom-SVN: r255981", "tree": {"sha": "1d0e411772a84b014560c0f0d6bdacd33b04ea34", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1d0e411772a84b014560c0f0d6bdacd33b04ea34"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/14ec014e7614d927f5365704a2defaa3b9f44328", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14ec014e7614d927f5365704a2defaa3b9f44328", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14ec014e7614d927f5365704a2defaa3b9f44328", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14ec014e7614d927f5365704a2defaa3b9f44328/comments", "author": null, "committer": null, "parents": [{"sha": "11d29d639f4b60f51a593932529be6895b613d4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11d29d639f4b60f51a593932529be6895b613d4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/11d29d639f4b60f51a593932529be6895b613d4c"}], "stats": {"total": 44, "additions": 31, "deletions": 13}, "files": [{"sha": "6dcababadda49254508cc45c35c884b1beb2d462", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=14ec014e7614d927f5365704a2defaa3b9f44328", "patch": "@@ -1875,7 +1875,7 @@\n \n 2016-08-22  Joseph Myers  <joseph@codesourcery.com>\n \n-\t* c-family/c-cppbuiltin.c (c_cpp_builtins): Check _FloatN and\n+\t* c-cppbuiltin.c (c_cpp_builtins): Check _FloatN and\n \t_FloatNx types for suffixes for built-in functions.\n \n 2016-08-19  Joseph Myers  <joseph@codesourcery.com>\n@@ -2231,7 +2231,7 @@\n 2016-06-10  Martin Sebor  <msebor@redhat.com>\n \n \tPR c/71392\n-\t* gcc/c-family/c-common.c (handle_nonnull_attribute): Accept\n+\t* c-common.c (handle_nonnull_attribute): Accept\n \tthe nonnull attribute in type-generic builtins.\n \n 2016-06-09  Martin Sebor  <msebor@redhat.com>"}, {"sha": "504205dc7de0316f0b5d2c33308f28086de9ebbd", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=14ec014e7614d927f5365704a2defaa3b9f44328", "patch": "@@ -1,5 +1,10 @@\n 2017-12-22  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/83550\n+\t* c-decl.c (finish_struct): Set DECL_SOURCE_LOCATION on\n+\tTYPE_STUB_DECL and call rest_of_type_compilation before processing\n+\tincomplete vars rather than after it.\n+\n \tPR debug/83547\n \t* c-typeck.c (c_finish_stmt_expr): Ignore !TREE_SIDE_EFFECTS as\n \tindicator of ({ }), instead skip all trailing DEBUG_BEGIN_STMTs first,"}, {"sha": "846098ea8367c1f9c31c9ef70578ba8d6670f19d", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 8, "deletions": 8, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=14ec014e7614d927f5365704a2defaa3b9f44328", "patch": "@@ -8199,6 +8199,14 @@ finish_struct (location_t loc, tree t, tree fieldlist, tree attributes,\n       warning_at (loc, 0, \"union cannot be made transparent\");\n     }\n \n+  /* Update type location to the one of the definition, instead of e.g.\n+     a forward declaration.  */\n+  if (TYPE_STUB_DECL (t))\n+    DECL_SOURCE_LOCATION (TYPE_STUB_DECL (t)) = loc;\n+\n+  /* Finish debugging output for this type.  */\n+  rest_of_type_compilation (t, toplevel);\n+\n   /* If this structure or union completes the type of any previous\n      variable declaration, lay it out and output its rtl.  */\n   for (x = incomplete_vars; x; x = TREE_CHAIN (x))\n@@ -8215,14 +8223,6 @@ finish_struct (location_t loc, tree t, tree fieldlist, tree attributes,\n \t}\n     }\n \n-  /* Update type location to the one of the definition, instead of e.g.\n-     a forward declaration.  */\n-  if (TYPE_STUB_DECL (t))\n-    DECL_SOURCE_LOCATION (TYPE_STUB_DECL (t)) = loc;\n-\n-  /* Finish debugging output for this type.  */\n-  rest_of_type_compilation (t, toplevel);\n-\n   /* If we're inside a function proper, i.e. not file-scope and not still\n      parsing parameters, then arrange for the size of a variable sized type\n      to be bound now.  */"}, {"sha": "20b0349b93579958533b58ee12b2eff02df7585b", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=14ec014e7614d927f5365704a2defaa3b9f44328", "patch": "@@ -5471,10 +5471,10 @@\n 2017-01-27  Adam Butcher  <adam@jessamine.co.uk>\n \n \tPR c++/64382\n-\t* cp/parser.c (parsing_default_capturing_generic_lambda_in_template):\n+\t* parser.c (parsing_default_capturing_generic_lambda_in_template):\n \tNew function.\n-\t* cp/cp-tree.h: Declare it.\n-\t* cp/semantics.c (finish_id_expression): Resolve names within a default\n+\t* cp-tree.h: Declare it.\n+\t* semantics.c (finish_id_expression): Resolve names within a default\n \tcapturing generic lambda defined within a template prior to\n \tinstantiation to allow for captures to be added to the closure type.\n "}, {"sha": "c736ca24258c4861aff08e199aec7cea4ca58df4", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=14ec014e7614d927f5365704a2defaa3b9f44328", "patch": "@@ -1,5 +1,8 @@\n 2017-12-22  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR debug/83550\n+\t* c-c++-common/dwarf2/pr83550.c: New test.\n+\n \tPR debug/83547\n \t* gcc.c-torture/compile/pr83547.c: New test.\n "}, {"sha": "1d77e9530cdb21a3a941fa37a47768be9f71a84b", "filename": "gcc/testsuite/c-c++-common/dwarf2/pr83550.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fdwarf2%2Fpr83550.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14ec014e7614d927f5365704a2defaa3b9f44328/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fdwarf2%2Fpr83550.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fdwarf2%2Fpr83550.c?ref=14ec014e7614d927f5365704a2defaa3b9f44328", "patch": "@@ -0,0 +1,10 @@\n+/* PR debug/83550 */\n+/* { dg-do compile } */\n+/* { dg-options \"-gdwarf -dA -fno-merge-debug-strings\" } */\n+\n+struct my_struct;\n+extern struct my_struct s;\n+struct my_struct { int a, b; };\n+struct my_struct q;\n+\n+/* { dg-final { scan-assembler \"DW_TAG_structure_type\\[^\\\\r\\\\n\\]*\\[\\\\r\\\\n\\]+\\[^\\\\r\\\\n\\]*\\\"my_struct\\[^\\\\r\\\\n\\]*DW_AT_name(\\[^\\\\r\\\\n\\]*\\[\\\\r\\\\n\\]+\\[^\\\\r\\\\n\\]*DW_AT_)*\\[^\\\\r\\\\n\\]*\\[\\\\r\\\\n\\]+\\[^\\\\r\\\\n\\]*\\[^0-9a-fA-FxX](0x)?7\\[^0-9a-fA-FxX]\\[^\\\\r\\\\n\\]*DW_AT_decl_line\" } } */"}]}