{"sha": "693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0", "node_id": "C_kwDOANBUbNoAKDY5M2FiZGI2NmFiYTI1ZjNmYjI1YzNjZDhkNjVkYmI2NGVjZDM3YTA", "commit": {"author": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2021-10-23T00:22:00Z"}, "committer": {"name": "Sandra Loosemore", "email": "sandra@codesourcery.com", "date": "2021-10-23T00:25:08Z"}, "message": "Add testcase for PR fortran/95196\n\n2021-10-22  Jos\u00e9 Rui Faustino de Sousa  <jrfsousa@gmail.com>\n\t    Sandra Loosemore  <sandra@codesourcery.com>\n\n\tgcc/testsuite/\n\n\tPR fortran/95196\n\t* gfortran.dg/PR95196.f90: New.", "tree": {"sha": "ae0c0044562d71c21dbb72bf7dc34382a6fa5b87", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae0c0044562d71c21dbb72bf7dc34382a6fa5b87"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0/comments", "author": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "committer": {"login": "SandraLoosemore", "id": 104087111, "node_id": "U_kgDOBjQ-Rw", "avatar_url": "https://avatars.githubusercontent.com/u/104087111?v=4", "gravatar_id": "", "url": "https://api.github.com/users/SandraLoosemore", "html_url": "https://github.com/SandraLoosemore", "followers_url": "https://api.github.com/users/SandraLoosemore/followers", "following_url": "https://api.github.com/users/SandraLoosemore/following{/other_user}", "gists_url": "https://api.github.com/users/SandraLoosemore/gists{/gist_id}", "starred_url": "https://api.github.com/users/SandraLoosemore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/SandraLoosemore/subscriptions", "organizations_url": "https://api.github.com/users/SandraLoosemore/orgs", "repos_url": "https://api.github.com/users/SandraLoosemore/repos", "events_url": "https://api.github.com/users/SandraLoosemore/events{/privacy}", "received_events_url": "https://api.github.com/users/SandraLoosemore/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "c2bd5d8a30819db072286d4e22d74761462c8724", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c2bd5d8a30819db072286d4e22d74761462c8724", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c2bd5d8a30819db072286d4e22d74761462c8724"}], "stats": {"total": 83, "additions": 83, "deletions": 0}, "files": [{"sha": "14333e453a0f570785f1d038b2274b1b8f3908a7", "filename": "gcc/testsuite/gfortran.dg/PR95196.f90", "status": "added", "additions": 83, "deletions": 0, "changes": 83, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0/gcc%2Ftestsuite%2Fgfortran.dg%2FPR95196.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0/gcc%2Ftestsuite%2Fgfortran.dg%2FPR95196.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2FPR95196.f90?ref=693abdb66aba25f3fb25c3cd8d65dbb64ecd37a0", "patch": "@@ -0,0 +1,83 @@\n+! { dg-do run }\n+\n+program rnk_p\n+\n+  implicit none\n+\n+  integer, parameter :: n = 10\n+  integer, parameter :: m = 5\n+  integer, parameter :: s = 4\n+  integer, parameter :: l = 4\n+  integer, parameter :: u = s+l-1\n+  \n+  integer :: a(n)\n+  integer :: b(n,n)\n+  integer :: c(n,n,n)\n+  integer :: r(s*s*s)\n+  integer :: i\n+\n+  a = reshape([(i, i=1,n)], [n])\n+  b = reshape([(i, i=1,n*n)], [n,n])\n+  c = reshape([(i, i=1,n*n*n)], [n,n,n])\n+  r(1:s) = a(l:u)\n+  call rnk_s(a(l:u), r(1:s))\n+  r(1:s*s) = reshape(b(l:u,l:u), [s*s])\n+  call rnk_s(b(l:u,l:u), r(1:s*s))\n+  r = reshape(c(l:u,l:u,l:u), [s*s*s])\n+  call rnk_s(c(l:u,l:7,l:u), r)\n+  stop\n+  \n+contains\n+\n+  subroutine rnk_s(a, b)\n+    integer, intent(in) :: a(..)\n+    integer, intent(in) :: b(:)\n+    \n+    !integer :: l(rank(a)), u(rank(a)) does not work due to Bug 94048 \n+    integer, allocatable :: lb(:), ub(:)\n+    integer              :: i, j, k, l\n+\n+    lb = lbound(a)\n+    ub = ubound(a)\n+    select rank(a)\n+    rank(1)\n+      if(any(lb/=lbound(a))) stop 11\n+      if(any(ub/=ubound(a))) stop 12\n+      if(size(a)/=size(b))   stop 13\n+      do i = 1, size(a)\n+        if(a(i)/=b(i)) stop 14\n+      end do\n+    rank(2)\n+      if(any(lb/=lbound(a))) stop 21\n+      if(any(ub/=ubound(a))) stop 22\n+      if(size(a)/=size(b))   stop 23\n+      k = 0\n+      do j = 1, size(a, dim=2)\n+        do i = 1, size(a, dim=1)\n+          k = k + 1\n+          if(a(i,j)/=b(k)) stop 24\n+        end do\n+      end do\n+    rank(3)\n+      if(any(lb/=lbound(a))) stop 31\n+      if(any(ub/=ubound(a))) stop 32\n+      if(size(a)/=size(b))   stop 33\n+      l = 0\n+      do k = 1, size(a, dim=3)\n+        do j = 1, size(a, dim=2)\n+          do i = 1, size(a, dim=1)\n+            l = l + 1\n+            ! print *, a(i,j,k), b(l)\n+            if(a(i,j,k)/=b(l)) stop 34\n+          end do\n+        end do\n+      end do\n+    rank default\n+      stop 171\n+    end select\n+    deallocate(lb, ub)\n+    return\n+  end subroutine rnk_s\n+  \n+end program rnk_p\n+"}]}