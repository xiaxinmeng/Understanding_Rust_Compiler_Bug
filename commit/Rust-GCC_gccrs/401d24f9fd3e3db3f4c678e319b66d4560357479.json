{"sha": "401d24f9fd3e3db3f4c678e319b66d4560357479", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDAxZDI0ZjlmZDNlM2RiM2Y0YzY3OGUzMTliNjZkNDU2MDM1NzQ3OQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2005-05-08T09:24:45Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2005-05-08T09:24:45Z"}, "message": "mips.c (mips_emit_compare): Don't reverse UNGE and UNGT comparisons.\n\n\t* config/mips/mips.c (mips_emit_compare): Don't reverse UNGE and UNGT\n\tcomparisons.\n\t* config/mips/mips.md (swapped_fcond): New code macro and attribute.\n\t(sgt_<mode>, sge_<mode>): Generalize to all members of swapped_fcond,\n\tincluding sunge_<mode> and sungt_<mode>.\n\nFrom-SVN: r99380", "tree": {"sha": "03e7132737fec10446a1ca67c4cba365d42d8839", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/03e7132737fec10446a1ca67c4cba365d42d8839"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/401d24f9fd3e3db3f4c678e319b66d4560357479", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/401d24f9fd3e3db3f4c678e319b66d4560357479", "html_url": "https://github.com/Rust-GCC/gccrs/commit/401d24f9fd3e3db3f4c678e319b66d4560357479", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/401d24f9fd3e3db3f4c678e319b66d4560357479/comments", "author": null, "committer": null, "parents": [{"sha": "6356b546458da84c63596f9a377593de262e06bf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6356b546458da84c63596f9a377593de262e06bf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6356b546458da84c63596f9a377593de262e06bf"}], "stats": {"total": 53, "additions": 38, "deletions": 15}, "files": [{"sha": "66fa3611499c23558fe7eb5115bc49784739dc8d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=401d24f9fd3e3db3f4c678e319b66d4560357479", "patch": "@@ -1,3 +1,11 @@\n+2005-05-08  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config/mips/mips.c (mips_emit_compare): Don't reverse UNGE and UNGT\n+\tcomparisons.\n+\t* config/mips/mips.md (swapped_fcond): New code macro and attribute.\n+\t(sgt_<mode>, sge_<mode>): Generalize to all members of swapped_fcond,\n+\tincluding sunge_<mode> and sungt_<mode>.\n+\n 2005-05-08  Richard Sandiford  <rsandifo@redhat.com>\n \n \t* integrate.h (get_hard_reg_initial_val): Change type of register"}, {"sha": "824127a411d02f4c0d100a9b021c07dda969c869", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 0, "deletions": 2, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=401d24f9fd3e3db3f4c678e319b66d4560357479", "patch": "@@ -2802,8 +2802,6 @@ mips_emit_compare (enum rtx_code *code, rtx *op0, rtx *op1, bool need_eq_ne_p)\n       switch (*code)\n \t{\n \tcase NE:\n-\tcase UNGE:\n-\tcase UNGT:\n \tcase LTGT:\n \tcase ORDERED:\n \t  cmp_code = reverse_condition_maybe_unordered (*code);"}, {"sha": "e5963d4ada3c810a04c8535c340655f72ee6719d", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 14, "deletions": 13, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=401d24f9fd3e3db3f4c678e319b66d4560357479", "patch": "@@ -413,6 +413,10 @@\n ;; generated from the same template.\n (define_code_macro fcond [unordered uneq unlt unle eq lt le])\n \n+;; This code macro is used for comparisons that can be implemented\n+;; by swapping the operands.\n+(define_code_macro swapped_fcond [ge gt unge ungt])\n+\n ;; <u> expands to an empty string when doing a signed operation and\n ;; \"u\" when doing an unsigned operation.\n (define_code_attr u [(sign_extend \"\") (zero_extend \"u\")])\n@@ -438,6 +442,12 @@\n \t\t\t (eq \"eq\")\n \t\t\t (lt \"lt\")\n \t\t\t (le \"le\")])\n+\n+;; Similar, but for swapped conditions.\n+(define_code_attr swapped_fcond [(ge \"le\")\n+\t\t\t\t (gt \"lt\")\n+\t\t\t\t (unge \"ule\")\n+\t\t\t\t (ungt \"ult\")])\n \f\n ;; .........................\n ;;\n@@ -4576,21 +4586,12 @@ beq\\t%2,%.,1b\\;\\\n   [(set_attr \"type\" \"fcmp\")\n    (set_attr \"mode\" \"FPSW\")])\n \n-(define_insn \"sgt_<mode>\"\n-  [(set (match_operand:CC 0 \"register_operand\" \"=z\")\n-\t(gt:CC (match_operand:SCALARF 1 \"register_operand\" \"f\")\n-\t       (match_operand:SCALARF 2 \"register_operand\" \"f\")))]\n-  \"\"\n-  \"c.lt.<fmt>\\t%Z0%2,%1\"\n-  [(set_attr \"type\" \"fcmp\")\n-   (set_attr \"mode\" \"FPSW\")])\n-\n-(define_insn \"sge_<mode>\"\n+(define_insn \"s<code>_<mode>\"\n   [(set (match_operand:CC 0 \"register_operand\" \"=z\")\n-\t(ge:CC (match_operand:SCALARF 1 \"register_operand\" \"f\")\n-\t       (match_operand:SCALARF 2 \"register_operand\" \"f\")))]\n+\t(swapped_fcond:CC (match_operand:SCALARF 1 \"register_operand\" \"f\")\n+\t\t          (match_operand:SCALARF 2 \"register_operand\" \"f\")))]\n   \"\"\n-  \"c.le.<fmt>\\t%Z0%2,%1\"\n+  \"c.<swapped_fcond>.<fmt>\\t%Z0%2,%1\"\n   [(set_attr \"type\" \"fcmp\")\n    (set_attr \"mode\" \"FPSW\")])\n \f"}, {"sha": "fb78b25e069c60c61f0aa009c787488c6860350a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=401d24f9fd3e3db3f4c678e319b66d4560357479", "patch": "@@ -1,3 +1,7 @@\n+2005-05-08  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* gcc.target/mips/fpcmp-[12].c: New tests.\n+\n 2005-05-06  Mark Mitchell  <mark@codesourcery.com>\n \n \t* lib/target-supports-dg.exp (dg-require-fork): New function."}, {"sha": "b5d087671fdd75c82bf32e9b6c377d7593a28664", "filename": "gcc/testsuite/gcc.target/mips/fpcmp-1.c", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Ffpcmp-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Ffpcmp-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Ffpcmp-1.c?ref=401d24f9fd3e3db3f4c678e319b66d4560357479", "patch": "@@ -0,0 +1,6 @@\n+/* We used to use c.lt.fmt instead of c.ule.fmt here.  */\n+/* { dg-options \"-mhard-float -O2\" } */\n+int f1 (float x, float y) { return __builtin_isless (x, y); }\n+int f2 (double x, double y) { return __builtin_isless (x, y); }\n+/* { dg-final { scan-assembler \"c\\\\.ule\\\\.s\" } } */\n+/* { dg-final { scan-assembler \"c\\\\.ule\\\\.d\" } } */"}, {"sha": "94027a8a0911a7f0eb2c8abec4c0d3d222363f20", "filename": "gcc/testsuite/gcc.target/mips/fpcmp-2.c", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Ffpcmp-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/401d24f9fd3e3db3f4c678e319b66d4560357479/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Ffpcmp-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fmips%2Ffpcmp-2.c?ref=401d24f9fd3e3db3f4c678e319b66d4560357479", "patch": "@@ -0,0 +1,6 @@\n+/* We used to use c.le.fmt instead of c.ult.fmt here.  */\n+/* { dg-options \"-mhard-float -O2\" } */\n+int f1 (float x, float y) { return __builtin_islessequal (x, y); }\n+int f2 (double x, double y) { return __builtin_islessequal (x, y); }\n+/* { dg-final { scan-assembler \"c\\\\.ult\\\\.s\" } } */\n+/* { dg-final { scan-assembler \"c\\\\.ult\\\\.d\" } } */"}]}