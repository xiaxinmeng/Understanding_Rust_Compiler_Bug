{"sha": "3beeebd6934654f3453209730b98c7a1fd0305b6", "node_id": "C_kwDOANBUbNoAKDNiZWVlYmQ2OTM0NjU0ZjM0NTMyMDk3MzBiOThjN2ExZmQwMzA1YjY", "commit": {"author": {"name": "Costas Argyris", "email": "costas.argyris@gmail.com", "date": "2023-04-12T07:48:18Z"}, "committer": {"name": "Jonathan Yong", "email": "10walls@gmail.com", "date": "2023-04-12T14:35:33Z"}, "message": "mingw: Support building with older gcc versions\n\nThe $@ argument to the compiler is causing\nonly a warning in some gcc versions but an\nerror in others. In any case, $@ was never\nnecessary so remove it completely, just like\nthe rules in x-mingw32 where the object file\ngets named after the source file.\n\nThis fixes both warnings and errors about\nsym-mingw32.o appearing in the command line\nunnecessarily.\n\nThe -nostdlib flag is required along with -r\nfor older gcc versions that don't apply it\nautomatically with -r, resulting in main\nfunctions erroneously entering a partial link.\n\nSigned-off-by: Jonathan Yong <10walls@gmail.com>\n\ngcc/ChangeLog:\n\n\t* config/i386/x-mingw32-utf8: Remove extrataneous $@", "tree": {"sha": "ee01b276eba9f13284d1880794371e7ba6cca8c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee01b276eba9f13284d1880794371e7ba6cca8c1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3beeebd6934654f3453209730b98c7a1fd0305b6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3beeebd6934654f3453209730b98c7a1fd0305b6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3beeebd6934654f3453209730b98c7a1fd0305b6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3beeebd6934654f3453209730b98c7a1fd0305b6/comments", "author": null, "committer": {"login": "jon-y", "id": 4688224, "node_id": "MDQ6VXNlcjQ2ODgyMjQ=", "avatar_url": "https://avatars.githubusercontent.com/u/4688224?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jon-y", "html_url": "https://github.com/jon-y", "followers_url": "https://api.github.com/users/jon-y/followers", "following_url": "https://api.github.com/users/jon-y/following{/other_user}", "gists_url": "https://api.github.com/users/jon-y/gists{/gist_id}", "starred_url": "https://api.github.com/users/jon-y/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jon-y/subscriptions", "organizations_url": "https://api.github.com/users/jon-y/orgs", "repos_url": "https://api.github.com/users/jon-y/repos", "events_url": "https://api.github.com/users/jon-y/events{/privacy}", "received_events_url": "https://api.github.com/users/jon-y/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "56529056cb42baa382c40de7d239d02dbf72c94f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56529056cb42baa382c40de7d239d02dbf72c94f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56529056cb42baa382c40de7d239d02dbf72c94f"}], "stats": {"total": 6, "additions": 4, "deletions": 2}, "files": [{"sha": "b5a6cfcf7023467e274685202c7966c33b0ade03", "filename": "gcc/config/i386/x-mingw32-utf8", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3beeebd6934654f3453209730b98c7a1fd0305b6/gcc%2Fconfig%2Fi386%2Fx-mingw32-utf8", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3beeebd6934654f3453209730b98c7a1fd0305b6/gcc%2Fconfig%2Fi386%2Fx-mingw32-utf8", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fx-mingw32-utf8?ref=3beeebd6934654f3453209730b98c7a1fd0305b6", "patch": "@@ -34,7 +34,7 @@ utf8rc-mingw32.o : $(srcdir)/config/i386/utf8-mingw32.rc \\\n # Create an object file that just exports the global symbol\n # HOST_EXTRA_OBJS_SYMBOL\n sym-mingw32.o : $(srcdir)/config/i386/sym-mingw32.cc\n-\t$(COMPILER) -c $< $@\n+\t$(COMPILER) -c $<\n \n # Combine the two object files into one which has both the\n # compiled utf8 resource and the HOST_EXTRA_OBJS_SYMBOL symbol.\n@@ -44,8 +44,10 @@ sym-mingw32.o : $(srcdir)/config/i386/sym-mingw32.cc\n # If nothing references it into libbackend.a, it will not\n # get linked into the compiler proper eventually.\n # Therefore we need to request the symbol at compiler link time.\n+# -nostdlib is required for supporting old gcc versions that\n+# don't apply it automatically with -r.\n utf8-mingw32.o : utf8rc-mingw32.o sym-mingw32.o\n-\t$(COMPILER) -r utf8rc-mingw32.o sym-mingw32.o -o $@\n+\t$(COMPILER) -r -nostdlib utf8rc-mingw32.o sym-mingw32.o -o $@\n \n # Force compilers to link against the utf8 resource by\n # requiring the symbol to be defined."}]}