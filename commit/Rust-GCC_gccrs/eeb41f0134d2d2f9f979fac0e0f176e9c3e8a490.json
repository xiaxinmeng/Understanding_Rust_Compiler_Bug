{"sha": "eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWViNDFmMDEzNGQyZDJmOWY5NzlmYWMwZTBmMTc2ZTljM2U4YTQ5MA==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2010-06-22T13:43:47Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2010-06-22T13:43:47Z"}, "message": "clean.adb (Parse_Cmd_Line): Recognize switch --unchecked-shared-lib-imports.\n\n2010-06-22  Vincent Celier  <celier@adacore.com>\n\n\t* clean.adb (Parse_Cmd_Line): Recognize switch\n\t--unchecked-shared-lib-imports.\n\t(Usage): Add line for switch --unchecked-shared-lib-imports\n\t* makeusg.adb: Add line for switch --unchecked-shared-lib-imports\n\t* makeutl.ads: (Unchecked_Shared_Lib_Imports): New constant string\n\tmoved from GPR_Util.\n\t* switch-m.adb (Scan_Make_Switches): Recognize switch\n\t--unchecked-shared-lib-imports.\n\t* vms_data.ads: Add VMS qualifiers /UNCHECKED_SHARED_LIB_IMPORTS.\n\t* gnat_ugn.texi: Add documentation for new switch\n\t--unchecked-shared-lib-imports.  Add also documentation for --subdirs.\n\nFrom-SVN: r161186", "tree": {"sha": "35d73cf3d603d8b38d9f1779803f717db585af8e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/35d73cf3d603d8b38d9f1779803f717db585af8e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a8ecfc9f2c532fdf26326b1f65fef3323fc2ad47", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a8ecfc9f2c532fdf26326b1f65fef3323fc2ad47", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a8ecfc9f2c532fdf26326b1f65fef3323fc2ad47"}], "stats": {"total": 82, "additions": 77, "deletions": 5}, "files": [{"sha": "4a3d5ef4d7c976031ebaec3568845c92aa17d914", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "patch": "@@ -1,3 +1,17 @@\n+2010-06-22  Vincent Celier  <celier@adacore.com>\n+\n+\t* clean.adb (Parse_Cmd_Line): Recognize switch\n+\t--unchecked-shared-lib-imports.\n+\t(Usage): Add line for switch --unchecked-shared-lib-imports\n+\t* makeusg.adb: Add line for switch --unchecked-shared-lib-imports\n+\t* makeutl.ads: (Unchecked_Shared_Lib_Imports): New constant string\n+\tmoved from GPR_Util.\n+\t* switch-m.adb (Scan_Make_Switches): Recognize switch\n+\t--unchecked-shared-lib-imports.\n+\t* vms_data.ads: Add VMS qualifiers /UNCHECKED_SHARED_LIB_IMPORTS.\n+\t* gnat_ugn.texi: Add documentation for new switch\n+\t--unchecked-shared-lib-imports.  Add also documentation for --subdirs.\n+\n 2010-06-22  Javier Miranda  <miranda@adacore.com>\n \n \t* sem_prag.adb, sem_util.adb, sem_util.ads, sem_attr.adb, exp_ch6.adb,"}, {"sha": "54497274f2d26e552bd2cc3354f0926bdeeeffc7", "filename": "gcc/ada/clean.adb", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fclean.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fclean.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fclean.adb?ref=eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2003-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2003-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -1677,6 +1677,9 @@ package body Clean is\n                              new String'\n                                (Arg (Subdirs_Option'Length + 1 .. Arg'Last));\n \n+                        elsif Arg = Makeutl.Unchecked_Shared_Lib_Imports then\n+                           Opt.Unchecked_Shared_Lib_Imports := True;\n+\n                         else\n                            Bad_Argument;\n                         end if;\n@@ -1957,6 +1960,8 @@ package body Clean is\n          New_Line;\n \n          Put_Line (\"  --subdirs=dir real obj/lib/exec dirs are subdirs\");\n+         Put_Line (\"  \" & Makeutl.Unchecked_Shared_Lib_Imports);\n+         Put_Line (\"       Allow shared libraries to import static libraries\");\n          New_Line;\n \n          Put_Line (\"  -c       Only delete compiler generated files\");"}, {"sha": "e93e287c40f65b8f035c96fde63bc24f08b478f1", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "patch": "@@ -9193,6 +9193,15 @@ itself must not include any embedded spaces.\n \n @end ifclear\n \n+@item ^--subdirs^/SUBDIRS^=subdir\n+Actual object directory of each project file is the subdirectory subdir of the\n+object directory specified or defauted in the project file.\n+\n+@item ^--unchecked-shared-lib-imports^/UNCHECKED_SHARED_LIB_IMPORTS^\n+By default, shared library projects are not allowed to import static library\n+projects. When this switch is used on the command line, this restriction is\n+relaxed.\n+\n @item ^-a^/ALL_FILES^\n @cindex @option{^-a^/ALL_FILES^} (@command{gnatmake})\n Consider all files in the make process, even the GNAT internal system\n@@ -15329,6 +15338,15 @@ Display Copyright and version, then exit disregarding all other options.\n If @option{--version} was not used, display usage, then exit disregarding\n all other options.\n \n+@item ^--subdirs^/SUBDIRS^=subdir\n+Actual object directory of each project file is the subdirectory subdir of the\n+object directory specified or defauted in the project file.\n+\n+@item ^--unchecked-shared-lib-imports^/UNCHECKED_SHARED_LIB_IMPORTS^\n+By default, shared library projects are not allowed to import static library\n+projects. When this switch is used on the command line, this restriction is\n+relaxed.\n+\n @item ^-c^/COMPILER_FILES_ONLY^\n @cindex @option{^-c^/COMPILER_FILES_ONLY^} (@code{gnatclean})\n Only attempt to delete the files produced by the compiler, not those produced"}, {"sha": "acacba9fdaedd22a923486fe84344c1b2d1a02bd", "filename": "gcc/ada/makeusg.adb", "status": "modified", "additions": 10, "deletions": 1, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fmakeusg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fmakeusg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakeusg.adb?ref=eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2008, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1992-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -23,6 +23,7 @@\n --                                                                          --\n ------------------------------------------------------------------------------\n \n+with Makeutl;\n with Osint;  use Osint;\n with Output; use Output;\n with Usage;\n@@ -311,6 +312,14 @@ begin\n \n    Write_Str (\"  --subdirs=dir real obj/lib/exec dirs are subdirs\");\n    Write_Eol;\n+\n+   --  Line for --unchecked-shared-lib-imports\n+\n+   Write_Str (\"  \");\n+   Write_Str (Makeutl.Unchecked_Shared_Lib_Imports);\n+   Write_Eol;\n+   Write_Str (\"            Allow shared libraries to import static libraries\");\n+   Write_Eol;\n    Write_Eol;\n \n    --  General Compiler, Binder, Linker switches"}, {"sha": "fd286a8ebcc778f2258d7c9c0223120b5701e294", "filename": "gcc/ada/makeutl.ads", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fmakeutl.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fmakeutl.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakeutl.ads?ref=eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 2004-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2004-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -47,6 +47,11 @@ package Makeutl is\n    --  Switch used to indicate that the real directories (object, exec,\n    --  library, ...) are subdirectories of those in the project file.\n \n+   Unchecked_Shared_Lib_Imports : constant String :=\n+                                    \"--unchecked-shared-lib-imports\";\n+   --  Command line switch to allow shared library projects to import projects\n+   --  that are not shared library projects.\n+\n    procedure Add\n      (Option : String_Access;\n       To     : in out String_List_Access;"}, {"sha": "b8beebff780485686471b7108231cf48d7118630", "filename": "gcc/ada/switch-m.adb", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fswitch-m.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fswitch-m.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fswitch-m.adb?ref=eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 2001-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 2001-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -584,6 +584,9 @@ package body Switch.M is\n                   (Switch_Chars'First + Subdirs_Option'Length ..\n                    Switch_Chars'Last));\n \n+         elsif Switch_Chars = Makeutl.Unchecked_Shared_Lib_Imports then\n+            Opt.Unchecked_Shared_Lib_Imports := True;\n+\n          elsif Switch_Chars (Ptr) = '-' then\n             Bad_Switch (Switch_Chars);\n "}, {"sha": "fdfe19dd59a92055c33bab6e9d7a3d4b9002f1b8", "filename": "gcc/ada/vms_data.ads", "status": "modified", "additions": 19, "deletions": 1, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fvms_data.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490/gcc%2Fada%2Fvms_data.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fvms_data.ads?ref=eeb41f0134d2d2f9f979fac0e0f176e9c3e8a490", "patch": "@@ -1154,6 +1154,14 @@ package VMS_Data is\n    --   of the directory specified in the project file. If the subdirectory\n    --   does not exist, it is created automatically.\n \n+   S_Clean_Unc_Shared_Libs : aliased constant S :=\n+                                          \"/UNCHECKED_SHARED_LIB_IMPORTS \" &\n+                                              \"--unchecked-shared-lib-imports\";\n+   --        /NOUNCHECKED_SHARED_LIB_IMPORTS (D)\n+   --        /UNCHECKED_SHARED_LIB_IMPORTS\n+   --\n+   --   Allow shared library projects to import static library projects\n+\n    S_Clean_Verbose : aliased constant S := \"/VERBOSE \"                     &\n                                             \"-v\";\n    --        /NOVERBOSE (D)\n@@ -1179,7 +1187,8 @@ package VMS_Data is\n                        S_Clean_Recurs 'Access,\n                        S_Clean_Search 'Access,\n                        S_Clean_Subdirs'Access,\n-                       S_Clean_Verbose'Access);\n+                       S_Clean_Verbose'Access,\n+                       S_Clean_Unc_Shared_Libs'Access);\n \n    -------------------------------\n    -- Switches for GNAT COMPILE --\n@@ -4860,6 +4869,14 @@ package VMS_Data is\n    --   For example, -O -O2 is different than -O2 -O, but -g -O is equivalent\n    --   to -O -g.\n \n+   S_Make_Unc_Shared_Libs : aliased constant S :=\n+                                          \"/UNCHECKED_SHARED_LIB_IMPORTS \" &\n+                                              \"--unchecked-shared-lib-imports\";\n+   --        /NOUNCHECKED_SHARED_LIB_IMPORTS (D)\n+   --        /UNCHECKED_SHARED_LIB_IMPORTS\n+   --\n+   --   Allow shared library projects to import static library projects\n+\n    S_Make_Unique  : aliased constant S := \"/UNIQUE \"                       &\n                                             \"-u\";\n    --        /NOUNIQUE (D)\n@@ -4937,6 +4954,7 @@ package VMS_Data is\n                       S_Make_Stand   'Access,\n                       S_Make_Subdirs 'Access,\n                       S_Make_Switch  'Access,\n+                      S_Make_Unc_Shared_Libs'Access,\n                       S_Make_Unique  'Access,\n                       S_Make_Use_Map 'Access,\n                       S_Make_Verbose 'Access);"}]}