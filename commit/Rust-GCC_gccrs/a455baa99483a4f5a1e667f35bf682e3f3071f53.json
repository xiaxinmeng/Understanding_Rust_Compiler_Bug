{"sha": "a455baa99483a4f5a1e667f35bf682e3f3071f53", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTQ1NWJhYTk5NDgzYTRmNWExZTY2N2YzNWJmNjgyZTNmMzA3MWY1Mw==", "commit": {"author": {"name": "Uros Bizjak", "email": "ubizjak@gmail.com", "date": "2016-12-29T21:41:07Z"}, "committer": {"name": "Uros Bizjak", "email": "uros@gcc.gnu.org", "date": "2016-12-29T21:41:07Z"}, "message": "re PR target/78904 (zero-extracts are not effective)\n\n\tPR target/78904\n\t* config/i386/i386.md (*extvqi): Remove insn pattern.\n\t(divmodqi4): Update expander to generate QImode zero-extract from AH.\n\ntestsuite/ChangeLog:\n\n\n\tPR target/78904\n\t* gcc.target/i386/pr78904-6.c: New test.\n\nFrom-SVN: r243968", "tree": {"sha": "3429e240878ad3f1f8637215c6971fd52e431d4a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3429e240878ad3f1f8637215c6971fd52e431d4a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a455baa99483a4f5a1e667f35bf682e3f3071f53", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a455baa99483a4f5a1e667f35bf682e3f3071f53", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a455baa99483a4f5a1e667f35bf682e3f3071f53", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a455baa99483a4f5a1e667f35bf682e3f3071f53/comments", "author": {"login": "ubizjak", "id": 55479990, "node_id": "MDQ6VXNlcjU1NDc5OTkw", "avatar_url": "https://avatars.githubusercontent.com/u/55479990?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ubizjak", "html_url": "https://github.com/ubizjak", "followers_url": "https://api.github.com/users/ubizjak/followers", "following_url": "https://api.github.com/users/ubizjak/following{/other_user}", "gists_url": "https://api.github.com/users/ubizjak/gists{/gist_id}", "starred_url": "https://api.github.com/users/ubizjak/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ubizjak/subscriptions", "organizations_url": "https://api.github.com/users/ubizjak/orgs", "repos_url": "https://api.github.com/users/ubizjak/repos", "events_url": "https://api.github.com/users/ubizjak/events{/privacy}", "received_events_url": "https://api.github.com/users/ubizjak/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2ae2d394c1f9928fcb4bb7efdf9874edb787936a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ae2d394c1f9928fcb4bb7efdf9874edb787936a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ae2d394c1f9928fcb4bb7efdf9874edb787936a"}], "stats": {"total": 62, "additions": 34, "deletions": 28}, "files": [{"sha": "517c50511d9762c369a503acbabffe3d0b14255d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a455baa99483a4f5a1e667f35bf682e3f3071f53", "patch": "@@ -1,3 +1,9 @@\n+2016-12-29  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/78904\n+\t* config/i386/i386.md (*extvqi): Remove insn pattern.\n+\t(divmodqi4): Update expander to generate QImode zero-extract from AH.\n+\n 2016-12-29  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \t* config/rs6000/rs6000.c (altivec_expand_builtin): Fix typos in"}, {"sha": "0f0bf7a393af8bfafe6e7755b94f51d97aed519f", "filename": "gcc/config/i386/i386.md", "status": "modified", "additions": 2, "deletions": 28, "changes": 30, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2Fconfig%2Fi386%2Fi386.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2Fconfig%2Fi386%2Fi386.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.md?ref=a455baa99483a4f5a1e667f35bf682e3f3071f53", "patch": "@@ -2780,33 +2780,6 @@\n   [(set_attr \"type\" \"imovx\")\n    (set_attr \"mode\" \"SI\")])\n \n-(define_insn \"*extvqi\"\n-  [(set (match_operand:QI 0 \"nonimmediate_operand\" \"=QBc,?R,m\")\n-        (sign_extract:QI (match_operand 1 \"ext_register_operand\" \"Q,Q,Q\")\n-                         (const_int 8)\n-                         (const_int 8)))]\n-  \"\"\n-{\n-  switch (get_attr_type (insn))\n-    {\n-    case TYPE_IMOVX:\n-      return \"movs{bl|x}\\t{%h1, %k0|%k0, %h1}\";\n-    default:\n-      return \"mov{b}\\t{%h1, %0|%0, %h1}\";\n-    }\n-}\n-  [(set_attr \"isa\" \"*,*,nox64\")\n-   (set (attr \"type\")\n-     (if_then_else (and (match_operand:QI 0 \"register_operand\")\n-\t\t\t(ior (not (match_operand:QI 0 \"QIreg_operand\"))\n-\t\t\t     (match_test \"TARGET_MOVX\")))\n-\t(const_string \"imovx\")\n-\t(const_string \"imov\")))\n-   (set (attr \"mode\")\n-     (if_then_else (eq_attr \"type\" \"imovx\")\n-\t(const_string \"SI\")\n-\t(const_string \"QI\")))])\n-\n (define_expand \"extzv<mode>\"\n   [(set (match_operand:SWI248 0 \"register_operand\")\n \t(zero_extract:SWI248 (match_operand:SWI248 1 \"register_operand\")\n@@ -7586,7 +7559,8 @@\n   emit_insn (gen_divmodhiqi3 (tmp0, tmp1, operands[2]));\n \n   /* Extract remainder from AH.  */\n-  tmp1 = gen_rtx_SIGN_EXTRACT (QImode, tmp0, GEN_INT (8), GEN_INT (8));\n+  tmp1 = gen_rtx_ZERO_EXTRACT (SImode, tmp0, GEN_INT (8), GEN_INT (8));\n+  tmp1 = gen_rtx_SUBREG (QImode, tmp1, 0);\n   rtx_insn *insn = emit_move_insn (operands[3], tmp1);\n \n   mod = gen_rtx_MOD (QImode, operands[1], operands[2]);"}, {"sha": "dc47c623376589ac334ec1d3d25682d72208983a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a455baa99483a4f5a1e667f35bf682e3f3071f53", "patch": "@@ -1,3 +1,8 @@\n+2016-12-29  Uros Bizjak  <ubizjak@gmail.com>\n+\n+\tPR target/78904\n+\t* gcc.target/i386/pr78904-6.c: New test.\n+\n 2016-12-29  Jakub Jelinek  <jakub@redhat.com>\n \n \t* gcc.target/i386/mpx/memcpy-1.c: Include mpx-check.h."}, {"sha": "2fad2239a33f32386ee6a37764b69379155fa3c0", "filename": "gcc/testsuite/gcc.target/i386/pr78904-6.c", "status": "added", "additions": 21, "deletions": 0, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78904-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a455baa99483a4f5a1e667f35bf682e3f3071f53/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78904-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr78904-6.c?ref=a455baa99483a4f5a1e667f35bf682e3f3071f53", "patch": "@@ -0,0 +1,21 @@\n+/* PR target/78904 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -masm=att\" } */\n+\n+typedef __SIZE_TYPE__ size_t;\n+\n+struct S1\n+{\n+  char pad1;\n+  char val;\n+  short pad2;\n+};\n+\n+extern char t[256];\n+\n+void foo (struct S1 a, size_t i)\n+{\n+  t[i] = a.val;\n+}\n+\n+/* { dg-final { scan-assembler \"\\[ \\t\\]movb\\[\\t \\]*%.h,\" } } */"}]}