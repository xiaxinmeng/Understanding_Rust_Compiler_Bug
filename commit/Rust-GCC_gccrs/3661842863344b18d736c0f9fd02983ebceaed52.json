{"sha": "3661842863344b18d736c0f9fd02983ebceaed52", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzY2MTg0Mjg2MzM0NGIxOGQ3MzZjMGY5ZmQwMjk4M2ViY2VhZWQ1Mg==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2017-03-09T16:58:17Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2017-03-09T16:58:17Z"}, "message": "re PR sanitizer/79757 (ICE in declare_vars, at gimplify.c:634)\n\n\tPR sanitizer/79757\n\t* c-parser.c (c_parser_declaration_or_fndef): Don't sanitize old-style\n\tparameter declarations with initializers.\n\n\t* gcc.dg/ubsan/pr79757-1.c: New test.\n\t* gcc.dg/ubsan/pr79757-2.c: New test.\n\t* gcc.dg/ubsan/pr79757-3.c: New test.\n\t* gcc.dg/ubsan/pr79757-4.c: New test.\n\t* gcc.dg/ubsan/pr79757-5.c: New test.\n\nFrom-SVN: r246010", "tree": {"sha": "3e36b6d392adffb0a06df6a6ae4f007457281828", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3e36b6d392adffb0a06df6a6ae4f007457281828"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3661842863344b18d736c0f9fd02983ebceaed52", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3661842863344b18d736c0f9fd02983ebceaed52", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3661842863344b18d736c0f9fd02983ebceaed52", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3661842863344b18d736c0f9fd02983ebceaed52/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "01e5af5a2f5fa4813e359bc03d42e98d091c7a2d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01e5af5a2f5fa4813e359bc03d42e98d091c7a2d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01e5af5a2f5fa4813e359bc03d42e98d091c7a2d"}], "stats": {"total": 145, "additions": 145, "deletions": 0}, "files": [{"sha": "c461c6dbb62a8f1cd224321c61dd597a924deeea", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -1,3 +1,9 @@\n+2017-03-09  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR sanitizer/79757\n+\t* c-parser.c (c_parser_declaration_or_fndef): Don't sanitize old-style\n+\tparameter declarations with initializers.\n+\n 2017-03-09  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/79969"}, {"sha": "1394f18b844f3a4083d2d9c00e6f07a23490ddf4", "filename": "gcc/c/c-parser.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Fc%2Fc-parser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Fc%2Fc-parser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-parser.c?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -1859,7 +1859,13 @@ c_parser_declaration_or_fndef (c_parser *parser, bool fndef_ok,\n \t\t  init_loc = c_parser_peek_token (parser)->location;\n \t\t  rich_location richloc (line_table, init_loc);\n \t\t  start_init (NULL_TREE, asm_name, global_bindings_p (), &richloc);\n+\t\t  /* A parameter is initialized, which is invalid.  Don't\n+\t\t     attempt to instrument the initializer.  */\n+\t\t  int flag_sanitize_save = flag_sanitize;\n+\t\t  if (nested && !empty_ok)\n+\t\t    flag_sanitize = 0;\n \t\t  init = c_parser_expr_no_commas (parser, NULL);\n+\t\t  flag_sanitize = flag_sanitize_save;\n \t\t  if (TREE_CODE (init.value) == COMPONENT_REF\n \t\t      && DECL_C_BIT_FIELD (TREE_OPERAND (init.value, 1)))\n \t\t    error_at (here,\n@@ -1917,7 +1923,13 @@ c_parser_declaration_or_fndef (c_parser *parser, bool fndef_ok,\n \t\t  init_loc = c_parser_peek_token (parser)->location;\n \t\t  rich_location richloc (line_table, init_loc);\n \t\t  start_init (d, asm_name, global_bindings_p (), &richloc);\n+\t\t  /* A parameter is initialized, which is invalid.  Don't\n+\t\t     attempt to instrument the initializer.  */\n+\t\t  int flag_sanitize_save = flag_sanitize;\n+\t\t  if (TREE_CODE (d) == PARM_DECL)\n+\t\t    flag_sanitize = 0;\n \t\t  init = c_parser_initializer (parser);\n+\t\t  flag_sanitize = flag_sanitize_save;\n \t\t  finish_init ();\n \t\t}\n \t      if (oacc_routine_data)"}, {"sha": "3da89cd3c6bb61275f0ada8a17c2bf4b12347e5f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -1,3 +1,12 @@\n+2017-03-09  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR sanitizer/79757\n+\t* gcc.dg/ubsan/pr79757-1.c: New test.\n+\t* gcc.dg/ubsan/pr79757-2.c: New test.\n+\t* gcc.dg/ubsan/pr79757-3.c: New test.\n+\t* gcc.dg/ubsan/pr79757-4.c: New test.\n+\t* gcc.dg/ubsan/pr79757-5.c: New test.\n+\n 2017-03-09  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/79969"}, {"sha": "ca074bcff46565403f2e0cca3c402e031469343a", "filename": "gcc/testsuite/gcc.dg/ubsan/pr79757-1.c", "status": "added", "additions": 24, "deletions": 0, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-1.c?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -0,0 +1,24 @@\n+/* PR sanitizer/79757 */\n+/* { dg-do compile } */\n+/* { dg-require-effective-target int128 } */\n+/* { dg-options \"-fsanitize=undefined\" } */\n+\n+unsigned __int128 x, y;\n+\n+void\n+fn1 (void)\n+{\n+  int a (z)\n+    unsigned long long z = x / y; /* { dg-error \"parameter 'z' is initialized\" } */\n+  {\n+  }\n+}\n+\n+void\n+fn2 (void)\n+{\n+  int a (z)\n+    unsigned long long z = x >> y; /* { dg-error \"parameter 'z' is initialized\" } */\n+  {\n+  }\n+}"}, {"sha": "b3e1939a547fed902cc2d67fe9a96771a82c1763", "filename": "gcc/testsuite/gcc.dg/ubsan/pr79757-2.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-2.c?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -0,0 +1,18 @@\n+/* PR sanitizer/79757 */\n+/* { dg-do compile } */\n+/* { dg-require-effective-target int128 } */\n+/* { dg-options \"-fsanitize=undefined\" } */\n+\n+unsigned __int128 x, y;\n+\n+void\n+fn1 (z)\n+  unsigned long long z = x / y; /* { dg-error \"parameter 'z' is initialized\" } */\n+{\n+}\n+\n+void\n+fn2 (z)\n+  unsigned long long z = x >> y; /* { dg-error \"parameter 'z' is initialized\" } */\n+{\n+}"}, {"sha": "22fe3deef2dadd504e898937d5df5dd90fb67349", "filename": "gcc/testsuite/gcc.dg/ubsan/pr79757-3.c", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-3.c?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -0,0 +1,18 @@\n+/* PR sanitizer/79757 */\n+/* { dg-do compile } */\n+/* { dg-require-effective-target int128 } */\n+/* { dg-options \"-fsanitize=undefined\" } */\n+\n+unsigned __int128 x, y;\n+\n+void\n+fn1 (z)\n+  __auto_type z = x / y; /* { dg-error \"parameter 'z' is initialized\" } */\n+{\n+}\n+\n+void\n+fn2 (z)\n+  __auto_type z = x >> y; /* { dg-error \"parameter 'z' is initialized\" } */\n+{\n+}"}, {"sha": "33b348f1d987032050761ed6ccd4eea483250245", "filename": "gcc/testsuite/gcc.dg/ubsan/pr79757-4.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-4.c?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -0,0 +1,29 @@\n+/* PR sanitizer/79757 */\n+/* { dg-do run } */\n+/* { dg-skip-if \"\" { *-*-* } { \"*\" } { \"-O2\" } } */\n+/* { dg-options \"-fsanitize=undefined\" } */\n+\n+int\n+main (void)\n+{\n+  int\n+  div (int n)\n+  {\n+    int i = 5 / n;\n+    return i;\n+  }\n+\n+  int\n+  shift (int n)\n+  {\n+    int i = 5 << n;\n+    return i;\n+  }\n+\n+  int j = shift (100);\n+  int i = div (0);\n+  return 0;\n+}\n+\n+/* { dg-output \"shift exponent 100 is too large for \\[^\\n\\r]*-bit type 'int'\\[^\\n\\r]*(\\n|\\r\\n|\\r)\" } */\n+/* { dg-output \"\\[^\\n\\r]*division by zero\" } */"}, {"sha": "786d81751ad5acb4e3f66212b9d718b9d4600d70", "filename": "gcc/testsuite/gcc.dg/ubsan/pr79757-5.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3661842863344b18d736c0f9fd02983ebceaed52/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fubsan%2Fpr79757-5.c?ref=3661842863344b18d736c0f9fd02983ebceaed52", "patch": "@@ -0,0 +1,29 @@\n+/* PR sanitizer/79757 */\n+/* { dg-do run } */\n+/* { dg-skip-if \"\" { *-*-* } { \"*\" } { \"-O2\" } } */\n+/* { dg-options \"-fsanitize=undefined\" } */\n+\n+int\n+main (void)\n+{\n+  int\n+  div (int n)\n+  {\n+    __auto_type i = 5 / n;\n+    return i;\n+  }\n+\n+  int\n+  shift (int n)\n+  {\n+    __auto_type i = 5 << n;\n+    return i;\n+  }\n+\n+  int j = shift (100);\n+  int i = div (0);\n+  return 0;\n+}\n+\n+/* { dg-output \"shift exponent 100 is too large for \\[^\\n\\r]*-bit type 'int'\\[^\\n\\r]*(\\n|\\r\\n|\\r)\" } */\n+/* { dg-output \"\\[^\\n\\r]*division by zero\" } */"}]}