{"sha": "23ed6584d682ee5036850fdeb52cb7c22b8e3a0b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjNlZDY1ODRkNjgyZWU1MDM2ODUwZmRlYjUyY2I3YzIyYjhlM2EwYg==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@adacore.com", "date": "2008-07-31T10:27:30Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2008-07-31T10:27:30Z"}, "message": "prj-nmsc.adb (Check_Library_Attributes): Check if Linker'Switches or Linker'Default_Switches are declared.\n\n2008-07-31  Vincent Celier  <celier@adacore.com>\n\n\t* prj-nmsc.adb (Check_Library_Attributes): Check if Linker'Switches or\n\tLinker'Default_Switches are declared. Warn if they are declared.\n\nFrom-SVN: r138385", "tree": {"sha": "e9758081a02cda29f7ebff489474605652e2ae90", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e9758081a02cda29f7ebff489474605652e2ae90"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23ed6584d682ee5036850fdeb52cb7c22b8e3a0b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23ed6584d682ee5036850fdeb52cb7c22b8e3a0b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23ed6584d682ee5036850fdeb52cb7c22b8e3a0b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23ed6584d682ee5036850fdeb52cb7c22b8e3a0b/comments", "author": {"login": "vcelier", "id": 8888056, "node_id": "MDQ6VXNlcjg4ODgwNTY=", "avatar_url": "https://avatars.githubusercontent.com/u/8888056?v=4", "gravatar_id": "", "url": "https://api.github.com/users/vcelier", "html_url": "https://github.com/vcelier", "followers_url": "https://api.github.com/users/vcelier/followers", "following_url": "https://api.github.com/users/vcelier/following{/other_user}", "gists_url": "https://api.github.com/users/vcelier/gists{/gist_id}", "starred_url": "https://api.github.com/users/vcelier/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/vcelier/subscriptions", "organizations_url": "https://api.github.com/users/vcelier/orgs", "repos_url": "https://api.github.com/users/vcelier/repos", "events_url": "https://api.github.com/users/vcelier/events{/privacy}", "received_events_url": "https://api.github.com/users/vcelier/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b666e5681569d47b0d75b7bc5fecdcd513da4b88", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b666e5681569d47b0d75b7bc5fecdcd513da4b88", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b666e5681569d47b0d75b7bc5fecdcd513da4b88"}], "stats": {"total": 40, "additions": 40, "deletions": 0}, "files": [{"sha": "4e8384fc00612d289eeecb63ec604f19afe03fcd", "filename": "gcc/ada/prj-nmsc.adb", "status": "modified", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23ed6584d682ee5036850fdeb52cb7c22b8e3a0b/gcc%2Fada%2Fprj-nmsc.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23ed6584d682ee5036850fdeb52cb7c22b8e3a0b/gcc%2Fada%2Fprj-nmsc.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-nmsc.adb?ref=23ed6584d682ee5036850fdeb52cb7c22b8e3a0b", "patch": "@@ -4104,6 +4104,46 @@ package body Prj.Nmsc is\n          end if;\n       end if;\n \n+      --  Check if Linker'Switches or Linker'Default_Switches are declared.\n+      --  Warn if they are declared, as it is a common error to think that\n+      --  library are \"linked\" with Linker switches.\n+\n+      if Data.Library then\n+         declare\n+            Linker_Package_Id : constant Package_Id :=\n+              Util.Value_Of (Name_Linker, Data.Decl.Packages, In_Tree);\n+            Linker_Package : Package_Element;\n+            Switches          : Array_Element_Id := No_Array_Element;\n+\n+         begin\n+            if Linker_Package_Id /= No_Package then\n+               Linker_Package := In_Tree.Packages.Table (Linker_Package_Id);\n+\n+               Switches :=\n+                 Value_Of\n+                   (Name      => Name_Switches,\n+                    In_Arrays => Linker_Package.Decl.Arrays,\n+                    In_Tree   => In_Tree);\n+\n+               if Switches = No_Array_Element then\n+                  Switches :=\n+                    Value_Of\n+                      (Name      => Name_Default_Switches,\n+                       In_Arrays => Linker_Package.Decl.Arrays,\n+                       In_Tree   => In_Tree);\n+               end if;\n+\n+               if Switches /= No_Array_Element then\n+                  Error_Msg\n+                    (Project, In_Tree,\n+                     \"?Linker switches not taken into account in library \" &\n+                     \"projects\",\n+                     No_Location);\n+               end if;\n+            end if;\n+         end;\n+      end if;\n+\n       if Data.Extends /= No_Project then\n          In_Tree.Projects.Table (Data.Extends).Library := False;\n       end if;"}]}