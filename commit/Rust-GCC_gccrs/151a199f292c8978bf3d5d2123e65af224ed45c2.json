{"sha": "151a199f292c8978bf3d5d2123e65af224ed45c2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTUxYTE5OWYyOTJjODk3OGJmM2Q1ZDIxMjNlNjVhZjIyNGVkNDVjMg==", "commit": {"author": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-01-18T01:51:36Z"}, "committer": {"name": "Iain Buclaw", "email": "ibuclaw@gcc.gnu.org", "date": "2019-01-18T01:51:36Z"}, "message": "libphobos: Add Fiber/Thread support for StackGrowsUp.\n\nThe StackGrowsDown version being turned off for hppa targets.\n\nAfter other fixes in the compiler, this allows core.thread unittests to\nall pass, as well as the garbage collector to work correctly.\n\nBackported from upstream druntime 2.084.\n\nReviewed-on: https://github.com/dlang/druntime/pull/2410\n\nFrom-SVN: r268056", "tree": {"sha": "822f0d5536f9248f97780d35a20360a40dca7649", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/822f0d5536f9248f97780d35a20360a40dca7649"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/151a199f292c8978bf3d5d2123e65af224ed45c2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/151a199f292c8978bf3d5d2123e65af224ed45c2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/151a199f292c8978bf3d5d2123e65af224ed45c2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/151a199f292c8978bf3d5d2123e65af224ed45c2/comments", "author": null, "committer": null, "parents": [{"sha": "50deb97073424cb746e08408d3f10f3b5e16be98", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/50deb97073424cb746e08408d3f10f3b5e16be98", "html_url": "https://github.com/Rust-GCC/gccrs/commit/50deb97073424cb746e08408d3f10f3b5e16be98"}], "stats": {"total": 22, "additions": 12, "deletions": 10}, "files": [{"sha": "e502072be7a7f2e2185d157318cc16fcc2297b78", "filename": "libphobos/libdruntime/core/thread.d", "status": "modified", "additions": 12, "deletions": 4, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/151a199f292c8978bf3d5d2123e65af224ed45c2/libphobos%2Flibdruntime%2Fcore%2Fthread.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/151a199f292c8978bf3d5d2123e65af224ed45c2/libphobos%2Flibdruntime%2Fcore%2Fthread.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libphobos%2Flibdruntime%2Fcore%2Fthread.d?ref=151a199f292c8978bf3d5d2123e65af224ed45c2", "patch": "@@ -3254,7 +3254,9 @@ private void* getStackBottom() nothrow @nogc\n         pthread_getattr_np(pthread_self(), &attr);\n         pthread_attr_getstack(&attr, &addr, &size);\n         pthread_attr_destroy(&attr);\n-        return addr + size;\n+        version (StackGrowsDown)\n+            addr += size;\n+        return addr;\n     }\n     else version (FreeBSD)\n     {\n@@ -3265,7 +3267,9 @@ private void* getStackBottom() nothrow @nogc\n         pthread_attr_get_np(pthread_self(), &attr);\n         pthread_attr_getstack(&attr, &addr, &size);\n         pthread_attr_destroy(&attr);\n-        return addr + size;\n+        version (StackGrowsDown)\n+            addr += size;\n+        return addr;\n     }\n     else version (NetBSD)\n     {\n@@ -3276,7 +3280,9 @@ private void* getStackBottom() nothrow @nogc\n         pthread_attr_get_np(pthread_self(), &attr);\n         pthread_attr_getstack(&attr, &addr, &size);\n         pthread_attr_destroy(&attr);\n-        return addr + size;\n+        version (StackGrowsDown)\n+            addr += size;\n+        return addr;\n     }\n     else version (Solaris)\n     {\n@@ -3293,7 +3299,9 @@ private void* getStackBottom() nothrow @nogc\n         pthread_getattr_np(pthread_self(), &attr);\n         pthread_attr_getstack(&attr, &addr, &size);\n         pthread_attr_destroy(&attr);\n-        return addr + size;\n+        version (StackGrowsDown)\n+            addr += size;\n+        return addr;\n     }\n     else\n         static assert(false, \"Platform not supported.\");"}, {"sha": "b7bb9b0c36f1a0268420296ad53fc81b67e7ba53", "filename": "libphobos/libdruntime/gc/impl/conservative/gc.d", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/151a199f292c8978bf3d5d2123e65af224ed45c2/libphobos%2Flibdruntime%2Fgc%2Fimpl%2Fconservative%2Fgc.d", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/151a199f292c8978bf3d5d2123e65af224ed45c2/libphobos%2Flibdruntime%2Fgc%2Fimpl%2Fconservative%2Fgc.d", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libphobos%2Flibdruntime%2Fgc%2Fimpl%2Fconservative%2Fgc.d?ref=151a199f292c8978bf3d5d2123e65af224ed45c2", "patch": "@@ -30,12 +30,6 @@ module gc.impl.conservative.gc;\n //debug = INVARIANT;            // enable invariants\n //debug = PROFILE_API;          // profile API calls for config.profile > 1\n \n-/*************** Configuration *********************/\n-\n-version = STACKGROWSDOWN;       // growing the stack means subtracting from the stack pointer\n-                                // (use for Intel X86 CPUs)\n-                                // else growing the stack means adding to the stack pointer\n-\n /***************************************************/\n \n import gc.bits;"}]}