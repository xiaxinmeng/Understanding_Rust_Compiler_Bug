{"sha": "71ece3432a57caa18d7d5febcf44414e33287136", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzFlY2UzNDMyYTU3Y2FhMThkN2Q1ZmViY2Y0NDQxNGUzMzI4NzEzNg==", "commit": {"author": {"name": "Ira Rosen", "email": "irar@il.ibm.com", "date": "2009-05-31T10:43:38Z"}, "committer": {"name": "Ira Rosen", "email": "irar@gcc.gnu.org", "date": "2009-05-31T10:43:38Z"}, "message": "tree-vect-loop-manip.c (slpeel_update_phi_nodes_for_guard1): Don't mark phis for renaming.\n\n\n\t* tree-vect-loop-manip.c (slpeel_update_phi_nodes_for_guard1): Don't\n\tmark phis for renaming.\n\t* tree-vectorizer.c (vect_memsyms_to_rename): Remove.\n\t(vectorize_loops): Don't allocate and free vect_memsyms_to_rename.\n\tCall mark_sym_for_renaming.\n\t* tree-vectorizer.h (vect_memsyms_to_rename): Remove.\n\t* tree-vect-loop.c (vect_transform_loop): Remove vect_memsyms_to_rename\n\tinitialization and a call to mark_set_for_renaming.\n\nFrom-SVN: r148013", "tree": {"sha": "3311ee5c1c22d52a474a58a8ad0683ae5dc788f9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3311ee5c1c22d52a474a58a8ad0683ae5dc788f9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/71ece3432a57caa18d7d5febcf44414e33287136", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71ece3432a57caa18d7d5febcf44414e33287136", "html_url": "https://github.com/Rust-GCC/gccrs/commit/71ece3432a57caa18d7d5febcf44414e33287136", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/71ece3432a57caa18d7d5febcf44414e33287136/comments", "author": {"login": "irar2", "id": 16818592, "node_id": "MDQ6VXNlcjE2ODE4NTky", "avatar_url": "https://avatars.githubusercontent.com/u/16818592?v=4", "gravatar_id": "", "url": "https://api.github.com/users/irar2", "html_url": "https://github.com/irar2", "followers_url": "https://api.github.com/users/irar2/followers", "following_url": "https://api.github.com/users/irar2/following{/other_user}", "gists_url": "https://api.github.com/users/irar2/gists{/gist_id}", "starred_url": "https://api.github.com/users/irar2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/irar2/subscriptions", "organizations_url": "https://api.github.com/users/irar2/orgs", "repos_url": "https://api.github.com/users/irar2/repos", "events_url": "https://api.github.com/users/irar2/events{/privacy}", "received_events_url": "https://api.github.com/users/irar2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b304194493625d75256821be5d2df6a84aaf6cda", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b304194493625d75256821be5d2df6a84aaf6cda", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b304194493625d75256821be5d2df6a84aaf6cda"}], "stats": {"total": 39, "additions": 12, "deletions": 27}, "files": [{"sha": "400b535016d74437f207bbdf55eab5c9014214b2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=71ece3432a57caa18d7d5febcf44414e33287136", "patch": "@@ -1,3 +1,14 @@\n+2009-05-31  Ira Rosen  <irar@il.ibm.com>\n+\n+\t* tree-vect-loop-manip.c (slpeel_update_phi_nodes_for_guard1): Don't\n+\tmark phis for renaming.\n+\t* tree-vectorizer.c (vect_memsyms_to_rename): Remove.\n+\t(vectorize_loops): Don't allocate and free vect_memsyms_to_rename.\n+\tCall mark_sym_for_renaming.\n+\t* tree-vectorizer.h (vect_memsyms_to_rename): Remove.\n+\t* tree-vect-loop.c (vect_transform_loop): Remove vect_memsyms_to_rename\n+\tinitialization and a call to mark_set_for_renaming.\n+\n 2009-05-31  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR middle-end/40304"}, {"sha": "41a003317506a9c7fffcc5808b83367b33ca6e1d", "filename": "gcc/tree-vect-loop-manip.c", "status": "modified", "additions": 0, "deletions": 10, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vect-loop-manip.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vect-loop-manip.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-loop-manip.c?ref=71ece3432a57caa18d7d5febcf44414e33287136", "patch": "@@ -371,7 +371,6 @@ slpeel_update_phi_nodes_for_guard1 (edge guard_edge, struct loop *loop,\n   basic_block orig_bb = loop->header;\n   edge new_exit_e;\n   tree current_new_name;\n-  tree name;\n   gimple_stmt_iterator gsi_orig, gsi_update;\n \n   /* Create new bb between loop and new_merge_bb.  */\n@@ -387,15 +386,6 @@ slpeel_update_phi_nodes_for_guard1 (edge guard_edge, struct loop *loop,\n       orig_phi = gsi_stmt (gsi_orig);\n       update_phi = gsi_stmt (gsi_update);\n \n-      /* Virtual phi; Mark it for renaming. We actually want to call\n-\t mar_sym_for_renaming, but since all ssa renaming datastructures\n-\t are going to be freed before we get to call ssa_update, we just\n-\t record this name for now in a bitmap, and will mark it for\n-\t renaming later.  */\n-      name = PHI_RESULT (orig_phi);\n-      if (!is_gimple_reg (SSA_NAME_VAR (name)))\n-        bitmap_set_bit (vect_memsyms_to_rename, DECL_UID (SSA_NAME_VAR (name)));\n-\n       /** 1. Handle new-merge-point phis  **/\n \n       /* 1.1. Generate new phi node in NEW_MERGE_BB:  */"}, {"sha": "9756a941dc0db6ed4921fdc476f34345ee2625ce", "filename": "gcc/tree-vect-loop.c", "status": "modified", "additions": 0, "deletions": 6, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vect-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vect-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-loop.c?ref=71ece3432a57caa18d7d5febcf44414e33287136", "patch": "@@ -3654,10 +3654,6 @@ vect_transform_loop (loop_vec_info loop_vinfo)\n \t\t\t  !do_peeling_for_loop_bound,\n \t\t\t  &cond_expr, &cond_expr_stmt_list);\n \n-  /* CHECKME: we wouldn't need this if we called update_ssa once\n-     for all loops.  */\n-  bitmap_zero (vect_memsyms_to_rename);\n-  \n   /* If the loop has a symbolic number of iterations 'n' (i.e. it's not a\n      compile time constant), or it is a constant that doesn't divide by the\n      vectorization factor, then an epilog loop needs to be created.\n@@ -3812,8 +3808,6 @@ vect_transform_loop (loop_vec_info loop_vinfo)\n \n   slpeel_make_loop_iterate_ntimes (loop, ratio);\n \n-  mark_set_for_renaming (vect_memsyms_to_rename);\n-\n   /* The memory tags and pointers in vectorized statements need to\n      have their SSA forms updated.  FIXME, why can't this be delayed\n      until all the loops have been transformed?  */"}, {"sha": "2c2103eda0a654cf166b9d3a9180e9f1170494bf", "filename": "gcc/tree-vectorizer.c", "status": "modified", "additions": 1, "deletions": 8, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vectorizer.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vectorizer.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vectorizer.c?ref=71ece3432a57caa18d7d5febcf44414e33287136", "patch": "@@ -81,9 +81,6 @@ static enum verbosity_levels user_vect_verbosity_level = MAX_VERBOSITY_LEVEL;\n /* Loop or bb location.  */\n LOC vect_location;\n \n-/* Bitmap of virtual variables to be renamed.  */\n-bitmap vect_memsyms_to_rename;\n-\n /* Vector mapping GIMPLE stmt to stmt_vec_info. */\n VEC(vec_void_p,heap) *stmt_vec_info_vec;\n \n@@ -206,10 +203,6 @@ vectorize_loops (void)\n   /* Fix the verbosity level if not defined explicitly by the user.  */\n   vect_set_dump_settings (false);\n \n-  /* Allocate the bitmap that records which virtual variables  \n-     need to be renamed.  */\n-  vect_memsyms_to_rename = BITMAP_ALLOC (NULL);\n-\n   init_stmt_vec_info_vec ();\n \n   /*  ----------- Analyze loops. -----------  */\n@@ -244,7 +237,7 @@ vectorize_loops (void)\n \n   /*  ----------- Finalize. -----------  */\n \n-  BITMAP_FREE (vect_memsyms_to_rename);\n+  mark_sym_for_renaming (gimple_vop (cfun));\n \n   for (i = 1; i < vect_loops_num; i++)\n     {"}, {"sha": "0a8e53cf62a44b559907bbcc8816259490df3502", "filename": "gcc/tree-vectorizer.h", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vectorizer.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/71ece3432a57caa18d7d5febcf44414e33287136/gcc%2Ftree-vectorizer.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vectorizer.h?ref=71ece3432a57caa18d7d5febcf44414e33287136", "patch": "@@ -728,9 +728,6 @@ known_alignment_for_access_p (struct data_reference *data_ref_info)\n extern FILE *vect_dump;\n extern LOC vect_loop_location;\n \n-/* Bitmap of virtual variables to be renamed.  */\n-extern bitmap vect_memsyms_to_rename;\n-\n /*-----------------------------------------------------------------*/\n /* Function prototypes.                                            */\n /*-----------------------------------------------------------------*/"}]}