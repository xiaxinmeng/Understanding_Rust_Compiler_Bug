{"sha": "793244425118c9eda89e63ef666e2bd67a1692d7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzkzMjQ0NDI1MTE4YzllZGE4OWU2M2VmNjY2ZTJiZDY3YTE2OTJkNw==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@physics.uc.edu", "date": "2005-08-31T13:46:06Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2005-08-31T13:46:06Z"}, "message": "re PR objc++/23640 (obj-c++ does not call __objc_exec_class for the classes)\n\n2005-08-31  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR obj-c++/23640\n        * decl2.c (cp_finish_file): If this is obj-c++ and we need a static\n        init, call generate_ctor_or_dtor_function.\n\n2005-08-31  Andrew Pinski  <pinskia@physics.uc.edu>\n\n        PR obj-c++/23640\n        * obj-c++.dg/gnu-runtime-3.mm: New test.\n\nFrom-SVN: r103673", "tree": {"sha": "a2b11b5bf0e81f044ac467f6c07aa374c52d7b3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a2b11b5bf0e81f044ac467f6c07aa374c52d7b3d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/793244425118c9eda89e63ef666e2bd67a1692d7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/793244425118c9eda89e63ef666e2bd67a1692d7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/793244425118c9eda89e63ef666e2bd67a1692d7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/793244425118c9eda89e63ef666e2bd67a1692d7/comments", "author": null, "committer": null, "parents": [{"sha": "ee5426a488f8b28099c6f462aef34b157182d2ac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee5426a488f8b28099c6f462aef34b157182d2ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee5426a488f8b28099c6f462aef34b157182d2ac"}], "stats": {"total": 47, "additions": 45, "deletions": 2}, "files": [{"sha": "d16d5f66d77a237ec5be90b07e0a414ff61b2143", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=793244425118c9eda89e63ef666e2bd67a1692d7", "patch": "@@ -1,3 +1,9 @@\n+2005-08-31  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR obj-c++/23640\n+\t* decl2.c (cp_finish_file): If this is obj-c++ and we need a static\n+\tinit, call generate_ctor_or_dtor_function.\n+\n 2005-08-31  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \tPR c++/13377"}, {"sha": "3821ab01115c54b111e1b0039b22b1b4b5bc4200", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=793244425118c9eda89e63ef666e2bd67a1692d7", "patch": "@@ -3078,8 +3078,9 @@ cp_finish_file (void)\n \t\t\t/*data=*/&locus);\n   else\n     {\n-\n-      if (static_ctors)\n+      /* If we have a ctor or this is obj-c++ and we need a static init,\n+         call generate_ctor_or_dtor_function.  */\n+      if (static_ctors || (c_dialect_objc () && objc_static_init_needed_p ()))\n \tgenerate_ctor_or_dtor_function (/*constructor_p=*/true,\n \t\t\t\t\tDEFAULT_INIT_PRIORITY, &locus);\n       if (static_dtors)"}, {"sha": "9c34189466fa0765c01131c98e77bd929769b671", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=793244425118c9eda89e63ef666e2bd67a1692d7", "patch": "@@ -1,3 +1,8 @@\n+2005-08-31  Andrew Pinski  <pinskia@physics.uc.edu>\n+\n+\tPR obj-c++/23640\n+\t* obj-c++.dg/gnu-runtime-3.mm: New test.\n+\n 2005-08-31  Volker Reichelt  <reichelt@igpm.rwth-aachen.de>\n \n \tPR c++/13377"}, {"sha": "04671ebc4c54da026ce267a8fee801f4def9de1c", "filename": "gcc/testsuite/obj-c++.dg/gnu-runtime-3.mm", "status": "added", "additions": 31, "deletions": 0, "changes": 31, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fgnu-runtime-3.mm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/793244425118c9eda89e63ef666e2bd67a1692d7/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fgnu-runtime-3.mm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fobj-c%2B%2B.dg%2Fgnu-runtime-3.mm?ref=793244425118c9eda89e63ef666e2bd67a1692d7", "patch": "@@ -0,0 +1,31 @@\n+/* Test that compiling for the GNU runtime works (regardless of\n+   the system runtime used).  */\n+/* Author: Ziemowit Laski <zlaski@apple.com>  */\n+/* { dg-do run } */\n+/* { dg-options \"-fgnu-runtime\" } */\n+\n+#include <objc/Object.h>\n+\n+@interface FooBar: Object\n+- (void)boo;\n+@end\n+\n+int called = 0;\n+extern \"C\" void abort ();\n+\n+@implementation FooBar\n+- (void)boo\n+{\n+  called ++;\n+}\n+@end\n+\n+int main ()\n+{\n+  id fooBarInst = [[FooBar alloc] init];\n+  [fooBarInst boo];\n+  if (called != 1)\n+    abort ();\n+  return 0;\n+}\n+"}]}