{"sha": "21caa1a2649d586f4f8830aba43b0c132584f2dd", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjFjYWExYTI2NDlkNTg2ZjRmODgzMGFiYTQzYjBjMTMyNTg0ZjJkZA==", "commit": {"author": {"name": "Prathamesh Kulkarni", "email": "prathamesh.kulkarni@linaro.org", "date": "2019-07-24T07:20:24Z"}, "committer": {"name": "Prathamesh Kulkarni", "email": "prathamesh3492@gcc.gnu.org", "date": "2019-07-24T07:20:24Z"}, "message": "re PR middle-end/91166 ([SVE] Unfolded ZIPs of constants)\n\n2019-07-24  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n\n\tPR middle-end/91166\n\t* match.pd (vec_perm_expr(v, v, mask) -> v): New pattern.\n\t(define_predicates): Add entry for uniform_vector_p.\n\t(vec_same_elem_p): New match pattern.\n\ntestsuite/\n\t* gcc.target/aarch64/sve/pr91166.c: New test.\n\nFrom-SVN: r273758", "tree": {"sha": "1dd8d376056aa5a60d5b91c0be08815d81f4ef3d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1dd8d376056aa5a60d5b91c0be08815d81f4ef3d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/21caa1a2649d586f4f8830aba43b0c132584f2dd", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21caa1a2649d586f4f8830aba43b0c132584f2dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/21caa1a2649d586f4f8830aba43b0c132584f2dd", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/21caa1a2649d586f4f8830aba43b0c132584f2dd/comments", "author": null, "committer": null, "parents": [{"sha": "70121844349587b23c3950e844021a22ab51638c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/70121844349587b23c3950e844021a22ab51638c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/70121844349587b23c3950e844021a22ab51638c"}], "stats": {"total": 48, "additions": 47, "deletions": 1}, "files": [{"sha": "7bb56a48e38027afea88f451da063aa928e72d2d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=21caa1a2649d586f4f8830aba43b0c132584f2dd", "patch": "@@ -1,3 +1,10 @@\n+2019-07-24  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n+\n+\tPR middle-end/91166\n+\t* match.pd (vec_perm_expr(v, v, mask) -> v): New pattern.\n+\t(define_predicates): Add entry for uniform_vector_p.\n+\t(vec_same_elem_p): New match pattern.\n+\n 2019-07-24  Iain Sandoe  <iain@sandoe.co.uk>\n \n \tPR bootstrap/87030"}, {"sha": "c5c6a041cfce8a0b24e0cfc63a28a8f9792f31c2", "filename": "gcc/match.pd", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=21caa1a2649d586f4f8830aba43b0c132584f2dd", "patch": "@@ -36,7 +36,8 @@ along with GCC; see the file COPYING3.  If not see\n    integer_valued_real_p\n    integer_pow2p\n    uniform_integer_cst_p\n-   HONOR_NANS)\n+   HONOR_NANS\n+   uniform_vector_p)\n \n /* Operator lists.  */\n (define_operator_list tcc_comparison\n@@ -5568,3 +5569,16 @@ DEFINE_INT_AND_FLOAT_ROUND_FN (RINT)\n          { bitsize_int (at * tree_to_uhwi (TYPE_SIZE (TREE_TYPE (type)))); })\n        (if (changed)\n         (vec_perm { op0; } { op1; } { op2; }))))))))))\n+\n+/* VEC_PERM_EXPR (v, v, mask) -> v where v contains same element.  */\n+\n+(match vec_same_elem_p\n+ @0\n+ (if (uniform_vector_p (@0))))\n+\n+(match vec_same_elem_p\n+ (vec_duplicate @0))\n+\n+(simplify\n+ (vec_perm vec_same_elem_p@0 @0 @1)\n+ @0)"}, {"sha": "369634e8b4a67daf4d98a6ccf59349d88529b216", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=21caa1a2649d586f4f8830aba43b0c132584f2dd", "patch": "@@ -1,3 +1,8 @@\n+2019-07-24  Prathamesh Kulkarni  <prathamesh.kulkarni@linaro.org>\n+\n+\tPR middle-end/91166\n+\t* gcc.target/aarch64/sve/pr91166.c: New test.\n+\n 2019-07-23  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/54072"}, {"sha": "42654be3b31e3502f0b1f60d79c0dffd90b2d1cb", "filename": "gcc/testsuite/gcc.target/aarch64/sve/pr91166.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fsve%2Fpr91166.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/21caa1a2649d586f4f8830aba43b0c132584f2dd/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fsve%2Fpr91166.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Faarch64%2Fsve%2Fpr91166.c?ref=21caa1a2649d586f4f8830aba43b0c132584f2dd", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -march=armv8.2-a+sve -fdump-tree-optimized\" } */\n+\n+void\n+f1 (double x[][4]) \n+{\n+  for (int i = 0; i < 4; ++i)\n+    for (int j = 0; j < 4; ++j)\n+      x[i][j] = 0;\n+}\n+\n+void\n+f2 (double x[][4], double y)\n+{\n+  for (int i = 0; i < 4; ++i)\n+    for (int j = 0; j < 4; ++j)\n+      x[i][j] = y;\n+}\n+\n+/* { dg-final { scan-tree-dump-not \"VEC_PERM_EXPR\" \"optimized\"} } */"}]}