{"sha": "8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGU3YzVmZGRiZTdmZDU3MGZiNzc5NTg0M2QyZmRhMTRmYTllNWJmYw==", "commit": {"author": {"name": "Richard Henderson", "email": "rth@redhat.com", "date": "2009-09-10T18:27:59Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2009-09-10T18:27:59Z"}, "message": "tree-cfg.c (gimple_can_merge_blocks_p): Move label and loop latch tests earlier.\n\n* tree-cfg.c (gimple_can_merge_blocks_p): Move label and\n        loop latch tests earlier.\n\nFrom-SVN: r151604", "tree": {"sha": "0c92b831c7b9969859aa255a6183d92337206997", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c92b831c7b9969859aa255a6183d92337206997"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc/comments", "author": null, "committer": null, "parents": [{"sha": "07c358c60cd384bf048b842ad36a67dd0abab41b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/07c358c60cd384bf048b842ad36a67dd0abab41b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/07c358c60cd384bf048b842ad36a67dd0abab41b"}], "stats": {"total": 36, "additions": 21, "deletions": 15}, "files": [{"sha": "c110d534c1046d47c6571cbd6ba683fc1f69330a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc", "patch": "@@ -1,5 +1,8 @@\n 2009-09-10  Richard Henderson  <rth@redhat.com>\n \n+\t* tree-cfg.c (gimple_can_merge_blocks_p): Move label and\n+\tloop latch tests earlier.\n+\n \t* gimple-iterator.c (gimple_find_edge_insert_loc): Insert\n \tbefore GIMPLE_RETURN, not after its predecessor; insert\n \tbefore GIMPLE_RESX."}, {"sha": "b8349433c5f0c6bc10707dddd8785facbdeed31f", "filename": "gcc/tree-cfg.c", "status": "modified", "additions": 18, "deletions": 15, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc/gcc%2Ftree-cfg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc/gcc%2Ftree-cfg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-cfg.c?ref=8e7c5fddbe7fd570fb7795843d2fda14fa9e5bfc", "patch": "@@ -1354,6 +1354,24 @@ gimple_can_merge_blocks_p (basic_block a, basic_block b)\n       && DECL_NONLOCAL (gimple_label_label (stmt)))\n     return false;\n \n+  /* Examine the labels at the beginning of B.  */\n+  for (gsi = gsi_start_bb (b); !gsi_end_p (gsi); gsi_next (&gsi))\n+    {\n+      tree lab;\n+      stmt = gsi_stmt (gsi);\n+      if (gimple_code (stmt) != GIMPLE_LABEL)\n+\tbreak;\n+      lab = gimple_label_label (stmt);\n+\n+      /* Do not remove user labels.  */\n+      if (!DECL_ARTIFICIAL (lab))\n+\treturn false;\n+    }\n+\n+  /* Protect the loop latches.  */\n+  if (current_loops && b->loop_father->latch == b)\n+    return false;\n+\n   /* It must be possible to eliminate all phi nodes in B.  If ssa form\n      is not up-to-date, we cannot eliminate any phis; however, if only\n      some symbols as whole are marked for renaming, this is not a problem,\n@@ -1377,21 +1395,6 @@ gimple_can_merge_blocks_p (basic_block a, basic_block b)\n \t}\n     }\n \n-  /* Do not remove user labels.  */\n-  for (gsi = gsi_start_bb (b); !gsi_end_p (gsi); gsi_next (&gsi))\n-    {\n-      stmt = gsi_stmt (gsi);\n-      if (gimple_code (stmt) != GIMPLE_LABEL)\n-\tbreak;\n-      if (!DECL_ARTIFICIAL (gimple_label_label (stmt)))\n-\treturn false;\n-    }\n-\n-  /* Protect the loop latches.  */\n-  if (current_loops\n-      && b->loop_father->latch == b)\n-    return false;\n-\n   return true;\n }\n "}]}