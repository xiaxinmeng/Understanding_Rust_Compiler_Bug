{"sha": "a7fc602f1742e6a28998624a5a39871af1222eab", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTdmYzYwMmYxNzQyZTZhMjg5OTg2MjRhNWEzOTg3MWFmMTIyMmVhYg==", "commit": {"author": {"name": "J. David Anglin", "email": "dave@hiauly1.hia.nrc.ca", "date": "2000-06-05T17:44:07Z"}, "committer": {"name": "Bruce Korb", "email": "korbb@gcc.gnu.org", "date": "2000-06-05T17:44:07Z"}, "message": "New include hacks for ultrix\n\nFrom-SVN: r34407", "tree": {"sha": "376c036b4370078aded7607e4703aff2de29b3b5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/376c036b4370078aded7607e4703aff2de29b3b5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7fc602f1742e6a28998624a5a39871af1222eab", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7fc602f1742e6a28998624a5a39871af1222eab", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7fc602f1742e6a28998624a5a39871af1222eab", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7fc602f1742e6a28998624a5a39871af1222eab/comments", "author": null, "committer": null, "parents": [{"sha": "83adf9da649087e9289af876fc4c4b47d0e96b62", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83adf9da649087e9289af876fc4c4b47d0e96b62", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83adf9da649087e9289af876fc4c4b47d0e96b62"}], "stats": {"total": 169, "additions": 154, "deletions": 15}, "files": [{"sha": "de969e4467f5b85929541af394f137f65b0200e7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7fc602f1742e6a28998624a5a39871af1222eab/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7fc602f1742e6a28998624a5a39871af1222eab/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a7fc602f1742e6a28998624a5a39871af1222eab", "patch": "@@ -1,3 +1,10 @@\n+2000-06-05  J. David Anglin  <dave@hiauly1.hia.nrc.ca>\n+\n+\t* fixinc/inclhack.def: New include hacks for ultrix.\n+\t* (nested_ultrix): Replaced by ultrix_nested_svc.\n+\t* (ultrix_atof_param): test_text string added.\n+\t* (ultrix_ifdef): Modified select string.\n+\n 2000-06-05  Zack Weinberg  <zack@wolery.cumb.org>\n \n \t* objc/objc-act.c (generate_method_descriptors): Register"}, {"sha": "ec1b0f3d30f677b0be5db7cfc3851ac98926e07c", "filename": "gcc/fixinc/inclhack.def", "status": "modified", "additions": 147, "deletions": 15, "changes": 162, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7fc602f1742e6a28998624a5a39871af1222eab/gcc%2Ffixinc%2Finclhack.def", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7fc602f1742e6a28998624a5a39871af1222eab/gcc%2Ffixinc%2Finclhack.def", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixinc%2Finclhack.def?ref=a7fc602f1742e6a28998624a5a39871af1222eab", "patch": "@@ -516,6 +516,65 @@ fix = {\n };\n \n \n+/*\n+ *  The Ultrix 4.3 file limits.h is a symbolic link to sys/limits.h.\n+ *  Replace limits.h with a file that includes sys/limits.h.\n+ */\n+fix = {\n+    hackname = AAB_ultrix_limits;\n+    files    = limits.h;\n+    mach     = \"*-*-ultrix4.3\";\n+    replace  =\n+'/*\t@(#)limits.h\t\t\t\t*/\n+/* This file was generated by fixincludes\t*/\n+\\#ifndef _LIMITS_INCLUDED\n+\\#define _LIMITS_INCLUDED\n+\\#include <sys/limits.h>\n+\\#endif /* _LIMITS_INCLUDED */\n+';\n+};\n+\n+\n+/*\n+ *  The ULTRIX 4.3 version of memory.h duplicates definitions\n+ *  present in strings.h.  Replace memory.h with a file that includes\n+ *  strings.h to prevent problems from multiple inclusion.\n+ */\n+fix = {\n+    hackname = AAB_ultrix_memory;\n+    files    = memory.h;\n+    mach     = \"*-*-ultrix4.3\";\n+    replace  =\n+'/*\t@(#)memory.h\t\t\t\t*/\n+/* This file was generated by fixincludes\t*/\n+\\#ifndef _MEMORY_INCLUDED\n+\\#define _MEMORY_INCLUDED\n+\\#include <strings.h>\n+\\#endif /* _MEMORY_INCLUDED */\n+';\n+};\n+\n+\n+/*\n+ *  The Ultrix 4.3 file string.h is a symbolic link to strings.h.\n+ *  Replace string.h link with a file that includes strings.h to prevent\n+ *  problems from multiple inclusion.\n+ */\n+fix = {\n+    hackname = AAB_ultrix_string;\n+    files    = string.h;\n+    mach     = \"*-*-ultrix4.3\";\n+    replace  =\n+'/*\t@(#)string.h\t\t\t\t*/\n+/* This file was generated by fixincludes\t*/\n+\\#ifndef _STRING_INCLUDED\n+\\#define _STRING_INCLUDED\n+\\#include <strings.h>\n+\\#endif /* _STRING_INCLUDED */\n+';\n+};\n+\n+\n /*\n  *  sys/wait.h on AIX 3.2.5 puts the declaration of wait3 before the\n  *  definition of struct rusage, so the prototype added by fixproto fails.\n@@ -1489,16 +1548,6 @@ fix = {\n };\n \n \n-/*\n- *  Avoid nested comments on Ultrix 4.3.\n- */\n-fix = {\n-    hackname = nested_ultrix;\n-    files    = rpc/svc.h;\n-    sed      = \"s@^\\\\( \\\\*\\tint protocol;  \\\\)/\\\\*@\\\\1*/ /*@\";\n-};\n-\n-\n /*\n  *  fix bogus recursive stdlib.h in NEWS-OS 4.0C\n  */\n@@ -2616,7 +2665,10 @@ fix = {\n     files    = math.h;\n     select   = \"atof\\\\([ \\t]*char\";\n \n-    sed = \"s@atof(\\\\([ \\t]*char[ \\t]*\\\\*[^)]*\\\\))@atof(const \\\\1)@\";\n+    c_fix     = format;\n+    c_fix_arg = \"atof(const char\";\n+\n+    test_text = \"extern double atof( char *__nptr);\\n\";\n };\n \n \n@@ -2672,8 +2724,10 @@ fix = {\n     hackname = ultrix_fix_fixproto;\n     files    = sys/utsname.h;\n     select   = ULTRIX;\n-    sed      = \"/^[ \\t]*extern[ \\t]*int[ \\t]*uname();$/i\\\\\\n\"\n-               \"struct utsname;\\n\";\n+\n+    c_fix     = format;\n+    c_fix_arg = \"struct utsname;\\n%0\";\n+    c_fix_arg = \"^[ \\t]*extern[ \\t]*int[ \\t]*uname\\\\(\\\\);\"\n \n     test_text =\n     \"/* ULTRIX's uname */\\nextern\\tint\\tuname();\";\n@@ -2685,15 +2739,77 @@ fix = {\n  */\n fix = {\n     hackname = ultrix_ifdef;\n-    select   = \"#ifdef KERNEL[ \\t]+[^ \\t]\";\n+    select   = \"^#ifdef KERNEL[ \\t]+&&\";\n     files    = sys/file.h;\n-    sed      = \"s/#ifdef KERNEL/#if defined(KERNEL)/\";\n+\n+    c_fix     = format;\n+    c_fix_arg = \"#if defined(KERNEL) &&\";\n \n     test_text =\n     \"#ifdef KERNEL\\t&& defined( mumbojumbo )\\nint oops;\\n#endif\";\n };\n \n \n+/*\n+ * Strip \"|| CC$gfloat\" from Ultrix math headers.\n+ */\n+fix = {\n+    hackname = ultrix_math_ifdef;\n+    files = float.h;\n+    files = math.h;\n+    files = sys/limits.h;\n+    select = \"^#if.*\\\\|\\\\|[ \\t]+CC\\\\$[a-z]+\";\n+    sed = \"/^#if/s/||[ \\t][ \\t]*CC$[a-z][a-z]*//\";\n+    test_text = '#if     defined(__GFLOAT) || CC\\$gfloat';\n+};\n+\n+\n+/*\n+ *  Avoid nested comments on Ultrix 4.3.\n+ */\n+fix = {\n+    hackname = ultrix_nested_ioctl;\n+    files    = sys/ioctl.h;\n+    select   = \"^/\\\\* #define SIOCSCREEN\";\n+    sed      = \"/^\\\\/\\\\* #define SIOCSCREEN/s@/\\\\* screend@*//* screend@\";\n+    test_text =\n+    \"/* #define SIOCSCREENON _IOWR('i', 49, int)\"\n+    \"/* screend, net/gw_screen.h */\\n\";\n+};\n+\n+\n+fix = {\n+    hackname = ultrix_nested_svc;\n+    files    = rpc/svc.h;\n+    select   = \"^ \\\\*[ \\t]*int protocol;  */\\\\*\";\n+    sed      = \"s@^\\\\( \\\\*\\tint protocol;  \\\\)/\\\\*@\\\\1*/ /*@\";\n+    test_text =\n+    \" *\\tint protocol;  /* like TCP or UDP\\n\";\n+};\n+\n+\n+/*\n+ *  Add missing prototype for lstat and define for S_ISLNK\n+ *  in Ultrix V4.3 sys/stat.h.\n+ */\n+fix = {\n+    hackname = ultrix_stat;\n+    files  = sys/stat.h;\n+    select = \"@\\\\(#\\\\)stat\\\\.h.*6\\\\.1.*\\\\(ULTRIX\\\\)\";\n+    sed    = \"/^#define[ \\t]S_IFPORT[ \\t]*S_IFIFO$/a\\\\\\n\"\n+\t\t\"\\\\\\n\"\n+\t\t\"/* macro to test for symbolic link */\\\\\\n\"\n+\t\t\"#define S_ISLNK(mode) (((mode) & S_IFMT) == S_IFLNK)\\\\\\n\"\n+\t\t\"\\n\";\n+    sed    = \"/^[ \\t]*fstat(),$/a\\\\\\n\"\n+\t\t\"\\tlstat(),\\n\";\n+    test_text =\n+    \"@(#)stat.h      6.1     (ULTRIX)\\n\"\n+    \"#define S_IFPORT S_IFIFO\\n\"\n+    \"\\tfstat(),\\n\";\n+};\n+\n+\n /*\n  *  Check for superfluous `static' (in Ultrix 4.2)\n  *  On Ultrix 4.3, includes of other files (r3_cpu.h,r4_cpu.h) is broken.\n@@ -2705,6 +2821,22 @@ fix = {\n     sed    = \"s/^static struct tlb_pid_state/struct tlb_pid_state/\";\n     sed    = 's/^#include \"r3_cpu\\.h\"$/#include <machine\\/r3_cpu\\.h>/';\n     sed    = 's/^#include \"r4_cpu\\.h\"$/#include <machine\\/r4_cpu\\.h>/';\n+    test_text =\n+    \"static struct tlb_pid_state {\\n\"\n+    \"#include \\\"r3_cpu.h\\\"\\n\";\n+};\n+\n+\n+/*\n+ *  Add once-only latch to Ultrix V4.3 strings.h.\n+ */\n+fix = {\n+    hackname = ultrix_strings;\n+    files  = strings.h;\n+    select = \"@\\\\(#\\\\)strings\\\\.h.*6\\\\.1.*\\\\(ULTRIX\\\\)\";\n+    c_fix  = wrap;\n+    test_text =\n+    \"@(#)strings.h   6.1     (ULTRIX)\\n\";\n };\n \n "}]}