{"sha": "60a3d46c17e7cee099043c1564181ab2f3c21d41", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjBhM2Q0NmMxN2U3Y2VlMDk5MDQzYzE1NjQxODFhYjJmM2MyMWQ0MQ==", "commit": {"author": {"name": "Pekka J\u00e4\u00e4skel\u00e4inen", "email": "pekka.jaaskelainen@parmance.com", "date": "2018-05-04T18:01:11Z"}, "committer": {"name": "Pekka J\u00e4\u00e4skel\u00e4inen", "email": "visit0r@gcc.gnu.org", "date": "2018-05-04T18:01:11Z"}, "message": "[BRIGFE] do not allow optimizations based on known C builtins\n\nIt can break inputs that have similarly named functions.\n\nFrom-SVN: r259949", "tree": {"sha": "5cde720925ab66fc52b317a5f1873932735679b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5cde720925ab66fc52b317a5f1873932735679b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/60a3d46c17e7cee099043c1564181ab2f3c21d41", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60a3d46c17e7cee099043c1564181ab2f3c21d41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/60a3d46c17e7cee099043c1564181ab2f3c21d41", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/60a3d46c17e7cee099043c1564181ab2f3c21d41/comments", "author": {"login": "pjaaskel", "id": 1652632, "node_id": "MDQ6VXNlcjE2NTI2MzI=", "avatar_url": "https://avatars.githubusercontent.com/u/1652632?v=4", "gravatar_id": "", "url": "https://api.github.com/users/pjaaskel", "html_url": "https://github.com/pjaaskel", "followers_url": "https://api.github.com/users/pjaaskel/followers", "following_url": "https://api.github.com/users/pjaaskel/following{/other_user}", "gists_url": "https://api.github.com/users/pjaaskel/gists{/gist_id}", "starred_url": "https://api.github.com/users/pjaaskel/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/pjaaskel/subscriptions", "organizations_url": "https://api.github.com/users/pjaaskel/orgs", "repos_url": "https://api.github.com/users/pjaaskel/repos", "events_url": "https://api.github.com/users/pjaaskel/events{/privacy}", "received_events_url": "https://api.github.com/users/pjaaskel/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "77c42d456e28d04b684a1774264a2d7be816676b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/77c42d456e28d04b684a1774264a2d7be816676b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/77c42d456e28d04b684a1774264a2d7be816676b"}], "stats": {"total": 21, "additions": 12, "deletions": 9}, "files": [{"sha": "7da06bc7d89fdee99ae96e256fead1b428817ecb", "filename": "gcc/brig/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60a3d46c17e7cee099043c1564181ab2f3c21d41/gcc%2Fbrig%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60a3d46c17e7cee099043c1564181ab2f3c21d41/gcc%2Fbrig%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbrig%2FChangeLog?ref=60a3d46c17e7cee099043c1564181ab2f3c21d41", "patch": "@@ -1,3 +1,8 @@\n+2018-05-04  Pekka J\u00e4\u00e4skel\u00e4inen  <pekka.jaaskelainen@parmance.com>\n+\n+\t* brig/brig-lang.c: Do not allow optimizations based on known C\n+\tbuiltins.\n+\n 2018-05-04  Pekka J\u00e4\u00e4skel\u00e4inen  <pekka.jaaskelainen@parmance.com>\n \n \t* brig/brig-lang.c: Allow controlling strict aliasing from"}, {"sha": "3c4d4bdcd458f2b672c2c0334a4867abc7a7d8d8", "filename": "gcc/brig/brig-lang.c", "status": "modified", "additions": 7, "deletions": 9, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/60a3d46c17e7cee099043c1564181ab2f3c21d41/gcc%2Fbrig%2Fbrig-lang.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/60a3d46c17e7cee099043c1564181ab2f3c21d41/gcc%2Fbrig%2Fbrig-lang.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fbrig%2Fbrig-lang.c?ref=60a3d46c17e7cee099043c1564181ab2f3c21d41", "patch": "@@ -136,6 +136,8 @@ brig_langhook_init_options_struct (struct gcc_options *opts)\n   opts->x_flag_signed_zeros = 1;\n \n   opts->x_optimize = 3;\n+\n+  flag_no_builtin = 1;\n }\n \n /* Handle Brig specific options.  Return 0 if we didn't do anything.  */\n@@ -635,9 +637,11 @@ builtin_type_for_size (int size, bool unsignedp)\n \n static void\n def_builtin_1 (enum built_in_function fncode, const char *name,\n-\t       enum built_in_class fnclass, tree fntype, tree libtype,\n-\t       bool both_p, bool fallback_p, bool nonansi_p,\n-\t       tree fnattrs, bool implicit_p)\n+\t       enum built_in_class fnclass ATTRIBUTE_UNUSED,\n+\t       tree fntype, tree libtype ATTRIBUTE_UNUSED,\n+\t       bool both_p ATTRIBUTE_UNUSED, bool fallback_p,\n+\t       bool nonansi_p ATTRIBUTE_UNUSED, tree fnattrs,\n+\t       bool implicit_p)\n {\n   tree decl;\n   const char *libname;\n@@ -650,12 +654,6 @@ def_builtin_1 (enum built_in_function fncode, const char *name,\n \t\t\t       (fallback_p ? libname : NULL),\n \t\t\t       fnattrs);\n \n-  if (both_p\n-      && !flag_no_builtin\n-      && !(nonansi_p && flag_no_nonansi_builtin))\n-    add_builtin_function (libname, libtype, fncode, fnclass,\n-\t\t\t  NULL, fnattrs);\n-\n   set_builtin_decl (fncode, decl, implicit_p);\n }\n "}]}