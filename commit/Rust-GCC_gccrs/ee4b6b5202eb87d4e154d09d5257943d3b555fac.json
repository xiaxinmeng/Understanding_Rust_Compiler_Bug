{"sha": "ee4b6b5202eb87d4e154d09d5257943d3b555fac", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWU0YjZiNTIwMmViODdkNGUxNTRkMDlkNTI1Nzk0M2QzYjU1NWZhYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-11-17T13:02:56Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-11-17T13:02:56Z"}, "message": "re PR fortran/55341 (address-sanitizer and Fortran)\n\n\tPR fortran/55341\n\t* trans-intrinsic.c (gfc_conv_intrinsic_transfer): Convert last\n\targument to memcpy to size_type_node type.\n\t* trans-stmt.c (gfc_conv_elemental_dependencies): Likewise.\n\t* trasn-array.c (duplicate_allocatable): Likewise.\n\nFrom-SVN: r193585", "tree": {"sha": "c39ad245ed82ae96d6e48e1bc3e5bd50fabcf94e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c39ad245ed82ae96d6e48e1bc3e5bd50fabcf94e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ee4b6b5202eb87d4e154d09d5257943d3b555fac", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee4b6b5202eb87d4e154d09d5257943d3b555fac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee4b6b5202eb87d4e154d09d5257943d3b555fac", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee4b6b5202eb87d4e154d09d5257943d3b555fac/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "741aacafff79e60410d224b72bae6364f2c3c40c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/741aacafff79e60410d224b72bae6364f2c3c40c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/741aacafff79e60410d224b72bae6364f2c3c40c"}], "stats": {"total": 40, "additions": 26, "deletions": 14}, "files": [{"sha": "bb3e70821d1cc6c69f9229e8258a64ec9f9408de", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=ee4b6b5202eb87d4e154d09d5257943d3b555fac", "patch": "@@ -1,3 +1,11 @@\n+2012-11-17  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/55341\n+\t* trans-intrinsic.c (gfc_conv_intrinsic_transfer): Convert last\n+\targument to memcpy to size_type_node type.\n+\t* trans-stmt.c (gfc_conv_elemental_dependencies): Likewise.\n+\t* trasn-array.c (duplicate_allocatable): Likewise.\n+\n 2012-11-16  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/55297"}, {"sha": "fc628ca28b65b68fb156aec53bc77d9765b47315", "filename": "gcc/fortran/trans-array.c", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2Ftrans-array.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2Ftrans-array.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-array.c?ref=ee4b6b5202eb87d4e154d09d5257943d3b555fac", "patch": "@@ -7341,8 +7341,8 @@ duplicate_allocatable (tree dest, tree src, tree type, int rank,\n \t}\n \n       tmp = builtin_decl_explicit (BUILT_IN_MEMCPY);\n-      tmp = build_call_expr_loc (input_location, tmp, 3,\n-\t\t\t\t dest, src, size);\n+      tmp = build_call_expr_loc (input_location, tmp, 3, dest, src,\n+\t\t\t\t fold_convert (size_type_node, size));\n     }\n   else\n     {\n@@ -7367,7 +7367,8 @@ duplicate_allocatable (tree dest, tree src, tree type, int rank,\n       tmp = builtin_decl_explicit (BUILT_IN_MEMCPY);\n       tmp = build_call_expr_loc (input_location,\n \t\t\ttmp, 3, gfc_conv_descriptor_data_get (dest),\n-\t\t\tgfc_conv_descriptor_data_get (src), size);\n+\t\t\tgfc_conv_descriptor_data_get (src),\n+\t\t\tfold_convert (size_type_node, size));\n     }\n \n   gfc_add_expr_to_block (&block, tmp);"}, {"sha": "a31284ee27c504823f36344f1794c02a959d2991", "filename": "gcc/fortran/trans-intrinsic.c", "status": "modified", "additions": 12, "deletions": 10, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2Ftrans-intrinsic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2Ftrans-intrinsic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-intrinsic.c?ref=ee4b6b5202eb87d4e154d09d5257943d3b555fac", "patch": "@@ -5600,14 +5600,16 @@ gfc_conv_intrinsic_transfer (gfc_se * se, gfc_expr * expr)\n   tmp = fold_convert (pvoid_type_node, tmp);\n \n   /* Use memcpy to do the transfer.  */\n-  tmp = build_call_expr_loc (input_location,\n-\t\t\t builtin_decl_explicit (BUILT_IN_MEMCPY),\n-\t\t\t 3,\n-\t\t\t tmp,\n-\t\t\t fold_convert (pvoid_type_node, source),\n-\t\t\t fold_build2_loc (input_location, MIN_EXPR,\n-\t\t\t\t\t  gfc_array_index_type,\n-\t\t\t\t\t  size_bytes, source_bytes));\n+  tmp\n+    = build_call_expr_loc (input_location,\n+\t\t\t   builtin_decl_explicit (BUILT_IN_MEMCPY), 3, tmp,\n+\t\t\t   fold_convert (pvoid_type_node, source),\n+\t\t\t   fold_convert (size_type_node,\n+\t\t\t\t\t fold_build2_loc (input_location,\n+\t\t\t\t\t\t\t  MIN_EXPR,\n+\t\t\t\t\t\t\t  gfc_array_index_type,\n+\t\t\t\t\t\t\t  size_bytes,\n+\t\t\t\t\t\t\t  source_bytes)));\n   gfc_add_expr_to_block (&se->pre, tmp);\n \n   se->expr = info->descriptor;\n@@ -5649,7 +5651,7 @@ gfc_conv_intrinsic_transfer (gfc_se * se, gfc_expr * expr)\n \t\t\t     builtin_decl_explicit (BUILT_IN_MEMCPY), 3,\n \t\t\t     fold_convert (pvoid_type_node, tmpdecl),\n \t\t\t     fold_convert (pvoid_type_node, ptr),\n-\t\t\t     extent);\n+\t\t\t     fold_convert (size_type_node, extent));\n       gfc_add_expr_to_block (&block, tmp);\n       indirect = gfc_finish_block (&block);\n \n@@ -5687,7 +5689,7 @@ gfc_conv_intrinsic_transfer (gfc_se * se, gfc_expr * expr)\n \t\t\t     builtin_decl_explicit (BUILT_IN_MEMCPY), 3,\n \t\t\t     fold_convert (pvoid_type_node, tmp),\n \t\t\t     fold_convert (pvoid_type_node, ptr),\n-\t\t\t     extent);\n+\t\t\t     fold_convert (size_type_node, extent));\n       gfc_add_expr_to_block (&se->pre, tmp);\n \n       /* For CLASS results, set the _vptr.  */"}, {"sha": "de22ce036e890658e06348287858d7bac893b185", "filename": "gcc/fortran/trans-stmt.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2Ftrans-stmt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ee4b6b5202eb87d4e154d09d5257943d3b555fac/gcc%2Ffortran%2Ftrans-stmt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-stmt.c?ref=ee4b6b5202eb87d4e154d09d5257943d3b555fac", "patch": "@@ -337,7 +337,8 @@ gfc_conv_elemental_dependencies (gfc_se * se, gfc_se * loopse,\n \t      tmp = gfc_conv_descriptor_data_get (tmp);\n \t      tmp = build_call_expr_loc (input_location,\n \t\t\t\t\t builtin_decl_explicit (BUILT_IN_MEMCPY),\n-\t\t\t\t\t 3, tmp, data, size);\n+\t\t\t\t\t 3, tmp, data,\n+\t\t\t\t\t fold_convert (size_type_node, size));\n \t    }\n \t  gfc_add_expr_to_block (&se->post, tmp);\n "}]}