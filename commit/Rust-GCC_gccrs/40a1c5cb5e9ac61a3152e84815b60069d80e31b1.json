{"sha": "40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDBhMWM1Y2I1ZTlhYzYxYTMxNTJlODQ4MTViNjAwNjlkODBlMzFiMQ==", "commit": {"author": {"name": "Mark Mitchell", "email": "mark@codesourcery.com", "date": "2004-09-03T00:43:59Z"}, "committer": {"name": "Mark Mitchell", "email": "mmitchel@gcc.gnu.org", "date": "2004-09-03T00:43:59Z"}, "message": "bpabi.h (TARGET_BPABI_CPP_BUILTINS): Define.\n\n\t* config/arm/bpabi.h (TARGET_BPABI_CPP_BUILTINS): Define.\n\t(TARGET_OS_CPP_BUILTINS): Likewise.\n\t* config/arm/symbian.h (TARGET_OS_CPP_BUILTINS): Include\n\tTARGET_BPABI_CPP_BUILTINS.\n\n\t* g++.dg/abi/arm_rtti1.C: New test.\n\n\t* libsupc++/typeinfo: Honor __GXX_MERGED_TYPEINFO_NAMES if already\n\tdefined.\n\n[[Split portion of a mixed commit.]]\n\nFrom-SVN: r87018.2", "tree": {"sha": "00f44a86fe46ab3dee185812c70fc99b06132af2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/00f44a86fe46ab3dee185812c70fc99b06132af2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/comments", "author": null, "committer": null, "parents": [{"sha": "085b68226c2664ccc04c9458e3985e328ea9e79e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/085b68226c2664ccc04c9458e3985e328ea9e79e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/085b68226c2664ccc04c9458e3985e328ea9e79e"}], "stats": {"total": 67, "additions": 59, "deletions": 8}, "files": [{"sha": "96eb1b86835ee5627e89fc8355fe8b48dfb92a2e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "patch": "@@ -1,3 +1,10 @@\n+2004-09-02  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* config/arm/bpabi.h (TARGET_BPABI_CPP_BUILTINS): Define.\n+\t(TARGET_OS_CPP_BUILTINS): Likewise.\n+\t* config/arm/symbian.h (TARGET_OS_CPP_BUILTINS): Include\n+\tTARGET_BPABI_CPP_BUILTINS.\n+\n 2004-09-02  Roman Zippel  <zippel@linux-m68k.org>\n  \n \t* combine.c (distribute_notes): Don't add REG_LABEL to jump insn."}, {"sha": "e2be11446f8dfe0456a925acb8b2bb9077d82566", "filename": "gcc/config/arm/bpabi.h", "status": "modified", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Fconfig%2Farm%2Fbpabi.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Fconfig%2Farm%2Fbpabi.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fbpabi.h?ref=40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "patch": "@@ -84,3 +84,19 @@\n #define DECLARE_LIBRARY_RENAMES RENAME_LIBRARY (floatdisf, l2f)\n #endif\n \n+/* The BPABI requires that we always use an out-of-line implementation\n+   of RTTI comparison, even if the target supports weak symbols,\n+   because the same object file might be used on a target that does\n+   not support merging symbols across DLL boundaries.  This macro is\n+   broken out separately so that it can be used within\n+   TARGET_OS_CPP_BUILTINS in configuration files for systems based on\n+   the BPABI.  */\n+#define TARGET_BPABI_CPP_BUILTINS()\t\t\t\\\n+  do\t\t\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\\\n+      builtin_define (\"__GXX_MERGED_TYPEINFO_NAMES=0\");\t\\\n+    }\t\t\t\t\t\t\t\\\n+  while (false)\n+\n+#define TARGET_OS_CPP_BUILTINS() \\\n+  TARGET_BPABI_CPP_BUILTINS()"}, {"sha": "a900d76f76b6f9b7d48e191b6fdf99f9f91ad733", "filename": "gcc/config/arm/symbian.h", "status": "modified", "additions": 5, "deletions": 2, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Fconfig%2Farm%2Fsymbian.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Fconfig%2Farm%2Fsymbian.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fsymbian.h?ref=40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "patch": "@@ -75,9 +75,12 @@\n #define RENAME_LIBRARY(GCC_NAME, AEABI_NAME) /* empty */\n \n /* Define the __symbian__ macro.  */\n+#undef TARGET_OS_CPP_BUILTINS\n #define TARGET_OS_CPP_BUILTINS()\t\t\\\n-  do \t\t\t\t\t\t\\\n+  do\t\t\t\t\t\t\\\n     {\t\t\t\t\t\t\\\n+      /* Include the default BPABI stuff.  */\t\\\n+      TARGET_BPABI_CPP_BUILTINS ();\t\t\\\n       builtin_define (\"__symbian__\");\t\t\\\n-    } \t\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\\\n   while (false)"}, {"sha": "428480c3b3c1b01e2055e60a8c46bb2a61937739", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "patch": "@@ -1,3 +1,7 @@\n+2004-09-02  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* g++.dg/abi/arm_rtti1.C: New test.\n+\n 2004-09-02  Geoffrey Keating  <geoffk@apple.com>\n \n \t* gcc.dg/ppc-vector-memcpy.c: New."}, {"sha": "a481bdd1f13869b7ef94adb39fbf4d0a7dd68c91", "filename": "gcc/testsuite/g++.dg/abi/arm_rtti1.C", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Farm_rtti1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Farm_rtti1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fabi%2Farm_rtti1.C?ref=40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "patch": "@@ -0,0 +1,14 @@\n+// { dg-do compile { target arm*-*-eabi* arm*-*-symbianelf* } }\n+// { dg-options \"-O2\" } \n+// Check that, even when optimizing, we emit an out-of-line call to\n+// the type-info comparison function.\n+// { dg-final { scan-assembler _ZNKSt9type_infoeqERKS_ } }\n+\n+#include <typeinfo>\n+\n+extern const std::type_info& t1;\n+extern const std::type_info& t2;\n+\n+bool f() {\n+  return t1 == t2;\n+}"}, {"sha": "1cdfef625ec17090db2dfff25e8cd4bc705fa60b", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "patch": "@@ -1,3 +1,8 @@\n+2004-09-02  Mark Mitchell  <mark@codesourcery.com>\n+\n+\t* libsupc++/typeinfo: Honor __GXX_MERGED_TYPEINFO_NAMES if already\n+\tdefined. \n+\n 2004-09-02  Benjamin Kosnik  <bkoz@redhat.com>\n             Simon Richter  <Simon.Richter@hogyros.de>\n \t"}, {"sha": "81824223eb641bf08ecd88c1bab048ec54998207", "filename": "libstdc++-v3/libsupc++/typeinfo", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Ftypeinfo", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/40a1c5cb5e9ac61a3152e84815b60069d80e31b1/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Ftypeinfo", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Flibsupc%2B%2B%2Ftypeinfo?ref=40a1c5cb5e9ac61a3152e84815b60069d80e31b1", "patch": "@@ -46,12 +46,14 @@ namespace __cxxabiv1\n   class __class_type_info;\n } // namespace __cxxabiv1\n \n-#if !__GXX_WEAK__\n-  // If weak symbols are not supported, typeinfo names are not merged.\n-  #define __GXX_MERGED_TYPEINFO_NAMES 0\n-#else\n-  // On platforms that support weak symbols, typeinfo names are merged.\n-  #define __GXX_MERGED_TYPEINFO_NAMES 1\n+#ifndef __GXX_MERGED_TYPEINFO_NAMES\n+  #if !__GXX_WEAK__\n+    // If weak symbols are not supported, typeinfo names are not merged.\n+    #define __GXX_MERGED_TYPEINFO_NAMES 0\n+  #else\n+    // On platforms that support weak symbols, typeinfo names are merged.\n+    #define __GXX_MERGED_TYPEINFO_NAMES 1\n+  #endif\n #endif\n \n namespace std "}]}