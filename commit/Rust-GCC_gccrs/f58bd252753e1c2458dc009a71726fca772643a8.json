{"sha": "f58bd252753e1c2458dc009a71726fca772643a8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjU4YmQyNTI3NTNlMWMyNDU4ZGMwMDlhNzE3MjZmY2E3NzI2NDNhOA==", "commit": {"author": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2019-05-02T18:45:22Z"}, "committer": {"name": "Segher Boessenkool", "email": "segher@gcc.gnu.org", "date": "2019-05-02T18:45:22Z"}, "message": "rs6000: Debug regnums for TM registers\n\nSince GCC 8, we have output incorrect numbers for the transactional\nmemory registers.\n\nAlso, we didn't output the correct DWARF register numbers for those.\nThe number for sprN is 100+N.\n\nThis fixes both these issues.\n\n\n\t* config/rs6000/rs6000.c (rs6000_dbx_register_number): Return the\n\tcorrect numbers for TFHAR, TFIAR, TEXASR.\n\nFrom-SVN: r270819", "tree": {"sha": "95801681e6a75e85817467963bd54941814cc925", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/95801681e6a75e85817467963bd54941814cc925"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f58bd252753e1c2458dc009a71726fca772643a8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f58bd252753e1c2458dc009a71726fca772643a8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f58bd252753e1c2458dc009a71726fca772643a8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f58bd252753e1c2458dc009a71726fca772643a8/comments", "author": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b74c94ff419e8c69ae1bdaa291445377015d751e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b74c94ff419e8c69ae1bdaa291445377015d751e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b74c94ff419e8c69ae1bdaa291445377015d751e"}], "stats": {"total": 27, "additions": 24, "deletions": 3}, "files": [{"sha": "88d83640e26c32fefff70d72a7a3fe6df5df8687", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58bd252753e1c2458dc009a71726fca772643a8/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58bd252753e1c2458dc009a71726fca772643a8/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f58bd252753e1c2458dc009a71726fca772643a8", "patch": "@@ -1,3 +1,8 @@\n+2019-05-02  Segher Boessenkool  <segher@kernel.crashing.org>\n+\n+\t* config/rs6000/rs6000.c (rs6000_dbx_register_number): Return the\n+\tcorrect numbers for TFHAR, TFIAR, TEXASR.\n+\n 2019-05-02  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/89653"}, {"sha": "f8e9fd2fd80461bf82b1430949da533a00aa0ae9", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 19, "deletions": 3, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f58bd252753e1c2458dc009a71726fca772643a8/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f58bd252753e1c2458dc009a71726fca772643a8/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=f58bd252753e1c2458dc009a71726fca772643a8", "patch": "@@ -36269,10 +36269,20 @@ rs6000_init_dwarf_reg_sizes_extra (tree address)\n unsigned int\n rs6000_dbx_register_number (unsigned int regno, unsigned int format)\n {\n-  /* Except for the above, we use the internal number for non-DWARF\n-     debug information, and also for .eh_frame.  */\n+  /* We use the GCC 7 (and before) internal number for non-DWARF debug\n+     information, and also for .eh_frame.  */\n   if ((format == 0 && write_symbols != DWARF2_DEBUG) || format == 2)\n-    return regno;\n+    {\n+      /* Translate the regnos to their numbers in GCC 7 (and before).  */\n+      if (regno == TFHAR_REGNO)\n+\tregno = 114;\n+      else if (regno == TFIAR_REGNO)\n+\tregno = 115;\n+      else if (regno == TEXASR_REGNO)\n+\tregno = 116;\n+\n+      return regno;\n+    }\n \n   /* On some platforms, we use the standard DWARF register\n      numbering for .debug_info and .debug_frame.  */\n@@ -36299,6 +36309,12 @@ rs6000_dbx_register_number (unsigned int regno, unsigned int format)\n     return 356;\n   if (regno == VSCR_REGNO)\n     return 67;\n+  if (regno == TFHAR_REGNO)\n+    return 228;\n+  if (regno == TFIAR_REGNO)\n+    return 229;\n+  if (regno == TEXASR_REGNO)\n+    return 230;\n #endif\n   return regno;\n }"}]}