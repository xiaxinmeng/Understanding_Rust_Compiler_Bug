{"sha": "f91770216eade83f068528c1e4f00e2ac3b23044", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjkxNzcwMjE2ZWFkZTgzZjA2ODUyOGMxZTRmMDBlMmFjM2IyMzA0NA==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-08-13T07:38:41Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-08-13T08:27:37Z"}, "message": "ipa: fix ICE in get_default_value\n\nThe patch aligns code with ipcp_bits_lattice::set_to_constant\nwhere we properly mask m_value with m_mask. The same should\nbe done here.\n\ngcc/ChangeLog:\n\n\tPR ipa/96482\n\t* ipa-cp.c (ipcp_bits_lattice::meet_with_1): Mask m_value\n\twith m_mask.\n\ngcc/testsuite/ChangeLog:\n\n\tPR ipa/96482\n\t* gcc.dg/ipa/pr96482-2.c: New test.", "tree": {"sha": "21fa47470882ead9d0bc6ce20225990b26e3e5ab", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/21fa47470882ead9d0bc6ce20225990b26e3e5ab"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f91770216eade83f068528c1e4f00e2ac3b23044", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f91770216eade83f068528c1e4f00e2ac3b23044", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f91770216eade83f068528c1e4f00e2ac3b23044", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f91770216eade83f068528c1e4f00e2ac3b23044/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "2b5490f5d1633fedf20e6eba87153c5963c61368", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2b5490f5d1633fedf20e6eba87153c5963c61368", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2b5490f5d1633fedf20e6eba87153c5963c61368"}], "stats": {"total": 35, "additions": 34, "deletions": 1}, "files": [{"sha": "e4910a04ffaa03776cbaed17dd7dcbb34ba4b2e1", "filename": "gcc/ipa-cp.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91770216eade83f068528c1e4f00e2ac3b23044/gcc%2Fipa-cp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91770216eade83f068528c1e4f00e2ac3b23044/gcc%2Fipa-cp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-cp.c?ref=f91770216eade83f068528c1e4f00e2ac3b23044", "patch": "@@ -1048,7 +1048,7 @@ ipcp_bits_lattice::meet_with_1 (widest_int value, widest_int mask,\n \n   widest_int old_mask = m_mask;\n   m_mask = (m_mask | mask) | (m_value ^ value);\n-  m_value &= value;\n+  m_value &= ~m_mask;\n \n   if (wi::sext (m_mask, precision) == -1)\n     return set_to_bottom ();"}, {"sha": "54b71ac4fc0151bc0b62a70e5e8e4360337e337f", "filename": "gcc/testsuite/gcc.dg/ipa/pr96482-2.c", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f91770216eade83f068528c1e4f00e2ac3b23044/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fpr96482-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f91770216eade83f068528c1e4f00e2ac3b23044/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fpr96482-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fipa%2Fpr96482-2.c?ref=f91770216eade83f068528c1e4f00e2ac3b23044", "patch": "@@ -0,0 +1,33 @@\n+/* PR ipa/96482 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2\"  } */\n+\n+int i2c_transfer();\n+void _dev_err();\n+\n+struct i2c_msg {\n+  char bufaddr;\n+  int adapterdev;\n+} wdt87xx_i2c_xfer_client;\n+\n+int wdt87xx_i2c_xfer_client_0, wdt87xx_i2c_xfer_rxdata, wdt87xx_get_string_str_idx;\n+\n+void\n+static wdt87xx_i2c_xfer(void *txdata, unsigned rxlen) {\n+  struct i2c_msg msgs[] = {wdt87xx_i2c_xfer_client_0, rxlen,\n+                           wdt87xx_i2c_xfer_rxdata};\n+  int error = i2c_transfer(wdt87xx_i2c_xfer_client, msgs);\n+  _dev_err(\"\", __func__, error);\n+}\n+static void wdt87xx_get_string(unsigned len) {\n+  char tx_buf[] = {wdt87xx_get_string_str_idx, 3};\n+  int rx_len = len + 2;\n+  wdt87xx_i2c_xfer(tx_buf, rx_len);\n+}\n+\n+void\n+wdt87xx_ts_probe_tx_buf() {\n+  wdt87xx_get_string(34);\n+  wdt87xx_get_string(8);\n+  wdt87xx_i2c_xfer(wdt87xx_ts_probe_tx_buf, 2);\n+}"}]}