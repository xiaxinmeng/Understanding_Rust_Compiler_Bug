{"sha": "f5440ac7ad535edcf143a877c3da11a41cbf2c37", "node_id": "C_kwDOANBUbNoAKGY1NDQwYWM3YWQ1MzVlZGNmMTQzYTg3N2MzZGExMWE0MWNiZjJjMzc", "commit": {"author": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-09-28T13:54:20Z"}, "committer": {"name": "Aldy Hernandez", "email": "aldyh@redhat.com", "date": "2021-09-30T07:54:16Z"}, "message": "Plug possible snprintf overflow in lto-wrapper.\n\nMy upcoming improvements to the DOM threader triggered a warning in\nthis code.  It looks like the format string is \".ltrans%u.ltrans\", but\nwe're only writing a max of \".ltrans\" + whatever the MAX_INT is here.\n\nTested on x86-64 Linux.\n\ngcc/ChangeLog:\n\n\t* lto-wrapper.c (run_gcc): Plug snprintf overflow.", "tree": {"sha": "50900216027ba0110ee7787e2b6e1da6ab0906c6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50900216027ba0110ee7787e2b6e1da6ab0906c6"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f5440ac7ad535edcf143a877c3da11a41cbf2c37", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5440ac7ad535edcf143a877c3da11a41cbf2c37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f5440ac7ad535edcf143a877c3da11a41cbf2c37", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f5440ac7ad535edcf143a877c3da11a41cbf2c37/comments", "author": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "committer": {"login": "aldyh", "id": 12937877, "node_id": "MDQ6VXNlcjEyOTM3ODc3", "avatar_url": "https://avatars.githubusercontent.com/u/12937877?v=4", "gravatar_id": "", "url": "https://api.github.com/users/aldyh", "html_url": "https://github.com/aldyh", "followers_url": "https://api.github.com/users/aldyh/followers", "following_url": "https://api.github.com/users/aldyh/following{/other_user}", "gists_url": "https://api.github.com/users/aldyh/gists{/gist_id}", "starred_url": "https://api.github.com/users/aldyh/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/aldyh/subscriptions", "organizations_url": "https://api.github.com/users/aldyh/orgs", "repos_url": "https://api.github.com/users/aldyh/repos", "events_url": "https://api.github.com/users/aldyh/events{/privacy}", "received_events_url": "https://api.github.com/users/aldyh/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "b38a4bd10249b5070ea1f4708a0fd228df268c26", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b38a4bd10249b5070ea1f4708a0fd228df268c26", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b38a4bd10249b5070ea1f4708a0fd228df268c26"}], "stats": {"total": 10, "additions": 7, "deletions": 3}, "files": [{"sha": "7b9e4883f38e19271d38a7464834e1ad2498bd27", "filename": "gcc/lto-wrapper.c", "status": "modified", "additions": 7, "deletions": 3, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f5440ac7ad535edcf143a877c3da11a41cbf2c37/gcc%2Flto-wrapper.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f5440ac7ad535edcf143a877c3da11a41cbf2c37/gcc%2Flto-wrapper.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flto-wrapper.c?ref=f5440ac7ad535edcf143a877c3da11a41cbf2c37", "patch": "@@ -1983,7 +1983,9 @@ run_gcc (unsigned argc, char *argv[])\n \t  output_name = XOBFINISH (&env_obstack, char *);\n \n \t  /* Adjust the dumpbase if the linker output file was seen.  */\n-\t  int dumpbase_len = (strlen (dumppfx) + sizeof (DUMPBASE_SUFFIX));\n+\t  int dumpbase_len = (strlen (dumppfx)\n+\t\t\t      + sizeof (DUMPBASE_SUFFIX)\n+\t\t\t      + sizeof (\".ltrans\"));\n \t  char *dumpbase = (char *) xmalloc (dumpbase_len + 1);\n \t  snprintf (dumpbase, dumpbase_len, \"%sltrans%u.ltrans\", dumppfx, i);\n \t  argv_ptr[0] = dumpbase;\n@@ -2009,9 +2011,11 @@ run_gcc (unsigned argc, char *argv[])\n \t    }\n \t  else\n \t    {\n-\t      char argsuffix[sizeof (DUMPBASE_SUFFIX) + 1];\n+\t      char argsuffix[sizeof (DUMPBASE_SUFFIX)\n+\t\t\t     + sizeof (\".ltrans_args\") + 1];\n \t      if (save_temps)\n-\t\tsnprintf (argsuffix, sizeof (DUMPBASE_SUFFIX),\n+\t\tsnprintf (argsuffix,\n+\t\t\t  sizeof (DUMPBASE_SUFFIX) + sizeof (\".ltrans_args\"),\n \t\t\t  \"ltrans%u.ltrans_args\", i);\n \t      fork_execute (new_argv[0], CONST_CAST (char **, new_argv),\n \t\t\t    true, save_temps ? argsuffix : NULL);"}]}