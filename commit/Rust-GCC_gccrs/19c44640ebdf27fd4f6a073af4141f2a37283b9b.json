{"sha": "19c44640ebdf27fd4f6a073af4141f2a37283b9b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTljNDQ2NDBlYmRmMjdmZDRmNmEwNzNhZjQxNDFmMmEzNzI4M2I5Yg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-07-07T12:49:17Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-07-07T12:49:17Z"}, "message": "re PR middle-end/49640 (Internal compiler in C99 code (using variable-length arrays) and OpenMP)\n\n\tPR middle-end/49640\n\t* gimplify.c (gimplify_compound_lval): For last 2 ARRAY_*REF\n\toperands and last COMPONENT_REF operand call gimplify_expr on it\n\tif non-NULL.\n\n\t* gcc.dg/gomp/pr49640.c: New test.\n\nFrom-SVN: r175967", "tree": {"sha": "9739022e90d795baad3ede5dfb7cb3073a4d932d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9739022e90d795baad3ede5dfb7cb3073a4d932d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/19c44640ebdf27fd4f6a073af4141f2a37283b9b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19c44640ebdf27fd4f6a073af4141f2a37283b9b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/19c44640ebdf27fd4f6a073af4141f2a37283b9b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/19c44640ebdf27fd4f6a073af4141f2a37283b9b/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4054bc52d6c353aceeb7a9312347c2c98e837783", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4054bc52d6c353aceeb7a9312347c2c98e837783", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4054bc52d6c353aceeb7a9312347c2c98e837783"}], "stats": {"total": 63, "additions": 61, "deletions": 2}, "files": [{"sha": "a203616640b9ef430521ef5e854fb51e2bdf6d8c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=19c44640ebdf27fd4f6a073af4141f2a37283b9b", "patch": "@@ -1,3 +1,10 @@\n+2011-07-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/49640\n+\t* gimplify.c (gimplify_compound_lval): For last 2 ARRAY_*REF\n+\toperands and last COMPONENT_REF operand call gimplify_expr on it\n+\tif non-NULL.\n+\n 2011-07-07  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \tPR libmudflap/49550"}, {"sha": "4ff7e933834f26b855b7317a66a14ed08d7c7892", "filename": "gcc/gimplify.c", "status": "modified", "additions": 20, "deletions": 2, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=19c44640ebdf27fd4f6a073af4141f2a37283b9b", "patch": "@@ -2010,8 +2010,14 @@ gimplify_compound_lval (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \t\t  ret = MIN (ret, tret);\n \t\t}\n \t    }\n+\t  else\n+\t    {\n+\t      tret = gimplify_expr (&TREE_OPERAND (t, 2), pre_p, post_p,\n+\t\t\t\t    is_gimple_reg, fb_rvalue);\n+\t      ret = MIN (ret, tret);\n+\t    }\n \n-\t  if (!TREE_OPERAND (t, 3))\n+\t  if (TREE_OPERAND (t, 3) == NULL_TREE)\n \t    {\n \t      tree elmt_type = TREE_TYPE (TREE_TYPE (TREE_OPERAND (t, 0)));\n \t      tree elmt_size = unshare_expr (array_ref_element_size (t));\n@@ -2031,11 +2037,17 @@ gimplify_compound_lval (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \t\t  ret = MIN (ret, tret);\n \t\t}\n \t    }\n+\t  else\n+\t    {\n+\t      tret = gimplify_expr (&TREE_OPERAND (t, 3), pre_p, post_p,\n+\t\t\t\t    is_gimple_reg, fb_rvalue);\n+\t      ret = MIN (ret, tret);\n+\t    }\n \t}\n       else if (TREE_CODE (t) == COMPONENT_REF)\n \t{\n \t  /* Set the field offset into T and gimplify it.  */\n-\t  if (!TREE_OPERAND (t, 2))\n+\t  if (TREE_OPERAND (t, 2) == NULL_TREE)\n \t    {\n \t      tree offset = unshare_expr (component_ref_field_offset (t));\n \t      tree field = TREE_OPERAND (t, 1);\n@@ -2054,6 +2066,12 @@ gimplify_compound_lval (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n \t\t  ret = MIN (ret, tret);\n \t\t}\n \t    }\n+\t  else\n+\t    {\n+\t      tret = gimplify_expr (&TREE_OPERAND (t, 2), pre_p, post_p,\n+\t\t\t\t    is_gimple_reg, fb_rvalue);\n+\t      ret = MIN (ret, tret);\n+\t    }\n \t}\n     }\n "}, {"sha": "e54290995d87711f37ee278b7540bedd08f67293", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=19c44640ebdf27fd4f6a073af4141f2a37283b9b", "patch": "@@ -1,3 +1,8 @@\n+2011-07-07  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/49640\n+\t* gcc.dg/gomp/pr49640.c: New test.\n+\n 2011-07-07  Richard Guenther  <rguenther@suse.de>\n \n \t* gcc.dg/graphite/pr37485.c: Add -floop-block."}, {"sha": "6e0973864a3cd633b59663f8a0bdf9ef31016449", "filename": "gcc/testsuite/gcc.dg/gomp/pr49640.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr49640.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/19c44640ebdf27fd4f6a073af4141f2a37283b9b/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr49640.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgomp%2Fpr49640.c?ref=19c44640ebdf27fd4f6a073af4141f2a37283b9b", "patch": "@@ -0,0 +1,29 @@\n+/* PR middle-end/49640 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -std=gnu99 -fopenmp\" } */\n+\n+void\n+foo (int N, int M, int K, int P, int Q, int R, int i, int j, int k,\n+     unsigned char x[P][Q][R], int y[N][M][K])\n+{\n+  int ii, jj, kk;\n+\n+#pragma omp parallel for private(ii,jj,kk)\n+  for (ii = 0; ii < P; ++ii)\n+    for (jj = 0; jj < Q; ++jj)\n+      for (kk = 0; kk < R; ++kk)\n+\ty[i + ii][j + jj][k + kk] = x[ii][jj][kk];\n+}\n+\n+void\n+bar (int N, int M, int K, int P, int Q, int R, int i, int j, int k,\n+     unsigned char x[P][Q][R], float y[N][M][K], float factor, float zero)\n+{\n+  int ii, jj, kk;\n+\n+#pragma omp parallel for private(ii,jj,kk)\n+  for (ii = 0; ii < P; ++ii)\n+    for (jj = 0; jj < Q; ++jj)\n+      for (kk = 0; kk < R; ++kk)\n+\ty[i + ii][j + jj][k + kk] = factor * x[ii][jj][kk] + zero;\n+}"}]}