{"sha": "63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjM4OTJmYTIwN2ZlZTcxNmRmYzM0Zjk0ZjlkMmVkZmJjNWZhODRjYQ==", "commit": {"author": {"name": "Kugan Vivekanandarajah", "email": "kuganv@linaro.org", "date": "2013-12-11T12:57:08Z"}, "committer": {"name": "Christophe Lyon", "email": "clyon@gcc.gnu.org", "date": "2013-12-11T12:57:08Z"}, "message": "configure.ac: Add check for aarch64 assembler -mabi support.\n\n2013-12-11  Kugan Vivekanandarajah  <kuganv@linaro.org>\n\n\t* configure.ac: Add check for aarch64 assembler -mabi support.\n\t* configure: Regenerate.\n\t* config.in: Regenerate.\n\t* config/aarch64/aarch64-elf.h (ASM_MABI_SPEC): New define.\n\t(ASM_SPEC): Update to substitute -mabi with ASM_MABI_SPEC.\n\t* config/aarch64/aarch64.h (aarch64_override_options): Issue error\n\tif assembler does not support -mabi and option ilp32 is selected.\n\t* doc/install.texi: Added note that building gcc 4.9 and after\n\twith pre 2.24 binutils will not support -mabi=ilp32.\n\nFrom-SVN: r205891", "tree": {"sha": "b40115da4c36ad51b26fe7ac40cf50aff7efb289", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b40115da4c36ad51b26fe7ac40cf50aff7efb289"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/comments", "author": null, "committer": null, "parents": [{"sha": "2ce064c344f9e104a82049495733ca3205fa720a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ce064c344f9e104a82049495733ca3205fa720a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ce064c344f9e104a82049495733ca3205fa720a"}], "stats": {"total": 67, "additions": 65, "deletions": 2}, "files": [{"sha": "7e824645d0a922bb5a2def8c13883c60e9c7f9ef", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "patch": "@@ -1,3 +1,15 @@\n+2013-12-11  Kugan Vivekanandarajah  <kuganv@linaro.org>\n+\n+\t* configure.ac: Add check for aarch64 assembler -mabi support.\n+\t* configure: Regenerate.\n+\t* config.in: Regenerate.\n+\t* config/aarch64/aarch64-elf.h (ASM_MABI_SPEC): New define.\n+\t(ASM_SPEC): Update to substitute -mabi with ASM_MABI_SPEC.\n+\t* config/aarch64/aarch64.h (aarch64_override_options): Issue error\n+\tif assembler does not support -mabi and option ilp32 is selected.\n+\t* doc/install.texi: Added note that building gcc 4.9 and after\n+\twith pre 2.24 binutils will not support -mabi=ilp32.\n+\n 2013-12-11  Marek Polacek  <polacek@redhat.com>\n \n \tPR sanitizer/59399"}, {"sha": "a66c3dbe9a12fb0272c5a0631b4ff8a233c4d60e", "filename": "gcc/config/aarch64/aarch64-elf.h", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fconfig%2Faarch64%2Faarch64-elf.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fconfig%2Faarch64%2Faarch64-elf.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64-elf.h?ref=63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "patch": "@@ -134,13 +134,19 @@\n   \" %{!mbig-endian:%{!mlittle-endian:\" ENDIAN_SPEC \"}}\" \\\n   \" %{!mabi=*:\" ABI_SPEC \"}\"\n \n+#ifdef HAVE_AS_MABI_OPTION\n+#define ASM_MABI_SPEC\t\"%{mabi=*:-mabi=%*}\"\n+#else\n+#define ASM_MABI_SPEC\t\"%{mabi=lp64:}\"\n+#endif\n+\n #ifndef ASM_SPEC\n #define ASM_SPEC \"\\\n %{mbig-endian:-EB} \\\n %{mlittle-endian:-EL} \\\n %{mcpu=*:-mcpu=%*} \\\n-%{march=*:-march=%*} \\\n-%{mabi=*:-mabi=%*}\"\n+%{march=*:-march=%*}\" \\\n+ASM_MABI_SPEC\n #endif\n \n #undef TYPE_OPERAND_FMT"}, {"sha": "afcf43f833114c90a06cb963f9ec219d93413a2c", "filename": "gcc/config/aarch64/aarch64.c", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fconfig%2Faarch64%2Faarch64.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fconfig%2Faarch64%2Faarch64.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Faarch64%2Faarch64.c?ref=63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "patch": "@@ -5187,6 +5187,13 @@ aarch64_override_options (void)\n       aarch64_parse_tune ();\n     }\n \n+#ifndef HAVE_AS_MABI_OPTION\n+  /* The compiler may have been configured with 2.23.* binutils, which does\n+     not have support for ILP32.  */\n+  if (TARGET_ILP32)\n+    error (\"Assembler does not support -mabi=ilp32\");\n+#endif\n+\n   initialize_aarch64_code_model ();\n \n   aarch64_build_bitmask_table ();"}, {"sha": "59de08da86d048e5988419835d067b7639fb6a7f", "filename": "gcc/configure.ac", "status": "modified", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "patch": "@@ -3494,6 +3494,35 @@ AC_DEFINE_UNQUOTED(HAVE_LTO_PLUGIN, $gcc_cv_lto_plugin,\n AC_MSG_RESULT($gcc_cv_lto_plugin)\n \n case \"$target\" in\n+  aarch64*-*-*)\n+    gcc_GAS_CHECK_FEATURE([-mabi option], gcc_cv_as_aarch64_mabi,,\n+                          [-mabi=lp64], [.text],,,)\n+    if test x$gcc_cv_as_aarch64_mabi = xyes; then\n+      AC_DEFINE(HAVE_AS_MABI_OPTION, 1,\n+                [Define if your assembler supports the -mabi option.])\n+    else\n+      if test x$with_abi = xilp32; then\n+        AC_MSG_ERROR([Assembler does not support -mabi=ilp32.\\\n+                     Upgrade the Assembler.])\n+      fi\n+      if test x\"$with_multilib_list\" = xdefault; then\n+        TM_MULTILIB_CONFIG=lp64\n+      else\n+        aarch64_multilibs=`echo $with_multilib_list | sed -e 's/,/ /g'`\n+        for aarch64_multilib in ${aarch64_multilibs}; do\n+          case ${aarch64_multilib} in\n+            ilp32)\n+              AC_MSG_ERROR([Assembler does not support -mabi=ilp32.\\\n+                            Upgrade the Assembler.])\n+              ;;\n+            *)\n+              ;;\n+          esac\n+        done\n+      fi\n+    fi\n+    ;;\n+\n   # All TARGET_ABI_OSF targets.\n   alpha*-*-linux* | alpha*-*-*bsd*)\n     gcc_GAS_CHECK_FEATURE([explicit relocation support],"}, {"sha": "71aa7fc9866b2d418e0a70e80f7a1a2069aa4971", "filename": "gcc/doc/install.texi", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fdoc%2Finstall.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/63892fa207fee716dfc34f94f9d2edfbc5fa84ca/gcc%2Fdoc%2Finstall.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finstall.texi?ref=63892fa207fee716dfc34f94f9d2edfbc5fa84ca", "patch": "@@ -3749,6 +3749,15 @@ is required to build GCC@.  For GCC 3.3 and later, this is the default.\n For gcc 3.4.3 and later, @option{--enable-libunwind-exceptions} is\n removed and the system libunwind library will always be used.\n \n+@html\n+<hr />\n+@end html\n+@anchor{aarch64-x-x}\n+@heading aarch64*-*-*\n+Pre 2.24 binutils does not have support for selecting -mabi and does not\n+support ILP32.  If GCC 4.9 or later is built with pre 2.24, GCC will not\n+support option -mabi=ilp32.\n+\n @html\n <hr />\n <!-- rs6000-ibm-aix*, powerpc-ibm-aix* -->"}]}