{"sha": "ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWI0NGYyODE4YzM4ZTNlYzE4OTdmYjhmMTJkODkyM2Q0OWIzOTRjNg==", "commit": {"author": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2007-04-30T17:01:18Z"}, "committer": {"name": "Andrew Pinski", "email": "pinskia@gcc.gnu.org", "date": "2007-04-30T17:01:18Z"}, "message": "[multiple changes]\n\n2007-04-30  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n\n        PR C++/31721\n        * tree.c (reconstruct_complex_type): Reconstruct a reference\n        correctly.\n        Also use the same mode for the pointer as the old pointer type.\n2007-04-30  Andrew pinski  <andrew_pinski@playstation.sony.com>\n\n        PR C++/31721\n        * g++.dg/ext/vector7.C: New testcase.\n\nFrom-SVN: r124300", "tree": {"sha": "f862f637a67c0b3826daf74e6d0df59e36b7417c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f862f637a67c0b3826daf74e6d0df59e36b7417c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/comments", "author": null, "committer": null, "parents": [{"sha": "8f1a19e2c51a192569f3553cbd35ea59499684f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8f1a19e2c51a192569f3553cbd35ea59499684f8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8f1a19e2c51a192569f3553cbd35ea59499684f8"}], "stats": {"total": 35, "additions": 31, "deletions": 4}, "files": [{"sha": "da8aaf6b53d886bd8ac3aced2777db411c409082", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "patch": "@@ -1,3 +1,10 @@\n+2007-04-30  Andrew Pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR C++/31721\n+\t* tree.c (reconstruct_complex_type): Reconstruct a reference\n+\tcorrectly.\n+\tAlso use the same mode for the pointer as the old pointer type.\n+\n 2007-04-30  Francois-Xavier Coudert  <coudert@clipper.ens.fr>\n \n \t* doc/trouble.texi (Interoperation): Remove note about Ultrix"}, {"sha": "efe44a6e78b356cc94e162d9b5973c617d2198a3", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "patch": "@@ -1,4 +1,9 @@\n-2007-04-29 Francois-Xavier Coudert <fxcoudert@gcc.gnu.org>\n+2007-04-30  Andrew pinski  <andrew_pinski@playstation.sony.com>\n+\n+\tPR C++/31721\n+\t* g++.dg/ext/vector7.C: New testcase.\n+\n+2007-04-29  Francois-Xavier Coudert <fxcoudert@gcc.gnu.org>\n \n \tPR fortran/31591\n \t* gfortran.dg/bound_simplification_1.f90: New test."}, {"sha": "cd259b1a2581407e887ab43c546aaee251a7ce30", "filename": "gcc/testsuite/g++.dg/ext/vector7.C", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvector7.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvector7.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fext%2Fvector7.C?ref=ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "patch": "@@ -0,0 +1,8 @@\n+// { dg-options \"\" }\n+// { dg-do compile }\n+// PR C++/31721 and PR 14217\n+// the attribute vector_size would change a reference type into a pointer type which was wrong.\n+\n+#define vector __attribute__((__vector_size__(16) ))\n+vector int b;\n+vector int &a = b;"}, {"sha": "fbaeb737cc8ed7bba25058507f5da303381db414", "filename": "gcc/tree.c", "status": "modified", "additions": 10, "deletions": 3, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2Ftree.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ab44f2818c38e3ec1897fb8f12d8923d49b394c6/gcc%2Ftree.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree.c?ref=ab44f2818c38e3ec1897fb8f12d8923d49b394c6", "patch": "@@ -7236,11 +7236,18 @@ tree\n reconstruct_complex_type (tree type, tree bottom)\n {\n   tree inner, outer;\n-\n-  if (POINTER_TYPE_P (type))\n+  \n+  if (TREE_CODE (type) == POINTER_TYPE)\n+    {\n+      inner = reconstruct_complex_type (TREE_TYPE (type), bottom);\n+      outer = build_pointer_type_for_mode (inner, TYPE_MODE (type),\n+\t\t\t\t\t   TYPE_REF_CAN_ALIAS_ALL (type));\n+    }\n+  else if (TREE_CODE (type) == REFERENCE_TYPE)\n     {\n       inner = reconstruct_complex_type (TREE_TYPE (type), bottom);\n-      outer = build_pointer_type (inner);\n+      outer = build_reference_type_for_mode (inner, TYPE_MODE (type),\n+\t\t\t\t\t     TYPE_REF_CAN_ALIAS_ALL (type));\n     }\n   else if (TREE_CODE (type) == ARRAY_TYPE)\n     {"}]}