{"sha": "a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTA0NjRhYTBjNGE1NTVhYWUwZGJjMGVjZjU4NmY3NjhjZjhjYWM2YQ==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2018-09-25T07:12:52Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2018-09-25T07:12:52Z"}, "message": "Add filter-rtags-warnings.py script.\n\n2018-09-25  Martin Liska  <mliska@suse.cz>\n\n\t* filter-rtags-warnings.py: New file.\n\nFrom-SVN: r264560", "tree": {"sha": "406b41c1084a6a4888d9cf136e40c57df655c537", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/406b41c1084a6a4888d9cf136e40c57df655c537"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "87677ac7fbe12cd180e4a3c0ab4c209e08df98e8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/87677ac7fbe12cd180e4a3c0ab4c209e08df98e8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/87677ac7fbe12cd180e4a3c0ab4c209e08df98e8"}], "stats": {"total": 75, "additions": 75, "deletions": 0}, "files": [{"sha": "97f70fe9d4d2e630c637434b750477b6abee9c8b", "filename": "contrib/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a", "patch": "@@ -1,3 +1,7 @@\n+2018-09-25  Martin Liska  <mliska@suse.cz>\n+\n+\t* filter-rtags-warnings.py: New file.\n+\n 2018-09-25  Martin Liska  <mliska@suse.cz>\n \n \tPR middle-end/86078"}, {"sha": "ee27e7c89421f5ffb87b307e67eb11cee99bcd70", "filename": "contrib/filter-rtags-warnings.py", "status": "added", "additions": 71, "deletions": 0, "changes": 71, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a/contrib%2Ffilter-rtags-warnings.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a/contrib%2Ffilter-rtags-warnings.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Ffilter-rtags-warnings.py?ref=a0464aa0c4a555aae0dbc0ecf586f768cf8cac6a", "patch": "@@ -0,0 +1,71 @@\n+#!/usr/bin/env python3\n+#\n+# Script to analyze warnings produced by rtags command (using LLVM):\n+# rc --diagnose-all --synchronous-diagnostics --json\n+#\n+# This file is part of GCC.\n+#\n+# GCC is free software; you can redistribute it and/or modify it under\n+# the terms of the GNU General Public License as published by the Free\n+# Software Foundation; either version 3, or (at your option) any later\n+# version.\n+#\n+# GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+# WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+# for more details.\n+#\n+# You should have received a copy of the GNU General Public License\n+# along with GCC; see the file COPYING3.  If not see\n+# <http://www.gnu.org/licenses/>.  */\n+#\n+#\n+#\n+\n+import sys\n+import json\n+import argparse\n+\n+def skip_warning(filename, warning):\n+    ignores = {\n+            '': ['-Warray-bounds', '-Wmismatched-tags', 'gcc_gfc: -Wignored-attributes', '-Wchar-subscripts',\n+                'string literal (potentially insecure): -Wformat-security', '-Wdeprecated-register',\n+                '-Wvarargs', 'keyword is hidden by macro definition', \"but the argument has type 'char *': -Wformat-pedantic\",\n+                '-Wnested-anon-types', 'qualifier in explicit instantiation of', 'attribute argument not supported: asm_fprintf'],\n+            'insn-modes.c': ['-Wshift-count-overflow'],\n+            'insn-emit.c': ['-Wtautological-compare'],\n+            'insn-attrtab.c': ['-Wparentheses-equality'],\n+            'gimple-match.c': ['-Wunused-', '-Wtautological-compare'],\n+            'generic-match.c': ['-Wunused-', '-Wtautological-compare'],\n+    }\n+\n+    message = warning['message']\n+\n+    if warning['type'] == 'fixit':\n+        return True\n+\n+    for name, ignores in ignores.items():\n+        for i in ignores:\n+            if name in filename and i in message:\n+                return True\n+\n+    return False\n+\n+parser = argparse.ArgumentParser()\n+parser.add_argument('json_file', help = 'Rtags JSON file with diagnostics')\n+parser.add_argument('-n', '--no-filter', action = 'store_true', help = 'No filter')\n+\n+args = parser.parse_args()\n+\n+data = json.load(open(args.json_file))\n+file_warnings = data['checkStyle']\n+\n+total = 0\n+for filename, warnings in file_warnings.items():\n+    if warnings:\n+        for w in warnings:\n+            if args.no_filter or not skip_warning(filename, w):\n+                total += 1\n+                print('%s:%d:%d:%s' % (filename, w['line'], w['column'], w['message']))\n+\n+print('Total: %d' % total)"}]}