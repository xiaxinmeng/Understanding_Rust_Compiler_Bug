{"sha": "ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4", "node_id": "C_kwDOANBUbNoAKGNlMmRiZjk0M2FjOGZmZWZlMDQ4MDE2YWMzYWJmZDNiNmE0NTE4ZDQ", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2021-11-20T23:39:42Z"}, "committer": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2021-11-20T23:39:42Z"}, "message": "Fix ignore_nondeterminism_p in ipa-modref\n\nImprove debug output in ipa-modref and fix ignore_nondeterminism predicate:\nlooping pures and cont are still deterministic.\n\ngcc/ChangeLog:\n\n2021-11-21  Jan Hubicka  <hubicka@ucw.cz>\n\n\tPR ipa/103052\n\t* ipa-modref.c (ignore_nondeterminism_p): Allow looping pure/cont.\n\t(merge_call_side_effects): Improve debug output.", "tree": {"sha": "24ab0b40f565881d6eb054b2b6435e9c33ae77ea", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/24ab0b40f565881d6eb054b2b6435e9c33ae77ea"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4/comments", "author": null, "committer": null, "parents": [{"sha": "a0e99d5bb741d3db74a67d492f47b28217fbf88a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0e99d5bb741d3db74a67d492f47b28217fbf88a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0e99d5bb741d3db74a67d492f47b28217fbf88a"}], "stats": {"total": 10, "additions": 6, "deletions": 4}, "files": [{"sha": "20810c74da5231d6c792f13fcf041f5c94920c07", "filename": "gcc/ipa-modref.c", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4/gcc%2Fipa-modref.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4/gcc%2Fipa-modref.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-modref.c?ref=ce2dbf943ac8ffefe048016ac3abfd3b6a4518d4", "patch": "@@ -923,8 +923,7 @@ record_access_p (tree expr)\n static bool\n ignore_nondeterminism_p (tree caller, int flags)\n {\n-  if ((flags & (ECF_CONST | ECF_PURE))\n-      && !(flags & ECF_LOOPING_CONST_OR_PURE))\n+  if (flags & (ECF_CONST | ECF_PURE))\n     return true;\n   if ((flags & (ECF_NORETURN | ECF_NOTHROW)) == (ECF_NORETURN | ECF_NOTHROW)\n       || (!opt_for_fn (caller, flag_exceptions) && (flags & ECF_NORETURN)))\n@@ -1016,6 +1015,10 @@ merge_call_side_effects (modref_summary *cur_summary,\n       && !(flags & ECF_LOOPING_CONST_OR_PURE))\n     return changed;\n \n+  if (dump_file)\n+    fprintf (dump_file, \" - Merging side effects of %s\\n\",\n+\t     callee_node->dump_name ());\n+\n   if (!(flags & (ECF_CONST | ECF_NOVOPS | ECF_PURE))\n       || (flags & ECF_LOOPING_CONST_OR_PURE))\n     {\n@@ -1061,8 +1064,7 @@ merge_call_side_effects (modref_summary *cur_summary,\n     }\n \n   if (dump_file)\n-    fprintf (dump_file, \" - Merging side effects of %s with parm map:\",\n-\t     callee_node->dump_name ());\n+    fprintf (dump_file, \"   Parm map:\");\n \n   parm_map.safe_grow_cleared (gimple_call_num_args (stmt), true);\n   for (unsigned i = 0; i < gimple_call_num_args (stmt); i++)"}]}