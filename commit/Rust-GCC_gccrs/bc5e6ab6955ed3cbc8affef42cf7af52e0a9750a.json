{"sha": "bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmM1ZTZhYjY5NTVlZDNjYmM4YWZmZWY0MmNmN2FmNTJlMGE5NzUwYQ==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2018-06-29T18:42:35Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2018-06-29T18:42:35Z"}, "message": "v850.c (v850_legitimate_address_p): Handle large displacements for TARGET_V850E2V3 and newer.\n\n\t* config/v850/v850.c (v850_legitimate_address_p): Handle large\n\tdisplacements for TARGET_V850E2V3 and newer.\n\t(TARGET_LRA_P): Remove.  Defaults to LRA now.\n\t* config/v850/v850.md (sign23byte_load): Remove.\n\t(unsign23byte_load, sign23hword_load, unsign23hword_load): Likewise.\n\t(23word_load, 23byte_store, 23hword_store, 23word_store): Likewise.\n\nFrom-SVN: r262257", "tree": {"sha": "b0ab736f719a083add475f59cca5b780985ff770", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b0ab736f719a083add475f59cca5b780985ff770"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a/comments", "author": null, "committer": null, "parents": [{"sha": "0bcf7e67ab5a24029a60ba3dc734c4579dd37e7f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0bcf7e67ab5a24029a60ba3dc734c4579dd37e7f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0bcf7e67ab5a24029a60ba3dc734c4579dd37e7f"}], "stats": {"total": 85, "additions": 13, "deletions": 72}, "files": [{"sha": "c486d6d21728bdbe77fc13ceb54a64df69a7b01d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a", "patch": "@@ -1,3 +1,12 @@\n+2018-06-29  Jeff Law  <law@redhat.com>\n+\n+\t* config/v850/v850.c (v850_legitimate_address_p): Handle large\n+\tdisplacements for TARGET_V850E2V3 and newer.\n+\t(TARGET_LRA_P): Remove.  Defaults to LRA now.\n+\t* config/v850/v850.md (sign23byte_load): Remove.\n+\t(unsign23byte_load, sign23hword_load, unsign23hword_load): Likewise.\n+\t(23word_load, 23byte_store, 23hword_store, 23word_store): Likewise.\n+\n 2018-06-29  Martin Liska  <mliska@suse.cz>\n \n \tPR lto/85759"}, {"sha": "8936c732307b3008d2ab80553cbadbf0c58ad5ee", "filename": "gcc/config/v850/v850.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a/gcc%2Fconfig%2Fv850%2Fv850.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a/gcc%2Fconfig%2Fv850%2Fv850.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fv850%2Fv850.c?ref=bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a", "patch": "@@ -3079,7 +3079,10 @@ v850_legitimate_address_p (machine_mode mode, rtx x, bool strict_p,\n     return true;\n   if (GET_CODE (x) == PLUS\n       && v850_rtx_ok_for_base_p (XEXP (x, 0), strict_p)\n-      && constraint_satisfied_p (XEXP (x,1), CONSTRAINT_K)\n+      && (constraint_satisfied_p (XEXP (x, 1), CONSTRAINT_K)\n+\t  || (TARGET_V850E2V3_UP\n+\t      && (mode == SImode || mode == HImode || mode == QImode)\n+\t      && constraint_satisfied_p (XEXP (x, 1), CONSTRAINT_W)))\n       && ((mode == QImode || INTVAL (XEXP (x, 1)) % 2 == 0)\n \t   && CONST_OK_FOR_K (INTVAL (XEXP (x, 1))\n \t\t\t      + (GET_MODE_NUNITS (mode) * UNITS_PER_WORD))))\n@@ -3309,9 +3312,6 @@ v850_modes_tieable_p (machine_mode mode1, machine_mode mode2)\n #undef  TARGET_LEGITIMATE_CONSTANT_P\n #define TARGET_LEGITIMATE_CONSTANT_P v850_legitimate_constant_p\n \n-#undef TARGET_LRA_P\n-#define TARGET_LRA_P hook_bool_void_false\n-\n #undef  TARGET_ADDR_SPACE_LEGITIMATE_ADDRESS_P\n #define TARGET_ADDR_SPACE_LEGITIMATE_ADDRESS_P v850_legitimate_address_p\n "}, {"sha": "6530778c8f625a7c304d2de67ab772f4c4e85a05", "filename": "gcc/config/v850/v850.md", "status": "modified", "additions": 0, "deletions": 68, "changes": 68, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a/gcc%2Fconfig%2Fv850%2Fv850.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a/gcc%2Fconfig%2Fv850%2Fv850.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fv850%2Fv850.md?ref=bc5e6ab6955ed3cbc8affef42cf7af52e0a9750a", "patch": "@@ -138,74 +138,6 @@\n ;; ----------------------------------------------------------------------\n ;; MOVE INSTRUCTIONS\n ;; ----------------------------------------------------------------------\n-(define_insn \"sign23byte_load\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n-\t(sign_extend:SI\n-\t(mem:QI (plus:SI (match_operand:SI 1 \"register_operand\" \"r\")\n-\t\t\t (match_operand 2 \"disp23_operand\" \"W\")))))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"ld.b %2[%1],%0\"\n-  [(set_attr \"length\" \"4\")])\n-  \n-(define_insn \"unsign23byte_load\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n-\t(zero_extend:SI\n-\t(mem:QI (plus:SI (match_operand:SI 1 \"register_operand\" \"r\")\n-\t\t\t (match_operand 2 \"disp23_operand\" \"W\")))))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"ld.bu %2[%1],%0\"\n-  [(set_attr \"length\" \"4\")])\n-\n-(define_insn \"sign23hword_load\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n-\t(sign_extend:SI\n-\t(mem:HI (plus:SI (match_operand:SI 1 \"register_operand\" \"r\")\n-\t\t\t (match_operand 2 \"disp23_operand\" \"W\")))))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"ld.h %2[%1],%0\"\n-  [(set_attr \"length\" \"4\")])\n-\n-(define_insn \"unsign23hword_load\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n-\t(zero_extend:SI\n-\t(mem:HI (plus:SI (match_operand:SI 1 \"register_operand\" \"r\")\n-\t\t\t (match_operand 2 \"disp23_operand\" \"W\")))))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"ld.hu %2[%1],%0\"\n-  [(set_attr \"length\" \"4\")])\n-\n-(define_insn \"23word_load\"\n-  [(set (match_operand:SI 0 \"register_operand\" \"=r\")\n-\t(mem:SI (plus:SI (match_operand:SI 1 \"register_operand\" \"r\")\n-\t\t\t (match_operand 2 \"disp23_operand\" \"W\"))))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"ld.w %2[%1],%0\"\n-  [(set_attr \"length\" \"4\")])\n-\n-(define_insn \"23byte_store\"\n-  [(set (mem:QI (plus:SI (match_operand:SI 0 \"register_operand\" \"r\")\n-\t\t\t (match_operand 1 \"disp23_operand\" \"W\")))\n-\t(match_operand:QI 2 \"register_operand\" \"r\"))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"st.b %2,%1[%0]\"\n-  [(set_attr \"length\" \"4\")])\n-\n-(define_insn \"23hword_store\"\n-  [(set (mem:HI (plus:SI (match_operand:SI 0 \"register_operand\" \"r\")\n-\t\t\t (match_operand 1 \"disp23_operand\" \"W\")))\n-\t(match_operand:HI 2 \"register_operand\" \"r\"))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"st.h %2,%1[%0]\"\n-  [(set_attr \"length\" \"4\")])\n-\n-(define_insn \"23word_store\"\n-  [(set (mem:SI (plus:SI (match_operand:SI 0 \"register_operand\" \"r\")\n-\t\t\t (match_operand 1 \"disp23_operand\" \"W\")))\n-\t(match_operand:SI 2 \"register_operand\" \"r\"))]\n-  \"TARGET_V850E2V3_UP\"\n-  \"st.w %2,%1[%0]\"\n-  [(set_attr \"length\" \"4\")])\n-\n ;; movdi\n \n (define_expand \"movdi\""}]}