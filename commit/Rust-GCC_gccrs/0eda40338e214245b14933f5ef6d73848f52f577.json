{"sha": "0eda40338e214245b14933f5ef6d73848f52f577", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGVkYTQwMzM4ZTIxNDI0NWIxNDkzM2Y1ZWY2ZDczODQ4ZjUyZjU3Nw==", "commit": {"author": {"name": "Catherine Moore", "email": "clm@codesourcery.com", "date": "2011-04-20T16:54:32Z"}, "committer": {"name": "Catherine Moore", "email": "clm@gcc.gnu.org", "date": "2011-04-20T16:54:32Z"}, "message": "mips.opt (mfix-24k): New.\n\n2011-04-20  Catherine Moore  <clm@codesourcery.com>\n\n\t* config/mips/mips.opt (mfix-24k): New.\n\t* config/mips/mips.h (ASM_SPEC): Handle -mfix-24k.\n\t* config/mips/mips.md (length): Increase by 4 for stores if\n\tfixing 24K errata.\n\t* config/mips/mips.c (mips_reorg_process_insns): Do not allow\n\tall noreorder if fixing 24K errata.\n\t* doc/invoke.texi: Document mfix-24k.\n\nFrom-SVN: r172780", "tree": {"sha": "6b3f66d43639406c4f8e02ed7c2f8e2561c2c6f7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6b3f66d43639406c4f8e02ed7c2f8e2561c2c6f7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0eda40338e214245b14933f5ef6d73848f52f577", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0eda40338e214245b14933f5ef6d73848f52f577", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0eda40338e214245b14933f5ef6d73848f52f577", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0eda40338e214245b14933f5ef6d73848f52f577/comments", "author": {"login": "CatherineMoore", "id": 15636327, "node_id": "MDQ6VXNlcjE1NjM2MzI3", "avatar_url": "https://avatars.githubusercontent.com/u/15636327?v=4", "gravatar_id": "", "url": "https://api.github.com/users/CatherineMoore", "html_url": "https://github.com/CatherineMoore", "followers_url": "https://api.github.com/users/CatherineMoore/followers", "following_url": "https://api.github.com/users/CatherineMoore/following{/other_user}", "gists_url": "https://api.github.com/users/CatherineMoore/gists{/gist_id}", "starred_url": "https://api.github.com/users/CatherineMoore/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/CatherineMoore/subscriptions", "organizations_url": "https://api.github.com/users/CatherineMoore/orgs", "repos_url": "https://api.github.com/users/CatherineMoore/repos", "events_url": "https://api.github.com/users/CatherineMoore/events{/privacy}", "received_events_url": "https://api.github.com/users/CatherineMoore/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "01475747254ace9b52d6c62779639bffbf5b6c45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01475747254ace9b52d6c62779639bffbf5b6c45", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01475747254ace9b52d6c62779639bffbf5b6c45"}], "stats": {"total": 33, "additions": 29, "deletions": 4}, "files": [{"sha": "2b7e5313a499ea26c19cefc3676963a16384a577", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0eda40338e214245b14933f5ef6d73848f52f577", "patch": "@@ -1,3 +1,13 @@\n+2011-04-20  Catherine Moore  <clm@codesourcery.com>\n+\n+\t* config/mips/mips.opt (mfix-24k): New.\n+\t* config/mips/mips.h (ASM_SPEC): Handle -mfix-24k.\n+\t* config/mips/mips.md (length): Increase by 4 for stores if\n+\tfixing 24K errata.\n+\t* config/mips/mips.c (mips_reorg_process_insns): Do not allow\n+\tall noreorder if fixing 24K errata.\n+\t* doc/invoke.texi: Document mfix-24k.\n+\n 2011-04-20  Chung-Lin Tang  <cltang@codesourcery.com>\n \n \t* config/arm/arm.c (arm_legitimize_reload_address): For NEON"}, {"sha": "55d3e9fcdf2cf90b87ce8e0b51741c64bfd236f1", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=0eda40338e214245b14933f5ef6d73848f52f577", "patch": "@@ -14886,9 +14886,9 @@ mips_reorg_process_insns (void)\n   if (crtl->profile)\n     cfun->machine->all_noreorder_p = false;\n \n-  /* Code compiled with -mfix-vr4120 can't be all noreorder because\n-     we rely on the assembler to work around some errata.  */\n-  if (TARGET_FIX_VR4120)\n+  /* Code compiled with -mfix-vr4120 or -mfix-24k can't be all noreorder\n+     because we rely on the assembler to work around some errata.  */\n+  if (TARGET_FIX_VR4120 || TARGET_FIX_24K)\n     cfun->machine->all_noreorder_p = false;\n \n   /* The same is true for -mfix-vr4130 if we might generate MFLO or"}, {"sha": "1c1917c18ac4aae708bf167c99b1022cac34c7af", "filename": "gcc/config/mips/mips.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.h?ref=0eda40338e214245b14933f5ef6d73848f52f577", "patch": "@@ -1134,6 +1134,7 @@ enum mips_code_readable_setting {\n %{msmartmips} %{mno-smartmips} \\\n %{mmt} %{mno-mt} \\\n %{mfix-vr4120} %{mfix-vr4130} \\\n+%{mfix-24k} \\\n %(subtarget_asm_optimizing_spec) \\\n %(subtarget_asm_debugging_spec) \\\n %{mabi=*} %{!mabi=*: %(asm_abi_default_spec)} \\"}, {"sha": "d7e59f877f89d725f9442fe1f279859c7caf528d", "filename": "gcc/config/mips/mips.md", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.md?ref=0eda40338e214245b14933f5ef6d73848f52f577", "patch": "@@ -479,7 +479,9 @@\n \t  (eq_attr \"move_type\" \"load,fpload\")\n \t  (symbol_ref \"mips_load_store_insns (operands[1], insn) * 4\")\n \t  (eq_attr \"move_type\" \"store,fpstore\")\n-\t  (symbol_ref \"mips_load_store_insns (operands[0], insn) * 4\")\n+\t  (cond [(eq (symbol_ref \"TARGET_FIX_24K\") (const_int 0))\n+\t         (symbol_ref \"mips_load_store_insns (operands[0], insn) * 4\")]\n+\t         (symbol_ref \"mips_load_store_insns (operands[0], insn) * 4 + 4\"))\n \n \t  ;; In the worst case, a call macro will take 8 instructions:\n \t  ;;"}, {"sha": "4ce3c40c7c1848c5a68f4f1f9c4a34af4ac837a4", "filename": "gcc/config/mips/mips.opt", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fconfig%2Fmips%2Fmips.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.opt?ref=0eda40338e214245b14933f5ef6d73848f52f577", "patch": "@@ -110,6 +110,10 @@ mextern-sdata\n Target Report Var(TARGET_EXTERN_SDATA) Init(1)\n Use -G for data that is not defined by the current object\n \n+mfix-24k\n+Target Report Var(TARGET_FIX_24K)\n+Work around certain 24K errata\n+\n mfix-r4000\n Target Report Mask(FIX_R4000)\n Work around certain R4000 errata"}, {"sha": "4377f346c7b9021630a3cf04ff9514d50b52b900", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0eda40338e214245b14933f5ef6d73848f52f577/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=0eda40338e214245b14933f5ef6d73848f52f577", "patch": "@@ -714,6 +714,7 @@ Objective-C and Objective-C++ Dialects}.\n -mdivide-traps  -mdivide-breaks @gol\n -mmemcpy  -mno-memcpy  -mlong-calls  -mno-long-calls @gol\n -mmad  -mno-mad  -mfused-madd  -mno-fused-madd  -nocpp @gol\n+-mfix-24k -mno-fix-24k @gol\n -mfix-r4000  -mno-fix-r4000  -mfix-r4400  -mno-fix-r4400 @gol\n -mfix-r10000 -mno-fix-r10000  -mfix-vr4120  -mno-fix-vr4120 @gol\n -mfix-vr4130  -mno-fix-vr4130  -mfix-sb1  -mno-fix-sb1 @gol\n@@ -14602,6 +14603,13 @@ circumstances.\n Tell the MIPS assembler to not run its preprocessor over user\n assembler files (with a @samp{.s} suffix) when assembling them.\n \n+@item -mfix-24k\n+@item -mno-fix-24k\n+@opindex mfix-24k\n+@opindex mno-fix-24k\n+Work around the 24K E48 (lost data on stores during refill) errata.\n+The workarounds are implemented by the assembler rather than by GCC.\n+\n @item -mfix-r4000\n @itemx -mno-fix-r4000\n @opindex mfix-r4000"}]}