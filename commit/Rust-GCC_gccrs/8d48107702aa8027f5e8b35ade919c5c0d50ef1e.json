{"sha": "8d48107702aa8027f5e8b35ade919c5c0d50ef1e", "node_id": "C_kwDOANBUbNoAKDhkNDgxMDc3MDJhYTgwMjdmNWU4YjM1YWRlOTE5YzVjMGQ1MGVmMWU", "commit": {"author": {"name": "Alexandre Oliva", "email": "oliva@adacore.com", "date": "2022-12-29T17:33:04Z"}, "committer": {"name": "Alexandre Oliva", "email": "oliva@gnu.org", "date": "2022-12-29T17:39:47Z"}, "message": "hash-map: reject empty-looking insertions\n\nCheck, after inserting entries, that they don't look empty.\n\n\nfor  gcc/ChangeLog\n\n\t* hash-map.h (put, get_or_insert): Check that entry does not\n\tlook empty after insertion.", "tree": {"sha": "e82a3d206136bfec36bfccb186e3d724589161d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e82a3d206136bfec36bfccb186e3d724589161d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8d48107702aa8027f5e8b35ade919c5c0d50ef1e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d48107702aa8027f5e8b35ade919c5c0d50ef1e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8d48107702aa8027f5e8b35ade919c5c0d50ef1e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8d48107702aa8027f5e8b35ade919c5c0d50ef1e/comments", "author": null, "committer": null, "parents": [{"sha": "1b9270852055f2641520fadd63328f997e76d367", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1b9270852055f2641520fadd63328f997e76d367", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1b9270852055f2641520fadd63328f997e76d367"}], "stats": {"total": 4, "additions": 3, "deletions": 1}, "files": [{"sha": "63fa21cf37c5b35a94f8f359b6927a357b0d5f17", "filename": "gcc/hash-map.h", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8d48107702aa8027f5e8b35ade919c5c0d50ef1e/gcc%2Fhash-map.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8d48107702aa8027f5e8b35ade919c5c0d50ef1e/gcc%2Fhash-map.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fhash-map.h?ref=8d48107702aa8027f5e8b35ade919c5c0d50ef1e", "patch": "@@ -169,11 +169,12 @@ class GTY((user)) hash_map\n     {\n       hash_entry *e = m_table.find_slot_with_hash (k, Traits::hash (k),\n \t\t\t\t\t\t   INSERT);\n-      bool ins = hash_entry::is_empty (*e);\n+      bool ins = Traits::is_empty (*e);\n       if (ins)\n \t{\n \t  e->m_key = k;\n \t  new ((void *) &e->m_value) Value (v);\n+\t  gcc_checking_assert (!Traits::is_empty (*e));\n \t}\n       else\n \te->m_value = v;\n@@ -203,6 +204,7 @@ class GTY((user)) hash_map\n \t{\n \t  e->m_key = k;\n \t  new ((void *)&e->m_value) Value ();\n+\t  gcc_checking_assert (!Traits::is_empty (*e));\n \t}\n \n       if (existed != NULL)"}]}