{"sha": "a58d74533c0b06903094936b4d3ba3712fe10ca9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTU4ZDc0NTMzYzBiMDY5MDMwOTQ5MzZiNGQzYmEzNzEyZmUxMGNhOQ==", "commit": {"author": {"name": "Tom Tromey", "email": "tromey@redhat.com", "date": "2004-12-06T15:32:38Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2004-12-06T15:32:38Z"}, "message": "re PR java/14853 (Assignment to final field permitted when compiling to native)\n\n\tPR java/14853:\n\t* java-tree.h (extract_field_decl): Declare.\n\t* parse.y (extract_field_decl): Renamed from\n\tstrip_out_static_field_access_decl.  No longer static.\n\t* check-init.c (get_variable_decl): Unwrap COMPOUND_EXPRs.\n\nFrom-SVN: r91778", "tree": {"sha": "c828f6f61d900bf37c9c5909e2bd3852aef32c0a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c828f6f61d900bf37c9c5909e2bd3852aef32c0a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a58d74533c0b06903094936b4d3ba3712fe10ca9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a58d74533c0b06903094936b4d3ba3712fe10ca9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a58d74533c0b06903094936b4d3ba3712fe10ca9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a58d74533c0b06903094936b4d3ba3712fe10ca9/comments", "author": null, "committer": null, "parents": [{"sha": "0bc371d376f3fe74f0be50edd9d7b1dc82d22598", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0bc371d376f3fe74f0be50edd9d7b1dc82d22598", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0bc371d376f3fe74f0be50edd9d7b1dc82d22598"}], "stats": {"total": 24, "additions": 19, "deletions": 5}, "files": [{"sha": "724403ab1162bdc3256c73e44d09f8a6e6f1e408", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=a58d74533c0b06903094936b4d3ba3712fe10ca9", "patch": "@@ -1,3 +1,11 @@\n+2004-12-06  Tom Tromey  <tromey@redhat.com>\n+\n+\tPR java/14853:\n+\t* java-tree.h (extract_field_decl): Declare.\n+\t* parse.y (extract_field_decl): Renamed from\n+\tstrip_out_static_field_access_decl.  No longer static.\n+\t* check-init.c (get_variable_decl): Unwrap COMPOUND_EXPRs.\n+\n 2004-12-03  Tom Tromey  <tromey@redhat.com>\n \n \t* lang.c (flag_new_verifier): Define."}, {"sha": "e124ffc5eefc01a8dd5b1d6a3c2cead7dcf64145", "filename": "gcc/java/check-init.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2Fcheck-init.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2Fcheck-init.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fcheck-init.c?ref=a58d74533c0b06903094936b4d3ba3712fe10ca9", "patch": "@@ -164,6 +164,11 @@ static void check_final_reassigned (tree, words);\n static tree\n get_variable_decl (tree exp)\n {\n+  /* A static field can be wrapped in a COMPOUND_EXPR where the first\n+     argument initializes the class.  */\n+  if (TREE_CODE (exp) == COMPOUND_EXPR)\n+    exp = extract_field_decl (exp);\n+\n   if (TREE_CODE (exp) == VAR_DECL)\n     {\n       if (! TREE_STATIC (exp) ||  FIELD_FINAL (exp))"}, {"sha": "843e5f7009879ce0394403781bb31d0bcb5b41a7", "filename": "gcc/java/java-tree.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2Fjava-tree.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2Fjava-tree.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fjava-tree.h?ref=a58d74533c0b06903094936b4d3ba3712fe10ca9", "patch": "@@ -1922,4 +1922,6 @@ extern tree build_expr_wfl              PARAMS ((tree, const char *, int, int));\n extern void java_genericize\t\tPARAMS ((tree));\n extern int java_gimplify_expr\t\tPARAMS ((tree *, tree *, tree *));\n \n+extern tree extract_field_decl (tree);\n+\n #endif /* ! GCC_JAVA_TREE_H */"}, {"sha": "815b51eae17eeffad785ec4d740b571af8bb4b61", "filename": "gcc/java/parse.y", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2Fparse.y", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a58d74533c0b06903094936b4d3ba3712fe10ca9/gcc%2Fjava%2Fparse.y", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fparse.y?ref=a58d74533c0b06903094936b4d3ba3712fe10ca9", "patch": "@@ -277,7 +277,6 @@ static tree maybe_build_array_element_wfl (tree);\n static int array_constructor_check_entry (tree, tree);\n static const char *purify_type_name (const char *);\n static tree fold_constant_for_init (tree, tree);\n-static tree strip_out_static_field_access_decl (tree);\n static jdeplist *reverse_jdep_list (struct parser_ctxt *);\n static void static_ref_err (tree, tree, tree);\n static void parser_add_interface (tree, tree, tree);\n@@ -9678,12 +9677,12 @@ resolve_field_access (tree qual_wfl, tree *field_decl, tree *field_type)\n   return field_ref;\n }\n \n-/* If NODE is an access to f static field, strip out the class\n+/* If NODE is an access to a static field, strip out the class\n    initialization part and return the field decl, otherwise, return\n    NODE. */\n \n-static tree\n-strip_out_static_field_access_decl (tree node)\n+tree\n+extract_field_decl (tree node)\n {\n   if (TREE_CODE (node) == COMPOUND_EXPR)\n     {\n@@ -14260,7 +14259,7 @@ patch_unaryop (tree node, tree wfl_op)\n     case PREINCREMENT_EXPR:\n       /* 15.14.2 Prefix Decrement Operator -- */\n     case PREDECREMENT_EXPR:\n-      op = decl = strip_out_static_field_access_decl (op);\n+      op = decl = extract_field_decl (op);\n       outer_field_flag = outer_field_expanded_access_p (op, NULL, NULL, NULL);\n       /* We might be trying to change an outer field accessed using\n          access method. */"}]}