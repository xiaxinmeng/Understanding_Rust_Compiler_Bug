{"sha": "571bbd0d48d5872eacbd0b681fce6e1ae754520b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTcxYmJkMGQ0OGQ1ODcyZWFjYmQwYjY4MWZjZTZlMWFlNzU0NTIwYg==", "commit": {"author": {"name": "Jozef Lawrynowicz", "email": "jozef.l@mittosystems.com", "date": "2018-11-26T21:35:43Z"}, "committer": {"name": "Jozef Lawrynowicz", "email": "jozefl@gcc.gnu.org", "date": "2018-11-26T21:35:43Z"}, "message": "sourcebuild.texi: Document check_effective_target_newlib_nano_io.\n\n2018-11-26  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n\n\tgcc/ChangeLog:\n\n\t* doc/sourcebuild.texi: Document check_effective_target_newlib_nano_io.\n\n\tgcc/testsuite/ChangeLog:\n\n\t* lib/target-supports.exp (check_effective_target_newlib_nano_io): New. \n\t* gcc.c-torture/execute/920501-8.c: Register undefined linker symbol\n\t_printf_float for newlib_nano_io target.\n\t* gcc.c-torture/execute/930513-1.c: Likewise.\n\t* gcc.dg/torture/builtin-sprintf.c: Likewise.\n\t* gcc.c-torture/execute/ieee/920810-1.x: New.\n\nFrom-SVN: r266488", "tree": {"sha": "ae8f6069d830e34aa854ecf14da1ba7ea66dfb13", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ae8f6069d830e34aa854ecf14da1ba7ea66dfb13"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/571bbd0d48d5872eacbd0b681fce6e1ae754520b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/571bbd0d48d5872eacbd0b681fce6e1ae754520b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/571bbd0d48d5872eacbd0b681fce6e1ae754520b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/571bbd0d48d5872eacbd0b681fce6e1ae754520b/comments", "author": {"login": "jozefl-mitto", "id": 36524004, "node_id": "MDQ6VXNlcjM2NTI0MDA0", "avatar_url": "https://avatars.githubusercontent.com/u/36524004?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jozefl-mitto", "html_url": "https://github.com/jozefl-mitto", "followers_url": "https://api.github.com/users/jozefl-mitto/followers", "following_url": "https://api.github.com/users/jozefl-mitto/following{/other_user}", "gists_url": "https://api.github.com/users/jozefl-mitto/gists{/gist_id}", "starred_url": "https://api.github.com/users/jozefl-mitto/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jozefl-mitto/subscriptions", "organizations_url": "https://api.github.com/users/jozefl-mitto/orgs", "repos_url": "https://api.github.com/users/jozefl-mitto/repos", "events_url": "https://api.github.com/users/jozefl-mitto/events{/privacy}", "received_events_url": "https://api.github.com/users/jozefl-mitto/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8b1f4e1f8aec774a185fe1f315ad4361161d5dc3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8b1f4e1f8aec774a185fe1f315ad4361161d5dc3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8b1f4e1f8aec774a185fe1f315ad4361161d5dc3"}], "stats": {"total": 33, "additions": 32, "deletions": 1}, "files": [{"sha": "fd5e8c292a41fb84a37f7e2be23f134edec0ed42", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -1,3 +1,7 @@\n+2018-11-26  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n+\n+\t* doc/sourcebuild.texi: Document check_effective_target_newlib_nano_io.\n+\n 2018-11-26  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/88195"}, {"sha": "6a81b17693fe3031d7ed3ab874bea09a6d625b94", "filename": "gcc/doc/sourcebuild.texi", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Fdoc%2Fsourcebuild.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Fdoc%2Fsourcebuild.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fsourcebuild.texi?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -2152,6 +2152,10 @@ Target supports @code{mmap}.\n @item newlib\n Target supports Newlib.\n \n+@item newlib_nano_io\n+GCC was configured with @code{--enable-newlib-nano-formatted-io}, which reduces\n+the code size of Newlib formatted I/O functions.\n+\n @item pow10\n Target provides @code{pow10} function.\n "}, {"sha": "c617d27fc652f9fb184b39d7dd1a7d9722775049", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -1,3 +1,12 @@\n+2018-11-26  Jozef Lawrynowicz  <jozef.l@mittosystems.com>\n+\n+\t* lib/target-supports.exp (check_effective_target_newlib_nano_io): New. \n+\t* gcc.c-torture/execute/920501-8.c: Register undefined linker symbol\n+\t_printf_float for newlib_nano_io target.\n+\t* gcc.c-torture/execute/930513-1.c: Likewise.\n+\t* gcc.dg/torture/builtin-sprintf.c: Likewise.\n+\t* gcc.c-torture/execute/ieee/920810-1.x: New.\n+\n 2018-11-26  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/88195"}, {"sha": "7e4fa172ccd5fe38aa7e30a23cf27be76ca87617", "filename": "gcc/testsuite/gcc.c-torture/execute/920501-8.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F920501-8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F920501-8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F920501-8.c?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-additional-options \"-Wl,-u,_printf_float\" { target newlib_nano_io } } */\n+\n #include <stdio.h>\n #include <stdarg.h>\n "}, {"sha": "f1630076800bd70c33d751e92686283e72d02f13", "filename": "gcc/testsuite/gcc.c-torture/execute/930513-1.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F930513-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F930513-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2F930513-1.c?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -1,3 +1,5 @@\n+/* { dg-additional-options \"-Wl,-u,_printf_float\" { target newlib_nano_io } } */\n+\n #include <stdio.h>\n char buf[2];\n "}, {"sha": "8edec730dcecea0de071d11ebf09bb65c322ef44", "filename": "gcc/testsuite/gcc.c-torture/execute/ieee/920810-1.x", "status": "added", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fieee%2F920810-1.x", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fieee%2F920810-1.x", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fieee%2F920810-1.x?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -0,0 +1,4 @@\n+if { [check_effective_target_newlib_nano_io] } {\n+    lappend additional_flags \"-Wl,-u,_printf_float\"\n+}\n+return 0"}, {"sha": "5684fd704aeebebfb18500ca6a8864abf0bf8ea5", "filename": "gcc/testsuite/gcc.dg/torture/builtin-sprintf.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-sprintf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-sprintf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fbuiltin-sprintf.c?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -1,6 +1,7 @@\n /* PR tree-optimization/86274 - SEGFAULT when logging std::to_string(NAN)\n    { dg-do run }\n-   { dg-options \"-O2 -Wall\" } */\n+   { dg-options \"-O2 -Wall\" }\n+   { dg-additional-options \"-Wl,-u,_printf_float\" { target newlib_nano_io } } */\n \n #define X        \"0xdeadbeef\"\n #define nan(x)   __builtin_nan (x)"}, {"sha": "7bfd5c32354273f815c7d6866a6a3fd1f2fadccb", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/571bbd0d48d5872eacbd0b681fce6e1ae754520b/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=571bbd0d48d5872eacbd0b681fce6e1ae754520b", "patch": "@@ -6710,6 +6710,11 @@ proc check_effective_target_newlib {} {\n     }]\n }\n \n+# Return true if GCC was configured with --enable-newlib-nano-formatted-io\n+proc check_effective_target_newlib_nano_io { } {\n+    return [check_configured_with \"--enable-newlib-nano-formatted-io\"]\n+}\n+\n # Some newlib versions don't provide a frexpl and instead depend\n # on frexp to implement long double conversions in their printf-like\n # functions.  This leads to broken results.  Detect such versions here."}]}