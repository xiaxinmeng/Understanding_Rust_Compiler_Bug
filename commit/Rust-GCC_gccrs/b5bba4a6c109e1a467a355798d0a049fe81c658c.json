{"sha": "b5bba4a6c109e1a467a355798d0a049fe81c658c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjViYmE0YTZjMTA5ZTFhNDY3YTM1NTc5OGQwYTA0OWZlODFjNjU4Yw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2010-04-25T09:42:41Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2010-04-25T09:42:41Z"}, "message": "exp_dbug.ads: Fix outdated description.\n\n\t* exp_dbug.ads: Fix outdated description.  Mention link between XVS\n\tand XVZ objects.\n\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Record_Subtype>: Set\n\tXVZ variable as unit size of XVS type.\n\t(maybe_pad_type): Likewise.\n\nFrom-SVN: r158703", "tree": {"sha": "f618dae8160d46ea99f359e80da1ab683354f146", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f618dae8160d46ea99f359e80da1ab683354f146"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b5bba4a6c109e1a467a355798d0a049fe81c658c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5bba4a6c109e1a467a355798d0a049fe81c658c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b5bba4a6c109e1a467a355798d0a049fe81c658c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b5bba4a6c109e1a467a355798d0a049fe81c658c/comments", "author": null, "committer": null, "parents": [{"sha": "82d6f5327943f851a1c2973055f3e7ed09071dbb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/82d6f5327943f851a1c2973055f3e7ed09071dbb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/82d6f5327943f851a1c2973055f3e7ed09071dbb"}], "stats": {"total": 48, "additions": 31, "deletions": 17}, "files": [{"sha": "c5dac667602e2967f602aea9384e2950eada6e1c", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5bba4a6c109e1a467a355798d0a049fe81c658c/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5bba4a6c109e1a467a355798d0a049fe81c658c/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=b5bba4a6c109e1a467a355798d0a049fe81c658c", "patch": "@@ -1,3 +1,11 @@\n+2010-04-25  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* exp_dbug.ads: Fix outdated description.  Mention link between XVS\n+\tand XVZ objects.\n+\t* gcc-interface/decl.c (gnat_to_gnu_entity) <E_Record_Subtype>: Set\n+\tXVZ variable as unit size of XVS type.\n+\t(maybe_pad_type): Likewise.\n+\n 2010-04-25  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/trans.c (gnat_to_gnu) <N_Assignment_Statement>: Do not"}, {"sha": "99a61d4efd39a4daba533ab8164bf99403b08872", "filename": "gcc/ada/exp_dbug.ads", "status": "modified", "additions": 13, "deletions": 11, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5bba4a6c109e1a467a355798d0a049fe81c658c/gcc%2Fada%2Fexp_dbug.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5bba4a6c109e1a467a355798d0a049fe81c658c/gcc%2Fada%2Fexp_dbug.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_dbug.ads?ref=b5bba4a6c109e1a467a355798d0a049fe81c658c", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 S p e c                                  --\n --                                                                          --\n---          Copyright (C) 1996-2009, Free Software Foundation, Inc.         --\n+--          Copyright (C) 1996-2010, Free Software Foundation, Inc.         --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -853,16 +853,17 @@ package Exp_Dbug is\n       --  The size of the objects typed as x should be obtained from the\n       --  structure of x (and x___XVE, if applicable) as for ordinary types\n       --  unless there is a variable named x___XVZ, which, if present, will\n-      --  hold the size (in bytes) of x.\n+      --  hold the size (in bytes) of x; in this latter case, the size of the\n+      --  x___XVS type will not be a constant but a reference to x___XVZ.\n \n       --  The type x will either be a subtype of y (see also Subtypes of\n-      --  Variant Records, below) or will contain no fields at all. The layout,\n-      --  types, and positions of these fields will be accurate, if present.\n-      --  (Currently, however, the GDB debugger makes no use of x except to\n-      --  determine its size).\n+      --  Variant Records, below) or will contain a single field of type y,\n+      --  or no fields at all. The layout, types, and positions of these\n+      --  fields will be accurate, if present. (Currently, however, the GDB\n+      --  debugger makes no use of x except to determine its size).\n \n-      --  Among other uses, XVS types are sometimes used to encode\n-      --  unconstrained types. For example, given\n+      --  Among other uses, XVS types are used to encode unconstrained types.\n+      --  For example, given:\n       --\n       --     subtype Int is INTEGER range 0..10;\n       --     type T1 (N: Int := 0) is record\n@@ -873,13 +874,14 @@ package Exp_Dbug is\n       --  the element type for AT1 might have a type defined as if it had\n       --  been written:\n       --\n-      --     type at1___PAD is record null; end record;\n+      --     type at1___PAD is record F : T1; end record;\n       --     for at1___PAD'Size use 16 * 8;\n       --\n-      --  and there would also be\n+      --  and there would also be:\n       --\n-      --     type at1___PAD___XVS is record t1: Integer; end record;\n+      --     type at1___PAD___XVS is record t1: reft1; end record;\n       --     type t1 is ...\n+      --     type reft1 is <reference to t1>\n       --\n       --  Had the subtype Int been dynamic:\n       --"}, {"sha": "ccedee020f052e2daac10116236f060d571c01f0", "filename": "gcc/ada/gcc-interface/decl.c", "status": "modified", "additions": 10, "deletions": 6, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b5bba4a6c109e1a467a355798d0a049fe81c658c/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b5bba4a6c109e1a467a355798d0a049fe81c658c/gcc%2Fada%2Fgcc-interface%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgcc-interface%2Fdecl.c?ref=b5bba4a6c109e1a467a355798d0a049fe81c658c", "patch": "@@ -3258,9 +3258,12 @@ gnat_to_gnu_entity (Entity_Id gnat_entity, tree gnu_expr, int definition)\n \t\t  if (definition\n \t\t      && TREE_CODE (gnu_size_unit) != INTEGER_CST\n \t\t      && !CONTAINS_PLACEHOLDER_P (gnu_size_unit))\n-\t\t    create_var_decl (create_concat_name (gnat_entity, \"XVZ\"),\n-\t\t\t\t     NULL_TREE, sizetype, gnu_size_unit, false,\n-\t\t\t\t     false, false, false, NULL, gnat_entity);\n+\t\t    TYPE_SIZE_UNIT (gnu_subtype_marker)\n+\t\t      = create_var_decl (create_concat_name (gnat_entity,\n+\t\t\t\t\t\t\t     \"XVZ\"),\n+\t\t\t\t\t NULL_TREE, sizetype, gnu_size_unit,\n+\t\t\t\t\t false, false, false, false, NULL,\n+\t\t\t\t\t gnat_entity);\n \t\t}\n \n \t      /* Now we can finalize it.  */\n@@ -6253,9 +6256,10 @@ maybe_pad_type (tree type, tree size, unsigned int align,\n       add_parallel_type (TYPE_STUB_DECL (record), marker);\n \n       if (definition && size && TREE_CODE (size) != INTEGER_CST)\n-\tcreate_var_decl (concat_name (name, \"XVZ\"), NULL_TREE, sizetype,\n-\t\t\t TYPE_SIZE_UNIT (record), false, false, false,\n-\t\t\t false, NULL, gnat_entity);\n+\tTYPE_SIZE_UNIT (marker)\n+\t  = create_var_decl (concat_name (name, \"XVZ\"), NULL_TREE, sizetype,\n+\t\t\t     TYPE_SIZE_UNIT (record), false, false, false,\n+\t\t\t     false, NULL, gnat_entity);\n     }\n \n   rest_of_record_type_compilation (record);"}]}