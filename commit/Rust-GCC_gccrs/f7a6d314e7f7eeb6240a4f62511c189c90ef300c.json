{"sha": "f7a6d314e7f7eeb6240a4f62511c189c90ef300c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjdhNmQzMTRlN2Y3ZWViNjI0MGE0ZjYyNTExYzE4OWM5MGVmMzAwYw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2021-01-28T10:31:35Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2021-01-28T10:33:53Z"}, "message": "Fix LTO bootstrap on Windows\n\nThe latest fix introduced a comparison of executables and this cannot\ndirectly work on Windows because they are timestamped.  Moreover nobody\nsets $(exeext) at top level, at least on MinGW, so you get weird behavior\nbecause some tools add the implicit .exe suffix and others do not.\n\ncontrib/\n\tPR lto/85574\n\t* compare-lto: Deal with PE-COFF executables specifically.", "tree": {"sha": "93f557899e5f2d535901a6b5f3ca540d5ff20e46", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/93f557899e5f2d535901a6b5f3ca540d5ff20e46"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f7a6d314e7f7eeb6240a4f62511c189c90ef300c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f7a6d314e7f7eeb6240a4f62511c189c90ef300c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f7a6d314e7f7eeb6240a4f62511c189c90ef300c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f7a6d314e7f7eeb6240a4f62511c189c90ef300c/comments", "author": null, "committer": null, "parents": [{"sha": "33a7a93218b1393d0135e3c4a9ad9ced87808f5e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33a7a93218b1393d0135e3c4a9ad9ced87808f5e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33a7a93218b1393d0135e3c4a9ad9ced87808f5e"}], "stats": {"total": 21, "additions": 20, "deletions": 1}, "files": [{"sha": "c0bb71c07650e7132925c64f7ef4e094d462b1b9", "filename": "contrib/compare-lto", "status": "modified", "additions": 20, "deletions": 1, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7a6d314e7f7eeb6240a4f62511c189c90ef300c/contrib%2Fcompare-lto", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7a6d314e7f7eeb6240a4f62511c189c90ef300c/contrib%2Fcompare-lto", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fcompare-lto?ref=f7a6d314e7f7eeb6240a4f62511c189c90ef300c", "patch": "@@ -32,7 +32,7 @@ case $1 in\n esac\n \n if test $# != 2; then\n-  echo 'usage: compare-lto file1.o file2.o' >&2\n+  echo 'usage: compare-lto file1 file2' >&2\n   exit 1\n fi\n \n@@ -101,6 +101,25 @@ else\n     else\n       status=1\n     fi\n+\n+  # PE-COFF executables are timestamped so skip leading bytes for them.\n+  else\n+    case \"$1\" in\n+      *.exe)\n+        if cmp -i 256 \"$1\" \"$2\"; then\n+          status=0\n+        else\n+          status=1\n+        fi\n+        ;;\n+      *)\n+        if test -f \"$1.exe\" && cmp -i 256 \"$1.exe\" \"$2.exe\"; then\n+          status=0\n+        else\n+          status=1\n+        fi\n+        ;;\n+    esac\n   fi\n fi\n "}]}