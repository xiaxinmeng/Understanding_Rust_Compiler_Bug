{"sha": "a388c77976fdac5a5773a9b71ee5f1644352a362", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTM4OGM3Nzk3NmZkYWM1YTU3NzNhOWI3MWVlNWYxNjQ0MzUyYTM2Mg==", "commit": {"author": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-11-22T21:41:27Z"}, "committer": {"name": "Thomas Koenig", "email": "tkoenig@gcc.gnu.org", "date": "2008-11-22T21:41:27Z"}, "message": "re PR libfortran/38225 (RESHAPE bounds with multi-dimensional SOURCE)\n\n2008-11-22  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/38225\n\t* intrinsics/reshape_generic.c (reshape_internal):\n\tUse all dimensions of source for bounds checking.\n\t* m4/reshape.m4:  Likewise.\n\t* generated/reshape_c10.c Regenerated.\n\t* generated/reshape_c16.c Regenerated.\n\t* generated/reshape_c4.c Regenerated.\n\t* generated/reshape_c8.c Regenerated.\n\t* generated/reshape_i16.c Regenerated.\n\t* generated/reshape_i4.c Regenerated.\n\t* generated/reshape_i8.c Regenerated.\n\t* generated/reshape_r10.c Regenerated.\n\t* generated/reshape_r16.c Regenerated.\n\t* generated/reshape_r4.c Regenerated.\n\t* generated/reshape_r8.c Regenerated.\n\n2008-11-22  Thomas Koenig  <tkoenig@gcc.gnu.org>\n\n\tPR libfortran/38225\n\t* gfortran.dg/reshape_3.f90:  New test.\n\nFrom-SVN: r142125", "tree": {"sha": "6eef96808a54ab0bd4ddf78411a3d8f3000cd141", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6eef96808a54ab0bd4ddf78411a3d8f3000cd141"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a388c77976fdac5a5773a9b71ee5f1644352a362", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a388c77976fdac5a5773a9b71ee5f1644352a362", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a388c77976fdac5a5773a9b71ee5f1644352a362", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a388c77976fdac5a5773a9b71ee5f1644352a362/comments", "author": null, "committer": null, "parents": [{"sha": "2ec855f1f74eb35dc8e2909b837ff7d8888d2220", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ec855f1f74eb35dc8e2909b837ff7d8888d2220", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ec855f1f74eb35dc8e2909b837ff7d8888d2220"}], "stats": {"total": 152, "additions": 139, "deletions": 13}, "files": [{"sha": "8feb7befa894d70d79601b9d4840b6de8d9d1024", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -1,3 +1,8 @@\n+2008-11-22  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/38225\n+\t* gfortran.dg/reshape_3.f90:  New test.\n+\n 2008-11-22  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/38160"}, {"sha": "a9f44b414eb06ab78b564cb504e20cb74fe0cb31", "filename": "gcc/testsuite/gfortran.dg/reshape_3.f90", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/gcc%2Ftestsuite%2Fgfortran.dg%2Freshape_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/gcc%2Ftestsuite%2Fgfortran.dg%2Freshape_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Freshape_3.f90?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -0,0 +1,12 @@\n+! { dg-do run }\n+! { dg-options \"-fbounds-check\" }\n+program main\n+  implicit none\n+  integer, dimension(2,2) :: a4\n+  integer(kind=1), dimension(2,2) :: a1\n+  character(len=100) line\n+  data a4 /1, 2, 3, 4/\n+  a1 = a4\n+  write (unit=line,fmt='(4I3)') reshape(a4,(/4/))\n+  write (unit=line,fmt='(4I3)') reshape(a1,(/4/))\n+end program main"}, {"sha": "7a176ee10e6a6f733d023abca9098315f73bbabd", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -1,3 +1,21 @@\n+2008-11-22  Thomas Koenig  <tkoenig@gcc.gnu.org>\n+\n+\tPR libfortran/38225\n+\t* intrinsics/reshape_generic.c (reshape_internal):\n+\tUse all dimensions of source for bounds checking.\n+\t* m4/reshape.m4:  Likewise.\n+\t* generated/reshape_c10.c Regenerated.\n+\t* generated/reshape_c16.c Regenerated.\n+\t* generated/reshape_c4.c Regenerated.\n+\t* generated/reshape_c8.c Regenerated.\n+\t* generated/reshape_i16.c Regenerated.\n+\t* generated/reshape_i4.c Regenerated.\n+\t* generated/reshape_i8.c Regenerated.\n+\t* generated/reshape_r10.c Regenerated.\n+\t* generated/reshape_r16.c Regenerated.\n+\t* generated/reshape_r4.c Regenerated.\n+\t* generated/reshape_r8.c Regenerated.\n+\n 2008-11-22  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR libfortran/37839"}, {"sha": "33059948a64dc6c09cd632ecc9384f53d1c85d20", "filename": "libgfortran/generated/reshape_c10.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c10.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c10.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_c10.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_c10 (gfc_array_c10 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "3b026a5028b377b012353e7a4542cb99c801a114", "filename": "libgfortran/generated/reshape_c16.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_c16.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_c16 (gfc_array_c16 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "1c4740c7f0b49da10ff9c4e8dee26fd47cd9e210", "filename": "libgfortran/generated/reshape_c4.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_c4.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_c4 (gfc_array_c4 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "d68ea481ad3b0cda8820cf3f8e91eb781dd7d2fa", "filename": "libgfortran/generated/reshape_c8.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_c8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_c8.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_c8 (gfc_array_c8 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "f46d7586dfc2bff7c13321de51a14f031af04126", "filename": "libgfortran/generated/reshape_i16.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_i16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_i16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_i16.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_16 (gfc_array_i16 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "d868c936cc28ca430dca1eafe415e3d2950c5eae", "filename": "libgfortran/generated/reshape_i4.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_i4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_i4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_i4.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_4 (gfc_array_i4 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "bcd984f139750fa13fe1692292516a69e9abf123", "filename": "libgfortran/generated/reshape_i8.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_i8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_i8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_i8.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_8 (gfc_array_i8 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "ac029593d98a1a761faed7130c71f5e92e633644", "filename": "libgfortran/generated/reshape_r10.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r10.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r10.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_r10.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_r10 (gfc_array_r10 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "c12fab5c399baf1f97535347c05ddf5d02dfb80c", "filename": "libgfortran/generated/reshape_r16.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r16.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r16.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_r16.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_r16 (gfc_array_r16 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "aa4bdec70d434a17f93d347fa7a97a0728696d18", "filename": "libgfortran/generated/reshape_r4.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_r4.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_r4 (gfc_array_r4 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "bacaaac05bccf2126b41ef2875c56f08017c2f0f", "filename": "libgfortran/generated/reshape_r8.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r8.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fgenerated%2Freshape_r8.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fgenerated%2Freshape_r8.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -135,7 +135,14 @@ reshape_r8 (gfc_array_r8 * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "8e1fedb7a99c28e97f4dcf1c923baa777341d8ab", "filename": "libgfortran/intrinsics/reshape_generic.c", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fintrinsics%2Freshape_generic.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fintrinsics%2Freshape_generic.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fintrinsics%2Freshape_generic.c?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -124,7 +124,14 @@ reshape_internal (parray *ret, parray *source, shape_type *shape,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}, {"sha": "aa5d42960f7399b7f49eaa09fab31cc97f9541a1", "filename": "libgfortran/m4/reshape.m4", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fm4%2Freshape.m4", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a388c77976fdac5a5773a9b71ee5f1644352a362/libgfortran%2Fm4%2Freshape.m4", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fm4%2Freshape.m4?ref=a388c77976fdac5a5773a9b71ee5f1644352a362", "patch": "@@ -139,7 +139,14 @@ reshape_'rtype_ccode` ('rtype` * const restrict ret,\n \t\t\t  (long int) ret_extent, (long int) shape_data[n]);\n \t}\n \n-      source_extent = source->dim[0].ubound + 1 - source->dim[0].lbound;\n+      source_extent = 1;\n+      sdim = GFC_DESCRIPTOR_RANK (source);\n+      for (n = 0; n < sdim; n++)\n+\t{\n+\t  index_type se;\n+\t  se = source->dim[n].ubound + 1 - source->dim[0].lbound;\n+\t  source_extent *= se > 0 ? se : 0;\n+\t}\n \n       if (rs < source_extent || (rs > source_extent && !pad))\n \truntime_error(\"Incorrect size in SOURCE argument to RESHAPE\""}]}