{"sha": "ec2be203d1d8c5cd690cc1444303a2ca9187e962", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWMyYmUyMDNkMWQ4YzVjZDY5MGNjMTQ0NDMwM2EyY2E5MTg3ZTk2Mg==", "commit": {"author": {"name": "David Malcolm", "email": "dmalcolm@redhat.com", "date": "2019-01-31T18:09:29Z"}, "committer": {"name": "David Malcolm", "email": "dmalcolm@gcc.gnu.org", "date": "2019-01-31T18:09:29Z"}, "message": "Fix bogus fix-it for FLT_MAX (PR c/89122)\n\nPR c/89122 reports that we emit a bogus fix-it hint for the case where\nthe code uses FLT_MAX, but has included <limits.h> rather than <float.h>:\n\nx.c:3:11: error: 'FLT_MAX' undeclared here (not in a function); did you\n  mean 'INT_MAX'?\n    3 | float f = FLT_MAX;\n      |           ^~~~~~~\n      |           INT_MAX\n\nThis patch adds some knowledge of <float.h> (and <cfloat>) to\nknown-headers.cc, fixing the issue:\n\nx.c:3:11: error: 'FLT_MAX' undeclared here (not in a function)\n    3 | float f = FLT_MAX;\n      |           ^~~~~~~\nx.c:2:1: note: 'FLT_MAX' is defined in header '<float.h>'; did you forget\n  to '#include <float.h>'?\n    1 | #include <limits.h>\n  +++ |+#include <float.h>\n    2 |\n\ngcc/c-family/ChangeLog:\n\tPR c/89122\n\t* known-headers.cc (get_stdlib_header_for_name): Add\n\t{FLT|DBL|LDBL}_{MAX|MIN} to \"hints\" array.\n\ngcc/testsuite/ChangeLog:\n\tPR c/89122\n\t* g++.dg/spellcheck-stdlib.C (test_FLT_MAX): New test.\n\t* gcc.dg/spellcheck-stdlib.c (test_FLT_MAX): New test.\n\nFrom-SVN: r268426", "tree": {"sha": "353a626c0687248a7da4d78198b3f10714c0283a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/353a626c0687248a7da4d78198b3f10714c0283a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ec2be203d1d8c5cd690cc1444303a2ca9187e962", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec2be203d1d8c5cd690cc1444303a2ca9187e962", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ec2be203d1d8c5cd690cc1444303a2ca9187e962", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ec2be203d1d8c5cd690cc1444303a2ca9187e962/comments", "author": {"login": "davidmalcolm", "id": 1553248, "node_id": "MDQ6VXNlcjE1NTMyNDg=", "avatar_url": "https://avatars.githubusercontent.com/u/1553248?v=4", "gravatar_id": "", "url": "https://api.github.com/users/davidmalcolm", "html_url": "https://github.com/davidmalcolm", "followers_url": "https://api.github.com/users/davidmalcolm/followers", "following_url": "https://api.github.com/users/davidmalcolm/following{/other_user}", "gists_url": "https://api.github.com/users/davidmalcolm/gists{/gist_id}", "starred_url": "https://api.github.com/users/davidmalcolm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/davidmalcolm/subscriptions", "organizations_url": "https://api.github.com/users/davidmalcolm/orgs", "repos_url": "https://api.github.com/users/davidmalcolm/repos", "events_url": "https://api.github.com/users/davidmalcolm/events{/privacy}", "received_events_url": "https://api.github.com/users/davidmalcolm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "636ecb78a36df20232be05fd4fa2bdbea67c5551", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/636ecb78a36df20232be05fd4fa2bdbea67c5551", "html_url": "https://github.com/Rust-GCC/gccrs/commit/636ecb78a36df20232be05fd4fa2bdbea67c5551"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "dd1173f04872dc877b724bed1b43a5722cfc0dce", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=ec2be203d1d8c5cd690cc1444303a2ca9187e962", "patch": "@@ -1,3 +1,9 @@\n+2019-01-31  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR c/89122\n+\t* known-headers.cc (get_stdlib_header_for_name): Add\n+\t{FLT|DBL|LDBL}_{MAX|MIN} to \"hints\" array.\n+\n 2019-01-31  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR libstdc++/88170"}, {"sha": "c222f306c84b44625335ae3b1144ae8edc7a34c8", "filename": "gcc/c-family/known-headers.cc", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Fc-family%2Fknown-headers.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Fc-family%2Fknown-headers.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fknown-headers.cc?ref=ec2be203d1d8c5cd690cc1444303a2ca9187e962", "patch": "@@ -84,6 +84,14 @@ get_stdlib_header_for_name (const char *name, enum stdlib lib)\n     {\"ULONG_MAX\", {\"<limits.h>\", \"<climits>\"} },\n     {\"USHRT_MAX\", {\"<limits.h>\", \"<climits>\"} },\n \n+    /* <float.h> and <cfloat>.  */\n+    {\"DBL_MAX\", {\"<float.h>\", \"<cfloat>\"} },\n+    {\"DBL_MIN\", {\"<float.h>\", \"<cfloat>\"} },\n+    {\"FLT_MAX\", {\"<float.h>\", \"<cfloat>\"} },\n+    {\"FLT_MIN\", {\"<float.h>\", \"<cfloat>\"} },\n+    {\"LDBL_MAX\", {\"<float.h>\", \"<cfloat>\"} },\n+    {\"LDBL_MIN\", {\"<float.h>\", \"<cfloat>\"} },\n+\n     /* <stdarg.h> and <cstdarg>.  */\n     {\"va_list\", {\"<stdarg.h>\", \"<cstdarg>\"} },\n "}, {"sha": "25cf4cdafaa3ca4bfa7744f44ca660e82153c987", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ec2be203d1d8c5cd690cc1444303a2ca9187e962", "patch": "@@ -1,3 +1,9 @@\n+2019-01-31  David Malcolm  <dmalcolm@redhat.com>\n+\n+\tPR c/89122\n+\t* g++.dg/spellcheck-stdlib.C (test_FLT_MAX): New test.\n+\t* gcc.dg/spellcheck-stdlib.c (test_FLT_MAX): New test.\n+\n 2019-01-31  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/89135"}, {"sha": "31e91fe8d1b4c5937d0e4c076b241f5e52bd9234", "filename": "gcc/testsuite/g++.dg/spellcheck-stdlib.C", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fspellcheck-stdlib.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fspellcheck-stdlib.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fspellcheck-stdlib.C?ref=ec2be203d1d8c5cd690cc1444303a2ca9187e962", "patch": "@@ -77,6 +77,11 @@ int test_INT_MAX (void)\n   // { dg-message \"'INT_MAX' is defined in header '<climits>'; did you forget to '#include <climits>'?\" \"\" { target *-*-* } INT_MAX_line }\n }\n \n+/* Missing <cfloat>.  */\n+float test_FLT_MAX = FLT_MAX; // { dg-line FLT_MAX_line }\n+// { dg-error \"'FLT_MAX' was not declared\" \"\" { target *-*-* } FLT_MAX_line }\n+// { dg-message \"'FLT_MAX' is defined in header '<cfloat>'; did you forget to '#include <cfloat>'?\" \"\" { target *-*-* } FLT_MAX_line }\n+\n /* Missing <cstring>.  */\n \n void test_cstring (char *dest, char *src)"}, {"sha": "1ae3b5e33abd915a8a842c5bc6f8904637511824", "filename": "gcc/testsuite/gcc.dg/spellcheck-stdlib.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Ftestsuite%2Fgcc.dg%2Fspellcheck-stdlib.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ec2be203d1d8c5cd690cc1444303a2ca9187e962/gcc%2Ftestsuite%2Fgcc.dg%2Fspellcheck-stdlib.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fspellcheck-stdlib.c?ref=ec2be203d1d8c5cd690cc1444303a2ca9187e962", "patch": "@@ -62,3 +62,8 @@ int test_INT_MAX (void)\n   /* { dg-bogus \"__INT_MAX__\" \"\" { target *-*-* } INT_MAX_line } */\n   /* { dg-message \"'INT_MAX' is defined in header '<limits.h>'; did you forget to '#include <limits.h>'?\" \"\" { target *-*-* } INT_MAX_line } */\n }\n+\n+/* Missing <float.h>.  */\n+float test_FLT_MAX = FLT_MAX; /* { dg-line FLT_MAX_line } */\n+/* { dg-error \"'FLT_MAX' undeclared\" \"\" { target *-*-* } FLT_MAX_line } */\n+/* { dg-message \"'FLT_MAX' is defined in header '<float.h>'; did you forget to '#include <float.h>'?\" \"\" { target *-*-* } FLT_MAX_line } */"}]}