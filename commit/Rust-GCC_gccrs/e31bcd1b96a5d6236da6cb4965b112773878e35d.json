{"sha": "e31bcd1b96a5d6236da6cb4965b112773878e35d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTMxYmNkMWI5NmE1ZDYyMzZkYTZjYjQ5NjViMTEyNzczODc4ZTM1ZA==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2009-08-18T17:01:36Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2009-08-18T17:01:36Z"}, "message": "elfos.h (ASM_DECLARE_OBJECT_NAME): Use gnu_unique_object type if available.\n\n\t* config/elfos.h (ASM_DECLARE_OBJECT_NAME): Use gnu_unique_object\n\ttype if available.\n\t* configure.ac: Test for it.\n\t* configure, config.in: Regenerate.\n\t* doc/install.texi: Document --enable-gnu-unique-object.\n\nFrom-SVN: r150882", "tree": {"sha": "d10cd641fb7ee2242f80c381c47d98011ca1467f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d10cd641fb7ee2242f80c381c47d98011ca1467f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e31bcd1b96a5d6236da6cb4965b112773878e35d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e31bcd1b96a5d6236da6cb4965b112773878e35d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e31bcd1b96a5d6236da6cb4965b112773878e35d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e31bcd1b96a5d6236da6cb4965b112773878e35d/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8fd962e39c8bf6a2506c684f48a19a41c4c5aa5f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8fd962e39c8bf6a2506c684f48a19a41c4c5aa5f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8fd962e39c8bf6a2506c684f48a19a41c4c5aa5f"}], "stats": {"total": 217, "additions": 172, "deletions": 45}, "files": [{"sha": "8228ad2a136d3cfbec4a4621525ba6eb6e7053e0", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e31bcd1b96a5d6236da6cb4965b112773878e35d", "patch": "@@ -1,3 +1,11 @@\n+2009-08-18  Jason Merrill  <jason@redhat.com>\n+\n+\t* config/elfos.h (ASM_DECLARE_OBJECT_NAME): Use gnu_unique_object\n+\ttype if available.\n+\t* configure.ac: Test for it.\n+\t* configure, config.in: Regenerate.\n+\t* doc/install.texi: Document --enable-gnu-unique-object.\n+\n 2009-08-18  Richard Guenther  <rguenther@suse.de>\n \n \tPR middle-end/41094"}, {"sha": "ee6535e89901b2bb53faa8b8ed52e85af79a3963", "filename": "gcc/config.in", "status": "modified", "additions": 14, "deletions": 7, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfig.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfig.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig.in?ref=e31bcd1b96a5d6236da6cb4965b112773878e35d", "patch": "@@ -321,6 +321,12 @@\n #endif\n \n \n+/* Define if your assembler supports LWSYNC instructions. */\n+#ifndef USED_FOR_TARGET\n+#undef HAVE_AS_LWSYNC\n+#endif\n+\n+\n /* Define if your assembler supports mfcr field. */\n #ifndef USED_FOR_TARGET\n #undef HAVE_AS_MFCRF\n@@ -351,22 +357,17 @@\n #endif\n \n \n-/* Define if your assembler supports popcntb instruction. */\n+/* Define if your assembler supports popcntb field. */\n #ifndef USED_FOR_TARGET\n #undef HAVE_AS_POPCNTB\n #endif\n \n \n-/* Define if your assembler supports popcntd instruction. */\n+/* Define if your assembler supports POPCNTD instructions. */\n #ifndef USED_FOR_TARGET\n #undef HAVE_AS_POPCNTD\n #endif\n \n-/* Define if your assembler supports lwsync instruction. */\n-#ifndef USED_FOR_TARGET\n-#undef HAVE_AS_LWSYNC\n-#endif\n-\n \n /* Define if your assembler supports .register. */\n #ifndef USED_FOR_TARGET\n@@ -886,6 +887,12 @@\n #endif\n \n \n+/* Define if your assembler supports @gnu_unique_object. */\n+#ifndef USED_FOR_TARGET\n+#undef HAVE_GAS_GNU_UNIQUE_OBJECT\n+#endif\n+\n+\n /* Define if your assembler and linker support .hidden. */\n #undef HAVE_GAS_HIDDEN\n "}, {"sha": "56d7b408e5d9c79a3305552f0bec46933625f2f3", "filename": "gcc/config/elfos.h", "status": "modified", "additions": 31, "deletions": 18, "changes": 49, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfig%2Felfos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfig%2Felfos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Felfos.h?ref=e31bcd1b96a5d6236da6cb4965b112773878e35d", "patch": "@@ -289,24 +289,37 @@ see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n \n /* Write the extra assembler code needed to declare an object properly.  */\n \n-#define ASM_DECLARE_OBJECT_NAME(FILE, NAME, DECL)\t\t\\\n-  do\t\t\t\t\t\t\t\t\\\n-    {\t\t\t\t\t\t\t\t\\\n-      HOST_WIDE_INT size;\t\t\t\t\t\\\n-\t\t\t\t\t\t\t\t\\\n-      ASM_OUTPUT_TYPE_DIRECTIVE (FILE, NAME, \"object\");\t\t\\\n-\t\t\t\t\t\t\t\t\\\n-      size_directive_output = 0;\t\t\t\t\\\n-      if (!flag_inhibit_size_directive\t\t\t\t\\\n-\t  && (DECL) && DECL_SIZE (DECL))\t\t\t\\\n-\t{\t\t\t\t\t\t\t\\\n-\t  size_directive_output = 1;\t\t\t\t\\\n-\t  size = int_size_in_bytes (TREE_TYPE (DECL));\t\t\\\n-\t  ASM_OUTPUT_SIZE_DIRECTIVE (FILE, NAME, size);\t\t\\\n-\t}\t\t\t\t\t\t\t\\\n-\t\t\t\t\t\t\t\t\\\n-      ASM_OUTPUT_LABEL (FILE, NAME);\t\t\t\t\\\n-    }\t\t\t\t\t\t\t\t\\\n+#ifdef HAVE_GAS_GNU_UNIQUE_OBJECT\n+#define USE_GNU_UNIQUE_OBJECT 1\n+#else\n+#define USE_GNU_UNIQUE_OBJECT 0\n+#endif\n+\n+#define ASM_DECLARE_OBJECT_NAME(FILE, NAME, DECL)\t\t\t\\\n+  do\t\t\t\t\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\t\\\n+      HOST_WIDE_INT size;\t\t\t\t\t\t\\\n+\t\t\t\t\t\t\t\t\t\\\n+      /* For template static data member instantiations or\t\t\\\n+\t inline fn local statics, use gnu_unique_object so that\t\t\\\n+\t they will be combined even under RTLD_LOCAL.  */\t\t\\\n+      if (USE_GNU_UNIQUE_OBJECT\t\t\t\t\t\t\\\n+\t  && !DECL_ARTIFICIAL (DECL) && DECL_ONE_ONLY (DECL))\t\t\\\n+\tASM_OUTPUT_TYPE_DIRECTIVE (FILE, NAME, \"gnu_unique_object\");\t\\\n+      else\t\t\t\t\t\t\t\t\\\n+\tASM_OUTPUT_TYPE_DIRECTIVE (FILE, NAME, \"object\");\t\t\\\n+\t\t\t\t\t\t\t\t\t\\\n+      size_directive_output = 0;\t\t\t\t\t\\\n+      if (!flag_inhibit_size_directive\t\t\t\t\t\\\n+\t  && (DECL) && DECL_SIZE (DECL))\t\t\t\t\\\n+\t{\t\t\t\t\t\t\t\t\\\n+\t  size_directive_output = 1;\t\t\t\t\t\\\n+\t  size = int_size_in_bytes (TREE_TYPE (DECL));\t\t\t\\\n+\t  ASM_OUTPUT_SIZE_DIRECTIVE (FILE, NAME, size);\t\t\t\\\n+\t}\t\t\t\t\t\t\t\t\\\n+\t\t\t\t\t\t\t\t\t\\\n+      ASM_OUTPUT_LABEL (FILE, NAME);\t\t\t\t\t\\\n+    }\t\t\t\t\t\t\t\t\t\\\n   while (0)\n \n /* Output the size directive for a decl in rest_of_decl_compilation"}, {"sha": "61789a84d22ebcd419ebb1de39b4932f97181902", "filename": "gcc/configure", "status": "modified", "additions": 85, "deletions": 20, "changes": 105, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=e31bcd1b96a5d6236da6cb4965b112773878e35d", "patch": "@@ -1091,6 +1091,8 @@ Optional Features:\n   --enable-fast-install[=PKGS]\n                           optimize for fast installation [default=yes]\n   --disable-libtool-lock  avoid locking (might break parallel builds)\n+  --enable-gnu-unique-object\tenable the use of the @gnu_unique_object ELF extension on\n+\t\t\t\tglibc systems\n   --enable-linker-build-id\n                           compiler will always pass --build-id to linker\n   --enable-maintainer-mode\n@@ -14903,13 +14905,13 @@ if test \"${lt_cv_nm_interface+set}\" = set; then\n else\n   lt_cv_nm_interface=\"BSD nm\"\n   echo \"int some_variable = 0;\" > conftest.$ac_ext\n-  (eval echo \"\\\"\\$as_me:14906: $ac_compile\\\"\" >&5)\n+  (eval echo \"\\\"\\$as_me:14908: $ac_compile\\\"\" >&5)\n   (eval \"$ac_compile\" 2>conftest.err)\n   cat conftest.err >&5\n-  (eval echo \"\\\"\\$as_me:14909: $NM \\\\\\\"conftest.$ac_objext\\\\\\\"\\\"\" >&5)\n+  (eval echo \"\\\"\\$as_me:14911: $NM \\\\\\\"conftest.$ac_objext\\\\\\\"\\\"\" >&5)\n   (eval \"$NM \\\"conftest.$ac_objext\\\"\" 2>conftest.err > conftest.out)\n   cat conftest.err >&5\n-  (eval echo \"\\\"\\$as_me:14912: output\\\"\" >&5)\n+  (eval echo \"\\\"\\$as_me:14914: output\\\"\" >&5)\n   cat conftest.out >&5\n   if $GREP 'External.*some_variable' conftest.out > /dev/null; then\n     lt_cv_nm_interface=\"MS dumpbin\"\n@@ -16066,7 +16068,7 @@ ia64-*-hpux*)\n   ;;\n *-*-irix6*)\n   # Find out which ABI we are using.\n-  echo '#line 16069 \"configure\"' > conftest.$ac_ext\n+  echo '#line 16071 \"configure\"' > conftest.$ac_ext\n   if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   (eval $ac_compile) 2>&5\n   ac_status=$?\n@@ -17959,11 +17961,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:17962: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:17964: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>conftest.err)\n    ac_status=$?\n    cat conftest.err >&5\n-   echo \"$as_me:17966: \\$? = $ac_status\" >&5\n+   echo \"$as_me:17968: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s \"$ac_outfile\"; then\n      # The compiler can only warn and ignore the option if not recognized\n      # So say no if there are warnings other than the usual output.\n@@ -18298,11 +18300,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:18301: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:18303: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>conftest.err)\n    ac_status=$?\n    cat conftest.err >&5\n-   echo \"$as_me:18305: \\$? = $ac_status\" >&5\n+   echo \"$as_me:18307: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s \"$ac_outfile\"; then\n      # The compiler can only warn and ignore the option if not recognized\n      # So say no if there are warnings other than the usual output.\n@@ -18403,11 +18405,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:18406: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:18408: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:18410: \\$? = $ac_status\" >&5\n+   echo \"$as_me:18412: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -18458,11 +18460,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:18461: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:18463: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:18465: \\$? = $ac_status\" >&5\n+   echo \"$as_me:18467: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -21270,7 +21272,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 21273 \"configure\"\n+#line 21275 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -21366,7 +21368,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 21369 \"configure\"\n+#line 21371 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -23382,11 +23384,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:23385: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:23387: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>conftest.err)\n    ac_status=$?\n    cat conftest.err >&5\n-   echo \"$as_me:23389: \\$? = $ac_status\" >&5\n+   echo \"$as_me:23391: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s \"$ac_outfile\"; then\n      # The compiler can only warn and ignore the option if not recognized\n      # So say no if there are warnings other than the usual output.\n@@ -23481,11 +23483,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:23484: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:23486: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:23488: \\$? = $ac_status\" >&5\n+   echo \"$as_me:23490: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -23533,11 +23535,11 @@ else\n    -e 's:.*FLAGS}\\{0,1\\} :&$lt_compiler_flag :; t' \\\n    -e 's: [^ ]*conftest\\.: $lt_compiler_flag&:; t' \\\n    -e 's:$: $lt_compiler_flag:'`\n-   (eval echo \"\\\"\\$as_me:23536: $lt_compile\\\"\" >&5)\n+   (eval echo \"\\\"\\$as_me:23538: $lt_compile\\\"\" >&5)\n    (eval \"$lt_compile\" 2>out/conftest.err)\n    ac_status=$?\n    cat out/conftest.err >&5\n-   echo \"$as_me:23540: \\$? = $ac_status\" >&5\n+   echo \"$as_me:23542: \\$? = $ac_status\" >&5\n    if (exit $ac_status) && test -s out/conftest2.$ac_objext\n    then\n      # The compiler can only warn and ignore the option if not recognized\n@@ -28096,6 +28098,69 @@ _ACEOF\n \n fi\n \n+# Check whether --enable-gnu-unique-object or --disable-gnu-unique-object was given.\n+if test \"${enable_gnu_unique_object+set}\" = set; then\n+  enableval=\"$enable_gnu_unique_object\"\n+  case $enable_gnu_unique_object in\n+    yes | no) ;;\n+    *) { { echo \"$as_me:$LINENO: error: '$enable_gnu_unique_object' is an invalid value for --enable-gnu-unique-object.\n+Valid choices are 'yes' and 'no'.\" >&5\n+echo \"$as_me: error: '$enable_gnu_unique_object' is an invalid value for --enable-gnu-unique-object.\n+Valid choices are 'yes' and 'no'.\" >&2;}\n+   { (exit 1); exit 1; }; } ;;\n+  esac\n+else\n+  echo \"$as_me:$LINENO: checking assembler for gnu_unique_object\" >&5\n+echo $ECHO_N \"checking assembler for gnu_unique_object... $ECHO_C\" >&6\n+if test \"${gcc_cv_as_gnu_unique_object+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  gcc_cv_as_gnu_unique_object=no\n+    if test $in_tree_gas = yes; then\n+    if test $in_tree_gas_is_elf = yes \\\n+  && test $gcc_cv_gas_vers -ge `expr \\( \\( 2 \\* 1000 \\) + 19 \\) \\* 1000 + 52`\n+  then gcc_cv_as_gnu_unique_object=yes\n+fi\n+  elif test x$gcc_cv_as != x; then\n+    echo '.type foo, @gnu_unique_object' > conftest.s\n+    if { ac_try='$gcc_cv_as  -o conftest.o conftest.s >&5'\n+  { (eval echo \"$as_me:$LINENO: \\\"$ac_try\\\"\") >&5\n+  (eval $ac_try) 2>&5\n+  ac_status=$?\n+  echo \"$as_me:$LINENO: \\$? = $ac_status\" >&5\n+  (exit $ac_status); }; }\n+    then\n+\t# Also check for ld.so support, i.e. glibc 2.11 or higher.\n+   if test x$host = x$build -a x$host = x$target &&\n+       glibcver=`ldd --version 2>/dev/null`; then\n+      glibcmajor=`expr \"$glibcver\" : \"ldd (GNU libc) \\([0-9]*\\)\"`\n+      glibcminor=`expr \"$glibcver\" : \"ldd (GNU libc) [0-9]*\\.\\([0-9]*\\)\"`\n+      glibcnum=`expr $glibcmajor \\* 1000 + $glibcminor`\n+      if test \"$glibcnum\" -ge 2011 ; then\n+        gcc_cv_as_gnu_unique_object=yes\n+      fi\n+    fi\n+    else\n+      echo \"configure: failed program was\" >&5\n+      cat conftest.s >&5\n+    fi\n+    rm -f conftest.o conftest.s\n+  fi\n+fi\n+echo \"$as_me:$LINENO: result: $gcc_cv_as_gnu_unique_object\" >&5\n+echo \"${ECHO_T}$gcc_cv_as_gnu_unique_object\" >&6\n+if test $gcc_cv_as_gnu_unique_object = yes; then\n+  enable_gnu_unique_object=yes\n+fi\n+fi;\n+if test x$enable_gnu_unique_object = xyes; then\n+\n+cat >>confdefs.h <<\\_ACEOF\n+#define HAVE_GAS_GNU_UNIQUE_OBJECT 1\n+_ACEOF\n+\n+fi\n+\n echo \"$as_me:$LINENO: checking assembler for tolerance to line number 0\" >&5\n echo $ECHO_N \"checking assembler for tolerance to line number 0... $ECHO_C\" >&6\n if test \"${gcc_cv_as_line_zero+set}\" = set; then"}, {"sha": "c068cf9aebaa0c8800254116a6c1c295214d4549", "filename": "gcc/configure.ac", "status": "modified", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.ac?ref=e31bcd1b96a5d6236da6cb4965b112773878e35d", "patch": "@@ -3379,6 +3379,33 @@ gcc_GAS_CHECK_FEATURE([.lcomm with alignment], gcc_cv_as_lcomm_with_alignment,\n [AC_DEFINE(HAVE_GAS_LCOMM_WITH_ALIGNMENT, 1,\n   [Define if your assembler supports .lcomm with an alignment field.])])\n \n+AC_ARG_ENABLE(gnu-unique-object,\n+ [  --enable-gnu-unique-object\tenable the use of the @gnu_unique_object ELF extension on\n+\t\t\t\tglibc systems],\n+ [case $enable_gnu_unique_object in\n+    yes | no) ;;\n+    *) AC_MSG_ERROR(['$enable_gnu_unique_object' is an invalid value for --enable-gnu-unique-object.\n+Valid choices are 'yes' and 'no'.]) ;;\n+  esac],\n+ [gcc_GAS_CHECK_FEATURE([gnu_unique_object], gcc_cv_as_gnu_unique_object,\n+   [elf,2,19,52],,\n+   [.type foo, @gnu_unique_object],\n+# Also check for ld.so support, i.e. glibc 2.11 or higher.\n+   [if test x$host = x$build -a x$host = x$target &&\n+       glibcver=`ldd --version 2>/dev/null`; then\n+      glibcmajor=`expr \"$glibcver\" : \"ldd (GNU libc) \\([[0-9]]*\\)\"`\n+      glibcminor=`expr \"$glibcver\" : \"ldd (GNU libc) [[0-9]]*\\.\\([[0-9]]*\\)\"`\n+      glibcnum=`expr $glibcmajor \\* 1000 + $glibcminor`\n+      if test \"$glibcnum\" -ge 2011 ; then\n+        gcc_cv_as_gnu_unique_object=yes\n+      fi\n+    fi],\n+   [enable_gnu_unique_object=yes])])\n+if test x$enable_gnu_unique_object = xyes; then\n+  AC_DEFINE(HAVE_GAS_GNU_UNIQUE_OBJECT, 1,\n+   [Define if your assembler supports @gnu_unique_object.])\n+fi\n+\n AC_CACHE_CHECK([assembler for tolerance to line number 0],\n  [gcc_cv_as_line_zero],\n  [gcc_cv_as_line_zero=no"}, {"sha": "739e929ed7b337d7b66f68bcc741b8c8d3000c9e", "filename": "gcc/doc/install.texi", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fdoc%2Finstall.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e31bcd1b96a5d6236da6cb4965b112773878e35d/gcc%2Fdoc%2Finstall.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finstall.texi?ref=e31bcd1b96a5d6236da6cb4965b112773878e35d", "patch": "@@ -1595,6 +1595,13 @@ option), if the linker supports it.  If you specify\n support @option{--build-id} option, a warning is issued and the\n @option{--enable-linker-build-id} option is ignored.  The default is off.\n \n+@item --enable-gnu-unique-object\n+@itemx --disable-gnu-unique-object\n+Tells GCC to use the gnu_unique_object relocation for C++ template\n+static data members and inline function local statics.  Enabled by\n+default for a native toolchain with an assembler that accepts it and\n+GLIBC 2.11 or above, otherwise disabled.\n+\n @end table\n \n @subheading Cross-Compiler-Specific Options"}]}