{"sha": "c9935123aef8eac547cdd0e8b06811fc776a6b32", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Yzk5MzUxMjNhZWY4ZWFjNTQ3Y2RkMGU4YjA2ODExZmM3NzZhNmIzMg==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-06-19T18:04:46Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-06-19T18:04:46Z"}, "message": "re PR fortran/69398 ([OOP] ICE on class with duplicate dimension attribute specified)\n\n2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/69398\n\t* decl.c (attr_decl): Check for duplicate DIMENSION attribute for a\n\tCLASS entity.\n\n2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/69398\n\t* gfortran.dg/pr69398.f90: New test.\n\nFrom-SVN: r272481", "tree": {"sha": "b9bc470b02b25d6245435882c21c59a4da8ea708", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b9bc470b02b25d6245435882c21c59a4da8ea708"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c9935123aef8eac547cdd0e8b06811fc776a6b32", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9935123aef8eac547cdd0e8b06811fc776a6b32", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c9935123aef8eac547cdd0e8b06811fc776a6b32", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c9935123aef8eac547cdd0e8b06811fc776a6b32/comments", "author": null, "committer": null, "parents": [{"sha": "ee3aab6826f7dbfe0f1a509cb429f4a4d755f38b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ee3aab6826f7dbfe0f1a509cb429f4a4d755f38b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ee3aab6826f7dbfe0f1a509cb429f4a4d755f38b"}], "stats": {"total": 31, "additions": 31, "deletions": 0}, "files": [{"sha": "2014342f9dacae4ae667cda636e304149481ecc3", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=c9935123aef8eac547cdd0e8b06811fc776a6b32", "patch": "@@ -1,3 +1,9 @@\n+2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/69398\n+\t* decl.c (attr_decl): Check for duplicate DIMENSION attribute for a\n+\tCLASS entity.\n+\n 2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/87907"}, {"sha": "7fcb60ab7ab85092a4d90c7fe13582a10ec85be3", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=c9935123aef8eac547cdd0e8b06811fc776a6b32", "patch": "@@ -8372,6 +8372,15 @@ attr_decl1 (void)\n      to the first component, or '_data' field.  */\n   if (sym->ts.type == BT_CLASS && sym->ts.u.derived->attr.is_class)\n     {\n+      /* gfc_set_array_spec sets sym->attr not CLASS_DATA(sym)->attr.  Check\n+\t for duplicate attribute here.  */\n+      if (CLASS_DATA(sym)->attr.dimension == 1 && as)\n+\t{\n+\t  gfc_error (\"Duplicate DIMENSION attribute at %C\");\n+\t  m = MATCH_ERROR;\n+\t  goto cleanup;\n+\t}\n+\n       if (!gfc_copy_attr (&CLASS_DATA(sym)->attr, &current_attr, &var_locus))\n \t{\n \t  m = MATCH_ERROR;"}, {"sha": "5b81695aa248666ef68907aadb84f8688a7d5a3a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=c9935123aef8eac547cdd0e8b06811fc776a6b32", "patch": "@@ -1,3 +1,8 @@\n+2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/69398\n+\t* gfortran.dg/pr69398.f90: New test.\n+\n 2019-06-19  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/87907"}, {"sha": "686374650489d9492661f0a8be8cfbc967008227", "filename": "gcc/testsuite/gfortran.dg/pr69398.f90", "status": "added", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr69398.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c9935123aef8eac547cdd0e8b06811fc776a6b32/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr69398.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr69398.f90?ref=c9935123aef8eac547cdd0e8b06811fc776a6b32", "patch": "@@ -0,0 +1,11 @@\n+! { dg-do compile }\n+! PR fortran/69398\n+! Contributed by Gerhard Steinmetz\n+program p\n+   type t\n+   end type\n+   class(t), allocatable :: z(:)\n+   target :: z(:)    ! { dg-error \"Duplicate DIMENSION attribute\" }\n+   allocate (z(2))\n+end\n+"}]}