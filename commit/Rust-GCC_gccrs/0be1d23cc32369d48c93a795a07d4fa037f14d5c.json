{"sha": "0be1d23cc32369d48c93a795a07d4fa037f14d5c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGJlMWQyM2NjMzIzNjlkNDhjOTNhNzk1YTA3ZDRmYTAzN2YxNGQ1Yw==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2017-04-03T11:02:59Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2017-04-03T11:02:59Z"}, "message": "tree-nested.c (get_descriptor_type): Make sure that the alignment of descriptors is at least equal to that of functions.\n\n\t* tree-nested.c (get_descriptor_type): Make sure that the alignment of\n\tdescriptors is at least equal to that of functions.\n\nFrom-SVN: r246646", "tree": {"sha": "cf22d322ad600e01be8276e666e80baff028b701", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cf22d322ad600e01be8276e666e80baff028b701"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0be1d23cc32369d48c93a795a07d4fa037f14d5c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0be1d23cc32369d48c93a795a07d4fa037f14d5c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0be1d23cc32369d48c93a795a07d4fa037f14d5c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0be1d23cc32369d48c93a795a07d4fa037f14d5c/comments", "author": null, "committer": null, "parents": [{"sha": "79f9fc387d52049546f9ceb43472743d3a1153cc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/79f9fc387d52049546f9ceb43472743d3a1153cc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/79f9fc387d52049546f9ceb43472743d3a1153cc"}], "stats": {"total": 9, "additions": 9, "deletions": 0}, "files": [{"sha": "89b3d0d7def51dc0cdaa9821c98a26287534010e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0be1d23cc32369d48c93a795a07d4fa037f14d5c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0be1d23cc32369d48c93a795a07d4fa037f14d5c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=0be1d23cc32369d48c93a795a07d4fa037f14d5c", "patch": "@@ -1,3 +1,8 @@\n+2017-04-03  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* tree-nested.c (get_descriptor_type): Make sure that the alignment of\n+\tdescriptors is at least equal to that of functions.\n+\n 2017-04-02  Uros Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/sse.md (movdi_to_sse): Add missing DONE."}, {"sha": "48022cd4c11278029eab5bef77684f1cec48ccde", "filename": "gcc/tree-nested.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0be1d23cc32369d48c93a795a07d4fa037f14d5c/gcc%2Ftree-nested.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0be1d23cc32369d48c93a795a07d4fa037f14d5c/gcc%2Ftree-nested.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-nested.c?ref=0be1d23cc32369d48c93a795a07d4fa037f14d5c", "patch": "@@ -496,6 +496,8 @@ static GTY(()) tree descriptor_type;\n static tree\n get_descriptor_type (struct nesting_info *info)\n {\n+  /* The base alignment is that of a function.  */\n+  const unsigned align = FUNCTION_ALIGNMENT (FUNCTION_BOUNDARY);\n   tree t;\n \n   if (descriptor_type)\n@@ -505,6 +507,8 @@ get_descriptor_type (struct nesting_info *info)\n   t = build_array_type (ptr_type_node, t);\n   t = build_decl (DECL_SOURCE_LOCATION (info->context),\n \t\t  FIELD_DECL, get_identifier (\"__data\"), t);\n+  SET_DECL_ALIGN (t, MAX (TYPE_ALIGN (ptr_type_node), align));\n+  DECL_USER_ALIGN (t) = 1;\n \n   descriptor_type = make_node (RECORD_TYPE);\n   TYPE_NAME (descriptor_type) = get_identifier (\"__builtin_descriptor\");"}]}