{"sha": "06f9708454a5e644b1fb5ed17a863cd624985e17", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZmOTcwODQ1NGE1ZTY0NGIxZmI1ZWQxN2E4NjNjZDYyNDk4NWUxNw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2017-12-06T19:27:41Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-12-06T19:27:41Z"}, "message": "re PR tree-optimization/83293 (ICE: in gsi_insert_seq_nodes_after,  at gimple-iterator.c:278)\n\n\tPR tree-optimization/83293\n\t* gimple-ssa-strength-reduction.c (insert_initializers): Use\n\tGSI_NEW_STMT instead of GSI_SAME_STMT in gsi_insert_after that\n\tmight insert into empty bb.\n\n\t* g++.dg/torture/pr83293.C: New test.\n\nFrom-SVN: r255451", "tree": {"sha": "e387cb5a2e1f0fcea19d32c4f7ecb352b4dcb73d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e387cb5a2e1f0fcea19d32c4f7ecb352b4dcb73d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06f9708454a5e644b1fb5ed17a863cd624985e17", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06f9708454a5e644b1fb5ed17a863cd624985e17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06f9708454a5e644b1fb5ed17a863cd624985e17", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06f9708454a5e644b1fb5ed17a863cd624985e17/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "bf8ce85a42258d0fd7c7d20362af55c243045e45", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bf8ce85a42258d0fd7c7d20362af55c243045e45", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bf8ce85a42258d0fd7c7d20362af55c243045e45"}], "stats": {"total": 49, "additions": 48, "deletions": 1}, "files": [{"sha": "0310a5202d86f8693a64f6ced115f451213e4d4a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=06f9708454a5e644b1fb5ed17a863cd624985e17", "patch": "@@ -1,5 +1,10 @@\n 2017-12-06  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR tree-optimization/83293\n+\t* gimple-ssa-strength-reduction.c (insert_initializers): Use\n+\tGSI_NEW_STMT instead of GSI_SAME_STMT in gsi_insert_after that\n+\tmight insert into empty bb.\n+\n \tPR sanitizer/81281\n \t* match.pd ((T)(P + A) - (T)P -> (T) A): Split into separate\n \tsimplify for plus with :c added, and pointer_plus without that."}, {"sha": "b51239b94d02943e84fdc3a46272218a03f2229a", "filename": "gcc/gimple-ssa-strength-reduction.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2Fgimple-ssa-strength-reduction.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2Fgimple-ssa-strength-reduction.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-ssa-strength-reduction.c?ref=06f9708454a5e644b1fb5ed17a863cd624985e17", "patch": "@@ -3418,7 +3418,7 @@ insert_initializers (slsr_cand_t c)\n \t\t  gsi_insert_after (&gsi, cast_stmt, GSI_NEW_STMT);\n \t\t  gimple_set_location (cast_stmt, loc);\n \t\t}\n-\t      gsi_insert_after (&gsi, init_stmt, GSI_SAME_STMT);\n+\t      gsi_insert_after (&gsi, init_stmt, GSI_NEW_STMT);\n \t    }\n \n \t  gimple_set_location (init_stmt, gimple_location (basis_stmt));"}, {"sha": "67bdbbd5b331424f088229304cc728f5b9944a01", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=06f9708454a5e644b1fb5ed17a863cd624985e17", "patch": "@@ -1,5 +1,8 @@\n 2017-12-06  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR tree-optimization/83293\n+\t* g++.dg/torture/pr83293.C: New test.\n+\n \tPR sanitizer/81281\n \t* gcc.c-torture/execute/pr81281.c: New test.\n \t* gcc.dg/pr81281-1.c: New test."}, {"sha": "f4556f3ee5279a7e222b6f85391550f655aa5c35", "filename": "gcc/testsuite/g++.dg/torture/pr83293.C", "status": "added", "additions": 39, "deletions": 0, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr83293.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06f9708454a5e644b1fb5ed17a863cd624985e17/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr83293.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftorture%2Fpr83293.C?ref=06f9708454a5e644b1fb5ed17a863cd624985e17", "patch": "@@ -0,0 +1,39 @@\n+// PR tree-optimization/83293\n+\n+typedef __SIZE_TYPE__ size_t;\n+template <typename T, typename> struct A {\n+  T a;\n+  A (T x) : a(x) {}\n+  T foo () { return a; }\n+};\n+\n+template <typename T, typename U, typename V>\n+int\n+operator==(A<T, V> x, A<U, V> p2)\n+{\n+  return x.foo () == p2.foo ();\n+}\n+\n+struct B { struct { int *b, *c; } d; };\n+struct C : B {\n+  A<int *, int> bar () { return d.b; }\n+  A<int *, int> baz () { return d.c; }\n+  size_t boo () { return d.c - d.b; }\n+  int zoo () { return bar () == baz (); }\n+};\n+struct D { C e; } a;\n+size_t b;\n+\n+size_t\n+test (int x)\n+{\n+  size_t c (x * b);\n+  if (!a.e.zoo ())\n+    {\n+      x += 2;\n+      for (size_t d = 0, e = a.e.boo (); d < e; ++d)\n+\tc += test (0);\n+    }\n+  c += (x - 1) * b;\n+  return c;\n+}"}]}