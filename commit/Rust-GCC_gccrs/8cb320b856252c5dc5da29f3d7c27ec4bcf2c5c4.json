{"sha": "8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGNiMzIwYjg1NjI1MmM1ZGM1ZGEyOWYzZDdjMjdlYzRiY2YyYzVjNA==", "commit": {"author": {"name": "David Edelsohn", "email": "edelsohn@gnu.org", "date": "2005-02-14T20:21:10Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2005-02-14T20:21:10Z"}, "message": "re PR target/19019 (GCC ldouble format incompatibility with XLC long double)\n\n\tPR target/19019\n\t* config/rs6000/rs6000.md (trunctfdf2): Change to define_expand.\n\t(trunctfdf2_internal1): New.\n\t(trunctfdf2_internal2): Renamed from trunctfdf2.\n\nFrom-SVN: r95042", "tree": {"sha": "cc034047cdc8b87b8fa81229fd72e85b1a76a314", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cc034047cdc8b87b8fa81229fd72e85b1a76a314"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4/comments", "author": null, "committer": null, "parents": [{"sha": "adfec6a67bf360ba3698d732cce1a731692b578c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adfec6a67bf360ba3698d732cce1a731692b578c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/adfec6a67bf360ba3698d732cce1a731692b578c"}], "stats": {"total": 35, "additions": 32, "deletions": 3}, "files": [{"sha": "0ec0e849fa811bab27915a6218f3e952ba510859", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4", "patch": "@@ -1,3 +1,10 @@\n+2005-02-14  David Edelsohn  <edelsohn@gnu.org>\n+\n+\tPR target/19019\n+\t* config/rs6000/rs6000.md (truntfdf2): Change to define_expand.\n+\t(trunctfdf2_internal1): New.\n+\t(trunctfdf2_internal2): XLC-compatible fadd version.\n+\n 2005-02-14  Diego Novillo  <dnovillo@redhat.com>\n \n \tPR tree-optimization/19853"}, {"sha": "3fdb165dd41ceacb7ff6dfd30662db58a82f8ec2", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 25, "deletions": 3, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=8cb320b856252c5dc5da29f3d7c27ec4bcf2c5c4", "patch": "@@ -8325,14 +8325,36 @@\n   DONE;\n })\n \n-(define_insn \"trunctfdf2\"\n+(define_expand \"trunctfdf2\"\n   [(set (match_operand:DF 0 \"gpc_reg_operand\" \"=f\")\n \t(float_truncate:DF (match_operand:TF 1 \"gpc_reg_operand\" \"f\")))]\n   \"(DEFAULT_ABI == ABI_AIX || DEFAULT_ABI == ABI_DARWIN)\n    && TARGET_HARD_FLOAT && TARGET_FPRS && TARGET_LONG_DOUBLE_128\"\n+\"\")\n+\n+(define_insn_and_split \"trunctfdf2_internal1\"\n+  [(set (match_operand:DF 0 \"gpc_reg_operand\" \"=f,?f\")\n+\t(float_truncate:DF (match_operand:TF 1 \"gpc_reg_operand\" \"0,f\")))]\n+  \"(DEFAULT_ABI == ABI_AIX || DEFAULT_ABI == ABI_DARWIN) && !TARGET_XL_COMPAT\n+   && TARGET_HARD_FLOAT && TARGET_FPRS && TARGET_LONG_DOUBLE_128\"\n+  \"@\n+   #\n+   fmr %0,%1\"\n+  \"&& reload_completed && REGNO (operands[0]) == REGNO (operands[1])\"\n+  [(const_int 0)]\n+{\n+  emit_note (NOTE_INSN_DELETED);\n+  DONE;\n+}\n+  [(set_attr \"type\" \"fp\")])\n+\n+(define_insn \"trunctfdf2_internal2\"\n+  [(set (match_operand:DF 0 \"gpc_reg_operand\" \"=f\")\n+\t(float_truncate:DF (match_operand:TF 1 \"gpc_reg_operand\" \"f\")))]\n+  \"(DEFAULT_ABI == ABI_AIX || DEFAULT_ABI == ABI_DARWIN) && TARGET_XL_COMPAT\n+   && TARGET_HARD_FLOAT && TARGET_FPRS && TARGET_LONG_DOUBLE_128\"\n   \"fadd %0,%1,%L1\"\n-  [(set_attr \"type\" \"fp\")\n-   (set_attr \"length\" \"4\")])\n+  [(set_attr \"type\" \"fp\")])\n \n (define_insn_and_split \"trunctfsf2\"\n   [(set (match_operand:SF 0 \"gpc_reg_operand\" \"=f\")"}]}