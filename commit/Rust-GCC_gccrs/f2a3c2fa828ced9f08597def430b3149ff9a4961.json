{"sha": "f2a3c2fa828ced9f08597def430b3149ff9a4961", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjJhM2MyZmE4MjhjZWQ5ZjA4NTk3ZGVmNDMwYjMxNDlmZjlhNDk2MQ==", "commit": {"author": {"name": "Yannick Moy", "email": "moy@adacore.com", "date": "2018-05-30T08:58:17Z"}, "committer": {"name": "Pierre-Marie de Rodat", "email": "pmderodat@gcc.gnu.org", "date": "2018-05-30T08:58:17Z"}, "message": "[Ada] Correctly ignore Assertion_Policy in modes CodePeer and GNATprove\n\nIn the modes for static analysis with CodePeer or formal verification with\nGNATprove, the value of Assertion_Policy for a given policy is ignored if\nit's not Disable, as CodePeer/GNATprove are meant to check assertions even\nwhen not enabled at run time. This was not done consistently, which could\nlead to spurious errors on policy mismatch on ghost code inside assertions.\n\nThere is no impact on compilation.\n\n2018-05-30  Yannick Moy  <moy@adacore.com>\n\ngcc/ada/\n\n\t* sem_util.adb (Policy_In_Effect): Take into account CodePeer and\n\tGNATprove modes.\n\nFrom-SVN: r260943", "tree": {"sha": "dff76c55c12e1f6c6799455a702662f10746d54e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/dff76c55c12e1f6c6799455a702662f10746d54e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f2a3c2fa828ced9f08597def430b3149ff9a4961", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2a3c2fa828ced9f08597def430b3149ff9a4961", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f2a3c2fa828ced9f08597def430b3149ff9a4961", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f2a3c2fa828ced9f08597def430b3149ff9a4961/comments", "author": {"login": "yannickmoy", "id": 859440, "node_id": "MDQ6VXNlcjg1OTQ0MA==", "avatar_url": "https://avatars.githubusercontent.com/u/859440?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yannickmoy", "html_url": "https://github.com/yannickmoy", "followers_url": "https://api.github.com/users/yannickmoy/followers", "following_url": "https://api.github.com/users/yannickmoy/following{/other_user}", "gists_url": "https://api.github.com/users/yannickmoy/gists{/gist_id}", "starred_url": "https://api.github.com/users/yannickmoy/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yannickmoy/subscriptions", "organizations_url": "https://api.github.com/users/yannickmoy/orgs", "repos_url": "https://api.github.com/users/yannickmoy/repos", "events_url": "https://api.github.com/users/yannickmoy/events{/privacy}", "received_events_url": "https://api.github.com/users/yannickmoy/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "efa760f0ca2f45209525de0e9b6939351e1a0072", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/efa760f0ca2f45209525de0e9b6939351e1a0072", "html_url": "https://github.com/Rust-GCC/gccrs/commit/efa760f0ca2f45209525de0e9b6939351e1a0072"}], "stats": {"total": 15, "additions": 15, "deletions": 0}, "files": [{"sha": "258c4ac5cc375688955f116e356040beb12d9388", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2a3c2fa828ced9f08597def430b3149ff9a4961/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2a3c2fa828ced9f08597def430b3149ff9a4961/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=f2a3c2fa828ced9f08597def430b3149ff9a4961", "patch": "@@ -1,3 +1,8 @@\n+2018-05-30  Yannick Moy  <moy@adacore.com>\n+\n+\t* sem_util.adb (Policy_In_Effect): Take into account CodePeer and\n+\tGNATprove modes.\n+\n 2018-05-30  Justin Squirek  <squirek@adacore.com>\n \n \t* libgnat/a-direct.adb, libgnat/a-direct.ads (Name_Case_Equivalence):"}, {"sha": "b629dbe8ae3875046debdee048aedb54f23ca1c2", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f2a3c2fa828ced9f08597def430b3149ff9a4961/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f2a3c2fa828ced9f08597def430b3149ff9a4961/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=f2a3c2fa828ced9f08597def430b3149ff9a4961", "patch": "@@ -22487,6 +22487,16 @@ package body Sem_Util is\n          end if;\n       end if;\n \n+      --  In CodePeer mode and GNATprove mode, we need to consider all\n+      --  assertions, unless they are disabled. Force Name_Check on\n+      --  ignored assertions.\n+\n+      if Nam_In (Kind, Name_Ignore, Name_Off)\n+        and then (CodePeer_Mode or GNATprove_Mode)\n+      then\n+         Kind := Name_Check;\n+      end if;\n+\n       return Kind;\n    end Policy_In_Effect;\n "}]}