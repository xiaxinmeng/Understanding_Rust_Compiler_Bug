{"sha": "6aaf596b4072d0864dbe853626f5838bc58922f0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmFhZjU5NmI0MDcyZDA4NjRkYmU4NTM2MjZmNTgzOGJjNTg5MjJmMA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2013-02-18T13:03:15Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2013-02-18T13:03:15Z"}, "message": "re PR tree-optimization/56350 (ICE in vectorizable_reduction, at tree-vect-loop.c:4731)\n\n2013-02-18  Richard Biener  <rguenther@suse.de>\n\n\tPR middle-end/56350\n\t* cfghooks.c (merge_blocks): If we merge a latch into another\n\tblock adjust references to it.\n\t* cfgloop.c (flow_loops_find): Reset latch before recomputing it.\n\t(verify_loop_structure): Verify that a recorded latch is in fact\n\ta latch.\n\n\t* gcc.dg/torture/pr56350.c: New testcase.\n\nFrom-SVN: r196118", "tree": {"sha": "fa9d3fe97ade8428e04dda97cbfe0aa6c5a1329e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fa9d3fe97ade8428e04dda97cbfe0aa6c5a1329e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6aaf596b4072d0864dbe853626f5838bc58922f0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6aaf596b4072d0864dbe853626f5838bc58922f0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6aaf596b4072d0864dbe853626f5838bc58922f0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6aaf596b4072d0864dbe853626f5838bc58922f0/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5e97dfb679abcb5abf5381050d8f754b3289bce6", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e97dfb679abcb5abf5381050d8f754b3289bce6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e97dfb679abcb5abf5381050d8f754b3289bce6"}], "stats": {"total": 77, "additions": 76, "deletions": 1}, "files": [{"sha": "15a8fd18128dc7c794cc40e6b6119276b89ce8ed", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6aaf596b4072d0864dbe853626f5838bc58922f0", "patch": "@@ -1,3 +1,12 @@\n+2013-02-18  Richard Biener  <rguenther@suse.de>\n+\n+\tPR middle-end/56350\n+\t* cfghooks.c (merge_blocks): If we merge a latch into another\n+\tblock adjust references to it.\n+\t* cfgloop.c (flow_loops_find): Reset latch before recomputing it.\n+\t(verify_loop_structure): Verify that a recorded latch is in fact\n+\ta latch.\n+\n 2013-02-18  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/56321"}, {"sha": "5e3eeb587b54c9873b6c790deba5892fed3b6a18", "filename": "gcc/cfghooks.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Fcfghooks.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Fcfghooks.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfghooks.c?ref=6aaf596b4072d0864dbe853626f5838bc58922f0", "patch": "@@ -761,7 +761,12 @@ merge_blocks (basic_block a, basic_block b)\n     {\n       e->src = a;\n       if (current_loops != NULL)\n-\trescan_loop_exit (e, true, false);\n+\t{\n+\t  /* If b was a latch, a now is.  */\n+\t  if (e->dest->loop_father->latch == b)\n+\t    e->dest->loop_father->latch = a;\n+\t  rescan_loop_exit (e, true, false);\n+\t}\n     }\n   a->succs = b->succs;\n   a->flags |= b->flags;"}, {"sha": "751da5a2c177bb31051b4b83fd21774f0e31fd65", "filename": "gcc/cfgloop.c", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Fcfgloop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Fcfgloop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgloop.c?ref=6aaf596b4072d0864dbe853626f5838bc58922f0", "patch": "@@ -466,6 +466,8 @@ flow_loops_find (struct loops *loops)\n \t\t\t \"loop %d with header %d\\n\",\n \t\t\t loop->num, header->index);\n \t    }\n+\t  /* Reset latch, we recompute it below.  */\n+\t  loop->latch = NULL;\n \t  larray.safe_push (loop);\n \t}\n \n@@ -1413,6 +1415,19 @@ verify_loop_structure (void)\n \t  error (\"loop %d%'s header does not have exactly 2 entries\", i);\n \t  err = 1;\n \t}\n+      if (loop->latch)\n+\t{\n+\t  if (!find_edge (loop->latch, loop->header))\n+\t    {\n+\t      error (\"loop %d%'s latch does not have an edge to its header\", i);\n+\t      err = 1;\n+\t    }\n+\t  if (!dominated_by_p (CDI_DOMINATORS, loop->latch, loop->header))\n+\t    {\n+\t      error (\"loop %d%'s latch is not dominated by its header\", i);\n+\t      err = 1;\n+\t    }\n+\t}\n       if (loops_state_satisfies_p (LOOPS_HAVE_SIMPLE_LATCHES))\n \t{\n \t  if (!single_succ_p (loop->latch))"}, {"sha": "f4287ea68783ca5942ad55a82a94049b5005383f", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6aaf596b4072d0864dbe853626f5838bc58922f0", "patch": "@@ -1,3 +1,8 @@\n+2013-02-18  Richard Biener  <rguenther@suse.de>\n+\n+\tPR middle-end/56350\n+\t* gcc.dg/torture/pr56350.c: New testcase.\n+\n 2013-02-18  Richard Biener  <rguenther@suse.de>\n \n \tPR tree-optimization/56321"}, {"sha": "dc9ed082b8f6aea6dc118bb639a5c907f6023357", "filename": "gcc/testsuite/gcc.dg/torture/pr56350.c", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr56350.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6aaf596b4072d0864dbe853626f5838bc58922f0/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr56350.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr56350.c?ref=6aaf596b4072d0864dbe853626f5838bc58922f0", "patch": "@@ -0,0 +1,41 @@\n+/* { dg-do compile } */\n+\n+int a, b;\n+short c;\n+\n+void f(void)\n+{\n+  int a = 0;\n+  int *k = 0;\n+\n+  for(; a < 2; a++);\n+\n+  if(!!(b |= a < 3) - 1)\n+    {\n+      if(0)\n+\tfor (;; a++)\n+\t  {\n+\t    for (; c; *k = 0);\n+lbl1:\n+\t    ;\n+\t  }\n+\n+      for(; *k; k++)\n+\t{\n+\t  c = b ? : a;\n+\n+\t  if (c)\n+\t    lbl2:\n+\t\tb = 0;\n+\t}\n+      goto lbl1;\n+    }\n+\n+  for(;; b++)\n+    {\n+      if(b)\n+\tgoto lbl2;\n+\n+      k = &b;\n+    }\n+}"}]}