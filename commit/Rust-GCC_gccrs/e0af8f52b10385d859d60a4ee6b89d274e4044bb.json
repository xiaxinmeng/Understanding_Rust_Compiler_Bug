{"sha": "e0af8f52b10385d859d60a4ee6b89d274e4044bb", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTBhZjhmNTJiMTAzODVkODU5ZDYwYTRlZTZiODlkMjc0ZTQwNDRiYg==", "commit": {"author": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-08-06T21:32:09Z"}, "committer": {"name": "Steven G. Kargl", "email": "kargl@gcc.gnu.org", "date": "2019-08-06T21:32:09Z"}, "message": "re PR fortran/91359 (logical function X returns .TRUE. - Warning:  spaghetti code)\n\n2019-08-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/91359\n\t* trans-decl.c (gfc_generate_return): Ensure something is returned\n\tfrom a function.\n\n2019-08-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/91359\n\t* gfortran.dg/pr91359_1.f: New test.\n\t* gfortran.dg/pr91359_2.f: Ditto.\n\nFrom-SVN: r274149", "tree": {"sha": "738a20ebf9f668b479b13bf5bb6d736c7435316c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/738a20ebf9f668b479b13bf5bb6d736c7435316c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e0af8f52b10385d859d60a4ee6b89d274e4044bb", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0af8f52b10385d859d60a4ee6b89d274e4044bb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e0af8f52b10385d859d60a4ee6b89d274e4044bb", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e0af8f52b10385d859d60a4ee6b89d274e4044bb/comments", "author": null, "committer": null, "parents": [{"sha": "1a3920654f92b83a206d62f4eddcf1f5c28a91de", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a3920654f92b83a206d62f4eddcf1f5c28a91de", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a3920654f92b83a206d62f4eddcf1f5c28a91de"}], "stats": {"total": 58, "additions": 58, "deletions": 0}, "files": [{"sha": "1a2129d0a25e2d499197412812c0aefb1bafa2ba", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=e0af8f52b10385d859d60a4ee6b89d274e4044bb", "patch": "@@ -1,3 +1,9 @@\n+2019-08-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/91359\n+\t* trans-decl.c (gfc_generate_return): Ensure something is returned\n+\tfrom a function.\n+\n 2019-08-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/42546"}, {"sha": "86c3d3a97964485f9a06a2ed65f0df3448bcbb23", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=e0af8f52b10385d859d60a4ee6b89d274e4044bb", "patch": "@@ -6449,6 +6449,20 @@ gfc_generate_return (void)\n \t\t\t\t    TREE_TYPE (result), DECL_RESULT (fndecl),\n \t\t\t\t    result);\n \t}\n+      else\n+\t{\n+\t  /* If the function does not have a result variable, result is\n+\t     NULL_TREE, and a 'return' is generated without a variable.\n+\t     The following generates a 'return __result_XXX' where XXX is\n+\t     the function name.  */\n+\t  if (sym == sym->result && sym->attr.function)\n+\t    {\n+\t      result = gfc_get_fake_result_decl (sym, 0);\n+\t      result = fold_build2_loc (input_location, MODIFY_EXPR,\n+\t\t\t\t\tTREE_TYPE (result),\n+\t\t\t\t\tDECL_RESULT (fndecl), result);\n+\t    }\n+\t}\n     }\n \n   return build1_v (RETURN_EXPR, result);"}, {"sha": "cb8040c00fd1547c832e8fe8916c4652dcfdeb6e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e0af8f52b10385d859d60a4ee6b89d274e4044bb", "patch": "@@ -1,3 +1,9 @@\n+2019-08-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/91359\n+\t* gfortran.dg/pr91359_1.f: New test.\n+\t* gfortran.dg/pr91359_2.f: Ditto.\n+\n 2019-08-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n \n \tPR fortran/42546"}, {"sha": "2b8a35a9c60c62ba9bbf4385fbede72c71da88b7", "filename": "gcc/testsuite/gfortran.dg/pr91359_1.f", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91359_1.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91359_1.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91359_1.f?ref=e0af8f52b10385d859d60a4ee6b89d274e4044bb", "patch": "@@ -0,0 +1,16 @@\n+! { dg do run }\n+! PR fortran/91359\n+! Orginal code contributed by Brian T. Carcich <briantcarcich at gmail dot com>\n+!\n+      logical function zero() result(a)\n+         goto 2\n+1        return\n+2        a = .false.\n+         if (.not.a) goto 1\n+         return\n+      end\n+\n+      program test_zero\n+         logical zero\n+         if (zero()) stop 1\n+      end"}, {"sha": "2b8a35a9c60c62ba9bbf4385fbede72c71da88b7", "filename": "gcc/testsuite/gfortran.dg/pr91359_2.f", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91359_2.f", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e0af8f52b10385d859d60a4ee6b89d274e4044bb/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91359_2.f", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr91359_2.f?ref=e0af8f52b10385d859d60a4ee6b89d274e4044bb", "patch": "@@ -0,0 +1,16 @@\n+! { dg do run }\n+! PR fortran/91359\n+! Orginal code contributed by Brian T. Carcich <briantcarcich at gmail dot com>\n+!\n+      logical function zero() result(a)\n+         goto 2\n+1        return\n+2        a = .false.\n+         if (.not.a) goto 1\n+         return\n+      end\n+\n+      program test_zero\n+         logical zero\n+         if (zero()) stop 1\n+      end"}]}