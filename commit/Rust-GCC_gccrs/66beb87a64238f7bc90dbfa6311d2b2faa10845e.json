{"sha": "66beb87a64238f7bc90dbfa6311d2b2faa10845e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjZiZWI4N2E2NDIzOGY3YmM5MGRiZmE2MzExZDJiMmZhYTEwODQ1ZQ==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2005-04-08T07:57:27Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2005-04-08T07:57:27Z"}, "message": "* config/xtensa/xtensa.h (target_flags, MASK_NO_FUSED_MADD)\n\t(MASK_CONST16, TARGET_NO_FUSED_MADD, TARGET_CONST16)\n\t(TARGET_SWITCHES): Delete.\n\t* config/xtensa/xtensa.c (TARGET_DEFAULT_TARGET_FLAGS): Define.\n\t* config/xtensa/xtensa.md (muladdsf3, mulsubsf3): Check\n\tTARGET_FUSED_MADD instead of !TARGET_NO_FUSED_MADD.\n\t* config/xtensa/xtensa.opt: New file.\n\nFrom-SVN: r97822", "tree": {"sha": "33bc7d49485f3cb3420206eb6fcf9d0b0988533a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/33bc7d49485f3cb3420206eb6fcf9d0b0988533a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66beb87a64238f7bc90dbfa6311d2b2faa10845e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66beb87a64238f7bc90dbfa6311d2b2faa10845e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66beb87a64238f7bc90dbfa6311d2b2faa10845e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66beb87a64238f7bc90dbfa6311d2b2faa10845e/comments", "author": null, "committer": null, "parents": [{"sha": "1a269cbb5707c83eb0890224d18215e49f12ed3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a269cbb5707c83eb0890224d18215e49f12ed3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a269cbb5707c83eb0890224d18215e49f12ed3b"}], "stats": {"total": 92, "additions": 55, "deletions": 37}, "files": [{"sha": "8308b7b0f09087eafbcf452ec025be046800e775", "filename": "gcc/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=66beb87a64238f7bc90dbfa6311d2b2faa10845e", "patch": "@@ -1,3 +1,13 @@\n+2005-04-08  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config/xtensa/xtensa.h (target_flags, MASK_NO_FUSED_MADD)\n+\t(MASK_CONST16, TARGET_NO_FUSED_MADD, TARGET_CONST16)\n+\t(TARGET_SWITCHES): Delete.\n+\t* config/xtensa/xtensa.c (TARGET_DEFAULT_TARGET_FLAGS): Define.\n+\t* config/xtensa/xtensa.md (muladdsf3, mulsubsf3): Check\n+\tTARGET_FUSED_MADD instead of !TARGET_NO_FUSED_MADD.\n+\t* config/xtensa/xtensa.opt: New file.\n+\n 2005-04-08  Ben Elliston  <bje@au.ibm.com>\n \n \t* config/fp-bit.c: Include L_mul_tf in #endif comment."}, {"sha": "7d0ba485f656621d846afa06ce79f75f7cdc7ae0", "filename": "gcc/config/xtensa/xtensa.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.c?ref=66beb87a64238f7bc90dbfa6311d2b2faa10845e", "patch": "@@ -232,6 +232,9 @@ static const int reg_nonleaf_alloc_order[FIRST_PSEUDO_REGISTER] =\n #undef TARGET_ASM_SELECT_RTX_SECTION\n #define TARGET_ASM_SELECT_RTX_SECTION  xtensa_select_rtx_section\n \n+#undef TARGET_DEFAULT_TARGET_FLAGS\n+#define TARGET_DEFAULT_TARGET_FLAGS (TARGET_DEFAULT | MASK_FUSED_MADD)\n+\n #undef TARGET_RTX_COSTS\n #define TARGET_RTX_COSTS xtensa_rtx_costs\n #undef TARGET_ADDRESS_COST"}, {"sha": "fc5351a92ec006de918b74f4f101d555b8399fec", "filename": "gcc/config/xtensa/xtensa.h", "status": "modified", "additions": 0, "deletions": 35, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.h?ref=66beb87a64238f7bc90dbfa6311d2b2faa10845e", "patch": "@@ -24,7 +24,6 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n \n /* Standard GCC variables that we reference.  */\n extern int current_function_calls_alloca;\n-extern int target_flags;\n extern int optimize;\n \n /* External variables defined in xtensa.c.  */\n@@ -42,10 +41,6 @@ extern struct rtx_def * branch_cmp[2];\t/* operands for compare */\n extern enum cmp_type branch_type;\t/* what type of branch to use */\n extern unsigned xtensa_current_frame_size;\n \n-/* Masks for the -m switches */\n-#define MASK_NO_FUSED_MADD\t0x00000001\t/* avoid f-p mul/add */\n-#define MASK_CONST16\t\t0x00000002\t/* use CONST16 instruction */\n-\n /* Macros used in the machine description to select various Xtensa\n    configuration options.  */\n #define TARGET_BIG_ENDIAN\tXCHAL_HAVE_BE\n@@ -66,39 +61,9 @@ extern unsigned xtensa_current_frame_size;\n #define TARGET_ABS\t\tXCHAL_HAVE_ABS\n #define TARGET_ADDX\t\tXCHAL_HAVE_ADDX\n \n-/* Macros controlled by command-line options.  */\n-#define TARGET_NO_FUSED_MADD\t(target_flags & MASK_NO_FUSED_MADD)\n-#define TARGET_CONST16\t\t(target_flags & MASK_CONST16)\n-\n #define TARGET_DEFAULT (\t\t\t\t\t\t\\\n   (XCHAL_HAVE_L32R\t? 0 : MASK_CONST16))\n \n-#define TARGET_SWITCHES\t\t\t\t\t\t\t\\\n-{\t\t\t\t\t\t\t\t\t\\\n-  {\"const16\",\t\t\tMASK_CONST16,\t\t\t\t\\\n-    N_(\"Use CONST16 instruction to load constants\")},\t\t\t\\\n-  {\"no-const16\",\t\t-MASK_CONST16,\t\t\t\t\\\n-    N_(\"Use PC-relative L32R instruction to load constants\")},\t\t\\\n-  {\"no-fused-madd\",\t\tMASK_NO_FUSED_MADD,\t\t\t\\\n-    N_(\"Disable fused multiply/add and multiply/subtract FP instructions\")}, \\\n-  {\"fused-madd\",\t\t-MASK_NO_FUSED_MADD,\t\t\t\\\n-    N_(\"Enable fused multiply/add and multiply/subtract FP instructions\")}, \\\n-  {\"text-section-literals\",\t0,\t\t\t\t\t\\\n-    N_(\"Intersperse literal pools with code in the text section\")},\t\\\n-  {\"no-text-section-literals\",\t0,\t\t\t\t\t\\\n-    N_(\"Put literal pools in a separate literal section\")},\t\t\\\n-  {\"target-align\",\t\t0,\t\t\t\t\t\\\n-    N_(\"Automatically align branch targets to reduce branch penalties\")}, \\\n-  {\"no-target-align\",\t\t0,\t\t\t\t\t\\\n-    N_(\"Do not automatically align branch targets\")},\t\t\t\\\n-  {\"longcalls\",\t\t\t0,\t\t\t\t\t\\\n-    N_(\"Use indirect CALLXn instructions for large programs\")},\t\t\\\n-  {\"no-longcalls\",\t\t0,\t\t\t\t\t\\\n-    N_(\"Use direct CALLn instructions for fast calls\")},\t\t\\\n-  {\"\",\t\t\t\tTARGET_DEFAULT, 0}\t\t\t\\\n-}\n-\n-\n #define OVERRIDE_OPTIONS override_options ()\n \f\n /* Target CPU builtins.  */"}, {"sha": "c40ad345def7e92c4ef047a662a57cbe8c3e4ac8", "filename": "gcc/config/xtensa/xtensa.md", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.md?ref=66beb87a64238f7bc90dbfa6311d2b2faa10845e", "patch": "@@ -371,7 +371,7 @@\n \t(plus:SF (mult:SF (match_operand:SF 1 \"register_operand\" \"%f\")\n \t\t\t  (match_operand:SF 2 \"register_operand\" \"f\"))\n \t\t (match_operand:SF 3 \"register_operand\" \"0\")))]\n-  \"TARGET_HARD_FLOAT && !TARGET_NO_FUSED_MADD\"\n+  \"TARGET_HARD_FLOAT && TARGET_FUSED_MADD\"\n   \"madd.s\\t%0, %1, %2\"\n   [(set_attr \"type\"\t\"fmadd\")\n    (set_attr \"mode\"\t\"SF\")\n@@ -382,7 +382,7 @@\n \t(minus:SF (match_operand:SF 1 \"register_operand\" \"0\")\n \t\t  (mult:SF (match_operand:SF 2 \"register_operand\" \"%f\")\n \t\t\t   (match_operand:SF 3 \"register_operand\" \"f\"))))]\n-  \"TARGET_HARD_FLOAT && !TARGET_NO_FUSED_MADD\"\n+  \"TARGET_HARD_FLOAT && TARGET_FUSED_MADD\"\n   \"msub.s\\t%0, %2, %3\"\n   [(set_attr \"type\"\t\"fmadd\")\n    (set_attr \"mode\"\t\"SF\")"}, {"sha": "6be1b3862bead17a06b290ad04ce42dd3e8e4ddb", "filename": "gcc/config/xtensa/xtensa.opt", "status": "added", "additions": 40, "deletions": 0, "changes": 40, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66beb87a64238f7bc90dbfa6311d2b2faa10845e/gcc%2Fconfig%2Fxtensa%2Fxtensa.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.opt?ref=66beb87a64238f7bc90dbfa6311d2b2faa10845e", "patch": "@@ -0,0 +1,40 @@\n+; Options for the Tensilica Xtensa port of the compiler.\n+\n+; Copyright (C) 2005 Free Software Foundation, Inc.\n+;\n+; This file is part of GCC.\n+;\n+; GCC is free software; you can redistribute it and/or modify it under\n+; the terms of the GNU General Public License as published by the Free\n+; Software Foundation; either version 2, or (at your option) any later\n+; version.\n+;\n+; GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+; WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+; FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+; for more details.\n+;\n+; You should have received a copy of the GNU General Public License\n+; along with GCC; see the file COPYING.  If not, write to the Free\n+; Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n+; 02111-1307, USA.\n+\n+mconst16\n+Target Report Mask(CONST16)\n+Use CONST16 instruction to load constants\n+\n+mfused-madd\n+Target Report Mask(FUSED_MADD)\n+Enable fused multiply/add and multiply/subtract FP instructions\n+\n+mlongcalls\n+Target\n+Use indirect CALLXn instructions for large programs\n+\n+mtarget-align\n+Target\n+Automatically align branch targets to reduce branch penalties\n+\n+mtext-section-literals\n+Target\n+Intersperse literal pools with code in the text section"}]}