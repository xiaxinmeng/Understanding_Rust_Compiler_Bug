{"sha": "3364872d40a49c4c42e29cf7874bd44c8d5583c6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzM2NDg3MmQ0MGE0OWM0YzQyZTI5Y2Y3ODc0YmQ0NGM4ZDU1ODNjNg==", "commit": {"author": {"name": "Fariborz Jahanian", "email": "fjahanian@apple.com", "date": "2003-12-26T22:07:07Z"}, "committer": {"name": "David Edelsohn", "email": "dje@gcc.gnu.org", "date": "2003-12-26T22:07:07Z"}, "message": "rs6000.c (legitimate_offset_address_p): Do not restrict DFmode and TFmode to word alignment.\n\n2003-12-26  Fariborz Jahanian <fjahanian@apple.com>\n            Geoffrey Keating <geoffk@apple.com>\n            David Edelsohn <edelsohn@gnu.org>\n\n        * config/rs6000/rs6000.c (legitimate_offset_address_p): Do not\n        restrict DFmode and TFmode to word alignment.\n        * config/rs6000/rs6000.md (movdf_hardfloat64): Use 'o' constraint\n        for ld/std and order before mr.\n\nCo-Authored-By: David Edelsohn <edelsohn@gnu.org>\nCo-Authored-By: Geoffrey Keating <geoffk@apple.com>\n\nFrom-SVN: r75040", "tree": {"sha": "49e2b764e22f3651b1d91e48bdd105e634dd7409", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/49e2b764e22f3651b1d91e48bdd105e634dd7409"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3364872d40a49c4c42e29cf7874bd44c8d5583c6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3364872d40a49c4c42e29cf7874bd44c8d5583c6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3364872d40a49c4c42e29cf7874bd44c8d5583c6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3364872d40a49c4c42e29cf7874bd44c8d5583c6/comments", "author": null, "committer": null, "parents": [{"sha": "88f2e10376c55f480fd0dbd222b8c1725571c6df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88f2e10376c55f480fd0dbd222b8c1725571c6df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88f2e10376c55f480fd0dbd222b8c1725571c6df"}], "stats": {"total": 23, "additions": 17, "deletions": 6}, "files": [{"sha": "ba7e756cfcc6b8f1e6314f06b0281e9cde565e2e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3364872d40a49c4c42e29cf7874bd44c8d5583c6/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3364872d40a49c4c42e29cf7874bd44c8d5583c6/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=3364872d40a49c4c42e29cf7874bd44c8d5583c6", "patch": "@@ -1,3 +1,12 @@\n+2003-12-26  Fariborz Jahanian <fjahanian@apple.com>\n+\t    Geoffrey Keating <geoffk@apple.com>\n+\t    David Edelsohn <edelsohn@gnu.org>\n+\n+\t* config/rs6000/rs6000.c (legitimate_offset_address_p): Do not\n+\trestrict DFmode and TFmode to word alignment.\n+\t* config/rs6000/rs6000.md (movdf_hardfloat64): Use 'o' constraint\n+\tfor ld/std and order before mr.\n+\n 2003-12-26  Andrew Pinski  <pinskia@physics.uc.edu>\n \n \t* config/darwin.h (LINK_COMMAND_SPEC): Arrange"}, {"sha": "4dc83c103c27683bd7466fcf4cafa31074388462", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3364872d40a49c4c42e29cf7874bd44c8d5583c6/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3364872d40a49c4c42e29cf7874bd44c8d5583c6/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=3364872d40a49c4c42e29cf7874bd44c8d5583c6", "patch": "@@ -2448,15 +2448,15 @@ legitimate_offset_address_p (enum machine_mode mode, rtx x, int strict)\n \n     case DFmode:\n     case DImode:\n-      if (!TARGET_POWERPC64)\n+      if (mode == DFmode || !TARGET_POWERPC64)\n \textra = 4;\n       else if (offset & 3)\n \treturn false;\n       break;\n \n     case TFmode:\n     case TImode:\n-      if (!TARGET_POWERPC64)\n+      if (mode == TFmode || !TARGET_POWERPC64)\n \textra = 12;\n       else if (offset & 3)\n \treturn false;"}, {"sha": "3ab0465a316aa520c22da0156d708c8636410cb4", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3364872d40a49c4c42e29cf7874bd44c8d5583c6/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3364872d40a49c4c42e29cf7874bd44c8d5583c6/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=3364872d40a49c4c42e29cf7874bd44c8d5583c6", "patch": "@@ -8159,16 +8159,18 @@\n   [(set_attr \"type\" \"*,load,store,*,*,*\")\n    (set_attr \"length\" \"8,8,8,8,12,16\")])\n \n+; ld/std require word-aligned displacements, so use offsettable constraint.\n+; List o->r and r->o before r->r for reload.\n (define_insn \"*movdf_hardfloat64\"\n-  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=!r,??r,m,f,f,m,!cl,!r,!r,!r,!r\")\n-\t(match_operand:DF 1 \"input_operand\" \"r,m,r,f,m,f,r,h,G,H,F\"))]\n+  [(set (match_operand:DF 0 \"nonimmediate_operand\" \"=o,??r,!r,f,f,m,!cl,!r,!r,!r,!r\")\n+\t(match_operand:DF 1 \"input_operand\" \"r,o,r,f,m,f,r,h,G,H,F\"))]\n   \"TARGET_POWERPC64 && TARGET_HARD_FLOAT && TARGET_FPRS\n    && (gpc_reg_operand (operands[0], DFmode)\n        || gpc_reg_operand (operands[1], DFmode))\"\n   \"@\n-   mr %0,%1\n-   ld%U1%X1 %0,%1\n    std%U0%X0 %1,%0\n+   ld%U1%X1 %0,%1\n+   mr %0,%1\n    fmr %0,%1\n    lfd%U1%X1 %0,%1\n    stfd%U0%X0 %1,%0"}]}