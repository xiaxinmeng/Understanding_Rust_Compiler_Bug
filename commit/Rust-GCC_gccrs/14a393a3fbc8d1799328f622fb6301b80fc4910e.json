{"sha": "14a393a3fbc8d1799328f622fb6301b80fc4910e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTRhMzkzYTNmYmM4ZDE3OTkzMjhmNjIyZmI2MzAxYjgwZmM0OTEwZQ==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2011-07-01T08:59:20Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2011-07-01T08:59:20Z"}, "message": "re PR libmudflap/49549 (Use of --noinhibit-exec is unportable)\n\n\tlibmudflap:\n\tPR libmudflap/49549\n\t* testsuite/lib/libmudflap.exp (load_gcc_lib): Load\n\ttarget-supports.exp.\n\t* testsuite/libmudflap.cth/cthfrags.exp: Only pass\n\t--noinhibit-exec to GNU ld.\n\n\tgcc:\n\tPR libmudflap/49549\n\t* doc/sourcebuild.texi (Effective-Target Keywords): Document gld.\n\n\tgcc/testsuite:\n\tPR libmudflap/49549\n\t* lib/target-supports.exp (check_effective_target_gld): New proc.\n\nFrom-SVN: r175749", "tree": {"sha": "d14cd0802efbabe2056a4896a173c27875c54289", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d14cd0802efbabe2056a4896a173c27875c54289"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/14a393a3fbc8d1799328f622fb6301b80fc4910e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14a393a3fbc8d1799328f622fb6301b80fc4910e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14a393a3fbc8d1799328f622fb6301b80fc4910e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14a393a3fbc8d1799328f622fb6301b80fc4910e/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3aecd443dadce5ef2c94551bb0fd9a54f6ba5684", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3aecd443dadce5ef2c94551bb0fd9a54f6ba5684", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3aecd443dadce5ef2c94551bb0fd9a54f6ba5684"}], "stats": {"total": 57, "additions": 52, "deletions": 5}, "files": [{"sha": "21d2c1e6467927d593a884fd8f684caf6c810efd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=14a393a3fbc8d1799328f622fb6301b80fc4910e", "patch": "@@ -1,3 +1,8 @@\n+2011-07-01  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\tPR libmudflap/49549\n+\t* doc/sourcebuild.texi (Effective-Target Keywords): Document gld.\n+\n 2011-07-01  Jakub Jelinek  <jakub@redhat.com>\n \n \t* tree-pretty-print.c (dump_generic_code) <case CONSTRUCTOR>: Print"}, {"sha": "3d41c0d029ea9f8edb07a4ce384529d7241e62a2", "filename": "gcc/doc/sourcebuild.texi", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2Fdoc%2Fsourcebuild.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2Fdoc%2Fsourcebuild.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Fsourcebuild.texi?ref=14a393a3fbc8d1799328f622fb6301b80fc4910e", "patch": "@@ -1760,6 +1760,9 @@ Target uses GNU @command{as}.\n @item gc_sections\n Target supports @option{--gc-sections}.\n \n+@item gld\n+Target uses GNU @command{ld}.\n+\n @item keeps_null_pointer_checks\n Target keeps null pointer checks, either due to the use of\n @option{-fno-delete-null-pointer-checks} or hardwired into the target."}, {"sha": "9b7219790fc3a40019ed7508045b0f8a3f8509d8", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=14a393a3fbc8d1799328f622fb6301b80fc4910e", "patch": "@@ -1,3 +1,8 @@\n+2011-07-01  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\tPR libmudflap/49549\n+\t* lib/target-supports.exp (check_effective_target_gld): New proc.\n+\n 2011-07-01  Richard Guenther  <rguenther@suse.de>\n \n \tPR tree-optimization/49603"}, {"sha": "4e56e48412fab52cfb436437856cd4b078d7e327", "filename": "gcc/testsuite/lib/target-supports.exp", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14a393a3fbc8d1799328f622fb6301b80fc4910e/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Flib%2Ftarget-supports.exp?ref=14a393a3fbc8d1799328f622fb6301b80fc4910e", "patch": "@@ -3843,6 +3843,26 @@ proc check_effective_target_gas { } {\n     return $use_gas_saved\n }\n \n+# Return 1 if GNU ld is used.\n+\n+proc check_effective_target_gld { } {\n+    global use_gld_saved\n+    global tool\n+\n+    if {![info exists use_gld_saved]} {\n+\t# Check if the ld used by gcc is GNU ld.\n+\tset gcc_ld [lindex [${tool}_target_compile \"-print-prog-name=ld\" \"\" \"none\" \"\"] 0]\n+\tset status [remote_exec host \"$gcc_ld\" \"--version\"]\n+\tset ld_output [lindex $status 1]\n+\tif { [ string first \"GNU\" $ld_output ] >= 0 } {\n+\t    set use_gld_saved 1\n+\t} else {\n+\t    set use_gld_saved 0\n+\t}\n+    }\n+    return $use_gld_saved\n+}\n+\n # Return 1 if the compiler has been configure with link-time optimization\n # (LTO) support.\n "}, {"sha": "177c01865d3817a91a4e88ca7d49936b08271169", "filename": "libmudflap/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14a393a3fbc8d1799328f622fb6301b80fc4910e/libmudflap%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14a393a3fbc8d1799328f622fb6301b80fc4910e/libmudflap%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2FChangeLog?ref=14a393a3fbc8d1799328f622fb6301b80fc4910e", "patch": "@@ -1,3 +1,11 @@\n+2011-07-01  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\tPR libmudflap/49549\n+\t* testsuite/lib/libmudflap.exp (load_gcc_lib): Load\n+\ttarget-supports.exp.\n+\t* testsuite/libmudflap.cth/cthfrags.exp: Only pass\n+\t--noinhibit-exec to GNU ld.\n+\n 2011-06-27  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n \n \tPR libmudflap/38738"}, {"sha": "bd9327d140831e527a1b3570ad48dfe02bac515c", "filename": "libmudflap/testsuite/lib/libmudflap.exp", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14a393a3fbc8d1799328f622fb6301b80fc4910e/libmudflap%2Ftestsuite%2Flib%2Flibmudflap.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14a393a3fbc8d1799328f622fb6301b80fc4910e/libmudflap%2Ftestsuite%2Flib%2Flibmudflap.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flib%2Flibmudflap.exp?ref=14a393a3fbc8d1799328f622fb6301b80fc4910e", "patch": "@@ -1,4 +1,4 @@\n-# Copyright (C) 2001, 2002, 2003, 2004, 2009, 2010\n+# Copyright (C) 2001, 2002, 2003, 2004, 2009, 2010, 2011\n # Free Software Foundation, Inc.\n \n # This program is free software; you can redistribute it and/or modify\n@@ -30,6 +30,7 @@ proc load_gcc_lib { filename } {\n load_lib mfdg.exp\n load_lib libgloss.exp\n load_gcc_lib target-libpath.exp\n+load_gcc_lib target-supports.exp\n load_gcc_lib timeout.exp\n load_gcc_lib timeout-dg.exp\n "}, {"sha": "a025b03805f6a2d4cfbbf7888f48418abcc0e4b3", "filename": "libmudflap/testsuite/libmudflap.cth/cthfrags.exp", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/14a393a3fbc8d1799328f622fb6301b80fc4910e/libmudflap%2Ftestsuite%2Flibmudflap.cth%2Fcthfrags.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/14a393a3fbc8d1799328f622fb6301b80fc4910e/libmudflap%2Ftestsuite%2Flibmudflap.cth%2Fcthfrags.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libmudflap%2Ftestsuite%2Flibmudflap.cth%2Fcthfrags.exp?ref=14a393a3fbc8d1799328f622fb6301b80fc4910e", "patch": "@@ -11,10 +11,15 @@ foreach flags $MUDFLAP_FLAGS {\n \tset bsrc [file tail $srcfile]\n \tsetenv MUDFLAP_OPTIONS \"-viol-segv\"\n \tif {$libmudflapth} then {\n-\t    # --noinhibit-exec works around a ld problem that causes\n-\t    # \"Dwarf Error: Invalid or unhandled FORM value: 14\"\n-\t    # to fail builds unnecessarily.\n-\t    dg-runtest $srcfile $flags \"-fmudflapth -lmudflapth -lpthread -Wl,--noinhibit-exec\"\n+\t    if [check_effective_target_gld] {\n+\t\t# --noinhibit-exec works around a ld problem that causes\n+\t\t# \"Dwarf Error: Invalid or unhandled FORM value: 14\"\n+\t\t# to fail builds unnecessarily.\n+\t\tset noie_option \" -Wl,--noinhibit-exec\"\n+\t    } else {\n+\t\tset noie_option \"\"\n+\t    }\n+\t    dg-runtest $srcfile $flags \"-fmudflapth -lmudflapth -lpthread $noie_option\"\n \t} else {\n \t    if {$flags != \"\"} {set f \" ($flags)\"} {set f \"\"}\n             untested \"libmudflap.cth/$bsrc$f\""}]}