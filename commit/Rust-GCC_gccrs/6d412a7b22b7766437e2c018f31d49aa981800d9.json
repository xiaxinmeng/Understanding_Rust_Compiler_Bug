{"sha": "6d412a7b22b7766437e2c018f31d49aa981800d9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmQ0MTJhN2IyMmI3NzY2NDM3ZTJjMDE4ZjMxZDQ5YWE5ODE4MDBkOQ==", "commit": {"author": {"name": "Vincent Celier", "email": "celier@gnat.com", "date": "2003-04-22T21:52:04Z"}, "committer": {"name": "Richard Kenner", "email": "kenner@gcc.gnu.org", "date": "2003-04-22T21:52:04Z"}, "message": "gthr-gnat.h, [...]: new sources for implementation of --enable-threads=gnat.\n\n        * gthr-gnat.h, gthr-gnat.c: new sources for implementation of\n        --enable-threads=gnat.\n        * Makefile.in: Add gthr-gnat.c to LIB2ADDEH.\n        * configure.in: Add gnat to the list of thread packages\n        * configure: Rebuild.\n        * config/t-linux: Add gthr-gnat.c to LIB2ADDEH and LIB2ADDEHDEP\n\nFrom-SVN: r65961", "tree": {"sha": "8b5a468fc229af925afa0fbf43568984ef8424b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8b5a468fc229af925afa0fbf43568984ef8424b8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6d412a7b22b7766437e2c018f31d49aa981800d9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d412a7b22b7766437e2c018f31d49aa981800d9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6d412a7b22b7766437e2c018f31d49aa981800d9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6d412a7b22b7766437e2c018f31d49aa981800d9/comments", "author": null, "committer": null, "parents": [{"sha": "9734801a49c9924623d70acc5de286ddc75b1b83", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9734801a49c9924623d70acc5de286ddc75b1b83", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9734801a49c9924623d70acc5de286ddc75b1b83"}], "stats": {"total": 148, "additions": 142, "deletions": 6}, "files": [{"sha": "28cbfda34ba296be5cc1577d7629fbb51e706c97", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6d412a7b22b7766437e2c018f31d49aa981800d9", "patch": "@@ -1,3 +1,12 @@\n+2003-04-22  Vincent Celier <celier@gnat.com>\n+\n+        * gthr-gnat.h, gthr-gnat.c: new sources for implementation of\n+        --enable-threads=gnat.\n+        * Makefile.in: Add gthr-gnat.c to LIB2ADDEH.\n+        * configure.in: Add gnat to the list of thread packages\n+        * configure: Rebuild.\n+        * config/t-linux: Add gthr-gnat.c to LIB2ADDEH and LIB2ADDEHDEP\n+\n 2003-04-22  Neil Booth  <neil@daikokuya.co.uk>\n \n \t* cpplex.c (_cpp_get_fresh_line): Pop the buffer if return_at_eof."}, {"sha": "b8a6bb0b1cd1aaee20b0d1313b001dc265df2994", "filename": "gcc/Makefile.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FMakefile.in?ref=6d412a7b22b7766437e2c018f31d49aa981800d9", "patch": "@@ -471,7 +471,7 @@ CRTSTUFF_CFLAGS = -O2 $(GCC_CFLAGS) $(INCLUDES) $(MULTILIB_CFLAGS) -g0 \\\n \n # Additional sources to handle exceptions; overridden by targets as needed.\n LIB2ADDEH = $(srcdir)/unwind-dw2.c $(srcdir)/unwind-dw2-fde.c \\\n-  $(srcdir)/unwind-sjlj.c\n+   $(srcdir)/unwind-sjlj.c $(srcdir)/gthr-gnat.c\n LIB2ADDEHDEP = unwind.inc unwind-dw2-fde.h\n \n # nm flags to list global symbols in libgcc object files."}, {"sha": "b971c46ea212d02f8e0357d430655c6a603dbcd2", "filename": "gcc/config/t-linux", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fconfig%2Ft-linux", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fconfig%2Ft-linux", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Ft-linux?ref=6d412a7b22b7766437e2c018f31d49aa981800d9", "patch": "@@ -12,5 +12,5 @@ SHLIB_MAPFILES += $(srcdir)/config/libgcc-glibc.ver\n \n # Use unwind-dw2-fde-glibc\n LIB2ADDEH = $(srcdir)/unwind-dw2.c $(srcdir)/unwind-dw2-fde-glibc.c \\\n-  $(srcdir)/unwind-sjlj.c\n-LIB2ADDEHDEP = unwind.inc unwind-dw2-fde.h unwind-dw2-fde.c\n+  $(srcdir)/unwind-sjlj.c $(srcdir)/gthr-gnat.c\n+LIB2ADDEHDEP = unwind.inc unwind-dw2-fde.h unwind-dw2-fde.c gthr-gnat.c"}, {"sha": "00bb2b26a628c0d1ac3ba3c4ac5915c5ea288e8a", "filename": "gcc/configure", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure?ref=6d412a7b22b7766437e2c018f31d49aa981800d9", "patch": "@@ -2305,7 +2305,7 @@ case x${enable_threads_flag} in\n \t\ttarget_thread_file=''\n \t\t;;\n \txdecosf1 | xirix | xmach | xos2 | xposix | xpthreads | xsingle | \\\n-\txsolaris | xwin32 | xdce | xrtems| xvxworks | xaix)\n+\txsolaris | xwin32 | xdce | xrtems| xvxworks | xaix | xgnat)\n \t\ttarget_thread_file=$enable_threads_flag\n \t\t;;\n \t*)\n@@ -2434,7 +2434,7 @@ fi\n \n \n # Find some useful tools\n-for ac_prog in gawk mawk nawk awk\n+for ac_prog in mawk gawk nawk awk\n do\n # Extract the first word of \"$ac_prog\", so it can be a program name with args.\n set dummy $ac_prog; ac_word=$2"}, {"sha": "2589c13c0dae564962bb029e6d087430be6bf2f5", "filename": "gcc/configure.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fconfigure.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fconfigure.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfigure.in?ref=6d412a7b22b7766437e2c018f31d49aa981800d9", "patch": "@@ -518,7 +518,7 @@ case x${enable_threads_flag} in\n \t\ttarget_thread_file=''\n \t\t;;\n \txdecosf1 | xirix | xmach | xos2 | xposix | xpthreads | xsingle | \\\n-\txsolaris | xwin32 | xdce | xrtems| xvxworks | xaix)\n+\txsolaris | xwin32 | xdce | xrtems| xvxworks | xaix | xgnat)\n \t\ttarget_thread_file=$enable_threads_flag\n \t\t;;\n \t*)"}, {"sha": "9620135bf9b4bca624e886dbe4aed79a4fc22206", "filename": "gcc/gthr-gnat.c", "status": "added", "additions": 84, "deletions": 0, "changes": 84, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fgthr-gnat.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fgthr-gnat.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgthr-gnat.c?ref=6d412a7b22b7766437e2c018f31d49aa981800d9", "patch": "@@ -0,0 +1,84 @@\n+/* Threads compatibility routines for libgcc2.  */\n+/* Compile this one with gcc.  */\n+/* Copyright (C) 2003 Free Software Foundation, Inc.\n+\n+This file is part of GCC.\n+\n+GCC is free software; you can redistribute it and/or modify it under\n+the terms of the GNU General Public License as published by the Free\n+Software Foundation; either version 2, or (at your option) any later\n+version.\n+\n+GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+for more details.\n+\n+You should have received a copy of the GNU General Public License\n+along with GCC; see the file COPYING.  If not, write to the Free\n+Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n+02111-1307, USA.  */\n+\n+/* As a special exception, if you link this library with other files,\n+   some of which are compiled with GCC, to produce an executable,\n+   this library does not by itself cause the resulting executable\n+   to be covered by the GNU General Public License.\n+   This exception does not however invalidate any other reasons why\n+   the executable file might be covered by the GNU General Public License.  */\n+\n+\n+#include \"gthr-gnat.h\"\n+\n+#ifdef __cplusplus\n+#define UNUSED(x)\n+#else\n+#define UNUSED(x) x __attribute__((unused))\n+#endif\n+\n+void\n+__gnat_default_lock (void)\n+{\n+  return;\n+}\n+\n+void\n+__gnat_default_unlock (void)\n+{\n+  return;\n+}\n+\n+static void (*__gnat_task_lock) () = *__gnat_default_lock;\n+static void (*__gnat_task_unlock) () = *__gnat_default_unlock;\n+\n+ void\n+__gnat_install_locks (lock, unlock)\n+     void (*lock) ();\n+     void (*unlock) ();\n+{\n+  __gnat_task_lock = lock;\n+  __gnat_task_unlock = unlock;\n+\n+}\n+\n+int\n+__gthread_active_p (void)\n+{\n+  return 0;\n+}\n+\n+int\n+__gthread_mutex_lock (__gthread_mutex_t * UNUSED (mutex))\n+{\n+  __gnat_task_lock ();\n+  return 0;\n+}\n+\n+int\n+__gthread_mutex_unlock (__gthread_mutex_t * UNUSED (mutex))\n+{\n+  __gnat_task_unlock ();\n+  return 0;\n+}\n+\n+#undef UNUSED\n+"}, {"sha": "0f49227f913f0410ba3a23dee5353f9e125d4134", "filename": "gcc/gthr-gnat.h", "status": "added", "additions": 43, "deletions": 0, "changes": 43, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fgthr-gnat.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6d412a7b22b7766437e2c018f31d49aa981800d9/gcc%2Fgthr-gnat.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgthr-gnat.h?ref=6d412a7b22b7766437e2c018f31d49aa981800d9", "patch": "@@ -0,0 +1,43 @@\n+/* Threads compatibility routines for libgcc2.  */\n+/* Compile this one with gcc.  */\n+/* Copyright (C) 2003 Free Software Foundation, Inc.\n+\n+This file is part of GCC.\n+\n+GCC is free software; you can redistribute it and/or modify it under\n+the terms of the GNU General Public License as published by the Free\n+Software Foundation; either version 2, or (at your option) any later\n+version.\n+GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+for more details.\n+\n+You should have received a copy of the GNU General Public License\n+along with GCC; see the file COPYING.  If not, write to the Free\n+Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n+02111-1307, USA.  */\n+\n+/* As a special exception, if you link this library with other files,\n+   some of which are compiled with GCC, to produce an executable,\n+   this library does not by itself cause the resulting executable\n+   to be covered by the GNU General Public License.\n+   This exception does not however invalidate any other reasons why\n+   the executable file might be covered by the GNU General Public License.  */\n+\n+#ifndef GCC_GTHR_GNAT_H\n+#define GCC_GTHR_GNAT_H\n+\n+/* Just provide compatibility for mutex handling.  */\n+\n+typedef int __gthread_mutex_t;\n+\n+#define __GTHREAD_MUTEX_INIT 0\n+\n+extern void __gnat_install_locks (void (*lock) (), void (*unlock) ());\n+extern int __gthread_active_p (void);\n+extern int __gthread_mutex_lock (__gthread_mutex_t *);\n+extern int __gthread_mutex_unlock (__gthread_mutex_t *);\n+\n+#endif /* ! GCC_GTHR_GNAT_H */\n+"}]}