{"sha": "adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWRmZTZlNGIyZjhlNzI4ODcxMGVhYzZiYWNkNmJhZThkNmVhM2MwNQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2019-05-16T08:01:09Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2019-05-16T08:01:09Z"}, "message": "gimple-parser.c (c_parser_gimple_statement): Handle __BIT_INSERT.\n\n2019-05-16  Richard Biener  <rguenther@suse.de>\n\n\tc/\n\t* gimple-parser.c (c_parser_gimple_statement): Handle __BIT_INSERT.\n\t(c_parser_gimple_unary_expression): Likewise.\n\n\t* gimple-pretty-print.c (dump_ternary_rhs): Dump BIT_INSERT_EXPR\n\tas __BIT_INSERT with -gimple.\n\n\t* gcc.dg/gimplefe-40.c: Amend again.\n\nFrom-SVN: r271278", "tree": {"sha": "c07b94e927b2b5ceceb95a3521d15fd7e40dd178", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c07b94e927b2b5ceceb95a3521d15fd7e40dd178"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f6b2daaf4ea5ab0d5e4c45292c9be102f40060a7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6b2daaf4ea5ab0d5e4c45292c9be102f40060a7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6b2daaf4ea5ab0d5e4c45292c9be102f40060a7"}], "stats": {"total": 96, "additions": 79, "deletions": 17}, "files": [{"sha": "b8c658d1c83a6ece1263dd4bcb7a5870a181ff00", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "patch": "@@ -1,3 +1,8 @@\n+2019-05-16  Richard Biener  <rguenther@suse.de>\n+\n+\t* gimple-pretty-print.c (dump_ternary_rhs): Dump BIT_INSERT_EXPR\n+\tas __BIT_INSERT with -gimple.\n+\n 2019-05-15  Jakub Jelinek  <jakub@redhat.com>\n \n \t* omp-low.c (lower_rec_input_clauses): For if (0) or simdlen (1) set"}, {"sha": "c42d67a3e32ee92447306ec51034a2f2d3424594", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "patch": "@@ -1,3 +1,8 @@\n+2019-05-16  Richard Biener  <rguenther@suse.de>\n+\n+\t* gimple-parser.c (c_parser_gimple_statement): Handle __BIT_INSERT.\n+\t(c_parser_gimple_unary_expression): Likewise.\n+\n 2019-05-15  Richard Biener  <rguenther@suse.de>\n \n \t* gimple-parser.c (c_parser_gimple_postfix_expression): Handle"}, {"sha": "6a15b99c215a3d152e0f6d30577cf54efbbaf845", "filename": "gcc/c/gimple-parser.c", "status": "modified", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Fc%2Fgimple-parser.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Fc%2Fgimple-parser.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fgimple-parser.c?ref=adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "patch": "@@ -746,6 +746,7 @@ c_parser_gimple_statement (gimple_parser &parser, gimple_seq *seq)\n \tif (strcmp (IDENTIFIER_POINTER (id), \"__ABS\") == 0\n \t    || strcmp (IDENTIFIER_POINTER (id), \"__ABSU\") == 0\n \t    || strcmp (IDENTIFIER_POINTER (id), \"__MIN\") == 0\n+\t    || strcmp (IDENTIFIER_POINTER (id), \"__BIT_INSERT\") == 0\n \t    || strcmp (IDENTIFIER_POINTER (id), \"__MAX\") == 0)\n \t  goto build_unary_expr;\n \tbreak;\n@@ -1108,6 +1109,37 @@ c_parser_gimple_unary_expression (gimple_parser &parser)\n \t    return c_parser_gimple_parentized_binary_expression (parser,\n \t\t\t\t\t\t\t\t op_loc,\n \t\t\t\t\t\t\t\t MAX_EXPR);\n+\t  else if (strcmp (IDENTIFIER_POINTER (id), \"__BIT_INSERT\") == 0)\n+\t    {\n+\t      /* __BIT_INSERT '(' postfix-expression, postfix-expression,\n+\t\t\t          integer ')'  */\n+\t      location_t loc = c_parser_peek_token (parser)->location;\n+\t      c_parser_consume_token (parser);\n+\t      if (c_parser_require (parser, CPP_OPEN_PAREN, \"expected %<(%>\"))\n+\t\t{\n+\t\t  c_expr op0 = c_parser_gimple_postfix_expression (parser);\n+\t\t  c_parser_skip_until_found (parser, CPP_COMMA,\n+\t\t\t\t\t     \"expected %<,%>\");\n+\t\t  c_expr op1 = c_parser_gimple_postfix_expression (parser);\n+\t\t  c_parser_skip_until_found (parser, CPP_COMMA,\n+\t\t\t\t\t     \"expected %<,%>\");\n+\t\t  c_expr op2 = c_parser_gimple_postfix_expression (parser);\n+\t\t  if (TREE_CODE (op2.value) != INTEGER_CST\n+\t\t      || !int_fits_type_p (op2.value, bitsizetype))\n+\t\t    c_parser_error (parser, \"expected constant offset\");\n+\t\t  c_parser_skip_until_found (parser, CPP_CLOSE_PAREN,\n+\t\t\t\t\t     \"expected %<)%>\");\n+\t\t  if (op0.value != error_mark_node\n+\t\t      && op1.value != error_mark_node\n+\t\t      && TREE_CODE (op2.value) == INTEGER_CST)\n+\t\t    ret.value = build3_loc (loc, BIT_INSERT_EXPR,\n+\t\t\t\t\t    TREE_TYPE (op0.value),\n+\t\t\t\t\t    op0.value, op1.value,\n+\t\t\t\t\t    fold_convert (bitsizetype,\n+\t\t\t\t\t\t\t  op2.value));\n+\t\t}\n+\t      return ret;\n+\t    }\n \t  else\n \t    return c_parser_gimple_postfix_expression (parser);\n \t}"}, {"sha": "c1c08644638d6dd81f351d50a2e31aa9fb153d56", "filename": "gcc/gimple-pretty-print.c", "status": "modified", "additions": 28, "deletions": 14, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Fgimple-pretty-print.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Fgimple-pretty-print.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimple-pretty-print.c?ref=adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "patch": "@@ -567,21 +567,35 @@ dump_ternary_rhs (pretty_printer *buffer, gassign *gs, int spc,\n       break;\n \n     case BIT_INSERT_EXPR:\n-      pp_string (buffer, \"BIT_INSERT_EXPR <\");\n-      dump_generic_node (buffer, gimple_assign_rhs1 (gs), spc, flags, false);\n-      pp_string (buffer, \", \");\n-      dump_generic_node (buffer, gimple_assign_rhs2 (gs), spc, flags, false);\n-      pp_string (buffer, \", \");\n-      dump_generic_node (buffer, gimple_assign_rhs3 (gs), spc, flags, false);\n-      pp_string (buffer, \" (\");\n-      if (INTEGRAL_TYPE_P (TREE_TYPE (gimple_assign_rhs2 (gs))))\n-\tpp_decimal_int (buffer,\n-\t\t\tTYPE_PRECISION (TREE_TYPE (gimple_assign_rhs2 (gs))));\n+      if (flags & TDF_GIMPLE)\n+\t{\n+\t  pp_string (buffer, \"__BIT_INSERT (\");\n+\t  dump_generic_node (buffer, gimple_assign_rhs1 (gs), spc,\n+\t\t\t     flags | TDF_SLIM, false);\n+\t  pp_string (buffer, \", \");\n+\t  dump_generic_node (buffer, gimple_assign_rhs2 (gs), spc,\n+\t\t\t     flags | TDF_SLIM, false);\n+\t  pp_string (buffer, \", \");\n+\t  dump_generic_node (buffer, gimple_assign_rhs3 (gs), spc,\n+\t\t\t     flags | TDF_SLIM, false);\n+\t  pp_right_paren (buffer);\n+\t}\n       else\n-\tdump_generic_node (buffer,\n-\t\t\t   TYPE_SIZE (TREE_TYPE (gimple_assign_rhs2 (gs))),\n-\t\t\t   spc, flags, false);\n-      pp_string (buffer, \" bits)>\");\n+\t{\n+\t  pp_string (buffer, \"BIT_INSERT_EXPR <\");\n+\t  dump_generic_node (buffer, gimple_assign_rhs1 (gs),\n+\t\t\t     spc, flags, false);\n+\t  pp_string (buffer, \", \");\n+\t  dump_generic_node (buffer, gimple_assign_rhs2 (gs),\n+\t\t\t     spc, flags, false);\n+\t  pp_string (buffer, \", \");\n+\t  dump_generic_node (buffer, gimple_assign_rhs3 (gs),\n+\t\t\t     spc, flags, false);\n+\t  pp_string (buffer, \" (\");\n+\t  if (INTEGRAL_TYPE_P (TREE_TYPE (gimple_assign_rhs2 (gs))))\n+\t    pp_decimal_int (buffer, TYPE_PRECISION\n+\t\t\t\t      (TREE_TYPE (gimple_assign_rhs2 (gs))));\n+\t}\n       break;\n \n     default:"}, {"sha": "2ca1d277804d9ce6bbf7c0f91afe4e3f48f4ff62", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "patch": "@@ -1,3 +1,7 @@\n+2019-05-16  Richard Biener  <rguenther@suse.de>\n+\n+\t* gcc.dg/gimplefe-40.c: Amend again.\n+\n 2019-05-15  Cherry Zhang  <cherryyz@google.com>\n \n \t* go.test/test/nilptr2.go: Change use function to actually do"}, {"sha": "3939066d1b5908729e0dde745bf1e8df06d3bbd9", "filename": "gcc/testsuite/gcc.dg/gimplefe-40.c", "status": "modified", "additions": 5, "deletions": 3, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-40.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-40.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgimplefe-40.c?ref=adfe6e4b2f8e7288710eac6bacd6bae8d6ea3c05", "patch": "@@ -1,12 +1,13 @@\n /* { dg-do compile { target int128 } } */\n-/* { dg-options \"-fgimple\" } */\n+/* { dg-options \"-fgimple -Wno-psabi -w\" } */\n \n typedef float v4sf __attribute__((vector_size(16)));\n-float __GIMPLE (ssa)\n+v4sf __GIMPLE (ssa)\n load (const void * p)\n {\n   __int128 unsigned _3;\n   v4sf _4;\n+  v4sf _6;\n   float _5;\n \n   __BB(2):\n@@ -17,5 +18,6 @@ load (const void * p)\n #else\n   _5 = 1.0f;\n #endif\n-  return _5;\n+  _6 = __BIT_INSERT (_4, _5, 0);\n+  return _6;\n }"}]}