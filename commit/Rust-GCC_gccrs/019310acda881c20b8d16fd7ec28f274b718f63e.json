{"sha": "019310acda881c20b8d16fd7ec28f274b718f63e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDE5MzEwYWNkYTg4MWMyMGI4ZDE2ZmQ3ZWMyOGYyNzRiNzE4ZjYzZQ==", "commit": {"author": {"name": "Florian Weimer", "email": "fw@deneb.enyo.de", "date": "2002-05-31T18:08:23Z"}, "committer": {"name": "Florian Weimer", "email": "fw@gcc.gnu.org", "date": "2002-05-31T18:08:23Z"}, "message": "cstreams.c (max_path_len): Move from here ...\n\n2002-05-31  Florian Weimer  <fw@deneb.enyo.de>\n\n\t* cstreams.c (max_path_len): Move from here ...\n\t* adaint.c (__gnat_max_path_len): ... to here.\n\t* adaint.c (__gnat_max_path_len): Declare.\n\t* g-dirope.adb (Max_Path): Adjust.\n\t* g-os_lib.adb (Normalize_Pathname.Max_Path): Adjust.\n\t* i-cstrea.ads (max_path_len): Adjust.\n\t* osint.adb (Get_RTS_Search_Dir.Max_Path): Adjust.\n\t* xr_tabls.adb (Dir_Name.Max_Path: Adjust.\n\nFrom-SVN: r54112", "tree": {"sha": "8d012631d1d115c229144aa1e14548aa4e54f077", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8d012631d1d115c229144aa1e14548aa4e54f077"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/019310acda881c20b8d16fd7ec28f274b718f63e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/019310acda881c20b8d16fd7ec28f274b718f63e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/019310acda881c20b8d16fd7ec28f274b718f63e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/019310acda881c20b8d16fd7ec28f274b718f63e/comments", "author": {"login": "fweimer", "id": 2729073, "node_id": "MDQ6VXNlcjI3MjkwNzM=", "avatar_url": "https://avatars.githubusercontent.com/u/2729073?v=4", "gravatar_id": "", "url": "https://api.github.com/users/fweimer", "html_url": "https://github.com/fweimer", "followers_url": "https://api.github.com/users/fweimer/followers", "following_url": "https://api.github.com/users/fweimer/following{/other_user}", "gists_url": "https://api.github.com/users/fweimer/gists{/gist_id}", "starred_url": "https://api.github.com/users/fweimer/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fweimer/subscriptions", "organizations_url": "https://api.github.com/users/fweimer/orgs", "repos_url": "https://api.github.com/users/fweimer/repos", "events_url": "https://api.github.com/users/fweimer/events{/privacy}", "received_events_url": "https://api.github.com/users/fweimer/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4722213d3364bc9cb8a039d8d6206006610aa269", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4722213d3364bc9cb8a039d8d6206006610aa269", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4722213d3364bc9cb8a039d8d6206006610aa269"}], "stats": {"total": 65, "additions": 39, "deletions": 26}, "files": [{"sha": "7c5f96095c500ef353f0dfac7664758996ccf896", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -1,5 +1,14 @@\n 2002-05-31  Florian Weimer  <fw@deneb.enyo.de>\n \n+\t* cstreams.c (max_path_len): Move from here ...\n+\t* adaint.c (__gnat_max_path_len): ... to here.\n+\t* adaint.c (__gnat_max_path_len): Declare.\n+\t* g-dirope.adb (Max_Path): Adjust.\n+\t* g-os_lib.adb (Normalize_Pathname.Max_Path): Adjust.\n+\t* i-cstrea.ads (max_path_len): Adjust. \n+\t* osint.adb (Get_RTS_Search_Dir.Max_Path): Adjust.\n+\t* xr_tabls.adb (Dir_Name.Max_Path: Adjust.\n+\n \t* Makefile.in, Make-lang.in: Documentation is now built in\n \tMake-lang.in.  Store Info and generated Texinfo files in the\n \tsource directory."}, {"sha": "de733ff24f3a54ecb29c7071eef77d5a2fa15434", "filename": "gcc/ada/adaint.c", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fadaint.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fadaint.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fadaint.c?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -213,6 +213,24 @@ const int __gnat_vmsp = 1;\n const int __gnat_vmsp = 0;\n #endif\n \n+/* This variable is used to export the maximum length of a path name to\n+   Ada code.  */\n+\n+#ifdef __EMX__\n+int __gnat_max_path_len = _MAX_PATH;\n+\n+#elif defined (VMS)\n+int __gnat_max_path_len = 4096; /* PATH_MAX */\n+\n+#elif defined (__vxworks) || defined (__OPENNT)\n+int __gnat_max_path_len = PATH_MAX;\n+\n+#else\n+#include <sys/param.h>\n+int __gnat_max_path_len = MAXPATHLEN;\n+\n+#endif\n+\n /* The following macro HAVE_READDIR_R should be defined if the\n    system provides the routine readdir_r.  */\n #undef HAVE_READDIR_R"}, {"sha": "c7b6a4d90a0bba842d5c2797706ba76f81bd0d63", "filename": "gcc/ada/adaint.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fadaint.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fadaint.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fadaint.h?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -33,6 +33,7 @@\n \n #include <dirent.h>\n \n+extern int    __gnat_max_path_len;\n extern void   __gnat_to_gm_time\t\t\t   PARAMS ((int *, int *,\n \t\t\t\t\t\t\t    int *, int *,\n \t\t\t\t\t\t\t    int *, int *,"}, {"sha": "5061fd85209fe8c8f0aad24b5128426ee043ee28", "filename": "gcc/ada/cstreams.c", "status": "modified", "additions": 6, "deletions": 21, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fcstreams.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fcstreams.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fcstreams.c?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -48,20 +48,11 @@\n \n #include \"adaint.h\"\n \n-#ifdef __EMX__\n-int max_path_len = _MAX_PATH;\n-#elif defined (VMS)\n+#ifdef VMS\n #include <unixlib.h>\n-int max_path_len = 4096; /* PATH_MAX */\n-\n-#elif defined (__vxworks) || defined (__OPENNT)\n-\n-int max_path_len = PATH_MAX;\n-\n-#else\n+#endif\n \n #ifdef linux\n-\n /* Don't use macros on GNU/Linux since they cause incompatible changes between\n    glibc 2.0 and 2.1 */\n \n@@ -74,12 +65,6 @@ int max_path_len = PATH_MAX;\n #ifdef stdout\n #  undef stdout\n #endif\n-\n-#endif\n-\n-#include <sys/param.h>\n-\n-int max_path_len = MAXPATHLEN;\n #endif\n \n /* The _IONBF value in CYGNUS or MINGW32 stdio.h is wrong.  */\n@@ -185,7 +170,7 @@ __gnat_full_name (nam, buffer)\n     strcpy (buffer, nam);\n   else\n     {\n-      _fullpath (buffer, nam, max_path_len);\n+      _fullpath (buffer, nam, __gnat_max_path_len);\n \n       for (p = buffer; *p; p++)\n \tif (*p == '/')\n@@ -210,10 +195,10 @@ __gnat_full_name (nam, buffer)\n     strcpy (buffer, __gnat_to_host_file_spec (buffer));\n   else\n     {\n-      char *nambuffer = alloca (max_path_len);\n+      char *nambuffer = alloca (__gnat_max_path_len);\n \n       strcpy (nambuffer, buffer);\n-      strcpy (buffer, getcwd (buffer, max_path_len, 0));\n+      strcpy (buffer, getcwd (buffer, __gnat_max_path_len, 0));\n       strcat (buffer, \"/\");\n       strcat (buffer, nambuffer);\n       strcpy (buffer, __gnat_to_host_file_spec (buffer));\n@@ -224,7 +209,7 @@ __gnat_full_name (nam, buffer)\n #else\n   if (nam[0] != '/')\n     {\n-      p = getcwd (buffer, max_path_len);\n+      p = getcwd (buffer, __gnat_max_path_len);\n       if (p == 0)\n \t{\n \t  buffer[0] = '\\0';"}, {"sha": "892684357c5a88b3858027f0d647297f235a3a38", "filename": "gcc/ada/g-dirope.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fg-dirope.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fg-dirope.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-dirope.adb?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -502,7 +502,7 @@ package body GNAT.Directory_Operations is\n    ---------------------\n \n    Max_Path : Integer;\n-   pragma Import (C, Max_Path, \"max_path_len\");\n+   pragma Import (C, Max_Path, \"__gnat_max_path_len\");\n \n    function Get_Current_Dir return Dir_Name_Str is\n       Current_Dir : String (1 .. Max_Path + 1);"}, {"sha": "524c3d42892c10552642cf7f773a89d17955fb30", "filename": "gcc/ada/g-os_lib.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fg-os_lib.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fg-os_lib.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-os_lib.adb?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -877,7 +877,7 @@ package body GNAT.OS_Lib is\n       return      String\n    is\n       Max_Path : Integer;\n-      pragma Import (C, Max_Path, \"max_path_len\");\n+      pragma Import (C, Max_Path, \"__gnat_max_path_len\");\n       --  Maximum length of a path name\n \n       procedure Get_Current_Dir"}, {"sha": "3c4af58662852e76d99cb4b7a814d64cc3773a1a", "filename": "gcc/ada/i-cstrea.ads", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fi-cstrea.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fi-cstrea.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fi-cstrea.ads?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -283,7 +283,7 @@ private\n    pragma Import (C, set_binary_mode, \"__gnat_set_binary_mode\");\n    pragma Import (C, set_text_mode, \"__gnat_set_text_mode\");\n \n-   pragma Import (C, max_path_len, \"max_path_len\");\n+   pragma Import (C, max_path_len, \"__gnat_max_path_len\");\n    pragma Import (C, full_name, \"__gnat_full_name\");\n \n    --  The following may be implemented as macros, and so are supported"}, {"sha": "5086d6c6670861f1f916231af3d408781aa8ff9e", "filename": "gcc/ada/osint.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fosint.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fosint.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fosint.adb?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -941,7 +941,7 @@ package body Osint is\n       pragma Import (C, Get_Current_Dir, \"__gnat_get_current_dir\");\n \n       Max_Path : Integer;\n-      pragma Import (C, Max_Path, \"max_path_len\");\n+      pragma Import (C, Max_Path, \"__gnat_max_path_len\");\n       --  Maximum length of a path name\n \n       Current_Dir        : String_Ptr;"}, {"sha": "8149d9416dd7b69e56d3af97e3c0109d462720dd", "filename": "gcc/ada/xr_tabls.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fxr_tabls.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/019310acda881c20b8d16fd7ec28f274b718f63e/gcc%2Fada%2Fxr_tabls.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fxr_tabls.adb?ref=019310acda881c20b8d16fd7ec28f274b718f63e", "patch": "@@ -629,7 +629,7 @@ package body Xr_Tabls is\n             else\n                declare\n                   Max_Path : Integer;\n-                  pragma Import (C, Max_Path, \"max_path_len\");\n+                  pragma Import (C, Max_Path, \"__gnat_max_path_len\");\n \n                   Base2 : Dir_Name_Str (1 .. Max_Path);\n                   Last  : Natural;"}]}