{"sha": "31045a25f33215ed30bfc4f7166c461a2cc92094", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzEwNDVhMjVmMzMyMTVlZDMwYmZjNGY3MTY2YzQ2MWEyY2M5MjA5NA==", "commit": {"author": {"name": "Richard Sandiford", "email": "rdsandiford@googlemail.com", "date": "2011-10-02T17:45:10Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2011-10-02T17:45:10Z"}, "message": "re PR target/49696 (ICE on mips when compiling drizzle)\n\ngcc/\n\tPR target/49696\n\t* config/mips/sync.md (sync_<optab>_12): Allow zero operands.\n\t(sync_old_<optab>_12, sync_new_<optab>_12, sync_nand_12): Likewise.\n\t(sync_old_nand_12, sync_new_nand_12, test_and_set_12): Likewise.\n\ngcc/testsuite/\n\t* gcc.dg/pr49696.c: New test.\n\nFrom-SVN: r179431", "tree": {"sha": "642730cfd3b37021971ee340f695e284f6cc1711", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/642730cfd3b37021971ee340f695e284f6cc1711"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/31045a25f33215ed30bfc4f7166c461a2cc92094", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31045a25f33215ed30bfc4f7166c461a2cc92094", "html_url": "https://github.com/Rust-GCC/gccrs/commit/31045a25f33215ed30bfc4f7166c461a2cc92094", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/31045a25f33215ed30bfc4f7166c461a2cc92094/comments", "author": {"login": "rsandifo", "id": 4235983, "node_id": "MDQ6VXNlcjQyMzU5ODM=", "avatar_url": "https://avatars.githubusercontent.com/u/4235983?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo", "html_url": "https://github.com/rsandifo", "followers_url": "https://api.github.com/users/rsandifo/followers", "following_url": "https://api.github.com/users/rsandifo/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo/orgs", "repos_url": "https://api.github.com/users/rsandifo/repos", "events_url": "https://api.github.com/users/rsandifo/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "4762f56169a78b4a15e8c7b6bb96ed3ceedfcc4c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4762f56169a78b4a15e8c7b6bb96ed3ceedfcc4c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4762f56169a78b4a15e8c7b6bb96ed3ceedfcc4c"}], "stats": {"total": 54, "additions": 47, "deletions": 7}, "files": [{"sha": "b8197fa033c7fa0ae4738868d4aa369a64155c5b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=31045a25f33215ed30bfc4f7166c461a2cc92094", "patch": "@@ -1,3 +1,10 @@\n+2011-10-02  Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\tPR target/49696\n+\t* config/mips/sync.md (sync_<optab>_12): Allow zero operands.\n+\t(sync_old_<optab>_12, sync_new_<optab>_12, sync_nand_12): Likewise.\n+\t(sync_old_nand_12, sync_new_nand_12, test_and_set_12): Likewise.\n+\n 2011-10-02  Jan Hubicka  <jh@suse.cz>\n \n \t* cgraphunit.c (verify_edge_count_and_frequency): Bounds check."}, {"sha": "1b4097ec225f0ea251fe39fbe266b989b4bf0c9a", "filename": "gcc/config/mips/sync.md", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2Fconfig%2Fmips%2Fsync.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2Fconfig%2Fmips%2Fsync.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fsync.md?ref=31045a25f33215ed30bfc4f7166c461a2cc92094", "patch": "@@ -136,7 +136,7 @@\n           [(match_operand:SI 1 \"register_operand\" \"d\")\n \t   (match_operand:SI 2 \"register_operand\" \"d\")\n \t   (atomic_hiqi_op:SI (match_dup 0)\n-\t\t\t      (match_operand:SI 3 \"register_operand\" \"dJ\"))]\n+\t\t\t      (match_operand:SI 3 \"reg_or_0_operand\" \"dJ\"))]\n \t  UNSPEC_SYNC_OLD_OP_12))\n    (clobber (match_scratch:SI 4 \"=&d\"))]\n   \"GENERATE_LL_SC\"\n@@ -177,7 +177,7 @@\n           [(match_operand:SI 2 \"register_operand\" \"d\")\n \t   (match_operand:SI 3 \"register_operand\" \"d\")\n \t   (atomic_hiqi_op:SI (match_dup 0)\n-\t\t\t      (match_operand:SI 4 \"register_operand\" \"dJ\"))]\n+\t\t\t      (match_operand:SI 4 \"reg_or_0_operand\" \"dJ\"))]\n \t  UNSPEC_SYNC_OLD_OP_12))\n    (clobber (match_scratch:SI 5 \"=&d\"))]\n   \"GENERATE_LL_SC\"\n@@ -218,7 +218,7 @@\n \t   (match_operand:SI 2 \"register_operand\" \"d\")\n \t   (match_operand:SI 3 \"register_operand\" \"d\")\n \t   (atomic_hiqi_op:SI (match_dup 0)\n-\t\t\t      (match_operand:SI 4 \"register_operand\" \"dJ\"))]\n+\t\t\t      (match_operand:SI 4 \"reg_or_0_operand\" \"dJ\"))]\n \t  UNSPEC_SYNC_NEW_OP_12))\n    (set (match_dup 1)\n \t(unspec_volatile:SI\n@@ -259,7 +259,7 @@\n           [(match_operand:SI 1 \"register_operand\" \"d\")\n \t   (match_operand:SI 2 \"register_operand\" \"d\")\n \t   (match_dup 0)\n-\t   (match_operand:SI 3 \"register_operand\" \"dJ\")]\n+\t   (match_operand:SI 3 \"reg_or_0_operand\" \"dJ\")]\n \t  UNSPEC_SYNC_OLD_OP_12))\n    (clobber (match_scratch:SI 4 \"=&d\"))]\n   \"GENERATE_LL_SC\"\n@@ -298,7 +298,7 @@\n \t(unspec_volatile:SI\n           [(match_operand:SI 2 \"register_operand\" \"d\")\n \t   (match_operand:SI 3 \"register_operand\" \"d\")\n-\t   (match_operand:SI 4 \"register_operand\" \"dJ\")]\n+\t   (match_operand:SI 4 \"reg_or_0_operand\" \"dJ\")]\n \t  UNSPEC_SYNC_OLD_OP_12))\n    (clobber (match_scratch:SI 5 \"=&d\"))]\n   \"GENERATE_LL_SC\"\n@@ -337,7 +337,7 @@\n           [(match_operand:SI 1 \"memory_operand\" \"+R\")\n \t   (match_operand:SI 2 \"register_operand\" \"d\")\n \t   (match_operand:SI 3 \"register_operand\" \"d\")\n-\t   (match_operand:SI 4 \"register_operand\" \"dJ\")]\n+\t   (match_operand:SI 4 \"reg_or_0_operand\" \"dJ\")]\n \t  UNSPEC_SYNC_NEW_OP_12))\n    (set (match_dup 1)\n \t(unspec_volatile:SI\n@@ -546,7 +546,7 @@\n    (set (match_dup 1)\n \t(unspec_volatile:SI [(match_operand:SI 2 \"register_operand\" \"d\")\n \t\t\t     (match_operand:SI 3 \"register_operand\" \"d\")\n-\t\t\t     (match_operand:SI 4 \"arith_operand\" \"dJ\")]\n+\t\t\t     (match_operand:SI 4 \"reg_or_0_operand\" \"dJ\")]\n \t  UNSPEC_SYNC_EXCHANGE_12))]\n   \"GENERATE_LL_SC\"\n   { return mips_output_sync_loop (insn, operands); }"}, {"sha": "56a9cc1f4c216c67910489b825a9980824c70305", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=31045a25f33215ed30bfc4f7166c461a2cc92094", "patch": "@@ -1,3 +1,7 @@\n+2011-10-02  Richard Sandiford  <rdsandiford@googlemail.com>\n+\n+\t* gcc.dg/pr49696.c: New test.\n+\n 2011-10-02  Jan Hubicka  <jh@suse.cz>\n \n \t* gcc.dg/ipa/ctor-empty-1.c: Update dump file."}, {"sha": "8e5a018fc02a4a59935edc2c08fce1564d89d627", "filename": "gcc/testsuite/gcc.dg/pr49696.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2Ftestsuite%2Fgcc.dg%2Fpr49696.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/31045a25f33215ed30bfc4f7166c461a2cc92094/gcc%2Ftestsuite%2Fgcc.dg%2Fpr49696.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr49696.c?ref=31045a25f33215ed30bfc4f7166c461a2cc92094", "patch": "@@ -0,0 +1,29 @@\n+/* { dg-require-effective-target sync_char_short } */\n+\n+/* { dg-message \"note: '__sync_fetch_and_nand' changed semantics in GCC 4.4\" \"\" { target *-*-* } 0 } */\n+\n+void\n+foo (short *x)\n+{\n+  __sync_val_compare_and_swap (x, 1, 0);\n+  __sync_bool_compare_and_swap (x, 1, 0);\n+  __sync_lock_test_and_set (x, 0);\n+\n+  __sync_fetch_and_add (x, 0);\n+  __sync_fetch_and_add (x, 0);\n+  __sync_fetch_and_add (x, 0);\n+  __sync_fetch_and_sub (x, 0);\n+  __sync_fetch_and_and (x, 0);\n+  __sync_fetch_and_or (x, 0);\n+  __sync_fetch_and_xor (x, 0);\n+  __sync_fetch_and_nand (x, 0);\n+\n+  __sync_add_and_fetch (x, 0);\n+  __sync_add_and_fetch (x, 0);\n+  __sync_add_and_fetch (x, 0);\n+  __sync_sub_and_fetch (x, 0);\n+  __sync_and_and_fetch (x, 0);\n+  __sync_or_and_fetch (x, 0);\n+  __sync_xor_and_fetch (x, 0);\n+  __sync_nand_and_fetch (x, 0);\n+}"}]}