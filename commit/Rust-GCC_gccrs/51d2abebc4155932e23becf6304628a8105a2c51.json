{"sha": "51d2abebc4155932e23becf6304628a8105a2c51", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTFkMmFiZWJjNDE1NTkzMmUyM2JlY2Y2MzA0NjI4YTgxMDVhMmM1MQ==", "commit": {"author": {"name": "Eric Botcazou", "email": "ebotcazou@adacore.com", "date": "2014-06-07T11:59:18Z"}, "committer": {"name": "Eric Botcazou", "email": "ebotcazou@gcc.gnu.org", "date": "2014-06-07T11:59:18Z"}, "message": "tree-ssa-tail-merge.c (same_succ_hash): Hash the static chain of a call statement, if any.\n\n\t* tree-ssa-tail-merge.c (same_succ_hash): Hash the static chain of a\n\tcall statement, if any.\n\t(gimple_equal_p) <GIMPLE_CALL>: Compare the static chain of the call\n\tstatements, if any.  Tidy up.\n\nFrom-SVN: r211342", "tree": {"sha": "aad08d05304a8159d0d41e15ffb5048e7c480502", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/aad08d05304a8159d0d41e15ffb5048e7c480502"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/51d2abebc4155932e23becf6304628a8105a2c51", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51d2abebc4155932e23becf6304628a8105a2c51", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51d2abebc4155932e23becf6304628a8105a2c51", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51d2abebc4155932e23becf6304628a8105a2c51/comments", "author": null, "committer": null, "parents": [{"sha": "25608e3a5fb6849e2f90207c1836359df0b79b43", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/25608e3a5fb6849e2f90207c1836359df0b79b43", "html_url": "https://github.com/Rust-GCC/gccrs/commit/25608e3a5fb6849e2f90207c1836359df0b79b43"}], "stats": {"total": 80, "additions": 74, "deletions": 6}, "files": [{"sha": "d7a35c3f6a3a07c1e704997d30097e2b83e464e5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=51d2abebc4155932e23becf6304628a8105a2c51", "patch": "@@ -1,3 +1,10 @@\n+2014-06-07  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* tree-ssa-tail-merge.c (same_succ_hash): Hash the static chain of a\n+\tcall statement, if any.\n+\t(gimple_equal_p) <GIMPLE_CALL>: Compare the static chain of the call\n+\tstatements, if any.  Tidy up.\n+\n 2014-06-06  Michael Meissner  <meissner@linux.vnet.ibm.com>\n \n \tPR target/61431"}, {"sha": "a6913af74fd42f0478d4a43a7a8945bc5a4046c9", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=51d2abebc4155932e23becf6304628a8105a2c51", "patch": "@@ -1,3 +1,8 @@\n+2014-06-07  Eric Botcazou  <ebotcazou@adacore.com>\n+\n+\t* gnat.dg/opt38.adb: New test.\n+\t* gnat.dg/opt38_pkg.ad[sb]: New helper.\n+\n 2014-06-07  Hans-Peter Nilsson  <hp@bitrange.com>\n \n \tPR target/18343"}, {"sha": "143f4fade19dcf0c8cbf1b802cfd4149a9b232c9", "filename": "gcc/testsuite/gnat.dg/opt38.adb", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38.adb?ref=51d2abebc4155932e23becf6304628a8105a2c51", "patch": "@@ -0,0 +1,9 @@\n+-- { dg-do run }\n+-- { dg-options \"-O2 -gnatn\" }\n+\n+with Opt38_Pkg; use Opt38_Pkg;\n+\n+procedure Opt38 is\n+begin\n+  Test (-1);\n+end;"}, {"sha": "7cbbeeab3282cc4560ef481d4eb5e81d04614651", "filename": "gcc/testsuite/gnat.dg/opt38_pkg.adb", "status": "added", "additions": 33, "deletions": 0, "changes": 33, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38_pkg.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38_pkg.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38_pkg.adb?ref=51d2abebc4155932e23becf6304628a8105a2c51", "patch": "@@ -0,0 +1,33 @@\n+package body Opt38_Pkg is\n+\n+  procedure Proc (I : Integer);\n+  pragma Inline (Proc);\n+\n+  procedure Proc (I : Integer) is\n+\n+    procedure Inner;\n+    pragma No_Inline (Inner);\n+\n+    procedure Inner is\n+    begin\n+      if I /= 110 then\n+        raise Program_Error;\n+      end if;\n+    end;\n+\n+  begin\n+    if I > 0 then\n+      Inner;\n+    end if;\n+  end;\n+\n+  procedure Test (I : Integer) is\n+  begin\n+    if I > -1 then\n+      Proc (I);\n+    else\n+      Proc (I + 111);\n+    end if;\n+  end;\n+\n+end Opt38_Pkg;"}, {"sha": "b6cb4e6bc72f6daf9b374e6fe3659c09a623f694", "filename": "gcc/testsuite/gnat.dg/opt38_pkg.ads", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38_pkg.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38_pkg.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgnat.dg%2Fopt38_pkg.ads?ref=51d2abebc4155932e23becf6304628a8105a2c51", "patch": "@@ -0,0 +1,5 @@\n+package Opt38_Pkg is\n+\n+  procedure Test (I : Integer);\n+\n+end Opt38_Pkg;"}, {"sha": "65b5a4e4420fbfff56e64e90fa694a2eca472f5c", "filename": "gcc/tree-ssa-tail-merge.c", "status": "modified", "additions": 15, "deletions": 6, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftree-ssa-tail-merge.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/51d2abebc4155932e23becf6304628a8105a2c51/gcc%2Ftree-ssa-tail-merge.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-tail-merge.c?ref=51d2abebc4155932e23becf6304628a8105a2c51", "patch": "@@ -481,7 +481,11 @@ same_succ_hash (const_same_succ e)\n \thashval = iterative_hash_hashval_t\n \t  ((hashval_t) gimple_call_internal_fn (stmt), hashval);\n       else\n-\thashval = iterative_hash_expr (gimple_call_fn (stmt), hashval);\n+\t{\n+\t  hashval = iterative_hash_expr (gimple_call_fn (stmt), hashval);\n+\t  if (gimple_call_chain (stmt))\n+\t    hashval = iterative_hash_expr (gimple_call_chain (stmt), hashval);\n+\t}\n       for (i = 0; i < gimple_call_num_args (stmt); i++)\n \t{\n \t  arg = gimple_call_arg (stmt, i);\n@@ -1121,18 +1125,23 @@ gimple_equal_p (same_succ same_succ, gimple s1, gimple s2)\n   switch (gimple_code (s1))\n     {\n     case GIMPLE_CALL:\n-      if (gimple_call_num_args (s1) != gimple_call_num_args (s2))\n-\treturn false;\n       if (!gimple_call_same_target_p (s1, s2))\n         return false;\n \n+      t1 = gimple_call_chain (s1);\n+      t2 = gimple_call_chain (s2);\n+      if (!gimple_operand_equal_value_p (t1, t2))\n+\treturn false;\n+\n+      if (gimple_call_num_args (s1) != gimple_call_num_args (s2))\n+\treturn false;\n+\n       for (i = 0; i < gimple_call_num_args (s1); ++i)\n \t{\n \t  t1 = gimple_call_arg (s1, i);\n \t  t2 = gimple_call_arg (s2, i);\n-\t  if (gimple_operand_equal_value_p (t1, t2))\n-\t    continue;\n-\t  return false;\n+\t  if (!gimple_operand_equal_value_p (t1, t2))\n+\t    return false;\n \t}\n \n       lhs1 = gimple_get_lhs (s1);"}]}