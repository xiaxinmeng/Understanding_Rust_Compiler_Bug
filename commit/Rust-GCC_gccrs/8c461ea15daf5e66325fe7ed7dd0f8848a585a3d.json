{"sha": "8c461ea15daf5e66325fe7ed7dd0f8848a585a3d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGM0NjFlYTE1ZGFmNWU2NjMyNWZlN2VkN2RkMGY4ODQ4YTU4NWEzZA==", "commit": {"author": {"name": "Jason Merrill", "email": "merrill@gnu.org", "date": "1994-06-23T23:19:54Z"}, "committer": {"name": "Jason Merrill", "email": "merrill@gnu.org", "date": "1994-06-23T23:19:54Z"}, "message": "(compile_file): Use TREE_SYMBOL_REFERENCED instead of\n        TREE_USED and TREE_ADDRESSABLE where appropriate.\n\nFrom-SVN: r7551", "tree": {"sha": "cededec88ab79d8d4d13b999eb029b1e84f988cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cededec88ab79d8d4d13b999eb029b1e84f988cf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8c461ea15daf5e66325fe7ed7dd0f8848a585a3d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c461ea15daf5e66325fe7ed7dd0f8848a585a3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8c461ea15daf5e66325fe7ed7dd0f8848a585a3d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8c461ea15daf5e66325fe7ed7dd0f8848a585a3d/comments", "author": null, "committer": null, "parents": [{"sha": "03e421329d438f03372e9d4534dfdc2304b4acc5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03e421329d438f03372e9d4534dfdc2304b4acc5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03e421329d438f03372e9d4534dfdc2304b4acc5"}], "stats": {"total": 23, "additions": 8, "deletions": 15}, "files": [{"sha": "31e3d198de30dbc94147d8b9a9c8d6a14ab283c2", "filename": "gcc/toplev.c", "status": "modified", "additions": 8, "deletions": 15, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8c461ea15daf5e66325fe7ed7dd0f8848a585a3d/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8c461ea15daf5e66325fe7ed7dd0f8848a585a3d/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=8c461ea15daf5e66325fe7ed7dd0f8848a585a3d", "patch": "@@ -2313,8 +2313,7 @@ compile_file (name)\n \t    if (! TREE_READONLY (decl)\n \t\t|| TREE_PUBLIC (decl)\n \t\t|| !optimize\n-\t\t|| TREE_ADDRESSABLE (decl)\n-\t\t|| TREE_ADDRESSABLE (DECL_ASSEMBLER_NAME (decl)))\n+\t\t|| TREE_SYMBOL_REFERENCED (DECL_ASSEMBLER_NAME (decl)))\n \t      rest_of_decl_compilation (decl, NULL_PTR, 1, 1);\n \t    else\n \t      /* Cancel the RTL for this decl so that, if debugging info\n@@ -2327,9 +2326,8 @@ compile_file (name)\n \t    && ! TREE_ASM_WRITTEN (decl)\n \t    && DECL_INITIAL (decl) != 0\n \t    && DECL_SAVED_INSNS (decl) != 0\n-\t    && (TREE_ADDRESSABLE (decl)\n-\t\t|| flag_keep_inline_functions\n-\t\t|| TREE_ADDRESSABLE (DECL_ASSEMBLER_NAME (decl)))\n+\t    && (flag_keep_inline_functions\n+\t\t|| TREE_SYMBOL_REFERENCED (DECL_ASSEMBLER_NAME (decl)))\n \t    && ! DECL_EXTERNAL (decl))\n \t  {\n \t    temporary_allocation ();\n@@ -2342,25 +2340,20 @@ compile_file (name)\n \t   We don't warn about variables,\n \t   because many programs have static variables\n \t   that exist only to get some text into the object file.  */\n-\tif ((warn_unused\n-\t     || TREE_USED (decl)\n-\t     || (DECL_NAME (decl) && TREE_USED (DECL_NAME (decl))))\n-\t    && TREE_CODE (decl) == FUNCTION_DECL\n+\tif (TREE_CODE (decl) == FUNCTION_DECL\n+\t    && (warn_unused\n+\t\t|| TREE_SYMBOL_REFERENCED (DECL_ASSEMBLER_NAME (decl)))\n \t    && DECL_INITIAL (decl) == 0\n \t    && DECL_EXTERNAL (decl)\n \t    && ! TREE_PUBLIC (decl))\n \t  {\n-\t    /* This should be a pedwarn, except that there is\n-\t       no easy way to prevent it from happening when the\n-\t       name is used only inside a sizeof.\n-\t       This at least avoids being incorrect.  */\n-\t    warning_with_decl (decl, \n+\t    pedwarn_with_decl (decl, \n \t\t\t       \"`%s' declared `static' but never defined\");\n \t    /* This symbol is effectively an \"extern\" declaration now.  */\n \t    TREE_PUBLIC (decl) = 1;\n \t    assemble_external (decl);\n-\n \t  }\n+\n \t/* Warn about static fns or vars defined but not used,\n \t   but not about inline functions or static consts\n \t   since defining those in header files is normal practice.  */"}]}