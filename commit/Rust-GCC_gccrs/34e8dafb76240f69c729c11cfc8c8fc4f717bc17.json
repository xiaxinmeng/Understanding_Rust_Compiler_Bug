{"sha": "34e8dafb76240f69c729c11cfc8c8fc4f717bc17", "node_id": "C_kwDOANBUbNoAKDM0ZThkYWZiNzYyNDBmNjljNzI5YzExY2ZjOGM4ZmM0ZjcxN2JjMTc", "commit": {"author": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2022-01-24T20:40:41Z"}, "committer": {"name": "Harald Anlauf", "email": "anlauf@gmx.de", "date": "2022-01-25T20:17:48Z"}, "message": "Fortran: optional argument DIM for intrinsics NORM2, PARITY must be scalar\n\ngcc/fortran/ChangeLog:\n\n\tPR fortran/104212\n\t* check.cc (gfc_check_norm2): Check that optional argument DIM is\n\tscalar.\n\t(gfc_check_parity): Likewise.\n\ngcc/testsuite/ChangeLog:\n\n\tPR fortran/104212\n\t* gfortran.dg/argument_checking_26.f90: New test.", "tree": {"sha": "ec1ef8c1363d8cae50af44c6635b0c978bf77d06", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ec1ef8c1363d8cae50af44c6635b0c978bf77d06"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/34e8dafb76240f69c729c11cfc8c8fc4f717bc17", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34e8dafb76240f69c729c11cfc8c8fc4f717bc17", "html_url": "https://github.com/Rust-GCC/gccrs/commit/34e8dafb76240f69c729c11cfc8c8fc4f717bc17", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/34e8dafb76240f69c729c11cfc8c8fc4f717bc17/comments", "author": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "committer": {"login": "harald-anlauf", "id": 90786862, "node_id": "MDQ6VXNlcjkwNzg2ODYy", "avatar_url": "https://avatars.githubusercontent.com/u/90786862?v=4", "gravatar_id": "", "url": "https://api.github.com/users/harald-anlauf", "html_url": "https://github.com/harald-anlauf", "followers_url": "https://api.github.com/users/harald-anlauf/followers", "following_url": "https://api.github.com/users/harald-anlauf/following{/other_user}", "gists_url": "https://api.github.com/users/harald-anlauf/gists{/gist_id}", "starred_url": "https://api.github.com/users/harald-anlauf/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/harald-anlauf/subscriptions", "organizations_url": "https://api.github.com/users/harald-anlauf/orgs", "repos_url": "https://api.github.com/users/harald-anlauf/repos", "events_url": "https://api.github.com/users/harald-anlauf/events{/privacy}", "received_events_url": "https://api.github.com/users/harald-anlauf/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bc90dd0ecf02e11d47d1af7f627e2e2acaa40106", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc90dd0ecf02e11d47d1af7f627e2e2acaa40106", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc90dd0ecf02e11d47d1af7f627e2e2acaa40106"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "4fa05ee7e9b733493e77b63161e6e40ea8317fb4", "filename": "gcc/fortran/check.cc", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34e8dafb76240f69c729c11cfc8c8fc4f717bc17/gcc%2Ffortran%2Fcheck.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34e8dafb76240f69c729c11cfc8c8fc4f717bc17/gcc%2Ffortran%2Fcheck.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fcheck.cc?ref=34e8dafb76240f69c729c11cfc8c8fc4f717bc17", "patch": "@@ -4338,6 +4338,9 @@ gfc_check_norm2 (gfc_expr *array, gfc_expr *dim)\n   if (!array_check (array, 0))\n     return false;\n \n+  if (!dim_check (dim, 1, false))\n+    return false;\n+\n   if (!dim_rank_check (dim, array, false))\n     return false;\n \n@@ -4476,6 +4479,9 @@ gfc_check_parity (gfc_expr *mask, gfc_expr *dim)\n   if (!array_check (mask, 0))\n     return false;\n \n+  if (!dim_check (dim, 1, false))\n+    return false;\n+\n   if (!dim_rank_check (dim, mask, false))\n     return false;\n "}, {"sha": "2b765c5f866af532f75af1a8c91645049812c8c8", "filename": "gcc/testsuite/gfortran.dg/argument_checking_26.f90", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/34e8dafb76240f69c729c11cfc8c8fc4f717bc17/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_26.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/34e8dafb76240f69c729c11cfc8c8fc4f717bc17/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_26.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fargument_checking_26.f90?ref=34e8dafb76240f69c729c11cfc8c8fc4f717bc17", "patch": "@@ -0,0 +1,14 @@\n+! { dg-do compile }\n+! PR fortran/104212 - ICE in transformational_result\n+! Contributed by G.Steinmetz\n+\n+program p\n+  logical, parameter :: a(*,*) = reshape([.true.,.false.], shape=[1,2])\n+  real,    parameter :: r(*,*) = reshape([1.,2.], shape=[1,2])\n+  print *, parity(a)\n+  print *, parity(a, dim=1)\n+  print *, parity(a, dim=[1]) ! { dg-error \"must be a scalar\" }\n+  print *, norm2 (r)\n+  print *, norm2 (r, dim=1)\n+  print *, norm2 (r, dim=[1]) ! { dg-error \"must be a scalar\" }\n+end"}]}