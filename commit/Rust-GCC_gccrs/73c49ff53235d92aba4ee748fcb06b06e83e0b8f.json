{"sha": "73c49ff53235d92aba4ee748fcb06b06e83e0b8f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzNjNDlmZjUzMjM1ZDkyYWJhNGVlNzQ4ZmNiMDZiMDZlODNlMGI4Zg==", "commit": {"author": {"name": "Jeff Law", "email": "jeffreyalaw@gmail.com", "date": "2021-07-06T14:55:53Z"}, "committer": {"name": "Jeff Law", "email": "jeffreyalaw@gmail.com", "date": "2021-07-06T14:55:53Z"}, "message": "Use H8 nop moves as tst insns\n\ngcc\n\t* config/h8300/jumpcall.md (*branch): When possible, generate\n\tthe comparison in CCZN mode.\n\t* config/h8300/predicates.md (simple_memory_operand): Reject all\n\tauto-increment addressing modes.", "tree": {"sha": "b8191681cc174a7153e61b5c38cf66d6f67c710b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b8191681cc174a7153e61b5c38cf66d6f67c710b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/73c49ff53235d92aba4ee748fcb06b06e83e0b8f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73c49ff53235d92aba4ee748fcb06b06e83e0b8f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73c49ff53235d92aba4ee748fcb06b06e83e0b8f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73c49ff53235d92aba4ee748fcb06b06e83e0b8f/comments", "author": {"login": "JeffreyALaw", "id": 14062506, "node_id": "MDQ6VXNlcjE0MDYyNTA2", "avatar_url": "https://avatars.githubusercontent.com/u/14062506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeffreyALaw", "html_url": "https://github.com/JeffreyALaw", "followers_url": "https://api.github.com/users/JeffreyALaw/followers", "following_url": "https://api.github.com/users/JeffreyALaw/following{/other_user}", "gists_url": "https://api.github.com/users/JeffreyALaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeffreyALaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeffreyALaw/subscriptions", "organizations_url": "https://api.github.com/users/JeffreyALaw/orgs", "repos_url": "https://api.github.com/users/JeffreyALaw/repos", "events_url": "https://api.github.com/users/JeffreyALaw/events{/privacy}", "received_events_url": "https://api.github.com/users/JeffreyALaw/received_events", "type": "User", "site_admin": false}, "committer": {"login": "JeffreyALaw", "id": 14062506, "node_id": "MDQ6VXNlcjE0MDYyNTA2", "avatar_url": "https://avatars.githubusercontent.com/u/14062506?v=4", "gravatar_id": "", "url": "https://api.github.com/users/JeffreyALaw", "html_url": "https://github.com/JeffreyALaw", "followers_url": "https://api.github.com/users/JeffreyALaw/followers", "following_url": "https://api.github.com/users/JeffreyALaw/following{/other_user}", "gists_url": "https://api.github.com/users/JeffreyALaw/gists{/gist_id}", "starred_url": "https://api.github.com/users/JeffreyALaw/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/JeffreyALaw/subscriptions", "organizations_url": "https://api.github.com/users/JeffreyALaw/orgs", "repos_url": "https://api.github.com/users/JeffreyALaw/repos", "events_url": "https://api.github.com/users/JeffreyALaw/events{/privacy}", "received_events_url": "https://api.github.com/users/JeffreyALaw/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "5db3ea9d748f00e55ddcb72d0720526824eeb4a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5db3ea9d748f00e55ddcb72d0720526824eeb4a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5db3ea9d748f00e55ddcb72d0720526824eeb4a9"}], "stats": {"total": 29, "additions": 25, "deletions": 4}, "files": [{"sha": "e1f04183564b74d3e0b664882c12b255bbabb4e1", "filename": "gcc/config/h8300/jumpcall.md", "status": "modified", "additions": 23, "deletions": 4, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73c49ff53235d92aba4ee748fcb06b06e83e0b8f/gcc%2Fconfig%2Fh8300%2Fjumpcall.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73c49ff53235d92aba4ee748fcb06b06e83e0b8f/gcc%2Fconfig%2Fh8300%2Fjumpcall.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fh8300%2Fjumpcall.md?ref=73c49ff53235d92aba4ee748fcb06b06e83e0b8f", "patch": "@@ -23,13 +23,32 @@\n   \"\"\n   \"#\"\n   \"&& reload_completed\"\n-  [(set (reg:H8cc CC_REG)\n-\t(compare:H8cc (match_dup 1) (match_dup 2)))\n+  [(set (match_dup 4)\n+\t(match_dup 5))\n    (set (pc)\n \t(if_then_else (match_op_dup 0\n-\t\t       [(reg:H8cc CC_REG) (const_int 0)])\n+\t\t       [(match_dup 4) (const_int 0)])\n \t\t      (label_ref (match_dup 3)) (pc)))]\n-  \"\")\n+  \"\n+{\n+  machine_mode mode;\n+\n+  if (REG_P (operands[1])\n+      && operands[2] == const0_rtx\n+      && (GET_CODE (operands[0]) == EQ\n+\t  || GET_CODE (operands[0]) == NE\n+\t  || GET_CODE (operands[0]) == LT\n+\t  || GET_CODE (operands[0]) == GE\n+\t  /* Our tstxx insns will set ZN and clear V, so we can handle\n+\t     a couple additional cases.  */\n+\t  || GET_CODE (operands[0]) == LE\n+\t  || GET_CODE (operands[0]) == GT))\n+    mode = E_CCZNmode;\n+  else\n+    mode = E_CCmode;\n+  operands[4] = gen_rtx_REG (mode, CC_REG);\n+  operands[5] = gen_rtx_COMPARE (mode, operands[1], operands[2]);\n+}\")\n \n (define_insn \"*branch_1\"\n   [(set (pc)"}, {"sha": "bed23e9a3e0f8d9789293d00c4db3f0a2884cd47", "filename": "gcc/config/h8300/predicates.md", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/73c49ff53235d92aba4ee748fcb06b06e83e0b8f/gcc%2Fconfig%2Fh8300%2Fpredicates.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/73c49ff53235d92aba4ee748fcb06b06e83e0b8f/gcc%2Fconfig%2Fh8300%2Fpredicates.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fh8300%2Fpredicates.md?ref=73c49ff53235d92aba4ee748fcb06b06e83e0b8f", "patch": "@@ -506,6 +506,8 @@\n {\n   if (GET_MODE (op) == mode\n       && (GET_CODE (XEXP (op, 0)) != PRE_DEC\n+\t  && GET_CODE (XEXP (op, 0)) != PRE_INC\n+\t  && GET_CODE (XEXP (op, 0)) != POST_DEC\n \t  && GET_CODE (XEXP (op, 0)) != POST_INC))\n     return 1;\n   return 0;"}]}