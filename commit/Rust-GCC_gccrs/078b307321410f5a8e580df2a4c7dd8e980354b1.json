{"sha": "078b307321410f5a8e580df2a4c7dd8e980354b1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDc4YjMwNzMyMTQxMGY1YThlNTgwZGYyYTRjN2RkOGU5ODAzNTRiMQ==", "commit": {"author": {"name": "Keith Seitz", "email": "keiths@redhat.com", "date": "2007-01-24T22:44:08Z"}, "committer": {"name": "Keith Seitz", "email": "kseitz@gcc.gnu.org", "date": "2007-01-24T22:44:08Z"}, "message": "prims.cc (_Jv_RunMain): Send JVMTI event notifications for VM_INIT and VM_DEATH instead of the JDWP...\n\n        * prims.cc (_Jv_RunMain): Send JVMTI event notifications\n        for VM_INIT and VM_DEATH instead of the JDWP notifications.\n\nFrom-SVN: r121143", "tree": {"sha": "51cf1a2d6840c64f7d39cc95fc745064f8d2de99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/51cf1a2d6840c64f7d39cc95fc745064f8d2de99"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/078b307321410f5a8e580df2a4c7dd8e980354b1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/078b307321410f5a8e580df2a4c7dd8e980354b1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/078b307321410f5a8e580df2a4c7dd8e980354b1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/078b307321410f5a8e580df2a4c7dd8e980354b1/comments", "author": {"login": "shtiek", "id": 107581324, "node_id": "U_kgDOBmmPjA", "avatar_url": "https://avatars.githubusercontent.com/u/107581324?v=4", "gravatar_id": "", "url": "https://api.github.com/users/shtiek", "html_url": "https://github.com/shtiek", "followers_url": "https://api.github.com/users/shtiek/followers", "following_url": "https://api.github.com/users/shtiek/following{/other_user}", "gists_url": "https://api.github.com/users/shtiek/gists{/gist_id}", "starred_url": "https://api.github.com/users/shtiek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/shtiek/subscriptions", "organizations_url": "https://api.github.com/users/shtiek/orgs", "repos_url": "https://api.github.com/users/shtiek/repos", "events_url": "https://api.github.com/users/shtiek/events{/privacy}", "received_events_url": "https://api.github.com/users/shtiek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c65110e44cc6aed93ee2e576d864e09a3bea59e3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c65110e44cc6aed93ee2e576d864e09a3bea59e3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c65110e44cc6aed93ee2e576d864e09a3bea59e3"}], "stats": {"total": 27, "additions": 16, "deletions": 11}, "files": [{"sha": "6b6749d46789957cf4f8d4ef179ff96e9f59606e", "filename": "libjava/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/078b307321410f5a8e580df2a4c7dd8e980354b1/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/078b307321410f5a8e580df2a4c7dd8e980354b1/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=078b307321410f5a8e580df2a4c7dd8e980354b1", "patch": "@@ -1,3 +1,8 @@\n+2007-01-24  Keith Seitz  <keiths@redhat.com>\n+\n+\t* prims.cc (_Jv_RunMain): Send JVMTI event notifications\n+\tfor VM_INIT and VM_DEATH instead of the JDWP notifications.\n+\n 2007-01-24  Keith Seitz  <keiths@redhat.com>\n \n \t* gnu/classpath/jdwp/natVMVirtualMachine.cc"}, {"sha": "e205dbbe521ba4a49202ac72f4f8d33b7825da91", "filename": "libjava/prims.cc", "status": "modified", "additions": 11, "deletions": 11, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/078b307321410f5a8e580df2a4c7dd8e980354b1/libjava%2Fprims.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/078b307321410f5a8e580df2a4c7dd8e980354b1/libjava%2Fprims.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fprims.cc?ref=078b307321410f5a8e580df2a4c7dd8e980354b1", "patch": "@@ -32,6 +32,9 @@ details.  */\n #include <java/lang/ThreadGroup.h>\n #endif\n \n+#include <jvmti.h>\n+#include \"jvmti-int.h\"\n+\n #ifndef DISABLE_GETENV_PROPERTIES\n #include <ctype.h>\n #include <java-props.h>\n@@ -66,8 +69,6 @@ details.  */\n #include <execution.h>\n #include <gnu/classpath/jdwp/Jdwp.h>\n #include <gnu/classpath/jdwp/VMVirtualMachine.h>\n-#include <gnu/classpath/jdwp/event/VmDeathEvent.h>\n-#include <gnu/classpath/jdwp/event/VmInitEvent.h>\n #include <gnu/java/lang/MainThread.h>\n \n #ifdef USE_LTDL\n@@ -1583,10 +1584,9 @@ _Jv_RunMain (JvVMInitArgs *vm_args, jclass klass, const char *name, int argc,\n \t  jdwp->join ();\n \t}\n \n-      // Send VmInit\n-      gnu::classpath::jdwp::event::VmInitEvent *event;\n-      event = new gnu::classpath::jdwp::event::VmInitEvent (main_thread);\n-      gnu::classpath::jdwp::Jdwp::notify (event);\n+      // Send VMInit\n+      if (JVMTI_REQUESTED_EVENT (VMInit))\n+\t_Jv_JVMTI_PostEvent (JVMTI_EVENT_VM_INIT, main_thread);\n     }\n   catch (java::lang::Throwable *t)\n     {\n@@ -1601,12 +1601,12 @@ _Jv_RunMain (JvVMInitArgs *vm_args, jclass klass, const char *name, int argc,\n \n   _Jv_ThreadRun (main_thread);\n \n-  // Notify debugger of VM's death\n-  if (gnu::classpath::jdwp::Jdwp::isDebugging)\n+  // Send VMDeath\n+  if (JVMTI_REQUESTED_EVENT (VMDeath))\n     {\n-      using namespace gnu::classpath::jdwp;\n-      event::VmDeathEvent *event = new event::VmDeathEvent ();\n-      Jdwp::notify (event);\n+      java::lang::Thread *thread = java::lang::Thread::currentThread ();\n+      JNIEnv *jni_env = _Jv_GetCurrentJNIEnv ();\n+      _Jv_JVMTI_PostEvent (JVMTI_EVENT_VM_DEATH, thread, jni_env);\n     }\n \n   // If we got here then something went wrong, as MainThread is not"}]}