{"sha": "18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MThkZDI3MmRmZDZiMDc3YzAwNWY0ZTFhMGE2Y2I0ZmZhOTA2YmVkNA==", "commit": {"author": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-12-14T16:00:25Z"}, "committer": {"name": "Paul Thomas", "email": "pault@gcc.gnu.org", "date": "2008-12-14T16:00:25Z"}, "message": "re PR fortran/35937 (Wrong type for charlength of function)\n\n2008-12-14  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/35937\n\t* trans-expr.c (gfc_finish_interface_mapping): Fold convert the\n\tcharacter length to gfc_charlen_type_node.\n\n2008-12-14  Paul Thomas  <pault@gcc.gnu.org>\n\n\tPR fortran/35937\n\t* gfortran.dg/char_length_14.f90: New test.\n\nFrom-SVN: r142750", "tree": {"sha": "368ee8ba6269adb05f34e2599d8d989efed3ba4e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/368ee8ba6269adb05f34e2599d8d989efed3ba4e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/comments", "author": null, "committer": null, "parents": [{"sha": "73793745269e8334807a606ea4d011215209ce0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/73793745269e8334807a606ea4d011215209ce0c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/73793745269e8334807a606ea4d011215209ce0c"}], "stats": {"total": 36, "additions": 35, "deletions": 1}, "files": [{"sha": "ad494810dccb0d640a98d090caea3c6325ea28f4", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "patch": "@@ -1,3 +1,9 @@\n+2008-12-14  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/35937\n+\t* trans-expr.c (gfc_finish_interface_mapping): Fold convert the\n+\tcharacter length to gfc_charlen_type_node.\n+\n 2008-12-12  Daniel Franke  <franke.daniel@gmail.com>\n \n \tPR fortran/36355"}, {"sha": "4a84234eb79f8c40c31cbc841e932a15922060a4", "filename": "gcc/fortran/trans-expr.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ffortran%2Ftrans-expr.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ffortran%2Ftrans-expr.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-expr.c?ref=18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "patch": "@@ -1830,7 +1830,7 @@ gfc_finish_interface_mapping (gfc_interface_mapping * mapping,\n \tgfc_apply_interface_mapping_to_expr (mapping, expr);\n \tgfc_init_se (&se, NULL);\n \tgfc_conv_expr (&se, expr);\n-\n+\tse.expr = fold_convert (gfc_charlen_type_node, se.expr);\n \tse.expr = gfc_evaluate_now (se.expr, &se.pre);\n \tgfc_add_block_to_block (pre, &se.pre);\n \tgfc_add_block_to_block (post, &se.post);"}, {"sha": "0ff2a04222b8a3408e4851d4bfccc8d1c61ad641", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "patch": "@@ -1,3 +1,8 @@\n+2008-12-14  Paul Thomas  <pault@gcc.gnu.org>\n+\n+\tPR fortran/35937\n+\t* gfortran.dg/char_length_14.f90: New test.\n+\n 2008-12-13  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libfortran/38504"}, {"sha": "5827dd95eeeb7254105abc1a94b4a5e6a97e93fe", "filename": "gcc/testsuite/gfortran.dg/char_length_14.f90", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ftestsuite%2Fgfortran.dg%2Fchar_length_14.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4/gcc%2Ftestsuite%2Fgfortran.dg%2Fchar_length_14.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fchar_length_14.f90?ref=18dd272dfd6b077c005f4e1a0a6cb4ffa906bed4", "patch": "@@ -0,0 +1,23 @@\n+! { dg-do run }\r\n+! PR35937, in which letting the length of 'c' to kind = 8 would\r\n+! screw up the interface and would cause an ICE. Note that this is\r\n+! actually the example of comment #4.\r\n+!\r\n+! Contributed by Thomas Koenig <tkoenig@gcc.gnu.org>\r\n+!\r\n+program main\r\n+  implicit none\r\n+  if (f5 ('1') .ne. \"a\") call abort\r\n+  if (len (f5 ('1')) .ne. 1) call abort\r\n+  if (f5 ('4') .ne. \"abcd\") call abort\r\n+  if (len (f5 ('4')) .ne. 4) call abort\r\n+contains\r\n+  function f5 (c)\r\n+    character(len=1_8) :: c\r\n+    character(len=scan('123456789', c)) :: f5\r\n+    integer :: i\r\n+    do i = 1, len (f5)\r\n+       f5(i:i) = char (i+96)\r\n+    end do\r\n+  end function f5\r\n+end program main\r"}]}