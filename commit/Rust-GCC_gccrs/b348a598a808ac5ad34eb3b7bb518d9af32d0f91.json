{"sha": "b348a598a808ac5ad34eb3b7bb518d9af32d0f91", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjM0OGE1OThhODA4YWM1YWQzNGViM2I3YmI1MThkOWFmMzJkMGY5MQ==", "commit": {"author": {"name": "Gerald Pfeifer", "email": "pfeifer@dbai.tuwien.ac.at", "date": "2003-06-25T09:36:19Z"}, "committer": {"name": "Gerald Pfeifer", "email": "gerald@gcc.gnu.org", "date": "2003-06-25T09:36:19Z"}, "message": "gcc_release: Factor the updating of links and READMEs on the FTP server and sending mail for...\n\n\t* gcc_release: Factor the updating of links and READMEs on the\n\tFTP server and sending mail for snapshots into a...\n\t(announce_snapshot): ...new function.\n\tAdd informative output for both.\n\nFrom-SVN: r68473", "tree": {"sha": "7764ad34577caf769a8364e021b4f9f8fb4be597", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7764ad34577caf769a8364e021b4f9f8fb4be597"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b348a598a808ac5ad34eb3b7bb518d9af32d0f91", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b348a598a808ac5ad34eb3b7bb518d9af32d0f91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b348a598a808ac5ad34eb3b7bb518d9af32d0f91", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b348a598a808ac5ad34eb3b7bb518d9af32d0f91/comments", "author": null, "committer": null, "parents": [{"sha": "380e198464b8fdf03634c2444fdd68a37e788ccc", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/380e198464b8fdf03634c2444fdd68a37e788ccc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/380e198464b8fdf03634c2444fdd68a37e788ccc"}], "stats": {"total": 51, "additions": 32, "deletions": 19}, "files": [{"sha": "f897e22db2da98c3fa031e3099c356b1fda7c177", "filename": "maintainer-scripts/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b348a598a808ac5ad34eb3b7bb518d9af32d0f91/maintainer-scripts%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b348a598a808ac5ad34eb3b7bb518d9af32d0f91/maintainer-scripts%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2FChangeLog?ref=b348a598a808ac5ad34eb3b7bb518d9af32d0f91", "patch": "@@ -1,3 +1,10 @@\n+2003-06-25  Gerald Pfeifer  <pfeifer@dbai.tuwien.ac.at>\n+\n+\t* gcc_release: Factor the updating of links and READMEs on the\n+\tFTP server and sending mail for snapshots into a...\n+\t(announce_snapshot): ...new function.\n+\tAdd informative output for both.\n+\n 2003-06-18  Gerald Pfeifer  <pfeifer@dbai.tuwien.ac.at>\n \n \t* gcc_release: Do not update gcc_latest_snapshot tag any longer."}, {"sha": "41fb7fe7c08b85a6a9638c659995a1e0c50d2273", "filename": "maintainer-scripts/gcc_release", "status": "modified", "additions": 25, "deletions": 19, "changes": 44, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b348a598a808ac5ad34eb3b7bb518d9af32d0f91/maintainer-scripts%2Fgcc_release", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b348a598a808ac5ad34eb3b7bb518d9af32d0f91/maintainer-scripts%2Fgcc_release", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/maintainer-scripts%2Fgcc_release?ref=b348a598a808ac5ad34eb3b7bb518d9af32d0f91", "patch": "@@ -336,7 +336,6 @@ build_diff() {\n }\n \n # Upload the files to the FTP server.\n-\n upload_files() {\n   inform \"Uploading files\"\n \n@@ -372,6 +371,30 @@ upload_files() {\n   done\n }\n \n+# Announce a snapshot, both on the web and via mail.\n+announce_snapshot() {\n+  inform \"Updating links and READMEs on the FTP server\"\n+  \n+  TEXT_DATE=`date --date=$DATE +%B\\ %d,\\ %Y`\n+  cd ~ftp/pub/gcc/snapshots\n+  sed -e \"s%@DATE@%$DATE%g\" -e \"s%@LAST_DATE@%$LAST_DATE%g\" \\\n+    -e \"s%@LONG_DATE@%$LONG_DATE%g\" \\\n+    -e \"s%@TEXT_DATE@%$TEXT_DATE%g\" < ~/scripts/snapshot-README > $$\n+  mv $$ README\n+  sed -e \"s%@DATE@%$DATE%g\" -e \"s%@LAST_DATE@%$LAST_DATE%g\" \\\n+    -e \"s%@LONG_DATE@%$LONG_DATE%g\" \\\n+    -e \"s%@TEXT_DATE@%$TEXT_DATE%g\" < ~/scripts/snapshot-index.html > $$\n+  mv $$ index.html\n+\n+  touch LATEST-IS-$LONG_DATE\n+  rm -f LATEST-IS-$LAST_LONG_DATE\n+\n+  inform \"Sending mail\"\n+\n+  export QMAILHOST=gcc.gnu.org\n+  mail -s \"gcc-ss-$DATE is now available\" gcc@gcc.gnu.org < ~ftp/pub/gcc/snapshots/README\n+}\n+\n ########################################################################\n # Initialization\n ########################################################################\n@@ -629,29 +652,12 @@ if [ $MODE_UPLOAD -ne 0 ]; then\n \n   # For snapshots, make some further updates.\n   if [ $SNAPSHOT -ne 0 ] && [ $LOCAL -ne 0 ]; then\n-    # Update links on the FTP server.\n-    TEXT_DATE=`date --date=$DATE +%B\\ %d,\\ %Y`\n-    cd ~ftp/pub/gcc/snapshots\n-    sed -e \"s%@DATE@%$DATE%g\" -e \"s%@LAST_DATE@%$LAST_DATE%g\" \\\n-      -e \"s%@LONG_DATE@%$LONG_DATE%g\" \\\n-      -e \"s%@TEXT_DATE@%$TEXT_DATE%g\" < ~/scripts/snapshot-README > $$\n-    mv $$ README\n-    sed -e \"s%@DATE@%$DATE%g\" -e \"s%@LAST_DATE@%$LAST_DATE%g\" \\\n-      -e \"s%@LONG_DATE@%$LONG_DATE%g\" \\\n-      -e \"s%@TEXT_DATE@%$TEXT_DATE%g\" < ~/scripts/snapshot-index.html > $$\n-    mv $$ index.html\n-\n-    touch LATEST-IS-$LONG_DATE\n-    rm -f LATEST-IS-$LAST_LONG_DATE\n+    announce_snapshot\n \n     # Update snapshot date file.\n     changedir ~\n     echo $DATE >.snapshot_date\n \n-    # Announce the snapshot.\n-    export QMAILHOST=gcc.gnu.org\n-    mail -s \"gcc-ss-$DATE is now available\" gcc@gcc.gnu.org < ~ftp/pub/gcc/snapshots/README\n-\n     # Remove working directory\n     rm -rf ${WORKING_DIRECTORY}\n   fi"}]}