{"sha": "c40a8be80895679e8100e6ed32274bbed57d6543", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzQwYThiZTgwODk1Njc5ZTgxMDBlNmVkMzIyNzRiYmVkNTdkNjU0Mw==", "commit": {"author": {"name": "Richard Earnshaw", "email": "rearnsha@arm.com", "date": "2018-05-11T09:28:10Z"}, "committer": {"name": "Richard Earnshaw", "email": "rearnsha@gcc.gnu.org", "date": "2018-05-11T09:28:10Z"}, "message": "[arm] PR target/85606 prefer armv6s-m for armv6-m parts\n\nWhen Arm introduced ARMv6-M there were two variants, ARMv6-M and\nARMv6S-M.  The two differed only in support for the SVC instruction.\nLater on SVC was then made a mandatory part of ARMv6-M and the\nARMv6S-M name was dropped.  GCC and GAS, however still recognize both\nnames and at least some versions of GAS still distinguish between the\ntwo.\n\nTo address this, this patch changes the architecture for the ARMv6-m\ncortex parts (m0, m0plus, m1 and the variants will small multiply\nunits) to use the ARMv6S-M name in conjunction with the assembler.\nThis avoids problems with them rejecting code that was previously\naccepted with older versions of GCC where we did not pass an explicit\narchitecture string through to the compiler when using -mcpu on the\ncommand line.\n\n\tPR target/85606\n\t* config/arm/arm-cpus.in: Add comment that ARMv6-m and ARMv6S-m are now\n\tequivalent.\n\t(cortex-m0): Use armv6s-m isa.\n\t(cortex-m0plus): Likewise.\n\t(cortex-m1): Likewise.\n\t(cortex-m0.small-multiply): Likewise.\n\t(cortex-m0plus.small-multiply): Likewise.\n\t(cortex-m1.small-multiply): Likewise.\n\nFrom-SVN: r260157", "tree": {"sha": "2f37b6ed2587c1087866f1f187be579bcb56c8b9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2f37b6ed2587c1087866f1f187be579bcb56c8b9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c40a8be80895679e8100e6ed32274bbed57d6543", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c40a8be80895679e8100e6ed32274bbed57d6543", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c40a8be80895679e8100e6ed32274bbed57d6543", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c40a8be80895679e8100e6ed32274bbed57d6543/comments", "author": null, "committer": null, "parents": [{"sha": "1c9ee609dffac3f7d59ac9b8ca725d3cb9769b61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1c9ee609dffac3f7d59ac9b8ca725d3cb9769b61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1c9ee609dffac3f7d59ac9b8ca725d3cb9769b61"}], "stats": {"total": 26, "additions": 20, "deletions": 6}, "files": [{"sha": "434d443130386e030bf0ea8e34180ee553eb2bb5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c40a8be80895679e8100e6ed32274bbed57d6543/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c40a8be80895679e8100e6ed32274bbed57d6543/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c40a8be80895679e8100e6ed32274bbed57d6543", "patch": "@@ -1,3 +1,15 @@\n+2018-05-11  Richard Earnshaw  <rearnsha@arm.com>\n+\n+\tPR target/85606\n+\t* config/arm/arm-cpus.in: Add comment that ARMv6-m and ARMv6S-m are now\n+\tequivalent.\n+\t(cortex-m0): Use armv6s-m isa.\n+\t(cortex-m0plus): Likewise.\n+\t(cortex-m1): Likewise.\n+\t(cortex-m0.small-multiply): Likewise.\n+\t(cortex-m0plus.small-multiply): Likewise.\n+\t(cortex-m1.small-multiply): Likewise.\n+\n 2018-05-11  Allan Sandfeld Jensen  <allan.jensen@qt.io>\n \t    Jakub Jelinek  <jakub@redhat.com>\n "}, {"sha": "fce30e41af082445ce22cd0b25dac4d936d4d29d", "filename": "gcc/config/arm/arm-cpus.in", "status": "modified", "additions": 8, "deletions": 6, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c40a8be80895679e8100e6ed32274bbed57d6543/gcc%2Fconfig%2Farm%2Farm-cpus.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c40a8be80895679e8100e6ed32274bbed57d6543/gcc%2Fconfig%2Farm%2Farm-cpus.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm-cpus.in?ref=c40a8be80895679e8100e6ed32274bbed57d6543", "patch": "@@ -446,6 +446,8 @@ begin arch armv6-m\n  isa ARMv6m\n end arch armv6-m\n \n+# This is now equivalent to armv6-m, but we keep it because some\n+# versions of GAS still distinguish between the two.\n begin arch armv6s-m\n  tune for cortex-m1\n  base 6M\n@@ -1168,21 +1170,21 @@ end cpu arm1156t2f-s\n begin cpu cortex-m1\n  cname cortexm1\n  tune flags LDSCHED\n- architecture armv6-m\n+ architecture armv6s-m\n  costs v6m\n end cpu cortex-m1\n \n begin cpu cortex-m0\n  cname cortexm0\n  tune flags LDSCHED\n- architecture armv6-m\n+ architecture armv6s-m\n  costs v6m\n end cpu cortex-m0\n \n begin cpu cortex-m0plus\n  cname cortexm0plus\n  tune flags LDSCHED\n- architecture armv6-m\n+ architecture armv6s-m\n  costs v6m\n end cpu cortex-m0plus\n \n@@ -1192,23 +1194,23 @@ begin cpu cortex-m1.small-multiply\n  cname cortexm1smallmultiply\n  tune for cortex-m1\n  tune flags LDSCHED SMALLMUL\n- architecture armv6-m\n+ architecture armv6s-m\n  costs v6m\n end cpu cortex-m1.small-multiply\n \n begin cpu cortex-m0.small-multiply\n  cname cortexm0smallmultiply\n  tune for cortex-m0\n  tune flags LDSCHED SMALLMUL\n- architecture armv6-m\n+ architecture armv6s-m\n  costs v6m\n end cpu cortex-m0.small-multiply\n \n begin cpu cortex-m0plus.small-multiply\n  cname cortexm0plussmallmultiply\n  tune for cortex-m0plus\n  tune flags LDSCHED SMALLMUL\n- architecture armv6-m\n+ architecture armv6s-m\n  costs v6m\n end cpu cortex-m0plus.small-multiply\n "}]}