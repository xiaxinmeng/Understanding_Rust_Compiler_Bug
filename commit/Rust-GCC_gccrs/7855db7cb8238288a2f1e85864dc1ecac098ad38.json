{"sha": "7855db7cb8238288a2f1e85864dc1ecac098ad38", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Nzg1NWRiN2NiODIzODI4OGEyZjFlODU4NjRkYzFlY2FjMDk4YWQzOA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2001-01-24T18:44:40Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2001-01-24T18:44:40Z"}, "message": "cppfiles.c (_cpp_read_file): Add to dependencies if requested.\n\n\t* cppfiles.c (_cpp_read_file): Add to dependencies if requested.\n\t* cppinit.c (cpp_start_read): Remove deps_add_dep call.\n\t* tradcpp.c (main): Add -imacros or -include'd dependencies\n\tfor -M*.\n\t* cpp.texi (-M, -MM): Document -M -include behaviour.\n\nFrom-SVN: r39240", "tree": {"sha": "a8bb7305a5a82c84986b30d9aec74961e26639ee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a8bb7305a5a82c84986b30d9aec74961e26639ee"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7855db7cb8238288a2f1e85864dc1ecac098ad38", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7855db7cb8238288a2f1e85864dc1ecac098ad38", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7855db7cb8238288a2f1e85864dc1ecac098ad38", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7855db7cb8238288a2f1e85864dc1ecac098ad38/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6a40fc2b757192e84d11ce4edfac13b31a3b4397", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a40fc2b757192e84d11ce4edfac13b31a3b4397", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a40fc2b757192e84d11ce4edfac13b31a3b4397"}], "stats": {"total": 35, "additions": 24, "deletions": 11}, "files": [{"sha": "e0b5617d658ad9354fd35b70e5b74a0784c6d18f", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7855db7cb8238288a2f1e85864dc1ecac098ad38", "patch": "@@ -1,3 +1,11 @@\n+2001-01-24  Jakub Jelinek  <jakub@redhat.com>\n+\n+\t* cppfiles.c (_cpp_read_file): Add to dependencies if requested.\n+\t* cppinit.c (cpp_start_read): Remove deps_add_dep call.\n+\t* tradcpp.c (main): Add -imacros or -include'd dependencies\n+\tfor -M*.\n+\t* cpp.texi (-M, -MM): Document -M -include behaviour.\n+\n 2001-01-24  Roger Collins <roger@ProProject.com>\n \t  \n         * config/i386/xm-i386.h: Make __i386__ a boolean macro."}, {"sha": "19e95667d2b33cc499ab427ba123a5bc641b5e17", "filename": "gcc/cpp.texi", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Fcpp.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Fcpp.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpp.texi?ref=7855db7cb8238288a2f1e85864dc1ecac098ad38", "patch": "@@ -3453,14 +3453,16 @@ Instead of outputting the result of preprocessing, output a rule\n suitable for @code{make} describing the dependencies of the main source\n file.  The preprocessor outputs one @code{make} rule containing the\n object file name for that source file, a colon, and the names of all the\n-included files.  If there are many included files then the rule is split\n-into several lines using @samp{\\}-newline.\n+included files, including those coming from @samp{-include} or\n+@samp{-imacros} command line options.  If there are many included files\n+then the rule is split into several lines using @samp{\\}-newline.\n \n @item -MM\n @findex -MM\n Like @samp{-M}, but mention only the files included with @samp{#include\n-\"@var{file}\"}.  System header files included with @samp{#include\n-<@var{file}>} are omitted.\n+\"@var{file}\"} or with @samp{-include} or @samp{-imacros} command line\n+options.  System header files included with @samp{#include <@var{file}>}\n+are omitted.\n \n @item -MF @var{file}\n @findex -MF"}, {"sha": "01b8d5fb6ae89f573c5f35c399b46889ef0084b8", "filename": "gcc/cppfiles.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Fcppfiles.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Fcppfiles.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppfiles.c?ref=7855db7cb8238288a2f1e85864dc1ecac098ad38", "patch": "@@ -765,6 +765,9 @@ _cpp_read_file (pfile, fname)\n       return 0;\n     }\n \n+  if (CPP_OPTION (pfile, print_deps))\n+    deps_add_dep (pfile->deps, f->name);\n+\n   stack_include_file (pfile, f);\n   return 1;\n }"}, {"sha": "ff4cdb38bbb7709abda21d534cda0e3cbdb82064", "filename": "gcc/cppinit.c", "status": "modified", "additions": 2, "deletions": 7, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Fcppinit.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Fcppinit.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcppinit.c?ref=7855db7cb8238288a2f1e85864dc1ecac098ad38", "patch": "@@ -911,13 +911,8 @@ cpp_start_read (pfile, fname)\n     CPP_OPTION (pfile, out_fname) = \"\";\n \n   if (CPP_OPTION (pfile, print_deps))\n-    {\n-      /* Set the default target (if there is none already), and\n-\t the dependency on the main file.  */\n-      deps_add_default_target (pfile->deps, CPP_OPTION (pfile, in_fname));\n-\n-      deps_add_dep (pfile->deps, CPP_OPTION (pfile, in_fname));\n-    }\n+    /* Set the default target (if there is none already).  */\n+    deps_add_default_target (pfile->deps, CPP_OPTION (pfile, in_fname));\n \n   /* Open the main input file.  This must be done early, so we have a\n      buffer to stand on.  */"}, {"sha": "82de0bb7d693993b8645838ff7c543fcd70ec752", "filename": "gcc/tradcpp.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Ftradcpp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7855db7cb8238288a2f1e85864dc1ecac098ad38/gcc%2Ftradcpp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftradcpp.c?ref=7855db7cb8238288a2f1e85864dc1ecac098ad38", "patch": "@@ -848,6 +848,11 @@ main (argc, argv)\n \t    perror_with_name (pend[i].arg);\n \t    return FATAL_EXIT_CODE;\n \t  }\n+\n+\t/* For -M, add this file to the dependencies.  */\n+\tif (print_deps)\n+\t  deps_add_dep (deps, pend[i].arg);\n+\n \tfinclude (fd, pend[i].arg, &outbuf);\n       }\n   indepth--;"}]}