{"sha": "7e3bd81e9b701b488057f01af96af605f1036f57", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2UzYmQ4MWU5YjcwMWI0ODgwNTdmMDFhZjk2YWY2MDVmMTAzNmY1Nw==", "commit": {"author": {"name": "Denis Chertykov", "email": "denisc@overta.ru", "date": "2000-09-17T15:08:35Z"}, "committer": {"name": "Denis Chertykov", "email": "denisc@gcc.gnu.org", "date": "2000-09-17T15:08:35Z"}, "message": "avr.md (\"mcu_enhanced\"): New attribute.\n\n\t* config/avr/avr.md (\"mcu_enhanced\"): New attribute.\n\t(\"mcu_mega\"): Likewise.\n\t(\"extendhisi2\"): Use \"mcu_enhanced\".\n\t(\"zero_extendhisi2\"): Likewise.\n\t(\"call_insn\"): Use \"mcu_enhanced\" and \"mcu_mega\".\n\t(\"call_value_insn\"): Likewise.\n\t(\"*sbrx_branch\"): Use \"mcu_mega\".\n\t(\"*sbrx_and_branchsi\"): Likewise.\n\t(\"*sbrx_and_branchhi\"): Likewise.\n\t(\"*tablejump_lib\"): Likewise.\n\nFrom-SVN: r36474", "tree": {"sha": "c2859a91f71b5f0b6d4f1b2bd4d0989111b38be1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c2859a91f71b5f0b6d4f1b2bd4d0989111b38be1"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e3bd81e9b701b488057f01af96af605f1036f57", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e3bd81e9b701b488057f01af96af605f1036f57", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e3bd81e9b701b488057f01af96af605f1036f57", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e3bd81e9b701b488057f01af96af605f1036f57/comments", "author": null, "committer": null, "parents": [{"sha": "d733f374761dcf9a2eb571ff2908d036c0bd391f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d733f374761dcf9a2eb571ff2908d036c0bd391f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d733f374761dcf9a2eb571ff2908d036c0bd391f"}], "stats": {"total": 164, "additions": 81, "deletions": 83}, "files": [{"sha": "42fe52bbcb0762abfccce86ee16a67d892a12678", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e3bd81e9b701b488057f01af96af605f1036f57/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e3bd81e9b701b488057f01af96af605f1036f57/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7e3bd81e9b701b488057f01af96af605f1036f57", "patch": "@@ -1,3 +1,16 @@\n+Sun Sep 17 18:48:32 2000  Denis Chertykov  <denisc@overta.ru>\n+\n+\t* config/avr/avr.md (\"mcu_enhanced\"): New attribute.\n+\t(\"mcu_mega\"): Likewise.\n+\t(\"extendhisi2\"): Use \"mcu_enhanced\".\n+\t(\"zero_extendhisi2\"): Likewise.\n+\t(\"call_insn\"): Use \"mcu_enhanced\" and \"mcu_mega\".\n+\t(\"call_value_insn\"): Likewise.\n+\t(\"*sbrx_branch\"): Use \"mcu_mega\".\n+\t(\"*sbrx_and_branchsi\"): Likewise.\n+\t(\"*sbrx_and_branchhi\"): Likewise.\n+\t(\"*tablejump_lib\"): Likewise.\n+\n Sun Sep 17 10:46:17 2000  Richard Kenner  <kenner@vlsi1.ultra.nyu.edu>\n \n \t* c-decl.c (grokdeclarator): Reorder tests to avoid looking at"}, {"sha": "e48dab7b269979f07f346aecf3f3cfb8813955c5", "filename": "gcc/config/avr/avr.md", "status": "modified", "additions": 68, "deletions": 83, "changes": 151, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e3bd81e9b701b488057f01af96af605f1036f57/gcc%2Fconfig%2Favr%2Favr.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e3bd81e9b701b488057f01af96af605f1036f57/gcc%2Fconfig%2Favr%2Favr.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Favr%2Favr.md?ref=7e3bd81e9b701b488057f01af96af605f1036f57", "patch": "@@ -28,6 +28,17 @@\n (define_attr \"type\" \"branch,branch1,arith\"\n   (const_string \"arith\"))\n \n+(define_attr \"mcu_enhanced\" \"yes,no\"\n+  (const (if_then_else (symbol_ref \"AVR_ENHANCED\")\n+\t\t       (const_string \"yes\")\n+\t\t       (const_string \"no\"))))\n+\n+(define_attr \"mcu_mega\" \"yes,no\"\n+  (const (if_then_else (symbol_ref \"AVR_MEGA\")\n+\t\t       (const_string \"yes\")\n+\t\t       (const_string \"no\"))))\n+  \n+\n ;; The size of instructions in bytes.\n ;; XXX may depend from \"cc\"\n \n@@ -1086,15 +1097,11 @@\n   \"@\n \tclr %C0\\;sbrc %B0,7\\;com %C0\\;mov %D0,%C0\n \t{mov %A0,%A1\\;mov %B0,%B1|movw %A0,%A1}\\;clr %C0\\;sbrc %B0,7\\;com %C0\\;mov %D0,%C0\"\n-  [(set (attr \"length\")\n-\t(if_then_else\n-\t (eq (symbol_ref \"AVR_ENHANCED\") (const_int 0))\n-\t (if_then_else (eq (symbol_ref \"which_alternative\") (const_int 0))\n-\t\t       (const_int 4)\n-\t\t       (const_int 6))\n-\t (if_then_else (eq (symbol_ref \"which_alternative\") (const_int 0))\n-\t\t       (const_int 4)\n-\t\t       (const_int 5))))\n+  [(set_attr_alternative \"length\"\n+\t\t\t [(const_int 4)\n+\t\t\t  (if_then_else (eq_attr \"mcu_enhanced\" \"yes\")\n+\t\t\t\t\t(const_int 5)\n+\t\t\t\t\t(const_int 6))])\n    (set_attr \"cc\" \"clobber,clobber\")])\n \n ;; xx<---x xx<---x xx<---x xx<---x xx<---x xx<---x xx<---x xx<---x xx<---x\n@@ -1127,15 +1134,11 @@\n   \"@\n \tclr %C0\\;clr %D0\n \t{mov %A0,%A1\\;mov %B0,%B1|movw %A0,%B0}\\;clr %C0\\;clr %D0\"\n-  [(set (attr \"length\")\n-\t(if_then_else\n-\t (eq (symbol_ref \"AVR_ENHANCED\") (const_int 0))\n-\t (if_then_else (eq (symbol_ref \"which_alternative\") (const_int 0))\n-\t\t       (const_int 2)\n-\t\t       (const_int 4))\n-\t (if_then_else (eq (symbol_ref \"which_alternative\") (const_int 0))\n-\t\t       (const_int 2)\n-\t\t       (const_int 3))))\n+  [(set_attr_alternative \"length\"\n+\t\t\t [(const_int 2)\n+\t\t\t  (if_then_else (eq_attr \"mcu_enhanced\" \"yes\")\n+\t\t\t\t\t(const_int 3)\n+\t\t\t\t\t(const_int 4))])\n    (set_attr \"cc\" \"set_n,set_n\")])\n \n ;;<=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=><=>\n@@ -1438,15 +1441,13 @@\n        return (AS1 (rjmp,_PC_+4) CR_TAB\n                AS1 (jmp,%3));\n      }\"\n-  [(set (attr \"length\") (if_then_else (and (ge (minus (pc) (match_dup 3))\n-\t\t\t\t\t       (const_int -2046))\n-\t\t\t\t\t   (le (minus (pc) (match_dup 3))\n-\t\t\t\t\t       (const_int 2046)))\n-\t\t\t\t      (const_int 2)\n-\t\t\t\t      (if_then_else (eq (symbol_ref \"AVR_MEGA\")\n-\t\t\t\t\t\t\t(const_int 0))\n-\t\t\t\t\t\t    (const_int 2)\n-\t\t\t\t\t\t    (const_int 4))))\n+  [(set (attr \"length\")\n+\t(if_then_else (and (ge (minus (pc) (match_dup 3)) (const_int -2046))\n+\t\t\t   (le (minus (pc) (match_dup 3)) (const_int 2046)))\n+\t\t      (const_int 2)\n+\t\t      (if_then_else (eq_attr \"mcu_mega\" \"no\")\n+\t\t\t\t    (const_int 2)\n+\t\t\t\t    (const_int 4))))\n    (set_attr \"cc\" \"clobber\")])\n \n (define_insn \"*sbrx_and_branchsi\"\n@@ -1477,15 +1478,13 @@\n        return (AS1 (rjmp,_PC_+4) CR_TAB\n                AS1 (jmp,%3));\n      }\"\n-  [(set (attr \"length\") (if_then_else (and (ge (minus (pc) (match_dup 3))\n-\t\t\t\t\t       (const_int -2046))\n-\t\t\t\t\t   (le (minus (pc) (match_dup 3))\n-\t\t\t\t\t       (const_int 2046)))\n-\t\t\t\t      (const_int 2)\n-\t\t\t\t      (if_then_else (eq (symbol_ref \"AVR_MEGA\")\n-\t\t\t\t\t\t\t(const_int 0))\n-\t\t\t\t\t\t    (const_int 2)\n-\t\t\t\t\t\t    (const_int 4))))\n+  [(set (attr \"length\")\n+\t(if_then_else (and (ge (minus (pc) (match_dup 3)) (const_int -2046))\n+\t\t\t   (le (minus (pc) (match_dup 3)) (const_int 2046)))\n+\t\t      (const_int 2)\n+\t\t      (if_then_else (eq_attr \"mcu_mega\" \"no\")\n+\t\t\t\t    (const_int 2)\n+\t\t\t\t    (const_int 4))))\n    (set_attr \"cc\" \"clobber\")])\n \n (define_insn \"*sbrx_and_branchhi\"\n@@ -1516,15 +1515,13 @@\n        return (AS1 (rjmp,_PC_+4) CR_TAB\n                AS1 (jmp,%3));\n      }\"\n-  [(set (attr \"length\") (if_then_else (and (ge (minus (pc) (match_dup 3))\n-\t\t\t\t\t       (const_int -2046))\n-\t\t\t\t\t   (le (minus (pc) (match_dup 3))\n-\t\t\t\t\t       (const_int 2046)))\n-\t\t\t\t      (const_int 2)\n-\t\t\t\t      (if_then_else (eq (symbol_ref \"AVR_MEGA\")\n-\t\t\t\t\t\t\t(const_int 0))\n-\t\t\t\t\t\t    (const_int 2)\n-\t\t\t\t\t\t    (const_int 4))))\n+  [(set (attr \"length\")\n+\t(if_then_else (and (ge (minus (pc) (match_dup 3)) (const_int -2046))\n+\t\t\t   (le (minus (pc) (match_dup 3)) (const_int 2046)))\n+\t\t      (const_int 2)\n+\t\t      (if_then_else (eq_attr \"mcu_mega\" \"no\")\n+\t\t\t\t    (const_int 2)\n+\t\t\t\t    (const_int 4))))\n    (set_attr \"cc\" \"clobber\")])\n \n ;; ************************************************************************\n@@ -1601,15 +1598,14 @@\n   \"\"\n   \"*{\n   if (AVR_MEGA && get_attr_length (insn) != 1)\n-    return \\\"jmp %0\\\";\n-  return \\\"rjmp %0\\\";\n+    return AS1 (jmp,%0);\n+  return AS1 (rjmp,%0);\n }\"\n-  [(set (attr \"length\") (if_then_else (and (ge (minus (pc) (match_dup 0))\n-\t\t\t\t\t       (const_int -2047))\n-\t\t\t\t\t   (le (minus (pc) (match_dup 0))\n-\t\t\t\t\t       (const_int 2047)))\n-\t\t\t\t      (const_int 1)\n-\t\t\t\t      (const_int 2)))\n+  [(set (attr \"length\")\n+\t(if_then_else (and (ge (minus (pc) (match_dup 0)) (const_int -2047))\n+\t\t\t   (le (minus (pc) (match_dup 0)) (const_int 2047)))\n+\t\t      (const_int 1)\n+\t\t      (const_int 2)))\n    (set_attr \"cc\" \"none\")])\n \n ;; call\n@@ -1655,18 +1651,14 @@\n   return AS1(call,%c0);\n }\"\n   [(set_attr \"cc\" \"clobber,clobber,clobber\")\n-   (set (attr \"length\")\n-\t(cond [(eq (symbol_ref \"which_alternative\") (const_int 0))\n-\t       (const_int 1)\n-\t       (eq (symbol_ref \"(which_alternative == 1 && AVR_ENHANCED)\")\n-                   (const_int 1))\n-\t       (const_int 2)\n-\t       (eq (symbol_ref \"(which_alternative == 1 && !AVR_ENHANCED)\")\n-                   (const_int 1))\n-\t       (const_int 3)\n-\t       (eq (symbol_ref \"!AVR_MEGA\") (const_int 0))\n-\t       (const_int 2)]\n-\t(const_int 1)))])\n+   (set_attr_alternative \"length\"\n+\t\t\t [(const_int 1)\n+\t\t\t  (if_then_else (eq_attr \"mcu_enhanced\" \"yes\")\n+\t\t\t\t\t(const_int 2)\n+\t\t\t\t\t(const_int 3))\n+\t\t\t  (if_then_else (eq_attr \"mcu_mega\" \"yes\")\n+\t\t\t\t\t(const_int 2)\n+\t\t\t\t\t(const_int 1))])])\n \n (define_insn \"call_value_insn\"\n   [(set (match_operand 0 \"register_operand\" \"=r,r,r\")\n@@ -1694,19 +1686,14 @@\n   return AS1(call,%c1);\n }\"\n   [(set_attr \"cc\" \"clobber,clobber,clobber\")\n-   (set (attr \"length\")\n-\t(cond [(eq (symbol_ref \"which_alternative\") (const_int 0))\n-\t       (const_int 1)\n-\t       (eq (symbol_ref \"(which_alternative == 1 && AVR_ENHANCED)\")\n-                   (const_int 1))\n-\t       (const_int 2)\n-\t       (eq (symbol_ref \"(which_alternative == 1 && !AVR_ENHANCED)\")\n-                   (const_int 1))\n-\t       (const_int 3)\n-\t       (eq (symbol_ref \"!AVR_MEGA\")\n-\t\t   (const_int 0))\n-\t       (const_int 2)]\n-\t      (const_int 1)))])\n+   (set_attr_alternative \"length\"\n+\t\t\t [(const_int 1)\n+\t\t\t  (if_then_else (eq_attr \"mcu_enhanced\" \"yes\")\n+\t\t\t\t\t(const_int 2)\n+\t\t\t\t\t(const_int 3))\n+\t\t\t  (if_then_else (eq_attr \"mcu_mega\" \"yes\")\n+\t\t\t\t\t(const_int 2)\n+\t\t\t\t\t(const_int 1))])])\n \n (define_insn \"nop\"\n   [(const_int 0)]\n@@ -1746,11 +1733,9 @@\n           : AS1 (rjmp,__tablejump__));\n   }\"\n   [(set_attr \"cc\" \"clobber\")\n-   (set (attr \"length\")\n-\t(if_then_else (eq (symbol_ref \"AVR_MEGA\")\n-\t\t\t  (const_int 0))\n-\t\t      (const_int 3)\n-\t\t      (const_int 4)))])\n+   (set (attr \"length\") (if_then_else (eq_attr \"mcu_mega\" \"no\")\n+\t\t\t\t      (const_int 3)\n+\t\t\t\t      (const_int 4)))])\n \n \n (define_insn \"*tablejump_enh\""}]}