{"sha": "e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTdiMDEyYzA0NDNhYTA0YjhiMTI4ZTY0ZmExYTVlMTkzYzhjYzM0MA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2008-09-26T05:09:29Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2008-09-26T05:09:29Z"}, "message": "re PR c/37645 (ICE with weakref attribute)\n\n\tPR c/37645\n\t* c-common.c (handle_weakref_attribute): Ignore the attribute unless\n\tthe decl is a VAR_DECL or FUNCTION_DECL.\n\n\t* gcc.dg/pr37645.c: New test.\n\nFrom-SVN: r140680", "tree": {"sha": "b02577ee4e89f768c0114466de99d6a7f83a9969", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b02577ee4e89f768c0114466de99d6a7f83a9969"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "83d48fad1f3dc5d869fd3f567293ef12bf495392", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/83d48fad1f3dc5d869fd3f567293ef12bf495392", "html_url": "https://github.com/Rust-GCC/gccrs/commit/83d48fad1f3dc5d869fd3f567293ef12bf495392"}], "stats": {"total": 22, "additions": 19, "deletions": 3}, "files": [{"sha": "66031cc705f7e2b2dc561128638c875b813dbc55", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 2, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "patch": "@@ -1,7 +1,12 @@\n+2008-09-25  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/37645\n+\t* c-common.c (handle_weakref_attribute): Ignore the attribute unless\n+\tthe decl is a VAR_DECL or FUNCTION_DECL.\n+\n 2008-09-25  Vladimir Makarov  <vmakarov@redhat.com>\n \n \tPR middle-end/37535\n-\n \t* ira-lives.c (mark_reg_live, mark_reg_dead): New functions.\n \t(mark_ref_live, mark_ref_dead): Use them.\n \t(def_conflicts_with_inputs_p): Remove.\n@@ -14,7 +19,6 @@\n 2008-09-25  Vladimir Makarov  <vmakarov@redhat.com>\n \n \tPR middle-end/37448\n-\t\n \t* ira-int.h (IRA_ALLOCNO_TEMP): Rename to ALLOCNO_TEMP.\n \t(ira_compress_allocno_live_ranges): New prototype.\n "}, {"sha": "5d692112bd70f2f3913cb1fee068b2d3f53d1076", "filename": "gcc/c-common.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-common.c?ref=e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "patch": "@@ -6131,7 +6131,9 @@ handle_weakref_attribute (tree *node, tree ARG_UNUSED (name), tree args,\n   /* We must ignore the attribute when it is associated with\n      local-scoped decls, since attribute alias is ignored and many\n      such symbols do not even have a DECL_WEAK field.  */\n-  if (decl_function_context (*node) || current_function_decl)\n+  if (decl_function_context (*node)\n+      || current_function_decl\n+      || (TREE_CODE (*node) != VAR_DECL && TREE_CODE (*node) != FUNCTION_DECL))\n     {\n       warning (OPT_Wattributes, \"%qE attribute ignored\", name);\n       *no_add_attrs = true;"}, {"sha": "959ab49ff8a68aa7ff7545a2e6e1e1fed757c92a", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "patch": "@@ -1,3 +1,8 @@\n+2008-09-25  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/37645\n+\t* gcc.dg/pr37645.c: New test.\n+\n 2008-09-25  Steve Ellcey  <sje@cup.hp.com>\n \n \t* gcc.dg/vect/slp-7.c: Add alignment attribute, change target tests."}, {"sha": "ac1e5a9d1c812048b5010d04b89447245728101f", "filename": "gcc/testsuite/gcc.dg/pr37645.c", "status": "added", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37645.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e7b012c0443aa04b8b128e64fa1a5e193c8cc340/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37645.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr37645.c?ref=e7b012c0443aa04b8b128e64fa1a5e193c8cc340", "patch": "@@ -0,0 +1,5 @@\n+/* PR c/37645 */\n+/* { dg-do compile } */\n+\n+typedef int T __attribute__((__weakref__ (\"U\")));\t/* { dg-warning \"attribute ignored\" } */\n+void foo (int i __attribute__((__weakref__ (\"j\"))));\t/* { dg-warning \"attribute ignored\" } */"}]}