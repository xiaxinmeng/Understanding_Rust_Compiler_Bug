{"sha": "d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDJhYTM2ZjVkOTZhYjJhMzE3ODg1MTZlMDViNGMxZjNjYzA1MDNkNg==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@TechFak.Uni-Bielefeld.DE", "date": "2002-05-15T15:57:05Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2002-05-15T15:57:05Z"}, "message": "testsuite_hooks.h (__set_testsuite_memlimit): Retrieve current limits before setting.\n\n\t* testsuite/testsuite_hooks.h (__set_testsuite_memlimit):\n\tRetrieve current limits before setting.\n\nFrom-SVN: r53490", "tree": {"sha": "d332f04f2a30f98311a6631da9ffe68b9d528181", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d332f04f2a30f98311a6631da9ffe68b9d528181"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6/comments", "author": null, "committer": null, "parents": [{"sha": "7bd9b6d491a8ecae045944f6eeba77a98e82d0c1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bd9b6d491a8ecae045944f6eeba77a98e82d0c1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7bd9b6d491a8ecae045944f6eeba77a98e82d0c1"}], "stats": {"total": 15, "additions": 14, "deletions": 1}, "files": [{"sha": "91082c7ebf2a9450d717362af36b241342b8e869", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6", "patch": "@@ -1,3 +1,8 @@\n+2002-05-15  Rainer Orth  <ro@TechFak.Uni-Bielefeld.DE>\n+\n+\t* testsuite/testsuite_hooks.h (__set_testsuite_memlimit):\n+\tRetrieve current limits before setting.\n+\n 2002-05-15  Benjamin Kosnik  <bkoz@redhat.com>\n \n \tPR libstdc++/6518"}, {"sha": "eb87d51f2973b4fea0e986858939990abca1dd4a", "filename": "libstdc++-v3/testsuite/testsuite_hooks.h", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6/libstdc%2B%2B-v3%2Ftestsuite%2Ftestsuite_hooks.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6/libstdc%2B%2B-v3%2Ftestsuite%2Ftestsuite_hooks.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Ftestsuite_hooks.h?ref=d2aa36f5d96ab2a31788516e05b4c1f3cc0503d6", "patch": "@@ -81,25 +81,33 @@ void\n __set_testsuite_memlimit(float __size = MEMLIMIT_MB)\n {\n     struct rlimit r;\n-    r.rlim_cur = (rlim_t)(__size * 1048576);\n+    rlim_t limit = (rlim_t)(__size * 1048576);\n \n     // Heap size, seems to be common.\n #if _GLIBCPP_HAVE_MEMLIMIT_DATA\n+    getrlimit(RLIMIT_DATA, &r);\n+    r.rlim_cur = limit;\n     setrlimit(RLIMIT_DATA, &r);\n #endif\n \n     // Resident set size.\n #if _GLIBCPP_HAVE_MEMLIMIT_RSS\n+    getrlimit(RLIMIT_RSS, &r);\n+    r.rlim_cur = limit;\n     setrlimit(RLIMIT_RSS, &r);\n #endif\n \n     // Mapped memory (brk + mmap).\n #if _GLIBCPP_HAVE_MEMLIMIT_VMEM\n+    getrlimit(RLIMIT_VMEM, &r);\n+    r.rlim_cur = limit;\n     setrlimit(RLIMIT_VMEM, &r);\n #endif\n \n     // Virtual memory.\n #if _GLIBCPP_HAVE_MEMLIMIT_AS\n+    getrlimit(RLIMIT_AS, &r);\n+    r.rlim_cur = limit;\n     setrlimit(RLIMIT_AS, &r);\n #endif\n }"}]}