{"sha": "804254edb48f87d726a1bc9e95af04076c030e35", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODA0MjU0ZWRiNDhmODdkNzI2YTFiYzllOTVhZjA0MDc2YzAzMGUzNQ==", "commit": {"author": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2020-05-23T07:25:10Z"}, "committer": {"name": "Iain Sandoe", "email": "iain@sandoe.co.uk", "date": "2020-05-23T07:25:46Z"}, "message": "Darwin: Make sanitizer local vars linker-visible.\n\nAnother case where we need a linker-visible symbols in order to\npreserve the ld64 atom model.  If these symbols are emitted as\n'local' the linker cannot see that they are separate from any\nglobal weak entry that precedes them.  This will cause the linker\nto complain that there is (apparently) direct access to such a\nweak global, preventing it from being replaced.\n\nThis is a short-term fix for the problem - we need generic\nhandling for relevant cases (that also does not pessimise objects\nby emitting unnecessary symbols and relocations).\n\ngcc/ChangeLog:\n\n2020-05-23  Iain Sandoe  <iain@sandoe.co.uk>\n\n\t* config/darwin.h (ASM_GENERATE_INTERNAL_LABEL):\n\tMake ubsan_{data,type},ASAN symbols linker-visible.", "tree": {"sha": "8ccd19ce36c16ff8d2b4cb88fa1599d7726945b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8ccd19ce36c16ff8d2b4cb88fa1599d7726945b8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/804254edb48f87d726a1bc9e95af04076c030e35", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/804254edb48f87d726a1bc9e95af04076c030e35", "html_url": "https://github.com/Rust-GCC/gccrs/commit/804254edb48f87d726a1bc9e95af04076c030e35", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/804254edb48f87d726a1bc9e95af04076c030e35/comments", "author": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "committer": {"login": "iains", "id": 4039407, "node_id": "MDQ6VXNlcjQwMzk0MDc=", "avatar_url": "https://avatars.githubusercontent.com/u/4039407?v=4", "gravatar_id": "", "url": "https://api.github.com/users/iains", "html_url": "https://github.com/iains", "followers_url": "https://api.github.com/users/iains/followers", "following_url": "https://api.github.com/users/iains/following{/other_user}", "gists_url": "https://api.github.com/users/iains/gists{/gist_id}", "starred_url": "https://api.github.com/users/iains/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/iains/subscriptions", "organizations_url": "https://api.github.com/users/iains/orgs", "repos_url": "https://api.github.com/users/iains/repos", "events_url": "https://api.github.com/users/iains/events{/privacy}", "received_events_url": "https://api.github.com/users/iains/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "33e09fc5051f70daaad690b8583aab76902cce9c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/33e09fc5051f70daaad690b8583aab76902cce9c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/33e09fc5051f70daaad690b8583aab76902cce9c"}], "stats": {"total": 11, "additions": 11, "deletions": 0}, "files": [{"sha": "ede1f15eb7a1786f57452ff9b1015f7cddd9571d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/804254edb48f87d726a1bc9e95af04076c030e35/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/804254edb48f87d726a1bc9e95af04076c030e35/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=804254edb48f87d726a1bc9e95af04076c030e35", "patch": "@@ -1,3 +1,8 @@\n+2020-05-23 Iain Sandoe <iain@sandoe.co.uk>\n+\n+\t* config/darwin.h (ASM_GENERATE_INTERNAL_LABEL): Make\n+\tubsan_{data,type},ASAN symbols linker-visible.\n+\n 2020-05-22  Jan Hubicka  <hubicka@ucw.cz>\n \n \t* lto-streamer-out.c (DFS::DFS): Silence warning."}, {"sha": "f528b1766bf2fc51fec7519882c8eb34d4ad5173", "filename": "gcc/config/darwin.h", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/804254edb48f87d726a1bc9e95af04076c030e35/gcc%2Fconfig%2Fdarwin.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/804254edb48f87d726a1bc9e95af04076c030e35/gcc%2Fconfig%2Fdarwin.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fdarwin.h?ref=804254edb48f87d726a1bc9e95af04076c030e35", "patch": "@@ -808,6 +808,12 @@ extern GTY(()) section * darwin_sections[NUM_DARWIN_SECTIONS];\n   do {\t\t\t\t\t\t\t\\\n     if (strcmp (\"LC\", PREFIX) == 0)\t\t\t\\\n       sprintf (LABEL, \"*%s%ld\", \"lC\", (long)(NUM));\t\\\n+    else if (strcmp (\"Lubsan_data\", PREFIX) == 0)\t\\\n+      sprintf (LABEL, \"*%s%ld\", \"lubsan_data\", (long)(NUM));\\\n+    else if (strcmp (\"Lubsan_type\", PREFIX) == 0)\t\\\n+      sprintf (LABEL, \"*%s%ld\", \"lubsan_type\", (long)(NUM));\\\n+    else if (strcmp (\"LASAN\", PREFIX) == 0)\t\\\n+      sprintf (LABEL, \"*%s%ld\", \"lASAN\", (long)(NUM));\\\n     else\t\t\t\t\t\t\\\n       sprintf (LABEL, \"*%s%ld\", PREFIX, (long)(NUM));\t\\\n   } while (0)"}]}