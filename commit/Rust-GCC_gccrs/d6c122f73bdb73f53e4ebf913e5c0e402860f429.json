{"sha": "d6c122f73bdb73f53e4ebf913e5c0e402860f429", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDZjMTIyZjczYmRiNzNmNTNlNGViZjkxM2U1YzBlNDAyODYwZjQyOQ==", "commit": {"author": {"name": "David Daney", "email": "ddaney@avtrex.com", "date": "2006-03-08T20:22:02Z"}, "committer": {"name": "David Daney", "email": "daney@gcc.gnu.org", "date": "2006-03-08T20:22:02Z"}, "message": "gcj.texi: Document -static-libgcj option.\n\ngcc/java/\n2006-03-08  David Daney  <ddaney@avtrex.com>\n\n\t* gcj.texi: Document -static-libgcj option.\n\nlibjava/\n2006-03-08  David Daney  <ddaney@avtrex.com>\n\n\t* configure.ac (LD): Add AC_CHECK_TOOL for ld.\n\t(LD_START_STATIC_SPEC): New AC_SUBST, set with ld check.\n\t(LD_FINISH_STATIC_SPEC): Ditto\n\t* configure: Regenerated.\n\t* libgcj.spec.in: Wrap -lgcj in LD_START_STATIC_SPEC and\n\tLD_FINISH_STATIC_SPEC.\n\nFrom-SVN: r111847", "tree": {"sha": "fc5ef5f6ebf569aaecd0b3045638dddadea250dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/fc5ef5f6ebf569aaecd0b3045638dddadea250dd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d6c122f73bdb73f53e4ebf913e5c0e402860f429", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6c122f73bdb73f53e4ebf913e5c0e402860f429", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d6c122f73bdb73f53e4ebf913e5c0e402860f429", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d6c122f73bdb73f53e4ebf913e5c0e402860f429/comments", "author": null, "committer": null, "parents": [{"sha": "dedfa46611c491d61ad880f0728068f5a7127f89", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dedfa46611c491d61ad880f0728068f5a7127f89", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dedfa46611c491d61ad880f0728068f5a7127f89"}], "stats": {"total": 141, "additions": 137, "deletions": 4}, "files": [{"sha": "d80ff952754d92144a69af5d0f465c5c735e20a0", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c122f73bdb73f53e4ebf913e5c0e402860f429/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c122f73bdb73f53e4ebf913e5c0e402860f429/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=d6c122f73bdb73f53e4ebf913e5c0e402860f429", "patch": "@@ -1,3 +1,7 @@\n+2006-03-08  David Daney  <ddaney@avtrex.com>\n+\n+\t* gcj.texi: Document -static-libgcj option.\n+\n 2006-02-20  Andrew Haley  <aph@redhat.com>\n \n \t* jcf-parse.c (parse_class_file): Set input_location from"}, {"sha": "84659a54bdcd5332252791df78ffcfb09bf67651", "filename": "gcc/java/gcj.texi", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c122f73bdb73f53e4ebf913e5c0e402860f429/gcc%2Fjava%2Fgcj.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c122f73bdb73f53e4ebf913e5c0e402860f429/gcc%2Fjava%2Fgcj.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fgcj.texi?ref=d6c122f73bdb73f53e4ebf913e5c0e402860f429", "patch": "@@ -420,6 +420,20 @@ Create an application whose command-line processing is that\n of the @code{gij} command.\n \n This option is an alternative to using @code{--main}; you cannot use both.\n+\n+@item -static-libgcj\n+This option causes linking to be done against a static version of the\n+libgcj runtime library.  This option is only available if\n+corresponding linker support exists.\n+\n+@strong{Caution:} Static linking of libgcj may cause essential parts\n+of libgcj to be omitted.  Some parts of libgcj use reflection to load\n+classes at runtime.  Since the linker does not see these references at\n+link time, it can omit the referred to classes.  The result is usually\n+(but not always) a @code{ClassNotFoundException} being thrown at\n+runtime. Caution must be used when using this option.  For more\n+details see:\n+@w{@uref{http://gcc.gnu.org/wiki/Statically%20linking%20libgcj}}\n @end table\n \n @node Code Generation"}, {"sha": "7e61dadecaaaae7680c00abb47f0b5f4c38a368d", "filename": "libjava/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=d6c122f73bdb73f53e4ebf913e5c0e402860f429", "patch": "@@ -1,3 +1,12 @@\n+2006-03-08  David Daney  <ddaney@avtrex.com>\n+\n+\t* configure.ac (LD): Add AC_CHECK_TOOL for ld.\n+\t(LD_START_STATIC_SPEC): New AC_SUBST, set with ld check.\n+\t(LD_FINISH_STATIC_SPEC): Ditto\n+\t* configure: Regenerated.\n+\t* libgcj.spec.in: Wrap -lgcj in LD_START_STATIC_SPEC and\n+\tLD_FINISH_STATIC_SPEC.\n+\t\n 2006-03-07  Tom Tromey  <tromey@redhat.com>\n \n \tPR libgcj/26103:"}, {"sha": "22cecde97c6e4442ff8765eb3e026121c6c6030f", "filename": "libjava/configure", "status": "modified", "additions": 97, "deletions": 3, "changes": 100, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure?ref=d6c122f73bdb73f53e4ebf913e5c0e402860f429", "patch": "@@ -310,7 +310,7 @@ ac_includes_default=\"\\\n # include <unistd.h>\n #endif\"\n \n-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os build_subdir host_subdir target_subdir libgcj_basedir host host_cpu host_vendor host_os target target_cpu target_vendor target_os target_noncanonical LN_S mkinstalldirs CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LDFLAGS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE AS ac_ct_AS AR ac_ct_AR RANLIB ac_ct_RANLIB MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT LIBGCJ_CFLAGS LIBGCJ_CXXFLAGS LIBGCJ_JAVAFLAGS LIBGCJ_LD_SYMBOLIC LIBGCJDEBUG TOOLKIT XLIB_AWT_TRUE XLIB_AWT_FALSE GTK_AWT_TRUE GTK_AWT_FALSE QT_AWT_TRUE QT_AWT_FALSE GCJH ZIP INCLTDL LIBLTDL DIRLTDL LIBTOOL CXXCPP CPPFLAGS GCJ GCJFLAGS GCJDEPMODE am__fastdepGCJ_TRUE am__fastdepGCJ_FALSE subdirs TESTSUBDIR_TRUE TESTSUBDIR_FALSE JAVA_HOME_SET_TRUE JAVA_HOME_SET_FALSE JAVA_HOME INTERPRETER LIBFFI LIBFFIINCS PLATFORM_INNER_NAT_HDRS CPP EGREP USING_WIN32_PLATFORM_TRUE USING_WIN32_PLATFORM_FALSE USING_POSIX_PLATFORM_TRUE USING_POSIX_PLATFORM_FALSE USING_DARWIN_CRT_TRUE USING_DARWIN_CRT_FALSE SYSTEMSPEC LIBGCJTESTSPEC ZLIBSPEC ZLIBTESTSPEC X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS GTK_CAIRO_TRUE GTK_CAIRO_FALSE PKG_CONFIG CAIRO_CFLAGS CAIRO_LIBS PANGOFT2_CFLAGS PANGOFT2_LIBS extra_ldflags_libjava GCLIBS GCINCS GCDEPS GCSPEC JC1GCSPEC GCTESTSPEC USING_BOEHMGC_TRUE USING_BOEHMGC_FALSE USING_NOGC_TRUE USING_NOGC_FALSE THREADLIBS THREADINCS THREADDEPS THREADSPEC THREADLDFLAGS THREADCXXFLAGS USING_POSIX_THREADS_TRUE USING_POSIX_THREADS_FALSE USING_WIN32_THREADS_TRUE USING_WIN32_THREADS_FALSE USING_NO_THREADS_TRUE USING_NO_THREADS_FALSE HASH_SYNC_SPEC USING_GCC_TRUE USING_GCC_FALSE LIBICONV LTLIBICONV GTK_CFLAGS GTK_LIBS GLIB_CFLAGS GLIB_LIBS LIBART_CFLAGS LIBART_LIBS CLASSPATH_SEPARATOR ac_ct_GCJ ZLIBS SYS_ZLIBS ZINCS DIVIDESPEC CHECKREFSPEC EXCEPTIONSPEC BACKTRACESPEC IEEESPEC NATIVE_TRUE NATIVE_FALSE NEEDS_DATA_START_TRUE NEEDS_DATA_START_FALSE GCC_UNWIND_INCLUDE toolexecdir toolexecmainlibdir toolexeclibdir dbexecdir GCJVERSION gxx_include_dir libstdcxx_incdir ALLOCA PERL SYSDEP_SOURCES here LIBOBJS LTLIBOBJS'\n+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS build build_cpu build_vendor build_os build_subdir host_subdir target_subdir libgcj_basedir host host_cpu host_vendor host_os target target_cpu target_vendor target_os target_noncanonical LN_S mkinstalldirs CC ac_ct_CC EXEEXT OBJEXT CXX ac_ct_CXX CFLAGS CXXFLAGS LDFLAGS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE AS ac_ct_AS LD ac_ct_LD AR ac_ct_AR RANLIB ac_ct_RANLIB MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT LIBGCJ_CFLAGS LIBGCJ_CXXFLAGS LIBGCJ_JAVAFLAGS LIBGCJ_LD_SYMBOLIC LIBGCJDEBUG TOOLKIT XLIB_AWT_TRUE XLIB_AWT_FALSE GTK_AWT_TRUE GTK_AWT_FALSE QT_AWT_TRUE QT_AWT_FALSE GCJH ZIP INCLTDL LIBLTDL DIRLTDL LIBTOOL CXXCPP CPPFLAGS GCJ GCJFLAGS GCJDEPMODE am__fastdepGCJ_TRUE am__fastdepGCJ_FALSE subdirs TESTSUBDIR_TRUE TESTSUBDIR_FALSE JAVA_HOME_SET_TRUE JAVA_HOME_SET_FALSE JAVA_HOME INTERPRETER LIBFFI LIBFFIINCS PLATFORM_INNER_NAT_HDRS CPP EGREP USING_WIN32_PLATFORM_TRUE USING_WIN32_PLATFORM_FALSE USING_POSIX_PLATFORM_TRUE USING_POSIX_PLATFORM_FALSE USING_DARWIN_CRT_TRUE USING_DARWIN_CRT_FALSE SYSTEMSPEC LIBGCJTESTSPEC ZLIBSPEC ZLIBTESTSPEC X_CFLAGS X_PRE_LIBS X_LIBS X_EXTRA_LIBS GTK_CAIRO_TRUE GTK_CAIRO_FALSE PKG_CONFIG CAIRO_CFLAGS CAIRO_LIBS PANGOFT2_CFLAGS PANGOFT2_LIBS extra_ldflags_libjava GCLIBS GCINCS GCDEPS GCSPEC JC1GCSPEC GCTESTSPEC USING_BOEHMGC_TRUE USING_BOEHMGC_FALSE USING_NOGC_TRUE USING_NOGC_FALSE THREADLIBS THREADINCS THREADDEPS THREADSPEC THREADLDFLAGS THREADCXXFLAGS USING_POSIX_THREADS_TRUE USING_POSIX_THREADS_FALSE USING_WIN32_THREADS_TRUE USING_WIN32_THREADS_FALSE USING_NO_THREADS_TRUE USING_NO_THREADS_FALSE HASH_SYNC_SPEC USING_GCC_TRUE USING_GCC_FALSE LIBICONV LTLIBICONV GTK_CFLAGS GTK_LIBS GLIB_CFLAGS GLIB_LIBS LIBART_CFLAGS LIBART_LIBS CLASSPATH_SEPARATOR ac_ct_GCJ ZLIBS SYS_ZLIBS ZINCS DIVIDESPEC CHECKREFSPEC EXCEPTIONSPEC BACKTRACESPEC IEEESPEC NATIVE_TRUE NATIVE_FALSE NEEDS_DATA_START_TRUE NEEDS_DATA_START_FALSE GCC_UNWIND_INCLUDE toolexecdir toolexecmainlibdir toolexeclibdir dbexecdir GCJVERSION gxx_include_dir libstdcxx_incdir ALLOCA PERL SYSDEP_SOURCES LD_START_STATIC_SPEC LD_FINISH_STATIC_SPEC here LIBOBJS LTLIBOBJS'\n ac_subst_files=''\n \n # Initialize some variables set by options.\n@@ -3726,6 +3726,85 @@ else\n   AS=\"$ac_cv_prog_AS\"\n fi\n \n+if test -n \"$ac_tool_prefix\"; then\n+  # Extract the first word of \"${ac_tool_prefix}ld\", so it can be a program name with args.\n+set dummy ${ac_tool_prefix}ld; ac_word=$2\n+echo \"$as_me:$LINENO: checking for $ac_word\" >&5\n+echo $ECHO_N \"checking for $ac_word... $ECHO_C\" >&6\n+if test \"${ac_cv_prog_LD+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  if test -n \"$LD\"; then\n+  ac_cv_prog_LD=\"$LD\" # Let the user override the test.\n+else\n+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR\n+for as_dir in $PATH\n+do\n+  IFS=$as_save_IFS\n+  test -z \"$as_dir\" && as_dir=.\n+  for ac_exec_ext in '' $ac_executable_extensions; do\n+  if $as_executable_p \"$as_dir/$ac_word$ac_exec_ext\"; then\n+    ac_cv_prog_LD=\"${ac_tool_prefix}ld\"\n+    echo \"$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext\" >&5\n+    break 2\n+  fi\n+done\n+done\n+\n+fi\n+fi\n+LD=$ac_cv_prog_LD\n+if test -n \"$LD\"; then\n+  echo \"$as_me:$LINENO: result: $LD\" >&5\n+echo \"${ECHO_T}$LD\" >&6\n+else\n+  echo \"$as_me:$LINENO: result: no\" >&5\n+echo \"${ECHO_T}no\" >&6\n+fi\n+\n+fi\n+if test -z \"$ac_cv_prog_LD\"; then\n+  ac_ct_LD=$LD\n+  # Extract the first word of \"ld\", so it can be a program name with args.\n+set dummy ld; ac_word=$2\n+echo \"$as_me:$LINENO: checking for $ac_word\" >&5\n+echo $ECHO_N \"checking for $ac_word... $ECHO_C\" >&6\n+if test \"${ac_cv_prog_ac_ct_LD+set}\" = set; then\n+  echo $ECHO_N \"(cached) $ECHO_C\" >&6\n+else\n+  if test -n \"$ac_ct_LD\"; then\n+  ac_cv_prog_ac_ct_LD=\"$ac_ct_LD\" # Let the user override the test.\n+else\n+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR\n+for as_dir in $PATH\n+do\n+  IFS=$as_save_IFS\n+  test -z \"$as_dir\" && as_dir=.\n+  for ac_exec_ext in '' $ac_executable_extensions; do\n+  if $as_executable_p \"$as_dir/$ac_word$ac_exec_ext\"; then\n+    ac_cv_prog_ac_ct_LD=\"ld\"\n+    echo \"$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext\" >&5\n+    break 2\n+  fi\n+done\n+done\n+\n+fi\n+fi\n+ac_ct_LD=$ac_cv_prog_ac_ct_LD\n+if test -n \"$ac_ct_LD\"; then\n+  echo \"$as_me:$LINENO: result: $ac_ct_LD\" >&5\n+echo \"${ECHO_T}$ac_ct_LD\" >&6\n+else\n+  echo \"$as_me:$LINENO: result: no\" >&5\n+echo \"${ECHO_T}no\" >&6\n+fi\n+\n+  LD=$ac_ct_LD\n+else\n+  LD=\"$ac_cv_prog_LD\"\n+fi\n+\n if test -n \"$ac_tool_prefix\"; then\n   # Extract the first word of \"${ac_tool_prefix}ar\", so it can be a program name with args.\n set dummy ${ac_tool_prefix}ar; ac_word=$2\n@@ -5589,7 +5668,7 @@ test x\"$pic_mode\" = xno && libtool_flags=\"$libtool_flags --prefer-non-pic\"\n case $host in\n *-*-irix6*)\n   # Find out which ABI we are using.\n-  echo '#line 5592 \"configure\"' > conftest.$ac_ext\n+  echo '#line 5671 \"configure\"' > conftest.$ac_ext\n   if { (eval echo \"$as_me:$LINENO: \\\"$ac_compile\\\"\") >&5\n   (eval $ac_compile) 2>&5\n   ac_status=$?\n@@ -6592,7 +6671,7 @@ if test \"${enable_sjlj_exceptions+set}\" = set; then\n   :\n else\n   cat > conftest.$ac_ext << EOF\n-#line 6595 \"configure\"\n+#line 6674 \"configure\"\n struct S { ~S(); };\n void bar();\n void foo()\n@@ -16729,6 +16808,17 @@ _ACEOF\n \n   fi\n \n+# Check if linker supports static linking on a per library basis\n+LD_START_STATIC_SPEC=\n+LD_FINISH_STATIC_SPEC=\n+if $LD --help 2>&1 | grep -q -e -call_shared ; then\n+  if $LD --help 2>&1 | grep -q -e -non_shared ; then\n+    LD_START_STATIC_SPEC='%{static-libgcj:-non_shared}'\n+    LD_FINISH_STATIC_SPEC='%{static-libgcj:-call_shared}'\n+  fi\n+fi\n+\n+\n \n here=`${PWDCMD-pwd}`\n \n@@ -17624,6 +17714,8 @@ s,@am__fastdepCXX_TRUE@,$am__fastdepCXX_TRUE,;t t\n s,@am__fastdepCXX_FALSE@,$am__fastdepCXX_FALSE,;t t\n s,@AS@,$AS,;t t\n s,@ac_ct_AS@,$ac_ct_AS,;t t\n+s,@LD@,$LD,;t t\n+s,@ac_ct_LD@,$ac_ct_LD,;t t\n s,@AR@,$AR,;t t\n s,@ac_ct_AR@,$ac_ct_AR,;t t\n s,@RANLIB@,$RANLIB,;t t\n@@ -17748,6 +17840,8 @@ s,@libstdcxx_incdir@,$libstdcxx_incdir,;t t\n s,@ALLOCA@,$ALLOCA,;t t\n s,@PERL@,$PERL,;t t\n s,@SYSDEP_SOURCES@,$SYSDEP_SOURCES,;t t\n+s,@LD_START_STATIC_SPEC@,$LD_START_STATIC_SPEC,;t t\n+s,@LD_FINISH_STATIC_SPEC@,$LD_FINISH_STATIC_SPEC,;t t\n s,@here@,$here,;t t\n s,@LIBOBJS@,$LIBOBJS,;t t\n s,@LTLIBOBJS@,$LTLIBOBJS,;t t"}, {"sha": "94a528133aaad599aa763a717f56366c7fa0d401", "filename": "libjava/configure.ac", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fconfigure.ac?ref=d6c122f73bdb73f53e4ebf913e5c0e402860f429", "patch": "@@ -113,6 +113,7 @@ AC_SUBST(LDFLAGS)\n AM_INIT_AUTOMAKE([1.9.0])\n \n AC_CHECK_TOOL(AS, as)\n+AC_CHECK_TOOL(LD, ld)\n AC_CHECK_TOOL(AR, ar)\n AC_CHECK_TOOL(RANLIB, ranlib, :)\n \n@@ -1418,6 +1419,17 @@ fi\n # See if we support thread-local storage.\n GCC_CHECK_TLS\n \n+# Check if linker supports static linking on a per library basis\n+LD_START_STATIC_SPEC=\n+LD_FINISH_STATIC_SPEC=\n+if $LD --help 2>&1 | grep -q -e -call_shared ; then\n+  if $LD --help 2>&1 | grep -q -e -non_shared ; then\n+    LD_START_STATIC_SPEC='%{static-libgcj:-non_shared}'\n+    LD_FINISH_STATIC_SPEC='%{static-libgcj:-call_shared}'\n+  fi\n+fi\n+AC_SUBST(LD_START_STATIC_SPEC)\n+AC_SUBST(LD_FINISH_STATIC_SPEC)\n \n here=`${PWDCMD-pwd}`\n AC_SUBST(here)"}, {"sha": "0af8811b9544475fafbfe59986d8ad42e5690178", "filename": "libjava/libgcj.spec.in", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2Flibgcj.spec.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d6c122f73bdb73f53e4ebf913e5c0e402860f429/libjava%2Flibgcj.spec.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Flibgcj.spec.in?ref=d6c122f73bdb73f53e4ebf913e5c0e402860f429", "patch": "@@ -4,6 +4,6 @@\n # to link with libgcj.\n #\n %rename lib liborig\n-*lib: -lgcj -lm @LIBICONV@ @GCSPEC@ @THREADSPEC@ @ZLIBSPEC@ @SYSTEMSPEC@ %(libgcc) %(liborig)\n+*lib: @LD_START_STATIC_SPEC@ -lgcj @LD_FINISH_STATIC_SPEC@ -lm @LIBICONV@ @GCSPEC@ @THREADSPEC@ @ZLIBSPEC@ @SYSTEMSPEC@ %(libgcc) %(liborig)\n \n *jc1: @HASH_SYNC_SPEC@ @DIVIDESPEC@ @CHECKREFSPEC@ @JC1GCSPEC@ @EXCEPTIONSPEC@ @BACKTRACESPEC@ @IEEESPEC@ -fkeep-inline-functions"}]}