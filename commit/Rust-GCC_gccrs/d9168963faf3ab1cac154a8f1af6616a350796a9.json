{"sha": "d9168963faf3ab1cac154a8f1af6616a350796a9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDkxNjg5NjNmYWYzYWIxY2FjMTU0YThmMWFmNjYxNmEzNTA3OTZhOQ==", "commit": {"author": {"name": "Stan Shebs", "email": "shebs@apple.com", "date": "2005-02-22T23:38:02Z"}, "committer": {"name": "Stan Shebs", "email": "shebs@gcc.gnu.org", "date": "2005-02-22T23:38:02Z"}, "message": "rs6000.c (rs6000_override_options): Default to natural alignment for 64-bit Darwin.\n\n        * config/rs6000/rs6000.c (rs6000_override_options): Default to\n        natural alignment for 64-bit Darwin.\n        (rs6000_parse_alignment_option): Warn about uses of -malign-power\n        on 64-bit Darwin.\n        * doc/invoke.texi: Document this.\n\nFrom-SVN: r95420", "tree": {"sha": "c138a8c9b913e385ffc73ad306ae6605dc43a6b8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c138a8c9b913e385ffc73ad306ae6605dc43a6b8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d9168963faf3ab1cac154a8f1af6616a350796a9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9168963faf3ab1cac154a8f1af6616a350796a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d9168963faf3ab1cac154a8f1af6616a350796a9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d9168963faf3ab1cac154a8f1af6616a350796a9/comments", "author": null, "committer": null, "parents": [{"sha": "38f925677d2204473981350cb0dfd28eb65fd45b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/38f925677d2204473981350cb0dfd28eb65fd45b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/38f925677d2204473981350cb0dfd28eb65fd45b"}], "stats": {"total": 26, "additions": 24, "deletions": 2}, "files": [{"sha": "a8d9d5a174d1dcc384ea49473b9366969a4c1289", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9168963faf3ab1cac154a8f1af6616a350796a9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9168963faf3ab1cac154a8f1af6616a350796a9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d9168963faf3ab1cac154a8f1af6616a350796a9", "patch": "@@ -1,3 +1,11 @@\n+2005-02-22  Stan Shebs  <shebs@apple.com>\n+\n+\t* config/rs6000/rs6000.c (rs6000_override_options): Default to\n+\tnatural alignment for 64-bit Darwin.\n+\t(rs6000_parse_alignment_option): Warn about uses of -malign-power\n+\ton 64-bit Darwin.\n+\t* doc/invoke.texi: Document this.\n+\n 2005-02-22  DJ Delorie  <dj@redhat.com>\n \n \t* c-common.c (c_common_type_for_mode): Pass the mode's precision"}, {"sha": "ea5c0108413ff8a20d26304b7a939bb5841ea770", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 12, "deletions": 1, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9168963faf3ab1cac154a8f1af6616a350796a9/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9168963faf3ab1cac154a8f1af6616a350796a9/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=d9168963faf3ab1cac154a8f1af6616a350796a9", "patch": "@@ -1316,6 +1316,8 @@ rs6000_override_options (const char *default_cpu)\n #if TARGET_MACHO\n       darwin_one_byte_bool = \"\";\n #endif\n+      /* Default to natural alignment, for better performance.  */\n+      rs6000_alignment_flags = MASK_ALIGN_NATURAL;\n     }\n \n   /* Handle -mabi= options.  */\n@@ -1684,7 +1686,16 @@ rs6000_parse_alignment_option (void)\n   if (rs6000_alignment_string == 0)\n     return;\n   else if (! strcmp (rs6000_alignment_string, \"power\"))\n-    rs6000_alignment_flags = MASK_ALIGN_POWER;\n+    {\n+      /* On 64-bit Darwin, power alignment is ABI-incompatible with\n+\t some C library functions, so warn about it. The flag may be\n+\t useful for performance studies from time to time though, so\n+\t don't disable it entirely.  */\n+      if (DEFAULT_ABI == ABI_DARWIN && TARGET_64BIT)\n+\twarning (\"-malign-power is not supported for 64-bit Darwin;\"\n+\t\t \" it is incompatible with the installed C and C++ libraries\");\n+      rs6000_alignment_flags = MASK_ALIGN_POWER;\n+    }\n   else if (! strcmp (rs6000_alignment_string, \"natural\"))\n     rs6000_alignment_flags = MASK_ALIGN_NATURAL;\n   else"}, {"sha": "6f13ecac5eeb9c0a418f8435457f5b0830eb6e50", "filename": "gcc/doc/invoke.texi", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d9168963faf3ab1cac154a8f1af6616a350796a9/gcc%2Fdoc%2Finvoke.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d9168963faf3ab1cac154a8f1af6616a350796a9/gcc%2Fdoc%2Finvoke.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdoc%2Finvoke.texi?ref=d9168963faf3ab1cac154a8f1af6616a350796a9", "patch": "@@ -10528,12 +10528,15 @@ option are incompatible.\n @itemx -malign-power\n @opindex malign-natural\n @opindex malign-power\n-On AIX, Darwin, and 64-bit PowerPC GNU/Linux, the option\n+On AIX, 32-bit Darwin, and 64-bit PowerPC GNU/Linux, the option\n @option{-malign-natural} overrides the ABI-defined alignment of larger\n types, such as floating-point doubles, on their natural size-based boundary.\n The option @option{-malign-power} instructs GCC to follow the ABI-specified\n alignment rules.  GCC defaults to the standard alignment defined in the ABI@.\n \n+On 64-bit Darwin, natural alignment is the default, and @option{-malign-power}\n+is not supported.\n+\n @item -msoft-float\n @itemx -mhard-float\n @opindex msoft-float"}]}