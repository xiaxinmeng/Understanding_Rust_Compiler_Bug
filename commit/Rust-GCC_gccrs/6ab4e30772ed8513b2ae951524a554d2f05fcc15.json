{"sha": "6ab4e30772ed8513b2ae951524a554d2f05fcc15", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmFiNGUzMDc3MmVkODUxM2IyYWU5NTE1MjRhNTU0ZDJmMDVmY2MxNQ==", "commit": {"author": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2010-06-15T19:11:59Z"}, "committer": {"name": "Sebastian Pop", "email": "spop@gcc.gnu.org", "date": "2010-06-15T19:11:59Z"}, "message": "Fix PR44391: use size_one_node for pointer types.\n\n2010-06-15  Sebastian Pop  <sebastian.pop@amd.com>\n\n\tPR middle-end/44391\n\t* graphite-clast-to-gimple.c (graphite_create_new_loop_guard): Use\n\tsize_one_node for pointer types.  Do not call gmp_cst_to_tree.\n\n\t* gcc.dg/graphite/pr44391.c: New.\n\nFrom-SVN: r160803", "tree": {"sha": "1c826e17388a4fe39e11ce72d6aa5f01156f43f2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c826e17388a4fe39e11ce72d6aa5f01156f43f2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6ab4e30772ed8513b2ae951524a554d2f05fcc15", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ab4e30772ed8513b2ae951524a554d2f05fcc15", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6ab4e30772ed8513b2ae951524a554d2f05fcc15", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6ab4e30772ed8513b2ae951524a554d2f05fcc15/comments", "author": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "committer": {"login": "sebpop", "id": 568397, "node_id": "MDQ6VXNlcjU2ODM5Nw==", "avatar_url": "https://avatars.githubusercontent.com/u/568397?v=4", "gravatar_id": "", "url": "https://api.github.com/users/sebpop", "html_url": "https://github.com/sebpop", "followers_url": "https://api.github.com/users/sebpop/followers", "following_url": "https://api.github.com/users/sebpop/following{/other_user}", "gists_url": "https://api.github.com/users/sebpop/gists{/gist_id}", "starred_url": "https://api.github.com/users/sebpop/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/sebpop/subscriptions", "organizations_url": "https://api.github.com/users/sebpop/orgs", "repos_url": "https://api.github.com/users/sebpop/repos", "events_url": "https://api.github.com/users/sebpop/events{/privacy}", "received_events_url": "https://api.github.com/users/sebpop/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "94bff63216c58605147ef22357d3bb48eee999ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94bff63216c58605147ef22357d3bb48eee999ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94bff63216c58605147ef22357d3bb48eee999ae"}], "stats": {"total": 41, "additions": 26, "deletions": 15}, "files": [{"sha": "440d145a2916bb2f278e1eb2c2bab9604e8d33d9", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6ab4e30772ed8513b2ae951524a554d2f05fcc15", "patch": "@@ -1,9 +1,15 @@\n+2010-06-15  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\tPR middle-end/44391\n+\t* graphite-clast-to-gimple.c (graphite_create_new_loop_guard): Use\n+\tsize_one_node for pointer types.  Do not call gmp_cst_to_tree.\n+\n 2010-06-15  Richard Guenther  <rguenther@suse.de>\n \n \t* tree-ssa-pre.c (eliminate): Handle PHI elimination to constants.\n \n 2010-06-15  Paul Brook  <paul@codesourcery.com>\n- \n+\n \t* config/arm/arm.c (use_vfp_abi): Add sorry() for Thumb-1\n \thard-float ABI.\n \n@@ -196,7 +202,7 @@\n \n 2010-06-14  Ira Rosen  <irar@il.ibm.com>\n \n-\tPR tree-optimization/44507 \n+\tPR tree-optimization/44507\n \t* tree-vect-loop.c (get_initial_def_for_reduction): Use -1\n \tto build initial vector for BIT_AND_EXPR.\n \t* tree-vect-slp.c (vect_get_constant_vectors): Likewise."}, {"sha": "b6b8d3134b12b939fcf270a251d78e5e46e50283", "filename": "gcc/graphite-clast-to-gimple.c", "status": "modified", "additions": 5, "deletions": 12, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2Fgraphite-clast-to-gimple.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2Fgraphite-clast-to-gimple.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgraphite-clast-to-gimple.c?ref=6ab4e30772ed8513b2ae951524a554d2f05fcc15", "patch": "@@ -991,6 +991,7 @@ translate_clast_user (sese region, struct clast_user_stmt *stmt, edge next_e,\n \n /* Creates a new if region protecting the loop to be executed, if the execution\n    count is zero (lb > ub).  */\n+\n static edge\n graphite_create_new_loop_guard (sese region, edge entry_edge,\n \t\t\t\tstruct clast_for *stmt,\n@@ -1008,22 +1009,14 @@ graphite_create_new_loop_guard (sese region, edge entry_edge,\n \t\t\t\t     newivs_index, params_index);\n   tree ub = clast_to_gcc_expression (type, stmt->UB, region, newivs,\n \t\t\t\t     newivs_index, params_index);\n-  tree ub_one;\n-\n+  tree one = POINTER_TYPE_P (type) ? size_one_node\n+    : fold_convert (type, integer_one_node);\n   /* Adding +1 and using LT_EXPR helps with loop latches that have a\n      loop iteration count of \"PARAMETER - 1\".  For PARAMETER == 0 this becomes\n      2^{32|64}, and the condition lb <= ub is true, even if we do not want this.\n      However lb < ub + 1 is false, as expected.  */\n-  tree one;\n-  mpz_t gmp_one;\n-  \n-  mpz_init (gmp_one);\n-  mpz_set_si (gmp_one, 1);\n-  one = gmp_cst_to_tree (type, gmp_one);\n-  mpz_clear (gmp_one);\n-\n-  ub_one = fold_build2 (POINTER_TYPE_P (type) ? POINTER_PLUS_EXPR : PLUS_EXPR,\n-\t\t\ttype, ub, one);\n+  tree ub_one = fold_build2 (POINTER_TYPE_P (type) ? POINTER_PLUS_EXPR\n+\t\t\t     : PLUS_EXPR, type, ub, one);\n \n   /* When ub + 1 wraps around, use lb <= ub.  */\n   if (integer_zerop (ub_one))"}, {"sha": "60d29a12839c022967c8f772cfe8ac632d5c39ab", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6ab4e30772ed8513b2ae951524a554d2f05fcc15", "patch": "@@ -1,3 +1,8 @@\n+2010-06-15  Sebastian Pop  <sebastian.pop@amd.com>\n+\n+\tPR middle-end/44391\n+\t* gcc.dg/graphite/pr44391.c: New.\n+\n 2010-06-15  Janus Weil  <janus@gcc.gnu.org>\n \n \tPR fortran/43388\n@@ -49,7 +54,7 @@\n \n 2010-06-14  Ira Rosen  <irar@il.ibm.com>\n \n-\tPR tree-optimization/44507 \n+\tPR tree-optimization/44507\n \t* gcc.dg/vect/pr44507.c: New test.\n \n 2010-06-13  H.J. Lu  <hongjiu.lu@intel.com>"}, {"sha": "91b3afa175ac1cb85410597e194370eabd9fe933", "filename": "gcc/testsuite/gcc.dg/graphite/pr44391.c", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr44391.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6ab4e30772ed8513b2ae951524a554d2f05fcc15/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr44391.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fgraphite%2Fpr44391.c?ref=6ab4e30772ed8513b2ae951524a554d2f05fcc15", "patch": "@@ -0,0 +1,7 @@\n+/* { dg-options \"-Os -m32 -fgraphite-identity -ffast-math\" } */\n+\n+void byte_insert_op1 (unsigned char *loc, unsigned char *end, unsigned *pto)\n+{\n+  while (end != loc)\n+    *pto = *--end;\n+}"}]}