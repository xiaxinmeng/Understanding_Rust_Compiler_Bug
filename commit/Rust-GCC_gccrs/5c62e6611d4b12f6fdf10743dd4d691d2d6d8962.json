{"sha": "5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWM2MmU2NjExZDRiMTJmNmZkZjEwNzQzZGQ0ZDY5MWQyZDZkODk2Mg==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2011-03-03T17:07:28Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2011-03-03T17:07:28Z"}, "message": "re PR c++/47974 (ICE: tree check: expected tree_vec, have error_mark in tsubst_template_args, at cp/pt.c:8969 on invalid code)\n\n/cp\n2011-03-03  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/47974\n\t* pt.c (tsubst_template_args): Check argument t for error_mark_node.\n\n/testsuite\n2011-03-03  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/47974\n\t* g++.dg/template/crash106.C: New.\n\nFrom-SVN: r170658", "tree": {"sha": "ee43198a70116b3b2281c862b023d96214d4a63b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee43198a70116b3b2281c862b023d96214d4a63b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/comments", "author": null, "committer": null, "parents": [{"sha": "ff4bfb1056a816c881c9ffb0314b2ff202b32d03", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ff4bfb1056a816c881c9ffb0314b2ff202b32d03", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ff4bfb1056a816c881c9ffb0314b2ff202b32d03"}], "stats": {"total": 33, "additions": 30, "deletions": 3}, "files": [{"sha": "747457a193787de436dabcd09efe8126551ae978", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "patch": "@@ -1,3 +1,8 @@\n+2011-03-03  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/47974\n+\t* pt.c (tsubst_template_args): Check argument t for error_mark_node.\n+\n 2011-03-03  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/47950"}, {"sha": "c52bb74eba80183b906e8497b7da6616b9d031ff", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 8, "deletions": 3, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "patch": "@@ -8966,9 +8966,14 @@ static tree\n tsubst_template_args (tree t, tree args, tsubst_flags_t complain, tree in_decl)\n {\n   tree orig_t = t;\n-  int len = TREE_VEC_LENGTH (t);\n-  int need_new = 0, i, expanded_len_adjust = 0, out;\n-  tree *elts = XALLOCAVEC (tree, len);\n+  int len, need_new = 0, i, expanded_len_adjust = 0, out;\n+  tree *elts;\n+\n+  if (t == error_mark_node)\n+    return error_mark_node;\n+\n+  len = TREE_VEC_LENGTH (t);\n+  elts = XALLOCAVEC (tree, len);\n \n   for (i = 0; i < len; i++)\n     {"}, {"sha": "69b7569c61542ca4da8634c6c44f901b6ec1a681", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "patch": "@@ -1,3 +1,8 @@\n+2011-03-03  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/47974\n+\t* g++.dg/template/crash106.C: New.\n+\n 2011-03-03  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR c/47963"}, {"sha": "c2d117e03a07fcc50688c499c9348e29d7a69c17", "filename": "gcc/testsuite/g++.dg/template/crash106.C", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash106.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c62e6611d4b12f6fdf10743dd4d691d2d6d8962/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash106.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Fcrash106.C?ref=5c62e6611d4b12f6fdf10743dd4d691d2d6d8962", "patch": "@@ -0,0 +1,12 @@\n+// PR c++/47974\n+\n+typedef double T;\n+\n+struct A\n+{\n+  template<T> void foo(); // { dg-error \"type\" }\n+};\n+\n+template<T N = 0, void (A::*)() = &A::foo<N> > struct B {}; // { dg-error \"type|declared\" }\n+\n+B<> b; // { dg-error \"type|declaration\" }"}]}