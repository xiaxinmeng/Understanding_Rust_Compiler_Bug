{"sha": "903b0a8b6833a5b182461bc73d0f84423ae8c046", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OTAzYjBhOGI2ODMzYTViMTgyNDYxYmM3M2QwZjg0NDIzYWU4YzA0Ng==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2011-06-12T16:39:38Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2011-06-12T16:39:38Z"}, "message": "re PR middle-end/49378 (C++ is broken)\n\n\tPR middle-end/49378\n\t* ipa.c (cgraph_non_local_node_p_1, cgraph_local_node_p): Rule out\n\taliases and thunks.\n\nFrom-SVN: r174969", "tree": {"sha": "0217c78b6609de642a00c0b20891254d588bb1c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0217c78b6609de642a00c0b20891254d588bb1c2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/903b0a8b6833a5b182461bc73d0f84423ae8c046", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/903b0a8b6833a5b182461bc73d0f84423ae8c046", "html_url": "https://github.com/Rust-GCC/gccrs/commit/903b0a8b6833a5b182461bc73d0f84423ae8c046", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/903b0a8b6833a5b182461bc73d0f84423ae8c046/comments", "author": null, "committer": null, "parents": [{"sha": "8a752dfea6f512ecb19a7f2fd535b8862ef3dbe2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8a752dfea6f512ecb19a7f2fd535b8862ef3dbe2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8a752dfea6f512ecb19a7f2fd535b8862ef3dbe2"}], "stats": {"total": 16, "additions": 15, "deletions": 1}, "files": [{"sha": "2bcc01b0e3c2bf2eeb449f3201afde14f8dccbd5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/903b0a8b6833a5b182461bc73d0f84423ae8c046/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/903b0a8b6833a5b182461bc73d0f84423ae8c046/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=903b0a8b6833a5b182461bc73d0f84423ae8c046", "patch": "@@ -1,3 +1,9 @@\n+2011-06-11  Jan Hubicka  <jh@suse.cz>\n+\n+\tPR middle-end/49378\n+\t* ipa.c (cgraph_non_local_node_p_1, cgraph_local_node_p): Rule out\n+\taliases and thunks.\n+\n 2011-06-12  Ira Rosen  <ira.rosen@linaro.org>\n \n \t* tree-vect-data-refs.c (vect_peeling_hash_get_most_frequent):"}, {"sha": "3f7dac33cf457eea5049b54adc3f0df260ab325a", "filename": "gcc/ipa.c", "status": "modified", "additions": 9, "deletions": 1, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/903b0a8b6833a5b182461bc73d0f84423ae8c046/gcc%2Fipa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/903b0a8b6833a5b182461bc73d0f84423ae8c046/gcc%2Fipa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa.c?ref=903b0a8b6833a5b182461bc73d0f84423ae8c046", "patch": "@@ -119,7 +119,9 @@ process_references (struct ipa_ref_list *list,\n static bool\n cgraph_non_local_node_p_1 (struct cgraph_node *node, void *data ATTRIBUTE_UNUSED)\n {\n+   /* FIXME: Aliases can be local, but i386 gets thunks wrong then.  */\n    return !(cgraph_only_called_directly_or_aliased_p (node)\n+\t    && !ipa_ref_has_aliases_p (&node->ref_list)\n \t    && node->analyzed\n \t    && !DECL_EXTERNAL (node->decl)\n \t    && !node->local.externally_visible\n@@ -132,7 +134,13 @@ cgraph_non_local_node_p_1 (struct cgraph_node *node, void *data ATTRIBUTE_UNUSED\n static bool\n cgraph_local_node_p (struct cgraph_node *node)\n {\n-   return !cgraph_for_node_and_aliases (cgraph_function_or_thunk_node (node, NULL),\n+   struct cgraph_node *n = cgraph_function_or_thunk_node (node, NULL);\n+\n+   /* FIXME: thunks can be considered local, but we need prevent i386\n+      from attempting to change calling convention of them.  */\n+   if (n->thunk.thunk_p)\n+     return false;\n+   return !cgraph_for_node_and_aliases (n,\n \t\t\t\t\tcgraph_non_local_node_p_1, NULL, true);\n \t\t\t\t\t\n }"}]}