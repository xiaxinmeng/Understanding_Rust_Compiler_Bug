{"sha": "a7a53ca582735ec356bb273b2d17aee0274896d1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTdhNTNjYTU4MjczNWVjMzU2YmIyNzNiMmQxN2FlZTAyNzQ4OTZkMQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2006-10-29T10:27:39Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2006-10-29T10:27:39Z"}, "message": "re PR fortran/29629 (ICE on OpenMP-enabled program (gfc_conv_variable, at fortran/trans-expr.c:404))\n\n\tPR fortran/29629\n\t* trans-openmp.c (gfc_trans_omp_array_reduction): Set attr.flavor\n\tof init_val_sym and outer_sym to FL_VARIABLE.\n\n\t* testsuite/libgomp.fortran/pr29629.f90: New test.\n\nFrom-SVN: r118134", "tree": {"sha": "59c440f9db09227ba377e82b3faec95f9cd560ba", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/59c440f9db09227ba377e82b3faec95f9cd560ba"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a7a53ca582735ec356bb273b2d17aee0274896d1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7a53ca582735ec356bb273b2d17aee0274896d1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a7a53ca582735ec356bb273b2d17aee0274896d1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a7a53ca582735ec356bb273b2d17aee0274896d1/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3a0572072d2b6a49fa491744aea520cda26e85c3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3a0572072d2b6a49fa491744aea520cda26e85c3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3a0572072d2b6a49fa491744aea520cda26e85c3"}], "stats": {"total": 33, "additions": 33, "deletions": 0}, "files": [{"sha": "31c6c6f471363d16b3f586a47d8c9bf46df10d18", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7a53ca582735ec356bb273b2d17aee0274896d1/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7a53ca582735ec356bb273b2d17aee0274896d1/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=a7a53ca582735ec356bb273b2d17aee0274896d1", "patch": "@@ -1,3 +1,9 @@\n+2006-10-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/29629\n+\t* trans-openmp.c (gfc_trans_omp_array_reduction): Set attr.flavor\n+\tof init_val_sym and outer_sym to FL_VARIABLE.\n+\n 2006-10-29  Kazu Hirata  <kazu@codesourcery.com>\n \n \t* intrinsic.texi: Fix a typo."}, {"sha": "fa8be1d72ecfd2ab09d66e51aaa6d9f56f8c922a", "filename": "gcc/fortran/trans-openmp.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7a53ca582735ec356bb273b2d17aee0274896d1/gcc%2Ffortran%2Ftrans-openmp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7a53ca582735ec356bb273b2d17aee0274896d1/gcc%2Ffortran%2Ftrans-openmp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-openmp.c?ref=a7a53ca582735ec356bb273b2d17aee0274896d1", "patch": "@@ -300,6 +300,7 @@ gfc_trans_omp_array_reduction (tree c, gfc_symbol *sym, locus where)\n   init_val_sym.ts = sym->ts;\n   init_val_sym.attr.referenced = 1;\n   init_val_sym.declared_at = where;\n+  init_val_sym.attr.flavor = FL_VARIABLE;\n   backend_decl = omp_reduction_init (c, gfc_sym_type (&init_val_sym));\n   init_val_sym.backend_decl = backend_decl;\n \n@@ -308,6 +309,7 @@ gfc_trans_omp_array_reduction (tree c, gfc_symbol *sym, locus where)\n   outer_sym.as = gfc_copy_array_spec (sym->as);\n   outer_sym.attr.dummy = 0;\n   outer_sym.attr.result = 0;\n+  outer_sym.attr.flavor = FL_VARIABLE;\n   outer_sym.backend_decl = create_tmp_var_raw (TREE_TYPE (decl), NULL);\n \n   /* Create fake symtrees for it.  */"}, {"sha": "139b7fc5c1bbaf559a37bef1d34f0498058090d0", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7a53ca582735ec356bb273b2d17aee0274896d1/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7a53ca582735ec356bb273b2d17aee0274896d1/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=a7a53ca582735ec356bb273b2d17aee0274896d1", "patch": "@@ -1,3 +1,8 @@\n+2006-10-29  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/29629\n+\t* testsuite/libgomp.fortran/pr29629.f90: New test.\n+\n 2006-10-24  Eric Botcazou  <ebotcazou@libertysurf.fr>\n \n \tPR libgomp/29494"}, {"sha": "9ccddffb03921fa68062362518320c98affc5a86", "filename": "libgomp/testsuite/libgomp.fortran/pr29629.f90", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a7a53ca582735ec356bb273b2d17aee0274896d1/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr29629.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a7a53ca582735ec356bb273b2d17aee0274896d1/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr29629.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr29629.f90?ref=a7a53ca582735ec356bb273b2d17aee0274896d1", "patch": "@@ -0,0 +1,20 @@\n+! PR fortran/29629\n+! { dg-do run }\n+\n+program pr29629\n+  integer :: n\n+  n = 10000\n+  if (any (func(n).ne.10000)) call abort\n+  contains\n+    function func(n)\n+      integer, intent(in) :: n\n+      integer, dimension(n) :: func\n+      integer :: k\n+      func = 0\n+!$omp parallel do private(k), reduction(+:func), num_threads(4)\n+      do k = 1, n\n+        func = func + 1\n+      end do\n+!$omp end parallel do\n+    end function\n+end program"}]}