{"sha": "a50e038893fe801178f71f09bda01910df50394e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTUwZTAzODg5M2ZlODAxMTc4ZjcxZjA5YmRhMDE5MTBkZjUwMzk0ZQ==", "commit": {"author": {"name": "Michael Meissner", "email": "meissner@linux.ibm.com", "date": "2019-12-17T22:11:55Z"}, "committer": {"name": "Michael Meissner", "email": "meissner@gcc.gnu.org", "date": "2019-12-17T22:11:55Z"}, "message": "Use PLI to load up large constants if -mcpu=future.\n\n2019-12-17  Michael Meissner  <meissner@linux.ibm.com>\n\n\t* config/rs6000/rs6000.c (num_insns_constant_gpr): Return 1 if the\n\tconstant can be loaded with PLI if -mcpu=future.\n\t* config/rs6000/rs6000.md (movdi_internal64): Add alternative to\n\tuse PLI to load up 34-bit constants if -mcpu=future.\n\nFrom-SVN: r279474", "tree": {"sha": "0a42defa3f1b4592e11aca12a83382b94fcf54a9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0a42defa3f1b4592e11aca12a83382b94fcf54a9"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a50e038893fe801178f71f09bda01910df50394e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50e038893fe801178f71f09bda01910df50394e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a50e038893fe801178f71f09bda01910df50394e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a50e038893fe801178f71f09bda01910df50394e/comments", "author": null, "committer": null, "parents": [{"sha": "4f05d85a22351720d860afb788cc5cdaffca92ca", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4f05d85a22351720d860afb788cc5cdaffca92ca", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4f05d85a22351720d860afb788cc5cdaffca92ca"}], "stats": {"total": 24, "additions": 18, "deletions": 6}, "files": [{"sha": "233771c4f83497d1712429ee4b932ec214ee03de", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50e038893fe801178f71f09bda01910df50394e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50e038893fe801178f71f09bda01910df50394e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a50e038893fe801178f71f09bda01910df50394e", "patch": "@@ -1,3 +1,10 @@\n+2019-12-17  Michael Meissner  <meissner@linux.ibm.com>\n+\n+\t* config/rs6000/rs6000.c (num_insns_constant_gpr): Return 1 if the\n+\tconstant can be loaded with PLI if -mcpu=future.\n+\t* config/rs6000/rs6000.md (movdi_internal64): Add alternative to\n+\tuse PLI to load up 34-bit constants if -mcpu=future.\n+\n 2019-12-17  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR target/92841"}, {"sha": "002a8d89ccd56bafeb549961f5fb6f0aea751227", "filename": "gcc/config/rs6000/rs6000.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50e038893fe801178f71f09bda01910df50394e/gcc%2Fconfig%2Frs6000%2Frs6000.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50e038893fe801178f71f09bda01910df50394e/gcc%2Fconfig%2Frs6000%2Frs6000.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.c?ref=a50e038893fe801178f71f09bda01910df50394e", "patch": "@@ -5565,6 +5565,10 @@ num_insns_constant_gpr (HOST_WIDE_INT value)\n \t   && (value >> 31 == -1 || value >> 31 == 0))\n     return 1;\n \n+  /* PADDI can support up to 34 bit signed integers.  */\n+  else if (TARGET_PREFIXED_ADDR && SIGNED_34BIT_OFFSET_P (value))\n+    return 1;\n+\n   else if (TARGET_POWERPC64)\n     {\n       HOST_WIDE_INT low  = ((value & 0xffffffff) ^ 0x80000000) - 0x80000000;"}, {"sha": "31819837f7e0ad406dd1cdcafeb6ab53de8b3c31", "filename": "gcc/config/rs6000/rs6000.md", "status": "modified", "additions": 7, "deletions": 6, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a50e038893fe801178f71f09bda01910df50394e/gcc%2Fconfig%2Frs6000%2Frs6000.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a50e038893fe801178f71f09bda01910df50394e/gcc%2Fconfig%2Frs6000%2Frs6000.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.md?ref=a50e038893fe801178f71f09bda01910df50394e", "patch": "@@ -8828,7 +8828,7 @@\n })\n \n ;;\t   GPR store   GPR load    GPR move\n-;;\t   GPR li      GPR lis     GPR #\n+;;\t   GPR li      GPR lis     GPR pli     GPR #\n ;;\t   FPR store   FPR load    FPR move\n ;;\t   AVX store   AVX store   AVX load    AVX load    VSX move\n ;;\t   P9 0        P9 -1       AVX 0/-1    VSX 0       VSX -1\n@@ -8838,7 +8838,7 @@\n (define_insn \"*movdi_internal64\"\n   [(set (match_operand:DI 0 \"nonimmediate_operand\"\n \t  \"=YZ,        r,          r,\n-\t   r,          r,          r,\n+\t   r,          r,          r,          r,\n \t   m,          ^d,         ^d,\n \t   wY,         Z,          $v,         $v,         ^wa,\n \t   wa,         wa,         v,          wa,         wa,\n@@ -8847,7 +8847,7 @@\n \t   ?r,         ?wa\")\n \t(match_operand:DI 1 \"input_operand\"\n \t  \"r,          YZ,         r,\n-\t   I,          L,          nF,\n+\t   I,          L,          eI,         nF,\n \t   ^d,         m,          ^d,\n \t   ^v,         $v,         wY,         Z,          ^wa,\n \t   Oj,         wM,         OjwM,       Oj,         wM,\n@@ -8863,6 +8863,7 @@\n    mr %0,%1\n    li %0,%1\n    lis %0,%v1\n+   li %0,%1\n    #\n    stfd%U0%X0 %1,%0\n    lfd%U1%X1 %0,%1\n@@ -8886,7 +8887,7 @@\n    mtvsrd %x0,%1\"\n   [(set_attr \"type\"\n \t  \"store,      load,       *,\n-\t   *,          *,          *,\n+\t   *,          *,          *,          *,\n \t   fpstore,    fpload,     fpsimple,\n \t   fpstore,    fpstore,    fpload,     fpload,     veclogical,\n \t   vecsimple,  vecsimple,  vecsimple,  veclogical, veclogical,\n@@ -8896,7 +8897,7 @@\n    (set_attr \"size\" \"64\")\n    (set_attr \"length\"\n \t  \"*,          *,          *,\n-\t   *,          *,          20,\n+\t   *,          *,          *,          20,\n \t   *,          *,          *,\n \t   *,          *,          *,          *,          *,\n \t   *,          *,          *,          *,          *,\n@@ -8905,7 +8906,7 @@\n \t   *,          *\")\n    (set_attr \"isa\"\n \t  \"*,          *,          *,\n-\t   *,          *,          *,\n+\t   *,          *,          fut,        *,\n \t   *,          *,          *,\n \t   p9v,        p7v,        p9v,        p7v,        *,\n \t   p9v,        p9v,        p7v,        *,          *,"}]}