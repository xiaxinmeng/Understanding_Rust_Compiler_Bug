{"sha": "9f9ca914cc827c34816c71afb04e920ad5243156", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWY5Y2E5MTRjYzgyN2MzNDgxNmM3MWFmYjA0ZTkyMGFkNTI0MzE1Ng==", "commit": {"author": {"name": "Jeff Law", "email": "law@redhat.com", "date": "2011-01-11T14:10:54Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "2011-01-11T14:10:54Z"}, "message": "re PR tree-optimization/47086 (ICE: verify_flow_info failed: BB 3 can not throw but has an EH edge with -O -fexceptions -fnon-call-exceptions -ftrapv)\n\n\n\t* PR tree-optimization/47086\n\t* tree-ssa-loop-ivopts.c (find_givs_in_stmt_scev): Do not record\n\tIVs from statements that might throw.\n\n\t* PR tree-optimization/47086\n\t* gcc.dg/pr47086.c: New test.\n\nFrom-SVN: r168659", "tree": {"sha": "7d96c9b801698d379786ad586c07da8c7dc931f8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d96c9b801698d379786ad586c07da8c7dc931f8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9f9ca914cc827c34816c71afb04e920ad5243156", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f9ca914cc827c34816c71afb04e920ad5243156", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9f9ca914cc827c34816c71afb04e920ad5243156", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9f9ca914cc827c34816c71afb04e920ad5243156/comments", "author": null, "committer": null, "parents": [{"sha": "a67e7daab5abd73d150874c62812ae94f093fbe3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a67e7daab5abd73d150874c62812ae94f093fbe3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a67e7daab5abd73d150874c62812ae94f093fbe3"}], "stats": {"total": 33, "additions": 32, "deletions": 1}, "files": [{"sha": "b372b6c7e68197a4e3dbb9f5178251f211fb6022", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=9f9ca914cc827c34816c71afb04e920ad5243156", "patch": "@@ -1,3 +1,9 @@\n+2011-01-11  Jeff Law  <law@redhat.com>\n+\n+\t* PR tree-optimization/47086\n+\t* tree-ssa-loop-ivopts.c (find_givs_in_stmt_scev): Do not record\n+\tIVs from statements that might throw.\n+\n 2011-01-10  Jan Hubicka  <jh@suse.cz>\n \n \tPR lto/45375"}, {"sha": "710431c8424bb277dd16fce8cf37b6350b37c602", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=9f9ca914cc827c34816c71afb04e920ad5243156", "patch": "@@ -1,3 +1,8 @@\n+2011-01-11  Jeff Law <law@redhat.com>\n+\n+\t* PR tree-optimization/47086\n+\t* gcc.dg/pr47086.c: New test.\n+\n 2011-01-11  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/46658"}, {"sha": "71743fe4fe5cdf9c6a4d4ac31cdbb02a8a82a223", "filename": "gcc/testsuite/gcc.dg/pr47086.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2Ftestsuite%2Fgcc.dg%2Fpr47086.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2Ftestsuite%2Fgcc.dg%2Fpr47086.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr47086.c?ref=9f9ca914cc827c34816c71afb04e920ad5243156", "patch": "@@ -0,0 +1,14 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O -fexceptions -fnon-call-exceptions -ftrapv\" } */\n+\n+void\n+foo ()\n+{\n+  int n = 0;\n+  while (1)\n+    {\n+      int i[n % 1];\n+      n++;\n+    }\n+}\n+"}, {"sha": "479b46fb8dcd450963f3fabcc7f723814bf78667", "filename": "gcc/tree-ssa-loop-ivopts.c", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2Ftree-ssa-loop-ivopts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9f9ca914cc827c34816c71afb04e920ad5243156/gcc%2Ftree-ssa-loop-ivopts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivopts.c?ref=9f9ca914cc827c34816c71afb04e920ad5243156", "patch": "@@ -1,5 +1,5 @@\n /* Induction variable optimizations.\n-   Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n+   Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -1102,6 +1102,12 @@ find_givs_in_stmt_scev (struct ivopts_data *data, gimple stmt, affine_iv *iv)\n       || contains_abnormal_ssa_name_p (iv->step))\n     return false;\n \n+  /* If STMT could throw, then do not consider STMT as defining a GIV.  \n+     While this will suppress optimizations, we can not safely delete this\n+     GIV and associated statements, even if it appears it is not used.  */\n+  if (stmt_could_throw_p (stmt))\n+    return false;\n+\n   return true;\n }\n "}]}