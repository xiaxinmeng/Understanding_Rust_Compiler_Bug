{"sha": "0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGY5Zjk1YWRlYTYzODZlMDJmM2ZmM2RhNjFiMDZiMWQ3ZmNkN2ZhMA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-02-10T19:21:20Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-02-10T19:21:20Z"}, "message": "Don't crash on field reference to erroneous struct.\n\nFrom-SVN: r170020", "tree": {"sha": "4f774eb7fb12274a9cbabfdeab198471f2cf7ab3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4f774eb7fb12274a9cbabfdeab198471f2cf7ab3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0/comments", "author": null, "committer": null, "parents": [{"sha": "26d061fc233db50e5b599a10d092dfed8417a023", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/26d061fc233db50e5b599a10d092dfed8417a023", "html_url": "https://github.com/Rust-GCC/gccrs/commit/26d061fc233db50e5b599a10d092dfed8417a023"}], "stats": {"total": 10, "additions": 8, "deletions": 2}, "files": [{"sha": "d17b173a6ab48bbb9e81892edf370b09404f9f3a", "filename": "gcc/go/gofrontend/expressions.cc", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc?ref=0f9f95adea6386e02f3ff3da61b06b1d7fcd7fa0", "patch": "@@ -9946,7 +9946,10 @@ Expression::make_map_index(Expression* map, Expression* index,\n Type*\n Field_reference_expression::do_type()\n {\n-  Struct_type* struct_type = this->expr_->type()->struct_type();\n+  Type* type = this->expr_->type();\n+  if (type->is_error_type())\n+    return type;\n+  Struct_type* struct_type = type->struct_type();\n   gcc_assert(struct_type != NULL);\n   return struct_type->field(this->field_index_)->type();\n }\n@@ -9956,7 +9959,10 @@ Field_reference_expression::do_type()\n void\n Field_reference_expression::do_check_types(Gogo*)\n {\n-  Struct_type* struct_type = this->expr_->type()->struct_type();\n+  Type* type = this->expr_->type();\n+  if (type->is_error_type())\n+    return;\n+  Struct_type* struct_type = type->struct_type();\n   gcc_assert(struct_type != NULL);\n   gcc_assert(struct_type->field(this->field_index_) != NULL);\n }"}]}