{"sha": "cdccafd922b36a07fe0f4118c07293fd595ffd3e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2RjY2FmZDkyMmIzNmEwN2ZlMGY0MTE4YzA3MjkzZmQ1OTVmZmQzZQ==", "commit": {"author": {"name": "Jan Kratochvil", "email": "jkratoch@gcc.gnu.org", "date": "2015-11-20T19:00:51Z"}, "committer": {"name": "Jan Kratochvil", "email": "jkratoch@gcc.gnu.org", "date": "2015-11-20T19:00:51Z"}, "message": "re PR libstdc++/68448 (Python Pretty Printers get disabled on libstdc++ reload by GDB)\n\n\tPR libstdc++/68448\n\t* python/hook.in: Call register_libstdcxx_printers.\n\t* python/libstdcxx/v6/__init__.py: Wrap it to\n\tregister_libstdcxx_printers.\n\nFrom-SVN: r230669", "tree": {"sha": "503821057663083e83da3da89562fe800d770075", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/503821057663083e83da3da89562fe800d770075"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cdccafd922b36a07fe0f4118c07293fd595ffd3e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cdccafd922b36a07fe0f4118c07293fd595ffd3e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cdccafd922b36a07fe0f4118c07293fd595ffd3e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cdccafd922b36a07fe0f4118c07293fd595ffd3e/comments", "author": null, "committer": null, "parents": [{"sha": "eed905e9f236f7b7eaba946232851de9d4b27de8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/eed905e9f236f7b7eaba946232851de9d4b27de8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/eed905e9f236f7b7eaba946232851de9d4b27de8"}], "stats": {"total": 29, "additions": 20, "deletions": 9}, "files": [{"sha": "85b0383b8a5a5dae7af93db3e2efdb72abd46e21", "filename": "libstdc++-v3/ChangeLog", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdccafd922b36a07fe0f4118c07293fd595ffd3e/libstdc%2B%2B-v3%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdccafd922b36a07fe0f4118c07293fd595ffd3e/libstdc%2B%2B-v3%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2FChangeLog?ref=cdccafd922b36a07fe0f4118c07293fd595ffd3e", "patch": "@@ -1,6 +1,13 @@\n+2015-11-20  Jan Kratochvil  <jan.kratochvil@redhat.com>\n+\n+\tPR libstdc++/68448\n+\t* python/hook.in: Call register_libstdcxx_printers.\n+\t* python/libstdcxx/v6/__init__.py: Wrap it to\n+\tregister_libstdcxx_printers.\n+\n 2015-11-17  Jonathan Wakely  <jwakely@redhat.com>\n \n-\tPR libstdc++66059\n+\tPR libstdc++/66059\n \t* include/std/utility (_Build_index_tuple): Optimise.\n \n 2015-11-16  Doug Evans  <dje@google.com>"}, {"sha": "703b6a744886a1aac44604e1539096712c1db1e8", "filename": "libstdc++-v3/python/hook.in", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdccafd922b36a07fe0f4118c07293fd595ffd3e/libstdc%2B%2B-v3%2Fpython%2Fhook.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdccafd922b36a07fe0f4118c07293fd595ffd3e/libstdc%2B%2B-v3%2Fpython%2Fhook.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fpython%2Fhook.in?ref=cdccafd922b36a07fe0f4118c07293fd595ffd3e", "patch": "@@ -55,4 +55,7 @@ if gdb.current_objfile () is not None:\n     if not dir_ in sys.path:\n         sys.path.insert(0, dir_)\n \n-import libstdcxx.v6\n+# Call a function as a plain import would not execute body of the included file\n+# on repeated reloads of this object file.\n+from libstdcxx.v6 import register_libstdcxx_printers\n+register_libstdcxx_printers(gdb.current_objfile())"}, {"sha": "d8e060c809d9b140c98bbcb6e35cf3eec2dc2d9a", "filename": "libstdc++-v3/python/libstdcxx/v6/__init__.py", "status": "modified", "additions": 8, "deletions": 7, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cdccafd922b36a07fe0f4118c07293fd595ffd3e/libstdc%2B%2B-v3%2Fpython%2Flibstdcxx%2Fv6%2F__init__.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cdccafd922b36a07fe0f4118c07293fd595ffd3e/libstdc%2B%2B-v3%2Fpython%2Flibstdcxx%2Fv6%2F__init__.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Fpython%2Flibstdcxx%2Fv6%2F__init__.py?ref=cdccafd922b36a07fe0f4118c07293fd595ffd3e", "patch": "@@ -15,10 +15,6 @@\n \n import gdb\n \n-# Load the pretty-printers.\n-from .printers import register_libstdcxx_printers\n-register_libstdcxx_printers(gdb.current_objfile())\n-\n # Load the xmethods if GDB supports them.\n def gdb_has_xmethods():\n     try:\n@@ -27,6 +23,11 @@ def gdb_has_xmethods():\n     except ImportError:\n         return False\n \n-if gdb_has_xmethods():\n-    from .xmethods import register_libstdcxx_xmethods\n-    register_libstdcxx_xmethods(gdb.current_objfile())\n+def register_libstdcxx_printers(obj):\n+    # Load the pretty-printers.\n+    from .printers import register_libstdcxx_printers\n+    register_libstdcxx_printers(obj)\n+\n+    if gdb_has_xmethods():\n+        from .xmethods import register_libstdcxx_xmethods\n+        register_libstdcxx_xmethods(obj)"}]}