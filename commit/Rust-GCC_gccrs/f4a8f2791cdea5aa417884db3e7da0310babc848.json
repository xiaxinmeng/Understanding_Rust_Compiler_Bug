{"sha": "f4a8f2791cdea5aa417884db3e7da0310babc848", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjRhOGYyNzkxY2RlYTVhYTQxNzg4NGRiM2U3ZGEwMzEwYmFiYzg0OA==", "commit": {"author": {"name": "Aaron W. LaFramboise", "email": "aaronavay62@aaronwl.com", "date": "2004-10-20T08:21:09Z"}, "committer": {"name": "Aaron W. LaFramboise", "email": "aaronwl@gcc.gnu.org", "date": "2004-10-20T08:21:09Z"}, "message": "re PR bootstrap/17832 (Bootstrap broken by fixincludes failures)\n\n\tPR bootstrap/17832\n\n\t* fixincl.c (SIGCHLD): Remove definition.\n\t(initialize): Remove SIGIOT and SIGPIPE checks.\n\t(create_file): Fix mkdir() for Win32.\n\t(internal_fix): Use dup2() instead of fcntl().\n\n\t* fixlib.h (SIGQUIT): Define if undefined.\n\t(SIGIOT): Same.\n\t(SIGPIPE): Same.\n\t(SIGALRM): Same.\n\t(SIGKILL): Same.\n\n\t* procopen.c (chain_open): Use dup2() instead of fcntl().\n\nFrom-SVN: r89326", "tree": {"sha": "b61be9e61931a736e008e95859adbf4a9d604d94", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b61be9e61931a736e008e95859adbf4a9d604d94"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f4a8f2791cdea5aa417884db3e7da0310babc848", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4a8f2791cdea5aa417884db3e7da0310babc848", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f4a8f2791cdea5aa417884db3e7da0310babc848", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f4a8f2791cdea5aa417884db3e7da0310babc848/comments", "author": null, "committer": null, "parents": [{"sha": "d65c67104ff031bc0cfb067af4959e9ad9bed2a0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d65c67104ff031bc0cfb067af4959e9ad9bed2a0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d65c67104ff031bc0cfb067af4959e9ad9bed2a0"}], "stats": {"total": 60, "additions": 47, "deletions": 13}, "files": [{"sha": "1b3274fdf1ad468f5deee309dfc702a027a61e97", "filename": "fixincludes/ChangeLog", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2FChangeLog?ref=f4a8f2791cdea5aa417884db3e7da0310babc848", "patch": "@@ -1,3 +1,20 @@\n+2004-10-20  Aaron W. LaFramboise  <aaronavay62@aaronwl.com>\n+\n+\tPR bootstrap/17832\n+\n+\t* fixincl.c (SIGCHLD): Remove definition.\n+\t(initialize): Remove SIGIOT and SIGPIPE checks.\n+\t(create_file): Fix mkdir() for Win32.\n+\t(internal_fix): Use dup2() instead of fcntl().\n+\n+\t* fixlib.h (SIGQUIT): Define if undefined.\n+\t(SIGIOT): Same.\n+\t(SIGPIPE): Same.\n+\t(SIGALRM): Same.\n+\t(SIGKILL): Same.\n+\n+\t* procopen.c (chain_open): Use dup2() instead of fcntl().\n+\n 2004-08-14  Paolo Bonzini  <bonzini@gnu.org>\n \n \tPR other/17991"}, {"sha": "243f9bbfd1017be9c021f9c9743d5d2292fddc2a", "filename": "fixincludes/fixincl.c", "status": "modified", "additions": 6, "deletions": 9, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2Ffixincl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2Ffixincl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Ffixincl.c?ref=f4a8f2791cdea5aa417884db3e7da0310babc848", "patch": "@@ -30,9 +30,6 @@ Boston, MA 02111-1307, USA.  */\n #define  BAD_ADDR ((void*)-1)\n #endif\n \n-#if ! defined( SIGCHLD ) && defined( SIGCLD )\n-#  define SIGCHLD SIGCLD\n-#endif\n #ifndef SEPARATE_FIX_PROC\n #include \"server.h\"\n #endif\n@@ -291,12 +288,8 @@ initialize ( int argc, char** argv )\n # endif\n \n   signal (SIGQUIT, SIG_IGN);\n-#ifdef SIGIOT\n   signal (SIGIOT,  SIG_IGN);\n-#endif\n-#ifdef SIGPIPE\n   signal (SIGPIPE, SIG_IGN);\n-#endif\n   signal (SIGALRM, SIG_IGN);\n   signal (SIGTERM, SIG_IGN);\n }\n@@ -552,7 +545,11 @@ create_file (void)\n           *pz_dir = NUL;\n           if (stat (fname, &stbf) < 0)\n             {\n+#ifdef _WIN32\n+              mkdir (fname);\n+#else\n               mkdir (fname, S_IFDIR | S_DIRALL);\n+#endif\n             }\n \n           *pz_dir = '/';\n@@ -835,8 +832,8 @@ internal_fix (int read_fd, tFixDesc* p_fixd)\n    *  Make the fd passed in the stdin, and the write end of\n    *  the new pipe become the stdout.\n    */\n-  fcntl (fd[1], F_DUPFD, STDOUT_FILENO);\n-  fcntl (read_fd, F_DUPFD, STDIN_FILENO);\n+  dup2 (fd[1], STDOUT_FILENO);\n+  dup2 (read_fd, STDIN_FILENO);\n \n   apply_fix (p_fixd, pz_curr_file);\n   exit (0);"}, {"sha": "8032f98eb482de8ceefd27b420ae1dfda410ca52", "filename": "fixincludes/fixlib.h", "status": "modified", "additions": 21, "deletions": 1, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2Ffixlib.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2Ffixlib.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Ffixlib.h?ref=f4a8f2791cdea5aa417884db3e7da0310babc848", "patch": "@@ -3,7 +3,7 @@\n    files which are fixed to work correctly with ANSI C and placed in a\n    directory that GCC will search.\n \n-   Copyright (C) 1997, 1998, 1999, 2000, 2001, 2002\n+   Copyright (C) 1997, 1998, 1999, 2000, 2001, 2002, 2004\n    Free Software Foundation, Inc.\n \n This file is part of GCC.\n@@ -40,6 +40,26 @@ Boston, MA 02111-1307, USA.  */\n # define STDOUT_FILENO  1\n #endif\n \n+#if ! defined( SIGCHLD ) && defined( SIGCLD )\n+#  define SIGCHLD SIGCLD\n+#endif\n+\n+#ifndef SIGQUIT\n+#define SIGQUIT SIGTERM\n+#endif\n+#ifndef SIGIOT\n+#define SIGIOT SIGTERM\n+#endif\n+#ifndef SIGPIPE\n+#define SIGPIPE SIGTERM\n+#endif\n+#ifndef SIGALRM\n+#define SIGALRM SIGTERM\n+#endif\n+#ifndef SIGKILL\n+#define SIGKILL SIGTERM\n+#endif\n+\n typedef int t_success;\n \n #define FAILURE         (-1)"}, {"sha": "75891e42c712221e21d086d1a60fc380c7c939ad", "filename": "fixincludes/procopen.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2Fprocopen.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f4a8f2791cdea5aa417884db3e7da0310babc848/fixincludes%2Fprocopen.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/fixincludes%2Fprocopen.c?ref=f4a8f2791cdea5aa417884db3e7da0310babc848", "patch": "@@ -2,7 +2,7 @@\n /*\n  *  server.c  Set up and handle communications with a server process.\n  *\n- *  Server Handling copyright 1992-1999 The Free Software Foundation\n+ *  Server Handling copyright 1992-1999, 2004 The Free Software Foundation\n  *\n  *  Server Handling is free software.\n  *  You may redistribute it and/or modify it under the terms of the\n@@ -155,8 +155,8 @@ chain_open (int stdin_fd, tCC** pp_args, pid_t* p_child)\n    *  Make the fd passed in the stdin, and the write end of\n    *  the new pipe become the stdout.\n    */\n-  fcntl (stdout_pair.write_fd, F_DUPFD, STDOUT_FILENO);\n-  fcntl (stdin_fd, F_DUPFD, STDIN_FILENO);\n+  dup2 (stdout_pair.write_fd, STDOUT_FILENO);\n+  dup2 (stdin_fd, STDIN_FILENO);\n \n   if (*pp_args == (char *) NULL)\n     *pp_args = pz_cmd;"}]}