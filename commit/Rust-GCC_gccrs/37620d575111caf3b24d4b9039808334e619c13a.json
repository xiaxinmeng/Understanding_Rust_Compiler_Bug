{"sha": "37620d575111caf3b24d4b9039808334e619c13a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Mzc2MjBkNTc1MTExY2FmM2IyNGQ0YjkwMzk4MDgzMzRlNjE5YzEzYQ==", "commit": {"author": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2021-08-17T19:26:52Z"}, "committer": {"name": "Jonathan Wakely", "email": "jwakely@redhat.com", "date": "2021-08-18T13:26:39Z"}, "message": "libstdc++: Simplify n-ary arithmetic promotion traits\n\nThe std::complex partial specializations have been unnecessary since\n774c3d8647cc7012937cfc9d2d6dacc85b6cf8e9\n\nSigned-off-by: Jonathan Wakely <jwakely@redhat.com>\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/ext/type_traits.h (__promote_2, __promote_3)\n\t(__promote_4): Redfine as alias templates using __promoted_t.\n\t* include/std/complex (__promote_2): Remove partial\n\tspecializations for std::complex.", "tree": {"sha": "561e86570280c341e4fcfbed90d7b8f6724d640f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/561e86570280c341e4fcfbed90d7b8f6724d640f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/37620d575111caf3b24d4b9039808334e619c13a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37620d575111caf3b24d4b9039808334e619c13a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/37620d575111caf3b24d4b9039808334e619c13a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/37620d575111caf3b24d4b9039808334e619c13a/comments", "author": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jwakely", "id": 1254480, "node_id": "MDQ6VXNlcjEyNTQ0ODA=", "avatar_url": "https://avatars.githubusercontent.com/u/1254480?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jwakely", "html_url": "https://github.com/jwakely", "followers_url": "https://api.github.com/users/jwakely/followers", "following_url": "https://api.github.com/users/jwakely/following{/other_user}", "gists_url": "https://api.github.com/users/jwakely/gists{/gist_id}", "starred_url": "https://api.github.com/users/jwakely/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jwakely/subscriptions", "organizations_url": "https://api.github.com/users/jwakely/orgs", "repos_url": "https://api.github.com/users/jwakely/repos", "events_url": "https://api.github.com/users/jwakely/events{/privacy}", "received_events_url": "https://api.github.com/users/jwakely/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "de44eee5d52f5980b6b2b2120940f70cc2fa007e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/de44eee5d52f5980b6b2b2120940f70cc2fa007e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/de44eee5d52f5980b6b2b2120940f70cc2fa007e"}], "stats": {"total": 45, "additions": 15, "deletions": 30}, "files": [{"sha": "fed78d3a527e74b6067295b6a8ddeaf9090a1fad", "filename": "libstdc++-v3/include/ext/type_traits.h", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37620d575111caf3b24d4b9039808334e619c13a/libstdc%2B%2B-v3%2Finclude%2Fext%2Ftype_traits.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37620d575111caf3b24d4b9039808334e619c13a/libstdc%2B%2B-v3%2Finclude%2Fext%2Ftype_traits.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fext%2Ftype_traits.h?ref=37620d575111caf3b24d4b9039808334e619c13a", "patch": "@@ -189,9 +189,22 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     { typedef float __type; };\n \n #if __cpp_fold_expressions\n+\n   template<typename... _Tp>\n     using __promoted_t = decltype((typename __promote<_Tp>::__type(0) + ...));\n-#endif\n+\n+  // Deducing the promoted type is done by __promoted_t<_Tp...>,\n+  // then __promote is used to provide the nested __type member.\n+  template<typename _Tp, typename _Up>\n+    using __promote_2 = __promote<__promoted_t<_Tp, _Up>>;\n+\n+  template<typename _Tp, typename _Up, typename _Vp>\n+    using __promote_3 = __promote<__promoted_t<_Tp, _Up, _Vp>>;\n+\n+  template<typename _Tp, typename _Up, typename _Vp, typename _Wp>\n+    using __promote_4 = __promote<__promoted_t<_Tp, _Up, _Vp, _Wp>>;\n+\n+#else\n \n   template<typename _Tp, typename _Up,\n            typename _Tp2 = typename __promote<_Tp>::__type,\n@@ -219,6 +232,7 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n     {\n       typedef __typeof__(_Tp2() + _Up2() + _Vp2() + _Wp2()) __type;\n     };\n+#endif\n \n _GLIBCXX_END_NAMESPACE_VERSION\n } // namespace"}, {"sha": "a5b4406dd6886fea2e940809c5f975dfbbb7814b", "filename": "libstdc++-v3/include/std/complex", "status": "modified", "additions": 0, "deletions": 29, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/37620d575111caf3b24d4b9039808334e619c13a/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fcomplex", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/37620d575111caf3b24d4b9039808334e619c13a/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fcomplex", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Fcomplex?ref=37620d575111caf3b24d4b9039808334e619c13a", "patch": "@@ -1557,35 +1557,6 @@ _GLIBCXX_BEGIN_NAMESPACE_VERSION\n _GLIBCXX_END_NAMESPACE_VERSION\n } // namespace\n \n-namespace __gnu_cxx _GLIBCXX_VISIBILITY(default)\n-{\n-_GLIBCXX_BEGIN_NAMESPACE_VERSION\n-\n-  // See ext/type_traits.h for the primary template.\n-  template<typename _Tp, typename _Up>\n-    struct __promote_2<std::complex<_Tp>, _Up>\n-    {\n-    public:\n-      typedef std::complex<typename __promote_2<_Tp, _Up>::__type> __type;\n-    };\n-\n-  template<typename _Tp, typename _Up>\n-    struct __promote_2<_Tp, std::complex<_Up> >\n-    {\n-    public:\n-      typedef std::complex<typename __promote_2<_Tp, _Up>::__type> __type;\n-    };\n-\n-  template<typename _Tp, typename _Up>\n-    struct __promote_2<std::complex<_Tp>, std::complex<_Up> >\n-    {\n-    public:\n-      typedef std::complex<typename __promote_2<_Tp, _Up>::__type> __type;\n-    };\n-\n-_GLIBCXX_END_NAMESPACE_VERSION\n-} // namespace\n-\n #if __cplusplus >= 201103L\n \n namespace std _GLIBCXX_VISIBILITY(default)"}]}