{"sha": "6a435314929c9dc355c0f8d1c3299e1214ce580f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmE0MzUzMTQ5MjljOWRjMzU1YzBmOGQxYzMyOTllMTIxNGNlNTgwZg==", "commit": {"author": {"name": "Wilco Dijkstra", "email": "wilco@gcc.gnu.org", "date": "2017-11-07T12:38:55Z"}, "committer": {"name": "Wilco Dijkstra", "email": "wilco@gcc.gnu.org", "date": "2017-11-07T12:38:55Z"}, "message": "PR71026: Canonicalize negates in division\n\nCanonicalize x / (- y) into (-x) / y.\n\nThis moves negates out of the RHS of a division in order to\nallow further simplifications and potentially more reciprocal CSEs.\n\n2017-11-07  Wilco Dijkstra  <wdijkstr@arm.com>\n\t    Jackson Woodruff  <jackson.woodruff@arm.com>\n\n    gcc/\n\tPR tree-optimization/71026\n\t* match.pd: Canonicalize negate in division.\n\n    testsuite/\n\tPR 71026/tree-optimization/71026\n\t* gcc.dg/div_neg: New test.\n\nFrom-SVN: r254497", "tree": {"sha": "70971fd48048e5c514ac4e25841ff7ca4f9d2224", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/70971fd48048e5c514ac4e25841ff7ca4f9d2224"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6a435314929c9dc355c0f8d1c3299e1214ce580f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a435314929c9dc355c0f8d1c3299e1214ce580f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a435314929c9dc355c0f8d1c3299e1214ce580f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a435314929c9dc355c0f8d1c3299e1214ce580f/comments", "author": null, "committer": null, "parents": [{"sha": "4349b15f97fcbb6b7cdd96bb5bff0af1eb78e653", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4349b15f97fcbb6b7cdd96bb5bff0af1eb78e653", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4349b15f97fcbb6b7cdd96bb5bff0af1eb78e653"}], "stats": {"total": 29, "additions": 28, "deletions": 1}, "files": [{"sha": "2fb808b5dd017089d05152685d47197681a0a85d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6a435314929c9dc355c0f8d1c3299e1214ce580f", "patch": "@@ -1,3 +1,9 @@\n+2017-11-07  Wilco Dijkstra  <wdijkstr@arm.com>\n+\t    Jackson Woodruff  <jackson.woodruff@arm.com>\n+\n+\tPR tree-optimization/71026\n+\t* match.pd: Canonicalize negate in division.\n+\n 2017-11-07  Sudakshina Das  <sudi.das@arm.com>\n \n \tPR middle-end/80131"}, {"sha": "903c06530be3ee6d486d4b036d272c3a4537bb6f", "filename": "gcc/match.pd", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=6a435314929c9dc355c0f8d1c3299e1214ce580f", "patch": "@@ -354,6 +354,11 @@ DEFINE_INT_AND_FLOAT_ROUND_FN (RINT)\n   (rdiv @0 (rdiv:s @1 @2))\n    (mult (rdiv @0 @1) @2)))\n \n+/* Simplify x / (- y) to -x / y.  */\n+(simplify\n+ (rdiv @0 (negate @1))\n+ (rdiv (negate @0) @1))\n+\n /* Optimize (X & (-A)) / A where A is a power of 2, to X >> log2(A) */\n (for div (trunc_div ceil_div floor_div round_div exact_div)\n  (simplify"}, {"sha": "8d41c8425c9e838b4427cc265cdad1a614fc03ad", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 7, "deletions": 1, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6a435314929c9dc355c0f8d1c3299e1214ce580f", "patch": "@@ -1,7 +1,13 @@\n+2017-10-17  Wilco Dijkstra  <wdijkstr@arm.com>\n+\t    Jackson Woodruff  <jackson.woodruff@arm.com>\n+\n+\tPR tree-optimization/71026\n+\t* gcc.dg/div_neg: New test.\n+\n 2017-11-07  Sudakshina Das  <sudi.das@arm.com>\n \n \tPR middle-end/80131\n-\t* testsuite/gcc.dg/pr80131-1.c: New Test.\n+\t* gcc.dg/pr80131-1.c: New Test.\n \n 2017-11-07  Marc Glisse  <marc.glisse@inria.fr>\n "}, {"sha": "da499cda2fba6c943ec99c55cae2ea389f9e1cca", "filename": "gcc/testsuite/gcc.dg/div_neg.c", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2Ftestsuite%2Fgcc.dg%2Fdiv_neg.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a435314929c9dc355c0f8d1c3299e1214ce580f/gcc%2Ftestsuite%2Fgcc.dg%2Fdiv_neg.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fdiv_neg.c?ref=6a435314929c9dc355c0f8d1c3299e1214ce580f", "patch": "@@ -0,0 +1,10 @@\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -fdump-tree-optimized\" } */\n+\n+float\n+div_neg (float x, float y)\n+{\n+  return (-x / y) * (x / -y);\n+}\n+\n+/* { dg-final { scan-tree-dump-times \" / \" 1 \"optimized\" } } */"}]}