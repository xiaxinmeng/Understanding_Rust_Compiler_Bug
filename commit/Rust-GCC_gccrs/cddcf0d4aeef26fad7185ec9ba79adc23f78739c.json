{"sha": "cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6Y2RkY2YwZDRhZWVmMjZmYWQ3MTg1ZWM5YmE3OWFkYzIzZjc4NzM5Yw==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2008-01-06T18:07:52Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2008-01-06T18:07:52Z"}, "message": "re PR fortran/34655 (5.5.2.5)\n\n2008-01-06  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/34655\n        * resolve.c (resolve_equivalence_derived): Reject derived types\n        * with\n        default initialization if equivalenced with COMMON variable.\n\n2008-01-06  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/34655\n        * gfortran.dg/equiv_constraint_9.f90: New.\n\nFrom-SVN: r131353", "tree": {"sha": "23e732adc566fc2363414dd1082478914fb933d0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/23e732adc566fc2363414dd1082478914fb933d0"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2c460d129131c95fc7b72e3600ab532a375562fa", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2c460d129131c95fc7b72e3600ab532a375562fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2c460d129131c95fc7b72e3600ab532a375562fa"}], "stats": {"total": 47, "additions": 47, "deletions": 0}, "files": [{"sha": "a3d2ee8fe7174e8595582d1ff4dd8f0914ed11ef", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "patch": "@@ -1,3 +1,9 @@\n+2008-01-06  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/34655\n+\t* resolve.c (resolve_equivalence_derived): Reject derived types with\n+\tdefault initialization if equivalenced with COMMON variable.\n+\n 2008-01-06  Tobias Burnus  <burnus@net-b.de>\n \n \tPR fortran/34654"}, {"sha": "6cde79fb75562cf28d6d1a1a305bdc2fa3c12ef4", "filename": "gcc/fortran/resolve.c", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ffortran%2Fresolve.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ffortran%2Fresolve.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fresolve.c?ref=cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "patch": "@@ -8534,6 +8534,14 @@ resolve_equivalence_derived (gfc_symbol *derived, gfc_symbol *sym, gfc_expr *e)\n       return FAILURE;\n     }\n \n+  if (sym->attr.in_common && has_default_initializer (sym->ts.derived))\n+    {\n+      gfc_error (\"Derived type variable '%s' at %L with default \"\n+\t\t \"initialization cannot be in EQUIVALENCE with a variable \"\n+\t\t \"in COMMON\", sym->name, &e->where);\n+      return FAILURE;\n+    }\n+\n   for (; c ; c = c->next)\n     {\n       d = c->ts.derived;"}, {"sha": "549a0074f6b98c7d577d6ad973a08dfa70948371", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "patch": "@@ -1,3 +1,8 @@\n+2008-01-06  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/34655\n+\t* gfortran.dg/equiv_constraint_9.f90: New.\n+\n 2008-01-06  Revital Eres  <eres@il.ibm.com>\n \n \tPR tree-optimization/34263"}, {"sha": "3374441401115dd17b71aa3129a3e6c76e330ef2", "filename": "gcc/testsuite/gfortran.dg/equiv_constraint_9.f90", "status": "added", "additions": 28, "deletions": 0, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ftestsuite%2Fgfortran.dg%2Fequiv_constraint_9.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/cddcf0d4aeef26fad7185ec9ba79adc23f78739c/gcc%2Ftestsuite%2Fgfortran.dg%2Fequiv_constraint_9.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fequiv_constraint_9.f90?ref=cddcf0d4aeef26fad7185ec9ba79adc23f78739c", "patch": "@@ -0,0 +1,28 @@\n+! { dg-do compile }\n+!\n+! PR fortran/34655\n+!\n+! Check for F2003's 5.5.2.5 Restrictions on common and equivalence\n+! Test case contributed by Joost VandeVondele.\n+!\n+implicit none\n+type data_type\n+ sequence\n+ integer :: I = 7\n+end type data_type\n+\n+\n+type data_type2\n+ sequence\n+ integer :: I\n+end type data_type2\n+\n+type(data_type) :: dd, ff\n+type(data_type2) :: gg\n+integer :: j, k, m\n+EQUIVALENCE(dd,J) ! { dg-error \"with default initializations cannot be in EQUIVALENCE with a variable in COMMON\" }\n+EQUIVALENCE(ff,k)\n+EQUIVALENCE(gg,m)\n+COMMON /COM/ j\n+COMMON /COM/ m\n+END"}]}