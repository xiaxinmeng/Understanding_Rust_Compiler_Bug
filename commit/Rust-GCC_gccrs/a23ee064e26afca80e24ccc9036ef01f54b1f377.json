{"sha": "a23ee064e26afca80e24ccc9036ef01f54b1f377", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTIzZWUwNjRlMjZhZmNhODBlMjRjY2M5MDM2ZWYwMWY1NGIxZjM3Nw==", "commit": {"author": {"name": "Andris Pavenis", "email": "pavenis@latnet.lv", "date": "2004-07-16T17:07:01Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2004-07-16T17:07:01Z"}, "message": "re PR preprocessor/16366 (Preprocessor option -remap causes memory corruption)\n\n2004-07-16  Andris Pavenis  <pavenis@latnet.lv>\n\n\tPR preprocessor/16366\n\t* internal.h (struct cpp_reader): New field dir_hash.\n\t* files.c (make_cpp_dir): Use dir_hash, not file_hash.\n\t(_cpp_init_files, _cpp_cleanup_files): Update for new field.\n\nFrom-SVN: r84821", "tree": {"sha": "731f455afa7023a8116cc6a957e079da9a2f3e35", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/731f455afa7023a8116cc6a957e079da9a2f3e35"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a23ee064e26afca80e24ccc9036ef01f54b1f377", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a23ee064e26afca80e24ccc9036ef01f54b1f377", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a23ee064e26afca80e24ccc9036ef01f54b1f377", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a23ee064e26afca80e24ccc9036ef01f54b1f377/comments", "author": null, "committer": null, "parents": [{"sha": "043fdfc83e4f2e5d2b355df7ee722fd118c97e5c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/043fdfc83e4f2e5d2b355df7ee722fd118c97e5c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/043fdfc83e4f2e5d2b355df7ee722fd118c97e5c"}], "stats": {"total": 13, "additions": 12, "deletions": 1}, "files": [{"sha": "48fdf38691b49634af5ae6927f1ab6a41ec85091", "filename": "libcpp/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a23ee064e26afca80e24ccc9036ef01f54b1f377/libcpp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a23ee064e26afca80e24ccc9036ef01f54b1f377/libcpp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2FChangeLog?ref=a23ee064e26afca80e24ccc9036ef01f54b1f377", "patch": "@@ -1,3 +1,10 @@\n+2004-07-16  Andris Pavenis  <pavenis@latnet.lv>\n+\n+\tPR preprocessor/16366\n+\t* internal.h (struct cpp_reader): New field dir_hash.\n+\t* files.c (make_cpp_dir): Use dir_hash, not file_hash.\n+\t(_cpp_init_files, _cpp_cleanup_files): Update for new field.\n+\n 2004-07-04  Neil Booth  <neil@duron.akihabara.co.uk>\n \n \tPR preprocessor/16192"}, {"sha": "fc1fa2c7f0e6a530712516bf66229952a948fd19", "filename": "libcpp/files.c", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a23ee064e26afca80e24ccc9036ef01f54b1f377/libcpp%2Ffiles.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a23ee064e26afca80e24ccc9036ef01f54b1f377/libcpp%2Ffiles.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Ffiles.c?ref=a23ee064e26afca80e24ccc9036ef01f54b1f377", "patch": "@@ -884,7 +884,7 @@ make_cpp_dir (cpp_reader *pfile, const char *dir_name, int sysp)\n   cpp_dir *dir;\n \n   hash_slot = (struct file_hash_entry **)\n-    htab_find_slot_with_hash (pfile->file_hash, dir_name,\n+    htab_find_slot_with_hash (pfile->dir_hash, dir_name,\n \t\t\t      htab_hash_string (dir_name),\n \t\t\t      INSERT);\n \n@@ -984,6 +984,8 @@ _cpp_init_files (cpp_reader *pfile)\n {\n   pfile->file_hash = htab_create_alloc (127, file_hash_hash, file_hash_eq,\n \t\t\t\t\tNULL, xcalloc, free);\n+  pfile->dir_hash = htab_create_alloc (127, file_hash_hash, file_hash_eq,\n+\t\t\t\t\tNULL, xcalloc, free);\n   allocate_file_hash_entries (pfile);\n }\n \n@@ -992,6 +994,7 @@ void\n _cpp_cleanup_files (cpp_reader *pfile)\n {\n   htab_delete (pfile->file_hash);\n+  htab_delete (pfile->dir_hash);\n }\n \n /* Enter a file name in the hash for the sake of cpp_included.  */"}, {"sha": "0a7eb109187fe32cf21ff163b712fb7c4bb27235", "filename": "libcpp/internal.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a23ee064e26afca80e24ccc9036ef01f54b1f377/libcpp%2Finternal.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a23ee064e26afca80e24ccc9036ef01f54b1f377/libcpp%2Finternal.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libcpp%2Finternal.h?ref=a23ee064e26afca80e24ccc9036ef01f54b1f377", "patch": "@@ -334,6 +334,7 @@ struct cpp_reader\n \n   /* File and directory hash table.  */\n   struct htab *file_hash;\n+  struct htab *dir_hash;\n   struct file_hash_entry *file_hash_entries;\n   unsigned int file_hash_entries_allocated, file_hash_entries_used;\n "}]}