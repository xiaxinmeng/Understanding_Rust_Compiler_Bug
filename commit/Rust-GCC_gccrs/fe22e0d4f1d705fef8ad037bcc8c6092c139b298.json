{"sha": "fe22e0d4f1d705fef8ad037bcc8c6092c139b298", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmUyMmUwZDRmMWQ3MDVmZWY4YWQwMzdiY2M4YzYwOTJjMTM5YjI5OA==", "commit": {"author": {"name": "Andrew Stubbs", "email": "ams@codesourcery.com", "date": "2019-11-13T12:38:13Z"}, "committer": {"name": "Andrew Stubbs", "email": "ams@gcc.gnu.org", "date": "2019-11-13T12:38:13Z"}, "message": "Use a single worker for OpenACC on AMD GCN\n\n2019-11-13  Andrew Stubbs  <ams@codesourcery.com>\n\t    Julian Brown  <julian@codesourcery.com>\n\n\tgcc/\n\t* config/gcn/gcn.c (gcn_goacc_validate_dims): Ensure\n\tflag_worker_partitioning is not set.\n\t(TARGET_GOACC_WORKER_PARTITIONING): Remove target hook definition.\n\t* config/gcn/gcn.opt (macc-experimental-workers): Default to off.\n\nCo-Authored-By: Julian Brown <julian@codesourcery.com>\n\nFrom-SVN: r278137", "tree": {"sha": "7d65997618f09f584aadc40464755646275182d8", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7d65997618f09f584aadc40464755646275182d8"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fe22e0d4f1d705fef8ad037bcc8c6092c139b298", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe22e0d4f1d705fef8ad037bcc8c6092c139b298", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fe22e0d4f1d705fef8ad037bcc8c6092c139b298", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fe22e0d4f1d705fef8ad037bcc8c6092c139b298/comments", "author": {"login": "ams-cs", "id": 2235130, "node_id": "MDQ6VXNlcjIyMzUxMzA=", "avatar_url": "https://avatars.githubusercontent.com/u/2235130?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ams-cs", "html_url": "https://github.com/ams-cs", "followers_url": "https://api.github.com/users/ams-cs/followers", "following_url": "https://api.github.com/users/ams-cs/following{/other_user}", "gists_url": "https://api.github.com/users/ams-cs/gists{/gist_id}", "starred_url": "https://api.github.com/users/ams-cs/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ams-cs/subscriptions", "organizations_url": "https://api.github.com/users/ams-cs/orgs", "repos_url": "https://api.github.com/users/ams-cs/repos", "events_url": "https://api.github.com/users/ams-cs/events{/privacy}", "received_events_url": "https://api.github.com/users/ams-cs/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "cee1645106465bc593b4cf31716b0a8ddd59af61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/cee1645106465bc593b4cf31716b0a8ddd59af61", "html_url": "https://github.com/Rust-GCC/gccrs/commit/cee1645106465bc593b4cf31716b0a8ddd59af61"}], "stats": {"total": 14, "additions": 11, "deletions": 3}, "files": [{"sha": "0e5560e1f87d23427d36b8f0080c62f295e36e05", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe22e0d4f1d705fef8ad037bcc8c6092c139b298/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe22e0d4f1d705fef8ad037bcc8c6092c139b298/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fe22e0d4f1d705fef8ad037bcc8c6092c139b298", "patch": "@@ -1,3 +1,11 @@\n+2019-11-13  Andrew Stubbs  <ams@codesourcery.com>\n+\t    Julian Brown  <julian@codesourcery.com>\n+\n+\t* config/gcn/gcn.c (gcn_goacc_validate_dims): Ensure\n+\tflag_worker_partitioning is not set.\n+\t(TARGET_GOACC_WORKER_PARTITIONING): Remove target hook definition.\n+\t* config/gcn/gcn.opt (macc-experimental-workers): Default to off.\n+\n 2019-11-13  Andrew Stubbs  <ams@codesourcery.com>\n \n \t* config/gcn/gcn-run.c (heap_region): New global variable."}, {"sha": "1a69737f693488f0336cae45a8141dc276eddb8b", "filename": "gcc/config/gcn/gcn.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe22e0d4f1d705fef8ad037bcc8c6092c139b298/gcc%2Fconfig%2Fgcn%2Fgcn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe22e0d4f1d705fef8ad037bcc8c6092c139b298/gcc%2Fconfig%2Fgcn%2Fgcn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fgcn%2Fgcn.c?ref=fe22e0d4f1d705fef8ad037bcc8c6092c139b298", "patch": "@@ -4695,6 +4695,8 @@ gcn_goacc_validate_dims (tree decl, int dims[], int fn_level,\n   /* FIXME: remove -facc-experimental-workers when they're ready.  */\n   int max_workers = flag_worker_partitioning ? 16 : 1;\n \n+  gcc_assert (!flag_worker_partitioning);\n+\n   /* The vector size must appear to be 64, to the user, unless this is a\n      SEQ routine.  The real, internal value is always 1, which means use\n      autovectorization, but the user should not see that.  */\n@@ -6073,8 +6075,6 @@ print_operand (FILE *file, rtx x, int code)\n #define TARGET_GOACC_REDUCTION gcn_goacc_reduction\n #undef  TARGET_GOACC_VALIDATE_DIMS\n #define TARGET_GOACC_VALIDATE_DIMS gcn_goacc_validate_dims\n-#undef  TARGET_GOACC_WORKER_PARTITIONING\n-#define TARGET_GOACC_WORKER_PARTITIONING true\n #undef  TARGET_HARD_REGNO_MODE_OK\n #define TARGET_HARD_REGNO_MODE_OK gcn_hard_regno_mode_ok\n #undef  TARGET_HARD_REGNO_NREGS"}, {"sha": "402deb625bdbf9fb6b528c209d7ef61c7d2ce7f2", "filename": "gcc/config/gcn/gcn.opt", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fe22e0d4f1d705fef8ad037bcc8c6092c139b298/gcc%2Fconfig%2Fgcn%2Fgcn.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fe22e0d4f1d705fef8ad037bcc8c6092c139b298/gcc%2Fconfig%2Fgcn%2Fgcn.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fgcn%2Fgcn.opt?ref=fe22e0d4f1d705fef8ad037bcc8c6092c139b298", "patch": "@@ -65,7 +65,7 @@ Target Report RejectNegative Var(flag_bypass_init_error)\n bool flag_worker_partitioning = false\n \n macc-experimental-workers\n-Target Report Var(flag_worker_partitioning) Init(1)\n+Target Report Var(flag_worker_partitioning) Init(0)\n \n int stack_size_opt = -1\n "}]}