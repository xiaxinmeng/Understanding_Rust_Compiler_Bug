{"sha": "f61af651e20626f6978e45f6ac5728b408fd1c93", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjYxYWY2NTFlMjA2MjZmNjk3OGU0NWY2YWM1NzI4YjQwOGZkMWM5Mw==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-11-10T23:40:57Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-11-10T23:40:57Z"}, "message": "cvt.c (cp_convert_to_pointer): Call build_ptrmemfunc before maybe_warn_zero_as_null_pointer_constant to avoid...\n\n2013-11-10  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\t* cvt.c (cp_convert_to_pointer): Call build_ptrmemfunc before\n\tmaybe_warn_zero_as_null_pointer_constant to avoid duplicate\n\t-Wzero-as-null-pointer-constant diagnostics.\n\n\t* typeck.c (build_ptrmemfunc): Use cp_build_c_cast.\n\nFrom-SVN: r204655", "tree": {"sha": "b7a1fda6293692106c060179365c03b8f2af725b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/b7a1fda6293692106c060179365c03b8f2af725b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f61af651e20626f6978e45f6ac5728b408fd1c93", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f61af651e20626f6978e45f6ac5728b408fd1c93", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f61af651e20626f6978e45f6ac5728b408fd1c93", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f61af651e20626f6978e45f6ac5728b408fd1c93/comments", "author": null, "committer": null, "parents": [{"sha": "c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c20fdb917fff5f3262ee8e3ce27384557ae74ee2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c20fdb917fff5f3262ee8e3ce27384557ae74ee2"}], "stats": {"total": 16, "additions": 12, "deletions": 4}, "files": [{"sha": "4934577ea2a7615ff335ffa631bcc062fb1b91ad", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f61af651e20626f6978e45f6ac5728b408fd1c93/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f61af651e20626f6978e45f6ac5728b408fd1c93/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=f61af651e20626f6978e45f6ac5728b408fd1c93", "patch": "@@ -1,3 +1,11 @@\n+2013-11-10  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\t* cvt.c (cp_convert_to_pointer): Call build_ptrmemfunc before\n+\tmaybe_warn_zero_as_null_pointer_constant to avoid duplicate\n+\t-Wzero-as-null-pointer-constant diagnostics.\n+\n+\t* typeck.c (build_ptrmemfunc): Use cp_build_c_cast.\n+\n 2013-11-06  Paolo Carlini  <paolo.carlini@oracle.com>\n \n \tPR c++/11006"}, {"sha": "7dac108db95bd9e8bbdb7b36b7e7fd2b1c2bc94c", "filename": "gcc/cp/cvt.c", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f61af651e20626f6978e45f6ac5728b408fd1c93/gcc%2Fcp%2Fcvt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f61af651e20626f6978e45f6ac5728b408fd1c93/gcc%2Fcp%2Fcvt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcvt.c?ref=f61af651e20626f6978e45f6ac5728b408fd1c93", "patch": "@@ -203,13 +203,13 @@ cp_convert_to_pointer (tree type, tree expr, tsubst_flags_t complain)\n \n   if (null_ptr_cst_p (expr))\n     {\n-      if (complain & tf_warning)\n-\tmaybe_warn_zero_as_null_pointer_constant (expr, loc);\n-\n       if (TYPE_PTRMEMFUNC_P (type))\n \treturn build_ptrmemfunc (TYPE_PTRMEMFUNC_FN_TYPE (type), expr, 0,\n \t\t\t\t /*c_cast_p=*/false, complain);\n \n+      if (complain & tf_warning)\n+\tmaybe_warn_zero_as_null_pointer_constant (expr, loc);\n+\n       /* A NULL pointer-to-data-member is represented by -1, not by\n \t zero.  */\n       tree val = (TYPE_PTRDATAMEM_P (type)"}, {"sha": "bff7f17780f9f19b4513683d44e58ad954d5c593", "filename": "gcc/cp/typeck.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f61af651e20626f6978e45f6ac5728b408fd1c93/gcc%2Fcp%2Ftypeck.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f61af651e20626f6978e45f6ac5728b408fd1c93/gcc%2Fcp%2Ftypeck.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Ftypeck.c?ref=f61af651e20626f6978e45f6ac5728b408fd1c93", "patch": "@@ -7779,7 +7779,7 @@ build_ptrmemfunc (tree type, tree pfn, int force, bool c_cast_p,\n   /* Handle null pointer to member function conversions.  */\n   if (null_ptr_cst_p (pfn))\n     {\n-      pfn = build_c_cast (input_location, type, pfn);\n+      pfn = cp_build_c_cast (type, pfn, complain);\n       return build_ptrmemfunc1 (to_type,\n \t\t\t\tinteger_zero_node,\n \t\t\t\tpfn);"}]}