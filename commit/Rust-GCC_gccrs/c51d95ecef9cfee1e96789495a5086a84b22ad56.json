{"sha": "c51d95ecef9cfee1e96789495a5086a84b22ad56", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzUxZDk1ZWNlZjljZmVlMWU5Njc4OTQ5NWE1MDg2YTg0YjIyYWQ1Ng==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2002-03-08T20:32:15Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2002-03-08T20:32:15Z"}, "message": "cfgrtl.c (purge_dead_edges): Set BB_DRITY flags if edge has been removed; fix return value.\n\n\t* cfgrtl.c (purge_dead_edges): Set BB_DRITY flags if edge has been\n\tremoved; fix return value.\n\t* combine.c (combine_instructions): Dirtify blocks where we failed to\n\tupdate liveness; purge dead edges; use update_life_info_in_dirty_blocks.\n\t* toplev.c (rest_of_compilation): Do not purge_dead_edges after combine.\n\nFrom-SVN: r50454", "tree": {"sha": "84fa304edc2ca3262e1d32784341ca2852d908ad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/84fa304edc2ca3262e1d32784341ca2852d908ad"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c51d95ecef9cfee1e96789495a5086a84b22ad56", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c51d95ecef9cfee1e96789495a5086a84b22ad56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c51d95ecef9cfee1e96789495a5086a84b22ad56", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c51d95ecef9cfee1e96789495a5086a84b22ad56/comments", "author": null, "committer": null, "parents": [{"sha": "3b25fbfeafe195ba777acedd7b79d5b74ff8927e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b25fbfeafe195ba777acedd7b79d5b74ff8927e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b25fbfeafe195ba777acedd7b79d5b74ff8927e"}], "stats": {"total": 36, "additions": 24, "deletions": 12}, "files": [{"sha": "535d095bc11e9492a0371a8f7e7807d6eb6e5f4d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=c51d95ecef9cfee1e96789495a5086a84b22ad56", "patch": "@@ -1,3 +1,11 @@\n+Fri Mar  8 21:27:49 CET 2002  Jan Hubicka  <jh@suse.cz>\n+\n+\t* cfgrtl.c (purge_dead_edges): Set BB_DRITY flags if edge has been\n+\tremoved; fix return value.\n+\t* combine.c (combine_instructions): Dirtify blocks where we failed to\n+\tupdate liveness; purge dead edges; use update_life_info_in_dirty_blocks.\n+\t* toplev.c (rest_of_compilation): Do not purge_dead_edges after combine.\n+\n 2002-03-08  Kaveh R. Ghazi  <ghazi@caip.rutgers.edu>\n \n \t* gcse.c (insert_insn_end_bb): Fix typo in last change."}, {"sha": "6e929eb0dad7260a619990f18695e394df91ae70", "filename": "gcc/cfgrtl.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2Fcfgrtl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2Fcfgrtl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcfgrtl.c?ref=c51d95ecef9cfee1e96789495a5086a84b22ad56", "patch": "@@ -2108,6 +2108,7 @@ purge_dead_edges (bb)\n \tif (e->flags & EDGE_EH)\n \t  {\n \t    remove_edge (e);\n+\t    bb->flags |= BB_DIRTY;\n \t    purged = true;\n \t  }\n       }\n@@ -2121,7 +2122,7 @@ purge_dead_edges (bb)\n       if (!any_condjump_p (insn)\n \t  && !returnjump_p (insn)\n \t  && !simplejump_p (insn))\n-\treturn false;\n+\treturn purged;\n \n       /* Branch probability/prediction notes are defined only for\n \t condjumps.  We've possibly turned condjump into simplejump.  */\n@@ -2154,12 +2155,13 @@ purge_dead_edges (bb)\n \t\t   && returnjump_p (insn))\n \t    continue;\n \n+\t  bb->flags |= BB_DIRTY;\n \t  purged = true;\n \t  remove_edge (e);\n \t}\n \n       if (!bb->succ || !purged)\n-\treturn false;\n+\treturn purged;\n \n       if (rtl_dump_file)\n \tfprintf (rtl_dump_file, \"Purged edges from bb %i\\n\", bb->index);\n@@ -2206,7 +2208,11 @@ purge_dead_edges (bb)\n     {\n       next = e->succ_next;\n       if (!(e->flags & EDGE_FALLTHRU))\n-\tremove_edge (e), purged = true;\n+\t{\n+\t  bb->flags |= BB_DIRTY;\n+\t  remove_edge (e);\n+\t  purged = true;\n+\t}\n     }\n \n   if (!bb->succ || bb->succ->succ_next)"}, {"sha": "b734231480bffa27724f45802de43f73a2af2e37", "filename": "gcc/combine.c", "status": "modified", "additions": 7, "deletions": 5, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2Fcombine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2Fcombine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcombine.c?ref=c51d95ecef9cfee1e96789495a5086a84b22ad56", "patch": "@@ -739,14 +739,16 @@ combine_instructions (f, nregs)\n \t  ;\n \t}\n     }\n+  clear_bb_flags ();\n \n+  EXECUTE_IF_SET_IN_SBITMAP (refresh_blocks, 0, this_basic_block,\n+\t\t\t     BASIC_BLOCK (this_basic_block)->flags |= BB_DIRTY);\n+  new_direct_jump_p |= purge_all_dead_edges (0);\n   delete_noop_moves (f);\n \n-  if (need_refresh)\n-    {\n-      update_life_info (refresh_blocks, UPDATE_LIFE_GLOBAL_RM_NOTES,\n-\t\t\tPROP_DEATH_NOTES);\n-    }\n+  update_life_info_in_dirty_blocks (UPDATE_LIFE_GLOBAL_RM_NOTES,\n+\t\t\t\t    PROP_DEATH_NOTES | PROP_SCAN_DEAD_CODE\n+\t\t\t\t    | PROP_KILL_DEAD_CODE);\n \n   /* Clean up.  */\n   sbitmap_free (refresh_blocks);"}, {"sha": "740bf89221940572b588cd2165d1c138e98abc87", "filename": "gcc/toplev.c", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2Ftoplev.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c51d95ecef9cfee1e96789495a5086a84b22ad56/gcc%2Ftoplev.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftoplev.c?ref=c51d95ecef9cfee1e96789495a5086a84b22ad56", "patch": "@@ -3058,10 +3058,6 @@ rest_of_compilation (decl)\n       rebuild_jump_labels_after_combine\n \t= combine_instructions (insns, max_reg_num ());\n \n-      /* Always purge dead edges, as we may eliminate an insn throwing\n-         exception.  */\n-      rebuild_jump_labels_after_combine |= purge_all_dead_edges (true);\n-\n       /* Combining insns may have turned an indirect jump into a\n \t direct jump.  Rebuid the JUMP_LABEL fields of jumping\n \t instructions.  */"}]}