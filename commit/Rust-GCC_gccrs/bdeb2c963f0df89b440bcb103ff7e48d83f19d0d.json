{"sha": "bdeb2c963f0df89b440bcb103ff7e48d83f19d0d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmRlYjJjOTYzZjBkZjg5YjQ0MGJjYjEwM2ZmN2U0OGQ4M2YxOWQwZA==", "commit": {"author": {"name": "Roman Zippel", "email": "zippel@linux-m68k.org", "date": "2007-09-06T23:00:01Z"}, "committer": {"name": "Roman Zippel", "email": "zippel@gcc.gnu.org", "date": "2007-09-06T23:00:01Z"}, "message": "boehm.c (mark_reference_fields): Move misaligned pointer check\n\tafter JREFERENCE_TYPE_P test\n\nFrom-SVN: r128208", "tree": {"sha": "ccbc349cc13f7fd295ce205e7e9613249e16e037", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ccbc349cc13f7fd295ce205e7e9613249e16e037"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d/comments", "author": null, "committer": null, "parents": [{"sha": "bc211e05e3379205a808c2f2fa050ba6cc03cf22", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bc211e05e3379205a808c2f2fa050ba6cc03cf22", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bc211e05e3379205a808c2f2fa050ba6cc03cf22"}], "stats": {"total": 19, "additions": 12, "deletions": 7}, "files": [{"sha": "9b637bc24d2f7edaee1ce94fa89e369daec55dce", "filename": "gcc/java/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d/gcc%2Fjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d/gcc%2Fjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2FChangeLog?ref=bdeb2c963f0df89b440bcb103ff7e48d83f19d0d", "patch": "@@ -1,3 +1,8 @@\n+2007-09-07  Roman Zippel  <zippel@linux-m68k.org>\n+\n+\tboehm.c (mark_reference_fields): Move misaligned pointer check\n+\tafter JREFERENCE_TYPE_P test\n+\n 2007-09-06  Roman Zippel  <zippel@linux-m68k.org>\n \n \t* boehm.c (mark_reference_fields): Don't use bitmap as gc_descr"}, {"sha": "5c65c8bb0cc392c5fe57da8f82692ef7574a9e34", "filename": "gcc/java/boehm.c", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d/gcc%2Fjava%2Fboehm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bdeb2c963f0df89b440bcb103ff7e48d83f19d0d/gcc%2Fjava%2Fboehm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fjava%2Fboehm.c?ref=bdeb2c963f0df89b440bcb103ff7e48d83f19d0d", "patch": "@@ -98,13 +98,6 @@ mark_reference_fields (tree field,\n       offset = int_byte_position (field);\n       size_bytes = int_size_in_bytes (TREE_TYPE (field));\n \n-      if (offset % (POINTER_SIZE / BITS_PER_UNIT))\n-\t{\n-\t  *all_bits_set = -1;\n-\t  *pointer_after_end = 1;\n-\t  break;\n-\t}\n-\n       if (JREFERENCE_TYPE_P (TREE_TYPE (field))\n \t  /* An `object' of type gnu.gcj.RawData is actually non-Java\n \t     data.  */\n@@ -118,6 +111,13 @@ mark_reference_fields (tree field,\n \t     we already covered, then we are doomed.  */\n \t  gcc_assert (offset > *last_view_index);\n \n+\t  if (offset % (POINTER_SIZE / BITS_PER_UNIT))\n+\t    {\n+\t      *all_bits_set = -1;\n+\t      *pointer_after_end = 1;\n+\t      break;\n+\t    }\n+\n \t  count = offset * BITS_PER_UNIT / POINTER_SIZE;\n \t  size_words = size_bytes * BITS_PER_UNIT / POINTER_SIZE;\n "}]}