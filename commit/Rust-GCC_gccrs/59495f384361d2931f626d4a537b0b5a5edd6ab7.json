{"sha": "59495f384361d2931f626d4a537b0b5a5edd6ab7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NTk0OTVmMzg0MzYxZDI5MzFmNjI2ZDRhNTM3YjBiNWE1ZWRkNmFiNw==", "commit": {"author": {"name": "Zack Weinberg", "email": "zack@wolery.cumb.org", "date": "2000-01-30T03:31:59Z"}, "committer": {"name": "Zack Weinberg", "email": "zack@gcc.gnu.org", "date": "2000-01-30T03:31:59Z"}, "message": "cpperror.c (cpp_file_line_for_message): If 'line' is zero, just print \"<command line>\".\n\n\t* cpperror.c (cpp_file_line_for_message): If 'line' is zero,\n\tjust print \"<command line>\".  If 'filename' is null or an\n\tempty string, print \"<stdin>\" for the filename.\n\t* cpplib.c (do_define): Don't print the 'location of the\n\tprevious definition' message if we're still parsing the\n\tcommand line.\n\t(cpp_pedwarn_with_file_and_line): Always call\n\tcpp_file_line_for_message.\n\nFrom-SVN: r31697", "tree": {"sha": "79fd63777562408a7a168cbfdeed51b0d2eb1186", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/79fd63777562408a7a168cbfdeed51b0d2eb1186"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/59495f384361d2931f626d4a537b0b5a5edd6ab7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59495f384361d2931f626d4a537b0b5a5edd6ab7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/59495f384361d2931f626d4a537b0b5a5edd6ab7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/59495f384361d2931f626d4a537b0b5a5edd6ab7/comments", "author": null, "committer": null, "parents": [{"sha": "607ace9b9bec36a74b0c8f4af4ed0eefc6bddca3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/607ace9b9bec36a74b0c8f4af4ed0eefc6bddca3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/607ace9b9bec36a74b0c8f4af4ed0eefc6bddca3"}], "stats": {"total": 22, "additions": 18, "deletions": 4}, "files": [{"sha": "8685404320070d1b516f1dea36aa3ddf537e12bf", "filename": "gcc/ChangeLog", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59495f384361d2931f626d4a537b0b5a5edd6ab7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59495f384361d2931f626d4a537b0b5a5edd6ab7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=59495f384361d2931f626d4a537b0b5a5edd6ab7", "patch": "@@ -1,3 +1,14 @@\n+2000-01-29  Zack Weinberg  <zack@wolery.cumb.org>\n+\n+\t* cpperror.c (cpp_file_line_for_message): If 'line' is zero,\n+\tjust print \"<command line>\".  If 'filename' is null or an\n+\tempty string, print \"<stdin>\" for the filename.\n+\t* cpplib.c (do_define): Don't print the 'location of the\n+\tprevious definition' message if we're still parsing the\n+\tcommand line.\n+\t(cpp_pedwarn_with_file_and_line): Always call\n+\tcpp_file_line_for_message.\n+\n 2000-01-29  Mark Mitchell  <mark@codesourcery.com>\n \n \t* flow.c (mark_regs_live_at_end): Fix typo."}, {"sha": "d0900e84373ddca1c53e36b906b342a3c42b5566", "filename": "gcc/cpperror.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59495f384361d2931f626d4a537b0b5a5edd6ab7/gcc%2Fcpperror.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59495f384361d2931f626d4a537b0b5a5edd6ab7/gcc%2Fcpperror.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpperror.c?ref=59495f384361d2931f626d4a537b0b5a5edd6ab7", "patch": "@@ -84,7 +84,11 @@ cpp_file_line_for_message (pfile, filename, line, column)\n      const char *filename;\n      int line, column;\n {\n-  if (column > 0)\n+  if (filename == 0 || *filename == '\\0')\n+    filename = \"<stdin>\";\n+  if (line == 0)\n+    fputs (_(\"<command line>: \"), stderr);\n+  else if (column > 0)\n     fprintf (stderr, \"%s:%d:%d: \", filename, line, column);\n   else\n     fprintf (stderr, \"%s:%d: \", filename, line);"}, {"sha": "cdfdaa3e29d49cf9815c0d3c96fe8f6fb87c45bf", "filename": "gcc/cpplib.c", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/59495f384361d2931f626d4a537b0b5a5edd6ab7/gcc%2Fcpplib.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/59495f384361d2931f626d4a537b0b5a5edd6ab7/gcc%2Fcpplib.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcpplib.c?ref=59495f384361d2931f626d4a537b0b5a5edd6ab7", "patch": "@@ -685,7 +685,7 @@ do_define (pfile, keyword)\n \t\t       mdef.symlen, mdef.symnam);\n \t  else\n \t    cpp_pedwarn (pfile, \"`%.*s' redefined\", mdef.symlen, mdef.symnam);\n-\t  if (hp->type == T_MACRO)\n+\t  if (hp->type == T_MACRO && CPP_OPTIONS (pfile)->done_initializing)\n \t    cpp_pedwarn_with_file_and_line (pfile, hp->value.defn->file,\n \t\t\t\t\t    hp->value.defn->line,\n \t\t\t\"this is the location of the previous definition\");\n@@ -3474,8 +3474,7 @@ cpp_pedwarn_with_file_and_line VPARAMS ((cpp_reader *pfile, const char *file,\n   if (!CPP_OPTIONS (pfile)->pedantic_errors\n       && CPP_OPTIONS (pfile)->inhibit_warnings)\n     return;\n-  if (file != NULL)\n-    cpp_file_line_for_message (pfile, file, line, -1);\n+  cpp_file_line_for_message (pfile, file, line, -1);\n   v_cpp_message (pfile, CPP_OPTIONS (pfile)->pedantic_errors, msgid, ap);\n   va_end(ap);\n }"}]}