{"sha": "f6815e4095ac7b14940d15df33b38154275155ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjY4MTVlNDA5NWFjN2IxNDk0MGQxNWRmMzNiMzgxNTQyNzUxNTVlYw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2014-09-15T19:46:12Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2014-09-15T19:46:12Z"}, "message": "re PR fortran/56408 (Fix dependency handling of testsuite/gfortran.dg)\n\n\tPR fortran/56408\n\t* gfortran.dg/dg.exp (gfortran_test_path, gfortran_aux_module_flags):\n\tNew global vars.\n\t(dg-compile-aux-modules): New procedure.\n\t* gfortran.dg/binding_label_tests_10.f03: Remove comment\n\tand keep-modules.\n\t* gfortran.dg/binding_label_tests_10_main.f03: Remove comment,\n\tuse dg-compile-aux-modules.\n\t* gfortran.dg/binding_label_tests_11.f03: Remove comment\n\tand keep-modules.\n\t* gfortran.dg/binding_label_tests_11_main.f03: Remove comment,\n\tuse dg-compile-aux-modules.\n\t* gfortran.dg/binding_label_tests_13.f03: Remove comment\n\tand keep-modules.\n\t* gfortran.dg/binding_label_tests_13_main.f03: Remove comment,\n\tuse dg-compile-aux-modules.\n\t* gfortran.dg/binding_label_tests_26a.f90: Remove comment\n\tand keep-modules.\n\t* gfortran.dg/binding_label_tests_26b.f90: Remove comment,\n\tuse dg-compile-aux-modules.\n\t* gfortran.dg/class_45a.f03: Remove keep-modules.\n\t* gfortran.dg/class_45b.f03: Use dg-compile-aux-modules\n\tand cleanup-modules.\n\t* gfortran.dg/class_4a.f03: Use dg-do link, use\n\tdg-additional-sources and cleanup-modules, remove keep-modules\n\tand update comment.\n\t* gfortran.dg/class_4b.f03: Don't compile anywhere, remove\n\tkeep-modules, adjust comment.\n\t* gfortran.dg/class_4c.f03: Don't compile anywhere, remove\n\tdg-additional-sources and cleanup-modules.\n\t* gfortran.dg/coarray_29_1.f90: Remove keep-modules and\n\tassociated comment.\n\t* gfortran.dg/coarray_29_2.f90: Use dg-compile-aux-modules,\n\tremove comment.\n\t* gfortran.dg/test_common_binding_labels_2.f03: Remove keep-modules.\n\t* gfortran.dg/test_common_binding_labels_2_main.f03: Remove comment,\n\tuse dg-compile-aux-modules.\n\t* gfortran.dg/test_common_binding_labels_3.f03: Remove keep-modules.\n\t* gfortran.dg/test_common_binding_labels_3_main.f03: Remove comment,\n\tuse dg-compile-aux-modules.\n\t* gfortran.dg/whole_file_28.f90: Remove comment and keep-modules.\n\t* gfortran.dg/whole_file_29.f90: Remove comment, use\n\tdg-compile-aux-modules.\n\t* gfortran.dg/whole_file_30.f90: Remove comment and keep-modules.\n\t* gfortran.dg/whole_file_31.f90: Remove comment, use\n\tdg-compile-aux-modules.\n\nFrom-SVN: r215275", "tree": {"sha": "84dc09e51a9208776ea467d303ac0d113f3debac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/84dc09e51a9208776ea467d303ac0d113f3debac"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f6815e4095ac7b14940d15df33b38154275155ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6815e4095ac7b14940d15df33b38154275155ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6815e4095ac7b14940d15df33b38154275155ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6815e4095ac7b14940d15df33b38154275155ec/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "6a3d8ef0b86f81b7eb72a29b3d5339f5062a8453", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a3d8ef0b86f81b7eb72a29b3d5339f5062a8453", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a3d8ef0b86f81b7eb72a29b3d5339f5062a8453"}], "stats": {"total": 139, "additions": 82, "deletions": 57}, "files": [{"sha": "45e2384281f7ae7f719cc3a608cc4bfcbe666797", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 47, "deletions": 0, "changes": 47, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,5 +1,52 @@\n 2014-09-15  Jakub Jelinek  <jakub@redhat.com>\n \n+\tPR fortran/56408\n+\t* gfortran.dg/dg.exp (gfortran_test_path, gfortran_aux_module_flags):\n+\tNew global vars.\n+\t(dg-compile-aux-modules): New procedure.\n+\t* gfortran.dg/binding_label_tests_10.f03: Remove comment\n+\tand keep-modules.\n+\t* gfortran.dg/binding_label_tests_10_main.f03: Remove comment,\n+\tuse dg-compile-aux-modules.\n+\t* gfortran.dg/binding_label_tests_11.f03: Remove comment\n+\tand keep-modules.\n+\t* gfortran.dg/binding_label_tests_11_main.f03: Remove comment,\n+\tuse dg-compile-aux-modules.\n+\t* gfortran.dg/binding_label_tests_13.f03: Remove comment\n+\tand keep-modules.\n+\t* gfortran.dg/binding_label_tests_13_main.f03: Remove comment,\n+\tuse dg-compile-aux-modules.\n+\t* gfortran.dg/binding_label_tests_26a.f90: Remove comment\n+\tand keep-modules.\n+\t* gfortran.dg/binding_label_tests_26b.f90: Remove comment,\n+\tuse dg-compile-aux-modules.\n+\t* gfortran.dg/class_45a.f03: Remove keep-modules.\n+\t* gfortran.dg/class_45b.f03: Use dg-compile-aux-modules\n+\tand cleanup-modules.\n+\t* gfortran.dg/class_4a.f03: Use dg-do link, use\n+\tdg-additional-sources and cleanup-modules, remove keep-modules\n+\tand update comment.\n+\t* gfortran.dg/class_4b.f03: Don't compile anywhere, remove\n+\tkeep-modules, adjust comment.\n+\t* gfortran.dg/class_4c.f03: Don't compile anywhere, remove\n+\tdg-additional-sources and cleanup-modules.\n+\t* gfortran.dg/coarray_29_1.f90: Remove keep-modules and\n+\tassociated comment.\n+\t* gfortran.dg/coarray_29_2.f90: Use dg-compile-aux-modules,\n+\tremove comment.\n+\t* gfortran.dg/test_common_binding_labels_2.f03: Remove keep-modules.\n+\t* gfortran.dg/test_common_binding_labels_2_main.f03: Remove comment,\n+\tuse dg-compile-aux-modules.\n+\t* gfortran.dg/test_common_binding_labels_3.f03: Remove keep-modules.\n+\t* gfortran.dg/test_common_binding_labels_3_main.f03: Remove comment,\n+\tuse dg-compile-aux-modules.\n+\t* gfortran.dg/whole_file_28.f90: Remove comment and keep-modules.\n+\t* gfortran.dg/whole_file_29.f90: Remove comment, use\n+\tdg-compile-aux-modules.\n+\t* gfortran.dg/whole_file_30.f90: Remove comment and keep-modules.\n+\t* gfortran.dg/whole_file_31.f90: Remove comment, use\n+\tdg-compile-aux-modules.\n+\n \t* lib/gcc-defs.exp (gcc_parallel_test_run_p,\n \tgcc_parallel_test_enable): New procedures.  If\n \tGCC_RUNTEST_PARALLELIZE_DIR is set in environment, override"}, {"sha": "0809c87f37824b8560b099dfd0d04654e6b7196b", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_10.f03", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_10.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_10.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_10.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,9 +1,6 @@\n ! { dg-do compile }\n-! This file must be compiled BEFORE binding_label_tests_10_main.f03, which it \n-! should be because dejagnu will sort the files.\n module binding_label_tests_10\n   use iso_c_binding\n   implicit none\n   integer(c_int), bind(c,name=\"c_one\") :: one\n end module binding_label_tests_10\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "bce5ef68c4272278c512b8bfae5668f884f736a5", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_10_main.f03", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_10_main.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_10_main.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_10_main.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,6 +1,5 @@\n ! { dg-do compile }\n-! This file must be compiled AFTER binding_label_tests_10.f03, which it \n-! should be because dejagnu will sort the files.\n+! { dg-compile-aux-modules \"binding_label_tests_10.f03\" }\n module binding_label_tests_10_main\n   use iso_c_binding\n   implicit none"}, {"sha": "c1fc98effb60e318350ec4a852b79f608df23e32", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_11.f03", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_11.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_11.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_11.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,6 +1,4 @@\n ! { dg-do compile }\n-! This file must be compiled BEFORE binding_label_tests_11_main.f03, which it \n-! should be because dejagnu will sort the files.\n module binding_label_tests_11\n   use iso_c_binding, only: c_int\n   implicit none\n@@ -10,4 +8,3 @@ function one() bind(c, name=\"c_one\")\n     one = 1\n   end function one\n end module binding_label_tests_11\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "7ee0c8de473c4bb42c7759209f4a118f9994cf15", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_11_main.f03", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_11_main.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_11_main.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_11_main.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,6 +1,5 @@\n ! { dg-do compile }\n-! This file must be compiled AFTER binding_label_tests_11.f03, which it \n-! should be because dejagnu will sort the files.\n+! { dg-compile-aux-modules \"binding_label_tests_11.f03\" }\n module binding_label_tests_11_main\n   use iso_c_binding, only: c_int\n   implicit none"}, {"sha": "71aac2dbf37873b6d7872886b99051244dcd523c", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_13.f03", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_13.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_13.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_13.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,9 +1,6 @@\n ! { dg-do compile }\n-! This file must be compiled BEFORE binding_label_tests_13_main.f03, which it \n-! should be because dejagnu will sort the files.  \n module binding_label_tests_13\n  use, intrinsic :: iso_c_binding, only: c_int\n   integer(c_int) :: c3\n   bind(c) c3\n end module binding_label_tests_13\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "66ff7cf33cf6bab0d9150bbcedd7ea820b84d9f9", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_13_main.f03", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_13_main.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_13_main.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_13_main.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,7 +1,5 @@\n ! { dg-do compile }\n-! This file must be compiled AFTER binding_label_tests_13.f03, which it \n-! should be because dejagnu will sort the files.  The module file \n-! binding_label_tests_13.mod can not be removed until after this test is done.\n+! { dg-compile-aux-modules \"binding_label_tests_13.f03\" }\n module binding_label_tests_13_main\n   use, intrinsic :: iso_c_binding, only: c_int\n   integer(c_int) :: c3  ! { dg-error \"Variable c3 from module binding_label_tests_13_main with binding label c3 at .1. uses the same global identifier as entity at .2. from module binding_label_tests_13\" }"}, {"sha": "d3f3039a713ba4ae4b9205a75498511c0162641f", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_26a.f90", "status": "modified", "additions": 0, "deletions": 4, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_26a.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_26a.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_26a.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -4,8 +4,6 @@\n !\n ! Contributed by Andrew Bensons <abensonca@gmail.com>\n !\n-! This file must be compiled BEFORE binding_label_tests_26b.f90, which it \n-! should be because dejagnu will sort the files.  \n \n module fg\n contains\n@@ -16,5 +14,3 @@ function f() bind(c)\n     end interface\n   end function\n end module\n-\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "ca399757dc83b86c7427d6a8c95042350581df89", "filename": "gcc/testsuite/gfortran.dg/binding_label_tests_26b.f90", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_26b.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_26b.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fbinding_label_tests_26b.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,11 +1,9 @@\n ! { dg-do compile }\n+! { dg-compile-aux-modules \"binding_label_tests_26a.f90\" }\n !\n ! PR 58182: [4.9 Regression] ICE with global binding name used as a FUNCTION\n !\n ! Contributed by Andrew Bensons <abensonca@gmail.com>\n-!\n-! This file must be compiled AFTER binding_label_tests_26a.f90, which it \n-! should be because dejagnu will sort the files.  \n \n module f    ! { dg-error \"uses the same global identifier\" }\n   use fg    ! { dg-error \"uses the same global identifier\" }"}, {"sha": "91f11c4ecce9d5945247dc18133359246e393db4", "filename": "gcc/testsuite/gfortran.dg/class_45a.f03", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_45a.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_45a.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_45a.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -26,4 +26,3 @@ function basicGet(self)\n   end function basicGet\n \n end module G_Nodes\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "90ef467530c73eba24c695cda7422b479e9b62e1", "filename": "gcc/testsuite/gfortran.dg/class_45b.f03", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_45b.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_45b.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_45b.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,5 +1,5 @@\n ! { dg-do link }\n-! { dg-additional-sources class_45a.f03 }\n+! { dg-compile-aux-modules \"class_45a.f03\" }\n !\n ! PR 50227: [4.7 Regression] [OOP] ICE-on-valid with allocatable class variable\n !\n@@ -10,3 +10,4 @@ program Test\n   class(t0), allocatable :: c\n   allocate(t1 :: c)\n end program Test\n+! { dg-final { cleanup-modules \"G_Nodes\" } }"}, {"sha": "015e53cbb1ba51c2b3d0000beedc27962f3cb436", "filename": "gcc/testsuite/gfortran.dg/class_4a.f03", "status": "modified", "additions": 4, "deletions": 3, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4a.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4a.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4a.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,15 +1,16 @@\n-! { dg-do compile }\n+! { dg-do link }\n+! { dg-additional-sources \"class_4b.f03 class_4c.f03\" }\n !\n ! Test the fix for PR41583, in which the different source files\n ! would generate the same 'vindex' for different class declared\n ! types.\n !\n-! The test comprises class_4a, class_4b class_4c and class_4d.f03\n+! The test comprises class_4a, class_4b and class_4c.f03\n \n ! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n !\n module m\n   type t\n   end type t\n end module m\n-! { dg-final { keep-modules \"m\" } }\n+! { dg-final { cleanup-modules \"m m2\" } }"}, {"sha": "dda55b5b0ae23db47b602a946ce1d3bb215c2c4c", "filename": "gcc/testsuite/gfortran.dg/class_4b.f03", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4b.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4b.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4b.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,10 +1,11 @@\n-! { dg-do compile }\n+! Don't compile this anywhere.\n+! { dg-do compile { target { lp64 && { ! lp64 } } } }\n !\n ! Test the fix for PR41583, in which the different source files\n ! would generate the same 'vindex' for different class declared\n ! types.\n !\n-! The test comprises class_4a, class_4b class_4c and class_4d.f03\n+! The test comprises class_4a, class_4b class_4c.f03\n !\n ! Contributed by Tobias Burnus <burnus@gcc.gnu.org>\n !\n@@ -13,4 +14,3 @@ module m2\n   type, extends(t) :: t2\n   end type t2\n end module m2\n-! { dg-final { keep-modules \"m2\" } }"}, {"sha": "e78a30966f5893b9340746ead30d7510b202d4b1", "filename": "gcc/testsuite/gfortran.dg/class_4c.f03", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4c.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4c.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_4c.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,5 +1,5 @@\n-! { dg-do link }\n-! { dg-additional-sources class_4a.f03 class_4b.f03 }\n+! Don't compile this anywhere.\n+! { dg-do compile { target { lp64 && { ! lp64 } } } }\n !\n ! Test the fix for PR41583, in which the different source files\n ! would generate the same 'vindex' for different class declared\n@@ -27,4 +27,3 @@\n   end select\n   print *, i\n end\n-! { dg-final { cleanup-modules \"m m2\" } }"}, {"sha": "7d04aa8c511da7bbf40d3a9796c6b21c0d778726", "filename": "gcc/testsuite/gfortran.dg/coarray_29_1.f90", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_29_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_29_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_29_1.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -11,6 +11,3 @@ subroutine co_sum(scalar)\n     integer scalar[*]\n   end subroutine\n end module\n-\n-! DO NOT CLEAN UP THE MODULE FILE - coarray_29_2.f90 does it.\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "d653f3f6f6ec8384ac0b054ad667a4e9e8f261c2", "filename": "gcc/testsuite/gfortran.dg/coarray_29_2.f90", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_29_2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_29_2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fcoarray_29_2.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,8 +1,6 @@\n ! { dg-do compile }\n ! { dg-options \"-fcoarray=single\" }\n-\n-! Requires that coarray_29.f90 has been compiled before\n-! and that, thus, co_sum_module is available\n+! { dg-compile-aux-modules \"coarray_29_1.f90\" }\n \n ! PR fortran/55272\n !"}, {"sha": "e8c39231db00d17a26e505fcf3d811d37b6b4b9d", "filename": "gcc/testsuite/gfortran.dg/dg.exp", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fdg.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fdg.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fdg.exp?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -28,6 +28,21 @@ if ![info exists DEFAULT_FFLAGS] then {\n # Initialize `dg'.\n dg-init\n \n+global gfortran_test_path\n+global gfortran_aux_module_flags\n+set gfortran_test_path $srcdir/$subdir\n+set gfortran_aux_module_flags $DEFAULT_FFLAGS\n+proc dg-compile-aux-modules { args } {\n+    global gfortran_test_path\n+    global gfortran_aux_module_flags\n+    if { [llength $args] != 2 } {\n+\terror \"dg-set-target-env-var: needs one argument\"\n+\treturn\n+    }\n+    dg-test $gfortran_test_path/[lindex $args 1] \"\" $gfortran_aux_module_flags\n+    # cleanup-modules isn't intentionally invoked here.\n+}\n+\n # Main loop.\n gfortran-dg-runtest [lsort \\\n        [glob -nocomplain $srcdir/$subdir/*.\\[fF\\]{,90,95,03,08} ] ] \"\" $DEFAULT_FFLAGS"}, {"sha": "8c319028a6d061b7bc871ea20080c2edcfb2a3df", "filename": "gcc/testsuite/gfortran.dg/test_common_binding_labels_2.f03", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_2.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_2.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_2.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -12,4 +12,3 @@ module test_common_binding_labels_2\n   integer(c_int) :: i\n   bind(c, name=\"\") /com2/\n end module test_common_binding_labels_2\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "cd1664137baa1e6b4535afc290a5228e0fb048c3", "filename": "gcc/testsuite/gfortran.dg/test_common_binding_labels_2_main.f03", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_2_main.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_2_main.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_2_main.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,9 +1,7 @@\n ! { dg-do compile }\n ! { dg-options \"-std=f2003\" }\n+! { dg-compile-aux-modules \"test_common_binding_labels_2.f03\" }\n !\n-!\n-! This file depends on the module test_common_binding_labels_2.  That module\n-! must be compiled first and not be removed until after this test.\n module test_common_binding_labels_2_main\n   use, intrinsic :: iso_c_binding, only: c_double, c_int\n   implicit none"}, {"sha": "87d6c6b78f972d7718d231063f2b76288dbb41d7", "filename": "gcc/testsuite/gfortran.dg/test_common_binding_labels_3.f03", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_3.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_3.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_3.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -8,4 +8,3 @@ module test_common_binding_labels_3\n   real(c_double) :: s\n   bind(c, name=\"my_common_block\") :: /mycom/\n end module test_common_binding_labels_3\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "9ad55156e8349b61d5c60ce099e78dfd168249d8", "filename": "gcc/testsuite/gfortran.dg/test_common_binding_labels_3_main.f03", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_3_main.f03", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_3_main.f03", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Ftest_common_binding_labels_3_main.f03?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,6 +1,5 @@\n ! { dg-do compile }\n-! This file depends on the module test_common_binding_labels_3.  That module\n-! must be compiled first and not be removed until after this test.\n+! { dg-compile-aux-modules \"test_common_binding_labels_3.f03\" }\n module test_common_binding_labels_3_main\n   use, intrinsic :: iso_c_binding, only: c_int\n   integer(c_int), bind(c, name=\"my_common_block\") :: my_int ! { dg-error \"COMMON block at .1. with binding label my_common_block uses the same global identifier as entity at .2.\" }"}, {"sha": "681b123f4ee83847243e29e997cd8c8e39a1c67e", "filename": "gcc/testsuite/gfortran.dg/whole_file_28.f90", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_28.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_28.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_28.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,6 +1,5 @@\n ! { dg-do compile }\n ! Test the fix for the problem described in PR45077 comments #4 and #5.\n-! Note that the module file is kept for whole_file_29.f90\n !\n ! Contributed by Tobias Burnus  <burnus@gcc.gnu.org>\n !\n@@ -9,5 +8,3 @@ module iso_red\n      character(LEN=1), dimension(:), allocatable :: chars\n   end type varying_string\n end module iso_red\n-! DO NOT CLEAN UP THE MODULE FILE - whole_file_29.f90 does it.\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "86d84cf8d27db11a58b9f58d57aa6c6c171cfb8d", "filename": "gcc/testsuite/gfortran.dg/whole_file_29.f90", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_29.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_29.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_29.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,7 +1,6 @@\n ! { dg-do compile }\n+! { dg-compile-aux-modules \"whole_file_28.f90\" }\n ! Test the fix for the problem described in PR45077 comments #4 and #5.\n-! Note that the module file from whole_file_28.f90, 'iso_red', is\n-! needed for this test.\n !\n ! Contributed by Tobias Burnus  <burnus@gcc.gnu.org>\n !"}, {"sha": "551f2e801a881eb628f2f38a151335a9b5c0f4db", "filename": "gcc/testsuite/gfortran.dg/whole_file_30.f90", "status": "modified", "additions": 0, "deletions": 3, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_30.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_30.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_30.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,6 +1,5 @@\n ! { dg-do compile }\n ! Test the fix for the problem described in PR46818.\n-! Note that the module file is kept for whole_file_31.f90\n !\n ! Contributed by Martien Hulsen  <m.a.hulsen@tue.nl>\n ! and reduced by Tobias Burnus  <burnus@gcc.gnu.org>\n@@ -12,5 +11,3 @@ module system_defs_m\n     real, allocatable, dimension(:) :: u\n   end type sysvector_t\n end module system_defs_m\n-! DO NOT CLEAN UP THE MODULE FILE - whole_file_31.f90 does it.\n-! { dg-final { keep-modules \"\" } }"}, {"sha": "1ed661dd8e342bfa1a46bb929e2c0f7de5ceb2e6", "filename": "gcc/testsuite/gfortran.dg/whole_file_31.f90", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_31.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f6815e4095ac7b14940d15df33b38154275155ec/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_31.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwhole_file_31.f90?ref=f6815e4095ac7b14940d15df33b38154275155ec", "patch": "@@ -1,7 +1,6 @@\n ! { dg-do compile }\n+! { dg-compile-aux-modules \"whole_file_30.f90\" }\n ! Test the fix for the problem described in PR46818.\n-! Note that the module file from whole_file_30.f90, 'system_defs_m',\n-! is needed for this test.\n !\n ! Contributed by Martien Hulsen  <m.a.hulsen@tue.nl>\n ! and reduced by Tobias Burnus  <burnus@gcc.gnu.org>"}]}