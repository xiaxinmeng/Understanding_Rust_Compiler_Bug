{"sha": "bd96cb7805f5674f8c582908b43a6a98c2b7f72c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YmQ5NmNiNzgwNWY1Njc0ZjhjNTgyOTA4YjQzYTZhOThjMmI3ZjcyYw==", "commit": {"author": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-12T04:55:12Z"}, "committer": {"name": "Richard Stallman", "email": "rms@gnu.org", "date": "1993-05-12T04:55:12Z"}, "message": "(call, call_value): Copy fn address to safe reg if necessary.\n\n(call, call_value matchers): Use call_insn_operand as predicate.\n\nFrom-SVN: r4429", "tree": {"sha": "e55524628f4e13d8537e34147c0bf8b91b8cdfd5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e55524628f4e13d8537e34147c0bf8b91b8cdfd5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/bd96cb7805f5674f8c582908b43a6a98c2b7f72c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd96cb7805f5674f8c582908b43a6a98c2b7f72c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bd96cb7805f5674f8c582908b43a6a98c2b7f72c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bd96cb7805f5674f8c582908b43a6a98c2b7f72c/comments", "author": null, "committer": null, "parents": [{"sha": "2026444ac9804a075ac6c5e16c1f8d43e9005139", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2026444ac9804a075ac6c5e16c1f8d43e9005139", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2026444ac9804a075ac6c5e16c1f8d43e9005139"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "f53b9ce579771abab3cc44ccf006571c54748dd7", "filename": "gcc/config/i860/i860.md", "status": "modified", "additions": 15, "deletions": 5, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/bd96cb7805f5674f8c582908b43a6a98c2b7f72c/gcc%2Fconfig%2Fi860%2Fi860.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/bd96cb7805f5674f8c582908b43a6a98c2b7f72c/gcc%2Fconfig%2Fi860%2Fi860.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi860%2Fi860.md?ref=bd96cb7805f5674f8c582908b43a6a98c2b7f72c", "patch": "@@ -2116,6 +2116,11 @@ fmul.ss %1,%0,%4\\;fmul.ss %3,%4,%0\\\";\n   \"\"\n   \"\n {\n+  /* Make sure the address is just one reg and will stay that way.  */\n+  if (! call_insn_operand (operands[0], QImode))\n+    operands[0]\n+      = change_address (operands[0], VOIDmode,\n+\t\t\tcopy_to_mode_reg (Pmode, XEXP (operands[0], 0)));\n   if (INTVAL (operands[1]) > 0)\n     {\n       emit_move_insn (arg_pointer_rtx, stack_pointer_rtx);\n@@ -2125,7 +2130,7 @@ fmul.ss %1,%0,%4\\;fmul.ss %3,%4,%0\\\";\n \n ;;- jump to subroutine\n (define_insn \"\"\n-  [(call (match_operand:SI 0 \"memory_operand\" \"m\")\n+  [(call (match_operand:SI 0 \"call_insn_operand\" \"m\")\n \t (match_operand 1 \"\" \"i\"))]\n   ;; operand[2] is next_arg_register\n   \"\"\n@@ -2158,7 +2163,7 @@ fmul.ss %1,%0,%4\\;fmul.ss %3,%4,%0\\\";\n (define_peephole\n   [(set (match_operand:SI 0 \"memory_operand\" \"=m\")\n \t(match_operand:SI 1 \"reg_or_0_operand\" \"rfJ\"))\n-   (call (match_operand:SI 2 \"memory_operand\" \"m\")\n+   (call (match_operand:SI 2 \"call_insn_operand\" \"m\")\n \t (match_operand 3 \"\" \"i\"))]\n   ;;- Don't use operand 1 for most machines.\n   \"\"\n@@ -2179,6 +2184,11 @@ fmul.ss %1,%0,%4\\;fmul.ss %3,%4,%0\\\";\n   \"\"\n   \"\n {\n+  /* Make sure the address is just one reg and will stay that way.  */\n+  if (! call_insn_operand (operands[1], QImode))\n+    operands[1]\n+      = change_address (operands[1], VOIDmode,\n+\t\t\tcopy_to_mode_reg (Pmode, XEXP (operands[1], 0)));\n   if (INTVAL (operands[2]) > 0)\n     {\n       emit_move_insn (arg_pointer_rtx, stack_pointer_rtx);\n@@ -2188,7 +2198,7 @@ fmul.ss %1,%0,%4\\;fmul.ss %3,%4,%0\\\";\n \n (define_insn \"\"\n   [(set (match_operand 0 \"register_operand\" \"=rf\")\n-\t(call (match_operand:SI 1 \"memory_operand\" \"m\")\n+\t(call (match_operand:SI 1 \"call_insn_operand\" \"m\")\n \t      (match_operand 2 \"\" \"i\")))]\n   ;; operand 3 is next_arg_register\n   \"\"\n@@ -2206,7 +2216,7 @@ fmul.ss %1,%0,%4\\;fmul.ss %3,%4,%0\\\";\n   [(set (match_operand:SI 0 \"register_operand\" \"=rf\")\n \t(match_operand:SI 1 \"single_insn_src_p\" \"gfG\"))\n    (set (match_operand 2 \"\" \"=rf\")\n-\t(call (match_operand:SI 3 \"memory_operand\" \"m\")\n+\t(call (match_operand:SI 3 \"call_insn_operand\" \"m\")\n \t      (match_operand 4 \"\" \"i\")))]\n   ;;- Don't use operand 4 for most machines.\n   \"! reg_mentioned_p (operands[0], operands[3])\"\n@@ -2223,7 +2233,7 @@ fmul.ss %1,%0,%4\\;fmul.ss %3,%4,%0\\\";\n   [(set (match_operand:SI 0 \"memory_operand\" \"=m\")\n \t(match_operand:SI 1 \"reg_or_0_operand\" \"rJf\"))\n    (set (match_operand 2 \"\" \"=rf\")\n-\t(call (match_operand:SI 3 \"memory_operand\" \"m\")\n+\t(call (match_operand:SI 3 \"call_insn_operand\" \"m\")\n \t      (match_operand 4 \"\" \"i\")))]\n   ;;- Don't use operand 4 for most machines.\n   \"\""}]}