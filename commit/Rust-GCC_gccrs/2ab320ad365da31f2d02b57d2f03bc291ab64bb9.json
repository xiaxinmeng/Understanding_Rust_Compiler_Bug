{"sha": "2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmFiMzIwYWQzNjVkYTMxZjJkMDJiNTdkMmYwM2JjMjkxYWI2NGJiOQ==", "commit": {"author": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2015-08-03T10:03:55Z"}, "committer": {"name": "Mikael Morin", "email": "mikael@gcc.gnu.org", "date": "2015-08-03T10:03:55Z"}, "message": "Fix random class_allocate_18.f90 failure\n\n\tPR fortran/64921\ngcc/fortran/\n\t* class.c (generate_finalization_wrapper): Set finalization\n\tprocedure symbol's always_explicit attribute.\ngcc/testsuite/\n\t* gfortran.dg/class_allocate_20.f90: New.\n\nFrom-SVN: r226493", "tree": {"sha": "29f18a52b53636fb4ec84ebafe091f84638056af", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/29f18a52b53636fb4ec84ebafe091f84638056af"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/comments", "author": null, "committer": null, "parents": [{"sha": "44fef04ab18f57111e7d9f7dcd88d76a3c7bfc09", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/44fef04ab18f57111e7d9f7dcd88d76a3c7bfc09", "html_url": "https://github.com/Rust-GCC/gccrs/commit/44fef04ab18f57111e7d9f7dcd88d76a3c7bfc09"}], "stats": {"total": 56, "additions": 50, "deletions": 6}, "files": [{"sha": "03ea33cc996bf6440e60d8fc0648da57b021f038", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "patch": "@@ -1,3 +1,9 @@\n+2015-08-03  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\tPR fortran/64921\n+\t* class.c (generate_finalization_wrapper): Set finalization\n+\tprocedure symbol's always_explicit attribute.\n+\n 2015-08-01  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/67091"}, {"sha": "7a9e2755a0fd87487006cce3e6894630ae7ba6a0", "filename": "gcc/fortran/class.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ffortran%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ffortran%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fclass.c?ref=2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "patch": "@@ -1599,6 +1599,7 @@ generate_finalization_wrapper (gfc_symbol *derived, gfc_namespace *ns,\n   final->ts.type = BT_INTEGER;\n   final->ts.kind = 4;\n   final->attr.artificial = 1;\n+  final->attr.always_explicit = 1;\n   final->attr.if_source = expr_null_wrapper ? IFSRC_IFBODY : IFSRC_DECL;\n   if (ns->proc_name->attr.flavor == FL_MODULE)\n     final->module = ns->proc_name->name;"}, {"sha": "be48d3939934a198294b74603fbacbfe425641ce", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 11, "deletions": 6, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "patch": "@@ -1,16 +1,21 @@\n+2015-08-03  Mikael Morin  <mikael@gcc.gnu.org>\n+\n+\tPR fortran/64921\n+\t* gfortran.dg/class_allocate_20.f90: New.\n+\n 2015-08-03  Kyrylo Tkachov  <kyrylo.tkachov@arm.com>\n \n \t* gcc.target/aarch64/csel_bfx_1.c: New test.\n \t* gcc.target/aarch64/csel_imms_inc_1.c: Likewise.\n \n 2015-08-02  Martin Sebor  <msebor@redhat.com>\n \n-        * g++.dg/Wframe-address-in-Wall.C: New test.\n-        * g++.dg/Wframe-address.C: New test.\n-        * g++.dg/Wno-frame-address.C: New test.\n-        * gcc.dg/Wframe-address-in-Wall.c: New test.\n-        * gcc.dg/Wframe-address.c: New test.\n-        * gcc.dg/Wno-frame-address.c: New test.\n+\t* g++.dg/Wframe-address-in-Wall.C: New test.\n+\t* g++.dg/Wframe-address.C: New test.\n+\t* g++.dg/Wno-frame-address.C: New test.\n+\t* gcc.dg/Wframe-address-in-Wall.c: New test.\n+\t* gcc.dg/Wframe-address.c: New test.\n+\t* gcc.dg/Wno-frame-address.c: New test.\n \n 2015-08-02  Patrick Palka  <ppalka@gcc.gnu.org>\n "}, {"sha": "defe9df9d06d384bfc8388a6e6f39140f0a8bb14", "filename": "gcc/testsuite/gfortran.dg/class_allocate_20.f90", "status": "added", "additions": 32, "deletions": 0, "changes": 32, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_allocate_20.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2ab320ad365da31f2d02b57d2f03bc291ab64bb9/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_allocate_20.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fclass_allocate_20.f90?ref=2ab320ad365da31f2d02b57d2f03bc291ab64bb9", "patch": "@@ -0,0 +1,32 @@\n+! { dg-do run }\n+!\n+! PR fortran/64921\n+! Test that the finalization wrapper procedure get the always_explicit\n+! attribute so that the array is not passed without descriptor from \n+! T3's finalization wrapper procedure to T2's one.\n+!\n+! Contributed by Mat Cross  <mathewc@nag.co.uk>\n+\n+Program test\n+  Implicit None\n+  Type :: t1\n+    Integer, Allocatable :: i\n+  End Type\n+  Type :: t2\n+    Integer, Allocatable :: i\n+  End Type\n+  Type, Extends (t1) :: t3\n+    Type (t2) :: j\n+  End Type\n+  Type, Extends (t3) :: t4\n+    Integer, Allocatable :: k\n+  End Type\n+  Call s\n+  Print *, 'ok'\n+Contains\n+  Subroutine s\n+    Class (t1), Allocatable :: x\n+    Allocate (t4 :: x)\n+  End Subroutine\n+End Program\n+! { dg-output \"ok\" }"}]}