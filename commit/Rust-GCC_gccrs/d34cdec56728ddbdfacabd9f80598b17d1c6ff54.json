{"sha": "d34cdec56728ddbdfacabd9f80598b17d1c6ff54", "node_id": "C_kwDOANBUbNoAKGQzNGNkZWM1NjcyOGRkYmRmYWNhYmQ5ZjgwNTk4YjE3ZDFjNmZmNTQ", "commit": {"author": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2022-02-21T09:41:53Z"}, "committer": {"name": "Andre Vieira", "email": "andre.simoesdiasvieira@arm.com", "date": "2022-02-21T09:41:53Z"}, "message": "rtl-optimization/104498: Fix comparing symbol reference\n\ngcc/ChangeLog:\n\n\tPR rtl-optimization/104498\n\t* alias.cc (compare_base_symbol_refs): Correct distance computation\n\twhen swapping x and y.", "tree": {"sha": "6cf9bcc5d14258f3e46b152632d8ce77059f8214", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6cf9bcc5d14258f3e46b152632d8ce77059f8214"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d34cdec56728ddbdfacabd9f80598b17d1c6ff54", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d34cdec56728ddbdfacabd9f80598b17d1c6ff54", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d34cdec56728ddbdfacabd9f80598b17d1c6ff54", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d34cdec56728ddbdfacabd9f80598b17d1c6ff54/comments", "author": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "avieira-arm", "id": 68072104, "node_id": "MDQ6VXNlcjY4MDcyMTA0", "avatar_url": "https://avatars.githubusercontent.com/u/68072104?v=4", "gravatar_id": "", "url": "https://api.github.com/users/avieira-arm", "html_url": "https://github.com/avieira-arm", "followers_url": "https://api.github.com/users/avieira-arm/followers", "following_url": "https://api.github.com/users/avieira-arm/following{/other_user}", "gists_url": "https://api.github.com/users/avieira-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/avieira-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avieira-arm/subscriptions", "organizations_url": "https://api.github.com/users/avieira-arm/orgs", "repos_url": "https://api.github.com/users/avieira-arm/repos", "events_url": "https://api.github.com/users/avieira-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/avieira-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e01530ec1e33f7df9c2acd0489d6d1f766cb1921", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e01530ec1e33f7df9c2acd0489d6d1f766cb1921", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e01530ec1e33f7df9c2acd0489d6d1f766cb1921"}], "stats": {"total": 6, "additions": 4, "deletions": 2}, "files": [{"sha": "8c08452e0acfcbf1bfd8fd2e8cd420b5b929d6b4", "filename": "gcc/alias.cc", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d34cdec56728ddbdfacabd9f80598b17d1c6ff54/gcc%2Falias.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d34cdec56728ddbdfacabd9f80598b17d1c6ff54/gcc%2Falias.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Falias.cc?ref=d34cdec56728ddbdfacabd9f80598b17d1c6ff54", "patch": "@@ -2195,6 +2195,7 @@ compare_base_symbol_refs (const_rtx x_base, const_rtx y_base,\n   tree x_decl = SYMBOL_REF_DECL (x_base);\n   tree y_decl = SYMBOL_REF_DECL (y_base);\n   bool binds_def = true;\n+  bool swap = false;\n \n   if (XSTR (x_base, 0) == XSTR (y_base, 0))\n     return 1;\n@@ -2204,6 +2205,7 @@ compare_base_symbol_refs (const_rtx x_base, const_rtx y_base,\n     {\n       if (!x_decl)\n \t{\n+\t  swap = true;\n \t  std::swap (x_decl, y_decl);\n \t  std::swap (x_base, y_base);\n \t}\n@@ -2238,8 +2240,8 @@ compare_base_symbol_refs (const_rtx x_base, const_rtx y_base,\n       if (SYMBOL_REF_BLOCK (x_base) != SYMBOL_REF_BLOCK (y_base))\n \treturn 0;\n       if (distance)\n-\t*distance += (SYMBOL_REF_BLOCK_OFFSET (y_base)\n-\t\t      - SYMBOL_REF_BLOCK_OFFSET (x_base));\n+\t*distance += (swap ? -1 : 1) * (SYMBOL_REF_BLOCK_OFFSET (y_base)\n+\t\t\t\t\t- SYMBOL_REF_BLOCK_OFFSET (x_base));\n       return binds_def ? 1 : -1;\n     }\n   /* Either the symbols are equal (via aliasing) or they refer to"}]}