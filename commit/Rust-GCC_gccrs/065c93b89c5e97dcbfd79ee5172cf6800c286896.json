{"sha": "065c93b89c5e97dcbfd79ee5172cf6800c286896", "node_id": "C_kwDOANBUbNoAKDA2NWM5M2I4OWM1ZTk3ZGNiZmQ3OWVlNTE3MmNmNjgwMGMyODY4OTY", "commit": {"author": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2023-03-09T18:37:29Z"}, "committer": {"name": "Patrick Palka", "email": "ppalka@redhat.com", "date": "2023-03-09T18:37:29Z"}, "message": "libstdc++: Implement LWG 3796 changes to repeat_/chunk_by_view [PR109024]\n\n\tPR libstdc++/109024\n\nlibstdc++-v3/ChangeLog:\n\n\t* include/std/ranges (chunk_by_view::_M_pred): Remove DMI as per\n\tLWG 3796.\n\t(repeat_view::_M_pred): Likewise.\n\t* testsuite/std/ranges/adaptors/chunk_by/1.cc (test03): New test.\n\t* testsuite/std/ranges/repeat/1.cc (test05): New test.", "tree": {"sha": "660a06b0eb4dcd5031feb62929493e466884bc54", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/660a06b0eb4dcd5031feb62929493e466884bc54"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/065c93b89c5e97dcbfd79ee5172cf6800c286896", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/065c93b89c5e97dcbfd79ee5172cf6800c286896", "html_url": "https://github.com/Rust-GCC/gccrs/commit/065c93b89c5e97dcbfd79ee5172cf6800c286896", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/065c93b89c5e97dcbfd79ee5172cf6800c286896/comments", "author": null, "committer": null, "parents": [{"sha": "95827e1b9f7d5dd5a697bd60292e3876a7e8c15c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/95827e1b9f7d5dd5a697bd60292e3876a7e8c15c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/95827e1b9f7d5dd5a697bd60292e3876a7e8c15c"}], "stats": {"total": 20, "additions": 18, "deletions": 2}, "files": [{"sha": "f6809413ee19cbcea4d4a9cc99b9ce7718fb8240", "filename": "libstdc++-v3/include/std/ranges", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/065c93b89c5e97dcbfd79ee5172cf6800c286896/libstdc%2B%2B-v3%2Finclude%2Fstd%2Franges", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/065c93b89c5e97dcbfd79ee5172cf6800c286896/libstdc%2B%2B-v3%2Finclude%2Fstd%2Franges", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Finclude%2Fstd%2Franges?ref=065c93b89c5e97dcbfd79ee5172cf6800c286896", "patch": "@@ -6735,7 +6735,7 @@ namespace views::__adaptor\n   class chunk_by_view : public view_interface<chunk_by_view<_Vp, _Pred>>\n   {\n     _Vp _M_base = _Vp();\n-    __detail::__box<_Pred> _M_pred = _Pred();\n+    __detail::__box<_Pred> _M_pred;\n     __detail::_CachedPosition<_Vp> _M_cached_begin;\n \n     constexpr iterator_t<_Vp>\n@@ -7411,7 +7411,7 @@ namespace views::__adaptor\n       && (__detail::__is_integer_like<_Bound> || same_as<_Bound, unreachable_sentinel_t>))\n   class repeat_view : public view_interface<repeat_view<_Tp, _Bound>>\n   {\n-    __detail::__box<_Tp> _M_value = _Tp();\n+    __detail::__box<_Tp> _M_value;\n     [[no_unique_address]] _Bound _M_bound = _Bound();\n \n     struct _Iterator;"}, {"sha": "f165c7d9a9574f018ee089a21e22ddbf0c39e2b6", "filename": "libstdc++-v3/testsuite/std/ranges/adaptors/chunk_by/1.cc", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/065c93b89c5e97dcbfd79ee5172cf6800c286896/libstdc%2B%2B-v3%2Ftestsuite%2Fstd%2Franges%2Fadaptors%2Fchunk_by%2F1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/065c93b89c5e97dcbfd79ee5172cf6800c286896/libstdc%2B%2B-v3%2Ftestsuite%2Fstd%2Franges%2Fadaptors%2Fchunk_by%2F1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fstd%2Franges%2Fadaptors%2Fchunk_by%2F1.cc?ref=065c93b89c5e97dcbfd79ee5172cf6800c286896", "patch": "@@ -54,9 +54,17 @@ test02()\n   VERIFY( i == v.end() );\n }\n \n+void\n+test03()\n+{\n+  // LWG 3796\n+  ranges::chunk_by_view<ranges::empty_view<int>, ranges::equal_to> r;\n+}\n+\n int\n main()\n {\n   static_assert(test01());\n   test02();\n+  test03();\n }"}, {"sha": "07b70891042c95d85513451f51f5d44df05df4b0", "filename": "libstdc++-v3/testsuite/std/ranges/repeat/1.cc", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/065c93b89c5e97dcbfd79ee5172cf6800c286896/libstdc%2B%2B-v3%2Ftestsuite%2Fstd%2Franges%2Frepeat%2F1.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/065c93b89c5e97dcbfd79ee5172cf6800c286896/libstdc%2B%2B-v3%2Ftestsuite%2Fstd%2Franges%2Frepeat%2F1.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libstdc%2B%2B-v3%2Ftestsuite%2Fstd%2Franges%2Frepeat%2F1.cc?ref=065c93b89c5e97dcbfd79ee5172cf6800c286896", "patch": "@@ -120,11 +120,19 @@ test04()\n   return true;\n }\n \n+void\n+test05()\n+{\n+  // LWG 3796\n+  ranges::repeat_view<int> r;\n+}\n+\n int\n main()\n {\n   static_assert(test01());\n   static_assert(test02());\n   static_assert(test03());\n   static_assert(test04());\n+  test05();\n }"}]}