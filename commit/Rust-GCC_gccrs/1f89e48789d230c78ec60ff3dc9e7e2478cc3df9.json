{"sha": "1f89e48789d230c78ec60ff3dc9e7e2478cc3df9", "node_id": "C_kwDOANBUbNoAKDFmODllNDg3ODlkMjMwYzc4ZWM2MGZmM2RjOWU3ZTI0NzhjYzNkZjk", "commit": {"author": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2022-05-12T15:51:43Z"}, "committer": {"name": "Thomas Schwinge", "email": "thomas@codesourcery.com", "date": "2022-05-13T12:01:01Z"}, "message": "libgomp nvptx plugin: Only consider '--with-cuda-driver=[...]' when applicable\n\nThey're not applicable in 'PLUGIN_NVPTX_DYNAMIC' configurations.\n\n\tlibgomp/\n\t* plugin/Makefrag.am (libgomp_plugin_nvptx_la_CPPFLAGS)\n\t[PLUGIN_NVPTX_DYNAMIC]: Don't append '$(PLUGIN_NVPTX_CPPFLAGS)'.\n\t(libgomp_plugin_nvptx_la_LDFLAGS) [PLUGIN_NVPTX_DYNAMIC]: Don't\n\tappend '$(PLUGIN_NVPTX_LDFLAGS)'.\n\t* Makefile.in: Regenerate.", "tree": {"sha": "ac18bb965f3574823de643c89385b2bcbf3d2d97", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ac18bb965f3574823de643c89385b2bcbf3d2d97"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9/comments", "author": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "committer": {"login": "tschwinge", "id": 21753, "node_id": "MDQ6VXNlcjIxNzUz", "avatar_url": "https://avatars.githubusercontent.com/u/21753?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tschwinge", "html_url": "https://github.com/tschwinge", "followers_url": "https://api.github.com/users/tschwinge/followers", "following_url": "https://api.github.com/users/tschwinge/following{/other_user}", "gists_url": "https://api.github.com/users/tschwinge/gists{/gist_id}", "starred_url": "https://api.github.com/users/tschwinge/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tschwinge/subscriptions", "organizations_url": "https://api.github.com/users/tschwinge/orgs", "repos_url": "https://api.github.com/users/tschwinge/repos", "events_url": "https://api.github.com/users/tschwinge/events{/privacy}", "received_events_url": "https://api.github.com/users/tschwinge/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "04c0a88aabe8f73f87d6b756aaa0925e58229c99", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/04c0a88aabe8f73f87d6b756aaa0925e58229c99", "html_url": "https://github.com/Rust-GCC/gccrs/commit/04c0a88aabe8f73f87d6b756aaa0925e58229c99"}], "stats": {"total": 23, "additions": 13, "deletions": 10}, "files": [{"sha": "2ac0397a036d8a497d877dce2262910ea3fb5016", "filename": "libgomp/Makefile.in", "status": "modified", "additions": 10, "deletions": 8, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9/libgomp%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9/libgomp%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FMakefile.in?ref=1f89e48789d230c78ec60ff3dc9e7e2478cc3df9", "patch": "@@ -122,13 +122,15 @@ target_triplet = @target@\n \n # Including the GCC-shipped 'include/cuda/cuda.h' vs. system <cuda.h>.\n @PLUGIN_NVPTX_DYNAMIC_FALSE@@PLUGIN_NVPTX_TRUE@am__append_2 = -DPLUGIN_NVPTX_INCLUDE_SYSTEM_CUDA_H \\\n+@PLUGIN_NVPTX_DYNAMIC_FALSE@@PLUGIN_NVPTX_TRUE@\t$(PLUGIN_NVPTX_CPPFLAGS) \\\n @PLUGIN_NVPTX_DYNAMIC_FALSE@@PLUGIN_NVPTX_TRUE@\t-DPLUGIN_NVPTX_LINK_LIBCUDA\n \n # 'dlopen'ing the CUDA Driver library vs. linking it.\n @PLUGIN_NVPTX_DYNAMIC_TRUE@@PLUGIN_NVPTX_TRUE@am__append_3 = $(DL_LIBS)\n-@PLUGIN_NVPTX_DYNAMIC_FALSE@@PLUGIN_NVPTX_TRUE@am__append_4 = $(PLUGIN_NVPTX_LIBS)\n-@PLUGIN_GCN_TRUE@am__append_5 = libgomp-plugin-gcn.la\n-@USE_FORTRAN_TRUE@am__append_6 = openacc.f90\n+@PLUGIN_NVPTX_DYNAMIC_FALSE@@PLUGIN_NVPTX_TRUE@am__append_4 = $(PLUGIN_NVPTX_LDFLAGS)\n+@PLUGIN_NVPTX_DYNAMIC_FALSE@@PLUGIN_NVPTX_TRUE@am__append_5 = $(PLUGIN_NVPTX_LIBS)\n+@PLUGIN_GCN_TRUE@am__append_6 = libgomp-plugin-gcn.la\n+@USE_FORTRAN_TRUE@am__append_7 = openacc.f90\n subdir = .\n ACLOCAL_M4 = $(top_srcdir)/aclocal.m4\n am__aclocal_m4_deps = $(top_srcdir)/../config/acx.m4 \\\n@@ -536,7 +538,7 @@ libsubincludedir = $(libdir)/gcc/$(target_alias)/$(gcc_version)/include\n AM_CPPFLAGS = $(addprefix -I, $(search_path))\n AM_CFLAGS = $(XCFLAGS)\n AM_LDFLAGS = $(XLDFLAGS) $(SECTION_LDFLAGS) $(OPT_LDFLAGS)\n-toolexeclib_LTLIBRARIES = libgomp.la $(am__append_1) $(am__append_5)\n+toolexeclib_LTLIBRARIES = libgomp.la $(am__append_1) $(am__append_6)\n nodist_toolexeclib_HEADERS = libgomp.spec\n \n # -Wc is only a libtool option.\n@@ -563,18 +565,18 @@ libgomp_la_SOURCES = alloc.c atomic.c barrier.c critical.c env.c \\\n \toacc-parallel.c oacc-host.c oacc-init.c oacc-mem.c \\\n \toacc-async.c oacc-plugin.c oacc-cuda.c priority_queue.c \\\n \taffinity-fmt.c teams.c allocator.c oacc-profiling.c \\\n-\toacc-target.c $(am__append_6)\n+\toacc-target.c $(am__append_7)\n \n # Nvidia PTX OpenACC plugin.\n @PLUGIN_NVPTX_TRUE@libgomp_plugin_nvptx_version_info = -version-info $(libtool_VERSION)\n @PLUGIN_NVPTX_TRUE@libgomp_plugin_nvptx_la_SOURCES = plugin/plugin-nvptx.c\n @PLUGIN_NVPTX_TRUE@libgomp_plugin_nvptx_la_CPPFLAGS = $(AM_CPPFLAGS) \\\n-@PLUGIN_NVPTX_TRUE@\t$(PLUGIN_NVPTX_CPPFLAGS) $(am__append_2)\n+@PLUGIN_NVPTX_TRUE@\t$(am__append_2)\n @PLUGIN_NVPTX_TRUE@libgomp_plugin_nvptx_la_LDFLAGS =  \\\n @PLUGIN_NVPTX_TRUE@\t$(libgomp_plugin_nvptx_version_info) \\\n-@PLUGIN_NVPTX_TRUE@\t$(lt_host_flags) $(PLUGIN_NVPTX_LDFLAGS)\n+@PLUGIN_NVPTX_TRUE@\t$(lt_host_flags) $(am__append_4)\n @PLUGIN_NVPTX_TRUE@libgomp_plugin_nvptx_la_LIBADD = libgomp.la \\\n-@PLUGIN_NVPTX_TRUE@\t$(am__append_3) $(am__append_4)\n+@PLUGIN_NVPTX_TRUE@\t$(am__append_3) $(am__append_5)\n @PLUGIN_NVPTX_TRUE@libgomp_plugin_nvptx_la_LIBTOOLFLAGS = --tag=disable-static\n \n # AMD GCN plugin"}, {"sha": "66c8c12c1a662f48ce0a526e7513058a3ca87ed6", "filename": "libgomp/plugin/Makefrag.am", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9/libgomp%2Fplugin%2FMakefrag.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1f89e48789d230c78ec60ff3dc9e7e2478cc3df9/libgomp%2Fplugin%2FMakefrag.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Fplugin%2FMakefrag.am?ref=1f89e48789d230c78ec60ff3dc9e7e2478cc3df9", "patch": "@@ -33,24 +33,25 @@ if PLUGIN_NVPTX\n libgomp_plugin_nvptx_version_info = -version-info $(libtool_VERSION)\n toolexeclib_LTLIBRARIES += libgomp-plugin-nvptx.la\n libgomp_plugin_nvptx_la_SOURCES = plugin/plugin-nvptx.c\n-libgomp_plugin_nvptx_la_CPPFLAGS = $(AM_CPPFLAGS) $(PLUGIN_NVPTX_CPPFLAGS)\n+libgomp_plugin_nvptx_la_CPPFLAGS = $(AM_CPPFLAGS)\n libgomp_plugin_nvptx_la_LDFLAGS = $(libgomp_plugin_nvptx_version_info) \\\n \t$(lt_host_flags)\n-libgomp_plugin_nvptx_la_LDFLAGS += $(PLUGIN_NVPTX_LDFLAGS)\n libgomp_plugin_nvptx_la_LIBADD = libgomp.la\n libgomp_plugin_nvptx_la_LIBTOOLFLAGS = --tag=disable-static\n \n # Including the GCC-shipped 'include/cuda/cuda.h' vs. system <cuda.h>.\n if PLUGIN_NVPTX_DYNAMIC\n else\n libgomp_plugin_nvptx_la_CPPFLAGS += -DPLUGIN_NVPTX_INCLUDE_SYSTEM_CUDA_H\n+libgomp_plugin_nvptx_la_CPPFLAGS += $(PLUGIN_NVPTX_CPPFLAGS)\n endif\n \n # 'dlopen'ing the CUDA Driver library vs. linking it.\n if PLUGIN_NVPTX_DYNAMIC\n libgomp_plugin_nvptx_la_LIBADD += $(DL_LIBS)\n else\n libgomp_plugin_nvptx_la_CPPFLAGS += -DPLUGIN_NVPTX_LINK_LIBCUDA\n+libgomp_plugin_nvptx_la_LDFLAGS += $(PLUGIN_NVPTX_LDFLAGS)\n libgomp_plugin_nvptx_la_LIBADD += $(PLUGIN_NVPTX_LIBS)\n endif\n endif"}]}