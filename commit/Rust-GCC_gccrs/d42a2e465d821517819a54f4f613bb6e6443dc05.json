{"sha": "d42a2e465d821517819a54f4f613bb6e6443dc05", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDQyYTJlNDY1ZDgyMTUxNzgxOWE1NGY0ZjYxM2JiNmU2NDQzZGMwNQ==", "commit": {"author": {"name": "Fritz Reese", "email": "foreese@gcc.gnu.org", "date": "2020-04-06T20:14:29Z"}, "committer": {"name": "Fritz Reese", "email": "foreese@gcc.gnu.org", "date": "2020-04-06T20:17:07Z"}, "message": "Fix fortran/93686 -- ICE matching data statements with derived-type pointers.\n\ngcc/fortran/ChangeLog:\n\n2020-04-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/93686\n\t* decl.c (gfc_match_data): Handle data matching for derived type\n\tpointers.\n\ngcc/testsuite/ChangeLog:\n\n2020-04-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n\n\tPR fortran/93686\n\t* gfortran.dg/pr93686_1.f90: New test.\n\t* gfortran.dg/pr93686_2.f90: Likewise.\n\t* gfortran.dg/pr93686_3.f90: Likewise.\n\t* gfortran.dg/pr93686_4.f90: Likewise.", "tree": {"sha": "3052cae914d59825bb79bc922c5c1c2707b00330", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3052cae914d59825bb79bc922c5c1c2707b00330"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d42a2e465d821517819a54f4f613bb6e6443dc05", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d42a2e465d821517819a54f4f613bb6e6443dc05", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d42a2e465d821517819a54f4f613bb6e6443dc05", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d42a2e465d821517819a54f4f613bb6e6443dc05/comments", "author": null, "committer": null, "parents": [{"sha": "130f703da0c0d7b785d394b17df884379b4aadd9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/130f703da0c0d7b785d394b17df884379b4aadd9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/130f703da0c0d7b785d394b17df884379b4aadd9"}], "stats": {"total": 55, "additions": 55, "deletions": 0}, "files": [{"sha": "435f93d0d9e275814965f1f30b8abe5b2163bf5b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=d42a2e465d821517819a54f4f613bb6e6443dc05", "patch": "@@ -1,3 +1,9 @@\n+2020-04-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/93686\n+\t* decl.c (gfc_match_data): Handle data matching for derived type\n+\tpointers.\n+\n 2020-04-02  Tobias Burnus  <tobias@codesourcery.com>\n \n \t* gfortran.h (gfc_resolve_formal_arglist): Add prototype."}, {"sha": "b3ed63c97cc7c8efcdfaa6e95708af06133de4ce", "filename": "gcc/fortran/decl.c", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ffortran%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ffortran%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fdecl.c?ref=d42a2e465d821517819a54f4f613bb6e6443dc05", "patch": "@@ -696,6 +696,10 @@ gfc_match_data (void)\n \t  /* F2008:C567 (R536) A data-i-do-object or a variable that appears\n \t     as a data-stmt-object shall not be an object designator in which\n \t     a pointer appears other than as the entire rightmost part-ref.  */\n+\t  if (!e->ref && e->ts.type == BT_DERIVED\n+\t      && e->symtree->n.sym->attr.pointer)\n+\t    goto partref;\n+\n \t  ref = e->ref;\n \t  if (e->symtree->n.sym->ts.type == BT_DERIVED\n \t      && e->symtree->n.sym->attr.pointer"}, {"sha": "ef5e0cf527ca6f35c7b721031bdc9558196a2e5b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d42a2e465d821517819a54f4f613bb6e6443dc05", "patch": "@@ -1,3 +1,11 @@\n+2020-04-06  Steven G. Kargl  <kargl@gcc.gnu.org>\n+\n+\tPR fortran/93686\n+\t* gfortran.dg/pr93686_1.f90: New test.\n+\t* gfortran.dg/pr93686_2.f90: Likewise.\n+\t* gfortran.dg/pr93686_3.f90: Likewise.\n+\t* gfortran.dg/pr93686_4.f90: Likewise.\n+\n 2020-04-06  Joel Brobecker  <brobecker@adacore.com>\n \n \t* gcc.target/arm/div64-unwinding.c: Skip on vxworks_kernel targets."}, {"sha": "0e7560a5c17a2a1d0305c470d84f41f4897beb7c", "filename": "gcc/testsuite/gfortran.dg/pr93686_1.f90", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_1.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_1.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_1.f90?ref=d42a2e465d821517819a54f4f613bb6e6443dc05", "patch": "@@ -0,0 +1,10 @@\n+! { dg-do compile }\n+! PR fortran/93686\n+\n+program p\n+   type t\n+      integer :: a\n+   end type\n+   type(t), pointer :: x\n+   data x /t(2)/ ! { dg-error \"part-ref with pointer attribute near ... is not rightmost part-ref of data-stmt-object\" }\n+end"}, {"sha": "aac4d9138ee52fa953793d69f888cd20ec15308e", "filename": "gcc/testsuite/gfortran.dg/pr93686_2.f90", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_2.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_2.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_2.f90?ref=d42a2e465d821517819a54f4f613bb6e6443dc05", "patch": "@@ -0,0 +1,10 @@\n+! { dg-do compile }\n+! PR fortran/93686\n+\n+program p\n+   type t\n+      integer :: a = 1\n+   end type\n+   type(t), pointer :: x\n+   data x /t(2)/ ! { dg-error \"part-ref with pointer attribute near ... is not rightmost part-ref of data-stmt-object\" }\n+end"}, {"sha": "5b570407f8f2174e64159e1122f93fd34fbd0173", "filename": "gcc/testsuite/gfortran.dg/pr93686_3.f90", "status": "added", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_3.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_3.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_3.f90?ref=d42a2e465d821517819a54f4f613bb6e6443dc05", "patch": "@@ -0,0 +1,9 @@\n+! { dg-do compile }\n+! PR fortran/93686\n+\n+program p\n+   type t\n+   end type\n+   type(t), pointer :: x\n+   data x /t()/ ! { dg-error \"part-ref with pointer attribute near ... is not rightmost part-ref of data-stmt-object\" }\n+end"}, {"sha": "ff3ae764ab778ea90d43403aef687d3069b999a2", "filename": "gcc/testsuite/gfortran.dg/pr93686_4.f90", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_4.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d42a2e465d821517819a54f4f613bb6e6443dc05/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_4.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fpr93686_4.f90?ref=d42a2e465d821517819a54f4f613bb6e6443dc05", "patch": "@@ -0,0 +1,8 @@\n+! { dg-do compile }\n+! PR fortran/93686\n+\n+type t\n+end type\n+type(t), pointer :: x\n+data x / ! { dg-error \"part-ref with pointer attribute near ... is not rightmost part-ref of data-stmt-object\" }\n+end"}]}