{"sha": "305f8c5bafed302aebd3e9f68bfb1685478c6a86", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzA1ZjhjNWJhZmVkMzAyYWViZDNlOWY2OGJmYjE2ODU0NzhjNmE4Ng==", "commit": {"author": {"name": "Kresten Krab Thorup", "email": "krab@gcc.gnu.org", "date": "1993-04-12T15:00:55Z"}, "committer": {"name": "Kresten Krab Thorup", "email": "krab@gcc.gnu.org", "date": "1993-04-12T15:00:55Z"}, "message": "Updated for new runtime\n\nFrom-SVN: r4088", "tree": {"sha": "a3de9bdac5132959c7e56a268cf017293ad1846d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/a3de9bdac5132959c7e56a268cf017293ad1846d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/305f8c5bafed302aebd3e9f68bfb1685478c6a86", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/305f8c5bafed302aebd3e9f68bfb1685478c6a86", "html_url": "https://github.com/Rust-GCC/gccrs/commit/305f8c5bafed302aebd3e9f68bfb1685478c6a86", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/305f8c5bafed302aebd3e9f68bfb1685478c6a86/comments", "author": null, "committer": null, "parents": [{"sha": "96b11bedc4305854045be1dabf1a6bb5d1816b18", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/96b11bedc4305854045be1dabf1a6bb5d1816b18", "html_url": "https://github.com/Rust-GCC/gccrs/commit/96b11bedc4305854045be1dabf1a6bb5d1816b18"}], "stats": {"total": 99, "additions": 47, "deletions": 52}, "files": [{"sha": "3d6d38e9d6192f470dab03d77abaef48306704bb", "filename": "gcc/objc/Makefile.in", "status": "modified", "additions": 47, "deletions": 52, "changes": 99, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/305f8c5bafed302aebd3e9f68bfb1685478c6a86/gcc%2Fobjc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/305f8c5bafed302aebd3e9f68bfb1685478c6a86/gcc%2Fobjc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fobjc%2FMakefile.in?ref=305f8c5bafed302aebd3e9f68bfb1685478c6a86", "patch": "@@ -1,8 +1,6 @@\n #  GNU Objective C Runtime Makefile\n #  Copyright (C) 1993 Free Software Foundation, Inc.\n #\n-#  Author: Kresten Krab Thorup\n-#\n #  This file is part of GNU CC.\n #\n #  GNU CC is free software; you can redistribute it and/or modify it under the\n@@ -16,20 +14,22 @@\n #\n #  You should have received a copy of the GNU General Public License along with\n #  GNU CC; see the file COPYING.  If not, write to the Free Software\n-#  Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.\n-#\n-# This makefile is run by the parent dir's makefile.\n-# thisdir1=`pwd`; \\\n-# srcdir1=`cd $(srcdir); pwd`; \\\n-# cd objc; \\\n-# $(MAKE) $(MAKEFLAGS) -f $$srcdir1/objc/Makefile libobjc.a \\\n-#   srcdir=$$srcdir1 tooldir=$(tooldir) AR=\"$(AR)\" AR_FLAGS=\"$(AR_FLAGS)\" \\\n-#   GCC_FOR_TARGET=\"$$thisdir1/xgcc -B$$thisdir1/\" \\\n-#   GCC_CFLAGS=\"$(GCC_CFLAGS)\"\n-# Two targets are used by ../Makefile: `all' and `mostlyclean'.\n+#  Foundation, 675 Mass Ave, Cambridge, MA 02139, USA.  */\n+\n+#  This makefile is run by the parent dir's makefile.\n+#  thisdir1=`pwd`; \\\n+#  srcdir1=`cd $(srcdir); pwd`; \\\n+#  cd objc; \\\n+#  $(MAKE) $(MAKEFLAGS) -f $$srcdir1/objc/Makefile libobjc.a \\\n+#    srcdir=$$srcdir1 tooldir=$(tooldir) AR=\"$(AR)\" AR_FLAGS=\"$(AR_FLAGS)\" \\\n+#    GCC_FOR_TARGET=\"$$thisdir1/xgcc -B$$thisdir1/\" \\\n+#    GCC_CFLAGS=\"$(GCC_CFLAGS)\" incinstalldir=$$thisdir1/include\n+#  Two targets are used by ../Makefile: `all' and `mostlyclean'.\n \n .SUFFIXES: .m\n \n+OPTIMIZE= -O\n+\n VPATH = $(srcdir)/objc\n \n AR = ar\n@@ -39,59 +39,54 @@ AR_FLAGS = rc\n SUBDIR_INCLUDES = -I. -I.. -I$(srcdir) -I$(srcdir)/config\n \n .c.o:\n-\t$(GCC_FOR_TARGET) -c $(GCC_CFLAGS) $(SUBDIR_INCLUDES) $<\n+\t$(GCC_FOR_TARGET) $(OPTIMIZE) -c $(GCC_CFLAGS) $(SUBDIR_INCLUDES) $<\n \n .m.o:\n-\t$(GCC_FOR_TARGET) -c $(GCC_CFLAGS) $(SUBDIR_INCLUDES) $<\n+\t$(GCC_FOR_TARGET) $(OPTIMIZE)  -fgnu-runtime \\\n+\t\t-c $(GCC_CFLAGS) $(SUBDIR_INCLUDES) $<\n \n # If we were not invoked from the parent dir,\n # invoke make in the parent dir and have reinvoke this makefile.\n # That's necessary to get the right values for srcdir, etc.\n all:\n \tcd ..; $(MAKE) sublibobjc.a\n \n-OBJS = hash.o sarray.o objc-class.o objc-msg.o objc-init.o objc-archive.o \\\n-\tobjc-sel.o objc-object.o objc-misc.o Object.o Protocol.o\n-\n-all: libobjc.a\n-\n-runtime.h: hash.h list.h sarray.h objc.h objc-api.h\n-\n-Object.m: Object.h\n-\n-Object.h: objc.h objc-api.h \n-\n-sarray.c: sarray.h\n-\n-hash.c: hash.h\n-\n-objc-class.c: runtime.h\n+OBJC_O = hash.o sarray.o objc-class.o objc-msg.o objc-init.o objc-archive.o \\\n+         objc-sel.o objc-object.o objc-misc.o Object.o Protocol.o\n \n-objc-msg.c: runtime.h\n-\n-objc-init.c: runtime.h\n-\n-objc-sel.c: runtime.h\n-\n-objc-object.c: runtime.h\n-\n-objc-class.o: objc-class.c\n-\n-objc-msg.o: objc-msg.c\n-\n-objc-init.o: objc-init.c\n-\n-objc-sel.o: objc-sel.c\n-\n-objc-object.o: objc-object.c\n-\n-libobjc.a: $(OBJS)\n+libobjc.a: $(OBJC_O)\n \t-rm -f libobjc.a\n-\t$(AR) rc libobjc.a $(OBJS)\n+\t$(AR) rc libobjc.a $(OBJC_O)\n # ranlib is run in the parent directory's makefile.\n \n+OBJC_H = hash.h list.h sarray.h objc.h \\\n+         objc-api.h objc-archive.h cache.h \\\n+\t Object.h Protocol.h mutex.h\n+\n+# copy objc headers to installation include directory\n+copy-headers: $(OBJC_H)\n+\t-rm -fr $(incinstalldir)/objc\n+\tmkdir $(incinstalldir)/objc\n+\tfor file in $(OBJC_H); do \\\n+\t  realfile=$(srcdir)/objc/$$file; \\\n+\t  cp $$realfile $(incinstalldir)/objc; \\\n+\t  chmod a+r $(incinstalldir)/objc; \\\n+\tdone\n+\n+objc-msg.o: objc-msg.c fflags\n+\t$(GCC_FOR_TARGET) `cat fflags` -c $(GCC_CFLAGS) $(SUBDIR_INCLUDES) $<\n+\n+## Next to are for heuristics on forwarding mechanism... \n+_forward: _forward.c\n+\t$(GCC_FOR_TARGET) -c $(GCC_CFLAGS) $(SUBDIR_INCLUDES) $<\n+\t$(GCC_FOR_TARGET) ./_forward.o -o _forward\n+\n+fflags: _forward\n+\t-rm -f fflags\n+\t-./_forward > fflags\n+\n mostlyclean:\n-\t-rm -f $(OBJS) libobjc.a\n+\t-rm -f *.o libobjc.a _forward fflags\n clean: mostlyclean\n distclean: mostlyclean\n extraclean: mostlyclean"}]}