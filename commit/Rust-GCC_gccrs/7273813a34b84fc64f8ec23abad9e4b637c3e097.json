{"sha": "7273813a34b84fc64f8ec23abad9e4b637c3e097", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzI3MzgxM2EzNGI4NGZjNjRmOGVjMjNhYmFkOWU0YjYzN2MzZTA5Nw==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-01-26T20:06:57Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-01-26T20:06:57Z"}, "message": "re PR c/47473 (Incorrect computation with complex numbers when using -std=c99)\n\n\tPR c/47473\n\t* c-lex.c (interpret_float): If CPP_N_IMAGINARY, ensure\n\tEXCESS_PRECISION_EXPR is created with COMPLEX_TYPE instead of\n\tREAL_TYPE.\n\n\t* gcc.dg/torture/pr47473.c: New test.\n\nFrom-SVN: r169299", "tree": {"sha": "1a382eef761458761e42465c78ca92bf5de32aa3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1a382eef761458761e42465c78ca92bf5de32aa3"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7273813a34b84fc64f8ec23abad9e4b637c3e097", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7273813a34b84fc64f8ec23abad9e4b637c3e097", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7273813a34b84fc64f8ec23abad9e4b637c3e097", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7273813a34b84fc64f8ec23abad9e4b637c3e097/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "b800200de69f1e9a77813e3973a8ffeb821aa4c9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b800200de69f1e9a77813e3973a8ffeb821aa4c9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b800200de69f1e9a77813e3973a8ffeb821aa4c9"}], "stats": {"total": 41, "additions": 37, "deletions": 4}, "files": [{"sha": "d18ba202bced9c4b211fa9a00a09d082b9aa8883", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=7273813a34b84fc64f8ec23abad9e4b637c3e097", "patch": "@@ -1,3 +1,10 @@\n+2011-01-26  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/47473\n+\t* c-lex.c (interpret_float): If CPP_N_IMAGINARY, ensure\n+\tEXCESS_PRECISION_EXPR is created with COMPLEX_TYPE instead of\n+\tREAL_TYPE.\n+\n 2011-01-26  Arnaud Charlet  <charlet@adacore.com>\n \n \t* c-ada-spec.c (dump_generic_ada_node): Avoid dereferencing null type."}, {"sha": "1ea57f1cdda1577eaa43ba4d8e393f2ebab8180b", "filename": "gcc/c-family/c-lex.c", "status": "modified", "additions": 11, "deletions": 4, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Fc-family%2Fc-lex.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Fc-family%2Fc-lex.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-lex.c?ref=7273813a34b84fc64f8ec23abad9e4b637c3e097", "patch": "@@ -1,7 +1,7 @@\n /* Mainly the interface between cpplib and the C front ends.\n    Copyright (C) 1987, 1988, 1989, 1992, 1994, 1995, 1996, 1997\n-   1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2007, 2008, 2009, 2010\n-   Free Software Foundation, Inc.\n+   1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2007, 2008, 2009, 2010,\n+   2011 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -752,8 +752,15 @@ interpret_float (const cpp_token *token, unsigned int flags)\n   /* Create a node with determined type and value.  */\n   value = build_real (const_type, real);\n   if (flags & CPP_N_IMAGINARY)\n-    value = build_complex (NULL_TREE, convert (const_type, integer_zero_node),\n-\t\t\t   value);\n+    {\n+      value = build_complex (NULL_TREE, convert (const_type,\n+\t\t\t\t\t\t integer_zero_node), value);\n+      if (type != const_type)\n+\t{\n+\t  const_type = TREE_TYPE (value);\n+\t  type = build_complex_type (type);\n+\t}\n+    }\n \n   if (type != const_type)\n     value = build1 (EXCESS_PRECISION_EXPR, type, value);"}, {"sha": "274471253a3bcb5cc5902bb7f8715369647e9438", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7273813a34b84fc64f8ec23abad9e4b637c3e097", "patch": "@@ -1,3 +1,8 @@\n+2011-01-26  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR c/47473\n+\t* gcc.dg/torture/pr47473.c: New test.\n+\n 2011-01-26  Jan Hubicka  <jh@suse.cz>\n \n \tPR target/47237"}, {"sha": "92f2b872e8c661a89f8c9a1d6fd0f2d98fed8ec7", "filename": "gcc/testsuite/gcc.dg/torture/pr47473.c", "status": "added", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr47473.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7273813a34b84fc64f8ec23abad9e4b637c3e097/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr47473.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftorture%2Fpr47473.c?ref=7273813a34b84fc64f8ec23abad9e4b637c3e097", "patch": "@@ -0,0 +1,14 @@\n+/* PR c/47473 */\n+/* { dg-do run } */\n+/* { dg-options \"-std=c99\" } */\n+\n+int\n+main (void)\n+{\n+  long double _Complex w = 0.2L - 0.3iL;\n+  w = w * (0.3L - (0.0F + 1.0iF) * 0.9L);\n+  if (__builtin_fabsl (__real__ w + 0.21L) > 0.001L\n+      || __builtin_fabsl (__imag__ w + 0.27L) > 0.001L)\n+    __builtin_abort ();\n+  return 0;\n+}"}]}