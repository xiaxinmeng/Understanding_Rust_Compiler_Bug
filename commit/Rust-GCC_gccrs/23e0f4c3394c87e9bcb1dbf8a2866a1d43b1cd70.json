{"sha": "23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjNlMGY0YzMzOTRjODdlOWJjYjFkYmY4YTI4NjZhMWQ0M2IxY2Q3MA==", "commit": {"author": {"name": "Bernd Edlinger", "email": "bernd.edlinger@hotmail.de", "date": "2019-08-16T15:34:47Z"}, "committer": {"name": "Bernd Edlinger", "email": "edlinger@gcc.gnu.org", "date": "2019-08-16T15:34:47Z"}, "message": "re PR tree-optimization/91109 ([arm] gcc.c-torture/execute/20040709-1.c fails since r273135)\n\n2019-08-16  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n\n        PR tree-optimization/91109\n        * lra-int.h (lra_need_for_scratch_reg_p): Declare.\n        * lra.c (lra): Use lra_need_for_scratch_reg_p.\n        * lra-spills.c (lra_need_for_scratch_reg_p): New function.\n\nFrom-SVN: r274573", "tree": {"sha": "e11d868007b4d718baf76e7e4f55e4ec323930c4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e11d868007b4d718baf76e7e4f55e4ec323930c4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/comments", "author": {"login": "bernd-edlinger", "id": 17638929, "node_id": "MDQ6VXNlcjE3NjM4OTI5", "avatar_url": "https://avatars.githubusercontent.com/u/17638929?v=4", "gravatar_id": "", "url": "https://api.github.com/users/bernd-edlinger", "html_url": "https://github.com/bernd-edlinger", "followers_url": "https://api.github.com/users/bernd-edlinger/followers", "following_url": "https://api.github.com/users/bernd-edlinger/following{/other_user}", "gists_url": "https://api.github.com/users/bernd-edlinger/gists{/gist_id}", "starred_url": "https://api.github.com/users/bernd-edlinger/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/bernd-edlinger/subscriptions", "organizations_url": "https://api.github.com/users/bernd-edlinger/orgs", "repos_url": "https://api.github.com/users/bernd-edlinger/repos", "events_url": "https://api.github.com/users/bernd-edlinger/events{/privacy}", "received_events_url": "https://api.github.com/users/bernd-edlinger/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "94538b6545be9613ee25c80325e3cebf518730cf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/94538b6545be9613ee25c80325e3cebf518730cf", "html_url": "https://github.com/Rust-GCC/gccrs/commit/94538b6545be9613ee25c80325e3cebf518730cf"}], "stats": {"total": 27, "additions": 26, "deletions": 1}, "files": [{"sha": "772c4e928164190a91ab9352256316291d92901a", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "patch": "@@ -1,3 +1,10 @@\n+2019-08-16  Bernd Edlinger  <bernd.edlinger@hotmail.de>\n+\n+\tPR tree-optimization/91109\n+\t* lra-int.h (lra_need_for_scratch_reg_p): Declare.\n+\t* lra.c (lra): Use lra_need_for_scratch_reg_p.\n+\t* lra-spills.c (lra_need_for_scratch_reg_p): New function.\n+\n 2019-08-16  Uro\u0161 Bizjak  <ubizjak@gmail.com>\n \n \t* config/i386/mmx.md (mmxdoublemode): New mode attribute."}, {"sha": "77abb7b903e21888ea8fe16e26d10a516507d34f", "filename": "gcc/lra-int.h", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2Flra-int.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2Flra-int.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-int.h?ref=23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "patch": "@@ -396,6 +396,7 @@ extern bool lra_coalesce (void);\n \n /* lra-spills.c:  */\n \n+extern bool lra_need_for_scratch_reg_p (void);\n extern bool lra_need_for_spills_p (void);\n extern void lra_spill (void);\n extern void lra_final_code_change (void);"}, {"sha": "a322da81544b24a9cc2c668d27c2382c30cc52fc", "filename": "gcc/lra-spills.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2Flra-spills.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2Flra-spills.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra-spills.c?ref=23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "patch": "@@ -549,6 +549,19 @@ spill_pseudos (void)\n     }\n }\n \n+/* Return true if we need scratch reg assignments.  */\n+bool\n+lra_need_for_scratch_reg_p (void)\n+{\n+  int i; max_regno = max_reg_num ();\n+\n+  for (i = FIRST_PSEUDO_REGISTER; i < max_regno; i++)\n+    if (lra_reg_info[i].nrefs != 0 && lra_get_regno_hard_regno (i) < 0\n+\t&& lra_former_scratch_p (i))\n+      return true;\n+  return false;\n+}\n+\n /* Return true if we need to change some pseudos into memory.  */\n bool\n lra_need_for_spills_p (void)"}, {"sha": "1f977448136ce905735f410850f994d8a1cedbff", "filename": "gcc/lra.c", "status": "modified", "additions": 5, "deletions": 1, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2Flra.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70/gcc%2Flra.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Flra.c?ref=23e0f4c3394c87e9bcb1dbf8a2866a1d43b1cd70", "patch": "@@ -2567,7 +2567,11 @@ lra (FILE *f)\n \t  lra_create_live_ranges (lra_reg_spill_p, true);\n \t  live_p = true;\n \t  if (! lra_need_for_spills_p ())\n-\t    break;\n+\t    {\n+\t      if (lra_need_for_scratch_reg_p ())\n+\t\tcontinue;\n+\t      break;\n+\t    }\n \t}\n       lra_spill ();\n       /* Assignment of stack slots changes elimination offsets for"}]}