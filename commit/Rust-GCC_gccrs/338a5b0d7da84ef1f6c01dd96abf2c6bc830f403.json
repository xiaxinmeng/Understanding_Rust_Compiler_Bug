{"sha": "338a5b0d7da84ef1f6c01dd96abf2c6bc830f403", "node_id": "C_kwDOANBUbNoAKDMzOGE1YjBkN2RhODRlZjFmNmMwMWRkOTZhYmYyYzZiYzgzMGY0MDM", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2022-09-08T15:18:28Z"}, "committer": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2022-09-08T15:18:28Z"}, "message": "vect: Fix scalar stmt typo in vect_optimize_slp_pass [PR106886]\n\nFix a stupid typo in my vect_optimize_slp_pass patch.\n\ngcc/\n\tPR tree-optimization/106886\n\t* tree-vect-slp.cc (vect_optimize_slp_pass::get_result_with_layout):\n\tFix copying of scalar stmts.\n\ngcc/testsuite/\n\tPR tree-optimization/106886\n\t* gcc.dg/vect/bb-slp-layout-21.c: New test.", "tree": {"sha": "4a2db79af8eb0bca7cd30ff9b0c3d828ac0d0b23", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4a2db79af8eb0bca7cd30ff9b0c3d828ac0d0b23"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403", "html_url": "https://github.com/Rust-GCC/gccrs/commit/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "0697bd070c4fffb33468976c93baff9493922fb3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0697bd070c4fffb33468976c93baff9493922fb3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0697bd070c4fffb33468976c93baff9493922fb3"}], "stats": {"total": 25, "additions": 24, "deletions": 1}, "files": [{"sha": "c851d58c97a98e83e542704e1079c5f86364b8a2", "filename": "gcc/testsuite/gcc.dg/vect/bb-slp-layout-21.c", "status": "added", "additions": 23, "deletions": 0, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fbb-slp-layout-21.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fbb-slp-layout-21.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fvect%2Fbb-slp-layout-21.c?ref=338a5b0d7da84ef1f6c01dd96abf2c6bc830f403", "patch": "@@ -0,0 +1,23 @@\n+/* { dg-do compile } */\n+/* { dg-additional-options \"-march=bdver2\" { target x86_64-*-* i?86-*-* } } */\n+\n+int rl2GeomExport64_little_endian, rl2GeomExport64_little_endian_arch;\n+void rl2GeomExport64(unsigned char *p, double value) {\n+  union {\n+    unsigned char byte[8];\n+    double double_value;\n+  } convert;\n+  convert.double_value = value;\n+  if (rl2GeomExport64_little_endian_arch)\n+    if (rl2GeomExport64_little_endian) {\n+      *(p + 7) = convert.byte[0];\n+      *(p + 6) = convert.byte[1];\n+      *(p + 5) = convert.byte[2];\n+      *(p + 4) = convert.byte[3];\n+      *(p + 3) = convert.byte[4];\n+      *(p + 2) = convert.byte[5];\n+      *(p + 1) = convert.byte[6];\n+      *p = convert.byte[7];\n+    } else\n+      *p = convert.byte[7];\n+}"}, {"sha": "ca3422c2a1e972867f0c7e318edf53c47048ac51", "filename": "gcc/tree-vect-slp.cc", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403/gcc%2Ftree-vect-slp.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/338a5b0d7da84ef1f6c01dd96abf2c6bc830f403/gcc%2Ftree-vect-slp.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-slp.cc?ref=338a5b0d7da84ef1f6c01dd96abf2c6bc830f403", "patch": "@@ -5212,7 +5212,7 @@ vect_optimize_slp_pass::get_result_with_layout (slp_tree node,\n       if (SLP_TREE_SCALAR_STMTS (node).length ())\n \t{\n \t  auto &stmts = SLP_TREE_SCALAR_STMTS (result);\n-\t  stmts.safe_splice (SLP_TREE_SCALAR_STMTS (result));\n+\t  stmts.safe_splice (SLP_TREE_SCALAR_STMTS (node));\n \t  if (from_layout_i != 0)\n \t    vect_slp_permute (m_perms[from_layout_i], stmts, false);\n \t  if (to_layout_i != 0)"}]}