{"sha": "fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZmNjOTkzZjZmNThmNjZmNmQzNGJmM2RlOGRhMjdiZjlmMzQ2ODBjNw==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2009-11-12T06:50:19Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2009-11-12T06:50:19Z"}, "message": "decl2.c (constrain_visibility): Clear WEAK and COMMON flags.\n\n\n\t* decl2.c (constrain_visibility): Clear WEAK and COMMON flags.\n\n\t* ipa.c (function_and_variable_visibility): Verify that WEAK || COMMON\n\timply PUBLIC || EXTERNAL.\n\nFrom-SVN: r154115", "tree": {"sha": "571de9eb29a8c6efe78c80aa322723a6cb399710", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/571de9eb29a8c6efe78c80aa322723a6cb399710"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/comments", "author": null, "committer": null, "parents": [{"sha": "0a8fff5778dd361e64a01c1e2567f7d06d08c275", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0a8fff5778dd361e64a01c1e2567f7d06d08c275", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0a8fff5778dd361e64a01c1e2567f7d06d08c275"}], "stats": {"total": 14, "additions": 14, "deletions": 0}, "files": [{"sha": "4c45b70fe469b6f10f424d79d956ca34630f4dfd", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "patch": "@@ -1,3 +1,8 @@\n+2009-11-12  Jan Hubicka  <jh@suse.cz>\n+\n+\t* ipa.c (function_and_variable_visibility): Verify that WEAK || COMMON\n+\timply PUBLIC || EXTERNAL.\n+\n 2009-11-11  Andy Hutchinson  <hutchinsonandy@gcc.gnu.org>\n \n \tPR middle-end/41440"}, {"sha": "9a28a4960eda652dcf403842e6afbc08c879854f", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "patch": "@@ -1,3 +1,7 @@\n+2009-11-12  Jan Hubicka  <jh@suse.cz>\n+\n+\t* decl2.c (constrain_visibility): Clear WEAK and COMMON flags.\n+\n 2009-11-11  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/39131"}, {"sha": "510aa8faec1c5a1bc2443f18480dee55ea02b518", "filename": "gcc/cp/decl2.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2Fcp%2Fdecl2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2Fcp%2Fdecl2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl2.c?ref=fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "patch": "@@ -1883,6 +1883,8 @@ constrain_visibility (tree decl, int visibility)\n       if (!DECL_EXTERN_C_P (decl))\n \t{\n \t  TREE_PUBLIC (decl) = 0;\n+\t  DECL_WEAK (decl) = 0;\n+\t  DECL_COMMON (decl) = 0;\n \t  DECL_COMDAT_GROUP (decl) = NULL_TREE;\n \t  DECL_INTERFACE_KNOWN (decl) = 1;\n \t  if (DECL_LANG_SPECIFIC (decl))"}, {"sha": "4297ea2f46fa7b7d624ac8da0dde4c9d087c0450", "filename": "gcc/ipa.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2Fipa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/fcc993f6f58f66f6d34bf3de8da27bf9f34680c7/gcc%2Fipa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa.c?ref=fcc993f6f58f66f6d34bf3de8da27bf9f34680c7", "patch": "@@ -292,6 +292,7 @@ function_and_variable_visibility (bool whole_program)\n \n   for (node = cgraph_nodes; node; node = node->next)\n     {\n+      gcc_assert (!DECL_WEAK (node->decl) || TREE_PUBLIC (node->decl) || DECL_EXTERNAL (node->decl));\n       if (cgraph_externally_visible_p (node, whole_program))\n         {\n \t  gcc_assert (!node->global.inlined_to);\n@@ -316,6 +317,8 @@ function_and_variable_visibility (bool whole_program)\n     {\n       if (!vnode->finalized)\n         continue;\n+      gcc_assert ((!DECL_WEAK (vnode->decl) || DECL_COMMON (vnode->decl))\n+      \t\t  || TREE_PUBLIC (vnode->decl) || DECL_EXTERNAL (node->decl));\n       if (vnode->needed\n \t  && (DECL_COMDAT (vnode->decl) || TREE_PUBLIC (vnode->decl))\n \t  && (!whole_program"}]}