{"sha": "a22a86a18bd3946f59f46468344fe86d6756103e", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTIyYTg2YTE4YmQzOTQ2ZjU5ZjQ2NDY4MzQ0ZmU4NmQ2NzU2MTAzZQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-01-18T08:41:59Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2020-01-18T08:41:59Z"}, "message": "arm: fix rtl checking bootstrap (PR target/93312)\n\nAs reported in PR93312, the:\n> > > > > > \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 * config/arm/arm.c (clear_operation_p): New function.\nchange broke RTL checking bootstrap.\n\nOn the testcase from the PR (which is distilled from libgcc2.c, so I think\nwe don't need to add it into testsuite) we ICE because SET_DEST (elt) is\nnot a REG, but SUBREG.  The code uses REGNO on it, which is invalid, but\nonly stores it into a variable, then performs REG_P (reg) check,\ndetermines it is not a REG and bails early.\n\nThe following patch just moves the regno variable initialization after that\ncheck, it isn't used in between.  And, as a small optimization, because\nreg doesn't change, doesn't use REGNO (reg) a second time to set last_regno.\n\n2020-01-18  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR target/93312\n\t* config/arm/arm.c (clear_operation_p): Don't use REGNO until\n\tafter checking the argument is a REG.  Don't use REGNO (reg)\n\tagain to set last_regno, reuse regno variable instead.", "tree": {"sha": "30a8cc9367809e73bffd3aff278f8d3e20ccce90", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/30a8cc9367809e73bffd3aff278f8d3e20ccce90"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a22a86a18bd3946f59f46468344fe86d6756103e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a22a86a18bd3946f59f46468344fe86d6756103e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a22a86a18bd3946f59f46468344fe86d6756103e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a22a86a18bd3946f59f46468344fe86d6756103e/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e2947cfa2d1d4da13bb298b4f36cd745b007d88d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e2947cfa2d1d4da13bb298b4f36cd745b007d88d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e2947cfa2d1d4da13bb298b4f36cd745b007d88d"}], "stats": {"total": 22, "additions": 15, "deletions": 7}, "files": [{"sha": "001e26d12dee6d7b76cc188cedbb2630398787a1", "filename": "gcc/ChangeLog", "status": "modified", "additions": 12, "deletions": 5, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a22a86a18bd3946f59f46468344fe86d6756103e/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a22a86a18bd3946f59f46468344fe86d6756103e/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a22a86a18bd3946f59f46468344fe86d6756103e", "patch": "@@ -1,8 +1,15 @@\n+2020-01-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/93312\n+\t* config/arm/arm.c (clear_operation_p): Don't use REGNO until\n+\tafter checking the argument is a REG.  Don't use REGNO (reg)\n+\tagain to set last_regno, reuse regno variable instead.\n+\n 2020-01-17  David Malcolm  <dmalcolm@redhat.com>\n \n \t* doc/analyzer.texi (Limitations): Add note about NaN.\n \n-2020-01-17  Mihail-Calin Ionescu <mihail.ionescu@arm.com>\n+2020-01-17  Mihail-Calin Ionescu  <mihail.ionescu@arm.com>\n \t    Sudakshina Das  <sudi.das@arm.com>\n \n \t* config/arm/arm.md (ashldi3): Generate thumb2_lsll for both reg\n@@ -202,8 +209,8 @@\n \t* config/arm/t-rmprofile: Map v8.1-M multilibs to v8-M.\n \t* doc/invoke.texi: Document the armv8.1-m mve and dps options.\n \n-2020-01-16  Mihail-Calin Ionescu <mihail.ionescu@arm.com>\n-\t    Thomas Preud'homme <thomas.preudhomme@arm.com>\n+2020-01-16  Mihail-Calin Ionescu  <mihail.ionescu@arm.com>\n+\t    Thomas Preud'homme  <thomas.preudhomme@arm.com>\n \n \t* config/arm/arm-cpus.in (ARMv8_1m_main): Redefine as an extension to\n \tArmv8-M Mainline.\n@@ -312,8 +319,8 @@\n \t* config/arm/vfp.md (push_fpsysreg_insn): New define_insn.\n \t(pop_fpsysreg_insn): Likewise.\n \n-2020-01-16  Mihail-Calin Ionescu <mihail.ionescu@arm.com>\n-\t    Thomas Preud'homme <thomas.preudhomme@arm.com>\n+2020-01-16  Mihail-Calin Ionescu  <mihail.ionescu@arm.com>\n+\t    Thomas Preud'homme  <thomas.preudhomme@arm.com>\n \n \t* config/arm/arm-cpus.in (armv8_1m_main): New feature.\n \t(ARMv4, ARMv4t, ARMv5t, ARMv5te, ARMv5tej, ARMv6, ARMv6j, ARMv6k,"}, {"sha": "c47fc232f39e13f5033d97847aa9805dd9ab4a52", "filename": "gcc/config/arm/arm.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a22a86a18bd3946f59f46468344fe86d6756103e/gcc%2Fconfig%2Farm%2Farm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a22a86a18bd3946f59f46468344fe86d6756103e/gcc%2Fconfig%2Farm%2Farm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Farm.c?ref=a22a86a18bd3946f59f46468344fe86d6756103e", "patch": "@@ -13779,14 +13779,15 @@ clear_operation_p (rtx op, bool vfp)\n \treturn false;\n \n       reg = SET_DEST (elt);\n-      regno = REGNO (reg);\n       zero = SET_SRC (elt);\n \n       if (!REG_P (reg)\n \t  || GET_MODE (reg) != expected_mode\n \t  || zero != CONST0_RTX (SImode))\n \treturn false;\n \n+      regno = REGNO (reg);\n+\n       if (vfp)\n \t{\n \t  if (i != 1 && regno != last_regno + 1)\n@@ -13800,7 +13801,7 @@ clear_operation_p (rtx op, bool vfp)\n \t    return false;\n \t}\n \n-      last_regno = REGNO (reg);\n+      last_regno = regno;\n     }\n \n   return true;"}]}