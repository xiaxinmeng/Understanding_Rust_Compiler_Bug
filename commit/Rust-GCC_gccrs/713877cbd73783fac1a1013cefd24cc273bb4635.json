{"sha": "713877cbd73783fac1a1013cefd24cc273bb4635", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NzEzODc3Y2JkNzM3ODNmYWMxYTEwMTNjZWZkMjRjYzI3M2JiNDYzNQ==", "commit": {"author": {"name": "Claudiu Zissulescu", "email": "claziss@synopsys.com", "date": "2019-11-22T07:59:54Z"}, "committer": {"name": "Claudiu Zissulescu", "email": "claziss@gcc.gnu.org", "date": "2019-11-22T07:59:54Z"}, "message": "[ARC] Fix ARC target specific tests.\n\nFix ARC specific tests by improving the matching pattern and adding\nthe missing functionality in arc.exp\n\ngcc/tests\nxxxx-xx-xx  Claudiu Zissulescu  <claziss@synopsys.com>\n\n\t* gcc.target/arc/add_n-combine.c: Match add1/2/3 instruction in\n\toutput assembly.\n\t* gcc.target/arc/arc.exp (check_effective_target_codedensity):\n\tAdd.\n\t* gcc.target/arc/cmem-7.c: Fix matching patterns.\n\t* gcc.target/arc/cmem-bit-1.c: Likewise.\n\t* gcc.target/arc/cmem-bit-2.c: Likewise.\n\t* gcc.target/arc/cmem-bit-3.c: Likewise.\n\t* gcc.target/arc/cmem-bit-4.c: Likewise.\n\t* gcc.target/arc/interrupt-2.c: Match rtie insn for A7.\n\t* gcc.target/arc/store-merge-1.c: This test is only meaningful for\n\tarchitectures with double load/store operations.\n\nFrom-SVN: r278609", "tree": {"sha": "c3b5550ab2ffe8344474dbccb1c3c093b329a1e4", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c3b5550ab2ffe8344474dbccb1c3c093b329a1e4"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/713877cbd73783fac1a1013cefd24cc273bb4635", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/713877cbd73783fac1a1013cefd24cc273bb4635", "html_url": "https://github.com/Rust-GCC/gccrs/commit/713877cbd73783fac1a1013cefd24cc273bb4635", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/713877cbd73783fac1a1013cefd24cc273bb4635/comments", "author": {"login": "claziss", "id": 2761368, "node_id": "MDQ6VXNlcjI3NjEzNjg=", "avatar_url": "https://avatars.githubusercontent.com/u/2761368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/claziss", "html_url": "https://github.com/claziss", "followers_url": "https://api.github.com/users/claziss/followers", "following_url": "https://api.github.com/users/claziss/following{/other_user}", "gists_url": "https://api.github.com/users/claziss/gists{/gist_id}", "starred_url": "https://api.github.com/users/claziss/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/claziss/subscriptions", "organizations_url": "https://api.github.com/users/claziss/orgs", "repos_url": "https://api.github.com/users/claziss/repos", "events_url": "https://api.github.com/users/claziss/events{/privacy}", "received_events_url": "https://api.github.com/users/claziss/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "7028c2179cc349653c5578fb5774389b1fffdaf1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7028c2179cc349653c5578fb5774389b1fffdaf1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7028c2179cc349653c5578fb5774389b1fffdaf1"}], "stats": {"total": 61, "additions": 45, "deletions": 16}, "files": [{"sha": "181e478bf90ce2a6283eb9f638b69b35982d41aa", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 15, "deletions": 0, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -1,3 +1,18 @@\n+2019-11-22  Claudiu Zissulescu  <claziss@synopsys.com>\n+\n+\t* gcc.target/arc/add_n-combine.c: Match add1/2/3 instruction in\n+\toutput assembly.\n+\t* gcc.target/arc/arc.exp (check_effective_target_codedensity):\n+\tAdd.\n+\t* gcc.target/arc/cmem-7.c: Fix matching patterns.\n+\t* gcc.target/arc/cmem-bit-1.c: Likewise.\n+\t* gcc.target/arc/cmem-bit-2.c: Likewise.\n+\t* gcc.target/arc/cmem-bit-3.c: Likewise.\n+\t* gcc.target/arc/cmem-bit-4.c: Likewise.\n+\t* gcc.target/arc/interrupt-2.c: Match rtie insn for A7.\n+\t* gcc.target/arc/store-merge-1.c: This test is only meaningful for\n+\tarchitectures with double load/store operations.\n+\n 2019-11-21  Martin Sebor  <msebor@redhat.com>\n \n \t* gcc.dg/strlenopt-66.c: Avoid buffer overflow.  Add more test cases."}, {"sha": "bc400df669efbd436886284e3c52a010c48572aa", "filename": "gcc/testsuite/gcc.target/arc/add_n-combine.c", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fadd_n-combine.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fadd_n-combine.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fadd_n-combine.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -1,5 +1,5 @@\n /* { dg-do compile }  */\n-/* { dg-options \"-O2 -fdump-rtl-combine\" }  */\n+/* { dg-options \"-O2\" }  */\n \n struct b1 {\n       char c;\n@@ -45,4 +45,6 @@ void f() {\n   a(at3.bn[bu]);\n }\n \n-/* { dg-final { scan-rtl-dump-times \"\\\\*add_n\" 2 \"combine\" } } */\n+/* { dg-final { scan-assembler \"add1\" } } */\n+/* { dg-final { scan-assembler \"add2\" } } */\n+/* { dg-final { scan-assembler \"add3\" } } */"}, {"sha": "ac1d5b6704836e77f8e24dac80671946b05ac10b", "filename": "gcc/testsuite/gcc.target/arc/arc.exp", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Farc.exp", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Farc.exp", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Farc.exp?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -94,6 +94,16 @@ proc check_effective_target_barrelshifter { } {\n     }]\n }\n \n+#return 1 if we have code density option on.\n+proc check_effective_target_codedensity { } {\n+    return [check_no_compiler_messages codedensity assembly {\n+        #if !defined(__ARC_CODE_DENSITY__)\n+        #error No code density option for this config\n+        #endif\n+    }]\n+}\n+\n+\n #return 1 if we use ARCv2 Accumulator registers\n proc check_effective_target_accregs { } {\n     return [check_no_compiler_messages accregs assembly {"}, {"sha": "ad7f25d9f8c6e8e37d097c4defcf317662535d82", "filename": "gcc/testsuite/gcc.target/arc/cmem-7.c", "status": "modified", "additions": 4, "deletions": 4, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-7.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-7.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-7.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -21,7 +21,7 @@ some_function ()\n   return 0;\n }\n \n-/* { dg-final { scan-assembler \"xldb \\[^\\n\\]*@ss\" } } */\n-/* { dg-final { scan-assembler \"xstb \\[^\\n\\]*@ss\" } } */\n-/* { dg-final { scan-assembler-not \"xldb \\[^\\n\\]*@tt\" } } */\n-/* { dg-final { scan-assembler-not \"xstb \\[^\\n\\]*@tt\" } } */\n+/* { dg-final { scan-assembler \"xldb\\\\s+\\[^\\n\\]*@ss\" } } */\n+/* { dg-final { scan-assembler \"xstb\\\\s+\\[^\\n\\]*@ss\" } } */\n+/* { dg-final { scan-assembler-not \"xldb\\\\s+\\[^\\n\\]*@tt\" } } */\n+/* { dg-final { scan-assembler-not \"xstb\\\\s+\\[^\\n\\]*@tt\" } } */"}, {"sha": "d3471a2e621dcf092785edb3ee9803527328bdb0", "filename": "gcc/testsuite/gcc.target/arc/cmem-bit-1.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-1.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -16,5 +16,5 @@ void foo() {\n     bar();\n }\n \n-/* { dg-final { scan-assembler \"xldb r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n-/* { dg-final { scan-assembler \"btst_s r\\[0-9\\]+,7\" { target arceb-*-* } } } */\n+/* { dg-final { scan-assembler \"xldb\\\\s+r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n+/* { dg-final { scan-assembler \"btst_s\\\\s+r\\[0-9\\]+,7\" { target arceb-*-* } } } */"}, {"sha": "4b022944f60a30851fc998b5879a4d5a3c69ea41", "filename": "gcc/testsuite/gcc.target/arc/cmem-bit-2.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-2.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -16,5 +16,5 @@ void foo() {\n     bar();\n }\n \n-/* { dg-final { scan-assembler \"xldb r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n-/* { dg-final { scan-assembler \"btst_s r\\[0-9\\]+,7\" { target arceb-*-* } } } */\n+/* { dg-final { scan-assembler \"xldb\\\\s+r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n+/* { dg-final { scan-assembler \"btst_s\\\\s+r\\[0-9\\]+,7\" { target arceb-*-* } } } */"}, {"sha": "40fbb934bf99ee37462ccf36a5fa7be74e59c425", "filename": "gcc/testsuite/gcc.target/arc/cmem-bit-3.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-3.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-3.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-3.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -16,5 +16,5 @@ void foo() {\n     bar();\n }\n \n-/* { dg-final { scan-assembler \"xldb r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n-/* { dg-final { scan-assembler \"btst_s r\\[0-9\\]+,7\" { target arceb-*-* } } } */\n+/* { dg-final { scan-assembler \"xldb\\\\s+r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n+/* { dg-final { scan-assembler \"btst_s\\\\s+r\\[0-9\\]+,7\" { target arceb-*-* } } } */"}, {"sha": "288a6a0358338348bd389f18ff16a1ae8fedb1ef", "filename": "gcc/testsuite/gcc.target/arc/cmem-bit-4.c", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-4.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-4.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fcmem-bit-4.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -16,5 +16,5 @@ void foo() {\n     bar();\n }\n \n-/* { dg-final { scan-assembler \"xldb r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n-/* { dg-final { scan-assembler \"btst_s r\\[0-9\\]+,7\" { target arceb-*-* } } } */\n+/* { dg-final { scan-assembler \"xldb\\\\s+r\\[0-9\\]+,\\\\\\[@a_strange_bool\\\\\\]\" } } */\n+/* { dg-final { scan-assembler \"btst_s\\\\s+r\\[0-9\\]+,7\" { target arceb-*-* } } } */"}, {"sha": "09c6f4d216e9f8b2139fd49f62c182d2041eca05", "filename": "gcc/testsuite/gcc.target/arc/interrupt-2.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Finterrupt-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Finterrupt-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Finterrupt-2.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -3,4 +3,5 @@ void __attribute__ ((interrupt(\"ilink2\")))\n handler1 (void)\n {\n }\n-/* { dg-final { scan-assembler-times \"j.*\\[ilink2\\]\" 1 } } */\n+/* { dg-final { scan-assembler-times \"j.*\\[ilink2\\]\" 1 { target { arc6xx } } } } */\n+/* { dg-final { scan-assembler-times \"rtie\" 1 { target { arc700 } } } } */"}, {"sha": "a133e8719b423ba7975f5f0d8e0fa94003654a3a", "filename": "gcc/testsuite/gcc.target/arc/store-merge-1.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fstore-merge-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/713877cbd73783fac1a1013cefd24cc273bb4635/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fstore-merge-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Farc%2Fstore-merge-1.c?ref=713877cbd73783fac1a1013cefd24cc273bb4635", "patch": "@@ -1,5 +1,6 @@\n /* { dg-do compile } */\n-/* { dg-options \"-O3\" } */\n+/* { dg-require-effective-target archs }*/\n+/* { dg-options \"-O3 -mll64\" } */\n \n /* This tests checks if we use st w6,[reg] format.  */\n "}]}