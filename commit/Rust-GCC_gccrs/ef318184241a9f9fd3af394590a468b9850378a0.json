{"sha": "ef318184241a9f9fd3af394590a468b9850378a0", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZWYzMTgxODQyNDFhOWY5ZmQzYWYzOTQ1OTBhNDY4Yjk4NTAzNzhhMA==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2016-02-01T12:39:04Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2016-02-01T12:39:04Z"}, "message": "re PR tree-optimization/69579 (gcc ICE at -O3 and __sigsetjmp with \u201ctree check: expected ssa_name, have integer_cst in compute_optimized_partition_bases\u201d)\n\n2016-02-01  Richard Biener  <rguenther@suse.de>\n\n\tPR tree-optimization/69579\n\t* tree-ssa-loop-ivcanon.c (propagate_constants_for_unrolling):\n\tDo not propagate through abnormal PHI results.\n\n\t* gcc.dg/setjmp-6.c: New testcase.\n\nFrom-SVN: r233036", "tree": {"sha": "c9c3c57827a978f3f5e7edf3ccfadd8da7eecd59", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c9c3c57827a978f3f5e7edf3ccfadd8da7eecd59"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ef318184241a9f9fd3af394590a468b9850378a0", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef318184241a9f9fd3af394590a468b9850378a0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ef318184241a9f9fd3af394590a468b9850378a0", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ef318184241a9f9fd3af394590a468b9850378a0/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "571512d5f54f0fdf9c06f9a348e46ddbab8a5088", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/571512d5f54f0fdf9c06f9a348e46ddbab8a5088", "html_url": "https://github.com/Rust-GCC/gccrs/commit/571512d5f54f0fdf9c06f9a348e46ddbab8a5088"}], "stats": {"total": 40, "additions": 39, "deletions": 1}, "files": [{"sha": "c40db1e4194e8200133c0f90a41648e9088cced4", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ef318184241a9f9fd3af394590a468b9850378a0", "patch": "@@ -1,3 +1,9 @@\n+2016-02-01  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/69579\n+\t* tree-ssa-loop-ivcanon.c (propagate_constants_for_unrolling):\n+\tDo not propagate through abnormal PHI results.\n+\n 2016-02-01  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* postreload.c (reload_cse_simplify): Remove dead code."}, {"sha": "0c1df5e3aa65383a79c1fc34448d5d8664f8b323", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=ef318184241a9f9fd3af394590a468b9850378a0", "patch": "@@ -1,3 +1,8 @@\n+2016-02-01  Richard Biener  <rguenther@suse.de>\n+\n+\tPR tree-optimization/69579\n+\t* gcc.dg/setjmp-6.c: New testcase.\n+\n 2016-02-01  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR rtl-optimization/69570"}, {"sha": "0781f055952867ae9c619f99f4ad943d07f461cb", "filename": "gcc/testsuite/gcc.dg/setjmp-6.c", "status": "added", "additions": 25, "deletions": 0, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2Ftestsuite%2Fgcc.dg%2Fsetjmp-6.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2Ftestsuite%2Fgcc.dg%2Fsetjmp-6.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fsetjmp-6.c?ref=ef318184241a9f9fd3af394590a468b9850378a0", "patch": "@@ -0,0 +1,25 @@\n+/* PR69569 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O3\" } */\n+\n+#include <setjmp.h>\n+\n+jmp_buf buf;\n+\n+struct str {\n+    int Count;\n+};\n+int fun2(struct str *p1)\n+{\n+    int i = 1;\n+    while (1) {\n+\tsetjmp(buf);\n+\tbreak;\n+    }\n+    for (; i;) {\n+\ti = 0;\n+\tfor (; i < (p1 ? p1->Count : 1); i++)\n+\t  fun2(p1);\n+    }\n+    return 1;\n+}"}, {"sha": "ab1f7e6d7a9f3dd7df46dc45c94d0f6f18988910", "filename": "gcc/tree-ssa-loop-ivcanon.c", "status": "modified", "additions": 3, "deletions": 1, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2Ftree-ssa-loop-ivcanon.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ef318184241a9f9fd3af394590a468b9850378a0/gcc%2Ftree-ssa-loop-ivcanon.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-loop-ivcanon.c?ref=ef318184241a9f9fd3af394590a468b9850378a0", "patch": "@@ -1208,7 +1208,9 @@ propagate_constants_for_unrolling (basic_block bb)\n       tree result = gimple_phi_result (phi);\n       tree arg = gimple_phi_arg_def (phi, 0);\n \n-      if (gimple_phi_num_args (phi) == 1 && TREE_CODE (arg) == INTEGER_CST)\n+      if (! SSA_NAME_OCCURS_IN_ABNORMAL_PHI (result)\n+\t  && gimple_phi_num_args (phi) == 1\n+\t  && TREE_CODE (arg) == INTEGER_CST)\n \t{\n \t  propagate_into_all_uses (result, arg);\n \t  gsi_remove (&gsi, true);"}]}