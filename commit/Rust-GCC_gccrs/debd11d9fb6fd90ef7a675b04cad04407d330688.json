{"sha": "debd11d9fb6fd90ef7a675b04cad04407d330688", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGViZDExZDlmYjZmZDkwZWY3YTY3NWIwNGNhZDA0NDA3ZDMzMDY4OA==", "commit": {"author": {"name": "Edgar E. Iglesias", "email": "edgar.iglesias@gmail.com", "date": "2013-02-16T19:32:15Z"}, "committer": {"name": "Michael Eager", "email": "eager@gcc.gnu.org", "date": "2013-02-16T19:32:15Z"}, "message": "Add TARGET_SUPPORTS_PIC flag and check that the flag_pic = 2\n\n * config/microblaze/linux.h (TARGET_SUPPORTS_PIC): Define as 1.\n * config/microblaze/microblaze.h (TARGET_SUPPORTS_PIC): Define as 1.\n * config/microblaze/microblaze.c (microblaze_option_override):\n    Bail out early for PIC modes when target does not support PIC.\n * gcc.dg/20020312-2.c: Define MicroBlaze PIC register\n\nFrom-SVN: r196104", "tree": {"sha": "1ea2fd27ec0f8390df307eac7f49d3a42dce468b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1ea2fd27ec0f8390df307eac7f49d3a42dce468b"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/debd11d9fb6fd90ef7a675b04cad04407d330688", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/debd11d9fb6fd90ef7a675b04cad04407d330688", "html_url": "https://github.com/Rust-GCC/gccrs/commit/debd11d9fb6fd90ef7a675b04cad04407d330688", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/debd11d9fb6fd90ef7a675b04cad04407d330688/comments", "author": {"login": "edgarigl", "id": 86901, "node_id": "MDQ6VXNlcjg2OTAx", "avatar_url": "https://avatars.githubusercontent.com/u/86901?v=4", "gravatar_id": "", "url": "https://api.github.com/users/edgarigl", "html_url": "https://github.com/edgarigl", "followers_url": "https://api.github.com/users/edgarigl/followers", "following_url": "https://api.github.com/users/edgarigl/following{/other_user}", "gists_url": "https://api.github.com/users/edgarigl/gists{/gist_id}", "starred_url": "https://api.github.com/users/edgarigl/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/edgarigl/subscriptions", "organizations_url": "https://api.github.com/users/edgarigl/orgs", "repos_url": "https://api.github.com/users/edgarigl/repos", "events_url": "https://api.github.com/users/edgarigl/events{/privacy}", "received_events_url": "https://api.github.com/users/edgarigl/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8ec77be0fc99e3a1ba0abd990175ca5b3bc7cfe9"}], "stats": {"total": 30, "additions": 30, "deletions": 0}, "files": [{"sha": "1373e8bc9bf55eb2c451418a464e8cdefda4f05b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=debd11d9fb6fd90ef7a675b04cad04407d330688", "patch": "@@ -1,3 +1,10 @@\n+2013-02-16  Edgar E. Iglesias  <edgar.iglesias@gmail.com>\n+\n+\t* config/microblaze/linux.h (TARGET_SUPPORTS_PIC): Define as 1.\n+\t* config/microblaze/microblaze.h (TARGET_SUPPORTS_PIC): Define as 1.\n+\t* config/microblaze/microblaze.c (microblaze_option_override):\n+\tBail out early for PIC modes when target does not support PIC.\n+\n 2013-02-16  Edgar E. Iglesias  <edgar.iglesias@gmail.com>\n \n \t* config/microblaze/microblaze.c (microblaze_asm_trampoline_template): "}, {"sha": "eca777640a7cd78279709750eda46529cad90c2d", "filename": "gcc/config/microblaze/linux.h", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Fconfig%2Fmicroblaze%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Fconfig%2Fmicroblaze%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Flinux.h?ref=debd11d9fb6fd90ef7a675b04cad04407d330688", "patch": "@@ -19,6 +19,8 @@\n    along with GCC; see the file COPYING3.  If not see\n    <http://www.gnu.org/licenses/>.  */\n \n+#undef TARGET_SUPPORTS_PIC\n+#define TARGET_SUPPORTS_PIC 1\n \n #define DYNAMIC_LINKER \"/lib/ld.so.1\"\n #undef  SUBTARGET_EXTRA_SPECS"}, {"sha": "449626b2e38ce6fa166ae7e7eaf413f7a618f6de", "filename": "gcc/config/microblaze/microblaze.c", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.c?ref=debd11d9fb6fd90ef7a675b04cad04407d330688", "patch": "@@ -1299,6 +1299,18 @@ microblaze_option_override (void)\n \t\t\t\t  ? g_switch_value\n \t\t\t\t  : MICROBLAZE_DEFAULT_GVALUE);\n \n+  if (flag_pic)\n+    {\n+      /* Make sure it's 2, we only support one kind of PIC.  */\n+      flag_pic = 2;\n+      if (!TARGET_SUPPORTS_PIC)\n+        {\n+          error (\"-fPIC/-fpic not supported for this target\");\n+          /* Clear it to avoid further errors.  */\n+          flag_pic = 0;\n+        }\n+    }\n+\n   /* Check the MicroBlaze CPU version for any special action to be done.  */\n   if (microblaze_select_cpu == NULL)\n     microblaze_select_cpu = MICROBLAZE_DEFAULT_CPU;"}, {"sha": "b552665ac63faf3f95fc849c26b34533594c0356", "filename": "gcc/config/microblaze/microblaze.h", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmicroblaze%2Fmicroblaze.h?ref=debd11d9fb6fd90ef7a675b04cad04407d330688", "patch": "@@ -58,6 +58,9 @@ extern enum pipeline_type microblaze_pipe;\n #define TARGET_DEFAULT      (MASK_SOFT_MUL | MASK_SOFT_DIV | MASK_SOFT_FLOAT \\\n                              | TARGET_ENDIAN_DEFAULT)\n \n+/* The default is to support PIC.  */\n+#define TARGET_SUPPORTS_PIC 1\n+\n /* What is the default setting for -mcpu= . We set it to v4.00.a even though \n    we are actually ahead. This is safest version that has generate code \n    compatible for the original ISA */"}, {"sha": "2377db0a2e88e44a431b0fb76bb6ca270036ae46", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=debd11d9fb6fd90ef7a675b04cad04407d330688", "patch": "@@ -1,3 +1,7 @@\n+2013-02-16  Edgar E. Iglesias  <edgar.iglesias@gmail.com>\n+\n+\t* gcc.dg/20020312-2.c: Define MicroBlaze PIC register\n+\n 2013-02-16  Jakub Jelinek  <jakub@redhat.com>\n \t    Dodji Seketeli  <dodji@redhat.com>\n "}, {"sha": "633da5be189cfdd8cd15261402bf4e910ff05f3b", "filename": "gcc/testsuite/gcc.dg/20020312-2.c", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Ftestsuite%2Fgcc.dg%2F20020312-2.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/debd11d9fb6fd90ef7a675b04cad04407d330688/gcc%2Ftestsuite%2Fgcc.dg%2F20020312-2.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2F20020312-2.c?ref=debd11d9fb6fd90ef7a675b04cad04407d330688", "patch": "@@ -42,6 +42,8 @@ extern void abort (void);\n /* No pic register.  */\n #elif defined(__mcore__)\n /* No pic register.  */\n+#elif defined(__MICROBLAZE__)\n+# define PIC_REG \"r20\"\n #elif defined(__mips__)\n /* PIC register is $28, but is used even without -fpic.  */\n #elif defined(__MMIX__)"}]}