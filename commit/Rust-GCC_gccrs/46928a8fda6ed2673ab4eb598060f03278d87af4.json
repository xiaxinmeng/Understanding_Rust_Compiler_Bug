{"sha": "46928a8fda6ed2673ab4eb598060f03278d87af4", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDY5MjhhOGZkYTZlZDI2NzNhYjRlYjU5ODA2MGYwMzI3OGQ4N2FmNA==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2017-04-19T08:08:44Z"}, "committer": {"name": "Martin Liska", "email": "marxin@gcc.gnu.org", "date": "2017-04-19T08:08:44Z"}, "message": "Introduce gcov.h header file (PR gcov-profile/80435).\n\n2017-04-19  Martin Liska  <mliska@suse.cz>\n\n\tPR gcov-profile/80435\n\t* Makefile.in: Install gcov.h.\n\t* gcov.h: New file.\n\t* libgcov.h: Use the header and make __gcov_flush publicly\n\tvisible.\n\nFrom-SVN: r246990", "tree": {"sha": "f6e0c735825880c555de183e450419c652051218", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f6e0c735825880c555de183e450419c652051218"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/46928a8fda6ed2673ab4eb598060f03278d87af4", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46928a8fda6ed2673ab4eb598060f03278d87af4", "html_url": "https://github.com/Rust-GCC/gccrs/commit/46928a8fda6ed2673ab4eb598060f03278d87af4", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/46928a8fda6ed2673ab4eb598060f03278d87af4/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "a16c8d8b61064dfd2281dd1749b65d633b256334", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a16c8d8b61064dfd2281dd1749b65d633b256334", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a16c8d8b61064dfd2281dd1749b65d633b256334"}], "stats": {"total": 70, "additions": 60, "deletions": 10}, "files": [{"sha": "272c8299c7210f6eaacf06486524be0bfbe6e98b", "filename": "libgcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FChangeLog?ref=46928a8fda6ed2673ab4eb598060f03278d87af4", "patch": "@@ -1,3 +1,11 @@\n+2017-04-19  Martin Liska  <mliska@suse.cz>\n+\n+\tPR gcov-profile/80435\n+\t* Makefile.in: Install gcov.h.\n+\t* gcov.h: New file.\n+\t* libgcov.h: Use the header and make __gcov_flush publicly\n+\tvisible.\n+\n 2017-04-18  Martin Liska  <mliska@suse.cz>\n \n \tPR gcov-profile/78783"}, {"sha": "a1a392de88d0e5c6b40cb73e59ca4f4698affa6e", "filename": "libgcc/Makefile.in", "status": "modified", "additions": 10, "deletions": 5, "changes": 15, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2FMakefile.in?ref=46928a8fda6ed2673ab4eb598060f03278d87af4", "patch": "@@ -907,14 +907,14 @@ libgcov-driver-objects = $(patsubst %,%$(objext),$(LIBGCOV_DRIVER))\n libgcov-objects = $(libgcov-merge-objects) $(libgcov-profiler-objects) \\\n                  $(libgcov-interface-objects) $(libgcov-driver-objects)\n \n-$(libgcov-merge-objects): %$(objext): $(srcdir)/libgcov-merge.c $(srcdir)/libgcov.h\n+$(libgcov-merge-objects): %$(objext): $(srcdir)/libgcov-merge.c $(srcdir)/gcov.h $(srcdir)/libgcov.h\n \t$(gcc_compile) -DL$* -c $(srcdir)/libgcov-merge.c\n-$(libgcov-profiler-objects): %$(objext): $(srcdir)/libgcov-profiler.c $(srcdir)/libgcov.h\n+$(libgcov-profiler-objects): %$(objext): $(srcdir)/libgcov-profiler.c $(srcdir)/gcov.h $(srcdir)/libgcov.h\n \t$(gcc_compile) -DL$* -c $(srcdir)/libgcov-profiler.c\n-$(libgcov-interface-objects): %$(objext): $(srcdir)/libgcov-interface.c $(srcdir)/libgcov.h\n+$(libgcov-interface-objects): %$(objext): $(srcdir)/libgcov-interface.c $(srcdir)/gcov.h $(srcdir)/libgcov.h\n \t$(gcc_compile) -DL$* -c $(srcdir)/libgcov-interface.c\n $(libgcov-driver-objects): %$(objext): $(srcdir)/libgcov-driver.c \\\n-  $(srcdir)/libgcov-driver-system.c $(srcdir)/libgcov.h\n+  $(srcdir)/libgcov-driver-system.c $(srcdir)/gcov.h $(srcdir)/libgcov.h\n \t$(gcc_compile) -DL$* -c $(srcdir)/libgcov-driver.c\n \n \n@@ -1114,6 +1114,10 @@ install-unwind_h:\n \n all: install-unwind_h-forbuild\n \n+install-gcov_h:\n+\t$(mkinstalldirs) $(DESTDIR)$(libsubdir)/include\n+\t$(INSTALL_DATA) $(srcdir)/gcov.h $(DESTDIR)$(libsubdir)/include\n+\n # Documentation targets (empty).\n .PHONY: info html dvi pdf install-info install-html install-pdf\n \n@@ -1171,13 +1175,14 @@ install-leaf: $(install-shared) $(install-libunwind)\n \t  esac;\t\t\t\t\t\t\t\\\n \tdone\n \n-install: install-leaf install-unwind_h\n+install: install-leaf install-unwind_h install-gcov_h\n \t@: $(MAKE) ; $(MULTIDO) $(FLAGS_TO_PASS) multi-do DO=install\n \n install-strip: install\n \n .PHONY: install install-shared install-libunwind install-strip\n .PHONY: install-unwind_h install-unwind_h-forbuild\n+.PHONY: install-gcov_h\n \n # Don't export variables to the environment, in order to not confuse\n # configure."}, {"sha": "0333ecca8375d316a0775b33274409a3beffb7d4", "filename": "libgcc/gcov.h", "status": "added", "additions": 41, "deletions": 0, "changes": 41, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2Fgcov.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2Fgcov.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Fgcov.h?ref=46928a8fda6ed2673ab4eb598060f03278d87af4", "patch": "@@ -0,0 +1,41 @@\n+/* GCOV interface routines.\n+   Copyright (C) 2017 Free Software Foundation, Inc.\n+\n+   This file is part of GCC.\n+\n+   GCC is free software; you can redistribute it and/or modify it under\n+   the terms of the GNU General Public License as published by the Free\n+   Software Foundation; either version 3, or (at your option) any later\n+   version.\n+\n+   GCC is distributed in the hope that it will be useful, but WITHOUT ANY\n+   WARRANTY; without even the implied warranty of MERCHANTABILITY or\n+   FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n+   for more details.\n+\n+   Under Section 7 of GPL version 3, you are granted additional\n+   permissions described in the GCC Runtime Library Exception, version\n+   3.1, as published by the Free Software Foundation.\n+\n+   You should have received a copy of the GNU General Public License and\n+   a copy of the GCC Runtime Library Exception along with this program;\n+   see the files COPYING3 and COPYING.RUNTIME respectively.  If not, see\n+   <http://www.gnu.org/licenses/>.  */\n+\n+#ifndef GCC_GCOV_H\n+#define GCC_GCOV_H\n+\n+/* Set all counters to zero.  */\n+\n+extern void __gcov_reset (void);\n+\n+/* Write profile information to a file.  */\n+\n+extern void __gcov_dump (void);\n+\n+/* Write profile information to a file and reset counters to zero.\n+   The function does operations under a mutex.  */\n+\n+extern void __gcov_flush (void);\n+\n+#endif /* GCC_GCOV_H */"}, {"sha": "4c1204ca83c3ef0f323affd893f708d4972b9fe7", "filename": "libgcc/libgcov.h", "status": "modified", "additions": 1, "deletions": 5, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2Flibgcov.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/46928a8fda6ed2673ab4eb598060f03278d87af4/libgcc%2Flibgcov.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgcc%2Flibgcov.h?ref=46928a8fda6ed2673ab4eb598060f03278d87af4", "patch": "@@ -42,6 +42,7 @@\n #include \"coretypes.h\"\n #include \"tm.h\"\n #include \"libgcc_tm.h\"\n+#include \"gcov.h\"\n \n #if __CHAR_BIT__ == 8\n typedef unsigned gcov_unsigned_t __attribute__ ((mode (SI)));\n@@ -237,16 +238,11 @@ extern void __gcov_init (struct gcov_info *) ATTRIBUTE_HIDDEN;\n /* GCOV exit function registered via a static destructor.  */\n extern void __gcov_exit (void) ATTRIBUTE_HIDDEN;\n \n-/* Called before fork, to avoid double counting.  */\n-extern void __gcov_flush (void) ATTRIBUTE_HIDDEN;\n-\n /* Function to reset all counters to 0.  Both externally visible (and\n    overridable) and internal version.  */\n-extern void __gcov_reset (void);\n extern void __gcov_reset_int (void) ATTRIBUTE_HIDDEN;\n \n /* User function to enable early write of profile information so far.  */\n-extern void __gcov_dump (void);\n extern void __gcov_dump_int (void) ATTRIBUTE_HIDDEN;\n \n /* The merge function that just sums the counters.  */"}]}