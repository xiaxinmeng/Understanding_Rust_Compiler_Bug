{"sha": "c573faf5e4f7fad97618dd9dda5120be6c157f3d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzU3M2ZhZjVlNGY3ZmFkOTc2MThkZDlkZGE1MTIwYmU2YzE1N2YzZA==", "commit": {"author": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-12-09T05:04:12Z"}, "committer": {"name": "Ian Lance Taylor", "email": "ian@gcc.gnu.org", "date": "2011-12-09T05:04:12Z"}, "message": "compiler: Another correction to hidden fields in composite literals.\n\nFrom-SVN: r182154", "tree": {"sha": "7ee786096ca0211b338bb10152e2b9dc7383700c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/7ee786096ca0211b338bb10152e2b9dc7383700c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c573faf5e4f7fad97618dd9dda5120be6c157f3d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c573faf5e4f7fad97618dd9dda5120be6c157f3d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c573faf5e4f7fad97618dd9dda5120be6c157f3d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c573faf5e4f7fad97618dd9dda5120be6c157f3d/comments", "author": null, "committer": null, "parents": [{"sha": "14f2a7e2b1a8c5c21603c095a848c895af5b7a10", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/14f2a7e2b1a8c5c21603c095a848c895af5b7a10", "html_url": "https://github.com/Rust-GCC/gccrs/commit/14f2a7e2b1a8c5c21603c095a848c895af5b7a10"}], "stats": {"total": 20, "additions": 12, "deletions": 8}, "files": [{"sha": "18858d519a08ee0b112a8ffdd92b425bfff0f001", "filename": "gcc/go/gofrontend/expressions.cc", "status": "modified", "additions": 12, "deletions": 8, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c573faf5e4f7fad97618dd9dda5120be6c157f3d/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c573faf5e4f7fad97618dd9dda5120be6c157f3d/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgo%2Fgofrontend%2Fexpressions.cc?ref=c573faf5e4f7fad97618dd9dda5120be6c157f3d", "patch": "@@ -12818,16 +12818,20 @@ Composite_literal_expression::lower_struct(Gogo* gogo, Type* type)\n   Struct_type* st = type->struct_type();\n   if (this->vals_ == NULL || !this->has_keys_)\n     {\n-      if (this->vals_ != NULL && !this->vals_->empty())\n-\t{\n-\t  std::string reason;\n-\t  if (type->has_hidden_fields(NULL, &reason))\n+      if (this->vals_ != NULL\n+\t  && !this->vals_->empty()\n+\t  && type->named_type() != NULL\n+\t  && type->named_type()->named_object()->package() != NULL)\n+\t{\n+\t  for (Struct_field_list::const_iterator pf = st->fields()->begin();\n+\t       pf != st->fields()->end();\n+\t       ++pf)\n \t    {\n-\t      if (reason.empty())\n+\t      if (Gogo::is_hidden_name(pf->field_name()))\n \t\terror_at(this->location(),\n-\t\t\t \"implicit assignment of hidden field\");\n-\t      else\n-\t\terror_at(this->location(), \"%s\", reason.c_str());\n+\t\t\t \"assignment of unexported field %qs in %qs literal\",\n+\t\t\t Gogo::message_name(pf->field_name()).c_str(),\n+\t\t\t type->named_type()->message_name().c_str());\n \t    }\n \t}\n "}]}