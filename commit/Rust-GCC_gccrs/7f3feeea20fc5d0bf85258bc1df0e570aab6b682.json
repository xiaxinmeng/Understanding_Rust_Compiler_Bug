{"sha": "7f3feeea20fc5d0bf85258bc1df0e570aab6b682", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2YzZmVlZWEyMGZjNWQwYmY4NTI1OGJjMWRmMGU1NzBhYWI2YjY4Mg==", "commit": {"author": {"name": "Didier FORT", "email": "didier.fort@fedex.com", "date": "1998-10-14T22:29:16Z"}, "committer": {"name": "Jeff Law", "email": "law@gcc.gnu.org", "date": "1998-10-14T22:29:16Z"}, "message": "fixincludes: Fix up rpc/{clnt,svr,xdr}.h for SunOS.\n\n \n        * fixincludes: Fix up rpc/{clnt,svr,xdr}.h for SunOS.\n\nFrom-SVN: r23100", "tree": {"sha": "8d6fe605c3e8866744a50c0d3aaee1ba29e80d96", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8d6fe605c3e8866744a50c0d3aaee1ba29e80d96"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7f3feeea20fc5d0bf85258bc1df0e570aab6b682", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f3feeea20fc5d0bf85258bc1df0e570aab6b682", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f3feeea20fc5d0bf85258bc1df0e570aab6b682", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f3feeea20fc5d0bf85258bc1df0e570aab6b682/comments", "author": null, "committer": null, "parents": [{"sha": "2e945f3803212ce32043a15979ae2c88ddce3123", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e945f3803212ce32043a15979ae2c88ddce3123", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e945f3803212ce32043a15979ae2c88ddce3123"}], "stats": {"total": 62, "additions": 44, "deletions": 18}, "files": [{"sha": "f02bdd334d31780c1283a2ac5c767cdef19aec30", "filename": "gcc/fixincludes", "status": "modified", "additions": 44, "deletions": 18, "changes": 62, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f3feeea20fc5d0bf85258bc1df0e570aab6b682/gcc%2Ffixincludes", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f3feeea20fc5d0bf85258bc1df0e570aab6b682/gcc%2Ffixincludes", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffixincludes?ref=7f3feeea20fc5d0bf85258bc1df0e570aab6b682", "patch": "@@ -2921,35 +2921,61 @@ if [ -r ${LIB}/$file ]; then\n   fi\n fi\n \n-# rpc/xdr.h on SunOS needs prototypes for its XDR->xdr_ops function pointers.\n-file=rpc/xdr.h\n-if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n-  cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n-  chmod +w ${LIB}/$file 2>/dev/null\n-  chmod a+r ${LIB}/$file 2>/dev/null\n-fi\n+# rpc/auth.h on SunOS needs prototypes for its AUTH->auth_ops function pointers\n+# Similarly for \n+#   rpc/clnt.h CLIENT->clnt_ops\n+#   rpc/svc.h SVCXPRT->xp_ops\n+#   rpc/xdr.h XDR->xdr_ops\n+for file in rpc/auth.h rpc/clnt.h rpc/svc.h rpc/xdr.h; do\n+  # each file has a different name to replace, so if you add a file to\n+  # that list please update the following case statement.\n+  case \"$file\" in\n+    rpc/auth.h)\n+      prefix=\"ah_\"\n+      ;;\n+    rpc/clnt.h)\n+      prefix=\"cl_\"\n+      ;;\n+    rpc/svc.h)\n+      prefix=\"xp_\"\n+      ;;\n+    rpc/xdr.h)\n+      prefix=\"x_\"\n+      ;;\n+    *)\n+      # Oh Oh, we shouldn't be here\n+      exit 1;\n+      ;;\n+  esac\n \n-if [ -r ${LIB}/$file ]; then\n-  echo \"Checking for needed C++ prototype in $file\"\n-  sed -e 's/^\\(.*\\)\\*\\(x_.*\\)();\\(.*\\)/\\\n+  if [ -r $file ] && [ ! -r ${LIB}/$file ]; then\n+    cp $file ${LIB}/$file >/dev/null 2>&1 || echo \"Can't copy $file\"\n+    chmod +w ${LIB}/$file 2>/dev/null\n+    chmod a+r ${LIB}/$file 2>/dev/null\n+  fi\n+\n+  if [ -r ${LIB}/$file ]; then\n+    echo \"Checking for needed C++ prototype in $file\"\n+    sed -e 's/^\\(.*\\)\\*\\('$prefix'.*\\)();\\(.*\\)/\\\n #ifdef __cplusplus\\\n \\1*\\2(...);\\3\\\n #else\\\n \\1*\\2();\\3\\\n #endif/g' \\\n      $LIB/$file > ${LIB}/${file}.sed\n \n-  rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n-  if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n-    rm -f ${LIB}/$file\n-  else\n-    # Find any include directives that use \"file\".\n-    for include in `egrep '^[       ]*#[    ]*include[      ]*\"[^/]' ${LIB}/$file | sed -e 's/^[    ]*#[    ]*include[      ]*\"\\([^\"]*\\)\".*$/\\1/'`; do\n+    rm -f ${LIB}/$file; mv ${LIB}/${file}.sed ${LIB}/$file\n+    if cmp $file ${LIB}/$file >/dev/null 2>&1; then\n+      rm -f ${LIB}/$file\n+    else\n+      # Find any include directives that use \"file\".\n+      for include in `egrep '^[       ]*#[    ]*include[      ]*\"[^/]' ${LIB}/$file | sed -e 's/^[    ]*#[    ]*include[      ]*\"\\([^\"]*\\)\".*$/\\1/'`; do\n \tdir=`echo $file | sed -e s'|/[^/]*$||'`\n \trequired=\"$required ${INPUT} $dir/$include ${LIB}/$dir/$include\"\n-    done\n+      done\n+    fi\n   fi\n-fi\n+done\n \n # sys/lc_core.h on some versions of OSF1/4.x pollutes the namespace by\n # defining regex.h types.  This causes C++ library build and usage failures."}]}