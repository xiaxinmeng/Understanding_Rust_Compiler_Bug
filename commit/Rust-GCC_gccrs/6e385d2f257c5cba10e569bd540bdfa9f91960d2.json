{"sha": "6e385d2f257c5cba10e569bd540bdfa9f91960d2", "node_id": "C_kwDOANBUbNoAKDZlMzg1ZDJmMjU3YzVjYmExMGU1NjliZDU0MGJkZmE5ZjkxOTYwZDI", "commit": {"author": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2022-03-17T09:44:46Z"}, "committer": {"name": "Philip Herron", "email": "philip.herron@embecosm.com", "date": "2022-03-17T09:51:39Z"}, "message": "Fix bad copy-paste in can equal interface for pointer types\n\nWhen we perform method resolution we check if the self arguments can be\nmatched. Here the bug was that pointer types had a bad vistitor and only\ncould ever match reference types which is wrong and was a copy paste error.\n\nFixes #1031", "tree": {"sha": "21a6cb15c6e07550a3ad851f5b7aea42527a70d7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/21a6cb15c6e07550a3ad851f5b7aea42527a70d7"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6e385d2f257c5cba10e569bd540bdfa9f91960d2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e385d2f257c5cba10e569bd540bdfa9f91960d2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6e385d2f257c5cba10e569bd540bdfa9f91960d2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6e385d2f257c5cba10e569bd540bdfa9f91960d2/comments", "author": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "committer": {"login": "philberty", "id": 84585, "node_id": "MDQ6VXNlcjg0NTg1", "avatar_url": "https://avatars.githubusercontent.com/u/84585?v=4", "gravatar_id": "", "url": "https://api.github.com/users/philberty", "html_url": "https://github.com/philberty", "followers_url": "https://api.github.com/users/philberty/followers", "following_url": "https://api.github.com/users/philberty/following{/other_user}", "gists_url": "https://api.github.com/users/philberty/gists{/gist_id}", "starred_url": "https://api.github.com/users/philberty/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/philberty/subscriptions", "organizations_url": "https://api.github.com/users/philberty/orgs", "repos_url": "https://api.github.com/users/philberty/repos", "events_url": "https://api.github.com/users/philberty/events{/privacy}", "received_events_url": "https://api.github.com/users/philberty/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "bb234b080a5be332bbe67d9920a65959124088e7", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb234b080a5be332bbe67d9920a65959124088e7", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb234b080a5be332bbe67d9920a65959124088e7"}], "stats": {"total": 18, "additions": 17, "deletions": 1}, "files": [{"sha": "684c41abc2f8a140606069132b8907b8de97f7d4", "filename": "gcc/rust/typecheck/rust-tyty-cmp.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e385d2f257c5cba10e569bd540bdfa9f91960d2/gcc%2Frust%2Ftypecheck%2Frust-tyty-cmp.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e385d2f257c5cba10e569bd540bdfa9f91960d2/gcc%2Frust%2Ftypecheck%2Frust-tyty-cmp.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Frust%2Ftypecheck%2Frust-tyty-cmp.h?ref=6e385d2f257c5cba10e569bd540bdfa9f91960d2", "patch": "@@ -1240,7 +1240,7 @@ class PointerCmp : public BaseCmp\n     : BaseCmp (base, emit_errors), base (base)\n   {}\n \n-  void visit (const ReferenceType &type) override\n+  void visit (const PointerType &type) override\n   {\n     auto base_type = base->get_base ();\n     auto other_base_type = type.get_base ();"}, {"sha": "6727f34336f31aab012c2ea2660b045475e132a2", "filename": "gcc/testsuite/rust/compile/issue-1031.rs", "status": "added", "additions": 16, "deletions": 0, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6e385d2f257c5cba10e569bd540bdfa9f91960d2/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1031.rs", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6e385d2f257c5cba10e569bd540bdfa9f91960d2/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1031.rs", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Frust%2Fcompile%2Fissue-1031.rs?ref=6e385d2f257c5cba10e569bd540bdfa9f91960d2", "patch": "@@ -0,0 +1,16 @@\n+extern \"rust-intrinsic\" {\n+    pub fn offset<T>(dst: *const T, offset: isize) -> *const T;\n+}\n+\n+#[lang = \"const_ptr\"]\n+impl<T> *const T {\n+    pub const unsafe fn offset(self, count: isize) -> *const T {\n+        // { dg-warning \"associated function is never used\" \"\" { target *-*-* } .-1 }\n+        unsafe { offset(self, count) }\n+    }\n+\n+    pub const unsafe fn add(self, count: usize) -> Self {\n+        // { dg-warning \"associated function is never used\" \"\" { target *-*-* } .-1 }\n+        unsafe { self.offset(count as isize) }\n+    }\n+}"}]}