{"sha": "d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZDk3YzliMjI0OGE4NmZjOGEyZDNmNjVkZjBlMGE2MzM0N2M4OWUyYQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2012-12-20T18:13:56Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2012-12-20T18:13:56Z"}, "message": "re PR middle-end/55750 (-( in expand_expr_addr_expr_1, at expr.c:7646)\n\n\tPR middle-end/55750\n\t* gimplify.c (gimplify_self_mod_expr): Don't force lvalue to\n\tpass is_gimple_min_lval.\n\n\t* gcc.c-torture/execute/pr55750.c: New test.\n\nFrom-SVN: r194647", "tree": {"sha": "59a1a32f0ecc1e856d08b15d3921d000019c27c2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/59a1a32f0ecc1e856d08b15d3921d000019c27c2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "5bb339361a483eca12853be5729b7b1ad12ed3dd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5bb339361a483eca12853be5729b7b1ad12ed3dd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5bb339361a483eca12853be5729b7b1ad12ed3dd"}], "stats": {"total": 56, "additions": 43, "deletions": 13}, "files": [{"sha": "9e7a4b73f2e27035d51e1eebfa8c0abf08fb88a6", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "patch": "@@ -1,3 +1,9 @@\n+2012-12-20  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/55750\n+\t* gimplify.c (gimplify_self_mod_expr): Don't force lvalue to\n+\tpass is_gimple_min_lval.\n+\n 2012-12-20  Richard Henderson  <rth@redhat.com>\n \t    Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>\n "}, {"sha": "e79d06397e0672a4c298bae4365604c445344129", "filename": "gcc/gimplify.c", "status": "modified", "additions": 3, "deletions": 13, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2Fgimplify.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2Fgimplify.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgimplify.c?ref=d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "patch": "@@ -2391,25 +2391,15 @@ gimplify_self_mod_expr (tree *expr_p, gimple_seq *pre_p, gimple_seq *post_p,\n   rhs = TREE_OPERAND (*expr_p, 1);\n \n   /* For postfix operator, we evaluate the LHS to an rvalue and then use\n-     that as the result value and in the postqueue operation.  We also\n-     make sure to make lvalue a minimal lval, see\n-     gcc.c-torture/execute/20040313-1.c for an example where this matters.  */\n+     that as the result value and in the postqueue operation.  */\n   if (postfix)\n     {\n-      if (!is_gimple_min_lval (lvalue))\n-\t{\n-\t  mark_addressable (lvalue);\n-\t  lvalue = build_fold_addr_expr_loc (input_location, lvalue);\n-\t  gimplify_expr (&lvalue, pre_p, post_p, is_gimple_val, fb_rvalue);\n-\t  lvalue = build_fold_indirect_ref_loc (input_location, lvalue);\n-\t}\n       ret = gimplify_expr (&lhs, pre_p, post_p, is_gimple_val, fb_rvalue);\n       if (ret == GS_ERROR)\n \treturn ret;\n-    }\n \n-  if (postfix)\n-    lhs = get_initialized_tmp_var (lhs, pre_p, NULL);\n+      lhs = get_initialized_tmp_var (lhs, pre_p, NULL);\n+    }\n \n   /* For POINTERs increment, use POINTER_PLUS_EXPR.  */\n   if (POINTER_TYPE_P (TREE_TYPE (lhs)))"}, {"sha": "b89fa028ac6c0beb87b8002badf2423908f2072e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "patch": "@@ -1,3 +1,8 @@\n+2012-12-20  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR middle-end/55750\n+\t* gcc.c-torture/execute/pr55750.c: New test.\n+\n 2012-12-20  Richard Biener  <rguenther@suse.de>\n \n \tPR middle-end/55740"}, {"sha": "d2b3c63cd04e68e84933ed1c7e58d50cb4aaa4a1", "filename": "gcc/testsuite/gcc.c-torture/execute/pr55750.c", "status": "added", "additions": 29, "deletions": 0, "changes": 29, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr55750.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr55750.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr55750.c?ref=d97c9b2248a86fc8a2d3f65df0e0a63347c89e2a", "patch": "@@ -0,0 +1,29 @@\n+/* PR middle-end/55750 */\n+\n+extern void abort (void);\n+\n+struct S\n+{\n+  int m : 1;\n+  int n : 7;\n+} arr[2];\n+\n+__attribute__((noinline, noclone)) void\n+foo (unsigned i)\n+{\n+  arr[i].n++;\n+}\n+\n+int\n+main ()\n+{\n+  arr[0].m = -1;\n+  arr[0].n = (1 << 6) - 1;\n+  arr[1].m = 0;\n+  arr[1].n = -1;\n+  foo (0);\n+  foo (1);\n+  if (arr[0].m != -1 || arr[0].n != -(1 << 6) || arr[1].m != 0 || arr[1].n != 0)\n+    abort ();\n+  return 0;\n+}"}]}