{"sha": "89cbb85b5fd8899fe370ecc4573780685c8487fa", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODljYmI4NWI1ZmQ4ODk5ZmUzNzBlY2M0NTczNzgwNjg1Yzg0ODdmYQ==", "commit": {"author": {"name": "Diego Novillo", "email": "dnovillo@google.com", "date": "2013-04-18T18:11:05Z"}, "committer": {"name": "Diego Novillo", "email": "dnovillo@gcc.gnu.org", "date": "2013-04-18T18:11:05Z"}, "message": "Loosen check for build directory.\n\n\t* validate_failures.py: Loosen check for build directory.\n\tState what failed if we couldn't find the source tree or\n\tthe target triplet.\n\nFrom-SVN: r198064", "tree": {"sha": "83ba0f79a71b9577f4fc47078b2395da26f7b410", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/83ba0f79a71b9577f4fc47078b2395da26f7b410"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/89cbb85b5fd8899fe370ecc4573780685c8487fa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89cbb85b5fd8899fe370ecc4573780685c8487fa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/89cbb85b5fd8899fe370ecc4573780685c8487fa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/89cbb85b5fd8899fe370ecc4573780685c8487fa/comments", "author": {"login": "dnovillo", "id": 7295335, "node_id": "MDQ6VXNlcjcyOTUzMzU=", "avatar_url": "https://avatars.githubusercontent.com/u/7295335?v=4", "gravatar_id": "", "url": "https://api.github.com/users/dnovillo", "html_url": "https://github.com/dnovillo", "followers_url": "https://api.github.com/users/dnovillo/followers", "following_url": "https://api.github.com/users/dnovillo/following{/other_user}", "gists_url": "https://api.github.com/users/dnovillo/gists{/gist_id}", "starred_url": "https://api.github.com/users/dnovillo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/dnovillo/subscriptions", "organizations_url": "https://api.github.com/users/dnovillo/orgs", "repos_url": "https://api.github.com/users/dnovillo/repos", "events_url": "https://api.github.com/users/dnovillo/events{/privacy}", "received_events_url": "https://api.github.com/users/dnovillo/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "23662b9aa8dbf870b3d576dfa7dfa68474834e04", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23662b9aa8dbf870b3d576dfa7dfa68474834e04", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23662b9aa8dbf870b3d576dfa7dfa68474834e04"}], "stats": {"total": 25, "additions": 17, "deletions": 8}, "files": [{"sha": "3dd147be9e80d23317cc31bcd08c717aab97eb9c", "filename": "contrib/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cbb85b5fd8899fe370ecc4573780685c8487fa/contrib%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cbb85b5fd8899fe370ecc4573780685c8487fa/contrib%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2FChangeLog?ref=89cbb85b5fd8899fe370ecc4573780685c8487fa", "patch": "@@ -1,3 +1,9 @@\n+2013-04-18  Diego Novillo  <dnovillo@google.com>\n+\n+\t* validate_failures.py: Loosen check for build directory.\n+\tState what failed if we couldn't find the source tree or\n+\tthe target triplet.\n+\n 2013-03-22  Jakub Jelinek  <jakub@redhat.com>\n \n \t* gennews (files): Add files for GCC 4.8."}, {"sha": "aa71c940df9c9fffe00cb4c5f1bc48f0c4e0d23e", "filename": "contrib/testsuite-management/validate_failures.py", "status": "modified", "additions": 11, "deletions": 8, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/89cbb85b5fd8899fe370ecc4573780685c8487fa/contrib%2Ftestsuite-management%2Fvalidate_failures.py", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/89cbb85b5fd8899fe370ecc4573780685c8487fa/contrib%2Ftestsuite-management%2Fvalidate_failures.py", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Ftestsuite-management%2Fvalidate_failures.py?ref=89cbb85b5fd8899fe370ecc4573780685c8487fa", "patch": "@@ -196,11 +196,9 @@ def GetMakefileValue(makefile_name, value_name):\n   return None\n \n \n-def ValidBuildDirectory(builddir, target):\n+def ValidBuildDirectory(builddir):\n   if (not os.path.exists(builddir) or\n-      not os.path.exists('%s/Makefile' % builddir) or\n-      (not os.path.exists('%s/build-%s' % (builddir, target)) and\n-       not os.path.exists('%s/%s' % (builddir, target)))):\n+      not os.path.exists('%s/Makefile' % builddir)):\n     return False\n   return True\n \n@@ -362,14 +360,17 @@ def GetManifestPath(srcdir, target, user_provided_must_exist):\n       Error('Manifest does not exist: %s' % manifest_path)\n     return manifest_path\n   else:\n-    assert srcdir and target\n+    if not srcdir:\n+      Error('Could not determine where the location of GCC\\'s source tree. '\n+            'The Makefile does not contain a definition for \"srcdir\".')\n+    if not target:\n+      Error('Could not determine the target triplet for this build. '\n+            'The Makefile does not contain a definition for \"target_alias\".')\n     return _MANIFEST_PATH_PATTERN % (srcdir, _MANIFEST_SUBDIR, target)\n \n \n def GetBuildData():\n-  srcdir = GetMakefileValue('%s/Makefile' % _OPTIONS.build_dir, 'srcdir =')\n-  target = GetMakefileValue('%s/Makefile' % _OPTIONS.build_dir, 'target_alias=')\n-  if not ValidBuildDirectory(_OPTIONS.build_dir, target):\n+  if not ValidBuildDirectory(_OPTIONS.build_dir):\n     # If we have been given a set of results to use, we may\n     # not be inside a valid GCC build directory.  In that case,\n     # the user must provide both a manifest file and a set\n@@ -380,6 +381,8 @@ def GetBuildData():\n             _OPTIONS.build_dir)\n     else:\n       return None, None\n+  srcdir = GetMakefileValue('%s/Makefile' % _OPTIONS.build_dir, 'srcdir =')\n+  target = GetMakefileValue('%s/Makefile' % _OPTIONS.build_dir, 'target_alias=')\n   print 'Source directory: %s' % srcdir\n   print 'Build target:     %s' % target\n   return srcdir, target"}]}