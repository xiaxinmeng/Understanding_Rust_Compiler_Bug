{"sha": "a616b1da79fa53234feb3367578720f0d6573cdc", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTYxNmIxZGE3OWZhNTMyMzRmZWIzMzY3NTc4NzIwZjBkNjU3M2NkYw==", "commit": {"author": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2007-04-01T17:33:13Z"}, "committer": {"name": "Jerry DeLisle", "email": "jvdelisle@gcc.gnu.org", "date": "2007-04-01T17:33:13Z"}, "message": "re PR libfortran/31052 ([4.2 only] Bad IOSTAT values when readings NAMELISTs past EOF)\n\n2007-04-01  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n\n\tPR libgfortran/31052\n\t* gfortran.dg/namelist_28.f90: New test.\n\nFrom-SVN: r123404", "tree": {"sha": "124e47d6539a871f893d7ecce76be7243aeb0750", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/124e47d6539a871f893d7ecce76be7243aeb0750"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a616b1da79fa53234feb3367578720f0d6573cdc", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a616b1da79fa53234feb3367578720f0d6573cdc", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a616b1da79fa53234feb3367578720f0d6573cdc", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a616b1da79fa53234feb3367578720f0d6573cdc/comments", "author": null, "committer": null, "parents": [{"sha": "08f9246a4574b9882c67bc64fabc69817142948f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/08f9246a4574b9882c67bc64fabc69817142948f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/08f9246a4574b9882c67bc64fabc69817142948f"}], "stats": {"total": 95, "additions": 95, "deletions": 0}, "files": [{"sha": "3b4d65abef76499f2e7f014aba93bd87e0deaebc", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a616b1da79fa53234feb3367578720f0d6573cdc/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a616b1da79fa53234feb3367578720f0d6573cdc/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=a616b1da79fa53234feb3367578720f0d6573cdc", "patch": "@@ -1,3 +1,8 @@\n+2007-04-01  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n+\n+\tPR libgfortran/31052\n+\t* gfortran.dg/namelist_28.f90: New test.\n+\n 2007-04-01  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libgfortran/31366"}, {"sha": "53b1f0ff0022b22da855809b0dbcd0fc26c563f4", "filename": "gcc/testsuite/gfortran.dg/namelist_28.f90", "status": "added", "additions": 90, "deletions": 0, "changes": 90, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a616b1da79fa53234feb3367578720f0d6573cdc/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_28.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a616b1da79fa53234feb3367578720f0d6573cdc/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_28.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fnamelist_28.f90?ref=a616b1da79fa53234feb3367578720f0d6573cdc", "patch": "@@ -0,0 +1,90 @@\n+! { dg-do run }\n+! PR31052 Bad IOSTAT values when readings NAMELISTs past EOF.\n+! Patch derived from PR, submitted by Jerry DeLisle <jvdelisle@gcc.gnu.org>\n+program gfcbug61\n+  implicit none\n+  integer, parameter :: nmlunit = 12    ! Namelist unit\n+  integer            :: stat\n+\n+  open (nmlunit, status=\"scratch\")\n+  write(nmlunit, '(a)') \"&REPORT type='report1' /\"\n+  write(nmlunit, '(a)') \"&REPORT type='report2' /\"\n+  write(nmlunit, '(a)') \"!\"\n+  rewind (nmlunit)\n+\n+! The call to position_nml is contained in the subroutine\n+  call read_report (nmlunit, stat)\n+  rewind (nmlunit)\n+  call position_nml (nmlunit, 'MISSING', stat)\n+  rewind (nmlunit)\n+  call read_report (nmlunit, stat)              ! gfortran fails here\n+  \n+contains\n+\n+  subroutine position_nml (unit, name, status)\n+    ! Check for presence of namelist 'name'\n+    integer                      :: unit, status\n+    character(len=*), intent(in) :: name\n+\n+    character(len=255) :: line\n+    integer            :: ios, idx\n+    logical            :: first\n+\n+    first = .true.\n+    status = 0\n+    do\n+       line = \"\"\n+       read (unit,'(a)',iostat=ios) line\n+       if (ios < 0) then\n+          ! EOF encountered!\n+          backspace (unit)\n+          status = -1\n+          return\n+       else if (ios > 0) then\n+          ! Error encountered!\n+          status = +1\n+          return\n+       end if\n+       idx = index (line, \"&\"//trim (name))\n+       if (idx > 0) then\n+          backspace (unit)\n+          return\n+       end if\n+    end do\n+  end subroutine position_nml\n+\n+  subroutine read_report (unit, status)\n+    integer :: unit, status\n+\n+    integer            :: iuse, ios\n+    !------------------\n+    ! Namelist 'REPORT'\n+    !------------------\n+    character(len=12) :: type\n+    namelist /REPORT/ type\n+    !-------------------------------------\n+    ! Loop to read namelist multiple times\n+    !-------------------------------------\n+    iuse = 0\n+    do\n+       !----------------------------------------\n+       ! Preset namelist variables with defaults\n+       !----------------------------------------\n+       type      = ''\n+       !--------------\n+       ! Read namelist\n+       !--------------\n+       call position_nml (unit, \"REPORT\", status)\n+       if (stat /= 0) then\n+          ios = status\n+          if (iuse /= 2) call abort()\n+          return\n+       end if\n+       read (unit, nml=REPORT, iostat=ios)\n+       if (ios /= 0) exit\n+       iuse = iuse + 1\n+    end do\n+    status = ios\n+  end subroutine read_report\n+\n+end program gfcbug61"}]}