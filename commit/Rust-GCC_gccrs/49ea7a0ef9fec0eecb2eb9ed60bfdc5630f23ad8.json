{"sha": "49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NDllYTdhMGVmOWZlYzBlZWNiMmViOWVkNjBiZmRjNTYzMGYyM2FkOA==", "commit": {"author": {"name": "Rainer Orth", "email": "ro@CeBiTec.Uni-Bielefeld.DE", "date": "2010-07-02T10:12:34Z"}, "committer": {"name": "Rainer Orth", "email": "ro@gcc.gnu.org", "date": "2010-07-02T10:12:34Z"}, "message": "configure.ac: Check for Sun symbol versioning.\n\n\t* configure.ac: Check for Sun symbol versioning.\n\t* configure: Regenerate.\n\n\t* Makefile.am [LIBGFOR_USE_SYMVER]: Protect version_arg with\n\tLIBGFOR_USE_SYMVER_GNU.\n\tAdd version_dep.\n\t[LIBGFOR_USE_SYMVER_SUN]: Handle Sun symbol versioning.\n\t[!LIBGFOR_USE_SYMVER]: Add version_dep.\n\t(libgfortran_la_DEPENDENCIES): Set to $(version_dep).\n\t* Makefile.in: Regenerate.\n\nFrom-SVN: r161697", "tree": {"sha": "2485a81d15975a9f6f3bcd7cea6ddd05d1c6d03f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2485a81d15975a9f6f3bcd7cea6ddd05d1c6d03f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/comments", "author": {"login": "rorth", "id": 3930951, "node_id": "MDQ6VXNlcjM5MzA5NTE=", "avatar_url": "https://avatars.githubusercontent.com/u/3930951?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rorth", "html_url": "https://github.com/rorth", "followers_url": "https://api.github.com/users/rorth/followers", "following_url": "https://api.github.com/users/rorth/following{/other_user}", "gists_url": "https://api.github.com/users/rorth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rorth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rorth/subscriptions", "organizations_url": "https://api.github.com/users/rorth/orgs", "repos_url": "https://api.github.com/users/rorth/repos", "events_url": "https://api.github.com/users/rorth/events{/privacy}", "received_events_url": "https://api.github.com/users/rorth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c18dc5cceab24096cbb83deacabb75b77d57a9df", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c18dc5cceab24096cbb83deacabb75b77d57a9df", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c18dc5cceab24096cbb83deacabb75b77d57a9df"}], "stats": {"total": 139, "additions": 128, "deletions": 11}, "files": [{"sha": "4e4120f94fbd7db04524c75ff6c9bad15a770382", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "patch": "@@ -1,3 +1,16 @@\n+2010-07-02  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>\n+\n+\t* configure.ac: Check for Sun symbol versioning.\n+\t* configure: Regenerate.\n+\n+\t* Makefile.am [LIBGFOR_USE_SYMVER]: Protect version_arg with\n+\tLIBGFOR_USE_SYMVER_GNU.\n+\tAdd version_dep.\n+\t[LIBGFOR_USE_SYMVER_SUN]: Handle Sun symbol versioning.\n+\t[!LIBGFOR_USE_SYMVER]: Add version_dep.\n+\t(libgfortran_la_DEPENDENCIES): Set to $(version_dep).\n+\t* Makefile.in: Regenerate.\n+\n 2010-06-29  Jerry DeLisle  <jvdelisle@gcc.gnu.org>\n \n \tPR libfortran/43298"}, {"sha": "9940caf57bac6b964bffc6919729826127391219", "filename": "libgfortran/Makefile.am", "status": "modified", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2FMakefile.am", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2FMakefile.am", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FMakefile.am?ref=49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "patch": "@@ -8,9 +8,26 @@ gcc_version := $(shell cat $(top_srcdir)/../gcc/BASE-VER)\n \n ## Symbol versioning (copied from libssp).\n if LIBGFOR_USE_SYMVER\n+if LIBGFOR_USE_SYMVER_GNU\n version_arg = -Wl,--version-script=$(srcdir)/gfortran.map\n+version_dep = $(srcdir)/gfortran.map\n+endif\n+if LIBGFOR_USE_SYMVER_SUN\n+version_arg = -Wl,-M,gfortran.map-sun\n+version_dep = gfortran.map-sun\n+gfortran.map-sun : $(srcdir)/gfortran.map \\\n+\t\t$(top_srcdir)/../contrib/make_sunver.pl \\\n+\t\t$(libgfortran_la_OBJECTS) $(libgfortran_la_LIBADD)\n+\tperl $(top_srcdir)/../contrib/make_sunver.pl \\\n+\t  $(srcdir)/gfortran.map \\\n+\t  $(libgfortran_la_OBJECTS:%.lo=.libs/%.o) \\\n+\t `echo $(libgfortran_la_LIBADD) | \\\n+\t    sed 's,/\\([^/.]*\\)\\.la,/.libs/\\1.a,g'` \\\n+\t > $@ || (rm -f $@ ; exit 1)\n+endif\n else\n version_arg =\n+version_dep =\n endif\n \n LTLDFLAGS = $(shell $(SHELL) $(top_srcdir)/../libtool-ldflags $(LDFLAGS)) \\\n@@ -19,6 +36,7 @@ LTLDFLAGS = $(shell $(SHELL) $(top_srcdir)/../libtool-ldflags $(LDFLAGS)) \\\n toolexeclib_LTLIBRARIES = libgfortran.la\n libgfortran_la_LINK = $(LINK) $(libgfortran_la_LDFLAGS)\n libgfortran_la_LDFLAGS = -version-info `grep -v '^\\#' $(srcdir)/libtool-version` $(LTLDFLAGS) -lm $(extra_ldflags_libgfortran) $(version_arg)\n+libgfortran_la_DEPENDENCIES = $(version_dep)\n \n myexeclib_LTLIBRARIES = libgfortranbegin.la\n myexeclibdir = $(libdir)/gcc/$(target_alias)/$(gcc_version)$(MULTISUBDIR)"}, {"sha": "880d00de167568ce595441b3167f1f2e54506327", "filename": "libgfortran/Makefile.in", "status": "modified", "additions": 15, "deletions": 1, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FMakefile.in?ref=49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "patch": "@@ -453,13 +453,18 @@ top_srcdir = @top_srcdir@\n ACLOCAL_AMFLAGS = -I .. -I ../config\n gcc_version := $(shell cat $(top_srcdir)/../gcc/BASE-VER)\n @LIBGFOR_USE_SYMVER_FALSE@version_arg = \n-@LIBGFOR_USE_SYMVER_TRUE@version_arg = -Wl,--version-script=$(srcdir)/gfortran.map\n+@LIBGFOR_USE_SYMVER_GNU_TRUE@@LIBGFOR_USE_SYMVER_TRUE@version_arg = -Wl,--version-script=$(srcdir)/gfortran.map\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@version_arg = -Wl,-M,gfortran.map-sun\n+@LIBGFOR_USE_SYMVER_FALSE@version_dep = \n+@LIBGFOR_USE_SYMVER_GNU_TRUE@@LIBGFOR_USE_SYMVER_TRUE@version_dep = $(srcdir)/gfortran.map\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@version_dep = gfortran.map-sun\n LTLDFLAGS = $(shell $(SHELL) $(top_srcdir)/../libtool-ldflags $(LDFLAGS)) \\\n \t    -no-undefined -bindir \"$(bindir)\"\n \n toolexeclib_LTLIBRARIES = libgfortran.la\n libgfortran_la_LINK = $(LINK) $(libgfortran_la_LDFLAGS)\n libgfortran_la_LDFLAGS = -version-info `grep -v '^\\#' $(srcdir)/libtool-version` $(LTLDFLAGS) -lm $(extra_ldflags_libgfortran) $(version_arg)\n+libgfortran_la_DEPENDENCIES = $(version_dep)\n myexeclib_LTLIBRARIES = libgfortranbegin.la\n myexeclibdir = $(libdir)/gcc/$(target_alias)/$(gcc_version)$(MULTISUBDIR)\n libgfortranbegin_la_SOURCES = fmain.c\n@@ -5472,6 +5477,15 @@ uninstall-am: uninstall-myexeclibLTLIBRARIES \\\n \tuninstall-myexeclibLTLIBRARIES \\\n \tuninstall-toolexeclibLTLIBRARIES\n \n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@gfortran.map-sun : $(srcdir)/gfortran.map \\\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\t\t$(top_srcdir)/../contrib/make_sunver.pl \\\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\t\t$(libgfortran_la_OBJECTS) $(libgfortran_la_LIBADD)\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\tperl $(top_srcdir)/../contrib/make_sunver.pl \\\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\t  $(srcdir)/gfortran.map \\\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\t  $(libgfortran_la_OBJECTS:%.lo=.libs/%.o) \\\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\t `echo $(libgfortran_la_LIBADD) | \\\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\t    sed 's,/\\([^/.]*\\)\\.la,/.libs/\\1.a,g'` \\\n+@LIBGFOR_USE_SYMVER_SUN_TRUE@@LIBGFOR_USE_SYMVER_TRUE@\t > $@ || (rm -f $@ ; exit 1)\n \n # Turn on vectorization and loop unrolling for matmul.\n $(patsubst %.c,%.lo,$(notdir $(i_matmul_c))): AM_CFLAGS += -ftree-vectorize -funroll-loops"}, {"sha": "b1a98f81992aba7027041be9959695c511ce5e98", "filename": "libgfortran/configure", "status": "modified", "additions": 65, "deletions": 6, "changes": 71, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fconfigure?ref=49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "patch": "@@ -630,6 +630,10 @@ RANLIB\n AR\n AS\n SECTION_FLAGS\n+LIBGFOR_USE_SYMVER_SUN_FALSE\n+LIBGFOR_USE_SYMVER_SUN_TRUE\n+LIBGFOR_USE_SYMVER_GNU_FALSE\n+LIBGFOR_USE_SYMVER_GNU_TRUE\n LIBGFOR_USE_SYMVER_FALSE\n LIBGFOR_USE_SYMVER_TRUE\n AM_CFLAGS\n@@ -4414,13 +4418,13 @@ fi\n # Check for symbol versioning (copied from libssp).\n { $as_echo \"$as_me:${as_lineno-$LINENO}: checking whether symbol versioning is supported\" >&5\n $as_echo_n \"checking whether symbol versioning is supported... \" >&6; }\n+save_LDFLAGS=\"$LDFLAGS\"\n+LDFLAGS=\"$LDFLAGS -fPIC -shared -Wl,--version-script,./conftest.map\"\n cat > conftest.map <<EOF\n FOO_1.0 {\n   global: *foo*; bar; local: *;\n };\n EOF\n-save_LDFLAGS=\"$LDFLAGS\"\n-LDFLAGS=\"$LDFLAGS -fPIC -shared -Wl,--version-script,./conftest.map\"\n \n if test x$gcc_no_link = xyes; then\n   as_fn_error \"Link tests are not allowed after GCC_NO_EXECUTABLES.\" \"$LINENO\" 5\n@@ -4437,23 +4441,70 @@ main ()\n }\n _ACEOF\n if ac_fn_c_try_link \"$LINENO\"; then :\n-  gfortran_use_symver=yes\n+  gfortran_use_symver=gnu\n+else\n+  gfortran_use_symver=no\n+fi\n+rm -f core conftest.err conftest.$ac_objext \\\n+    conftest$ac_exeext conftest.$ac_ext\n+if test x$gfortran_use_symver = xno; then\n+  LDFLAGS=\"$save_LDFLAGS\"\n+  LDFLAGS=\"$LDFLAGS -fPIC -shared -Wl,-M,./conftest.map\"\n+  # Sun ld cannot handle wildcards and treats all entries as undefined.\n+  cat > conftest.map <<EOF\n+FOO_1.0 {\n+  global: foo; local: *;\n+};\n+EOF\n+  if test x$gcc_no_link = xyes; then\n+  as_fn_error \"Link tests are not allowed after GCC_NO_EXECUTABLES.\" \"$LINENO\" 5\n+fi\n+cat confdefs.h - <<_ACEOF >conftest.$ac_ext\n+/* end confdefs.h.  */\n+int foo;\n+int\n+main ()\n+{\n+\n+  ;\n+  return 0;\n+}\n+_ACEOF\n+if ac_fn_c_try_link \"$LINENO\"; then :\n+  gfortran_use_symver=sun\n else\n   gfortran_use_symver=no\n fi\n rm -f core conftest.err conftest.$ac_objext \\\n     conftest$ac_exeext conftest.$ac_ext\n+fi\n LDFLAGS=\"$save_LDFLAGS\"\n { $as_echo \"$as_me:${as_lineno-$LINENO}: result: $gfortran_use_symver\" >&5\n $as_echo \"$gfortran_use_symver\" >&6; }\n- if test \"x$gfortran_use_symver\" = xyes; then\n+ if test \"x$gfortran_use_symver\" != xno; then\n   LIBGFOR_USE_SYMVER_TRUE=\n   LIBGFOR_USE_SYMVER_FALSE='#'\n else\n   LIBGFOR_USE_SYMVER_TRUE='#'\n   LIBGFOR_USE_SYMVER_FALSE=\n fi\n \n+ if test \"x$gfortran_use_symver\" = xgnu; then\n+  LIBGFOR_USE_SYMVER_GNU_TRUE=\n+  LIBGFOR_USE_SYMVER_GNU_FALSE='#'\n+else\n+  LIBGFOR_USE_SYMVER_GNU_TRUE='#'\n+  LIBGFOR_USE_SYMVER_GNU_FALSE=\n+fi\n+\n+ if test \"x$gfortran_use_symver\" = xsun; then\n+  LIBGFOR_USE_SYMVER_SUN_TRUE=\n+  LIBGFOR_USE_SYMVER_SUN_FALSE='#'\n+else\n+  LIBGFOR_USE_SYMVER_SUN_TRUE='#'\n+  LIBGFOR_USE_SYMVER_SUN_FALSE=\n+fi\n+\n \n # Figure out whether the compiler supports \"-ffunction-sections -fdata-sections\",\n # similarly to how libstdc++ does it\n@@ -11307,7 +11358,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11310 \"configure\"\n+#line 11361 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -11413,7 +11464,7 @@ else\n   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2\n   lt_status=$lt_dlunknown\n   cat > conftest.$ac_ext <<_LT_EOF\n-#line 11416 \"configure\"\n+#line 11467 \"configure\"\n #include \"confdefs.h\"\n \n #if HAVE_DLFCN_H\n@@ -25091,6 +25142,14 @@ if test -z \"${LIBGFOR_USE_SYMVER_TRUE}\" && test -z \"${LIBGFOR_USE_SYMVER_FALSE}\"\n   as_fn_error \"conditional \\\"LIBGFOR_USE_SYMVER\\\" was never defined.\n Usually this means the macro was only invoked conditionally.\" \"$LINENO\" 5\n fi\n+if test -z \"${LIBGFOR_USE_SYMVER_GNU_TRUE}\" && test -z \"${LIBGFOR_USE_SYMVER_GNU_FALSE}\"; then\n+  as_fn_error \"conditional \\\"LIBGFOR_USE_SYMVER_GNU\\\" was never defined.\n+Usually this means the macro was only invoked conditionally.\" \"$LINENO\" 5\n+fi\n+if test -z \"${LIBGFOR_USE_SYMVER_SUN_TRUE}\" && test -z \"${LIBGFOR_USE_SYMVER_SUN_FALSE}\"; then\n+  as_fn_error \"conditional \\\"LIBGFOR_USE_SYMVER_SUN\\\" was never defined.\n+Usually this means the macro was only invoked conditionally.\" \"$LINENO\" 5\n+fi\n \n : ${CONFIG_STATUS=./config.status}\n ac_write_fail=0"}, {"sha": "5f78a8b2d2c5bd1b5172d99ee2728a6c7932aca2", "filename": "libgfortran/configure.ac", "status": "modified", "additions": 17, "deletions": 4, "changes": 21, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8/libgfortran%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fconfigure.ac?ref=49ea7a0ef9fec0eecb2eb9ed60bfdc5630f23ad8", "patch": "@@ -138,17 +138,30 @@ AC_SUBST(CFLAGS)\n \n # Check for symbol versioning (copied from libssp).\n AC_MSG_CHECKING([whether symbol versioning is supported])\n+save_LDFLAGS=\"$LDFLAGS\"\n+LDFLAGS=\"$LDFLAGS -fPIC -shared -Wl,--version-script,./conftest.map\"\n cat > conftest.map <<EOF\n FOO_1.0 {\n   global: *foo*; bar; local: *;\n };\n EOF\n-save_LDFLAGS=\"$LDFLAGS\"\n-LDFLAGS=\"$LDFLAGS -fPIC -shared -Wl,--version-script,./conftest.map\"\n-AC_TRY_LINK([int foo;],[],[gfortran_use_symver=yes],[gfortran_use_symver=no])\n+AC_TRY_LINK([int foo;],[],[gfortran_use_symver=gnu],[gfortran_use_symver=no])\n+if test x$gfortran_use_symver = xno; then\n+  LDFLAGS=\"$save_LDFLAGS\"\n+  LDFLAGS=\"$LDFLAGS -fPIC -shared -Wl,-M,./conftest.map\"\n+  # Sun ld cannot handle wildcards and treats all entries as undefined.\n+  cat > conftest.map <<EOF\n+FOO_1.0 {\n+  global: foo; local: *;\n+};\n+EOF\n+  AC_TRY_LINK([int foo;],[],[gfortran_use_symver=sun],[gfortran_use_symver=no])\n+fi\n LDFLAGS=\"$save_LDFLAGS\"\n AC_MSG_RESULT($gfortran_use_symver)\n-AM_CONDITIONAL(LIBGFOR_USE_SYMVER, [test \"x$gfortran_use_symver\" = xyes])\n+AM_CONDITIONAL(LIBGFOR_USE_SYMVER, [test \"x$gfortran_use_symver\" != xno])\n+AM_CONDITIONAL(LIBGFOR_USE_SYMVER_GNU, [test \"x$gfortran_use_symver\" = xgnu])\n+AM_CONDITIONAL(LIBGFOR_USE_SYMVER_SUN, [test \"x$gfortran_use_symver\" = xsun])\n \n # Figure out whether the compiler supports \"-ffunction-sections -fdata-sections\",\n # similarly to how libstdc++ does it"}]}