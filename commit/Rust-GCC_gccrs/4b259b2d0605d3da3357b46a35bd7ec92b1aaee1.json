{"sha": "4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGIyNTliMmQwNjA1ZDNkYTMzNTdiNDZhMzViZDdlYzkyYjFhYWVlMQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-08-01T13:28:35Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2014-08-01T13:28:35Z"}, "message": "[multiple changes]\n\n2014-08-01  Vincent Celier  <celier@adacore.com>\n\n\t* debug.adb: Minor documentation addition for -dn switch.\n\n2014-08-01  Robert Dewar  <dewar@adacore.com>\n\n\t* sem_aggr.adb, exp_ch9.adb, sem_prag.adb, sem_util.adb,\n\tsem_attr.adb, sem_eval.ads, sem_cat.adb, sem_ch13.adb: Improve\n\tdocumentation of Is_Static_Expression vs Is_OK_Static_Expression.\n\tIn several places, use the Is_OK version as suggested by the spec.\n\n2014-08-01  Vincent Celier  <celier@adacore.com>\n\n\t* gnatcmd.adb: Revert last change which was not correct.\n\n2014-08-01  Hristian Kirtchev  <kirtchev@adacore.com>\n\n\t* freeze.adb (Find_Constant): Ensure that the constant being\n\tinspected is still an object declaration (i.e. not a renaming).\n\nFrom-SVN: r213458", "tree": {"sha": "cdf8ec1f9468fa7640be395895350c0363b5326d", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cdf8ec1f9468fa7640be395895350c0363b5326d"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/comments", "author": null, "committer": null, "parents": [{"sha": "12c5f1efb5d038d8638f517b8d73970573fbdaee", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/12c5f1efb5d038d8638f517b8d73970573fbdaee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/12c5f1efb5d038d8638f517b8d73970573fbdaee"}], "stats": {"total": 63, "additions": 48, "deletions": 15}, "files": [{"sha": "d29f020193565c01ca884a543b91be2d17760972", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -1,3 +1,23 @@\n+2014-08-01  Vincent Celier  <celier@adacore.com>\n+\n+\t* debug.adb: Minor documentation addition for -dn switch.\n+\n+2014-08-01  Robert Dewar  <dewar@adacore.com>\n+\n+\t* sem_aggr.adb, exp_ch9.adb, sem_prag.adb, sem_util.adb,\n+\tsem_attr.adb, sem_eval.ads, sem_cat.adb, sem_ch13.adb: Improve\n+\tdocumentation of Is_Static_Expression vs Is_OK_Static_Expression.\n+\tIn several places, use the Is_OK version as suggested by the spec.\n+\n+2014-08-01  Vincent Celier  <celier@adacore.com>\n+\n+\t* gnatcmd.adb: Revert last change which was not correct.\n+\n+2014-08-01  Hristian Kirtchev  <kirtchev@adacore.com>\n+\n+\t* freeze.adb (Find_Constant): Ensure that the constant being\n+\tinspected is still an object declaration (i.e. not a renaming).\n+\n 2014-08-01  Ed Schonberg  <schonberg@adacore.com>\n \n \t* sem_ch5.adb (Analyze_Loop_Parameter_Specification): a)"}, {"sha": "94da7a6180e4096b2db0039894597ed9d30e6a00", "filename": "gcc/ada/debug.adb", "status": "modified", "additions": 6, "deletions": 4, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fdebug.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fdebug.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fdebug.adb?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -791,15 +791,15 @@ package body Debug is\n \n    --  dm  Issue a message indicating the maximum number of simultaneous\n    --      compilations.\n-   --      Equivalent to --keep-temp-files.\n \n    --  dn  Do not delete temporary files created by gnatmake at the end\n    --      of execution, such as temporary config pragma files, mapping\n-   --      files or project path files.\n+   --      files or project path files. This debug switch is equivalent to\n+   --      the standard switch --keep-temp-files. We retain the debug switch\n+   --      for back compatibility with past usage.\n \n    --  dp  Prints the Q used by routine Make.Compile_Sources every time\n    --      we go around the main compile loop of Make.Compile_Sources\n-   --      Equivalent to --keep-temp-files.\n \n    --  dq  Prints source files as they are enqueued and dequeued in the Q\n    --      used by routine Make.Compile_Sources. Useful to figure out the\n@@ -822,7 +822,9 @@ package body Debug is\n \n    --  dn  Do not delete temporary files created by gprbuild at the end\n    --      of execution, such as temporary config pragma files, mapping\n-   --      files or project path files.\n+   --      files or project path files. This debug switch is equivalent to\n+   --      the standard switch --keep-temp-files. We retain the debug switch\n+   --      for back compatibility with past usage.\n \n    --  dt  When a time stamp mismatch has been found for an ALI file,\n    --      display the source file name, the time stamp expected and"}, {"sha": "e42c187a5c57a39d01e0fa0ec76d0516954b807a", "filename": "gcc/ada/exp_ch9.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fexp_ch9.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fexp_ch9.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch9.adb?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -8929,7 +8929,7 @@ package body Exp_Ch9 is\n \n          function Non_Static_Bound (Bound : Node_Id) return Boolean is\n          begin\n-            if Is_Static_Expression (Bound) then\n+            if Is_OK_Static_Expression (Bound) then\n                return False;\n \n             elsif Is_Entity_Name (Bound)"}, {"sha": "b59e6ec29ea2573f03427b704627d69514a4328c", "filename": "gcc/ada/freeze.adb", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Ffreeze.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Ffreeze.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Ffreeze.adb?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -1256,12 +1256,19 @@ package body Freeze is\n \n       function Find_Constant (Nod : Node_Id) return Traverse_Result is\n       begin\n+         --  When a constant is initialized with the result of a dispatching\n+         --  call, the constant declaration is rewritten as a renaming of the\n+         --  displaced function result. This scenario is not a premature use of\n+         --  a constant even though the Has_Completion flag is not set.\n+\n          if Is_Entity_Name (Nod)\n            and then Present (Entity (Nod))\n            and then Ekind (Entity (Nod)) = E_Constant\n+           and then Scope (Entity (Nod)) = Current_Scope\n+           and then Nkind (Declaration_Node (Entity (Nod))) =\n+                                                         N_Object_Declaration\n            and then not Is_Imported (Entity (Nod))\n            and then not Has_Completion (Entity (Nod))\n-           and then Scope (Entity (Nod)) = Current_Scope\n          then\n             Error_Msg_NE\n               (\"premature use of& in call or instance\", N, Entity (Nod));"}, {"sha": "77cf6dc47ae88f06628ca91192c96efa86ad661e", "filename": "gcc/ada/gnatcmd.adb", "status": "modified", "additions": 4, "deletions": 5, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fgnatcmd.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fgnatcmd.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnatcmd.adb?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -47,6 +47,7 @@ with Snames;   use Snames;\n with Stringt;\n with Switch;   use Switch;\n with Table;\n+with Targparm; use Targparm;\n with Tempdir;\n with Types;    use Types;\n \n@@ -57,9 +58,6 @@ with Ada.Text_IO;             use Ada.Text_IO;\n with GNAT.OS_Lib; use GNAT.OS_Lib;\n \n procedure GNATCmd is\n-\n-   AAMP_On_Target : Boolean := False;\n-\n    Normal_Exit : exception;\n    --  Raise this exception for normal program termination\n \n@@ -1185,7 +1183,7 @@ procedure GNATCmd is\n          --  No usage for Sync\n \n          if C /= Sync then\n-            if AAMP_On_Target then\n+            if Targparm.AAMP_On_Target then\n                Put (\"gnaampcmd \");\n             else\n                Put (\"gnat \");\n@@ -1590,7 +1588,8 @@ begin\n    --  to handle the mapping of GNAAMP tool names. We don't extract it from\n    --  system.ads, as there may be no default runtime.\n \n-   AAMP_On_Target := To_Lower (Command_Name) = \"gnaampcmd\";\n+   Find_Program_Name;\n+   AAMP_On_Target := Name_Buffer (1 .. Name_Len) = \"gnaampcmd\";\n \n    --  Put the command line in environment variable GNAT_DRIVER_COMMAND_LINE,\n    --  so that the spawned tool may know the way the GNAT driver was invoked."}, {"sha": "2c450c572f10cd880f3b068ab4dae015db9eb5cb", "filename": "gcc/ada/sem_aggr.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_aggr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_aggr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_aggr.adb?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -1732,7 +1732,7 @@ package body Sem_Aggr is\n                              (\"subtype& has dynamic predicate, not allowed \"\n                               & \"in aggregate choice\", Choice, E);\n \n-                        elsif not Is_Static_Subtype (E) then\n+                        elsif not Is_OK_Static_Subtype (E) then\n                            Error_Msg_NE\n                              (\"non-static subtype& has predicate, not allowed \"\n                               & \"in aggregate choice\", Choice, E);"}, {"sha": "72d0c995bd66a55007472b391975f946a339d9b3", "filename": "gcc/ada/sem_eval.ads", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_eval.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_eval.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_eval.ads?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -52,7 +52,12 @@ package Sem_Eval is\n    --    Is_Static_Expression\n \n    --      This flag is set on any expression that is static according to the\n-   --      rules in (RM 4.9(3-32)).\n+   --      rules in (RM 4.9(3-32)). This flag should be tested during testing\n+   --      of legality of parts of a larger static expression. For all other\n+   --      contexts that require static expressions, use the separate predicate\n+   --      Is_OK_Static_Expression, since an expression that meets the RM 4.9\n+   --      requirements, but raises a constraint error when evaluated in a non-\n+   --      static context does not meet the legality requirements.\n \n    --    Raises_Constraint_Error\n "}, {"sha": "da089301e419ab4c31163b3eaa6fcbd2e71fb7d2", "filename": "gcc/ada/sem_prag.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_prag.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_prag.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_prag.adb?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -17757,7 +17757,7 @@ package body Sem_Prag is\n \n                Preanalyze_Spec_Expression (Arg, RTE (RE_Any_Priority));\n \n-               if not Is_Static_Expression (Arg) then\n+               if not Is_OK_Static_Expression (Arg) then\n                   Check_Restriction (Static_Priorities, Arg);\n                end if;\n "}, {"sha": "66967bee36192ca9b5724c70fe44be8d171aa1a9", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4b259b2d0605d3da3357b46a35bd7ec92b1aaee1/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=4b259b2d0605d3da3357b46a35bd7ec92b1aaee1", "patch": "@@ -814,7 +814,7 @@ package body Sem_Util is\n \n             if Nkind (Parent (N)) = N_Loop_Parameter_Specification\n               and then not Has_Dynamic_Predicate_Aspect (Typ)\n-              and then Is_Static_Subtype (Typ)\n+              and then Is_OK_Static_Subtype (Typ)\n             then\n                return;\n             end if;"}]}