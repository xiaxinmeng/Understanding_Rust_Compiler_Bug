{"sha": "5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NWM1ZWI3ZTQ4NzIwMjVlOGQ1ZThhZTJmMGU1Njg0MDNmN2M4ODAzZA==", "commit": {"author": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-12-15T08:57:19Z"}, "committer": {"name": "Martin Liska", "email": "mliska@suse.cz", "date": "2020-12-16T09:20:45Z"}, "message": "options: fix integer overflow\n\ngcc/ChangeLog:\n\n\tPR rtl-optimization/98271\n\tPR rtl-optimization/98276\n\tPR tree-optimization/98279\n\t* opts-common.c (set_option): Do not allow overflow for integer\n\targuments.\n\ngcc/testsuite/ChangeLog:\n\n\tPR rtl-optimization/98271\n\tPR rtl-optimization/98276\n\tPR tree-optimization/98279\n\t* gcc.dg/pr98271.c: New test.", "tree": {"sha": "100fe6eea939511c8f90398108f9ccdbeedb0e69", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/100fe6eea939511c8f90398108f9ccdbeedb0e69"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d/comments", "author": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "committer": {"login": "marxin", "id": 2658545, "node_id": "MDQ6VXNlcjI2NTg1NDU=", "avatar_url": "https://avatars.githubusercontent.com/u/2658545?v=4", "gravatar_id": "", "url": "https://api.github.com/users/marxin", "html_url": "https://github.com/marxin", "followers_url": "https://api.github.com/users/marxin/followers", "following_url": "https://api.github.com/users/marxin/following{/other_user}", "gists_url": "https://api.github.com/users/marxin/gists{/gist_id}", "starred_url": "https://api.github.com/users/marxin/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/marxin/subscriptions", "organizations_url": "https://api.github.com/users/marxin/orgs", "repos_url": "https://api.github.com/users/marxin/repos", "events_url": "https://api.github.com/users/marxin/events{/privacy}", "received_events_url": "https://api.github.com/users/marxin/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "61e3c180ad6913fa5af39059de5ba7b3bde50cda", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/61e3c180ad6913fa5af39059de5ba7b3bde50cda", "html_url": "https://github.com/Rust-GCC/gccrs/commit/61e3c180ad6913fa5af39059de5ba7b3bde50cda"}], "stats": {"total": 25, "additions": 22, "deletions": 3}, "files": [{"sha": "30be7d5bf470c98ea4bd2fab6de95f323d2b7f30", "filename": "gcc/opts-common.c", "status": "modified", "additions": 9, "deletions": 3, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d/gcc%2Fopts-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d/gcc%2Fopts-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fopts-common.c?ref=5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d", "patch": "@@ -1466,9 +1466,15 @@ set_option (struct gcc_options *opts, struct gcc_options *opts_set,\n \t  }\n \telse\n \t  {\n-\t    *(int *) flag_var = value;\n-\t    if (set_flag_var)\n-\t      *(int *) set_flag_var = 1;\n+\t    if (value > INT_MAX)\n+\t      error_at (loc, \"argument to %qs is bigger than %d\",\n+\t\t\toption->opt_text, INT_MAX);\n+\t    else\n+\t      {\n+\t\t*(int *) flag_var = value;\n+\t\tif (set_flag_var)\n+\t\t  *(int *) set_flag_var = 1;\n+\t      }\n \t  }\n \n \tbreak;"}, {"sha": "b453434612e3352f61605c1ee4bd1b48242d3e4a", "filename": "gcc/testsuite/gcc.dg/pr98271.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d/gcc%2Ftestsuite%2Fgcc.dg%2Fpr98271.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d/gcc%2Ftestsuite%2Fgcc.dg%2Fpr98271.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr98271.c?ref=5c5eb7e4872025e8d5e8ae2f0e568403f7c8803d", "patch": "@@ -0,0 +1,13 @@\n+/* PR rtl-optimization/98271 */\n+/* PR rtl-optimization/98276 */\n+/* PR tree-optimization/98279 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O --param=align-loop-iterations=1197120096074465280 --param=gcse-cost-distance-ratio=2147483648 --param=hot-bb-frequency-fraction=2147483648\" } */\n+/* { dg-error \"argument to .--param=align-loop-iterations=. is bigger than 2147483647\" \"\" { target *-*-* } 0 } */\n+/* { dg-error \"argument to .--param=gcse-cost-distance-ratio=. is bigger than 2147483647\" \"\" { target *-*-* } 0 } */\n+/* { dg-error \"argument to .--param=hot-bb-frequency-fraction=. is bigger than 2147483647\" \"\" { target *-*-* } 0 } */\n+\n+void\n+foo (void)\n+{\n+}"}]}