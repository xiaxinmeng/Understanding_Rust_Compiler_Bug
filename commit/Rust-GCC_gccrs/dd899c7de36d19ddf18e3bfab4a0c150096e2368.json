{"sha": "dd899c7de36d19ddf18e3bfab4a0c150096e2368", "node_id": "C_kwDOANBUbNoAKGRkODk5YzdkZTM2ZDE5ZGRmMThlM2JmYWI0YTBjMTUwMDk2ZTIzNjg", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2022-08-20T19:20:04Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2022-08-20T19:20:04Z"}, "message": "fortran: Drop -static-lib{gfortran,quadmath} from f951 [PR46539]\n\nAs discussed earlier, all other -static-lib* options are Driver only,\nthese 2 are Driver in common.opt and Fortran in lang.opt.\n\nThe spec files never pass the -static-lib* options down to any compiler\n(f951 etc.), so the 2 errors below are reported only when one\nruns ./f951 -static-libgfortran by hand.\n\nThe following patch just removes f951 support of these options, the\ngfortran driver behavior remains as before.  For other -static-lib*\noption (and even these because it is never passed to f951) we never\nerror if we can't support those options, and e.g. Darwin is actually\nable to handle those options through other means.\n\n2022-08-20  Jakub Jelinek  <jakub@redhat.com>\n\n\tPR fortran/46539\n\t* lang.opt (static-libgfortran, static-libquadmath): Change Fortran\n\tto Driver.\n\t* options.cc (gfc_handle_option): Don't handle OPT_static_libgfortran\n\tnor OPT_static_libquadmath here.", "tree": {"sha": "acffc6d2ef57831cbb91147d1c3064cb2cd11bdf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/acffc6d2ef57831cbb91147d1c3064cb2cd11bdf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd899c7de36d19ddf18e3bfab4a0c150096e2368", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd899c7de36d19ddf18e3bfab4a0c150096e2368", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd899c7de36d19ddf18e3bfab4a0c150096e2368", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd899c7de36d19ddf18e3bfab4a0c150096e2368/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "69458145262e4cef76410f5d42fe0d12b7c395fb", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/69458145262e4cef76410f5d42fe0d12b7c395fb", "html_url": "https://github.com/Rust-GCC/gccrs/commit/69458145262e4cef76410f5d42fe0d12b7c395fb"}], "stats": {"total": 18, "additions": 2, "deletions": 16}, "files": [{"sha": "b18a6d3f4f97dcc3da889f85be78378e0045517a", "filename": "gcc/fortran/lang.opt", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd899c7de36d19ddf18e3bfab4a0c150096e2368/gcc%2Ffortran%2Flang.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd899c7de36d19ddf18e3bfab4a0c150096e2368/gcc%2Ffortran%2Flang.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Flang.opt?ref=dd899c7de36d19ddf18e3bfab4a0c150096e2368", "patch": "@@ -860,11 +860,11 @@ Fortran Joined Separate\n ; Documented in common.opt\n \n static-libgfortran\n-Fortran\n+Driver\n Statically link the GNU Fortran helper library (libgfortran).\n \n static-libquadmath\n-Fortran\n+Driver\n Statically link the GCC Quad-Precision Math Library (libquadmath).\n \n std=f2003"}, {"sha": "08afb781d34b90c92fc4bae98cea27be111f82d5", "filename": "gcc/fortran/options.cc", "status": "modified", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd899c7de36d19ddf18e3bfab4a0c150096e2368/gcc%2Ffortran%2Foptions.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd899c7de36d19ddf18e3bfab4a0c150096e2368/gcc%2Ffortran%2Foptions.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Foptions.cc?ref=dd899c7de36d19ddf18e3bfab4a0c150096e2368", "patch": "@@ -685,20 +685,6 @@ gfc_handle_option (size_t scode, const char *arg, HOST_WIDE_INT value,\n       gfc_option.source_form = FORM_FREE;\n       break;\n \n-    case OPT_static_libgfortran:\n-#ifndef HAVE_LD_STATIC_DYNAMIC\n-      gfc_fatal_error (\"%<-static-libgfortran%> is not supported in this \"\n-\t\t       \"configuration\");\n-#endif\n-      break;\n-\n-    case OPT_static_libquadmath:\n-#ifndef HAVE_LD_STATIC_DYNAMIC\n-      gfc_fatal_error (\"%<-static-libquadmath%> is not supported in this \"\n-\t\t       \"configuration\");\n-#endif\n-      break;\n-\n     case OPT_fintrinsic_modules_path:\n     case OPT_fintrinsic_modules_path_:\n "}]}