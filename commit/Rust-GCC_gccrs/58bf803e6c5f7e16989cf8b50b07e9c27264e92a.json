{"sha": "58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NThiZjgwM2U2YzVmN2UxNjk4OWNmOGI1MGIwN2U5YzI3MjY0ZTkyYQ==", "commit": {"author": {"name": "Andrew Haley", "email": "aph@redhat.com", "date": "2005-04-06T22:30:01Z"}, "committer": {"name": "Tom Tromey", "email": "tromey@gcc.gnu.org", "date": "2005-04-06T22:30:01Z"}, "message": "bytearray.java: New file.\n\n2005-04-06  Andrew Haley  <aph@redhat.com>\n\n\t* testsuite/libjava.lang/bytearray.java: New file.\n\t* testsuite/libjava.lang/bytearray.out: New file.\n\t* java/lang/ClassLoader.java (loadClassFromSig): Declare\n\t(loadClass): Use it.\n\t* java/lang/natClassLoader.cc (loadClassFromSig): New method.\n\nFrom-SVN: r97756", "tree": {"sha": "28d3dbccadbb283006a3f5170554d3ca021fd926", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/28d3dbccadbb283006a3f5170554d3ca021fd926"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/comments", "author": {"login": "theRealAph", "id": 254637, "node_id": "MDQ6VXNlcjI1NDYzNw==", "avatar_url": "https://avatars.githubusercontent.com/u/254637?v=4", "gravatar_id": "", "url": "https://api.github.com/users/theRealAph", "html_url": "https://github.com/theRealAph", "followers_url": "https://api.github.com/users/theRealAph/followers", "following_url": "https://api.github.com/users/theRealAph/following{/other_user}", "gists_url": "https://api.github.com/users/theRealAph/gists{/gist_id}", "starred_url": "https://api.github.com/users/theRealAph/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/theRealAph/subscriptions", "organizations_url": "https://api.github.com/users/theRealAph/orgs", "repos_url": "https://api.github.com/users/theRealAph/repos", "events_url": "https://api.github.com/users/theRealAph/events{/privacy}", "received_events_url": "https://api.github.com/users/theRealAph/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3425638af52c359b893547b9dcde5cccd1bb67ac", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3425638af52c359b893547b9dcde5cccd1bb67ac", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3425638af52c359b893547b9dcde5cccd1bb67ac"}], "stats": {"total": 73, "additions": 57, "deletions": 16}, "files": [{"sha": "298bfeca76ae154e67d1920061e190c0ba9e191f", "filename": "libjava/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2FChangeLog?ref=58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "patch": "@@ -1,3 +1,11 @@\n+2005-04-06  Andrew Haley  <aph@redhat.com>\n+\n+\t* testsuite/libjava.lang/bytearray.java: New file.\n+\t* testsuite/libjava.lang/bytearray.out: New file.\n+\t* java/lang/ClassLoader.java (loadClassFromSig): Declare\n+\t(loadClass): Use it.\n+\t* java/lang/natClassLoader.cc (loadClassFromSig): New method.\n+\n 2005-04-06  Mohan Embar  <gnustuff@thisiscool.com>\n \n \t* Makefile.am ($(db_name)): Add $(EXEEXT) suffix to"}, {"sha": "5737ddad53ae31a4c389ad7eb4cb21a4ba5f503e", "filename": "libjava/java/lang/ClassLoader.java", "status": "modified", "additions": 26, "deletions": 16, "changes": 42, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Fjava%2Flang%2FClassLoader.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Fjava%2Flang%2FClassLoader.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FClassLoader.java?ref=58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "patch": "@@ -260,6 +260,9 @@ public Class loadClass(String name) throws ClassNotFoundException\n     return loadClass(name, false);\n   }\n \n+  private native Class loadClassFromSig(String name)\n+    throws ClassNotFoundException;\n+\n   /**\n    * Load a class using this ClassLoader or its parent, possibly resolving\n    * it as well using <code>resolveClass()</code>. It first tries to find\n@@ -283,29 +286,36 @@ public Class loadClass(String name) throws ClassNotFoundException\n   protected synchronized Class loadClass(String name, boolean resolve)\n     throws ClassNotFoundException\n   {\n-    // Have we already loaded this class?\n-    Class c = findLoadedClass(name);\n-    if (c == null)\n+    // Arrays are handled specially.\n+    Class c;\n+    if (name.charAt(0) == '[')\n+      c = loadClassFromSig(name);\n+    else\n       {\n-\t// Can the class be loaded by a parent?\n-\ttry\n+\t// Have we already loaded this class?\n+\tc = findLoadedClass(name);\n+\tif (c == null)\n \t  {\n-\t    if (parent == null)\n+\t    // Can the class be loaded by a parent?\n+\t    try\n \t      {\n-\t\tc = VMClassLoader.loadClass(name, resolve);\n-\t\tif (c != null)\n-\t\t  return c;\n+\t\tif (parent == null)\n+\t\t  {\n+\t\t    c = VMClassLoader.loadClass(name, resolve);\n+\t\t    if (c != null)\n+\t\t      return c;\n+\t\t  }\n+\t\telse\n+\t\t  {\n+\t\t    return parent.loadClass(name, resolve);\n+\t\t  }\n \t      }\n-\t    else\n+\t    catch (ClassNotFoundException e)\n \t      {\n-\t\treturn parent.loadClass(name, resolve);\n \t      }\n+\t    // Still not found, we have to do it ourself.\n+\t    c = findClass(name);\n \t  }\n-\tcatch (ClassNotFoundException e)\n-\t  {\n-\t  }\n-\t// Still not found, we have to do it ourself.\n-\tc = findClass(name);\n       }\n     if (resolve)\n       resolveClass(c);"}, {"sha": "ed43b7aeb8b06ab2901def36cd3543e193b1d3af", "filename": "libjava/java/lang/natClassLoader.cc", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Fjava%2Flang%2FnatClassLoader.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Fjava%2Flang%2FnatClassLoader.cc?ref=58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "patch": "@@ -63,6 +63,17 @@ static jclass bootstrap_class_list[BOOTSTRAP_CLASS_LIST_SIZE];\n static int bootstrap_index;\n \n \n+\f\n+\n+jclass\n+java::lang::ClassLoader::loadClassFromSig(jstring name)\n+{\n+  int len = _Jv_GetStringUTFLength (name);\n+  char sig[len + 1];\n+  _Jv_GetStringUTFRegion (name, 0, name->length(), sig);\n+  return _Jv_FindClassFromSignature(sig, this);\n+}\n+\n \f\n \n // This tries to find a class in our built-in cache.  This cache is"}, {"sha": "88fdc9af014ab4569fe3c9e6e2be9373ec55d21e", "filename": "libjava/testsuite/libjava.lang/bytearray.java", "status": "added", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Ftestsuite%2Flibjava.lang%2Fbytearray.java", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Ftestsuite%2Flibjava.lang%2Fbytearray.java", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.lang%2Fbytearray.java?ref=58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "patch": "@@ -0,0 +1,10 @@\n+public class bytearray\n+{\n+  public static void main (String[] argv) throws Throwable {\n+    Class c = Class.forName (\"[Ljava.lang.String;\");\n+    c = Class.forName (\"[B\");\n+    System.out.println (c);\n+    c = ClassLoader.getSystemClassLoader().loadClass (\"[[Ljava.lang.String;\");\n+    System.out.println (c);\n+  }\n+}"}, {"sha": "520d568e9b082aff85938d3c7b0c851386a5b15e", "filename": "libjava/testsuite/libjava.lang/bytearray.out", "status": "added", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Ftestsuite%2Flibjava.lang%2Fbytearray.out", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/58bf803e6c5f7e16989cf8b50b07e9c27264e92a/libjava%2Ftestsuite%2Flibjava.lang%2Fbytearray.out", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libjava%2Ftestsuite%2Flibjava.lang%2Fbytearray.out?ref=58bf803e6c5f7e16989cf8b50b07e9c27264e92a", "patch": "@@ -0,0 +1,2 @@\n+class [B\n+class [[Ljava.lang.String;"}]}