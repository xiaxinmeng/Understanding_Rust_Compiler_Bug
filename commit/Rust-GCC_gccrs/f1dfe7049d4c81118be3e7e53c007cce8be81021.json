{"sha": "f1dfe7049d4c81118be3e7e53c007cce8be81021", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjFkZmU3MDQ5ZDRjODExMThiZTNlN2U1M2MwMDdjY2U4YmU4MTAyMQ==", "commit": {"author": {"name": "Bob Wilson", "email": "bob.wilson@acm.org", "date": "2004-04-27T22:47:56Z"}, "committer": {"name": "Bob Wilson", "email": "bwilson@gcc.gnu.org", "date": "2004-04-27T22:47:56Z"}, "message": "xtensa.c (call_insn_operand): Check SYMBOL_REF_EXTERNAL_P in addition to SYMBOL_REF_LOCAL_P.\n\n\t* config/xtensa/xtensa.c (call_insn_operand): Check\n\tSYMBOL_REF_EXTERNAL_P in addition to SYMBOL_REF_LOCAL_P.\n\t* config/xtensa/xtensa.h (LEGITIMATE_PIC_OPERAND): Likewise.\n\t* config/xtensa/xtensa.md (call, call_value): Likewise.\n\nFrom-SVN: r81228", "tree": {"sha": "2d5f39671b0e3bd55cda95a52cefd60f46068e50", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2d5f39671b0e3bd55cda95a52cefd60f46068e50"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f1dfe7049d4c81118be3e7e53c007cce8be81021", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1dfe7049d4c81118be3e7e53c007cce8be81021", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f1dfe7049d4c81118be3e7e53c007cce8be81021", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f1dfe7049d4c81118be3e7e53c007cce8be81021/comments", "author": null, "committer": null, "parents": [{"sha": "80408cac1637c8452c3b9f3a227d701b9d40641f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/80408cac1637c8452c3b9f3a227d701b9d40641f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/80408cac1637c8452c3b9f3a227d701b9d40641f"}], "stats": {"total": 19, "additions": 15, "deletions": 4}, "files": [{"sha": "b72cf396a23b66eb0215a02e3563cabe9dbdae14", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=f1dfe7049d4c81118be3e7e53c007cce8be81021", "patch": "@@ -1,3 +1,10 @@\n+2004-04-27  Bob Wilson  <bob.wilson@acm.org>\n+\n+\t* config/xtensa/xtensa.c (call_insn_operand): Check\n+\tSYMBOL_REF_EXTERNAL_P in addition to SYMBOL_REF_LOCAL_P.\n+\t* config/xtensa/xtensa.h (LEGITIMATE_PIC_OPERAND): Likewise.\n+\t* config/xtensa/xtensa.md (call, call_value): Likewise.\n+\n 2004-04-27  Wu Yongwei  <adah@sh163.net>\n \n \t* gthr-win32.h (__gthread_mutex_t): Change typedef to new structure."}, {"sha": "d11036813454e0dbab14dd9e278519b4ed7aa572", "filename": "gcc/config/xtensa/xtensa.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.c?ref=f1dfe7049d4c81118be3e7e53c007cce8be81021", "patch": "@@ -572,7 +572,8 @@ call_insn_operand (rtx op, enum machine_mode mode ATTRIBUTE_UNUSED)\n \t{\n \t  tree callee, callee_sec, caller_sec;\n \n-\t  if (GET_CODE (op) != SYMBOL_REF || !SYMBOL_REF_LOCAL_P (op))\n+\t  if (GET_CODE (op) != SYMBOL_REF\n+\t      || !SYMBOL_REF_LOCAL_P (op) || SYMBOL_REF_EXTERNAL_P (op))\n \t    return FALSE;\n \n \t  /* Don't attempt a direct call if the callee is known to be in"}, {"sha": "d04560b8c7c23eac7fb1bc3b1ca4609d8f1f27c7", "filename": "gcc/config/xtensa/xtensa.h", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2Fconfig%2Fxtensa%2Fxtensa.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2Fconfig%2Fxtensa%2Fxtensa.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.h?ref=f1dfe7049d4c81118be3e7e53c007cce8be81021", "patch": "@@ -1060,7 +1060,8 @@ typedef struct xtensa_args\n    operand on the target machine when generating position independent\n    code.  */\n #define LEGITIMATE_PIC_OPERAND_P(X)\t\t\t\t\t\\\n-  ((GET_CODE (X) != SYMBOL_REF || SYMBOL_REF_LOCAL_P (X))\t\t\\\n+  ((GET_CODE (X) != SYMBOL_REF\t\t\t\t\t\t\\\n+    || (SYMBOL_REF_LOCAL_P (X) && !SYMBOL_REF_EXTERNAL_P (X)))\t\t\\\n    && GET_CODE (X) != LABEL_REF\t\t\t\t\t\t\\\n    && GET_CODE (X) != CONST)\n "}, {"sha": "0b557c12e8c312058e2d427d6cd694436059e876", "filename": "gcc/config/xtensa/xtensa.md", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f1dfe7049d4c81118be3e7e53c007cce8be81021/gcc%2Fconfig%2Fxtensa%2Fxtensa.md", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.md?ref=f1dfe7049d4c81118be3e7e53c007cce8be81021", "patch": "@@ -1999,7 +1999,8 @@\n   \"\"\n {\n   rtx addr = XEXP (operands[0], 0);\n-  if (flag_pic && GET_CODE (addr) == SYMBOL_REF && !SYMBOL_REF_LOCAL_P (addr))\n+  if (flag_pic && GET_CODE (addr) == SYMBOL_REF\n+      && (!SYMBOL_REF_LOCAL_P (addr) || SYMBOL_REF_EXTERNAL_P (addr)))\n     addr = gen_sym_PLT (addr);\n   if (!call_insn_operand (addr, VOIDmode))\n     XEXP (operands[0], 0) = copy_to_mode_reg (Pmode, addr);\n@@ -2023,7 +2024,8 @@\n   \"\"\n {\n   rtx addr = XEXP (operands[1], 0);\n-  if (flag_pic && GET_CODE (addr) == SYMBOL_REF && !SYMBOL_REF_LOCAL_P (addr))\n+  if (flag_pic && GET_CODE (addr) == SYMBOL_REF\n+      && (!SYMBOL_REF_LOCAL_P (addr) || SYMBOL_REF_EXTERNAL_P (addr)))\n     addr = gen_sym_PLT (addr);\n   if (!call_insn_operand (addr, VOIDmode))\n     XEXP (operands[1], 0) = copy_to_mode_reg (Pmode, addr);"}]}