{"sha": "9a35ada53504bbf2a522c20303ccf606dd730307", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWEzNWFkYTUzNTA0YmJmMmE1MjJjMjAzMDNjY2Y2MDZkZDczMDMwNw==", "commit": {"author": {"name": "Mike Stump", "email": "mrs@apple.com", "date": "2006-12-08T23:54:21Z"}, "committer": {"name": "Mike Stump", "email": "mrs@gcc.gnu.org", "date": "2006-12-08T23:54:21Z"}, "message": "configure.ac: Fix x86 darwin builds.\n\n\t* configure.ac: Fix x86 darwin builds.\n\t* darwin_stop_world.c: Likewise.\n\t* include/private/gcconfig.h: Likewise.\n\t* connfigure: Regenerate.\n\nFrom-SVN: r119670", "tree": {"sha": "1c1c8ea15b95c3c6affc6b3856a93c448d654f4f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1c1c8ea15b95c3c6affc6b3856a93c448d654f4f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9a35ada53504bbf2a522c20303ccf606dd730307", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a35ada53504bbf2a522c20303ccf606dd730307", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9a35ada53504bbf2a522c20303ccf606dd730307", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9a35ada53504bbf2a522c20303ccf606dd730307/comments", "author": null, "committer": null, "parents": [{"sha": "920aeaf3da2eed578c4f2b73551a44a62b8329a3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/920aeaf3da2eed578c4f2b73551a44a62b8329a3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/920aeaf3da2eed578c4f2b73551a44a62b8329a3"}], "stats": {"total": 51, "additions": 37, "deletions": 14}, "files": [{"sha": "2739c38c58f0d468a61165e6a11d2efbd644d503", "filename": "boehm-gc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2FChangeLog?ref=9a35ada53504bbf2a522c20303ccf606dd730307", "patch": "@@ -1,3 +1,10 @@\n+2006-12-08  Mike Stump  <mrs@apple.com>\n+\n+\t* configure.ac: Fix x86 darwin builds.\n+\t* darwin_stop_world.c: Likewise.\n+\t* include/private/gcconfig.h: Likewise.\n+\t* connfigure: Regenerate.\n+\t\n 2006-09-26  Jack Howarth  <howarth@bromo.med.uc.edu>\n \n \tPR target/29180"}, {"sha": "f509b349937a596b639472142971dd6f5262fcec", "filename": "boehm-gc/configure", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Fconfigure", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Fconfigure", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fconfigure?ref=9a35ada53504bbf2a522c20303ccf606dd730307", "patch": "@@ -5465,7 +5465,8 @@ _ACEOF\n #define THREAD_LOCAL_ALLOC 1\n _ACEOF\n \n-       cat >>confdefs.h <<\\_ACEOF\n+\n+cat >>confdefs.h <<\\_ACEOF\n #define USE_COMPILER_TLS 1\n _ACEOF\n \n@@ -6084,6 +6085,7 @@ _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n+#include <sys/cdefs.h>\n #include <mach/thread_status.h>\n \n int\n@@ -6129,6 +6131,7 @@ _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n+#include <sys/cdefs.h>\n #include <mach/thread_status.h>\n \n int\n@@ -6195,6 +6198,7 @@ _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n+#include <sys/cdefs.h>\n #include <mach/thread_status.h>\n \n int\n@@ -6240,6 +6244,7 @@ _ACEOF\n cat confdefs.h >>conftest.$ac_ext\n cat >>conftest.$ac_ext <<_ACEOF\n /* end confdefs.h.  */\n+#include <sys/cdefs.h>\n #include <mach/thread_status.h>\n \n int"}, {"sha": "84dd7ec8d669456d9e7e289d1929a51024613165", "filename": "boehm-gc/configure.ac", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Fconfigure.ac", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Fconfigure.ac", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fconfigure.ac?ref=9a35ada53504bbf2a522c20303ccf606dd730307", "patch": "@@ -267,11 +267,13 @@ case \"$host\" in\n     AC_CHECK_MEMBER(i386_thread_state_t.eax,\n       AC_DEFINE(HAS_I386_THREAD_STATE_EAX,,dnl\n         [i386_thread_state_t has field eax]),,\n-      [#include <mach/thread_status.h>])\n+      [#include <sys/cdefs.h>\n+#include <mach/thread_status.h>])\n     AC_CHECK_MEMBER(i386_thread_state_t.__eax,\n       AC_DEFINE(HAS_I386_THREAD_STATE___EAX,,dnl\n         [i386_thread_state_t has field __eax]),,\n-      [#include <mach/thread_status.h>])\n+      [#include <sys/cdefs.h>\n+#include <mach/thread_status.h>])\n     ;;\n   *) ;;\n esac"}, {"sha": "bdd6f3a0730cbfaa1f39880239bf4ab927838b06", "filename": "boehm-gc/darwin_stop_world.c", "status": "modified", "additions": 18, "deletions": 9, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Fdarwin_stop_world.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Fdarwin_stop_world.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Fdarwin_stop_world.c?ref=9a35ada53504bbf2a522c20303ccf606dd730307", "patch": "@@ -49,6 +49,15 @@\n # else\n #  error can not work out how to access fields of i386_thread_state_t\n # endif\n+#elif defined(__x86_64__)\n+# define THREAD_STATE i386_thread_state_t\n+# if defined (HAS_I386_THREAD_STATE_EAX)\n+#  define THREAD_FLD(x) x\n+# elif defined (HAS_I386_THREAD_STATE___EAX)\n+#  define THREAD_FLD(x) __ ## x\n+# else\n+#  error can not work out how to access fields of i386_thread_state_t\n+# endif\n #else\n # error unknown architecture\n #endif\n@@ -127,15 +136,15 @@ void GC_push_all_stacks() {\n \tif(r != KERN_SUCCESS) ABORT(\"thread_get_state failed\");\n \n #if defined(I386)\n-\tlo = state.esp;\n-\n-\tGC_push_one(state.eax); \n-\tGC_push_one(state.ebx); \n-\tGC_push_one(state.ecx); \n-\tGC_push_one(state.edx); \n-\tGC_push_one(state.edi); \n-\tGC_push_one(state.esi); \n-\tGC_push_one(state.ebp); \n+\tlo = (void*)state . THREAD_FLD (esp);\n+\n+\tGC_push_one(state . THREAD_FLD (eax)); \n+\tGC_push_one(state . THREAD_FLD (ebx)); \n+\tGC_push_one(state . THREAD_FLD (ecx)); \n+\tGC_push_one(state . THREAD_FLD (edx)); \n+\tGC_push_one(state . THREAD_FLD (edi)); \n+\tGC_push_one(state . THREAD_FLD (esi)); \n+\tGC_push_one(state . THREAD_FLD (ebp)); \n #elif defined(POWERPC)\n \tlo = (void*)(state . THREAD_FLD (r1) - PPC_RED_ZONE_SIZE);\n         "}, {"sha": "e06a7565609a2e96046338f47a2059a846c05d24", "filename": "boehm-gc/include/private/gcconfig.h", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Finclude%2Fprivate%2Fgcconfig.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9a35ada53504bbf2a522c20303ccf606dd730307/boehm-gc%2Finclude%2Fprivate%2Fgcconfig.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/boehm-gc%2Finclude%2Fprivate%2Fgcconfig.h?ref=9a35ada53504bbf2a522c20303ccf606dd730307", "patch": "@@ -302,7 +302,7 @@\n #   if defined(__ppc__)  || defined(__ppc64__)\n #    define POWERPC\n #    define mach_type_known\n-#   elif defined(__i386__)\n+#   elif defined(__i386__) || defined(__x86_64)\n #    define I386\n #    define mach_type_known\n #   endif\n@@ -787,7 +787,7 @@\n #     define DATAEND (_end)\n #   endif\n #   ifdef DARWIN\n-#     ifdef __ppc64__\n+#     if defined(__ppc64__) || defined(__x86_64)\n #       define ALIGNMENT 8\n #       define CPP_WORDSZ 64\n #     else"}]}