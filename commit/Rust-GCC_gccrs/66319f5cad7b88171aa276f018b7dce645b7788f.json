{"sha": "66319f5cad7b88171aa276f018b7dce645b7788f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjYzMTlmNWNhZDdiODgxNzFhYTI3NmYwMThiN2RjZTY0NWI3Nzg4Zg==", "commit": {"author": {"name": "Richard Sandiford", "email": "rsandifo@redhat.com", "date": "2002-05-03T17:08:29Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2002-05-03T17:08:29Z"}, "message": "elf64.h (UNIQUE_SECTION): Use mips_unique_section.\n\n\t* config/mips/elf64.h (UNIQUE_SECTION): Use mips_unique_section.\n\t* config/mips/mips.c (mips_unique_section): Strip encoding from\n\tdecl name.\n\nFrom-SVN: r53101", "tree": {"sha": "ee8d7e5dd35946657991a1cd0b967d400002c762", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ee8d7e5dd35946657991a1cd0b967d400002c762"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/66319f5cad7b88171aa276f018b7dce645b7788f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66319f5cad7b88171aa276f018b7dce645b7788f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/66319f5cad7b88171aa276f018b7dce645b7788f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/66319f5cad7b88171aa276f018b7dce645b7788f/comments", "author": null, "committer": null, "parents": [{"sha": "7bebf27930fe5d0b4c147575b213fe18cd892306", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7bebf27930fe5d0b4c147575b213fe18cd892306", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7bebf27930fe5d0b4c147575b213fe18cd892306"}], "stats": {"total": 74, "additions": 9, "deletions": 65}, "files": [{"sha": "71e4466b0a67738b3f76c691d7e2b2d29061b7aa", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66319f5cad7b88171aa276f018b7dce645b7788f/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66319f5cad7b88171aa276f018b7dce645b7788f/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=66319f5cad7b88171aa276f018b7dce645b7788f", "patch": "@@ -1,3 +1,9 @@\n+2002-05-03  Richard Sandiford  <rsandifo@redhat.com>\n+\n+\t* config/mips/elf64.h (UNIQUE_SECTION): Use mips_unique_section.\n+\t* config/mips/mips.c (mips_unique_section): Strip encoding from\n+\tdecl name.\n+\n 2002-05-03  Jakub Jelinek  <jakub@redhat.com>\n \n \t* config/i386/i386.c (ix86_expand_int_movcc): Truncate to proper"}, {"sha": "1015573b0618b489215ba01995b93e639de8a9ec", "filename": "gcc/config/mips/elf64.h", "status": "modified", "additions": 2, "deletions": 65, "changes": 67, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66319f5cad7b88171aa276f018b7dce645b7788f/gcc%2Fconfig%2Fmips%2Felf64.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66319f5cad7b88171aa276f018b7dce645b7788f/gcc%2Fconfig%2Fmips%2Felf64.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Felf64.h?ref=66319f5cad7b88171aa276f018b7dce645b7788f", "patch": "@@ -209,71 +209,8 @@ do {\t\t\t\t\t\t\t\t\t \\\n \n #define MAKE_DECL_ONE_ONLY(DECL) (DECL_WEAK (DECL) = 1)\n #undef UNIQUE_SECTION\n-#define UNIQUE_SECTION(DECL,RELOC)\t\t\t\t\t   \\\n-do {\t\t\t\t\t\t\t\t\t   \\\n-  int len, size, sec;\t\t\t\t\t\t\t   \\\n-  const char *name, *prefix;\t\t\t\t\t\t   \\\n-  char *string;\t\t\t\t\t\t\t\t   \\\n-  static const char *const prefixes[4][2] = {\t\t\t\t   \\\n-    { \".text.\", \".gnu.linkonce.t.\" },\t\t\t\t\t   \\\n-    { \".rodata.\", \".gnu.linkonce.r.\" },\t\t\t\t\t   \\\n-    { \".data.\", \".gnu.linkonce.d.\" },\t\t\t\t\t   \\\n-    { \".sdata.\", \".gnu.linkonce.s.\" }\t\t\t\t\t   \\\n-  };\t\t\t\t\t\t\t\t\t   \\\n-\t\t\t\t\t\t\t\t\t   \\\n-  name = IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (DECL));\t\t   \\\n-  size = int_size_in_bytes (TREE_TYPE (decl));\t\t\t\t   \\\n-\t\t\t\t\t\t\t\t\t   \\\n-  /* Determine the base section we are interested in:\t\t\t   \\\n-     0=text, 1=rodata, 2=data, 3=sdata, [4=bss].  */\t\t\t   \\\n-  if (TREE_CODE (DECL) == FUNCTION_DECL)\t\t\t\t   \\\n-    sec = 0;\t\t\t\t\t\t\t\t   \\\n-  else if (DECL_INITIAL (DECL) == 0\t\t\t\t\t   \\\n-           || DECL_INITIAL (DECL) == error_mark_node)\t\t\t   \\\n-    sec = 2;\t\t\t\t\t\t\t\t   \\\n-  else if ((TARGET_EMBEDDED_PIC || TARGET_MIPS16)\t\t\t   \\\n-      && TREE_CODE (decl) == STRING_CST\t\t\t\t\t   \\\n-      && !flag_writable_strings)\t\t\t\t\t   \\\n-    {\t\t\t\t\t\t\t\t\t   \\\n-      /* For embedded position independent code, put constant strings\t   \\\n-\t in the text section, because the data section is limited to\t   \\\n-\t 64K in size.  For mips16 code, put strings in the text\t\t   \\\n-\t section so that a PC relative load instruction can be used to\t   \\\n-\t get their address.  */\t\t\t\t\t\t   \\\n-      sec = 0;\t\t\t\t\t\t\t\t   \\\n-    }\t\t\t\t\t\t\t\t\t   \\\n-  else if (TARGET_EMBEDDED_DATA)\t\t\t\t\t   \\\n-    {\t\t\t\t\t\t\t\t\t   \\\n-      /* For embedded applications, always put an object in read-only data \\\n-\t if possible, in order to reduce RAM usage.  */\t\t\t   \\\n-\t\t\t\t\t\t\t\t\t   \\\n-      if (DECL_READONLY_SECTION (DECL, RELOC))\t\t\t\t   \\\n-\tsec = 1;\t\t\t\t\t\t\t   \\\n-      else if (size > 0 && size <= mips_section_threshold)\t\t   \\\n-\tsec = 3;\t\t\t\t\t\t\t   \\\n-      else\t\t\t\t\t\t\t\t   \\\n-\tsec = 2;\t\t\t\t\t\t\t   \\\n-    }\t\t\t\t\t\t\t\t\t   \\\n-  else\t\t\t\t\t\t\t\t\t   \\\n-    {\t\t\t\t\t\t\t\t\t   \\\n-      /* For hosted applications, always put an object in small data if\t   \\\n-\t possible, as this gives the best performance.  */\t\t   \\\n-\t\t\t\t\t\t\t\t\t   \\\n-      if (size > 0 && size <= mips_section_threshold)\t\t\t   \\\n-\tsec = 3;\t\t\t\t\t\t\t   \\\n-      else if (DECL_READONLY_SECTION (DECL, RELOC))\t\t\t   \\\n-\tsec = 1;\t\t\t\t\t\t\t   \\\n-      else\t\t\t\t\t\t\t\t   \\\n-\tsec = 2;\t\t\t\t\t\t\t   \\\n-    }\t\t\t\t\t\t\t\t\t   \\\n-\t\t\t\t\t\t\t\t\t   \\\n-  prefix = prefixes[sec][DECL_ONE_ONLY (DECL)];\t\t\t\t   \\\n-  len = strlen (name) + strlen (prefix);\t\t\t\t   \\\n-  string = alloca (len + 1);\t\t\t\t\t\t   \\\n-  sprintf (string, \"%s%s\", prefix, name);\t\t\t\t   \\\n-\t\t\t\t\t\t\t\t\t   \\\n-  DECL_SECTION_NAME (DECL) = build_string (len, string);\t\t   \\\n-} while (0)\n+#define UNIQUE_SECTION(DECL,RELOC) \\\n+  mips_unique_section ((DECL), (RELOC))\n \n /* A list of other sections which the compiler might be \"in\" at any\n    given time.  */"}, {"sha": "da568a5496148cd484a098a8e4e0e5e0417ebcda", "filename": "gcc/config/mips/mips.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/66319f5cad7b88171aa276f018b7dce645b7788f/gcc%2Fconfig%2Fmips%2Fmips.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/66319f5cad7b88171aa276f018b7dce645b7788f/gcc%2Fconfig%2Fmips%2Fmips.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fmips%2Fmips.c?ref=66319f5cad7b88171aa276f018b7dce645b7788f", "patch": "@@ -10259,6 +10259,7 @@ mips_unique_section (decl, reloc)\n \n   name = IDENTIFIER_POINTER (DECL_ASSEMBLER_NAME (decl));\n   size = int_size_in_bytes (TREE_TYPE (decl));\n+  STRIP_NAME_ENCODING (name, name);\n \n   /* Determine the base section we are interested in:\n      0=text, 1=rodata, 2=data, 3=sdata, [4=bss].  */"}]}