{"sha": "2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MmExNWY1ZTFlMjc3YTcyYTJjNWUzZmJiMmEwMjAzMjhmOTJmNzNhOQ==", "commit": {"author": {"name": "Hans-Peter Nilsson", "email": "hp@axis.com", "date": "2002-03-13T13:33:39Z"}, "committer": {"name": "Hans-Peter Nilsson", "email": "hp@gcc.gnu.org", "date": "2002-03-13T13:33:39Z"}, "message": "cris.c (cris_target_asm_function_prologue): Revert 2002-03-12 internal visibility change.\n\n\t* config/cris/cris.c (cris_target_asm_function_prologue): Revert\n\t2002-03-12 internal visibility change.\n\t(cris_encode_section_info): Consider MODULE_LOCAL_P when encoding\n\tvisibility into SYMBOL_REF_FLAG.\n\nFrom-SVN: r50735", "tree": {"sha": "d9cc0009200e093ff223ef906b14bf140a1c3777", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d9cc0009200e093ff223ef906b14bf140a1c3777"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9/comments", "author": {"login": "hpataxisdotcom", "id": 80339731, "node_id": "MDQ6VXNlcjgwMzM5NzMx", "avatar_url": "https://avatars.githubusercontent.com/u/80339731?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hpataxisdotcom", "html_url": "https://github.com/hpataxisdotcom", "followers_url": "https://api.github.com/users/hpataxisdotcom/followers", "following_url": "https://api.github.com/users/hpataxisdotcom/following{/other_user}", "gists_url": "https://api.github.com/users/hpataxisdotcom/gists{/gist_id}", "starred_url": "https://api.github.com/users/hpataxisdotcom/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hpataxisdotcom/subscriptions", "organizations_url": "https://api.github.com/users/hpataxisdotcom/orgs", "repos_url": "https://api.github.com/users/hpataxisdotcom/repos", "events_url": "https://api.github.com/users/hpataxisdotcom/events{/privacy}", "received_events_url": "https://api.github.com/users/hpataxisdotcom/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c0a3eeacdacc658c531709c785772d329d3c4ebd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c0a3eeacdacc658c531709c785772d329d3c4ebd", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c0a3eeacdacc658c531709c785772d329d3c4ebd"}], "stats": {"total": 29, "additions": 15, "deletions": 14}, "files": [{"sha": "b8bd58417d6532aed383a1e2c02231a37271edd5", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9", "patch": "@@ -1,3 +1,10 @@\n+2002-03-13  Hans-Peter Nilsson  <hp@axis.com>\n+\n+\t* config/cris/cris.c (cris_target_asm_function_prologue): Revert\n+\t2002-03-12 internal visibility change. \n+\t(cris_encode_section_info): Consider MODULE_LOCAL_P when encoding\n+\tvisibility into SYMBOL_REF_FLAG.\n+\n 2002-03-13  Ulrich Weigand  <uweigand@de.ibm.com>\n \n \t* expr.c (expand_expr, case NE_EXPR): Do not call copy_to_reg with"}, {"sha": "2fe9ea46098ddb749ffbf0801e2350b9f75137cb", "filename": "gcc/config/cris/cris.c", "status": "modified", "additions": 8, "deletions": 14, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9/gcc%2Fconfig%2Fcris%2Fcris.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9/gcc%2Fconfig%2Fcris%2Fcris.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fcris%2Fcris.c?ref=2a15f5e1e277a72a2c5e3fbb2a020328f92f73a9", "patch": "@@ -857,19 +857,11 @@ cris_target_asm_function_prologue (file, size)\n       framesize += size + cfoa_size;\n     }\n \n-  /* Set up the PIC register.  Not needed for a function marked with\n-     visibility \"internal\".  */\n+  /* Set up the PIC register.  */\n   if (current_function_uses_pic_offset_table)\n-    {\n-      tree vis = lookup_attribute (\"visibility\", DECL_ATTRIBUTES (cfun->decl));\n-\n-      if (!vis\n-\t  || strcmp (\"internal\",\n-\t\t     TREE_STRING_POINTER (TREE_VALUE (TREE_VALUE (vis)))))\n-\tasm_fprintf (file, \"\\tmove.d $pc,$%s\\n\\tsub.d .:GOTOFF,$%s\\n\",\n-\t\t     reg_names[PIC_OFFSET_TABLE_REGNUM],\n-\t\t     reg_names[PIC_OFFSET_TABLE_REGNUM]);\n-    }\n+    asm_fprintf (file, \"\\tmove.d $pc,$%s\\n\\tsub.d .:GOTOFF,$%s\\n\",\n+\t\t reg_names[PIC_OFFSET_TABLE_REGNUM],\n+\t\t reg_names[PIC_OFFSET_TABLE_REGNUM]);\n \n   if (TARGET_PDEBUG)\n     fprintf (file,\n@@ -3054,11 +3046,13 @@ cris_encode_section_info (exp, first)\n       if (DECL_P (exp))\n \t{\n \t  if (TREE_CODE (exp) == FUNCTION_DECL\n-\t      && (TREE_PUBLIC (exp) || DECL_WEAK (exp)))\n+\t      && (TREE_PUBLIC (exp) || DECL_WEAK (exp))\n+\t      && ! MODULE_LOCAL_P (exp))\n \t    SYMBOL_REF_FLAG (XEXP (DECL_RTL (exp), 0)) = 0;\n \t  else\n \t    SYMBOL_REF_FLAG (XEXP (DECL_RTL (exp), 0))\n-\t      = ! TREE_PUBLIC (exp) && ! DECL_WEAK (exp);\n+\t      = ((! TREE_PUBLIC (exp) && ! DECL_WEAK (exp))\n+\t\t || MODULE_LOCAL_P (exp));\n \t}\n       else\n \t/* Others are local entities.  */"}]}