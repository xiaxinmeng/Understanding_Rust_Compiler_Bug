{"sha": "88a2d13f6c3565b1bcfdb440ec0988159818f339", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODhhMmQxM2Y2YzM1NjViMWJjZmRiNDQwZWMwOTg4MTU5ODE4ZjMzOQ==", "commit": {"author": {"name": "Richard Biener", "email": "rguenther@suse.de", "date": "2015-07-01T07:36:25Z"}, "committer": {"name": "Richard Biener", "email": "rguenth@gcc.gnu.org", "date": "2015-07-01T07:36:25Z"}, "message": "genmatch.c (expr::gen_transform): Shortcut re-simplifying of converts to avoid uninteresting noise from the...\n\n2015-07-01  Richard Biener <rguenther@suse.de>\n\n\t* genmatch.c (expr::gen_transform): Shortcut re-simplifying\n\tof converts to avoid uninteresting noise from the conversion\n\tsimplifying patterns.\n\nFrom-SVN: r225223", "tree": {"sha": "e8fc121f69401342347e0171f7cab34f1ff75e7e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/e8fc121f69401342347e0171f7cab34f1ff75e7e"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/88a2d13f6c3565b1bcfdb440ec0988159818f339", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88a2d13f6c3565b1bcfdb440ec0988159818f339", "html_url": "https://github.com/Rust-GCC/gccrs/commit/88a2d13f6c3565b1bcfdb440ec0988159818f339", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/88a2d13f6c3565b1bcfdb440ec0988159818f339/comments", "author": {"login": "rguenth", "id": 2046526, "node_id": "MDQ6VXNlcjIwNDY1MjY=", "avatar_url": "https://avatars.githubusercontent.com/u/2046526?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rguenth", "html_url": "https://github.com/rguenth", "followers_url": "https://api.github.com/users/rguenth/followers", "following_url": "https://api.github.com/users/rguenth/following{/other_user}", "gists_url": "https://api.github.com/users/rguenth/gists{/gist_id}", "starred_url": "https://api.github.com/users/rguenth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rguenth/subscriptions", "organizations_url": "https://api.github.com/users/rguenth/orgs", "repos_url": "https://api.github.com/users/rguenth/repos", "events_url": "https://api.github.com/users/rguenth/events{/privacy}", "received_events_url": "https://api.github.com/users/rguenth/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "e8cfe4c5a5490317edaba67819f1a4253e464e23", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e8cfe4c5a5490317edaba67819f1a4253e464e23", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e8cfe4c5a5490317edaba67819f1a4253e464e23"}], "stats": {"total": 19, "additions": 19, "deletions": 0}, "files": [{"sha": "af2c5d808438368e531d60e5d9fbd0742fe03661", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88a2d13f6c3565b1bcfdb440ec0988159818f339/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88a2d13f6c3565b1bcfdb440ec0988159818f339/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=88a2d13f6c3565b1bcfdb440ec0988159818f339", "patch": "@@ -1,3 +1,9 @@\n+2015-07-01  Richard Biener <rguenther@suse.de>\n+\n+\t* genmatch.c (expr::gen_transform): Shortcut re-simplifying\n+\tof converts to avoid uninteresting noise from the conversion\n+\tsimplifying patterns.\n+\n 2015-06-30  Sandra Loosemore <sandra@codesourcery.com>\n \n \t* config/c6x/c6x.c (try_rename_operands): Do not depend on"}, {"sha": "6f8cea9318a5a401f141b6f6b4bdd0ca945e82bc", "filename": "gcc/genmatch.c", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/88a2d13f6c3565b1bcfdb440ec0988159818f339/gcc%2Fgenmatch.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/88a2d13f6c3565b1bcfdb440ec0988159818f339/gcc%2Fgenmatch.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fgenmatch.c?ref=88a2d13f6c3565b1bcfdb440ec0988159818f339", "patch": "@@ -1740,6 +1740,10 @@ expr::gen_transform (FILE *f, const char *dest, bool gimple, int depth,\n \n   if (gimple)\n     {\n+      if (*operation == CONVERT_EXPR)\n+\tfprintf (f, \"  if (%s != TREE_TYPE (ops%d[0])\\n\"\n+\t    \"      && !useless_type_conversion_p (%s, TREE_TYPE (ops%d[0])))\\n\"\n+\t    \"  {\\n\", type, depth, type, depth);\n       /* ???  Building a stmt can fail for various reasons here, seq being\n          NULL or the stmt referencing SSA names occuring in abnormal PHIs.\n \t So if we fail here we should continue matching other patterns.  */\n@@ -1752,9 +1756,15 @@ expr::gen_transform (FILE *f, const char *dest, bool gimple, int depth,\n \t       ops.length (), type);\n       fprintf (f, \"  res = maybe_push_res_to_seq (tem_code, %s, tem_ops, seq);\\n\"\n \t       \"  if (!res) return false;\\n\", type);\n+      if (*operation == CONVERT_EXPR)\n+        fprintf (f, \"  }\\n\"\n+\t\t \"  else\\n\"\n+\t\t \"    res = ops%d[0];\\n\", depth);\n     }\n   else\n     {\n+      if (*operation == CONVERT_EXPR)\n+\tfprintf (f, \"  if (TREE_TYPE (ops%d[0]) != %s)\\n\", depth, type);\n       if (operation->kind == id_base::CODE)\n \tfprintf (f, \"  res = fold_build%d_loc (loc, %s, %s\",\n \t\t ops.length(), opr, type);\n@@ -1764,6 +1774,9 @@ expr::gen_transform (FILE *f, const char *dest, bool gimple, int depth,\n       for (unsigned i = 0; i < ops.length (); ++i)\n \tfprintf (f, \", ops%d[%u]\", depth, i);\n       fprintf (f, \");\\n\");\n+      if (*operation == CONVERT_EXPR)\n+\tfprintf (f, \"  else\\n\"\n+\t\t \"    res = ops%d[0];\\n\", depth);\n     }\n   fprintf (f, \"%s = res;\\n\", dest);\n   fprintf (f, \"}\\n\");"}]}