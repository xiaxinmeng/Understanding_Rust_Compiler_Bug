{"sha": "8be2c87161b7db3a5067bd0e1a5b5565744680a2", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OGJlMmM4NzE2MWI3ZGIzYTUwNjdiZDBlMWE1YjU1NjU3NDQ2ODBhMg==", "commit": {"author": {"name": "Dodji Seketeli", "email": "dodji@redhat.com", "date": "2009-07-09T17:56:44Z"}, "committer": {"name": "Dodji Seketeli", "email": "dodji@gcc.gnu.org", "date": "2009-07-09T17:56:44Z"}, "message": "re PR c++/40684 (ICE in tsubst)\n\n2009-07-09  Dodji Seketeli  <dodji@redhat.com>\n\ngcc/cp/ChangeLog:\n\tPR c++/40684\n\t* pt.c (type_unification_real): Use tsubst_template_arg instead\n\tof tsubst to substitute default template arguments.\n\ngcc/testsuite/ChangeLog:\n\tPR c++/40684\n\t* g++.dg/template/unify11.C: New test.\n\nFrom-SVN: r149423", "tree": {"sha": "0acb31e568aebeb03f71fd059ddd620dbaed8767", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0acb31e568aebeb03f71fd059ddd620dbaed8767"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/8be2c87161b7db3a5067bd0e1a5b5565744680a2", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8be2c87161b7db3a5067bd0e1a5b5565744680a2", "html_url": "https://github.com/Rust-GCC/gccrs/commit/8be2c87161b7db3a5067bd0e1a5b5565744680a2", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/8be2c87161b7db3a5067bd0e1a5b5565744680a2/comments", "author": null, "committer": null, "parents": [{"sha": "1aafbf99427843b553de817302453bf126592553", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1aafbf99427843b553de817302453bf126592553", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1aafbf99427843b553de817302453bf126592553"}], "stats": {"total": 52, "additions": 50, "deletions": 2}, "files": [{"sha": "8e3b90704c69424686cc0c5e93e6e88b636a6225", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=8be2c87161b7db3a5067bd0e1a5b5565744680a2", "patch": "@@ -1,3 +1,9 @@\n+2009-07-09  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/40684\n+\t* pt.c (type_unification_real): Use tsubst_template_arg instead\n+\tof tsubst to substitute default template arguments.\n+\n 2009-07-08  Manuel L\u00f3pez-Ib\u00e1\u00f1ez  <manu@gcc.gnu.org>\n \n \tPR c++/31246"}, {"sha": "d042f98f9a3b69e59c883a760bed59c0933367ed", "filename": "gcc/cp/pt.c", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Fcp%2Fpt.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Fcp%2Fpt.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fpt.c?ref=8be2c87161b7db3a5067bd0e1a5b5565744680a2", "patch": "@@ -12949,8 +12949,9 @@ type_unification_real (tree tparms,\n \t     to explicitly check cxx_dialect here.  */\n           if (TREE_PURPOSE (TREE_VEC_ELT (tparms, i)))\n             {\n-              tree arg = tsubst (TREE_PURPOSE (TREE_VEC_ELT (tparms, i)), \n-                                 targs, tf_none, NULL_TREE);\n+              tree arg = tsubst_template_arg\n+\t\t\t\t(TREE_PURPOSE (TREE_VEC_ELT (tparms, i)),\n+\t\t\t\t targs, tf_none, NULL_TREE);\n               if (arg == error_mark_node)\n                 return 1;\n               else"}, {"sha": "d9f3bfe4e40cf0212369a1cb5d4236a398af8f29", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=8be2c87161b7db3a5067bd0e1a5b5565744680a2", "patch": "@@ -1,3 +1,8 @@\n+2009-07-09  Dodji Seketeli  <dodji@redhat.com>\n+\n+\tPR c++/40684\n+\t* g++.dg/template/unify11.C: New test.\n+\n 2008-07-09  Paul Thomas  <pault@gcc.gnu.org>\n \n \tPR fortran/40629"}, {"sha": "c8df94b31ca0ab38cea1793ec16c38a948041782", "filename": "gcc/testsuite/g++.dg/template/unify11.C", "status": "added", "additions": 36, "deletions": 0, "changes": 36, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Funify11.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/8be2c87161b7db3a5067bd0e1a5b5565744680a2/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Funify11.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Ftemplate%2Funify11.C?ref=8be2c87161b7db3a5067bd0e1a5b5565744680a2", "patch": "@@ -0,0 +1,36 @@\n+// Contributed by Dodji Seketeli <dodji@redhat.com>\n+// Origin: PR c++/40684\n+// { dg-options \"-std=c++0x\" }\n+\n+struct A\n+{\n+};\n+\n+template <typename S, typename T, typename U, typename S::v = &S::v::s>\n+typename S::A\n+foo (S c, T t, U u)\n+{\n+}\n+\n+struct B\n+{\n+  struct C\n+  {\n+    template <typename U>\n+    C (U t)\n+    {\n+      A a;\n+      A b = foo (this, a, t); // { dg-error \"no matching function\" }\n+    }\n+  } c;\n+  B () : c (A ())\n+  {\n+  }\n+};\n+\n+int\n+main ()\n+{\n+  B f;\n+}\n+"}]}