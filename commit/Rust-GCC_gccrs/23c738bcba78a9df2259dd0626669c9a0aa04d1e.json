{"sha": "23c738bcba78a9df2259dd0626669c9a0aa04d1e", "node_id": "C_kwDOANBUbNoAKDIzYzczOGJjYmE3OGE5ZGYyMjU5ZGQwNjI2NjY5YzlhMGFhMDRkMWU", "commit": {"author": {"name": "ShiYulong", "email": "shiyulong@iscas.ac.cn", "date": "2022-05-10T03:25:24Z"}, "committer": {"name": "Kito Cheng", "email": "kito.cheng@sifive.com", "date": "2022-05-24T13:00:33Z"}, "message": "RISC-V: Add mininal support for Zicbo[mzp]\n\nThis commit adds minimal support for 'Zicbom','Zicboz' and 'Zicbop' extensions.\n\ngcc/ChangeLog:\n\n\t* common/config/riscv/riscv-common.cc: Add zicbom, zicboz, zicbop extensions.\n\t* config/riscv/riscv-opts.h (MASK_ZICBOZ): New.\n\t(MASK_ZICBOM): New.\n\t(MASK_ZICBOP): New.\n\t(TARGET_ZICBOZ): New.\n\t(TARGET_ZICBOM): New.\n\t(TARGET_ZICBOP): New.\n\t* config/riscv/riscv.opt (riscv_zicmo_subext): New.", "tree": {"sha": "8e91fb9143fe555b7b151a0e60f96ccfac50f6a2", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/8e91fb9143fe555b7b151a0e60f96ccfac50f6a2"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/23c738bcba78a9df2259dd0626669c9a0aa04d1e", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23c738bcba78a9df2259dd0626669c9a0aa04d1e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/23c738bcba78a9df2259dd0626669c9a0aa04d1e", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/23c738bcba78a9df2259dd0626669c9a0aa04d1e/comments", "author": {"login": "yulong-plct", "id": 94943299, "node_id": "U_kgDOBai4Qw", "avatar_url": "https://avatars.githubusercontent.com/u/94943299?v=4", "gravatar_id": "", "url": "https://api.github.com/users/yulong-plct", "html_url": "https://github.com/yulong-plct", "followers_url": "https://api.github.com/users/yulong-plct/followers", "following_url": "https://api.github.com/users/yulong-plct/following{/other_user}", "gists_url": "https://api.github.com/users/yulong-plct/gists{/gist_id}", "starred_url": "https://api.github.com/users/yulong-plct/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/yulong-plct/subscriptions", "organizations_url": "https://api.github.com/users/yulong-plct/orgs", "repos_url": "https://api.github.com/users/yulong-plct/repos", "events_url": "https://api.github.com/users/yulong-plct/events{/privacy}", "received_events_url": "https://api.github.com/users/yulong-plct/received_events", "type": "User", "site_admin": false}, "committer": {"login": "kito-cheng", "id": 2723185, "node_id": "MDQ6VXNlcjI3MjMxODU=", "avatar_url": "https://avatars.githubusercontent.com/u/2723185?v=4", "gravatar_id": "", "url": "https://api.github.com/users/kito-cheng", "html_url": "https://github.com/kito-cheng", "followers_url": "https://api.github.com/users/kito-cheng/followers", "following_url": "https://api.github.com/users/kito-cheng/following{/other_user}", "gists_url": "https://api.github.com/users/kito-cheng/gists{/gist_id}", "starred_url": "https://api.github.com/users/kito-cheng/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/kito-cheng/subscriptions", "organizations_url": "https://api.github.com/users/kito-cheng/orgs", "repos_url": "https://api.github.com/users/kito-cheng/repos", "events_url": "https://api.github.com/users/kito-cheng/events{/privacy}", "received_events_url": "https://api.github.com/users/kito-cheng/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "4665cfbc4c70e24b4c885338577d4b7bc1752473", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4665cfbc4c70e24b4c885338577d4b7bc1752473", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4665cfbc4c70e24b4c885338577d4b7bc1752473"}], "stats": {"total": 19, "additions": 19, "deletions": 0}, "files": [{"sha": "0e5be2ce105dcf2410d5273d385c3558daa9c29b", "filename": "gcc/common/config/riscv/riscv-common.cc", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23c738bcba78a9df2259dd0626669c9a0aa04d1e/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23c738bcba78a9df2259dd0626669c9a0aa04d1e/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcommon%2Fconfig%2Friscv%2Friscv-common.cc?ref=23c738bcba78a9df2259dd0626669c9a0aa04d1e", "patch": "@@ -165,6 +165,10 @@ static const struct riscv_ext_version riscv_ext_version_table[] =\n   {\"zksh\",  ISA_SPEC_CLASS_NONE, 1, 0},\n   {\"zkt\",   ISA_SPEC_CLASS_NONE, 1, 0},\n \n+  {\"zicboz\",ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zicbom\",ISA_SPEC_CLASS_NONE, 1, 0},\n+  {\"zicbop\",ISA_SPEC_CLASS_NONE, 1, 0},\n+\n   {\"zk\",    ISA_SPEC_CLASS_NONE, 1, 0},\n   {\"zkn\",   ISA_SPEC_CLASS_NONE, 1, 0},\n   {\"zks\",   ISA_SPEC_CLASS_NONE, 1, 0},\n@@ -1110,6 +1114,10 @@ static const riscv_ext_flag_table_t riscv_ext_flag_table[] =\n   {\"zksh\",   &gcc_options::x_riscv_zk_subext, MASK_ZKSH},\n   {\"zkt\",    &gcc_options::x_riscv_zk_subext, MASK_ZKT},\n \n+  {\"zicboz\", &gcc_options::x_riscv_zicmo_subext, MASK_ZICBOZ},\n+  {\"zicbom\", &gcc_options::x_riscv_zicmo_subext, MASK_ZICBOM},\n+  {\"zicbop\", &gcc_options::x_riscv_zicmo_subext, MASK_ZICBOP},\n+\n   {\"zve32x\",   &gcc_options::x_target_flags, MASK_VECTOR},\n   {\"zve32f\",   &gcc_options::x_target_flags, MASK_VECTOR},\n   {\"zve64x\",   &gcc_options::x_target_flags, MASK_VECTOR},"}, {"sha": "1e153b3a6e71911ef704a03f38e69b8ef20b9527", "filename": "gcc/config/riscv/riscv-opts.h", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23c738bcba78a9df2259dd0626669c9a0aa04d1e/gcc%2Fconfig%2Friscv%2Friscv-opts.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23c738bcba78a9df2259dd0626669c9a0aa04d1e/gcc%2Fconfig%2Friscv%2Friscv-opts.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv-opts.h?ref=23c738bcba78a9df2259dd0626669c9a0aa04d1e", "patch": "@@ -145,6 +145,14 @@ enum stack_protector_guard {\n #define TARGET_ZVL32768B ((riscv_zvl_flags & MASK_ZVL32768B) != 0)\n #define TARGET_ZVL65536B ((riscv_zvl_flags & MASK_ZVL65536B) != 0)\n \n+#define MASK_ZICBOZ   (1 << 0)\n+#define MASK_ZICBOM   (1 << 1)\n+#define MASK_ZICBOP   (1 << 2)\n+\n+#define TARGET_ZICBOZ ((riscv_zicmo_subext & MASK_ZICBOZ) != 0)\n+#define TARGET_ZICBOM ((riscv_zicmo_subext & MASK_ZICBOM) != 0)\n+#define TARGET_ZICBOP ((riscv_zicmo_subext & MASK_ZICBOP) != 0)\n+\n /* Bit of riscv_zvl_flags will set contintuly, N-1 bit will set if N-bit is\n    set, e.g. MASK_ZVL64B has set then MASK_ZVL32B is set, so we can use\n    popcount to caclulate the minimal VLEN.  */"}, {"sha": "9e9fe6d8ccd1722cfd1e6c5881da3081e31204fc", "filename": "gcc/config/riscv/riscv.opt", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/23c738bcba78a9df2259dd0626669c9a0aa04d1e/gcc%2Fconfig%2Friscv%2Friscv.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/23c738bcba78a9df2259dd0626669c9a0aa04d1e/gcc%2Fconfig%2Friscv%2Friscv.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Friscv%2Friscv.opt?ref=23c738bcba78a9df2259dd0626669c9a0aa04d1e", "patch": "@@ -209,6 +209,9 @@ int riscv_vector_elen_flags\n TargetVariable\n int riscv_zvl_flags\n \n+TargetVariable\n+int riscv_zicmo_subext\n+\n Enum\n Name(isa_spec_class) Type(enum riscv_isa_spec_class)\n Supported ISA specs (for use with the -misa-spec= option):"}]}