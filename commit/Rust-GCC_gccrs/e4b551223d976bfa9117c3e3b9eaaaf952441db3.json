{"sha": "e4b551223d976bfa9117c3e3b9eaaaf952441db3", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZTRiNTUxMjIzZDk3NmJmYTkxMTdjM2UzYjllYWFhZjk1MjQ0MWRiMw==", "commit": {"author": {"name": "Robert Dewar", "email": "dewar@adacore.com", "date": "2007-12-13T10:35:02Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2007-12-13T10:35:02Z"}, "message": "s-stoele.adb (\"mod\"): mod negative value raises Constraint_Error\n\n2007-12-06  Robert Dewar  <dewar@adacore.com>\n\n\t* s-stoele.adb (\"mod\"): mod negative value raises Constraint_Error\n\nFrom-SVN: r130864", "tree": {"sha": "6e5df141a80f11224996c769f6de1932b30ff110", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/6e5df141a80f11224996c769f6de1932b30ff110"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/e4b551223d976bfa9117c3e3b9eaaaf952441db3", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4b551223d976bfa9117c3e3b9eaaaf952441db3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e4b551223d976bfa9117c3e3b9eaaaf952441db3", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e4b551223d976bfa9117c3e3b9eaaaf952441db3/comments", "author": null, "committer": null, "parents": [{"sha": "4981ffccd5f5036ee2e5f768e62d41f9be354187", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4981ffccd5f5036ee2e5f768e62d41f9be354187", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4981ffccd5f5036ee2e5f768e62d41f9be354187"}], "stats": {"total": 19, "additions": 13, "deletions": 6}, "files": [{"sha": "67aae726e75c871e6c83f48e34ae3bb4f4996fa1", "filename": "gcc/ada/s-stoele.adb", "status": "modified", "additions": 13, "deletions": 6, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/e4b551223d976bfa9117c3e3b9eaaaf952441db3/gcc%2Fada%2Fs-stoele.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/e4b551223d976bfa9117c3e3b9eaaaf952441db3/gcc%2Fada%2Fs-stoele.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fs-stoele.adb?ref=e4b551223d976bfa9117c3e3b9eaaaf952441db3", "patch": "@@ -47,8 +47,9 @@ package body System.Storage_Elements is\n      new Ada.Unchecked_Conversion (Address, Storage_Offset);\n \n    --  Conversion to/from integers\n-   --  Those functions must be place first because they are inlined_always\n-   --  and are used in other subprograms defined in this unit.\n+\n+   --  These functions must be place first because they are inlined_always\n+   --  and are used and inlined in other subprograms defined in this unit.\n \n    function To_Integer (Value : Address) return Integer_Address is\n    begin\n@@ -87,12 +88,18 @@ package body System.Storage_Elements is\n       Right : Storage_Offset) return Storage_Offset\n    is\n    begin\n-      if Right >= 0 then\n+      if Right > 0 then\n          return Storage_Offset\n-                  (To_Integer (Left) mod Integer_Address (Right));\n+           (To_Integer (Left) mod Integer_Address (Right));\n+\n+         --  The negative case makes no sense since it is a case of a mod where\n+         --  the left argument is unsigned and the right argument is signed. In\n+         --  accordance with the (spirit of the) permission of RM 13.7.1(16),\n+         --  we raise CE, and also include the zero case here. Yes, the RM says\n+         --  PE, but this really is so obviously more like a constraint error.\n+\n       else\n-         return -Storage_Offset\n-                  ((-To_Integer (Left)) mod Integer_Address (-Right));\n+         raise Constraint_Error;\n       end if;\n    end \"mod\";\n end System.Storage_Elements;"}]}