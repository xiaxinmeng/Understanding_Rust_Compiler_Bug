{"sha": "6b1237e30840dac66ae8d16507581c948c76c52c", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmIxMjM3ZTMwODQwZGFjNjZhZThkMTY1MDc1ODFjOTQ4Yzc2YzUyYw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@linaro.org", "date": "2017-09-21T11:10:48Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2017-09-21T11:10:48Z"}, "message": "Add copy_rtx call to RTL loop unroller\n\nThis is needed if the step is an unshared constant, like many\n(const ...)s are.  Without this patch, libgfortran would fail\nto build for SVE.\n\n2017-09-21  Richard Sandiford  <richard.sandiford@linaro.org>\n\t    Alan Hayward  <alan.hayward@arm.com>\n\t    David Sherwood  <david.sherwood@arm.com>\n\ngcc/\n\t* loop-unroll.c (split_iv): Call copy_rtx on the step.\n\nCo-Authored-By: Alan Hayward <alan.hayward@arm.com>\nCo-Authored-By: David Sherwood <david.sherwood@arm.com>\n\nFrom-SVN: r253058", "tree": {"sha": "ff694be8822ad7a6a67ce2c206bab3d21f8b5dad", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ff694be8822ad7a6a67ce2c206bab3d21f8b5dad"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6b1237e30840dac66ae8d16507581c948c76c52c", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b1237e30840dac66ae8d16507581c948c76c52c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6b1237e30840dac66ae8d16507581c948c76c52c", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6b1237e30840dac66ae8d16507581c948c76c52c/comments", "author": null, "committer": null, "parents": [{"sha": "2e89be4857edfbbcfcca261079c868d70341feb1", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2e89be4857edfbbcfcca261079c868d70341feb1", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2e89be4857edfbbcfcca261079c868d70341feb1"}], "stats": {"total": 9, "additions": 8, "deletions": 1}, "files": [{"sha": "7eec76768dd886a7deb6dabcffee46d33fbe55df", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b1237e30840dac66ae8d16507581c948c76c52c/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b1237e30840dac66ae8d16507581c948c76c52c/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6b1237e30840dac66ae8d16507581c948c76c52c", "patch": "@@ -1,3 +1,9 @@\n+2017-09-21  Richard Sandiford  <richard.sandiford@linaro.org>\n+\t    Alan Hayward  <alan.hayward@arm.com>\n+\t    David Sherwood  <david.sherwood@arm.com>\n+\n+\t* loop-unroll.c (split_iv): Call copy_rtx on the step.\n+\n 2017-09-21  Richard Sandiford  <richard.sandiford@linaro.org>\n \t    Alan Hayward  <alan.hayward@arm.com>\n \t    David Sherwood  <david.sherwood@arm.com>"}, {"sha": "322f151ac5dfdc4f0303ee73ad8220fc694f30e8", "filename": "gcc/loop-unroll.c", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6b1237e30840dac66ae8d16507581c948c76c52c/gcc%2Floop-unroll.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6b1237e30840dac66ae8d16507581c948c76c52c/gcc%2Floop-unroll.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Floop-unroll.c?ref=6b1237e30840dac66ae8d16507581c948c76c52c", "patch": "@@ -1731,7 +1731,8 @@ split_iv (struct iv_to_split *ivts, rtx_insn *insn, unsigned delta)\n   else\n     {\n       incr = simplify_gen_binary (MULT, mode,\n-\t\t\t\t  ivts->step, gen_int_mode (delta, mode));\n+\t\t\t\t  copy_rtx (ivts->step),\n+\t\t\t\t  gen_int_mode (delta, mode));\n       expr = simplify_gen_binary (PLUS, GET_MODE (ivts->base_var),\n \t\t\t\t  ivts->base_var, incr);\n     }"}]}