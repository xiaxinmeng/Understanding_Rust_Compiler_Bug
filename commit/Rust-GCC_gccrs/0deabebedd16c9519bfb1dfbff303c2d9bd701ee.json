{"sha": "0deabebedd16c9519bfb1dfbff303c2d9bd701ee", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MGRlYWJlYmVkZDE2Yzk1MTliZmIxZGZiZmYzMDNjMmQ5YmQ3MDFlZQ==", "commit": {"author": {"name": "Andrew Pinski", "email": "apinski@marvell.com", "date": "2021-08-24T05:56:59Z"}, "committer": {"name": "Andrew Pinski", "email": "apinski@marvell.com", "date": "2021-08-24T08:09:53Z"}, "message": "Fix a few problems with download_prerequisites.\n\nThere are a few problems with download_prerequisites are\ndescribed in PR 82704.  The first is on busy-box version of\nshasum and md5sum the extended option --check don't exist\nso just use -c.  The second issue is the code for which\nshasum program to use is included twice and is different.\nSo move which program to use for the checksum after argument\nparsing.  The last issue is --md5 option has been broken for\nsometime now as the program is named md5sum and not just md5.\nNobody updated switch table to be correct.\n\ncontrib/ChangeLog:\n\n\tPR other/82704\n\t* download_prerequisites: Fix issues with --md5 and\n\t--sha512 options.", "tree": {"sha": "245fce087f413b4cec17882e5c2186e4e0866850", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/245fce087f413b4cec17882e5c2186e4e0866850"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/0deabebedd16c9519bfb1dfbff303c2d9bd701ee", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0deabebedd16c9519bfb1dfbff303c2d9bd701ee", "html_url": "https://github.com/Rust-GCC/gccrs/commit/0deabebedd16c9519bfb1dfbff303c2d9bd701ee", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/0deabebedd16c9519bfb1dfbff303c2d9bd701ee/comments", "author": {"login": "apinski-cavium", "id": 6335315, "node_id": "MDQ6VXNlcjYzMzUzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6335315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apinski-cavium", "html_url": "https://github.com/apinski-cavium", "followers_url": "https://api.github.com/users/apinski-cavium/followers", "following_url": "https://api.github.com/users/apinski-cavium/following{/other_user}", "gists_url": "https://api.github.com/users/apinski-cavium/gists{/gist_id}", "starred_url": "https://api.github.com/users/apinski-cavium/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apinski-cavium/subscriptions", "organizations_url": "https://api.github.com/users/apinski-cavium/orgs", "repos_url": "https://api.github.com/users/apinski-cavium/repos", "events_url": "https://api.github.com/users/apinski-cavium/events{/privacy}", "received_events_url": "https://api.github.com/users/apinski-cavium/received_events", "type": "User", "site_admin": false}, "committer": {"login": "apinski-cavium", "id": 6335315, "node_id": "MDQ6VXNlcjYzMzUzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6335315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apinski-cavium", "html_url": "https://github.com/apinski-cavium", "followers_url": "https://api.github.com/users/apinski-cavium/followers", "following_url": "https://api.github.com/users/apinski-cavium/following{/other_user}", "gists_url": "https://api.github.com/users/apinski-cavium/gists{/gist_id}", "starred_url": "https://api.github.com/users/apinski-cavium/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apinski-cavium/subscriptions", "organizations_url": "https://api.github.com/users/apinski-cavium/orgs", "repos_url": "https://api.github.com/users/apinski-cavium/repos", "events_url": "https://api.github.com/users/apinski-cavium/events{/privacy}", "received_events_url": "https://api.github.com/users/apinski-cavium/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "f8977166135de09fe36a3b57cc11daa67587604e", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f8977166135de09fe36a3b57cc11daa67587604e", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f8977166135de09fe36a3b57cc11daa67587604e"}], "stats": {"total": 59, "additions": 30, "deletions": 29}, "files": [{"sha": "8f69b61f5a93761051bb32a2a15148b772e65b61", "filename": "contrib/download_prerequisites", "status": "modified", "additions": 30, "deletions": 29, "changes": 59, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/0deabebedd16c9519bfb1dfbff303c2d9bd701ee/contrib%2Fdownload_prerequisites", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/0deabebedd16c9519bfb1dfbff303c2d9bd701ee/contrib%2Fdownload_prerequisites", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/contrib%2Fdownload_prerequisites?ref=0deabebedd16c9519bfb1dfbff303c2d9bd701ee", "patch": "@@ -46,18 +46,6 @@ verify=1\n force=0\n OS=$(uname)\n \n-case $OS in\n-  \"Darwin\"|\"FreeBSD\"|\"DragonFly\"|\"AIX\")\n-    chksum='shasum -a 512 --check'\n-  ;;\n-  \"OpenBSD\")\n-    chksum='sha512 -c'\n-  ;;\n-  *)\n-    chksum='sha512sum -c'\n-  ;;\n-esac\n-\n if type wget > /dev/null ; then\n   fetch='wget'\n else\n@@ -113,7 +101,7 @@ do\n done\n unset arg\n \n-# Emulate Linux's 'md5 --check' on macOS\n+# Emulate Linux's 'md5sum --check' on macOS\n md5_check() {\n   # Store the standard input: a line from contrib/prerequisites.md5:\n   md5_checksum_line=$(cat -)\n@@ -162,26 +150,10 @@ do\n                 verify=0\n                 ;;\n             --sha512)\n-                case $OS in\n-                  \"Darwin\")\n-                    chksum='shasum -a 512 --check'\n-                  ;;\n-                  *)\n-                    chksum='sha512sum --check'\n-                  ;;\n-                esac\n                 chksum_extension='sha512'\n                 verify=1\n                 ;;\n             --md5)\n-                case $OS in\n-                  \"Darwin\")\n-                    chksum='md5_check'\n-                  ;;\n-                  *)\n-                    chksum='md5 --check'\n-                  ;;\n-                esac\n                 chksum_extension='md5'\n                 verify=1\n                 ;;\n@@ -212,6 +184,35 @@ done\n [ \"x${argnext}\" = x ] || die \"Missing argument for option --${argnext}\"\n unset arg argnext\n \n+case $chksum_extension in\n+  sha512)\n+    case $OS in\n+      \"Darwin\"|\"FreeBSD\"|\"DragonFly\"|\"AIX\")\n+        chksum='shasum -a 512 --check'\n+      ;;\n+      \"OpenBSD\")\n+        chksum='sha512 -c'\n+      ;;\n+      *)\n+        chksum='sha512sum -c'\n+      ;;\n+    esac\n+  ;;\n+  md5)\n+    case $OS in\n+      \"Darwin\")\n+        chksum='md5_check'\n+      ;;\n+      *)\n+        chksum='md5sum -c'\n+      ;;\n+    esac\n+    ;;\n+  *)\n+    die \"Unkown checksum $chksum_extension\"\n+  ;;\n+esac\n+\n [ -e ./gcc/BASE-VER ]                                                         \\\n     || die \"You must run this script in the top-level GCC source directory\"\n "}]}