{"sha": "7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2UzM2Q0ZGM5ZTM1YWEzMWVjZmRlNmVkNjhmOGQ1ZTY2ZWIxOTQ0Ng==", "commit": {"author": {"name": "Bernd Schmidt", "email": "bernds@redhat.com", "date": "2016-01-07T12:17:39Z"}, "committer": {"name": "Bernd Schmidt", "email": "bernds@gcc.gnu.org", "date": "2016-01-07T12:17:39Z"}, "message": "Fix SSA inconsistencies with invalid asm reg names (PR67639)\n\n\tPR middle-end/67639\n\t* varasm.c (make_decl_rtl): Mark invalid register vars as\n\tDECL_EXTERNAL.\n\ntestsuite/\n\tPR middle-end/67639\n\t* c-c++-common/pr67639.c: New test.\n\nFrom-SVN: r232125", "tree": {"sha": "95a4fa39ad8cc714d4165a4489fe0289d2b92704", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/95a4fa39ad8cc714d4165a4489fe0289d2b92704"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/comments", "author": null, "committer": null, "parents": [{"sha": "c6a0add9d0a23aaf7ba32ae4416da8170c4f0dce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c6a0add9d0a23aaf7ba32ae4416da8170c4f0dce", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c6a0add9d0a23aaf7ba32ae4416da8170c4f0dce"}], "stats": {"total": 20, "additions": 20, "deletions": 0}, "files": [{"sha": "21a95fd1ca49cc190ad60846f2a149afb35c3ac7", "filename": "gcc/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "patch": "@@ -1,5 +1,9 @@\n 2015-12-15  Bernd Schmidt  <bschmidt@redhat.com>\n \n+\tPR middle-end/67639\n+\t* varasm.c (make_decl_rtl): Mark invalid register vars as\n+\tDECL_EXTERNAL.\n+\n \tPR rtl-optimization/66206\n \t* bt-load.c (find_btr_use): Change first arg to be a pointer to an rtx.\n \tAll callers changed."}, {"sha": "29894213bcc7083059aaa2e4a37a0301c987356c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "patch": "@@ -1,3 +1,8 @@\n+2015-12-15  Bernd Schmidt  <bschmidt@redhat.com>\n+\n+\tPR middle-end/67639\n+\t* c-c++-common/pr67639.c: New test.\n+\n 2016-01-07  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/69141"}, {"sha": "aa19ba4eda373399624277118a2d102a965b1c66", "filename": "gcc/testsuite/c-c++-common/pr67639.c", "status": "added", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr67639.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr67639.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fc-c%2B%2B-common%2Fpr67639.c?ref=7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "patch": "@@ -0,0 +1,8 @@\n+/* { dg-do compile } */\n+void\n+foo (int p)\n+{\n+  int t; \n+  register long x asm (\"rhubarb\") = p; /* { dg-error \"register name\" } */\n+  __asm (\"\" : \"=r\" (t), \"=r\" (t), \"=r\" (t), \"=r\" (x) : \"0\" (x));\n+}"}, {"sha": "3a3573e53951d5aacad7a93abb1b435fb534a7dc", "filename": "gcc/varasm.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=7e33d4dc9e35aa31ecfde6ed68f8d5e66eb19446", "patch": "@@ -1420,6 +1420,9 @@ make_decl_rtl (tree decl)\n \t specifications.  */\n       SET_DECL_ASSEMBLER_NAME (decl, NULL_TREE);\n       DECL_HARD_REGISTER (decl) = 0;\n+      /* Also avoid SSA inconsistencies by pretending this is an external\n+\t decl now.  */\n+      DECL_EXTERNAL (decl) = 1;\n       return;\n     }\n   /* Now handle ordinary static variables and functions (in memory)."}]}