{"sha": "03e88100e14719f4e05dd379e88ae4daf68fa625", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDNlODgxMDBlMTQ3MTlmNGUwNWRkMzc5ZTg4YWU0ZGFmNjhmYTYyNQ==", "commit": {"author": {"name": "Jason Merrill", "email": "jason@redhat.com", "date": "2016-12-01T22:13:06Z"}, "committer": {"name": "Jason Merrill", "email": "jason@gcc.gnu.org", "date": "2016-12-01T22:13:06Z"}, "message": "call.c (add_function_candidate): Exclude inherited copy/move ctors.\n\n\t* call.c (add_function_candidate): Exclude inherited copy/move\n\tctors.\n\nFrom-SVN: r243138", "tree": {"sha": "d14cda22c0c29f2f811e5d9221fd6ca057f5be61", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d14cda22c0c29f2f811e5d9221fd6ca057f5be61"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/03e88100e14719f4e05dd379e88ae4daf68fa625", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03e88100e14719f4e05dd379e88ae4daf68fa625", "html_url": "https://github.com/Rust-GCC/gccrs/commit/03e88100e14719f4e05dd379e88ae4daf68fa625", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/03e88100e14719f4e05dd379e88ae4daf68fa625/comments", "author": {"login": "jicama", "id": 266146, "node_id": "MDQ6VXNlcjI2NjE0Ng==", "avatar_url": "https://avatars.githubusercontent.com/u/266146?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jicama", "html_url": "https://github.com/jicama", "followers_url": "https://api.github.com/users/jicama/followers", "following_url": "https://api.github.com/users/jicama/following{/other_user}", "gists_url": "https://api.github.com/users/jicama/gists{/gist_id}", "starred_url": "https://api.github.com/users/jicama/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jicama/subscriptions", "organizations_url": "https://api.github.com/users/jicama/orgs", "repos_url": "https://api.github.com/users/jicama/repos", "events_url": "https://api.github.com/users/jicama/events{/privacy}", "received_events_url": "https://api.github.com/users/jicama/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "c1ff51dc9f743fb6ecd77a9374e543d285f98cb0", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c1ff51dc9f743fb6ecd77a9374e543d285f98cb0", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c1ff51dc9f743fb6ecd77a9374e543d285f98cb0"}], "stats": {"total": 56, "additions": 42, "deletions": 14}, "files": [{"sha": "b407d17f4ec8b9eccbd927a244ddb2a6cbc221b0", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03e88100e14719f4e05dd379e88ae4daf68fa625/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03e88100e14719f4e05dd379e88ae4daf68fa625/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=03e88100e14719f4e05dd379e88ae4daf68fa625", "patch": "@@ -1,3 +1,8 @@\n+2016-12-01  Jason Merrill  <jason@redhat.com>\n+\n+\t* call.c (add_function_candidate): Exclude inherited copy/move\n+\tctors.\n+\n 2016-11-29  David Malcolm  <dmalcolm@redhat.com>\n \n \tPR c++/77922"}, {"sha": "561cc83cd3b306b54861f87856f68b111ab1b1f9", "filename": "gcc/cp/call.c", "status": "modified", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03e88100e14719f4e05dd379e88ae4daf68fa625/gcc%2Fcp%2Fcall.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03e88100e14719f4e05dd379e88ae4daf68fa625/gcc%2Fcp%2Fcall.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fcall.c?ref=03e88100e14719f4e05dd379e88ae4daf68fa625", "patch": "@@ -2042,6 +2042,25 @@ add_function_candidate (struct z_candidate **candidates,\n       reason = arity_rejection (first_arg, i + remaining, len);\n     }\n \n+  /* A constructor that is a direct member of a class C and has a first\n+     parameter of type \"reference to cv C\" (including such a constructor\n+     instantiated from a template) is excluded from the set of candidate\n+     functions when used to construct an object of type derived from C (12.6.3\n+     [class.inhctor.init]) with an argument list containing a single\n+     argument.  */\n+  if (viable && len == 1 && parmlist && DECL_CONSTRUCTOR_P (fn)\n+      && flag_new_inheriting_ctors\n+      && DECL_INHERITED_CTOR (fn))\n+    {\n+      tree ptype = non_reference (TREE_VALUE (parmlist));\n+      tree ctype = DECL_INHERITED_CTOR_BASE (fn);\n+      if (same_type_ignoring_top_level_qualifiers_p (ptype, ctype))\n+\t{\n+\t  viable = false;\n+\t  reason = inherited_ctor_rejection ();\n+\t}\n+    }\n+\n   /* Second, for a function to be viable, its constraints must be\n      satisfied. */\n   if (flag_concepts && viable"}, {"sha": "a9abb8428a1a3ba076434ee54ec901392084eb06", "filename": "gcc/testsuite/g++.dg/cpp0x/inh-ctor15a.C", "status": "removed", "additions": 0, "deletions": 14, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c1ff51dc9f743fb6ecd77a9374e543d285f98cb0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finh-ctor15a.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c1ff51dc9f743fb6ecd77a9374e543d285f98cb0/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finh-ctor15a.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp0x%2Finh-ctor15a.C?ref=c1ff51dc9f743fb6ecd77a9374e543d285f98cb0", "patch": "@@ -1,14 +0,0 @@\n-// P0136 caused us to start inheriting base copy constructors.\n-// { dg-do compile { target c++11 } }\n-// { dg-options -fnew-inheriting-ctors }\n-\n-struct A { A(int); };\n-struct B: public A\n-{\n-  using A::A;\n-};\n-\n-A a (42);\n-\n-B b1 (24);\t\t\t// inherited\n-B b2 (a);\t\t\t// also inherited now"}, {"sha": "768a966d9f8ac343abc71150da2ebda80b2ecc47", "filename": "gcc/testsuite/g++.dg/cpp1z/inh-ctor36.C", "status": "added", "additions": 18, "deletions": 0, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/03e88100e14719f4e05dd379e88ae4daf68fa625/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Finh-ctor36.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/03e88100e14719f4e05dd379e88ae4daf68fa625/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Finh-ctor36.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fcpp1z%2Finh-ctor36.C?ref=03e88100e14719f4e05dd379e88ae4daf68fa625", "patch": "@@ -0,0 +1,18 @@\n+// { dg-do link { target c++11 } }\n+\n+struct X { X(X &&); };\n+struct A {\n+  A() {}\n+  A(const A&);       // #1\n+  A(A &&) = default; // #2, defined as deleted (12.8 [class.copy])\n+  template<typename T> A(T &&);\t// #3\n+  union { X x; };\n+};\n+struct B : A {\n+  using A::A;\n+  B(...) {}\n+};\n+\n+int main() {\n+  B b = A(); // calls B::B(...): #1, #2, and #3 are excluded from candidate set\n+}"}]}