{"sha": "3b575376fbba16c3be9f607fbf53a6c841b3baae", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6M2I1NzUzNzZmYmJhMTZjM2JlOWY2MDdmYmY1M2E2Yzg0MWIzYmFhZQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-11-23T20:16:38Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2017-11-23T20:16:38Z"}, "message": "re PR fortran/81841 (THREADPRIVATE (OpenMP) wrongly rejected in BLOCK DATA)\n\n\tPR fortran/81841\n\t* parse.c (parse_spec): Allow ST_OMP_THREADPRIVATE inside of\n\tBLOCK DATA.\n\n\t* libgomp.fortran/pr81841.f90: New test.\n\nFrom-SVN: r255115", "tree": {"sha": "178214b2b2fe3727a5aae2a00605f0ca690a54be", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/178214b2b2fe3727a5aae2a00605f0ca690a54be"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/3b575376fbba16c3be9f607fbf53a6c841b3baae", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b575376fbba16c3be9f607fbf53a6c841b3baae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3b575376fbba16c3be9f607fbf53a6c841b3baae", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3b575376fbba16c3be9f607fbf53a6c841b3baae/comments", "author": null, "committer": null, "parents": [{"sha": "11aa563708d37d1b1f97864261971f8206d72554", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/11aa563708d37d1b1f97864261971f8206d72554", "html_url": "https://github.com/Rust-GCC/gccrs/commit/11aa563708d37d1b1f97864261971f8206d72554"}], "stats": {"total": 39, "additions": 39, "deletions": 0}, "files": [{"sha": "57fe9684a4b96d5f119e224d8fb39c6be4102d8b", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b575376fbba16c3be9f607fbf53a6c841b3baae/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b575376fbba16c3be9f607fbf53a6c841b3baae/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=3b575376fbba16c3be9f607fbf53a6c841b3baae", "patch": "@@ -1,3 +1,10 @@\n+2017-11-23  Dirk Broemmel  <dibr-bugzilla@daswigwam.de>\n+\t    Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/81841\n+\t* parse.c (parse_spec): Allow ST_OMP_THREADPRIVATE inside of\n+\tBLOCK DATA.\n+\n 2017-11-23  Mike Stump  <mikestump@comcast.net>\n \t    Eric Botcazou  <ebotcazou@adacore.com>\n "}, {"sha": "08bff3f8615c3b0de6f3a645d28396b9882362dd", "filename": "gcc/fortran/parse.c", "status": "modified", "additions": 1, "deletions": 0, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b575376fbba16c3be9f607fbf53a6c841b3baae/gcc%2Ffortran%2Fparse.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b575376fbba16c3be9f607fbf53a6c841b3baae/gcc%2Ffortran%2Fparse.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Fparse.c?ref=3b575376fbba16c3be9f607fbf53a6c841b3baae", "patch": "@@ -3699,6 +3699,7 @@ parse_spec (gfc_statement st)\n \tcase ST_EQUIVALENCE:\n \tcase ST_IMPLICIT:\n \tcase ST_IMPLICIT_NONE:\n+\tcase ST_OMP_THREADPRIVATE:\n \tcase ST_PARAMETER:\n \tcase ST_STRUCTURE_DECL:\n \tcase ST_TYPE:"}, {"sha": "966b561c0618154b31328574092157b804dbae69", "filename": "libgomp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b575376fbba16c3be9f607fbf53a6c841b3baae/libgomp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b575376fbba16c3be9f607fbf53a6c841b3baae/libgomp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2FChangeLog?ref=3b575376fbba16c3be9f607fbf53a6c841b3baae", "patch": "@@ -1,3 +1,8 @@\n+2017-11-23  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR fortran/81841\n+\t* libgomp.fortran/pr81841.f90: New test.\n+\n 2017-11-22  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR libgomp/83106"}, {"sha": "176d1c8d9c0c38136127ba11c163a85d649a4789", "filename": "libgomp/testsuite/libgomp.fortran/pr81841.f90", "status": "added", "additions": 26, "deletions": 0, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/3b575376fbba16c3be9f607fbf53a6c841b3baae/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr81841.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/3b575376fbba16c3be9f607fbf53a6c841b3baae/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr81841.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgomp%2Ftestsuite%2Flibgomp.fortran%2Fpr81841.f90?ref=3b575376fbba16c3be9f607fbf53a6c841b3baae", "patch": "@@ -0,0 +1,26 @@\n+! PR fortran/81841\n+! { dg-do run }\n+\n+block data\n+  integer :: a\n+  real :: b(2)\n+  common /c/ a, b\n+  !$omp threadprivate (/c/)\n+  data a / 32 /\n+  data b /2*1./\n+end\n+\n+program pr81841\n+  use omp_lib\n+  integer :: e\n+  real :: f(2)\n+  common /c/ e, f\n+  !$omp threadprivate (/c/)\n+  !$omp parallel num_threads(8)\n+  if ((e /= 32) .or. any(f /= 1.)) call abort\n+  e = omp_get_thread_num ()\n+  f = e + 19.\n+  !$omp barrier\n+  if ((e /= omp_get_thread_num ()) .or. any(f /= e + 19.)) call abort\n+  !$omp end parallel\n+end"}]}