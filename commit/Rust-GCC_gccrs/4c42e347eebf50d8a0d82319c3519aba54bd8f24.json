{"sha": "4c42e347eebf50d8a0d82319c3519aba54bd8f24", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGM0MmUzNDdlZWJmNTBkOGEwZDgyMzE5YzM1MTlhYmE1NGJkOGYyNA==", "commit": {"author": {"name": "Alexandre Oliva", "email": "aoliva@redhat.com", "date": "2000-12-05T22:53:33Z"}, "committer": {"name": "Alexandre Oliva", "email": "aoliva@gcc.gnu.org", "date": "2000-12-05T22:53:33Z"}, "message": "sched-vis.c (visual_tbl_line_length): New variable.\n\n* sched-vis.c (visual_tbl_line_length): New variable.\n(get_visual_tbl_length): Set it.\n(visualize_stall_cycles): Don't let stalls overrun\nvisual_tbl_line_length.\n\nFrom-SVN: r38053", "tree": {"sha": "5d96ca00a82e35473057e7ef5364495c39104f08", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/5d96ca00a82e35473057e7ef5364495c39104f08"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4c42e347eebf50d8a0d82319c3519aba54bd8f24", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c42e347eebf50d8a0d82319c3519aba54bd8f24", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c42e347eebf50d8a0d82319c3519aba54bd8f24", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c42e347eebf50d8a0d82319c3519aba54bd8f24/comments", "author": null, "committer": null, "parents": [{"sha": "b75d998f0e5752f78317475b43c9928dcd5d3ed9", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b75d998f0e5752f78317475b43c9928dcd5d3ed9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b75d998f0e5752f78317475b43c9928dcd5d3ed9"}], "stats": {"total": 32, "additions": 28, "deletions": 4}, "files": [{"sha": "ef557b2ad8b7fae7e254e3c351245a536334f83d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c42e347eebf50d8a0d82319c3519aba54bd8f24/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c42e347eebf50d8a0d82319c3519aba54bd8f24/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4c42e347eebf50d8a0d82319c3519aba54bd8f24", "patch": "@@ -1,3 +1,10 @@\n+2000-12-05  Alexandre Oliva  <aoliva@redhat.com>\n+\n+\t* sched-vis.c (visual_tbl_line_length): New variable.\n+\t(get_visual_tbl_length): Set it.\n+\t(visualize_stall_cycles): Don't let stalls overrun\n+\tvisual_tbl_line_length.\n+\n 2000-12-05  Geoffrey Keating  <geoffk@redhat.com>\n \n \t* global.c (global_conflicts): Allow for a REG_UNUSED note"}, {"sha": "99489c9d18df3249456e46e61922e7acfa42898b", "filename": "gcc/sched-vis.c", "status": "modified", "additions": 21, "deletions": 4, "changes": 25, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c42e347eebf50d8a0d82319c3519aba54bd8f24/gcc%2Fsched-vis.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c42e347eebf50d8a0d82319c3519aba54bd8f24/gcc%2Fsched-vis.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fsched-vis.c?ref=4c42e347eebf50d8a0d82319c3519aba54bd8f24", "patch": "@@ -82,6 +82,7 @@ insn_print_units (insn)\n #define MAX_VISUAL_LINES 100\n #define INSN_LEN 30\n int n_visual_lines;\n+static unsigned visual_tbl_line_length;\n char *visual_tbl;\n int n_vis_no_unit;\n rtx vis_no_unit[10];\n@@ -133,6 +134,8 @@ get_visual_tbl_length ()\n   n += n1;\n   n += strlen (\"\\n\") + 2;\n \n+  visual_tbl_line_length = n;\n+\n   /* Compute length of visualization string.  */\n   return (MAX_VISUAL_LINES * n);\n }\n@@ -897,6 +900,9 @@ visualize_stall_cycles (stalls)\n      int stalls;\n {\n   int i;\n+  const char *prefix = \";;       \";\n+  const char *suffix = \"\\n\";\n+  char *p;\n \n   /* If no more room, split table into two.  */\n   if (n_visual_lines >= MAX_VISUAL_LINES)\n@@ -907,10 +913,21 @@ visualize_stall_cycles (stalls)\n \n   n_visual_lines++;\n \n-  sprintf (visual_tbl + strlen (visual_tbl), \";;       \");\n-  for (i = 0; i < stalls; i++)\n-    sprintf (visual_tbl + strlen (visual_tbl), \".\");\n-  sprintf (visual_tbl + strlen (visual_tbl), \"\\n\");\n+  p = visual_tbl + strlen (visual_tbl);\n+  strcpy (p, prefix);\n+  p += strlen (prefix);\n+\n+  if ((unsigned)stalls >\n+      visual_tbl_line_length - strlen (prefix) - strlen (suffix))\n+    {\n+      suffix = \"[...]\\n\";\n+      stalls = visual_tbl_line_length - strlen (prefix) - strlen (suffix);\n+    }\n+\n+  memset (p, '.', stalls);\n+  p += stalls;\n+\n+  strcpy (p, suffix);\n }\n \n /* Allocate data used for visualization during scheduling.  */"}]}