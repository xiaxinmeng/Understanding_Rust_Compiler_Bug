{"sha": "6181bc30ab7b986f2de6119fc846cf0d58d3328a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NjE4MWJjMzBhYjdiOTg2ZjJkZTYxMTlmYzg0NmNmMGQ1OGQzMzI4YQ==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2016-04-28T19:33:34Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2016-04-28T19:33:34Z"}, "message": "re PR target/70858 (__builtin_ia32_bextr_u64 ICE with '-m32 -march=core-avx2')\n\n\tPR target/70858\n\t* config/i386/i386.c (bdesc_special_args): Add | OPTION_MASK_ISA_64BIT\n\tto __builtin_ia32_lwpval64 and __builtin_ia32_lwpins64.\n\t(bdesc_args): Add | OPTION_MASK_ISA_64BIT to __builtin_ia32_bextr_u64,\n\t__builtin_ia32_bextri_u64, __builtin_ia32_bzhi_di,\n\t__builtin_ia32_pdep_di and __builtin_ia32_pext_di.\n\n\t* gcc.target/i386/pr70858.c: New test.\n\nFrom-SVN: r235607", "tree": {"sha": "091b995c448754890f6c12fce1442adbff0fba95", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/091b995c448754890f6c12fce1442adbff0fba95"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6181bc30ab7b986f2de6119fc846cf0d58d3328a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6181bc30ab7b986f2de6119fc846cf0d58d3328a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6181bc30ab7b986f2de6119fc846cf0d58d3328a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6181bc30ab7b986f2de6119fc846cf0d58d3328a/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "77dbb21488422bbd30dbcfcaf34f3c9135f7732f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/77dbb21488422bbd30dbcfcaf34f3c9135f7732f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/77dbb21488422bbd30dbcfcaf34f3c9135f7732f"}], "stats": {"total": 73, "additions": 66, "deletions": 7}, "files": [{"sha": "2a23ed86b91222ec74d7deff6e0f1ffe9aad7a33", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6181bc30ab7b986f2de6119fc846cf0d58d3328a", "patch": "@@ -1,3 +1,12 @@\n+2016-04-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/70858\n+\t* config/i386/i386.c (bdesc_special_args): Add | OPTION_MASK_ISA_64BIT\n+\tto __builtin_ia32_lwpval64 and __builtin_ia32_lwpins64.\n+\t(bdesc_args): Add | OPTION_MASK_ISA_64BIT to __builtin_ia32_bextr_u64,\n+\t__builtin_ia32_bextri_u64, __builtin_ia32_bzhi_di,\n+\t__builtin_ia32_pdep_di and __builtin_ia32_pext_di.\n+\n 2016-04-28  Segher Boessenkool  <segher@kernel.crashing.org>\n \n \t* config/rs6000/rs6000.c (compute_save_world_info): Rename info_ptr"}, {"sha": "9680aaf3f5068f9ea0d2de4cf62bf97a4b742aef", "filename": "gcc/config/i386/i386.c", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2Fconfig%2Fi386%2Fi386.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2Fconfig%2Fi386%2Fi386.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fi386%2Fi386.c?ref=6181bc30ab7b986f2de6119fc846cf0d58d3328a", "patch": "@@ -32996,9 +32996,9 @@ static const struct builtin_description bdesc_special_args[] =\n   { OPTION_MASK_ISA_LWP, CODE_FOR_lwp_llwpcb, \"__builtin_ia32_llwpcb\", IX86_BUILTIN_LLWPCB, UNKNOWN, (int) VOID_FTYPE_PVOID },\n   { OPTION_MASK_ISA_LWP, CODE_FOR_lwp_slwpcb, \"__builtin_ia32_slwpcb\", IX86_BUILTIN_SLWPCB, UNKNOWN, (int) PVOID_FTYPE_VOID },\n   { OPTION_MASK_ISA_LWP, CODE_FOR_lwp_lwpvalsi3, \"__builtin_ia32_lwpval32\", IX86_BUILTIN_LWPVAL32, UNKNOWN, (int) VOID_FTYPE_UINT_UINT_UINT },\n-  { OPTION_MASK_ISA_LWP, CODE_FOR_lwp_lwpvaldi3, \"__builtin_ia32_lwpval64\", IX86_BUILTIN_LWPVAL64, UNKNOWN, (int) VOID_FTYPE_UINT64_UINT_UINT },\n+  { OPTION_MASK_ISA_LWP | OPTION_MASK_ISA_64BIT, CODE_FOR_lwp_lwpvaldi3, \"__builtin_ia32_lwpval64\", IX86_BUILTIN_LWPVAL64, UNKNOWN, (int) VOID_FTYPE_UINT64_UINT_UINT },\n   { OPTION_MASK_ISA_LWP, CODE_FOR_lwp_lwpinssi3, \"__builtin_ia32_lwpins32\", IX86_BUILTIN_LWPINS32, UNKNOWN, (int) UCHAR_FTYPE_UINT_UINT_UINT },\n-  { OPTION_MASK_ISA_LWP, CODE_FOR_lwp_lwpinsdi3, \"__builtin_ia32_lwpins64\", IX86_BUILTIN_LWPINS64, UNKNOWN, (int) UCHAR_FTYPE_UINT64_UINT_UINT },\n+  { OPTION_MASK_ISA_LWP | OPTION_MASK_ISA_64BIT, CODE_FOR_lwp_lwpinsdi3, \"__builtin_ia32_lwpins64\", IX86_BUILTIN_LWPINS64, UNKNOWN, (int) UCHAR_FTYPE_UINT64_UINT_UINT },\n \n   /* FSGSBASE */\n   { OPTION_MASK_ISA_FSGSBASE | OPTION_MASK_ISA_64BIT, CODE_FOR_rdfsbasesi, \"__builtin_ia32_rdfsbase32\", IX86_BUILTIN_RDFSBASE32, UNKNOWN, (int) UNSIGNED_FTYPE_VOID },\n@@ -33933,12 +33933,12 @@ static const struct builtin_description bdesc_args[] =\n \n   /* BMI */\n   { OPTION_MASK_ISA_BMI, CODE_FOR_bmi_bextr_si, \"__builtin_ia32_bextr_u32\", IX86_BUILTIN_BEXTR32, UNKNOWN, (int) UINT_FTYPE_UINT_UINT },\n-  { OPTION_MASK_ISA_BMI, CODE_FOR_bmi_bextr_di, \"__builtin_ia32_bextr_u64\", IX86_BUILTIN_BEXTR64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n+  { OPTION_MASK_ISA_BMI | OPTION_MASK_ISA_64BIT, CODE_FOR_bmi_bextr_di, \"__builtin_ia32_bextr_u64\", IX86_BUILTIN_BEXTR64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n   { OPTION_MASK_ISA_BMI, CODE_FOR_ctzhi2,       \"__builtin_ctzs\",           IX86_BUILTIN_CTZS,    UNKNOWN, (int) UINT16_FTYPE_UINT16 },\n \n   /* TBM */\n   { OPTION_MASK_ISA_TBM, CODE_FOR_tbm_bextri_si, \"__builtin_ia32_bextri_u32\", IX86_BUILTIN_BEXTRI32, UNKNOWN, (int) UINT_FTYPE_UINT_UINT },\n-  { OPTION_MASK_ISA_TBM, CODE_FOR_tbm_bextri_di, \"__builtin_ia32_bextri_u64\", IX86_BUILTIN_BEXTRI64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n+  { OPTION_MASK_ISA_TBM | OPTION_MASK_ISA_64BIT, CODE_FOR_tbm_bextri_di, \"__builtin_ia32_bextri_u64\", IX86_BUILTIN_BEXTRI64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n \n   /* F16C */\n   { OPTION_MASK_ISA_F16C, CODE_FOR_vcvtph2ps, \"__builtin_ia32_vcvtph2ps\", IX86_BUILTIN_CVTPH2PS, UNKNOWN, (int) V4SF_FTYPE_V8HI },\n@@ -33948,11 +33948,11 @@ static const struct builtin_description bdesc_args[] =\n \n   /* BMI2 */\n   { OPTION_MASK_ISA_BMI2, CODE_FOR_bmi2_bzhi_si3, \"__builtin_ia32_bzhi_si\", IX86_BUILTIN_BZHI32, UNKNOWN, (int) UINT_FTYPE_UINT_UINT },\n-  { OPTION_MASK_ISA_BMI2, CODE_FOR_bmi2_bzhi_di3, \"__builtin_ia32_bzhi_di\", IX86_BUILTIN_BZHI64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n+  { OPTION_MASK_ISA_BMI2 | OPTION_MASK_ISA_64BIT, CODE_FOR_bmi2_bzhi_di3, \"__builtin_ia32_bzhi_di\", IX86_BUILTIN_BZHI64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n   { OPTION_MASK_ISA_BMI2, CODE_FOR_bmi2_pdep_si3, \"__builtin_ia32_pdep_si\", IX86_BUILTIN_PDEP32, UNKNOWN, (int) UINT_FTYPE_UINT_UINT },\n-  { OPTION_MASK_ISA_BMI2, CODE_FOR_bmi2_pdep_di3, \"__builtin_ia32_pdep_di\", IX86_BUILTIN_PDEP64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n+  { OPTION_MASK_ISA_BMI2 | OPTION_MASK_ISA_64BIT, CODE_FOR_bmi2_pdep_di3, \"__builtin_ia32_pdep_di\", IX86_BUILTIN_PDEP64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n   { OPTION_MASK_ISA_BMI2, CODE_FOR_bmi2_pext_si3, \"__builtin_ia32_pext_si\", IX86_BUILTIN_PEXT32, UNKNOWN, (int) UINT_FTYPE_UINT_UINT },\n-  { OPTION_MASK_ISA_BMI2, CODE_FOR_bmi2_pext_di3, \"__builtin_ia32_pext_di\", IX86_BUILTIN_PEXT64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n+  { OPTION_MASK_ISA_BMI2 | OPTION_MASK_ISA_64BIT, CODE_FOR_bmi2_pext_di3, \"__builtin_ia32_pext_di\", IX86_BUILTIN_PEXT64, UNKNOWN, (int) UINT64_FTYPE_UINT64_UINT64 },\n \n   /* AVX512F */\n   { OPTION_MASK_ISA_AVX512F, CODE_FOR_avx512f_si512_256si, \"__builtin_ia32_si512_256si\", IX86_BUILTIN_SI512_SI256, UNKNOWN, (int) V16SI_FTYPE_V8SI },"}, {"sha": "595e3a8e016804bdf53440d8bbc376839331846b", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=6181bc30ab7b986f2de6119fc846cf0d58d3328a", "patch": "@@ -1,3 +1,8 @@\n+2016-04-28  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR target/70858\n+\t* gcc.target/i386/pr70858.c: New test.\n+\n 2016-04-28  Andrew Burgess  <andrew.burgess@embecosm.com>\n \n \t* gcc.target/arc/nps400-1.c: New file."}, {"sha": "99d7877346c14d1b1a2286fc6bc034ee44593d75", "filename": "gcc/testsuite/gcc.target/i386/pr70858.c", "status": "added", "additions": 45, "deletions": 0, "changes": 45, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr70858.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6181bc30ab7b986f2de6119fc846cf0d58d3328a/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr70858.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr70858.c?ref=6181bc30ab7b986f2de6119fc846cf0d58d3328a", "patch": "@@ -0,0 +1,45 @@\n+/* PR target/70858 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O2 -mlwp -mbmi -mtbm -mbmi2 -std=gnu11\" } */\n+\n+void\n+f1 (unsigned long long x, unsigned int y)\n+{\n+  __builtin_ia32_lwpval64 (x, y, 1);\t/* { dg-warning \"implicit declaration of function .__builtin_ia32_lwpval64.\" \"\" { target ia32 } } */\n+}\n+\n+char\n+f2 (unsigned long long x, unsigned int y)\n+{\n+  return __builtin_ia32_lwpins64 (x, y, 1);\t/* { dg-warning \"implicit declaration of function .__builtin_ia32_lwpins64.\" \"\" { target ia32 } } */\n+}\n+\n+unsigned long long\n+f3 (unsigned long long x, unsigned long long y)\n+{\n+  return __builtin_ia32_bextr_u64 (x, y);\t/* { dg-warning \"implicit declaration of function .__builtin_ia32_bextr_u64.\" \"\" { target ia32 } } */\n+}\n+\n+unsigned long long\n+f4 (unsigned long long x)\n+{\n+  return __builtin_ia32_bextri_u64 (x, 1);\t/* { dg-warning \"implicit declaration of function .__builtin_ia32_bextri_u64.\" \"\" { target ia32 } } */\n+}\n+\n+unsigned long long\n+f5 (unsigned long long x, unsigned long long y)\n+{\n+  return __builtin_ia32_bzhi_di (x, y);\t/* { dg-warning \"implicit declaration of function .__builtin_ia32_bzhi_di.\" \"\" { target ia32 } } */\n+}\n+\n+unsigned long long\n+f6 (unsigned long long x, unsigned long long y)\n+{\n+  return __builtin_ia32_pdep_di (x, y);\t/* { dg-warning \"implicit declaration of function .__builtin_ia32_pdep_di.\" \"\" { target ia32 } } */\n+}\n+\n+unsigned long long\n+f7 (unsigned long long x, unsigned long long y)\n+{\n+  return __builtin_ia32_pext_di (x, y);\t/* { dg-warning \"implicit declaration of function .__builtin_ia32_pext_di.\" \"\" { target ia32 } } */\n+}"}]}