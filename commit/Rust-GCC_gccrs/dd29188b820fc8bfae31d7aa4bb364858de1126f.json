{"sha": "dd29188b820fc8bfae31d7aa4bb364858de1126f", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZGQyOTE4OGI4MjBmYzhiZmFlMzFkN2FhNGJiMzY0ODU4ZGUxMTI2Zg==", "commit": {"author": {"name": "Nathan Sidwell", "email": "nathan@codesourcery.com", "date": "2002-09-18T13:08:34Z"}, "committer": {"name": "Nathan Sidwell", "email": "nathan@gcc.gnu.org", "date": "2002-09-18T13:08:34Z"}, "message": "decl.c (grokdeclarator): Use assert, not internal_error.\n\ncp:\n\t* decl.c (grokdeclarator): Use assert, not internal_error. Don't\n\tICE with invalid pointers & references.\ntestsuite:\n\t* g++.old-deja/g++.other/crash32.C: Mark ICE.\n\nFrom-SVN: r57277", "tree": {"sha": "704e26d54cebfc838e71744719a18a543a9adf2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/704e26d54cebfc838e71744719a18a543a9adf2a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/dd29188b820fc8bfae31d7aa4bb364858de1126f", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd29188b820fc8bfae31d7aa4bb364858de1126f", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dd29188b820fc8bfae31d7aa4bb364858de1126f", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dd29188b820fc8bfae31d7aa4bb364858de1126f/comments", "author": null, "committer": null, "parents": [{"sha": "5e7a8ee032347a12cfc8bcac117b028f4359ae0c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/5e7a8ee032347a12cfc8bcac117b028f4359ae0c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/5e7a8ee032347a12cfc8bcac117b028f4359ae0c"}], "stats": {"total": 37, "additions": 19, "deletions": 18}, "files": [{"sha": "6d6613f332ea7d7eefa946d3a35148dc9fbbcc0e", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=dd29188b820fc8bfae31d7aa4bb364858de1126f", "patch": "@@ -1,3 +1,8 @@\n+2002-09-18  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* decl.c (grokdeclarator): Use assert, not internal_error. Don't\n+\tICE with invalid pointers & references.\n+\n 2002-09-17  Zack Weinberg  <zack@codesourcery.com>\n \n \t* Make-lang.in: Remove all references to the demangler."}, {"sha": "92093a2c5d246cbc8cf63b114660f18c906a28c3", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 9, "deletions": 17, "changes": 26, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=dd29188b820fc8bfae31d7aa4bb364858de1126f", "patch": "@@ -10024,7 +10024,7 @@ grokdeclarator (declarator, declspecs, decl_context, initialized, attrlist)\n \t    break;\n \t    \n \t  default:\n-\t    internal_error (\"`%D' as declarator\", decl);\n+\t    my_friendly_assert (0, 20020917);\n \t  }\n       }\n   }\n@@ -10903,21 +10903,15 @@ grokdeclarator (declarator, declspecs, decl_context, initialized, attrlist)\n \n \t  if (TREE_CODE (type) == REFERENCE_TYPE)\n \t    {\n-\t      error (\"cannot declare %s to references\",\n-\t\t     TREE_CODE (declarator) == ADDR_EXPR\n-\t\t     ? \"references\" : \"pointers\");\n-\t      declarator = TREE_OPERAND (declarator, 0);\n-\t      continue;\n-\t    }\n-\n-\t  if (ctype\n-\t      && (TREE_CODE (type) == VOID_TYPE\n-\t\t  || TREE_CODE (type) == REFERENCE_TYPE))\n-\t    {\n-\t      error (\"cannot declare pointer to `%#T' member\",\n-\t\t\tTREE_TYPE (type));\n+\t      error (TREE_CODE (declarator) == ADDR_EXPR\n+\t\t     ? \"cannot declare reference to `%#T'\"\n+\t\t     : \"cannot declare pointer to `%#T'\", type);\n \t      type = TREE_TYPE (type);\n \t    }\n+\t  else if (VOID_TYPE_P (type)\n+\t\t   && (ctype || TREE_CODE (declarator) == ADDR_EXPR))\n+\t    error (ctype ? \"cannot declare pointer to `%#T' member\"\n+\t\t     : \"cannot declare reference to `%#T'\", type);\n \n \t  /* Merge any constancy or volatility into the target type\n \t     for the pointer.  */\n@@ -10928,9 +10922,7 @@ grokdeclarator (declarator, declspecs, decl_context, initialized, attrlist)\n \n \t  if (TREE_CODE (declarator) == ADDR_EXPR)\n \t    {\n-\t      if (TREE_CODE (type) == VOID_TYPE)\n-\t\terror (\"invalid type: `void &'\");\n-\t      else\n+\t      if (!VOID_TYPE_P (type))\n \t\ttype = build_reference_type (type);\n \t    }\n \t  else if (TREE_CODE (type) == METHOD_TYPE)"}, {"sha": "15d47ea8dab597ef43fefe6d2a58a6382b3cdaee", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=dd29188b820fc8bfae31d7aa4bb364858de1126f", "patch": "@@ -1,3 +1,7 @@\n+2002-09-18  Nathan Sidwell  <nathan@codesourcery.com>\n+\n+\t* g++.old-deja/g++.other/crash32.C: Mark ICE.\n+\n Tue Sep 17 13:59:45 2002  Nicola Pero  <n.pero@mi.flashnet.it>\n \n \t* objc.dg/comp-types-1.m: New test."}, {"sha": "9ff4c86fab42e1733562bf21fa5a9bd8d1d50fcb", "filename": "gcc/testsuite/g++.old-deja/g++.other/crash32.C", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcrash32.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/dd29188b820fc8bfae31d7aa4bb364858de1126f/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcrash32.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.old-deja%2Fg%2B%2B.other%2Fcrash32.C?ref=dd29188b820fc8bfae31d7aa4bb364858de1126f", "patch": "@@ -26,7 +26,7 @@ namespace N\n   typedef baz<bar> c;\n }\n \n-struct z\n+struct z // crash test - XFAIL *-*-*\n {\n   int a;\n };"}]}