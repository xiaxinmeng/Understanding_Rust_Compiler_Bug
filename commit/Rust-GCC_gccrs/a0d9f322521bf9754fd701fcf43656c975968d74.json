{"sha": "a0d9f322521bf9754fd701fcf43656c975968d74", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTBkOWYzMjI1MjFiZjk3NTRmZDcwMWZjZjQzNjU2Yzk3NTk2OGQ3NA==", "commit": {"author": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "1998-09-03T14:07:51Z"}, "committer": {"name": "Benjamin Kosnik", "email": "bkoz@gcc.gnu.org", "date": "1998-09-03T14:07:51Z"}, "message": "decl.c (pushdecl_class_level): Add warning here.\n\nP\n1998-09-03  Benjamin Kosnik  <bkoz@rhino.cygnus.com>\n        * decl.c (pushdecl_class_level): Add warning here.\n        (pushdecl): Tweak.\n\nFrom-SVN: r22210", "tree": {"sha": "ad752fe453e170963d2ee1143d7d05a25d7160a5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/ad752fe453e170963d2ee1143d7d05a25d7160a5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a0d9f322521bf9754fd701fcf43656c975968d74", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0d9f322521bf9754fd701fcf43656c975968d74", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a0d9f322521bf9754fd701fcf43656c975968d74", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a0d9f322521bf9754fd701fcf43656c975968d74/comments", "author": null, "committer": null, "parents": [{"sha": "343a4a0e15fe6669d3c9cc3ed8b8cacb01eb7a2c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/343a4a0e15fe6669d3c9cc3ed8b8cacb01eb7a2c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/343a4a0e15fe6669d3c9cc3ed8b8cacb01eb7a2c"}], "stats": {"total": 18, "additions": 15, "deletions": 3}, "files": [{"sha": "6fb4c148e153f1032bfa9d7793e1f23ab651bc57", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 15, "deletions": 3, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a0d9f322521bf9754fd701fcf43656c975968d74/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a0d9f322521bf9754fd701fcf43656c975968d74/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=a0d9f322521bf9754fd701fcf43656c975968d74", "patch": "@@ -3671,12 +3671,12 @@ pushdecl (x)\n \t\twarning (warnstring, IDENTIFIER_POINTER (name));\n \t    }\n \t  /* Check to see if decl redeclares a template parameter. */\n- \t  if (oldlocal && (current_class_type || current_function_decl ) \n+ \t  if (oldlocal && (current_class_type || current_function_decl) \n  \t      && current_template_parms)\n  \t    {\n  \t      if (decl_template_parm_p (oldlocal))\n  \t\t{\n- \t\t  cp_error (\"redeclaration of template parameter `%T'\", name);\n+\t\t  cp_error (\"re-using name of template parameter `%T' in this scope\", name);\n  \t\t  cp_error_at (\" previously declared here `%#D'\", oldlocal);\n  \t\t}\n  \t    }\n@@ -3812,10 +3812,10 @@ pushdecl_class_level (x)\n \t{\n \t  /* A name N used in a class S shall refer to the same declaration\n \t     in its context and when re-evaluated in the completed scope of S.\n-\n \t     Types, enums, and static vars are checked here; other\n \t     members are checked in finish_struct.  */\n \t  tree icv = IDENTIFIER_CLASS_VALUE (name);\n+\t  tree ilv = IDENTIFIER_LOCAL_VALUE (name);\n \n \t  if (icv && icv != x\n \t      && flag_optional_diags\n@@ -3829,6 +3829,18 @@ pushdecl_class_level (x)\n \t      cp_pedwarn_at (\"conflicts with previous use in class as `%#D'\",\n \t\t\t     icv);\n \t    }\n+\n+\t  /* Check to see if decl redeclares a template parameter. */\n+\t  if (ilv && ! decls_match (ilv, x)\n+\t      && (current_class_type || current_function_decl) \n+\t      && current_template_parms)\n+\t    {\n+\t      if (decl_template_parm_p (ilv))\n+\t\t{\n+\t\t  cp_error (\"re-using name of template parameter `%T' in this scope\", name);\n+\t\t  cp_error_at (\" previously declared here `%#D'\", ilv);\n+\t\t}\n+\t    }\n \t}\n \n       push_class_level_binding (name, x);"}]}