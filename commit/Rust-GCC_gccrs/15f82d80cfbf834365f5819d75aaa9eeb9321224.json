{"sha": "15f82d80cfbf834365f5819d75aaa9eeb9321224", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MTVmODJkODBjZmJmODM0MzY1ZjU4MTlkNzVhYWE5ZWViOTMyMTIyNA==", "commit": {"author": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-11-25T19:52:20Z"}, "committer": {"name": "Jan Hubicka", "email": "jh@suse.cz", "date": "2020-11-25T19:52:20Z"}, "message": "New ipa-modref testcases\n\ngcc/testsuite/ChangeLog:\n\t* gcc.dg/lto/modref-3_0.c: New test.\n\t* gcc.dg/lto/modref-3_1.c: New test.\n\t* gcc.dg/lto/modref-4_0.c: New test.\n\t* gcc.dg/lto/modref-4_1.c: New test.\n\t* gcc.dg/tree-ssa/modref-5.c: New test.", "tree": {"sha": "0127351f00b212d0d1f7fc388f8e68a28edfe200", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0127351f00b212d0d1f7fc388f8e68a28edfe200"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/15f82d80cfbf834365f5819d75aaa9eeb9321224", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15f82d80cfbf834365f5819d75aaa9eeb9321224", "html_url": "https://github.com/Rust-GCC/gccrs/commit/15f82d80cfbf834365f5819d75aaa9eeb9321224", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/15f82d80cfbf834365f5819d75aaa9eeb9321224/comments", "author": null, "committer": null, "parents": [{"sha": "bb07490abba850fd5b1d2d09d76d18b8bdc7d817", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/bb07490abba850fd5b1d2d09d76d18b8bdc7d817", "html_url": "https://github.com/Rust-GCC/gccrs/commit/bb07490abba850fd5b1d2d09d76d18b8bdc7d817"}], "stats": {"total": 87, "additions": 87, "deletions": 0}, "files": [{"sha": "bd8f96f6ec4cdeb51fe88746e1a5603e2c9c0e05", "filename": "gcc/testsuite/gcc.dg/lto/modref-3_0.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-3_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-3_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-3_0.c?ref=15f82d80cfbf834365f5819d75aaa9eeb9321224", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-lto-do run } */\n+/* { dg-lto-options { {-O2 -flto-partition=max -fdump-ipa-modref -fno-ipa-sra -fno-ipa-cp -flto} } } */\n+extern void copy (int *a, int *b);\n+extern void barrier ();\n+extern int *ptr;\n+int\n+main()\n+{\n+  int a = 1, b = 2;\n+  copy (&a,&b);\n+  barrier ();\n+  *ptr = 1;\n+  if (!__builtin_constant_p (b == 2))\n+    __builtin_abort ();\n+  return 0;\n+}\n+/* { dg-final { scan-wpa-ipa-dump \"parm 1 flags: nodirectescape\"  \"modref\"  } } */"}, {"sha": "c36f3d1b482e12f0e707c8963a99a29ca3faa5ec", "filename": "gcc/testsuite/gcc.dg/lto/modref-3_1.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-3_1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-3_1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-3_1.c?ref=15f82d80cfbf834365f5819d75aaa9eeb9321224", "patch": "@@ -0,0 +1,13 @@\n+__attribute__ ((noinline))\n+void\n+copy (int *a, int *b)\n+{\n+  *a=*b;\n+}\n+int p, *ptr = &p;\n+__attribute__ ((noinline))\n+void\n+barrier ()\n+{\n+  asm (\"\":\"=r\"(ptr):\"0\"(ptr));\n+}"}, {"sha": "db90b4f1f3d2ca40e94f66a9106cead6906ecd06", "filename": "gcc/testsuite/gcc.dg/lto/modref-4_0.c", "status": "added", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-4_0.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-4_0.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-4_0.c?ref=15f82d80cfbf834365f5819d75aaa9eeb9321224", "patch": "@@ -0,0 +1,17 @@\n+/* { dg-lto-do run } */\n+/* { dg-lto-options { {-O2 -flto-partition=max -fdump-ipa-modref -fno-ipa-sra -flto} } } */\n+extern void copy (int *a, int *b);\n+extern void barrier ();\n+extern int *ptr;\n+int\n+main()\n+{\n+  int a = 1, b = 2;\n+  copy (&a,&b);\n+  barrier ();\n+  *ptr = 1;\n+  if (!__builtin_constant_p (b == 2))\n+    __builtin_abort ();\n+  return 0;\n+}\n+/* { dg-final { scan-wpa-ipa-dump \"parm 1 flags: nodirectescape\"  \"modref\"  } } */"}, {"sha": "c36f3d1b482e12f0e707c8963a99a29ca3faa5ec", "filename": "gcc/testsuite/gcc.dg/lto/modref-4_1.c", "status": "added", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-4_1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-4_1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Flto%2Fmodref-4_1.c?ref=15f82d80cfbf834365f5819d75aaa9eeb9321224", "patch": "@@ -0,0 +1,13 @@\n+__attribute__ ((noinline))\n+void\n+copy (int *a, int *b)\n+{\n+  *a=*b;\n+}\n+int p, *ptr = &p;\n+__attribute__ ((noinline))\n+void\n+barrier ()\n+{\n+  asm (\"\":\"=r\"(ptr):\"0\"(ptr));\n+}"}, {"sha": "fde317728622faaf8809ab364c56a50044b64bb8", "filename": "gcc/testsuite/gcc.dg/tree-ssa/modref-5.c", "status": "added", "additions": 27, "deletions": 0, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fmodref-5.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/15f82d80cfbf834365f5819d75aaa9eeb9321224/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fmodref-5.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Ftree-ssa%2Fmodref-5.c?ref=15f82d80cfbf834365f5819d75aaa9eeb9321224", "patch": "@@ -0,0 +1,27 @@\n+/* { dg-options \"-O2 -fdump-tree-modref1\"  } */\n+/* { dg-do run } */\n+__attribute__ ((noinline))\n+void\n+copy (int *a, int *b)\n+{\n+  *a=*b;\n+}\n+int p, *ptr = &p;\n+__attribute__ ((noinline))\n+void\n+barrier ()\n+{\n+  asm (\"\":\"=r\"(ptr):\"0\"(ptr));\n+}\n+int\n+main()\n+{\n+  int a = 1, b = 2;\n+  copy (&a,&b);\n+  barrier ();\n+  *ptr = 1;\n+  if (!__builtin_constant_p (b == 2))\n+    __builtin_abort ();\n+  return 0;\n+}\n+/* { dg-final { scan-tree-dump \"parm 1 flags: nodirectescape\" \"modref1\"  } } */"}]}