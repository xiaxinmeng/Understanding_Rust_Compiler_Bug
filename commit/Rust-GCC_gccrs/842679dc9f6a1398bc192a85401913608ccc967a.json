{"sha": "842679dc9f6a1398bc192a85401913608ccc967a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ODQyNjc5ZGM5ZjZhMTM5OGJjMTkyYTg1NDAxOTEzNjA4Y2NjOTY3YQ==", "commit": {"author": {"name": "Tom de Vries", "email": "tom@codesourcery.com", "date": "2012-01-27T10:38:27Z"}, "committer": {"name": "Tom de Vries", "email": "vries@gcc.gnu.org", "date": "2012-01-27T10:38:27Z"}, "message": "re PR tree-optimization/51990 (ICE in copy_reference_ops_from_ref)\n\n2012-01-27  Tom de Vries  <tom@codesourcery.com>\n\n\tPR tree-optimization/51990\n\t* tree-ssa-sccvn.c (copy_reference_ops_from_ref): Handle WITH_SIZE_EXPR.\n\t* tree-ssa-pre.c (create_component_ref_by_pieces_1): Same.\n\nFrom-SVN: r183614", "tree": {"sha": "9a8042fec460d9be1c160f2bdb81880a5e095a2a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/9a8042fec460d9be1c160f2bdb81880a5e095a2a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/842679dc9f6a1398bc192a85401913608ccc967a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/842679dc9f6a1398bc192a85401913608ccc967a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/842679dc9f6a1398bc192a85401913608ccc967a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/842679dc9f6a1398bc192a85401913608ccc967a/comments", "author": null, "committer": null, "parents": [{"sha": "4daa71b06377971c08341ff1664438de55dd5603", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4daa71b06377971c08341ff1664438de55dd5603", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4daa71b06377971c08341ff1664438de55dd5603"}], "stats": {"total": 28, "additions": 28, "deletions": 0}, "files": [{"sha": "e7fb05d9bad32fa9cd4881911d0279335b0ad330", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/842679dc9f6a1398bc192a85401913608ccc967a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/842679dc9f6a1398bc192a85401913608ccc967a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=842679dc9f6a1398bc192a85401913608ccc967a", "patch": "@@ -1,3 +1,9 @@\n+2012-01-27  Tom de Vries  <tom@codesourcery.com>\n+\n+\tPR tree-optimization/51990\n+\t* tree-ssa-sccvn.c (copy_reference_ops_from_ref): Handle WITH_SIZE_EXPR.\n+\t* tree-ssa-pre.c (create_component_ref_by_pieces_1): Same.\n+\n 2012-01-27  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/52001"}, {"sha": "71f945fc49175e87340bd906ae4d33d7bcd93d8f", "filename": "gcc/tree-ssa-pre.c", "status": "modified", "additions": 17, "deletions": 0, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/842679dc9f6a1398bc192a85401913608ccc967a/gcc%2Ftree-ssa-pre.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/842679dc9f6a1398bc192a85401913608ccc967a/gcc%2Ftree-ssa-pre.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-pre.c?ref=842679dc9f6a1398bc192a85401913608ccc967a", "patch": "@@ -2792,6 +2792,23 @@ create_component_ref_by_pieces_1 (basic_block block, vn_reference_t ref,\n \treturn folded;\n       }\n       break;\n+    case WITH_SIZE_EXPR:\n+      {\n+\ttree genop0 = create_component_ref_by_pieces_1 (block, ref, operand,\n+\t\t\t\t\t\t\tstmts, domstmt);\n+\tpre_expr op1expr = get_or_alloc_expr_for (currop->op0);\n+\ttree genop1;\n+\n+\tif (!genop0)\n+\t  return NULL_TREE;\n+\n+\tgenop1 = find_or_generate_expression (block, op1expr, stmts, domstmt);\n+\tif (!genop1)\n+\t  return NULL_TREE;\n+\n+\treturn fold_build2 (currop->opcode, currop->type, genop0, genop1);\n+      }\n+      break;\n     case BIT_FIELD_REF:\n       {\n \ttree folded;"}, {"sha": "fdebe477a3a08e972638f03693fd3c87dedd77df", "filename": "gcc/tree-ssa-sccvn.c", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/842679dc9f6a1398bc192a85401913608ccc967a/gcc%2Ftree-ssa-sccvn.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/842679dc9f6a1398bc192a85401913608ccc967a/gcc%2Ftree-ssa-sccvn.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-ssa-sccvn.c?ref=842679dc9f6a1398bc192a85401913608ccc967a", "patch": "@@ -628,6 +628,10 @@ copy_reference_ops_from_ref (tree ref, VEC(vn_reference_op_s, heap) **result)\n \n       switch (temp.opcode)\n \t{\n+\tcase WITH_SIZE_EXPR:\n+\t  temp.op0 = TREE_OPERAND (ref, 1);\n+\t  temp.off = 0;\n+\t  break;\n \tcase MEM_REF:\n \t  /* The base address gets its own vn_reference_op_s structure.  */\n \t  temp.op0 = TREE_OPERAND (ref, 1);\n@@ -744,6 +748,7 @@ copy_reference_ops_from_ref (tree ref, VEC(vn_reference_op_s, heap) **result)\n       VEC_safe_push (vn_reference_op_s, heap, *result, &temp);\n \n       if (REFERENCE_CLASS_P (ref)\n+\t  || TREE_CODE (ref) == WITH_SIZE_EXPR\n \t  || (TREE_CODE (ref) == ADDR_EXPR\n \t      && !is_gimple_min_invariant (ref)))\n \tref = TREE_OPERAND (ref, 0);"}]}