{"sha": "f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6ZjgyNzkzMGFlMjgyZjhhZTRiZWRmMGEzOGRiYzJmYTk5ZDJiM2QwOA==", "commit": {"author": {"name": "Marek Polacek", "email": "polacek@redhat.com", "date": "2014-05-08T17:42:09Z"}, "committer": {"name": "Marek Polacek", "email": "mpolacek@gcc.gnu.org", "date": "2014-05-08T17:42:09Z"}, "message": "re PR c/61077 (_Atomic in the return type or argument types of main not diagnosed)\n\n\tPR c/61077\nc-family/\n\t* c-common.c (check_main_parameter_types): Warn for _Atomic-qualified\n\tparameter type of main.\nc/\n\t* c-decl.c (start_function): Warn for _Atomic-qualified return type\n\tof main.\ntestsuite/\n\t* gcc.dg/pr61077.c: New test.\n\nFrom-SVN: r210229", "tree": {"sha": "761bbf96a5b2bd42adfa8daa925ffb28083fc9f5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/761bbf96a5b2bd42adfa8daa925ffb28083fc9f5"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/comments", "author": {"login": "mpolacek", "id": 10496300, "node_id": "MDQ6VXNlcjEwNDk2MzAw", "avatar_url": "https://avatars.githubusercontent.com/u/10496300?v=4", "gravatar_id": "", "url": "https://api.github.com/users/mpolacek", "html_url": "https://github.com/mpolacek", "followers_url": "https://api.github.com/users/mpolacek/followers", "following_url": "https://api.github.com/users/mpolacek/following{/other_user}", "gists_url": "https://api.github.com/users/mpolacek/gists{/gist_id}", "starred_url": "https://api.github.com/users/mpolacek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mpolacek/subscriptions", "organizations_url": "https://api.github.com/users/mpolacek/orgs", "repos_url": "https://api.github.com/users/mpolacek/repos", "events_url": "https://api.github.com/users/mpolacek/events{/privacy}", "received_events_url": "https://api.github.com/users/mpolacek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "f0fd118f53ae2ba7384a94c6821458275e6c226c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f0fd118f53ae2ba7384a94c6821458275e6c226c", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f0fd118f53ae2ba7384a94c6821458275e6c226c"}], "stats": {"total": 46, "additions": 46, "deletions": 0}, "files": [{"sha": "06a1b1468beddba0083e6f4fb0c2438b0301408e", "filename": "gcc/c-family/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc-family%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc-family%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2FChangeLog?ref=f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "patch": "@@ -1,3 +1,9 @@\n+2014-05-08  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/61077\n+\t* c-common.c (check_main_parameter_types): Warn for _Atomic-qualified\n+\tparameter type of main.\n+\n 2014-05-07  DJ Delorie  <dj@redhat.com>\n \n \t* c-cppbuiltin.c (print_bits_of_hex): New."}, {"sha": "33ad25087731f957e243a871e2b05ab43f53060a", "filename": "gcc/c-family/c-common.c", "status": "modified", "additions": 14, "deletions": 0, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc-family%2Fc-common.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc-family%2Fc-common.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc-family%2Fc-common.c?ref=f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "patch": "@@ -2193,6 +2193,20 @@ check_main_parameter_types (tree decl)\n       if (type == void_type_node || type == error_mark_node )\n \tbreak;\n \n+      tree t = type;\n+      if (TYPE_ATOMIC (t))\n+\t  pedwarn (input_location, OPT_Wmain,\n+\t\t   \"%<_Atomic%>-qualified parameter type %qT of %q+D\",\n+\t\t   type, decl);\n+      while (POINTER_TYPE_P (t))\n+\t{\n+\t  t = TREE_TYPE (t);\n+\t  if (TYPE_ATOMIC (t))\n+\t    pedwarn (input_location, OPT_Wmain,\n+\t\t     \"%<_Atomic%>-qualified parameter type %qT of %q+D\",\n+\t\t     type, decl);\n+\t}\n+\n       ++argct;\n       switch (argct)\n \t{"}, {"sha": "892537147d01cf5c647b15404dcf6b952b8aa629", "filename": "gcc/c/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2FChangeLog?ref=f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "patch": "@@ -1,3 +1,9 @@\n+2014-05-08  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/61077\n+\t* c-decl.c (start_function): Warn for _Atomic-qualified return type\n+\tof main.\n+\n 2014-05-06  Kenneth Zadeck  <zadeck@naturalbridge.com>\n \t    Mike Stump  <mikestump@comcast.net>\n \t    Richard Sandiford  <rdsandiford@googlemail.com>"}, {"sha": "d8631fc3345012f61d1b9792f999099a1dda8573", "filename": "gcc/c/c-decl.c", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc%2Fc-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Fc%2Fc-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fc%2Fc-decl.c?ref=f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "patch": "@@ -8045,6 +8045,9 @@ start_function (struct c_declspecs *declspecs, struct c_declarator *declarator,\n       if (TYPE_MAIN_VARIANT (TREE_TYPE (TREE_TYPE (decl1)))\n \t  != integer_type_node)\n \tpedwarn (loc, OPT_Wmain, \"return type of %qD is not %<int%>\", decl1);\n+      else if (TYPE_ATOMIC (TREE_TYPE (TREE_TYPE (decl1))))\n+\tpedwarn (loc, OPT_Wmain, \"%<_Atomic%>-qualified return type of %qD\",\n+\t\t decl1);\n \n       check_main_parameter_types (decl1);\n "}, {"sha": "fe0683e511ecff47c7fac0b34652f137e6b8afbb", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "patch": "@@ -1,3 +1,8 @@\n+2014-05-08  Marek Polacek  <polacek@redhat.com>\n+\n+\tPR c/61077\n+\t* gcc.dg/pr61077.c: New test.\n+\n 2014-05-08  Tobias Burnus  <burnus@net-b.de>\n \n \t* gfortran.dg/coarray_collectives_1.f90: New."}, {"sha": "c0513f71f70d3f4a1d92fcb7c6b6eae3d4fb3b4d", "filename": "gcc/testsuite/gcc.dg/pr61077.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Ftestsuite%2Fgcc.dg%2Fpr61077.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08/gcc%2Ftestsuite%2Fgcc.dg%2Fpr61077.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr61077.c?ref=f827930ae282f8ae4bedf0a38dbc2fa99d2b3d08", "patch": "@@ -0,0 +1,12 @@\n+/* PR c/61077 */\n+/* { dg-do compile } */\n+/* { dg-options \"-std=c11 -Wall\" } */\n+\n+_Atomic int\n+main (_Atomic int argc, _Atomic char **argv)\n+/* { dg-warning \"qualified return type\" \"return\" { target *-*-* } 6 } */\n+/* { dg-warning \"qualified parameter type.*int\" \"parameter\" { target *-*-* } 6 } */\n+/* { dg-warning \"qualified parameter type.*char\" \"parameter\" { target *-*-* } 6 } */\n+{\n+  return 0;\n+}"}]}