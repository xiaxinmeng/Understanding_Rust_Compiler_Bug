{"sha": "9c2d872c6a923bf0ae86c6e0576041fba6e529b9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6OWMyZDg3MmM2YTkyM2JmMGFlODZjNmUwNTc2MDQxZmJhNmU1MjliOQ==", "commit": {"author": {"name": "Pascal Obry", "email": "obry@adacore.com", "date": "2005-03-15T16:02:26Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2005-03-15T16:02:26Z"}, "message": "re PR ada/20226 (Error in __gnat_install_SEH_handler breaks bootstrap)\n\n2005-03-08  Pascal Obry  <obry@adacore.com>\n\t    Eric Botcazou  <ebotcazou@adacore.com>\n\n\tPR ada/20226\n\tPR ada/20344\n\n\t* init.c (__gnat_initialize): Do not call __gnat_install_SEH_handler()\n\twhen IN_RTS. This is to work around a bootstrap path problem.\n\n\t* misc.c (gnat_parse_file): Create a SEH (Structured Exception Handler)\n\ttable and pass it to __gnat_install_SEH_handler().\n\t(gnat_handle_option): Accept OPT_fRTS_, not OPT_fRTS.\n\n\t* lang.opt: Fix specification of -fRTS=.\n\nFrom-SVN: r96499", "tree": {"sha": "0c8eec9b45ad084aa3c15b43318cdbc80835d66f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0c8eec9b45ad084aa3c15b43318cdbc80835d66f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/9c2d872c6a923bf0ae86c6e0576041fba6e529b9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c2d872c6a923bf0ae86c6e0576041fba6e529b9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/9c2d872c6a923bf0ae86c6e0576041fba6e529b9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/9c2d872c6a923bf0ae86c6e0576041fba6e529b9/comments", "author": {"login": "TurboGit", "id": 467069, "node_id": "MDQ6VXNlcjQ2NzA2OQ==", "avatar_url": "https://avatars.githubusercontent.com/u/467069?v=4", "gravatar_id": "", "url": "https://api.github.com/users/TurboGit", "html_url": "https://github.com/TurboGit", "followers_url": "https://api.github.com/users/TurboGit/followers", "following_url": "https://api.github.com/users/TurboGit/following{/other_user}", "gists_url": "https://api.github.com/users/TurboGit/gists{/gist_id}", "starred_url": "https://api.github.com/users/TurboGit/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/TurboGit/subscriptions", "organizations_url": "https://api.github.com/users/TurboGit/orgs", "repos_url": "https://api.github.com/users/TurboGit/repos", "events_url": "https://api.github.com/users/TurboGit/events{/privacy}", "received_events_url": "https://api.github.com/users/TurboGit/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "454ff542f82f1320a05f8423691bf9a9890b21d3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/454ff542f82f1320a05f8423691bf9a9890b21d3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/454ff542f82f1320a05f8423691bf9a9890b21d3"}], "stats": {"total": 22, "additions": 16, "deletions": 6}, "files": [{"sha": "584220c2ea8dd1c4395abbe3fa9b78d55fc03843", "filename": "gcc/ada/lang.opt", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c2d872c6a923bf0ae86c6e0576041fba6e529b9/gcc%2Fada%2Flang.opt", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c2d872c6a923bf0ae86c6e0576041fba6e529b9/gcc%2Fada%2Flang.opt", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Flang.opt?ref=9c2d872c6a923bf0ae86c6e0576041fba6e529b9", "patch": "@@ -57,8 +57,9 @@ nostdlib\n Ada\n ; Don't look for object files\n \n-fRTS\n-Ada RejectNegative\n+fRTS=\n+Ada Joined RejectNegative\n+; Selects the runtime\n \n gant\n Ada Joined Undocumented"}, {"sha": "4646c863e8a22138ebede87831ae98af01c6d7ec", "filename": "gcc/ada/misc.c", "status": "modified", "additions": 13, "deletions": 4, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/9c2d872c6a923bf0ae86c6e0576041fba6e529b9/gcc%2Fada%2Fmisc.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/9c2d872c6a923bf0ae86c6e0576041fba6e529b9/gcc%2Fada%2Fmisc.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmisc.c?ref=9c2d872c6a923bf0ae86c6e0576041fba6e529b9", "patch": "@@ -217,18 +217,27 @@ extern char **gnat_argv;\n \n \f\n /* Declare functions we use as part of startup.  */\n-extern void __gnat_initialize\t(void *);\n-extern void adainit\t\t(void);\n-extern void _ada_gnat1drv\t(void);\n+extern void __gnat_initialize           (void *);\n+extern void __gnat_install_SEH_handler  (void *);\n+extern void adainit\t\t        (void);\n+extern void _ada_gnat1drv\t        (void);\n \n /* The parser for the language.  For us, we process the GNAT tree.  */\n \n static void\n gnat_parse_file (int set_yydebug ATTRIBUTE_UNUSED)\n {\n+  int seh[2];\n+\n   /* call the target specific initializations */\n   __gnat_initialize (NULL);\n \n+  /* ??? call the SEH initialization routine, this is to workaround a\n+  bootstrap path problem. The call below should be removed at some point and\n+  the seh pointer passed to __gnat_initialize() above.  */\n+\n+  __gnat_install_SEH_handler((void *)seh);\n+\n   /* Call the front-end elaboration procedures */\n   adainit ();\n \n@@ -289,7 +298,7 @@ gnat_handle_option (size_t scode, const char *arg, int value ATTRIBUTE_UNUSED)\n       gnat_argc++;\n       break;\n \n-    case OPT_fRTS:\n+    case OPT_fRTS_:\n       gnat_argv[gnat_argc] = xstrdup (\"-fRTS\");\n       gnat_argc++;\n       break;"}]}