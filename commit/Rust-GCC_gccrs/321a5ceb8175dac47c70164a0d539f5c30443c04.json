{"sha": "321a5ceb8175dac47c70164a0d539f5c30443c04", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzIxYTVjZWI4MTc1ZGFjNDdjNzAxNjRhMGQ1MzlmNWMzMDQ0M2MwNA==", "commit": {"author": {"name": "Ilya Enkovich", "email": "ilya.enkovich@intel.com", "date": "2015-03-02T10:41:09Z"}, "committer": {"name": "Ilya Enkovich", "email": "ienkovich@gcc.gnu.org", "date": "2015-03-02T10:41:09Z"}, "message": "re PR target/65183 (ICE: verify_ssa failed: virtual use of statement not up-to-date with -fcheck-pointer-bounds -fchkp-use-nochk-string-functions -mmpx)\n\ngcc/\n\n\tPR target/65183\n\t* tree-chkp.c (chkp_check_lower): Don't check against\n\tzero bounds for already instrumented functions.\n\t(chkp_check_upper): Likewise.\n\t(chkp_fini): Clean pass local data to avoid wrong reusage.\n\ngcc/testsuite/\n\n\tPR target/65183\n\t* gcc.target/i386/pr65183.c: New.\n\nFrom-SVN: r221105", "tree": {"sha": "90da3fc9b505fc9769972fb7a167562094f37702", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/90da3fc9b505fc9769972fb7a167562094f37702"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/321a5ceb8175dac47c70164a0d539f5c30443c04", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/321a5ceb8175dac47c70164a0d539f5c30443c04", "html_url": "https://github.com/Rust-GCC/gccrs/commit/321a5ceb8175dac47c70164a0d539f5c30443c04", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/321a5ceb8175dac47c70164a0d539f5c30443c04/comments", "author": {"login": "ienkovich", "id": 18308708, "node_id": "MDQ6VXNlcjE4MzA4NzA4", "avatar_url": "https://avatars.githubusercontent.com/u/18308708?v=4", "gravatar_id": "", "url": "https://api.github.com/users/ienkovich", "html_url": "https://github.com/ienkovich", "followers_url": "https://api.github.com/users/ienkovich/followers", "following_url": "https://api.github.com/users/ienkovich/following{/other_user}", "gists_url": "https://api.github.com/users/ienkovich/gists{/gist_id}", "starred_url": "https://api.github.com/users/ienkovich/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/ienkovich/subscriptions", "organizations_url": "https://api.github.com/users/ienkovich/orgs", "repos_url": "https://api.github.com/users/ienkovich/repos", "events_url": "https://api.github.com/users/ienkovich/events{/privacy}", "received_events_url": "https://api.github.com/users/ienkovich/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "3307944165badd8271df1598b574b4dd7a733f37", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/3307944165badd8271df1598b574b4dd7a733f37", "html_url": "https://github.com/Rust-GCC/gccrs/commit/3307944165badd8271df1598b574b4dd7a733f37"}], "stats": {"total": 43, "additions": 41, "deletions": 2}, "files": [{"sha": "5850dc40bbb35d62ccd9830faeca51fb1141569c", "filename": "gcc/ChangeLog", "status": "modified", "additions": 8, "deletions": 0, "changes": 8, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=321a5ceb8175dac47c70164a0d539f5c30443c04", "patch": "@@ -1,3 +1,11 @@\n+2015-03-02  Ilya Enkovich  <ilya.enkovich@intel.com>\n+\n+\tPR target/65183\n+\t* tree-chkp.c (chkp_check_lower): Don't check against\n+\tzero bounds for already instrumented functions.\n+\t(chkp_check_upper): Likewise.\n+\t(chkp_fini): Clean pass local data to avoid wrong reusage.\n+\n 2015-02-28  Martin Liska  <mliska@suse.cz>\n \t    Jan Hubicka   <hubicka@ucw.cz>\n "}, {"sha": "c1584168c8d42f3b14d280c93e9c8f4454cbf1bd", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=321a5ceb8175dac47c70164a0d539f5c30443c04", "patch": "@@ -1,3 +1,8 @@\n+2015-03-02  Ilya Enkovich  <ilya.enkovich@intel.com>\n+\n+\tPR target/65183\n+\t* gcc.target/i386/pr65183.c: New.\n+\n 2015-02-28  Martin Liska  <mliska@suse.cz>\n \t    Jan Hubicka   <hubicka@ucw.cz>\n "}, {"sha": "069a543af367e0aeaca185071f3e00f87a7a1d83", "filename": "gcc/testsuite/gcc.target/i386/pr65183.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr65183.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr65183.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.target%2Fi386%2Fpr65183.c?ref=321a5ceb8175dac47c70164a0d539f5c30443c04", "patch": "@@ -0,0 +1,20 @@\n+/* { dg-do compile } */\n+/* { dg-require-effective-target mpx } */\n+/* { dg-options \"-O -fcheck-pointer-bounds -fchkp-use-nochk-string-functions -mmpx\" } */\n+\n+extern void bar(void *);\n+extern void baz(void);\n+\n+static int lc[32];\n+\n+void foobar(void *c)\n+{\n+  bar(&c);\n+  __builtin_memcpy (lc, c, lc[0]);\n+}\n+\n+void foo ()\n+{\n+  baz ();\n+  foobar(0);\n+}"}, {"sha": "d2df4bad0fb934999c4cfcc2bed1b5f271c620f2", "filename": "gcc/tree-chkp.c", "status": "modified", "additions": 8, "deletions": 2, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2Ftree-chkp.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/321a5ceb8175dac47c70164a0d539f5c30443c04/gcc%2Ftree-chkp.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-chkp.c?ref=321a5ceb8175dac47c70164a0d539f5c30443c04", "patch": "@@ -1268,7 +1268,8 @@ chkp_check_lower (tree addr, tree bounds,\n   gimple check;\n   tree node;\n \n-  if (bounds == chkp_get_zero_bounds ())\n+  if (!chkp_function_instrumented_p (current_function_decl)\n+      && bounds == chkp_get_zero_bounds ())\n     return;\n \n   if (dirflag == integer_zero_node\n@@ -1314,7 +1315,8 @@ chkp_check_upper (tree addr, tree bounds,\n   gimple check;\n   tree node;\n \n-  if (bounds == chkp_get_zero_bounds ())\n+  if (!chkp_function_instrumented_p (current_function_decl)\n+      && bounds == chkp_get_zero_bounds ())\n     return;\n \n   if (dirflag == integer_zero_node\n@@ -4306,6 +4308,10 @@ chkp_fini (void)\n   free_dominance_info (CDI_POST_DOMINATORS);\n \n   bitmap_obstack_release (NULL);\n+\n+  entry_block = NULL;\n+  zero_bounds = NULL_TREE;\n+  none_bounds = NULL_TREE;\n }\n \n /* Main instrumentation pass function.  */"}]}