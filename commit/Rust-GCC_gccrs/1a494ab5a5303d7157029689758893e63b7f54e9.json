{"sha": "1a494ab5a5303d7157029689758893e63b7f54e9", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MWE0OTRhYjVhNTMwM2Q3MTU3MDI5Njg5NzU4ODkzZTYzYjdmNTRlOQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2010-05-20T19:31:47Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2010-05-20T19:31:47Z"}, "message": "re PR c++/30298 (ICE with duplicate broken inheritance)\n\n/cp\n2010-05-20  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/30298\n\t* decl.c (xref_basetypes): Return false in case of ill-formed\n\tredefinition.\n\n/testsuite\n2010-05-20  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/30298\n\t* g++.dg/inherit/crash1.C: New.\n\t* g++.dg/inherit/crash2.C: Likewise.\n\nFrom-SVN: r159637", "tree": {"sha": "93586309a1e69fad6850fcdda7006587407edb92", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/93586309a1e69fad6850fcdda7006587407edb92"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/1a494ab5a5303d7157029689758893e63b7f54e9", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a494ab5a5303d7157029689758893e63b7f54e9", "html_url": "https://github.com/Rust-GCC/gccrs/commit/1a494ab5a5303d7157029689758893e63b7f54e9", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/1a494ab5a5303d7157029689758893e63b7f54e9/comments", "author": null, "committer": null, "parents": [{"sha": "953c29f73eb8ad665a5e1324bb0b66f98a8e6839", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/953c29f73eb8ad665a5e1324bb0b66f98a8e6839", "html_url": "https://github.com/Rust-GCC/gccrs/commit/953c29f73eb8ad665a5e1324bb0b66f98a8e6839"}], "stats": {"total": 34, "additions": 32, "deletions": 2}, "files": [{"sha": "8e6cd75ca0c33f98454cb24cbbd4bfa2f3525c30", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=1a494ab5a5303d7157029689758893e63b7f54e9", "patch": "@@ -1,3 +1,9 @@\n+2010-05-20  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/30298\n+\t* decl.c (xref_basetypes): Return false in case of ill-formed\n+\tredefinition.\n+\n 2010-05-19  Jason Merrill  <jason@redhat.com>\n \n \t* call.c (reference_binding): Use cp_build_qualified_type_real"}, {"sha": "95ae8ebbe0fad046f506d02e2dcfa786c8c0b049", "filename": "gcc/cp/decl.c", "status": "modified", "additions": 6, "deletions": 1, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Fcp%2Fdecl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Fcp%2Fdecl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fdecl.c?ref=1a494ab5a5303d7157029689758893e63b7f54e9", "patch": "@@ -11025,7 +11025,12 @@ xref_basetypes (tree ref, tree base_list)\n \n   /* The binfo slot should be empty, unless this is an (ill-formed)\n      redefinition.  */\n-  gcc_assert (!TYPE_BINFO (ref) || TYPE_SIZE (ref));\n+  if (TYPE_BINFO (ref) && !TYPE_SIZE (ref))\n+    {\n+      error (\"redefinition of %q#T\", ref);\n+      return false;\n+    }\n+\n   gcc_assert (TYPE_MAIN_VARIANT (ref) == ref);\n \n   binfo = make_tree_binfo (max_bases);"}, {"sha": "d4c10f3af460f9fd14f1be35f4dc2ff36552179c", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 8, "deletions": 1, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=1a494ab5a5303d7157029689758893e63b7f54e9", "patch": "@@ -1,3 +1,9 @@\n+2010-05-20  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/30298\n+\t* g++.dg/inherit/crash1.C: New.\n+\t* g++.dg/inherit/crash2.C: Likewise.\n+\n 2010-05-20  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/44178\n@@ -6,7 +12,8 @@\n 2010-05-20  Changpeng Fang  <changpeng.fang@amd.com>\n \n \tPR middle-end/44185\n-\t* gcc.dg/tree-ssa/prefetch-6.c: Add --param min-insn-to-prefetch-ratio=6.\n+\t* gcc.dg/tree-ssa/prefetch-6.c: Add\n+\t--param min-insn-to-prefetch-ratio=6.\n \t* gcc.dg/tree-ssa/prefetch-7.c: Remove --param max-unrolled-insns=1 to\n         allow unrolling, and adjust the movnti count.\n "}, {"sha": "d5eb7c26aedd8a00387e8bdec1732046977e9036", "filename": "gcc/testsuite/g++.dg/inherit/crash1.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fcrash1.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fcrash1.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fcrash1.C?ref=1a494ab5a5303d7157029689758893e63b7f54e9", "patch": "@@ -0,0 +1,6 @@\n+// PR c++/30298\n+\n+union A {};\n+\n+struct B : A {}; // { dg-error \"fails to be a struct or class type\" }\n+struct B : A {}; // { dg-error \"redefinition\" }"}, {"sha": "0d82f773e67dba5b0a447d8a14fc3322120c8858", "filename": "gcc/testsuite/g++.dg/inherit/crash2.C", "status": "added", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fcrash2.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/1a494ab5a5303d7157029689758893e63b7f54e9/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fcrash2.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Finherit%2Fcrash2.C?ref=1a494ab5a5303d7157029689758893e63b7f54e9", "patch": "@@ -0,0 +1,6 @@\n+// PR c++/30298\n+\n+struct A {};\n+\n+struct B : A, A {}; // { dg-error \"duplicate base type\" }\n+struct B : A, A {}; // { dg-error \"redefinition\" }"}]}