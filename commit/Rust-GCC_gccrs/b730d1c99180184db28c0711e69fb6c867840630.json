{"sha": "b730d1c99180184db28c0711e69fb6c867840630", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YjczMGQxYzk5MTgwMTg0ZGIyOGMwNzExZTY5ZmI2Yzg2Nzg0MDYzMA==", "commit": {"author": {"name": "Jan Hubicka", "email": "hubicka@ucw.cz", "date": "2015-02-01T18:46:14Z"}, "committer": {"name": "Jan Hubicka", "email": "hubicka@gcc.gnu.org", "date": "2015-02-01T18:46:14Z"}, "message": "re PR ipa/64872 (ICE: Segmentation fault during Chromium PGO build)\n\n\n\tPR ipa/64872\n\t* ipa-utils.c (ipa_merge_profiles): Add release argument.\n\t* ipa-icf.c (sem_function::merge): Do not release body when merging.\n\t* ipa-utils.h (ipa_merge_profiles): Update prototype.\n\nFrom-SVN: r220329", "tree": {"sha": "99b37d236d334e345cdd58b1ddbbbb3bc84bb45c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/99b37d236d334e345cdd58b1ddbbbb3bc84bb45c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/b730d1c99180184db28c0711e69fb6c867840630", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b730d1c99180184db28c0711e69fb6c867840630", "html_url": "https://github.com/Rust-GCC/gccrs/commit/b730d1c99180184db28c0711e69fb6c867840630", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/b730d1c99180184db28c0711e69fb6c867840630/comments", "author": null, "committer": null, "parents": [{"sha": "dfde35b359c23dd0d1542f9fbb2ddb5bad3272fe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/dfde35b359c23dd0d1542f9fbb2ddb5bad3272fe", "html_url": "https://github.com/Rust-GCC/gccrs/commit/dfde35b359c23dd0d1542f9fbb2ddb5bad3272fe"}], "stats": {"total": 20, "additions": 15, "deletions": 5}, "files": [{"sha": "548e5dcd26c69cd298309df3c0481510bbf36c22", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b730d1c99180184db28c0711e69fb6c867840630/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b730d1c99180184db28c0711e69fb6c867840630/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=b730d1c99180184db28c0711e69fb6c867840630", "patch": "@@ -1,3 +1,10 @@\n+2015-01-29  Jan Hubicka  <hubicka@ucw.cz>\n+\n+\tPR ipa/64872\n+\t* ipa-utils.c (ipa_merge_profiles): Add release argument.\n+\t* ipa-icf.c (sem_function::merge): Do not release body when merging.\n+\t* ipa-utils.h (ipa_merge_profiles): Update prototype.\n+\n 2015-02-01  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR debug/64817"}, {"sha": "9b2d117b9736a425e65264c65f675ad2271046d6", "filename": "gcc/ipa-icf.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b730d1c99180184db28c0711e69fb6c867840630/gcc%2Fipa-icf.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b730d1c99180184db28c0711e69fb6c867840630/gcc%2Fipa-icf.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-icf.c?ref=b730d1c99180184db28c0711e69fb6c867840630", "patch": "@@ -762,7 +762,7 @@ sem_function::merge (sem_item *alias_item)\n         }\n \n       alias->icf_merged = true;\n-      ipa_merge_profiles (local_original, alias);\n+      ipa_merge_profiles (local_original, alias, true);\n       alias->create_wrapper (local_original);\n \n       if (dump_file)"}, {"sha": "076d71dd0d9ad16b4da6c106a749e9477f3b2057", "filename": "gcc/ipa-utils.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b730d1c99180184db28c0711e69fb6c867840630/gcc%2Fipa-utils.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b730d1c99180184db28c0711e69fb6c867840630/gcc%2Fipa-utils.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-utils.c?ref=b730d1c99180184db28c0711e69fb6c867840630", "patch": "@@ -407,11 +407,13 @@ get_base_var (tree t)\n \n \n /* SRC and DST are going to be merged.  Take SRC's profile and merge it into\n-   DST so it is not going to be lost.  Destroy SRC's body on the way.  */\n+   DST so it is not going to be lost.  Possibly destroy SRC's body on the way\n+   unless PRESERVE_BODY is set.  */\n \n void\n ipa_merge_profiles (struct cgraph_node *dst,\n-\t\t    struct cgraph_node *src)\n+\t\t    struct cgraph_node *src,\n+\t\t    bool preserve_body)\n {\n   tree oldsrcdecl = src->decl;\n   struct function *srccfun, *dstcfun;\n@@ -652,7 +654,8 @@ ipa_merge_profiles (struct cgraph_node *dst,\n \t      e->frequency = freq;\n \t    }\n \t}\n-      src->release_body ();\n+      if (!preserve_body)\n+        src->release_body ();\n       inline_update_overall_summary (dst);\n     }\n   /* TODO: if there is no match, we can scale up.  */"}, {"sha": "ea0f8b379f4baeb560f509d355db40ea33b8aa69", "filename": "gcc/ipa-utils.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/b730d1c99180184db28c0711e69fb6c867840630/gcc%2Fipa-utils.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/b730d1c99180184db28c0711e69fb6c867840630/gcc%2Fipa-utils.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fipa-utils.h?ref=b730d1c99180184db28c0711e69fb6c867840630", "patch": "@@ -44,7 +44,7 @@ bool ipa_edge_within_scc (struct cgraph_edge *);\n int ipa_reverse_postorder (struct cgraph_node **);\n tree get_base_var (tree);\n void ipa_merge_profiles (struct cgraph_node *dst,\n-\t\t\t struct cgraph_node *src);\n+\t\t\t struct cgraph_node *src, bool preserve_body = false);\n bool recursive_call_p (tree, tree);\n \n /* In ipa-profile.c  */"}]}