{"sha": "332b9a5c155b05570c2838044c922a00080e31f5", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MzMyYjlhNWMxNTViMDU1NzBjMjgzODA0NGM5MjJhMDAwODBlMzFmNQ==", "commit": {"author": {"name": "Janne Blomqvist", "email": "jb@gcc.gnu.org", "date": "2010-11-03T23:07:11Z"}, "committer": {"name": "Janne Blomqvist", "email": "jb@gcc.gnu.org", "date": "2010-11-03T23:07:11Z"}, "message": "Remove prot from unix_stream\n\nFrom-SVN: r166284", "tree": {"sha": "f43bae259f50e66e5ecb46db0d048c8c73b4a6cd", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/f43bae259f50e66e5ecb46db0d048c8c73b4a6cd"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/332b9a5c155b05570c2838044c922a00080e31f5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/332b9a5c155b05570c2838044c922a00080e31f5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/332b9a5c155b05570c2838044c922a00080e31f5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/332b9a5c155b05570c2838044c922a00080e31f5/comments", "author": null, "committer": null, "parents": [{"sha": "2fa692c0dfc8385a3b2535ecd9b6b8ef2d0055e5", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2fa692c0dfc8385a3b2535ecd9b6b8ef2d0055e5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2fa692c0dfc8385a3b2535ecd9b6b8ef2d0055e5"}], "stats": {"total": 50, "additions": 16, "deletions": 34}, "files": [{"sha": "2e134c715457b2aedf7626b4439b9d529b03ff9f", "filename": "libgfortran/ChangeLog", "status": "modified", "additions": 10, "deletions": 0, "changes": 10, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/332b9a5c155b05570c2838044c922a00080e31f5/libgfortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/332b9a5c155b05570c2838044c922a00080e31f5/libgfortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2FChangeLog?ref=332b9a5c155b05570c2838044c922a00080e31f5", "patch": "@@ -1,3 +1,13 @@\n+2010-11-04  Janne Blomqvist  <jb@gcc.gnu.org>\n+\n+\t* io/unix.h (struct unix_stream): Remove prot member.\n+\t* io/unix.c: Remove PROT_READ and PROT_WRITE constants.\n+\t(fd_to_stream): Remove prot from argument list, don't set prot.\n+\t(open_external): Don't set prot flag.\n+\t(input_stream): Remove prot from argument list.\n+\t(output_stream): Likewise.\n+\t(error_stream): Likewise.\n+\n 2010-11-03  Janne Blomqvist  <jb@gcc.gnu.org>\n \n \t* io/unix.h: Remove empty_internal_buffer prototype."}, {"sha": "d3def10a1d89bcdfef48839769af816caa11e6ea", "filename": "libgfortran/io/unix.c", "status": "modified", "additions": 6, "deletions": 33, "changes": 39, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/332b9a5c155b05570c2838044c922a00080e31f5/libgfortran%2Fio%2Funix.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/332b9a5c155b05570c2838044c922a00080e31f5/libgfortran%2Fio%2Funix.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Funix.c?ref=332b9a5c155b05570c2838044c922a00080e31f5", "patch": "@@ -104,14 +104,6 @@ typedef struct stat gfstat_t;\n #define PATH_MAX 1024\n #endif\n \n-#ifndef PROT_READ\n-#define PROT_READ 1\n-#endif\n-\n-#ifndef PROT_WRITE\n-#define PROT_WRITE 2\n-#endif\n-\n /* These flags aren't defined on all targets (mingw32), so provide them\n    here.  */\n #ifndef S_IRGRP\n@@ -910,7 +902,7 @@ open_internal4 (char *base, int length, gfc_offset offset)\n  * around it. */\n \n static stream *\n-fd_to_stream (int fd, int prot)\n+fd_to_stream (int fd)\n {\n   gfstat_t statbuf;\n   unix_stream *s;\n@@ -922,7 +914,6 @@ fd_to_stream (int fd, int prot)\n   s->buffer_offset = 0;\n   s->physical_offset = 0;\n   s->logical_offset = 0;\n-  s->prot = prot;\n \n   /* Get the current length of the file. */\n \n@@ -1222,7 +1213,7 @@ regular_file (st_parameter_open *opp, unit_flags *flags)\n stream *\n open_external (st_parameter_open *opp, unit_flags *flags)\n {\n-  int fd, prot;\n+  int fd;\n \n   if (flags->status == STATUS_SCRATCH)\n     {\n@@ -1247,25 +1238,7 @@ open_external (st_parameter_open *opp, unit_flags *flags)\n     return NULL;\n   fd = fix_fd (fd);\n \n-  switch (flags->action)\n-    {\n-    case ACTION_READ:\n-      prot = PROT_READ;\n-      break;\n-\n-    case ACTION_WRITE:\n-      prot = PROT_WRITE;\n-      break;\n-\n-    case ACTION_READWRITE:\n-      prot = PROT_READ | PROT_WRITE;\n-      break;\n-\n-    default:\n-      internal_error (&opp->common, \"open_external(): Bad action\");\n-    }\n-\n-  return fd_to_stream (fd, prot);\n+  return fd_to_stream (fd);\n }\n \n \n@@ -1275,7 +1248,7 @@ open_external (st_parameter_open *opp, unit_flags *flags)\n stream *\n input_stream (void)\n {\n-  return fd_to_stream (STDIN_FILENO, PROT_READ);\n+  return fd_to_stream (STDIN_FILENO);\n }\n \n \n@@ -1291,7 +1264,7 @@ output_stream (void)\n   setmode (STDOUT_FILENO, O_BINARY);\n #endif\n \n-  s = fd_to_stream (STDOUT_FILENO, PROT_WRITE);\n+  s = fd_to_stream (STDOUT_FILENO);\n   return s;\n }\n \n@@ -1308,7 +1281,7 @@ error_stream (void)\n   setmode (STDERR_FILENO, O_BINARY);\n #endif\n \n-  s = fd_to_stream (STDERR_FILENO, PROT_WRITE);\n+  s = fd_to_stream (STDERR_FILENO);\n   return s;\n }\n "}, {"sha": "563b77ee0ced9cd14fa85db948a2410736d1413f", "filename": "libgfortran/io/unix.h", "status": "modified", "additions": 0, "deletions": 1, "changes": 1, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/332b9a5c155b05570c2838044c922a00080e31f5/libgfortran%2Fio%2Funix.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/332b9a5c155b05570c2838044c922a00080e31f5/libgfortran%2Fio%2Funix.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/libgfortran%2Fio%2Funix.h?ref=332b9a5c155b05570c2838044c922a00080e31f5", "patch": "@@ -56,7 +56,6 @@ typedef struct\n \n   int active;\t\t\t/* Length of valid bytes in the buffer */\n \n-  int prot;\n   int ndirty;\t\t\t/* Dirty bytes starting at buffer_offset */\n \n   int special_file;\t\t/* =1 if the fd refers to a special file */"}]}