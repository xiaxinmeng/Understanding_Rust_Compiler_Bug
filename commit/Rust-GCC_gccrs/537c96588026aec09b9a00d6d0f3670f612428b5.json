{"sha": "537c96588026aec09b9a00d6d0f3670f612428b5", "node_id": "C_kwDOANBUbNoAKDUzN2M5NjU4ODAyNmFlYzA5YjlhMDBkNmQwZjM2NzBmNjEyNDI4YjU", "commit": {"author": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2022-02-22T15:49:09Z"}, "committer": {"name": "Segher Boessenkool", "email": "segher@kernel.crashing.org", "date": "2022-02-22T16:20:23Z"}, "message": "rs6000: Fix GC on rs6000.c decls for atomic handling (PR88134)\n\nIn PR88134 it is pointed out that we do not have GTY markup for some\nvariables we use for atomic.  So, let's add that.\n\n2022-02-22  Segher Boessenkool  <segher@kernel.crashing.org>\n\n\tPR target/88134\n\t* config/rs6000/rs6000.cc (atomic_hold_decl, atomic_clear_decl,\n\tatomic_update_decl): Add GTY markup.", "tree": {"sha": "50d329031ca53aff0a48b7f2ccb141051c264578", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50d329031ca53aff0a48b7f2ccb141051c264578"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/537c96588026aec09b9a00d6d0f3670f612428b5", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/537c96588026aec09b9a00d6d0f3670f612428b5", "html_url": "https://github.com/Rust-GCC/gccrs/commit/537c96588026aec09b9a00d6d0f3670f612428b5", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/537c96588026aec09b9a00d6d0f3670f612428b5/comments", "author": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "committer": {"login": "segher", "id": 417629, "node_id": "MDQ6VXNlcjQxNzYyOQ==", "avatar_url": "https://avatars.githubusercontent.com/u/417629?v=4", "gravatar_id": "", "url": "https://api.github.com/users/segher", "html_url": "https://github.com/segher", "followers_url": "https://api.github.com/users/segher/followers", "following_url": "https://api.github.com/users/segher/following{/other_user}", "gists_url": "https://api.github.com/users/segher/gists{/gist_id}", "starred_url": "https://api.github.com/users/segher/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/segher/subscriptions", "organizations_url": "https://api.github.com/users/segher/orgs", "repos_url": "https://api.github.com/users/segher/repos", "events_url": "https://api.github.com/users/segher/events{/privacy}", "received_events_url": "https://api.github.com/users/segher/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "e9f8443a9179c0e9e0d96dfa91c883d6ddb70d3b", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/e9f8443a9179c0e9e0d96dfa91c883d6ddb70d3b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/e9f8443a9179c0e9e0d96dfa91c883d6ddb70d3b"}], "stats": {"total": 11, "additions": 5, "deletions": 6}, "files": [{"sha": "a855e8c4c72aa6343a24931daf34db60d70a4681", "filename": "gcc/config/rs6000/rs6000.cc", "status": "modified", "additions": 5, "deletions": 6, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/537c96588026aec09b9a00d6d0f3670f612428b5/gcc%2Fconfig%2Frs6000%2Frs6000.cc", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/537c96588026aec09b9a00d6d0f3670f612428b5/gcc%2Fconfig%2Frs6000%2Frs6000.cc", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Frs6000%2Frs6000.cc?ref=537c96588026aec09b9a00d6d0f3670f612428b5", "patch": "@@ -27699,14 +27699,13 @@ emit_fusion_gpr_load (rtx target, rtx mem)\n   return \"\";\n }\n \f\n-\n-#ifdef RS6000_GLIBC_ATOMIC_FENV\n-/* Function declarations for rs6000_atomic_assign_expand_fenv.  */\n-static tree atomic_hold_decl, atomic_clear_decl, atomic_update_decl;\n-#endif\n+/* This is not inside an  #ifdef RS6000_GLIBC_ATOMIC_FENV  because gengtype\n+   ignores it then.  */\n+static GTY(()) tree atomic_hold_decl;\n+static GTY(()) tree atomic_clear_decl;\n+static GTY(()) tree atomic_update_decl;\n \n /* Implement TARGET_ATOMIC_ASSIGN_EXPAND_FENV hook.  */\n-\n static void\n rs6000_atomic_assign_expand_fenv (tree *hold, tree *clear, tree *update)\n {"}]}