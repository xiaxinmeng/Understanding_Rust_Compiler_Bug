{"sha": "f7844b6a777cb47fec7208d7bd594f6ce66f1daa", "node_id": "C_kwDOANBUbNoAKGY3ODQ0YjZhNzc3Y2I0N2ZlYzcyMDhkN2JkNTk0ZjZjZTY2ZjFkYWE", "commit": {"author": {"name": "Andrew Pinski", "email": "apinski@marvell.com", "date": "2021-11-09T09:56:10Z"}, "committer": {"name": "Andrew Pinski", "email": "apinski@marvell.com", "date": "2021-11-09T19:01:57Z"}, "message": "[Committed] Fix tree-optimization/103152: Still one more -signed1bit issue\n\nWhen I fixed PR 102622, I accidently left behind a TYPE_PRECISION\ncheck which I had there for checking before hand.  This check\nis not needed as the code will handle it correctly anyways.\n\nCommitted as obvious after a bootstrap/test on x86_64-linux-gnu.\n\n\tPR tree-optimization/10352\n\ngcc/ChangeLog:\n\n\t* match.pd: Remove check of TYPE_PRECISION for\n\tthe a?0:pow2 case.\n\ngcc/testsuite/ChangeLog:\n\n\t* gcc.c-torture/execute/pr10352-1.c: New test.", "tree": {"sha": "1ce4db903a8a2080883ecb15bbc34474f9edaf97", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/1ce4db903a8a2080883ecb15bbc34474f9edaf97"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/f7844b6a777cb47fec7208d7bd594f6ce66f1daa", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f7844b6a777cb47fec7208d7bd594f6ce66f1daa", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f7844b6a777cb47fec7208d7bd594f6ce66f1daa", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f7844b6a777cb47fec7208d7bd594f6ce66f1daa/comments", "author": {"login": "apinski-cavium", "id": 6335315, "node_id": "MDQ6VXNlcjYzMzUzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6335315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apinski-cavium", "html_url": "https://github.com/apinski-cavium", "followers_url": "https://api.github.com/users/apinski-cavium/followers", "following_url": "https://api.github.com/users/apinski-cavium/following{/other_user}", "gists_url": "https://api.github.com/users/apinski-cavium/gists{/gist_id}", "starred_url": "https://api.github.com/users/apinski-cavium/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apinski-cavium/subscriptions", "organizations_url": "https://api.github.com/users/apinski-cavium/orgs", "repos_url": "https://api.github.com/users/apinski-cavium/repos", "events_url": "https://api.github.com/users/apinski-cavium/events{/privacy}", "received_events_url": "https://api.github.com/users/apinski-cavium/received_events", "type": "User", "site_admin": false}, "committer": {"login": "apinski-cavium", "id": 6335315, "node_id": "MDQ6VXNlcjYzMzUzMTU=", "avatar_url": "https://avatars.githubusercontent.com/u/6335315?v=4", "gravatar_id": "", "url": "https://api.github.com/users/apinski-cavium", "html_url": "https://github.com/apinski-cavium", "followers_url": "https://api.github.com/users/apinski-cavium/followers", "following_url": "https://api.github.com/users/apinski-cavium/following{/other_user}", "gists_url": "https://api.github.com/users/apinski-cavium/gists{/gist_id}", "starred_url": "https://api.github.com/users/apinski-cavium/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/apinski-cavium/subscriptions", "organizations_url": "https://api.github.com/users/apinski-cavium/orgs", "repos_url": "https://api.github.com/users/apinski-cavium/repos", "events_url": "https://api.github.com/users/apinski-cavium/events{/privacy}", "received_events_url": "https://api.github.com/users/apinski-cavium/received_events", "type": "User", "site_admin": false}, "parents": [{"sha": "56af35de3d11960100996b96034dc9ccd7c75ca3", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/56af35de3d11960100996b96034dc9ccd7c75ca3", "html_url": "https://github.com/Rust-GCC/gccrs/commit/56af35de3d11960100996b96034dc9ccd7c75ca3"}], "stats": {"total": 15, "additions": 13, "deletions": 2}, "files": [{"sha": "986b052bc939f60b6a3afffefec0cd8125b770f4", "filename": "gcc/match.pd", "status": "modified", "additions": 1, "deletions": 2, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7844b6a777cb47fec7208d7bd594f6ce66f1daa/gcc%2Fmatch.pd", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7844b6a777cb47fec7208d7bd594f6ce66f1daa/gcc%2Fmatch.pd", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fmatch.pd?ref=f7844b6a777cb47fec7208d7bd594f6ce66f1daa", "patch": "@@ -4056,8 +4056,7 @@ DEFINE_INT_AND_FLOAT_ROUND_FN (RINT)\n      (if (integer_onep (@2))\n       (convert (bit_xor (convert:boolean_type_node @0) { booltrue; } )))\n      /* a ? powerof2cst : 0 -> (!a) << (log2(powerof2cst)) */\n-     (if (INTEGRAL_TYPE_P (type) &&  integer_pow2p (@2)\n-         && TYPE_PRECISION (type) != 1)\n+     (if (INTEGRAL_TYPE_P (type) &&  integer_pow2p (@2))\n       (with {\n \ttree shift = build_int_cst (integer_type_node, tree_log2 (@2));\n        }"}, {"sha": "babb9d45a2813a4fffdde7f8480317f7001dd2bc", "filename": "gcc/testsuite/gcc.c-torture/execute/pr10352-1.c", "status": "added", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/f7844b6a777cb47fec7208d7bd594f6ce66f1daa/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr10352-1.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/f7844b6a777cb47fec7208d7bd594f6ce66f1daa/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr10352-1.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.c-torture%2Fexecute%2Fpr10352-1.c?ref=f7844b6a777cb47fec7208d7bd594f6ce66f1daa", "patch": "@@ -0,0 +1,12 @@\n+/* this is another case where phiopt\n+   would create -signed1bit which is undefined. */\n+struct {\n+  int a:1;\n+} b;\n+int *c = (int *)&b, d;\n+int main() {\n+  d = c && (b.a = (d < 0) ^ 3);\n+  if (d != 1)\n+    __builtin_abort();\n+  return 0;\n+}"}]}