{"sha": "7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6N2Y1ZDc2ZmI5NzY3NzBlYzkwZGVhZjU2MmJhN2NmNTY2YmY5YjBiZQ==", "commit": {"author": {"name": "Paolo Carlini", "email": "paolo.carlini@oracle.com", "date": "2013-05-24T17:37:41Z"}, "committer": {"name": "Paolo Carlini", "email": "paolo@gcc.gnu.org", "date": "2013-05-24T17:37:41Z"}, "message": "re PR c++/19618 (Do warn if a bit-field exceeds the size of a bool type)\n\n/cp\n2013-05-24  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/19618\n\t* class.c (check_bitfield_decl): Warn for bool and enum bitfields\n\twith width exceeding the type.\n\n/testsuite\n2013-05-24  Paolo Carlini  <paolo.carlini@oracle.com>\n\n\tPR c++/19618\n\t* g++.dg/expr/bitfield12.C: New.\n\nFrom-SVN: r199306", "tree": {"sha": "d61337f07687efcd2340ad1335a2c5ee0514ab86", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/d61337f07687efcd2340ad1335a2c5ee0514ab86"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "html_url": "https://github.com/Rust-GCC/gccrs/commit/7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/comments", "author": null, "committer": null, "parents": [{"sha": "2343af65585862c38ab76e78387c2ae60c93f227", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2343af65585862c38ab76e78387c2ae60c93f227", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2343af65585862c38ab76e78387c2ae60c93f227"}], "stats": {"total": 39, "additions": 36, "deletions": 3}, "files": [{"sha": "7b02b8b3b5b84f3bf83b08db702f59fc4980c891", "filename": "gcc/cp/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Fcp%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Fcp%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2FChangeLog?ref=7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "patch": "@@ -1,3 +1,9 @@\n+2013-05-24  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/19618\n+\t* class.c (check_bitfield_decl): Warn for bool and enum bitfields\n+\twith width exceeding the type.\n+\n 2013-05-24  Jason Merrill  <jason@redhat.com>\n \n \tPR c++/57391"}, {"sha": "d6684cfd68b43074b54c9a9620a5477424ec3063", "filename": "gcc/cp/class.c", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Fcp%2Fclass.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Fcp%2Fclass.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fcp%2Fclass.c?ref=7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "patch": "@@ -3140,9 +3140,12 @@ check_bitfield_decl (tree field)\n \t  error (\"zero width for bit-field %q+D\", field);\n \t  w = error_mark_node;\n \t}\n-      else if (compare_tree_int (w, TYPE_PRECISION (type)) > 0\n-\t       && TREE_CODE (type) != ENUMERAL_TYPE\n-\t       && TREE_CODE (type) != BOOLEAN_TYPE)\n+      else if ((TREE_CODE (type) != ENUMERAL_TYPE\n+\t\t&& TREE_CODE (type) != BOOLEAN_TYPE\n+\t\t&& compare_tree_int (w, TYPE_PRECISION (type)) > 0)\n+\t       || ((TREE_CODE (type) == ENUMERAL_TYPE\n+\t\t    || TREE_CODE (type) == BOOLEAN_TYPE)\n+\t\t   && tree_int_cst_lt (TYPE_SIZE (type), w)))\n \twarning (0, \"width of %q+D exceeds its type\", field);\n       else if (TREE_CODE (type) == ENUMERAL_TYPE\n \t       && (0 > (compare_tree_int"}, {"sha": "a0278d5fe330170f52f3a803ce765b2b5a0484e0", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "patch": "@@ -1,3 +1,8 @@\n+2013-05-24  Paolo Carlini  <paolo.carlini@oracle.com>\n+\n+\tPR c++/19618\n+\t* g++.dg/expr/bitfield12.C: New.\n+\n 2013-05-24  Jeff Law  <law@redhat.com>\n \n \tPR tree-optimization/57124"}, {"sha": "3ae88ca191c1dba8ff3e08e0f2be7116382c7796", "filename": "gcc/testsuite/g++.dg/expr/bitfield12.C", "status": "added", "additions": 19, "deletions": 0, "changes": 19, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fbitfield12.C", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/7f5d76fb976770ec90deaf562ba7cf566bf9b0be/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fbitfield12.C", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fg%2B%2B.dg%2Fexpr%2Fbitfield12.C?ref=7f5d76fb976770ec90deaf562ba7cf566bf9b0be", "patch": "@@ -0,0 +1,19 @@\n+// PR c++/19618\n+\n+struct bset1 {\n+  bool bit : sizeof(bool) * __CHAR_BIT__ + 1;  // { dg-warning \"exceeds\" }\n+};\n+\n+enum E {};\n+\n+struct bset2 {\n+  E bit : sizeof(E) * __CHAR_BIT__ + 1;        // { dg-warning \"exceeds\" }\n+};\n+\n+struct bset3 {\n+  bool bit : sizeof(bool) * __CHAR_BIT__;\n+};\n+\n+struct bset4 {\n+  E bit : sizeof(E) * __CHAR_BIT__;\n+};"}]}