{"sha": "ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YWMxOTBmY2VhMWJlYmY4N2EyYzhjMzk2MzU0OGEwZTUyNzJjNDJlYw==", "commit": {"author": {"name": "Richard Sandiford", "email": "richard.sandiford@arm.com", "date": "2020-01-10T14:56:20Z"}, "committer": {"name": "Richard Sandiford", "email": "rsandifo@gcc.gnu.org", "date": "2020-01-10T14:56:20Z"}, "message": "Fix gather/scatter check when updating a vector epilogue loop\n\nupdate_epilogue_loop_vinfo applies SSA renmaing to the DR_REF of a\ngather or scatter, so that vect_check_gather_scatter continues to work.\nHowever, we sometimes also rely on vect_check_gather_scatter when\nusing gathers and scatters to implement strided accesses.\n\nThis showed up on existing tests when testing with fixed-length\n-msve-vector-bits=128.\n\n2020-01-10  Richard Sandiford  <richard.sandiford@arm.com>\n\ngcc/\n\t* tree-vect-loop.c (update_epilogue_loop_vinfo): Update DR_REF\n\tfor any type of gather or scatter, including strided accesses.\n\nFrom-SVN: r280111", "tree": {"sha": "0652422c6b4fa21ff8ff9b88f65df7593d91e028", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/0652422c6b4fa21ff8ff9b88f65df7593d91e028"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "html_url": "https://github.com/Rust-GCC/gccrs/commit/ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/ac190fcea1bebf87a2c8c3963548a0e5272c42ec/comments", "author": {"login": "rsandifo-arm", "id": 28043039, "node_id": "MDQ6VXNlcjI4MDQzMDM5", "avatar_url": "https://avatars.githubusercontent.com/u/28043039?v=4", "gravatar_id": "", "url": "https://api.github.com/users/rsandifo-arm", "html_url": "https://github.com/rsandifo-arm", "followers_url": "https://api.github.com/users/rsandifo-arm/followers", "following_url": "https://api.github.com/users/rsandifo-arm/following{/other_user}", "gists_url": "https://api.github.com/users/rsandifo-arm/gists{/gist_id}", "starred_url": "https://api.github.com/users/rsandifo-arm/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/rsandifo-arm/subscriptions", "organizations_url": "https://api.github.com/users/rsandifo-arm/orgs", "repos_url": "https://api.github.com/users/rsandifo-arm/repos", "events_url": "https://api.github.com/users/rsandifo-arm/events{/privacy}", "received_events_url": "https://api.github.com/users/rsandifo-arm/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "2fb672a2574004a1e77c8ba83af539673f5cf659", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2fb672a2574004a1e77c8ba83af539673f5cf659", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2fb672a2574004a1e77c8ba83af539673f5cf659"}], "stats": {"total": 7, "additions": 6, "deletions": 1}, "files": [{"sha": "28564f723e18ea2127a94ed697d123576ca0224b", "filename": "gcc/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac190fcea1bebf87a2c8c3963548a0e5272c42ec/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac190fcea1bebf87a2c8c3963548a0e5272c42ec/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "patch": "@@ -1,3 +1,8 @@\n+2020-01-10  Richard Sandiford  <richard.sandiford@arm.com>\n+\n+\t* tree-vect-loop.c (update_epilogue_loop_vinfo): Update DR_REF\n+\tfor any type of gather or scatter, including strided accesses.\n+\n 2020-01-10  Andre Vieira  <andre.simoesdiasvieira@arm.com>\n \n \t* tree-vectorizer.h (get_dr_vinfo_offset): Add missing function"}, {"sha": "1fa3ba6d932e594bdafbbe52cb1c6ef39312dbc3", "filename": "gcc/tree-vect-loop.c", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/ac190fcea1bebf87a2c8c3963548a0e5272c42ec/gcc%2Ftree-vect-loop.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/ac190fcea1bebf87a2c8c3963548a0e5272c42ec/gcc%2Ftree-vect-loop.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-loop.c?ref=ac190fcea1bebf87a2c8c3963548a0e5272c42ec", "patch": "@@ -8451,7 +8451,7 @@ update_epilogue_loop_vinfo (class loop *epilogue, tree advance)\n \t updated offset we set using ADVANCE.  Instead we have to make sure the\n \t reference in the data references point to the corresponding copy of\n \t the original in the epilogue.  */\n-      if (STMT_VINFO_GATHER_SCATTER_P (stmt_vinfo))\n+      if (STMT_VINFO_MEMORY_ACCESS_TYPE (stmt_vinfo) == VMAT_GATHER_SCATTER)\n \t{\n \t  DR_REF (dr)\n \t    = simplify_replace_tree (DR_REF (dr), NULL_TREE, NULL_TREE,"}]}