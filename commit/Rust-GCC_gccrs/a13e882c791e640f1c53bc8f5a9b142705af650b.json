{"sha": "a13e882c791e640f1c53bc8f5a9b142705af650b", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YTEzZTg4MmM3OTFlNjQwZjFjNTNiYzhmNWE5YjE0MjcwNWFmNjUwYg==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2006-01-03T16:19:21Z"}, "committer": {"name": "Richard Henderson", "email": "rth@gcc.gnu.org", "date": "2006-01-03T16:19:21Z"}, "message": "varasm.c (assemble_variable): Handle thread-local COMMON data.\n\n        * varasm.c (assemble_variable): Handle thread-local COMMON data.\n        * defaults.h (ASM_OUTPUT_TLS_COMMON): Define.\n\nCo-Authored-By: Richard Henderson <rth@redhat.com>\n\nFrom-SVN: r109282", "tree": {"sha": "3db10c3935e39e5ab5b1657e037fa4a1351ce60a", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/3db10c3935e39e5ab5b1657e037fa4a1351ce60a"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/a13e882c791e640f1c53bc8f5a9b142705af650b", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a13e882c791e640f1c53bc8f5a9b142705af650b", "html_url": "https://github.com/Rust-GCC/gccrs/commit/a13e882c791e640f1c53bc8f5a9b142705af650b", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/a13e882c791e640f1c53bc8f5a9b142705af650b/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "13991abbfce042ef49d546c7d7b63c1c3734fa55", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/13991abbfce042ef49d546c7d7b63c1c3734fa55", "html_url": "https://github.com/Rust-GCC/gccrs/commit/13991abbfce042ef49d546c7d7b63c1c3734fa55"}], "stats": {"total": 32, "additions": 30, "deletions": 2}, "files": [{"sha": "d2e57cebcd8e845ffa18fc414b2ec21c9414e11e", "filename": "gcc/ChangeLog", "status": "modified", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a13e882c791e640f1c53bc8f5a9b142705af650b/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a13e882c791e640f1c53bc8f5a9b142705af650b/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=a13e882c791e640f1c53bc8f5a9b142705af650b", "patch": "@@ -1,3 +1,10 @@\n+2006-01-03  Jakub Jelinek  <jakub@redhat.com>\n+\t    Richard Henderson  <rth@redhat.com>\n+\n+\tMerge from gomp-branch:\n+        * varasm.c (assemble_variable): Handle thread-local COMMON data.\n+        * defaults.h (ASM_OUTPUT_TLS_COMMON): Define.\n+\n 2006-01-03  Paolo Bonzini  <bonzini@gnu.org>\n \n \tPR rtl-optimization/25578"}, {"sha": "1207b7be614c29cc33deb3bab735c3ee760f1fd8", "filename": "gcc/defaults.h", "status": "modified", "additions": 12, "deletions": 0, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a13e882c791e640f1c53bc8f5a9b142705af650b/gcc%2Fdefaults.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a13e882c791e640f1c53bc8f5a9b142705af650b/gcc%2Fdefaults.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fdefaults.h?ref=a13e882c791e640f1c53bc8f5a9b142705af650b", "patch": "@@ -114,6 +114,18 @@ Software Foundation, 51 Franklin Street, Fifth Floor, Boston, MA\n #endif\n #endif\n \n+#if defined (HAVE_AS_TLS) && !defined (ASM_OUTPUT_TLS_COMMON)\n+#define ASM_OUTPUT_TLS_COMMON(FILE, DECL, NAME, SIZE)\t\t\t\\\n+  do\t\t\t\t\t\t\t\t\t\\\n+    {\t\t\t\t\t\t\t\t\t\\\n+      fprintf ((FILE), \"\\t.tls_common\\t\");\t\t\t\t\\\n+      assemble_name ((FILE), (NAME));\t\t\t\t\t\\\n+      fprintf ((FILE), \",\"HOST_WIDE_INT_PRINT_UNSIGNED\",%u\\n\",\t\t\\\n+\t       (SIZE), DECL_ALIGN (DECL) / BITS_PER_UNIT);\t\t\\\n+    }\t\t\t\t\t\t\t\t\t\\\n+  while (0)\n+#endif\n+\n /* Decide whether to defer emitting the assembler output for an equate\n    of two values.  The default is to not defer output.  */\n #ifndef TARGET_DEFERRED_OUTPUT_DEFS"}, {"sha": "5f58bf4cef68089d7118bc9041cc4b4d80d50713", "filename": "gcc/varasm.c", "status": "modified", "additions": 11, "deletions": 2, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/a13e882c791e640f1c53bc8f5a9b142705af650b/gcc%2Fvarasm.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/a13e882c791e640f1c53bc8f5a9b142705af650b/gcc%2Fvarasm.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fvarasm.c?ref=a13e882c791e640f1c53bc8f5a9b142705af650b", "patch": "@@ -1537,11 +1537,20 @@ assemble_variable (tree decl, int top_level ATTRIBUTE_UNUSED,\n      isn't common, and shouldn't be handled as such.  */\n   if (DECL_SECTION_NAME (decl) || dont_output_data)\n     ;\n-  /* We don't implement common thread-local data at present.  */\n   else if (DECL_THREAD_LOCAL_P (decl))\n     {\n       if (DECL_COMMON (decl))\n-\tsorry (\"thread-local COMMON data not implemented\");\n+\t{\n+#ifdef ASM_OUTPUT_TLS_COMMON\n+\t  unsigned HOST_WIDE_INT size;\n+\n+\t  size = tree_low_cst (DECL_SIZE_UNIT (decl), 1);\n+\t  ASM_OUTPUT_TLS_COMMON (asm_out_file, decl, name, size);\n+\t  return;\n+#else\n+\t  sorry (\"thread-local COMMON data not implemented\");\n+#endif\n+\t}\n     }\n   else if (DECL_INITIAL (decl) == 0\n \t   || DECL_INITIAL (decl) == error_mark_node"}]}