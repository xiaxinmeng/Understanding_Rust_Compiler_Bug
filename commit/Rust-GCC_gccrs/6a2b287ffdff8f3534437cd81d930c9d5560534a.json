{"sha": "6a2b287ffdff8f3534437cd81d930c9d5560534a", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NmEyYjI4N2ZmZGZmOGYzNTM0NDM3Y2Q4MWQ5MzBjOWQ1NTYwNTM0YQ==", "commit": {"author": {"name": "Bob Wilson", "email": "bob.wilson@acm.org", "date": "2003-04-26T00:06:51Z"}, "committer": {"name": "Bob Wilson", "email": "bwilson@gcc.gnu.org", "date": "2003-04-26T00:06:51Z"}, "message": "linux.h (TARGET_OS_CPP_BUILTINS): Remove definition of _GNU_SOURCE.\n\n        * config/xtensa/linux.h (TARGET_OS_CPP_BUILTINS): Remove definition of\n        _GNU_SOURCE.  Add definitions of __PIC__ and __pic__.\n        (SUBTARGET_CPP_SPEC): Define.\n        (LIB_SPEC): Delete.\n        * config/xtensa/xtensa-protos.h (xtensa_declare_object): Delete.\n        * config/xtensa/xtensa.c (xtensa_declare_object): Delete.\n        * config/xtensa/xtensa.h (CPP_SPEC, SUBTARGET_CPP_SPEC, EXTRA_SPECS):\n        Define.\n        (ASM_OUTPUT_COMMON, ASM_OUTPUT_LOCAL): Delete.\n        (ASM_OUTPUT_ALIGNED_BSS, BSS_SECTION_ASM_OP): Define.\n\nFrom-SVN: r66083", "tree": {"sha": "421c31013f1b82aeaacb28906f87c86681ce803c", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/421c31013f1b82aeaacb28906f87c86681ce803c"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/6a2b287ffdff8f3534437cd81d930c9d5560534a", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a2b287ffdff8f3534437cd81d930c9d5560534a", "html_url": "https://github.com/Rust-GCC/gccrs/commit/6a2b287ffdff8f3534437cd81d930c9d5560534a", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/6a2b287ffdff8f3534437cd81d930c9d5560534a/comments", "author": null, "committer": null, "parents": [{"sha": "01475329b3a61129805fae3d2cdfb11ef8d87894", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/01475329b3a61129805fae3d2cdfb11ef8d87894", "html_url": "https://github.com/Rust-GCC/gccrs/commit/01475329b3a61129805fae3d2cdfb11ef8d87894"}], "stats": {"total": 78, "additions": 37, "deletions": 41}, "files": [{"sha": "ded408e1ba5b726a679256462fc2e643d0bb3a2d", "filename": "gcc/ChangeLog", "status": "modified", "additions": 13, "deletions": 0, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=6a2b287ffdff8f3534437cd81d930c9d5560534a", "patch": "@@ -1,3 +1,16 @@\n+2003-04-25  Bob Wilson  <bob.wilson@acm.org>\n+\n+\t* config/xtensa/linux.h (TARGET_OS_CPP_BUILTINS): Remove definition of\n+\t_GNU_SOURCE.  Add definitions of __PIC__ and __pic__.\n+\t(SUBTARGET_CPP_SPEC): Define.\n+\t(LIB_SPEC): Delete.\n+\t* config/xtensa/xtensa-protos.h (xtensa_declare_object): Delete.\n+\t* config/xtensa/xtensa.c (xtensa_declare_object): Delete.\n+\t* config/xtensa/xtensa.h (CPP_SPEC, SUBTARGET_CPP_SPEC, EXTRA_SPECS):\n+\tDefine.\n+\t(ASM_OUTPUT_COMMON, ASM_OUTPUT_LOCAL): Delete.\n+\t(ASM_OUTPUT_ALIGNED_BSS, BSS_SECTION_ASM_OP): Define.\n+\n 2003-04-25  H.J. Lu <hjl@gnu.org>\n \n \t* config/ia64/ia64.c (ia64_expand_compare_and_swap): Add rmode"}, {"sha": "4a1b5f626ad1ba4f0c53deb409a5a44631d6c318", "filename": "gcc/config/xtensa/linux.h", "status": "modified", "additions": 6, "deletions": 10, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Flinux.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Flinux.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Flinux.h?ref=6a2b287ffdff8f3534437cd81d930c9d5560534a", "patch": "@@ -1,6 +1,6 @@\n /* Xtensa Linux configuration.\n    Derived from the configuration for GCC for Intel i386 running Linux.\n-   Copyright (C) 2001, 2002 Free Software Foundation, Inc.\n+   Copyright (C) 2001, 2002, 2003 Free Software Foundation, Inc.\n \n This file is part of GCC.\n \n@@ -26,11 +26,13 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n     builtin_define (\"__ELF__\");\t\t\t\t\t\\\n     builtin_define (\"__gnu_linux__\");\t\t\t\t\\\n     builtin_assert (\"system=posix\");\t\t\t\t\\\n-    /* The GNU C++ standard library requires this.  */\t\t\\\n-    if (c_language == clk_cplusplus)\t\t\t\t\\\n-      builtin_define (\"_GNU_SOURCE\");\t\t\t\t\\\n+    builtin_define (\"__PIC__\");\t\t\t\t\t\\\n+    builtin_define (\"__pic__\");\t\t\t\t\t\\\n   } while (0)\n \n+#undef SUBTARGET_CPP_SPEC\n+#define SUBTARGET_CPP_SPEC \"%{posix:-D_POSIX_SOURCE} %{pthread:-D_REENTRANT}\"\n+\n #undef TARGET_VERSION\n #define TARGET_VERSION fputs (\" (Xtensa GNU/Linux with ELF)\", stderr);\n \n@@ -45,12 +47,6 @@ Software Foundation, 59 Temple Place - Suite 330, Boston, MA\n \n #undef ASM_FINAL_SPEC\n \n-#undef LIB_SPEC\n-#define LIB_SPEC \\\n-  \"%{shared: -lc} \\\n-   %{!shared: %{pthread:-lpthread} \\\n-   %{profile:-lc_p} %{!profile: -lc}}\"\n-\n #undef LINK_SPEC\n #define LINK_SPEC \\\n  \"%{shared:-shared} \\"}, {"sha": "b248da9d544d8e1345125d190f66bc5a9e48f02d", "filename": "gcc/config/xtensa/xtensa-protos.h", "status": "modified", "additions": 1, "deletions": 3, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Fxtensa-protos.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Fxtensa-protos.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa-protos.h?ref=6a2b287ffdff8f3534437cd81d930c9d5560534a", "patch": "@@ -1,5 +1,5 @@\n /* Prototypes of target machine for GNU compiler for Xtensa.\n-   Copyright 2001,2002 Free Software Foundation, Inc.\n+   Copyright 2001,2002,2003 Free Software Foundation, Inc.\n    Contributed by Bob Wilson (bwilson@tensilica.com) at Tensilica.\n \n This file is part of GCC.\n@@ -109,8 +109,6 @@ extern int xtensa_mem_offset PARAMS ((unsigned, enum machine_mode));\n extern void xtensa_setup_frame_addresses PARAMS ((void));\n extern int xtensa_dbx_register_number PARAMS ((int));\n extern void override_options PARAMS ((void));\n-extern void xtensa_declare_object\n-  PARAMS ((FILE *, char *, char *, char *, int));\n extern long compute_frame_size PARAMS ((int));\n extern int xtensa_frame_pointer_required PARAMS ((void));\n extern void xtensa_function_prologue PARAMS ((FILE *, HOST_WIDE_INT));"}, {"sha": "f54e88e7017d949ede8ec6c30862e9474f24b6f0", "filename": "gcc/config/xtensa/xtensa.c", "status": "modified", "additions": 1, "deletions": 17, "changes": 18, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Fxtensa.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.c?ref=6a2b287ffdff8f3534437cd81d930c9d5560534a", "patch": "@@ -1,5 +1,5 @@\n /* Subroutines for insn-output.c for Tensilica's Xtensa architecture.\n-   Copyright 2001,2002 Free Software Foundation, Inc.\n+   Copyright 2001,2002,2003 Free Software Foundation, Inc.\n    Contributed by Bob Wilson (bwilson@tensilica.com) at Tensilica.\n \n This file is part of GCC.\n@@ -2086,22 +2086,6 @@ print_operand_address (file, addr)\n }\n \n \n-/* Emit either a label, .comm, or .lcomm directive. */\n-\n-void\n-xtensa_declare_object (file, name, init_string, final_string, size)\n-     FILE *file;\n-     char *name;\n-     char *init_string;\n-     char *final_string;\n-     int size;\n-{\n-  fputs (init_string, file);\t\t/* \"\", \"\\t.comm\\t\", or \"\\t.lcomm\\t\" */\n-  assemble_name (file, name);\n-  fprintf (file, final_string, size);\t/* \":\\n\", \",%u\\n\", \",%u\\n\" */\n-}\n-\n-\n void\n xtensa_output_literal (file, x, mode, labelno)\n      FILE *file;"}, {"sha": "ace3f4b9a9f5c145c4b35ad7a6d80aeada265732", "filename": "gcc/config/xtensa/xtensa.h", "status": "modified", "additions": 16, "deletions": 11, "changes": 27, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Fxtensa.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/6a2b287ffdff8f3534437cd81d930c9d5560534a/gcc%2Fconfig%2Fxtensa%2Fxtensa.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Fxtensa%2Fxtensa.h?ref=6a2b287ffdff8f3534437cd81d930c9d5560534a", "patch": "@@ -1,5 +1,5 @@\n /* Definitions of Tensilica's Xtensa target machine for GNU compiler.\n-   Copyright 2001,2002 Free Software Foundation, Inc.\n+   Copyright 2001,2002,2003 Free Software Foundation, Inc.\n    Contributed by Bob Wilson (bwilson@tensilica.com) at Tensilica.\n \n This file is part of GCC.\n@@ -208,6 +208,15 @@ extern unsigned xtensa_current_frame_size;\n       }\t\t\t\t\t\t\t\t\t\\\n   } while (0)\n \n+#define CPP_SPEC \" %(subtarget_cpp_spec) \"\n+\n+#ifndef SUBTARGET_CPP_SPEC\n+#define SUBTARGET_CPP_SPEC \"\"\n+#endif\n+\n+#define EXTRA_SPECS                                             \\\n+  { \"subtarget_cpp_spec\", SUBTARGET_CPP_SPEC },\n+\n #ifdef __XTENSA_EB__\n #define LIBGCC2_WORDS_BIG_ENDIAN 1\n #else\n@@ -1377,14 +1386,9 @@ typedef struct xtensa_args {\n /* Globalizing directive for a label.  */\n #define GLOBAL_ASM_OP \"\\t.global\\t\"\n \n-/* This says how to define a global common symbol.  */\n-#define ASM_OUTPUT_COMMON(STREAM, NAME, SIZE, ROUNDED)\t\t\t\\\n-  xtensa_declare_object (STREAM, NAME, \"\\n\\t.comm\\t\", \",%u\\n\", (SIZE))\n-\n-/* This says how to define a local common symbol (ie, not visible to\n-   linker).  */\n-#define ASM_OUTPUT_LOCAL(STREAM, NAME, SIZE, ROUNDED)\t\t\t\\\n-  xtensa_declare_object (STREAM, NAME, \"\\n\\t.lcomm\\t\", \",%u\\n\", (SIZE))\n+/* Declare an uninitialized external linkage data object.  */\n+#define ASM_OUTPUT_ALIGNED_BSS(FILE, DECL, NAME, SIZE, ALIGN) \\\n+  asm_output_aligned_bss (FILE, DECL, NAME, SIZE, ALIGN)\n \n /* This is how to output an element of a case-vector that is absolute.  */\n #define ASM_OUTPUT_ADDR_VEC_ELT(STREAM, VALUE)\t\t\t\t\\\n@@ -1430,8 +1434,9 @@ typedef struct xtensa_args {\n \n \n /* Define the strings to put out for each section in the object file.  */\n-#define TEXT_SECTION_ASM_OP\t\"\\t.text\"  \t/* instructions */\n-#define DATA_SECTION_ASM_OP\t\"\\t.data\" \t/* large data */\n+#define TEXT_SECTION_ASM_OP\t\"\\t.text\"\n+#define DATA_SECTION_ASM_OP\t\"\\t.data\"\n+#define BSS_SECTION_ASM_OP\t\"\\t.section\\t.bss\"\n \n \n /* Define output to appear before the constant pool.  If the function"}]}