{"sha": "c8bbc9ef2a33fcf34118362e6361760f179d0908", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6YzhiYmM5ZWYyYTMzZmNmMzQxMTgzNjJlNjM2MTc2MGYxNzlkMDkwOA==", "commit": {"author": {"name": "Aaron W. LaFramboise", "email": "aaronavay62@aaronwl.com", "date": "2008-08-17T05:44:15Z"}, "committer": {"name": "Aaron W. LaFramboise", "email": "aaronwl@gcc.gnu.org", "date": "2008-08-17T05:44:15Z"}, "message": "adaint.c (_gnat_set_close_on_exec): Implement.\n\n2008-08-17  Aaron W. LaFramboise  <aaronavay62@aaronwl.com>\n\n\t* adaint.c (_gnat_set_close_on_exec) [_WIN32]: Implement.\n\nFrom-SVN: r139167", "tree": {"sha": "50a0b1a629618123a3ebf29230f5bc6399c779ce", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/50a0b1a629618123a3ebf29230f5bc6399c779ce"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/c8bbc9ef2a33fcf34118362e6361760f179d0908", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8bbc9ef2a33fcf34118362e6361760f179d0908", "html_url": "https://github.com/Rust-GCC/gccrs/commit/c8bbc9ef2a33fcf34118362e6361760f179d0908", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/c8bbc9ef2a33fcf34118362e6361760f179d0908/comments", "author": null, "committer": null, "parents": [{"sha": "2f1dcfba75d9da8e84c669c401b4e09d7c89f859", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/2f1dcfba75d9da8e84c669c401b4e09d7c89f859", "html_url": "https://github.com/Rust-GCC/gccrs/commit/2f1dcfba75d9da8e84c669c401b4e09d7c89f859"}], "stats": {"total": 17, "additions": 13, "deletions": 4}, "files": [{"sha": "8aa238fc285a81248acea73ef9408394b48b2218", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8bbc9ef2a33fcf34118362e6361760f179d0908/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8bbc9ef2a33fcf34118362e6361760f179d0908/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=c8bbc9ef2a33fcf34118362e6361760f179d0908", "patch": "@@ -1,3 +1,7 @@\n+2008-08-17  Aaron W. LaFramboise  <aaronavay62@aaronwl.com>\n+\n+\t* adaint.c (_gnat_set_close_on_exec) [_WIN32]: Implement.\n+\n 2008-08-16  Eric Botcazou  <ebotcazou@adacore.com>\n \n \t* gcc-interface/trans.c (call_to_gnu): Use the Sloc of the call"}, {"sha": "48abb3e5049e66eeddf7c3c8072c1bf02ac29c64", "filename": "gcc/ada/adaint.c", "status": "modified", "additions": 9, "deletions": 4, "changes": 13, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/c8bbc9ef2a33fcf34118362e6361760f179d0908/gcc%2Fada%2Fadaint.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/c8bbc9ef2a33fcf34118362e6361760f179d0908/gcc%2Fada%2Fadaint.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fadaint.c?ref=c8bbc9ef2a33fcf34118362e6361760f179d0908", "patch": "@@ -3248,12 +3248,17 @@ __gnat_set_close_on_exec (int fd ATTRIBUTE_UNUSED,\n   else\n     flags &= ~FD_CLOEXEC;\n   return fcntl (fd, F_SETFD, flags | FD_CLOEXEC);\n+#elif defined(_WIN32)\n+  HANDLE h = (HANDLE) _get_osfhandle (fd);\n+  if (h == (HANDLE) -1)\n+    return -1;\n+  if (close_on_exec_p)\n+    return ! SetHandleInformation (h, HANDLE_FLAG_INHERIT, 0);\n+  return ! SetHandleInformation (h, HANDLE_FLAG_INHERIT, \n+    HANDLE_FLAG_INHERIT);\n #else\n+  /* TODO: Unimplemented. */\n   return -1;\n-  /* For the Windows case, we should use SetHandleInformation to remove\n-     the HANDLE_INHERIT property from fd. This is not implemented yet,\n-     but for our purposes (support of GNAT.Expect) this does not matter,\n-     as by default handles are *not* inherited. */\n #endif\n }\n "}]}