{"sha": "4c5f98981302212d58d78e6271d8df25fe6aaf56", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGM1Zjk4OTgxMzAyMjEyZDU4ZDc4ZTYyNzFkOGRmMjVmZTZhYWY1Ng==", "commit": {"author": {"name": "Paul Brook", "email": "paul@codesourcery.com", "date": "2005-04-30T19:40:53Z"}, "committer": {"name": "Paul Brook", "email": "pbrook@gcc.gnu.org", "date": "2005-04-30T19:40:53Z"}, "message": "bpabi.h (RENAME_LIBRARY_SET): Always use .thumb_set in thumb mode.\n\n2005-04-30  Paul Brook  <paul@codesourcery.com>\n\n\t* config/arm/bpabi.h (RENAME_LIBRARY_SET): Always use .thumb_set in\n\tthumb mode.\n\t* config/arm/ieee754-df.S: Use __INTERWORKING_STUBS__.\n\t* config/arm/ieee754-sf.S: Ditto.\n\t* config/arm/lib1funcs.asm: Define and use __INTERWORKING_STUBS__.\n\t(FUNC_ALIAS): Use .thumb_set for thumb routines.\n\nFrom-SVN: r99043", "tree": {"sha": "cd039051ac9ea04b6ccbc7abfde11a34ff116413", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/cd039051ac9ea04b6ccbc7abfde11a34ff116413"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4c5f98981302212d58d78e6271d8df25fe6aaf56", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c5f98981302212d58d78e6271d8df25fe6aaf56", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4c5f98981302212d58d78e6271d8df25fe6aaf56", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4c5f98981302212d58d78e6271d8df25fe6aaf56/comments", "author": null, "committer": null, "parents": [{"sha": "f6c7d65b66de4abc0318718904e5947f663b9d91", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/f6c7d65b66de4abc0318718904e5947f663b9d91", "html_url": "https://github.com/Rust-GCC/gccrs/commit/f6c7d65b66de4abc0318718904e5947f663b9d91"}], "stats": {"total": 43, "additions": 33, "deletions": 10}, "files": [{"sha": "dea40744c2e9932a4fa805c874672e831d1295f2", "filename": "gcc/ChangeLog", "status": "modified", "additions": 9, "deletions": 0, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4c5f98981302212d58d78e6271d8df25fe6aaf56", "patch": "@@ -1,3 +1,12 @@\n+2005-04-30  Paul Brook  <paul@codesourcery.com>\n+\n+\t* config/arm/bpabi.h (RENAME_LIBRARY_SET): Always use .thumb_set in\n+\tthumb mode.\n+\t* config/arm/ieee754-df.S: Use __INTERWORKING_STUBS__.\n+\t* config/arm/ieee754-sf.S: Ditto.\n+\t* config/arm/lib1funcs.asm: Define and use __INTERWORKING_STUBS__.\n+\t(FUNC_ALIAS): Use .thumb_set for thumb routines.\n+\n 2005-04-30  Kazu Hirata  <kazu@cs.umass.edu>\n \n \t* tree-ssanames.c: Fix a comment typo."}, {"sha": "ddf55d963191c7b787a0659129148b8297f4a505", "filename": "gcc/config/arm/bpabi.h", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Fbpabi.h", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Fbpabi.h", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fbpabi.h?ref=4c5f98981302212d58d78e6271d8df25fe6aaf56", "patch": "@@ -46,7 +46,7 @@\n   \"%{static:-Bstatic} %{shared:-shared} %{symbolic:-Bsymbolic} \"\t\\\n   \"-X\"\n \n-#if defined (__thumb__) && !defined (__THUMB_INTERWORK__) \n+#if defined (__thumb__)\n #define RENAME_LIBRARY_SET \".thumb_set\"\n #else\n #define RENAME_LIBRARY_SET \".set\""}, {"sha": "570e77f0a5101b6dbbc6c31643f59ef071add29e", "filename": "gcc/config/arm/ieee754-df.S", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Fieee754-df.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Fieee754-df.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fieee754-df.S?ref=4c5f98981302212d58d78e6271d8df25fe6aaf56", "patch": "@@ -81,7 +81,7 @@ ARM_FUNC_START subdf3\n ARM_FUNC_ALIAS aeabi_dsub subdf3\n \n \teor\tyh, yh, #0x80000000\t@ flip sign bit of second arg\n-#if defined(__thumb__) && !defined(__THUMB_INTERWORK__)\n+#if defined(__INTERWORKING_STUBS__)\n \tb\t1f\t\t\t@ Skip Thumb-code prologue\n #endif\n "}, {"sha": "19fb03f7bbfd5a123fc6384acd4006ac6582d9b0", "filename": "gcc/config/arm/ieee754-sf.S", "status": "modified", "additions": 1, "deletions": 1, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Fieee754-sf.S", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Fieee754-sf.S", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Fieee754-sf.S?ref=4c5f98981302212d58d78e6271d8df25fe6aaf56", "patch": "@@ -62,7 +62,7 @@ ARM_FUNC_START subsf3\n ARM_FUNC_ALIAS aeabi_fsub subsf3\n \n \teor\tr1, r1, #0x80000000\t@ flip sign bit of second arg\n-#if defined(__thumb__) && !defined(__THUMB_INTERWORK__)\n+#if defined(__INTERWORKING_STUBS__)\n \tb\t1f\t\t\t@ Skip Thumb-code prologue\n #endif\n "}, {"sha": "4e3c8a3317d0cc53c42a856ed6fd3f459d8bc76a", "filename": "gcc/config/arm/lib1funcs.asm", "status": "modified", "additions": 21, "deletions": 7, "changes": 28, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Flib1funcs.asm", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4c5f98981302212d58d78e6271d8df25fe6aaf56/gcc%2Fconfig%2Farm%2Flib1funcs.asm", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fconfig%2Farm%2Flib1funcs.asm?ref=4c5f98981302212d58d78e6271d8df25fe6aaf56", "patch": "@@ -94,10 +94,20 @@ Boston, MA 02111-1307, USA.  */\n # define RET\t\tbx\tlr\n # define RETc(x)\tbx##x\tlr\n \n-# if (__ARM_ARCH__ == 4) \\\n-\t&& (defined(__thumb__) || defined(__THUMB_INTERWORK__))\n-#  define __INTERWORKING__\n-# endif\n+/* Special precautions for interworking on armv4t.  */\n+# if (__ARM_ARCH__ == 4)\n+\n+/* Always use bx, not ldr pc.  */\n+#  if (defined(__thumb__) || defined(__THUMB_INTERWORK__))\n+#    define __INTERWORKING__\n+#   endif /* __THUMB__ || __THUMB_INTERWORK__ */\n+\n+/* Include thumb stub before arm mode code.  */\n+#  if defined(__thumb__) && !defined(__THUMB_INTERWORK__)\n+#   define __INTERWORKING_STUBS__\n+#  endif /* __thumb__ && !__THUMB_INTERWORK__ */\n+\n+#endif /* __ARM_ARCH == 4 */\n \n #else\n \n@@ -192,7 +202,7 @@ SYM (__\\name):\n /* Special function that will always be coded in ARM assembly, even if\n    in Thumb-only compilation.  */\n \n-#if defined(__thumb__) && !defined(__THUMB_INTERWORK__)\n+#if defined(__INTERWORKING_STUBS__)\n .macro\tARM_FUNC_START name\n \tFUNC_START \\name\n \tbx\tpc\n@@ -225,13 +235,17 @@ SYM (__\\name):\n \n .macro\tFUNC_ALIAS new old\n \t.globl\tSYM (__\\new)\n-\tEQUIV\tSYM (__\\new), SYM (__\\old)\n+#if defined (__thumb__)\n+\t.thumb_set\tSYM (__\\new), SYM (__\\old)\n+#else\n+\t.set\tSYM (__\\new), SYM (__\\old)\n+#endif\n .endm\n \n .macro\tARM_FUNC_ALIAS new old\n \t.globl\tSYM (__\\new)\n \tEQUIV\tSYM (__\\new), SYM (__\\old)\n-#ifdef __thumb__\n+#if defined(__INTERWORKING_STUBS__)\n \t.set\tSYM (_L__\\new), SYM (_L__\\old)\n #endif\n .endm"}]}