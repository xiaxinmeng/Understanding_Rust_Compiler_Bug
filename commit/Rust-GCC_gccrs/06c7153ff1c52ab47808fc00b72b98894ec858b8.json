{"sha": "06c7153ff1c52ab47808fc00b72b98894ec858b8", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MDZjNzE1M2ZmMWM1MmFiNDc4MDhmYzAwYjcyYjk4ODk0ZWM4NThiOA==", "commit": {"author": {"name": "Tobias Burnus", "email": "burnus@net-b.de", "date": "2008-09-10T11:54:08Z"}, "committer": {"name": "Tobias Burnus", "email": "burnus@gcc.gnu.org", "date": "2008-09-10T11:54:08Z"}, "message": "re PR fortran/37420 (-Wunused-variable broken)\n\n2008-09-10  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/37420\n        * trans-decl.c (get_proc_pointer_decl): Fix -Wunused-variable.\n\n2008-09-10  Tobias Burnus  <burnus@net-b.de>\n\n        PR fortran/37420\n        * gfortran.dg/warn_unused_var.f90: New test.\n        * gfortran.dg/warn_unused_var.f90: Add cleanup-modules.\n\nFrom-SVN: r140229", "tree": {"sha": "4b1804650c69f8c70dc898ed525903125bdbcdbf", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/4b1804650c69f8c70dc898ed525903125bdbcdbf"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/06c7153ff1c52ab47808fc00b72b98894ec858b8", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06c7153ff1c52ab47808fc00b72b98894ec858b8", "html_url": "https://github.com/Rust-GCC/gccrs/commit/06c7153ff1c52ab47808fc00b72b98894ec858b8", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/06c7153ff1c52ab47808fc00b72b98894ec858b8/comments", "author": {"login": "tob2", "id": 264461, "node_id": "MDQ6VXNlcjI2NDQ2MQ==", "avatar_url": "https://avatars.githubusercontent.com/u/264461?v=4", "gravatar_id": "", "url": "https://api.github.com/users/tob2", "html_url": "https://github.com/tob2", "followers_url": "https://api.github.com/users/tob2/followers", "following_url": "https://api.github.com/users/tob2/following{/other_user}", "gists_url": "https://api.github.com/users/tob2/gists{/gist_id}", "starred_url": "https://api.github.com/users/tob2/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/tob2/subscriptions", "organizations_url": "https://api.github.com/users/tob2/orgs", "repos_url": "https://api.github.com/users/tob2/repos", "events_url": "https://api.github.com/users/tob2/events{/privacy}", "received_events_url": "https://api.github.com/users/tob2/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "99e395c716b65987be6f026628bc2122990b5347", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/99e395c716b65987be6f026628bc2122990b5347", "html_url": "https://github.com/Rust-GCC/gccrs/commit/99e395c716b65987be6f026628bc2122990b5347"}], "stats": {"total": 36, "additions": 29, "deletions": 7}, "files": [{"sha": "eef75e2bbd79f862c0081f3c93b0fdb00fff5312", "filename": "gcc/fortran/ChangeLog", "status": "modified", "additions": 5, "deletions": 0, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ffortran%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ffortran%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2FChangeLog?ref=06c7153ff1c52ab47808fc00b72b98894ec858b8", "patch": "@@ -1,3 +1,8 @@\n+2008-09-10  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/37420\n+\t* trans-decl.c (get_proc_pointer_decl): Fix -Wunused-variable.\n+\n 2008-09-09  Daniel Kraft  <d@domob.eu>\n \n \tPR fortran/37429"}, {"sha": "ec00ee2ee8fda124051db02c8f59e7b7246dbe57", "filename": "gcc/fortran/trans-decl.c", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ffortran%2Ftrans-decl.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ffortran%2Ftrans-decl.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ffortran%2Ftrans-decl.c?ref=06c7153ff1c52ab47808fc00b72b98894ec858b8", "patch": "@@ -1170,7 +1170,8 @@ get_proc_pointer_decl (gfc_symbol *sym)\n   decl = build_decl (VAR_DECL, get_identifier (sym->name),\n \t\t     build_pointer_type (gfc_get_function_type (sym)));\n \n-  if (sym->ns->proc_name->backend_decl == current_function_decl\n+  if ((sym->ns->proc_name\n+      && sym->ns->proc_name->backend_decl == current_function_decl)\n       || sym->attr.contained)\n     gfc_add_decl_to_function (decl);\n   else\n@@ -3476,11 +3477,6 @@ generate_local_decl (gfc_symbol * sym)\n {\n   if (sym->attr.flavor == FL_VARIABLE)\n     {\n-      /* Check for dependencies in the array specification and string\n-\tlength, adding the necessary declarations to the function.  We\n-\tmark the symbol now, as well as in traverse_ns, to prevent\n-\tgetting stuck in a circular dependency.  */\n-      sym->mark = 1;\n       if (!sym->attr.dummy && !sym->ns->proc_name->attr.entry_master)\n         generate_dependency_declarations (sym);\n \n@@ -3516,6 +3512,12 @@ generate_local_decl (gfc_symbol * sym)\n \t  gfc_get_symbol_decl (sym);\n \t}\n \n+      /* Check for dependencies in the array specification and string\n+\tlength, adding the necessary declarations to the function.  We\n+\tmark the symbol now, as well as in traverse_ns, to prevent\n+\tgetting stuck in a circular dependency.  */\n+      sym->mark = 1;\n+\n       /* We do not want the middle-end to warn about unused parameters\n          as this was already done above.  */\n       if (sym->attr.dummy && sym->backend_decl != NULL_TREE)\n@@ -3545,7 +3547,7 @@ generate_local_decl (gfc_symbol * sym)\n \t\t        &sym->result->declared_at);\n \n \t  /* Prevents \"Unused variable\" warning for RESULT variables.  */\n-\t  sym->mark = sym->result->mark = 1;\n+\t  sym->result->mark = 1;\n \t}\n     }\n "}, {"sha": "f78e376cea9d0b33c152b8737d0c12e0e9caf795", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=06c7153ff1c52ab47808fc00b72b98894ec858b8", "patch": "@@ -1,3 +1,9 @@\n+2008-09-10  Tobias Burnus  <burnus@net-b.de>\n+\n+\tPR fortran/37420\n+\t* gfortran.dg/warn_unused_var.f90: New test.\n+\t* gfortran.dg/warn_unused_var.f90: Add cleanup-modules.\n+\n 2008-09-10  Jakub Jelinek  <jakub@redhat.com>\n \n \tPR tree-optimization/37353"}, {"sha": "4e9c256d286c5642bf30351517208dd439f79808", "filename": "gcc/testsuite/gfortran.dg/implicit_12.f90", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ftestsuite%2Fgfortran.dg%2Fimplicit_12.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ftestsuite%2Fgfortran.dg%2Fimplicit_12.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fimplicit_12.f90?ref=06c7153ff1c52ab47808fc00b72b98894ec858b8", "patch": "@@ -21,3 +21,5 @@ program startest\n    if('#'//Q2//'#' /='#abcdefghijkl#') call abort()\n    call sub('ABCDEFGHIJKLM') ! len=13\n end program startest\n+\n+! { dg-final { cleanup-modules \"mod\" } }"}, {"sha": "1858e68524022099e63dbef4c1b47343efe9f57e", "filename": "gcc/testsuite/gfortran.dg/warn_unused_var.f90", "status": "added", "additions": 7, "deletions": 0, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarn_unused_var.f90", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/06c7153ff1c52ab47808fc00b72b98894ec858b8/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarn_unused_var.f90", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgfortran.dg%2Fwarn_unused_var.f90?ref=06c7153ff1c52ab47808fc00b72b98894ec858b8", "patch": "@@ -0,0 +1,7 @@\n+! { dg-do compile }\n+! { dg-options \"-Wunused-variable\" }\n+!\n+! PR fortran/37420\n+!\n+integer :: i ! { dg-warning \"Unused variable\" }\n+end"}]}