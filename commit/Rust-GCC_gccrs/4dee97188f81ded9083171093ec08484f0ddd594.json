{"sha": "4dee97188f81ded9083171093ec08484f0ddd594", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6NGRlZTk3MTg4ZjgxZGVkOTA4MzE3MTA5M2VjMDg0ODRmMGRkZDU5NA==", "commit": {"author": {"name": "Jakub Jelinek", "email": "jakub@redhat.com", "date": "2011-08-18T14:13:48Z"}, "committer": {"name": "Jakub Jelinek", "email": "jakub@gcc.gnu.org", "date": "2011-08-18T14:13:48Z"}, "message": "re PR debug/50017 (-fcompare-debug failure)\n\n\tPR debug/50017\n\t* tree-vect-stmts.c (vect_finish_stmt_generation): If gsi_stmt (*gsi)\n\tis a debug stmt, use location of the first non-debug stmt after it.\n\n\t* gcc.dg/pr50017.c: New test.\n\nFrom-SVN: r177857", "tree": {"sha": "2dee4b68013228a0d627c8406e6c90dba807856f", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/2dee4b68013228a0d627c8406e6c90dba807856f"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/4dee97188f81ded9083171093ec08484f0ddd594", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4dee97188f81ded9083171093ec08484f0ddd594", "html_url": "https://github.com/Rust-GCC/gccrs/commit/4dee97188f81ded9083171093ec08484f0ddd594", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/4dee97188f81ded9083171093ec08484f0ddd594/comments", "author": {"login": "jakubjelinek", "id": 9370665, "node_id": "MDQ6VXNlcjkzNzA2NjU=", "avatar_url": "https://avatars.githubusercontent.com/u/9370665?v=4", "gravatar_id": "", "url": "https://api.github.com/users/jakubjelinek", "html_url": "https://github.com/jakubjelinek", "followers_url": "https://api.github.com/users/jakubjelinek/followers", "following_url": "https://api.github.com/users/jakubjelinek/following{/other_user}", "gists_url": "https://api.github.com/users/jakubjelinek/gists{/gist_id}", "starred_url": "https://api.github.com/users/jakubjelinek/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/jakubjelinek/subscriptions", "organizations_url": "https://api.github.com/users/jakubjelinek/orgs", "repos_url": "https://api.github.com/users/jakubjelinek/repos", "events_url": "https://api.github.com/users/jakubjelinek/events{/privacy}", "received_events_url": "https://api.github.com/users/jakubjelinek/received_events", "type": "User", "site_admin": false}, "committer": null, "parents": [{"sha": "51fdcb386bf919fcc212bd9864853d18afdae163", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/51fdcb386bf919fcc212bd9864853d18afdae163", "html_url": "https://github.com/Rust-GCC/gccrs/commit/51fdcb386bf919fcc212bd9864853d18afdae163"}], "stats": {"total": 40, "additions": 38, "deletions": 2}, "files": [{"sha": "d7df6315d18e9f9828bfe5cd6571807828ad7433", "filename": "gcc/ChangeLog", "status": "modified", "additions": 6, "deletions": 0, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2FChangeLog?ref=4dee97188f81ded9083171093ec08484f0ddd594", "patch": "@@ -1,3 +1,9 @@\n+2011-08-18  Jakub Jelinek  <jakub@redhat.com>\n+\n+\tPR debug/50017\n+\t* tree-vect-stmts.c (vect_finish_stmt_generation): If gsi_stmt (*gsi)\n+\tis a debug stmt, use location of the first non-debug stmt after it.\n+\n 2011-08-18  Richard Sandiford  <richard.sandiford@linaro.org>\n \n \t* config/arm/arm.c (arm_rtx_costs_1): Don't modify the costs of SET."}, {"sha": "0b09a0cca248501773ce1b59e217bc34c4ede63e", "filename": "gcc/testsuite/ChangeLog", "status": "modified", "additions": 3, "deletions": 0, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2Ftestsuite%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2Ftestsuite%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2FChangeLog?ref=4dee97188f81ded9083171093ec08484f0ddd594", "patch": "@@ -2,6 +2,9 @@\n \n \t* g++.dg/plugin/decl_plugin.c: Include diagnostic.h.\n \n+\tPR debug/50017\n+\t* gcc.dg/pr50017.c: New test.\n+\n 2011-08-18  Dodji Seketeli  <dodji@redhat.com>\n \n \tPR c++/45625"}, {"sha": "66bef007da15ab565868c9222bf096c78e263ab3", "filename": "gcc/testsuite/gcc.dg/pr50017.c", "status": "added", "additions": 20, "deletions": 0, "changes": 20, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2Ftestsuite%2Fgcc.dg%2Fpr50017.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2Ftestsuite%2Fgcc.dg%2Fpr50017.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftestsuite%2Fgcc.dg%2Fpr50017.c?ref=4dee97188f81ded9083171093ec08484f0ddd594", "patch": "@@ -0,0 +1,20 @@\n+/* PR debug/50017 */\n+/* { dg-do compile } */\n+/* { dg-options \"-O3 -fcompare-debug\" } */\n+\n+struct S { int r, i; };\n+\n+void\n+foo (struct S *x, int y)\n+{\n+  int i;\n+  for (i = 1; i < y; i++)\n+    {\n+      struct S a, b, c;\n+      a = x[0];\n+      b = x[i];\n+      c.r = a.r * b.r - a.i * b.i;\n+      c.i = a.r * b.i + a.i * b.r;\n+      x[i] = c;\n+    }\n+}"}, {"sha": "c0ca2af8e8022a5e3ea4c8d1ce3f3b495dcae020", "filename": "gcc/tree-vect-stmts.c", "status": "modified", "additions": 9, "deletions": 2, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2Ftree-vect-stmts.c", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/4dee97188f81ded9083171093ec08484f0ddd594/gcc%2Ftree-vect-stmts.c", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Ftree-vect-stmts.c?ref=4dee97188f81ded9083171093ec08484f0ddd594", "patch": "@@ -1,5 +1,5 @@\n /* Statement Analysis and Transformation for Vectorization\n-   Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010\n+   Copyright (C) 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011\n    Free Software Foundation, Inc.\n    Contributed by Dorit Naishlos <dorit@il.ibm.com>\n    and Ira Rosen <irar@il.ibm.com>\n@@ -1419,6 +1419,7 @@ vect_finish_stmt_generation (gimple stmt, gimple vec_stmt,\n   stmt_vec_info stmt_info = vinfo_for_stmt (stmt);\n   loop_vec_info loop_vinfo = STMT_VINFO_LOOP_VINFO (stmt_info);\n   bb_vec_info bb_vinfo = STMT_VINFO_BB_VINFO (stmt_info);\n+  gimple_stmt_iterator si;\n \n   gcc_assert (gimple_code (stmt) != GIMPLE_LABEL);\n \n@@ -1433,7 +1434,13 @@ vect_finish_stmt_generation (gimple stmt, gimple vec_stmt,\n       print_gimple_stmt (vect_dump, vec_stmt, 0, TDF_SLIM);\n     }\n \n-  gimple_set_location (vec_stmt, gimple_location (gsi_stmt (*gsi)));\n+  si = *gsi;\n+  if (is_gimple_debug (gsi_stmt (si)))\n+    {\n+      gsi_next_nondebug (&si);\n+      gcc_assert (!gsi_end_p (si));\n+    }\n+  gimple_set_location (vec_stmt, gimple_location (gsi_stmt (si)));\n }\n \n /* Checks if CALL can be vectorized in type VECTYPE.  Returns"}]}