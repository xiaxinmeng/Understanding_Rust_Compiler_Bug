{"sha": "246d2ceb324bb3483062b211a262aa290f5ecf41", "node_id": "MDY6Q29tbWl0MTM2NTMxMDA6MjQ2ZDJjZWIzMjRiYjM0ODMwNjJiMjExYTI2MmFhMjkwZjVlY2Y0MQ==", "commit": {"author": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2004-06-28T14:37:05Z"}, "committer": {"name": "Arnaud Charlet", "email": "charlet@gcc.gnu.org", "date": "2004-06-28T14:37:05Z"}, "message": "[multiple changes]\n\n2004-06-28  Robert Dewar  <dewar@gnat.com>\n\n\t* mlib-tgt-tru64.adb, mlib-tgt-aix.adb, mlib-tgt-irix.adb,\n\tmlib-tgt-irix.adb, mlib-tgt-hpux.adb, mlib-tgt-linux.adb,\n\tmlib-tgt-linux.adb, mlib-tgt-solaris.adb, mlib-tgt-solaris.adb,\n\tmlib-tgt-vms-alpha.adb, mlib-tgt-vms-alpha.adb, mlib-tgt-vms-ia64.adb,\n\ta-strmap.adb, a-strmap.ads, clean.adb: Minor reformatting\n\n\t* exp_util.adb (Is_Possibly_Unaligned_Slice): Completely rewritten, to\n\tdeal with problem of inefficient slices on machines with strict\n\talignment, when the slice is a component of a composite.\n\n\t* checks.adb (Apply_Array_Size_Check): Do not special case 64-bit\n\tmachines, we need the check there as well.\n\n2004-06-28  Ed Schonberg  <schonberg@gnat.com>\n\n\t* exp_ch5.adb (Expand_Assign_Array): Use correct condition to\n\tdetermine safe copying direction for overlapping slice assignments\n\twhen component is controlled.\n\n\t* sem_ch12.adb (Instantiate_Formal_Package): Implicit operations of a\n\tformal derived type in the actual for a formal package are visible in\n\tthe enclosing instance.\n\n2004-06-28  Ed Schonberg  <schonberg@gnat.com>\n\n\tPR ada/15600\n\t* sem_util.adb (Trace_Components): Diagnose properly an illegal\n\tcircularity involving a private type whose completion includes a\n\tself-referential component.\n\t(Enter_Name): Use Is_Inherited_Operation to distinguish a source\n\trenaming or an instantiation from an implicit derived operation.\n\n2004-06-28  Pascal Obry  <obry@gnat.com>\n\n\t* mlib-tgt-mingw.adb: (Library_Exists_For): Remove \"lib\" prefix from\n\tDLL.\n\t(Library_File_Name_For): Idem.\n\n2004-06-28  Matthew Gingell  <gingell@gnat.com>\n\n\t* g-traceb.ads: Add explanatory note on the format of addresses\n\texpected by addr2line.\n\n2004-06-28  Jerome Guitton  <guitton@act-europe.fr>\n\n\t* Makefile.in: Force debugging information on s-tasdeb.adb,\n\ta-except.adb and s-assert.adb needed by the debugger.\n\n2004-06-28  Vincent Celier  <celier@gnat.com>\n\n\t* make.adb (Collect_Arguments_And_Compile): Change Flag1 to\n\tNeed_To_Build_Lib.\n\t(Gnatmake): Ditto.\n\n\t* mlib-prj.adb (Check_Library): Replace Flag1 with Need_To_Build_Lib\n\n\t* prj.adb: Minor reformatting\n\t(Project_Empty): Change Flag1 to Need_To_Build_Lib. Remove Flag2.\n\n\t* prj.ads: Comment updates\n\tMinor reformatting\n\t(Project_Data): Change Flag1 to Need_To_Build_Lib.\n\tRemove Flag2: not used.\n\n\t* prj-dect.adb (Parse_Declarative_Items): Accept \"null\" as a\n\tdeclaration.\n\n\t* gnat_ugn.texi: Put a \"null;\" declaration in one project file example\n\n\t* gnat_rm.texi: Document Empty declarations \"null;\".\n\n\t* makegpr.adb (Compile_Link_With_Gnatmake): Put the global archives in\n\tfront of the linker options.\n\t(Link_Foreign): Put the global archives and the libraries in front of\n\tthe linker options.\n\n2004-06-28  Javier Miranda  <miranda@gnat.com>\n\n\t* rtsfind.adb: (Get_Unit_Name): Fix typo in comment\n\t(RTU_Loaded): Code cleanup\n\t(Set_RTU_Loaded): New procedure to register as *loaded* explicitly\n\twithed predefined units.\n\n\t* rtsfind.ads (Set_RTU_Loaded): New procedure to register as *loaded*\n\texplicitly withed predefined units.\n\tFix typo in comment\n\n\t* sem_ch10.adb (Analyze_Compilation_Unit): Register as *loaded*\n\texplicitly withed predefined units.\n\nFrom-SVN: r83789", "tree": {"sha": "c84a063a47e404a2c3fd2bf0942d1e94a944cbfe", "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/trees/c84a063a47e404a2c3fd2bf0942d1e94a944cbfe"}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/git/commits/246d2ceb324bb3483062b211a262aa290f5ecf41", "comment_count": 0, "verification": {"verified": false, "reason": "unsigned", "signature": null, "payload": null}}, "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/246d2ceb324bb3483062b211a262aa290f5ecf41", "html_url": "https://github.com/Rust-GCC/gccrs/commit/246d2ceb324bb3483062b211a262aa290f5ecf41", "comments_url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/246d2ceb324bb3483062b211a262aa290f5ecf41/comments", "author": null, "committer": null, "parents": [{"sha": "45da19e38e9b2fecb8c4c609ba2b99be9dcc84ae", "url": "https://api.github.com/repos/Rust-GCC/gccrs/commits/45da19e38e9b2fecb8c4c609ba2b99be9dcc84ae", "html_url": "https://github.com/Rust-GCC/gccrs/commit/45da19e38e9b2fecb8c4c609ba2b99be9dcc84ae"}], "stats": {"total": 881, "additions": 564, "deletions": 317}, "files": [{"sha": "77132fbcd98790a924fc4bafbf271728334ccc28", "filename": "gcc/ada/ChangeLog", "status": "modified", "additions": 92, "deletions": 0, "changes": 92, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2FChangeLog", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2FChangeLog", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FChangeLog?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -1,3 +1,95 @@\n+2004-06-28  Robert Dewar  <dewar@gnat.com>\n+\n+\t* mlib-tgt-tru64.adb, mlib-tgt-aix.adb, mlib-tgt-irix.adb,\n+\tmlib-tgt-irix.adb, mlib-tgt-hpux.adb, mlib-tgt-linux.adb,\n+\tmlib-tgt-linux.adb, mlib-tgt-solaris.adb, mlib-tgt-solaris.adb,\n+\tmlib-tgt-vms-alpha.adb, mlib-tgt-vms-alpha.adb, mlib-tgt-vms-ia64.adb,\n+\ta-strmap.adb, a-strmap.ads, clean.adb: Minor reformatting\n+\n+\t* exp_util.adb (Is_Possibly_Unaligned_Slice): Completely rewritten, to\n+\tdeal with problem of inefficient slices on machines with strict\n+\talignment, when the slice is a component of a composite.\n+\n+\t* checks.adb (Apply_Array_Size_Check): Do not special case 64-bit\n+\tmachines, we need the check there as well.\n+\n+2004-06-28  Ed Schonberg  <schonberg@gnat.com>\n+\n+\t* exp_ch5.adb (Expand_Assign_Array): Use correct condition to\n+\tdetermine safe copying direction for overlapping slice assignments\n+\twhen component is controlled.\n+\n+\t* sem_ch12.adb (Instantiate_Formal_Package): Implicit operations of a\n+\tformal derived type in the actual for a formal package are visible in\n+\tthe enclosing instance.\n+\n+2004-06-28  Ed Schonberg  <schonberg@gnat.com>\n+\n+\tPR ada/15600\n+\t* sem_util.adb (Trace_Components): Diagnose properly an illegal\n+\tcircularity involving a private type whose completion includes a\n+\tself-referential component.\n+\t(Enter_Name): Use Is_Inherited_Operation to distinguish a source\n+\trenaming or an instantiation from an implicit derived operation.\n+\n+2004-06-28  Pascal Obry  <obry@gnat.com>\n+\n+\t* mlib-tgt-mingw.adb: (Library_Exists_For): Remove \"lib\" prefix from\n+\tDLL.\n+\t(Library_File_Name_For): Idem.\n+\n+2004-06-28  Matthew Gingell  <gingell@gnat.com>\n+\n+\t* g-traceb.ads: Add explanatory note on the format of addresses\n+\texpected by addr2line.\n+\n+2004-06-28  Jerome Guitton  <guitton@act-europe.fr>\n+\n+\t* Makefile.in: Force debugging information on s-tasdeb.adb,\n+\ta-except.adb and s-assert.adb needed by the debugger.\n+\n+2004-06-28  Vincent Celier  <celier@gnat.com>\n+\n+\t* make.adb (Collect_Arguments_And_Compile): Change Flag1 to\n+\tNeed_To_Build_Lib.\n+\t(Gnatmake): Ditto.\n+\n+\t* mlib-prj.adb (Check_Library): Replace Flag1 with Need_To_Build_Lib\n+\n+\t* prj.adb: Minor reformatting\n+\t(Project_Empty): Change Flag1 to Need_To_Build_Lib. Remove Flag2.\n+\n+\t* prj.ads: Comment updates\n+\tMinor reformatting\n+\t(Project_Data): Change Flag1 to Need_To_Build_Lib.\n+\tRemove Flag2: not used.\n+\n+\t* prj-dect.adb (Parse_Declarative_Items): Accept \"null\" as a\n+\tdeclaration.\n+\n+\t* gnat_ugn.texi: Put a \"null;\" declaration in one project file example\n+\n+\t* gnat_rm.texi: Document Empty declarations \"null;\".\n+\n+\t* makegpr.adb (Compile_Link_With_Gnatmake): Put the global archives in\n+\tfront of the linker options.\n+\t(Link_Foreign): Put the global archives and the libraries in front of\n+\tthe linker options.\n+\n+2004-06-28  Javier Miranda  <miranda@gnat.com>\n+\n+\t* rtsfind.adb: (Get_Unit_Name): Fix typo in comment\n+\t(RTU_Loaded): Code cleanup\n+\t(Set_RTU_Loaded): New procedure to register as *loaded* explicitly\n+\twithed predefined units.\n+\n+\t* rtsfind.ads (Set_RTU_Loaded): New procedure to register as *loaded*\n+\texplicitly withed predefined units.\n+\tFix typo in comment\n+\n+\t* sem_ch10.adb (Analyze_Compilation_Unit): Register as *loaded*\n+\texplicitly withed predefined units.\n+\n 2004-06-25  Pascal Obry  <obry@gnat.com>\n \n \t* makegpr.adb (Build_Library): Remove parameter Lib_Address and"}, {"sha": "f7bcfe0c5a6af13d8b5d0f3072db6cb79fea5697", "filename": "gcc/ada/Makefile.in", "status": "modified", "additions": 22, "deletions": 0, "changes": 22, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2FMakefile.in", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2FMakefile.in", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2FMakefile.in?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -1892,6 +1892,28 @@ endif\n s-traceb.o  : s-traceb.adb\n \t$(CC) -c $(ALL_ADAFLAGS) $(FORCE_DEBUG_ADAFLAGS) \\\n \t      $(NO_SIBLING_ADAFLAGS) $(ADA_INCLUDES) \\\n+      $< $(OUTPUT_OPTION)\n+\n+# force debugging information on s-tasdeb.o so that it is always\n+# possible to set conditional breakpoints on tasks.\n+\n+s-tasdeb.o  : s-tasdeb.adb s-tasdeb.ads\n+\t$(CC) -c $(ALL_ADAFLAGS) $(FORCE_DEBUG_ADAFLAGS) -O0 $(ADA_INCLUDES) \\\n+\t      $< $(OUTPUT_OPTION)\n+\n+# force debugging information on a-except.o so that it is always\n+# possible to set conditional breakpoints on exceptions.\n+# use -O1 otherwise gdb isn't able to get a full backtrace on mips targets.\n+\n+a-except.o  : a-except.adb a-except.ads\n+\t$(CC) -c $(ALL_ADAFLAGS) $(FORCE_DEBUG_ADAFLAGS) -O1 -fno-inline \\\n+\t      $(ADA_INCLUDES) $< $(OUTPUT_OPTION)\n+\n+# force debugging information on s-assert.o so that it is always\n+# possible to set breakpoint on assert failures.\n+\n+s-assert.o  : s-assert.adb s-assert.ads a-except.ads\n+\t$(CC) -c $(ALL_ADAFLAGS) $(FORCE_DEBUG_ADAFLAGS) -O2 $(ADA_INCLUDES) \\\n \t      $< $(OUTPUT_OPTION)\n \n adadecode.o : adadecode.c adadecode.h"}, {"sha": "9c6edda677b4205deb9629cd9b474bcf8b7c4421", "filename": "gcc/ada/a-strmap.adb", "status": "modified", "additions": 21, "deletions": 32, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fa-strmap.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fa-strmap.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-strmap.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -6,7 +6,7 @@\n --                                                                          --\n --                                 B o d y                                  --\n --                                                                          --\n---          Copyright (C) 1992-2002 Free Software Foundation, Inc.          --\n+--          Copyright (C) 1992-2004 Free Software Foundation, Inc.          --\n --                                                                          --\n -- GNAT is free software;  you can  redistribute it  and/or modify it under --\n -- terms of the  GNU General Public License as published  by the Free Soft- --\n@@ -54,7 +54,7 @@ package body Ada.Strings.Maps is\n    -- \"=\" --\n    ---------\n \n-   function \"=\" (Left, Right : in Character_Set) return Boolean is\n+   function \"=\" (Left, Right : Character_Set) return Boolean is\n    begin\n       return Character_Set_Internal (Left) = Character_Set_Internal (Right);\n    end \"=\";\n@@ -63,7 +63,7 @@ package body Ada.Strings.Maps is\n    -- \"and\" --\n    -----------\n \n-   function \"and\" (Left, Right : in Character_Set) return Character_Set is\n+   function \"and\" (Left, Right : Character_Set) return Character_Set is\n    begin\n       return Character_Set\n         (Character_Set_Internal (Left) and Character_Set_Internal (Right));\n@@ -73,7 +73,7 @@ package body Ada.Strings.Maps is\n    -- \"not\" --\n    -----------\n \n-   function \"not\" (Right : in Character_Set) return Character_Set is\n+   function \"not\" (Right : Character_Set) return Character_Set is\n    begin\n       return Character_Set (not Character_Set_Internal (Right));\n    end \"not\";\n@@ -82,7 +82,7 @@ package body Ada.Strings.Maps is\n    -- \"or\" --\n    ----------\n \n-   function \"or\" (Left, Right : in Character_Set) return Character_Set is\n+   function \"or\" (Left, Right : Character_Set) return Character_Set is\n    begin\n       return Character_Set\n         (Character_Set_Internal (Left) or Character_Set_Internal (Right));\n@@ -92,7 +92,7 @@ package body Ada.Strings.Maps is\n    -- \"xor\" --\n    -----------\n \n-   function \"xor\" (Left, Right : in Character_Set) return Character_Set is\n+   function \"xor\" (Left, Right : Character_Set) return Character_Set is\n    begin\n       return Character_Set\n         (Character_Set_Internal (Left) xor Character_Set_Internal (Right));\n@@ -104,8 +104,7 @@ package body Ada.Strings.Maps is\n \n    function Is_In\n      (Element : Character;\n-      Set     : Character_Set)\n-      return    Boolean\n+      Set     : Character_Set) return Boolean\n    is\n    begin\n       return Set (Element);\n@@ -117,8 +116,7 @@ package body Ada.Strings.Maps is\n \n    function Is_Subset\n      (Elements : Character_Set;\n-      Set      : Character_Set)\n-      return     Boolean\n+      Set      : Character_Set) return Boolean\n    is\n    begin\n       return (Elements and Set) = Elements;\n@@ -128,7 +126,7 @@ package body Ada.Strings.Maps is\n    -- To_Domain --\n    ---------------\n \n-   function To_Domain (Map : in Character_Mapping) return Character_Sequence\n+   function To_Domain (Map : Character_Mapping) return Character_Sequence\n    is\n       Result : String (1 .. Map'Length);\n       J      : Natural;\n@@ -150,8 +148,7 @@ package body Ada.Strings.Maps is\n    ----------------\n \n    function To_Mapping\n-     (From, To : in Character_Sequence)\n-      return     Character_Mapping\n+     (From, To : Character_Sequence) return Character_Mapping\n    is\n       Result   : Character_Mapping;\n       Inserted : Character_Set := Null_Set;\n@@ -183,11 +180,10 @@ package body Ada.Strings.Maps is\n    -- To_Range --\n    --------------\n \n-   function To_Range (Map : in Character_Mapping) return Character_Sequence\n+   function To_Range (Map : Character_Mapping) return Character_Sequence\n    is\n       Result : String (1 .. Map'Length);\n       J      : Natural;\n-\n    begin\n       J := 0;\n       for C in Map'Range loop\n@@ -204,7 +200,7 @@ package body Ada.Strings.Maps is\n    -- To_Ranges --\n    ---------------\n \n-   function To_Ranges (Set : in Character_Set) return Character_Ranges is\n+   function To_Ranges (Set : Character_Set) return Character_Ranges is\n       Max_Ranges : Character_Ranges (1 .. Set'Length / 2 + 1);\n       Range_Num  : Natural;\n       C          : Character;\n@@ -214,7 +210,7 @@ package body Ada.Strings.Maps is\n       Range_Num := 0;\n \n       loop\n-         --  Skip gap between subsets.\n+         --  Skip gap between subsets\n \n          while not Set (C) loop\n             exit when C = Character'Last;\n@@ -226,7 +222,7 @@ package body Ada.Strings.Maps is\n          Range_Num := Range_Num + 1;\n          Max_Ranges (Range_Num).Low := C;\n \n-         --  Span a subset.\n+         --  Span a subset\n \n          loop\n             exit when not Set (C) or else C = Character'Last;\n@@ -248,13 +244,9 @@ package body Ada.Strings.Maps is\n    -- To_Sequence --\n    -----------------\n \n-   function To_Sequence\n-     (Set  : Character_Set)\n-      return Character_Sequence\n-   is\n+   function To_Sequence (Set : Character_Set) return Character_Sequence is\n       Result : String (1 .. Character'Pos (Character'Last) + 1);\n       Count  : Natural := 0;\n-\n    begin\n       for Char in Set'Range loop\n          if Set (Char) then\n@@ -270,9 +262,8 @@ package body Ada.Strings.Maps is\n    -- To_Set --\n    ------------\n \n-   function To_Set (Ranges : in Character_Ranges) return Character_Set is\n+   function To_Set (Ranges : Character_Ranges) return Character_Set is\n       Result : Character_Set;\n-\n    begin\n       for C in Result'Range loop\n          Result (C) := False;\n@@ -287,9 +278,8 @@ package body Ada.Strings.Maps is\n       return Result;\n    end To_Set;\n \n-   function To_Set (Span   : in Character_Range) return Character_Set is\n+   function To_Set (Span : Character_Range) return Character_Set is\n       Result : Character_Set;\n-\n    begin\n       for C in Result'Range loop\n          Result (C) := False;\n@@ -304,7 +294,6 @@ package body Ada.Strings.Maps is\n \n    function To_Set (Sequence : Character_Sequence) return Character_Set is\n       Result : Character_Set := Null_Set;\n-\n    begin\n       for J in Sequence'Range loop\n          Result (Sequence (J)) := True;\n@@ -315,7 +304,6 @@ package body Ada.Strings.Maps is\n \n    function To_Set (Singleton : Character) return Character_Set is\n       Result : Character_Set := Null_Set;\n-\n    begin\n       Result (Singleton) := True;\n       return Result;\n@@ -325,9 +313,10 @@ package body Ada.Strings.Maps is\n    -- Value --\n    -----------\n \n-   function Value (Map : in Character_Mapping; Element : in Character)\n-      return Character is\n-\n+   function Value\n+     (Map     : Character_Mapping;\n+      Element : Character) return Character\n+   is\n    begin\n       return Map (Element);\n    end Value;"}, {"sha": "3e5adf27cf8e60789690610ba585b64f444ecb98", "filename": "gcc/ada/a-strmap.ads", "status": "modified", "additions": 24, "deletions": 32, "changes": 56, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fa-strmap.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fa-strmap.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fa-strmap.ads?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -61,48 +61,44 @@ pragma Preelaborate (Maps);\n \n    type Character_Ranges is array (Positive range <>) of Character_Range;\n \n-   function To_Set    (Ranges : in Character_Ranges) return Character_Set;\n+   function To_Set    (Ranges : Character_Ranges) return Character_Set;\n \n-   function To_Set    (Span   : in Character_Range)  return Character_Set;\n+   function To_Set    (Span   : Character_Range)  return Character_Set;\n \n-   function To_Ranges (Set    : in Character_Set)    return Character_Ranges;\n+   function To_Ranges (Set    : Character_Set)    return Character_Ranges;\n \n    ----------------------------------\n    -- Operations on Character Sets --\n    ----------------------------------\n \n-   function \"=\"   (Left, Right : in Character_Set) return Boolean;\n+   function \"=\"   (Left, Right : Character_Set) return Boolean;\n \n-   function \"not\" (Right       : in Character_Set) return Character_Set;\n-   function \"and\" (Left, Right : in Character_Set) return Character_Set;\n-   function \"or\"  (Left, Right : in Character_Set) return Character_Set;\n-   function \"xor\" (Left, Right : in Character_Set) return Character_Set;\n-   function \"-\"   (Left, Right : in Character_Set) return Character_Set;\n+   function \"not\" (Right       : Character_Set) return Character_Set;\n+   function \"and\" (Left, Right : Character_Set) return Character_Set;\n+   function \"or\"  (Left, Right : Character_Set) return Character_Set;\n+   function \"xor\" (Left, Right : Character_Set) return Character_Set;\n+   function \"-\"   (Left, Right : Character_Set) return Character_Set;\n \n    function Is_In\n-     (Element : in Character;\n-      Set     : in Character_Set)\n-      return    Boolean;\n+     (Element : Character;\n+      Set     : Character_Set) return Boolean;\n \n    function Is_Subset\n-     (Elements : in Character_Set;\n-      Set      : in Character_Set)\n-      return     Boolean;\n+     (Elements : Character_Set;\n+      Set      : Character_Set) return     Boolean;\n \n    function \"<=\"\n-     (Left  : in Character_Set;\n-      Right : in Character_Set)\n-      return  Boolean\n+     (Left  : Character_Set;\n+      Right : Character_Set) return  Boolean\n    renames Is_Subset;\n \n    subtype Character_Sequence is String;\n    --  Alternative representation for a set of character values\n \n-   function To_Set (Sequence  : in Character_Sequence) return Character_Set;\n+   function To_Set (Sequence  : Character_Sequence) return Character_Set;\n+   function To_Set (Singleton : Character)          return Character_Set;\n \n-   function To_Set (Singleton : in Character)          return Character_Set;\n-\n-   function To_Sequence (Set : in Character_Set) return Character_Sequence;\n+   function To_Sequence (Set : Character_Set) return Character_Sequence;\n \n    ------------------------------------\n    -- Character Mapping Declarations --\n@@ -112,9 +108,8 @@ pragma Preelaborate (Maps);\n    --  Representation for a character to character mapping:\n \n    function Value\n-     (Map     : in Character_Mapping;\n-      Element : in Character)\n-      return    Character;\n+     (Map     : Character_Mapping;\n+      Element : Character) return Character;\n \n    Identity : constant Character_Mapping;\n \n@@ -123,19 +118,16 @@ pragma Preelaborate (Maps);\n    ----------------------------\n \n    function To_Mapping\n-     (From, To : in Character_Sequence)\n-      return     Character_Mapping;\n+     (From, To : Character_Sequence) return Character_Mapping;\n \n    function To_Domain\n-     (Map  : in Character_Mapping)\n-      return Character_Sequence;\n+     (Map : Character_Mapping) return Character_Sequence;\n \n    function To_Range\n-     (Map  : in Character_Mapping)\n-      return Character_Sequence;\n+     (Map : Character_Mapping) return Character_Sequence;\n \n    type Character_Mapping_Function is\n-      access function (From : in Character) return Character;\n+      access function (From : Character) return Character;\n \n private\n    pragma Inline (Is_In);"}, {"sha": "122a94c520fa583adb5b7d85084d0324c51586d1", "filename": "gcc/ada/checks.adb", "status": "modified", "additions": 0, "deletions": 7, "changes": 7, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fchecks.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fchecks.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fchecks.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -831,13 +831,6 @@ package body Checks is\n          if Size_Known_At_Compile_Time (Typ) then\n             return;\n          end if;\n-\n-         --  No problem on 64-bit machines, we just don't bother with\n-         --  the case where the size in bytes overflows 64-bits.\n-\n-         if System_Address_Size = 64 then\n-            return;\n-         end if;\n       end if;\n \n       --  Following code is temporarily deleted, since GCC 3 is returning"}, {"sha": "0f06fd394b0ed203ae1b93378a7b965af090557e", "filename": "gcc/ada/clean.adb", "status": "modified", "additions": 17, "deletions": 18, "changes": 35, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fclean.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fclean.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fclean.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -325,15 +325,14 @@ package body Clean is\n \n    procedure Clean_Archive (Project : Project_Id) is\n       Current_Dir : constant Dir_Name_Str := Get_Current_Dir;\n-\n       Data        : constant Project_Data := Projects.Table (Project);\n \n       Archive_Name : constant String :=\n-        \"lib\" & Get_Name_String (Data.Name) & '.' & Archive_Ext;\n+                       \"lib\" & Get_Name_String (Data.Name) & '.' & Archive_Ext;\n       --  The name of the archive file for this project\n \n       Archive_Dep_Name : constant String :=\n-        \"lib\" & Get_Name_String (Data.Name) & \".deps\";\n+                           \"lib\" & Get_Name_String (Data.Name) & \".deps\";\n       --  The name of the archive dependency file for this project\n \n       Obj_Dir : constant String := Get_Name_String (Data.Object_Directory);\n@@ -439,8 +438,7 @@ package body Clean is\n             Extract_From_Q (Lib_File);\n             Full_Lib_File := Osint.Full_Lib_File_Name (Lib_File);\n \n-            --  If we have an existing ALI file that is not read-only,\n-            --  process it.\n+            --  If we have existing ALI file that is not read-only, process it\n \n             if Full_Lib_File /= No_File\n               and then not Is_Readonly_Library (Full_Lib_File)\n@@ -484,8 +482,7 @@ package body Clean is\n                   end if;\n                end if;\n \n-               --  Now, delete all the existing files corresponding to this\n-               --  ALI file.\n+               --  Now delete all existing files corresponding to this ALI file\n \n                declare\n                   Obj_Dir : constant String :=\n@@ -515,9 +512,10 @@ package body Clean is\n                   for J in 1 .. Sources.Last loop\n                      declare\n                         Deb : constant String :=\n-                                         Debug_File_Name (Sources.Table (J));\n+                                Debug_File_Name (Sources.Table (J));\n                         Rep : constant String :=\n-                                         Repinfo_File_Name (Sources.Table (J));\n+                                Repinfo_File_Name (Sources.Table (J));\n+\n                      begin\n                         if Is_Regular_File (Obj_Dir & Dir_Separator & Deb) then\n                            Delete (Obj_Dir, Deb);\n@@ -557,8 +555,7 @@ package body Clean is\n \n    procedure Clean_Project (Project : Project_Id) is\n       Main_Source_File : File_Name_Type;\n-      --  Name of the executable on the command line, without directory\n-      --  information.\n+      --  Name of executable on the command line without directory info\n \n       Executable : Name_Id;\n       --  Name of the executable file\n@@ -610,7 +607,8 @@ package body Clean is\n          begin\n             Change_Dir (Obj_Dir);\n \n-            --  First, deal with Ada.\n+            --  First, deal with Ada\n+\n             --  Look through the units to find those that are either immediate\n             --  sources or inherited sources of the project.\n \n@@ -765,8 +763,9 @@ package body Clean is\n             end if;\n \n             if Data.Other_Sources_Present then\n+\n                --  There is non-Ada code: delete the object files and\n-               --  the dependency files, if they exist.\n+               --  the dependency files if they exist.\n \n                Source_Id := Data.First_Other_Source;\n \n@@ -1093,8 +1092,8 @@ package body Clean is\n \n          Prj.Pars.Set_Verbosity (To => Prj.Com.Current_Verbosity);\n \n-         --  Parse the project file.\n-         --  If there is an error, Main_Project will still be No_Project.\n+         --  Parse the project file. If there is an error, Main_Project\n+         --  will still be No_Project.\n \n          Prj.Pars.Parse\n            (Project           => Main_Project,\n@@ -1103,8 +1102,7 @@ package body Clean is\n             Process_Languages => All_Languages);\n \n          if Main_Project = No_Project then\n-            Fail (\"\"\"\" & Project_File_Name.all &\n-                  \"\"\" processing failed\");\n+            Fail (\"\"\"\" & Project_File_Name.all & \"\"\" processing failed\");\n          end if;\n \n          if Opt.Verbose_Mode then\n@@ -1311,7 +1309,8 @@ package body Clean is\n    procedure Parse_Cmd_Line is\n       Source_Index : Int := 0;\n       Index : Positive := 1;\n-      Last  : constant Natural := Argument_Count;\n+      Last         : constant Natural := Argument_Count;\n+\n    begin\n       while Index <= Last loop\n          declare"}, {"sha": "8bbcb091826b3f71c213473e206c70cbeebda4c7", "filename": "gcc/ada/exp_ch5.adb", "status": "modified", "additions": 6, "deletions": 3, "changes": 9, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fexp_ch5.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fexp_ch5.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_ch5.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -826,8 +826,8 @@ package body Exp_Ch5 is\n                --  the explicit bounds of right- and left-hand side.\n \n                declare\n-                  Proc     : constant Node_Id :=\n-                               TSS (Base_Type (L_Type), TSS_Slice_Assign);\n+                  Proc    : constant Node_Id :=\n+                              TSS (Base_Type (L_Type), TSS_Slice_Assign);\n                   Actuals : List_Id;\n \n                begin\n@@ -840,7 +840,10 @@ package body Exp_Ch5 is\n                     Duplicate_Subexpr (Left_Hi,  Name_Req => True),\n                     Duplicate_Subexpr (Right_Lo, Name_Req => True),\n                     Duplicate_Subexpr (Right_Hi, Name_Req => True));\n-                  Append_To (Actuals, Condition);\n+\n+                  Append_To (Actuals,\n+                     Make_Op_Not (Loc,\n+                       Right_Opnd => Condition));\n \n                   Rewrite (N,\n                     Make_Procedure_Call_Statement (Loc,"}, {"sha": "9e1a7ec1c5f010ab5a347017e056d86b19407cf3", "filename": "gcc/ada/exp_util.adb", "status": "modified", "additions": 102, "deletions": 64, "changes": 166, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fexp_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fexp_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fexp_util.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -2384,34 +2384,6 @@ package body Exp_Util is\n    ---------------------------------\n \n    function Is_Possibly_Unaligned_Slice (P : Node_Id) return Boolean is\n-\n-      function Has_Non_Trivial_Component_Clause (E : Entity_Id) return Boolean;\n-      --  Check whether the component clause might place the component at an\n-      --  alignment that will require the use of a copy when a slice is passed\n-      --  as a parameter.  The code is conservative because at this point the\n-      --  expander does not know the alignment choice that the back-end will\n-      --  make. For now we return true if the component is not the first one\n-      --  in the enclosing record. This routine is a place holder for further\n-      --  analysis of this kind.\n-\n-      --------------------------------------\n-      -- Has_Non_Trivial_Component_Clause --\n-      --------------------------------------\n-\n-      function Has_Non_Trivial_Component_Clause (E : Entity_Id) return Boolean\n-      is\n-         Rep_Clause : constant Node_Id := Component_Clause (E);\n-      begin\n-         if No (Rep_Clause) then\n-            return False;\n-         else\n-            return Intval (Position (Rep_Clause)) /= Uint_0\n-              or else Intval (First_Bit (Rep_Clause)) /= Uint_0;\n-         end if;\n-      end Has_Non_Trivial_Component_Clause;\n-\n-   --  Start of processing for Is_Possibly_Unaligned_Slice\n-\n    begin\n       --  ??? GCC3 will eventually handle strings with arbitrary alignments,\n       --  but for now the following check must be disabled.\n@@ -2420,64 +2392,130 @@ package body Exp_Util is\n       --     return False;\n       --  end if;\n \n+      --  For renaming case, go to renamed object\n+\n       if Is_Entity_Name (P)\n         and then Is_Object (Entity (P))\n         and then Present (Renamed_Object (Entity (P)))\n       then\n          return Is_Possibly_Unaligned_Slice (Renamed_Object (Entity (P)));\n       end if;\n \n-      --  We only need to worry if the target has strict alignment, unless\n-      --  it is a nested record component with a component clause, which\n-      --  Gigi does not handle well. This patch should disappear with GCC 3.0\n-      --  and it is not clear why it is needed even when the representation\n-      --  clause is a confirming one, but in its absence gigi complains that\n-      --  the slice is not addressable.???\n+      --  The reference must be a slice\n \n-      if not Target_Strict_Alignment then\n-         if Nkind (P) /= N_Slice\n-           or else Nkind (Prefix (P)) /= N_Selected_Component\n-           or else Nkind (Prefix (Prefix (P))) /= N_Selected_Component\n-         then\n-            return False;\n-         end if;\n+      if Nkind (P) /= N_Slice then\n+         return False;\n       end if;\n \n-      --  The reference must be a slice\n+      --  Always assume the worst for a nested record component with a\n+      --  component clause, which gigi/gcc does not appear to handle well.\n+      --  It is not clear why this special test is needed at all ???\n \n-      if Nkind (P) /= N_Slice then\n+      if Nkind (Prefix (P)) = N_Selected_Component\n+        and then Nkind (Prefix (Prefix (P))) = N_Selected_Component\n+        and then\n+          Present (Component_Clause (Entity (Selector_Name (Prefix (P)))))\n+      then\n+         return True;\n+      end if;\n+\n+      --  We only need to worry if the target has strict alignment\n+\n+      if not Target_Strict_Alignment then\n          return False;\n       end if;\n \n       --  If it is a slice, then look at the array type being sliced\n \n       declare\n-         Pref : constant Node_Id   := Prefix (P);\n-         Typ  : constant Entity_Id := Etype (Prefix (P));\n+         Sarr : constant Node_Id := Prefix (P);\n+         --  Prefix of the slice, i.e. the array being sliced\n+\n+         Styp : constant Entity_Id := Etype (Prefix (P));\n+         --  Type of the array being sliced\n+\n+         Pref : Node_Id;\n+         Ptyp : Entity_Id;\n \n       begin\n-         --  The worrisome case is one where we don't know the alignment\n-         --  of the array, or we know it and it is greater than 1 (if the\n-         --  alignment is one, then obviously it cannot be misaligned).\n+         --  The problems arise if the array object that is being sliced\n+         --  is a component of a record or array, and we cannot guarantee\n+         --  the alignment of the array within its containing object.\n \n-         if Known_Alignment (Typ) and then Alignment (Typ) = 1 then\n-            return False;\n-         end if;\n+         --  To investigate this, we look at successive prefixes to see\n+         --  if we have a worrisome indexed or selected component.\n \n-         --  The only way we can be unaligned is if the array being sliced\n-         --  is a component of a record, and either the record is packed,\n-         --  or the component has a component clause, or the record has\n-         --  a specified alignment (that might be too small).\n+         Pref := Sarr;\n+         loop\n+            --  Case of array is part of an indexed component reference\n \n-         return\n-            Nkind (Pref) = N_Selected_Component\n-              and then\n-                 (Is_Packed (Etype (Prefix (Pref)))\n-                    or else\n-                  Known_Alignment (Etype (Prefix (Pref)))\n-                    or else\n-                      Has_Non_Trivial_Component_Clause\n-                        (Entity (Selector_Name (Pref))));\n+            if Nkind (Pref) = N_Indexed_Component then\n+               Ptyp := Etype (Prefix (Pref));\n+\n+               --  The only problematic case is when the array is packed,\n+               --  in which case we really know nothing about the alignment\n+               --  of individual components.\n+\n+               if Is_Bit_Packed_Array (Ptyp) then\n+                  return True;\n+               end if;\n+\n+            --  Case of array is part of a selected component reference\n+\n+            elsif Nkind (Pref) = N_Selected_Component then\n+               Ptyp := Etype (Prefix (Pref));\n+\n+               --  We are definitely in trouble if the record in question\n+               --  has an alignment, and either we know this alignment is\n+               --  inconsistent with the alignment of the slice, or we\n+               --  don't know what the alignment of the slice should be.\n+\n+               if Known_Alignment (Ptyp)\n+                 and then (Unknown_Alignment (Styp)\n+                             or else Alignment (Styp) > Alignment (Ptyp))\n+               then\n+                  return True;\n+               end if;\n+\n+               --  We are in potential trouble if the record type is packed.\n+               --  We could special case when we know that the array is the\n+               --  first component, but that's not such a simple case ???\n+\n+               if Is_Packed (Ptyp) then\n+                  return True;\n+               end if;\n+\n+               --  We are in trouble if there is a component clause, and\n+               --  either we do not know the alignment of the slice, or\n+               --  the alignment of the slice is inconsistent with the\n+               --  bit position specified by the component clause.\n+\n+               declare\n+                  Field : constant Entity_Id := Entity (Selector_Name (Pref));\n+               begin\n+                  if Present (Component_Clause (Field))\n+                    and then\n+                      (Unknown_Alignment (Styp)\n+                        or else\n+                         (Component_Bit_Offset (Field) mod\n+                           (System_Storage_Unit * Alignment (Styp))) /= 0)\n+                  then\n+                     return True;\n+                  end if;\n+               end;\n+\n+            --  For cases other than selected or indexed components we\n+            --  know we are OK, since no issues arise over alignment.\n+\n+            else\n+               return False;\n+            end if;\n+\n+            --  We processed an indexed component or selected component\n+            --  reference that looked safe, so keep checking prefixes.\n+\n+            Pref := Prefix (Pref);\n+         end loop;\n       end;\n    end Is_Possibly_Unaligned_Slice;\n "}, {"sha": "d26ab4682865d666a7ca3d424748eedaa9c8132b", "filename": "gcc/ada/g-traceb.ads", "status": "modified", "additions": 2, "deletions": 1, "changes": 3, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fg-traceb.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fg-traceb.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fg-traceb.ads?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -54,7 +54,8 @@\n --     Compile without -g\n --     Run the program, and call Call_Chain\n --     Recompile with -g\n---     Use addr2line to interpret the absolute call locations\n+--     Use addr2line to interpret the absolute call locations (note that\n+--      addr2line expects addresses in hexadecimal format).\n \n --  This capability is currently supported on the following targets:\n "}, {"sha": "575e85ef602406bc9994ac639e0ae9bd1427bd28", "filename": "gcc/ada/gnat_rm.texi", "status": "modified", "additions": 15, "deletions": 2, "changes": 17, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fgnat_rm.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fgnat_rm.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_rm.texi?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -13309,6 +13309,7 @@ See the chapter on project files in the GNAT Users guide for examples of use.\n * Reserved Words::\n * Lexical Elements::\n * Declarations::\n+* Empty declarations::\n * Typed string declarations::\n * Variables::\n * Expressions::\n@@ -13379,9 +13380,21 @@ simple_declarative_item ::=\n   variable_declaration |\n   typed_variable_declaration |\n   attribute_declaration |\n-  case_construction\n+  case_construction |\n+  empty_declaration\n @end smallexample\n \n+@node Empty declarations\n+@section Empty declarations\n+\n+@smallexample\n+empty_declaration ::=\n+  @b{null} ;\n+@end smallexample\n+\n+An empty declaration is allowed anywhere a declaration is allowed.\n+It has no effect.\n+\n @node Typed string declarations\n @section Typed string declarations\n \n@@ -13683,7 +13696,7 @@ case_construction ::=\n \n case_item ::=\n   @b{when} discrete_choice_list =>\n-    @{case_construction | attribute_declaration@}\n+    @{case_construction | attribute_declaration | empty_declaration@}\n \n discrete_choice_list ::=\n   string_literal @{| string_literal@} |"}, {"sha": "4567533b6ae80eedb672365cff2b3f6cb35a5a50", "filename": "gcc/ada/gnat_ugn.texi", "status": "modified", "additions": 2, "deletions": 0, "changes": 2, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fgnat_ugn.texi", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fgnat_ugn.texi", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fgnat_ugn.texi?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -10809,6 +10809,8 @@ project Build is\n         for ^Default_Switches^Default_Switches^ (\"Ada\")\n             use (\"^-g^-g^\");\n         for Executable (\"proc\") use \"proc1\";\n+      when others =>\n+        null;\n     end case;\n \n   end Builder;"}, {"sha": "eb24af280ce7bfd2b47d74aec3e5eece18eb353b", "filename": "gcc/ada/make.adb", "status": "modified", "additions": 9, "deletions": 7, "changes": 16, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmake.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmake.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmake.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -2231,7 +2231,9 @@ package body Make is\n                      The_Data := Projects.Table (Prj);\n                   end loop;\n \n-                  if The_Data.Library and then not The_Data.Flag1 then\n+                  if The_Data.Library\n+                    and then not The_Data.Need_To_Build_Lib\n+                  then\n                      --  Add to the Q all sources of the project that\n                      --  have not been marked\n \n@@ -2242,7 +2244,7 @@ package body Make is\n \n                      --  Now mark the project as processed\n \n-                     Projects.Table (Prj).Flag1 := True;\n+                     Projects.Table (Prj).Need_To_Build_Lib := True;\n                   end if;\n                end;\n             end if;\n@@ -4337,10 +4339,10 @@ package body Make is\n          if MLib.Tgt.Support_For_Libraries /= MLib.Tgt.None then\n             for Proj in Projects.First .. Projects.Last loop\n                if Projects.Table (Proj).Library then\n-                  Projects.Table (Proj).Flag1 :=\n+                  Projects.Table (Proj).Need_To_Build_Lib :=\n                     not MLib.Tgt.Library_Exists_For (Proj);\n \n-                  if Projects.Table (Proj).Flag1 then\n+                  if Projects.Table (Proj).Need_To_Build_Lib then\n                      if Verbose_Mode then\n                         Write_Str\n                           (\"Library file does not exist for project \"\"\");\n@@ -4722,12 +4724,12 @@ package body Make is\n                         end if;\n \n                         if Projects.Table (Proj1).Library\n-                          and then not Projects.Table (Proj1).Flag1\n+                          and then not Projects.Table (Proj1).Need_To_Build_Lib\n                         then\n                            MLib.Prj.Check_Library (Proj1);\n                         end if;\n \n-                        if Projects.Table (Proj1).Flag1 then\n+                        if Projects.Table (Proj1).Need_To_Build_Lib then\n                            Library_Projs.Increment_Last;\n                            Current := Library_Projs.Last;\n                            Depth := Projects.Table (Proj1).Depth;\n@@ -4744,7 +4746,7 @@ package body Make is\n                            end loop;\n \n                            Library_Projs.Table (Current) := Proj1;\n-                           Projects.Table (Proj1).Flag1 := False;\n+                           Projects.Table (Proj1).Need_To_Build_Lib := False;\n                         end if;\n                      end loop;\n                   end;"}, {"sha": "ea504884910587007f542bc488aaa5c7f2b1a3ea", "filename": "gcc/ada/makegpr.adb", "status": "modified", "additions": 12, "deletions": 11, "changes": 23, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmakegpr.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmakegpr.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmakegpr.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -2395,23 +2395,24 @@ package body Makegpr is\n \n       if not Compile_Only then\n \n-         --  If there are linking options from the command line,\n-         --  transmit them to gnatmake.\n+         --  Linking options\n \n          if Linker_Options.Last /= 0 then\n             Add_Argument (Dash_largs, True);\n-\n-            for Arg in 1 .. Linker_Options.Last loop\n-               Add_Argument (Linker_Options.Table (Arg), True);\n-            end loop;\n-\n          else\n             Add_Argument (Dash_largs, Verbose_Mode);\n          end if;\n \n          --  Add the archives\n \n          Add_Archives (For_Gnatmake => True);\n+\n+         --  If there are linking options from the command line,\n+         --  transmit them to gnatmake.\n+\n+         for Arg in 1 .. Linker_Options.Last loop\n+            Add_Argument (Linker_Options.Table (Arg), True);\n+         end loop;\n       end if;\n \n       --  And invoke gnatmake\n@@ -3318,6 +3319,10 @@ package body Makegpr is\n                Get_Name_String (Source.Object_Name),\n                True);\n \n+            --  Add all the archives, in a correct order\n+\n+            Add_Archives (For_Gnatmake => False);\n+\n             --  Add the switches specified in package Linker of\n             --  the main project.\n \n@@ -3345,10 +3350,6 @@ package body Makegpr is\n                Add_Argument (Linker_Options.Table (Arg), True);\n             end loop;\n \n-            --  Add all the archives, in a correct order\n-\n-            Add_Archives (For_Gnatmake => False);\n-\n             --  If there are shared libraries and the run path\n             --  option is supported, add the run path switch.\n "}, {"sha": "b2079be7a9ccf4dc80abe2298e1bf835bb4ef5e3", "filename": "gcc/ada/mlib-prj.adb", "status": "modified", "additions": 7, "deletions": 7, "changes": 14, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-prj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-prj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-prj.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -1556,7 +1556,7 @@ package body MLib.Prj is\n       Data : constant Project_Data := Projects.Table (For_Project);\n \n    begin\n-      if Data.Library and not Data.Flag1 then\n+      if Data.Library and not Data.Need_To_Build_Lib then\n          declare\n             Current  : constant Dir_Name_Str := Get_Current_Dir;\n             Lib_Name : constant Name_Id := Library_File_Name_For (For_Project);\n@@ -1596,17 +1596,17 @@ package body MLib.Prj is\n \n                   Obj_TS := File_Stamp (Name_Find);\n \n-                  --  If library file time stamp is earlier, set Flag1 and\n-                  --  return. String comparaison is used, otherwise time stamps\n-                  --  may be too close and the comparaison would return True,\n-                  --  which would trigger an unnecessary rebuild of the\n-                  --  library.\n+                  --  If library file time stamp is earlier, set\n+                  --  Need_To_Build_Lib and return. String comparaison is used,\n+                  --  otherwise time stamps may be too close and the\n+                  --  comparaison would return True, which would trigger\n+                  --  an unnecessary rebuild of the library.\n \n                   if String (Lib_TS) < String (Obj_TS) then\n \n                      --  Library must be rebuilt\n \n-                     Projects.Table (For_Project).Flag1 := True;\n+                     Projects.Table (For_Project).Need_To_Build_Lib := True;\n                      exit;\n                   end if;\n                end if;"}, {"sha": "fc5a954da56d784b27d93fea1d4dc4db81136406", "filename": "gcc/ada/mlib-tgt-aix.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-aix.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-aix.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-aix.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -134,8 +134,8 @@ package body MLib.Tgt is\n       pragma Unreferenced (Lib_Version);\n \n       Lib_File : constant String :=\n-        Lib_Dir & Directory_Separator & \"lib\" &\n-        MLib.Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Lib_Dir & Directory_Separator & \"lib\" &\n+                   MLib.Fil.Ext_To (Lib_Filename, DLL_Ext);\n       --  The file name of the library\n \n       Init_Fini : Argument_List_Access := Empty_Argument_List;"}, {"sha": "4198f22317cdaae688b8c692447dba4ea6a1310e", "filename": "gcc/ada/mlib-tgt-hpux.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-hpux.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-hpux.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-hpux.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -113,8 +113,8 @@ package body MLib.Tgt is\n       pragma Unreferenced (Symbol_Data);\n \n       Lib_File : constant String :=\n-        Lib_Dir & Directory_Separator & \"lib\" &\n-        MLib.Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Lib_Dir & Directory_Separator & \"lib\" &\n+                   MLib.Fil.Ext_To (Lib_Filename, DLL_Ext);\n \n       Version_Arg          : String_Access;\n       Symbolic_Link_Needed : Boolean := False;\n@@ -135,6 +135,7 @@ package body MLib.Tgt is\n       end if;\n \n       --  If specified, add automatic elaboration/finalization\n+\n       if Auto_Init then\n          Init_Fini := Init_Fini_List;\n          Init_Fini (2) := new String'(\"-Wl,\" & Lib_Filename & \"init\");"}, {"sha": "6c8a2e0c2a67fd2fe514b7d6b100a4e67f2ffacc", "filename": "gcc/ada/mlib-tgt-irix.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-irix.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-irix.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-irix.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -114,8 +114,8 @@ package body MLib.Tgt is\n       pragma Unreferenced (Symbol_Data);\n \n       Lib_File : constant String :=\n-        Lib_Dir & Directory_Separator & \"lib\" &\n-        MLib.Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Lib_Dir & Directory_Separator & \"lib\" &\n+                   MLib.Fil.Ext_To (Lib_Filename, DLL_Ext);\n \n       Version_Arg          : String_Access;\n       Symbolic_Link_Needed : Boolean := False;\n@@ -129,6 +129,7 @@ package body MLib.Tgt is\n       end if;\n \n       --  If specified, add automatic elaboration/finalization\n+\n       if Auto_Init then\n          Init_Fini := Init_Fini_List;\n          Init_Fini (2) := new String'(\"-Wl,\" & Lib_Filename & \"init\");"}, {"sha": "a4a0ce8617a5fca8dda67a126868aa45c01e27b2", "filename": "gcc/ada/mlib-tgt-linux.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-linux.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-linux.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-linux.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -117,8 +117,8 @@ package body MLib.Tgt is\n       pragma Unreferenced (Symbol_Data);\n \n       Lib_File : constant String :=\n-        Lib_Dir & Directory_Separator & \"lib\" &\n-        Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Lib_Dir & Directory_Separator & \"lib\" &\n+                   Fil.Ext_To (Lib_Filename, DLL_Ext);\n \n       Version_Arg          : String_Access;\n       Symbolic_Link_Needed : Boolean := False;\n@@ -132,6 +132,7 @@ package body MLib.Tgt is\n       end if;\n \n       --  If specified, add automatic elaboration/finalization\n+\n       if Auto_Init then\n          Init_Fini := Init_Fini_List;\n          Init_Fini (2) := new String'(\"-Wl,\" & Lib_Filename & \"init\");"}, {"sha": "77295cf5b173cad19c8140be173fd5584b44f92c", "filename": "gcc/ada/mlib-tgt-mingw.adb", "status": "modified", "additions": 6, "deletions": 6, "changes": 12, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-mingw.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-mingw.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-mingw.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -107,8 +107,8 @@ package body MLib.Tgt is\n       pragma Unreferenced (Lib_Version);\n \n       Lib_File : constant String :=\n-        Lib_Dir & Directory_Separator &\n-        Files.Ext_To (Lib_Filename, DLL_Ext);\n+                   Lib_Dir & Directory_Separator &\n+                   Files.Ext_To (Lib_Filename, DLL_Ext);\n \n    --  Start of processing for Build_Dynamic_Library\n \n@@ -207,7 +207,7 @@ package body MLib.Tgt is\n \n             else\n                return Is_Regular_File\n-                 (Lib_Dir & Directory_Separator & \"lib\" &\n+                 (Lib_Dir & Directory_Separator &\n                   MLib.Fil.Ext_To (Lib_Name, DLL_Ext));\n             end if;\n          end;\n@@ -231,13 +231,13 @@ package body MLib.Tgt is\n               Get_Name_String (Projects.Table (Project).Library_Name);\n \n          begin\n-            Name_Len := 3;\n-            Name_Buffer (1 .. Name_Len) := \"lib\";\n-\n             if Projects.Table (Project).Library_Kind = Static then\n+               Name_Len := 3;\n+               Name_Buffer (1 .. Name_Len) := \"lib\";\n                Add_Str_To_Name_Buffer (Fil.Ext_To (Lib_Name, Archive_Ext));\n \n             else\n+               Name_Len := 0;\n                Add_Str_To_Name_Buffer (Fil.Ext_To (Lib_Name, DLL_Ext));\n             end if;\n "}, {"sha": "a307e85ae8858c0cafc5ac153719bfbd63079aba", "filename": "gcc/ada/mlib-tgt-solaris.adb", "status": "modified", "additions": 3, "deletions": 2, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-solaris.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-solaris.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-solaris.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -111,8 +111,8 @@ package body MLib.Tgt is\n       pragma Unreferenced (Symbol_Data);\n \n       Lib_File : constant String :=\n-        Lib_Dir & Directory_Separator & \"lib\" &\n-        Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Lib_Dir & Directory_Separator & \"lib\" &\n+                   Fil.Ext_To (Lib_Filename, DLL_Ext);\n \n       Version_Arg          : String_Access;\n       Symbolic_Link_Needed : Boolean := False;\n@@ -126,6 +126,7 @@ package body MLib.Tgt is\n       end if;\n \n       --  If specified, add automatic elaboration/finalization\n+\n       if Auto_Init then\n          Init_Fini := Init_Fini_List;\n          Init_Fini (1) :="}, {"sha": "e40fe50e8d014fc6fcd36a290738f4aa09197840", "filename": "gcc/ada/mlib-tgt-tru64.adb", "status": "modified", "additions": 2, "deletions": 2, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-tru64.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-tru64.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-tru64.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -119,8 +119,8 @@ package body MLib.Tgt is\n       pragma Unreferenced (Symbol_Data);\n \n       Lib_File : constant String :=\n-        Lib_Dir & Directory_Separator & \"lib\" &\n-        Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Lib_Dir & Directory_Separator & \"lib\" &\n+                   Fil.Ext_To (Lib_Filename, DLL_Ext);\n \n       Version_Arg          : String_Access;\n       Symbolic_Link_Needed : Boolean := False;"}, {"sha": "6f1f069eb40f76e43d2813b1821703c41150afe7", "filename": "gcc/ada/mlib-tgt-vms-alpha.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-vms-alpha.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-vms-alpha.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-vms-alpha.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -140,7 +140,7 @@ package body MLib.Tgt is\n \n       Lib_File : constant String :=\n                    Lib_Dir & Directory_Separator & \"lib\" &\n-                     Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Fil.Ext_To (Lib_Filename, DLL_Ext);\n \n       Opts      : Argument_List := Options;\n       Last_Opt  : Natural       := Opts'Last;\n@@ -151,8 +151,8 @@ package body MLib.Tgt is\n \n       function Is_Interface (Obj_File : String) return Boolean;\n       --  For a Stand-Alone Library, returns True if Obj_File is the object\n-      --  file name of an interface of the SAL.\n-      --  For other libraries, always return True.\n+      --  file name of an interface of the SAL. For other libraries, always\n+      --  return True.\n \n       function Option_File_Name return String;\n       --  Returns Symbol_File, if not empty. Otherwise, returns \"symvec.opt\""}, {"sha": "639ebca3f849d7e8bd1d3e2e39ebbacda6a9b675", "filename": "gcc/ada/mlib-tgt-vms-ia64.adb", "status": "modified", "additions": 3, "deletions": 3, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-vms-ia64.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fmlib-tgt-vms-ia64.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fmlib-tgt-vms-ia64.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -140,7 +140,7 @@ package body MLib.Tgt is\n \n       Lib_File : constant String :=\n                    Lib_Dir & Directory_Separator & \"lib\" &\n-                     Fil.Ext_To (Lib_Filename, DLL_Ext);\n+                   Fil.Ext_To (Lib_Filename, DLL_Ext);\n \n       Opts      : Argument_List := Options;\n       Last_Opt  : Natural       := Opts'Last;\n@@ -151,8 +151,8 @@ package body MLib.Tgt is\n \n       function Is_Interface (Obj_File : String) return Boolean;\n       --  For a Stand-Alone Library, returns True if Obj_File is the object\n-      --  file name of an interface of the SAL.\n-      --  For other libraries, always return True.\n+      --  file name of an interface of the SAL. For other libraries, always\n+      --  return True.\n \n       function Option_File_Name return String;\n       --  Returns Symbol_File, if not empty. Otherwise, returns \"symvec.opt\""}, {"sha": "e87146279fd5486f4b90415ca9c4b01229b292bd", "filename": "gcc/ada/prj-dect.adb", "status": "modified", "additions": 4, "deletions": 0, "changes": 4, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fprj-dect.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fprj-dect.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj-dect.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -747,6 +747,10 @@ package body Prj.Dect is\n                Set_End_Of_Line (Current_Declaration);\n                Set_Previous_Line_Node (Current_Declaration);\n \n+            when Tok_Null =>\n+\n+               Scan; --  past \"null\"\n+\n             when Tok_Package =>\n \n                --  Package declaration"}, {"sha": "8514f2dc4f1ab4becef05cc82faf3a99b4a95e17", "filename": "gcc/ada/prj.adb", "status": "modified", "additions": 2, "deletions": 3, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fprj.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fprj.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -78,8 +78,8 @@ package body Prj is\n       First_Referred_By              => No_Project,\n       Name                           => No_Name,\n       Path_Name                      => No_Name,\n-      Virtual                        => False,\n       Display_Path_Name              => No_Name,\n+      Virtual                        => False,\n       Location                       => No_Location,\n       Mains                          => Nil_String,\n       Directory                      => No_Name,\n@@ -127,8 +127,7 @@ package body Prj is\n       Language_Independent_Checked   => False,\n       Checked                        => False,\n       Seen                           => False,\n-      Flag1                          => False,\n-      Flag2                          => False,\n+      Need_To_Build_Lib              => False,\n       Depth                          => 0,\n       Unkept_Comments                => False);\n "}, {"sha": "327e500f76e1ba263e5aa5d778b248a21456d9bb", "filename": "gcc/ada/prj.ads", "status": "modified", "additions": 112, "deletions": 94, "changes": 206, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fprj.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fprj.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fprj.ads?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -40,8 +40,8 @@ with GNAT.OS_Lib; use GNAT.OS_Lib;\n package Prj is\n \n    Empty_Name : Name_Id;\n-   --  Name_Id for an empty name (no characters).\n-   --  Initialized by procedure Initialize.\n+   --  Name_Id for an empty name (no characters). Initialized by the call\n+   --  to procedure Initialize.\n \n    All_Packages : constant String_List_Access := null;\n    --  Default value of parameter Packages of procedures Parse, in Prj.Pars and\n@@ -52,9 +52,8 @@ package Prj is\n    --  normally forbidden for project names, there cannot be any name clash.\n \n    Project_File_Extension : String := \".gpr\";\n-   --  The standard project file name extension.\n-   --  It is not a constant, because Canonical_Case_File_Name is called\n-   --  on this variable in the body of Prj.\n+   --  The standard project file name extension. It is not a constant, because\n+   --  Canonical_Case_File_Name is called on this variable in the body of Prj.\n \n    Default_Ada_Spec_Suffix : Name_Id;\n    --  The Name_Id for the standard GNAT suffix for Ada spec source file\n@@ -72,15 +71,24 @@ package Prj is\n \n    type Programming_Language is\n      (Lang_Ada, Lang_C, Lang_C_Plus_Plus);\n-   --  The list of language supported\n+   --  The set of languages supported\n \n    subtype Other_Programming_Language is\n-      Programming_Language range Lang_C .. Programming_Language'Last;\n+     Programming_Language range Lang_C .. Programming_Language'Last;\n+   --  The set of non-Ada languages supported\n+\n    type Languages_In_Project is array (Programming_Language) of Boolean;\n+   --  Set of supported languages used in a project\n+\n    No_Languages : constant Languages_In_Project := (others => False);\n+   --  No supported languages are used\n \n    type Impl_Suffix_Array is array (Programming_Language) of Name_Id;\n+   --  Suffixes for the non spec sources of the different supported languages\n+   --  in a project.\n+\n    No_Impl_Suffixes : constant Impl_Suffix_Array := (others => No_Name);\n+   --  A default value for the non spec source suffixes\n \n    Lang_Ada_Name         : aliased String := \"ada\";\n    Lang_C_Name           : aliased String := \"c\";\n@@ -93,7 +101,8 @@ package Prj is\n    --  -x when using a GCC compiler.\n \n    Lang_Name_Ids : array (Programming_Language) of Name_Id;\n-   --  Initialized by Prj.Initialize\n+   --  Same as Lang_Names, but using Name_Id, instead of String_Access.\n+   --  Initialized by Prj.Initialize.\n \n    Lang_Ada_Display_Name         : aliased String := \"Ada\";\n    Lang_C_Display_Name           : aliased String := \"C\";\n@@ -115,8 +124,9 @@ package Prj is\n       Lang_C_Plus_Plus => C_Plus_Plus_Impl_Suffix'Access);\n    --  Default extension of the sources of the different languages.\n \n-   Lang_Suffix_Ids : array (Programming_Language) of Name_Id;\n-   --  Initialized by Prj.Initialize\n+   Lang_Suffix_Ids         : array (Programming_Language) of Name_Id;\n+   --  Same as Lang_Suffixes, but using Name_Id, instead of String_Access.\n+   --  Initialized by Prj.Initialize.\n \n    Gnatmake_String    : aliased String := \"gnatmake\";\n    Gcc_String         : aliased String := \"gcc\";\n@@ -137,6 +147,10 @@ package Prj is\n      (Lang_Ada         => Ada_Args_Strings       'Access,\n       Lang_C           => C_Args_String          'Access,\n       Lang_C_Plus_Plus => C_Plus_Plus_Args_String'Access);\n+   --  For each supported language, the string between \"-c\" and \"args\" to\n+   --  be used in the gprmake switch for the start of the compiling switch\n+   --  section for each supported language. For example, \"-ccargs\" indicates\n+   --  the start of the C compiler switch section.\n \n    type Other_Source_Id is new Nat;\n    No_Other_Source : constant Other_Source_Id := 0;\n@@ -154,6 +168,7 @@ package Prj is\n       Naming_Exception : Boolean := False;     --  True if a naming exception\n       Next             : Other_Source_Id := No_Other_Source;\n    end record;\n+   --  Data for a source in a language other than Ada\n \n    package Other_Sources is new Table.Table\n      (Table_Component_Type => Other_Source,\n@@ -171,9 +186,13 @@ package Prj is\n    --    High is extremely verbose.\n \n    type Lib_Kind is (Static, Dynamic, Relocatable);\n-\n    type Policy is (Autonomous, Compliant, Controlled, Restricted);\n-   --  See explaination about this type in package Symbols\n+   --  Type to specify the symbol policy, when symbol control is supported.\n+   --  See full explanation about this type in package Symbols.\n+   --  Autonomous: Create a symbol file without considering any reference\n+   --  Compliant: Try to be as compatible as possible with an existing ref\n+   --  Controlled: Fail if symbols are not the same as those in the reference\n+   --  Restricted: Restrict the symbols to those in the symbol file\n \n    type Symbol_Record is record\n       Symbol_File   : Name_Id := No_Name;\n@@ -186,8 +205,10 @@ package Prj is\n      (Symbol_File   => No_Name,\n       Reference     => No_Name,\n       Symbol_Policy => Autonomous);\n+   --  The default value of the symbol data\n \n    function Empty_String return Name_Id;\n+   --  Return the Name_Id for an empty string \"\"\n \n    type Project_Id is new Nat;\n    No_Project : constant Project_Id := 0;\n@@ -237,8 +258,8 @@ package Prj is\n             Index : Int     := 0;\n       end case;\n    end record;\n-   --  Values for variables and array elements.\n-   --  Default is True if the current value is the default one for the variable\n+   --  Values for variables and array elements. Default is True if the\n+   --  current value is the default one for the variable\n \n    Nil_Variable_Value : constant Variable_Value :=\n      (Project  => No_Project,\n@@ -314,13 +335,15 @@ package Prj is\n       Arrays     : Array_Id    := No_Array;\n       Packages   : Package_Id  := No_Package;\n    end record;\n+   --  Contains the declarations (variables, single and array attributes,\n+   --  packages) for a project or a package in a project.\n \n    No_Declarations : constant Declarations :=\n      (Variables  => No_Variable,\n       Attributes => No_Variable,\n       Arrays     => No_Array,\n       Packages   => No_Package);\n-   --  Declarations. Used in project structures and packages (what for???)\n+   --  Default value of Declarations: indicates that there is no declarations.\n \n    type Package_Element is record\n       Name   : Name_Id      := No_Name;\n@@ -387,36 +410,32 @@ package Prj is\n       --  Current_Body_Suffix is defined.\n \n       Separate_Suffix : Name_Id := No_Name;\n-      --  The string to append to the unit name for the\n-      --  source file name of an Ada subunit.\n+      --  String to append to unit name for source file name of an Ada subunit.\n \n       Sep_Suffix_Loc : Source_Ptr := No_Location;\n-      --  The position in the project file source where\n-      --  Separate_Suffix is defined.\n+      --  Position in the project file source where Separate_Suffix is defined.\n \n       Specs : Array_Element_Id := No_Array_Element;\n-      --  An associative array mapping individual specs\n-      --  to source file names. Specific to Ada.\n+      --  An associative array mapping individual specs to source file names.\n+      --  This is specific to Ada.\n \n       Bodies : Array_Element_Id := No_Array_Element;\n-      --  An associative array mapping individual bodies\n-      --  to source file names. Specific to Ada.\n+      --  An associative array mapping individual bodies to source file names.\n+      --  This is specific to Ada.\n \n       Specification_Exceptions : Array_Element_Id := No_Array_Element;\n-      --  An associative array listing spec file names that don't have the\n-      --  spec suffix. Not used by Ada. Indexed by the programming language\n-      --  name.\n+      --  An associative array listing spec file names that do not have the\n+      --  spec suffix. Not used by Ada. Indexed by programming language name.\n \n       Implementation_Exceptions : Array_Element_Id := No_Array_Element;\n-      --  An associative array listing body file names that don't have the\n-      --  body suffix. Not used by Ada. Indexed by the programming language\n-      --  name.\n+      --  An associative array listing body file names that do not have the\n+      --  body suffix. Not used by Ada. Indexed by programming language name.\n \n    end record;\n \n    function Standard_Naming_Data return Naming_Data;\n    pragma Inline (Standard_Naming_Data);\n-   --  The standard GNAT naming scheme.\n+   --  The standard GNAT naming scheme\n \n    function Same_Naming_Scheme\n      (Left, Right : Naming_Data)\n@@ -426,14 +445,14 @@ package Prj is\n \n    type Project_List is new Nat;\n    Empty_Project_List : constant Project_List := 0;\n-   --  A list of project files.\n+   --  A list of project files\n \n    type Project_Element is record\n       Project : Project_Id   := No_Project;\n       Next    : Project_List := Empty_Project_List;\n    end record;\n-   --  Element in a list of project file.\n-   --  Next is the id of the next project file in the list.\n+   --  Element in a list of project files. Next is the id of the next\n+   --  project file in the list.\n \n    package Project_Lists is new Table.Table\n      (Table_Component_Type => Project_Element,\n@@ -442,7 +461,7 @@ package Prj is\n       Table_Initial        => 100,\n       Table_Increment      => 100,\n       Table_Name           => \"Prj.Project_Lists\");\n-   --  The table that contains the lists of project files.\n+   --  The table that contains the lists of project files\n \n    --  The following record describes a project file representation\n \n@@ -459,30 +478,27 @@ package Prj is\n       --  Set by Prj.Proc.Process.\n \n       Name : Name_Id := No_Name;\n-      --  The name of the project.\n-      --  Set by Prj.Proc.Process.\n+      --  The name of the project. Set by Prj.Proc.Process.\n \n       Path_Name : Name_Id := No_Name;\n-      --  The path name of the project file.\n-      --  Set by Prj.Proc.Process.\n+      --  The path name of the project file. Set by Prj.Proc.Process.\n+\n+      Display_Path_Name : Name_Id := No_Name;\n+      --  The path name used for display purposes. May be different from\n+      --  Path_Name for platforms where the file names are case-insensitive.\n \n       Virtual : Boolean := False;\n       --  True for virtual extending projects\n \n-      Display_Path_Name : Name_Id := No_Name;\n-\n       Location : Source_Ptr := No_Location;\n-      --  The location in the project file source of the\n-      --  reserved word project.\n-      --  Set by Prj.Proc.Process.\n+      --  The location in the project file source of the reserved word\n+      --  project. Set by Prj.Proc.Process.\n \n       Mains : String_List_Id := Nil_String;\n-      --  The list of mains as specified by attribute Main.\n-      --  Set by Prj.Nmsc.Ada_Check.\n+      --  List of mains specified by attribute Main. Set by Prj.Nmsc.Ada_Check.\n \n       Directory : Name_Id := No_Name;\n-      --  The directory where the project file resides.\n-      --  Set by Prj.Proc.Process.\n+      --  Directory where the project file resides. Set by Prj.Proc.Process.\n \n       Display_Directory : Name_Id := No_Name;\n \n@@ -499,6 +515,9 @@ package Prj is\n       --  Set by Prj.Nmsc.Language_Independent_Check.\n \n       Display_Library_Dir : Name_Id := No_Name;\n+      --  The name of the library directory, for display purposes.\n+      --  May be different from Library_Dir for platforms where the file names\n+      --  are case-insensitive.\n \n       Library_Src_Dir : Name_Id := No_Name;\n       --  If a library project, directory where the sources and the ALI files\n@@ -508,6 +527,9 @@ package Prj is\n       --  Set by Prj.Nmsc.Language_Independent_Check.\n \n       Display_Library_Src_Dir : Name_Id := No_Name;\n+      --  The name of the library source directory, for display purposes.\n+      --  May be different from Library_Src_Dir for platforms where the file\n+      --  names are case-insensitive.\n \n       Library_Name : Name_Id := No_Name;\n       --  If a library project, name of the library\n@@ -527,10 +549,9 @@ package Prj is\n \n       Lib_Interface_ALIs : String_List_Id := Nil_String;\n       --  For Standalone Library Project Files, indicate the list\n-      --  of Interface ALI files.\n-      --  Set by Prj.Nmsc.Ada_Check.\n+      --  of Interface ALI files. Set by Prj.Nmsc.Ada_Check.\n \n-      Lib_Auto_Init  : Boolean := False;\n+      Lib_Auto_Init : Boolean := False;\n       --  For non static Standalone Library Project Files, indicate if\n       --  the library initialisation should be automatic.\n \n@@ -539,16 +560,17 @@ package Prj is\n \n       Ada_Sources_Present : Boolean := True;\n       --  A flag that indicates if there are Ada sources in this project file.\n-      --  There are no sources if 1) Source_Dirs is specified as an\n-      --  empty list, 2) Source_Files is specified as an empty list, or\n-      --  3) Ada is not in the list of the specified Languages.\n+      --  There are no sources if any of the following is true:\n+      --    1) Source_Dirs is specified as an empty list\n+      --    2) Source_Files is specified as an empty list\n+      --    3) Ada is not in the list of the specified Languages\n \n-      Other_Sources_Present   : Boolean := True;\n+      Other_Sources_Present : Boolean := True;\n       --  A flag that indicates that there are non-Ada sources in this project\n \n       Sources : String_List_Id := Nil_String;\n-      --  The list of all the source file names.\n-      --  Set by Prj.Nmsc.Check_Ada_Naming_Scheme.\n+      --  The list of all the source file names. Set by\n+      --  Prj.Nmsc.Check_Ada_Naming_Scheme.\n \n       First_Other_Source : Other_Source_Id := No_Other_Source;\n       Last_Other_Source  : Other_Source_Id := No_Other_Source;\n@@ -563,8 +585,7 @@ package Prj is\n       --  -I switches.\n \n       Include_Data_Set : Boolean := False;\n-      --  Set to True when Imported_Directories_Switches or Include_Path are\n-      --  set.\n+      --  Set True when Imported_Directories_Switches or Include_Path are set\n \n       Source_Dirs : String_List_Id := Nil_String;\n       --  The list of all the source directories.\n@@ -580,62 +601,60 @@ package Prj is\n       --  Set by Prj.Nmsc.Language_Independent_Check.\n \n       Display_Object_Dir : Name_Id := No_Name;\n+      --  The name of the object directory, for display purposes.\n+      --  May be different from Object_Directory for platforms where the file\n+      --  names are case-insensitive.\n \n-      Exec_Directory   : Name_Id := No_Name;\n-      --  The exec directory of this project file.\n-      --  Default is equal to Object_Directory.\n-      --  Set by Prj.Nmsc.Language_Independent_Check.\n+      Exec_Directory : Name_Id := No_Name;\n+      --  The exec directory of this project file. Default is equal to\n+      --  Object_Directory. Set by Prj.Nmsc.Language_Independent_Check.\n \n       Display_Exec_Dir : Name_Id := No_Name;\n+      --  The name of the exec directory, for display purposes.\n+      --  May be different from Exec_Directory for platforms where the file\n+      --  names are case-insensitive.\n \n       Extends : Project_Id := No_Project;\n       --  The reference of the project file, if any, that this\n-      --  project file extends.\n-      --  Set by Prj.Proc.Process.\n+      --  project file extends. Set by Prj.Proc.Process.\n \n       Extended_By : Project_Id := No_Project;\n       --  The reference of the project file, if any, that\n-      --  extends this project file.\n-      --  Set by Prj.Proc.Process.\n+      --  extends this project file. Set by Prj.Proc.Process.\n \n       Naming : Naming_Data := Standard_Naming_Data;\n       --  The naming scheme of this project file.\n       --  Set by Prj.Nmsc.Check_Naming_Scheme.\n \n       Decl : Declarations := No_Declarations;\n-      --  The declarations (variables, attributes and packages)\n-      --  of this project file.\n-      --  Set by Prj.Proc.Process.\n+      --  The declarations (variables, attributes and packages) of this\n+      --  project file. Set by Prj.Proc.Process.\n \n       Imported_Projects : Project_List := Empty_Project_List;\n       --  The list of all directly imported projects, if any.\n       --  Set by Prj.Proc.Process.\n \n-      Ada_Include_Path  : String_Access := null;\n+      Ada_Include_Path : String_Access := null;\n       --  The cached value of ADA_INCLUDE_PATH for this project file.\n       --  Do not use this field directly outside of the compiler, use\n-      --  Prj.Env.Ada_Include_Path instead.\n-      --  Set by Prj.Env.Ada_Include_Path.\n+      --  Prj.Env.Ada_Include_Path instead. Set by Prj.Env.Ada_Include_Path.\n \n-      Ada_Objects_Path  : String_Access := null;\n+      Ada_Objects_Path : String_Access := null;\n       --  The cached value of ADA_OBJECTS_PATH for this project file.\n       --  Do not use this field directly outside of the compiler, use\n-      --  Prj.Env.Ada_Objects_Path instead.\n-      --  Set by Prj.Env.Ada_Objects_Path\n+      --  Prj.Env.Ada_Objects_Path instead. Set by Prj.Env.Ada_Objects_Path\n \n       Include_Path_File : Name_Id := No_Name;\n       --  The cached value of the source path temp file for this project file.\n       --  Set by gnatmake (Prj.Env.Set_Ada_Paths).\n \n       Objects_Path_File_With_Libs : Name_Id := No_Name;\n       --  The cached value of the object path temp file (including library\n-      --  dirs) for this project file.\n-      --  Set by gnatmake (Prj.Env.Set_Ada_Paths).\n+      --  dirs) for this project file. Set by gnatmake (Prj.Env.Set_Ada_Paths).\n \n       Objects_Path_File_Without_Libs : Name_Id := No_Name;\n       --  The cached value of the object path temp file (excluding library\n-      --  dirs) for this project file.\n-      --  Set by gnatmake (Prj.Env.Set_Ada_Paths).\n+      --  dirs) for this project file. Set by gnatmake (Prj.Env.Set_Ada_Paths).\n \n       Config_File_Name : Name_Id := No_Name;\n       --  The name of the configuration pragmas file, if any.\n@@ -657,17 +676,15 @@ package Prj is\n \n       Checked : Boolean := False;\n       --  A flag to avoid checking repetitively the naming scheme of\n-      --  this project file.\n-      --  Set by Prj.Nmsc.Check_Ada_Naming_Scheme.\n-\n-      Seen  : Boolean := False;\n-      Flag1 : Boolean := False;\n-      Flag2 : Boolean := False;\n-      --  Various flags that are used in an ad hoc manner\n-      --  That's really not a good enough comment ??? we need to know what\n-      --  these flags are used for, and give them proper names. If Flag1\n-      --  and Flag2 have multiple uses, then either we use multiple fields\n-      --  or a renaming scheme.\n+      --  this project file. Set by Prj.Nmsc.Check_Ada_Naming_Scheme.\n+\n+      Seen                           : Boolean := False;\n+      --  A flag to mark a project as \"visited\" to avoid processing the same\n+      --  project several time.\n+\n+      Need_To_Build_Lib : Boolean := False;\n+      --  Indicates that the library of a Library Project needs to be built or\n+      --  rebuilt.\n \n       Depth : Natural := 0;\n       --  The maximum depth of a project in the project graph.\n@@ -680,7 +697,7 @@ package Prj is\n    end record;\n \n    function Empty_Project return Project_Data;\n-   --  Return the representation of an empty project.\n+   --  Return the representation of an empty project\n \n    package Projects is new Table.Table (\n      Table_Component_Type => Project_Data,\n@@ -689,12 +706,12 @@ package Prj is\n      Table_Initial        => 100,\n      Table_Increment      => 100,\n      Table_Name           => \"Prj.Projects\");\n-   --  The set of all project files.\n+   --  The set of all project files\n \n    type Put_Line_Access is access procedure\n      (Line    : String;\n       Project : Project_Id);\n-   --  Use to customize error reporting in Prj.Proc and Prj.Nmsc.\n+   --  Use to customize error reporting in Prj.Proc and Prj.Nmsc\n \n    procedure Expect (The_Token : Token_Type; Token_Image : String);\n    --  Check that the current token is The_Token. If it is not, then\n@@ -709,7 +726,7 @@ package Prj is\n    --  project file tree. Initialize must be called before the call to Reset.\n \n    procedure Register_Default_Naming_Scheme\n-     (Language : Name_Id;\n+     (Language            : Name_Id;\n       Default_Spec_Suffix : Name_Id;\n       Default_Body_Suffix : Name_Id);\n    --  Register the default suffixs for a given language. These extensions\n@@ -736,6 +753,7 @@ package Prj is\n private\n \n    Initial_Buffer_Size : constant := 100;\n+   --  Initial size for extensible buffer used below\n \n    Buffer : String_Access := new String (1 .. Initial_Buffer_Size);\n    --  An extensible character buffer to store names. Used in Prj.Part and"}, {"sha": "36e5bad65a03999bfdb090ebea1c23941b96aadb", "filename": "gcc/ada/rtsfind.adb", "status": "modified", "additions": 48, "deletions": 5, "changes": 53, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Frtsfind.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Frtsfind.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frtsfind.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -70,6 +70,11 @@ package body Rtsfind is\n    --  a unit is loaded to contain the defining entity for the unit, the\n    --  unit name, and the unit number.\n \n+   --  Note that a unit can be loaded either by a call to find an entity\n+   --  within the unit (e.g. RTE), or by an explicit with of the unit. In\n+   --  the latter case it is critical to make a call to Set_RTU_Loaded to\n+   --  ensure that the entry in this table reflects the load.\n+\n    type RT_Unit_Table_Record is record\n       Entity : Entity_Id;\n       Uname  : Unit_Name_Type;\n@@ -139,7 +144,7 @@ package body Rtsfind is\n \n    function Get_Unit_Name (U_Id : RTU_Id) return Unit_Name_Type;\n    --  Retrieves the Unit Name given a unit id represented by its\n-   --  enumaration value in RTU_Id.\n+   --  enumeration value in RTU_Id.\n \n    procedure Load_RTU\n      (U_Id        : RTU_Id;\n@@ -958,7 +963,7 @@ package body Rtsfind is\n       --  a WITH if the current unit is part of the extended main code\n       --  unit, and if we have not already added the with. The WITH is\n       --  added to the appropriate unit (the current one). We do not need\n-      --  to generate a WITH for an\n+      --  to generate a WITH for an ????\n \n    <<Found>>\n       if (not U.Withed)\n@@ -1052,11 +1057,49 @@ package body Rtsfind is\n \n    function RTU_Loaded (U : RTU_Id) return Boolean is\n    begin\n-      return True or else Present (RT_Unit_Table (U).Entity);\n-      --  Temporary kludge until we get proper interaction to ensure that\n-      --  an explicit WITH of a unit is properly registered in rtsfind ???\n+      return Present (RT_Unit_Table (U).Entity);\n    end RTU_Loaded;\n \n+   --------------------\n+   -- Set_RTU_Loaded --\n+   --------------------\n+\n+   procedure Set_RTU_Loaded (N : Node_Id) is\n+      Loc   : constant Source_Ptr       := Sloc (N);\n+      Unum  : constant Unit_Number_Type := Get_Source_Unit (Loc);\n+      Uname : constant Unit_Name_Type   := Unit_Name (Unum);\n+      E     : constant Entity_Id        :=\n+                Defining_Entity (Unit (Cunit (Unum)));\n+   begin\n+      pragma Assert (Is_Predefined_File_Name (Unit_File_Name (Unum)));\n+\n+      --  Loop through entries in RTU table looking for matching entry\n+\n+      for U_Id in RTU_Id'Range loop\n+\n+         --  Here we have a match\n+\n+         if Get_Unit_Name (U_Id) = Uname then\n+            declare\n+               U : RT_Unit_Table_Record renames RT_Unit_Table (U_Id);\n+               --  The RT_Unit_Table entry that may need updating\n+\n+            begin\n+               --  If entry is not set, set it now\n+\n+               if not Present (U.Entity) then\n+                  U.Entity := E;\n+                  U.Uname  := Get_Unit_Name (U_Id);\n+                  U.Unum   := Unum;\n+                  U.Withed := False;\n+               end if;\n+\n+               return;\n+            end;\n+         end if;\n+      end loop;\n+   end Set_RTU_Loaded;\n+\n    --------------------\n    -- Text_IO_Kludge --\n    --------------------"}, {"sha": "ce97924386a244ed20e9c295de0074f0cfa992b1", "filename": "gcc/ada/rtsfind.ads", "status": "modified", "additions": 4, "deletions": 1, "changes": 5, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Frtsfind.ads", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Frtsfind.ads", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Frtsfind.ads?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -2695,7 +2695,7 @@ package Rtsfind is\n    --\n    --  If RTE returns, the returned value is the required entity\n    --\n-   --  If the entity is not available, then an error message is given The\n+   --  If the entity is not available, then an error message is given. The\n    --  form of the message depends on whether we are in configurable run time\n    --  mode or not. In configurable run time mode, a missing entity is not\n    --  that surprising and merely says that the particular construct is not\n@@ -2732,6 +2732,9 @@ package Rtsfind is\n    --  If the unit has not been loaded, returns False. Note that this does\n    --  not mean that an attempt to load it subsequently would fail.\n \n+   procedure Set_RTU_Loaded (N : Node_Id);\n+   --  Register the predefined unit N as already loaded.\n+\n    procedure Text_IO_Kludge (Nam : Node_Id);\n    --  In Ada 83, and hence for compatibility in Ada 9X, package Text_IO has\n    --  generic subpackages (e.g. Integer_IO). They really should be child"}, {"sha": "0dca2b5bbaf97394e879478f1a39cf45fc9edd02", "filename": "gcc/ada/sem_ch10.adb", "status": "modified", "additions": 11, "deletions": 0, "changes": 11, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fsem_ch10.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fsem_ch10.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch10.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -43,6 +43,7 @@ with Nmake;    use Nmake;\n with Opt;      use Opt;\n with Output;   use Output;\n with Restrict; use Restrict;\n+with Rtsfind;  use Rtsfind;\n with Sem;      use Sem;\n with Sem_Ch6;  use Sem_Ch6;\n with Sem_Ch7;  use Sem_Ch7;\n@@ -496,6 +497,16 @@ package body Sem_Ch10 is\n          Set_Acts_As_Spec (N);\n       end if;\n \n+      --  Register predefined units in Rtsfind\n+\n+      declare\n+         Unum : constant Unit_Number_Type := Get_Source_Unit (Sloc (N));\n+      begin\n+         if Is_Predefined_File_Name (Unit_File_Name (Unum)) then\n+            Set_RTU_Loaded (Unit_Node);\n+         end if;\n+      end;\n+\n       --  Treat compilation unit pragmas that appear after the library unit\n \n       if Present (Pragmas_After (Aux_Decls_Node (N))) then"}, {"sha": "9449c607f5b90fdb2521f2f6be14984034513103", "filename": "gcc/ada/sem_ch12.adb", "status": "modified", "additions": 4, "deletions": 2, "changes": 6, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fsem_ch12.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fsem_ch12.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_ch12.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -6568,9 +6568,11 @@ package body Sem_Ch12 is\n                      Next_Non_Pragma (Formal_Node);\n \n                   else\n-                     --  No further formals to match.\n+                     --  No further formals to match, but the generic\n+                     --  part may contain inherited operation that are\n+                     --  not hidden in the enclosing instance.\n \n-                     exit;\n+                     Next_Entity (Actual_Ent);\n                   end if;\n \n                end loop;"}, {"sha": "c1ef371672da2d7edce8ad1329fd4023bce8dd66", "filename": "gcc/ada/sem_util.adb", "status": "modified", "additions": 20, "deletions": 4, "changes": 24, "blob_url": "https://github.com/Rust-GCC/gccrs/blob/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fsem_util.adb", "raw_url": "https://github.com/Rust-GCC/gccrs/raw/246d2ceb324bb3483062b211a262aa290f5ecf41/gcc%2Fada%2Fsem_util.adb", "contents_url": "https://api.github.com/repos/Rust-GCC/gccrs/contents/gcc%2Fada%2Fsem_util.adb?ref=246d2ceb324bb3483062b211a262aa290f5ecf41", "patch": "@@ -1676,10 +1676,8 @@ package body Sem_Util is\n          --  hides the implicit one,  which is removed from all visibility,\n          --  i.e. the entity list of its scope, and homonym chain of its name.\n \n-         elsif (Is_Overloadable (E) and then Present (Alias (E)))\n+         elsif (Is_Overloadable (E) and then Is_Inherited_Operation (E))\n            or else Is_Internal (E)\n-           or else (Ekind (E) = E_Enumeration_Literal\n-                     and then Is_Derived_Type (Etype (E)))\n          then\n             declare\n                Prev     : Entity_Id;\n@@ -5363,7 +5361,25 @@ package body Sem_Util is\n          if Is_Private_Type (Btype)\n            and then not Is_Generic_Type (Btype)\n          then\n-            return Btype;\n+            if Present (Full_View (Btype))\n+              and then Is_Record_Type (Full_View (Btype))\n+              and then not Is_Frozen (Btype)\n+            then\n+               --  To indicate that the ancestor depends on a private type,\n+               --  the current Btype is sufficient. However, to check for\n+               --  circular definition we must recurse on the full view.\n+\n+               Candidate := Trace_Components (Full_View (Btype), True);\n+\n+               if Candidate = Any_Type then\n+                  return Any_Type;\n+               else\n+                  return Btype;\n+               end if;\n+\n+            else\n+               return Btype;\n+            end if;\n \n          elsif Is_Array_Type (Btype) then\n             return Trace_Components (Component_Type (Btype), True);"}]}